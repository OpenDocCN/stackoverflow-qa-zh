# StackOverflow 问答 000945000-000945999

# python - 使用 Django 发布提要

> ID：945001
> 
> 赞同：0
> 
> 时间：2009-06-03T14:12:40.140
> 
> 标签：python, django, rss

我正在发布来自 Django 应用程序的提要。

我将 django.contrib.syndication.feeds.Feed 子类化，一切正常，除了没有在提要上发布的日期。

这是我在 Feed 类上创建的方法

```
def item_pubdate(self, item):
    返回项目.日期

```

这个方法永远不会被调用....

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-07-23T06:06:30.097

根据 Django 文档中的[Feed 类参考](http://docs.djangoproject.com/en/dev/ref/contrib/syndication/#feed-class-reference)， item_pubdate 字段应该返回一个 datetime.datetime 对象。如果 item.date 只是 DateField 而不是 DateTimeField，则可能会导致问题。如果是这种情况，您可以更改方法以创建日期时间，然后返回。

```
import datetime
def item_pubdate(self, item):
    return datetime.datetime.combine(item.date, datetime.time()) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-08T00:23:18.297

一段时间以来，我一直在用头撞这个。django rss系统似乎需要一个“日期时间”对象而不仅仅是日期（因为它需要一个时区，而日期对象没有时间，更不用说时区了......）

虽然我可能错了，但这是我通过错误日志发现的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T14:14:57.047

这就是我的设置方式，并且它正在工作。

```
class AllFeed(Feed):
    def item_pubdate(self, item):
        return item.date 
```

# java - 在java中，如何根据url创建HttpsURLConnection或HttpURLConnection？

> ID：945003
> 
> 赞同：13
> 
> 时间：2009-06-03T14:12:54.853
> 
> 标签：java, urlconnection

我正在做一个项目，我正在创建一个类来运行 http 客户端请求（我的类充当客户端）。它接受一个 url 和一个请求方法（GET、POST、PUT 等），我希望能够解析 URL 并根据它是 https 还是 http 打开 HttpsURLConnection 或 HttpURLConnection（假设给定的 url 将始终是正确的）。

如果我执行以下操作：

```
URLConnection conn = url.openConnection(); 
```

然后这将自动创建一个可以接受 http 和 https 的 URLConnection，但是如果我这样做，那么我找不到任何方法来设置请求方法（GET、POST 等），因为只有 HttpsURLConnection 或 HttpURLConnection 类具有设置请求方法方法。

如果我执行以下操作：

```
if(is_https)
    HttpsURLConnection conn = (HttpsURLConnection) url.openConnection();
else
    HttpURLConnection conn = (HttpURLConnection) url.openConnection(); 
```

然后创建连接，但我无法在 if 块之外访问它们。

是否可以这样做，或者我应该放弃并使用 apache httpclient 类？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-06-03T14:19:28.677

[HttpsURLConnection](http://java.sun.com/javase/6/docs/api/javax/net/ssl/HttpsURLConnection.html)扩展[了 HttpUrlConnection](http://java.sun.com/javase/6/docs/api/java/net/HttpURLConnection.html)，所以你不需要 HttpsUrlConnection，你可以这样做

```
HttpURLConnection conn = (HttpURLConnection) url.openConnection(); 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-06-03T14:24:33.160

因为`HttpsURLConnection extends HttpURLConnection`你可以声明`conn`为`HttpsURLConnection`. 通过这种方式，您可以访问公共接口 ( `setRequestMethod()`)。

为了访问扩展方法（例如`getCipherSuite()`，仅在子类中定义），您必须在**instanceof**`HttpsURLConnection`之后使用强制转换：

 **```
if (conn instanceof HttpsURLConnection) {
    HttpsURLConnection secured = (HttpsURLConnection) conn;
    String cipher = secured.getCipherSuite();
} 
```

# asp.net - iframed ASP 动作麻烦

> ID：945004
> 
> 赞同：0
> 
> 时间：2009-06-03T14:13:03.823
> 
> 标签：asp.net

这实际上是对我之前的问题的跟进（[链接](https://stackoverflow.com/questions/944513/getting-a-webresponse-stream-into-iframe-trouble/944597#944597)）

我已经创建了 HttpHandler 并且它现在工作正常，我将通过使用查询字符串和会话来增加灵活性，以将我正在制作的帖子指向正确的方向。

下一个问题如下。现在我已经按照应有的方式对旧页面进行了 iframe，但仍然存在处理这些页面触发的回发（或操作）的麻烦。每个按钮操作（asp 表单帖子）都指的是一个不存在的页面（它位于我从中导入功能的另一台服务器上）。

我尝试使用到另一台服务器的 url 映射，但我收到一个错误，告诉我外部链接不是有效的虚拟目录。因此我放弃了这个选项。

无论如何，我在那里保持功能在 iframe 内运行？

如果您需要，请务必要求澄清。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-04T09:33:28.833

我从同事那里得到了解决方案。

在将响应字符串从处理程序传递给 Iframe 之前，我使用 string.replace 来调整旧站点中的 url。这样他们指向旧站点，一切都恢复正常了:)

# file - 如何在 MATLAB 中获取文件的长度？

> ID：945006
> 
> 赞同：4
> 
> 时间：2009-06-03T14:13:10.157
> 
> 标签：file, matlab, file-format

有没有办法在不将文件加载到工作区的情况下计算出 .dat 文件的长度（以行为单位）？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2011-08-25T17:53:05.750

行计数器——每行只加载一个字符：

```
Nrows = numel(textread('mydata.txt','%1c%*[^\n]')) 
```

或文件长度（Matlab）：

```
datfileh = fopen(fullfile(path, filename));
fseek(datfileh, 0,'eof');
filelength = ftell(datfileh);
fclose(datfileh); 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-06-03T14:48:40.270

我假设您正在使用文本文件，因为您提到了查找行数。这是一个解决方案：

```
fid = fopen('your_file.dat','rt');
nLines = 0;
while (fgets(fid) ~= -1),
  nLines = nLines+1;
end
fclose(fid); 
```

这使用[FGETS](http://www.mathworks.com/access/helpdesk/help/techdoc/ref/fgets.html)读取每一行，计算它读取的行数。请注意，文件中的数据永远不会保存到工作区，它只是用于 while 循环的条件检查。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-07T14:14:17.003

还值得记住的是，您可以使用文件系统的内置命令，因此在 linux 上您可以使用该命令

```
[s,w] = system('wc -l your_file.dat'); 
```

然后从返回的文本中获取行数（存储在 中`w`）。（我认为 Windows 下没有等效的命令。）

# python - DBus 接口属性

> ID：945007
> 
> 赞同：7
> 
> 时间：2009-06-03T14:13:14.260
> 
> 标签：python, properties, interface, dbus

如何获取可用 DBus 接口属性的列表？

我正在编写一个脚本来跟踪特定类型的 USB 设备连接。我猜想将要跟踪的连接与所有 USB 连接区分开来的一种方法是检查 DBus 在 USB 连接上发送的信号接口的属性。我想获取所有此类属性的列表以选择相关的。

我的代码是：

```
 import sys
    import dbus
    from dbus.mainloop.glib import DBusGMainLoop
    import gobject

    def deviceAdded(udi):
        device = bus.get_object("org.freedesktop.Hal", udi)
        device_if = dbus.Interface(device, 'org.freedesktop.Hal.Device')
        if device_if.GetPropertyString('info.subsystem') == 'usb_device':
            #
            # Properties can be accesed like this:
            # vendor_id = device_if.GetPropertyInteger('usb_device.vendor_id')
            # 
            # how to get the list of all properties?
            #
            # do something

    def deviceRemoved(udi):
        # do something
        pass

    if __name__ == "__main__":
    DBusGMainLoop(set_as_default=True)
    bus = dbus.SystemBus()

    bus.add_signal_receiver( 
        deviceAdded,
        'DeviceAdded',
        'org.freedesktop.Hal.Manager',
        'org.freedesktop.Hal',
        '/org/freedesktop/Hal/Manager')

    bus.add_signal_receiver( 
        deviceRemoved,
        'DeviceRemoved',
        'org.freedesktop.Hal.Manager',
        'org.freedesktop.Hal',
        '/org/freedesktop/Hal/Manager')

    loop = gobject.MainLoop()

    try:
        loop.run()
    except KeyboardInterrupt:
        print "usb-device-tracker: keyboad interrupt received, shutting down"
        loop.quit()
        sys.exit(0) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-01-03T02:48:43.543

一般来说，你可以使用接口[`GetAll`](http://dbus.freedesktop.org/doc/dbus-specification.html#standard-interfaces-properties)上的方法。`org.freedesktop.DBus.Properties`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-13T04:06:51.007

首先，检查 hal 文档和来源，它们始终是您的朋友。

```
import dbus
bus = dbus.SystemBus()
dev = bus.get_object("org.freedesktop.Hal", u'/org/freedesktop/Hal/devices/computer_logicaldev_input')
iface = dbus.Interface(dev, 'org.freedesktop.Hal.Device')
props = iface.GetAllProperties()
print "\n".join(("%s: %s" % (k, props[k]) for k in props)) 
```

作为最后的手段，您始终可以使用“lshal”命令找到您感兴趣的属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-09T18:15:06.460

我最近遇到了同样的问题（不是专门针对 Hal）。我不确定这是否普遍适用，但可以（至少经常）通过`org.freedesktop.DBus.Properties`接口检索它（如@daf 建议的那样）。

```
bus = dbus.SystemBus()
device = bus.get_object(...)

your_interface = 'org.freedesktop.Hal.Device' # for this example
props_iface = dbus.Interface(device, 'org.freedesktop.DBus.Properties')
properties = props_iface.GetAll(your_interface) #properties is a dbus.Dictionary 
```

# javascript - 用于解析 JSON 的 JavaScript eval() 替代方案

> ID：945015
> 
> 赞同：19
> 
> 时间：2009-06-03T14:14:47.970
> 
> 标签：javascript, jquery, security, json, eval

快速提问。JavaScript 中的 eval 是不安全的，不是吗？我有一个 JSON 对象作为字符串，我需要将其转换为实际对象，以便获取数据：

```
function PopulateSeriesFields(result) 
{
    data = eval('(' + result + ')');
    var myFakeExample = data.exampleType
} 
```

如果有帮助，我将使用 jQuery 中的 $.ajax 方法。

谢谢

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-06-03T14:28:49.437

好吧，不管安全与否，当你使用 jQuery 时，最好使用[$.getJSON()](http://docs.jquery.com/Ajax/jQuery.getJSON)方法，而不是 $.ajax()：

```
$.getJSON(url, function(data){
    alert(data.exampleType);
}); 
```

`eval()`当您仅与自己的服务器通信时，尤其是当您在服务器端使用良好的 JSON 库以保证生成的 JSON 不会包含任何令人讨厌的内容时，通常认为 JSON 解析是安全的。

甚至 JSON 的作者 Douglas Crockford 也说过`eval()`，除了解析 JSON 之外，你不应该在代码中的任何地方使用。请参阅他的书[JavaScript: The Good Parts中的相应部分](http://books.google.com/books?id=PXa2bby0oQ0C&pg=PA139&lpg=PA139&dq=JavaScript:+The+Good+Parts+eval&source=bl&ots=HHpll5r0gG&sig=3OTFEqDnRBVaLXSUDK1JsCGvxIg&hl=et&ei=4pcmSs7FAsG__Qa_2P3XBw&sa=X&oi=book_result&ct=result&resnum=2)

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-06-03T14:44:47.783

您应该使用[JSON](http://www.json.org/js.html)并编写 JSON.parse。

“手动”解析太慢了，所以库中的 JSON.parse 实现会检查内容，然后最终使用 eval，所以它[仍然是 unsafe](http://yuiblog.com/blog/2007/04/10/json-and-browser-security/)。但是，如果您使用的是较新的浏览器（IE8 或 Firefox），则库代码不会实际执行。相反，**本机浏览器支持**启动，然后您就安全了。

[在此处](http://blog.mozilla.com/webdev/2009/02/12/native-json-in-firefox-31/)和[此处](http://blogs.msdn.com/ie/archive/2008/09/10/native-json-in-ie8.aspx)阅读更多信息。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-06-03T14:23:54.627

如果您不能信任来源，那么您是正确的……eval 是不安全的。它可用于将代码注入您的页面。

查看此链接以获得更安全的替代方案：

[Javascript 中的 JSON](http://www.json.org/js.html)

该页面解释了 eval 不安全的原因，并在页面底部提供了指向 JSON 解析器的链接。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-06-03T14:19:50.063

不安全？这取决于您是否可以信任数据。

如果您可以相信该字符串将是 JSON（并且不包括例如函数），那么它是安全的。

也就是说 - 如果您使用的是 jQuery，为什么要手动执行此操作？使用[dataType](http://docs.jquery.com/Ajax/jQuery.ajax#options)选项指定它是 JSON 并让库为您处理它。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2010-08-10T16:40:17.710

如果您使用的是 jQuery，则从 1.4.1 版开始，您可以使用 jQuery.parseJSON()

看到这个答案：[Safe json parsing with jquery?](https://stackoverflow.com/questions/3016236/safe-json-parsing-with-jquery/3016292#3016292)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-06-03T14:21:29.640

使用 JavaScript`eval`是不安全的。因为 JSON 只是 JavaScript 的一个子集，但 JavaScript`eval`允许任何有效的 JavaScript。

请改用真正的 JSON 解析器[，例如 json.org](http://json.org/js.html)中的 JSON 解析器。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-06-03T14:21:42.883

评估代码的替代方法是手动解析它。它并不像听起来那么难，但在运行时要重得多。[你可以在这里读到它。](http://www.json.org/js.html)

需要注意的重要部分是评估 JSON 并不是天生不安全的。只要您相信消息来源，不要把事情搞砸。这包括确保传递到 JSON 编码器的内容被正确转义（以阻止人们在用户机器上执行代码的 2 个步骤）。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2011-07-13T10:35:34.627

你可以试试这样

```
var object = new Function("return " + jsonString)() 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-03-09T17:05:00.683

另一个不错的选择是 YUI：http: [//yuilibrary.com/yui/docs/json/](http://yuilibrary.com/yui/docs/json/)

所以你的代码会是这样的：

```
Y.JSON.parse('{"id": 15, "name": "something"}'); 
```

# asp.net-ajax - 如何使用 PageRequestManager 回发 PartialPage？

> ID：945019
> 
> 赞同：0
> 
> 时间：2009-06-03T14:15:33.053
> 
> 标签：asp.net-ajax, updatepanel

我正在尝试从 javascript 更新和 updatepanel。

我正在使用的代码有效，但似乎只能回发一整页。

```
function RefreshAppearances() {
    var prm = Sys.WebForms.PageRequestManager.getInstance();
    prm._doPostBack('<%=Me.updAppearances.ID %>', '');
} 
```

当 updatepanels 加载事件触发时，`ScriptManager.IsInAsyncPostBack`总是返回 false。

为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-13T21:21:15.437

我不应该直接使用这种方法。我认为的想法是使用标准的 doPostBack 函数：

```
__doPostBack(eventTarget, eventArgument) {
    if (!theForm.onsubmit || (theForm.onsubmit() != false)) {
        theForm.__EVENTTARGET.value = eventTarget;
        theForm.__EVENTARGUMENT.value = eventArgument;
        theForm.submit();
    }
} 
```

或使用 Page.ClientScript.GetPostBackClientHyperLink 方法为您形成方法调用。如果 AJAX 可用并且启用了部分回发，则回发调用应该被 ScriptManager 拦截，并且应该正确更新更新面板。

# vim - 在 vimdiff 窗口之间复制行时撤消 diff put

> ID：945023
> 
> 赞同：16
> 
> 时间：2009-06-03T14:16:22.240
> 
> 标签：vim, text, diff, text-editor, vimdiff

如果在命令提示符下，我运行

```
vimdiff file1 file2 
```

我得到一个并排打开两个文件的 vim 实例。假设文件中的文本如下所示（file1 在左侧，file2 在右侧）：

```
╔═══════╤═══════╗
║foo    │-------║
║bar    │bar    ║
║grue   │-------║
║~      │~      ║
║~      │~      ║
╚═══════╧═══════╝ 
```

现在假设我的光标位于“foo”的“f”上，并且我希望将 file1 的第一行复制到 file2 的第一行。

一种方法是使用**v$ y**选择并拉出（复制）该行，然后使用**Ctrl+wl**将光标移动到 file2 的第一行，然后键入**p**粘贴复制的行。如果我这样做，然后我决定我真的不想这样做，我可以按**u**撤消我在 file2 中执行的粘贴命令。

另一种方法是使用 diff put 命令 dp。但是，如果在这样做之后我决定我不是故意的，我不能简单地通过按**u**来撤消它，因为我的光标仍在 file1 中，并且**u**命令将撤消对 file1 的最新更改，*而不是*最最近对 file2 的更改。因此，我必须使用**Ctrl+wl**或**Ctrl+ww**将光标移动到 file2 的窗口，*然后*按**u**。

所以，我的问题是：在我如上所述使用**dp**之后，是否有任何简单的方法可以让我撤消它而无需将光标移到另一个文件的窗口？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2011-11-24T00:25:11.897

取决于您的工作流程如何进行，但我通常使用`d``o`将差异获取到我的文件中，而不是`d``p`将差异放入另一个文件中。这样你就可以像往常一样使用`u`and `ctrl`+了。`r`

由于 diff 导航命令在任何一个文件中的工作方式都相同，所以你应该很高兴！

下一个差异：`]c`

上一个差异：`[c`

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-06-03T18:15:33.253

实际上没有命令，但你可以映射你自己的。将以下内容放入您的 vimrc 中，然后使用**du**执行*diff undos*。

```
nmap du :wincmd w<cr>:normal u<cr>:wincmd w<cr>
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-10-19T07:02:15.143

比较文件时，我喜欢使用`vimdiff`or `vim -d`。一种复制更改的方法`vimdiff`是：

```
]c               - advance to the next block with differences
[c               - reverse search for the previous block with differences
do (diff obtain) - bring changes from the other file to the current file
dp (diff put)    - send changes from the current file to the other file 
```

这就像：

```
:diffget the same with do
:diffput the same with dp 
```

# jsf - MyFaces 到 Mojarra 的迁移问题

> ID：945024
> 
> 赞同：0
> 
> 时间：2009-06-03T14:16:53.923
> 
> 标签：jsf, migration, facelets, myfaces, mojarra

我正在从 MyFaces 1.2.6 迁移到 Mojarra 1.2。我的应用程序还使用 Facelets、Tomahawk 和 Richfaces。

使用 MyFaces 1.2.6，它可以正常工作。使用 Mojarra 1.2，我遇到了一些问题。

它不断打印此错误：

```
This page contains the following errors:

error on line 141 at column 36: xmlParseEntityRef: no name
Below is a rendering of the page up to the first error. 
```

第 141 行的内容：

```
<f:facet name="footer"> 
```

有谁知道我该怎么办？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T14:37:10.013

鉴于错误**xmlParseEntityRef**，我将检查杂散的[XML 实体](http://www.w3.org/TR/REC-xml/#sec-physical-struct)（查找 & 符号 - **&**）。

还要检查任何 EL 表达式发出的值（例如 ${baz.mystring}）。如果 MyFaces 将字符串“foo & bar”编码为**foo & bar**，但是 RI 直接将它作为**foo & bar**发出，那么这可能会导致问题。

# events - 如何检查 CURRENT 事件是否不在表单的 OPEN 事件期间

> ID：945025
> 
> 赞同：2
> 
> 时间：2009-06-03T14:16:58.777
> 
> 标签：events, ms-access, vba

我有一个事件过程，当用户选择某个记录时要运行它。

如果我把它放在一个 ON CURRENT 事件中，它就可以工作。

但是，我不需要在打开表单时运行它。也就是说，当打开表单并将记录加载到表单上时，将为每个加载的记录调用我的事件过程。它减慢了我的程序，因为这是不必要的。

我的问题是，如何检查事件在“加载”记录期间没有运行。

就像是：

```
on_current_event do:

if event is not during on_load then
do this
end if

end proc 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-03T18:40:45.620

Why not declare a form level boolean variable and set it to true when the form has finished loading?

In your OnCurrent event you can then do something like:

```
If Variable then
  Do Stuff
Else
  Don't do stuff
End If 
```

This is probably not addressing the underlying issue however...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-05T06:28:34.877

在您的表单代码中：

```
Private isLoading As Boolean

Private Sub Form_Open(Cancel as Boolean)
    isLoading = True
End Sub

Private Sub Form_Current()
    If isLoading Then 
        isLoading = False
        Exit Sub
    End If
End Sub 
```

这样`OnCurrent`，表单打开时第一次发生的事件将被绕过。

话虽如此，在我看来这不是您真正的潜在问题，但如果您希望其他人尝试提供帮助，您将需要提供更多信息（打开另一个问题）。

# asp.net-mvc - Page.User.Identity.IsAuthenticated 在 safari 中总是返回 false

> ID：945030
> 
> 赞同：0
> 
> 时间：2009-06-03T14:17:51.487
> 
> 标签：asp.net-mvc, authentication, safari, openid, dotnetopenauth

我正在使用 DotNetOpenId 和 Asp.NET MVC。我有以下问题：

使用 IE 时没有问题，我可以登录，当我检查 Page.User.Identity.IsAuthenticated 时，我得到了真实的结果。如果我在 Safari for Windows 中对此进行测试，则 Page.User.Identity.IsAuthenticated 为假。如果我在 Mac 中使用 Safari，我可以毫无问题地登录。

任何的想法？我可以给您什么其他信息以便您可以帮助我？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T17:49:25.553

您*正在*使用 Safari 登录您的网站，对吗？我无法从您的问题中判断您是否希望能够使用 IE 登录，然后切换到 Safari 并仍然可以登录。但这肯定是不可能的。

你能告诉我更多关于当你使用 Safari 时会发生什么的事情吗？登录是否似乎已完成，但它仍然表现得像您没有登录一样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-09T12:26:07.537

随着 Safari 4 的发布，一切都开始工作了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-17T03:09:08.090

不久前我遇到了类似的问题。事实证明，我设置的 cookie 在设置时将域的第一个字母大写，而我们使用的 javascript 正在寻找所有小写字母。这在除一个浏览器之外的所有浏览器上都运行良好...... Windows 版 Safari 将 Example.com 和 example.com 视为两个不同的域，并将 cookie 请求视为跨域并阻止它。

# cocoa - 获取按上次使用排序的正在运行的应用程序列表

> ID：945033
> 
> 赞同：15
> 
> 时间：2009-06-03T14:18:56.197
> 
> 标签：cocoa, list, process

我想按照 ⌘ + ⇥</p> 时出现的相同顺序获取正在运行的应用程序列表

即如果我使用**TextEdit**，然后**Preview**，然后**iCal**，顺序是

1.  卡尔
2.  预习
3.  文本编辑

使用 `[[NSWorkspace sharedWorkspace] launchedApplications]`不起作用，因为应用程序按启动日期/进程 ID 排序。枚举`GetNextProcess`也不起作用，因为它也是由 pid 排序的。

自己注册通知和维护列表不是一种选择，因为我必须在应用程序启动后立即知道该列表。好吧，列表的第一个元素实际上就足够了，但我认为这几乎是同一个问题。

是否有一些 API 可用于获取此信息？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-08-04T11:10:39.220

也许是这样的：

```
cd /System/Library/Frameworks/CoreServices.framework/Frameworks/LaunchServices.framework
nm LaunchServices | grep __LSCopyApplicationArrayInFrontToBackOrder 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-03T19:56:48.073

在您的应用程序启动之前获取列表是不可能的。但是，在启动应用程序后，您只需注册通知并维护自己的应用程序数组。

唯一的解决方案是使用 launchd 在登录时启动一个后台进程，该进程只是监听应用程序。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-03T17:32:59.220

您需要在活动应用程序更改时注册通知，如下所述：[http ://www.unsanity.org/archives/000045.php](https://web.archive.org/web/20120620132532/http://www.unsanity.org/archives/000045.php)

一旦完成，就很容易维护按上次活动时间排序的活动应用程序数组。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-08-04T16:43:46.297

尝试使用 Accessibility 或 CGWindowList API 枚举窗口列表。应用程序不是 Mac OS X 上的窗口，我相信你知道，但应用程序的从前到后的顺序应该由它们最前面的窗口的从前到后的顺序决定。

当然，您需要忽略您已经从中看到窗口的进程（即，只考虑它们最前面的窗口）。

# oracle - Oracle 将 NULL Byte (ASCII: 0) 添加到 varchar2 字符串

> ID：945034
> 
> 赞同：0
> 
> 时间：2009-06-03T14:19:04.730
> 
> 标签：oracle, asp-classic

我在使用 Oracle 9i 作为其数据库的旧 ASP 应用程序中遇到了一个奇怪的问题。我们最近让 DBA 将 VARCHAR2 字段的大小从 VARCHAR2(2000) 增加到 VARCHAR2(4000)。问题在于，即使插入的字符串大于 2000 个字符，也会在字符串中的 2001 个字符位置插入一个 NULL 字节（ASCII：0）。例如，如果应用程序将一条包含 2500 个字符的字符串的新记录插入到表中，则 VARCHAR2 字段中将存储 2501 个字符，并在 2001 个字符位置插入 NULL 字节。NULL 字节不是保存到数据库中的原始发布数据的一部分，这给我们带来了一些痛苦。你们有没有遇到过这样的事情？该应用程序正在使用 MSDAORA ODBC 驱动程序，我'*可能*有 2000 个字符的内部限制。

有任何想法吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T22:59:47.203

寻找 10046 跟踪级别 4

```
alter session set events '10046 trace name context forever, level 4'; 
```

这将在服务器上创建一个包含绑定值的跟踪文件（因此您可以查看空字节是否是被推入 SQL 的字符串的一部分）。

有没有什么奇怪的字符集（例如你使用的是多字节字符集）？环境中的怪事越多，您就越有可能发现错误。

最后的想法是尝试使用 CLOB 而不是 VARCHAR2(4000)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T14:31:11.400

我真的不认为是 ORACLE 这样做的。您始终可以使用 RTRIM 删除插入语句中的任何空白。

# sharepoint - SharePoint：如何从列表模板创建新列表？

> ID：945043
> 
> 赞同：2
> 
> 时间：2009-06-03T14:21:20.233
> 
> 标签：sharepoint, list, moss, list-template

我已经根据问题列表创建了一个列表模板，它保存在列表模板库中。现在如何根据这个模板创建一个新列表？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-03T14:46:47.093

```
string internalName = "MyListTemplateName";
SPListTemplate t = null;
    foreach (SPListTemplate template in web.ListTemplates)
     {
       if (template.InternalName.Equals(internalName)
       {
          t = template;
          break;
       }
    }    
        web.Lists.Add("nameoflist", "description", t); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-01-03T11:20:18.870

I just encountered the same situation today.
I saved a list as a template and i wanted to use that template in a new list.
On Sharepoint 2013, go to *Site Contents > Add an App >*
Scroll down and you will see a page numbering saying that you are on page *1*
Click on the second page and all your saved templates will be there

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-08T19:57:53.290

计时器作业可能只需要一段时间才能触发。

`Lists > Create > Tracking section`几分钟后，该模板最终显示为一个选项。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-04-02T08:28:55.220

我很惊讶 Johan Leino 的答案多次被标记为有用，因为它在这种特殊情况下不起作用。如果您自己创建模板，`web.ListTemplates`不存储它，您将无法创建列表。它仅适用于开箱即用的模板。
如果您想根据您的自定义模板创建一个列表，您需要这样做：

```
SPListTemplateCollection listTemplates = web.Site.GetCustomListTemplates(web);
SPListTemplate listTemplate = listTemplates["MyCustomTemplate"];
Guid listId = web.Lists.Add("My New List Name", "My Description", listTemplate);
if (listId != null) { //all good } 
```

# linux - .htaccess 不工作（mod_rewrite）

> ID：945047
> 
> 赞同：29
> 
> 时间：2009-06-03T14:22:00.717
> 
> 标签：linux, apache, mod-rewrite

我没有任何运气让我的 .htaccess 与 mod_rewrite 一起工作。基本上我要做的就是从“ [http://www.example.com](http://www.example.com) ”和“ [https://www.example.com](https://www.example.com) ”中删除“www ”。

如果我缺少任何东西（conf 文件等，请告诉我我会更新）

这是我的 .htaccess 文件（位于 @/var/www/site/trunk/html/）

```
Options +FollowSymLinks
RewriteEngine on
RewriteCond %{HTTP_HOST} ^www\.(.*) [NC]
RewriteRule (.*) //%1/$1 [L,R=301] 
```

我的 mod_rewrite 已启用：

```
root@s15348441:/etc/apache2/mods-available# more rewrite.load
LoadModule rewrite_module /usr/lib/apache2/modules/mod_rewrite.so 
```

我的 apache 配置文件：

apache2.conf

```
#
# Based upon the NCSA server configuration files originally by Rob McCool.
#
# This is the main Apache server configuration file.  It contains the
# configuration directives that give the server its instructions.
# See http://httpd.apache.org/docs/2.2/ for detailed information about
# the directives.
#
# Do NOT simply read the instructions in here without understanding
# what they do.  They're here only as hints or reminders.  If you are unsure
# consult the online docs. You have been warned.  
#
# The configuration directives are grouped into three basic sections:
#  1\. Directives that control the operation of the Apache server process as a
#     whole (the 'global environment').
#  2\. Directives that define the parameters of the 'main' or 'default' server,
#     which responds to requests that aren't handled by a virtual host.
#     These directives also provide default values for the settings
#     of all virtual hosts.
#  3\. Settings for virtual hosts, which allow Web requests to be sent to
#     different IP addresses or hostnames and have them handled by the
#     same Apache server process.
#
# Configuration and logfile names: If the filenames you specify for many
# of the server's control files begin with "/" (or "drive:/" for Win32), the
# server will use that explicit path.  If the filenames do *not* begin
# with "/", the value of ServerRoot is prepended -- so "/var/log/apache2/foo.log"
# with ServerRoot set to "" will be interpreted by the
# server as "//var/log/apache2/foo.log".
#

### Section 1: Global Environment
#
# The directives in this section affect the overall operation of Apache,
# such as the number of concurrent requests it can handle or where it
# can find its configuration files.
#

#
# ServerRoot: The top of the directory tree under which the server's
# configuration, error, and log files are kept.
#
# NOTE!  If you intend to place this on an NFS (or otherwise network)
# mounted filesystem then please read the LockFile documentation (available
# at <URL:http://httpd.apache.org/docs-2.1/mod/mpm_common.html#lockfile>);
# you will save yourself a lot of trouble.
#
# Do NOT add a slash at the end of the directory path.
#
ServerRoot "/etc/apache2"

#
# The accept serialization lock file MUST BE STORED ON A LOCAL DISK.
#
#<IfModule !mpm_winnt.c>
#<IfModule !mpm_netware.c>
LockFile /var/lock/apache2/accept.lock
#</IfModule>
#</IfModule>

#
# PidFile: The file in which the server should record its process
# identification number when it starts.
# This needs to be set in /etc/apache2/envvars
#
PidFile ${APACHE_PID_FILE}

#
# Timeout: The number of seconds before receives and sends time out.
#
Timeout 300

#
# KeepAlive: Whether or not to allow persistent connections (more than
# one request per connection). Set to "Off" to deactivate.
#
KeepAlive On

#
# MaxKeepAliveRequests: The maximum number of requests to allow
# during a persistent connection. Set to 0 to allow an unlimited amount.
# We recommend you leave this number high, for maximum performance.
#
MaxKeepAliveRequests 100

#
# KeepAliveTimeout: Number of seconds to wait for the next request from the
# same client on the same connection.
#
KeepAliveTimeout 15

##
## Server-Pool Size Regulation (MPM specific)
## 

# prefork MPM
# StartServers: number of server processes to start
# MinSpareServers: minimum number of server processes which are kept spare
# MaxSpareServers: maximum number of server processes which are kept spare
# MaxClients: maximum number of server processes allowed to start
# MaxRequestsPerChild: maximum number of requests a server process serves
<IfModule mpm_prefork_module>
    StartServers          5
    MinSpareServers       5
    MaxSpareServers      10
    MaxClients          150
    MaxRequestsPerChild   0
</IfModule>

# worker MPM
# StartServers: initial number of server processes to start
# MaxClients: maximum number of simultaneous client connections
# MinSpareThreads: minimum number of worker threads which are kept spare
# MaxSpareThreads: maximum number of worker threads which are kept spare
# ThreadsPerChild: constant number of worker threads in each server process
# MaxRequestsPerChild: maximum number of requests a server process serves
<IfModule mpm_worker_module>
    StartServers          2
    MaxClients          150
    MinSpareThreads      25
    MaxSpareThreads      75 
    ThreadsPerChild      25
    MaxRequestsPerChild   0
</IfModule>

# These need to be set in /etc/apache2/envvars
User ${APACHE_RUN_USER}
Group ${APACHE_RUN_GROUP}

#
# AccessFileName: The name of the file to look for in each directory
# for additional configuration directives.  See also the AllowOverride
# directive.
#

AccessFileName .htaccess

#
# The following lines prevent .htaccess and .htpasswd files from being 
# viewed by Web clients. 
#
<Files ~ "^\.ht">
    Order allow,deny
    Deny from all
</Files>

#
# DefaultType is the default MIME type the server will use for a document
# if it cannot otherwise determine one, such as from filename extensions.
# If your server contains mostly text or HTML documents, "text/plain" is
# a good value.  If most of your content is binary, such as applications
# or images, you may want to use "application/octet-stream" instead to
# keep browsers from trying to display binary files as though they are
# text.
#
DefaultType text/plain

#
# HostnameLookups: Log the names of clients or just their IP addresses
# e.g., www.apache.org (on) or 204.62.129.132 (off).
# The default is off because it'd be overall better for the net if people
# had to knowingly turn this feature on, since enabling it means that
# each client request will result in AT LEAST one lookup request to the
# nameserver.
#
HostnameLookups Off

# ErrorLog: The location of the error log file.
# If you do not specify an ErrorLog directive within a <VirtualHost>
# container, error messages relating to that virtual host will be
# logged here.  If you *do* define an error logfile for a <VirtualHost>
# container, that host's errors will be logged there and not here.
#
ErrorLog /var/log/apache2/error.log

#
# LogLevel: Control the number of messages logged to the error_log.
# Possible values include: debug, info, notice, warn, error, crit,
# alert, emerg.
#
LogLevel warn

# Include module configuration:
Include /etc/apache2/mods-enabled/*.load
Include /etc/apache2/mods-enabled/*.conf

# Include all the user configurations:
Include /etc/apache2/httpd.conf

# Include ports listing
Include /etc/apache2/ports.conf

#
# The following directives define some format nicknames for use with
# a CustomLog directive (see below).
# If you are behind a reverse proxy, you might want to change %h into %{X-Forwarded-For}i
#
LogFormat "%h %l %u %t \"%r\" %>s %b \"%{Referer}i\" \"%{User-Agent}i\"" combined
LogFormat "%h %l %u %t \"%r\" %>s %b" common
LogFormat "%{Referer}i -> %U" referer
LogFormat "%{User-agent}i" agent

#
# ServerTokens
# This directive configures what you return as the Server HTTP response
# Header. The default is 'Full' which sends information about the OS-Type
# and compiled in modules.
# Set to one of:  Full | OS | Minor | Minimal | Major | Prod
# where Full conveys the most information, and Prod the least.
#
ServerTokens Full

#
# Optionally add a line containing the server version and virtual host
# name to server-generated pages (internal error documents, FTP directory 
# listings, mod_status and mod_info output etc., but not CGI generated 
# documents or custom error documents).
# Set to "EMail" to also include a mailto: link to the ServerAdmin.
# Set to one of:  On | Off | EMail
#
ServerSignature On

#
# Customizable error responses come in three flavors:
# 1) plain text 2) local redirects 3) external redirects
#
# Some examples:
#ErrorDocument 500 "The server made a boo boo."
#ErrorDocument 404 /missing.html
#ErrorDocument 404 "/cgi-bin/missing_handler.pl"
#ErrorDocument 402 http://www.example.com/subscription_info.html
#

#
# Putting this all together, we can internationalize error responses.
#
# We use Alias to redirect any /error/HTTP_<error>.html.var response to
# our collection of by-error message multi-language collections.  We use 
# includes to substitute the appropriate text.
#
# You can modify the messages' appearance without changing any of the
# default HTTP_<error>.html.var files by adding the line:
#
#   Alias /error/include/ "/your/include/path/"
#
# which allows you to create your own set of files by starting with the
# /usr/share/apache2/error/include/ files and copying them to /your/include/path/, 
# even on a per-VirtualHost basis.  The default include files will display
# your Apache version number and your ServerAdmin email address regardless
# of the setting of ServerSignature.
#
# The internationalized error documents require mod_alias, mod_include
# and mod_negotiation.  To activate them, uncomment the following 30 lines.

#    Alias /error/ "/usr/share/apache2/error/"
#
#    <Directory "/usr/share/apache2/error">
#        AllowOverride None
#        Options IncludesNoExec
#        AddOutputFilter Includes html
#        AddHandler type-map var
#        Order allow,deny
#        Allow from all
#        LanguagePriority en cs de es fr it nl sv pt-br ro
#        ForceLanguagePriority Prefer Fallback
#    </Directory>
#
#    ErrorDocument 400 /error/HTTP_BAD_REQUEST.html.var
#    ErrorDocument 401 /error/HTTP_UNAUTHORIZED.html.var
#    ErrorDocument 403 /error/HTTP_FORBIDDEN.html.var
#    ErrorDocument 404 /error/HTTP_NOT_FOUND.html.var
#    ErrorDocument 405 /error/HTTP_METHOD_NOT_ALLOWED.html.var
#    ErrorDocument 408 /error/HTTP_REQUEST_TIME_OUT.html.var
#    ErrorDocument 410 /error/HTTP_GONE.html.var
#    ErrorDocument 411 /error/HTTP_LENGTH_REQUIRED.html.var
#    ErrorDocument 412 /error/HTTP_PRECONDITION_FAILED.html.var
#    ErrorDocument 413 /error/HTTP_REQUEST_ENTITY_TOO_LARGE.html.var
#    ErrorDocument 414 /error/HTTP_REQUEST_URI_TOO_LARGE.html.var
#    ErrorDocument 415 /error/HTTP_UNSUPPORTED_MEDIA_TYPE.html.var
#    ErrorDocument 500 /error/HTTP_INTERNAL_SERVER_ERROR.html.var
#    ErrorDocument 501 /error/HTTP_NOT_IMPLEMENTED.html.var
#    ErrorDocument 502 /error/HTTP_BAD_GATEWAY.html.var
#    ErrorDocument 503 /error/HTTP_SERVICE_UNAVAILABLE.html.var
#    ErrorDocument 506 /error/HTTP_VARIANT_ALSO_VARIES.html.var

# Include of directories ignores editors' and dpkg's backup files,
# see README.Debian for details.

# Include generic snippets of statements
Include /etc/apache2/conf.d/

# Include the virtual host configurations:
Include /etc/apache2/sites-enabled/ 
```

我在 apache 上的 www 的默认配置文件

```
NameVirtualHost *:80
<VirtualHost *:80>
    ServerAdmin info@example.com

    #SSLEnable
    #SSLVerifyClient none
    #SSLCertificateFile /usr/local/ssl/crt/public.crt  
    #SSLCertificateKeyFile /usr/local/ssl/private/private.key  

    DocumentRoot /var/www/site/trunk/html
    <Directory />
        Options FollowSymLinks
        AllowOverride all
    </Directory>
    <Directory /var/www/site/trunk/html>
        Options Indexes FollowSymLinks MultiViews
        AllowOverride all
        Order allow,deny
        allow from all
    </Directory>

    ScriptAlias /cgi-bin/ /usr/lib/cgi-bin/
    <Directory "/usr/lib/cgi-bin">
        AllowOverride None
        Options +ExecCGI -MultiViews +SymLinksIfOwnerMatch
        Order allow,deny
        Allow from all
    </Directory>

    ErrorLog /var/log/apache2/error.log

    # Possible values include: debug, info, notice, warn, error, crit,
    # alert, emerg.
    LogLevel warn

    CustomLog /var/log/apache2/access.log combined
    ServerSignature On

    Alias /doc/ "/usr/share/doc/"
    <Directory "/usr/share/doc/">
        Options Indexes MultiViews FollowSymLinks
        AllowOverride None
        Order deny,allow
        Deny from all
        Allow from 127.0.0.0/255.0.0.0 ::1/128
    </Directory>

</VirtualHost> 
```

我的 ssl 配置文件

```
NameVirtualHost *:443
<VirtualHost *:443>
    ServerAdmin info@example.com

    #SSLEnable
    #SSLVerifyClient none
    #SSLCertificateFile /usr/local/ssl/crt/public.crt  
    #SSLCertificateKeyFile /usr/local/ssl/private/private.key  

    DocumentRoot /var/www/site/trunk/html
    <Directory />
        Options FollowSymLinks
        AllowOverride all
    </Directory>
    <Directory /var/www/site/trunk/html>
        Options Indexes FollowSymLinks MultiViews
        AllowOverride all
        Order allow,deny
        allow from all
    </Directory>

    ScriptAlias /cgi-bin/ /usr/lib/cgi-bin/
    <Directory "/usr/lib/cgi-bin">
        AllowOverride None
        Options +ExecCGI -MultiViews +SymLinksIfOwnerMatch
        Order allow,deny
        Allow from all
    </Directory>

    ErrorLog /var/log/apache2/error.log

    # Possible values include: debug, info, notice, warn, error, crit,
    # alert, emerg.
    LogLevel warn

    SSLEngine On
        SSLCertificateFile /usr/local/ssl/crt/public.crt
        SSLCertificateKeyFile /usr/local/ssl/private/private.key

    CustomLog /var/log/apache2/access.log combined
    ServerSignature On

    Alias /doc/ "/usr/share/doc/"
    <Directory "/usr/share/doc/">
        Options Indexes MultiViews FollowSymLinks
        AllowOverride None
        Order deny,allow
        Deny from all
        Allow from 127.0.0.0/255.0.0.0 ::1/128
    </Directory>

</VirtualHost> 
```

我的 /etc/apache2/httpd.conf 是空白的

目录 /etc/apache2/conf.d 里面只有一个文件（字符集）

/etc/apache2/conf.dcharset 的内容

```
# Read the documentation before enabling AddDefaultCharset.
# In general, it is only a good idea if you know that all your files
# have this encoding. It will override any encoding given in the files
# in meta http-equiv or xml encoding tags.

#AddDefaultCharset UTF-8 
```

我的 apache 错误日志

```
[Wed Jun 03 00:12:31 2009] [error] [client 216.168.43.234] client sent HTTP/1.1 request without hostname (see RFC2616 section 14.23): /w00tw00t.at.ISC.SANS.DFind:)
[Wed Jun 03 05:03:51 2009] [error] [client 99.247.237.46] File does not exist: /var/www/site/trunk/html/favicon.ico
[Wed Jun 03 05:03:54 2009] [error] [client 99.247.237.46] File does not exist: /var/www/site/trunk/html/favicon.ico
[Wed Jun 03 05:13:48 2009] [error] [client 99.247.237.46] File does not exist: /var/www/site/trunk/html/favicon.ico
[Wed Jun 03 05:13:51 2009] [error] [client 99.247.237.46] File does not exist: /var/www/site/trunk/html/favicon.ico
[Wed Jun 03 05:13:54 2009] [error] [client 99.247.237.46] File does not exist: /var/www/site/trunk/html/favicon.ico
[Wed Jun 03 05:13:57 2009] [error] [client 99.247.237.46] File does not exist: /var/www/site/trunk/html/favicon.ico
[Wed Jun 03 05:17:28 2009] [error] [client 99.247.237.46] File does not exist: /var/www/site/trunk/html/favicon.ico
[Wed Jun 03 05:26:23 2009] [notice] caught SIGWINCH, shutting down gracefully
[Wed Jun 03 05:26:34 2009] [notice] Apache/2.2.8 (Ubuntu) PHP/5.2.4-2ubuntu5.6 with Suhosin-Patch mod_ssl/2.2.8 OpenSSL/0.9.8g configured -- resuming normal operations
[Wed Jun 03 06:03:41 2009] [notice] caught SIGWINCH, shutting down gracefully
[Wed Jun 03 06:03:51 2009] [notice] Apache/2.2.8 (Ubuntu) PHP/5.2.4-2ubuntu5.6 with Suhosin-Patch mod_ssl/2.2.8 OpenSSL/0.9.8g configured -- resuming normal operations
[Wed Jun 03 06:25:07 2009] [notice] caught SIGWINCH, shutting down gracefully
[Wed Jun 03 06:25:17 2009] [notice] Apache/2.2.8 (Ubuntu) PHP/5.2.4-2ubuntu5.6 with Suhosin-Patch mod_ssl/2.2.8 OpenSSL/0.9.8g configured -- resuming normal operations
[Wed Jun 03 12:09:25 2009] [error] [client 61.139.105.163] File does not exist: /var/www/site/trunk/html/fastenv
[Wed Jun 03 15:04:42 2009] [notice] Graceful restart requested, doing restart
[Wed Jun 03 15:04:43 2009] [notice] Apache/2.2.8 (Ubuntu) PHP/5.2.4-2ubuntu5.6 with Suhosin-Patch mod_ssl/2.2.8 OpenSSL/0.9.8g configured -- resuming normal operations
[Wed Jun 03 15:29:51 2009] [error] [client 99.247.237.46] File does not exist: /var/www/site/trunk/html/favicon.ico
[Wed Jun 03 15:29:54 2009] [error] [client 99.247.237.46] File does not exist: /var/www/site/trunk/html/favicon.ico
[Wed Jun 03 15:30:32 2009] [error] [client 99.247.237.46] File does not exist: /var/www/site/trunk/html/favicon.ico
[Wed Jun 03 15:45:54 2009] [notice] caught SIGWINCH, shutting down gracefully
[Wed Jun 03 15:46:05 2009] [notice] Apache/2.2.8 (Ubuntu) PHP/5.2.4-2ubuntu5.6 with Suhosin-Patch mod_ssl/2.2.8 OpenSSL/0.9.8g configured -- resuming normal operations 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2011-07-22T11:49:41.610

就我而言，我在 httpd.conf 中进行了更改：

> AllowOverride 无

至

> 允许覆盖所有

它有效。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-06-07T13:32:36.523

您可以轻松测试您的 htaccess 是否被读取：

*   将垃圾放入其中，例如：

    ```
    Options +FollowSymLinks
    This is garbage
    RewriteEngine on
    RewriteCond %{HTTP_HOST} ^www\.(.*) [NC]
    RewriteRule (.*) //%1/$1 [L,R=301] 
    ```

    如果您收到 500 错误（内部服务器错误），那么它正在被读取。

    如果是这样，您应该在主服务器配置（而不是 .htaccess）中启用 RewriteLog，如下所示：

    ```
    RewriteLog "/tmp/rewrite.log"
    RewriteLogLevel 9 
    ```

然后检查文件 /tmp/rewrite.log 看看发生了什么。报告结果。

（Stack Overflow 不是一个好的调试媒介，IRC 更好，试试#apache@irc.freenode.net）

祝你好运。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-06-08T22:48:46.160

正如文科所说，

```
RewriteLog "/tmp/rewrite.log"
RewriteLogLevel 9 
```

并查看该文件。

否则，这是我们用来从 zirconium.zrs.hr/~zatemas 重定向到 zatemas.zrs.hr 的代码：

```
RewriteEngine on

# For sites running on a port other than 80
RewriteCond %{HTTP_HOST}   !^zatemas\.zrs\.hr [NC]
RewriteCond %{HTTP_HOST}   !^$
RewriteCond %{SERVER_PORT} !^80$
RewriteRule ^/~zatemas/(.*)         http://zatemas.zrs.hr:%{SERVER_PORT}/$1 [L,R]

# And for a site running on port 80
RewriteCond %{HTTP_HOST}   !^192\.168\.1\.24 [NC]
RewriteCond %{HTTP_HOST}   !^zatemas\.zrs\.hr [NC]
RewriteCond %{HTTP_HOST}   !^$
RewriteRule ^/~zatemas/(.*)         http://zatemas.zrs.hr/$1 [L,R] 
```

我在网上看到人们主要通过查看端口是否为 443 来检测[HTTPS。mod_rewrite 文档](http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html)说应该适当地将变量 HTTPS 设置为打开或关闭 - 我假设你会`RewriteCond %{HTTPS} ^on$`测试它是否打开。

另请注意：`.htaccess`如果您正在访问用户主目录中的文件 - 例如 example.com/~username/，则 URL 重写指令不能很好地工作。不过，根据您的情况，这不应该打扰您。我上面的代码放在主服务器配置的`VirtualHost`部分下（更准确地说，在 中`/etc/apache2/sites-enabled/000-default`，但这是特定于 debian 的，并被合并到主配置中）。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-06-05T19:47:58.530

```
RewriteEngine on
RewriteCond %{HTTPS} =on
RewriteCond %{HTTP_HOST} ^www\.(.*) [NC]
RewriteRule ^(.*)$ https://%1$1 [L,R=301]
RewriteCond %{HTTP_HOST} ^www\.(.*) [NC]
RewriteRule ^(.*)$ http://%1$1 [L,R=301] 
```

与其他答案的两个细微变化：

来自最后一个匹配项的`%1`反向引用，因此对 HTTPS 的检查必须在主机名中对 www 的检查*之前进行。*`RewriteRule``RewriteCond`

 *`%1$1`中间不需要斜杠，因为您可以从`RewriteRule`.

最后一条建议：由于您可以控制`VirtualHost`主要 Apache 配置中的部分，因此将这些规则放在那里会更快。此外，您可以拆分它们，将纯 HTTP 放在 *:80 中，将 HTTPS 放在 *:443 中，这意味着您可以`RewriteCond %{HTTPS} =on`完全删除它们，因为它仅适用于针对该虚拟主机的请求。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-06-07T03:05:10.560

听起来您是在说您的 mod_rewrite 根本不起作用。这里有几件事可以尝试：

您说它已启用，但提供的信息：

```
root@s15348441:/etc/apache2/mods-available# more rewrite.load
LoadModule rewrite_module /usr/lib/apache2/modules/mod_rewrite.so 
```

只是在“mods-available”文件夹下显示它，这意味着它已安装，但不一定打开。如果它被启用，它应该在“mods-enabled”文件夹下进行符号链接（如果它不存在，你需要[a2enmod它）](http://www.digipedia.pl/man/a2enmod.8.html)

如果已启用并已重新启动，则下一步将启用 mod rewrite 的[日志记录功能](http://httpd.apache.org/docs/2.0/mod/mod_rewrite.html#rewritelog)；这是一个很好的调试工具。

**编辑添加：**您可以将 mod 重写移动到基本配置。如果您可以访问它，建议将您的配置放在基础部分（请参阅[此处](http://wiki.apache.org/httpd/Htaccess)）。它也更容易确定它是否与 mod_rewrite 有任何关系（就像你的 allowoverrides 变得混乱）或者它纯粹是一个 htaccess 问题。

**继续**：（@Vinko Vrsalovic 认为这是一个硬调试介质是正确的）如果你将它移到你的基本配置中并且它仍然无法工作，那么我们正在做一些事情，你已经消除了 .htaccess 部分。您应该发布新配置以及重写日志。如果您没有收到重写日志，那么 1）您的配置尚未加载（需要重新启动 apache）或 2）您没有点击您认为的配置部分

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2014-04-12T18:22:10.417

我遇到了同样的问题，这浪费了我 5 个小时来解决。

因此，为了使用 mod_rewrite，您可以在终端中键入以下命令：

```
a2enmod rewrite 
```

然后重新启动您的 Apache。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-06-10T17:36:59.517

首先，检查以确保 mod_rewrite 实际正在加载。你可以用 apache2ctl 做到这一点：

```
[root@host ~]# apache2ctl -t -D DUMP_MODULES 2>&1 |grep rewrite
rewrite_module (shared) 
```

如果不是，那么您可能必须运行“a2enmod rewrite”

接下来，测试您的 .htaccess 文件是否正在被读取。我通常通过在 .htaccess 文件中放入一些垃圾，然后在浏览器的该目录中加载一个页面并验证我收到 500 错误来做到这一点

附带说明一下，正如其他人所提到的，如果您能够直接修改 Apache 配置，则应该将重写规则放在那里而不是放在 .htaccess 文件中，因为它的效率较低。Apache 必须首先决定在哪个目录中查找 .htaccess 文件，然后读取它，然后执行重写。如果在您的 VirtualHost 指令中指定了 RewriteRules，那么它可以在找到 .htaccess 文件之前执行它们。在您的 VirtualHost 中指定它们也意味着您的 .htaccess 文件是否被读取并不重要。它看起来像这样：

```
 <VirtualHost *:80>
    .... existing config ....
    RewriteEngine on
    RewriteCond %{HTTP_HOST} ^www\.(.*) [NC]
    RewriteRule (.*) http://%1/$1 [L,R=301]
 </VirtualHost>
 <VirtualHost *:443>
    .... existing config ....
    RewriteEngine on
    RewriteCond %{HTTP_HOST} ^www\.(.*) [NC]
    RewriteRule (.*) https://%1/$1 [L,R=301]
 </VirtualHost> 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2011-12-21T21:25:29.960

以上解决方案都不适合我。我正在使用 apache 的每个目录上下文运行 CentOS...没有 VirtualHosts 或任何东西。在我注意到我的配置中默认情况下 NameVirtualHost 处于打开状态之前，我没有尝试过任何工作......关闭它之后，一切似乎都正常工作。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2013-05-14T19:47:03.280

我有一个类似的问题..Mod Rewrite 启用，.htaccess 权限是正确的，AllowOverride 设置为 All 但 .htaccess 没有被读取。经过数小时的痛苦并寻找答案，这就是我的问题：（希望这对任何人都有帮助）

除了我正在测试的站点之外，我还启用了另一个虚拟主机的站点，它共享一个公共目录根 (/var/www)，并且其他站点的 AllowOverride 设置为 none。解决方案只是使用“a2dissite”禁用其他站点

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-06-03T15:00:04.507

这个重写规则怎么样？

```
RewriteEngine On 
RewriteCond %{HTTP_HOST} ^www.example.com$ [NC]
RewriteRule ^(.*)$ http://example.com/$1 [R=301,L] 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2012-12-20T11:54:06.627

我在新安装的 CentOS 6 上制作 mod_rewrite 时遇到了问题。没有什么对我有用，直到我不小心看到*httpd.conf*`AllowOverride`里面有两个。一个在里面，一个在里面。我将两个值都更改为**All**，然后它起作用了。希望它可以帮助某人！*`<Directory />``<Directory "/var/www/html">`*

 ***PS我没有使用虚拟主机

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-06-10T18:03:13.863

您的 .htaccess 文件的文件权限是什么？

我不确定，但我认为它需要是 644。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2014-06-17T07:52:49.440

对我来说，缺少符号链接

```
ln -s /etc/apache2/mods-available/rewrite.load /etc/apache2/mods-enabled/rewrite.load 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2013-12-02T03:58:17.587

我有类似的问题，这对我有用。

在您的 httpd.conf 中，在虚拟主机下，确保您同时拥有：

服务器名称 domain.com

服务器别名 www.domain.com

VirtualHost *:80 和 VirtualHost *:443 中的两者

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-06-03T15:08:04.880

试试这个小技巧：

```
RewriteEngine on
RewriteCond %{HTTPS}s/%{HTTP_HOST} ^(on(s)|[^/]+)/www\.(.+) [NC]
RewriteRule ^ http%2://%3%{REQUEST_URI} [L,R=301] 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-06-03T15:54:09.670

或这个：

```
RewriteEngine on
RewriteCond %{HTTP_HOST} ^www\.(.*) [NC]
RewriteCond %{HTTP_PORT} =443
RewriteRule (.*) https://%1/$1 [L,R=301]
RewriteCond %{HTTP_HOST} ^www\.(.*) [NC]
RewriteRule (.*) http://%1/$1 [L,R=301] 
```

# c# - 头文件模板

> ID：945055
> 
> 赞同：0
> 
> 时间：2009-06-03T14:23:42.147
> 
> 标签：c#, .net, templates, header

是否有用于 .NET 源代码文件的标准模板？

我习惯于将我的标题信息放在 /* */ 标签之间，但 StyleCop 抱怨这些。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T16:10:27.863

永远不要将修订历史记录在源文件中，这就是您的源代码控制系统的用途。

至于标题，我建议 #region 是一个好主意（因为它是样板，应该从您的关注中删除，除非您正在编辑它，此时它是`/`/ 或`/*`.

因为`//`更健壮（没有嵌套问题）`//`是首选

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T15:05:04.637

只是一个想法，绝不是一个标准（或者就此而言，可能是一个好主意）。您是否考虑过使用属性？例如

```
[Author("Jonathan Dickinson")]
[Copyright("Copyright (c) Jonathan Dickinson 2009")]
[RevisionHistory(
        "jcd: Made the class.",
        "jcd: Made the class internal.")]
[License("GPL", LicenseType = LicenseType.CopyLeft)]
// Etc.
class Foo
{
} 
```

任何人都知道为什么这将是一种可怕的做法？

无论如何 - StyleCop 主要是为*商业*项目（通常不做代码头）而制作的。换句话说 - 忽略或禁用 friggen 警告。我一次又一次地读到 StyleCop 和 FXCop 太挑剔了。我看过以下格式的标题注释。

```
// <code-header>
//  <author>Jonathan Dickinson</author>
//  <copyright>Copyright (c) Jonathan Dickinson 2009</copyright>
//  <license href="license.txt">New BSD</license>
//  <revisions>
//    <revision initials="jcd">Made the file and class</revision>
//    <revision intiails="jcd">Made the class internal</revision>
//  </revisions>
// </code-header> 
```

它有明显的优势——统计数据（就像 Ohloh 所做的那样）和代码库的验证会立刻浮现在脑海中。

# jquery - 如何使用jQuery将Class添加到表内每个tr中的第一个td

> ID：945060
> 
> 赞同：3
> 
> 时间：2009-06-03T14:24:06.797
> 
> 标签：jquery, html, jquery-selectors, html-table

我正在尝试将一个类添加到特定类中 tr 内的第一个 td 。但是由于某种原因，它仅将此类添加到第一个 tr 中的第一个 td - 而不是每个 tr 中的第一个 td

```
$("#appendTD").find("#gridFormInformation").children(0).children().each(
                function() {
                    if ($("#appendTD").find('tr').filter(function() { return $(this).attr('class') == 'ui-widget-content ui-subtblcell'; }).children("td:eq(0)").addClass("leftbord"));
                }
            ); 
```

但是当我通过删除 ""td:eq(0)" 来更改上述内容时，它会将此类添加到每个 tr 中的每个 td ...那我做错了什么？

下面的标记示例

```
<td id="appendTD">
  <table id="gridFormInformation">
    <tbody>
      <tr><th>1</th><th>2</th><th>3</th></tr>
      <tr class="ui-widget-content ui-subtblcell"><td>1</td><td>2</td><td>3</td></tr>
      <tr class="ui-widget-content ui-subtblcell"><td>1</td><td>2</td><td>3</td></tr>
      <tr class="ui-widget-content ui-subtblcell"><td>1</td><td>2</td><td>3</td></tr>
    </tbody>
  </table>
</td> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-03T14:28:58.643

在我看来，您正在使用一种复杂的手动方式来查找要将类添加到的 td。我相信使用 jQuery 选择器来查找您的 tds 会更容易。

代替

```
$("#appendTD").find("#gridFormInformation").children(0).children().each(
            function() {
                if ($("#appendTD").find('tr').filter(function() { return $(this).attr('class') == 'ui-widget-content ui-subtblcell'; }).children("td:eq(0)").addClass("leftbord"));
            }
        ); 
```

和

```
$("#gridFormInformation tr.ui-widget-content.ui-subtblcell").find("td:first").addClass("leftbord"); 
```

这将找到所有 trs 并为每个 tr 找到第一个 td 并将类添加到其中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T14:28:23.730

更改`'td:eq(0)`为`'td:first'`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-21T15:52:27.160

此方法是添加`leftbord`到`<td>`表的每一行的第一个`gridFormInformation`：

```
$('#gridFormInformation tr td:first-child').addClass('leftbord'); 
```

# sql-server - 如何找出影响我的 SQL Server 的原因？

> ID：945063
> 
> 赞同：78
> 
> 时间：2009-06-03T14:24:27.903
> 
> 标签：sql-server, performance, cpu-usage

在今天的大部分时间里，我的 SQL Server CPU 一直在 90% 左右。

由于它一直在使用，我无法重新启动它。

是否有可能找出 SQL 中导致这种 CPU 过载的原因？

我已经运行了 SQL Profiler，但是发生了这么多事情，很难判断是否有什么特别的原因导致了它。

我已经运行了 sp_who2，但不确定所有内容的确切含义以及是否可以确定此处可能存在的问题。

为了抢占任何“它可能只是被大量使用”的响应，这只是在今天从完全正常的活动水平开始。

我正在寻找任何方法来找出导致 SQL 中 CPU 问题的原因。

* * *

## 回答 #1

> 赞同：110
> 
> 时间：2009-06-03T15:01:42.197

此查询使用 DMV 来识别 CPU 成本最高的查询

```
SELECT TOP 20
    qs.sql_handle,
    qs.execution_count,
    qs.total_worker_time AS Total_CPU,
    total_CPU_inSeconds = --Converted from microseconds
        qs.total_worker_time/1000000,
    average_CPU_inSeconds = --Converted from microseconds
        (qs.total_worker_time/1000000) / qs.execution_count,
    qs.total_elapsed_time,
    total_elapsed_time_inSeconds = --Converted from microseconds
        qs.total_elapsed_time/1000000,
    st.text,
    qp.query_plan
FROM
    sys.dm_exec_query_stats AS qs
CROSS APPLY 
    sys.dm_exec_sql_text(qs.sql_handle) AS st
CROSS APPLY
    sys.dm_exec_query_plan (qs.plan_handle) AS qp
ORDER BY 
    qs.total_worker_time DESC 
```

有关完整说明，请参阅：[How to identify the most costly SQL Server queries by CPU](http://www.johnsansom.com/how-to-identify-the-most-costly-sql-server-queries-using-dmvs/)

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2009-06-03T18:01:07.197

我在这里假设尽职调查您确认 CPU 实际被 SQL 进程消耗（perfmon 进程类别计数器会确认这一点）。通常对于这种情况，您会抽取相关性能计数器的样本，并将它们与您在正常负载操作条件下建立的基线进行比较。一旦你解决了这个问题，我建议你为将来的比较建立这样的基线。

您可以准确地找到 SQL 在每个 CPU 周期中花费的位置。但是知道在哪里看需要很多知识和经验。是 SQL 2005/2008 还是 2000？幸运的是，对于 2005 年及之后的版本，有一些现成的解决方案。您已经在 J​​ohn Samson 的回答中得到了一些很好的指导。我想添加一个下载和安装[SQL Server Performance Dashboard Reports](http://www.microsoft.com/downloads/details.aspx?FamilyId=1d3a4a0d-7e0c-4730-8204-e419218c1efc&displaylang=en)的建议。其中一些报告包括按时间或按 I/O 的热门查询、最常用的数据文件等，您可以快速了解问题所在。输出是数字和图形的，因此对初学者更有用。

我还建议使用[Adam 的 Who is Active](http://whoisactive.com/downloads/)脚本，尽管它更高级一些。

最后但同样重要的是，我建议您下载并阅读 MS SQL 客户咨询团队关于性能分析的白皮书：[SQL 2005 Waits and Queues](http://sqlcat.com/whitepapers/archive/2007/11/19/sql-server-2005-waits-and-queues.aspx)。

我的建议也是查看 I/O。如果您向服务器添加了一个负载，该负载会破坏缓冲池（即，它需要如此多的数据，以至于它会从内存中逐出缓存的数据页），那么结果将是 CPU 的显着增加（听起来令人惊讶，但确实如此）。罪魁祸首通常是端到端扫描大表的新查询。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2018-11-05T10:57:34.347

您可以在此处找到一些有用的查询：

[调查 SQL Server 高 CPU 的原因](https://blogs.msdn.microsoft.com/docast/2017/07/30/sql-high-cpu-troubleshooting-checklist/)

对我来说，这有很大帮助：

```
SELECT s.session_id,
    r.status,
    r.blocking_session_id 'Blk by',
    r.wait_type,
    wait_resource,
    r.wait_time / (1000 * 60) 'Wait M',
    r.cpu_time,
    r.logical_reads,
    r.reads,
    r.writes,
    r.total_elapsed_time / (1000 * 60) 'Elaps M',
    Substring(st.TEXT,(r.statement_start_offset / 2) + 1,
    ((CASE r.statement_end_offset
WHEN -1
THEN Datalength(st.TEXT)
ELSE r.statement_end_offset
END - r.statement_start_offset) / 2) + 1) AS statement_text,
    Coalesce(Quotename(Db_name(st.dbid)) + N'.' + Quotename(Object_schema_name(st.objectid, st.dbid)) + N'.' +
    Quotename(Object_name(st.objectid, st.dbid)), '') AS command_text,
    r.command,
    s.login_name,
    s.host_name,
    s.program_name,
    s.last_request_end_time,
    s.login_time,
    r.open_transaction_count
FROM sys.dm_exec_sessions AS s
    JOIN sys.dm_exec_requests AS r
ON r.session_id = s.session_id
    CROSS APPLY sys.Dm_exec_sql_text(r.sql_handle) AS st
WHERE r.session_id != @@SPID
ORDER BY r.cpu_time desc 
```

在 的字段中，`status`您可以找到当前正在运行的最消耗 CPU 的任务。`wait_type``cpu_time`

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-06-03T14:58:52.840

您可以运行 SQL Profiler，并按 CPU 或持续时间进行过滤，以便排除所有“小东西”。那么确定您是否有问题（例如运行时间长得多的特定存储过程（可能是缺少索引或其他东西））应该会容易得多。

两个警告：

*   如果问题是大量的小交易，那么我上面描述的过滤器会排除它们，你会错过这个。
*   此外，如果问题是一个单一的、庞大的工作（比如一个 8 小时的分析工作或一个设计不良的选择，必须交叉连接十亿行），那么在它完全完成之前，您可能不会在分析器中看到它，具体取决于关于您正在分析的事件（sp:completed vs sp:statementcompleted）。

但通常我从活动监视器或 sp_who2 开始。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-06-03T14:29:11.747

每隔几秒钟运行其中任何一个。您将检测到高 CPU 连接。或者：将 CPU 存储在局部变量中，WAITFOR DELAY，比较存储的和当前的 CPU 值

```
select * from master..sysprocesses
where status = 'runnable' --comment this out
order by CPU
desc

select * from master..sysprocesses
order by CPU
desc 
```

可能不是最优雅的，但它会有效且快速。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-06-03T14:40:33.253

对于 GUI 方法，我将查看 Management 下的 Activity Monitor 并按 CPU 排序。

# c# - 是否可以在 C# 中使用 BDE 创建的表？

> ID：945064
> 
> 赞同：0
> 
> 时间：2009-06-03T14:24:28.120
> 
> 标签：c#, database, bde

我有一些与 Borland 数据库引擎一起使用的表，我需要在 C# 中访问这些表。但我不认为 BDE 是可用的数据源。这是因为它不可行还是其他原因。如果有人有任何信息或链接可提供有关如何完成此操作的信息，我将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-03T14:44:02.933

我想您将不得不为此使用 ODBC 驱动程序。

如果您使用的是 ODBC，那么您将需要搜索如何为其创建连接字符串。

调查

系统.数据.ODBC

和

System.Data.Odbc.OdbcConnection

忽略上面的，应该是 OLEDB 见下面的链接。在我发现的一些链接中，有一些 Borland 纯粹主义者说“当你可以保持相同的技术堆栈时，为什么要在 c# 中工作”，但我认为大多数语言都是一样的，它们都有纯粹主义者。

我也刚刚找到这个链接

[从 C# 连接到 BDE Paradox](http://www.progware.org/Blog/post/Connecting-to-a-PARADOX-DB-with-C-(Vista-XP).aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-03T16:01:55.960

您尝试访问的文件的扩展名是什么？BDE 可以处理多种文件类型：FoxPro/dBase、Paradox、ASCII，有时甚至是 Access。在 Paradox 之外，使用 C# 进行访问应该没有问题。正如 Peter 所说，ODBC 可能是从 C# 访问 paradox 文件的最简单方法，您只需要找到 Paradox ODBC 驱动程序即可。

# svn - 源代码管理的最佳实践是什么？

> ID：945068
> 
> 赞同：4
> 
> 时间：2009-06-03T14:24:46.683
> 
> 标签：svn, version-control

我们是一个地理多元化的软件开发团队，致力于 ERP 系统。我们使用 SVN 作为版本控制系统。在代码转移到生产系统之前，我们有 4 个环境。

我想知道在这种情况下使用 SVN 时，关于分支、合并的最佳做法是什么。

目前我们面临一个问题，一个文件有4个变化。客户只希望 X（每年 4 个主要版本和 4 个次要版本）版本中有 2 个更改。

我们面临的问题是：分支太多。复杂的手动合并。丢失跟踪或更改覆盖其他人的代码。

任何人都可以回答如何通过使用 SVN 作为更好的工具来解决这个问题，它就是。

谢谢和问候， Kedar Hukeri。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-03T14:33:57.510

也许如何将代码获取到主分支的过程将比不同的工具（除了具有良好差异/合并的源控制系统之外）提供更多帮助。

这取决于您的流程，但通常：

*   大型团队的良好做法是每个新功能/修复都有一个单独的分支
*   开发人员在将代码发布到主线之前会将最新的从主线拉到他的分支并运行所有测试以确保一切正常
*   如果团队很大，您可能需要考虑一个发布经理 - 一个管理发布并简单地冻结主分支并管理功能进入顺序的人
*   更好的是，有发布分支和允许将新功能合并到其中的人，开发人员提交说明新功能已准备好并且一个人将更改合并到主分支
*   在发布之前冻结发布分支并运行测试以消除错误，当您接近发布日期时，不要只在错误修复中允许新功能
*   取决于提交的数量，但您可以创建更小的版本，这些版本经过更多测试以建立里程碑和功能，以便在每个点版本中工作

最后，无论具体流程是什么，重点是开发人员了解流程并有人执行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T14:31:12.787

首先要开始的地方之一是您可能已经咨询过的地方：[带有 Subversion 的版本控制](http://svnbook.red-bean.com/)。还可以查看[Subversion 开发团队](http://subversion.tigris.org/)引用[的书籍列表](http://subversion.tigris.org/links.html#books)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-03T14:39:17.543

首先，请阅读：http: [//oreilly.com/catalog/practicalperforce/chapter/ch07.pdf](http://oreilly.com/catalog/practicalperforce/chapter/ch07.pdf)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-03T15:01:19.527

我分享你的痛苦，在 SVN 上遇到同样的问题，一旦你开始大量分支（你必须为了处理项目生命中的所有不同情况），当你开始合并时会有很大的痛苦，如果分支持续足够长的时间，合并本身就是一个完整的“项目”......

当然，更好的做法是有用的，但如果该工具允许轻松执行其中一些做法，那就太好了。

我被推荐了 Mercurial，我目前正在研究它来替换 SVN，它是按设计分发的，有（我被告知）更好的合并工具和更好/更容易的分支/存储库管理，所以你可能想看看也加入其中。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-03T15:37:07.777

您所要求的是统一变更管理，而这正是 Subversion 并没有真正设计好的东西（IMO）。管理更改将需要一些手动操作。但假设你有合适的问题跟踪系统，这就是我工作过的许多地方所做的：

```
main branch (trunk)  - new feature development here 
  |- release-1.0  - locked release branch 
  |--- release-sp1
  |--- release-patches - patch release fix stream (new fixes merged here)
  |------ release-sp1-issue# - this is where you make your bug fixes 
                               before merging them. 
                               This issue# is the bug-id in your tracking system. 
```

修复错误并提交到补丁版本后，您将删除旧的 -issue# 分支。这可以防止分支失控，但可以让您保持较小的变更集。

可以通过使发布干线仅对集成商可写来强制维护者。通过 apache 使用 subversion：[Subversion/Apache Permissions](http://www.robert-gonzalez.com/2007/10/29/customizing-subversion-permissions/)，您可以创建一个组、集成商，并在您的项目上设置以下权限

```
project 
  |- branches  (everyone: rw) 
      |- individual-fixes
  |- release-branches: (integrator: rw, everyone: ro) 
      |- release-1.0-fixes
      |- release-2.0-fixes
  |- trunk     (integrator: rw, everyone: ro) <- new dev goes here!!!!
  |- tags      (integrator: rw, everyone: ro) 
      |- release-1.0
      |- release-1.0-sp1 
      |- release-2.0 
```

然后每次合并都很小，跟踪很好，只有一小部分人可以做合并。但是，这会给您的合并团队造成瓶颈。我从未与大型 git/mercurial 团队合作过，以了解其工作原理。

您也可以为功能修复实现类似的东西，但不要使用您的后备箱。

# sql-server - SQL Server 2008 性能：无索引与坏索引？

> ID：945074
> 
> 赞同：1
> 
> 时间：2009-06-03T14:26:17.773
> 
> 标签：sql-server, sql-server-2008, indexing

我在 Microsoft SQL Server 2008 中遇到了一个奇怪的问题。我有一个包含大约 10 个表的大型数据库（20 GB），我试图说明如何正确创建索引。

这是我的问题：在一些嵌套查询中，我在**不**使用索引的情况下获得了更快的结果！它很接近（一两秒），但在某些情况下，根本不使用索引似乎会使这些查询运行得更快......我正在运行 Checkpoiunt 和 DBCC dropcleanbuffers 以在运行脚本之前重置缓存，所以我我有点迷路了。

这可能是什么原因造成的？我知道索引构造不佳（认为每个相关字段一个索引）的事实，重点是证明正确构造它们的重要性，但它**永远不**应该比没有索引慢，对吧？

编辑：这是有罪的查询之一：

```
SET STATISTICS TIME ON
SET STATISTICS IO ON

USE DBX;
GO
CHECKPOINT;
GO
DBCC DROPCLEANBUFFERS;
GO
DBCC FREEPROCCACHE;
GO

SELECT * FROM Identifier where CarId in (SELECT CarID from Car where ManufactId = 14) and DataTypeId = 1 
```

标识符表： - IdentifierId int not null - CarId int not null - DataTypeId int not null - Alias nvarchar(300)

汽车表： - CarId int not null - ManufactId int not null - （后面的几个字段，所有 nvarchar(100)

这些要点中的每一个都有一个索引，以及一些同时存储其中两个的索引（例如 CarId 和 DataTypeId）。

最后，标识符表有超过百万的条目，而汽车表有两三百万

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-03T14:36:31.170

我的猜测是 SQL Server 错误地决定使用索引，然后强制进行书签查找*。通常发生这种情况（索引使用不正确）是因为表上的统计信息不正确。

如果您刚刚将大量数据加载到一个或多个表中，则尤其会发生这种情况。或者，可能是 SQL Server 搞砸了。这种情况很少发生（一方面我可以数数在 SQL Server 的 15 年职业生涯中我不得不强制使用索引的次数），但优化器并不完美。

* 书签查找是 SQL Server 在索引上找到它需要的行，但随后必须转到实际数据页以检索不在索引中的其他列。如果您的结果集返回大量行，则成本可能会很高，并且聚集索引扫描可以带来更好的性能。

摆脱书签查找的一种方法是使用覆盖索引 - 一个首先具有过滤列的索引，然后还包括您在“覆盖”查询中需要的任何其他列。例如：

```
SELECT
     my_string1,
     my_string2
FROM
     My_Table
WHERE
     my_date > '2000-01-01' 
```

覆盖索引将是 (my_date, my_string1, my_string2)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T14:31:11.617

通常，SQL Server 在决定使用什么索引以最快的方式检索数据方面做得很好。很多时候它会决定不使用任何索引，因为它可以更快地从小表中检索少量数据而无需离开索引（在某些情况下）。

听起来，在您的情况下，SQL 可能没有采用最佳路线。拥有大量创建错误的索引可能会导致它选择错误的路径来获取数据。

我建议在 Management Studio 中查看查询计划，以检查其使用的索引以及花费的时间。这应该让您知道从哪里开始。

另一个注意事项是，这些索引可能随着时间的推移变得支离破碎，现在没有发挥出最佳性能，可能值得检查一下，并在需要时重建其中的一些。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T14:32:29.383

*除非您拥有许多*记录，否则索引实际上并没有任何好处。我说很多是因为我真的不知道那个临界点是什么……这取决于具体的应用和环境。

SQL Server 使用索引确实需要时间。如果该时间超过了收益......这在子查询中尤其如此，其中小的差异会成倍增加。

如果没有索引效果更好，请忽略索引。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-03T14:34:08.913

尝试[DBCC FREEPROCCACHE](http://msdn.microsoft.com/en-us/library/ms174283.aspx)以清除执行计划缓存。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-03T14:34:10.580

这是一个空洞的猜测。也许如果你有很多索引，SQL Server 会花时间分析和挑选一个，然后拒绝所有的。如果您没有索引，引擎就不必在这个审查过程中浪费时间。

这个审查过程实际上需要多长时间，我不知道。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-03T14:35:13.620

对于某些查询，直接从表中读取（聚集索引扫描）比从表中读取索引并获取记录（索引扫描+书签查找）更快。

考虑一条记录与数据页中的其他记录一起存在。数据页是IO的基本单元。如果直接读取该表，则以 1 次 IO 为代价可以获得 10 条记录。如果直接读取索引，然后从表中取出记录，则必须为每条记录支付 1 IO。

通常，SQL Server 非常擅长选择访问表的最佳方式（直接与索引）。您的查询中可能有一些东西使优化器蒙蔽了双眼。查询提示可以指示优化器在错误时使用索引。连接提示可以改变访问表的顺序或方法。优化器认为表变量有 0 条记录，所以如果你有一个大的表变量 - 优化器可能会选择一个错误的计划。

还有一件事要注意 - varchar vs nvarchar。确保所有参数与目标列的类型相同。有一种情况，如果类型不匹配，SQL Server 会将*整个索引*转换为参数的类型。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-03T14:31:11.103

检查执行计划以查看它是否使用了您“知道”不好的这些索引之一？

通常，索引会减慢写入数据的速度，并有助于加快读取数据的速度。

所以，是的，我同意你的看法。它**永远不**应该比没有索引慢。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-03T14:35:49.017

SQL 服务器实际上为您创建了一些索引（例如在主键上）。

索引可能会变得支离破碎。

太多的索引总是会降低性能（有关于为什么不索引数据库中的每个列的常见问题解答）

在某些[情况下，索引总是会变慢](http://en.wikipedia.org/wiki/Index_(database)#Applications_and_limitations)。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-03T14:36:09.440

跑：

```
SET SHOWPLAN_ALL ON 
```

然后在使用和不使用索引的情况下运行您的查询，这将让您查看正在使用的索引（如果有的话），“工作”在哪里等。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-06-03T14:39:19.557

在决定使用索引来加速查询之前，没有 Sql Server 会同时分析索引和统计信息。运行非索引版本完全有可能比索引版本更快。

有几件事要尝试

1.  确保创建和重建索引，并重新组织（碎片整理）。

2.  确保自动创建统计信息已打开。

3.  尝试使用 Sql Profiler 捕获优化配置文件，然后使用数据库引擎优化顾问创建索引。

令人惊讶的是，用于 Sql 管理的 MS Press 考试书很好地解释了索引和统计数据。

请参阅本书的亚马逊阅读器预览中的第 4 章目录

[Sql 2008 MCTS 考试书的亚马逊阅读器](http://www.amazon.ca/gp/reader/0735626057/ref=sib_rdr_toc?ie=UTF8&p=S009&j=0#reader-page)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-06-03T15:33:25.440

对我来说，听起来你的 sql 写得很糟糕，因此没有利用你正在创建的索引。

您可以添加索引，直到您脸色发青，但如果您的查询没有优化以使用这些索引，那么您将不会获得任何性能提升。

给我们一个您正在使用的查询示例。

好的...

试试这个，看看你是否获得任何性能提升（使用 pk 索引）

```
SELECT i.* 
FROM Identifier i 
    inner join Car c
        on i.CarID=c.CarID
where c.ManufactId = 14 and i.DataTypeId = 1 
```

# iphone - 多线程 ViewController 中的 UIWebView

> ID：945082
> 
> 赞同：9
> 
> 时间：2009-06-03T14:27:18.397
> 
> 标签：iphone, objective-c, cocoa-touch, memory-management, uikit

我在视图控制器中有一个 UIWebView，它有以下两种方法。问题是如果我在第二个线程完成之前弹出（点击导航栏）这个控制器，应用程序将在 [super dealloc] 之后崩溃，因为“试图从主线程以外的线程获取网络锁或web 线程。这可能是从辅助线程调用 UIKit 的结果。”。任何帮助将非常感激。

```
-(void)viewDidAppear:(BOOL)animated {
    [super viewWillAppear:animated];
    NSInvocationOperation *operation = [[NSInvocationOperation alloc] initWithTarget:self selector:@selector(load) object:nil];
    [operationQueue addOperation:operation];
    [operation release];
}

-(void)load {
    [NSThread sleepForTimeInterval:5];
    [self performSelectorOnMainThread:@selector(done) withObject:nil waitUntilDone:NO];
} 
```

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2010-11-28T20:53:40.547

我有相同的解决方案，其中后台线程是最后一个版本，导致视图控制器的解除分配发生在后台线程中，最终导致相同的崩溃。

以上`[[self retain] autorelease]`仍然会导致最终释放发生在后台线程的自动释放池中。（除非自动释放池中的版本有什么特别之处，否则我很惊讶这会有所作为）。

我发现这是我理想的解决方案，将此代码放入我的视图控制器类中：

```
- (oneway void)release
{
    if (![NSThread isMainThread]) {
        [self performSelectorOnMainThread:@selector(release) withObject:nil waitUntilDone:NO];
    } else {
        [super release];
    }
} 
```

这确保了`release`我的视图控制器类的方法总是在主线程上执行。

我有点惊讶的是，某些只能从主线程正确释放的对象还没有内置这样的东西。哦，好吧......

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-04-13T01:27:02.080

这是一些在主线程上运行 UIKit 元素的代码。如果您正在处理不同的线程并且需要运行一段 UIKit 代码，只需将它放在这个 Grand Central Dispatch 片段的括号之间。

```
dispatch_async(dispatch_get_main_queue(), ^{

    // do work here

}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T14:52:28.127

通常，当使用它们的视图消失时，您应该取消任何后台操作。如：

```
- (void)viewWillDisappear:(BOOL)animated {
  [operationQueue cancelAllOperations];
  [super viewWillDisappear:animated;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-07-31T14:11:26.837

我目前在我的应用程序中有类似的问题。显示 UIWebView 的视图控制器被推送到导航控制器并启动后台线程以检索数据。如果您在线程完成之前点击后退按钮，应用程序将崩溃并显示相同的错误消息。

问题似乎是`NSThread`保留目标（自我）和对象（参数）并在方法运行后释放它 - 不幸的是它从线程内释放。因此，当创建控制器时，保留计数为 1，当线程启动时，控制器的保留计数为 2。当您在线程完成之前弹出控制器时，导航控制器释放控制器，从而导致保留计数为 1。到目前为止，这很好——但是如果线程最终完成，则`NSThread`释放控制器，这导致保留计数为 0 并从线程内立即释放。这使得 UIWebView（在控制器的 dealloc 方法中释放）引发该线程警告异常并崩溃。

我通过使用`[[self retain] autorelease]`线程中的最后一条语句（就在线程释放其池之前）成功地解决了这个问题。这确保了控制器对象不会立即释放，而是标记为自动释放并稍后在主线程的运行循环中释放。然而，这是一个有点肮脏的黑客，我宁愿找到一个更好的解决方案。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-09-27T16:06:12.483

我试过 ：

```
[self retain];
[self performSelectorOnMainThread:@selector(release) withObject:nil waitUntilDone:NO]; 
```

这似乎效果更好。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-03T20:33:09.480

我不确定根据您的代码到底发生了什么，但看起来 viewDidAppear 被调用并创建第二个线程，然后您离开控制器并释放它，然后第二个线程完成并调用 performSelectorOnMainThread在释放的对象“自我”上。我想你可能只需要检查释放没有发生吗？

您收到的错误消息意味着您正在从第二个线程运行一些 UIKit 代码。Apple 最近为 UIKit 的线程调用添加了一些检查，我认为您可能只需要重构加载函数以更新主线程上的 UI，而不是从第二个线程调用 UIWebView 函数。

希望有帮助！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-09-11T03:21:25.053

我尝试了上面发布的两种解决方案`[operationQueue cancelAllOperations]`，和`[[self retain] autorelease]`。但是，通过快速单击，仍然存在保留计数降至 0 并且类在辅助线程上被释放的情况。为了避免崩溃，我`dealloc`现在将以下内容放入我的：

```
 if ([NSThread isMainThread]) {
        [super dealloc];
    } 
```

这是一个明显的泄漏，但似乎是两害相权取其轻。

欢迎遇到此问题的任何人提供任何其他见解。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-09-13T09:18:49.197

```
- (void)dealloc
{
    if(![NSThread isMainThread]) {
        [self performSelectorOnMainThread:@selector(dealloc) 
                               withObject:nil 
                            waitUntilDone:[NSThread isMainThread]];
        return;
    } 
    [super dealloc];
} 
```

# windows - 设置 grep 行尾字符

> ID：945083
> 
> 赞同：2
> 
> 时间：2009-06-03T14:27:19.283
> 
> 标签：windows, cygwin, grep

我有一个相当简单的 bash 脚本，它执行一些 grep 来查找文件中与模式不匹配的所有文本。

```
grep -v $1 original.txt >trimmed.txt 
```

输入文件以 Windows 行结束字符结束每一行，即以回车和换行符 CR LF。

该命令的输出（在 Cygwin 中运行）以额外的回车结束每一行，即 CR CR LF。

我如何告诉 grep 只使用 CR LF？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-03T14:33:50.240

我认为您只能在 Cygwin 安装期间配置 EOL 设置。

如果您`dos2unix`先运行原始文件，那么`grep`应该能够正确处理（您可能希望`unix2dos`稍后运行以恢复 EOL）

# c# - CodePlex 对表达式树序列化库的看法？

> ID：945085
> 
> 赞同：5
> 
> 时间：2009-06-03T14:27:29.987
> 
> 标签：c#, linq, wcf, entity-framework, serialization

有人试过这个代码库并对它有意见吗？ [http://code.msdn.microsoft.com/exprserialization](http://code.msdn.microsoft.com/exprserialization)

10倍

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2011-06-14T22:13:10.983

看起来该项目已被放弃，但我做了一些工作，现在它可以与 .NET 4.0 和 Silverlight 一起使用。我对他们的代码进行了错误修复，并使其更加独立于 DAL。

[http://expressiontree.codeplex.com/](http://expressiontree.codeplex.com/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-29T00:46:22.547

我发现它无法序列化自定义闭包，我目前正在编写自己的二进制序列化程序。话虽如此，.net 4.0 中不包含表达式树序列化这一事实非常令人失望。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-09-23T07:44:05.607

我正在使用这个库来序列化/反序列化“linq to object”查询。图书馆在这方面做得很好。有一些问题，但由于图书馆的开源，我能够修复它们。不再支持它的问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-03-13T04:18:26.217

这个库的安全方面对我来说真的很可怕。这几乎就像执行来自配置或通过请求的任意代码。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-03T16:11:43.433

它用于 ADO.NET 数据服务的客户端代理中，用于针对 RESTful 服务执行 LINQ 查询，并使该查询序列化并在服务上执行。根据我的经验，效果很好。

如果您想测试它的实用性，请尝试使用[ADO.NET 数据服务](http://www.microsoft.com/uk/msdn/nuggets/nugget/310/ADONET-Data-Services-Querying-with-LINQ.aspx "ADO.NET 数据服务")。

# actionscript-3 - 可以在 AS3 中保存 XML 文件

> ID：945086
> 
> 赞同：8
> 
> 时间：2009-06-03T14:28:02.357
> 
> 标签：actionscript-3

```
var xml:XML = <myXml>
                    <item prop="1" />
                    <item prop="2" />
                </myXml>; 
```

我需要在本地硬盘（项目目录）中保存为 xml 文件。

是否可以保存 as3 本身？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-08-28T23:51:44.263

我把它放在一起，果然您可以使用以下作为极简示例来保存到 .XML。

```
package com.hodgedev.xmlcreator
{
    import flash.display.Sprite;
    import flash.events.Event;
    import flash.events.MouseEvent;
    import flash.utils.ByteArray;
    import flash.net.FileReference;

/**
 * ...
 * @author Brian Hodge (brian@hodgedev.com)
 */
public class Main extends Sprite 
{
    private var _xml:XML;

    public function Main():void 
    {
        if (stage) init();
        else addEventListener(Event.ADDED_TO_STAGE, init);
    }

    private function init(e:Event = null):void 
    {
        removeEventListener(Event.ADDED_TO_STAGE, init);

        //Calling the save method requires user interaction and Flash Player 10
        stage.addEventListener(MouseEvent.MOUSE_DOWN, _onMouseDown);

        _xml= <xml>
              <test>data</test>
              </xml>;
    }
    private function _onMouseDown(e:MouseEvent):void
    {
        var ba:ByteArray = new ByteArray();
        ba.writeUTFBytes(_xml);
        //ba.

        var fr:FileReference = new FileReference();
        fr.addEventListener(Event.SELECT, _onRefSelect);
        fr.addEventListener(Event.CANCEL, _onRefCancel);

        fr.save(ba, "filename.xml");
    }
    private function _onRefSelect(e:Event):void
    {
        trace('select');
    }
    private function _onRefCancel(e:Event):void
    {
        trace('cancel');
    }
} 
```

}

有一些事情需要注意。

*   您需要 Flash Player 10 才能使用`FileReference`该类的保存方法。
*   为了执行任何触发提示的操作，Flash 需要用户交互，例如键盘或鼠标输入。

在上面，我`MouseEvent.MOUSE_DOWN`在舞台上监听作为调用保存提示所需的用户交互。

我在代码中设置了一个基本的 XML 结构（这通常来自外部源，并且两种方式都可以正常工作。

创建A`ByteArray`并将 XML 写入`ByteArray`.

类的保存方法`FileReference`需要一个`ByteArray`和默认保存名称作为两个参数传递。

我希望这有帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-03T05:39:04.930

如果您想将其存储在本地（在客户端 PC 上），您可以使用本地共享对象。参考本[教程](http://www.tutorio.com/tutorial/flash-cookies-local-shared-objects-tutorial)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T16:11:09.283

对不起，你的问题不是很清楚。

您是否在问是否可以从用 AS3 编写的编译 SWF 中将文件保存到硬盘驱动器？

或者您是否在问是否可以在您的 AS3 项目中包含原始 XML 文件而无需将其写为变量？

如果您的意思是前者，不——没有 Adob​​e AIR。您可以在本地将数据保存为 SharedObject，但不能保存为文件系统中的任意文件。

如果是后者，那么可以——您必须像嵌入其他资源（例如图像或声音）一样嵌入文件。但是，看起来 Flash 中可能存在一个错误，这使得弄清楚如何去做并不是一件容易的事。

[此链接可能对您有所帮助。](http://forums.tigsource.com/index.php?topic=6208.0)

```
[Embed(source='../../../../assets/levels/test.xml', mimeType="application/octet-stream")]
public static const Level_Test:Class; 
```

然后解析 XML：

```
var ba:ByteArray = (new Levels.Level_Test()) as ByteArray;
var s:String = ba.readUTFBytes( ba.length );
xml = new XML( s ); 
```

如果这些问题都不是你真正要问的，我深表歉意。

干杯!

# c++ - 使用 JNI 在 C++ 中调用方法？

> ID：945087
> 
> 赞同：3
> 
> 时间：2009-06-03T14:28:05.307
> 
> 标签：c++, methods, java-native-interface

所以我一直在研究 JNI 调用，以便我可以与一些预先编写的 C++ 程序进行交互，我不知道任何 C++，但我正在尝试学习一些基础知识。我刚刚尝试对我的 JNI 方法之外的方法进行简单调用，但总是收到以下错误：

错误 c3861 'myMethod': 找不到标识符

```
#include <stdio.h>
#include <string.h>
#include "StringFuncs.h"    

JNIEXPORT jstring JNICALL Java_StringFuncs_changeWord(JNIEnv *env, jobject obj, jstring inStr, jint inLen) 
{
    const char *inString;

    inString = env->GetStringUTFChars(inStr, NULL);

    char otherString[40];
    strcpy_s(otherString,inString);

    if(myMethod())
    {
        memset(otherString, '-', inLen);
    }

    jstring newString = env->NewStringUTF((const char*)otherString);
    return newString;
}

bool myMethod()
{
    return true;
}

int main()
{
    return 0;
} 
```

有什么睿智的话？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-03T14:49:39.740

您必须在调用它们之前声明您的方法。所以在你的标题类型 bool myMethod();

或者您可以将代码移到 _changeWord 函数上方，然后声明/定义合二为一。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T14:50:19.550

将 myMethod() 移到源文件中 Java_StringFuncs_changeWord() 的上方。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-03T15:00:22.183

在 C++ 中，您通常必须在使用符号之前声明它。因此，在 Java_StringFuncs_changeWord 之前的某个地方，您需要声明 myMethod：

```
bool myMethod(); 
```

如果这将是一个共享函数（其他 cpp 模块将调用它），那么您很可能希望将它放在一个头文件中，该头文件可以被其他文件#included。如果该函数只对此模块调用有意义，则您希望将声明放在文件顶部，在其他 #include 之后。

您还可以通过将整个函数移到调用它的函数上方来一次性声明和定义该函数，但这并不总是有效（如果您有两个相互引用的函数，则必须有一个单独的声明）。

# unit-testing - 如何使用 StructureMap 2.5.3 自带的 MoqAutoMocker？

> ID：945089
> 
> 赞同：5
> 
> 时间：2009-06-03T14:28:18.597
> 
> 标签：unit-testing, structuremap, moq

我正在尝试使用 StructureMap 附带的 MoqAutoMocker 类，但我找不到任何应该如何使用它的示例。我所要做的就是[在 StructureMap 站点上使用 RhinoMocks 的示例](http://structuremap.sourceforge.net/AutoMocker.htm#section1)。

我想要做的是使用 Get 方法获取对我的自动模拟/注入依赖项之一的引用。根据上面的链接，我应该能够做这样的事情

```
 // This retrieves the mock object for IMockedService
    autoMocker.Get<IMockedService>().AssertWasCalled(s => s.Go()); 
```

请注意如何使用 AssertWasCalled，它指示 Get 函数返回对 RhinoMocks Mock 对象的引用？当我使用 MoqAutoMocker 时，同样的代码对我不起作用。

我有一个类 SignInController，它依赖于构造函数中的 ISecurityService。使用 MoqAutoMocker 就像示例中使用的 RhinoAutoMocker 一样，我想我应该能够做到这一点......

```
var autoMocker = new MoqAutoMocker<SignInController>();
autoMocker.Get<ISecurityService>().Setup(ss => ss.ValidateLogin
(It.IsAny<string>(), It.IsAny<string>())).Returns(true); 
```

但问题是我永远无法访问 Setup 方法。在这种情况下，对 autoMocker.Get 的调用似乎返回了 ISecurityService 的实例，而不是 Mock<ISecurityService>

有没有人以这种方式成功使用 MoqAutoMocker？我只是做错了吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-09-16T23:02:03.953

我最近遇到了一个类似的问题。似乎解决方案是做这样的事情：

```
var autoMocker = new MoqAutoMocker<SignInController>();
var mock = autoMocker.Get<ISecurityService>();
Mock.Get(mock).Setup(ss => ss.ValidateLogin
(It.IsAny<string>(), It.IsAny<string>())).Returns(true); 
```

我还在我的博客上发布了一个更长的示例：[使用 StructureMap 的 MoqAutoMocker 设置期望](http://joelabrahamsson.com/post/2009/09/17/Setting-Expectations-With-StructureMape28099s-MoqAutoMocker.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-10-28T07:55:33.990

`autoMocker.Get<ISecurityService>()`
将返回 ISecurityService 并且您无法对其进行设置。相反
`Mock.Get(mock)`
会返回 Moq.Mock，然后你就可以Setup 就可以了。

# c# - Memcached + 批量数据加载 + 复制 + 负载均衡，有没有现成的解决方案？

> ID：945095
> 
> 赞同：0
> 
> 时间：2009-06-03T14:29:02.823
> 
> 标签：c#, windows, database, memcached, hashtable

这是我的场景：

十几个客户从类似 memcached 的存储中读取数据。

*   只读访问

*   50K 获取/秒

*   99.999% 的可用性

*   3 亿条记录，每条 100 字节

如果其中一个商店出现故障，系统应该能够自动切换到另一个副本。当需要更新时，系统应该能够在不影响客户端的情况下快速重新加载数据。

是否存在满足这些要求的现有解决方案？我已经评估了 memcached、velocity 并审查了一堆其他项目（[anti-rdbms-a-list-of-distributed-key-value-stores](http://www.metabrew.com/article/anti-rdbms-a-list-of-distributed-key-value-stores/)）。我更喜欢在 Windows x64 上运行的东西，但如果有开箱即用的东西可以支持我的要求，我不会回避 *nix。付费产品还可以。质量非常重要，不能依赖半生不熟的测试版。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T18:50:51.840

看看[速度](http://msdn.microsoft.com/en-us/data/cc655792.aspx)。现在它是 CTP 3，所以它可能会也可能不会违反您的半生不熟的 beta 要求。查看他们的博客以获取性能数字。看起来很有希望。

# c# - 你如何在使用泛型的基类上使用 foreach？

> ID：945100
> 
> 赞同：2
> 
> 时间：2009-06-03T14:30:03.727
> 
> 标签：c#, generics, inheritance, foreach

这个问题是尝试[Jon Skeet对](https://stackoverflow.com/users/22656/jon-skeet)[这个问题](https://stackoverflow.com/questions/944296/)的回答的结果。

所以我有以下代码基于上述问题链接的问答。

```
 public abstract class DeliveryStrategy { }
public class ParcelDelivery : DeliveryStrategy { }
public class ShippingContainer : DeliveryStrategy { }

public abstract class Order<TDelivery> where TDelivery : DeliveryStrategy
{
    private TDelivery delivery;

    protected Order(TDelivery delivery)
    {
        this.delivery = delivery;
    }

    public TDelivery Delivery
    {
        get { return delivery; }
        set { delivery = value; }
    }
}

public class CustomerOrder : Order<ParcelDelivery>
{
    public CustomerOrder()
        : base(new ParcelDelivery())
    { }
}

public class OverseasOrder : Order<ShippingContainer>
{
    public OverseasOrder() : base(new ShippingContainer())
    {

    }
} 
```

我正在尝试更多地了解泛型以提高我的技能，所以我有一个问题：现在我如何使用 foreach 来遍历“订单”的集合？我正在使用 C#2.0。

我正在尝试做的代码示例（不编译）。

```
List<Order> orders = new List<Order>();

orders.Add(new CustomerOrder());
orders.Add(new CustomerOrder());
orders.Add(new OverseasOrder());
orders.Add(new OverseasOrder());

foreach (Order order in orders)
{
     order.Delivery.ToString();
} 
```

**编辑：添加 OverseasOrder 以提供更好的示例。**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-03T14:38:23.740

这里的问题是 Order 是一个泛型类，因此`Order<T>`基本上`Order`是两种不同的类型。

你可以这样做：

```
public abstract class Order
{
    public abstract String GetDeliveryMethod();
}

public abstract class Order<TDelivery> : Order
    where TDelivery : DeliveryStrategy
{
    .... the rest of your class

    public override String GetDeliveryMethod()
    {
        return Delivery.ToString();
    }
} 
```

或者...您可以将 Order 重新定义为非泛型，在这种情况下，您将失去一些强类型。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T14:39:17.577

泛型是你在这里出错的地方。由于泛型的类型是在编译时编制的，因此您需要指出您使用类型创建列表的 Order 类型。

如果您添加如下类型，它将编译：

```
List<Order<ParcelDelivery>> orders = new List<Order<ParcelDelivery>>();

        orders.Add(new CustomerOrder());
        orders.Add(new CustomerOrder());
        orders.Add(new CustomerOrder());
        orders.Add(new CustomerOrder());
        orders.Add(new CustomerOrder());

        foreach (Order<ParcelDelivery> order in orders)
        {
            order.Delivery.ToString();
        } 
```

也许这不再是您想要的，但是如果您需要能够在没有预定类型的情况下进行设置，则必须以不同的方式进行。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-03T14:40:30.943

在您的情况下，没有 Order 类，只有 Order<TDelivery> 类。

如果您想在不了解任何特定子类型（或通用参数）的情况下通用地处理订单，则需要将所需内容抽象到基类或接口中，并使用新订单类上的方法对 Delivery.ToString 进行外观。

```
abstract class Order {
    public abstract string DeliveryString();
}

abstract class Order<TDelivery> : Order {
    // methods omitted for brevity

    public override string DeliveryString() {
        return Delivery.ToString();
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-03T14:39:51.520

但是你没有任何`Order`课程……你有`Order<T>`课程。这就是你不能`List<Order>`上课的原因。

如果您想为现在可以在列表中使用的所有订单创建一个基类，您应该尝试这种方式：

```
public abstract class OrderBase{ ... }
...
public abstract class Order<TDelivery>:OrderBase where TDelivery : DeliveryStrategy { ... } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-03T14:42:37.490

`List<Order>`不是有效类型，因为`Order`它不是有效类型——你需要一个`Order<T>`. 除非你不知道 T。

两种可能：

选项1：将您包装`foreach`在一个通用方法中：

```
public void WriteOrders<T>(IList<Order<T>> orders)
{
    foreach (Order<T> order in orders)
        Console.WriteLine(order.Delivery.ToString());
} 
```

选项 2：也许您不知道您实际拥有的订单类型。你真的想要一个“随便什么顺序”。有人猜测将其添加到 C# - 推测的功能称为“ [mumble types](http://www.interact-sw.co.uk/iangblog/2008/03/17/lambda-inference) ”，如“Order of *(mumble mumble)* ”。但是在没有这样的语言特性的情况下，你需要有一些具体的类，你可以制作一个列表。

因此，在您的示例中，您可以创建一个名为 IOrder 的接口，或一个名为 Order 或 OrderBase 的基类（可能是抽象类）。在任何一种情况下，您都不能在该基类/接口上放置 Delivery 属性，因为您不知道 Delivery 将是什么类型，因此您必须向 IOrder 添加另一个方法或属性。例如，您可以在 IOrder 上放置 DeliveryAsString 属性。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-03T14:43:23.263

你不能只说 Order，你必须说 Order of what (ie `Order<???>`) 这应该有效：

```
List<Order<ParcelDelivery>> orders = new List<Order<ParcelDelivery>>();

orders.Add(new CustomerOrder());
orders.Add(new CustomerOrder());
orders.Add(new CustomerOrder());
orders.Add(new CustomerOrder());
orders.Add(new CustomerOrder());

foreach (Order<ParcelDelivery> order in orders)
{
    order.Delivery.ToString();
} 
```

然而问题是 .NET 不支持泛型多态性，因此您不能只定义变量`Order<DeliveryStrategy>`并期望它们工作:(

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-03T16:06:24.120

`Order<T>`是编译时抽象。 `Order`将是一个运行时抽象，但没有`Order`问题。

既然没有`Order`，就没有`List<Order>`。有这些类型的集合：

```
List<Order<ParcelDelivery>>
List<CustomerOrder>
List<Order<ShippingContainer>>
List<OverseasOrder>
ArrayList 
```

假设你有这个集合：

```
ArrayList myOrders = GetOrders(); 
```

然后您可以遍历集合并以这种方式获取 CustomerOrder 实例：

```
foreach(object someThing in myOrders)
{
  CustomerOrder myOrder = someThing as CustomerOrder;
  if (myOrder != null)
  {
    //work with myOrder
  }
} 
```

同样，如果您有一个，`List<Order<ShippingContainer>>`您可以从中获取 OverseasOrder 实例。

在 .Net Framework 2.0 中，这种技术是与运行时抽象一起工作的方式。在 .Net Framework 3.5 中，人们会调用`Enumerable.OfType<T>`来执行过滤。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-03T14:40:12.660

要迭代 Order，您可以像这样使用它...

orders.ForEach(delegate(Order orderItem) { //so some processing });

如果您不想使用匿名方法，请编写一个方法，请执行此操作。

# c# - 条件 LINQ where 语句？

> ID：945101
> 
> 赞同：3
> 
> 时间：2009-06-03T14:30:05.473
> 
> 标签：c#, .net, linq, lambda

我有一个 linq 语句，如果下拉索引不为 0，我想添加一个额外的 where 子句。

```
people.Where(n.surname == "surname" || n.forename == "forename" && (dropdown.SelectedIndex > 0) ? n.id = dropdown.SelectedValue : n.id  > 0).Select(n => n); 
```

我什至不确定我正在尝试的是否可能？

我想这样做，而不必编写两个不同的语句。

有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-03T14:33:57.120

幸运的是，这很容易，因为查询组成：

```
var query = people.Where(n.surname == "surname" || n.forename == "forename");
if (dropdown.SelectedIndex > 0)
{
    query = query.Where(n => n.id.ToString() == dropdown.SelectedValue);
} 
```

# java - 用于 Hibernate Search 中时间戳的 FieldBridge

> ID：945102
> 
> 赞同：1
> 
> 时间：2009-06-03T14:30:12.913
> 
> 标签：java, hibernate, search, annotations, hibernate-search

HIbernate Search 中时间戳的 FieldBridge 是什么？

@场地

公共 java.sql.Timestamp 批准日期；

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T16:25:23.330

When looking at the [BridgeFactory source code](http://viewvc.jboss.org/cgi-bin/viewvc.cgi/hibernate/search/trunk/src/java/org/hibernate/search/bridge/BridgeFactory.java?revision=15567&view=markup&pathrev=15567), it seems there is no default FieldBridge for timestamps.

I think you should provide your own custom FieldBridge.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-18T13:59:20.447

长话短说，这是我使用的：

```
@Field(index=Index.UN_TOKENIZED)
@DateBridge(resolution=Resolution.MILLISECOND)
public Timestamp getCreated(){
  return super.getCreated();
} 
```

好在它运行良好:)

# iphone - ccTouchesMoved [touches anyObject] 混乱？

> ID：945111
> 
> 赞同：1
> 
> 时间：2009-06-03T14:31:32.270
> 
> 标签：iphone, objective-c, cocos2d-iphone

好的，所以我仍然在尝试了解 Objective-C 的方位，我以为我已经搞定了，但现在我遇到了这种方法。所以有些事情让我感到困惑，如果可能的话，我想详细解释一下。

第一行：'UITouch *touch = [touches anyObject];'，现在我理解 anyObject 是一个哈希表？但是在这种情况下你怎么定义它呢？我不知道它的定义在哪里，我知道它属于 NSSet，但我对这个上下文中的范围感到困惑......

```
- (BOOL)ccTouchesMoved:(NSSet *)touches withEvent:(UIEvent *)event {
    UITouch *touch = [touches anyObject];
    CGPoint point = [touch locationInView: [touch view]];

    point =  [[Director sharedDirector] convertCoordinate: point];
    NSLog(@"ccTouchesMoved x=%f y=%f", point.x, point.y);
    return YES;

} 
```

* * *

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-03T14:45:47.983

`anyObject`在这种情况下是一种方法`NSSet`。为什么认为它是一个哈希表？它只是从集合中返回一个对象 - 任何对象。

`[touches anyObject]`

在对象上调用`anyObject`方法`touches`（例如，其他语言中的方法调用）并从集合中返回一个对象。

```
NSTouch * touch = [touches anyObject]; 
```

`touch`是指向存储在`touches`( `NSSet`) 中的对象之一的指针。

来自可可参考：

> anyObject 返回接收器中的对象之一，如果接收器不包含任何对象，则返回 nil。
> 
> `- (id)anyObject`
> 
> 返回值 接收器中的对象之一，如果接收器不包含任何对象，则返回 nil。返回的对象是在接收者方便时选择的——不保证选择是随机的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-12-06T00:42:59.087

anyObject 实际上是一个属性。所以你可以使用：

```
NSTouch * touch = touches.anyObject; 
```

它的工作方式相同。

# flash - 用于 Flash 的优秀 3d 库

> ID：945112
> 
> 赞同：1
> 
> 时间：2009-06-03T14:31:50.993
> 
> 标签：flash, 3d

我们正在为一个新项目寻找免费的、有据可查的 flash 3d 引擎。你推荐什么图书馆？我们将显示文本和图像，其中图像必须具有良好的动画效果或一定程度的旋转。

我们需要像[http://www.cooliris.com/这样的效果](http://www.cooliris.com/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-10T20:04:23.587

对于 flash，有一些可用的开源 3d 引擎：

[Papervision](http://blog.papervision3d.org/)将成为最流行的大量演示和教程，并且可以与来自其他 3D 工具（如搅拌机、玛雅等）的 3D collada 模型进行补充。

[沙](http://www.flashsandy.org/)

[Away3D](http://away3d.com/)有很好的演示

[Yogurt3D](http://www.yogurt3d.com/)这是一种新的，可用的信息不多

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-04T17:35:44.437

[http://www.flashsandy.org/](http://www.flashsandy.org/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-07-20T16:47:47.773

Either [Papervision3d](http://papervision3d.org/) or [Away3D](http://away3d.com/) will do. For what I have seen so far, there aren't big differences between those two in terms of performance or features. I would *not* recommend [Sandy 3d Engine](http://code.google.com/p/sandy/) as it's the least powerful of the three.

FYI, on [the blog of my company](http://blog.cycle-it.com/) we're are at the moment publishing [a series of posts comparing precisely these 3D engines for Flash](http://blog.cycle-it.com/category/3d/) (in Spanish, although you can follow the examples and read the source code in English).

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-12T01:27:00.993

作为对此的简短评论，Sandy 3D 引擎有很多文档和教程。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-03T18:44:38.093

1.  [Cooliris was not build using flash](https://stackoverflow.com/questions/725489/does-anyone-know-what-cooliris-was-developed-in) (at least not the wall part)
2.  Take a look at [Papervision3d](http://blog.papervision3d.org/category/demos/)

# .net - 获得两次制表位的控件

> ID：945113
> 
> 赞同：0
> 
> 时间：2009-06-03T14:32:01.210
> 
> 标签：.net, winforms

在标准的 WinForms 应用程序中，是否有可能出现如下情况以及我将如何做到这一点：

一个带有四个文本框控件的表单，在表单上从上到下排列：

*   文本框1
*   文本框2
*   文本框3
*   文本框4

所需的行为是，当表单加载时，焦点位于 TextBox3 上，但在跳出时，焦点转到顶部并正常通过所有控件，方式如下：

1.  **文本框3**
2.  文本框1
3.  文本框2
4.  **文本框3**
5.  文本框4

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T14:36:24.260

这将是您需要编写的代码，并且需要正确使用事件。根据需要设置标签顺序，然后编写以下代码：

```
private bool OnLoad = True;

Form_OnLoad(...) {
    TextBox3.SetFocus();
}

TextBox3_LostFocus(...) {
    if (OnLoad) {
        TextBox1.SetFocus();
        OnLoad = false;
    } // The else falls through to the default tab order
 } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T14:41:47.883

LFSR 是对的：

您必须在 textBox3 LostFocus 事件上编码，这是一个 VB 示例

```
static notFirstTime as boolean
if notFirstTime then exit sub
textbox1.setFocus
notfirstTime=true 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T14:38:59.713

简短的回答：绝对！

表单上的布局与 Tab 顺序无关。您只需通过设置 TabIndex 属性即可指定选项卡遍历和起点。启动控件应为 0，下一个为 1，依此类推。此外，TabStop 属性可以方便地指定哪些控件可以通过 Tab 键访问。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T14:41:13.500

您可以使用 TabIndex 属性的以下配置将其欺骗为有效购买。

*   文本框 3 = 1 的标签
*   文本框1 = 2
*   文本框2 = 3
*   文本框3 = 4
*   文本框4 = 5

您必须将标签设置为 TabStop="True"。但我认为这可能有效。请记住，我对此不是100％确定...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-03T14:42:12.640

在您的构造函数（或设计器）中，像这样（或类似的东西）设置表索引。

```
this.textBox1.TabIndex = 1;
this.textBox2.TabIndex = 2;
this.textBox3.TabIndex = 0;
this.textBox4.TabIndex = 4; 
```

然后设置一个事件将文本框 3 的 tabIndex 设置为新值：

```
private void textBox3_Leave(object sender, EventArgs e)
{
    textBox3.TabIndex = 3;
} 
```

# javascript - 为什么javascript转义函数忽略@*/+？

> ID：945114
> 
> 赞同：2
> 
> 时间：2009-06-03T14:32:02.597
> 
> 标签：javascript, escaping

我没有这方面的用例，但最近有人问我这个问题，[w3schools 很有帮助](http://www.w3schools.com/jsref/jsref_escape.asp)地告诉你这些字符被忽略了，但不知道为什么。

任何人都知道为什么会这样？

谢谢，大卫

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-03T14:35:13.403

该`escape`功能已弃用。使用[`encodeURI`](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Functions/encodeURI)and[`encodeURIComponent`](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Functions/encodeURIComponent)代替。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-03T14:35:38.190

来自您的来源：“escape() 函数对字符串进行编码，因此可以在所有计算机上读取。” 这些字符是 ASCII 集中的标准字符，因此没有必要为此特定目的对它们进行编码。

# jquery - jQuery 滑块气泡

> ID：945119
> 
> 赞同：0
> 
> 时间：2009-06-03T14:32:54.763
> 
> 标签：jquery, slider

有谁知道当用户移动滑块指针时如何让气泡出现在 jQuery 滑块控件上方？理想情况下，我希望范围滑块中的两个指针都有自己独立的气泡。气泡将动态显示用户正在移动的滑块指针的当前选定值。这是一个艰难的！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T09:47:02.450

这是一个更简单的方法：

```
$('#slider').slider({
  range: true,
  min: 0,
  max: 10,
  values: [0, 10],
  create: function(){
    var handle = jQuery(this).find('.ui-slider-handle');
    var bubble = jQuery('<div class="valuebox"></div>');
    handle.append(bubble);
  },
  slide: function(evt, ui) {
    ui.handle.childNodes[0].innerHTML = ui.value;
  }
}); 
```

我的问题是让初始值显示在气泡中，这是我尚未解决的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T15:22:39.173

..

```
 <div id="value1">&nbsp;</div>
  <div id="value2">&nbsp;</div>
  <div id="slider"></div> 
```

CSS

```
#value1 { position:relative; }
#value2 { position:relative; } 
```

文...

```
 $("#slider").slider({
            animate:false,
            range: true,
        values:[0,400],
        min: 0,
        max: 500,
        step: 1,
        change: function(event, ui) {
            updateValues(event,ui);
        },
        slide: function(event, ui) {
            updateValues(event,ui);
        }
    });

    function updateValues(event, ui)
    {
            var offset1 = $('.ui-slider-handle:first').offset();
            var offset2 = $('.ui-slider-handle:last').offset();
            var value1 = $('#slider').slider('values',0);
            var value2 = $('#slider').slider('values',1);
                        $('#value1').text(value1).css({'left':offset1.left});
                        $('#value2').text(value2).css({'left':offset2.left});
    } 
```

[我在这里](http://jsbin.com/elizi/edit)放了一个演示。它很丑，但很实用 :) 我会帮助让它看起来像一个泡沫，但我不是一个图形人。希望这能让你开始。

编辑 - 我注意到动画需要关闭 CSS 才能正确跟踪滑块本身的点击（也就是不拖动）。更新了代码和演示，以反映跟踪滑块点击和拖动所需的更改。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-01T15:50:27.780

您可以在初始化或加载时加载如下所示的块（这将使用初始值绘制滑块）。我不确定这是否是最好的方法，但它对我有用。

```
$('#slider').slider({
  range: true,
  min: 0,
  max: 10,
  values: [0, 10]
}); 
```

# c# - 如何在不轮询 ThreadState 的情况下判断线程是否已完成执行？

> ID：945122
> 
> 赞同：2
> 
> 时间：2009-06-03T14:33:05.467
> 
> 标签：c#, .net, multithreading, worker-thread

是否有一种优雅的方法可以知道工作线程何时完成执行，以便我可以访问它产生的资源？

例如，如果工作线程使用以下方式查询 SQL Server 列表

`ServersSqlDataSourceEnumerator.Instance.GetDataSources();`

并将结果保存在 DataTable 变量中，我可以使用什么机制来知道该 DataTable 变量何时已填充/可用。我不想轮询 ThreadState；最好在事件完成后触发事件，这样我就可以对结果执行操作。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-03T14:37:25.957

您可以使用回调机制或阻止事件来了解异步操作的完成。请参阅此页面以[了解 .net 中的异步编程模型](http://msdn.microsoft.com/en-us/library/2e08f6yc%28VS.71%29.aspx)- 您可以在任何委托上调用 BeginInvoke 以异步方式执行操作。

如果您使用的是 BackgroundWorker 类型，则可以订阅[RunWorkerCompleted 事件](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.runworkercompleted.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T14:43:51.327

在这种情况下，我所做的是让 WorkerThread 在完成工作后调用一个函数，该函数将调用 UI 线程，它可以完成您需要的工作。

例如

```
private void SetWorkerThreadToDoWork()
{
  WorkerThread.Start();
}

private void MyWorkerThreadWork()
{
  //This will be on the WorkerThread (called from WorkerThread.Start())
  DoWorkFunc();
  WorkComplete();
}

private void WorkComplete()
{
  if(InvokeRequired == true)
  {
    //Do the invoke
  }
  else
  {
  //Check work done by worker thread
  //e.g. ServersSqlDataSourceEnumerator.Instance.GetDataSources();
  }
} 
```

如果这是您正在使用的简单过程，我会选择 BackgroundWorkerThread，它带有它自己的事件，这些事件在工作完成时被触发。但是，如果您需要使用线程，我会查看异步回调或与上面显示的类似路由。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T17:33:49.780

[您可以在此SO 线程](https://stackoverflow.com/questions/882686/asynchronous-file-copy-move-in-c/882793#882793)上查看我的答案

它使用回调机制。异步操作完成后，它将触发回调方法，您可以在其中处理 SQL 执行后需要完成的处理。

使用类似的方法在异步操作完成时得到通知。

希望这可以帮助 ：）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-03T14:36:21.920

所以触发一个事件：-P

您还可以查看使用 AutoResetEvent：http:
[//msdn.microsoft.com/en-us/library/system.threading.autoresetevent.aspx](http://msdn.microsoft.com/en-us/library/system.threading.autoresetevent.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-03T14:37:56.987

我没有用 C# 编程，但这是我用 Delphi 做的，也许你也可以用 C# 做。我有一个 TThread 后代，在“销毁”事件中，我向它的创建者发送一条消息，说“嘿，我快死了！”。这样，如果它的父线程（即主线程）需要一个新线程，它就会创建一个新线程。准确地说，它会启动一个计时器，当它被触发时，如果需要一个新线程，它会创建一个新线程（网站吸时间（大声笑）！！）。

# wcf - .NET RIA 服务/WCF 服务

> ID：945123
> 
> 赞同：11
> 
> 时间：2009-06-03T14:33:21.177
> 
> 标签：wcf, .net-3.5

我们正在创建一个 n 层 Silverlight LOB 应用程序，并且正在考虑使用 .NET RIA 服务。我们不清楚这与我们当前的 WCF 服务 API 的关系。我们当前的架构是：

**Silverlight** <--> **WCF 服务**<-->**业务逻辑**<-->**实体框架模型**<-->**数据库**

观看 Nikhils Mix 09 演示后，.NET RIA 服务似乎将取代我们的 WCF 和 BusLog 部分：

**Silverlight** <--> **RIA 服务**<--> **EF 模型**<-->**数据库**

这很好，期望我们需要公开一个标准的 SOAP 端点 API 以供其他应用程序（Biztalk、Integration 等）使用。.NET RIA 服务是否可以在没有异步要求的情况下作为 SOAP 端点公开？

通过 .NET RIA 服务实现 WCF 服务有多容易？你知道有什么好的在线例子吗？

谢谢，马克

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-03T14:55:07.467

是的——在 RIA 服务的下一个 CTP 中，我们将为定义 WCF 服务（通过 Astoria 和最终的 vanilla WCF）提供一些非常好的支持，从而在 RIA 服务中公开您的业务逻辑。因此，您的 RIA 服务实施将有两个头。

Silverlight <---> RIA 服务 <---> EF 模型 <---> DB WCF 服务 <--->

如果主要目标是 Silverlight 应用程序，我会说这个模型是有意义的，但是如果主要目标是 WCF 服务，我会坚持你今天拥有的模型。这有帮助吗？

..布拉德

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-05T18:28:45.677

我们正在研究完全相同的场景。现在，我们正在考虑使用这个模型：

**Silverlight <--> RIA 服务 <--> WCF 服务 <--> 业务逻辑 <--> 实体框架模型 <--> 数据库**

我们将能够在各种绑定中托管我们的 WCF 服务。我们将为 Silverlight 应用程序使用从 RIA 到 WCF 的 inProc 调用。对于 WCF 服务的外部使用者，我们将使用 wsHttp 端点托管它们。

因此，在我们的场景中，我们得到了两者的最好的。RIA 服务成为我们应用程序的一组演示服务的一部分，可减轻 Silverlight 应用程序（即异步）编程的负担。缺点是我们添加了一个额外的层。

想法？

# asp.net - 是否可以更改 IE 上 HTML 按钮元素的回发值？

> ID：945124
> 
> 赞同：0
> 
> 时间：2009-06-03T14:33:42.750
> 
> 标签：asp.net, html, button

我知道 StackOverflow 上已经有另一篇文章（[这里](https://stackoverflow.com/questions/378632/ie-sends-inner-html-when-clicking-on-a-button-element)），但它并没有完全解决我的问题。我想在 ASP.net 上使用 HTML 按钮元素 ()，因此我创建了一个自定义服务器控件来呈现此类。之所以使用按钮，主要是为了能够创建图片按钮。您现在可以争辩使用 CSS 和 JavaScript 等来“模拟”图像按钮。那么问题是主要要求之一是该站点 **仍然必须在没有 JavaScript 的情况下运行，因为可访问性的原因**。

从理论上讲，使用 HTML 按钮元素的方法是可行的，但是 IE 使用按钮的内容作为回发值存在问题。这是一个主要问题，因为它会在 IE 上引发错误，而且将整个 img 标签内容发送回服务器在某种程度上是一种性能杀手。可以通过将页面设置`ValidateRequest`为 false 来避免运行时引发的错误。然而，这是不可取的，因为许多不想将其添加到所有页面的程序员将使用新的服务器控件。

所以我的问题是是否有可能影响回发值，或者这是否是纯粹的浏览器决定。顺便提一句。我不能指望我的用户只使用 Firefox 或 IE8（我听说它们显然解决了这个问题）。

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T14:56:21.177

您可能可以使用 JavaScript 破解它，但可靠的方法是忽略该值并使用 name 属性。

[http://www.dev-archive.net/articles/forms/multiple-submit-buttons.html](http://www.dev-archive.net/articles/forms/multiple-submit-buttons.html)通过几种语言的示例对此进行了介绍。

# php - 什么是辅助类和脚本？

> ID：945136
> 
> 赞同：5
> 
> 时间：2009-06-03T14:34:45.417
> 
> 标签：php, frameworks, content-management-system, helper

在许多框架/AMS/CMS 中，我看到“帮助”脚本和类的文件夹。帮助脚本和类究竟是做什么的？他们的具体目的是什么。这是由开发人员定义的还是他们的功能标准？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-03T14:41:27.447

助手类/脚本通常是应用程序用来执行某些任务的实用程序。通常，创建这些类是为了集中在整个应用程序中一次又一次地执行的通用任务逻辑。

这些实用程序通常非常具体，并对应用程序内的数据或对象执行“操作”。

常见的例子是字符串操作、输入解析、加密/解密实用程序或数学计算。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-03T14:39:33.097

我知道这意味着**可以帮助您完成任务的课程**。它可能正在以特定方式解析字符串，或者在其代码的各个部分中需要某种通用计算。

通常在 Java（不懂 php）中，它们采用名为 Util 的类中的一堆静态方法的形式，或者至少我一直是这样看的。

来自维基百科

> Helper 类是用于帮助提供某些功能的类的术语，尽管该功能不是应用程序的主要目标。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T14:42:14.200

补充一下蒙特克里斯托所说的。助手通过为您完成大部分工作，使编写复杂代码更容易。例如在 PHP 框架 symfony 中，他们有所谓的 Javascript 助手。这些帮助程序封装了原型库提供的 API，这使得创建 AJAX 调用更加快速和容易。

这是一个 javascript 帮助器的示例：

```
<div id="feedback"></div>
<div id="indicator" style="display: none">Loading...</div>
<?php echo link_to_remote('Delete this post', array(
    'update'   => 'feedback',
    'url'      => 'post/delete?id='.$post->getId(),
    'loading'  => visual_effect('appear', 'indicator'),
    'complete' => visual_effect('fade', 'indicator').
                  visual_effect('highlight', 'feedback'),
)) ?> 
```

# sharepoint - 使用 XSLT 编辑 Sharepoint BDC webpart 的列标题

> ID：945155
> 
> 赞同：0
> 
> 时间：2009-06-03T14:37:29.967
> 
> 标签：sharepoint, xslt, web-parts, bdc

我想使用 XSL 文件更改 BDC 列表 Web 部件的数据库列名称。

我的 SQL 查询是`"Select BATCH_ID..."`，我想将该列名更改`"BATCH_ID"`为`"ID"`使用 XSL。我还想知道如何`$ColName_0`填充该值`'BATCH_ID'`？

在`dvt.headerfield`模板内部，它是排序和添加排序菜单。但是`$ColName_0`在调用该模板之前填充。XSLT 代码如下：

```
<xsl:stylesheet 
  version="1.0"
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
  xmlns:ddwrt="http://schemas.microsoft.com/WebParts/v2/DataView/runtime"
  xmlns:asp="http://schemas.microsoft.com/ASPNET/20"
  xmlns:msxsl="urn:schemas-microsoft-com:xslt"
  xmlns:SharePoint="Microsoft.Sharepoint.WebControls"
  exclude-result-prefixes="xsl msxsl ddwrt"
>
  <xsl:output method="xml" indent="yes"/>
  <xsl:param name="dvt_partguid" />
  <xsl:param name="ColName_0"></xsl:param>

  <xsl:template name="dvt.headerfield">
    <xsl:param name="fieldname" />
    <xsl:param name="fieldtitle" />
    <xsl:param name="displayname" />
    <xsl:param name="fieldtype">0</xsl:param>

    <table CtxNum="1" cellspacing="0" class="ms-unselectedtitle" onmouseover="OnMouseOverAdHocFilter(this, '{concat($displayname,$fieldname, $fieldtype, $dvt_partguid)}')">
      <tr>
        <td width="100%" class="ms-vb" nowrap="">
          <a>
            <xsl:attribute name="href">javascript: <xsl:value-of select="ddwrt:GenFireServerEvent(('dvt_sortfield;dvt_sortdir'))" />;</xsl:attribute>
            <xsl:value-of select="$fieldtitle"/>
          </a>                  
        </td>
        <td>
          <img src="/_layouts/images/blank.gif" width="13" style="visibility: hidden" alt="" />
        </td>
      </tr>
    </table>
  </xsl:template>

  <xsl:template match="/">
    <xsl:call-template name="dvt_1" />
  </xsl:template>

  <xsl:template name="dvt_1">
    <xsl:variable name="dvt_StyleName">Table</xsl:variable>

    <table id="BdwpRows" border="0" width="100%" cellpadding="2" cellspacing="0">
      <tr valign="top">
        <th class="ms-vh" width="1" />
        <th class="ms-vh" align="left">
          <xsl:call-template name="dvt.headerfield" ddwrt:atomic="1">
            <xsl:with-param name="fieldname">@BATCH_ID</xsl:with-param>
            <xsl:with-param name="fieldtitle">
              <xsl:value-of select="$ColName_0" />
            </xsl:with-param>
            <xsl:with-param name="displayname">
              <xsl:value-of select="$ColName_0" />
            </xsl:with-param>
            <xsl:with-param name="fieldtype">text</xsl:with-param>
          </xsl:call-template>
        </th>
      </tr>         
    </table>
  </xsl:template>
</xsl:stylesheet> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-02-16T21:39:19.943

不确定这是最好的方法，但我是这样做的：

改变：

```
<xsl:with-param name="fieldname">@BATCH_ID</xsl:with-param> 
    <xsl:with-param name="fieldtitle"> 
        <xsl:value-of select="$ColName_0" /> 
    </xsl:with-param> 
    <xsl:with-param name="displayname"> 
        <xsl:value-of select="$ColName_0" /> 
    </xsl:with-param> 
<xsl:with-param name="fieldtype">text</xsl:with-param> 
```

到：

```
<xsl:with-param name="fieldname">@BATCH_ID</xsl:with-param> 
    <xsl:with-param name="fieldtitle"> 
        ID 
    </xsl:with-param> 
    <xsl:with-param name="displayname"> 
        <xsl:value-of select="$ColName_0" /> 
    </xsl:with-param> 
<xsl:with-param name="fieldtype">text</xsl:with-param> 
```

# c# - 在 linq 中设置相等

> ID：945158
> 
> 赞同：9
> 
> 时间：2009-06-03T14:37:52.603
> 
> 标签：c#, linq, set, equality

我有两个列表 A 和 B（列表）。如何以最便宜的方式确定它们是否相等？我可以写类似'（A减B）联合（B减A）=空集'或将它们连接在一起并计算元素数量，但它相当昂贵。有解决方法吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-06-03T15:14:46.443

如果列表项的顺序相关：

```
bool areEqual = a.SequenceEqual(b); 
```

如果将列表视为无序集：

```
// assumes that the list items are ints
bool areEqual = new HashSet<int>(a).SetEquals(b); 
```

（如果您需要该功能，[`SequenceEqual`](http://msdn.microsoft.com/en-us/library/vstudio/system.linq.enumerable.sequenceequal.aspx)方法和[`HashSet<T>`](http://msdn.microsoft.com/en-us/library/bb359438.aspx)构造函数都具有带参数的重载。）[`IEqualityComparer<T>`](http://msdn.microsoft.com/en-us/library/ms132151.aspx)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-03T14:51:04.493

嗯，这取决于你如何解释你的列表。

如果您将它们视为元组（因此列表中元素的顺序很重要），那么您可以使用以下代码：

```
 public bool AreEqual<T>(IList<T> A, IList<T> B)
    {
        if (A.Count != B.Count)
            return false;
        for (int i = 0; i < A.Count; i++)
            if (!A[i].Equals(B[i])) 
                return false;
    } 
```

如果您将列表视为集合（因此元素的顺序无关紧要），那么......我猜您使用的是错误的数据结构：

```
 public bool AreEqual<T>(IList<T> A, IList<T> B)
    {
        HashSet<T> setA = new HashSet<T>(A);
        return setA.SetEquals(B);
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T14:47:43.783

这取决于“列表相等”的含义。如果您的意思是它们包含相同的对象，丹尼尔建议的解决方案很好，只需 Union() 两个列表并计算项目。

如果“相等”是指它们以**相同的顺序具有相同的项目，则**最好比较两个列表的计数，然后如果它们具有相同的计数，只需使用普通迭代`for loop`来比较两者中的每个元素在同一索引处列出。不那么漂亮，但你几乎不能更快。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-03T14:49:30.333

实际上，这里没有捷径，除非列表已排序，在这种情况下，您可以逐个比较元素。显然我认为顺序无关紧要，否则很明显你也可以一一比较它们。

否则，我建议您可以为大型项目列表获得的最有效算法可能是这样的，使用哈希表来跟踪您所看到的（警告：尚未测试，但它应该清楚我的意思。）

```
public static bool IsEqual<T>(this List<T> x1, List<T> x2)
{
    if(x1.Count != x2.Count) return false;

    var x1Elements = new Dictionary<T, int>();

    foreach(var item in x1)
    {
        int n; x1Elements.TryGetValue(item, out n);
        x1Elements[item] = n+1;
    }

    foreach(var item in x2)
    {
        int n; x1Elements.TryGetValue(item, out n);
        if(n <= 0) return false; // this element was in x2 but not x1
        else x1Elements[item] = n-1;
    }

    // make sure x1 didn't have any elements
    // that weren't in x2

    return x1Elements.Values.All(x => x == 0);
} 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-06-03T14:42:47.897

第一次拍摄 - 如果它们包含相同的项目，则两个列表的并集应该与两个列表中的任何一个具有相同数量的项目。

```
listA.Union(listB).Count() == listA.Count() 
```

*注意：如果一个列表为空，则失败。*

但这可能仍然是一项`O(n²)`手术。

另一种解决方案 - 列表必须具有相同的长度，并且列表 A 减去列表 B 不得包含任何元素。

```
(listA.Count() == listB.Count()) && !listA.Except(listB).Any() 
```

# jboss - 如何在特权端口上启动 JBoss？

> ID：945162
> 
> 赞同：2
> 
> 时间：2009-06-03T14:38:26.877
> 
> 标签：jboss, port

如何在特权端口上启动 JBoss？我想使用端口 80 而不是端口 8080（或者，端口 443 而不是端口 8443）。我可以更改适当的配置文件（jboss-web.deployer/server.xml）来更改使用的端口，但是我无法启动服务器，因为这些是特权端口。我可以以 root 身份运行 JBoss，但我认为这不是一个安全的操作。我知道 Apache 有一些机制可以以 root 身份启动，绑定将要使用的特权端口，然后切换到不同的用户。JBoss 能做到吗？还有其他方法可以实现这一目标吗？

我会在 Windows 上遇到同样的问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-06T00:59:10.603

这实际上是 JBoss 的 JIRA 中的一张公开票。你可以[在这里](https://jira.jboss.org/jira/browse/JBAS-6926)看到它。

直接从票：

> “出于安全原因，许多客户希望在端口 80 上运行 JBoss Web，而不以 root 身份运行 JBoss。这通常通过将 JBoss 与 Apache 放在前面并使用 mod_jk 代理到 JBoss 或在机器上进行 NAT 来实现。如果 JBoss 可以以root身份启动，但在打开jboss-web的端口80等端口后，配置将更改为非root用户，例如Apache和其他应用程序服务器。一些客户在几个不同的操作系统上运行，并且会喜欢在 JBoss 级别执行此操作，因此他们不必对每台机器进行不同的配置。”

# javascript - ASP.NET MVC：母版页：如何在活动菜单项上设置 css 类

> ID：945177
> 
> 赞同：13
> 
> 时间：2009-06-03T14:40:43.983
> 
> 标签：javascript, asp.net-mvc

我的母版页中有以下菜单：

```
<ul id="menu" class="lavaLampBottomStyle">
    <li>
        <%= Html.ActionLink("Employees", "Index", "Employees")%></li>
    <li>
        <%= Html.ActionLink("Customer", "Details", "Account")%></li>
</ul> 
```

**我需要一种将当前活动 li 的 css 类设置为“当前”的方法。**

我的第一个猜测是在 javascript 的帮助下做到这一点。

我会在母版页中包含这样的内容：

```
 $("#menu li a").each(){
    if($(this).attr("href") == '<%= *GET CURRENT PAGE* %>'){
       $(this).parent("li").addClass("current");
    }
  } 
```

**这是一个好方法吗？**

如果是，我怎样才能像在 href 中一样获取当前 URL 部分？

如果不是，你的建议是什么？:-)

仅供参考，我要生成的html：

```
<ul id="menu" class="lavaLampBottomStyle">
    <li>
        <a href="/KszEmployees/Index">Employees</a></li>
    <li>
        <a class="current" href="/">Customer</a></li>
</ul> 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-06-03T15:06:47.223

如果你想在服务器端做这一切，我以前做过。创建一个动作过滤器属性：

```
public class PageOptionsAttribute : ActionFilterAttribute
{
    public string Title { get; set; }
    public string Section { get; set; }

    public override void OnActionExecuting(ActionExecutingContext filterContext)
    {
        var controller = filterContext.Controller as ControllerBase;
        if (controller != null)
        {
            controller.SetPageSection(this.Section);
            controller.SetPageTitle(this.Title);
        }

        base.OnActionExecuting(filterContext);
    }
} 
```

这会调用我的 ControllerBase 类中的两个方法，我的所有控制器都继承自：

```
public class ControllerBase : Controller
{
    public void SetPageSection(string section)
    {
                    // use the section defined or the controller name if none
        ViewData["PageSection"] = section != null ? 
                        section : this.RouteData.Values["controller"].ToString();
    }

    public void SetPageTitle(string title)
    {
        ViewData["PageTitle"] = title;
    }
} 
```

在控制器方法上设置标题和页面部分：

```
public class HomeController : ControllerBase
{
    [PageOptions(Title="Home Page", Section="Home")]
    public ActionResult Index()
    { }
 } 
```

然后我从我的母版页调用 ViewData 值（这不会干扰 ViewData.Model）：

```
<body class="<%=ViewData["PageSection"] %>"> 
```

然后通过 CSS 引用，而不是调用 .current，给每个导航项一个 ID，然后结合该 ID 使用 body 类来确定当前页面。

```
body.home #HomeNav { /* selected */  }
body.about #AboutNav { /* selected */  } 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-06-03T14:47:13.440

从 window.location 中提取当前位置。然后使用一个指定 href 属性值的选择器来选择那些匹配的元素（大概只有一个）。

```
 var currentLocation = window.location.href;
 // probably needs to be massaged to extract just the path so that it works in dev/prod

$("#menu li a[href$="+currentLocation+"]").addClass("current"); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-06-03T14:47:18.917

这可能是最不密集的方式。如果您可以指望用户启用 javascript，我认为这没有任何问题，并且有时我自己也这样做了。

Request.Url 是您感兴趣的对象，用于获取服务器端的当前页面。如果您想将其完全保留在客户端，则 tvanfosson 使用 window.location.href 的建议也不错。

使用服务器端的优势在于 Request.Url 具有易于访问的 url 部分，例如 Request.Url.Host 等，以帮助您满足链接修改需求。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-04T09:24:30.263

我有同样的问题。使用以下答案，我设法将以下解决方案放在一起。

[https://stackoverflow.com/a/4733394/280972](https://stackoverflow.com/a/4733394/280972)

[https://stackoverflow.com/a/5650735/280972](https://stackoverflow.com/a/5650735/280972)

在 HtmlHelpers.cs 中：

```
public static class HtmlHelpers
{
    public static HtmlString MenuLink(
        this HtmlHelper htmlHelper,
        string linkText,
        string actionName,
        string controllerName
    )
    {
        var currentAction = htmlHelper.ViewContext.RouteData.GetRequiredString("action");
        var currentController = htmlHelper.ViewContext.RouteData.GetRequiredString("controller");
        var link = htmlHelper.ActionLink(linkText, actionName, controllerName);
        var prefix = (actionName == currentAction && controllerName == currentController) ? String.Format("<li class=\"current\">") : String.Format("<li>");
        const string suffix = "</li>";
        return new HtmlString(prefix + link + suffix);
    }
} 
```

在布局中：

```
<ul class="nav nav-list">
    <li class="nav-header">Statistics</li>
    @Html.MenuLink("Number of logins", "Logins", "Statistics")
</ul> 
```

请注意，MenuLink-helper 同时创建了 li-tag 和 a-tag。

非常欢迎对此解决方案提供反馈！

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-06-03T14:58:10.893

这不应该用 Javascript 来完成！决定你在哪个页面是服务器端代码的工作，而不是 UI 行为。

将菜单作为用户控件并向其传递一个值以指示应突出显示菜单的哪个部分。我是前端人员，不是 .NET 开发人员，而是这样的：

```
<yourControl:menuControl runat="server" ID="menu" selectedPage="4" /> 
```

# sql-server - 如何在 SQL Server 上循环（关闭现有并开始新的）错误日志？

> ID：945182
> 
> 赞同：-1
> 
> 时间：2009-06-03T14:42:02.080
> 
> 标签：sql-server

如何在 SQL Server 上循环（关闭现有并开始新的）错误日志？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T16:42:49.797

您可以`[sp_Cycle_ErrorLog][1]`用于 SQL Server 错误日志。这将停止当前的，并开始一个新的。

对于 SQL 代理错误日志，您可以使用`[sp_Cycle_Agent_ErrorLog][2]`.

您可以安排它在您的环境中根据需要运行，只需注意文件数量和保留天数是有限制的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T14:43:36.147

有一个系统存储过程，`sp_cycle_errorlog`可以做到这一点。

# sql - 查询数据的缓存策略

> ID：945191
> 
> 赞同：10
> 
> 时间：2009-06-03T14:43:25.663
> 
> 标签：sql, database, caching

我目前正在为一个数据库密集型项目构建一个存储库（已经进行了性能测试并且需要缓存，因此我为什么要问）

我现在设置它的方式是每个对象都单独缓存，如果我想对它们进行查询，我将查询传递给数据库并返回所需的 id。（对于一些简单的查询，我已经缓存并管理了 ID）

然后我用这些 id 访问缓存并将它们拉出，任何丢失的对象都捆绑到“where in”语句中并发送到数据库；在这一点上，我用丢失的 id 重新填充缓存。

他们自己的查询很可能是关于分页/排序数据的。

这是一个合适的策略吗？或者也许有更好的技术可用？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-03T15:11:06.013

这是一种合理的方法，我之前已经走过这条路线，最好将其用于简单的缓存。

但是，当您更新或写入数据库时​​，您会遇到一些有趣的问题，您应该小心处理这些情况。

例如，如果用户更新数据库中的记录，您的缓存数据将变得过时。在这种情况下，您将需要同时更新内存缓存或清除缓存，以便可以在下一次获取查询时刷新它。

例如，如果您更新客户的电子邮件地址，该地址位于单独的表中，但通过外键关联，事情也会变得棘手。

除了数据库缓存，您还应该考虑输出缓存。例如，如果您有一个显示上个月销售数据的表格，这将非常有效。该表可以存储在另一个文件中，该文件包含在一堆想要显示该表的其他页面中。现在，如果您使用销售数据表缓存文件，当其他页面请求此文件时，缓存引擎可以直接从磁盘获取它，业务逻辑层甚至不会受到影响。这并不总是适用，但对于自定义控件非常有用。

**工作单元模式**

它还有助于了解[工作单元](http://martinfowler.com/eaaCatalog/unitOfWork.html)模式。

> 当您将数据导入和导出数据库时，跟踪您所做的更改非常重要。否则，该数据将不会被写回数据库。同样，您必须插入您创建的新对象并删除您删除的任何对象。
> 
> 您可以在每次更改对象模型时更改数据库，但这可能会导致大量非常小的数据库调用，最终会非常慢。此外，它要求您为整个交互打开一个事务，如果您有一个跨越多个请求的业务事务，这是不切实际的。如果您需要跟踪已读取的对象以避免不一致的读取，情况会更糟。
> 
> 工作单元跟踪您在可能影响数据库的业务事务期间所做的一切。完成后，它会计算出根据您的工作更改数据库需要做的所有事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T17:44:44.640

如果您使用的是 SQLServer，则可以使用[SqlCacheDependency](http://msdn.microsoft.com/en-us/library/system.web.caching.sqlcachedependency.aspx)，当数据库中的数据表发生更改时，您的缓存将自动重新填充。这是 SqlCacheDependency 的链接

此链接包含一个类似的[缓存依赖解决方案](https://stackoverflow.com/questions/874563/dynamically-reading-resources-from-a-file/874577#874577)。（它是针对文件而不是数据库的。您需要根据上面的 msdn 链接进行一些更改才能对数据库产生缓存依赖关系）

希望这可以帮助 ：）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T14:52:42.230

我不建议自定义缓存策略。缓存很难。根据您选择的平台，您可能想要选择第三方缓存库/工具。

# .net - 如何在 Visual Studio 中找到堆栈跟踪？

> ID：945193
> 
> 赞同：205
> 
> 时间：2009-06-03T14:43:37.677
> 
> 标签：.net, visual-studio, debugging, exception-handling, stack-trace

我问是因为我在调试发生的异常时在 Visual Studio 中找不到堆栈跟踪。

* * *

## 回答 #1

> 赞同：292
> 
> 时间：2009-06-03T14:45:33.727

**调试**时，转到**调试 -> Windows -> 调用堆栈**

* * *

## 回答 #2

> 赞同：135
> 
> 时间：2011-08-23T02:07:20.120

**调试**时**，遇到断点时**。

`CTRL`+ `ALT`+`C`

![在此处输入图像描述](https://i.stack.imgur.com/XjcuP.png)

* * *

## 回答 #3

> 赞同：40
> 
> 时间：2009-06-03T14:47:00.820

默认快捷键是 Ctrl-Alt-C。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2009-06-03T16:07:08.440

你的意思是找到*抛出异常位置*的堆栈跟踪吗？那是调试/异常，或者更好 - Ctrl-Alt-E。为要中断的异常设置过滤器。

甚至还有一种方法可以在捕获到异常*后*重建 thrower 堆栈，但这确实[令人不快](http://blogs.msdn.com/jmstall/archive/2005/01/18/355697.aspx)。很容易在投球时设置突破。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2014-03-31T10:33:15.043

使用调用堆栈窗口

要在 Visual Studio 中打开“调用堆栈”窗口，请从“调试”菜单中选择“Windows”>“调用堆栈”。要将本地上下文设置为堆栈跟踪显示中的特定行，请双击该行的第一列。

[http://msdn.microsoft.com/en-us/library/windows/hardware/hh439516(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/hardware/hh439516(v=vs.85).aspx)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-10-04T15:19:49.630

将此视为当前更新（Windows 10（版本 1803）和 Visual Studio 2017）：我无法查看堆栈跟踪窗口，但确实找到了一个选项/菜单项来查看它。进一步调查后，似乎此功能在 Windows 10 上不可用。有关更多信息，请参阅：

[https://docs.microsoft.com/en-us/windows-hardware/drivers/debugger/viewing-the-call-stack-in-visual-studio](https://docs.microsoft.com/en-us/windows-hardware/drivers/debugger/viewing-the-call-stack-in-visual-studio)

从上面的链接复制：“此功能在 Windows 10 版本 1507 和更高版本的 WDK 中不可用。”

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-03-11T05:24:49.990

对于 Visual Studio 2019，快捷方式**（在调试并在断点处停止时）**是：

`Ctrl`+ `Alt`+`C`现在你也可以使用`Ctrl`+`L`

截图很老了。这是 Visual Studio 2019 的一个（在调试菜单下）：

[![Visual Studio 2019 调用堆栈菜单选项](https://i.stack.imgur.com/m8Mkt.png)](https://i.stack.imgur.com/m8Mkt.png)

# c# - 如何使用 XML Serializer 将多个 xml 命名空间应用于同一个类

> ID：945194
> 
> 赞同：4
> 
> 时间：2009-06-03T14:43:43.497
> 
> 标签：c#, xml-serialization

我正在尝试使用 WCF 生成一个代理类，该类在序列化时会将下面的类的实例转换为下面的 XML。

但是，当我尝试将命名空间应用于类时，它们被错误地插入，或者根本没有插入。

我究竟做错了什么？我怎样才能解决这个问题？

提前谢谢了。

**班级结构：**

```
[XmlRoot]
public class Request
{
  public int Id

  public Name Name {get;set;}
}

[XmlRoot]
public class Name
{
  [XmlAttribute]
  public bool test {get;set;}

  public string FirstName {get;set;}

  public string LastName {get;set;}
} 
```

**所需的 XML 结构*（多余的 XML 修剪）*：**

```
<x1:Request xmlns:x1="Data/Main" xmlns:x2="Data/All">
  <x2:Id>0</x2:Id>
  <x2:Name test="true">
    <x2:FirstName>Dan</x2:FirstName>
    <x2:LastName>Atkinson</x2:LastName>
  </x2:Name>
</x1:Request> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-03T14:53:38.467

如果您在谈论（xml）属性（即`<foo bar="abc"/>`），那么您不是在谈论`DataContractSerializer`- 所以也许坚持使用`XmlType`等等......类似：

```
[XmlRoot(Namespace="Data/Main")]
public class Request {
  [XmlElement(Namespace = "Data/All")]
  public int Id { get; set; }
  [XmlElement(Namespace="Data/All")]
  public Name Name {get;set;}
}

[XmlType(Namespace="Data/All")]
public class Name {
  [XmlAttribute("test")]
  public bool Test {get;set;}
  public string FirstName {get;set;}
  public string LastName {get;set;}
} 
```

那没有别名 - 但它似乎是正确的，至少......

将上面的属性与“Guard”的`XmlSerializerNamespaces`代码合并，它应该在那里......

（这里归功于“Guard”，但无论如何这是维基......）

```
 Request req = new Request {
        Id = 0, Name = new Name {
            Test = true, FirstName = "Dan", LastName = "Atkinson"
        }
    };
    XmlSerializerNamespaces ns = new XmlSerializerNamespaces();
    ns.Add("x1", "Data/Main");
    ns.Add("x2", "Data/All");
    new XmlSerializer(req.GetType()).Serialize(Console.Out, req,ns); 
```

# svn - 让 TortoiseSVN 将文件的修改时间设置为最新版本的时间戳

> ID：945200
> 
> 赞同：21
> 
> 时间：2009-06-03T14:44:57.893
> 
> 标签：svn, tortoisesvn

我似乎记得在执行更新时能够让[TortoiseSVN](http://en.wikipedia.org/wiki/TortoiseSVN)将文件的最后修改时间戳设置为来自修订的时间戳。因此，如果有人在五天前提交了一个文件，而我对其进行了更新，则修改后的时间戳将是五天前，而不是今天。

选项在哪里？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-06-03T14:50:18.630

当我转到 TortoiseSVN 菜单中的设置选项时，我看到一个选项“将文件日期设置为最后提交时间”。这可能是您正在寻找的。

### 调用设置选项

![如何调用 TortoiseSVN 设置对话框的屏幕截图](https://i.stack.imgur.com/j5RVq.png)

### 设置选项

![让 SVN 使用原始文件修改日期而不是当前时间为签出文件添加时间戳的选项的屏幕截图](https://i.stack.imgur.com/8yihw.png)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-06-03T14:52:14.977

我不确定 Tortoise 是否使用 SVN 客户端作为后端，但如果使用，Subversion 配置文件中有一个选项：

```
use-commit-times = yes 
```

抱歉，如果这不适用于您的平台，但无论如何我都会提及。它适用于使用 SVN 命令行客户端的用户。

# javascript - 如何获取调用者事件和dom元素id

> ID：945201
> 
> 赞同：20
> 
> 时间：2009-06-03T14:45:05.160
> 
> 标签：javascript

```
<script>
function Hello(){
    var caller =  arguments.callee.caller;
    alert( caller );
}
</script>

<input type="button" id="btnHello" value="Hello" onclick="Hello()" /> 
```

如何在不传递 Hello 函数中的任何参数的情况下从上面的 Hello 函数中获取按钮 ID

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-06-03T14:59:48.237

事件对象会自动传递给 Hello 函数。您需要将其作为参数接收，然后进行一些跨平台工作来获取该元素。一个 JS 框架将帮助你。

```
function Hello(e){
    var caller = e.target || e.srcElement;
    console.log( caller );
} 
```

**编辑**
+1 安德鲁的评论如下。使用 addEventListener 和 attachEvent 以获得最佳实践。

# asp.net - ASP.NET 和 HTTPS

> ID：945202
> 
> 赞同：1
> 
> 时间：2009-06-03T14:45:17.157
> 
> 标签：asp.net, https

我们正在考虑在我们的 ASP.NET 网络表单应用程序中为购物车部分使用 HTTPS。我在某处读到我们需要编写代码来检查用户的浏览器/设备是否有加密以避免它掉下来？

是这样吗，如果是这样，你能指出我应该看什么样的命名空间/博客等的方向吗？

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-03T14:59:28.923

这篇 codeproject 文章 - [http://www.codeproject.com/KB/aspnet/WebPageSecurity.aspx](http://www.codeproject.com/KB/aspnet/WebPageSecurity.aspx) - 可能值得一读。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T14:59:03.073

我建议打开 SSL 看看有什么问题。通常什么都没有。但是，有许多边缘情况，例如尝试从 http:// 而不是 https:// 加载的组件

大多数相关配置将在 IIS 或 web.config 文件中。您将需要设置几个属性，尤其是在您使用表单身份验证或 ASP.NET 成员资格功能时。

[这是开始阅读的一个链接](http://weblogs.asp.net/pwilson/archive/2004/12/23/331455.aspx)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T15:00:14.633

我想您可能指的是 40 位/128 位加密问题，它曾经是 IE 5.5 的问题。我认为这不应该成为今天的问题。有关 SGC 证书的一些基本信息，请参阅[Verisign 常见问题解答。](http://www.verisign.com/ssl/ssl-information-center/ssl-basics/)

# design-patterns - 实现接口的无用对象是否有公认的模式？

> ID：945204
> 
> 赞同：6
> 
> 时间：2009-06-03T14:45:40.073
> 
> 标签：design-patterns, interface

例如，（虽然它不是一个接口）.NET 中的 Stream 类有一个 Stream.Null 提供的实现，它简单地丢弃数据。PowerShell 有 Out-Null。

在我开发的应用程序中，我经常发现使用默认实现 NullFoo 或类似实现接口 IFoo 很有用，因为最好有一个无用的实现而不是根本不传递对象。

我的问题是我应该如何在记录或解释架构时参考这种做法？是否有公认的名称或 GoF/Fowler 设计模式？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-03T14:47:56.450

这种模式通常被称为“NullObject”：[http ://en.wikipedia.org/wiki/Null_Object_pattern](http://en.wikipedia.org/wiki/Null_Object_pattern)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-03T14:48:01.147

是的。这是[空对象](http://en.wikipedia.org/wiki/Null_Object_pattern)模式。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-03T14:52:18.690

显然它有一个名称“NullObject”，但问题可能有不同的方面：

从一开始，我的整个项目实现就包含在存根方法或数据下沉器上。

我使用术语“存根”来指代尚未实现的外部接口（但已经为您提供了有意义的回报，允许您从第一天开始构建项目）。

我使用“Sinker”指代一个允许我将数据定向到它的接口，但实际上它从那里无处可去，这不是发件人的错（因此在其中编写“不发送”条件会很麻烦那个范围）。

必须完成一个完整的构建，然后，我们开始编码。随着时间的推移，几乎所有存根都可以正常工作（有些会处理或获取数据），几乎所有下沉器都可以正常工作。在代码审查中，我们发现一些沉降函数可能不复存在，其他的可以分组，等等。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-03T16:37:50.363

*   该对象似乎被称为[Null Object](http://en.wikipedia.org/wiki/Null_Object_pattern)，正如其他海报所指出的那样
*   如果您在 .Net 环境中编程，您可能需要遵循 Microsoft 的**“Empty”**约定（如[String.Empty](http://msdn.microsoft.com/en-us/library/system.string.empty.aspx)中的）。请参阅以下[.Net BCL 示例搜索](http://www.google.co.uk/search?q=site:msdn.microsoft.com+.Empty)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-01-13T02:07:08.027

更一般地，空对象模式被称为[特例模式](http://martinfowler.com/eaaCatalog/specialCase.html)。

# entity-framework - 使用 Entity Framework 时可以使用 .NET 函数或 Web 服务插入/更新吗？

> ID：945207
> 
> 赞同：0
> 
> 时间：2009-06-03T14:45:49.560
> 
> 标签：entity-framework

我们的票务系统让我们直接读取数据库，但更新需要通过 Web 服务或插入到特殊的“暂存”表中，然后调用 Web 服务来触发其业务逻辑的处理。

我们目前有一些管理这个的类，但我正在重写所有内容以使用实体框架，并想知道是否有办法利用该代码在需要它的表上进行插入/更新。

如果可能的话，我将如何去做呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T16:06:23.433

这是可能的。您应该能够将实体和相关图表发送到服务，并以最小的更改使用这些值，或者在实体和之前的类之间创建映射。老实说，我认为这是一项相当多的工作，但是如果它没有被破坏，为什么现在要破坏它呢？:)

**编辑：**

我会做第一次尝试。假设我们有一个 Ticket、TicketEntity（实体框架实体）和一个 TicketService。TicketService 有一种方法来更新预订或其他任何东西。我不熟悉票务服务，所以我现在基本上只是猜测。如果我错了，请随时纠正我:)

```
public class TicketService
{
    public TicketService()
    {
        public void InsertTicket(Ticket ticket)
        {
            // Logic remains the same
        }
    }
}

public class Ticket
{
    private TicketEntity _entity;
    public Ticket(TicketEntity entity)
    {
        _entity = entity;
    }

    public decimal Price 
    {
        get { return _entity.Price }
    }

    public double GST 
    {
        get { return _entity.GST }
    }
}

public partial class TicketEntity
{
        public decimal Price { get; set; }
        public double GST { get; set; }
} 
```

这是一种方法。我并不是说这是对的，我只是说这是解决重用当前服务以更新和插入票证的问题的一种方法。

要使用业务层的票务服务，可以执行类似的操作。

```
public void Get(TicketEntity entity)
{
    var context = new ObjectContext();
    IList<TicketEntity> entities = (from t in context.TicketEntities
                                    where t.Price > 200
                                    select t).ToList();
    foreach (var ent in entities)
    {
        var ticket = new Ticket(ent);
        new TicketService().InsertTicket(ticket);
    }
} 
```

# gcc - 使用 g++ 如何链接使用 gcc 构建的库？

> ID：945211
> 
> 赞同：0
> 
> 时间：2009-06-03T14:47:05.750
> 
> 标签：gcc, g++, linker, name-mangling

我正在尝试将使用 gcc 构建的 .a 库链接到使用 g++ 构建的程序。但是名称 mangling 是不同的。我怎样才能做到这一点？谢谢，CP

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-03T14:49:24.437

在您的 C++ 代码中，您只需要将 gcc 库头文件包含在 extern "C" 中：

```
extern "C" {
#include "my_library.h"
} 
```

# apache-flex - Flex：显示验证器错误消息

> ID：945216
> 
> 赞同：0
> 
> 时间：2009-06-03T14:47:53.127
> 
> 标签：apache-flex, validation

在 flex 中，当我将鼠标放在无效的字段上时，会出现一个红色弹出窗口，指示错误消息。默认情况下，它被红色四舍五入。

是否可以在没有鼠标悬停的情况下默认显示红色弹出窗口？因为有时候红框不够清晰，给人的印象是程序卡住了

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T16:50:35.230

我有一个类似的问题，我是这样处理的。

在验证器上，我添加了有效和无效函数，然后更改了文本框的背景颜色或您想要的任何表单元素。这是一段代码：

```
<mx:StringValidator valid="handleValid(event)" invalid="handleValid(event)"/>

private function handleValid(event:ValidationResultEvent):void{
  if(event.type== ValidationResultEvent.VALID){
    TextInput(event.target.source).styleName = "validTextStyle";
  }
  else{
    TextInput(event.target.source).styleName = "inValidTextStyle";
  }
} 
```

然后我有样式将textInput的背景颜色变为红色为无效，白色为有效

# matlab - 当我在 Microsoft Windows PC 上的 MATLAB [7.0 (R14) 及更高版本] 中打开多个图形窗口时，为什么会收到“Out of Windows Resources”警告？

> ID：945222
> 
> 赞同：14
> 
> 时间：2009-06-03T14:48:51.737
> 
> 标签：matlab

我的屏幕分辨率设置为 1600x1200。在 MATLAB 中，我使用以下命令设置我的“DefaultFigurePosition”属性：

```
set(0,'DefaultFigurePosition', [400 100 1050 1000]) 
```

然后我使用以下循环打开多个图形窗口：

```
for i = 1:46
    figure
end 
```

在最后一个图中，我在命令窗口中收到以下消息：

```
 Out of Windows Resources: Allocation of bitmap failed.  
Disabling backingstore for current figure. 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-03T15:01:51.867

避免此消息的一种方法是减小由“DefaultFigurePosition”的第三个和第四个元素指定的默认图形大小。

此外，您可以尝试增加 Java VM 堆空间，如以下技术解决方案“如何在 MATLAB 6.0 (R12) 及更高版本中增加 Java VM 的堆空间？”中所述。在：

[http://www.mathworks.com/support/solutions/en/data/1-18I2C/](http://www.mathworks.com/support/solutions/en/data/1-18I2C/)

此外，有时，将渲染器更改为 opengl 可能会起作用。这可以通过以下方式完成：

```
set(h,'Renderer','opengl'); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T14:57:05.730

不幸的是，Windows 的图形资源数量有限。

您可以使用任务管理器检查资源数量，在选项卡进程中，单击菜单查看/选择列并标记“GDI 对象”选项。

然后你可以看到每个进程使用的图形对象（GDI）的数量。

每个进程的最大 GDI 对象数量约为 9900 个对象。除此之外，该过程将无法正确绘制它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-19T03:15:18.720

根据[这个线程](http://www.mathworks.com.au/matlabcentral/newsreader/view_thread/251889)，它可能是`/3GB`在 32 位版本的 Windows 上设置的开关。我有我的设置，当任务管理器针对 Matlab 仅显示 206 个 GDI 对象时，得到了 backingstore 错误。

或者可能是由于不同情况下的不同原因造成的。有很多方法可以耗尽资源。

# wcf - 将 REST 路由到 WCF 中的命名管道

> ID：945226
> 
> 赞同：1
> 
> 时间：2009-06-03T14:49:38.460
> 
> 标签：wcf, rest

我想将通过 REST (WebHttp) 传入的请求路由到另一个服务。另一个服务将通过命名管道*或*REST 进行侦听。路由器是一个简单的服务，它将所有请求作为消息，将它们路由到目标，并将目标的答案发送回客户端。

1) 当我尝试将 REST 路由到命名管道时，会出现信封问题：REST 没有信封，而命名管道有 SOAP。在 REST 中，请求数据在 url 中编码，而在命名管道中，它在 SOAP 主体中编码。

2）当我尝试将 REST 路由到 REST 时，请求被路由到服务，回复到达路由器并发送，但我在客户端收到“请求错误”。

在这种情况下如何进行路由？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-10T16:09:10.917

你需要在你的场景中使用路由吗？

您能否将一项服务发布为两个端点。一个 REST 和一个命名管道端点？两个端点都将执行相同的代码，客户端可以选择他们希望使用的端点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-05T14:04:16.770

为了帮助您完成场景的第一部分，我必须更多地了解您可能拥有的设计约束。您可能正在尝试几种不同的方法，因此不清楚从哪里开始。我可以说，当我们构建一个类似的“调度”服务时，我们使用的方法是实现最通用的合约，如下所示：

```
[ServiceContract(Name = "SOADispatchService", Namespace = "<your namespace>")]
public interface ISOADispatchService
{
    [OperationContract(Action="*", ReplyAction="*")]
    Message ProcessMessage(Message requestMessage);
}

[ServiceBehavior(AddressFilterMode=AddressFilterMode.Any)]
public class SOADispatchService : RefCountedBaseHandler, ISOADispatchService
{
    Message ProcessMessage(Message requestMessage)
    {
         dispatching code here
    }
} 
```

这使您可以直接访问原始消息形式的请求和响应，并允许您确定请求的类型并精确控制响应的结构和格式。在我们的例子中，调度程序接受 SOAP 和 HTTP GET（又名 REST）请求，并且必须返回 SOAP 响应或 REST 响应（XML、JSON、HTML 中的任何一种）。这确实需要更多地了解 WCF 如何格式化其消息以及消息结构与调度程序绑定之间的交互，但它为您提供了尽可能多的控制。

在诊断您的第二个问题方面，再次不确定配置片段中的问题究竟是什么，可能是很多事情。我们发现在诊断类似问题方面非常有用的两个工具是 WCF 服务跟踪工具和 WCF 反编译器。跟踪工具是 Visual Studio 包的一部分。要启用它，您添加以下配置：

```
<system.diagnostics >
    <sharedListeners>
      <add name="sharedListener"
           type="System.Diagnostics.XmlWriterTraceListener"
           initializeData="c:\traces\WCFTrace.svclog" />
    </sharedListeners>
    <sources>
      <source name="System.ServiceModel" switchValue="All, Verbose, ActivityTracing" >
        <listeners>
          <add name="sharedListener" />
        </listeners>
      </source>
      <source name="System.ServiceModel.MessageLogging" switchValue="All">
        <listeners>
          <add name="sharedListener" />
        </listeners>
      </source>
    </sources>   </system.diagnostics> 
```

这为您提供了一个跟踪文件（在指定位置），您可以使用 SvcTraceViewer.exe 读取该文件。它显示了交换的所有详细信息，并且可以提供有关 WCF 期望您执行的未执行操作的线索。反编译器很有用，因为有时要了解为什么需要某些东西，您只需要查看代码在做什么。WCF 只有大约一百万个扩展选项（这只是有点夸张），因此弄清楚它们如何在没有代码访问的情况下进行交互可能会让人抓狂。

我希望这有助于为您指明正确的方向。如果您可以提供一些代码示例，我们或许可以为您提供更有针对性的建议。

# multithreading - 双重检查锁定的修复有什么问题？

> ID：945232
> 
> 赞同：5
> 
> 时间：2009-06-03T14:50:23.793
> 
> 标签：multithreading, locking, singleton, sequence-points, double-checked-locking

因此，我现在看到很多文章声称在 C++ 双重检查锁定（通常用于防止多个线程尝试初始化延迟创建的单例）上已损坏。正常的双重检查锁定代码如下所示：

```
class singleton {
private:
    singleton(); // private constructor so users must call instance()
    static boost::mutex _init_mutex;

public:
    static singleton & instance()
    {
        static singleton* instance;

        if(!instance)
        {
            boost::mutex::scoped_lock lock(_init_mutex);

            if(!instance)           
                instance = new singleton;
        }

        return *instance;
    }
}; 
```

问题显然是行分配实例——编译器可以自由地分配对象，然后分配指针给它，或者将指针设置到它将被分配的位置，然后分配它。后一种情况打破了惯用语——一个线程可以分配内存并分配指针，但在它进入睡眠状态之前不运行单例的构造函数——然后第二个线程将看到实例不为空并尝试返回它，即使它尚未构建。

我[看到一个建议](http://www.cs.umd.edu/~pugh/java/memoryModel/DoubleCheckedLocking.html)使用线程本地布尔值并检查它而不是`instance`. 像这样的东西：

```
class singleton {
private:
    singleton(); // private constructor so users must call instance()
    static boost::mutex _init_mutex;
    static boost::thread_specific_ptr<int> _sync_check;

public:
    static singleton & instance()
    {
        static singleton* instance;

        if(!_sync_check.get())
        {
            boost::mutex::scoped_lock lock(_init_mutex);

            if(!instance)           
                instance = new singleton;

            // Any non-null value would work, we're really just using it as a
            // thread specific bool.
            _sync_check = reinterpret_cast<int*>(1);
        }

        return *instance;
    }
}; 
```

这样，每个线程最终都会检查实例是否已创建一次，但在此之后停止，这会导致一些性能损失，但仍然没有锁定每个调用那么糟糕。但是如果我们只使用本地静态布尔值呢？

```
class singleton {
private:
    singleton(); // private constructor so users must call instance()
    static boost::mutex _init_mutex;

public:
    static singleton & instance()
    {
        static bool sync_check = false;
        static singleton* instance;

        if(!sync_check)
        {
            boost::mutex::scoped_lock lock(_init_mutex);

            if(!instance)           
                instance = new singleton;

            sync_check = true;
        }

        return *instance;
    }
}; 
```

为什么这行不通？即使 sync_check 在被分配到另一个线程时被一个线程读取，垃圾值仍然是非零的，因此为真。[Dobb 博士的这篇文章](http://www.ddj.com/cpp/184403766)声称您必须锁定，因为您永远不会在重新排序指令上与编译器进行战斗。这让我认为由于某种原因这一定行不通，但我不知道为什么。如果对序列点的要求像 Dobb 博士的文章让我相信的那样丢失，我不明白为什么锁之后的*任何*代码都不能重新排序到锁之前。这将使 C++ 多线程中断期。

我想我可以看到编译器被允许专门将sync_check重新排序到锁之前，因为它是一个局部变量（即使它是静态的，我们也没有返回指向它的引用或指针）——但这仍然可以解决通过使其成为静态成员（实际上是全局的）来代替。

那么这会起作用还是不会呢？为什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-16T15:49:47.030

您的修复没有解决任何问题，因为对 sync_check 和实例的写入可能在 CPU 上无序完成。例如，假设前两个实例调用几乎同时发生在两个不同的 CPU 上。第一个线程将获取锁，初始化指针并将 sync_check 设置为 true，按此顺序，但处理器可能会更改写入内存的顺序。在另一个 CPU 上，第二个线程可以检查 sync_check，看看它是否为真，但实例可能尚未写入内存。有关详细信息，请参阅[Xbox 360 和 Microsoft Windows](http://msdn.microsoft.com/en-us/library/bb310595(VS.85).aspx)的无锁编程注意事项。

您提到的线程特定sync_check 解决方案应该可以工作（假设您将指针初始化为0）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T15:05:43.170

有一些关于此的精彩阅读（尽管它是面向 .net/c# 的）：http: [//msdn.microsoft.com/en-us/magazine/cc163715.aspx](http://msdn.microsoft.com/en-us/magazine/cc163715.aspx)

归根结底，您需要能够告诉 CPU，它无法重新排序您的读/写以进行此变量访问（从最初的 Pentium 开始，如果 CPU 认为逻辑不受影响，它可以重新排序某些指令），并且它需要确保缓存是一致的（不要忘记这一点——我们开发人员可以假装所有内存只是一个平面资源，但实际上，每个 CPU 内核都有缓存，有些是非共享的（L1 ），有时可能会共享一些（L2））-您的初始化可能会写入主RAM，但另一个内核可能在缓存中具有未初始化的值。如果你没有任何并发​​语义，CPU 可能不知道它的缓存是脏的。

我不知道 C++ 方面，但在 .net 中，您可以将变量指定为 volatile 以保护对其的访问（或者您可以使用 System.Threading 中的内存读/写屏障方法）。

顺便说一句，我在 .net 2.0 中读到过，双重检查锁定保证在没有“易失性”变量的情况下工作（对于那里的任何 .net 读者）——这对您的 c++ 代码没有帮助。

如果您想安全，您将需要在 c# 中将变量标记为 volatile 的 c++ 等效项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T15:06:23.887

“后一种情况打破了成语——两个线程最终可能会创建单例。”

但是，如果我正确理解代码，第一个示例，您检查实例是否已经存在（可能由多个线程同时执行），如果没有一个线程将其锁定并创建实例 - 只有一个线程可以在那时执行创建。所有其他线程都被锁定并等待。

一旦创建了实例并且互斥锁被解锁，下一个等待线程将锁定互斥锁，但它不会尝试创建新实例，因为检查将失败。

下次检查实例变量时，它将被设置，因此没有线程会尝试创建新实例。

我不确定一个线程正在为实例分配新实例指针而另一个线程检查相同变量的情况 - 但我相信在这种情况下它会得到正确处理。

我在这里错过了什么吗？

好的，不确定操作的重新排序，但在这种情况下，它会改变逻辑，所以我不希望它发生 - 但我不是这个主题的专家。

# jquery - jQuery 2 错误消息被返回，但只需要显示 1

> ID：945233
> 
> 赞同：1
> 
> 时间：2009-06-03T14:50:40.313
> 
> 标签：jquery

好的，我返回了 2 条错误消息，这些消息又显示了 2 条相同的消息。我怎样才能只显示一条消息？

```
jQuery.noConflict();

   jQuery(document).ready(function(){
      if (jQuery("span.errorMessage").length > 0) {                                                              
         var $this = jQuery("span.errorMessage");
         var t = $this.text();

         // Clear the text
         $this.text('');

         // Add new message
         $this.text('No search criteria was specified.');

         // Change the layout
         jQuery('#errorMessage').appendTo(jQuery('#message_display'));
      }
   }); 
```

为错误添加 HTML

```
<span id="errorMessage">    
         <ul>
        <li><span class="errorMessage">No search criteria was specified.</span></li>
        <li><span class="errorMessage">No search criteria was specified.</span></li>
    </ul>
</span> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T15:20:37.960

您似乎将文本附加到#errormessage，但清除了#this.text()。我猜你需要在添加新错误之前清除#errormessage。

尝试这个....

```
<div id="errorMessage">    
    <ul>
        <li><span class="errorMessage">1 No search criteria was specified.</span></li>
        <li><span class="errorMessage">2 No search criteria was specified.</span></li>
        <li><span class="errorMessage">3 No search criteria was specified.</span></li>
        <li><span class="errorMessage">4 No search criteria was specified.</span></li>
    </ul>
</div>

$(document).ready(function() {
    SetupMessageManager();
    $('.errorMessage').parent().hide();
    $('.errorMessage:first').parent().show();
}); 
```

# excel - 紧凑型框架图表

> ID：945236
> 
> 赞同：1
> 
> 时间：2009-06-03T14:51:25.633
> 
> 标签：excel, .net-3.5, compact-framework, graph

我正在.NET Compact Framework 3.5 中做一个应用程序，我需要做一些图表（xy、条形图、饼图等等）......

是否有任何开源库可以这样做？我应该调用哪些 Excel 类来这样做？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T15:29:16.977

有一个相当不错的 .NET 开源图形库 - ZedGraph - [http://zedgraph.org/wiki/](http://zedgraph.org/wiki/) - 我在 .NET 应用程序中多次使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T15:38:03.597

我想不出任何 .NET CF 的开源库。不过也有一些商业的：

*   [Mooseworks Graph Control](http://www.mooseworkssoftware.com/graph.htm)（可以选择购买源代码）
*   [Steema 图表](http://www.steema.com/products/teechart/net/specifications.html)
*   [Resco CompactChart](http://www.resco.net/developer/mobileformstoolkit/CompactChart.aspx)

# python - 如何从一组图像编写电影创建脚本？

> ID：945250
> 
> 赞同：9
> 
> 时间：2009-06-03T14:54:29.323
> 
> 标签：python, macos, video

我设法使用 Python 加载了一组图像。

我希望我的脚本拍摄这一系列图像（以我需要的任何格式），并从中创建一个视频。所有这一切的最大限制是我正在寻找易于安装的东西。理想情况下，使用标准 OS X 安装程序：

*   下载.dmg
*   点击
*   移动到应用程序文件夹

我不想花费很多精力来安装视频编辑程序。只是一些简单的工作。

* * *

### 问题

1.  我应该瞄准什么格式？我需要我的视频可以在 Linux、Mac 和 Windows 系统上播放。图像是图表，所以我们说的是谨慎的图像，而不是照片。压缩它应该很容易。将有大约 1000 张图像，所以这将是一部短片。

2.  我应该使用什么工具来制作实际的视频？我需要使用为此目的设计的库直接从 Python 执行此操作，或者通过编写从 Python 调用的命令行工具来执行此操作。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-06-03T16:53:53.107

如果您不反对使用命令行，可以使用`convert`ImageMagick 包中的命令。它适用于 Mac、Linux、Windows。请参阅[http://www.imagemagick.org/script/index.php](http://www.imagemagick.org/script/index.php)。

它支持大量图像格式，您可以将电影输出为 mpeg 文件：

```
convert -quality 100 *.png outvideo.mpeg 
```

或作为动画 gif 上传到网页：

```
convert -set delay 3 -loop 0 -scale 50% *.png animation.gif 
```

`convert`此处提供的命令的更多选项： [ImageMagick v6 示例 - 动画基础](http://www.imagemagick.org/Usage/anim_basics/)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-06-03T16:00:47.330

您可以使用 OpenCV。它可以安装在 Mac 上。此外，它有一个[python 接口](http://opencv.willowgarage.com/wiki/PythonInterface)。

我稍微修改了一个取自[这里](http://morphm.ensmp.fr/wiki/morphee-admin/How_to_use_Morph-M_with_OpenCV_)的程序，但不知道它是否编译，也无法检查。

```
import opencv
from opencv.cv import *
from opencv.highgui import *

isColor = 1
fps     = 25  # or 30, frames per second
frameW  = 256 # images width
frameH  = 256 # images height
writer = cvCreateVideoWriter("video.avi",-1, 
fps,cvSize(frameW,frameH),isColor)

#-----------------------------
#Writing the video file:
#-----------------------------

nFrames = 70; #number of frames
for i in range(nFrames):
    img = cvLoadImage("image_number_%d.png"%i) #specify filename and the extension
     # add the frame to the video
    cvWriteFrame(writer,img)

cvReleaseVideoWriter(writer) # 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-03T15:22:45.960

你必须使用python吗？还有其他工具是专门为这些目的而创建的。例如，使用[ffmpeg 或 mencoder](http://electron.mit.edu/~gsteele/ffmpeg/)。

# javascript - 支持将 JSON 数据绑定到 HTML 控件的 JavaScript 库/工具包？

> ID：945251
> 
> 赞同：3
> 
> 时间：2009-06-03T14:54:41.710
> 
> 标签：javascript, html, json, data-binding

是否有任何 JavaScript 库或工具包允许我将 JSON 数据绑定到客户端上的 html 控件？

所以基本上我应该能够指定一个 html 控件应该绑定到的对象属性。因此，当表单接收到 JSON 数据时，控件会更新，当控件更新时，数据应该更新为 JSON 对象。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T15:19:28.493

[Ext](http://extjs.com/)对您所描述的内容有很好的实现，它与旧的 Delphi 和 .NET 将数据绑定到控件的方法的相似之处有点令人毛骨悚然（尽管没有 GUI 来查看绑定，但它并不那么漂亮）

[http://extjs.com/deploy/dev/docs/](http://extjs.com/deploy/dev/docs/)

查找 JSONStore。当心，这里有一个几周的学习曲线才能真正开始这条道路。

另一种选择是[Perservere](http://www.persvr.org/)，它是 DOJO 工具包的一部分。我不确定它是否正是您正在寻找的东西，因为我从未使用过它，但它似乎很健壮，并且做了很多您期望持久客户端数据集做的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T15:14:59.877

Itemscript 描述了一种用于数据和应用程序的 JSON 模式语言。 [http://itemscript.org](http://itemscript.org)

该项目提供了 Itemscript JAM（JSON 应用程序标记）的参考实现，这是一种在 Itemscript 模式中描述的声明性标记语言。

Item Lens 是一个 Itemscript JAM 动画师。Itemscript 项目的目标是为绑定数据和小部件提供标准的轻量级语言。参考实现基于 GWT。

该项目将提供一种共享 Itemscripts 的方法，但此时正在对 Itemscript Schema 语言发表评论，并为常见的应用程序模式开发 Itemscript JAM。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T16:26:50.100

你可以看看[http://github.com/raid-ox/chain.js/](http://github.com/raid-ox/chain.js/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T17:07:28.237

我第二个 extjs，但要注意他们的双重许可证。

# java - 螺旋顺序的二维阵列

> ID：945265
> 
> 赞同：3
> 
> 时间：2009-06-03T14:58:26.773
> 
> 标签：java, arrays, 2d, fill, spiral

我正在尝试以螺旋顺序填充数组。到目前为止，我可以按螺旋顺序打印数组，但是有没有办法修改数组，以便我可以按螺旋顺序填充它，然后只打印数组？我希望它像倒计时一样按降序排列。请帮忙！

```
public class Spiral {
  public static void main(int m, int n) { 

    // create m by n array of integers 1 through m*n
    int[][] values = new int[m][n];
    for (int i = 0; i < m; i++)
        for (int j = 0; j < n; j++)
            values[i][j] = 1 + (m*n)*i + j;

    // spiral
    for (int i = (m*n)-1, j = 0; i > 0; i--, j++) {
          for (int k = j; k < i; k++) System.out.println(values[j][k]);
          for (int k = j; k < i; k++) System.out.println(values[k][i]);
          for (int k = i; k > j; k--) System.out.println(values[i][k]);
          for (int k = i; k > j; k--) System.out.println(values[k][j]);
    }
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-08-09T00:08:24.980

```
int maxValue = target.length * target[0].length;

private int[][] generateMatrix(int[][] target, int level, int currentVal) {
    // always start from lower left corner in each layer
    int w = level;
    int h = target.length - level - 1;

    // fill the bottom line
    int i = 0;
    for (i = w; i < target[0].length - level && currentVal <= maxValue; i++) {
        target[h][i] = currentVal++;
    }

    w = target[0].length - level - 1;

    int j = 0;
    // fill the right line
    for (j = h - 1; j >= level && currentVal <= maxValue; j--) {
        target[j][w] = currentVal++;
    }

    h = level;

    // fill the above line
    for (i = w - 1; i >= level && currentVal <= maxValue; i--) {
        target[h][i] = currentVal++;
    }
    w = level;

    // fill the left line
    for (j = h + 1; j < target.length - level - 1 && currentVal <= maxValue; j++) {
        target[j][w] = currentVal++;
    }

    if (currentVal > maxValue)
        return target;
    return generateMatrix(target, ++level, currentVal);

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-10-17T20:13:16.633

下面的函数是一个大小为 N × N 的方阵，包含从 1 到 N * N 的整数，按螺旋顺序从左上角开始，顺时针方向。

```
int[][] spiralNumbers(int n) {
int[][] matrix = new int[n][n];
for (int step = 0, a = 0, size; step < n/2; step++) {
    size = (n - step * 2 - 1);
    for (int i = 0, chunk, chunkIndex, chunkOffset; i < 4 * size; i++) {
        chunk = i / size;
        chunkIndex = i % size;
        chunkOffset = n - step - 1;
        switch (chunk) {
            case 0:
                matrix[step][chunkIndex + step] = a+1;
                break;
            case 1:
                matrix[chunkIndex + step][chunkOffset] = a+1;
                break;
            case 2:
                matrix[chunkOffset][chunkOffset - chunkIndex] = a+1;
                break;
            case 3:
                matrix[chunkOffset - chunkIndex][step] = a+1;
                break;
            default:
                throw new IndexOutOfBoundsException();
        }
        a++;
    }
    if (n % 2 == 1) {
        matrix[n/2][n/2] = n * n;
    }
}
return matrix; 
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-06-22T21:44:07.270

Here is some of the variations:

```
public class SpiralMatrix {

    private static int[][] createSpiralMatrix(int size) {
        int[][] matrix = new int[size][size];

        int row = 0, col = -1;
        int value = 1;

        boolean horizontal = true;
        boolean increasing = true;
        boolean finish = false;

        while(!finish) {

            finish = true;
            if (horizontal && increasing) {
                while(tryAndSet(matrix, row, col + 1, value)) {
                    finish = false;
                    col++;
                    value++;
                }
            } else if (horizontal && !increasing) {
                while(tryAndSet(matrix, row, col - 1, value)) {
                    finish = false;
                    col--;
                    value++;
                }
            } else if (!horizontal && increasing) {
                while(tryAndSet(matrix, row + 1, col, value)) {
                    finish = false;
                    row++;
                    value++;
                }
            } else {
                while(tryAndSet(matrix, row - 1, col, value)) {
                    finish = false;
                    row--;
                    value++;
                }
            }

            if (!horizontal) {
                increasing = !increasing;
            }
            horizontal = !horizontal;
        }

        return matrix;
    }

    private static boolean tryAndSet(int[][] matrix, int row, int col, int value) {
        if (row < 0 || col < 0 || row >= matrix.length || col >= matrix[row].length || matrix[row][col] != 0) {
            return false;
        }
        matrix[row][col] = value;
        return true;
    }

    private static void printMatrix(int[][] matrix) {
        for (int i = 0; i < matrix.length; i++) {
            for(int j = 0; j < matrix[i].length; j++) {
                System.out.print("\t" + matrix[i][j]);
            }
            System.out.println();
        }
    }

    public static void main(String[] args) {
        try {
            int[][] spiralMatrix = createSpiralMatrix(40);
            printMatrix(spiralMatrix);
        } catch (Throwable th) {
            th.printStackTrace();
        }
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T15:04:45.497

如果您已经找到了执行读取（用于打印）的代码，那么您肯定可以使用相同的逻辑修改它来执行写入吗？

如果您希望矩阵中的每个单元格都包含其“序号”，则向后计数，假设您的访问逻辑正确，这样的事情应该可以工作：

```
for (int i = (m*n)-1, j = 0, index = m * n; i > 0; i--, j++) {
      for (int k = j; k < i; k++) values[j][j] = index--;
      for (int k = j; k < i; k++) values[k][i] = index--;
      for (int k = i; k > j; k--) values[i][k] = index--;
      for (int k = i; k > j; k--) values[k][j] = index--;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-03T15:06:59.063

不是最有效的，但它应该可以工作：g 是数组。我还使用异常来控制逻辑。

```
public static void spiralFill()
{
    x = (g.length-1)/2;
    y = (g[0].length-1)/2;

    try
    {
        while(true)
        {
             east();
             south();
             step++;
             west();
             north();
             step++;        
        }
    }
    catch(ArrayIndexOutOfBoundsException e)
    {

    }
}

public static void east()
{
for(int i = 0; i < step; i++)
{
        g[x][y] = count;
        count++;
    x++;
    }
}
public static void south()
{
    for(int i = 0; i < step; i++)
    {
        g[x][y] = count;
        count++;
        y--;
    }
}   
public static void west()
{
    for(int i = 0; i < step; i++)
    {
         g[x][y] = count;
         count++;
         x--;
    }
}   
public static void north()
{
   for(int i = 0; i < step; i++)
   {
       g[x][y] = count;
       count++;
       y++;
   }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-12-17T11:10:24.433

```
public ArrayList<Integer> spiralOrder(final List<ArrayList<Integer>> a) {
     ArrayList<Integer> result = new ArrayList<Integer>();
      int m = a.get(0).size();
      int n = a.size();
      if(m>1 && n>1){
         int loopCounter = (n > m)  ? m*2 : n *2 -1 ;
         int opr=1;
         int i=0,j=0;
         int opA=m,opB=n,opC=0,opD=1;
         for(int k=0;k < loopCounter ;k++){
              if(opr == 1){
                 int counter =0;
                 while(counter < opA){
                    System.out.print(a.get(i).get(j)+ ";");
                    result.add(a.get(i).get(j));
                    counter++;

                    if(j != opA-1){
                        j++;
                    }
                    else{
                        break;
                    }
                 }
                 opr =2;
                 continue;
             }
             if(opr == 2){
                 i++;
                 int counter =1;
                 while(counter < opB){
                     System.out.print(a.get(i).get(j)+ ";");
                    result.add(a.get(i).get(j));
                    counter++;

                   if( i != opB-1){
                     i++;
                   }
                   else{
                       break;
                   }
                 }
                 opr =3;
                 continue;
             }
             if(opr == 3){
                 j--;
                 int counter =j;
                 while(counter >= opC){
                     System.out.print(a.get(i).get(j)+ ";");
                    result.add(a.get(i).get(j));
                    counter --;
                     if(j != opC){
                     j--;
                    }
                    else{
                        break;
                    }
                  }
                 opr =4;
                 continue;
             }
             if(opr == 4){
                 i--;
                 int counter = i;
                 while(counter >= opD){
                     System.out.print(a.get(i).get(j)+ ";");
                    result.add(a.get(i).get(j));
                    counter --;
                    if(i != opD){
                     i--;
                    }else{
                        break;
                    }
                 }
                 opr =1;
                 j++;
                 opA = opA -1;
                 opB = opB -1;
                 opC= opC +1;
                 opD = opD+1;
                 continue;
             }
         }

     }

         else if(n ==1){
              for(int k=0;k < a.get(0).size();k++){
                  result.add(a.get(0).get(k));
              }
         }

       else if(m==1 && n==1){
             result.add(a.get(0).get(0));
         }

     // Populate result;
     return result; 
```

}

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-09-25T18:49:30.620

这是我对此的看法：

```
public class SpiralMatrix {
public static void main(String[] args) {
    int[][] matrix = new int[5][5];
    int startRow = 0;
    int endRow = matrix.length - 1;
    int startCol = 0;
    int endCol = matrix.length - 1;
    int counter = 1;
    int cycleEnder = matrix.length * matrix.length;

    while (counter <= cycleEnder) {

        //FIRST ROW
        for (int i = 0; i <= endCol; i++) {
            matrix[startRow][i] = counter;
            counter++;
        }
        startRow++;
        //RIGHT-SIDE COL
        for (int i = startRow; i <= endRow; i++) {
            matrix[i][endCol] = counter;
            counter++;
        }
        endCol--;
        //BOTTOM ROW REVERSE
        for (int i = endCol; i >= startCol; i--) {
            matrix[endRow][i] = counter;
            counter++;
        }
        endRow--;

        //FIRST COL UP
        for (int i = endRow; i > startRow; i--) {
            matrix[i][startCol] = counter;
            counter++;
        }
        startCol++;

    }
    for (int[] ints : matrix) {
        for (int j = 0; j < matrix.length; j++) {
            if (ints[j] < 10) {
                System.out.print(ints[j] + "  ");
            } else {
                System.out.print(ints[j] + " ");
            }

        }
        System.out.println();
    }
}

    public static void showMatrix ( int[][] mat, int x, int y){
        for (int i = 0; i < mat.length; i++) {
            for (int j = 0; j < mat.length; j++) {
                System.out.print(mat[i][j] + " ");
            }
            System.out.println();
        }
    }
} 
```

# dll - 使用全局程序集缓存提高速度

> ID：945273
> 
> 赞同：3
> 
> 时间：2009-06-03T14:59:45.693
> 
> 标签：dll, assemblies, gac, isolation

如果我有 1000 个 asp.net 网站，每个网站的 /bin 文件夹中有 30 个 DLL。

因此有 30,000 个 DLL。

如果我将一组 DLL 注册到全局程序集缓存中并且每个站点都使用 GAC 中的 DLL，网站/Web 服务器/机器会运行得更快吗？

例如，网站会共同使用更少的内存吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-03T15:00:43.727

即使程序集在 GAC 中，它们仍然会从那里单独加载到内存中以提供隔离。换句话说，仅仅因为程序集在 GAC 中并不意味着这些副本在 AppDomains 之间共享。我相信 mscorlib（可能还有一些 BCL 程序集）*可以*跨 AppDomain 共享，但您或我编写的任何程序集都不会。

然而，这是一件好事：考虑跨 AppDomains 共享的[Cache类型的含义。](http://msdn.microsoft.com/en-us/library/system.web.ui.page.cache.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-10-11T21:04:16.543

**实际上，@AndrewHare 接受的答案是不正确的。将程序集放在 GAC 中*确实*有助于减少内存使用。**

Jeffrey Richter（来自与 .NET 团队一起帮助设计 CLR 的 Wintellect）在他的《[CLR via C#](https://rads.stackoverflow.com/amzn/click/com/0735667454) 》一书中证实了这一点：

> 将程序集安装到 GAC 中有几个好处。GAC 使许多应用程序能够共享程序集，**从而总体上减少物理内存使用量**......

Tess Ferrandez 也证实了这一点（来自微软的内存和性能专家 - [https://blogs.msdn.microsoft.com/tess/2006/04/12/asp-net-memory-you-use-the-same-dll -in-multiple-applications-is-it-really-necessary-to-load-it-multiple-times](https://blogs.msdn.microsoft.com/tess/2006/04/12/asp-net-memory-you-use-the-same-dll-in-multiple-applications-is-it-really-necessary-to-load-it-multiple-times) )。

> 尽可能强名称并安装到全局程序集缓存 (GAC) 中由多个 ASP.NET 应用程序使用的任何程序集。**这将减少内存消耗。**

作为示例，我还通过在 x64 WebAPI 服务上进行测试（WinDbg、任务管理器和 ProcExplorer）自己确认了这一点。您会看到 GAC 应用程序的私有工作集较低。在 NGen 的情况下，您会再次看到私有工作集减少。但是，与基线相比，NGen 的应用程序中的页面错误也大大减少（在我的测试中几乎减少了一半）。我发现 GAC 应用程序和非 GAC 应用程序之间的页面错误没有区别。

请注意，在某些情况下，最好的解决方案是通过将 NGen 的程序集安装到 GAC 中来组合 NGen 和 GAC。这优化了共享程序集的应用程序之间的内存使用，并在应用程序启动时提供了性能提升！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T15:06:05.493

实际上，这会快得多，特别是如果它们也是 NGEN 的。如果 NGEN 没有将它们放在全局程序集缓存中，那么实际上会减慢速度，因为 CLR 需要执行程序集验证以确保它与本机映像匹配。CLR 会跳过对 GAC 程序集的检查，而只会加载和使用本机映像。

NGEN 的程序集也有内存优势，因为它们可以共享代码页。

您还可以考虑尝试优化 DLL 的基地址，因为如果它们都使用默认值，那么 Windows 需要重新设置 30,000 次！

这是一篇关于 NGEN 的性能优势的精彩文章。

[http://msdn.microsoft.com/en-us/magazine/cc163610.aspx](http://msdn.microsoft.com/en-us/magazine/cc163610.aspx)

# eclipse - 编写eclipse junit插件测试

> ID：945279
> 
> 赞同：7
> 
> 时间：2009-06-03T15:00:14.460
> 
> 标签：eclipse, plugins, junit, testing

我从哪里开始编写插件测试？我写了一些玩具插件，并想开始用我的插件做 TDD。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-06-03T15:48:44.067

如果您的插件是带有 SWT 的 RCP（富客户端平台）插件，您可以使用**[SWTBot](http://www.eclipse.org/swtbot/)**。
这些测试可以封装到 JUnit 中：

![运行为配置创建](https://i.stack.imgur.com/5cmKK.jpg)

* * *

如果您的插件是基于 OSGi 的，您必须知道 OSGi 包运行它自己的类加载器，因此这些类似乎不在同一个包中。
请参阅“ [OSGi 是 JUnit 测试的敌人吗？](http://michaelscharf.blogspot.com/2008/04/is-osgi-enemy-of-junit-tests_17.html) ”

> 使您的测试插件成为一个**[片段](https://stackoverflow.com/questions/657756/patch-merge-plugin-properties-file-in-plugin-by-using-fragment/657903#657903)**。
> 一个问题是其他插件无法访问片段中定义的类（正如 Patrick Paulin 在[关于单元测试中片段的更详细讨论](http://rcpquickstart.wordpress.com/2007/06/20/unit-testing-plug-ins-with-fragments/)中指出的那样）。
> 另一个问题是`plugin.xml`在一个片段中被忽略了。因此你的测试插件不能贡献

来自帕特里克的文章：

> 从外部看，片段很像插件。它在您的工作空间中表示为一个单独的项目，它包含一个描述其内容的清单，它被构建和部署为一个 jar。片段的不同之处在于它在运行时将其资源贡献给单个主机插件。因此，片段中的类由宿主插件的类加载器加载。

![插件单元测试](https://i.stack.imgur.com/ECGEo.png)

> 通过将单元测试放在片段中，我们可以为测试提供对被测类的非公共方法的访问。此外，由于源代码和测试代码实际上是同一个插件的一部分，因此不存在与非导出包相关的问题。测试类将可以访问插件中的所有包，无论它们是否被导出。
> 
> 这种基于片段的方法的主要缺点是难以将单元测试聚合到主测试套件中。虽然创建一个在一个片段中包含测试的测试套件很容易，但创建一个包含多个片段中的测试的套件并不容易。

* * *

如果您的插件只需要一些简单的测试，那么[JUnit 测试](http://www.laliluna.de/eclipse-junit-testing-tutorial.html)套件就足够了

> 在包test.yourpackage中新建一个测试用例BookTest，在包上右击选择“ `New > JUnit Test Case`”。

![新的测试用例](https://i.stack.imgur.com/cA3YK.gif)

# asp.net - 带有 Web 服务的 ASP.Net 或 Silverlight，我们在哪里停止

> ID：945285
> 
> 赞同：0
> 
> 时间：2009-06-03T15:00:42.150
> 
> 标签：asp.net, silverlight

我正在阅读[ASP.Net vs Silverlight（Reach vs Rich）](https://stackoverflow.com/questions/33485/asp-net-vs-silverlight)，需要澄清一下，如果要求强制每个人使用我的应用程序是下载 silverlight，那么性能和安全方面，silver light 是比 ASp 更好的解决方案。 Net（也避免使用 activx 控件来开发丰富的网格）？我在 .Net 中进行所有开发，并且比 ASP.Net 更了解 Silverlight

谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T15:15:30.153

我对此的主要想法是：

1.  Silverlight 是跨浏览器兼容的，您在 IE 中看到的就是您在 FireFox、Safari 和 Apple Mac 版本的浏览器上看到的。如果您的应用程序是 Intranet 应用程序，那么 ASP.Net 可能会更快地实现，但是如果您尝试编写 Internet 应用程序，那么 Silverlight 将提供此作为主要优势。让网站在所有浏览器上看起来都一样是一个巨大的痛苦。

2.  Silverlight 在可以访问的服务类型以及您可以对数据执行的操作方面存在安全限制。这是由于插件在客户端运行所有代码，所以显然 MS 不希望坏插件下载木马等。ASP.Net 确实有一些安全限制，但大部分代码运行在网络服务器。

3.  两者可以并排使用，因此您可以混合搭配，但是我认为这是两个技术堆栈，可以在只需要一个时学习。

4.  在传闻将于 7 月 10 日发布的 silverlight 3（SDK 现已推出）中，您可以将 silverlight 应用程序从浏览器中取出，因此如果您的应用程序可能需要离线运行，您可以将数据文件下载到隔离存储，然后使用数据文件中的数据而不是服务中的数据。然后，当应用程序重新联机时，您可以将数据文件与数据库同步。

5.  Silverlight 3 允许您编写将充分利用显卡而不是最大化处理器的动画。

在我看来，Silverlight 将很快成为微软 Web 应用程序的主要平台，他们在 Silverlight 项目上投入的大量投资和资源表明微软也这么认为。

如您所知，我对 Silverlight 有相当的偏见。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T15:04:33.920

不确定您的确切目标是什么，但 Silverlight 可以与 ASP.NET 一起使用，因此您可以两全其美。选择使用 Silverlight 进行网格控件而不是 activex 是 IMO Silverlight 的一个很好的用途。

我的观点是，没有理由不能同时使用两者来最大化应用程序的功能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T15:57:35.990

自从我迷上了 ASP.NET MVC 错误以来，我一直在使用 Silverlight 来实现丰富的控件——尤其是当客户真正想要编辑网格时的数据网格控件。但是，对于大多数显示或详细信息屏幕、单个域对象编辑等，如果不需要，为什么还要使用其他工具呢？文本框、复选框等在任何 UI 中都可以正常工作。

# bash - 将当前目录保存到 bash 历史记录

> ID：945288
> 
> 赞同：67
> 
> 时间：2009-06-03T15:01:17.813
> 
> 标签：bash

我想保存当前目录，其中每个命令与历史记录中的命令一起发出。为了不把事情搞砸，我正在考虑在行尾添加当前目录作为注释。一个例子可能会有所帮助：

```
$ cd /usr/local/wherever
$ grep timmy accounts.txt 
```

我希望 bash 将最后一个命令保存为：

```
grep timmy accounts.txt # /usr/local/wherever 
```

这个想法是这样我可以立即看到我发出命令的位置。

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2009-06-04T03:49:58.013

# 单线版

这是一个单行版本。这是原版。我还发布了一个[简短的功能版本](https://stackoverflow.com/a/960674/4518341)和一个带有几个附加功能的[长功能版本。](https://stackoverflow.com/a/960684/4518341)我喜欢函数版本，因为它们不会破坏您环境中的其他变量，而且它们比单行代码更具可读性。这篇文章有一些关于它们如何工作的信息，这些信息可能不会在其他文章中重复。

### 将以下内容添加到您的`~/.bashrc`文件中：

```
export PROMPT_COMMAND='hpwd=$(history 1); hpwd="${hpwd# *[0-9]*  }"; if [[ ${hpwd%% *} == "cd" ]]; then cwd=$OLDPWD; else cwd=$PWD; fi; hpwd="${hpwd% ### *} ### $cwd"; history -s "$hpwd"' 
```

这使得历史条目看起来像：

```
rm subdir/file ### /some/dir 
```

我将`###`其用作注释分隔符，以将其与用户可能键入的注释区分开来，并减少在删除旧路径注释时发生冲突的机会，否则如果您在空白命令行上按 Enter，这些注释会累积。不幸的是，副作用是像这样的命令`echo " ### "`被破坏了，尽管这应该是相当罕见的。

有些人会发现我重用相同的变量名会令人不快。通常我不会，但在这里我试图最小化足迹。在任何情况下都很容易改变。

它盲目地假设您没有以`HISTTIMEFORMAT`其他方式使用或修改历史记录。`date`在评论中添加命令来代替该`HISTTIMEFORMAT`功能会很容易。但是，如果您出于某种原因需要使用它，它仍然可以在子 shell 中工作，因为它会自动取消设置：

```
$ htf="%Y-%m-%d %R "    # save it for re-use
$ (HISTTIMEFORMAT=$htf; history 20)|grep 11:25 
```

它有几个非常小的问题。一种是如果您使用这样的`history`命令，例如：

```
$ history 3
echo "hello world" ### /home/dennis
ls -l /tmp/file ### /home/dennis
history 3 
```

结果不会显示`history`命令本身的注释，即使您按向上箭头或发出另一个`history`命令时会看到它。

另一个是带有嵌入换行符的命令在历史记录中除了注释副本之外还留下一个未注释副本。

可能还会出现其他问题。如果你找到任何东西，请告诉我。

### 这个怎么运作

`PROMPT_COMMAND`每次`PS1`发出主要提示时， Bash 都会执行变量中包含的命令。这个小脚本利用它来获取历史记录中的最后一个命令，为其添加注释并将其保存回来。

在这里，它与评论分开：

```
hpwd=$(history 1)              # grab the most recent command
hpwd="${hpwd# *[0-9]*  }"      # strip off the history line number
if [[ ${hpwd%% *} == "cd" ]]   # if it's a cd command, we want the old directory
then                           #   so the comment matches other commands "where *were* you when this was done?"
    cwd=$OLDPWD
else
    cwd=$PWD
fi
hpwd="${hpwd% ### *} ### $cwd" # strip off the old ### comment if there was one so they 
                               #   don't accumulate, then build the comment
history -s "$hpwd"             # replace the most recent command with itself plus the comment 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-06-06T22:17:45.587

### hcmnt - 长函数版本

这是一个函数形式的长版本。这是一个**怪物**，但它增加了几个有用的功能。我还发布了一个单行（原始）和一个更短的函数。我喜欢函数版本，因为它们不会破坏您环境中的其他变量，而且它们比单行代码更具可读性。阅读单行代码的条目和下面函数中的注释，以获取有关其工作原理和一些限制的更多信息。我已经在自己的答案中发布了每个版本，以使事情更有条理。

要使用这个，请将其保存在一个名为的文件中（如果需要，您可以使用它），然后像这样在您`hcmnt`的位置获取它：`/usr/local/bin``chmod +x``~/.bashrc`

```
source /usr/local/bin/hcmnt
export hcmntextra='date "+%Y%m%d %R"'
export PROMPT_COMMAND='hcmnt' 
```

不要编辑设置`PROMPT_COMMAND`或`hcmntextra`设置的函数文件。让它们保持原样，以便它们保持默认值。`.bashrc`如上所示将它们包含在您的中，并在那里编辑它们以设置选项`hcmnt`或更改或取消设置`hcmntextra`。与 short 函数不同，使用这个函数，您必须同时`hcmntextra`设置变量*并*使用该`-e`选项来使该功能起作用。

您可以在函数的注释中添加几个记录在案的选项（带有几个示例）。一个值得注意的功能是将带有附加注释的历史条目记录到文件中，而实际历史记录保持不变。为了使用这个功能，只需像这样添加`-l` *文件名*选项：

```
export PROMPT_COMMAND="hcmnt -l ~/histlog" 
```

您可以使用任何选项组合，但`-n`和`-t`是互斥的。

```
#!/bin/bash
hcmnt() {

# adds comments to bash history entries (or logs them)

# by Dennis Williamson - 2009-06-05 - updated 2009-06-19
# http://stackoverflow.com/questions/945288/saving-current-directory-to-bash-history
# (thanks to Lajos Nagy for the idea)

# the comments can include the directory
# that was current when the command was issued
# plus optionally, the date or other information

# set the bash variable PROMPT_COMMAND to the name
# of this function and include these options:

    # -e - add the output of an extra command contained in the hcmntextra variable
    # -i - add ip address of terminal that you are logged in *from*
    #      if you're using screen, the screen number is shown
    #      if you're directly logged in, the tty number or X display number is shown
    # -l - log the entry rather than replacing it in the history
    # -n - don't add the directory
    # -t - add the from and to directories for cd commands
    # -y - add the terminal device (tty)
    # text or a variable

# Example result for PROMPT_COMMAND='hcmnt -et $LOGNAME'
#     when hcmntextra='date "+%Y%m%d %R"'
# cd /usr/bin ### mike 20090605 14:34 /home/mike -> /usr/bin

# Example for PROMPT_COMMAND='hcmnt'
# cd /usr/bin ### /home/mike

# Example for detailed logging:
#     when hcmntextra='date "+%Y%m%d %R"'
#     and PROMPT_COMMAND='hcmnt -eityl ~/.hcmnt.log $LOGNAME@$HOSTNAME'
#     $ tail -1 ~/.hcmnt.log
#     cd /var/log ### dave@hammerhead /dev/pts/3 192.168.1.1 20090617 16:12 /etc -> /var/log

# INSTALLATION: source this file in your .bashrc

    # will not work if HISTTIMEFORMAT is used - use hcmntextra instead
    export HISTTIMEFORMAT=

    # HISTTIMEFORMAT still works in a subshell, however, since it gets unset automatically:

    #   $ htf="%Y-%m-%d %R "    # save it for re-use
    #   $ (HISTTIMEFORMAT=$htf; history 20)|grep 11:25

    local script=$FUNCNAME

    local hcmnt=
    local cwd=
    local extra=
    local text=
    local logfile=

    local options=":eil:nty"
    local option=
    OPTIND=1
    local usage="Usage: $script [-e] [-i] [-l logfile] [-n|-t] [-y] [text]"

    local newline=$'\n' # used in workaround for bash history newline bug
    local histline=     # used in workaround for bash history newline bug

    local ExtraOpt=
    local LogOpt=
    local NoneOpt=
    local ToOpt=
    local tty=
    local ip=

    # *** process options to set flags ***

    while getopts $options option
    do
        case $option in
            e ) ExtraOpt=1;;        # include hcmntextra
            i ) ip="$(who --ips -m)" # include the terminal's ip address
                ip=($ip)
                ip="${ip[4]}"
                if [[ -z $ip ]]
                then
                    ip=$(tty)
                fi;;
            l ) LogOpt=1            # log the entry
                logfile=$OPTARG;;
            n ) if [[ $ToOpt ]]
                then
                    echo "$script: can't include both -n and -t."
                    echo $usage
                    return 1
                else
                    NoneOpt=1       # don't include path
                fi;;
            t ) if [[ $NoneOpt ]]
                then
                    echo "$script: can't include both -n and -t."
                    echo $usage
                    return 1
                else
                    ToOpt=1         # cd shows "from -> to"
                fi;;
            y ) tty=$(tty);;
            : ) echo "$script: missing filename: -$OPTARG."
                echo $usage
                return 1;;
            * ) echo "$script: invalid option: -$OPTARG."
                echo $usage
                return 1;;
        esac
    done

    text=($@)                       # arguments after the options are saved to add to the comment
    text="${text[*]:$OPTIND - 1:${#text[*]}}"

    # *** process the history entry ***

    hcmnt=$(history 1)              # grab the most recent command

    # save history line number for workaround for bash history newline bug
    histline="${hcmnt%  *}"

    hcmnt="${hcmnt# *[0-9]*  }"     # strip off the history line number

    if [[ -z $NoneOpt ]]            # are we adding the directory?
    then
        if [[ ${hcmnt%% *} == "cd" ]]    # if it's a cd command, we want the old directory
        then                             #   so the comment matches other commands "where *were* you when this was done?"
            if [[ $ToOpt ]]
            then
                cwd="$OLDPWD -> $PWD"    # show "from -> to" for cd
            else
                cwd=$OLDPWD              # just show "from"
            fi
        else
            cwd=$PWD                     # it's not a cd, so just show where we are
        fi
    fi

    if [[ $ExtraOpt && $hcmntextra ]]    # do we want a little something extra?
    then
        extra=$(eval "$hcmntextra")
    fi

    # strip off the old ### comment if there was one so they don't accumulate
    # then build the string (if text or extra aren't empty, add them plus a space)
    hcmnt="${hcmnt% ### *} ### ${text:+$text }${tty:+$tty }${ip:+$ip }${extra:+$extra }$cwd"

    if [[ $LogOpt ]]
    then
        # save the entry in a logfile
        echo "$hcmnt" >> $logfile || echo "$script: file error." ; return 1
    else

        # workaround for bash history newline bug
        if [[ $hcmnt != ${hcmnt/$newline/} ]] # if there a newline in the command
        then
            history -d $histline # then delete the current command so it's not duplicated
        fi

        # replace the history entry
        history -s "$hcmnt"
    fi

} # END FUNCTION hcmnt

# set a default (must use -e option to include it)
export hcmntextra='date "+%Y%m%d %R"'      # you must be really careful to get the quoting right

# start using it
export PROMPT_COMMAND='hcmnt' 
```

**2009-06-19 更新**：添加了对日志记录有用的选项（ip 和 tty）、重复输入问题的解决方法、删除了无关的空分配

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2014-08-30T20:03:39.203

您可以安装[Advanced Shell History](https://github.com/barabo/advanced-shell-history)`bash` ，这是一个将您的或`zsh`历史写入 sqlite 数据库的开源工具。这记录了当前工作目录、命令退出代码、命令开始和停止时间、会话开始和停止时间、tty 等内容。

如果您想查询历史数据库，您可以编写自己的 SQL 查询，保存它们并在捆绑`ash_query`工具中提供它们。有一些有用的预打包查询，但由于我对 SQL 非常了解，所以当我需要查找某些内容时，我通常只是打开数据库并以交互方式查询。

不过，我发现一个非常有用的查询是查看当前工作目录的历史记录。它可以帮助我记住我在做某事时停下来的地方。

```
vagrant@precise32:~$ ash_query -q CWD
session
    when                   what
1
    2014-08-27 17:13:07    ls -la
    2014-08-27 17:13:09    cd .ash
    2014-08-27 17:16:27    ls
    2014-08-27 17:16:33    rm -rf advanced-shell-history/
    2014-08-27 17:16:35    ls
    2014-08-27 17:16:37    less postinstall.sh
    2014-08-27 17:16:57    sudo reboot -n 
```

以及使用当前工作目录（以及它下面的任何内容）的相同历史记录：

```
vagrant@precise32:~$ ash_query -q RCWD
session
    where
        when                   what
1
    /home/vagrant/advanced-shell-history
        2014-08-27 17:11:34    nano ~/.bashrc
        2014-08-27 17:12:54    source /usr/lib/advanced_shell_history/bash
        2014-08-27 17:12:57    source /usr/lib/advanced_shell_history/bash
        2014-08-27 17:13:05    cd
    /home/vagrant
        2014-08-27 17:13:07    ls -la
        2014-08-27 17:13:09    cd .ash
    /home/vagrant/.ash
        2014-08-27 17:13:10    ls
        2014-08-27 17:13:11    ls -l
        2014-08-27 17:13:16    sqlite3 history.db
        2014-08-27 17:13:43    ash_query
        2014-08-27 17:13:50    ash_query -Q
        2014-08-27 17:13:56    ash_query -q DEMO
        2014-08-27 17:14:39    ash_query -q ME
        2014-08-27 17:16:26    cd
    /home/vagrant
        2014-08-27 17:16:27    ls
        2014-08-27 17:16:33    rm -rf advanced-shell-history/
        2014-08-27 17:16:35    ls
        2014-08-27 17:16:37    less postinstall.sh
        2014-08-27 17:16:57    sudo reboot -n 
```

FWIW - 我是该项目的作者和维护者。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-06-06T22:12:39.263

# hcmnts - 短函数版本

这是一个函数形式的简短版本。我还发布了一个单行（原始）和一个更长的功能，其中包含几个附加功能。我喜欢函数版本，因为它们不会破坏您环境中的其他变量，而且它们比单行代码更具可读性。阅读单线的条目以获取有关其工作原理和一些限制的更多信息。我已经在自己的答案中发布了每个版本，以使事情更有条理。

要使用这个，请将其保存在一个名为的文件中（如果需要，您可以使用它），然后像这样在您`hcmnts`的位置获取它：`/usr/local/bin``chmod +x``~/.bashrc`

```
source /usr/local/bin/hcmnts 
```

`hcmntextra`如果您不想要日期和时间，请注释掉设置的行（或者您可以更改其格式或使用除 之外的其他命令`date`）。

这里的所有都是它的。

```
#!/bin/bash
hcmnts() {
    # adds comments to bash history entries

    # the *S*hort version of hcmnt (which has many more features)

    # by Dennis Williamson
    # http://stackoverflow.com/questions/945288/saving-current-directory-to-bash-history
    # (thanks to Lajos Nagy for the idea)

    # INSTALLATION: source this file in your .bashrc

    # will not work if HISTTIMEFORMAT is used - use hcmntextra instead
    export HISTTIMEFORMAT=

    # HISTTIMEFORMAT still works in a subshell, however, since it gets unset automatically:

    #   $ htf="%Y-%m-%d %R "    # save it for re-use
    #   $ (HISTTIMEFORMAT=$htf; history 20)|grep 11:25

    local hcmnt
    local cwd
    local extra

    hcmnt=$(history 1)
    hcmnt="${hcmnt# *[0-9]*  }"

    if [[ ${hcmnt%% *} == "cd" ]]
    then
        cwd=$OLDPWD
    else
        cwd=$PWD
    fi

    extra=$(eval "$hcmntextra")

    hcmnt="${hcmnt% ### *}"
    hcmnt="$hcmnt ### ${extra:+$extra }$cwd"

    history -s "$hcmnt"
}
export hcmntextra='date +"%Y%m%d %R"'
export PROMPT_COMMAND='hcmnts' 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-10-03T08:31:42.100

对于那些想要在 zsh 中实现这一点的人，我已经[修改](https://github.com/gawells/ariadne)了Jeet Sukumaran 的实现和 percol，以允许交互式关键字搜索和提取它执行的命令或路径。还可以过滤掉重复的命令并隐藏字段（日期、命令、小路）

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-10-18T13:09:39.063

这是我使用的一个衬里。把它放在这里是因为它要简单得多，而且我对每个会话的历史记录没有任何问题，我*还想*知道工作目录的历史记录。

此外，上面的单行与您的用户界面混在一起太多了。

```
export PROMPT_COMMAND='if [ "$(id -u)" -ne 0 ]; then echo "$(date "+%Y-%m-%d.%H:%M:%S") $(pwd) $(history 1)" >> ~/.bash.log; fi' 
```

因为我的家庭目录通常是一个交叉安装的 gluster 东西，所以它的副作用是成为我做过的一切的历史。可以选择添加`$(hostname)`到上面的 echo 命令...取决于您的工作环境。

即使有 100k 个条目，grep 也绰绰有余。无需 sqlite 记录它。只是不要在命令行上输入密码，你很好。无论如何，密码都是 90 年代的技术！

此外，对于搜索，我倾向于这样做：

```
function hh() {
    grep "$1" ~/.bash.log
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-06-28T19:51:57.680

绅士，这效果更好。我唯一不知道的是如何使脚本在登录时不登录到系统日志并记录历史中的最后一个命令。但到目前为止，它就像一个魅力。

```
#!/bin/bash

跟踪器bash（）{
    # 为 bash 历史条目添加注释

    #丹尼斯威廉姆森
    # http://stackoverflow.com/questions/945288/saving-current-directory-to-bash-history
    # （感谢 Lajos Nagy 的想法）

    #Supper 由 QXT 增强

    # INSTALLATION: 在你的 .bashrc 中获取这个文件

    导出 HISTTIMEFORMAT=
# 导出 HISTTIMEFORMAT='%F %T'

    本地人
    本地 cwd
    本地额外
    地方蓟
    当地人
    本地 sudouser
    本地shelldate
    本地跟踪
    本地跟踪主机

            thistt​​y=`/usr/bin/tty|/bin/cut -f3-4 -d/`
            whoiam=`/usr/bin/whoami`
            sudouser=`last |grep $thistt​​y |head -1 | awk '{ 打印 $1 }' |cut -c 1-10`
            hcmnt=$(历史 1)
            hcmnt="${hcmnt# *[0-9]* }"
            cwd=`密码`

            hcmnt="${hcmnt% ### *}"
            hcmnt="$hcmnt ${额外:+$额外}"

            shelldate=`日期 +"%Y %b %d %R:%S"`
            TRACKHOST=`whoami | sed -r "s/.*\((.*)\).*/\\1/"`
            TRACKIP=`last |grep $thistt​​y |head -1 | awk '{ 打印 $3 }'`

            记录器 -p local1.notice -t bashtracker -i -- "$sudouser ${USER}: $thistt​​y: $TRACKIP: $shelldate: $cwd : $hcmnt"
            历史-w

}
导出 PROMPT_COMMAND='trackerbash'

```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-07-23T23:00:50.137

全面披露：我是 FOSS-tool
[shournal - A (file-) journal for your shell](https://github.com/tycho-kirchner/shournal)的作者：
使用它的*bash 集成*，命令的工作目录也存储在 shournal 的 sqlite-database 中，可以通过以下方式检索

```
shournal --query -cmdcwd "$PWD" 
```

查询子工作目录可以通过

```
shournal --query -cmdcwd -like "$PWD/%" 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-12-08T11:20:47.960

你可以考虑一个独立的项目（我写的），它支持为每个命令保存路径：[https ://github.com/chrissound/MoscoviumOrange](https://github.com/chrissound/MoscoviumOrange)

您可以在 Bash 中添加一个挂钩以保存每个条目：

```
$(jq -n --arg command "$1" --arg path "$PWD" '{"command":$command, "path":$path}' | "$(echo 'readlink -f $(which nc)' | nix run nixpkgs.netcat)" -N -U ~/.config/moscoviumOrange/monitor.soc &) 
```

# visual-studio - Visual Studio 内置了哪些不同的输出流？

> ID：945296
> 
> 赞同：0
> 
> 时间：2009-06-03T15:03:00.337
> 
> 标签：visual-studio

是否还有输出流：

```
 Console.WriteLine(data)
    Trace.WriteLine(data)
    Debug.WriteLine(data) 
```

任何显着的细微差别或用途（例如：默认情况下会转到命令、输出、立即？）当目标是 Windows 应用程序时（使用输出窗口是变灰）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-05T06:30:54.560

我相信有。例如，当您安装 TFS 时，所有 TFS 源代码控制消息都会显示在“Team Foundation Server”窗口中。但是，我不知道您将如何创建自己的窗口或如何将 WriteLine 发送给它。

# javascript - 如何使用间隔循环修改 HTML Canvas 颜色？

> ID：945298
> 
> 赞同：1
> 
> 时间：2009-06-03T15:03:10.867
> 
> 标签：javascript, css, html, canvas

我写了这个，我想用某些颜色开始和结束循环（例如以 rgb 150,150,200 开始；以 rgb 190、160、200 结束）：

```
<!DOCTYPE HTML>
<html>
 <head>

 </head>
 <body>

  <canvas width="400" height="100"></canvas>

  <script>

   var context = document.getElementsByTagName('canvas')[0].getContext('2d');

   var lastX = context.canvas.width * Math.random();
   var lastY = context.canvas.height * Math.random();

   var hue = 100;

   function blank() {
    hue = hue + 5 * Math.random();

    context.fillStyle = 'hsl(' + hue + ', 60%, 80%)';

    context.fillRect(0, 0, context.canvas.width, context.canvas.height);

   }
   setInterval(blank, 50);

  </script>

 </body>
</html> 
```

* * *

如何更改起始颜色？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-03T15:41:10.383

色调变量和 hsl 样式中的百分比控制颜色。

从 RGB 颜色 150、150、200 开始，将色调设置为 240，将饱和度（hsl 中的第二个参数）设置为 25%，将亮度（第三个参数）设置为 78%。

要以 RGB 颜色 190、160、200 结束，您需要循环直到色调值达到 285。您还需要一个用于饱和度值的变量，因为它应该以 20% 结束。

[HSL 颜色](http://www.css3.info/preview/hsl/)

或者，使用 RGB 颜色而不是 HSL 颜色...

编辑：
如果要停止间隔，则需要将其句柄存储在变量中：

```
var interval = window.setInterval(blank, 50); 
```

然后你可以用它来停止间隔：

```
window.clearInterval(interval); 
```

我不知道您为什么要使用随机值来更改颜色。为简单起见，我只是在此示例中将其替换为固定值：

```
var hue = 240;
var sat = 25;

function blank() {
   context.fillStyle = 'hsl(' + hue + ', ' + sat + '%, 80%)';
   context.fillRect(0, 0, context.canvas.width, context.canvas.height);

   hue += 0.9;
   sat -= 0.1;

   if (hue > 285) window.clearInterval(interval);
}

var interval = window.setInterval(blank, 50); 
```

编辑：
如果您想反复淡入和淡出而不是以特定颜色结束，请为方向创建一个变量，并在达到每种结束颜色时更改它：

```
var hue = 240;
var sat = 25;
var dir = 1;

function blank() {
   context.fillStyle = 'hsl(' + hue + ', ' + sat + '%, 80%)';
   context.fillRect(0, 0, context.canvas.width, context.canvas.height);

   hue += 0.9 * dir;
   sat -= 0.1 * dir;

   if (hue <= 240 || hue >= 285) dir = -dir;
}

window.setInterval(blank, 50); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T16:08:04.790

这是一种方法。根据您的喜好调整步骤。比我更了解 js 的人有改进的余地...

```
 var r1 = 150; var g1 = 150; var b1 = 200;
 var r2 = 190; var g2 = 160; var b2 = 200;
 var step = 0.02;
 var curr = 0;
 var blankIvID;

 function blank() 
 {
  var r = r1 + ((r2 - r1) * curr);
  var g = g1 + ((g2 - g1) * curr);
  var b = b1 + ((b2 - b1) * curr);
  curr = curr + step;
  context.fillStyle = 'rgb(' + r + ', ' + g + ', ' + b + ')';

  context.fillRect(0, 0, context.canvas.width, context.canvas.height);
  if (curr >= 1.0)
  {
    clearInterval(blankIvID);
  }
 }
 blankIvID = setInterval(blank, 50); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T15:23:05.507

你应该检查一下 hsl() 函数吗？

# spss - 如何指定 SPSS 语法文件的编码？

> ID：945299
> 
> 赞同：1
> 
> 时间：2009-06-03T15:03:13.877
> 
> 标签：spss, spsite

我正在用类似的代码在 SPSS 中写出统计结果

```
OMS 
   / SELECT Tables Headings
   / DESTINATION FORMAT = OXML OUTFILE='C:\Temp\outfile.xml'. 
```

语法文件保存为 UTF-8（带书签）。它有一些带有变音符号的单词（德国有趣的字符，如ä、ö、ü）。当我打开语法文件时，它会将这些元音变音显示为 Ã¼、Ã¶ 等。不用说，在输出的 xml 文件中，元音变音仍然是乱码。

如何指定语法文件的编码？书签 (BOM) 似乎没有起到作用。

如果不是，我应该为语法文件使用什么编码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-06-13T07:33:49.467

这对我有用（SPSS 20）：

```
DATASET CLOSE ALL.
NEW FILE.
SET UNICODE = OFF. 
```

或者：

```
DATASET CLOSE ALL.
NEW FILE.
SET UNICODE = ON. 
```

实际上，前两行只是为了确保没有打开任何数据集，因为这会阻止命令执行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T15:32:40.433

这有效：

```
SET UNICODE YES 
```

（在语法文件的顶部）

**注意**：此设置是“粘性的”，即它会一直存在，直到您为该计算机上的所有 SPSS 会话再次更改它为止。不是很好，但我想它会做......

# shell - 在 ksh ENV 脚本中检测交互式 shell

> ID：945302
> 
> 赞同：5
> 
> 时间：2009-06-03T15:04:17.697
> 
> 标签：shell, unix, ksh

确定给定 ksh 调用是否正在运行交互式 shell 的首选方法是什么？

对于非交互式 ksh 调用（例如，在执行 shell 脚本时），我在一个`ENV`文件中有一些我想跳过的命令。

我已经看到建议范围[从](http://sage.org/lists/sage-members-archive/1999/msg00551.html)：

```
if [[ $- = *i* ]]; then
    # do interactive stuff
fi 
```

...甚至不采购，除非使用这种神秘的[咒语](http://sage.org/lists/sage-members-archive/1999/msg00552.html)`.kshrc`确定外壳是交互式的：

```
ENVIRON=$HOME/.kshrc                                    export ENVIRON
ENV='${ENVIRON[(_$-=1)+(_=0)-(_$-!=_${-%%*i*})]}'       export ENV 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2011-07-22T19:43:57.933

我发现检查 $- 变量中的 'i' 标志是 ksh 中的最佳方法。

```
if [[ $- = *i* ]]; then
    #do interactive stuff     
fi 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T15:08:04.913

在**bash**里面，这两种方法经常用到`~/.bashrc`：

*   检查是否`stdin`是 tty：

    ```
    [ -t 0 ] || return 
    ```

    或者

    ```
    if [ -t 0 ]; then
        # do interactive stuff
    fi 
    ```

*   检查是否设置了提示（`$PS1`）：

    ```
    [ -z "$PS1" ] || return 
    ```

但我不知道如何在 ksh 中做到这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T09:32:38.687

运行脚本时，正确的 KSH shell 不应调用 $ENV。然而，这是 Sun 方言中长期存在的错误，`ksh88`实际上是在 Solaris 10 后期修补的。（非常令人惊讶，因为 Sun 传统上非常不愿意改变现有行为，因为这样的修复可能会破坏解决方法。在这种情况下，标准占了上风。）

为了防止 sun 的 ksh88 在运行脚本时读取 $ENV，通常使用该`#!/bin/ksh -p`变通方法，并且如果您没有`/etc/suid_profile`闲逛是安全的。

但是，$-*是*交互式 shell 的可靠指标，除非您伪造它。

```
$ cat interactive.sh
echo \$- = $-
[[ $- == *i* ]] && echo interactive || echo not interactive 
```

当作为脚本运行时，这给出：

```
$ ksh  interactive.sh
$- = hB
not interactive 
```

当我们伪造`-i`国旗时，你会得到你想要的：

```
$ ksh  -i interactive.sh
$- = imBE
interactive 
```

当来自交互式外壳时，它会做正确的事情：

```
$ . ./interactive.sh
$- = imsBEl
interactive 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-13T15:56:13.020

也可以使用'tty -s'：

```
The following exit values are returned:

  0        Standard input is a terminal.

  1        Standard input is not a terminal. 
```

# xslt - 有人有浏览器 XSLT 比较表吗？

> ID：945305
> 
> 赞同：2
> 
> 时间：2009-06-03T15:04:40.350
> 
> 标签：xslt, browser

我即将开始开发一个 Web 应用程序并需要使用 XSLT 将[DITA](http://en.wikipedia.org/wiki/Darwin_Information_Typing_Architecture)文件转换为 HTML。

是否所有浏览器都遵循 XSLT 规范，或者有什么怪癖（很像 IE 中的 HTML 规范）？如果是这样，有没有人有任何关于“怪癖”的信息？

谢谢，西蒙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T15:15:50.607

我不相信您会对 XSLT 有任何问题。但是，您将遇到由 XSLT 生成的 Web 内容的标准问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T16:00:55.787

为什么不在服务器端进行这种转换，因为您可以更严格地控​​制 XSLT 解析器？为什么要留下任何机会？就个人而言，当我完成 XML/XSLT -> HTML 表示转换时，我总是在服务器上完成。YMMV。我想对于将转换卸载给客户有一些话要说，但我一直担心你是什么，合规性。

也就是说，您今天将遇到的大多数浏览器（safari、webkit、gecko、IE）都将提供不错的 XSLT 支持。然而，就像 HTML 一样，它也有它的怪癖。带有 XSLT 的 IIRC，就像 XHTML 一样，您的 HTML 需要格式正确。不

```
<P><B></P></B> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-02-11T20:57:32.980

我知道你刚才问过这个问题，但我认为你不能只使用 XSLT 将 DITA 转换为 HTML。也许它适用于极其简单的非链接主题，但对于完整的规范，您需要像 DITA Open Toolkit 这样的东西来对地图的标题/链接等进行预处理和聚合。

# c# - 通过套接字从 C++ wchar_t 到 C# char

> ID：945309
> 
> 赞同：2
> 
> 时间：2009-06-03T15:05:42.233
> 
> 标签：c#, c++, sockets, interop, marshalling

我目前正在构建一个通过套接字与 C# 应用程序通信的 C++ 应用程序。我的 C++ 应用程序通过套接字发送 wchar_t*。

以下是 send 的概述：

```
<!-- Normal xml file-- 
```

这是我在另一边收到的内容（我对字节数组执行了 stream.read 并使用 UTF8Encoding.GetString() 将字节数组转换为可读字符串）

```
<\0!\0-\0-\0 \0N\0o\0r\0m\0a\0l\0 \0x\0m\0l\0 \0f\0i\0l\0e\0-\0- 
```

是编组问题吗？你说什么？为什么它是 0 扩展，为什么 unicode 字符不出现在 C# 端？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-03T15:07:49.860

看起来它正在发送 UTF-16，而不是 UTF-8，这是有道理的 -`wchar_t`基本上是 16 位类型（在 Windows 中），据我所知，你正在将它发送到“原始”。我建议，如果您要将数据转换为`XDocument`or `XmlDocument`，您可以使用二进制数据 - 该框架知道如何为 XML 文件 (IIRC) 自动检测 UTF-16。

如果 XML 声明将其声明为 UTF-8，而实际上它是 UTF-16，那么您可能会遇到问题。

或者，在 C++ 端使用合适的编码类来*真正*发送 UTF-8。这将需要额外的处理时间，但如果考虑到这一点，通常会节省带宽。

# flash - SWF 可以集成到 Java 应用程序中吗？

> ID：945311
> 
> 赞同：1
> 
> 时间：2009-06-03T15:05:48.753
> 
> 标签：flash

我希望将 SWF 文件嵌入到 Java 程序中，但我无法找到执行此操作的方法。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T19:00:52.053

无论您做什么，都可能涉及以某种方式在您的应用程序中嵌入 Flash 播放器。看这两个：

[使用 NPAPI 在自定义桌面应用程序中嵌入闪存？](https://stackoverflow.com/questions/643177/embedding-flash-within-a-custom-desktop-application-using-npapi/645701)

[在 C++ 或 Java 应用程序中嵌入 Flash Player？](https://stackoverflow.com/questions/214411/embedding-flash-player-in-a-c-or-java-application/741518)

如果您计划重新分发播放器，请注意许可问题。看看[Open Screen Project](http://www.openscreenproject.org/)。

祝你好运

# visual-studio-2008 - 禁用 VSTO 的 Visual Studio 2008 转换向导

> ID：945316
> 
> 赞同：1
> 
> 时间：2009-06-03T15:06:45.587
> 
> 标签：visual-studio-2008, wizard

是否可以停用 VS 2008 转换向导。我想打开一个包含 Office 2003 的 VSTO 项目的解决方案，并且当我在装有 Office 2007 的 PC 上打开解决方案时，我不希望它们被转换。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-03T15:17:10.930

查看此处找到的 VS2008 选项...

工具 -> 选项 -> 办公工具 -> 项目升级

尝试清除选项*始终升级到已安装的 Office 版本*。

那是你要找的吗？

# c - windows中c中的睡眠功能。是否存在精度更高的函数？

> ID：945320
> 
> 赞同：3
> 
> 时间：2009-06-03T15:07:48.673
> 
> 标签：c, windows, sleep, precision, delay

我想知道是否有人知道可以在 c 中的 windows 中使用的更好的睡眠功能，除了 Sleep()，它需要毫秒输入，并且只保证输入是经过的最短时间。我在 1 毫秒内通过，但实际上延迟了 15-16 毫秒。有什么方法可以准确设置指定的睡眠时间？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T15:15:56.427

不，不是。当你告诉你的程序休眠时，你就放弃了处理器，让操作系统决定下一步该做什么。一旦操作系统处于控制之中，它就会决定何时给您的程序另一片处理时间。这就是您可以指定最小值的原因，但不能保证操作系统会在任何特定时间返回您的进程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T15:12:41.893

查看[多媒体计时器](http://msdn.microsoft.com/en-us/library/ms712704(VS.85).aspx)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-04T02:24:14.623

睡眠只保证您的进程不会执行*至少* **n**毫秒，而不是它会*恰好睡眠* **n**毫秒。也许你想设置一个计时器？或忙等待（即循环轮询QueryPerformanceCounter）。

我会尽量避免这种方法（忙等待），除非你必须这样做，你正在燃烧周期并且你正在阻止 CPU 进入较低的时钟速度（即消耗电池寿命）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T15:14:21.530

不，Windows 上没有更好的睡眠功能，因为毫秒是可用的粒度级别。如果你想睡得更少，你需要实现某种自旋锁。

# sql-server-2005 - 在两个数据库之间同步存储过程？

> ID：945325
> 
> 赞同：1
> 
> 时间：2009-06-03T15:08:09.467
> 
> 标签：sql-server-2005, stored-procedures

对于我的团队正在开发的应用程序，我创建了一个数据库副本，以独立处理系统的一些可能功能。在此过程中，我更改了一些存储过程。同时，团队的其他成员继续在其他数据库上工作并更改其中的一些存储过程。

该代码仍在调用相同的 SP 名称，因此我需要知道哪些存储过程已更改，以便进行正确的修复。有没有办法从一个数据库中获取所有存储过程并将其与另一个数据库中具有相同名称的 SP 进行匹配，以查看哪些不同（除了 USES[DB1] 和 USES [DB2] 差异）。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-03T15:15:40.683

我建议购买（或只是评估）一个专用工具来实现这一点。市场上有许多产品，包括： [Apex SQL Diff](http://www.apexsql.com/sql_tools_diff.asp)和[Redgate SQL Compare](http://www.red-gate.com/products/SQL_Compare/index.htm)

我已经使用 Apex SQL Diff 多年，并且会全心全意地推荐它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T15:12:54.263

哎呀，这是你应该早点考虑的事情。一种方法：将 SP 代码提取到文件中并使用 Windiff 之类的工具。

或者，如果您必须在数据库中执行此操作，请查看[这些工具](http://en.wikipedia.org/wiki/Microsoft_SQL_Server_Compare_Tools)。

将来，将您的 SP 脚本放入源代码管理中。您可以对更改进行分支和合并。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T15:17:17.140

Visual Studio 中可用的功能之一称为架构比较，它将比较所有数据库对象，例如表、视图、存储过程等。不确定您是否有该工具可用。

另一个功能允许您比较已经成为救星的数据库中的数据。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T15:33:49.727

要查找事情何时发生变化，请使用以下命令：

```
SELECT
    CONVERT(varchar(23),modify_date,121) AS modify_date
        ,type_desc
        ,name
    FROM sys.objects
    WHERE is_ms_shipped=0
    ORDER BY 1 DESC 
```

它将列出以下类型的项目：

```
CHECK_CONSTRAINT
DEFAULT_CONSTRAINT
FOREIGN_KEY_CONSTRAINT
PRIMARY_KEY_CONSTRAINT
SQL_SCALAR_FUNCTION
SQL_STORED_PROCEDURE
SQL_TABLE_VALUED_FUNCTION
SQL_TRIGGER
UNIQUE_CONSTRAINT
USER_TABLE
VIEW 
```

此外，您可能想研究 CVS 或 sourcesafe 之类的东西，以便您可以签出/签入代码并具有合并/分支功能。

编写所有内容以分隔文件并使用 Beyond Compare 之类的工具（有免费试用版）[http://www.scootersoftware.com/moreinfo.php](http://www.scootersoftware.com/moreinfo.php) 它可以比较目录并允许您查看每个文件的差异，具有合并功能等.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-03T16:08:57.583

大家好。我考虑了所有的反应，下载新软件对我来说不是一个选择。经过进一步研究，这就是我提出这个解决方案的方式。

我只是在两个数据库中查询了所有存储过程的列表及其最近的更改日期。然后我比较了他们的更改日期并手动查看了他们的来源并进行了更改。源代码管理肯定会对此有所帮助，但有时事情超出了我的控制。

获取我的所有 SP 名称和更改日期列表的代码如下。

```
select ROUTINE_NAME, LAST_ALTERED
from information_schema.routines
WHERE
Routine_Type='procedure'
AND specific_Catalog='DATABASE_NAME' ORDER BY LAST_ALTERED 
```

# php - 给定 3 级用户，如何设置 CakePHP ACL？

> ID：945326
> 
> 赞同：0
> 
> 时间：2009-06-03T15:08:15.553
> 
> 标签：php, cakephp, installation, acl

我有一个这样的数据库设置（我知道这不是最好的设置，但我无法更改它:-(

基本上有 3 个级别的用户 - 管理员 - 经理 - 员工

几点注意事项： - 每个员工都属于部门 - 如果员工登录代码出现在经理表中，则他们是经理，否则他们是员工 - 如果员工登录代码出现在经理表中并且 SystemAdmin 设置为 1，他们是管理员

我到底该如何为此设置 ACL/Auth？有任何想法吗？

CREATE TABLE `tblStaff`( `StaffID`int(11) NOT NULL auto_increment, `dept_id`varchar(5) default NULL, `logon_code`char(10) NOT NULL, `forename`char(50) NOT NULL, `surname`char(50) NOT NULL, PRIMARY KEY ( `StaffID`), ) ;

创建表`tblManager`（ `ManagerID`varchar（15）NOT NULL， `logon_code`varchar（15）NOT NULL， `dept_id`varchar（5）NOT NULL， `SystemAdmin`tinyint（1）无符号默认NULL，PRIMARY KEY（`ManagerID`））；

CREATE TABLE `tblDepartment`( `dept_id`varchar(5) NOT NULL, `sect_id`varchar(50) 默认 NULL, `subsect_id`varchar(50) 默认 NULL, `sect_name`varchar(50) 默认 NULL, `sect_abbr`varchar(50) 默认 NULL, `subsect_name`varchar(50) 默认 NULL, PRIMARY KEY ( `dept_id`) ;

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-04T06:56:20.693

老实说，我不明白为什么 tblStaff 和 tblManager 在您的示例中应该分开。他们不都是某种意义上的“员工”，即“员工”吗？

为什么不：

创建表 tblUsers（UserID、logon_code、dept_id、SystemAdmin、firstname、lastname 等）

毕竟，无论他们是“员工”还是“经理”，他们都将是您应用程序的“用户”。

此外，如果您需要更多地分离这些，您可以添加另一个字段（例如 user_level_id），这将确定每个用户的角色。之后，Auth/ACL 应该相当简单。

# actionscript-3 - 如何将文件保存到本地目录

> ID：945327
> 
> 赞同：2
> 
> 时间：2009-06-03T15:08:36.753
> 
> 标签：actionscript-3

我需要将文件保存在特定目录中。

我尝试使用以下代码并且它正在工作，但它正在打开对话框以选择要保存文件的路径。

```
var texT:String="Hi this to be saved";

var file:FileReference = new FileReference();
    file.save(texT,"myfile12.Text"); 
```

但我希望它像这样保存文件

```
var file:FileReference = new FileReference();
    file.save(texT,"c:\ProjectFolder\XmlFile\myfile.Text"); 
```

它不工作。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-03T15:20:58.380

如果您以 Flash Player 为目标，则无法执行此操作。您只能提示用户保存它的位置。

它确实工作得很好，但它可能不是你想要的。

如果您使用的是 AIR，则可以使用其他类来处理特定目录中的文件。AIR 解决了很多安全问题，因为您的应用程序实际上是由用户安装的。

你能想象从一个网站打开一个闪存文件，它会在你不知情的情况下修改你硬盘上的东西吗？除非您使用 AIR，否则这是不允许的。

如果您打算使用 AIR 1.0 作为目标环境，File 和 FileStream 类将对您[很有](http://help.adobe.com/en_US/AS3LCR/Flash_10.0/flash/filesystem/File.html)用[。](http://help.adobe.com/en_US/AS3LCR/Flash_10.0/flash/filesystem/FileStream.html)File 类将允许您引用任何文件，然后 FileStream 提供读取和写入它们的方法。

# apache-flex - Flex 设计视图不适用于具有自定义基类的组件

> ID：945329
> 
> 赞同：0
> 
> 时间：2009-06-03T15:09:02.307
> 
> 标签：apache-flex, mxml, components, design-view

我有一个 Flex 组件，它不是直接从 Canvas 继承，而是从我编写的自定义类 (MyBaseComponent) 继承，而后者又从 Canvas 继承：

画布 > 我的基础组件 > 我的组件 (mxml)

设计视图不适用于此控件。我只是得到一个空白的灰色屏幕。（如果我使用 Canvas 而不是我的自定义基类，它就可以工作。）没有错误，项目编译并运行得很好。

具有自定义基类的应用程序在设计视图中工作，那么为什么不使用组件呢？在这种情况下有什么特别需要做的吗？

这是我的组件的 mxml 的外观：

```
<?xml version="1.0" encoding="utf-8"?>
<Custom:MyBaseComponent xmlns:mx="http://www.adobe.com/2006/mxml" width="614" height="282" xmlns:Custom="MyCustomLib.*">
    ...
</Custom:MyBaseComponent> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T15:28:59.317

你是对的，它们不起作用，永远不会回到 Flex Builder 2 测试版。

这实际上是我第一篇博文的主题。如果您有兴趣，它有一个 hacky 解决方法，但在这里发布有点长：

[http://www.rogue-development.com/blog2/2007/03/code-in-front/](http://www.rogue-development.com/blog2/2007/03/code-in-front/)

# java - JDBC getConnection 超时问题

> ID：945330
> 
> 赞同：0
> 
> 时间：2009-06-03T15:09:03.070
> 
> 标签：java, jdbc, jakarta-ee

我有一个应用程序使用连接池从 Oracle9i 版本 9.2.0.4 数据库获取数据库连接。应用程序托管在 SJSAS 8.1 中，驱动程序`ojdbc14.jar`版本为 10.1.0.4。

我遇到的问题是`datasource.getConnection()`当数据库关闭时，方法需要大约 40 秒才能引发异常！这会导致应用程序在数据库中断期间过载。我尝试`LoginTimeout=8`使用数据源进行设置，但没有效果。

请参阅下面我正在使用的数据源

```
<jdbc-connection-pool connection-validation-method="table" 
                      datasource-classname="oracle.jdbc.pool.OracleDataSource" 
                      fail-all-connections="true" 
                      idle-time out-in-seconds="600" 
                      is-connection-validation-required="true" 
                      is-isolation-level-guaranteed="false" 
                      max-pool-size="100" 
                      max-wait-time-in-millis="8000" 
                      name="mydb" 
                      pool-resize-quantity="80" 
                      res-type="javax.sql.DataSource" 
                      steady-pool-size="20" 
                      validation-table-name="dual">
    <property name="url" value="jdbc:oracle:thin:@server1:1521:mydb"/>
    <property name="user" value="user1"/>
    <property name="LoginTimeout" value="8"/>
    <property name="password" value="pass1"/>
</jdbc-connection-pool> 
```

有人可以帮忙吗？我需要在`getConnection()`给定的超时时间内超时的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T21:19:01.150

这里有几件事可以尝试：

来自“Oracle® 数据库 JDBC 开发人员指南和参考”。

将 JDBC 与防火墙一起使用

空闲连接的防火墙超时可能会断开连接。这会导致 JDBC 应用程序在等待连接时挂起。您可以执行以下一项或多项操作，以避免因防火墙超时而断开连接：

*   如果您正在使用连接缓存或连接池，则始终将连接缓存上的非活动超时值设置为小于防火墙空闲超时值。
*   作为连接属性传递`oracle.net.READ_TIMEOUT`以在套接字上启用读取超时。超时值以毫秒为单位。
*   对于 JDBC OCI 和 JDBC Thin 驱动程序，使用 net 描述符连接到数据库并在连接描述符的 DESCRIPTION 子句中指定 ENABLE=BROKEN 参数。此外，为 设置较低的值`tcp_keepalive_interval`。
*   通过在服务器端`SQLNET.EXPIRE_TIME=1`的 文件中进行设置来启用 Oracle Net DCD 。`sqlnet.ora`

# linux - 如何使用 rsync 备份最近一段时间内更改的文件？

> ID：945331
> 
> 赞同：17
> 
> 时间：2009-06-03T15:09:16.953
> 
> 标签：linux, scripting, backup, rsync, bsd

是否可以指定一个时间范围，以便 rsync 仅对最近更改的文件进行操作。

我正在编写一个脚本来通过 SSH 备份最近添加的文件，而 rsync 似乎是一个有效的解决方案。我的问题是我的源目录包含大量积压的旧文件，我没有兴趣备份这些文件。

到目前为止，我遇到的唯一解决方案是使用 ctime 进行查找以生成 --files-from 文件。这可行，但我必须处理一些不支持 --files-from 的 rsync 版本的旧安装。我正在考虑以相同的方式生成 --include-from 模式，但希望找到更优雅的东西。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-06-04T11:55:36.783

看起来您可以在 rsync 的参数中指定 shell 命令（请参阅[远程 rsync 执行任意 shell 命令](http://babel.de/art20060614a.html)）

所以我已经能够通过使用成功地限制 rsync 查看的文件：

```
rsync -av remote_host:'$(find logs -type f -ctime -1)' local_dir 
```

这会查找在最后一天更改的所有文件 (-ctime -1)，然后将它们同步到 local_dir。

我不确定此功能是否是设计使然，但我仍在深入研究文档。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T15:31:02.167

为什么不花点时间备份整个目录并利用 rsync 和 rdiff 及其表亲提供的增量备份，您将不会浪费备份它们的磁盘空间，因为它们将永远不变。

备份整个事情更简单，而且出错的风险也大大降低。尝试有选择地备份一些文件而不是其他文件是在没有意识到的情况下不备份您需要的文件的秘诀，然后在您无法恢复关键文件时被烧毁。

否则，您应该重新组织您的源目录，以减少备份脚本中的“决策”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T15:27:31.707

如何创建一个临时目录，对其中的文件进行符号链接或硬链接，然后 rsync 呢？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-04T12:13:13.877

我可以建议您放弃 rsync 并查看 rdiff-backup 吗？

# asp-classic - 我应该如何访问另一个模块的 DAL？

> ID：945336
> 
> 赞同：0
> 
> 时间：2009-06-03T15:10:29.277
> 
> 标签：asp-classic, class-design, data-access-layer

好的，所以我的应用程序中有几个模块。一种称为 ProductCatalogue，另一种称为 Contracts。我们现在需要与许多产品相关联的合同（例如，允许合同一方订购的产品）。在 ProductCatalogue 模块中，我们有一个 ProductDAL 类，它具有以下功能

```
Public Function GetProducts()
    Set GetProducts = GenerateProductsList("SOME SQL")
End Function

Private Function GenerateProductsList(selectQuery)
    Dim list : Set list = New List
    Dim results : results = GetResultsFromDB(selectQuery)
    '... for each row
        Dim product : Set product = New Product
        product.Id = results(field, index)
        list.Add(product)
    'loop ...
    Set GenerateProductsList = list
End Function 
```

现在，我想获取与合同相关的所有产品，所以我想编写一个看起来像这样的函数

```
Public Function GetProductsForContract(contractId)
    Set GetProductsForContract = GenerateProductsList("SOME SQL")
End Function 
```

我的问题是，我应该把这个功能放在哪里？我想使用现有的 GenerateProductsList() 函数，因为它比看起来要复杂得多。我的问题是“我应该把GetProductsForContract放在哪里”？

我的选择：

1）把它放在ProductDAL中。
问题在于 ProductDAL 突然意识到合约是什么，我可以看到它很快就充满了 GetProductsForAllContracts、GetProductsForLiveContracts 等功能（当其他模块想要访问产品时还有更多功能）所以我真的会喜欢将这些功能与合同代码的其余部分一起保留。

2) 将其放入 ContractDAL 并公开 ProductDAL.GenerateProductsList。
我真的应该暴露这个吗？

3) 创建一个新类，该类唯一负责接收 SQL 数据集并返回产品列表的方法。
其实这不是和2一样吗？

4）停止做错事。
我不确定如何。给我看看。然后抱住我。

编辑：另外，AddProductToContract、RemoveProductFromContract 怎么样？我倾向于一个新的 ContractProductManager 类，但访问 GenerateProductsList() 的最佳方式是什么

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T15:19:53.547

如果不了解您的应用程序，这很难回答。我想说，如果产品和合同在同一个数据库中并且总是在同一个数据库中，那么拥有 2 个 DAL 似乎是一种任意分离。由于您可能已经在数据库中建立了产品和合同之间的关系，因此在 DAL 中分离这两者并没有任何好处。您可以将此新方法放入任一类中，恕我直言。

# c++ - 使用 C 中的 .lib 文件

> ID：945347
> 
> 赞同：2
> 
> 时间：2009-06-03T15:13:15.417
> 
> 标签：c++, c, visual-c++, static

我是 C/C++ 新手。我有一个使用 VC++ 创建的静态库 (.lib) 文件。（我也有 .h 文件）。我需要在 C 程序中使用它。你能帮我做这件事吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-03T15:17:40.447

你能澄清一下你是想构建一个EXE还是一个DLL？

您要查找的内容称为静态链接。这将获取 .lib 文件并将其嵌入到您的应用程序中。

*   [http://en.wikipedia.org/wiki/Static_linking](http://en.wikipedia.org/wiki/Static_linking)

您需要在 VC++ 中更改项目设置，以将此文件作为链接到流程中的文件之一。如果您向我们提供有关 Visual Studio 版本的更多信息，我们可以提供有关如何执行此操作的更具体的答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T20:11:15.890

由于您在未来的 C 程序中使用 VC++，因此请转到项目的配置属性（在项目菜单中，选择属性）。

在 C/C++->General->Additional Include Directories 下，添加您的 .h 文件所在的文件夹。

在 Linker->Input->Additional Dependencies 下，添加 .lib 文件的名称。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T15:19:29.040

请注意，此类静态库通常仅用于一个编译器（通常甚至是版本）。

# web-services - Delphi 2009 Web 服务“xml 文档必须有一个顶级元素”

> ID：945354
> 
> 赞同：2
> 
> 时间：2009-06-03T15:15:08.690
> 
> 标签：web-services, delphi, delphi-2009

我今天使用 Delphi 2009 构建的各种 delphi 演示（应用了更新 3/4）似乎都导致我尝试使用的任何 localhost Web 服务的客户端返回“xml 文档必须具有顶级元素”错误

这包括，例如，甚至像 [http://blogs.embarcadero.com/pawelglowacki/2008/12/18/38624这样简单的演示](http://blogs.embarcadero.com/pawelglowacki/2008/12/18/38624)

我错过了什么？这里有什么问题？非常令人沮丧...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-02-23T17:09:07.667

您最可能遇到的问题是您的 apache 模块上的某些东西，也许您的 cgi 脚本在 Apache (HTTP 500) 上导致了严重的内部服务器错误。结果，您的 apache 抛出错误，但该错误是 HTML，而不是 XML 格式。因此，例如，如果您正在使用 Web 服务，您希望获得 SOAP（即 XML），但您获得的 HTML 无法识别，因此您的应用程序可能会显示类似“xml 文档必须具有顶级元素”之类的内容或在我的情况下“客户端发现响应内容类型为 TEXT/HTML 但预期为文本/xml”。最糟糕的是，apache error.log 不会显示任何内容，而 access.log 只会显示 500 错误（尽管我将其设置为调试模式）。我已经使用 Wireshark 来尝试解决我的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-10T02:28:04.033

尝试为 HTTPSoapPascalInvoker.Options 设置以下选项：

```
soRootRefNodesToBody
soUTF8InHeader
soUTF8EncodeXML 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-11T18:36:15.693

好吧——这有点陌生——

我发现这一切都在 IIS 下工作，但在 apache 上失败（eed3si9n 的解决方案不适用于 apache）

更糟糕的是，我发现在 apache 下，我在 POST 上的基本 cgi 请求内容字段在 apache 下是空的 - 但我只是在 IIS 下部署，它工作得很好

所以要么罪魁祸首是我的 apache 安装，要么在 apache 下使用 delphi 有问题（肯定会被广泛报道和修复）

那么 --- 有没有人知道我应该在这里查看哪些 apache 配置选项？

谢谢

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-11T11:43:53.467

这很可能意味着由于加载 SOAP 库的错误或 SOAP 库本身的错误，您从服务器获得了 HTML 响应。无法解析 HTML 并导致此错误。

代理可以帮助你，但你可能想看看[Wireshark](http://www.wireshark.org/ "线鲨")，因为它可以让你很容易地嗅探流量，而不仅仅是 HTTP 流量。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-03T15:33:24.067

可能您生成的 XML 数据有误。每个 XML 文档都必须有一个顶级元素：

```
<xml version="..">
<topLevelElement>
 <element>
   ...
 </element>
 <element>
   ...
 </element>
<topLevelElement> 
```

如果缺少此根元素，则反序列化器将引发异常。

# .net - “编组”一词的精确定义

> ID：945371
> 
> 赞同：12
> 
> 时间：2009-06-03T15:19:34.063
> 
> 标签：.net, marshalling

在 .NET 世界中，编组仅意味着准备对象/数据以跨边界或通过线路传输，还是意味着准备*和*跨边界或通过线路传输。

编组呼叫是什么意思。这是否意味着只是对上下文边界上的“传输”调用的打包，还是调用的打包和发送（即调用）？

对不起，我是个顽固的人……

克拉里

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T15:30:21.047

在我看来，编组是指获取对象或数据，准备在非本地环境中使用，然后将其呈现给外部环境的行为。

我认为它是在不熟悉的环境中“引入”的数据或对象。这可能涉及不同的编码、包装器等，并且对象如何传输是编组过程的重要部分。

在数据或对象实际呈现给它的新上下文之前，我不认为它是编组的。那时它刚刚被转换、加密、包装或其他。

例如，JSON 通常用于将对象或数据从一个进程传输到另一个进程。当您转换为 JSON 时，我只考虑从一种数据结构到另一种数据结构的转换。一旦它通过电线传输，那么它就会被编组。

所以，没有上下文变化，没有编组。

那是我的两分钱。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T15:29:19.427

据我了解，这是数据的准备，而不是传输。仍然使用该术语来包括转移并不少见（我也为此感到内疚）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T15:35:37.013

我认为它可以代表两种情况。

*   仅数据：考虑 PInvoke 场景。Marshaling 通常用于描述将数据从 .Net 格式转换为相应的 C 格式的行为。
*   数据和呼叫：考虑跨公寓的 COM 呼叫。在这种情况下，调用和调用所需的数据都被认为是编组的，因为实际调用必须跨越 COM 单元边界。我知道您在 .Net 的背景下提出了这个问题，但我相信这是一个与 .Net 相关的可靠示例。例如，考虑使用 ISynchronizedInvoke 在线程之间进行。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-03T15:35:38.573

“元帅”有多种含义，但除了作为一个头衔之外，它还意味着。. .

> 元帅——动员：准备行动或使用；“元帅资源”

所以它应该只是“打包”的意思，而不是“打包和发送”。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-03T15:38:27.963

编组纯粹是跨越边界

通常用于在 2 个 appDomain 之间传递对象。over the wire 部分是一个可选的东西，但是通过网络发送对象的过程首先是对象的序列化，发送通常是通过一些其他协议（tcp/ip）。

# git - 如何有效地变基和推送本地 git 分支？

> ID：945372
> 
> 赞同：9
> 
> 时间：2009-06-03T15:19:41.503
> 
> 标签：git, merge, rebase

我们正在使用我克隆的中央 git 存储库，并且正在本地分支上工作。

当我想让我的更改在中央存储库中可用时，我必须发出以下命令（从 开始`mybranch`）：

```
#Stash local changes not yet ready for checkin
git stash

#Make sure we have all changes from the central repository
git checkout master
git pull

#Rebase local changes
git checkout mybranch
git rebase

#Push changes
git checkout master
git merge mybranch
git push

#Back to my branch and continue work
git checkout mybranch
git stash apply 
```

我想知道是否可以使用更少的 git 命令来实现相同的目标。`master`和之间的几个切换`mybranch`特别烦人，因为我们的存储库相当大，所以它们需要一些时间。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-04T20:55:06.897

如果您不需要更新本地主分支，则无需触摸它，这似乎会导致您进行很多不必要的分支切换。

这是一个更简单的工作流程。

```
git fetch

# ensure that everything is committed
# perhaps git commit -a is required...

git rebase origin/master

# If you don't want to push the very latest commits you might
# want to checkout a parent or ancestor of the current commit
# to test that the proposed commit passes tests, etc.
# e.g. git checkout HEAD~n

# push to the remote master
git push origin HEAD:master

# if you checked out a parent, go back to the original branch
git checkout mybranch 
```

如果您对父提交非常有信心，您可以跳过结帐步骤并执行以下操作，但我强烈建议您不要这样做。发布未经测试的提交不是“最佳实践”。

```
git push origin HEAD^:master 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-03T18:50:53.180

没有必要对 master 和 mybranch 分支都进行拉取。既然你是一个很好的公民，并且进行快进更新，这很简单：

```
# Save local mods not ready for commit
git stash
# Do the pull & rebase local work assuming this is a remote tracking branch
git pull --rebase
git checkout master
git merge mybranch
git push 
```

当然，你也可以从你的 mybranch 分支推送

```
# Save local mods not ready for commit
git stash
# Do the pull & rebase local work assuming this is a remote tracking branch
git pull --rebase
git push origin mybranch:master 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T15:24:47.173

您可以将 pull 和 rebase 合二为一：

git pull --rebase master

但总的来说，是的，根据我的经验，它涉及所有这些命令。

为了保持您的存储库清洁，经常运行“git gc”会删除未使用的对象，这很有帮助。这应该减少分支切换时间。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T15:32:02.727

我通常会。

```
git co master
git pull
git rebase master mywrk # fix conflicts if any
git rebase mywrk master
git push 
```

如果您喜欢这种方式，您可以定义别名以节省输入。

# ant - 如何在 Ant 中提取子字符串

> ID：945374
> 
> 赞同：39
> 
> 时间：2009-06-03T15:19:43.063
> 
> 标签：ant

有没有办法从 Ant 属性中提取子字符串并将该子字符串放入它自己的属性中？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2010-10-14T22:44:10.097

我使用 scriptdef 创建一个 javascript 标记来子字符串，例如：

```
 <project>
  <scriptdef name="substring" language="javascript">
     <attribute name="text" />
     <attribute name="start" />
     <attribute name="end" />
     <attribute name="property" />
     <![CDATA[
       var text = attributes.get("text");
       var start = attributes.get("start");
       var end = attributes.get("end") || text.length();
       project.setProperty(attributes.get("property"), text.substring(start, end));
     ]]>
  </scriptdef>
  ........
  <target ...>
     <substring text="asdfasdfasdf" start="2" end="10" property="subtext" />
     <echo message="subtext = ${subtext}" />
  </target>
 </project> 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-06-03T19:06:37.143

您可以尝试使用[Ant-Contrib 的 PropertyRegex](http://ant-contrib.sourceforge.net/tasks/tasks/propertyregex.html)。

```
 <propertyregex property="destinationProperty"
              input="${sourceProperty}"
              regexp="regexToMatchSubstring"
              select="\1"
              casesensitive="false" /> 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-02-09T08:33:13.273

因为我更喜欢使用 vanilla Ant，所以我使用了一个临时文件。在任何地方都可以使用，您可以利用 replaceregex 删除您*不*想要的字符串部分。处理 Git 消息的示例：

```
 <exec executable="git" output="${git.describe.file}" errorproperty="git.error" failonerror="true">
        <arg value="describe"/>
        <arg value="--tags" />
        <arg value="--abbrev=0" />
    </exec>
    <loadfile srcfile="${git.describe.file}" property="git.workspace.specification.version">
        <filterchain>
           <headfilter lines="1" skip="0"/>
           <tokenfilter>
              <replaceregex pattern="\.[0-9]+$" replace="" flags="gi"/>
           </tokenfilter>
           <striplinebreaks/>
        </filterchain>
    </loadfile> 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2019-12-11T12:41:16.140

我想一个简单的香草方法是：

```
<loadresource property="destinationProperty">
    <concat>${sourceProperty}</concat>
    <filterchain>
        <replaceregex pattern="regexToMatchSubstring" replace="\1" />
    </filterchain>
</loadresource> 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-03T18:53:33.050

我会用蛮力去写一个自定义的 Ant 任务：

```
public class SubstringTask extends Task {

    public void execute() throws BuildException {
        String input = getProject().getProperty("oldproperty");
        String output = process(input);
        getProject().setProperty("newproperty", output);
    }
} 
```

剩下什么来实现`String process(String)`并添加几个设置器（例如，用于`oldproperty`和`newproperty`值）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-09-04T20:37:53.537

我会为此目的使用脚本任务，我更喜欢 ruby​​，例如切断前 3 个字符 =

```
<project>
  <property name="mystring" value="foobarfoobaz"/>  
   <target name="main"> 
    <script language="ruby">
     $project.setProperty 'mystring', $mystring[3..-1]
    </script>
    <echo>$${mystring} == ${mystring}</echo>
   </target>    
  </project> 
```

输出 =

```
main:
     [echo] ${mystring} == barfoobaz 
```

在现有属性上使用带有方法 project.setProperty() 的 ant api 将覆盖它，这样您就可以解决标准 ant 行为，这意味着属性一旦设置是不可变的

# eclipse - 矩形选择/剪切/粘贴区域的eclipse插件？

> ID：945382
> 
> 赞同：11
> 
> 时间：2009-06-03T15:21:09.987
> 
> 标签：eclipse, editor

有谁知道 Eclipse 插件通过矩形区域进行选择而不是“正常”选择？（差异如下所示）

```
 the asterisks here represent a "normal" selection region *****
 ************
 ******************
 ***** and can all be selected as one block of text

 here is a ************* rectangular
 selection ************* region
 that I wo ************* uld like to be able 
 to select and delete 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-06-03T15:26:22.067

**编辑：** [Eclipse 3.5 有这个内置的](http://help.eclipse.org/galileo/index.jsp?topic=/org.eclipse.platform.doc.user/whatsNew/platform_whatsnew.html)，所以现在不需要插件了。

> 文本编辑器现在支持块（又名列或矩形）选择模式：
> 
> ![块选择](https://i.stack.imgur.com/PsBug.png "块选择")
> 
> 要启用它，请使用`Alt`++或激活“编辑器演示”操作集以获取用于切换块选择模式的工具栏按钮。`Shift``A`

* * *

对于 Eclipse 3.4 及更早版本，请尝试[columns4eclipse](http://sourceforge.net/projects/columns4eclipse)：

> Columns Plug-in for Eclipse 定义了“Column”的概念和这个可编辑组件的一些功能。提供复制、粘贴、剪切、填充、小写、大写、查找替换、列历史等功能。

或[column_mode](http://tkilla.ch/column_mode/)：

> 已经有各种尝试通过简单地在 eclipse 上添加一个插件来解决这个问题，最值得注意的是 columns4eclipse。但是，这些解决方案无法提供来自 UltraEdit 等编辑器的完整功能。
> 
> 2007 年 1 月，Avaloq 赞助创建了一个在 eclipse 中原生实现列模式的补丁。由于补丁的侵入性以及 Eclipse 3.3 的 API 冻结已经临近，因此无法仔细查看补丁。该站点的目的是提供所需插件的修补版本，以便感兴趣的各方轻松使用所提供的功能。
> 
> 2008 年 7 月 – 补丁进入 Eclipse 主干的可能性很小。应普遍要求，我已将补丁改编为 Eclipse 3.4，并创建了一个更新站点，其中包含 Eclipse SDK 中受影响特性的特性补丁。这应该适用于大多数文本编辑器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-05T19:17:55.493

在运行 Eclipse3.7 的 OSX 中，块引用通过`option + command + a`

# reporting-services - 是否可以在 SQL Server Reporting Services 2005 中应用样式表和样式表类

> ID：945383
> 
> 赞同：1
> 
> 时间：2009-06-03T15:21:10.363
> 
> 标签：reporting-services, stylesheet, reportingservices-2005

我有一批报告，需要对报告的呈现方式进行某些更改。我知道如何修改 Reporting Services 样式表，但是否也可以将自定义 CSS 类应用于项目，因为它们呈现给浏览器？

Reporting Services 是否支持可用于以不同方式完成类似功能的任何类型的视觉继承？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T15:32:27.797

取自[ASP.NET 论坛](http://forums.asp.net/t/961072.aspx)

> Microsoft 提供了一个名为 ReportingServices.css 的样式表，供 SQL Server Reporting Services 使用。对于我的本地工作站安装，此样式表位于 c:\Program Files\Microsoft SQL Server\MSSQL.2\Reporting Services\ReportManager\Styles 文件夹中。该样式表中预定义了不同 html 元素引用的类。您可以通过编辑此样式表来设置报表的样式。
> 
> 报告的 html 中没有指向此样式表的链接。但是，在为每个报告呈现的 html 中有一个内联样式部分。我相信微软根据 ReportingServices.css 的内容创建了内联样式部分。这样做（而不是允许您在自己的样式表中链接）允许报表呈现引擎拥有控制分页符、列换行和其他格式问题所需的知识。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-05T18:04:18.277

SqlCentral.com 上有一些文章展示了如何以不同的（和集中的）方式应用样式：

[http://www.sqlservercentral.com/articles/Reporting+Services/65853/](http://www.sqlservercentral.com/articles/Reporting+Services/65853/) [http://www.sqlservercentral.com/articles/Reporting+Services/65811/](http://www.sqlservercentral.com/articles/Reporting+Services/65811/)

不支持视觉继承。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-04-12T14:56:35.890

请参阅[http://www.simple-talk.com/sql/reporting-services/reporting-services-with-style/](http://www.simple-talk.com/sql/reporting-services/reporting-services-with-style/)了解我认为更好的方法，并且易于实施，您甚至可以将数据源将您的样式转换为模板，因此开发构建报告仅使用该模板，并且它已经存在。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-02-17T17:03:28.047

来自“自定义 HTML 查看器和报告管理器的样式表”（[http://technet.microsoft.com/en-us/library/ms345247%28SQL.90%29.aspx](http://technet.microsoft.com/en-us/library/ms345247%28SQL.90%29.aspx)）

> 您可以使用 rc:StyleSheet URL 访问参数在报告 URL 上指定自定义样式表。
> 
> [http://localhost/reportserver?/AdventureWorksSampleReports/Product+Line+Sales&rs:Command=Render&rc:Stylesheet=MyStyleSheet](http://localhost/reportserver?/AdventureWorksSampleReports/Product+Line+Sales&rs:Command=Render&rc:Stylesheet=MyStyleSheet)

# ruby-on-rails - 中间件对 Twitter 和 Scala 意味着什么？

> ID：945386
> 
> 赞同：4
> 
> 时间：2009-06-03T15:21:58.050
> 
> 标签：ruby-on-rails, ruby, architecture, scala, twitter

参考我遇到的[另一个 SO 问题](https://stackoverflow.com/questions/936461/what-does-it-mean-to-say-that-a-framework-scales-well/936488#936488)，我收到[了这篇](http://www.theregister.co.uk/2009/04/01/twitter_on_scala/)关于 Twitter 从 Rails 迁移到 Scala 的文章，文章中有这样的评论：

> 佩恩说，到今年年底，Twitter 希望将其整个中间件基础设施及其 API 移植到新语言。Ruby 将保留，但仅限于前端。“我们仍然对 Rails 构建面向用户的功能感到满意……在性能方面，它对人们点击网页来说很好。这是我们已经摆脱的繁重的异步处理类型的东西。”

中间件在这里是什么意思？在前端使用 Ruby 到底意味着什么？这是否意味着前端的导轨很少使用 ORM？它如何与 scala“相遇”？这个评论是什么意思？

只是想了解架构。谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-03T15:32:13.850

它是[N-Tier Architecture](http://en.wikipedia.org/wiki/Multitier_architecture)的一种形式。最初，大多数站点将作为 2 层架构开始，具有 Web 服务器和数据库。网络服务器将提供用户看到的页面，而数据库由这些动态页面访问。

当一个架构被分成多层时，通常，你会在前面有一个 Web 应用程序，以及 Web 应用程序将调用的某种应用程序服务器。此应用程序服务器包含业务逻辑并使应用程序正常运行。应用程序的“面孔”只是让事物看起来很漂亮，并对其进行格式化以显示给用户。

应用程序服务器或“中间件”只是 Web 服务器可以调用的函数的集合。对于像 twitter 这样的网站来说，中间件必须是强大的，其中大部分活动都在发送消息，访问该网站的人没有那么多活动。

层之间的互连可能是一种标准的 Web 服务技术，但它可能是一种自定义的东西，可能是 REST 或其他类型的 Web 服务，Web 应用程序（Ruby on Rails）可以在其中访问应用程序数据。

在这种类型的架构中，Rails 无疑将所有 ORM 和数据管理都交给了中间件。

中间件也是一个模糊的术语，可以由许多层组成，因此他们称之为 N 层。我敢打赌，Twitter 的中间件有一个不同的部分专门用于消息传递，而另一部分则用于管理帐户、获取消息等。

这个想法是能够通过添加硬件来向上扩展，你可以让一个服务器集群提供网页服务，另一个集群处理消息传递，然后是一个支持所有这些的数据库服务器集群。这不是一门精确的科学，每种架构都是不同的，但总的来说，这是可以想到的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T15:43:29.370

尝试用谷歌搜索“ [ruby twitter scala payne](http://www.google.com/search?q=ruby+twitter+scala+payne) ”，你会得到比你可能需要的更多的东西。

我（可能不完整）的理解是，大部分 Twitter“后端”的编码都不是特别好（请参阅[Obie Fernandez 的帖子](http://blog.obiefernandez.com/content/2009/04/my-reasoned-response-about-scala-at-twitter.html)，其中挑选了一些 Alex Payne 的名言）。这似乎至少部分源于该应用程序最初的快速破解性质，该性质已被事件所取代，随着该应用程序的使用开始呈指数增长，他们正在经历相当大的痛苦。当时有很多人指责 Twitter（以及关联的 Rails）“未能扩展”。

Twitter 严重依赖消息队列，据我了解，这部分是用 Scala 编写的，这可能是（没有个人经验）工作的一个非常好的语言选择。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T22:04:49.577

我的理解是，他们迁移到 Scala 的是消息“队列”：从 Ruby-ORM-DB 支持的解决方案到使用 Scala 的分布式消息传递系统。具有 Twitter 量的服务有特殊要求，他们创建了自己的消息解决方案。被称为“红隼”

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-06-03T15:27:16.107

在这种情况下，消息传递基础设施。他们可能从一些基于 ruby​​ 的自定义解决方案切换到了 JMS 解决方案。

# cocoa - 用于多个 NSViewController 的 NS(Array|Tree)Controller 架构

> ID：945398
> 
> 赞同：5
> 
> 时间：2009-06-03T15:26:40.960
> 
> 标签：cocoa, architecture

我有一个非基于文档的核心数据应用程序。有一个管理作为源列表`NSTreeController`显示在单个对象中的对象集合。`NSOutlineView`它们是常见的东西：标题、文件夹、智能文件夹等。

这些容器对象中的每一个都有一个`contents`对象集合。我有三个独立的视图控制器，它们以不同的方式显示这些对象（`NSTableView`如果你真的想知道，一个和两个自定义图形视图）但这些实际上只是相同数据的三个不同表示。它们应该始终显示相同的对象、共享相同的选择等。

我还使用`NSViewController`s 的层次结构来管理我的视图。（如果我当时知道 Cathy Shive 的出色表现[`KTUIKit`](http://katidev.com/blog/ktuikit/)，我会使用它，但我的视图控制器与她的非常相似——并且非常受她的启发）

就目前而言，我`NSTreeController`在源列表视图的视图控制器中生活。我`NSArrayController`在每个子视图控制器中也有一个`NSTreeController`通过一些过于复杂的键路径绑定到的子视图控制器。

所以，在我看来，需要改变的是以下几点：

*   `NSTreeController`需要移出大纲视图的控制器。
*   每个内容视图都应该`NSArrayController`绑定一个，而不是三个单独的视图。虽然我不太确定这一点。

我遇到的困难是弄清楚这些东西应该放在*哪里。*我很难决定哪些对象（如果有的话）真正“拥有”各种控制器。父视图控制器是否拥有它？有窗口控制器吗？由于这是应用程序级别的数据，我是否应该将这些数据归 App Delegate 拥有？（我可以想象一个用户可能想要打开多个窗口的情况，尽管目前不支持） StackOverflow 蜂巢思维是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T16:40:15.697

NSArrayController 和 NSTreeController 被更多地视为视图对象而不是真正的控制器，所以听起来你在正确的轨道上。我会以与您相同的方式开始，根据需要为每个 NSViewController 提供其自己的 NSArrayController 或 NSTreeController，并在运行时通过负责将所有部分组合在一起的窗口控制器配置它们之间的绑定。

如果您认为它会简化事情，那么将 NSArrayController 和 NSTreeController 对象移动到窗口控制器听起来并没有什么问题。您仍然可以在 IB 中设置与视图控制器的表示对象的绑定，然后在适当的时间在窗口控制器中的代码中创建数组/树控制器。请注意不要在这里变得太复杂。我发现当你在同一个窗口中有很多视图控制器使用代表对象来处理不同的事情时，创建单独的类型化属性会更容易，这样你就可以了解哪些部分去了哪里。

我不太了解将数组/树控制器作为应用程序委托的一部分的好处，但我不太了解您在那里做什么。也许您会从制作自己的“数据控制器”对象中受益？

像这样的问题可能很难决定，因为有时没有“正确”的答案，但只要你牢记简单性和可理解性，你就可以了。不要害怕选择一个计划并继续前进，你总是可以稍后重构......我知道我曾经花费数天时间来解决这样的架构问题，而我本来可以做一些更实际的事情！

# xml - SoapUI 在模拟服务脚本中获取请求参数

> ID：945403
> 
> 赞同：25
> 
> 时间：2009-06-03T15:27:32.097
> 
> 标签：xml, web-services, groovy, soapui

对于所有 SoapUI 常客来说，这可能是一件非常容易的事情。

在 SoapUI 模拟服务响应脚本中，如何提取我正在回复的请求中的值？

假设传入的请求有

```
<ns1:foo>
  <ns3:data>
    <ns3:CustomerNumber>1234</ns3:CustomerNumber>
  </ns3:data>
</ns1:foo> 
```

如何将“1234”放入 Groovy 变量？我尝试使用 xmlHolder，但我似乎有错误的 XPath。

（我已经知道如何设置属性并将其值集成到响应中。）

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-06-16T10:14:03.477

如果您想访问 SOAP 请求并进行一些 XPath 处理，由于[GPath](http://groovy.codehaus.org/GPath)和[XmlSlurper](http://groovy.codehaus.org/api/groovy/util/XmlSlurper.html)的强大功能，soapUI 中有一种更简单的方法可以做到这一点。

以下是访问客户编号的方法：

```
def req = new XmlSlurper().parseText(mockRequest.requestContent)
log.info "Customer #${req.foo.data.CustomerNumber}" 
```

从 Groovy 1.6.3（在soapUI 2.5 及更高版本中使用）开始，XmlSlurper 默认在命名空间感知和非验证模式下运行，因此您无需执行任何其他操作。

干杯!
松兹拉

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-07-17T07:29:18.370

再举一个例子：

```
def request = new XmlSlurper().parseText(mockRequest.requestContent)
def a = request.Body.Add.x.toDouble()
def b = request.Body.Add.y.toDouble()
context.result = a + b 
```

在此示例中，我们从请求中获取两个参数并将它们转换为双精度值。这样我们就可以对参数进行计算。此示例的示例 SoapUI 响应是：

```
<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://example.org/math/types/">
   <soapenv:Header/>
   <soapenv:Body>
      <typ:AddResponse>
         <result>${result}</result>
      </typ:AddResponse>
   </soapenv:Body>
</soapenv:Envelope> 
```

您可以看到计算结果是如何传递回响应的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-14T19:43:03.473

在纯 Java（不使用 SoapUI）中，您只需创建一个自定义命名上下文，如下所示：

```
import java.util.Iterator;
import java.util.List;

import javax.xml.XMLConstants;
import javax.xml.namespace.NamespaceContext;

class WSNamespaceContext implements NamespaceContext
{
    public String getNamespaceURI(String prefix)
    {
        if ( prefix.equals("ns3") )
            return "http://www.mysite.com/services/taxservice";
       else if (prefix.equals("soapenv"))
            return "http://schemas.xmlsoap.org/soap/envelope/";
        else
            return XMLConstants.NULL_NS_URI;
    }

    public String getPrefix(String namespace)
    {
        if ( namespace.equals("http://www.mysite.com/services/taxservice") )
            return "ns3";
        else if (namespace.equals("http://schemas.xmlsoap.org/soap/envelope/"))
            return "soapenv";
        else
            return null;
    }

    public Iterator<List<String>> getPrefixes(String namespace)
    {
        return null;
    }
} 
```

然后，像这样解析它：

```
XPathFactory factory = XPathFactory.newInstance(); 
XPath xp = factory.newXPath(); 
xp.setNamespaceContext( nsc ); 
XPathExpression xpexpr = xp.compile("//ns3:CustomerNumber/text()");
NodeList nodes = (NodeList)xpexpr.evaluate(doc, XPathConstants.NODESET); 
for ( int i = 0; i < nodes.getLength(); i++ )  { 
    String val = nodes.item(i).getNodeValue();
    System.out.println( "Value: " + val  ); 
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-01-13T12:16:32.463

扩展[http://www.soapui.org/soap-mocking/creating-dynamic-mockservices.html](http://www.soapui.org/soap-mocking/creating-dynamic-mockservices.html)并基于[http://www.soapui.org/apidocs/com/eviware/soapui/support/xmlholder.html](http://www.soapui.org/apidocs/com/eviware/soapui/support/xmlholder.html)我来了有了这个：

```
// Create XmlHolder for request content
def holder = new com.eviware.soapui.support.XmlHolder( mockRequest.requestContent )
holder.namespaces["ns3"] = "ns3"

// Get arguments
def custNo = holder.getNodeValue("//ns3:CustomerNumber")
context.setProperty("custNo", custNo) 
```

# xpath - 尊重节点位置和属性值的 XPath 查询

> ID：945408
> 
> 赞同：0
> 
> 时间：2009-06-03T15:28:49.363
> 
> 标签：xpath, xpathdocument

有没有办法构建一个 XPath 查询，在某个位置找到一个节点并且具有某个属性值？

考虑以下示例 xml：

```
<Item Type="Book">
<!--1st Param node in a Book item is always the autors last name-->
<Param Value="Updike" />
<!--2nd Param node in a Book item is always the autors first name-->
<Param Value="John" />
<!--3rd Param node in a Book item is always the book title-->
<Param Value="Toward the End of Time" /></Item> 
```

现在我可以构建一个查找以下内容的查询：

查找*类型为“Book”的所有**Item*节点，其中 2nd *Param*节点的*值为*“John”。所以我想找到所有作者名字是“约翰”的书。

 ***请注意，我使用的是 .NET XPathDocument。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-03T16:23:26.013

仅具有书籍的项目的要求如何？

试试这个：

```
/Item[@Type='Book'][Param[2][@Value='John']] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T15:30:35.053

> 请注意，我使用的是 .NET XPathDocument。

所以仅限于 XPath V1。

您可以在谓词中包含（相对和绝对）路径。所以像：

```
//Item[@Type='Book'][./Param[2][@Value = 'John']] 
```

（我会尽量避免“ `//`”，因为它需要搜索整个 DOM，但如果没有更多上下文就无法提供更好的轴。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T15:34:01.427

表达式将是：

```
//Item/Param[2][@Value='John'] 
```

# java - 检查一个点是否存在于包含 4 个顶点的给定区域中

> ID：945415
> 
> 赞同：5
> 
> 时间：2009-06-03T15:30:37.800
> 
> 标签：java, geometry

参考[http://www.weather.gov/directives/sym/pd01008006curr.pdf](http://www.weather.gov/directives/sym/pd01008006curr.pdf)，第8页，我们在地理坐标系（纬度和经度系统）中给出了一个具有四个顶点的区域。我想检查该区域内是否存在具有特定纬度和经度的点。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-03T15:52:39.187

测试一个点是否在任意多边形内（任意数量的边，也允许凹面）的方法是选择一个你知道在多边形外的点；如果您正在测试的点和多边形外的点之间的线段与多边形段的奇数相交，则该点在多边形内。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-03T16:05:07.473

这是具有坐标系的球体上[的多边形点](http://en.wikipedia.org/wiki/Point_in_polygon)问题，它有几个细微之处使其比 XY 平面中的“常规”多边形点问题更难：

1) 里面和外面是什么？（例如，如果我有一个边长为 1 英里的小“正方形”，它是包围 1 平方英里还是地球表面的其余部分？这是一个简单的例子，但对于非常大的多边形，可能不清楚哪个应该在里面并且应该在外面，除非明确指定）

2）多边形的线段是大圆线段吗？如果是这样，那么它们不代表经纬坐标系中的直线，除非它们是子午线或赤道 - 您需要处理曲线而不是几何图形中的直线。球面几何是要走的路。

3）坐标系的“边”（国际日期变更线和两极）——由经度+179.9度、-179.9度和纬度+0.1度、-0.1度界定的“正方形”通常不会被认为包含点 0 N, 0 W, 并被认为包含点 0 N, 180 W。但是如果你天真地检查经纬度点的不等式，你会得到相反的答案。

所以我没有答案，但这些都是需要考虑的微妙问题。（将其读作“确保将它们包含为测试用例”！）

**编辑：**我找到了具有[SphericalPolygon.contains方法的](https://web.archive.org/web/20130520194642/http://geospatialmethods.org/spheres/nsidc/spheres/SphericalPolygon.html#contains(nsidc.spheres.Point))[spheres](https://web.archive.org/web/20140622234456/http://geospatialmethods.org/spheres/)包，它可以满足您的需求。但是我没有亲自使用过这个包，它是[GPL](http://www.gnu.org/copyleft/gpl.html)，而不是 LGPL，所以如果你想在专有产品中使用它，它会“污染”你的源代码的其余部分。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T15:42:41.053

你的意思是编程还是数学？如果您在数学上理解它，那么以编程方式很容易。基本上，顶点定义线。您只需要知道线条的哪一侧构成“内部”。然后，将您的顶点转换为方程式，但使用小于或大于而不是等于。

Id est，假设您具有由以下等式定义的矩形：x=1, x=3, y=1, y=3

如果您想知道 (2,2) 是否在该区域内，只需评估每个方程：x > 1, x < 3, y > 1, y < 3。

如果所有四个都为真，则该点位于该区域内。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-06-03T15:37:04.767

很简单：

[http://pietschsoft.com/post/2008/07/Virtual-Earth-Polygon-Search-Is-Point-Within-Polygon.aspx](http://pietschsoft.com/post/2008/07/Virtual-Earth-Polygon-Search-Is-Point-Within-Polygon.aspx)

# email - 如何在某些新闻组中不使用 Gnus 自适应评分？

> ID：945419
> 
> 赞同：1
> 
> 时间：2009-06-03T15:31:25.303
> 
> 标签：email, emacs

如果我做：

```
(setq gnus-use-adaptive-scoring t) 
```

自适应评分正常工作，但适用于所有组。

然后我尝试了这个，但没有成功：

```
(setq gnus-parameters
  '(("mail\\..*"
     (gnus-use-adaptive-scoring nil))
    ("gmane\\..*"
     (gnus-use-adaptive-scoring t)))) 
```

谁能帮我这个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-10-29T21:02:50.373

您可以尝试将`(adapt nil)`不希望激活自适应评分的所有组的分数文件放入其中，并且您可以使用主题为一堆组设置一个通用的分数文件，如此处[所述](http://www.emacswiki.org/emacs/ScoreFile#toc3)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T16:02:44.010

好吧，它似乎对我有用。我使用了这个设置：

```
(setq gnus-parameters 
  '(("regressions.*"
     (gnus-use-adaptive-scoring nil))
    ("general-personal.*"
     (gnus-use-adaptive-scoring t)))) 
```

也许您的正则表达式与您的组名不匹配？上面的正则表达式将匹配看起来像`mail.`和的组`gmane.`（`.`是一个真实的时期）。

我测试它的方法是输入两组中的每一个并对变量进行评估`M-: gnus-use-adaptive-scoring RET`- 尽管您也可以只对变量进行帮助`C-h v gnus-use-adaptive-scoring RET`。

也许您想要的不是关闭**自适应**评分，而只是关闭评分。AFAIK，自适应评分是 Gnus 试图*计算文章的* *评分*，而不是评分的实际**用途**。

所以也许这就是你想要的？

```
(setq gnus-parameters 
  '(("mail\\..*"
     (gnus-use-scoring nil))
    ("gmane\\..*"
     (gnus-use-scoring t)))) 
```

# iphone - 小视频播放

> ID：945421
> 
> 赞同：2
> 
> 时间：2009-06-03T15:31:37.173
> 
> 标签：iphone, objective-c, mpmovieplayercontroller

根据我从互联网上收集的信息，MPMoviePlayerController 类不支持小视频播放。所以，为了打败一匹死马，我想知道什么样的方法可以让一个小视频在屏幕的一角播放而不会打断屏幕的其余部分。

到目前为止，我们遇到了两种可行的解决方案：使用 UIImageView 并像疯子一样通过它翻转图像，以及使用带有我们需要的所有动画的大型全屏视频，并根据需要跳过。

关于 MPMoviePlayerController 不支持非全屏视频，我错了吗？他们是比制作 UIImageView 翻书更简单的解决方案吗？剪辑视频是否会造成性能危害？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-09-18T14:21:40.853

我认为你被翻书困住了。很确定全屏视频问题是硬件视频解码器的限制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-17T19:55:45.017

研究了大约1小时后，我没有发现任何东西。在 iPhone 上播放非全屏视频似乎是不可能的。我没有检查openGL ES。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-03T10:31:07.243

好吧..我一直在寻找，但还没有找到替代品！

但是有一些应用程序已经做到了！从[TVUNetworks](http://www.tvunetworks.com/)检查[TVUlite](http://itunes.apple.com/WebObjects/MZStore.woa/wa/viewSoftware?id=323640984&mt=8)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-02-28T14:39:47.947

正如我在另一个回复中提到的，这篇博文[http://www.nightirion.com/2010/01/scaling-a-movie-on-the-iphone/](http://www.nightirion.com/2010/01/scaling-a-movie-on-the-iphone/)提到了一种允许您播放非全屏视频的方法。但是，我不确定此方法是否会被应用商店验证流程批准。

# installation - 已安装软件包时的 msiexec 静默安装

> ID：945425
> 
> 赞同：5
> 
> 时间：2009-06-03T15:32:18.013
> 
> 标签：installation, windows-installer

我有以下有问题的情况：

**有问题的场景描述开始---------------**

我使用 msiexec 通过以下方式以安静模式安装包：

```
msiexec /i c:\mypackage.msi /quiet 
```

现在我已经安装了软件包。假设我再次输入了上面的命令：

```
msiexec /i c:\mypackage.msi /quiet 
```

**问题场景描述结束---------------**

现在由于软件包已经安装，安装应该会失败。但我没有任何迹象表明这一点。

我使用 log 选项来获取日志：

```
msiexec /i c:\mypackage.msi /quiet /l* log.txt 
```

当发生错误时，我确实会在日志中看到它们，但在上面描述的场景中，日志是空的。系统事件日志中也没有写入任何内容。所以我的问题是，我怎样才能得到安装（第二个）没有成功的迹象？

**笔记：**

我不愿意通过编写一个批处理脚本来解决这个问题，该脚本将在调用 msiexec 之前检查包是否已安装。原因是它与我们客户的部署要求相矛盾。

我有一个 DLL 自定义操作数据，在第二次中，DLL 没有被激活，所以我不能使用 DLL 来在某处写入失败。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2011-08-03T02:30:07.183

如果软件包已经安装，安装不会失败，它是“成功重新配置”

为了检查系统上是否安装了 Windows Installer 程序包，您最好使用 Windows SDK（不是批处理文件） - 这是一个示例脚本，它迭代已安装产品的列表并触发 MSIEXEC（如果是）尚未安装。（此示例按名称搜索，或者您可以按包代码搜索）

```
Option Explicit

Dim productName:productName = "My Awesome Product"

Dim installer : Set installer = Nothing
Set installer = Wscript.CreateObject("WindowsInstaller.Installer")

Dim productCode, property, value, message

For Each productCode In installer.Products
    If InStr(1, LCase(installer.ProductInfo(productCode, "ProductName")), LCase(productName)) Then Exit For
Next

If IsEmpty(productCode) Then 
    Dim WshShell, oExec
    Set WshShell = CreateObject("WScript.Shell")
    WshShell.Exec("msiexec /i mypackage.msi /qb")
Else
    Wscript.Echo productName & " is already installed."
    Wscript.Quit 2
End If 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T15:57:55.537

是你的包裹吗？如果是这样，请设置一个先决条件，检查某个密钥文件或注册表项是否尚不存在。

如果它不是您的软件包，请将其包装在可以进行检查的东西（另一个安装程序或 exe）中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T08:53:34.357

我知道这是旧线程，但谷歌点击了这个并为了其他人的利益尝试这个

```
start /wait msiexec /i c:\mypackage.msi /quiet 
```

如果错误，`echo %errorlevel%`将非零。如果以编程方式调用上述使用`GetLastError()`

# c# - C# WPF IsEnabled 使用多个绑定？

> ID：945427
> 
> 赞同：51
> 
> 时间：2009-06-03T15:32:38.653
> 
> 标签：c#, wpf, binding, combobox, isenabled

我有一个描述 GUI 一部分的 WPF xaml 文件，我希望特定控件的启用/禁用依赖于其他两个控件。代码现在看起来像这样：

```
<ComboBox Name="MyComboBox"
          IsEnabled="{Binding ElementName=SomeCheckBox, Path=IsChecked}"/> 
```

但我希望它也依赖于另一个复选框，例如：

```
<ComboBox Name="MyComboBox"
          IsEnabled="{Binding ElementName=SomeCheckBox&AnotherCheckbox, Path=IsChecked}"/> 
```

最好的方法是什么？我不禁觉得我遗漏了一些明显的东西或以错误的方式解决这个问题？

* * *

## 回答 #1

> 赞同：90
> 
> 时间：2013-10-06T14:40:08.123

您可以将 a[`MultiBinding`](http://msdn.microsoft.com/en-us/library/system.windows.data.multibinding(v=vs.110).aspx)与实现[`IMultiValueConverter`](http://msdn.microsoft.com/en-us/library/system.windows.data.imultivalueconverter(v=vs.110).aspx).

只是为了给出答案，您可以（几乎）复制和粘贴：

需要的静态资源：

```
<converterNamespace:BooleanAndConverter x:Key="booleanAndConverter" /> 
```

组合框：

```
<ComboBox Name="MyComboBox">
  <ComboBox.IsEnabled>
    <MultiBinding Converter="{StaticResource booleanAndConverter}">
      <Binding ElementName="SomeCheckBox" Path="IsChecked" />
      <Binding ElementName="AnotherCheckbox" Path="IsChecked"  />
    </MultiBinding>
  </ComboBox.IsEnabled>
</ComboBox> 
```

转换器的代码：

```
namespace ConverterNamespace
{
    public class BooleanAndConverter : IMultiValueConverter
    {
        public object Convert(object[] values, Type targetType, object parameter, System.Globalization.CultureInfo culture)
        {
            foreach (object value in values)
            {
                if ((value is bool) && (bool)value == false)
                {
                    return false;
                }
            }
            return true;
        }
        public object[] ConvertBack(object value, Type[] targetTypes, object parameter, System.Globalization.CultureInfo culture)
        {
            throw new NotSupportedException("BooleanAndConverter is a OneWay converter.");
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2016-07-12T20:20:27.440

您也可以尝试相同的较短版本：

```
public class BooleanAndConverter : IMultiValueConverter
{
    public object Convert(object[] values, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
        return values.OfType<IConvertible>().All(System.Convert.ToBoolean);
    }

    public object[] ConvertBack(object value, Type[] targetTypes, object parameter, System.Globalization.CultureInfo culture)
    {
        throw new NotSupportedException();
    }
}

public class BooleanOrConverter : IMultiValueConverter
{
    public object Convert(object[] values, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
        return values.OfType<IConvertible>().Any(System.Convert.ToBoolean);
    }

    public object[] ConvertBack(object value, Type[] targetTypes, object parameter, System.Globalization.CultureInfo culture)
    {
        throw new NotSupportedException();
    }
} 
```

当然，您可能还需要转换器来提高可见性：

```
public class BooleanOrToVisibilityConverter : IMultiValueConverter
{
    public Visibility HiddenVisibility { get; set; }

    public bool IsInverted { get; set; }

    public BooleanOrToVisibilityConverter()
    {
        HiddenVisibility = Visibility.Collapsed;
        IsInverted = false;
    }

    public object Convert(object[] values, Type targetType, object parameter, CultureInfo culture)
    {
        bool flag = values.OfType<IConvertible>().Any(System.Convert.ToBoolean);
        if (IsInverted) flag = !flag;
        return flag ? Visibility.Visible : HiddenVisibility;
    }

    public object[] ConvertBack(object value, Type[] targetTypes, object parameter, CultureInfo culture)
    {
        throw new NotImplementedException();
    }
}

public class BooleanAndToVisibilityConverter : IMultiValueConverter
{
    public Visibility HiddenVisibility { get; set; }

    public bool IsInverted { get; set; }

    public BooleanAndToVisibilityConverter()
    {
        HiddenVisibility = Visibility.Collapsed;
        IsInverted = false;
    }

    public object Convert(object[] values, Type targetType, object parameter, CultureInfo culture)
    {
        bool flag = values.OfType<IConvertible>().All(System.Convert.ToBoolean);
        if (IsInverted) flag = !flag;
        return flag ? Visibility.Visible : HiddenVisibility;
    }

    public object[] ConvertBack(object value, Type[] targetTypes, object parameter, CultureInfo culture)
    {
        throw new NotImplementedException();
    }
} 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-06-03T15:36:21.990

我相信您可能必须将 MultiBinding 与 MultiValueConverter 一起使用。见这里： http: [//www.developingfor.net/wpf/multibinding-in-wpf.html](http://www.developingfor.net/wpf/multibinding-in-wpf.html)

这是一个直接相关的示例：[http ://social.msdn.microsoft.com/Forums/en-US/wpf/thread/5b9cd042-cacb-4aaa-9e17-2d615c44ee22](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/5b9cd042-cacb-4aaa-9e17-2d615c44ee22)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-08-15T08:29:26.627

作为 qqbenq 答案的扩展：

添加了处理`Count`集合的功能，例如，如果您想检查是否选择了某个项目`ListView`。

**转换器：**

```
public class IsEnabledConverter : IMultiValueConverter
{
    public object Convert(object[] values, Type targetType, object parameter, CultureInfo culture)
    {
        foreach (var value in values)
        {
            switch (value)
            {
                case bool b when !b:
                case int i when i == 0:
                    return false;
            }
        }

        return true;
    }

    public object[] ConvertBack(object value, Type[] targetTypes, object parameter, CultureInfo culture)
    {
        return null;
    }
} 
```

**命名空间** `<theNamespace:IsEnabledConverter x:Key="IsEnabledConverter"/>`

**按钮**

```
<Button x:Name="MyButton">
    <Button.IsEnabled>
        <MultiBinding Converter="{StaticResource IsEnabledConverter}">
            <Binding ElementName="MyListView" Path="SelectedItems.Count"/>
            <Binding ElementName="MyCheckBox" Path="IsChecked"/>
        </MultiBinding>
    </Button.IsEnabled>
</Button> 
```

# css - 如何做一个 Chrome/Opera 特定的样式表？

> ID：945428
> 
> 赞同：23
> 
> 时间：2009-06-03T15:32:39.653
> 
> 标签：css, google-chrome, opera, specific-stylesheets

我需要做**chrome/opera** hack，因为客户端想要的字体替换脚本会破坏事情......这很可悲，但一切都在 IE6-7、FF2-3 和 Safari 中运行。我无法修复脚本本身，我只能使用 CSS 和 HTML 破解它。

我正在尝试做一些事情：

```
<!--[if IE 6]>
   <link rel="stylesheet" href="ie6.css" type="text/css" media="screen" />
<![endif]--> 
```

是否可以？

我看到了这种进行 chrome 特定修复的方式，例如：

```
body:nth-of-type(1) .elementOrClassName
{
/* properties go here */
} 
```

这管用吗？有没有更简单的方法？**歌剧呢？**

谢谢！

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-06-03T19:13:28.377

一种干净的 JavaScript 方法：[http ://rafael.adm.br/css_browser_selector/](http://rafael.adm.br/css_browser_selector/)

它将浏览器特定的类广告到您的 html 的 body 标签中，您可以在您的 css 中使用，例如：

```
.opera #thingie, .chrome #thingie {
  do: this;
} 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2011-08-22T08:36:30.340

避免 CSS hack。它们会破裂。

谷歌浏览器：

```
@media not all and (-webkit-min-device-pixel-ratio:0)
{  
    #example
    {
        width: 200px;
    }
} 
```

苹果浏览器：

```
@media screen and (-webkit-min-device-pixel-ratio:0)
{
    #example
    {
        width: 200px;
    }
} 
```

歌剧：

```
@media not screen and (1)
{
    #example
    {
        width: 200px;
    }
} 
```

[让 CSS 仅适用于 Opera 11？](https://stackoverflow.com/questions/4647992/how-to-make-css-visible-only-for-opera-11-opera-11-css-hack)

[如何使 CSS 仅对 Opera 可见](https://stackoverflow.com/questions/1120335/how-to-make-css-visible-only-for-opera)

[面向未来的 LTE Opera 10 的 CSS hack](https://stackoverflow.com/questions/2243522/future-proof-css-hack-for-lte-opera-10)

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2011-10-01T12:43:20.633

对于 Google（和 Safari），您可以简单地使用以下内容；

```
<link rel="stylesheet" href="style-sheet_chrome.css" type="text/chrome/safari" /> 
```

这将加载一个 webkit 特定的样式表。“类型”可以任意命名，但必须包含在内。

您只需按照自己的意愿继续创建样式表，所有非 webkit 浏览器都会忽略它。

您必须对 Opera 使用上述技巧。以下对我最有效：

```
@media not screen and (1)
    {
    #example
    {
    width: 200px;
    }
} 
```

我用它来加载特定于浏览器的@font-face 声明。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-03T15:54:17.703

我还没有测试过这个解决方案，但是根据[这个博客条目](http://davidwalsh.name/detecting-google-chrome-javascript)，你可以为 Chrome 尝试以下操作：

```
if (navigator.userAgent.toLowerCase().indexOf('chrome') > -1)
{
     var chromeCss = document.createElement("link");

     chromeCss.rel = "stylesheet";
     chromeCss.href = "ChromeStyle.css";

     document.getElementsByTagName("head")[0].appendChild(chromeCss);
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-06-28T07:13:16.930

.ie - Internet Explorer（所有版本）
.ie10 - Internet Explorer 10.x
.ie9 - Internet Explorer 9.x
.ie8 - Internet Explorer 8.x
.ie7 - Internet Explorer 7.x
.ie6 - Internet Explorer
6.x。 ie5 - Internet Explorer 5.x
.gecko - Firefox（所有版本）、Camino、SeaMonkey
.ffxx - Firefox xx（用特定版本号更改 xx） new
.ff4 - Firefox 4.x
.ff3 - Firefox 3.x
.ff2 - Firefox 2.x
.opera - Opera（所有版本）
.opera12 - Opera 12.x
.opera11 - Opera 11.x
.opera10 - Opera 10.x
.opera9 - Opera 9.x
.opera8 - Opera 8.x
.konqueror - 征服者
.webkit - Safari、NetNewsWire、OmniWeb、Shiira、Google Chrome
.chrome - Google Chrome（所有版本）
.chromexx - Chrome xx（将 xx 更改为特定版本的数量）新
.safari - Safari（所有版本）新
.iron - SRWare铁

.[操作系统代码].[浏览器代码] .yourclass { padding-left:5px; font-size:14px }

body { background-color:#000 }
.ie8 body {background-color:#111 }（特定于 Internet Explorer 8.x）
.win.ie8 body { background-color:#222 }（特定对于 Internet Explorer 8.x，在 Microsoft Windows 所有版本上）
.opera body { background-color:#333 }（Opera 所有版本）
.ff15 body { background-color:#444 }（特定于 Firefox 15.x）
.linux .gecko body { background-color:#555 }（Firefox、Camino、SeaMonkey 所有版本，在 x11 和 Linux 上）

.ie7 #right, .ie7 #left { width:320px }

有关更多信息，请访问此链接 [http://cssbs.altervista.org/](http://cssbs.altervista.org/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-02-19T10:18:41.070

请记住：“用户代理嗅探是 baaaddd”

那不是，也永远不会是一个好习惯。

维护一个实施了用户代理嗅探的网站简直是一件痛苦的事。

如果它们数量很少或者您没有时间制作多个样式表，您应该更喜欢单独的样式表或 css hack。

对于 Opera，你可以使用这个技巧：

```
@media all and (-webkit-min-device-pixel-ratio:10000),
    not all and (-webkit-min-device-pixel-ratio:0) { 
     #id {
         css rule;
     }
 } 
```

可悲的是，每个 Chrome css hack 也适用于 Safari。

除了旧版本的 Safari（<= safari3，如果我没记错的话），没有办法将 2 个渲染分开

# asp.net-mvc - 在 ASP.NET MVC 中切换控制器时的延迟

> ID：945430
> 
> 赞同：1
> 
> 时间：2009-06-03T15:33:05.017
> 
> 标签：asp.net-mvc

在请求另一个控制器下的视图时，是否有其他人发现明显的延迟？

例如，同一个控制器下的所有操作似乎都快速响应，但是当我点击一个指向另一个控制器的链接时，就会出现延迟 - 几乎就像它在运行中编译一样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T21:24:09.957

嗯，ASP.NET 使用 JIT 编译。但是，如果这种滞后一直反复发生，则可能是另一个问题，因为一旦它第一次编译，它不应该立即重新编译。

# java - Jar from HTML

> ID：945435
> 
> 赞同：5
> 
> 时间：2009-06-03T15:33:36.560
> 
> 标签：java, jar, javadoc

A third party library I'm utilizing provided the JavaDoc HTML and associated bin files in a zip file. How can I create a jar file from the JavaDoc HTML?

Thanks.

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-03T15:35:09.680

A JAR file is nothing but a ZIP file with an (optional) manifest file inside.

Basically, rename the file to .JAR and that's it.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-09-25T06:22:04.037

JDK include jar.exe, for windows following path "%JAVA_HOME%/bin/jar.exe"

Supose you have folder

```
/somelib/
         packages.html
         ... other html 
```

Go to the somelib directory:

```
cd /somelib/
jar cvf somelib-3.0-javadoc.jar * 
```

After that in /somelib/ you can find somelib-3.0-javadoc.jar

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T15:35:06.683

Quick answer: You can take all the files in a ZIP and put it .jar extension

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-03T15:36:15.733

By zipping the files and renaming the compressed package .jar? ([JAR files](http://en.wikipedia.org/wiki/JAR_(file_format)#Overview) are basically just ZIP files.)

But why would you want to create a JAR out of the HTML files?

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-06-03T19:57:41.300

Of course you could just unzip the zip file and add the lib folder you just decompressed to your classpath.

# css - 哪些 CSS 框架适用于 SharePoint 发布网站？

> ID：945445
> 
> 赞同：4
> 
> 时间：2009-06-03T15:35:31.397
> 
> 标签：css, sharepoint, sharepoint-2007, css-frameworks, publishing-site

*过去，现在无关紧要的背景故事：*我试图对 BlueBand 进行一些更改并“快速启动并运行”，但在进一步查看后，由于以前的开发人员在布局中引入了表格，这不再是一种选择。我将不得不忍受这一点，并做出我能做的调整。

**因此，展望未来的绿地项目......**

对于与 SharePoint 发布网站完美配合的 CSS 框架是否有任何建议？（例如[BluePrint](http://www.blueprintcss.org/)、[YUI](http://developer.yahoo.com/yui/)。）它们不应干扰标准的开箱即用控件，例如站点操作菜单、富文本编辑器和发布工具栏。

欢迎现实世界的经验，拜托！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T19:49:29.960

Heather Solomon 有一个关于连接 SharePoint CSS 类的很棒的博客/指南 - 看看：

[http://www.heathersolomon.com/content/sp07cssreference.htm](http://www.heathersolomon.com/content/sp07cssreference.htm)

干杯，

亚当

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-24T06:18:34.473

您应该从[最小的 masterpage](http://msdn.microsoft.com/en-us/library/aa660698.aspx)开始。这将是连接到发布布局的母版页。然后，您可以将所需的所有 html/css 添加到母版页和布局中，以使它们看起来像您想要的任何东西。

如果浏览这些相同发布页面的用户也需要访问您的列表表单（新建、编辑、显示），您将必须编辑这些文件并将它们附加到您的母版页（通过 SP 设计器或功能自动完成） . 或者，将应用程序母版页自定义为与您的发布母版页几乎相同，并将[它们部署为](http://www.heathersolomon.com/blog/articles/servermstpageforsitecollect_feature.aspx)具有 HTTP 处理程序的功能，该处理程序在运行时更改 application.master 的母版页。

同样仅供参考，一旦您开始为匿名用户可访问的站点自定义列表表单页面，就会出现许多问题，因此如果需要，请先对该站点进行研究。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T18:15:09.430

你想用 CSS 框架做什么？据我所知，您可以使用一个来进行跨浏览器重置，但其他一切都取决于您的布局。如果您打算放弃标准的 SharePoint 布局，则意味着您需要从头开始。好消息是它与为任何其他网站创建布局没有太大区别。在使用 SharePoint 时，您需要一些东西 ( [http://msdn.microsoft.com/en-us/library/aa660698.aspx](http://msdn.microsoft.com/en-us/library/aa660698.aspx) )，但至于 CSS，这完全取决于您。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-02-04T00:55:54.500

我们已经成功使用了 960.gs。只需将它包含在您的母版页中，并用 - 包裹主要内容区域或使用 container_12/container_24。然后在您的个人页面布局中，您可以利用使 960 如此出色的所有列/推/拉/alpha/omega 好东西。这在 2007 年和 2010 年有效，只是在 2007 年需要做更多的工作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-04T00:47:11.340

尝试将蓝色乐队主题破解为无表格布局时会遇到很多麻烦。

[您可以从Sharepoint](https://aks.hisoftware.com/aks.aspx)的免费辅助工具包中获得一些好处。它带有布局页面、CSS 甚至控制适配器，供那些关心网站 HTML 的人使用。

尽管如此，摆脱 SharePoint 生成的表格并不真正兼容`"up and running pretty quickly"`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-11-18T16:15:42.420

在使用 Sharepoint 时，您可以使用您想要的任何框架，但是，主要关注的是您对 Web 部件的控制程度。OOB Web 部件使用基于表格的布局。如果您可以完全控制 Web 部件如何使用它们产生的标记，那么您离使用框架更近了一步。

为了减轻 Web 部件中使用的一些基于表格的布局，您可以查看辅助工具包以适当地转换 Web 部件。

# java - 用大量参数编译 GWT 代码——CreateProcess 的字符限制？

> ID：945446
> 
> 赞同：2
> 
> 时间：2009-06-03T15:35:36.637
> 
> 标签：java, gwt, ant, createprocess, character-limit

我正在尝试运行编译 GWT 的 ant 构建脚本。该脚本包含大量库，每个库都有相对较长的路径。我的 GWT 代码只涉及其中一些库；但是，将用于此目的的 lib 目录中的所有库以及我正在开发的所有其他应用程序包含在内是很方便的。这是我的构建脚本的相关部分：

```
<path id="gwt.project.class.path">
  <pathelement location="gen"/>
  <pathelement location="${gwt.sdk}/gwt-user.jar"/>
  <fileset dir="${gwt.sdk}" includes="gwt-dev*.jar"/>
  <fileset dir="${smartgwt.sdk}" includes="smartgwt*.jar"/>
  <!-- Add any additional non-server libs (such as JUnit) -->
  <fileset dir="lib" includes="**/*.jar"/>
</path>

<target name="gwtc" depends="compileApp" description="GWT compile to JavaScript" unless="noGWTModule">
<java failonerror="true" fork="true" classname="com.google.gwt.dev.Compiler">
  <classpath>
    <pathelement location="src"/>
    <path refid="gwt.project.class.path"/>
  </classpath>
  <!-- add jvmarg -Xss16M or similar if you see a StackOverflowError -->
  <jvmarg value="-Xmx256M"/>
  <!-- Additional arguments like -style PRETTY or -logLevel DEBUG -->
  <arg value="${gwt.module}"/>
  <arg value="-war" />
  <arg value="${gwt.gen.dir}" />
</java>
</target>` 
```

当我尝试运行它时，我收到以下错误：

```
java.io.IOException: CreateProcess: "C:\Program Files\Java\jdk1.5.0_11\jre\bin\java.exe" -Xmx256M -classpath "C:\Program Files\Common Files\eclipse\workspace\development\src;C:\Program Files\Common Files\eclipse\workspace\development\lib\build\hbBuildSupport.jar;C:\Program Files\Common Files\eclipse\workspace\development\lib\db\hibernate\ehcache.jar;C:\Program Files\Common Files\eclipse\workspace\development\lib\db\hibernate\hibernate-annotations.jar;C:\Program Files\Common Files\eclipse\workspace\development\lib\db\hibernate\hibernate-commons-annotations.jar;C:\Program Files\Common Files\eclipse\workspace\development\lib\db\hibernate\hibernate-entitymanager.jar;C:\Program Files\Common Files\eclipse\workspace\development\lib\db\hibernate\hibernate-tools.jar;C:\Program Files\Common Files\eclipse\workspace\development\lib\db\hibernate\hibernate-validator.jar;C:\Program Files\Common Files\eclipse\workspace\development\lib\db\hibernate\hibernate3.jar;C:\Program Files\Common Files\eclipse\workspace\development\lib\db\hibernate\javassiâ€� 
```

似乎在编译的某个时刻，包含所有库路径的字符串都被截断了。这可能是由于 CreateProcess 的某些字符限制造成的吗？这个 CreateProcess 命令字符串在截断之前只有大约 1024 个字符，这似乎是一个很小的限制。反正有没有增加这个限制？任何想法/解决方案/解决方法表示赞赏。

谢谢，马尤尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-24T22:33:03.017

问题是 Windows 命令行限制为 8191 个字符，而 GWT 将每个 jar 的完整路径放在类路径中。解决此问题的唯一方法是将 jar 移动到路径较短的目录中。

您可以在 Windows 下通过创建符号链接然后在构建文件中引用该链接来执行此操作。像这样的东西

从 c 的根：

```
mklink /D jars C:\Program Files\Common Files\eclipse\workspace\development\lib 
```

[Windows 符号链接上的维基百科条目](http://en.wikipedia.org/wiki/NTFS_symbolic_link)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-04T20:53:09.160

对于非常长的类路径，一种可能的解决方法是使用该`java.ext.dirs`属性并将所有编译时依赖项（现在在类路径中引用的 JAR 文件）放在此目录中。

# html - 如何在 HTML 表格中呈现树？

> ID：945460
> 
> 赞同：15
> 
> 时间：2009-06-03T15:37:55.313
> 
> 标签：html, layout, tree, html-table

我正在尝试在 HTML 表格中显示树结构。它基本上是您推荐的网站的人员列表，但您可以展开每个人并查看他们所推荐的人员（只有 2 或 3 个级别）。我还显示了每个人的许多信息，所以我使用了一个包含几列的表格。

我想知道显示此内容的最佳方式是什么，以便较低级别的人看起来“缩进”，但要避免数据内容与显示每个数字含义的标题之间的不匹配......

我主要是在这里寻找偷窃的想法:-) 你有没有看过或做过一个有这样东西的网站？

* * *

**编辑：**感谢您到目前为止的所有答案。

我想我没有正确解释我想要做什么。这是一份人员名单，但这份报告存在的原因是附在每个人身上的数字，而不是名单本身。
对于此“列表”中的每个人，我将在他们的右侧显示需要对齐的数据，例如，底部有“总计”等。

想象一下，如果你愿意的话，有 Windows 资源管理器，左边有树，所以你可以打开和关闭文件夹，但是，在每个文件夹的右边，你有数据，比如里面有多少文件，什么样的信息等等。就像您在 Windows 资源管理器的右侧窗格中找到“文件”（在详细信息视图中）一样，只是我为左侧的树执行此操作。（这不是我正在做的，但这是我能想到的最接近的类比）

这就是为什么我倾向于制作表格而不是列表的原因。如果这些只是人名或文件夹树，我完全同意嵌套 <ul> 是要走的路。在这种情况下，我的问题是我需要为每个项目显示的额外数据是整个报告中最重要的部分。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-03T19:11:06.947

我没有答案，但我为那些无法想象 OP 需求的人提供了一个说明。

树视图中的 Unix QPS（可视化进程管理器）显示了这样一个树/表。

Google 图片搜索会找到一些示例图片。

就个人而言，很想知道如何在浏览器中实现这一点。

编辑：添加了示例图像：

[![替代文字](https://i.stack.imgur.com/AwVhi.png)](https://i.stack.imgur.com/AwVhi.png)
[（来源：[nada.kth.se](http://www.student.nada.kth.se/~f91-men/qps/tree.png)）]

编辑：粗略实施

```
<!doctype html public "-//w3c//dtd xhtml 1.0 strict//en" "http://www.w3.org/tr/xhtml1/dtd/xhtml1-strict.dtd">
<html>
    <head>
        <style>
            .removed
            {
                display:none;
            }

            .expands
            {
                cursor:pointer; cursor:hand;
            }

            .child1 td:first-child
            {
                padding-left: 1em;
            }

            .child2 td:first-child
            {
                padding-left: 2em;
            }
        </style>
        <script>
            function toggle()
            {
                for(var i=0; i<arguments.length; i++)
                {
                    with(document.getElementById(arguments[i]))
                    {
                        if(className.indexOf('removed') > -1)
                        {
                            className = className.replace('removed');
                        }
                        else
                        {
                            className += ' removed';
                        }
                    }
                }
            }
        </script>
    </head>
    <body>
    <table>
        <thead>
            <tr>
                <th>Person</th>
                <th>Prop 1</th>
                <th>Prop 2</th>
                <th>Prop 3</th>
            </tr>
        </thead>
        <tbody>
            <tr id="p1" class="expands" onclick="toggle('p2','p3')">
                <td>P1</td>
                <td>a</td>
                <td>b</td>
                <td>c</td>
            </tr>
            <tr id="p2" class="removed child1">
                <td>P2</td>
                <td>a</td>
                <td>b</td>
                <td>c</td>
            </tr>
            <tr id="p3" class="removed child2">
                <td>P3</td>
                <td>a</td>
                <td>b</td>
                <td>c</td>
            </tr>
        </tbody>
        <tfoot>
            <tr>
                <td>Totals:</td>
                <td>x</td>
                <td>y</td>
                <td>z</td>
            </tr>
        </tfoot>
    </table>
    </body>
</html> 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-03T15:47:50.417

对列表使用语义适当的标签：`<ul>`. 简单地嵌套它们。您可以隐藏结构的一部分，或者动态创建它。

```
<ul id='n0>
  <li id='n1'>One guy</li>
  <li id='n2'>Second guy
    <ul id='n2.0'>
      <li id='n2.1'>first one of second guy</li>
      <li id='n2.2'>last of second</li>
    </ul>
  </li>
  <li id='n3'>Third one</li>
</ul> 
```

等等。项目的命名取决于你，我通常会反映结构（如这里）或数据库 ID。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-09-03T07:40:10.677

这种布局的名称是：

*   树网格/树网格（例如：Ajax）
*   树列表视图/树列表视图（例如：Microsoft .Net）
*   树模型/树模型（例如：Qt 框架）

搜索“treegrid”和“tree grid html5”似乎可以为 html 实现提供最佳结果。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-03T15:44:46.233

> ...它基本上是一个人的名单...

你不知道 - 这不是表格数据，它是一个列表 ( `<ul>`)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-03T18:02:22.780

我们使用一堆 DIV 来显示类似的结构。奇数（第 1 位、第 3 位、第 5 位等）每个都有一个单行表，偶数位（第 2 位、第 4 位等）最初通过 CSS 设置为 'display:none'。每个表的第一个单元格包含一个链接，该链接触发它下面的 DIV 填充通过 AJAX 调用从服务器返回的数据。返回的数据可能具有与第一级内容相同的结构（许多“可扩展”行），或者只是有关记录的“详细信息”。它没有任何语义，但它看起来像客户想要的那样并且它可以工作。以下是截图：

展开前的初始列表： [替代文字 http://img26.imageshack.us/img26/5986/28656041.png](http://img26.imageshack.us/img26/5986/28656041.png)

点击最后一个链接 (70036720) 后： [alt text http://img15.imageshack.us/img15/7455/40596280.png](http://img15.imageshack.us/img15/7455/40596280.png)

单击第二级 (70036720-1) 中的链接后： [alt text http://img197.imageshack.us/img197/4588/37964248.png](http://img197.imageshack.us/img197/4588/37964248.png)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-03T16:39:49.333

Daniel，要获得类似于 Windows 资源管理器中的文件夹层次结构的树结构，您需要有表格、div、图像（能够展开折叠）等。你的 div 应该有自动生成的或增量的 id。当用户单击展开/折叠图标时，您的 div 可见性应设置为阻止或无。这应该在 javascript 中完成。

我做过类似的事情，其中​​我的数据采用 xml 格式，其中包含部门、部门内的项目、项目内的资源等。我已应用 xslt 来生成树结构的 reqd html 输出。让我知道您的要求是否相同。所以我可以向您发布示例 xml，xslt。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-03T15:41:04.300

我会尝试使用嵌套`div`的 s。我认为让它看起来像一个只在顶部有列标题的大表是非常困难的，所以你最好考虑为每个嵌套级别的新表，或者将它旋转以便将数据显示为行而不是列。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-03T15:45:37.653

当然，我认为表格是错误的工具。通常，树被定义为子树的列表（可能还有一些数据），因此，我认为到 html 的语义转换应该使用一些嵌套列表（如果你想要那里的动态性，请确保保留所有列表用javascript打开和关闭它们，所以如果用户禁用了javascript，它们就会打开）。

实际上，您还说过，您有一个访问该站点的人的*列表*，因此它看起来更像列表而不是表格。

此外，嵌套列表可以使用 CSS 轻松格式化，看起来非常漂亮。至少让这样一个嵌套列表看起来不错的努力远远少于试图让一个表格看起来那么漂亮（我都尝试过）。

总的来说：使用嵌套列表。它更适合您所代表的数据结构，也更适合您的直觉，并且可以以更简单的方式更好地格式化。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-03T16:10:52.250

因此，您有人员和人员组的列表。将其排列为嵌套列表。

然后你有关于每个人的表格信息。将其呈现为一系列表格。

接下来，将人员链接到表。这可以通过`<a href="#table_about_person_a">`和来完成`<table id="table_about_person_a">`

如果启用了 JavaScript，则加载设置所有要显示的表格的样式表：无；

将事件处理程序附加到列表中读取 href 以获取与该用户关联的表的 id 的每个链接。设置 JS 使表格显示：表格（或 IE <= 7 中的块）。

由于 Internet Explorer 的问题，最好为所有表分配一个类以隐藏它们，然后将其删除以显示它们。

然后添加 CSS 以将表格放置在列表旁边。

如果没有 JS，它应该完全降级，以便单击名称会将浏览器滚动到与其关联的表。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-11-26T05:15:16.060

只需将树数据结构转换为具有孩子和父母关系的一维数组，然后使用这个一维数组在表格中显示您的数据。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-02-02T20:35:10.580

每当您从树中构建表格时，请使用`<table>`, `<tr>`,`<td>`标记或它们的 CSS 等价物`table`,`table-row`并`table-cell`应用`display:contents`到您与表格交错的元素以保留您的树结构而不会破坏表格布局。

有关工作示例，请参[见此小提琴。](https://jsfiddle.net/mikhailian/sf3xbuez/64/)

# sharepoint - 如何通过 SSL 启用 SharePoint

> ID：945467
> 
> 赞同：1
> 
> 时间：2009-06-03T15:39:05.127
> 
> 标签：sharepoint, ssl

SSL 启用 SharePoint 场的最佳方式是什么？我正在考虑 ISA，但到目前为止，我遇到了文档库和其他不稳定事物的问题。

任何人都可以描述在 SharePoint 场上启用 SSL 的清单或一些最佳实践吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T16:25:48.337

[在 SharePoint 2007 开发环境中配置 SSL](http://blog.mastykarz.nl/configuring-ssl-in-sharepoint-2007-development-environment/)

# mysql - 在 MySQL 中处理巨大的 Blob？

> ID：945471
> 
> 赞同：7
> 
> 时间：2009-06-03T15:39:48.697
> 
> 标签：mysql, blob

如何将巨大的 BLOB 插入 MySQL 数据库 (InnoDB)？

根据 MySQL 手册，LONGBLOB 类型的字段支持高达 4 GB 的数据大小。但是如此庞大的数据是如何进入数据库的呢？

我试着用

```
INSERT INTO table (bindata) VALUES ( LOAD_FILE('c:/tmp/hugefile') ); 
```

如果大文件的大小大于约 500 MB，则会失败。我已经设置`max_allowed_packet`了合适的尺寸；的值`innodb_buffer_pool_size`似乎没有影响。

*我的服务器机器运行 Windows Server 2003 并具有 2 GB RAM。我正在使用 MySQL 5.0.74-enterprise-nt。*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T15:47:34.613

BLOB 缓存在内存中，这就是为什么在将BLOB 插入数据库时​​将拥有*3 个副本的原因。*

您的 500 MB BLOB 在 RAM 中占用 1,500 MB，这似乎达到了您的内存限制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T15:53:46.953

我不知道您使用哪个客户端/api，但是当尝试使用来自自己的 Java 和 Objective-C 客户端的 blob 时，MySQL 似乎并不真正支持 blob 流。您需要足够的内存来将整个 blob 作为字节数组多次保存在 ram（服务器和客户端）中！迁移到 64 位 linux 会有所帮助，但不是理想的解决方案。

MySQL 不是为 BLOB 处理而设计的（适用于小型 BOB :-)。它占用了要在“BLOB”中存储/读取的 ram 的两倍或三倍。

抱歉，您必须使用其他数据库（如 PostgreSQL）才能获得真正的 BLOB 支持。

# python - 为什么没有人关心这个 MySQLdb 错误？这是一个错误吗？

> ID：945482
> 
> 赞同：10
> 
> 时间：2009-06-03T15:41:34.267
> 
> 标签：python, deadlock, mysql

TL;DR：我已经为我发现的一个错误提供了一个补丁，并且我得到了 0 个反馈。我想知道这是否是一个错误。这不是咆哮。请阅读此内容，如果您可能受到它的影响，请检查修复。

几周前我发现并报告了这个 MySQLdb 错误（编辑：6 周前），发送了一个补丁，将其发布在几个 ORM 的论坛上，邮寄了 MySQLdb 作者，邮寄了一些谈论处理死锁的人，邮寄了 ORM 作者和我'仍在等待任何形式的反馈。

这个错误让我很伤心，我能在反馈中找到的唯一解释是，要么没有人在带有 mysql 的 python 中使用“SELECT ... FOR UPDATE”，要么这不是一个错误。

基本上问题是在使用 MySQLdb 游标发出“SELECT ... FOR UPDATE”时不会引发死锁和“锁定等待超时”异常。相反，该语句会静默失败并返回一个空结果集，任何应用程序都会将其解释为没有匹配的行。

我已经测试了SVN版本，它仍然受到影响。在默认安装的 Ubuntu Intrepid、Jaunty 和 Debian Lenny 上进行了测试，这些也受到影响。easy_install (1.2.3c1) 安装的当前版本受到影响。

这也会影响 SQLAlchemy 和 SQLObject，并且可能任何使用 MySQLdb 游标的 ORM 也会受到影响。

该脚本可以重现将触发错误的死锁（只需更改用户/在 get_conn 中传递，它将创建必要的表）：

```
import time
import threading
import traceback
import logging
import MySQLdb

def get_conn():
    return MySQLdb.connect(host='localhost', db='TESTS',
                           user='tito', passwd='testing123')

class DeadlockTestThread(threading.Thread):
    def __init__(self, order):
        super(DeadlockTestThread, self).__init__()
        self.first_select_done = threading.Event()
        self.do_the_second_one = threading.Event()
        self.order = order

    def log(self, msg):
        logging.info('%s: %s' % (self.getName(), msg))

    def run(self):
        db = get_conn()
        c = db.cursor()
        c.execute('BEGIN;')
        query = 'SELECT * FROM locktest%i FOR UPDATE;'
        try:
            try:
                c.execute(query  % self.order[0])
                self.first_select_done.set()

                self.do_the_second_one.wait()
                c.execute(query  % self.order[1])
                self.log('2nd SELECT OK, we got %i rows' % len(c.fetchall()))

                c.execute('SHOW WARNINGS;')
                self.log('SHOW WARNINGS: %s' % str(c.fetchall()))
            except:
                self.log('Failed! Rolling back')
                c.execute('ROLLBACK;')
                raise
            else:
                c.execute('COMMIT;')
        finally:
            c.close()
            db.close()

def init():
    db = get_conn()

    # Create the tables.
    c = db.cursor()
    c.execute('DROP TABLE IF EXISTS locktest1;')
    c.execute('DROP TABLE IF EXISTS locktest2;')
    c.execute('''CREATE TABLE locktest1 (
                    a int(11), PRIMARY KEY(a)
                  ) ENGINE=innodb;''')
    c.execute('''CREATE TABLE locktest2 (
                    a int(11), PRIMARY KEY(a)
                  ) ENGINE=innodb;''')
    c.close()

    # Insert some data.
    c = db.cursor()
    c.execute('BEGIN;')
    c.execute('INSERT INTO locktest1 VALUES (123456);')
    c.execute('INSERT INTO locktest2 VALUES (123456);')
    c.execute('COMMIT;')
    c.close()

    db.close()

if __name__ == '__main__':
    logging.basicConfig(level=logging.INFO)

    init()

    t1 = DeadlockTestThread(order=[1, 2])
    t2 = DeadlockTestThread(order=[2, 1])

    t1.start()
    t2.start()

    # Wait till both threads did the 1st select.
    t1.first_select_done.wait()
    t2.first_select_done.wait()

    # Let thread 1 continue, it will get wait for the lock 
    # at this point.
    t1.do_the_second_one.set()

    # Just make sure thread 1 is waiting for the lock.
    time.sleep(0.1)

    # This will trigger the deadlock and thread-2 will
    # fail silently, getting 0 rows.
    t2.do_the_second_one.set()

    t1.join()
    t2.join() 
```

在未打补丁的 MySQLdb 上运行它的输出是这样的：

```
$ python bug_mysqldb_deadlock.py
INFO:root:Thread-2: 2nd SELECT OK, we got 0 rows
INFO:root:Thread-2: SHOW WARNINGS: (('Error', 1213L, 'Deadlock found when trying to get lock; try restarting transaction'),)
INFO:root:Thread-1: 2nd SELECT OK, we got 1 rows
INFO:root:Thread-1: SHOW WARNINGS: () 
```

您可以看到 Thread-2 从我们知道有 1 的表中获得了 0 行，并且只发出“SHOW WARNINGS”语句，您可以看到发生了什么。如果您检查“SHOW ENGINE INNODB STATUS”，您将在日志“*** WE ROLL BACK TRANSACTION (2)”中看到这一行，在 Thread-2 上选择失败后发生的所有事情都是半回滚事务。

应用补丁后（检查票证，下面的 url），这是运行脚本的输出：

```
$ python bug_mysqldb_deadlock.py
INFO:root:Thread-2: Failed! Rolling back
Exception in thread Thread-2:
Traceback (most recent call last):
  File "/usr/lib/python2.4/threading.py", line 442, in __bootstrap
    self.run()
  File "bug_mysqldb_deadlock.py", line 33, in run
    c.execute(query  % self.order[1])
  File "/home/koba/Desarollo/InetPub/IBSRL/VirtualEnv-1.0-p2.4/lib/python2.4/site-packages/MySQL_python-1.2.2-py2.4-linux-x86_64.egg/MySQLdb/cursors.py", line 178, in execute
    self.errorhandler(self, exc, value)
  File "/home/koba/Desarollo/InetPub/IBSRL/VirtualEnv-1.0-p2.4/lib/python2.4/site-packages/MySQL_python-1.2.2-py2.4-linux-x86_64.egg/MySQLdb/connections.py", line 35, in defaulterrorhandler
    raise errorclass, errorvalue
OperationalError: (1213, 'Deadlock found when trying to get lock; try restarting transaction')

INFO:root:Thread-1: 2nd SELECT OK, we got 1 rows
INFO:root:Thread-1: SHOW WARNINGS: () 
```

在这种情况下，在 Thread-2 上会引发异常并正确回滚。

那么，你的意见是什么？，这是一个错误吗？没人关心还是我疯了？

这是我在 SF 上开的票：http: [//sourceforge.net/tracker/index.php ?func=detail&aid=2776267&group_id=22307&atid=374932](http://sourceforge.net/tracker/index.php?func=detail&aid=2776267&group_id=22307&atid=374932)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-03T15:48:58.623

> 为什么没有人关心这个 MySQLdb 错误？

错误可能需要一段时间来确定优先级，研究，验证问题，找到修复，测试修复，确保修复不会破坏其他任何东西。我建议您部署一个解决方法，因为此修复程序可能需要一些时间才能为您提供。

# c# - 使用相关统计数据和 NHibernate 建模集合

> ID：945491
> 
> 赞同：0
> 
> 时间：2009-06-03T15:44:41.150
> 
> 标签：c#, nhibernate

我目前正在尝试重构一个应用程序，该应用程序有很多地方显示数据列表或数据表，最后有总计或平均值，以及每条记录的百分比变化或累积总计。

通常，该集合被建模为一个对象列表，而其他数据在后面的 aspx 代码中计算 (yuck)。我想将此逻辑移动到我的模型中，以使其可测试和可重用。

目前我能想到的最好的办法是创建一个集合类，将所有这些对象都添加到其中。然后，此集合可以公开表示各种统计信息的属性。像这样：

```
public class DailySales
{
    public DateTime Date { get; set; }
    public decimal Value { get; set; }
}

public class SalesCollection
{
    public List<DailySales> Sales { get; private set; }

    public decimal TotalSales
    {
        get { return Sales.Sum(x => x.Value); }
    }
} 
```

这适用于总计。但现在我需要计算每天的百分比变化。我可以将其添加到日常销售中，然后从似乎也很有效的集合类中对其进行更新。除了它使 Nhibernate 持久化它变得相当困难，因为没有办法从销售列表中触发 SalesCollection 可以挂钩并计算其他统计信息的事件。

我想我正在寻找的是一种对此类数据进行建模的简洁方法，可以轻松地将其持久化到 Nhibernate。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T18:55:39.520

我会不理你的收藏，并暴露是这样的

```
private IList<DailySales> _dailySales;
public IEnumerable<DailySales> DailySales
{
  get
  {
     return _dailySales;
  }
} 
```

然后为 IEnumerable 创建扩展方法来进行计算。

```
public static decimal CalculateSomething (this IEnumerable<DailySales>sales)
{
   return {your calculation here}
} 
```

# unit-testing - YAGNI 是否也适用于编写测试？

> ID：945493
> 
> 赞同：13
> 
> 时间：2009-06-03T15:44:56.843
> 
> 标签：unit-testing, language-agnostic, tdd, yagni

当我编写代码时，我只编写我需要的函数。

这种方法是否也适用于编写测试？

我应该提前为每个我能想到的用例编写一个测试，只是为了安全起见，还是应该只在遇到一个用例时为它编写测试？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-03T15:52:22.057

我认为当你编写一个方法时，你应该测试预期和潜在的错误路径。这并不意味着您应该扩展您的设计以涵盖所有潜在用途——将其留到需要的时候，但您应该确保您的测试已经定义了面对无效参数或其他条件的预期行为。

据我了解，YAGNI 意味着您不应该开发还不需要的功能。从这个意义上说，您不应该编写一个测试来驱使您开发不需要的代码。不过，我怀疑这不是你要问的。

在这种情况下，我会更关心您是否应该编写涵盖意外用途的测试 - 例如，由于传递 null 或超出范围参数而导致的错误 - 或者重复仅在数据方面有所不同的测试，而不是功能. 在前一种情况下，正如我上面指出的，我会说是的。您的测试将记录您的方法在遇到错误时的预期行为。这对使用您的方法的人来说是重要的信息。

在后一种情况下，我无法给你一个明确的答案。你当然希望你的测试保持 DRY —— 不要编写一个简单地重复另一个测试的测试，即使它有不同的数据。或者，除非您使用数据的边缘情况，否则您可能不会发现潜在的设计问题。一个简单的例子是计算两个整数之和的方法：如果将它`maxint`作为两个参数传递会发生什么？如果您只有一个测试，那么您可能会错过这种行为。显然，这与上一点有关。只有您可以确定何时真正需要进行测试。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-06-03T15:47:36.580

是的，YAGNI 绝对适用于编写测试。

例如，我不编写测试来检查任何属性。我假设属性以某种方式工作，直到我找到一个与规范不同的东西，我不会对它们进行测试。

您应该始终考虑编写任何测试的有效性。如果编写测试对您没有明显的好处，那么我建议您不要这样做。然而，这显然是非常**主观**的，因为你可能认为不值得别人认为非常值得付出努力。

另外，我会编写测试来验证输入吗？绝对地。但是，我会做到这**一点**。假设您有一个带有 3 个整数参数的函数，它返回一个双精度值。您将围绕该功能编写多少测试。我会在这里使用 YAGNI 来确定哪些测试会给你带来良好的**投资回报率**，哪些是无用的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-03T15:48:51.430

根据需要编写测试。测试就是代码。预先编写一堆（最初失败的）测试打破了 TDD 的红色/修复/绿色循环，并且使识别有效失败与未编写代码变得更加困难。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-06-03T15:50:32.493

您应该为在此开发阶段要实现的用例编写测试。

这带来了以下好处：

1.  您的测试有助于定义此阶段的功能。
2.  你知道你什么时候完成了这个阶段，因为你所有的测试都通过了。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-06-03T15:49:07.640

理想情况下，您应该编写涵盖所有代码的测试。否则，您的其余测试将失去价值，最终您将反复调试那段代码。

所以不行。YAGNI 不包括测试 :)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-06-03T15:49:57.907

您可能会在这里遇到一些差异，但通常，编写测试（对我而言）的目标是确保您的所有代码都按应有的方式运行，没有副作用，以可预测的方式并且没有缺陷。因此，在我看来，您讨论的仅针对遇到的用例编写测试的方法对您没有真正的好处，实际上可能会造成伤害。

如果您忽略的被测单元的特定用例导致最终软件出现严重缺陷怎么办？在这种情况下，除了错误的安全感之外，花在开发测试上的时间给你带来了什么吗？

（作为记录，这是我在使用代码覆盖率来“衡量”测试质量时遇到的问题之一——这个衡量标准如果低，可能表明你没有进行足够的测试，但如果高，应该不要用来假设你是坚如磐石的。测试常见情况，测试边缘情况，然后考虑单元的所有 ifs 和 buts 并测试它们。）

## 轻度更新

我应该注意，我可能来自与这里的许多人不同的角度。我经常发现我正在编写库风格的代码，也就是说，将在多个项目中重用的代码，用于多个不同的客户。因此，我通常不可能肯定地说某些用例根本不会发生。我能做的最好的事情是记录它们不是预期的（因此可能需要在之后更新测试），或者 - 这是我的偏好:) - 只是编写测试。我经常发现选项 #2 更适合日常使用，这仅仅是因为我在新应用程序 Y 中重用组件 X 时更有信心。在我看来，自动化测试是什么所有关于。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-06-03T15:55:23.647

当然，为你不确定是否会实现的用例编写测试毫无意义——这对任何人来说都应该是显而易见的。

对于您知道将要实现的用例，测试用例的收益会递减，即，当您可以用一半的工作覆盖所有重要和关键路径时，尝试覆盖每一个可能的晦涩角落案例并不是一个有用的目标——假设，当然，忽略一个很少发生的错误的代价是可以承受的；在编写航空电子软件时，我当然不会满足于低于 100% 的代码和分支覆盖率。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-06-03T15:58:38.767

您当然应该推迟为尚未实现的功能编写测试用例。测试应该只针对现有功能或您将要加入的功能编写。

但是，用例与功能不同。您只需要测试您已确定的有效用例，但可能会发生很多其他事情，并且您希望确保这些输入得到合理的响应（很可能是错误消息） .

显然，您不会获得所有可能的用例。如果可以，则无需担心计算机安全性。你应该至少得到更合理的那些，并且当问题出现时，你应该将它们添加到用例中进行测试。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-06-03T16:14:14.637

我认为这里的答案是，就像在很多地方一样，这取决于。如果一个函数提供的合约声明它执行 X，并且我看到它有相关的单元测试等，我倾向于认为它是一个经过良好测试的单元并使用它，即使我没有在其他地方以完全相同的方式使用它。如果该特定使用模式未经测试，那么我可能会遇到令人困惑或难以追踪的错误。出于这个原因，我认为测试应该涵盖所有（或大部分）已定义的、记录在案的单元行为。

如果您选择以增量方式进行测试，我可能会在文档注释中添加该函数“仅针对 [某些类型的输入] 进行测试，其他输入的结果未定义”。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-06-03T16:15:57.540

我经常发现自己正在为我不希望正常程序流调用的情况编写测试，TDD。“假装直到你做到”的方法让我开始，通常，输入一个空值 - 足以让我知道函数调用应该是什么样子，它的参数将具有什么类型以及它将具有什么类型返回。需要明确的是，我不会只在我的测试中向函数发送 null ；我将初始化一个类型化变量以保存空值；这样，当 Eclipse 的 Quick Fix 为我创建函数时，它已经具有正确的类型。但我并不期望程序通常会向函数发送空值，这种情况并不少见。所以，可以说，我正在编写一个我 AGN 的测试。但如果我从价值观开始，有时它太大了。一世' m 从一开始就设计 API 并推动其实际实现。因此，通过开始缓慢并假装它直到我成功，有时我会为我不希望在生产代码中看到的案例编写测试。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-06-03T16:46:26.890

如果您以 TDD 或 XP 风格工作，那么您不会像您所说的那样“提前”编写任何内容，您将在任何给定时刻处理非常精确的功能，因此您将编写所有必要的测试，以确保该功能按您的预期工作。

测试代码与“代码”本身类似，您不会为您的应用程序的每个用例预先编写代码，那么您为什么要提前编写测试代码呢？

# c# - 如何添加类型约束以在泛型方法中包含任何可序列化的内容？

> ID：945495
> 
> 赞同：44
> 
> 时间：2009-06-03T15:45:03.193
> 
> 标签：c#, generics, attributes, serializable

我的通用方法需要序列化传递给它的对象，但是仅仅坚持它实现 ISerializable 似乎不起作用。例如，我有一个从 Web 服务（标有 SerializableAttribute）返回的结构，它可以很好地序列化为 xml，但是，正如预期的那样，C# 编译器会抱怨。

有没有一种方法可以在尝试序列化之前检查对象是否可序列化，或者更好的是，使用`where`关键字检查对象的方法是否合适？

这是我的完整方法：

```
public static void Push<T>(string url, T message)
        where T : ISerializable
{
    string xml = SerializeMessage(message);

    // Send the message to Amazon SQS
    SendMessageRequest sendReq = new SendMessageRequest { QueueUrl = url, MessageBody = xml };
    AmazonSQSClient client = new AmazonSQSClient(S3User, S3Pass);
    client.SendMessage(sendReq);
} 
```

和序列化消息：

```
private static string SerializeMessage<T>(T message)
{
    XmlSerializer xmlSerializer = new XmlSerializer(typeof(T));
    using (StringWriter stringWriter = new StringWriter())
    {
        xmlSerializer.Serialize(stringWriter, message);
        return stringWriter.ToString();
    }
} 
```

如果这不可能，那么在运行时检查对象是否可序列化的最佳方法是什么？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-06-03T15:50:55.283

您不能完全通过通用约束来做到这一点，但您可以做几件事来提供帮助：

1) 将**new()**约束放在泛型类型上（以启用反序列化的能力并确保 XmlSerializer 不会抱怨缺少默认 ctor）：

```
where T : new() 
```

2）在处理序列化的方法的第一行（或构造函数或其他任何您不必一遍又一遍地重复它的地方），您可以执行此检查：

```
if( !typeof(T).IsSerializable && !(typeof(ISerializable).IsAssignableFrom(typeof(T)) ) )
    throw new InvalidOperationException("A serializable Type is required"); 
```

当然，尝试序列化类型时仍然可能出现运行时异常，但这将涵盖最明显的问题。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-06-03T15:47:43.193

我写了一篇关于这个主题的长篇博客文章，您可能会觉得有帮助。它主要涉及二进制序列化，但这些概念适用于大多数任何序列化格式。

*   [http://blogs.msdn.com/jaredpar/archive/2009/03/31/is-it-serializable.aspx](http://blogs.msdn.com/jaredpar/archive/2009/03/31/is-it-serializable.aspx)

它的长短是

*   没有办法添加可靠的通用约束
*   **检查对象是否**可序列化的唯一方法是对其进行序列化并查看操作是否成功

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-03T15:48:56.423

知道一个对象是否可序列化的唯一方法是尝试序列化它。

实际上，您是在问如何判断一个类型是否“可序列化”，但实际问题是关于对象的。即使类型标记为 [Serializable]，某些类型的实例也可能无法序列化。例如，如果实例包含循环引用怎么办？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T15:47:32.053

代替

XmlSerializer xmlSerializer = new XmlSerializer(typeof(T));

尝试

XmlSerializer xmlSerializer = new XmlSerializer(message.GetType());

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-12-11T23:18:14.197

C# 8 及更高版本允许`unmanaged`约束将类型限制为仅包含值类型的结构（在任何嵌套级别上）。我们真正想要的是：

```
public class MyClass<T> where T : ISerializable or unmanaged 
```

但不幸的是，在编写 C# 时不支持这种语法（约束总是 AND，用逗号分隔）。

解决方法可能是 ValueWrapper 类：

```
public class ValueWrapper<U> : ISerializable where U : unmanaged 
```

这需要一个 U 作为构造函数参数。它有一个属性`U Value`。现在，您可以将值类型视为 ISerializable，只需将它们包装在 ValueWrapper 中即可。

# .net - 用户名 clientCredentialType 的 WCF 安全问题

> ID：945497
> 
> 赞同：3
> 
> 时间：2009-06-03T15:45:07.203
> 
> 标签：.net, wcf, .net-3.5, wcf-security

首先我为我的英语道歉......

然后：我有问题！

我为一个简单的 WCF 服务编写了代码，并且配置 #1 一切正常。

会议 #1 - 服务器

```
<configuration>
  <system.serviceModel>
    <services>
      <service name="WCFservice.Service" 
               behaviorConfiguration="WCFservice.ServiceBehavior">
        <host>
          <baseAddresses>
            <add baseAddress = "http://localhost:8731/WCFservice/" />
          </baseAddresses>
        </host>
        <endpoint address="" binding="wsHttpBinding" contract="WCFservice.IService"/>
        <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange"/>
      </service>
    </services>
    <bindings>
      <wsHttpBinding>
        <binding name="WSCertificateSecurity">
          <reliableSession enabled="true"/>
          <security mode="Message">
            <message clientCredentialType="UserName"/>
          </security>
        </binding>
      </wsHttpBinding>
    </bindings>
    <behaviors>
      <serviceBehaviors>
        <behavior name="WCFservice.ServiceBehavior">
          <serviceCredentials>
            <serviceCertificate findValue="cn=abc" 
                    storeLocation="LocalMachine" storeName="TrustedPeople" 
                    x509FindType="FindBySubjectDistinguishedName"/>
            <clientCertificate>
              <authentication certificateValidationMode="PeerTrust"/>
            </clientCertificate>
          </serviceCredentials>
          <serviceMetadata httpGetEnabled="True"/>
          <serviceDebug includeExceptionDetailInFaults="True" />
        </behavior>
      </serviceBehaviors>
    </behaviors>
  </system.serviceModel>
</configuration> 
```

会议 #1 - 客户

```
<configuration>
  <system.serviceModel>
    <bindings>
      <wsHttpBinding>
        <binding name="WSHttpBinding_IService">
          <reliableSession enabled="false" />
          <security mode="Message">
            <transport clientCredentialType="Windows" 
                       proxyCredentialType="None" realm="" />
            <message clientCredentialType="Windows" 
                  negotiateServiceCredential="true"
                  establishSecurityContext="true" 
                  algorithmSuite="Default" />
          </security>
        </binding>
      </wsHttpBinding>
    </bindings>
    <client>
      <endpoint address="http://localhost:8731/WCFservice/" 
                binding="wsHttpBinding"
                bindingConfiguration="WSHttpBinding_IService" 
                contract="WCF.IService"
                name="WSHttpBinding_IService">
        <identity>
          <userPrincipalName value="myname" />
        </identity>
      </endpoint>
    </client>
  </system.serviceModel>
</configuration> 
```

当我尝试使用我创建的个人验证类设置用户名身份验证时，就会出现问题。我发布了配置#2。

会议 #2 - 服务器

```
<configuration>
  <system.serviceModel>
    <services>
      <service name="WCFservice.Service" 
               behaviorConfiguration="WCFservice.ServiceBehavior">
        <host>
          <baseAddresses>
            <add baseAddress = "http://localhost:8731/WCFservice/" />
          </baseAddresses>
        </host>
        <endpoint address="" binding="wsHttpBinding" contract="WCFservice.IService"/>
        <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange"/>
      </service>
    </services>
    <bindings>
      <wsHttpBinding>
        <binding name="WSCertificateSecurity">
          <reliableSession enabled="true"/>
          <security mode="Message">
            <message clientCredentialType="UserName"/>
          </security>
        </binding>
      </wsHttpBinding>
    </bindings>
    <behaviors>
      <serviceBehaviors>
        <behavior name="WCFservice.ServiceBehavior">
          <serviceCredentials>
            <userNameAuthentication 
                 userNamePasswordValidationMode="Custom"  
                 customUserNamePasswordValidatorType="WCFservice.Login, WCFservice"/>
            <serviceCertificate findValue="cn=abc" 
                 storeLocation="LocalMachine" storeName="TrustedPeople" 
                 x509FindType="FindBySubjectDistinguishedName"/>
            <clientCertificate>
              <authentication certificateValidationMode="PeerTrust"/>
            </clientCertificate>
          </serviceCredentials>
          <serviceMetadata httpGetEnabled="True"/>
          <serviceDebug includeExceptionDetailInFaults="True" />
        </behavior>
      </serviceBehaviors>
    </behaviors>
  </system.serviceModel>
</configuration> 
```

会议 #2 - 客户

```
<configuration>
  <system.serviceModel>
    <bindings>
      <wsHttpBinding>
        <binding name="WSHttpBinding_IService">
          <reliableSession enabled="false" />
          <security mode="Message">
            <transport clientCredentialType="Windows" 
                  proxyCredentialType="None" realm="" />
            <message 
                  clientCredentialType="UserName" 
                  negotiateServiceCredential="true"
                  establishSecurityContext="true" 
                  algorithmSuite="Default" />
          </security>
        </binding>
      </wsHttpBinding>
    </bindings>
    <client>
      <endpoint address="http://localhost:8731/WCFservice/" binding="wsHttpBinding"
        bindingConfiguration="WSHttpBinding_IService" contract="WCF.IService"
        name="WSHttpBinding_IService">
        <identity>
          <userPrincipalName value="myname" />
        </identity>
      </endpoint>
    </client> 
```

当我启动应用程序并得到一个

System.ServiceModel.Security.SecurityNegotiationException

```
private void button1_Click(object sender, EventArgs e) 
{
    WCF.XnottaLightServiceClient client = new WCF.XnottaLightServiceClient();
    client.ClientCredentials.UserName.UserName = "user";
    client.ClientCredentials.UserName.Password = "pass";

    string[] s = textBox6.Text.Split('§');
    int[] i = new int[s.Length];
    for(int j = 0; j < i.Length; j++) 
    {
        i[j] = Convert.ToInt32(s[j]);
    }

    string string1 = client.getString("xnl");
} 
```

有任何想法吗？

谢谢，阿尔贝托

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T18:38:08.840

Well, one thing that immediately sticks out is this discrepancy:

Server:

```
<wsHttpBinding>
        <binding name="WSCertificateSecurity">
          <reliableSession enabled="true"/> 
```

Reliable sessions is enabled = true.

Client:

```
<wsHttpBinding>
        <binding name="WSHttpBinding_IService">
          <reliableSession enabled="false" /> 
```

Reliable sessions is enabled = false.

This is definitely a mismatch - surprisingly, though, this is the case in both your #1 and #2 scenarios.....

Marc

# ado.net - Sybase ASE ADO.net 2.0 提供者？

> ID：945501
> 
> 赞同：9
> 
> 时间：2009-06-03T15:46:10.307
> 
> 标签：ado.net, sap-ase

我正在为 Sybase 数据库寻找 ADO.net 2.0 或更高版本的提供程序，它似乎被称为 Sybase ASE。澄清一下，我对 ASE 感兴趣，而不是 SQL Anywhere。希望提供者将包含在数据库中，或者免费。

我可以找到 ADO.net 1.1 提供者的提及；那不是我想要的。

我可以找到提到 ODBC 驱动程序和 OLEDB 提供程序；那不是我想要的。

我找到了付费的 DataDirect ADO.net 提供商；我想这是后备位置。

谢谢你的帮助

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-08-08T05:33:48.823

最近自己也走上了这条路，我只能建议你不会通过搜索网络找到答案。如果您要连接到 ASE 服务器，那么您有一位客户技术联系人。使用那个人，要求他们下载前面提到的 Sybase 15 #ESD10。

根据我的经验（我坦率地承认，这是一个糟糕的经验）；

Sybase 仅向付费客户提供此类开发人员资源。

下载后，一旦您拥有它，将包括一大堆您不需要的附加功能。我仍然认为 PowerDesigner 是一个很棒的实用程序，但我认为其中包含的是试用版，长期价值有限。我相信您想要从集合中安装 OpenClient，选择 ADO.NET 功能。

我发现了整个体验，从获取开发人员资源（仅确定正确的下载是一项艰巨的任务），到从数百个已安装文件中分离出必要的两个文件，再到安装破坏了我现有的 RapidSql 和 DbArtisan 安装，最后，当前版本仅支持 ADO.NET 2 提供程序（例如，您不会获得 EF 接线），这确实令人沮丧。

毫不奇怪，我也无法使用 nHibernate 或 subsonic 找到对 ASE 的太多支持。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-04-20T13:36:10.400

这个问题相当古老，但似乎更容易获得 ADO 连接器。

1.  [从http://scn.sap.com/community/developer-center/oltp-db](http://scn.sap.com/community/developer-center/oltp-db)下载“获得免费的“开发者”版本”
2.  给定选项时选择自定义安装。
3.  仅从自定义安装中安装 .Net ADO 包。
4.  在您的解决方案中引用 Sybase.AdoNet4.AseClient.dll 来安装文件。

然后，您应该能够按照以下说明在 .NET 中执行查询、更新等操作：http: [//infocenter.sybase.com/help/index.jsp?topic=/com.sybase.help.sdk_12.5.1。 adonet/html/adonet/DAFJEFIF.htm](http://infocenter.sybase.com/help/index.jsp?topic=/com.sybase.help.sdk_12.5.1.adonet/html/adonet/DAFJEFIF.htm)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2018-07-25T07:48:16.780

作为 SAP/Sybase 驱动程序的替代方案，我们为 ASE 开发了自己的 ADO.NET Core 驱动程序：

[https://github.com/DataAction/AdoNetCore.AseClient](https://github.com/DataAction/AdoNetCore.AseClient)

.NET Core 对我们来说是一项关键技术——尤其是 AWS Lambda——而且 SAP/Sybase 仍然没有可用的 ADO.NET Core 驱动程序。

我们的驱动程序支持大多数 SAP/Sybase ADO.NET 功能，旨在成为 SAP/Sybase 的替代品，以便轻松过渡，并支持您关心的所有 .NET 框架。

你可以在 Nuget 上得到它：

[https://www.nuget.org/packages/AdoNetCore.AseClient](https://www.nuget.org/packages/AdoNetCore.AseClient)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-22T08:59:27.840

Sybase 15 #ESD10 支持 ADO.NET 2.0，根据 Sybase 上的此链接：http://infocenter.sybase.com/help/index.jsp?topic=/com.sybase.infocenter.dc20155.1500/html [/ newfesd/CBHJAABF.htm](http://infocenter.sybase.com/help/index.jsp?topic=/com.sybase.infocenter.dc20155.1500/html/newfesd/CBHJAABF.htm)

* * *

新功能 Open Server 15.0 和 SDK 15.0，用于 Microsoft Windows、Linux、UNIX 和 Mac OS X ADO.NET 2.0 支持

ASE ADO.NET Data Provider 2.0 随此 SDK 版本一起提供。此版本支持的 ADO.NET 2.0 功能包括：

```
*      Provider factories
*      Provider statistics
*      Bulk update
*      Bulk copy
*      Asynchronous commands
*      Extended pooling support to clear pools
*      Common base classes
*      Database metadata 
```

有关受支持的 ADO.NET 2.0 功能的详细信息，请参阅 ADO.NET 2.0 中的新增功能。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-06-03T16:09:30.813

从 sybase 网站：

Sybase 对 ADO.NET、OLE DB 和 ODBC 的支持 Adaptive Server 15.0 版包含由 Sybase 开发的新 ODBC 和 OLE DB 驱动程序。先前版本中包含的第三方重新命名的 ODBC 和 OLE DB 驱动程序工具包不再提供。

已停用的 ODBC 驱动程序工具包安装在 %SYBASE%\ODBC 中，并在 ODBC 驱动程序管理器中注册为“Sybase ASE ODBC 驱动程序”。Sybase 的新 ASE ODBC 驱动程序安装在 %SYBASE%\DataAccess\ODBC 中，并注册为“Adaptive Server Enterprise”。Adaptive Server 和 SDK 15.0 附带的版本是 15.0.0.50 版。

退役的 OLE DB Driver Kit 安装在 %SYBASE%\OLEDB 中，并使用“Sybase.ASEOLEDBProvider”的提供程序短名称和“Sybase ASE OLE DB Provider”的长名称。Sybase 的新 ASE OLE DB 提供程序安装在 %SYBASE%\DataAccess\OLEDB 中，并使用提供程序短名称“ASEOLEDB”。SDK 15.0 附带的版本是 15.0.0.51。

Sybase 建议您尽快开始迁移新的 ODBC 和 OLE DB 驱动程序。Adaptive Server 15.0 中引入的新功能仅受新驱动程序支持。

有关迁移到新驱动程序的说明，请参阅“适用于 Windows、Linux 和 UNIX 的 OpenServer 15.0 和 SDK 15.0 的新功能”。

# vim - 未加载编译器插件

> ID：945504
> 
> 赞同：2
> 
> 时间：2009-06-03T15:47:17.703
> 
> 标签：vim

我尝试使用这个 python 编译器插件来“编译”一个 py 脚本并在 qucikfix 窗口中查看错误并直接跳转到 linenumers。

[http://www.vim.org/scripts/script.php?script_id=1439](http://www.vim.org/scripts/script.php?script_id=1439)

我把它放在 /compiler/python.vim

但是：当我打开 python 文件时，脚本没有加载。甚至 :filetype detect 也无济于事。（根据：脚本名称）

我还尝试将这些东西放入_vimrc。但它被其他一些没用的东西覆盖了。我不知道它来自哪里，我搜索了所有插件目录，但没有设置 makeprg 和 errorformat 的插件！

我迷路了。请帮忙。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-03T19:49:57.680

您可以将其添加到您的 filetype.vim 文件中：

```
自动命令！BufRead,BufNewFile *.py 编译 python
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-03T16:16:18.053

编译器插件永远不会自动加载。您必须使用`:compiler python`.

# c# - 使用 xPath 循环遍历项目

> ID：945512
> 
> 赞同：3
> 
> 时间：2009-06-03T15:47:51.790
> 
> 标签：c#, asp.net, xpath

我正在尝试遍历 xml 文档，但我仍然在第二次迭代中获得第一个元素，不确定我缺少什么。任何人都可以帮忙吗？Xpath 很新

```
string file = HttpContext.Current.Server.MapPath("~/XML/Locations.xml");

    Dictionary<string, Location> locationCollection = new Dictionary<string, Location>();

        XPathDocument xDocument = new XPathDocument(file);
        XPathNavigator xPathNavigator = xDocument.CreateNavigator();

        foreach (XPathNavigator node in xPathNavigator.Select("//locations/*"))
        {
            string value = node.SelectSingleNode("/locations/location/cell").Value;
        }

    <?xml version="1.0" encoding="utf-8" ?>
<locations>
  <location>
    <locationName>Glendale</locationName>
    <street>3717 San Fernando Road</street>
    <city>Glendale</city>
    <state>CA</state>
    <zipcode>91204</zipcode>
    <generalManager>DJ Eldon</generalManager>
    <phone>(818) 552‐6246</phone>
    <tollFree>(888) 600‐6011</tollFree>
    <fax>(818) 552‐6248</fax>
    <cell>(347) 834‐2249</cell>
    <counterEmail>BUR@Eaglerider.com</counterEmail>
    <directEmail>DJ@Eaglerider.com</directEmail>
  </location>
  <location>
    <locationName>Chicago</locationName>
    <street>1301 S. Harlem Ave.</street>
    <city>Chicago</city>
    <state>IL</state>
    <zipcode>60402</zipcode>
    <generalManager>Dave Schnulle</generalManager>
    <phone>(708) 749‐1500</phone>
    <tollFree>(888) 966‐1500</tollFree>
    <fax>(818) 552‐6248</fax>
    <cell>(708) 749‐3800</cell>
    <counterEmail>ORD@Eaglerider.com</counterEmail>
    <directEmail>Dave@Eaglerider.com</directEmail>
  </location>  
</locations> 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-06-03T16:00:43.773

`node`通过使用前导斜杠返回文档根目录，您实际上忽略了值。试试这个：

```
// This assumes that there are only location nodes under locations;
// You may want to use //locations/location instead
foreach (XPathNavigator node in xPathNavigator.Select("//locations/*"))
{
    string value = node.SelectSingleNode("cell").Value;
    // Use value
} 
```

话虽如此，您是否有任何理由不在单个 XPath 查询中执行此操作？

```
// Name changed to avoid scrolling :)
foreach (XPathNavigator node in navigator.Select("//locations/location/cell"))
{
    string value = node.Value;
    // Use value
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T16:02:04.727

尝试以下操作：

```
XPathNodeIterator ni = xPathNavigator.Select("//locations/*");
while (ni.MoveNext())
{
    string value = ni.Current.Value);
} 
```

简单说一下，希望对你有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T16:07:08.020

你应该做：

```
string value = node.SelectSingleNode("./cell").Value; 
```

当您执行 xPathNavigator.Select("//locations/*")) 时，您已经在 /locations/location 中，因此您只需将一个元素向下移动到节点中，即示例中的单元格。

# command-line - 使用命令提示符修改 cmd.exe 属性

> ID：945527
> 
> 赞同：24
> 
> 时间：2009-06-03T15:50:33.973
> 
> 标签：command-line, command-prompt, cmd

这不是很好的递归吗？

我的外部驱动器上有一个便携式命令提示符，它有一个很好的 .bat 文件来配置一些初始设置，但我想要更多！

这是我知道如何从 .bat 设置的内容：

*   Colors = (color XY) 其中 x 和 y 是预定义颜色的十六进制数字
*   Prompt = (prompt $p$g) 将提示设置为“C:\etc\etc >”默认提示
*   Title = (title "text") 设置窗口标题为 "text"
*   Screen Size = (mode con: cols=XX lines=YY) 设置窗口的列和行大小
*   Path = (SET PATH=%~d0\bin;%PATH%) 设置我的工具的本地路径并附加计算机的路径

所以这一切都很好。但是有一些设置我似乎无法从蝙蝠中设置。就像，我将如何使用“属性”对话框设置这些：

*   缓冲区 = 不是屏幕大小，而是缓冲区
*   快速编辑模式和自动完成等选项
*   弹出颜色
*   字体。您可以在便携式驱动器上使用字体，还是必须安装它才能工作？
*   命令历史选项

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-08-13T12:13:58.080

关于设置缓冲区大小：

使用`mode con: cols=XX lines=YY`不仅设置窗口（屏幕）大小，还设置缓冲区大小。

如果您根据可用的屏幕尺寸指定系统允许的尺寸，您会看到窗口和缓冲区尺寸都设置为相同的值；。例如：

```
mode con: cols=100 lines=30 
```

结果如下（值相同）：

*   窗口大小：宽度= **160**，高度= **78**
*   缓冲区大小：宽度= **160**，高度= **78**

相反，如果您根据可用屏幕大小指定过大的值，您会看到窗口大小更改为最大值，但缓冲区大小更改为指定的值。

```
mode con: cols=1600 lines=900 
```

使用 1280x1024 的屏幕分辨率，您将获得：

*   窗口大小：宽度= **160**，高度= **78**
*   缓冲区大小：宽度= **1600**，高度= **900**

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-11-05T15:36:49.283

您可以通过快捷方式（.INK 文件）设置这些值。

我的桌面上有一个快捷方式，以此为目标：

%windir%\system32\cmd.exe /K %userprofile%\STARTUP.CMD

/K 开关告诉 CMD.exe 运行批处理文件（设置一些变量、提示等），然后保持打开状态。

如果您右键单击快捷方式并查看其属性，您可以设置窗口和缓冲区大小、弹出颜色、起始位置（x、y 轴）等。这些设置将保存在快捷方式本身中，并且将应用到每个使用该快捷方式打开 CMD.exe 的时间。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-06-03T15:57:33.507

关于自动完成：

> 默认情况下不启用文件和目录名称完成。您可以使用 /F:ON 或 /F:OFF 开关为 CMD.EXE 的特定调用启用或禁用文件名完成。您可以通过使用 REGEDT32.EXE 在注册表中设置以下任一或两个 REG_DWORD 值来启用或禁用计算机和/或用户登录会话上 CMD.EXE 的所有调用的完成：
> 
> ```
> HKEY_LOCAL_MACHINE\Software\Microsoft\Command Processor\CompletionChar
> HKEY_LOCAL_MACHINE\Software\Microsoft\Command Processor\PathCompletionChar
> 
>     and/or
> 
> HKEY_CURRENT_USER\Software\Microsoft\Command Processor\CompletionChar
> HKEY_CURRENT_USER\Software\Microsoft\Command Processor\PathCompletionChar 
> ```
> 
> 用于特定功能的控制字符的十六进制值（例如，0x4 是 Ctrl-D，0x6 是 Ctrl-F）。用户特定设置优先于机器设置。命令行开关优先于注册表设置。
> 
> 如果使用 /F:ON 开关启用完成，则使用的两个控制字符是用于目录名称完成的 Ctrl-D 和用于文件名完成的 Ctrl-F。要禁用注册表中的特定完成字符，请使用空格 (0x20) 的值，因为它不是有效的控制字符。

在那里找不到任何命令历史记录选项（ cmd /? ），看起来您询问的其他选项是通过注册表设置专门设置的。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2010-06-13T01:44:15.817

对于真正的缓冲区大小调整，使用 DOSKEY /LISTSIZE=size

由于 Microsoft 将 ANSI ESC 控制从命令/cmd 提示中取出，因此您无法再更改 shell 中的颜色。

# linq - 将随机 Guid 列添加到 Linq to Entities 查询以获取随机记录

> ID：945536
> 
> 赞同：2
> 
> 时间：2009-06-03T15:54:28.827
> 
> 标签：linq, entity-framework, linq-to-entities, lambda

我发现了一些关于使用 RandomView 视图和 GetNewID 函数来拉回随机记录的文章，但他们使用这种方法与 Linq to SQL 一起使用，允许函数和存储过程在没有返回值或标量返回值的情况下使用。据我了解，必须将存储过程作为我生成的模型中的实体框架对象之一返回。我已经能够让它作为一个对象工作，但没有返回一个标量或没有返回集。

我想要做的是简单地在我的 Linq 查询中添加一个包含新生成的 Guid 的列，以便我可以按新的 Guid 排序并随机获取特定数量的记录。任何人都可以使用某种 lambda 表达式或加入来帮助我做到这一点吗？似乎它应该是 EF 内置的东西，但我知道我们使用的是 EF v1。

（请在 VB.net 中提供代码）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-03T16:16:15.870

在 Linq 查询的 Select 子句中，您应该能够像这样插入 GUID：

```
var result = from myRecord in myTable
    select new {
        field1 = myRecord.field1,
        field2 = myRecord.field2,
        guidField = Guid.NewGuid()
    }; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T16:50:50.503

好吧，我的 VB 有点生疏，但我认为这会起作用......

```
Dim result = 
    From myRecord in myTable _   
    Select field1, _
           field2,  _
           guidField = System.Guid.NewGuid() 
```

# c# - 使用 C# 读取 Firefox 书签

> ID：945537
> 
> 赞同：7
> 
> 时间：2009-06-03T15:54:40.107
> 
> 标签：c#, firefox, bookmarks, favorites

使用 C#，我需要获取所有 Firefox 书签，以便将它们导入我们的数据库。我怎样才能做到这一点？

我知道 SO 问题[Read FF 3 bookmarks in Java](https://stackoverflow.com/questions/81132/read-firefox-3-bookmarks)，但那里的答案似乎都围绕 Java 数据库驱动程序，我不确定其中一些答案不是 Java 特定的。

**我的主要问题是**，“如何在 C# 中阅读 Firefox 书签？”

次要问题：我看到 \%user profile%\application data\mozilla\firefox\profiles\bookmarkbackups\bookmarks-[date].json 文件——我可以解析吗？如果是这样，是否有任何现有的解析器？

修辞感叹的问题：为什么不能像 IE 那样简单，我只是在 \%user profile%\favorites 中读取 .url 文件？呸。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-03T16:32:27.810

使用 .Net 的 SQLite 驱动程序并访问可以在我的计算机上找到的文件**places.sqlite 。**
`Application Data/Mozilla/Firefox/Profiles/$this_varies/places.sqlite`
在目标计算机上定位应该不难。

编辑 1：
这是从数据库中打印出 url 的代码片段：

```
using System.Data.SQLite; // downloaded from http://sourceforge.net/projects/adodotnetsqlite

namespace sqlite_test
{
    class Program
    {
        static void Main(string[] args)
        {
            var path_to_db = @"C:\places.sqlite"; // copied here to avoid long path
            SQLiteConnection sqlite_connection = new SQLiteConnection("Data Source=" + path_to_db + ";Version=3;New=True;Compress=True;");

            SQLiteCommand sqlite_command = sqlite_connection.CreateCommand();

            sqlite_connection.Open();

            sqlite_command.CommandText = "select * from moz_places";

            SQLiteDataReader sqlite_datareader = sqlite_command.ExecuteReader();

            while (sqlite_datareader.Read())
            {
                // Prints out the url field from the table:
                System.Console.WriteLine(sqlite_datareader["url"]);
            }
        }
    }
} 
```

编辑2：
作为提示。我真的必须为 firefox 推荐 SQLite Manager 插件。它对于使用 sqlite 数据库非常有用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T15:59:02.650

当然，它的工作方式与 Java 问题中建议的方式相同，只需获取[SQLite .NET 提供程序](http://sqlite.phxsoftware.com/)并使用它来访问 FF 数据库文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T15:57:01.107

.Net 有一个 SQLite 驱动程序。一旦你开始工作，我想解决方案在 .Net 和 Java 中都是一样的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-07-02T18:03:46.223

我不得不为我的项目[http://www.codertakeout.com](http://www.codertakeout.com)稍微修改一下。希望这次修订有助于澄清一些事情，这要归功于网络上的一些建议。

```
using System.Data.SQLite;  // need to install sqlite .net driver

String path_to_db = @"C:\Documents and Settings\Jeff\Application Data\Mozilla\Firefox\Profiles\yhwx4xco.default\places.sqlite";
String path_to_temp = System.IO.Path.GetTempFileName();

System.IO.File.Copy(path_to_db, path_to_temp, true);
SQLiteConnection sqlite_connection = new SQLiteConnection("Data Source=" + path_to_temp + ";Version=3;Compress=True;Read Only=True;");

SQLiteCommand sqlite_command = sqlite_connection.CreateCommand();

sqlite_connection.Open();

sqlite_command.CommandText = "SELECT moz_bookmarks.title,moz_places.url FROM moz_bookmarks LEFT JOIN moz_places WHERE moz_bookmarks.fk = moz_places.id AND moz_bookmarks.title != 'null' AND moz_places.url LIKE '%http%';";

SQLiteDataReader sqlite_datareader = sqlite_command.ExecuteReader();

while (sqlite_datareader.Read())
    {
        System.Console.WriteLine(sqlite_datareader[1]);
    }
sqlite_connection.Close();
System.IO.File.Delete(path_to_temp); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-11-27T16:51:28.770

访问[http://myexps.blogspot.com](http://myexps.blogspot.com)以了解 java 中的实现。

```
import java.sql.*;

public class helloWorld {
  public static void main(String[] args) throws Exception {
      Class.forName("org.sqlite.JDBC");
      Connection conn = DriverManager.getConnection("jdbc:sqlite:/home/deepak/.mozilla/firefox/yvf7p20d.default/places.sqlite//");
  if(conn==null)
  {
   System.out.println("ERROR");
  }
  System.out.println(conn.toString());

  Statement stat = conn.createStatement();

  ResultSet rs = stat.executeQuery("select * from moz_bookmarks;");
  while (rs.next()) {
      System.out.println("id = " + rs.getString("id"));
      System.out.println("keyword = " + rs.getString("keyword_id"));
      System.out.println("title = " + rs.getString("title"));
  }
  rs.close();
  conn.close();
  }
} 
```

这将是java实现

# .net - 在工作计算机上部署和运行 .NET 程序集

> ID：945538
> 
> 赞同：0
> 
> 时间：2009-06-03T15:54:51.637
> 
> 标签：.net, deployment, automation, assemblies, auto-update

我有一个基本的任务框架，其中的任务如下：

*   做一些内容处理
*   报告生成
*   错误日志观察者
*   邮递员
*   等等

被封装在一个`ITask`接口中，该接口有一个`Run`方法和其他与状态相关的成员。

这些任务要么按计划连续运行，要么按需运行。它们要么作为 Windows 服务托管，要么作为工作机器上的控制台应用程序托管。

宿主应用程序使用一个类运行一组任务，`TaskRunner`该类可能使用调度、线程等。

我希望能够以比执行发布和更新更自动化的方式将任务部署到工作机器。

基本上，我希望能够发送一个 ITask 接口（或另一个子组件）的流程和实现，以按某个计划或某些设置运行。

我知道我可以动态加载程序集，而且我还看到了：[MEF](http://www.codeplex.com/MEF)。

解决此问题的最佳方法是什么？我应该构建一个实现并将 DLL 发布到工作进程可以读取它们的已知目录吗？我应该将 DLL 作为二进制文件发布到数据库中以供工作人员阅读吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T16:13:45.043

无论哪种方式都会奏效。在我看来，您更喜欢哪一种取决于您的操作要求。

如果您已经安装了一个良好的数据库，并且您希望任务得到严格管理和可查询，并且如果您希望将许多其他属性与任务相关联，那么数据库具有强制执行的能力一个严格的模式和查询/更新能力将是事情。

相反，如果您有一个更宽松的环境，您没有安装数据库服务器，并且您只想能够将任务推出，共享文件系统或只是一个文件删除会更有意义。

如果您对两者都没有强烈的偏好，并且如果您希望模型具有灵活性，请在任一端封装发布和加载内容，以便您可以轻松配置文件系统或数据库或其他一些提供程序。

在任何一种情况下，动态加载程序集并调用它都会很容易。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T16:14:25.230

我的建议是查看 Codeplex 上的 WPF CAB 项目。在项目中，它具有将新 dll 注册为实现接口 IModule 的模块的概念。

您可以遵循相同的模式，仅使用 ITask，然后调用 ITask.RunTask() 或等效项。

# sharepoint - 扩展 Sharepoint XSL 模板

> ID：945539
> 
> 赞同：0
> 
> 时间：2009-06-03T15:55:05.847
> 
> 标签：sharepoint, xslt

感谢[这篇文章](https://stackoverflow.com/questions/940433/outputing-sharepoint-hyperlink-column-as-url)，我想出了以下模板：-

```
<xsl:variable name="Doc">
  <xsl:call-template name="OuterTemplate.GetTitle">
    <xsl:with-param name="Title" select="@DocumentLink1"/>
  </xsl:call-template>
</xsl:variable>

<a href="{substring-before($Doc,',')}">
  <xsl:value-of select="substring-after($Doc,',')" />
</a> 
```

该模板嵌套在无序列表和 li 标签中（见下文）。由于此代码在不存在内容时在 html 页面中具有物理和视觉存在，因此我想将 li 标签和可能的 ul 标签添加到模板中。谁能告诉我如何做到这一点？

```
<ul>
<li>
    <xsl:variable name="Doc">
        <xsl:call-template name="OuterTemplate.GetTitle">
            <xsl:with-param name="Title" select="@DocumentLink1"/>
        </xsl:call-template>
    </xsl:variable>
<a href="{substring-before($Doc,',')}">
    <xsl:value-of select="substring-after($Doc,',')"/>
</a>
</li>
<li>
<xsl:variable name="Doc">
        <xsl:call-template name="OuterTemplate.GetTitle">
            <xsl:with-param name="Title" select="@DocumentLink2"/>
        </xsl:call-template>
    </xsl:variable>
<a href="{substring-before($Doc,',')}">
    <xsl:value-of select="substring-after($Doc,',')"/>
</a>
</li>
<li>
<xsl:variable name="Doc">
        <xsl:call-template name="OuterTemplate.GetTitle">
            <xsl:with-param name="Title" select="@DocumentLink3"/>
        </xsl:call-template>
    </xsl:variable>
<a href="{substring-before($Doc,',')}">
    <xsl:value-of select="substring-after($Doc,',')"/>
</a>
</li> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T17:03:18.570

我从您到另一篇文章的链接中假设您在此处使用内容查询 Web 部件。

您需要使用 XSLT 页眉/页脚技术来包装对这个变量的调用。[这是](http://paulgalvin.spaces.live.com/blog/cns!1CC1EDB3DAA9B8AA!491.entry)我见过的几篇文章之一，这些文章特别展示了如何使用 CQWP 完成此操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T18:11:19.813

您可以尝试使用 xsl:if 元素有条件地输出内容。[您可以在@http: //www.w3schools.com/xsl/xsl_if.asp](http://www.w3schools.com/xsl/xsl_if.asp)找到有关 xsl:if 工作原理的更多信息，或者只使用您最喜欢的搜索引擎。

# wpf - ScrollViewer 模板的 WPF 参考 ScrollContentPresenter

> ID：945542
> 
> 赞同：1
> 
> 时间：2009-06-03T15:55:54.583
> 
> 标签：wpf, templates, controls, scrollviewer

我有一个 WPF ScrollViewer，我想访问它的模板的 ScrollContentPresenter。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T16:06:40.280

如果您想访问 ScrollViewer 的 ScrollContentPresenter，您可以使用[ControlTemplate](http://msdn.microsoft.com/en-us/library/aa970847.aspx)

```
<ScrollViewer Style="{StaticResource LeftScrollViewer}"/> 
```

```
<Style x:Key="LeftScrollViewer" TargetType="{x:Type ScrollViewer}">
 <Setter Property="OverridesDefaultStyle" Value="True"/>
 <Setter Property="Template">
 <Setter.Value>
  <ControlTemplate TargetType="{x:Type ScrollViewer}">
    <Grid>
      <Grid.ColumnDefinitions>
        <ColumnDefinition Width="Auto"/>
        <ColumnDefinition/>
      </Grid.ColumnDefinitions>
      <Grid.RowDefinitions>
        <RowDefinition/>
        <RowDefinition Height="Auto"/>
      </Grid.RowDefinitions>

      <ScrollContentPresenter Grid.Column="1"/>

      <ScrollBar Name="PART_VerticalScrollBar"
        Value="{TemplateBinding VerticalOffset}"
        Maximum="{TemplateBinding ScrollableHeight}"
        ViewportSize="{TemplateBinding ViewportHeight}"
        Visibility="{TemplateBinding ComputedVerticalScrollBarVisibility}"/>
      <ScrollBar Name="PART_HorizontalScrollBar"
        Orientation="Horizontal"
        Grid.Row="1"
        Grid.Column="1"
        Value="{TemplateBinding HorizontalOffset}"
        Maximum="{TemplateBinding ScrollableWidth}"
        ViewportSize="{TemplateBinding ViewportWidth}"
        Visibility="{TemplateBinding ComputedHorizontalScrollBarVisibility}"/>

    </Grid>
   </ControlTemplate>
  </Setter.Value>
 </Setter>
</Style> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-04T02:19:44.600

与其尝试从 ScrollViewer 向下走，也许您想从 Content *up*绑定一些东西？

就像是：

```
<Grid Width={Binding Path=ActualWidth RelativeBinding={RelativeBinding FindAncestor, AncestorType={x:Type ScrollContentPresenter}}}> 
```

*注意*：该语法可能不是 100% 正确的，它不在我的脑海中

# java - java用preparedstatement插入特殊字符失败

> ID：945543
> 
> 赞同：0
> 
> 时间：2009-06-03T15:56:18.983
> 
> 标签：java, special-characters, urlencode, urldecode

我正在使用发送的 HTML 表单

```
<input type=hidden name=longdesc value='SMARTNET%^" 8X5XNBD'> 
```

这是通过以下 javascript 代码完成的：

```
function masinsert(id)
{
 var currentTime=new Date();

 var button = document.getElementById("m"+id);
 button.onclick="";
 button.value="Inserting";

 var itemdescription    = document.getElementById("itemdescription"+id).value;

 function handleHttpResponse()
  {
   if (http.readyState == 4) {
    button.value="Item Added";
   }
  }

 var http = getHTTPObject(); // We create the HTTP Object
 var tempUrl = "\AInsert";
 tempUrl +=  "itemdescription="+itemdescription+"&"+"itemshortdescription="+itemdescription.substring(0,37)+;
alert(tempUrl);
 http.open("GET", tempUrl, true);
 http.onreadystatechange = handleHttpResponse;
 http.send(null);   
} 
```

到一个java servlet。插入.java

在 AInsert.java 文件中，我做了一个

```
String itemdescription = request.getParameter("longdesc"); 
```

然后将值发送到准备好的语句以运行插入查询。在查询中，有时会有一些特殊字符将其排除在外。例如，当我运行以下

```
insert into itemdescription (longdesc) values ('SMARTNET%^" 8X5XNBD') 
```

这是实际的片段：

```
PreparedStatement ps = conn.prepareStatement("INSERT INTO itemdescription (longdesc) values(?)");
ps.setString(1, itemdescription);
ps.executeUpdate(); 
```

它会产生一个错误说：*无法将值 NULL 插入列 'LongDesc'，表 'App.dbo.itemdescription'；列不允许空值。插入失败*

我试过 urlencode/urldecode

```
String encodedString = URLEncoder.encode(longdesc, "UTF-8");
String decitemdescription = URLDecoder.decode(itemdescription, "UTF-8"); 
```

我也尝试过这些功能

```
 //BEGIN URL Encoder 
    final static String[] hex = {
    "%00", "%01", "%02", "%03", "%04", "%05", "%06", "%07",
    "%08", "%09", "%0a", "%0b", "%0c", "%0d", "%0e", "%0f",
    "%10", "%11", "%12", "%13", "%14", "%15", "%16", "%17",
    "%18", "%19", "%1a", "%1b", "%1c", "%1d", "%1e", "%1f",
    "%20", "%21", "%22", "%23", "%24", "%25", "%26", "%27",
    "%28", "%29", "%2a", "%2b", "%2c", "%2d", "%2e", "%2f",
    "%30", "%31", "%32", "%33", "%34", "%35", "%36", "%37",
    "%38", "%39", "%3a", "%3b", "%3c", "%3d", "%3e", "%3f",
    "%40", "%41", "%42", "%43", "%44", "%45", "%46", "%47",
    "%48", "%49", "%4a", "%4b", "%4c", "%4d", "%4e", "%4f",
    "%50", "%51", "%52", "%53", "%54", "%55", "%56", "%57",
    "%58", "%59", "%5a", "%5b", "%5c", "%5d", "%5e", "%5f",
    "%60", "%61", "%62", "%63", "%64", "%65", "%66", "%67",
    "%68", "%69", "%6a", "%6b", "%6c", "%6d", "%6e", "%6f",
    "%70", "%71", "%72", "%73", "%74", "%75", "%76", "%77",
    "%78", "%79", "%7a", "%7b", "%7c", "%7d", "%7e", "%7f",
    "%80", "%81", "%82", "%83", "%84", "%85", "%86", "%87",
    "%88", "%89", "%8a", "%8b", "%8c", "%8d", "%8e", "%8f",
    "%90", "%91", "%92", "%93", "%94", "%95", "%96", "%97",
    "%98", "%99", "%9a", "%9b", "%9c", "%9d", "%9e", "%9f",
    "%a0", "%a1", "%a2", "%a3", "%a4", "%a5", "%a6", "%a7",
    "%a8", "%a9", "%aa", "%ab", "%ac", "%ad", "%ae", "%af",
    "%b0", "%b1", "%b2", "%b3", "%b4", "%b5", "%b6", "%b7",
    "%b8", "%b9", "%ba", "%bb", "%bc", "%bd", "%be", "%bf",
    "%c0", "%c1", "%c2", "%c3", "%c4", "%c5", "%c6", "%c7",
    "%c8", "%c9", "%ca", "%cb", "%cc", "%cd", "%ce", "%cf",
    "%d0", "%d1", "%d2", "%d3", "%d4", "%d5", "%d6", "%d7",
    "%d8", "%d9", "%da", "%db", "%dc", "%dd", "%de", "%df",
    "%e0", "%e1", "%e2", "%e3", "%e4", "%e5", "%e6", "%e7",
    "%e8", "%e9", "%ea", "%eb", "%ec", "%ed", "%ee", "%ef",
    "%f0", "%f1", "%f2", "%f3", "%f4", "%f5", "%f6", "%f7",
    "%f8", "%f9", "%fa", "%fb", "%fc", "%fd", "%fe", "%ff"
  };

  /**
   * Encode a string to the "x-www-form-urlencoded" form, enhanced
   * with the UTF-8-in-URL proposal. This is what happens:
   *
   * <ul>
   * <li><p>The ASCII characters 'a' through 'z', 'A' through 'Z',
   *        and '0' through '9' remain the same.
   *
   * <li><p>The unreserved characters - _ . ! ~ * ' ( ) remain the same.
   *
   * <li><p>The space character ' ' is converted into a plus sign '+'.
   *
   * <li><p>All other ASCII characters are converted into the
   *        3-character string "%xy", where xy is
   *        the two-digit hexadecimal representation of the character
   *        code
   *
   * <li><p>All non-ASCII characters are encoded in two steps: first
   *        to a sequence of 2 or 3 bytes, using the UTF-8 algorithm;
   *        secondly each of these bytes is encoded as "%xx".
   * </ul>
   *
   * @param s The string to be encoded
   * @return The encoded string
   */
  public static String encode(String s)
  {
    StringBuffer sbuf = new StringBuffer();
    int len = s.length();
    for (int i = 0; i < len; i++) {
      int ch = s.charAt(i);
      if ('A' <= ch && ch <= 'Z') {     // 'A'..'Z'
        sbuf.append((char)ch);
      } else if ('a' <= ch && ch <= 'z') {  // 'a'..'z'
           sbuf.append((char)ch);
      } else if ('0' <= ch && ch <= '9') {  // '0'..'9'
           sbuf.append((char)ch);
      } else if (ch == ' ') {           // space
           sbuf.append('+');
      } else if (ch == '-' || ch == '_'     // unreserved
          || ch == '.' || ch == '!'
          || ch == '~' || ch == '*'
          || ch == '\'' || ch == '('
          || ch == ')') {
        sbuf.append((char)ch);
      } else if (ch <= 0x007f) {        // other ASCII
           sbuf.append(hex[ch]);
      } else if (ch <= 0x07FF) {        // non-ASCII <= 0x7FF
           sbuf.append(hex[0xc0 | (ch >> 6)]);
           sbuf.append(hex[0x80 | (ch & 0x3F)]);
      } else {                  // 0x7FF < ch <= 0xFFFF
           sbuf.append(hex[0xe0 | (ch >> 12)]);
           sbuf.append(hex[0x80 | ((ch >> 6) & 0x3F)]);
           sbuf.append(hex[0x80 | (ch & 0x3F)]);
      }
    }
    return sbuf.toString();
  } //end encode 
```

和

```
//decode url   
    private static String unescape(String s) {
    StringBuffer sbuf = new StringBuffer () ;
    int l  = s.length() ;
    int ch = -1 ;
    int b, sumb = 0;
    for (int i = 0, more = -1 ; i < l ; i++) {
      /* Get next byte b from URL segment s */
      switch (ch = s.charAt(i)) {
    case '%':
      ch = s.charAt (++i) ;
      int hb = (Character.isDigit ((char) ch) 
            ? ch - '0'
            : 10+Character.toLowerCase((char) ch) - 'a') & 0xF ;
      ch = s.charAt (++i) ;
      int lb = (Character.isDigit ((char) ch)
            ? ch - '0'
            : 10+Character.toLowerCase ((char) ch)-'a') & 0xF ;
      b = (hb << 4) | lb ;
      break ;
    case '+':
      b = ' ' ;
      break ;
    default:
      b = ch ;
      }
      /* Decode byte b as UTF-8, sumb collects incomplete chars */
      if ((b & 0xc0) == 0x80) {         // 10xxxxxx (continuation byte)
    sumb = (sumb << 6) | (b & 0x3f) ;   // Add 6 bits to sumb
    if (--more == 0) sbuf.append((char) sumb) ; // Add char to sbuf
      } else if ((b & 0x80) == 0x00) {      // 0xxxxxxx (yields 7 bits)
    sbuf.append((char) b) ;         // Store in sbuf
      } else if ((b & 0xe0) == 0xc0) {      // 110xxxxx (yields 5 bits)
    sumb = b & 0x1f;
    more = 1;               // Expect 1 more byte
      } else if ((b & 0xf0) == 0xe0) {      // 1110xxxx (yields 4 bits)
    sumb = b & 0x0f;
    more = 2;               // Expect 2 more bytes
      } else if ((b & 0xf8) == 0xf0) {      // 11110xxx (yields 3 bits)
    sumb = b & 0x07;
    more = 3;               // Expect 3 more bytes
      } else if ((b & 0xfc) == 0xf8) {      // 111110xx (yields 2 bits)
    sumb = b & 0x03;
    more = 4;               // Expect 4 more bytes
      } else /*if ((b & 0xfe) == 0xfc)*/ {  // 1111110x (yields 1 bit)
    sumb = b & 0x01;
    more = 5;               // Expect 5 more bytes
      }
      /* We don't test if the UTF-8 encoding is well-formed */
    }
    return sbuf.toString() ;
  } 
```

但解码不会将其更改回原始特殊字符。

有任何想法吗？

提前致谢

更新：我尝试添加这两个语句来获取请求

```
String itemdescription = URLDecoder.decode(request.getParameter("itemdescription"), "UTF-8");
        String itemshortdescription = URLDecoder.decode(request.getParameter("itemshortdescription"), "UTF-8");
        System.out.println("processRequest | short descrip "); 
```

如果有帮助，这也将失败。

UPDATE2：我创建了一个 html 表单并使用编码的 itemdescription 进行了直接插入，例如

并且插入与特殊字符和所有内容都可以正常工作。我想我的 javascript 提交出了点问题。对此有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-04T03:13:42.730

看起来您在 javascript 中构建的 url 没有正确地将 itemdescription 设置为请求参数。itemdescription 应以“？”为前缀 字符，因为它是 url 查询字符串中的第一个参数。这应该有效：

```
var tempUrl = "\AInsert";

tempUrl +=  "?itemdescription="+itemdescription+"&"+"itemshortdescription="+itemdescription.substring(0,37)+; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T16:02:24.930

如果您使用的是 PreparedStatement，为什么不使用绑定变量？

插入 itemdescription (longdesc) 值 ('SMARTNET%^" 8X5XNBD')

应该

```
PreparedStatement ps = conn.prepareStatement("INSERT INTO itemdescription (longdesc) values(?)");
ps.setString(1, itemdescription);
ps.executeUpdate(); 
```

# sqlanywhere - SQLAnywhere：Watcom SQL 或 T-SQL

> ID：945544
> 
> 赞同：5
> 
> 时间：2009-06-03T15:56:25.193
> 
> 标签：sqlanywhere

一个普遍的问题。我正在为 Sybase SQL Anywhere 10 进行开发。出于向后兼容的原因，我们几乎所有的存储过程都是用 Transact-SQL 编写的。使用 T-SQL 代替 Watcom 方言有什么优点或缺点吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-03T17:24:36.857

TSQL 的优点：

*   与 Sybase ASE 和 Microsoft SQL Server 更好的兼容性

TSQL的缺点：

*   某些语句和功能仅在 Watcom-SQL 过程中可用。一些例子：
    *   在 Watcom-SQL 中更好地控制 EXECUTE IMMEDIATE 行为
    *   LOAD TABLE、UNLO​​AD TABLE、REORGANIZE（以及其他）仅在 Watcom-SQL 中可用
    *   用于循环查询结果并自动声明变量以包含值的 FOR 语句非常有用，但在 TSQL 中不可用
*   错误报告不太一致，因为假设 TSQL 过程处理自己的错误，而 Watcom-SQL 过程立即报告错误。Watcom-SQL 过程可以包含一个 EXCEPTION 子句来处理错误
*   语句不使用分号分隔，因此 TSQL 过程更难解析（和读取）。语法错误有时可能无法指向错误的实际位置
*   无法显式声明过程的结果集
*   不支持 TSQL 中的行级触发器
*   事件处理程序只能使用 Watcom-SQL 编写

SQL Anywhere T-SQL 兼容性文档[可在线获取](http://dcx.sybase.com/index.php#http%3A%2F%2Fdcx.sybase.com%2Fhtml%2Fdbugen10%2Fug-tsos.html)。有一些[数据库选项](http://dcx.sybase.com/index.php#http%3A%2F%2Fdcx.sybase.com%2Fhtml%2Fdbugen10%2Fug-thdbop.html)可以更改行为以更接近您对 Sybase ASE 的期望。此外，还有一些[函数](http://dcx.sybase.com/index.php#http%3A%2F%2Fdcx.sybase.com%2Fhtml%2Fdbugen10%2Fug-tstr.html)可用于从一种语法转换为另一种语法。

请注意，如果您想开始将 Watcom 方言中的语句添加到现有存储过程中，则需要更改 SP 以使其完全以 Watcom 方言编写。您不能在 SP、触发器或批处理中混合语法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-03T17:15:32.627

KM 所说的——另一方面，“Watcom”方言更接近 ISO/ANSI 标准 SQL，因此方言更可能与其他一些产品相匹配，并吸引熟悉 SQL 标准的人。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T16:09:09.690

如果您曾经尝试移植到 SQL Server（或者您在 SQL Server 上找工作），Sybase T-SQL 非常接近 SQL Server T-SQL。Sybase 和 MS 在当天就加入了，所以这些语言的核心非常相似。

# c# - 如何在 ASP.Net 中确定上传图像的颜色模式

> ID：945545
> 
> 赞同：2
> 
> 时间：2009-06-03T15:56:38.297
> 
> 标签：c#, .net, image

我有一个 asp.net 页面，我让用户使用 FileUpload 控件上传图像文件。我允许他们上传 png、gif 和 jpeg 图像。我想限制他们可以上传的图像类型，特别是我只想允许他们上传在 RGB 上有颜色模式的图像。

如何在 .Net 中以编程方式检查上传文件的颜色模式？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-03T16:05:33.620

1) 将上传的文件加载到[System.Drawing.Image](http://msdn.microsoft.com/en-us/library/System.Drawing.Image.PixelFormat.aspx)对象中。

```
Image img = Image.FromStream( yourFileUpload.PostedFile.InputStream ); 
```

1a) 确保在此处处理任何异常，因为上传的文件可能不是图像。

2) 检查[Image.PixelFormat](http://msdn.microsoft.com/en-us/library/System.Drawing.Image.PixelFormat.aspx)属性。[PixelFormat](http://msdn.microsoft.com/en-us/library/System.Drawing.Image.PixelFormat.aspx)是一个有很多值的枚举，其中很多是 RGB。过滤掉你特别不想要的而不是过滤你想要的可能更有意义......格式是“每像素 RGB 16 位”、“每像素 RGB 32 位”、“索引” ， ETC。

# subsonic - 使用 Where() 时错误生成 SubSonic.SqlQuery

> ID：945546
> 
> 赞同：0
> 
> 时间：2009-06-03T15:56:38.907
> 
> 标签：subsonic

我使用的是 SubSonic 2.1 版。我正在尝试构建一个相对简单的查询，在其中我使用 UserId 作为参数获取用户的角色列表。（UserId 是一个字符串...）

```
SubSonic.SqlQuery sel = new SubSonic.Select().From(Data.Tables.Role).InnerJoin(Data.Tables.UserRole, Data.UserRole.Columns.RoleId, Data.Tables.Role, Data.Role.Columns.Id).InnerJoin(Data.Tables.User, Data.User.Columns.Id, Data.Tables.UserRole, Data.UserRole.Columns.UserId).Where("[dbo].[User].[Id]").IsEqualTo(userId); 
```

这会生成查询

SELECT [dbo].[Role].[Id], [dbo].[Role].[PID], [dbo].[Role].[Name] FROM [dbo].[Role] INNER JOIN [dbo]。 [UserRole] ON [dbo].[Role].[Id] = [dbo].[UserRole].[RoleId] INNER JOIN [dbo].[User] ON [dbo].[UserRole].[UserId] = [ dbo].[User].[Id] WHERE [dbo].[User].[Id] = @[dbo].[User].[Id]0

失败了。如果我将 Where 替换为 .Where(Data.User.Columns.Id) 这将生成查询

SELECT [dbo].[Role].[Id], [dbo].[Role].[PID], [dbo].[Role].[Name] FROM [dbo].[Role] INNER JOIN [dbo]。 [UserRole] ON [dbo].[Role].[Id] = [dbo].[UserRole].[RoleId] INNER JOIN [dbo].[User] ON [dbo].[UserRole].[UserId] = [ dbo].[User].[Id] WHERE [dbo].[Role].[Id] = @Id0

它在 Where 子句中使用 Role 表而不是 User 表。

这是一个错误，还是我做错了什么？这样做的正确方法是什么？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T18:00:36.497

这在 2.2 版中已修复 - 我建议升级。

# c++ - 如何使用非托管 C++ 获取 Windows 上已安装字体的列表？

> ID：945547
> 
> 赞同：1
> 
> 时间：2009-06-03T15:56:43.650
> 
> 标签：c++, windows

我已经探索了一下，到目前为止我已经找到了 EnumFontFamiliesEx(...)。但是，看起来这个函数用于返回给定字体的所有字符集（例如“Arial”）。

我不太清楚如何获取已安装字体的列表。任何帮助/建议将不胜感激。

先感谢您。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-03T16:13:28.507

你可以这样做：

```
LOGFONT lf;
lf.lfFaceName[0] = '\0';
lf.lfCharSet = DEFAULT_CHARSET;
HDC hDC = ::GetDC();
EnumFontFamiliesEx(hDC, &lf, (FONTENUMPROC)&EnumFontFamExProc, 0, 0);
ReleaseDC(hDC); 
```

然后定义一个回调函数：

```
int CALLBACK EnumFontFamExProc(
   ENUMLOGFONTEX *lpelfe,
  NEWTEXTMETRICEX *lpntme,
  DWORD FontType,
  LPARAM lParam
  )
{
    AfxMessageBox(lpelfe->elfFullName);

    //Return non--zero to continue enumeration
    return 1;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T16:10:42.077

您可能想看看[这里](http://www.codeguru.com/cpp/g-m/gdi/fonthandlinganddetection/article.php/c157)，因为那里的代码解释了如何使用`EnumFontFamiliesEx`来获取所有字体名称。

# tree - 这种有向无环图叫什么名字？

> ID：945551
> 
> 赞同：4
> 
> 时间：2009-06-03T15:57:32.230
> 
> 标签：tree, graph, graph-theory, nomenclature, directed-graph

也许它甚至不是一个 DAG，但是在我不确定给它取什么标题之后，它的命名是...

每个节点只能有 0 或 1 条路径 INTO 的数据结构的名称是什么？严格来说，这是一棵树吗？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-03T15:59:58.937

这是一棵有向树。像这样的普通树是无向的。

您的约束并不完全是树的定义方式（树的定义是任何两个顶点通过不超过一条路径连接），但它确实将您的图限制为有效的有向树。（除非您想使用需要统一向性的“有向树”的奇怪用法，我不能说这让我感兴趣。）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-03T16:16:40.270

还有其他限制吗？仅从您给出的那个我可以构建一个*不是*树的图。

A -> B -> A

如果添加图是非循环的约束，那么它将是一棵树。

# c++ - 是什么导致了 Solaris C++ 编译器中的“Fatal error in ccfe”编译错误？

> ID：945555
> 
> 赞同：1
> 
> 时间：2009-06-03T15:57:39.797
> 
> 标签：c++, solaris, compilation, compiler-errors

我从 C++ 编译器收到此错误消息：

> CC：ccfe 中的致命错误：分段错误（核心转储）

什么可能导致它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-03T16:00:21.340

我的用户堆栈限制非常低（1MB）。由于编译器是高度递归的，因此这个限制是不够的。在 solaris 中，用于显示和更改此限制的命令是 ulimt。其他内存限制（虚拟、堆）也可能导致此问题。

[http://forums.sun.com/thread.jspa?threadID=5389815&tstart=0](http://forums.sun.com/thread.jspa?threadID=5389815&tstart=0)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-11T15:46:01.357

我认为这个答案不太可能成为长期有用的资源。现在原始用户已经解决了他们的问题，也许这个问题应该退休了。（已删除？）否则，应该有人从论坛发布的信息中提取信息，并在此处以对人们普遍有用的方式对其进行总结。

# php - 如何使用php删除html中的回车？

> ID：945560
> 
> 赞同：0
> 
> 时间：2009-06-03T15:58:51.840
> 
> 标签：php, javascript, html, carriage-return

我正在使用一个 javascript 函数，该函数接收一些使用 php 包含的 html 代码。它不是 php 字符串中的 html，而是带有 .php 扩展名的 html 文件。

由于 html 代码作为参数发送给 js 函数，因此它不能包含回车符。问题是在一行中编写大块的 html 是很糟糕的，我希望有一个功能只是在发送内容之前擦除回车符。

有没有这种功能的来源？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-03T16:03:12.217

简单的

```
echo str_replace(array("\r\n", "\r", "\n"), null, $htmlCode); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T16:05:27.520

通过“用 PHP 构建它”，我假设您的意思是您正在构建一个包含相关 HTML 的字符串。

如果是这种情况，那么不将回车作为字符串的一部分就很简单了。

即，不要这样做：

```
foo =  "  this is my string
         and I have it on two lines"; 
```

而是这样做

```
foo = "" .
      " this is my string" .
      " and it's on one line "; 
```

当然，您可以使用 string.replace 函数，但是通过 concats 构建意味着您可以跳过该步骤。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T16:36:42.470

当您说“在 PHP 文件中”时，我假设您的意思是您正在编写`include()`一个看起来像这样的文件：

```
<html>
  <head><title>Foo</title></head>
  <body>
    <?php do_stuff(); ?>
  </body>
</html> 
```

如果是这种情况，您要查找的内容称为[Output Control](http://us3.php.net/manual/en/book.outcontrol.php)，它允许您在准备好之前阻止发送数据，或者将其捕获到字符串中以进行额外处理。要从包含的文件中删除回车符，您可以执行以下操作：

```
<?php

ob_start();                       // start buffering output
include("foo.php");               // include your file
$foo = ob_get_contents();         // get a copy of the buffer's contents
ob_clean_end();                   // discard the buffer and turn off buffering
echo str_replace("\r", "", $foo); // print output w/o carriage returns 
```

如果您还想删除换行符，请将最后一行更改为：

```
echo str_replace(array("\n", "\r"), "", $foo); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T16:04:03.323

这是一个简单的[字符串替换](http://php.net/str_replace)。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-06-03T16:22:13.047

如果这是您的 javascript 解析的内容，请考虑为此使用[XML编写器。](http://www.php.net/manual/en/book.xmlwriter.php)这样，结果将始终有效，并且代码应该变得更清晰。

# .net - .NET 单行日志记录 (ala Trace.Write/WriteLine) 使用 Instrumentation.Logging

> ID：945578
> 
> 赞同：0
> 
> 时间：2009-06-03T16:03:06.380
> 
> 标签：.net, logging, trace, instrumentation

我的问题是是否有可能获得 Trace.Write 和 Trace.WriteLine 方法的行/多行（非常不确定正确的术语）行为，但使用 .NET 2.0 中的 Microsoft Instrumentation Logging 框架。

期望的输出

```
Hello World!
Oh Hai. 
```

我目前拥有的

```
Trace.Write("Hello ");
Trace.WriteLine("World!");
Trace.Write("Oh Hai."); 
```

我更喜欢使用检测来记录，而不是使用 Debug.Trace 写入日志文件。

编辑：仪表日志记录是指在我的 App.config 中使用“loggingConfiguration”块并使用 Microsoft.Practices.EnterpriseLibrary.Logging.Logger.Write(LogEntry logEntry); 编写日志条目

例如，Microsoft.Practices.EnterpriseLibrary.Logging.Configuration.FlatFileTraceListenerData、Microsoft.Practices.EnterpriseLibrary.Logging、Version=2.0.0.0。

Ta，已知颜色

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T16:28:09.400

您是否尝试过在需要时在日志语句中附加**Environment.NewLine ？**

# perl - 是否可以使用 DBD::Oracle 在单个查询中执行多个语句？

> ID：945584
> 
> 赞同：2
> 
> 时间：2009-06-03T16:04:54.057
> 
> 标签：perl, oracle, security, sql-injection, dbi

我想知道是否可以在单个语句中执行多个 SQL 语句[`execute()`](http://search.cpan.org/dist/DBI#execute)或[`do()`](http://search.cpan.org/dist/DBI#do)使用[`DBD::Oracle`](http://search.cpan.org/dist/DBD-Oracle)via Perl调用[`DBI`](http://search.cpan.org/dist/DBI)。例子：

```
# Multiple SQL statements in a single query, separated by a ";"
$sql = 'UPDATE foo SET bar = 123; DELETE FROM foo WHERE baz = 456';

$sth = $dbh->prepare($sql);
$sth->execute;

# ...or...

$dbh->do($sql); 
```

我问这个不是因为我想真正做这样的事情，而是因为我想通过成功的 SQL 注入攻击来衡量可能造成的损害。是的，我知道，不管这个问题的答案如何，仍然必须从根本上消除 SQL 注入的可能性，只使用绑定值和受信任的输入等。但问题仍然存在：是否可以`DBD::Oracle`执行多个陈述？

作为一个相关示例，[`DBD::mysql`](http://search.cpan.org/dist/DBD-mysql/)有一个[`mysql_multi_statements`](http://search.cpan.org/dist/DBD-mysql/lib/DBD/mysql.pm#mysql_multi_statements)明确启用此“功能”的连接选项。我无法摆脱这样一种感觉，即有一些类似的、可能是未记录的和晦涩的 Oracle OCI 选项可以通过它以某种方式访问`DBD::Oracle`​​，从而实现相同的功能。

万一这很重要，这是：

*   `perl`5.8.8
*   `DBD::Oracle`1.22
*   甲骨文 11g (11.01.0700)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-03T16:11:23.090

如果 SQL 注入攻击成功，攻击者不能简单地重复它并以这种方式运行多个语句吗？

Oracle 支持可以包含多个语句的匿名 PL/SQL 块。

"开始立即执行'drop table customers'；执行立即'drop table sales'；结束"

Oracle 在此处提供了避免 SQL 注入攻击的免费教程：http: [//st-curriculum.oracle.com/tutorial/SQLInjection/index.htm](http://st-curriculum.oracle.com/tutorial/SQLInjection/index.htm)

# c# - JSON的C#自动属性反序列化

> ID：945585
> 
> 赞同：51
> 
> 时间：2009-06-03T16:04:57.300
> 
> 标签：c#, .net, json, serialization, automatic-properties

我需要将一些以 JSON 表示的 JavaScript 对象反序列化为适当的 C# 类。鉴于自动属性的良好特性，我更愿意将它们放在这些类中，而不是仅仅拥有字段。不幸的是，.NET 序列化引擎（至少在默认情况下）完全忽略了反序列化的自动属性，只关心支持字段，这显然不存在于 JavaScript 对象中。

鉴于[没有命名支持字段的标准方法，](https://stackoverflow.com/questions/371398/problems-with-auto-properties)老实说，我什至不想打扰“让我们创建一个看起来像它具有 C# 支持字段的 JavaScript 对象”方法，因为这听起来有点脏，这是唯一的方法如果我可以强制序列化引擎以某种方式忽略支持字段并直接使用该属性，我可以将 JavaScript 字段序列化为 C# 自动属性。不幸的是，我无法弄清楚这是如何完成的，或者这是否可以完成。任何想法，将不胜感激。

**编辑**：这是一个例子：

Javascript：

```
function Cat()
{
    this.Name = "Whiskers";
    this.Breed = "Tabby";
}
var cat = new Cat(); 
```

然后将其序列化为“{Name: 'Whiskers'}”。

C# 类：

```
[Serializable()]
public class Cat
{
    public string Name { get; set; }
    public string Breed { get; set; }
} 
```

以及失败的反序列化代码：

```
new DataContractJsonSerializer(typeof(Cat)).ReadObject(inputStream); 
```

从异常中可以明显看出它失败是因为它正在寻找支持字段。

**EDIT2**：这是例外，如果有帮助（没有内部例外）：

> System.Runtime.Serialization.SerializationException
> 
> “无法反序列化数据协定类型‘Test.Cat’，因为`<Name>k__BackingField, <Breed>k__BackingField`找不到所需的数据成员‘’。”

* * *

## 回答 #1

> 赞同：83
> 
> 时间：2009-06-03T17:38:33.827

这里发生的是反序列化器试图猜测您的支持字段的名称。您可以通过添加显式映射（DataContract/DataMember 属性）来解决此问题，如下所示：

```
[DataContract]
public class Cat
{
    [DataMember]
    public string Name { get; set; }

    [DataMember]
    public string Breed { get; set; }
} 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-06-03T16:20:59.333

您可以通过`JavaScriptSerializer`在命名空间中找到来执行此操作`System.Web.Script.Serialization`：

```
JavaScriptSerializer serializer = new JavaScriptSerializer();
Cat c = serializer.Deserialize<Cat>(jsonString); 
```

我有具有自动属性的 POCO 对象，这很好用。

编辑：我写了关于.NET 中[的 JSON 序列化](http://aleembawany.com/2009/05/22/json-serializers-in-net/)器的文章，它将这个序列化器与 .NET 进行了比较`DataContractJsonSerializer`。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-01-29T12:56:16.337

[baretta 的回答](https://stackoverflow.com/questions/945585/c-automatic-property-deserialization-of-json/946088#946088)为我解决了 k__BackingField 膨胀问题。只是一个小小的附录，您可以装饰这个类以类似的方式自动序列化为 XML 或 JSON：

```
[Serializable, XmlRoot, DataContract]
public class Cat
{
  [XmlElement]
  [DataMember]
  public string Name { get; set; }
  [XmlElement]
  [DataMember]
  public string Breed { get; set; }
} 
```

...然后使用 DataContractJsonSerializer 或 XmlSerializer 为您的端点准备它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-03T16:38:01.253

我假设您通过 Web 服务传递数据。如果您使用未注释掉 ScriptMethod 属性的 WebService 类，则 Web 服务方法可以原生读取 JSON。他们甚至使用上面提到的相同的 JavaScriptSerializer。如果您使用的是 WCF，我对逻辑有点模糊。

但请确保您的 JSON 对象为您的类中的每个属性返回数据。在您的错误中，提到了您的示例中没有的 Breed 属性。

此外，在 JavaScript 方面，由于 JavaScript 的动态特性，很容易向对象添加新属性。这有时会导致循环引用。您应该删除您可能添加的任何额外数据（就像您通过网络方法发送数据一样，然后在完成后再次添加）。

# sifr - sIFR 不适用于禁用的 Cookie

> ID：945587
> 
> 赞同：0
> 
> 时间：2009-06-03T16:05:16.863
> 
> 标签：sifr

sIFR 在浏览器中运行良好，除非 cookie 被禁用。当 cookie 被禁用时，网站似乎开始在刷新时加载，但随后很快变成空白屏幕，没有任何内容，页面源中也没有标记。我试过使用预取来解决，但没有成功。有没有其他人遇到过类似的问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-07T20:13:27.047

前几天我收到一封电子邮件，询问了一个非常相似的问题，该问题`sIFR.activate()`是从内部调用的`$(document).ready()`，如果禁用 cookie，它将中断。由于各种原因`sIFR.activate()`必须直接调用。

我不确定这是否适用于问题中描述的情况，但巧合很有趣。

# visual-studio-2008 - VS2008 和 Crystal Reports - 部署限制？

> ID：945591
> 
> 赞同：1
> 
> 时间：2009-06-03T16:05:59.313
> 
> 标签：visual-studio-2008, deployment, crystal-reports

我正在寻找将 Crystal 报表（基本版本，与 VS2008 捆绑在一起）部署到生产环境中的经验。

有什么限制吗？它是否限制并发用户的数量？除了在生产服务器上下载和安装 CRRedist2008_x86.msi，还有什么需要担心的吗？

（从这里和其他地方的评论来看，是的，最好找到另一种解决方案，但除非有适用于 VS2008/IIS6 的免费软件，否则我们现在只能坚持使用它）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T23:36:36.007

迟早你会被介绍到“已达到系统管理员配置的最大报表处理作业限制”。错误。您可以通过更频繁地循环站点的应用程序池来绕过它，但如果它被大量使用，您最终会想要查看 Crystal Enterprise Server。

# nant - 在 NANT 中创建自定义 WHILE 循环

> ID：945595
> 
> 赞同：3
> 
> 时间：2009-06-03T16:07:03.307
> 
> 标签：nant

我已尽力创建自定义 while 循环，但徒劳无功。有没有人成功地在 NANT 中创建自定义 while 循环？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2011-04-13T16:05:10.987

您可以创建自定义任务：

```
 <target name="sample">
    <property name="foo.value" value="0"/>
    <while property="foo.value" equals="0">
      <do>
        <echo message="${foo.value}"/>
        <property name="foo.value" value="${int::parse(foo.value) + 1}"/>
      </do>
    </while>
  </target>

  <script language="C#" prefix="directory">
    <code>
      <![CDATA[
[TaskName("while")]
public class WhileTask : TaskContainer
{
    private TaskContainer _doStuff;
    private string _propertyName;
    private string _equals;
    private string _notEquals;

    [BuildElement("do")]
    public TaskContainer StuffToDo
    {
        get
        {
            return this._doStuff;
        }
        set
        {
            this._doStuff = value;
        }
    }

    [TaskAttribute("property")]
    public string PropertyName
    {
        get
        {
            return this._propertyName;
        }
        set
        {
            this._propertyName = value;
        }
    }

    [TaskAttribute("equals")]
    public string Equals
    {
        get
        {
            return this._equals;
        }
        set
        {
            this._equals = value;
        }
    }

    [TaskAttribute("notequals")]
    public string NotEquals
    {
        get
        {
            return this._notEquals;
        }
        set
        {
            this._notEquals = value;
        }
    }

    protected override void ExecuteTask()
    {
        while (this.IsTrue())
        {
            this._doStuff.Execute();
        }
    }

    private bool IsTrue()
    {
      if (!string.IsNullOrEmpty(this.Equals))
      {
          return this.Properties[this.PropertyName] == this.Equals;
      }
      return this.Properties[this.PropertyName] != this.NotEquals;
    }
}
    ]]>
    </code>
  </script> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-09-26T09:00:26.847

查看当前可用的 NAnt 任务列表，看起来**while**不再受支持（[http://nant.sourceforge.net/release/latest/help/tasks/](http://nant.sourceforge.net/release/latest/help/tasks/)）

所以我认为如何进行自定义while循环最简单和最有效的方法是递归。

例如，这样的事情：

```
<property name="count" value="120" />

<target name="wait">        
     <if test="${int::parse(count) > 0}" >
        <property name="count" value="${int::parse(count) - 1}" />

        <call target="wait"/>   
    </if>   
</target> 
```

问候，

马立克

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-15T14:41:00.283

这是另一个在 NAnt 中实现的简单而有效的 while 循环示例。

```
<?xml version="1.0"?>
<project name="whiletask" xmlns="http://tempuri.org/nant-donotuse.xsd">

  <script language="C#" prefix="loop">
    <code>
      <![CDATA[

    /// <summary>
    /// A while loop task. Will continuelly execute the task while the <c>test</c> is <c>empty</c> 
    /// or evalutes to <c>true</c>.
    /// </summary>
    [TaskName("while")]
    public class WhileTask : TaskContainer
    {
        private string _test;
        private TaskContainer _childTasks;

        /// <summary>
        /// The expression to test each iteration. If empty, then always evalutes to true (i.e. infinite loop.)
        /// </summary>
        [TaskAttribute("test", ExpandProperties = false)]
        public string Test
        {
            get { return _test; }
            set { _test = NAnt.Core.Util.StringUtils.ConvertEmptyToNull(value); }
        }

        /// <summary>
        /// Superficial to ensure the XML schema is rendered correctly for this task. It will get executed
        /// if tasks exist within it.
        /// </summary>
        [BuildElement("do")]
        public TaskContainer ChildTasks
        {
            get { return _childTasks; }
            set { _childTasks = value; }
        }

        /// <summary>
        /// Executes the while loop while the <c>test</c> evalutes to true or <c>test</c> is empty.
        /// </summary>
        protected override void ExecuteTask()
        {
            while (this.Test == null
                || bool.Parse(Project.ExpandProperties(this.Test, this.Location)))
            {
                if (this._childTasks != null)
                {
                    this._childTasks.Execute();
                }
                else
                {
                    base.ExecuteTask();
                }
            }
        }
    }

          ]]>
    </code>
  </script>

  <property name="i" value="0" />
  <while test="${int::parse(i) &lt;= 10}">
    <echo message="${i}" />
    <property name="i" value="${int::parse(i)+1}" />
  </while>

</project> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-02-03T15:16:28.950

有很多方法可以做到这一点。我写了一些类似于 Cao 的东西，它触发一个属性为真，所以条件可以像你喜欢的那样复杂，如果它是动态的，那么每个循环都会评估值，这在你调用函数时很方便，例如检查文件是否存在。我还添加了简单的中断和继续控件。它也可以作为没有属性的无限循环运行，当您希望退出大量条件时（在这种情况下使用带有中断/继续的 'if' 或 - 在我的情况下 - 我想运行一个任务直到它异常，然后处理失败或 trycatch 块。

这是一段 Nant 脚本，它显示了从 10 开始倒计时的两种方法：

```
<property name="greaterthanzero" value="${int::parse(count) > 0}" dynamic="true"/>

<property name="count" value="10" />
<while propertytrue="greaterthanzero" >
  <echo>CountDown = ${count}</echo>
  <property name="count" value="${int::parse(count) - 1}" />
</while>

<property name="count" value="10" />
<while>
  <if test="${int::parse(count) > 0}" >
    <echo>CountDown = ${count}</echo>
    <property name="count" value="${int::parse(count) - 1}" />
    <continue/>
  </if>
  <break/>
</while> 
```

这是我用来等到锁定文件被删除的真实示例：

```
<property name="count" value="0" />
<property name="lockfileexists" value="${file::exists(lockfile)}" dynamic="true"/>
<while propertytrue="lockfileexists" >
  <sleep seconds="1" />
  <property name="count" value="${int::parse(count) + 1}" />
  <if test="${count == '15'}" >
    <echo>Timed out after 15 seconds</echo>
    <break/>
  </if>
</while> 
```

这是任务代码：

```
 <script language="C#" prefix="loops">
<code>
  <![CDATA[

    public class LoopBreakException : Exception {}
    public class LoopContinueException : Exception {}

    [TaskName("break")]
    public class BreakTask : Task
    {
        protected override void ExecuteTask()
        {
            throw new LoopBreakException();
        }
    }

    [TaskName("continue")]
    public class ContinueTask : Task
    {
        protected override void ExecuteTask()
        {
            throw new LoopContinueException();
        }
    }

    [TaskName("while")]
    public class WhileTask : TaskContainer
    {
        [TaskAttribute("propertytrue")]
        public string PropertyName { get; set; }

        protected bool CheckCondition()
        {
            if (!string.IsNullOrEmpty(PropertyName)) 
            {
                try 
                {
                    return bool.Parse(Properties[PropertyName]);
                }
                catch (Exception ex) 
                {
                    throw new BuildException(string.Format("While Property '{0}' not found", PropertyName), Location);
                }
            }
            //for infinite loops
            return true;
        }

        protected override void ExecuteTask()
        {
            while (CheckCondition())
            {
                try
                {
                  ExecuteChildTasks();
                }
                catch (LoopContinueException)
                {
                  continue;
                }
                catch (LoopBreakException)
                {
                  break;
                }
            }
        }
    }
]]>
</code> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-03T19:54:12.227

如果没有其他信息，这里有一个关于创建自定义 NAnt 任务的[教程](http://blogs.geekdojo.net/rcase/archive/2005/01/06/5971.aspx)。

这篇文章的一个好处是作者建议了 2 种**调试**自定义任务的方法：

1.  将程序集（和 pdb）文件复制到 NAnt bin 目录。在包含任务源的 Visual Studio 中打开解决方案。放置断点。转到项目属性并打开调试页面。将调试模式更改为程序，将启动应用程序更改为 NAnt 可执行文件的路径（例如 C:\Program Files\NAnt\bin\NAnt.exe）。然后设置工作目录和/或命令行参数，以便 NAnt 获取您的构建文件。单击运行，然后离开。

2.  放置 System.Diagnostics.Debbugger.Break(); 在您要中断的行之前的代码中。重新编译项目并将程序集（和 pdb）复制到 NAnt bin 目录。当您运行 NAnt 脚本时，您应该会看到一个弹出框，要求您选择调试器。

[这里](http://www.atalasoft.com/cs/blogs/jake/archive/2008/05/07/writing-custom-nant-tasks.aspx)还有另一个教程。

[或者，你能用foreach](http://nant.sourceforge.net/release/latest/help/tasks/foreach.html)来表达你的问题吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-04T09:21:18.797

我自己创建了自定义任务。但是在 NANT 中使用嵌套循环似乎存在一些问题。

基本上我正在尝试使用嵌套循环。foreach 内的 while 循环或另一个 foreach 内的 foreach。但是在这两种情况下，循环都会执行当前目标和每次迭代调用当前目标的目标，而不是第二个循环内的主体。

问候

萨拉蒂

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-06-08T06:06:44.387

这是在 nant 中编写 WHILE 循环的一种方法，没有自定义任务或元素，`script`利用循环。`failonerror="false"``foreach`

```
 <property name="n" value="10000" /><!-- this would be inefficient if "n" is very large -->
    <property name="i" value="0" />
    <foreach item="String" in="${string::pad-right(' ', int::parse(n), ',')}" delim="," property="val" failonerror="false" >
        <if test="${int::parse(i) &gt; 3}"><!-- put our exit condition here -->
            <fail message="condition met, exit loop early" />
        </if>
        <echo message="i: ${i}" />
        <property name="i" value="${int::parse(i) + 1}" />
    </foreach> 
```

执行上述 WHILE 循环的输出如下。请注意，由于`failonerror="false"`调用`fail`不会终止脚本：

```
 [echo] i: 0
     [echo] i: 1
     [echo] i: 2
     [echo] i: 3
  [foreach] myscript.nant(24,18):
  [foreach] condition met, exit loop early

  BUILD SUCCEEDED - 1 non-fatal error(s), 0 warning(s) 
```

我将上面的 WHILE 循环基于我如何构建 FOR 循环，这是上面代码的略微简化版本：

```
 <property name="n" value="5" />
        <property name="i" value="0" />
        <foreach item="String" in="${string::pad-right(' ', int::parse(n), ',')}" delim="," property="val" >
            <echo message="i: ${i}" />
            <property name="i" value="${int::parse(i) + 1}" /> <!-- increment "i" -->
        </foreach> 
```

FOR 循环的输出如下所示：

```
 [echo] i: 0
     [echo] i: 1
     [echo] i: 2
     [echo] i: 3
     [echo] i: 4

 BUILD SUCCEEDED 
```

# asp.net - 详细信息视图行中的自定义控件呈现 (ASP.NET)

> ID：945602
> 
> 赞同：0
> 
> 时间：2009-06-03T16:07:57.210
> 
> 标签：asp.net, custom-controls, detailsview

在详细信息视图控件的其中一行中，我希望能够选择要在编辑模式下呈现的控件。基本上我必须在一种情况下呈现一个复选框，而在另一种情况下我必须呈现一个文本框。其他行是如何实现这一点，我是初学者，所以链接和代码片段会很有帮助？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T16:10:40.190

您可以挂钩到 dataviews Item 数据绑定事件，然后在运行时动态地将控件添加到该行。

使用此方法要注意的一件事是确保项目类型是项目或替代项目，而不是页眉或页脚项目。

自从我这样做以来已经有一段时间了（我已经做了一年的 winforms）。

我记得它就像

```
protected void OnDataViewItemDataBound(object sender, DataViewItemBoundEventArgs e)
{
    if (e.Item.ItemType == ListItemType.Item
        || e.Item.ItemType == ListItemType.AlternatingItem)
    {
        TextBox txt = new TextBox();
        txt.DataBindings.Add() // add a databinding here

        e.Item.Controls.Add(txt);
    }
} 
```

# perl - 我应该从 CGI.pm 迁移到 CGI::Simple 吗？

> ID：945613
> 
> 赞同：3
> 
> 时间：2009-06-03T16:10:02.013
> 
> 标签：perl, cgi

我刚刚在查找 CGI.pm 模块时注意到[CGI::Simple 。](http://search.cpan.org/dist/CGI-Simple)我应该改用 CGI::Simple 吗？它将通过我使用了八年的 CGI.pm 为我提供什么？我看到 CGI::Simple 不生成 HTML；我应该为此使用什么？它是否会像 CGI.pm 那样通过允许我使表单值保持不变而与 CGI::Simple 集成？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-03T16:16:20.847

我认为这可以归结为文档中的这一行：“在实际测试中，该模块的加载和运行速度大约是 CGI.pm 的两倍，具体取决于具体的任务。”

如果您不关心 CGI 程序的速度，我认为忽略此模块是安全的。如果您关心速度，我建议您先查看[CGI::Fast](http://search.cpan.org/dist/CGI.pm/CGI/Fast.pm)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-03T18:09:11.517

我很少使用[CGI.pm](http://search.cpan.org/~lds/CGI.pm-3.43/)的 HTML 生成工具。为此，我更喜欢[HTML::Template](http://search.cpan.org/~samtregar/HTML-Template-2.9/)，通常与[CGI::Application](http://search.cpan.org/~markstos/CGI-Application-4.21/)结合使用。CGI::Application 可以使用任何 $cgi 对象，在[对其构造函数的调用中](http://search.cpan.org/~markstos/CGI-Application-4.21/lib/CGI/Application.pm#new())指定。

我认为 CGI 仍然有它的位置。我喜欢[CGI::Simple](http://search.cpan.org/~andya/CGI-Simple-1.112/)因为它提供了一个干净的 OO 接口。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-19T13:32:13.360

我维护 CGI.pm 并帮助修补 CGI::Simple。我已经深入查看了这两个代码并对其进行了基准测试。我认为切换到 CGI::Simple 的好处微乎其微。您会在此过程中发现一些令人头疼的问题，例如处理需要更改的文件上传的语法不兼容。

我同意这里其他一些人的观点，如果你要前进，你应该超越这两者。我建议寻找与 PSGI 原生兼容的东西。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-03T17:17:13.403

我有点惊讶你还在使用 CGI。考虑一个更成熟的框架，例如 Catalyst/TT/DBIx 堆栈。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-04T22:49:42.780

CGI.pm 有一个很好的安装基础，大多数 perl 安装都有它，重构和略微最小化的 CGI::Simple 并没有真正为我做。我必须有一点，我最终需要 CGI.pm 来做某事并同时维护两者。

我发现 CGI 的 HTML 生成器作为一个很棒的工具来处理转义、编码和可靠的 HTML。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-04T21:37:31.507

您可以尝试 CGI::Simple 来处理新事物，否则会让睡狗撒谎。如果您的旧程序正在运行，请不要理会它们。:)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-08-31T10:31:44.163

当您似乎准备好迁移时，请停止编写脏旧的基于 CGI 的脚本。改用现代且干净的网络引擎，例如[Dancer](http://www.perldancer.org/)或[Mojolicious](http://mojolicious.org/)。

# ruby - Scala 的扩展性是否优于其他 JVM 语言？

> ID：945617
> 
> 赞同：42
> 
> 时间：2009-06-03T16:10:42.967
> 
> 标签：ruby, scala, twitter, scalability, jruby

这是我目前知道的唯一方法。理解它 Scala 使用 Java 虚拟机。我认为Jruby也是。Twitter 将其中间件切换到了 Scala。**他们能做同样的事情并使用 Jruby 吗？**

他们是否可以从 Jruby 开始，并且没有遇到导致他们从 Ruby 迁移到 Scala 的缩放问题？我不明白 Jruby 是什么吗？我假设因为 Jruby 可以使用 Java，它会在 Ruby 无法使用的地方进行扩展。

在这种情况下，这一切都归结为静态类型与动态类型吗？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-06-03T20:13:36.010

Scala 是“可扩展的”，因为库可以改进*语言，使扩展看起来像是语言的一部分。*这就是为什么演员看起来像语言的一部分，或者为什么 BigInt 看起来像语言的一部分。

这也适用于大多数其他 JVM 语言。它不适用于 Java，因为它对基本类型（Int、Boolean 等）、运算符、繁琐的语法进行了特殊处理，明确了语言中构建的内容以及库的内容等。

现在，Scala 比*JVM 上的*动态语言更具性能，因为 JVM 不支持它们。JVM 上的动态语言必须求助于反射，这非常慢。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-06-03T16:16:27.540

不，不是。这并不是说 JVM 具有某种魔力，并通过它的魔力使事情规模化。Scala 作为一种语言，旨在帮助人们编写可扩展的系统。它位于 JVM 之上几乎是偶然的。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-04T06:26:18.037

我真的不认为语言是这里最大的问题。Twitter 发展得非常快，这总是导致代码混乱。而且，如果您进行重写，那么使用不同的语言是一个好主意 - 这会阻止您再次构建自己的错误和/或“重用某些部分”。此外，Ruby 并不真正适用于 twitter 后端所做的那种繁重的数据处理。前端仍然是 Ruby，所以他们仍然使用它。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-07-31T11:43:38.597

您必须区分缩放的不同含义：

1.  随着硬件的成比例增加，每秒可以处理的请求数量增加
2.  扩展代码库而不使其变得混乱

Scala 在第一点上有所帮助，因为它编译为与 Java 非常相似的 Java 字节码，因此通常具有与 Java 相同的性能。我说“通常”，因为 Scala 在某些情况下，惯用的 Scala 会导致发生大量的装箱，而惯用的 Java 不会（这将在 Scala 2.8 中改变）。

性能当然不同于缩放。用 JRuby 编写的等效代码也可以扩展，但线的斜率会更陡 - 您需要更多硬件来处理相同数量的请求，但线的形状会相同。但从更实际的角度来看，性能会有所帮助，因为在添加核心或特别是服务器方面，您很少能以完美的线性方式进行扩展，并且具有更好的性能会减慢您必须添加容量的速度。

Scala 在第二点上有帮助，因为它有一个富有表现力的、编译时强制类型系统，并且它提供了许多其他方法来管理代码的复杂性，例如 mixin。您可以用任何语言编写意大利面条式代码，但 Scala 编译器会告诉您何时出现问题，而使用 JRuby，您将不得不完全依赖测试。我个人发现，对我而言，Python 在大约 1000 个密切相关的 LOC 处发生故障，我必须重构以大幅减少 LOC 或使结构更加模块化。当然，无论您的语言是什么，这种重构都是一个好主意，但有时复杂性是固有的。处理大量紧密耦合的 LOC 在任何语言中都不容易，但在 Scala 中比在 Python 中要容易得多，

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-06-03T17:02:03.313

Scala 是一种静态类型语言。JRuby 是动态类型的。这就是为什么 Scala 比 JRuby 快的原因，尽管两者都运行在 JVM 上。JRuby 必须在运行时完成大量工作（方法解析等），而 Scala 在编译时完成。不过，就其价值而言，JRuby 是一个非常快速的 Ruby 实现。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-06-09T19:00:05.873

可扩展性不是继承语言能力。你在谈论速度。

一个更好的问题是“为什么 Scala 比其他 JVM 语言（或者是）更快？”。正如其他人指出的那样，这是静态与动态语言的事情。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-06-03T22:16:16.417

[在这篇文章](http://unlimitednovelty.com/2009/04/twitter-blaming-ruby-for-their-mistakes.html)的评论中，Twitter 开发人员自己进行了一次有趣的讨论。他们评估了不同的选项并决定在 Scala 中实现后端，因为：它比 Ruby/JRuby 替代方案运行得更快，并且他们认为他们可以从静态类型中受益。

# iphone - iPhone 游戏开发套件/平台的主要商业选择是什么？

> ID：945618
> 
> 赞同：2
> 
> 时间：2009-06-03T16:10:47.460
> 
> 标签：iphone, toolkit

我希望进入（和其他所有人一样）iPhone 游戏开发业务。我已经编程了一段时间，但最近才涉足 Mac 开发领域，尽管自从我使用 Java 工作了一段时间以来，除了学习内存分配之外，学习 Objective-C 并没有什么大不了的。

由此，您可以放心地假设我不是在寻找“教我基本编程”引擎，我想要一个可以创建商业质量游戏的完全充实的引擎。

我感兴趣的一些事情：

*   好的文档 - 教程和演示 - API 是必须的
*   良好的支持 - 3-4 天内回复，明天不太可能关闭，英语代表
*   可扩展引擎 - 相当容易地向引擎添加新位或对其进行大量修改，而无需更改 1000 个不同的类
*   工作引擎——特别是因为我正在做的 iPhone 应用程序并不复杂，我希望大多数功能（动画、网络代码、基本碰撞检测等）都内置
*   合理的成本——这有点主观，所以我会定义：我希望每年不必支付超过 1000 美元的升级费用。初始成本可能高达 1500 美元（包括所有必需的包），但如果超过 1000 美元，我预计升级成本不会超过 500 美元。升级被定义为完整版本，而不是“内容”或“附加组件”。
*   可能会继续定期更新——我很欣赏一些公司对他们的代码进行质量测试，但我也很欣赏那些每 3 年发布一次以上代码的公司。我希望每 6 个月到一年进行一次升级或更新（免费或付费）
*   与 XCode 集成 - 使用 XCode 或全功能 IDE 运行引擎是一个巨大的优势。易于导入库因素在这里。

我感谢所有回应，尤其是那些来自经验之声的回应，这些回应会影响具有特定引擎的 iPhone 开发或具有支持的经验。如果您对某些东西为什么不好（如文档）有评论，请解释是什么让它变坏，以及什么是“好”的例子，以及为什么这是一个更好的选择。

我当然会在 Mac 上开发，所以兼容性是必须的。

**更新：**似乎提供最多的两个引擎是 Unity 和 Torque 引擎。除了价格差异之外，有人可以比较一下引擎的易用性吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-03T22:54:11.193

我在一月份对那里的情况进行了一次小型调查，并写了一篇关于它的帖子。从那时起并没有太大变化，所以我将向您推荐该帖子：

[http://ramin.firoozye.com/2009/01/02/building-games-for-the-iphone-and-other-platforms/](http://ramin.firoozye.com/2009/01/02/building-games-for-the-iphone-and-other-platforms/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T16:37:09.337

我认为目前唯一真正的选择是 Unity 游戏引擎。

[http://unity3d.com/unity/features/iphone-publishing](http://unity3d.com/unity/features/iphone-publishing)

缺点是它可能超出您的预算。Pro Engine 售价 1,400 美元，iPhone 售价 1,499 美元。

您可以使用 indi 许可证和基本的 iPhone，售价约为 399 美元。

我还没有使用 Unity，但在某些时候希望能够证明成本是合理的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-13T00:38:20.053

您可能对[cocos2d iPhone](http://www.cocos2d-iphone.com/)感兴趣。它最初是作为 python 2d 引擎编写的，然后被移植到 iPhone 上。尽管它可能无法达到您提到的每个要点，但值得考虑。该站点上有大量文档，以及下载附带的几个示例。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-01-18T23:04:22.733

不断更新的工具、引擎等列表：http: [//iphonedevdepot.com/](http://iphonedevdepot.com/)

# wcf - 如何使用 WSDL 文件创建 WCF 代理？

> ID：945620
> 
> 赞同：23
> 
> 时间：2009-06-03T16:11:04.557
> 
> 标签：wcf, wsdl

我有一个旧的 WSDL 文件，我想使用 WCF 与服务进行通信。

WSDL 是从 ASMX 生成的（我想但我不确定）。

与它通信所需的步骤是什么？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-06-03T16:12:19.457

右键单击您的项目，然后选择“添加服务引用”。指向 WSDL。单击“确定”。这应该就是全部了。

![在此处输入图像描述](https://i.stack.imgur.com/dZmcm.png)

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-06-03T16:13:18.490

使用 svcutil.exe 创建 WCF 代理来调用服务。详情[在这里](http://msdn.microsoft.com/en-us/library/aa751905.aspx "这里")。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-06-04T00:16:55.583

wsdl.exe 是创建代理的旧 Web 服务 (1.1) 方式。如前所述，首先要尝试的是“添加服务参考”。这使用 svcutil.exe 创建代理。如果您需要更多地控制代理的创建方式，可以从命令行使用 svcutil.exe 和各种开关。

话虽如此...我在使用较旧的 Web 服务 wsdls 时遇到了麻烦。特别是包含重载操作的旧 Apache AXIS Web 服务。请[在此处](https://stackoverflow.com/questions/799365/wcf-svcutil-generates-invalid-client-proxy-apache-axis-web-service-overload-op)查看我的帖子以获取完整的详细信息。（我的问题还没有解决。希望你不会遇到同样的问题，但如果你解决了，请回答我的问题。:)

# asp.net-mvc - 扩展 Asp.Net MVC 路由机制

> ID：945627
> 
> 赞同：3
> 
> 时间：2009-06-03T16:13:08.257
> 
> 标签：asp.net-mvc, asp.net-mvc-routing

我在 ASP.Net mvc 的路由机制中发现了一个限制，我正在尝试找到一种解决方法。

我在[这里](https://stackoverflow.com/questions/942593/issue-when-trying-to-route-a-path-that-ends-with-a)发布了一个关于我遇到的问题的相关问题。

问题的要点是路由以 . （句点）从不被默认路由机制处理。总是抛出“找不到资源”错误。例如它不能处理这些 url：

```
http://www.wikipediamaze.com/wiki/Washington,_D.C.
http://www.wikipediamaze.com/wiki/anythingendinglikethis. 
```

如果我将它更改为这样的查询字符串参数，它可以正常工作：

```
http://www.wikipediamaze.com/wiki/?topic=Washington,_D.C. 
```

我正在尝试在路由机制中找到一个可帮助我解决此问题的可扩展点。我尝试过其他类似的解决方案：

```
//Global.asax.cs
protected void Application_Error()
{
     var url = HttpContext.Current.Request.RawUrl;
     if(TopicRegex.IsMatch(url))
     {
         var fixedUrl = FixUrlPath(url);

         //This throws an error
         Response.Redirect(fixedUrl);

         //This also throws an error
         Server.Transfer(fixedUrl );
      }
} 
```

我猜 Response.Redirect 和 Server.Transfer 会抛出错误，因为在 MVC 中你应该从控制器调用 RedirectToAction 方法。当然，我*什至无法到达*控制器。

考虑到 Wikipedia 使用的 Apache 服务器可以很好地处理这个问题，这似乎是一个很大的限制。试试[http://en.wikipedia.org/wiki/Washington,_D.C.](http://en.wikipedia.org/wiki/Washington,_D.C.) 如果有人可以请在这里提供一些帮助，我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-08T09:41:38.747

您可以检查路径中是否存在文件但允许某些扩展名通过吗？

```
routes.RouteExistingFiles = true;

// Ignore the assets directory which contains images, js, css & html
routes.IgnoreRoute("Assets/{*pathInfo}");

// Ignore text, html, files.
routes.IgnoreRoute("{file}.txt");
routes.IgnoreRoute("{file}.htm");
routes.IgnoreRoute("{file}.html");
routes.IgnoreRoute("{file}.aspx"); 
```

# ruby-on-rails - 使用 Ruby on Rails 做（Igoogle/Pageflakes/netvibes）类应用程序的框架

> ID：945630
> 
> 赞同：2
> 
> 时间：2009-06-03T16:13:30.580
> 
> 标签：ruby-on-rails, frameworks, igoogle

任何人都有任何关于框架的建议，可以帮助我使用 ruby​​ on rails 创建 Igoogle/pageflakes/netvibes 之类的应用程序。

我尝试使用[apotomo](http://apotomo.de/)几天，但根本无法使用。

如果无法在 Rails 上使用 ruby​​，你对使用什么有什么建议吗？

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-11-13T17:55:11.087

现在，再试一次！那是给你的：

[如何使用 Apotomo 在 Rails 中制作仪表板](http://github.com/apotonick/dashboard_tutorial)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-20T21:14:10.903

对于 iGoogle 类型的门户，您可以检查 ExtJS。这是一个示例

[http://www.extjs.com/deploy/dev/examples/portal/portal.html](http://www.extjs.com/deploy/dev/examples/portal/portal.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-01-20T23:12:55.110

听起来您对后端比前端组件更感兴趣。目前似乎没有公开可用的 Rails 代码来跟踪用户的小部件，因此您必须自己制作。幸好你已经知道 Rails 了！

# wpf - 应用默认 WPF 样式

> ID：945633
> 
> 赞同：13
> 
> 时间：2009-06-03T16:14:04.073
> 
> 标签：wpf, styles

我有一个全局样式来设置我的所有`TextBox`样式，但在某些情况下，我只想将前景色恢复*为*原始的非自定义样式颜色。我尝试在我想要恢复`{TemplateBinding Foreground}`的特定内部使用。`TextBoxes`它最终不是有效的 XAML，我不确定这是否是正确的方式。

有任何想法吗？谢谢。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-03T16:35:04.360

有几种方法可以做到这一点。如果您查看 MSDN 上的[Precedence List](http://msdn.microsoft.com/en-us/library/ms743230.aspx)，则可以看到以 1-8 方式设置的 Forground 将覆盖`Foreground`默认样式。最简单的方法就是在`TextBox`.

```
<TextBox Foreground="Red" /> 
```

您可以做的另一件事是使用`'BasedOn'`样式的属性来覆盖其他版本。这确实需要为您的默认样式提供一个键值，但这也可以用于应用默认样式，如下例所示：

```
 <Style TargetType="{x:Type TextBox}"
           x:Key="myTextBoxStyle">
        <Setter Property="Foreground"
                Value="Red" />
        <Setter Property="FontWeight"
                Value="Bold" />
    </Style>
    <!-- Style applies to all TextBoxes -->
    <Style TargetType="{x:Type TextBox}"
           BasedOn="{StaticResource myTextBoxStyle}" />

<TextBox Text="Hello">
    <TextBox.Style>
        <Style BasedOn="{StaticResource myTextBoxStyle}" TargetType="{x:Type TextBox}">
            <Setter Property="Foreground"
                    Value="Blue" />
        </Style>
    </TextBox.Style>
</TextBox> 
```

**编辑：**
如果默认样式正在应用一个值并且您想将其恢复为基本值，我可以想到几种方法来获得这种行为。据我所知，您不能以通用方式绑定回默认主题值。

然而，我们可以做一些其他的事情。如果我们需要样式不应用某些属性，我们可以将样式设置为`{x:Null}`，从而停止应用默认样式。或者我们可以给元素它自己的样式，而不是从基本样式继承，然后只重新应用我们需要的设置器：

```
 <TextBox Text="Hello" Style="{x:Null}" />
        <TextBox Text="Hello">
            <TextBox.Style>
                <Style TargetType="{x:Type TextBox}">
                    <Setter Property="FontWeight"
                            Value="Bold" />
                </Style>
            </TextBox.Style>
        </TextBox> 
```

我们可以修改默认样式，以便仅在某些条件下设置 Foreground，例如 Tag 为某个值。

```
 <Style TargetType="{x:Type TextBox}"
           x:Key="myTextBoxStyle">
        <Setter Property="FontWeight"
                Value="Bold" />
        <Style.Triggers>
            <Trigger Property="Tag"
                     Value="ApplyForeground">
                <Setter Property="Foreground"
                        Value="Red" />
            </Trigger>
        </Style.Triggers>
    </Style>

   <TextBox Text="Hello" />
    <TextBox Text="Hello" Tag="ApplyForeground" /> 
```

# c - 为什么我可以通过指针强制转换来更改局部 const 变量，而不是 C 中的全局变量？

> ID：945640
> 
> 赞同：5
> 
> 时间：2009-06-03T16:15:03.623
> 
> 标签：c, pointers, constants

我想通过使用指针来改变常量的值。

考虑以下代码

```
int main()
{
    const int const_val = 10;
    int *ptr_to_const = &const_val;

    printf("Value of constant is %d",const_val);
    *ptr_to_const = 20;
    printf("Value of constant is %d",const_val);
    return 0;
} 
```

正如预期的那样，常量的值被修改了。

但是当我使用全局常量尝试相同的代码时，我得到了以下运行时错误。Windows 崩溃报告器正在打开。在打印此语句“*ptr_to_const = 20;”中的第一个 printf 语句后，可执行文件正在停止

考虑以下代码

```
const int const_val = 10;
int main()
{
    int *ptr_to_const = &const_val;
    printf("Value of constant is %d",const_val);
    *ptr_to_const = 20;
    printf("Value of constant is %d",const_val);
    return 0;
} 
```

该程序在 mingw 环境中使用 codeblocks IDE 编译。

谁能解释发生了什么？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-06-03T16:19:10.783

这是一个常数，无论如何您都在使用一些技巧来更改它，因此会导致未定义的行为。全局常量可能位于只读内存中，因此无法修改。当您尝试这样做时，您会收到运行时错误。

常量局部变量是在栈上创建的，可以修改。所以在这种情况下你可以改变常数，但它仍然可能导致奇怪的事情。例如，编译器可以在不同的地方使用常量的值而不是常量本身，因此“更改常量”不会在这些地方显示任何效果。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-03T17:38:10.740

它在只读存储器中！

基本上，您的计算机使用两级页表系统将虚拟地址解析为物理地址。伴随着宏大的数据结构而来的是一个特殊的位，表示页面是否可读。这很有帮助，因为用户进程可能不应该过度编写自己的程序集（尽管自修改代码有点酷）。当然，他们可能也不应该过度编写自己的常量变量。

您不能将“const”函数级变量放入只读内存，因为它位于堆栈中，它必须位于读写页面上。但是，编译器/链接器会看到您的 const，并通过将其放入只读内存（它是常量）来帮您一个忙。显然，覆盖这将导致内核的各种不愉快，内核将通过终止进程来消除对进程的愤怒。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-03T16:22:44.857

只有当您确定指向的变量最初是非常量（并且您恰好有一个指向它的 const 指针）时，在 C 和 C++ 中抛弃指针 const 才是安全的。否则，它是未定义的，并且取决于您的编译器、月相等，第一个示例也很可能会失败。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-03T16:50:13.437

您甚至不应该期望首先修改该值。根据标准，这是未定义的行为。全局变量和首先都是错误的。只是不要这样做:) 它可能会以另一种方式崩溃，或者同时发生本地和全局崩溃。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-08-08T04:49:05.413

这里有两个错误。第一个是：

```
int *ptr_to_const = &const_val; 
```

这是根据 C11 6.5.4/3的*约束违规（早期标准有类似的文本）：*

> **约束**
> 
> 涉及指针的转换，除了 6.5.16.1 的约束允许的情况外，应通过显式转换来指定

6.5.16.1 的约束不允许从`const int *`to的转换`int *`（可以在[此处](http://port70.net/~nsz/c/c11/n1570.html#6.5.16.1)查看）。

令人困惑的是，当一些编译器遇到约束冲突时，他们会写“警告”（甚至根本不写，取决于开关）并假装你在代码中写了其他东西，然后继续。这通常会导致程序的行为不符合程序员的预期，或者实际上不以任何可预测的方式运行。为什么编译器会这样做？打败了我，但它肯定会产生类似这样的问题源源不断。

* * *

gcc，似乎继续进行，就好像您已经编写了`int *ptr_to_const = (int *)&const_val;`.

这段代码不是违反约束的，因为使用了显式强制转换。然而，这给我们带来了第二个问题。然后该行`*ptr_to_const = 20;`尝试写入`const`对象。这会导致[未定义的行为](https://stackoverflow.com/questions/2397984/undefined-unspecified-and-implementation-defined-behavior)，标准中的相关文本在 6.7.3/6 中：

> 如果尝试通过使用具有非 const 限定类型的左值来修改使用 const 限定类型定义的对象，则行为未定义。

此规则是语义规则，而不是约束规则，这意味着标准不要求编译器发出任何类型的警告或错误消息。该程序是错误的，并且可能以荒谬的方式运行，并带有任何奇怪的症状，包括但不限于您观察到的情况。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-03T17:16:18.710

由于此行为未在规范中定义，它是特定于实现的，因此不可移植，因此不是一个好主意。

为什么要更改常量的值？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-08-18T15:49:17.230

*注意：这是为了回答[我们可以通过指针更改用 const 定义的对象的值吗？](https://stackoverflow.com/questions/3801557/can-we-change-the-value-of-a-constant-through-pointers)它作为重复链接到这个问题。*

`const`该标准对编译器必须如何处理构造指向对象的指针并尝试写入该对象的代码没有任何要求。一些实现——尤其是嵌入式的——可能具有有用的行为（例如，使用非易失性 RAM 的实现可以合法地将`const`变量放置在可写的内存区域中，但即使单元断电，其内容仍将保留，并且备份），并且标准对编译器如何处理创建指向内存的非`const`指针的代码没有要求这一事实`const`并不影响此类代码*在明确允许的实现上*的合法性。然而，即使在这样的实现中，替换以下内容可能是一个好主意：

```
volatile const uint32_t action_count;

BYPASS_WRITE_PROTECT = 0x55; // Hardware latch which enables writing to
BYPASS_WRITE_PROTECT = 0xAA; // const memory if written with 0x55/0xAA
BYPASS_WRITE_PROTECT = 0x04; // consecutively followed by the bank number
*((uint32_t*)&action_count)++;
BYPASS_WRITE_PROTECT = 0x00; // Re-enable write-protection of const storage 
```

和

```
void protected_ram_store_u32(uint32_t volatile const *dest, uint32_t dat)
{
    BYPASS_WRITE_PROTECT = 0x55; // Hardware latch which enables writing to
    BYPASS_WRITE_PROTECT = 0xAA; // const memory if written with 0x55/0xAA
    BYPASS_WRITE_PROTECT = 0x04; // consecutively followed by the bank number
    *((volatile uint32_t*)dest)=dat;
    BYPASS_WRITE_PROTECT = 0x00; // Re-enable write-protection of const storage
}
void protected_ram_finish(void) {}
...
protected_ram_store(&action_count, action_count+1);
protected_ram_finish(); 
```

如果编译器倾向于对写入`const`存储的代码应用不需要的“优化”，则将“protected_ram_store”移动到单独编译的模块中可以防止此类优化。它也可能会有所帮助，例如代码需要移动到使用其他协议写入内存的硬件。例如，某些硬件可能会使用更复杂的写入协议来最小化错误写入的可能性。拥有一个明确目的是写入“正常常量”内存的例程将使此类意图变得清晰。

# c# - 为什么 C# 中的这个 CRC32 实现这么慢？

> ID：945641
> 
> 赞同：5
> 
> 时间：2009-06-03T16:15:13.310
> 
> 标签：c#, .net, crc32

我正在使用以下函数来计算 VS2008、.NET 3.5 项目中文件的 CRC32：

```
public UInt32 ComputeHash(System.IO.Stream stream)
{
    unchecked
    {
        const int BUFFER_SIZE = 1024;

        UInt32 crc32Result = 0xFFFFFFFF;
        byte[] buffer = new byte[BUFFER_SIZE];
        int count = stream.Read(buffer, 0, BUFFER_SIZE);

        while (count > 0)
        {
            for (int i = 0; i < count; i++)
            {
                crc32Result = ((crc32Result) >> 8) ^ _crc32Table[(buffer[i]) ^ (crc32Result) & _LOOKUP_TABLE_MAX_INDEX];
            }
            count = stream.Read(buffer, 0, BUFFER_SIZE);
        }

        return ~crc32Result;
    }
} 
```

为简洁起见，我省略了构建查找表 (_crc32Table) 的函数。该表是一个 UInt32 的数组，在类实例化时构建，包含 256 个值（256 也是 _LOOKUP_TABLE_MAX_INDEX + 1 的值）。

我已经运行了一些基准测试，将其与 MD5CryptoServiceProvider 和 SHA1CryptoServiceProvider ComputeHash 函数进行比较，它们的速度要快得多。MD5 函数的速度是原来的两倍多，而 SHA1 哈希则快了大约 35%。有人告诉我 CRC32 很快，但这不是我所看到的。

我的假设有误吗？这是意料之中的还是这个算法有缺陷？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-03T16:51:32.140

您正在将您的代码与内置函数进行比较，并询问为什么它们更快。您需要做的是找到内置函数的来源。它们是如何工作的？看看有什么不同。

Betcha 内置函数调用本机库并通过不必在托管内存框架内运行来作弊。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-05-08T17:12:08.673

分析可能有助于确定 IO 调用（读取）与 CRC 计算所花费的时间。代码通常受 IO 限制。然而，作为一个在 C# 中实现了一个非常快的 CRC 函数的人，我可以给出一些关于为什么它会比 MD5 慢的指针。

*   您一次读取一个字节的内存。实现[slicing-by-4](http://create.stephan-brumme.com/crc32/#slicing-by-8-overview)，这样你一次可以读取 4 个字节，或者可能是 slicing-by-8，这样你就可以一次读取 8 个字节（但*前提*是代码实际上在 64 位模式下运行 - 你应该回退在 32 位模式下切成四倍，您应该使用 if(sizeof(IntPtr) < 8) 或类似方法进行测试。
*   您每次循环迭代处理一个字节，因此为每个字节支付循环开销。实施 N 切片，否则考虑展开循环。（两者都做可能是不必要的。）
*   每个字节都会发生两次数组边界检查。您可以使用“不安全”代码来避免边界检查。对于不安全的代码，您还应该确保对齐读取指针，尽管由于您只访问 .NET 数组，您可能会假设它们已经与机器字长对齐。请注意，不安全的代码是不安全的，所以要小心！
*   MD5 被设计为一种非常快速的算法，没有上面列出的问题。它一次读取多个字节并并行处理它们，并在非托管代码中实现。
*   这是次要的，但您的循环构造不是最佳的。既然您知道 count != 0，那么预先递减计数（即 --count）并与零进行比较的 do/while 循环比比较两个变量的 for 循环要好。使用您的代码，这将节省一些指令，并且可能会节省每字节读取的内存。

如果您实现按 N 切片，请将所有查找表打包到一个大表中，以便可以通过同一个指针访问它们。您还可以使用同一个表进行 4 切片和 8 切片。另请注意，典型的 N 切片实现假定特定的机器字节序，因此您可能需要一个单独的版本用于大字节序机器，您可以使用 BitConverter.IsLittleEndian 检查它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T16:41:41.780

也许：您在观察 CRC 吞吐量时是否计算了查找表的计算？通常，查找表计算一次并缓存。如果您不缓存它，您将在每次计算 CRC 时计算它。此外，如果您只测量一个 CRC，那么您可能已将表计算成本包含在 CRC 计算成本中。最好测量每个哈希的多次迭代。

* * *

**附录**：当我测量时，当应用程序使用 /debug+ 和 /optimize- 编译时，我看到了 2.6 倍的系数，将您的 CRC32 与 MD5 哈希值进行比较。使用 /debug- 和 /optimize+，我看到了 1.6 倍。当我更改编译标志时，绝对 MD5 性能没有变化。没有调试，CRC 仍然较慢，但更接近。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T17:11:06.110

我不太熟悉此代码执行时自动执行的优化，但如果分析不适用于您，您有几个选择。

我可以建议尝试不安全的代码并使用指针算法进行缓冲区 [i] 和 _crc32Table 查找，以防它尚未被优化。

我可以看到您遇到性能问题的唯一其他地方是 Stream.Read 调用。您是否尝试过不同的 BUFFER_SIZE 值？

如果它们没有被自动优化，使用更大的字节缓冲区并可能进行一些手动[循环展开也可以帮助您。](http://en.wikipedia.org/wiki/Loop_unwinding)

# database - 合并来自不同表的列的数据设计问题

> ID：945642
> 
> 赞同：1
> 
> 时间：2009-06-03T16:15:20.987
> 
> 标签：database, database-design, normalization

我有 2 个表：成员表和邮件列表表。

```
[Members] 
Username
Password
EmailAddress
MailingListOptIn [bit]
Planes [bit]
Boats [bit]
Cars [bit] 
```

*   水果列是用户偏好。

和

```
[MailingList]
EmailAddress
MailingListOptIn 
```

*   mailinglist'er 可以选择接收时事通讯，但不一定是会员

我想开始存储邮件列表的首选项。我的问题是合并这两个表数据的最佳方法是什么？

我已经尝试使用仅存储用户名、密码等成员信息的成员表和存储电子邮件地址和首选项的单独配置文件表。成员和邮件列表首选项都可以存储在此配置文件表中，但我无法添加 FK 约束，因为我无法添加邮件列表。

所以现在我的选择是：

1.  坚持使用 2 个表，但在邮件列表表上引入重复的“首选项”列。
2.  使用单一配置文件表和螺钉参照完整性。

或者也许还有另一种更好的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T17:20:21.763

```
CREATE TABLE Profiles (
 Username
 Password
 EmailAddress
 MailingListOptIn [bit]
 Planes [bit]
 Boats [bit]
 Cars [bit]
);

CREATE VIEW Members AS
  SELECT * FROM Profiles WHERE Username IS NOT NULL
  WITH CHECK OPTION;

CREATE VIEW MailingList AS 
  SELECT EmailAddress, MailingListOptIn, Planes, Boats, Cars
  FROM Profiles WHERE Username IS NULL
  WITH CHECK OPTION; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T16:21:11.550

I would do it like this:

i) a "person" table with the email address as key

ii) a "member" table, only members will have a record in this table, linked to "person" by emailaddress (also key in this table)

iii) a "mailingList" table, having a unique id for the mailingList, the description and maybe other fields

iv) a "mailingListSubscriber" table (a relationship) with the email address of the person and the id of the mailing list.

Sorry for adding tables but I think it's the minimal setting for adequate normalization given the requirements.

# javascript - 有没有办法通过网络检查机器上安装了哪些字体？

> ID：945644
> 
> 赞同：5
> 
> 时间：2009-06-03T16:15:55.650
> 
> 标签：javascript, jquery, css, fonts

有没有办法测试安装了哪些字体，或者我可以读出所有字体？我想在我们的产品中进行一项调查，看看我可以在我们的项目中使用哪些字体。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-03T16:37:41.893

有一个脚本可以用不同的字体渲染一堆 DIV，然后检查生成的 DIV 是否具有给定字体的正确尺寸。

[http://www.lalit.org/lab/javascript-css-font-detect](http://www.lalit.org/lab/javascript-css-font-detect)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-03T16:20:47.273

这是可能的，只要 Flash 可用。见[http://www.maratz.com/blog/archives/2006/08/18/detect-visitors-fonts-with-flash/](http://www.maratz.com/blog/archives/2006/08/18/detect-visitors-fonts-with-flash/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-04T10:48:58.680

从这个[问题](https://stackoverflow.com/questions/929537/all-about-choosing-the-right-font-for-a-website/931848#931848)中查看 jQuery 插件[FontUnstack](http://github.com/philoye/fontunstack/tree/master)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-03T16:28:40.303

这是[windows 和 mac 机器上最常见的字体列表（](http://www.ampsoft.net/webdesign-l/WindowsMacFonts.html)每个字体的图像比较）。我在选择要在项目中使用的字体时使用它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-04T10:43:13.373

没有万无一失的方法可以通过浏览器确定客户端计算机上已安装（和可用）的字体。

Flash 可能允许您执行此操作，或者可能是一些疯狂（但编写起来很有趣）的 JavaScript，它对具有给定字体的元素的大小做出假设 - 但无论考虑多少情况，此脚本都可能容易受到客户端设置差异的影响.

我强烈建议您反对您提议的调查/部署方法。您将做出一些不可能的决定 - 例如，可接受的可用性百分比是多少？如果是 100%，当出现没有此字体的新用户时，您会怎么做？如果不是，您有多少比例的用户对体验下降感到满意？

您是否考虑过 sIFR 或只是具有适当 alt 属性的图像元素？

如果您有特定的排版要求，可能值得关注：[http](http://blog.typekit.com/) ://blog.typekit.com/ 。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-07-13T10:54:31.403

您可以使用 Flash 获取安装在客户端操作系统中的字体列表：

```
var embeddedAndDeviceFonts:Array = Font.enumerateFonts(true); 
```

然后，您可以使用[ExternalInterface](http://www.adobe.com/livedocs/flash/9.0/ActionScriptLangRefV3/flash/external/ExternalInterface.html)在 Flash 和 Javascript 之间移动此信息。它不需要太多代码。

查看[我的博客文章](http://hasseg.org/blog/post/526/getting-a-list-of-installed-fonts-with-flash-and-javascript/)以获取更多信息和[演示实现](http://hasseg.org/stuff/fontList/example.html)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-03T16:25:31.770

没有好的方法可以做到这一点。虽然如果您有一个您想知道的字体列表，请创建一个具有始终存在的后备的类：

```
span#knownfont{font-family:Verdana, font-size:12px;}
span#font1{font-family:NonExistingFont1, Verdana, font-size:12px;}
span#font2{font-family:NonExistingFont2, Verdana, font-size:12px;} 
```

...

```
Then create HTML for each case:
<span id="knownfont">Lorem ipsum dolor sit amet</span>
<span id="font1">Lorem ipsum dolor sit amet</span>
<span id="font2">Lorem ipsum dolor sit amet</span> 
```

然后编写一个脚本来比较已知字体跨度和其他每个的宽度。如果宽度不同，则客户端上存在字体。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-03T16:26:08.510

我知道并非所有浏览器都支持它，但是这里描述的 css 中有 @font-face [，](https://developer.mozilla.org/en/CSS/@font-face)所以如果您知道您的用户在 IE 上（例如），您可以使用它来获取字体。

# tomcat - 是否可以在 J2EE - 过滤器中使用通配符？

> ID：945653
> 
> 赞同：2
> 
> 时间：2009-06-03T16:16:48.367
> 
> 标签：tomcat, servlet-filters

我想对多个 url 结尾应用过滤器。下一个配置似乎有效。

```
<filter>
    <filter-name>LanguageFilter</filter-name>
    <filter-class>filters.LanguageFilter</filter-class>
</filter>
<filter-mapping>
    <filter-name>LanguageFilter</filter-name>
    <url-pattern>*.do</url-pattern>
</filter-mapping>
<filter-mapping>
    <filter-name>LanguageFilter</filter-name>
    <url-pattern>*.xml</url-pattern>
</filter-mapping> 
```

最初我问是否可以使用通配符，例如：

```
 <url-pattern>*.do|*.xml</url-pattern> 
```

但这似乎是不可能的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T16:36:56.950

标准中没有这种运算符的概念，因此您需要两个映射。映射的规范在 servlet 规范中可用。有关链接和部分，请参阅[本文](https://stackoverflow.com/questions/26732/invalid-url-pattern-servlet-mapping-in-tomcat-6-0)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-04-27T21:49:41.633

你可以作弊一点，然后映射 / *。*到您的过滤器类，然后让您的过滤器实现采用参数 where *.do|* .xml 被解析，尽管您的过滤器在技术上能够看到太多，但它会简单地检查您是否对其进行了额外的测试，是否进行了测试，以及过滤器或 noops。

# git - Git checkout：更新路径与切换分支不兼容

> ID：945654
> 
> 赞同：475
> 
> 时间：2009-06-03T16:16:52.517
> 
> 标签：git, git-checkout, remote-branch

我的问题与[切换分支时的致命 Git 错误](https://stackoverflow.com/questions/180064)有关。

我尝试使用命令获取远程分支

```
git checkout -b local-name origin/remote-name 
```

但我收到此错误消息：

> 致命：git checkout：更新路径与切换分支不兼容。
> 您是否打算签出无法解析为提交的“来源/远程名称”？

如果我手动创建一个分支然后拉出远程分支，它就可以工作，就像制作一个新的克隆并检查分支一样。

为什么它不适用于我使用的存储库？

* * *

## 回答 #1

> 赞同：745
> 
> 时间：2009-09-03T02:52:50.530

我相信当您尝试签出本地 git repo 尚不知道的远程分支时会发生这种情况。尝试：

```
git remote show origin 
```

如果您要签出的远程分支位于“新远程分支”而不是“跟踪的远程分支”下，那么您需要先获取它们：

```
git remote update
git fetch 
```

现在它应该可以工作了：

```
git checkout -b local-name origin/remote-name 
```

* * *

## 回答 #2

> 赞同：152
> 
> 时间：2009-10-23T17:52:54.947

替代语法，

```
git fetch origin remote_branch_name:local_branch_name 
```

* * *

## 回答 #3

> 赞同：47
> 
> 时间：2013-07-05T09:33:55.167

在尝试了我在这个线程中可以阅读的大部分内容但没有成功之后，我偶然发现了这个： [远程分支没有出现在“git branch -r”中](https://stackoverflow.com/questions/12319968/remote-branch-not-showing-up-in-git-branch-r/12320930#12320930)

原来我的 .git/config 文件不正确。在做了一个简单的修复后，所有的分支都出现了。

从

```
[remote "origin"]
    url = http://stash.server.com/scm/EX/project.git
    fetch = +refs/heads/master:refs/remotes/origin/master 
```

到

```
[remote "origin"]
    url = http://stash.server.com/scm/EX/project.git
    fetch = +refs/heads/*:refs/remotes/origin/* 
```

做到了

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2011-02-23T20:42:26.067

不确定这是否对您的问题有帮助或完全相关，但如果您尝试从远程存储库中仅获取和签出**单个**分支，那么以下 git 命令将起到作用：

```
url= << URL TO REPOSITORY >>
branch= << BRANCH NAME >>

git init
git remote add origin $url
git fetch origin $branch:origin/$branch
git checkout -b $branch --track origin/$branch 
```

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2011-07-11T20:33:32.230

以上都不适合我。我的情况略有不同，我的远程分支不在**origin**。但在不同的存储库中。

```
git remote add remoterepo GIT_URL.git
git fetch remoterepo
git checkout -b branchname remoterepo/branchname 
```

提示：如果您在以下输出中没有看到远程分支，`git branch -v -a`则无法检查它。

确认在 1.7.5.4 上工作

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2012-04-26T20:38:28.230

对我来说有效的是：

```
git fetch 
```

这会将所有 refs 拉到您的机器上，用于远程所有分支。那我可以做

```
git checkout <branchname> 
```

这非常有效。类似于最高投票的答案，但更简单一些。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-10-23T18:22:43.593

我怀疑没有名为 remote-name 的远程分支，但您无意中创建了一个名为 origin/remote-name 的本地分支。

您是否有可能在某些时候输入：

```
git 分支来源/远程名称

```

从而创建一个名为 origin/remote-name 的本地分支？键入此命令：

```
git checkout 来源/远程名称

```

你会看到：

```
切换到分支“origin/remote-name”

```

这意味着它实际上是一个错误命名的本地分支，或者

```
注意：移动到不是本地分支的“origin/rework-isscoring”
如果您想从此结帐创建一个新分支，您可以这样做
（现在或以后）再次使用 -b 和 checkout 命令。例子：
  git 结帐 -b

```

这意味着它确实是一个远程分支。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2011-09-19T00:34:59.387

这不是很直观，但这对我来说效果很好......

```
 mkdir remote.git & cd remote.git & git init
  git remote add origin $REPO
  git fetch origin $BRANCH:refs/remotes/origin/$BRANCH 
```

然后运行 ​​git branch --track 命令...

```
 git branch --track $BRANCH origin/$BRANCH 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2017-12-08T15:53:03.547

对我来说，我有一个错字，我的远程分支不存在

用于`git branch -a`列出远程分支

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-06-03T19:31:42.583

您的问题是否可以与其他 SO 问题[“结帐问题”](https://stackoverflow.com/questions/499316/git-plugin-for-hudson-checkout-problem)相关联？

即：与以下相关的问题：

*   旧版本的 Git
*   一个奇怪的签出语法，应该是：`git checkout -b [<new_branch>] [<start_point>]`， `[<start_point>]`指的是启动新分支的提交的名称，而`'origin/remote-name'`不是那个。
    （而[`git branch`](http://www.kernel.org/pub/software/scm/git/docs/git-branch.html)确实支持 start_point 作为远程分支的名称）

注意：[checkout.sh 脚本](http://github.com/git/git/blob/8c4e4ef0f575cd60fb4bb6a70305fcb0ed85da6a/git-checkout.sh)说的是：

```
 if test '' != "$newbranch$force$merge"
  then
    die "git checkout: updating paths is incompatible with switching branches/forcing$hint"
  fi 
```

就像语法 git checkout -b [] [remote_branch_name] 既重命名分支又重置新分支的新起点，这被认为是不兼容的。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2012-05-29T16:23:32.960

在获取了无数次之后，仍然没有出现添加的遥控器，尽管 blob 在池中。事实证明，无论出于何种原因，都不应该使用**--tags选项。**`git remote add`您可以手动将其从 .git/config 中删除，以使 git fetch 创建引用。

# javascript - .innerHTML 歌剧问题？

> ID：945656
> 
> 赞同：1
> 
> 时间：2009-06-03T16:17:52.640
> 
> 标签：javascript, cross-browser, opera

我正在尝试做：

```
document.getElementById("header-text").innerHTML = "something interesting"; 
```

它适用于除 Opera 之外的所有浏览器（我正在运行最新版本）。

浏览互联网时，我发现有人说 Opera 不支持 innerHTML。这听起来不对。

任何指针？

谢谢

**编辑**：这是我想要得到的 id

```
<div id="header-text" class="picture-text">
          <!--[if gt IE 5]>ugly hack<![endif]-->
          Some text generated server side
         <!--[if gt IE 5]>ugly hack<![endif]-->
</div> 
```

**Edit2**：我有同样的问题：

```
<div id="header-text" class="picture-text">
          Static text
</div> 
```

**编辑3**：

```
<body onload="intialize();">

function intialize() {
    operaHeaderFix();
}

function operaHeaderFix(){
    if(window.opera) {
        /*opera specific action*/ 
        document.getElementById("picture-line-wrapper").style.position="relative";
        document.getElementById("picture-line-wrapper").style.top="0px";
        document.getElementById("picture-line-wrapper").style.marginTop="-230px";
        document.getElementById("picture-line").style.padding="1px";
        document.getElementById("header-text").innerHTML = "<div style='margin:220px 0px 0px 20px;'>"+document.getElementById("header-text").innerHTML+"TEST</div>";
    }
} 
```

**Edit4**：如果我删除 if(window.opera)，它将在 FF 和 IE 中运行良好

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T16:22:30.893

***发现问题：***

包装节点未正确关闭。

```
<div att1="value" att2="value"
  <div id="header-text">...</div>
</div> 
```

AFAIK、FF 和 IE 礼貌地修复了标签……但 Opera 没有，因此子 DIV 并不是 DOM 中的真正元素。

* * *

应该可以正常工作。id 为“header-text”的元素是什么？您确定只有一个匹配项，并且它具有可编辑的内容吗？

您可以发布一些标记以便我们进行测试吗？

从 PPK 的网站来看，似乎没有任何 Opera 问题： [http ://www.quirksmode.org/dom/innerhtml.html](http://www.quirksmode.org/dom/innerhtml.html)

***更新：***在 XP 上的 Opera 9.6.4 中运行此代码对我来说效果很好。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>innerHTML test</title>
<script>
  function doIt(){
    document.getElementById("header-text").innerHTML = "something interesting";
  }
</script>
</head>
<body>
  <div id="header-text" class="picture-text">
    Static text
  </div>
  <input type="button" value="Change It" onclick="doIt();"/><br/>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-11-04T19:31:08.107

我遇到了一个有点相关的问题，发现它与 HTML 编码值有关。例如，当 innerHTML 包含“ ”时 而不是空格，innerHTML 会返回略有不同（我通过测试 innerHTML 的长度确认了这一点）。

这是我在尝试获取包含单个 DIV 的标签的 innerHTML 时发现的内容，该 DIV 包装了编码的不间断空格 (<div> </div>)：

```
<div> </div> 
```

上面的例子显示了 Opera 10.26 如何返回 innerHTML，当我检查长度时它会在 Opera 中返回 12

```
<div>&nbsp;</div> 
```

这就是我使用的所有其他浏览器返回 innerHTML（IE6/7/8、Firefox 3.x、Chrome 等）的方式，当我检查长度时，它会在所有其他浏览器中返回 17。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T16:24:41.410

编辑：你是如何调用这个函数的？你在文档中调用它`<head>`，在末尾`<body>`，你在使用`window.onload`吗？

`innerHTML`不是 w3c 有效的属性（它将在 HTML 5 中）。它是由 Microsoft 创建的，出于兼容性原因，*大多数其他浏览器都支持它。*

也就是说，我相信 Opera 确实支持`innerHTML`，但是一些谷歌搜索表明它[在某些版本中被破坏了](http://forums.digitalpoint.com/showthread.php?t=717637)。尝试更新您的 Opera 版本，然后看看它是否有效。

# asp.net - 我的 asp.net 控件丢失了它的属性值？

> ID：945657
> 
> 赞同：0
> 
> 时间：2009-06-03T16:18:25.543
> 
> 标签：asp.net, vb.net, controls

我正在为我的 asp.net 站点编写一个自定义用户控件，用于存储日期时间。它有两个属性：

```
 Private _includeTime As Boolean
    Private _value As DateTime = Nothing

    Public Property IncludeTime() As Boolean
        Get
            Return _includeTime
        End Get
        Set(ByVal value As Boolean)
            _includeTime = value
        End Set
    End Property

    Public Property SelectedDateTime() As DateTime
        Get
            Try
                _value = DateTime.Parse(txtDate.Text)
                If IncludeTime Then
                    _value.AddHours(Short.Parse(txtHour.Text))
                    _value.AddMinutes(Short.Parse(txtMinute.Text))
                    _value.AddSeconds(Short.Parse(txtSecond.Text))
                End If
            Catch ex As Exception
                _value = Nothing
            End Try
            Return _value
        End Get
        Set(ByVal value As DateTime)
            _value = value
        End Set
    End Property 
```

我以这种方式调用我的自定义控件：

```
<my:DateTimeInput runat="server" includetime="true" ID="txtWhen" /> 
```

这会正确设置 includetime 属性。

在我的后端代码中，我也在 page_load 上执行此操作：

```
txtWhen.SelectedDateTime = now 
```

当我使用调试器单步执行时，我看到属性被设置，但是当控件本身的 page_load 加载时，属性值被重置为空！

控件的page_load：

```
Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
    lbltime.Visible = IncludeTime

    If SelectedDateTime().CompareTo(Nothing) > 0 Then
        txtDate.Text = SelectedDateTime.Date.ToShortDateString()
        txtHour.Text = SelectedDateTime.Hour.ToString("D2")
        txtMinute.Text = SelectedDateTime.Minute.ToString("D2")
        txtSecond.Text = SelectedDateTime.Second.ToString("D2")
    End If

End Sub 
```

任何想法为什么这个属性会失去它的价值？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-03T16:57:16.970

您的控件的 Page_Load 方法使用 SelectedDateTime 属性而不是基础 _value 字段。

SelectedDateTime 属性的 Get 方法从 txtDate（和 txtHour 等）的内容重建 _value。因此，无论您将 _value 设置为什么，SelectedDateTime 属性都会返回文本框中的内容，我认为这没什么，因为页面只是在加载。

我建议你改变

```
If SelectedDateTime().CompareTo(Nothing) > 0 Then 
```

到

```
If _value.CompareTo(Nothing) > 0 Then 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T16:26:30.163

问题是“ ”访问器将文本框内容写入变量`get`之上。`_value`

* * *

还：

每次执行新的回发时，您都在使用该控件所在的页面类的新实例，因此是控件本身的新实例 *。*

如果您希望控件的值在回发中保持不变，则必须将它们放在可以在回发中保留的位置，例如会话或视图状态。

# properties - Share properties among multiple classes

> ID：945658
> 
> 赞同：1
> 
> 时间：2009-06-03T16:18:47.227
> 
> 标签：properties, shared

I've a class with few properties A, B, C. I consider this as an input object as I use this in the logic to run some rules based on the values of these properties. Now, after running the rules, I created another class as an output with the same properties and with same values in addition to few other properties specific to the output.

Now, my question is how do I share these properties (A, B, C) among both the input and output classes without having to assign the value from input to the output manually. Can you suggest me an effective design I need to use? Is the abstract class concept comes into picture here? Or is there any other effective way?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T16:22:45.810

Use an intermediate class that only has the properties and then access the instance of that class from your input and output objects, however in most instances it would be simpler to copy the values from your input to your output.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T16:25:37.947

Did you considered to use [singleton](http://en.wikipedia.org/wiki/Singleton_pattern) design pattern? I'm not familiar with specification of your project, but seem like it can help you or at least will give you direction.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T16:28:07.980

您可以像这样在输出类上定义一个隐式运算符 (C#)：

```
public static implicit operator OutputClass(InputClass m) 
{
   this.A = m.A;
   this.B = m.B;
   this.C = m.C;
} 
```

那么你所要做的就是：

```
output = input; 
```

并且您将有效地从输入中获取您想要在输出中的所有数据。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T16:29:14.610

选项 - 单例 - 有效，但取决于重用场景。您是否使用“new MyObj()”以外的任何类型的工厂或实例模式？如果是这样，工厂可以完成这项工作——这会导致下一个方法——注射。您的语言是否支持注入或某种（又名 - 弹簧）。您可以定义一个 setter 方法，但将其留给注入框架和/或工厂方法来处理/执行设置 - 再次取决于用例。

如果它基于运行时，您将需要使用组合 - 委托给原始对象的引用或中间对象（依次包装 A、BC 等）。

可能有点偏题，但我假设您的问题是一个简单的案例，只是为了获得一些针对更大问题的建议。

属性是动态编译时间还是运行时间？他们是否会改变（即处理来自数据库的动态更新）。您是否需要在测试工具或模拟值中运行，然后在完整应用程序的上下文中进行测试？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-03T16:33:01.473

在不知道更多的情况下，我认为继承和多态是要走的路：

```
class input 
{
   public int A { get; set;}
   public int B { get; set;}
   public int C { get; set;}
}

class output : input {
   public int D { get; set;}
   public int E { get; set;}
   public int F { get; set;}
} 
```

你做的很简单：

```
void main()
{
    output tpt = new output();
    tpt.A = 3;
    tpt.B = 2;
    tpt.C = 4;

    tpt = dosomething((input)tpt);
}

public output dosomething(input inpt)
{
    //blablabla
    output tpt = (output)inpt;
    tpt.D = 1;
    tpt.E = 2;
    tpt.F = 3;

    return tpt;
} 
```

# java - 我可以在启用所有日志记录和禁用所有日志记录的情况下自动执行 JUnit 测试用例吗？

> ID：945659
> 
> 赞同：6
> 
> 时间：2009-06-03T16:18:49.020
> 
> 标签：java, junit, code-coverage, logback, cobertura

*我找到了解决方案，请参阅下面的我自己的答案。有人有更优雅的吗？*

我想这样做以增加代码覆盖率并发现细微的错误。

假设要测试以下类：

```
public class Foo {
    private final Logger logger = LoggerFactory.getLogger(Foo.class);
    public void bar() {
        String param=[..];
        if(logger.isInfoEnabled()) logger.info("A message with parameter {}", param);

        if(logger.isDebugEnabled()) {
            // some complicated preparation for the debug message
            logger.debug([the debug message]);
        }
    }
} 
```

和以下测试类：

```
public class FooTest {
    @Test
    public void bar() {
        Foo foo=new Foo();
        foo.bar();
    }
} 
```

像 Cobertura 这样的代码覆盖工具将正确报告只有一些条件分支已被检查。

info 和 debug 为记录器激活或停用。

除了在您的覆盖范围内看起来很糟糕之外，这还带来了真正的风险。

如果 if(logger.isDebugEnabled()) 里面的代码有一些副作用怎么办？如果您的代码仅在启用 DEBUG 时才有效，并且在日志级别设置为 INFO 时惨遭失败怎么办？（这实际上发生在我们的一个项目中：p）

**所以我的结论是，包含记录器语句的代码应始终在启用所有日志记录的情况下测试一次，并在禁用所有日志记录的情况下测试一次......**

有没有办法用 JUnit 做类似的事情？我知道如何全局启用或禁用我在 Logback 中的所有日志记录，所以问题是：如何执行两次测试，一次启用日志记录，一次禁用日志记录。

ps 我知道[这个问题](https://stackoverflow.com/questions/265363/100-code-coverage-with-logging-code)，但我不认为这是重复的。我不太关心绝对覆盖率值，而是关心可能包含在 if(logger.isDebugEnabled()) 中的微妙、难以发现的错误。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-03T16:25:32.923

我已经通过实现一个基类来解决这个问题，如果需要这样的功能，测试类应该扩展该基类。

[编写参数化 JUnit 测试一](http://ourcraft.wordpress.com/2008/08/27/writing-a-parameterized-junit-test/)文包含了解决方案。

有关日志记录基类，请参阅[LoggingTestBase](http://apps.sourceforge.net/trac/sulky/browser/trunk/sulky-junit/src/main/java/de/huxhorn/sulky/junit/LoggingTestBase.java) ，有关使用它的简单示例，请参阅[LoggingTestBaseExampleTest 。](http://apps.sourceforge.net/trac/sulky/browser/trunk/sulky-junit/src/test/java/de/huxhorn/sulky/junit/LoggingTestBaseExampleTest.java)

每个包含的测试方法都会执行 3 次：

**1.**它像往常一样使用 logback-test.xml 中定义的日志记录执行。这应该在编写/调试测试时有所帮助。

**2.**它在启用所有日志记录并写入文件的情况下执行。该文件在测试后被删除。

**3.**它在禁用所有日志记录的情况下执行。

是的，LoggingTestBase 需要文档；）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-03T17:11:03.990

您是否尝试过简单地维护两个单独的日志配置文件？每个都将在根记录器的不同级别进行记录。

**禁用所有日志记录**：

```
...
<root>
    <priority value="OFF"/>
    <appender-ref ref="LOCAL_CONSOLE"/>
</root>
... 
```

**启用所有日志记录**：

```
...
<root>
    <priority value="ALL"/>
    <appender-ref ref="LOCAL_CONSOLE"/>
</root>
... 
```

执行将通过系统参数在类路径上指定不同的配置：

```
-Dlog4j.configuration=path/to/logging-off.xml
-Dlog4j.configuration=path/to/logging-on.xml 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-03T16:25:19.990

我建议从 JUnit 切换到 TestNG。TestNG 比 JUnit 有很多高级特性。它使您可以使用不同的配置多次运行测试，我想这就是您所需要的

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-03T17:24:04.580

eqbridge 建议使用不同的日志记录上下文简单地运行两次测试似乎是最简单的。您不必记住在每个有福的测试中编写逻辑代码，这是一个很大的优势。另一个是您可以很容易地看到应该归咎于哪个日志记录级别。

话虽如此，如果您只需要在一次测试中执行此操作，则有几种策略。

对于 3.8，我会将所有内容都放在套件中，并制作两个套件，每个套件用于每个日志记录级别，它在运行测试之前设置日志记录级别。这在功能上与使用不同的命令行参数运行整个测试套件两次是一样的，只是您只需运行一次即可。

在 JUnit 4.x 中，我想到了几个额外的选项：

一种是自定义跑步者。尽管我无法想出要完成这项工作所需要做的所有事情，但是实际上运行两次测试并使用 @RunWith 自定义运行程序注释测试的运行程序可以工作。

另一种是参数化测试。尽管您实际上必须设置每个测试以获取参数（这需要一个获取参数的构造函数），然后根据参数设置日志级别。

编辑：为了响应您对参数化测试的操作方法的请求，[这里](http://junit.org/apidocs/org/junit/runners/Parameterized.html)是运行器上的 javadoc 以帮助您入门，[这里](http://ourcraft.wordpress.com/2008/08/27/writing-a-parameterized-junit-test/)是一个更实用的指南。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-04T06:28:17.020

如果您觉得打开所有内容时日志记录过多，也许您可​​以尝试减少日志记录量。如果计算机产生的东西太多，更不用说人类阅读，它就不是很有用。

# java - 连接池环境中是否明确要求 statement.close()？

> ID：945662
> 
> 赞同：4
> 
> 时间：2009-06-03T16:19:40.300
> 
> 标签：java, sql, jdbc, connection-pooling

我在我的应用程序中使用连接池。我的问题是：

在连接池环境的情况下，是否明确要求在关闭连接之前关闭语句？

在连接池环境中，连接没有关闭，（但返回到空闲连接池）。我检查了 jdbc 4.0 功能规范。在第 9.4.4 点中，它明确指出：

> 关闭连接对象 应用程序调用 Connection.close 方法来指示它已完成使用连接。当调用对象的 close 方法时，从给定 Connection 对象创建的所有 Statement 对象都将被关闭。一旦一个 Connection 被关闭，除了 close、isClosed 或 isValid 方法之外的任何访问它的任何方法的尝试都将导致抛出 SQLException。

因此 jdbc 规范要求在关闭连接时关闭所有语句。那么它仅适用于非连接池环境还是也适用于连接池环境？

根据我的说法，在池化环境的情况下这无关紧要，因为我们正在为接口（`java.sql.Connection`& `java.sql.Statement`）编码。所以我们不关心实现，父类（`java.sql.Connection`）没有关于子/实现类（供应商实现类）的任何信息。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-03T16:21:03.127

绝对地。实现可能`Statement`会有其他应该释放的资源，或者与连接有其他关系。您不知道也不应该知道实现细节。

您的方法是绝对正确的：对界面进行编码并避免以后很容易咬到您的小“捷径”。（即使它现在可以工作，它也可能不会在池或连接类的未来版本中。）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-04T02:47:55.823

任何具有 close()、release()、destroy() 等的对象都会自动建议（当然您应该阅读 API 文档，可能有不同的名称用于此目的）该对象需要调用此方法来确保在对象不再使用时释放对象资源。如果对象可以自己做到这一点，则没有理由提供这样的方法。

在池化 java.sql.Connection 的情况下，连接并没有真正关闭，只是作为*可用*连接推回池中，但这是*内部的东西*，也就是*你不应该关心*的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-04T03:28:13.123

根据我的经验，一些 JDBC 驱动程序存在错误。如果您手动关闭所有语句（和结果集），它们似乎效果最好。否则，我看到了在连接关闭之后不应该持续存在的资源泄漏。

# c# - Can structs contain fields of reference types

> ID：945664
> 
> 赞同：69
> 
> 时间：2009-06-03T16:19:49.460
> 
> 标签：c#, struct, reference-type

Can structs contain fields of reference types? And if they can is this a bad practice?

* * *

## 回答 #1

> 赞同：101
> 
> 时间：2009-06-03T16:26:40.333

是的他们可以。这是个好主意吗？嗯，这取决于情况。就个人而言，我很少首先创建自己的结构......我会以一定程度的怀疑态度对待任何新的用户定义结构。我并不是说它*总是*错误的选择，只是它需要更多的明确论据而不是类。

但是，对于一个结构来说，引用一个可变对象是一个坏主意……否则你可以有两个*看起来*独立但不是的值：

```
MyValueType foo = ...;
MyValueType bar = foo; // Value type, hence copy...

foo.List.Add("x");
// Eek, bar's list has now changed too! 
```

可变结构是邪恶的。引用可变类型的不可变结构以不同的方式偷偷摸摸地邪恶。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-06-03T16:22:56.510

Sure thing and it's not bad practice to do so.

```
struct Example {
  public readonly string Field1;
} 
```

The readonly is not necessary but it is good practice to make struct's immutable.

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-06-03T16:25:47.870

是的，这是可能的，是的，这通常是一种不好的做法。

如果您查看 .NET 框架本身，您会发现几乎所有结构都单独包含原始值类型。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2011-02-11T14:03:06.830

您不能拥有可变结构的原因是引用类型的行为。阅读这篇文章：[http ://www.yoda.arachsys.com/csharp/parameters.html](http://www.yoda.arachsys.com/csharp/parameters.html)

当你有一个包含 Object 的结构（任何不是像 int 或 double 这样的原始数据）并且你复制该结构的一个实例时，里面的 Object 不会被“深度”复制，因为它只是一个引用（指针) 到包含实际类的内存位置。因此，如果您复制包含类实例的可变结构，则该副本将引用与原始实例相同的实例（因此上面的 bar 列表已更改）。

如果您绝对必须让结构是可变的，请将任何类实例设置为只读，或者 - 这是不好的做法 - 尽量确保您永远不会复制结构。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-03T16:21:15.810

Yes they can.

It depends.

Many hold the stance that a struct should be immutable, and in this case, holding a reference to an object could mean it isn't.

But it depends on the situation.

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-11-27T14:21:00.933

由于这得到了反对，我正在尝试重写一点，看看它是否可以变得更清晰。这个问题很老了；但是很好！我最近还遇到了一些详细说明此问题的链接。

我要补充的一点是，如果您*确实*声明了引用字段，那么您必须能够在自己的块*之外进行推理：当有人**使用*您的结构时。我添加的具体点实际上只是关于声明结构的只读字段；但在这种情况下，结构中的字段可以改变它们的结果；这很难推理。

我遇到了这个链接，程序员在其中声明了一个包含一个字段的*类。*`readonly` `struct`他的类中的*字段*是一个`struct`——它是一个`LinkedList<T>.Enumerator`——并且它破坏了，因为该字段是`readonly`——他自己的类方法获得了枚举器结构的副本，并且状态被复制而不是动态的。

**但是**，如果您继续通过简单地`readonly`从结构字段中删除来修复他的代码（这*有效*）；*但是*，如果您随后决定创建自己的类 a ，*那么*`struct`现在*您的*结构的使用者不能将其用作只读字段，否则他们反过来会被同样的问题所困扰。（如果这看起来是人为的，因为您没有只读枚举器，那么如果它支持重置，您实际上*可能会这样做！）*

 ***因此，如果这不是最清楚的例子，我想说的是你可以推理你自己的实现，但如果你是一个结构，你还需要*推理*复制你的价值的消费者以及他们会得到什么。

我找到的示例链接如下。

他的类不是 a `struct`，但确实包含 m_Enumerator 字段（并且程序员应该知道它*是*a `struct`）。

事实证明，此类的方法获得了该值的副本，并且不起作用。--- 你实际上可以非常仔细地检查*这个*块来理解这一点。

您*可以*通过使字段*not* `readonly`来修复它--- 这已经指向混乱。但是您*也*可以通过将字段声明为`interface`类型来修复它 --- `IEnumerator<int>`。

*但是*，如果您*确实*通过将字段声明为 the`struct`并且将其声明为 not来修复它`readonly`，*然后*选择将您的类定义为 a `struct`，那么*现在如果有人将**您* 的实例声明`struct`为`readonly`某个类中的字段，那么他们*又*输了！

例如：

```
public class Program
{
    private struct EnumeratorWrapper : IEnumerator<int>
    {
        // Fails always --- the local methods read the readonly struct and get a copy
        //private readonly LinkedList<int>.Enumerator m_Enumerator;

        // Fixes one: --- locally, methods no longer get a copy;
        // BUT if a consumer of THIS struct makes a readonly field, then again they will
        // always get a copy of THIS, AND this contains a copy of this struct field!
        private LinkedList<int>.Enumerator m_Enumerator;

        // Fixes both!!
        // Because this is not a value type, even a consumer of THIS struct making a
        // readonly copy, always reads the memory pointer and not a value
        //private IEnumerator<int> m_Enumerator;

        public EnumeratorWrapper(LinkedList<int> linkedList) 
            => m_Enumerator = linkedList.GetEnumerator();

        public int Current
            => m_Enumerator.Current;

        object System.Collections.IEnumerator.Current
            => Current;

        public bool MoveNext()
            => m_Enumerator.MoveNext();

        public void Reset()
            => ((System.Collections.IEnumerator) m_Enumerator).Reset();

        public void Dispose()
            => m_Enumerator.Dispose();
    }

    private readonly LinkedList<int> l = new LinkedList<int>();
    private readonly EnumeratorWrapper e;

    public Program()
    {
        for (int i = 0; i < 10; ++i) {
            l.AddLast(i);
        }
        e = new EnumeratorWrapper(l);
    }

    public static void Main()
    {
        Program p = new Program();

        // This works --- a local copy every time
        EnumeratorWrapper e = new EnumeratorWrapper(p.l);
        while (e.MoveNext()) {
            Console.WriteLine(e.Current);
        }

        // This fails if the struct cannot support living in a readonly field
        while (p.e.MoveNext()) {
            Console.WriteLine(p.e.Current);
        }
        Console.ReadKey();
    }
} 
```

如果你`struct`用一个`interface`字段声明 a，你将不知道里面有什么，但是当你简单地引用它时，你实际上可以更多地推断你得到了什么！这很有趣；但仅仅是因为语言允许这么多的自由`struct`：你需要从非常简单的事情开始；并仅添加您可以具体推理的内容！

还有一点是，该参考资料还说您*应该*将默认值定义为合理的；这在参考字段中是*不可能的！*如果您无意中调用了默认构造函数 --- 总是可以使用`struct`--- 那么您会得到一个空引用。

最后一点也是。许多人捍卫可变结构和大型可变结构。但是，如果您仔细观察，您通常会发现它们只是以一种允许它们对行为进行有限推理的方式来确定这些对象的范围，并且结构不会泄漏到这些不变量**可能**更改的范围内。

...太多人开始将结构解释为“就像一个类，但是... x、y、z、1、2、alpha、beta disco”。必须将其解释为几个只读值；时期; 除了现在你知道了一些东西，你就可以开始推理添加一些东西了！

我来的例子在这里：

[https://www.red-gate.com/simple-talk/blogs/why-enumerator-structs-are-a-really-bad-idea/](https://www.red-gate.com/simple-talk/blogs/why-enumerator-structs-are-a-really-bad-idea/)

# apache-flex - Dealing with asynchronous control structures (Fluent Interface?)

> ID：945666
> 
> 赞同：4
> 
> 时间：2009-06-03T16:20:26.620
> 
> 标签：apache-flex, silverlight, asynchronous, javafx, fluent-interface

The initialization code of our Flex application is doing a series of asynchronous calls to check user credentials, load external data, connecting to a JMS topic, etc. Depending on the context the application runs in, some of these calls are not executed or executed with different parameters.

Since all of these calls happen asynchronously, the code controlling them is hard to read, understand, maintain and test. For each call, we need to have some callback mechanism in which we decide what call to execute next.

I was wondering if anyone had experimented with wrapping these calls in executable units and having a Fluent Interface (FI) that would connect and control them.

From the top of my head, the code might look something like:

```
var asyncChain:AsyncChain = execute(LoadSystemSettings)
.execute(LoadAppContext)
.if(IsAutologin)
  .execute(AutoLogin)
.else()
  .execute(ShowLoginScreen)
.etc;
asyncChain.execute(); 
```

The AsyncChain would be an execution tree, build with the FI (and we could of course also build one without a FI).

This might be an interesting idea for environments that run in a single threaded model like the Flash Player, Silverlight, JavaFX?, ...

Before I dive into the code to try things out, I was hoping to get some feedback.

* * *

**Update 19/03/2010**: We have created an experimental Task API in the Spring ActionScript project that provides control over async processes. We'd be happy to get feedback. [http://www.springactionscript.org/docs/reference/html/the_operation_api.html#tasks](http://www.springactionscript.org/docs/reference/html/the_operation_api.html#tasks)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-02-25T23:03:10.140

我做过类似的事情，专门用于应用程序的初始化。但是，由于我们使用 Flex 开发大多数 Flash 应用程序，因此我在编写它时考虑了 MXML 的使用。

语法看起来就像声明一个数组（我只是在编造标签，但你明白了）：

```
<Initialize>
    <DisplayPreloader />
    <LoadConfiguration id="configurationLoader" source="foo.xml" />
    <ParseConfiguration source="{configurationLoader.result}" />

    <!-- ... --->
</Initialize> 
```

使用诸如 IMXMLObject 之类的接口，只需将其放入应用程序中就可以很好地工作，嘿，这就是您的初始化代码。当然，这不一定是为了初始化，它可以应用于任何地方。

**值得注意的优点：**

*   执行顺序直观，易于更改（只需向上或向下移动标签）
*   列表中的步骤并不真正关心其他步骤
*   数据可以通过使用绑定语法在步骤之间传递，促进依赖注入
*   正确封装的单任务步骤可以很容易地重复使用

**显着的缺点：**

*   MXML ==[尖括号税](http://www.codinghorror.com/blog/2008/05/xml-the-angle-bracket-tax.html)
*   如果多次触发，使用绑定传递数据可能会导致意外结果
*   应注意步骤遵循[单一职责原则](http://en.wikipedia.org/wiki/Single_responsibility_principle)，否则很容易变得过于复杂

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-02-19T09:22:01.733

你绝对可以做到这一点。您可以传递操作和延续函数，并威胁它们是异步调用和回调。这称为[继续传递风格](http://en.wikipedia.org/wiki/Continuation-passing_style)。这将需要将您的常规逻辑转换为函数调用序列。

直截了当的方法是引入一些封装异步调用的单子框架（[如在 Haskell 中）。](http://www.haskell.org/tutorial/monads.html)但是在将程序逻辑转换为 CPS 时，您仍然必须创建多个函数（回调）。请参阅： [Haskell 中的 CPS](http://en.wikibooks.org/wiki/Haskell/Continuation_passing_style)。但是语法很丑。Scheme 中有很好的语法，但这与 Scheme 计算模型密切相关：宏和可用于宏处理的库代码。

借助一些语言支持，您可以简化语法：例如 F# 中的计算表达式，完全是[async one](http://blogs.msdn.com/dsyme/archive/2010/01/09/async-and-parallel-design-patterns-in-f-parallelizing-cpu-and-i-o-computations.aspx)。引擎盖下与 Monad 概念密切相关。

高级事件驱动编程的另一个有趣想法是在[Reactive Extensions for .NET (Rx)](http://msdn.microsoft.com/en-us/devlabs/ee794896.aspx)中实现的。这个想法很简单：事件与列表非常相似。不同之处在于您不构造它们（基于推送的集合），而是从它们中获取下一个元素（基于拉取的集合）。相应地反转接口：而不是 IEnumerator 中的 MoveNext 和 Current，您将在 IObservable 中获得 OnNext、OnDone 和 OnError。然后，结合现有的 observables，您可以获得接近您建议的代码的东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-03-19T07:44:50.533

如果涉及到使用 Flex 并深入了解异步调用的流程，我会使用架构框架[Mate](http://mate.asfusion.com/)。正如 Api 所述：“Mate 的一个基本部分是 EventMap 标签，它允许您为应用程序创建的事件定义映射。它基本上是一个 IActionList 块的列表，其中每个块都匹配一个事件类型[..]”现在在每个 EventMap 中，您可以有几个逻辑上相互连接的异步服务器调用。整个事情都是基于 mxml 标记的，所以也是很容易阅读。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T17:21:19.140

由于您的函数必须是异步的，因此您不能让它们阻塞以等待下一个动作，因此它们所做的只是将一些代码存储在稍后将执行的结构中。

听起来很熟悉？简而言之，您正在编译一种语言并执行一个虚拟机。

这没有错，但是用正确的术语思考会让你搜索到正确的文献。例如，与其与您的内部结构争吵以便该`.else()`部分知道`.if()`它配对的是哪个，只需编写一个完整的解析器并将其与您的程序一起发送一个字符串。

还有很多关于编写简单虚拟机的例子

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-02-25T22:31:34.790

其中大部分是关于此类编程的非常有趣的讨论。它也是我们最常用语言中最薄弱的部分，在同步语言中表达异步逻辑非常痛苦。我相信延续是这里的答案，因为我们可以认为同步和程序同步，但很容易建模异步程序控制流。同步编程很容易理解，重用也很容易。一点也不异步。但是，直到世界赶上来……唉。

你的建议看起来很有趣，但我现在至少做过两次这种事情，而且从来都不满意。我认为您将很难在运行时评估您的 if 块。我一直遇到的问题是以干净的方式从一个步骤到另一个步骤获取数据。您将如何针对在一个步骤运行后可能不存在的值编写 if 语句。

如果我是你，我会考虑查看状态模式。状态模式对对象中的此类行为进行建模，并且可以异步执行转换。你也许可以像上面那样创建一个 Fluent 接口来创建状态。

我很想听听它是如何进行的，因为我现在正在我的 AIR 应用程序中做这个确切的事情，我只是对此感到满意。

# c - Passing a pointer to pointer to character into a function

> ID：945674
> 
> 赞同：2
> 
> 时间：2009-06-03T16:21:50.007
> 
> 标签：c

C99

I am using a pointer to pointer and passing it into a function to display the names.

However, when I go through the debugger. The pointer to pointer in the parameter points to nothing. However, I am using it to display all the names in main.

If I was passing an integer the integer value would still be there. Why not a pointer to pointer?

Does this have something to do with scope or do I need to allocate memory using malloc or calloc for the pointer to pointer?

Many thanks for any suggestions,

```
#include <stdio.h>

void display_names(char **first_names);

int main(void)
{
    char *names[] = {"peter", "Mary", "John", 0};
    char **print_names = names;

    while(*print_names)
    {
        printf("Name: %s\n", *print_names);
        *print_names++;
    }

    display_names(print_names);

    getchar();

    return 0;
}

void display_names(char **first_names)
{
    while(*first_names)
    {
        printf("First name: %s\n", *first_names);
        first_names++;
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-03T16:23:40.020

In your while loop, you loop until print_names points to nothing, and then you pass it to display_names. At this point, *print_names == 0\. Instead of that while loop, try:

```
char **print_names = names;
while(*print_names)
{
        printf("Name: %s\n", *print_names);
        *print_names++;
}
print_names = names;
display_names(print_names); 
```

This should print out the names twice - once from the while loop and once from the function call.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T16:18:30.263

```
char *names[] = {"peter", "Mary", "John", 0};
char **print_names;

int main(void)
{        
    print_names = &names[0]; // point to peter
    while(*print_names)
        printf("Name: %s\n", *(print_names++));  // last address in here is John

    print_names = &names[0];  // reset point to peter before call display_names
    display_names(print_names+0);   // peter
    display_names(print_names+1);   // Mary
    display_names(print_names+2);   // John

    getchar();
    return 0;
}

void display_names(char **names_selected)
{
     printf("Name: %s\n", *names_selected);    
} 
```

# asp.net - Approaches to overriding Google Analytics _trackPageView using ASP.NET

> ID：945676
> 
> 赞同：0
> 
> 时间：2009-06-03T16:22:21.987
> 
> 标签：asp.net, google-analytics

I'm working on a site that uses Google Analytics. On most of the pages the default call to _trackPageView() that records the page view in GA using the current URL works just fine. I can add that code to a master page so it is included on each page.

However, under certain circumstances I want to override the name of the page that gets recorded in GA. For instance I may have a single page that has multiple steps and want to record them as separate pages in GA. The _trackPageView method works fine for this but I'm not sure of the best way to incorporate it into ASP.NET. I don't want to handle the logic of rendering the call to _trackPageView on each page.

I'm thinking that I either expose a property on the master page (something like OverrideGAURL) that if present is inserted into the call to _trackPageView or wrap the GA script rendering into a user control that has a method or property exposed to override the default rendering.

Has any done something similar or have suggestions on the best way to approach this? My main goal is to encapsulate the GA script rendering and be able to override the page name with just one line of code in the code behind or by setting an attribute.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-04T21:08:41.860

我不是 ASP.NET 人，但使用`_trackPageView`生成额外的虚拟页面视图只能通过一种方式完成：使用适当的 URL 路径调用该方法。在包含多个步骤的页面上，您必须`_trackPageView`为每个步骤调用，如下所示：

```
pageTracker._trackPageView('/Page_name/Step2'); 
```

除此之外，您仍然需要`_trackPageView`标准跟踪代码中的原始调用。

请参阅*[如何跟踪 AJAX 应用程序？](http://www.google.com/support/analytics/bin/answer.py?hl=en&answer=55519)*在 Google Analytics 帮助中了解更多详细信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-01T01:39:11.863

最终创建了一个具有公共 PageName 属性的简单用户控件。如果设置了 PageName 属性，则调用 _trackPageView 并传递 PageName 值，否则不带任何参数调用 _trackPageView。

这种方法运行良好，并且通过从用户控件中的 web.config 读取它来管理环境之间的 GA 跟踪代码变得非常容易。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T18:08:54.157

您最好让 Google 使用多视图跟踪标准页面名称，如果您不希望它出现在您的报告中，只需使用 Google Analytics 过滤掉页面名称。然后，在每个视图中，只需将此脚本放入： pageTracker._pageView('/UniqueViewName'); 跟踪每个步骤，但您希望随后显示在您的内容中。

要了解过滤页面，请参阅：[https ://www.google.com/support/googleanalytics/bin/answer.py?answer=55593&hl=en_US&utm_id=ad](https://www.google.com/support/googleanalytics/bin/answer.py?answer=55593&hl=en_US&utm_id=ad)

# java - Java classes that implement the Serializable interface

> ID：945680
> 
> 赞同：4
> 
> 时间：2009-06-03T16:22:52.830
> 
> 标签：java, serialization

I need a list of classes that implement Serializable. Could you also tell me what kind of classes implement that interface?

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-03T16:30:08.417

在 Java API 中，大多数类都实现了 Serializable（[这里](http://java.sun.com/javase/6/docs/api/java/io/class-use/Serializable.html)是完整列表）。需要[序列化](http://en.wikipedia.org/wiki/Serialization)的类实现 Serializable。您可以使用 IDE 查找项目中接口的所有实现者。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T16:25:45.030

**You can find a full list of all implementing classes [Here](http://java.sun.com/javase/6/docs/api/java/io/class-use/Serializable.html).**

If you need to check programatically, you can use the `instanceof` operator to check to see if an object is an instance of the `Serializable` interface.

The list of subinterfaces is not a list of all classes that actually implement the interface.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-03T16:30:35.157

如果您使用 Eclipse，那么在任何地方您都会看到“Serializable”（例如在下面的类定义中）：

```
import java.io.Serializable;

public Foo implements Serializable {

} 
```

*   单击以`Serializable`使文本标记在单词中
*   点击控制+ T

这应该需要一分钟，因为这是一个如此流行的接口，但它会显示它可以在您的类路径中找到的所有实现`Serializable`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T16:41:49.610

有效地实现`Serializable`使类和子类成为公共 API 的一部分。通过单击Javadoc 输出中的[Serial Form](http://java.sun.com/javase/6/docs/api/serialized-form.html)链接，您至少可以看到一些可序列化的类。其中一些类不是公开的/受保护的（在 API 文档中，它们没有指向类文档的链接）。可序列化的匿名内部类似乎没有出现，尽管有一些`this$0`字段。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-03T16:51:28.193

快速的回答是：任何你想存储以备后用的类。

这包括诸如数据包装器（整数、字符串、字符等）、数据类和集合之类的东西。

但是，只有当集合中的项目可序列化时，集合才可序列化。

此外，还有第二个接口[Externalizable](http://java.sun.com/javase/6/docs/api/java/io/Externalizable.html)，由将其数据写入某种外部接口的类使用，只有对存储在序列化流中的所述项目的引用。

# web-applications - 从网站自动打印图像

> ID：945691
> 
> 赞同：15
> 
> 时间：2009-06-03T16:25:16.713
> 
> 标签：web-applications, printing

我和一位同事正在讨论浏览器中什么是可能的，什么是不可能的。

然后出现了一个我们都无法肯定回答的问题。

您能否创建一个网页，以便当您导航到它时，它会使用客户端打印机并尝试打印文档。例如，每当您访问我的个人网站时，您都会被打印出一张我微笑的照片。

现在，这是一个可怕的想法。我意识到。但讨论引起了我的兴趣，即是否可以做到，以及如何做到。我的朋友坚持认为你能做的最好的就是为用户弹出打印对话框，他们必须自己点击打印。

是否可以绕过这一步？或者只是一些花哨的脚本将鼠标移到打印按钮上并单击它？或者使用 activeX 控件直接与打印机 API 交互？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-03T16:33:00.773

您必须提示用户打印当前页面，没有办法绕过此步骤（*可能*在 IE 的 activeX 中）。也就是说，有两种不同的方式可以提示用户在页面加载时打印出你微笑的图像。

以下是如何在 JavaScript 中执行此操作。

```
window.onload = function() {
  var img = window.open("me-smiling.png");
  img.print();
} 
```

下面是如何在 css/javascript/html 中执行此操作（假设您的图片有`id`“我微笑”）： CSS：

```
@media print {
   * {
     display:none;
   }
   img#me-smiling {
     display:block;
   }
} 
```

Javascript：

```
 window.onload = function() { window.print() } 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-12-11T21:26:58.193

我发现避免打印对话框的唯一解决方案是在 Mozilla Firefox 上创建一个变量来设置自动打印。如果您需要使用其他浏览器，也许不是最好的解决方案，但就我而言，我只需要自动打印报告即可：

1- 打开 Firefox 并在地址栏中键入“about:config”
2- 右键单击​​任何首选项并选择“新建”>“布尔”
3- 添加一个名为“print.always_print_silent”的变量，其值为“true”
4- 重新启动火狐。

希望能帮到你！

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-09-21T19:54:06.400

AttendStar 创建了一个免费的附加组件，它可以抑制对话框并删除大多数 Firefox 版本的所有页眉和页脚。

[https://addons.mozilla.org/en-US/firefox/addon/attendprint/](https://addons.mozilla.org/en-US/firefox/addon/attendprint/)

使用该功能，您可以使用 $('img').jqprint(); jqprint for jquery 只会打印从您的 Web 应用程序自动调用的图像。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-05-28T18:27:20.937

据我所知，没有一些客户端干预，比如设置浏览器标志，没有办法直接打印文档。在我们当前的项目中，我们需要直接打印到默认打印机，但至少使用 Chrome，您可以通过额外的启动参数轻松完成。

要直接打印到操作系统默认打印机，您可以使用：

`"C:\Program Files (x86)\Google\Chrome\Application\chrome.exe" --user-data-dir=c:\tmp --kiosk-printing http://www.contoso.com`

另一个可能也有用的选项是使用本机打印对话框而不是 chrome 打印预览。

`"C:\Program Files (x86)\Google\Chrome\Application\chrome.exe" --user-data-dir=c:\tmp --disable-print-preview http://www.contoso.com`

请注意，`window.print()`和/或 Ctrl-P 的行为与上述设置相应。

我知道，这并不能完全回答 OP 的问题，但我认为它有些相关，对于基于 Web 的企业应用程序，这是一个非常常见的用例。也许有人觉得它有用。

对于 Firefox，我推荐[无缝打印插件](https://addons.mozilla.org/pt-br/firefox/addon/seamless-print/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-03T16:30:45.453

据我所知，您无法绕过打印对话框。如果浏览器允许，那将是一个非常明显的安全漏洞。但是您可以使用“window.print()”调出打印对话框。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-03T16:57:02.197

我认为您充其量需要一个使用基本 Windows API 的 ActiveX 组件来获取默认打印机的设备上下文，并尝试使用打印机设置的假定值打印嵌入式图像。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-09-27T19:17:19.250

要在不看到打印对话框提示的情况下自动打印到默认打印机，我在以下问题中共享了一些适用于 IE7、IE8 和 IE9 的代码：

[在 IE9 中绕过打印对话框](https://stackoverflow.com/questions/11036074/bypass-printdialog-in-ie9)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-07-05T07:49:09.380

从最近几天的大量搜索中，我找到了一个最好的解决方案。迄今为止，Chrome 不支持从 javascript 直接打印。它推出了 USB 和串行 API，这可能会有所帮助。

但目前我使用的是开源的 JavaApplet 解决方案。 [https://github.com/qzind/qz-print](https://github.com/qzind/qz-print) - 构建虽然我在构建它时遇到错误。我更喜欢 Prebuilt - QZ Print Plugin 1.9.3 桌面应用程序，效果很好。

从这里下载：[https ://qz.io/download/](https://qz.io/download/)

代码示例：

```
/***************************************************************************
 * Prototype function for printing an HTML screenshot of the existing page
 * Usage: (identical to appendImage(), but uses html2canvas for png rendering)
 *    qz.setPaperSize("8.5in", "11.0in");  // US Letter
 *    qz.setAutoSize(true);
 *    qz.appendImage($("canvas")[0].toDataURL('image/png'));
 ***************************************************************************/
function printHTML5Page() {
    $("#qz-status").html2canvas({
        canvas: hidden_screenshot,
        onrendered: function() {
            if (notReady()) { return; }
            // Optional, set up custom page size.  These only work for PostScript printing.
            // setPaperSize() must be called before setAutoSize(), setOrientation(), etc.
            qz.setPaperSize("8.5in", "11.0in");  // US Letter
            qz.setAutoSize(true);
            qz.appendImage($("canvas")[0].toDataURL('image/png'));

            //qz.setCopies(3);
            qz.setCopies(parseInt(document.getElementById("copies").value));

            // Automatically gets called when "qz.appendFile()" is finished.
            window['qzDoneAppending'] = function() {
                // Tell the applet to print.
                qz.printPS();

                // Remove reference to this function
                window['qzDoneAppending'] = null;
            };
        }
    });
} 
```

完整的例子可以在这里找到： [https ://gist.github.com/bkrajendra/c80de17b627e59287f7c](https://gist.github.com/bkrajendra/c80de17b627e59287f7c)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-05-26T06:44:23.553

这是我为 Firefox 找到的最佳解决方案：有这个很棒的附加组件[无缝打印。](https://addons.mozilla.org/en-us/firefox/addon/seamless-print/)

它就像魅力一样。

# asp.net - Time Based Events in ASP.net

> ID：945697
> 
> 赞同：9
> 
> 时间：2009-06-03T16:25:38.743
> 
> 标签：asp.net, sql-server, workflow-foundation

I need to perform some events (sending emails, etc.) based on time. What is the best way to accomplish this in ASP.net in a hosted (medium trust) environment?

ex: Send email every day at 4:00pm.
ex: Send email after 15min of login.
ex: Send email after 10 hrs of last change to status.

The triggering logic can be complex on some of the requirements, so I need to build a flexible system to handle these sorts of events. I am stuck on the core activation method for this code.

Here are the options I have so far...

**1) Timer in Global.asax**
+ Simple
- Is not reliable, the web application can unload in IIS and the event will not fire.
? Possibly use external pinger service to keep app alive (reliable?)

**2) Windows Service to perform action**
- Slip/Maintain separate code.
- Can not install in hosted environment (shared/cloud hosting)

**3) Windows Service to call Web App (calls webservice or runs page)**
+ All code in web app
- Can not install in hosted environment.

**4) SQL Server Job to call a Webservice (via CLR)**
? Haven't looked at this.. possible? reliable in hosted environment?

**5) SQL Service Broker Timer to add message to call WebService (via CLR)**
? Haven't looked at this.. possible? reliable in hosted environment?

**6) Windows Workflow?**
? No Idea.. does this technology have anything for this?

This seems like a common enough problem, are there third party tools to handle this?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T16:29:33.953

我也遇到过同样的问题，完全同意你的分析。迄今为止，我最好的解决方案是在我控制的计算机中安装一个外部调度应用程序；该应用程序请求实际执行操作的网页。

丑陋但有效，我已经寻找其他解决方案，相信我！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T08:15:40.090

我建议使用 SQL Server 作业。

它具有您的解决方案所需的所有时间表，而且非常可靠并且可以使用 C# 代码进行扩展。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-08-15T16:50:32.273

在 Windows 中设置计划任务的最简单方法，即运行简单的控制台应用程序或批处理文件。[http://windows.microsoft.com/en-us/windows7/schedule-a-task](http://windows.microsoft.com/en-us/windows7/schedule-a-task)

试图在 IIS 中做你所说的有问题。阅读 Phil Haack 关于[在 ASP.NET 中实现重复后台任务的危险的帖子](http://haacked.com/archive/2011/10/16/the-dangers-of-implementing-recurring-background-tasks-in-asp-net.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-12T09:00:42.623

你有没有看过[石英调度](http://quartznet.sourceforge.net/)器它做作业调度。它是java版本的.Net端口。请参阅这篇入门文章[http://geekswithblogs.net/TarunArora/archive/2012/04/10/walkthrough-scheduling-jobs-using-quartz.net-ndash-part-1-what-is.aspx](http://geekswithblogs.net/TarunArora/archive/2012/04/10/walkthrough-scheduling-jobs-using-quartz.net-ndash-part-1-what-is.aspx)。

我们还使用 Azure 并将工作人员角色用于计划任务。您可以在此处查看有关使用 Azure 工作角色构建基本计划任务的文章[http://blog.smarx.com/posts/building-a-task-scheduler-in-windows-azure](http://blog.smarx.com/posts/building-a-task-scheduler-in-windows-azure)

过去我们还设置了调用任务的网页，并使用像[https://www.pingdom.com/](https://www.pingdom.com/)这样的服务来定期调用该页面。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-08-15T16:39:00.107

如果您真的想使用 ASP.NET，那么我会结合使用 SQL Server、WCF 和 ASP.NET 缓存来执行您的计划任务。您可以轻松地修改它以执行更短或更长的间隔（例如每小时或每周） 这只会在选定的时间执行日常任务。

## 1\. 为您的任务设置 SQL 表

> ```
> Column Name        Data Type   
> Id                 int
> Name               varchar(100) 
> LastRun            datetime
> Interval           int 
> RunTime            datetime 
> ```

## 2.向表中添加一些数据

> ```
> 1 
> My Daily Email Task 
> 08/15/08 (old date)
> 300 (5 minutes)
> 09:00 
> ```

间隔基本上告诉服务器多久检查一次时间。时间越短，运行时间就越准确，代价是必须更频繁地检查数据库。

## 3\. 如果使用 ORM，创建类映射

```
public class Task
{
    public virtual int Id { get; set; }

    public virtual string Name { get; set; }

    public virtual DateTime? LastRun { get; set; }

    public virtual int Interval { get; set; }

    public virtual TimeSpan? RunTime { get; set; }
} 
```

这使用流利的nhibernate。实体框架也很好用。

## 4\. 创建服务调用以获取/保存任务

```
public Task[] GetTasks()
{

    var main = new Application.Main();
    using (var sessionFactory = main.SessionFactory)
    using (var session = sessionFactory.OpenSession())
    {
        return session.Query<Task>().ToArray();
    }

}

public bool SaveTask(Task task)
{
    var main = new Application.Main();
    using (var sessionFactory = main.SessionFactory)
    using (var session = sessionFactory.OpenSession())
    using (var trans = session.BeginTransaction())
    {
        session.SaveOrUpdate(task);
        trans.Commit();

        return trans.WasCommitted;
    }
} 
```

这将 WCF 用于服务调用。从技术上讲，您不需要 Web 服务，但我认为当您将数据库查询与 ASP.NET 站点分开时，它有助于组织。

## 5\. 在 global.asax 文件中设置调度

```
protected void Application_Start(object sender, EventArgs e)
{
    var service = new MyService.MyServiceClient();
    var tasks = service.GetTasks();

    foreach (var task in tasks)
    {
        AddTask(task);
    }

    service.Close();
} 
```

上面的函数基本上抓取了所有的任务，并通过一个缓存循环。

```
private void AddTask(PortalService.Task task)
{
        var onCacheRemove = new CacheItemRemovedCallback(CacheItemRemoved);
        HttpRuntime.Cache.Insert(task.Name, task, null,
            DateTime.Now.AddSeconds(task.Interval), Cache.NoSlidingExpiration,
            CacheItemPriority.NotRemovable, onCacheRemove);
} 
```

上述函数将数据库中的每个任务添加到 ASP.NET 运行时缓存中，该缓存根据您在数据库中指定的时间间隔循环。

```
public void CacheItemRemoved(string k, object taskObj, CacheItemRemovedReason r)
{
    var task = (MyService.Task)taskObj;

    //Run the task if it is the next day and greater than or equal to the runtime
    if (task.LastRun.HasValue && task.LastRun.Value.Day != DateTime.Now.Day && task.RunTime.HasValue && task.RunTime.Value.Hours <= DateTime.Now.Hour && task.RunTime.Value.Minutes <= DateTime.Now.Minute))
    {
        RunTask(ref task);
    }

    //Add the task again so that this method gets called again
    AddTask(task);
} 
```

当我们的时间间隔到期时，调用上述函数来运行我们的任务。

## 6\. 创建运行各种任务逻辑的函数

```
 private void RunTask(ref PortalService.Task task)
        {

            var service = new MyService.MyServiceClient();

            switch (task.Name)
            {
                case "My Daily Email Task":
                    service.SendDailyEmail();
                    break;
                case "Another Daily Task":
                    service.DoAnotherOperation();
                    break;
                case "Yet Another Daily Task":
                    service.DoYetAnotherOperation();
                    break;
            }

            //Update the task to indicate that it ran
            task.LastRun = DateTime.Now;
            service.SaveTask(task);

            service.Close();
        } 
```

总体而言，考虑到可以对其进行的许多改进，该解决方案运行良好。如果自上次运行状态存储在数据库中以来，您将间隔设置得相当低，则应用程序池回收不应影响此解决方案。

# c# - 将 ASP.NET GridView 控件绑定到字符串数组

> ID：945701
> 
> 赞同：11
> 
> 时间：2009-06-03T16:26:07.247
> 
> 标签：c#, asp.net, data-binding, gridview

我正在尝试将 ASP.NET`GridView`控件绑定到`string`数组，我得到以下项目：

> 在所选数据源中找不到名为“项目”的字段或属性。

我应该为 GridView 控件中的 asp:BoundField 列的 DataField 属性使用什么正确值。这是我的源代码：

ASPX 页面

```
<asp:GridView ID="MyGridView" runat="server" AutoGenerateColumns="false">
    <Columns>
        <asp:BoundField DataField="Item" />
        <asp:CommandField ButtonType="Link" ShowSelectButton="true" SelectText="Click Me!" />
    </Columns>
</asp:GridView> 
```

代码背后：

```
string[] MyArray = new string[1];
MyArray[0] = "My Value";
MyGridView.DataSource = MyArray;
MyGridView.DataBind(); 
```

**更新**

我需要将`AutoGenerateColumns`属性设置为，`false`因为我需要生成其他`asp:CommandField`列。我更新了我的代码示例以反映这种情况

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2010-04-21T09:30:56.033

经过几个小时的搜索，我终于发现这个案例有一个特殊的DataField：“ **！** ”

```
<asp:GridView ID="MyGridView" runat="server" AutoGenerateColumns="false">
<Columns>
    <asp:BoundField DataField="!" />
</Columns>
</asp:GridView> 
```

我希望有一天它会帮助某人:)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-06-03T16:37:37.853

尝试用 TemplateField 替换 BoundField，如下所示：

```
<asp:TemplateField HeaderText="String Value">
        <ItemTemplate>
            <%# Container.DataItem %>
        </ItemTemplate>
    </asp:TemplateField> 
```

顺便说一句，我从[另一个问题中提出了这个问题](https://stackoverflow.com/questions/502106/what-is-the-datakeyname-for-a-gridview-bound-to-a-string-array)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-06-03T16:37:45.107

一种方法是向它传递一个具有单个命名字段的类。这样，你就可以给它一个名字。

```
public class GridRecord
{
    public string MyValue { get; set; }
} 
```

然后将您的字符串数组转换为该类的列表

```
string[] MyArray = new string[1];
MyArray[0] = "My Value";
List<GridRecord> MyList = (
    from ar in myArray
    select new GridRecord
    {
        MyValue = ar
    }).ToList();
MyGridView.DataSource = MyList;
MyGridView.DataBind(); 
```

现在您可以命名您的 DataField 属性

```
<asp:GridView ID="MyGridView" runat="server" AutoGenerateColumns="false">
    <Columns>
        <asp:BoundField DataField="MyValue" />
    </Columns>
</asp:GridView> 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-12-05T01:43:01.297

这是一个使用旧 DataGrid 的完整示例......所以看起来“！” 技巧已广泛实施。这在 VS2008 中的 ASP.NET 下工作。当然，只需替换正确的元素名称即可使用 GridView。

```
<%@ Page
    Language="C#" 
    AutoEventWireup="true" 
    CodeBehind="Default.aspx.cs" 
    Inherits="WebApplication2._Default"
%>
<%@Import
    Namespace="System.Collections.Generic"
%>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>

    <script type="text/C#" runat="server">
        void initList()
        {           
        List<String> myList = new List<String>();
        myList.Add("Hello");
        myList.Add("Chatting");
        myList.Add("Goodbye");
        Grid1.DataSource = myList;
        Grid1.DataBind();
        }
    </script>    
    <title></title>
</head>
<body>
    <form id="form1" runat="server">
        <%initList(); %>
        <asp:DataGrid runat="server" ID="Grid1" AutoGenerateColumns="false">
            <Columns>
                <asp:BoundColumn DataField="!" DataFormatString="Data: {0}"  HeaderText="Dyad"/>
            </Columns>
        </asp:DataGrid>
    </form>
</body>
</html> 
```

因此，作为 GridView，内部部分将是

```
 <asp:GridView runat="server" ID="Grid1" AutoGenerateColumns="false">
        <Columns>
            <asp:BoundField DataField="!" DataFormatString="Data: {0}"  HeaderText="Dyad"/>
        </Columns>
    </asp:GridView> 
```

如果来回切换，请注意 VS2008（至少）无法在 Designer.cs 类中重新声明控件类型，因此如果仅编辑元素名称，则必须手动更改它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-03T16:39:19.020

迈克尔，

代码行

```
<asp:BoundField DataField="Item" /> 
```

需要一个名称为“Item”的列，如果您绑定到某个 DataSource 控件（如 SqlDataSource、ObjectDataSource 或 LinqDataSource），您将拥有该列。由于您绑定到 IEnumerable，因此您没有这样的名称。

# asp.net - 将 ASP.NET MVC 中的控制器保护给正确的用户

> ID：945703
> 
> 赞同：0
> 
> 时间：2009-06-03T16:26:08.540
> 
> 标签：asp.net, asp.net-mvc, security

我正在 ASP.Net MVC 中构建一个应用程序来记录任务。

用户只能删除他们自己的任务。是否有一种标准方法可以防止不同的登录用户简单地输入删除控制器 url，使用属于另一个用户的任务的 [id] 参数，从而删除另一个用户的任务？

例子：

用户 A 有一个 id 为 13 的任务。当用户 A 查看任务时，有一个指向 /tasks/delete/13 的链接，用于删除任务记录。用户 B 可以查看任务 13，然后决定在地址栏中输入 /tasks/delete/13，从而删除用户 A 的任务。

您是否必须在控制器中编写自己的代码来防止这种情况发生，或者是否有通常处理这种情况的标准方法？

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T20:03:12.397

当谈到 ASP.NET MVC 中的安全性时，您有身份验证和授权。

身份验证是验证用户身份的过程，通常涉及根据数据库检查用户名和密码，然后将某种用户 ID 分配给该用户。

授权是限制对系统资源的访问的过程，通常通过角色 ( [RBAC)](http://en.wikipedia.org/wiki/Role-based_access_control)完成。但是，角色通常不涵盖您所追求的所有权。

在您的情况下，您将需要编写自己的代码来对任务执行所有权检查，例如：

```
if (!task.IsOwnedBy(userID))
{
  throw new HttpException ((int)HttpStatusCode.Unauthorized, 
                           "You are not authorized.");
} 
```

我在这里问了一个类似的问题，[您如何将身份验证、角色和安全性融入您的 DDD？](https://stackoverflow.com/questions/890085/how-do-you-weave-authenticaion-roles-and-security-into-your-ddd)并且尚未决定如何将其集成到我的业务层中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T16:28:51.193

NerdDinner 应用程序在其 Dinners 控制器中就是这样一个示例。

[http://nerddinner.codeplex.com/](http://nerddinner.codeplex.com/)

有关如何执行此操作的说明在这里： http:
[//nerddinnerbook.s3.amazonaws.com/Part9.htm](http://nerddinnerbook.s3.amazonaws.com/Part9.htm)

沿着页面向下移动大约一半，直到看到标题：*在创建晚餐时*使用*User.Identity.Name 属性和在编辑晚餐时使用 User.Identity.Name 属性。*

# apache-flex - 弹性布局问题

> ID：945704
> 
> 赞同：0
> 
> 时间：2009-06-03T16:26:18.197
> 
> 标签：apache-flex, layout

```
<mx:TextInput x="917" y="10" width="111"/> 
```

我的弹性代码中有很多类似上面的声明：

我编写了以下代码，没有考虑在 800x600 甚至 1024x768 这样的分辨率下它会是什么样子。

所以，现在我的 UI 的某些部分没有显示在具有上述分辨率的机器上。

我该如何解决这个问题？

有没有办法以百分比指定 x,y 坐标？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T19:48:52.363

要以百分比指定 x/y 坐标，请尝试以下操作：

```
<!-- x = 60% of parent width, width = 20% of parent width, etc -->
<mx:TextInput x="{width*0.60}" y="{height*0.10}" width="20%"/> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T16:40:41.857

使用约束

```
<mx:TextInput left="10" top="10" width="111"/> 
```

这会将文本输入从顶部放置 10px，从左侧放置 10px

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T19:50:24.607

您需要使用布局约束，但是此功能仅限于文本输入的父容器。

例如，您只能对面板、画布或应用程序使用约束布局：（左、右、上或下）

对于应用程序和面板组件，您需要将布局属性设置为绝对。使用 Canvas 绝对是默认设置。

```
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" layout="absolute"> 
```

[弹性文档](http://livedocs.adobe.com/flex/3/html/help.html?content=size_position_5.html)

# maps - 地理编码数据库

> ID：945706
> 
> 赞同：13
> 
> 时间：2009-06-03T16:26:26.637
> 
> 标签：maps, geocoding

我可以下载地址、城市、州、邮政编码 - 纬度/经度信息，这些信息可以单独加载到美国的数据库中。还可以评论它们的准确性和覆盖范围。

我想所有的 GPS 设备都这样做.. 任何可以提取此信息的指针？

我尝试了 google maps json api.. 并且不喜欢他们限制每秒请求数的想法..

谢谢，拉米亚

编辑：我正在寻找的是 csv 或转储中的“地址、城市、州、邮政编码、纬度/经度”……我可以在本地查询……当然……免费（非商业）。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-07-21T15:27:48.663

在 GeoNames 上，您可以下载完整的数据库或国家/地区的摘录 [http://download.geonames.org/export/dump/](http://download.geonames.org/export/dump/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-05T07:08:32.053

尝试[地名](http://www.geonames.org/)。如果我记得很清楚，您可以下载完整的数据库或使用它的 API。免费。这是一个开放的项目。希望这可以帮助，

X。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-03T16:41:33.167

您正在寻找类似[geocoder.us](http://geocoder.us/)的东西吗？

还有[Virtual Earth API](http://www.microsoft.com/maps/developers/)。

[这](https://webgis.usc.edu/Services/Geocode/About/GeocoderList.aspx)是其他地理编码器服务的不错列表（感谢评论中的 Christopher Klein ;-)

**编辑：**我认为不存在允许无限请求的在线服务，因为这是避免 DOS 攻击等的安全措施......

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-03T16:48:29.897

我过去使用过[ZipCodeDownload](http://www.zipcodedownload.com/)，它有纬度/经度信息以及邮政编码、城市等……然而，它是一种商业产品。（请注意，我没有，也从未为这家公司工作过）

**编辑：** 您似乎不太可能找到每秒提供无限请求的免费服务。我不知道你是否看过这个链接，但该产品的起价为 30 美元，在我看来是相当实惠的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-03T18:00:21.457

您可能需要找到几个地理编码服务并编写自己的包装类，该类使用一种算法来选择使用哪一个、如何使用以及使用频率。但是请注意这一点，例如，我相信 Google 要求您在 Google 地图上显示地理编码结果（目前无法找到参考）。

除了 Google 和此线程中提到的其他服务之外，您还可以查看以下一些服务：

[http://developer.yahoo.com/maps/rest/V1/geocode.html](http://developer.yahoo.com/maps/rest/V1/geocode.html)

[http://www.maxmind.com](http://www.maxmind.com)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-03T16:55:44.460

我使用谷歌地图 API...

[http://code.google.com/apis/maps/documentation/geocoding/index.html](http://code.google.com/apis/maps/documentation/geocoding/index.html)

每项服务都会限制您的请求。我发现我可以通过在每个请求之间睡眠 200 毫秒来发出连续请求（如果它仍然太快，偶尔会有额外的睡眠周期）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-02-07T20:12:41.283

加利福尼亚州为整个北美地区提供免费的地理编码服务。

[http://services.gis.ca.gov/arcgis/rest/services/Location/NorthAmerica/GeocodeServer](http://services.gis.ca.gov/arcgis/rest/services/Location/NorthAmerica/GeocodeServer)

# macos - Emacs 23、OS X、多 tty 和 emacsclient

> ID：945709
> 
> 赞同：5
> 
> 时间：2009-06-03T16:26:48.570
> 
> 标签：macos, emacs, elisp

如何让 emacs 23 在 OS X 上的多 tty 模式下正常工作？

我已经添加`(server-start)`到我的 .emacs 中，并且发现运行`/Applications/Emacs.app/Contents/MacOS/bin/emacsclient -n ~/myfile.txt`会在我的 emacs.app 中打开它，但它不会将 emacs 带到前面。

那么，当我运行 emacsclient 时，如何让 emacs.app 出现在最前面呢？（我考虑过编写一个函数，每次打开文件时将当前帧放在前面，或者可能编写一个 Applescript 来完成可以与 emacsclient 同时调用的类似工作）

emacs.app 中的 emacsclient 是最好用的吗？如果是这样，我想我会给它写一个别名，但是使用它而不是 /usr/local/bin 中的东西似乎很奇怪

有没有人有任何其他的提示或例子来让这个工作？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-11-25T23:43:23.867

我有一个来自 emacs 的别名

```
open -a /Applications/Emacs.app "$@" 
```

如果您对它为每个文件打开一个新框架（窗口）这一事实感到恼火 - 添加

```
(setq ns-pop-up-frames nil) 
```

到您的 .emacs 并修复。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-03T16:46:24.813

也许这会起作用，只需在客户端附加时调用 raise-frame ：

```
(add-hook 'server-visit-hook 'call-raise-frame)
(defun call-raise-frame ()
  (raise-frame)) 
```

（它恰好在我的 Linux 机器上是多余的。）

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-28T04:59:56.353

一些建议的解决方案建议使用“raise-frame”。这将提高 emacs 框架，但不会给它焦点。当您从终端窗口启动 emacs 时，由于终端窗口保留焦点，emacs 仍将位于终端窗口下方。我使用“select-frame-set-input-focus”来提升**和**聚焦。

例子：

```
/Applications/Emacs.app/Contents/MacOS/bin/emacsclient -n ~/myfile.txt \
    --eval '(select-frame-set-input-focus (nth 0 (frame-list)))' 
```

我更喜欢运行单独的 emacs 实例，所以当我使用“^X^C”退出时，我不会丢失所有窗口。为此，我有一个 shell 脚本：

```
#!/bin/bash
/Applications/Emacs.app/Contents/MacOS/Emacs \
    --eval '(select-frame-set-input-focus (nth 0 (frame-list)))' \
    "$@" 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-03T16:35:18.307

AppleScript 很简单：

```
tell app "Emacs" to activate 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-03-11T04:22:42.757

我在我的*.emacs*中使用类似的东西来仅在服务器尚未运行时调用 server-start ：

```
(if (file-exists-p
 (concat (getenv "TMPDIR") "emacs"
         (number-to-string
          (user-real-uid)) "/server"))
nil (server-start)) 
```

*然后对我的.zshrc*进行一些更改，以便我可以`ec`在 shell 中无意识地作为编辑器命令运行：

```
# I use the Emacs package from emacsformacosx.com
alias emacs='open -a emacs'
alias emacsclient='/Applications/Emacs.app/Contents/MacOS/bin/emacsclient'
alias ec='emacsclient -a /Applications/Emacs.app/Contents/MacOS/Emacs'
export EDITOR='ec' 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-10-19T10:17:17.400

扩展 Trey Jackson 给出的答案和 Singletoned 的评论：我的 .emacs 文件中有以下内容

```
;;;
;;; Run in server-mode so other sessions can connet
;;;
(defun call-raise-frame ()
   (raise-frame))
(defun end-server-edit ()
   (shell-command "osascript -e \"tell application \\\"System Events\\\" to keystroke tab using command down\""))
(add-hook 'server-visit-hook 'call-raise-frame)
(add-hook 'server-done-hook 'end-server-edit)
(server-start) 
```

在我的 shell 初始化文件中，我有以下别名：

```
alias e='emacsclient'      # edit
alias enw='emacsclient -n' #edit (no wait) 
```

现在我可以与我的 CocoaEmacs 实例并排打开一个 shell，并无缝地一起使用这两者。我可以使用`e`别名在当前终端流程中调用编辑器“内联”，一旦我在 emacs 中完成编辑，焦点将返回到调用终端。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-01-10T23:41:15.303

我在我的 .emacs 中定义了这个函数

```
(defun ns-raise-emacs ()
  (ns-do-applescript "tell application \"Emacs\" to activate")) 
```

然后用它来提升框架：

```
emacsclient -e '(ns-raise-emacs)' 
```

我建议这样做而不是调用 osascript。它似乎比使用 osascript 响应更快（有时明显更快）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-10-28T10:27:25.970

fwiw，这是我的解决方案：
步骤 1：在 /usr/local/bin/emacs 创建一个脚本，其内容如下：

```
#!/usr/bin/bash
emacsclient -c --alternate-editor='/Applications/Emacs.app/Contents/MacOS/Emacs'  "$@" 2>/dev/null 
```

步骤 2\. 通过以下方式使其可执行： chmod +x /usr/local/bin/emacs

步骤 3\. 在您的 ~/.emacs 文件中添加以下内容：

```
(server-start)  

(defun ns-raise-emacs ()  
(ns-do-applescript "tell application \"Emacs\" to activate"))  

(ns-raise-emacs)  

(add-hook 'server-visit-hook 'raise-frame)  
;;(add-hook 'server-visit-hook 'ns-raise-emacs) 
```

解释：

如果调用 /usr/local/bin/emacs 的 emacs 脚本并且当前没有运行 emacs 服务器，则 emacsclient 将调用备用编辑器，在这种情况下是 Emacs 编辑器 (/Applications/Emacs.app/Contents/MacOS /Emacs）。

在第 3 步中，初始调用`(ns-raise-emacs)`似乎对于将初始 Emacs 窗口显示在其他所有内容之前是必要的。

这样`(add-hook 'server-visit-hook 'raise-frame)`做是为了使后续帧显示在其他所有内容之前。

或者，如果您希望每次从命令行调用 emacs 时所有 Emacs 框架都显示在其他所有内容的前面，您可以取消注释该`(add-hook 'server-visit-hook 'ns-raise-emacs)`行。

# c# - C#计算所有出现的换行和回车

> ID：945716
> 
> 赞同：1
> 
> 时间：2009-06-03T16:28:19.243
> 
> 标签：c#, count, richtextbox

在 C# 中，我正在制作一个带有行号的简单文本编辑器。我想计算字符串中有效换行符的数量。

我要数数

\r \n \r\n

我怎样才能做到这一点？

或者更好的是，有人可以指点我一篇关于如何为 rtf 框编号的文章

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-03T16:45:27.937

**注意：**这个答案更多地与计算字符串中的行数的抽象任务有关，而不是与 GUI 方面有关。对于原始提问者来说，它可能不如其他一些答案有用，但我怀疑它在不涉及 GUI 的类似情况下很有用。如果有足够多的人认为它在这里不相关，我会删除它。

我将使用已经知道行尾的现有类型，即`TextReader`与我的[MiscUtil](http://pobox.com/~skeet/csharp/miscutil)`LineReader`类型结合使用：

```
string text = "ab\ncd";
int lines = new LineReader(() => new StringReader(text)).Count(); 
```

或者，没有依赖项：

```
public IEnumerable<string> GetLines(string text)
{
    using (TextReader reader = new StringReader(text))
    {
        string line;
        while ((line = reader.ReadLine()) != null)
        {
            return line;
        }
    }
} 
```

然后：

```
int lineCount = GetLines(text).Count(); 
```

请注意，这将计算实际的文本行数而不是换行符 - 这可能与您想要的略有不同（例如，它通常是换行符 + 1，但如果文本末尾有换行符则不会）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T16:33:18.480

计算字符串的出现次数：

```
public static int CountStringOccurrences(string text, string pattern)
        {
            // Loop through all instances of the string 'text'.
            int count = 0;
            int i = 0;
            while ((i = text.IndexOf(pattern, i)) != -1)
            {
                i += pattern.Length;
                count++;
            }
            return count;
        } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-03T16:33:49.540

CodeProject上有关于此的文章：

[.NET 2.0 中 RichTextBox 的行号](http://www.codeproject.com/KB/vb/RTF_LineNumbering.aspx)

[.NET 2.0 中 RichTextBox 的编号行](http://www.codeproject.com/KB/edit/numberedtextbox.aspx)

[RichTextBox 的行号](http://www.codeproject.com/KB/cpp/linenumbers_for_rtb.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-03T16:33:50.087

计数线 - [http://ryanfarley.com/blog/archive/2004/04/07/511.aspx](http://ryanfarley.com/blog/archive/2004/04/07/511.aspx)

带有行号的 RTB - [http://www.xtremedotnettalk.com/showthread.php?s=&threadid=49661&highlight=RichTextBox](http://www.xtremedotnettalk.com/showthread.php?s=&threadid=49661&highlight=RichTextBox)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-03T16:48:43.253

```
public static int LineBreakCount(string s)
{
    if (s == null) throw new ArgumentNullException("s");

    return LineBreakCount(s, new[]{"\r\n", "\r", "\n"});
}

public static int LineBreakCount(string s, params string[] patterns)
{
    if (s == null) throw new ArgumentNullException("s");
    if (patterns == null) throw new ArgumentNullException("patterns");

    return s.Split(patterns, StringSplitOptions.None).Length;
} 
```

第一次重载中模式的顺序很重要，因为如果先执行“\r”或“\n”，则数组中的项数几乎或正好是两倍，因为它在指定它们的顺序。

# c# - 更改 Microsoft.Reporting.Winforms.ServerReport 的数据源

> ID：945721
> 
> 赞同：3
> 
> 时间：2009-06-03T16:29:00.880
> 
> 标签：c#, reporting-services

我四处寻找，我想做的似乎不可能，但我只想澄清一下。

是否可以更改 ServerReport 的 DataSource。因此，如果我有一个 ReportViewer，我希望能够从服务器上定义的共享数据源的可用列表中定义报表使用的数据源。

我想这样做，这样我就不必为每个数据库引擎实例维护多个报表服务器实例。这是疯了吗？

我在 Win2k3 服务器上使用 SSRS 2008，我的项目是 .NET 3.5 Win Forms 项目。

有人有什么想法吗？

干杯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T16:47:55.140

我认为实现这一点的唯一方法是在本地处理模式下运行 ReportViewer 控件。这样，根本不需要数据库连接。

# sharepoint - 将共享字段添加到 SharePoint 日历以与 Outlook 日历同步

> ID：945722
> 
> 赞同：0
> 
> 时间：2009-06-03T16:29:07.247
> 
> 标签：sharepoint, sharepoint-2007, outlook, calendar, customcolumn

我已经使用添加了自定义列的日历设置了 MOSS 2007 Enterprise。我们已经在 Outlook 中同步了这个日历，它可以很好地从 SharePoint 或 Outlook 创建和编辑事件。

问题是我希望能够在 Outlook 中添加到 SharePoint 日历的新事件表单中添加两个额外的字段。我进入了 Outlook 的表单设计器。我转到第二个选项卡以添加额外的数据字段，但我不知道如何能够映射到 SharePoint 日历的这两个额外字段。

解决我的问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-11T06:11:11.640

您不能同步自定义字段。我可以使用空的标准字段（例如“里程”）来编程此同步。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-03-22T07:09:57.150

这个限制多年来一直困扰着我的咨询公司。当我们的许多客户找不到他们的自定义字段时，他们感到很惊讶。到了我们决定开发自己的 Outlook 插件来弥补差距的地步。

该项目现在称为 ProperSync，可供公众下载。我们希望它能帮助那些在 Outlook 中寻找自定义字段的人。目前它适用于日历和任务列表，但我们也在处理其他 Outlook 类型。您可以在 www.propersync.com 找到更多信息

# php - 余弦相似度与汉明距离

> ID：945724
> 
> 赞同：18
> 
> 时间：2009-06-03T16:29:31.647
> 
> 标签：php, relationship, similarity

为了计算两个文档之间的相似度，我创建了一个包含词频的特征向量。但是，对于下一步，我无法在“[余弦相似度](http://en.wikipedia.org/wiki/Cosine_similarity)”和“[汉明距离](http://en.wikipedia.org/wiki/Hamming_distance)”之间做出决定。

我的问题：你有使用这些算法的经验吗？哪一个给你更好的结果？

除此之外：你能告诉我如何在 PHP 中编写余弦相似度吗？对于汉明距离，我已经得到了代码：

```
function check ($terms1, $terms2) {
    $counts1 = array_count_values($terms1);
    $totalScore = 0;
    foreach ($terms2 as $term) {
        if (isset($counts1[$term])) $totalScore += $counts1[$term];
    }
    return $totalScore * 500 / (count($terms1) * count($terms2));
} 
```

我不想使用任何其他算法。我只想在两者之间做出决定。

也许有人可以谈谈如何改进算法。如果过滤掉停用词或常用词，你会得到更好的结果吗？

我希望你能帮助我。提前致谢！

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-08-17T20:39:33.627

应在两个长度相等的字符串之间进行汉明距离，并考虑顺序。

由于您的文档的长度肯定不同，并且如果单词位置不计算在内，余弦相似度会更好（请注意，根据您的需要，存在更好的解决方案）。:)

这是 2 个单词数组的余弦相似度函数：

```
function cosineSimilarity($tokensA, $tokensB)
{
    $a = $b = $c = 0;
    $uniqueTokensA = $uniqueTokensB = array();

    $uniqueMergedTokens = array_unique(array_merge($tokensA, $tokensB));

    foreach ($tokensA as $token) $uniqueTokensA[$token] = 0;
    foreach ($tokensB as $token) $uniqueTokensB[$token] = 0;

    foreach ($uniqueMergedTokens as $token) {
        $x = isset($uniqueTokensA[$token]) ? 1 : 0;
        $y = isset($uniqueTokensB[$token]) ? 1 : 0;
        $a += $x * $y;
        $b += $x;
        $c += $y;
    }
    return $b * $c != 0 ? $a / sqrt($b * $c) : 0;
} 
```

它很快（`isset()`而不是`in_array()`大型阵列的杀手）。

如您所见，结果没有考虑每个单词的“大小”。

我用它来检测“几乎”复制粘贴文本的多次发布消息。它运作良好。:)

**关于字符串相似度指标的最佳链接**： [http ://www.dcs.shef.ac.uk/~sam/stringmetrics.html](http://www.dcs.shef.ac.uk/~sam/stringmetrics.html)

更多有趣的读物：

[http://www.miislita.com/information-retrieval-tutorial/cosine-similarity-tutorial.html](http://www.miislita.com/information-retrieval-tutorial/cosine-similarity-tutorial.html) [http://bioinformatics.oxfordjournals.org/cgi/content/full/22/18/2298](http://bioinformatics.oxfordjournals.org/cgi/content/full/22/18/2298)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-06-03T16:44:39.997

除非我弄错了，否则我认为您的算法*介于两种算法之间*。对于汉明距离，使用：

```
function check ($terms1, $terms2) {
    $counts1 = array_count_values($terms1);
    $totalScore = 0;
    foreach ($terms2 as $term) {
        if (isset($counts1[$term])) $totalScore += 1;
    }
    return $totalScore * 500 / (count($terms1) * count($terms2));
} 
```

（请注意，您只为标记向量中的每个匹配元素添加 1。）

对于余弦相似度，请使用：

```
function check ($terms1, $terms2) {
    $counts1 = array_count_values($terms1);
    $counts2 = array_count_values($terms2);
    $totalScore = 0;
    foreach ($terms2 as $term) {
        if (isset($counts1[$term])) $totalScore += $counts1[$term] * $counts2[$term];
    }
    return $totalScore / (count($terms1) * count($terms2));
} 
```

（请注意，您要在两个文档之间添加令牌计数的乘积。）

两者之间的主要区别在于，**当两个文档在文档中多次具有相同的单词时，余弦相似度会产生更强的指示符**，而**汉明距离并不关心单个标记出现的频率**。

**编辑**：刚刚注意到您关于删除功能词等的查询。如果您要使用余弦相似度，我建议您这样做 - 因为功能词非常频繁（至少在英语中），您可能会通过不过滤它们来扭曲结果. 如果使用汉明距离，效果不会那么好，但在某些情况下仍然可以察觉。此外，如果您可以访问[lemmatizer](http://en.wikipedia.org/wiki/Lemmatization)，例如，当一个文档包含“galaxies”而另一个文档包含“galaxy”时，它将减少未命中。

无论你走哪条路，祝你好运！

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-03T16:37:56.293

我很抱歉忽略了你说你不想使用任何其他算法的事实，但说真的，[Levenshtein 距离](http://en.wikipedia.org/wiki/Levenshtein_distance)和[Damerau-Levenshtein 距离](http://en.wikipedia.org/wiki/Damerau%E2%80%93Levenshtein_distance)比 Hamming 距离更有用。这是[PHP 中的 DL 距离实现](http://forums.devnetwork.net/viewtopic.php?f=50&t=89094)，如果你不喜欢 PHP 的原生`levenshtein()`函数，我想你不会因为它有长度限制，这里是一个非长度限制的版本：

```
function levenshtein_distance($text1, $text2) {
    $len1 = strlen($text1);
    $len2 = strlen($text2);
    for($i = 0; $i <= $len1; $i++)
        $distance[$i][0] = $i;
    for($j = 0; $j <= $len2; $j++)
        $distance[0][$j] = $j;
    for($i = 1; $i <= $len1; $i++)
        for($j = 1; $j <= $len2; $j++)
            $distance[$i][$j] = min($distance[$i - 1][$j] + 1, $distance[$i][$j - 1] + 1, $distance[$i - 1][$j - 1] + ($text1[$i - 1] != $text2[$j - 1]));
    return $distance[$len1][$len2];
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-08-07T02:03:22.047

这是Toto发布的余弦距离函数的更正代码

```
function cosineSimilarity($tokensA, $tokensB)
{
    $a = $b = $c = 0;
    $uniqueTokensA = $uniqueTokensB = array();

    $uniqueMergedTokens = array_unique(array_merge($tokensA, $tokensB));

    foreach ($tokensA as $token) $uniqueTokensA[$token] = 0;
    foreach ($tokensB as $token) $uniqueTokensB[$token] = 0;

    foreach ($uniqueMergedTokens as $token) {
        $x = isset($uniqueTokensA[$token]) ? 1 : 0;
        $y = isset($uniqueTokensB[$token]) ? 1 : 0;
        $a += $x * $y;
        $b += pow($x,2);
        $c += pow($y,2);
    }
    return $b * $c != 0 ? $a / sqrt($b * $c) : 0;
} 
```

# sql-server-2008 - 如何使用脚本安装 SQL Server 作业？

> ID：945727
> 
> 赞同：1
> 
> 时间：2009-06-03T16:30:15.810
> 
> 标签：sql-server-2008, deployment, scheduled-tasks

我的 SQL Server 2008 服务器中有一个 SQL Server 作业。现在我想使用 PowerShell 编写一些脚本，这些脚本可以通过命令行自动将作业部署到其他计算机。有什么样本或文档可以推荐给这个主题学习吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-03T16:39:49.503

[这](http://msdn.microsoft.com/en-us/library/ms182079.aspx)可能是了解它们是如何编写脚本的一个很好的起点。您基本上`sp_add_job`可以使用相关的存储过程创建一个作业，然后可以添加步骤、计划等。您可能希望首先从 SQL Management Studio 编写现有作业的脚本并将它们与文档进行比较。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T17:00:02.240

最简单的方法是手动创建一个作业，然后在 SSMS 中右键单击它并执行 Script As Create。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T17:01:09.523

如果要将相同的作业部署到其他 SQL Server，您可能还需要考虑 SQL Server 中的 MSX TSX 设置。

一台服务器是主服务器 (MSX)，它将作业部署到所有其他服务器，目标服务器 (TSX) 下载并执行作业。好的部分是关于 SQL Server 代理的所有好处（调度、部署、错误日志记录、通知、从另一个触发、集成）等都是内置的，您不必为每项工作都自定义编写。

# time - Lua中数字的最大值是多少？

> ID：945731
> 
> 赞同：25
> 
> 时间：2009-06-03T16:31:32.613
> 
> 标签：time, lua, numbers

文档中似乎没有明确的答案。

我有兴趣增加一个`time`自程序启动以来计算秒数的变量。如果最大值可以计算到很远的未来，比如 100 年，那么我不在乎让变量永远增加。否则我将不得不想一个好点来重置`time`回 0。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-06-03T17:13:31.130

在默认情况下编译时，数字是`double`, 在大多数 IEEE 64 位浮点编译器上。这意味着 10 位指数，所以最大数字大约是 2^1024，或 5.6e300 年。那是很长一段时间。

现在，如果您要增加它，您可能对整数范围更感兴趣。52位尾数意味着可以使用整数精度的最高数字是2^52，大约是4.5e15。以 31,557,600 秒/年计算，即 1.427e8，将近 1.5 亿年。对于任何流程来说，正常运行时间仍然很长

**2014-12-30 更新**：Lua 5.3（现在随时发布）增加了对整数值的支持，可以通过编译标志选择 32 位或 64 位。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-06-03T23:08:41.133

尽管 tydok 对[PiL 2.3](http://www.lua.org/pil/2.3.html)的引用既正确又恰当，而且[Javier 的回答](https://stackoverflow.com/questions/945731/what-is-the-maximum-value-of-a-number-in-lua/945935#945935)实际上是正确的，但我认为 Lua 中对数字的讨论应该用一些其他细节来完善。

Lua 解释器被设计为嵌入到应用程序中，通常作为配置和/或脚本语言。为应用程序构建时，通常会配置其某些功能以适应。

用于数字的确切数字类型可用于配置。当为没有硬件浮点的平台编译时，加载第三方模块并不重要（特别是在嵌入式系统或机顶盒游戏控制台应用程序中），那么选择整数类型而不是默认类型是合理的`double`。偶尔切换到`float`也是合理的。

但是，有些应用需要 64 位整数，或者大多数数字可以是整数，但偶尔需要浮点运算。对于这些情况，Lua 核心有[LNUM 补丁。](http://luaforge.net/projects/lnum/)

LNUM 更改了内核，以便将数字存储为整数或浮点数，并允许对每个精度进行多个可配置的选择。

所以 Lua 数的最大值问题的底线答案是它取决于编译时选择的解释器的配置，以及您是否担心可表示的最大幅度或最大整数。即便如此，已经进行了工作以使大整数与浮点表示配合得很好。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2018-05-08T07:39:02.937

这是其他几个答案中提到的最高值。这就是 1.8e308 的来源：

```
HighestNumber = 0
for i = 971, 1024 do
    HighestNumber = HighestNumber + (2 ^ i)
    print(HighestNumber)
end 
```

[![LuaJIT 结果](https://i.stack.imgur.com/Cei3v.png)](https://i.stack.imgur.com/Cei3v.png)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-03T16:35:54.063

我在 lua 用户网站上找到[了这封电子邮件](http://lua-users.org/lists/lua-l/2005-01/msg00846.html)

> Lua 核心不使用 64 位数据类型，除非隐式地通过`size_t`or `ptrdiff_t`（在 64 位盒子上恰好是 64 位）。
> 
> sizeof（浮动）== 4
> sizeof（双）== 8
> 
> 您可以将 lua_Number 定义为双精度（默认）、浮点数或任何至少 32 位的整数。虽然有副作用，并且由于浮点数或整数的范围有限，一些扩展可能会停止工作。不过核心应该没问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-12-07T12:00:13.867

**使用 Lua5.1 或 Lua5.2**

最大格式化数：

```
179769313486231570814527423731704356798070567525844996598917476803157260780028538760589558632766878171540458953514382464234321326889464182768467546703537516986049910576551282076245490090389328944075868508455133942304583236903222948165808559332123348274797826204144723168738177180919299881250404026184124858368 
```

如果最后将 68 更改为 69，它仍然只显示 68。大于上述数字的数字返回 math.huge aka inf。

等于：1.8x10^308 或 2^1024 以南。

自己试试：

```
print(string.format("%.0f",number)) 
```

# regex - 带正则表达式的 mod 11 校验位

> ID：945763
> 
> 赞同：3
> 
> 时间：2009-06-03T16:38:18.397
> 
> 标签：regex, check-digit

是否可以使用正则表达式语句创建 mod 11 校验位例程？

数字是一个 10 位数字，

步骤1：A =（2号*2）+（3号*4）+（4号*8）+（5号*5）+（6号*10）+（7号*9）+（8号） * 7) + (第 9 个数字 * 3))

第 2 步：B = A / 11（忽略余数）

第 3 步：C = B * 11

第 4 步：D = A - C

第 5 步：11 - D 必须 = 第 10 位

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-03T16:42:05.117

不——基本上你想在这里做数学，这并不适合正则表达式，正则表达式只是关于模式。

我的意思是，*理论上*这当然是可能的——您可以列出所有有效数字，并将它们组合成一个巨大的正则表达式。但是，这实际上并不*可行*。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-06-15T12:12:27.657

使用正则表达式作为有限状态机。 [http://quaxio.com/triple/](http://quaxio.com/triple/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T16:43:23.650

正则表达式进行模式匹配，而不是真正的解析。您需要解析数字以获取数字。我建议使用正则表达式来确保它是一个 10 位数字，然后使用 ToString() 并将其切碎。

# tagging - del.icio.us 如何知道为 URL 建议的标签？

> ID：945765
> 
> 赞同：2
> 
> 时间：2009-06-03T16:39:36.743
> 
> 标签：tagging, autosuggest

当我为[http://dbpedia.org/About](http://dbpedia.org/About)添加书签时，del.icio.us 建议将“xml”和“programming”作为标签。它如何知道 URL 与这些主题相关？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-03T16:40:57.753

这很可能是因为其他用户使用这些标签标记了相同的 URL。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T16:49:38.477

它肯定是基于其他用户的。更多“未知”页面不会有任何建议，但其他人可能已加入书签的热门页面会有建议。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T16:44:49.373

可能会监视其他人的标签，尽管我希望它抓取 URL 页面并处理它的建议。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T17:05:39.767

它仍然基于其他用户。但我认为，如果他们想保持最常用的平台之一，他们应该添加另一种标记技术。该领域有一些很棒的想法 - Faviki（基于维基百科）或标签的含义（MOAT）。

# asp.net - ASP 主题：皮肤本地化

> ID：945770
> 
> 赞同：4
> 
> 时间：2009-06-03T16:40:54.900
> 
> 标签：asp.net, localization, themes

有什么方法可以本地化 .skin 文件（asp.net 主题）中的文本？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T16:48:19.633

没有。本地化文本来自资源文件。皮肤文件与外观和感觉有关，而不是内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-13T13:27:22.330

如果你打算走这条路，最简单的可能是为每种语言设置一个 asp.net 主题，然后根据位置翻转主题。每个主题可以包含特定语言的按钮、皮肤等

# c# - 正则表达式匹配某个字符之前的任何内容？

> ID：945776
> 
> 赞同：1
> 
> 时间：2009-06-03T16:42:01.513
> 
> 标签：c#, regex, parsing, lookahead

我必须从文本中解析一堆统计数据，它们都被格式化为数字。

例如，这一段：

> 纽约市 81.8% 的 3 至 8 年级学生达到或超过年级水平的数学标准，而纽约州其他地区的学生这一比例为 88.9%。

我只想匹配 81 和 88 数字，而不是后面的“.8”和“.9”。

我怎样才能做到这一点？我听说过反向引用或前瞻之类的术语。这些会有帮助吗？

我正在使用 C#。

编辑：在上面的例子中，我需要得到“3”和“8”。这只是一个简单的例子，但我需要几乎所有的数字。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-03T16:49:17.790

```
/[^.](\d+)[^.]/ 
```

如下所述，只需使用 MatchObj.Groups(1) 来获取数字。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T16:54:57.083

如果您不想处理组，则可以像您说的那样使用前瞻；此模式查找字符串中所有十进制数的整数部分：

```
Regex integers = new Regex(@"\d+(?=\.\d)");
MatchCollection matches = integers.Matches(str); 
```

`matches`将包含`81`和`88`。如果您想匹配任何数字的整数部分（无论是否为十进制），您可以改为搜索不以 a 开头的整数`.`：

```
Regex integers = new Regex(@"(?<!\.)\d+"); 
```

这一次，匹配项将包含`81`、`3`和。`8``88`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-04T08:08:46.587

完整的 C# 解决方案：

```
/// <summary>
/// Use of named backrefence 'roundedDigit' and word boundary '\b' for ease of
/// understanding
/// Adds the rounded percents to the roundedPercents list
/// Will work for any percent value
/// Will work for any number of percent values in the string
/// Will also give those numbers that are not in percentage (decimal) format
/// </summary>
/// <returns>true if success, false otherwise</returns>
public static bool TryGetRoundedPercents(string digitSequence, out List<string> roundedPercents)
{
    roundedPercents = null;
    string pattern = @"(?<roundedDigit>\b\d{1,3})(\.\d{1,2}){0,1}\b";

    if (Regex.IsMatch(digitSequence, pattern))
    {
        roundedPercents = new List<string>();
        Regex r = new Regex(pattern, RegexOptions.IgnoreCase | RegexOptions.Compiled | RegexOptions.ExplicitCapture);

        for (Match m = r.Match(digitSequence); m.Success; m = m.NextMatch())
            roundedPercents.Add(m.Groups["roundedDigit"].Value);

        return true;
    }
    else
        return false;
} 
```

从您的示例返回 81、3、8 和 88

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-03T16:50:52.033

尝试：

```
[0-9]*(?=[3]) 
```

它使用前瞻来仅匹配后跟小数点的数字。

C#代码：

```
Regex regex = new Regex("[0-9]+(?=[.])");
MatchCollection matches = regex.Matches(input); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-03T16:58:49.637

```
[^.](\d+) 
```

从您的示例中，这将匹配“81”、“3”、“8”、“88”

在获得号码之前，您会获得一个额外的字符，但您可以在代码中将其删除。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-03T16:44:03.990

```
/(\d+)\.\d/g 
```

这将匹配任何后面有小数的数字（我认为这是你想要的），但只会捕获小数点之前的数字。`\d`只会捕获数字（与 [0-9] 相同），因此它使这变得非常简单。

编辑：如果你也想要三个和八个，你甚至不需要检查小数点。

Edit2：抱歉，已修复它，因此它会忽略所有小数位。

```
/(\d+)(?:\.\d+)?/g 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-03T16:55:35.850

尝试使用 `/(\d+)((\.\d+)?)/`

这基本上意味着将一个数字序列和一个可选的小数点与另一个数字序列匹配。然后，`MatchObj.Groups(1)`用于第一个匹配值，忽略第二个。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-03T20:03:58.993

这不是您询问的语言，但它可以帮助您思考问题。

```
$ echo "A total of 81.8 percent of New York City students in grades 3 to 8 are meeting or exceeding grade-level math standards, compared to 88.9 percent of students in the rest of the State." \
| fmt -w 1 | sed -n -e '/^[0-9]/p' | sed -e 's,[^0-9].*,,' | fmt -w 72
81 3 8 88 
```

第一个 fmt 命令要求以下命令分别考虑每个单词。“sed -n”命令只输出至少以一个数字开头的单词。第二个 sed 命令删除单词中的第一个非数字字符，以及之后的所有内容。第二个 fmt 命令将所有内容组合回一行。

```
$ echo "This tests notation like 6.022e+23 and 10e100 and 1e+100." \
| fmt -w 1 | sed -n -e '/^[0-9]/p' | sed -e 's,[^0-9].*,,' | fmt -w 72
6 10 1 
```

# java - servlet中的参数化构造函数

> ID：945778
> 
> 赞同：3
> 
> 时间：2009-06-03T16:42:08.143
> 
> 标签：java, servlets, jakarta-ee

我可以在 servlet 中声明参数化构造函数，它只是构造函数吗？

如果没有，那为什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-03T16:46:20.540

不。

Servlet 实例由容器通过反射创建，它们希望找到一个公共的、无参数的构造函数（默认构造函数）。

要配置 servlet，请使用 web.xml 文件中指定的 servlet 参数。这些将传递给您的 servlet 的[`init()`](http://java.sun.com/products/servlet/2.3/javadoc/javax/servlet/Servlet.html#init(javax.servlet.ServletConfig))方法。

* * *

虽然servlet 容器*可以*选择非默认构造函数并将字符串强制转换为简单类型并反射地调用构造函数，但这不是 Servlet 规范所要求的。

部分原因可能是历史原因；servlet 早在依赖注入系统使这种替代方案得到广泛实践之前很久就被指定了。但是，这样的构造函数将是相当有限的；传递可以从 web.xml 中指定的简单字符串创建的参数是可行的，但更有用的对象（`DataSource`例如 a ）会很尴尬。

不过，在 servlet 中有最终成员变量会很好。

JSR 以前称为“WebBeans”（我认为是 JSR 299），将为 Servlet 中的依赖注入支持提供一些标准。这可能会解决当前方法中的一些缺点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T16:43:35.660

由于 servlet 是由容器实例化的，因此它们需要一个无参数的构造函数。

此外，容器可以重用 servlet，并且不会在重用时调用构造函数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T16:46:08.137

您需要通过`<servlet-param>`或使用像 Spring 这样的框架来初始化变量，它可以让您将 Servlet 代理到另一个类，该类的行为就像任何其他 bean。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-07-22T19:44:38.247

不！我们无法在 servlet 中提供参数化构造函数。servlet 容器为 sevrlet 创建对象。容器将基于`Class.forName(String classname)`. 我们可以使用 为类创建对象`Class.forName()`，如果该类仅包含默认构造函数。由于容器使用`Class.forName()`创建对象的代码，我们不编写参数化构造函数作为 servlet 的一部分。即使我们想编写参数化的构造函数，我们也已经从`service()`方法中调用了构造函数！

# delphi - 如何处理临时文件？

> ID：945785
> 
> 赞同：4
> 
> 时间：2009-06-03T16:43:41.933
> 
> 标签：delphi, temporary-files

在我的应用程序中，我的用户可以将文件 (pdf/xls/doc) 导入表或将它们导出到文件夹。现在我想直接打开这些文件。

到目前为止，我能够： - 获得一个唯一的名称 - 将 blob 文件保存到生成的文件中 - 打开它

问题是我不知道如何删除（或更新）文件，之后文件将被用户关闭。

如果有人可以帮助我，我会很高兴:)

这是我的代码的快照：

```
procedure OpenTemporaryFile(AFileExtension: String; AKey: Integer;
            AMyConnection: TMyConnection);
     Var
       qrDocuments : TMyQuery ;
       TmpName,ExtName: string;
       TempFileName: TFileStream;
    begin
       //Generate an unique tmp file located into user temp folder
       TmpName:=  FileGetTempName('~SI');
       ExtName:= ChangeFileExt(TmpName, AFileExtension);
       //Change files extension so that Shellexecute will be able to open the file
       RenameFile(TmpName,ExtName );
       //Creating the FileStream (data is fetched from an blob field)
       TempFileName := TFileStream.Create(ExtName, fmOpenReadWrite );

       qrDocuments := TMyQuery.create(nil);
       try
        qrDocuments.Connection := AMyConnection;
        qrDocuments.Close;
        qrDocuments.SQL.Clear;
        qrDocuments.SQL.Text:='Select Id,FileName,Data from files where Id = :prId And Data IS NOT NULL';
        qrDocuments.ParamByName('prId').AsInteger := AKey;
        qrDocuments.open;
        TBlobField(qrDocuments.FieldByName('Data')).SaveToStream(TempFileName);
       finally
          TempFileName.Free;
          qrDocuments.free;
       end;
       ShellExecute(Application.Handle, 'open', Pchar(ExtName), '', '', SW_SHOWNORMAL);
       DeleteFile( ExtName);
    end; 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-04T08:23:00.473

[不幸的是，目前Remy Lebeau](https://stackoverflow.com/questions/945785/how-can-i-handle-temporary-files/946246#946246)的这个答案有 4 个赞成票，当时该技术根本不适用于大多数应用程序。也许其中一个支持者可以发布一个代码片段，允许使用 Acrobat Reader 打开 PDF 文件，而该文件仍然使用`FILE_FLAG_DELETE_ON_CLOSE`标志打开？

无论如何，您可以在这里结合一些技巧以获得最佳效果：

*   拥有您的应用程序使用的临时文件的内部列表。
*   在程序关闭时，遍历临时文件列表并尝试删除它们。如果其中一些失败（因为它们仍然在外部应用程序中打开）使用[gabr 给您的代码](https://stackoverflow.com/questions/945785/how-can-i-handle-temporary-files/946269#946269)注册这些以在重新启动时删除。
*   每当您需要一个新的临时文件时，首先遍历您的内部文件列表并尝试重用其中一个。仅当失败时才创建一个新文件（并将其名称添加到列表中）。

我更喜欢这种方法来注册所有文件以在重新启动时删除，因为我不确定您的应用程序可能会打开多少临时文件 - 也许可以注册的文件数量有限制`MOVEFILE_DELAY_UNTIL_REBOOT`？这是一个系统范围的资源，我只会谨慎使用。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-03T18:07:42.597

一种可能性是将每个临时文件添加到系统启动期间删除的文件列表中。

在 Windows NT 平台上（自 Windows 2000 起），您可以调用[MoveFileEx](http://msdn.microsoft.com/en-us/library/aa365240(VS.85).aspx)函数，并将第二个参数（目标）设置为 nil 并使用标志 MOVEFILE_DELAY_UNTIL_REBOOT。

在 Windows 9x 上，这要复杂得多。您必须编辑文件 %WINDIR%\wininit.ini 并将条目写入 [Rename] 部分。

MSDN 条目[如何移动当前使用的文件](http://support.microsoft.com/kb/140570)描述了这两种技术。

函数 DSiMoveOnReboot（免费[DSiWin32](http://gp.17slon.com/gp/dsiwin32.htm)库的一部分）处理这两种操作系统。如果您传递一个空字符串作为第二个参数，它将在重新启动时删除源文件。

```
function DSiMoveOnReboot(const srcName, destName: string): boolean;
var
  wfile: string;
  winit: text;
  wline: string;
  cont : TStringList;
  i    : integer;
  found: boolean;
  dest : PChar;
begin
  if destName = '' then
    dest := nil
  else
    dest := PChar(destName);
  if DSiIsWinNT then
    Result := MoveFileEx(PChar(srcName), dest, MOVEFILE_DELAY_UNTIL_REBOOT)
  else
    Result := false;
  if not Result then begin
    // not NT, write a Rename entry to WININIT.INI
    wfile := DSiGetWindowsFolder+'\wininit.ini';
    if FileOpenSafe(wfile,winit,500,120{one minute}) then begin
      try
        cont := TStringList.Create;
        try
          Reset(winit);
          while not Eof(winit) do begin
            Readln(winit,wline);
            cont.Add(wline);
          end; //while
          if destName = '' then
            wline := 'NUL='+srcName
          else
            wline := destName+'='+srcName;
          found := false;
          for i := 0 to cont.Count - 1 do begin
            if UpperCase(cont[i]) = '[RENAME]' then begin
              cont.Insert(i+1,wline);
              found := true;
              break;
            end;
          end; //for
          if not found then begin
            cont.Add('[Rename]');
            cont.Add(wline);
          end;
          Rewrite(winit);
          for i := 0 to cont.Count - 1 do
            Writeln(winit,cont[i]);
          Result := true;
        finally cont.Free; end;
      finally Close(winit); end;
    end;
  end;
end; { DSiMoveOnReboot } 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-03T18:05:39.560

使用 Win32 API CreateFile() 函数打开文件，指定`FILE_FLAG_DELETE_ON_CLOSE`标志，然后将生成的句柄传递给 THandleStream 对象，以便您仍然可以使用 SaveToStream()。

此外，您的代码中有一个错误 - 您将错误的句柄类型传递给 ShellExecute()。它需要一个窗口句柄，但您传递的是文件句柄，更糟糕的是，您在释放 TFileStream 后访问文件句柄，从而关闭句柄。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-03T16:52:16.587

也许您可以将它们存储在一些为您所知的文件夹中（例如 TEMP 文件夹中带有您的应用程序名称的子文件夹）并在用户下次加载您的应用程序时清除该文件夹的内容？或者您可以安装额外的清除实用程序并将其设置为在自动启动中运行。
关于重新启动后清除文件的另一个想法 - 您可以在启动时清除子文件夹中的所有内容，或者列出您创建的文件的最后修改时间、最后大小，将此列表存储在 XML 文件中，然后删除或更新比较您的内容包含该列表中文件详细信息的临时子文件夹？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-03T18:09:06.743

如果我没记错的话，CreateFile 有一个标志，它告诉 Windows 应该在文件的最后一个句柄关闭后删除该文件。因此，正常创建文件，关闭并使用 share deny none 和上面提到的标志重新打开它。然后让外部应用程序打开它并自己关闭它。一旦外部应用程序关闭文件，这应该会导致 Windows 删除该文件。

（我没有试过这个。）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-03T17:03:27.540

在类 Unix 操作系统中，通常的技巧是打开它并立即删除。它不会出现在目录中，但数据仍分配给保持它打开的进程。一旦它被关闭（或者进程死亡很好），文件系统就会回收空间。

这不是 hack，它已被记录和支持（将打开的文件句柄计为对文件的“引用”的结果，就像目录条目一样）。

也许Windows上有一些类似的技巧？我似乎记得 NTFS 支持对同一文件的多个引用（不，快捷方式不是那些）。如果是这样，删除文件但仍将最后一个引用作为临时资源挂起可能会起作用。

显然，我只是在这里猜测......

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-04T08:37:42.737

实际上，我们的应用程序在特定的临时文件夹中创建 de 文件。当应用程序关闭时，文件将被删除。如果应用程序未正确关闭，则下一次执行（关闭时）所有文件都将被删除。

此外，您可以启动后台进程来删除不再打开的文件。ShellExecute 返回一个句柄（在内部将此句柄关联到一个文件名）。该后台进程必须测试不存在的进程的句柄并删除关联的文件。

原谅英语不好。;-)

问候。

# java - 在java中，如何检查一个方法m是否改变了它的接收者的状态

> ID：945792
> 
> 赞同：1
> 
> 时间：2009-06-03T16:46:17.780
> 
> 标签：java, serialization

我正在尝试编写一个接收可序列化对象（实现可序列化）o和方法m的方法。该方法应该比较调用m之前和调用m之后o的状态，并判断调用m是否改变了o。它应该检查表示 o 的位是否在方法之后更改。嗬我能做到吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-03T17:13:49.680

如果您查看 jguru，[您会看到一个有用的示例](http://www.jguru.com/faq/view.jsp?EID=103437)：

> 将 ObjectOutputStream 包裹在 ByteArrayOutputStream 周围。将对象序列化到 ObjectOutputStream 之后会将对象存储在字节数组中：

```
ByteArrayOutputStream baos = new ByteArrayOutputStream();
ObjectOutputStream oos = new ObjectOutputStream(baos);
oos.writeObject(myObject); 
```

> 要恢复此对象，请反转该过程：

```
ByteArrayInputStream bais = new ByteArrayInputStream(baos.toByteArray());
ObjectInputStream ois = new ObjectInputStream(bais); 
Object myObject = ois.readObject(); 
```

如果您在调用方法之前和之后比较生成的字节数组，您将能够检测到对象是否受到影响。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-03T16:49:06.810

首先，在您的对象上正确实现 equals()（和 hashCode()）。您真的不需要再次序列化对象。只需反序列化原始对象并将其（通过 equals()）与您要检查更改的对象进行比较。

我认为你的意思是：

```
public void checkChanged(Serializable o, Method m) { .... } 
```

您仍然可以执行上述操作。您的假设是对象 o 正确实现了 equals() （和 hashCode），所有对象都应该这样做。您可以（如下文所述）比较字节流。这一切都取决于你所说的“改变”的真正含义。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-03T17:14:00.600

您可以使用[ByteArrayInputStream](http://java.sun.com/j2se/1.4.2/docs/api/java/io/ByteArrayInputStream.html)和[ByteArrayOutputStream](http://java.sun.com/j2se/1.4.2/docs/api/java/io/ByteArrayOutputStream.html)来读取和写入您的序列化对象并获取它们的字节表示。请参阅[测试对象序列化](http://www.ibm.com/developerworks/library/j-serialtest.html)中的详细信息。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-03T16:51:44.997

与 Java 中的对象进行比较通常是通过调用 equals() 方法进行的。您可以覆盖此方法以进行正确的比较，然后在方法调用之前和之后在实例上调用它。

另一种选择是比较对象的序列化表示

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-03T17:10:40.307

如果要比较对象的序列化版本，只需比较序列化对象创建的字节数组即可。

您不一定能说出发生了什么变化，但您将能够说出“某事”发生了变化。

编辑：你如何比较字节数组？严重地？

```
public boolean same(byte b1[], byte b2[]) {
    if (b1.length != b2.length) {
        return false;
    }
    for(int i = 0; i < b1.length; i++) {
        if (b1[i] != b2[i]) {
            return false;
        }
    }
    return true;
} 
```

我的意思是，你还能怎么做？这里没有魔杖。

# msbuild - 适用于 .Net 的 YUI 压缩器

> ID：945793
> 
> 赞同：2
> 
> 时间：2009-06-03T16:46:19.743
> 
> 标签：msbuild, yui, yui-compressor

我正在尝试在 MSbuild ( [http://yuicompressor.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=22364](http://yuicompressor.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=22364) ) 中使用 YIUCompression DLL，但是当我运行 MSBuild 时，我不断收到以下错误：

输出：

> 目标构建：
> 开始 Css/Javascript 压缩...
> 
> ```
> # Found one or more JavaScript file arguments. Now parsing ...
>     ** Obfuscate Javascript: Yep!
>     ** Preserve semi colons: Yep!
>     ** Disable optimizations: Hell No!
>     ** Line break position: None
>     ** Thread Culture: Not defined
> # 1 JavaScript file requested.
>     => C:\JSMinify\YIUCompressor\Test\disableButton.js    C:\JSMinify\YIUCompressor\Millena-I.Build.proj(17,5): error : Failed to read in the data for the path/file [C:\JSMinify\YIUCompressor\Test\disableButton.js]. The most common cause for this is because the path is incorrect or the file name is incorrect ... so please check your path and file names. Until you fix this up, I can't continue ... sowwy.
> C:\JSMinify\YIUCompressor\Millena-I.Build.proj(17,5): error : Value cannot be null.
> C:\JSMinify\YIUCompressor\Millena-I.Build.proj(17,5): error : Parameter name: value
>     Finished compressing all 1 file.
> Total original JavaScript file size: 405\. After compression: 0\. Compressed down to 0% of original size.
> Compressed content saved to file [C:\JSMinify\YIUCompressor\Test\disableButton.js]. 
> ```

```
Finished Css/Javascript compression.
Total time to execute task: 00:00:00.0312510 
```

> 在项目“Millena-I.Build.proj”中完成构建目标“Build”。
> 
> 完成建设项目“Millena-I.Build.proj”。
> 
> 构建成功。C:\JSMinify\YIUCompressor\Millena-I.Build.proj(17,5): 错误：无法读取路径/文件 [C:\JSMinify\YIUCompressor\Test\disableButton.js] 的数据。最常见的原因是路径不正确或文件名不正确...所以请检查您的路径和文件名。在您解决此问题之前，我无法继续... sowwy.C:\JSMinify\YIUCompressor\Millena-I.Build.proj(17,5): 错误：值不能为空。C:\JSMinify\YIUCompressor\Millena-I.Build.proj(17,5)：错误：参数名称：值

以下是我的构建脚本：

```
<!-- Execute CompressorTask for each file in the list -->
<CompressorTask
   Condition="'%(JavaScriptFiles.Identity)' != ''"
   JavaScriptFiles="%(JavaScriptFiles.Identity)"
   ObfuscateJavaScript="FoSho"
   PreserveAllSemicolons="Yeah"
   DisableOptimizations="Nope"
   EncodingType="Default"
   DeleteJavaScriptFiles="true"
   JavaScriptOutputFile="%(JavaScriptFiles.Identity)"
   LoggingType="ALittleBit" /> 
```

我已授予文件夹和文件的全部权限（已删除只读）。令人惊讶的是，当构建失败时，我的文件完全空白！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-05T15:59:26.517

我在上一个 ASP.NET 项目中使用了 Java 版本的 YUICompressor。它是否适合您，或者您只是对 .dll 文件感兴趣？以下是我的目标任务。

```
<Target Name="MinifyScripts" Condition="Exists('$(JAVA_HOME)')">        
    <YuiCompress Files="@(JavaScriptContent)" Type="JS" JavaHome="$(JAVA_HOME)" YUIHome="$(MSBuildStartupDirectory)\Resource\BuildTool\yuicompressor-2.4.1.jar" />
    <YuiCompress Files="@(CssContent)" Type="CSS" JavaHome="$(JAVA_HOME)" YUIHome="$(MSBuildStartupDirectory)\Resource\BuildTool\yuicompressor-2.4.1.jar" />
</Target> 
```

这真的很简单。尝试使用它。

Dave Ward 在这里写了一篇关于这个主题的好文章：

[在 Visual Studio 中自动缩小和合并 JavaScript](http://encosia.com/automatically-minify-and-combine-javascript-in-visual-studio/)

# .net - .NET MVC 并在页面之间安全地传递数据

> ID：945797
> 
> 赞同：3
> 
> 时间：2009-06-03T16:46:36.017
> 
> 标签：.net, asp.net-mvc, model-view-controller, persistence

先介绍一点背景信息。在我职业生涯的大部分时间里，我一直在使用 Web 窗体，并且最近对 .NET MVC 产生了兴趣。我意识到它的目的是无状态的，但是，我不明白它是如何完全可行的。在表单应用程序中，用户进行身份验证，然后我返回一个用户 ID 和一些角色，然后将它们放置在该用户会话中。当我需要它们时，我所要做的就是把它从会话中拉出来，然后我就拥有了。根据我的阅读，会话和 MVC 是互斥的。我读过可以使用 TempData 来传递值，但它只持续一页访问，然后就消失了。除了向我要传递数据的每个控制器添加冗余代码之外，是否有一种标准方法可以将数据“持久化”在 MVC 站点上？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-03T17:09:17.703

我认为这里的术语可能有些混乱。这里真正无状态的是 HTTP 协议。ASP.NET WebForms 是一种技术，旨在尝试构建一个“解决”HTTP 无状态的框架，并创建一个有状态的基于 Web 的应用程序框架。这就是为什么您会在 WebForms 中看到诸如 ViewState 之类的东西，它基本上沿管道传递应用程序的状态。

ASP.NET MVC 出现并采用了不同的方法。它包含 HTTP 的无状态性。这就是 MVC 中没有 ViewState 的原因。

但是，这并不意味着您不再与有状态实体进行交互。客户端机器（例如浏览器）是有状态的应用程序，就像运行服务器端代码（在本例中为 IIS 或其他）的服务器也是有状态的一样。

因此，服务器端的东西仍然是有状态的（如 Session、Application、Cache），您仍然可以使用它们。此外，客户端也是有状态的，这也是近年来客户端脚本变得如此强大的原因；人们试图充分利用浏览器的状态。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T16:54:05.693

ASP.NET MVC 框架建立在 ASP.NET 框架之上，因此，您可以在 ASP.NET MVC 中使用会话状态：

```
Session["MyVar"] = "SomeValue"; 
```

# c# - 我可以在实际的 aspx 中从我的 .NET 代码隐藏页面调用一个变量吗？

> ID：945807
> 
> 赞同：2
> 
> 时间：2009-06-03T16:49:22.410
> 
> 标签：c#, asp.net

在我的代码隐藏 .cs 文件中说，我设置了一个变量：

```
protected void Page_Load(object sender, EventArgs e)
{
    int x = 2;
} 
```

我想在我的 aspx 页面中动态显示它。但是这段代码不起作用：

```
<% Response.Write(x); %> 
```

我怎样才能做到这一点？有没有办法传递变量？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-03T16:50:50.910

您的变量仅存在于`Page_Load`方法中。

在类级别声明它，将其设置在`Page_Load`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-15T10:04:36.630

我知道这个问题很老，但供将来参考：

您的示例中的 x 是局部变量。这意味着它只能从方法范围内访问（在本例中为 Page_Load 事件）。要使此变量在您的 aspx 页面中可用，您可以将其设为属性。

**后面的代码：**

```
Protected int YourNumber {get; set; }

protected void Page_Load(object sender, EventArgs e)
{
    int YourNumber = 2;
} 
```

**ASPX 代码：**

```
<%= Response.Write(YourNumber); %> 
```

# c# - 如何在 C# 中将 Excel.Range.Interior.Color 转换为 System.Drawing.Color？

> ID：945808
> 
> 赞同：8
> 
> 时间：2009-06-03T16:49:32.753
> 
> 标签：c#, excel

我有一个 Excel 表，其中一些单元格具有一些背景颜色。我在 html 代码中需要这种颜色，因此我想将 Excel.Range.Interior.Color 转换为 RGB 格式或 System.Drawing.Color。

之后，我将使用 System.Drawing.ColorTranslator.ToHtml(System.Drawing.Color) 来获取要在 html 标签中使用的颜色。

我尝试执行以下操作：

```
Excel.Range r = (Excel.Range)m_objRange[2, 2];
System.ComponentModel.TypeConverter converter = System.ComponentModel.TypeDescriptor.GetConverter(r.Interior.Color);
               MessageBox.Show(""+converter.ConvertTo(r.Interior.Color,typeof(System.Drawing.Color))); 
```

但我得到一个错误，我无法将 System.Double 转换为 System.Drawing.Color

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-06-08T13:07:37.503

让 ColorTranslator 为您完成工作要容易得多：

```
System.Drawing.Color col = System.Drawing.ColorTranslator.FromOle((int) r.Interior.Color); 
```

当您在 Visual Studio 中使用自动生成的代理对象（而不是常规的 Interop 项目）编写 Excel 项目时，您需要将 r.Interior.Color 转换为 double，然后再转换回 int：

```
System.Drawing.Color col = System.Drawing.ColorTranslator.FromOle((int)((double) r.Interior.Color)); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-03T16:58:33.053

Excel.Range.Interior.Color 返回的值是一个颜色的长整数值。

**例子**：

'#000000 等于 0

'#FFFFFF 等于 16777215

您需要将十进制值转换为十六进制。从那里，很容易转换为 RGB。（分组为 2 个八位字节，然后转换回十进制）:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-01-14T23:46:49.213

这是我使用 Function 的方法，只需替换蓝色和红色字节。vb.net 中的用法示例：

```
Imports Microsoft.Office.Interop

Public Class Form1

    Dim Ex_Ap As Excel.Application
    Dim Ex_Wb As Excel.Workbook
    Dim Ex_Ws As Excel.Worksheet

    Function Excel_Color_Get(ByVal i As Int32) As Color
        Static c As Color
        c = Color.FromArgb(i)
        Return Color.FromArgb(c.B, c.G, c.R)
    End Function

    Private Sub Button5_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button5.Click
        Ex_Ap = New Excel.Application
        Ex_Ap.Visible = True
        Ex_Wb = Ex_Ap.Workbooks.Add
        Ex_Ws = Ex_Wb.Worksheets(1)
        Ex_Ws.Cells(7, 6).Value = "???"
        Ex_Ws.Cells(7, 6).interior.color = Color.Pink
    End Sub

    Private Sub Button6_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button6.Click
        Try
            TextBox1.BackColor = Excel_Color_Get(Ex_Ws.Cells(7, 6).interior.color)
        Catch ex As Exception
            TextBox1.Text = ex.ToString
        End Try
    End Sub

End Class 
```

# c# - TextChanged 事件仅在我将光标放在文本框中并更改文本时触发

> ID：945817
> 
> 赞同：0
> 
> 时间：2009-06-03T16:50:53.687
> 
> 标签：c#, asp.net

我在一个文本框上有一个 TextChanged，当我在其中输入数据时，它会更新另一个文本框，该文本框又应该触发一个 TextChanged 事件，但直到我将光标放在 TextBox 中它才会触发。有针对这个的解决方法吗？

数量变化时更新扩展价格的代码：

```
protected void txtQty1_TextChanged(object sender, EventArgs e)
    {
        if (txtQty1.Text != string.Empty && txtUnitPrice1.Text != string.Empty)
        {
            int qty = Convert.ToInt32(txtQty1.Text);
            double unitPrice = Convert.ToDouble(txtUnitPrice1.Text);

            double extendTotal1 = qty * unitPrice;

            txtExtPrice1.Text = extendTotal1.ToString();

        }
    } 
```

单价变化时更新扩展价格的代码：

```
 protected void txtUnitPrice1_TextChanged(object sender, EventArgs e)
    {
        if (txtQty1.Text != string.Empty && txtUnitPrice1.Text != string.Empty)
        {
            int qty = Convert.ToInt32(txtQty1.Text);
            double unitPrice = Convert.ToDouble(txtUnitPrice1.Text);

            double extendTotal1 = qty * unitPrice;

            txtExtPrice1.Text = extendTotal1.ToString();

        }
    } 
```

最后，这应该在扩展价格变化时更新总计：

```
 protected void txtExtPrice1_TextChanged(object sender, EventArgs e)
    {

        if (txtExtPrice1.Text != string.Empty)
        {
            double extendedTotal1 = Convert.ToDouble(txtExtPrice1.Text);
            double grandTotal = Convert.ToDouble(txtGrandTotal.Text);

            grandTotal += extendedTotal1;

            txtGrandTotal.Text = grandTotal.ToString();
        }

    } 
```

我是否应该将总计设为静态变量？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T17:28:20.427

不知道这是否有帮助，因为代码（大部分）对我有用，但我在总计中得到了奇怪的总数，所以我将事件处理程序更改为 Quantity 和 UnitPrice 的“验证”（并将它们都连接到相同的事件处理程序，因为他们正在做完全相同的事情......）（编辑：是的，我伪造了一些逻辑，包括在 GrandTotal 为空时任意设置）。

```
 private void textBox1_Validating(object sender, CancelEventArgs e)
    {
        if (!String.IsNullOrEmpty(textBox1.Text) && !String.IsNullOrEmpty(textBox2.Text))
        {
            int qty = int.Parse(textBox1.Text);
            double price = double.Parse(textBox2.Text);

            double totalPrice = qty * price;

            textBox3.Text = totalPrice.ToString();
        }
    }

    private void textBox3_TextChanged(object sender, EventArgs e)
    {
        double bTotal = double.Parse(textBox3.Text);
        if (String.IsNullOrEmpty(textBox4.Text)) textBox4.Text = "100.00";
        double gTotal = double.Parse(textBox4.Text);

        gTotal += bTotal;

        textBox4.Clear();
        textBox4.Text = gTotal.ToString();
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T17:29:31.203

textchanged 事件没有在第二个文本框中触发，因为它没有焦点。

当您想将文本更改为触发时，请在之前添加此行。

txtBox2.Focus();

// 用第二个文本框做你需要做的事情。

txtBox1.Focus() ;

这应该工作

苏杰

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T16:58:55.923

只需调用代码来更新第一个 textchanged 事件的总计，当您尝试级联到另一个事件时，不用担心它不起作用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T17:21:56.830

可能是一个愚蠢的问题，但所有这些事件都与相应的控件挂钩吗？

如果是这样，每个事件的第一行上的断点应该可以帮助您超级快速地找到问题。

如果没有，那就是你的问题:)。

**更新：**
我相信我发现了你的问题。如果您以*编程*方式将文本框值设置为其已包含的相同值，则**不会**触发 TextChanged 事件。

因此，在您的情况下，如果您将 txtQty1 或 txtUnitPrice1 文本框中的值更改为它们已经包含的相同值，那么 txtExtPrice1 文本框中的值将以*编程*方式更新为它已经包含的相同值；因此，您的 txtGrandTotal.Text 属性没有更新，因为更新它的事件 ( **txtExtPrice1_TextChanged** )**没有**被触发。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-03T18:08:39.583

您的基本问题是您正在尝试使用 GUI 控件来执行业务逻辑。这总是一个坏主意。GUI 控件被设计为只做一件事并且只做一件事：与用户交互。试图用它们做任何其他事情，例如执行计算，只会导致问题。

尝试阅读 MVP（或 MVVM）模式。它将向您展示如何在模型中存储视图的逻辑数据，这也是您进行所有计算的地方。GUI 控件仅在模型中的相应数据发生更改时更新。例如，您的模型的部分实现可能如下所示：

```
public class Model : INotifyPropertyChanged {

#region INotifyPropertyChanged implementation
   public event PropertyChangedEventHandler PropertyChanged;
   protected virtual void OnPropertyChanged(string propertyName) {
      var handler = PropertyChanged;
      if(null != handler)
         handler(this, new PropertyChangedEventArgs(propertyName));

      switch(propertyName){
         case Quantity:
         case UnitPrice:
            OnPropertyChanged("ExtendedPrice");
            break;
         case ExtendedPrice:
            OnPropertyChanged("Tax");
            OnPropertyChanged("GrandTotal");
            break;
         case Tax:
            OnPropertyChanged("GrandTotal");
            break;
      }
   }
#endregion

   private int _quantity;
   public int Quantity{
      get { return _quantity; }
      set {
         if (value != _quantity) {
            _quantity = value;
            OnPropertyChanged("Quantity");
         }
      }
   }

   private decimal _unitPrice;
   public decimal UnitPrice {
      get { return _unitPrice; }
      set {
         if (value != _unitPrice) {
            _unitPrice = value;
            OnPropertyChanged("UnitPrice");
         }
      }
   }

   public decimal ExtendedPrice {
      get { return Quantity * UnitPrice; }
   }

   public decimal Tax {
      get { return ExtendedPrice * TaxRate; }
   }

   public decimal GrandTotal {
      get { return ExtendedPrice + Tax; }
   }
} 
```

现在，您视图中的控件可以绑定到模型的属性，并且您可以确定无论 Quantity 或 UnitPrice 如何更改（无论是用户通过控件还是您自己的代码），派生的金额将相应更改。

# c# - C# 从本地目录获取 URL 路径

> ID：945825
> 
> 赞同：3
> 
> 时间：2009-06-03T16:53:06.960
> 
> 标签：c#, url, path, directory, virtual

这是我的程序：我正在将图像（Stream、FileInfo 或任何你喜欢的）上传到此虚拟目录中的服务器：“C:\_Resources\Assets”

但是，我希望服务器返回该图像的 URL 路径以将其显示在标签中，即“ [http://localhost/Trunk/Assets/image.jpeg](http://localhost/Trunk/Assets/image.jpeg) ”

事实上，我正在尝试与 Server.MapPath 方法相反。

请问我怎么得到？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-07T18:03:56.137

url = "\\" + Environment.MachineName + Path.GetFullPath(document.FileName).ToString().Split(':')[1];

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-05T12:58:30.443

为什么不直接创建一个字符串并将 "C:_Resources" 替换为 "/Trunk" 呢？可能并不理想，但它应该让你继续前进。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-09-28T20:25:47.883

```
string file = "\\\\" + someServer + "\\" + someFile;
file = file.Replace(":\\","$\\"); 
```

而且，如果您不想使用那些窗台转义字符...

```
string file = @"\\" + someServer + @"\" + someFile;
file = file.Replace(@":\",@"$\"); 
```

# c# - LeftMouseButtonDown 不适用于路由事件中的按钮

> ID：945826
> 
> 赞同：0
> 
> 时间：2009-06-03T16:53:39.393
> 
> 标签：c#, wpf, .net-3.5, routed-events

我正在学习 wpf 中的路由事件，并尝试以下示例，

文件——Window1.xaml

```
<ScrollViewer VerticalScrollBarVisibility="Auto">
    <UniformGrid MouseDown="UniformGrid_MouseDown">
        <Button x:Name="Button1">1</Button>
        <Button x:Name="Button2">2</Button>
        <Button x:Name="Button3">3</Button>
        <Button x:Name="Button4">4</Button>
        <Button x:Name="Button5">5</Button>
        <Button x:Name="Button6">6</Button>
        <Button x:Name="Button7">7</Button>
        <Button x:Name="Button8">8</Button>
        <Button x:Name="Button9">9</Button>
    </UniformGrid>
</ScrollViewer> 
```

文件——Window1.xaml.cs

```
private void UniformGrid_MouseDown(object sender, MouseButtonEventArgs e)
{
    Button aTargetButton = e.Source as Button;
    if (aTargetButton != null)
    {
        aTargetButton.Background = Brushes.Azure;
        aTargetButton.LayoutTransform = new RotateTransform(45);
        if (myPreviouslyClickedButton != null)
        {
            myPreviouslyClickedButton.Background = Brushes.White;
            myPreviouslyClickedButton.LayoutTransform = new RotateTransform(0);
        }
        myPreviouslyClickedButton = aTargetButton;
    }
} 
```

当我运行这些代码片段时，只有当我右键单击相应的按钮时（即使我已经订阅了 MouseDown），相应的按钮才会经历角度转换。你能帮我解决这个问题吗？

更新：

如果我用椭圆替换按钮，这个片段似乎有效。当椭圆可以时，为什么按钮不能对左键做出反应。如果我多次单击同一个椭圆，也不会引发事件

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T17:33:39.983

您的鼠标按下事件正在由按钮处理。

如果您希望您的网格处理按钮事件，那么您可以执行以下操作：

```
 <ScrollViewer VerticalScrollBarVisibility="Auto">
    <UniformGrid Button.Click="UniformGrid_Click">
        <Button x:Name="Button1" Margin="10">1</Button>
        <Button x:Name="Button2">2</Button>
        <Button x:Name="Button3">3</Button>
        <Button x:Name="Button4">4</Button>
        <Button x:Name="Button5">5</Button>
        <Button x:Name="Button6">6</Button>
        <Button x:Name="Button7">7</Button>
        <Button x:Name="Button8">8</Button>
        <Button x:Name="Button9">9</Button>
    </UniformGrid>
    </ScrollViewer> 
```

并将源更改为：

```
private void UniformGrid_Click(object sender, RoutedEventArgs e)
    {
        // Your code here
    } 
```

[这里](http://msdn.microsoft.com/en-us/library/ms742806.aspx)有一篇 msdn 文章值得一读。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T17:27:13.377

这工作正常。在内部，`Button`处理`MouseDown`事件以知道何时触发其`Click`事件。我发现[Snoop](http://blois.us/Snoop/)是跟踪 WPF 事件问题或只是更好地了解它们如何工作的好工具。

# java - Portlets - 从服务器端保持会话活动

> ID：945828
> 
> 赞同：3
> 
> 时间：2009-06-03T16:53:46.133
> 
> 标签：java, spring, session, portlet

我正在实现 jsr 186 portlet，其中包含一些 servlet 来实现一些 ajax。问题是如果我只进行一段时间的 AJAX 调用，我会丢失会话。奇怪的是，保持 servlet 会话处于活动状态并不能防止 portlet 会话超时。

有没有办法让我在服务器端的 servlet 中保持会话处于活动状态？

FWIW 我正在使用 spring 和 spring mvc/portlet。

谢谢，米格尔平

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-02-01T09:18:40.670

我有同样的问题。（使用 OpenPortal Portlet 容器）

据我所知，有两个不同的会话，1-portlet 会话，2-容器会话。

我创建了一个简单的 portlet，并定期从容器中使用 ajax 向 portlet 发出请求。但是，会话超时。我的代码部分在这里：

```
<%
    int per=15000; //ms
    String sessionExtenderPath = "http://portal.abc.com.tr:8080/SessionExtend/SessionExtend";
    //This is a portlet which includes servlet that returns a simple string.
%>

<script>
    periyod=100;

    function invokeRequest(){
     $.get("< %=sessionExtenderPath% >", function(data) {
      alert(1);
     });
    }
    window.setInterval("invokeRequest()",periyod);
</script> 
```

我通过请求容器页面（没有为 portlet 定义通道）解决了我的问题。

感谢您的编辑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-25T19:07:55.070

我使用一个不断轮询portlet url 的javascript 计时器来实现它。portlet url 是预先生成的，因此可以在 javascript 中访问。

# linux - 克服行为不端的 Linux 进程？

> ID：945840
> 
> 赞同：1
> 
> 时间：2009-06-03T16:56:01.947
> 
> 标签：linux, bash, scripting

我有一个行为不良的进程（通过用户命令启动），它以不稳定的时间间隔死去，我需要它保持活力，直到我手动杀死它。这是我的直截了当但可能是愚蠢的解决方案：

```
#!/bin/bash

if [ -z $1 ]
then
 echo "Usage: /s98ize.sh <process name>"
 exit
fi

#start of the 'polling' loop

while [ 1 ]
do

pgrep $1

if [ $? -eq 0 ]
then
 echo "Already running"
else
 # If process has died or not started, start it
 $1
 # FIXME: I have not done any error checking this script will not catch a
 # unavailable command
fi

done

# end of the polling loop 
```

要点是：如果上述进程正在运行，则不执行任何操作，否则启动它。一个非常直接的缺点是它一直在“轮询”。但是，它符合我的目的。

在我写这篇文章的时候，我想我可以对进程进行信号处理，这样一旦它收到 kill 信号，我就可以重新启动它？你怎么看？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-03T16:58:12.600

您可以将它放在 /etc/inittab 中，init(8) 会自动为您重新启动它。

您可以定义进程运行的运行级别，因此它不必在启动时启动。您还可以使用 sed(1) 之类的程序以编程方式编辑 inittab 并向其中添加一行，然后告诉 init(8) 重新加载配置文件（并启动您的程序）： init q

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-03T16:58:29.823

你考虑过 djb 的[监督](http://cr.yp.to/daemontools/supervise.html)程序吗？它正是这样做的：运行一个程序，如果它退出则重新启动它，提供一种控制它的方法，等等？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T21:06:45.967

如果您想使用 bash 脚本重新生成进程，请不要误以为依赖 pgrep 等损坏的工具。此外，您的 bash 代码会遭受分词和意外路径名扩展错误的严重影响。

做这个：

```
#!/usr/bin/env bash

until "$@"; do
    echo "$1 exited with exit code: $?.  Respawning .."
    sleep 1
done 
```

这样`sleep`做是为了避免进程因导致无限循环而立即死亡，从而导致 CPU 干涸。

还要注意`"$@"`.

该`until`关键字将继续重新启动您的进程，直到它干净地退出（退出代码为 0），这意味着它退出而没有出错（可能是因为您要求它停止，例如，在重新启动系统时）。

假设它被称为 ' `respawn`' 并且在 PATH 中，请像这样使用它：

```
respawn mycommand --foo=bar 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-03T20:11:42.270

您应该尝试*解决问题*，而不是*治愈症状*。我的意思是找出程序“正在死去”（崩溃）的原因，并在可能的情况下修复它（大多数 Linux 程序都是开源的，使您能够准确地做到这一点）。

 *要查找程序 ( *wvdial* ) 失败的原因，您可以执行以下操作：

在启动 wvdial 的 shell 中使用*ulimit -c unlimited*，这样如果它崩溃，它将生成一个核心文件，然后使用*gdb --core /path/to/wvdial对其进行调试*

如果尚未安装，您可能需要先使用包管理器安装应用程序/库的调试信息。

如果您不能（或不会）这样做，那么您可以使用[monit](http://mmonit.com/monit/)自动重新启动您的进程。这是一个[博客](http://www.cyberciti.biz/tips/howto-monitor-and-restart-linux-unix-service.html)，展示了如何将 monit 用于 Web 服务器。

> Monit 是一个免费的开源实用程序，用于管理和监视 UNIX 系统上的进程、文件、目录和文件系统。Monit 进行自动维护和修复，并且可以在错误情况下执行有意义的因果操作。

# sql - 复杂访问 SQL 查询排除

> ID：945842
> 
> 赞同：0
> 
> 时间：2009-06-03T16:57:13.990
> 
> 标签：sql, ms-access, select

对于如下所示的访问数据库：（所有文本字段）

```
Co1 Co2 Co3 Co4
A kt N1
B kt N2
吨 N3
B kz N4
一千零N5
C mt N6
C kz N7
C kt N8
阿克拉N9
C mt N10

```

我需要创建一些可以执行以下操作的报告：

结果需要选择行：

1.  Co1 优先订购
2.  然后由 Co2 订购
3.  仅包含 Co3 = t 或 r 的数据
4.  当 Co3 既不是 t 也不是 r 时，也排除所有其他具有先前 C04 且 Co1 和 Co2 与当前行相同的行

1,2 和 3 非常容易做到（分别是 Order by 和 Where 子句），但 #4 可以在访问 SQL 中完成吗？如果不能，我将制作一个循环数据的小型 C# 应用程序，但我觉得这必须可以在 SQL 中完成，如果可以，那肯定会好得多。

实际的查询和数据库更复杂，但#4 是我卡住的地方。

通过我给出的示例，结果将是：

```
吨 N3
阿克拉N9
C mt N6
C mt N10
C kt N8
```

我相信这涵盖了所有可能的情况。

精度，我们使用第四列（本例中为 C4）来确定顺序，但它是一个包含字符和数字的文本字段。该字段是一个字母后跟 2 位数字：A01、A02、..A99、B01 等...精度 #2，我不是这个数据库设计的罪魁祸首。:P

那么，对于我们当中的 SQL 大师来说，这可以在访问 SQL 中完成吗？如何？

非常感谢您提供的任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T17:54:51.190

如果我没看错的话：

> 当 Co3 既不是 t 也不是 r 时，也排除所有其他具有先前 C04 且 Co1 和 Co2 与当前行相同的行

这相当于排除存在具有特定条件的后一行的行。您可以使用 NOT EXISTS 子句来做到这一点：

```
select *
from YourTable cur
where cur.Co3 in ('t','r')
and not exists (
    select *
    from YourTable later
    where cur.Co1 = later.Co1 
    and cur.Co2 = later.Co2
    and later.Co3 not in ('t','r') 
    and CInt(Mid(later.Co4,2)) > CInt(Mid(cur.Co4,2))
)
order by cur.Co1, cur.Co2 desc, CInt(Mid(cur.Co4,2)) 
```

现在N10通常不大于N5。这就是 CInt(Mid(...,2)) 的用途：它将 N10 变成数字 10，将数字 N5 变成 5。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T18:23:59.820

对 Andomar 查询的修改，它考虑到 Co4 中以不同字母开头的值，通过使用字符代码的 ASCII 值来确定顺序。我假设范围是 A01...A99、B01...B99 等，并且 B01 应该被认为比 A99“晚”。

```
select *
from Table1 cur
where not exists (
    select 1
    from Table1 later
    where cur.Co1 = later.Co1 
    and cur.Co2 = later.Co2
    and later.Co3 not in ('t','r') 
    and (asc(left(later.Co4,1)) * 100) + CInt(Mid(later.Co4,2)) > (asc(left(cur.Co4,1)) * 100) + CInt(Mid(cur.Co4,2))
)
and cur.Co3 in ('t','r')
order by cur.Co1, cur.Co2 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T18:56:30.143

还不是答案，而是为其他回答者设置代码。

```
create table #boost (
  Co1 char(1),
  Co2 char(1),
  Co3 char(1),
  Co4 char(3)
)

insert into #boost values ('A', 'k', 't', 'N1')
insert into #boost values ('B', 'k', 't', 'N2')
insert into #boost values ('A', 'm', 't', 'N3')
insert into #boost values ('B', 'k', 'z', 'N4')
insert into #boost values ('A', 'k', 'z', 'N5')
insert into #boost values ('C', 'm', 't', 'N6')
insert into #boost values ('C', 'k', 'z', 'N7')
insert into #boost values ('C', 'k', 't', 'N8')
insert into #boost values ('A', 'k', 't', 'N9')
insert into #boost values ('C', 'm', 't', 'N10') 
```

# matlab - 建模和仿真编程语言

> ID：945846
> 
> 赞同：4
> 
> 时间：2009-06-03T16:57:52.867
> 
> 标签：matlab, model, fortran, simulation, simulink

我使用许多不同的模型和模拟。一些较旧的模型和模拟是用 FORTRAN 编写的。其中一些模型已转换为 C++，但当前趋势是使用 MATLAB/SIMULINK 创建这些模型。从计算机科学的角度来看，我一直觉得 MATLAB/SIMULINK 不是一个好的解决方案。您使用什么语言来创建模型和模拟，为什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-03T18:08:14.813

我总是会尝试使用最好的建模和仿真*工具*（或库，如果你愿意）提供的语言来为我完成这项工作。

而这个问题真的只能通过考虑你想要实现什么*样的模型来回答。*连续（例如 ODE）、离散（例如 StateCharts、Petri 网）或组合（即混合模型，可以使用 Simulink+StateFlow 实现）？每种模型都有各种工具。

另一个重要方面是您工作的*领域。*Simulink 为电气工程、金融或计算生物学提供了相当广泛的库（不过，它们中的大多数都包含在附加软件包中） - 如果您在这些领域之一工作，可能根本没有更好（即完整、有效）的组件库. 其他商业仿真包也是如此，例如[AnyLogic](http://www.xjtek.com/)、[Arena](http://www.arenasimulation.com/)等。可能还会有一些开源仿真工具，具体取决于您的建模问题。

最后，您可能更喜欢一种特定的编程语言而不是另一种，并且您可能有其他要求，例如支持

*   优化（模型参数）
*   验证
*   输出分析（统计、绘图、统计检验）
*   支持并行和分布式仿真
*   模型检查
*   ...

所以我目前正在使用具有众所周知的优势的 Java——相当快、对多线程的良好支持、相对简单的使用等。但如果“相当快”还不够快，可能别无选择，只能下降一级抽象:-)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-03T17:02:06.793

我还使用大量遗留代码，其中大部分是 Fortran 代码。我真的不介意使用 Fortran - 所有现代编译器都允许变量名大于旧的和愚蠢的 6 个字符限制。此外，使用 Fortran 95，如果您认为对现有代码库的修改会受益，您甚至可以执行 OOP。

此外，Fortran 有非常好的代码编辑器，但对于更专业的脚本语言并不总是如此。

C++ 在内存考虑方面有很大的缺点。我已经编写 C/C++ 20 多年了，但我仍然忘记删除对象并正确填写析构函数。

最后一点，如果您使用的是 Windows，如果您想将 Fortran 迁移到托管环境，则可以使用 Fortran.NET 编译器（我认为来自 Lahey-Fujitsu？）。

祝你好运！

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-04T01:41:27.283

当然是模拟！！:-)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-04T14:15:39.140

我从 MATLAB 中得到的是它能够让我快速原型化算法。通过绘制数据并使用内置的统计功能，我真的可以很好地了解数据。当尝试新事物时，我可以做一些快速而肮脏的事情以获得一些初步结果，然后回去清理东西以改进我的结果。使用编译语言，为了让模拟运行，我还有很多工作要做。使用 MATLAB，我花更多的时间思考真正的问题，而不是编译、链接、内存管理等。

但是，MATLAB 无法解决许多问题。对于大型数据集，具有用户定义数据结构的编译语言几乎肯定是必要的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-04T01:36:41.850

粒子物理学已经转向 C++ 和 python。[这不是普遍的，如果不是因为ROOT](http://root.cern.ch/)的普遍存在，可能甚至不会接近。

Root 对 cint 的使用意味着当你在琢磨一个新想法时，你需要费心管理内存，它的运行编译能力让你有速度，混合模式的能力非常有帮助，以及 python 和其他的绑定RAD 语言具有很大的灵活性。

从非常真实的意义上说，这归结为对[**罗兰**观点](https://stackoverflow.com/questions/945846/modeling-and-simulation-programming-language/946274#946274)的认可。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-06-20T19:08:43.110

您可以使用 s-funcuin 块将 fortran(c,c++) 与 matlab 链接。

# .net - 在 .NET 中构建 POST 请求正文的内置方法？

> ID：945847
> 
> 赞同：2
> 
> 时间：2009-06-03T16:58:00.417
> 
> 标签：.net, http, post

我正在寻找 .NET 中的**内置**实用程序方法，用于为两种常见的内容类型构建 HTTP POST 消息体：

*   应用程序/x-www-form-urlencoded
*   多部分/表单数据

我宁愿使用其他人的现成且经过测试的实现，也不愿使用我自己的实现，尽管我意识到这样做并不难。但是，似乎没有任何`System.Web`效果。

有什么建议么？

（无需解释如何手动构建 POST 消息体......这不是这个问题的内容）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T19:18:39.833

更简单的是，我喜欢 WebClient.UploadValues 方法。只需给它一个 NameValueCollection，它就会处理其余的：

[http://msdn.microsoft.com/en-us/library/system.net.webclient.uploadvalues.aspx](http://msdn.microsoft.com/en-us/library/system.net.webclient.uploadvalues.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T17:05:20.923

对于`application/x-www-form-urlencoded`内容类型，只需使用`UrlEncode`方法。

示例（在 C# 中）：

```
string body =
   "this=" + HttpUtility.UrlEncode(valueForThis) +
   "&" +
   "that=" + HttpUtility.UrlEncode(valueForThat) +
   "&" +
   "more=" + HttpUtility.UrlEncode(valueForMore); 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-06-03T19:30:39.107

```
Imports System.IO
Imports System.Net

Private Function PostWebPage(ByVal argUrl As String) As String
    Dim objWebRequest As HttpWebRequest
    Dim sPostData As New StringBuilder
    Dim sr As StreamReader
    Dim objWebResponse As HttpWebResponse
    If argUrl.Length > 0 Then
        Try
            objWebRequest = CType(WebRequest.Create(argUrl), HttpWebRequest)
            objWebRequest.UserAgent = "Mozilla/4.0+(compatible;+MSIE+6.0;+Windows+NT+5.1;+.NET+CLR+1.1.4322;+.NET+CLR+1.0.3705)"
            sPostData.Append("accountType=GOOGLE&Email=*******@gmail.com&Passwd=*******&service=analytics&source=Test")
            objWebRequest.Method = "POST"
            objWebRequest.ContentType = "application/x-www-form-urlencoded"
            objWebRequest.ContentLength = sPostData.ToString.Length
            Dim stOut As New StreamWriter(objWebRequest.GetRequestStream, System.Text.Encoding.ASCII)
            stOut.Write(sPostData)
            stOut.Close()
            objWebRequest.AllowAutoRedirect = True
            objWebRequest.Timeout = 10000
            objWebRequest.KeepAlive = True
            objWebResponse = CType(objWebRequest.GetResponse(), HttpWebResponse)
            sr = New StreamReader(objWebResponse.GetResponseStream)
            Return sr.ReadToEnd
            Exit Function
        Catch ex As Exception
        End Try
    End If
    Return ""
End Function 
```

# xml - xml模式“元素的顺序很重要”规则有什么好的理由吗？

> ID：945856
> 
> 赞同：0
> 
> 时间：2009-06-03T16:58:50.307
> 
> 标签：xml, design-patterns

我不明白为什么元素的顺序很重要，但属性的情况并非如此。

任何人都可以提供一个合理的理由吗？

```
element addressBook {
  element card {
    attribute name { text },
    attribute email { text }
  }*
} 
```

在 XML 中，属性的顺序传统上并不重要。RELAX NG 遵循这一传统。上述模式将同时匹配

```
<card name="John Smith" email="js@example.com"/> 
```

和

```
<card email="js@example.com" name="John Smith"/> 
```

相反，元素的顺序很重要。图案

```
element card {
  element name { text },
  element email { text }
} 
```

不匹配

```
<card><email>js@example.com</email><name>John Smith</name></card> 
```

那这个呢：

如果元素或属性的子项与数据类型模式匹配，则元素或属性的完整内容必须与该数据类型模式匹配。不允许有一个模式允许部分内容匹配数据类型模式，而另一部分匹配另一个模式。例如，不允许使用以下模式：

```
element bad {
  xsd:int,
  element note { text }
} 
```

但是，这会很好：

```
element ok {
  xsd:int,
  attribute note { text }
} 
```

请注意，此限制不适用于文本模式。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-03T17:12:18.073

我怀疑这是因为属性名称在元素中必须是唯一的，并且无论顺序如何都可以消除歧义，而包含的元素不必是唯一的。区分其他相同元素的唯一方法是通过它们的顺序。当订单很重要时，这一点很重要。例如：

```
<li>Put on underwear</li>
<li>Put on pants.</li> 
```

在语义上不同于

```
<li>Put on pants.</li>
<li>Put on underwear</li> 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-03T17:11:41.990

订购通常很重要。例如，想象一下如果 XHTML 段落是随机重新排序的。然而，属性自然是一个“属性包”——一组值而不是一个序列。这也是为什么您不能使用元素声明重复属性但可以重复具有相同名称的元素的原因。

这只是 XML 设计方式的一部分。属性和元素在很多方面都不同，而不仅仅是排序。*有时将*元素视为与顺序无关是有意义的，但这意味着什么将取决于具体情况。但是，如果将排序无关紧要的一种情况视为它*永远*不重要的一揽子理由，那将是错误的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-03T17:13:06.450

因为具有相同名称的元素可以重复，例如

```
<List>
    <Item>a</Item>
    <Item>b</Item>
    <Item>c</Item>
</List> 
```

而属性不能，例如

```
<List Item="a" Item="b" Item="c" /> <!-- illegal --> 
```

这意味着元素对事物列表很有用，而属性则不然。由于列表通常是位置性的，因此从 XML 中的顺序推断位置是有意义的，这比以下内容更容易混淆（这需要特别了解指示位置的方式或额外的 XML 保留字）用于此，这两者都不是一个有吸引力的选择）。

```
<List>
    <Item Position="2">a</Item>
    <Item Position="1">b</Item>
    <Item Position="3">c</Item>
</List> 
```

# css - CSS宽度问题子父

> ID：945858
> 
> 赞同：3
> 
> 时间：2009-06-03T16:58:57.310
> 
> 标签：css, html, width

我在 div A 里面的 div B 里面有一个 div C。

div A 的宽度设置为 700px，div C 的宽度设置为 100px。Div B 没有设置宽度。

我的问题是 div B 将他的宽度扩展到 100%（以符合 div A 的宽度）。有没有办法让div B，即他的宽度符合子div？我希望它包裹在 div C 周围，以及我放在 div C 附近的任何其他 div。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2011-03-09T17:30:43.127

您可以使用以下代码来实现您的结果：

```
#b {
  margin:0px auto;
  overflow:hidden;
  display:table;
} 
```

这应该会给出您想要的结果。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-03T17:09:30.090

使 B div 成为浮动元素，以使其宽度适应其子元素。

```
<div id="B" style="float:left;"> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-03T18:10:08.770

听起来您想要的是不存在的 float:center 属性。查看[这篇文章](http://www.wipeout44.com/brain_food/css_staying_afloat.asp)以获取解决方法。

# flash - 在已编译的 SWF 文件中更改变量值的最佳方法

> ID：945859
> 
> 赞同：4
> 
> 时间：2009-06-03T16:59:12.100
> 
> 标签：flash, actionscript-3, flex3

在将修改后的 SWF 返回给客户端之前，是否可以通过 servlet（例如基于每个会话）更改已编译 SWF（使用 as3）中变量的值。我注意到有一些命令行实用程序作为开源，但这些似乎专注于 AS2。使用 AS3 代码可以做到这一点吗？java 有哪些可用的库？（即，基本上在未捆绑的 SWF 中编辑生成的 pcode，然后重新打包它）。

理想情况下，希望在主 swf 中嵌入每个会话令牌（不使用 flash vars），然后可以使用该令牌对请求进行身份验证。目标是使用这个说法作为 XSS 支持的又一步（当与跨域权限文件结合使用时）。Flash vars 仍然在 DOM 中，但这将只允许加载器知道键的值（对于 java 脚本来说非常困难），我们可以很好地锁定 flash，不将值暴露给任何加载的 swfs，并且跨域files 可以限制原始 swf （仅来自该域的一个）对原始服务器上的任何 xml 文件的读取。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T21:20:08.497

部分问题在于编译的 SWF 在内部使用 zlib 流进行压缩，因此在不从命令行 SDK 重新编译的情况下修改二进制文件并非易事。

使用命令行工具（mxmlc 或 Ant——我们在我们的项目中都使用）设置和自动化 Flex SDK 并不难，但如果您真的坚持要修改二进制文件而不重新编译，那么你可能会发现[这篇博文](http://kaioa.com/node/87)有帮助。它包含一个实用程序，用于将内部流解压缩为其原始数据，并使用不同的压缩算法重新压缩。在该脚本的中间（当数据被解压缩时），您可以在二进制文件中搜索您正在寻找的值（通过实验找到的已知偏移量，或从公共成员标签），更改数据，重新压缩流，瞧——你有一个自定义的 .swf。如果您更改嵌入式资产（例如文本 XML 文件）中的值，您可能更容易在二进制文件中找到要更改的数据。

[swf_recompress.zip](http://kaioa.com/b/0808/swf_recompress.zip)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T17:05:07.227

您可以在请求时使用 Flex SDK 从源代码编译 swf。我建议使用一个非常小的 swf，然后可能会加载其他更复杂的 swf。

# c# - 使用什么通用/动态集合？（设计问题）

> ID：945861
> 
> 赞同：1
> 
> 时间：2009-06-03T16:59:22.910
> 
> 标签：c#

我们正在创建一个简单但经过改进的计费解决方案。由于我们必须基于许多现在不重要的原因使用不同的提供程序，所以我正在考虑什么是处理这个问题的最佳方法。不同的提供者可能有一个键和一个值。我可以将值存储为对象，但我也需要存储类型。我正在考虑创建一个嗯让我们称之为 Tuple 类：

```
public class Tuple<TType, TValue>
{
    public TType Type { get; set; }
    public TValue Value { get; set; }
} 
```

现在我可以使用它来存储类型引用，但我感觉缺少了一些东西。要将其与字典之类的查找集合一起使用，我可以：

```
public IDictionary<string, Tuple<Type, object>> TechnicalDetails = 
  new Dictionary<string, Tuple<Type, object>> 
```

改进建议？一定有更好的方法吗？:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T17:03:09.677

您要在字典中存储多少项目？混合[字典](http://msdn.microsoft.com/en-us/library/system.collections.specialized.hybriddictionary.aspx)可能会提供更好的性能？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T17:07:33.523

在这种情况下，我倾向于编写一个类来包含/隐藏数据结构，并提供方法和属性来抽象出数据结构的细节，在这种情况下，你的`Dictionary<string, Tuple<Type, object>>`.

Find()、Get()、Add()、Remove() 等方法很容易添加，因为数据结构本身已经有类似的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T17:38:30.957

表示任何实例的方法不止一种。

```
Dictionary<string, XElement> 
```

# javascript - 从不同的路径检索 cookie

> ID：945862
> 
> 赞同：16
> 
> 时间：2009-06-03T16:59:30.710
> 
> 标签：javascript, path, dns, cookies

我当前的文档 URL 是 http://127.0.0.1/foo，我需要更改 http://127.0.0.1/bar 的 cookie 值。document.cookie 是空的，因为文档的 URL 是 foo。目前，我只想读取 cookie 值。有什么线索吗？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-06-03T17:02:13.627

创建 cookie 时，如果将路径设置为“/”而不是“foo”，您将能够在域中的任何位置读取它，包括“/foo”、“/bar”等。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-06-28T11:32:00.820

您可以在 内部创建一个`<iframe>`指向资源`/bar`，并将跨框架脚本插入其中。例如：

```
<iframe src="/bar/blank.html" id="barframe"></iframe>

var barframe= document.getElementById('barframe');
var bardocument= 'contentDocument' in barframe? barframe.contentDocument : barframe.contentWindow.document; // IE compat
alert(bardocument.cookie); 
```

Cookie`path=`是一种防止意外 cookie 名称冲突的便利措施。鉴于不同的路径共享一个 JavaScript 源，它不是一种有效的安全机制。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-04T11:39:37.940

正如 JJ 和 grawity 所提到的，您无法从您的页面执行此操作。但是，您有一个解决方法。

一世。放置一个指向[http://localhost/bar](http://localhost/bar)的 iframe 。在存储 cookie 值的“栏”页面上有一个隐藏元素。（让这个 iframe 为 1*1 大小，所以它不可见）。

ii. 在“foo”页面上使用 JavaScript 来获取 cookie 值。

也可以使用类似的方法（经过修改）来写入 cookie 值！

谢谢，

拉姆吉。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-06-03T17:03:03.687

您不能从不同的路径访问 cookie - 否则这将是一个安全漏洞。

我能想到的唯一方法是`/bar`设置一个cookie，以便（包括）`path=/`中的所有页面都可以访问它。`/``/foo`

# c# - 工作单元模式的 .net 参考实现是什么？

> ID：945864
> 
> 赞同：2
> 
> 时间：2009-06-03T16:59:58.590
> 
> 标签：c#, nhibernate, design-patterns, orm, unit-of-work

[工作单元](http://www.martinfowler.com/eaaCatalog/unitOfWork.html)模式是一种在上下文中跟踪域上所有操作并在完成您的（可能）复杂逻辑时一次性应用它们的方法。

当与 ORM（例如 NHibernate）一起使用时，最好使用共享 ISession（或 Linq 2 Sql 中的 DataContext）来实现工作单元，该共享 ISession（或 Linq 2 Sql 中的 DataContext）用于对底层数据库的每个操作。

正确实施可能很棘手，尤其是在处理服务器应用程序时，主要是 ASP.Net MVC 或 ASP.Net Webforms。

我已经涉足了 Rhino.Commons（面向 NHibernate）中的实现，并且我知道其他几个，但没有很好地掌握它们的优点和缺点。

最常用的是什么，以及如何将它们无缝集成到 ASP.Net MVC（或 WebForms，但我最感兴趣的是 MVC）中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-03T18:21:53.473

> **更新**：我在回复后看到了这个（ [unit-of-work-pattern-in-net ）。](https://stackoverflow.com/questions/8265/unit-of-work-pattern-in-net)

也许 System.Transactions.Transaction 是你所追求的。

**工作单元**是几年前最初应用于基于大型机的应用程序的术语。这些应用程序将执行一系列步骤。如果任何一个步骤失败，数据库将回滚到之前的“同步点”。该应用程序将在成功完成工作单元中的所有步骤后记录一个新的同步点。这些步骤表现得像一个单元。

这个比喻已经演变，因此在 .NET 中，我们有了一个 Transaction 构造。在事务范围内对可恢复数据存储执行的工作作为一个单元执行，具有 ACID 属性。这些数据存储的示例可能是：任何现代 RDBMS、像 MSMQ 这样的排队系统，或者在 Windows 上，文件系统或注册表（通过 KTM）。当事务解决时，它要么提交要么回滚所有事务存储上的所有操作。

我不知道 nHibernate 或 ISession 构造。但是如果您使用传统意义上的“工作单元”一词，那么我认为您想要的是事务。

至于将事务集成到 ASP.NET MVC 中 - 不确定这意味着什么。Transaction 不关心 UI 模型是什么，也不关心您如何设计 UI 流控制。如果您更新数据库（我想是“模型”），那么您可以选择将该更新包含在事务中。仅当您作为单个事务的一部分进行多次更新时才真正有意义。另一方面，您不想让交易长时间保持打开状态。对数据库的锁定将导致争用，从而导致吞吐量下降。

# ruby-on-rails - Rails 测试入门

> ID：945866
> 
> 赞同：3
> 
> 时间：2009-06-03T17:00:24.330
> 
> 标签：ruby-on-rails, ruby, unit-testing, testing

我们选择使用 Rails 来构建我们的一个小项目。这是一个非常小的项目，可能需要六个月或更短的时间。所有参与该项目的人都是 Rails 新手，并且在 Web 编码方面的经验有限。

我们的软件应该为用户提供一个易于使用的界面来浏览大量的测量数据和可视化。用户使用限制他们可以看到的数据的用户帐户来标识自己。

我们应该做什么样的自动化测试，有没有免费的教程可以帮助我们？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-04T11:13:14.793

考虑一下 Rails 所基于的 MVC（模型-视图-控制器）设计模式的三个“分支”。

## 意见

这些应该在很大程度上没有业务逻辑：代码应该只关注数据的显示和 UI 的操作。

## 控制器

最小逻辑（传统智慧是使用“瘦控制器”）。测试（在“测试/功能”目录中）应该简单明了，并且 - 希望 - 主要关注导航和响应内容验证。从尽可能长时间保持这些尽可能简单的想法开始，这样您就可以在需要时为更复杂的测试主题做好准备。

## 楷模

这是业务/域逻辑所在的地方。将其保存在模型中可以更容易地进行测试，这很好，因为您应该针对模型编写大部分测试，尤其是在开发的最早阶段。在实现之前使用测试来定义行为还有一个额外的好处，那就是让你的代码朝着更干净、解耦的设计方向发展，所以尽量做到这一点。

可能值得一看 Noel Rappin 的[Rails Prescriptions](http://www.railsrx.com/) - 有一本书和一个（免费）介绍性 PDF，其中详细介绍了 Rails 特定的测试问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T17:11:37.543

对于所有东西rails，都有railscasts。这是一个关于使用 rspec 进行测试的好方法：[链接！](http://railscasts.com/episodes/71-testing-controllers-with-rspec)（浏览以找到更多好东西），我不能更高度地推荐[自动测试。](http://www.zenspider.com/ZSS/Products/ZenTest/)之后，您可以做很多事情，具体取决于您要编写的测试。（硒，固定装置）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T22:04:27.130

单元测试很棒，但我认为至少值得检查一下[黑盒测试](http://remi.org/2009/01/29/introducing-rackbox_merb-esque-blackbox-testing-for-rack-and-rails-apps.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-04T02:10:16.070

您可能还想获得一本书[Agile Web Development with Rails](https://rads.stackoverflow.com/amzn/click/com/1934356166)。有一章是关于使用 rails 测试系统的。

对于更高级别的测试，您可以查看[Watir](http://wtr.rubyforge.org/)或[Fitnesse](http://fitnesse.org/)或[Selenium](http://seleniumhq.org/)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-04T02:27:34.633

[Thoughtbot 的 Shoulda](http://thoughtbot.com/projects/shoulda)是一个非常易于使用且直观的测试框架，具有自然语言选项，并且没有太多必须通过教程和 api 阅读来学习的“魔法”。

Dave Thomas 是出色的 Rails 书籍[Agile Web Development with Rails](http://www.pragprog.com/titles/rails3/agile-web-development-with-rails-third-edition)的作者之一，他提供了[关于 Shoulda 的良好、快速的概述](http://pragdave.blogs.pragprog.com/pragdave/2008/04/shoulda-used-th.html)。

# sockets - TCP keep-alive 的可扩展性

> ID：945868
> 
> 赞同：0
> 
> 时间：2009-06-03T17:02:02.563
> 
> 标签：sockets, tcp, scalability, p2p, keep-alive

考虑各种设备的大规模异构网络。这些设备以对等方式向网络上的其他人提供服务。用于跨所有节点跟踪服务可用性的机制当前使用标记为保持活动状态的 TCP 套接字，通常在节点在线期间。这导致每个节点都有一个与每个其他节点（在对等基础设施的子网内）打开的套接字。

关于以这种方式使用 TCP keep-alive 的可扩展性存在哪些争论？

我的替代方法是使用发布/订阅模型，其中节点在新服务可用时将其推送到网络，并且它们的对等点会在它们想要订阅服务时缓存它们。这听起来可行吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T17:25:54.657

我从您所写的内容中解释说，通信是严格的点对点，具有相当长的持续时间（“租约”）。如果这是真的，则意味着您在发布-订阅模型中将一无所获。如果这不是真的，那么是的，您应该（可以）更改网络模型以匹配通信，并且您的想法听起来很合理。

关于您的第二个问题，由于 TCP 套接字和 keep-alive 只是一个概念，因此拥有这样的 keep-alive 合同没有（或非常小的）内在成本。在实践中 YMMV 因为不同的套接字实现需要不同的资源，并且可能需要其他操作来保持通道打开。然而，有许多实现需要很少的资源来打开套接字（例如 select() 类型）。

如果有许多相同类型服务的实现者，并且您不能（或不想）静态预测它们将出现的位置，则发现服务（服务的发布/订阅）最有意义。

简而言之，我会说，只有在您拥有的通信类型与当前架构不匹配时，您才应该更改设计。您的想法当然听起来非常可行，但需要更多有关通信模式的信息来估计结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T17:43:47.233

如果您的 TCP Keep Alive 机制*仅*用于跟踪服务可用性（这意味着您永远不会在这些连接之间传递服务请求/响应），那么使用 TCP 套接字绝对是一种过度杀戮。TCP 套接字确实占用了大量资源。

一种更具可扩展性的方法是使用发布/订阅模型，该模型使用 UDP 定期发布消息来宣传服务的持续存在。您还可以使用从断开连接的节点发布的服务停​​止消息来优雅地声明服务结束。

更进一步，如果您想通过真正大规模的网络获得最佳效果，并且准备投入一些时间和精力，请考虑像[DHT](http://en.wikipedia.org/wiki/Distributed_hash_table#Structure)这样的结构化 P2P 机制。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T17:10:39.217

是的，对于任何 P2P 网络来说，使用 keep alive 似乎都是个坏主意。我不仅会在数据传输时保持连接保持打开状态，而且还会在不同的套接字上保持节点状态更新，以免干扰文件传输。

# c++ - 分离一个大字符串

> ID：945872
> 
> 赞同：4
> 
> 时间：2009-06-03T17:02:13.797
> 
> 标签：c++, string

你怎么说这种话？

```
static const string message = "This is a message.\n
                               It continues in the next line" 
```

问题是，下一行没有被识别为字符串的一部分..

如何解决？或者是创建字符串数组然后初始化数组以保存每一行的唯一解决方案？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-06-03T17:03:50.487

用自己的引号将每一行括起来：

```
static const string message = "This is a message.\n"
                              "It continues in the next line"; 
```

编译器会将它们组合成一个字符串。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-06-03T17:06:10.500

您可以使用尾部斜杠或引用每一行，因此

```
"This is a message.\n \
 It continues in the next line" 
```

或者

```
"This is a message."
"It continues in the next line" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T17:06:42.450

在 C++ 中和在 C 中一样，由空格分隔的字符串是隐式连接的，所以

```
"foo" "bar" 
```

相当于：

```
"foobar" 
```

所以你要：

```
static const string message = "This is a message.\n"
                               "It continues in the next line"; 
```

# asp.net-mvc - ASP MVC - 将对象添加到数据库时确认页面

> ID：945876
> 
> 赞同：1
> 
> 时间：2009-06-03T17:03:19.490
> 
> 标签：asp.net-mvc, crud

我正在使用 ASP MVC 制作一个简单的 CRUD 应用程序，我希望在创建新对象并将其插入数据库时​​有一个确认页面。

问题是我无法在动作之间传递对象。我试图在创建后将其保存在会话中，然后在用户确认时检索它，但是当我尝试将其插入数据库时​​出现 InvalidOperationException （我正在使用实体框架）

我什至不确定我是否以正确的方式接近这一点。有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-03T17:11:59.790

如果架构允许，我喜欢做的是在记录上有一个活动标志（和时间戳字段）。您在第一页上插入而不设置该标志。确认页面仅设置活动标志。另一个进程可以清除在其时间戳的某个范围内未确认的死记录。并且对象或实体永远不会占用会话内存。

为清楚起见进行编辑：因此，您只需将创建的实体的 id 传递给确认页面

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-09-10T09:35:31.850

Tim's 是对此的最佳基本答案，但如果您不想包含额外的逻辑，您也可以考虑在确认页面上使用隐藏字段，这样确认实际上会重新提交表单数据（这意味着更少的 DB 行程，意味着您不需要） t 有旧的未经确认的条目位于数据库中以过滤掉，但意味着更多的数据进出客户端）。

从 UI 的角度来看，可能首选的另一种选择是让 Tim 的答案，但如果启用了 JavaScript，则使提交按钮改为弹出确认屏幕，单击“确定”将一次性提交表单和确认。

# git - CruiseControl.NET 和 Git

> ID：945887
> 
> 赞同：12
> 
> 时间：2009-06-03T17:05:03.700
> 
> 标签：git, version-control, continuous-integration, cruisecontrol.net

[看起来CruiseControl.NET中没有对](http://confluence.public.thoughtworks.org/display/CCNET/Welcome+to+CruiseControl.NET)[Git](http://git-scm.com/)的内置支持。

有人对 Git 插件、技巧或其他有关让 CruiseControl.NET 与 Git 一起工作的建议有什么建议吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2011-02-02T08:06:41.933

我只是想指出，较新的 CruiseControl.net 内置了对 git 的支持

[http://cruisecontrolnet.org/projects/ccnet/wiki/Git](http://cruisecontrolnet.org/projects/ccnet/wiki/Git)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-06-03T19:21:29.343

github 上有一个 CC.net/git 插件：

[ccnet.git.plugin](http://github.com/dogeth/ccnet.git.plugin/tree/master)

rdoc 包含配置 CC.net 以使用 git 存储库的说明。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-06-10T11:13:35.860

目前正在为 CruiseControl.Net 1.5 版本集成 git/mercurial 支持 - git 插件 AFAIK 已经集成到主存储库中。

[Mercurial 已包含在文档中](http://confluence.public.thoughtworks.org/display/CCNET/Mercurial+Source+Control+Block)。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2011-03-07T14:43:58.230

根据文档，在 CC.NET 1.5 中添加了 Git 支持。

由于 Thoughtworks 的公共 CruiseControl.NET 站点似乎存在问题，我想提一下，可以在 CruiseControl.NET 安装附带的文档中找到关于“官方”Git 源代码控制块的完整报道：

*   在默认的 64 位 Windows 安装上本地安装：`file:///C:/Program%20Files%20%28x86%29/CruiseControl.NET/webdashboard/doc/CCNET/Git%20Source%20Control%20Block.html`
*   在您的远程构建服务器上：[http://buildserver/ccnet/doc/CCNET/Git%20Source%20Control%20Block.html](http://buildserver/ccnet/doc/CCNET/Git%20Source%20Control%20Block.html)

官方插件似乎有一些关于标记和签入构建期间修改的文件的附加功能。

# windows - VC++预处理器符号说明

> ID：945892
> 
> 赞同：3
> 
> 时间：2009-06-03T17:05:56.570
> 
> 标签：windows, visual-c++

是否有可用的 Visual C++/Windows SDK 预处理器符号的概述，例如`_CONSOLE, _WINDOWS, WIN32, WIN32_LEAN_AND_MEAN`等？

我感兴趣的不仅仅是一个列表，还有（链接到）定义每个符号的效果的描述。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T17:14:14.467

有些符号是由编译器定义的，有些是由各种运行时库定义的。你需要知道你在寻找什么才能找到答案。据我所知，没有一个存储库。

话虽如此：

[http://msdn.microsoft.com/en-us/library/b0084kay(VS.80).aspx](http://msdn.microsoft.com/en-us/library/b0084kay(VS.80).aspx)

这解释了编译器预定义的宏。

[http://msdn.microsoft.com/en-us/library/aa383745(VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa383745(VS.85).aspx)

讨论 Windows 标头版本宏和您列出的其他一些可选宏。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T17:14:33.173

[http://msdn.microsoft.com/en-us/library/b0084kay.aspx](http://msdn.microsoft.com/en-us/library/b0084kay.aspx)中描述了一些宏

# c# - UserControl 不显示在混合中

> ID：945896
> 
> 赞同：2
> 
> 时间：2009-06-03T17:06:59.547
> 
> 标签：c#, wpf, user-controls, expression-blend

我使用 WPF UserControls 来设计我的应用程序的某些部分。我将 blend 2.5 用于图形部分。但是当我对任何内容进行用户控制时，它不会显示在混合中，并且会引发异常，说找不到资源。
我的应用程序已本地化，我将本地化的 DLL 移动到 Blend 文件夹中。

这是一段不起作用的代码：

```
<StackPanel>
     <RadioButton x:Name="radioBasicInfo" Content="{DynamicResource string_newUnitBasicInfo}" Margin="0,0,0,5" Checked="checkErrors"/>
     <content:CoverContent></content:CoverContent>
</StackPanel> 
```

我用谷歌搜索了它，但没有找到任何解决方案，这很烦人，因为你看不到混合的最终渲染是什么。

希望您能够帮助我。鲍里斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-04T22:40:27.510

它实际上来自本地化问题。混合文件夹中的资源 dll 不是最新的，然后它没有找到不同的 xaml 引用，这很奇怪，因为在我的本地化词典中没有对任何 xaml 文件的引用......
但也许我有点本土化...

我很沮丧微软没有在 Blend 中处理本地化资源，希望他们能在 Blend 3.0 中修复它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-04T03:18:29.677

Blend 可能会遇到许多不同类别的资源错误，因此很难从您的描述中说出究竟是什么问题。

我建议在 Blend 中调试您的应用程序，以查看究竟发生了什么，以及抛出异常的位置。您应该能够通过在 Visual Studio 和 Blend 中打开您的项目，然后将 VS 调试器附加到 Blend 应用程序可执行文件来调试它。然后您应该能够将 VS 设置为停止所有抛出的 CLR 异常（或只是您看到的参考异常），并拥有 VS 的全部功能和异常的详细信息来帮助您找出 Blend/WPF 正在寻找的位置这些资源，以便您弄清楚为什么找不到它们。

# c# - ASP.NET 中的缓存控制标头

> ID：945898
> 
> 赞同：28
> 
> 时间：2009-06-03T17:07:18.080
> 
> 标签：c#, asp.net, caching, header

我正在尝试为 Web 应用程序设置缓存控制标头（看来我可以做到），但我在标头响应中得到了我认为奇怪的条目。我的实现如下：

```
 protected override void OnLoad(EventArgs e)
    {
        // Set Cacheability...
        DateTime dt = DateTime.Now.AddMinutes(30);
        Response.Cache.SetExpires(dt);
        Response.Cache.SetMaxAge(new TimeSpan(dt.ToFileTime()));

        // Complete OnLoad...
        base.OnLoad(e);
    } 
```

这就是标题响应显示的内容：

```
-----
GET /Pages/Login.aspx HTTP/1.1
Host: localhost:1974
User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.0.10) Gecko/2009042316 Firefox/3.0.10 (.NET CLR 3.5.30729)
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-us,en;q=0.5
Accept-Encoding: gzip,deflate
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
Keep-Alive: 300
Connection: keep-alive
X-lori-time-1: 1244048076221
Cache-Control: max-age=0

HTTP/1.x 200 OK
Server: ASP.NET Development Server/8.0.0.0
Date: Wed, 03 Jun 2009 16:54:36 GMT
X-AspNet-Version: 2.0.50727
Content-Encoding: gzip
Cache-Control: private, max-age=31536000
Expires: Wed, 03 Jun 2009 17:24:36 GMT
Content-Type: text/html; charset=utf-8
Content-Length: 6385
Connection: Close
----- 
```

1.  为什么“Cache-Control”属性会出现两次？
2.  我需要“Cache-Control”和“Expires”属性吗？
3.  “Page_Load”是放置此代码的最佳位置吗？

谢谢！

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-06-25T13:29:39.770

如果您将最大年龄设置得太远，您可能还想添加此行：

```
// Summary:
// Sets Cache-Control: public to specify that the response is cacheable
// by clients and shared (proxy) caches.    
Response.Cache.SetCacheability(HttpCacheability.Public); 
```

我对来自文件处理程序的文档和图像进行了很多响应标头操作，该文件处理程序处理对保存在数据库中的文件的请求。

根据您的目标，您可以真正强制浏览器在本地缓存几乎所有页面数天（如果那是您想要/需要的）。

编辑：

我还认为您可能将最大年龄设置错误...

```
Response.Cache.SetMaxAge(new TimeSpan(dt.Ticks - DateTime.Now.Ticks )); 
```

此行设置为本地浏览器上的 30 分钟缓存时间 [max-age=1800]

至于 2x Cache Control 行...您可能需要检查 IIS 是否已设置为自动添加标头。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-06-03T18:16:54.827

我没有看到 Cache-control 出现两次。一个在请求中，一个在响应中。请求中的那个可能是因为您在浏览器中按了 Shift+F5 或类似的东西。

对于你的第二个问题：这取决于你想用缓存头实现什么。

我不知道你想用 max-age 达到什么目的。该值太高了，因为您将 DateTime 错误地转换为 TimeSpan。你为什么不直接使用 TimeSpan.FromMinutes 呢？

页面加载没问题。我通常自己在那里搞乱 HTTP 标头。

# windows - 如何在指定用户上创建 Windows 服务？

> ID：945904
> 
> 赞同：0
> 
> 时间：2009-06-03T17:08:12.010
> 
> 标签：windows, service, login, account

我构建了一个测试服务，它将消息写入本地文件。我注意到文件的“所有者”属性始终是“管理员”，这在使用“本地系统”帐户时是相同的。但是我已将“登录身份”设置更改为我在服务管理器中的个人帐户。

我应该怎么做才能使服务在指定帐户上运行？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-04T22:06:09.327

> 我应该怎么做才能使服务在指定帐户上运行？

您执行完全相同的操作，但在服务控制管理器中指定该特定帐户。

还是您的意思是该服务仅针对特定用户运行？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T17:11:54.033

我不知道该怎么做，但您还应该将用户设置为“作为服务运行”选项。查看 MSDN API 了解详情

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T17:12:42.583

“登录身份”设置应该可以满足您的要求。

是不是你改了登录账号后没有创建文件？如果覆盖文件，所有者可能不会改变。

我不确定是否建议以普通用户身份登录该服务。用户将需要“作为服务登录”权限。如果您是管理员，您可能会拥有它，但普通用户可能不会。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-06-03T17:12:56.530

您可以通过创建 WMI 脚本来设置服务设置来完成此操作。

据我所知，您不能对服务将自动使用的用户进行硬编码。

# wordpress - 如何在 Wordpress 的帖子中获取类别标题？

> ID：945906
> 
> 赞同：22
> 
> 时间：2009-06-03T17:09:02.820
> 
> 标签：wordpress, get, categories

假设我在 Wordpress 中有一个名为 Hello World 的帖子，并且我正在直接查看此页面，我将如何找到“Hello World”的类别并显示它？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-06-03T17:12:34.207

像这样使用[`get_the_category()`](http://codex.wordpress.org/Template_Tags/get_the_category)：

```
<?php
foreach((get_the_category()) as $category) { 
    echo $category->cat_name . ' '; 
} 
?> 
```

它返回一个列表，因为一篇文章可以有多个类别。

[该文档](http://codex.wordpress.org/Template_Tags/get_the_category)还解释了如何从循环外部执行此操作。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-06-03T17:15:48.537

您可以使用

```
<?php the_category(', '); ?> 
```

这会将它们输出到逗号分隔的列表中。

您也可以对标签执行相同的操作：

```
<?php the_tags('<em>:</em>', ', ', ''); ?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-12-23T15:44:58.047

要使用 php 在 wordpress 中查找类别 ID、类别链接和类别名称，您可以使用以下代码：

```
$cat_id = get_cat_ID('Category Name');

$category_link = get_category_link($cat_id);

$category_name = get_cat_name($cat_id);

echo $category_name; // It will print your category name 
```

# c++-cli - 不允许 C++\CLI 异常规范

> ID：945910
> 
> 赞同：1
> 
> 时间：2009-06-03T17:10:23.553
> 
> 标签：c++-cli, exception-specification

我是一位经验丰富的非托管 C++ 开发人员，不熟悉 C++\CLI。

为什么托管 C++ 不允许异常规范？

示例[链接](http://bytes.com/groups/net-vc/285018-exception-specifications-legal-c-cli)

指定我的方法抛出的异常的最佳实践是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-08T14:55:06.290

大概是因为 CLR 不使用异常规范；这反过来又可能是因为微软看了 Java 并认为它们的麻烦远大于它们的价值。因此，指定您的方法抛出的异常的最佳实践是不要打扰，即删除您的异常规范。值得指出的是，即使在正常的 C++（即本机）世界中，大多数人要么完全避开异常规范，要么只使用空规范来指示方法不会抛出异常。

# .net - 使用 ODBC 和 C++ Net 将空 BLOB 插入 SQLite DB

> ID：945911
> 
> 赞同：1
> 
> 时间：2009-06-03T17:10:34.347
> 
> 标签：.net, database, sqlite, odbc, c++-cli

我正在使用 SQLite 数据库来存储我在数据库中拥有的书籍的封面图像。我已经插入了 BLOB，但是当我没有我的书的封面图片时，我似乎无法让它插入一个空 BLOB。

我正在为我的插入 SQL 语句使用参数，使用 ODBC，如下所示：

```
OdbcParameter^ paramCoverImage = gcnew OdbcParameter("@CoverImage", ByteArray);

cmd->Parameters->Add(paramCoverImage); 
```

但是当我尝试使用 nullptr 而不是 ByteArray 时，SQLite 会出错。我想使用 SQL `NULL`，但我不知道如何使用 ODBC 和 SQLite 来做到这一点。有任何想法吗？

罗宾

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-03T17:39:16.367

尝试：

```
OdbcParameter^ paramCoverImage = gcnew OdbcParameter("@CoverImage", OdbcType::Binary);
paramCoverImage->Value = System::DbNull->Value; 
```

# .net - 使用 Lutz 反射器查看 IL 代码

> ID：945912
> 
> 赞同：4
> 
> 时间：2009-06-03T17:10:37.937
> 
> 标签：.net, visual-studio

我有一个包含一些方法的类，我想看看代码是如何转换为 IL 代码的。我可以使用反射器做到这一点吗？如果没有，我可以使用 VS IDE 查看 IL 代码吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-03T17:12:14.487

是的你可以。使用 Reflector 打开 exe/dll 并将语言设置更改为 IL。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-03T17:13:43.097

您还可以使用[ILDasm](http://msdn.microsoft.com/en-us/library/f7dy01k1(VS.80).aspx)将程序集反汇编为 IL。

# php - NuSOAP：如何更改请求的内容类型？

> ID：945922
> 
> 赞同：4
> 
> 时间：2009-06-03T17:11:44.393
> 
> 标签：php, web-services, content-type, nusoap

使用 .NET WCF Web 服务时，我收到以下响应（错误）：

> 不支持的 HTTP 响应状态 415 无法处理消息，因为内容类型为 'text/xml; charset=UTF-8' 不是预期的类型 'application/soap+xml; 字符集=utf-8'。

如何更改内容类型？我在 NuSOAP 论坛/文档中找不到它，或者我可能忽略了某些东西....

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-11-06T15:15:03.633

我知道这是一个旧帖子，但我跑到这个页面寻找答案。

`application/soap+xml`是使用 SOAP 1.2 时传递的内容类型， `text/xml`与 SOAP 1.1 一起使用，

像这样的东西应该可以解决问题，

```
$client = new SoapClient("some.wsdl", array('soap_version' => SOAP_1_1)); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-11-23T09:00:07.623

您可以使用以下 Web 服务指定 NuSOAP 流的编码：

```
$client = new nusoap_client($params);
$client->soap_defencoding = 'UTF-8'; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-02-16T03:13:30.213

看起来 NuSOAP 库中略有遗漏......它假定内容标头必须是“text/xml”，因此如果您的客户端尝试连接到输出应用程序/soap+xml 标头的服务，您'最终会出现以下错误：

> 响应不是 text/xml 类型：application/soap+xml；字符集=utf-8

为了测试这一点，您可能会受益于以下我用来登录 SOAP 服务的小函数模式。请记住，打印出客户端对象！您实际上可能看不到结果！

```
require_once('path/to/downloaded/libraries/nusoap.php');    
var $endpoint = 'https://somedomain.com/path/to/soap/server/Login';
var $client; // the soapclient object

function SOAP_Login()
{
    $this->client = new soapclient($this->endpoint);

    $err = $this->client->getError();
    if ($err) 
    {
        // Display the error
        echo '<p><b>SOAP Constructor error: ' . $err . '</b></p>';
        exit;
        // At this point, you know the call that follows will fail
    }

    $params = array( 
        'some' => 'thing.. depends on what the WSDL expects'
    );

    $result = $this->client->call('someFunction', $params);     

    print_r($result);  // Without the fix, this prints nothing (i.e. false) !!!

    print_r($this->client); // Instead, look at the state of the client object, specifically error_str and debug_str
} 
```

当我打印我的 $result 时，我什么也没得到，但是当我打印出 $client 对象时，我可以看到有错误。

我实现的小技巧在 nusoap.php 文件中，大约第 7500 行。查找以下 if 语句：

```
if (!strstr($headers['content-type'], 'text/xml')) {
    $this->setError('Response not of type text/xml: ' . $headers['content-type']);
    return false;
} 
```

并将其更改为：

```
if (!strstr($headers['content-type'], 'text/xml') && !strstr($headers['content-type'], 'application/soap+xml') ) {
    $this->setError('Response not of type text/xml: ' . $headers['content-type']);
    return false;
} 
```

这一切只是让 NuSOAP 处理发出“application/soap+xml”标头（这是一个有效的 xml 标头）的响应。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-04T12:21:18.697

我也被困在这个问题上。

秘诀是在 web.config 中将 wsHttpBinding 改为 basicHttpBinding

像这样：

```
<endpoint address="" binding="basicHttpBinding" contract="YourProject.View.Whatever.IYourService"> 
```

希望有帮助！/埃里克

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-01-23T11:25:30.507

这对我有用：

$client = new nusoap_client($params);

$client->soap_defencoding = 'UTF-8';

勾选正确的答案不适用于 NUSOAP，因此不是适当的答案。

# sql - Mysql 索引被忽略

> ID：945925
> 
> 赞同：4
> 
> 时间：2009-06-03T17:11:54.923
> 
> 标签：sql, mysql, indexing, primary-key, key

```
EXPLAIN SELECT
*
FROM
content_link link
STRAIGHT_JOIN
content
ON
link.content_id = content.id
WHERE
link.content_id = 1
LIMIT 10;

+----+-------------+---------+-------+---------------+------------+---------+-------+------+-------+
| id | select_type | table   | type  | possible_keys | key        | key_len | ref   | rows | Extra |
+----+-------------+---------+-------+---------------+------------+---------+-------+------+-------+
|  1 | SIMPLE      | link    | ref   | content_id    | content_id | 4       | const |    1 |       |
|  1 | SIMPLE      | content | const | PRIMARY       | PRIMARY    | 4       | const |    1 |       |
+----+-------------+---------+-------+---------------+------------+---------+-------+------+-------+ 
```

但是，当我删除 WHERE 时，查询会停止使用该键（即使我明确强制它使用）

```
EXPLAIN SELECT
*
FROM
content_link link FORCE KEY (content_id)
STRAIGHT_JOIN
content
ON
link.content_id = content.id
LIMIT 10;

+----+-------------+---------+--------+---------------+---------+---------+------------------------+---------+-------------+
| id | select_type | table   | type   | possible_keys | key     | key_len | ref                    | rows    | Extra       |
+----+-------------+---------+--------+---------------+---------+---------+------------------------+---------+-------------+
|  1 | SIMPLE      | link    | index  | content_id    | PRIMARY | 7       | NULL                   | 4555299 | Using index |
|  1 | SIMPLE      | content | eq_ref | PRIMARY       | PRIMARY | 4       | ft_dir.link.content_id |       1 |             |
+----+-------------+---------+--------+---------------+---------+---------+------------------------+---------+-------------+ 
```

有什么解决方法吗？

我意识到我在第二个示例中选择了整个表，但是为什么 mysql 突然决定它无论如何都会忽略我的 FORCE 并且不使用密钥？如果没有密钥，查询大约需要 10 分钟.. 呃。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-03T17:21:08.470

FORCE 有点用词不当。这是 MySQL 文档所说的（强调我的）：

*您还可以使用 FORCE INDEX，它的作用类似于 USE INDEX (index_list)，但另外假设表扫描非常昂贵。换句话说，**仅当无法使用给定索引之一来查找**表中的行时，才使用表扫描。*

由于您实际上并没有“找到”任何行（您正在选择所有行），因此表扫描**总是**最快的，并且优化器足够聪明，可以知道尽管您告诉他们什么。

预计到达时间：

尝试在主键上添加一次 ORDER BY，我敢打赌它会使用索引。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-03T17:13:49.617

索引有助于在表内快速搜索，但如果您选择整个表，它只会减慢速度。所以 MySQL 忽略索引是正确的。

在您的情况下，索引可能具有 MySQL 不知道的隐藏副作用。例如，如果内连接只保留几行，则索引会加快速度。但是如果没有明确的提示，MySQL 是无法知道的。

有一个例外：当您选择的每一列都在索引内时，如果您选择每一行，索引仍然有用。例如，如果您在 LastName 上有一个索引，则以下查询仍然受益于该索引：

```
select LastName from orders 
```

但是这个不会：

```
select * from Orders 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T17:31:42.527

你`content_id`似乎接受`NULL`价值观。

`MySQL`优化器认为不能保证您的查询将仅通过使用索引返回所有值（尽管实际上有保证，因为您使用 a 中的列`JOIN`）

这就是它恢复为全表扫描的原因。

添加`NOT NULL`条件：

```
SELECT  *
FROM    content_link link FORCE KEY (content_id)
STRAIGHT_JOIN
        content
ON      content.id = link.content_id
WHERE   link.content_id IS NOT NULL
LIMIT 10; 
```

或将您的列标记为`NOT NULL`：

```
ALTER TABLE content_link MODIFY content_id NOT NULL 
```

**更新：**

这是已验证的[**错误 45314**](http://bugs.mysql.com/bug.php?id=45314)在`MySQL`.

# java - 新线路和浏览器/操作系统兼容性

> ID：945942
> 
> 赞同：3
> 
> 时间：2009-06-03T17:14:09.803
> 
> 标签：java, browser, newline

我有一个接受值列表的表单，每个值都列在单独的 textArea 行上。在我的 Servlet 中，我根据换行符“\r\n”对从该 textArea 收到的字符串进行标记，如下所示：

```
String[] partNumberList = originalPartNumberString.split("\r\n"); 
```

这似乎工作正常。我得到了预期的值数组。我相信这是因为浏览器处理标准化换行符发送到服务器的方式，无论表单数据是从哪个操作系统/浏览器发送的（[请参阅这篇文章](https://stackoverflow.com/questions/760282/do-line-endings-distinctions-apply-for-html-forms)）。我已经在 IE、Firefox、Chrome 中进行了测试……一切似乎都可以正常工作，我对此非常有信心。

在服务器端接收到值后，我将这些值用于一些查找等，然后将它们写回 textArea 以进行响应。为了做到这一点，我以我收到它的相同方式写回它......我只是构建一个新字符串，并用“\r\n”分隔每个值。然后我将 textArea 的值设置为该字符串。

```
StringBuffer invalidReturnPartList = new StringBuffer("");

for (int i = 0; i < requestedPartList.length; i++)
{
    invalidReturnPartList.append(requestedPartList[i]);
    invalidReturnPartList.append("\r\n");
}

return invalidReturnPartList.toString(); 
```

在我尝试过的所有浏览器中，这对我来说也都可以测试。但是，我只是担心我是否在这里涵盖了所有基础......如果有人在运行 Mac，“\r\n”会在他们的浏览器上正确翻译吗？Linux 呢？我认为一切都将在浏览器中处理，但我只是不确定这里......所以我的问题是，这对你来说是正确的，还是我错过了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-03T18:46:22.443

我将尝试在这里回答我自己的问题。

由于 textArea 的值是表单数据，并且表单以 Content Type "application/x-www-form-urlencoded" 提交到服务器，因此新的行在提交到之前由浏览器转换为 "CR LF"符合 HTML 规范的服务器（参见[http://www.w3.org/MarkUp/html-spec/html-spec_8.html#SEC8.2.1](http://www.w3.org/MarkUp/html-spec/html-spec_8.html#SEC8.2.1)）。

因此，在这种情况下，无论浏览器或操作系统如何，我的代码都应该始终如一地工作。

但是，如果我试图在客户端实现相同的代码（比如说，使用 JavaScript），也许是为了在提交之前验证表单……那可能是另一回事了。由于此时表单数据尚未规范化，因此它很可能取决于平台/浏览器用于新行的任何内容。在这种情况下，我可能不仅需要检查“\r\n”，还需要检查“\r”和“\n”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T17:49:09.530

如果您查看 HTTP 协议定义，您会发现：

> HTTP/1.1 将序列 CR LF 定义为除实体主体之外的所有协议元素的行尾标记（有关
> 宽容的应用程序，请参见附录 19.3）。实体主体内的行尾标记由其关联的媒体类型定义，如 3.7 节所述。

但这对身体无效。我假设您通过发布请求发送表单信息，因此我假设使用了内容类型 text/plain，在这种情况下，我认为以下内容适用：

> 3.7.1 规范化和文本默认值
> 
> Internet 媒体类型以规范形式注册。通过 HTTP 消息传输的
> 实体主体必须在
> 传输之前以适当的规范形式表示，“文本”类型除外，如下一段中定义。
> 
> 当采用规范形式时，“文本”类型的媒体子类型使用 CRLF 作为文本换行符。HTTP 放宽了这一要求，并允许传输具有纯 CR 或 LF 的文本媒体，当它对整个实体主体一致完成时，它代表一个换行符。HTTP 应用程序必须接受 CRLF、裸 CR 和裸 LF 作为通过 HTTP 接收的文本媒体中的换行符的代表。

这意味着，浏览器可以向您发送 UNIX 样式的端线。

（两段均来自[http://www.ietf.org/rfc/rfc2616.txt](http://www.ietf.org/rfc/rfc2616.txt)）

# asp.net-mvc - 在 ASP.NET MVC 中将参数绑定到不同名称的方法？

> ID：945945
> 
> 赞同：2
> 
> 时间：2009-06-03T17:14:20.817
> 
> 标签：asp.net-mvc

我经常遇到一些场景，我想为操作方法提供一个稍微更直观或“格式正确”的参数名称，但是对于默认行为，这变得非常痛苦。例如，假设我有一个像 GetWidget(int id) 这样的操作参数。如果我希望它是 GetWidget(int widgetId)，我必须添加一条新路线。当您使用像 jqGrid 这样的库时，情况会变得更糟，它的查询字符串参数使用糟糕的名称：GetWidgets(int?nodeid, int?n_level)。相反，我想要 GetWidgets(int? parentId, int? level) 或类似的东西。

那么，我忽略了一些简单的事情吗？告诉MVC我的“parentId”参数应该绑定到请求中“nodeid”的值似乎应该是一件非常简单的事情。我曾考虑编写一个自定义操作过滤器来执行此操作，但它似乎如此明显，以至于我无法相信它不支持开箱即用。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2011-06-07T02:45:10.963

根据 Rony 的回答，使用自定义模型绑定器。这是一个例子：

```
public class BindToAliasAttribute : CustomModelBinderAttribute
{
    private readonly string parameterAlias;

    public BindToAliasAttribute(string parameterAlias)
    {
        this.parameterAlias = parameterAlias;
    }

    public override IModelBinder GetBinder()
    {
        return new ParameterWithAliasModelBinder(parameterAlias);
    }
}

public class ParameterWithAliasModelBinder : IModelBinder
{
    private readonly string parameterAlias;

    public ParameterWithAliasModelBinder(string parameterAlias)
    {
        this.parameterAlias = parameterAlias;
    }

    object IModelBinder.BindModel(ControllerContext controllerContext, ModelBindingContext bindingContext)
    {
        return controllerContext.RouteData.Values[parameterAlias];
    }
}

public class UserController : Controller
{
    [HttpGet]
    public ActionResult Show( [BindToAlias("id")] string username)
    {
        ...
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-03T18:33:38.990

如果在 URL 上使用命名参数，则可以在控制器方法中为参数指定特定名称，如下所示：

```
http://mydomain.com/mycontroller/getwidget?parentid=1&level=2 
```

...而且您不必在参数上匹配路由。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T17:23:59.917

使用您自己的实现 IModelBinder 的自定义模型绑定器

# c# - 对所有图像格式使用 BmpBitmapEncoder

> ID：945948
> 
> 赞同：1
> 
> 时间：2009-06-03T17:14:40.753
> 
> 标签：c#, image-processing

我发现使用 BmpBitmapEncoder 渲染任何类型的图像都可以，我唯一需要做的就是在文件中发送正确的格式以保存，如下例所示：

```
BmpBitmapEncoder encoder = new BmpBitmapEncoder();;

encoder.Frames.Add(BitmapFrame.Create(renderer));
using (System.IO.FileStream fs = System.IO.File.Open("file.png", System.IO.FileMode.OpenOrCreate))
{
    encoder.Save(fs);
} 
```

因此，如您所见，图像的名称是“file.png”，这可以正常工作，它将图像保存为 PNG（也适用于 jpeg、tiff、gif），并且可以使用任何图像处理加载它应用。

我只是想知道这与为每种类型（PngBitmapEncoder、JpegBitmapEncoder、GifBitmapEncoder 等）使用正确的编码器有何不同。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T17:18:41.547

您必须使用正确的编码器 PngBitmapEncoder、JpegBitmapEncoder、GifBitmapEncoder。

您以这种方式保存的文件始终是 BMP！

您的测试中发生的情况是您正在使用的图像处理应用程序忽略扩展名并将真实文件格式识别为 BMP。

# php - 使用原型js在php中删除操作

> ID：945952
> 
> 赞同：0
> 
> 时间：2009-06-03T17:15:07.277
> 
> 标签：php, javascript, prototypejs

我正在使用 php / mysql 和 protype.js 从表中删除记录。问题是从网格中删除记录后，网格不会在模板中自动更新。

这是我的代码：

**第 1 步：index.php**

```
<?php
    require("Connection.php");
    $sql = "SELECT * from tbluser";
    $result=mysql_query($sql);
?>
<html>
<head>
    <script src="prototype.js" type="text/javascript"></script>
    <script src="scriptaculous-js/src/scriptaculous.js" type="text/javascript"></script>    
    <script language="javascript">
        function fnDeleteRecord(id)
        {
            new Ajax.Request('delete.php?action=Delete&id='+id,{method:'get'});
        }
    </script>
</head>
<body>
<table id="userrecords" border="1" cellpadding="0" cellspacing="0" width="700">
    <tr>
        <th> User Name </th>

        <th> Password </th>

        <th> Address </th>

        <th> Phone Number </th>

        <th> Action </th>
        <th> Status </th>
    </tr>
<?php

while($row = mysql_fetch_array($result))
{
    echo "<tr id='".$row[id]."'>";

    echo "<td>".$row['user_name']."</td>";

    echo "<td>".$row['pass']."</td>";

    echo "<td>".$row['address']."</td>";

    echo "<td>".$row['phone_no']."</td>";

    echo "<td><img src='images/spinner.gif' id='a[$row[id]]' alt=icon border=0 /><a href='javascript:void(0);' onclick=fnDeleteRecord('".$row['id']."'); >Delete</a></td>";

    if($row['status'] == 'enabled')
        echo "<td><img src='images/spinner.gif' id='a[$row[id]]' alt=icon border=0 style='display:none;' /><img src='images/enable.png' alt=icon border=0 onClick=fnUpdateStatus('".$row['id']."','disabled')  /></td>";
    else if ($row['status'] == 'disabled')
        echo "<td><img src='images/spinner.gif' id='a[$row[id]]' alt=icon border=0 style='display:none;' /><img src='images/disable.png' alt=icon border=0 onClick=fnUpdateStatus('".$row['id']."','enabled') /></td>";

    echo "</tr>";
}
    echo "</table>";

    mysql_close($con);

?>
</body>
</html> 
```

**第2步：删除.php**

```
<?php
require_once('connection.php');
if ($_GET['action'])
{
    switch($_GET['action'])
    {
        case 'Delete':
            $sql = "Delete from tbluser where id ='".$_GET['id']."'";
            $result = mysql_query($sql);
            if(!$result)
                echo "some problem occured during delete operation";
            break;
    }
}
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T18:02:25.730

您可以使用原型删除该表行：

```
<script language="javascript">
   function fnDeleteRecord(id)
   {
       new Ajax.Request('delete.php?action=Delete&id='+id,{method:'get'});
       $(id).remove(); // because <tr id='".$row[id]."'> :)

   }
</script> 
```

# sql - ssrs 多列表数据错误地跨列和/或页面

> ID：945954
> 
> 赞同：1
> 
> 时间：2009-06-03T17:15:19.507
> 
> 标签：sql, reporting-services, formatting, reporting

在 SSRS 中，我构建了一个报告，其中提供商名称、地址、电话在按州分组的页面上的 3 列中列出。示例数据：

[替代文本 http://img99.imageshack.us/img99/9062/providerlistingex.png](http://img99.imageshack.us/img99/9062/providerlistingex.png)

我要做的是防止数据溢出到下一列或下一页。我只想将提供者移动到下一列/页面。有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-03T17:44:11.647

从结果中不清楚您是如何构建报告的。每个地址都应该在一个表格单元格中。那么我认为您不会看到地址被分解。

# emacs - 如何在 Gnus 中自动订阅新的 IMAP 文件夹？

> ID：945958
> 
> 赞同：10
> 
> 时间：2009-06-03T17:15:38.633
> 
> 标签：emacs, imap, gnus

我需要自动订阅由 Gnus 中的 IMAP 服务器创建的新 IMAP 文件夹。这个怎么做？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-06-03T18:00:44.967

您可以修复 的值[`gnus-auto-subscribed-groups`](http://gnus.org/manual/gnus_9.html#SEC9)，使其包含`nnimap`后端以及其他邮件后端。如果您的 IMAP 服务器做了一些有趣的事情，例如将您的所有主目录都显示为邮箱，您可能会遇到困难（以为我在开玩笑？试试[uw-imapd](http://groups.google.com/group/comp.mail.imap/browse_thread/thread/b9fcacafc53ff534)）；那么也许设置[`nnimap-list-pattern`](http://gnus.org/manual/gnus_210.html#SEC210)会有所帮助。

哦，如果你没有看到你新订阅的组，那可能是因为 Gnus 自动订阅了[僵尸级别](http://gnus.org/manual/gnus_24.html#SEC24)的组，这意味着他们不是很订阅。通过设置来解决这个问题[`gnus-subscribe-newsgroup-method`](http://gnus.org/manual/gnus_8.html#SEC8)。Gnus就是这样；你真的无法避免学习手册。

# nhibernate - 时间和休眠

> ID：945960
> 
> 赞同：6
> 
> 时间：2009-06-03T17:15:54.560
> 
> 标签：nhibernate, nhibernate-mapping

你好，我有一个使用 nhibernate 作为 orm 的应用程序，我需要存储代表时间的数据，最好的方法是什么？

nhibenate 不知道将时间字段从 db 转换为时间跨度，只有字符串。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-03T17:40:19.767

NHibernate 支持[DateTime、Ticks、TimeSpan 和 Timestamp](https://www.hibernate.org/hib_docs/nhibernate/1.2/reference/en/html_single/#mapping-types-basictypes)。确保您在映射元素上明确指定类型，因为不同的时间类型具有不同的语义，因此 NHibernate 的猜测可能不正确。

如果您现在并且仍然遇到问题，请修改您的帖子以包含您的实体、映射文件和您遇到的实际问题的相关部分。

**编辑：**

例如，对于 a 的以下类`TimeSpan`：

```
public class MyClass
{
    // Other properties
    // ...
    // ...
    public virtual TimeSpan MyTimeProperty { get; set; }
} 
```

和映射文件：

```
<!-- other properties -->
<property name="MyTimeProperty" type="TimeSpan" /> <!-- Note: NH expects the DB type to be DbType.Int64 --> 
```

您表示您正在尝试映射 TimeSpan （“nhibenate 不知道将时间字段从 db 转换为时间跨度，只有字符串”）。如果这是 .NET ( `typeof` `TimeSpan`) 和数据库 ( `DbType.Int64`) 之间的正确类型匹配，NH 应该自动执行此操作（即，您不需要指定`type="TimeSpan"`）。因此，如果它不起作用，我怀疑您的设置方式存在问题。如果您发布带有完整签名的属性/字段声明、`<property>`映射文件中此属性的行以及数据库中的列定义，这可能会有所帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T22:09:45.090

此外，请确保您在数据库中为可以为空的 DateTimes 使用可空值。

约会时间？而不仅仅是日期时间。

如果没有，NHibernate 将尝试将您的日期初始化为默认值，这可能不是您想要的。

# java - Java：如何从命令行导入 jar 文件

> ID：945962
> 
> 赞同：73
> 
> 时间：2009-06-03T17:16:01.080
> 
> 标签：java, command-line, jar, classpath

我正在尝试使用 Java 从命令行（Windows）调用一个类（主要方法）。
该类导入其他类（其他罐子）。

我总是从我的主程序导入的类中得到“类未找到异常”。

这是我尝试过的：

*   添加一个 CLASSPATH 环境。var 与引用的库所在的路径（不起作用）

*   `java -jar myjar.jar`从命令行调用“”时，我尝试了所有这些不同的参数：“ `-classpath lib/`”，“ `-classpath ./lib/`”，“ `-classpath lib`”，“ `-cp lib/*`”，“ `-cp lib/\*`”，“ `-classpath lib/referenced-class.jar`”，“ `-classpath ./lib/referenced-class.jar`”（lib是引用的jar所在的位置）

*   我尝试将所有引用的 jar 打包到我的主类所在的 jar 中......

*   尽管如此，我还尝试使用以下命令指定清单文件中的类： `Class-path referenced-jar.jar`并且我还尝试了`Class-path lib/referenced-jar.jar`

* * *

## 回答 #1

> 赞同：117
> 
> 时间：2009-06-03T17:22:34.397

`-jar`如果您碰巧知道要运行的主类的名称，则可以在不使用命令行参数的情况下运行它：

```
java -classpath .;myjar.jar;lib/referenced-class.jar my.package.MainClass 
```

如果你使用的是 linux，你应该使用 ":" 而不是 ";" 在类路径中。

* * *

## 回答 #2

> 赞同：59
> 
> 时间：2009-06-03T17:19:32.527

如果您使用 运行 jar 文件，[则忽略](http://mindprod.com/jgloss/jar.html#CLASSPATH)`java -jar`该`-classpath`参数。您需要在 jar 的清单文件中设置类路径，如下所示：

> `Class-Path: jar1-name jar2-name directory-name/jar3-name`

请参阅 Java 教程：[将类添加到 JAR 文件的类路径](http://java.sun.com/docs/books/tutorial/deployment/jar/downman.html)。

**编辑：**我看到你已经尝试在清单中设置类路径，但你确定你使用了正确的语法吗？如果你像你展示的那样`:`在“”之后跳过'' `Class-Path`，它就行不通。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-06-03T17:22:17.827

尝试

```
java -cp "your_jar.jar:lib/referenced_jar.jar" com.your.main.Main 
```

如果你在 Windows 上，你应该使用`;`而不是`:`

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-03T17:20:37.627

您可以尝试在 Eclipse 中导出为“Runnable jar”。我也有问题，当我导出为“jar”时，但当我导出为“Runnable jar”时我从来没有问题。

# flash - 添加指向 Flash 视频特定点的链接

> ID：945965
> 
> 赞同：0
> 
> 时间：2009-06-03T17:16:58.537
> 
> 标签：flash, actionscript-3, cs3

我正在尝试在播放视频时将链接插入到视频中。这样，链接和描述性文本就会出现在视频的上方或下方，作为主题之间的旁白电影。我正在使用 Flash 视频。我认为我需要使用 ActionScript（我正在使用 CS3）来执行此操作，但我从未使用过动作脚本。

有人可以提供一个很好的链接或基本说明来帮助整个 ActionScript 新手完成这项工作吗？

*非常*感谢任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T23:12:17.833

如果您要进入 Flash 视频，最好的起点是[Adob​​e 网站上的视频技术中心](http://www.adobe.com/devnet/video/)。这包含大量有关 Flash 视频的信息，以及有关任何新更新和教程的新闻。

目前有一个很好的教程关于[使用 Adob​​e Media Encoder CS4](http://www.adobe.com/devnet/flash/quickstart/video_encoder/)的很好的教程。该教程中有一个关于[提示点的部分（第 5 部分）](http://www.adobe.com/devnet/flash/quickstart/video_encoder/#section5)，您需要查看它来帮助您解决问题。该部分（以及本教程的其余部分）将为您提供比我在这里解释的更多的帮助。

我强烈建议阅读整个教程，但是“**提示点**”正是您要寻找的。

祝你好运！

# java - 在编译时使用自定义类加载器

> ID：945971
> 
> 赞同：3
> 
> 时间：2009-06-03T17:18:44.820
> 
> 标签：java, classloader

是否可以为 javac （或一些替代的 java 编译器）指定自定义类加载器？

我喜欢这样的壮举，因为它允许我编译使用只有我的特殊类加载器才能找到的类的类。

对于好奇的人：我会编写一个连接到数据库并根据它找到的表创建类的类加载器。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-03T19:43:40.640

当你运行 javac 时，你可以像这样指定类加载器：

```
javac -J-Djava.system.class.loader=org.awesome.classloader sourcefile.java 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-03T17:31:08.877

可以初始化一个自定义类加载器，然后在[javax.tools](http://java.sun.com/javase/6/docs/api/javax/tools/package-summary.html)中调用新的 Java 6 编译器 API 时使用它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T17:43:02.197

我知道直接插入 javac（在命令行上运行）的唯一两种方法是通过[注解处理器](http://java.sun.com/javase/6/docs/api/javax/annotation/processing/Processor.html)或通过[特定于编译器的 hack](http://www.iam.unibe.ch/~akuhn/blog/2008/roman-numerals-in-your-java/)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T17:36:14.657

只是为了扩展迈克尔的答案，如果你不能使用 Java6，看看太阳。包——它们一直可用于 java 应用程序并且总是有一个编译器，它不是标准的 Java，所以你很少听到它，API 可能会发生变化（比如将它移动到 javax.tools包裹！）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-03T19:02:11.880

看看[ClassLoader.defineClass](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/ClassLoader.html#defineClass(java.lang.String,%20byte[],%20int,%20int))。我自己用它来将插件加载到我创建的程序中，在该程序中我将文件的字节加载到一个新类中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-03T21:45:08.087

如果这些类都符合相同的接口，您可以在编译时提供它..

如果不是，那么我看不到您通过不输出基于数据库的 .java 文件并对其进行编译来获得什么。

# python - Python中有多种格式说明符吗？

> ID：945972
> 
> 赞同：8
> 
> 时间：2009-06-03T17:18:53.730
> 
> 标签：python

我有一个 44 列宽的数据表，需要写入文件。我不想写：

```
outfile.write("%i,%f,%f,$f ... )\n" % (i, a,b,c ...)) 
```

在 Fortran 中，您可以轻松地指定多个格式说明符：

```
write (*,"(3f8.3)") a,b,c 
```

Python中是否有类似的功能？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-06-03T17:21:59.030

```
>>> "%d " * 3
'%d %d %d '
>>> "%d " * 3 % (1,2,3)
'1 2 3 ' 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-03T17:21:14.990

你问的是

```
format= "%i" + ",%f"*len(row) + "\n"
outfile.write( format % ([i]+row)) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T17:28:19.333

不完全相同，但你可以尝试这样的事情：

```
values=[1,2.1,3,4,5]  #you can use variables instead of values of course
outfile.write(",".join(["%f" % value for value in values])); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T20:55:26.160

请注意，我认为执行以下操作会更好：

```
outfile.write(", ".join(map(str, row))) 
```

...这不是您所要求的，但在几个方面更好。

# c# - 使用 XmlDataSource 填充 TreeView 而不保存文件

> ID：945973
> 
> 赞同：0
> 
> 时间：2009-06-03T17:19:00.453
> 
> 标签：c#, asp.net, xml, treeview

我有一个 .cs 文件，它构建一个 xml 文档并将其存储在一个变量中。

我想将它“注入”到我的`<asp:XmlDataSource>`文件中，这样我就不必保存每个 xml 文件（每次加载都不同）。我该怎么办？

在我的代码隐藏cs文件中，我有：

`XmlDocument x = blahblah`

`XmlDataSource MySource = new XmlDataSource();`

`MySource.Data = x.InnerXml`

在我的 aspx 文件中，我有一个表单标签：

`<asp:XmlDataSource ID="MySource" runat="server" >` `</asp:XmlDataSource>` `<asp:TreeView ID="TreeView1" DataSourceId="MySource" runat="server" />`

然而，当我运行它时，我很容易：对象引用未设置为对象的实例

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T17:30:28.817

如果`MySource`无法识别 XmlDataSource 的 ID，则问题出在其他地方。在正常情况下，`runat="server"`您在 ASPX 文件中声明的任何控件都应该可以在代码隐藏文件中访问。

您应该检查 ASPX 是否正确映射到代码隐藏文件（`@Page`声明）。

此外，您可以直接将字符串 XML 分配给`XmlDataSource.Data`属性，而无需使用中间变量，因为它接受字符串作为输入。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-02-25T09:17:27.310

我相信您可能只是错过了对 XmlDataSource 的 DataBind() 方法的调用。

`MySource.DataBind();`

# c# - 如何从多个可选选项中获取单个值？

> ID：945974
> 
> 赞同：1
> 
> 时间：2009-06-03T17:19:02.887
> 
> 标签：c#, options

我的情况是我需要获得一个定义多个选择选项组合的单个值。这是我想要做的一个小例子。

用户正在购买一件衬衫。用户在购买衬衫时可以选择许多不同的选项。只能（并且必须）从每个选择组中选择一个选项。选择组可以表示为单选按钮列表或下拉列表，任何只允许对每个组进行一个选择的方式。例如：

衬衫颜色：红色、蓝色、绿色、黑色、白色或黄色
衬衫尺码：X-Small、Small、Medium、Large、X-Large、XX-Large
衬衫设计：横条纹、竖条纹、圆点、斜条纹、无设计
衬衫类型：纽扣衬衫、Polo 衫、T 恤、长袖 T 恤、运动衫

因此，为了解决这个问题，每个组只能选择一个选项。使用可能的选择，我总共获得了 900 种不同的变体 (6x6x5x5)。鉴于以下选项具有以下值：

红色 = 1，蓝色 = 2，绿色 = 3，黑色 = 4，白色 = 5，黄色 = 6
X-Small = 0，Small = 1，Medium = 2，Large = 3，X-Large = 4，XX-Large = 5
横条纹 = 0, 竖条纹 = 1, 圆点 = 2, 斜条纹 = 3, 无设计 = 4
纽扣衬衫 = 0, Polo 衫 = 1, T 恤 = 2, 长袖 T 恤 = 3 , 运动衫 = 4

并且选择 {Red, X-Small, Horizo​​ntal Striped, Button Up Shirt} = 1 和 {Blue, X-Small, Horizo​​ntal Striped, Button Up Shirt} = 2，等等，

根据所做的选择找到值的正确方法是什么？比如{Black, Large, Horizo​​ntal Striped, T-shirt}的选择值应该是多少，你是怎么解决的？我不能完全把我的手指放在它身上，我尝试过的一切似乎都没有成功。这可能是一个简单的解决方案，我现在只是脑死亡。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-03T17:26:18.963

您可以像字符串一样连接选项的值（通过将每个单独的值转换为字符串，连接它们，然后将其转换为整数）。所以，{Black, Large, Horizo​​ntal Striped, T-Shirt} 将是 4302。这应该保证没有两个可能的组合具有相同的标识符（尽管我不是数学高手）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T17:35:09.310

在我看来，您的场景映射到`Shirt`具有 4 个枚举的类- `Color`、`Size`和. 该类具有公开所有 4 个枚举类型的私有成员的公共属性。`Design``Type`

因此，一个衬衫实例可以设置所有 4 个属性，而不必担心 900 种可能的组合。此外，一个单独的 Shirt 实例将仅具有每个属性的一种可能组合。您可以以直观的方式查询设置的值的类型，而无需记住哪个整数值映射到什么类型的属性。这正是枚举的用途！;-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T18:20:37.720

衬衫颜色：红色、蓝色、绿色、黑色、白色或黄色 衬衫尺码：X-Small、Small、Medium、Large、X-Large、XX-Large 衬衫设计：横条纹、竖条纹、圆点、斜条纹、无设计衬衫类型：纽扣衬衫、Polo 衫、T 恤、长袖 T 恤、运动衫

请注意，这里有 4 个类别，每个类别都有几个值。您可以使用一个 4 字节整数和一个类别的每个字节。

那么 {Black, Large, Horizo​​ntal Striped, T-Shirt} 可以是值 (4 + 4*2^8 + 1*2^16 + 3*2^24)。

只是不要认为值被挤得紧紧的，你自然会解决。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T17:24:49.323

对于每个选项组合，您真的需要一个单一的数值吗？还是您只需要某种方式将用户的选择分组到一个已知单元中？

如果是后者，我建议创建一个`Shirt`类，其中包含每种选择类型（颜色、大小、设计和类型）的属性。您甚至可以将这些值设为枚举值，因为每个属性的值数量有限。

完成用户选择后，您可以检查实例的每个属性的值，`Shirt`以了解如何将最终的衬衫放在一起。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-03T17:25:56.777

它绝对必须是一个值吗？枚举集合让我觉得最合乎逻辑的选择：

```
ShirtColor Color;
ShirtSize Size;
ShirtPattern Pattern;
ShirtType Type;

enum ShirtColor {Red, Blue, Green, Black, White, Yellow};
... 
```

如果它必须是单个值，您可以选择一个 Int32，并为您要存储的四条信息中的每一条使用该 int 的每个字节中的每个标志。为您提取的每个特征使用[位掩码。](http://en.wikipedia.org/wiki/Mask_(computing))就像是：

```
enum ShirtColor : byte {Red=0, Blue=1};
enum ShirtSize : byte {Small=0, Large=1};

int shirtInfo = 0x0001;

int colorOffset = 0;
int sizeOffset = 8;

ShirtColor color = (ShirtColor)(shirtInfo << colorOffset);
ShirtSize size = (ShirtSize)(shirtInfo << sizeOffset);

Console.WriteLine(Enum.GetName(typeof(ShirtColor), color));
Console.WriteLine(Enum.GetName(typeof(ShirtSize), size)); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-03T17:38:56.867

一种方法是将不同大小的数字范围分配给不同类型的信息：

```
Red = 1, Blue = 2, Green = 3, Black = 4, White = 5, Yellow = 6
X-Small = 100, Small = 200, Medium = 300, Large = 400, X-Large = 500, XX-Large = 600
Horizontal Striped = 1000, Vertical Stripes = 2000, Polka Dots = 3000, Diagonal Stripes = 4000, No Design = 5000
Button Up Shirt = 10000, Polo Shirt = 20000, T-Shirt = 30000, Long Sleeve T-Shirt = 40000, Sweatshirt = 50000 
```

这意味着 42304 是一件黑色长袖 T 恤，中号竖条纹。

就个人而言，除非有特定要求禁止这样做，否则我可能会存储和处理不同的属性和单独的值。

# windows - 确定已注册的延期申请

> ID：945979
> 
> 赞同：2
> 
> 时间：2009-06-03T17:19:52.200
> 
> 标签：windows, winapi, shellexecute

我有一个文件扩展名，我想获取应用程序的名称（如果有的话），当我 ShellExecute 一个该类型的文件时将调用它。这是一个 WTL/C++ 应用程序。是否有任何示例代码可以做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-03T17:45:10.927

twk,

您可能正在寻找 Win32 AssocQueryStringByKey 函数。
[http://msdn.microsoft.com/en-us/library/bb773473(VS.85).aspx](http://msdn.microsoft.com/en-us/library/bb773473(VS.85).aspx)

指定要返回的字符串类型的 ASSOCSTR 值：

```
typedef enum {
    ASSOCSTR_COMMAND = 1,
    ASSOCSTR_EXECUTABLE,
    ASSOCSTR_FRIENDLYDOCNAME,
    ASSOCSTR_FRIENDLYAPPNAME,
    ASSOCSTR_NOOPEN,
    ASSOCSTR_SHELLNEWVALUE,
    ASSOCSTR_DDECOMMAND,
    ASSOCSTR_DDEIFEXEC,
    ASSOCSTR_DDEAPPLICATION,
    ASSOCSTR_DDETOPIC,
    ASSOCSTR_INFOTIP,
    ASSOCSTR_QUICKTIP,
    ASSOCSTR_TILEINFO,
    ASSOCSTR_CONTENTTYPE,
    ASSOCSTR_DEFAULTICON,
    ASSOCSTR_SHELLEXTENSION,
    ASSOCSTR_DROPTARGET,
    ASSOCSTR_DELEGATEEXECUTE,
    ASSOCSTR_MAX
} ASSOCSTR; 
```

我的猜测是你想要 ASSOCSTR_FRIENDLYAPPNAME。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-07-20T06:40:22.397

```
DWORD dwSize = 255;
TCHAR sBuffer[MAX_PATH] = {0};
HRESULT hr = AssocQueryString(0, ASSOCSTR_EXECUTABLE, _T(".htm"), _T("Open"), sBuffer, &dwSize);
CString csExt;
csExt.Format(_T("%s"), sBuffer);
AfxMessageBox(csExt); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T17:37:42.953

抱歉，没有代码，但有一些有用的信息。请参阅此相关问题：[how-does-vista-generate-the-icon-for-documents-associated-to-my-application](https://stackoverflow.com/questions/580827/how-does-vista-generate-the-icon-for-documents-associated-to-my-application)

它询问了图标，但事实证明与扩展关联的程序与该扩展的图标存储在注册表中的相同位置。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-04T13:29:16.360

这是自 1995 年以来的 Win32 常见问题解答（Shell，请参阅 Google Groups，Win32）

# msbuild - 自定义 MSbuild 任务中的必需标记

> ID：945980
> 
> 赞同：1
> 
> 时间：2009-06-03T17:19:56.067
> 
> 标签：msbuild, msbuild-task

您如何知道是否在没有`[Required]`标志的属性上传递了值。

不需要且未传入的字符串的值是多少？如果它是一个空字符串，那么您如何知道与调用者发送的空字符串的区别？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-04T14:43:49.440

如果您需要知道是否设置了一个值，那么您可以在您的属性中创建一个标志，例如

```
public MyTask : Task
{
    private string mName;
    private bool mNameSet;

    public string Name
    {
        get{return mName;}
        set
        {
            mName = value;
            mNameSet = true;
        }
    } 
```

...更多在这里

```
} 
```

因此，您只需检查 mNameSet 标志即可查看该属性是否已设置。赛义德·易卜拉欣·哈希米

我的书：[Microsoft Build Engine 内部：使用 MSBuild 和 Team Foundation Build](https://rads.stackoverflow.com/amzn/click/com/0735626286)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-05T17:33:40.837

你无法区分。如果任务未在任务构造函数中设置默认值，则两者都将为空。

我不知道它是否应该对自定义任务产生影响。如果参数为 null 或空 --- `String.IsNullOrEmpty()`--- 那么任务应该分支到该特定值的默认逻辑。

# php - 在 PHP 中加密部分 HTML 并在 JavaScript 中解密

> ID：945981
> 
> 赞同：1
> 
> 时间：2009-06-03T17:20:00.857
> 
> 标签：php, javascript, html, ajax, encryption

我正在寻找一种在 PHP 中加密 HTML 表单的方法，这样我就可以在浏览器中使用 JavaScript 对其进行解密。这应该对用户透明地工作，并且 JavaScript 输入验证也必须在表单上工作（我知道如何做到这一点）。当用户提交表单时，它必须再次加密并使用“AJAX”请求发送到服务器。

编辑：这将用作替代 CAPCHA 系统，因此脚本无法提交表单，除非通过一些巧妙的设计。

编辑2：我知道这是可刹车的，一切都是。汽车锁是可刹车的，但我们仍然使用它们。它并不意味着最终的验证码，而是一个减速带，它将把除了最顽固的人之外的所有人赶走。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-03T17:26:52.503

这与 DRM 的问题相同：用户拥有密文。解密是在用户的系统上完成的，因此用户也必须拥有密钥。如果用户同时拥有密钥和密文，那么所有加密都是毫无意义的。

如果您只想从外部窥探者那里安全地传输数据，为什么不直接使用 SSL (HTTPS)？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T17:29:05.200

您可以使用 base64。

```
<?php
echo base64_encode('html source');
<? 
```

然后你可以使用 jquery 插件： http: [//plugins.jquery.com/project/base64](http://plugins.jquery.com/project/base64)或 javascript [http://www.webtoolkit.info/javascript-base64.html](http://www.webtoolkit.info/javascript-base64.html)来解码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T20:01:38.827

如果你想用它来阻止垃圾邮件，我有一些坏消息要告诉你：
[垃圾博客的人的价格正在下降到零](http://www.guardian.co.uk/technology/2006/nov/23/comment.comment2)

这是一个现实。在我运行的一个网站上，我设置了一个验证码系统，垃圾邮件正在通过该系统。除了大约 2 人以外，其他人都来自世界上较贫穷的地区，所以我怀疑有些公司付钱给人们发送垃圾邮件。为了测试这一点，我将某些地区的人创建的帐户设置为仅对他们可见，并且在他们发布了一些内容以提醒他们他们的帐户被自动隐藏的事实之后。如果他们是合法用户，我向他们提供了联系我们并投诉的表格。这样做后，我们开始每天收到大约 10 封来自人们对我们隐藏了他们的帐户感到愤怒的电子邮件，但是在检查他们添加的内容后，他们是垃圾邮件发送者！这听起来很疯狂，但不幸的是，现在大部分垃圾邮件似乎都是人类造成的。垃圾邮件发送者知道我们使用验证码，所以他们已经适应了。:(

验证码正迅速变得无用（如果还没有的话）。添加一个链接以便用户可以报告垃圾邮件，并在用户被授予管理员权限的情况下设置业力级别，以便他们的标记导致在没有事先确认的情况下自动隐藏垃圾邮件（就像 stackoverflow 所做的那样）实际上是现在阻止垃圾邮件的唯一有效方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T17:42:12.307

对于 CAPTCHA，击败脚本的唯一方法是只能由人类完成的事情 - 例如识别图像中的某些内容，或者做一些数学运算。

由浏览器完成的所有解密都可以通过自动化脚本轻松完成。

# iphone - 如何判断何时发送对象释放消息？

> ID：945984
> 
> 赞同：1
> 
> 时间：2009-06-03T17:20:34.880
> 
> 标签：iphone, objective-c, cocoa-touch

我正在处理一个有点棘手的 iPhone 崩溃问题，看起来罪魁祸首是一个 NSString 过早发布。我打开了 NSZombiesEnabled 并且可以看到 NSString 在崩溃时是一个僵尸。但是，我无法确定对象何时被释放/释放——我已经梳理了我的代码，寻找发送到该对象的释放消息，并在这些位置设置断点，但它们没有被命中。

我认为这可能是一个线程或自动释放问题，因为它是间歇性的，但是有没有办法通过 Xcode 调试器挂钩到 Objective-c 运行时来告诉对象被释放的确切点？或者有没有更好的方法来诊断这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-03T21:38:01.660

如果您可以在模拟器中重现崩溃，您可能希望研究使用该`malloc_history`工具。（它有一个手册页。）您需要设置一些环境变量：我通常通过“参数”窗格中的“编辑活动可执行文件”屏幕设置它们，然后使用那里的复选框启用/禁用它们。确保在设备上调试之前禁用它们；如果启用，程序将尝试写入`/tmp`沙盒不允许的内容。

我发现这个工具结合了`NSZombie`让我跟踪 alloc/premature-release/access-after-dealloc 错误。一旦`NSZombie`报告了对已解除分配对象的访问权限，您就可以使用`malloc_history`它来确定对象何时被分配。这通常会让我走上解决问题所在的道路。

我发现另一个无价的工具是来自 LLVM 项目的*clang 。*它仍在开发中，但他们定期为 MacOS-X 生成对我来说似乎相当稳定的二进制文件。特别是，它了解 Cocoa 内存管理策略。使用它很简单：

```
% cd ${DIRECTORY_CONTAINING_XCODE_PROJECT}
% xcodebuild clean
% scan-build -V xcodebuild 
```

这将对您的项目进行完整构建，并生成一份报告，列出该工具发现的任何明显错误（包括引用计数错误）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-03T17:25:18.293

我可能没有直截了当地思考，但您是否考虑过在您的课程中添加释放和释放

```
- (void) release 
{
  NSLog(@"Releasing");
  [super release];
}
- (void) dealloc
{
  NSLog(@"Deallocating");
  [super dealloc];
} 
```

结合 Ben Gotow 的评论以使用 obj-c 类别，您最终会得到：

```
@interface NSString (release) 
  -(void) release;
@end

@implementation NSString (release)
-(void) release
{
  NSLog(@"NSString Released!");
  [super release];
}
@end 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-03T17:39:45.807

您可以告诉`objc`提供商在被调用`dtrace`时触发您的探测`-[NSString release]`，但这将涉及一些令人讨厌的黑客行为。NSStrings 实际上不是 NSStrings，而是所有子类，因为类被实现为类集群的方式。现在，这不会妨碍我们。什么是没有自己的*:-)*。不过，您可以在一个类别中提供自己的。`NSString``-release`

或者，如果您很容易判断哪个实例`NSString`会中断，您可以在`-[NSObject dealloc]`with上设置一个条件断点`self==myInstance`。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-12-15T20:46:35.377

另一种方法来做到这一点。确保打开 NSZombie，以便它报告正在获得额外释放的对象的内存地址。然后使用性能工具-> 对象分配运行。这将带来乐器。查看 Xcode 管理器提供的控制台日志。一旦你得到崩溃查找仪器中的内存地址。您将看到该对象上 malloc/frees 的全部历史，以及直接进入您的代码的链接。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-03T17:26:10.630

你能实现 dealloc() 并在其中放置一个断点吗？从那时起查看堆栈跟踪应该会告诉您它在何处以及如何被释放。

# passwords - 多次输入密码

> ID：945998
> 
> 赞同：0
> 
> 时间：2009-06-03T17:23:08.997
> 
> 标签：passwords, expect, unix

我正在运行一个应用程序，它提示输入用户密码大约十几次 :-( 我尝试使用 expect 来规避这个问题，并让它在自动模式下运行，但我无法克服多次的问题密码，这不是完全静态的。有时它会询问 4-5 次，有时会询问 9-10 次左右。

有没有比我在下面给出的更好的解决方案：

```
spawn myApp [lindex $argv 0]
expect " password: $"
send "$password\r"
expect {
  " password: $"    send "$password\r"
  "^Rollout Done "
  "^Rollout Updated "
} 
```

通过上述解决方案，我只能捕获两次密码，然后在其余时间手动开始输入，密码是否可能出现循环？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-03T22:06:48.497

查找[exp_continue](http://wiki.tcl.tk/16158)命令——它会阻止当前`[expect]`命令返回，因此它可以找到任何后续的密码提示。

```
spawn myApp [lindex $argv 0]
expect {
    -re { password: $} {
        send "$password\r"
        exp_continue
    }
    -re {^Rollout (?:Done|Updated) }
} 
```

如果您希望用户输入密码，而不是将其以纯文本形式存储在脚本中，请参阅[如何使期望脚本提示输入密码？](https://stackoverflow.com/questions/681928/how-can-i-make-an-expect-script-prompt-for-a-password)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T18:32:17.570

Expect 可以使用循环——我相信它只是带有一些附加命令的 TCL。所以就这样做

```
set found 0
while {$found < 1}
{
expect {
 " password: $"    send "$password\r"
 "^Rollout Done "  set found 1
 "^Rollout Updated " set found 1
}
} 
```*************