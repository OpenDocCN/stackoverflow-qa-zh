# StackOverflow 问答 000451000-000451999

# java - 最佳 Java 支持的服务器/客户端协议？

> ID：451004
> 
> 赞同：0
> 
> 时间：2009-01-16T16:27:02.770
> 
> 标签：java, client-server, protocols

我正在编写一个基于消息的客户端/服务器应用程序。我想尽可能地重复使用，而不是编写另一个实现并好奇其他人在使用什么。

图书馆应提供的功能：

*   **客户端和服务器端**功能
*   应该**基于消息工作**
*   支持**多线程**
*   应该**在负载平衡器/防火墙后面工作**

我用[HTTPCore](http://hc.apache.org)做了几个测试，但底线是必须同时实现客户端和服务器，只覆盖传输层。由于网络相关要求，RMI 也不是一个选项。

任何想法都受到高度赞赏。

* * *

**细节**

我的想法是实现一个客户端/服务器包装器，它处理客户端通信（包括用户/密码验证）并将传入请求写入 JMS 队列：

```
#1  User --> Wrapper (Check for user/password) --> JMS --> "Server"
#2  User polls Wrapper which polls JMS 
```

单独的进程将处理请求，并可以通过包装器回复客户端。我想使用 JMS，因为：

*   它很好地处理持久性
*   负载平衡——通过添加额外的服务器作为消费者很容易处理峰值
*   JMSTimeToLive 也很方便

不幸的是，我没有看到自己使用 JMS 的方法，因为客户端应该只能访问他们的消息，并且在 JMS 端设置不同的用户听起来也不可行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-16T16:31:13.493

好吧，就实现它的客户端和服务器代码而言，HTTP 可能是最好的支持 - 但根据您的要求，它可能完全不合适。我们需要真正*了解*一些要求（或者至少对应用程序的情况有一个模糊的了解），然后才能真正为您提供适当的建议。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-16T16:42:26.250

RMI 非常适合我们。存在一些限制，例如除非您可以直接连接到该计算机，否则无法回叫客户端（如果客户端位于防火墙后面则不起作用）。您还可以轻松地将通信包装在 SSL 中，或者通过可以包装在 SSL 中的 HTTP 进行隧道传输。

如果您最终使用它，请记住始终设置分发给客户端的类的串行版本。您可以在创建时将其设置为 1L，或者如果客户端已经拥有该类，请使用 serialver.exe 来发现现有类的序列号。否则，一旦您更改或添加公共方法或变量，与现有客户端的兼容性就会中断。

静态最终长serialVersionUID = 1L

编辑：进入服务器的每个 RMI 请求都有自己的线程。你不必自己处理这个。

编辑：我认为稍后在问题中添加了一些细节。您可以通过 HTTP 建立 RMI 隧道，然后可以使用负载均衡器。

我最近开始和 Hessian 一起玩，它显示出很大的希望。它本机使用 HTTP，这使得它比 RMI over HTTP 更简单，而且它是一个二进制协议，这意味着它比所有基于 XML 的协议都快。让 Hessian 前进非常容易。我最近通过在我们的应用程序中嵌入 Jetty、配置 Hessian Servlet 并使其实现我们的 API 接口来做到这一点。Hessian 的伟大之处在于它的简单性……与基于 HTTP 的 JMS 或 RMI 完全不同。还有其他语言的 Hessian 库。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-16T16:33:33.413

我会说，Java 的最佳支持（如果不是最佳实现的话）客户端/服务器通信包是 Sun 的 RMI（远程方法调用）。它包含在标准 Java 类库中，可以完成工作，即使它不是最快的选项。当然，它也得到了 Sun 的支持。几年前我用它实现了一个回合制游戏框架，它相当稳定。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-16T16:59:03.017

很难根据给出的信息提出建议，但可能使用 TemporaryQueues，例如基于每个客户端动态创建的 PTP 目的地可能适合这个问题？

[这](http://www.onjava.com/pub/a/onjava/2007/04/10/designing-messaging-applications-with-temporary-queues.html)是一个合理的概述。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-16T17:03:35.800

您是否尝试过*[RMI](http://en.wikipedia.org/wiki/Java_remote_method_invocation)*或*[CORBA](http://en.wikipedia.org/wiki/CORBA)*？使用它们，您可以[分配逻辑](http://en.wikipedia.org/wiki/Distributed_computing)并创建会话

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-16T18:13:48.873

使用 Spring....然后选择协议。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-16T16:36:32.720

我们正在标准化 Adob​​e 的 AMF，因为我们在客户端层使用 Adob​​e Flex/AIR，在我们的中间层堆栈中使用 Java6/Tomcat6/BlazeDS/Spring-Framework2.5/iBATIS2.3.4/ActiveMQ-JMS5.2 ( Oracle 10g 后端）。

因为我们正在对 Flex 客户端开发进行标准化，所以 AMF 和 BlazeDS（由于 Adob​​e 和 SpringSource 在集成方面的合作，现在更好地与 Spring 耦合）是我们可以用来与服务器端交互的最有效和最方便的方式。

我们还在数据中心大量构建了 JMS 消息传递 - BlazeDS 使我们能够将 Flex 客户端作为 JMS 主题订阅者进行桥接。这是非常强大和有效的。

我们的 Flex .swf 和 Java .class 代码捆绑到同一个 .jar 文件中以进行部署。这样，客户端代码的正确版本将被部署以与将处理客户端服务调用（或消息传递操作）的相应中间层 java 代码进行交互。这一直是客户端-服务器计算的祸根——确保各个层的正确版本相互连接。我们已经通过我们特殊的打包和部署方法有效地解决了这个古老的问题。

我们所有的客户端-服务器交互都在 HTTP/HTTPS 端口 80 和 443 上工作。甚至我们使用 BlazeDS 进行的服务器端消息推送也桥接到我们的 ActiveMQ JMS 消息代理。

# .net - 如何在 LINQ 中急切加载整个 SQL 表？

> ID：451006
> 
> 赞同：2
> 
> 时间：2009-01-16T16:27:44.110
> 
> 标签：.net, sql, linq, eager

编写我的第一个 Linq 应用程序，我正在尝试找到执行以下操作的最佳方法：

我想一次加载整个员工表以填充缓存（用于表单自动完成）。

我可以 -

```
var query = from employee in db.Employees select employee;
foreach (Employee e in query)
{
    ...
} 
```

但由于这是延迟加载，它会为每个员工生成一个查询。我怎样才能急切地加载整个表？

我调查过`DataLoadOptions`，但这似乎只适用于人际关系。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-16T16:30:02.530

```
var query = db.Employees.ToList(); 
```

顺便说一句，这相当于：

```
var query = (from employee in db.Employees select employee).ToList(); 
```

当 lambda 语法更有意义且更短时，没有理由强迫自己使用查询运算符语法。

*旁注1*：`query`对象的类型将是`List<Employee>`，但是，如果我们明确指定它，则生成的IL和性能没有区别。

*旁注2 ：重要的是要知道问题***中***指定的查询***不会*****为每个员工执行一次**。它只执行一次，并从数据库中一一获取（类似于`SqlDataReader`运行`SELECT * FROM Employees`查询的对象）。但是，`ToList()`加载列表中的所有行，使进一步查询该对象在应用程序本身而不是 SQL Server 上执行。*

 *# vb.net - VB.NET 函数返回

> ID：451025
> 
> 赞同：29
> 
> 时间：2009-01-16T16:31:32.653
> 
> 标签：vb.net, function, return

为了从 VB.NET 函数返回一个值，可以为“函数名称”分配一个值或使用“返回值”。

我有时会看到这些混合在同一个函数中。就个人而言，我更喜欢退货。

我的问题是，两者之间的内部差异是什么？

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2010-06-16T19:37:47.583

不同之处在于他们做不同的事情！

'Return value' 做了两件事：
1\. 它在该点设置函数返回值 2\. 它立即退出函数

函数中没有进一步的代码执行！

'Functionname = value' 做了 1 件事： 1\. 它在该点设置函数返回值

函数中的其他代码继续执行这使附加逻辑能够细化或覆盖函数返回值

大不同的人。请记住，这不仅与状态有关，还与流程有关。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-01-16T16:55:14.943

让我们来看看......奇怪的是“functionName =”生成的IL更少？

代码：

```
Public Function Test() As String
    Test = "Test"
End Function

Public Function Test2() As String
    Return "Test"
End Function 
```

伊利诺伊：

```
.method public static string Test() cil managed
{
    .maxstack 1
    .locals init (
        [0] string Test)
    L_0000: nop 
    L_0001: ldstr "Test"
    L_0006: stloc.0 
    L_0007: ldloc.0 
    L_0008: ret 
}

.method public static string Test2() cil managed
{
    .maxstack 1
    .locals init (
        [0] string Test2)
    L_0000: nop 
    L_0001: ldstr "Test"
    L_0006: stloc.0 
    L_0007: br.s L_0009
    L_0009: ldloc.0 
    L_000a: ret 
} 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-01-16T16:34:49.697

可能没有区别。IIRC，编译器生成的 IL 将它们都转换为 Return 语句**，除非另外使用 _returnValue 变量**。

在我看来，FunctionName 赋值的可读性很差，是 VB6 坏习惯的一个例子。我也更喜欢 _returnValue (NOT RETVAL) 变量方法。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-01-16T16:34:33.473

执行以下操作仅供[Visual Basic 6.0](http://en.wikipedia.org/wiki/Visual_Basic#Timeline)开发人员轻松移植代码：

```
Public Function MyFunction() As String
    MyFunction = "Hello"
End Function 
```

如果您的项目包括没有使用过 Visual Basic 6.0 的任何人，我绝对不建议继续这样做，因为这种语法会令人困惑。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-16T16:40:20.903

100 次中有 99 次我会使用“返回值”。

每隔一段时间我就会有一个函数，其中另一种类型不仅允许我保存变量声明，而且以一种实际上显着澄清函数的方式来做。通常，当我想将返回值命名为与函数相同时，通常会发生这种情况，并且通常这些是递归函数；关于该构造的某些东西将其借给了隐式返回变量。不过，这种情况*极为罕见*。我不知道在我当前的项目中是否有任何使用隐式返回变量的函数。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-05-30T18:39:07.030

当工具/选项/文本编辑器/所有语言/代码镜头被激活时，引用计数显示在每个子、函数或属性语句的上方。

“返回值”似乎比“为函数名称赋值”更好。在后一种情况下，“代码镜头”会产生一个膨胀的参考计数。

```
' Code Lens reports "0 references" here for Sub Rosa().
Public Sub Rosa()
    Diagnostics.Debug.WriteLine(Test())
    Diagnostics.Debug.WriteLine(Test2())
End Sub

' Code Lens reports "2 references" here for Function Test().
Public Function Test() As String
    Test = "Test"       ' Code Lens counts this as a reference.
End Function

' Code Lens reports "1 reference" here for Function Test2().
Public Function Test2() As String
    Dim strTest2 as String = "Test"
    Return strTest2     ' Code Lens does NOT count this as a reference.
End Function 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-08-21T22:49:56.013

读到返回值语法是一种真正的[.NET](http://en.wikipedia.org/wiki/.NET_Framework)做事方式后，我想“好的，我们会那样做”。然后我写了一个我知道的函数，手头知道，在任何情况下都从 Return 语句返回一个值，或者返回一个异常，并且仍然得到一个编译器警告，该函数“不会在所有路径上返回一个值” .

谢天谢地，我遇到了 Stack Overflow 问题*[如何使这个函数不生成“在所有路径上都没有返回值”警告？](https://stackoverflow.com/questions/3994368)*这解释了原因；在函数开头的过程名称中添加默认值分配也可以防止在我的情况下出现警告。

因此，即使我将继续使用返回值语法只是为了语法一致性，我也会为函数名称分配一个默认值，以防止编译过程因虚假警告而混乱。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-04-15T15:50:00.050

在使用 3rd 方工厂（_hsf）时非常方便，您可以避免声明返回变量

```
Public Function CreateExtremum(iShape As INFITF.Reference, iDir1 As HybridShapeTypeLib.HybridShapeDirection, iSide1 As Integer, iDir2 As HybridShapeTypeLib.HybridShapeDirection, iSide2 As Integer, iDir3 As HybridShapeTypeLib.HybridShapeDirection, iSide3 As Integer) As HybridShapeTypeLib.HybridShapeExtremum
    CreateExtremum = _hsf.AddNewExtremum(iShape, iDir1, iSide1)
    CreateExtremum.Direction2 = iDir2
    CreateExtremum.ExtremumType2 = iSide2
    CreateExtremum.Direction3 = iDir3
    CreateExtremum.ExtremumType3 = iSide3
    CreateExtremum.Compute()
End Function 
```

# c# - 基于 ASP.NET 的 MMOG 的可行性

> ID：451026
> 
> 赞同：2
> 
> 时间：2009-01-16T16:31:39.483
> 
> 标签：c#, asp.net, asp.net-ajax, chat

我想开发基于 ASP.NET C# 的 MMOG（大型多人在线游戏）。我将使用 ASP.NET Ajax 控件工具包、jquery 和 MS SQL server 2005。

Q.1).NET 3.5、ASP.NET 和 C# 在同时处理数千个用户方面的可行性。

我还将基于 ASP.NET ajax 的聊天系统与 MMOG 旁边的聊天室结合起来。

Q.2) 你知道任何使用 ASP.NET 的网站 (MMOG) 吗？

Q.3) 上面提到的聊天系统的最佳实践是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-16T16:37:52.763

1.  在创建应用程序时，ASP.NET 可以通过适当的服务器配置、硬件和性能考虑来处理它。

2.  我试图做一些谷歌搜索并没有立即找到任何东西，但我确信那里有一些。

3.  对于聊天片段，您可能会查看诸如 CuteChat 之类的产品，该产品已经存在并且已经过很长时间的尝试和测试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-16T16:38:10.313

ASP.NET 和 MSSQL 2005 绝对没有“内置”缩放问题。您将必须小心地正确构建您的应用程序，并准备好花一些钱购买合适的硬件。

例如，请参阅计划解决 stackoverflow 负载的[硬件设置。](https://blog.stackoverflow.com/2009/01/new-stack-overflow-server-glamour-shots/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-16T17:01:50.360

我会考虑使用 Silverlight 而不是基于 AJAX 的东西。从 UI 的角度来看，您将能够做更多的事情。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-16T17:17:02.967

ViewState 最终将成为您的游戏团队副本老板，除非您禁用它或切换到 ASP.NET MVC。

也许今天您从 html/javascript/jquery UI 开始，明天您将使用精美的 Silverlight 或 Flash UI。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-16T17:18:13.447

AjaxControlToolkit 相当臃肿而且有点难以定制。对于 MMO，速度将是一个优先事项，因此您将希望尽可能多地控制您的回发。

您也可以尝试为您的前端研究 Silverlight。它与 .NET 环境很好地集成在一起，并且可以更容易地开发您的交互式作品。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-16T17:11:00.280

大量运行 ASP.NET 的大型网站。我强烈推荐使用新的 MVC 框架，因为它大大降低了 ASP.NET 网站的复杂性。

# visual-studio-2008-sp1 - 如何使用 VSTS 2008 Database Edition GDR Version 编辑数据库对象的默认模板

> ID：451032
> 
> 赞同：2
> 
> 时间：2009-01-16T16:32:33.943
> 
> 标签：visual-studio-2008-sp1, visual-studio-dbpro

我正在尝试使用 Visual Studio Team System 2008 数据库版（GDR 版）进行我正在处理的一个新项目，并且遇到了一个有点烦人的问题，我希望有人知道如何解决这个问题。

简而言之，我想更改用于生成数据库对象的默认模板，尤其是存储过程。过去，使用 SSMS，我只是创建了自己的模板，其中包含格式、默认参数数量等，我通常希望在创建新存储过程时使用这些模板。这显然消除了大量的手工编码，并且对我来说“感觉正确”，以便在我的 T-SQL 代码中保持一定的一致性。

我尝试通过添加我想使用的格式和默认结构来编辑位于 ..\Microsoft Visual Studio 9.0\DBPro\Items 中的 .sql 文件。不幸的是，我无法让 VSTS 识别这些变化。当我使用 GUI 添加新的存储过程时，它仍然使用默认的存储过程格式。

我已经尝试关闭 Visual Studio 并在进行这些调整后重新启动它，但这似乎没有任何效果。

有谁知道如何做到这一点？我无法在 MSDN 或 DBPro 团队的博客上找到任何文档，但我觉得这可以做到。任何帮助或建议将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T10:40:40.157

Microsoft Visual Studio 9.0\DBPro\Items 是一个旧目录。这些是错误的模板。正确的模板位于 Microsoft Visual Studio 9.0\VSTSDB\Extensions\SqlServer\Items 中。编辑这些作品，你甚至不必关闭视觉工作室。

# c# - 如果打算隐藏，请使用新关键字

> ID：451035
> 
> 赞同：55
> 
> 时间：2009-01-16T16:32:45.880
> 
> 标签：c#, inheritance, warnings, new-operator

我有以下代码片段在 VS2008 中生成“如果有意隐藏则使用新关键字”警告：

```
public double Foo(double param)
{
   return base.Foo(param);
} 
```

基类中的`Foo()`函数受到保护，我想通过将其放入包装类中来将其公开给单元测试，仅用于单元测试的目的。即包装类不会用于其他任何事情。所以我有一个问题是：**这是公认的做法吗？**

回到`new`警告。**为什么在这种情况下我必须新的覆盖功能？**

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2009-01-16T16:35:53.517

`new`只是清楚地表明您知道您正在踩踏现有的方法。由于现有的代码是`protected`，这没什么大不了的 - 您可以安全地添加`new`以停止它的呻吟。

当您的方法做了不同的事情时，差异就会出现。任何引用*派生*类和调用的变量`Foo()`都会做一些不同的事情（即使是同一个对象）作为引用*基*类和调用的变量`Foo()`：

```
SomeDerived obj = new SomeDerived();
obj.Foo(); // runs the new code
SomeBase objBase = obj; // still the same object
objBase.Foo(); // runs the old code 
```

这显然会对任何知道`SomeDerived`和调用的现有代码产生影响`Foo()`——即它现在正在运行一个完全不同的方法。

另外，请注意，您可以标记它`protected internal`，并使用它`[InternalsVisibleTo]`来提供对单元测试的访问（这是最常见的用法`[InternalsVisibleTo]`；然后您的单元测试可以直接访问它而无需派​​生类。

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2009-01-16T16:38:59.173

关键是您*没有*覆盖该方法。你在隐藏它。如果您要覆盖它，则需要`override`关键字（此时，除非它是虚拟的，否则编译器会抱怨，因为您*无法*覆盖非虚拟方法）。

您使用`new`关键字告诉编译器和任何阅读代码的人，“没关系，我知道这只是隐藏基本方法而不是覆盖它 - 这就是我的意思。”

坦率地说，我认为隐藏方法很少是一个好主意——我会使用不同的方法名称，就像 Craig 建议的那样——但这是一个不同的讨论。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-01-16T16:36:22.360

您正在更改没有名称的可见性。调用您的函数 TestFoo ，它将起作用。是的，恕我直言，因此可以接受子类化。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-07-24T06:07:32.160

您总是会发现一些棘手的情况，其中`new`关键字可以用于隐藏，而大多数情况下可以避免。

然而，最近我真的需要这个关键字，主要是因为该语言缺少一些其他适当的语法功能来完成现有的访问器，例如：

如果您考虑一个老式的课程，例如：

```
KeyedCollection<TKey, TItem> 
```

您会注意到通过索引访问项目的访问器是：

```
TItem this[Int32 index] { get; set; } 
```

两者都有`{ get; set; }`，它们当然是强制性的，因为继承了`ICollection<T>`and `Collection<T>`，但是只有一个`{ get; }`可以通过它们的键访问项目（我对这个设计有一些猜测，有很多原因，所以请注意我选择了仅用于说明`KeyedCollection<TKey, TItem>)`目的）。

无论如何，密钥访问只有一个吸气剂：

```
TItem this[TKey key] { get; } 
```

但是如果我想添加`{ set; }`支持呢，从技术上讲，它并不是那么愚蠢，特别是如果你继续从以前的属性定义中推理，它只是一种方法......唯一的方法是显式地实现另一个虚拟接口但是当你想要隐含你必须想出`new`关键字，我隐藏了访问器定义，保留了 get; 基本定义，只需添加一组塞满一些个人物品的集合即可使其正常工作。

我认为对于这个非常具体的场景，这个关键字是完全适用的，特别是在没有带入`{ get; }`部分的上下文中。

```
 public new TItem this[TKey key]
  { 
      get { return base... }
      set { ... }
  } 
```

这几乎是避免这种警告的唯一技巧，因为编译器会建议您可能在没有意识到自己在做什么的情况下隐藏。

# oracle - Oracle Forms 10g 中的查询/位置对话框

> ID：451047
> 
> 赞同：1
> 
> 时间：2009-01-16T16:35:16.170
> 
> 标签：oracle, oracle10g, oracleforms

在 Oracle Forms 6i 中，您可以在表单中进入查询模式，并在字段中键入**&**或**:A**，当您执行查询时，会打开 Query/Where 对话框，允许您输入更复杂的查询或排序条件不仅仅是在字段中输入数据允许。

这似乎在 Forms 10g 中不起作用：我收到“FRM-40367：示例记录中的字段 XX 中的无效标准”错误。

在 Oracle Forms 10g 中有没有办法做到这一点？如果这很重要，我们正在运行基于 Web 的，而不是客户端服务器。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-17T22:00:12.067

在这里发布这个问题后，我遇到了答案。在 10g 形式中，默认情况下禁用此功能，但可以通过设置启用

```
FORMS_RESTRICT_ENTER_QUERY=FALSE 
```

在 default.env 文件中。我们现在已经在我们的测试环境中启用了它，并且它按预期工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-17T00:21:58.927

此功能曾经在 Oracle eBusiness Suite 中，但我认为可能由于 SQL 注入漏洞而被删除。不确定是否有办法将其重新打开 - 值得在[http://metalink.oracle.com](http://metalink.oracle.com)上查看。问候，加雷斯

# sharepoint - 如何公开 SharePoint 工作流实例的状态？

> ID：451055
> 
> 赞同：1
> 
> 时间：2009-01-16T16:36:43.873
> 
> 标签：sharepoint, workflow

我有一个相当直接的顺序批准工作流，它有一个 EnableModificationActivity，它几乎适用于整个工作流。我的修改表单是一个 ASPX 页面，它使用户能够启用/禁用工作流中尚未发生的批准步骤。由于工作流可以多次修改，我希望表单能够反映工作流的当前状态，这意味着它应该显示当前启用或禁用了哪些活动。

我为此提出了一个笨拙的解决方案，稍后我将分享，但我必须相信有一个干净的方法可以解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-19T18:29:15.760

所以这是我最终采取的方法......

1.  我创建了一个普通的旧 CLR 对象 (POCO) 类，专门用于保存能够被 XML 序列化的特定工作流的状态信息。我将把它称为未来的“状态对象”。

2.  我创建了一个名为“WorkflowStateManager”的可重用类，它能够为给定的 SPWorkflow 加载和保存单个状态对象。工作流和修改表单都可以访问此类。

    *   保存状态实现：
        1.  XML 将对象序列化为字符串
        2.  在 SPWorkflow 列表项的属性包上设置序列化字符串并调用属性包的 Update() 方法
    *   加载状态实现（本质上与保存状态实现相反）
        1.  从 SPWorkflow 列表项的属性包中获取序列化字符串
        2.  XML 将字符串反序列化为状态对象
3.  当工作流被激活时，我构造一个新的状态对象，初始化它的各种属性，并使用 WorkflowStateManager 保存它。

4.  随着工作流程的进行，我会根据需要通过以下方式加载和更新状态对象：

    *   使用 WorkflowStateManager 加载当前状态对象
    *   根据状态对象的值做出工作流决策
    *   对状态对象进行所需的更改
    *   使用 WorkflowStateManager 保存状态对象
5.  现在，我的修改表单还能够使用 WorkflowStateManager 加载、操作和保存状态对象，进而向用户公开工作流的当前状态。

我希望这可能对某人有益。

# c# - 如何使用设计人员友好的预绑定数据源创建派生组合框？

> ID：451058
> 
> 赞同：3
> 
> 时间：2009-01-16T16:37:40.050
> 
> 标签：c#, winforms, combobox, datasource, designer

我想从 System.Windows.Forms.ComboBox 创建一个派生控件，该控件绑定到我从数据库中检索的对象列表。想法是其他开发人员可以直接在他们的表单上删除这个控件，而不必担心数据源、绑定，除非他们愿意。

我尝试扩展组合框，然后在构造函数中设置 DataSource、DisplayMember 和 ValueMember。

```
public class CustomComboBox : ComboBox
{
    public CustomComboBox() 
    {
        this.DataSource = MyDAL.GetItems(); // Returns List<MyItem>
        this.DisplayMember = "Name";
        this.ValueMember = "ItemID";
    }
} 
```

在我运行时工作，但一旦添加到任何表单中，就会在 Visual Studio 中引发很多错误。我得到的错误是：

> “属性“项目”的代码生成失败。错误是：“对象引用未设置为对象的实例”

完成此任务的正确方法是什么（C#、Winforms、.NET 2.0+）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-16T17:11:19.140

问题是设计者实际上在与正常运行程序略有不同的上下文中进行了一些编译和执行。

在构造函数中，您可以将代码包装在：

```
if (!DesignMode)
{
  //Do this stuff
} 
```

这将告诉设计者在设计时不要运行任何初始化代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-20T16:24:35.763

DesignMode 属性在构造函数中不起作用。从谷歌搜索了一段时间，找到了这个 LicenseManager 的东西。

```
if (LicenseManager.UsageMode != LicenseUsageMode.Designtime)
{
    // Do your database/IO/remote call
} 
```

但是 LicenseManager 仅适用于构造函数。对于事件处理程序，请使用 DesignMode。

来源：[http ://dotnetfacts.blogspot.com/2009/01/identifying-run-time-and-design-mode.html](http://dotnetfacts.blogspot.com/2009/01/identifying-run-time-and-design-mode.html)

另一个参考：[http ://weblogs.asp.net/fmarguerie/archive/2005/03/23/395658.aspx](http://weblogs.asp.net/fmarguerie/archive/2005/03/23/395658.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-16T17:43:22.537

我在这里通常的评论 - DesignMode 在任何情况下都不可靠，除非控件直接放置在设计图面上 - 即如果控件放置在另一个控件上，即使您处于设计模式，DesignMode 也不正确。我发现没有可靠的方法来判断您是否处于设计模式 - 特别是使用继承的控件。如果控件继承自非可视控件（例如通用对话框），即使使用站点的变体也不可靠。

请参阅[http://keyofdflat.livejournal.com/5407.html](http://keyofdflat.livejournal.com/5407.html)（请务必阅读最后一条评论）。

# sql - SQL nvl 等效 - 没有 if/case 语句 & isnull & coalesce

> ID：451060
> 
> 赞同：1
> 
> 时间：2009-01-16T16:37:52.547
> 
> 标签：sql, syntax, informix, null

SQL 中是否有任何 nvl() 等效函数？

或者在某些情况下可以以相同方式使用的足够接近的东西？

* * *

更新：
没有 if 语句
没有 case 语句
没有 isnull
没有合并

* * *

```
select nvl (purge_date,"SODIUFOSDIUFSDOIFUDSF") from id_rec where id=36581;

(expression)

SODIUFOSDIUFSDOIFUDSF

1 row(s) retrieved.

select isnull (purge_date,"SODIUFOSDIUFSDOIFUDSF") from id_rec where id=36581;

  674: Routine (isnull) can not be resolved.
Error in line 1
Near character position 8

select coalesce (purge_date,"SODIUFOSDIUFSDOIFUDSF") from id_rec where id=36581;

  674: Routine (coalesce) can not be resolved.
Error in line 1
Near character position 8

select decode(purge_date, NULL, "01/01/2009", purge_date) from id_rec where id=74115;

  800: Corresponding types must be compatible in CASE expression.
Error in line 1
Near character position 57 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-16T16:39:50.780

[ISNULL](http://msdn.microsoft.com/en-us/library/ms184325.aspx)（用于单个替换）

或者

[COALESCE](http://msdn.microsoft.com/en-us/library/ms190349.aspx)（返回其参数中的第一个非空表达式。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-16T16:51:53.907

SQL Server：IsNull 或 COALESCE [http://msdn.microsoft.com/en-us/library/ms184325.aspx](http://msdn.microsoft.com/en-us/library/ms184325.aspx)

Sybase：isnull 函数 [http://infocenter.sybase.com/help/index.jsp?topic=/com.sybase.help.ase_15.0.blocks/html/blocks/blocks162.htm](http://infocenter.sybase.com/help/index.jsp?topic=/com.sybase.help.ase_15.0.blocks/html/blocks/blocks162.htm)

Postgres：虽然没有完全检查，但我找不到。建议选择 IS NULL 并从这里构建 [http://archives.postgresql.org/pgsql-sql/1998-06/msg00142.php](http://archives.postgresql.org/pgsql-sql/1998-06/msg00142.php)

DB2 - 合并 [http://publib.boulder.ibm.com/infocenter/db2luw/v8/index.jsp?topic=/com.ibm.db2.udb.doc/admin/r0000780.htm](http://publib.boulder.ibm.com/infocenter/db2luw/v8/index.jsp?topic=/com.ibm.db2.udb.doc/admin/r0000780.htm)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-16T16:41:19.090

您似乎正在使用 Informix。

AFAIK，那里有解码：

`DECODE(field, NULL, 'it is null, man', field)`应该给你相同的结果`NVL(field, 'it is null, man')`

请发布您正在使用的 RDBMS 的确切名称和版本。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-19T01:22:45.740

生成 800 错误的 DECODE 语句的问题很简单。`'01/01/2009'`被视为字符串，它实际上是产生错误的第四个参数。

理解 DECODE 语句的输入和输出可以是不同的数据类型，因此引擎要求您在这种情况下更加明确。（您是想`purge_date`转换为 string 还是 string `'01/01/2009'`，或者将 string 参数解析为日期或原始日期？引擎无法知道。

试试这个：

```
SELECT DECODE(purge_date, NULL, '01/01/2009'::DATE, purge_date) 
```

您也可以将第三个参数写为：

```
 DATE('01/01/2009')
    MDY(1,1,2009) 
```

取决于版本和个人喜好。

# c# - vs2008循环引用（c#）

> ID：451068
> 
> 赞同：2
> 
> 时间：2009-01-16T16:39:14.757
> 
> 标签：c#, asp.net, visual-studio-2008

这是我在 vs2008 解决方案中的设置：

名为 MyProject.Data 的项目中的数据层

名为 MyProject.Web 的项目中的 Web 应用程序

MyProject.Web 有对 MyProject.Data 的引用

在 MyProject.Web 中，我使用了一个名为“MySite.Utils”的类

我希望能够在 MyProject.Data 中使用 MySite.Utils 但我不能，因为它会导致循环引用。

一种不可能的解决方案是创建第三个项目并在其中移动“MySite.Utils”，因为 MySite.Utils 实际上使用 MyProject.Data（因此它需要引用它并且将创建另一个循环引用）

解决此问题的最佳/最简单方法是什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-16T16:43:12.753

您需要通过声音将 MySite.Utils 移动到 MyProject.Data

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-16T16:46:28.580

最好的解决方法是简化事情……例如，实用程序代码*数据*实用程序代码或*ui*实用程序代码。也许将其拆分为 2 个 dll；这可能会使事情变得更简单。

之后，接口是一个合理的选择，但您可能需要一些 IoC 框架来提供实现。IoC 是解决此类问题的最常见方法。例如，您`ICustomerRepository`在参考程序集中声明您的；一切都引用了这一点。您的 DAL**实现**了接口，但 utils 项目不再需要引用 DAL - 只需接口程序集。您的 DAL 现在可以引用实用程序 - 或者它可能只知道另一个接口`IDataUtils`（当然，最好将它更有意义地拆分）。这里的粘合剂是 IoC 容器，例如 Castle Windsor。

最后，**不要这样做**，但即使 IDE 不允许，也可以在 .NET 中创建循环引用（通过命令行工具）；这是合法的，但很快就会变得非常混乱，并且很难修复损坏的构建。不要去那里！！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-16T16:59:32.797

使用依赖注入击败耦合。

编程到接口。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-16T17:08:31.470

MySite.Utils 不应在您的解决方案中引用任何其他项目。任何在 Utils 中引用另一个解决方案的类都应该移到它引用的那个解决方案中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-16T16:43:33.313

我相信解决此问题的**唯一**方法是将所有相互关联的功能移动到一个程序集中，以便没有循环引用。对不起。:(

也许考虑以某种方式改变架构，这不是必需的？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-16T16:51:11.257

听起来您可以从阅读本文中受益（并享受！）...

[http://www.amazon.com/Framework-Design-Guidelines-Conventions-Development/dp/0321246756](https://rads.stackoverflow.com/amzn/click/com/0321246756)

# c# - 我可以用 iTextSharp 填写加密的 PDF 吗？

> ID：451070
> 
> 赞同：7
> 
> 时间：2009-01-16T16:39:53.167
> 
> 标签：c#, itext

我有一个可填写、可保存的 PDF 文件，它有一个所有者密码（我无权访问）。我可以在 Adob​​e reader 中填写，导出 FDF 文件，修改 FDF 文件，然后导入。

然后我尝试用 iText for .NET 来做。我无法从我的 PdfReader 创建 PdfStamper，因为我没有向读者提供所有者密码。有没有办法以编程方式执行此操作，或者我必须重新创建文档？

即使使用 FdfReader 也需要 PdfStamper。我错过了什么吗？任何合法的东西——我很确定我可以破解文件，但我不能。具有讽刺意味的是，重新创建它可能没问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-18T04:08:46.580

此行将绕过 iTextSharp 中的编辑密码检查：

```
PdfReader.unethicalreading = true; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-09-22T03:29:43.387

[我在发布这个问题几个月后发现了这个问题，我现在将这个解决方案发布给在搜索中遇到这个问题的任何人。]

我的情况完全相同：我的客户有一个 PDF，其中包含我需要以编程方式访问的可填写字段。不幸的是，PDF 受密码保护，他们没有密码，所以我发现无法使用他们的文件。

我发现 iTextSharp 4.0.4 版（及更高版本）强制执行密码限制，而早期版本没有。

所以我下载了 4.0.3 版本，果然成功了。在我的情况下，我什至不必更改我的代码来使用这个旧版本。

您可以[在 SourceForge 下载 4.0.3（和所有其他版本）](http://sourceforge.net/projects/itextsharp/files/itextsharp/)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-12-13T11:57:35.577

两件重要的事

1.  设置`PdfReader.unethicalreading = true`以**防止 BadPasswordException。**
2.  在 PdfStamper 的构造函数中设置**附加模式，否则 Adob​​e** *Reader Extensions*签名会损坏，Adobe Reader 将显示以下消息：*“此文档包含在 Adob​​e Reader 中启用特殊功能的某些权限。该文档自创建以来已更改，这些权限是不再有效。请联系作者获取本文档的原始版本。*

所以你需要做的就是：

```
PdfReader.unethicalreading = true;
using (var pdfReader = new PdfReader("form.pdf"))
{
    using (var outputStream = new FileStream("filled.pdf", FileMode.Create, FileAccess.Write))
    {
        using (var stamper = new iTextSharp.text.pdf.PdfStamper(pdfReader, outputStream, '\0', true))
        {
            stamper.AcroFields.Xfa.FillXfaForm("data.xml");
        }
    }
} 
```

请参阅[如何使用 iText 填写 XFA 表单？](https://stackoverflow.com/questions/26629498/how-to-fill-xfa-form-using-itext)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-22T16:01:03.420

除非其他人插话，否则我会假设答案是“不”

我最终以未加密的形式重新生成了 PDF。

# .net - 生成大量静态html

> ID：451078
> 
> 赞同：2
> 
> 时间：2009-01-16T16:41:49.900
> 
> 标签：.net, php, asp.net

我有一个需要从一组数据中生成大量静态 html 的过程。html相对复杂，我希望维护相当简单，所以我不想在程序代码中嵌入太多的html。在我的公司，有福的工具集是 .net 或 php。我最初的想法是将 asp.net 编译器嵌入到批处理程序中，并为生成的页面对象提供渲染前所需的数据。然后将渲染的输出与数据一起保存到磁盘。这听起来可行吗？应该这样做吗？另一个建议是编写一个批处理 php 脚本，将其输出写入文件。这听起来更简单，但是维护程序的开发人员的技能在 php 中并不那么强大。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-16T16:47:42.197

这听起来很愚蠢，而且*肯定*会有更好的方法 - 但它会使开发/调试变得相当简单：

*   把它写成一个普通的 ASP.NET 站点
*   批处理过程是：
    *   启动 Cassini（甚至是正确的 IIS）
    *   将大量 URL（和/或表单数据）输入到 wget 或 curl 等工具中，并让它们保存结果

另一种选择可能是使用 LINQ to XML 来“手动生成”XHTML。这实际上取决于您的数据格式等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-17T20:28:55.417

如果您担心 html 生成的性能，您应该研究 asp.net 的缓存能力。

Asp.net 缓存允许将生成的 html 缓存在内存中，以便下一个请求在不生成页面的情况下获得提供的 html。这几乎与生成常规 html 文件一样快。

照这样说。为什么不直接建立一个带有常规 html 页面的网站呢？IIS 允许您自由混合 aspx 和 html 页面。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-16T16:47:09.953

取决于你的数据。如果数据来自 xml，您也可以使用 xslt。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-17T20:16:35.257

对于创建网页，我建议使用模板引擎——我喜欢 Smarty，但还有很多其他的可供选择。这将使维护页面更容易。

如果您保留或生成索引页面，则可以使用 wget 将所有页面转换为静态 html。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-16T17:31:09.303

不要过于复杂。你需要一个网站，建立一个网站。

# asp-classic - 如何在 Classic ASP 中进行有效的分页？

> ID：451080
> 
> 赞同：1
> 
> 时间：2009-01-16T16:42:15.890
> 
> 标签：asp-classic, pagination

我正在尝试对表格进行分页，虽然我已经进行了分页，但它会在一行中显示每个页面以及上一个/下一个链接，如果有很多结果（通常有）。

我想做的是以 10 个为一组显示页面，例如 1...10，如果您在第 10 页并单击“下一步”，则它会更改为 11-20，依此类推。我该怎么做呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-16T19:20:45.417

Wayne 我建议你看看**[ajaxed asp library](http://www.ajaxed.org)**。它是一个仍然活跃的经典 ASP 项目，它提供通用分页（适用于所有类型的数据结构），并且还在其[Datatable 控件](http://www.ajaxed.org/article/Using--Understanding-Datatables/22/)中使用分页机制。

该控件允许您轻松地创建仅使用 SQL 查询的表。类似于 asp.net 的 Datagrid。完全 AJAX 也是如此。

检查数据表示例，您将看到批处理分页等等......一切都完全可配置。

支持的数据库是 MySQL、sqlite、MS Access、MS Sqlserver、Oracle

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-16T17:22:08.650

一种解决方案是让客户端进行分页。如果桌子不是太长，这会很好用。我们使用以下 jQuery 插件：[http ://sprymedia.co.uk/dataTables/example_multiple_tables.html](http://sprymedia.co.uk/dataTables/example_multiple_tables.html)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-01-16T16:46:11.047

如果您使用的是 MySQL，则可以直接在 sql 中进行分页，如下所示：

```
SELECT ...
FROM
WHERE
LIMIT pagenum*pagesize, (pagenum+1)*pagesize 
```

编辑：我首先以为上面的sql是针对sqlserver的。

# apache-flex - AS3 - 如何同步加载异步调用？

> ID：451090
> 
> 赞同：1
> 
> 时间：2009-01-16T16:43:41.910
> 
> 标签：apache-flex, actionscript-3

我有一个从 Web 服务异步加载用户对象的函数。

我将此函数调用包装在另一个函数中并使其同步。

例如：

```
 private function getUser():User{
            var newUser:User;
            var f:UserFactory = new UserFactory();

            f.GetCurrent(function(u:User):void{
                newUser = u;
            });

            return newUser;
        } 
```

UserFactory.GetCurrent 看起来像这样：

```
public function GetCurrent(callback:Function):void{ } 
```

但我的理解是不能保证当这个函数被调用时，newUser 实际上会是新用户？

你如何在 Flex 中完成这种类型的返回函数？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-16T17:46:16.853

如此疯狂的谎言。

说真的，你最好不要试图将异步调用强制到某种同步架构中。了解事件处理系统如何为您服务并为结果事件添加处理程序。事实上，这是直接来自[flexcoders](http://tech.groups.yahoo.com/group/flexcoders/) FAQ 的建议：

```
问：如何进行同步数据调用？

答：您不能进行同步调用。您必须使用结果事件。不，
您不能使用循环、setInterval 甚至 callLater。这个范式是
起初相当恶化。深吸一口气，臣服于
不可避免，抵抗是徒劳的。

有一种通用的方法来处理数据服务的异步特性
调用称为 ACT（异步调用令牌）。在中搜索这个
开发 Flex 应用程序文档以获得完整描述。

```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-16T17:42:14.803

在这里查看我的答案：

[DDD 和异步存储库](https://stackoverflow.com/questions/178070/ddd-and-asynchronous-repositories#327288)

Flex 和 Flash 远程处理本质上是异步的，因此与这种范式作斗争会给您带来很多麻烦。我们的服务委托从每个方法返回 AsyncToken，我们从来没有遇到过问题。

如果您想确保应用程序在结果/故障返回之前不会呈现新视图或执行其他逻辑，您可以执行以下操作：

1.  为自定义事件附加一个事件侦听器，该事件将调用您的“发布结果/故障代码”
2.  进行异步调用
3.  处理结果/故障
4.  调度自定义事件以从 #1 触发您的侦听器

请记住，每次进行异步调用时，这都会导致大量烦人的样板代码。我会非常仔细地考虑您是否真的需要同步执行路径。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-16T16:49:27.967

如果没有“sleep()”函数之类的功能，就无法将异步调用转换为同步调用，据我所知，AS3 中缺少它。是的，不能保证 newUser 在 return 语句之前包含用户名。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-29T10:03:26.710

[PureMVC 框架](http://puremvc.org/component/option,com_wrapper/Itemid,160/)的AS3 端口具有在模型-视图-控制器上下文中实现同步操作的机制。它不会尝试同步异步调用，但它允许您添加同步应用程序模式来控制它们。

这是一个示例实现：[PureMVC AS3 Sequential Demo](http://trac.puremvc.org/Demo_AS3_Sequential)。

在此示例中，五个子命令按顺序运行，共同构成一个完整的命令。在您的示例中，您将实现`getUser()`为一个命令，该命令将调用`commandComplete()`（`getURL()`或其他）回调。这意味着下一个命令将确定`getUser()`操作已完成。

# asp.net - 清理/重建会消失的异常。如何诊断/预防？

> ID：451095
> 
> 赞同：0
> 
> 时间：2009-01-16T16:45:11.237
> 
> 标签：asp.net, exception, exception-handling

*预问题：由于公司修补疏忽，我们的办公室被蠕虫袭击，实验室里的男孩们重修了我的机器。我需要重新安装我的所有开发工具（Visual Studio 2005、SP1 和 Web 应用程序项目安装补丁）。在此事件之前未发生以下问题。*

几个月来，我一直在研究一个 ASP.NET Web 应用程序项目。我一直在编辑，调试等没有问题。然后，我添加了一行代码，在 Debug 中运行它并得到了这个错误：

```
System.Web.HttpUnhandledException: 
Exception of type 'System.Web.HttpUnhandledException' 
was thrown. 
System.IO.FileLoadException: The given assembly name 
or codebase was invalid. (Exception from HRESULT: 0x80131047) 
```

我取消了新代码的注释，构建了项目并再次运行调试，但得到了同样的错误。

新代码：

`Me.frm.btnSubmitChanges.Attributes.Add("onclick", "javascript:return validateSubmit();")`

我能够解决此问题的唯一方法是清理，然后重建项目。我无法使用断点捕获它发生的位置。

这几天发生了几次。我应该看什么来解决这个问题？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-16T16:50:07.247

您是否尝试过启用 Fusion Logger 以查看它是否是无法加载的程序集？在 C# 中，您可以告诉调试器在任何异常时中断（您可以通过自定义名为 Exceptions 的工具栏来添加一个命令）。我不确定VB是否有这个，但我认为他们有。你能告诉它在 FileLoadException 上中断吗，这可能有助于你理解发生了什么。

您添加的代码行非常无害。当您添加它中断的代码时，您是否在该行代码仍然存在的情况下完成了一个干净的构建并且它是否有效？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-16T17:00:43.933

我确实运行了 Fusion Logger，但发生异常时没有得到任何结果。我尝试了所有 4 种设置。

清理/重建后，新的代码行运行良好。

我以前没有对所有异常使用过中断；我看看能不能找到。

# postgresql - 在视图上执行触发器？

> ID：451096
> 
> 赞同：10
> 
> 时间：2009-01-16T16:45:44.417
> 
> 标签：postgresql, triggers, view, hsqldb

我对数据库触发器和/或视图不太熟悉。我目前正在使用 PostgreSQL 和 HSQL；虽然数据库不是太重要。我只是想知道是否*有任何*数据库提供这样的东西：

我有一个像这样的（示例）表：

```
CREATE TABLE DUMMY_TABLE (ID INTEGER, NUMBER INTEGER); 
```

我创建了一个这样的视图：

```
CREATE VIEW DUMMY_VIEW AS SELECT * FROM DUMMY_TABLE WHERE NUMBER > 5; 
```

我插入了几个实体：

```
INSERT INTO DUMMY_TABLE VALUES(1,2);
INSERT INTO DUMMY_TABLE VALUES(1,10); 
```

所以当我打电话时，当然 DUMMY_VIEW 只包含 VALUES(1,10)

```
SELECT * FROM DUMMY_VIEW 
```

所以现在我要做的是向 DUMMY_VIEW 添加一个触发器，只要插入一个 NUMBER > 5 的实体就会调用该触发器。

我尝试将触发器直接添加到 HSQL 和 PostgreSQL 中的 DUMMY_VIEW；但他们说触发器不能添加到视图中。

这（或功能相似的解决方案）可能吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2011-07-17T22:17:43.550

需要注意的是 PostgreSQL 9.1+ 支持视图触发器。请参阅[WAITING FOR 9.1 – TRIGERS ON VIEWS](http://www.depesz.com/index.php/2010/10/16/waiting-for-9-1-triggers-on-views/)以简要了解这一点。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-16T16:59:18.650

是的，触发器不能直接放在视图上。您应该做的是在基表上放置一个触发器并检查新的 NUMBER 行的值是否大于 5。

注意：视图只是一个存储的选择语句，因此它并不真正保存数据。这就是为什么无法检查视图结构中是否正在插入、删除或更新数据的原因。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-16T16:53:24.637

我认为您必须将触发器放在桌子上，而不是视图上。

触发器可以在视图上使用查询，以便您处于[DRY](http://en.wikipedia.org/wiki/Don't_repeat_yourself)状态。

还有其他原因触发器需要在视图上而不是表上吗？

回应评论的一个例子

```
-- Create function
CREATE FUNCTION doWhatIwant() RETURNS trigger AS '
BEGIN
IF NEW.number > 5 THEN
  do_stuff
END IF;
RETURN NEW;
END;
' LANGUAGE plpgsql;

-- Create trigger
CREATE TRIGGER yourTrigger AFTER INSERT ON dummy_table
  FOR EACH ROW EXECUTE PROCEDURE doWhatIwant(); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-16T22:04:41.433

您可以使用规则而不是触发器（[一个示例](http://www.lshift.net/blog/2006/07/20/updateable-views-in-postgresql)），但请记住规则是 PostgreSQL 特定的功能。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-16T16:57:01.057

我不确定你想要达到什么目标。

触发器在数据更改时执行代码。视图是（比方说）“可调用的数据子集”。它几乎不存在，*除非*您从中选择。它不能包含触发器，因为它不*包含*任何内容。

所以基本上你想要一个基表上的触发器。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-16T16:58:23.113

如果您将触发器添加到具有与视图相同的条件的表中，这是可能的。

触发器主体应具有以下内容：

```
if (inserted.NUMBER > 5) {
   do something;
}
//do nothing if inserted.NUMBER is not > 5 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-04-17T09:44:49.373

HSQLDB 2.x 支持可更新视图和触发器可更新视图。

您的视图示例可自行更新。因此，您可以使用视图而不是表来插入/删除/更新行。这将不允许在插入和更新中包含 NUMBER <= 5 的行。

您还可以在视图上定义触发器。这些触发器是用 INSTEAD OF INSERT、INSTEAD OF UPDATE 或 INSTEAD OF DELETE 定义的。在触发器的主体中，您可以检查值并针对无效输入引发异常，或者将行插入基表中。

见[http://hsqldb.org/doc/2.0/guide/triggers-chapt.html](http://hsqldb.org/doc/2.0/guide/triggers-chapt.html)

# c# - 在 C# 中实现双向枚举器

> ID：451099
> 
> 赞同：6
> 
> 时间：2009-01-16T16:46:14.993
> 
> 标签：c#, iterator, ienumerator

有没有办法使用 yield 块来实现一个`IEnumerator<T>`可以向后（`MoveLast()`）以及向前的方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-16T16:50:20.227

不，C#编译器生成的状态机是严格向前的。

在许多情况下，甚至倒退也没有意义。想象一个从网络流中读取的迭代器——要倒退，它必须记住它曾经读取过的所有内容，因为它无法倒回时间并再次向网络请求数据。

（同上任何以某种有损方式生成数据的东西。想象一个迭代器，它在每次迭代中为 Conway's Life 返回一个新板 - 有多个板可能都是*前*一个板，所以要向后退，你必须再次记住你'已经回来了。）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-16T16:53:45.273

不是直接来自迭代器块，不。

然而，调用者总是可以缓冲结果，例如到 a`List<T>`中，或者只是调用`Reverse()`- 但这并不总是适用。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-04-22T16:36:22.510

我知道这个线程非常旧，但需要注意的是

```
foreach(var item in someCollection)
{
    // Do something
} 
```

...被编译成：

```
var enumerator = someCollection.GetEnumerator()
while (enumerator.MoveNext())
{
    var item = enumerator.Current;
    // Do something
} 
```

因此，如果您不介意“MoveNext”语法，您可以轻松实现 IEnumerator 并添加“MovePrevious”。如果您使用“foreach”，您将无法反转方向，但如果使用 while 循环，您将能够反转方向。

或者......如果你想以相反的方向（不是双向）“foreach”一个列表，你可以利用 yield 语句。

```
public static IEnumerable<TItem> Get<TItem>(IList<TItem> list)
{
    if (list == null)
        yield break;

    for (int i = list.Count - 1; i > -1; i--)
        yield return list[i];
} 
```

或者...如果您想通过长途旅行来反向进行 foreach，您可以实现自己的 IEnumerable/IEnumerator

```
public static class ReverseEnumerable
{
    public static IEnumerable<TItem> Get<TItem>(IList<TItem> list)
    {
        return new ReverseEnumerable<TItem>(list);
    }
}

public struct ReverseEnumerable<TItem> : IEnumerable<TItem>
{
    private readonly IList<TItem> _list;

    public ReverseEnumerable(IList<TItem> list)
    {
        this._list = list;
    }

    public IEnumerator<TItem> GetEnumerator()
    {
        if (this._list == null)
            return Enumerable.Empty<TItem>().GetEnumerator();

        return new ReverseEnumator<TItem>(this._list);
    }

    IEnumerator IEnumerable.GetEnumerator()
    {
        return this.GetEnumerator();
    }
}

public struct ReverseEnumator<TItem> : IEnumerator<TItem>
{
    private readonly IList<TItem> _list;
    private int _currentIndex;

    public ReverseEnumator(IList<TItem> list)
    {
        this._currentIndex = list.Count;
        this._list = list;
    }

    public bool MoveNext()
    {
        if (--this._currentIndex > -1)
            return true;

        return false;
    }

    public void Reset()
    {
        this._currentIndex = -1;
    }

    public void Dispose() { }

    public TItem Current
    {
        get
        {
            if (this._currentIndex < 0)
                return default(TItem);

            if (this._currentIndex >= this._list.Count)
                return default(TItem);

            return this._list[this._currentIndex];
        }
    }

    object IEnumerator.Current
    {
        get { return this.Current; }
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-16T16:54:02.933

C5 Collections 库 ( [http://www.itu.dk/research/c5/](http://www.itu.dk/research/c5/) ) 使用反向枚举实现集合和链表。该项目是开源的，所以你应该能够在那里找到答案。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-16T16:56:31.557

不可以。IEnumerator 的限制之一是它保持其当前状态，并且不记得其先前状态。因此，IEnumerable 是只进的。

如果您需要保留先前的状态，请将 IEnumerable 读入 List 或 LinkedList 并枚举这些对象。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-16T17:29:07.777

[实际上， Accelerated C# 2008](http://books.google.com/books?id=A-vzSC3zhqMC&pg=PA247&lpg=PA247&dq=bidirectional+enumerator+c%23&source=bl&ots=kdZFYaHmIM&sig=rBeEPLRXvoa-JyfZ3lmbCMBEQrg&hl=en&sa=X&oi=book_result&resnum=2&ct=result#PPA249,M1)中似乎描述了一种方法。不幸的是，两个页面在预览中是不可见的，它必须依赖于反射（其结果可以像往常一样被缓存）但你可以得到要点。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-16T16:50:25.000

不，使用[`yield`](http://msdn.microsoft.com/en-us/library/9k7k7cf0.aspx)结果[`IEnumerable`](http://msdn.microsoft.com/en-us/library/9k7k7cf0.aspx)是单向的。

# c++ - 如何在 C/C++ 中处理二进制数据

> ID：451102
> 
> 赞同：1
> 
> 时间：2009-01-16T16:46:51.483
> 
> 标签：c++, c, binary

我必须对整数做一些工作，但我有兴趣将它们视为二进制数据，例如我可以获取 32 位值的 4 个最高有效位。我想要做的是，我有几个 32 位值，例如，第一个 4 位，第二个 6 位和最后一个 22 位，然后将它们连接起来并获得另一个 32 位值.

谁能推荐任何图书馆或任何其他方式来做到这一点？谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-16T16:51:46.463

看来您不需要图书馆。对于您想要做的事情，只需移位、逻辑与或或和 xor 就足够了。

编辑：只是举个例子。假设`a`是一个 32-bit `int`，并且您想要获取前 4 位并将其存储在另一个 integer 的最低位位置`b`，您可以这样做：

```
b = (a & (0xf << (31-4))) >> (31-4) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-16T16:54:17.427

只使用内置的按位运算符？

```
int a;
int b;
int c;

int result = a & 0xF0000000 | b & 0x0FC00000 | c & 0x003FFFFF; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-16T16:58:28.790

只需尝试使用*位运算*符来使用它们的位来处理它们：**|、&、^、<<、>>**。

对于 IO，如果要保证它们都可以被多个平台读取，请使用*htons()、htonl()、ntohs()、ntohl()*函数集来处理它们。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-20T19:44:52.143

我总是更喜欢使用位域，让编译器找出所有的位移。如果您想进行更改，它也会变得更容易。但是，您必须小心有符号整数，并了解编译器如何根据位域处理它们。

尽管如此...

```
union _type
{
    struct
    {
        unsigned int a : 22;
        unsigned int b : 6;
        unsigned int c : 4;
    };

    unsigned int u;
    int          s;
}; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-17T17:51:06.017

现有几篇关于位操作的文章，[Absolute Beginner's Guide to Bit Shifting？](https://stackoverflow.com/questions/141525/absolute-beginners-guide-to-bit-shifting)或 [解释设置、清除和测试单个位的算法](https://stackoverflow.com/questions/267832/explanation-of-an-algorithm-to-set-clear-and-test-a-single-bit)。

# php - 是否可以在a.aspx上写b.aspx的内容？

> ID：451125
> 
> 赞同：0
> 
> 时间：2009-01-16T16:51:13.690
> 
> 标签：php, asp.net, vb.net

这是场景：我有两个asp页面。a.aspx 是布局，b.aspx 是内容。我想在 a.aspx`<div>`上显示 b.aspx 的内容。我知道使用 PHP 你可以这样做：

```
//a.php
<html>
   <head>
      <title>test</title>
   </head>
   <body>
      <?PHP
         include "b.php";
      ?>
   </body>
</html>

//b.php
<?PHP
   echo "Content String";
?>

//result
<html>
   <head>
      <title>test</title>
   </head>
   <body>
      Content String
   </body>
</html> 
```

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-16T16:58:08.090

此方案由母版页处理，或由 ASP.NET 中的（用户）控件组成页面。例如[这里](http://www.asp.net/Learn/master-pages/)描述的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-16T16:55:45.847

可能`Server.Execute`会有所帮助。

```
//a.aspx
<html>
   <head>
      <title>test</title>
   </head>
   <body>
      <% Server.Execute("b.aspx"); %>
   </body>
</html>

//b.aspx
   Content String

//result
<html>
   <head>
      <title>test</title>
   </head>
   <body>
      Content String
   </body>
</html> 
```

顺便说一句，我**不**推荐这种方法。这只是为了表明它可以做到。母版页和用户控件通常是要走的路。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-16T16:54:47.473

创建一个 B.ascx 来完成您需要的一切，然后 B.aspx 和 A.aspx 都可以包含该控件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-16T16:55:51.043

听起来 MasterPages 会为您完成这项工作。这不是您的选择吗？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-16T16:56:32.477

你可以去老派并使用 IFRAME

或者，可以使用 a.aspx.cs 中的 WebRequest 打开 b.aspx，将结果存储在字符串中，然后在 a.aspx 上的 div 中返回该字符串

# c++ - 如何定义地址为空的对象？

> ID：451126
> 
> 赞同：0
> 
> 时间：2009-01-16T16:51:25.873
> 
> 标签：c++, c, linker, weak-references

我想知道如何在 C 中定义一个引用为空的对象？

```
// definition of foo 
...
void * bar = &foo; // bar must be null 
```

我可以找到一些方法来做到这一点，但没有一个适合我的需要。

```
__attribute__((weak)) extern int foo; //not working with cygwin/gcc 3.4
__attribute__((at(0))) int foo;       //only with rvds
#define foo (*(int*) 0)               //cannot be embedded in a macro 
```

实际上，我更喜欢符合标准的解决方案（c99），但任何工作都可以。

* * *

编辑：这样做的原因是 bar 并不总是为空。这是一个更相关的例子：

```
// macro that will define foo to a real object or to *null
DECL(foo);

int * bar = &foo;

if(bar) {
  // we can call func
  func(bar);
} else {
  // bar undefined
  exit(-1);
} 
```

当然，这仍然不是很相关，因为我可以在我的情况下使用#if。该项目实际上涉及大型结构、大量文件、一些编译器、一些 cpu 目标以及许多程序员，这些程序员产生的错误的概率与他们使用的语法的复杂性成指数级。这就是为什么我想要一个简单的宏来声明我的 foo 对象。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-16T16:54:28.223

我必须遗漏一些东西，但是什么不起作用`void * bar = NULL`？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-16T17:22:04.563

在您的课程中，您可以覆盖`&`运算符：

```
class MyClass
{
    public:
        MyClass() :
            m_isNull(true)
        {
        }

        MyClass(int value) :
            m_isNull(),
            m_value(value)
        {
        }

        int value() const
        {
            /* If null, throw exception, maybe? */

            return m_value;
        }

        bool isNull() const
        {
            return m_isNull;
        }

        /////////////////////////
        // Here's the "magic". //
        /////////////////////////
        MyClass *operator&()
        {
            if(m_isNull)
                return 0;
            return this;
        }

    private:
        bool m_isNull;
        int m_value;
}; 
```

这会产生用户`MyClass`可能不会期望的行为。我不确定在哪里需要甚至想要这个“功能”。

如果您想获取`MyClass`实例的真实地址，可以使用`boost`（如对此答案的评论中所建议）：

```
MyClass foo;

MyClass *fooptr = &foo; // fooptr == NULL
fooptr = boost::addressof(foo); // fooptr = &foo (the real address) 
```

或者你可以使用强制转换，所以`MyClass::operator&()`不叫：

```
struct DummyStruct {};

MyClass foo;

MyClass *fooptr = &foo; // fooptr == NULL
fooptr = &reinterpret_cast<DummyStruct>(foo); // fooptr = &foo (the real address) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-16T17:56:44.133

您想要的是一个包含空地址的引用。这是非常糟糕的做法，但这里有：

```
#ifdef NON_NULL
Foo realFoo;
Foo &foo = realFoo;
#else
Foo &foo = *(Foo*)NULL;
#endif 
```

请不要这样做。auto_ptr 可能是更好的选择。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-16T17:08:33.530

您正在尝试创建一个地址为零的符号。您的最后一个示例可能是在 C 编译器/语言中执行此操作的唯一方法。

最有可能解决您的问题的方法是查看链接器程序的输入文件。大多数链接器允许您将标签 foo 定义为零。

在 unix ld 脚本中，这只是： foo = 0 ;

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-16T17:09:14.667

我认为没有标准的方法来定义地址为 0 的东西。或者更确切地说，它是未定义的，因为它可以取消引用 0，它在标准中是未定义的（或者它是特定于平台的？）。

你想做什么？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-16T17:20:15.753

好的，这肯定是个问题，但是您想要一个值为 0 的指针吗？

怎么样

```
void * bar = (void*) 0; 
```

您不必做所有这些事情：指针只是编译器与类型相关联的数字；如果您希望数字为 0，请分配 0。

哦，回答另一个问题，这与语言无关，只是你不一定知道位置 0 中的内容。我们在早期的 BSD 代码上遇到了很多麻烦，因为在早期的 BSD unices, *0 == 0 是可靠的。所以人们会写这样的东西

```
while(*c) doSomething(); 
```

因为当他们取消引用字符串末尾的 0x00 时，它会查看具有 VALUE 0 的 LOCATION 0。不幸的是，在其他平台上不一定如此。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-16T17:45:38.370

我真的怀疑在标准 C99 中有没有办法做到这一点。在标准 C++ 中，一旦创建对象，如果可以创建它，就很难引用它，因为取消引用空指针常量是未定义的，并且指针常量中的常量整数 0 是空指针常量。（是的，您可以尝试`int i; i = 0; foo * p = reinterpret_cast<foo *>i; p->doSomething();`，但标准没有指定 reinterpret_cast<> 的作用，除了以模糊和依赖于实现的方式。）

所以，我的下一个问题是你想在这里完成什么。如果您试图以奇怪而有趣的方式扭曲语言，那么根据标准，它不会以那种方式扭曲。如果您对此有合法用途，那会是什么？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-16T18:08:22.143

我认为您已经很接近了，只需一步指针间接即可。

从您的代码示例来看，无需获取`foo`. 您可以通过创建一个分配和实例化`bar`.

所以而不是：

```
DECL(foo);

int * bar = &foo; 
```

你可以有：

```
#define FOO_IS_NULL 0

int * getFoo() 
{  
    if( FOO_IS_NULL )
    {
        return 0;
    }

    int *tmp = malloc(sizeof(int));
    *tmp = 1234;
    return tmp;
}

int * bar = getFoo(); 
```

请注意，这完全摆脱了变量`foo`。

唯一需要注意的是，您现在需要`free(bar)`.

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-18T03:46:06.800

好吧，这就是我们所拥有的：

*   C++ 允许重载`operator&`并有模板为您完成工作，但不允许取消引用空指针。
*   C 允许取消引用空指针，只要之后获取地址。它还允许分配`void*`给任何指向对象的指针。

嗯，这是理想的。首先是C部分，这很容易。我不明白您不能将其嵌入宏的观点。这对我来说可以。

```
#define foo_ (*(void*) 0) 
```

现在，C++ 部分。把这些东西放在 nullp.hpp 中：

```
struct nullp { 
    struct proxy { 
        template<typename T> operator T*() { 
            return 0; 
        } 
    }; 

    proxy operator&() { 
        return omg(); 
    } 
} foo; 
```

现在，我们需要做的就是把东西粘合在一起：

```
#ifdef __cplusplus
#include "nullp.hpp"
#else
#define foo (*(void*) 0)
#endif 
```

现在，您可以使用`&foo`它并将其分配给指向某些对象类型的指针。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-19T06:33:18.063

听着，我很抱歉，但你让这既太难又太复杂了。

如果你想在 C 中调用这个东西，你需要一个指向函数的指针。所以，例如，你有

```
/* ptr to 0-ary function returning int */
int (*func)() = NULL ;    /* That's all you need. */

// elsewhere ....
int myfunc() { /* do a good thing */ }
func = myfunc ;       /* function name *is* its address */ 
```

现在，在以后的代码中你可以做

```
if(!func) 
    (*func)();
else
    /* function not defined */ 
```

您不需要弄乱加载程序，并且您不需要 --- 也不应该使用 --- 任何 zippy 宏，除非您*真的* 有充分的理由这样做*。*这都是标准C。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2009-01-16T17:50:03.477

如果您使用的是 C++，则可以使用引用：

```
int *foo = 0;
int &bar = *foo;
int *foo_addr = &bar; // gives NULL 
```

# sql-server-2005 - 没有完整 SQL Server 的 Sql Server 报告服务

> ID：451132
> 
> 赞同：1
> 
> 时间：2009-01-16T16:52:26.260
> 
> 标签：sql-server-2005

我将使用 SSRS 为我的网站生成报告。
场景：
我有 2 台服务器，应用程序服务器和数据库服务器。我想让报告（.rdl 文件）坐在应用程序服务器（IIS）上访问 SQL 服务器（数据库服务器）上的数据

为了满足这些要求，我需要在我的应用程序服务器上安装 SQL server 2k5，只是为了拥有 SQL server 报告服务。因此，我只是通过在应用程序服务器上安装 SQL Server 的许可证之一。

有谁知道如何只使用 SQL Server 2k5 安装报告服务？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-16T17:20:41.803

为了在您的应用程序服务器上安装 Reporting Services，您必须使用 SQL 许可证。您可以只安装 SQL Server 的 Reporting Services 部分，但它在技术上仍然是 SQL Server 应用程序的一部分，并且需要在该处理器上使用的许可证。

如果这是一个大问题，那么我将不得不建议将 Reporting Services 部分与数据服务器上的其余数据库安装一起安装。

[http://www.microsoft.com/sql/prodinfo/previousversions/rs/howtolicensers.mspx](http://www.microsoft.com/sql/prodinfo/previousversions/rs/howtolicensers.mspx)
*SQL Server 2000 Reporting Services 的服务器组件包括报表服务器和报表服务器数据库。报表服务器处理和呈现报表，并处理计划事件和报表传递。报表服务器数据库存储报表定义、报表元数据、订阅信息等。每个报表服务器都需要到报表服务器数据库的本地或远程连接。**要使用这些组件中的任何一个，安装了报表服务器和报表服务器数据库的每台计算机都必须具有有效的 SQL Server 2000 许可证。***

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-08-19T22:34:24.257

您可以在应用程序服务器上安装 SQL Server Express。
它是免费的，而且[Reporting Services 附带一个版本](http://www.microsoft.com/express/Database/InstallOptions.aspx)。
与“真正的”版本相比，SQL Server Express Edition 在它可以使用多少 CPU 和 RAM 方面受到限制，但它可能足够快来运行您的报告。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-01-16T17:31:25.993

公然不正确。您不需要 SQL Server 许可证即可使用 SQL Server Reporting Services，您可以使用 SQL Server Express 版本。除了链接服务器之外，我还使用 SQL Server Express Edition 来查询 -ANY- 数据库服务器上的内容。而且效果很好。

SSRS 是一个很棒的平台，我只是讨厌人们跑来跑去说你需要一个许可证才能使用它。我敢打赌那家伙为甲骨文公司工作！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-16T18:22:33.397

你确实有替代方案。您可以将报告直接嵌入到 .Net 中的代码项目中。在这种情况下，报表通过 Microsoft.Reporting.WinForms 和 Microsoft.Reporting.WebForms 命名空间、ReportViewer 对象运行。尽管这两种文件类型实际上是等效的，但每个报告都将具有“.rdlc”扩展名而不是“.rdl”。ReportViewer 有一个 ASP.Net 版本，可让您将这些报告集成到您的网站中。您只需将 ReportViewer 控件从工具箱拖到您的网站中即可对其进行配置。[有关详细信息，请参阅ReportViewer 控件](http://msdn.microsoft.com/en-us/library/ms251671(VS.80).aspx)的 MSDN 概述。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-03T19:51:53.173

如果您不想使用整个许可证，您可以随时使用 reportviewer。只是为了不在这里给出太多答案，这个大网站是gotreportviewer.com。

在生成报告时，reportviewer 控件执行 Reporting Services 服务器的工作。RDL 文件就像 xml 文件，在它们被解释之前不会做太多事情。如果您在 Web 上的应用程序中嵌入报表查看器，则工作将在用户端完成。它类似于微软的 xps 格式，它必须被解释。

如果您不想为您的报告创建应用程序，带有高级控件的新版本 sql2008 允许您安装免费版本的报告服务。它没有所有的好东西，但它适用于简单的部署。

# ruby-on-rails - 如何为 Rails 中的每条路线添加一些内容？

> ID：451138
> 
> 赞同：2
> 
> 时间：2009-01-16T16:53:31.437
> 
> 标签：ruby-on-rails, rails-routing

鉴于我已经指定了相当多的资源并且不想全部重构到命名空间中，是否有一种简单的方法可以将永久字符串添加到Rails 应用程序中的*每个路由？*

我可以做一些类似的事情吗

```
map.root 'myappnamehere' 
```

并将该字符串附加到所有路由的开头吗？我意识到这不是我正常实现 map.root 的方式。

TIA

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-16T17:42:41.417

[路径前缀](http://api.rubyonrails.org/classes/ActionController/Resources.html)？

# version - openssl-2 和 openssl-3 的区别

> ID：451140
> 
> 赞同：0
> 
> 时间：2009-01-16T16:53:39.613
> 
> 标签：version, openssl

对此很陌生。

你怎么知道openssl版本是什么，有什么区别？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-16T17:05:15.347

[在OpenSSL 网页](http://openssl.org/)上查找当前的[OpenSSL](http://openssl.org/)版本（截至 2009 年 3 月 25 日为 0.9.8k 和 1.0.0，截至 2009 年 7 月 15 日的第三个测试版）。OpenSSL 是[TLS](http://en.wikipedia.org/wiki/Transport_Layer_Security)加密协议套件（除其他外）的实现。

# html - 您是否知道列出所有字体系列及其在网络上很好的后备的资源？

> ID：451142
> 
> 赞同：4
> 
> 时间：2009-01-16T16:53:47.757
> 
> 标签：html, css, fonts

注意：我在这里做了一些编辑，因为我第一次没有很好地理解我的问题。

* * *

**更新**：在对这个主题进行了一些我自己的研究之后，我想出了一个完美的例子来说明为什么我要寻找具有后备功能的完美字体系列列表：[http ://www.brownbatterystudios.com /sixthings/2007/03/14/lucida-hybrid-the-grande-alternative/](http://www.brownbatterystudios.com/sixthings/2007/03/14/lucida-hybrid-the-grande-alternative/)

```
body {
font-family: "Lucida Sans Unicode", "Lucida Grande", Verdana, Arial, Helvetica, sans-serif; 
}
strong, em, b, i {
font-family: "Lucida Sans", "Lucida Sans Unicode", "Lucida Grande", Verdana, Arial, Helvetica, sans-serif;
} 
```

我怀疑其他人已经完成了这样的详细清单，而不是我再做一遍，我很想利用别人的辛勤工作。如果没有其他人这样做，那么我会继续自己开始吗？

* * *

我知道如何搜索网络安全字体，以及如何包含不同浏览器类型的回退以接近我想要的字体，我们之前都做过很多次。但是，我曾经看到一个示例，其中有人在样式表中保存了所有后备列表，而您需要做的就是注释掉您不使用的那些。

该列表似乎包含任何人都想使用的大多数字体，而不是每次都在网上不断搜索以创建我自己的列表，我想知道是否有其他人知道这个或任何其他字体列表后备？

例子：

```
body {
font-family:Arial,Helvetica,"Bitstream Vera Sans",sans-serif;
/* 
font-family:"Trebuchet MS","Bitstream Vera Sans",Verdana,Arial,Helvetica,sans-serif;
font-family:Consolas,Monaco,Liberation Mono,Lucida Console;
...
*/
} 
```

在我上面的例子中，你会看到 font-family:Consolas,Monaco,Liberation Mono,Lucida Console；（从 SO 的样式表中获取）并且到目前为止列出的任何资源都不会导致我建立那个后备家庭。摩纳哥和康索拉斯相似吗？对于主要想要 Consolas 的人来说，这是一个很好的后备清单吗？如果是，那么我希望将其添加到我的可接受字体系列列表中......

干杯，
史蒂夫

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-17T03:14:38.440

我今天刚刚为 SitePoint 的[8 个权威字体堆栈](http://www.sitepoint.com/article/eight-definitive-font-stacks/)添加了书签，并计划将这些合并到未来的项目中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-16T17:11:03.023

我使用[fonttester](http://www.fonttester.com/)来测试和尝试网络安全字体组合

**编辑：** 在 fonttester 中，如果你问“Trebuchet”，你会得到：

```
font-family: 'Trebuchet MS', Helvetica, sans-serif; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-17T03:47:00.417

这是[另一篇关于字体堆栈](http://unitinteractive.com/blog/2008/06/26/better-css-font-stacks/)的博客文章，它也是一篇好文章。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-16T16:56:28.250

一个很好的搜索词是网络安全字体：

[http://dustinbrewer.com/fonts-on-the-web-and-a-list-of-web-safe-fonts/](http://dustinbrewer.com/fonts-on-the-web-and-a-list-of-web-safe-fonts/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-16T17:20:05.097

我一直用这个：

[默认 Mac 和 Windows XP 字体](http://blog.bankcreative.com/index.php?/archives/6-Default-Mac-and-Windows-XP-fonts.html)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-16T17:25:08.067

我[对所有版本的 Windows 和 Mac 等效字体（浏览器安全字体）使用通用字体](http://www.ampsoft.net/webdesign-l/WindowsMacFonts.html)，这似乎与[Diodeus 的答案](https://stackoverflow.com/questions/451142/do-you-know-of-a-resource-that-lists-all-the-font-families-that-are-good-on-web#451258)非常相似......

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-16T17:40:30.907

[TypeTester](http://www.typetester.org/)是一个比较字体设置并将字体分为安全列表、Win 默认、Mac 默认和 Vista 字体的工具。您还可以使用它来测试行距、对齐、字间距等，设置基本字体大小并导出 CSS。

# nhibernate - 是否可以为 Fluent NHibernate Automapping 使用私有字段约定？

> ID：451159
> 
> 赞同：4
> 
> 时间：2009-01-16T16:56:40.153
> 
> 标签：nhibernate, fluent-nhibernate, nhibernate-mapping, automapping

如何使用流畅的 NHibernate AutoPersistenceModel 映射到私有字段？

```
 public class A
    {
        private List<B>  myField;

        public A()
        {
            myField = new List<B>();
        }

        public IList<B> MyBs
        {
            get { return myField; }
        }
    } 
```

AutoPersistence 模型是否有字段约定，或者我是否必须为具有字段的类使用单独的映射？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-05T19:40:17.630

答案：

这还不可能。也许我应该为它提交一个补丁......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-03-01T18:43:25.720

我知道这不是不回答自动映射，而是帮助那些得到这个搜索私有字段映射的人。

您现在可以使用以下代码：

```
public class A
{
    private List<B>  myBs;

    public A()
    {
        myField = new List<B>();
    }

    public IList<B> MyBs
    {
        get { return myField; }
    }
} 
```

像这样的映射

```
public class AMap : ClassMap<A> {
        public AMap() {
            HasMany(x => x.MyBs).Access.CamelCaseField()
        }
} 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-10-21T10:11:02.873

自从提出这个问题以来已经有一段时间了，但是如果其他人发现这个问题，可能值得发布这个答案。

Fluent NHibernate Wiki 提供了一些关于 3 种可能的解决方法的信息。

[http://wiki.fluentnhibernate.org/Fluent_mapping_private_properties](http://wiki.fluentnhibernate.org/Fluent_mapping_private_properties)

# asp.net - 在处理过程中存储用户名/密码

> ID：451167
> 
> 赞同：4
> 
> 时间：2009-01-16T16:58:19.867
> 
> 标签：asp.net, security, application-security

在 ASP.NET 应用程序的上下文中工作，我正在创建一个页面，该页面将能够针对我们环境中的许多数据库之一执行数据库脚本。为此，我们需要提示用户输入用户名/密码组合，该值可用于所有服务器而不会出现问题。

问题是存储这些信息的最安全位置在哪里？我们需要暂时存储它，因为当他们在这个特定页面上时，他们可能会在多个回发中执行数百个脚本。据我所知，我有 3 个选项，但我不确定哪个是最好的。以下是我对选项的看法，这里的每个人都有什么建议？什么是最安全的，同时仍然对用户友好？

**在 Viewstate 中存储信息**

我们讨论的第一个想法是在页面的 ViewState 中由用户提供信息后存储信息。这很有帮助，因为信息只在页面的生命周期内存在，但是，我们不确定安全隐患。

**在 Session 中存储信息**

我们的下一个想法是将它存储在会话中，但是，这样做的缺点是信息可以提供给应用程序内的其他页面，并且信息总是在服务器的内存中徘徊。

**在应用程序中存储信息**

我们的最后一个想法是将其存储在应用程序缓存中，并带有用户特定的密钥和 5 分钟的滑动到期时间。这仍然对其他页面可用，但是，它将确保信息在较短的时间内被缓存。

**为什么？**

最后一个重要的问题是“你为什么要这样做？”。我们为什么不直接使用他们的 Lan id 呢？好吧，由于缺乏对委派的网络支持，我们不能使用 lan id。

S0 推荐的解决方案是什么？为什么？它有多安全，我们能做到吗？

*更新*

已经讨论了重要的信息。澄清一下，我们在 Intranet 环境中运行，由于网络的限制，我们不能使用模拟或委托。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-16T17:07:42.440

在我看来，这个自然的地方是会议。

我不确定为什么您似乎害怕“应用程序中的其他页面”（您控制应用程序，不是吗？），但如果您真的是，您可以在存储之前使用某种加密。

但是，如果您要这样做*，*数据也可以存在于 ViewState 中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-16T17:15:22.440

我不喜欢这些想法中的任何一个，但**完全讨厌 viewstate 想法**。

我不知道您要附加多少个数据库，但如果数量有限，我想知道是否以标准安全方式处理您的身份验证和授权，然后**使用身份模拟通过集成安全性**连接到这些数据库具有最小权限的帐户。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-16T17:04:42.663

该`ViewState`方法很好，但存在您将用户名和密码提供给客户端的问题。即使你加密它，如果某些攻击者拥有加密密钥，情况也不会很好。

关于`Session`and`Application`方法，我认为`Application`方法没有意义。数据是用户特定的，所以`Session`应该是要走的路。一旦用户的会话关闭，它就会消失。顺便说一句，如果您选择将其存储在服务器上，请使用`SecureString`class.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-16T17:40:00.783

正如 John MacIntyre 所写，您应该为此使用集成的安全性和模拟。

如果由于某种原因您不能使用它并且您将提供自己的登录页面，请务必使用 SSL 来加密浏览器和您的服务器之间的流量。如果不使用 SSL，使用 ViewState 方法也是完全不安全的，有一些工具可以非常轻松地查看内容。从您列举的方法中，最好的方法是使用会话状态。您可以从 Web 服务器内存中卸载保存会话状态的工作，并将[该数据保存在数据库](http://msdn.microsoft.com/en-us/library/ms178201.aspx)中，您可以按照您想要的方式保护它。如果您不喜欢这些工作方式，您甚至可以编写自己的[会话状态提供程序](http://msdn.microsoft.com/en-us/library/ms178589.aspx)并在那里应用您需要的安全性。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-16T17:19:57.763

存储在 Viewstate 中会增加您的曝光率，因为密码会一次又一次地在互联网上传播。加密是否足以解决此风险取决于您。

使用 Application 或 Session 都将密码保存在服务器中。如上所述，SecureString 将防止人们简单地从内存中读取密码。会话将扩展到更多用户，并且可能比应用程序更容易扩展到多个服务器。除非您确定您永远不会使用超过 1 个 Web 服务器，否则我不会使用 Application，因为同步所有服务器将取决于您。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-16T20:29:45.713

永远不要存储密码！

而是存储密码的哈希值。请参阅：[http](http://en.wikipedia.org/wiki/Crypt_(Unix)#Library_Function) ://en.wikipedia.org/wiki/Crypt_(Unix)#Library_Function 。

我知道这并不能回答问题，但是越多的程序员忽视这个建议，犯罪分子就越容易窃取数据。不要让您的组织成为新闻故事。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-12-27T06:54:09.303

用户名/密码真的不应该存储在任何地方。

您存储实时数据库连接，最好来自 Session 对象中的池。只要登录数据库，您只需要用户名/密码。

虽然另一个页面可以使用实时连接，但它不会像存储用户名/密码那样让其他任何人永久访问数据库。

# web-services - 任何支持 NTLM2 的 Web 服务测试免费工具？

> ID：451170
> 
> 赞同：0
> 
> 时间：2009-01-16T16:58:30.787
> 
> 标签：web-services, testing, automation

哪些工具是免费工具，可用于测试 NTLM2 身份验证背后的 Web 服务。

SoapUI 是具有我需要的所有功能的优秀工具，但是它不支持 NTLMv2。如果有人有办法使这项工作，请提供解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-16T17:00:41.143

抛出一个自定义的 Web 服务测试应用程序应该是一件非常简单的事情......

# java - 在不使用 final 的情况下停止继承

> ID：451182
> 
> 赞同：8
> 
> 时间：2009-01-16T17:00:43.577
> 
> 标签：java, inheritance

除了将类声明为 final 或将其构造函数声明为私有之外，还有其他方法可以停止类的继承吗？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-01-16T17:02:49.843

一条评论

```
//Do not inherit please 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-01-16T17:12:18.763

还有两个选择：

*   使每个方法最终，所以人们不能覆盖它们。这样可以避免从子类中意外调用方法。但这并没有停止子类化。

*   将检查放入类的构造函数中：

    ```
    if (this.getClass() != MyClass.class) {
        throw new RuntimeException("Subclasses not allowed");
    } 
    ```

    那么没有人将能够实例化你的类的子类。

（不是我建议使用这些技术，只是我想到了。我会使用最终类和/或私有构造函数）

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-01-16T17:22:18.743

*   使用最终
*   使用私有构造函数
*   使用评论：

    ```
    // do not inherit 
    ```

*   使用 javadoc 注释

*   使每个方法都成为最终方法，这样人们就无法覆盖它们
*   在类构造函数中使用运行时检查：

    ```
    if (this.getClass() != MyClass.class) {
        throw new RuntimeException("Subclasses not allowed");
    } 
    ```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-01-16T17:04:49.217

Final 就是为了解决这个问题而创建的。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-16T17:13:06.437

使用`final`是规范的方式。

```
public final class FinalClass {
  // Class definition
} 
```

如果你想防止个别方法被覆盖，你可以将它们声明为 final。（我只是在这里猜测，你为什么*要*避免让整个班级进入决赛。）

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-01-17T03:40:35.017

将您的构造函数设为私有并提供工厂函数来创建实例。

当您想从多个实现中选择一个合适的实现但又不想允许任意子类化时，这会特别有用，如

```
abstract class Matrix {
   public static Matrix fromDoubleArray(double[][] elemens) {
     if (isSparse(elements)) {
      return new SparseMatrix(elements);
    } else {
      return new DenseMatrix(elements);
    }
  }
  private Matrix() { ... }  // Even though it's private, inner sub-classes can still use it
  private static class SparseMatrix extends Matrix { ... }
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-16T17:09:37.660

我不得不说它通常是糟糕的形式。尽管几乎总是存在某些有效的情况，但我不得不说在 OO 世界中停止继承通常不是一个好主意。[在此处](http://codebetter.com/blogs/jeremy.miller/archive/2008/05/28/the-open-closed-principle-on-msdn.aspx)阅读开[闭原则](http://en.wikipedia.org/wiki/Open/closed_principle)。保护您的功能，但不要让进来并支持它的人成为不可能...

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-12-22T14:20:52.490

在不使用最终类的情况下，您基本上可以将所有构造函数设为私有：

```
public class A {
    private A() {} //Overriding default constructor of Java
} 
```

尽管通过禁止创建此类的对象也会使此类抽象化，但是由于构造函数中的任何继承都需要`super();`，并且由于构造函数是私有的，因此编译错误将是尝试继承时可以获得的最大错误那堂课。但是，我建议使用 final 代替，因为它的代码更少并且包括创建对象的选项。

# mysql - mod_rewrite，.htaccess 连接到 mysql 数据库

> ID：451214
> 
> 赞同：3
> 
> 时间：2009-01-16T17:08:55.417
> 
> 标签：mysql, apache, .htaccess, mod-rewrite

我希望 .htaccess 文件中的 mod_rewrite 链接到 mysql 数据库，以便为我提供映射信息。

具体来说，我使用单个代码库来托管多个站点，因此..如果用户请求图像，例如： [http ://www.example.com/images/car.jpg](http://www.example.com/images/car.jpg)

这将访问我的服务器，许多其他站点也将访问该 /images 文件夹，因此我需要 Apache 回复：/home/example/pubic_html/images/7383/car.jpg

请注意“7383”的注入，这是该用户的示例站点 ID。

基本上，我想使用 mysql 数据库在 example.com 和 7383 之间进行映射，然后将正确的文件提供给用户。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-16T17:12:42.600

您可以使用脚本作为[重写映射](http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html#rewritemap)来获取真实路径。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-16T23:57:43.233

RewriteMap 是要使用的正确 Apache 功能。谢谢秋葵。

在我完成此工作时需要注意的事项：

*   RewriteMap 在您的 Apache 配置中而不是在 .htaccess 文件中
*   我编写了一个脚本来构建一个映射文本文件，该文件将执行我上面的映射。它基本上会从数据库中转储任何必要的内容——因为我的并不是每分钟都在更改，所以只要添加或更改映射，我就可以定期将转储运行到此文本文件中。

像冠军一样工作。感谢 Apache 提供了这么棒的工具。

# perl - 如何绕过无法修改的 Perl 库中的“死”调用？

> ID：451227
> 
> 赞同：34
> 
> 时间：2009-01-16T17:11:33.633
> 
> 标签：perl, error-handling, die

是的，问题出在我正在使用的库上，不，我无法修改它。我需要一个解决方法。

基本上，我正在处理一个写得很糟糕的 Perl 库，当在读取文件时遇到某种错误情况时，它会以“die”退出。我从一个循环数千个文件的程序中调用这个例程，其中少数文件是坏的。坏文件发生；我只想让我的例程记录错误并继续前进。

如果我可以修改库，我只需更改

```
die "error"; 
```

到一个

```
print "error";return; 
```

， 但是我不能。有什么办法可以让我编写例程，这样坏文件就不会导致整个过程崩溃？

后续问题：使用“eval”来处理容易崩溃的调用效果很好，但我如何设置处理该框架内的可捕获错误？来描述：

我有一个子例程调用库，它有时会崩溃很多次。我没有用 eval{} 来处理这个子例程中的每个调用，而是让它死掉，并在调用我的子例程的级别上使用 eval{}：

```
my $status=eval{function($param);};
unless($status){print $@; next;}; # print error and go to next file if function() fails 
```

但是，我可以并且确实在 function() 中捕获了一些错误情况。在子例程和调用例程中设计错误捕获的最合适/优雅的方法是什么，以便我获得捕获和未捕获错误的正确行为？

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2009-01-16T17:13:57.887

你可以把它包在一个`eval`. 看：

```
perldoc -f eval 
```

例如，你可以写：

```
# warn if routine calls die
eval { routine_might_die }; warn $@ if $@; 
```

这会将致命错误变成警告，这或多或少是您所建议的。如果`die`被调用，则`$@`包含传递给它的字符串。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-01-16T18:27:05.400

它会陷阱`$SIG{__DIE__}`吗？如果是这样，那么它比你更本地化。但是有几个策略：

*   您可以调用它的包并[覆盖](http://perldoc.perl.org/perlsub.html#Overriding-Built-in-Functions)die：

    ```
    package Library::Dumb::Dyer;
    use subs 'die';
    sub die {
        my ( $package, $file, $line ) = caller();
        unless ( $decider->decide( $file, $package, $line ) eq 'DUMB' ) {
            say "It's a good death.";
            die @_;
       }
    } 
    ```

*   如果没有，可以[捕获](http://perldoc.perl.org/perlvar.html)它。（在页面上查找 $SIG，markdown 没有处理完整的链接。）

    ```
    my $old_die_handler = $SIG{__DIE__};
    sub _death_handler { 
        my ( $package, $file, $line ) = caller();
        unless ( $decider->decide( $file, $package, $line ) eq 'DUMB DIE' ) {
            say "It's a good death.";
            goto &$old_die_handler;
        }
    }
    $SIG{__DIE__} = \&_death_handler; 
    ```

*   您可能必须扫描库，找到它*始终*`$SIG`调用的子程序，然后通过覆盖来使用它来加载您的处理程序`that`。

    ```
    my $dumb_package_do_something_dumb = \&Dumb::do_something_dumb;
    *Dumb::do_something_dumb = sub { 
        $SIG{__DIE__} = ...
        goto &$dumb_package_do_something_dumb;
    }; 
    ```

*   或者覆盖一个它*总是*调用的内置函数......

    ```
    package Dumb; 
    use subs 'chdir';
    sub chdir { 
        $SIG{__DIE__} = ...
        CORE::chdir @_;
    }; 
    ```

*   如果一切都失败了，你可以用这个鞭打马的眼睛：

    ```
    package CORE::GLOBAL;
    use subs 'die';

    sub die { 
        ... 
        CORE::die @_;
    } 
    ```

这将覆盖*die*全局，您可以返回的唯一方法`die`是将其寻址为`CORE::die`.

这些的一些组合将起作用。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2010-01-27T08:46:49.703

尽管将 a 更改`die`为 not die 有一个特定的解决方案，如其他答案所示，但通常您始终可以覆盖其他包中的子例程。您根本不会更改原始来源。

首先，加载原始包，以便获得所有原始定义。一旦原件到位，您可以重新定义麻烦的子程序：

```
 BEGIN {
      use Original::Lib;

      no warnings 'redefine';

      sub Original::Lib::some_sub { ... }
      } 
```

您甚至可以剪切和粘贴原始定义并调整您需要的内容。这不是一个很好的解决方案，但如果您无法更改原始来源（或想在更改原始来源之前尝试一些东西），它可以工作。

除此之外，您可以将原始源文件复制到应用程序的单独目录中。由于您控制该目录，因此您可以编辑其中的文件。您可以通过将该目录添加到 Perl 的模块搜索路径来修改该副本并加载它：

```
use lib qw(/that/new/directory);
use Original::Lib;  # should find the one in /that/new/directory 
```

即使有人更新了原始模块，您的副本也会保留（尽管您可能必须合并更改）。

[我在Mastering Perl](http://oreilly.com/catalog/9780596527242)中对此进行了相当多的讨论，在那里我展示了一些其他技术来做这类事情。诀窍是不要破坏更多的东西。你如何不破坏东西取决于你在做什么。

# .net - 如何将输入发送到控制台，就像用户正在打字一样？

> ID：451228
> 
> 赞同：7
> 
> 时间：2009-01-16T17:12:12.587
> 
> 标签：.net, automation, cmd, stdin

这是我的问题。我有一个必须在 TTY 中运行的程序，cygwin 提供了这个 TTY。当我重定向 stdIn 时，程序失败，因为它没有 TTY。我不能修改这个程序，需要一些自动化的方法。

**如何获取 cmd.exe 窗口并向其发送数据并使其认为用户正在键入它？**

我正在使用 C#，我相信有一种方法可以使用 java.awt.Robot 来做到这一点，但出于其他原因我必须使用 C#。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-16T21:00:45.213

我已经弄清楚如何将输入发送到控制台。我使用了 Jon Skeet 所说的。我不是 100% 确定这是实现这一点的正确方法。

如果有任何意见可以使这更好，我很乐意在这里。我这样做只是为了看看我能不能弄清楚。

这是我盯着的等待用户输入的程序

```
class Program
{
    static void Main(string[] args)
    {
        // This is needed to wait for the other process to wire up.
        System.Threading.Thread.Sleep(2000);

        Console.WriteLine("Enter Pharse: ");

        string pharse = Console.ReadLine();

        Console.WriteLine("The password is '{0}'", pharse);

        Console.WriteLine("Press any key to exit. . .");
        string lastLine = Console.ReadLine();

        Console.WriteLine("Last Line is: '{0}'", lastLine);
    }
} 
```

这是控制台应用程序写入另一个

```
class Program
{
    static void Main(string[] args)
    {
        // Find the path of the Console to start
        string readFilePath = System.IO.Path.GetFullPath(@"..\..\..\ReadingConsole\bin\Debug\ReadingConsole.exe");

        ProcessStartInfo startInfo = new ProcessStartInfo(readFilePath);

        startInfo.RedirectStandardOutput = true;
        startInfo.RedirectStandardInput = true;
        startInfo.WindowStyle = ProcessWindowStyle.Hidden;
        startInfo.CreateNoWindow = true;
        startInfo.UseShellExecute = false;

        Process readProcess = new Process();
        readProcess.StartInfo = startInfo;

        // This is the key to send data to the server that I found
        readProcess.OutputDataReceived += new DataReceivedEventHandler(readProcess_OutputDataReceived);

        // Start the process
        readProcess.Start();

        readProcess.BeginOutputReadLine();

        // Wait for other process to spin up
        System.Threading.Thread.Sleep(5000);

        // Send Hello World
        readProcess.StandardInput.WriteLine("Hello World");

        readProcess.StandardInput.WriteLine("Exit");

        readProcess.WaitForExit();
    }

    static void readProcess_OutputDataReceived(object sender, DataReceivedEventArgs e)
    {
        // Write what was sent in the event
        Console.WriteLine("Data Recieved at {1}: {0}", e.Data, DateTime.UtcNow.Ticks);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-16T17:14:21.363

您可以在代码中启动程序（或 cygwin），使用`ProcessStartInfo.RedirectStandardInput`（和输出/错误）来控制数据流吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-16T17:35:10.590

这听起来像是[`SendKeys()`](http://msdn.microsoft.com/en-us/library/8c6yea83(VS.85).aspx). 它不是 C#，而是 VBScript，但尽管如此 - 您要求*某种*自动化方法：

```
Set Shell = CreateObject("WScript.Shell")

Shell.Run "cmd.exe /k title RemoteControlShell"
WScript.Sleep 250

Shell.AppActivate "RemoteControlShell"
WScript.Sleep 250

Shell.SendKeys "dir{ENTER}" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-16T17:46:19.833

我前段时间遇到过类似的问题，cygwin 应该将一些有用的信息（确切的 cygwin 函数、错误文本和 WINAPI 错误代码）写入错误流，你应该将它重定向到某个地方并阅读它所写的内容。

# vb.net - 检查 DataGridView/BindSource 是否已更改数据

> ID：451247
> 
> 赞同：2
> 
> 时间：2009-01-16T17:17:09.690
> 
> 标签：vb.net, winforms, datagridview, bindingsource

我有一个带有 datagridview 和 bindingsource 的 WinForms 应用程序。我希望用户在将更改保存到数据库之前确认更改。

除非我知道用户进行了更改，否则我不想弹出确认对话框。所以我需要一种方法来检查是否进行了更改。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-16T17:20:30.650

您应该能够用来`BindingSource.ListChanged`进行粗略的测试 - 在事件触发时设置一个标志（一旦绑定完成，您可能必须清除该标志）。

但数据是什么？例如，LINQ-to-SQL 和 DataTable 都提供查询更改的方法...（`DataTable.GetChanges()`和`DataContext.GetChangeSet()`）。大多数基于 DAL 的机制通常也有办法做到这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-16T17:21:07.357

如果您（最终）绑定到数据表，则可以检查行状态是否已更改或已添加

# .net - 为什么我的 VB.NET 类库在 Reflector 中显示“My”和“My.Resources”命名空间？

> ID：451273
> 
> 赞同：7
> 
> 时间：2009-01-16T17:22:55.933
> 
> 标签：.net, vb.net, optimization, my-namespace

我无意在我的任何项目中使用“我的”。我没有用它做任何事情（据我所知）。但是每个类库都在 Reflector 和 NDepend 中显示了一个“我的”命名空间。这增加了很多不必要的混乱。

1）为什么会出现？

2）我怎样才能删除它？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-16T17:52:05.140

[删除“我的”命名空间的步骤](http://www.renevo.com/blogs/dotnet/archive/2009/01/16/removing-my-namespace-from-vb-net.aspx)

*   在项目属性中，关闭“启用应用程序框架”
*   在高级编译选项下，打开“启用优化”
*   显示项目中的所有文件
*   删除 Application.myapp 节点、Resources.resx 和 Settings.settings 节点。
*   卸载项目，在记事本中打开.vbproj，将<MyType>改为<MyType>Empty</MyType>
*   重新加载项目并编译。

对于资源，使用标准资源文件及其构造函数（我刚刚做了一个包装）。

对于设置，使用配置文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-16T17:42:52.117

“我的”是 Visual Studio 2005 for VB.Net 中添加的一项功能。该功能的目的是为用户提供更多他们习惯于使用 VB6 的 API 感觉。它包括许多最流行的函数和助手类。

这是一篇更详细的 MSDN 文章：http: [//msdn.microsoft.com/en-us/magazine/cc163972.aspx](http://msdn.microsoft.com/en-us/magazine/cc163972.aspx)

AFAIK，从 VS 2008 开始，无法在 VB.Net 中禁用此功能。

# .net - 为什么 .NET Framework v1.1.4322 文件夹中缺少“Microsoft.VisualBasic.Compatibility.dll”？

> ID：451274
> 
> 赞同：1
> 
> 时间：2009-01-16T17:23:14.903
> 
> 标签：.net, windows, vb.net, msbuild

我已经开始使用 Vista 机器进行开发。如果它很重要：我正在使用[MSBee](http://www.codeplex.com/MSBee)，以便我可以在 Visual Studio 2005 IDE 中进行编码，同时仍然针对 1.1 框架进行构建。

在 Vista 机器上，当我尝试构建一个特定的 vb 项目时，我得到了这个错误：

> 错误 BC30464：在项目级导入“Microsoft.VisualBasic.Compatibility”中找不到命名空间或类型“Compatibility”。

同样的项目在我的旧 XP 机器上构建得很好。

我在我的 Vista 机器上签入了这个文件夹：

```
C:\windows\microsoft.net\Framework\v1.1.4322 
```

...果然，“Microsoft.VisualBasic.Compatibility.dll”不见了。“Microsoft.VisualBasic.Compatibility.Data.dll”也是如此。将它们从我的 XP 机器复制到我的 Vista 机器使我能够成功构建项目。

**我只是有点疑惑*为什么*会这样**。为什么缺少“Microsoft.VisualBasic.Compatibility.dll”？我对我选择的解决方案也不是很满意——手动复制 DLL。它有效，但肯定有更好的方法。

至于配置：

远景：

*   .Net 框架 1.1
*   .Net 框架 1.1 SP1
*   .Net 框架 1.1 SDK
*   .Net 框架 1.0
*   .Net 框架 2.0
*   .Net 框架 3.0

经验：

*   .Net 框架 1.1
*   .Net 框架 1.1 SP1
*   .Net 框架 1.1 SDK
*   .Net 框架 1.0
*   .Net 框架 2.0

有谁知道这是什么原因造成的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-07-07T15:00:14.247

我知道这是较旧的，但想发布答案以供将来搜索。

由于它们仅用于升级 VB6 代码，因此 Microsoft.VisualBasic.Compatibility DLL 不与正常的 1.1 框架分发一起安装。它们是随 Visual Studio 一起安装的。由于您没有安装 VS 2003，因此没有安装 DLL。

安装 VS 2005 安装了 DLL，但适用于 2x 框架。

您也可以通过安装 1.1 SDK 来获取 DLL。

# sql-server-2005 - 如何配置链接服务器之间的身份验证？

> ID：451280
> 
> 赞同：4
> 
> 时间：2009-01-16T17:25:33.977
> 
> 标签：sql-server-2005, tsql, transactions, distributed-transactions

我正在尝试测试一个概念证明，即我可以在两个链接的 SQL Server 上运行分布式事务，使用 sp_addlinkedserver 链接 - 它们的名称是 Server1 和 Server2，两者都在默认实例下运行。每个服务器分别拥有一个数据库，Source 和 Destination，目标数据库拥有一个名为 Output 的表，即

```
Server1.Source
Server2.Destination.Output 
```

OUTPUT 表具有以下结构：

```
OUT_PKEY int identity(1,1) primary key,
OUT_TEXT nvarchar(255) 
```

在 Server1 中，我调用*sp_addlinkedserver 'Server2'*来链接两个数据库，并尝试运行以下查询来测试该链接是否确实有效：

```
Select   *
From     Server2.Destination.dbo.Output 
```

我返回以下异常：

> 对远程服务器的访问被拒绝，因为不存在登录映射。

很公平，所以我从 Server1 运行*sp_addlinkedsrvlogin 'Server2'*，根据文档，它应该获取远程运行查询的用户凭据（即来自 Server1）并将这些凭据应用于 Server2。这意味着由于我使用 Windows 身份验证连接到 Server1，这应该意味着我的 Windows 凭据也适用于 Server2。

现在异常消息变为：

> 用户“NT AUTHORITY\ANONYMOUS LOGON”登录失败。

在谷歌上搜索了这个异常后，我没有找到任何有用的东西来指引我正确的方向。我错过了什么？我希望 [如果登录失败] 异常引用*我的*Windows 凭据，*而不是*匿名登录凭据。

看起来一旦我让链接本身工作，分布式事务本身应该是一件相当简单的事情 - 文档暗示我只需要确保 DTC 服务在 Server1 上运行，并且任何查询都在 Server1 上运行，将被处理通过链接：

*   在初始化我的分布式事务之前包括*SET XACT_ABORT ON*
*   我使用*BEGIN DISTRIBUTED TRANSACTION*而不是*BEGIN TRANSACTION*
*   如果我希望在 Server2 上引用 SQL Server 的非默认实例，我将查询中名称*Server2的任何实例替换为**[Server2\InstanceName]*

我的问题是：

*   我该如何解决这个登录问题？单独的*sp_addlinkedsrvlogin*存储过程似乎并不能解决问题。
*   运行分布式事务真的像文档所暗示的那样简单吗？

TIA

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-16T18:14:03.663

如果您在域中，则设置应为“使用登录的当前安全上下文进行”，但还有一个步骤 - 您需要向事务中涉及的每个服务器授予 SPN。

假设您以域用户身份在两台服务器上运行 SQL 服务（您需要这样做 - LocalSystem 不会这样做），以下是您需要的说明：

[http://technet.microsoft.com/en-us/library/bb735885.aspx](http://technet.microsoft.com/en-us/library/bb735885.aspx)

请记住，用户将需要两个服务器的 SPN，而不是客户端 - 例如，如果您从客户端 -> 服务器 1 - > 服务器 2，SQL 服务帐户将需要服务器 1 和服务器 2 的 SPN。

如果您感到困惑（这是一个令人困惑的过程），请发表评论，我会澄清说明。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-16T17:59:00.727

假设这些服务器都在同一个域上 - 您是否启用了受信任的委派以允许您的服务器将凭据传递给目标服务器？您将提取服务器的 Active Directory 对象并转到“委派”选项卡并选择“仅信任此计算机以委派给指定的服务”，然后输入允许服务器将凭据传递到的 SQL Server 详细信息：

服务类型 = MSSQLSvc
用户/计算机 = YourTargetServer.Your.Domain
端口 = 1433

可悲的是，链接服务器的许多此类身份验证问题需要重新启动才能完全生效（因此，如果这些是生产服务器，则很难在白天进行故障排除）。

关于分布式事务-如果您最终使链接服务器连接正常运行，那么分布式事务就可以很好地工作。虽然一旦你开始工作，你可能会遇到的下一件事是发现一个**巨大的缺陷**，即你不能使用任何形式的 SCOPE_IDENTITY()、@@IDENTITY 等在将某些内容插入链接数据库后检索主键. 但这是另一个有趣的解决方法的问题......

# java - 在 Valgrind 下的 Sun VM 中运行 JNI 应用程序

> ID：451282
> 
> 赞同：4
> 
> 时间：2009-01-16T17:25:49.330
> 
> 标签：java, java-native-interface, valgrind

sun JVM 在 valgrind 下运行时会发出很多额外的噪音，这使得跟踪应用程序中的内存问题非常具有挑战性。

我想找到一个抑制文件或 VM 运行时模式，它可以去除虚假的内存错误，以便在这种情况下将小麦与谷壳分开。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-25T17:28:09.663

在 Java 应用程序之外分析这个本机代码怎么样？通常，JNI 代码是一些非 Java 特定库的包装器。不确定这是否适用于您的具体情况，但如果是这样，那么也许可以通过围绕该库编写一个普通的 C 或 C++ 测试框架来隔离内存问题？

如果您的框架使用 C++，那么您也可以提供自己的 new 和 delete 运算符并自己跟踪内存使用情况。您必须收集统计数据并使用一些脚本对其进行处理，但它可以很好地工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-28T23:23:52.063

我无法回答您发布的问题，但您能详细说明您遇到的问题吗？

换句话说，你能告诉我们是不是……

*   在 JNI 层而不是 JVM 对象范围问题？
*   使用空闲内存？
*   缓冲区覆盖/覆盖？
*   其他内存损坏？

我最近不得不调试一个有问题的 Java/C（在运行 30 多分钟后），结果证明它在释放后正在使用内存。我尝试使用 dmalloc，我的自定义内存泄漏库，Valgrind，但没有一个可以满足我的需要。

最终，我围绕 free、malloc、calloc、realloc 创建了一组简单的包装器，它们简单地将内存地址和大小打印到文件中。在它中止后（在 GDB 中），我可以及时回溯并找出内存何时被释放以及没有被删除的引用在哪里。

如果您的问题出在 C/C++ 中，并且您可以在调试器中捕获错误，这可能对您有用。是的，这很乏味，但可能不会比筛选数兆字节的 Valgrind 输出更糟糕。

希望有帮助，祝你好运。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-29T04:03:19.020

虽然不像 valgrind 那样漂亮（根据我读过的内容），但您可以尝试 jmap 和 jhat。这些工具允许您拍摄正在运行的进程的快照并查看正在发生的事情。我已经将这种技术用于简单的内存泄漏，并且效果很好。但是，如果内存问题是由非 jvm 分配引起的，这将无济于事。

# algorithm - 将路径名转换为唯一编号的算法

> ID：451285
> 
> 赞同：2
> 
> 时间：2009-01-16T17:27:48.857
> 
> 标签：algorithm, path

我想将 Windows 路径名转换为唯一整数。

例如：

对于路径名 C:\temp\a.out，如果我添加所有字符的 ascii 值，我得到 1234。但其他一些路径也可以生成相同的数字。那么，为不同的路径名生成唯一编号的最佳方法是什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-16T17:30:13.377

查看[哈希函数](http://en.wikipedia.org/wiki/Hash_function)。确保在执行散列时考虑大多数 Windows 文件名不区分大小写的特性。

最有可能的是，您使用的语言提供了一个库函数（或函数集合），它可以获取字符串（或只是数据）的哈希值。 [SHA1](http://en.wikipedia.org/wiki/Sha1)很受欢迎，并且碰撞率低。

在 Stackoverflow 上有很多关于哈希函数的问题。为了让您开始，只需搜索“[散列函数](https://stackoverflow.com/search?q=hash+function)”。对于您的情况，这可能是一个有用的 SO 问题：[什么是高性能字符串散列函数，可以产生低冲突率的 32 位整数？](https://stackoverflow.com/questions/114085/what-is-a-performant-string-hashing-function-that-results-in-a-32-bit-integer-wit).

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-16T17:30:22.330

可能的路径名比整数多，因此您不能拥有真正的唯一性。你可以接受像 MD5 哈希这样的东西。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-16T17:31:14.560

[完美的散列](http://en.wikipedia.org/wiki/Perfect_hash_function)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-16T17:32:08.833

是的，您需要使用某种散列函数，因为输入的域大于输出的范围。换句话说，几乎可以肯定，有效路径名比目标语言数据类型中可表示的数字多。

所以不可能*完全*避免碰撞。如果此保证对您的应用程序至关重要，您将无法通过转换为整数来实现。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-16T18:20:29.610

像这样的事情怎么样：为每个目录级别使用（字符串-> n 位）的哈希值。为 10 个目录级别中的每一个分配 20 位显然不会扩展，但可能是可伸缩级别的位，假设最低的目录级别将是最多的 -

例如，如果你有（从根）/A/B/C/D/E/F，输出某种 n 位数字，其中

位 n/2 - n 散列 F

位 n/4 - n/2 位散列 E

n/8 - n/4 位散列 D

等等等等

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-16T17:50:26.173

如果这是在 Unix 上，你可以抓住它的 inode 号。ls -i 在命令行上显示它。[stat()](http://linux.about.com/library/cmd/blcmdl2_stat.htm)命令允许您从程序中检索它。

软链接将显示为同一个文件，而硬链接将显示为不同的文件。这可能是也可能不是您想要的行为。

我看到很多人在谈论哈希。这*可能*有效，但理论上，如果您的哈希所做的不仅仅是压缩文件名中不允许的整数值，那么您*可能*会发生冲突。如果这对您来说是不可接受的，那么您的哈希值总是几乎与文件名一样多。此时，您不妨只使用文件名。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-16T18:06:19.823

对于所有人说“这是不可能的，因为你有比整数更多的可能路径来存储它们”：不。张贴者从未指定实现语言；一些语言支持任意长度的整数。以 Python 为例。

假设我们将 32,000 个字符路径作为其他评论之一中提到的限制。如果我们有 256 个不同的字符用于路径，我们会得到：

```
Python 2.5.1 (r251:54863, May 18 2007, 16:56:43)
[GCC 3.4.4 (cygming special, gdc 0.12, using dmd 0.125)] on cygwin
Type "help", "copyright", "credits" or "license" for more information.
>>> 32000L**256L
20815864389328798163850480654728171077230524494533409610638224700807216119346720596024478883464648369684843227908562015582767132496646929816279813211354641525848259018778440691546366699323167100945918841095379622423387354295096957733925002768876520583464697770622321657076833170056511209332449663781837603694136444406281042053396870977465916057756101739472373801429441421111406337458176000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000L
>>> 
```

请注意 Python 是如何表示它的？是的，可能有更好的方法来做到这一点，但这并不意味着它是不可能的。

**编辑：** rjack 指出它实际上是 256^32000，而不是相反。Python 仍然可以很好地处理它。性能可能会有一些不足之处，但说它在数学上不可能是错误的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-16T18:22:09.497

> [吉米说](https://stackoverflow.com/questions/451285/algorithm-to-convert-pathname-to-unique-number#451294)
> 
> > 可能的路径名比整数多，因此您不能拥有真正的唯一性。你可以接受像 MD5 哈希这样的东西。

我认为没有比整数更多的可能路径名。作为从路径名创建唯一数字的结构，我们可以将每个字母转换为（两位数）数字（所以从 10-25,26=.，然后是其他特殊字符，27 是 /——假设有少于 89 个不同的字符，否则，我们可以移动到三位编码）

```
home/nlucaroni/documents/cv.pdf
1724221427232130121027242318271324122827123136251315 
```

这形成了一个双射（虽然，如果你只计算有效的路径名，那么满射属性就会失败，但通常人们并不关心那个持有）——想出一个*不是*整数的路径。

这个数字显然不适合 64_bit unsigned int（最大值为 18446744073709551615），所以它不实用，但这不是我回答的重点。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-16T18:22:12.647

您可以在此处阅读[Best way to determine if two path reference to the same file in C#](https://stackoverflow.com/questions/410705/best-way-to-determine-if-two-path-reference-to-same-file-in-c#410794) how you can uniquely identify a path。您需要三个数字（dwVolumeSerialNumber、nFileIndexHigh 和 nFileIndexLow），也许您可​​以将这三个数字组合成一个具有三倍多位的新数字。另请参阅此处：[您最喜欢的 C# 扩展方法是什么？（codeplex.com/extensionoverflow）](https://stackoverflow.com/questions/271398/post-your-extension-goodies-for-c-net-codeplex-com-extensionoverflow#274652)。

# c# - 如何从 C# 应用程序显示 Windows 资源管理器上下文菜单？

> ID：451287
> 
> 赞同：17
> 
> 时间：2009-01-16T17:28:14.457
> 
> 标签：c#, contextmenu, explorer

我的应用程序中有一个文件列表，我希望允许人们右键单击一个项目并显示 Windows 资源管理器上下文菜单。我假设我需要使用 IContextMenu 接口，但我不确定从哪里开始。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-16T17:37:52.737

我写了一个库，也许可以帮助你。您可以使用库提供的控件，或者如果您不想这样做，查看代码可能会给您答案。

您可以在以下位置找到该库： http: [//gong-shell.sourceforge.net/](http://gong-shell.sourceforge.net/)

请让我知道这是否有帮助！

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-19T08:50:30.703

Raymond Chen 的博客上有一个非常好的教程（尽管是 C++），它分为 11 个部分（按顺序）：

1.  [初步尝试](https://devblogs.microsoft.com/oldnewthing/20040920-00/?p=37823)
2.  [显示上下文菜单](https://devblogs.microsoft.com/oldnewthing/20040922-00/?p=37793)
3.  [调用位置](https://devblogs.microsoft.com/oldnewthing/20040923-00/?p=37773)
4.  [关键背景](https://devblogs.microsoft.com/oldnewthing/20040924-00/?p=37753)
5.  [处理菜单消息](https://devblogs.microsoft.com/oldnewthing/20040927-00/?p=37733)
6.  [显示菜单帮助](https://devblogs.microsoft.com/oldnewthing/20040928-00/?p=37723)
7.  [调用默认动词](https://devblogs.microsoft.com/oldnewthing/20040930-00/?p=37693)
8.  [优化默认命令](https://devblogs.microsoft.com/oldnewthing/20041001-00/?p=37683)
9.  [添加自定义命令](https://devblogs.microsoft.com/oldnewthing/20041004-00/?p=37673)
10.  [复合扩展 - 基础](https://devblogs.microsoft.com/oldnewthing/20041006-00/?p=37643)
11.  [复合扩展 - 复合](https://devblogs.microsoft.com/oldnewthing/20041007-00/?p=37633)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-08-20T04:07:11.823

我发现了一篇很棒的 Code Project 文章，它将所有内容都很好地封装到一个类中！

[资源管理器外壳上下文菜单](http://www.codeproject.com/KB/cs/shellContextMenu.aspx)

就像下面的代码片段一样简单：

```
// Sample code

ShellContextMenu ctxMnu = new ShellContextMenu();
FileInfo[] arrFI = new FileInfo[1];
arrFI[0] = new FileInfo(this.treeMain.SelectedNode.Tag.ToString());
ctxMnu.ShowContextMenu(arrFI, this.PointToScreen(new Point(e.X, e.Y))); 
```

唯一令人讨厌的事情是它需要一个 FileInfo[] 数组或一个 DirectoryInfo[] 数组，尽管稍微修改源非常容易，以便它需要一个 FileSystemInfo[] 数组

# security - 在delphi7中安全删除文件

> ID：451288
> 
> 赞同：2
> 
> 时间：2009-01-16T17:28:31.070
> 
> 标签：security, delphi, file-io

完成后，我需要安全地删除我的输入文件，此刻我用零覆盖所有数据，这很混乱，因为我的临时文件夹充满了旧文件，而且文件的名称是一个安全问题.

我希望他们跳过它然后消失，而不是仅仅将它们移动到回收站，这与被逐字节擦除相结合，因为数据恢复软件可以从回收站之外恢复项目。由于名称也很重要，我需要在删除它们之前重命名它们。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-16T18:26:27.693

这是一个渐进的问题。对一个应用程序来说“安全”的东西对另一个应用程序来说是不安全的。如果安全性***真的很重要***，并且您发现自己在 Stack Overflow 上提出这类问题，那么很可能需要与外部安全顾问签约。真正重要的例子包括财务信息、医疗记录或任何其他有法律或合同要求保护数据的情况。我并不是说这意味着或暗示您无法解决问题，而是指出这是一个相当复杂且不断发展的问题。

基本上完成你想要完成的事情：

1.  一旦您编写的代码完成，然后将文件大小更改为空 - 这会使恢复更加困难，因为原始文件大小丢失了。
2.  然后将文件 ( **RenameFile** ) 重命名为不同的名称。
3.  **最后使用DeleteFile**删除文件，它不会将文件移动到回收站。

确保在文件在磁盘上的整个过程中都保持对文件的独占句柄，或者可以在删除之前复制它们。

正如我所说，这是一个渐进的问题。这是一个非常基本的解决方案，并且存在许多漏洞。因此，根据所需的安全级别，您可能会考虑永远不要将文件写入磁盘，或者使用多次覆盖。如果安全真的很重要，那么实际上将硬盘盘片高温烧毁，然后将其砸碎是唯一确定的方法。

**编辑：** 看来您删除了代码示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-16T20:42:25.377

有第三方实用程序可以通过命令执行此类操作 - 我发现[PGP 命令行](http://na.store.pgp.com/command_line.html)具有此功能，如果您四处搜索，您可能会找到可以从命令行执行此操作的免费应用程序。然后，您可以从您的应用程序中调用该命令以安全地删除该文件。

我想说，如果您坚持编写自己的代码来执行此操作，那么不要使用全 0，而是将随机字节写入磁盘。并且不要使用内置的 c++ rand 函数，使用更安全的随机数生成器。

正如 Jim McKeeth 所说，如果错误导致严重的法律后果，这不是您自己想做的事情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-16T21:10:55.257

Jim 已经很好地描述了用代码解决问题的问题。这个问题确实是渐进的，您实施的任何解决方案都只会接近完全的安全性，而永远不会获得它。所以要做的一件事是准确地确定您需要保护文件免受什么（窥探家庭成员？同事？企业间谍活动？极权政府？），然后相应地设计您的解决方案并记录其局限性。

不过，我有一种正交的建议。代替 - 或除了 - 在代码中实施安全擦除，您可以要求用户的合作。例如，您可以建议（或要求）将输入文件存储在加密卷上。在企业环境中，PGP Disk 可能是首选，因为它是一个知名品牌，而家庭用户可以很好地使用免费且经过良好测试的 TrueCrupt。两种产品都支持创建虚拟加密卷以及加密整个分区。即使在您编写单行代码之前，这也将极大地保护输入文件的名称和内容的安全。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-16T20:41:48.777

删除文件可能是个敏感话题……

根据您客户的需要，我想指出[数据剩磁](http://en.wikipedia.org/wiki/Data_remanence)现象。这是简单覆盖后留下的残留数据。[数据擦除](http://en.wikipedia.org/wiki/Data_erasure)是一种破坏残留数据的方法。

关于如何擦除残留数据有一些标准，[DoD 5220.22-M](http://www.dtic.mil/whs/directives/corres/html/522022m.htm)主要由“安全文件删除”应用程序引用，但显然[规则已经改变](http://en.wikipedia.org/wiki/NISPOM)。

> 从 2007 年 6 月版的 DSS C&SM 开始，磁介质的清理不再接受覆盖；只有消磁或物理破坏是可以接受的。

所以我要说的是，试着让你的客户遵守规则。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-08-25T13:28:14.950

当心闪存存储使用的“磨损均衡”算法。为了促进均匀磨损，文件在驱动器上移动，它对您的应用程序甚至操作系统都是不可见的。因此，您可以随心所欲地“安全删除”文件，并且只会影响文件的最新副本。但是以前的副本可以通过恢复软件恢复/发现。所以解决这个问题的唯一方法是加密文件内容。

# excel - 根据另一个工作表和单元格中的值格式化单元格颜色

> ID：451297
> 
> 赞同：15
> 
> 时间：2009-01-16T17:31:10.427
> 
> 标签：excel

我有一个有两张纸的工作簿。我想根据工作表 2 的第二列中的值格式化工作表 1 的第一列中的单元格背景颜色。

例如，如果 sheet2 第 6 行第 2 列的值是 4，那么我希望 sheet 1 第 4 行第 1 列的背景颜色为绿色。如果工作表 2 第 2 列中的任何值都没有引用工作表 1 中的特定行，我想将其设置为无颜色。没有禁止在表 2 的第二列中多次出现相同的值。如果表 2 中指向表 1 中的行的最后一个值被删除，如果你能告诉我如何取消设置颜色，那么值得称赞。

我敢肯定，对于那里的 Excel 向导来说，这可能是微不足道的，但我很少有机会使用 Excel，当然也没有时间成为它的黑带。谁能给我建议、指点或快速的公式来做到这一点？如果这需要一些复杂的 VB 代码来实现，那是不值得的。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-16T21:56:35.023

您也可以使用***命名范围***执行此操作，因此您不必将单元格从 Sheet1 复制到 Sheet2：

1.  定义一个命名范围，例如`Sheet1Vals`具有您想要作为条件基础的值的列。您可以使用`Insert\Name\Define...`菜单项定义新的命名范围。输入您的姓名，然后使用`Refers to`框中的单元格浏览器选择范围中所需的单元格。如果范围会随时间变化（添加或删除行），您可以使用此公式而不是显式选择单元格：

    `=OFFSET('SheetName'!$COL$ROW,0,0,COUNTA('SheetName'!$COL:$COL))`.

    如果该列有标题行，则`-1`在最后一个之前添加一个。`)`

2.  定义一个命名范围，例如`Sheet2Vals`具有您想要有条件地格式化的值的列。

3.  使用条件格式对话框创建您的条件。在下拉列表中指定`Formula Is`，然后将其用于公式：

    `=INDEX(Sheet1Vals, MATCH([FirstCellInRange],Sheet2Vals))=[Condition]`

    `[FirstCellInRange]`您要格式化的单元格的地址在哪里，并且`[Condition]`是您检查的值。

例如，如果我在 Sheet1 中的条件具有 的值`1`，`2`并且`3`我正在格式化的列`B`是 Sheet2 中的列，那么我的条件格式将类似于：

```
=INDEX(Sheet1Vals, MATCH(B1,Sheet2Vals))=1
=INDEX(Sheet1Vals, MATCH(B1,Sheet2Vals))=2
=INDEX(Sheet1Vals, MATCH(B1,Sheet2Vals))=3 
```

然后，您可以使用格式刷将这些格式复制到其余单元格中。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-16T18:37:14.427

下面是我在 Excel 2003 中使用条件格式的方法。

要将条件格式应用于`Sheet1`使用来自 的值`Sheet2`，您需要将这些值镜像到`Sheet1`.

## 创建 Sheet2 的镜像，Sheet 1 中的 B 列

1.  去`Sheet1`。
2.  通过右键单击列 A 的标题并选择“插入”来插入新列。
3.  在 A1 中输入以下公式：

    `=IF(ISBLANK(Sheet2!B1),"",Sheet2!B1)`

4.  `A1`通过右键单击它并选择“ ”进行复制`Copy`。
5.  `A`通过右键单击其标题并选择“ ”将公式粘贴到列中`Paste`。

`Sheet1`, 列`A`现在应该完全反映`Sheet2`, 列中的值`B`。

（注意：如果你不喜欢它在 column`A`中，它也可以放在 column`Z`或其他任何地方。）

## 应用条件格式

1.  坚持下去`Sheet1`。
2.  `B`通过左键单击其标题来选择列。
3.  选择菜单项`Format > Conditional Formatting...`
4.  更改`Condition 1`为“ `Formula is`”并输入以下公式：

    `=MATCH(B1,$A:$A,0)`

5.  单击`Format...`按钮并选择绿色背景。

您现在应该看到绿色背景应用于`Sheet1`.

## 隐藏镜柱

1.  坚持下去`Sheet1`。
2.  右键单击列标题`A`并选择“ `Hide`”。

`Sheet1`每当更改任何内容时，这都会自动更新`Sheet2`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-16T18:13:23.133

我正在使用 Excel 2003 -

在这里使用条件格式的问题是您不能在您的条件中引用另一个工作表或工作簿。您可以做的是将工作表 1 上的某些列设置为工作表 2 上的相应列（在您的示例中为 =Sheet2！B6）。我在下面的示例中使用了 F 列。然后你可以使用条件格式。选择 Sheet 1, row , column 1 处的单元格，然后转到条件格式菜单。从下拉列表中选择“公式为”并将条件设置为“=$F$6=4”。单击格式按钮，然后选择模式选项卡。选择你想要的颜色，你就完成了。

您可以使用格式刷工具将条件格式应用于其他单元格，但请注意默认情况下 Excel 在条件中使用绝对引用。如果您希望它们是相对的，则需要从条件中删除美元符号。

您最多可以将 3 个条件应用于一个单元格（使用条件格式对话框底部的添加 >> 按钮），因此如果最后一行是固定的（例如，您知道它将始终是第 10 行），您可以使用它作为将背景颜色设置为无的条件。假设您关心的最后一个值在第 10 行中（仍然假设您已将 sheet1 上的列 F 设置为工作表 2 上的相应单元格）然后将第一个条件设置为 Formula Is =$F$10="" 和模式为无。使其成为第一个条件，它将覆盖任何以下冲突语句。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-02-28T06:50:46.417

这是我自己在将某些高度格式化的工作表或模板复制到新电子表格时恢复原始颜色的解决方案。它直接复制所有数据，因此它仅在您需要复制工作表时才有效，而不仅仅是将颜色应用于不同的工作表使用不同的数据：

通过 ctrl + g 复制原始格式的工作簿并选择适当的范围

将其粘贴到新工作表中，颜色将全部更改

目标仍然突出显示，右键单击并转到“选择性粘贴”并选择“全部使用源主题”，然后重复选择性粘贴，这次只使用“值”，它应该与您复制的原始工作表相同

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-16T17:34:20.077

我以前用[条件格式](http://www.wikihow.com/Apply-Conditional-Formatting-in-Excel)做过这个。这是一种直观地检查工作簿中的单元格并发现数据中异常值的好方法。

# winforms - .NET 桌面应用程序的 MVC 框架

> ID：451300
> 
> 赞同：8
> 
> 时间：2009-01-16T17:32:18.300
> 
> 标签：winforms, model-view-controller

最近我一直在以 ASP.NET MVC 和 Django（实际上是 MTV）的形式使用 MVC，我必须说我喜欢它。

是否有用于创建桌面 WinForm 应用程序的类似框架？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-16T17:37:09.260

从来没听说过。

不过，我的大多数 Winforms 应用程序都使用 MVC 或 MVP 模式。我注意到，在创建 Winforms 应用程序时，您实际上并不需要太多框架。没有路由基础设施，也没有视图渲染。我发现我不需要做太多的管道来使用这些模式。

这或许可以解释为什么该领域没有高调的框架。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-16T19:01:38.043

一个 winforms 应用程序将视图和控制器混合成几乎一件事，即表单。换句话说，您正在使用模型视图/控制器模式。视图和控制器的大部分工作已经完成。

# sql - 从 Informix Stored Proc 返回的数据源

> ID：451302
> 
> 赞同：2
> 
> 时间：2009-01-16T17:33:22.590
> 
> 标签：sql, stored-procedures, informix, temp-tables

我有一个 Informix 存储过程，它返回两列和多行。我可以很好地使用“EXECUTE FUNCTION curr_sess(2009,'SP')”，但是如何将结果放入临时表中。

编辑：我们在版本 10.00.HC5

* * *

测试 Jonathan Leffler 的想法并没有奏效。

```
EXECUTE FUNCTION curr_sess(2009,'SP') 
```

工作正常。然后我做了

```
CREATE TEMP TABLE t12(yr smallint, sess char(4)); 
```

但是当我尝试

```
INSERT INTO t12 EXECUTE FUNCTION curr_sess(2009,'SP'); 
```

它不起作用，我收到“SPL 例程中的非法 SQL 语句”。错误。

* * *

curr_sess 的来源

```
begin procedure

DEFINE _yr smallint;
DEFINE _sess char(4);

SELECT
    DISTINCT
    sess_vw.yr,
    sess_vw.sess,
    sess_vw.sess_sort
FROM
    sess_vw
ORDER BY
    sess_vw.sess_sort DESC
INTO temp tmp_sess WITH NO LOG;

SELECT
    FIRST 1
    tmp_sess.yr,
    tmp_sess.sess
FROM
    tmp_sess
WHERE
    tmp_sess.sess_sort = sess_sort(iYear,sSess)
INTO temp tmp_final WITH NO LOG;

FOREACH cursor1 FOR
    SELECT
        tmp_final.yr,
        tmp_final.sess
    INTO
        _yr,
        _sess
    FROM
         tmp_final
    RETURN _yr, _sess WITH RESUME;
END FOREACH;

DROP TABLE tmp_sess;
DROP TABLE tmp_final;

end procedure 
```

* * *

编辑： sess_sort() 进行查找。

我试图将函数重写为一个查询。这是 next_sess：

```
SELECT
    FIRST 1
    sess_vw.sess_sort
FROM
    sess_vw
WHERE
    sess_vw.sess_sort > sess_sort(2009,'SP')
ORDER BY
    sess_vw.sess_sort ASC 
```

IBM 的某个人给我发了电子邮件，并建议使用这样的东西：

```
SELECT
    *
FROM
    TABLE(next_sess(2009,'SP')) 
```

但这仍然没有奏效。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-17T03:59:40.780

一种可能性是存储过程。我不确定是否可行的另一个（在 IDS 11.50.FC1 上测试）是：

```
CREATE PROCEDURE r12() RETURNING INT, INT;
   RETURN 1, 2 WITH RESUME;
   RETURN 2, 3 WITH RESUME;
END PROCEDURE;

CREATE TEMP TABLE t12(c1 INT, c2 INT);

INSERT INTO t12 EXECUTE PROCEDURE r12(); 
```

最后一行是重要的。

* * *

鉴于观察到存储过程无法如上所示执行（因为它包含一些不允许的 SQL 语句），那么您需要以另一种方式使用存储过程 - 由这个测试代码说明（有效：第一次工作，让我惊喜）：

```
CREATE TEMP TABLE t12(yr smallint, sess char(4));

CREATE PROCEDURE curr_sess(yearnum SMALLINT, sesscode CHAR(2))
    RETURNING SMALLINT AS yr, CHAR(4) AS sess;
    RETURN yearnum, (sesscode || 'AD') WITH RESUME;
    RETURN yearnum, (sesscode || 'BC') WITH RESUME;
END PROCEDURE;

CREATE PROCEDURE r12(yearnum SMALLINT, sesscode CHAR(2))
    DEFINE yr SMALLINT;
    DEFINE sess CHAR(4);
    FOREACH EXECUTE PROCEDURE curr_sess(yearnum, sesscode) INTO yr, sess
    INSERT INTO t12 VALUES(yr, sess);
    END FOREACH;
END PROCEDURE;

EXECUTE PROCEDURE r12(2009,'SP');

SELECT * from t12; 
```

您可以将临时表的创建合并到存储过程中；您甚至可以安排删除与临时表同名的预先存在的表（使用异常处理）。鉴于您使用的是 IDS 10.00，您会被临时表的固定名称所困扰。尽管（我）不建议使用 11.50 中的动态 SQL 工具在运行时命名临时表，但这是可能的。

请注意，访问临时表的存储过程在重用时会重新优化 - 使用的表与上次不同（因为它是临时表），因此查询计划并没有太大帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-28T10:36:19.553

这可能会失败，因为“删除表”不是在此上下文中使用的过程中的有效语句？ [http://publib.boulder.ibm.com/infocenter/idshelp/v115/topic/com.ibm.sqls.doc/ids_sqs_1755.htm#ids_sqs_1755](http://publib.boulder.ibm.com/infocenter/idshelp/v115/topic/com.ibm.sqls.doc/ids_sqs_1755.htm#ids_sqs_1755 "数据操作语句中 SPL 例程的限制")

# java - java中的GSA包装器？

> ID：451303
> 
> 赞同：1
> 
> 时间：2009-01-16T17:33:37.737
> 
> 标签：java, word-wrap, google-search-appliance

有人知道 Google Search Appliance 的良好包装器实现吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-16T17:48:27.660

看看这个：http: [//gsa-japi.sourceforge.net/gsa-japi.html](http://gsa-japi.sourceforge.net/gsa-japi.html)

# .net - NAnt 0.86 Beta 1 与 .NET 3.5 的持续集成修复

> ID：451309
> 
> 赞同：0
> 
> 时间：2009-01-16T17:35:12.430
> 
> 标签：.net, .net-3.5, .net-2.0, cruisecontrol.net, nant

几周以来，我一直在尝试在几个 .NET 3.0/3.5 项目中使用最新的 NAnt（0.86 Beta 1），因为使用多个 .sln 解决方案文件在我的构建服务器上构建平台代码，但总是出错并且有这个问题 ：

不支持文件“C:***\Platform.sln”的解决方案格式。嵌套构建失败。

附言; 为了在此处清除更多图片，我尝试将 Nant 与 2008 多个 *sln（解决方案）文件一起使用。在我的构建服务器上安装了软件：VS2008 Nant 0.86 beta1 / nant-0.86-nightly-2009-01-11 Microsoft SDKs\Windows\v6.0A CruisControl 版本：1.4.0.3524

尝试了所有可能的场景；包括我然后安装了 Visual Studio 2008 并在此过程中安装了 SDK 版本 6.0A。一旦我这样做了，Nant 0.86 就开始与 .NET 3.5 一起工作。我调整了标签如下：

. . .

我是否应该等待带有这些修复程序的修复程序 0.86-beta2 (TBD) 版本，据我所知，这也不确定。有什么更新吗？

任何来自这种情况的人：提前谢谢N@

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-16T23:51:41.313

如果您正在使用**解决方案**任务，则不支持 VS2003 之后的任何更新。以下问题可能有助于解决您遇到的问题：

[NAnt 和 VS2008 (.NET 3.5) - 不支持文件 Solution.sln 的解决方案格式](https://stackoverflow.com/questions/327722/nant-and-vs2008-net-3-5-solution-format-of-file-solution-sln-is-not-supporte)

# .net - 在 .NET 中解析命令输出

> ID：451318
> 
> 赞同：0
> 
> 时间：2009-01-16T17:37:21.787
> 
> 标签：.net, parsing, string, unidata

我想在我的 .NET 应用程序中连接到数据库服务器并执行生成一系列数据库统计信息的数据库命令。问题是它不会以结构化格式返回统计信息，而是以纯文本形式返回（就像`df -k`UNIX 中的命令）我可以捕获输出并解析它，但我想知道是否有更好的方法来处理类似这。

我当然想不出替代方案，但我想四处打听。解析命令结果似乎有点脆弱，因为如果数据库作者改变了格式，我就会崩溃。

**编辑：**数据库是 IBM UniData 数据库。该命令是“file.stat”，它返回平均记录大小、最大记录大小等。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-22T20:26:05.260

是的，解析描述。但是，您应该首先检查数据库版本。

```
:version
Module Name         Version   Licensed
UniData RDBMS............ 7.1     Yes 
```

这样，如果 file.stat 数据发生变化，您可以调用备用例程。
**注意：** file.stat 输出数据已经有一段时间是静态的，不太可能改变。

```
:file.stat TEST

File name                             = TEST
Number of groups in file (modulo)     = 3
Static hashing, hash type             = 0
Block size                            = 2048
Number of records                     = 12
Total number of bytes                 = 2335

Average number of records per group   = 4.0
Standard deviation from average       = 1.0
Average number of bytes per group     = 778.3
Standard deviation from average       = 286.2

Average number of bytes in a record   = 194.6
Average number of bytes in record ID  = 4.3
Standard deviation from average       = 42.3
Minimum number of bytes in a record   = 113
Maximum number of bytes in a record   = 270

Minimum number of fields in a record  = 66
Maximum number of fields in a record  = 80
Average number of fields per record   = 72.7
Standard deviation from average       = 6.5
The actual file size in bytes         = 8192. 
```

# php - 验证 RSS 提要

> ID：451338
> 
> 赞同：1
> 
> 时间：2009-01-16T17:44:22.177
> 
> 标签：php, xml, rss, feed, validation

我正在开发一个允许用户将自己的 RSS 提要添加到各种简单阅读器的应用程序。

目前，我正在`xml_domit_rss`用作解析器，但我不确定它是否真的在解析之前验证了 URL。

从我可以在线收集的信息来看，验证似乎与解析是分开的，无论是通过使用服务[https://www.feedvalidator.org](https://www.feedvalidator.org)还是其他一些方法，例如`parse_url()`.

任何人都对如何`xml_domit_rss`验证或在将 URL 发送到解析器之前可以验证的方法有所了解？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-16T17:51:12.243

您可以使用 RelaxNG 模式验证 RSS。所有不同提要格式的模式都应该在线提供...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T07:54:20.107

在 XML 文件的上下文中验证（以及因此使用 XML 对值进行编码的 RSS/Atom 提要）意味着使用描述 XML 文件的预期结构的文档模式（哪些元素可以有哪些子元素，哪些属性可以是目前等）。

现在一些 XML 解析器需要一个模式和 bork（这是一个技术术语 :-) - 拒绝解析）对不符合模式的 XML 文件。现在看看您是如何解析任意 RSS 的，可能最好跳过验证并尽最大努力解析 RSS 提要。此外，您可以向用户显示解析结果（类似于 Google Reader 在添加新提要时的做法）并让她判断结果是否正常。

不幸[的是，这段代码使用的 XML 解析器](http://sourceforge.net/projects/domit-xmlparser)似乎不幸死了，我找不到任何细节，它在解析中是多么严格或松懈......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T08:17:31.727

很简单，您可以使用**[SyndicationFeed](http://msdn.microsoft.com/en-us/library/system.servicemodel.syndication.syndicationfeed.aspx)**来做到这一点。它支持[Atom 1.0](http://www.ietf.org/rfc/rfc4287.txt)和[RSS 2.0](http://validator.w3.org/feed/docs/rss2.html)版本。

```
try 
{
    SyndicationFeed fetchedItems = SyndicationFeed.Load(XmlReader.Create(feedUrl));
    // Validation successful.
} 
catch { // Validation failed. }; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-12-30T04:12:56.337

这是我在类似情况下对我有用的快速而肮脏的解决方案

```
foreach($sources as $source) {
    if(!$source["url"]) {
        continue;
    }

    $rss = curl_request($source["url"]);
    $rss = str_replace('&', '&amp;', $rss);

    $parser = xml_parser_create();
    if(xml_parse($parser, $rss)) {
        $xmle = new SimpleXMLElement($rss);
    }
    else {
        $xmle = null;
        continue;
    }

    //other stuff here
} 
```

我确保将与号替换为，因为不这样做会导致 SimpleXMLElement 解析器和实体出现问题，`&amp;`例如`&bull;``&mdash;`

成功时返回 1，因此`xml_parse`您可以使用直接`if`语句进行检查。然后使用 SimpleXMLElement 遍历 RSS 提要使事情变得简单而轻松。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-05-31T09:56:46.233

试试这个代码

```
function validateFeed( $sFeedURL )
{

    $sValidator = 'http://feedvalidator.org/check.cgi?url=';

    if( $sValidationResponse = @file_get_contents($sValidator . urlencode($sFeedURL)) )
    {
        if( stristr( $sValidationResponse , 'This is a valid RSS feed' ) !== false )
        {
            return true;
        }
        else
        {
            return false;
        }
    }
    else
    {
        return false;
    }
}

?> 
```

# c# - SaveFileDialog 阻止可移动驱动器

> ID：451340
> 
> 赞同：3
> 
> 时间：2009-01-16T17:45:46.060
> 
> 标签：c#, .net, windows

我正在使用 SaveFileDialog 让用户在可移动驱动器上选择目录和文件名。之后我创建该文件，写入它，然后再次关闭它。

到那时，文件本身没有被锁定（可编辑、可删除），但我无法弹出驱动器，因为 Windows 声称它仍在使用中。我必须在可以弹出之前退出应用程序。

顺便说一句，即使我只使用 SaveFileDialog 选择文件，驱动器也会被锁定。在对话框上点击“取消”不会导致问题

```
SaveFileDialog dlg = new SaveFileDialog();
dlg.DefaultExt = ".csv";
dlg.InitialDirectory = mySettings.defaultPath;
dlg.Filter = "(CSV-Dateien) *.csv|";
dlg.FileName = exportDate.ToString("yyyy-MM-dd") + ".csv";

if (dlg.ShowDialog() != DialogResult.OK){
    // USB-Drive is ejectable
}else{
    // USB-Drive is locked
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-19T16:04:10.127

我找到了 2 个**解决方案**：

一旦用户单击“保存”，对话框就会更改当前工作目录。阻止可移动驱动器的不是文件，而是程序本身。

所以你要么需要在完成后重新调整工作目录：

```
String oldDir = Directory.GetCurrentDirectory();
// ... do dialog...
Environment.CurrentDirectory = oldDir; 
```

或者您只需在调用 ShowDialog() 之前配置文件对话框以恢复目录

```
dlg.RestoreDirectory = true;
dlg.ShowDialog() 
```

# sql - LINQ 与 SQL Server 2000 的不兼容问题

> ID：451345
> 
> 赞同：0
> 
> 时间：2009-01-16T17:48:54.977
> 
> 标签：sql, linq, sql-server-2000

我有一个在 SQL Server 2005 上运行良好的 Linq to SQL 查询，但是我必须使用 SQL Server 2000 部署 Web 应用程序，并且在执行该查询时，我得到了他的错误：

“System.Data.SqlClient.SqlException：列前缀 't0' 与查询中使用的表名或别名不匹配。”

我有更多查询，但似乎没有问题。现在，这是查询：

```
from warningNotices in DBContext_Analyze.FARs
where warningNotices.FAR_Area_ID == filter.WarningAreaID &&
      warningNotices.FAR_Seq == filter.WarningSeq &&
      warningNotices.FAR_Year == filter.WarningYear
      orderby warningNotices.FAR_Seq ascending
      select new Search_Result
      {
        FAR_Area_ID = warningNotices.FAR_Area_ID,
        FAR_Seq = warningNotices.FAR_Seq,
        FAR_Year = warningNotices.FAR_Year,
        DateTime_Entered = (DateTime)warningNotices.DateTime_Entered == null ?   DateTime.MaxValue : (DateTime)warningNotices.DateTime_Entered,
        Time_Entered = warningNotices.Time_Entered,
        OrigDept = warningNotices.OrigDept,
        Part_No = warningNotices.Part_No,
        DateTime_Analyzed = (DateTime)warningNotices.DateTime_Analyzed == null ? DateTime.MaxValue : (DateTime)warningNotices.DateTime_Analyzed,
        Analyzed_By = warningNotices.Analyzed_By,
        MDR_Required = (Char)warningNotices.MDR_Required == null ? Char.MinValue : (Char)warningNotices.MDR_Required,
        Resp_Dept = (from FARSympt in DBContext_Analyze.FAR_Symptoms
                     where FARSympt.FAR_Area_ID == warningNotices.FAR_Area_ID &&
                   FARSympt.FAR_Year == warningNotices.FAR_Year &&
                   FARSympt.FAR_Seq == warningNotices.FAR_Seq
                 select new { FARSympt.Resp_Dept}).FirstOrDefault().Resp_Dept,
        Sympt_Desc = (from SymptomsCatalog in DBContext_Analyze.Symptoms
              where SymptomsCatalog.symptom_ID == filter.Status_ID
                  select new { 
                                       SymptomsCatalog.Sympt_Desc
                                     }).FirstOrDefault().Sympt_Desc,
        Status_ID = warningNotices.Status.HasValue ? warningNotices.Status.Value : 0
        }; 
```

以前我在 Resp_Dept 字段的子查询中有一个“Distinc”，但我删除了它。

有任何想法吗？提前感谢您的评论=）

* * *

这是我从 SQL Server 探查器获得的查询：

```
exec sp_executesql N'SELECT [t0].[FAR_Seq], [t0].[FAR_Year], 
    (CASE 
        WHEN ([t0].[DateTime_Entered]) IS NULL THEN @p3
        ELSE [t0].[DateTime_Entered]
     END) AS [DateTime_Entered], [t0].[Time_Entered], [t0].[OrigDept], [t0].[Part_No], 
    (CASE 
        WHEN ([t0].[DateTime_Analyzed]) IS NULL THEN @p4
        ELSE [t0].[DateTime_Analyzed]
     END) AS [DateTime_Analyzed], [t0].[Analyzed_By], 
    (CASE 
        WHEN (UNICODE([t0].[MDR_Required])) IS NULL THEN @p5
        ELSE CONVERT(NChar(1),[t0].[MDR_Required])
     END) AS [MDR_Required], (
    SELECT [t2].[Resp_Dept]
    FROM (
        **SELECT TOP (1)** [t1].[Resp_Dept]
        FROM [dbo].[FAR_Symptoms] AS [t1]
        WHERE (UNICODE([t1].[FAR_Area_ID]) = UNICODE([t0].[FAR_Area_ID])) AND ([t1].[FAR_Year] = [t0].[FAR_Year]) AND ([t1].[FAR_Seq] 
= [t0].[FAR_Seq])
        ) AS [t2]
    ) AS [Resp_Dept], (
    SELECT [t4].[Sympt_Desc]
    FROM (
        **SELECT TOP (1)** [t3].[Sympt_Desc]
        FROM [dbo].[Symptoms] AS [t3]
        WHERE [t3].[symptom_ID] = @p6
        ) AS [t4]
    ) AS [Sympt_Desc], [t0].[FAR_Area_ID], 
    (CASE 
        WHEN [t0].[Status] IS NOT NULL THEN [t0].[Status]
        ELSE @p7
     END) AS [Status_ID]
FROM [dbo].[FARs] AS [t0]
WHERE (UNICODE([t0].[FAR_Area_ID]) = @p0) AND ([t0].[FAR_Seq] = @p1) AND ([t0].[FAR_Year] = @p2)
ORDER BY [t0].[FAR_Seq]',N'@p0 int,@p1 int,@p2 varchar(2),@p3 datetime,@p4 datetime,@p5 nchar(1),@p6 int,@p7 
int',@p0=76,@p1=7204,@p2='08',@p3=''9999-12-31 23:59:59:997'',@p4=''9999-12-31 23:59:59:997'',@p5=N' ',@p6=0,@p7=0 
```

我在 SQL Server 2000 中看到的唯一想法是“选择顶部...”中的“（）”，但我不确定这是否是导致问题的原因，而且我不知道不知道怎么解决=S

再次感谢 =)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-03-24T14:09:05.677

我的 Linq 语句在 SQL2008 上工作，但在 SQL2000 上出现完全相同的错误消息。有一个非常相似的 Linq 查询对两者都有效，唯一真正的区别是在调用 .ToList() 之前我调用了 .OrderBy() 子句。例如：var query = from t1 in table1 ... ...;

list = query.OrderBy(o => o.Field).ToList()

在损坏的 Linq 查询上尝试了相同的 OrderBy 子句，它成功了！

一定是bug？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-16T18:30:33.317

你有最新的 Visual Studio 服务包和框架吗？

我刚刚检查了一些我的 Linq 生成的 SQL，它针对 SQL Server 2000 数据库正确使用了“Top 1”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-19T15:50:31.370

经过几次测试和审查数据库后，我发现问题出在我正在处理的**遗留表上：该表具有****“文本”类型字段**。此外，我必须在我拥有的嵌套查询中**删除**一些“**不同**”指令。

我发现[了这一点](http://msdn.microsoft.com/en-us/library/bb399342.aspx)，在审查之后，我发现我必须更改我的查询并且“不同”指令无法正常工作。作为旁注，让我说嵌套查询也可能产生意外行为。

所以，这里真正的教训是，如果您**需要**针对**SQL Server 2000**部署它，请设置服务器实例并对其进行测试！！！XD

非常感谢您的帮助 =)

# ruby - 在 ruby 中，我怎么知道哪个模块被定义为“加载”或“要求”的结果？

> ID：451347
> 
> 赞同：3
> 
> 时间：2009-01-16T17:49:38.657
> 
> 标签：ruby, introspection

在 ruby​​ 中，如果我确实“需要 foo”，有没有办法随后确定 foo.rb 中定义的一个或多个模块的名称？

例如，假设我有一个名为 foo.rb 的 ruby​​ 文件，如下所示：

```
# foo.rb
module MyModule
    def self.summary
        "this does something useful"
    end
    ...
end 
```

在另一个脚本中，在我执行“require foo”之后，如何确定我现在有一个名为 MyModule 的模块？

最终我追求的是能够做这样的事情：

```
file = someComputedFileName()
require file
puts "summary of #{file}: #{???::summary} 
```

虽然我可以强迫自己使模块名和文件名相同，但我宁愿不这样做。我希望在制作短文件名时更加自由，但模块名称更具表现力。但是，我向自己保证每个文件只会定义一个模块（想想：插件）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-16T18:19:32.403

我不知道这是否是最好的解决方案，但在我看来这似乎可行：

```
all_constants = Object.constants
require 'foo'

foo_constants = Object.constants - all_constants 
```

foo_constants 应该只为您提供由 foo.rb 定义的模块、类或其他常量。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-16T18:17:05.340

一种方法是使用[ObjectSpace](http://www.ruby-doc.org/core/classes/ObjectSpace.html) .each_object(Module) 在需要文件之前找到所有已定义的模块。然后，在您需要文件后，再次遍历所有已定义的模块并查看是否有任何新模块。

```
require "set"
old_modules = SortedSet.new
ObjectSpace.each_object(Module) {|m| old_modules.add(m) }

file = someComputedFileName()
require file

new_modules = SortedSet.new
ObjectSpace.each_object(Module) {|m| new_modules.add(m) unless old_modules.include?(m) }

puts "summary of #{file}: #{new_modules.to_a.map{|m|m.summary}.join(',')}" 
```

这也可以让您在文件中定义多个模块。

# c# - C# 中的 XslCompiledTransform 调试

> ID：451348
> 
> 赞同：2
> 
> 时间：2009-01-16T17:50:00.857
> 
> 标签：c#, xml, xslt, xslcompiledtransform

我已经尝试了又尝试了，但我无法设法进入 XslCompiledTransform 而不必从磁盘加载样式表（通过将 URI 传递到 XslCompiledTransform.Load() 方法）。

我完全知道，如果您通过 URI（如前所述）从磁盘加载样式表或从实现 IXmlLineInfo 接口的 XmlReader 加载样式表，则只能进入 XslCompiledTransform.Transform() 方法。

我已按如下方式加载样式表：

```
XslCompiledTransform xslt = new XslCompiledTransform(true);
//grab string from textbox
XmlReader reader = XmlReader.Create(new StringReader(XsltBox.Text));

// Compile the style sheet.
xslt.Load(reader); 
```

从我读过的各种文献来看，这似乎是启用调试的方式。但是，当我尝试进入 XslCompiledTransform.Transform() 方法时，我收到消息：**“当前位置没有可用的源代码”**

如前所述，如果我执行以下操作，我可以进入转型：

```
string stylesheet = @"C:\PathToMy\Stylesheet.xsl";

// Enable XSLT debugging.
XslCompiledTransform xslt = new XslCompiledTransform(true);
//compile stylesheet
xslt.Load(stylesheet); 
```

上述方法是不可能的，因为我不希望不断地从磁盘读取数据。

* * *

感谢您的有用评论，我没有意识到微软已经这样做了，我相信这在将来会**非常**有帮助。

但是，我想我的问题并没有完全清楚。我没有考虑进入加载方法，我想进入转换方法，以便我可以看到 xsl 转换发生了什么。我强调了加载方法，因为您传入的参数指示您是否能够调试转换方法（您必须传入实现 IXmlLineInfo 接口的 XmlReader 才能这样做）。

虽然我可以使用您突出显示的技术进入转换方法，但我只是单步执行代码。尽管我可以通过观察代码来找出转换的原因，但 xsl 调试器会逐行显示实际样式表本身的单步执行（与执行转换的每一行的代码相反）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-16T17:57:45.973

最近，Microsoft 发布了 .Net Framework 的符号和源代码，以便在这种情况下进行调试。设置需要几秒钟，但一旦完成，无论您如何构建 XslCompiledTransform，您都应该能够进入 Load 方法。

进入 SO 答案太详细了，但这里有一篇关于这个主题的优秀博客文章。

[http://codebetter.com/blogs/james.kovacs/archive/2008/01/17/debugging-into-the-net-framework-source.aspx](http://codebetter.com/blogs/james.kovacs/archive/2008/01/17/debugging-into-the-net-framework-source.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-10T13:47:53.487

我在尝试使用时遇到了同样的问题`XmlReader.Create(new StringReader(String))`。似乎调试器必须能够找到一个磁盘文件才能进行调试，但这并不意味着不能使用`StringReader`流版本。`XmlReader.Create`试试这个版本：

```
XmlReader.Create(new StringReader(String), New XmlReaderSettings(), baseURI) 
```

在我的情况下，我使用文件资源来存储我的 xslt 字符串，所以我可以指向一个文件。实际上，您不需要提供调试器将知道的绝对路径来搜索在解决方案/属性/调试器源代码下指定的文件夹中的源代码。

的文档`XslCompiledTransform`具有误导性，因为它暗示所需要的只是`XmlReader`支持`IXmlLineInfo`接口。

# apache-flex - 使用 CF8 重新编译后 remoteObject 失败

> ID：451351
> 
> 赞同：0
> 
> 时间：2009-01-16T17:51:04.630
> 
> 标签：apache-flex, coldfusion, cfc, remoteobject

我收到了一个最初使用 Flex3 和 CF7 构建和编译的 Flex 项目。我的设置是带有 CF8 的 Flex3。当我最初将项目拉过来时一切正常，但是一旦我重新编译，对 CFC 的远程调用就开始失败。我使用了 Charles Web Proxy 调试器，发现故障似乎是从 flex2gateway 开始的。我再次检查以确保 flex2gateway 是可访问的，并且它在我的项目根目录和本地主机上的 CF8 安装上运行良好。我还仔细检查以确保我的项目设置指示 Flex 编译器为 services-config.xml 引用我的 CF8 wwwroot。据我所知，我所有的设置都是正确的。所以，不用说，我完全不知所措。以前有没有其他人遇到过这个问题？

谢谢，--安妮

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-16T23:35:59.580

实际上没有错误被抛出，这真的很奇怪。然而，经过一些进一步的测试和实验，我确实发现了一些相当有趣的东西。我继续创建了一个新项目，其中 bin-debug 文件全部输出到 Web 根目录。尝试使用该设置调用 CFC 时，它运行良好，这有点奇怪。一旦我开始在与项目相同的文件结构中设置它，它就停止了连接。项目的文件结构如下：

*   _闪光
    *   主要的
    *   二进制调试
    *   库
    *   源代码
*   com
    *   测试
        *   测试.cfc
*   index.cfm（这与通常在 bin-debug 中生成的 html 包装器相同。我们将它放在根目录中，以便我们可以根据当时使用的服务器提取发布版本或调试版本。）

基于此，我的想法是，由于某种原因，它不寻找 com.Test.Test 的服务器根目录，而只是在 bin-debug 中寻找。那有意义吗？令人抓狂的是完全没有错误。

——安妮

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-20T20:11:36.053

在玩弄这个比我应该拥有的时间长得多之后，我决定改用 JSON 进行远程处理。这主要是因为 JSON 使得在调试时找出幕后发生的事情变得相当容易。谢谢大家的帮助。

——安妮

# com - 如何访问 .Net 中 COM+ 服务器中托管的 .Net COM 对象？

> ID：451358
> 
> 赞同：0
> 
> 时间：2009-01-16T17:54:47.477
> 
> 标签：com, com+

[这个问题是 Marc Gravell 对我的问题Create Out-Of-Process COM in C#/.Net](https://stackoverflow.com/questions/446417/create-out-of-process-com-in-c-net)的回答的后续问题？. 我选择了他提出的解决方案，但现在正在处理不同的问题。

这是我的情况：

*   我在 C# 中实现了一个“DataProvider”COM 组件
*   该组件托管在 COM+ Server 应用程序中，因此多个进程可以访问 DataProvider 的同一个实例
*   可以通过 COM 访问数据提供者的进程类型有 Matlab、VB 脚本和 .Net 应用程序。

当从 Matlab 或 VB 脚本实例化 COM DataProvider 时，COM+ 机制启动，我可以验证是否可以使用 DataProvider 的单个实例。

当我尝试从 .Net 访问 COM+ 托管实例时，问题就出现了。基本上，当 COM 组件基于 .Net DLL 时，即使延迟加载，.Net 似乎总是会找到 DLL 并从那里实例化对象，从而跳过整个 COM 机制。这是预期的表演，但对我来说没有帮助。

**现在的问题是：是否可以使用 COM 机制**在 .Net 应用程序中实例化 .Net 编写的 COM 组件？

 **请注意，以下代码不使用 COM 机制：

```
 Type type = Type.GetTypeFromProgID(progID);
    return Activator.CreateInstance(type); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-10-23T18:54:09.733

看看[这个答案](https://stackoverflow.com/a/33309478/225979)。必须首先将程序集添加到 GAC，然后必须使用 regsvcs 实用程序创建 COM+ 应用程序。否则，.Net 根本不会查看 COM+ 目录：

```
"c:\Windows\Microsoft.NET\Framework\v4.0.30319\regsvcs.exe" MyObject.dll
"C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\Bin\NETFX 4.0 Tools\gacutil.exe" /i MyObject.dll 
```

# javascript - 在同一页面中使用 JQuery 和 Prototype

> ID：451362
> 
> 赞同：34
> 
> 时间：2009-01-16T17:56:38.753
> 
> 标签：javascript, jquery, prototypejs

我的几个页面同时使用了 JQuery 和 Protoype。由于我升级到 JQuery 1.3 版，这似乎导致了问题，因为这两个库都定义了一个名为“$”的函数。

JQuery 提供了一个函数 noConflict() ，它将 $ 的控制权交给可能正在使用它的其他库。所以看起来我需要浏览所有看起来像这样的页面：

```
<head>      
    <script type="text/javascript" src="/obp/js/prototype.js"></script>
    <script type="text/javascript" src="/obp/js/jquery.js"></script>
</head> 
```

并将它们更改为如下所示：

```
<head>      
    <script type="text/javascript" src="/obp/js/prototype.js"></script>
    <script type="text/javascript" src="/obp/js/jquery.js"></script>
    <script type="text/javascript">
        jQuery.noConflict();
        var $j = jQuery;
    </script>
</head> 
```

然后我应该能够将“$”用于 Prototype，将“$j”（或“jQuery”）用于 JQuery。我对在每个相关页面中复制这两行代码并不完全满意，并希望在某些时候有人可能会忘记将它们添加到新页面中。我希望能够执行以下操作

*   创建一个`query-noconflict.js`“包含”的文件 j`jquery.js`和上面显示的 2 行代码
*   在我的所有 JSP/HTML 页面中导入`jquery-noconflict.js`（而不是）`jquery.js`

但是，我不确定是否可以按照我描述的方式将一个 JS 文件包含在另一个文件中？当然，另一种解决方案是直接将上面的 2 行代码添加到 jquery.js，但如果我这样做，我需要记住每次升级 JQuery 时都这样做。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2011-10-30T14:01:28.457

目前你可以做这样的事情：

```
<head>          
    <script type="text/javascript" src="/obp/js/prototype.js"></script>
    <script type="text/javascript" src="/obp/js/jquery.js"></script>
    <script type="text/javascript">
        var $j = jQuery.noConflict();
    </script>
</head> 
```

然后，使用 jQuery as`$j()`和 Prototype 的`$()`.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-09-04T08:30:23.237

该解决方案运行良好：

```
jQuery.noConflict();
var $j = jQuery; 
```

现在使用`$j`代替`$`您的 jQuery 代码，例如：

```
$j(document).ready(function() {
    $j('#div_id').innerfade({
         // some stuff
    });
}); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-16T18:01:13.033

似乎最简单的答案是咬紧牙关，并包括您的 noConflict 行。当然，如果您的页面没有使用共享标题，那么该解决方案可能不是最好的。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-16T19:25:44.860

我经历了一段时间。这很烦人，最后我决定淘汰所有旧的 Prototype 东西并用 jQuery 替换它。我确实喜欢 Prototype 处理一些 Ajax 任务的方式，但是为了维护所有没有冲突的东西而付出代价是不值得的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-09-05T10:52:36.397

就像给偶然发现这一点的其他人的便条一样。此处描述了解决方案（特别提到原型）： [http ://docs.jquery.com/Using_jQuery_with_Other_Libraries](http://docs.jquery.com/Using_jQuery_with_Other_Libraries)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-10-27T16:53:23.687

您不能只`jQuery = noConflict()`在 jquery.js 源文件中包含代码吗？为什么需要这样定义？

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-01-10T13:34:58.287

您`jquery-noconflict.js`应该看起来像这样（确保所有内容都在一行中）：

```
document.write("<script type=\"text/javascript\" src=\"/obp/js/jquery.js\"></script><script type=\"text/javascript\">jQuery.noConflict();var $j = jQuery;</script>"); 
```

...并且您的包含（正如您已经指出的那样）应该如下所示：

```
<head>      
    <script type="text/javascript" src="/obp/js/prototype.js"></script>    
    <script type="text/javascript" src="/obp/js/jquery-noconflict.js"></script>
</head> 
```

我认为该解决方案可以解决您的所有要求。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-16T18:08:08.870

```
<script>
    document.write(unescape('%3Cscript type="text/javascript" src="/obp/js/jquery.js"%3E%3C/script%3E'));
</script>
<script>
    jQuery.noConflict();
    var $j = jQuery;
</script> 
```

或者

```
var scripty = document.createElement('script');
scripty.href="/obp/js/jquery.js";
document.getElementsByTagName('head')[0].appendChild(scripty);
jQuery.noConflict();
var $j = jQuery; 
```

**编辑：**

我尝试了这个建议，但最后两行产生了错误

```
jQuery is not defined 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-20T22:43:18.287

你可以先调用 jquery 然后设置

```
var $j = jQuery; 
```

`$`在这种情况下原型将控制。

或者，您可以使用完整的 jQuery 函数名称 (jQuery) 来引用 jQuery。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-02-17T10:17:04.677

You need to load it in your `public/javascript/application.js`

```
jQuery.noConflict();

var $j = jQuery; 
```

This is also a good article that may be helpful.

[JQuery & Prototype working together](http://www.alfajango.com/blog/rails-prototype-to-jquery/)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-05-25T08:06:59.160

在 jQuery 下使用 Prototype，如下所示：

```
<script type="text/javascript" src="news/jquery-1.2.3.pack.js"></script>
<script type="text/javascript" src="news/jquery.easynews.js"></script>

<script type="text/javascript" src="lb/js/prototype.js"></script>
<script type="text/javascript" src="lb/js/scriptaculous.js?load=effects"></script>
<script type="text/javascript" src="lb/js/lightbox.js"></script>
<link href="lb/css/lightbox.css" rel="stylesheet" type="text/css" /> 
```

在这种情况下，jQuery 函数会产生问题，因此您可以使用它来解决问题：

```
<script type="text/javascript">
     jQuery.noConflict();
     var JQ = jQuery;//rename $ function
</script> 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-16T19:44:42.200

如果我是你，我会将我的无冲突代码放入一个 JavaScript 包含文件中，就像你在上面所说的那样，然后找出一些过程，我将在其中设置这些内容，我需要将这些内容包含在一个中心位置的所有页面中. 如果您正在处理直接的 HTML 文件，并且您没有任何类型的模板/脚本功能服务器端用于文档中包含的内容，那么总是有可能进行服务器端包含。

无论哪种方式，当您需要更新分析代码或网站页脚时，您这次更新每个页面所经历的痛苦都会再次出现。

# iphone - Interface Builder 缓存坏数据 (voodoo)

> ID：451364
> 
> 赞同：3
> 
> 时间：2009-01-16T17:57:18.220
> 
> 标签：iphone, cocoa-touch, interface-builder

有时 IB 会保留旧的或坏的参考资料，我似乎无法删除或编辑它们。

**编辑**我已将此作为一个 wiki 问题，目的是收集有关该现象的更多数据。欢迎回答涉及其他编码人员遇到此问题的情况。

昨晚我用桌子控制器再次发生了这种情况。当我创建一个尖峰项目来尝试重现错误时，系统按我预期的方式工作。然后回到实际项目中，即使我删除了 xib 文件和所有涉及的控制器，不良行为仍在继续。

创建一个没有任何原始（有问题的）xib 和 nib 文件的全新项目可以正常工作。

这个问题不是关于这个事件的细节，而是关于 IB 中的这类事件。

有没有人知道更多关于这种不良 IB 行为的信息，并且可能是一种比破坏项目更时尚的方式来消除它？

请注意，删除有问题的 IB 文件并在同一个项目中重新创建它们在过去对我来说并没有解决这个问题，只有全新的项目。

关于何时/如何观察/创建此故障的示例的答案也是受欢迎的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-09-22T18:47:57.493

我通过单击文件 > 读取类文件 ... 并将 IB 指向我的类文件来解决这种类型的缓存问题。宾果游戏，它读得很好，一切正常。:-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-24T22:57:53.107

I just had a project where this happened and I was banging my head trying to get it to update properly in IB 3.2 (732). I really did not want to redo the xib from scratch. I tried drag/drop of the *.h files, restarting, reloading everything and it didn't work. I also tried File->Read Class Files which didn't work. Strangely though, File->Reload All Class Files worked like a charm.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-17T11:00:57.327

我唯一真正的建议是在[http://bugreporter.apple.com/](http://bugreporter.apple.com/)提交错误报告，并附上可重现的项目；根据我的经验，Apple 确实会考虑这些事情。也就是说，您说在同一个项目中重新创建 XIB 并没有修复错误。更换链接的另一端怎么样？即重新创建头文件并将新头文件与现有的XIB一起使用？也许这足以促使 IB 更新其模型。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-03-28T10:29:13.003

我发现 File > Read Class Files 为单个 nib 文件修复了它，但是 nib 不会与任何未来的更改保持同步，并且该修复也不适用于项目中的任何其他文件。

重新启动和/或清洁建筑也没有帮助，但新项目很好。我在 Xcode/IB 版本 3.2.2 中发生了这种情况——到目前为止，唯一的解决方案是在新项目中重建代码。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-09-08T14:55:22.643

再次阅读有问题的类文件为我解决了这个问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-09-25T23:43:06.457

我遇到了同样的问题。当我打开一个使用旧 Xcode 版本制作的项目时会发生这种情况。Interface Builder 无法与 Xcode 正确同步。是的，我可以使用“文件->读取类文件...”手动更新 IB 缓存，但即使使用此方法，垃圾仍然存在。我的意思是旧的 IBOutlet 和 IBAction 仍然出现。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-20T06:27:19.963

你保存头文件吗？Interface Builder 解析磁盘上的头文件的内容，而不是 Xcode 编辑器中未保存的文件。如果您在头文件中添加了一个出口，并在没有先保存的情况下切换回 IB，则 IB 将看不到新的出口。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-17T10:43:02.807

也许不是您想要的答案，但它是：不要使用 IB！:-)

我在使用它时也遇到了麻烦，即使完全按照某些 Apple 文档中描述的步骤进行复制，从头开始尝试多次。所以三天后我就放弃了，开始以编程方式做所有事情，半天就实现了我的程序。从那以后我再也没有回头。我只是偶尔启动 IB 来查看大小，所以我可以将它们输入到我的代码中。

随着时间的推移更新我的 GUI 可能会变得不那么容易，但如果你的故事是一个真正经常出现的问题，我很高兴我与野兽分道扬镳！

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-17T11:08:37.187

当你说旧的或坏的引用时，你的意思是它试图将 UI 元素链接到不再存在的类中的出口或动作吗？如果是这种情况，请转到连接面板 (cmd-5) 并选择 nib 文件中的对象。它应该向您显示所有连接。任何文本变灰并带有感叹号的地方都应删除（悬停并单击 x）。

在 IB 中，您只是连接到应用程序启动时您的班级将是什么样的“承诺”。IB 通常只允许您连接可以实现该承诺的东西，但是如果您更改 Xcode 中的标头，IB 除了警告您之外无能为力。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-05-22T04:22:09.577

快速简单的解决方案： - 无需重新启动计算机，无需新项目。. .

不幸的是，这篇文章中的任何建议都没有为我解决这个问题（除了重新启动我的计算机然后开始一个全新的 xcode 项目）

我的解决方案... 无论如何，唯一的其他快速修复（至少对我使用 Perfoce 有效）是撤销（恢复）我在修订控制系统中的更改。我们正在使用 Perforce，这似乎工作得很好。

我不必创建一个全新的 xcode 项目，无需重新启动计算机，甚至无需重新启动 xcode，无需手动删除文件或引用，无需重新引用类，无需点击和拖动垃圾来处理，无需手动更改设置， ETC。

DOWNFALL... 如果您在 xcode 和 IB 周围走来走去一段时间，并进行了很多更改，然后突然出现问题...您当然会丢失恢复的文件中的所有内容... QQ

glhf-eric

旁注...这是一个非常糟糕的错误，并且肯定会消耗大量时间，尤其是如果您是第一次遇到此问题（我相信这里的每个人都意识到，时间对开发人员来说至关重要）。这是我第一次对 apple/obj c/xcode（2 个月前开始）感到失望，我觉得这不会是最后一次：/

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-19T08:37:23.117

尝试对代码进行干净的构建，然后查看旧引用是否保留在 xib 中

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-19T09:07:35.410

您没有说问题是否在重新启动后仍然存在，所以我认为可能是这个问题：Xcode 的构建过程中存在一个罕见的错误，有时旧版本的输出文件卡在 /tmp 文件夹中并且不会得到更新。IIRC，最简单的解决方案是清理目标并重新启动计算机。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-06-26T07:16:41.453

当我从一个旧项目创建一个新项目时，我在 IB 上遇到了完全相同的问题。我可以将 IB 与新的 .h 文件同步，但是当我右键单击对象时，IB 仍然给出了删除的引用（来自旧项目）（类名“MainController”从旧的到新的相同）即使那些更新后的代码中根本不存在引用。

“你没有说问题是否在重启后仍然存在，所以我认为可能是这个问题：Xcode 的构建过程中存在一个罕见的错误，有时旧版本的输出文件卡在 /tmp 文件夹中并且不会得到更新。IIRC，最简单的解决方案是清理目标并重新启动计算机。” 我试图清洁目标，但没有奏效。

但是，一旦我删除了 MainManu.xib 并创建了一个新的（手动设计界面会做一些工作），旧的引用就消失了。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2010-07-09T04:07:42.983

刚刚发生了这种类型的事件，并通过使用 XCode 的重构将类重命名为不同的名称来修复它。似乎让事情重新开始。

# sql-server - 如何在 SSIS 中删除设置的字符串模式？

> ID：451366
> 
> 赞同：0
> 
> 时间：2009-01-16T17:58:32.447
> 
> 标签：sql-server, string, ssis

我想修改一个字符串。在 ssis 我有一个步骤是“派生列转换编辑器”。我有一个字符串，例如：

```
edit=style?form=exy?test=x~~StringIWantToRemove 
```

我希望删除 "~~StringIWantToRemove" "~~" 是分隔符 "StringIWantToRemove" 是随机字符串和任何值（分隔符除外）

我会尝试查找 ~~ 的索引，然后查找字符串的 len，然后从该点删除，但不确定如何在 ssis 中执行此操作。

帮助？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-16T22:06:25.440

我会考虑使用带有正则表达式的脚本任务 - 这可能比尝试将其提炼成派生列任务中的单行更容易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-21T12:11:56.973

最后我使用了一个脚本组件：

```
Dim debugOn As Boolean
debugOn = False

If debugOn Then MsgBox(Row.trackingCode)
If Row.trackingCode <> "" Then
    ' find the delimiter location
    Dim endLocation As Integer
    If debugOn Then MsgBox("index of ~~ is " & Row.trackingCode.ToString().IndexOf("~~", 0))
    ' chk if we have ~~ in field, if not in field then -1 is returned
    If Row.trackingCode.ToString().IndexOf("~~", 0) > -1 Then
        ' if ~~ at the beginning ie no tracking code
        If Row.trackingCode.ToString().IndexOf("~~", 0) = 1 Then
            endLocation = Row.trackingCode.ToString().IndexOf("~~", 0)
        ElseIf Row.trackingCode.ToString().IndexOf("~~", 0) > 1 Then
            endLocation = Row.trackingCode.ToString().IndexOf("~~", 0) - 1
        End If
        If debugOn Then MsgBox("end of track code is " & endLocation)
        Row.trackingCode = Row.trackingCode.Substring(1, endLocation)
    End If
End If 
```

# javascript - 如何计算从0开始的小数点偏移量

> ID：451374
> 
> 赞同：0
> 
> 时间：2009-01-16T18:01:25.043
> 
> 标签：javascript

今天我的大脑部门有点慢，我想也许有人以前做过。

鉴于下面的数字，我可以在 Javascript 中使用什么简单的方法将小数点计算为数字，例如：

*   1 = 小数点：0
*   10 = 小数点：1
*   1678 = 小数点：3
*   -0.56 = 小数点：-1
*   -0.0045 = 小数点：-3

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-16T18:09:36.730

log(x)/log(10) // 以 x 为底的 10 对数

如果要为 x 传递负数，则需要绝对值。

如果您想要整数结果，则需要下限。

例子：

Math.floor(Math.log(Math.abs(-0.56))/Math.log(10));

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-16T18:09:59.163

目前尚不完全清楚您的算法是什么。是什么让 -0.56 小数点为 -1 而不是 -2？同样，原始数字的符号与小数点的符号有关系吗？

您可以取数字绝对值的以 10 为底的对数，然后截断为整数以获得“小数点”，并获得上面显示的所有结果。但是，有许多算法可以在提供的集合中这样做，同时在其他数字上有所不同。

# c - char 被签名是什么意思？

> ID：451375
> 
> 赞同：29
> 
> 时间：2009-01-16T18:01:29.663
> 
> 标签：c, string, character-encoding, char, signed

鉴于有符号和无符号整数使用相同的寄存器等，并且只是以不同的方式解释位模式，而 C 字符基本上只是 8 位整数，那么 C 中的有符号和无符号字符有什么区别？我知道 char 的符号是实现定义的，我根本无法理解它如何产生影响，至少当 char 用于保存字符串而不是进行数学运算时。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-01-16T18:06:33.427

它不会对字符串产生影响。但是在 C 中，您可以使用 char 来进行数学运算，这会有所作为。

事实上，当在内存受限的环境中工作时，比如嵌入式 8 位应用程序，通常会使用 char 来进行数学运算，然后它会产生很大的不同。`byte`这是因为C 中默认没有类型。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2009-01-16T19:22:49.670

就它们所代表的价值而言：

## 无符号的字符：

*   跨越值范围`0..255 (00000000..11111111)`
*   值在低边缘溢出为：

    `0 - 1 = 255 (00000000 - 00000001 = 11111111)`

*   值在高边溢出为：

    `255 + 1 = 0 (11111111 + 00000001 = 00000000)`

*   按位右移运算符 ( `>>`) 进行逻辑移位：

    `10000000 >> 1 = 01000000 (128 / 2 = 64)`

## 签名字符：

*   跨越值范围`-128..127 (10000000..01111111)`
*   值在低边缘溢出为：

    `-128 - 1 = 127 (10000000 - 00000001 = 01111111)`

*   值在高边溢出为：

    `127 + 1 = -128 (01111111 + 00000001 = 10000000)`

*   按位右移运算符 ( `>>`) 进行算术移位：

    `10000000 >> 1 = 11000000 (-128 / 2 = -64)`

我包含了二进制表示，以表明值包装行为是纯粹的、一致的二进制算术，并且与有符号/无符号的 char 无关（期望右移）。

**更新**

评论中提到的一些特定于实现的行为：

*   char != 有符号字符。没有“signed”或“unsinged”的“char”类型是实现定义的，这意味着它可以像有符号或无符号类型一样工作。
*   [有符号整数溢出导致程序可以做任何事情的未定义行为，包括转储内核或溢出缓冲区。](http://www.gnu.org/software/autoconf/manual/autoconf-2.67/html_node/Integer-Overflow-Basics.html#Integer-Overflow-Basics)

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-01-16T18:05:55.723

```
#include <stdio.h>

int main(int argc, char** argv)
{
    char a = 'A';
    char b = 0xFF;
    signed char sa = 'A';
    signed char sb = 0xFF;
    unsigned char ua = 'A';
    unsigned char ub = 0xFF;
    printf("a > b: %s\n", a > b ? "true" : "false");
    printf("sa > sb: %s\n", sa > sb ? "true" : "false");
    printf("ua > ub: %s\n", ua > ub ? "true" : "false");
    return 0;
}

[root]# ./a.out
a > b: true
sa > sb: true
ua > ub: false 
```

排序字符串时很重要。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-16T18:34:01.063

有几个区别。最重要的是，如果您通过为其分配一个太大或太小的整数来溢出 char 的有效范围，并且 char 是有符号的，则结果值是实现定义的，甚至某些信号（在 C 中）可能会上升，就像所有有符号类型一样. 与将太大或太小的东西分配给 unsigned char 的情况相比：值环绕，您将获得精确定义的语义。例如，将 -1 分配给 unsigned char，您将获得 UCHAR_MAX。因此，只要您有一个字节，例如从 0 到 2^CHAR_BIT 的数字，您就应该真正使用 unsigned char 来存储它。

传递给可变参数函数时，该符号也会有所不同：

```
char c = getSomeCharacter(); // returns 0..255
printf("%d\n", c); 
```

假设分配给 c 的值对于 char 来说太大而无法表示，并且机器使用二进制补码。许多实现的行为适用于您为 char 分配的值太大的情况，因为位模式不会改变。如果一个 int 能够表示 char 的所有值（对于大多数实现来说都是如此），那么 char 在传递给 printf 之前将被提升为 int。因此，传递的值将是负数。提升为 int 将保留该标志。所以你会得到一个否定的结果。但是，如果 char 是无符号的，则该值是无符号的，并且提升为 int 将产生正 int。您可以使用 unsigned char，然后您将获得精确定义的行为，既可以分配给变量，也可以传递给 printf，然后打印一些积极的东西。

请注意，char、unsigned 和 signed char 都*至少有*8 位宽。不要求 char*正好是*8 位宽。但是，对于大多数系统而言，这是正确的，但对于某些系统，您会发现它们使用 32 位字符。C 和 C++ 中的字节被定义为具有 char 的大小，因此 C 中的字节也不总是正好是 8 位。

另一个区别是，在 C 中，无符号字符必须没有填充位。也就是说，如果您发现 CHAR_BIT 为 8，那么 unsigned char 的值必须在 0 .. 2^CHAR_BIT-1 的范围内。如果它是无符号的，char 也是如此。对于有符号字符，您不能假设任何值的范围，即使您知道编译器如何实现符号内容（二进制补码或其他选项），其中可能有未使用的填充位。在 C++ 中，所有三种字符类型都没有填充位。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-16T19:22:51.153

> > “一个char被签名是什么意思？”

传统上，ASCII 字符集由 7 位字符编码组成。（与 8 位 EBCIDIC 不同。）

在设计和实现 C 语言时，这是一个重大问题。（出于各种原因，例如通过串行调制解调器设备进行数据传输。）额外的位具有奇偶校验等用途。

“签名字符”恰好适合这种表示。

二进制数据 OTOH 只是取每个 8 位数据“块”的值，因此不需要符号。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-16T19:51:32.640

字节算术对于计算机图形很重要（其中 8 位值通常用于存储颜色）。除此之外，我可以想到 char 符号很重要的两种主要情况：

*   转换为更大的 int
*   比较函数

讨厌的是，如果你所有的字符串数据都是 7 位的，这些就不会咬你。但是，如果您试图使您的 C/C++ 程序 8 位干净，那么它肯定会成为无休止的错误来源。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-04-16T17:33:03.953

`char`Signedness 在s 中的工作方式与在其他整数类型中的工作方式几乎相同。正如您所指出的，字符实际上只是一字节整数。（但*不一定是 8-bit*！有区别；在某些平台上，一个字节可能大于 8 位，并且由于and`char`的定义， s 与字节相当相关。在or C++'s中定义的宏会告诉你有多少位。）。`char``sizeof(char)``CHAR_BIT``<limits.h>``<climits>``char`

至于为什么你想要一个带符号的字符：在 C 和 C++ 中，没有称为`byte`. 对于编译器，`char`s 是字节，反之亦然，它不区分它们。但是，有时您想要——有时您*希望*它`char`是一个单字节数字，在这些情况下（特别是一个字节的范围可以有多小），您通常还关心该数字是否有符号。我个人使用有符号（或无符号）来表示某个`char`是（数字）“字节”而不是字符，并且它将以数字形式使用。如果没有指定的符号，那`char`确实是一个字符，并且旨在用作文本。

我曾经这样做过，而不是。现在，较新版本的 C 和 C++ 具有`(u?)int_least8_t`（目前在`<stdint.h>`or中的 typedef'd `<cstdint>`），它们更明确地是数字的（尽管它们通常只是有符号和无符号`char`类型的 typedef）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-16T18:05:52.197

我可以想象这是一个问题的唯一情况是，如果您选择对字符进行数学运算。编写以下代码是完全合法的。

```
char a = (char)42;
char b = (char)120;
char c = a + b; 
```

根据 char 的符号，c 可能是两个值之一。如果 char 是无符号的，则 c 将为 (char)162。如果它们已签名，那么它将出现溢出情况，因为已签名字符的最大值为 128。我猜大多数实现只会返回 (char)-32。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-16T18:39:26.840

关于签名字符的一件事是您可以测试 c >= ' ' (空格) 并确保它是正常的可打印 ascii 字符。当然，它不是便携式的，所以不是很有用。

# wcf - 通过 WCF 下载文件比通过 IIS 慢

> ID：451376
> 
> 赞同：11
> 
> 时间：2009-01-16T18:02:00.893
> 
> 标签：wcf, streaming

下面的方法（我希望在这篇文章中大大简化它的同时没有犯任何错误）工作正常，并通过 net.tcp 协议使用流传输模式进行设置。问题是性能比通过 IIS 通过 http 下载相同的文件要差得多。为什么会这样，我可以改变什么来提高性能？

```
Stream WebSiteStreamedServiceContract.DownloadFile( string filePath ) {
    return File.OpenRead( filePath );
} 
```

最后，WCF 是否负责正确处理我的流，它在这方面做得好吗？如果没有，我应该怎么做？

谢谢你。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-09-08T23:52:13.297

在解决此问题 8 个月后，其中 3 个月与 Microsoft 合作，这是解决方案。简短的回答是服务器端（发送大文件的端）需要使用以下内容进行绑定：

```
 <customBinding>
  <binding name="custom_tcp">
   <binaryMessageEncoding />
   <tcpTransport connectionBufferSize="256192" maxOutputDelay="00:00:30" transferMode="Streamed">
   </tcpTransport>
  </binding>
 </customBinding> 
```

这里的关键是 connectionBufferSize 属性。可能需要设置其他几个属性（maxReceivedMessageSize 等），但 connectionBufferSize 是罪魁祸首。

无需在服务器端更改任何代码。

无需在客户端更改任何代码。

无需在客户端更改任何配置。

这是长答案：

我一直怀疑 net.tcp over WCF 速度慢的原因是因为它非常频繁地发送小块信息而不是不经常发送大块信息，这使得它在高延迟网络（互联网）上表现不佳。事实证明这是真的，但要到达那里还有很长的路要走。

netTcpBinding 上有几个属性听起来很有希望：maxBufferSize 是最明显的，maxBytesPerRead 和其他听起来也很有希望。除此之外，可以在客户端和服务器端创建比原始问题中的流更复杂的流 - 您也可以在那里指定缓冲区大小。问题是这些都没有任何影响。一旦你使用了 netTcpBinding，你就会被淹没。

原因是在 netTcpBinding 上调整 maxBufferSize 会调整协议层上的缓冲区。但是您对 netTcpBinding 所做的任何事情都不会调整底层传输层。这就是为什么我们这么长时间都未能取得进展。

自定义绑定解决了这个问题，因为增加传输层上的 connectionBufferSize 会增加一次发送的信息量，因此传输对延迟的影响要小得多。

在解决这个问题时，我确实注意到 maxBufferSize 和 maxBytesPerRead 确实对低延迟网络（和本地）产生了性能影响。Microsoft 告诉我 maxBufferSize 和 connectionBufferSize 是独立的，并且它们的值的所有组合（彼此相等，maxBufferSize 大于 connectionBufferSize，maxBufferSize 小于 connectionBufferSize）都是有效的。我们取得了 65536 字节的 maxBufferSize 和 maxBytesPerRead 的成功。不过，这对高延迟网络性能（最初的问题）影响很小。

如果您想知道 maxOutputDelay 的用途，它是分配给在框架引发 IO 异常之前填充连接缓冲区的时间量。因为我们增加了缓冲区大小，所以我们也增加了分配给填充缓冲区的时间。

使用这个解决方案，我们的性能提高了大约 400%，现在比 IIS 略好。还有其他几个因素会影响 IIS over HTTP 和 WCF over net.tcp（以及 WCF over http，就此而言）的相对和绝对性能，但这是我们的经验。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-17T16:49:32.943

我不知道您的第一个问题的答案（我认为您需要提供更多代码来显示您为两个测试所做的工作），但是您关于流处理的第二个问题，答案是您需要自己做。

[这是一个出色的博客条目](http://blogs.thinktecture.com/buddhike/archive/2007/09/06/414936.aspx)，其中包含一些用于此目的的出色代码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-09-07T15:26:02.587

我接受了@Greg-Smalter`ConnectionBufferSize`关于`NetTcpBinding`使用反射的建议和更改，这解决了我的问题。流式传输大型文档现在正在快速尖叫。这是代码。

```
 var transport = binding.GetType().GetField("transport", BindingFlags.NonPublic | BindingFlags.Instance)
            ?.GetValue(binding);

        transport?.GetType().GetProperty("ConnectionBufferSize", BindingFlags.Public | BindingFlags.Instance)?.SetValue(transport, 256192); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-11-28T02:43:34.137

这是另一种无需处理反射的方法。只需`NetTcpBinding`换成`CustomBinding`.

```
var binding = new CustomBinding(new NetTcpBinding
{
     MaxReceivedMessageSize = 2147483647,
     MaxBufferSize = 2147483647,
     MaxBufferPoolSize = 2147483647,
     ReceiveTimeout = new TimeSpan(4, 1, 0),
     OpenTimeout = new TimeSpan(4, 1, 0),
     SendTimeout = new TimeSpan(4, 1, 0),
     CloseTimeout = new TimeSpan(4, 1, 0),
     ReaderQuotas = XmlDictionaryReaderQuotas.Max,
     Security =
            {
                Mode = SecurityMode.None,
                Transport = {ClientCredentialType = TcpClientCredentialType.None}
            },
            TransferMode = TransferMode.Streamed,
            HostNameComparisonMode = HostNameComparisonMode.StrongWildcard
        });

binding.Elements.Find<TcpTransportBindingElement>().ConnectionBufferSize = 665600; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-04-26T14:11:11.353

上述基于反射的答案确实对我们有用。如果您需要通过托管的 IIS/WCF 服务执行此操作；您可以使用神奇的配置函数声明来访问绑定来执行此操作：

```
public static void Configure(ServiceConfiguration config)  
{  
    NetTcpBinding tcpBinding = new NetTcpBinding { /* Configure here */ };

    var transport = tcpBinding.GetType().GetField("transport", BindingFlags.NonPublic | BindingFlags.Instance)
            ?.GetValue(tcpBinding);
    transport?.GetType().GetProperty("ConnectionBufferSize", BindingFlags.Public | BindingFlags.Instance)?.SetValue(transport, 256192);

    ServiceEndpoint se = new ServiceEndpoint(ContractDescription.GetContract(typeof(IService)), tcpBinding , new EndpointAddress("net.tcp://uri.foo/bar.svc"))
    {
        ListenUri = new Uri("net.tcp://uri.foo/bar.svc")
    };

    config.AddServiceEndpoint(se);

    config.Description.Behaviors.Add(new ServiceMetadataBehavior { HttpGetEnabled = true });  
    config.Description.Behaviors.Add(new ServiceDebugBehavior { IncludeExceptionDetailInFaults = true });  
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-04-19T17:39:46.887

感谢您在这篇文章中提供的信息。关于这个问题的信息并不多。我想添加一些可能对其他人有帮助的额外细节。

这里的大多数响应似乎表明人们正在使用单个 NetTcp 端点，或者他们没有在 IIS 中托管 WCF。

如果您在同一个 wcf 服务中使用多个 netTcp 端点并将其托管在 IIS 中，或者使用使用 WAS 的容器，您可能会遇到这些问题。

1.  如果您更改一个 NetTcp 端点的 ConnectionBufferSize，则它们都必须更改并且它们必须是相同的值。显然，这是在 WAS 中托管时的要求（这是 IIS 使用的）。（[https://docs.microsoft.com/en-us/dotnet/framework/wcf/feature-details/how-to-host-a-wcf-service-in-was](https://docs.microsoft.com/en-us/dotnet/framework/wcf/feature-details/how-to-host-a-wcf-service-in-was)）如果您是自我，显然这不是问题- 托管网络服务，但我还没有验证这一点。因此，如果您为一个 NetTcp 添加了 customBinding，但您收到有关缺少 TransportManager 的激活异常，这就是您的问题。
2.  我无法使用神奇的配置方法来实现这一点。即使基本的 NetTcp 绑定没有太大变化，我也得到了一个空响应对象。我确信有办法解决这个问题，但我没有时间继续深入研究这个问题。
3.  对我有用的方法是使用 customBinding。如果您使用带有 Windows 身份验证的传输安全性，您可以添加`<windowsStreamSecurity />` 所以绑定最终看起来像这样：

```
<binding name="CustomTcpBinding_ServerModelStreamed">
     <windowsStreamSecurity />
     <binaryMessageEncoding />
     <tcpTransport connectionBufferSize="5242880" maxReceivedMessageSize="2147483647" maxBufferSize ="2147483647" transferMode="Streamed" />
</binding> 
```

您不必更改客户端 NetTcp 配置，当然，前提是您不使用此处未反映的任何附加功能。对于 customBinding，部分的顺序很重要。[https://docs.microsoft.com/en-us/dotnet/framework/wcf/extending/custom-bindings](https://docs.microsoft.com/en-us/dotnet/framework/wcf/extending/custom-bindings)

# javascript - 有没有一种惯用的方式来使用 Prototype 库来监听 DOM 的变化？

> ID：451380
> 
> 赞同：2
> 
> 时间：2009-01-16T18:04:00.297
> 
> 标签：javascript, events, dom, prototypejs, listener

我正在尝试为 DOM 更改事件添加一个侦听器。我希望像 'dom:loaded' 这样简单的东西被烘焙到 Prototype 中。我不确定处理这个问题的“原型方式”。

编辑：我无法控制可能更改 DOM 的每种情况，因此我无法在每次 DOM 更改时触发自定义事件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-16T19:46:04.490

没有标准的处理程序来观察这个。但是，您可以在 Prototype 中触发自定义事件。结合 Function.wrap，您应该能够完全按照您的需要进行操作。

本质上，你可以使用任何可以修改 DOM 的函数，比如 Element.insert()，然后用一个触发你的 change 事件的函数来包装它：

```
Element.prototype.insert = Element.prototype.insert.wrap(
function(original) {
    var ret = original.call(this, $A(arguments).slice(1));
    document.fire('dom:changed');
}.bind(this)
); 
```

现在，无论何时调用 Element.insert，它都会触发 'dom:changed'，可以使用 Event.observe() 进行观察。

我不能保证我刚刚写的内容是 100% 完美，也不能保证 100% 通用，但它应该让你开始。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-16T19:29:32.450

我建议您从原型文档中查看[Event.observe的文档。](http://prototypejs.org/api/event/observe)

作为使用 dom:loaded 的示例

```
document.observe("dom:loaded", function() {     
                // Some Javascript Code
                  }); 
```

还有一个 Event.observe 的例子

```
$('step_anchor_' + i).observe('click', function(a, b){
        return function(){pm.loadData(a, b, true)};
            }(profile.steps[i].action, profile.steps[i].dao_id)
                   ); 
```

我应该指出，显然文档还有一个观察功能，专门用于监听整个文档上的事件，例如 dom:loaded。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-04-07T19:39:47.497

我认为这里是合适的答案：[JavaScript 可以在每个 Dom 元素上侦听“onDomChange”吗？](https://stackoverflow.com/questions/1324647/can-javascript-listen-for-ondomchange-on-every-dom-elements). 查看 DOMSubtreeModified、DOMNodeInserted 等。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-16T20:42:35.437

$(element).observe('click', function(event) { someFunction(event); } ); //someFunction 将在点击事件上被调用。这可以更改为任何其他事件。

[http://prototypejs.org/api](http://prototypejs.org/api)

去元素看更多。

# java - 在编译时删除某些 Java 类的使用

> ID：451385
> 
> 赞同：2
> 
> 时间：2009-01-16T18:05:42.290
> 
> 标签：java, preprocessor

我正在寻找一种在编译时删除特定类的所有用途的方法，包括类本身。基本上是一种预处理形式，但我想这样做而不必用`#ifdebug ... #endif`.

有没有任何基于蚂蚁的工具可以做到这一点？如果没有，谁能指出我如何编写这样一个工具的正确方向？（我知道这不是一项小事，但如果它是唯一的选择......）

情况是我有一个用于调试函数调用的辅助类。这是在函数开始时实例化的，并在结束时进行调用。这是一个 JavaME 应用程序，所以我担心这会增加性能的开销。我已经有一个发布和调试版本，其中包含使用 ProGuard 的预处理器指令，所以我想从发布版本中排除使用这个帮助类。使用 ProGuard 似乎无法做到这一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-16T18:25:15.840

“这是在函数开始时实例化的，并在结束时进行调用。”

如果这遍及您的代码，您可能需要查看 AOP。

或助手类的状态设计模式，在测试模式下它做一件事，但在生产中它做另一件事（就像什么都没有）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-16T18:24:36.590

你知道这个调试代码会使 JavaME 应用程序变慢吗？您还可以尝试创建一种方法来有条件地调用这些调试方法。

还有一些想法……我从未编写过 JavaME 应用程序，但我认为有办法在实际设备上运行/测试。鉴于这种运行/测试方式，也许您可​​以使用 Eclipse/Netbeans 来调试您的代码并使用正确的断点，而不是以编程方式跟踪方法调用。在这种情况下，对已编译的代码没有损害。还可以考虑使用 AspectJ 来跟踪方法调用，这可以在编译代码后有条件地完成，因为 AspectJ 直接更改字节码（不确定这如何与 JavaME 一起使用）。最后，我听说有人在 Java 上使用标准的 GNU C/C++ 预处理器。我不知道它是否有效，谷歌会帮助你。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-16T18:35:34.087

不完全是您想要的，但是...
您可以将代码分离为模块（在您的情况下为核心和调试），然后确保模块通过反射相互调用：使用核心中可用的接口，在核心中创建一个包装类将通过反射细节隐藏对象实例化/然后，在生产中，如果实例化失败/当您设置特定标志时，只需省略调试代码并让包装器“什么都不做”。

这样，您的调试类就不会投入生产，并且您不必“静态链接”到它们，因此您的核心生产代码不会关心。当然，这只有在您的调试代码对核心代码没有可见的副作用时才有可能，但似乎就是您的情况（根据您的问题描述）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-16T18:41:32.000

是否可以在应用程序启动时只创建一次类，而不是为每个方法创建一个实例？您的调试类可能如下所示：

```
public class Debug // maybe make this a *gasp* singleton?
{
    public static void start(); // called at start of method
    public static void end();   // called at end, probably should be in a finally block

    public static void setDebugMode(boolean debugOn); // turn off for production mode
} 
```

在测试中将调试模式设置为“true”，在生产中设置为“false”。当调试模式关闭时，任何方法都不做任何事情（当然，除了检查调试模式的状态）。

您不会避免函数调用的开销，并且您确实需要检查该布尔值的状态，但您确实可以避免跳过箍试图完全避免加载类。

如果您也有一个多线程应用程序，这将需要更多的工作。

# ruby-on-rails - 如何使用 Rails 脚本/服务器测试 HTTPS？

> ID：451395
> 
> 赞同：9
> 
> 时间：2009-01-16T18:08:17.153
> 
> 标签：ruby-on-rails, testing, https

我需要在开发中测试与本地 Rails 脚本/服务器实例的 HTTPS 连接，它似乎不受支持，而且我无法通过 Google 搜索任何解决方案。

从客户端的角度来看，它是这样的：

```
ted@teflon-ted ~/Downloads[master]$ grep tedslaptop /etc/hosts
127.0.0.1 api.tedslaptop.com
ted@teflon-ted ~/Downloads[master]$ /usr/bin/curl https://api.tedslaptop.com:3000/
curl: (35) 连接到 api.tedslaptop.com:3000 的未知 SSL 协议错误

```

这是我在服务器上看到的：

```
$脚本/服务器
=> 引导 Mongrel（使用 'script/server webrick' 强制 WEBrick）
=> Rails 2.2.2 应用程序从 http://0.0.0.0:3000 开始
=> 使用 -d 调用以分离
=> Ctrl-C 关闭服务器
** 在 0.0.0.0:3000 开始 Mongrel 监听
** 使用开发环境启动 Rails...
** 导轨已加载。
** 加载任何特定于 Rails 的 GemPlugins
** 信号准备就绪。期限 => 停止。USR2 => 重启。INT => 停止（不重新启动）。
** Rails 信号已注册。HUP => 重新加载（无需重新启动）。它可能无法正常工作。
** Mongrel 1.1.5 在 0.0.0.0:3000 可用
** 使用 CTRL-C 停止。
2009 年 1 月 16 日星期五 13:06:50 -0500：HTTP 解析错误，格式错误的请求 (127.0.0.1)：#
2009 年 1 月 16 日星期五 13:06:50 -0500：请求数据：“\200d\001\003\001\000K\000\000\000\020\000\0009\000\0008\000\0005\000\000 \026\000\000\023\000\000\n\a\000?\0003\000\0002\000\000/\003\000\200\000\000\005\000\000\004\001 \000\200\000\000\025\000\000\022\000\000\t\006\000@\000\000\024\000\000\021\000\000\b\000\000\ 006\004\000\200\000\000\003\002\000\200xa\377\\?wEM??/\235F\020\232"
---
参数：{}
---

```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-17T11:11:37.617

HTTPS 是在 Rails 框架之外处理的。因此，您不能直接对其进行测试。Rails 应用程序提供的功能在 HTTPS 上应该与在未加密的 HTTP 上完全相同。

script/server 使用 Mongrel 来满足您的请求。Mongrel 不直接支持 SSL/HTTPS。

如果您真的想测试 HTTPS 功能，您必须设置支持 SSL/HTTPS 的 Apache（或其他网络服务器）（使用`mod_ssl`），并将其配置为运行您的 Rails 应用程序（使用`mod_rails`或`mod_proxy`）。

# sql-server - 有没有办法将两个矩阵的值相加以获得“总计”？

> ID：451396
> 
> 赞同：2
> 
> 时间：2009-01-16T18:08:21.770
> 
> 标签：sql-server, reporting-services

我在 SSRS 中创建了一个包含 2 个矩阵（不是表/列表）的报告，每个矩阵都有一个小计。我想要解决的是，是否有任何方法可以计算我的报告底部的“总计”，即我的 2 个矩阵的小计之和。

矩阵
1：10 10 10 5 10 5 5 总计 55

矩阵 2：
20 10 10 5 20 5 5 总计 75

总计：130

顺便说一句，每个矩阵都是从单独的数据源驱动的。

基本上我想要结束的是

> =sum(fields!gross.Value,"matrix1")+sum(fields!gross.Value,"matrix2")

总计，但这不起作用。

正如我所说，我是新手，因此上述语法可能不正确，但我希望它能让您了解我想要实现的目标。

这甚至可能吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-16T18:19:19.953

不要使用“matrix1”和“matrix2”，而是使用每个数据集的名称。

```
 =sum(fields!gross.Value,"Dataset1") + sum(fields!gross.Value,"Dataset2") 
```

此外，有时如果您的数据类型不明确，您将不得不像这样转换字段：

```
 sum(CDec(fields!gross.Value),"Dataset1") 
```

但在这种情况下，您可能不必这样做。

# c# - 如何使用 c# 获得最佳字体清晰度以在 HDTV 上显示？

> ID：451402
> 
> 赞同：0
> 
> 时间：2009-01-16T18:10:19.787
> 
> 标签：c#, asp.net

这是用于到达/离开航班显示。由于字体模糊，显示屏难以阅读。当前状态是在 HDTV 上使用 Internet Explorer 显示的 asp.net 页面。

从软件方面，我可以做些什么来制作好看的字体？我注意到即使在较小的分辨率下，PowerPoint 演示文稿也能很好地呈现字体。重构为 Windows 应用程序是一种选择。

注意：我知道硬件存在问题需要解决，但我想确保我显示的字体最好。当前的硬件设置是一个 vga 输出到硬件以转换为分量视频和一条长电缆连接到 hdtv。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-16T18:16:00.337

使用[ClearType](http://blogs.msdn.com/ie/archive/2006/02/03/524367.aspx)。

如果它`LCD`与`DVI`或连接`VGA`，请将其设置为原始分辨率。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-16T18:19:34.087

如果 powerpoint 看起来不错，那么我可以假设您的显示器设置得相当好。确保在 IE 中的工具/Internet 选项/高级下选中**始终使用 ClearType for HTML 。**

请注意，您需要重新启动浏览器才能使其生效。

编辑：要知道什么时候做对了，请加载看起来不错的 PowerPoint，并在您的 Web 应用程序中使用完全相同的字体。然后将它们并排比较，以便您知道它们何时看起来完全相同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-16T18:16:35.107

你确定它与实际的软件有关吗？您是否检查了与 HDTV 的连接、使用的分辨率、HDTV 使用的任何升级以将传入的数字信号获取到可能更大数量的显示像素？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-16T18:16:41.643

这不是在软件方面，但字体可读性的最大因素可能是显示器是否在显示器和源之间以 1:1 像素映射显示图片，并且没有[过度扫描](http://en.wikipedia.org/wiki/Overscan)并导致不必要的插值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-17T16:10:43.457

> 当前的硬件设置是一个 vga 输出到硬件以转换为分量视频和一条长电缆连接到 hdtv。

还有一件事：通常，分量视频有几种预定义的分辨率，即：720x576 (576p)、1280x720 (720p) 和 1920x1080 (1080p)。

`VGA -> YPrPb`您的硬件似乎重新调整了图片的比例。

将您的`VGA`分辨率设置为上述之一。

# mysql - mysqldump和single-transaction在同时使用DDL时如何获取正确的dump？

> ID：451404
> 
> 赞同：6
> 
> 时间：2009-01-16T18:10:50.313
> 
> 标签：mysql, mysqldump, corruption

我是 MySQL 新手，我正在寻找使用`mysqldump`. [此页面](http://dev.mysql.com/doc/refman/5.1/en/backup-policy.html)建议使用此命令行：

```
mysqldump --single-transaction --flush-logs --master-data=2
          --all-databases > backup_sunday_1_PM.sql 
```

但是...如果您仔细阅读文档，[您会发现](http://dev.mysql.com/doc/refman/5.1/en/mysqldump.html#option_mysqldump_single-transaction)：

> 在`--single-transaction`转储过程中，为确保转储文件有效（正确的表内容和二进制日志位置），其他连接不应使用以下语句：`ALTER TABLE, DROP TABLE, RENAME TABLE, TRUNCATE TABLE`. 一致性读取与这些语句并不隔离，因此在要转储的表上使用它们可能会导致`SELECT`执行者`mysqldump`检索表内容获取不正确的内容或失败。

那么，有什么方法可以防止这种可能的转储损坏情况？即可以暂时阻止这些语句的命令。

PS：关于这个主题的 MySQL 错误条目[http://bugs.mysql.com/bug.php?id=27850](http://bugs.mysql.com/bug.php?id=27850)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-23T21:30:37.717

打开`mysql`命令窗口并发出以下命令：

```
mysql> FLUSH TABLES WITH READ LOCK; 
```

这将锁定此 MySQL 实例上*所有数据库中的**所有*表，直到您发出（或终止持有这些读锁的客户端连接）。*`UNLOCK TABLES`*

 *要确认这一点，您可以打开另一个命令窗口并尝试执行`ALTER`、`DROP`或。这些命令挂起，等待读取锁被释放。按 Ctrl-C 终止等待。`RENAME``TRUNCATE`

但是，虽然表具有读锁，但您仍然可以执行`mysqldump`备份。

该`FLUSH TABLES WITH READ LOCK`命令*可能*与使用 的`--lock-all-tables`选项相同`mysqldump`。这并不完全清楚，但[这个文档](http://dev.mysql.com/doc/refman/5.1/en/lock-tables.html)似乎支持它：

> UNLOCK TABLES 的另一个用途是释放使用 FLUSH TABLES WITH READ LOCK 获得的全局读锁。

两者都`FLUSH TABLES WITH READ LOCK`使用`--lock-all-tables`“全局读锁”这个短语，所以我认为它们很可能会做同样的事情。因此，您应该能够使用该选项来`mysqldump`防止并发 ALTER、DROP、RENAME 和 TRUNCATE。

* * *

关于。您的评论：以下来自您链接到的 MySQL 错误日志中的 Guilhem Bichot：

> 你好。--lock-all-tables 调用 FLUSH TABLES WITH READ LOCK。因此，预计会阻止 ALTER、DROP、RENAME 或 TRUNCATE（除非有错误或我错了）。但是， --lock-all-tables --single-transaction 不能工作（mysqldump 会抛出错误消息）：因为 lock-all-tables 在备份期间锁定服务器的所有表以防止写入，而单事务是旨在让写入发生在备份期间（通过在事务中使用一致读取 SELECT），它们本质上是不兼容的。

由此看来，您在备份期间无法获得并发访问，并同时阻止 ALTER、DROP、RENAME 和 TRUNCATE。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-02-19T03:39:57.487

我认为阅读文档的那部分内容是一样的，但我发现了更多信息：

4.5.4\. mysqldump — 数据库备份程序 [http://dev.mysql.com/doc/en/mysqldump.html](http://dev.mysql.com/doc/en/mysqldump.html)

> 对于 InnoDB 表，mysqldump 提供了一种进行在线备份的方法：
> 
> ```
> shell> mysqldump --all-databases --single-transaction > all_databases.sql 
> ```
> 
> 此备份在转储开始时获取所有表的全局读锁（使用 FLUSH TABLES WITH READ LOCK）。一旦获得了这个锁，就会读取二进制日志坐标并释放锁。如果在发出 FLUSH 语句时正在运行长更新语句，MySQL 服务器可能会停止，直到这些语句完成。之后，转储变为无锁并且不会干扰对表的读取和写入。如果 MySQL 服务器接收到的更新语句很短（就执行时间而言），那么即使有很多更新，初始锁定周期也不应该是明显的。

[`--opt`](https://dev.mysql.com/doc/refman/5.1/en/mysqldump.html#option_mysqldump_opt)和[`--single-transaction`](https://dev.mysql.com/doc/refman/5.1/en/mysqldump.html#option_mysqldump_single-transaction)选项有冲突：

> - 选择
> 
> 此选项是简写。与指定 --add-drop-table --add-locks --create-options --disable-keys --extended-insert --lock-tables --quick --set-charset 相同。它应该给你一个快速的转储操作并生成一个可以快速重新加载到 MySQL 服务器的转储文件。
> 
> --opt 选项默认启用。使用 --skip-opt 禁用它。

如果我正确理解您的问题，您希望将实际数据和 DDL（数据定义语言）放在一起，因为如果您只想要 DDL，您将使用`--no-data`. 有关这方面的更多信息，请访问：

[http://dev.mysql.com/doc/workbench/en/wb-reverse-engineer-create-script.html](http://dev.mysql.com/doc/workbench/en/wb-reverse-engineer-create-script.html)

> 如果您希望创建数据库及其所有对象，请使用 --databases 选项和 mysqldump。如果脚本文件中没有 CREATE DATABASE db_name 语句，则必须将数据库对象导入现有模式，或者，如果没有模式，则创建新的未命名模式。

正如[Michael Kofler 的 The Definitive Guide to MySQL 5](http://books.google.com/books?id=s_87mv-Eo4AC&lpg=PA686&ots=tc_AEaNJxe&dq=%22--opt%20--single-transaction%22&pg=PA354#v=onepage&q=%22--opt%20--single-transaction%22&f=false)所建议的那样，我建议以下选项：

```
--skip-opt
--single-transaction
--add-drop-table
--create-options
--quick
--extended-insert
--set-charset
--disable-keys 
```

此外，[`--order-by-primary`](https://stackoverflow.com/a/2031061/1815624) 如果您正在使用该[`--databases`](https://dev.mysql.com/doc/refman/5.1/en/mysqldump.html#option_mysqldump_databases)选项，则还应该使用该选项，[`--add-drop-database`](https://dev.mysql.com/doc/refman/5.1/en/mysqldump.html#option_mysqldump_add-drop-database)尤其是与此[答案](https://stackoverflow.com/a/16508576/1815624)结合使用时。如果您要备份连接在不同网络上的数据库，则可能需要使用该[`--compress`](https://dev.mysql.com/doc/refman/5.1/en/mysqldump.html#option_mysqldump_compress)选项。

因此 mysqldump 命令（不使用`--compress`、`--databases`或`--add-drop-database`选项）将是：

```
mysqldump --skip-opt --order-by-primary --single-transaction --add-drop-table --create-options --quick --extended-insert --set-charset -h db_host -u username --password="myPassword" db_name | mysql --host=other_host db_name 
```

我删除了`--disable-keys`书中给出的参考，因为据我了解，它对 InnoDB 无效。[MySql 手册](https://dev.mysql.com/doc/refman/5.6/en/mysqldump.html#option_mysqldump_disable-keys)指出：

> *对于每个表，用 /*!40000 ALTER TABLE tbl_name DISABLE KEYS /;*包围 INSERT 语句 *和 /* !40000 ALTER TABLE tbl_name ENABLE KEYS */; 陈述。这使得加载转储文件更快，因为索引是在插入所有行之后创建的。此选项仅对 MyISAM 表的非唯一索引有效。

我还发现了这个错误报告[http://bugs.mysql.com/bug.php?id=64309](http://bugs.mysql.com/bug.php?id=64309)，它在底部有来自[Paul DuBois 的评论，他还写了几本书](http://www.amazon.com/gp/search/ref=sr_adv_b/?search-alias=stripbooks&field-author=Paul%20DuBois)，除了这个特定问题我没有参考在该错误报告中找到的那些评论。

现在要创建“**终极备份**”，我建议考虑一下这个 shell 脚本的内容

1.  [https://github.com/red-ant/mysql-svn-backup/blob/master/mysql-svn.sh](https://github.com/red-ant/mysql-svn-backup/blob/master/mysql-svn.sh)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-05-12T14:48:39.483

如果不锁定表，您将无法获得一致的转储。我只是在一天中没有注意到转储所需的 2 分钟的时间里做我的。

一种解决方案是进行复制，然后备份从属服务器而不是主服务器。如果从服务器在备份期间错过了写入，它将稍后赶上。这也将为您提供一个实时备份服务器，以防主服务器发生故障。这很好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-02-18T13:57:53.767

嗨，任何答案都晚了，但解决方案通过 BACKUP STAGE 到达 MariaDB，开源时间是相对主义的 :)

# scripting - 制作/制作文件进度指示！

> ID：451413
> 
> 赞同：28
> 
> 时间：2009-01-16T18:13:59.030
> 
> 标签：scripting, makefile, build-automation, progress-bar

**看看这个makefile，它有某种原始的进度指示（可能是一个进度条）。**

**请给我建议/意见！**

* * *

```
# BUILD 最初是未定义的
ifndef 构建

# 最大值等于 256 x
十六 := xxxxxxxxxxxxxxxx
MAX := $(foreach x,$(十六),$(十六))

# T 通过用特殊字符串替换 BUILD 来估计我们正在构建的目标数量
T := $(shell $(MAKE) -nrRf $(firstword $(MAKEFILE_LIST)) $(MAKECMDGOALS) \
            建立=“计数”| grep -c "计数")

# N 是基数为 1 的待处理目标的数量，实际上，基数 x :-)
N := $(单词表 1,$T,$(MAX))

# 自动递减计数器，返回以 10 为底的挂起目标的数量
计数器 = $(words $N)$(eval N := $(wordlist 2,$(words $N),$N))

# 现在定义BUILD来显示进度，这也避免了在循环中重新定义T
构建 = @echo $(counter) of $(T)
万一

# 虚拟目标

.PHONY：全部干净

全部：目标
    @echo 完成

干净的：
    @rm -f 目标 *.c

# 虚拟构建规则

目标：ac bc cc dc ec fc gc
    @触摸 $@
    $（建立）

％。C：
    @触摸 $@
    $（建立）

```

* * *

**欢迎所有建议！**

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-18T16:19:54.743

这个不那么侵入性，而且更棒。

```
ifneq ($(words $(MAKECMDGOALS)),1)
.DEFAULT_GOAL = all
%:
        @$(MAKE) $@ --no-print-directory -rRf $(firstword $(MAKEFILE_LIST))
else
ifndef ECHO
T := $(shell $(MAKE) $(MAKECMDGOALS) --no-print-directory \
      -nrRf $(firstword $(MAKEFILE_LIST)) \
      ECHO="COUNTTHIS" | grep -c "COUNTTHIS")

N := x
C = $(words $N)$(eval N := x $N)
ECHO = echo "`expr " [\`expr $C '*' 100 / $T\`" : '.*\(....\)$$'`%]"
endif

.PHONY: all clean

all: target
        @$(ECHO) All done

clean:
        @rm -f target *.c
#       @$(ECHO) Clean done

target: a.c b.c c.c d.c e.c
        @$(ECHO) Linking $@
        @sleep 0.1
        @touch $@

%.c:
        @$(ECHO) Compiling $@
        @sleep 0.1
        @touch $@

endif 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2016-02-10T16:38:35.247

这是对@GiovanniFunchal 的优秀[答案](https://stackoverflow.com/a/455390/999943)的轻微修改。

因此，我想更好地理解这一点并使其在 < 10% 的情况下工作，因此我深入研究了[文档](http://www.gnu.org/software/make/manual/make.html)并了解了有关[expr](http://www.tldp.org/LDP/abs/html/moreadv.html#EXPRREF)的更多信息。

```
# PLACE AT THE TOP OF YOUR MAKEFILE
#---------------------------------
# Progress bar defs
#--------------------------------
#  words = count the number of words
ifneq ($(words $(MAKECMDGOALS)),1) # if no argument was given to make...
.DEFAULT_GOAL = all # set the default goal to all
#  http://www.gnu.org/software/make/manual/make.html
#  $@ = target name
#  %: = last resort recipe
#  --no-print-directory = don't print enter/leave messages for each output grouping
#  MAKEFILE_LIST = has a list of all the parsed Makefiles that can be found *.mk, Makefile, etc
#  -n = dry run, just print the recipes
#  -r = no builtin rules, disables implicit rules
#  -R = no builtin variables, disables implicit variables
#  -f = specify the name of the Makefile
%:                   # define a last resort default rule
      @$(MAKE) $@ --no-print-directory -rRf $(firstword $(MAKEFILE_LIST)) # recursive make call, 
else
ifndef ECHO
#  execute a dry run of make, defining echo beforehand, and count all the instances of "COUNTTHIS"
T := $(shell $(MAKE) $(MAKECMDGOALS) --no-print-directory \
      -nrRf $(firstword $(MAKEFILE_LIST)) \
      ECHO="COUNTTHIS" | grep -c "COUNTTHIS")
#  eval = evaluate the text and read the results as makefile commands
N := x
#  Recursively expand C for each instance of ECHO to count more x's
C = $(words $N)$(eval N := x $N)
#  Multipy the count of x's by 100, and divide by the count of "COUNTTHIS"
#  Followed by a percent sign
#  And wrap it all in square brackets
ECHO = echo -ne "\r [`expr $C '*' 100 / $T`%]"
endif
#------------------
# end progress bar
#------------------

# REST OF YOUR MAKEFILE HERE

#----- Progressbar endif at end Makefile
endif 
```

我摆脱了这`: '.*\(....\)$$'`部分。它将返回内部`expr`命令的最后 4 个字符，但如果它小于 4，则会失败。现在它适用于低于 10%！

这是评论免费版本：

```
ifneq ($(words $(MAKECMDGOALS)),1) # if no argument was given to make...
.DEFAULT_GOAL = all # set the default goal to all
%:                   # define a last resort default rule
      @$(MAKE) $@ --no-print-directory -rRf $(firstword $(MAKEFILE_LIST)) # recursive make call, 
else
ifndef ECHO
T := $(shell $(MAKE) $(MAKECMDGOALS) --no-print-directory \
      -nrRf $(firstword $(MAKEFILE_LIST)) \
      ECHO="COUNTTHIS" | grep -c "COUNTTHIS")
N := x
C = $(words $N)$(eval N := x $N)
ECHO = echo -ne "\r [`expr $C '*' 100 / $T`%]"
endif

# ...

endif 
```

希望有帮助。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2019-07-16T15:43:06.143

没有真正的问题，所以这不是一个独立的答案，更多的是对 Giovanni Funchai 的[解决方案](https://stackoverflow.com/a/455390/141023)的扩展。这个问题是“GNU Make Progress”的第一个谷歌结果，所以我最终在这里寻找如何做到这一点。

正如 Rob Wells 所指出的，该解决方案不适用于 <10%，但该技术可以通过帮助脚本以您认为对于您的构建而言足够便携的任何语言完成的打印格式进行扩展。例如，使用 python 辅助脚本：

`echo_progress.py`：

```
"""
Print makefile progress
"""

import argparse
import math
import sys

def main():
  parser = argparse.ArgumentParser(description=__doc__)
  parser.add_argument("--stepno", type=int, required=True)
  parser.add_argument("--nsteps", type=int, required=True)
  parser.add_argument("remainder", nargs=argparse.REMAINDER)
  args = parser.parse_args()

  nchars = int(math.log(args.nsteps, 10)) + 1
  fmt_str = "[{:Xd}/{:Xd}]({:6.2f}%)".replace("X", str(nchars))
  progress = 100 * args.stepno / args.nsteps
  sys.stdout.write(fmt_str.format(args.stepno, args.nsteps, progress))
  for item in args.remainder:
    sys.stdout.write(" ")
    sys.stdout.write(item)
  sys.stdout.write("\n")

if __name__ == "__main__":
  main() 
```

和修改`Makefile`：

```
_mkfile_path := $(abspath $(lastword $(MAKEFILE_LIST)))
I := $(patsubst %/,%,$(dir $(_mkfile_path)))

ifneq ($(words $(MAKECMDGOALS)),1)
.DEFAULT_GOAL = all
%:
    @$(MAKE) $@ --no-print-directory -rRf $(firstword $(MAKEFILE_LIST))
else
ifndef ECHO
T := $(shell $(MAKE) $(MAKECMDGOALS) --no-print-directory \
      -nrRf $(firstword $(MAKEFILE_LIST)) \
      ECHO="COUNTTHIS" | grep -c "COUNTTHIS")
N := x
C = $(words $N)$(eval N := x $N)
ECHO = python $(I)/echo_progress.py --stepno=$C --nsteps=$T
endif

.PHONY: all clean

all: target
    @$(ECHO) All done

clean:
    @rm -f target *.c
#       @$(ECHO) Clean done

target: a.c b.c c.c d.c e.c f.c g.c h.c i.c j.c k.c l.c m.c n.c o.c p.c q.c \
        r.c s.c t.c u.c v.c w.c x.c y.c z.c
    @$(ECHO) Linking $@
    @sleep 0.01
    @touch $@

%.c:
    @$(ECHO) Compiling $@
    @sleep 0.01
    @touch $@

endif 
```

产量：

```
$ make
[ 1/28](  3.57%) Compiling a.c
[ 2/28](  7.14%) Compiling b.c
[ 3/28]( 10.71%) Compiling c.c
[ 4/28]( 14.29%) Compiling d.c
[ 5/28]( 17.86%) Compiling e.c
[ 6/28]( 21.43%) Compiling f.c
[ 7/28]( 25.00%) Compiling g.c
[ 8/28]( 28.57%) Compiling h.c
[ 9/28]( 32.14%) Compiling i.c
[10/28]( 35.71%) Compiling j.c
[11/28]( 39.29%) Compiling k.c
[12/28]( 42.86%) Compiling l.c
[13/28]( 46.43%) Compiling m.c
[14/28]( 50.00%) Compiling n.c
[15/28]( 53.57%) Compiling o.c
[16/28]( 57.14%) Compiling p.c
[17/28]( 60.71%) Compiling q.c
[18/28]( 64.29%) Compiling r.c
[19/28]( 67.86%) Compiling s.c
[20/28]( 71.43%) Compiling t.c
[21/28]( 75.00%) Compiling u.c
[22/28]( 78.57%) Compiling v.c
[23/28]( 82.14%) Compiling w.c
[24/28]( 85.71%) Compiling x.c
[25/28]( 89.29%) Compiling y.c
[26/28]( 92.86%) Compiling z.c
[27/28]( 96.43%) Linking target
[28/28](100.00%) All done 
```

甚至可以打印带有 unicode 字符的精美进度条。

修改`echo_progress.py`：

```
"""
Print makefile progress
"""

import argparse
import math
import sys

def get_progress_bar(numchars, fraction=None, percent=None):
  """
  Return a high resolution unicode progress bar
  """
  if percent is not None:
    fraction = percent / 100.0

  if fraction >= 1.0:
    return "█" * numchars

  blocks = [" ", "▏", "▎", "▍", "▌", "▋", "▊", "▉", "█"]
  length_in_chars = fraction * numchars
  n_full = int(length_in_chars)
  i_partial = int(8 * (length_in_chars - n_full))
  n_empty = max(numchars - n_full - 1, 0)
  return ("█" * n_full) + blocks[i_partial] + (" " * n_empty)

def main():
  parser = argparse.ArgumentParser(description=__doc__)
  parser.add_argument("--stepno", type=int, required=True)
  parser.add_argument("--nsteps", type=int, required=True)
  parser.add_argument("remainder", nargs=argparse.REMAINDER)
  args = parser.parse_args()

  nchars = int(math.log(args.nsteps, 10)) + 1
  fmt_str = "\r[{:Xd}/{:Xd}]({:6.2f}%) ".replace("X", str(nchars))
  progress = 100 * args.stepno / args.nsteps
  sys.stdout.write(fmt_str.format(args.stepno, args.nsteps, progress))
  sys.stdout.write(get_progress_bar(20, percent=progress))
  remainder_str = " ".join(args.remainder)
  sys.stdout.write(" {:20s}".format(remainder_str[:20]))
  if args.stepno == args.nsteps:
    sys.stdout.write("\n")

if __name__ == "__main__":
  main() 
```

这将导致这样的事情：

```
$ make clean && make
[12/28]( 42.86%) ███████▊             Compiling k.c 
```

在进度和：

```
$ make clean && make
[28/28](100.00%) ████████████████████ All done 
```

完成后。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2020-05-25T09:15:35.267

非常感谢`@Giovanni Funchal`并`@phyatt`提供问题和答案！

为了更好地理解，我只是将其简化了。

```
ifndef ECHO
HIT_TOTAL != ${MAKE} ${MAKECMDGOALS} --dry-run ECHO="HIT_MARK" | grep -c "HIT_MARK"
HIT_COUNT = $(eval HIT_N != expr ${HIT_N} + 1)${HIT_N}
ECHO = echo "[`expr ${HIT_COUNT} '*' 100 / ${HIT_TOTAL}`%]"
endif 
```

*   `!=`从 shell 命令分配
*   `=` 每次使用时评估变量
*   `eval`执行其参数而没有任何输出
*   `expr`允许进行算术计算

（不确定哪种方法更快：用 expr 调用 shell 或用 make 计算 'x'-es。）

用法是一样的：

```
target:
    @$(ECHO) $@ 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-16T18:41:02.047

好把戏！（-：

但对于分布在具有大量 makefile 的许多目录的不断增长的项目而言，它并不能真正扩展。

我更倾向于在您的项目中通过 [Mm]akefiles* 进行日志记录，并使用它来跟踪进度。

只是一个想法。顺便说一句，谢谢分享这个。

**编辑：**只是有一个想法。这在修改后的形式中可能很有用，以显示一个 throbber 以在一个长任务进行时显示进度，例如解压缩一个大型分发 tarball，而不是仅仅为 tar 命令指定 -v 选项。仍然有点糖衣，但也有点乐趣。（-：

干杯，

抢

# sql - 在 Microsoft SQL Server 2005 中模拟 group_concat MySQL 函数？

> ID：451415
> 
> 赞同：359
> 
> 时间：2009-01-16T18:14:52.570
> 
> 标签：sql, sql-server, sql-server-2005, string-aggregation

我正在尝试将基于 MySQL 的应用程序迁移到 Microsoft SQL Server 2005（不是选择，但这就是生活）。

在最初的应用程序中，我们*几乎*完全使用了符合 ANSI-SQL 的语句，但有一个明显的例外——我们`group_concat`相当频繁地使用 MySQL 的函数。

`group_concat`，顺便说一句，这样做：给定一张表，比如说，员工姓名和项目......

```
SELECT empName, projID FROM project_members; 
```

返回：

```
ANDY   |  A100
ANDY   |  B391
ANDY   |  X010
TOM    |  A100
TOM    |  A510 
```

...这就是您使用 group_concat 得到的结果：

```
SELECT 
    empName, group_concat(projID SEPARATOR ' / ') 
FROM 
    project_members 
GROUP BY 
    empName; 
```

返回：

```
ANDY   |  A100 / B391 / X010
TOM    |  A100 / A510 
```

所以我想知道的是：是否可以在 SQL Server 中编写一个用户定义的函数来模拟`group_concat`?

我几乎没有使用 UDF、存储过程或类似的东西的经验，只是直接使用 SQL，所以请在解释过多的情况下犯错：)

* * *

## 回答 #1

> 赞同：174
> 
> 时间：2009-01-16T18:22:53.770

没有真正简单的方法可以做到这一点。不过，那里有很多想法。

[我发现的最好的一个](http://blog.shlomoid.com/2008/11/emulating-mysqls-groupconcat-function.html)：

```
SELECT table_name, LEFT(column_names , LEN(column_names )-1) AS column_names
FROM information_schema.columns AS extern
CROSS APPLY
(
    SELECT column_name + ','
    FROM information_schema.columns AS intern
    WHERE extern.table_name = intern.table_name
    FOR XML PATH('')
) pre_trimmed (column_names)
GROUP BY table_name, column_names; 
```

或者如果数据可能包含字符，则可以正常工作的版本，例如`<`

```
WITH extern
     AS (SELECT DISTINCT table_name
         FROM   INFORMATION_SCHEMA.COLUMNS)
SELECT table_name,
       LEFT(y.column_names, LEN(y.column_names) - 1) AS column_names
FROM   extern
       CROSS APPLY (SELECT column_name + ','
                    FROM   INFORMATION_SCHEMA.COLUMNS AS intern
                    WHERE  extern.table_name = intern.table_name
                    FOR XML PATH(''), TYPE) x (column_names)
       CROSS APPLY (SELECT x.column_names.value('.', 'NVARCHAR(MAX)')) y(column_names) 
```

* * *

## 回答 #2

> 赞同：172
> 
> 时间：2011-05-12T17:20:27.863

我参加聚会可能有点晚了，但这种方法对我有用，而且比 COALESCE 方法更容易。

```
SELECT STUFF(
             (SELECT ',' + Column_Name 
              FROM Table_Name
              FOR XML PATH (''))
             , 1, 1, '') 
```

* * *

## 回答 #3

> 赞同：52
> 
> 时间：2016-11-19T11:01:53.337

**SQL Server 2017**确实引入了一个新的聚合函数

[`STRING_AGG ( expression, separator)`](https://msdn.microsoft.com/en-us/library/mt790580.aspx).

> 连接字符串表达式的值并在它们之间放置分隔符值。分隔符不会添加到字符串的末尾。

连接的元素可以通过附加来排序`WITHIN GROUP (ORDER BY some_expression)`

**对于 2005-2016 版本**，我通常在接受的答案中使用 XML 方法。

然而，这在某些情况下可能会失败。例如，如果要连接的数据包含`CHAR(29)`您看到

> FOR XML 无法序列化数据...因为它包含 XML 中不允许的字符 (0x001D)。

可以处理所有字符的更强大的方法是使用 CLR 聚合。然而，使用这种方法对连接的元素应用排序更加困难。

分配给变量的方法[不能保证](https://stackoverflow.com/questions/15138593/nvarchar-concatenation-index-nvarcharmax-inexplicable-behavior/15163136#15163136)，应在生产代码中避免。

* * *

## 回答 #4

> 赞同：51
> 
> 时间：2010-02-24T06:24:11.757

现在可能为时已晚，无法受益，但这不是最简单的做事方式吗？

```
SELECT     empName, projIDs = replace
                          ((SELECT Surname AS [data()]
                              FROM project_members
                              WHERE  empName = a.empName
                              ORDER BY empName FOR xml path('')), ' ', REQUIRED SEPERATOR)
FROM         project_members a
WHERE     empName IS NOT NULL
GROUP BY empName 
```

* * *

## 回答 #5

> 赞同：34
> 
> 时间：2012-12-21T18:57:05.523

看看 Github 上的[GROUP_CONCAT](https://github.com/orlando-colamatteo/ms-sql-server-group-concat-sqlclr)项目，我想我所做的正是你正在寻找的：

> 该项目包含一组 SQLCLR 用户定义的聚合函数 (SQLCLR UDA)，它们共同提供与 MySQL GROUP_CONCAT 函数类似的功能。有多种功能可确保基于所需功能的最佳性能...

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2011-06-28T15:00:11.340

要连接具有多个项目经理的项目中的所有项目经理姓名，请编写：

```
SELECT a.project_id,a.project_name,Stuff((SELECT N'/ ' + first_name + ', '+last_name FROM projects_v 
where a.project_id=project_id
 FOR
 XML PATH(''),TYPE).value('text()[1]','nvarchar(max)'),1,2,N''
) mgr_names
from projects_v a
group by a.project_id,a.project_name 
```

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2010-01-27T18:37:45.257

使用以下代码，您必须在部署之前在项目属性上设置 PermissionLevel=External，并通过运行“ALTER DATABASE database_name SET”将数据库更改为信任外部代码（请务必在其他地方阅读有关安全风险和替代方案 [如证书]）值得信赖”。

```
using System;
using System.Collections.Generic;
using System.Data.SqlTypes;
using System.IO;
using System.Runtime.Serialization;
using System.Runtime.Serialization.Formatters.Binary;
using Microsoft.SqlServer.Server;

[Serializable]
[SqlUserDefinedAggregate(Format.UserDefined,
MaxByteSize=8000,
IsInvariantToDuplicates=true,
IsInvariantToNulls=true,
IsInvariantToOrder=true,
IsNullIfEmpty=true)]
    public struct CommaDelimit : IBinarySerialize
{

[Serializable]
 private class StringList : List<string>
 { }

 private StringList List;

 public void Init()
 {
  this.List = new StringList();
 }

 public void Accumulate(SqlString value)
 {
  if (!value.IsNull)
   this.Add(value.Value);
 }

 private void Add(string value)
 {
  if (!this.List.Contains(value))
   this.List.Add(value);
 }

 public void Merge(CommaDelimit group)
 {
  foreach (string s in group.List)
  {
   this.Add(s);
  }
 }

 void IBinarySerialize.Read(BinaryReader reader)
 {
    IFormatter formatter = new BinaryFormatter();
    this.List = (StringList)formatter.Deserialize(reader.BaseStream);
 }

 public SqlString Terminate()
 {
  if (this.List.Count == 0)
   return SqlString.Null;

  const string Separator = ", ";

  this.List.Sort();

  return new SqlString(String.Join(Separator, this.List.ToArray()));
 }

 void IBinarySerialize.Write(BinaryWriter writer)
 {
  IFormatter formatter = new BinaryFormatter();
  formatter.Serialize(writer.BaseStream, this.List);
 }
    } 
```

我已经使用如下查询对此进行了测试：

```
SELECT 
 dbo.CommaDelimit(X.value) [delimited] 
FROM 
 (
  SELECT 'D' [value] 
  UNION ALL SELECT 'B' [value] 
  UNION ALL SELECT 'B' [value] -- intentional duplicate
  UNION ALL SELECT 'A' [value] 
  UNION ALL SELECT 'C' [value] 
 ) X 
```

并产生：A、B、C、D

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2010-10-07T17:52:12.537

尝试了这些，但出于我在 MS SQL Server 2005 中的目的，以下是最有用的，我在[xaprb找到了](http://www.xaprb.com/blog/2005/09/28/simulating-the-group-concat-function/)

```
declare @result varchar(8000);

set @result = '';

select @result = @result + name + ' '

from master.dbo.systypes;

select rtrim(@result); 
```

@Mark 正如您所提到的，这是给我带来问题的空格字符。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2010-08-16T21:16:02.417

关于 J Hardiman 的回答，怎么样：

```
SELECT empName, projIDs=
  REPLACE(
    REPLACE(
      (SELECT REPLACE(projID, ' ', '-somebody-puts-microsoft-out-of-his-misery-please-') AS [data()] FROM project_members WHERE empName=a.empName FOR XML PATH('')), 
      ' ', 
      ' / '), 
    '-somebody-puts-microsoft-out-of-his-misery-please-',
    ' ') 
  FROM project_members a WHERE empName IS NOT NULL GROUP BY empName 
```

顺便说一句，“姓氏”的使用是错字还是我不理解这里的概念？

无论如何，非常感谢大家，因为它为我节省了很多时间:)

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2021-09-30T09:40:39.017

### 2021

@AbdusSalamAzad 的答案是正确的。

```
SELECT STRING_AGG(my_col, ',') AS my_result FROM my_tbl; 
```

如果结果太大，您可能会得到错误“ **STRING_AGG 聚合结果超出了 8000 字节的限制。使用 LOB 类型来避免结果截断。** ”，可以通过将查询更改为以下内容来修复：

```
SELECT STRING_AGG(convert(varchar(max), my_col), ',') AS my_result FROM my_tbl; 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2020-08-31T16:23:47.157

UPDATE 2020：**SQL Server 2016+** **JSON**序列化和反序列化示例

OP 提供的数据插入到名为#project_members 的临时表中

```
drop table if exists #project_members;
create table #project_members(
  empName        varchar(20) not null,
  projID         varchar(20) not null);
go
insert #project_members(empName, projID) values
('ANDY', 'A100'),
('ANDY', 'B391'),
('ANDY', 'X010'),
('TOM', 'A100'),
('TOM', 'A510'); 
```

如何使用包含 projID 的嵌套数组将此数据序列化为单个 JSON 字符串

```
select empName, (select pm_json.projID 
                 from #project_members pm_json 
                 where pm.empName=pm_json.empName 
                 for json path, root('projList')) projJSON
from #project_members pm
group by empName
for json path; 
```

结果

```
'[
  {
    "empName": "ANDY",
    "projJSON": {
      "projList": [
        { "projID": "A100" },
        { "projID": "B391" },
        { "projID": "X010" }
      ]
    }
  },
  {
    "empName": "TOM",
    "projJSON": {
      "projList": [
        { "projID": "A100" },
        { "projID": "A510" }
      ]
    }
  }
]' 
```

如何将此数据从单个 JSON 字符串反序列化回其原始行和列

```
declare @json           nvarchar(max)=N'[{"empName":"ANDY","projJSON":{"projList":[{"projID":"A100"},
                                         {"projID":"B391"},{"projID":"X010"}]}},{"empName":"TOM","projJSON":
                                         {"projList":[{"projID":"A100"},{"projID":"A510"}]}}]';

select oj.empName, noj.projID 
from openjson(@json) with (empName        varchar(20),
                           projJSON       nvarchar(max) as json) oj
     cross apply openjson(oj.projJSON, '$.projList') with (projID    varchar(20)) noj; 
```

结果

```
empName projID
ANDY    A100
ANDY    B391
ANDY    X010
TOM     A100
TOM     A510 
```

如何将唯一的 empName 持久化到表中并将 projID 存储在嵌套的 JSON 数组中

```
drop table if exists #project_members_with_json;
create table #project_members_with_json(
  empName        varchar(20) unique not null,
  projJSON       nvarchar(max) not null);
go
insert #project_members_with_json(empName, projJSON) 
select empName, (select pm_json.projID 
                 from #project_members pm_json 
                 where pm.empName=pm_json.empName 
                 for json path, root('projList')) 
from #project_members pm
group by empName; 
```

结果

```
empName projJSON
ANDY    {"projList":[{"projID":"A100"},{"projID":"B391"},{"projID":"X010"}]}
TOM     {"projList":[{"projID":"A100"},{"projID":"A510"}]} 
```

如何从具有唯一 empName 和包含 projID 的嵌套 JSON 数组列的表中反序列化

```
select wj.empName, oj.projID
from
  #project_members_with_json wj
 cross apply
  openjson(wj.projJSON, '$.projList') with (projID    varchar(20)) oj; 
```

结果

```
empName projID
ANDY    A100
ANDY    B391
ANDY    X010
TOM     A100
TOM     A510 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2021-07-23T06:49:32.900

对于 SQL Server 2017+，使用 STRING_AGG() 函数

```
 SELECT STRING_AGG(Genre, ',') AS Result
    FROM Genres; 
```

样本结果：

## 结果

摇滚、爵士、乡村、流行、蓝调、嘻哈、说唱、朋克

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2019-03-20T20:04:11.393

对于我的 Google 同事，这是一个非常简单的即插即用解决方案，在与更复杂的解决方案苦苦挣扎一段时间后，它对我有用：

```
SELECT
distinct empName,
NewColumnName=STUFF((SELECT ','+ CONVERT(VARCHAR(10), projID ) 
                     FROM returns 
                     WHERE empName=t.empName FOR XML PATH('')) , 1 , 1 , '' )
FROM 
returns t 
```

请注意，我必须将 ID 转换为 VARCHAR 才能将其连接为字符串。如果您不必这样做，这里有一个更简单的版本：

```
SELECT
distinct empName,
NewColumnName=STUFF((SELECT ','+ projID
                     FROM returns 
                     WHERE empName=t.empName FOR XML PATH('')) , 1 , 1 , '' )
FROM 
returns t 
```

所有功劳都在这里： [https ://social.msdn.microsoft.com/Forums/sqlserver/en-US/9508abc2-46e7-4186-b57f-7f368374e084/replicating-groupconcat-function-of-mysql-in- sql-server?forum=transactsql](https://social.msdn.microsoft.com/Forums/sqlserver/en-US/9508abc2-46e7-4186-b57f-7f368374e084/replicating-groupconcat-function-of-mysql-in-sql-server?forum=transactsql)

# .net - 将特定的 .net 对象公开为 JSON

> ID：451420
> 
> 赞同：3
> 
> 时间：2009-01-16T18:16:11.990
> 
> 标签：.net, web-services, json

我目前正在使用 ScriptService 属性启用对我的 Web 服务的 JSON 调用。问题是我的一个类引用了第二个类，而.Net 没有为第二类提取和写出 JavaScript。

作为一种解决方法，我可以编写一个只返回第二个类的虚拟方法。然后 .Net 写入 JSON 以允许对其进行序列化。所以在下面的例子中：

```
[ScriptService]
public class MyService : WebService {
    [WebMethod]
    public void SaveClass1(Class1 class1) {
        ...
    }
}

[Serializable]
public class Class1 {
    public Class2 class2 { get; set; }
}

[Serializable]
public class Class2 {
} 
```

MyService.asmx/js 不会编写代码来允许我实例化 Class2 以填充 Class1。但如果我添加，我可以让它工作：

```
[WebMethod]
public Class2 Dummy() {
    return new Class2();
} 
```

到我的服务。非常感谢我讨厌的解决方法的任何替代方法。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-24T08:20:53.440

您需要使用[System.Web.Script.Services.GenerateScriptTypeAttribute](http://msdn.microsoft.com/en-us/library/system.web.script.services.generatescripttypeattribute.aspx)，它指定服务器类型应包含在生成的代理代码中。您可以将此属性应用于 Web 服务本身或任何标有[WebMethodAttribute](http://msdn.microsoft.com/en-us/library/system.web.services.webmethodattribute.aspx)的方法。

例如：

```
[ScriptService]
[GenerateScriptType(typeof(Class2))]
public class MyService : WebService {
    [WebMethod]
    public void SaveClass1(Class1 class1) {
        // ...
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-17T01:26:16.893

Lee，不确定这是否适用于您的 JSON/`[ScriptService]`场景，但是为了在[Searcharoo.net](http://searcharoo.net/)中序列化对象图，我使用了`System.Xml.Serialization.XmlInclude`我需要序列化的“基”类上的属性。

基本上，这告诉 XmlSerializer`Class2`以便它可以包含在`Class1`序列化中......有点像处理对象的深层层次结构的“选择加入”策略。

您可以像这样添加它（在您的示例中）：

```
[Serializable]
[System.Xml.Serialization.XmlInclude(typeof(Class2))]
public class Class1 {
    public Class2 class2 { get; set; }
} 
```

...然后这个

```
[WebMethod]
public void SaveClass1(Class1 class1) {
    ...
} 
```

`Class2`应该返回带有数据的 JSON `Class1`。

我做了一个快速的谷歌查找[故障排除... XmlSerializer](http://msdn.microsoft.com/en-us/library/aa302290.aspx)这可能是一个很好的阅读。高温高压

# silverlight - Silverlight Crossdomain

> ID：451424
> 
> 赞同：25
> 
> 时间：2009-01-16T18:17:11.410
> 
> 标签：silverlight, cross-domain

I've seen a lot of links to MSDN and "works on my machine!" answers so I'd like to ask my question with the exact steps to duplicate what I'm doing. Because we are using an already existing webservice, I'm asking with the context of having a webservice hosted outside of my project, unlike many of the tutorials and videos online. So here goes:

*** Create a new ASP.NET webservice project.

> It will come with an existing Service.asmx file exposing a "HelloWorld" web method.
> 
> View in browser, hit the "Invoke" button. It should work returning the "Hello World" string.
> 
> On my machine, the URL is: "[http://localhost:15511/WebSite5/Service.asmx](http://localhost:15511/WebSite5/Service.asmx)"

*** Start a new instance of Visual Studio, create a Silverlight Web Application Project.

*** Stick a single button on there with an event handler to call the web service. I personally nuke the Grid and use a simple StackPanel. eg.

```
<UserControl x:Class="SilverlightApplication1.Page"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
    Width="400" Height="300">
    <StackPanel>
        <Button Click="Button_Click">
            <Button.Content>
                <TextBlock Text="Test"/>
            </Button.Content>
        </Button>
    </StackPanel>
</UserControl> 
```

Add the web reference, using statement and event handler for the Button_Click:

```
 private void Button_Click(object sender, RoutedEventArgs e)
    {
        ServiceSoapClient client = new ServiceSoapClient();
        client.HelloWorldCompleted += (object s, HelloWorldCompletedEventArgs ea) => { 
            MessageBox.Show(ea.Result); 
        };
        client.HelloWorldAsync();
    } 
```

*   Run the Silverlight Application. In my case I'm going to my Silverlight Test Page at: [http://localhost:15558/SilverlightApplication1TestPage.aspx](http://localhost:15558/SilverlightApplication1TestPage.aspx)

Run and of course it blows up because of crossdomain issues. So next add the **clientaccesspolicy.xml** file with the following to the root of your web application hosting the service:

```
<?xml version="1.0" encoding="utf-8" ?>
<access-policy>
  <cross-domain-access>
    <policy>
      <allow-from http-request-headers="*">
        <domain uri="*"/>
      </allow-from>
      <grant-to>
        <resource include-subpaths="true" path="/"/>
      </grant-to>
    </policy>
  </cross-domain-access>
</access-policy> 
```

This should open things up since it's got a wildcard for headers, uris, and resources, right?

*   Run again and you get an error:

An error occurred while trying to make a request to URI '[http://localhost:15511/WebSite5/Service.asmx](http://localhost:15511/WebSite5/Service.asmx)'. This could be due to attempting to access a service in a cross-domain way without a proper cross-domain policy in place, or a policy that is unsuitable for SOAP services. You may need to contact the owner of the service to publish a cross-domain policy file and to ensure it allows SOAP-related HTTP headers to be sent.

So question: is there a secret to the clientaccesspolicy file? One could alternately try with the crossdomain.xml but it gives a similar result.

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-09-20T16:05:19.670

I've encountered this problem (SL v5.0 and Visual Studio 2010), what fixed it for me is that I went into the Silverlight project properties >> Silverlight tab and selected "Require elevated trust when running in-browser"

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-16T21:40:57.137

I've had this same problem a couple of times. In the past I've solved this by using the Web App as start up, but it looks like you've already done that.

My post on the subject: [http://www.donnfelker.com/silverlight-cross-domain-issue/](http://www.donnfelker.com/silverlight-cross-domain-issue/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-08-03T04:46:15.997

Make sure that you put the clientaccesspolicy.xml file in the root of IIS web directory e.g.

C:\Inetpub\wwwroot\clientaccesspolicy.xml

This will make sure that it is accessible directly at http:///clientaccesspolicy.xml

I was getting the same error and I resolved it doing the above steps.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-16T18:36:35.973

### Client Configuration

Maybe your `ServiceReferences.ClientConfig` for your Silverlight client is pointing to the wrong URL?

Also, check the location of your cross-domain policy file. This [MSDN article](http://msdn.microsoft.com/en-us/library/cc197938(VS.95).aspx) has more information.

### Locally Running Silverlight

Additional note for running Silverlight locally (Vista Sidebar, for example). As reported in [this blog entry](http://khason.net/tag/windows-gadgets/), *"Silverlight cannot use any network provider, when running locally."* The workaround is to use javascript to interface to the web service in this situation.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-04-27T15:46:53.433

Something that worked for me began with what I found on the silverlight forums [here](http://forums.silverlight.net/t/63112.aspx). It essentially asked if I could even *get* to my clientaccesspolicy.xml or crossdomain.xml from localhost (http://localhost/clientaccesspolicy.xml). When I tried to navigate there, I couldn't so I simply found the code for both of them (also within the aforementioned thread), and copy-pasted over the code inside of those files existing in my inetpub\wwwroot\ directory (I opened them up using Notepad++). The weird part was *the code didn't change at all* , and yet, it works! Hope that helps someone! This was extremely strange.

clientaccesspolicy.xml

```
<?xml version="1.0" encoding="utf-8"?>
 <access-policy>
  <cross-domain-access>
    <policy>
      <allow-from http-request-headers="*">
        <domain uri="*"/>
      </allow-from>
      <grant-to>
        <resource path="/" include-subpaths="true"/>
      </grant-to>
    </policy>
  </cross-domain-access>
</access-policy> 
```

crossdomain.xml

```
<?xml version="1.0"?>
<!DOCTYPE cross-domain-policy SYSTEM "http://www.macromedia.com/xml/dtds/cross-domain-policy.dtd">
<cross-domain-policy>
  <allow-http-request-headers-from domain="*" headers="*"/>
</cross-domain-policy> 
```

Be blessed!

-sf

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-12T10:42:45.673

Have you tried [fiddler](http://www.fiddlertool.com/fiddler/) when using this through IE, you might be able to see the traffic silverlight is causing, such as which cross policy files it is looking for?

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-08-12T11:32:23.713

I modified my Internet explorer settings. The website runs on a intern webserver so I added it in the Iexplorer Trusted Sites list. (Tools->Internet Options->Security->Sites).

Then I changed the security level and enabled cross domains. Done, Works but took me while to find the solution.

Best, Jeppen

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-01-20T21:51:10.483

You have to be aware of situation that when you reference to your service inside your project there 'll be created file "Reference.ClienConfig" and there is:

```
 **

<endpoint address="http://localhost:57675/Servis.asmx" binding="basicHttpBinding"
            bindingConfiguration="ServisSoap" contract="ServiceReference1.ServisSoap"
            name="ServisSoap" /> 
```

**

Make sure that your page is still using the same port (for example here is 57675). By default your localhost 'll get random port, so you have to change it to be static number and not Dynamic. (Right click on asp.net project/Tab Web/Specific port /type number Hope it helps

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-21T14:21:43.467

I ran into something like this and adding a ServiceHostFactory fixed my issue. The cross-domain policy file alone did not fix it.

```
class MyHostFactory : ServiceHostFactory
{
    protected override ServiceHost CreateServiceHost(Type serviceType, Uri[] baseAddresses)
    {
        MyHost customServiceHost =
          new MyHost(serviceType, new Uri("[Your URL goes here]",UriKind.Absolute));

        return customServiceHost;
    }
}

class MyHost : ServiceHost
{
    public MyHost(Type serviceType, params Uri[] baseAddresses)   base(serviceType, baseAddresses)
    { }

    protected override void ApplyConfiguration()
    {
        base.ApplyConfiguration();
    }
} 
```

You also have to add Factory="MyHostFactory" in the tag that defines your service

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-08-26T15:26:20.377

The problem could be that your development server is not able to serve the xml file, try this - explicitly make it available through WebGet

```
[ServiceContract]
    public interface ICrossDomainService
    {
        [OperationContract]
        [WebGet(UriTemplate = "ClientAccessPolicy.xml")]
        Message ProvidePolicyFile();
    } 
```

and then the ProvidePolicyFile() can be

```
public System.ServiceModel.Channels.Message ProvidePolicyFile()
        {
            FileStream filestream = File.Open(@"ClientAcessPolicy.xml", FileMode.Open);
            // Either specify ClientAcessPolicy.xml file path properly
            // or put that in \Bin folder of the console application
            XmlReader reader = XmlReader.Create(filestream);
            System.ServiceModel.Channels.Message result = Message.CreateMessage(MessageVersion.None, "", reader);
            return result;
        } 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-11-21T13:58:43.743

It worked in my pc successfully, you can place your

clientaccesspolicy.xml

```
<?xml version="1.0" encoding="utf-8"?> <access-policy>  
  <cross-domain-access>
     <policy>
       <allow-from http-request-headers="*">
         <domain uri="*"/>
       </allow-from>
       <grant-to>
         <resource path="/" include-subpaths="true"/>
       </grant-to>
     </policy>
   </cross-domain-access> 
</access-policy> 
```

both your project directory and your webservices root.

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-11-23T16:56:09.437

I was facing the same problem and take more than 3 days to figure out the Problem. I notice also when I was calling the internet Cloud Service WCF from a Silverlight app hosted in another web server it just shows Cross-Domain Errors. After looking into some posts I didn't solve the problem, even putting cross-domain.xml and clientaccesspolice.xml files in service root directory. So I just try to instead of using [http://example.com](http://example.com) I just change it to secure [https://example.com](https://example.com) and it just worked fine. The cross-domain errors disappears. service was called without problems.

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2013-04-19T18:50:38.360

Check which project is set default. It should be the web project that should be set default and not the silverlight project.

# algorithm - 如何计算二维多边形的面积？

> ID：451426
> 
> 赞同：91
> 
> 时间：2009-01-16T18:18:08.053
> 
> 标签：algorithm, geometry, 2d

假设二维空间中的一系列点不自相交，那么确定所得多边形面积的有效方法是什么？

作为旁注，这不是家庭作业，我不是在寻找代码。我正在寻找可以用来实现我自己的方法的描述。我有关于从点列表中拉出一系列三角形的想法，但我知道有很多关于凸多边形和凹多边形的边缘情况，我可能无法捕捉到。

* * *

## 回答 #1

> 赞同：119
> 
> 时间：2009-01-16T18:39:05.157

这是[标准方法](https://web.archive.org/web/20100405070507/http://valis.cs.uiuc.edu/~sariel/research/CG/compgeom/msg00831.html)，AFAIK。基本上总结每个顶点周围的叉积。比三角测量简单得多。

Python 代码，给定一个表示为 (x,y) 顶点坐标列表的多边形，隐式地从最后一个顶点环绕到第一个顶点：

```
def area(p):
    return 0.5 * abs(sum(x0*y1 - x1*y0
                         for ((x0, y0), (x1, y1)) in segments(p)))

def segments(p):
    return zip(p, p[1:] + [p[0]]) 
```

David Lehavi 评论：值得一提的是为什么该算法有效：它是[格林定理](https://en.wikipedia.org/wiki/Green's_theorem#Area_Calculation)对函数 -y 和 x 的应用；完全按照[平面计](https://en.wikipedia.org/wiki/Planimeter#Principle_of_the_linear_planimeter)的工作方式。进一步来说：

上式 =
`integral_over_perimeter(-y dx + x dy) =`
`integral_over_area((-(-dy)/dy+dx/dx) dy dx) =`
`2 Area`

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-04-04T16:38:57.343

叉积是经典。

如果你有无数次这样的计算要做，试试下面的优化版本，它需要少一半的乘法：

```
area = 0;
for( i = 0; i < N; i += 2 )
   area += x[i+1]*(y[i+2]-y[i]) + y[i+1]*(x[i]-x[i+2]);
area /= 2; 
```

为了清楚起见，我使用数组下标。使用指针效率更高。虽然好的编译器会为你做这件事。

假设多边形是“封闭的”，这意味着您将第一个点复制为带有下标 N 的点。它还假设多边形具有偶数个点。如果 N 不是偶数，则附加第一个点的副本。

该算法是通过展开和组合经典叉积算法的两次连续迭代而获得的。

我不太确定这两种算法如何比较数值精度。我的印象是，上述算法比经典算法要好，因为乘法往往会恢复减法的精度损失。当被限制使用浮点数时，就像 GPU 一样，这会产生很大的不同。

编辑：[“三角形和多边形 2D 和 3D 区域”](http://softsurfer.com/Archive/algorithm_0101/algorithm_0101.htm#2D%20Polygons)描述了一种更有效的方法

```
// "close" polygon
x[N] = x[0];
x[N+1] = x[1];
y[N] = y[0];
y[N+1] = y[1];

// compute area
area = 0;
for( size_t i = 1; i <= N; ++i )
  area += x[i]*( y[i+1] - y[i-1] );
area /= 2; 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2013-11-09T11:48:55.767

[此页面](http://geomalgorithms.com/a01-_area.html#2D%20Polygons)显示公式

![在此处输入图像描述](https://i.stack.imgur.com/M4YLP.gif)

可以简化为：

![在此处输入图像描述](https://i.stack.imgur.com/xWg2S.gif)

如果写出几个项，按照 的公因数分组`xi`，不难看出相等。

最终求和更有效，因为它只需要`n`乘法而不是`2n`.

```
def area(x, y):
    return abs(sum(x[i] * (y[i + 1] - y[i - 1]) for i in xrange(-1, len(x) - 1))) / 2.0 
```

[我从这里](https://stackoverflow.com/a/4682656/190597)的 Joe Kington 那里学到了这种简化。

* * *

如果你有 NumPy，这个版本会更快（除了非常小的数组）：

```
def area_np(x, y):        
    x = np.asanyarray(x)
    y = np.asanyarray(y)
    n = len(x)
    shift_up = np.arange(-n+1, 1)
    shift_down = np.arange(-1, n-1)    
    return (x * (y.take(shift_up) - y.take(shift_down))).sum() / 2.0 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-16T18:34:18.723

一组没有任何其他约束的点不一定唯一地定义一个多边形。

所以，首先你必须决定从这些点构建什么多边形——也许是凸包？[http://en.wikipedia.org/wiki/Convex_hull](http://en.wikipedia.org/wiki/Convex_hull)

然后三角测量并计算面积。 [http://www.mathopenref.com/polygonirregulararea.html](http://www.mathopenref.com/polygonirregulararea.html)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-01-16T18:40:31.830

为了扩展三角形和求和三角形区域，如果您碰巧有一个凸多边形，或者您碰巧选择了一个不会生成与多边形相交的每个其他点的线的点，这些都可以工作。

对于一般的非相交多边形，您需要对向量（参考点，点 a），（参考点，点 b）的叉积求和，其中 a 和 b 彼此“相邻”。

假设您有一个按顺序定义多边形的点列表（顺序是点 i 和 i+1 形成多边形的一条线）：

Sum(叉积 ((point 0, point i), (point 0, point i + 1)) for i = 1 to n - 1。

取那个叉积的大小，你就有了表面积。

这将处理凹多边形，而不必担心选择一个好的参考点；生成不在多边形内的三角形的任何三个点都将有一个叉积，该叉积指向多边形内任何三角形的相反方向，因此这些区域得到正确求和。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-10-04T15:05:38.503

计算多边形的面积

> > [http://community.topcoder.com/tc?module=Static&d1=tutorials&d2=geometry1#polygon_area](http://community.topcoder.com/tc?module=Static&d1=tutorials&d2=geometry1#polygon_area)

```
int cross(vct a,vct b,vct c)
{
    vct ab,bc;
    ab=b-a;
    bc=c-b;
    return ab.x*bc.y-ab.y*bc.x;
}    
double area(vct p[],int n)
{ 
    int ar=0;
    for(i=1;i+1<n;i++)
    {
        vct a=p[i]-p[0];
        vct b=p[i+1]-p[0];
        area+=cross(a,b);
    }
    return abs(area/2.0);
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-16T18:33:40.393

或者做一个轮廓积分。斯托克斯定理允许您将面积积分表示为等高线积分。一点高斯求积和鲍勃是你的叔叔。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2011-08-21T15:06:08.337

语言无关的解决方案：

给定：多边形总是由不重叠的 n-2 个三角形组成（n = 点数或边数）。1 个三角形 = 3 边多边形 = 1 个三角形；1 个正方形 = 4 个多边形 = 2 个三角形；等等恶心QED

因此，可以通过“切掉”三角形来减少多边形，总面积将是这些三角形面积的总和。用一张纸和剪刀试一试，最好在跟随之前想象一下这个过程。

如果您在多边形路径中选取任意 3 个连续点并使用这些点创建一个三角形，您将遇到以下三种可能场景中的一种且只有一种：

1.  结果三角形完全在原始多边形内
2.  结果三角形完全在原始多边形之外
3.  结果三角形部分包含在原始多边形中

我们只对属于第一个选项（完全包含）的情况感兴趣。

每次找到其中一个时，我们将其切掉，计算其面积（简单易懂，此处不解释公式）并制作一个边少的新多边形（相当于切掉这个三角形的多边形）。直到我们只剩下一个三角形。

如何以编程方式实现：

创建一个表示多边形周围路径的（连续）点数组。从点 0 开始。运行从点 x、x+1 和 x+2 制作三角形（一次一个）的数组。将每个三角形从一个形状转换为一个区域，并将其与从多边形创建的区域相交。如果生成的交点与原始三角形相同，则所述三角形完全包含在多边形中并且可以被切掉。从数组中删除 x+1 并从 x=0 重新开始。否则（如果三角形在 [部分或完全] 多边形之外），移动到数组中的下一个点 x+1。

此外，如果您希望与地图集成并从地理点开始，则必须首先从地理点转换为屏幕点。这需要确定地球形状的模型和公式（尽管我们倾向于将地球视为一个球体，但它实际上是一个不规则的卵形（蛋形），带有凹痕）。那里有很多模型，有关更多信息 wiki。一个重要的问题是您是否会将该区域视为平面还是弯曲的。通常，如果考虑平面而不是凸面，则点相距几公里的“小”区域不会产生明显的误差。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-16T18:24:40.113

一种方法是将[多边形分解为三角形](http://en.wikipedia.org/wiki/Polygon_triangulation)，计算三角形的面积，并将总和作为多边形的面积。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-16T18:25:57.320

1.  设置一个基点（最凸的点）。这将是三角形的轴心点。
2.  计算最左边的点（任意），而不是你的基点。
3.  计算第二个最左边的点来完成你的三角形。
4.  保存这个三角形区域。
5.  每次迭代向右移动一个点。
6.  对三角区域求和

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-01-16T19:34:35.870

比对三角形求和更好的是在笛卡尔空间中对梯形求和：

```
area = 0;
for (i = 0; i < n; i++) {
  i1 = (i + 1) % n;
  area += (vertex[i].y + vertex[i1].y) * (vertex[i1].x - vertex[i].x) / 2.0;
} 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2015-06-20T06:07:23.517

[鞋带公式](https://en.wikipedia.org/wiki/Shoelace_formula)的实现可以在 Numpy 中完成。假设这些顶点：

```
import numpy as np
x = np.arange(0,1,0.001)
y = np.sqrt(1-x**2) 
```

我们可以定义以下函数来查找区域：

```
def PolyArea(x,y):
    return 0.5*np.abs(np.dot(x,np.roll(y,1))-np.dot(y,np.roll(x,1))) 
```

并得到结果：

```
print PolyArea(x,y)
# 0.26353377782163534 
```

避免循环使该函数比以下函数快约 50 倍`PolygonArea`：

```
%timeit PolyArea(x,y)
# 10000 loops, best of 3: 42 µs per loop
%timeit PolygonArea(zip(x,y))
# 100 loops, best of 3: 2.09 ms per loop 
```

[注意：我已经为另一个问题](https://stackoverflow.com/a/30408825/3349443)写了这个答案，我只是在这里提到这个以获得完整的解决方案列表。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-01-16T18:23:55.047

我的倾向是简单地开始切掉三角形。我看不出还有什么办法可以避免毛茸茸的。

取三个组成多边形的连续点。确保角度小于 180。您现在有了一个新的三角形，计算应该没有问题，从多边形的点列表中删除中间点。重复直到你只剩下三个点。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2015-12-02T21:27:54.327

C这样做的方式：

```
float areaForPoly(const int numVerts, const Point *verts)
{
    Point v2;
    float area = 0.0f;

    for (int i = 0; i<numVerts; i++){
        v2 = verts[(i + 1) % numVerts];
        area += verts[i].x*v2.y - verts[i].y*v2.x;
    }

    return area / 2.0f;
} 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2017-04-02T22:47:44.860

> 我将给出一些计算二维多边形面积的简单函数。这适用于凸多边形和凹多边形。 *我们简单地将多边形分成许多子三角形。*

```
//don't forget to include cmath for abs function
struct Point{
  double x;
  double y;
}
// cross_product
double cp(Point a, Point b){ //returns cross product
  return a.x*b.y-a.y*b.x;
}

double area(Point * vertices, int n){  //n is number of sides
  double sum=0.0;
  for(i=0; i<n; i++){
    sum+=cp(vertices[i], vertices[(i+1)%n]); //%n is for last triangle
  }
  return abs(sum)/2.0;
} 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2017-09-29T06:29:58.223

# Python代码

如此处所述：http: [//www.wikihow.com/Calculate-the-Area-of-a-Polygon](http://www.wikihow.com/Calculate-the-Area-of-a-Polygon)

## 与熊猫

```
import pandas as pd

df = pd.DataFrame({'x': [10, 20, 20, 30, 20, 10, 0], 'y': [-10, -10, -10, 0, 10, 30, 20]})
df = df.append(df.loc[0])

first_product = (df['x'].shift(1) * df['y']).fillna(0).sum()
second_product = (df['y'].shift(1) * df['x']).fillna(0).sum()

(first_product - second_product) / 2
600 
```

# iphone - iPhone SQLite DB 和基于 Web 的 DB 同步和交互推荐

> ID：451428
> 
> 赞同：13
> 
> 时间：2009-01-16T18:18:36.150
> 
> 标签：iphone, database, json, sqlite

我正在开发我的第二个 iPhone 应用程序，并且正在寻找有关数据库处理的架构建议。

想法是： 1\. 信息数据库存储在服务器（LAMP 堆栈）上，信息通过 JSON 传递到设备。这部分已经实现。

2.  用户可以“收藏”数据库中的某个项目，该项目将其存储在本地设备上的 SQLite 中。

3.  用户还可以将尚不存在的新项目提交到远程服务器，使其可供其他用户收藏。

4.  用户可以通过单个搜索界面搜索两个数据库以查找项目。

我正在尝试为此确定数据结构，以及如何处理来自数据库的结果对象。我想我有两个对象的选择：

1.  远程DB和本地DB具有相同的对象类型，本地DB存储远程项的id来链接两者

2.  分离远程项目和本地项目的对象

非常感谢任何想法，想法等！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-09-16T23:23:24.157

您需要编写自己的同步引擎。我在一个记录级别、历史驱动的同步引擎上发布了一组冗长的笔记，我是从一个葡萄酒期刊应用程序中编写的，你可以在这里找到它……</p>

[http://blog.deeje.tv/musings/2009/06/notes-on-writing-a-history-driven-client-server-synchronization-engine.html](http://blog.deeje.tv/musings/2009/06/notes-on-writing-a-history-driven-client-server-synchronization-engine.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-16T20:43:16.373

如果您想在数据库中同步对象，您可以使用修改时间戳比较和哈希列的组合来确定哪些记录是陈旧的并且需要更新。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-05-12T16:08:20.237

如果你正在寻找一个现有的 API，QuickConnectFamily 框架有一个可以在 UIWebView 中使用 JavaScript 用于浏览器和已安装的 SQLite 数据库。对于那些不编写混合应用程序的人，我也接近于拥有一个纯 Objective-C 实现。

javascript 版本也适用于 Android。

[http://www.quickconnectfamily.org](http://www.quickconnectfamily.org)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-03-21T05:21:49.353

SQLite 是否提供了用于同步的 API？

# opengl - 两个进程可以渲染到一个 OpenGL 画布吗？

> ID：451434
> 
> 赞同：6
> 
> 时间：2009-01-16T18:20:25.693
> 
> 标签：opengl, rendering, window, process

我在同一台机器上运行了三个不同的进程。其中一个拥有一个 OpenGL 窗口。我希望另外两个能够（快速）渲染到 OpenGL 窗口的不同矩形部分。

如果我可以保证他们会很好地轮流执行 OpenGL 命令，这可能吗？

非常感谢

雨果·埃利亚斯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-09T13:24:22.620

在 Windows 下，可以使用同一进程的线程。

您正在寻找的功能是 wglMakeCurrent：

[http://msdn.microsoft.com/en-us/library/dd374387%28VS.85%29.aspx](http://msdn.microsoft.com/en-us/library/dd374387%28VS.85%29.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-16T22:14:11.213

我的理解是，这对于任何现有的驱动程序都是不可能的。OpenGL 上下文仅由一个进程拥有。

对于单个进程中的两个线程来说，每个线程都对单个 OpenGL 上下文进行 OpenGL 调用甚至是冒险的。（设计上不需要如此，但它通常是当前驱动程序的问题。）

# sql - 排除 COALESCE 功能？

> ID：451449
> 
> 赞同：1
> 
> 时间：2009-01-16T18:25:49.863
> 
> 标签：sql, oracle, coalesce

我有一个很大的查询（不是我写的，但我正在做一些修改）。让我烦恼的一件事是，我在大约四个地方都有相同的 COALESCE 功能。有没有办法解决这个问题，可能是通过从 DUAL 中选择加入？将其分解出来是否有性能优势？

这是稍微粗略的查询：

```
select 
tbl1.gid
[snip]
         ,COALESCE(t1_end_dt, t6_actl_end_dt,t6_calc_end_dt) perd_end_dt
        ,t1_end_dt
FROM    tbl1
....
JOIN    tbl2               ON (t2_pk          = wpck_wrkr_id  AND
                                            t2_ind_1    ='Y'    AND
        COALESCE(t1_end_dt, t6_actl_end_dt, t6_calc_end_dt) 
        BETWEEN  t2_strt_dt AND t2_end_dt)
JOIN    tbl3                ON (t3_pk               = t2_fk_t3_pk AND
       COALESCE(t1_end_dt, t6_actl_end_dt, t6_calc_end_dt) 
        BETWEEN t3_strt_dt AND t3_end_dt)    
LEFT JOIN tbl4 tbl4_a             ON (tbl4_a.t4_pk         = chkw_wkt_id)
.....
GROUP BY tbl1.gid 
.....
        ,COALESCE(t1_end_dt, t6_actl_end_dt, t6_calc_end_dt)
        ,COALESCE(tbl4_b.t4_or_id, tbl4_a.t4_or_id, t7_or_id )
        ,t1_end_dt
ORDER BY perd_end_dt 
```

请注意，我已经通过在 SELECT 中将其命名为 pred_end_dt 并然后在 ORDER BY 中通过该名称引用它来分解出其中一个 COALESCE。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-16T18:36:48.157

您应该能够用您的列别名替换 GROUP BY 子句中的出现`perd_end_dt`。但是 JOIN 条件中的出现不能使用列别名。

这确实对性能有影响。我不认为 JOIN 条件可以按照它们当前的编写方式使用索引。但是，它只是 JOIN 条件中的一项，因此影响可能很小。也就是说，涉及的术语`t2_pk`可能`t2_ind_1`已经减少了行集，因此日期比较只需要处理一个小集合。这取决于我们谈论的行数以及数据的分布方式。

一种分解`COALESCE()`并利用索引的方法是创建一个冗余列，它是该表达式的结果。使用触发器确保在每次插入或更新后它具有正确的值。然后索引列。

但就像我说的，这可能比它的价值更麻烦。这将是更多的工作，并且您应该确保此更改将使代码更易于维护、更正确或更快。

* * *

另一种选择是为`COALESCE()`子查询中的表达式定义别名。我不知道这些列来自哪些表，因为您没有使用表别名来限定它们。但是，如果我可以假设它们都是以`tbl1`下列：

```
...
FROM (
    SELECT COALESCE(t1_end_dt, t6_actl_end_dt, t6_calc_end_dt) perd_end_dt,
      t1_fk_t2_pk
    FROM tbl1) t1
  JOIN tbl2
    ON (tbl2.t2_pk = t1.t1_fk_t2_pk AND tbl2.t2_ind_1 = 'Y'
      AND t1.perd_end_dt BETWEEN tbl2.t2_strt_dt AND tbl2.t2_end_dt)
... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-16T18:33:45.167

也许你可以使用 with 子句？

```
with data as
(
   select COALESCE(t1_end_dt, t6_actl_end_dt,t6_calc_end_dt) perd_end_dt
   ,      .....
   ,      ...
   from   tbl1
)
select ...
from   data
,      ....
where  .... 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-16T18:38:56.170

你可以创建一个虚拟表

```
(Select Coalesce( all your stuff ....) perdEndDt 
   From [all your tables necessary for this one value]) 
```

并将此作为单独的联接表包含在您的 Select SQL 中

```
 Select [all yr other stuff,
      Z.perdEndDt
  From [Other Tables Joined together]
      Join 
         (Select Coalesce( all your stuff ....) perdEndDt,
               [other columns necessary for join conditions]
         From [all your tables necessary for this one value]) As Z
         On [Join conditions for Z to other tables]
  Where  [any filter predicates]
  Order By Z.perdEndDt
     ... etc. 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-16T19:38:45.567

甲骨文有意见吗？（必须这样做。）如果您发现自己`COALESCE()`在许多不同的地方使用该表达式，则可能值得创建一个`VIEW`并使用它而不是原始表。下面将执行相同的计算，但查询的语法会更简洁，因此更清晰。

在我看来，“视图”是数据库中的“表”，就像“函数”是程序中的“代码行”一样。每当您发现一堆使用相似逻辑的查询时，请编写一个将通用逻辑分解的视图并改用它。

# java - Excel 工作表名称的有效字符

> ID：451452
> 
> 赞同：33
> 
> 时间：2009-01-16T18:26:27.850
> 
> 标签：java, excel

在 Java 中，我们使用以下包以编程方式创建 excel 文档：

```
org.apache.poi.hssf 
```

如果您尝试设置工作表的名称（不是文件，而是内部 Excel 工作表），如果出现以下情况，您将收到错误：

*   名称超过 31 个字符
*   该名称包含以下任何字符： / \ * ? [ ]

但是，在创建具有工作表名称的文档后：

> @#$​​%&()+~`"':;,.|

没有错误输出，在 Java 中一切似乎都很好。当您在 Office 2003 中打开 excel 文件时，它会给您一个错误，指出工作表名称无效并将其重命名为“Sheet 1”之类的通用名称。

我对我们使用的前面提到的包了解不多，但看起来它没有正确过滤无效的 Excel 工作表名称。知道如何过滤掉所有已知的无效字符吗？我对简单地过滤掉所有非单词字符犹豫不决。

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-01-16T18:40:58.850

我认为问题在于冒号，而不是感叹号。

如果您打开 Excel 并尝试手动编辑工作表名称，它不允许您键入的唯一字符是 [ ] * / \ ？：

如果您粘贴其中一个字符，您会收到以下错误：（Excel 2003）

> 重命名工作表或图表时，您输入了无效的名称。尝试以下方法之一：
> 
> *   确保您输入的名称不超过 31 个字符。
> *   确保名称不包含以下任何字符： : \ / ? * [ 或者 ]
> *   确保您没有将名称留空。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2013-09-17T01:23:05.163

您可以使用 Apache POI 的 WorkbookUtil.createSafeSheetName(String s) 安全地创建工作表名称。

[http://poi.apache.org/apidocs/org/apache/poi/ss/util/WorkbookUtil.html](http://poi.apache.org/apidocs/org/apache/poi/ss/util/WorkbookUtil.html)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-03-21T16:09:09.047

这是我在 C# 中使用的（在 Java 中应该类似）：

```
const string invalidCharsRegex = @"[/\\*'?[\]:]+";
const int maxLength = 31;

string safeName = Regex.Replace(worksheetName, invalidCharsRegex, " ")
                        .Replace("  ", " ")
                        .Trim();

if (string.IsNullOrEmpty(safeName))
{
    safeName = "Default";   // cannot be empty
}
else if (safeName.Length > maxLength)
{
    safeName = safeName.Substring(0, maxLength);
} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2018-02-07T19:45:16.450

你可以使用这个：

```
protected Sheet createSheet(XSSFWorkbook book, String nameSheet) {
    return book.createSheet(WorkbookUtil.createSafeSheetName(nameSheet));
} 
```

# .net - 如何使用反射获取静态属性

> ID：451453
> 
> 赞同：126
> 
> 时间：2009-01-16T18:26:57.270
> 
> 标签：.net, reflection, static

所以这看起来很基本，但我无法让它工作。我有一个对象，我正在使用反射来获取它的公共属性。这些属性之一是静态的，我没有运气。

```
Public Function GetProp(ByRef obj As Object, ByVal propName as String) as PropertyInfo
    Return obj.GetType.GetProperty(propName)

End Function 
```

上面的代码适用于公共实例属性，到目前为止，这就是我所需要的。假设我可以使用 BindingFlags 来请求其他类型的属性（私有、静态），但我似乎找不到正确的组合。

```
Public Function GetProp(ByRef obj As Object, ByVal propName as String) as PropertyInfo
    Return obj.GetType.GetProperty(propName, Reflection.BindingFlags.Static Or Reflection.BindingFlags.Instance Or Reflection.BindingFlags.Public)

End Function 
```

但是，请求任何静态成员仍然没有返回任何内容。.NET 反射器可以很好地看到静态属性，所以很明显我在这里遗漏了一些东西。

* * *

## 回答 #1

> 赞同：153
> 
> 时间：2010-08-02T10:27:00.363

或者只是看看这个...

```
Type type = typeof(MyClass); // MyClass is static class with static properties
foreach (var p in type.GetProperties())
{
   var v = p.GetValue(null, null); // static classes cannot be instanced, so use null...
} 
```

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2009-01-16T18:35:08.720

这是 C#，但应该给你的想法：

```
public static void Main() {
    typeof(Program).GetProperty("GetMe", BindingFlags.NonPublic | BindingFlags.Static);
}

private static int GetMe {
    get { return 0; }
} 
```

（您只需要 OR NonPublic 和 Static）

* * *

## 回答 #3

> 赞同：46
> 
> 时间：2012-07-17T20:27:23.113

有点清晰...

```
// Get a PropertyInfo of specific property type(T).GetProperty(....)
PropertyInfo propertyInfo;
propertyInfo = typeof(TypeWithTheStaticProperty)
    .GetProperty("NameOfStaticProperty", BindingFlags.Public | BindingFlags.Static); 

// Use the PropertyInfo to retrieve the value from the type by not passing in an instance
object value = propertyInfo.GetValue(null, null);

// Cast the value to the desired type
ExpectedType typedValue = (ExpectedType) value; 
```

* * *

## 回答 #4

> 赞同：29
> 
> 时间：2009-01-19T14:22:55.260

好的，所以对我来说关键是使用 .FlattenHierarchy BindingFlag。我真的不知道为什么我只是凭直觉添加它并开始工作。因此，让我获得公共实例或静态属性的最终解决方案是：

```
obj.GetType.GetProperty(propName, Reflection.BindingFlags.Public _
  Or Reflection.BindingFlags.Static Or Reflection.BindingFlags.Instance Or _
  Reflection.BindingFlags.FlattenHierarchy) 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2011-06-28T18:40:00.230

```
myType.GetProperties(BindingFlags.Public | BindingFlags.Static |  BindingFlags.FlattenHierarchy); 
```

这将返回静态基类或特定类型中的所有静态属性，也可能返回子类。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2015-08-21T14:46:39.877

只是想为自己澄清这一点，同时使用基于的新反射 API `TypeInfo`- where`BindingFlags`不可靠（取决于目标框架）。

在“新”反射中，要获取类型（不包括基类）的静态属性，您必须执行以下操作：

```
IEnumerable<PropertyInfo> props = 
  type.GetTypeInfo().DeclaredProperties.Where(p => 
    (p.GetMethod != null && p.GetMethod.IsStatic) ||
    (p.SetMethod != null && p.SetMethod.IsStatic)); 
```

满足只读或只写属性（尽管只写是一个糟糕的主意）。

该`DeclaredProperties`成员也不区分具有公共/私有访问器的属性 - 因此，要过滤可见性，您需要根据需要使用的访问器来执行此操作。例如 - 假设上述调用已返回，您可以执行以下操作：

```
var publicStaticReadable = props.Where(p => p.GetMethod != null && p.GetMethod.IsPublic); 
```

`TypeInfo`有一些可用的快捷方法 - 但最终我们都将在未来围绕查询方法/属性编写更多扩展方法。此外，新的 API 迫使我们从现在开始准确地思考我们所认为的“私有”或“公共”属性——因为我们必须根据个人访问者过滤自己。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-16T18:45:36.547

以下似乎对我有用。

```
using System;
using System.Reflection;

public class ReflectStatic
{
    private static int SomeNumber {get; set;}
    public static object SomeReference {get; set;}
    static ReflectStatic()
    {
        SomeReference = new object();
        Console.WriteLine(SomeReference.GetHashCode());
    }
}

public class Program
{
    public static void Main()
    {
        var rs = new ReflectStatic();
        var pi = rs.GetType().GetProperty("SomeReference",  BindingFlags.Static | BindingFlags.Public);
        if(pi == null) { Console.WriteLine("Null!"); Environment.Exit(0);}
        Console.WriteLine(pi.GetValue(rs, null).GetHashCode());

    }
} 
```

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2009-01-16T18:39:38.417

试试这个[C# 反射](http://www.csharp-examples.net/reflection-property-names/)链接。

注意我认为[BindingFlags.Instance 和 BindingFlags.Static](http://msdn.microsoft.com/en-us/library/f13c1950.aspx)是排他的。

# windows - Tomcat：设置域以进行身份 验证以使用 Windows 用户

> ID：451456
> 
> 赞同：0
> 
> 时间：2009-01-16T18:27:38.673
> 
> 标签：windows, tomcat, authentication

我想在 Windows 上设置 Tomcat，并在我的 Web 应用程序中针对 Windows 用户（或这些用户的子集）进行身份验证。我读到如果您在 Active Directory 上设置了用户，[则可以使用 JNDI 领域](http://wiki.openi.org/index.php/Configuring_Tomcat_With_Active_Directory)。

如果您没有 Active Directory，而只是在服务器上设置了“简单 Windows 用户”怎么办？是否可以设置一个 Tomcat 领域来对它们进行身份验证，或者我是否必须实现一个这样做的领域？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-19T20:37:55.407

使用 JAAS 领域怎么样？[领域文档](http://tomcat.apache.org/tomcat-5.5-doc/config/realm.html)是指“JAAS 领域 (org.apache.catalina.realm.JAASRealm)”。JAAS 是 Java 身份验证和授权服务，它允许[插入式身份验证模块](http://java.sun.com/j2se/1.4.2/docs/guide/security/jaas/tutorials/LoginConfigFile.html)。默认模块之一是[NTLoginModule](http://java.sun.com/j2se/1.4.2/docs/guide/security/jaas/spec/com/sun/security/auth/module/NTLoginModule.html)，听起来它可以满足您的需求。

# c# - 数据表转 JSON

> ID：451460
> 
> 赞同：19
> 
> 时间：2009-01-16T18:28:32.790
> 
> 标签：c#, .net, json, .net-2.0, datatable

我最近需要将数据表序列化为 JSON。我在哪里，我们仍然在 .Net 2.0 上，所以我不能在 .Net 3.5 中使用 JSON 序列化程序。我想这一定是以前做过的，所以我上网查了一下，发现[了](http://www.codeproject.com/KB/aspnet/ASPNET_DataTable_to_JSON.aspx)许多[不同](http://www.dennydotnet.com/post/A-DataTable-Serializer-for-ASPNET-AJAX.aspx)[的](http://schotime.net/blog/index.php/2008/07/27/dataset-datatable-to-json/) [选择](http://geekswithblogs.net/shahed/archive/2008/03/22/120709.aspx)。其中一些依赖于一个额外的库，我很难在这里推进。其他人需要先转换为`List<Dictionary<>>`，这似乎有点尴尬和不必要。另一个将所有值视为字符串。出于某种原因，我无法真正落后于他们中的任何一个，所以我决定推出自己的，发布在下面。

正如您从阅读`//TODO`评论中看到的那样，它在一些地方是不完整的。这段代码已经在这里生产了，所以它在基本意义上是“工作”的。它不完整的地方是我们知道我们的生产数据当前不会命中它的地方（数据库中没有时间跨度或字节数组）。我在这里发布的原因是我觉得这可以更好一些，我希望帮助完成和改进这段代码。欢迎任何输入。

*请注意，此功能内置于 .Net 3.5 及更高版本中，因此今天使用此代码的唯一原因是您仍受限于 .Net 2.0。即便如此，JSON.Net 已经成为这类事情的 goto 库。*

```
public static class JSONHelper
{
    public static string FromDataTable(DataTable dt)
    {
        string rowDelimiter = "";

        StringBuilder result = new StringBuilder("[");
        foreach (DataRow row in dt.Rows)
        {
            result.Append(rowDelimiter);
            result.Append(FromDataRow(row));
            rowDelimiter = ",";
        }
        result.Append("]");

        return result.ToString();
    }

    public static string FromDataRow(DataRow row)
    {
        DataColumnCollection cols = row.Table.Columns;
        string colDelimiter = "";

        StringBuilder result = new StringBuilder("{");       
        for (int i = 0; i < cols.Count; i++)
        { // use index rather than foreach, so we can use the index for both the row and cols collection
            result.Append(colDelimiter).Append("\"")
                  .Append(cols[i].ColumnName).Append("\":")
                  .Append(JSONValueFromDataRowObject(row[i], cols[i].DataType));

            colDelimiter = ",";
        }
        result.Append("}");
        return result.ToString();
    }

    // possible types:
    // http://msdn.microsoft.com/en-us/library/system.data.datacolumn.datatype(VS.80).aspx
    private static Type[] numeric = new Type[] {typeof(byte), typeof(decimal), typeof(double), 
                                     typeof(Int16), typeof(Int32), typeof(SByte), typeof(Single),
                                     typeof(UInt16), typeof(UInt32), typeof(UInt64)};

    // I don't want to rebuild this value for every date cell in the table
    private static long EpochTicks = new DateTime(1970, 1, 1).Ticks;

    private static string JSONValueFromDataRowObject(object value, Type DataType)
    {
        // null
        if (value == DBNull.Value) return "null";

        // numeric
        if (Array.IndexOf(numeric, DataType) > -1)
            return value.ToString(); // TODO: eventually want to use a stricter format. Specifically: separate integral types from floating types and use the "R" (round-trip) format specifier

        // boolean
        if (DataType == typeof(bool))
            return ((bool)value) ? "true" : "false";

        // date -- see http://weblogs.asp.net/bleroy/archive/2008/01/18/dates-and-json.aspx
        if (DataType == typeof(DateTime))       
            return "\"\\/Date(" + new TimeSpan(((DateTime)value).ToUniversalTime().Ticks - EpochTicks).TotalMilliseconds.ToString() + ")\\/\"";

        // TODO: add Timespan support
        // TODO: add Byte[] support

        //TODO: this would be _much_ faster with a state machine
        //TODO: way to select between double or single quote literal encoding
        //TODO: account for database strings that may have single \r or \n line breaks
        // string/char  
        return "\"" + value.ToString().Replace(@"\", @"\\").Replace(Environment.NewLine, @"\n").Replace("\"", @"\""") + "\"";
    }
} 
```

**更新：**
这已经过时了，但我想指出一些关于这段代码如何处理日期的事情。我当时使用的格式是有道理的，因为网址中有确切的理由。但是，该理由包括以下内容：

> 老实说，JSON Schema 通过将字符串“子类型化”为日期文字成为可能，确实解决了这个问题，但这仍在进行中，要实现任何重大采用都需要时间。

嗯，时间已经过去了。今天，可以只使用[ISO 8601](http://en.wikipedia.org/wiki/ISO_8601)日期格式。我不会费心更改代码，因为真的：这是古老的。只需使用 JSON.Net。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-16T21:59:19.743

如果它是 Microsoft 的[.NET 2.0 的 AJAX 扩展，](http://www.microsoft.com/downloads/details.aspx?FamilyID=ca9d90fa-e8c9-42e3-aa19-08e2c027f5d6&displaylang=en)它会帮助你说服你的老板安装一个库吗？

其中包括[System.Web.Script.Serialization.JavascriptSerializer](http://msdn.microsoft.com/en-us/library/system.web.script.serialization.javascriptserializer.aspx)，用于您帖子[最后一个链接的第 4 步。](http://geekswithblogs.net/shahed/archive/2008/03/22/120709.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-22T03:58:18.810

嘿伙计，这一切都在 Rick 的博客文章[Serializing DataTable using Json.NET](http://www.west-wind.com/Weblog/posts/471835.aspx)中。他详细解释了如何使用[James Newton King的](http://james.newtonking.com/)[Json.NET](http://www.codeplex.com/Json)来完成它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-16T18:47:48.337

我发现了这个：[http](http://www.bramstein.com/projects/xsltjson/) : //www.bramstein.com/projects/xsltjson/ 您可以将数据表转换为 xml 并使用 xslt 样式表将 xml 转换为 json。

这更像是一种解决方法，而不是真正的解决方案。

# android - 我想要在我自己的地图图像上具有平移和缩放功能（如 MapView）

> ID：451464
> 
> 赞同：5
> 
> 时间：2009-01-16T18:31:48.667
> 
> 标签：android, zooming

如何让自己的图像能够平移和缩放（如 MapView）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-06T22:14:15.287

我尝试在 WebView 中托管图像（内置平移和缩放），但存在许多问题。我最终扩展了 View 类并覆盖了 onDraw。这并不难，一旦我最终决定使用这种方法。

# c++ - 如何使用 fprintf/printf 打印出破折号或圆点？

> ID：451475
> 
> 赞同：8
> 
> 时间：2009-01-16T18:36:46.690
> 
> 标签：c++, c, text, printf

截至目前，我正在使用下面的行打印不带点的

```
fprintf( stdout, "%-40s[%d]", tag, data); 
```

我期望输出将类似于以下内容，

```
卡数..................................[500]
固定奖金金额[整数]............[10]
这是中奖的高额奖金吗？......................[是]

```

如何使用 fprintf/printf 打印出破折号或圆点？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-16T19:00:41.243

更快的方法：

如果您事先知道您需要的最大填充量（当您格式化固定宽度的表格时通常会出现这种情况），您可以使用静态“填充器”字符串，只需从中抓出一大块。这将比调用`printf`或`cout`循环更快。

```
static const char padder[] = "......................"; // Many chars

size_t title_len = strlen(title);
size_t pad_amount = sizeof(padder) - 1 - title_len;

printf(title); // Output title

if (pad_amount > 0) {
    printf(padder + title_len); // Chop!
}

printf("[%d]", data); 
```

你甚至可以在一个声明中做到这一点，带着一些信念：

```
printf("%s%s[%d]", title, padder + strlen(title), data); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-16T19:43:29.957

您可以使用 iostreams 而不是 printf 轻松做到这一点

```
cout << setw(40) << setfill('.') << left << tag[i] << '[' << data[i] << ']' << endl; 
```

或者如果你真的需要使用 fprintf （比如，你被传递了一个 FILE* 来写入）

```
strstream str;
str << setw(40) << setfill('.') << left << tag[i] << '[' << data[i] << ']' << endl;
printf(%s", str.str()); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-16T18:45:19.450

你不能在一个声明中做到这一点。您可以使用 sprintf，然后自己用点代替空格，或者执行类似的操作

```
int chars_so_far;
char padder[40+1]= '..........'; //assume this is 40 dots.
printf("%.40s%n",tag,&chars_so_far);
printf("%s[%d]",padder+chars_so_far,data); 
```

* * *

编辑：基于@Ates' padder 概念简化了我上面的例子。这种方式不需要任何“信念的飞跃”，关于标签字符串是太大还是太小 - 它总是从第 41 列中的数据开始。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-16T18:39:21.473

您将不得不自己输出带有点或破折号填充的字符串。

类似的东西（原谅我的 C，它生锈了）：

```
printAmount(char *txt, int amt) {
    printf("%s",txt);
    for(int xa=strlen(txt); xa<40; xa++) { putc('.'); }
    printf("[%d]",amt);
    printf("\n");
    } 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-16T19:23:09.590

另一种使用微小辅助函数的解决方案

```
static inline size_t min(size_t a, size_t b)
{
    return a < b ? a : b;
} 
```

然后，您可以执行以下操作：

```
char padder[] = "........................................";
int len = min(strlen(tag), sizeof(padder) - 1);
printf("%.*s%s[%d]", len, tag, padder + len, data); 
```

这基本上是 Ates 发布的内容，但实际上是我自己想出来的；）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-16T18:49:13.717

我建议编写一个用 X 字符填充字符串的函数，并使用它来生成`printf`字符串的第一个参数。就像是：

```
char s[40];
pad_str(tag, s, 40, '.');
fprintf( stdout, "%-40s[%d]", s, data); 
```

请注意，示例数据的第三行需要这种格式：

```
"%-40s[%s]" 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-16T21:54:21.080

我认为有更好的方法。

```
#include <string.h>
#include <stdio.h>

#define MIN(A,B) ((A)<(B)?(A):(B))
char *dashpad(char *buf, int len, const char *instr) {
    memset(buf, '-', len);
    buf[len] = 0;
    int inlen = strlen(instr);
    memcpy(buf, instr, MIN(len, inlen));
    return buf;
}
main() {
    char buf[40];
    printf("%s\n", dashpad(buf, 40, "Hello world, dash padded "));
} 
```

# web-services - 将数组从 .net Web 服务返回到 Java ME Web 服务会导致存根编译错误？

> ID：451479
> 
> 赞同：1
> 
> 时间：2009-01-16T18:38:41.897
> 
> 标签：web-services, netbeans, java-me

因此，我在 netbeans 6.5 生成的 Java ME 客户端到 ac# (vs2005) Web 服务的 Web 服务代码上遇到了一些编译错误。我已经显着修改了我的示例，它仍然显示了问题，并且无法返回一组东西几乎是一个交易破坏者。

时间：2019-05-10 标签：c#webservice(SimpleWebService.asmx)

```
<%@ WebService Language="C#" Class="SimpleWebService" %>

using System;
using System.Web;
using System.Web.Services;
using System.Web.Services.Protocols;

[WebService(Namespace = "http://sphereinabox.com/")]
[WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
public class SimpleWebService  : System.Web.Services.WebService {

    [WebMethod]
    public CustomType[] GetSomething() {
        return new CustomType[] {new CustomType("hi"), new CustomType("bye")};
    }
    public class CustomType {
        public string Name;
        public CustomType(string _name) {
            Name = _name;
        }
        public CustomType() {
        }
    }
} 
```

WSDL（vs2005自动生成）：

```
<?xml version="1.0" encoding="utf-8"?>
<wsdl:definitions xmlns:s="http://www.w3.org/2001/XMLSchema" xmlns:soap12="http://schemas.xmlsoap.org/wsdl/soap12/" xmlns:mime="http://schemas.xmlsoap.org/wsdl/mime/" xmlns:tns="http://sphereinabox.com/" xmlns:soap="http://schemas.xmlsoap.org/wsdl/soap/" xmlns:tm="http://microsoft.com/wsdl/mime/textMatching/" xmlns:http="http://schemas.xmlsoap.org/wsdl/http/" xmlns:soapenc="http://schemas.xmlsoap.org/soap/encoding/" targetNamespace="http://sphereinabox.com/" xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/">
  <wsdl:types>
    <s:schema elementFormDefault="qualified" targetNamespace="http://sphereinabox.com/">
      <s:element name="GetSomething">
        <s:complexType />
      </s:element>
      <s:element name="GetSomethingResponse">
        <s:complexType>
          <s:sequence>
            <s:element minOccurs="0" maxOccurs="1" name="GetSomethingResult" type="tns:ArrayOfCustomType" />
          </s:sequence>
        </s:complexType>
      </s:element>
      <s:complexType name="ArrayOfCustomType">
        <s:sequence>
          <s:element minOccurs="0" maxOccurs="unbounded" name="CustomType" nillable="true" type="tns:CustomType" />
        </s:sequence>
      </s:complexType>
      <s:complexType name="CustomType">
        <s:sequence>
          <s:element minOccurs="0" maxOccurs="1" name="Name" type="s:string" />
        </s:sequence>
      </s:complexType>
    </s:schema>
  </wsdl:types>
  <wsdl:message name="GetSomethingSoapIn">
    <wsdl:part name="parameters" element="tns:GetSomething" />
  </wsdl:message>
  <wsdl:message name="GetSomethingSoapOut">
    <wsdl:part name="parameters" element="tns:GetSomethingResponse" />
  </wsdl:message>
  <wsdl:portType name="SimpleWebServiceSoap">
    <wsdl:operation name="GetSomething">
      <wsdl:input message="tns:GetSomethingSoapIn" />
      <wsdl:output message="tns:GetSomethingSoapOut" />
    </wsdl:operation>
  </wsdl:portType>
  <wsdl:binding name="SimpleWebServiceSoap" type="tns:SimpleWebServiceSoap">
    <soap:binding transport="http://schemas.xmlsoap.org/soap/http" />
    <wsdl:operation name="GetSomething">
      <soap:operation soapAction="http://sphereinabox.com/GetSomething" style="document" />
      <wsdl:input>
        <soap:body use="literal" />
      </wsdl:input>
      <wsdl:output>
        <soap:body use="literal" />
      </wsdl:output>
    </wsdl:operation>
  </wsdl:binding>
  <wsdl:binding name="SimpleWebServiceSoap12" type="tns:SimpleWebServiceSoap">
    <soap12:binding transport="http://schemas.xmlsoap.org/soap/http" />
    <wsdl:operation name="GetSomething">
      <soap12:operation soapAction="http://sphereinabox.com/GetSomething" style="document" />
      <wsdl:input>
        <soap12:body use="literal" />
      </wsdl:input>
      <wsdl:output>
        <soap12:body use="literal" />
      </wsdl:output>
    </wsdl:operation>
  </wsdl:binding>
  <wsdl:service name="SimpleWebService">
    <wsdl:port name="SimpleWebServiceSoap" binding="tns:SimpleWebServiceSoap">
      <soap:address location="http://localhost/SimpleWebService/SimpleWebService.asmx" />
    </wsdl:port>
    <wsdl:port name="SimpleWebServiceSoap12" binding="tns:SimpleWebServiceSoap12">
      <soap12:address location="http://localhost/SimpleWebService/SimpleWebService.asmx" />
    </wsdl:port>
  </wsdl:service>
</wsdl:definitions> 
```

生成的（netbeans）代码无法编译，这是通过“添加 -> 将 JavaME 新建到 Web 服务客户端”向导创建的。(SimpleWebService_Stub.java)

```
 public ArrayOfCustomType GetSomething() throws java.rmi.RemoteException {
        Object inputObject[] = new Object[] {
        };

        Operation op = Operation.newInstance( _qname_operation_GetSomething, _type_GetSomething, _type_GetSomethingResponse );
        _prepOperation( op );
        op.setProperty( Operation.SOAPACTION_URI_PROPERTY, "http://sphereinabox.com/GetSomething" );
        Object resultObj;
        try {
            resultObj = op.invoke( inputObject );
        } catch( JAXRPCException e ) {
            Throwable cause = e.getLinkedCause();
            if( cause instanceof java.rmi.RemoteException ) {
                throw (java.rmi.RemoteException) cause;
            }
            throw e;
        }

//////// Error on next line, symbol ArrayOfCustomType_fromObject not defined
        return ArrayOfCustomType_fromObject((Object[])((Object[]) resultObj)[0]);
    } 
```

事实证明，这个人为的例子（我的生产问题中的“CustomType”有多个字段）我也在同一个生成的（SimpleWebService_Stub.java）生成的代码中从这个有趣的代码中得到错误。错误是没有定义字符串（它是java中的字符串，此外我认为这应该是关于CustomType的）。

```
private static string string_fromObject( Object obj[] ) {
    if(obj == null) return null;
    string result = new string();
    return result;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-16T19:12:40.313

*显然*，您不应该使用花哨的内置东西，例如 netbeans 的存根生成器。不，您应该使用 Sun（或 Sprint 品牌...）存根生成器，您可以通过以下方式获得：

1.  右键单击您的项目
2.  选择**属性**
3.  在新对话框的左侧选择**平台**
4.  单击rigt 侧的**Manage Emulators**
5.  在这个新对话框的左侧选择您选择的模拟器（**Sun Java(TM) Wirless Tookit 2.5 for CLDC ）**
6.  单击**工具和扩展**选项卡。
7.  单击**打开实用程序**按钮。
8.  在这个新对话框中选择**存根生成器实用程序**
9.  为所涉及的大量步骤和对话而哭泣。
10.  单击**启动**
11.  指定您的 WSDL 网址**[http://localhost/SimpleWebService/SimpleWebService.asmx?WSDL](http://localhost/SimpleWebService/SimpleWebService.asmx?WSDL)**
12.  指定您的输出路径 ** C:\code\SimpleMobile\src\ **
13.  指定你的输出包**simplewebservice**或任何你
14.  按**确定**按钮。
15.  如果要使用 netbeans 编译，请忽略有关无法编译的错误。**error : com.sun.tools.javac.Main is not available in the classpath.. error: 编译失败，应该报错**
16.  每当 Web 服务发生更改并且需要重新生成存根时，请重复上述所有操作。
17.  编写一个批处理文件来执行此操作以保存您的理智。

啊。无论如何，我在 Jonathan Knudsen 的书“踢屁股与 MIDP 和 MSA：创建出色的移动应用程序”中找到了上述内容

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-03-21T21:07:21.630

前面的答案很好，当我使用 netbeans 生成的存根类时出现了 classcastexception，java me 平台 SDK 3 生成的类就像一个魅力。

Java ME 平台 SDK 3 和 netbeans 6.8 没有显示打开实用程序按钮（不能点击它），但您可以打开 Java ME 平台 SDK 3 生成存根类

创建一个新项目，右键单击项目名称：添加 - 其他选择其他，移动 Web 服务客户端，指定 WSDL URL 和 woila，您就有了工作生成的类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-03-31T11:51:30.307

在 Web 服务中为类 CustomType 添加属性 [Serializable]。您将在存根类中获得 ArrayOfCustomType_fromObject()。

# c# - 当我的电脑上有几个时，如何确定我的产品的哪些 .net 程序集已注册？

> ID：451480
> 
> 赞同：0
> 
> 时间：2009-01-16T18:38:48.683
> 
> 标签：c#, .net, com, bho, regasm

我有我在我的机器上工作的软件产品的各种版本的代码。该产品包括一个或多个为 com interop 注册的程序集。如何确定当前注册的是哪一个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-16T22:39:44.220

如果您知道程序集的 GUID，请查看`HKCR\CLSID\{your guid}\InprocServer32`. 键将`Assembly`具有包含版本的值。

如果您只有 ProgId，您可以在注册表中搜索该字符串，它会告诉您 GUID。

# javascript - 在 IE 中设置 innerHTML 时标签丢失换行符

> ID：451486
> 
> 赞同：13
> 
> 时间：2009-01-16T18:40:05.217
> 
> 标签：javascript, html, css, internet-explorer

我正在使用 Prototype 的 PeriodicalUpdater 使用 ajax 调用的结果更新 div。据我了解，div 是通过设置其 innerHTML 来更新的。

div 包含在`<pre>`标签中。在 Firefox 中，`<pre>`格式按预期工作，但在 IE 中，文本都以一行结束。

[这是在此处](http://forums.devnetwork.net/viewtopic.php?f=13&t=93265)找到的一些示例代码，可以说明问题。在 Firefox 中，`abc`与 ; 位于不同的行`def`。在 IE 中它在同一行。

```
 <html>
    <head>
      <title>IE preformatted text sucks</title>
    </head>
    <body>
      <pre id="test">
        a b c
        d e f
      </pre>
      <script type="text/javascript"><!--
      var textContent = document.getElementById("test").innerText;
      textContent = textContent.replace("a", "<span style=\"color:red;\">a</span>");
      document.getElementById("test").style.whiteSpace = "pre";
      document.getElementById("test").innerHTML = textContent;
      --></script>
    </body>
    </html> 
```

任何人都知道解决这个问题的方法吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-16T19:01:32.740

设置 innerHTML 会启动一个 HTML 解析器，它会忽略多余的空格，包括硬回车。如果您更改您的方法以在字符串中包含 <pre> 标记，则它可以正常工作，因为 HTML 解析器保留了硬返回。

运行示例页面后，您可以通过查看生成的源来查看此操作：

```
<PRE id="test" style="WHITE-SPACE: pre"><SPAN style="COLOR: red">a</SPAN> b c d e f </PRE> 
```

您可以在此处看到硬返回不再是 <pre> 标记内容的一部分。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-16T19:10:56.153

通常，通过使用 DOM 方法构造动态内容，您将获得更一致的结果，尤其是当您关心诸如空白规范化之类的细微问题时。但是，如果您为此设置了使用 innerHTML，则有一个 IE 解决方法，即使用该`outerHTML`属性并包含封闭标签。

```
if(test.outerHTML)
    test.outerHTML = '<pre id="test">'+textContent+'</pre>';
else
    test.innerHTML = textContent; 
```

可以在此处找到此解决方法和更多讨论：[Inserting a newline into a pre tag (IE, Javascript)](https://stackoverflow.com/questions/195363/inserting-a-newline-into-a-pre-tag-ie-javascript)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-12-15T17:37:32.730

或者你可以

```
if (el.innerText) {
    el.innerText = val;
} else {
    el.innerHTML = val;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-09T05:37:34.967

不知道以前是否有人建议过，但是我发现在将 innerHTML 插入“pre”标签时保留空白、换行符等的解决方案是在文本中插入另一个“pre”标签：

```
<pre id="pretag"></pre>

TextToInsert = "lots of text with spaces and newlines";

document.getElementById("pretag").innerHTML = "<pre>" + TextToInsert + "</pre>"; 
```

似乎 IE 在执行 innerHTML 之前确实解析了文本。以上导致解析器将附加的“pre”标签内的文本保留为未解析的。有道理，因为这是解析器应该做的。也适用于 FF。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-03-12T12:10:40.873

它也可以重写为“Python方式”，即：

> `el.innerText && el.innerText = val || el.innerHTML = val;`

# javascript - 在 HTML 文本区域上模拟 HTML 输入“maxlength”属性的最佳方法是什么？

> ID：451491
> 
> 赞同：14
> 
> 时间：2009-01-16T18:41:17.303
> 
> 标签：javascript, html, textarea

HTML 文本输入有一个名为“maxlength”的属性，由浏览器实现，如果设置，则在一定数量的字符后阻止用户输入。

另一方面，HTML textarea 元素没有此属性。我的目标是在 HTML 文本区域上模拟 maxlength 的行为。要求：

*   至少，显示（CSS 更改）用户输入了太多字符。
*   理想情况下，阻止用户输入更多字符，就像在 HTML 输入中发生的那样。

据了解，服务器端验证应该再次检查长度。在这里，我只关注客户端部分。

我的问题是：在 HTML 文本区域上模拟 maxlength 的最简洁的客户端方法是什么？理想情况下，请指向您使用过的经过验证的开源 JavaScript 片段。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-16T18:49:25.277

看看这个网站上的评论，倒计时。我以前也这样做过，简单有效。Stack Overflow 也很好地利用了颜色。

也许您没有足够的代表来查看评论框。

当您键入时，它会运行一点倒计时。在接近阈值时，颜色从黄色变为红色。全部使用 JavaScript，我假设 textarea 的 keyup 事件。

编辑：用 jQuery 完成它怎么样？

```
<script language="javascript" type="text/javascript" src="js/jquery-1.2.6.min.js"></script>
<script language="javascript" type="text/javascript">
    $(document).ready( function () {
        setMaxLength();
        $("textarea.checkMax").bind("click mouseover keyup change", function(){checkMaxLength(this.id); } )
    });

    function setMaxLength() {
        $("textarea.checkMax").each(function(i){
            intMax = $(this).attr("maxlength");
            $(this).after("<div><span id='"+this.id+"Counter'>"+intMax+"</span> remaining</div>");
        });
    }

    function checkMaxLength(strID){
        intCount = $("#"+strID).val().length;
        intMax = $("#"+strID).attr("maxlength");
        strID = "#"+strID+"Counter";
        $(strID).text(parseInt(intMax) - parseInt(intCount));
        if (intCount < (intMax * .8)) {$(strID).css("color", "#006600"); } //Good
        if (intCount > (intMax * .8)) { $(strID).css("color", "#FF9933"); } //Warning at 80%
        if (intCount > (intMax)) { $(strID).text(0).css("color", "#990000"); } //Over
    }
</script> 
```

HTML是

```
<textarea id="text" maxlength="250" class="checkMax"></textarea> 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-19T16:04:00.297

[我在这里](http://psacake.com/web/js.asp)找到了一个不错的脚本，它可以在输入字符串的长度超过 MaxLen 参数后阻止用户输入更多文本，它具有不可否认的好处，即大部分时间都不会出现在用户面前。

我对该脚本的问题是它还阻止了导航键（箭头，主页，结束）以及退格和删除，所以我稍微修改了它，否则如果用户达到设置的限制，则无法删除他输入的文本MaxLen（这会有点搞笑：P）。

Javascript：

```
function imposeMaxLength(Event, Object, MaxLen)
{
        return (Object.value.length <= MaxLen)||(Event.keyCode == 8 ||Event.keyCode==46||(Event.keyCode>=35&&Event.keyCode<=40))
} 
```

以及随之而来的 HTML：

```
<textarea onkeypress="return imposeMaxLength(event, this, 110);" rows="4" cols="50"> 
```

用户仍然可以通过将文本粘贴到 textarea 中来绕过这个限制，但这可以在 imposeMaxLength 中轻松解决。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-16T19:00:29.107

[PPK 的 Textarea Maxlength](http://www.quirksmode.org/dom/maxlength.html)脚本可在他的网站上找到。没什么花哨的，只是普通的旧 JavaScript。

您可以轻松地将其用作起点并进行更改以适应您的 CSS“通知”要求。

请注意，作者指出：“我的脚本的目的不是强制执行最大长度，尽管可以很容易地更改它来做到这一点。但是，我决定限制我的脚本，以便在用户超过最大长度时给出礼貌的提醒字符。”

**更新：** 由于附加文章中的 linkrot，这里是曾经存在于该链接上的代码：

HTML：

```
<textarea id="text" name="text" maxlength="1250"></textarea> 
```

JS：

```
function setMaxLength() {
    var x = document.getElementsByTagName('textarea');
    var counter = document.createElement('div');
    counter.className = 'counter';
    for (var i=0;i<x.length;i++) {
        if (x[i].getAttribute('maxlength')) {
            var counterClone = counter.cloneNode(true);
            counterClone.relatedElement = x[i];
            counterClone.innerHTML = '<span>0</span>/'+x[i].getAttribute('maxlength');
            x[i].parentNode.insertBefore(counterClone,x[i].nextSibling);
            x[i].relatedElement = counterClone.getElementsByTagName('span')[0];

            x[i].onkeyup = x[i].onchange = checkMaxLength;
            x[i].onkeyup();
        }
    }
}

function checkMaxLength() {
    var maxLength = this.getAttribute('maxlength');
    var currentLength = this.value.length;
    if (currentLength > maxLength)
        this.relatedElement.className = 'toomuch';
    else
        this.relatedElement.className = '';
    this.relatedElement.firstChild.nodeValue = currentLength;
    // not innerHTML
} 
```

只需`setMaxLength();`在加载时调用该函数。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-16T18:54:14.003

这是对我来说可以正常工作的 JavaScript 代码：

```
onBlur="if (this.value.length > 500) { alert('The notes field only allows 500 characters. You have ' + this.value.length + ' characters.'); this.focus(); return false; }" 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-16T18:57:22.310

我认为以下内容尽可能“干净”。在 Javascript 中创建一个事件处理程序，将 keydown 事件和 textarea 字段作为输入。检查此处理程序中字段中文本的长度，如果达到最大长度，则返回 false。（当然在返回之前进行任何 css 样式切换）。否则返回真。文本区域应如下所示。

```
<textarea onkeydown="return checkMaxLength(event, this, 1000);"></textarea> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-17T01:18:53.897

使用 JavaScript 框架（[Prototype](http://en.wikipedia.org/wiki/Prototype_JavaScript_Framework)、[jQuery](http://en.wikipedia.org/wiki/JQuery)等），以便您拥有跨浏览器事件支持。在上面写一行`keyup`以防止用户输入最大长度。

注意：您还必须检查服务器端的长度。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-11-15T05:21:19.770

我想我可以试一试，只是做同样事情的另一种方式。我喜欢这种方式，因为您可以将其包装在一些代码中以检查您是否在 IE 中运行，因为 maxlength 确实适用于 webkit 和 gecko 浏览器中的文本区域。它取决于在 html 中的 textarea 元素上设置的 maxlength 属性。也因为它实际上作为 maxlength 属性在默认情况下在浏览器中工作，防止用户添加超过指定的字符。

```
$(document).ready(function () {

$('textarea').on('keyup', function () {
    // Store the maxlength and value of the field.
    if (!maxlength) {
        var maxlength = $(this).attr('maxlength');
    }
    var val = $(this).val();
    var vallength = val.length;

    // alert
    if (vallength >= maxlength) {

        alert('Please limit your response to ' + maxlength + ' characters');
        $(this).blur();
    }

    // Trim the field if it has content over the maxlength.
    if (vallength > maxlength) {
        $(this).val(val.slice(0, maxlength));
    }
});

//remove maxlength on blur so that we can reset it later.
$('textarea').on('blur', function () {
        delete maxlength;
    });
}); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-08-06T15:24:18.043

这是我使用的一个名为“Simply Countable”的 jQuery 插件，它允许您向文本区域添加计数器。其中一项功能是它允许您设置字段中允许的最大字符数，并强制执行它，以便用户不能超过该限制。

这是简单可数的 GitHub 页面：
[https ://github.com/aaronrussell/jquery-simply-countable/](https://github.com/aaronrussell/jquery-simply-countable/)

你会这样使用它...

```
$('#my_textarea').simplyCountable({
    counter: '#counter',
    maxCount: 140,
    strictMax: true
}); 
```

# c# - 如果您占用 UI 线程，为什么 Windows CE 会丢弃关键事件

> ID：451494
> 
> 赞同：0
> 
> 时间：2009-01-16T18:41:37.460
> 
> 标签：c#, winforms, compact-framework, windows-ce

现在我很欣赏这个故事的寓意是“不要占用 UI 线程”，但我们试图通过尽可能长时间保持 UI 线程上的东西来亲吻，但我认为我们刚刚达到了临界点，我们正在将不得不改变我们的设计。

但无论如何......我在我们的设备上注意到的一些在桌面上不会发生的事情：当你占用 UI 线程时，它会丢弃键。这是一个显示问题的非常简单的应用程序。

```
using System;
using System.Windows.Forms;

namespace DeviceApplication14
{
    public partial class Form1 : Form
    {
        /// <summary>
        /// The main entry point for the application.
        /// </summary>
        [MTAThread]
        static void Main()
        {
            Application.Run(new Form1());
        }

        private int ctr;

        public Form1()
        {
            InitializeComponent();
            KeyPreview = true;
            KeyDown += Form1_KeyDown;
        }

        void Form1_KeyDown(object sender, KeyEventArgs e)
        {
            for (int i = 0; i < 1000000; i++)
            {

            }
            ctr++;
            button1.Text = ctr.ToString();
        }

        private void button2_Click(object sender, EventArgs e)
        {
            ctr = 0;
            button1.Text = ctr.ToString();
        }

        /// <summary>
        /// Required designer variable.
        /// </summary>
        private System.ComponentModel.IContainer components = null;

        /// <summary>
        /// Clean up any resources being used.
        /// </summary>
        /// <param name="disposing">true if managed resources should be disposed; otherwise, false.</param>
        protected override void Dispose(bool disposing)
        {
            if (disposing && (components != null))
            {
                components.Dispose();
            }
            base.Dispose(disposing);
        }

        #region Windows Form Designer generated code

        /// <summary>
        /// Required method for Designer support - do not modify
        /// the contents of this method with the code editor.
        /// </summary>
        private void InitializeComponent()
        {
            this.button1 = new System.Windows.Forms.Button();
            this.button2 = new System.Windows.Forms.Button();
            this.SuspendLayout();
            // 
            // button1
            // 
            this.button1.Location = new System.Drawing.Point(235, 137);
            this.button1.Name = "button1";
            this.button1.Size = new System.Drawing.Size(329, 239);
            this.button1.TabIndex = 0;
            this.button1.Text = "button1";
            // 
            // button2
            // 
            this.button2.Location = new System.Drawing.Point(62, 291);
            this.button2.Name = "button2";
            this.button2.Size = new System.Drawing.Size(72, 20);
            this.button2.TabIndex = 1;
            this.button2.Text = "Clear";
            this.button2.Click += new System.EventHandler(this.button2_Click);
            // 
            // Form1
            // 
            this.AutoScaleDimensions = new System.Drawing.SizeF(96F, 96F);
            this.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Dpi;
            this.AutoScroll = true;
            this.ClientSize = new System.Drawing.Size(638, 455);
            this.Controls.Add(this.button2);
            this.Controls.Add(this.button1);
            this.Name = "Form1";
            this.Text = "Form1";
            this.ResumeLayout(false);

        }

        #endregion

        private Button button1;
        private Button button2;
    }
} 
```

当我在我的自定义框上运行它时，我可以连续按四个键，但我的 ctr 只增加 2。如果我然后添加几个零（以补偿桌面更快的速度）并在桌面上运行它，我会得到所有的键。

这里发生了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-16T18:49:16.523

```
for (int i = 0; i < 1000000; i++)
            {

            } 
```

提供时间延迟的空循环表明对事件驱动模型的理解不足。

Windows CE 的事件处理程序与桌面版本的 Windows 完全不同，虽然 Windows 可以容忍这种类型的滥用，但 Windows CE 不会。

如果您在诸如此类的空循环中吸收大量处理时间，而不是调用延迟例程将控制权正确释放回调度程序，则不会调用事件处理程序。如果没有足够频繁地调用事件处理程序，那么您将丢失事件。有各种缓冲区可以存储其中一些事件，但根据输入设备（键盘、触摸屏等）的不同，这些缓冲区可能不足或不存在。

这里的关键是便携式设备上的事件处理程序没有大缓冲区。台式计算机具有大量用于键盘和鼠标操作的缓冲区。

还有许多其他差异，但最重要的是，您确实需要正确释放线程并正确延迟，而不是这些简单的空循环延迟。

Windows CE 计时器在这里更合适 - 使用 keydown 例程启动计时器，并在它触发时执行所需的操作。这会将控制权释放回 UI，以便其他事件可以运行。

另外，请记住，虽然 Windows CE 是多线程/多任务处理，但最好将您的程序视为一次只运行一件事。操作系统和事件模型可能正在发送您的应用程序事件（而不是缓冲它们）并且您的应用程序处于此延迟例程中而忽略它们。在执行该循环时，您不会看到其他事件（包括按键）。根据系统的负载和性能，延迟可能会运行几毫秒到数百毫秒——你不能指望它每次运行时都运行相同的时间长度——这是使用实时计时器的另一个原因。

-亚当

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-16T18:46:26.500

一旦消息进入队列，Windows CE 将不会“丢弃”任何键。我的猜测是你使用了太多的量子，键盘驱动程序本身并没有得到所有的键，因此不能传递它们。您可以通过调用[PostKeybdMessage](http://msdn.microsoft.com/en-us/library/ms911936.aspx)而不是使用键盘本身来排除硬件或驱动程序交互来验证这一点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-10-28T15:52:19.080

这个问题与 BSP 中的一个错误（显然来自一些飞思卡尔代码）有关，这意味着键盘驱动程序以比预期低得多的优先级中断运行。

现在已修复，一切正常。:)

# visual-studio-2008 - 维护多个 Visual Studio 用户选项 (suo) 配置文件

> ID：451495
> 
> 赞同：5
> 
> 时间：2009-01-16T18:41:53.090
> 
> 标签：visual-studio-2008, options, multiple-monitors

我使用 Visual Studio 2008 在两种环境中工作：我的笔记本电脑和我的笔记本电脑+外接显示器。当我使用第二台显示器时，我希望我的解决方案资源管理器和其他非代码窗口位于第二台显示器上，而我的笔记本电脑屏幕只是代码文件。当我在环境之间切换时，每天重新排列窗口有点痛苦。有没有办法更好地管理我的用户选项？我可以在启动 VS 之前手动切换我的 .suo 文件，但这似乎同样令人讨厌。有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-16T19:22:43.413

您可以将您的设置和窗口的位置导出到一个文件中，然后在 VS 运行时导入该文件。为了解决您的问题，您可以在没有外部显示器的情况下按照您喜欢的方式设置 VS，然后导出您的设置。然后，为您设置它并导出。当您连接或移除您的显示器时，只需导入相应的设置文件。

[本文应演示导入/导出选项的位置。](http://en.csharp-online.net/Visual_Studio:_Export_and_import_settings "这篇文章应该解释一下。")

# c# - 如何在测试项目代码文件夹中打开文件？（Visual Studio 2008 和 .NET C#）

> ID：451499
> 
> 赞同：1
> 
> 时间：2009-01-16T18:44:09.390
> 
> 标签：c#, .net, visual-studio, visual-studio-2008, unit-testing

当我在 Visual Studio 上运行测试项目时，我使用下面的代码访问测试项目代码文件夹中的文件

```
var Location = System.IO.Path.GetDirectoryName(
    System.Reflection.Assembly.GetExecutingAssembly().GetModules()[0].FullyQualifiedName
);
var FileLocation = Path.Combine(
            Location
            ,@"..\..\..\TestProject1\App_Data\data.xml"
            ); 
```

还有另一种（更好的）方法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-16T18:50:39.050

您是说您正在尝试在运行测试本身的上下文中查找文件吗？如果是这样，您应该查看[TestContext](http://msdn.microsoft.com/en-us/library/microsoft.visualstudio.testtools.unittesting.testcontext(VS.80).aspx)对象，特别是[TestDeploymentDir](http://msdn.microsoft.com/en-us/library/microsoft.visualstudio.testtools.unittesting.testcontext.testdeploymentdir(VS.80).aspx)属性。您还应该将该文件标记为[DeploymentItem](http://msdn.microsoft.com/en-us/library/microsoft.visualstudio.testtools.unittesting.deploymentitemattribute(VS.80).aspx)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-16T18:53:40.603

获取 VSTS 单元测试的 deploymetn 目录的最可靠方法是使用 TestContext 类。如果您在给定的 TestClass 上定义类型和名称为 TestContext 的公共属性，这将自动连接

```
private TestContext _context;
public TestContext TestContext { get { return _context;} set { _context = value } } 
```

TestContext 类有几个成员指向测试代码的实际部署。我不熟悉如何部署 Web 应用程序，但此类的属性之一应该将您指向正确的目录。

# .net - 设计一个泛型接口，需要类型或方法上的类型参数？

> ID：451501
> 
> 赞同：0
> 
> 时间：2009-01-16T18:44:57.720
> 
> 标签：.net, generics

我有一个非常薄的接口，它将定义一种方法。我应该在类定义中要求类型参数吗？

```
public interface ISomethingFun<T>
{
    void Do(T item);
} 
```

还是方法定义？

```
public interface ISomethingFun
{
    void Do<T>(T item);
} 
```

什么道理？更容易实现、继承或动态生成吗？是风格吗？是否有一些适用的 OO 指导？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-16T18:49:09.863

在方法上使用泛型的好处是它有助于类型推断。

```
void Example(ISomethingFun fun) {
  fun.Do(42);
} 
```

你去吧，一个完全通用的调用，没有通用参数。将泛型参数放在类型上会强制您在元数据中显示类型时添加泛型签名或绑定

```
void Example2<T>(ISomethingFun<T> fun) { ... } 
```

这不一定是坏事，事实上经常是必要的。这只是一个区别。

一般来说，如果每个方法都有相同的泛型参数，只需将其添加到类型中：)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-16T18:50:26.523

*   如果班级涉及 T，则将其放在班级上。
    *   一个具体的例子：一个整数列表 - 你正在搜索 42。

> ```
> List<int> g;
> g.Find(42); 
> ```

*   如果类不处理 T 但方法处理，则将其放在方法上。
    *   一个具体的例子：一个对象列表，你正在搜索一个值为 42 的整数。

> ```
> ArrayList g;
> g.Find<int>(42) 
> ```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-16T18:53:23.363

它应该在界面上。

接口的使用者应该能够约束 Do 期望的类型。它只能通过约束 ISomethingFun 的类型来做到这一点。并且实施者应该知道期望什么类型。如果泛型参数在方法上，那么实现者将不得不处理任何类型，而消费者将没有发言权。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-16T18:49:33.917

这只是我的直觉，但由于只有一种方法，我会把它放在方法上。

这样 Do<T> 的调用者不必明确指定 T 。

```
SomethingFun fun = new SomethingFun();
fun.Do( DateTime.Now ); 
```

# sql-server - 从 SQL Server SMO 编写表时如何更改表名

> ID：451505
> 
> 赞同：0
> 
> 时间：2009-01-16T18:45:44.050
> 
> 标签：sql-server, smo

假设我有一个表“foo”，我想使用 SMO 编写脚本。有没有办法让生成的脚本中的表具有不同的名称，例如“foo2”？

```
Database db = sqlServer.Databases["testdb"];
Table foo = db.Tables["foo"];
foo.Name = "foo2"; 
```

如果这样做，当我尝试设置 foo.Name 时会出现此异常：

“无法对此对象执行操作，因为该对象是集合的成员。”

有没有办法用 SMO 做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T02:24:10.170

对于像我这样试图了解如何使用 SMO 重命名列的人，如果您使用与上述相同的方法

```
foo.Name = "foo2"; 
```

您将在此线程中收到相同的异常消息。要重命名该列，您只需要去

```
foo.Rename("foo2"); 
```

有关详细信息，请参阅[MSDN ：](http://msdn.microsoft.com/en-us/library/microsoft.sqlserver.management.smo.column.rename.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-12-11T11:56:14.793

您可以使用新名称在内存中创建一个新表，然后编写该表的脚本。

[您可以在使用 SMO](http://rashmipandit.wordpress.com/2009/12/08/copying-a-table-using-smo/)复制表格中找到复制表格的代码

无需在新表上调用 Create()，您只需调用 Script()。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-16T19:09:15.173

您必须将 Script 方法的输出放入字符串变量并使用 Replace 替换名称。

# visual-studio - 是否有适用于 Visual Studio 2005 的 HLSL 插件？

> ID：451506
> 
> 赞同：2
> 
> 时间：2009-01-16T18:45:51.180
> 
> 标签：visual-studio, hlsl

至少会添加代码语法着色的东西？

HLSL 3 最好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-18T03:54:12.423

不幸的是，InteliShade 网站似乎已经死了。虽然我还没有找到另一个插件来添加 hlsl 突出显示，但我确实在 gamedev.net 上找到了一些[手动说明](http://www.gamedev.net/community/forums/viewreply.asp?ID=2924456)，以将语法突出显示定义添加到 Visual Studio。

> 您必须 从 nVidia 站点下载[CG Toolkit 。](http://developer.nvidia.com/object/cg_toolkit.html)然后在文件夹 \NVIDIA Corporation\Cg\msdev_syntax_highlighting\ 它会是一个名为 usertype.dat 的文件，那么你将不得不这样做..
> 
> 1.  将 usertype.dat 文件复制到 \Microsoft Visual Studio 8\Common7\IDE
> 2.  打开注册表编辑器并转到以下位置 - HKLM\SOFTWARE\Microsoft\VisualStudio\8.0\Languages\File Extensions
> 3.  从 .cpp 键复制默认值。
> 4.  在文件扩展名下创建一个名为 .cg 的新密钥
> 5.  将刚刚复制的值粘贴到默认值中。
> 6.  重新启动 Visual Studio，您的着色器现在应该具有语法突出显示。
> 
> 一切都会准备就绪。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-05T12:32:30.610

实际上，有。它被称为 InteliShade，可以在[http://intelishade.net/找到](http://intelishade.net/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-08T02:24:54.397

Intelishade 似乎工作得很好，在使用 XNA 框架时使用它，仍然在编码着色器方面很烂>。>

# vim - 保持括号平衡（Vim 的 Paredit？）

> ID：451518
> 
> 赞同：11
> 
> 时间：2009-01-16T18:50:41.373
> 
> 标签：vim, emacs, parentheses

Emacs 有[Paredit](http://mumble.net/~campbell/emacs/paredit.el)，它可以主动阻止您输入不平衡的括号（没有`C-Q (`强制插入文字或其他疯狂的东西）。插入一个开放的paren也会插入一个关闭的paren。在括号上退格要么删除开头和结尾的括号，要么都不删除。有一些快捷方式可以在新括号中包装一个裸词，从当前封闭的括号中踢出一个单词，扩展括号以吞下更多附近的单词，等等。

就像是

```
imap ( ()<Left> 
```

可以让你开始使用 Vim。但是在 Vim 中模拟 Paredit 的其他一些更强大功能的最佳方式是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-13T20:06:37.873

Tamas Kovacs 创建了一个类似于 Emacs 版本的 Vim [paredit 脚本。](http://www.vim.org/scripts/script.php?script_id=3998)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-16T20:57:27.763

我可以推荐[我的包围](http://code.google.com/p/lh-vim/wiki/lhBrackets)系统吗？

注意：更喜欢直接从 svn 存储库中获取它，新版本更容易根据我们的需要进行调整。

如果您对细节/自己动手的方式感兴趣，请查看[vim.wikia 上的相关提示](http://vim.wikia.com/wiki/Automatically_append_closing_characters)。

# database - 暂存数据库困境

> ID：451519
> 
> 赞同：11
> 
> 时间：2009-01-16T18:50:50.063
> 
> 标签：database, staging

假设有 3 个数据库

*   生产
*   分期
*   开发

据我所知，暂存数据库需要与生产数据库同步但是，

当我们在开发时，我们可以对**Dev**数据库做任何我们想做的事情并改变模式。现在来了鸡和蛋的问题。

要在 Staging 中进行测试，需要根据在 Dev 数据库中所做的更改来更改**Staging数据库架构。**但是暂存数据库需要与生产同步。

你们如何解决这个问题？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-16T22:48:47.633

您需要将所有对 dev 数据库的更改编写为按特定顺序运行的 SQL 迁移脚本。除非在脚本中，否则不要更改数据库结构。不要更新、插入或删除任何行，除非它在脚本中。

理想情况下，有一种方法可以跟踪针对您找到的任何版本的数据库运行了哪些脚本。

然后您可以按如下方式更新阶段。

*   转储生产数据库
*   使用生产转储填充阶段数据库
*   在阶段运行迁移
*   检查迁移工作（单元测试，手动检查）

一旦一切正常...

*   使用 mysqldump 命令转储 prod 数据库（因为它可能已更改）在服务器上保留备份
*   在产品上运行迁移
*   测试迁移已在 prod 上工作
*   喝啤酒（一边看错误日志）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-16T18:54:00.070

暂存需要与生产同步，直到您部署新更改为止。

或者创建一个名为 Test 的第四个环境，在该环境中验证新的升级。我们称之为 UAT/Test，它通常是 Staging 服务器上的第二个数据库。

确切的方法将取决于您如何保持同步。你真的在使用复制吗？还是只是将 Prod 备份/恢复到 Stage？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-16T18:56:25.480

“暂存数据库需要与生产同步”不正确。

生产模式（“设计”）与暂存模式同步。舞台在先，生产在后。

有时人们将生产数据转移到暂存区以帮助测试，但这可能很危险，具体取决于您所在的行业。

分期是“纯粹的”。

通过将真实数据放入纯暂存模式中，生产是从暂存构建的。

有些人做的是有两个数据库。

今天#1 是生产，#2 是登台。

明天我们计划对架构进行更改。我们将#2 升级为新设计。然后我们将数据从#1 移动到#2。

然后，当我们完成移动数据时，我们切换应用程序软件以使用#2 作为生产。

我们将#2 作为生产运行，直到进行下一次更改。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-16T18:57:17.133

我们仅使用我们的暂存数据库来测试我们的部署机制。它与生产相匹配。

我们在开发中创建我们的更改，并定期将它们部署到 QA。一旦我们准备好投入生产，我们会将所有更改汇总到一个发布包中。该发布包首先在暂存时进行测试，然后如果没有部署问题，则将其推送到生产环境。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-16T18:58:22.357

如果您负担得起添加测试环境，您可能需要考虑这一点。

否则，您基本上需要在您的开发环境中进行测试。直到您对发布有足够的信心，您可以在暂存环境中进行架构更改。进行频繁的备份并有一个良好的回滚过程，这样如果在将架构更改推送到暂存时出现问题，您总是可以回滚。

此外，比较数据库模式的好工具是[SqlCompare](http://www.red-gate.com/products/SQL_Compare/index.htm)。在推送架构更改之前，您应该始终使用类似的东西。

# .net - 将字符串转换为字节数组时，我如何知道使用哪种编码方案？

> ID：451520
> 
> 赞同：3
> 
> 时间：2009-01-16T18:51:01.637
> 
> 标签：.net, string, encoding

从我的数据库中，我得到一个很长的字符串，基本上是 xml。我需要将其更改为字节数组。

我无法解决潜在的编码问题。

进行此转换时需要注意什么？

```
 public static byte[] StringToByteArray1(string str)
    {
        return Encoding.ASCII.GetBytes(str);
    }

    public static byte[] StringToByteArray2(string str)
    {
        return Encoding.UTF8.GetBytes(str);
    } 
```

Encoding.ASCII.GetBytes 与 Encoding.UTF8.GetBytes

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-16T19:10:16.933

如果您正在处理 ASCII 字符，那么结果是相同的。

另一方面，如果您的字符串中有非 ASCII 字符（例如 π），那么：在 ASCII 编码中，这些字符将被“？”替换。

在 UTF8 中，它们将由一个（可能是几个字节的字符）表示。

可能值得指出的是，.NET 内部使用 UTF16 对其字符串进行编码。

一般来说，除非您有特定的理由不这样做，否则您可能最好使用 UTF8。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-16T19:24:04.160

在将字符串转换为字节并从应用程序中导出它们时，使用什么编码，100% 取决于将读取这些字节并将它们解释为字符串的程序。

例如，如果您正在编写一个需要 ASCII 编码文件的程序读取的文件，那么您必须使用 ASCII，如果读取程序需要 CodePage 850，那么您需要使用该编码，如果它需要 UTF-8然后你使用那​​个编码等等。

但是，如果您正在写入将由您自己的程序读取的文件，我建议您使用 UTF-8，因为该编码似乎正在成为事实上的编码。

最后，您应该知道编码是关于什么以及如何使用它。因此，如果您还没有阅读它 - 您必须阅读 Joel Spolskys 的文章[“每个软件开发人员绝对、肯定必须了解 Unicode 和字符集的绝对最低要求（没有借口！）”](http://www.joelonsoftware.com/articles/Unicode.html)。这是一篇非常好的文章。阅读！是的，你必须。

希望这可以帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-16T18:58:34.790

您应该只将 ASCII 用于遗留代码兼容性，它确实是 ASCII。请注意，这是 7 位，不支持扩展字符。

UTF-8 通常是可以的（其他人可能不同意），并且会给你 8 位的值。首选使用 Unicode (UTF-16)。

您对字节数组所做的操作将影响您是否需要 ASCII、UTF-8 或 Unicode。

[这是一个很好的参考。](http://msdn.microsoft.com/en-us/library/zs0350fy(VS.80).aspx)

# perl - 如何在 Perl 模块中创建私有函数？

> ID：451521
> 
> 赞同：36
> 
> 时间：2009-01-16T18:51:04.307
> 
> 标签：perl, module, perl-module, private-functions

我正在开发一个小的 Perl 模块，由于某种原因，我让使用我的新模块的测试驱动程序脚本调用了我认为是私有的函数之一，并且它成功了。我很惊讶，所以我开始搜索谷歌，我真的找不到任何关于如何在 Perl 模块中创建私有函数的文档......

我看到一个地方说在你的“私人”函数的右大括号后面放一个分号，像这样：

```
sub my_private_function {
...
}; 
```

我试过了，但我的驱动程序脚本仍然可以访问我想要私有的功能。

我将编写一个更简短的示例，但这就是我所追求的：

**模块 TestPrivate.pm：**

```
package TestPrivate;

require 5.004;

use strict;
use warnings;
use Carp;
use vars qw($VERSION @ISA @EXPORT @EXPORT_OK);

require Exporter;

@ISA = qw(Exporter AutoLoader);

our @EXPORT_OK = qw( public_function );
our @EXPORT    = qw( );

$VERSION = '0.01';

sub new {
    my ( $class, %args ) = @_;
    my $self = {};
    bless( $self, $class );
    $self->private_function("THIS SHOULD BE PRIVATE");
    $self->{public_variable} = "This is public";
    return $self;
}

sub public_function {
    my $self     = shift;
    my $new_text = shift;
    $self->{public_variable} = $new_text;
    print "Public Variable: $self->{public_variable}\n";
    print "Internal Variable: $self->{internal_variable}\n";
}

sub private_function {
    my $self     = shift;
    my $new_text = shift;
    $self->{internal_variable} = $new_text;
} 
```

**驱动程序：TestPrivateDriver.pl**

```
#!/usr/bin/perl
use strict;
use TestPrivate 'public_function';
my $foo = new TestPrivate();
$foo->public_function("Changed public variable");
$foo->private_function("I changed your private variable");
$foo->public_function("Changed public variable again");
$foo->{internal_variable} = "Yep, I changed your private variable again!";
$foo->public_function("Changed public variable the last time"); 
```

**驱动器输出：**

```
Public Variable: Changed public variable
Internal Variable: THIS SHOULD BE PRIVATE
Public Variable: Changed public variable again
Internal Variable: I changed your private variable
Public Variable: Changed public variable the last time
Internal Variable: Yep, I changed your private variable again! 
```

所以我在模块的最后一个右大括号后加了一个分号，但输出还是一样的。我真正发现的唯一一件事就是将此行作为第一行添加到我的 private_function 中：

```
caller eq __PACKAGE__ or die; 
```

但这似乎很hacky。我没有很多编写 Perl 模块的经验，所以也许我的模块设置不正确？perl 模块中是否可以有私有函数和变量？

谢谢你帮助我学习！

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-01-16T19:09:02.990

从`perldoc perltoot`（大约四分之一的文件）：

> Perl 不限制谁可以使用哪些方法。公共与私有的区别是按照惯例，而不是语法。（好吧，除非您使用下面“作为变量的数据成员”中描述的 Alias 模块。）有时您会看到方法名称以下划线或两个下划线开头或结尾。这个标记是一个约定，表明这些方法只对那个类是私有的，有时对它最亲近的人来说是私有的，它的直接子类。但是这种区别并不是 Perl 本身强制执行的。这取决于程序员的行为。

因此，我建议您在“私有”方法的开头添加一个或两个下划线，以帮助阻止使用。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-01-16T19:10:19.243

只有“The Kludge”将代码引用存储在词法变量中，该范围之外的任何人都无法看到：

```
my $priv_func1 = sub { my $self = shift; say 'func1'; };

sub public_sub { 
    my $self = shift;

    $priv_func1->( $self );
} 
```

而且我*想不出*一种方法来制作严格“受保护”的字段。

据我所知，就是这样（除了源过滤器......嘘。我没有提到它们......）

* * *

**编辑：**实际上，事实证明我*可以*想到一种非常混乱的受保护方式。但这可能涉及通过[`AUTOLOAD`](http://search.cpan.org/perldoc?perlsub#Autoloading__)子传递所有调用。（！！）

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-01-17T00:50:06.000

这有效：

```
my $priv_func1 = sub {
    my $self = shift; say 'func1';
};

sub public_sub { 
    my $self = shift;

    $self->$priv_func1(@_);
} 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-01-22T16:06:15.797

只需检查来电者：

```
package My;

sub new {
  return bless { }, shift;
}

sub private_func {
  my ($s, %args) = @_;
  die "Error: Private method called"
    unless (caller)[0]->isa( ref($s) );

  warn "OK: Private method called by " . (caller)[0];
}

sub public_func {
  my ($s, %args) = @_;

  $s->private_func();
}

package main;

my $obj = My->new();

# This will succeed:
$obj->public_func( );

# This will fail:
$obj->private_func( ); 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-01-16T21:28:52.457

你想做什么？也许有更好的 Perl 方式来做任何你想要完成的事情。

例如，如果您不想让人们在您的对象中乱搞，因为您想强制封装，您可以使用[Class::InsideOut 之类的](http://search.cpan.org/dist/Class-InsideOut)东西。该模块有一个 Class::InsideOut::About 文档模块来解释这个概念。还有[Object::InsideOut](http://search.cpan.org/dist/Object-InsideOut)，Brian Phillips 已经提到过。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-16T19:43:07.040

一段时间后，当您意识到不能只使用 Data::Dumper 直接转储对象或窥视对象内部以查看其数据时，这种 OO 风格开始感觉有点“不成熟”。但是，如果您想试一试，我建议您使用 [Object::InsideOut](http://search.cpan.org/perldoc?Object::InsideOut)。它支持对象的私有数据和方法以及许多其他方便的功能（访问器生成、默认构造函数等）。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-05-15T05:43:52.683

我们可以在 perl 私有函数下面写一些东西来检查是否来自同一个 obj 的调用作为`caller[0]`给包。

```
sub foo {
  my ($s, %args) = @_;
  die "Error: Private method called"
      unless (caller)[0]->isa( ref($s) );
} 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-15T21:42:14.363

如果您使用像[Moose](http://search.cpan.org/dist/Moose/)这样的系统，您可以获得公有/私有的区别，如此[处所示](http://search.cpan.org/perldoc?MooseX::MethodPrivate)。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-01-19T10:20:16.567

在您的包的文件中：将私有方法定义为 CODE-Ref，即：

```
my $private_methode = sub{}; 
```

# asp.net - 如何正确设置 IIS5 的 SMTP 服务以从我的开发环境发送电子邮件？

> ID：451523
> 
> 赞同：3
> 
> 时间：2009-01-16T18:52:22.617
> 
> 标签：asp.net, smtp, iis-5

我正在尝试使用 SmtpClient 类从 ASP.NET Web 应用程序发送电子邮件。到目前为止，我已授予对 127.0.0.1 的中继访问权限。我正在尝试将测试电子邮件发送到我的 gmail 帐户。EML 文件卡在 mailroot 的队列文件夹中。我的 WinXP 防火墙已禁用。我在代码中没有发现任何异常，但电子邮件永远不会发送到目标地址。我还尝试了其他电子邮件帐户。

```
 SmtpClient client = new SmtpClient();
        client.Host = "127.0.0.1";

        MailMessage message = new MailMessage();
        message.To.Add("myemail@gmail.com");
        message.From = "name@domain.com";
        message.Subject = subject;
        message.IsBodyHtml = false;
        message.Body = body;

        client.Send(message); 
```

这是来自 IIS SMTP 日志的片段。

```
Software: Microsoft Internet Information Services 5.1
Version: 1.0
Date: 2009-01-16 18:28:28
Fields: time c-ip cs-method cs-uri-stem sc-status 
18:28:28 127.0.0.1 EHLO - 250
18:28:28 127.0.0.1 MAIL - 250
18:28:28 127.0.0.1 RCPT - 250
18:28:28 127.0.0.1 DATA - 250
18:29:45 127.0.0.1 MAIL - 250
18:29:45 127.0.0.1 RCPT - 250
18:29:45 127.0.0.1 DATA - 250
18:30:37 127.0.0.1 QUIT - 0 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-20T12:01:17.447

根据您的网络设置方式，您可能需要告诉 IIS 将电子邮件传递到您的 Exchange 服务器以传递到外部世界。为此：
1\. 右键单击​​ IIS MMC 管理单元中的默认 SMTP 虚拟服务器节点并打开属性对话框。
2\. 转到交付选项卡，然后单击选项卡底部的高级按钮。
3\. 在智能主机框中，输入您的 Exchange 服务器的名称。（或相同的 DNS 条目，例如 smtp.mydomain.com）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-24T22:12:28.937

我一直在与同样的问题作斗争，我想我知道为什么 - 以及解决方案。

**问题以及如何测试它**
首先，我检查了我可以通过端口 25 连接。例如，通过在命令提示符下打开 telnet 并键入即可轻松完成，例如（小圆圈是它自己的字母 O，而不是符号:));

```
 o auth.smtp.1and1.co.uk 25 
```

如果它连接（而不是给你一个错误），那么它*不是*端口 25 的防火墙问题。如果它确实给你一个错误，那么首先检查你的防火墙设置，直到它工作。

接下来，我启用了 SMTP 服务的登录并勾选了所有扩展属性。然后，这在日志文件中给了我两个 URL。就我而言，它们是
[http://www.spamhaus.org/query/bl?ip=217.44.248.144](http://www.spamhaus.org/query/bl?ip=217.44.248.144)
[http://www.sorbs.net/lookup.shtml?217.44.248.144](http://www.sorbs.net/lookup.shtml?217.44.248.144)

按照这些链接，基本上很明显有人（我猜是接收服务器）正在检查并看到我正在从动态 IP 地址发送（我只是在家里通过 ADSL 执行此操作），因此将其作为垃圾邮件阻止。

**解决方案**
您需要将 SMTP 服务器配置为通过 ISP 的 SMTP 服务器进行中继。
1\. 转到 SMTP 服务的属性并转到交付 -> 高级
2\. 将 ISP 的 SMTP 服务器的名称放在“智能主机”字段中（例如 auth.smtp.1and1.co.uk）
3\. 保存4\. 返回交付选项卡，
单击出站安全选项卡
5\. 单击“基本身份验证”并指定用于访问电子邮件的用户名和密码。

笔记; 我在上面假设您必须对您的 ISP SMTP 服务器进行身份验证，并且他们对 POP3/IMAP 和 SMTP 使用相同的 uid/pwd，因为这是最常见的。您的情况可能会有所不同 - 检查您的电子邮件程序中的电子邮件设置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-11T09:20:50.713

检查您的事件查看器，然后您将看到类似这样的内容

向远程域“yahoo.com”的邮件传递失败，原因如下：发生 SMTP 协议错误。

[有关详细信息，请参阅http://go.microsoft.com/fwlink/events.asp](http://go.microsoft.com/fwlink/events.asp)上的帮助和支持中心。

（这是我的）。我认为雅虎必须有某种协议？还是我们设置了错误的协议？还在想.. 给我发电子邮件请 jokenjp@yahoo.com （主题很好，所以我不认为是垃圾邮件）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-16T20:15:53.777

我仍在测试这个 Jim，我注意到的一件事是你没有正确设置你的发件人地址。From 接受 MailAddress 类而不是字符串。

改变：

```
message.From = "name@domain.com"; 
```

至：

```
message.From = new MailAddress("name@domain.com"); 
```

在默认 SMTP 设置下：

“IP 地址：”下拉菜单是否设置为 127.0.0.1 或（全部未分配）？如果可能，将其设置为所有未分配。尝试添加绑定到您的机器的 ip 地址，以便能够通过 SMTP 服务进行中继。尽管您向主机 127.0.0.1 发送电子邮件，但它可能是从您的本地网络分配的 IP 发送的。为确保一切正常，您可能需要将中继限制中的单选按钮选择为“除以下列表之外的所有”并清除该列表。这将打开继电器以测试您的配置。一旦你弄清楚你的问题是什么，你应该限制这一点。

您的 SMTP 日志中是否列出了任何错误代码？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-19T12:07:03.207

如果代码没有返回异常，那么那里不太可能有任何异常。如果您查看原始 .EML 文件，请检查那里并寻找任何不合适的地方。

然而，最有可能的问题只是给 IIS 一个“iisreset”。这样做，您可能会看到消息开始发送。SMTP 服务器上的配置更改在重新启动之前并不总是起作用。

# c# - 解析电子邮件地址字符串的最佳方法

> ID：451529
> 
> 赞同：12
> 
> 时间：2009-01-16T18:54:13.970
> 
> 标签：c#, .net, parsing

所以我正在处理一些电子邮件标题数据，对于 to:、from:、cc: 和 bcc: 字段，电子邮件地址可以用多种不同的方式表示：

```
First Last <name@domain.com>
Last, First <name@domain.com>
name@domain.com 
```

这些变体可以以任何顺序出现在同一条消息中，全部出现在一个逗号分隔的字符串中：

```
First, Last <name@domain.com>, name@domain.com, First Last <name@domain.com> 
```

我一直在尝试想出一种方法来将此字符串解析为每个人的单独的名字、姓氏、电子邮件（如果只提供电子邮件地址，则省略名称）。

有人可以建议最好的方法吗？

我尝试在逗号上拆分，除了在第二个示例中姓氏放在第一位的情况外，这将起作用。我想这种方法可以工作，如果在我拆分之后，我检查每个元素并查看它是否包含'@'或'<'/'>'，如果没有，那么可以假设下一个元素是名。这是解决这个问题的好方法吗？我是否忽略了地址可能采用的另一种格式？

* * *

更新：也许我应该澄清一下，基本上我要做的就是将包含多个地址的字符串分解为包含地址的单个字符串，无论其格式如何。我有自己的方法来验证和提取信息从地址中，我很难找出分隔每个地址的最佳方法。

这是我想出的解决方案：

```
String str = "Last, First <name@domain.com>, name@domain.com, First Last <name@domain.com>, \"First Last\" <name@domain.com>";

List<string> addresses = new List<string>();
int atIdx = 0;
int commaIdx = 0;
int lastComma = 0;
for (int c = 0; c < str.Length; c++)
{
    if (str[c] == '@')
        atIdx = c;

    if (str[c] == ',')
        commaIdx = c;

    if (commaIdx > atIdx && atIdx > 0)
    {
        string temp = str.Substring(lastComma, commaIdx - lastComma);
        addresses.Add(temp);
        lastComma = commaIdx;
        atIdx = commaIdx;
    }

    if (c == str.Length -1)
    {
        string temp = str.Substring(lastComma, str.Legth - lastComma);
        addresses.Add(temp);
    }
}

if (commaIdx < 2)
{
    // if we get here we can assume either there was no comma, or there was only one comma as part of the last, first combo
    addresses.Add(str);
} 
```

上面的代码生成了我可以进一步处理的各个地址。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2017-05-09T06:09:55.400

There is internal `System.Net.Mail.MailAddressParser` class which has method `ParseMultipleAddresses` which does exactly what you want. You can access it directly through reflection or by calling `MailMessage.To.Add` method, which accepts email list string.

```
private static IEnumerable<MailAddress> ParseAddress(string addresses)
{
    var mailAddressParserClass = Type.GetType("System.Net.Mail.MailAddressParser");
    var parseMultipleAddressesMethod = mailAddressParserClass.GetMethod("ParseMultipleAddresses", System.Reflection.BindingFlags.NonPublic | System.Reflection.BindingFlags.Static);
    return (IList<MailAddress>)parseMultipleAddressesMethod.Invoke(null, new object[0]);
}

    private static IEnumerable<MailAddress> ParseAddress(string addresses)
    {
        MailMessage message = new MailMessage();
        message.To.Add(addresses);
        return new List<MailAddress>(message.To); //new List, because we don't want to hold reference on Disposable object
    } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-16T19:00:06.533

没有一个简单的解决方案。我建议制作一个小型状态机，逐个字符地读取并以这种方式完成工作。就像你说的那样，用逗号分隔并不总是有效。

状态机将允许您涵盖所有可能性。我敢肯定还有很多其他人你还没有看到。例如：“第一个最后一个”

查找有关此的 RFC 以发现所有可能性。对不起，我不知道号码。可能有多种，因为这是不断发展的事物。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-16T19:31:01.540

冒着产生两个问题的风险，您可以创建一个与您的任何电子邮件格式匹配的正则表达式。使用“|” 在这个正则表达式中分离格式。然后你可以在你的输入字符串上运行它并提取所有匹配项。

```
public class Address
{
    private string _first;
    private string _last;
    private string _name;
    private string _domain;

    public Address(string first, string last, string name, string domain)
    {
        _first = first;
        _last = last;
        _name = name;
        _domain = domain;
    }

    public string First
    {
        get { return _first; }
    }

    public string Last
    {
        get { return _last; }
    }

    public string Name
    {
        get { return _name; }
    }

    public string Domain
    {
        get { return _domain; }
    }
}

[TestFixture]
public class RegexEmailTest
{
    [Test]
    public void TestThreeEmailAddresses()
    {
        Regex emailAddress = new Regex(
            @"((?<last>\w*), (?<first>\w*) <(?<name>\w*)@(?<domain>\w*\.\w*)>)|" +
            @"((?<first>\w*) (?<last>\w*) <(?<name>\w*)@(?<domain>\w*\.\w*)>)|" +
            @"((?<name>\w*)@(?<domain>\w*\.\w*))");
        string input = "First, Last <name@domain.com>, name@domain.com, First Last <name@domain.com>";

        MatchCollection matches = emailAddress.Matches(input);
        List<Address> addresses =
            (from Match match in matches
             select new Address(
                 match.Groups["first"].Value,
                 match.Groups["last"].Value,
                 match.Groups["name"].Value,
                 match.Groups["domain"].Value)).ToList();
        Assert.AreEqual(3, addresses.Count);

        Assert.AreEqual("Last", addresses[0].First);
        Assert.AreEqual("First", addresses[0].Last);
        Assert.AreEqual("name", addresses[0].Name);
        Assert.AreEqual("domain.com", addresses[0].Domain);

        Assert.AreEqual("", addresses[1].First);
        Assert.AreEqual("", addresses[1].Last);
        Assert.AreEqual("name", addresses[1].Name);
        Assert.AreEqual("domain.com", addresses[1].Domain);

        Assert.AreEqual("First", addresses[2].First);
        Assert.AreEqual("Last", addresses[2].Last);
        Assert.AreEqual("name", addresses[2].Name);
        Assert.AreEqual("domain.com", addresses[2].Domain);
    }
} 
```

这种方法有几个缺点。一是它不验证字符串。如果字符串中有任何不符合您选择的格式之一的字符，那么这些字符将被忽略。另一个是接受的格式都在一个地方表达。您不能在不更改整体正则表达式的情况下添加新格式。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2016-09-23T07:49:12.693

Your 2nd email example is not a valid address as it contains a comma which is not within a quoted string. To be valid it should be like: `"Last, First"<name@domain.com>`.

As for parsing, if you want something that is quite strict, you could use `System.Net.Mail.MailAddressCollection`.

If you just want to your input split into separate email strings, then the following code should work. It is not very strict but will handle commas within quoted strings and throw an exception if the input contains an unclosed quote.

```
public List<string> SplitAddresses(string addresses)
{
    var result = new List<string>();

    var startIndex = 0;
    var currentIndex = 0;
    var inQuotedString = false;

    while (currentIndex < addresses.Length)
    {
        if (addresses[currentIndex] == QUOTE)
        {
            inQuotedString = !inQuotedString;
        }
        // Split if a comma is found, unless inside a quoted string
        else if (addresses[currentIndex] == COMMA && !inQuotedString)
        {
            var address = GetAndCleanSubstring(addresses, startIndex, currentIndex);
            if (address.Length > 0)
            {
                result.Add(address);
            }
            startIndex = currentIndex + 1;
        }
        currentIndex++;
    }

    if (currentIndex > startIndex)
    {
        var address = GetAndCleanSubstring(addresses, startIndex, currentIndex);
        if (address.Length > 0)
        {
            result.Add(address);
        }
    }

    if (inQuotedString)
        throw new FormatException("Unclosed quote in email addresses");

    return result;
}

private string GetAndCleanSubstring(string addresses, int startIndex, int currentIndex)
{
    var address = addresses.Substring(startIndex, currentIndex - startIndex);
    address = address.Trim();
    return address;
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-16T19:16:48.543

对此没有通用的简单解决方案。您想要的 RFC 是[RFC2822](https://www.rfc-editor.org/rfc/rfc2822)，它描述了电子邮件地址的所有可能配置。你将得到的最好的**正确**方法是实现一个基于状态的标记器，它遵循 RFC 中指定的规则。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-16T20:27:32.753

这是我想出的解决方案：

```
String str = "Last, First <name@domain.com>, name@domain.com, First Last <name@domain.com>, \"First Last\" <name@domain.com>";

List<string> addresses = new List<string>();
int atIdx = 0;
int commaIdx = 0;
int lastComma = 0;
for (int c = 0; c < str.Length; c++)
{
if (str[c] == '@')
    atIdx = c;

if (str[c] == ',')
    commaIdx = c;

if (commaIdx > atIdx && atIdx > 0)
{
    string temp = str.Substring(lastComma, commaIdx - lastComma);
    addresses.Add(temp);
    lastComma = commaIdx;
    atIdx = commaIdx;
}

if (c == str.Length -1)
{
    string temp = str.Substring(lastComma, str.Legth - lastComma);
    addresses.Add(temp);
}
}

if (commaIdx < 2)
{
    // if we get here we can assume either there was no comma, or there was only one comma as part of the last, first combo
    addresses.Add(str);
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-07-29T14:53:58.167

The clean and short solution is to use [MailAddressCollection](https://docs.microsoft.com/en-us/dotnet/api/system.net.mail.mailaddresscollection?view=netframework-4.8):

```
var collection = new MailAddressCollection();
collection.Add(addresses); 
```

This approach parses a list of addresses separated with colon `,`, and validates it according to RFC. It throws `FormatException` in case the addresses are invalid. As suggested in other posts, if you need to deal with invalid addresses, you have to pre-process or parse the value by yourself, otherwise recommending to use what .NET offers without using reflection.

### Sample:

```
var collection = new MailAddressCollection();
collection.Add("Joe Doe <doe@example.com>, postmaster@example.com");

foreach (var addr in collection)
{
  // addr.DisplayName, addr.User, addr.Host
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-16T19:15:14.037

您可以使用正则表达式尝试将其分开，试试这个人：

```
^(?<name1>[a-zA-Z0-9]+?),? (?<name2>[a-zA-Z0-9]+?),? (?<address1>[a-zA-Z0-9.-_<>]+?)$ 
```

将匹配：`Last, First test@test.com`; `Last, First <test@test.com>`; `First last test@test.com`; `First Last <test@test.com>`. 您可以在末尾的正则表达式中添加另一个可选匹配项，以获取`First, Last <name@domain.com>, name@domain.com`用尖括号括起来的电子邮件地址之后的最后一段。

希望这会有所帮助！

编辑：

当然，您可以在每个部分中添加更多字符以接受正在读取的任何格式的引号等。正如 sjbotha 所提到的，这可能很困难，因为提交的字符串不一定是固定格式。

[此链接](http://www.regular-expressions.info/email.html)可以为您提供有关使用正则表达式匹配和验证电子邮件地址的更多信息。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-16T19:21:57.130

这是我的做法：

*   您可以尝试尽可能地标准化数据，即去掉 < 和 > 符号以及“.com”之后的所有逗号。您将需要逗号分隔名字和姓氏。
*   去掉多余的符号后，将每个分组的电子邮件记录作为字符串放在一个列表中。如果需要，您可以使用 .com 来确定在哪里拆分字符串。
*   在字符串列表中获得电子邮件地址列表后，您可以仅使用空格作为分隔符进一步拆分电子邮件地址。
*   最后一步是确定什么是名字，什么是姓氏等。这将通过检查 3 个组件来完成： 逗号，表示它是姓氏；一种 。这将表明实际地址；剩下的就是名字。如果没有逗号，那么名字是第一名，姓氏是第二名，等等。

    我不知道这是否是最简洁的解决方案，但它可以工作并且不需要任何高级编程技术

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-05-29T12:35:25.840

// **基于迈克尔佩里的回答******** // 需要处理 first.last@domain.com、first_last@domain.com 和相关语法 // 还要在这些电子邮件语法中查找名字和姓氏***

 ***```
public class ParsedEmail
{
    private string _first;
    private string _last;
    private string _name;
    private string _domain;

    public ParsedEmail(string first, string last, string name, string domain)
    {
        _name = name;
        _domain = domain;

        // first.last@domain.com, first_last@domain.com etc. syntax
        char[] chars = { '.', '_', '+', '-' };
        var pos = _name.IndexOfAny(chars);

        if (string.IsNullOrWhiteSpace(_first) && string.IsNullOrWhiteSpace(_last) && pos > -1)
        {
            _first = _name.Substring(0, pos);
            _last = _name.Substring(pos+1);
        }
    }

    public string First
    {
        get { return _first; }
    }

    public string Last
    {
        get { return _last; }
    }

    public string Name
    {
        get { return _name; }
    }

    public string Domain
    {
        get { return _domain; }
    }

    public string Email
    {
        get
        {
            return Name + "@" + Domain;
        }
    }

    public override string ToString()
    {
        return Email;
    }

    public static IEnumerable<ParsedEmail> SplitEmailList(string delimList)
    {
        delimList = delimList.Replace("\"", string.Empty);

        Regex re = new Regex(
                    @"((?<last>\w*), (?<first>\w*) <(?<name>[a-zA-Z_0-9\.\+\-]+)@(?<domain>\w*\.\w*)>)|" +
                    @"((?<first>\w*) (?<last>\w*) <(?<name>[a-zA-Z_0-9\.\+\-]+)@(?<domain>\w*\.\w*)>)|" +
                    @"((?<name>[a-zA-Z_0-9\.\+\-]+)@(?<domain>\w*\.\w*))");

        MatchCollection matches = re.Matches(delimList);

        var parsedEmails =
                   (from Match match in matches
                    select new ParsedEmail(
                            match.Groups["first"].Value,
                            match.Groups["last"].Value,
                            match.Groups["name"].Value,
                            match.Groups["domain"].Value)).ToList();

        return parsedEmails;

    }

} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-09-04T23:34:04.523

我决定在两个限制条件下划清界限：

1.  To 和 Cc 标头必须是 csv 可解析字符串。
2.  MailAddress 无法解析的任何内容，我都不会担心。

我还决定我只对电子邮件地址而不是显示名称感兴趣，因为显示名称非常有问题且难以定义，而我可以验证电子邮件地址。所以我使用 MailAddress 来验证我的解析。

我将 To 和 Cc 标头视为 csv 字符串，同样，任何无法以这种方式解析的内容我都不担心。

```
private string GetProperlyFormattedEmailString(string emailString)
    {
        var emailStringParts = CSVProcessor.GetFieldsFromString(emailString);

        string emailStringProcessed = "";

        foreach (var part in emailStringParts)
        {
            try
            {
                var address = new MailAddress(part);
                emailStringProcessed += address.Address + ",";
            }
            catch (Exception)
            {
                //wasn't an email address
                throw;
            }
        }

        return emailStringProcessed.TrimEnd((','));
    } 
```

**编辑**

进一步的研究表明，我的假设是好的。阅读规范[RFC 2822](https://www.rfc-editor.org/rfc/rfc2822#page-7)几乎可以看出 To、Cc 和 Bcc 字段是 csv 可解析字段。所以是的，这很困难，并且有很多陷阱，就像任何 csv 解析一样，但是如果你有一种可靠的方法来解析 csv 字段（ Microsoft.VisualBasic.FileIO 命名空间中的[TextFieldParser](https://msdn.microsoft.com/en-us/library/Microsoft.VisualBasic.FileIO.TextFieldParser(v=VS.110).aspx)是，并且是我用于此的） ，那么你就是金子。

**编辑 2**

显然它们不需要是有效的 CSV 字符串......引号真的把事情搞砸了。所以你的 csv 解析器必须是容错的。我让它尝试解析字符串，如果失败，它会删除所有引号并重试：

```
public static string[] GetFieldsFromString(string csvString)
    {
        using (var stringAsReader = new StringReader(csvString))
        {
            using (var textFieldParser = new TextFieldParser(stringAsReader))
            {
                SetUpTextFieldParser(textFieldParser, FieldType.Delimited, new[] {","}, false, true);

                try
                {
                    return textFieldParser.ReadFields();
                }
                catch (MalformedLineException ex1)
                {
                    //assume it's not parseable due to double quotes, so we strip them all out and take what we have
                    var sanitizedString = csvString.Replace("\"", "");

                    using (var sanitizedStringAsReader = new StringReader(sanitizedString))
                    {
                        using (var textFieldParser2 = new TextFieldParser(sanitizedStringAsReader))
                        {
                            SetUpTextFieldParser(textFieldParser2, FieldType.Delimited, new[] {","}, false, true);

                            try
                            {
                                return textFieldParser2.ReadFields().Select(part => part.Trim()).ToArray();
                            }
                            catch (MalformedLineException ex2)
                            {
                                return new string[] {csvString};
                            }
                        }
                    }
                }
            }
        }
    } 
```

它不会处理的一件事是电子邮件中引用的帐户，即“Monkey Header”@stupidemailaddresses.com。

这是测试：

```
[Subject(typeof(CSVProcessor))]
public class when_processing_an_email_recipient_header
{
    static string recipientHeaderToParse1 = @"""Lastname, Firstname"" <firstname_lastname@domain.com>" + "," +
                                           @"<testto@domain.com>, testto1@domain.com, testto2@domain.com" + "," +
                                           @"<testcc@domain.com>, test3@domain.com" + "," +
                                           @"""""Yes, this is valid""""@[emails are hard to parse!]" + "," +
                                           @"First, Last <name@domain.com>, name@domain.com, First Last <name@domain.com>"
                                           ;

    static string[] results1;
    static string[] expectedResults1;

    Establish context = () =>
    {
        expectedResults1 = new string[]
        {
            @"Lastname",
            @"Firstname <firstname_lastname@domain.com>",
            @"<testto@domain.com>",
            @"testto1@domain.com",
            @"testto2@domain.com",
            @"<testcc@domain.com>",
            @"test3@domain.com",
            @"Yes",
            @"this is valid@[emails are hard to parse!]",
            @"First",
            @"Last <name@domain.com>",
            @"name@domain.com",
            @"First Last <name@domain.com>"
        };
    };

    Because of = () =>
    {
        results1 = CSVProcessor.GetFieldsFromString(recipientHeaderToParse1);
    };

    It should_parse_the_email_parts_properly = () => results1.ShouldBeLike(expectedResults1);
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-01-09T12:17:11.707

Here's what I came up with. It assumes that a valid email address must have one and only one '@' sign in it:

```
 public List<MailAddress> ParseAddresses(string field)
    {
        var tokens = field.Split(',');
        var addresses = new List<string>();

        var tokenBuffer = new List<string>();

        foreach (var token in tokens)
        {
            tokenBuffer.Add(token);

            if (token.IndexOf("@", StringComparison.Ordinal) > -1)
            {
                addresses.Add( string.Join( ",", tokenBuffer));
                tokenBuffer.Clear();
            }
        }

        return addresses.Select(t => new MailAddress(t)).ToList();
    } 
```

* * *

## 回答 #13

> 赞同：-2
> 
> 时间：2010-01-29T16:24:23.530

我在 Java 中使用以下正则表达式从符合 RFC 的电子邮件地址获取电子邮件字符串：

```
[A-Za-z0-9]+[A-Za-z0-9._-]+@[A-Za-z0-9]+[A-Za-z0-9._-]+[.][A-Za-z0-9]{2,3} 
```

# c# - 托管/非托管应用程序的良好日志库？

> ID：451534
> 
> 赞同：3
> 
> 时间：2009-01-16T18:55:50.987
> 
> 标签：c#, .net, c++, logging

对于这种情况，您会推荐什么日志库或方法：

*   我们希望能够从托管和非托管代码中记录
*   对于非托管代码，实现不应交叉回到托管代码，因为这可能会导致我们的非托管线程在垃圾回收期间被“捕获”。
*   性能是一个问题

[NLog](http://www.nlog-project.org/)提供了一个“C” api，但是根据它的托管实现来实现它。

那里的许多 C 日志库（[rlog](http://www.arg0.net/rlog)、[glog](http://code.google.com/p/google-glog/)）都依赖于宏 + 预处理，并且如果不进行大量修改就无法使用 .NET 进行包装。

我想我正在寻找具有本机/非托管日志记录核心的东西，但也需要一个不错的 .NET 托管 API。这存在吗？如果这不存在，那么最接近的是什么？

跟进 - 感谢您提到 log4net 的回复。我认为 Log4Net 和 NLog 在纯托管应用程序中都表现良好，-但是-... 我被要求构建的应用程序在后台线程上具有非托管 I/O，绝对不能被垃圾收集停止。如果非托管 c++ 代码必须调用“up”到托管记录器中，则它有可能在垃圾收集发生时被冻结 200 甚至 2000 毫秒。这就是为什么我正在寻找一个核心不受管理的库。- 戴夫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-17T17:36:57.403

你看过[log4net](http://logging.apache.org/log4net/release/features.html)吗？

我不确定核心是非托管的还是托管的，但我已经看到它在几个 .NET 项目中使用过。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-17T18:02:32.547

我在 C# 和 VB .Net 项目中大量使用了 log4net。自从几年前 .Net 和 Java 成为我的主要编程环境以来，我还没有在 C++ 中使用过它，所以我没有在 C++ 中使用过它。但是在使用了很多 log4j 和 log4net 之后，我可以保证它们的性能和易用性。

链接

**[log4cxx](http://logging.apache.org/log4cxx/index.html)** C++
**[日志记录log4net](http://logging.apache.org/log4net/index.html)** .Net 日志记录

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-18T02:48:18.100

[Pantheios](http://pantheios.sourceforge.net/)可能会满足您的要求。它是开源的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-02-14T04:22:27.800

您能否以某种方式向您的托管 .NET 代码公开一个非托管方法，以便实际上从非托管端处理所有日志记录？

我已经使用了 C++ 的 boost 库，它们对我来说效果很好。

# c++ - 断点命中后的 Visual Studio 2008 查看对话框

> ID：451535
> 
> 赞同：1
> 
> 时间：2009-01-16T18:55:53.327
> 
> 标签：c++, visual-studio, mfc, modal-dialog, breakpoints

我正在构建一个 C++ MFC 应用程序，它一次创建一个模式对话框，同时隐藏父对话框。我希望在 Visual Studio 中调试时遇到断点时查看新创建的模式对话框。但是，只要遇到断点，对话框的内容就不再呈现。盒子只是变白，或者保留在它上面施加的任何图像。程序恢复时对话框正常显示，但我需要能够在断点被命中时查看对话框，而程序被 Visual Studio 调试器“暂停”。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-16T19:03:41.080

你不能这样做：重绘对话框的内容需要程序正在运行。如果它在断点处停止，则它没有运行。

这可能是因为您拥有 Visual Studio 和您的程序共享屏幕空间，因此 Visual Studio 出现在您的程序上方。当您将程序置于最前面时，它需要重新绘制（但不能因为它处于断点处）。

首先想到的是获得另一个监视器，并确保 Visual Studio 和您的程序在不同的监视器上运行——这样，您的程序不需要重新绘制自己，并且您应该看到以前的内容在对话框上。

或者，让两台计算机从一台计算机远程调试到另一台计算机——同样，您的程序不需要重新绘制自己，因此您应该仍然可以看到之前的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-17T01:16:50.063

您还可以做一件事，暂时放在`dialog.Invalidate(); dialog.SendMessage(WM_PAINT);`断点之后，确保 Visual Studio 和对话框没有重叠，然后跳过绘制消息。如果对话框是空白的，它应该填充。

设置远程调试有很多陷阱，但一旦掌握了它，它就会变得非常宝贵。它肯定会照顾您当前的情况，一旦您准备好环境，您将更快地解决未来的错误。很多时候我遇到一个问题说，“如果我只有一个好的远程调试环境，我会做 A，但我会先尝试劣质的解决方案 B……”

# c# - TDD：你会如何在这门课上工作，测试优先的风格？

> ID：451541
> 
> 赞同：4
> 
> 时间：2009-01-16T18:57:28.537
> 
> 标签：c#, tdd, mocking, test-first

我正在编写一个小应用程序来自学 ASP.NET MVC，它的一个功能是能够在亚马逊（或其他网站）搜索书籍并将它们添加到“书架”。

所以我创建了一个名为 IBookSearch 的接口（使用方法 DoSearch），以及一个看起来像这样的 AmazonSearch 实现

```
public class AmazonSearch : IBookSearch
{
   public IEnumerable<Book> DoSearch(string searchTerms)
   {  
      var amazonResults = GetAmazonResults(searchTerms);
      XNamespace ns = "http://webservices.amazon.com/AWSECommerceService/2005-10-05";
      var books= from item in amazonResults.Elements(ns + "Items").Elements(ns + "Item")
                 select new Book
                 {
                      ASIN = GetValue(ns, item, "ASIN"),
                      Title = GetValue(ns, item, "Title"),
                      Author = GetValue(ns, item, "Author"),
                      DetailURL = GetValue(ns, item, "DetailPageURL")
                 };
      return books.ToList();
  }

  private static XElement GetAmazonResults(string searchTerms)
  { 
      const string AWSKey = "MY AWS KEY";
      string encodedTerms = HttpUtility.UrlPathEncode(searchTerms);
      string url = string.Format("<AMAZONSEARCHURL>{0}{1}",AWSKey, encodedTerms);
      return XElement.Load(url);
  }

  private static string GetValue(XNamespace ns, XElement item, string elementName)
  {
     //Get values inside an XElement
  }

} 
```

理想情况下，我希望完成这种 TDD 风格，首先编写一个测试。但我必须承认我很难理解它。

我可以创建一个实现 DoSearch() 的 FakeSearch 并返回一些临时书籍，但我认为目前这不会带来任何价值，不是吗？也许稍后当我有一些使用书籍列表的代码时。

What else could I test first? The only test I can think of would be one that mocks the call to the cloud (at GetAmazonResults) and then checks that DoSearch can execute the Linq2XML select correctly and return the correct list. But it seems to me that this type of test can only be written after I have some code in place so I know *what* to mock.

Any advice on how you guys and girls would go around doing this test-first style?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-16T19:03:58.507

It seems that your main issue here is knowing when to write mock code. I see your point: if you haven't written the code yet, how can you mock it?

I think the answer is that you want to start your TDD with very, very simple tests, as Kent Beck does in [*Test Driven Development*](https://rads.stackoverflow.com/amzn/click/com/0321146530). Start by writing a test that calls DoSearch and asserts that what you receive isn't null, and write some code to make that pass. Then write a test that asserts that you're retrieving the proper number of Books for a known search term, and write the code to make that pass. Eventually you'll get to a point where you need to receive actual, valid Book data to pass a test, and at that point, you'll have a portion of DoSearch written, and you can think about mocking it (or portions of it).

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-16T19:26:14.203

You'll want to write a mock when you're testing code that uses the search, not for testing the search itself.

For the class above, I might test by:

*   searching for a common book and checking that is was found and is valid.
*   searching for a random fixed string "kjfdskajfkldsajklfjafa" and making sure no books were found
*   etc

But.. and here's the big one, I'd never mock out a class I was testing, I'd mock out classes that it used.

Long story short: FakeSearch would be used when testing that the UI was working properly when the Search button was pressed. I could ensure that it was getting invoked, and that the UI was handling the returned books properly.

Hope that helps.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-06-16T21:15:44.447

In this class the main focus appears to be that it integrates correctly with Amazon's web services. Since that web service is not something you own, you shouldn't mock it, because you don't have intimate knowledge of how it works. ["Only mock types you own"](http://www.mockobjects.com/2008/11/only-mock-types-you-own-revisited.html), ["don't mock third-party libraries"](http://www.mockobjects.com/2007/04/test-smell-everything-is-mocked.html) etc.

Here are some ways to approach the problem:

**Write a test which connects to the *real* web service over the network**, perhaps searching for some very popular book which you can trust will be around for years to come. This gives good assurance that you are using the service correctly, but it's also subject to many false positives - for example sometimes the network might be down or then the data in the remote system changes. Thus you will also need tests which...

**Write tests against static data files**, which are based on data from the real web service. To get the test data, you could manually do requests to the web service and write the responses to file*. You will need to mock the network connection (either using a stub which does no networking, or by starting up an embedded web server in the tests and connecting to it instead of the real URL). This way you can easily test all kinds of corner cases and error conditions, and the data will always be available and stay the same, regardless of what happens to the real web service. One caveat is that if the API of the real web service changes, these tests will not notice it, so you will also need some tests written against the real web service (as mentioned above).

[* For example, once I used cron and a little shell script to download every few minutes data from a web service, which contained ever changing schedule information. Gathering such data for a period of a few weeks was very useful as test data. From that data I hand-crafted static responses which contained all kinds of special cases which I noticed in the real data. It was also useful for setting up a fake web service and a "time machine" which replayed that earlier captured data, so that our system could be used without access to the real web service.]

# .net - 多数据库支持

> ID：451542
> 
> 赞同：4
> 
> 时间：2009-01-16T18:58:07.550
> 
> 标签：.net

在创建具有多数据库支持的应用程序时，使用 Enterprise Library 与使用 OleDb 类型的通用对象有哪些优点和缺点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-19T16:40:30.940

在不真正了解“企业库”与“通用 OleDb”的区别的情况下，我建议您在着手开发适用于许多数据库的应用程序之前要非常小心。当然，创建一些接口很好，这样人们就不知道他们在调用什么，但是所有的数据库都不一样，甚至不一样。最终，您最终会按照“最小公分母”编写代码，从而使您的应用程序无法享受现代数据库带来的好处。您还必须处理严重的应用程序逻辑问题，例如，一些数据库编写器会阻塞读取器，而其他读取器从不锁定。关于并发进程如何与数据库交互的假设可能会超出您漂亮的封装接口，并且可能难以调试。

我的建议：

a）如果您使用数据库进行简单的持久性并希望它“在任何地方运行”，只需使用它自己的多平台数据库（平面文件、sqllite 等）发布您的应用程序。

b) 如果您真的想针对“任何数据库”运行，只需使用休眠类型的接口，并确保所有项目参与者都意识到他们的代码在不同平台上执行时会出现的语义差异，并竭尽全力让更好的数据库表现得像更糟糕的数据库。

c) （首选）- 放弃主动性，选择一个好的数据库并针对它编写应用程序，充分利用数据库的能力。

我在这条路上走过很多次。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-19T17:29:35.583

如果您选择开发自己的多数据库 DAL 或使用企业库，则没有真正的优势或劣势。如果您使用企业库，它可以让 ua 快速开始，但也可以做比您需要的更多的事情，并且有更多的代码。在这种情况下，请仔细查看为您的应用程序构建一个 XMLish 配置文件，您可以对其进行定制以适应一种或多种类型的数据库。如果在多个数据库上工作不是主要问题，那么让多个数据库工作将占用大量时间。

# c# - 如何使用 Crystal Reports 动态修改报表？

> ID：451552
> 
> 赞同：1
> 
> 时间：2009-01-16T19:00:30.323
> 
> 标签：c#, dynamic, crystal-reports

我想知道我可以动态修改现有的 Crystal Report *（使用 C# 和 Crystal Reports 2008）*，以便它可以使用相同的布局报告根本不同的数据（来自同一数据库）。原因是我们正在构建一个允许用户指定的应用程序：

1.  一个过滤器，以便只显示他们感兴趣的数据（即 where 子句）。
    *   *[例如，仅显示纽约市的建筑物]*
2.  指定显示哪些表
    *   *[例如，显示建筑物和楼层，但不显示房间]*
3.  指定显示哪些字段
    *   *[例如，显示建筑物编号、编号、名称、地址和楼层号]*
4.  更改部分的分组方式
    *   *[例如，按建筑用途、建造年份等分组]*
5.  更改图表中使用的字段
    *   *[例如，按建筑物用途划分的面积、按建筑物用途划分的占用率、按建筑物 ID 划分的面积]*

由于 UI 的灵活性，用户可以尝试报告许多不同类型的“问题”，我不想为每个可能的组合创建报告。有关我正在尝试完成的示例，请参见下图。左侧的报告描绘了按区域分组的建筑物。右侧的报告描绘了按地点分组的建筑物。

[报告比较 http://img119.imageshack.us/img119/9052/performancereportcomparbt7.png](http://img119.imageshack.us/img119/9052/performancereportcomparbt7.png)

*编辑：*

我将尝试按照 Philippe Grondier 的建议使用报告参数来修改报告。我通过压制团体成功地做到了这一点。当一个组被抑制时，组会向上滑动以填充空白区域，以便所有内容都排成一行而没有空白。但是，对于单个文本对象，情况并非如此。当一个文本对象被抑制时，该字段的输出是一个空白区域。我想做的是抑制一个文本对象，这样整行都被抑制了，这将导致它下面的所有条目“碰撞”一行。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-20T11:17:15.117

根据更新的类型（以及更新所涉及的对象），您可以使用免费的 craxdrt.dll（设计器运行时库。）或非免费的 craxddrt.dll（设计器设计和运行时库）。我忘记了细节，但你肯定会在网上找到它们。

你的问题：

1.  过滤器：可以在运行时更新报表对象的 SQLQueryString 或更新预先声明的参数，以便将它们添加到“Where”子句中。我认为添加参数仅限于 craxddrt dll，但可以使用 craxdrt dll 更新现有参数。您可以使用 CR 界面来更新这些参数，或者通过代码来完成：一种想法是在您的客户端界面中更新这些值（例如，从活动表单中）并以编程方式更新它们。请[在此处](https://stackoverflow.com/questions/382256/crystal-reports-default-parameters#382492)查看示例。
2.  隐藏表：我认为“隐藏表”没有任何意义，因为您需要在表中提供所有关系来计算汇总值。因此，您可以向您的用户建议查看/隐藏详细信息或查看/隐藏您的不同分组级别的可能性。这可以通过免费的 craxdrt 库和报告对象的“区域”收集/“抑制”方法轻松完成。
3.  再一次，使用报告的不同区域似乎是最好的解决方案
4.  我劝你不要考虑！更改数据顺序可能会导致不可预知的结果，特别是当您在组级别计算中间摘要时。根据您的要求，您可以坚持建议 (2)，通过在报告上不显示特定组，或者，对于简单的表单（仅 1 组），在运行时以编程方式更新将在组定义中使用的参数公式。
5.  回到提案（2）：构建一个完整的报告，将所有预期的数据显示出来，然后隐藏/显示报告的不同部分。

[这里](https://stackoverflow.com/questions/204611/crystal-report-datasource-remap#217756)还有另一个代码示例，向您展示如何在运行时将报表连接更改为不同的数据库/不同的表。

# ruby-on-rails - 使用模型作为搜索查询时，acts_as_solr 返回数据库中的所有行

> ID：451567
> 
> 赞同：1
> 
> 时间：2009-01-16T19:07:17.470
> 
> 标签：ruby-on-rails, ruby, lucene, solr

在我们的应用程序中，我们使用acts_as_solr 进行搜索。除了使用模型名称作为搜索查询会返回表中的每一行之外，一切似乎都运行得很顺利。

例如，假设我们有一个 users 表。我们在模型中指定acts_as_solr 来搜索字段名、姓和句柄acts_as_solr :fields => [:handle, :lname, :fname]。当您使用“用户”作为搜索词时，它会返回系统中的每个用户，或数据库中的每一行作为结果。

有没有其他人遇到过这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-04-01T19:52:06.803

这是由于acts_as_solr 在parser_methods.rb 中构建查询的方式

您需要在 parser_methods.rb 中进行一些更改

改变

```
models =  "AND #{solr_configuration[:type_field]}:#self.name}" 
```

至

```
models =  "#{solr_configuration[:type_field]}:#self.name}" 
```

然后不要将构造的模型字符串包含到查询中。

```
query = "(#{query.gsub(/ *: */,"_t:")}) #{models}" 
```

将其更改为

```
query = "(#{query.gsub(/ *: */,"_t:")})" 
```

现在您需要将此查询的模型部分强制搜索到 SOLR。

我做了这个......

```
query_options[:fq_model] = models 
```

转到standard.rb

确保添加

```
:fq_model 
```

到 VALID_PARAMS 数组中。

添加了以下内容

```
if @params[:fq_model]
 hash["fq"] = @params[:fq_model]
end 
```

我添加了一些额外的案例，但除非你想在 find_by_solr 上设置 :fq 选项，否则你不应该需要它们。

在我把这些都准备好之后，我现在可以搜索模型名称，并且我得到了我期望的小得多的结果集。

很可能 multi_solr_search 也需要更新才能工作，因为查询的 type_t 部分似乎被硬编码到该方法中。

当我遇到与此问题相关的一些突出问题时，我想出了其中的大部分内容。 [Solr 1.4 中的高亮显示 - requireFieldMatch](https://stackoverflow.com/questions/2548750/highlighting-in-solr-1-4-requirefieldmatch)

# linq - LINQ to SQL——最好的学习资源？

> ID：451568
> 
> 赞同：3
> 
> 时间：2009-01-16T19:07:49.857
> 
> 标签：linq, linq-to-sql

并不是我不能自己用谷歌搜索，而是其他人比我先走这条路，我总是对其他程序员发现有用的东西感兴趣，或者没有:)

提前感谢您的任何意见。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-16T19:17:12.753

放下恕我直言，一本优秀的读物……

[http://linqinaction.net/](http://linqinaction.net/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-16T19:15:13.540

asp.net 是我去的第一个地方。

Scott Gu 的博客也有一个很好的 Linq to SQL 系列。 [http://weblogs.asp.net/scottgu/archive/2007/09/07/linq-to-sql-part-9-using-a-custom-linq-expression-with-the-lt-asp-linqdatasource- gt-control.aspx](http://weblogs.asp.net/scottgu/archive/2007/09/07/linq-to-sql-part-9-using-a-custom-linq-expression-with-the-lt-asp-linqdatasource-gt-control.aspx)

我相信有人会提到你可能想看看 Linq to Entities，因为 Linq to SQL 将来不会受到微软的太多关注。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-16T19:20:08.630

如果我是一个赌徒（我是），我会开始学习实体框架。虽然表面上的个人已经注意到这只是微软用“新”应用程序杀死流行应用程序（linqToSQL）的又一次尝试；它不是。当您深入了解具体情况时，EF 的总体愿景和方向实际上确实令人印象深刻。

然而，就我个人而言，当我阅读 Manning Press 的“ [Linq In Action](http://linqinaction.net/) ”时，灯光闪烁。[Fabrice Marguerie](http://weblogs.asp.net/fmarguerie/about.aspx)不仅是所有 LINQ 的重要资源；他有一种不可思议的能力，可以使事情变得易于阅读和理解。

# visual-studio - 安装新版本软件时如何消除“指定的服务已存在”？

> ID：451573
> 
> 赞同：17
> 
> 时间：2009-01-16T19:10:09.133
> 
> 标签：visual-studio, windows-services, installation

我有一个 VS2008 应用程序，其中包含一个服务项目（我称之为 ServiceProject）。我将安装项目 (InstallationProject) 设置为 RemovePreviousVersions。此外，**我**为 InstallationProject 设置了自定义操作，以安装、提交、回滚和卸载 ServiceProject 的主要输出。

有时，当我构建新版本的安装程序时，我可以安装而不会出现错误。通常，当我开始设置服务（在安装程序中输入用户名和密码）时，它会失败并显示错误**"The specified service already exists"**。

我不知道为什么它不一致，虽然我考虑过服务可能有某种签名，如果服务未修改，它可以成功删除它，但修改后，它无法识别服务。但是，我很少对服务进行修改，所以我怀疑就是这样。

**如何让我的安装程序成功更新服务而不会出现此错误？** 我的解决方法是手动进入控制面板，卸载以前的应用程序，然后运行安装程序。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-03-06T01:05:50.780

除了像 StingyJack 提到的那样确保文件版本不同之外，您还有另一个问题。来自 VS 文档（对不起，不在线）

> 如果您在应用程序的安装项目中同时设置了安装和卸载自定义操作，并且在 Visual Studio 2005 中启用了 RemovePreviousVersions 属性，则在升级期间将卸载该产品的先前版本。但是，此行为在 Visual Studio 2008 中更改如下：
> 
> 在 Visual Studio 2005 中，自定义操作在从 v1.0.0 升级到 v1.0.1 时调用如下：
> 
> v1.0.0 自定义动作 Uninstall()
> 
> v1.0.1 自定义操作 Install()
> 
> 在 Visual Studio 2008 中，不调用卸载操作，如下所示：
> 
> v1.0.1 自定义操作 Install()
> 
> 如果您根据旧行为创建了自定义操作，则需要针对新行为修改代码。此行为更改仅影响更新，不影响卸载。

因此，您正在使用自定义操作安装服务 - 但是在升级 Uninstall 部分时未按预期调用，并且您正在尝试在现有的、正在运行的版本上进行安装。

我*认为*当它要求重新启动是因为它在运行时无法更新服务文件。

两种选择：-

将代码添加到您的安装/提交自定义操作以停止服务，等待安装程序替换服务文件，然后重新启动服务。请参阅[此线程中 PonalSuper3 的答案](http://social.msdn.microsoft.com/Forums/en-US/winformssetup/thread/bedbb8bd-dad5-4bcb-a87a-ac69386669b4/)

[通过使用 Orca 将 InstallExecuteSequence.RemoveExistingProducts 更改为紧跟在.InstallInitialize](http://social.msdn.microsoft.com/forums/en-US/winformssetup/thread/519faa07-5b4e-4546-bfb3-6f233bf7286f/)之后 - 通常将 .RemoveExistingProducts 设置为 1525但请检查您的个人 MSI。

我添加了一个[脚本，您可以将其添加到构建过程中以更改 MSI 的 InstallExecuteSequence](https://stackoverflow.com/questions/617409/script-to-change-action-sequence-records-in-an-msi/)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2010-01-13T10:59:28.977

在 Custom Actions->Install Condition 属性中放入“Not (Installed OR PREVIOUSVERSIONSINSTALLED)”。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-16T19:46:53.227

确保在部署每个新的安装程序包时，服务的程序集版本和 GUID（在 AssemblyInfo.vb/cs 中）正在发生变化。如果它检测到相同的版本，则更新失败。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-02T19:44:51.073

以上任何与瑞安的回答有关的内容可能有所帮助，但未在上述任何内容中说明。在我这样做之前，我也遇到了同样的问题：在 Orca 中打开 .msi 并找到升级表。在 previousversioninstalled 行（是我的第一个条目）所在的位置，您应该会看到一个升级代码。找到当前安装的程序（您要升级的程序）的 .msi，找到升级代码（您可以在 orca 中执行此操作），然后将其复制并粘贴到您的新 .msi 的升级表中。这对我有用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-11-24T05:17:22.410

在您的安装程序类中尝试此代码。我希望它能解决你的问题。

```
protected override void OnBeforeInstall(IDictionary savedState)
        {
            if (LaunchOnBeforeInstall())
            {
                base.OnBeforeInstall(savedState);
            }
            else
            {
                throw new Exception("You cancelled installation");
            }
        }
        public bool LaunchOnBeforeInstall()
        {
            Form2 frm2 = new Form2();
            DialogResult result = frm2.ShowDialog();
            if (result == DialogResult.Cancel)
            {
                return false;
            }
            else
            {
                return true;
            }
        } 
```

并且还放了“NOTPREVIOUSVERSIONSINSTALLED” [![正如 Trail Image 中的 SJown](https://i.stack.imgur.com/xTCsl.jpg)](https://i.stack.imgur.com/xTCsl.jpg)

# java - java在并发机制中设计任务

> ID：451576
> 
> 赞同：1
> 
> 时间：2009-01-16T19:10:19.943
> 
> 标签：java, multithreading, concurrency

我正在设计一个基于任务的多线程 java 1.5 系统。

任务通常会与集合交互以确定失败或成功的匹配事件。根据结果​​，另一个任务可能会排队等待 IO 事务，以通知客户端和/或存储有关事务的重要信息。

Java 为线程池和任务管理提供了一组丰富的并发工具，但我正在尝试为任务本身提出最佳设计。

例如：每个任务都应该引用集合吗？任务应该如何初始化？ETC...

有没有人知道好的编码示例或说明一些不同设计可能性的任何参考资料。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-16T21:02:55.880

任何尝试在 Java 中执行多线程的人都应该阅读 Brian Goetz 的[“Java Concurrency In Practice”](http://jcip.net/)。

您不应该尝试使用低于版本 5 的任何 JDK。那是 java.util.concurrent 包首次出现的时候。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-18T05:37:09.353

一种可行的策略是让每个任务都引用一个共享的**线程安全**集合。这可行，但对于您如何使用集合（最重要的是您是否正在修改它）以及预期的并发性有一些明显的限制。如果您需要从任务中修改集合，您将在共享集合上产生某种程度的写入争用。根据线程数、哪个集合（线程安全与并发）等，这可能是一个瓶颈。甚至读取也可能导致某些集合类型的争用。

另一种选择是为每个任务提供所需的输入，让它计算结果，然后对结果进行后处理。这可以并行或不并行完成，具体取决于您的需要。

在任何情况下，您都绝对应该使用 ExecutorService，因为它可以让您结合线程池和请求队列，线程将根据需要在其中拉取和执行任务。如果有用，CompletionService 还可以添加结果队列。

# visual-studio - 神秘的外观 Visual Studio 编辑器问题

> ID：451577
> 
> 赞同：0
> 
> 时间：2009-01-16T19:10:24.093
> 
> 标签：visual-studio, ide

在 Visual Studio 代码编辑器中，我有时在白色背景上有一个无关的标记。这是一个短斜线，一个像素宽。如果我上下滚动，标记会留在原处，或多或少就像是屏幕上的划痕。

它有时在那里，有时不在那里。我不知道如何让它出现或消失。我相信当我更换机器（单独安装 VS）时，它会从一台计算机迁移到另一台计算机。它似乎根本不与内容交互。

如果我没有看到它，我不会相信这种事情是可能的。有人对可能导致它的原因有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-16T19:17:06.373

我认为我从未使用过 100% 正确绘制代码编辑器背景的 Visual Studio 版本。我见过对角线和它的许多变体。几乎可以肯定这是一个 VS 错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-16T19:11:39.100

嗯，屏幕上的划痕，也许你有时只是看不到？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-21T06:09:44.753

如果你最小化然后最大化 Visual Studio 并且标记消失，那么它可能是一个绘画错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-16T19:17:24.110

是否使用相同的媒体单独安装 VS.net？也许安装以某种方式损坏。

或者，也许您安装了另一个与 VS.net 不兼容的程序。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-16T20:01:34.867

如果两台机器有相同的显卡，我建议可能是显卡驱动问题。我记得很久以前我有一张带有驱动程序的卡，它的洪水填充功能会在我的一个应用程序的整个桌面上泄漏。

# security - Erlang : Disallowed Nodes / Maybe Cookie 问题

> ID：451583
> 
> 赞同：16
> 
> 时间：2009-01-16T19:13:15.697
> 
> 标签：security, erlang, erlang-otp

试图让两个 erlang 节点相互交谈：一个在 Ubuntu 机器上，一个在 Windows XP 上。

我们收到“**来自不允许节点的连接尝试**”消息，该消息阻止一个节点接收来自另一个节点的消息。

他们都使用 5.XXX 版本的 Erlang OTP。

两个节点都有相同的 cookie (.erlang.cookie)

我们正在启动接收器节点：

```
erl -name fred@ipaddress 
```

并使用 'fred@ipaddress' 调用函数（单引号）

我们已经关闭了防火墙。

那么还有什么可能阻止连接？

更新：我们使用 erlang:get_cookie() 来检查两个节点上的 cookie，并且值不同。这就是问题所在。我们认为我们通过将相同的 .erlang.cookie 文件放在我们在两台机器上运行 erlang 的目录中来设置 cookie。但也许这是错误的地方？

更新 2：感谢大家的回答。我们选择 Ranok 作为我们的答案，因为它对我们很有效。我敢肯定，一些设置 cookie 的替代方法也可以。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-17T15:38:12.167

此外，当您启动 Erlang 系统时，有一个命令行标志`-setcookie`可以让您在启动时指定 cookie。

```
erl -name fred@ipaddress -setcookie FOOBAR 
```

希望有帮助，雅各布

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-16T23:41:01.600

首先检查每个节点的 cookie。从外壳：

```
erlang:get_cookie(). 
```

如果它们不相同，则更改节点的其中一个 cookie 以匹配另一个：

```
erlang:set_cookie(node(), "newcookie"). 
```

如果一切正常，您需要查看为什么没有从配置文件或命令行参数中选择 cookie 设置。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-17T18:44:43.553

Erlang cookie 应该在 users 目录中。不是应用程序目录。

所以你的是这样的：

```
C:\Documents and Settings\InterstarUser\.erlang.cookie 
```

`env`如果我从 Windows 时代没记错的话，您可以在命令行中使用命令查看 HOME 的位置。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-18T19:28:30.963

**net_adm:ping()**

从两个节点尝试 net_adm:ping()。

[http://www.erlang.org/documentation/doc-5.4.13/lib/kernel-2.10.13/doc/html/net_adm.html](http://www.erlang.org/documentation/doc-5.4.13/lib/kernel-2.10.13/doc/html/net_adm.html)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-08-11T08:22:58.810

```
erlang:set_cookie(node(), 'newcookie'). 
```

不是

```
erlang:set_cookie(node(), "newcookie"). 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-16T20:04:30.913

我想到了几件事：

1.  您是否尝试过在两个节点上通过 erlang:set_cookie 设置 cookie？
2.  如果在 $HOME 目录中没有找到 .erlang.cookie 文件，则会创建一个。会不会是 .erlang.cookie 文件之一不在一台机器上的正确位置？您可以在硬盘驱动器中搜索该文件，如果您找到的不仅仅是您创建的文件，erlang 可能已将它放在那里并正在使用它。

# eclipse - Eclipse：子剪辑“编辑冲突”

> ID：451584
> 
> 赞同：1
> 
> 时间：2009-01-16T19:13:58.533
> 
> 标签：eclipse, syntax-highlighting, subclipse

我发现当使用 Subclipse 编辑冲突时，我所有的语法颜色设置都被保留了，除了背景颜色，它被重置为标准白色。使用我的特殊配色方案，当卡在白色背景上时，几乎不可能阅读任何文本。

有什么地方可以更改此默认背景颜色吗？从首选项窗口似乎没有任何方法可以做到这一点，但也许我可以编辑的地方有一个配置文件？

任何帮助将不胜感激（我的眼睛也会感谢你）！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-22T10:44:35.320

我认为您遇到了这个 Eclipse 错误：“[比较编辑器背景颜色不服从设置](https://bugs.eclipse.org/bugs/show_bug.cgi?id=80213)”。它似乎在即将发布的 3.5 中修复。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-12T11:10:51.167

这听起来像是 Eclipse 中的一个错误。您是否尝试过提交错误报告？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-12-17T14:30:07.510

据我所知，这在 3.5.1 中并未修复。

我在版本：3.5.1.R35x_v20090910-9gEeG1_FthkNDSP2odXdThaOu9GFDPn83DGB7 版本号：M20090917-0800

无论如何，差异编辑器的背景颜色仍然是白色。

上面提到的错误报告说里程碑 3 是目标，所以这可能就是为什么它对我来说仍然是一个错误。问题是 - 3.5 里程碑 3 的目标版本是否意味着该修复已合并到 eclipse 3.6 中？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-11-15T21:07:15.933

我正在使用最新的 Eclipse（靛蓝），我也有类似的问题。比较编辑器是深色的：背景是黑色的，文本不像普通的 Eclipse 编辑器那样着色。用这些颜色是不可能阅读的。这是 eclipse 的全新安装（我希望全新安装能够解决问题 - 我使用 helios 时遇到了同样的问题。但是我使用的是相同的工作区）：我现在拥有的只是 PDT、Subclipse 和一些网络工具（CSS XHTML...）

# c++ - 阻止以编程方式运行的系统命令的标准错误输出

> ID：451595
> 
> 赞同：1
> 
> 时间：2009-01-16T19:18:52.550
> 
> 标签：c++, external-process, standard-error

我在 C++ 中有这个程序：

```
#include <iostream>
using namespace std;
int main()
{
char buf[50];
cin.getline(buf,49);
system(buf);
return 0;
} 
```

当我运行并编译它并输入例如“helo”时，我的程序会打印错误：

```
 "helo" not found. 
```

我可以阻止显示此错误吗？有没有办法从系统命令中禁用错误​​？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-16T19:40:44.440

您无法更改`system`显示错误的方式。C 和 C++ 在这方面对实现几乎没有要求，因此大部分都没有指定，以使它们尽可能灵活。

如果你想要更精确的控制，你应该使用你的运行时库或操作系统接口的功能。在 linux/unix 中尝试`execvp`（请参阅`man execvp`参考资料）或 Windows 系统的 CreateProcess 函数，它使用 Windows API，可以很好地控制错误处理和其他内容。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-16T19:21:39.953

你在linux上吗？尝试输入“./hello”

如果这有效，原因是当前目录（“.”）不在搜索路径中。您必须指出已编译的程序在目录中“那里”。

或者，您可以执行类似的操作

导出路径=$PATH:。

这增加了“。” （当前目录）到搜索路径。

如果您在 Windows 上，请尝试“hello.exe”

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-16T20:07:02.687

如果您在 Linux 上，您可以尝试将错误输出重定向到`null`设备吗？

```
strcat(buf, "2> /dev/null");
system(buf); 
```

# cocoa - NSPersistentDocument 的数据存储何时移动到最终保存位置？

> ID：451597
> 
> 赞同：5
> 
> 时间：2009-01-16T19:20:04.123
> 
> 标签：cocoa, core-data

遵循核心数据编程指南的核心数据性能[页面](http://developer.apple.com/documentation/Cocoa/Conceptual/CoreData/Articles/cdPerformance.html#//apple_ref/doc/uid/TP40003468-SW5) 中关于存储 BLOB 的建议，我选择将我的 **`NSPersistenDocument-based`**应用程序的二进制数据（仅限 Leopard，如果这会有所不同）存储在外部文件中（与文档核心分开）数据数据存储）并在我的文档的数据存储中保留对该文件的存档**`NDAlias`**引用。

最终，我希望外部数据文件与文档（数据存储）文件位于同一目录中。由于我可能需要在保存文档之前将数据写入外部数据文件（这是一个科学数据采集应用程序，尽可能避免因崩溃而丢失数据），我采取了以下方法：

我想将这个外部文件的管理封装在与模型相关的类中，因为在模式迁移期间我将需要相同的功能。因此在我的子类中管理外部数据文件 **`NSPersistentDocument's`**似乎是错误的。

在对象模型的根对象中，我 **`NSTemporaryDirectory()`**在根对象**`awakeFromInsert`**方法中创建外部文件并存储**`NDAlias`**引用数据文件。

然后，当保存发生时，我想将外部数据文件移动到与保存的数据存储相同的目录。

我认为**`didSave`**这是一个合适的地方，但看起来在调用该**`didSave`**方法期间，持久存储仍然在一个临时目录中（大概是**`FSExchangeObjects'd`**在创建原子保存操作之前）。

我计划将逻辑分解到类方法中**`awakeFromInsert`**，**`didSave`**以便在模式迁移期间 `createDestinationInstancesForSourceInstance:entityMapping:manager:error: and endInstanceCreationForEntityMapping:manager:error:`分别在自定义实体策略中调用它们。

所以，我的问题是：在**`NSPersistentDocument`**保存过程中，我何时可以确定我的根对象**`objectID.persistentStore.URL`**是保存的“最终”URL（例如，用户选择保存文件以进行文档保存的位置）？

# php - 照顾 XSS

> ID：451601
> 
> 赞同：0
> 
> 时间：2009-01-16T19:21:06.367
> 
> 标签：php, security, xss

我运行了一个渗透测试应用程序，它发现了大量的 XSS 错误，具体来说，我犯了通过查询字符串将未经验证的数据回显到浏览器的错误。

具体来说，运行它会将 javascript 放入我的页面。 [http://www.mywebsite.com/search.php?q=%00](http://www.mywebsite.com/search.php?q=%00) '" [ScRiPt]%20%0a%0d>alert(426177032569)%3B[/ScRiPt]。

谢天谢地，我不允许用户将数据保存到数据库并显示回其他用户，所以我认为人们只能用这个问题破解自己，但我仍然想修复它。

建议这样做：

```
echo htmlentities($_POST[‘input’], ENT_QUOTES, ‘UTF-8’); 
```

但目前我需要尽快修复这个问题，然后根据具体情况进行修复。我在网站的每个页面上都有一个头文件，我知道它的格式不好，但是如果我这样做会发生什么：

```
array_walk($_POST, 'htmlentities'); 
```

我也需要为 COOKIE 和 GET 做这件事。我从不使用_REQUEST。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-16T22:54:42.753

HTML 转义显然是错误的事情，但在您用适当的代码替换代码之前，它可能是一个临时修复。从长远来看，它将无法维护，并且在您开始跨 & 编码的字符进行子字符串操作（包括截断，您的数据库可能会自动执行）的任何地方，您都会遇到大量奇怪的应用程序级错误。这不太可能导致安全漏洞，尽管如果不更详细地查看应用程序就无法判断。

如果您每次都在 $_SESSION 中开始编码，您将得到多重编码过长的字符串，例如 &amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp ; 很快。

> 我认为人们只能破解自己

或者，另一个网页上的攻击者可以重定向或 iframe 到您的网页，注入足够多的脚本来显示一个看起来就像您网站的假登录框，获取用户名和密码或自动删除他们的帐户。类似的东西。不是很好。

> 建议这样做： echo htmlentities($_POST['input'], ENT _QUOTES, 'UTF-8');

不需要 htmlentities 和所有这些参数 - 使用 htmlspecialchars。

您可以使用以下方式为自己节省一些按键：

```
function h($s) { echo(htmlspecialchars($s)); }
...
<?php h($POST['input']) ?> 
```

这真的没有那么多额外的麻烦。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-16T19:30:26.207

盲目地转义前端的所有输入将意味着处理该输入的程序的任何部分都必须处理 <、>、& 等的 html 转义版本。如果您将数据存储在数据库中，那么您将在您的数据库中有 html 转义的数据。如果您在非 html 上下文中使用数据（例如发送电子邮件），人们会看到 < 而不是 < 等

您可能只想在输出时转义。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-16T19:52:32.293

我最初的回应是建议您首先确保您的表示逻辑与您的业务逻辑等分开处理。

如果演示逻辑确实是独立的，那么您需要评估当前输出到屏幕的方式。您可以通过将所有输出转义到屏幕的相同函数调用来运行每个输出吗？

例如，当您实际输出到屏幕时调用 clean_output，但在对数据进行数据库操作或业务逻辑操作之前我不会这样做，因为您很可能会逃避应该保持原样的东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-16T19:47:07.907

上面的代码不起作用，但这确实：

```
$_POST = clean_input($_POST);
$_GET = clean_input($_GET);
$_COOKIE = clean_input($_COOKIE);
$_SESSION = clean_input($_SESSION);

function clean_input($array){
    if(count($array)){
        foreach ($array as $key => $value) {
            $array[$key]=htmlentities($value, ENT_QUOTES, 'UTF-8');
        }
    }
    return $array;
} 
```

我只是想弄清楚这里可能出了什么问题。

# c# - C# Silverlight 论坛组件

> ID：451609
> 
> 赞同：1
> 
> 时间：2009-01-16T19:22:39.077
> 
> 标签：c#, silverlight, controls, forum

有没有人遇到过这样的野兽？我正在考虑一个树状显示、数据库、登录和注册等。理想情况下准备烘烤，因​​为时间很短。

理想情况下是 BSD 或类似的许可证，但如果有必要，可能会说服 beancounter 咳出一些 bean。

或者，如果有人有兴趣创造一些东西，请发表评论

谢谢

G。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-05-13T23:18:12.863

Myer 现在在 Silverlight 中有一个应用程序，看看这个，

[http://www.mher.info/blog/?p=136](http://www.mher.info/blog/?p=136)

希望这可以帮助 ：）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-16T19:31:55.410

我在 Internet 上的旅行中没有看到任何 Silverlight 论坛组件。我想你可能会被困在自己身上。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-12-23T23:17:49.600

我们已经启动了一个程序来帮助人们接收他们非常需要的组件，我们现在主要关注 Silverlight 和 WPF。

您可以在此处查看更多信息[http://fpscomponents.com/Post.aspx?id=19](http://fpscomponents.com/Post.aspx?id=19)

# lisp - 您对于 Clojure 的观点是？

> ID：451619
> 
> 赞同：51
> 
> 时间：2009-01-16T19:25:45.827
> 
> 标签：lisp, clojure

你们觉得 Clojure 怎么样？我正在考虑下一步学习它，目前正在使用 Erlang，除了记录惨败之外，总体上对它很满意...... Clojure 和 LISP 一样强大吗？

* * *

## 回答 #1

> 赞同：133
> 
> 时间：2009-02-18T11:24:00.380

考虑学习它。如果没有其他原因，那么因为您可以在实际项目中实际使用它。

```
You : Can I use this small Java library called Clojure?
Boss: Why do you need it?
You : For some concurrency improvements.
Boss: Ok. 
```

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2009-03-20T10:54:01.247

Lisp-1 vs Lisp-2 所指的是函数和变量是否共享相同名称空间的问题。在 Lisp-1 Lisp 中，就像 Scheme 和 Clojure 一样，它们确实如此。在 Lisp-2 Lisp 中，就像 Common Lisp 一样，它们没有。这主要是一个品味和/或方便的问题——它不会影响编程语言的功能。

例如，在 Clojure 中，您可以这样做：

```
(defn my-apply [func arg1 arg2]
  (func arg1 arg2)) 
```

这是一个接受一个函数和两个值并将函数应用于值的函数。例如：

```
user=> (my-apply + 1 2)
3 
```

在 Common Lisp 中，你必须把它写成

```
(defun my-apply (func arg1 arg2)
  (funcall func arg1 arg2)) 
```

您需要“funcall”的原因是，由于“func”在变量的名称空间中，因此您不能像在 Clojure 中那样直接将其用作函数，而 Clojure 没有这种区别。所以你必须告诉 Common Lisp“请将此变量解释为一个函数并使用这些参数调用它”。这样做的另一个后果是，要获得相同的结果，您必须像这样调用“my-apply”：

```
=> (my-apply #'+ 1 2)
3 
```

这里的问题反过来了：“+”是一个函数，但是你想把它作为一个变量传递，所以你必须“转换”它。"#'+" 是 "(function +)" 的缩写，顺便说一句。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2009-10-07T09:20:50.047

我使用 Clojure 而不是 CL，因为：

*   它与 Java 沟通良好，所以我可以外包我的编码
*   它可以访问数以万计的 java 库，这些库可以做各种各样的事情，包括 Swing 和 Weka
*   由于它在 JVM 上运行，因此您可以更安全地假设您的问题在任何地方都有效
*   如果你可以用更少的代码展示相同的库，你可以将 Java 程序员转换为 lambda 方式
*   而且，最重要的是，我不依赖 Emacs

:wq

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2009-01-16T19:32:38.887

Clojure 是 LISP 的一种方言，所以，是的，它和 LISP 一样强大。

没有别的原因，我们现在有一个很好的 JVM 的 LISP 工具，我喜欢这种语言。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2009-01-16T19:30:35.473

我觉得这个名字很聪明。

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2009-01-16T19:49:57.307

“Clojure 有潜力在面向并发编程方面做 Java 十年前在面向对象编程方面所做的事情：使正确使用类似于程序员已经习惯了。”——比尔·克莱门森

和人一样，LISP 由一系列编程语言组成。有像 Common Lisp 和 Clojure 这样的 Lisp 方言。最重要的是，Common Lisp 或 Scheme 有很多实现。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-06-12T18:15:03.707

I used Erlang at work for coordinated network load testing and it was perfect for that because the problem was well within Erlang's "sweet spot" of "doing distributed communication oriented software correctly". I find Clojure MUCH better for code that needs to do something complex on a single box with several threads (this is a more common scenario).

You are ahead of the curve because you know Erlang and this will help you spot the problems in which it really shines. What do you thing Clojures real "sweet spot" is?

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-10-14T14:22:55.893

Clojure 是一个 Lisp-1，是的。将其视为没有所有历史包袱的更好的 Common Lisp。它还具有几个现代并发功能，例如 STM 和 Agents（他们决定不实现 Erlang 的 Actors 模型）。在 JVM 上运行的优势很简单——已经有很多库为它编写（主要是在 Java 中）。

[Clojure 中的 Clojure](http://blog.n01se.net/?p=41)是在 Clojure 中重写 Clojure 编译器的持续努力，以使其更具可移植性和可维护性。除了 core.clj，目前大部分 Clojure 都是用 Java 编写的。此举之后，可以将其移植到很多虚拟机上，包括 Parrot。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-02-19T10:45:52.210

与 Clojure 相比，我更喜欢 Common Lisp，因为它的语法更规则，而且它与可怕的（恕我直言）Java API 无关。

对于 Common Lisp，我还可以在几个优秀且经过良好测试的实现和一个可以依赖的成熟标准之间进行选择。

但如果我必须使用 Java 完成工作，那么我肯定会考虑使用 Clojure。:)

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-01-16T20:17:42.803

我所说的“Clojure 和 LISP 一样强大”的意思是我在 stackoverflow 上的某个地方读到 Common Lisp 是 lisp-2 而 Clojure 是 lisp-1？（我很容易在这里闲逛）......

就并发性而言，我真的很喜欢 Erlang 的故事，因为通过在 Actor 模型中编写应用程序来分发应用程序非常容易

来自 Clojure 的创建者，网址为[http://groups.google.com/group/clojure/browse_thread/thread/2a2b24ffef5d1631?pli=1](http://groups.google.com/group/clojure/browse_thread/thread/2a2b24ffef5d1631?pli=1)

“即使有演员，Clojure 也不会有分布式并发的故事，但我正在考虑只是采用 Erlang 的批发，将 Jinterface 用于 Clojure<->Clojure 甚至 Clojure<->Erlang 分布式进程。也许这看起来像 Termite完成了。敬请期待。”

# image - 跨平台嵌入式大图查看器

> ID：451621
> 
> 赞同：0
> 
> 时间：2009-01-16T19:26:43.530
> 
> 标签：image

我正在寻找一个可以在网页中嵌入可缩放图像的系统。这是一个教育网站，图像是 X 射线照片 - 所以我们希望显示图像全尺寸，然后允许用户放大以查看细节。最终的图像不会*那么*大——我认为 2048 平方应该覆盖它——但足够大，我们不想一次显示所有内容。像[MrSid](http://www.lizardtech.com/)这样的东西是理想的。

理想情况下，我们追求的是 FOSS 系统，并且应该在 PC 和 Mac 上显示 - 理想情况下也是 linux。基于 Java 或 Flash 就可以了。当然没有什么只是 IE（虽然必须在 IE 上工作）

我想任何合适的东西都与语言无关，但为了记录，我们使用的是 PHP。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-27T16:12:11.017

[Microsoft Silverlight](http://silverlight.net)提供 Deep Zoom（类似于 Google 地图）。

[虽然不是 FOSS，但客户端是免费的（就像啤酒一样），在 PC 和 Mac 上支持多种浏览器，并且通过Moonlight](http://en.wikipedia.org/wiki/Moonlight_(runtime))项目支持 Linux 。

开发工具的 Express 版本也可以免费下载（就像在 beer 中一样）。

它不需要任何服务器端支持（除了 Web 服务器来提供包含指向您的 Silverlight 应用程序的 OBJECT 标记的 HTML 页面）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-12-11T04:47:23.233

同样，MrSID 浏览器插件与啤酒一样免费，可在 Windows 和 OS X 上运行。

[http://www.lizardtech.com/download/dl_options.php?page=plugins](http://www.lizardtech.com/download/dl_options.php?page=plugins)

有人会认为设置服务器应用程序来提供对象/嵌入标签以实例化“ExpressView”插件不应该是火箭科学。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-21T09:39:37.343

DropViewer 几乎完全做到了这一点：[http ://www.dropviewer.com/](http://www.dropviewer.com/)

# .net - 在 Vista 中的管理工具中，Microsoft .NET Framework 配置快捷方式消失了，如何查看 GAC？

> ID：451622
> 
> 赞同：0
> 
> 时间：2009-01-16T19:27:25.417
> 
> 标签：.net, gac

我正在尝试在 Vista 上查看 GAC 中的项目，我已经安装了所有 .NET 的东西，1.0、2.0、3.5 和 3.5 SP1，但我没有看到管理工具的快捷方式。有谁知道在 GAC 中查看和编辑项目的另一种方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-16T19:29:54.943

我不在带 vista 的家用电脑前，但你的电脑上有 ac:\windows\assembly 文件夹吗？

# php - 您如何保护您的网站免受 PHP 中的本地文件包含和 SQL 注入？

> ID：451623
> 
> 赞同：4
> 
> 时间：2009-01-16T19:27:44.077
> 
> 标签：php, sql-injection

您如何保护您的网站免受本地文件包含和 SQL 注入 (PHP) 的影响？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-16T19:31:10.263

有许多措施要采取。确保在存储到数据库之前清理所有输入。我建议对将要存储的所有数据使用[mysql_real_escape_string() 。](http://us.php.net/mysql_real_escape_string)将字符输入限制为合理的长度，并确保您获得了该字段所期望的数据类型。锁定多次提交特定数据区域的尝试。抓取上传文件的内容以寻找恶意模式。

Wikibooks 有一章是关于 SQL 注入的；

*   [http://en.wikibooks.org/wiki/Programming:PHP:SQL_Injection](http://en.wikibooks.org/wiki/Programming:PHP:SQL_Injection)

名单还在继续。幸运的是，即使在这方面稍加努力，也可以修补大量漏洞。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-16T22:10:15.900

为 SQL 准备的语句（请参阅`PDO::prepare()`）或正确的转义 ( `PDO::quote()`)。

对于本地路径，您需要仔细清理输入（残酷但安全`preg_replace('/[^a-z]/','',$str)`：）或完全避免在路径中使用不受信任的数据（使用 ID、预定义字符串等）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-16T19:33:27.807

[http://php.net/manual/en/security.php](http://php.net/manual/en/security.php)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-16T21:33:13.340

为了防止 SQL 注入，我建议使用 PDO（[http://us3.php.net/pdo](http://us3.php.net/pdo)）。您需要的扩展程序等可能会阻止采用，但这是好东西。

就我个人而言，我使用了一个自制的数据库访问层，我的所有查询都通过它实现了一堆不错的功能，包括`mysql_real_escape_string()`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-26T02:04:43.110

“本地文件包含”是指您`include()`在从用户输入构建的路径上调用或类似的情况，例如在非常简单的基于文件的 CMS 或类似内容中？如果是这样，答案与 SQL 注入基本相同——您必须清理输入。

清理文件路径需要您设置一些关于可以从何处包含文件的基本规则，并无情地拒绝任何不符合要求的输入。例如，如果您只是在子目录中按名称包含文件，那么您可以应用以下基本算法：

1.  拒绝包含`.`,`..`或`/`（或`\`在 Windows 下）的文件名
2.  将文件名限制为基本的字母数字字符
3.  附加包含目录名称并附加适当的扩展名

PHP 文档有更多关于[文件系统安全](http://www.php.net/manual/en/security.filesystem.php)的信息。您还可以设置`open_basedir`将文件访问限制在特定目录树内，但这是 PHP 的“安全模式”的一部分，该模式已被弃用（将在 PHP 6.0 中删除），因为它并不是非常安全。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-16T21:53:07.933

就像其他人所说的那样，`mysql\_real\_escape\_string()`是防止 SQL 注入的最安全方法。我为我的所有 SQL 使用了一个自定义 DB 接口类，它通过一个`sanitize()`函数传递所有需要的变量。这是从类中删除的 sanitize 函数，以防你想看看它。

```
/**
* Sanitize variable for querying
*
* @param mixed $var         The variable to sanitize
* @param bool $deep         Will inspect the string deeper, converting 'null' to NULL and adding '' around strings
* @param mixed $numstrings  Whether or not to treat numbers as strings (ie add quotes)
* @return $var
*/
function sanitize($var, $deep = true, $numstrings = false) {
    if (is_array($var)) {   //run each array item through this function (by reference)
        foreach ($var as $key=>$val) {
        $var[$key] = sanitize($val, $deep, $numstrings);
        }
    }
    else if (is_null($var) || ( $deep && preg_match('/^null$/i', $var) > 0 ) ) {   //convert null variables to SQL NULL
        $var = "NULL";
    }
    else if (is_bool($var)) {   //convert boolean variables to binary boolean
        $var = ($var) ? 1 : 0;
    }
    else if ($numstrings && is_string($var)) {
        $var = mysql_real_escape_string($var);
        if ($quotes) {
        $var = "'". $var ."'";
        }
    }
    else if (!is_numeric($var)) { //clean strings
        $var = mysql_real_escape_string($var);
        if ($deep) {
        $var = "'". $var ."'";
        }
    }
    return $var;
} 
```

至于“本地文件包含”，我使用了两种不同的方法。请记住，最安全的技术是将敏感文件保存在网络无法访问的地方。

如果它只是一个文件，或者我不想让全世界看到，我只需将“.ht”附加到文件名。默认情况下，Apache 拒绝访问以“.ht”开头的文件。只需确保不要将您的文件命名为与 Apache 配置文件（.htaccess、.htpasswd 等）相同的名称。

如果您有多个不想访问的文件，请将它们全部保存在您网站的子目录中（同样，敏感文件应该在其他地方）。然后在子目录中，添加一个拒绝访问该目录的 .htaccess 文件（它们仍然可以通过 PHP 访问）。

```
#this is all you need in the file
Order Allow , Deny
Deny from all 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2012-08-25T13:50:09.263

为避免 SQL 注入在您提交之前加密您的密码

# css - 仅在特定 id 下的元素的 CSS

> ID：451626
> 
> 赞同：54
> 
> 时间：2009-01-16T19:28:31.250
> 
> 标签：css

我有一个 div 元素，它有一个 id，这个 div 包含一组输入和标签。我只想在这个特定的 div 中设置输入的样式，但是 .. 以下样式的所有内容（全局）而不是将范围保持在 #ParentDiv

```
#ParentDiv label,input { display: inline; } 
```

另外，是否可以在 IE6/7 中使用有效的 css 来做这种事情？

* * *

## 回答 #1

> 赞同：90
> 
> 时间：2009-01-16T19:30:57.563

你需要这个：

```
#ParentDiv label, #ParentDiv input { display: inline; } 
```

逗号表示新的选择器语句。

通常，为了让我记住每个选择器是什么，并且为了更容易一目了然地查看正在选择的元素，我会将选择器按字母顺序排列并分成两行，如下所示：

```
#ParentDiv input,
#ParentDiv label {
    display: inline;
} 
```

此外，这在 IE 6/7/8 中应该可以正常工作，并且根据 w3c 有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-04-14T09:27:51.307

对我来说，上面的答案对我没有帮助。我想为表头设置样式，所以我必须`table`在 id 之前附加标签，如下所示：

```
table#table_id th {
  width: 20%;
}
```

我希望这会帮助某人。

# c# - 编写 MVC 应用程序的最佳实践是什么？

> ID：451627
> 
> 赞同：2
> 
> 时间：2009-01-16T19:28:48.550
> 
> 标签：c#, model-view-controller

来自 ASP.NET Webform 和 Classic ASP。我想知道什么是最佳实践。MVC 应用程序真的不会使用服务器控件和 ViewStates 吗？如果是这样，html 表单控件的持久性将类似于经典的 ASP。谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-16T19:35:01.610

我在搬家中学到了一些重要的东西：

1）视图应该有非常有限的逻辑。如果您发现有很多 <% if(...) { %> 语句，则需要向模型添加更多信息和/或创建处理该逻辑的 HtmlHelper 扩展方法。

2) 你的控制器类应该只解释用户输入和从你的模型请求数据。如果必须对数据做出决定，控制器应该将做出这些决定所需的信息推送到模型。

3) 模型应该保留与数据相关的所有业务逻辑。部分课程是您的朋友。许多 DAL 生成器允许您使用部分来为生成的模型添加逻辑（例如 Linq to Sql 和 Subsonic）。

4) 国家是敌人。这不仅仅是 MVC；我只是想指出，您的设计需要的状态越多，它就越容易破坏。

# java - 从库代码记录到应用程序日志的策略？

> ID：451628
> 
> 赞同：6
> 
> 时间：2009-01-16T19:28:50.423
> 
> 标签：java, logging, log4j

在我工作的地方，我们使用 Log4j 进行 Web 应用程序日志记录。log4j.jar 位于应用程序级别，而不是容器级别。我们正在使用每日滚动文件附加程序。我们的 log4j.properties 文件根据应用程序包名称定义附加程序，因此只有应用程序包中及以下的类才会记录到应用程序的日志文件中。

在我的应用程序中，我使用一些支持类来扩展我们的框架。这些类不在应用程序的包中，因为它们不是我的应用程序所独有的，最终将被制作成一个 jar 库供其他应用程序使用。因此，我的日志语句不会被我的应用程序的附加程序获取，因此不会记录到我的应用程序的日志文件中。

我想允许我的 jar 中的类使用这些类登录到应用程序的日志文件。但是，如果我根据我的类名在应用程序的 log4j 属性文件中创建一个附加程序，我怀疑当多个应用程序使用我的 jar 时，由于 log4j.properties 文件中的类名相同，只有一个应用程序日志文件会收到我的jar 的日志记录语句，并且它将接收来自使用该 jar 的每个应用程序的所有日志记录语句。我认为是这种情况，因为我们使用静态 Logger.getLogger() 调用来检索记录器。

我首先想知道我的担心是否有效，如果同一或不同容器中的多个 Web 应用程序同时使用我的 jar 时会发生这种情况。

我还想知道这种行为是否存在变化的“边界”。例如，无论 log4j.jar 是容器级 jar 还是应用级 jar，或者每个容器都运行在单独的 JVM 中，是否存在此问题？

最后，如果是这种情况，我想知道我应该使用什么策略来克服这个问题。

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-16T20:53:50.563

如果 log4j.jar 仅在 web-app 中，那么日志将保持独立，因此每个 web-app 应该有自己的 log4j.jar 和 log4j.properties，以便所有日志保持独立。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-16T20:59:20.770

问题是 log4j 的首选模式是使用静态 *Configurator 方法，这与应用程序容器不太匹配。

当我遇到它时，这篇[文章为我解决了这个问题......](http://jboss.org/community/docs/DOC-11277)

# xml - 将 UTF8 数据导出到 Excel 的最佳方法是什么？

> ID：451636
> 
> 赞同：28
> 
> 时间：2009-01-16T19:30:27.423
> 
> 标签：xml, excel, csv, utf-8, utf-16

所以我们有这个支持 UTF8 数据的网络应用程序。万岁UTF8。我们可以将用户提供的数据导出到 CSV 中，这没有问题——那时它仍然是 UTF8。问题是，当您在 Excel 中打开一个典型的 UTF8 CSV 时，它会将其读取为 ANSII 编码的文本，并因此尝试将 ø 和 ü 等两字节字符作为两个单独的字符读取，而您最终会失败。

所以我做了一些挖掘（Intervals 的人在[这里有一篇关于它](http://www.myintervals.com/forum/discussion/280/making-csv-data-exports-with-utf8-more-excel-friendly/)的有趣帖子），并且有一些有限的，如果可笑的烦人的选项。其中：

*   提供 Excel 将正确解释但不支持多行数据的 UTF-16 Little Endian TSV 文件
*   提供具有 Excel mime 类型或文件扩展名的 HTML 表中的数据（不确定此选项是否支持 UTF8）
*   有大约三到四种方法可以将 XML 数据导入到各种最新版本的 excel 中，理论上这些方法都支持 UTF8。SpreadsheetML，使用自定义 XSLT，或通过模板生成新的 Excel XML 格式。

看起来无论如何，我可能会继续为那些不使用 Excel 的人提供一个普通的旧 CSV 文件，并为 Excel 提供一个单独的下载选项。

亲爱的 Stack Overflowers，生成正确支持 UTF8 的 Just-For-Excel 文件的最简单方法是什么？如果这个最简单的选项只支持最新版本的 Excel，那仍然很有趣。

我在 Rails 堆栈上执行此操作，但很好奇 .Net-ers 和任何框架上的人员如何处理此问题。我自己在几个不同的环境中工作，这绝对是一个会再次出现的问题。

*2010-10-22 更新：*当我第一次发布这个问题时，我们一直在我们的时间跟踪系统[Tempo](http://keeptempo.com)中使用 Ruport gem来提供 CSV 导出。我的一位同事 Erik Hollensbee 为 Ruport 提供了一个快速过滤器，为我们提供了实际的 Excel XSL 输出，我想我会在这里与任何其他 ruby​​ 专家分享：

```
require 'rubygems'
require 'ruport'
require 'spreadsheet'
require 'stringio'

Spreadsheet.client_encoding = "UTF-8"

include Ruport::Data

class Ruport::Formatter::Excel < Ruport::Formatter
  renders :excel, :for => Ruport::Controller::Table

  def output
    retval = StringIO.new

    if options.workbook
      book = options.workbook
    else
      book = Spreadsheet::Workbook.new
    end

    if options.worksheet_name
      book_args = { :name => options.worksheet_name }
    else
      book_args = { }
    end

    sheet = book.create_worksheet(book_args)

    offset = 0

    if options.show_table_headers
      sheet.row(0).default_format = Spreadsheet::Format.new(
        options.format_options || 
        { 
          :color => :blue,
          :weight => :bold,
          :size => 18
        }
      )
      sheet.row(0).replace data.column_names
      offset = 1
    end

    data.data.each_with_index do |row, i|
      sheet.row(i+offset).replace row.attributes.map { |x| row.data[x] }
    end

    book.write retval
    retval.seek(0)
    return retval.read
  end
end 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2010-07-21T15:16:10.627

我发现如果你把网页的charset编码设置为utf-8，然后Response.Binary在csv文件的顶部写入UTF-8字节顺序标记（0xEF 0xBB 0xBF），然后是Excel 2007（不确定其他版本）将其识别为 utf-8 并正确打开它。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2010-01-19T05:41:02.967

在同一个问题上挣扎了几个小时后，我发现了这篇关于这个主题的优秀帖子

[http://blog.plataformatec.com.br/2009/09/exporting-data-to-csv-and-excel-in-your-rails-app/](http://blog.plataformatec.com.br/2009/09/exporting-data-to-csv-and-excel-in-your-rails-app/) 报价：

> 因此，以下是处理 Excel-friendly-CSV 的三个规则：
> 
> 1.  使用表格，而不是逗号。
> 2.  字段不得包含换行符。
> 3.  使用 UTF-16 Little Endian 将文件发送给用户。并手动包含一个 Little Endian BOM。

但是，如果您使用的是 ruby​​，您的问题就解决了：首先您拥有[FasterCSV](http://fastercsv.rubyforge.org/) gem

但我最终使用了直接生成 Excel 电子表格的电子表格 gem（我有链接限制，只是 google 电子表格 + ruby​​forge）太棒了！

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-16T19:41:15.123

您忘记了创建 OleDB 数据源和 Excel 互操作，但这些也存在问题。

我推荐[SpreadsheetML](http://msdn.microsoft.com/en-us/library/bb226687.aspx)选项。它工作得很好，很可能你的平台有一些不错的工具来构建 xml 文件，并且早在 OfficeXP 就完全支持它。不支持Office2000，但个人经验是它的工作方式有限。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-16T19:51:00.067

如果您使用 utf 编码创建 XML 并将其保存为 .xls，它甚至会打开那些两字节字符：

xml 版本="1.0" 编码="utf-8"

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-06T22:08:02.337

我在将 UTF8 数据发送到 Excel 时遇到了完全相同的问题。我的解决方案：

当前版本的 Perl Spreadsheet::WriteExcel cpan 代码正确地使用 UTF8 数据写入 Excel 文件。

所以我写了一个 Rails 插件，它 a) 打开一个双向管道到 perl 程序 b) 将数据，一次一行，发送到 perl 程序。我使用 Yaml 作为消息数据格式。（标准 Ruby yaml 不是 UTF8，有一个特殊版本可用，ya2yaml） c) perl 程序创建 excel 文件 d) 当 Rails 程序指示（通过 yaml 消息）最后一行已发送时，perl 程序创建excel 文件并将状态发送回 rails 程序。

当然，通过并行进程和管道将 perl 程序添加到 rails 项目在很大程度上属于“工程”范畴，而不是“计算机科学”范畴。（它完成了工作，但并不优雅。）但它确实运行良好，并为我节省了将 WriteExcel 代码移植到 Ruby 所需的数周时间。另请注意，WriteExcel 当前可用的 Ruby 端口不处理 utf8。

我的 sw 是允许的开源软件，但我还没有开始发布它。如果您希望它处于当前状态，请参阅[http://sandbox.kluger.com/write_excel_v.5.tar](http://sandbox.kluger.com/write_excel_v.5.tar)

请注意，您需要在后台进程中创建您的 excel 文件，而不是在 Rails 控制器的进程中，因为这会在您制作 excel 文件时阻止其他浏览器客户端。我使用 DelayedJob 插件，效果很好。

希望这可以帮助，

拉里

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-11-15T05:06:56.617

我在这篇文章中寻找 Ruby 的答案，为什么 Excel 不能正确加载带有 utf-8 字符的 CSV。在四处搜索和试验后，这个解决方案对我有用：

```
csv_content = CSV.generate(col_sep: "\t", headers: :first_row, encoding: 'utf-8') do |csv|
  csv << ["header1", "header2"]
  csv << ["content1", "content2"]
end
write_content = Iconv.conv("utf-16le", "utf-8", "\xEF\xBB\xBF")
write_content += Iconv.conv("utf-16le", "utf-8", csv_content)
File.open("listing.csv", 'wb') {|f| f.write(write_content) } 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2010-03-05T09:21:59.267

Excel 无法正确处理 UTF-8。您应该改用满足您需求的代码页

```
Response.ContentType = "text/plain";
// codepage: 28591, codepage name:iso-8859-1, codepage display name: Western European (ISO)
Response.ContentEncoding = System.Text.Encoding.GetEncoding(28591); 
```

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2009-05-25T22:22:05.617

试试 OpenOffice Calc - 它对 Unicode 更友好 - 使用 UTF-8 编码导入和导出 CSV 文件。

# java - java.lang.Object 的受保护方法如何免受子类的影响？

> ID：451647
> 
> 赞同：12
> 
> 时间：2009-01-16T19:32:12.723
> 
> 标签：java, object, protected, access-modifiers

关键字`protected`授予对同一包和子类 ( [http://java.sun.com/docs/books/tutorial/java/javaOO/accesscontrol.html](http://java.sun.com/docs/books/tutorial/java/javaOO/accesscontrol.html) ) 中的类的访问权限。

现在，每个类都有`java.lang.Object`超类（[http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html)）。

因此我得出结论，每个类都可以访问`java.lang.Object`的方法，即使它们是`protected`。

看看下面的例子：

```
公共类测试类{
  公共对象 getOne() 抛出 CloneNotSupportedException {
    返回 this.clone();
  }
  公共对象 getTwo() 抛出 CloneNotSupportedException {
    return ((Object) this).clone();
  }
}

```

虽然`getOne()`编译得很好，但`getTwo()`给出

```
Testclass.java:6：clone() 在 java.lang.Object 中具有受保护的访问权限
        return ((Object) this).clone();

```

我既不明白为什么`getTwo()`不编译也不明白`java.lang.Object`与`getOne()`.

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-16T19:47:05.127

如果您引用它的表达式的编译时类型是您自己的类或子类，则您只能访问不同包中类型的受保护成员。（其中“您的”类是包含代码的类。）您自己的类也必须是最初声明该方法的类型的子类。

这是一个例子；假设它`Base`与所有其他类位于不同的包中：

```
package first;
public class Base
{
    protected void Foo() {}
}

// Yes, each class is really in its own file normally - but treat
// all the classes below as being in package "second"

package second;
public class Child extends Base
{
    public void OtherMethod(Object x)
    {
        ((Base) x).Foo(); // Invalid: Base is not Child or subclass
        ((Child) x).Foo(); // Valid: Child is Child
        ((GrandChild) x).Foo(); // Valid: GrandChild is subclass of Child
        ((OtherChild) x).Foo(); // Invalid: OtherChild is not Child or subclass
    }
}

public class GrandChild extends Child {}
public class OtherChild extends Base {} 
```

换句话说，它让您可以访问“与您相似的对象”的受保护成员。

详细信息在[Java 语言规范的第 6.6.2 节中](http://java.sun.com/docs/books/jls/third_edition/html/names.html#6.6.2)：

> 对象的`protected`成员或构造函数可以从包的外部访问，在该包中，仅由负责实现该对象的代码声明它。
> 
> **6.6.2.1 访问受保护成员**
> 
> 令*C*为声明受保护成员*m的类。*仅允许在*C的子类**S*的主体内访问。此外，如果 Id 表示实例字段或实例方法，则： 如果通过限定名称*Q.Id*进行访问，其中*Q*是 *ExpressionName*，则当且仅当表达式*Q*的类型为*S*时才允许访问或 *S*的子类。如果通过字段访问表达式*E.Id*进行访问，其中*E*是*Primary* **********表达式，或通过方法调用表达式*E.Id(. . .)*，其中*E*是 *主*表达式，则当且仅当*E*的类型 是*S*或 S 的子类*时才*允许访问。**********

 *** * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-16T19:46:47.827

当你说“ `((Object) this).clone()`”时，你通过它的超类 Object 访问了你自己的对象。您执行了到对象的扩展转换。然后代码尝试在 Object 上调用 clone。

但是，正如您所指出的，clone 是一个受保护的方法，这意味着只有当您的对象在同一个 java.lang 包中时，它才能访问 OBJECT 的 clone 方法。

当您说 this.clone 时，您的类扩展了 Object，因此可以通过受保护的类修饰符直接覆盖或使用克隆，因为继承。但这不会改变 Object 的实现。

通过说 ((Object) yourObject)，您得到的东西只能通过 Object 类访问。只有 Object 类的公共方法可以在 java.lang 包之外访问，因此您会得到编译时异常，因为编译器知道这一点。

通过说 this.clone()，您正在调用对象的克隆方法，该方法是通过 Object 继承得到的，并且现在可以被调用，因为它成为您自定义子类的一部分。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-16T19:51:03.717

不同之处在于您访问 Object.clone() 的方式。只有通过同一包中的子类或类访问时才能访问克隆。在 getOne() 示例中，您将调用 this.clone()。这显然满足了从子类中的访问。

在 getTwo() 中，虽然您访问的是 Object.clone() 而**不是**TestClass.clone()。为了使其工作，您必须对您没有的 Object 具有包级别的访问权限，因此会出现错误。

# svn - 在 Linux 上，哪些 Subversion 工具具有用于浏览分支历史的树形视图（如 Cervisia 中的）？

> ID：451654
> 
> 赞同：3
> 
> 时间：2009-01-16T19:34:27.883
> 
> 标签：svn, tree

我的公司正在从 CVS 迁移到 SVN。使用 CVS，我为每个生产版本（现在是 svn 副本）创建了分支，并将有限的补丁应用于分支以解决关键问题。我们使用 Cervisia 作为其分支历史的树形视图。Linux 上是否有一个 GUI 工具可以为 SVN 显示类似的树？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-16T19:42:53.280

[kdesvn](http://kdesvn.alwins-world.de/)完成了这项工作，看看[截图](http://kdesvn.alwins-world.de/screenshots)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-16T20:46:30.220

[http://en.wikipedia.org/wiki/Comparison_of_Subversion_clients](http://en.wikipedia.org/wiki/Comparison_of_Subversion_clients)列出了所有可用的 Subversion 客户端。

kdesvn 和 RapidSVN 是我听到最多的。如果您使用 Eclipse，您还可以使用 Subversion 的 Eclipse 插件之一，它也可以很好地工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-16T21:55:53.607

tkcvs 也做了我想要的树视图，但是在 SVN 模式下它非常慢（每个文件 5 分钟）

# gwt - GWT 动态加载使用 GWT.create() 和 String 字面量而不是 Class 字面量

> ID：451658
> 
> 赞同：15
> 
> 时间：2009-01-16T19:36:19.067
> 
> 标签：gwt

GWT.create() 是 GWT 中的反射等价物，但它只接受类文字，而不是类名的完全限定字符串。如何使用 GWT.create() 动态创建带有字符串的类？

根据许多 GWT 论坛帖子，这是不可能的，但它是如何在 Rocket-GWT（[http://code.google.com/p/rocket-gwt/wiki/Ioc](http://code.google.com/p/rocket-gwt/wiki/Ioc)）和 Gwittir（[http://code ）等框架中完成的.google.com/p/gwittir/wiki/Introspection](http://code.google.com/p/gwittir/wiki/Introspection)）

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2010-02-24T21:42:15.590

这是可能的，尽管很棘手。以下是血淋淋的细节：

如果您只将 GWT 视为直接从 Java 到 JS，那它是行不通的。但是，如果您考虑使用 GWT 编译器 Compiles and Executes 在编译期间生成器 - 特殊类，这是可能的。因此，您甚至可以在编译时生成 java 源代码。

我今天有这个需求——我们的系统处理来自服务的动态资源，以字符串结尾并需要一个类。这是我想出的解决方案-顺便说一句，它可以在托管、IE 和 Firefox 下运行。

*   创建一个 GWT 模块，声明：
    *   源路径
    *   生成器（应保留在*GWT*模块源路径的包之外）
    *   接口替换（它将注入 Generated 类而不是接口）
*   在该包中，创建一个 Marker 接口（我称之为 Constructable）。生成器将查找该标记
*   创建一个基本抽象类来保存该工厂。我这样做是为了简化生成的源代码
*   在 Application.gwt.xml 上声明该模块继承

一些注意事项：

*   理解的关键在于生成器的概念；
*   为了方便，抽象基类派上了用场。
*   此外，请了解生成的 .js 源甚至生成的 Java 源中存在名称处理
*   记住生成器输出 java 文件
*   GWT.create 需要一些对 .class 文件的引用。您的生成器输出可能会这样做，只要它以某种方式从您的应用程序中引用（检查 Application.gwt.xml 继承您的模块，它也用您的 Application.gwt.xml 声明的生成器替换接口）
*   将 GWT.create 调用包装在工厂方法/单例中，以及 GWT.isClient() 下
*   将代码类加载调用也包装在 GWT.runAsync 周围是一个非常好的主意，因为它可能需要触发模块加载。这是**非常**重要的。

我希望尽快发布源代码。交叉你的手指。:)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-12-12T20:09:00.600

I ran into this today and figured out a solution. The questioner is essentially wanting to write a method such as:

```
public <T extends MyInterface> T create(Class<T> clz) {
    return (T)GWT.create(clz);
} 
```

Here MyInterface is simply a marker interface to define the range of classes I want to be able to dynamically generate. If you try to code the above, you will get an error. The trick is to define an "instantiator" such as:

```
public interface Instantiator {
    public <T extends MyInterface> T create(Class<T> clz);
} 
```

Now define a GWT deferred binding generator that returns an instance of the above. In the generator, query the TypeOracle to get all types of MyInterface and generate implementations for them just as you would for any other type:

e.g:

```
public class InstantiatorGenerator extends Generator {

public String generate(...) {
   TypeOracle typeOracle = context.getTypeOracle();
   JClassType myTYpe= typeOracle.findType(MyInterface.class.getName());

    JClassType[] types = typeOracle.getTypes();
    List<JClassType> myInterfaceTypes = Collections.createArrayList();

    // Collect all my interface types.
    for (JClassType type : types) {
        if (type.isInterface() != null && type.isAssignableTo(myType)
                && type.equals(myType) == false) {
            myInterfaceTypes.add(type);
        }
        for (JClassType nestedType : type.getNestedTypes()) {
            if (nestedType.isInterface() != null && nestedType.isAssignableTo(myType)
                    && nestedType.equals(myTYpe) == false) {
                myInterfaceTypes.add(nestedType);
            }
        }
    }

    for (JClassType jClassType : myInterfaceTypes) {
        MyInterfaceGenerator generator = new MyInterfaceGenerator();
        generator.generate(logger, context, jClassType.getQualifiedSourceName());
    }
 }

 // Other instantiator generation code for if () else if () .. constructs as 
 // explained below.
} 
```

The MyIntefaceGenerator class is just like any other deferred binding generator. Except you call it directly within the above generator instead of via GWT.create. Once the generation of all known sub-types of MyInterface is done (when generating sub-types of MyInterface in the generator, make sure to make the classname have a unique pattern, such as MyInterface.class.getName() + "_MySpecialImpl"), simply create the Instantiator by again iterating through all known subtypes of MyInterface and creating a bunch of

```
if (clz.getName().equals(MySpecialDerivativeOfMyInterface)) { return (T) new MySpecialDerivativeOfMyInterface_MySpecialImpl();} 
```

style of code. Lastly throw an exception so you can return a value in all cases.

Now where you'd call `GWT.create(clz);` instead do the following:

```
private static final Instantiator instantiator = GWT.create(Instantiator.class);
...
return instantiator.create(clz); 
```

Also note that in your GWT module xml, you'll only define a generator for Instantiator, not for MyInterface generators:

```
<generate-with class="package.rebind.InstantiatorGenerator">
    <when-type-assignable   class="package.impl.Instantiator" />
</generate-with> 
```

Bingo!

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-11-14T17:27:10.600

布莱恩，

问题是 GWT.create 不知道如何为您的抽象类选择正确的实现

我在使用新的 GWT MVP 编码风格时遇到了类似的问题（请参阅[GWT MVP 文档](http://code.google.com/webtoolkit/doc/latest/DevGuideMvpActivitiesAndPlaces.html)）

当我打电话时：

`ClientFactory clientFactory = GWT.create(ClientFactory.class);`

我遇到了同样的错误：

延迟绑定结果类型“com.test.mywebapp.client.ClientFactory”不应该是抽象的

我所要做的就是将以下行添加到我的 MyWebapp.gwt.xml 文件中：

```
<!-- Use ClientFactoryImpl by default -->
    <replace-with class="com.test.mywebapp.client.ClientFactoryImpl">
    <when-type-is class="com.test.mywebapp.client.ClientFactory"/>
    </replace-with> 
```

然后它就像一个魅力

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-31T02:58:32.063

究竟是什么问题 - 我猜您希望将除了类文字之外的参数传递给生成器。

您可能已经知道传递给 GWT.create() 的类文字主要是一个选择器，因此 GWT 可以选择并执行一个生成器，最终生成一个类。将参数传递给生成器的最简单方法是在接口中使用注释并将 interface.class 传递给 GWT.create()。请注意，接口/类必须扩展传递给 GWT.create() 的类文字。

```
class Selector{
}

@Annotation("string parameter...")
class WithParameter extends Selector{}

Selector instance = GWT.create( WithParameter.class ) 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-09-08T19:52:26.620

一切皆有可能……尽管可能很困难，甚至是无用的。正如 Jan 所提到的，您应该使用生成器来执行此操作。基本上，您可以使用生成器代码创建接口，该生成器代码在创建时使用该接口并编译并返回实例。一个例子可能是：

```
//A marker interface
public interface Instantiable {
}
//What you will put in GWT.create
public interface ReflectionService {
 public Instantiable newInstance(String className);
}
//gwt.xml, basically when GWT.create finds reflectionservice, use reflection generator
<generate-with class="...ReflectionGenerator" >
<when-type-assignable class="...ReflectionService" />
</generate-with>  
//In not a client package
public class ReflectionGenerator extends Generator{
...
}
//A class you may instantiate
public class foo implements Instantiable{
}
//And in this way
ReflectionService service = GWT.create(ReflectionService.class);
service.newInstance("foo"); 
```

所有你需要知道的是如何做发电机。我可能会告诉你，最后你在生成器中所做的就是以这种方式创建 Java 代码：

```
if ("clase1".equals(className)) return new clase1();
else if ("clase2".equals(className)) return new clase2();
... 
```

最后我想，通常我可以在一种 InstanceFactory 中手动做到这一点......最好的问候

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-04-09T23:57:29.353

我能够做我认为您正在尝试做的事情，即加载一个类并将其动态绑定到一个事件；我使用生成器将类动态链接到事件。我不推荐它，但如果它有帮助，这里有一个例子：

[http://francisshanahan.com/index.php/2010/a-simple-gwt-generator-example/](http://francisshanahan.com/index.php/2010/a-simple-gwt-generator-example/)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-10-27T14:58:16.957

您可以通过在服务器端执行此操作来避免整个问题。说一个服务女巫接受 String 并返回某种可序列化的超类型。在服务器端你可以做

```
return (MySerializableType)Class.forName("className").newInstance(); 
```

根据您的情况，它可能不是很大的性能瓶颈。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-06-18T09:18:38.903

您尝试做的事情在 GWT 中是不可能的。

虽然 GWT 在编译时模拟 Java 方面做得很好，但运行时当然是完全不同的。大多数反射不受支持，并且无法在运行时生成或动态加载类。

我简要查看了 Gwittir 的代码，我认为他们在编译时正在做他们的“反射工作”。这里：[http ://code.google.com/p/gwittir/source/browse/trunk/gwittir-core/src/main/java/com/totsp/gwittir/rebind/beans/IntrospectorGenerator.java](http://code.google.com/p/gwittir/source/browse/trunk/gwittir-core/src/main/java/com/totsp/gwittir/rebind/beans/IntrospectorGenerator.java)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-18T10:26:11.670

没有查看 Rocket/gwittir 的代码（如果你想知道他们是如何做到的，你应该这样做，毕竟它是开源的），我只能猜测他们使用延迟绑定的方式是在编译期间时间，他们计算出所有对反射的调用，并静态生成实现这些调用所需的所有代码。所以在运行时，你不能做不同的。

# stored-procedures - MSSQL2000：使用存储过程结果作为 sql 中的表

> ID：451661
> 
> 赞同：4
> 
> 时间：2009-01-16T19:38:01.027
> 
> 标签：stored-procedures, sql-server-2000

假设我有“myStoredProcedure”，它接受一个 Id 作为参数，并返回一个信息表。

能不能写出类似这样的SQL语句？

```
SELECT
    MyColumn
FROM
   Table-ify('myStoredProcedure ' + @MyId) AS [MyTable] 
```

我觉得它不是，但在我使用遗留代码和链接服务器表的场景中它会非常有益

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-16T19:41:16.560

您可以通过这种方式使用表值函数。

[这里](http://www.codeproject.com/KB/database/TableValuedFnsAsArrays.aspx)有一些技巧...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-16T19:46:22.353

不，它不是 - 至少不是以任何官方或记录的方式 - 除非您将存储过程更改为 TVF。

但是，有一些方法（阅读）黑客可以做到这一点。所有这些基本上都涉及链接服务器并使用 OpenQuery - 例如，请参见[此处](http://blog.sqlauthority.com/2007/10/06/sql-server-executing-remote-stored-procedure-calling-stored-procedure-on-linked-server/)。但是请注意，它非常脆弱，因为您需要硬编码服务器的名称 - 因此，如果您有多个具有不同名称的 sql 服务器实例，则可能会出现问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-16T20:25:18.653

这是存储过程之间共享数据方式的一个很好的总结[http://www.sommarskog.se/share_data.html](http://www.sommarskog.se/share_data.html)。

基本上这取决于你想做什么。最常见的方法是在调用存储过程之前创建临时表并让它填充它，或者拥有一个永久表，存储过程将数据转储到其中还包含进程 ID。

已经提到了表值函数，但是在创建函数而不是存储过程时存在许多限制，因此它们可能适合您，也可能不适合您。该链接提供了有关可用内容的良好指南。

SQL Server 2005 和 SQL Server 2008 稍微改变了选项。SQL Server 2005+ 使使用 XML 变得更加容易。因此，XML 可以作为输出变量传递，并且可以使用 XML 函数节点和值很容易地“分解”到表中。我相信 SQL 2008 允许将表变量传递到存储过程中（尽管是只读的）。由于您引用了 SQL 2000，因此 2005+ 的增强不适用于您，但我提到它们是为了完整性。

您很可能会使用表值函数，或者在调用存储过程之前创建临时表，然后让它填充它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-16T20:50:16.810

在处理项目时，我使用以下内容将 xp_readerrorlog（afaik，返回一个表）的结果插入到提前创建的临时表中。

```
 INSERT INTO [tempdb].[dbo].[ErrorLogsTMP]
 EXEC master.dbo.xp_readerrorlog 
```

从临时表中，选择所需的列。

# sql - 如何显示 DB2 SQL UDF 的源代码

> ID：451662
> 
> 赞同：1
> 
> 时间：2009-01-16T19:38:10.420
> 
> 标签：sql, database, db2, rdbms

有什么方法可以在 DB2 控制中心查看 SQL UDF 正文？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-08T12:30:02.363

```
-- To get the text of UDF
select r.routinename as FunctionName, r.text as FunctionBody
from syscat.routines r
where r.routinetype = 'F' -- Function
and r.origin in ('U', 'Q') -- User-defined sourced or query-based 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T18:55:33.657

您可以查询 DB2 中的目录视图以查找 UDF 的来源。

这些视图会根据您使用的 DB2 版本略有不同。

您可以尝试查看 SYSCAT.ROUTINES 的 TEXT 列。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T18:21:34.413

我很少使用 Control Center，因为它的功能不如 IBM Data Studio 或第三方 DBA/DB2 应用程序开发工具。从 DB2 9.5 开始，控制中心中没有显示过程和 UDF 的 DDL 的选项。不过，Data Studio 有 Generate DDL 选项。看它的网页你不会知道，但是 IBM 仍然提供 Data Studio Administrator 的免费版本，它处理 DB2 对象的基本检查和管理。

几位 IBM 员工在此论坛帖子中总结了有关 Data Studio Administrator 的详细信息：[http ://www.ibm.com/developerworks/forums/thread.jspa?threadID=263555&tstart=0](http://www.ibm.com/developerworks/forums/thread.jspa?threadID=263555&tstart=0)

另一种选择是遵循 Mark S 的建议，直接从 SYSCAT.ROUTINES 中提取 TEXT。

# multithreading - 使用 SendMessage 进行线程通信

> ID：451665
> 
> 赞同：5
> 
> 时间：2009-01-16T19:39:37.187
> 
> 标签：multithreading, communication, sendmessage

我的问题是：如何使用 SendMessage() 实现两个线程之间的线程通信，一个有窗口（GUI），另一个没有窗口？

问题是 SendMessage() 需要一个句柄（HWND）吗？

关于我的项目的另一个细节：两个线程，一个运行托管代码（一个具有用户界面），另一个运行本机代码（一个没有窗口）

非常感谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-16T21:48:15.867

我建议创建一个隐藏窗口。使用 postthreadmessage 时，您的消息可能会丢失（即：如果消息框正在运行消息循环）。

更多信息请访问：

[http://blogs.msdn.com/oldnewthing/archive/2005/04/26/412116.aspx](http://blogs.msdn.com/oldnewthing/archive/2005/04/26/412116.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-16T19:43:04.263

也许您应该尝试使用[PostMessage](http://msdn.microsoft.com/en-us/library/ms644946(VS.85).aspx)或[PostThreadMessage](http://msdn.microsoft.com/en-us/library/ms644946(VS.85).aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-16T20:24:12.667

如果线程没有窗口，没有消息队列，也没有消息分派器，那么很难给它发送消息。线程创建隐藏窗口只是为了通信目的是很常见的（看看 Windows Spy，你会看到很多例子）。

一种替代方法是使用共享内存和同步原语，例如事件或信号量。另一种选择是使用管道。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-16T21:30:07.417

@jdigital 说了什么。请注意，如果您创建了一个隐藏窗口，并且您的线程尚未实现消息循环（在常规 win32-speak 中或在 COM STA 的上下文中 - 如果您不知道我在说什么那么您的线程中可能不存在一个），您还需要创建一个消息循环。ATL 使它变得相当容易`_AtlModule.RunMessageLoop();`不幸的是，这也意味着有问题的线程可能需要在消息循环中进行事件驱动。你可以做一些棘手的事情，比如 MsgWaitForMultipleObjects，但它会变得很麻烦。

如果您熟悉 ATL/COM，这里有一个[隐藏窗口](http://www.wehlou.com/Code/atl_hidden_windows.htm)的示例。不久前我经历了这种痛苦，并认为在 microsoft.public.vc.atl 上有一个有用的讨论，但我现在能找到的最好的是[这篇文章](http://groups.google.com/group/microsoft.public.vc.atl/browse_thread/thread/3d43957b8f0cbe46/63ca5ad8b9b93212?#63ca5ad8b9b93212)。其中详细介绍了消息循环的变体（如果您有按键加速器或无模式窗口，您应该做些什么不同的事情，听起来您的应用程序中没有）。

# .net - 如何使用 MOSS '07 构建仪表板应用程序

> ID：451666
> 
> 赞同：0
> 
> 时间：2009-01-16T19:39:56.390
> 
> 标签：.net, asp.net, sharepoint, sharepoint-2007

它与普通的 ASP.net 开发有何不同？任何人都有我想要做的有价值的酷链接/视频/教程？

我是 sharepoint 的新手..但我对 ASP.net 很满意。

编辑：该应用程序更像是一个 Teamsite/Dashboard 应用程序。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-16T22:25:51.953

查看 Microsoft PerformancePoint 2007。它可以毫不费力地将仪表板直接导出到 Sharepoint。它实际上是一个非常强大的工具，只需要很少的代码，大部分工作都是在定义业务规则和规划方面完成的。

[http://office.microsoft.com/en-us/performancepoint/fx101680481033.aspx](http://office.microsoft.com/en-us/performancepoint/fx101680481033.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-16T19:48:17.763

Sharepoint 是一个比普通的 ASP.NET 更严格的框架。已经为您完成了很多工作，但对象模型有时可能难以使用。有一些似乎是任意的限制（即，每个站点集合的 Web 数量、每个站点集合的库数量等）。权限不是非常细粒度的，如果你需要做一些已经完成但做得不好的事情（或者只是不是你需要的），那么你最终会求助于编写自己的 HTTP 模块来跳出在 Sharepoint 前面。

您正在构建什么样的仪表板应用程序？WSS 3.0 和 MOSS 2007 中的 Web 部件系统已经融合，因此如果您只需要拥有一堆自定义 Web 部件并允许您的用户构建站点并使用这些 Web 部件，Sharepoint 可能会非常适合您。另一方面，如果您有特定的用户管理需求或要存储和检索大量数据，那可能不是最好的选择。这*实际上*取决于您的应用程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-15T12:06:03.420

您可能还想查看[www.dynamicdashboards.net](http://www.dynamicdashboards.net)以了解没有 MOSS 的 Asp.Net 仪表板工具包。

# c# - 没有 C++ 的 CAD/CAM

> ID：451682
> 
> 赞同：4
> 
> 时间：2009-01-16T19:43:33.340
> 
> 标签：c#, c++, vb.net, cad

是否可以不用 C++ 做 CAD/CAM 软件？我的公司使用 c/C++ 开发他们的软件，但那是 10 多年前的事了。今天，有很多遗留代码切换会迫使我们摆脱，但我想知道实际风险是什么。我们有很多用于刀具路径计算、特征识别和模拟以及 3D 渲染的数学算法，我想知道 C# 是否可以处理所有这些而不会造成很大的性能损失。

用 c# 重写这样的算法是一个乌托邦，还是该语言只处理 UI。我们不是在讨论游戏开发（光环 3 或使命召唤），那么 CAD/CAM 真正需要多少处理？

任何人都可以在这件事上启发我吗？我的大多数同事都是铁杆 C++ 程序员，虽然我用 C++ 编程，但我喜欢 .NET，但除了基本 UI 之外，我很难向他们推销 .NET。考虑在这样的领域切换到 .NET 是否有意义，或者这不是一个明智的想法？

谢谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-16T19:49:38.680

如果您有很多需要重写的遗留代码，我认为切换到其他语言没有商业意义。即使使用不同的语言有好处（这是有问题的），测试和调试新代码的成本也将超过它们。您还拥有一个 C++ 专家的开发团队。当他们加快学习新语言的速度时，生产力会大幅下降。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-16T19:54:58.467

C# 可以与 C++ 代码互操作。您可以开始用 C# 编写新代码，并在需要时让它调用现有的 c++ 代码。它不一定只适用于 UI。查看 C++/CLI 和 C# 互操作方法以获取有关如何将现有 C++ 代码与新 C# 代码一起使用的信息。

另外，我在这里问了一个类似的问题： [C# Performance For Proxy Server (vs C++)](https://stackoverflow.com/questions/30729/c-performance-for-proxy-server-vs-c)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-16T22:01:32.643

CAD/CAM 应用程序的计算量相当大，速度肯定是选择软件包的标准之一，所以我会警惕转向速度较慢的语言。

您需要非常仔细地考虑切换语言的原因。是因为你不喜欢 C++，还是因为 C# 会带来真正的好处。这很可能会减慢您的应用程序的速度。查看 C++ C# 速度比较。

[计算机语言基准游戏 C++ vs C#](http://shootout.alioth.debian.org/debian/benchmark.php?test=all&lang=gpp&lang2=csharp)

以我的拙见，您最好将所有刀具路径计算保留在 C++ 中，如果您*确实*必须将任何代码移至另一种语言，请将其移至用户可以轻松编辑的脚本语言，而无需重新编译。

我每天在工作中都使用 CAD/CAM 应用程序，并且 UI 中有许多让我紧张的东西。如果我能找到源头，它们将是简单的修复。

如果您的公司制作了一个 CAD/CAM 应用程序，它的 UI 是用我可以调整的脚本语言（Lua、Python 等）编写的，我会买一份。

雨果

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-07-07T00:17:59.833

看看[pythonocc](https://github.com/tpaviot/pythonocc-core)。它为您提供了一个包装 OpenCASCADE CAD 内核的 python 模块。OpenCASCADE 是我所知道的唯一的行业实力开源内核。不错的功能是 STEP 和 IGES 支持以及从 BRep 数据生成 FEM 网格的能力。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-25T14:10:58.923

您需要考虑的另一件事是平台独立性 - 如果您/您的公司有可能需要将您的 CAD 软件迁移到 Linux/Unix（当然，对于业务决策），那将是非常痛苦的。目前，即使是带有 MFC/Win32 调用的 C++ 也让我们很头疼……

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-25T03:07:07.647

开放设计联盟库是跨平台的。他们最近推出了其库的 .NET 版本的测试版。[有关更多详细信息，请参阅我对C# 中的开源 cad 绘图 (dwg) 库的](https://stackoverflow.com/questions/169390/open-source-cad-drawing-dwg-library-in-c/206456#206456)回答。

话虽如此，我同意这里的其他答案 - 如果它没有损坏，请不要修复它，无论是代码还是编码器。MSFT 仍然使用 C++，ODA 也是如此——他们的代码库源自 C++ 并为 .NET 包装。

# sharepoint - 将文件保存在文档库中的现有文件上的 Sharepoint 问题

> ID：451684
> 
> 赞同：2
> 
> 时间：2009-01-16T19:44:09.067
> 
> 标签：sharepoint, moss

我在文档库中有一个现有文档，我正在尝试使用以下代码在代码中覆盖该文件：

```
byte[] data = ...
SPListItem li = ...
li.File.SaveBinary(data); 
```

当我运行此代码时，我得到：

```
Microsoft.SharePoint.SPException: The security validation for this page is invalid. Click Back in your Web browser, refresh the page, and try your operation again. ---> System.Runtime.InteropServices.COMException (0x8102006D): The security validation for this page is invalid. Click Back in your Web browser, refresh the page, and try your operation again.
    at Microsoft.SharePoint.Library.SPRequestInternalClass.PutFile(String bstrUrl, String bstrWebRelativeUrl, Object varFile, PutFileOpt PutFileOpt, String bstrCreatedBy, String bstrModifiedBy, Int32 iCreatedByID, Int32 iModifiedByID, Object varTimeCreated, Object varTimeLastModified, Object varProperties, String bstrCheckinComment, UInt32& pdwVirusCheckStatus, String& pVirusCheckMessage)
    at Microsoft.SharePoint.Library.SPRequest.PutFile(String bstrUrl, String bstrWebRelativeUrl, Object varFile, PutFileOpt PutFileOpt, String bstrCreatedBy, String bstrModifiedBy, Int32 iCreatedByID, Int32 iModifiedByID, Object varTimeCreated, Object varTimeLastModified, Object varProperties, String bstrCheckinComment, UInt32& pdwVirusCheckStatus, String& pVirusCheckMessage)
    --- End of inner exception stack trace ---
    at Microsoft.SharePoint.Library.SPRequest.PutFile(String bstrUrl, String bstrWebRelativeUrl, Object varFile, PutFileOpt PutFileOpt, String bstrCreatedBy, String bstrModifiedBy, Int32 iCreatedByID, Int32 iModifiedByID, Object varTimeCreated, Object varTimeLastModified, Object varProperties, String bstrCheckinComment, UInt32& pdwVirusCheckStatus, String& pVirusCheckMessage)
    at Microsoft.SharePoint.SPFile.SaveBinary(Byte[] file, String checkInComment, Boolean checkRequiredFields, Boolean bIsMigrate, Boolean bIsPublish, SPUser modifiedBy, DateTime timeLastModified, SPVirusCheckStatus& virusCheckStatus, String& virusCheckMessage)
    at Microsoft.SharePoint.SPFile.SaveBinary(Byte[] file, Boolean checkRequiredFields, Boolean bIsMigrate, Boolean bIsPublish, SPUser modifiedBy, DateTime timeLastModified)
    at Microsoft.SharePoint.SPFile.SaveBinary(Byte[] file, Boolean checkRequiredFields)
    at Microsoft.SharePoint.SPFile.SaveBinary(Byte[] file)
    at TestClass.UploadFile() 
```

我在托管在与共享点相同的站点中的表单上运行此代码，并且运行代码的用户可以手动上传文件就好了。我需要先删除文件吗？看看这个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-10-09T15:52:21.000

试试这个来修复它：

```
SPSecurity.RunWithElevatedPrivileges(delegate
{
  using (SPSite elevSite = new SPSite(currentWeb.Site.ID))
  {
    using (SPWeb elevWeb = elevSite.OpenWeb(currentWeb.ID))
    {
      elevWeb.AllowUnsafeUpdates = true;
      // ...
    }
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-16T20:34:02.163

我想到了。我在 SPSecurity.RunWithElevatedPrivileges 块中进行调用，导致它失败。我觉得这很有趣，因为您会认为使用提升的权限运行会获得更多而不是更少的访问权限。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-11-09T12:09:51.323

尝试此操作以删除错误“此页面的安全验证无效。在您的 Web 浏览器中单击返回，刷新页面，然后再次尝试您的操作。”

[http://sharepointhelps.wordpress.com/2008/08/05/the-security-validation-for-this-page-is-invalid-click-back-in-your-web/](http://sharepointhelps.wordpress.com/2008/08/05/the-security-validation-for-this-page-is-invalid-click-back-in-your-web/)

谢谢，

*   Ashish Chotalia

# ruby - 是否可以在 Ruby 中定义带有可选参数的块？

> ID：451689
> 
> 赞同：7
> 
> 时间：2009-01-16T19:45:47.830
> 
> 标签：ruby

我正在尝试动态定义调用另一个带有选项参数的函数的函数：

```
class MyClass
  ["hour", "minute", "second"].each do |interval|
    define_method "get_#{interval}" do |args|
      some_helper(interval, args)
    end
  end
  def some_helper(interval, options={})
    # Do something, with arguments
  end
end 
```

我希望能够以这两种方式调用 MyClass 上的不同方法（带和不带可选参数）：

```
mc = MyClass.new
mc.get_minute( :first_option => "foo", :second_option => "bar")
mc.get_minute  # This fails with: warning: multiple values for a block parameter (0 for 1) 
```

在第二次通话时，我看到了这个警告：

> 警告：块参数的多个值（0 代表 1）

1.  有没有办法为“get_*”方法编写块，这样就不会出现这个警告？
2.  我在滥用define_method吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-16T19:58:59.223

您需要进行的唯一更改是更改`args`为`*args`. `*`指示将`args`包含块的可选参数数组。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-03-25T14:21:07.123

两年后......我不知道这是否是 ruby​​ 1.9.2 的新功能，或者过去是否也有可能，但这有效：

```
class MyClass
    ["hour", "minute", "second"].each do |interval|
        define_method "get_#{interval}" do |args = {:first_option => "default foo", :second_option => "default  bar"}|
           some_helper(interval, args)
        end
    end
    def some_helper(interval, options={})
        # Do something, with arguments
        p options
    end
end

mc = MyClass.new
mc.get_minute( :first_option => "foo", :second_option => "bar")
mc.get_minute 
```

结果是：

```
{:first_option=>"foo", :second_option=>"bar"}
{:first_option=>"default foo", :second_option=>"default  bar"} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-16T21:30:05.887

我同意 Gordon 在您的参数中添加 * 会使其消失。

另一种方法是使用 method_missing()

像这样的东西：

```
class MyClass

  def method_missing(m, *args)  
    if /get_(.+)/.match(m.to_s)
      some_helper($1, args) 
    else
      raise 'Method not found...'
    end
  end  

  def some_helper(interval, *args)
    puts interval + ' -> ' + args.inspect
  end

end

m = MyClass.new
m.get_minute( :first_option => "foo", :second_option => "bar" ) 
```

# python - 在 Python dict 中访问同级字典值的最有效方法是什么？

> ID：451690
> 
> 赞同：4
> 
> 时间：2009-01-16T19:45:51.370
> 
> 标签：python, loops, dictionary, list-comprehension

在 Python 中，我有一个字典列表，如下所示：

```
matchings = [
    {'id': 'someid1', 'domain': 'somedomain1.com'},
    {'id': 'someid2', 'domain': 'somedomain2.com'},
    {'id': 'someid3', 'domain': 'somedomain3.com'}
] 
```

而且，我有一个变量：

```
the_id = 'someid3' 
```

检索项目域值的最有效方法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-16T19:47:57.093

您可以使用[列表理解](http://docs.python.org/tutorial/datastructures.html#list-comprehensions)：

```
domains = [matching['domain'] for matching in matchings if matching['id'] == the_id] 
```

遵循以下格式标准格式：

```
resulting_list = [item_to_return for item in items if condition] 
```

并且基本上封装了以下所有功能：

```
domains = []
for matching in matchings:
    if matching['id'] == the_id:
        domains.append(matching['domain']) 
```

所有这些功能都使用列表推导在一行中表示。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-16T20:16:04.353

我会重组`matchings`。

```
from collections import defaultdict
matchings_ix= defaultdict(list)
for m in matchings:
    matchings_ix[m['id']].append( m ) 
```

现在最有效的查找是

```
matchings_ix[ d ] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-16T19:52:12.653

我能想到的最好的办法是进行明确的搜索。这是我对 Python 感到失望的一个方面，它没有像 C++ STL 算法那样为您提供一组强大的解耦构建块

```
[d["domain"] for d in matchings if d["id"] == "someid3"] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-16T19:49:47.760

列表中存在字典这一事实并不重要 - 问题归结为在列表中查找某个属性为真的项目。为此，@Soviut 的答案的一些变化是要走的路：循环或列表理解，检查每个项目直到找到匹配项。项目没有固有的顺序，所以你甚至不能依赖像[bisect](http://docs.python.org/library/bisect.html)这样有用的东西。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-03-31T16:52:26.027

我真的很喜欢在这种情况下使用[过滤器。](http://docs.python.org/library/functions.html#filter)它接受一个函数和一个可迭代对象，并返回函数返回 True 的元素列表（在 Python 3.x 中它返回一个迭代器）。

```
>>> filter(lambda x: x['id'] == 'someid3', matchings)
<<< [{'domain': 'somedomain3.com', 'id': 'someid3'}] 
```

您可以使用列表推导获得所有域的列表：

```
>>> [x['domain'] for x in filter(lambda x: x['id'] == 'someid3', matchings)]
<<< ['somedomain3.com'] 
```

# c# - C# - 用于循环 DataGridView.Rows 的 Lambda 语法

> ID：451693
> 
> 赞同：1
> 
> 时间：2009-01-16T19:46:23.617
> 
> 标签：c#, .net, datagridview, lambda

C# 中用于循环遍历 DataGridView 的每个 DataGridViewRow 的正确 lambda 语法是什么？举个例子，该函数根据 Cells[0] 中的某个值使行 .Visible = false。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-16T19:48:46.310

好吧，可枚举没有内置的`ForEach`扩展方法。我想知道一个简单的`foreach`循环是否会更容易？写起来很简单，虽然...

一推，也许你可以`Where`在这里有用地使用：

```
 foreach (var row in dataGridView.Rows.Cast<DataGridViewRow>()
            .Where(row => (string)row.Cells[0].Value == "abc"))
        {
            row.Visible = false;
        } 
```

但就个人而言，我只会使用一个简单的循环：

```
 foreach (DataGridViewRow row in dataGridView.Rows)
        {
            if((string)row.Cells[0].Value == "abc")
            {
                row.Visible = false;
            }
        } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-16T19:52:17.910

请参阅我对这个问题的回答：[Update all objects in a collection using LINQ](https://stackoverflow.com/questions/398871/update-all-objects-in-a-collection-using-linq)

这对于内置的 LINQ 表达式是不可能的，但是很容易自己编写代码。为了不干扰 List<T>.ForEach，我调用了 Iterate 方法。

例子：

```
dataGrid.Rows.Iterate(r => {r.Visible = false; }); 
```

迭代源：

```
 public static void Iterate<T>(this IEnumerable<T> enumerable, Action<T> callback)
    {
        if (enumerable == null)
        {
            throw new ArgumentNullException("enumerable");
        }

        IterateHelper(enumerable, (x, i) => callback(x));
    }

    public static void Iterate<T>(this IEnumerable<T> enumerable, Action<T,int> callback)
    {
        if (enumerable == null)
        {
            throw new ArgumentNullException("enumerable");
        }

        IterateHelper(enumerable, callback);
    }

    private static void IterateHelper<T>(this IEnumerable<T> enumerable, Action<T,int> callback)
    {
        int count = 0;
        foreach (var cur in enumerable)
        {
            callback(cur, count);
            count++;
        }
    } 
```

# wcf - WCF 不在 IIS 6.0 下运行

> ID：451701
> 
> 赞同：19
> 
> 时间：2009-01-16T19:48:02.647
> 
> 标签：wcf, web-services, configuration, iis-6

试图让我的 WCF 服务在 IIS 6 下运行。

我根据以下内容创建了映射：`.svc`http : [//msdn.microsoft.com/en-us/library/ms752241.aspx](http://msdn.microsoft.com/en-us/library/ms752241.aspx)`aspnet_isapi.dll`

查看`Server1.svc`页面时，我收到 404。

我已经用一个简单的 .aspx 页面测试了该站点，以确保 URL 可以正常工作，但 .svc 扩展名也不能正常工作。

我安装了 .NET 3.5 SP1，我`web.config`正在引用 3.5 程序集，并且在查看 .aspx 页面时没有收到错误消息，因此它可以很好地拾取这些程序集，大概。

有什么问题？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-01-18T00:13:05.543

.svc 扩展名很可能未在 IIS 下注册为由 ASP.NET (WCF) 处理。

尝试以下 2 个步骤（如果需要，将 Framework 替换为 Framework64）：

去：

```
C:\Windows\Microsoft.NET\Framework\v2.0.50727\ 
```

然后运行：

```
aspnet_regiis -i 
```

转到：C:\Windows\Microsoft.NET\Framework\v3.0\Windows Communication Foundation

然后运行：

```
ServiceModelReg.exe -i 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-05-15T23:08:35.183

在 下`Internet Information Service (IIS) Manager`，打开名为 的节点`Web Service Extension`。确保将`ASP.NET v2.0.5.0727`其设置为允许。我花了几个小时寻找不同的设置，发现它被设置为禁止。只需单击允许按钮即可启用 ASP.NET。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-16T21:02:12.560

我能想到的有两点：

.svc 扩展名设置不正确（根据您的描述，可能性最小）。您可以查看此[帖子](http://blogs.msdn.com/wenlong/archive/2006/09/10/748294.aspx)以获取更多详细信息。

或者您的网站有多个主机标头。要解决此问题，您必须有一个主机标头或使用工厂。这是一个例子：

```
namespace MyNamespace
{
    public class MultipleHostServiceFactory : ServiceHostFactory
    {
        protected override ServiceHost CreateServiceHost(Type serviceType, Uri[] baseAddresses)
        {
            List<Uri> addresses = new List<Uri>();
            addresses.Add(baseAddresses[0]);
            return base.CreateServiceHost(serviceType, addresses.ToArray());
        }
    }
} 
```

接下来，您需要在 .svc 文件的标记中设置工厂：

```
<%@ ServiceHost Language="C#" 
                Debug="false" 
                Factory="MyNamespace.MultipleHostServiceFactory" 
                Service="MyNamespace.MyService" 
                CodeBehind="MyService.svc.cs" %> 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-29T21:19:26.060

我有同样的问题。结果是我运行的是 64 位版本的 Windows 2003 Server，并且我的程序集配置为“任何 CPU”。一旦我将程序集更改为 x86 并上传到服务器，一切正常。

我不知道为什么在我读到的 30 个线程中没有人在其他任何地方提到它，但是我的朋友向我推荐了它，它就像一个魅力。

只是把它扔在那里以防万一有人遇到同样的问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-10-16T06:24:32.990

我遇到了同样的问题，并通过允许 ISAPI 扩展解决了它。在 Internet 信息服务 (IIS) 管理器下，打开名为 Web 服务扩展的节点。确保“所有未知的 ISAPI 扩展”设置为允许。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-11-18T05:35:24.007

我为此奋斗了几个小时，直到我最终使用了这个例子，它首先工作：http: [//www.codeproject.com/Articles/105273/Create-RESTful-WCF-Service-API-Step-By-Step-Guide](http://www.codeproject.com/Articles/105273/Create-RESTful-WCF-Service-API-Step-By-Step-Guide)

*我知道只有链接的答案不好，其他人已经[在 Stackoverflow 使用这个 CP 链接来解决这类问题，](https://stackoverflow.com/questions/16144873/enable-wcf-service-to-use-with-json)所以*如果文章失败，这里是基本步骤：

步骤1

首先启动 Visual Studio 2010。单击 FILE->NEW->PROJECT。创建新的“WCF 服务应用程序”。

第2步

创建项目后，您可以在解决方案中看到默认情况下已创建 WCF 服务和接口文件（Service1.cs 和 IService.cs）。删除这两个文件，我们将创建自己的接口和 WCF 服务文件。

第 3 步

现在右键单击解决方案并创建一个新的 WCF 服务文件。我将服务文件命名为“RestServiceImpl.svc”。

第4步

正如我在文章开头解释的那样，我们将编写一个可以返回 XML 和 JSON 格式数据的 API，这里是它的接口。在IRestServiceImpl中，添加如下代码

在上面的代码中，您可以看到 IRestService 的两种不同方法，即 XMLData 和 JSONData。XMLData 以 XML 形式返回结果，而 JSONData 以 JSON 形式返回。

```
[ServiceContract]
public interface IRestServiceImpl
{
    [OperationContract]
    [WebInvoke(Method = "GET",
        ResponseFormat = WebMessageFormat.Xml,
        BodyStyle = WebMessageBodyStyle.Wrapped,
        UriTemplate = "xml/{id}")]
    string XMLData(string id);

    [OperationContract]
    [WebInvoke(Method = "GET",
        ResponseFormat = WebMessageFormat.Json,
        BodyStyle = WebMessageBodyStyle.Wrapped,
        UriTemplate = "json/{id}")]
    string JSONData(string id);
} 
```

第 5 步

打开文件 RestServiceImpl.svc.cs 并在那里编写以下代码：

```
public class RestServiceImpl : IRestServiceImpl
{
    public string XMLData(string id)
    {
        return "You requested product " + id;
    }

    public string JSONData(string id)
    {
        return "You requested product " + id;
    }
} 
```

第 6 步

网络配置

```
<?xml version="1.0"?>
<configuration>
  <system.web>
    <compilation debug="true" targetFramework="4.0" />
  </system.web>
  <system.serviceModel>
    <services>
      <service name="RestService.RestServiceImpl" behaviorConfiguration="ServiceBehaviour">
        <!-- Service Endpoints -->
        <!-- Unless fully qualified, address is relative to base address supplied above -->
        <endpoint address ="" binding="webHttpBinding" contract="RestService.IRestServiceImpl" behaviorConfiguration="web">
          <!-- 
              Upon deployment, the following identity element should be removed or replaced to reflect the 
              identity under which the deployed service runs.  If removed, WCF will infer an appropriate identity 
              automatically.
          -->
        </endpoint>
      </service>
    </services>

    <behaviors>
      <serviceBehaviors>
        <behavior name="ServiceBehaviour">
          <!-- To avoid disclosing metadata information, set the value below to false and remove the metadata endpoint above before deployment -->
          <serviceMetadata httpGetEnabled="true"/>
          <!-- To receive exception details in faults for debugging purposes, set the value below to true.  Set to false before deployment to avoid disclosing exception information -->
          <serviceDebug includeExceptionDetailInFaults="false"/>
        </behavior>
      </serviceBehaviors>
      <endpointBehaviors>
        <behavior name="web">
          <webHttp/>
        </behavior>
      </endpointBehaviors>
    </behaviors>
    <serviceHostingEnvironment multipleSiteBindingsEnabled="true" />
  </system.serviceModel>
  <system.webServer>
    <modules runAllManagedModulesForAllRequests="true"/>
  </system.webServer>
</configuration> 
```

第 7 步

在 IIS 中：

[![在此处输入图像描述](https://i.stack.imgur.com/4t8FZ.png)](https://i.stack.imgur.com/4t8FZ.png)

# linux - 如何通过 Linux 的 shell 学习

> ID：451713
> 
> 赞同：12
> 
> 时间：2009-01-16T19:50:10.753
> 
> 标签：linux, bash, unix, shell

**在处理 Linux/Unix 的 shell 时，我不想浪费宝贵的时间。**

如果我能很好地理解它，那就太好了。除此以外：

*   我可能会因为设置一个 crontab 而浪费一天的时间。
*   我会一直想知道为什么*这个*脚本中的 shebang 不起作用。
*   我会一直想知道两者之间的真正区别是什么：
    *   . 运行.sh
    *   ./run.sh
    *   . ./run.sh
    *   sh运行.sh
    *   sh ./run.sh

你看，正是这些事情削弱了我的 Linux/Unix 生活。

作为一名程序员，我想在这方面做得更好。我想最好还是继续使用广泛使用的 bash shell，但我可能错了。无论我使用什么工具，我都需要深入了解它。

**最终的解决方案是什么？**

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-16T20:10:38.247

只是为了好玩：

1.  `. run.sh`--- “来源”run.sh 中的代码。通常，这用于将环境变量获取到当前的 shell 进程中。对于名为`run.sh`.

2.  `./run.sh``run.sh`---在当前目录执行脚本。通常当前目录不在默认路径中（请参阅 参考资料`$PATH`），因此您需要显式调出相对位置。该`.`字符的使用方式与项目#1 不同。

3.  `. ./run.sh`---`run.sh`在当前目录中获取脚本。这结合了`.`from items #1 和 #2 的使用。

4.  `sh run.sh`--- 使用`sh`shell 解释器`run.sh`。Bourne shell 通常是运行 shell 脚本的默认设置，所以这可能与 item #2 相同，只是它在当前目录中找到第一个`run.sh`而`$PATH`不是在当前目录中。

5.  `sh ./run.sh`--- 这通常与 #2 相同，除了更冗长。

命令行界面，例如各种 shell 解释器，往往非常深奥，因为它们需要将大量含义打包到少量字符中。否则打字时间太长。

在学习方面，我建议使用`bash`or`ksh`并且不要让任何人说服你去做其他事情，直到你感到舒服为止。请不要学习，`csh`否则当您稍后开始使用 Bourne 类型的 shell 时，您将需要忘记太多。

此外，`crontab`与 shell 的其他用途相比，条目有点棘手。我的猜测是您浪费了时间，因为您的环境设置与命令行不同。如果可能的话，我建议从其他地方开始。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-01-16T20:11:13.910

手册页可能是“终极”解决方案。我总是对它们包含的宝石感到惊讶。

你甚至可以`man bash`用来回答你在这个问题中提出的一些问题。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-16T20:01:56.720

在此处尝试 Linux 文档项目的 BASH 页面[[tldp.org]](http://tldp.org/HOWTO/Bash-Prog-Intro-HOWTO.html)。
PS：区别在于。与源命令相同。这只需要读取权限。要使用 ./run.sh，您需要执行权限。当您使用“sh”时，您明确指定了要运行脚本的命令（这里，您只需要读取权限）。如果您使用外壳程序执行它，那么那里应该没有问题。如果您想使用不同的程序，例如“python”，您可以使用`python run.py`. 另一个技巧是在`#!<program>`脚本的开头添加一行。在你的情况下，`#!/bin/sh`会做，对于 Python，`#/usr/bin/env python`是最好的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-16T19:55:04.317

我认为让自己沉浸其中就是答案。这就像学习走路、打字、使用符合人体工程学的键盘或输入 dvorak。完全致力于它。是的，你绝对会慢下来。而且您将被迫不断地查看您的手或谷歌的东西。但最终它会来找你。

有趣的故事，我通过发布 ifconfig 杀死了我公寓的互联网访问。完全不知道 ifconfig renew 不是命令。当谷歌没有加载时不得不打电话给朋友;） dhcpcd 后来我又回到谷歌搜索所有内容。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-16T20:15:59.907

Oreily 有一本[较旧的书](http://oreilly.com/catalog/9780596009656/index.html)，它教你关于 bash 以及最后的 bash 脚本。您需要知道的大部分内容都在网络上，但散布在各处。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-16T19:54:42.553

最好的学习方法是阅读，然后尝试。MAN 页面通常非常有用，并且有大量的 Shell 脚本教程。如果 shell 脚本是您所追求的，那么只需阅读，然后通过编写一些简洁或有趣的小脚本来练习您阅读的内容。如果您正在寻找有关可以从 shell 运行的所有不同命令行应用程序的更多信息，那么这些应用程序更依赖于发行版，因此请查看您最喜欢的发行版的文档。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-16T20:07:04.323

经常使用 shell，经常输入“[prog-name] --help”，经常输入“man [prog-name]”，并记下哪些有效，哪些无效——即使这些注释看起来很明显当时。到明天，它们可能不再那么明显了。OTOH，几周后他们绝对应该是！

阅读有关使用 shell 的许多书籍，例如[从 Bash 到 Z Shell](http://www.bash2zsh.com/)（涵盖 Bash 和 Z）、通过[shell 脚本教程](http://www.freeos.com/guides/lsst/)或 Gnu 的[Bash 手册。](http://www.gnu.org/software/bash/manual/html_node/index.html)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-16T20:22:43.683

有一些不错的在线指南可以帮助您在 shell 中感觉更舒服。例如：

*   [Steve Parker 的 Unix/Linux Shell 脚本教程](http://steve-parker.org/sh/sh.shtml)
*   [*UNIX Shell Programming*](http://books.google.com/books?id=hxEL__hcpSoC&dq=unix+shell+programming&printsec=frontcover&source=bn&hl=en&sa=X&oi=book_result&resnum=4&ct=result#PPA95,M1)，作者 Stephen G. Kochan 和 Patrick H. Wood，可在 Google Books 上在线获取。也有精装本。亚马逊有。
*   [使用 sh/ksh 编写 UNIX shell 脚本](http://www.dartmouth.edu/~rc/classes/ksh/)。显然被用作达特茅斯学院课​​程的一部分。*ksh*是 Korn shell，它足够接近*bash*，信息将很有用。

花一些时间阅读这些类型的教程，最重要的是，在 shell 中玩。很快，它就会开始感觉像 $HOME。（好吧，对不起，糟糕的双关语......）

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-16T21:21:51.397

虽然坚持使用 Bash 可能是最好的，但在学习时，[鱼壳](http://www.fishshell.org/)可能更容易使用。我用它玩了几个星期，虽然它看起来没有 bash 强大，但它看起来确实对用户很友好。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-16T20:42:03.987

我真正了解 Linux 的方法是安装 gentoo。这需要很长时间，但你开始看到一切是如何联系在一起的。

去获取最新的说明并开始遵循它们。做足够的时间，它开始坚持。

一段时间后，您会习惯于从头开始构建所有内容。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-16T20:49:21.213

我发现尝试使用手册页来学习新命令有时有点让人不知所措。

我更喜欢手册页来刷新我的记忆。

当我想学习一个命令时，我会查找示例，然后使用手册页来微调我想要它做什么。

# c# - 如何在 C# 中使用 LINQ 从 Dictionary 转换为 SortedDictionary？

> ID：451717
> 
> 赞同：35
> 
> 时间：2009-01-16T19:51:10.050
> 
> 标签：c#, linq, dictionary

如何将字典转换为 SortedDictionary？

除了一般转换（保留键和值的类型）之外，我对交换键和值作为转换的一部分感兴趣：拥有 a`Dictionary<string, double>`并且我想将其转换为`SortedDictionary<double, string>`.

如何在 C# 3.0 中使用 LINQ 扩展方法来做到这一点？

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2009-01-16T19:56:44.517

为什么使用 LINQ？有一个构造函数：

```
new SortedDictionary<int, string>(existing); 
```

您可以*添加*-但`ToSortedDictionary`我不会打扰...

* * *

注意：这是对问题标题的回答（如果您需要 OP`Dictionary`正在`SortedDictionary` 寻找的其他步骤 - 在过程中交换键和值 - 如更新的问题所示，请参阅[此回答](https://stackoverflow.com/questions/451717/how-do-i-convert-from-a-dictionary-to-a-sorteddictionary-using-linq-in-c#451900)。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-16T19:57:04.827

不需要 LINQ。SortedDictionary 有一个构造函数来进行转换。

```
public SortedDictionary<TKey,TValue> Convert<TKey,TValue>(Dictionary<TKey,TValue> map) {
  return new SortedDictionary<TKey,TValue>(map);
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-16T20:37:11.987

这个答案解决了在过程中交换键和值的转换。

似乎您正在寻求一种优雅的方式来获取 a`Dictionary<TKey,TValue>`并将其转换为 a `SortedDictionary<TValue,TKey>`（请注意，`Dictionary`现在的值是 的键`SortedDictionary`）。

您可以创建一个扩展方法，将字典的键和值交换到另一个字典中：

```
static class Extensions
{
    public static Dictionary<TValue, TKey> 
         AsInverted<TKey, TValue>(this Dictionary<TKey, TValue> source)
    {
        var inverted = new Dictionary<TValue, TKey>();

        foreach (KeyValuePair<TKey, TValue> key in source)
            inverted.Add(key.Value, key.Key);

        return inverted;
    }
} 
```

您的应用程序代码将使用该辅助方法来交换键和值，并使用`SortedDictionary`如下常规构造函数：

```
using System;
using System.Linq;
using System.Collections.Generic;

class Program
{
    static void Main()
    {
        var dict = new Dictionary<String, Double>();
        dict.Add("four", 4);
        dict.Add("three", 3);
        dict.Add("two", 2);
        dict.Add("five", 5);
        dict.Add("one", 1);

        var sortedDict = new SortedDictionary<Double, String>(dict.AsInverted());
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-16T20:03:03.647

你不需要 LINQ，只需要一些漂亮的扩展方法：

```
public static IDictionary<TKey, TValue> Sort<TKey, TValue>(this IDictionary<TKey, TValue> dictionary)
{
    if(dictionary == null)
    {
        throw new ArgumentNullException("dictionary");
    }

    return new SortedDictionary<TKey, TValue>(dictionary);
}

public static IDictionary<TKey, TValue> Sort<TKey, TValue>(this IDictionary<TKey, TValue> dictionary, IComparer<TKey> comparer)
{
    if(dictionary == null)
    {
        throw new ArgumentNullException("dictionary");
    }

    if(comparer == null)
    {
        throw new ArgumentNullException("comparer");
    }

    return new SortedDictionary<TKey, TValue>(dictionary, comparer);
} 
```

示例用法：

```
var dictionary = new Dictionary<int, string>
{
    { 1, "one" },
    { 2, "two" },
    { 0, "zero" }
};

foreach(var pair in dictionary.Sort())
{
    Console.WriteLine("{0}: {1}", pair.Key, pair.Value);
}

// 0: zero
// 1: one
// 2: two 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-17T01:18:02.510

使用反转`ToDictionary`：

```
public static IDictionary<TValue, TKey> Invert<TKey, TValue>(this IDictionary<TKey, TValue> dictionary)
{
    if(dictionary == null)
    {
        throw new ArgumentNullException("dictionary");
    }

    return dictionary.ToDictionary(pair => pair.Value, pair => pair.Key);
} 
```

示例用法：

```
var dictionary = new Dictionary<string, int>
{
    { "zero", 0 },
    { "one", 1 },
    { "two", 2 }
};

foreach(var pair in dictionary.Invert())
{
    Console.WriteLine("{0}: {1}", pair.Key, pair.Value);
}

// 0: zero
// 1: one
// 2: two 
```

反转和排序的示例（有关 的定义，请参阅我的其他答案`Sort`）：

```
var dictionary = new Dictionary<string, int>
{
    { "one", 1 },
    { "two", 2 },
    { "zero", 0 }
};

foreach(var pair in dictionary.Invert().Sort())
{
    Console.WriteLine("{0}: {1}", pair.Key, pair.Value);
}

// 0: zero
// 1: one
// 2: two 
```

# .net - 我一直听说有大量的错误跟踪器，但在 .net 中构建的并不多

> ID：451718
> 
> 赞同：2
> 
> 时间：2009-01-16T19:51:29.550
> 
> 标签：.net, bug-tracking

是的，有大量的错误跟踪器应用程序可供购买，但作为一个 .net 商店，并且总是倾向于购买 .net 构建产品，我在错误跟踪器方面没有看到那么多选择。

从我的头顶我只能想到2，axosoft和gemini。

还有什么？

我一个人在这里还是大多数其他 .net 商店都想要 .net 构建产品？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-01-16T19:55:16.127

错误跟踪器内置什么技术对我来说并不重要。我非常喜欢 FogBugz，它不是基于 .Net 的。Bugzilla 也不是，我们用它来跟踪 .Net 项目。

不必担心正确完成工作所需的工具的底层技术。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-07-15T10:04:12.343

其他几个答案说系统写什么并不重要，我不能同意。

当涉及到简单的桌面应用程序时，它们可能是正确的（例如，我们使用 Mercurial/TortoiseHG 进行源代码控制，它是用 Python 编写的**并不**重要……它只是工作）。

但是当应用程序需要某种特殊的服务器（Web 服务器、数据库服务器......大多数可用的错误跟踪器都需要两者）时，情况就完全不同了。
当你需要其中一些时，你可能会使用你知道的东西：

例如，我们是一家 Microsoft 商店……我们已经准备好并运行 ASP.NET Web 服务器和 SQL 服务器，并且我们有知道如何使用它们的人员。
另一方面，这里没有人知道什么，比如 Oracle/MySql/PostgreSql 或 Ruby/PHP。

这排除了很多可用的错误跟踪器，因为我们甚至不知道让它们运行！

是的，我们可以尝试错误并设置新的 Web 和数据库服务器并尝试让这些东西正常工作，但很难证明学习所有东西只是为了运行一个简单的错误跟踪器。
（并且仅仅安装并让它运行并不是你所需要的……例如，当你运行数据库时，有人必须弄清楚如何进行备份，如何在出现问题时恢复它们……名单还在继续）

所以我们可能会使用 .net 错误跟踪器（我们只是在评估自己）......可能是 Bugtracker.Net。

**编辑：**

约翰，我不是这个意思。

例如，除了 Bugtracker.Net，我还评估了 Redmine（它是用 Ruby on Rails 编写的）。
我不想更改 Redmine 代码中的任何内容，只需安装它 - 但请查看[安装说明](http://www.redmine.org/wiki/redmine/RedmineInstall)：
即使要安装 Redmine，您也需要一定程度的 RoR 知识（我根本没有，我的任何一个同事都没有——我们是 Windows 和 .net 用户，我们没有人曾经使用过 Ruby）。
也许 Redmine 比 BugTracker.Net 更酷或者可以做得更多——但我们真的可以证明学习一些 RoR 只是为了能够安装这个软件吗？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-16T19:54:22.710

我使用了基于 .NET 的[BugNet](http://www.bugnetproject.com/)，实际上它似乎基于旧版本的 DotNetNuke。

它并不完美，但它确实有效。[你可以在这里](http://productsupport.iowacomputergurus.com)看到我的风格版本。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-16T19:55:23.973

好吧，总是有[BugTracker.NET](http://ifdefined.com/bugtrackernet.html) ...

就个人而言，我并不真正关心系统是用什么编写的。只要它不是经典的 ASP。嗯。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-08-05T19:51:37.820

您可能想尝试 EzSDLC [http://encodesoft.com/?page_id=77](http://encodesoft.com/?page_id=77)，他们也提供截图 pdf。该工具基于.NET

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-16T19:58:05.807

你忘了 FogBugz。我不认为它完全在.net 中，但它的一部分肯定是。

在寻找开源选项时我也一样。我首先寻找 .net 产品，因为我知道它们是如何工作的。对于封闭源选项或托管选项，我不太在意。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-16T19:59:37.630

Microsoft 的这个问题跟踪器应用程序也可以使用：[ [http://www.asp.net/downloads/archived/starter-kits/issue-tracker/]](http://www.asp.net/downloads/archived/starter-kits/issue-tracker/])

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-16T20:18:58.667

[Fortress](http://www.sourcegear.com)的部分内容是用 .NET 构建的。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-16T20:20:14.517

我最近的任务是为我的公司建立一个开源错误跟踪系统。我浏览了许多可用的商业和开源系统，最后选择了免费的[BugTracker .NET](http://ifdefined.com/bugtrackernet.html)。

我绝对对我的决定感到高兴。该系统功能非常丰富，尤其是在电子邮件通知领域。但我最喜欢它的部分是它的灵活性。当我第一次向他们演示应用程序时，我的老板希望对其进行大量不同的更改。令人惊讶的是，99% 的更改不需要我编写任何代码，它们要么是管理员配置中的设置，要么是 web.config 中的设置。对于我所做的编码修改，我可以说应用程序的代码当然是可以理解的，并且如果你需要修改也不难（你可能不会）。

# sql-server - 管道的另一端没有进程

> ID：451720
> 
> 赞同：17
> 
> 时间：2009-01-16T19:51:49.877
> 
> 标签：sql-server, sql-server-2005, ssis

当我尝试连接到 SQL Server 2005 时收到此错误。我启用了 TCP/IP、命名管道并重新启动了服务器，但这不起作用。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2015-12-23T00:51:39.667

对我来说，问题是 SQL 服务器仅处于 Windows 身份验证模式，即使我在安装期间将其设置为混合。

在对象资源管理器中，右键单击服务器、属性，然后单击安全页面并将服务器身份验证设置为 SQL Server 和 Windows 身份验证模式。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-17T20:23:23.353

我尝试了两篇微软技术文章中的故障排除步骤，但奇怪的是没有运气。

我设法通过将身份验证从 SQL Server Auth 更改为 Windows Auth 来修复解决方案。虽然我不确定这行得通的技术原因吗？

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-08-26T07:09:50.677

仅供参考，我刚刚遇到了同样的错误。

我切换到 Windows 身份验证，断开连接，然后尝试使用 SQL 身份验证再次登录。这次我被告知我的密码已过期。我更改了密码，一切都恢复了。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-11-28T10:21:53.023

确保初始目录中指定的数据库存在可能会有所帮助。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-03-02T23:45:40.037

当我（故意）将最大 SQL Server 内存的配置减少到 16Mb 并重新启动时，我得到了这个错误。

所以可能是内存问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-08-21T21:53:36.923

当我尝试连接的登录密码已过期时，我遇到了这个问题。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-05-13T19:44:31.657

此错误消息的另一个原因可能是您删除了应用程序使用的数据库，并且您没有从 Visual Studio 运行以下命令：

```
Add-Migration MigrationNameHere
Update-Database 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-16T22:56:54.497

我假设你已经看到了这个： [http ://technet.microsoft.com/en-us/library/ms175496.aspx](http://technet.microsoft.com/en-us/library/ms175496.aspx)

这个怎么样？ [http://blogs.msdn.com/sql_protocols/archive/2006/07/26/678596.aspx](http://blogs.msdn.com/sql_protocols/archive/2006/07/26/678596.aspx)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-12-11T10:18:29.350

第一次检查窗口的事件日志是否有以下错误：

> 无法连接，因为已达到“1”用户连接的最大数量。系统管理员可以使用 sp_configure 来增加最大值。连接已关闭。

要解决此问题，请执行以下操作：

*   打开 Microsoft SQL Server 管理工作室
*   打开一个新查询
*   输入下面给定的代码并按下执行按钮

    ```
    sp_configure ‘show advanced options’, 1;
    GO
    reconfigure
    GO
    sp_configure ‘user connections’, 0;
    GO
    reconfigure
    GO 
    ```

来源： http: [//www.windowstechupdates.com/microsoft-sql-server-error-233-no-process-is-on-the-other-end-of-the-pipe/](http://www.windowstechupdates.com/microsoft-sql-server-error-233-no-process-is-on-the-other-end-of-the-pipe/)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-05-23T13:46:15.803

就我而言，请确保您的连接字符串具有 ;password=

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-02-13T19:19:52.457

> 与服务器成功建立连接，但在登录过程中出现错误。（提供者：共享内存提供者，错误：0 - 管道的另一端没有进程。）（Microsoft SQL Server，错误：233）

当登录没有分配活动的“默认数据库”时，将发生此错误。就我而言，这是在使数据库脱机后发生的。以前的 DBA 已将非系统 DB 分配为登录的默认 DB。该数据库脱机后，登录失败抛出此错误 233。

要检查并修复此问题... 通过 SSMS 使用不同的登录名登录到 SQL Server 实例。转到... >> 安全 >> 登录 >> {登录名} >> 常规

检查“默认数据库”是否设置为活动数据库（我恢复为“主数据库”）。

注销然后尝试使用刚刚更新的登录名再次登录。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-05-28T19:25:20.313

就我而言：

它被 Symantec AV 和防火墙阻止

仅供试用，我必须禁用 symantec n 防火墙

我想我会进一步检查

# wpf - 与 TabItems 多次使用相同的模块

> ID：451730
> 
> 赞同：1
> 
> 时间：2009-01-16T19:55:06.437
> 
> 标签：wpf, prism

这是我的场景：

1.  带有 1 个 TabControl 和 1 个名为 MenuRegion 的区域的外壳
2.  MenuRegion 包含每个可用模块（应用程序）的按钮。

我想使用 Prism (Composite Application Library for WPF) 实现以下目标：单击其中一个按钮时，我需要向 TabControl 添加一个新的 TabItem，并在此 TabItem 内加载相应模块（应用程序）的单个实例. 一个模块可能会在 TabControl 中出现多次。

* * *

我真的很感谢你的回答。但我不相信您使用的是 Prism ( [http://www.codeplex.com/CompositeWPF](http://www.codeplex.com/CompositeWPF) ) 是吗？我的问题与棱镜更相关，我现在对其进行了编辑以使其更加清晰。

在 Prism 中，您可以将模块的视图动态加载到区域中。我不确定如何在我的场景中做到这一点，因为这些区域是动态设置的。我将如何命名它们？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-10-08T19:52:10.580

我是这个 PRISM 世界的新手（1 周经验 :)））并且有同样的要求！首先，您必须从[此处](http://blogs.southworks.net/matiasb/2009/07/02/how-to-hide-views-inside-composite-application-guidance-aka-prism-v2-regions/)获取 Regionextensions 。

我的（可能是你的）问题的解决方案如下：

*   有 2 个区域（菜单和 tabcontrol - 用于类似 mdi 的行为）

*   tabitem 标题必须准备一个用于关闭的按钮（绑定到用于关闭此 tabitem 的命令 - 实际上隐藏此 tabitem）

*   将事件从菜单项发送到应该加载视图的模块（我已经按需实例化了模块）。在模块的初始化方法中订阅菜单项发送的事件。在事件处理方法中，您只需重新显示 tabitem

如果这是对您的抽象，我可以向您发送一个我开发的框架应用程序来玩。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-16T20:53:16.553

我们做了类似的事情，尽管我们已经创建了选项卡项目（没有内容）并根据需要显示/隐藏。选择选项卡项时，我们加载选项卡内容。

```
private void TabControl_SelectionChanged(object sender, SelectionChangedEventArgs e)
    {
        if (e.OriginalSource != sender) return;

        TabControl tabControl = (TabControl)sender;
        TabItem tabItem = (TabItem)tabControl.SelectedItem;

        if (!tabItem.HasContent)
            AddTabContent(tabItem); // This will cause a refresh once the content is loaded.
        else
            Refresh(tabItem);
    }

private void AddTabContent(TabItem tabItem)
    {
        IOptimusPage page = tabItem.Tag as IOptimusPage;

        //This allows lazy loading of controls
        if (page != null)
        {
            if (!tabItem.HasContent)
            {
                CustomerEngagementUserControl control = page.GetControl(DataContext as CustomerEngagementUIObject, Services);

                tabItem.Content = control;
            }
        }

    } 
```

选项卡项内容在选项卡项标记中指定，使用负责创建内容的页面。

```
<TabItem
Header="Personal Background"
Style="{StaticResource FirstBreadcrumbTabItem}"
x:Name="PersonalBackgroundTab">
    <TabItem.Tag>
        <Pages:FfnaPersonalBackgroundPage />
    </TabItem.Tag>
</TabItem> 
```

页面创建控件。

```
class FfnaPersonalBackgroundPage : IOptimusPage
{
    #region IOptimusPage Members

    public CustomerEngagementUserControl GetControl(CustomerEngagementUIObject dataContext, CustomerEngagementServices services)
    {
        CustomerEngagementUserControl control = new FfnaPersonalBackgroundControl();
        control.DataContext = dataContext;
        control.Services = services;
        return control;
    }

    #endregion
} 
```

您可以使用类似的技术动态创建标签项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T14:29:17.700

我知道响应已经很晚了，但我正在做类似的事情，虽然还没有实现完整的解决方案。

此代码发生在我在演示者中处理的按钮的单击事件上。该模块在配置文件中定义。

```
ModuleInfo moduleInfoObject = this.moduleEnumerator.GetModule("ModuleA"); 

Assembly assembly = this.LoadAssembly(moduleInfoObject);

Type type = assembly.GetType(moduleInfoObject.ModuleType);
IModule aModule = this.CreateModule(type);                                    
aModule.Initialize();  

// - - - -Helper Methods - - - -
// - - - LoadAssembly - - -       
private Assembly LoadAssembly(ModuleInfo moduleInfo)
    {            
        string assemblyFile = moduleInfo.AssemblyFile;
        assemblyFile = this.GetModulePath(assemblyFile);

        FileInfo file = new FileInfo(assemblyFile);
        Assembly assembly;

        try
        {
            assembly = Assembly.LoadFrom(file.FullName);
        } 
        catch (Exception ex)
        {
            throw new ModuleLoadException(null, assemblyFile, ex.Message, ex);
        } 

        return assembly;

    } // LoadAssembly(moduleInfo)

// - - - CreateModule - - -
private IModule CreateModule(Type type)
    {
        return (IModule)containerFacade.Resolve(type);            
    } // CreateModule(type)

// - - - GetModulePath - - -
private string GetModulePath(string assemblyFile)
    {
        if (String.IsNullOrEmpty(assemblyFile))
        {
            throw new ArgumentNullException("assemblyFile");
        } // if

        if (Path.IsPathRooted(assemblyFile) == false)
        {
            assemblyFile = Path.Combine(AppDomain.CurrentDomain.BaseDirectory, assemblyFile);
        } // if

        return assemblyFile;
    } // GetModulePath(assemblyFile) 
```

# apache-flex - 在 ActionScript / Flex 3 中将事件与类关联的最佳方式是什么？

> ID：451737
> 
> 赞同：2
> 
> 时间：2009-01-16T19:55:50.400
> 
> 标签：apache-flex, actionscript-3, events, actionscript, flex3

**ActionScript 3 / Flex 3 - 向类添加自定义事件**

假设我有以下事件：

```
import flash.events.Event;
public class SomeEvent extends Event
{
    public static const EVENT_ACTION:String = "eventAction";

    public function SomeEvent(type:String) {
        super(type);
    }

    override public function clone():Event {
        return new SomeEvent(this.type);
    }
} 
```

...以及以下课程：

```
public class SomeClass extends EventDispatcher
{
    public function someFunction():void
    {
        dispatchEvent(new SomeEvent("eventAction"));
    }
} 
```

显示“SomeClass”抛出“SomeEvent”的最佳方式是什么？我发现的唯一方法是用 [Event] 属性装饰“SomeClass”，如下所示：

```
[Event (name="eventAction", type="SomeEvent")] 
```

这允许我实例化类并通过执行以下操作添加事件侦听器：

```
var someClassInstance:SomeClass = new SomeClass();
someClassInstance.addEventListener(SomeEvent.EVENT_ACTION, mycallbackmethod); 
```

有一个更好的方法吗？将 [Event] 属性放在类上，后跟一些字符串文字只是感觉......错了。在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-16T23:38:09.903

You're doing it right. Currently, the AS3 compiler allows only string literals in metadata. Constants cannot be used.

By the way, Adobe's public bug database has a [feature request to allow ActionScript constants in metadata](http://bugs.adobe.com/jira/browse/ASC-2580). Feel free to vote for it.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-16T21:06:03.487

I know, I feel the same way; using the string literals does seem a bit wrong somehow. But to the best of my knowledge, from all the documentation I've seen and the talks I've attended and in reading the Flex source code, etc., it does appear that's the proper way to do it.

# drupal - Drupal Views2 Exposed Form如何更改

> ID：451745
> 
> 赞同：2
> 
> 时间：2009-01-16T19:59:22.547
> 
> 标签：drupal, drupal-6, drupal-views

我有一个带有暴露形式的视图。我正在尝试一些事情。理想情况下，我希望有一个下拉菜单可以触发没有按钮的表单。如果那不可能，那么我希望按钮文本与应用不同。

我现在破解了它并更改了views.module中的views_form，但这似乎不是正确的方法。我现在只有一个公开的表格，但如果我添加更多呢？

有关我的示例，请参阅[http://www.wiredvillage.ca/News](http://www.wiredvillage.ca/News)。

我在 drupal.org 上闲逛，看到其他人有同样的问题，但到目前为止还没有解决方案。不确定获得 Drupal 帮助的最佳地点在哪里。

这是我到目前为止所做的更改：

```
function views_exposed_form(&$form_state) {
  // Make sure that we validate because this form might be submitted
  // multiple times per page.
  $form_state['must_validate'] = TRUE;
  $view = &$form_state['view'];
  $display = &$form_state['display'];
  $form_state['input'] = $view->get_exposed_input();
  // Let form plugins know this is for exposed widgets.
  $form_state['exposed'] = TRUE;
  $form['#info'] = array();
  if (!variable_get('clean_url', FALSE)) {
    $form['q'] = array(
      '#type' => 'hidden',
      '#value' => $view->get_url(),
    );
  }
  // Go through each filter and let it generate its info.
  foreach ($view->filter as $id => $filter) {
    $view->filter[$id]->exposed_form($form, $form_state);
    if ($info = $view->filter[$id]->exposed_info()) {
      $form['#info']['filter-' . $id] = $info;
    }
  }

  // I CHANGED The VALUE OF THIS SUBMIT BUTTON TO GO

  $form['submit'] = array(
    '#name' => '', // prevent from showing up in $_GET.
    '#type' => 'submit',
    '#value' => t('go'),
  );
  $form['#action'] = url($view->get_url());
  $form['#theme'] = views_theme_functions('views_exposed_form', $view, $display);
  $form['#id'] = views_css_safe('views_exposed_form-' . check_plain($view->name) . '-' . check_plain($display->id));
//  $form['#attributes']['class'] = array('views-exposed-form');
  // If using AJAX, we need the form plugin.
  if ($view->use_ajax) {
    drupal_add_js('misc/jquery.form.js');
  }
  views_add_js('dependent');
  return $form;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-18T17:53:08.037

或者，您可以使用预处理函数来更改表单，甚至在它构建之前。我想更改按钮上的文本，所以我这样做了：

```
function MYTHEME_preprocess_views_exposed_form(&$vars, $hook) {

  // only alter the jobs search exposed filter form
  if ($vars['form']['#id'] == 'views-exposed-form-jobs-search-page-1') {

    // Change the text on the submit button
    $vars['form']['submit']['#value'] = t('Search');

    // Rebuild the rendered version (submit button, rest remains unchanged)
    unset($vars['form']['submit']['#printed']);
    $vars['button'] = drupal_render($vars['form']['submit']);
  }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-18T06:50:22.137

如果您希望触发下拉菜单，我会使用 JavaScript 而不是像伊顿建议的那样破解模块。

基本上，您可以按照伊顿的建议使用 hook_form_alter 修改文本，然后在同一个 hook_form_alter 中使用，使用您的自定义 JS 添加对 drupal_add_js 的调用，该 JS 隐藏按钮并在选择下拉列表的 onChange 处理程序上提交表单。对于 JS 失败的那 10% 的用户，您希望那里有那个提交按钮。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-12-14T23:31:04.450

上述两种方法都很好，但我发现更改表单可能并不总能带来理想的结果，主要是因为暴露的过滤器是使用特定主题模板进行主题化的。更改主题的正确方法是覆盖`views-exposed-form.tpl`主题文件夹中的文件。请记住，这将适用于所有公开的过滤器表单，要为特定的过滤器表单设置主题，您需要为该文件名使用不同的名称，例如：

```
views-exposed-form--TITLE--DISPLAY.tpl.php
views-exposed-form--TITLE.tpl.php 
```

和其他一些，您可以检查模板命名约定的视图的**主题：信息**部分。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-01-13T08:10:16.690

此模块提供自动提交以及其他功能[http://drupal.org/project/views_hacks](http://drupal.org/project/views_hacks)

这个模块非常适合改进暴露的过滤器[http://drupal.org/project/better_exposed_filters](http://drupal.org/project/better_exposed_filters)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-18T03:49:05.000

您应该能够使用 hook_form_alter() ( [http://api.drupal.org/api/function/hook_form_alter](http://api.drupal.org/api/function/hook_form_alter) ) 在表单构建时更改表单，在显示特定视图时修改相关字段。您可以取消提交按钮，添加调用 drupal_add_js() 函数的#theme 函数，等等。

只要 GET 参数以视图期望的方式出现，一切都会正常工作——它的设计方式是允许使用暴露的过滤器设置等为页面添加书签。重要的部分是确保您正在执行表单修改你自己模块的 hook_form_alter() 函数，这样它就不会让其他视图驱动的东西窒息。

# wpf - WPF MV-VM：从 ListCollectionView 中获取选定的项目？

> ID：451748
> 
> 赞同：16
> 
> 时间：2009-01-16T20:00:09.377
> 
> 标签：wpf, mvvm, listbox

我有一个使用 Model-View-ViewModel 模式的 WPF 应用程序。
在我的 ViewModel 中，我有一个 ListCollectionView 来保存项目列表。
此 ListCollectionView 绑定到我的视图中的 ListBox。

```
<ListBox Grid.Row="1" ItemsSource="{Binding Useragents}" SelectionMode="Multiple"/> 
```

ListBox 具有 SelectionMode=Multiple，因此您可以一次选择多个项目。现在 ViewModel 需要知道哪些项目已被选中。

问题是：在 View-Model-ViewModel 模式中，ViewModel 无法访问 View，所以我不能只询问 ListBox 哪些项目已被选中。我所拥有的只是 ListCollectionView，但我无法找到一种方法来查找其中已选择哪些项目。

那么如何找到 ListBox 中选择了哪些项目呢？或者实现这一点的技巧（也许将某些东西绑定到我的项目中的布尔“IsSelected”？但是什么？如何？）

也许使用这种模式的人也可以在这里帮助我？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-16T21:46:20.583

您需要创建一个具有 IsSelected 概念的 ViewModel，并绑定到使用标准 WPF 绑定架构在 View 中表示它的实际 ListBoxItem 的 IsSelected 属性。

然后在您的代码中，它知道您的 ViewModel，但不知道它由任何特定 View 表示的事实，可以只使用该属性来找出模型中的哪些项目实际上是被选择的，而不管设计师选择它在看法。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2011-12-03T17:32:23.200

[PRISM MVVM 参考实现](http://msdn.microsoft.com/en-us/library/gg405492%28v=pandp.40%29.aspx)有一个称为 SynchronizeSelectedItems 的行为，在 Prism4\MVVM RI\MVVM.Client\Views\MultipleSelectionView.xaml 中使用，它将选中的项目与名为的 ViewModel 属性同步`Selections`：

```
 <ListBox Grid.Column="0" Grid.Row="1" IsTabStop="False" SelectionMode="Multiple"
                 ItemsSource="{Binding Question.Range}" Margin="5">

            <ListBox.ItemContainerStyle>
                <!-- Custom style to show the multi-selection list box as a collection of check boxes -->
                <Style TargetType="ListBoxItem">
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="ListBoxItem">
                                <Grid Background="Transparent">
                                    <CheckBox IsChecked="{Binding IsSelected, RelativeSource={RelativeSource TemplatedParent}, Mode=TwoWay}" 
                                              IsHitTestVisible="False" IsTabStop="True"
                                              AutomationProperties.AutomationId="CheckBoxAutomationId">
                                        <ContentPresenter/>
                                    </CheckBox>
                                </Grid>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Style>
            </ListBox.ItemContainerStyle>
            <i:Interaction.Behaviors>
                <!-- Custom behavior that synchronizes the selected items with the view models collection -->
                <Behaviors:SynchronizeSelectedItems Selections="{Binding Selections}"/>
            </i:Interaction.Behaviors>
        </ListBox> 
```

转到[http://compositewpf.codeplex.com/](http://compositewpf.codeplex.com/)并全部获取或使用它：

```
//===================================================================================
// Microsoft patterns & practices
// Composite Application Guidance for Windows Presentation Foundation and Silverlight
//===================================================================================
// Copyright (c) Microsoft Corporation.  All rights reserved.
// THIS CODE AND INFORMATION IS PROVIDED "AS IS" WITHOUT WARRANTY
// OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING BUT NOT
// LIMITED TO THE IMPLIED WARRANTIES OF MERCHANTABILITY AND
// FITNESS FOR A PARTICULAR PURPOSE.
//===================================================================================
// The example companies, organizations, products, domain names,
// e-mail addresses, logos, people, places, and events depicted
// herein are fictitious.  No association with any real company,
// organization, product, domain name, email address, logo, person,
// places, or events is intended or should be inferred.
//===================================================================================
using System;
using System.Collections;
using System.Collections.Specialized;
using System.Diagnostics.CodeAnalysis;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Interactivity;

namespace MVVM.Client.Infrastructure.Behaviors
{
    /// <summary>
    /// Custom behavior that synchronizes the list in <see cref="ListBox.SelectedItems"/> with a collection.
    /// </summary>
    /// <remarks>
    /// This behavior uses a weak event handler to listen for changes on the synchronized collection.
    /// </remarks>
    public class SynchronizeSelectedItems : Behavior<ListBox>
    {
        public static readonly DependencyProperty SelectionsProperty =
            DependencyProperty.Register(
                "Selections",
                typeof(IList),
                typeof(SynchronizeSelectedItems),
                new PropertyMetadata(null, OnSelectionsPropertyChanged));

        private bool updating;
        private WeakEventHandler<SynchronizeSelectedItems, object, NotifyCollectionChangedEventArgs> currentWeakHandler;

        [SuppressMessage("Microsoft.Usage", "CA2227:CollectionPropertiesShouldBeReadOnly",
            Justification = "Dependency property")]
        public IList Selections
        {
            get { return (IList)this.GetValue(SelectionsProperty); }
            set { this.SetValue(SelectionsProperty, value); }
        }

        protected override void OnAttached()
        {
            base.OnAttached();

            this.AssociatedObject.SelectionChanged += this.OnSelectedItemsChanged;
            this.UpdateSelectedItems();
        }

        protected override void OnDetaching()
        {
            this.AssociatedObject.SelectionChanged += this.OnSelectedItemsChanged;

            base.OnDetaching();
        }

        private static void OnSelectionsPropertyChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
        {
            var behavior = d as SynchronizeSelectedItems;

            if (behavior != null)
            {
                if (behavior.currentWeakHandler != null)
                {
                    behavior.currentWeakHandler.Detach();
                    behavior.currentWeakHandler = null;
                }

                if (e.NewValue != null)
                {
                    var notifyCollectionChanged = e.NewValue as INotifyCollectionChanged;
                    if (notifyCollectionChanged != null)
                    {
                        behavior.currentWeakHandler =
                            new WeakEventHandler<SynchronizeSelectedItems, object, NotifyCollectionChangedEventArgs>(
                                behavior,
                                (instance, sender, args) => instance.OnSelectionsCollectionChanged(sender, args),
                                (listener) => notifyCollectionChanged.CollectionChanged -= listener.OnEvent);
                        notifyCollectionChanged.CollectionChanged += behavior.currentWeakHandler.OnEvent;
                    }

                    behavior.UpdateSelectedItems();
                }
            }
        }

        private void OnSelectedItemsChanged(object sender, SelectionChangedEventArgs e)
        {
            this.UpdateSelections(e);
        }

        private void UpdateSelections(SelectionChangedEventArgs e)
        {
            this.ExecuteIfNotUpdating(
                () =>
                {
                    if (this.Selections != null)
                    {
                        foreach (var item in e.AddedItems)
                        {
                            this.Selections.Add(item);
                        }

                        foreach (var item in e.RemovedItems)
                        {
                            this.Selections.Remove(item);
                        }
                    }
                });
        }

        private void OnSelectionsCollectionChanged(object sender, NotifyCollectionChangedEventArgs e)
        {
            this.UpdateSelectedItems();
        }

        private void UpdateSelectedItems()
        {
            this.ExecuteIfNotUpdating(
                () =>
                {
                    if (this.AssociatedObject != null)
                    {
                        this.AssociatedObject.SelectedItems.Clear();
                        foreach (var item in this.Selections ?? new object[0])
                        {
                            this.AssociatedObject.SelectedItems.Add(item);
                        }
                    }
                });
        }

        private void ExecuteIfNotUpdating(Action execute)
        {
            if (!this.updating)
            {
                try
                {
                    this.updating = true;
                    execute();
                }
                finally
                {
                    this.updating = false;
                }
            }
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-26T19:56:01.317

查看 Josh Smith[的这篇博文 绑定到分组 ICollectionView 时最初选择的项目](http://joshsmithonwpf.wordpress.com/2008/09/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-26T20:11:08.397

Drew Marsh 的解决方案效果很好，我推荐它。我还有另一个解决方案！

模型视图 ViewModel 是一个[被动视图](http://martinfowler.com/eaaDev/PassiveScreen.html)，您还可以使用[演示模型](http://martinfowler.com/eaaDev/PresentationModel.html)访问演示文稿的某些数据，而无需与 WPF 耦合（此模式用于[PRISM的](http://www.codeplex.com/CompositeWPF)[Stocktrader](http://msdn.microsoft.com/en-us/library/cc707869.aspx)示例）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-07-02T20:05:42.903

如果您有一个小列表，Drew Marsh 的答案很好，如果您有一个大列表，查找所有选定项目的性能可能会很糟糕！我最喜欢的解决方案是在 ListBox 上创建一个附加属性，然后绑定到包含所选项目的 ObservableCollection。然后使用附加的属性订阅 items SelectionChanged 事件以从集合中添加/删除项目。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-09-10T09:57:03.033

对我来说，最好的答案是打破一点 MVVM 的原则。

在后面的代码 1\. 实例化您的 viewModel 2\. 添加一个事件处理程序 SelectionChanged 3\. 遍历您选择的项目并将每个项目添加到您的 viewModel 列表中

```
ViewModel viewModel = new ViewModel();

viewModel.SelectedModules = new ObservableCollection<string>();

foreach (var selectedModule in listBox1.SelectedItems)
{
    viewModel.SelectedModules.Add(selectedModule.ToString());
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-07-02T19:09:03.253

这是 View-Model-ViewModel 模式的另一种变体，其中 ViewModel 可以通过 IView 接口访问视图。

我遇到了很多不能使用 WPF 绑定的场景，然后你需要在代码中同步 View 和 ViewModel 之间的状态。

这里显示了如何做到这一点：

[WPF 应用程序框架 (WAF)](http://waf.codeplex.com)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-10-06T13:33:48.210

看看这里 [http://blog.functionalfun.net/2009/02/how-to-databind-to-selecteditems.html](http://blog.functionalfun.net/2009/02/how-to-databind-to-selecteditems.html)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-11-18T03:10:02.397

David Rogers 的解决方案很棒，在以下相关问题中有详细说明：

[将多选列表框中的 SelectedItems 与 ViewModel 中的集合同步](https://stackoverflow.com/questions/1297643/sync-selecteditems-in-a-muliselect-listbox-with-a-collection-in-viewmodel/1299544#1299544)

# c++ - 是否有基本 win32 C++ 的 TRACE 语句？

> ID：451749
> 
> 赞同：8
> 
> 时间：2009-01-16T20:00:16.490
> 
> 标签：c++, debugging, winapi, visual-c++-6

在 MFC C++ (Visual Studio 6) 中，我习惯于使用 TRACE 宏进行调试。普通的win32是否有等效的声明？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-16T20:35:27.667

_RPTn 效果很好，虽然不是很方便。 [下面是一些](http://www.codeguru.com/cpp/v-s/debug/article.php/c4405)将 MFC TRACE 语句重新创建为允许可变数量参数的函数的代码。还添加了 TraceEx 宏，该宏在源文件和行号之前添加，因此您可以单击返回到语句的位置。

更新：CodeGuru 上的原始代码在发布模式下无法为我编译，因此我更改了在发布模式下删除 TRACE 语句的方式。这是我放入 Trace.h 的完整源代码。 *感谢 Thomas Rizos 的原作*：

```
// TRACE macro for win32
#ifndef __TRACE_H__850CE873
#define __TRACE_H__850CE873

#include <crtdbg.h>
#include <stdarg.h>
#include <stdio.h>
#include <string.h>

#ifdef _DEBUG
#define TRACEMAXSTRING  1024

char szBuffer[TRACEMAXSTRING];
inline void TRACE(const char* format,...)
{
    va_list args;
    va_start(args,format);
    int nBuf;
    nBuf = _vsnprintf(szBuffer,
                   TRACEMAXSTRING,
                   format,
                   args);
    va_end(args);

    _RPT0(_CRT_WARN,szBuffer);
}
#define TRACEF _snprintf(szBuffer,TRACEMAXSTRING,"%s(%d): ", \
                &strrchr(__FILE__,'\\')[1],__LINE__); \
                _RPT0(_CRT_WARN,szBuffer); \
                TRACE
#else
// Remove for release mode
#define TRACE  ((void)0)
#define TRACEF ((void)0)
#endif

#endif // __TRACE_H__850CE873 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-16T20:05:37.650

来自 msdn 文档，[用于报告的宏](http://msdn.microsoft.com/en-us/library/yt0c3wdh(VS.80).aspx)：

> 您可以使用 CRTDBG.H 中定义的 _RPTn 和 _RPTFn 宏来代替使用 printf 语句进行调试。当未定义 _DEBUG 时，这些宏会在您的发布版本中自动消失，因此无需将它们包含在 #ifdefs 中。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-16T22:16:14.267

还有OutputDebugString。但是，在编译版本时不会删除它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-31T15:08:06.800

我只是使用这样的东西（从记忆中，根本没有测试......）

```
#define TRACE(msg) {\
    std::ostringstream ss; \
    ss << msg << "\n"; \
    OutputDebugString(msg.str()); \
} 
```

然后我可以写这样的东西：-

```
TRACE("MyClass::MyFunction returned " << value << " with data=" << some.data); 
```

您可以将其包装在一些#ifdefs 中，以便在发布版本中轻松删除它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-30T09:30:47.683

**提供带有**源代码链接**的消息、**运行时调用堆栈**信息和带有参数值的**函数原型信息的****跟踪宏：****

 **[**扩展跟踪**：Win32 的跟踪宏](http://www.codeproject.com/KB/debug/extendedtrace.aspx)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-10-31T15:01:57.363

我发现`_RPT()`在 Visual Studio 2005 中使用该宏也适用于 C 源文件。这篇[使用 Visual Studio 2005/2008 进行调试：日志记录和跟踪](http://www.cprogramming.com/tutorial/visual_studio_trace_log_messages.html)提供了 TRACE、_RPT 和其他日志记录类型宏的概述。

我为名为 ASSRTLOG 的日志文件生成一行，其中包含日志，当将日志写入文件时，我还执行以下源代码行：

```
_RPT1(_CRT_WARN, "ASSRTLOG: %s", szLog1); 
```

此行将进入日志文件的相同日志放入 Visual Studio 2005 IDE 的输出窗口。

您可能对我们用于日志记录的方法背后的机制感兴趣。我们有一个函数`PifLogAbort()`，它接受一系列参数，然后用于生成日志。这些参数包括生成日志的文件的名称以及行号。宏如下所示：

```
#define NHPOS_ASSERT_TEXT(x, txt) if (!(x)) { PifLogAbort( (UCHAR *)  #x , (UCHAR *)  __FILE__ , (UCHAR *) txt , __LINE__ );} 
```

函数原型`PifLogAbort()`如下所示：

```
PifLogNoAbort(UCHAR *lpCondition, UCHAR *lpFilename, UCHAR *lpFunctionname, ULONG ulLineNo) 
```

并使用宏，我们将插入这样的一行：

```
NHPOS_ASSERT_TEXT(sBRetCode >= 0, "CliEtkTimeIn():  EtkTimeIn() returned error"); 
```

这个宏的作用是，如果返回码小于 0（断言失败），将使用提供的文本生成一个日志。日志包括生成日志的条件以及文件名和行号。

该函数`PifLogAbort()`生成具有指定长度的日志并将输出文件视为循环缓冲区。日志也有时间和日期戳。

在我们希望在运行时动态生成描述性文本的情况下，也许是为了提供实际的错误代码值，我们使用带有缓冲区的 sprintf() 函数，如下代码序列：

```
if (sErrorSave != STUB_BM_DOWN) {
    char xBuff[128];
    sprintf(xBuff, "CstSendBMasterFH: CstComReadStatus() - 0x%x, sError = %d", usCstComReadStatus, CliMsg.sError);
    NHPOS_ASSERT_TEXT((sErrorSave == STUB_BM_DOWN), xBuff);
} 
```

如果我们不想生成日志，我们需要做的就是转到定义宏的单个头文件并将其定义为空，然后重新编译。然而，我们发现这些日志在调查现场问题时非常有价值，并且在集成测试期间特别有用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-12-09T14:13:40.287

[Windows 事件](http://msdn.microsoft.com/en-us/library/windows/desktop/aa964766.aspx)是`TRACE`宏的潜在替代品，具体取决于您的特定方案。代码被编译到调试和发布配置中。然后可以动态启用和禁用事件跟踪、实时显示或转储到客户端机器上以供以后诊断。跟踪也可以与从操作系统的其他部分收集的跟踪信息相关联。

如果您只需要在代码到达某些检查点时转储信息，以及变量内容、堆栈跟踪或调用方名称，Visual Studio 的[Tracepoints](http://blogs.msdn.com/b/visualstudioalm/archive/2013/10/10/tracepoints.aspx)是一个非侵入式选项。

# django - 在 URL 中“嵌入”页码的最佳方式是什么？

> ID：451759
> 
> 赞同：5
> 
> 时间：2009-01-16T20:02:53.303
> 
> 标签：django, url, web-applications

我正在使用 Django 开发一个博客应用程序。目前，该 URL`/blog/`显示博客的首页（前五篇文章）。然后访问者可以浏览或“翻阅”博客条目。这部分映射到`/blog/browse/{page}/`，`page`当然，其中 是一个整数，用于指定应该显示博客条目的哪个“页面”。

不过，我突然想到，也许“页码”应该是查询字符串的一个属性（例如，`/blog/browse/?page=2`），因为浏览页面的内容不是静态的（即，只要我添加另一个帖子，`/blog/browse/2/`就会有与添加帖子*之前*的内容不同）。这似乎是 Stack Overflow 和 Reddit 等网站做事的方式。例如，当对 Stack Overflow 上的问题进行分页时，会使用[“page”属性](https://stackoverflow.com/questions?page=2&sort=newest)；同样，Reddit 使用[“计数”属性](http://www.reddit.com/?count=25&after=t3_7q8et)。

扩展这种想法，我意识到我使用相同的模板来呈现 和 的内容`/blog/`，因此使用 URL来翻阅博客的内容`/blog/browse/`甚至可能是有意义的。`/blog/?page=2`

有什么建议么？是否有这样做的“标准”方法，或者至少有一种“最佳实践”方法可以使用？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-17T21:04:23.083

为了我的钱，解决这个问题的最佳通用方法是使用[django-pagination](http://code.google.com/p/django-pagination/)实用程序。它非常易于使用，并且您的 URL 应该具有您想要的格式。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-17T21:16:07.570

我更喜欢使用 GET URL 参数，如 URL?pg=#。这很常见，并为用户提供了关于正在发生的事情的标准视觉线索。例如，如果我想为其中一个页面添加书签或创建外部链接，我不假思索地知道我可以删除 pg 参数以指向“最新”首页索引。使用嵌入的#，这不那么明显......我要不要省略参数？我总是必须将其设置为 1 吗？它是完全不同的基本 URL 吗？对我来说，通过 GET 参数进行分页会使 URL 更合理一些，因为如果省略该参数并且该参数不影响基本 URL，则存在可接受的默认值。

此外，虽然我无法证明这一点，但它给了我一种温暖的模糊感觉，即 Google 有更好的机会弄清楚该页面内容的性质（即它是进一步数据的分页索引，并且可能会经常更新）与嵌入在 URL 中的页面 # 相比，这将更加不透明。

也就是说，我会说这是 99% 的个人偏好，我高度怀疑是否存在任何真正的功能差异，因此请选择更容易并更适合您当前做事方式的方式。

编辑：忘了提到我的意见是 Django 特定的......我有一些 Django 应用程序，所以我比较熟悉它们构建 URL 的方式，我仍然对这些应用程序使用“pg”GET 参数而不是嵌入直接在 URL 中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-16T20:07:08.847

似乎有两件事正在发生。一个不会改变的静态页面，可以用于永久链接，比如一篇文章，以及一个会经常更新的动态页面。没有理由不能同时使用两者。URL 重写应该可以很好地工作。没有理由让实现控制界面，总有至少一种方法可以给每只猫换皮。

# .net - 是否有任何 .NET 工具可用于 mux / demux MP4 流？

> ID：451769
> 
> 赞同：2
> 
> 时间：2009-01-16T20:05:47.867
> 
> 标签：.net, mp4

是否有任何特定于 .NET 的工具可以解析/访问 MP4 文件中的基本数据流？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-19T02:17:06.800

如果你有一个可以播放 MP4 流的编解码器，那么你可以使用非托管 DirectShow api，你应该能够通过那里获取信息。

DirectShow 有一个托管包装器项目，您可以在此处找到：

[http://directshownet.sourceforge.net/](http://directshownet.sourceforge.net/)[链接文本](http://directshownet.sourceforge.net/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-16T22:21:28.577

这可能不是您的意思，但是： MeGUI（用 C# 编写的 GPL 视频编码/复用应用程序）包括[mp4box](http://megui.svn.sourceforge.net/viewvc/megui/megui/trunk/packages/mux/mp4/MP4BoxMuxer.cs?view=markup)（命令行 MP4 复用器/解复用器）的前端。

# installation - 确定是否安装了flash OCX？

> ID：451770
> 
> 赞同：2
> 
> 时间：2009-01-16T20:06:01.627
> 
> 标签：installation, windows-installer, inno-setup

确定 Flash ocx 是否安装在 Innosetup（或任何安装程序）中的最佳方法是什么。我不想尝试自己安装它，我只会强迫用户去flash站点安装，我只想确保安装了flash.ocx（版本9+）。

检查 HKEY_CLASSES_ROOT\ShockwaveFlash.ShockwaveFlash 并检查 CurVer >= 9 是否足够？有没有更好的方法来测试这个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-17T11:45:59.310

在代码部分添加一个函数来检查是否可以创建 Flash 控件的实例，如下所示：

```
function IsFlashInstalled(): boolean;
var
  V: Variant;
begin
  try
    V := CreateOleObject('ShockwaveFlash.ShockwaveFlash.9');
    Result := True;
  except
    Result := False;
  end;
end; 
```

查看 Inno Setup 包中的各种示例，了解如何使用您自己的功能向用户显示消息框、取消安装、在默认浏览器中打开 Flash 站点或任何您想做的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-06-12T19:56:25.653

无需尝试/例外的简单方法

```
function IsFlashInstalled: Boolean;
var ClassID : TCLSID;
begin
  Result := Succeeded(CLSIDFromProgID('ShockwaveFlash.ShockwaveFlash', ClassID));//Use CreateComObject() instead...
end; 
```

# project-management - 有没有过程气味之类的东西？

> ID：451772
> 
> 赞同：14
> 
> 时间：2009-01-16T20:06:17.257
> 
> 标签：project-management

我们通常熟悉这里的[代码气味](https://stackoverflow.com/questions/114342/what-are-code-smells-what-is-the-best-way-to-correct-them)，但是当事物的业务方面（尽管它属于我们的领域）出错时，同样具有破坏性，如果不是更多的话。

例如，Joel 测试中任何事物的反面都将被视为主要的过程气味（即没有源代码控制，没有测试人员），但这些都是显而易见的，“气味”的重点是它们很微妙，并且具有破坏性. 我在这里寻找粒度。

首先是一对（随着答案的出现，可以变成一个列表）

* * *

*   在与客户签订合同之前编写代码

*   被要求对任何需要超过一天（几个小时？*）*

*   古老的货物崇拜智慧盛行（个人示例 - VisStudio sourcesafe 集成被禁止）

*   您已经停止举行非项目特定的小组会议（或缺少任何类似的讨论论坛）

* * *

**那么其他一些工艺气味是什么，它们有多严重？**

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-01-16T20:32:46.893

William J. Brown 等人的“[反模式”一书。](https://rads.stackoverflow.com/amzn/click/com/0471197130)人。有一堆与项目相关的气味。它们并不总是正在发生的灾难。几乎所有气味都存在缓解情况。

Portland Pattern Repository 也有一个关于 Antipatterns 的页面，涵盖了许多与“Antipatterns”一书相同的主题。访问[http://c2.com/cgi/wiki?AntiPatternsCatalog](http://c2.com/cgi/wiki?AntiPatternsCatalog)并向下滚动到“管理反模式”。几个例子：

*   [分析瘫痪](http://c2.com/cgi/wiki?AnalysisParalysis)——一个聪明而善意的分析师团队进入一个分析阶段，该阶段只有在项目被取消时才会结束。
*   [立即给我估算](http://c2.com/cgi/wiki?GiveMeEstimatesNow)- 客户（或 PointyHairedBoss）在您有足够的数据来交付它之前要求估算。你接受“挑战”并给出头脑估计（即猜测）。然后，客户/老板将估算视为铁定的承诺。
*   [地猪日项目](http://c2.com/cgi/wiki?GroundHogDayProject)- 举行会议，似乎一遍又一遍地讨论相同的事情。在上述会议结束时，做出“必须做点什么”的决定。
*   [委员会设计](http://c2.com/cgi/wiki?DesignByCommittee)- 鉴于没有人有足够的影响力来展示系统设计并获得批准的政治环境，您如何完成设计？成立一个大委员会来解决这个问题。让他们在自己之间进行战斗，最后拿走最后的结果。

把它们都收集起来！:-)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-16T21:09:27.957

*   回溯约会 - 给出结束日期，然后告知需要完成的工作
*   反向 QA Coverage - QA 专注于非必要项目（因为他们只知道如何测试）
*   环境一致性问题 - 各种环境（开发、测试、暂存、生产）的代码和数据不同步 - 因此生产之前的任何测试都是无效的
*   交付日期分离 - 没有人相信结束日期，因为：它是从一开始就完成的，并且 100% 之前的项目从未达到其交付日期
*   Old Grumpy Code - 害怕旧代码是因为不想重构
*   邪恶的 pm 三角形（范围、成本、资源和/或质量） - 调整项目，您需要增加人员、降低质量、缩小范围等......一旦项目启动，大多数变化（甚至减少范围）将**增加**时间和成本并降低质量..一旦火车轨道下降，左转就很难了

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-16T20:50:21.630

一种气味我有一个真正的问题（因为我使用它）：不放弃工具、开发软件、方法论或任何其他不起作用的东西。

很多时候，有一个（或不止一个）软件显然无法正常工作并且可能会干扰开发过程，但项目经理只是拒绝更换/升级“因为它会花费太多{时间，金钱，任何东西}都可以替换。”

编辑：这也延伸到机器和其他基础设施（例如：一个构建服务器需要一个小时来完成一个两分钟的构建，或者一个版本控制系统 -*嗯*CVS - 需要 15 分钟来找出是否有任何在 50MB 源代码树上更新）。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-16T20:15:44.837

*   运送原型——“*我们稍后会产品化*”

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-16T20:35:48.213

我建议查看关于[Anti-Patterns的维基百科页面的](http://en.wikipedia.org/wiki/Anti-pattern)[组织](http://en.wikipedia.org/wiki/Anti-pattern#Organizational_anti-patterns)部分。我不得不处理的是“危机模式”和你提到的“即时估计”。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-16T20:14:04.637

当项目在 6 个月前结束时，您还没有进行后期项目审查。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-16T20:20:43.423

我见过的一些气味：

*   乐观的管理，但他们无法支付你这个月的薪水。这真的很糟糕。我及时离开了公司，但几个月后它就死了。
*   极端狂热的团队建设会议。专注于公司的伟大。但最终一切都失败了。
*   优秀的新人被解雇是因为他们试图改变流程。真丢人。我见过一些人真的试图改善公司，但旧习惯永远不会消失，所以它常常以大失望告终。
*   老板的心态永远是对的...

还有更多，但我不会破坏其他人的乐趣。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-16T21:32:43.107

在不考虑时间或当前可交付成果的情况下对流程进行更改，然后在可交付成果由于建立新流程而迟到时立即撤消。

有人请病假，结果团队落后于试图接手该人的工作以及他们自己的工作，当经理或客户或客户销售代表被告知事情将因此延迟时，他们只担心当事情发生时，你能不能同时在晚上和周末工作，甚至永远不要询问有紧急情况的人以及他或她的情况。

当预计低级别人员加班，但需要加班的人紧急准时离开并且无法回答问题时。或者当他们让你加班到早上 8 点之前准备好，然后再过三天不要在 QA 上查看它。您好，到那时我本可以在正常时间完成。

在截止日期前几分钟交付所需文件（例如用于数据导入）或信息，然后在未达到截止日期时责备开发人员。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-16T21:17:50.313

我所说的：NIH（过程版），又名选择你自己的冒险。

这方面的证据：

*   您花费无休止的会议调试流程。并重构它。
*   什么都没有做，因为没有人知道他们应该做什么。

我想这是一种反模式，而不是一种气味。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-09-28T10:21:14.263

有趣的问题，甚至更有趣的答案。谢谢那些。

我几乎担任过软件开发的所有角色（开发人员、QA、技术主管、项目经理——甚至是客户），我可以安全地列出以下气味

*   团队对新输入的反应速度有多快（以及他们对变化的接受程度）
*   做事要经过多少层（官僚主义）
*   功能/任务有多清晰 - 目标是否 SMART，我们是否有任何 KPI。
*   从事该项目的团队对此有多认真
*   团队是否定期开会（每天阅读）讨论成就、目标和问题。

然而，最重要也是最明显的（对鼻子来说）是正在使用的项目管理工具的卫生级别（Excel 表、纸、敏捷工具、电子邮件，无论您使用哪种方法）。这是我在评估项目时首先注意到的。

*   我知道该项目目前的位置吗？
*   我可以告诉（不问团队）接下来需要做什么吗？
*   我可以告诉团队现在正在做什么吗？
*   我可以知道下一个版本何时发布以及是否可以实现？
*   我可以判断客户端是否定期更新？
*   我可以知道客户是否正在给予批准，他的反馈是否得到及时处理？
*   我可以通过查看工程师对项目的负载分布来判断吗？

显然，如果您选择任何现代敏捷方法，所有这些都很好，但是根据市场和工作类型，里程可能会有所不同。所以保持我自己的方法不可知论，这是应该摆脱的最低限度的气味。

# iphone - 使 iPhone 应用程序多语言的最佳方法

> ID：451776
> 
> 赞同：9
> 
> 时间：2009-01-16T20:07:07.553
> 
> 标签：iphone, xcode, multilingual

谁能告诉我让 iPhone 应用程序支持多种语言的最佳方法？我将在 App Store 中为每种语言放置单独的版本，但是在 Xcode 中表示它的最佳方式是什么？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-01-16T21:12:05.533

为每种语言在商店中放置一个单独的应用程序不是可行的方法。iPhone SDK 可以优雅地处理多种语言，您只需拥有一个包含所有各种翻译的应用程序。iPhone 的区域设置将指导您的应用程序使用哪种语言。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-16T21:04:15.363

一个很好的起点就[在这里](http://developer.apple.com/iphone/library/documentation/MacOSX/Conceptual/BPInternational/BPInternational.html)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-16T20:57:30.837

我还没有完成 iPhone 开发，但是“普通”的 Cocoa 应用程序使用不同语言的“.lproj”字符串文件。请参阅有关这些的文档，这应该会有所帮助。祝你好运。

# c# - 如何告诉 lambda 函数捕获副本而不是 C# 中的引用？

> ID：451779
> 
> 赞同：40
> 
> 时间：2009-01-16T20:08:09.890
> 
> 标签：c#, loops, lambda, capture

我一直在学习 C#，我正在尝试理解 lambdas。在下面的这个示例中，它打印了 10 十次。

```
class Program
{
    delegate void Action();
    static void Main(string[] args)
    {
        List<Action> actions = new List<Action>();

        for (int i = 0; i < 10; ++i )
            actions.Add(()=>Console.WriteLine(i));

        foreach (Action a in actions)
            a();
    }
} 
```

显然，在 lambda 后面生成的类存储了一个引用或指向`int i`变量的指针，并且每次循环迭代时都会为同一个引用分配一个新值。有没有办法强制 lamda 获取副本，例如 C++0x 语法

```
[&](){ ... } // Capture by reference 
```

对比

```
[=](){ ... } // Capture copies 
```

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-01-16T20:24:22.667

编译器正在做的是将您的 lambda 和 lambda 捕获的任何变量拉入编译器生成的嵌套类。

编译后，您的示例看起来很像这样：

```
class Program
{
        delegate void Action();
        static void Main(string[] args)
        {
                List<Action> actions = new List<Action>();

                DisplayClass1 displayClass1 = new DisplayClass1();
                for (displayClass1.i = 0; displayClass1.i < 10; ++displayClass1.i )
                        actions.Add(new Action(displayClass1.Lambda));

                foreach (Action a in actions)
                        a();
        }

        class DisplayClass1
        {
                int i;
                void Lambda()
                {
                        Console.WriteLine(i);
                }
        }
} 
```

通过在 for 循环中创建副本，编译器在每次迭代中生成新对象，如下所示：

```
for (int i = 0; i < 10; ++i)
{
    DisplayClass1 displayClass1 = new DisplayClass1();
    displayClass1.i = i;
    actions.Add(new Action(displayClass1.Lambda));
} 
```

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2009-01-16T20:08:57.050

我能找到的唯一解决方案是先制作本地副本：

```
for (int i = 0; i < 10; ++i)
{
    int copy = i;
    actions.Add(() => Console.WriteLine(copy));
} 
```

但我无法理解为什么将副本放入 for 循环与使用 lambda capture 有何不同`i`。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-01-16T20:13:05.670

唯一的解决方案是制作本地副本并在 lambda 中引用它。在闭包中访问时，C#（和 VB.Net）中的所有变量都将具有引用语义与复制/值语义。任何一种语言都无法改变这种行为。

注意：它实际上并不作为参考编译。编译器将变量提升到闭包类中，并将对“i”的访问重定向到给定闭包类中的字段“i”。不过，通常更容易将其视为引用语义。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-16T20:20:51.847

请记住，lambda 表达式实际上只是匿名方法的语法糖。

话虽如此，您真正要寻找的是匿名方法如何在父范围内使用局部变量。

这是一个描述这个的链接。 [http://www.codeproject.com/KB/cs/InsideAnonymousMethods.aspx#4](http://www.codeproject.com/KB/cs/InsideAnonymousMethods.aspx#4)

# jquery - 如何使用 jquery 获取单击元素的 id？

> ID：451785
> 
> 赞同：3
> 
> 时间：2009-01-16T20:09:10.513
> 
> 标签：jquery

我想获取单击元素的 id，然后显示`div`与此 id 匹配的 s。我正在使用以下代码，但它不起作用。请帮忙。

```
$(function () {  

var tabContainers = $('div.difContetform > div');
    $('div#head-nav ul a').click(function (event) { 
        $('div#head-nav ul a').removeClass('current');
        $(this).addClass('current');
        var current_id = $(this).attr("id");
        var targeted='DIV'+current_id;
        $(targeted).show();
        $(targeted:not).hide(); 
        // 
        return false; 
     })
}); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-16T20:13:39.193

您想使用正确的选择器语法通过 id 来获取 div，即字符串`#id`...因此：

```
 $('#'+targeted).show();
 $('something:not(#'+targeted+')').hide(); 
```

**编辑**：再看一遍（重拍），你不能只隐藏所有不匹配的东西，因为它会隐藏你的整个页面。您需要确保只选择 DIV，而不是要显示的 DIV。它的工作方式取决于您的页面布局（因此`something`在上面的示例中）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-16T20:44:08.837

非常感谢亲爱的，现在我可以显示 div 但无法隐藏其他人。正如您所说，我在容器 id=formContainer 和其他 div（该 id div 的子项）上的所有页面都消失了，该 id 显示隐藏并显示 1 被单击。

**我正在使用以下语法**

```
$('div#difContetform > div:not(#'+targeted+')').hide();
```

但它不起作用，虽然页面没有消失但没有隐藏其他 div

# sql-server - 在不同数据库模式之间同步数据的最佳技术？

> ID：451787
> 
> 赞同：13
> 
> 时间：2009-01-16T20:10:34.113
> 
> 标签：sql-server, ssis, replication, data-transfer

我有一个运行我们的会计/库存应用程序的现有 SQL Server 2005 数据库。我们正在考虑使用一个新的在线订购框架——它有自己的数据库。

如果我们使用这个新框架，我们将需要几乎实时地在我们现有的库存数据库中传输在线订购数据（库存、价格、订单、客户）。数据传输不必是实时的，但必须是快速的。两个数据库都在 SQL Server 中。

所以我的问题是......在具有不同模式的两个数据库之间来回传输数据的最佳方式是什么？

复制？西斯？你会建议什么，为什么？

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-16T20:23:35.537

**业务规则是最难的部分**

单向同步？双向同步？实时推送？每晚更新？转储并重新加载？比较和更新？解决冲突？哪一方获胜？以一种方式推送只读信息，以另一种方式订购信息？更改/取消/等呢？订单状态会被推迟吗？

你可以看到我要去哪里。技术是次要问题。

由于业务规则问题，并且由于两个系统具有不同的模式（和不同的目的），这不是标准的数据移动，并且大多数“标准”答案（复制、日志传送等）都不在表中.

有一些框架可以帮助解决这个问题，例如[Microsoft BizTalk](http://www.microsoft.com/biztalk/en/us/default.aspx)或[Scribe Insight](http://www.scribesoftware.com/scribe-insight.asp)。但是，这些既麻烦又昂贵。

使用 C# 或您喜欢的语言创建基于 SQL 触发器或计划推送（取决于您的需要）的自定义队列系统并不难。这大概就是我要走的路线。它可能涉及*第三个*“传输”数据库来保存一方所做的更改队列，以及一个应用业务规则并将数据推送到另一方的模块。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-16T20:24:21.747

就我个人而言，我会尽可能快地逃离这个噩梦。由于您尚未购买此在线订购，我建议保持数据与现有应用程序同步是不这样做的正当理由。如果您购买此产品，您将永远后悔您的数据将变得多么混乱，以及您花费了多少时间和金钱来试图让事情正常运行。这是一场等待发生的灾难。当仓库里没有货时，您最终会让人们订购本应在库存中的物品。不要这样做。这是愤怒的客户和愤怒的经理的保证。随着时间的推移，聘请一些开发人员将您自己的在线订单放在一起访问您的数据库的成本要低得多。如果他们继续反对你的反对，我会更新我的简历。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-16T20:17:05.160

根据个人经验，如果没有其他选择，我只会使用复制。对于任何架构更改，您都必须将其拆除，并且它有爆炸的趋势。

为此，我很可能会使用 SSIS。构建转换包相当容易，维护也相当简单。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-16T20:16:57.300

复制效果很好，如果它是两种方式，它可能是你唯一可行的选择，因为冲突解决是内置的。

如果您要单向，SSIS 或表上的触发器会很好，并且会实时推送数据（对于触发器）或以您想要的任何时间间隔（SSIS）推送数据。SSIS 的优势在于它是一个后台进程，而触发器在推送数据时可能会阻止供应方的交易。

如果您希望移动大量数据，还有其他产品可以为您完成，但如果数据量不大，使用 SQL Servers 工具的解决方案应该可以满足您的所有需求。

# javascript - jQuery 事件链

> ID：451795
> 
> 赞同：6
> 
> 时间：2009-01-16T20:12:07.200
> 
> 标签：javascript, jquery

基于这个[问题](https://stackoverflow.com/questions/451491/what-is-the-best-way-to-emulate-an-html-input-maxlength-attribute-on-an-html-text)

我不想在等待“点击事件”、“更改事件”和“鼠标悬停事件”时乱扔准备好的东西，我希望将所有这些东西放在一个函数或事件中。

可以将事件链接在一起。我不仅要捕获键盘，还要捕获单击或更改以防用户不在键盘上。

```
<script language="javascript" type="text/javascript">
$(document).ready( function () {
    setMaxLength();
    $("textarea.checkMax").keyup(function(){ checkMaxLength(this.id); } );
    $("textarea.checkMax").mouseover(function(){ checkMaxLength(this.id); } );
});
</script> 
```

这有效

```
$(document).ready( function () {
    setMaxLength(); 
    $("textarea.checkMax").bind("click mouseover keyup change", function(){checkMaxLength(this.id); } )
}); 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-01-16T20:44:07.760

我想你正在寻找绑定。Bind 可以使用单个调用而不是使用链将多个事件连接到同一个函数：

```
$("textarea.checkMax").bind("keyup mouseover", checkMaxLength); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-16T20:14:20.270

任何返回 jQuery 对象的东西都可以用来链接。一般来说，一切都返回 jQuery 对象，所以如果 API 没有明确说明它没有，那么特定方法很可能确实返回 jQuery 对象并且可以被链接。

在事件的情况下，是的，它们确实返回 jQuery 对象，因此可以被链接。[看这里](http://docs.jquery.com/Events)

在您的情况下，您可以创建一个带有一个参数的外部函数，即事件发生的对象，然后检查它的长度，或者您想做的任何其他事情。然后，您只需调用`mouseUp(myFunction).mouseOut(myFunction).keyPress(myFunction)`或其他任何您想要链接在一起的东西。

这是一个更明确的例子：

```
<script language="javascript" type="text/javascript">
$(document).ready( function () {
    setMaxLength();
    $("textarea.checkMax").keyup(checkMaxLength()).
        mouseover(checkMaxLength(this.id));
});
</script> 
```

# visual-studio - 如何配置 Visual Studio 在每次运行时不提示 UAC？

> ID：451809
> 
> 赞同：11
> 
> 时间：2009-01-16T20:14:36.710
> 
> 标签：visual-studio, windows-vista, uac

我最近切换到了 Vista，我想保持 UAC 开启，因为我同意它可以大大提高计算机的安全性。我经常使用的一些开发人员工具需要运行提升：

*   适用于 Windows 的 PIX
*   Visual Studio 2005（调试和 IncrediBuild 工作似乎需要提升权限）
*   映射和替代驱动器：提升的进程似乎看不到我在我的用户帐户中映射的驱动器。[本文](http://blogs.msdn.com/cjacks/archive/2007/02/19/mapped-network-drives-with-uac-on-windows-vista.aspx)描述了该问题，但我不确定如何实施其最终建议以*“在提升登录的上下文中映射这些驱动器”*。

我尝试了很多我发现的建议，[兼容性管理员](http://dailyapps.net/2008/01/hack-attack-disable-uac-for-certain-applications-in-vista/)似乎很有希望，但结果仍然不是我想要的。当我使用RunAsInvoker 时，没有UAC 提示，但是Visual Studio 没有工作。当我使用 RunAsAdmin 或 RunAsHighest 时，它起作用了，但是有提示。

有什么方法可以教 UAC 记住某些特定的应用程序应该始终运行提升并且从不提示我这个，或者其他方式如何允许我在没有提示的情况下启动 VS 提升？如果没有办法做到这一点，是否存在无法做到的一些安全原因？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2011-06-01T20:39:13.110

尝试：

管理工具 -> 本地安全策略 -> 本地策略 -> 安全选项 -> 用户帐户控制：管理员批准模式下管理员的提升提示行为 = 不提示提升。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-16T21:57:07.190

VS 2005 在 Vista 中是个痛点，即使以管理员身份运行也有很多小问题。看看你是否可以升级到 2008，它在 Vista 上运行得更好。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-16T22:25:10.503

我也不得不为我的 2008 开发系统关闭 UAC，尽管我也希望能够使用它。需要跟踪每个应用程序的运行上下文以使诸如窗口之间的拖放工作、与远程系统交互、调试场景或任何数量的其他任务之类的事情都太痛苦了。从理论上讲，UAC 是一个好主意，但似乎并没有付出多少努力来使其在功能上对现实世界的高级用户有用，以至于最终，唯一可行的解​​决方案是完全禁用它。

据称，Windows 7 在消除持续提示方面会更好一些，但除非它们真的能够解决所有跨应用程序和远程访问问题，否则对于新手用户以外的任何人来说，它仍然是一个非入门者。这是希望他们最终让它真正可用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-16T21:47:04.357

不幸的是，在 Windows Vista 中，当 UAC 启用时，UAC 提示是强制性的。

一个对我有用的解决方案是拥有一个提升的命令行和一堆从那里提升以执行某些任务的非 ui shell 脚本。

另外为了调试，我设置了另一台可以运行远程调试会话的计算机，使用 VS 2005 进行配置有点棘手，另外，如果您崩溃/挂起远程会话，它不会使您的主计算机崩溃:)

PD：VS 2008 在 vi​​sta 上比 VS 2005 稍微好一点，如果可以的话，试试看。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-16T20:35:22.503

据我所知，你无法得到你想要的一切（UAC 开启，VS 在没有提示的情况下工作）。

但是，有一个比“让其他人用 LUA 测试它”更好的解决方法：虚拟 PC。使用 Virtual PC（Microsoft 免费提供）创建来宾操作系统。安装 Vista 并设置一个普通用户以及您的默认管理员。使用普通（非提升）用户在该 VPC 上测试您的应用程序。这至少为您提供了 LUA 问题的早期迹象，而没有太多的大麻烦。

我同意这有点痛苦（而且我注意到 VS2008 在 Vista 或 Win7 beta 下不会因 UAC 提示而困扰我），但事实就是如此。VS2005，特别是在调试方面，需要提升以附加到进程等。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-16T20:24:14.960

作为记录，经过几天的试验，我目前对这个问题的“解决方案”是：

*   关闭 UAC
*   确保其他人定期使用标准用户帐户测试应用程序

... 即使用以前在 WindowsXP 中工作的相同模式。

我想看看其他解决方案，但到目前为止，我没有尝试过任何我想要的东西，即。UAC 开启，Visual Studio 工作，并且没有提示运行 VS。我想保持 UAC 开启，但每次运行工具时都无法确认海拔高度，这对我来说太烦人了。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-16T22:52:34.363

诺顿有一个有趣的工具来调整 UAC 并使其更容易使用......以关于你运行的程序的反馈为代价的诺顿。这里有一篇很好的文章：

[http://www.betanews.com/article/New_Norton_Vista_tool_trades_UAC_for_online_feedback/1223668881](http://www.betanews.com/article/New_Norton_Vista_tool_trades_UAC_for_online_feedback/1223668881)

下载地址在这里：

[http://www.nortonlabs.com/inthelab/uac.php](http://www.nortonlabs.com/inthelab/uac.php)

最后，还有一个有趣的小工具可以“打盹”UAC，它的价格为 5 美元（30 天试用）。我不能保证这两种工具，因为我没有亲自尝试过。

[http://www.uacsnooze.com/](http://www.uacsnooze.com/)

# sql - 更新不包括 NULL 的数据库表

> ID：451829
> 
> 赞同：0
> 
> 时间：2009-01-16T20:19:27.717
> 
> 标签：sql, sql-server-2005, sql-update

我有两个具有相同列的表

```
tbl_source (ID, Title)

tbl_dest (ID, Title) 
```

我想从 tbl_source 更新 tbl_dest 标题，其中 dest 和 source 中的 id 匹配。但是，如果源标题为空（或空白），我不想更新目标标题。

我有这个：

```
UPDATE    tbl_dest
SET              tbl_dest.Title =
      (SELECT     title
        FROM          tbl_source
        WHERE      tbl_dest.id = tbl_source.ID and tbl_source.title is not null) 
```

但它不断插入空值。

我将如何构建这样的查询？

我正在使用 SQL Server 2005。

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-16T20:24:28.237

使用内连接...

```
Update tbl_dest
Set tbl_dest.Title = tbl_source.Title
From tbl_dest inner join tbl_source on tbl_dest.ID = tbl_source.ID
Where tbl_source.Title is not null and tbl_source.Title <> '' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-16T20:26:28.030

它将值设置为 null 因为子查询返回 null，并且您没有在更新子句中过滤记录。

尝试这样的事情：

```
UPDATE tbl_dest
SET tbl_dest.Title = 
    (SELECT title
    FROM tbl_source
    WHERE tbl_source.id = tbl_dest.id)
WHERE EXISTS
    (SELECT 1
    FROM tbl_source
    WHERE tbl_source.id = tbl_dest.id
    AND tbl_source.title IS NOT NULL) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-16T20:26:48.793

那是因为外部查询正在更新每条记录（没有 WHERE 子句），所以当内部查询没有找到匹配的记录时，就会插入 NULL。

将 WHERE 子句添加到外部查询以不对这些记录进行更新：

```
UPDATE    tbl_dest
SET              tbl_dest.Title =
      (SELECT     title
        FROM          tbl_source
        WHERE      tbl_dest.id = tbl_source.ID and tbl_source.title is not null)
WHERE EXISTS
      (SELECT     title
        FROM          tbl_source
        WHERE      tbl_dest.id = tbl_source.ID and tbl_source.title is not null) 
```

# string - 如何在powershell中有效地转换一系列字符串？

> ID：451830
> 
> 赞同：2
> 
> 时间：2009-01-16T20:19:34.923
> 
> 标签：string, powershell, map, transform

假设我有大量的字符串格式如下：

```
<tag>blah blahXXXXXblah blah</tag> 
```

我想将这些字符串转换成类似的东西：

```
blah blahZZZZZblah blah 
```

在 powershell 命令行上。XXXXX 的所有实例在转换中都被 ZZZZZ 替换，并且外部标签被去除。它不是格式良好的 XML。

我相信我可以编写一个脚本来轻松评估这个问题，但是在处理这个特定的软件时，我发现自己执行此类任务的频率比我想要的要高。我有兴趣学习如何直接从 powershell 命令行执行此操作，而无需编写要运行的 .ps1 脚本的额外步骤。

似乎powershell擅长的东西，我只是不知道如何。:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-16T20:27:41.100

嗯，我能想到的最简单的方法（假设你的列表保存在 $foo 中）：

```
$foo | %{$_.Replace("XXXXX", "ZZZZZ")} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-16T20:24:55.940

如果您可以编写脚本，只需创建一个 cmdlet

[有关 Cmdlet 创建的 MSDN 文档](http://msdn.microsoft.com/en-us/magazine/cc163293.aspx)

# asp.net-mvc - ASP.NET MVC 中的模糊控制器名称

> ID：451831
> 
> 赞同：4
> 
> 时间：2009-01-16T20:20:00.210
> 
> 标签：asp.net-mvc

我尝试在我的项目中实现 Phil's Areas Demo

[http://haacked.com/archive/2008/11/04/areas-in-aspnetmvc.aspx](http://haacked.com/archive/2008/11/04/areas-in-aspnetmvc.aspx)。

我在现有的 MVC 项目中附加了区域/博客结构，但在我的项目中出现以下错误。

控制器名称`Home`在以下类型之间不明确：

```
WebMVC.Controllers.HomeController
WebMVC.Areas.Blogs.Controllers.HomeController 
```

这就是我的`Global.asax`样子。

```
public static void RegisterRoutes(RouteCollection routes)
{
    routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

    routes.MapAreas("{controller}/{action}/{id}",
        "WebMVC.Areas.Blogs",
        new[] { "Blogs", "Forums" });

    routes.MapRootArea("{controller}/{action}/{id}",
        "WebMVC",
        new { controller = "Home", action = "Index", id = "" });

    //routes.MapRoute(
    //    "Default",   // Route name
    //    "{controller}/{action}/{id}",// URL with parameters
    //    new { controller = "Home", action = "Index", id = "" }  
    //            // Parameter defaults
    //);

}

protected void Application_Start()
{
    String assemblyName = Assembly.GetExecutingAssembly().CodeBase;
    String path = new Uri(assemblyName).LocalPath;
    Directory.SetCurrentDirectory(Path.GetDirectoryName(path));
    ViewEngines.Engines.Clear();
    ViewEngines.Engines.Add(new AreaViewEngine());
              RegisterRoutes(RouteTable.Routes);
   // RouteDebug.RouteDebugger.RewriteRoutesForTesting(RouteTable.Routes);

} 
```

如果我删除`/Areas/Blogs`from `routes.MapAreas`，它会查看根的索引。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-02-08T18:33:02.437

在 ASP.NET MVC 2.0 中，您可以在父区域中注册路由时包含父项目控制器的命名空间。

```
routes.MapRoute(
    "Default",                                             
    "{controller}/{action}/{id}",                          
    new { controller = "Home", action = "Index", id = "" },
    new string[] { "MyProjectName.Controllers" }
); 
```

这将路由限制为仅在您指定的命名空间中搜索控制器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-16T22:03:51.077

使用 WebMVC.Areas.Blogs 和 WebMVC.Areas.OtherAreaName 代替 WebMVC.Areas.Blogs 和 WebMVC。将区域名称视为命名空间根，而不是绝对命名空间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-03-17T13:48:46.490

您可以在路由中具有相同名称的多个控制器之间进行优先级排序，如下所示

例如，我有一个名为 HomeController 的控制器`Areas/Admin/HomeController` ，另一个在 root中`/controller/HomeController`
，所以我优先考虑我的 root 控制器，如下所示：

```
routes.MapRoute(
    "Default", // Route name
    "{controller}/{action}/{id}", // URL with parameters
    new { controller = "Home", action = "Index", // Parameter defaults
    id = UrlParameter.Optional },
    new [] { "MyAppName.Controllers" } // Prioritized namespace which tells the current asp.net mvc pipeline to route for root controller not in areas.
); 
```

# sql - T-SQL While 循环和连接

> ID：451834
> 
> 赞同：5
> 
> 时间：2009-01-16T20:20:51.380
> 
> 标签：sql, sql-server, while-loop, string-concatenation

我有一个 SQL 查询，它应该提取一条记录并将每个记录连接到一个字符串，然后输出该字符串。查询的重要部分如下。

```
DECLARE @counter int;
SET @counter = 1;

DECLARE @tempID varchar(50);
SET @tempID = '';

DECLARE @tempCat varchar(255);
SET @tempCat = '';

DECLARE @tempCatString varchar(5000);
SET @tempCatString = '';

WHILE @counter <= @tempCount
BEGIN

    SET @tempID = (
    SELECT [Val]
    FROM #vals
    WHERE [ID] = @counter);

    SET @tempCat = (SELECT [Description] FROM [Categories] WHERE [ID] = @tempID);
    print @tempCat;

    SET @tempCatString = @tempCatString + '<br/>' + @tempCat;
    SET @counter = @counter + 1;

END 
```

脚本运行时，`@tempCatString`输出为 null，但`@tempCat`始终正确输出。是否有某些原因导致连接在 While 循环中不起作用？这似乎是错误的，因为递增`@counter`效果很好。那么我还缺少什么吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-16T20:28:08.493

看起来它应该可以工作，但出于某种原因，它似乎认为 @tempCatString 为空，这就是为什么你总是得到一个空值，因为空连接到其他任何东西仍然是空的。建议您尝试使用`COALESCE()`每个变量将它们设置为“”，如果它们为空。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-16T20:26:51.443

这样会更有效率....

```
select @tempCatString = @tempCatString + Coalesce(Description,'') + '<br/>' from Categories...

select @fn 
```

还可以将 concat_null_yields_null 作为解决串联问题的选项，尽管我会避免使用该路线

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-18T00:45:04.013

我同意 keithwarren 的观点，但我总是会确保在查询中添加 ORDER BY 子句。然后，您可以确定连接值的确切顺序。

此外，用 '' 替换 NULL 值的 COALESCE 将有效地产生空白行。我不知道您是否想要它们，但如果不只是在 WHERE 子句中过滤...

最后，您似乎有一个临时表，其中包含您感兴趣的 ID。该表可以仅包含在 JOIN 中以过滤源表...

```
DELCARE @output VARCHAR(8000)
SET @output = ''

SELECT
    @output = @output + [Categories].Description + '<br/>'
FROM
    Categories
INNER JOIN
    #vals
        ON #vals.val = [Categories].ID
WHERE
   [Categories].Description IS NOT NULL
ORDER BY
   [Categories].Description 
```

# php - 如何提高 MySQL 数据库的性能

> ID：451839
> 
> 赞同：3
> 
> 时间：2009-01-16T20:22:22.123
> 
> 标签：php, mysql, database, performance, caching

如何提高 mysql 数据库的性能，因为我的网站托管在共享服务器中，并且由于“查询太多”，他们暂停了我的帐户，询问“索引”或“缓存”或修剪我的数据库我不知道是什么“索引”和缓存是否意味着以及如何在 php 上执行谢谢

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-17T15:46:34.443

**什么是索引：**

将数据库表视为图书馆 - 您拥有大量书籍（记录），每本书都有相关数据（作者姓名、出版商、出版日期、ISBN、内容）。还假设这是一个非常幼稚的图书馆，所有书籍都按 ISBN（主键）按顺序搁置。正如书籍只能有一个物理顺序一样，数据库表也只能有一个主键索引。

现在想象有人来找图书管理员（数据库程序）说：“我想知道图书馆里有多少 Nora Roberts 的书”。要回答这个问题，图书馆员必​​须走在过道上，看图书馆里的每一本书，这很慢。如果图书管理员收到很多这样的请求，那么值得花时间按作者姓名（姓名索引）建立卡片目录 - 然后他可以通过参考目录而不是走在书架上来更快地回答这些问题。从本质上讲，该索引设置了书籍的“替代排序”——它将它们视为按作者的字母顺序排序。

请注意，1) 设置目录需要时间，2) 目录占用了图书馆的额外空间，以及 3) 将书籍添加到图书馆的过程变得复杂——而不是仅仅将书贴在书架上订购时，图书管理员还必须填写索引卡并将其添加到目录中。同样，在数据库字段上添加索引可以加快查询速度，但索引本身会占用存储空间并减慢插入速度。出于这个原因，您应该只根据需要创建索引 - 索引您很少搜索的字段是没有意义的。

**什么是缓存：**

如果图书管理员有很多人进来一遍又一遍地问同样的问题，那么他可能值得花时间在前台写下答案。他不必检查堆栈或目录，而可以简单地说，“这是我给最后一个问这个问题的人的答案”。

在您的脚本中，这可能以不同的方式应用。您可以存储数据库查询或计算的结果或呈现网页的一部分；您可以将其存储到辅助数据库表或文件或会话变量或内存服务（如 memcached）。您可以存储预先解析的数据库查询，准备运行。Smarty 等一些库会自动为您存储部分或全部页面。通过存储结果并重复使用它，您可以避免多次执行相同的工作。

在任何情况下，您都必须担心答案将保持有效多长时间。如果图书馆进了一本新书怎么办？可以使用可能过时五分钟的答案吗？过期一天怎么办？

缓存是非常特定于应用程序的；你将不得不考虑你的数据意味着什么，它多久改变一次，计算成本有多高，需要多久得到一次结果。如果数据变化缓慢，最好每次发生变化时重新计算并存储结果；如果它经常更改但并不重要，则仅当缓存值超过某个年龄时才更新可能就足够了。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-16T20:55:57.923

在本地设置应用程序的副本，启用 mysql 查询日志，并设置 xdebug 或其他一些分析器。开始收集数据并测试您的应用程序。有很多关于如何优化事物的指南和书籍。重要的是您**要先**花时间进行测试并收集数据，以便优化正确的事情。

使用您收集的数据尝试减少每次页面浏览的查询次数，理想情况下，您应该能够在少于 5-10 次查询中获得所需的一切。

查看日志，看看您是否要求两次相同的事情。在代码的一部分中请求记录是一个坏主意，然后在几行之后再次从数据库中请求它，除非您确定该值可能已更改。

查找嵌入在循环中的查询，并尝试重构它们，以便您进行单个查询并简单地循环结果。

您提到使用的**select ***表明您可能做错了什么。您可能应该列出您明确需要的字段。检查这个网站或谷歌关于为什么[选择 * 是邪恶](http://parseerror.com/sql/select*isevil.html)的很多好的论据。

开始查看您的查询，然后对它们使用[说明](http://dev.mysql.com/doc/refman/5.1/en/using-explain.html)。对于经常使用的查询，请确保它们使用良好的索引而不是进行全表扫描。调整开发数据库和测试的索引。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-16T20:44:26.323

您可以查看以下几件事：

1.  查询设计 - 研究更先进和更快的解决方案
2.  硬件 - 在问题上抛出更好更快的硬件
3.  数据库设计 - 使用索引并练习良好的数据库设计

所有这些说起来容易做起来难，但这只是一个开始。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-16T21:42:30.310

对数据库表进行索引以加快查询速度。如果你不知道这意味着你什么都没有。至少，您应该在每个外键和查询的 where 子句中经常使用的大多数字段上都有索引。假设您将主键设置为开始时，主键应该自动具有索引，我认为在不知道索引是什么的人中不太可能。您的表格是否标准化？

顺便说一句，既然你在做数学除法（为什么我不知道），你应该谷歌整数数学。你可能不会得到正确的结果。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-16T21:18:22.433

首先，解雇您的主机，将共享主机转移到您可以完全控制的环境中，并有机会进行体面的调整。

在您的实验室中复制该环境，最好使用与生产相同的硬件；这包括诸如 RAID 控制器之类的东西。

我有没有提到你需要一个 RAID 控制器。是的你是。没有一个，你就无法获得不错的写入性能——它需要一个电池支持的缓存。如果您没有，则每次写入都需要物理撞击光盘，这对性能来说是毁灭性的。

无论如何，回到读取性能，一旦您的机器具有与实验室生产相同的规格 RAID 控制器（和相同的磁盘，显然），您可以尝试调整内容。

更多的内存通常是获得更好性能的最便宜的方法——确保你已经配置了 MySQL 来使用它——这意味着调整存储引擎的特定参数。

我在这里假设你至少有 100G 的数据；如果没有，只需购买足够的内存以使您的整个数据库都适合内存，那么读取性能基本上就解决了。

* * *

其他人提到的软件更改（例如优化查询和添加索引）也很有帮助，但只有在您拥有一个开发硬件环境后，您才能有效地进行性能工作 - 即有意义地测量应用程序的性能 - 这意味着真正的硬件（不是虚拟机），这与生产中使用的硬件环境是一致的。

* * *

哦，是的 - 还有一件事 - 甚至不要考虑在 32 位操作系统上部署数据库服务器，这是对良好内存的毁灭性浪费。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-16T20:40:55.300

您不应该选择 *。相反，只选择该特定呼叫所需的数据。你在这里的意图是什么？

```
order by votes*1000+((1440 - ($server_date - date))/60)2+visites600 desc 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-16T20:26:16.593

您可能有写得不好的查询，和/或运行太多查询的写得不好的页面。您能否为我们提供您正在使用的、定期运行的查询的具体示例？

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2009-01-16T20:37:09.880

确保此查询获取最后 3 个帖子

```
select * from posts where visible = 1 and date > ($server_date - 86400) and dont_show_in_frontpage = 0 order by votes*1000+((1440 - ($server_date - date))/60)*2+visites*600 desc limit 3 
```

你怎么看？

# sql - ORM 性能成本

> ID：451845
> 
> 赞同：23
> 
> 时间：2009-01-16T20:24:01.200
> 
> 标签：sql, database, performance, orm, frameworks

有没有人有任何经验表明开发人员可以通过选择使用 ORM（在 Django、RoR、SQLAlechemy 等中）而不是 SQL 和手工设计的数据库来获得什么样的性能？我想有一些复杂的问题，包括在 ORM 的约束下指定数据库是否会增加或减少创建有效数据库结构的机会（基于开发人员的经验水平），以及开发人员构建的问题基于 SQL 或 ORM 的查询（同样基于他/她的经验）。关于这些或内在性能问题的任何信息对我来说都是非常有趣的。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-01-16T20:33:28.653

我的建议是在你需要之前不要担心这个 - 不要过早优化。ORM 可以为开发速度、代码可读性提供许多好处，并且可以消除大量代码重复。如果它能让你的应用程序更容易开发，我会推荐使用它。

随着开发的进行，使用基准和分析来确定代码中的瓶颈，如果需要，您可以绕过 ORM 并在需要时使用手动查询。通常，您将能够使用缓存和数据库索引（除其他外）来提高 ORM 的速度，然后您可以决定在哪里需要手动查询。在大多数情况下，ORM 的性能可能是可以接受的，使用它的好处将远远超过性能成本。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-01-24T03:17:03.477

在大多数 DAL 层开发/架构中，性能一直是事后考虑的问题。我认为是时候开始质疑这些 ORM 工具的性能了，因为它们承诺的所谓的易于开发：

ORM 中两个最大的性能问题是：

1.  无法编写最佳 SQL。您必须使用由框架解释为 SQL 的对象查询语言。大多数情况下它是好的 SQL，但通常它不是最有效的 SQL。

2.  反射。大多数 ORM 框架使用反射来使用数据库中的数据填充对象。反射操作成本高，并且随着负载和数据数量的增加，性能下降变得明显。

出现的其他性能问题是由于实体对象与表的紧密耦合导致的数据库设计或实体模型设计效率低下。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-16T20:40:28.517

它还取决于您使用什么作为 ORM。以我的经验，Hibernate 在速度、资源使用和启动时间方面都是一头猪。另一方面，LINQ to SQL 是一个非常轻量级的 SQL 包装器，您可能几乎不会（如果有的话）注意到它的影响。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-02-26T10:51:32.787

**性能**- 它总是有利有弊。如果您深入了解 ORM**架构**（请参阅我的文章：[避免 ORM 坏习惯](https://www.linkedin.com/pulse/get-know-your-orm-avoid-bad-habits-balazs-hideghety)），那么您会直观地找到使其更快的方法。这是我的另一篇关于如何使 EF6x**更快**5 倍的文章（至少在读取情况下）：[EF6.x 5x faster](https://www.linkedin.com/pulse/orm-read-performance-ef-vs-dapper-balazs-hideghety)

**无论如何，为了获得良好的性能，即使使用 ORM，您也需要创建数据库视图、索引，以检查 ORM 生成和执行的查询并对其进行微调。急切加载是 ORM 的必备条件。**

# sql - 基于一组命名属性/值的查询

> ID：451856
> 
> 赞同：0
> 
> 时间：2009-01-16T20:26:23.957
> 
> 标签：sql, database, oracle, sql-match-all

我正在使用一组本质上是属性/值对的东西（实际上还有很多，但为了这个问题，我正在简化）。实际上，您可以这样考虑表：

实体 (EntityID,AttributeName,AttributeValue) PK=EntityID,AttributeName
Targets (TargetID,AttributeName,AttributeValue) PK=TargetID,AttributeName

您将如何使用 SQL 查询 EntityID、TargetID 的集合，其中一个实体具有目标的所有属性以及相应的值？

编辑（根据要求进行 DDL）：

```
CREATE TABLE Entities(
    EntityID INTEGER NOT NULL,
    AttributeName CHAR(50) NOT NULL,
    AttributeValue CHAR(50) NOT NULL,
    CONSTRAINT EntitiesPK PRIMARY KEY (EntityID,AttributeName)
);
CREATE TABLE Targets(
    TargetID INTEGER NOT NULL,
    AttributeName CHAR(50) NOT NULL,
    AttributeValue CHAR(50) NOT NULL,
    CONSTRAINT TargetsPK PRIMARY KEY (TargetID,AttributeName)
); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-16T20:38:39.813

我喜欢这类问题，但我认为希望 OP 至少为表提供创建脚本，甚至可能提供一些示例数据并不是不合理的。

我喜欢听谁同意谁不同意。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-16T21:11:47.953

好的，我认为经过几次尝试和编辑，这个解决方案终于奏效了：

```
SELECT e1.EntityID, t1.TargetID
FROM Entities e1
  JOIN Entities e2 ON (e1.EntityID = e2.EntityID)
  CROSS JOIN Targets t1
  LEFT OUTER JOIN Targets t2 ON (t1.TargetID = t2.TargetID
    AND e2.AttributeName = t2.AttributeName
    AND e2.AttributeValue = t2.AttributeValue)
GROUP BY e1.EntityID, t1.TargetID
HAVING COUNT(e2.AttributeValue) = COUNT(t2.AttributeValue); 
```

测试数据：

```
INSERT INTO Entities VALUES 
 -- exact same attributes, should match
 (1, 'Foo1', '123'),
 (1, 'Bar1', '123'),
 -- same attributes but different values, should not match
 (2, 'Foo2', '456'),
 (2, 'Bar2', '456'),
 -- more columns in Entities, should not match
 (3, 'Foo3', '789'),
 (3, 'Bar3', '789'),
 (3, 'Baz3', '789'),
 -- fewer columns in Entities, should match
 (4, 'Foo4', '012'),
 (4, 'Bar4', '012'),
 -- same as case 1, should match Target 1
 (5, 'Foo1', '123'),
 (5, 'Bar1', '123'),
 -- one attribute with different value, should not match
 (6, 'A', 'one'),
 (6, 'B', 'two');

INSERT INTO Targets VALUES 
 (1, 'Foo1', '123'),
 (1, 'Bar1', '123'),
 (2, 'Foo2', 'abc'),
 (2, 'Bar2', 'abc'),
 (3, 'Foo3', '789'),
 (3, 'Bar3', '789'),
 (4, 'Foo4', '012'),
 (4, 'Bar4', '012'),
 (4, 'Baz4', '012'),
 (6, 'A', 'one'),
 (6, 'B', 'twox'); 
```

测试结果：

```
+----------+----------+
| EntityID | TargetID |
+----------+----------+
|        1 |        1 | 
|        4 |        4 | 
|        5 |        1 | 
+----------+----------+ 
```

* * *

为了回复您的评论，这里是一个颠倒表格的查询：

```
SELECT e1.EntityID, t1.TargetID
FROM Targets t1
  JOIN Targets t2 ON (t1.TargetID = t2.TargetID)
  CROSS JOIN Entities e1
  LEFT OUTER JOIN Entities e2 ON (e1.EntityID = e2.EntityID
    AND t2.AttributeName = e2.AttributeName
    AND t2.AttributeValue = e2.AttributeValue)
GROUP BY e1.EntityID, t1.TargetID
HAVING COUNT(e2.AttributeValue) = COUNT(t2.AttributeValue); 
```

这是输出，给定上面相同的输入数据。

```
+----------+----------+
| EntityID | TargetID |
+----------+----------+
|        1 |        1 |
|        3 |        3 |
|        5 |        1 |
+----------+----------+ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-16T21:18:47.627

```
SELECT  *
FROM    (
    SELECT  eo.total,
        (
        SELECT  COUNT(*)
        FROM    Entities e, Targets t
        WHERE   e.EntityID = eo.EntityID
            AND t.TargetID = e.EntityID
            AND t.AttributeName = e.AttributeName
            AND t.AttributeValue = e.AttributeValue
        ) AS equal
    FROM    (
        SELECT  e.EntityID, COUNT(*) as total
        FROM    Entities e
        GROUP BY
            e.EntityID
        ) eo
    )
WHERE   total = equal 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-16T21:22:20.413

```
select distinct entityid,targetid
from   entities ent
,      targets  tar
where  not exists  
       (  select attributename, AttributeValue 
          from   targets  tar2
          where  tar.targetid = tar2.targetid
          minus
          select attributename, AttributeValue 
          from   entities  ent2
          where  ent2.entityid = ent.entityid)
and    not exists  
       (  select attributename, AttributeValue 
          from   entities  ent2
          where  ent2.entityid = ent.entityid
          minus 
          select attributename, AttributeValue 
          from   targets  tar2
          where  tar.targetid = tar2.targetid)
order by entityid,targetid
/ 
```

**编辑1：**

如果目标表中的行在实体表中没有匹配项是可以的，则解决方案简化为：

```
select distinct entityid,targetid
from   entities ent
,      targets  tar
where  not exists  
       (  select attributename, AttributeValue 
          from   entities  ent2
          where  ent2.entityid = ent.entityid
          minus 
          select attributename, AttributeValue 
          from   targets  tar2
          where  tar.targetid = tar2.targetid)
order by entityid,targetid
/ 
```

**编辑2：**

理解 OP 的确切要求并不容易。

这是一个新的选择语句。我希望他会测试我所有的选择语句以了解差异。我希望他有好的测试用例并且知道他想要什么。

```
select distinct entityid,targetid
from   entities ent
,      targets  tar
where  not exists  
       (  select attributename, AttributeValue 
          from   targets  tar2
          where  tar.targetid = tar2.targetid
          minus  
          select attributename, AttributeValue 
          from   entities  ent2
          where  ent2.entityid = ent.entityid)
order by entityid,targetid
/ 
```

# sql-server - 如何对 SQL Server 数据库进行版本控制？

> ID：451863
> 
> 赞同：12
> 
> 时间：2009-01-16T20:27:33.097
> 
> 标签：sql-server, versioning, database-versioning

我需要将版本放到 SQL Server 2005 数据库中，并从 .NET 应用程序中访问这些版本。我在想的是在数据库上使用名称为“版本”的扩展属性，当然该值将是数据库的版本。然后我可以使用 SQL 来解决这个问题。我的问题是这听起来像是一个好计划还是有更好的方法将版本添加到 SQL Server 数据库？

假设我无法使用表格来保存元数据。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-16T20:35:54.187

我这样做：

创建模式表：

```
CREATE TABLE [dbo].[SchemaVersion](
    [Major] [int] NOT NULL,
    [Minor] [int] NOT NULL,
    [Build] [int] NOT NULL,
    [Revision] [int] NOT NULL,
    [Applied] [datetime] NOT NULL,
    [Comment] [text] NULL) 
```

更新架构：

```
INSERT INTO SchemaVersion(Major, Minor, Build, Revision, Applied, Comment)
VALUES (1, 9, 1, 0, getdate(), 'Add Table to track pay status') 
```

获取数据库架构版本：

```
SELECT TOP 1 Major, Minor, Build from SchemaVersion
ORDER BY Major DESC, Minor DESC, Build DESC, Revision DESC 
```

[改编自我在Coding Horror](https://blog.codinghorror.com/get-your-database-under-version-control/)上读到的内容

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-16T20:48:46.237

我们使用您描述的扩展属性，它工作得非常好。

我认为有一张桌子是矫枉过正的。如果我想跟踪我的数据库中的差异，我会使用源代码控制并将所有数据库生成脚本保存在其中。

我还使用了一些 ER 图工具来帮助我跟踪数据库版本的变化。这超出了实际应用程序，但它让我可以快速看到发生了什么变化。

我认为是 CASEStudio 或类似的东西。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-16T20:29:39.690

如果我正确理解您的问题（区分内部数据库版本，例如应用程序内部版本号），您可以拥有某种 SYSVERSION 表，其中包含包含此信息的单行数据。

更容易查询。

还可以包含多列有用信息，或代表数据库副本升级的不同时间的多行。

**更新：**好吧，如果您不能使用表来保存元数据，那么某种外部信息（硬盘驱动器上的 INFO 文件？）或扩展属性将是可行的方法。

不过，我仍然喜欢 table 的想法:) 你总是可以使用安全性来使其只能通过自定义存储的 proc get_ db_version 或其他东西访问。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-11-29T22:28:17.130

最好的方法是有两个过程：一个标题来控制要插入的内容和验证一个页脚来插入数据，如果发布是好的与否。正文将包含您的脚本。

您需要一个包装器来封装您的脚本并记录所有信息：到目前为止，已应用脚本编号、applyby、applydate 日期、发布结果“失败或成功”。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-07-17T22:00:00.267

我正在使用类似于马特解决方案的专用表。除此之外，数据库更改必须在对架构应用任何更改之前检查当前版本。如果当前版本小于预期，则脚本以致命错误终止。如果当前版本大于预期，则脚本会跳过当前步骤，因为该步骤过去有时已经执行过。

这是编写数据库更改脚本的示例和约定的完整解决方案：[如何维护 SQL Server 数据库架构版本](http://codinghelmet.com/?path=howto/sql-schema-versioning)

# c++ - 类似的字符串算法

> ID：451884
> 
> 赞同：20
> 
> 时间：2009-01-16T20:34:27.840
> 
> 标签：c++, c, algorithm, string

我正在寻找一种算法，或者至少是关于如何在两个或多个不同字符串中找到相似文本的操作理论......

很像这里提出的问题：[查找具有相似文本的文章的算法](https://stackoverflow.com/questions/246961/algorithm-to-find-similar-text)，不同之处在于我的文本字符串只会是几个单词。

就像说我有一个字符串：“进入晴朗的蓝天”，我正在与以下两个字符串进行比较：“颜色是天蓝色”和“在蓝色晴朗的天空中”

我正在寻找一种算法，可用于匹配两者中的文本，并决定它们匹配的接近程度。就我而言，拼写和标点符号将很重要。我不希望它们影响发现真实文本的能力。在上面的示例中，如果颜色参考存储为“'sky-blue'”，我希望它仍然能够匹配。但是，列出的第三个字符串应该比第二个更好，等等。

我敢肯定，像谷歌这样的地方可能会使用与“您的意思是：”功能类似的东西......

*** 编辑 ***
在与朋友交谈时，他与一个写了一篇关于这个主题的论文的人一起工作。我想我可以与阅读本文的每个人分享它，因为其中描述了一些非常好的方法和过程......

这是[他论文的链接](http://jeffhuang.com/sigir09_submit.pdf)，我希望它对那些阅读这个问题以及类似字符串算法的主题有所帮助。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-16T20:46:29.207

Levenshtein distance 不会完全起作用，因为你想允许重新排列。我认为您最好的选择是找到以列文斯坦距离作为每个单词的成本的最佳重新排列。

要找到重新排列的成本，有点像[煎饼排序问题](http://mathworld.wolfram.com/PancakeSorting.html)。因此，您可以置换每个单词组合（过滤掉完全匹配），以及其他字符串的每个组合，尽量减少每个单词对上置换距离和 Levenshtein 距离的组合。

*编辑：* 现在我有时间可以发布一个简单的示例（所有“最佳”猜测都在检查中，而不是实际运行算法）：

```
original strings             | best rearrangement w/ lev distance per word
Into the clear blue sky      |    Into the c_lear blue sky 
The color is sky blue        |    is__ the colo_r blue sky

R_dist = dist( 3 1 2 5 4 ) --> 3 1 2 *4 5* --> *2 1 3* 4 5 --> *1 2* 3 4 5 = 3  
L_dist = (2D+S) + (I+D+S) (Total Subsitutions: 2, deletions: 3, insertion: 1) 
```

（注意所有翻转都包括范围内的所有元素，我使用 Xi - Xj = +/- 1 的范围）

其他示例

```
original strings             | best rearrangement w/ lev distance per word
Into the clear blue sky      |   Into the clear blue sky 
In the blue clear sky        |   In__ the clear blue sky

R_dist = dist( 1 2 4 3 5 ) -->  1 2 *3 4* 5  = 1
L_dist = (2D) (Total Subsitutions: 0, deletions: 2, insertion: 0) 
```

并展示这三者的所有可能组合......

```
The color is sky blue         |    The colo_r is sky blue
In the blue clear sky         |    the c_lear in sky blue

R_dist = dist( 2 4 1 3 5 ) --> *2 3 1 4* 5 --> *1 3 2* 4 5 --> 1 *2 3* 4 5 = 3
L_dist = (D+I+S) + (S) (Total Subsitutions: 2, deletions: 1, insertion: 1) 
```

无论如何，您将成本函数作为第二选择将是最低成本，这是您所期望的！

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-01-17T07:52:28.987

确定“不考虑顺序的整体相似性”度量的一种方法是使用某种**基于压缩的距离**。基本上，大多数压缩算法（例如`gzip`）的工作方式是沿着字符串扫描以查找较早出现的字符串段 - 任何时候找到这样的段，它都会被替换为（偏移量，长度）对，以识别较早的段使用。您可以使用衡量两个字符串的压缩程度来检测它们之间的相似性。

假设您有一个`string comp(string s)`返回压缩版本的函数`s`。然后，您可以使用以下表达式作为两个字符串`s`和之间的“相似度分数” `t`：

```
len(comp(s)) + len(comp(t)) - len(comp(s . t)) 
```

where`.`被认为是连接。这个想法是，您正在通过首先查看来测量您可以*进一步*压缩多少。如果, 那么将几乎不大于并且您将获得高分，而如果它们完全不同，则将非常接近并且您将获得接近零的分数。中间水平的相似性产生中间分数。`t``s``s == t``len(comp(s . t))``len(comp(s))``len(comp(s . t))``len(comp(s) + comp(t))`

实际上，以下公式甚至更好，因为它是对称的（即分数不会根据哪个字符串`s`和哪个字符串而改变`t`）：

```
2 * (len(comp(s)) + len(comp(t))) - len(comp(s . t)) - len(comp(t . s)) 
```

这种技术起源于信息论。

优点：已经有了好的压缩算法，所以你不需要做太多的编码，而且它们在线性时间（或接近线性时间）内运行，所以速度很快。相比之下，涉及所有单词排列的解决方案的单词数量呈超指数增长（尽管诚然，这在您的情况下可能不是问题，因为您说您知道只有少数单词）。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-16T20:40:17.063

一种方法（尽管这可能更适合拼写检查类型的算法）是“编辑距离”，即计算将一个字符串转换为另一个字符串需要多少次编辑。在这里可以找到一种常见的技术：

[http://en.wikipedia.org/wiki/Levenshtein_distance](http://en.wikipedia.org/wiki/Levenshtein_distance)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-16T21:22:46.293

您可能想研究生物学家用来比较 DNA 序列的算法，因为它们必须处理许多相同的事情（可能缺少块，或者已插入，或者只是移动到字符串中的不同位置。

[Smith-Waterman](http://en.wikipedia.org/wiki/Smith-Waterman)算法就是一个可能运行良好的示例，尽管它对于您的使用来说可能太慢了。不过，可能会给你一个起点。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-05T02:34:41.717

我不能在这里标记两个答案，所以我要回答并标记我自己的答案。在大多数情况下，Levenshtein 距离似乎是正确的方法。但是，值得一提的是[`j_random_hackers`](https://stackoverflow.com/users/47984/jrandomhacker)也回答。我已经使用 LZMA 的实现来测试他的理论，它被证明是一个合理的解决方案。在我最初的问题中，我正在寻找一种短字符串（2 到 200 个字符）的方法，Levenshtein 距离算法将在其中工作。但是，问题中没有提到需要比较两个（较大的）字符串（在这种情况下，是中等大小的文本文件）并执行快速检查以查看两者的相似程度。我相信这种压缩技术会很好地工作，但我还没有研究它，以确定在样本数据的大小和相关操作的速度/成本方面，哪一点变得比另一点更好。我认为这个问题的很多答案都很有价值，值得一提，对于任何想要解决像我在这里所做的类似字符串考验的人。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-11-21T06:40:17.277

我遇到了类似的问题，我需要获取字符串中相似字符的百分比。它需要精确的序列，例如“hello sir”和“sir hello”在比较时需要给我五个相同的字符，在这种情况下它们将是两个“hello”。然后它将取两个字符串中最长的长度，并给出它们相似程度的百分比。这是我想出的代码

```
int compare(string a, string b){
   return(a.size() > b.size() ? bigger(a,b) : bigger(b,a));
}

int bigger(string a, string b){

int maxcount = 0, currentcount = 0;//used to see which set of concurrent characters were biggest

for(int i = 0; i < a.size(); ++i){

    for(int j = 0; j < b.size(); ++j){

        if(a[i+j] == b[j]){

         ++currentcount;

         }

        else{

            if(currentcount > maxcount){

             maxcount = currentcount;

             }//end if

             currentcount = 0;

            }//end else

        }//end inner for loop

    }//end outer for loop

   return ((int)(((float)maxcount/((float)a.size()))*100));
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-05-26T20:27:26.640

还有另一种方式。使用卷积的模式识别。图像 A 通过傅立叶变换运行。图 B 也是。现在将 F(A) 叠加在 F(B) 上，然后将其转换回给您一个带有一些白点的黑色图像。这些点表明 A 与 B 强烈匹配的位置。斑点的总和将表明总体相似性。不确定如何在字符串上运行 FFT，但我很确定它会起作用。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-16T21:37:59.053

困难在于在语义上匹配字符串。

您可以根据字符串的词法属性生成某种值。例如，他们的机器人有蓝色和天空，它们在同一个句子中，等等……但它不会处理“Sky's jean is blue”或其他使用相同单词的奇怪球英语结构的情况，但你需要解析英语语法......

除了词汇相似性之外，您还需要研究自然语言处理，并且不会有一种单一的算法可以解决您的问题。

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2009-01-16T21:11:52.650

可能的方法：

*为参考*字符串中的所有单词组合构造一个字符串键为“word1|word2”的字典。一个组合可能会发生多次，因此 Dictionary 的值应该是一个数字*列表*，每个数字代表参考字符串中单词之间的*距离。*

当你这样做时，这里会有重复：对于每个“word1|word2”字典条目，都会有一个“word2|word1”条目具有相同的距离值列表，但被否定了。

对于*比较*字符串中的每个单词组合（单词 1 和 2、单词 1 和 3、单词 2 和 3 等），检查参考字符串中的两个键（word1|word2 和 word2|word1）并找到*最接近*的值到当前字符串中的距离。将当前距离与最近距离之差的绝对值添加到计数器。

如果单词之间的最近参考距离与比较字符串的方向相反 (word2|word1)，则您可能希望将其加权小于两个字符串中最接近的值在相同方向的情况。

完成后，将总和除以比较字符串中单词数的平方。

这应该提供一些十进制值，表示每个单词/短语与原始字符串中的某个单词/短语的匹配程度。

当然，如果原始字符串较长，则不会考虑这一点，因此可能需要计算这两个方向（使用一个作为参考，然后是另一个）并将它们平均。

我完全没有这方面的代码，我可能只是重新发明了一个非常粗糙的轮子。YMMV。

# java - 为什么使用十六进制值而不是普通的以 10 为基数的数字？

> ID：451886
> 
> 赞同：5
> 
> 时间：2009-01-16T20:34:53.830
> 
> 标签：java, c, hex, math.sqrt

我正在查看[这段代码](http://www.ibm.com/developerworks/library/j-math1/index.html?ca=dgr-btw03JavaPart1&S_Tact=105AGX59&S_cmp=GRsitebtw03#hypotenuse)以用 Java 进行计算`math.sqrt`。为什么他们在某些循环中使用十六进制值和变量的正常值？使用十六进制有什么好处？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-01-16T20:40:47.797

因为十六进制更接近于十进制数字的位。每个十六进制数字对应于 4 位（一个半字节）。因此，一旦您了解了与每个十六进制数字 (0-F) 关联的位掩码，您就可以执行类似“我想要低位字节的掩码”之类的操作：

```
0xff 
```

或者，“我想要底部 31 位的掩码”：

```
0x7fffffff 
```

仅供参考：

```
HEX    BIN
0   -> 0000
1   -> 0001
2   -> 0010
3   -> 0011
4   -> 0100
5   -> 0101
6   -> 0110
7   -> 0111
8   -> 1000
9   -> 1001
A   -> 1010
B   -> 1011
C   -> 1100
D   -> 1101
E   -> 1110
F   -> 1111 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-16T20:39:17.830

他们可能使用十六进制值，因为十六进制数字更容易记住。例如，0x7fffffff 与 2147483647 相同，但更容易记住。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-16T20:45:46.633

十六进制是 CPU 实际使用的一种人类可读的二进制形式。在查看低级命令时，匹配 CPU 并以十六进制思考通常更有意义，

# javascript - 如何允许将数据粘贴到网页中？

> ID：451889
> 
> 赞同：0
> 
> 时间：2009-01-16T20:35:30.507
> 
> 标签：javascript, html, copy-paste

我有一个[整洁的小 javascript 数据网格](http://www.freedownloadmanager.org/downloads/ActiveWidgets_Grid_Free_Edition__28641_p/)，我希望人们能够将数据粘贴到其中。我知道访问剪贴板存在安全问题，但我想知道是否有办法做到这一点。对于最终用户来说，这是迄今为止最直观的方法。

有没有我可以用文本输入做的一些狡猾的黑客攻击？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-16T20:42:27.090

浏览器中的 PASTE 不支持数据。它是纯文本的。我建议粘贴到文本区域，然后解析数据并将其插入到您的网格中。

# .net - 在 WinForms 应用程序中使用类似 IE 的着色和折叠节点显示 XML 文件

> ID：451901
> 
> 赞同：3
> 
> 时间：2009-01-16T20:37:23.497
> 
> 标签：.net, xml, winforms

我想在我的 .NET 2.0 WinForms 应用程序中显示一个 XML 文件，就像 IE 一样（您可以在其中折叠节点，并且一切都很好地着色）。有没有内置的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-16T20:43:52.987

您可以在应用程序的表单中托管 IE，也可以使用 IE 使用的相同 XSL 转换在 WebBrowser 控件中显示它，如下所述：http: [//blorgh.wordpress.com/2006/10/17/displaying-xml-in -the-net-webbrowser-control/](http://blorgh.wordpress.com/2006/10/17/displaying-xml-in-the-net-webbrowser-control/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-16T21:07:15.933

在 codeplex 上有一个项目[XmlVisualiser v.2](http://www.codeplex.com/XmlVisualizer)可以做到这一点。它既可用作 Visual Studio 的可视化器插件，也可用作可在应用程序中使用的用户控件。

我认为它会做你所追求的。

# c# - 如何将字符串长度转换为像素单位？

> ID：451903
> 
> 赞同：28
> 
> 时间：2009-01-16T20:38:12.997
> 
> 标签：c#, telerik, telerik-reporting

我有一个这样的字符串：

```
string s = "This is my string"; 
```

我正在创建一个 Telerik 报告，我需要定义一个`textbox`字符串的宽度。但是，需要将 size 属性设置为单位（像素、点、英寸等）。如何将我的字符串长度转换为像素，以便我可以设置宽度？

**编辑：** 我尝试获取对图形对象的引用，但这是在继承自`Telerik.Reporting.Report`.

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2009-01-16T20:54:17.207

不使用控件或表单：

```
using (System.Drawing.Graphics graphics = System.Drawing.Graphics.FromImage(new Bitmap(1, 1)))
{
    SizeF size = graphics.MeasureString("Hello there", new Font("Segoe UI", 11, FontStyle.Regular, GraphicsUnit.Point));
} 
```

或者在 VB.Net 中：

```
Using graphics As System.Drawing.Graphics = System.Drawing.Graphics.FromImage(New Bitmap(1, 1))
    Dim size As SizeF = graphics.MeasureString("Hello there", New Font("Segoe UI", 11, FontStyle.Regular, GraphicsUnit.Point))
End Using 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2012-09-26T14:40:08.120

```
Size textSize = TextRenderer.MeasureText("How long am I?", font); 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2015-04-29T11:05:36.727

在这种情况下，我通常使用一种肮脏但简单的方法：

*   我加了一个无形的`Label`，它的`AutoSize`属性是`true`——*肮脏的工作*——。
*   当我想要`Width`一个特定的字符串时，我将它设置为`Label.Text`.
*   的会给我正确的价值`Width`。`Label`

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-16T20:39:47.830

`MeasureString()`您可以使用该方法创建图形对象的实例。但是您需要将字体名称、字体大小和其他信息传递给它。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-16T20:40:05.163

也取决于字体。字符串长度不够。

# mysql - 我如何通过 mysql 数据库进行 grep？

> ID：451922
> 
> 赞同：23
> 
> 时间：2009-01-16T20:42:43.567
> 
> 标签：mysql, grep

寻找一个漂亮的帮助函数/方法来遍历 MySql 数据库的所有定义的表、列、存储过程等。

我对 SQL Server 有类似的东西。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2011-06-01T22:43:53.767

`mysqldump --compact --skip-extended-insert -u root -proot mydb | grep "interesting string"`

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-01-16T20:52:42.610

在 INFORMATION_SCHEMA 数据库中：

```
select * from columns WHERE TABLE_NAME LIKE '%tablename%' AND COLUMN_NAME LIKE '%columnname%' 
```

更多信息在这里： [http ://dev.mysql.com/doc/refman/5.0/en/information-schema.html](http://dev.mysql.com/doc/refman/5.0/en/information-schema.html)

好的，它并没有完全回答你的问题，但你应该能够从这里按照你想要的方式把它放在一起。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-01-09T15:25:20.903

或者简单，MySQL Workbench -> 数据库 -> 搜索表数据...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-02-09T13:24:17.797

这里有一个 MySQL 的存储过程（[http://forge.mysql.com/tools/tool.php?id=232](http://forge.mysql.com/tools/tool.php?id=232)），它将创建一个表来存储输出，然后遍历 information_schema 数据库的 COLUMNS 表以获取所有数据库的表和列名。接下来对 database.table 执行 count() 查询，在 where 条件下使用适当的搜索字符串对每一列进行查询。如果 count() > 0，则该特定列具有搜索词，因此它将将该三元组（数据库名称、表名称、列名称）插入到表中。最后从表中选择 * 以查看具有搜索词的相应数据库表和列名。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-08-19T01:19:02.017

Common Resource Grep (crgrep) 搜索表/列名和数据匹配并支持 MySQL。

[http://sourceforge.net/projects/crgrep/](http://sourceforge.net/projects/crgrep/)

还搜索其他难以搜索的资源，例如隐藏在档案中的内容。我将 crgrep 开发为开源工具。

# c# - 我的代码存在逻辑错误

> ID：451925
> 
> 赞同：1
> 
> 时间：2009-01-16T20:43:21.067
> 
> 标签：c#, search

我写了这段代码，它总是显示相同的结果，为什么？代码是一种搜索方法。

```
using System;
using System.Collections.Generic;
using System.Text;

namespace CArraySe
{
    class Program
    {
        class CArray
        {
            private int[] arr;
            private int upper;
            private int numElements;
            private int compCount;

            public CArray(int size)
            {
                arr = new int[size];
                upper = size - 1;
                numElements = 0;
                compCount = 0;
            }

            public void Insert(int item)
            {
                arr[numElements] = item;
                numElements++;
            }

            public void DisplayElements()
            {
                for (int i = 0; i <= upper; i++)
                {
                    Console.Write(arr[i]);
                    if (i == upper)
                    {
                        Console.WriteLine();
                        continue;
                    }
                    Console.Write(", ");
                }
            }

            public void Clear()
            {
                for (int i = 0; i <= upper; i++)
                    arr[i] = 0;
                numElements = 0;
            }
            public bool SeqSearch(CArray n, int sValue)
            {
                for (int index = 0; index < n.upper; index++)
                {
                    if (arr[index] == sValue)

                        return true;
                }

                compCount++;
                return false;
            }
            public int binSearch(CArray n, int value)
            {
                int upperBound, lowerBound, mid;
                upperBound = n.upper; lowerBound = 0;

                while (lowerBound <= upperBound)
                {
                    mid = (upperBound + lowerBound) / 2;

                    if (arr[mid] == value)
                        return mid;

                    else if (value < arr[mid]) upperBound = mid - 1;

                    else lowerBound = mid + 1;
                }
                compCount++;
                return -1;
            }

            static void Main(string[] args)
            {
                CArray nums = new CArray(10);
                Random rnd = new Random(100);
                for (int i = 0; i < 10; i++)
                    nums.Insert((int)(rnd.NextDouble() * 100));

                Console.WriteLine();
                Console.Write("The Binary Search Result is: ");
                Console.WriteLine(nums.binSearch(nums, 500));
                Console.WriteLine(nums.compCount);
                nums.Clear();
                for (int i = 0; i < 10; i++)
                    nums.Insert((int)(rnd.NextDouble() * 100));

                Console.Write("The Sequential Search result is: ");
                Console.WriteLine(nums.SeqSearch(nums, 500));
                Console.WriteLine(nums.compCount);
           }
       }
    }
} 
```

即使我更改了我要查找的号码，它也总是显示相同的结果。

输出是：

```
The Binary Search Result is: -1
1
The Sequential Search result is: False
2
Press any key to continue . . . 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-16T20:49:57.543

我认为没有找到您正在搜索的值 (500)。尝试输出 nums 数组并验证您要查找的内容是否在数组中。

另外，一个搜索返回一个 int，另一个返回一个 bool。有什么具体原因吗？

**编辑：**此外，[二分搜索](http://en.wikipedia.org/wiki/Binary_search)仅适用于排序列表。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-16T20:51:09.103

当找不到数字时，您的方法 binSearch 返回“-1”。由于您正在使用随机值填充数组，因此您搜索的数字很有可能不会被找到。所以你总是得到“-1”。

要测试您的 binSearch 方法，您应该使用已知值填充数组，然后搜索一些保证在数组中的值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-16T20:52:08.803

第一个答案是正确的。此外，即使您使用的是随机数，程序的每次运行也会产生相同的随机数序列。如果你想很好地测试代码，你应该在每次运行程序时使用不同的数字作为种子。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-16T20:59:15.047

正如其他人已经提到的，*在一般情况下*，不能保证您要搜索的数字在随机生成的数字列表中。*在您发布的特定情况下*，该数字将*永远不会*出现在列表中，因为您正在生成**0-100**范围内的随机数，然后尝试查找**500**。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-16T21:04:42.227

运行您提供的内容不会添加超过 100 的值。如果您将添加更改为：

```
 for (int i = 0; i < 9; i++)
            nums.Insert((int)(rnd.NextDouble() * 100));
        nums.Insert(500); 
```

binSearch 返回 9，但 SeqSearch 返回 false，因为您的循环搜索是 index < n.upper 并且您需要执行 index <= n.upper 来检查所有值。此外，如上所述，binSearch 仅在这种情况下有效，因为 500 比数组中的所有数字都大，并且已放置在最后一个索引处。如果列表的搜索没有排序，二分搜索只能靠运气工作。因此改为：

```
 nums.Insert(500);
        for (int i = 0; i < 9; i++)
            nums.Insert((int)(rnd.NextDouble() * 100)); 
```

将返回 -1；对于 SeqSearch 也是如此。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-16T21:30:00.427

尽管这可能无法直接回答您的问题，但这里有一些观察结果会使您的代码难以理解和调试：

*   您需要 numElements 或 upper 之一，而不是两者。在 Clear() 中，您仅将 numElements 设置为 0，而您在任何地方的循环中都使用了 upper？*   二进制搜索仅适用于排序数组*   如果 SeqSearch 和 BinSearch 正在接收数组的实例，它们不应该是静态方法而不是实例方法吗？

# c# - Mono 和 C# IOCP：这是个好主意吗？

> ID：451938
> 
> 赞同：3
> 
> 时间：2009-01-16T20:47:47.377
> 
> 标签：c#, mono, iocp

我正在将一个 c++ 应用程序移植到在其服务器上使用 IOCP 的 c#。

单声道可以像处理窗口一样处理 IOCP 吗？我会获得与 c++ 相当的性能还是我应该尝试其他方法？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-16T21:58:42.553

IOCP 的主要开销是 IO 而不是语言。您**应该**期望 C# 代码具有与 C++ 相同的性能（鉴于 Mono 处于成熟状态）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-01-14T17:21:22.370

你的目标是 windows 的单声道吗？如果是 linux，则有不同的异步 i/o 模型，而不是完成端口。我认为单声道开发人员已尽力支持它。

# .net - 使用安全字符串并确保其安全

> ID：451939
> 
> 赞同：6
> 
> 时间：2009-01-16T20:47:53.210
> 
> 标签：.net, securestring, application-security

因此，.NET 框架提供了[SecureString](http://msdn.microsoft.com/en-us/library/system.security.securestring.aspx)类，用于以安全的方式存储字符串。但是要阅读信息并使用它，您必须将其返回为标准字符串。请参阅[此实现示例](http://dotnetweblog.wordpress.com/2008/07/11/securestring-storing-sensitive-data/)。

从使用指针的示例中可以看出，我们返回一个未加密的字符串。我们现在如何管理字符串的“不安全”实例？设置值后，使用该值最安全的方法是什么？

**编辑**

这个问题的目的是讨论在使用 SecureStrings 然后使用这些值时减少潜在攻击表面积的方法。不是关于“重复”链接的“为什么”。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-17T03:33:38.540

在将 a [`SecureString`](http://msdn.microsoft.com/en-us/library/system.security.securestring.aspx)back 的内容放入 a[`String`](http://msdn.microsoft.com/en-us/library/system.string.aspx)时，您重新引入了使用此处列出的字符串的问题：

[http://blogs.msdn.com/shawnfa/archive/2004/05/27/143254.aspx](http://blogs.msdn.com/shawnfa/archive/2004/05/27/143254.aspx)

使用`SecureString`，提供了一些选项来将内容编组到非托管内存中，这样您就可以访问数据，然后在**处理**完数据后将其处理掉。

这些是托管代码所没有的选项。在使用非托管字节时，您可以将内存清零，确保它没有分页到磁盘等，这正是您想要减少攻击面的方法。

这里的关键是**不要**以在处理数据时更容易管理安全性的方式创建数据的另一个实例`String`和使用数据（不幸的是，现在是非托管代码）。

# parsing - 最佳第 3 方简历解析器工具

> ID：451943
> 
> 赞同：16
> 
> 时间：2009-01-16T20:49:21.227
> 
> 标签：parsing

我们正在开发一个招聘应用程序，需要能够轻松解析简历。在尝试构建一个之前，想知道有哪些简历解析工具可用，在您看来什么是最好的？我们需要能够解析 Word 和 TXT 文件。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-09T18:31:00.917

我建议看一些人工智能工具。我知道的三个是

*   [亚历克斯](http://www.hireability.com/ALEX/)
*   [索夫伦](http://www.sovren.com)
*   [简历镜像](http://www.talenttech.com/products/components/rm_extraction.htm)

我认为所有产品都可以处理 Word、txt 和 pdf 以及许多其他文档类型。虽然我从未使用过它，但我听说过关于 Resume Mirror 的准确性和客户支持的不利消息。我是一名合同招聘人员，并且在不同的 ATS 中使用了 Sovren 和 Hireability 的解析器。在我看来，我认为 Hireability 做得更好，Sovren 似乎我总是在修复错误。当 Hire's 出了问题时，我把它交给了我的 ATS 供应商，看起来它很快就修复了。祝你好运。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-29T05:34:20.210

不要试图建立一个，除非你想把你的生命奉献给它。不要重新发明轮子！

我们建立和销售招聘系统。几年前我进行了长时间的评估并选择了 Daxtra - 框架中的另一个是 Burning Glass，但我的印象是 Daxtra 在美国以外的简历上做得更好。

无论如何，我们正在重新评估它。只要简历在文化上是可以的，它的某些部分（姓名，地址，电话号码，工作经历）就做得很好。但如果不是，那么它就失败了。我是什么意思：好吧，如果简历的第一行是：

姓名：孙中山

然后 Daxtra 足够聪明，可以确定孙中山是这个人的名字。（女孩们？）

但如果它作为第一行：

孙中山

它想不通。

另一方面，如果第一行是

约翰尼·罗滕

然后 Daxtra 算出他的名字。

此外，它在英国地址上运行得非常好，在澳大利亚地址上也相当好，在印度尼西亚地址上崩溃和烧毁。也就是说，我们刚刚相对较好地解析了 35,000 份印尼简历——当然比完全不做或手动做要好得多！

关于 Skilling：我认为如果有人真的试图让 Skills 部分发挥作用，那么这将需要 3 个人工月左右，而且效果会非常好。

总结：不要自己写，对你想要解析和深入研究的真实简历做一些非常好的研究。

关键是：不要指望任何工具接近 100% 准确 - 但总比没有要好得多。

尼尔

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-04-16T14:38:46.220

FWIW 我刚刚通过 Rchilli 运​​行了 650 份国际简历，发现准确性非常差。姓名和地址被破坏，详细信息字段被击中和错过。

这是主要来自欧洲和亚洲的 pdf 和 Word 文档的混合体。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-16T21:03:02.480

我看过很多PDF格式的简历。你确定你不在乎他们吗？

我会推荐一些简单的东西：

1.  下载 google 桌面搜索或类似工具（即 Copernic）
2.  将文件拖放到目录中
3.  将索引工具指向该目录，然后输入您的搜索词。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-29T11:32:34.600

您可能想看看[egrabber](http://www.egrabber.com/resumegrabbersuite/parse-resumes.html)和[rchilli](http://www.rchilli.com/)这是市场上最好的两个工具。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-05-13T15:48:43.277

我想知道是否有人更新这些列表。似乎都是 2010 年的，差不多 3 岁。

我们集成了 RChilli，发现它们没有任何缺陷，支持最好，产品更易于使用。

我们测试[了 RChilli](http://www.rchilli.com)、[Hireability](http://www.hireability.com)和[Daxtra](http://www.daxtra.com)。[Sovren](http://www.sovren.com)从未回复我们的电子邮件。

集成很顺利，那里的支持最好。

# c# - 获取 XElement 的 XPath？

> ID：451950
> 
> 赞同：45
> 
> 时间：2009-01-16T20:50:48.557
> 
> 标签：c#, xml, xpath, xelement

我在文档中有一个 XElement。给定 XElement（和 XDocument？），是否有扩展方法来获取其完整（即绝对，例如`/root/item/element/child`）XPath？

例如 myXElement.GetXPath()？

**编辑：好的，看起来我忽略了一些非常重要的事情。哎呀！需要考虑元素的索引。有关建议的更正解决方案，请参阅我的最后一个答案。**

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2009-01-18T03:34:17.010

扩展方法：

```
public static class XExtensions
{
    /// <summary>
    /// Get the absolute XPath to a given XElement
    /// (e.g. "/people/person[6]/name[1]/last[1]").
    /// </summary>
    public static string GetAbsoluteXPath(this XElement element)
    {
        if (element == null)
        {
            throw new ArgumentNullException("element");
        }

        Func<XElement, string> relativeXPath = e =>
        {
            int index = e.IndexPosition();
            string name = e.Name.LocalName;

            // If the element is the root, no index is required

            return (index == -1) ? "/" + name : string.Format
            (
                "/{0}[{1}]",
                name, 
                index.ToString()
            );
        };

        var ancestors = from e in element.Ancestors()
                        select relativeXPath(e);

        return string.Concat(ancestors.Reverse().ToArray()) + 
               relativeXPath(element);
    }

    /// <summary>
    /// Get the index of the given XElement relative to its
    /// siblings with identical names. If the given element is
    /// the root, -1 is returned.
    /// </summary>
    /// <param name="element">
    /// The element to get the index of.
    /// </param>
    public static int IndexPosition(this XElement element)
    {
        if (element == null)
        {
            throw new ArgumentNullException("element");
        }

        if (element.Parent == null)
        {
            return -1;
        }

        int i = 1; // Indexes for nodes start at 1, not 0

        foreach (var sibling in element.Parent.Elements(element.Name))
        {
            if (sibling == element)
            {
                return i;
            }

            i++;
        }

        throw new InvalidOperationException
            ("element has been removed from its parent.");
    }
} 
```

和测试：

```
class Program
{
    static void Main(string[] args)
    {
        Program.Process(XDocument.Load(@"C:\test.xml").Root);
        Console.Read();
    }

    static void Process(XElement element)
    {
        if (!element.HasElements)
        {
            Console.WriteLine(element.GetAbsoluteXPath());
        }
        else
        {
            foreach (XElement child in element.Elements())
            {
                Process(child);
            }
        }
    }
} 
```

和样本输出：

```
/tests/test[1]/date[1]
/tests/test[1]/time[1]/start[1]
/tests/test[1]/time[1]/end[1]
/tests/test[1]/facility[1]/name[1]
/tests/test[1]/facility[1]/website[1]
/tests/test[1]/facility[1]/street[1]
/tests/test[1]/facility[1]/state[1]
/tests/test[1]/facility[1]/city[1]
/tests/test[1]/facility[1]/zip[1]
/tests/test[1]/facility[1]/phone[1]
/tests/test[1]/info[1]
/tests/test[2]/date[1]
/tests/test[2]/time[1]/start[1]
/tests/test[2]/time[1]/end[1]
/tests/test[2]/facility[1]/name[1]
/tests/test[2]/facility[1]/website[1]
/tests/test[2]/facility[1]/street[1]
/tests/test[2]/facility[1]/state[1]
/tests/test[2]/facility[1]/city[1]
/tests/test[2]/facility[1]/zip[1]
/tests/test[2]/facility[1]/phone[1]
/tests/test[2]/info[1] 
```

那应该解决这个问题。不？

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2010-03-22T14:40:42.743

我更新了 Chris 的代码以考虑命名空间前缀。仅修改 GetAbsoluteXPath 方法。

```
public static class XExtensions
{
    /// <summary>
    /// Get the absolute XPath to a given XElement, including the namespace.
    /// (e.g. "/a:people/b:person[6]/c:name[1]/d:last[1]").
    /// </summary>
    public static string GetAbsoluteXPath(this XElement element)
    {
        if (element == null)
        {
            throw new ArgumentNullException("element");
        }

        Func<XElement, string> relativeXPath = e =>
        {
            int index = e.IndexPosition();

            var currentNamespace = e.Name.Namespace;

            string name;
            if (currentNamespace == null)
            {
                name = e.Name.LocalName;
            }
            else
            {
                string namespacePrefix = e.GetPrefixOfNamespace(currentNamespace);
                name = namespacePrefix + ":" + e.Name.LocalName;
            }

            // If the element is the root, no index is required
            return (index == -1) ? "/" + name : string.Format
            (
                "/{0}[{1}]",
                name,
                index.ToString()
            );
        };

        var ancestors = from e in element.Ancestors()
                        select relativeXPath(e);

        return string.Concat(ancestors.Reverse().ToArray()) +
               relativeXPath(element);
    }

    /// <summary>
    /// Get the index of the given XElement relative to its
    /// siblings with identical names. If the given element is
    /// the root, -1 is returned.
    /// </summary>
    /// <param name="element">
    /// The element to get the index of.
    /// </param>
    public static int IndexPosition(this XElement element)
    {
        if (element == null)
        {
            throw new ArgumentNullException("element");
        }

        if (element.Parent == null)
        {
            return -1;
        }

        int i = 1; // Indexes for nodes start at 1, not 0

        foreach (var sibling in element.Parent.Elements(element.Name))
        {
            if (sibling == element)
            {
                return i;
            }

            i++;
        }

        throw new InvalidOperationException
            ("element has been removed from its parent.");
    }
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2014-05-08T12:02:53.637

让我分享我对这门课的最新修改。基本上，如果元素没有兄弟元素，它会排除索引，并且包含带有 local-name() 运算符的命名空间我是否遇到了命名空间前缀的问题。

```
public static class XExtensions
{
    /// <summary>
    /// Get the absolute XPath to a given XElement, including the namespace.
    /// (e.g. "/a:people/b:person[6]/c:name[1]/d:last[1]").
    /// </summary>
    public static string GetAbsoluteXPath(this XElement element)
    {
        if (element == null)
        {
            throw new ArgumentNullException("element");
        }

        Func<XElement, string> relativeXPath = e =>
        {
            int index = e.IndexPosition();

            var currentNamespace = e.Name.Namespace;

            string name;
            if (String.IsNullOrEmpty(currentNamespace.ToString()))
            {
                name = e.Name.LocalName;
            }
            else
            {
                name = "*[local-name()='" + e.Name.LocalName + "']";
                //string namespacePrefix = e.GetPrefixOfNamespace(currentNamespace);
                //name = namespacePrefix + ":" + e.Name.LocalName;
            }

            // If the element is the root or has no sibling elements, no index is required
            return ((index == -1) || (index == -2)) ? "/" + name : string.Format
            (
                "/{0}[{1}]",
                name,
                index.ToString()
            );
        };

        var ancestors = from e in element.Ancestors()
                        select relativeXPath(e);

        return string.Concat(ancestors.Reverse().ToArray()) +
               relativeXPath(element);
    }

    /// <summary>
    /// Get the index of the given XElement relative to its
    /// siblings with identical names. If the given element is
    /// the root, -1 is returned or -2 if element has no sibling elements.
    /// </summary>
    /// <param name="element">
    /// The element to get the index of.
    /// </param>
    public static int IndexPosition(this XElement element)
    {
        if (element == null)
        {
            throw new ArgumentNullException("element");
        }

        if (element.Parent == null)
        {
            // Element is root
            return -1;
        }

        if (element.Parent.Elements(element.Name).Count() == 1)
        {
            // Element has no sibling elements
            return -2;
        }

        int i = 1; // Indexes for nodes start at 1, not 0

        foreach (var sibling in element.Parent.Elements(element.Name))
        {
            if (sibling == element)
            {
                return i;
            }

            i++;
        }

        throw new InvalidOperationException
            ("element has been removed from its parent.");
    }
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-17T01:54:20.627

这实际上是[这个](https://stackoverflow.com/questions/241238/how-to-get-xpath-from-an-xmlnode-instance-c#)问题的副本。虽然它没有被标记为答案，但[我](https://stackoverflow.com/questions/241238/how-to-get-xpath-from-an-xmlnode-instance-c#241492)对这个问题的回答中的方法是明确地将 XPath 公式化到 XML 文档中的节点的唯一方法，这种方法在所有情况下都始终有效。（它也适用于所有节点类型，而不仅仅是元素。）

如您所见，它生成的 XPath 既丑陋又抽象。但它解决了许多回答者在这里提出的担忧。此处提出的大多数建议都会生成一个 XPath，当用于搜索原始文档时，它将生成一组包含目标节点的一个或多个节点。这就是“或更多”的问题。例如，如果我有一个 DataSet 的 XML 表示，则指向特定 DataRow 元素的原始 XPath`/DataSet1/DataTable1`也返回 DataTable 中所有其他 DataRows 的元素。如果不了解 XML 的论坛化方式（例如，是否有主键元素？），您无法消除歧义。

但是`/node()[1]/node()[4]/node()[11]`，无论如何，它只会返回一个节点。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-09-01T12:51:15.420

作为[另一个项目](http://formaldev.blogspot.com.au/2013_08_01_archive.html)的一部分，我开发了一种扩展方法来为元素生成简单的 XPath。它与所选答案类似，但除 XElement 外，还支持 XAttribute、XText、XCData 和 XComment。它可以作为[代码 nuget 使用](http://www.nuget.org/packages/XPathDiscovery.Code/)，项目页面在这里：[xmlspecificationcompare.codeplex.com](http://xmlspecificationcompare.codeplex.com/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-02-14T05:50:42.217

在某一时刻，我使用了这个更紧凑的表达式，`C#`并`.Net Framework 4.8`作为目标：

```
public static string GetAbsoluteXPath(XElement element,int xpversion)
{
    IEnumerable<XElement> ancestors = element.AncestorsAndSelf();
    string xpath = ancestors.Aggregate(new StringBuilder(),
                        (str, elem) => str.Insert(0, (xpversion > 1 ? ("/*:" + elem.Name.LocalName) : ("/*[local-name(.) = '" + elem.Name.LocalName + "']")) + "[" + (int)(elem.ElementsBeforeSelf().Where(el => el.Name.LocalName == elem.Name.LocalName).Count() + 1) + "]"),
                        str => str.ToString());
    return xpath;
} 
```

作为一般解决方案工作正常，但有时有点慢（我喜欢:-)）。`xpversion`您可以选择命名空间通配符`XPath 1.0`的`XPath >1.0`版本：

**示例**：`xpversion =< 1`结果看起来像这样：`/*[local-name(.) = 'AUTOSAR'][1]/*[local-name(.) = 'AR-PACKAGES'][1]/*[local-name(.) = 'AR-PACKAGE'][1]`结果`xpversion > 1`像这样：`/*:AUTOSAR[1]/*:AR-PACKAGES[1]/*:AR-PACKAGE[1]/*:AR-PACKAGES[1]`

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-16T21:07:45.823

如果您正在寻找 .NET 原生提供的东西，答案是否定的。您必须编写自己的扩展方法来执行此操作。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-16T21:12:50.510

可以有多个 xpath 通向同一个元素，因此找到通向节点的最简单 xpath 并非易事。

也就是说，很容易找到节点的 xpath。只需向上提升节点树，直到您读取根节点并组合节点名称并且您有一个有效的 xpath。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-16T21:14:18.323

“完整的 xpath”我假设您的意思是一个简单的标签链，因为可能匹配任何元素的 xpath 的数量可能*非常*大。

这里的问题是，即使不是特别不可能，也很难构建任何给定的 xpath，它将可逆地追溯到同一个元素——这是一个条件吗？

如果“否”，那么也许您可以通过参考当前元素 parentNode 递归循环来构建查询。如果“是”，那么您将考虑通过交叉引用兄弟集中的索引位置来扩展它，引用类似 ID 的属性（如果存在），如果通用解决方案，这将非常依赖于您的 XSD是可能的。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2014-06-07T18:27:35.673

自 .NET Framework 3.5 起，Microsoft 提供了一种扩展方法来执行此操作：

[http://msdn.microsoft.com/en-us/library/bb156083(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/bb156083%28v=vs.100%29.aspx)

只需添加一个 using to`System.Xml.XPath`并调用以下方法：

*   `XPathSelectElement`: 选择一个元素
*   `XPathSelectElements`: 选择元素并返回`IEnumerable<XElement>`
*   `XPathEvaluate`：选择节点（不仅是元素，还包括文本、评论等）并返回为`IEnumerable<object>`

# python - 备份 ZODB blob 的正确方法是什么？

> ID：451952
> 
> 赞同：8
> 
> 时间：2009-01-16T20:51:01.910
> 
> 标签：python, plone, zope, zodb, blobstorage

我正在使用 plone.app.blob 将大型 ZODB 对象存储在 blobstorage 目录中。这减少了 Data.fs 的大小压力，但我无法找到有关备份此数据的任何建议。

我已经通过将网络备份工具指向 repozo 备份目录来备份 Data.fs。我是否应该简单地将该工具指向 blobstorage 目录来备份我的 blob？

如果在复制过程中重新打包数据库或添加和删除 blob，该怎么办？blobstorage 目录中是否有必须按特定顺序复制的文件？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2010-04-18T23:51:13.263

对 Data.fs 进行 repozo 备份，然后对 blobstorage 目录进行 rsync 应该是安全的，只要在这两个操作发生时数据库没有被打包。

这是因为，至少在使用带有 FileStorage 的 blob 时，对 blob 的修改总是会导致创建一个基于对象 ID 和事务 ID 命名的新文件。因此，如果在备份 Data.fs 后写入新的或更新的 blob，这应该不是问题，因为 Data.fs 引用的文件应该仍然存在。删除 blob 不会导致文件被删除，直到数据库被打包，所以这也应该没问题。

以不同的顺序执行备份，或在备份期间打包，可能会导致备份 Data.fs 引用未包含在备份中的 blob。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-17T20:16:28.203

备份“blobstorage”就可以了。不需要特殊订单或其他任何东西，这非常简单。

Plone 中的所有操作都是完全事务性的，因此在事务中间点击备份应该可以正常工作。这就是您可以对 ZODB 进行实时备份的原因。在不知道您使用的文件系统的情况下，我猜它应该按预期工作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-03-10T16:54:01.070

我有一个脚本，它使用硬链接将 blob 复制一个月（因此您将 blob 的历史记录为 Data.fs ）：

备份.sh

```
#!/bin/sh

# per a fer un full : ./cron_nocturn.sh full

ZEO_FOLDER=/var/plone/ZEO

# Zeo port
ZEO_PORT = 8023

# Name of the DB
ZEO_DB = zodb1

BACKUP_FOLDER=/backup/plone

LOGBACKUP=/var/plone/ZEO/backup.log

BACKUPDIR=`date +%d`

echo "INICI BACKUP" >> $LOGBACKUP
echo `date` >> $LOGBACKUP

# Fem el packing

if [ "$1" = "full" ]; then
  $ZEO_FOLDER/bin/zeopack -S $ZEO_DB -p $ZEO_PORT -h 127.0.0.1

echo "   Comprovant folders"
#mirem si existeix el folder de backup
if ! [ -x $BACKUP_FOLDER/$ZEO_DB ]; then
   mkdir $BACKUP_FOLDER/$ZEO_DB
fi

#mirem si existeix el backup folder del dia
if ! [ -x $BACKUP_FOLDER/blobs/$BACKUPDIR/ ] ; then
   mkdir $BACKUP_FOLDER/blobs/$BACKUPDIR/
fi

echo "   Backup Data.fs"
# backup de Data.fs
if  [ "$1" = "full" ]; then
   echo "   Copiant Data.fs"
   $ZEO_FOLDER/bin/repozo -B -F -r $BACKUP_FOLDER/$ZEO_DB/ -f $ZEO_FOLDER/var/filestorage/Data_$ZEO_DB.fs
   echo "   Purgant backups antics"
   $ZEO_FOLDER/neteja.py -l $BACKUP_FOLDER/$ZEO_DB -k 2
else
   $ZEO_FOLDER/bin/repozo -B -r $BACKUP_FOLDER/$ZEO_DB/ -f $ZEO_FOLDER/var/filestorage/Data_$ZEO_DB.fs
fi

echo "   Copiant blobs"
# backup blobs
rm -rf $BACKUP_FOLDER/blobs/$BACKUPDIR
cd $BACKUP_FOLDER/current-blobs && find . -print | cpio -dplm $BACKUP_FOLDER/blobs/$BACKUPDIR
rsync --force --ignore-errors --delete --update -a $ZEO_FOLDER/var/blobs/ $BACKUP_FOLDER/current-blobs/

echo "FI BACKUP" >> $LOGBACKUP
echo `date` >> $LOGBACKUP 
```

neteja.py

```
#!/usr/bin/python2.4

# neteja.py -l [directori_desti] -k [numero_fulls_a_mantenir]
# Script que neteja un directori amb backups i guarda nomes els ultims fulls que li especifiquis
# Es basa en la utilitzacio de collective.recipe.backup
# Author: Victor Fernandez de Alba <sneridagh@gmail.com>

import sys, getopt

sys.path[0:0] = [
  '/var/plone/genwebupcZEO/produccio/eggs/collective.recipe.backup-1.3-py2.4.egg',
  '/var/plone/genwebupcZEO/produccio/eggs/zc.buildout-1.4.2-py2.4.egg',
  '/var/plone/genwebupcZEO/produccio/eggs/zc.recipe.egg-1.2.2-py2.4.egg',
  '/var/plone/genwebupcZEO/produccio/eggs/setuptools-0.6c11-py2.4.egg',
  ]

import collective.recipe.backup.repozorunner

argv = sys.argv[1:]
try:
    opts, args = getopt.getopt(argv, "l:k:", ["location=", "keep="])
except getopt.GetoptError:
    print "neteja.py -l [directori_desti] -k [numero_fulls_a_mantenir]"
    sys.exit(2)

for opt, arg in opts:
    if opt in ("-l", "--location"):
        location = arg
    elif opt in ("-k", "--keep"):
        keep = arg

if len(opts)<2:
    print "neteja.py -l [directori_desti] -k [numero_fulls_a_mantenir]"
    sys.exit(2)

collective.recipe.backup.repozorunner.cleanup(location, keep) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-24T06:51:57.257

您的 FileStorage 备份策略很好。但是，备份任何将数据存储在多个文件中的数据库从来都不是一件容易的事，因为您的副本必须在不写入各种文件的情况下进行。对于 FileStorage，盲目的愚蠢副本很好，因为它只是一个文件。（使用 repozo 更好。）

在这种情况下（结合 BlobStorage 和 FileStorage）我必须指出常规备份建议：

*   在制作文件系统副本时使数据库脱机
*   使用 LVM 之类的快照工具在给定点冻结磁盘
*   进行交易出口（在实践中不可行）

# javascript - 多行 JavaScript 文本

> ID：451954
> 
> 赞同：4
> 
> 时间：2009-01-16T20:51:10.023
> 
> 标签：javascript, html, newline

我有一个很长的 HTML 片段，我希望一些 javascript 变量相等，并且为了可维护性，我想用实际的换行符存储它，而不是添加 \n （或者因为它是 HTML 只是省略换行符）。在 Python 中，我会执行以下操作：

```
largeString = """Hello
This is long!""" 
```

那会很完美。但是，我还没有看到在 JavaScript 中执行此操作的方法。

一些附加信息：javascript 位于外部 .js 文件中，并且代码段确实非常大（~6kb）。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-16T20:56:51.900

在每一行的末尾放置一个 \。或者将其存储在具有 display:none 的 div 中，然后使用 .html() 检索它

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-16T20:58:50.850

JavaScript 不以同样的方式支持多行字符串。

您可以使用`\`为您的脚本转义换行符，但这仅适用于开发人员阅读，因为它不会保留在字符串中（并且大多数验证器会为它抛出错误）。要在字符串中保留换行符，您仍然需要使用`\n`.

如果你想要可读性，你可以组合它们：

```
var largeString = '"Hello\n\
This is long!"'; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-11-23T17:02:58.250

这适用于 Firefox、IE、Safari 和 Chrome：

```
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min.js"></script>
<div class="crazy_idea" largeString='Hello
This is long!'
></div>
<script type="text/javascript">
    alert($(".crazy_idea").attr("largeString"));
</script> 
```

# python - 在 python 子类中将方法设为私有

> ID：451963
> 
> 赞同：28
> 
> 时间：2009-01-16T20:53:50.157
> 
> 标签：python, oop, inheritance

是否可以在子类中将公共方法设为私有？我不希望扩展这个类的其他类能够调用某些方法。这是一个例子：

```
class A:
    def __init__(self):
        #do something here

    def method(self):
        #some code here

class B(A):
    def __init__(self):
        A.__init__(self)
        #additional initialization goes here

    def method(self):
        #this overrides the method ( and possibly make it private here ) 
```

从现在开始，我不希望任何从 B 扩展的类能够调用`method`. 这可能吗？

编辑：一个“合乎逻辑”的原因是我不希望用户以错误的顺序调用方法。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2011-05-01T22:26:19.290

与这个主题的流行时尚相反，**有**区分公共、私有和受保护成员的正当理由，无论您是在 Python 还是更传统的 OOP 环境中工作。很多时候，您会在某种对象专业化水平上为特别冗长的任务开发辅助方法。不用说，您真的不希望任何子类继承这些方法，因为它们在专门的上下文中没有意义，甚至不应该是可见的；然而它们是可见的，它们减少了诸如标签补全、对象导航器和其他系统软件之类的东西的实用性，因为所有不同抽象级别的东西都被扁平化并组合在一起。请注意，这些编程辅助工具并非微不足道。如果你是一名学生并且喜欢做同样的事情一百万次，它们只是微不足道的，因为你'

Python 在历史上的发展方式是，由于意识形态惯性和兼容性问题，实现公共/私有区分变得越来越困难。这是显而易见的事实。改变他们一直在做的事情对每个人来说都是一件非常头疼的事情。因此，我们现在有一百万的 Python 粉丝，他们都读过相同的一两篇原创文章，明确地认为公共/私人的区别是“非 Python 的”。这些人，由于缺乏批判性思维或对广泛的常见做法的公平性，立即利用这个机会来增加一系列可预测的辩护词——De *Defensione Serpentis——*我怀疑这不是来自对*通过 pythonis的合理选择*（pythonic 的方式）但是由于忽略了其他语言，他们要么选择不使用，要么不熟练使用，要么因为工作而无法使用。

正如有人已经说过的那样，在 Python 中产生类似于私有方法的效果的最好方法是在方法名称前面加上`__`（两个下划线）。另一方面，这实际上完成的唯一一件事就是在对象的`__dict__`. 例如，假设您有以下类定义：

```
class Dog(object):
    def __bark(self):
        print 'woof' 
```

如果你跑`dir(Dog())`，你会看到一个奇怪的成员，叫`_Dog__bark`. 事实上，这个技巧存在的唯一原因是为了规避我之前描述的问题：即防止继承、重载和替换超级方法。

希望将来会有一些私有方法的标准化实施，当人们意识到组织不需要使用单个细胞复制 DNA 的方法时，有意识的头脑需要不断地弄清楚如何修复其组织和内部器官.

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2009-01-16T21:09:56.567

没有办法在 Python 中真正做到这一点。相当不合情理，它是。

正如圭多所说，我们在这里都是同意的成年人。

[这是对 Python 中所有内容公开背后的哲学](http://mail.python.org/pipermail/tutor/2003-October/025932.html)的一个很好的总结。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-01-16T22:42:42.653

您可以使用单下划线或双下划线作为方法和成员的前缀。单下划线意味着“请不要使用我，我应该只被这个类使用”，双下划线指示 Python 编译器将方法/成员名称与类名混淆；只要类及其子类的名称不同，方法/成员就可以被认为是“私有的”。

但是，到目前为止，您的要求的解决方案是编写清晰的文档。如果您不希望您的用户以错误的顺序调用方法，请在文档中说明。

毕竟，即使是 C++ 私有也不是那么私有。例如想想老把戏：

```
#define private public
#include <module> 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-01-16T22:09:27.867

我很惊讶没有人提到这一点，但是在方法名称前加上一个下划线是将其标记为“私有”的正确方法。当然，这并不是真正的*私密*（如其他答案中所述），但您就可以了。

```
def _i_am_private(self):
    """If you call me from a subclass you are a naughty person!""" 
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2009-01-16T21:11:46.190

Python 作为源代码分发。私有方法的想法非常没有意义。

想要扩展的程序员`B`，因隐私问题而受挫，查看`B`源代码，将源代码复制并粘贴`method`到子类`C`中。

你通过“隐私”获得了什么？您所能期望的最好的结果就是让您的潜在客户无法进行复制和粘贴。

在最坏的情况下，他们会丢弃您的包裹，因为他们无法扩展它。

是的，所有开源都以一种或另一种方式扩展。您无法预见您编码的所有内容和所有用途。当代码作为源代码分发时，很难防止将来使用。

请参阅[如何保护 Python 代码？](https://stackoverflow.com/questions/261638/how-do-i-protect-python-code)

* * *

**编辑** “白痴”代码。

首先，python 90% 的时间都是作为源代码分发的。因此，任何下载、安装、然后拒绝阅读 API 指南并乱序调用方法的白痴仍然可以找出问题所在。

我们有三类白痴。

*   拒绝阅读 API 指南（或略读并忽略相关部分）并无视文档而乱序调用方法的人。您可以尝试将某些内容设为私有，但这无济于事，因为他们会做错其他事情——并抱怨它。[我不会说出名字，但我曾与那些似乎花了很多时间不正确地调用 API 的人一起工作。另外，你会在 SO 上看到这样的问题。]

    您只能通过他们可以剪切和粘贴的工作代码示例来帮助他们。

*   对 API 感到困惑并以你能想象到的各种不同方式调用方法的人（有些你不能。）你可以尝试将某些东西设为私有，但他们永远不会得到 API。

    您只能通过提供工作代码示例来帮助他们；即使那样，他们也会错误地剪切和粘贴。

*   拒绝你的 API 并想要重写它以使其成为“白痴证明”的人。

    您可以为他们提供一个工作代码示例，但他们不喜欢您的 API 并且会坚持重写它。他们会告诉你你的 API 很疯狂，而且他们已经改进了它。

    你可以让这些人参与不断升级的“防白痴”军备竞赛。你把所有东西放在一起，它们就会分开。

在这一点上，隐私为您做了什么？有些人会拒绝理解它；有些人对此感到困惑；有些人想解决它。

公开怎么样，让那些你称之为“白痴”的人从你的代码中学习？

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-01-16T21:16:58.050

这可能是一个公平的近似值。“救援”的词法作用域：

```
#!/usr/bin/env python

class Foo(object):
    def __init__(self, name):
        self.name = name
        self.bar()

    def bar(self):
        def baz():
            print "I'm private"
            print self.name

        def quux():
            baz()

        self.quux = quux

if __name__ == "__main__":
    f = Foo("f")
    f.quux()

    g = Foo("g")
    g.quux()

    f.quux() 
```

印刷：

```
I'm private
f
I'm private
g
I'm private
f 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2009-01-19T16:03:19.377

“一切都必须公开”的支持者认为作者试图向用户隐藏有用的 API。这家伙不想违反一条毋庸置疑的 Python 法则。他想使用一些方法来定义一个有用的 API，并且他想使用其他方法来组织该 API 的实现。如果两者之间没有区别，并不意味着作者不是白痴。这意味着作者懒得实际定义 API。

在 Python 中，不是将属性或方法标记为私有，而是可以将它们`_`作为一个较弱的“内部使用”指示符作为前缀，或者`__`作为一个稍强的指示符作为前缀。在一个模块中，名称可以以`_`相同的方式加上前缀，您也可以将构成模块公共 API 的字符串序列放在一个名为`__all__`.

愚蠢的一致性是小头脑的妖精。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2009-01-17T16:19:59.290

将继承的方法从 public 更改为 private*会破坏继承*。具体来说，它打破了 is-a 关系。

想象一个具有开门公共方法的餐厅类（即，现在是晚餐时间，我们想将前门标志从关闭翻转为打开）。现在我们想要一个餐饮类，它可以共享餐厅的许多实施细节（他们都需要厨师、厨房、菜肴、食品供应商，甚至可能还有服务员），但没有用餐区、前门或敞开的门方法。从餐厅继承是错误的！看起来您需要做的就是将 open-doors 方法更改为私有方法，因此没有人可以使用它，但是“任何 Catering 对象都是餐厅”是错误的，因为餐厅的公共接口的一部分是开门的。最好通过添加一个新的基类来重构 Restaurant，然后 Restaurant 和 Catering 都从它派生。

具有受保护或私有继承概念的语言仅支持这种继承思想以用于实现，但 Python 不是其中之一。（在那些语言中也没有用，除了很少。）通常当寻求非公共继承时，包含（又名“有关系”）是更好的路径，您甚至可以使属性受保护或私有。

Python 拼写用单前导下划线保护，私有用双前导下划线保护，修改了 Triptych 的回答中提到的“同意的成年人”哲学。您的类的“危险”属性和方法，例如可能导致数据丢失的属性和方法，应该是非公共的（是否使它们受到保护或私有受其他因素影响），公共方法用于提供更简单、更安全的接口。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2009-01-16T20:56:31.260

要使方法具有私有性，您可以像这样命名-mangle 方法：

```
class Foo:
    def __blah():
        pass

class Bar(Foo):
    def callBlah():
        self.__blah() # will throw an exception 
```

但是如果子类真的想的话，他们仍然可以通过自省找到你的方法。

但是 Python（经过深思熟虑的设计和选择）没有私有成员的概念。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-02-08T17:27:58.513

即使在同意的成年人中，您也有理由不希望将方法公开给派生类。问题是，我是否可以有一个像 Parent > Child 这样的层次结构，其中用户可以从 Parent 或 Child 派生，但不会暴露任何私有或受保护的方法。在以下示例中， Child 显式重载 Parent.__private 而不公开它。

```
class Parent(object):
    def __private(self):
        print 'Parent'

    def go(self):
        self.__private()

class Child(Parent):
    def __init__(self):
        Parent.__init__(self)
        self._Parent__private = self.__private

    def __private(self):
        print 'Child' 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2013-11-02T08:32:17.323

```
class MyClass(object): 
    def _prtectedfunc(self):
        pass # with one undersocre

    def __privatefunc(self):
        pass # with two undersocre 
```

[http://linuxwell.com/2011/07/21/private-protected-and-public-in-python/](http://linuxwell.com/2011/07/21/private-protected-and-public-in-python/)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2019-01-12T01:19:51.923

这个线程中有很多很好的答案，但从实际的角度来看，这里有一些固执己见的答案：

您*确实*需要避免来自公共 API、智能感知、文档`import *`等的私有成员的垃圾。因此，请始终将 _ 或 __ 附加到这些成员。

最大的问题：应该是_还是__？纯粹的 OOP 观点是始终将 __ 附加到私有成员，将 _ 附加到受保护的方法。__ 确实进行了名称修改，并且难以使用诸如 setattrib、测试框架之类的东西并降低了可读性。所以我个人的看法是尽量避免使用__，将_用于私有成员。

但是我们希望派生类使用但不作为公共 API 的受保护成员呢？我的偏好是完全不使用下划线。这允许这些成员进入公共文档。然后，我们依靠 docstring 告诉用户这些是受保护的成员，如下所示：

```
class Class1:
  def _private1():
    pass

  def protected1():
    """(for derived classes) Does XYZ."""
    pass

  def public1()
    pass 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2019-01-12T00:50:08.170

这个线程中有很多很好的答案，但从实际的角度来看，这里有一些固执己见的答案：

您确实需要从公共 API 中隐藏（也称为文档）低级变量和方法。因此，请始终将 _ 或 __ 附加到这些成员。更大的问题：应该是_还是__？纯粹的 OOP 观点是始终将 __ 附加到私有成员，并将 _ 附加到“受保护”方法（即可访问，可从派生类覆盖）。__ 确保派生类不能覆盖它。另一方面，它也使使用诸如`setattr`可测试性和可读性之类的东西变得困难。

我个人的观点（以及[谷歌的风格指南](http://google.github.io/styleguide/pyguide.html)）是尽可能避免使用 __ 并将 _ 用于私人成员。

但是受保护的成员呢？我们如何告诉我们的图书馆用户他们必须/应该覆盖什么？在这里，我不喜欢对受保护的成员使用下划线，而是依赖于文档字符串注释，并且可以选择`@abstractmethod`在基类中使用。这里的一个优点是，受保护的成员不会从各种文档生成器中删除。

# sql - 为什么按 news_date 的顺序从 news_table 中选择 Top 5 不起作用？

> ID：451966
> 
> 赞同：1
> 
> 时间：2009-01-16T20:55:17.237
> 
> 标签：sql, ms-access

我有一个 MS Access 似乎不喜欢的非常简单的 SQL 字符串。

> 从 news_table 中选择前 5 个 * 按 news_date 排序

这将返回 news_table 中的所有行，而不仅仅是 Top 5。

我以为这是一个简单的 SQL 语句，显然不是。

关于为什么这不起作用的任何修复或想法？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-16T21:01:26.820

Select Top n 选择记录相等的所有记录，即如果选择 Top 2，并且有 20 个 date1 和 20 个 date2，将选择 40 条记录。

如果有关键字段，

```
 Select Top 5 * Order By KeyField 
```

应该返回 5 条记录，因为 keyfield 是唯一的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-16T21:04:34.160

这行得通吗？

```
select top 5 * 
from (select * from news_table order by news_date) 
```

我不知道为什么原来的不起作用。也许这是 Access 的一个怪癖。

编辑：未指定业务规则。我没有完全理解目标是排在第一位并获得前 5 个日期。可能是获取前 5 条记录，然后对它们进行排名。

我无法在我的 Access 版本中重现您的问题。奇怪的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-16T21:06:43.157

过去，我在 Access 中遇到过类似的声明。为了调试类似的问题，我总是将查询分解为多个查询。我建议在访问中创建一个查询，该查询使用 order by 语句进行选择。然后从该查询中执行 select top。

Query1 => SELECT * FROM news_table 按 news_date 排序；

Query2 => 从 Query1 中选择前 5 个；

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-01-16T21:49:36.193

我几乎从不使用`*`. 我想知道也许 Jet SQL 没有正确解析它。你有没有尝试过：

```
SELECT TOP 5 news_table.* FROM news_table ORDER BY news_date 
```

那将是我一直写它的方式。

是的，`SELECT TOP 5 *`应该有效，但如果没有，也许更具体一点会有所帮助。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-01-16T21:00:53.030

尝试

```
Select Top 5 From news_table Order By news_date 
```

# windows - Windows TraceRt 报告的数字是什么意思

> ID：451967
> 
> 赞同：17
> 
> 时间：2009-01-16T20:55:50.247
> 
> 标签：windows, networking, traceroute

我需要创建一个跟踪路由作为 .NET 应用程序的一部分以支持故障排除。我已经弄清楚如何使用 .NET Ping 类进行跟踪。我不明白命令行实用程序报告的数字是什么。这是 Windows 命令行中“tracert yahoo.com”的审查结果：

跟踪到 yahoo.com [206.190.60.37] 的路由最多 30 跳：

```
 1    <1 ms    <1 ms    <1 ms  xx.xx.xx.xx
  2     7 ms    <1 ms    <1 ms  yy.yy.yy.yy  
  3    42 ms    37 ms    41 ms  zz.zz.zz.zz  
  4    38 ms    37 ms    37 ms  aa.aa.aa.aa  
  5    36 ms    36 ms    36 ms  bb.bb.bb.bb
  6    42 ms    41 ms    41 ms  cc.cc.cc.cc  
 --- more lines deleted --- 
```

第一列是索引，接下来的三列是以毫秒为单位的时间。我在网上搜索了一个解释并且已经干了。我认为它们可能是最小、平均和最大数字，但第 2 行似乎与这个想法相反。

乔恩·斯通卡什

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-01-16T21:02:33.043

我在[Wikipedia](http://en.wikipedia.org/wiki/Traceroute#Implementation)上查看了这个 - 发送了三个数据包，报告的毫秒数是针对每个数据包的。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-01-16T21:15:50.190

Tracert 将多组 ping 发送到目的地。第一组的生存时间 (TTL) 为 1。one 的 TTL 设置会导致第一个路由器将错误消息发送回您的计算机。您的计算机执行 IP 地址的 DNS 查找，然后显示路由器的主机名。然后程序增加 TTL 并发送另一组 ping 以检索下一个路由器的信息。重复这个过程，直到到达终点。

第一列是到目的地的跳数（最多 30 个）。接下来的三列是接收响应的时间量。最右边的列显示沿路径的路由器信息。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-16T21:01:33.573

如果我没记错的话，tracert 会对沿途的每个设备进行 3 次 ping（实际上不是对设备执行 ping，但实际上是相同的），这 3 次只是对每个设备的三个不同 ping 时间。例如，如果您在列表中发现有一个或多个超时的设备，则该设备可能过载并导致问题。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2014-04-23T03:52:40.073

基本上，tracert 向每一跳发送 3 个数据包。第二、三、四列是 RTT 的缩写，即 Round Trip Time，表示数据包到达跃点并返回的时间。

[http://customer.comcast.com/help-and-support/internet/run-traceroute-command/](http://customer.comcast.com/help-and-support/internet/run-traceroute-command/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-01-17T21:35:59.477

这里也是对traceroute结果的快速解释：

[http://www.ehow.com/way_5148131_understanding-traceroute-results.html](http://www.ehow.com/way_5148131_understanding-traceroute-results.html)

# caching - 清除 Plone 的 CSS 缓存的最佳方法是什么？

> ID：451981
> 
> 赞同：6
> 
> 时间：2009-01-16T20:59:26.840
> 
> 标签：caching, plone

我在 Apache 缓存反向代理后面使用 Plone 和 CacheFu。Plone 将多个 CSS 文件合并到一个文件中，例如 name-of-css-file-cachekey1234.css，其中 1234 是一个随机数，文件系统上的 CSS 更改可能需要一个小时才能显示在网站上。如何通过启用 CSS 调试模式更快地看到这些更改而不减慢我的网站速度？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-17T20:13:16.137

点击portal_css中的Save按钮，你会得到一个新的CSS文件。

这正是该功能存在的原因，以便您可以积极缓存，并在需要时仍然获得更新的 CSS 文件。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-16T21:00:42.123

在 ZMI 中，如果您访问 portal_css（CSS 注册表）并点击保存而不更改任何选项，则会出现一个新的缓存键####，并且新的 CSS 规则会显示在站点上。

# c++ - 为什么 cout << 不能与重载的 * 运算符一起使用？

> ID：451983
> 
> 赞同：5
> 
> 时间：2009-01-16T20:59:54.483
> 
> 标签：c++, operator-overloading

我正在创建我的第一堂课，主要由 Overland 的 C++ without Fear 指导。我已经使重载的朋友 ostream 运算符<<，它工作正常。我还重载了 * 运算符，并且效果很好。当我尝试直接输出 * 运算符的结果时不起作用：

```
BCD bcd(10);  //bcd is initialised to 10
BCD bcd2(15); //bcd2 is initialised to 15
cout << bcd;  //prints 10
bcd2 = bcd2 * 2; //multiplies bcd2 by 2
cout << bcd2; //prints 30

cout << bcd * 2 //SHOULD print 20, but compiler says
//main.cpp:49: error: no match for 'operator<<' in 'std::cout << BCD::operator*(int)(2)' 
```

有关信息，这是我的原型：

```
BCD operator*(int z);
friend ostream &operator<<(ostream &os, BCD &bcd); 
```

据我所知， operator* 返回一个 BCD，所以 operator<< 应该能够打印它。请帮忙！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-16T21:03:53.383

正在发生的事情`bcd * 2`是生成一个临时的`BCD`，它不能绑定到一个`BCD &`. 尝试用以下`<<`之一替换运算符：

```
friend ostream &operator<<(ostream &os, const BCD &bcd); 
```

或者

```
friend ostream &operator<<(ostream &os, BCD bcd); 
```

甚至

```
friend ostream &operator<<(ostream &os, const BCD bcd); 
```

The first one works, since binding a temporary variable to a constant reference is explicity allowed, unlike binding to a non-const reference. The other ones work by making a copy of the temporary variable.

Edit: As noted in the comments - prefer the const & version in most cases, since modifying an object in a streaming operator will be surprising to anyone using your class. Getting this to compile may require adding `const` declarations to your classes member function where appropriate.

# testing - 测试固件

> ID：451984
> 
> 赞同：2
> 
> 时间：2009-01-16T21:00:03.187
> 
> 标签：testing, firmware

这遵循了[其他几个](https://stackoverflow.com/questions/448513/starting-a-microcontroller-simulator-emulator) [问题](https://stackoverflow.com/questions/448580/interpreting-assembly-code)（但我认为我已经更好地完善了我的问题）。

我想在安装设备之前测试我的固件代码。

我意识到很多人编写他们的代码、上传、测试等。但我真的很想在上传之前编写和测试（主要是因为我想自动化许多场景）。

那么，这样做的最佳方法是什么。如果我正在编写纯软件，例如根本没有固件，我会使用 cppunit 来解决它（例如）。但是我对这个固件有点迷茫。

有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-16T23:57:39.850

我认为标记为“正确”的答案根本不正确或完整。

对于固件代码，您确实必须进行严格的两管齐下的测试。

1.  使用模拟器完成的初始测试。这是理想的，但假设您可以获得目标平台的良好模拟器。

2.  在实际硬件上进行测试，但在测试台框架中。也就是说，您在实际设备上进行测试，但使用额外的硬件（即示波器、探头）和其他连接来允许对正在发生的事情进行适当的跟踪/调试。

对于固件，最困难的错误通常与时间相关，并且只有在您使用实际硬件时才会出现。在最坏的情况下，实际的探测行为可以改变时间，这样错误就不会出现——仅在“生产”版本中。然后你就玩得很开心。

干杯，

-理查德

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-16T21:07:09.537

好吧，如果不知道您的代码是如何架构的，很难说，但基本上您可以像其他软件一样在类/功能级别测试软件。任何与设备接口的代码很可能需要通过仿真进行测试。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-16T21:09:41.047

许多嵌入式设备都有可用的软件模拟器，但它确实取决于设备。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-30T12:33:04.010

您应该尽可能多地对您的类进行单元测试，但归根结底，您必须运行它并在硬件中对其进行测试。

要在设备中测试您的固件，请编写一个调试接口，以便您可以使用诸如[procomm 之](http://www.procomm-guide.com/)类的终端仿真器与您的设备通信。然后，当您编写功能时，您的调试接口可以调用类中的方法，这样您就可以在设备本身中专门测试您的代码。

完成后，您可以在终端模拟器中编写脚本来自动进行测试。

# html - 如何在 Windows Web 服务器上动态更新纯 html 文件中的变量

> ID：451993
> 
> 赞同：0
> 
> 时间：2009-01-16T21:02:37.130
> 
> 标签：html, asp-classic, include

我们在网站上有一些旧的 html 文件，页面底部有版权年份（来自包含文件）。我们正在尝试找到一种将其动态更新到当前年份的方法，因此不需要每年都编辑包含文件。我们在同一台服务器上使用 asp 和 .net，因此可能有办法使用这些技术来实现这一点。

我正在考虑几种可能实现这一目标的方法，但我确信我错过了一些东西。也许可以完成某种令牌替换或其他事情。

以下是我正在考虑的几个选项。

1.  服务器上的一个进程，它将每天检查一次年份更改并重写包含文件，或者每年由计划任务触发一次。

2.  一个 Web 应用程序，在访问时会检查当前年份并将其写入包含文件。它需要写入磁盘的权限。然后使用 wget 之类的东西访问它，每年一次的计划任务或在时间到时手动访问它。

3.  将 javascript 作为非 asp 包含文件的一部分嵌入，这些文件将在页面完成加载之前动态更新年份。这是实现这一目标的最简单方法之一，但可能不是最好的。

4.  找到一种在嵌入文件之前处理文件的方法。

5.  对 html 文件启用 asp 处理。这是不可取的，因为它可能会导致服务器负载。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-17T06:01:15.340

转换为 ASP 经典（只需更改文件扩展名），使用此：

```
<%=DatePart("yyyy", Now())%> 
```

不管你做什么，做服务器端。使用 Javascript，您依赖于用户的系统时钟。在涉及任何类型的法律问题时，将控制权交给用户都不是一个好主意。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-16T21:12:58.653

嗯..每年调整包含文件要花多少钱？

开发、测试和调试解决方案的成本是多少？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-18T12:32:44.303

您可以创建一个批处理文件，根据当前日期生成包含文件。然后从计划任务中定期调用该批处理文件。

例如具有以下内容的批处理文件，将版权声明写入“c:\copyright.inc”：

```
echo Copyright (C) %date:~6,4% - My Company > c:\copyright.inc 
```

请注意，这适用于 DD.MM.YYYY 日期格式。对于 YYYY/MM/DD 日期格式，您可能必须将“~6,4”部分更改为“~0,4”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-17T08:02:45.330

IANAL，但我质疑自动生成的版权声明是否有效？

如果您要声明版权，我认为您至少可以自己做正确的日期，而不是将其留给计算机。

下一个最好的办法是放一个版权声明，未注明日期。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-16T21:07:22.690

假设您想将它们保留为 HTML 而不是某种动态语言（这听起来是个好主意），我会将它们全部转换为使用服务器端包含，修改所有 HTML 文件（一次性）以包含版权信息然后把它放在一个包含文件中。然后，每年您只需要更新一个文件，这可以很容易地实现自动化。

# html - HTML 5 参考实现

> ID：451996
> 
> 赞同：6
> 
> 时间：2009-01-16T21:03:49.420
> 
> 标签：html, google-gears, firefox-3

我正在寻找一篇关于 HTML 5 究竟是什么或不是什么的好文章或描述。在去年的 Google I/O 上，我一直听说可以将 Google Gears 视为 HTML 5 的参考实现。此后不久，Yahoo 的 BrowserPlus 插件出现了类似的功能。我认为 Firefox 有一些离线支持？再说一遍，这些插件/浏览器是否被认为是 HTML 5 实现，以及 HTML 5 到底涵盖了哪些内容（离线支持？本地数据存储？更好的线程处理？）...

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-16T22:15:01.163

没有 HTML5 参考实现之类的东西。

[http://wiki.whatwg.org/wiki/Implementations_in_Web_browsers](http://wiki.whatwg.org/wiki/Implementations_in_Web_browsers)提供了迄今为止 Web 浏览器已实现的有关 HTML5 的信息。

至于 HTML5 是什么。它既是文档又是应用程序语言，定义了应用程序可以使用的各种 API，包括存储和离线功能。有关详细信息，浏览规范可能是最简单的：http: [//www.whatwg.org/html5](http://www.whatwg.org/html5)

“线程”是一个单独规范的一部分，由基本相同的一组人完成，名为 Web Workers： http: [//www.whatwg.org/ww](http://www.whatwg.org/ww)

（免责声明：我是 WHATWG 成员和 W3C HTML WG 成员。）***********