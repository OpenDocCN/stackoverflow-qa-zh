# StackOverflow 问答 000493000-000493999

# .net - SQL Server：服务器端 Blob 游标？

> ID：493000
> 
> 赞同：1
> 
> 时间：2009-01-29T19:16:27.067
> 
> 标签：.net, sql-server, binary-data

我想从 blob 中读取二进制数据，使用它周围的 Stream 接口。

但我不希望 Blob 必须完全加载到客户端并存储在内存或文件中。

我希望使用 blob 的代码能够查找和读取，并且仅通过网络传输支持查找/读取所需的尽可能多的数据。

即***假装***blob 是一个 250MB 的 Photoshop 图像。缩略图代码知道如何读取图像的前 8 个字节，识别它是 PSD 文件，寻找包含 3k 缩略图的偏移量，然后读取它。

因此，与其尝试分配 250MB 的内存，或者必须创建一个临时文件，也不必等待 250MB 通过网络传输：假设的 SQLServerBlobStreamServerCursor 类知道如何将数据流量传输到实际请求的数据。

* * *

## 研究

[如何：通过在 ADO.NET 和 Visual Basic .NET 中使用分块读取和写入文件到 BLOB 列，](http://support.microsoft.com/kb/317034) 其中谈到能够以块的形式读取和写入。但是代码是不可读的被切断，我无法忍受。我稍后再看。

[这个人](https://stackoverflow.com/questions/252517/streaming-directly-to-a-database/252526#252526)还提到了一种新的 SQL Server 2005 [ *column* .Write()]3 T-SQL 语法来写入数据 -[可用于以小块写入数据](http://weblogs.asp.net/alessandro/archive/2008/09/22/conserving-resources-when-writing-blob-values-to-sql-server-and-streaming-blob-values-back-to-the-client.aspx)（以避免消耗所有服务器的内存）。也许有一个[*列*]。**Read** () 伪方法

微软有一篇文章：[Conserving Resources When Writing BLOB Values to SQL Server](http://msdn.microsoft.com/en-us/library/3517w44b(VS.80).aspx)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-08-11T21:11:46.420

使用较新版本的 SQL Server，您可以在二进制数据类型和文本上使用带有 SUBSTRING() 函数的纯 SQL。请参阅[http://msdn.microsoft.com/en-us/library/ms187748.aspx](http://msdn.microsoft.com/en-us/library/ms187748.aspx)

要获取图像的大小：

```
select datalength(blobcolumn) from myimages where imgid = 12345; 
```

读取前 8 个字节：

```
select substring(blobcolumn, 1, 8) from myimages where imgid = 12345; 
```

要读取 877 个字节，偏移 115000 到 115876：

```
select substring(blobcolumn, 115001, 877) from myimages where imgid = 12345; 
```

请记住，子字符串函数基于 1 偏移量，而不是 0。

如果您关心列在读取部分之间可能会发生变化，您可以将所有不同的选择放在事务中。

这未经我测试，但旧版本的 MS SQL Server 显然需要使用（现已弃用）READTEXT 动词和 TEXTPTR() 函数。如：

```
select textptr(blobcolumn) from myimages where imgid = 12345; 
```

获取返回的指针值，比如 PTR，并在后续查询中使用它：

```
readtext blobcolumn @PTR 115001 887 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-12-13T14:14:17.977

您可以考虑为此使用新的 Sql Server 2008 FileStream 功能：http: [//msdn.microsoft.com/en-us/library/cc645940.aspx](http://msdn.microsoft.com/en-us/library/cc645940.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-29T19:34:35.733

您将希望将 ADO.NET 的`SqlDataReader`对象与`SequentialAccess`CommandBehavior 一起使用。这将允许您定义缓冲区大小并以块的形式读取数据。

请参阅这篇文章： http: [//msdn.microsoft.com/en-us/library/87z0hy49 (VS.71).aspx](http://msdn.microsoft.com/en-us/library/87z0hy49(VS.71).aspx)

```
byte[] outbyte;
int bufferSize = 8;
SqlDataReader myReader = myCmd.ExecuteReader(CommandBehavior.SequentialAccess);
...
long returnBytes = myReader.GetBytes(1, 0, outbyte, 0, bufferSize); 
```

# mysql - 升级数据库时使用的最佳方法是什么

> ID：493003
> 
> 赞同：2
> 
> 时间：2009-01-29T19:17:22.243
> 
> 标签：mysql, database

我们有一个系统，它有一个包含大约 2Gigs 数据的 Mysql 数据库。

与数据库对话的 PC 应用程序刚刚更新。

有许多表的结构发生了变化，我们需要运行一个转换脚本。

该系统只在办公时间使用

问题：

进行此升级的最佳方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-29T19:21:59.643

1.  等到没有人使用该系统（因为这是您的选择，我计划在几个小时后进行）。
2.  备份数据库。
3.  检查您的备份以确保其正常工作。
4.  仔细检查你的备份。
5.  运行更新脚本。
6.  确保您的日常备份工作仍能完成所需的工作（通常不是问题，但值得花精力检查）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-29T21:30:52.223

其他一些额外的东西。让您的用户知道您将执行此操作，即使是在下班后。当财务人员计划迟到以获取 W2（他们有法定期限）并发现他们无法访问数据库时，他们会变得暴躁。

如果您的数据库允许您将其置于单用户用户模式，请在进行更改之前执行此操作。这样一来，任何迟到的随机人都无法在您进行更改时进行更改。

如果出现问题，请准备好在早上用户回来时恢复。这意味着即使您通常稍后进入，您也需要在开始营业时到场。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-29T19:25:27.453

基本上有两种方法。两者都从设置数据库脱机和创建备份开始。

然后您可以构建新数据库并复制到新数据库。

或者您可以更新每个表/查询。

然后，您可以将数据库重新联机。

# sql-server - 如何从 SQL CLR 函数打印消息？

> ID：493010
> 
> 赞同：35
> 
> 时间：2009-01-29T19:18:01.227
> 
> 标签：sql-server, debugging, trace, sqlclr

是否有相当于

```
PRINT 'hello world' 
```

哪个可以从 CLR (C#) 代码中调用？

我正在尝试在我的函数中输出一些调试信息。我无法运行 VS 调试器，因为这是远程服务器。

谢谢！

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-07-21T04:39:11.853

答案是你不能做相当于

```
PRINT 'Hello World' 
```

从一个`[SqlFunction()]`. 但是，您可以通过`[SqlProcedure()]`using

```
SqlContext.Pipe.Send("hello world") 
```

这与 T-SQL 一致，如果将 PRINT 粘贴在函数中，则会收到错误“在函数中无效使用副作用运算符 'PRINT'”。但是，如果您从存储过程中执行此操作，则不会。

对于解决方法，我建议：

1.  从您的代码中使用**Debug.Print**，并将调试器附加到 SQL Server（我知道这对您不起作用，正如您所解释的那样）。
2.  将消息保存在全局变量中，例如`List<string> messages`，并编写另一个返回 内容的表值函数`messages`。当然，访问`messages`需要同步，因为可能有多个线程同时尝试访问它。
3.  将您的代码移动到`[SqlProcedure()]`
4.  添加一个参数'debug'，当=1时，函数将返回消息作为返回表的一部分（假设有一列带有文本..）

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-29T19:22:10.703

你应该能够做到：

```
SqlContext.Pipe.Send("hello world"); 
```

如果您在 CLR UDF 中运行它，`SqlContext.Pipe`将始终`null`如您所见。没有有效的`SqlPipe`我不相信你可以做你想做的事。

如果这纯粹是出于调试目的，您始终可以在托管代码中打开一个文件并在那里写入您的输出。但是，这要求您的程序集具有`EXTERNAL_ACCESS`权限，而这反过来又要求将数据库标记为可信任的。不一定是我会做或推荐的事情。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-30T19:47:54.710

啊，我明白了... Jsut 澄清一下：如果您有*SqlFunction*则 SqlContext.Pipe 不可用，但是在*SqlProcedure*中它是可用的，您可以使用 Send() 来编写消息。

除了异常消息之外，我还没有找到从 SqlFunction 输出信息的方法。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-08-26T08:42:59.677

SQLCLR 函数——标量用户定义函数 (UDF)、表值函数 (TVF)、用户定义聚合 (UDA) 和用户定义类型 (UDT) 中的方法——当使用上下文连接时（即 ConnectionString = `"Context Connection = true;"`)，受大多数与 T-SQL 函数相同的限制的约束，包括不能`PRINT`或`RAISERROR('message', 10, 1)`. 但是，您确实有一些选择。

在我们讨论这些选项之前，应该声明：

*   您无需切换到使用存储过程。如果想要一个功能，那就坚持一个功能。

*   添加“调试”参数并为此更改输出似乎有点极端，因为 UDF（T-SQL 和 SQLCLR）函数不允许重载。因此调试参数将始终在签名中。如果你想触发调试，只需创建一个名为`#debug`（或类似的东西）的临时表并通过`SELECT OBJECT_ID(N'tempdb..#debug');`使用`"Context Connection = true;"`ConnectionString 进行测试（这很快，可以在安全模式下完成，*并且*是同一会话的一部分，因此它可以看到临时表）。从中得到结果`if (SqlCommand.ExecuteScalar() == DBNull.Value)`。

*   请不要使用全局（即静态）变量。这比必要的复杂得多，并且（通常）要求将 Assembly 设置为`UNSAFE`，如果可能的话，应该避免这种情况。

因此，如果您至少可以将程序集设置为`EXTERNAL_ACCESS`，那么您有几个选择。并且这样做*不需要*将数据库设置为`TRUSTWORTHY ON`. 这是一个非常普遍（也是不幸）的误解。您只需要对程序集进行签名（无论如何这是一个很好的做法），然后`[master]`从 DLL 创建一个非对称密钥 (in )，然后基于该非对称密钥创建一个 Login ，最后授予 Login `EXTERNAL ACCESS ASSEMBLY`。之后（一次），您可以执行以下任何操作：

*   [使用File.AppendAllText (String path, String contents)](https://msdn.microsoft.com/en-us/library/ms143356.aspx)将消息写入文件。当然，如果您无权访问文件系统，那么这将无济于事。如果网络上有可以访问的共享驱动器，那么只要 SQL Server 服务的服务帐户有权在该共享上创建和写入文件，那么这将起作用。如果存在服务帐户没有权限但您的域/Active Directory 帐户有权限的共享，那么您可以将该`File.AppendAllText`调用包装在：

    ```
    using (WindowsImpersonationContext _Impersonate = 
                          SqlContext.WindowsIdentity.Impersonate())
    {
       File.AppendAllText("path.txt", _DebugMessage);
        _Impersonate.Undo();
    } 
    ```

*   连接到 SQL Server 并将消息写入表。它可以是当前/本地 SQL Server 或任何其他 SQL Server。您可以在其中创建一个表，`[tempdb]`以便在下次重新启动 SQL Server 时自动清理它，否则会一直持续到那个时间，或者直到您删除它。进行常规/外部连接允许您执行 DML 语句。然后，您可以在运行该函数时从表中进行选择。

*   将消息写入环境变量。自 Vista / Server 2008 以来，环境变量的大小并没有完全受到限制，尽管它们并不真正处理换行符。但在 .NET 代码中设置的任何变量也将继续存在，直到重新启动 SQL Server 服务。您可以通过读取当前值并将新消息连接到末尾来附加消息。就像是：

    ```
    {
      string _Current = System.Environment.GetEnvironmentVariable(_VariableName,
                                      EnvironmentVariableTarget.Process);

      System.Environment.SetEnvironmentVariable(
          _VariableName,
          _Current + _DebugMessage,
          EnvironmentVariableTarget.Process);
    } 
    ```

应该注意的是，在这 3 种情况下，都假设测试是以单线程方式进行的。如果该函数将同时从多个会话运行，那么您需要一种分离消息的方法。在这种情况下，您可以获得当前的“transaction_id”（所有查询，即使没有 a`BEGIN TRAN`也是一个事务！）对于任何特定的执行应该是一致的（在同一个函数中的多次使用以及如果每个函数都被调用）跨多行的行）。如果使用文件或环境变量方法，您可以将此值用作消息的前缀，如果存储到表中，则可以用作单独的字段。您可以通过执行以下操作获得交易：

```
int _TransactionID;

using (SqlConnection _Connection = new SqlConnection("Context Connection = true;"))
{
    using (SqlCommand _Command = _Connection.CreateCommand())
    {
        _Command.CommandText = @"
SELECT transaction_id
FROM sys.dm_exec_requests
WHERE session_id = @@SPID;
";

        _Connection.Open();
        _TransactionID = (int)_Command.ExecuteScalar();
    }
} 
```

* * *

**有关 T-SQL 和 SQLCLR 函数的附加信息**

下面的列表最初取自 MSDN 页面的[Create User-defined Functions (Database Engine)](https://msdn.microsoft.com/en-us/library/ms191320.aspx#Restrictions)，然后由我编辑，如上所述，以反映 T-SQL 函数和 SQLCLR 函数之间的差异：

> *   用户定义的函数不能用于执行修改数据库状态的操作。
> *   用户定义的函数不能包含以表为目标的 OUTPUT INTO 子句。
> *   用户定义的函数不能返回多个结果集。如果需要返回多个结果集，请使用存储过程。
> *   错误处理受限于用户定义的函数。UDF 不支持 TRY...CATCH、@@ERROR 或 RAISERROR。[*注意：这是在 T-SQL 方面，无论是本机的还是从 SQLCLR 函数提交的。您可以在 .NET 代码中使用 try / catch / finally / throw。*]
> *   用户定义的函数中不允许使用 SET 语句。
> *   不允许使用 FOR XML 子句
> *   用户自定义函数可以嵌套；...嵌套级别在被调用函数开始执行时递增，并在被调用函数完成执行时递减。用户自定义函数最多可嵌套 32 层。
> *   以下 Service Broker 语句不能包含在 Transact-SQL 用户定义函数的定义中：
>     *   开始对话
>     *   结束对话
>     *   获取对话组
>     *   移动对话
>     *   收到
>     *   发送

以下与 T-SQL 函数和 SQLCLR 函数有关：

> *   无法使用打印
> *   不能调用 NEWID() [好吧，除非你`SELECT NEWID()`从一个视图中。但在 .NET 代码中，您可以使用`Guid.NewGuid()`. ]

以下仅适用于 T-SQL 函数：

> *   用户定义函数不能调用存储过程，但可以调用扩展存储过程。
> *   用户定义的函数不能使用动态 SQL 或临时表。允许使用表变量。

相反，SQLCLR 函数可以：

> *   执行存储过程，只要它们是只读的。
> *   使用动态 SQL（从 SQLCLR 提交的所有 SQL 本质上都是临时/动态的）。
> *   从临时表中选择。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-09-12T14:52:39.950

您可以尝试将这些信息通过“xp_logevent”存储过程。您可以将调试信息设置为不同级别的“信息”、“警告”或“错误”。我还尝试将这些调试/错误信息放入事件日志中，但这需要在安全方面进行一些配置，我怀疑我不能在生产中使用它。

# ssis - 如果有多个任务可用，SSIS 如何决定下一个要执行的任务

> ID：493011
> 
> 赞同：1
> 
> 时间：2009-01-29T19:18:25.143
> 
> 标签：ssis, parallel-processing, task

例如，如果我添加四个（空白）脚本任务 A1、A2、B1 和 B2，其中 A2 有一个约束要在 A1 之后运行，B2 有一个约束要在 B1 之后运行，但是 A1 和 B1 都没有约束，那么什么顺序任务会运行吗？

当我尝试这个时，它似乎是 A1，然后是 B1，然后是 A2，然后是 B2。但为什么？这个问题出于好奇。

* * *

编辑添加：

我专门将并行度设置为 1 并添加了消息框，这样我就可以看到它所采用的顺序。它总是采用我上面提到的相同顺序，但很好奇它为什么选择这个顺序是否有任何逻辑。

* * *

它似乎首先完成所有一级（无约束）任务，然后继续执行受限任务。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-03T07:51:13.327

包存储为 XML .dtsx 文件。如果没有约束，对象将按照它们在文件中出现的顺序执行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-29T19:23:45.677

我总是看到这样的事情并行运行。

因此 A1 和 A2 将运行，然后 B1 将在 A1 完成后立即启动，B2 将在 B1 完成后立即启动。

除非您明确设置约束，否则没有什么可以阻止两者同时运行。如果你的脚本任务真的很短或者你限制了并行性，也许它会按顺序运行它们，但我确信选择的顺序不能保证。

# android - 在 Mac OS 上的 eclipse 3.4.1 中运行 Junit 测试的问题

> ID：493028
> 
> 赞同：4
> 
> 时间：2009-01-29T19:23:41.637
> 
> 标签：android, eclipse, macos, junit

在 Mac OS 上的 eclipse 3.4.1 中运行 Junit 测试的问题

我收到此错误：“启动 AllTests”遇到问题。无法连接到虚拟机。

```
!ENTRY org.eclipse.core.net 1 0 2009-01-29 10:07:44.047
!MESSAGE 系统属性 http.nonProxyHosts 已设置为 local|*.local|169.25
4/16|*.169.254/16 由外部来源。此值将使用 th 覆盖
e 来自偏好的值

!ENTRY org.eclipse.jdt.launching 4 120 2009-01-29 10:42:59.295
!MESSAGE 无法连接到虚拟机
!堆栈 0
java.net.SocketException：套接字关闭
        在 java.net.PlainSocketImpl.socketAccept（本机方法）
        在 java.net.PlainSocketImpl.accept(PlainSocketImpl.java:384)
        在 java.net.ServerSocket.implAccept(ServerSocket.java:450)
        在 java.net.ServerSocket.accept(ServerSocket.java:421)
        在 org.eclipse.jdi.internal.connect.SocketTransportService.accept(Socket
运输服务.java:95)
        在 org.eclipse.jdi.internal.connect.SocketTransportImpl.accept（SocketTra
nsportImpl.java:56)
        在 org.eclipse.jdi.internal.connect.SocketListeningConnectorImpl.accept(
SocketListeningConnectorImpl.java:135)
        在 org.eclipse.jdt.internal.launching.StandardVMDebugger$ConnectRunnable
.run（标准VMDebugger.java:107）
        在 java.lang.Thread.run(Thread.java:613)

```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-03-26T18:20:25.717

这就是我解决问题的方法（MacOSX Lion 上的 Eclipse）：

*   转到项目属性-> Java 构建路径-> 库
*   添加 JRE 系统库
*   转到订购和导出选项卡，将 JRE 系统库移到顶部。

希望能帮助到你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-30T06:53:12.743

Eclipse 和 JUnit 通过 IPC（进程间通信）进行通信。在这里，您正在使用带有特定虚拟机的 android。

这个消息`System property http.nonProxyHosts has been set to local|*.local|169.25 4/16|*.169.254/16 by an external source. This value will be overwritten using the values from the preferences`让我想知道。您的 Eclipse 中有一些偏好，它们可能是错误的。尝试在 Eclipse 中删除这些非代理设置。

祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-07-18T22:16:25.283

对于其他有这个问题但没有在他们的 elcipse/Mac OS X Leopard 中尝试与 android 相关的任何东西的人——如果你正在编译 JRE 1.6（即 soylatte 的 hack 版本，因为 Leopards 不自然地支持 Java 1.6），那么什么是有效的对我来说是从 eclipse 中手动删除假的 1.6 虚拟机，然后从 Preferences->Java->installed JREs 添加真正的虚拟机

祝你好运！

# svn - 如何在 Xcode 中配置 Subversion 1.5 支持？

> ID：493030
> 
> 赞同：4
> 
> 时间：2009-01-29T19:23:47.613
> 
> 标签：svn, xcode

根据 iPhone 2.2.1 的发行说明，SDK Xcode 现在正式支持 Subversion 1.5。我已将我的工作副本转换为使用新的 1.5 格式；但是，Xcode 现在将不再跟踪更改。我猜在 Xcode 中的某个地方我必须告诉它使用 1.5 格式。有人找到了吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-07T03:19:53.353

谷歌是你的朋友：

[http://www.lemonteam.com/blog/2008/12/setting-up-subversion-15-on-xcode/](http://www.lemonteam.com/blog/2008/12/setting-up-subversion-15-on-xcode/)

在盲目运行本教程中的代码之前，请注意注释中的错误和警告。我自己没试过，所以不推荐；只是我找到的最佳搜索结果。像 Brock Woolf 一样，我使用版本和命令行，并且对这个工作流程非常满意。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-07T02:40:50.330

我尝试过使用 Xcode 的 SVN 集成，坦率地说，它很糟糕，我建议不要使用它。

我想你会更喜欢一个专门的 Subversion 应用程序，比如**Versions**，这是我最喜欢的 svn 应用程序：[www.versionsapp.com](http://www.versionsapp.com)

如果您不想为版本付费，还有另一种免费的替代方案，称为[SCPlugin](http://scplugin.tigris.org/)

哦，要回答您的问题，不幸的是，您将不得不等到 Apple 更新 Xcode 以支持新版本，考虑到他们用 5 年时间在 Mac 上为我们提供 Java 1.6 的记录，在不久的将来不太可能.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-29T21:56:08.430

发行说明中没有任何内容表明 Xcode 带有 svn 1.5，只是它可以与它一起使用。

我猜Xcode使用已经安装的svn 1.4。也许你必须在它上面安装 svn 1.5。

# c# - 正则表达式：为什么每个找到的项目都没有分组？

> ID：493033
> 
> 赞同：1
> 
> 时间：2009-01-29T19:24:22.883
> 
> 标签：c#, regex

我有以下文字：

```
<i><b>It is noticeably faster.</b></i> <i><b>They take less disk space.</i> 
```

以及以下正则表达式：

```
(</[b|i|u]>)+(\s*)(<[b|i|u]>)+ 
```

匹配创建以下组：

```
0: </b></i>   <b><i>
1: </i>
2: spaces
3: <b> 
```

如何更改我的正则表达式，以便创建这样的组：

```
0: </b></i>   <b><i>
1: </b>
2: </i>
3: spaces
4: <i>
3: <b> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-29T19:33:33.460

我怀疑你已经得到了你需要的东西——你只需要列举每个组的捕获。这是一个示例程序，显示了它的实际效果：

```
using System;
using System.Text.RegularExpressions;

class Test
{
    static void Main()
    {
        string text = 
"<i><b>It is noticeably faster.</b></i> <i><b>They take less disk space.</i>";
        Regex pattern = new Regex(@"(</[b|i|u]>)+(\s*)(<[b|i|u]>)+");

        Match match = pattern.Match(text);
        foreach (Group group in match.Groups)
        {
            Console.WriteLine("Next group:");
            foreach (Capture capture in group.Captures)
            {
                Console.WriteLine("  " + capture.Value);
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-29T19:32:17.050

你不能。一个组只能拿着一件东西，即使它在同一场比赛中因为 +、* 或类似的原因击中了不止一件东西。当然，您可以在该组上使用正则表达式或类似的来获取各个项目。

因此，每场比赛每组只有一件事。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-29T19:38:46.553

您只能更改正则表达式，以便匹配空格之前的每个结束标记和空格之后的每个结束标记：

```
((?:</[biu]>)+)(\s*)((?:<[biu]>)+) 
```

这将匹配

```
0: </b></i> <i><b>
1: </b></i>
2: _
3: <i><b> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-29T20:32:32.903

我发现这个网页[http://regexlib.com/RETester.aspx](http://regexlib.com/RETester.aspx "http://regexlib.com/RETester.aspx")对于测试 RegEx 表达式很有用。它可以使用 .Net 引擎或用于 VBScript 或 JavaScript 的客户端引擎进行评估。

我喜欢 RegExLib 的这个在线工具，因为它可以在我使用的任何机器上使用，但是杰克逊在对原始问题帖子的评论中推荐的 UltraPico.com 的 Expresso 应用程序看起来不错。不仅仅是测试，它还有助于构建您的 RegEx。我刚刚下载了它，我要试一试。

现在，如果只有一个工具可以读取复杂的正则表达式，并给出它应该做什么的自然语言描述。特别是如果您可以表明您正在解析 HTML 或某种其他类型的数据格式，以便根据使用情况定制描述。:)

# ruby-on-rails - 如何让多个应用程序使用相同的身份验证系统？

> ID：493045
> 
> 赞同：0
> 
> 时间：2009-01-29T19:29:53.467
> 
> 标签：ruby-on-rails, authentication

我需要为一个客户端构建多个 Rails 应用程序。我想为他们提供所有相同的用户身份验证系统，以便用户不必记住每个应用程序的单独登录凭据。这些是严格的内部应用程序。OpenID 不是该组织的选项。

我正在考虑创建一个中央 Rails 应用程序来处理身份验证。其他应用程序将获取提交的用户 ID 和密码，并向身份验证应用程序发送请求，并返回可能描述用户及其角色的 YAML 字符串。

这是一个合理的方法吗？

我应该注意这个问题的标准解决方案吗？

（请注意，由于组织限制，我必须使用一台运行 MySQL、Apache 和 Rails 的 RedHat Linux 5 服务器自己解决这个问题。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-29T19:43:07.760

对我来说听起来很合理。我可能会按照您的描述自行设置身份验证应用程序，然后在客户端应用程序中使用[ActiveResource](http://api.rubyonrails.org/classes/ActiveResource/Base.html)将身份验证作为 Web 服务进行访问。您基本上可以拥有自己的内部 OpenID 风格的系统。

如果您以前没有使用过 ActiveResource，Railscasts [94](http://railscasts.com/episodes/94)和[95](http://railscasts.com/episodes/95)是一个不错的起点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-29T20:28:31.100

听起来您真正要寻找的是单点登录系统，而不是共享凭证系统。关键区别在于，使用后者，用户必须重新验证每个应用程序，而使用前者，他只需登录一次，然后在应用程序之间无缝移动。

不幸的是，将它集成到您​​的 Rails 应用程序中需要做一些工作。这是一个很好的起点： [http ://www.ja-sig.org/products/cas/](http://www.ja-sig.org/products/cas/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-29T19:45:18.707

这实际上听起来是一种合理的方法。有很多[Rails 插件](http://github.com/technoweenie/restful-authentication/tree/master "Restful-身份验证")可以很好地处理身份验证。您可以通过您自己的自定义身份验证方法公开该功能，以便通过 Web 服务调用。

如果你想变得花哨，你可以使用[HTTParty](http://github.com/jnunemaker/httparty/tree/master "GitHub")为你的 Rails（身份验证）应用程序编写一个 API，并与其他人分享。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-29T20:52:05.203

OpenID 是为去中心化而构建的，因此您实际上*可以*[托管自己的](http://wiki.openid.net/Run_your_own_identity_server)OpenID 提供程序以供内部使用。如果您走类似的路线，我认为没有必要重新发明轮子。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-05T20:29:46.850

我有一个疯狂的解决方案，我一直在考虑我自己需要做的事情。

在 Rails 的默认配置中，它将会话数据作为 cookie 发送给最终用户。在大多数情况下，您应该在会话中放置任何内容，除了已登录和验证的用户的身份，对吗？好的，那么如果您希望看到已登录的每个应用程序在其 config/environment.rb 中使用完全相同的密钥怎么办？这是用于对 cookie 进行签名的 120 个字符左右的字符串，这样用户就无法更改 cookie 并将它们发回而不会被抓到。如果您组中的每个应用程序都具有相同的密钥*并且*他们都在同一个域下，那么所有应用程序都会获得相同的 cookie，并且所有人都会相信他们是发送它的人。每个人都会说，“是的，这是用户 #252。我自己将那个用户号放入会话中，所以我知道那是他。通过取回它，我知道他/她已经登录，我可以用它来查找他的/她的详细信息。”

注意：完全披露，我还**没有**尝试过，但我有充分的理由相信它会起作用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-29T21:14:57.013

听起来组织不是太大，但如果他们有一个 LDAP 目录，您可以将它用于凭据。尽管如上所述，这并不能解决用户必须单独登录每个应用程序的问题。

# python - 我不明白 Python 中的负边界切片。这应该如何工作？

> ID：493046
> 
> 赞同：23
> 
> 时间：2009-01-29T19:31:48.487
> 
> 标签：python, slice

我是 Python 的新手，并且在我的书中遇到了以下示例，该示例没有得到很好的解释。这是我从口译员那里打印出来的：

```
>>> s = 'spam'
>>> s[:-1]
'spa' 
```

为什么切片没有开始绑定并`'-1'`返回除最后一个元素之外的所有元素？call`s[0:-1]`在逻辑上与 call 相同`s[:-1]`吗？它们都返回相同的结果。但我不确定python到底在做什么。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-01-29T19:34:38.387

是`s[0:-1]`的，调用与调用完全相同`s[:-1]`。

在 python 中使用负数作为索引返回列表右侧的第 n 个元素（与通常的左侧相反）。

所以如果你有一个这样的列表：

```
myList = ['a', 'b', 'c', 'd', 'e']
print myList[-1] # prints 'e' 
```

print 语句将打印“e”。

一旦你理解了这一点（你可能已经明白了，不完全清楚这是否是你感到困惑的事情之一），我们就可以开始讨论切片了。

我将假设您了解切片的基础知识`myList[2:4]`（将返回`['c', 'd']`）并直接跳入切片符号，其中一侧留空。

正如您在帖子中所怀疑的那样，`myList[:index]`与`myList[0:index]`.

顺便说一下，这也适用于其他方式...`myList[index:]`与`myList[index:len(myList)]`并且将返回列表中从开始`index`到结束的所有元素的列表（例如`print myList[2:]`将 print `['c', 'd', 'e']`）。

作为第三点，您甚至可以`print myList[:]`在*没有*指示索引的地方进行，这将基本上返回整个列表的副本（相当于`myList[0:len(myList)]`，返回 ['a', 'b', 'c', 'd', 'e' ]）。如果您认为 myList 将在某个时候发生更改，但您希望将其副本保持在当前状态，这可能会很有用。

如果您还没有这样做，我会发现只是在 Python 解释器中乱搞对理解这些事情有很大帮助。我推荐[IPython](http://ipython.scipy.org/moin/)。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2017-01-03T18:28:25.720

```
>>> l = ['abc', 'def', 'ghi', 'jkl', 'mno', 'pqr', 'stu', 'vwx', 'yz&']

# I want a string up to 'def' from 'vwx', all in between
# from 'vwx' so -2;to 'def' just before 'abc' so -9; backwards all so -1.
>>> l[-2:-9:-1]
['vwx', 'stu', 'pqr', 'mno', 'jkl', 'ghi', 'def']

# For the same 'vwx' 7 to 'def' just before 'abc' 0, backwards all -1
>>> l[7:0:-1]
['vwx', 'stu', 'pqr', 'mno', 'jkl', 'ghi', 'def'] 
```

* * *

请不要对清单无精打采。

1.  先写第一个元素。您可以为此使用正索引或负索引。我很懒，所以我使用正数，少一杆（低于 7，或 -3 开始）。
2.  您要停止的位置之前的元素的索引。同样，您可以为此使用正索引或负索引（低于 2 或 -8 表示停止）。
3.  这里标志很重要；当然-向后；你知道的步幅的价值。步幅是一个具有大小和方向的“向量”（低于-1，全部向后）。

    ```
    l = [0,1,2,3,4,5,6,7,8,9]
    l[7:2:-1], l[-3:2:-1], [-3:-8:-1],l[7:-8:-1] 
    ```

    全部导致`[7, 6, 5, 4, 3]`.

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-29T19:40:49.497

例如，负索引从末尾开始计算，因此 s[:-1] 等价于 s[:len(s)-1] 并且 s[-1] 是最后一个元素。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-01-29T19:42:35.250

关键的一点是，python 索引应该被认为是指向列表中条目之间的空格的指针，而不是指向元素本身的指针。因此，0 指向开头，1 指向第一个和第二个之间，... 和 n 指向第 n 个和 (n+1)st 之间。

因此 l[1:2] 为您提供了一个仅包含元素 l[1] 的列表，因为它为您提供了两个指针之间的所有内容。

类似地，负索引指向元素之间，但这次从后面计数，所以 -1 指向最后一个元素和倒数第二个元素之间，因此 [0:-1] 指的是不包括最后一个元素的项目块一。

作为语法糖，您可以从开头省略 0，或者实际上是结尾，因此 l[n:] 指的是从 l[n] 到结尾的所有内容（如果 n>=len(l) 则返回空列表）。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-29T19:35:38.900

是的，调用`s[0:-1]`在逻辑上是一样的，`s[:-1]`因为切片最好定义为：

```
[beginning_index:ending_index] 
```

Python 允许您省略 0，因为这可以让您的代码更简洁。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2019-03-11T03:44:58.010

如果我们想从字符串的后端打印，我们可以使用负索引。索引从 -1 开始。

示例：s = '你好世界'

s[-11:-1] = 'hello worl' s[-1:-11] = '' // 起始值应该更低（即，在这种情况下，-1 大于 -11）如果大于则获胜不打印任何东西。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2019-11-03T18:23:59.760

我将解决其他一些人错过的一点：

**在我们对切片的了解的背景下，我们如何解释这个负指数？**

通常，当我们进行切片时，我们会谈论 [inclusive,exclusive] 边界。所以

```
A = [1,3,4,6]
A[1:3] # will give us 3-1 = 2 elements, index 1 and 2 => [3,4] 
```

因此，当我们在切片中有一个负索引时`A[1:-1]`，这意味着我们有`A[1:len(A)-1]`= `A[1:3]`，这又给了我们索引 1 和 2，因此是`[3,4]`。

请注意，即使列表的长度为 4，它的最后一个索引也是 3，因此这个 -1 表示法在这里可以工作。另请注意，如果您有将负索引作为变量的代码，那么您需要手动检查 0，因为 `A[:-0] == A[:0] == []` `

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2022-02-08T20:01:47.800

**规则** `[START, END, STEP]`或`[START, END]`

*   如果你想按规则顺序切片，`STEP`应该是正数。

*   如果你想要一个倒序的切片，`STEP`应该是负数。

例如：

```
>>> s = 'abcdefg'
>>> s[1:6:1]
'bcdef'     
>>> s[6:1:1]
''     
# If in regular order, s[6:1]='' therefore same for s[6:1:1]
>>> s[6:1:-1]
'gfedc'
# Reverse order, START=6 and END=1, a slice is possible 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2022-03-02T23:12:43.140

**Python 在对列表进行切片时到底在做什么**是在`sliceobject.c`Python 源代码文件中编码的。如果您没有麻烦地清楚地看到下面的代码行都没有给出异常或错误，或者您对切片的结果并不感到惊讶：

```
assert [0,1,2,3][-23: 32]    == [0,1,2,3]
assert [0,1,2,3][ 23: 32]    == []
assert [0,1,2,3][-32:-23]    == []
assert [0,1,2,3][ 23:-23:-1] == [3,2,1,0]
# ---
assert [0,1,2,3][ -1: 3:-1] == []
assert [0,1,2,3][ -1: 2:-1] == [3]
assert [0,1,2,3][ -1: 1:-1] == [3,2]
assert [0,1,2,3][ -1: 0:-1] == [3,2,1]
assert [0,1,2,3][ -1:-1:-1] == []
assert [0,1,2,3][ -1:-2:-1] == [3]
assert [0,1,2,3][ -1:-3:-1] == [3,2]
assert [0,1,2,3][ -1:-4:-1] == [3,2,1]
assert [0,1,2,3][ -1:-5:-1] == [3,2,1,0]
# ---
assert [0,1,2,3][321:-123: 1] == []
assert [0,1,2,3][321:-123:-1] == [3,2,1,0]
assert [0,1,2,3][-123:321:-1] == []
# ---
assert [0,1][None:None][None:][::][:] == [0,1] 
```

您很有可能已经很好地理解了 Python 切片的工作原理。

如果您对给定的一些示例感到惊讶，那么查看 Python 源代码可能有助于解决混淆。我重写了返回开始、停止、步长值的 C 函数，`range()`然后可以使用这些值创建 a 的切片`listL`：

```
[ listL[indx] for indx in range(start,stop, step) ] 
```

在 Python 中并在下面提供。可以对其进行详细研究，以深入了解切片列表背后的机制。我希望它可以帮助您了解在切片列表时乍一看可能令人惊讶或难以掌握负步长和索引的结果。

顺便说一句：如果您想知道如何在使用负步时到达列表的第一个元素，这里有一些选项可以做到：

```
listL = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
assert listL[3:   2: -1] == [3]
assert listL[3:   1: -1] == [3, 2]
assert listL[3:   0: -1] == [3, 2, 1]
...
assert listL[3: -11: -1] == [3, 2, 1, 0]
assert listL[3:None: -1] == [3, 2, 1, 0]
assert listL[3::-1]      == [3, 2, 1, 0]
assert listL[3:-321: -1] == [3, 2, 1, 0] 
```

下面的 Python 脚本代码相当于**sliceobject.c** 文件中处理切片的 C 代码的一部分。请注意，[::] 中的缺失值被转换为**None**以评估切片索引。我在代码中提供了一些注释，以帮助理解内容和原因：

```
# Python-3.9.10_srcCode/Objects/sliceobject.c:354:
#         evaluate_slice_index(PyObject *v)
def evaluate_slice_index(v):
    if v is None:
        return None
    if type(v) is int:
        return v
    if '__index__' in dir(v):
        return v.__index__()
    else:
        raise TypeError(
  "slice indices must be integers or None or have an __index__ method")
#:def 

# Python-3.9.10_srcCode/Objects/sliceobject.c:372:
#         _PySlice_GetLongIndices(PySliceObject *self, PyObject *length,
def _PySlice_GetLongIndices(objSlice, intLength): 
    ''' 
    Compute slice indices given a slice and length.  
    Assumes that intLength is a nonnegative integer 
    '''
    start=None; stop=None; step=None
    upper=None; lower=None

    # Convert step to an integer; raise for zero step.
    if (objSlice.step is None):
        step = 1
        step_is_negative = False
    else:  
        step = evaluate_slice_index(objSlice.step)
        if ( step == 0 ): 
            raise ValueError( "slice step cannot be zero" )
        if step < 0:             
            step_is_negative = True
        else: 
            step_is_negative = False

    # Find lower and upper bounds for start and stop. 
    if (step_is_negative): 
        lower = -1
        upper = intLength + lower
    else: 
        lower = 0
        upper = intLength
    # ^-- this is the 'trick' to cope with the stop value for range() 
    #     providing values not including the stop value. 

    # Compute start: 
    if (objSlice.start == None):
        start = upper if step_is_negative else lower
    else: 
        start = evaluate_slice_index(objSlice.start)
        if ( start < 0):
            start = start + intLength
            if  start < lower: 
                start = lower
                #     ^-- explains how it comes, that any values 
                # for slice indices are OK. 
        else:
            if  start > upper: 
                start = upper
                #     ^-- explains how it comes, that any values 
                # for slice indices are OK. 
    # ^-- this is the 'trick' to get start from deliberate value
    #     into the range within the scope of valid list indices. 
    #     The positive/negative step value case is already handled
    #     by the choice of values for lower and upper. 

    # Compute stop: 
    if (objSlice.stop == None):
        stop = lower if step_is_negative else upper
    else: 
        stop = evaluate_slice_index(objSlice.stop);
        if ( stop < 0): 
            stop = stop + intLength
            if (stop < lower): 
                stop = lower;
        else:
            if (stop > upper):
                stop = upper;
    # ^-- this is the 'trick' to get stop from deliberate value
    #     into the range within the scope of valid stop indices. 
    #     The positive/negative step value case is already handled
    #     by the choice of values for lower and upper. 

    return (start, stop, step) # for range(start,stop,step) which can
    # be used to obtain the slice from a list using:
    #    [ theList[index] for index in range(start, stop, step ]  
#:def 

# Let's check if the code above does the same as the .indices() function
# of the slice object:
listL = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
for start in list(range(-3*len(listL), 3*len(listL))) + [None]: 
    for stop in list(range(-3*len(listL), 3*len(listL))) + [None]: 
        for step in list(range(-2*len(listL), 2*len(listL))) + [None]: 
            objSlice = slice(start,stop,step)
            try: 
                py = objSlice.indices(intLength)
            except:
                try: 
                    Py = _PySlice_GetLongIndices(objSlice, intLength)
                    echo(" STOP: difference in Exceptions")
                    import sys; sys.exit()
                except:
                    continue
            Py = _PySlice_GetLongIndices(objSlice, intLength)
            assert py == Py

listL = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
intLength = len(listL)

# If you ever wondered how to get the first element of a list with 
# a negative step, here two options how it can be done: 
assert listL[3:   2:-1] == [3]
assert listL[3:   1:-1] == [3, 2]
assert listL[3:   0:-1] == [3, 2, 1]
...
assert listL[3: -11:-1] == [3, 2, 1, 0]
assert listL[3:None:-1] == [3, 2, 1, 0]
assert listL[3::-1]     == [3, 2, 1, 0]
assert listL[3:-321:-1] == [3, 2, 1, 0]
# Both [:] and [::] have the same effect: 
assert listL[:]              == [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
assert listL[::]             == [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
objSlice = slice(None,None,None) # equivalent to [::] and [:]
assert listL[objSlice]       == [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
# also all the over variants lead to same result: 
assert listL[None:]          == [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
assert listL[None:None]      == [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
assert listL[None:None:None] == [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]

assert [ listL[indx] for indx in range(2,1,1) ] == []
# ^-- Another 'trick' of slicing is to start with an empty list.
#     If range(start,stop,step) don't deliver any value, an empty 
#     list without any added list elements is returned as result of
#     slicing. Exceptions are raised only on zero step value and
#     inappropriate types for start or stop values of the slice. 
```

# tfs - 构建菜单中的“新团队构建类型”选项在哪里？

> ID：493048
> 
> 赞同：0
> 
> 时间：2009-01-29T19:31:59.373
> 
> 标签：tfs, build-process, build

我正在遵循有关如何在 TFS 中创建新构建类型的说明，它说：

1.  在团队资源管理器中，选择要创建新构建类型的项目
2.  在构建菜单上，选择**新的团队构建类型**

我的构建菜单没有那个选项，它有：

*   排队新建
*   新的构建定义
*   管理构建代理，以及
*   管理构建质量。

这是旧文档还是我的设置错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-30T09:38:55.000

听起来您正在阅读适用于 Visual Studio 2005 与 TFS 2005 对话的文档。构建系统已针对 Visual Studio 2008 完全重新编写，并且得到了很大改进。

有关在 2008 年创建新版本的基本演练，请参阅 MSDN 上的以下内容：

> [http://msdn.microsoft.com/en-us/library/ms181286.aspx](http://msdn.microsoft.com/en-us/library/ms181286.aspx)

祝你好运，

马丁。

# arrays - 将数组初始化为固定长度数组的最佳方法是什么？(C++/CLI)

> ID：493052
> 
> 赞同：2
> 
> 时间：2009-01-29T19:32:19.843
> 
> 标签：arrays, c++-cli, initialization

在托管 C++/CLI 中，我可以像 (1) 一样执行此操作：

```
array<System::Byte>^ css_keycode = {0x51, 0x67, 0x67, 0xc5, 0xe0, 0x00}; 
```

或 (2)：

```
array<System::Byte>^ css_keycode;
css_keycode  = gcnew array<System::Byte>(6) {0x51, 0x67, 0x67, 0xc5, 0xe0, 0x00}; 
```

但我显然做不到（3）：

```
array<System::Byte>^ css_keycode;
css_keycode  = {0x51, 0x67, 0x67, 0xc5, 0xe0, 0x00}; 
```

即使我可以做到（4）：

```
array<System::Byte>^ css_keycode = {0x51, 0x67, 0x67, 0xc5, 0xe0, 0x00};
array<System::Byte>^ css_keycode_shadow;
css_keycode_shadow = css_keycode; 
```

有没有更好的方法让我想念？我想要一种简单/干净的方式来写这样的东西：

```
public ref class decoder {
    array<System::Byte>^ css_keycode;
   ...
    decoder(void) {
        css_keycode = {0x51, 0x67, 0x67, 0xc5, 0xe0, 0x00};
    }
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-09-30T09:15:00.410

您必须区分初始化和分配。就像 Tobias Wärre 在他的帖子中所说的那样。您不能这样做 (3)，因为 assingnment 不适用于*初始化括号*。(4) 确实有效，因为您通常将新值分配给您的数组。实际上以下应该有效：

```
public ref class decoder {
    array<System::Byte>^ css_keycode;
   ...
    decoder(void) {
        array<System::Byte>^ css_keycode_tmp = {0x51, 0x67, 0x67, 0xc5, 0xe0, 0x00};
        css_keycode = css_keycode_tmp;
    }
} 
```

这样，分配的值就会复制到您的数组中。

**编辑：** 不幸的是，没有`swap`像 STL 容器这样的方法（至少我不知道），否则你可以将内容与临时交换。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-06T14:44:59.227

在使用聚合初始值设定项分配数组时，您应该能够跳过 size 参数。例如，以下代码为我编译：

```
public ref class TestIt
{
public:
   TestIt()
   {
      mArray = gcnew cli::array<System::Byte>{0x51, 0x67, 0x67, 0xc5, 0xe0, 0x00};
   }

private:
   cli::array<System::Byte>^ mArray;

}; 
```

您的示例 (3) 不起作用，因为它`gcnew array<type>`是必需的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-29T19:39:24.600

好像你想像这样初始化一个数组

```
(array = {elem1, elem2,etc}) 
```

你需要在声明时这样做。声明也只有局部作用域，即在退出声明数组的函数时不能安全地使用内存，在这种情况下，您需要使用 new 分配内存。在后一种情况下，不要忘记在应用程序不再需要对象时删除它。

因此，如果您仅在本地或从该特定函数调用函数期间需要它，则为 1，如果您在函数退出时在其他地方需要它，则为 2。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-29T20:18:11.497

我认为你坚持（2）。

在 C99 中，您实际上可以使用复合文字来执行 (3)，但我不知道 C++/CLI 中是否有类似的东西。无论如何，这对您的问题没有帮助：在函数体中使用复合文字将堆栈分配，而不是堆分配数组。

对于初始化后的堆分配，没有办法解决`new`, `gcnew`, `malloc()`,...

# reporting-services - SSRS 2008 和 SSAS 2008 传输错误

> ID：493084
> 
> 赞同：3
> 
> 时间：2009-01-29T19:42:50.693
> 
> 标签：reporting-services, ssas, ssrs-2008

我正在测试升级到 SSAS 2008 并验证现有报告是否正常工作。我能够获得一些使用 SSAS 作为数据源的 SSRS 报告来运行而没有任何问题。它们很简单，只有一个数据集。我无法针对 SSAS 2008 正常工作的报告有多个数据集，并且有一个带有数据范围设置作为参数的 fitler 设置。一旦我将该过滤器设置为参数并部署它们，报告就会返回“连接超时或丢失。无法从传输连接读取数据：现有连接被远程主机强行关闭。现有连接被远程主机强行关闭”消息。

有趣的是，当我在 BIDS 中本地运行报告时，它运行良好，如果我将它指向 SSAS 2005 服务器，它在部署后运行良好。一旦我将它指向 SSAS 2008 服务器，它就会失败。我可以让其他报告正常工作，但不能使用这种类型的过滤器设置。我可以看到开始和结束日期参数 MDX 语句在跟踪中运行，但仅此而已。在这些运行之后，我们会收到传输连接消息。

另一个有趣的事情是，在生产环境中，报告工作正常，但是有 SSRS 2005 和 SSAS 2008。这有意义吗？
这可能是什么原因造成的？我也尝试在数据源上设置单个事务级别，但这似乎没有什么区别。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-11T12:09:20.283

事实证明，这是微软现在的一个已知问题。我们至少是第四个记录此问题的客户。它与 Windows Server 2008 和 Kerberos 的使用特别相关。使用 Kerberos 时，它必须处理数据包和校验和计算。我正在与 Microsoft 分析服务支持团队的某个人合作。他们正在与 Windows 团队积极合作，希望能解决这个问题。在那之前，我们需要在 Windows 2003 服务器上运行其中一个组件（SSRS 2008 或 SSAS 2008），因为我们将继续使用 Kerberos 并保持在分布式环境中。这是我昨晚从 MS Support 收到的：

*感谢您确认使用 Server 2003 作为中间层的测试。不幸的是，根据您迄今为止描述的症状，当 Kerberos 身份验证中的客户端和服务器都是 2008 或 Vista 时，这听起来可能是我们一直在看到的一个持续问题。我们目前正在与 Windows 团队积极调查，但到目前为止还没有解决方案，如果这是问题。我们可以通过使用您找到的非 2008 客户端，或者将客户端和服务器放在同一个盒子上，或者避免 Kerberos 身份验证（这需要中间层中的明文身份验证 - 来自客户端的基本身份验证）来解决这个问题使用中间层配置中提供的指定帐户进行匿名身份验证）。*

希望这将在不久的将来得到解决。目前，我们计划在 Windows Server 2003 上运行 SSRS 2008。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T10:01:18.197

作为对此的跟进，我发表了一篇关于此的博客文章，您可以在此处查看 - [Windows Server 2008 Kerberos Bug – SSAS 数据的传输连接问题](https://denglishbi.wordpress.com/2009/03/31/windows-server-2008-kerberos-bug-%E2%80%93-transport-connection-issues-with-ssas-data/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T01:59:16.337

我可以知道您是否在一个盒子上托管您的 SSAS，而在另一个盒子上托管另一个 SSRS？根据您报告的问题，我高度相信这两台服务器之间的端口已被阻止。如果服务托管在同一个盒子上，您可能必须使用“localhost”作为条目。

我个人还没有机会尝试 SSAS，但我是 SSRS 2008 服务的常客。[我在ASPHostDirectory.com](http://www.asphostdirectory.com)上托管了我的 SSRS 2008，到目前为止，一切都很顺利。我能够远程连接到我的报告，并且能够在线管理我的报告。

我没有遇到像您当前遇到的错误消息。但是，当我第一次尝试 FTP 时，我确实看到了“类似”错误。我能够连接到 FTP 服务器，但 FTP 服务器无法显示文件夹并立即终止了我的会话。然后我将我的 FTP 连接模式设置为活动，一切都开始工作了。我知道这个解决方案可能无关紧要，但我想指出的是问题似乎是由防火墙等引起的。

谢谢你。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-23T11:18:01.903

[Windows Server 2008 Kerberos Bug Patch – 解决 SSAS 连接问题](http://denglishbi.spaces.live.com/blog/cns!CD3E77E793DF6178!1718.entry)

一位同事通知我，Microsoft 已发布补丁以修复今年早些时候发现的 AES Kerberos 问题 - [Windows Server 2008 Kerberos Bug – SSAS 数据的传输连接问题](http://denglishbi.spaces.live.com/blog/cns!CD3E77E793DF6178!1214.entry)。我还没有收到这方面的通知，但我查看了 John Tunnicliffe [SSAS 博士的博客文章：Microsoft release fix for “Kerberos kill MDX” issue](http://sqlblogcasts.com/blogs/drjohn/archive/2009/07/18/ssas-microsoft-release-fix-for-kerberos-killing-mdx-issue.aspx)，他提供了下载链接

[http://support.microsoft.com/default.aspx/kb/969083](http://support.microsoft.com/default.aspx/kb/969083)

似乎没有指向此特定下载的官方知识库 (KB) 链接，但根据 John 博士的说法，这确实解决了传输错误的问题。有人告诉我 KB 将是 968700，但根据这些链接，它似乎是 969083。

因此，对于那些因此不得不暂停升级到 Windows Server 2008 的用户，您现在可以下载补丁并继续进行基础架构升级。只需确保在将补丁部署到生产环境之前正确测试补丁即可。

# asp.net - 用于 asp.net 网络表单应用程序的 ui

> ID：493085
> 
> 赞同：0
> 
> 时间：2009-01-29T19:42:55.373
> 
> 标签：asp.net, user-interface, webforms

是否有任何人推荐的专业服务或产品来改进现有 asp.net 网络表单应用程序的用户界面？

所有 Web 控件/元素都使用 css 类，并且有一个单独的 css 文件用于控制外观和感觉。我想让专业设计师改进配色方案/字体/布局，而无需访问代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-29T19:49:05.877

我不确定您将如何在不让他们访问您的代码的情况下雇用某人来改进您的网站的设计 - 除非您愿意并且能够实施某人的设计。

如果只是 CSS 更改，那么您应该能够从[CraigsList](http://www.craigslist.org)聘请一位优秀的网页设计师来“本地”进行 CSS 更改，然后为您提供一个新的 CSS 文件，您可以将其上传到您的网站。

网页设计师经常会创建一个 PhotoShop 文件并将其交给开发人员实施。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-29T20:06:31.287

我同意特拉平的观点。但是，如果该站点已经使用皮肤进行了编码，您可以只给他们皮肤文件并让他们玩弄它。

# javascript - 正则表达式从字符串中去除纬度/经度

> ID：493090
> 
> 赞同：3
> 
> 时间：2009-01-29T19:45:27.663
> 
> 标签：javascript, regex, geospatial

任何人都有一个正则表达式从字符串中删除纬度/经度？如：

编号：39.825 -86.88333

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-29T19:47:32.853

匹配一个值

```
-?\d+\.\d+ 
```

对于这两个值：

```
(-?\d+\.\d+)\ (-?\d+\.\d+) 
```

如果字符串始终具有这种形式：

```
"ID: 39.825 -86.88333".match(/^ID:\ (-?\d+\.\d+)\ (-?\d+\.\d+)$/) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-29T19:53:33.543

```
var latlong = 'ID: 39.825 -86.88333';

var point = latlong.match( /-?\d+\.\d+/g );

//result: point = ['39.825', '-86.88333']; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-29T20:00:32.017

```
function parseLatLong(str) {
    var exp = /ID:\s([-+]?\d+\.\d+)\s+([-+]?\d+\.\d+)/;

    return { lat: str.replace(exp, "$1"), long: str.replace(exp, "$2") };          
}

function doSomething() {
    var res = parseLatLong("ID: 39.825 -86.88333");

    alert('Latitude is ' + res.lat + ", Longitude is " + res.long);
} 
```

# sql - SQL 嵌套选择

> ID：493098
> 
> 赞同：0
> 
> 时间：2009-01-29T19:46:27.130
> 
> 标签：sql, select

我正在尝试构建一个执行以下操作的 sql select 语句：

```
SELECT GetDate() Mon, GetDate() Tues 
```

但我也希望能够对每一列（周一、周二）设置 WHERE 限制。所以我想要这样的东西，但这是不正确的：

```
SELECT (GetDate() Mon WHERE (1=1)), (GetDate() TuesWHERE (1=1)) 
```

请指出正确的方向，谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-29T19:53:11.390

使用列名：

```
select
    (select getDate() where (1=1)) Mon,
    (select getDate() where (2=2)) Tues 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-29T20:01:06.523

GetDate() 只检索当前日期/时间。

因此，您的所有原始查询（以及迄今为止的大多数“答案”）所做的是两次检索当前日期和时间，然后在其上放置“星期一”和“星期二”列标签。

这真的是你想要的吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-29T19:54:03.010

你也许想要一个`CASE`声明？

或者您是否真的想获得最近的星期一/星期二/星期三/等？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-30T10:20:20.750

这是一个将日期时间和星期几作为输入的函数。它返回最近的日期与一周中的那一天。

它假定 DATEFIRST 为 7（使星期天第 1 天）。

```
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[udf_getDateFromDayName]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
DROP FUNCTION [dbo].[udf_getDateFromDayName]
GO

--Set Sunday to be day one
SET DATEFIRST 7
GO

CREATE FUNCTION [dbo].[udf_getDateFromDayName] 
(
    @dtsMaxDate DATETIME,
    @sDayName VARCHAR(8)
)
RETURNS DATETIME
AS
BEGIN

    DECLARE @iDayNumber INT, @dtsTemp DATETIME

    SET @sDayName = LEFT(UPPER(@sDayName),3)

    SET @iDayNumber =
        ( CASE
             WHEN @sDayName = 'SUN' THEN 1
             WHEN @sDayName = 'MON' THEN 2
             WHEN @sDayName = 'TUE' THEN 3
             WHEN @sDayName = 'WED' THEN 4
             WHEN @sDayName = 'THU' THEN 5
             WHEN @sDayName = 'FRI' THEN 6
             WHEN @sDayName = 'SAT' THEN 7
             ELSE 0 --Invalid day
           END
        )

    IF @iDayNumber = 0 RETURN NULL

    SET @dtsTemp = CAST(FLOOR(CAST(@dtsMaxDate AS FLOAT)) AS DATETIME)

    WHILE DATEPART(DW,@dtsTemp) <> @iDayNumber
        SET @dtsTemp = DATEADD (dd, -1, @dtsTemp)

        RETURN @dtsTemp
END

GO 
```

一旦你有了这个功能，你的查询就很简单了。

你可以这样做：

```
SELECT  dbo.udf_getDateFromDayName(GETDATE(),'mon') [Mon],
        dbo.udf_getDateFromDayName(GETDATE(),'tue') [Tue],
        dbo.udf_getDateFromDayName(GETDATE(),'wed') [Wed],
        dbo.udf_getDateFromDayName(GETDATE(),'thu') [Thu],
        dbo.udf_getDateFromDayName(GETDATE(),'fri') [Fri],
        dbo.udf_getDateFromDayName(GETDATE(),'sat') [Sat],
        dbo.udf_getDateFromDayName(GETDATE(),'sun') [Sun] 
```

或者理想情况下，首先将最大日期放入变量中：

```
DECLARE @dtsNow DATETIME
SET @dtsNow = GETDATE()
SELECT  dbo.udf_getDateFromDayName(@dtsNow,'mon') [Mon],
        dbo.udf_getDateFromDayName(@dtsNow,'tue') [Tue],
        dbo.udf_getDateFromDayName(@dtsNow,'wed') [Wed],
        dbo.udf_getDateFromDayName(@dtsNow,'thu') [Thu],
        dbo.udf_getDateFromDayName(@dtsNow,'fri') [Fri],
        dbo.udf_getDateFromDayName(@dtsNow,'sat') [Sat],
        dbo.udf_getDateFromDayName(@dtsNow,'sun') [Sun] 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-29T19:48:24.660

```
SELECT (select GetDate() Mon WHERE (1=1)), (select GetDate() Tues WHERE (1=1)) 
```

# java - Eclipse 不记得源查找路径

> ID：493102
> 
> 赞同：8
> 
> 时间：2009-01-29T19:47:36.677
> 
> 标签：java, eclipse

出于某种原因，Eclipse 不记得某些 java 项目的源查找路径，并且每次在调试期间（重新部署后）我都需要按“编辑源查找路径”按钮并将当前项目添加到列表中。

有谁知道如何让它记住选定的源位置？

**编辑：** 这是一个用 ant 构建的 tomcat 项目。Eclipse 版本是 3.2.2

.classpath 看起来像这样：

```
<?xml version="1.0" encoding="UTF-8"?>
<classpath>
    <classpathentry kind="con" path="org.eclipse.jdt.launching.JRE_CONTAINER"/>
    <classpathentry kind="src" path="src"/>
    <classpathentry kind="output" path="web/WEB-INF/classes"/>
    <classpathentry kind="lib" path="web/WEB-INF/lib/commons-collections-3.2.jar"/>
    ... bunch of libs here
</classpath> 
```

**更新：**我找到了必需的设置 - 它位于 General Preferences -> Tomcat -> Source path 下。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-29T20:15:18.913

尝试查看您正在执行的运行/调试配置，并检查源选项卡。您可以手动添加元素，但确实不建议这样做。

源选项卡中的元素基于包含您运行的元素的项目的类路径。在运行 tomcat 的情况下，源路径仅包含与 tomcat 关联的所有 Web 项目（及其依赖项）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-08-20T10:50:06.560

解决方案是：
Window / Preferences
Tomcat / Source Path

单击您的项目名称。如果您改用另一个项目，请不要忘记更改它！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-29T05:58:28.537

这也可以直接在首选项文件中进行编辑，该文件位于以下位置： `<workspace>\.metadata\.plugins\org.eclipse.debug.core\.launches\<debug configuration name>.launch` 示例：

```
C:\Data\eclipse_ws\workspace\.metadata\.plugins\org.eclipse.debug.core\.launches\Tomcat.launch 
```

# c# - 通过 javascript 或 jQuery 填充厚框

> ID：493109
> 
> 赞同：0
> 
> 时间：2009-01-29T19:49:46.903
> 
> 标签：c#, javascript, ajax, gridview, thickbox

我正在尝试从 Web 服务获取字符串数据并用这些数据填充一个厚框。我觉得这应该是任务中最简单的部分，但到目前为止，这是我卡住的地方。

这是有问题的代码...

```
 function AjaxRequestHandler(layerName) {
    PageMethods.AjaxRequestHandler(layerName, OnSucceeded);
}

function OnSucceeded(result) {
    // need to display result to the thickbox here...
    alert(result);
} 
```

如果我像上面一样提醒，结果中的文本正是我想要在厚框中显示的内容。厚盒也出现了，但我尝试过的一切都只是把它变成空的。我最初的直觉是做一个document.write，但我不能这样做，因为我得到了一个权限被拒绝的错误。

有任何想法吗？

**编辑：**我应该注意，与运行thickbox 的onclick 事件的链接是从后面的C# 代码构建的，然后注入到GridView 中。我尝试过类似 slf 在下面建议的操作，但它只是将数据推到链接下方，而不是推入厚框。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-29T20:03:03.400

厚盒只显示它包装的内容。我还没有尝试过，但是如果您提供 <a href and id="myupdatablecontent"> 然后执行以下操作：

```
$("#myupdatablecontent").html("foo"); 
```

它应该像魔术一样工作

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-30T18:05:03.357

解决了！你所说的 slf 是需要做的事情的基本要点。但是，我需要深入研究ThickBox CSS 并找到作为主体的实际类，该类将保存Ajax 数据并将其与字符串一起注入。所以这是我真正需要的代码行。

```
$("#TB_ajaxContent").html(result);
```

其中 TB_ajaxContent 是Thickbox CSS 文件中的一个类，而不是我创建的类。

# c - 什么是用于处理 Excel 文件的简单可靠的 C 库？

> ID：493111
> 
> 赞同：30
> 
> 时间：2009-01-29T19:50:24.050
> 
> 标签：c, excel

嗯……就是这样。

我需要一些**简单**可靠**的**东西（不必有花哨的功能——我需要从 Excel 单元格中写入和读取文本和数字）

是的，我想要一个**示例“Hello Cell”代码**......

你有什么建议吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-30T03:25:43.270

强烈劝阻。我建议使用 C 友好格式（例如 CSV）而不是 XLS，或者使用新的[XML](http://msdn.microsoft.com/en-us/library/aa338205.aspx)格式（选择 XML 和 ZIP 库）。

不过，为了快速修复，您可以导出为引用的 CSV，然后使用[VBScript](http://www.activexperts.com/activmonitor/windowsmanagement/scripts/msoffice/excel/)导入。像[这样](http://ourworld.compuserve.com/homepages/guenter_born/wshbazaar/WSHExcel1.htm)的东西，虽然我会先尝试让它在 VBA 中工作。

请注意，这将需要 Office 的副本，并且无法很好地扩展（但您*可以*隐藏 Excel 窗口）。

* * *

我刚刚找到[xlsLib](http://xlslib.sourceforge.net/)，所以如果你真的需要直接用 C 语言编写，试试吧！不过要小心，因为很难做到正确，尤其是在写入已经存在的文件时。

也存在[LibExcel](http://www.libexcel.com/)，但那是 C++，所以你需要编译一个包装器，或者为 C 重写。

* * *

最后一个警告：我一开始没有搜索这些的原因是很难找到正确的。我没有使用上面的库，但我怀疑它们会以奇怪和不寻常的方式破坏。我相信您已经阅读了[Joel](http://www.joelonsoftware.com/items/2008/02/19.html)对 Office 格式的看法。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-01-30T03:34:21.600

Excel 与其他 Office 产品一样，通过 COM 导出其内容。这可用于 C++、VB、C# 和任何其他具有 COM 互操作性的语言——前提是您在 Windows 中运行并安装了 Excel。（你不能从普通的 C 到 COM。这是幸运还是不幸取决于你。）

不过，对于非托管语言来说，COM 是一种血腥混乱的痛苦。以下VB：

```
Set objExcel = CreateObject("Excel.Application")  ' start or use existing Excel
objExcel.Visible = True                           ' show the window
objExcel.Workbooks.Add                            ' create an empty workbook 
```

大致翻译成以下C++：

```
#include <assert.h>
#include <ole2.h>
#include <tchar.h>

int main() {
    HRESULT hr;
    IDispatch *objExcel, *objWorkbooks;
    CLSID clsid;
    DISPID id, id2;
    DISPPARAMS p;
    VARIANT v;
    TCHAR *name;

    CoInitialize(NULL);

    hr = CLSIDFromProgID(_T("Excel.Application"), &clsid);
    assert(SUCCEEDED(hr));
    hr = CoCreateInstance(clsid, NULL, CLSCTX_LOCAL_SERVER,
            IID_IDispatch, (LPVOID *)&objExcel);
    assert(SUCCEEDED(hr));

    id2 = DISPID_PROPERTYPUT;
    name = _T("Visible");
    hr = objExcel->GetIDsOfNames(IID_NULL, &name, 1, LOCALE_USER_DEFAULT, &id);
    assert(SUCCEEDED(hr));
    VariantInit(&v);
    v.vt = VT_I4;
    v.lVal = 1;
    p.cArgs = 1;
    p.rgvarg = &v;
    p.cNamedArgs = 1;
    p.rgdispidNamedArgs = &id2;
    hr = objExcel->Invoke(id, IID_NULL, LOCALE_SYSTEM_DEFAULT,
            DISPATCH_PROPERTYPUT, &p, NULL, NULL, NULL);
    assert(SUCCEEDED(hr));

    name = _T("Workbooks");
    hr = objExcel->GetIDsOfNames(IID_NULL, &name, 1, LOCALE_USER_DEFAULT, &id);
    assert(SUCCEEDED(hr));
    p.cArgs = 0;
    p.rgvarg = NULL;
    p.cNamedArgs = 0;
    p.rgdispidNamedArgs = NULL;
    hr = objExcel->Invoke(id, IID_NULL, LOCALE_SYSTEM_DEFAULT,
            DISPATCH_PROPERTYGET, &p, &v, NULL, NULL);
    assert(SUCCEEDED(hr));
    objWorkbooks = v.pdispVal;

    name = _T("Add");
    hr = objWorkbooks->GetIDsOfNames(IID_NULL, &name, 1, LOCALE_USER_DEFAULT, &id);
    assert(SUCCEEDED(hr));
    p.cArgs = 0;
    p.rgvarg = NULL;
    p.cNamedArgs = 0;
    p.rgdispidNamedArgs = NULL;
    hr = objWorkbooks->Invoke(id, IID_NULL, LOCALE_SYSTEM_DEFAULT,
            DISPATCH_PROPERTYGET, &p, NULL, NULL, NULL);
    assert(SUCCEEDED(hr));

    return 0;
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-12-26T05:52:58.360

一个免费的库，但同样是 C++，而不是 C： [ExcelFormat](http://www.codeproject.com/KB/office/ExcelFormat.aspx)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-01T13:46:18.183

我对 ehemient 发布的内容做了一个小扩展。有一个非常方便的库，可以减轻 IDispatch 接口的痛苦。 [http://disphelper.sourceforge.net/](http://disphelper.sourceforge.net/)

它只是您添加到项目中的一个文件，但它使使用 C 进行 IDispatch 编程几乎很有趣；-)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-07-07T20:04:15.307

另一种选择是使用[libxlsxwriter ，这是一个用于](https://github.com/jmcnamara/libxlsxwriter)*编写*Excel XLSX 文件的 C 库。但是，它不能*读取*Excel 文件，也不支持 XLS 文件。

# html - HTML 显示调整大小的图像保持率

> ID：493117
> 
> 赞同：1
> 
> 时间：2009-01-29T19:52:31.127
> 
> 标签：html, css

我想显示来自 URL 的图像，并且我希望该图像具有给定的大小，但我想保持高度和宽度之间的比率。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-29T19:58:58.837

CSS：

```
img {
 width: 30%;
 height: auto;
} 
```

像这样的东西？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-29T20:02:03.463

```
<img src="http://..." height="100" /> 
```

这里没有魔法，尽管客户端调整大小通常看起来很糟糕。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-29T20:03:37.343

您可以使用 css 设置图像样式

我相信如果你使用 px 例如，并且只指定一个维度

```
img {width:100px} 
```

该比率通常保持不变

您可以使用

```
img {width:100px;height:auto;} 
```

这可能会有所帮助

如果你使用

```
img {width:100px} 
```

该比率至少保持在 IE 7 中

# sql - 带参数的 AS400 SQL 查询

> ID：493119
> 
> 赞同：2
> 
> 时间：2009-01-29T19:52:37.273
> 
> 标签：sql, ibm-midrange

我正在测试一个简单的查询以从 AS400 数据库中获取数据。**我不确定我使用 SQL 查询的方式是否正确。**

我收到一个错误：“参数不正确。”

```
Select FIELD1, FIELD2 From Mylibrary.MyTable WHERE FIELD1 = @Field1 
```

当我运行以下查询时，我没有收到错误：

```
Select FIELD1, FIELD2 From Mylibrary.MyTable WHERE FIELD1 = 'myvalue' 
```

我正在使用 ADODB、VBScript 进行测试。

```
Set Param1 = cmd.CreateParameter("@Field1", 129, 1, 9, "myvalue")  ' 129 String
cmd.Parameters.Append Param1 
```

我来自 MS Sql 环境，所以为 AS400 写作对我来说是全新的。
谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-29T22:12:00.393

好的，我通过玩耍和尝试不同的事情得到了解决方案。

正如我之前所说，我习惯了 OLEDB 和 ADO.Net，所以我习惯于做以下事情：

```
Select FIELD1, FIELD2 From Mylibrary.MyTable WHERE FIELD1 = @Field1 
```

它在 Access 和 SQL Server 中工作，但在 AS/400 中不工作。

我得到了以下工作：

```
Select FIELD1, FIELD2 From Mylibrary.MyTable WHERE FIELD1 = ?

cmd.ActiveConnection = connstr
cmd.CommandType = 1'4   'Stored Procedures '1 Text
cmd.CommandText = sql
Set Param1 = cmd.CreateParameter("@Field1", 129, 1, 9, "myvalue")  ' 129 String
cmd.Parameters.Append Param1
Set rs = cmd.Execute() 
```

这都是 VbScript。诀窍是在 sql 语句中添加问号（？）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-04T22:18:21.283

如果您打算使用 .NET 连接到 AS400，首先您应该使用IBM的[IBM.Data.DB2.iSeries .NET 提供程序。](http://publib.boulder.ibm.com/infocenter/iseries/v5r4/index.jsp?topic=/rzaik/rzaikdotnetprovider.htm)根据 IBM 的[文档](http://www.redbooks.ibm.com/abstracts/sg246440.html)，这是调用 sql 的首选方法：

```
iDB2Connection conn = new IDB2Connnection(connectionstring);
iDB2Command cmd = null;

try
{
  conn.Open();
  string sql = "select * from somelibrary.sometable where a = @A and b = @B";
  cmd = conn.CreateCommand();
  cmd.CommandText = sql;
  cmd.DeriveParameters(); //this will talk to the AS400 to determine the param types
  cmd.Parameters["@A"].Value = Avalue;
  cmd.Parameters["@B"].Value = Bvalue;

  //execute the query
  cmd.ExecuteScalar(); //doesn't have to be Scalar but you get the idea
}
catch (Exception ex)
{
   //handle your exceptions
}
finally
{
  cmd.Dispose();
  conn.Close();
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-29T20:17:14.133

飞翔，

您可能使用[系统命名约定而不是 SQL 命名约定](http://publib.boulder.ibm.com/iseries/v5r2/ic2924/info/db2/rbafzmst39.htm#HDRCH2NAM)进行连接。将 Mylibrary.Mytable（SQL 周期限定符）更改为 Mylibrary/Mytable（系统斜杠限定符）。

# ms-access - 无需执行脚本或表单即可打开访问数据库

> ID：493129
> 
> 赞同：5
> 
> 时间：2009-01-29T19:55:10.887
> 
> 标签：ms-access

我正在尝试对 MS Access XP 数据库进行故障排除，它首先会关闭主窗口并提示输入日期。我输入的所有内容都带有一条错误消息，指出输入的值不是有效的日期 mm/dd/yyyy。然后它继续关闭访问。我已经尝试了所有我能想到的日期格式，但都无济于事。

是否可以在不自动提示我输入和关闭的情况下打开访问数据库？在这一点上，我不知道这东西的引擎盖下发生了什么，因为我什至无法打开它。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-29T19:59:36.463

在 Access 的文件菜单中选择打开时按住 Shift 键。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-07T14:36:36.177

如果您使用的是无线键盘，按住 shift 键有时可能不起作用。尝试按住笔记本电脑键盘上的 shift 键，同时双击或按 Enter 按钮以在不运行脚本的情况下打开 Access。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-02T03:39:40.073

进入后，您可能想要摆脱宏名称“autoexec”或在工具 | 下。启动删除“显示表单/页面”的选定项目，将其设置为（无）。

# batch-file - 设置 cmd.exe /V:ON 标志而不启动新实例

> ID：493132
> 
> 赞同：5
> 
> 时间：2009-01-29T19:56:58.200
> 
> 标签：batch-file, cmd, flags

`cmd /V:ON`有没有办法在不启动 cmd.exe 的新实例的情况下为 cmd.exe 启用执行时变量扩展（通常通过键入来完成）？

同样，是否可以即时更改其他设置/标志？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-29T20:07:10.317

试试这个：

```
setlocal enabledelayedexpansion 
```

还有

```
setlocal enableextensions 
```

这相当于`cmd /E:ON`。

参考资料：`setlocal /?`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-29T20:08:22.047

尝试

```
setlocal ENABLEDELAYEDEXPANSION 
```

# compression - 硬盘的硬件无损压缩？

> ID：493142
> 
> 赞同：1
> 
> 时间：2009-01-29T19:59:15.933
> 
> 标签：compression, hardware, lossless-compression, hard-drive

我偶然发现了这篇关于[基于硬件的硬盘加密的](http://arstechnica.com/hardware/news/2009/01/hard-drive-manufacturers-unveil-disk-encryption-standard.ars)文章，并意识到这不仅可以提供一种保护数据的好方法，而且还可以加快我们用来加密数据的应用程序的速度。

这让我想知道...

是否可以对压缩做同样的事情，以便在读取和写入驱动器时对所有数据进行适当的压缩或解压缩？

我已经有一段时间没有进行任何固件编程了，所以我什至不确定这在技术上是否可行。

但是，如果是这样，它可能会为人们提供更多的存储空间。

在固件中使用这种方法进行编程的优缺点是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-29T20:07:34.763

在速度为 100 美元的 1TB 驱动器的世界中，它是比空间更有价值的资源。这不值得。

编辑：

啊，所以您是说从盘片上抓取 100 字节的压缩数据，解压缩然后将其发送到系统，而不是抓取 800 字节的未压缩数据并将其发送到系统会更快，因为寻道时间太慢了。

这似乎是一个聪明的方法，但我敢打赌，如果最终值得权衡，那么硬盘制造商已经采用了这种技术，尽管事实上硬盘驱动器的速度仍然如此。

但谁知道呢，你可能正在做某事！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-29T20:25:22.527

我记得大约 15 年前，我看到一个广告，说有一个可以进行硬件压缩的 IDE 控制器卡。不确定它是否有任何好处。那是 1GB 驱动器超过 1,000 美元的日子。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-29T20:19:23.727

谁记得堆垛机？这一切[在 80 年代/90 年代就已经完蛋了](http://en.wikipedia.org/wiki/Disk_compression)。速度从来都不是问题，也不是“棘手的”。这些天完全没有必要。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-29T20:24:37.677

如前所述，收益并不大，尤其是如果您以压缩形式存储很少访问的文件。

因为在硬件中很难做到（应该报告什么磁盘大小？如果输入的熵等于它的大小，你会怎么做？）而且现代 CPU + RAM 与 HDD 相比无论如何都快得惊人，只需在软件中完成.

我知道的一个实现是[compFUSed](http://www.biggerbytes.be/)，它位于任何其他文件系统之上，另一个是 ZFS[博客条目，介绍了如何启用它](http://jforonda.blogspot.com/2007/01/zfs-compression.html)，它支持原生压缩。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-05-08T23:39:32.800

前段时间我也想过这个想法用于网络流量 - 之前已经做过：有使用 gzip 进行压缩的加速卡：[http ://www.aha.com/show_prod.php?id=36](http://www.aha.com/show_prod.php?id=36)

我还想到另一个好处是，现在您可以在不压缩驱动器内容的情况下传输 - 只需从磁盘读取压缩块并发送，而不必在以后压缩。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-29T20:10:26.537

这是可能的，但非常非常棘手。您必须开发自定义驱动程序，因为虽然加密扇区与常规扇区大小相同，因此使用相同的数学来查找数据，但压缩扇区“更小”，因此您要么必须持有“真实”扇区的地图才能操作系统中或驱动器本身上的压缩扇区。

唯一的另一个方面是访问速度和延迟。它不应该影响搜索，但是压缩数据可能需要比写入数据更长的时间 - 压缩是相当密集的计算。

此外，在您获得大量数据之前，压缩并不是很好。您可能可以即时压缩 512 字节（1 个扇区）并平均获得百分之几的压缩，但人们真的希望看到 20% 甚至更多的压缩，然后才愿意为硬件支付额外的现金。

它将需要更多的磁盘处理能力和内存，这将增加驱动器的成本。

此外，驱动器容量的增长速度可能不符合成本效益。

例如，假设您开发了奇迹压缩技术，将空间翻倍，而不会降低性能，没有额外的（易碎或容易崩溃的）驱动程序，适用于任何操作系统等。但它会增加 100 美元的驱动器成本。

现在有人为 1TB 驱动器执行此操作，将其转换为 2TB 驱动器可能是有意义的，但在 6-8 个月内，2TB 驱动器将低于 200 美元。任何较小的驱动器都不值得，因为您现在可以以 99 美元的价格获得 1TB。

如果你这样做了，它可以在驱动器和计算机之间工作，你将比直接将它构建到驱动器中具有更大的延迟，并且价格/性能的影响可能不值得。

因此，从技术上讲这是可能的，但存在缺陷并增加了系统的复杂性和弱点，但即使它没有这些缺点，也可能不值得。

-亚当

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-09-09T15:29:59.160

另一个考虑因素是磁盘上的大多数大文件（音乐、图片和视频）通常已经压缩（MP3、JPEG、MP4/MOV），因此压缩对这些文件没有帮助。未压缩的文件（文本文件、文字处理、电子邮件文本）往往是杯水车薪。

我自己也想知道同样的事情，因为我正在搜索数千个 gzip 压缩的文本文件，并解压缩我的四核 i7，我想知道专用 gzip 硬件是否可以像 GPU 加速并行处理一样加速它。但我怀疑上述问题会导致对于大多数用途而言，压缩硬盘驱动器不会有太大帮助。

# objective-c - 您是否标记您的 UIViews 或将它们保留为属性？

> ID：493145
> 
> 赞同：15
> 
> 时间：2009-01-29T19:59:45.077
> 
> 标签：objective-c, iphone, cocoa-touch, uiview, coding-style

这主要是一个风格问题，但自从我开始为 iPhone 编程以来，我一直很好奇其他人的想法。当您的 iPhone 应用程序中有一个 UIView 并且您需要在应用程序的其他地方访问它（通常在视图控制器的另一个函数中）时，您喜欢用整数标记视图并使用`viewWithTag:`消息检索它，还是您通常将其设置为视图控制器中的一个属性，以便以后访问？

将其保存为属性显然可以让以后更容易检索，但我认为通过标记视图而不是将其设置为对象属性可以节省一些（可能可以忽略不计）内存量。

我通常在我的视图控制器上创建属性，主要是因为我很懒，并且用它来检索视图`viewWithTag:`很烦人。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-30T04:02:58.000

不使用属性不会节省内存 - 属性只会生成一小段代码，这些代码引用指向您的视图的实例变量，无论您是否指向它，它都会被保留。

使用 viewWithTag 总是会更昂贵和更慢，因为该调用必须通过视图层次结构询问每个视图的标记值是什么。

我总是使用 IBOutlet 实例变量，并且有时在我不需要做任何事情的地方添加标签到控件，除了告诉哪个特定控件称为委托方法，可以由几个不同的控件激活。它的效率有点低，但在这种情况下代码更容易维护。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-30T04:02:08.457

我使用属性。内存影响远不是一个需要考虑的问题。viewWithTag: 也可能会消耗一点 CPU 来使用，但我这样做的主要原因是产生的代码更干净。访问 self.leftSideView 比访问 [self.view viewWithTag:LEFTSIDEVIEW] 要好得多，而且您不必管理枚举即可知道发生了什么。

我认为标签对调试很有用，但不是日常使用。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2010-02-28T02:45:04.913

我认识到这可能与 OP 的问题无关，但这可能有助于为谷歌提供信息。

我发现 UIView 标记的一种用途实际上不是通过视图层次结构中的标记来查找视图（如上所述，这可能会变得非常昂贵），而是通过委托来*区分*两个或多个视图它被分配来处理其中的几个，作为避免大量属性分配的一种方式（这当然可以使 UIViewController 代码更紧密地耦合）。

一个典型的例子是 UITableViewController，它的 UITableViewDataSource 委托已经被外部化到一个单独的类。假设 UITableViewController 稍后想要添加一个搜索栏，并且想要利用相同的 UITableViewDataSource。这意味着将调用 UITableViewDataSource 方法，并且数据源将需要经常将真正的 UITableView 与 UISearchDisplayController 上的 searchResultsTableView 区分开来。如果 UITableViewController 在每个表视图上设置标签，那么数据源可以轻松地根据标签值分支行为，而无需引用表视图或（更糟的是）搜索显示控制器。

再一次，我意识到这并不完全是提问者吠叫的树，但这是我发现自己对使用标签感觉很好的唯一用例。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-29T20:04:46.657

我总是将它们与 Interface builder 绑定到`IBOutlet`ivars

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-06-04T16:24:24.920

只是重申肯德尔所说的，viewWithTag：很昂贵。我有一个几百次调用的循环，循环需要 2 秒以上的时间才能执行。切换到一个数组，现在我什至没有注意到循环正在运行。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2011-03-19T07:20:01.277

我迟到了这个讨论，但我认为值得扩展 Justin Searls 关于使用标签来区分视图，特别是控件的观点。有时您需要一组按钮，它们基本上都做相同的事情，但代表不同的值。计算器上的按钮就是一个很好的例子：所有按钮，或至少所有数字按钮，都将连接到相同的目标和动作。尽管目标可以为每个按钮提供一个出口，并且动作可以依次将发送者的地址与每个出口进行比较，但给每个按钮一个标识符以帮助动作识别哪个按钮被按下要简单得多。这是标签最有用的地方。

如果视图控制器需要对视图的引用才能对其进行配置或以其他方式向其发送消息，则使用插座通常是有意义的。如果它只需要一种方式来区分一个视图和另一个视图，那么标签是一个不错的选择。

# c# - 我应该使用什么页面图像生成技术？

> ID：493164
> 
> 赞同：9
> 
> 时间：2009-01-29T20:05:24.720
> 
> 标签：c#, .net, formatting, printing-web-page

我现在正在构建一个桌面应用程序，它将其人类可读的输出呈现为 WebBrowser 控件中显示的 XHTML。最终，必须将此输出从 XHTML 文件转换为成像系统中的文档图像。与 XHTML 文档不同，文档图像必须分成物理页面；另外——这就是让我死心的部分——这些页面上需要有页眉和页脚。

就像我想的那样，我不能简单地将 WebBrowser 打印到文件中——它支持的页眉/页脚选项还不够复杂。所以我正在尝试找出生成这些图像的正确技术。

在我看来（尽管这不是强制性的）我最终要做的是生成 HTML 文档的 PDF 版本（以便我可以添加页眉和页脚），然后将 PDF 呈现为 TIFF，这是最终格式成像系统想要的。所以我正在考虑：

*   使用某种 XHTML 到 PDF 的转换软件。这样做的问题是，如果没有进行大量的评估和测试，我无法弄清楚我看过的产品是否有能力做我需要的事情，即获取现有的 XHTML 文档，用标题装饰它们和页脚并对它们进行分页。

*   使用 XSL-FO 生成 PDF。作为一个忍者级别的 XSLT 极客在这里会有所帮助（这就是我最初制作 XHTML 的方式），但它似乎仍然是一个笨拙而缓慢的解决方案，有很多移动部件。这也意味着我将一个又大又笨重的 Java 程序插入到我漂亮干净的 .NET 系统的中间，尽管如果这是正确的答案，我肯定足够成年人这样做。

*   使用一些我还没有想到的其他技术，比如 LaTeX。也许有一些神奇的页面成像工具可以将 XHTML 直接转换为带有页眉和页脚的 TIFF。那将是理想的。

我主要担心的是：

*   我正在构建一个商业产品；我使用的任何技术都必须是负担得起且可支持的。它不一定是免费的。

*   我不想在兔子洞里消失三个月，敲打这些东西让它发挥作用。从直觉上看，这似乎是一种问题空间，我可以在其中浪费大量时间来评估和拒绝工具。

*   无论我采用什么解决方案，都需要对 XHTML 中的格式更改相对免疫。我使用 XSLT 并首先生成 XHTML 的全部原因是我正在生成的文档是使用不断变化的业务规则动态组装的。

我花了很多时间寻找替代品，但没有找到任何明显的答案。但也许你们中的一个好人已经解决了这个问题，如果是这样，我愿意站在你们的肩膀上。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-17T21:12:16.200

**编辑**（太平洋标准时间 2010 年 11 月 28 日下午 12:30）如果您下载我的代码，请 +1 这个答案。我注意到我的 Codeplex 示例已被下载了数百次。该代码并不引人注目，但它是一个很好的起点，其中包含许多指向源帮助的链接。谢谢！+tom **编辑**(2009-03-29 9:00 AM PST) 发布[样本转换](http://cricketsoft.com/SampleConversion.aspx)。
**编辑**（太平洋标准时间 2009 年 3 月 23 日下午 12:30，发布到 CodePlex）我为此开发了一个解决方案并将其发布到[CodePlex](http://www.codeplex.com/XhtmlToTiff)。已发布的[2.0 版](http://xhtmltotiff.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=25117)是使用 WPF MVVP 模式编写的。TIFF 文件（每页一个）输出到 c:\Temp\XhtmlToTiff。XAML 和 XPS 格式也被创建。**[CricketSoft.com](http://cricketsoft.com)**上提供了一个已编译、可安装的版本

* * *

您是否尝试过“ [Microsoft XPS Document Writer](http://www.microsoft.com/whdc/xps/viewxps.mspx) ”？这是一款纯软件打印机，可从各种来源（包括网页）生成分页输出。

通常有一个用于处理 XPS 文档和 Open XML 文档的 SDK。这是 Beth Massi 的一篇操作指南文章：“[使用 Open XML SDK 访问 Open XML 文档部件](http://blogs.msdn.com/bethmassi/archive/2008/07/30/accessing-openxml-document-parts-with-the-openxml-sdk.aspx)”。

+汤姆

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-21T14:35:26.200

只是我的 2p，但如果您是 XSLT 忍者，我建议您坚持下去。您可以通过查看 nFop 来避免讨厌的 java 程序，它是 apache FOP 项目的 C# 端口。很棒的是，您可以简单地获取程序集并使用直接将您的 XML 和 XSLT 传递给它来获得您想要的 PDF 输出。

[http://sourceforge.net/projects/nfop/](http://sourceforge.net/projects/nfop/)

希望有帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-17T19:53:41.363

如果 tiff 是您的目标，这可能是一种免费且低风险的方法：

1.  使用组件为给定的 url 创建图像。我不确定我们使用的是哪个工具，但是 GIYF：我只是偶然发现了 SmallSharpTool 的 WebPreview 似乎可以完成这项工作
2.  确保它可以创建整个页面的图像，即整个可滚动区域。
3.  使用 ImageMagick 进行所有图像处理，例如将其切割成多个页面，添加您自己的页眉、页脚和页码以及转换为 tiff。

我个人在 C# 项目（控制台应用程序和网站）中单独使用了上述技术并取得了成功，因此我几乎可以保证这会奏效。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-24T09:12:25.000

> 使用一些我还没有想到的其他技术，比如 LaTeX。

**TexML**，这是带有 XML 语法的 LaTeX 语义。要使用它，您可以创建 XSLT，它会用 TexML 命令装饰您的 XHTML（[参见示例](http://getfo.org/texml/tour_xslt.html)）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-17T19:23:13.153

你有没有想过使用后记？

ps：你需要什么样的页眉/页脚——你的自定义页眉/页脚放在中间？如果是这样，postscript 或 PDF 可能是最好的。但是创建 xhtml+css 到 pdf 转换器将非常困难。基本上，您需要有能够解析 xhtml 和 css 的库（+任何对象，如图像、flash 等）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-17T19:35:02.720

[PrinceXML](http://www.princexml.com/overview/)是一个 XHTML/CSS 到 PDF 的转换器。它似乎具有您需要的功能：

> *   页眉/页脚、页码和双面打印。

我意识到您可能想要比这个更广泛的答案（对不起，我还没有评估该产品），但是，我希望它有所帮助！

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-20T16:55:47.650

这完全取决于质量对于生成的文档的重要性。您还需要对文档执行哪些其他操作也很重要。

> 我现在正在构建一个桌面应用程序，它将其人类可读的输出呈现为 WebBrowser 控件中显示的 XHTML。最终，必须将此输出从 XHTML 文件转换为成像系统中的文档图像。

看起来您的应用程序是一种软形式。您生成填写好的表格并保存它们。

> [...]这些页面上需要有页眉和页脚。

这是简单的部分。您可以使用模板并将数据与静态页眉/页脚模板合并。你听起来好像在做 VDP。嗯。让我们继续前进。

> 我不能简单地将 WebBrowser 打印到文件中 - 它支持的页眉/页脚选项还不够复杂。

为什么这样？您所需要的只是一个有能力的司机。

> 在我看来（尽管这不是强制性的）我最终要做的是生成 HTML 文档的 PDF 版本

同样，尚不清楚您为什么要立即使用 PDF。PDF 是一种文档交换格式。本身不是 PDL。PostScript 是一个更好的选择。是的，我知道有诸如 XPS、PCL 之类的东西。但是，您使用 PS 获得的渲染控制和质量数量太多，无法冒险使用更便宜的解决方案。我说更便宜，因为您还需要记住可以使用的打印类型。PostScript 打印机（不是带有克隆 RIP 的打印机）通常更昂贵。

现在，回到您的 PDF 内容。是的，您当然可以生成 PDF。它具有某些优点，例如：

*   更好地支持透明度（以及总体质量）
*   档案
*   换乘
*   分享它以供审查
*   预览/预检/更正
*   安全
*   流加密（用于安全性和传输到打印机的数据量）
*   使用模板

但是请记住，您是否有任何打印机可以进行本机 PDF 翻录？因为您正在执行有损 PDF 到 PS/PCL 的转换。而你刚刚输掉了比赛。这让我回到 PostScript ;)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-21T15:12:15.817

您可以将 PISA 用于**Python**。它使用reportlab工具包从html生成pdf（使用html5lib）

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-22T19:14:15.880

您也可以尝试使用**PDFCreator**并将文档打印为 PDF。PDFCreator 就像任何普通打印机一样，使用 ghostscript**将打印机输出转换为**pdf、**tiff**、jpeg 或任何您想要的。我认为您可以通过 IE 的 com 界面更改页眉和页脚项目并直接从 IE 打印。PDFCreator 在安装目录的 com 文件夹中有不同语言的示例。我已经使用它并且可以保证它。虽然只有 Windows。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-22T20:49:35.980

你真的需要使用 XHTML/Web 浏览器吗？

我一直在试图生成好看的 HTML 报告时陷入这种困境，我发现的解决方案是……放弃 HTML 并使用“真正的”报告生成器，其中有很多，它们都支持所有您可以考虑的分页和页眉/页脚选项通常可以打印为 pdf，有时也可以直接打印为图像。

HTML 只是不适合报告的技术。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-02-24T10:21:48.297

**ExpertPDF HtmlToPdf Converter** (www.html-to-pdf.net) 应该能够完全满足您的需求。使用起来非常简单，只需在项目中引用程序集并开始使用即可。我已经在几个工作项目中成功地使用了这个产品。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-24T13:53:21.393

您提到了您当前的桌面应用程序以 xhtml 格式导出结果。由于 xhtml 是格式良好的 xml，因此您应该避免使用 xsl fo 将其导出为 pdf。

XML -> XSL-FO = PDF

这是初学者指南： http: [//www.devx.com/xml/Article/16430](http://www.devx.com/xml/Article/16430)

我的公司已经在荷兰政府的 java+cocoon webaplication 中使用了这种技术。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-25T06:28:51.330

[http://iecapt.sourceforge.net/](http://iecapt.sourceforge.net/)

引用上述网站：

> IECapt 是一个小型命令行实用程序，用于将 Internet Explorer 的网页渲染捕获为 BMP、JPEG 或 PNG 图像文件。C++ 版本还具有对增强型元文件矢量图形输出的实验性支持。IECapt 有 C++ 和 C# 版本。

# architecture - 领域模型 - 标识符关系与分层对象

> ID：493170
> 
> 赞同：1
> 
> 时间：2009-01-29T20:06:55.217
> 
> 标签：architecture, domain-driven-design, domain-model

在充实一个假设的域模型时，我发现自己想知道关联域对象的更好方法是让父域对象包含一个指针（子域的标识符），还是使用子对象在父对象内构建复合。

我可以看到每种方法的优缺点，主要是大小与复杂性之间的权衡，归根结底。我倾向于更多地倾向于标识符关系方法，因为我没有预料到需要进行任何类型的延迟加载。

尽管不直接相关，但域对象是简单的 POCO（POJO 的 .NET 等效项）。它们被明确标记为可序列化，因为它们很有可能最终会在应用程序域之间交叉。在我看来，LINQ 使关系标识符方法可行，如果 LINQ 不可用，我根本不会考虑它。

任何想法将不胜感激！

**编辑：还有一些想法可能让我倾向于仅使用标识符的方法。首先是对象的缓存策略。父对象和子对象完全有可能具有不同的 TTL，这由它们的策略定义。第二个是引用持有可能会限制对象重用，因为同一个孩子可能被多个父母持有——在可重用数据的情况下。这两者也与序列化对象的整体大小有关。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-29T20:12:29.167

我在我的 POCO 上都使用了这两种方法。我用父类上的子列表和子类上的一个父实例生成它们。

# python - 有没有办法将数字单词转换为整数？

> ID：493174
> 
> 赞同：93
> 
> 时间：2009-01-29T20:07:43.873
> 
> 标签：python, string, text, integer, numbers

我需要转换`one`成`1`, `two`into`2`等等。

有没有办法用一个库或一个类或任何东西来做到这一点？

* * *

## 回答 #1

> 赞同：137
> 
> 时间：2009-01-29T22:32:54.890

这段代码的大部分是设置 numwords 字典，这仅在第一次调用时完成。

```
def text2int(textnum, numwords={}):
    if not numwords:
      units = [
        "zero", "one", "two", "three", "four", "five", "six", "seven", "eight",
        "nine", "ten", "eleven", "twelve", "thirteen", "fourteen", "fifteen",
        "sixteen", "seventeen", "eighteen", "nineteen",
      ]

      tens = ["", "", "twenty", "thirty", "forty", "fifty", "sixty", "seventy", "eighty", "ninety"]

      scales = ["hundred", "thousand", "million", "billion", "trillion"]

      numwords["and"] = (1, 0)
      for idx, word in enumerate(units):    numwords[word] = (1, idx)
      for idx, word in enumerate(tens):     numwords[word] = (1, idx * 10)
      for idx, word in enumerate(scales):   numwords[word] = (10 ** (idx * 3 or 2), 0)

    current = result = 0
    for word in textnum.split():
        if word not in numwords:
          raise Exception("Illegal word: " + word)

        scale, increment = numwords[word]
        current = current * scale + increment
        if scale > 100:
            result += current
            current = 0

    return result + current

print text2int("seven billion one hundred million thirty one thousand three hundred thirty seven")
#7100031337 
```

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2016-01-02T18:48:01.653

我刚刚为 PyPI 发布了一个名为[word2number](https://pypi.python.org/pypi/word2number)的 python 模块，用于确切目的。[https://github.com/akshaynagpal/w2n](https://github.com/akshaynagpal/w2n)

安装它使用：

```
pip install word2number 
```

***确保您的 pip 已更新到最新版本。***

用法：

```
from word2number import w2n

print w2n.word_to_num("two million three thousand nine hundred and eighty four")
2003984 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2016-08-04T07:04:13.157

如果有人感兴趣，我破解了一个维护字符串其余部分的版本（尽管它可能有错误，但没有对其进行过多测试）。

```
def text2int (textnum, numwords={}):
    if not numwords:
        units = [
        "zero", "one", "two", "three", "four", "five", "six", "seven", "eight",
        "nine", "ten", "eleven", "twelve", "thirteen", "fourteen", "fifteen",
        "sixteen", "seventeen", "eighteen", "nineteen",
        ]

        tens = ["", "", "twenty", "thirty", "forty", "fifty", "sixty", "seventy", "eighty", "ninety"]

        scales = ["hundred", "thousand", "million", "billion", "trillion"]

        numwords["and"] = (1, 0)
        for idx, word in enumerate(units):  numwords[word] = (1, idx)
        for idx, word in enumerate(tens):       numwords[word] = (1, idx * 10)
        for idx, word in enumerate(scales): numwords[word] = (10 ** (idx * 3 or 2), 0)

    ordinal_words = {'first':1, 'second':2, 'third':3, 'fifth':5, 'eighth':8, 'ninth':9, 'twelfth':12}
    ordinal_endings = [('ieth', 'y'), ('th', '')]

    textnum = textnum.replace('-', ' ')

    current = result = 0
    curstring = ""
    onnumber = False
    for word in textnum.split():
        if word in ordinal_words:
            scale, increment = (1, ordinal_words[word])
            current = current * scale + increment
            if scale > 100:
                result += current
                current = 0
            onnumber = True
        else:
            for ending, replacement in ordinal_endings:
                if word.endswith(ending):
                    word = "%s%s" % (word[:-len(ending)], replacement)

            if word not in numwords:
                if onnumber:
                    curstring += repr(result + current) + " "
                curstring += word + " "
                result = current = 0
                onnumber = False
            else:
                scale, increment = numwords[word]

                current = current * scale + increment
                if scale > 100:
                    result += current
                    current = 0
                onnumber = True

    if onnumber:
        curstring += repr(result + current)

    return curstring 
```

例子：

```
 >>> text2int("I want fifty five hot dogs for two hundred dollars.")
 I want 55 hot dogs for 200 dollars. 
```

如果您有“200 美元”，则可能会出现问题。但是，这真的很粗糙。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2018-11-20T20:00:30.030

我需要一些不同的东西，因为我的输入来自语音到文本的转换，而解决方案并不总是对数字求和。例如，“我的邮政编码是一二三四五”不应转换为“我的邮政编码是 15”。

我接受了 Andrew 的[回答](https://stackoverflow.com/a/38760564)并对其进行了调整，以处理其他一些人们突出显示为错误的情况，并且还添加了对我上面提到的邮政编码等示例的支持。一些基本的测试用例如下所示，但我相信仍有改进的空间。

```
def is_number(x):
    if type(x) == str:
        x = x.replace(',', '')
    try:
        float(x)
    except:
        return False
    return True

def text2int (textnum, numwords={}):
    units = [
        'zero', 'one', 'two', 'three', 'four', 'five', 'six', 'seven', 'eight',
        'nine', 'ten', 'eleven', 'twelve', 'thirteen', 'fourteen', 'fifteen',
        'sixteen', 'seventeen', 'eighteen', 'nineteen',
    ]
    tens = ['', '', 'twenty', 'thirty', 'forty', 'fifty', 'sixty', 'seventy', 'eighty', 'ninety']
    scales = ['hundred', 'thousand', 'million', 'billion', 'trillion']
    ordinal_words = {'first':1, 'second':2, 'third':3, 'fifth':5, 'eighth':8, 'ninth':9, 'twelfth':12}
    ordinal_endings = [('ieth', 'y'), ('th', '')]

    if not numwords:
        numwords['and'] = (1, 0)
        for idx, word in enumerate(units): numwords[word] = (1, idx)
        for idx, word in enumerate(tens): numwords[word] = (1, idx * 10)
        for idx, word in enumerate(scales): numwords[word] = (10 ** (idx * 3 or 2), 0)

    textnum = textnum.replace('-', ' ')

    current = result = 0
    curstring = ''
    onnumber = False
    lastunit = False
    lastscale = False

    def is_numword(x):
        if is_number(x):
            return True
        if word in numwords:
            return True
        return False

    def from_numword(x):
        if is_number(x):
            scale = 0
            increment = int(x.replace(',', ''))
            return scale, increment
        return numwords[x]

    for word in textnum.split():
        if word in ordinal_words:
            scale, increment = (1, ordinal_words[word])
            current = current * scale + increment
            if scale > 100:
                result += current
                current = 0
            onnumber = True
            lastunit = False
            lastscale = False
        else:
            for ending, replacement in ordinal_endings:
                if word.endswith(ending):
                    word = "%s%s" % (word[:-len(ending)], replacement)

            if (not is_numword(word)) or (word == 'and' and not lastscale):
                if onnumber:
                    # Flush the current number we are building
                    curstring += repr(result + current) + " "
                curstring += word + " "
                result = current = 0
                onnumber = False
                lastunit = False
                lastscale = False
            else:
                scale, increment = from_numword(word)
                onnumber = True

                if lastunit and (word not in scales):                                                                                                                                                                                                                                         
                    # Assume this is part of a string of individual numbers to                                                                                                                                                                                                                
                    # be flushed, such as a zipcode "one two three four five"                                                                                                                                                                                                                 
                    curstring += repr(result + current)                                                                                                                                                                                                                                       
                    result = current = 0                                                                                                                                                                                                                                                      

                if scale > 1:                                                                                                                                                                                                                                                                 
                    current = max(1, current)                                                                                                                                                                                                                                                 

                current = current * scale + increment                                                                                                                                                                                                                                         
                if scale > 100:                                                                                                                                                                                                                                                               
                    result += current                                                                                                                                                                                                                                                         
                    current = 0                                                                                                                                                                                                                                                               

                lastscale = False                                                                                                                                                                                                              
                lastunit = False                                                                                                                                                
                if word in scales:                                                                                                                                                                                                             
                    lastscale = True                                                                                                                                                                                                         
                elif word in units:                                                                                                                                                                                                             
                    lastunit = True

    if onnumber:
        curstring += repr(result + current)

    return curstring 
```

一些测试...

```
one two three -> 123
three forty five -> 345
three and forty five -> 3 and 45
three hundred and forty five -> 345
three hundred -> 300
twenty five hundred -> 2500
three thousand and six -> 3006
three thousand six -> 3006
nineteenth -> 19
twentieth -> 20
first -> 1
my zip is one two three four five -> my zip is 12345
nineteen ninety six -> 1996
fifty-seventh -> 57
one million -> 1000000
first hundred -> 100
I will buy the first thousand -> I will buy the 1000  # probably should leave ordinal in the string
thousand -> 1000
hundred and six -> 106
1 million -> 1000000 
```

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2009-02-28T17:10:08.343

我需要处理一些额外的解析案例，例如序数词（“first”、“second”）、连字符（“one-hundred”）和连字符的序词（如“fifty-7”），所以我添加了几行：

```
def text2int(textnum, numwords={}):
    if not numwords:
        units = [
        "zero", "one", "two", "three", "four", "five", "six", "seven", "eight",
        "nine", "ten", "eleven", "twelve", "thirteen", "fourteen", "fifteen",
        "sixteen", "seventeen", "eighteen", "nineteen",
        ]

        tens = ["", "", "twenty", "thirty", "forty", "fifty", "sixty", "seventy", "eighty", "ninety"]

        scales = ["hundred", "thousand", "million", "billion", "trillion"]

        numwords["and"] = (1, 0)
        for idx, word in enumerate(units):  numwords[word] = (1, idx)
        for idx, word in enumerate(tens):       numwords[word] = (1, idx * 10)
        for idx, word in enumerate(scales): numwords[word] = (10 ** (idx * 3 or 2), 0)

    ordinal_words = {'first':1, 'second':2, 'third':3, 'fifth':5, 'eighth':8, 'ninth':9, 'twelfth':12}
    ordinal_endings = [('ieth', 'y'), ('th', '')]

    textnum = textnum.replace('-', ' ')

    current = result = 0
    for word in textnum.split():
        if word in ordinal_words:
            scale, increment = (1, ordinal_words[word])
        else:
            for ending, replacement in ordinal_endings:
                if word.endswith(ending):
                    word = "%s%s" % (word[:-len(ending)], replacement)

            if word not in numwords:
                raise Exception("Illegal word: " + word)

            scale, increment = numwords[word]

         current = current * scale + increment
         if scale > 100:
            result += current
            current = 0

    return result + current` 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-01-29T20:25:24.617

这是简单的案例方法：

```
>>> number = {'one':1,
...           'two':2,
...           'three':3,}
>>> 
>>> number['two']
2 
```

还是您在寻找可以处理*“一万两千，一百七十二”*的东西？

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-01-29T20:28:09.963

如果您要解析的数字数量有限，则可以轻松地将其硬编码到字典中。

对于稍微复杂的情况，您可能希望根据相对简单的数字语法自动生成此字典。与此类似的东西（当然，广义的......）

```
for i in range(10):
   myDict[30 + i] = "thirty-" + singleDigitsDict[i] 
```

如果您需要更广泛的东西，那么看起来您将需要自然语言处理工具。[这篇文章](http://www.acm.org/crossroads/xrds13-4/natural_language.html)可能是一个很好的起点。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2020-05-30T09:03:50.133

使用 Python 包：[WordToDigits](https://pypi.org/project/wordtodigits/)

```
pip install wordtodigits 
```

它可以在句子中找到以单词形式出现的数字，然后将它们转换为正确的数字格式。如果存在小数部分，还需要处理。**数字的单​​词表示可以在文章中的任何地方**。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2021-04-25T23:13:35.967

```
def parse_int(string):
    ONES = {'zero': 0,
            'one': 1,
            'two': 2,
            'three': 3,
            'four': 4,
            'five': 5,
            'six': 6,
            'seven': 7,
            'eight': 8,
            'nine': 9,
            'ten': 10,
            'eleven': 11,
            'twelve': 12,
            'thirteen': 13,
            'fourteen': 14,
            'fifteen': 15,
            'sixteen': 16,
            'seventeen': 17,
            'eighteen': 18,
            'nineteen': 19,
            'twenty': 20,
            'thirty': 30,
            'forty': 40,
            'fifty': 50,
            'sixty': 60,
            'seventy': 70,
            'eighty': 80,
            'ninety': 90,
              }

    numbers = []
    for token in string.replace('-', ' ').split(' '):
        if token in ONES:
            numbers.append(ONES[token])
        elif token == 'hundred':
            numbers[-1] *= 100
        elif token == 'thousand':
            numbers = [x * 1000 for x in numbers]
        elif token == 'million':
            numbers = [x * 1000000 for x in numbers]
    return sum(numbers) 
```

用 700 个 1 到 100 万范围内的随机数进行测试效果很好。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-04-21T18:37:04.783

进行了更改，以便 text2int(scale) 将返回正确的转换。例如，text2int("hundred") => 100。

```
import re

numwords = {}

def text2int(textnum):

    if not numwords:

        units = [ "zero", "one", "two", "three", "four", "five", "six",
                "seven", "eight", "nine", "ten", "eleven", "twelve",
                "thirteen", "fourteen", "fifteen", "sixteen", "seventeen",
                "eighteen", "nineteen"]

        tens = ["", "", "twenty", "thirty", "forty", "fifty", "sixty", 
                "seventy", "eighty", "ninety"]

        scales = ["hundred", "thousand", "million", "billion", "trillion", 
                'quadrillion', 'quintillion', 'sexillion', 'septillion', 
                'octillion', 'nonillion', 'decillion' ]

        numwords["and"] = (1, 0)
        for idx, word in enumerate(units): numwords[word] = (1, idx)
        for idx, word in enumerate(tens): numwords[word] = (1, idx * 10)
        for idx, word in enumerate(scales): numwords[word] = (10 ** (idx * 3 or 2), 0)

    ordinal_words = {'first':1, 'second':2, 'third':3, 'fifth':5, 
            'eighth':8, 'ninth':9, 'twelfth':12}
    ordinal_endings = [('ieth', 'y'), ('th', '')]
    current = result = 0
    tokens = re.split(r"[\s-]+", textnum)
    for word in tokens:
        if word in ordinal_words:
            scale, increment = (1, ordinal_words[word])
        else:
            for ending, replacement in ordinal_endings:
                if word.endswith(ending):
                    word = "%s%s" % (word[:-len(ending)], replacement)

            if word not in numwords:
                raise Exception("Illegal word: " + word)

            scale, increment = numwords[word]

        if scale > 1:
            current = max(1, current)

        current = current * scale + increment
        if scale > 100:
            result += current
            current = 0

    return result + current 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2015-03-05T20:27:39.623

Marc Burns的[红宝石](https://github.com/dimidd/numbers_in_words)可以做到这一点。我最近分叉了它以增加多年的支持。您可以从 python 调用[ruby​​ 代码](http://www.decalage.info/python/ruby_bridge)。

```
 require 'numbers_in_words'
  require 'numbers_in_words/duck_punch'

  nums = ["fifteen sixteen", "eighty five sixteen",  "nineteen ninety six",
          "one hundred and seventy nine", "thirteen hundred", "nine thousand two hundred and ninety seven"]
  nums.each {|n| p n; p n.in_numbers} 
```

结果：
`"fifteen sixteen" 1516 "eighty five sixteen" 8516 "nineteen ninety six" 1996 "one hundred and seventy nine" 179 "thirteen hundred" 1300 "nine thousand two hundred and ninety seven" 9297`

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2014-02-10T04:27:40.870

一个快速的解决方案是使用[inflect.py](https://pypi.python.org/pypi/inflect)生成字典进行翻译。

inflect.py 有一个`number_to_words()`函数，它将一个数字（例如`2`）转换为它的单词形式（例如`'two'`）。不幸的是，没有提供它的反向（这将允许您避免使用翻译词典路线）。同样，您可以使用该功能来构建翻译词典：

```
>>> import inflect
>>> p = inflect.engine()
>>> word_to_number_mapping = {}
>>>
>>> for i in range(1, 100):
...     word_form = p.number_to_words(i)  # 1 -> 'one'
...     word_to_number_mapping[word_form] = i
...
>>> print word_to_number_mapping['one']
1
>>> print word_to_number_mapping['eleven']
11
>>> print word_to_number_mapping['forty-three']
43 
```

如果您愿意花一些时间，可能会检查 inflect.py 函数的内部工作原理`number_to_words()`并构建您自己的代码以动态执行此操作（我没有尝试过这样做）。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-07-22T10:51:26.423

我采用了@recursive 的[逻辑](https://stackoverflow.com/a/493788/3258059)并转换为 Ruby。我还对查找表进行了硬编码，因此它并不那么酷，但可能会帮助新手了解正在发生的事情。

```
WORDNUMS = {"zero"=> [1,0], "one"=> [1,1], "two"=> [1,2], "three"=> [1,3],
            "four"=> [1,4], "five"=> [1,5], "six"=> [1,6], "seven"=> [1,7], 
            "eight"=> [1,8], "nine"=> [1,9], "ten"=> [1,10], 
            "eleven"=> [1,11], "twelve"=> [1,12], "thirteen"=> [1,13], 
            "fourteen"=> [1,14], "fifteen"=> [1,15], "sixteen"=> [1,16], 
            "seventeen"=> [1,17], "eighteen"=> [1,18], "nineteen"=> [1,19], 
            "twenty"=> [1,20], "thirty" => [1,30], "forty" => [1,40], 
            "fifty" => [1,50], "sixty" => [1,60], "seventy" => [1,70], 
            "eighty" => [1,80], "ninety" => [1,90],
            "hundred" => [100,0], "thousand" => [1000,0], 
            "million" => [1000000, 0]}

def text_2_int(string)
  numberWords = string.gsub('-', ' ').split(/ /) - %w{and}
  current = result = 0
  numberWords.each do |word|
    scale, increment = WORDNUMS[word]
    current = current * scale + increment
    if scale > 100
      result += current
      current = 0
    end
  end
  return result + current
end 
```

我想处理像这样的字符串`two thousand one hundred and forty-six`

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-06-27T16:56:45.647

这处理印度风格的单词中的数字，一些分数，数字和单词的组合以及加法。

```
def words_to_number(words):
    numbers = {"zero":0, "a":1, "half":0.5, "quarter":0.25, "one":1,"two":2,
               "three":3, "four":4,"five":5,"six":6,"seven":7,"eight":8,
               "nine":9, "ten":10,"eleven":11,"twelve":12, "thirteen":13,
               "fourteen":14, "fifteen":15,"sixteen":16,"seventeen":17,
               "eighteen":18,"nineteen":19, "twenty":20,"thirty":30, "forty":40,
               "fifty":50,"sixty":60,"seventy":70, "eighty":80,"ninety":90}

    groups = {"hundred":100, "thousand":1_000, 
              "lac":1_00_000, "lakh":1_00_000, 
              "million":1_000_000, "crore":10**7, 
              "billion":10**9, "trillion":10**12}

    split_at = ["and", "plus"]

    n = 0
    skip = False
    words_array = words.split(" ")
    for i, word in enumerate(words_array):
        if not skip:
            if word in groups:
                n*= groups[word]
            elif word in numbers:
                n += numbers[word]
            elif word in split_at:
                skip = True
                remaining = ' '.join(words_array[i+1:])
                n+=words_to_number(remaining)
            else:
                try:
                    n += float(word)
                except ValueError as e:
                    raise ValueError(f"Invalid word {word}") from e
    return n 
```

**测试：**

```
print(words_to_number("a million and one"))
>> 1000001

print(words_to_number("one crore and one"))
>> 1000,0001

print(words_to_number("0.5 million one"))
>> 500001.0

print(words_to_number("half million and one hundred"))
>> 500100.0

print(words_to_number("quarter"))
>> 0.25

print(words_to_number("one hundred plus one"))
>> 101 
```

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2020-08-03T12:51:34.183

此代码适用于系列数据：

```
import pandas as pd
mylist = pd.Series(['one','two','three'])
mylist1 = []
for x in range(len(mylist)):
    mylist1.append(w2n.word_to_num(mylist[x]))
print(mylist1) 
```

* * *

## 回答 #16

> 赞同：-3
> 
> 时间：2017-08-21T12:09:03.930

此代码仅适用于99以下的数字。word to int和int to word（其余需要实现10-20行代码和简单的逻辑。这只是初学者的简单代码）：

```
num = input("Enter the number you want to convert : ")
mydict = {'1': 'One', '2': 'Two', '3': 'Three', '4': 'Four', '5': 'Five','6': 'Six', '7': 'Seven', '8': 'Eight', '9': 'Nine', '10': 'Ten','11': 'Eleven', '12': 'Twelve', '13': 'Thirteen', '14': 'Fourteen', '15': 'Fifteen', '16': 'Sixteen', '17': 'Seventeen', '18': 'Eighteen', '19': 'Nineteen'}
mydict2 = ['', '', 'Twenty', 'Thirty', 'Fourty', 'fifty', 'sixty', 'Seventy', 'Eighty', 'Ninty']

if num.isdigit():
    if(int(num) < 20):
        print(" :---> " + mydict[num])
    else:
        var1 = int(num) % 10
        var2 = int(num) / 10
        print(" :---> " + mydict2[int(var2)] + mydict[str(var1)])
else:
    num = num.lower()
    dict_w = {'one': 1, 'two': 2, 'three': 3, 'four': 4, 'five': 5, 'six': 6, 'seven': 7, 'eight': 8, 'nine': 9, 'ten': 10, 'eleven': 11, 'twelve': 12, 'thirteen': 13, 'fourteen': 14, 'fifteen': 15, 'sixteen': 16, 'seventeen': '17', 'eighteen': '18', 'nineteen': '19'}
    mydict2 = ['', '', 'twenty', 'thirty', 'fourty', 'fifty', 'sixty', 'seventy', 'eighty', 'ninty']
    divide = num[num.find("ty")+2:]
    if num:
        if(num in dict_w.keys()):
            print(" :---> " + str(dict_w[num]))
        elif divide == '' :
            for i in range(0, len(mydict2)-1):
                if mydict2[i] == num:
                    print(" :---> " + str(i * 10))
        else :
            str3 = 0
            str1 = num[num.find("ty")+2:]
            str2 = num[:-len(str1)]
            for i in range(0, len(mydict2)):
                if mydict2[i] == str2:
                    str3 = i
            if str2 not in mydict2:
                print("----->Invalid Input<-----")                
            else:
                try:
                    print(" :---> " + str((str3*10) + dict_w[str1]))
                except:
                    print("----->Invalid Input<-----")
    else:
        print("----->Please Enter Input<-----") 
```

# javascript - 如何创建一个空的 HTML 锚点，这样当我单击它时页面不会“跳起来”？

> ID：493175
> 
> 赞同：61
> 
> 时间：2009-01-29T20:08:03.280
> 
> 标签：javascript, jquery, anchor

我正在处理一些 JQuery 以在单击链接时隐藏/显示一些内容。我可以创建类似的东西：

```
<a href="#" onclick="jquery_stuff" /> 
```

但是，如果我在页面上向下滚动时单击该链接，它将跳回页面顶部。

如果我这样做：

```
<a href="" onclick="jquery_stuff" /> 
```

页面将重新加载，从而消除了 javascript 所做的所有更改。

像这样的东西：

```
<a onclick="jquery_stuff" /> 
```

会给我想要的效果，但它不再显示为链接。有什么方法可以指定一个空的锚点，这样我就可以为`onclick`事件分配一个 javascript 处理程序，而无需更改页面上的任何内容或移动滚动条？

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2009-01-29T20:09:50.077

放一个“return false;” 关于第二个选项：

```
<a href="" onclick="jquery_stuff; return false;" /> 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-01-29T20:09:52.793

您需要`return false;`在`jquery_stuff`：

```
<a href="no-javascript.html" onclick="jquery_stuff(); return false;" /> 
```

这将取消默认操作。

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2009-01-31T06:03:44.543

你可以简单地说如下：

```
<a href="javascript:;" onclick="jquery_stuff"> 
```

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2012-04-28T14:48:25.603

jQuery 有一个内置的函数`preventDefault`，可以在这里找到：http: [//api.jquery.com/event.preventDefault/](http://api.jquery.com/event.preventDefault/)

这是他们的例子：

```
<script>
$("a").click(function(event) {
    event.preventDefault();
});
</script> 
```

您还可以像这样构建链接：

```
<a href="javascript:void(0)" onclick="myJsFunc();">Link</a> 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2011-04-05T13:57:03.097

检查没有眼睑的评论（使用按钮，而不是锚点）。正要发布相同的建议。不链接到资源而仅执行脚本的锚点应实现为按钮。

> 停止将事件处理程序放在 HTML 中，并停止使用不用于锚语义目的的锚标记。使用一个按钮并在您的 Javascript 中添加点击处理程序。示例：HTML`<button id="jquery_stuff">Label</button>`和 JavaScript `$('#jquery_stuff').click(jquery_stuff);`。您可以使用 CSS 将按钮样式设置为看起来像一个链接，方法是删除填充、边框、边距和背景颜色，然后添加您的链接样式（例如颜色和文本装饰）。– 2010 年 10 月 19 日 17:40

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-01-29T22:09:43.957

```
<a href="javascript:;" onclick="jquery">link</a> 
```

`href`如果您希望它不在 html 的验证器中弹出错误，则需要其中的一些东西。这`javascript:;`是一个很好的占位符。

如果你真的想使用`#`：

```
<a href="#me" name="me" onclick="jquery">link</a> 
```

小心`return false;`，它会停止你正在做的任何事情的默认行为。

此外，如果您的 js 类似于提交，您可能会在 Internet Explorer 中遇到问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-29T20:09:50.873

```
<a href="javascript:// some helpful comment " onclick="jquery_stuff" /> 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-02-01T05:18:57.050

当我需要完成类似的事情时，我通常使用 a`<span>`并将其设置为看起来像一个链接。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2013-09-09T13:28:32.853

```
 <a href="#" class="falseLinks">Link1</a>
  <a href="#" class="falseLinks">Link2</a> 
```

ETC..

查询：

```
 $(function() {
    $("a.falseLinks").click(function() {
      // ...other stuff you want to do when links is clicked

      // This is the same as putting onclick="return false;" in HTML
     return false;
    })
  }); 
```

@eyelidlessness 他说的方式有点脏，但他是对的。这是最干净的方法。如果你要回到原生 Javascript 来做 jQuery 更容易和更清洁的东西，为什么还要使用 jQuery？

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2010-10-19T17:36:14.450

通常我会这样做：

```
<a style="cursor:pointer;" onclick="whatever();">Whatever</a> 
```

* * *

## 回答 #11

> 赞同：-4
> 
> 时间：2011-12-24T15:51:22.423

我会使用一个`<button>`元素和纯 JavaScript 来实现你所追求的。但是，如果您坚持，这是接受答案的另一种方法：

```
<a href="#nowhere" onclick="console.log('Hello, world!');">This link goes nowhere because the target doesn't exist.</a>
```

# java - 如何配置文件 I/O？

> ID：493177
> 
> 赞同：8
> 
> 时间：2009-01-29T20:08:53.183
> 
> 标签：java, windows, build-process, profiling

我们的构建速度非常慢。[这是一个用Ant](http://en.wikipedia.org/wiki/Apache_Ant)构建的 Java 系统，我在 Windows XP 上运行我的系统。根据硬件的不同，可能需要 5 到 15 分钟才能完成。

观察机器上的整体性能指标，以及将硬件差异与构建时间相关联，表明该进程受 I/O 限制。它还表明，该过程的阅读比写作多得多。

但是，我还没有找到一个好的方法来确定正在读取或写入*哪些*文件，以及读取或写入了多少次。我的怀疑是，随着我们的许多子项目和编译器的后续调用，构建正在多次重新读取相同的常用库。

有哪些分析工具可以告诉我给定进程正在处理哪些文件？免费很好，但不是必需的。

* * *

正如 Jon Skeet 所建议的那样，使用[Process Monitor，](https://stackoverflow.com/questions/493177/how-can-i-profile-file-i-o/493201#493201)我能够证实我的怀疑：几乎所有磁盘活动都在读取和重新读取库，JDK 的“rt.jar”副本和其他库位于顶部名单。我无法制作足够大的 RAM 磁盘来容纳我使用的所有库，但是将“最热门”的库安装在 RAM 磁盘上可将构建时间缩短约 40%；显然，Windows 文件系统缓存做得不够好，尽管我已经告诉 Windows 对此进行优化。

我注意到的一件有趣的事情是，对[JAR](http://en.wikipedia.org/wiki/JAR_%28file_format%29)文件的典型“读取”操作只有几十个字节；通常有两个或三个，然后在文件中进一步跳过几千字节。它似乎不适合批量读取。

我将在闪存驱动器上对我*所有*的第三方库进行更多测试，看看有什么效果。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-29T20:14:07.060

如果您*只*需要在 Windows 上使用它，SysInternals [Process Monitor](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)应该会向您展示您需要知道的一切。您可以选择进程，然后查看每个操作，并获得文件操作的摘要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-30T01:55:03.610

当我仍然使用 Windows 时，我曾经通过将所有构建输出写入一个单独的分区（如果大小可能为 3 GB）并通过计划任务每​​周一次在晚上定期格式化它来获得良好的结果，从而加快构建速度。它只是构建输出，所以偶尔单方面变平也没关系。

但老实说，自从迁移到 Linux 后，磁盘碎片是我不再担心的事情了。

在 Linux 上至少尝试一次构建的另一个原因是，您可以运行[strace](https://en.wikipedia.org/wiki/Strace)（grepped 以调用*open*）来查看您的构建涉及哪些文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-30T03:30:30.767

一个老东西，但一个好东西：创建一个 RAM 磁盘并从那里编译你的文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-29T20:58:02.680

我曾经在 Windows 上使用 Ant 构建一个大型 Java webapp（JSP 前端），这需要 3 分钟以上。我擦拭了我的电脑并安装了 Linux，突然构建需要 18 秒。这些是真实的数字，尽管大约是 3 岁。我只能假设 Java 更喜欢 Linux 内存管理和线程模型而不是 Windows 等价物，因为根据我的经验（尤其是 Eclipse），所有 Java 程序似乎在 Linux 下运行得更好。当您读取大量未更改的文件（即可执行文件和库）时，Linux 在防止从磁盘读取额外读取方面似乎要好得多。这可能是磁盘缓存或文件系统的属性，我不确定是哪个。

Java 的一大优点是它是跨平台的，因此设置基于 Linux 的构建服务器实际上是您的一个选择。作为一名 Linux 传道者，我当然希望看到你将开发环境切换到 Linux，但我知道很多人不想这样做（或者出于实际原因不能这样做）。

如果您甚至不愿意设置 Linux 构建服务器来查看它是否运行得更快，您至少可以尝试对 Windows 机器的硬盘进行碎片整理。这对在我的工作计算机上构建 C++ 产生了巨大的影响。试试[JkDefrag](http://www.kessels.com/Jkdefrag/)，它似乎比 Windows 附带的碎片整理程序好很多。

**编辑**：我假设我投了反对票，因为我的回答没有解决所提出的确切问题。然而，StackOverflow 的传统是帮助人们解决他们真正的问题，而不仅仅是治疗症状。我不是那种对每个问题的答案都是“使用 linux”的人。然而，在这种情况下，我在 OP 所询问的情况下获得了非常真实的、可衡量的性能提升，所以我认为值得分享我的经验。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-30T03:36:44.577

实际上[FileMon](http://technet.microsoft.com/en-us/sysinternals/bb896642.aspx)是比 ProcMon 更直接的工具。通常，在对磁盘 I/O 运行性能分析时，请考虑以下两个方面：

*   吞吐量（每秒读取/写入字节的速度）
*   延迟（在队列中等待读/写的时间）

一旦根据上述内容评估了系统的性能，就很容易识别瓶颈并采取纠正措施：获得更快的磁盘或更改代码（以更便宜的方式为准）。

# excel - Excel 编程：HRESULT 异常：0x800A03EC。在 Microsoft.office.Interop

> ID：493178
> 
> 赞同：3
> 
> 时间：2009-01-29T20:09:03.417
> 
> 标签：excel, windows-xp, .net-1.1

我创建了一个小应用程序，可以打开、读取和创建 Excel 文件。该应用程序是用 C# 编写的，当应用程序在一台计算机上运行时，我不知道为什么会收到此错误消息。我在我的电脑上运行了相同的应用程序，我没有任何问题。

有人可以帮助我，让我知道为什么会发生这个错误吗？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-29T20:25:51.420

首先，我怀疑 HRESULT 真的是 0x800A03EC（如果您正在谈论错误代码，传达确切的数字很重要 ;-)）。

此错误通常意味着一个或多个公式包含错误。公式在一台机器上运行而不在其他机器上运行的主要原因通常是“语言环境”：检查该机器是否具有不同的数字、日期和/或货币格式设置（逗号与句点等）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-09-12T13:26:39.543

另一个原因可能是我的——出口太早了；Excel 有限制 (http://office.microsoft.com/en-us/excel-help/excel-specifications-and-limits-HP005199291.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-23T19:43:31.177

另一种可能性可能是 Excel 正在读取您作为实际公式输入的值（即，它预计需要计算才能获得单元格值），而不仅仅是值。

例如，如果您的脚本尝试将单元格设置为“====Fake Note by: fakeuser 6/23/14 14:41”，那么它将引发错误。要解决此问题，请检查值的最左侧字符以查看它是“=”、“+”、“-”、“/”还是“*”。如果是，只需添加一个空格作为第一个字符，文本就会正确添加。

# c++ - 在 Ubuntu Eee 上编译内核需要什么？

> ID：493194
> 
> 赞同：1
> 
> 时间：2009-01-29T20:11:23.633
> 
> 标签：c++, linux, ubuntu, linux-kernel, linux-device-driver

我正在尝试按照教程在 Linux 中创建自定义 USB 驱动程序，我希望使用 g++ 在我的 Eee PC 上使用 Ubuntu Eee 开发这个东西。不幸的是，要遵循本教程，我需要 linux/module.h 头文件。据我了解，我需要编译内核才能使其正常工作。我以前从未编译过内核，我找到的所有说明都是针对桌面 Ubuntu 的。

我在我的 Eee 上这样做，因为如果我能做到这一点并在课堂项目中使用它，我将在课堂上获得额外的学分。

我正在关注的教程在这里：[http](http://www.linuxjournal.com/article/7353) ://www.linuxjournal.com/article/7353 和这里：[http ://www.linuxjournal.com/article/4786](http://www.linuxjournal.com/article/4786)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-29T20:34:53.880

大多数（全部？）主要的 Linux 发行版不仅分发 linux 内核，而且还为其应用了许多补丁。从而提高稳定性并添加许多功能。 **所以你会想要使用 Ubuntu 的软件包系统来获取 Ubuntu 的补丁内核源代码！**

**您可能*不需要*重建内核！** 最有可能的是，您只需要当前内核的 kernel-headers 包来编译您的 USB 驱动程序。假设您将其构建为内核模块，然后您可以使用 modprobe 或 insmod 加载它。（lsmod 和 rmmod 也很有用。）

如果您确实需要重建内核，那很容易。（[很简单，我使用内核构建来测试我的硬件。）](http://www.bitwizard.nl/sig11/) 网络上有很多[内核构建 HOWTO](http://www.google.com/search?hl=en&q=kernel+build+howto&btnG=Google+Search&aq=f&oq=)。尝试找出作为模块需要哪些选项、要编译的内容以及要省略的内容会很有趣。您可以使内核更小，但您可能会错过其中的一些内容。

* * *

* * *

修改为：

> > ***我记得做“sudo apt-get install linux-headers-eeepc”，我还需要更多吗？如果不是，那么这些标头在哪里，因为我的包含“linux/module.h”的测试代码无法编译***

[应该有一种方法可以列出该 linux-headers-eeepc 包中的所有](http://www.debian.org/doc/FAQ/ch-pkgtools.en.html)文件。我来自 RedHat/RPM 世界。但我猜想[*dpkg --contents linux-headers-eeepc*](http://www.annodex.net/cgi-bin/man/man2html?1+dpkg)或[*dpkg --listfiles linux-headers-eeepc 之类的东西*](http://www.annodex.net/cgi-bin/man/man2html?1+dpkg)。你可能不得不玩一下。

或者，通过[http://packages.ubuntu.com/](http://packages.ubuntu.com/)判断，像 linux-headers-2.6.27-7 这样的包包含文件 /usr/src/linux-headers-2.6.27-7/include/linux/module。 H。所以你可能只想看看***/usr/src/*/include/linux/module.h。***

或者，尝试：

%**定位 linux/module.h | grep 'linux/module.h$'**

或者

% **find / -path '*/linux/module.h'**

（该*发现*可能需要一段时间才能完成......）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-29T20:41:26.333

从这里：[Ubuntu内核/编译](https://help.ubuntu.com/community/Kernel/Compile) 开始：sudo apt-get install linux-kernel-devel fakeroot build-essential makedumpfile

可能只是阅读该[链接](https://help.ubuntu.com/community/Kernel/Compile)。

[更深入的细节在这里](http://kernel-handbook.alioth.debian.org/)

# c - Sqlite C 用户定义函数

> ID：493197
> 
> 赞同：0
> 
> 时间：2009-01-29T20:12:40.540
> 
> 标签：c, sqlite, function

我正在使用 sqlite C API。
“一切”都在主函数中运行（变量、打开、执行查询、关闭数据库等）。此外，我现在想在其中创建单独的用户定义函数，例如对数据库进行排序.

将 db 对象和变量从 main 传递到这个新函数的最佳方法是什么？将它们全部创建为全局变量？通过引用传递？这是 Sqlite3_create_function 的用途吗？

如果需要，请告诉我如何澄清这个问题。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-29T23:14:25.603

[`sqlite3_create_function`](http://www.sqlite.org/c3ref/create_function.html)接受一个`void *pApp`论点。目的是 this 指向您的函数使用的数据。指针存储在 SQLite 托管函数上下文中。您可以使用[`sqlite3_user_data`](http://www.sqlite.org/c3ref/user_data.html). 由于您分配了内存，因此您可以在应用程序和函数之间共享它。

这种机制并不比使用全局更难，并且如果您决定稍后再做的话，它还支持多线程应用程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-30T13:59:03.867

将 sqlite3 *db 指针作为参数传递给您的函数。

或者使用[快速入门指南中的回调](http://www.sqlite.org/quickstart.html)

# c++ - 在 C++ 代码中创建 XML

> ID：493200
> 
> 赞同：9
> 
> 时间：2009-01-29T20:13:28.107
> 
> 标签：c++, xml, dom

在我的项目中，有时我们必须在模块之间发送 xml 消息（如 char *）。它们并不是很大，只有 10-15 行。现在每个人都只是自己创建字符串。我不认为这是正确的方法。我们已经在使用 xerces DOM 库。那么为什么不创建一个 Dom 树，序列化它，然后发送它。

你们有什么建议？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-29T20:17:48.907

如果您真的只是在创建小的 XML 消息，那么 Xerces 是一个矫枉过正的工具，恕我直言。它是一个解析器库，您不解析任何内容。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-29T21:58:55.630

您可以使用 DOM 或编写自己的小型 C++ XML 生成框架。

Xerces API 是从 Java 移植而来的，通过使用对象作用域，您可以更轻松地从 C++ 代码生成 XML：

```
XmlWriter w;
Elem book = w.Element("book");
book.addAttrib("title", "Lord of the Rings");
Elem author = e.addChild("author");
author.addAttrib("age", 43);
author.addText("Tolkien"); 
```

这将产生以下 XML：

```
<book title="Lord of the Rings">
  <author age="43">Tolkien</author>
</book> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-30T00:00:42.763

快速简单，试试 TinyXml API：
[http ://www.grinninglizard.com/tinyxml/](http://www.grinninglizard.com/tinyxml/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-29T20:17:25.303

我建议创建 DOM 树。您不必担心在数据中转义 XML 字符。如果一位开发人员忘记了一次，您的用户输入可能会导致您的 XML 输出不正确。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-29T22:26:43.110

手工创建 XML 是我所知道的最可靠的疯狂方法之一。最终有人会在某个地方搞砸一个实体，或者一个后括号会被省略，或者其他什么......只需使用一个库。[GenX](http://www.tbray.org/ongoing/When/200x/2004/02/20/GenxStatus "GenX")将是我的选择。

**编辑：**误读您的帖子。如果您已经有一个生成库，请使用它。如果可以避免，请不要使事情不必要地复杂化。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-29T20:15:21.207

**指标**

比较你手动创建字符串十几次需要多长时间，然后比较库需要多长时间。

如果你的团队成员和我一样，他们会很快改变态度。

另外，如果他们编码错误等，请考虑质量检查时间......

尽可能多地使用图书馆。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-29T21:50:41.513

我想在嵌入式设备之间传递 xml 消息时遇到了同样的问题。

我编写了以下内容（全部在一个头文件中）作为解析和生成 xml 的快速 api。它不支持所有的 xml 特性，但大多数简单的 xml 消息都不需要它们：

[http://www.scottlangham.co.uk/2009/01/rapidxml-a-quick-xml-parsergenerator-for-c/](http://www.scottlangham.co.uk/2009/01/rapidxml-a-quick-xml-parsergenerator-for-c/)

评论中显示了示例用法。

要编写 xml，您可以执行以下操作：

```
int isbn = 2938237;
wstring authorName = "Isaac Asimov";
wstring borrower = "Mr. Blobby";

CWTag bookTag = libraryTag(L"Book")
    (L"author",authorName) (L"isbn",isbn) (L"borrower",borrower);
bookTag(L"Review") (L"comments", L"very good"); 
```

这会导致在标签下添加新的 xml：

```
<Book author="Isaac Asimov" isbn="2938237" borrower="Mr. Blobby">
    <Review comments="very good"/>
</Book> 
```

我们确实尝试了另一个库，我不记得是哪个库了，发现它不够快。我们不想坚持手动格式化字符串，因为我们要处理大量的消息。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-29T20:35:30.870

我只会使用 DOM 树。这样您就不必在发送和接收 xml 字符串时来回解析数据。

--- 稍微偏离主题：对于其他人只是通过这篇文章而偶然需要一个超轻量级 DOM xml 框架，请使用这个： http: [//www.applied-mathematics.net/tools/xmlParser.html](http://www.applied-mathematics.net/tools/xmlParser.html)

它非常易于使用，由 2 个文件组成。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-29T22:25:49.337

如果您要创建中型到大型 XML 文件，则需要一个库来帮助您。如果您正在创建一个很小到很小的 XML 文件，您不妨将文本流式传输到其中。

```
astream << "<book title=\"Lord of the Rings\"><author age=\"43\">Tolkien</author></book>" 
```

对于那个大小的 XML 片段，你可以得到尽可能简单的东西，如果你的 XML 文件是那个大小，你也可以用这种方式构建它们——不要试图把事情过度复杂化，只是为了一些实际上并没有的纯粹主义理想帮你。

就像优化一样，你永远不应该在没有衡量它会产生什么影响的情况下改变它。在这里，如果您的代码可以按原样维护，请继续使用它。仅当您测量了它的可维护性（即注意到更新 XML 很尴尬）并发现它花费的时间太长时才尝试更改它。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-29T22:58:31.110

我实际上使用 FirstObject.com 的**[CMarkup](http://www.firstobject.com/)**。

CodeProject 有一个较旧的发行版和文本教程（[http://www.codeproject.com/KB/cpp/markupclass.aspx](http://www.codeproject.com/KB/cpp/markupclass.aspx)）

源代码分发可用，并且该组件通过 FirstObject 下载页面提供多种风格（开发人员、高级开发人员）。

FirstObject 网站包含许多有用的示例，它们甚至分发了免费的 XML 编辑器。

不，我不是员工，但我是组件的满意所有者。

# jquery - 尝试发布数据时，使用 Jquery 调用 .Net Web 服务会导致问题

> ID：493209
> 
> 赞同：9
> 
> 时间：2009-01-29T20:16:24.120
> 
> 标签：jquery, ajax, web-services, .net-3.5

以下代码在 data 键没有数据要发送时正确执行，即 data: "{}" 一个空的 JSON 对象并且 web 服务不带任何参数。我想将一些数据发布到网络服务，但我遇到了麻烦。

当我尝试将其设置为 data:"{'name':'Niall','surname':'Smith'}" 时，出现错误

```
{"Message":"Invalid web service call, missing value for parameter: \u0027json\u0027.","StackTrace":"   at System.Web.Script.Services.WebServiceMethodData.CallMethod(Object target, IDictionary`2 parameters)\r\n   at System.Web.Script.Services.WebServiceMethodData.CallMethodFromRawParams(Object target, IDictionary`2 parameters)\r\n   at System.Web.Script.Services.RestHandler.InvokeMethod(HttpContext context, WebServiceMethodData methodData, IDictionary`2 rawParams)\r\n   at System.Web.Script.Services.RestHandler.ExecuteWebServiceCall(HttpContext context, WebServiceMethodData methodData)","ExceptionType":"System.InvalidOperationException"} 
```

未执行 Web 服务。

这是我的 Jquery 调用，用于将我的数据发送回服务器。

```
 $.ajax({
        type: "POST",
        url: "/WebServices/BasketServices.asmx/AddItemToBasket",
        data: "{'name':'niall'}", // Is this Correct??
        contentType: "application/json; charset=utf-8",
        dataType: "json",
        success: OnItemAddedSuccess
    });
function OnItemAddedSuccess(result,eventArgs) {
    //deserialize the JSON and use it to update the Mini Basket
    var response = JSON.parse(result.d);
} 
```

这是我的网络服务

```
[WebService(Namespace = "http://tempuri.org/")]
[WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
[System.ComponentModel.ToolboxItem(false)]
[System.Web.Script.Services.ScriptService]
public class BasketServices : System.Web.Services.WebService
{
    [WebMethod(true)]
    public string AddItemToBasket(string json)
    {
       //do stuff
       return myString.toJSON();
    }
} 
```

问题可能是什么？是要发布的 JSON 数据的格式吗？可能是我没有在我的 WebService 上设置正确的属性。[Dave Ward 的帖子](http://encosia.com/2008/06/05/3-mistakes-to-avoid-when-using-jquery-with-aspnet-ajax/)中提到的问题呢？

我已经尝试了我能想到的一切。有没有人有任何想法？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-29T20:27:02.913

我认为网络服务期望设置参数`json`。试试这个 AJAX 调用：

```
var data = {'name':'niall'};

$.ajax({
    type: "POST",
    url: "/WebServices/BasketServices.asmx/AddItemToBasket",
    data: "json=" + JSON.stringify(data),
    contentType: "application/json; charset=utf-8",
    dataType: "json",
    success: OnItemAddedSuccess
}); 
```

哪里`JSON.stringify()`有一种类似于“官方”实现中的方法：http: [//json.org/js.html](http://json.org/js.html)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-06-28T20:00:49.963

上面的解决方案对我不起作用。所以我做了以下事情。1.) 确保 javascript 对象属性（此处为 ID 和 Quantity）确实与您的 web 服务的参数具有相同的名称和相同的类型（在本例中为 number == int） 2.) 不要将对象包装到一个数据传输对象（DTO），但只是将它们字符串化 感谢[Yasin Tarim](http://yasintar.blogspot.com/2010/03/aspnet-ajax-how-to-send-complex-objects.html)，它提供了我需要让它工作的提示

```
// javascript object
var cartItem = {"ID": 123, "Quantity": 2}

$.ajax({
    type: "POST",
    url: "/WebServices/BasketServices.asmx/AddItemToBasket",
    data: JSON.stringify(cartItem),
    contentType: "application/json; charset=utf-8",
    dataType: "json",
    success: function (data) { OnSuccess(cartItem, data); },
}); 
```

```
    // ASMX 服务器端代码
    [WebMethod(Description = "将商品添加到 ShoppingCart")]
    [ScriptMethod(UseHttpGet = false, ResponseFormat = ResponseFormat.Json)]        
    公共字符串 AddItemToBasket(int ID, int Quantity)
    {            
        CartItem cI = new CartItem();
        cI.iD = ID；
        cI.qty = 数量；
        CartItem.SaveToDatabase(ci);
        返回“来自 Web 服务的 foo - 它有效”；
    }

```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-29T20:26:58.937

这应该有效。您应该将 json 作为字符串传递，参数名称为“json”（与 Web 方法中的参数名称相同。

`data: "{json: '{\'name\':\'niall\'}'}",`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-29T20:33:23.667

当我不使用双引号将字符串数据括起来时，这总是发生在我身上

# linux - ARM架构的Linux交叉编译

> ID：493210
> 
> 赞同：20
> 
> 时间：2009-01-29T20:16:28.537
> 
> 标签：linux, embedded, x86, arm

我有兴趣在 x86 主机上为 ARM 目标交叉编译 Linux 内核。你有什么好的做法推荐吗？您认为哪个是最好的交叉编译套件？您是否设置了自定义交叉编译环境？如果是，您有什么建议？这是个好主意吗？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-01-30T16:10:01.857

我对 ARM/Linux 工具使用了两种方法。最简单的方法是直接下载预先构建的工具链。
**优点**：它只是工作，你可以继续你项目中有趣的部分
**缺点**：你被他们选择的任何版本的 gcc/binutils/libc 卡住了

如果后者对您很重要，请查看[crosstool-ng](http://crosstool-ng.org/)。本项目是一个类似于Linux内核配置应用程序的配置工具。设置要构建的 gcc、binutils、libc（GNU 或 uCLibc）、线程和 Linux 内核的版本，其余的由 crosstool-ng 完成（即下载 tar 球、配置工具并构建它们）。
**优点**：你得到你在配置过程中选择的东西
**缺点**：你得到你在配置过程中选择的东西

这意味着您对编译器/binutil/libc 及其相关功能/缺点/错误的选择承担全部责任。此外，正如评论中提到的，在选择 binutils、C 库等版本时存在一些“痛苦”，因为并非所有组合都必须一起工作甚至构建。

一种混合方法可能是从预先构建的工具开始，然后在必要时通过 crosstool-ng 将它们替换为自定义解决方案。

**更新**：答案最初使用[CodeSourcery 工具](http://www.codesourcery.com/gnu_toolchains/arm)作为预构建工具链的示例。ARM 的 CodeSourcery 工具[可从 Mentor Graphics 免费下载](http://www.mentor.com/embedded-software/sourcery-tools/sourcery-codebench/editions/lite-edition/)，但现在称为 Sourcery CodeBench，必须从 Mentor Graphics 购买。其他选项现在包括[Linaro](http://www.linaro.org/downloads/)以及来自 Android、Ubuntu 等的分发特定工具。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-29T21:27:21.873

我使用 emdebian 工具链为我的 ARM 机器编译一些不喜欢在可用的小资源中本地编译的东西（/me 盯着内核）。主包是`gcc-4.X-arm-linux-gnueabi`(X = 1,2,3)，并提供适当后缀的 gcc/cpp/ld/etc 命令。我将此添加到我的`sources.list`：

```
deb http://www.emdebian.org/debian/ unstable main 
```

当然，如果您不使用 Debian，这可能不是那么有用，但*口香糖*对我来说效果很好。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-29T20:31:20.520

我在尝试为使用 ARM 处理器的 maemo (Nokia N810) 构建应用程序时使用了[scratchbox 。](http://www.scratchbox.org/)据说，scratchbox 不仅限于 maemo 开发。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-01-29T21:28:21.167

我在几个目标上使用了 crosstool。只要您想从头开始构建工具链，那就太好了。当然，还有几个用于 arm 的预构建工具链，只需 google 即可 - 这里太多了。

1）在我看来，构建自己的工具链效果最好。您最终可以对所有内容进行严格控制，此外，如果您是嵌入式 linux 的新手，那将是一次很棒的学习体验。

2）不要使用商业工具链。即使您不想花时间构建自己的，也有免费的替代品。

如果你的公司愿意花钱，让他们给你买一个 jtag 调试器。
**它将为您节省大量时间。** 它使您可以轻松学习和逐步完成内核启动等。我强烈建议使用[Lauterbach](http://www.lauterbach.com) jtag 产品...它们可以处理大量目标，并且该软件是跨平台的。他们的支持也很棒。

如果您无法获得 jtag 调试器并且您正在内核中工作，请使用 VM 来执行此操作，用户模式 ​​linux、vmware..etc.. 您的代码将在 x86 上进行调试.. 将其移植到您的 arm 目标将是一个不同的故事，但它是消除一些错误的更便宜的方法。

如果要移植引导加载程序，请使用 uboot。当然，如果您使用的是参考平台，那么您最好使用它们随 BSP 提供的东西。

我希望这会有所帮助。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-01-30T16:29:49.133

[Buildroot](http://buildroot.uclibc.org/)是一个我相当幸运的工具，用于从头开始构建基于 uClibc 的自定义工具链。它是非常可定制的，并且不会过分关注您碰巧在哪个发行版上运行。

此外，它的许多现有用户（即嵌入式路由器发行版）也瞄准了 ARM。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-29T21:31:18.790

如果您使用的是 Gentoo，那么获得交叉编译工具链就像

```
$ 出现交叉开发
$ crossdev -t $ARCH-$VENDOR-$OS-$LIBC
```

其中`ARCH`是`arm`或`armeb`，供应商是`unknown`或`softfloat`，`OS`是`linux`，并且`LIBC`是`gnu`或`uclibc`。

如果您想要的只是内核的编译器（和链接器），则该`LIBC`部分无关紧要，您可以使用`-s1`/`--stage1`来告知`crossdev`您只需要`binutils`和`gcc`.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-29T20:25:42.013

[这就是 Eurotech](http://support.eurotech-inc.com/forums/topic.asp?TOPIC_ID=2697)用于他们的 Debian ARM 分布的东西。您会注意到，如果可以避免的话，他们不建议使用交叉编译器。在目标本身上编译往往是一种更可靠的方式来获取您知道将运行的输出。

# iphone - 如何实现我自己的缩放但仍然可以访问 UIScrollView 的滚动？

> ID：493219
> 
> 赞同：0
> 
> 时间：2009-01-29T20:17:52.667
> 
> 标签：iphone, objective-c, zooming

我想使用 UIScrollView 的滚动/平移功能，但我想自己处理所有的缩放和缩放。我目前的计划是拥有一个拥有多个 UIView 和 UIScrollView 作为子项的 UIView（我称之为 view1）的 viewController。

view1 是否可以处理所有多点触控事件（以便手动呈现他所有孩子的缩放状态）并将结果绘制到每个相应的滚动视图上以允许用户滚动结果？

（出于好奇，该应用程序正在绘制多个热图，每个热图都有自己的一组轴。在缩放或滚动时，轴需要更新自身以正确标记数据区域（滚动视图）中表示的范围。原因我不能使用scrollView免费提供的默认上下文图像缩放缩放是在上下文缩放上绘制的任何东西（包括参考线之类的东西）。缩放动作并不是实际上使事情变大，而是调整可视数据范围。）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-04T22:12:35.927

您确实可以让主托管视图拦截多点触控事件并以编程方式对底层 UIViews 进行缩放。这就是我在[我的应用程序的 OpenGL 显示部分中所做的（](http://www.sunsetlakesoftware.com/molecules)[此处](http://www.sunsetlakesoftware.com/2008/10/02/molecules-source-code-now-available)提供源代码）。您仍然可以将单点触摸事件传递给底层滚动视图以进行平移等。

但是，仍然可能有一种方法可以在不拦截触摸事件的情况下执行您所描述的操作。UIScrollView 通过对内容视图应用转换来进行默认缩放。为了回答[这个问题](https://stackoverflow.com/questions/448285/how-do-i-reset-after-a-uiscrollview-zoom/451629#451629)，我描述了一种在捏缩放完成后以新比例重新渲染内容视图的方法。这将让您在缩放完成后用清晰的网格线刷新您的绘图。

此外，如果您没有真正缩放并且您想通过捏缩放来更改视图的另一个属性，您可以执行我在该问题中描述的操作并截取 contentView 上的转换设置，只是不要应用转换。您可以从该转换中提取 UIScrollView 想要设置的比例，然后对视图进行自定义重绘作为响应。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-13T17:38:59.533

谢谢你的建议布拉德。我最终使用的解决方案是扩展 UIScrollView 并使用以下方法覆盖 touchesMoved:withEvent: 方法：

```
-(void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event
{
    if ([[event touchesForView:self] count] == 1) 
         [super touchesMoved:touches withEvent:event];
    [content touchesMoved:touches withEvent:event];
} 
```

其中“内容”是指向我的滚动视图的内容子视图的指针。我必须这样做，因为我的内容需要缩放到点（即，用户手指下的数据空间中的点不应该改变）。发送给 setTransform: 的信息只能告诉我内容框架的大小，但我还需要其中的偏移量。

# mysql - 在 DateTime 中删除时间

> ID：493223
> 
> 赞同：17
> 
> 时间：2009-01-29T20:18:55.130
> 
> 标签：mysql, sql, tsql, datetime

我有一个问题，我的表将日期存储为

```
2009-01-10 10:00:00.000 
```

我有另一个表将日期存储为

```
2009-01-10 12:00:00.000 
```

我知道它们不一样，但日期是一样的，SQL 中是否可以轻松删除时间并仅保留日期以进行比较？谢谢。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-01-29T20:21:47.667

运行这个

```
SELECT DATEADD(dd, DATEDIFF(d, 0, Getdate()), 0) 
```

将 Getdate() 更改为您的列名以删除日期

顺便说一句，如果您要进行比较，最好使用 >= 和 < 因为它的性能会更好

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2011-07-22T16:36:51.590

您可以使用以下语法：-

`CAST(date_field AS DATE) as column_name`

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-29T20:20:38.403

看[这里](https://stackoverflow.com/questions/202243/custom-date-time-formatting-in-sql-server/202288#202288)

你想要第一个。

```
SELECT (CAST(FLOOR(CAST(GETDATE() as FLOAT)) AS DateTime)) 
```

不要使用任何到 varchar 的转换，它们很慢。

**编辑**：@feihtthief - 这是一种从快速的临时数字表中填充日期表（时间为 0）的方法。如果需要，对其进行编辑以保存数字表。它们也很方便。

```
DECLARE @DaysFromGoLive int                                                                                 
SET @DaysFromGoLive = (SELECT (DATEDIFF(dd,'10/01/2007',GETDATE()) + 1)) /* Days from go live is the starting date of the table */

 SELECT TOP 10950 --30 years of days                                                                        
        IDENTITY(INT,1,1) as N                                                                              
   INTO #Numbers                                                                                            
   FROM Master.dbo.SysColumns sc1,                                                                          
        Master.dbo.SysColumns sc2                                                                           

CREATE TABLE [dbo].[TableOfDates](                                                                      
    [fld_date] [datetime] NOT NULL,                                                                           
 CONSTRAINT [PK_TableOfDates] PRIMARY KEY CLUSTERED                                                         
(                                                                                                           
    [fld_date] ASC                                                                                            
)WITH FILLFACTOR = 99 ON [PRIMARY]                                                                          
) ON [PRIMARY]                                                                                              

INSERT INTO                                                                                                 
      dbo.TableOfDates                                                                                  
SELECT                                                                                                      
      DATEADD(dd,nums.n - @DaysFromGoLive,CAST(FLOOR(CAST(GETDATE() as FLOAT)) as DateTime)) as FLD_Date    
FROM #Numbers nums                                                                                          

SELECT MIN(FLD_Date) FROM dbo.TableOfDates                                                              
SELECT MAX(FLD_Date) FROM dbo.TableOfDates                                                              

DROP TABLE #Numbers 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-29T20:29:39.133

如果您使用的是 MS SQL Server 2008，您也可以更改为新的 DATE 数据类型，而不是使用 DATETIME。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-29T20:25:47.520

这是一种方法：

```
declare @d datetime
set @d = getdate()

select dateadd(d, datediff(day, 0, @d), 0) 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-30T08:19:59.480

转换为 varchar 很慢。不要这样做。Datediff 解决方案是最快的，如果您要与日期进行比较，您甚至不必使用 dateadd（或转换为 datetime），因为整数会隐式地与日期进行比较，没有问题，如下所示：

```
WHERE SomeDate = DateDiff(d, 0, GetDate()) 
```

Mark Brittingham 关于连接两个表的建议非常好。并按照建议与单个日期进行比较，请使用：

```
WHERE A.Dt >= @SomeDate AND A.Dt < @SomeDate + 1 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-29T21:49:03.653

所有这些解决方案（SQL Server 2008 数据类型帖子除外）都是基于行的解决方案。它们在小桌子情况下可以正常工作，但在非常大的桌子情况下会搅动。如果您不在 2008 年，您是否可以选择将日期存储为年、月和日的单独整数字段或作为某个固定日期的计算？

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-29T21:52:01.213

在 Oracle 中，您可以执行 trunc(DateTime) 来摆脱时间组件。（有像 trunc(DateTime, 'MONTH') 这样的变体，它给出了当月的第一个日期。）不确定这是否是标准 SQL，但我确信其他数据库中会有类似的函数。

这应该比使用转换函数快得多。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-09-09T15:23:59.873

像这样的 SQL CLR 函数应该对它：

```
public partial class UserDefinedFunctions
{
    [Microsoft.SqlServer.Server.SqlFunction]
    public static SqlDateTime StripTime(SqlDateTime date)
    {
        return date.IsNull ? SqlDateTime.Null : new SqlDateTime(date.DayTicks, 0);
    }
}; 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-29T22:06:58.517

在我看来，SQLMenaces 建议是从日期中删除超时的最快方法。然而，它也确实通过删除使用索引的能力使一些查询像猪一样突突...

```
[A] JOIN [B] ON SQLMenace([A].datetime) = SQLMenace([B].datetime)

(Where SQLMenace() is the operation he described *grin*) 
```

要在第二张表上使用允许使用索引，它只需要一个小的适应...

```
[A] JOIN [B] ON [A].datetime >= SQLMenace([B].datetime) AND [A].datetime < SQLMenace([B].datetime) 
```

这应该会导致对 [B] 的扫描和对 [A] 的索引查找...

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-29T21:32:06.463

我的建议是确定一个标准并更改其中一个表以匹配另一个表。否则，您的应用程序代码将不得不永远记住哪个表使用哪个方法。确定一个标准并坚持下去。如果在一张桌子上确实总是午夜，而在另一张桌子上总是中午，那么日期的时间部分无论如何都没有意义。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-29T21:39:02.707

有很多关于抽出时间的好建议，*但*如果您只是在寻找一种比较天数而不考虑时间组件的方法，请执行以下操作：

```
Select * From SomeTable Where (DateDiff(d, FirstDate, SecondDate) = 0) 
```

也就是说，将 DateDiff 与“d”参数一起使用来进行比较，而不是“=”。

以防万一那是你*真正*追求的......

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-01-29T21:59:57.127

我最喜欢的仅显示（和比较）日期的方法是使用：

```
convert(char(10),getdate(),101) 
```

其中 getdate() 可以是您的日期时间值。

我相信它会转换为 MM/DD/YYYY 的格式

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-01-29T22:47:14.113

StingyJack 是对的，但根据您想要做的事情，如果您从不需要时间部分，您可能是更好的服务器将日期存储为整数。

```
create table #datedemo(
 id         integer primary key identity(1,1) not null
,date       datetime not null
,dateint    int 
)

insert into #datedemo (date)
          select '2009-Jan-29 02:12:00'
union all select '2009-Jan-29 16:22:00'
union all select '2009-Jan-30 00:32:00'
union all select '2009-Jan-30 13:42:00'
union all select '2009-Jan-31 01:52:00'
union all select '2009-Feb-01 12:02:00'

update #datedemo set dateint = floor(cast(date as float))

select id,date,dateint,cast(dateint as datetime) from #datedemo
where dateint = floor(cast(cast('2009-Jan-30' as datetime)as float))

drop table #datedemo 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2011-08-21T21:19:58.047

根据您将时间归零的原因...

对我来说，经常这样我可以***比较两个日期***。在这种情况下，如果可以的话，你最好坚持 >=、<= 比较（避免 =、<>）。这样，您可以在 WHERE 子句中进行比较，而不会失去索引的好处。

如果您在 SQl-Server 2008 上，他们现在有一个 DATE 数据类型（不包括时间）

您可以使用一些创造性的存储格式——例如，YYDDD 的 smallint（smalldatetime 大小的一半），其中 DDD 是儒略日期（一年中的每一天按从 1 到 365 的顺序编号）。这是一个较小的数据类型，适用于 >,=,< 比较。缺点是在进行比较之前必须将外部日期转换为这种格式（或反之亦然）。

我想最后要考虑的一件事是首先防止时间数据被存储。

您也可以执行`YEAR()`,`MONTY()`等，这将返回整数值。可能不适合比较日期，但对格式化等很有用。

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2009-01-29T22:06:44.367

> 我知道它们不一样，但日期是一样的，SQL 中是否可以轻松删除时间并仅保留日期以进行比较？谢谢

好吧，如果字段的数据类型是**smalldatetime**而不是**datetime**，您将只能使用和更新日期，无论您插入什么，时间都将始终为 00:00:000。

* * *

为了避免日期问题，我个人总是使用

```
CONVERT( smalldatetime, @myDate, 103 ) 
```

一直是 103（[你可以在帮助中看到](http://msdn.microsoft.com/en-us/library/ms187928.aspx)）它是 dd/mm/yyyy 并且对我来说工作得很好，我确实使用了这种技术，因为我使用英国/法国日期格式并且服务器在美国，在那里他们改变了一切:-D

> 这是那段时间（6 年前）我脑海中浮现的唯一想法，我坚持了下来。

但是，您可以考虑，而不是添加**DateTime**字段，而是添加一个**int**并放置自 01-01-1970 以来的秒数，您将永远不会遇到 Date 问题，并且每次需要获取 Date 时，只需减去当前日期那些秒。

这种技术在跨国大型项目中非常有用，以避免出现问题，例如，世界知名的 CRM 应用程序[SuperOffice](http://www.superoffice.com)

# css - 多个 CSS 伪类

> ID：493232
> 
> 赞同：43
> 
> 时间：2009-01-29T20:21:05.547
> 
> 标签：css, syntax

将多个伪类应用于选择器的正确 CSS 语法是什么。我想在列表中的每个项目之后插入“，”，除了最后一个。我正在使用以下CSS：

```
ul.phone_numbers li:after {
    content: ",";
}

ul.phone_numbers li:last-child:after {
    content: "";
} 
```

这在 FF3、Chrome 和 Safari 3 上运行良好。IE7 不起作用，因为它不支持 :after（如预期的那样）。在 IE 8 中，这在每个 li （包括最后一个）之后用逗号呈现。这是 IE8 的问题还是我的语法不正确？如果它在 IE8 中不起作用也没关系，但我想知道正确的语法是什么。

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2009-01-29T20:33:56.253

`:last-child`是一个伪类，而`:after`（或`::after`在 CSS3 中）是一个伪元素。

引用[标准](http://www.w3.org/TR/CSS21/selector.html#pseudo-classes)：

> 选择器中的任何位置都允许使用伪类，而伪元素只能附加在选择器的最后一个简单选择器之后。

这意味着您的语法根据 CSS2.1 和[CSS3](http://www.w3.org/TR/css3-selectors/#selector-syntax)也是正确的，即 IE8 仍然很烂；）

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-29T20:33:06.460

您可以使用[相邻的兄弟选择器](http://www.w3.org/TR/css3-selectors/#adjacent-sibling-combinators)：

```
ul.phone_numbers li + li:before {
   content: ",";
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-05-03T17:17:36.567

There is no problem nesting pseudo class selectors as long as the rules applied match the particular element in the DOM-tree . I want to echo the possibilities of styling with pseudo class selectors from [w3 website](https://www.w3.org/TR/CSS21/selector.html%23id-selectors) . That means you can also do stuff like :

```
.ElClass > div:nth-child(2):hover {
    background-color: #fff;
    /*your css styles here ... */
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-05-31T15:38:03.010

您可以通过在内部添加另一个标签`<li/>`并将其应用于该标签来解决此问题`:after`。这样您就可以将`:last-child`and`:after`应用于不同的元素：

```
ul.phone_numbers li > span:after {
    content: ",";
}

ul.phone_numbers li:last-child > span:after {
    content: "";
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-29T20:28:15.050

IE8 不支持 last-child :( 他们专注于整理它看起来像的 CSS 2.1 支持。为什么微软还没有采用 Gecko 或 Webkit 我不知道。

[http://msdn.microsoft.com/en-us/library/cc351024(VS.85).aspx#pseudoclasses](http://msdn.microsoft.com/en-us/library/cc351024(VS.85).aspx#pseudoclasses)

# java - Java中的布尔表达式

> ID：493233
> 
> 赞同：3
> 
> 时间：2009-01-29T20:21:13.627
> 
> 标签：java, boolean, return

我对 Java 中 return 语句中布尔变量的含义（评估）有疑问。

我知道：

```
if (var) { ... } 
```

是相同的：

```
if (var==true) { ... } 
```

在第二种情况下，我们明确地说 var==true，但我们不需要这样做，因为 Java 无论如何都会将 var 评估为 true。我希望我已经正确理解了这一点。

我的问题是：返回布尔变量时是否相同？当我们有一个 return 声明？

例如，一个任务指定：只有当 b < a 时，looksBetter() 方法才会返回 true。我的解决方案是：

```
public boolean looksBetter() {
     if (b < a) {
         return true;
     } else {
         return false;
     }
} 
```

简单的答案是：

```
public boolean lookBetter() {
      return b < a;
} 
```

所以，这里我们似乎再次有了这个隐含的假设，即如果 b < a == true，则方法的返回为 true。对不起......这似乎很微不足道，但我对此感到不舒服，我不知道为什么。谢谢你。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-29T20:26:46.097

这不是“隐含的假设”，而是编译器正在做的事情。这`b < a`只是一个表达式，就像它被用于一个`if`语句一样。该表达式的计算结果为 a `boolean`，然后返回。

同样值得注意的是，您似乎可以互换`boolean`，`Boolean`好像它们是相同的，但实际上并非如此。`boolean`是[原始](http://java.sun.com/docs/books/tutorial/java/nutsandbolts/datatypes.html)形式，`Boolean`而是包装 a[的对象](https://java.sun.com/javase/6/docs/api/java/lang/Boolean.html)`boolean`。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-01-29T20:27:01.730

是的，这适用于所有布尔值。您可以考虑 if(expression) 评估“表达式”以查看它是“真”还是“假”。当你这样做

```
if(b < a == true) 
```

它首先测试是否 b < a，如果是，它现在测试：

```
if(true == true) 
```

它现在测试是否 true == true（它显然是这样做的）。当您省略额外的“== true”时，Java 并没有做任何棘手的事情，它只需要执行更少的测试。你没有理由不能说：

```
if(((b < a == true) == true) == true) 
```

但它会导致 Java 在每次看到等号时执行额外的测试。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-29T20:27:28.420

不要不必要地使您的代码复杂化。如果你觉得有必要说“a < b == true”，那么你可以按照它的逻辑混乱（结论+混乱）说“ `((((((((...(a<b) == true) == true).... == true)`”

"a < b" 是一个布尔表达式。如果您已经有一个布尔值，为什么要将它与另一个布尔值进行比较？您不会以这种方式使其*更加*布尔值。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-29T20:34:38.563

Java 条件需要一个布尔值。如果您可以将其放入 if 语句中，则它已经是布尔值，如果您想要的是布尔值，则无需进一步摆弄。

事实上，像这样的结构`value == true`可能很棘手。我不记得 Java 中的提升规则，但在 C++ 中，bool 可以提升为 int，false 变为 0，true 变为 1。因此，`int a = 2; if (a)`and`int a = 2; if (a == true)`会做不同的事情。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-10-25T08:57:34.333

如果您尝试将运算符视为方法，您的困惑可能会得到缓解。使用您的示例，您有 <“小于”运算符。对于我们的目的，< 操作符实际上可以被认为是一个“方法”（它只是看起来不像一个），它接受两个参数并返回一个布尔结果。如果“方法”被命名为 lessThan，那么您的示例将等同于：

```
public boolean lookBetter() {     
  return lessThan(b, a);     
} 
```

也许这样看会让它更容易理解？顺便说一句，当我在大学的“编程 101”课程中带领练习小组时，事实证明这是迄今为止最难教的东西，而且很多人都难以掌握其中的概念。它几乎似乎类似于学习骑自行车或游泳，一旦你了解了它的工作原理，它在某种程度上就变得不言而喻了。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-29T21:00:06.297

我想你是在问为什么你对它有概念上的问题。

我认为基本问题是，当你直接返回一个布尔值时，你错过了一些东西，你就是。在您的情况下，它是方法名称。

你的 LooksBetter 没有任何意义。你真正的想法是这样的：

```
boolean isEarlier(Time a, Time b) {
    if(a < b) //for simplicity let's ignore that this won't work.
        return true;
    else
        return false;
} 
```

现在，您可以将其简化为：

```
boolean isEarlier=a < b; 
```

嗯，现在我们可以看到 a 比 b 早，这就是中间值 isEarlier 的意思。

因此，一旦您将中间值内化，这更有意义：

```
boolean isEarlier(Time a, Time b) {
    return a < b;
} 
```

您必须将“布尔”视为一个实际值，而不仅仅是某种中间状态。如果它让您感到不舒服，请随意将其设为变量（它真的不会花费任何成本，并且可能现在对您来说更具可读性）。

稍后您将回顾您的代码，并且更容易接受更短的查看方式。您的思想通常需要时间来开辟一些新的道路，同时不要因为明确而感到尴尬。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-29T20:28:00.027

就像 C++ 一样，每个语句都有一个返回值，即使是运算符左侧的东西。我见过的一些更疯狂的 C++ 在左侧有操作，它们的结果被分配给。

如果我执行以下操作，我发现它会更好：

```
bool result = (b > a);
return result; 
```

唯一的原因是更容易调试（在几乎任何 IDE 中）。我发现我总是用括号括起来，我不太清楚为什么。我认为它使可变电子在晚上睡觉时保持温暖。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2009-01-29T20:29:37.793

您的方法将起作用，但可能有点不清楚究竟应该发生什么，特别是如果您只有名为 a 和 b 的变量。您想要记录该方法并拥有具有正确名称的变量。

此外，如果代码刚写完就让您感到困惑，请想一想将在 6 个月后出现并且不知道发生了什么的人。适当的文档和评论将有很大帮助。

# deployment - 如何将 IIS 7 站点迁移到另一台服务器？

> ID：493236
> 
> 赞同：115
> 
> 时间：2009-01-29T20:22:38.913
> 
> 标签：deployment, iis-7, migrate

我想知道将网站移动到另一台服务器的最佳做法是什么（以及所有设置等）

*   在新服务器上手动重新创建站点（由于显而易见的原因无法维护）
*   复制 applicationHost.config 设置文件
*   使用 appcmd 进行备份和恢复
*   使用 MSDeploy 在新机器上发布站点
*   使用第 3 方工具

只是想知道别人的经历是什么。

* * *

## 回答 #1

> 赞同：146
> 
> 时间：2009-01-29T20:55:17.507

我会说在 IIS 管理器中导出您的服务器配置：

1.  在 IIS 管理器中，单击服务器节点
2.  转到“管理”下的共享配置
3.  单击“导出配置”。（如果您通过互联网发送它们，您可以使用密码，如果您只是要通过 USB 密钥移动它们，请不要担心。）
4.  将这些文件移动到新服务器

    ```
    administration.config
    applicationHost.config
    configEncKey.key 
    ```

5.  在新服务器上，返回“共享配置”部分并选中“启用共享配置”。在这些文件的物理路径中输入位置并应用它们。

6.  它应该提示输入加密密码（如果您设置了它）并重置 IIS。

砰！去喝啤酒！

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2009-02-01T02:04:41.530

MSDeploy 可以迁移 IIS 团队推荐的所有内容、配置等。 [http://www.iis.net/extensions/WebDeploymentTool](http://www.iis.net/extensions/WebDeploymentTool)

要创建包，请运行以下命令（将 Default Web Site 替换为您的网站名称）：

```
msdeploy.exe -verb:sync -source:apphostconfig="Default Web Site" -dest:package=c:\dws.zip > DWSpackage7.log 
```

要恢复包，请运行以下命令：

```
msdeploy.exe -verb:sync -source:package=c:\dws.zip -dest:apphostconfig="Default Web Site" > DWSpackage7.log 
```

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2011-08-29T16:56:21.437

这是一个关于使用 appcmd 导出/导入站点配置的有用网站。 [http://www.microsoftpro.nl/2011/01/27/exporting-and-importing-sites-and-app-pools-from-iis-7-and-7-5/](http://www.microsoftpro.nl/2011/01/27/exporting-and-importing-sites-and-app-pools-from-iis-7-and-7-5/)

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2013-08-08T11:19:42.523

**Microsoft Web Deploy v3**可以导出和导入所有文件、配置设置等。它将所有文件放入一个 zip 存档中，以便在新服务器上导入。它甚至可以升级到更新版本的 IIS (v7-v8)。

**[http://www.iis.net/extensions/WebDeploymentTool](http://www.iis.net/extensions/WebDeploymentTool)**

**安装工具后：** 在 IIS 管理控制台中右键单击您的服务器或网站，选择“部署”、“导出应用程序...”并运行导出。

在新服务器上，以相同方式导入导出的 zip 存档。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2011-03-13T02:58:18.050

使用 appcmd 导出一个或所有站点，然后重新导入新服务器。它可能是 iis7.0 或 7.5 当您使用 appcmd 导出时，密码被解密，然后重新导入，它们将重新加密。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2016-09-15T19:39:24.613

由于缺乏代表，我无法评论线程。另一位评论者表示，他们无法从较低版本的 IIS 迁移到较高版本的 IIS。如果您不合并某些文件，这是正确的，但如果您这样做，您可以，因为我刚刚使用chews 发布的答案将我的 IIS 7.5 站点迁移到 IIS 8.0。

创建导出 (II7.5) 时，有两个关键文件（administration.config 和 applicationHost.config）引用了 IIS7.5 服务器上的资源。例如，将使用特定于 7.5 的公钥和版本来引用 DLL。这些在 IIS8 服务器上是不一样的。功能配置也可能不同（我确保我的配置相同）。8 中有一些新功能在 7.5 中永远不会存在。

如果您有足够的勇气合并这两个文件 - 它会起作用。我不得不卸载 IIS 一次，因为我搞砸了，但第二次得到了它。

我使用了一个合并工具（Beyond Compare），如果没有类似的东西，它将是一个巨大的 PITA - 但是使用一个好的 diff 工具（五分钟）非常容易。

要进行合并，在尝试导入之前，需要将 8.0 文件与导出的 7.5 文件进行比较。在大多数情况下，8.0 文件需要覆盖导出的 7.5 文件中的服务器特定内容，同时保留站点/应用程序池特定的内容。

我发现 Administration.config 几乎相同，没有许多条目的版本信息。这很容易。

applicationHost.config 有很多不同之处。有些条目的排序不同，但其他方面相同，因此您必须挑选每个差异并找出答案。

在合并之前，我将 7.5 导出文件放在 System32\inetsrv\config\Export 文件夹中。

对于上面提到的两个文件，我将 FROM 文件夹 System32\inetsrv\config 合并到文件夹 System32\inetsrv\config\Export 中。我推送了 FROM 文件中的所有内容，除了站点特定的标签/元素（例如 applicationPools、customMetadata、站点、身份验证）。特别要注意的是，我还必须保留许多特定于站点的“位置”标签块，但新服务器有自己的“位置”标签块，必须保留服务器特定的默认值。

最后，请注意，如果您使用服务帐户，这些缓存的密码是垃圾密码，必须为您的应用程序池重新输入。我的网站最初都没有工作，但只需要重新输入我所有应用程序池的密码，我就可以启动并运行了。

如果可以评论的人在帖子中提到这篇文章 - 它可能会帮助像我这样在一台服务器上拥有许多站点且配置复杂的其他人。

问候，

斯图尔特

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2018-04-19T16:01:13.350

在我的情况下，文件已经被复制，我找到了按照本指南中的步骤进行操作的最简单方法：[https ://www.ryadel.com/en/exporting-importing-app-pools-and-websites-configuration-between -multiple-iis-instances/](https://www.ryadel.com/en/exporting-importing-app-pools-and-websites-configuration-between-multiple-iis-instances/)

我导出了 AppPools/网站，将 xml 文件复制到目标服务器，然后导入了 AppPools 和网站。工作得很好。这也是这个问题的另一个很好的选择。

# ssis - 在 SSIS 中的文件系统任务之后分支而不使包失败

> ID：493238
> 
> 赞同：2
> 
> 时间：2009-01-29T20:23:17.663
> 
> 标签：ssis, error-handling

如果文件系统任务（如重命名）失败，例如文件不存在，则 SSIS 将其视为错误。这意味着整个包都失败了。我可以通过使用脚本任务或将包的最大错误设置为一个以上来解决它。将包的最大错误设置为一个以上的问题是，如果包中的其他地方发生错误，则包不会在应该失败的时候失败。

那么有没有办法以某种方式吞下错误并且仍然能够根据文件系统任务的成功或失败进行分支？我尝试将文件任务粘贴到 ForceExecutionResult 设置为 Success 的序列容器中，但包仍然失败，说达到了最大错误计数。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2011-07-16T08:22:28.857

这是一种可能的选择。`Precedence Constraint`您可以通过将文件系统任务之后的更改为 来实现问题中提到的要求`Completion`。以下示例显示了如何做到这一点。该示例是使用创建的，`SSIS 2008 R2`但也适用于以前的版本。

**分步过程：**

1.  创建一个 SSIS 包并创建两个变量，如屏幕截图 # **1**所示。为变量分配一些不存在的文件路径值。

2.  在包的控制流选项卡上，放置文件系统任务、脚本任务和数据流任务，如屏幕截图 # **2**所示。脚本任务和数据流任务在这里是虚拟的，并且这些任务未配置为执行任何操作。

3.  配置文件系统任务，如屏幕截图 # **3**所示。

4.  屏幕截图# **4**显示了包的执行，正如预期的那样，文件系统任务失败，因为文件路径不存在。此外，由于错误，包在文件系统任务之后停止执行任务。

5.  右键单击和之间的优先约束箭头`File System Task`，`Script Task`然后选择**完成**，如屏幕截图 # **5**所示。箭头应从**绿色**变为**蓝色**。

6.  屏幕截图 # **6**显示了优先约束更改后的包执行。文件系统任务仍然失败，但其他任务继续执行。`Earlier`，条件是仅当文件系统任务**成功**时才执行脚本任务。`Now`，条件是在文件系统任务完成执行后执行脚本任务（无论成功或失败）。

7.  如果您想让包根据成功/失败采取完全两种不同的路径。您可以按照屏幕截图 # **7**和 # **8**中所示的方式进行操作。红色箭头表示文件系统任务**失败**时将采用路径，绿色箭头表示文件系统任务**成功**执行时将采用路径。`C:\temp\Source.txt`我在执行包之前的路径中创建了一个文件，如屏幕截图 # **7**所示。执行包后，文件被重命名，路径不再存在。因此，包失败，如屏幕截图 # **8**所示。

希望有帮助。

**截图#1：**

![1](https://i.stack.imgur.com/A8N8Y.png)

**截图#2：**

![2](https://i.stack.imgur.com/0XJRd.png)

**截图#3：**

![3](https://i.stack.imgur.com/bIlVV.png)

**截图#4：**

![4](https://i.stack.imgur.com/Nd348.png)

**截图#5：**

![5](https://i.stack.imgur.com/ISPqh.png)

**截图#6：**

![6](https://i.stack.imgur.com/1MBls.png)

**截图#7：**

![7](https://i.stack.imgur.com/XgzGp.png)

**截图#8：**

![8](https://i.stack.imgur.com/XLR7m.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-03T07:32:52.163

检查 FileSystem 任务的 FailPackageOnFailure 和 FailParentOnFailure 属性并确保它们设置为 False。此外，增加包的 MaximumErrorCount 属性。

这种组合将允许任务失败并且包仍然成功完成。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-06T05:45:54.367

使文件系统任务的属性“强制执行结果”成功..

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-29T20:40:30.187

我遇到了这个确切的问题，我一直使用脚本任务。我认为没有更好的解决方案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-30T10:59:14.043

我没有用 FS 任务尝试过这个，但它适用于数据流......如何将文件系统任务包装在序列容器中......如果步骤失败，容器失败，您可以简单地从容器输出到成功/失败路径....

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-06T09:22:13.217

您可以对连接使用约束。右键单击 SSIS 组件之间的连接箭头，您可以指定，

成功/失败和重定向。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-05T09:21:32.847

prashant_sp 答案是正确的，您只需要无条件地继续下一个任务，*不*选择“成功”工作流优先约束，而是选择“重定向”，即使您的 FS 任务失败（文件夹确实不存在等...）

亲切的问候

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-10-14T10:17:53.177

在“优先约束”连接器上使用表达式和约束组合。总是从你之前的任务返回成功（它可能是一个寻找文件的脚本），如果找到文件，设置一个变量。在“优先约束”的表达式中检查变量值并返回真或假。如果您的表达式计算结果为 false，则程序包将继续执行，但您不会看到任何错误。- 马尤赫

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-05-17T01:59:46.997

我知道这是一个老问题，但它可能有助于寻找答案的人。

结合 user756519 的相当好的答案，停止传播错误可以防止包失败。这意味着您可以有效地将故障用作分支，而不必担心它会破坏您的包。

有关更多信息，请参阅 cfrag[对此问题的回答。](https://stackoverflow.com/a/8363727/781965)该答案指向[此博客条目](http://simonworth.wordpress.com/2009/11/11/ssis-event-handler-variables-propagate/)，该条目解释了如何为 OnError 事件处理程序设置传播变量（制作事件处理程序、打开变量视图、显示系统变量、将 Propogate 设置为 false）。

# algorithm - 确定掷骰子中出现的数字的频率

> ID：493239
> 
> 赞同：6
> 
> 时间：2009-01-29T20:23:23.530
> 
> 标签：algorithm, probability, dice

对于一个游戏，我试图确定某个 # 将出现在给定的骰子 # 中出现的频率。我知道……这个问题似乎很奇怪。让我试着用实数来解释它。

因此，对于 1 个骰子，每个数字的频率将相同。1-6 将出现相同的次数。

现在对于 2 个骰子，情况会有所不同。我想 5,6,7 将是最常滚动的，而频谱两端的数字将显示较少或根本不显示（在 1 的情况下）。我想知道如何计算这个列表并以正确的顺序显示它们，从最频繁到不太频繁。

有什么想法吗？

* * *

@duffymo - 虽然有某种算法来提出它会非常好。似乎上述方式将需要大量的手工挑选和放置数字。如果我的骰子数是动态的，最多可以说 10，那么我认为手工操作将是低效且麻烦的。:)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-29T20:28:05.597

两个骰子有 6*6 = 36 种组合。

2 = 1+1 只能出现一次，所以它的出现频率是 1/36。3 = 1+2 或 2+1，所以它的频率是 2/36 = 1/18。4 = 1+3、2+2 或 3+1，所以它的频率是 3/36 = 1/12。

您可以在十二点之前完成其余的工作。

任何步步高玩家都知道这些。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-29T20:42:51.900

不需要真正的“算法”或模拟 - 它是基于 De Moivre 推导出的公式的简单计算：

[http://www.mathpages.com/home/kmath093.htm](http://www.mathpages.com/home/kmath093.htm)

而且它不是“钟形曲线”或正态分布。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-29T20:33:37.050

递归方式的草稿：

```
public static IEnumerable<KeyValuePair<int, int>> GetFrequenciesByOutcome(int nDice, int nSides)
{
    int maxOutcome = (nDice * nSides);
    Dictionary<int, int> outcomeCounts = new Dictionary<int, int>();
    for(int i = 0; i <= maxOutcome; i++)
        outcomeCounts[i] = 0;

    foreach(int possibleOutcome in GetAllOutcomes(0, nDice, nSides))
        outcomeCounts[possibleOutcome] = outcomeCounts[possibleOutcome] + 1;

    return outcomeCounts.Where(kvp => kvp.Value > 0);
}

private static IEnumerable<int> GetAllOutcomes(int currentTotal, int nDice, int nSides)
{
    if (nDice == 0) yield return currentTotal;
    else
    {
        for (int i = 1; i <= nSides; i++)
            foreach(int outcome in GetAllOutcomes(currentTotal + i, nDice - 1, nSides))
                yield return outcome;
    }
} 
```

除非我弄错了，否则这应该会吐出像 [key, frequency] 这样组织的 KeyValuePairs。

**编辑**：仅供参考，运行后，它显示 GetFrequenciesByOutcome(2, 6) 的频率为：

2：1

3：2

4：3

5：4

6：5

7：6

8：5

9：4

10：3

11：2

12：1

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-03-28T14:44:56.520

将先前滚动的频率数组相加，通过移动其位置将“边号”乘以，然后您将获得每个数字出现的频率数组。

```
1, 1, 1, 1, 1, 1  # 6 sides, 1 roll

1, 1, 1, 1, 1, 1
   1, 1, 1, 1, 1, 1
      1, 1, 1, 1, 1, 1
         1, 1, 1, 1, 1, 1
            1, 1, 1, 1, 1, 1
+              1, 1, 1, 1, 1, 1
_______________________________
1, 2, 3, 4, 5, 6, 5, 4, 3, 2, 1  # 6 sides, 2 rolls

1, 2, 3, 4, 5, 6, 5, 4, 3, 2, 1
   1, 2, 3, 4, 5, 6, 5, 4, 3, 2, 1
      1, 2, 3, 4, 5, 6, 5, 4, 3, 2, 1
         1, 2, 3, 4, 5, 6, 5, 4, 3, 2, 1
            1, 2, 3, 4, 5, 6, 5, 4, 3, 2, 1
+              1, 2, 3, 4, 5, 6, 5, 4, 3, 2, 1
______________________________________________
1, 3, 6,10,15,21,25,27,27,25,21,15,10, 6, 3, 1  # 6 sides, 3 rolls 
```

这比蛮力模拟要快得多，因为简单的方程是最好的。这是我的python3实现。

```
def dice_frequency(sides:int, rolls:int) -> list:
    if rolls == 1:
        return [1]*sides
    prev = dice_frequency(sides, rolls-1)
    return [sum(prev[i-j] for j in range(sides) if 0 <= i-j < len(prev))
            for i in range(rolls*(sides-1)+1)] 
```

例如，

```
dice_frequency(6,1) == [1, 1, 1, 1, 1, 1]
dice_frequency(6,2) == [1, 2, 3, 4, 5, 6, 5, 4, 3, 2, 1]
dice_frequency(6,3) == [1, 3, 6, 10, 15, 21, 25, 27, 27, 25, 21, 15, 10, 6, 3, 1] 
```

请注意，您应该使用“目标数字 - 滚动计数”作为列表的索引来获取每个数字的频率。如果你想得到概率，使用'side number'^'roll count'作为分母。

```
sides = 6
rolls = 3
freq = dice_frequency(sides,rolls)
freq_sum = sides**rolls
for target in range(rolls,rolls*sides+1):
    index = target-rolls
    if 0 <= index < len(freq):
        print("%2d : %2d, %f" % (target, freq[index], freq[index]/freq_sum))
    else:
        print("%2d : %2d, %f" % (target, 0, 0.0)) 
```

此代码产生

```
 3 :  1, 0.004630
 4 :  3, 0.013889
 5 :  6, 0.027778
 6 : 10, 0.046296
 7 : 15, 0.069444
 8 : 21, 0.097222
 9 : 25, 0.115741
10 : 27, 0.125000
11 : 27, 0.125000
12 : 25, 0.115741
13 : 21, 0.097222
14 : 15, 0.069444
15 : 10, 0.046296
16 :  6, 0.027778
17 :  3, 0.013889
18 :  1, 0.004630 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-29T20:28:57.090

网上有很多关于骰子概率的东西。这是一个帮助我解决 Project Euler 问题的链接：

[http://gwydir.demon.co.uk/jo/probability/calcdice.htm](http://gwydir.demon.co.uk/jo/probability/calcdice.htm)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-29T21:10:25.277

使用动态函数创建的 JavaScript 实现：

```
<script>
var f;
function prob(dice, value)
 {
var f_s = 'f = function(dice, value) {var occur = 0; var a = [];';
for (x = 0; x < dice; x++)
 {
f_s += 'for (a[' + x + '] = 1; a[' + x + '] <= 6; a[' + x + ']++) {';
 }
f_s += 'if (eval(a.join(\'+\')) == value) {occur++;}';
for (x = 0; x < dice; x++)
 {
f_s += '}';
 }
f_s += 'return occur;}';
eval(f_s);
var occ = f(dice, value);
return [occ, occ + '/' + Math.pow(6, dice), occ / Math.pow(6, dice)];
 };

alert(prob(2, 12)); // 2 die, seeking 12
                    // returns array [1, 1/36, 0.027777777777777776]
</script> 
```

**编辑：**很失望没有人指出这一点；必须替换`6 * dice`为`Math.pow(6, dice)`. 不要再犯这样的错误了……

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-29T21:32:10.567

整洁的事实...

你知道帕斯卡三角形是 N 个 2 面骰子之和的概率分布吗？

```
 1 1    - 1 die, 1 chance at 1, 1 chance at 2
  1 2 1   - 2 dice, 1 chance at 2, 2 chances at 3, 1 chance at 4
 1 3 3 1  - 3 dice, 1 chance at 3, 3 chances at 4, 3 chances at 5, 1 chance at 6 
1 4 6 4 1 - etc. 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-29T20:51:51.443

似乎有一些关于“为什么”的谜团，虽然 duffymo 已经解释了其中的一部分，但我正在看另一篇文章，上面写着：

> 应该没有理由为什么 5、6 和 7 应该掷出更多 [超过 2]，因为第一次掷骰子是独立于第二次掷骰子的事件，并且它们都有 1-6 的相同概率滚动。

这有一定的吸引力。但这是不正确的......因为第一次滚动会影响机会。推理可能最容易通过一个例子来完成。

假设我试图弄清楚掷出 2 或 7 的概率是否更有可能在两个骰子上。如果我掷出第一个骰子并得到 3，那么我现在总共掷出 7 的机会有多大？显然，六分之一。我总共滚动 2 的机会是多少？0 比 6...因为我无法在第二个骰子上滚动以使我的总数为 2。

出于这个原因，7 很有可能被掷出……因为无论我在第一个骰子上掷出什么，我仍然可以通过在第二个骰子上掷出正确的数字来达到正确的总数。6 和 8 的可能性同样略小，5 和 9 的可能性更大，依此类推，直到我们达到 2 和 12，同样不可能，各有 36 分之一的机会。

如果你绘制这个（总和与可能性），你会得到一个很好的钟形曲线（或者更准确地说，由于你的实验的离散性，一个块状的近似）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-06-27T15:40:27.227

在互联网和stackoverflow上进行了大量搜索后，我发现[Math博士](http://mathforum.org/library/drmath/view/52207.html)在一个工作函数中很好地解释了它（另一个答案中的链接有一个不正确的公式）。我将 Dr. Math 的公式转换为 C#，并且我的 nUnit 测试（之前因其他代码尝试而失败）全部通过。

首先，我必须编写一些辅助函数：

```
 public static int Factorial(this int x)
  {
     if (x < 0)
     {
        throw new ArgumentOutOfRangeException("Factorial is undefined on negative numbers");
     }
     return x <= 1 ? 1 : x * (x-1).Factorial();
  } 
```

由于选择在数学中的工作方式，我意识到如果我有一个具有下限的重载阶乘函数，我可以减少计算。当达到下限时，此函数可以退出。

```
 public static int Factorial(this int x, int lower)
  {
     if (x < 0)
     {
        throw new ArgumentOutOfRangeException("Factorial is undefined on negative numbers");
     }
     if ((x <= 1) || (x <= lower))
     {
        return 1;
     }
     else
     {
        return x * (x - 1).Factorial(lower);
     }
  }

  public static int Choose(this int n, int r)
  {
     return (int)((double)(n.Factorial(Math.Max(n - r, r))) / ((Math.Min(n - r, r)).Factorial()));
  } 
```

有了这些，我就可以写了

```
 public static int WaysToGivenSum(int total, int numDice, int sides)
  {
     int ways = 0;
     int upper = (total - numDice) / sides; //we stop on the largest integer less than or equal to this
     for (int r = 0; r <= upper; r++)
     {
        int posNeg = Convert.ToInt32(Math.Pow(-1.0, r)); //even times through the loop are added while odd times through are subtracted
        int top = total - (r * sides) - 1;
        ways += (posNeg * numDice.Choose(r) * top.Choose(numDice - 1));
     }
     return ways;
  } 
```

# gcc - 这些 Makefile 结构是什么意思？

> ID：493244
> 
> 赞同：4
> 
> 时间：2009-01-29T20:24:38.037
> 
> 标签：gcc, makefile

有人可以帮我找出以下make文件吗？

```
BINS=file1 file2 file3

all: $(BINS)

clean: 
        rm -f $(BINS) *~ 

$*: $@.c
        gcc -g -o $@ $? 
```

以下是我的问题：

1.  gcc的-g选项是什么？
2.  什么是 $* 和 $@
3.  它怎么知道执行最后一个目标？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-29T20:36:07.420

从`gcc`和`make`文档：

1.  “-g 以操作系统的本机格式生成调试信息”。

2.  一种。"$* 与隐式规则匹配的词干（请参阅模式匹配方式）。如果目标是 dir/a.foo.b 并且目标模式是 a.%.b，那么词干就是 dir/foo。词干是用于构造相关文件的名称。在静态模式规则中，词干是与目标模式中的 '%' 匹配的文件名的一部分。

    湾。"$@ 规则目标的文件名。如果目标是归档成员，则 '$@' 是归档文件的名称。在具有多个目标的模式规则中（请参阅模式规则简介）， '$@' 是导致规则命令运行的目标的名称。”

    C。“$？所有比目标新的先决条件的名称，它们之间有空格。” （没有问，但值得添加。）

3.  "'all' 编译整个程序。这应该是默认目标。"

这个示例 makefile 有点受限，因为它似乎只构建 C 程序。[GNU make](http://www.gnu.org/software/make/manual/make.html)有几个更广泛的示例，可用于学习如何编写 makefile。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-29T20:39:02.780

> 1.) gcc 的 -g 选项是什么？

生成调试信息

> 2.) 什么是 $* 和 $@

`$*`是规则的主干。当你制定规则时

```
%.ext: %.otherext
    ext2otherext --input $? --output $@ --logfile $*.log 
```

, 并且规则尝试`file.ext`从`file.otherext`, 然后到 log 去`file.log`

`$@`是目标文件名（`file.ext`在上面的例子中）。

> 3.) 它如何知道执行最后一个目标？

这是一个谜。

`$*`用于中间文件：例如，当您尝试制作`%.so`out of 时`%.c`，您需要一个`%.o`既不是目标也不是源的中间人。你把：

```
%.so: %.c
    gcc -fPIC -g -c -o $*.o $?
    ld -shared -o $@ $*.o 
```

换句话说，在`%.extension`规则中，`$*`除了`.extension`.

作为一个目标，`$*`没有任何意义。

你确定这条规则实际上是在某处执行的吗？当我尝试使用您的 Makefile 复制它时，它会应用默认规则 ( `cc -o`) 而不是`gcc -g -o`

您需要的规则似乎是：

```
%: %.c
    gcc -g -o $@ $? 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-29T20:28:40.837

[GNU Make 手册](http://www.gnu.org/software/make/manual/make.html)

[GCC 在线文档](http://gcc.gnu.org/onlinedocs/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-29T20:41:20.513

第一行正如你所期望的那样——它创建了一个名称列表并将其分配给`BIN`. 接下来，定义了一个名为 make 的目标`all`，它依赖于列出的目标`$BIN`（`all`只有在构建每个目标之后才能`$BIN`构建）。 `all`是一个特殊的构建目标；如果你只是运行`make`而不是，例如，`make clean`目标`all`是自动构建的。没有相关的实际命令`all`——它只是确保构建其所有依赖项。最后一个相当简单的命令定义了一个名为 的构建目标`clean`，它删除列出的每个文件`$BIN`（注意，`$BIN`它同时用作构建目标列表和此 makefile 中的文件列表）和所有备份。

接下来，我们到达一条基本上是魔法的线。 `$*`是一个特殊的构建目标，意思是“任何没有明确定义的东西”。当`make`尝试构建`all`时，它会找到目标并开始处理其依赖项。但是当它尝试构建时`file1`，没有明确定义目标。相反，它用于`$*`构建`file1`. 同样，`$@`被构建目标的名称和`$?`它的依赖项替换（有点；你最好检查手册）。然后，当`make`转到 build`file1`时，该`$*`规则使其表现得好像定义了以下规则：

```
file1: file1.c
        gcc -g -o file1 file1.c 
```

最后，该`-g`选项仅允许编译调试信息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-29T20:40:50.297

Q1 和 Q2 已经得到了广泛的回答，因此仅对 Q3 进行简要说明：

除非您指定了不同的目标，否则 Make 始终执行第一个目标。这也称为默认目标。通常默认目标称为“全部”。

# asp.net - jQuery 不能在我的主机上运行？

> ID：493245
> 
> 赞同：3
> 
> 时间：2009-01-29T20:24:45.913
> 
> 标签：asp.net, javascript, jquery, hosting

我在一个站点上工作，一切都在我的本地环境以及我在这里的测试服务器上运行，一切正常。 *但是*当我将它上传到我的主机时，似乎没有任何效果！？

Asp.Net javascript 验证器触发，但任何和所有 jquery 都不起作用？我什至放了一个简单的

```
$("#test").html("working"); 
```

和

```
<div id="test></div> 
```

什么都没有发生？我已经三重检查了所有 js 是否已上传（到我的 /js/ 目录

该网站在这里：[http](http://whoowes.me) ://whoowes.me （它还处于起步阶段......刚刚开始）和登录/注册/联系按钮都应该拉出一个模式弹出窗口（不改变页面，这应该只发生在 JS已禁用）并且“测试”一词应显示在菜单下。

可以从服务器禁用 JS 吗？尽管出现了 asp.net javascript 验证器，但这没有意义吗？

我在这里完全感到困惑，任何想法都会很棒！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-29T20:48:28.470

您可以随时让 Google 为您完成工作：

```
<head>
  <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.1/jquery.min.js"></script>
</head> 
```

一个令人愉快的副作用是您将节省一点带宽，而且由于许多网站现在使用 Google 的 AJAX API，许多用户已经将其缓存在他们的浏览器中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-29T20:26:45.833

```
<script src="/jquery.js" type="text/javascript"></script> 
```

[http://whoowes.me/jquery.js](http://whoowes.me/jquery.js) = 404

也许您没有将文件上传到正确的位置？

（你没有指向`/js/`文件夹）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-02-26T23:41:52.213

确保你有

```
$(document).ready(function () {
    ...
}); 
```

围绕您现有的代码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-29T20:49:12.760

在 IIS 上配置站点的方式是通过他们的虚拟目录设置，可能不包括你的 js 文件夹。服务器也可能不允许站点根据文件权限传递 js。

我会说您将一张票放入您的虚拟主机提供商，并让他们查看服务器未交付文件的原因。另一个选项是 IIS 服务器未设置为允许传递 js 文件扩展名。

希望这可以帮助

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-29T21:20:31.933

我的主机没有默认在其 MIME 类型中包含 .js，因此我必须将其添加到：

```
extension: .js

application/x-javascript 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-29T20:28:26.250

找不到文件 whoowes.me/jquery.js。确保在脚本标签中使用正确的文件路径。

# java - 如何创建可滚动的 JPopupMenu

> ID：493247
> 
> 赞同：3
> 
> 时间：2009-01-29T20:24:57.537
> 
> 标签：java, swing

我正在尝试创建一个具有滚动条的 JPopupMenu，以便我可以显示大量项目。

网络上有几个实现都有问题：

1.  [http://forums.sun.com/thread.jspa?threadID=5128630](http://forums.sun.com/thread.jspa?threadID=5128630)

    看起来是正确的（除了分隔符的问题），但如果你滚动它，突出显示和选择不再起作用。

2.  [http://www.beginner-java-tutorial.com/scrollable-jpopupmenu.html](http://www.beginner-java-tutorial.com/scrollable-jpopupmenu.html)

    看起来不像 JPopupMenu（没有 L&F 背景或突出显示），但除了不能将 JMenuItems 放入其中之外，它可以工作 - 相反，您必须使用一些被黑的按钮。

在我尝试调试其中任何一个或编写自己的解决方案之前，谁能给我指出一个可行的解决方案？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-30T00:15:58.677

我的建议是不要使用弹出菜单，如果它那么大。

大多数当前的操作系统用户指南也会建议这一点。如果用户需要滚动，那么大的菜单将成为用户在其中查找内容的噩梦，不是吗？

一个带有可过滤列表的弹出窗口/对话框怎么样？

（例如，eclipse 中的 CTRL+O 弹出可过滤树，或者 eclipse 中的 CTRL+Space Content Assist 列表）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-30T06:54:51.320

我同意约翰·加德纳的观点，你应该使用对话。我们使用了 swingx 可过滤组件，它们非常适合过滤...

# oop - 使用面向对象的分析和设计对电梯进行建模

> ID：493276
> 
> 赞同：139
> 
> 时间：2009-01-29T20:30:38.680
> 
> 标签：oop, design-patterns, language-agnostic

当涉及到面向对象的设计和分析时，有一组似乎在面试和课堂上常用的问题。这是其中之一；不幸的是，我在大学的 OOP 教授从未真正给出过答案，所以我一直在想。

问题如下：设计一组用于模拟电梯组的基本对象/方法。对象及其属性/方法是什么？

为了便于讨论，我们假设我们的大楼有二十层；底层是大堂，二层与停车场相连（因此，人们将在底层或二层进出建筑物）。有一个电梯组服务所有楼层；电梯组有3个电梯井，每个电梯井有1台电梯。

在面向对象模型中对此进行建模的正确方法是什么？

* * *

## 回答 #1

> 赞同：176
> 
> 时间：2009-01-29T20:48:34.510

首先是电梯课。它有一个方向（向上、向下、站立、维护）、当前楼层和按该方向排序的楼层请求列表。它接收来自该电梯的请求。

然后是银行。它包含电梯并接收来自楼层的请求。这些计划用于所有活动的电梯（不在维护中）。

调度将如下所示：

*   如果可以的话，选择这个楼层的站立电梯。
*   否则选择移动到该楼层的电梯。
*   否则选择另一层的站立式电梯。
*   否则选择负载最低的电梯。

每个电梯都有一组状态。

*   维护：电梯不对外部信号作出反应（仅对自身信号作出反应）。
*   支架：电梯固定在楼层上。如果它接到电话。电梯就在那个楼层，门打开了。如果它在另一个楼层，它会朝那个方向移动。
*   向上：电梯向上移动。每次到达楼层时，它都会检查是否需要停止。如果是这样，它会停下来打开门。它等待一定的时间并关上门（除非有人正在通过它们。然后它从请求列表中删除楼层并检查是否有另一个请求。如果有，电梯再次开始移动。如果没有，它进入国家立场。
*   向下：像向上但方向相反。

还有其他信号：

*   警报。电梯停了下来。如果它在楼层，门打开，请求列表被清除，请求被移回银行。
*   门打开了。如果电梯在楼层上并且没有移动，则打开门。
*   门关闭。如果他们开着，就关上门。

编辑：有些电梯不是从底部/第一层特别是开始。如果是摩天大楼。

min_floor 和 max_floor 是 Elevator 的两个附加属性。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2011-07-28T11:11:19.120

Donald Knuth 的 The Art of Computer Programming Vol.1 演示了电梯和数据结构。Knuth 提出了一个非常彻底的讨论和计划。

Knuth（1997）“信息结构”，*计算机编程艺术*卷。1 [pp.302-308](http://books.google.com/books?id=MooMkK6ERuYC&lpg=PA304&dq=knuth%20elevator&pg=PA302#v=onepage&q&f=false)

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2009-01-29T20:39:24.760

我已经看到了这个问题的许多变体。主要区别之一（决定了难度）是是否有一些集中的尝试来建立一个具有负载平衡的“智能高效系统”（例如，在早上发送更多空闲电梯到大厅）。如果是这样的话，设计将包括一个设计非常有趣的整个子系统。

一个完整的设计显然太多了，无法在这里展示，还有很多选择。广度也不清楚。在一次采访中，他们会试图弄清楚你的想法。但是，这些是您需要的一些东西：

1.  中央控制器的表示（假设有一个）。

2.  电梯的表示

3.  电梯接口单元的表示（这些可能因电梯而异）。显然每个楼层的呼叫按钮等等。

4.  每个楼层的箭头或指示器的表示（几乎是电梯模型的“视图”）。

5.  人和货物的表示（对于考虑最大负载可能很重要）

6.  建筑物的表示（在某些情况下，某些楼层有时可能会被阻挡等）

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2012-12-05T17:04:15.200

看：

```
Lu Luo, A UML Documentation for a Elevator System
Distributed Embedded Systems, Fall 2000
Ph.D. Project Report
Carneghie Mellon University 
```

[关联](http://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=5&cad=rja&ved=0CHYQFjAE&url=http://www.cs.cmu.edu/~luluo/Courses/18540PhDreport.pdf&ei=zXu_UPbNKuveigKl1oDwCw&usg=AFQjCNGC5qPKgAg6ILn1KNOu782rpjEK3g&sig2=j4VTUJCoyWHY6T_lkzV0-w)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-09-17T10:30:08.967

详细答案：

[http://www.angelfire.com/trek/software/elevator.html](http://www.angelfire.com/trek/software/elevator.html)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-07-21T06:30:22.547

[设计](http://www.youtube.com/watch?v=fITuhLSwbt8)电梯系统时要考虑的事情，

```
Elevator
Floor/Location Identifier
Number of steps
Rotation speed
Daterange
InstallationDate
MaintainenceDate
Department Identifier
AllowedWeight
Detail / Description
Poison Ratio (Statistics)
Start
Stop
SetDirection
SetRotationSpeed
EmergencyStop = Stop + Alert
EmergencyAccidentSenser Handler 
```

每次按下按钮都会产生一个必须服务的电梯请求。这些请求中的每一个都在全球范围内进行跟踪

大楼内电梯的数量将由用户决定。该建筑将包含固定数量的楼层。电梯可容纳的乘客数量将是固定的。当乘客在目的地楼层离开电梯时，他们将被计算在内。目标楼层将使用“随机”泊松区间确定。当电梯内的所有乘客都到达目的地楼层后，电梯将返回大厅接载更多乘客

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2014-02-11T18:13:08.100

主要要担心的是如何通知电梯它需要向上或向下移动。以及如果您将有一个集中的类来控制这种行为以及如何分配控制。

看起来它可以非常简单或非常复杂。如果我们不考虑电梯到达一个地方的并发性或时间，那么看起来会很简单，因为我们只需要检查电梯的状态，比如它是向上移动还是向下移动，还是静止不动。但是如果我们让 Elevator 实现 Runnable，并且不断地检查和同步一个队列（linkedList）。控制器类将分配队列中的哪个楼层。当队列为空时，run()方法会等待(queue.wait())，当分配到该电梯的楼层时，会调用queue.notify()唤醒run()方法，然后run( ) 方法将调用 goToFloor(queue.pop())。这会使问题变得过于复杂。我试着把它写在纸上，但不认为它有效。似乎我们真的不需要在这里考虑并发性或时间问题，

有什么建议吗？

# cocoa - 如何从 CoreData-Entities 获取一些值到代码中

> ID：493285
> 
> 赞同：0
> 
> 时间：2009-01-29T20:33:13.463
> 
> 标签：cocoa, core-data, key-value-observing, nsarraycontroller

我在我的 CoreData 应用程序中创建了一个具有一些属性的实体。想象一个 tableview 和一个绑定的 NSArrayController。我创建（和编辑）我的实体“实例”。我的问题是如何将这些属性的值添加到我的代码中。如果还有更多问题：http: [//twitter.com/xP_ablo](http://twitter.com/xP_ablo)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-30T21:02:32.983

您需要以某种方式获取对 NSArrayController 的引用。如果您自己加载 NIB，则可以将 IBOutlet 实例添加到设置为 NIB“文件所有者”的类中。当你加载一个 nib 时，你提供了 NIB 的“文件所有者”类的实例作为所有者。如果您没有自己加载NIB（即它由Cocoa 自动加载为您的应用程序的MaineMenu nib/xib），则在nib 中创建您自己的类的实例并将IBOutlet 添加到该实例。你在你的类中创建一个 IBOutlet，如下所示：

```
@interface MyClass : NSObject { //of course your class doesn't have to be a direct descendent of NSObject
    IBOutlet NSArrayController *arrayController;
}

@property (retain,nonatomic,readwrite) IBOutlet NSArrayController *arrayController;

...

@end

@implementation
@synthesize arrayController;

- (void)dealloc {
    [arrayController release];
    [super dealloc];
}
@end 
```

将您的类中的 IBOutlet 连接到 NSArrayController（在第一种情况下控制单击文件所有者或在上述第二种情况下单击您的类的实例）并拖动到 NSArrayController。当您释放鼠标时，您将在拖动源中弹出 IBOutlets。选择您创建的 IBOutlet（例如上例中的“arrayController”）。

一个笔尖被加载（即`awakeFromNib`在你的类中调用之后），你可以通过插座访问 arrayController：

```
NSArray *content = [[self arrayController] arrangedObjects]; 
```

现在你可以用数组中的值做你想做的事了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-30T16:15:21.580

如果我有这个正确的，你有一个 TableView，绑定到一个绑定到你的数据的 NSArrayController。

简单的方法：在您的类（通常是文件的所有者）中创建一个 IBOutlet，并在 Interface Builder 中将此 IBOutlet 连接到 NSArrayController。然后，您可以从此数组中获取所需的值。

# html - CSS 显示调整大小和裁剪的图像

> ID：493296
> 
> 赞同：400
> 
> 时间：2009-01-29T20:35:19.777
> 
> 标签：html, css, background-image, image

我想显示来自具有特定宽度和高度的 URL 的图像，即使它具有不同的大小比例。所以我想调整大小（保持比例），然后将图像剪切到我想要的大小。

我可以使用 html`img`属性调整大小，也可以使用`background-image`.
我怎样才能做到这两点？

例子：

这个图片：

![在此处输入图像描述](https://i.stack.imgur.com/wPh0S.jpg)

有大小`800x600`像素，我想像`200x100`像素图像一样显示

我`img`可以调整图像大小`200x150px`：

```
<img 
    style="width: 200px; height: 150px;" 
    src="http://i.stack.imgur.com/wPh0S.jpg"> 
```

这给了我这个：

```
<img style="width: 200px; height: 150px;" src="https://i.stack.imgur.com/wPh0S.jpg">
```

并且`background-image`我可以剪切图像`200x100`像素。

```
<div 
    style="background-image:
           url('https://i.stack.imgur.com/wPh0S.jpg'); 
    width:200px; 
    height:100px; 
    background-position:center;">&nbsp;</div> 
```

给我：

```
 <div style="background-image:url('https://i.stack.imgur.com/wPh0S.jpg'); width:200px; height:100px; background-position:center;">&nbsp;</div>
```

我怎样才能做到这两点？
调整图像大小，然后将其剪切成我想要的大小？

* * *

## 回答 #1

> 赞同：533
> 
> 时间：2009-01-29T20:42:52.320

您可以结合使用这两种方法，例如。

```
 .crop {
        width: 200px;
        height: 150px;
        overflow: hidden;
    }

    .crop img {
        width: 400px;
        height: 300px;
        margin: -75px 0 0 -100px;
    }
```

```
 <div class="crop">
        <img src="https://i.stack.imgur.com/wPh0S.jpg" alt="Donald Duck">
    </div>
```

您可以使用负片`margin`在`<div/>`.

* * *

## 回答 #2

> 赞同：149
> 
> 时间：2012-02-05T12:17:45.970

使用 CSS3 可以改变 a 的大小`background-image`，[`background-size`](http://www.w3.org/TR/css3-background/#the-background-size)同时实现这两个目标。

[css3.info](http://www.css3.info)上有很多[例子](http://www.css3.info/preview/background-size/)。

[根据您的示例实施](http://jsfiddle.net/hbqcf/1/)，使用[donald_duck_4.jpg](http://img1.jurko.net/wall/paper/donald_duck_4.jpg)。在这种情况下，`background-size: cover;`这正是您想要的 - 它适合`background-image`覆盖容器的整个区域`<div>`并剪裁多余的区域（取决于比率）。

```
.with-bg-size {
  background-image: url('https://i.stack.imgur.com/wPh0S.jpg');
  width: 200px;
  height: 100px;
  background-position: center;
  /* Make the background image cover the area of the <div>, and clip the excess */
  background-size: cover;
}
```

```
<div class="with-bg-size">Donald Duck!</div>
```

[css3](/questions/tagged/css3 "显示标记为“css3”的问题") [背景图片](/questions/tagged/background-image "显示标记为“背景图像”的问题") [背景大小](/questions/tagged/background-size "显示标记为“背景大小”的问题")

* * *

## 回答 #3

> 赞同：125
> 
> 时间：2015-05-10T10:14:06.790

你试过用这个吗？

```
.centered-and-cropped { object-fit: cover } 
```

我需要调整图像大小、居中（垂直和水平）然后裁剪它。

我很高兴地发现，它可以在一条 css 行中完成。在此处查看示例：[http ://codepen.io/chrisnager/pen/azWWgr/?editors=110](http://codepen.io/chrisnager/pen/azWWgr/?editors=110)

* * *

这是该示例中的`CSS`and`HTML`代码：

```
.centered-and-cropped { object-fit: cover }
```

```
<h1>original</h1>
<img height="200" src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/3174/bear.jpg" alt="Bear">

<h1>object-fit: cover</h1>
<img class="centered-and-cropped" width="200" height="200" 
style="border-radius:50%" src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/3174/bear.jpg" alt="Bear">
```

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2009-01-29T20:44:51.863

```
.imgContainer {
  overflow: hidden;
  width: 200px;
  height: 100px;
}
.imgContainer img {
  width: 200px;
  height: 120px;
} 
```

```
<div class="imgContainer">
  <img src="imageSrc" />
</div> 
```

包含 div 基本上通过隐藏溢出来裁剪图像。

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2014-03-12T06:38:49.273

```
img {
  position: absolute;
  clip: rect(0px, 140px, 140px, 0px);
} 
```

```
<img src="w3css.gif" width="100" height="140" /> 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2013-11-16T12:40:08.253

谢谢sanchothefat。

我对你的回答有改进。由于裁剪是为每个图像量身定制的，因此此定义应位于 HTML 而不是 CSS。

```
<div style="overflow:hidden;">
   <img src="img.jpg" alt="" style="margin:-30% 0px -10% 0px;" />
</div> 
```

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2018-11-14T06:23:50.523

> **`object-fit`**如果您正在玩`<img>`标签，可能会对您有所帮助

下面的代码将为您裁剪图像。你可以玩弄[对象匹配](https://developer.mozilla.org/en-US/docs/Web/CSS/object-fit)

```
img {
  object-fit: cover;
  width: 300px;
  height: 337px;
} 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2015-05-12T04:51:40.120

```
img {
    position: absolute;
    clip: rect(0px,60px,200px,0px);
} 
```

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2021-04-26T10:23:11.077

对先前答案的一个小补充，包括`object-fit: cover`：

[对象位置](https://developer.mozilla.org/en-US/docs/Web/CSS/object-position)

> 您可以使用 object-position 属性更改被替换元素的内容对象在元素框内的对齐方式。

```
.trimmed-cover {
  object-fit: cover;
  width: 100%;
  height: 177px;
  object-position: center 40%;
}
```

```
<img class="trimmed-cover" src="http://i.stack.imgur.com/wPh0S.jpg">
```

[![结果.gif](https://i.stack.imgur.com/7uRBR.gif)](https://i.stack.imgur.com/7uRBR.gif)

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2016-04-17T03:21:10.623

现场示例： [https ://jsfiddle.net/de4Lt57z/](https://jsfiddle.net/de4Lt57z/)

HTML：

```
<div class="crop">
  <img src="example.jpg" alt="..." />
</div> 
```

CSS：

```
 .crop img{
      width:400px;
      height:300px;
      position: absolute;
      clip: rect(0px,200px, 150px, 0px);
      } 
```

**说明：** 这里的图像根据图像的宽度和高度值调整大小。裁剪是由剪辑属性完成的。

有关剪辑属性的详细信息，请遵循： [http ://tympanus.net/codrops/2013/01/16/understanding-the-css-clip-property/](http://tympanus.net/codrops/2013/01/16/understanding-the-css-clip-property/)

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2020-05-05T07:58:29.067

尝试使用该`clip-path`属性：

> clip-path 属性允许您将元素剪辑为基本形状或 SVG 源。
> 
> 注意：clip-path 属性将替换已弃用的 clip 属性。

```
img {
  width: 150px;
  clip-path: inset(30px 35px);
}
```

```
<img src="http://i.stack.imgur.com/wPh0S.jpg">
```

更多例子[在这里](https://developer.mozilla.org/en-US/docs/Web/CSS/clip-path)。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2015-05-25T19:52:03.017

在裁剪类中，放置要显示的图像大小：

```
.crop {
    width: 282px;
    height: 282px;
    overflow: hidden;
}
.crop span.img {
    background-position: center;
    background-size: cover;
    height: 282px;
    display: block;
} 
```

html 将如下所示：

```
<div class="crop">
    <span class="img" style="background-image:url('http://url.to.image/image.jpg');"></span>
</div> 
```

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2013-04-09T06:30:59.323

```
<p class="crop"><a href="http://templatica.com" title="Css Templates">
    <img src="img.jpg" alt="css template" /></a></p> 
```

* * *

```
.crop {
    float: left;
    margin: .5em 10px .5em 0;
    overflow: hidden; /* this is important */
    position: relative; /* this is important too */
    border: 1px solid #ccc;
    width: 150px;
    height: 90px;
}
.crop img {
    position: absolute;
    top: -20px;
    left: -55px;
} 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2017-01-25T19:53:15.893

有像 Filestack 这样的[服务](http://blog.filestack.com/api/how-to-automatically-resize-fit-and-align-any-image-using-only-url-parameters/)可以为你做这件事。

他们获取您的图像 url 并允许您使用 url 参数调整它的大小。这很容易。

调整为 200x100 但保持纵横比后，您的图像将如下所示

整个网址看起来像这样

```
https://process.filestackapi.com/AhTgLagciQByzXpFGRI0Az/resize=width:200/crop=d:[0,25,200,100]/https://i.stack.imgur.com/wPh0S.jpg 
```

但重要的部分只是

```
resize=width:200/crop=d:[0,25,200,100] 
```

[![在此处输入图像描述](https://i.stack.imgur.com/yefj6.jpg)](https://i.stack.imgur.com/yefj6.jpg)

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-01-29T20:40:32.090

您可以将 img 标签放在 div 标签中并同时执行这两种操作，但我建议您不要在浏览器中缩放图像。大多数时候它做得很糟糕，因为浏览器有非常简单的缩放算法。最好先在 Photoshop 或 ImageMagick 中进行缩放，然后将其漂亮漂亮地提供给客户。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-01-29T20:46:05.123

我所做的是创建一个服务器端脚本，该脚本将在服务器端调整和裁剪图片的大小，以便通过互联网发送更少的数据。

这相当琐碎，但如果有人有兴趣，我可以挖掘并发布代码（asp.net）

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2014-02-28T11:29:32.783

```
<div class="crop">
    <img src="image.jpg"/>
</div> 
```

```
.crop {
  width: 200px;
  height: 150px;
  overflow: hidden;
}
.crop img {
  width: 100%;
  /*Here you can use margins for accurate positioning of cropped image*/
} 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2016-06-14T19:32:37.403

如果您使用的是 Bootstrap，请尝试使用`{ background-size: cover; }`for，`<div>`也许给 div 一个类`<div class="example" style=url('../your_image.jpeg');>`，这样它就变成了 `div.example{ background-size: cover}`

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2017-10-22T20:52:50.897

我最近需要这样做。我想制作一个指向 NOAA 图表的缩略图链接。由于他们的图表可能随时更改，我希望我的缩略图随之更改。但是他们的图表有一个问题：它的顶部有一个巨大的白色边框，所以如果你只是缩放它来制作缩略图，你最终会在文档中出现多余的空白。

这是我解决它的方法：

[http://sealevel.info/example_css_scale_and_crop.html](http://sealevel.info/example_css_scale_and_crop.html)

首先我需要做一点算术。来自 NOAA 的原始图像为 960 × 720 像素，但前 70 个像素是多余的白色边框区域。我需要一个 348 × 172 的缩略图，顶部没有额外的边框区域。这意味着原始图像的所需部分是 720 - 70 = 650 像素高。我需要将其缩小到 172 像素，即 172 / 650 = 26.5%。这意味着需要从缩放图像的顶部删除 70 = 19 行像素中的 26.5%。

所以……</p>

1.  设置高度 = 172 + 19 = 191 像素：

    **高度=191**

2.  将下边距设置为 -19 像素（将图像缩短为 172 像素高）：

    **边距底部：-19px**

3.  将顶部位置设置为 -19 像素（将图像向上移动，以便顶部 19 像素行溢出 & 被隐藏而不是底部的行）：

    **顶部：-19px**

生成的 HTML 如下所示：

```
<a href="…" style="display:inline-block;overflow:hidden">
<img width=348 height=191 alt=""
style="border:0;position:relative;margin-bottom:-19px;top:-19px"
src="…"></a> 
```

如您所见，我选择设置包含 <a> 标记的样式，但您也可以设置 <div> 样式。

这种方法的一个缺陷是，如果您显示边框，则顶部边框将丢失。因为无论如何我都使用border=0，所以这对我来说不是问题。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2019-09-24T06:22:24.050

您可以使用 Kodem 的[Image Resize Service](https://kodem.io/documentation/3?utm_source=stackoverflow&utm_medium=493296&utm_campaign=imageresize)。只需一个 http 调用，您就可以调整任何图像的大小。可以在浏览器中随意使用，也可以在您的生产应用程序中使用。

*   将图像上传到您喜欢的地方（S3、imgur 等）
*   将其插入您的专用 API url（来自我们的仪表板）

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2021-03-22T08:20:00.887

您还可以使用名为 Croppie 的工具来裁剪图像...

```
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title></title>
<link href="https://foliotek.github.io/Croppie/croppie.css" rel="stylesheet" />
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"> </script>
<script src="https://foliotek.github.io/Croppie/croppie.js"> </script>
<script src="https://foliotek.github.io/Croppie/bower_components/exif-js/exif.js"> </script>

<style>
    #page {
        background: #ffffff;
        padding: 20px;
        margin: 20px;
    }

    #demo-basic {
        width: 600px;
        height: 600px;
    }
</style>
</head>
<body>
<h1>Crop Image Demo</h1>
<input id="upload" type="file" />
<br />
<div id="page">
<div id="demo-basic"></div>
</div>

<input id="upload-result" type="button" value="Crop Image"/>
<br />
<img id="cropped-result" src=""/>

<script>
    var $uploadCrop;       

    $("#upload").on("change", function () { readFile(this); show(); });

    $("#upload-result").on("click", function (ev) {
        $uploadCrop.croppie("result", {
            type: "canvas",
            size: "viewport"
        }).then(function (resp) {
            $("#cropped-result").attr("src", resp);
        });
    });

    function show() {
        $uploadCrop = $("#demo-basic").croppie({
            viewport: { width: 100, height: 100 },
            boundary: { width: 300, height: 300 },
            enableResize: true,
            enableOrientation: true,
            mouseWheelZoom: 'ctrl',
            enableExif: true
        });
    }

    function readFile(input) {
        if (input.files && input.files[0]) {
            var reader = new FileReader();

            reader.onload = function (e) {
                $("#demo-basic").addClass("ready");
                $uploadCrop.croppie("bind", {
                    url: e.target.result
                }).then(function () {
                    console.log("jQuery bind complete");
                });

            }

            reader.readAsDataURL(input.files[0]);
        }
        else {
            alert("Sorry - you're browser doesn't support the FileReader API");
        }
    }
</script>
</body>
</html> 
```

# ruby-on-rails - 有谁知道与从 Rails 应用程序将事件导出到 iCal、Google 日历、Outlook 相关的任何宝石/插件/教程？

> ID：493300
> 
> 赞同：10
> 
> 时间：2009-01-29T20:36:28.167
> 
> 标签：ruby-on-rails, export, google-calendar-api, icalendar

我试图弄清楚是否已经有一个插件可以与 iCal、我可以使用的 Google API 进行交互，或者我是否需要自己动手并自己编写。

如果有人知道我可以查看的好的资源可以帮助我实施，那也很好。

我是 RoR 的新手，我一直在尝试学习它。我最终决定开始使用我自己的应用程序，而不仅仅是阅读一本书。

在这件事上的任何帮助将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-29T20:56:38.393

查看用于 Rails的[Google 日历 gem 。](http://benjamin.francisoud.googlepages.com/googlecalendar)它允许您在 Rails 应用程序中显示用户的 Google 日历，并且他们有示例片段显示如何将事件导出到 Google 日历：

```
require 'googlecalendar'
g = GData.new
g.login('REPLACE_WITH_YOUR_MAIL@gmail.com', 'REPLACE_WITH_YOUR_PASSWORD')
event = { :title=>'title',
:content=>'content',
:author=>'pub.cog',
:email=>'pub.cog@gmail.com',
:where=>'Toulouse,France',
:startTime=>'2007-06-06T15:00:00.000Z',
:endTime=>'2007-06-06T17:00:00.000Z'}
g.new_event(event) 
```

对于 iCal，使用[iCalendar gem](http://firstruby.wordpress.com/2007/12/10/ical-icalendar-publishing-through-rubyonrails/)，然后您可以按如下方式导出事件：

```
require ‘icalendar’

class EventController < ApplicationController
  def export_events
    @event = Event.find(params[:id])
    @calendar = Icalendar::Calendar.new
    event = Icalendar::Event.new
    event.start = @event.dt_time.strftime(”%Y%m%dT%H%M%S”)
    event.end = @event.dt_time.strftime(”%Y%m%dT%H%M%S”)
    event.summary = @event.summary
    event.description = @event.description
    event.location = @event.location
    @calendar.add event
    @calendar.publish
    headers['Content-Type'] = “text/calendar; charset=UTF-8″
    render_without_layout :text => @calendar.to_ical
  end
end 
```

# c# - 序列化数据集时强制显示 XML 标记

> ID：493301
> 
> 赞同：1
> 
> 时间：2009-01-29T20:36:37.620
> 
> 标签：c#, dataset

我正在构建一个 web 服务，它有一个返回 Dataset 对象的 web 方法。

我遇到了一个问题，当关联值为空时，未写入 XML 标记。

一个简化的例子如下：

```
ID   Name    Text
--  ------   -------------
1    NULL     test1              <------- null value
2    toto     test2
3    tata     test3 
```

将 XML 序列化为：

```
<table roworder="1">
   <id>   1     </id>            <----- element missing when value = null
   <text> test1 </text>
</table>
<table roworder="2">
     <id>   2   </id>
   <name> toto  </name>
   <text> test2 </text>
</table>    
<table roworder="3">
     <id> 3     </id>
   <name> tata  </name>
   <text> test3 </text>
</table> 
```

当我将此 XML 连接到 Reporting Services 中时，这给我带来了问题。如果第一行的元素为空，则它不会将其识别为报表字段，并且整个列是否会从结果中丢失。

如果关联值为 null，是否有办法强制 XML 序列化放入空元素？

前任：

```
<table roworder="1">
   <id>   1     </id>
   <name>       </name>             <---- empty element for null value
   <text> test1 </text>
</table> 
```

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-29T20:41:54.367

您可以更改 SQL 以返回空字符串而不是 null。

`select COALESCE(Name, '') from table_name;`

**[编辑]**如果这不是一个选项，可能会有另一种（相当丑陋）的方式。

1.  使用从原始数据集中提取的模式创建另一个空白数据集。
2.  遍历此数据集中的可为空列并设置一个`DefaultValue`.
3.  将从第一个数据集生成的 XML 加载到该数据集中（只是数据，而不是模式）。
4.  从第二个数据集生成 XML。

啊！

**[编辑 2]**或者您可以只遍历数据集并自行创建 XML。

# python - 在 Django 中，如何在没有显式查询的情况下从多对多关系的额外字段中检索数据？

> ID：493304
> 
> 赞同：16
> 
> 时间：2009-01-29T20:38:21.720
> 
> 标签：python, django, manytomanyfield

鉴于 Django 1.0 中的情况，您有[关于多对多关系的额外数据](http://docs.djangoproject.com/en/dev/topics/db/models/#intermediary-manytomany)：

```
class Player(models.Model):
  name = models.CharField(max_length=80)

class Team(models.Model):
  name = models.CharField(max_length=40)
  players = models.ManyToManyField(Player, through='TeamPlayer', related_name='teams')

class TeamPlayer(models.Model):
  player = models.ForeignKey(Player)
  team = models.ForeignKey(Team)
  captain = models.BooleanField() 
```

多对多关系允许您使用属性（Team 对象上的“players”属性或通过其相关名称使用 Player 对象上的“teams”属性）访问相关数据。当其中一个对象被放置到模板的上下文中时（例如，团队放置在上下文中以渲染生成团队名单的模板），可以访问相关对象（即团队中的球员），但是如何访问额外数据（例如“队长”）与上下文中对象（例如团队）中的相关对象一起被访问，而不向上下文中添加额外数据？

我知道可以直接查询中间表以获取额外数据。例如：

```
TeamPlayer.objects.get(player=790, team=168).captain 
```

或者：

```
for x in TeamPlayer.objects.filter(team=168):
  if x.captain:
    print "%s (Captain)" % (x.player.name)
  else:
    print x.player.name 
```

但是，直接在中间表上执行此操作需要我将其他数据放置在模板的上下文中（TeamPlayer 上的查询结果），如果可能发生这种情况，我会尽量避免。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-29T21:13:53.570

因此，在提出问题 15 分钟后，我找到了自己的答案。

使用`dir(Team)`，我可以看到另一个名为的生成属性`teamplayer_set`（它也存在于 Player 上）。

```
t = Team.objects.get(pk=168)
for x in t.teamplayer_set.all():
  if x.captain:
    print "%s (Captain)" % (x.player.name)
  else:
    print x.player.name 
```

不知道如何自定义生成的相关名称，但至少我知道我可以从模板中获取数据，而无需在上下文中添加额外的查询结果。

# asp.net - “iis.config”文件在 IIS 上运行 Web 应用程序时起什么作用？

> ID：493309
> 
> 赞同：0
> 
> 时间：2009-01-29T20:39:51.890
> 
> 标签：asp.net, iis, deployment

我们最近完成了一个按预期工作的 Web 应用程序的开发。当我们把它交给运维团队时，他们有点吓坏了，因为我们没有提供文件“iis.config”。这个文件是什么？它有什么作用？

编辑：原来它是我们内部操作监控程序或其他东西的专有文件。我的错。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-29T20:44:17.233

我个人从未听说过。

也许它们意味着某种 IIS 元数据库的导出？

我会回到他们那里，诚实地说：“iis.config 是什么意思，我们没有这些。”

如果这样的文件普遍存在，那么“iis.config”就会有很多相关的谷歌搜索结果

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-29T22:14:39.233

项目中有 Web.config 文件吗？如果不是，也许这就是他们的意思。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-29T22:40:20.383

我同意 Teknohippy。我能找到的最接近的是：

[954872](http://support.microsoft.com/default.aspx?scid=kb;EN-US;954872)如何在 Internet Information Services 7.0 中创建和管理配置备份

# c# - 如何在 .NET 中编写安全/正确的多线程代码？

> ID：493311
> 
> 赞同：21
> 
> 时间：2009-01-29T20:39:58.473
> 
> 标签：c#, .net, vb.net, multithreading

今天我不得不修复一些使用线程的旧 VB.NET 1.0 代码。问题在于从工作线程而不是 UI 线程更新 UI 元素。我花了一些时间才发现我可以使用带有 InvokeRequired 的断言来找到问题。

除了上面提到的并发修改问题外，还有死锁、竞争条件等可能会遇到。**由于调试/修复线程问题很痛苦，我想知道如何减少该领域的编码错误/故障，以及如何更轻松地找到其中的任何一个。**所以，我要问的是：

*   **编写多线程代码时有什么好的模式可以遵循吗？什么是注意事项？**
*   **您使用什么技术来调试线程问题？**

如果适用且可能，请提供一些示例代码。答案应该与 .NET 框架（任何版本）相关。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-01-29T20:58:38.683

这可能是一个*庞大的*列表——阅读 Joe Duffy 出色的“ [Windows 上的并发编程](https://rads.stackoverflow.com/amzn/click/com/032143482X)”以获得更多详细信息。这简直就是脑残...

*   拥有锁时尽量避免调用大量代码
*   避免锁定类外的代码也可能锁定的引用
*   如果您一次需要获取多个锁，请始终以相同的顺序获取这些锁
*   在合理的情况下，使用不可变类型——它们可以在线程之间自由共享
*   除了不可变类型，尽量避免线程之间共享数据的需要
*   避免试图让你的类型线程安全；大多数类型不需要，通常需要共享数据的代码需要控制锁定本身
*   在 WinForms 应用程序中：
    *   不要在 UI 线程上执行任何长时间运行或阻塞的操作
    *   不要从 UI 线程以外的任何线程触摸 UI。（使用 BackgroundWorker、Control.Invoke/BeginInvoke）
*   尽可能避免线程局部变量（又名线程静态变量） - 它们可能导致意外行为，尤其是在 ASP.NET 上，请求可能由不同线程提供服务（搜索“线程敏捷性”和 ASP.NET）
*   不要试图变得聪明。*无锁并发*代码很难正确处理。
*   记录类型的线程模型（和线程安全）
*   Monitor.Wait 应该几乎总是与某种检查结合使用，在一个 while 循环中（即 while（我无法继续）Monitor.Wait(monitor)）
*   每次使用其中之一时，请仔细考虑 Monitor.Pulse 和 Monitor.PulseAll 之间的区别。
*   插入 Thread.Sleep 以消除问题从来都不是真正的解决方案。
*   查看“Parallel Extensions”和“Coordination and Concurrency Runtime”作为使并发更简单的方法。Parallel Extensions 将成为 .NET 4.0 的一部分。

在调试方面，我没有太多的建议。使用 Thread.Sleep 来增加看到竞争条件和死锁的机会是可行的，但是在你知道把它放在哪里之前，你必须对哪里出了问题有一个相当合理的理解。日志记录非常方便，但不要忘记代码进入某种量子状态 - 通过日志记录观察它几乎必然会改变其行为！

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-01-29T21:01:14.327

我不确定这对您正在使用的特定应用程序有多大帮助，但这里有两种从函数式编程中借鉴来编写多线程代码的方法：

**不可变对象**

如果您需要在线程之间共享状态，则状态应该是不可变的。如果一个线程需要对对象进行更改，它会使用更改创建对象的全新版本，而不是改变对象的状态。

不变性本身并不限制您可以编写的代码类型，也不是低效的。有很多不可变堆栈的实现，构成映射和集合基础的各种不可变树，以及其他类型的不可变数据结构，并且许多（如果不是全部）不可变数据结构与其可变对应物一样有效。

由于对象是不可变的，一个线程不可能在你的眼皮底下改变共享状态。这意味着您不需要获取锁来编写多线程代码。这种方法消除了与死锁、活锁和竞争条件相关的一整类错误。

**Erlang 风格的消息传递**

你不需要学习这门语言，但看看 Erlang 看看它是如何处理并发的。Erlang 应用程序可以无限扩展，因为每个进程都与其他进程完全分离（注意：这些不完全是进程，但也不完全是线程）。

进程启动并简单地循环等待消息：消息以元组的形式接收，然后进程可以对其进行模式匹配以查看消息是否有意义。进程可以发送其他消息，但它们对接收消息的人无动于衷。

这种风格的优点是消除了锁，当一个进程失败时，它不会关闭整个应用程序。这是 Erlang 风格并发的一个很好的总结：http: [//www.defmacro.org/ramblings/concurrency.html](http://www.defmacro.org/ramblings/concurrency.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-22T00:26:56.683

使用 FIFO。其中很多。这是硬件程序员的古老秘密，它不止一次地救了我的培根。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-07-04T08:38:04.630

似乎没有人回答如何调试多线程程序的问题。这是一个真正的挑战，因为如果存在错误，则需要实时调查，这对于 Visual Studio 等大多数工具来说几乎是不可能的。唯一实用的解决方案是编写跟踪，尽管跟踪本身应该：

1.  不添加任何延迟
2.  不使用任何锁定
3.  多线程安全
4.  以正确的顺序跟踪发生的事情。

这听起来像是一项不可能完成的任务，但通过将跟踪写入内存可以轻松实现。在 C# 中，它看起来像这样：

```
public const int MaxMessages = 0x100;
string[] messages = new string[MaxMessages];
int messagesIndex = -1;

public void Trace(string message) {
  int thisIndex = Interlocked.Increment(ref messagesIndex);
  messages[thisIndex] = message;
} 
```

Trace() 方法是多线程安全的、非阻塞的，可以从任何线程调用。在我的 PC 上，执行大约需要 2 微秒，这应该足够快了。

在您认为可能出错的地方添加 Trace() 指令，让程序运行，等到错误发生，停止跟踪，然后调查跟踪是否有任何错误。

有关此方法的更详细描述，它还收集线程和计时信息、回收缓冲区并很好地输出跟踪，您可以在以下位置找到：CodeProject：实时调试多线程代码[1](http://www.codeproject.com/Articles/792532/Debugging-multithreaded-code-in-real-time)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-22T00:25:03.007

这些是编写高质量（更易于阅读和理解）多线程代码的步骤：

1.  查看Jeffrey Richter的[Power Threading 库](http://www.wintellect.com/PowerThreading.aspx)
2.  观看视频 - 感到惊讶
3.  花一些时间更深入地了解真正发生的事情，请阅读[此处](http://msdn.microsoft.com/en-us/magazine/cc301191.aspx)的“并发事件”文章。
4.  开始编写强大、安全的多线程应用程序！
5.  意识到这仍然不是那么简单，犯一些错误并从中吸取教训......重复......重复......重复:-)

# sharepoint - 您的公司如何看待 SharePoint？

> ID：493312
> 
> 赞同：24
> 
> 时间：2009-01-29T20:40:21.983
> 
> 标签：sharepoint, sharepoint-2007, sharepoint-2010

**更新**重新审视这个问题的有趣时间。现在 SharePoint 2010 开始流行，人们的看法是否仍然相同？当然，实施 2010 年并非没有挑战，但商业认知是其中之一吗？

**更新：**我们的实施现在正在加速推进，一些备受瞩目的项目将在未来几周内投入使用，所以我很想看看那里的环境是否发生了变化。

**原始问题**

我们的工作环境中存在一个问题，即对 SharePoint 的看法是：

a) 金子弹，我们所有问题的答案。

b) 解决或不解决特定问题的应用程序。

c) 一个令人沮丧的工具，不能满足他们的严格要求。

现在，在我看来，SharePoint（或者更具体地说，在我们的案例中是 Microsoft Office SharePoint Server 2007）是一个基于各种较低级别 Microsoft 技术（IIS、ASP.Net、WSS 3.0、.Net Framework、Windows Workflow Foundation 等）之上的框架，并且因此，可以开发做大多数事情（给定时间和资源）。

在我的组织（以及我确信的其他人）中形成的态度是微软营销机器和组织希望在尽可能多的人面前获得“金子弹”而不说“为了什么？ ' 或“为什么？” 或者在某些情况下甚至是“如何？”

这是其他 SharePoint 开发人员所共有的态度和看法吗？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-01-29T21:53:50.727

在我工作的组织中，这**完全**取决于一个人的技术理解水平。业务人员将其视为利用预先构建的平台并相对轻松地进行一些小改动的机会。然而，它的现实是，对于技术人员来说，这是一场噩梦。权衡往往是从一个极端到另一个极端，这意味着如果我们使用内置功能做某事，它相对容易，但最终用户体验远不能令人满意。另一方面，我们通常可以提供更好的用户体验，但代价是大量的密集劳动。

就个人而言，作为技术方面的个人，我不建议将 SharePoint 用于任何环境，因为当您考虑许可成本时，除了开发时间以使任何事情变得有价值（根据我的经验，这总是需要更多时间比自定义 ASP.NET 应用程序）您最终会遭受可笑的净损失。大多数 Intranet 站点都能够相对轻松地使用免费版本 (WSS)；但是，他们通常不会进行大量定制，而只是将其用作文档存储库。

无论出于何种原因，业务人员对产品的看法完全不同。他们相信 SharePoint 最终会为他们节省资金。我说这是一种扭曲的观点，因为我见过的每个使用 SharePoint 的项目都**远远**超出了我对自定义 ASP.NET 应用程序（长期和短期）的估计。在一个特殊情况下，我参与了一个项目，该项目在自定义 ASP.NET 应用程序中最多需要一个月的时间（包括开发时间、QA 等）。然而，SharePoint 中的相同应用程序已经开发了将近一年。最重要的是，该项目根本不属于 SharePoint，但业务人员拒绝接受，直到他们别无选择。

如果您正在为您的组织考虑 SharePoint，我强烈建议您先做功课。期待一个非常大的学习曲线和很多挫折。您的大多数技术人员会立即认识到产品的缺陷并以极度沮丧的方式指出它们。这在 SharePoint 开发环境中很正常。如果最终您愿意做出这些牺牲而几乎没有收获，那么 SharePoint 就是适合您的解决方案。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-01-30T01:37:17.203

我现在的公司认为我们应该通过给他们 SharePoint 来授权 Intranet 用户。这样，他们可以随意管理/添加/删除用户、网站、页面。IT 可以更高效地利用时间，就像在谷歌上搜索大笑猫一样。

我们确实很好地和广泛地使用了 SharePoint ......到处都有大量的 SharePoint 列表......

没有发生的是实际上在内部销售产品的自助服务理念……而且 99% 应该“自己做……或者只是使用它……”的部门甚至从未碰过它！

--*这里大多数人知道的唯一软件是 Excel*

这里的人们发送屏幕截图图像以进行故障排除，并使用仅在 Excel 文件中粘贴的图像制作手册！

*（我以前在一台旧的 Solaris 机器上工作，没有 Open Office，所以即使我现在使用 XP .. 看到这种情况发生仍然很痛苦）*

对他们来说，互联网是雅虎主页和电子邮件。

他们（邪恶）希望这些人通过使用 SharePoint 来解决他们的业务需求。

现实检查：无论是否自助服务，这都不会发生......他们不使用 SharePoint 自己解决任何问题，但无论如何都没有人注意到......

..这是一个谎言，人们注意到它，但提到管理层*认为*SharePoint 的使用方式与现实之间的差异，是成为公司红发继子的可靠方法。

“普通用户”的这种授权是一个幽灵功能，我们在 IT 中总是最终完成工作..任何工作..应该通过拥有超级工具 SharePoint 来解决..我们最终创建了网站、列表，工作流程，通常我们是唯一使用它们的人。

这些都不是幽默的意思。。

*（在 IT 部门之外使用 SharePoint 的唯一工作流是每月的公司午餐公告，该公告来自 GA 或 HR 在将新列表项添加到 IT 制作的共享点列表后通过自动电子邮件发送）*

SharePoint 被视为通过将 IT 从上述*较小任务*中解放出来来提高 IT 生产力的金子弹，但这些*较小的任务*仍然存在，而且我们有额外的成本 *试图*让其他部门自己做

我认为，经过多年的内部对产品的抨击，现在人们对 SharePoint 是什么以及它的使用情况有了一些最基本的了解。问题是人们使用它的方式是微软所承诺的，但不是上层的管理：

基于 SharePoint 列表的文档存储和工作流——太棒了！

但是当权者应该明白，这永远不会是有自己的腿的东西，可以免于 IT 护理和培育。

它提出了一个我讨厌整个“让他们自己做的思考过程”的观点，让非 IT 用户自己开发东西在所有方面都会适得其反

（输入 InfoPath 表单......）

我们在 IT 中度过了一生，学习如何制作软件以及如何维护它（但仍然做错了），现在有人只想做营销 [或其他] 管理他们自己的数据和内部工作流程 UI+逻辑！ ！

这是一个不必要的学习曲线（对每个人来说），它将驱使我们所有人去其他地方寻找工作，并让 IT 完成调试疯狂且无法管理的半熟业务对象的不可能任务。

输入流行词嘉豪：MOSS 做 CMS...

结果：我们现在正在从作为 CMS 的 Interwoven（被用作美化的自动化 FTP 客户端服务器工具）转移到 MOSS。

我在 SharePoint 和现在的 MOSS 方面有一年多的经验，但高层管理人员的整个想法是：

“让营销部门自己做，因为 MOSS 是 SharePoint++ .. 自我管理”

我认为 MOSS 是一个非常酷的工具，但这是我在最近一次会议上的评论：

“嗯，我认为营销部门应该快速了解一下 SharePoint Designer，这样他们就知道会发生什么”

*收到的答案：“这太技术性了..” <<<< 他们真的希望通过点击*网站选项的开箱即用功能来执行完整的品牌推广..

他们最初计划将品牌开发外包并从那时起将其发展..否则，尝试向他们解释绝对没有意义..

我？..每当我们开会讨论这个项目时，我都会想到找工作，感谢上帝，我不是这个项目的项目经理。

底线：我不责怪 SharePoint 工具，但我可以看到人们可能是如何在各地办公室以错误的心态使用它的。至少在我的公司中它被严重滥用和误解，并且将继续支持错误未来几年的权力的原因。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-01-29T21:10:36.617

从来不知道该怎么处理它。只是让我们茫然和困惑，我们最终转向其他事情。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-02-10T08:44:10.680

我们在我以前的公司（南非的一家 FMCG 集团）对 SharePoint 的体验在很多方面都是积极的（主要是 WSS，尽管我们也实施了 MOSS）。

我们抑制了过多的定制，并决定尽可能多地使用盒装功能，仅在真正需要时进行定制。

几组**业务用户很好地采用了它来**围绕项目或部门问题进行协作和知识管理，在某些情况下，外联网站点专门用于特定的客户合作伙伴关系。到目前为止，最有效的站点是**各个业务部门的 CIO 直接参与的站点**- 他们似乎能够很好地理解技术并帮助商业人士看到光明。我认为一个重要的因素是，在我们实际推出任何产品之前，其中一位 CIO 多年来一直在推动将基于视角的全方位门户的总体愿景作为信息战略的一部分。我坚信从几个高价值点而不是沉重的自上而下驱动器有机地传播 SharePoint。但随着 SharePoint 的实施，**我们的变更管理功能很好地支持了**这种传播，该功能位于 IT 中，但在业务中根深蒂固。

对于其中一个企业，我们建立了一个通用的外联网协作站点，并在 SharePoint 中培训了一个人。**对于业务用户来说，能够在几分钟内创建子站点以与他们的任何业务合作伙伴协作**是一个巨大的胜利（除了帐户创建，IT 仍然这样做）。这些类型的需求以前由网站设计人员和开发人员花费了几个月的时间。

对于我的团队（开发团队），我们将 WSS 广泛用于协作、KM 等，但它也对我们的解决方案交付产生了有意义的影响。一方面，我们曾多次忙于开发部门迫切需要的小型利基应用程序，但坦率地说，这些应用程序的成本比他们应该的要高得多，而且花费的时间也太长。通过非常熟悉 WSS 产品，我们越来越**发现我们可以帮助他们在很短的时间内仅使用 WSS 建立一个适当的解决方案**. 虽然有些很简单，可以让他们使用它们自己运行（一些进步的秘书类型正在采用 SharePoint 网站，就像他们曾经采用 Outlook 一样）其他需要我们持续的帮助 - 但可维护性比自定义编写的 C#/ASP 轻得多.NET 应用程序。底线 - 我们可以更快地交付价值，并且只在真正产生影响的地方使用代码，从而降低 TCO。

我认为 SharePoint 正在帮助我们进入一类由我们**编写**而不是**编写代码的解决方案**一切。例如，在一个案例中，一家公司希望通过人工发送 Excel 电子表格来下订单。我们内心的纯粹主义者抗拒并想要寻求更无懈可击的东西——但我们无法发号施令，需要在这些限制范围内灵活地交付。所以我们创建了一个 WSS 站点（通过简单地从我们之前设置的根外联网协作站点创建一个子站点）并让人们将他们的电子表格附加到一个列表中。我们设置 BizTalk 来提取这些、提取数据、将订单推送到 ERP 系统，然后返回并标记 WSS 列表项的状态。所以我们仍然编写代码，但使用 WSS 开箱即用的功能来提供整个用户端体验。

我仍然对 SharePoint 作为通用**Web 应用程序开发平台**寄予厚望（即，这里有很多管道，现在可以根据需要利用和扩展）。我们还没有深入到那里，因为在一个可能难以/混乱维护的地方存在学习障碍以及大量代码的滑坡。**我确实计划继续探索这是否属实，但与此同时，我认为在解决方案组合**思维方式中开箱即用地利用大量价值。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-01-29T21:55:53.173

我遇到了很多正在进行“银/金/魔弹”销售的人和组织。

我看到人们想要统一存储在他们的业务中的信息，通常是大型共享驱动器和分散在各处的文档，以及基于 Web 的不同应用程序。

组织希望他们的员工可以轻松使用所有东西（可查找性），并且他们希望它看起来好像是一个巨大应用程序的一部分，以便整个组织的用户有一个一致的地方，他们可以去完成他们需要做的一切。

造成的困惑是人们认为它必须在“在”SharePoint 中完成，而不是使用 SharePoint 将所有部分放在一起并在组织内为其提供上下文（例如，大型“找花”应用程序位于网站的园艺部分）。

问题是，一个好的信息架构需要大量的工作和计划​​去哪里。很多时候，SharePoint 就像一个新的共享驱动器一样被使用，并且东西只是被转储到任何地方。

对于开发人员来说，这对他们的日常工作并不重要，但对项目经理或经理来说却很重要。开发可以产生*大量*的文档，一个创建良好的开发站点可以很容易地找到“为那个项目设计文档，我们从未有时间去做，但我们昨天需要”。

SharePoint 并不是真正的开发人员核心工作（即它不是开发环境或源代码控制）。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-01-29T21:06:56.750

**tl;dr**：Sharepoint 并没有给人一种专注于帮助我完成工作的印象。

不是很好。

在我们的工作中，我们发现 Fogbugz 提供了我们真正想要（并且确实）使用的功能，其方式明显更直观、更快捷，因此也更有用。当然，您可以为其中许多事情创建 Sharepoint 工作流，但我们为什么要这样做呢？我们直接从一个似乎更专注于帮助我们完成工作的系统获得合理的工作流程和功能。

*   开发工作流程：我们非常喜欢以案例为中心的结构。
*   非正式讨论：Fogbugz 讨论与旧时代的 Usenet 小组平行，非常适合在我们将问题变成需要处理的案例之前讨论它。
*   持续的讨论/文档：wiki 是我们构建所需材料的好地方，尤其是文档。
*   SVN 集成：这对我们来说变得越来越重要。
*   项目报告/基于证据的日程安排：这对我们的计划和报告过程迅速变得至关重要。

最后一个该死的事实：我们已经在这里使用 Sharepoint 很长一段时间了，但开发人员并没有真正感兴趣。我们介绍了 Fogbugz，开发团队几乎立即接受了它，并将其作为日常工作的一部分。

注意：这读起来像 Fogbugz 广告，但还有其他工具似乎希望对 Sharepoint 提供更多帮助。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-01-29T21:18:25.277

我们这里有 SP（非 MOSS 只是香草）。

大多数人不确定如何处理它。它不习惯它的潜力，但没有人（包括我自己）愿意投入那种时间。

它在这里使用的方式可以很容易地替换为远程共享和预定义的文件夹/目录结构。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-02-04T17:30:46.213

只要您或公司中的某个人精通技术，您的公司就会从免费版的 Sharepoint 中受益。确保您购买了 Sharepoint Designer 2007。

我的公司并不真正了解 sharepoint 是什么以及做什么。它实际上是我们简单的生产调度和零件跟踪系统的“后端”。用户可以看到在 sharepoint 设计器中创建的基本 aspx 页面。

Sharepoint 允许我快速创建用于管理信息的列表。我将 sharepoint 视为 Excel 对 Web 环境的扩展。大多数人使用 Excel 创建信息列表。Sharepoint 为该列表信息启用 Web 功能。

我使用 Sharepoint 的免费版本，并使用 Sharepoint Designer 对其进行了广泛的定制。我是一名具有一定编程技能的工程师。我知道我已经能够创建简单但有用的数据收集网页。

我首先使用 WSS 2.0 创建了一个软件错误跟踪器。当时（2003 年）我刚刚发现了 Fogbugz，我们实际上使用了 Fogbugz 的试用版。每个人都喜欢 Fogbugz，主要是因为您可以分配问题并且自动发送电子邮件。标准的 Sharepoint 问题跟踪列表也可以实现这一点。Fogbugz 显然有更多功能，但管理层决定我们将使用 sharepoint .....

最后，SharePoint 被广泛用于管理项目信息和与客户沟通。这是在很少定制的情况下完成的。刚刚创建了一些站点模板，每次创建一个新项目时，都会创建一个带有适当文档库、问题跟踪列表、日历等的新站点。

我是分享点粉丝！！！哦，是的，它有很多限制，它的顶级项目违反了数据库最佳实践，但 Sharepoint 可以工作！

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2009-05-13T11:38:12.393

根据我在一系列组织和第三方评论中观察到的情况，可以归结为一个词：**期望**。有些人期望 SharePoint 是解决所有问题的灵丹妙药。这种思想流派认为它是世界上最好的。丰富的开箱即用产品，提供广泛的协作工具，您还可以对其进行编码以扩展上述功能。由于 SharePoint 是一种 .NET 产品，因此您可以吸引普通的 Microsoft 开发人员并立即开始获得所有 RAD 优点。

从这个期望开始，将标准设置在 a) Microsoft 从未真正打算过的水平，并且 b) 如果没有知识渊博的 SharePoint 开发人员和合适的环境，就不太可能实现。很快就会意识到它比这更复杂一点。是的，您可以针对 SharePoint 进行编码，但不能期望它类似于构建 .NET 应用程序。从开发环境要求到发布过程再到持续维护，一切都比简单地构建 ASP.NET 应用程序更复杂。这还需要考虑到这样一个事实，即在许多组织中，SharePoint 是一个集中的共享环境，通常会带来一定程度的治理，不允许您随意简单地部署解决方案。

回到预期；当您继续假设这是一个用于协作活动、门户或文档管理的好工具时，它是一个了不起的产品。甚至继续在​​平台上进行开发，期望它需要一些专业技能，并且部署和管理过程将与传统的 .NET 堆栈不同，但这样做时要睁大眼睛了解其含义。

所以总而言之，它是一个很棒的产品，只要设定得当，它就可以在组织内得到非常积极的评价。但是，如果您在没有完全理解其含义的情况下陷入炒作，那么您很有可能设定了一个您将无法实现的期望。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-02-05T01:19:15.193

我想说sharepoint还不错！它管理信息的方式很棒！然而，困扰我的一件事是它对最终用户来说有点太复杂了，我们的组织花了两个月的时间来教育他们，但结果远远超出了我们的预期。有时看起来我们在上世纪50年代得到了一架超音速飞机——我们不能充分利用它！

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2009-10-01T11:23:10.247

关于您对“如果那里的环境发生变化”的更新……根据我的经验，情况变得更糟了。这主要是因为用户界面。

作为一名开发人员，我经常听到“它看起来像 SharePoint”的评论，表明该产品越来越过时了。（自从发布以来，我一直对它的外观感到失望。）这意味着大量的 CSS 和图形工作是痛苦的，因为有这么多的表格在使用和完全废话 HTML。

除了外观之外，很多人发现界面不直观且令人沮丧。特别是对于知识较少的用户来说，仅仅上传一个文档就需要多次点击和不同的页面。

同样由于 UI 不足，我被要求做很多 Web-2.0/AJAX/jQuery 的东西来美化界面并向用户提供更好的反馈。该产品不是为此而设计的。当 jQuery 需要在 2007 版本中非常令人失望的 Web 服务时，这是非常耗时的。（幸运的是，终于有人[为 SharePoint Web Services 启动了一个 jQuery 库](http://spservices.codeplex.com/)。）

当产品的下一个版本即将推出时，通常会发生这种情况，我非常希望 SharePoint 2010 是坚如磐石的，因此当我们达到 2010 年的 RTM 时，几乎没有理由在 2007 平台上启动新项目。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-01-30T09:19:06.473

因此，我注意到迄今为止，没有人真正对 SharePoint 有过真正积极的体验，但每个人都在购买它。这让我很困惑 MS 是如何做到这一点的？

我们在管道中有许多简单的项目将从注入 SP 中受益匪浅。但我想，在大多数情况下，我们将寻求将 SharePoint“融合”到我们的产品和技术组合中。它做得很好，它确实做得很好，但对于特定场景，它几乎总是需要一些自定义元素（例如 CSS、JScript 或服务器端代码），而且它可能并不总是合适的解决方案。

我最近听到一位 MS 分析师将 SharePoint 称为建模粘土，这为我总结了！

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2011-06-10T19:30:49.190

我知道这个问题是针对开发人员的（而且有点老了），但我想从业务用户的角度分享一个观点。我们公司（全球 75,000 多名员工）部署了 MOSS 2007 的“Team Site”模板，淘汰了我们现有的文档 e-Rooms，并通过零培训、零信息让我们松了一口气。

整个公司的用户都将他们的团队网站用作文档存储库。有一些用户有了更多的了解，并开始设置和使用 MOSS 2007 的协作功能。

我还应该提到 - 我们公司仍在使用 IE6 和 MS Office 2003。（遗憾的是，仅凭这一事实，我们无法使用 SharePoint 做的所有事情。）

我们公司不会奖励想方设法利用所提供的工具来创建更好的协作的最终用户，我们的 IS/IT 部门拒绝协助提供学习材料、机会或以任何方式帮助最终用户。在目前的狗咬狗心态下——下岗后下岗，现在有 1 人在做过去 5 人或更多人所做的工作，如果这不是核心重点的一部分，人们就没有时间他们的工作。

我已经为几个小组学习并实施了一些协作功能——即使我是在自己的时间学习的——这让我感到害怕，这是否意味着我会被认为没有足够的工作让我忙碌因此 - 消耗品？

至于*我*对 SharePoint 的感觉：我喜欢 sharepoint。它确实为最终用户提供了相当多的功能……这可能需要我花点时间来做啊哈，但最终，我明白了。有时我在构建页面时会感到有些沮丧——我希望它是 CSS 和 HMTL——但是，当然，我们无法使用共享点设计器。

如果 1\. 部署中包含培训，那将是更好的部署。2\. 上线期间实施了扎实的变更管理。

# sharepoint - Sharepoint 工作流程与。世界电影基金会

> ID：493322
> 
> 赞同：2
> 
> 时间：2009-01-29T20:41:28.890
> 
> 标签：sharepoint, workflow, workflow-foundation

标题不是很准确。我目前正在开发一个允许多人输入数据的网站。我需要/想要使用 WFF，因为人们会按一定的顺序输入数据。这是一个客户投诉表。销售人员将填写初始表格并提交投诉。投诉将被审查并驳回或转至调查部分。最后，投诉将被处理并关闭。

我的困境是我也在实施 Sharepoint。这两个项目大约在同一时间到期。最终，Sharepoint 将成为我们唯一的网站，投诉项目也转移到了 Sharepoint。

我宁愿等到 Sharepoint 到位后再进行客户投诉项目。我们将不得不从一开始就重新安排 Sharepoint 项目以包含工作流，而不是稍后再实施。

有任何想法、建议、意见吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-30T09:43:36.393

本质上，SharePoint 是 Windows Workflow Foundation 的托管引擎。在开发在 SharePoint 工作流引擎上运行所需的 WWF 工作流时，您需要包括一些元素，但您可以将这些元素构建到您的项目中，因为您知道此工作流将在某个时候移植到 SharePoint。

但是，当您实现 UI 组件以允许您的工作流程（表单等）运行时，以及在您身上运行它的引擎可能刚刚使用最小的 WSS 3.0 安装部署了它。

我的建议是，在 Visual Studio 中设计 WWF 工作流，使其在 SharePoint 工作流引擎中运行，并利用它附带的基础设施。否则，您将在投诉项目上花费额外的数周时间，当您移植到 SharePoint 时，这些项目很快就会变得多余。

[可以在这里找到一篇很好的概述文章。](http://www.developer.com/net/net/article.php/3652346)

# c# - 使用 UI 自动化更改 WinForms 组合框选择

> ID：493323
> 
> 赞同：5
> 
> 时间：2009-01-29T20:41:45.613
> 
> 标签：c#, .net-3.5, user-interface, automation

是否可以使用 c# UI 自动化（与 UIspy.exe 相同的逻辑）更改 winforms 应用程序中的选定项目？我想将所选项目更改为特定项目（我知道它是列表中的索引/位置）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-09-12T15:32:12.553

```
 public static void ActionSelectComboBoxItem(AutomationElement comboBoxElement, int indexToSelect){
        if(comboBoxElement == null)
            throw new Exception("Combo Box not found");

        //Get the all the list items in the ComboBox
        AutomationElementCollection comboboxItem = comboBoxElement.FindAll(TreeScope.Children, new PropertyCondition(AutomationElement.ControlTypeProperty, ControlType.ListItem));

        //Expand the combobox
        ExpandCollapsePattern expandPattern = (ExpandCollapsePattern)comboBoxElement.GetCurrentPattern(ExpandCollapsePattern.Pattern);
        expandPattern.Expand();

        //Index to set in combo box
        AutomationElement itemToSelect = comboboxItem[indexToSelect];

        //Finding the pattern which need to select
        SelectionItemPattern selectPattern = (SelectionItemPattern)itemToSelect.GetCurrentPattern(SelectionItemPattern.Pattern);
        selectPattern.Select();
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-11-27T18:56:06.373

继 sizu 的回答之后 - 您需要在检索项目之前展开 ComboBox。当 ComboBox 展开时，就 UIAutomation 而言，这些项目仅“存在”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-07-21T11:23:53.743

我们如何在动态生成列表的组合框中设置值。

就像我的情况一样

```
AutomationElementCollection comboboxItem = comboBoxElement.FindAll(TreeScope.Children, new PropertyCondition(AutomationElement.ControlTypeProperty, ControlType.ListItem)); 
```

comboboxItem.Count 为 0

在同一个组合框中，当我使用鼠标单击展开它时，它会显示所有值。

# database - 批评我的身份验证系统数据库架构？

> ID：493334
> 
> 赞同：1
> 
> 时间：2009-01-29T20:43:44.363
> 
> 标签：database, authentication, schema, authorization

我正在设计一个 RESTful Web 应用程序，它将为其他几个应用程序提供身份验证系统。其他应用程序将通过 HTTP 查询此应用程序并返回描述经过身份验证的用户的 XML。

身份验证应用程序需要跟踪允许**哪些用户**在**哪些应用程序上****执行什么操作。**

 **我正在研究数据库模式。下面是我最初的设计。（假设每个表都有一`id`列。）

```
applications  # The various client apps that will query this auth system.
------------
name

users         # Table simplified for discussion
-----
username
password
email

roles
-----
name
application_id

roles_users
-----------
role_id
user_id 
```

这个想法是说有人试图在“设备库存”应用程序中执行管理功能。因此，“设备库存”会对身份验证系统说“获取用户名 xxx 和密码 yyy 的用户”。然后它会查看返回的（通过 ActiveResource）`User`对象，并检查其`roles`数组是否包含`Role`名称为“ADMIN”且本身属于`Application`名称为“Equipment Inventory”的对象。

或者也许最好去掉`applications`表格并有更多的角色，例如，“ `equipment_inventory_admin`”、“ `equipment_inventory_readonly`”、“ `job_tracker_admin`”等。

更重要的是规范化Application实体还是简化表结构？也许在所有打字之后，我刚刚回答了我自己的问题，但我们非常欢迎您提出意见或建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-29T22:39:55.220

架构看起来很理智，你会发送

`<login><username>abc</username><password>xyz</password><app>51</app></login>`

然后你回来

`<auth> <user> <username>abc</a> <lastlogin>123456464</lastlogin> </user> <app> <name>Equipment Inventory</name> <version>3.1.5e</version> </app> <roles> <role>admin</role> <role>manager</role> <role>dataentry</role> </roles> </auth>`

或者

`<auth><error type="1"></auth>`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-29T23:04:51.160

绝对将身份验证与授权分开。（看起来你正在这样做；“用户”表属于身份验证，其余 + user.id 属于授权）

密码：您没有明文存储它们，是吗？存储 MD5 哈希（+[盐](http://en.wikipedia.org/wiki/Salt_(cryptography))以防止攻击）会更安全。

[Kerberos](http://web.mit.edu/Kerberos/)有可能吗？（也许它可以适应作为传输层在 HTTP 上工作）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-29T20:59:07.390

就我个人而言，我倾向于在标准化方面犯错。至少根据我的经验，一些额外的模块会被添加。根据需要在应用程序和全新表中添加额外的行要容易得多，然后编辑现有模式并必须更新所有相关的数据访问代码。

编辑：再看一遍，您可以合并角色表和角色用户表。它可能是定义角色以及用户如何为每个应用程序访问它们的地方。

# objective-c - 在 NSView 中绘制大量数据，还是其他？

> ID：493335
> 
> 赞同：4
> 
> 时间：2009-01-29T20:43:55.297
> 
> 标签：objective-c, cocoa, graphics, nsview

我有数十万个时间序列数据点要向用户表示。我目前的解决方案是使用 3rd 方库将所述数据呈现为 PNG，然后将该 PNG 加载到 a`NSImage`中并在滚动视图中显示。这很好用，除了：

1.  超过 32k 像素宽的 NSImage 无法正确显示
2.  我希望能够快速轻松地放大数据
3.  从磁盘读取和写入是愚蠢的

我目前的尝试是直接将`NSBezierPath`s 绘制到 a `NSView`。即使我一次只绘制有限的点子集，该视图也呈现精美，但非常非常缓慢。每次滚动时，我都必须重新绘制，这也很慢。

我敢肯定，作为一个相对的 Co​​coa 新手，我错过了一些更好的方法来做到这一点。什么是“正确”的做法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-30T03:39:31.137

> 我目前的尝试是直接将 NSBezierPaths 绘制到 NSView。即使我一次只绘制有限的点子集，该视图也呈现精美，但非常非常缓慢。每次滚动时，我都必须重新绘制，这也很慢。

在您采取任何激进的解决方案之前，请尝试以下更简单的步骤：

1.  **夹子。**使用[`NSRectClip`](https://developer.apple.com/documentation/appkit/1473759-nsrectclip)，将您作为参数的矩形传递给`drawRect:`. 这是一个单行。
2.  **在填充路径之前进行简单的矩形测试。**对于每条路径，获取它的边界并使用`NSIntersectsRect`它来测试它是否在矩形内。
3.  **在描边路径之前进行稍微不那么简单的矩形测试。**与上一步类似，除了您需要将矩形（作为参数接收的那个）扩大线宽，因为一半的笔划将落在路径之外。对于每条路径，获取线宽并将其取反（`delta = -[path lineWidth]`- 是的，您*必须*包含该减号），然后将结果作为两个参数传递给`NSInsetRect`. 确保保留原始矩形，因为不同的路径可能有不同的线宽。

这个想法很简单，就是少画。设置剪切路径（使用`NSRectClip`）将减少绘图操作导致的位块传输量。排除完全落在绘制矩形之外的路径将为您节省可能更昂贵的路径剪裁。

而且，当然，您应该在每个步骤中进行分析，以确保您没有让事情变慢。您可能想要设置某种帧速率计数器。

还有一件事：获取每条路径的界限可能很昂贵。（再次，配置文件。）如果是这样，您可能希望缓存每个路径的边界，可能使用 s 的并行`NSArray`或`NSValue`通过将路径和边界包装在一起在您自己设计的对象中。然后，您只需计算一次边界，然后在以后的绘图运行中检索它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-29T21:45:15.207

文档有一个关于[NSBezierPath 性能](http://developer.apple.com/documentation/Cocoa/Conceptual/CocoaDrawingGuide/Paths/chapter_6_section_7.html#//apple_ref/doc/uid/TP40003290-CH206-SW31)的部分。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-29T22:26:01.677

如果您要绘制那么多贝塞尔路径，OpenGL 可能是要走的路。Apple 的[文档](http://developer.apple.com/documentation/GraphicsImaging/Conceptual/OpenGL-MacProgGuide/opengl_drawing/chapter_3_section_1.html#//apple_ref/doc/uid/TP40001987-CH404-SW8)将是一个很好的起点。他们有在可可窗口中实现基本 OpenGL 渲染上下文的[示例代码。](http://developer.apple.com/samplecode/CocoaGL/index.html#//apple_ref/doc/uid/DTS10004501)

这会将困难的绘图任务的负担转移到图形处理器上，让您的应用程序可以随意滚动。

[这个页面](http://www.opengl.org/resources/code/samples/redbook/)有用于绘制贝塞尔曲线的示例 OpenGL 代码。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-30T21:25:08.257

为此，我会查看 CATiledLayer（仅限 Leopard）。您可以在平铺图层中绘制大量内容并根据需要显示区域。对于您的情况，您可以将 CATiledLayer 设置为 NSView 的支持，将所有贝塞尔路径绘制到该层，然后滚动甚至放大和缩小它。核心动画层像 OpenGL 纹理一样处理，因此您应该从中获得非常好的性能。矢量绘图缓存在图层中，并且在您滚动时不会重绘，就像您在标准 NSView 上找到的那样。

例如，Bill Dudney[发布了一些](http://bill.dudney.net/roller/objc/entry/catiledlayer_example)关于如何使用 CATiledLayer 显示大量 PDF 文件的示例代码。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-30T21:35:35.023

数据集的动态性如何？

如果它是相当静态的，并且您想要“缩放”，那么您应该考虑将数据合并到一个缩放的子集中。

人为的例子：如果你有 100,000 点（比如在 X 轴上前进），那么，很明显，在 1000 像素的图像中，你只会不可避免地绘制这 100,000 点中的 1000 点。

因此，您可以提前执行此操作（1000 分、10000 分、100000 分的原始数据），并根据您正在显示的“缩放”级别从适当的集合中进行选择。

至于点重叠时选择什么值，可以做min、max、median、average等。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-01T09:02:11.560

考虑使用一个可以有效处理这类事情的框架，比如[CorePlot](http://code.google.com/p/core-plot/)

# .net - 在 VB.NET 中以编程方式构建（编译）项目

> ID：493337
> 
> 赞同：0
> 
> 时间：2009-01-29T20:44:12.677
> 
> 标签：.net, vb.net

如何在 VB.NET 中以编程方式构建项目？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-29T20:54:51.983

```
System.Diagnostics.Process.Start("msbuild.exe"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-30T03:39:17.270

您可以启动 VS IDE 可执行文件 devenv.exe，如下所示：

devenv c:\myproj\myproj.vbproj /rebuild 发布

它以静默方式运行，您还可以指定一个日志文件进行输出。您还可以运行 vbc，它是 VB 编译器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-01T18:12:22.840

以下代码在表单加载时编译应用程序，尽管将任何更改的变量存储在外部设置文件中而不是重新编译应用程序不是一个更好的主意吗？

```
Imports System.Diagnostics.Process
Public Class Form1
    Public Sub BuildProject(ByVal pProject As String)
        Dim lBuildString As String = String.Format("C:\Windows\Microsoft.NET\Framework\v3.5\msbuild.exe {0} /t:Rebuild /p:Configuation=Release", pProject)
        Dim lReturnID = Shell(lBuildString, AppWinStyle.NormalFocus, False)
        'System.Diagnostics.Process.Start(lBuildString)
    End Sub

    Private Sub Form1_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
        BuildProject("C:\Programming\CommunicationsService\Communications_Service\Service_Tem[\Service_Tem[.vbproj")
    End Sub
End Class 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-01T18:15:03.740

这取决于您为什么要这样做，但是您是否考虑过使用 TFS 或类似的东西来执行此操作而不是滚动您自己的进程？

# .net - 在 WPF 中拉伸控件以填充 ListView 列

> ID：493345
> 
> 赞同：27
> 
> 时间：2009-01-29T20:46:16.213
> 
> 标签：.net, wpf, listview

如何使控件填充 ListView 中的整个单元格（使用 GridView）？我玩过各种属性，但控件始终是最小尺寸。

这是我的xml。

```
<Window x:Class="ListViewUserControlTest.Window1"
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:local="clr-namespace:ListViewUserControlTest"
  Title="Window1" Height="300" Width="300">
    <Window.Resources>
        <DataTemplate x:Key="UserControlCell">
            <Rectangle Fill="Red" HorizontalAlignment="Stretch" MinWidth="10" MinHeight="10" />              
        </DataTemplate>
    </Window.Resources>
    <Grid>        
        <ListView Name="MyListView">
            <ListView.View>
                <GridView>
                    <GridViewColumn Width="30" Header="Col1" DisplayMemberBinding="{Binding Name}"  />
                    <GridViewColumn Width="200" Header="Col2" CellTemplate="{StaticResource UserControlCell}"  />
                </GridView>
            </ListView.View>
        </ListView>
    </Grid> 
```

**编辑**对不起我改变了问题，因为我已经消除了用户控件作为问题的根源。任何控制都会发生这种情况。

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2009-01-29T21:14:02.117

在缩小我的问题范围后，我打算谷歌并在[这里找到答案](http://www.interact-sw.co.uk/iangblog/2007/05/30/fill-wpf-listview-columns)。

基本上由于某种原因，ListViewItems 设置为左​​对齐。将它们设置为 Stretch 可解决此问题。这是通过如下样式完成的：

```
<Style TargetType="ListViewItem">
    <Setter Property="HorizontalContentAlignment" Value="Stretch" />
</Style> 
```

不幸的是，这会影响每一列，但是您可以按照链接中的说明将其他列的内容设置为左、右、中心。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-12-13T00:59:27.847

另一个几乎解决方案是在进入 gridviewcolumn 的数据模板中执行以下操作

```
Width="{Binding  RelativeSource={RelativeSource Mode=FindAncestor , AncestorType=ListViewItem, AncestorLevel=1},Path=ActualWidth}"> 
```

这导致它将文本框拉伸到列的宽度，但右边缘被剪裁而不呈现。我还没有修复那部分。所以已经接受的答案可能仍然是最好的答案。

这是执行此操作的示例 DataTemplate。

```
<DataTemplate DataType="{x:Type local:EditableStringElement}"
          x:Key="cellSalutation">
<TextBox Text="{Binding _RecipientData._Salutation.Value , Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
         IsEnabled="{Binding _RecipientData._Salutation.IsEnabled}"
         Width="{Binding  RelativeSource={RelativeSource Mode=FindAncestor , AncestorType=ListViewItem, AncestorLevel=1},Path=ActualWidth}">
</TextBox> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-29T20:57:23.337

您的用户控件指定“高度”和“宽度”属性的值。不允许覆盖您明确设置的属性。删除“高度”和“宽度”，控件的容器将能够弄乱大小。

您可能需要设置一个合理的“MinHeight”和“MinWidth”，以防止容器挤压您。

不同的容器对控件的大小做不同的事情；例如，Grid 扩展您以填充您所在的网格单元格，而 StackPanel 将您缩小到最小尺寸。所以你可能也需要处理这个问题。

# c# - 如何更改文件权限以阻止 Vista 写入 VirtualStore 目录中的文件？

> ID：493351
> 
> 赞同：1
> 
> 时间：2009-01-29T20:48:38.127
> 
> 标签：c#, windows-vista, file-permissions, virtualstore

当我的程序第一次安装时，它会在用户的 AppData 目录中放置一个文件，然后程序将定期写入该文件。问题是在 Vista 中，不会写入用户 AppData 目录中的文件，而是写入“VirtualStore/ProgramData”目录中该文件的副本。用户 AppData 目录中的原始文件永远不会更改，似乎在程序运行时它只能访问 VirtualStore 目录中的文件。

有没有办法从 C# 应用程序内部更改该文件的权限，以便我的程序将写入 AppData 目录中的原始文件，而不是 VirtualStore 目录中的文件？

谢谢，

杰夫

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-03T23:36:16.523

# c# - DbC（按合同设计）和单元测试

> ID：493365
> 
> 赞同：4
> 
> 时间：2009-01-29T20:52:40.460
> 
> 标签：c#, .net, unit-testing, design-by-contract

我正在使用 C# 4.0 的合同，并且在我使用大量单元测试之前（不使用 TDD）。我想知道 DbC 是否消除了编写外部单元测试的需要？

就我个人而言，我发现合约更适合构建健壮的框架，因为合约与代码本身紧密耦合，并提供其他好处。

你们有什么感想？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-10T16:50:56.710

也可以看看：

[合同设计与测试驱动开发？](https://stackoverflow.com/questions/481312/design-by-contract-vs-test-driven-development)

[合同设计和测试驱动开发](https://stackoverflow.com/questions/394591/design-by-contract-and-test-driven-development)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-29T21:01:08.820

我认为这是“轮回”的另一种方式 - 单元测试比通过合同结构进行编程更可取。

我这么说是因为 PoC 检查通常表示为可以在生产中随意关闭的断言。（即使是 Eiffel，Bertrand Meyers 的内置支持 PoC 的语言，也建议在生产环境中关闭它们。）

我宁愿有一套完整的单元测试来测试“快乐路径”、异常和边缘条件。当以 PoC 不具备的方式进行重构时，它们很有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-29T22:00:02.850

我认为 DbC 可以帮助您验证**单元**测试通常可以做什么。

使用 DbC 对方法的输入/输出验证等工作非常有效，并且可以节省您的时间。
但**对于更复杂的验证**（如依赖模拟）**，使用外部单元测试会更简单**。

所以我不认为你可以通过使用它们来消除所有外部单元测试的需求。

# python - Python：对于每个列表元素，在列表中应用一个函数

> ID：493367
> 
> 赞同：25
> 
> 时间：2009-01-29T20:53:15.293
> 
> 标签：python, algorithm, list, list-comprehension

鉴于`[1,2,3,4,5]`，我该怎么做

```
1/1, 1/2, 1/3,1/4,1/5, ...., 3/1,3/2,3/3,3/4,3/5,.... 5/1,5/2,5/3,5/4,5/5 
```

我想存储所有结果，找到最小值，然后返回用于查找最小值的两个数字。因此，在我上面描述的情况下，我想返回`(1,5)`.

所以基本上我想做类似的事情

对于列表中的每个元素`i`，映射列表中所有元素的某个函数，以`i`和`j`作为参数将结果存储在主列表中，在主列表中找到最小值，并返回用于计算该最小值的`i`参数`j`。

在我真正的问题中，我有一个对象/坐标列表，我使用的函数需要两个坐标并计算欧几里得距离。我试图找到任意两点之间的最小欧几里德距离，但我不需要花哨的算法。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-01-29T21:07:47.700

您可以使用[列表推导](http://docs.python.org/tutorial/datastructures.html#list-comprehensions)和[min()](http://docs.python.org/library/functions.html)（Python 3.0 代码）来做到这一点：

```
>>> nums = [1,2,3,4,5]
>>> [(x,y) for x in nums for y in nums]
[(1, 1), (1, 2), (1, 3), (1, 4), (1, 5), (2, 1), (2, 2), (2, 3), (2, 4), (2, 5), (3, 1), (3, 2), (3, 3), (3, 4), (3, 5), (4, 1), (4, 2), (4, 3), (4, 4), (4, 5), (5, 1), (5, 2), (5, 3), (5, 4), (5, 5)]
>>> min(_, key=lambda pair: pair[0]/pair[1])
(1, 5) 
```

请注意，要在 Python 2.5 上运行它，您需要将其中一个参数设为浮点数，或者`from __future__ import division`使 1/5 正确地等于 0.2 而不是 0。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-29T21:17:20.440

如果我认为您想为列表中所有可能的 2 个元素对找到函数的最小值是正确的...

```
l = [1,2,3,4,5]

def f(i,j):
   return i+j 

# Prints min value of f(i,j) along with i and j
print min( (f(i,j),i,j) for i in l for j in l) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-29T21:08:51.550

一些可读的python：

```
def JoeCalimar(l):
    masterList = []
    for i in l:
        for j in l:
            masterList.append(1.*i/j)
    pos = masterList.index(min(masterList))
    a = pos/len(masterList)
    b = pos%len(masterList)
    return (l[a],l[b]) 
```

如果有不清楚的地方，请告诉我。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-30T01:59:58.000

如果您不介意导入 numpy 包，它内置了许多方便的功能。使用它们的数据结构可能比使用列表等更有效。

```
from __future__ import division

import numpy

data = numpy.asarray([1,2,3,4,5])
dists = data.reshape((1,5)) / data.reshape((5,1))

print dists

which = dists.argmin()
(r,c) = (which // 5, which % 5) # assumes C ordering

# pick whichever is most appropriate for you...
minval = dists[r,c]
minval = dists.min()
minval = dists.ravel()[which] 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-29T23:07:14.743

用数学的方式做...

```
nums = [1, 2, 3, 4, 5]
min_combo = (min(nums), max(nums)) 
```

当然，除非你有底片。在这种情况下，这将不起作用，因为您实际上想要最小和最大绝对值 - 分子应该接近于零，而分母应该远离它，在任一方向上。双重否定会打破它。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-30T18:14:40.123

如果使用 Python ≥2.6（包括 3.x），您可以：

```
from __future__ import division
import operator, itertools

def getmin(alist):
    return min(
        (operator.div(*pair), pair)
        for pair in itertools.product(alist, repeat=2)
    )[1]

getmin([1, 2, 3, 4, 5]) 
```

编辑：现在我想到了，如果我正确地记住了我的数学，假设所有数字都是非负的，这也应该给出答案：

```
def getmin(alist):
    return min(alist), max(alist) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-11-23T16:50:45.077

```
>>> nums = [1, 2, 3, 4, 5]    
>>> min(map((lambda t: ((float(t[0])/t[1]), t)), ((x, y) for x in nums for y in nums)))[1]
(1, 5) 
```

# asp.net-mvc - 找不到视图“随便”或其主人

> ID：493369
> 
> 赞同：1
> 
> 时间：2009-01-29T20:54:17.103
> 
> 标签：asp.net-mvc

突然间，在这个 MVC 站点中，我找不到可以找到的视图。

```
The view 'LoginUltraMind' or its master could not be found. The following locations were searched:
~/Views/MyAccount/LoginUltraMind.aspx
~/Views/MyAccount/LoginUltraMind.ascx
~/Views/Shared/LoginUltraMind.aspx
~/Views/Shared/LoginUltraMind.ascx
~/Views/MyAccount/storeNoNav.master
~/Views/Shared/storeNoNav.master 
```

这些文件肯定存在于这些位置——我正看着它们！我昨天更新到 RC 1 并在此之后以 0 个问题正常运行该站点。今天我回到它，这发生了..grr .....

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-30T15:20:34.793

最后，我的 web.config 中有 2 个页面部分，位于 views 目录中。我想当我升级时我没有注意并且没有看到上一节。我完全是白痴，但我确实希望抛出的错误会告诉我，而不是它找不到的文件列表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-29T21:09:50.533

使用 fiddler 来准确查看请求的内容。这可能是解决您的 Web 应用程序基地址的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-23T13:29:22.017

就我而言，我遇到了这个问题并确定它是因为我试图访问页面声明部分的“模型”对象（直接在*页面加载*事件`<script runat="server">`之外的部分上）。在这种情况下，表明该页面不存在的错误是完全误导的......希望这对其他人有帮助。

 ** * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-14T15:09:38.440

我以前也遇到过这个问题。今天它再次发生，但认为它是由其他方法调用的，我知道它有效。我跟踪了代码，发现我的按钮中有错误的路径。但是我仍然不知道为什么按钮仍然会在正确的文件夹中点击我的方法。这是两个按钮的代码。注意参考路径。视图区域引擎在错误的文件夹中查找。（正确的路径是最上面的，Admin.mvc是错误的）"
id="EditClientManager" title="Client Manager Editor">编辑
href="/Admin.mvc/AccessControl/ClientManagersDelete/<%=Convert.ToString(manager.Id)%>" id="DeleteApprover" title="Client Manager Editor">删除

# command-line - BCB5 命令行链接器 (ilink32) 找不到 consts.obj？

> ID：493372
> 
> 赞同：1
> 
> 时间：2009-01-29T20:55:06.757
> 
> 标签：command-line, linker, c++builder

使用 BCB5 命令行工具编译 makefile 时，链接器给了我这个错误：

```
 [exec]  D:\PROGRA~1\Borland\CBUILD~1\Bin\..\BIN\ilink32 @MAKE0000.@@@
 [exec] Turbo Incremental Link 5.00 Copyright (c) 1997, 2000 Borland
 [exec] Fatal: Unable to open file 'CONSTS.OBJ'
 [exec] ** error 2 ** deleting lib\paslib.lib 
```

我检查了所有编译的文件，没有一个使用或制作这个文件。make 文件没有提到它。Borland 程序文件中没有它。据搜索可以告诉我，它甚至不在我的机器上。当然，可以预见的是，在 IDE 中编译时没有问题。这个链接器在做什么？

使用 make 标志 -B 和 -fproject.bpr 调用项目

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-08T22:34:51.457

我怀疑源代码中包含的其中一个标头中有这样一行：

```
#pragma link "consts" 
```

预处理 .cpp 文件，您应该能够找到它的来源。

还有其他可能性，但我认为这是最有可能的一种。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-29T21:17:05.933

C:\Program Files\Borland\CBuilder5\Lib\Obj 文件夹中有 consts.dcu 吗？

我不确切知道你的错误是什么，但也许它与这个文件有关，这显然是一个预编译的 delphi 单元。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-08T11:34:41.017

我以前没有遇到过这个特定的错误——但如果怀疑来自 BCB 的奇怪错误，我的第一个调用端口总是检查文件的行尾。它真的非常想要 CRLF 行结尾。有些东西似乎只适用于 LF 文件，直到文件中间出现一些奇怪的、看似不可能的错误。

也许这不是你的问题，但它当然值得一看。

您可以尝试的另一件事是从 SysInternals安装[Process Monitor 。](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)这将使您了解它正在寻找哪个文件以及它在哪里寻找它。可能是它正在寻找 consts.dcu （Delphi 编译单元 - 几乎是目标代码）并且由于某处设置错误的路径而在错误的地方寻找。

# c# - 为什么 WCF 返回 myObject[] 而不是 List 就像我期待的那样？

> ID：493376
> 
> 赞同：63
> 
> 时间：2009-01-29T20:56:03.247
> 
> 标签：c#, wcf, collections

我正在从我的 WCF 方法返回一个列表。在我的客户端代码中，它的返回类型显示为 MyObject[]。我必须使用 MyObject[]、IList 或 IEnumerable...

```
WCFClient myClient = new WCFClient();

    MyObject[] list = myClient.GetMyStuff();
or
    IList<MyObject> list = myClient.GetMyStuff();
or
    IEnumerable<MyObject> list = myClient.GetMyStuff(); 
```

我所做的就是获取这个集合并将其绑定到一个网格。分配我返回的集合的最佳对象是什么？

* * *

## 回答 #1

> 赞同：83
> 
> 时间：2009-01-29T21:03:55.087

您可以通过在添加引用时单击高级按钮来指定要使用通用列表而不是数组，或者您可以右键单击服务引用并选择配置以将其更改到位。

原因是 WCF 将通用列表序列化为数组以通过网络发送。该配置只是告诉 svcutil 创建一个代理，将它们转换回通用列表以方便您使用。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-01-29T21:00:14.157

当您用于`svcutil.exe`创建客户端代码时，您需要告诉它如何解决某些对其不可用的引用。

这就是你要这样做的方式`List<T>`：

```
svcutil /o:YourService.cs /ct:System.Collections.Generic.List`1 http://example.com/mex 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-01-29T21:16:15.623

史蒂夫 B 是正确的。WCF 非常努力地不与 .NET 耦合。您可能希望允许 Java 客户端连接到您的组件。数组是可互操作的。通用 .NET 列表不是。

但是，非常欢迎您创建自己的代理类，它将数组转换回 List 或您想要的任何其他内容。手动创建自己的代理的好处是您可以完全控制它们的工作。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-29T20:59:15.267

当您将服务引用添加到客户端项目时，单击高级按钮并将集合类型从数组更改为您想要的...

# .net - Visual Web Developer 和同一 FTP 服务器上的多个站点

> ID：493383
> 
> 赞同：1
> 
> 时间：2009-01-29T20:57:29.157
> 
> 标签：.net, visual-studio, ftp, visual-web-developer

我用Visual Web Developer直接通过FTP打开了Website_A，非常棒。它让我可以在我的计算机上编辑文件，然后将它们保存到服务器上，这样我就可以立即看到我的更改所产生的效果。这就像我过去在非 .Net 站点上使用 UltraEdit 所做的一样，但具有 Intellisense、解决方案资源管理器等的额外好处。

无论如何，效果很好，但是当我完成后，我以同样的方式打开了 Website_B。但是两个站点都在同一个 FTP 服务器上。尽管使用了不同的用户名和密码，但当我尝试打开 Website_B 时，我仍然会得到 Website_A 的文件。

有没有人在打开两个使用相同 FTP 服务器的不同站点时遇到这个问题？有办法解决吗？我尝试重命名在 C:\Users\George\Documents\Visual Studio 2008\Projects 中创建的项目文件夹/文件，但这似乎没有帮助。唯一可行的方法是删除项目文件夹并重新开始。有什么想法可以更好地使用一个 FTP 服务器来处理多个站点？我在网上找不到任何东西……</p>

谢谢，

乔治·J。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-29T21:20:32.527

如果您通过 DNS（而不是 IP 地址）访问 FTP 服务器，您可能可以使用指向同一 FTP 服务器的子域。

如果 DNS 记录设置为允许无限子域，那么您可以连接到网站 A 和网站 B。

Visual Web Developer 应该假设 FTP 服务器上的，看起来是，不同的服务器将属于不同的网站，但实际上只有文件夹不同。

我没有可视化 Web 开发人员，因此无法对此进行测试，但 FireFox 无法判断[ftp://1.example.com与](ftp://1.example.com)[ftp://2.example.com](ftp://2.example.com)相同

# python - 如何在没有换行符或空格的情况下打印

> ID：493386
> 
> 赞同：2229
> 
> 时间：2009-01-29T20:58:25.520
> 
> 标签：python

我想用 Python 来做。我想在 C 中的这个例子中做什么：

```
#include <stdio.h>

int main() {
    int i;
    for (i=0; i<10; i++) printf(".");
    return 0;
} 
```

输出：

```
.......... 
```

在 Python 中：

```
>>> for i in range(10): print('.')
.
.
.
.
.
.
.
.
.
.
>>> print('.', '.', '.', '.', '.', '.', '.', '.', '.', '.')
. . . . . . . . . . 
```

在 Python 中，`print`会添加一个`\n`或空格。我怎样才能避免这种情况？我想知道如何将字符串“附加”到`stdout`.

* * *

## 回答 #1

> 赞同：3033
> 
> 时间：2009-01-29T21:01:43.513

在 Python 3 中，您可以使用函数的`sep=`和`end=`参数[`print`](https://docs.python.org/library/functions.html#print)：

不在字符串末尾添加换行符：

```
print('.', end='') 
```

要不在要打印的所有函数参数之间添加空格：

```
print('a', 'b', 'c', sep='') 
```

您可以将任何字符串传递给任一参数，并且可以同时使用这两个参数。

如果您在缓冲时遇到问题，可以通过添加`flush=True`关键字参数来刷新输出：

```
print('.', end='', flush=True) 
```

## Python 2.6 和 2.7

在 Python 2.6 中，您可以使用[模块](https://docs.python.org/2/library/__future__.html)`print`从 Python 3 导入函数：[`__future__`](https://docs.python.org/2/library/__future__.html)

```
from __future__ import print_function 
```

它允许您使用上面的 Python 3 解决方案。

但是，请注意，该关键字在 Python 2 中导入`flush`的函数版本中不可用；它仅适用于 Python 3，更具体地说是 3.3 及更高版本。在早期版本中，您仍然需要调用. 您还必须在执行此导入的文件中重写所有其他打印语句。`print``__future__``sys.stdout.flush()`

或者你可以使用[`sys.stdout.write()`](https://docs.python.org/library/sys.html#sys.stdout)

```
import sys
sys.stdout.write('.') 
```

您可能还需要致电

```
sys.stdout.flush() 
```

以确保`stdout`立即冲洗。

* * *

## 回答 #2

> 赞同：302
> 
> 时间：2012-07-27T10:09:57.593

对于 Python 2 及更早版本，它应该像*[Re: How do one print without a CR 中描述的那样简单？](http://legacy.python.org/search/hypermail/python-1992/0115.html)*通过[Guido van Rossum](https://en.wikipedia.org/wiki/Guido_van_Rossum)（释义）：

> 是否可以打印一些东西，但不能自动附加回车符？

是的，在要打印的最后一个参数之后附加一个逗号。例如，此循环在由空格分隔的行上打印数字 0..9。请注意添加最终换行符的无参数“打印”：

```
>>> for i in range(10):
...     print i,
... else:
...     print
...
0 1 2 3 4 5 6 7 8 9
>>> 
```

* * *

## 回答 #3

> 赞同：179
> 
> 时间：2009-01-29T21:24:58.413

*注意：这个问题的标题曾经类似于“如何在 Python 中 printf”*

由于人们可能会根据标题来这里寻找它，因此 Python 还支持 printf 样式的替换：

```
>>> strings = [ "one", "two", "three" ]
>>>
>>> for i in xrange(3):
...     print "Item %d: %s" % (i, strings[i])
...
Item 0: one
Item 1: two
Item 2: three 
```

而且，您可以轻松地将字符串值相乘：

```
>>> print "." * 10
.......... 
```

* * *

## 回答 #4

> 赞同：98
> 
> 时间：2011-02-21T20:50:30.810

对 Python 2.6+ 使用 Python 3 风格的打印函数*（它还会破坏同一文件中任何现有的关键字打印语句）*。

```
# For Python 2 to use the print() function, removing the print keyword
from __future__ import print_function
for x in xrange(10):
    print('.', end='') 
```

为了不破坏所有 Python 2 打印关键字，请创建一个单独的`printf.py`文件：

```
# printf.py

from __future__ import print_function

def printf(str, *args):
    print(str % args, end='') 
```

然后，在您的文件中使用它：

```
from printf import printf
for x in xrange(10):
    printf('.')
print 'done'
#..........done 
```

显示 printf 样式的更多示例：

```
printf('hello %s', 'world')
printf('%i %f', 10, 3.14)
#hello world10 3.140000 
```

* * *

## 回答 #5

> 赞同：46
> 
> 时间：2010-12-03T17:16:00.437

如何在同一行打印：

```
import sys
for i in xrange(0,10):
   sys.stdout.write(".")
   sys.stdout.flush() 
```

* * *

## 回答 #6

> 赞同：35
> 
> 时间：2009-01-29T21:07:36.093

Python 3.x 中的`print`函数有一个可选`end`参数，可让您修改结束字符：

```
print("HELLO", end="")
print("HELLO") 
```

输出：

> 你好你好

还有`sep`用于分隔符：

```
print("HELLO", "HELLO", "HELLO", sep="") 
```

输出：

> 你好你好你好

如果您想在 Python 2.x 中使用它，只需在文件**开头**添加：

```
from __future__ import print_function 
```

* * *

## 回答 #7

> 赞同：24
> 
> 时间：2015-06-17T01:55:02.730

使用*functools.partial*创建一个名为*printf*的新函数：

```
>>> import functools

>>> printf = functools.partial(print, end="")

>>> printf("Hello world\n")
Hello world 
```

这是用默认参数包装函数的简单方法。

* * *

## 回答 #8

> 赞同：20
> 
> 时间：2016-07-09T21:22:30.237

在 Python 3+ 中，[`print`](https://docs.python.org/library/functions.html#print)是一个函数。你打电话时

```
print('Hello, World!') 
```

Python 将其翻译为

```
print('Hello, World!', end='\n') 
```

你可以改变`end`任何你想要的。

```
print('Hello, World!', end='')
print('Hello, World!', end=' ') 
```

* * *

## 回答 #9

> 赞同：14
> 
> 时间：2014-07-10T19:45:40.157

在 Python 2.x 中，您可以`,`在函数末尾添加`print`，因此它不会打印在新行上。

* * *

## 回答 #10

> 赞同：10
> 
> 时间：2015-07-22T17:09:59.573

蟒蛇**3**：

```
print('.', end='') 
```

Python **2.6+**：

```
from __future__ import print_function # needs to be first statement in file
print('.', end='') 
```

Python **<=2.5**：

```
import sys
sys.stdout.write('.') 
```

如果每次打印后有额外的空间是可以的，在 Python 2 中：

```
print '.', 
```

**Python 2 中的**误导-****避免**：**

 **```
print('.'), # Avoid this if you want to remain sane
# This makes it look like print is a function, but it is not.
# This is the `,` creating a tuple and the parentheses enclose an expression.
# To see the problem, try:
print('.', 'x'), # This will print `('.', 'x') ` 
```

* * *

## 回答 #11

> 赞同：10
> 
> 时间：2018-08-20T13:35:42.207

一般来说，有两种方法可以做到这一点：

**在 Python 3.x 中不带换行符打印**

在 print 语句之后不添加任何内容，并使用 '\n' 删除`end=''`，如：

```
>>> print('hello')
hello  # Appending '\n' automatically
>>> print('world')
world # With previous '\n' world comes down

# The solution is:
>>> print('hello', end='');print(' world'); # End with anything like end='-' or end=" ", but not '\n'
hello world # It seems to be the correct output 
```

**循环中的另一个示例**：

```
for i in range(1,10):
    print(i, end='.') 
```

**在 Python 2.x 中不带换行符打印**

添加一个尾随逗号表示：打印后，忽略`\n`.

```
>>> print "hello",; print" world"
hello world 
```

**循环中的另一个示例**：

```
for i in range(1,10):
    print "{} .".format(i), 
```

您可以访问此[链接](https://www.geeksforgeeks.org/print-without-newline-python/)。

* * *

## 回答 #12

> 赞同：9
> 
> 时间：2015-11-23T12:03:31.567

你可以试试：

```
import sys
import time
# Keeps the initial message in buffer.
sys.stdout.write("\rfoobar bar black sheep")
sys.stdout.flush()
# Wait 2 seconds
time.sleep(2)
# Replace the message with a new one.
sys.stdout.write("\r"+'hahahahaaa             ')
sys.stdout.flush()
# Finalize the new message by printing a return carriage.
sys.stdout.write('\n') 
```

* * *

## 回答 #13

> 赞同：7
> 
> 时间：2012-06-18T03:39:20.807

我最近遇到了同样的问题...

我通过这样做解决了它：

```
import sys, os

# Reopen standard output with "newline=None".
# in this mode,
# Input:  accepts any newline character, outputs as '\n'
# Output: '\n' converts to os.linesep

sys.stdout = os.fdopen(sys.stdout.fileno(), "w", newline=None)

for i in range(1,10):
    print(i) 
```

这适用于 Unix 和 Windows，但我没有在 Mac OS X 上测试过。

* * *

## 回答 #14

> 赞同：6
> 
> 时间：2013-07-05T17:37:06.990

您可以在 Python 3 中执行相同的操作，如下所示：

```
#!usr/bin/python

i = 0
while i<10 :
    print('.', end='')
    i = i+1 
```

`python filename.py`并用or执行它`python3 filename.py`。

* * *

## 回答 #15

> 赞同：5
> 
> 时间：2015-02-28T04:35:09.490

[lenooh 满足](https://stackoverflow.com/questions/493386/how-to-print-without-a-newline-or-space/4348063#4348063)了我的查询。我在搜索“python suppress newline”时发现了这篇文章。我在 Raspberry Pi 上使用[IDLE 3](https://en.wikipedia.org/wiki/IDLE)为[PuTTY](https://en.wikipedia.org/wiki/PuTTY)开发 Python 3.2 。

我想在 PuTTY 命令行上创建一个进度条。我不希望页面滚动。我想要一条水平线来让用户放心，让用户不会因为程序没有停止运行，也没有在快乐的无限循环中被送去吃午饭而感到害怕——作为请求‘别管我，我做得很好，但是这个可能需要一些时间。交互式消息 - 就像文本中的进度条。

通过`print('Skimming for', search_string, '\b! .001', end='')`准备下一个屏幕写入来初始化消息，它将打印三个退格键作为⌫⌫⌫ rubout，然后是一个句点，擦除“001”并延长句点行。

在`search_string`鹦鹉用户输入之后，`\b!`修剪我的文本的感叹号`search_string`以回到`print()`否则强制的空间，正确放置标点符号。接下来是一个空格和我正在模拟的“进度条”的第一个“点”。

不必要地，该消息还带有页码（格式为长度为 3 的前导零），以通知用户正在处理进度，这也将反映我们稍后将构建到的周期数对。

```
import sys

page=1
search_string=input('Search for?',)
print('Skimming for', search_string, '\b! .001', end='')
sys.stdout.flush() # the print function with an end='' won't print unless forced
while page:
    # some stuff…
    # search, scrub, and build bulk output list[], count items,
    # set done flag True
    page=page+1 #done flag set in 'some_stuff'
    sys.stdout.write('\b\b\b.'+format(page, '03')) #<-- here's the progress bar meat
    sys.stdout.flush()
    if done: #( flag alternative to break, exit or quit)
        print('\nSorting', item_count, 'items')
        page=0 # exits the 'while page' loop
list.sort()
for item_count in range(0, items)
    print(list[item_count])

#print footers here
if not (len(list)==items):
    print('#error_handler') 
```

进度条肉`sys.stdout.write('\b\b\b.'+format(page, '03'))`在行。首先，要向左擦除，它将光标移到三个数字字符上，其中 '\b\b\b' 作为 ⌫⌫⌫ rubout 并删除一个新句点以添加到进度条长度。然后它会写出到目前为止它已经前进到的页面的三位数字。因为`sys.stdout.write()`等待一个完整的缓冲区或输出通道关闭，所以`sys.stdout.flush()`强制立即写入。`sys.stdout.flush()`内置在`print()`其中的末尾被绕过`print(txt, end='' )`。然后代码循环执行其平凡的时间密集型操作，同时它不再打印任何内容，直到它返回此处擦除三个数字，添加一个句点并再次写入三个数字，递增。

擦除和重写的三个数字绝不是必要的 - 它只是一个例证`sys.stdout.write()`vs的繁荣`print()`。您可以很容易地用句号作为底数，而忘记三个花哨的反斜杠-b ⌫ 退格（当然也不能写格式化的页数），只需每次打印句号栏长一长 - 没有空格或换行符，只使用`sys.stdout.write('.'); sys.stdout.flush()`一对。

请注意，Raspberry Pi IDLE 3 Python shell 不将退格视为 ⌫ rubout，而是打印一个空格，从而创建一个明显的分数列表。

* * *

## 回答 #16

> 赞同：5
> 
> 时间：2015-07-23T14:18:14.037

你想在*for*循环中打印一些东西；但是您不希望它每次都在新行中打印...

例如：

```
 for i in range (0,5):
   print "hi"

 OUTPUT:
    hi
    hi
    hi
    hi
    hi 
```

* * *

但是您希望它像这样打印： hi hi hi hi hi hi 对吗？？？？

只需在打印“hi”后添加一个逗号。

例子：

```
for i in range (0,5):
    print "hi", 
```

输出：

```
hi hi hi hi hi 
```

* * *

## 回答 #17

> 赞同：5
> 
> 时间：2015-11-24T18:46:28.443

其中许多答案似乎有点复杂。在 Python 3.x 中，您只需执行以下操作：

```
print(<expr>, <expr>, ..., <expr>, end=" ") 
```

end 的默认值为`"\n"`. 我们只是将其更改为空格，或者您也可以使用`end=""`（无空格）来执行`printf`通常的操作。

* * *

## 回答 #18

> 赞同：5
> 
> 时间：2017-03-09T05:54:20.460

您会注意到以上所有答案都是正确的。但我想创建一个捷径，总是在最后写入“end=''”参数。

您可以定义一个函数，例如

```
def Print(*args, sep='', end='', file=None, flush=False):
    print(*args, sep=sep, end=end, file=file, flush=flush) 
```

它将接受所有数量的参数。即使它会接受所有其他参数，如文件、刷新等，并且具有相同的名称。

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2020-07-03T08:01:08.757

```
 for i in range(0, 5): #setting the value of (i) in the range 0 to 5 
     print(i) 
```

上面的代码给出了以下输出：

```
 0    
 1
 2
 3
 4 
```

但是如果你想以直线打印所有这些输出，那么你应该做的就是添加一个名为 end() 的属性来打印。

```
 for i in range(0, 5): #setting the value of (i) in the range 0 to 5 
     print(i, end=" ") 
```

输出：

```
 0 1 2 3 4 
```

不仅是空格，您还可以为输出添加其他结尾。例如，

```
 for i in range(0, 5): #setting the value of (i) in the range 0 to 5 
     print(i, end=", ") 
```

输出：

```
 0, 1, 2, 3, 4, 
```

记住：

```
 Note: The [for variable in range(int_1, int_2):] always prints till the variable is 1

 less than it's limit. (1 less than int_2) 
```

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2018-10-17T01:41:06.360

或具有如下功能：

```
def Print(s):
    return sys.stdout.write(str(s)) 
```

那么现在：

```
for i in range(10): # Or `xrange` for the Python 2 version
    Print(i) 
```

输出：

```
0123456789 
```

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2022-01-10T06:11:15.710

只需使用`end`="" 或`sep`=""

```
>>> for i in range(10):
        print('.', end = "") 
```

输出：

```
......... 
```

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2014-10-18T20:13:54.307

```
for i in xrange(0,10): print '\b.', 
```

这适用于 2.7.8 和 2.5.2（[分别是 Enthought Canopy](https://en.wikipedia.org/wiki/Enthought)和 OS X 终端）——不需要模块导入或时间旅行。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2021-12-13T13:33:07.320

蟒蛇3：

```
print('Hello',end='') 
```

例子 ：

```
print('Hello',end=' ')
print('world') 
```

输出： `Hello world`

此方法在提供的文本之间添加分隔符：

```
print('Hello','world',sep=',') 
```

输出：`Hello,world`

* * *

## 回答 #24

> 赞同：-4
> 
> 时间：2017-05-17T04:01:29.090

您不需要导入任何库。只需使用删除字符：

```
BS = u'\0008' # The Unicode point for the "delete" character
for i in range(10):print(BS + "."), 
```

这将删除换行符和空格 (^_^)*。

# .net - .net 垃圾收集和托管资源

> ID：493388
> 
> 赞同：4
> 
> 时间：2009-01-29T20:58:42.867
> 
> 标签：.net, memory-management, memory-leaks, garbage-collection, performance

原始数据类型（int、char 等）的内存是在它们离开作用域后立即释放，还是添加到垃圾收集以供以后释放？

考虑：

```
For x as integer=0 to 1000
dim y as integer
Next 
```

如果这不向垃圾收集器添加 1000 个整数以便稍后清理，它如何处理字符串对象？这会创建 1000 个字符串以便稍后清理吗？

```
For x as integer=0 to 1000
dim y as string=""
Next 
```

只包含 int、string 等数据类型的结构怎么样？

只包含托管资源的类？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-29T21:07:05.220

好吧，只有两个答案已经有错误信息了......

*   字符串不是原始类型
*   字符串不是值类型
*   值类型值*并不*总是在堆栈上创建 - 它取决于变量的位置。如果它是类的一部分，则它与该对象的其余数据一起存储在堆中。
*   如果局部变量被捕获（例如在匿名函数和迭代器块中），即使*局部*变量也可能最终出现在堆上
*   诸如 "" 之类的字符串文字是*实习*的——它们总是解析为相同的字符串。该循环实际上并没有创建任何字符串。

有关更多信息，请参阅我关于[.NET 内存中的内容的](http://www.yoda.arachsys.com/csharp/memory.html)文章。您可能还想考虑[它是否重要](http://csharpindepth.com/ViewNote.aspx?NoteID=41)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-29T21:01:45.823

原始数据类型（字符串除外）是值类型，是在堆栈而不是堆上创建的。当它们超出范围时，它们会从堆栈中弹出；它们不是垃圾收集的。

字符串是引用类型，在堆上分配，并被垃圾回收。[.NET 使用String Interning](http://en.wikipedia.org/wiki/String_intern_pool)围绕字符串的内存管理执行一些优化。（即你可能在内存中只有一个字符串 "" 的实例。.NET 可以这样做，因为字符串是不可变的）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-29T21:06:20.167

[已经给出了两个答案，除了这篇文章](http://msdn.microsoft.com/en-us/magazine/bb985010.aspx)之外我没有什么可以补充的，这篇文章很好地描述了垃圾收集在 .Net 中的工作原理。

# sql-server - 还原数据库时出现 Microsoft SQL Server 2008 错误

> ID：493393
> 
> 赞同：3
> 
> 时间：2009-01-29T21:00:13.470
> 
> 标签：sql-server, sql-server-2008

我刚刚从 2005 年升级到 SQL Server 2008，当我尝试恢复数据库时，出现以下错误...

“无法加载文件或程序集 'Microsoft.SqlServer.Sqm，版本 = 10.0.0.0，文化 = 中性，PublicKeyToken = 89845dcd8080cc91”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-16T21:53:20.060

在尝试创建新数据库后，我在全新安装 Sql Server 2008 Express Edition 后遇到了同样的错误。

这些是我遵循的步骤，它使用 Windows 7 64 位对我有用：

1.  复制位于 C:\Program Files\Microsoft SQL Server\100\Shared 上的文件 Microsoft.SqlServer.Sqm.dll
2.  到文件夹 C:\Program Files\Microsoft SQL Server\100\Tools\Binn\VSShell\Common7\IDE
3.  和 C:\Program Files (x86)\Microsoft SQL Server\100\Tools\Binn\VSShell\Common7\IDE。

然后下次我尝试添加数据库时，一切都很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-29T22:05:13.590

我不确定确切的问题是什么，但我采用了完全卸载 SQL Server 然后重新安装的解决方案。这些是我遵循的步骤...

1.  我卸载了在添加/删除程序中可以找到的所有与 SQL Server 相关的内容。
2.  为程序/Windows组件和注册表运行“CCLeaner”
3.  从我的硬盘驱动器中删除了所有剩余的 SQL Server 文件夹，这些文件夹似乎来自以前的 SQL Server 安装。
4.  重新安装 SQL Server 2008。

瞧，一切正常。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-01T05:14:08.380

这是因为确切的版本 10.0\. *.* 在“ssms.exe”所在的文件夹中找不到。

*解决方案*

通过转到开始菜单并键入 ssms.exe，转到存在“ssms.exe”的确切文件夹。然后右键单击结果并单击“打开文件位置”。

在该位置尝试粘贴确切的 10.0.0。*.* 'Microsoft.SqlServer.Sqm' 的版本。

您可以通过在 Microsoft Sql Server 文件夹中搜索找到确切的版本。

在我的情况下，它要求 12.0.0.0 版本，我粘贴了 12.0.2000.8，它就像一个魅力。！！！干杯。！！！

# .net - .NET - SQL 连接错误 - 在本地开发 Web 应用程序

> ID：493396
> 
> 赞同：1
> 
> 时间：2009-01-29T21:01:10.600
> 
> 标签：.net, sql-server, ado.net, connection-string, sql-server-express

我在 Windows XP 机器上安装了 Visual Studio 2008 和 SQL Server 2008 Developer Edition。

尝试在测试 Web 应用程序上工作时出现此错误：

> 建立与 SQL Server 的连接时发生与网络相关或特定于实例的错误。服务器未找到或无法访问。验证实例名称是否正确以及 SQL Server 是否配置为允许远程连接。（提供者：SQL 网络接口，错误：26 - 错误定位服务器/指定的实例）

我的 ADO.NET 连接字符串是：

> 数据源=.\SQLEXPRESS;AttachDbFilename=|DataDirectory|\TestDB.mdf;Integrated Security=True;User Instance=True

完整安装的 SQL Server 不应该知道如何处理 SQL Express 数据库吗？我是否错过了在“附加”数据库上工作所需的安装？还是我还需要配置一些东西？我认为这在过去对我有用（开箱即用）。

**更新：**
即使我有一个完整的 2008 实例正在运行，我也打算将其用作 Express DB。你不能这样做吗？当您尝试使用其成员资格功能时，默认情况下 ASP.NET 是否不会引导您使用这些“快速”数据库之一？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-29T21:07:57.807

您的 SQL Server Developer 版本不使用“SQLExpress”作为服务器名称/实例 - 尝试使用您的服务器名称或（本地）代替。

此外，您的字符串不适合已连接的数据库。该字符串应如下所示：

```
connectionString="Data Source=(local);Initial Catalog=YourDatabaseName;IntegratedSecurity=True" 
```

更新：ASP.NET 不会引导您使用任何特定的数据库。在所有真正重要的方面，ASP.NET 关心的只是您的连接字符串结果是否完整且准确地描述了访问*某些*SQL Server 实例所需的路径和凭据。您是否考虑过尝试使用更传统的连接字符串，然后一次退出一项（例如，仅在您验证“正常”数据库连接运行正确后才命名数据库文件）？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-29T21:06:08.997

您安装了哪个版本的 SQL Server？该连接字符串适用于快速版本，不适用于其他版本

有关连接字符串，请参见此处 [http://www.connectionstrings.com/](http://www.connectionstrings.com/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-29T21:11:19.690

打开 SQL Server 管理工作室

查看登录时显示的连接信息。

在连接字符串中使用该值。

确保您有 SQL 配置以允许连接。

如果前两个步骤没有帮助，最后要查看的一件事是查看防火墙设置。

# c++ - C++0x 标准如何定义 C++ Auto 多重声明？

> ID：493401
> 
> 赞同：2
> 
> 时间：2009-01-29T21:01:59.257
> 
> 标签：c++, c++11

嗯，我对即将到来的 C++0x 标准中的多个自动声明有点困惑。

```
auto a = 10, b = 3.f , * c = new Class(); 
```

我读过的地方是不允许的。原因是（？），因为不清楚连续声明是否应该与第一个声明（示例中为 int）具有相同的类型。

可能的翻译1：

```
int a = 10; 
int b = 3.f; 
int * c = new Class (); 
```

导致错误

可能的翻译2：

```
int a = 10;
float b = 3.f;
Class * c = new Class (); 
```

它是如何产生标准的？

如果我可以说我的 POV，翻译#2 是最令人讨厌的，至少对我来说，我是一个普通的 C++ 用户。我的意思是，对我来说，“声明的每个变量都具有相同的声明类型”，witch 是自动的。翻译＃1对我来说真的很不直观。

再见 QbProg

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-29T21:34:42.030

它可能不是最新的，但我 2008 年 6 月的 C++0x 标准草案说您可以执行以下操作：

```
auto x = 5; // OK: x has type int
const auto *v = &x, u = 6; // OK: v has type const int*, u has type const int 
```

因此，除非从 6 月开始发生变化，否则（或将）以有限的形式允许使用非常直观的解释。

限制是，如果您确实想像这样（使用上面的示例）对多个自动声明进行字符串化，它会起作用，因为推断的类型`v`和`u`具有相同的“基本类型”（在这种情况下为 int）使用不精确的术语。

如果您想要精确的规则，标准草案是这样说的：

> 如果声明符列表包含多个声明符，则每个声明变量的类型都按上述方式确定。如果每次推导时为模板参数 U 推导的类型都不相同，则程序是非良构的。

其中“推导出的模板参数 U”由下式确定：

> 以下发明的函数模板的调用 f(expr) 中参数 u 的推导类型：
> 
> ```
>  `template <class U> void f(const U& u);` 
> ```

为什么他们提出了这条规则，而不是说这样的话：

```
auto a = 10, b = 3.f , * c = new Class(); 
```

相当于：

```
auto a = 10;
auto b = 3.f;
auto * c = new Class(); 
```

我不知道。但我不写编译器。可能与您确定`auto`关键字替换后有关，您不能在同一语句中更改它。

举个例子：

```
int x = 5;
CFoo * c = new CFoo();

auto  a1 = x,       b1 = c; // why should this be permitted if
int   a2 = x, CFoo* b2 = c; // this is not? 
```

无论如何，无论如何，我都不喜欢在同一个语句上放置多个声明。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-29T21:18:58.410

[标准草案](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2798.pdf)第7.1.6.4 节暗示您不能像可能的翻译 2 那样混合类型。因此，任何可能的翻译都无效。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-30T12:31:16.040

我认为有几点有助于促成当前的措辞。首先是一致性。如果您编写声明，例如：

```
int j;
int i = 0, *k = &j; 
```

然后，这两种类型都在其类型的某处使用*int 。*例如，如果“j”是“const int”，则这是一个错误。*使 auto*工作相同与此类声明的当前模型“一致”。

从编译器编写者的角度来看，这是一个实际的优势。编译器中已经存在为函数调用执行类型推断的机制（这就是*auto*被描述为操作的方式）。上述规则与模板参数的推导必须导致相同类型的规则是一致的：

```
template <typename T> void foo (T, T*);

void bar ()
{
  int i;
  const int j = 0;

  foo (i, &i);  // OK deduction succeeds T == int
  foo (i, &j);  // ERROR deduction fails T == int or const int.
} 
```

*auto*的一个简单实现是重用现有机制来推断*auto*的类型，并且由于与当前行为的一致性，结果不会让人太惊讶。

最后，这可能是我认为最重要的一点。当前模型是保守的，并且与 C++ 中现有的语言结构非常相似。因此，它导致显示停止语言错误的可能性非常小。但是，将来可以轻松扩展当前模型以包含您在问题中列出的其他示例。

更重要的是，该扩展不会破坏使用当前*auto*措辞的代码。考虑一下他们是否反过来这样做。*如果auto*的扩展版本是第一个版本，并且这导致关键字出现一些奇怪和致命的缺陷，那么它将需要从标准中删除语言功能 - 这几乎不会发生，因为它很可能会破坏代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-29T21:03:49.907

第一个将与类型推断在 ?: 运算符的返回类型中的工作方式一致。

# version-control - 您如何管理您的项目生命周期？

> ID：493403
> 
> 赞同：4
> 
> 时间：2009-01-29T21:02:56.010
> 
> 标签：version-control, project-management

您如何管理您的项目生命周期？

例如：您是否从模板开始？您是否使用 SVN 等版本控制作为权威来源？您是否归档项目，如果是，何时以及如何归档？当一个项目重新启动（工作恢复）时，它是如何处理的？您是否使用自动化脚本来执行诸如创建 IIS 站点、数据库、存档、启动等操作？

特别感兴趣的是在不同的开发点管理许多项目。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-31T21:57:40.280

**开发：**我们不是从模板开始的，因为世界变化太快，模板维护是一项全职工作。我们鼓励每个人都使用相同的 IDE (Eclipse)，这样他们就可以在他们的环境中互相帮助。

**项目管理：**我们使用 GForge 来管理我们的项目。Sourceforge 稍好一些，但 GForge 便宜得多，并且有不同的许可费模式。GForge 整合了 CVS、SVN、文档存储、问题跟踪器并很好地集成了一切。这使得很容易看到项目的位置。开放的问题，以及连接代码更改的封闭问题，一切都是集成的。

**版本控制：**虽然我们尝试了 SVN，但我们切换回 CVS，因为它更符合我们的需求并且运行良好。

**备份：**我们的 GForge 服务器，包含我们所有的项目和源代码，运行在 VMWare EX 服务器上。每天在虚拟机级别进行备份，如果我们觉得出于某种原因需要更频繁的还原点，我们会制作虚拟机快照。

**复兴项目：**这在我们的业务中很常见。每个项目在 CVS 中都有它的所有库和构建需求。该项目始终有一个最新的开发手册，其中描述了运行开发环境的所有步骤，并有一章包含所有非默认内容，需要注意。我们尝试在尽可能默认的环境中构建软件，这样开发人员就不必花费数天时间来调整他们的设置。

几乎所有项目都是使用 Maven 构建的，这也使我们的开发人员的生活变得轻松。通常恢复一个项目只需要几个步骤：

*   下载日食
*   通过 SSH 连接到 CVS（extssh 内置在 Eclipse 中）
*   签出项目（默认“签出”选项）
*   运行“Maven Eclipse”并刷新 Eclipse
*   在 Eclipse 中运行单元测试以查看是否一切正常。

**构建：**我们所有的项目都构建在单独的构建服务器上。每天早上，如果所有单元测试都成功，构建服务器会执行完整的构建并标记 CVS。白天，每小时构建一次，当出现故障时，团队会自动收到一封电子邮件。通常我们每个项目使用一个构建服务器，它是一个简单的 luntbuid 服务器（Linux、Tomcat、Luntbuild）。

构建服务器，有时甚至是开发人员机器都是虚拟机。这使得恢复项目非常容易。从文件服务器获取虚拟机，启动它，你就可以开始了。

构建服务器创建每日站点，显示单元测试覆盖率统计、复杂性测量、CVS 活动和开发人员活动（谁更改了什么以及何时更改）。

我们所有的软件都内置了自建数据库脚本。将配置文件指向数据库，启动软件，它会弄清楚它需要对数据库本身做什么。这真的很方便，因为构建服务器可以启动软件。无需特殊步骤。我们的客户也很高兴，他们永远不需要担心他们的数据库或升级脚本。

在 GForge 中管理、记录和跟踪整个项目生命周期，并添加了一些用于预算跟踪的外部电子表格，因为这更容易。

不管你有没有集成的项目服务器，我认为有一个系统真的很重要。这使您能够在项目之间切换开发人员而不会迷路。它可以节省时间。特别是当客户在 2 或 3 年后再次找您修改旧软件时（是的，这种情况发生了）。

我们使用的所有东西都是开源的（你甚至可以使用 GForge 的开源分支）。它不在工具中，而在于你如何使用它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-29T21:11:24.947

这将取决于工作的性质。在家为私人客户工作时，我首先为客户打开一个文件夹，里面有一堆我自定义的标准文档，例如合同、发票、报告、需求、测试、代码存储库等。随着项目的发展，我根据需要添加/修改目录。

如果我不得不回到一个项目，我会重新打开那个目录，并为任何不常见的组件创建一个新目录。例如，如果我的客户构建了一个 Web 应用程序，现在他们需要第二个应用程序，我将使用相同的目录来存放发票和合同，并为代码库、需求和测试创建新目录。

在备份方面，我会在达到里程碑的任何时候存档工作，但我每天至少备份的代码除外。在每个项目结束时，当我关闭合同时，我会获取整个目录并将其压缩并将其存储在远程服务器上。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-29T21:46:52.020

我创建包含项目阶段的文件夹，例如“初始化软件流程”，如果我们放置了诸如业务提案之类的文档，我们将另一个用于需求，另一个用于构建，发布，一个用于会议记录，等等。

我们将它们保存在 subversion 存储库中，但这实际上取决于您使用的方法，还取决于您如何处理配置管理以及您希望如何组织。是的，我们的大部分工件都使用模板，因此我们以某种方式保证了我们产品的质量。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-30T19:41:38.263

至于**源代码**，我们都在 Subversion 存储库中。每次发布后，我们都会创建一个分支——新功能只添加到当前分支（下一个版本将基于该分支），关键错误修复在当前和旧分支中完成（因此我们可以为该版本提供修补程序客户目前拥有）。

至于属于某个版本的所有**文档——从规划和资源表到我们创建的软件的规格、测试用例、用户和技术手册等——我们将它们存储在 Sharepoint 门户网站中。**这个 Sharepoint 站点的优点是用户可以通过网站访问（因此无需授予对您的存储库的管理访问权限；-），您可以精细控制访问权限，并且可以打开版本控制。我们还使用标记来标记文档是否属于特定版本（例如 service pack xy）或产品，或者它是否普遍有效。

关于**脚本**，我们使用几个来执行例如夜间构建和单元测试（我们通常对上一个版本和当前版本执行此操作），而且还部署完整的软件解决方案（包括 IIS 站点创建、数据库数据模型升级、... ) 在测试服务器上。这些是使用大量变量来表示路径、版本号等的[nant](http://nant.sourceforge.net/)脚本，因此很容易复制和修改它们以用于新版本。

# expression-blend - 有什么方法可以让混合重新加载已在 Visual Studio 中修改的项目？

> ID：493416
> 
> 赞同：3
> 
> 时间：2009-01-29T21:06:30.103
> 
> 标签：expression-blend, blend

我有一个 Visual Studio 解决方案，它同时在 blend 2 SP1 和 VS2008 SP1 中打开。

如果我在 VS 中进行更改，然后切换到混合，它会注意到项目已更改并重新加载内容，但这确实不可靠。有时它不会注意到更改，有时它会注意到更改，但不会重新加载所有更改的文件。值得注意的是：

1.  如果我在 blend 中打开了一个 xaml 文件，并在 VS 中对其进行编辑，当我切换回 blend 时，它通常不会拾取已编辑的源代码

2.  如果我使用 VS（图像或 xaml 文件或任何东西）将新文件添加到项目中，然后切换回混合，它不会显示添加的文件。

我能够让 blend 注意到这些更改的唯一方法是关闭项目并重新打开，或者退出并重新启动 blend。这*真的很*烦人。我想做的是强制混合重新加载项目，而不必关闭并重新打开它。

这似乎应该是显而易见的和容易的（F5 会很好），但我找不到任何东西！帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-02T19:53:27.800

在观看了 Jonas Follesoe 在混合中进行一些 Silverlight 开发的 TechEd 视频后，我注意到他不断地从内部混合中进行“重建解决方案”。

我试过这样做，它似乎让问题消失了。我不完全确定它是否已修复，但现在似乎好一些了。

# iphone - 为 iPhone 应用程序创建 Default.png 图像的最佳方法

> ID：493433
> 
> 赞同：23
> 
> 时间：2009-01-29T21:09:16.807
> 
> 标签：iphone, cocoa-touch

最初我只是在 iPhone 上截取我的应用程序的屏幕截图，然后在 Photoshop 中对其进行调整。

根据[Apple doc](http://developer.apple.com/iphone/library/documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/ApplicationEnvironment/chapter_3_section_4.html#//apple_ref/doc/uid/TP40007072-CH7-SW20)，图像应为480 x 320，我的屏幕截图尺寸为480 x 320。但是，屏幕截图包含通知区域（显示接收栏，电池寿命等）

所以，如果我把那部分切掉，我的图像会更短一点，而不是 480px 高。

我该怎么办？提交更短的图片？将其拉伸为 480 像素但没有通知栏？用图片中的通知栏提交？

您是如何创建 Default.png 的？

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2009-01-29T21:13:46.110

Xcode 支持创建默认图像。连接设备后，打开管理器（窗口 > 管理器）。单击屏幕截图选项卡，截取屏幕截图并单击“另存为默认图像...” 选择您的项目和宾果 jingo，您就完成了。

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2009-01-29T21:30:00.977

您可以将通知区域留在屏幕截图中。iPhone 将在其上绘制真正的通知栏。

**iOS 7 更新**：[iOS 7 过渡指南](https://developer.apple.com/library/ios/documentation/UserExperience/Conceptual/TransitionGuide/Scoping.html#//apple_ref/doc/uid/TP40013174-CH7-SW1)明确要求：

> 如果尚未包含状态栏区域，请更新启动图像以包含状态栏区域。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-07-10T16:45:25.293

我认为最好的方法是使用 Xcode screenshotter 并编辑一些 GUI 元素，比如按钮上的图稿或文本，这样人们在 Default.png 上按下“按钮”时不会感到沮丧。 t 让您的应用响应。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2010-02-24T02:24:52.920

如果你有一个状态栏，那么你应该设计 320x460（少 20 像素）。

虽然您可以将其保留为 320x480 并在 default.png 上绘制真实的状态栏是正确的，但当手机处于 Internet 共享模式或保持通话（另外 20 像素）时，它看起来会很奇怪。

通过裁剪为 320x460，它在网络共享模式下看起来更好。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-29T21:11:54.510

只需编辑通知区域以匹配图像其余部分的背景。只要您的图像是 480x320 就可以了。

但是，如果您的应用程序加载时间超过几秒钟，您可能需要重新考虑使用应用程序的屏幕截图作为启动屏幕。人们可能会感到困惑并认为应用程序已完成加载，但实际上并非如此。我已经看到一些应用程序在 Photoshop 中生成了其 UI 的“风格化”版本，这清楚地表明它只是一个图像而不是实际的 UI。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-09-03T16:11:17.583

您应该记住，您可能还需要一些空间来放置通话状态栏或网络共享状态栏。此条的高度为 20 像素。甚至苹果也没有做对。保持通话并启动“照片”或“天气”应用程序，然后您就会明白我的意思了。要进行测试，您可以使用 iPhone 模拟器应用程序中的“切换通话状态栏”菜单。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-05-21T22:39:54.973

如果将布尔键 UIStatusBarHidden 添加到 Info.plist 文件并将其设置为 true，则可以使用真正的 480x320 图像。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2011-06-07T01:48:39.077

正如许多答案已经提到的那样，截屏。但是，如果您的屏幕截图包含状态栏，则应将其删除/替换为透明条。iPhone 确实会用当前状态栏覆盖 Default.png 的这一部分，但是，如果您在 iPad 上运行 iPhone 应用程序，您仍然可以看到 Default.png 的这一部分。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-01-19T04:35:03.863

我在 IB 中构建了初始视图的略微修改版本，使用它运行应用程序并截屏。这样，一切看起来都非常 iPhoney，不需要 Photoshop。不要太担心剪裁顶部，如果有更多东西覆盖它，它将反映视图在加载时的实际外观。

Apple 推荐的内容*类似于*用户在应用加载时所看到的内容。例如，对于我的数独应用程序，default.png 显示的是“请稍候”消息，而不是网格。加载应用程序时，它会消失，您会看到可以与之交互的网格。它看起来很流畅，并且在加载和可以交互时很明显。

最后，界面使用了一些工具栏按钮。在 default.png 中，它们处于禁用状态（灰色文本）。加载应用程序时，它们会启用并更改颜色。

# c - 为什么 main() 没有最后没有返回的编译器错误？

> ID：493440
> 
> 赞同：9
> 
> 时间：2009-01-29T21:10:56.867
> 
> 标签：c, compiler-errors

我正在编写 C 脑预告片：编写标准的 Hello-World 程序，不带分号。

到目前为止，我最好的答案是：

```
int main(void)
{
    if (printf("Hello World!\n"), exit(0), 0)
    {
        /* do nothing */
    }
} 
```

但我不明白为什么我没有得到编译器错误（Visual Studio）：

```
error C4716: 'main' : must return a value 
```

我尝试了其他声明了返回类型但缺少返回语句的函数，并得到了这个编译器错误。

* * *

请注意，我也尝试过：

```
int foo(void)
{
    if (printf("Hello World!\n"), exit(0), true)
    {
        /* do nothing */
    }
}

int main(void)
{
    foo();
} 
```

并且不要在 foo 上得到编译器错误。如果我删除“exit(0)”，我*会*得到编译器错误。显然编译器知道“退出”是一个特殊功能？这对我来说似乎很奇怪。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-29T21:56:56.850

正如 Jens 在评论中指出的那样，发布的代码没有表现出未定义的行为。这里的原始答案不正确，甚至似乎都没有真正回答这个问题（几年后重新阅读所有内容）。

这个问题可以概括为，“为什么 MSVC`main()`在与其他功能相同的情况下不发出警告 C4716”？

请注意，诊断 C4716 是警告，而不是错误。就 C 语言而言（无论如何从标准的角度来看），从来不需要诊断非错误。但这并不能真正解释为什么会有差异，这只是一个技术性问题，可能意味着你不能抱怨太多......

关于为什么 MSVC 不针对其他功能发出警告的真正解释`main()`实际上只能由 MSVC 团队中的某个人来回答。据我所知，文档没有解释差异，但也许我错过了一些东西；所以我所能做的就是推测：

在 C++ 中，该`main()`函数被特殊处理，因为`return 0;`在右大括号之前有一个隐式。

我怀疑微软的 C 编译器在 C 模式下编译时提供了相同的处理（如果你查看汇编代码，即使没有 EAX 寄存器也会被清除`return 0;`），因此就编译器而言，没有理由发布警告 C4716。请注意，Microsoft 的 C 模式是 C90 兼容的，而不是 C99 兼容的。在 C90 中，“跑完”`main()`有未定义的行为。但是，始终返回 0 满足未定义行为的低要求，因此没有问题。

因此，即使问题中的程序*确实*运行结束`main()`（导致未定义的行为），仍然不会发出警告。

* * *

原始的，不太好的答案：

~~在 ANSI/ISO 90 C 中，这是未定义的行为，因此 MS 确实应该产生错误（但标准并不要求它们）。在 C99 中，标准允许`return`在 main() 的末尾隐含 - 就像 C++ 一样。~~

所以如果编译成 C++ 或者 C99 就没有错误，和`return 0;`. C90 导致未定义的行为（不需要诊断）。

有趣的是（好吧，也许不是），在几个编译器（VC9、VC6、GCC 3.4.5、Digital Mars、Comeau）中，我用我的基本的、大部分是默认的选项集（我几乎总是用于快速-代码片段的 n-dirty 测试）当编译为 C++ 程序时，唯一警告缺少返回语句的编译器是 VC6（为 C 编译时 VC6 不会抱怨）。

~~如果函数未命名，大多数编译器都会抱怨（警告或错误）`main`。为 C 编译时的数字火星不会，而 GCC 不会为 C 或 C++ 编译。~~

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-29T21:13:24.647

如果您不返回任何内容，程序将返回 0。请参阅[http://www.research.att.com/~bs/bs_faq2.html#void-main](http://www.research.att.com/~bs/bs_faq2.html#void-main)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-29T21:16:35.810

编译器可能足够聪明，可以知道正在调用 exit(0)，它永远不会返回，因此不需要它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-29T21:24:02.783

因为这不是错误——它是未定义的行为。请参阅 C99 标准的第 6.9.1 节第 12 段：

> 如果到达终止函数的 }，并且调用者使用了函数调用的值，则行为未定义。

因此，当看到您的代码无法返回时，编译器可以自由地做任何事情——它可以发出错误、警告或根本不发出任何东西。在 GCC 的情况下，它默认编译成功，没有警告或错误。使用该`-Wall`选项，它会发出警告。

`main()`在 C 语言中很特殊：它是唯一允许不返回值的函数。`main()`C 标准规定，如果控制在没有语句的情况下到达末尾`return`，它会隐式返回 0。这仅适用于`main()`，所有其他非 void 函数都必须返回一个值。

第 5.1.2.2.3 节：

> 如果 main 函数的返回类型是与 int 兼容的类型，则从初始调用到 main 函数的 return 等效于以 main 函数返回的值作为参数调用 exit 函数；10）到达 }终止 main 函数返回值 0。如果返回类型与 int 不兼容，则返回给宿主环境的终止状态未指定。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-29T21:36:20.933

## 来自[http://msdn.microsoft.com/en-us/library/k9dcesdd(VS.71).aspx](http://msdn.microsoft.com/en-us/library/k9dcesdd(VS.71).aspx)

> C++ 语言参考
> 
> 退出函数
> 
> 在标准包含文件 STDLIB.H 中声明的退出函数终止 C++ 程序。
> 
> 作为退出参数提供的值作为程序的返回码或退出码返回给操作系统。按照惯例，返回码为零表示程序成功完成。
> 
> 注意 您可以使用 STDLIB.H 中定义的常量 EXIT_FAILURE 和 EXIT_SUCCESS 来指示程序的成功或失败。
> 
> 从 main 函数发出 return 语句等效于以返回值作为参数调用 exit 函数。

* * *

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-05-12T16:30:47.970

由于各种原因，不从 main 返回，或者更准确地说，没有到达 main 函数的终止 '}' 是完全可以的。典型情况包括永远循环和之前退出或中止。

在这种情况下，`exit(0)`保证在到达 main 结束之前执行。为什么编译器要发出警告？您不会期望这些警告，对吗？

```
int main (void) { for (;;) { /* do something useful */ } }

int main (void) { /* do something  */; exit (0); } 
```

如果我什至会感到惊讶

```
int main (void)
{
    if (printf("Hello World!\n"), exit(0), true)
    {
        /* do nothing */
    }
    return 0;
} 
```

不会导致`warning: unreachable code: return 0`或类似的。

# ajax - 有人可以列出常见的 javascript 框架/库以及每个框架/库的优缺点吗？

> ID：493443
> 
> 赞同：0
> 
> 时间：2009-01-29T21:11:43.463
> 
> 标签：ajax, dhtml, javascript

所以我有很多项目可以使用一点 dhtml Pizzaz，我不知道哪个框架用于哪个项目，任何帮助都将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-29T21:17:34.840

另外：[Javascript库的比较](https://stackoverflow.com/questions/35050/comparison-of-javascript-libraries)，喜欢：

[http://en.wikipedia.org/wiki/Comparison_of_JavaScript_frameworks](http://en.wikipedia.org/wiki/Comparison_of_JavaScript_frameworks)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-29T21:18:33.200

真的，你对任何主要的都很好，因为它们都可以完成基本相同的事情，并且大多数都有很多重叠的插件和脚本。也就是说，我推荐[jQuery](http://jquery.com/)或[MooTools](http://mootools.net)。

**jQuery** - 大型社区。最新更新速度非常快。对于初学者来说非常容易。很多插件。

**MooTools** - 对初学者来说有点难，但我真的很喜欢它的类结构和模块化。您可以选择您需要框架的哪些部分，而忽略其余部分。社区不如 jQuery 的好。很多插件。

您也可以使用[Prototype](http://www.prototypejs.org/) / [Scriptaculous](http://script.aculo.us/)、[YUI](http://developer.yahoo.com/yui/)、[Dojo](http://dojotoolkit.org/)和其他一些工具，尽管我不太了解它们的优缺点。

但是，要记住的重要一点是，一次不要使用多个库。您不能同时使用 Mootools 和 Prototype，但也不应该同时使用其他工具，因为您只是不必要地增加了页面大小。如果您在一个库中找到您真正喜欢的脚本，那么它很可能存在于另一个库中。

当您将文件提供给浏览器时，您还可以通过 gzip 压缩获得最佳压缩效果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-29T21:16:31.317

这是[https://stackoverflow.com/questions/913/what-javascript-library-would-you-choose-for-a-new-project-and-why的副本](https://stackoverflow.com/questions/913/what-javascript-library-would-you-choose-for-a-new-project-and-why)

不过就个人而言，我广泛使用了 MooTools、Prototype、Scriptaculous 和 jQuery，而且我喜欢 jQuery。这实际上取决于您对手头项目的需求和您的个人品味。没有“最好”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-29T21:50:43.633

原型：优点：非常强大、小巧、易于集成、出色的 API 缺点：有限的内置小部件（参见 scriptaculous）

Dojo：优点：有很多小部件，不错的支持论坛，很棒的 AP​​I 缺点：违反了 Web 标准，小部件是在 domload 后加载的

# c++ - 我应该使用 GetProcAddress 还是只包含各种 win32 库？

> ID：493447
> 
> 赞同：2
> 
> 时间：2009-01-29T21:12:35.333
> 
> 标签：c++, c, winapi

想知道有什么区别：

```
static PROCESSWALK pProcess32First=(PROCESSWALK)GetProcAddress(hKernel,"Process32First");
...
pProcess32First(...); 
```

什么是hKernel？看[这里](http://msdn.microsoft.com/en-us/library/windows/desktop/ms683212%28v=vs.85%29.aspx)。您可以替换为`GetModuleHandle()`

和

```
#include <Tlhelp32.h>
...
Process32First(...); 
```

有什么区别，我想知道我应该使用哪个。那么在最佳实践方面有什么不同吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-29T21:23:51.037

注意：我的回答假设该功能可以通过任何一种方式使用，如果您使用非导出功能，还需要考虑其他事项。

如果您使用 LoadLibrary 和 GetProcAddress，那么如果所需的库不存在，您可以选择以减少的功能运行。如果您使用包含并直接链接 lib，并且 dll 不存在（或由于版本错误而没有导出），您的应用程序将无法加载。

如果你想使用一个不在给定 dll 的所有版本中的函数，它真的会有所不同。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-29T21:50:22.090

In addition to what Evan said (which is correct), another important difference (IMHO) is that if you're dynamically loading functions, you need to have a typedef to cast the void* to in order to call the function once it's loaded. Unless the header files which defines the function prototype for static linkage has a mechanism for also defining the typedef for the function pointer from the same template function definition code, you're going to end up with a duplicate function definition, probably in your code. If the external header definitions are ever updated (for example, with new definitions for 64bit data types), you risk runtime errors in your application unless you update the other function prototypes (these will not be caught at compile time, because of the c-style cast to the function typedef).

It's a subtle issue, but an important one to consider. I would use implicit ("static") linking if you can because of that issue, and if you're using dynamic loading, be aware of the issue, and structure your code to avoid problems in the future as best you can.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-29T21:24:46.790

有关 Microsoft 的说明，请参见[此处](http://msdn.microsoft.com/en-us/library/253b8k2c.aspx)。

隐式链接（使用`*.lib`）更简单。

至于内核库，没有其他区别。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-29T21:29:05.083

如果我有用户可能有也可能没有的可选插件库，我会采用第一种方法。对于必要的库，我会使用第二个，因为获取函数的代码要少得多。

# git - 在 git 中修改过去提交中的单个文件

> ID：493450
> 
> 赞同：18
> 
> 时间：2009-01-29T21:13:24.583
> 
> 标签：git

我想在过去的提交中修复一个文件。这可能会影响所有升序提交。

有没有简单的方法可以做到这一点？你能给我一个指导方针吗？

很多时候，当我提交两次时，我发现我在第一次提交时出错了，我希望修复错误而不必“git reset”我最后一次好的提交。

为了澄清。我想改变实际的*commit*，也就是我想改变过去 commit 的内容。IOW 我想**改变历史！**

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-01-29T21:22:49.073

如果您只想修改倒数第二个提交（例如，不久前，尤其是在许多分支和合并之前），那么我使用此过程：

1.  `git checkout -b tmp bad-commit`
2.  修复文件
3.  `git commit --amend`
4.  `git rebase tmp master`

如果您之间有合并，您可能想尝试`rebase -i -p`，但结果可能会有所不同。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-29T21:45:44.567

看起来像：

*   a [`filter-branch`](http://git-scm.com/docs/git-filter-branch)（可以做你想做的复杂命令）
*   [并按照jpalecek](https://stackoverflow.com/questions/493450/amending-a-single-file-in-a-past-commit-in-git/493493#493493)的描述修改和变基。[您会在这个其他相关问题](https://stackoverflow.com/questions/307828/git-remove-file-accidentally-added-to-the-repository)中找到更详细的相同解决方案。

[您可以在此评论](http://community.livejournal.com/evan_tech/232800.html)中找到 rebase interactive 的示例：然后您可以避免临时分支，但同样，它更复杂。

> 我还经常变基以清理开发历史，以便更改正确并正确分组。
> 
> 一个虚构的例子：
> 我将函数重命名`foo`为`bar`并提交了一条注释，上面写着“将 foo 重命名为 bar”。
> 然后我继续下一个功能或修复，并提交它，然后继续下一个。
> 进行到一半时，我发现我错过了一个`foo`！
> **我提交正在进行的工作（或使用 git-stash），修复丢失的“foo”并提交，然后使用`git-rebase --interactive`将所有`foo`修复合并到一个干净的提交中。**
> 如果我没有使用，那么当我最终完成正在进行的功能时`git-stash`，我将使用（另一种形式的变基）。`git-commit --amend`
> 
> 当我的补丁被推送审查时，所有的部分都是正确的，并且讲述了一个连贯的故事。有时我`git-rebase --interactive`只是用来进行影响相同位的相邻时间分离的更改，以便更改在上下文中。

# c# - 在 .NET 远程处理中，RemotingConfiguration.RegisterWellKnownServiceType 和 RemotingServices.Marshal 有什么区别？

> ID：493455
> 
> 赞同：19
> 
> 时间：2009-01-29T21:13:54.597
> 
> 标签：c#, .net, remoting

在 .NET 远程处理中，RemotingConfiguration.RegisterWellKnownServiceType 和 RemotingServices.Marshal 有什么区别？

我想要做的是在 Windows 服务中创建一个对象，然后将其作为远程处理对象放入，并让 Windows 服务和客户端都对远程处理对象起作用。

我认为下面的代码可以实现这一点。

```
FooRemoting foo = new FooRemoting();

RemotingConfiguration.RegisterWellKnownServiceType(typeof(FooRemoting), serverName, WellKnownObjectMode.Singleton);
RemotingServices.Marshal(foo); 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-01-29T21:49:26.727

这就是我发现的。

```
RemotingConfiguration.RegisterWellKnownServiceType(typeof(FooRemoting), 
          serverName, WellKnownObjectMode.Singleton); 
```

RegisterWellKnownServiceType 将创建该对象并使其成为任何使用它的客户端的 Singleton，但不会创建服务器的引用。该对象在客户端请求之前不会创建，并且相同的对象用于任何其他客户端。

```
RemotingServices.Marshal(foo); 
```

Marshal 将注册一个由服务器创建的对象，在本例中是一个 Windows 服务。然后服务器将引用该对象，客户端将使用相同的对象。

我的问题是使用 Marshal 注册远程对象。随着时间的推移，远程处理对象将消失以供客户端使用，即不再位于远程处理对象上。该服务仍将保留其参考。然后我尝试了 RegisterWellKnownServiceType 并且客户端不断获得正确的引用，但是我无法让服务引用同一个对象。

在这种情况下，解决方案是覆盖远程处理对象 FooRemoting。如果我覆盖 InitializeLifetimeService 并返回 null，则客户端将永远不会失去连接，而服务将保持连接。

```
public override object InitializeLifetimeService()
{
    //return base.InitializeLifetimeService();
    return null;
} 
```

为了保留服务创建的对象并让客户端使用相同的对象，您必须使用

```
RemotingServices.Marshal(foo); 
```

并覆盖 InitializeLifetimeService 以返回 null。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2010-01-21T12:31:24.757

可以通过远程处理公开具有参数构造函数的 MarshalByRefObjects，并且该类的用户可以仅处理其接口。

我创建了一个小型概念验证项目。它有 3 个项目：服务器、客户端和核心。服务器和客户端都引用Core，但不相互引用。

在核心中，我们定义了一个服务接口：

```
namespace Core
{
    public interface ICountingService
    {
        int Increment();
    }
} 
```

服务器定义了具体的实现，*客户端没有引用*：

```
namespace Server
{
    public class CountingService : MarshalByRefObject, ICountingService
    {
        private static int _value = 0;

        public CountingService(int startValue)
        {
            _value = startValue;
        }

        public int Increment()
        { // not threadsafe!
            _value++;
            return _value;
        }
    }
} 
```

需要注意的重要一点是它有一个带参数的构造函数，它是一个 MarshalByRefObject，它实现了核心项目中的接口。

服务器项目是一个控制台应用程序，它设置一个远程处理通道（在本示例中任意通过 HTTP），创建服务，并将其注册到远程处理：

```
using System;
using System.Runtime.Remoting;
using System.Runtime.Remoting.Channels;
using System.Runtime.Remoting.Channels.Http;

namespace Server
{
    class Program
    {
        static void Main(string[] args)
        {
            HttpServerChannel serverChannel = new HttpServerChannel(8234);
            ChannelServices.RegisterChannel(serverChannel, false);

            // Following line won't work at runtime as there is no parameterless constructor
            //RemotingConfiguration.RegisterWellKnownServiceType(typeof(CountingService),
            //                     "CountingService.rem", WellKnownObjectMode.Singleton);

            CountingService countingService = new CountingService(5);
            RemotingServices.Marshal(countingService, "CountingService.rem");

            Console.WriteLine("Press enter to exit.");
            Console.ReadLine();
        }
    }
} 
```

上面的代码已经注册了 URL [http://localhost:8234/CountingService.rem](http://localhost:8234/CountingService.rem)，其中保存了实例化的服务，将从 5 开始计数。

客户端，也是一个控制台应用程序，然后可以*使用接口类获取引用：*

```
using System;
using System.Runtime.Remoting.Channels;
using System.Runtime.Remoting.Channels.Http;
using Core;

namespace Client
{
    class Program
    {
        static void Main(string[] args)
        {
            HttpClientChannel serverChannel = new HttpClientChannel();
            ChannelServices.RegisterChannel(serverChannel, false);

            for (int i = 0; i < 5; i++)
            {
                ICountingService countingService =
                    (ICountingService)Activator.GetObject(typeof(ICountingService),
                    "http://localhost:8234/CountingService.rem");

                int newValue = countingService.Increment();
                Console.WriteLine("Value is " + newValue);
            }

            Console.WriteLine("Press enter to exit.");
            Console.ReadLine();
        }
    }
} 
```

当服务器和客户端运行时，它会打印从 6 到 10 的值。

总结：客户端只知道接口；实现构造函数可以有参数；实例化可以由您自己的代码而不是由 .NET 控制。在使用远程对象处理基于构造函数的依赖注入时非常有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-01T03:07:06.287

我像这样用 RemotingServices.Marshal 做了一个实验

托管在 Windows Exe 中的远程组件。exe代码是

```
Form1_Load(object sender, EventArgs e)
{
   RemotingConfiguration.Configure("path of the config file");
   RemoteClass obj = new RemoteClass();
   obj.MyVal =100;

   RemotingServices.Marshal(obj);
}

public RemoteClass: MarshalByRefObj
{
   static int Counter;
   public RemoteClass()
   {
      Counter++;
   }

   int _MyVal =0;
  public int MyVal
 {
    get
   {
      return _MyVal;
   }
   set
   {
      _MyVal = value;
   }
 }       
} 
```

现在在客户端代码中

```
button1_click()
{
  RemoteClass obj = Activator.GetObject(typeof(RemoteClass), "object URI");
  if(RemotingServices.IsTransparentProxy(obj))
  {
      MessageBox.Show(obj.Myval.ToString());
  }
} 
```

它会弹出消息为 0 而不是 100。如果你在 RemoteClass 的构造函数中放置一个断点，你会看到构造函数被调用了 2 次

1.  当在 Service 本身中创建 RemoteClass 对象时
2.  当客户端调用 MyVal 属性时。

我认为 RemotingServices.Marshal 与单个实例无关。即使您仅使用 RemotingConfiguration.Configure 并覆盖 InitializeLifetimeService 以使其返回 null，也足以托管远程组件。

# flat-file - 如何说服编程团队放弃旧方法？

> ID：493460
> 
> 赞同：6
> 
> 时间：2009-01-29T21:14:28.997
> 
> 标签：flat-file, relational, basic

这更像是一个面向业务的编程问题，我似乎无法弄清楚如何解决。我与一个使用 BASIC 超过 20 年的程序员团队一起工作。我被请来帮助在 .NET 中编写相同的软件，只有更新和现代实践。问题是我似乎无法让其他 3 名团队成员（所有 BASIC 程序员，尽管现在也有 .NET）了解如何正确地创建关系数据库。这是他们无法理解的事情：

我们基本上有一个跟踪客户标签信息的事务。我们需要能够跟踪当前交易和过去的交易。在旧系统中，使用了一个平面文件数据库，其中一个表包含客户当前基本交易的记录，另一个包含客户所有先前交易以及重要货币信息的交易。为了防止冗余，他们会用历史交易覆盖当前交易——（历史文件首先更新，然后是当前的。）这完全没有必要，因为你只需要一个交易表，但我的主管或我的其他两个同事中的任何一个-工人似乎无法理解这一点。我到底如何才能说服他们看到光明，这样我们才能获胜 不必做大量荒谬的工作并最终多次访问数据表吗？感谢您的输入！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-29T22:49:49.630

首先，我必须承认，从您的描述中，我并不完全清楚现有结构中的数据结构和逻辑流实际上是什么。这对我来说确实意味着，也许您也没有向您的同事明确说明自己，因此您的首要任务之一必须是能够以口头或最好以书面和图表的方式解释当前情况和建议的替代人选。请将此视为一种观察，而不是对您的问题的任何批评。

其次，我确实发现有 20 年经验的程序员不懂关系数据库和事务，这很了不起。平面文件编码很久以前就退出了主流——我在 1988 年第一次在商业环境中处理关系数据库，到 90 年代中期它们已经很普遍了。您从事什么行业和产品类型？在我看来，您可能正在处理某种嵌入式或其他“不寻常”系统，在这种情况下，您确实需要确保您没有某种通信问题并且您正在俯瞰一头大大象尚未向您指出这一点-您不会成为第一个因未获得适当信息而以某种方式成立的团队的“顾问”。

最后，如果您完全确定自己的立场并且您面对的团队不会接受您的建议 - 如果您可以抽出时间演示代码是一个好主意 - 那么您可能不得不接受优雅地决定并移动一个。我自己在这个位置上我会尝试抽象出这个问题 - 例如，数据库更新是否可以移动到存储过程中，以便更新两个表的代码在 SP 中，并且可以在以后修改以移动到您的架构而无需相应的应用程序更改？确保您的论点得到妥善记录和记录，以便以后有机会时可以重新审视它们。

您不会是第一个因为办公室政治而不得不实施次优解决方案的编码人员 - 将其用作您自己处理此类情况的个人发展的学习经验，并同情自己认为您将获得额外报酬的想法工作。通常，此类争论中的决定因素不是逻辑，而是您自己带来的“声誉权重”——听起来您被带进来对您的团队没有太大的影响力，所以您在您在后续情况下获得足够的声誉之前，您可能必须通过擅长执行他们同意做的事情来获得声誉 - 您需要先进行改装！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-29T21:18:29.457

有时你不能。

如果你读过一些 XP 书籍，他们经常说你最大的障碍之一是说服你的团队放弃他们一直在做的事情。

一般来说，他们会建议让无法适应的人去其他项目（或者只是让他们去）。

代码审查可能对您的情况有所帮助。对每一行代码进行强制性代码审查并非闻所未闻。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-29T21:18:40.110

有时最好的论据就是一个例子。我会写一个原型（如果不是太多工作，我会写一个替代品）。通过一个示例进行检查，将更容易看出关系数据库的优缺点。

顺便说一句，平面文件数据库有它们的位置，因为它们比真正的关系数据库更容易“管理”。保持开放的心态。;-)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-29T21:31:06.247

我认为您可能必须以身作则 - 当人们看到“新”方式的工作量较少时，他们会采用它（只要您不对此嗤之以鼻）。

我还会问自己，旧的设计是否真的造成了问题，或者它是否只是在美学上令人讨厌。选择你的战斗是很重要的——如果旧设计没有导致性能问题或使系统难以维护，你可能想不理会旧设计。

最后，如果您确实保留了旧设计，请尝试抽象您的新代码和旧数据库之间的接口，因此如果您确实说服您的同事稍后改进设计，您可以将新模式放入而无需更改还要别的吗。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-21T16:56:04.793

除了原始问题的普遍挫败感之外，很难提取很多内容。

是的，随着时间的推移，有很多技术和习惯会随着技术的变化而变得无用甚至代价高昂。在处理能力、内存甚至磁盘很昂贵时，一些有意义的事情现在可能是愚蠢的优化尝试。随着时间的推移，人们也会积累不良习惯和不良编程模式。

不过你必须小心。

有时，那些老前辈所做的事情是有充分理由的。可悲的是，他们甚至可能无法说出“为什么”——如果他们甚至不再知道为什么的话。

当新手进入企业软件开发商店时，我看到很多这种挫败感。即使环境都是相当现代的技术和工具，它也可能很糟糕。如果您的大部分经验是编写小型社区桌面和 Web 应用程序，那么您“知道”的很多内容可能是错误的。

通常对事务日志的要求高于您的 DBMS 可能执行的级别。很多时候，为了确保时间序列的正确性、一次且仅一次更新、弹性和不可否认性，可能有必要超越 DB 事务语义。

这甚至还没有开始解决企业或企业间可扩展性所涉及的问题。当您开始每天处理 50 万个复杂事务时，您会发现 RDBMS 技术让您失望。因为关系数据库不是为处理大量事务而设计的，所以您必须经常打破标准范式以进行规范化和更新。无论您在问题上投入多少硬件，传统的 RDBMS 锁定技术都会破坏可伸缩性。

很容易将所有这些都视为乏味或普遍的错误头脑——甚至是无能。但要小心，因为情况并非总是如此。

顺便说一句：除了 RDBMS 之外还有其他模型，RDBMS 的替代品不一定是“平面文件”——这与当今大多数编码人员的经验相反。有事务分层 DBMS 可以处理比 RDBMS 高得多的吞吐量。 [例如， IMS](http://www.ibmsystemsmag.com/mainframe/marchapril09/trends/24577printp1.aspx)在大型 IBM 商店中仍然非常活跃。其他供应商为不同的平台提供类似的软件。

当然，在 4 人商店中，这可能都不适用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-29T21:17:09.223

为他们报名参加一些体面的培训，然后由您来说服他们相信使用新技术可以实现更多可能性（或者至少更容易！）。

但我认为这里最重要的是专业的、经过认证的培训师首先教他们基础知识。他们会对此印象更深，而不仅仅是他们的一位同事告诉他们：“嘿，为什么不用这个？”

相关帖子[在这里](https://stackoverflow.com/questions/422076/subtly-tell-someone-that-you-cant-just-teach-them-and-them-trying-to-help-me-is)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-21T17:48:04.057

以下可能不适用于您的情况，但您很少提及技术细节，所以我想我会提到它......

有时，如果当前数据的访问模式与历史数据的访问模式非常不同（我正在制作这个示例，但是说当前数据每秒访问 1000 次，并且访问一小部分列，以及所有当前数据适合小于 1 GB，而例如，历史数据使用 1000 GB，每天仅访问 100 次，并且可以访问所有列），

然后，您的同事正在做的事情将非常有意义，以进行性能优化。通过分离当前数据（虽然是冗余的），您可以优化该表中的索引和数据结构，以实现在历史表中无法执行的更高频率的访问模式。

从纯粹的关系角度来看，并非所有“学术上”或“技术上”正确的东西在应用于实际实际情况时都是有意义的。

# python - 使用以下格式的python解析文件的最佳方法（防错/万无一失）是什么？

> ID：493484
> 
> 赞同：3
> 
> 时间：2009-01-29T21:19:31.873
> 
> 标签：python, text-parsing

```
########################################
# some comment
# other comment
########################################

block1 {
    value=data
    some_value=some other kind of data
    othervalue=032423432
    }

block2 {
    value=data
    some_value=some other kind of data
    othervalue=032423432
    } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-10-31T16:05:47.833

最好的方法是使用现有的格式，例如 JSON。

这是您的格式的示例解析器：

```
from lepl import (AnyBut, Digit, Drop, Eos, Integer, Letter,
                  NON_GREEDY, Regexp, Space, Separator, Word)

# EBNF
# name = ( letter | "_" ) , { letter | "_" | digit } ;
name = Word(Letter() | '_',
            Letter() | '_' | Digit())
# words = word , space+ , word , { space+ , word } ;
# two or more space-separated words (non-greedy to allow comment at the end)
words = Word()[2::NON_GREEDY, ~Space()[1:]] > list
# value = integer | word | words  ;
value = (Integer() >> int) | Word() | words
# comment = "#" , { all characters - "\n" } , ( "\n" | EOF ) ;
comment = '#' & AnyBut('\n')[:] & ('\n' | Eos())

with Separator(~Regexp(r'\s*')):
    # statement = name , "=" , value ;
    statement = name & Drop('=') & value > tuple
    # suite     = "{" , { comment | statement } , "}" ;
    suite     = Drop('{') & (~comment | statement)[:] & Drop('}') > dict
    # block     = name , suite ;
    block     = name & suite > tuple
    # config    = { comment | block } ;
    config    = (~comment | block)[:] & Eos() > dict

from pprint import pprint

pprint(config.parse(open('input.cfg').read())) 
```

输出：

```
[{'block1': {'othervalue': 32423432,
             'some_value': ['some', 'other', 'kind', 'of', 'data'],
             'value': 'data'},
  'block2': {'othervalue': 32423432,
             'some_value': ['some', 'other', 'kind', 'of', 'data'],
             'value': 'data'}}] 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-29T21:34:23.293

嗯，数据看起来很规律。所以你可以做这样的事情（未经测试）：

```
class Block(object):
    def __init__(self, name):
        self.name = name

infile = open(...)  # insert filename here
current = None
blocks = []

for line in infile:
    if line.lstrip().startswith('#'):
        continue
    elif line.rstrip().endswith('{'):
        current = Block(line.split()[0])
    elif '=' in line:
        attr, value = line.strip().split('=')
        try:
            value = int(value)
        except ValueError:
            pass
        setattr(current, attr, value)
    elif line.rstrip().endswith('}'):
        blocks.append(current) 
```

结果将是 Block 实例的列表，其中`block.name`名称（`'block1'`、`'block2'`等）和其他属性对应于数据中的键。因此，`blocks[0].value`将是“数据”等。请注意，这仅将字符串和整数作为值处理。

（如果您的密钥可以包含“名称”，则这里有一个明显的错误。如果发生这种情况，您可能希望更改`self.name`为`self._name`或其他内容）

！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-29T22:24:17.547

如果您的意思不是真正的解析，而是文本处理，并且输入数据确实很常规，那么请使用 John 的解决方案。如果你真的需要一些解析（比如你得到的数据有一些更复杂的规则），那么根据你需要解析的数据量，我会选择 pyparsing 或[simpleparse](http://simpleparse.sourceforge.net/)。我都试过了，但实际上 pyparsing 对我来说太慢了。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-29T22:15:12.523

你可能会研究类似[pyparsing 的东西。](http://pyparsing.wikispaces.com/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-10-05T15:23:40.737

[Grako（用于语法编译器）](http://pythonhosted.org/grako/)允许将输入格式规范（语法）与其解释（语义）分开。这是 Grako 的各种[EBNF](http://en.wikipedia.org/wiki/Extended_Backus%E2%80%93Naur_Form)输入格式的语法：

```
(* a file contains zero or more blocks *)
file = {block} $;
(* a named block has at least one assignment statement *)
block = name '{' {assignment}+ '}';
assignment = name '=' value NEWLINE;
name = /[a-z][a-z0-9_]*/;
value = integer | string;
NEWLINE = /\n/;
integer = /[0-9]+/;
(* string value is everything until the next newline *)
string = /[^\n]+/; 
```

要安装`grako`，运行`pip install grako`。从语法生成[PEG解析器：](http://en.wikipedia.org/wiki/Parsing_expression_grammar)

```
$ grako -o config_parser.py Config.ebnf 
```

`config_parser`使用生成的模块将 stdin 转换为 json ：

```
#!/usr/bin/env python
import json
import string
import sys
from config_parser import ConfigParser

class Semantics(object):
    def file(self, ast):
        # file = {block} $
        # all blocks should have unique names within the file
        return dict(ast)
    def block(self, ast):
        # block = name '{' {assignment}+ '}'
        # all assignment statements should use unique names
        return ast[0], dict(ast[2])
    def assignment(self, ast):
        # assignment = name '=' value NEWLINE
        # value = integer | string
        return ast[0], ast[2] # name, value
    def integer(self, ast):
        return int(ast)
    def string(self, ast):
        return ast.strip() # remove leading/trailing whitespace

parser = ConfigParser(whitespace='\t\n\v\f\r ', eol_comments_re="#.*?$")
ast = parser.parse(sys.stdin.read(), rule_name='file', semantics=Semantics())
json.dump(ast, sys.stdout, indent=2, sort_keys=True) 
```

### 输出

```
{
  "block1": {
    "othervalue": 32423432,
    "some_value": "some other kind of data",
    "value": "data"
  },
  "block2": {
    "othervalue": 32423432,
    "some_value": "some other kind of data",
    "value": "data"
  }
} 
```

# php - php中的可变长度数据包

> ID：493487
> 
> 赞同：5
> 
> 时间：2009-01-29T21:20:26.287
> 
> 标签：php, sockets

我正在接收通过 UDP 发送到我的服务器的数据包。我正在使用 socket_read 来读取数据，并且运行良好。但是我遇到了一个错误。在我的情况下，socket_read 的长度参数并不总是相同的。数据的长度范围为 50-150 字节。保持不变的一件事是数据集以 \x00 字节结束。在遇到这个字节之前，如何让读取函数始终读取？我已经尝试过 PHP_NORMAL_READ 标志，但文档说它只以 \n 或 \r 结尾，这真的不是我想要的（尝试过它不适用于我的数据）。同时，socket_read 的 php 页面在*长度*参数描述中指出，

> 读取的最大字节数由长度参数指定。否则，您可以使用 \r、\n 或 \0 来结束读取（取决于类型参数，见下文）。

该类型没有说明 /0 字节。它就像一个文档丢失了。我需要的是一个函数，它既可以让我为我的数据指定一个分隔符，又可以自动从可用的套接字读取所有数据。socket_recv 函数中可能有一个解决方案，但它没有记录，我不知道它是如何工作的。

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-13T10:04:43.057

如果我理解正确，您想从套接字读取数据，直到没有更多数据要读取，问题是数据量是可变的，您不知道何时停止。

根据相关手册页（[http://php.net/socket_read](http://php.net/socket_read)）：

> 注意：当没有更多数据要读取时，socket_read() 返回一个零长度字符串 ("")。

您应该能够通过逐字节读取来处理可变长度数据，直到遇到零长度字符串：

```
while (($currentByte = socket_read($socket, 1)) != "") {
    // Do whatever you wish with the current byte
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-30T07:08:25.227

你有没有尝试过这样的事情：

```
do {
    echo socket_read($handle,1024);
    $status = socket_get_status($handle);
} while($status['unread_bytes']); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-29T21:40:14.483

处理读取有效负载的应用程序需要识别您传递的任何应用程序消息何时到达“记录结束”。读取时期望任意长度。

谨慎使用 UDP，因为如果您尝试将多个读取流式传输到一条消息中，您也不能保证读取数据包的顺序是对等方发送的顺序。在这种情况下推荐使用 TCP 套接字。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-02T15:06:18.190

遇到了另一种可能适用于您的情况的方法：

```
<?php
  function tftp_fetch($host, $filename)
  {
    $socket = socket_create(AF_INET, SOCK_DGRAM, SOL_UDP);

    // create the request packet
    $packet = chr(0) . chr(1) . $filename . chr(0) . 'octet' . chr(0);
    // UDP is connectionless, so we just send on it.
    socket_sendto($socket, $packet, strlen($packet), 0x100, $host, 69);

    $buffer = '';
    $port = '';
    $ret = '';
    do
    {
      // $buffer and $port both come back with information for the ack
      // 516 = 4 bytes for the header + 512 bytes of data
      socket_recvfrom($socket, $buffer, 516, 0, $host, $port);

      // add the block number from the data packet to the ack packet
      $packet = chr(0) . chr(4) . substr($buffer, 2, 2);
      // send ack
      socket_sendto($socket, $packet, strlen($packet), 0, $host, $port);

      // append the data to the return variable
      // for large files this function should take a file handle as an arg
      $ret .= substr($buffer, 4);
    }
    while(strlen($buffer) == 516);  // the first non-full packet is the last.
    return $ret;
  }
?> 
```

这种方法最有趣的部分是：

```
do
...
while(strlen($buffer) == 516);  // the first non-full packet is the last. 
```

# c# - 将字符串转换为类名

> ID：493490
> 
> 赞同：48
> 
> 时间：2009-01-29T21:21:18.373
> 
> 标签：c#, .net

我有一个表示自定义类名称的字符串变量。例子：

```
string s = "Customer"; 
```

我将需要创建一个客户数组列表。所以，需要的语法是：

```
List<Customer> cust = new .. 
```

如何转换字符串 s 以便能够在运行时创建此数组列表？

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2009-01-29T21:27:55.520

好吧，一方面`ArrayList`不是通用的……你的意思是`List<Customer>`？

您可以使用通过名称`Type.GetType(string)`获取`Type`与类型关联的对象。如果程序集不是 mscorlib 或当前执行的类型，则需要包含程序集名称。无论哪种方式，您都需要命名空间。

你确定你真的需要一个泛型类型吗？泛型主要提供*编译时*类型安全，如果您在执行时找到类型，显然您不会有太多。你*可能会*发现它很有用......

```
Type elementType = Type.GetType("FullyQualifiedName.Of.Customer");
Type listType = typeof(List<>).MakeGenericType(new Type[] { elementType });

object list = Activator.CreateInstance(listType); 
```

如果你需要对该列表*做*任何事情，你可能需要做更多的通用反射……例如调用通用方法。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-01-29T21:28:28.093

这是一个反思问题。您需要找到类型，然后实例化它的一个实例，如下所示：

```
Type hai = Type.GetType(classString,true);
Object o = (Activator.CreateInstance(hai));  //Or you could cast here if you already knew the type somehow 
```

或者， CreateInstance(assemblyName, className)

不过，您需要注意命名空间/类型冲突，但这对于一个简单的场景就可以解决问题。

此外，将其包装在 try/catch 中！Activator.CreateInstance 很可怕！

# sql - 从规则到成本的 Oracle 10 优化器：为什么？

> ID：493492
> 
> 赞同：4
> 
> 时间：2009-01-29T21:22:33.443
> 
> 标签：sql, oracle, optimization

Oracle 决定从 10g 版本中取消基于规则的优化器，而将基于成本的优化器作为唯一的选择。

我认为基于规则的优化器具有总是**可预测**的无价值的积极方面。相反，我看到 Oracle 10g 每天都在更改执行计划，从而导致类似乌龟的性能。

这可能是这种变化背后的基本原理？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-29T21:29:12.413

因为你能做的一切`RBO`，都可以做`CBO`。

`CBO`也可以是基于规则的——不仅如此，你可以自己决定“规则” 。

要创建自己的“规则”，您可以提示您的查询或执行一个提示您的查询[`CREATE OUTLINE`](https://docs.oracle.com/cd/B19306_01/server.102/b14200/statements_6005.htm)。因此，您的执行计划是稳定的。

大纲存储在名为 的系统模式中`OUTLN`，它们是可编辑的。

至于我，我总是为在生产数据库中运行的查询提供提示。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-29T23:42:31.880

RBO 已被弃用很长时间；它实际上只是为了向后兼容遗留应用程序而保留。自大约 10 年前发布的 (IIRC) 版本 8 以来，甲骨文一直在宣布 RBO 的消亡。

RBO 是确定性的，但并不是那么聪明。Oracle 最初是在基于成本的优化器出现之前设计的，更不用说成熟的技术了。RBO 被冻结了很长时间，不支持现代 Oracle 引擎的很多特性。

基于成本的优化要聪明得多。但是，如果您有针对 RBO 优化的查询，它们可能无法很好地与 CBO 配合使用。您可能必须适当地重写或提示您的查询以针对 CBO 调整它们。还有一个工具可以指定查询计划并用该计划覆盖 CBO。这将为您提供具有稳定计划的确定性查询执行。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-29T21:49:37.287

RBO 通常既可预测的坏也可预测的好。它也不支持分区和其他一些数据库功能。CBO 要好得多，正如 Quassnoi 所说，计划稳定性也是 CBO 的一个特点。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-29T22:15:07.453

（我不是 DBA。）

我的理解是，Oracle 长期以来一直[在远离](https://rads.stackoverflow.com/amzn/click/com/1590596366)RBO，转而支持 CBO。停止支持不再处于积极开发中的功能（考虑到足够长的折旧期）对我来说似乎很有用，以便每个人都使用最有效的功能。

有趣的是，您将可预测性称为使用基于规则的优化器的“无价值”效果。似乎当数据更改以使执行计划次优时，最好切换到新的。只有在您提到优化器在两个执行计划之间触发的情况下，才会出现为您实际查询的数据选择最佳计划的问题。我不确定在更正常的情况下可预测性有什么优势。

结束对过时优化器的支持应该可以释放对更新优化器的支持。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-29T23:30:59.533

我认为您应该进行基于规则的编程。不要考虑情况，遵循一系列不可侵犯的规则，无论是什么情况，无论你认为什么是更好的方法，如果规则说在 case X 中使用 FOR LOOP 那么你必须使用循环，即使你知道是否只有 1，从 1 循环到 1。

规定：

每个查询都有一个最佳计划。

每个查询优化器将确定该计划 x% 的时间。

RBO 无处可去，它的准确率百分比肯定低于 CBO，但它永远不会变得更好。它像任何基于规则的系统一样受到限制。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-29T23:10:36.033

他们转向基于成本的优化的原因是它可以更好地执行，因为它基于分析基于规则的优化器没有的统计信息。

为了使 CBO 更好地工作，了解统计数据收集在直接影响性能的执行计划更改中所起的作用很重要。一方面，或多或少地运行统计数据可以帮助您。这是一篇关于 CBO 和统计的好文章：

[优化 Oracle 优化器统计信息](http://www.dba-oracle.com/art_orafaq_cbo_stats.htm "优化 Oracle 优化器统计信息")

# java - 使负数为正

> ID：493494
> 
> 赞同：170
> 
> 时间：2009-01-29T21:22:50.947
> 
> 标签：java, negative-number

我有一个 Java 方法，我在其中对一组数字求和。但是，我希望将任何负数视为正数。所以 (1)+(2)+(1)+(-1) 应该等于 5。

我确信有很简单的方法可以做到这一点——我只是不知道怎么做。

* * *

## 回答 #1

> 赞同：422
> 
> 时间：2009-01-29T21:25:02.267

只需调用[Math.abs 即可](https://docs.oracle.com/javase/8/docs/api/java/lang/Math.html#abs-int-)。例如：

```
int x = Math.abs(-5); 
```

这将设置`x`为`5`.

请注意，如果您通过`Integer.MIN_VALUE`，将返回相同的值（仍然为负），因为 的范围`int`不允许表示正等价。

* * *

## 回答 #2

> 赞同：108
> 
> 时间：2009-01-29T21:25:17.460

您所描述的概念称为“绝对值”，Java 有一个名为[Math.abs](http://java.sun.com/javase/6/docs/api/java/lang/Math.html#abs(int))的函数可以为您完成。或者你可以避免函数调用并自己做：

```
number = (number < 0 ? -number : number); 
```

或者

```
if (number < 0)
    number = -number; 
```

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2009-01-29T21:25:43.560

你在寻找绝对价值，伙计。`Math.abs(-5)`返回 5...

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-01-29T21:25:23.560

使用`abs`功能：

```
int sum=0;
for(Integer i : container)
  sum+=Math.abs(i); 
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2016-10-09T00:32:23.933

试试这个（x 前面的负数是有效的，因为它是一元运算符，在[这里](https://docs.oracle.com/javase/tutorial/java/nutsandbolts/op1.html)找到更多）：

```
int answer = -x; 
```

有了这个，你可以把积极的变成消极的，把消极的变成积极的。

* * *

**但是**，如果您只想将负数设为正数，请尝试以下操作：

```
int answer = Math.abs(x); 
```

* * *

**一个很酷的数学技巧！**将数字平方将保证 x^2 的正值，然后，取平方根将得到 x 的绝对值：

```
int answer = Math.sqrt(Math.pow(x, 2)); 
```

希望能帮助到你！祝你好运！

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2011-03-07T14:02:41.890

> 在正数上调用此代码是**不安全的。**

```
int x = -20
int y = x + (2*(-1*x));
// Therefore y = -20 + (40) = 20 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-01-29T21:25:14.263

你问的是绝对值吗？

Math.abs(...) 是您可能想要的功能。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2009-01-29T21:25:44.747

您想将每个数字包装成`Math.abs()`. 例如

```
System.out.println(Math.abs(-1)); 
```

打印出“1”。

如果您想避免编写`Math.`-part，可以静态包含 Math 实用程序。写吧

```
import static java.lang.Math.abs; 
```

连同您的导入，您可以`abs()`通过编写来引用 -function

```
System.out.println(abs(-1)); 
```

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2009-01-29T21:25:41.003

最简单的，如果是冗长的方法是将每个数字包装在 Math.abs() 调用中，因此您将添加：

```
Math.abs(1) + Math.abs(2) + Math.abs(1) + Math.abs(-1) 
```

逻辑更改以反映您的代码的结构。可能很冗长，但它可以满足您的需求。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2013-09-11T15:25:12.287

当您需要表示一个没有丢失或缺失概念的值（负值）时，这称为“绝对值”。

* * *

获取绝对值的逻辑很简单：`"If it's positive, maintain it. If it's negative, negate it"`.

* * *

这意味着你的逻辑和代码应该像下面这样工作：

```
//If value is negative...
if ( value < 0 ) {
  //...negate it (make it a negative negative-value, thus a positive value).
  value = negate(value);
} 
```

* * *

有两种方法可以否定一个值：

1.  通过，好吧，否定它的价值：`value = (-value);`
2.  乘以“100% 负”或“-1”：`value = value * (-1);`

两者实际上是同一枚硬币的两个面。只是你通常不记得那`value = (-value);`实际上是`value = 1 * (-value);`.

* * *

好吧，至于你如何在 Java 中实际做到这一点，这非常简单，因为 Java 已经为此提供了一个函数，在`Math class`：`value = Math.abs(value);`

是的，没有`Math.abs()`它只是一行代码，数学非常简单，但是为什么让你的代码看起来很难看呢？只需使用 Java 提供的`Math.abs()`功能！他们提供它是有原因的！

如果您绝对需要跳过该函数，您可以使用`value = (value < 0) ? (-value) : value;`，它只是我在逻辑（3rd）部分中提到的代码的更紧凑版本，使用[三元运算符 ( `? :`)](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/operators.html)。

* * *

此外，在某些情况下，您可能希望始终在可能接收正值和负值的函数中表示丢失或缺失。

您可以简单地获取绝对值并将其取反，而不是进行一些复杂的检查：`negativeValue = (-Math.abs(value));`

* * *

考虑到这一点，并考虑像您这样的多个数字之和的情况，实现一个函数将是一个好主意：

```
int getSumOfAllAbsolutes(int[] values){
  int total = 0;
  for(int i=0; i<values.lenght; i++){
    total += Math.abs(values[i]);
  }
  return total;
} 
```

* * *

根据您可能再次需要相关代码的可能性，将它们添加到您自己的“utils”库中也可能是个好主意，首先将这些函数拆分为它们的核心组件，然后将最终函数简单地维护为一个调用嵌套核心组件现在拆分的功能：

```
int[] makeAllAbsolute(int[] values){
  //@TIP: You can also make a reference-based version of this function, so that allocating 'absolutes[]' is not needed, thus optimizing.
  int[] absolutes = values.clone();
  for(int i=0; i<values.lenght; i++){
    absolutes[i] = Math.abs(values[i]);
  }
  return absolutes;
}

int getSumOfAllValues(int[] values){
  int total = 0;
  for(int i=0; i<values.lenght; i++){
    total += values[i];
  }
return total;
}

int getSumOfAllAbsolutes(int[] values){
  return getSumOfAllValues(makeAllAbsolute(values));
} 
```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2012-02-22T12:14:14.640

你为什么不**`multiply that number with -1`**呢？

像这样：

```
//Given x as the number, if x is less than 0, return 0 - x, otherwise return x:
return (x <= 0.0F) ? 0.0F - x : x; 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2011-11-16T18:20:59.210

如果您对二进制补码的机制感兴趣，这里是绝对低效但说明性的低级方法：

```
private static int makeAbsolute(int number){
     if(number >=0){
        return number;
     } else{
        return (~number)+1;
     }
} 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2019-06-06T11:11:05.290

`Math.abs()`可以使用库函数。
`Math.abs()`返回参数的绝对值

> *   如果参数是否定的，则返回参数的否定。
> *   如果参数为正，则返回原样。

例如：

1.  `int x=-5;`
    `System.out.println(Math.abs(x));`

输出：5

2.  `int y=6;`
    `System.out.println(Math.abs(y));`

输出：6

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2011-03-16T15:24:58.407

```
String s = "-1139627840";
BigInteger bg1 = new BigInteger(s);
System.out.println(bg1.abs()); 
```

或者：

```
int i = -123;
System.out.println(Math.abs(i)); 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2014-01-04T09:31:57.157

我会推荐以下解决方案：

**没有库乐趣：**

```
 value = (value*value)/value 
```

*（以上实际上不起作用。）*

**与库乐趣：**

```
 value = Math.abs(value); 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2019-10-30T11:09:36.327

要将负数转换为正数（这称为绝对值），请使用 Math.abs()。这个 Math.abs() 方法是这样工作的

`“number = (number < 0 ? -number : number);".`

**在下面的示例中，`Math.abs(-1)`将负数 1 转换为正数 1。**

> 例子

公共静态无效主要（字符串[]参数）{

```
 int total = 1 + 1 + 1 + 1 + (-1);

    //output 3
    System.out.println("Total : " + total);

    int total2 = 1 + 1 + 1 + 1 + Math.abs(-1);

    //output 5
    System.out.println("Total 2 (absolute value) : " + total2);

} 
```

> ***输出***
> 
> 总计：3 总计 2（绝对值）：5

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2011-02-24T16:53:04.583

我需要 long 的绝对值，并深入研究 Math.abs 并发现如果我的参数小于 LONG.MIN_VAL 即 -9223372036854775808l，那么 abs 函数将不会返回绝对值，而只会返回最小值。在这种情况下，如果您的代码进一步使用此 abs 值，则可能存在问题。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2019-10-18T02:37:45.163

你能试试这个吗？

```
public static int toPositive(int number) {
    return number & 0x7fffffff;
} 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2020-09-15T19:36:27.143

```
if(arr[i]<0)

Math.abs(arr[i]);  //1st way (taking absolute value)

arr[i]=-(arr[i]); //2nd way (taking -ve of -ve no. yields a +ve no.)

arr[i]= ~(arr[i]-1);   //3rd way (taking negation) 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2020-10-10T16:17:07.920

我看到人们这么说，`Math.abs(number)`但这种方法并不完全证明。

当您尝试包装时，这会失败`Math.abs(Integer.MIN_VALUE)`（请参阅参考文献[https://youtu.be/IWrpDP-ad7g](https://youtu.be/IWrpDP-ad7g)）

如果您不确定是否会收到`Integer.MIN_VALUE`输入中的 。始终建议检查该号码并手动处理。

* * *

## 回答 #21

> 赞同：-1
> 
> 时间：2020-04-05T22:12:55.100

在 kotlin 中，您可以使用 unaryPlus

```
input = input.unaryPlus() 
```

[https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-int/unary-plus.html](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-int/unary-plus.html)

* * *

## 回答 #22

> 赞同：-1
> 
> 时间：2020-12-20T02:30:40.260

在 for 循环中试试这个：

```
sum += Math.abs(arr[i]) 
```

* * *

## 回答 #23

> 赞同：-3
> 
> 时间：2013-11-05T19:08:04.977

不要这样做

number = (number < 0 ? -number : number);

或者

if (number < 0) number = -number;

当您在代码上运行 find bug 时，这将是一个错误，它将报告为 RV_NEGATING_RESULT_OF

# iphone - 运行程序时保持 iphone 处于活动状态

> ID：493495
> 
> 赞同：37
> 
> 时间：2009-01-29T21:23:00.727
> 
> 标签：iphone, objective-c

如何在我的应用程序运行时将 iPhone 设备设置为保持活动状态（不锁定）？任何的想法

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2009-01-29T21:28:42.370

我不确定这是否会阻止设备锁定，但您可以使用`UIApplication`'[`idleTimerDisabled`](http://developer.apple.com/iphone/library/documentation/UIKit/Reference/UIApplication_Class/Reference/Reference.html#//apple_ref/occ/instp/UIApplication/idleTimerDisabled)属性阻止屏幕变暗：

```
[UIApplication sharedApplication].idleTimerDisabled = YES; 
```

从文档中：

> **重要提示**：您应该仅在必要时设置此属性，并且应确保在不再需要时将其重置为 NO。大多数应用程序应该让系统在空闲计时器结束时关闭屏幕。这包括音频应用程序。通过适当使用音频会话服务，当屏幕关闭时，播放和录制不会中断。唯一应该禁用空闲计时器的应用程序是映射应用程序、游戏或具有零星用户交互的类似程序。

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2009-01-29T21:28:14.943

此代码将防止您的 iPhone 在您的应用程序运行时进入睡眠状态

```
// avoid sleeping when this application is running
UIApplication *application = [UIApplication sharedApplication];
application.idleTimerDisabled = YES;
// Or simpler
[[UIApplication sharedApplication] setIdleTimerDisabled: YES]; 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-12-14T09:13:10.057

如果你来到这里寻找 Swift 的答案，那就是：

```
UIApplication.sharedApplication().idleTimerDisabled = true 
```

**斯威夫特 3**

```
UIApplication.shared.isIdleTimerDisabled = true 
```

[此评论中的警告仍然适用。](https://stackoverflow.com/a/493522/5041820)

# asp.net - 使用母版页在 ASP.NET 中从 @ Page 指令设置页面标题

> ID：493498
> 
> 赞同：2
> 
> 时间：2009-01-29T21:24:37.477
> 
> 标签：asp.net, vb.net, master-pages

我正在使用母版页，并且无法从 @ Page 指令设置页面标题。我的所有类都继承自一个类*myPage*，该类继承自 ASP.NET *System.Web.UI.Page*类。**请注意：**我在母版页的头部标签中设置了**runat="server" 。**

**这是文件test.aspx.vb**我的 @Page指令的样子：

```
<%@ Page language="VB" MasterPageFile="~/MainMaster.master" 
autoeventwireup="false" CodeFile="test.aspx.vb" 
Inherits="test" Title="test" %> 
```

下面是**test.aspx.vb**的样子：

```
Partial Class test
    Inherits myPage

    Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load

    End Sub

End Class 
```

这是我的主文件**MainMaster.master**的样子：

```
<%@ Master Language="VB" CodeFile="MainMaster.master.vb" Inherits="MainMaster" %>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
   "http://www.w3.org/TR/html4/strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head runat="server">
    <title>untitled</title>
</head>
... 
```

现在，当您在浏览器中查看**test.aspx**时，您希望看到标题“test”。但相反，您会根据母版页看到“无标题”。通过反复试验，我将*测试*类修改为直接从*System.Web.UI.Page继承，而不是像这样的**myPage*：

```
Partial Class test
    Inherits Page

    Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load

    End Sub

End Class 
```

一切正常。为什么我的页面是*myPage*而不是*System.Web.UI.Page*的子页面会阻止在 @ Page 指令中正确设置标题？

我意识到我可以通过每个页面中的*Page_Load*方法以编程方式设置页面标题，但我宁愿在 .aspx 文件中的 @Page 指令中进行设置。

这是一个非常奇怪和令人沮丧的问题，我很茫然！

谢谢！！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-30T18:45:48.080

我感谢大家的帮助；我找到了解决方案。问题是*myPage*类有一个 Title 属性，但是在 Set 属性的部分中并没有将更改传递给*Page.Title*，因为它应该是。

一行更改解决了我的问题:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-30T14:34:59.753

您的基本页面 (myPage.vb) 中有哪些方法。

如果您要覆盖任何默认方法，您是在调用这些页面的基本版本吗？

在 C# 中我会有这样的东西：

```
protected override void OnInit(EventArgs e)
{
    // Do my custom processing.

    // Don't forget to call base OnInit here:
    base.OnInit(e);
} 
```

如果您不调用这些方法，那么在它们中为您发生的事件（例如连接母版页的标题）将不会触发。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-29T21:36:06.283

我有一个和你非常相似的设置。我的内容页面继承自自定义基本页面，该页面本身继承自页面。我对在 aspx 上设置的标题并在浏览器中显示没有任何问题。我在我的代码和你的代码之间看到的唯一区别是我的母版页有 autoeventwireup 属性，而你的母版页没有，而且你的母版页有一个名为 codefile 的属性，而我的有 codebehind。

**内容页：**

```
<%@ Page Title="Login to Application X" Language="vb" AutoEventWireup="false" MasterPageFile="~/masterpages/mymasterpage.Master"
    CodeBehind="login.aspx.vb" Inherits=".login" %> 
```

**母版页：**

```
<%@ Master Language="VB" AutoEventWireup="false" CodeBehind="mymasterpage.master.vb"
    Inherits=".mymasterpage" %> 
```

# graphics - 带有 BitBlt 帮助的双缓冲 VB6

> ID：493506
> 
> 赞同：1
> 
> 时间：2009-01-29T21:25:42.390
> 
> 标签：graphics, vb6, gdi

编辑：我更新了第 2 版。现在它是单色的。我试图通过确保`CreateCOmpatibleBitmap`使用窗口的 DC 而不是 memdc（如所写）调用来修复它，但它仍然是错误的 :(

以下是我编写的 3 个不同简化版本的函数。版本 1 完美运行（但显然有闪烁），版本 2 什么都不做，版本 3 用黑色填充整个表格。版本 2 有什么问题？Scalemode 设置为 vbPixels。

版本 1：

```
Private Sub Form_Paint()
    Me.Cls
    DrawStuff Me.hDc
End Sub 
```

版本 2（新）：

```
Private Sub Form_Paint()
    Me.Cls
    If m_HDCmem = 0 then
        m_HDC = GetDC(hwnd)
        m_HDCmem = CreateCompatibleDC(m_HDC)
        m_HBitmap = CreateCompatibleBitmap(m_HDC, Me.ScaleWidth, Me.ScaleHeight)
        ReleaseDC Null, m_HDC
        SelectObject m_HDCmem, m_HBitmap
    End If
    DrawStuff m_HDCmem
    Debug.Print BitBlt(Me.hDc, 0, 0, Me.ScaleWidth, Me.ScaleHeight, m_HDCmem, 0, 0, SRCCOPY) 'During testing, this printed "1"
    Me.Refresh
End Sub 
```

版本 3：

```
Private Sub Form_Paint()
    Me.Cls
    If m_HDC = 0 Then m_HDC = CreateCompatibleDC(Me.hDc)
    DrawStuff m_HDC
    BitBlt(Me.hDc, 0, 0, Me.ScaleWidth, Me.ScaleHeight, m_HDC, 0, 0, BLACKNESS) 'During testing, this printed "1"
    Me.Refresh
End Sub 
```

注意：在调用绘画之前，我将下面的代码粘贴在我的调整大小函数中。它没有帮助，但我很确定我应该把它留在那里：

```
If m_HDC <> 0 Then DeleteDC m_HDC
m_HDC = 0 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-29T21:58:55.567

在第 2 版和第 3 版中，您对 CreateCompatibleDC() 的调用构建了一个 1 像素乘 1 像素的单色绘图表面。您需要在其中的某处调用 CreateCompatibleBitmap()。

看[这里](http://msdn.microsoft.com/en-us/library/aa922550.aspx)

# visual-studio-2008 - 为什么我的服务引用只生成异步方法？

> ID：493510
> 
> 赞同：8
> 
> 时间：2009-01-29T21:26:14.463
> 
> 标签：visual-studio-2008, wcf, silverlight, web-services

我在 VS2008 中有一个我没有编写的 Web 服务的服务参考（不是 Web 参考）。参考有效，但只有每种方法的异步版本可供我使用。

在“配置服务参考”对话框中，“生成异步操作”被选中并显示为灰色。首先，我认为选中此框会生成异步方法，而不是阻塞方法。其次，我以前从未见过它变灰。

我有编写 WCF 和 ASMX 时代 Web 服务双方的经验，以前从未见过。这可能是什么原因造成的？

谢谢。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-29T22:10:06.200

我愿意投 10 票赞成，因为你在 Silverlight 中这样做。不幸的是，我没有安装工具，所以我无法测试这个理论，但我知道 Silverlight 的服务调用只能是异步的。也许您正在使用 Silverlight 项目模板并在那里创建服务引用？Visual Studio 可能足够聪明，知道在这种情况下不会生成阻塞方法。

以供参考：

[http://msdn.microsoft.com/en-us/library/cc197937(VS.95).aspx](http://msdn.microsoft.com/en-us/library/cc197937(VS.95).aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-30T10:27:41.813

Silverlight 插件在浏览器 UI 线程上运行。如果您进行同步网络调用，您将阻塞整个浏览器 UI 线程。在 Chrome 中，这将导致标签页无响应，在 IE 等其他浏览器中，整个浏览器将显示为锁定状态。

因此，通过仅支持异步网络，您被迫以异步方式编写应用程序。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-30T00:47:02.610

Silverlight 仅生成异步服务调用。但是请检查此[CodeProject 页面](http://www.codeproject.com/KB/silverlight/SynchronousSilverlight.aspx)。

当我开始与 Silverlight 合作时，一开始它让我很震惊。然后我意识到我应该更改我的代码以使用异步模型。您不想在等待服务调用返回时阻塞 UI 线程。

# c# - 开源项目设置

> ID：493513
> 
> 赞同：3
> 
> 时间：2009-01-29T21:26:52.170
> 
> 标签：c#, .net, open-source, project

我想在 .NET 中建立一个开源社区项目，我该怎么做？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-29T21:37:33.350

在我的项目中，我首先选择了众多开源许可证之一（与[Apache 2.0](http://www.apache.org/licenses/LICENSE-2.0.html)一起使用）。然后我`LICENSE`在我的项目中添加了一个 -file，在那里复制/粘贴了许可证，并对每个源文件执行了“必需”标题。

之后，我选择了一个项目平台（或 watchamacallit）。我跳过了[SourceForge](http://sourceforge.net)而选择了[Google Code](http://code.google.com/)，后来搬到了[Assembla](http://www.assembla.com) + [GitHub](http://github.com)。我将我的源代码升级到提供的 SCM 系统（第一个[SVN](http://subversion.tigris.org/)，后来是[Git](http://git-scm.com/)）。

唉，困难的部分不是选择许可证、公开你的源代码、将你的东西记录到 wiki 或写票。困难的部分是围绕您的项目建立（成功的）社区。为此，您需要一个有趣的项目、对您的有趣项目感兴趣的人以及将这些点连接在一起的平台。一点运气和/或声誉不会受到伤害，至少不是。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-29T21:48:47.163

*   选择您希望发布的许可证（bsd、gpl 等）
*   添加 README.txt、LICENSE.txt
*   免费公共托管有很多不错的选择。你可以在这里看到很多好的评论：

    > [https://stackoverflow.com/questions/29736/what-open-source-hosting-service-should-i-use](https://stackoverflow.com/questions/29736/what-open-source-hosting-service-should-i-use)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-29T21:35:06.990

www.codeplex.com 将是另一个不错的起点。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-29T21:32:38.897

去：

[http://code.google.com/hosting/](http://code.google.com/hosting/)

并按照以下说明进行操作：

*创建一个新的项目*链接。

您也可以使用其他门户。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-29T21:33:44.993

您想在 SourceForge 或 Github 上创建一个存储库（我知道这两个，可能还有其他）。那将是第一步。

建立一个博客，如果你还没有博客，并在博客上写下你的进步、挫折和旅途中的一切，也有一些好处。它将作为您未来项目的自我说明。对于其他想要做类似事情的人来说，这也将是一件好事，并将其视为路线图。最后，这是让您的项目越来越感兴趣的好方法。

您可能还想查看 Mono 项目 ( [http://www.mono-project.com/Main_Page](http://www.mono-project.com/Main_Page) ) 并使用它而不是 Visual Studio，以便其他人加入您的项目时没有障碍。这些 Visual Studio 许可证并不便宜，而且 Mono 是免费的。虽然我已经有一段时间没有使用 Mono 环境了，但我听到了很多关于它的好消息。

我希望这对您有所帮助并祝您好运。

# php - 包括 file_exists 安全性

> ID：493531
> 
> 赞同：1
> 
> 时间：2009-01-29T21:31:04.267
> 
> 标签：php, security, include

```
/* 定义页面路径 */
定义（“PAGE_DIR”，“页/”）；

if (file_exists(PAGE_DIR."$_GET[page].php")) include(PAGE_DIR."$_GET[page].php");

```

这有多安全？例如，如果页面位于名为 pages 的文件夹中，您能否在另一个 Web 服务器上包含该页面？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-29T21:36:17.237

这根本不安全 - 想想如果`$_GET[page]`包含会发生什么`../../../somewhere/else/`

您应该明确列出允许的页面。

编辑：我认为它不能包含来自不同服务器的文件，但这仍然不是一件好事。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-29T21:49:41.873

将未经处理的用户输入直接传递给命令从来都不是一个好习惯，尤其是像 include() 这样的命令。您不一定知道底层网络服务器/操作系统将如何处理，例如，相对路径、扩展字符等。任何这些，无论是恶意使用还是以其他方式使用，都可能导致用户看到他们不应该看到的东西看。

一种可能的利用方式：用户将相对路径传递到服务器上已知位置的恶意脚本。[http://webserver/yourscript.php?page=%2e%2e%2f%2e%2e%2f%2e%2e%2fhome/bad_user/evil_script](http://webserver/yourscript.php?page=%2e%2e%2f%2e%2e%2f%2e%2e%2fhome/bad_user/evil_script)

您的函数可以将其转换为 pages/../../../home/bad_user/evil_script.php，其中 include 有时会很高兴地包括在内。所以你的网页在服务时可以很好地执行 bad_user 的 php 脚本，他可以用它来做各种讨厌的事情。

至少您应该将 $_GET['path'] 分配给一个新变量并添加斜杠（）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-29T21:43:20.967

在验证/清理数据之前使用 $_GET 或 $_POST做*任何事情都是危险的。*假设所有用户都想找你，并在使用数据之前对其进行清理。

# visual-studio - VS反汇编窗口是否显示整个EXE？

> ID：493534
> 
> 赞同：2
> 
> 时间：2009-01-29T21:31:36.810
> 
> 标签：visual-studio, disassembly

一个客户正在运行我公司的程序，它在到达任何地方之前就停止了。他们从 Windows 事件日志中发送了这些信息：

```
faulting module program.exe, version 1.2.3.4, fault address 0x00054321. 
```

我们没有太多其他工作要做，所以作为最后的努力，我一直试图看看我是否能找到反汇编程序中的那个位置。我通过 Visual Studio 运行程序，暂停它，查看反汇编窗口并尝试滚动到该地址，但我得到的只是：

```
00054321  ???              
00054322  ???              
00054323  ???              
00054324  ???              
00054325  ???              
00054326  ???              
00054327  ???              
00054328  ???              
00054329  ???              
0005432A  ??? 
```

这是因为 Visual Studio 只在暂停位置附近反汇编了部分 EXE 吗？我很难看清实际拆解了多少，因为滚动条不能完全工作。（我无法抓取和移动滚动位置；我必须逐行或逐页滚动。）

感谢您提供的任何见解！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-29T21:36:51.510

故障地址也可能是由堆栈损坏问题引起的，即。返回地址可能会被破坏并跳回到错误的地址@ 0x54321。此外，根据使用的技术（Java、.NET），代码可能会在运行之间改变它的位置。

Visual Studio 对整个过程空间进行了拆解。？？？表示该位置不可访问。

您最好需要一个堆栈框架来从核心转储中查看正在发生的事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-29T21:40:16.090

WinDbg 在这里可能是您的朋友，您可以在那里加载可执行文件和符号 (.pdb)，如果您可以获得 QbProg 所说的（迷你）转储，那肯定会简化搜索。但是我有过在 WinDbg 中更容易做到这一点的经验。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-29T21:54:01.087

您希望在反汇编窗口中看到什么？这种方法行不通。如果您能够重建与您的客户端正在运行的完全相同的构建配置，那么您可以在项目的链接选项中启用[/MAP](http://msdn.microsoft.com/en-us/library/k7xkk3e2(VS.80).aspx)选项。这将创建一个将符号映射到地址的文件，并允许您查看崩溃发生时正在执行的函数。您可能需要进行一些计算，以将原始映射地址与客户端 PC 上加载模块的地址进行偏移。

正如 Fredrik 所说，WinDbg 也可以提供帮助，特别是如果您可以从客户的 PC 中获取故障转储。

# c# - 一个可执行文件可以同时是控制台和 GUI 应用程序吗？

> ID：493536
> 
> 赞同：88
> 
> 时间：2009-01-29T21:32:07.680
> 
> 标签：c#, user-interface, command-line-interface

我想制作一个可以作为 CLI 或 GUI 应用程序运行的[C#](http://en.wikipedia.org/wiki/C_Sharp_%28programming_language%29)程序，具体取决于传递给它的标志。这可以做到吗？

我发现了这些相关的问题，但它们并没有完全涵盖我的情况：

*   [如何在 GUI 应用程序中写入控制台](https://stackoverflow.com/questions/192294/how-to-write-to-the-console-in-a-gui-application)
*   [如何使用 Windows 程序在 C++ 中获取控制台输出？](https://stackoverflow.com/questions/191842/how-do-i-get-console-output-in-c-with-a-windows-program)

* * *

## 回答 #1

> 赞同：108
> 
> 时间：2009-01-29T23:54:32.357

[Jdigital 的回答](https://stackoverflow.com/questions/493536/can-one-executable-be-both-a-console-and-gui-app/493568#493568)指向[Raymond Chen 的博客](https://devblogs.microsoft.com/oldnewthing/20090101-00/?p=19643)，这解释了为什么你不能拥有一个既是控制台程序又是非控制台程序的应用`*`程序：操作系统需要*在程序开始运行之前*知道要使用哪个子系统。一旦程序开始运行，返回并请求其他模式为时已晚。

[Cade 的回答](https://stackoverflow.com/questions/493536/can-one-executable-be-both-a-console-and-gui-app/493556#493556)指向[一篇关于使用控制台运行 .Net WinForms 应用程序的文章](http://www.csharp411.com/console-output-from-winforms-application/)。[`AttachConsole`](http://msdn2.microsoft.com/en-us/library/ms681952.aspx)它使用程序开始运行后调用的技术。这具有允许程序写回启动程序的命令提示符的控制台窗口的效果。但是那篇文章中的评论指出了我认为是致命的缺陷：*子进程并没有真正控制控制台。*控制台继续代表父进程接受输入，而父进程不知道它应该等待子进程完成运行，然后才能使用控制台进行其他操作。

Chen 的文章指向[Junfeng Zhang 的一篇文章，该文章解释了其他一些技术](http://blogs.msdn.com/junfeng/archive/2004/02/06/68531.aspx)。

第一个是*devenv*使用的。它实际上是通过两个程序来工作的。一个是*devenv.exe*，它是主要的 GUI 程序，另一个是*devenv.com*，它处理控制台模式任务，但如果它以非控制台方式使用，它会将其任务转发给*devenv.exe*和退出。该技术依赖于 Win32 规则，即当您键入没有文件扩展名的命令时， *com文件会在**exe*文件之前被选择。

Windows Script Host 有一个更简单的变体。它提供了两个完全独立的二进制文件*wscript.exe*和*cscript.exe*。同样，Java为控制台程序提供*java.exe*，为非控制台程序提供*javaw.exe 。*

君峰的第二招，就是*ildasm*使用的。他引用了*il​​dasm*的作者在两种模式下运行时所经历的过程。最终，这就是它的作用：

1.  该程序被标记为控制台模式二进制文件，因此它始终以控制台开始。这允许输入和输出重定向正常工作。
2.  如果程序没有控制台模式命令行参数，它会重新启动自己。

`FreeConsole`仅仅调用使第一个实例不再是控制台程序是不够的。这是因为启动程序*cmd.exe*的进程“知道”它启动了一个控制台模式程序并正在等待程序停止运行。调用`FreeConsole`会使*ildasm*停止使用控制台，但不会使父进程*开始*使用控制台。

因此，第一个实例会自行重新启动（我想带有一个额外的命令行参数）。当您调用 时`CreateProcess`，有两个不同的标志可以尝试，[`DETACHED_PROCESS`和`CREATE_NEW_CONSOLE`](http://msdn.microsoft.com/en-us/library/ms684863.aspx)，其中任何一个都将确保第二个实例不会附加到父控制台。之后，第一个实例可以终止并允许命令提示符恢复处理命令。

这种技术的副作用是当您从 GUI 界面启动程序时，仍然会有一个控制台。它会在屏幕上短暂闪烁，然后消失。

君峰的文章中关于使用*editbin*更改程序的控制台模式标志的部分是一个红鲱鱼，我认为。您的编译器或开发环境应该提供一个设置或选项来控制它创建哪种二进制文件。之后应该不需要修改任何东西。

那么，底线是**您可以拥有两个二进制文件，也可以让控制台窗口瞬间闪烁**。一旦你决定哪个是较小的邪恶，你就可以选择实现。

`*`我说*非控制台*而不是*GUI*，因为否则它是错误的二分法。程序没有控制台并不意味着它有 GUI。服务应用程序就是一个很好的例子。此外，程序可以有控制台*和*窗口。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-01-29T21:40:04.140

查看 Raymond 关于此主题的博客：

[https://devblogs.microsoft.com/oldnewthing/20090101-00/?p=19643](https://devblogs.microsoft.com/oldnewthing/20090101-00/?p=19643)

他的第一句话：“你不能，但你可以试着伪造它。”

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-29T21:36:57.203

[http://www.csharp411.com/console-output-from-winforms-application/](http://www.csharp411.com/console-output-from-winforms-application/)

只需在 WinForms 内容之前检查命令行参数`Application.`。

我应该补充一点，在 .NET 中，简单地在同一个解决方案中创建一个控制台和 GUI 项目是非常容易的，这些项目共享除 main 之外的所有程序集。在这种情况下，您可以让命令行版本简单地启动 GUI 版本，如果它是在没有参数的情况下启动的。你会得到一个闪烁的控制台。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-03-16T11:45:15.953

有一种简单的方法可以做你想做的事。在编写应该同时具有 CLI 和 GUI 的应用程序时，我总是使用它。您必须将“OutputType”设置为“ConsoleApplication”才能使其正常工作。

```
class Program {
  [DllImport("kernel32.dll", EntryPoint = "GetConsoleWindow")]
  private static extern IntPtr _GetConsoleWindow();

  /// <summary>
  /// The main entry point for the application.
  /// </summary>
  [STAThread]
  static void Main(string[] args) {
    Application.EnableVisualStyles();
    Application.SetCompatibleTextRenderingDefault(false);

    /*
     * This works as following:
     * First we look for command line parameters and if there are any of them present, we run the CLI version.
     * If there are no parameters, we try to find out if we are run inside a console and if so, we spawn a new copy of ourselves without a console.
     * If there is no console at all, we show the GUI.
     * We make an exception if we find out, that we're running inside visual studio to allow for easier debugging the GUI part.
     * This way we're both a CLI and a GUI.
     */
    if (args != null && args.Length > 0) {

      // execute CLI - at least this is what I call, passing the given args.
      // Change this call to match your program.
      CLI.ParseCommandLineArguments(args);

    } else {
      var consoleHandle = _GetConsoleWindow();

      // run GUI
      if (consoleHandle == IntPtr.Zero || AppDomain.CurrentDomain.FriendlyName.Contains(".vshost"))

        // we either have no console window or we're started from within visual studio
        // This is the form I usually run. Change it to match your code.
        Application.Run(new MainForm());
      else {

        // we found a console attached to us, so restart ourselves without one
        Process.Start(new ProcessStartInfo(Assembly.GetEntryAssembly().Location) {
          CreateNoWindow = true,
          UseShellExecute = false
        });
      }
    }
  } 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-07-05T17:40:18.957

我认为首选技术是 Rob 所说的使用两个可执行文件的*devenv*技术：启动器“.com”和原始“.exe”。如果你有样板代码可以使用，这并不难使用（见下面的链接）。

该技术使用技巧让“.com”成为 stdin/stdout/stderr 的代理并启动同名的 .exe 文件。这给出了允许程序在从控制台调用时以命令行模式执行的行为（可能仅在检测到某些命令行参数时），同时仍然能够作为没有控制台的 GUI 应用程序启动。

我在 Google Code 上托管了一个名为[dualsubsystem](http://code.google.com/p/dualsubsystem/ "双子系统")的项目，该项目更新了该技术的旧 codeguru 解决方案，并提供了源代码和工作示例二进制文件。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2015-09-18T08:52:52.453

这是我认为解决问题的简单 .NET C# 解决方案。只是为了重申问题，当您从带有开关的命令行运行应用程序的控制台“版本”时，即使您有`Environment.Exit(0)`在您的代码末尾。要解决这个问题，就在调用之前`Environment.Exit(0)`，调用这个：

```
SendKeys.SendWait("{ENTER}"); 
```

然后控制台获取返回命令提示符所需的最终 Enter 键，该过程结束。注意：不要调用`SendKeys.Send()`，否则应用会崩溃。

正如许多帖子中提到的那样，仍然需要调用`AttachConsole()`，但是在启动应用程序的 WinForm 版本时，我没有得到命令窗口闪烁。

这是我创建的示例应用程序中的完整代码（没有 WinForms 代码）：

```
using System;
using System.Windows.Forms;
using System.Runtime.InteropServices;

namespace ConsoleWriter
{
    static class Program
    {
        [DllImport("kernel32.dll")]
        private static extern bool AttachConsole(int dwProcessId);
        private const int ATTACH_PARENT_PROCESS = -1;

        [STAThread]
        static void Main(string[] args)
        {
            if(args.Length > 0 && args[0].ToUpperInvariant() == "/NOGUI")
            {
                AttachConsole(ATTACH_PARENT_PROCESS);
                Console.WriteLine(Environment.NewLine + "This line prints on console.");

                Console.WriteLine("Exiting...");
                SendKeys.SendWait("{ENTER}");
                Environment.Exit(0);
            }
            else
            {
                Application.EnableVisualStyles();
                Application.SetCompatibleTextRenderingDefault(false);
                Application.Run(new Form1());
            }
        }
    }
} 
```

希望它可以帮助某人在这个问题上也花费数天时间。感谢您的提示去@dantill。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-01-27T17:50:40.557

```
/*
** dual.c    Runs as both CONSOLE and GUI app in Windows.
**
** This solution is based on the "Momentary Flicker" solution that Robert Kennedy
** discusses in the highest-rated answer (as of Jan 2013), i.e. the one drawback
** is that the console window will briefly flash up when run as a GUI.  If you
** want to avoid this, you can create a shortcut to the executable and tell the
** short cut to run minimized.  That will minimize the console window (which then
** immediately quits), but not the GUI window.  If you want the GUI window to
** also run minimized, you have to also put -minimized on the command line.
**
** Tested under MinGW:  gcc -o dual.exe dual.c -lgdi32
**
*/
#include <windows.h>
#include <stdio.h>

static int my_win_main(HINSTANCE hInstance,int argc,char *argv[],int iCmdShow);
static LRESULT CALLBACK WndProc(HWND hwnd,UINT iMsg,WPARAM wParam,LPARAM lParam);
static int win_started_from_console(void);
static BOOL CALLBACK find_win_by_procid(HWND hwnd,LPARAM lp);

int main(int argc,char *argv[])

    {
    HINSTANCE hinst;
    int i,gui,relaunch,minimized,started_from_console;

    /*
    ** If not run from command-line, or if run with "-gui" option, then GUI mode
    ** Otherwise, CONSOLE app.
    */
    started_from_console = win_started_from_console();
    gui = !started_from_console;
    relaunch=0;
    minimized=0;
    /*
    ** Check command options for forced GUI and/or re-launch
    */
    for (i=1;i<argc;i++)
        {
        if (!strcmp(argv[i],"-minimized"))
            minimized=1;
        if (!strcmp(argv[i],"-gui"))
            gui=1;
        if (!strcmp(argv[i],"-gui-"))
            gui=0;
        if (!strcmp(argv[i],"-relaunch"))
            relaunch=1;
        }
    if (!gui && !relaunch)
        {
        /* RUN AS CONSOLE APP */
        printf("Console app only.\n");
        printf("Usage:  dual [-gui[-]] [-minimized].\n\n");
        if (!started_from_console)
            {
            char buf[16];
            printf("Press <Enter> to exit.\n");
            fgets(buf,15,stdin);
            }
        return(0);
        }

    /* GUI mode */
    /*
    ** If started from CONSOLE, but want to run in GUI mode, need to re-launch
    ** application to completely separate it from the console that started it.
    **
    ** Technically, we don't have to re-launch if we are not started from
    ** a console to begin with, but by re-launching we can avoid the flicker of
    ** the console window when we start if we start from a shortcut which tells
    ** us to run minimized.
    **
    ** If the user puts "-minimized" on the command-line, then there's
    ** no point to re-launching when double-clicked.
    */
    if (!relaunch && (started_from_console || !minimized))
        {
        char exename[256];
        char buf[512];
        STARTUPINFO si;
        PROCESS_INFORMATION pi;

        GetStartupInfo(&si);
        GetModuleFileNameA(NULL,exename,255);
        sprintf(buf,"\"%s\" -relaunch",exename);
        for (i=1;i<argc;i++)
            {
            if (strlen(argv[i])+3+strlen(buf) > 511)
                break;
            sprintf(&buf[strlen(buf)]," \"%s\"",argv[i]);
            }
        memset(&pi,0,sizeof(PROCESS_INFORMATION));
        memset(&si,0,sizeof(STARTUPINFO));
        si.cb = sizeof(STARTUPINFO);
        si.dwX = 0; /* Ignored unless si.dwFlags |= STARTF_USEPOSITION */
        si.dwY = 0;
        si.dwXSize = 0; /* Ignored unless si.dwFlags |= STARTF_USESIZE */
        si.dwYSize = 0;
        si.dwFlags = STARTF_USESHOWWINDOW;
        si.wShowWindow = SW_SHOWNORMAL;
        /*
        ** Note that launching ourselves from a console will NOT create new console.
        */
        CreateProcess(exename,buf,0,0,1,DETACHED_PROCESS,0,NULL,&si,&pi);
        return(10); /* Re-launched return code */
        }
    /*
    ** GUI code starts here
    */
    hinst=GetModuleHandle(NULL);
    /* Free the console that we started with */
    FreeConsole();
    /* GUI call with functionality of WinMain */
    return(my_win_main(hinst,argc,argv,minimized ? SW_MINIMIZE : SW_SHOWNORMAL));
    }

static int my_win_main(HINSTANCE hInstance,int argc,char *argv[],int iCmdShow)

    {
    HWND        hwnd;
    MSG         msg;
    WNDCLASSEX  wndclass;
    static char *wintitle="GUI Window";

    wndclass.cbSize        = sizeof (wndclass) ;
    wndclass.style         = CS_HREDRAW | CS_VREDRAW;
    wndclass.lpfnWndProc   = WndProc;
    wndclass.cbClsExtra    = 0 ;
    wndclass.cbWndExtra    = 0 ;
    wndclass.hInstance     = hInstance;
    wndclass.hIcon         = NULL;
    wndclass.hCursor       = NULL;
    wndclass.hbrBackground = NULL;
    wndclass.lpszMenuName  = NULL;
    wndclass.lpszClassName = wintitle;
    wndclass.hIconSm       = NULL;
    RegisterClassEx (&wndclass) ;

    hwnd = CreateWindowEx(WS_EX_OVERLAPPEDWINDOW,wintitle,0,
                          WS_VISIBLE|WS_OVERLAPPEDWINDOW,
                          100,100,400,200,NULL,NULL,hInstance,NULL);
    SetWindowText(hwnd,wintitle);
    ShowWindow(hwnd,iCmdShow);
    while (GetMessage(&msg,NULL,0,0))
        {
        TranslateMessage(&msg);
        DispatchMessage(&msg);
        }
    return(msg.wParam);
    }

static LRESULT CALLBACK WndProc (HWND hwnd,UINT iMsg,WPARAM wParam,LPARAM lParam)

    {
    if (iMsg==WM_DESTROY)
        {
        PostQuitMessage(0);
        return(0);
        }
    return(DefWindowProc(hwnd,iMsg,wParam,lParam));
    }

static int fwbp_pid;
static int fwbp_count;
static int win_started_from_console(void)

    {
    fwbp_pid=GetCurrentProcessId();
    if (fwbp_pid==0)
        return(0);
    fwbp_count=0;
    EnumWindows((WNDENUMPROC)find_win_by_procid,0L);
    return(fwbp_count==0);
    }

static BOOL CALLBACK find_win_by_procid(HWND hwnd,LPARAM lp)

    {
    int pid;

    GetWindowThreadProcessId(hwnd,(LPDWORD)&pid);
    if (pid==fwbp_pid)
        fwbp_count++;
    return(TRUE);
    } 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-05-12T20:54:30.980

我已经编写了一种避免控制台闪烁的替代方法。请参阅*[如何创建可用作 GUI 和控制台应用程序的 Windows 程序](http://www.tillett.info/2013/05/13/how-to-create-a-windows-program-that-works-as-both-as-a-gui-and-console-application/)*。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-11-15T09:51:09.897

在静态构造函数中运行 AllocConsole() 对我有用

# browser - HttpModule 中的浏览器检测

> ID：493540
> 
> 赞同：2
> 
> 时间：2009-01-29T21:32:50.207
> 
> 标签：browser, httpmodule

有没有办法检测在 HttpModule 中发出请求的浏览器是什么？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-29T21:37:20.213

```
public class TestModule : IHttpModule
{
    public void Dispose() {
        throw new NotImplementedException();
    }

    public void Init(HttpApplication context) {
        context.Request.Browser....;
    }
} 
```

[MSDN 参考](http://msdn.microsoft.com/en-us/library/system.web.httprequest.browser(VS.80).aspx)

# svn - bluehost 上的 websvn

> ID：493554
> 
> 赞同：1
> 
> 时间：2009-01-29T21:36:27.890
> 
> 标签：svn, websvn

我已经能够让 SVN 在 bluehost 上工作。接下来，我尝试设置 websvn，并且可以看到 websvn 主页面，但是当我单击存储库时，出现此错误：

运行此命令时出错：/home/username/system/bin/svn --non-interactive --config-dir /tmp log --xml --verbose --limit 2 'file:////home/username/devel //测试/'

/home/username/system/bin/svn：第 60 行：/usr/bin/sed：没有这样的文件或目录 /home/username/system/bin/svn：第 64 行：/usr/bin/sed：没有这样的文件或目录 ls：写入错误：损坏的管道 /home/username/system/bin/svn：第 88 行：/usr/bin/sed：没有这样的文件或目录

但是 /usr/bin/sed 从 ssh 可以正常工作。有什么提示吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-31T07:54:42.823

我解决了！:)

我发现 svn 实际上是一个 bash 脚本！它已经硬编码到它的几个地方：/usr/bin/sed

所以我只是将它们替换为： /home/username/bin/sed 并且它正在工作！:)

WebSvn 现在很好地在 bluehost 上工作！！！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-30T07:56:47.857

您使用 ssh 登录的机器可能不是实际为您尝试的 websvn URL 上的 HTTP 请求提供服务的机器，因此实际上可能没有安装 /u/b/sed。您可以尝试在您的帐户中安装 sed 并将所有对 /u/b/sed 的引用替换为您自己版本的路径。svn+ssh 对你有用吗？

干杯，沃尔克

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-30T08:50:19.840

沃尔克

> 您使用 ssh 登录的机器可能不是实际为您尝试的 websvn URL 上的 HTTP 请求提供服务的机器，因此可能实际上没有安装 /u/b/sed。>

是的，这可能是一个原因。我们如何检查它？有这样的 php 吗？回声执行（“sed”）；

> 您可以尝试在您的帐户中安装 sed，并将所有对 /u/b/sed 的引用替换为您自己版本的路径。>

是的，我已经尝试过了，更改了 websvn 设置，但是 svn 以某种方式执行 /usr/bin/sed 并再次出现错误。

> svn+ssh 对你有用吗？

是的，它工作正常。

谢谢，

# regex - 是否可以在 UltraEdit 的换行符上使用正则表达式匹配模式？

> ID：493557
> 
> 赞同：1
> 
> 时间：2009-01-29T21:37:06.203
> 
> 标签：regex, text-editor, ultraedit

UltraEdit 文本编辑器包括用于搜索的 Perl 和 Unix 兼容的正则表达式引擎。

我希望能够匹配一个字符串行：

```
<branch id="attribute">
    <leaf id="attribute"/>
    <leaf id="attribute"/>
    <leaf id="attribute"/>
</branch> 
```

像这样：

```
/<branch id="attribute">.*</branch>/gis 
```

有没有办法使用 UltraEdit 来完成这个？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-29T21:46:38.743

如果您将 (?s) 放在模式的开头，它将启用单行模式，因此 \r\n 不会被排除在匹配之外。*

例如，以下匹配整个分支元素（在 UEStudio 6 中使用 Perl 样式的正则表达式）：

```
(?s)<branch id="attribute">.*</branch> 
```

做一个小实验，也支持其他一些 Perl 选项。例如，开头的 (?sx-i) 将是单行，忽略模式中的额外空格，区分大小写（似乎默认为不区分大小写）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-29T22:05:04.213

如果您选择了 Perl 正则表达式，您可以执行以下操作：

```
<branch id="attribute">[\s\S]*</branch> 
```

其中 \s 是任何空白字符，包括换行符和回车符，而 \S 是任何其他字符。请注意，默认情况下这是贪婪的，因此如果您有以下字符串：

```
<branch id="attribute">
  <leaf id="attribute"/>
  <leaf id="attribute"/>
  <leaf id="attribute"/>
</branch>
<branch id="attribute">
  <leaf id="attribute"/>
  <leaf id="attribute"/>
  <leaf id="attribute"/>
</branch> 
```

那么一个正则表达式将找到整个字符串作为一个匹配项。如果你不想这样做，那么添加`?`如下：

```
<branch id="attribute">[\s\S]*?</branch> 
```

从答案中可以看出，在 UltraEdit 中有很多方法可以实现这一点！

注意：使用 UltraEdit 14.20 测试。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-01-29T21:53:32.177

你有没有尝试过：

```
/<branch id="attribute">[.\n]*</branch>/gis 
```

# apache-flex - 尝试将数据库附加到当前打开的数据库，但我收到一条错误消息，提示 SQL 不允许 ATTACH

> ID：493564
> 
> 赞同：3
> 
> 时间：2009-01-29T21:38:10.273
> 
> 标签：apache-flex, sqlite, air

我正在尝试将数据库（db2.sqlite）附加到当前打开的数据库（db1.sqlite）并将 db2 中的一个表的内容复制到 db1 中的一个表中。我认为执行此操作的合乎逻辑的方法是使用附加命令，然后从 db2 中选择全部并插入到 db1 中：-

将“C:\db2.sqlite”附加为 newData；插入 main.table1 select * from newData.table1

两个数据库具有相同的表名 (table1) 和完全相同的架构。为了确保我的语法正确，我在 Firefox SQLite 管理器中尝试了这个，一切都运行良好。

不幸的是，当我在我的空中应用程序中尝试相同的方法时，我收到以下错误：-“SQL 不允许附加。'，操作：'执行'，detailID：'2053'”

谁能告诉我为什么这不起作用？

非常感谢亚当

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-29T21:51:49.310

来自[Adob​​e LiveDocs](http://livedocs.adobe.com/flex/3/langref/localDatabaseSQLSupport.html#unsupportedSQL)：

> 以下 SQL 元素和 SQLite 功能在某些 SQLite 实现中受支持，但在 Adob​​e AIR 中不受支持。大多数功能都可以通过 SQLConnection 类的方法获得：
> 
> ```
> * ATTACH: This functionality is available through the 
>   SQLConnection.attach() method. 
> ```

# wpf - WPF XBAP 应用程序在第二次/第三次部署后空白？

> ID：493565
> 
> 赞同：1
> 
> 时间：2009-01-29T21:38:25.360
> 
> 标签：wpf, xbap

这在 VS2008 和 Visual C# 2008 的各种机器上反复发生。

我创建了一个 XBAP 应用程序。

我单击绿色箭头，它可以工作。

我单击构建/发布并将其发布到网站或文件夹，它可以工作。

我做了一些更改，再次发布，我只是得到一个白屏。两个浏览器，都可以重启，总是空白。

这似乎是某种缓存等。有没有人遇到过这种情况并找到解决方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-06T03:51:47.940

版本号是递增的吗？右键单击 xbap 项目，转到属性/发布选项卡，增加版本号并重新发布。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-13T22:44:56.177

您可以在VS 命令提示符下使用**mage -cc**命令清除应用程序商店。查看[这篇](http://blogs.telerik.com/blogs/08-06-24/Tip_of_the_Day_Clear_your_ClickOnce_application_store.aspx)文章了解更多信息。

# winforms - .NET CF 中的自动调整大小控件以避免水平滚动？

> ID：493579
> 
> 赞同：1
> 
> 时间：2009-01-29T21:43:35.897
> 
> 标签：winforms, windows-mobile, compact-framework, scrollbar

我正在.NET Compact Framework 中开发一个表单，它承载了可变数量的控件。每个控件都应与窗体具有相同的宽度。只有几个控件时，不会出现垂直滚动条。当控件的数量超出一个表单的容量时，会出现一个垂直滚动条。然后应该修改控件的宽度，以便不会出现水平滚动条。

实现这一目标的最佳方法是什么？我对适用于所有平台/屏幕尺寸并且可以支持屏幕方向更改的解决方案感兴趣。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-30T00:00:41.000

如果我做对了，在某一时刻，垂直和水平滚动条都会出现，而你只想要垂直滚动条？将每个控件的 Anchor 设置为“Top|Left|Right”不会自动解决这个问题吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-03T14:59:26.893

如果每个控件都与窗体的宽度相同，为什么不将每个控件停靠到顶部（或底部）？然后它会为你调整大小。然而，它可能看起来不是很吸引人，所以我建议添加一些空面板（以相同的方式停靠）用作垂直垫片。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-29T22:20:23.263

我做了一些快速测试，看起来，当您添加控件时，当添加的控件触发 scollbars 以使其可见时，面板会引发 resize 事件。烦人的部分是在启动期间触发了几次调整大小事件:(但是知道紧凑的框架，这可能是您处理此问题的最佳方法。

通常，如果 DisplayRectangle 大于面板的大小，则可以在完整框架上使用，但 cf 中不存在这样的东西。

希望这对您有所帮助，我会看看早上是否能找到更多东西。

# asp.net - 如何在没有手动字符串解析的情况下将 url 转换为 asp.net 中的虚拟路径？

> ID：493580
> 
> 赞同：6
> 
> 时间：2009-01-29T21:43:40.497
> 
> 标签：asp.net, url, path, virtual-path

我已经看到有关从虚拟到绝对和 url 的转换的类似问题和答案，但是如何在没有手动字符串解析的情况下将 url 转换为虚拟路径？

例子：

我想将“ [http://myserver/home.aspx](http://myserver/home.aspx) ”转换为：“~/home.aspx”

我意识到上面的示例将是一个简单的字符串解析例程，但我正在寻找一个合适的解决方案，它可以适应 url 格式的变化。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-29T21:51:07.767

您可以从 Uri 类中获得大部分内容：

```
new Uri("http://myserver.com/home.aspx").AbsolutePath 
```

然后你只需要在前面加上~

但是，如果您托管在子目录中，这可能会中断-我认为没有办法专门在您正在运行的应用程序的上下文中执行此操作。

编辑：这可能会这样做：

```
VirtualPathUtility.ToAppRelative(new Uri("http://myserver.com/home.aspx").AbsolutePath); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-29T21:52:49.543

VirtualPathUtility.ToAppRelative 方法（字符串）似乎是您正在寻找的（[http://msdn.microsoft.com/en-us/library/ms150163.aspx](http://msdn.microsoft.com/en-us/library/ms150163.aspx)）

> 如果应用程序的虚拟路径是“myapp”，并且将虚拟路径“/myApp/sub/default.asp”传递给 ToAppRelative 方法，则生成的应用程序相对路径是“~/sub/default.aspx”。

# c# - 写这个 if..then 逻辑的最干净的方法是什么？

> ID：493603
> 
> 赞同：8
> 
> 时间：2009-01-29T21:50:59.233
> 
> 标签：c#, coding-style

他们都做同样的事情。一种方式更好吗？显然，如果我编写代码，我就会知道我做了什么，但是其他人阅读它呢？

```
if (!String.IsNullOrEmpty(returnUrl))
{
    return Redirect(returnUrl);
}
return RedirectToAction("Open", "ServiceCall"); 
```

或者

```
if (!String.IsNullOrEmpty(returnUrl))
{
   return Redirect(returnUrl);
}
else
{
    return RedirectToAction("Open", "ServiceCall");
} 
```

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-01-29T21:54:26.263

```
return String.IsNullOrEmpty(returnUrl) ? 
            RedirectToAction("Open", "ServiceCall") : 
            Redirect(returnUrl); 
```

我更喜欢那个。

或替代方案：

```
return String.IsNullOrEmpty(returnUrl)  
            ? RedirectToAction("Open", "ServiceCall")  
            : Redirect(returnUrl); 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-01-29T21:58:53.603

我认为最好先删除非（否定）并获得肯定的断言：

```
if (String.IsNullOrEmpty(returnUrl))
{
   return RedirectToAction("Open", "ServiceCall");
}
else
{
    return Redirect(returnUrl);
} 
```

-或者-

```
// Andrew Rollings solution
return String.IsNullOrEmpty(returnUrl) ? 
                    RedirectToAction("Open", "ServiceCall") : 
                    Redirect(returnUrl); 
```

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2009-01-29T21:59:13.930

一种风格问题：

```
if (String.IsNullOrEmpty(returnUrl))
{
    return RedirectToAction("Open", "ServiceCall");
}
return Redirect(returnUrl); 
```

当您取消双重否定时，无论您选择哪种大括号样式，它都会变得更好。读起来更好的代码总是最好的；）

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-01-29T21:54:04.643

第二种方法更好，不要混淆你的意思......

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-01-29T21:56:05.013

我认为这是一个相当小的风格问题。我认为您的两个示例同样具有可读性。

我更喜欢前者，但其他人更喜欢函数的一个退出点，并且可能会建议类似：

```
if (!String.IsNullOrEmpty(returnUrl))
{
   result = Redirect(returnUrl);
}
else
{
    result = RedirectToAction("Open", "ServiceCall");
}

return result; 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-01-29T21:56:54.730

我喜欢第一个例子，因为这段摘录**会**更明显地返回。如果两个`return`s 都在缩进的块中，则需要更多的脑力来判断。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-29T22:06:04.820

消除“双重否定”，使用全面展开的风格。我相信现在大多数编译器都可以代表您适当地优化代码，因此没有理由为了可读性而采取捷径。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-29T22:11:53.810

如果它是方法的全部，那么我会说第二个（使用 else）更优雅一些。如果您在 else 情况下在 return 之前有前面的代码或（特别是）更多代码，我会说最好不要放置 else。防止代码变得过于缩进。

即：

```
void myfunc()
{
    if (!String.IsNullOrEmpty(returnUrl))
    {
        return Redirect(returnUrl);
    }
    else
    {
        return RedirectToAction("Open", "ServiceCall");
    }
} 
```

或者

```
void myfunc()
{
    // ... maybe some code here ...

    if(!String.IsNullOrEmpty(returnUrl))
    {
       return Redirect(returnUrl);
    }

    // ... a bunch of other code ...

    return RedirectToAction("Open", "ServiceCall");
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-30T00:47:21.203

由于不可避免的双重否定逻辑，这段代码感觉很混乱（并且洗牌并不会清除它）。无论您使用哪种安排，我认为您应该添加一些注释，以便读者无需重复：

```
if (!String.IsNullOrEmpty(returnUrl))
{
  // hooray, we have a URL
  return Redirect(returnUrl);
}
else
{
  // no url, go to the default place
  return RedirectToAction("Open", "ServiceCall");
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-29T21:59:04.210

怎么样：

```
if (!String.IsNullOrEmpty(returnUrl))
    return Redirect(returnUrl);
else
    return RedirectToAction("Open", "ServiceCall"); 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-29T22:00:59.353

不要认为有更好的方法......这取决于每个开发人员。这就是为什么在开始一个项目之前你应该决定什么是编码标准......

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-29T22:07:05.957

我更喜欢第一个。

```
if ( ) 
{
    return ... 
}
return 
```

对我来说，它读起来像“默认”，您可以链接更多条件，但最后有一个默认值。

当然，这是风格问题。

附加问题。

将方括号放在一行中是 C# 风格吗？

```
if ( ) 
{
}
else
{
} 
```

我已经看到这渗透到 SO 中的 Java 代码示例中，我想知道这是根本原因。

**编辑**

@欧文。我的意思是，它是使用这种形式的 C# 风格吗？

```
if ()  
{
    code ... 
}
else
{
    code...
} 
```

而不是这个（这将是[Java 的首选](http://java.sun.com/docs/codeconv/html/CodeConventions.doc6.html#430)）

```
if ( ) { 
    code ... 
} else { 
   code ...
} 
```

过去我对此有过一些争论，但大多数时候，只有来自 C# 背景的人。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-01-29T22:13:39.983

和[这里](https://stackoverflow.com/questions/493603/what-is-the-cleanest-way-to-write-this-if-then-logic/493618#493618)一样，但更具可读性：

```
return
  string.isNullorEmpty(returnUrl) ? 
     RedirectToAction("Open", "ServiceCall") :
     Redirect(returnUrl); 
```

这种方式有效，可读且非冗余。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-01-29T22:38:34.723

从维护的角度来看，我更喜欢第一个版本。我已经看到了一贯的“早点离开”风格的错误更少。

三元运算符 (?:) 是可以的，但前提是在第二个 return 语句之前插入新代码的可能性很小。否则，当需要在第二条代码路径中添加新内容时，三元语句无论如何都必须回到 if/else 块。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-01-29T23:35:23.407

当我只有一行时，有时我会像这样压缩 if 语句：

```
if(String.IsNullOrEmpty(returnUrl)) { 
  return RedirectToAction("Open", "ServiceCall"); 
}
else{ return Redirect(returnUrl); } 
```

虽然当我看到它时，Andrew Rollings 可能有最好的解决方案，尽管直到今天我才想到使用它。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-01-30T00:04:51.663

LFSR 的[“else”解决方案](https://stackoverflow.com/questions/493603/what-is-the-cleanest-way-to-write-this-if-then-logic/493635#493635)是最易维护和可读的。

使用单独的`else`子句允许添加逻辑而不会无意中更改流程。拥有多个退出点而不将其中两个隐藏在一个三元运算符语句中已经够糟糕的了！

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2009-01-29T22:11:13.640

第一个。如果您在 if 语句中返回一个值，则不需要任何其他内容。所以：

```
if (!String.IsNullOrEmpty(returnUrl))
    return Redirect(returnUrl);
return RedirectToAction("Open", "ServiceCall"); 
```

# c++ - C++ 项目依赖问题 Visual Studio 2005

> ID：493613
> 
> 赞同：4
> 
> 时间：2009-01-29T21:52:55.440
> 
> 标签：c++, visual-studio, visual-c++-2005

我正在开发一个 dataManagement 项目，该项目会定期删除特定文件夹中的文件。该解决方案有三个项目，其中一个是应用程序，另外两个是静态库。现在我想再添加一个项目，它是一个用于日志记录的静态库。日志记录静态库项目有一个应用程序项目引用的头文件。当我构建解决方案时，由于找不到头文件而出现错误。当我添加日志静态库项目时，我还通过检查项目依赖项中的适当 bix 使应用程序项目依赖于它。谁能帮帮我吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-29T21:59:13.337

它需要一个额外的包含文件路径来引用头文件目录...

项目->属性->配置属性->C/C++->附加包含目录

它不会自动获取头文件路径，它只知道如何链接到项目......它完全未定义头文件应该在哪里。或者即使你有一个头文件，如果你愿意，你也可以转发引用其他项目中的东西！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-29T22:04:19.193

要让静态链接库在 VS 中工作，您需要做两件事。编译器需要能够找到您引用的符号的声明，并且链接器需要能够解析完整的定义。当您将 .lib 文件添加到 VS 项目时，这符合第二个义务。为了满足第一个，您必须在第一个引用之前在源层次结构中的某个位置包含头文件，并且您还必须告诉项目在哪里可以找到头文件。VS 中的依赖项设置仅设置构建顺序 - 它们在这里无济于事。您需要确保您的头文件所在的文件夹已添加到项目属性中的“其他包含目录”设置中，或者是主 VS 选项中的全局包含目录之一。您还必须确保 .

# php - 在 PHP 中使用 postgresql sproc（返回 ref 游标）的最佳方法？

> ID：493623
> 
> 赞同：0
> 
> 时间：2009-01-29T21:55:46.637
> 
> 标签：php, postgresql, cursor

我正在使用存储过程并从 PHP 调用它们（我也在 Java 应用程序中使用相同的过程）。

现在我这样做（有效）：

```
if(!($result = pg_query($connection, 'BEGIN; SELECT '.$query.'; FETCH ALL IN '.self::$cursor.';'))) return NULL; 
```

哪里`$query`是类似“ `CALL create_account('foo', 'bar', 'etc')`”的东西，`$cursor`只是“ref_cursor”，因为那是游标名称（是的，我知道它看起来像一个黑客......）。

我知道过程（和准备好的语句）的好处，我想知道执行上述内容是否有任何意义。据我所知，程序是预编译的，但上面的查询不是。所以我只是在自欺欺人地相信我会在这方面获得一些性能提升吗？我有点受制于我的程序，因为我有一个 Java 自动生成器，可以为我编写它们。在这种情况下使用 PDO 会更好吗？我在网上搜索了有关 pgsql ref cursors + pdo 的内容，但没有找到太多。我知道我可以只使用 PDO 准备好的语句，但这不符合我的程序。

-Yngve

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-07-30T12:44:25.217

“更好的方法”是使用 pg_query_params，但您一次只发送 1 个查询/语句：

```
 pg_query_params('SELECT procedure_name($1, $2);'.array('foo','bar')); 
```

# ruby-on-rails - Rails - 我应该使用布尔字段还是关系表？

> ID：493634
> 
> 赞同：1
> 
> 时间：2009-01-29T21:58:13.463
> 
> 标签：ruby-on-rails, ruby, activerecord

用户模型有三个键：`is_master`, `is_standard`，`is_guest`因为我最初想使用[activerecord](https://rubygems.org/gems/activerecord)的布尔方法，比如`is_master`？或`is_power`？

但是，如果最好创建一个 UserType 关系并创建我自己的方法，如下所示：

```
def master?
   return true if self.user_type = 1
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-29T22:01:42.193

如果主/标准/来宾关系是互斥的（也就是说，您只能成为其中之一），那么存储类型的字段（请以人类可读的形式 - 没有不透明的数字）会更好。您总是可以轻松地重新实现`is_foo?`。

另一方面，如果您可以同时拥有一个以上的主/标准/访客/其他帐户，那么请坚持使用单独的布尔字段。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-30T16:52:20.477

如果您查看 restful 身份验证插件是如何做到的（包括用户角色），他们会使用连接表。

我认为联接更具可读性。使用联接可以让您更灵活地使用角色系统。

如果您要求用户只能拥有一个角色，我会将该逻辑放入您的模型中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-30T12:00:41.110

作为一个 DBA，我总是讨厌人们使用列作为标志，这将是很多额外的列。如果它都是相同的类型（如帐户类型），我会按照第一个答案的建议进行（包括使用文本，而不是数字）。

另一方面，如果您需要它用于单独的标志或多种类型（但数量有限），我实际上会进行二进制计算。

也就是说，在表中有一列代表所有标志，然后为每个标志分配一个编号。

前任。

```
FLAGS = {:master => 1, :standard => 2, :guest => 4, :power => 8, 
         :another_flag => 32, :yet_another_flag => 64}

def is_master?
    self.flags & FLAGS[:master]
end

def is_standard?
    self.flags & FLAGS[:standard]
end 
```

设置值时需要做更多的工作，但不会因为许多仅用于标志的列而使表格混乱。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-01T03:38:52.073

我将从解决您当前需求的最简单的事情开始。根据需要重构并增加复杂性。听起来像一组布尔列正是您所需要的。

# sql-server - 我的环境是否需要付费的 SQL Server 许可证？

> ID：493642
> 
> 赞同：1
> 
> 时间：2009-01-29T21:59:49.670
> 
> 标签：sql-server, sql-server-2005, licensing, production-environment

我为游戏编写了一个插件，该插件连接到 PHP 页面并从游戏中发送信息。PHP 页面获取此信息，连接到 SQL Server 2005 实例，然后将给定的信息插入到各种表中。

我使用 Apache (WampServer) 来托管 PHP 页面，并使用 SQL Server 2005 Express 来托管数据库服务器。就开发而言，此设置“没问题”，但我希望将此插件发布给其他玩家。他们的插件版本将与我的相同，因为它将连接到远程 PHP 页面以向数据库添加数据或从数据库查询信息。

由于“客户”没有直接访问数据库，SQL Server 2005 是否需要某种类型的付费许可证才能让我“合法”使用它？“生产服务器”的标准定义是什么？

注意：我没有从这个插件或 PHP 页面赚钱，但是插件编写的游戏确实需要付费订阅。但是，我不是开发者，也不是与游戏有任何关联（我自己付费订阅除外）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-29T22:07:47.733

SqlExpress 无论部署什么都是免费的，你只需要接受限制

*   单CPU
*   1GB RAM 最大使用量
*   4GB 数据库大小限制（不包括日志）

根据您的描述，我认为 SQLExpress 适用于您的应用程序。

这是来自 MS [http://www.microsoft.com/Sqlserver/2005/en/us/compare-features.aspx的参考](http://www.microsoft.com/Sqlserver/2005/en/us/compare-features.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-29T22:02:56.823

Express 是免费的，不需要许可费 如果您升级到常规（标准、企业等）SQL Server 版本，那么通常您会获得 Web 服务器的每 CPU 许可证

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-30T17:23:35.983

SQL Server 在您的方案中通常需要许可证，即多路复用。

如果您要重新分发 Express，这意味着将其发送给在他们的机器上安装它以使用您的插件的人，您需要注册 ( [http://www.microsoft.com/sqlserver/2005/en/us/express-redistribute.aspx](http://www.microsoft.com/sqlserver/2005/en/us/express-redistribute.aspx)）。

如果您在某些服务器上安装了 Express，人们从网页上点击了该服务器，那么您就可以了，尽管您可能会遇到 1GB 内存限制的性能问题。

# php - 是否可以为您拥有的站点/服务器设置 cookie？

> ID：493646
> 
> 赞同：2
> 
> 时间：2009-01-29T22:00:35.127
> 
> 标签：php, cookies, curl, exchange-server, logonserver

**这是我的问题的快速版本：**

当 cookie 用于不同的服务器（在本例中为 Exchange 邮件服务器）时，是否可以以某种方式将 cookie 设置到客户端的浏览器中？在这种情况下，尝试设置 cookie 的服务器位于“intranet.myschool.edu”，交换服务器位于“owa_server.myschool.edu”。

**这是完整的问题：**

我有一个 php 脚本，它使用 cURL 向启用了基于表单的身份验证的 Exchange 服务器进行 HTTP POST。

当我成功进行 HTTP POST（其中包括发布的 url 中的用户/密码）时，Exchange Server（或更具体地说，是[https://my.school.edu/exchweb/bin/auth/owaauth.dll](https://my.school.edu/exchweb/bin/auth/owaauth.dll)文件）输出 cookie。具体来说，它输出一个“sessionid”和一个“cadata”id。

将这些 cookie id 写入服务器上的文本文件后，cURL/PHP 可以引用它，然后从 Exchange/OWA 服务器请求数据（通过 webdav 等）。

那部分有效。我想解决的问题是现在将 cookie id 传递给客户端浏览器，以便他们可以使用这些 cookie id 自动登录到他们自己的 OWA 帐户。

本质上，我希望我们的用户使用他们的 Active Directory ID 登录我们的 Intranet，并查看他们最近电子邮件的快照。然后，如果他们需要，我会给他们一个小链接以切换到完整的 OWA Web 应用程序。发生此切换时，我不希望他们必须手动登录 OWA。由于他们已经在 Intranet 前面提交了他们的 Active Directory 用户名和密码，我希望他们能够自动登录到 OWA。

我应该注意，使用 Windows 身份验证尝试进行单点登录是不可能的，因为我们混合了 Mac OS、Windows 和 Linux。

我原以为我可以做一个“setcookie”并分配 cURL 获得的 cookie id 并将它们放入客户端浏览器中。

这不可能吗？是否不可能以这种方式“欺骗”Exchange/OWA（或任何其他站点）。我有 cURL 捕获的合法 cookie id。有没有办法将这些传递给另一台计算机上的客户端浏览器？

在最坏的情况下，使用 Javascript 将用户名和密码自动粘贴到 OWA 登录页面是我唯一的希望吗？有人对如何避免 Exchange/OWA 的双重登录问题有任何其他想法吗？

感谢您提供的任何帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-29T22:18:20.880

来自[RFC 2965](http://www.ietf.org/rfc/rfc2965.txt) (NB HDN = "主机域名)

> 主机 A 的名称域匹配主机 B 的 if
> 
> ```
>  *  their host name strings string-compare equal; or
> 
>   * A is a HDN string and has the form NB, where N is a non-empty
>      name string, B has the form .B', and B' is a HDN string.  (So,
>      x.y.com domain-matches .Y.com but not Y.com.) 
> ```
> 
> 请注意，域匹配不是交换操作：abccom
> 域匹配 .c.com，但不是相反。

所以使用`.myschool.edu`作为域应该可以。NB领先。是必不可少的

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-29T22:12:21.983

您*可以*设置一个域部分为“.myschool.edu”的 cookie。理论上，它会被发送到托管在“myschool.edu”子域下的任何其他站点。

然而，在实践中，您的客户端软件可能会认为 cookie 的范围太广，并拒绝将其发回。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-29T23:39:09.080

> 在这种情况下，尝试设置 cookie 的服务器位于“intranet.myschool.edu”，交换服务器位于“owa_server.myschool.edu”。

你应该能够做到这一点。

我在我的网站上执行此操作（出于示例的目的，我将更改名称）：

我在 url 有一个网络应用程序

**webapp.domain.com**

当用户登录时，我将 PunBB 论坛包的 cookie 设置为：

**论坛.domain.com**

通过设置/清除 PunBB 论坛 cookie，我可以自动登录/注销我的用户在他们的论坛帐户上（这当然假设注册是同步的，在我的情况下，我删除了论坛注册并且主站点注册创建了论坛用户帐户）。

您需要做的就是在 subdomain#1 中将 cookie 路径设置为**“/”**（默认），并将 cookie 域设置为“domain.com”。然后您的子域#2 中的应用程序应该会看到 cookie。

编辑：我看到**barrowc**已经回答，我在一些示例中看到了“.domain.com”模式，我的网站使用“domain.com”作为 cookie 域，它也可以工作（如果缺少，php set_cookie 可能会添加前导点?)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-29T22:05:17.037

如果可能的话，我认为这将是一个严重的安全漏洞......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-31T04:36:36.170

您可以使用 iframe 来设置 cookie，即。在您的网络服务器上有一个 iframe，它向您的交换 http 服务器 ( [https://my.school.edu/exchweb/](https://my.school.edu/exchweb/) ) 上的页面发出请求，并将您想要的 cookie 变量设置为 get 或 post 变量。然后使用 vars 为该域设置 cookie，并将用户重定向到交换服务器。

现在，OWA 的后端可能存在检查 IP 地址、用户代理等的逻辑......在注册会话时可能会使其无效......不确定

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-29T22:47:32.240

您的浏览器可以决定...但通常不，您不能。这被认为是一种 XSS 漏洞。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-11-06T19:46:50.350

几个月来我们一直在努力解决这个问题，我们能想到的最好的办法是允许 Web 服务器在每次登录时获取 Exchange 的 cookie。问题是，如果没有 cookie 亲和性，我们就无法确保 Web 服务器获得的 cookie 来自客户端连接的同一个负载平衡节点。

# c# - BLL 中的一种方法跨多种 DAL 方法的事务

> ID：493649
> 
> 赞同：6
> 
> 时间：2009-01-29T22:01:20.820
> 
> 标签：c#, .net, sql

您将如何从业务逻辑层中的一个方法调用数据访问层中的多个方法，以便所有 SQL 命令都存在于一个 SQL 事务中？

每个 DAL 方法都可以从 BLL 中的其他位置单独调用，因此不能保证数据层方法始终是事务的一部分。我们需要这个功能，所以如果数据库在长时间运行的过程中脱机，就没有提交。业务层根据之前每次调用的结果编排不同的数据层方法调用。我们只想在整个过程的最后提交（从业务层）。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-29T22:22:33.307

好吧，首先，您必须遵守您在 BLL 中指定为单个方法的原子工作单元。这将（例如）创建客户、订单和订单项目。然后，您可以将这一切整齐地包装在 TransactionScope using 语句中。TransactionScope 是这里的秘密武器。下面是一些幸运的是我现在正在处理的代码:)：

```
public static int InsertArtist(Artist artist)
{
    if (artist == null)
        throw new ArgumentNullException("artist");

    int artistid = 0;
    using (TransactionScope scope = new TransactionScope())
    {
        // insert the master Artist
        /* 
           we plug the artistid variable into 
           any child instance where ArtistID is required
        */
        artistid = SiteProvider.Artist.InsertArtist(new ArtistDetails(
        0,
        artist.BandName,
        artist.DateAdded));

        // insert the child ArtistArtistGenre
        artist.ArtistArtistGenres.ForEach(item =>
        {
            var artistartistgenre = new ArtistArtistGenreDetails(
                0,
                artistid,
                item.ArtistGenreID);
            SiteProvider.Artist.InsertArtistArtistGenre(artistartistgenre);
        });

        // insert the child ArtistLink
        artist.ArtistLinks.ForEach(item =>
        {
            var artistlink = new ArtistLinkDetails(
                0,
                artistid,
                item.LinkURL);
            SiteProvider.Artist.InsertArtistLink(artistlink);
        });

        // insert the child ArtistProfile
        artist.ArtistProfiles.ForEach(item =>
        {
            var artistprofile = new ArtistProfileDetails(
                0,
                artistid,
                item.Profile);
            SiteProvider.Artist.InsertArtistProfile(artistprofile);
        });

        // insert the child FestivalArtist
        artist.FestivalArtists.ForEach(item =>
        {
            var festivalartist = new FestivalArtistDetails(
                0,
                item.FestivalID,
                artistid,
                item.AvailableFromDate,
                item.AvailableToDate,
                item.DateAdded);
            SiteProvider.Festival.InsertFestivalArtist(festivalartist);
        });
        BizObject.PurgeCacheItems(String.Format(ARTISTARTISTGENRE_ALL_KEY, String.Empty, String.Empty));
        BizObject.PurgeCacheItems(String.Format(ARTISTLINK_ALL_KEY, String.Empty, String.Empty));
        BizObject.PurgeCacheItems(String.Format(ARTISTPROFILE_ALL_KEY, String.Empty, String.Empty));
        BizObject.PurgeCacheItems(String.Format(FESTIVALARTIST_ALL_KEY, String.Empty, String.Empty));
        BizObject.PurgeCacheItems(String.Format(ARTIST_ALL_KEY, String.Empty, String.Empty));

        // commit the entire transaction - all or nothing
        scope.Complete();
    }
    return artistid;
} 
```

希望你能明白要点。基本上，这是一个成功或失败的工作，无论任何不同的数据库（即在上面的示例中，艺术家和艺术家艺术家类型可以托管在两个单独的数据库存储中，但 TransactionScope 不太关心这一点，它在 COM+ 级别工作并管理原子性它可以“看到”的范围）

希望这可以帮助

**编辑：**您可能会发现 TransactionScope 的初始调用（在应用程序启动时）可能会稍微引人注目（即在上面的示例中，如果第一次调用，可能需要 2-3 秒才能完成），但是，随后的调用*几乎*是瞬时的（即通常为 250-750 毫秒）。简单的接触点交易与（笨拙的）替代方案之间的权衡减轻了（对我和我的客户而言）初始“加载”延迟。

只是想证明轻松并非没有妥协（尽管在初始阶段）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-29T22:17:55.077

您所描述的是长期交易的“定义”。

每个 DAL 方法都可以简单地提供操作（没有任何特定的提交）。您的 BLL（实际上是在您协调对 DAL 的任何调用的地方）是您可以选择提交或执行“保存点”的地方。保存点是一个可选项目，您可以使用它来允许在长时间运行的事务中进行“回滚”。

例如，如果我的 DAL 的方法 DAL1、DAL2、DAL3 都是可变的，它们将简单地“执行”数据更改操作（即某种类型的创建、更新、删除）。从我的 BLL 中，假设我有 BL1 和 BL2 方法（BL1 长期运行）。BL1 调用所有上述 DAL 方法（即 DAL1...DAL3），而 BL2 仅调用 DAL3。

因此，在执行每个业务逻辑方法时，您可能会遇到以下情况：

BL1（长期交易）-> {savepoint} DAL1 -> {savepoint} DAL2 -> DAL3 {commit/end}

BL2 -> DAL3 {提交/结束}

“保存点”背后的想法是，如果数据操作出现问题，它可以允许 BL1 在任何时候回滚。仅当所有三个操作都成功完成时，才会提交长事务。BL2 仍然可以调用 DAL 中的任何方法，并且它负责控制提交。注意：您也可以在短期/常规交易中使用“保存点”。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-29T22:21:33.137

好问题。这触及了阻抗失配的核心。

这是使用存储过程的最有力论据之一。原因：它们旨在将多个 SQL 语句封装在一个事务中。

同样可以在 DAL 中按程序进行，但它会导致代码不太清晰，同时通常会导致耦合/内聚平衡向错误的方向移动。

出于这个原因，我在比简单封装表更高的抽象级别上实现 DAL。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-30T10:00:58.387

以防我在原始文章中的评论没有“坚持”，这是我作为附加信息添加的内容：

<----- 巧合的是，在您提出请求后的几个小时内，刚刚注意到另一个类似的引用。使用类似的策略，可能也值得你看看：http://stackoverflow.com/questions/494550/how-does-transactionscope-roll-back-transactions ----->

# c - 来自 C++ 参考的 fread 示例

> ID：493650
> 
> 赞同：2
> 
> 时间：2009-01-29T22:01:33.333
> 
> 标签：c, fread

在编写 C 代码时，我经常使用网站 www.cplusplus.com 作为参考。

我正在阅读页面上引用的示例以获取[fread](http://www.cplusplus.com/reference/clibrary/cstdio/fread.html)并且有一个问题。

作为一个例子，他们发布：

```
/* fread example: read a complete file */
#include <stdio.h>
#include <stdlib.h>

int main () {
  FILE * pFile;
  long lSize;
  char * buffer;
  size_t result;

  pFile = fopen ( "myfile.bin" , "rb" );
  if (pFile==NULL) {fputs ("File error",stderr); exit (1);}

  // obtain file size:
  fseek (pFile , 0 , SEEK_END);
  lSize = ftell (pFile);
  rewind (pFile);

  // allocate memory to contain the whole file:
  buffer = (char*) malloc (sizeof(char)*lSize);
  if (buffer == NULL) {fputs ("Memory error",stderr); exit (2);}

  // copy the file into the buffer:
  result = fread (buffer,1,lSize,pFile);
  if (result != lSize) {fputs ("Reading error",stderr); exit (3);}

  /* the whole file is now loaded in the memory buffer. */

  // terminate
  fclose (pFile);
  free (buffer);
  return 0;
} 
```

在我看来，如果结果！= lSize，那么 free(buffer) 将永远不会被调用。在这个例子中这会是内存泄漏吗？

我一直认为他们网站上的示例质量很高。也许我没有正确理解？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-29T22:05:37.503

从技术上讲，是的，这是内存泄漏。但是当进程终止时，进程分配的任何内存都会自动释放，所以在这个例子中，对 free（和 fclose）的调用并不是真正需要的。

在更复杂的程序中，这可能是一个真正的问题。丢失的 free 会造成内存泄漏，而丢失的 fclose 会导致资源泄漏。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-29T22:06:34.507

*在这个例子中*它不会是内存泄漏，因为终止程序（通过调用`exit()`）会释放与其相关的所有内存。

但是，如果您将这段代码用作子例程并调用类似的东西`return 1;`来代替`exit()`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-29T22:04:01.237

当进程关闭时，操作系统会清除该进程的所有未释放内存。至少，*现代*操作系统可以。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-29T22:05:13.573

如果程序没有在 result != lSize 处退出，也就是说，它继续执行其他一些路径，那么是的 - 这是有保证的内存泄漏。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-29T22:11:51.987

有两种可能的路径。

(1) result != lSize - 在这种情况下，exit(0) 被调用。这会杀死进程，操作系统将清理内存。

(2) result == lsize - 在这种情况下，缓冲区是显式释放的，但之后会立即调用 return，因此 free 主要是一种很好的风格，因为这也会杀死进程，并且操作系统将再次清理内存.

所以在这个简单的情况下，没有内存泄漏。但是，确保释放在您编写的任何应用程序中分配的任何内存可能是一个好习惯。养成这个习惯可以防止你以后遇到很多麻烦。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-29T22:22:08.487

至于可能的内存泄漏，其他人已经回答了这个问题。不久前，我发布了一个给定代码的变体，它*应该*正确处理所有可能的错误情况：

*   [尺寸（）](https://stackoverflow.com/questions/469696#469724)
*   [fget_contents()](https://stackoverflow.com/questions/469696#469729)

# nhibernate - Nhibernate：处理 ITransaction 异常，以便新事务可以继续使用相同的 ISession

> ID：493660
> 
> 赞同：12
> 
> 时间：2009-01-29T22:04:45.633
> 
> 标签：nhibernate

我有一个包含 10 个数据对象的列表，我想使用 NHibernate 将它们插入/更新到数据库中。如果一个抛出异常（比如主键违规），我仍然想插入/更新另一个 9\. 我将每个对象操作滚动到它自己的原子事务中，如果有异常则回滚事务。问题是，如果事务确实导致异常并回滚，则在下一个事务中，Nhibernate 会抱怨错误：Nexus.Data.PortfolioCorporateEntity 条目中的 null id **（发生异常后不要刷新会话）**

我的主程序很简单。它从 sessionfactory 创建一个会话，创建数据访问层，对数据对象进行一些工作，然后尝试将这些数据对象持久保存到数据库中。

```
 sessionsManager = new NHibernateSessionManager();
        session = sessionsManager.GetSession();
        DALC = new NHibernateDataProvider(session);

        …

        foreach (var pce in pces)
        {
            try
            {
                DALC.UpdateOrAddObject<PortfolioCorporateEntity>(pce);
            }
            catch (Exception ex)
            {
                Console.WriteLine("Could not add Corporate Entity ID " + pce.CorporateEntity.CorporateEntityID.ToString());
            }

        } 
```

这是我的 Nhibernate 数据访问层中的 updateOrAdd 过程，为 10 个对象调用了 10 次。

```
public void UpdateOrAddObject<T>(T workObject) 
{ 
    using (ITransaction tx = mSession.BeginTransaction) { 
        try { 
            mSession.SaveOrUpdate(workObject); 
            mSession.Flush(); 
            tx.Commit(); 
        } 
        catch (Exception ex) { 
            tx.Rollback(); 
            throw;
        } 
    } 
} 
```

为了明确一点，会话由调用程序实例化并传递给数据访问层对象，其构造函数如下。

```
public NHibernateDataProvider(ISession session) 
{ 
    mSession = session; 
} 
```

这工作正常，除非在异常之后，它说不要在异常后刷新会话。我不知道为什么——事务很好地回滚了，数据库应该准备好接受另一个事务了，不是吗？我究竟做错了什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-01T22:27:50.390

抛出异常后，无法重新使用 NHibernate 会话。 [引用文档](http://nhforge.org/doc/nh/en/index.html#manipulatingdata-exceptions)：

```
If the ISession throws an exception you should immediately rollback the
transaction, call ISession.Close() and discard the ISession instance.
Certain methods of ISession will not leave the session in a consistent state. 
```

所以答案是你不能做你想做的事。您需要创建一个新会话并在那里重试更新。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-09-18T19:30:52.700

我清除会话并正常继续

```
 ISession session = NHibernateHelper.Session;
using (ITransaction transaction = session.BeginTransaction())
{
    try
    {
        session.Update(user, user.UserID);
        transaction.Commit();
    }
    catch (Exception ex)
    {
        transaction.Rollback();
        session.Clear();
        throw new DALException("Cannot update user", ex);
    }
} 

```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-02T16:11:00.183

感谢您的回复。只是想确保它做得对。你的意思是我的错误处理应该简单地改为：

```
 foreach (var pce in pces)
        {
            try
            {
                DALC.UpdateOrAddObject<PortfolioCorporateEntity>(pce);
            }
            catch (Exception ex)
            {
                Console.WriteLine("Could not add Corporate Entity ID " + pce.CorporateEntity.CorporateEntityID.ToString());

                session.Close();
                session = sessionsManager.GetSession();
                DALC.Session = session;

            }
        } 
```

看起来这工作得很好。谢谢。

# embedded - PDF 创建软件可用吗？

> ID：493663
> 
> 赞同：1
> 
> 时间：2009-01-29T22:05:06.850
> 
> 标签：embedded, pdf-generation

我正在研究从嵌入式系统创建 PDF 文件的可能性，特别是使用 IAR 工具的 ARM9。开源或许可很好 - 我发现很难在线搜索，我希望这里有人使用过一个包。首选 C 或 C++，我们将创建相当简单的报告，仅包含少量文本和图形。

更新：通过搜索，我确实找到了 PDFTron - 有人有任何经验吗？似乎它可以做我们想要的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-29T22:42:16.120

！！！

（这是一个网络服务器吗？否则，将文本文件作为报告吐出并在 PC 上转换似乎更有意义。）

没有经验，但也许[是 libHaru](http://libharu.org/wiki/Main_Page)？维基百科有一个[PDF 软件列表](http://en.wikipedia.org/wiki/List_of_PDF_software)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-29T23:18:43.177

看看[iText——](http://www.lowagie.com/iText/)我以前用过它，而且效果很好。

（它是基于 Java 的，但您说“首选 C 或 C++”，不是必需的）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-30T05:08:45.810

您的目标系统有多大？如果您负担得起运行 Python 解释器和 Inkscape 的副本（不需要 X），那么有一个很棒的工具链可用。

上次我遇到您遇到的那种问题空间时，我使用 Inkscape 在非 GUI 模式下将 SVG 渲染为 PDF，如下所示：

```
inkscape --without-gui --export-pdf=foo.pdf foo.svg 
```

...使用模板替换构建 SVG 的地方。（在过去这样做时，我使用[Genshi](http://genshi.edgewall.org/)模板语言来构建模板，它恰好与 Inkscape 的 GUI 功能完美地互操作——Inkscape-the-GUI-SVG-editor 不会删除命名空间中的标签，它不会识别，因此即使将其标记为 Genshi 模板，您也可以在 Inkscape 中编辑 SVG 模板！）

我的用例是为传出的传真作业自动生成封面；[在这里](http://www.hylafax.org/archive/2007-10/msg00294.php)的邮件列表存档中提供了为[HylaFAX+](http://hylafax.sourceforge.net/)实现此方法的完整脚本集。

# c - 你用什么来单元测试C代码？

> ID：493669
> 
> 赞同：7
> 
> 时间：2009-01-29T22:05:57.910
> 
> 标签：c, unit-testing

我是一名专业的 Web 开发人员，因此我习惯于使用非常高级的脚本语言和测试工具。我最近一直在个人工作，更多地使用 C 并为基于 unix 的系统编写许多 C 程序来完成各种任务。

但是，我仍然没有很好地对这段代码进行单元测试，我想知道 C 程序员使用什么工具来创建自动化测试来验证代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-07-08T02:38:09.473

考虑使用[CppUTest](http://www.cpputest.org)。它是用 C++ 编写的，但隐藏了 C++，以便 C 程序员可以忽略 C++。

[Unity](http://unity.sourceforge.net)是一个很好的纯 C 测试工具。它使用 ruby​​ 生成测试运行器。

我会远离 CppUnit。它需要 C++ 知识，并且必须单独安装每个测试。

詹姆士

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-29T22:12:31.220

您是在严格测试 C 代码，还是可以混入一些 C++？如果 C++ 没问题，[cppunit](http://apps.sourceforge.net/mediawiki/cppunit/index.php?title=Main_Page)可能值得一试。如果您正在测试一个库，您可以简单地将您的库链接到您的单元测试应用程序。如果您正在测试一个应用程序，您可能必须创建一个库，然后将其链接到您的应用程序和单元测试应用程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-29T22:12:58.427

我曾经有过这个问题并发现了[CUnit](http://cunit.sourceforge.net/)。我只将它用于一个小项目，但看起来还不错。不像我习惯的 JUnit 或 NUnit 那样方便！对于 C++ 项目，我使用效果很好的 cppunit。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-29T22:19:50.533

[最可爱的](http://cutest.sourceforge.net "最可爱的")。它真的很整洁。小，不依赖生成器语言，速度快......有什么不喜欢的？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-03-27T13:09:30.160

我是开发人员，我更喜欢使用[CMocka](http://cmocka.org/)工具为 C 语言提供 UnitTesting。它是基于 GTest（主要是 C++ 单元测试）的简单工具，而且非常容易理解。前段时间我对最好和最简单的测试工具进行了研究，并决定这样做。

经过一段时间的工作，我真的很有信心。使用预处理器指令

```
#define MyFunction(iEntry) mock_MyFunction(iEntry) 
```

您还可以切断您想要模拟的任何功能（甚至是基本的 windows 功能，如 sizeof()、malloc() 等）。

在这一步之后，您只需创建模拟函数 (mock_MyFunction(iEntry))，将它们包含到您的项目中并模拟它们的行为。首选方法是在调用它们应该返回之前设置它们一些值（ will_return_always(mock_MyFunction, 5) ）。当这个函数被调用时，它总是返回值 5。

您也可以完全避免使用 C++ 语言并继续使用纯 C 语言。不要知道CMocka的简单索引站点。您必须深入该站点和工具的 API 才能找到您需要的东西.. :) 还可以查看[这个](https://lwn.net/Articles/558106/) 关于使用 CMocka 的小教程...

我希望这会有所帮助，祝你有美好的一天.. :-)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-30T10:44:10.330

如果您只想要一个快速的'n'dirty 测试机制，请查看`assert`宏，ANSI C 的一部分。

# c# - C# 3.0：需要从 List<> 返回重复项

> ID：493673
> 
> 赞同：19
> 
> 时间：2009-01-29T22:06:51.637
> 
> 标签：c#, linq, lambda, iequalitycomparer

我在 C# 中有一个 List<> 对象，我需要一种方法来返回那些在列表中被视为重复的对象。我不需要 Distinct 结果集，我需要我将从存储库中删除的那些项目的列表。

为了这个例子，假设我有一个“汽车”类型的列表，我需要知道这些汽车中的哪些与列表中的另一个颜色相同。以下是列表中的汽车及其颜色属性：

```
Car1.Color = Red;

Car2.Color = Blue;

Car3.Color = Green;

Car4.Color = Red;

Car5.Color = Red; 
```

对于此示例，我需要结果（IEnumerable<>、List<> 或其他）包含 Car4 和 Car5，因为我想从我的存储库或数据库中删除它们，以便我的存储库中每种颜色只有一辆汽车。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-01-29T22:21:44.070

我昨天无意中编码了这个，当我试图写一个“通过投影区分”时。我包括一个！当我不应该有的时候，但这次恰到好处：

```
public static IEnumerable<TSource> DuplicatesBy<TSource, TKey>
    (this IEnumerable<TSource> source, Func<TSource, TKey> keySelector)
{
    HashSet<TKey> seenKeys = new HashSet<TKey>();
    foreach (TSource element in source)
    {
        // Yield it if the key hasn't actually been added - i.e. it
        // was already in the set
        if (!seenKeys.Add(keySelector(element)))
        {
            yield return element;
        }
    }
} 
```

然后，您可以使用以下命令调用它：

```
var duplicates = cars.DuplicatesBy(car => car.Color); 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-01-29T22:27:41.657

```
var duplicates = from car in cars
                 group car by car.Color into grouped
                 from car in grouped.Skip(1)
                 select car; 
```

这会按颜色对汽车进行分组，然后跳过每个组的第一个结果，将每个组的剩余部分返回到一个序列中。

如果您对要保留哪一个有特殊要求，例如，如果汽车`Id`有财产并且您想保留最低的汽车`Id`，那么您可以在其中添加一些排序，例如

```
var duplicates = from car in cars
                 group car by car.Color into grouped
                 from car in grouped.OrderBy(c => c.Id).Skip(1)
                 select car; 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-30T14:51:25.120

这是一个稍微不同的 Linq 解决方案，我认为它可以让您更清楚地了解您想要做什么：

```
var s = from car in cars
    group car by car.Color into g
    where g.Count() == 1
    select g.First(); 
```

它只是按颜色对汽车进行分组，丢弃所有具有多个元素的组，然后将其余部分放入返回的 IEnumerable 中。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-29T22:11:00.113

```
IEnumerable<Car> GetDuplicateColors(List<Car> cars)
{
    return cars.Where(c => cars.Any(c2 => c2.Color == c.Color && cars.IndexOf(c2) < cars.IndexOf(c) ) );
} 
```

它基本上意味着“返回列表中具有相同颜色和较小索引的任何汽车的汽车”。

不过，不确定性能。我怀疑使用 O(1) 查找重复项的方法（如字典/哈希集方法）对于大型集合可能更快。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-29T22:11:23.843

创建一个新的`Dictionary<Color, Car> foundColors`和一个`List<Car> carsToDelete`

然后你遍历你的原始汽车列表，如下所示：

```
foreach(Car c in listOfCars)
{
    if (foundColors.containsKey(c.Color))
    {
        carsToDelete.Add(c);
    }
    else
    {
        foundColors.Add(c.Color, c);
    }
} 
```

然后你可以删除 foundColors 中的每辆车。

您可以通过将“删除记录”逻辑放入`if`语句中而不是创建新列表来获得较小的性能提升，但是您对问题的措辞表明您需要将它们收集到一个列表中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-29T22:12:16.960

如果没有实际编码，那么像这样的算法怎么样：

*   遍历您`List<T>`创建的`Dictionary<T, int>`
*   遍历您的`Dictionary<T, int>`删除条目`int`> 1

剩下的任何东西`Dictionary`都有重复。当然，您实际删除的第二部分是可选的。您可以遍历`Dictionary`并寻找 >1 采取行动。

编辑：好的，我提高了 Ryan 的，因为他实际上给了你代码。;)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-30T01:48:07.867

我的回答从追随者受访者那里得到灵感（按此顺序）：Joe Coehoorn、Greg Beech 和 Jon Skeet。

我决定提供一个完整的例子，假设（为了实际效率）你有一个静态的汽车颜色列表。我相信以下代码以一种优雅但不一定超高效的方式说明了该问题的完整解决方案。

```
#region SearchForNonDistinctMembersInAGenericListSample
public static string[] carColors = new[]{"Red", "Blue", "Green"}; 
public static string[] carStyles = new[]{"Compact", "Sedan", "SUV", "Mini-Van", "Jeep"}; 
public class Car
{
    public Car(){}
    public string Color { get; set; }
    public string Style { get; set; }
}
public static List<Car> SearchForNonDistinctMembersInAList()
{
    // pass in cars normally, but declare here for brevity
    var cars = new List<Car>(5) { new Car(){Color=carColors[0], Style=carStyles[0]}, 
                                      new Car(){Color=carColors[1],Style=carStyles[1]},
                                      new Car(){Color=carColors[0],Style=carStyles[2]}, 
                                      new Car(){Color=carColors[2],Style=carStyles[3]}, 
                                      new Car(){Color=carColors[0],Style=carStyles[4]}};
    List<Car> carDupes = new List<Car>();

    for (int i = 0; i < carColors.Length; i++)
    {
        Func<Car,bool> dupeMatcher = c => c.Color == carColors[i];

        int count = cars.Count<Car>(dupeMatcher);

        if (count > 1) // we have duplicates
        {
            foreach (Car dupe in cars.Where<Car>(dupeMatcher).Skip<Car>(1))
            {
                carDupes.Add(dupe);
            }
        }
    }
    return carDupes;
}
#endregion 
```

我稍后会回到这里，并将这个解决方案与它的所有三个灵感进行比较，只是为了对比风格。这很有趣。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-30T15:02:42.380

公共静态 IQueryable Duplicates（此 IEnumerable 源）其中 TSource : IComparable {

```
if (source == null)   
     throw new ArgumentNullException("source");   
 return source.Where(x => source.Count(y=>y.Equals(x)) > 1).AsQueryable<TSource>(); 
```

}

# asp.net - Asp.net 未针对服务器 2008 上的 wcf 服务进行身份验证

> ID：493679
> 
> 赞同：0
> 
> 时间：2009-01-29T22:07:56.207
> 
> 标签：asp.net, windows-server-2008, wcf-security

我很难将网站部署到 Windows Server 2008 上的 IIS 7。该站点工作正常，直到它尝试调用托管在同一主机上的 WCF 服务。

当使用完全相同的 Web 配置等在 Visual Studio 20008 中运行 Web 时，一切都适用于我的工作站上的服务。只要我将 Web 部署到服务器 Bam 上的虚拟目录中。身份验证错误。当两者都部署在 Windows 2003 Server 上时，它也可以正常工作。导致此问题的 Server 2008 有何不同？帮助！请。

如果它很重要，所有服务操作都需要 ASP.net 页面的经过身份验证的用户的 Active Directory 组成员身份，并且装饰为：[PrincipalPermission(SecurityAction.Demand, Role = "SOAMemberShipService")]

我从网站收到以下错误：

由于身份验证失败，无法满足对安全令牌的请求。说明：执行当前 Web 请求期间发生未处理的异常。请查看堆栈跟踪以获取有关错误及其源自代码的位置的更多信息。

异常详细信息：System.ServiceModel.FaultException：由于身份验证失败，无法满足对安全令牌的请求。

源错误：

第 919 行：
第 920 行：公共 HSMembersService.MemberSearchResult SearchMembers(HSMembersService.MemberSearch MemberInfoToSearch) { 第 921 行：返回 base.Channel.SearchMembers(MemberInfoToSearch); 第 922 行：} 第 923 行：}

源文件：c:\Windows\Microsoft.NET\Framework64\v2.0.50727\Temporary ASP.NET Files\csrweb\a4d18657\a6d0910d\App_WebReferences.jgx1svpr.0.cs 行：921

堆栈跟踪：

[FaultException：由于身份验证失败，无法满足对安全令牌的请求。] System.ServiceModel.Security.SecurityUtils.ThrowIfNegotiationFault(Message message, EndpointAddress target) +6375432 System.ServiceModel.Security.IssuanceTokenProviderBase`1.ThrowIfFault(Message message, EndpointAddress 目标）+25 System.ServiceModel.Security.SspiNegotiationTokenProvider.GetNextOutgoingMessageBody（消息incomingMessage，SspiNegotiationTokenProviderState sspiState）+173

[SecurityNegotiationException：调用者未通过服务身份验证。] System.Runtime.Remoting.Proxies.RealProxy.HandleReturnMessage(IMessage reqMsg, IMessage retMsg) +4596611 System.Runtime.Remoting.Proxies.RealProxy.PrivateInvoke(MessageData& msgData, Int32 type ) +1713 HSMembersService.IHSMembersService.SearchMembers(MemberSearch MemberInfoToSearch) +0 HSMembersService.HSMembersServiceClient.SearchMembers(MemberSearch MemberInfoToSearch) 在 c:\Windows\Microsoft.NET\Framework64\v2.0.50727\Temporary ASP.NET Files\csrweb\a4d18657\a6d0910d \App_WebReferences.jgx1svpr.0.cs:921 _default.btnSearch_Click(Object sender, EventArgs e) in e:\CSRWeb\default.aspx.cs:114 System.Web.UI.WebControls.Button.OnClick(EventArgs e) +131 System.Web.UI.WebControls.Button.RaisePostBackEvent(String eventArgument) +140 System.Web.UI。Page.RaisePostBackEvent（IPostBackEventHandler sourceControl，字符串 eventArgument）+39 System.Web.UI.Page.ProcessRequestMain（布尔 includeStagesBeforeAsyncPoint，布尔 includeStagesAfterAsyncPoint）+3215

ASP.net 网站的 web.config（相关服务部分）：

服务 web.config：

```
 <!-- Service Endpoints -->
    <!-- Unless fully qualified, address is relative to base address supplied above -->
    <endpoint address ="" binding="wsHttpBinding" contract="HSMembersService.IHSMembersService" bindingConfiguration="wsHttpBindingConfig">
      <!-- 
          Upon deployment, the following identity element should be removed or replaced to reflect the 
          identity under which the deployed service runs.  If removed, WCF will infer an appropriate identity 
          automatically.
      -->
      <!--<identity>
        <dns value="localhost"/>
      </identity>-->
    </endpoint>
    <!-- Metadata Endpoints -->
    <!-- The Metadata Exchange endpoint is used by the service to describe itself to clients. -->
    <!-- This endpoint does not use a secure binding and should be secured or removed before deployment -->
    <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange"/>
  </service>
</services>
<bindings>
  <wsHttpBinding>
    <binding name="wsHttpBindingConfig" >
      <security mode="Message">
        <message clientCredentialType="Windows" />
      </security>

    </binding>
  </wsHttpBinding>
</bindings>
<behaviors>
  <serviceBehaviors>
    <behavior name="HSMembersService.HSMembersServiceBehavior">
      <!-- To avoid disclosing metadata information, 
      set the value below to false and remove the metadata endpoint above before deployment -->
      <serviceMetadata httpGetEnabled="True"/>

      <serviceAuthorization principalPermissionMode="UseWindowsGroups"         />
      <!-- To receive exception details in faults for debugging purposes, 
      set the value below to true.  Set to false before deployment 
      to avoid disclosing exception information -->
      <serviceDebug includeExceptionDetailInFaults="True" /><!-- Change this before deployment -->
    </behavior>
  </serviceBehaviors>
</behaviors> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-04T18:10:12.360

好的，这里和 MSDN 订阅组都没有答案。

所以，我尝试了一切。我的意思是一切。在看似几天但实际上可能只有 20 小时之后，它起作用了！

我所做的只是将服务文件（即 .dll、.svc 等）的物理路径移动到我的 c:root 与 wwwroot 之外的目录中，并且它起作用了。当然，我必须更新我的虚拟目录以指向它。

为什么这个位置会引起问题？IIS7.0/Windows server 2008 是否更改了不允许从 wwwroot 的物理位置部署服务的内容？我可能永远不会发现，因为我永远不会尝试从那里部署其他服务。

我对所有帐户/目录权限进行了三重检查，新物理路径中的权限与旧物理路径中的权限相同，所以那里不好。

如果有人找出原因或知道原因。请让我/我们知道。

谢谢，

埃迪

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-14T18:15:43.023

可能与[此](http://geekswithblogs.net/ranganh/archive/2005/04/25/37609.aspx)有关。

# enterprise - 如何避免短生命周期的企业应用？

> ID：493684
> 
> 赞同：1
> 
> 时间：2009-01-29T22:08:47.263
> 
> 标签：enterprise, sdlc

不久前，[另一个问题](https://stackoverflow.com/questions/360297/lifespan-of-software-how-often-do-you-expect-to-do-start-from-scratch)提到了（可能是城市故事）统计数据，

> ... 软件的平均寿命约为 3 年

当时我想出了以下原因（我相信还有更多可能更好的原因）：

1.  实施了一个新的主要系统（ERP、CRM 等），它有一个“集成”模块来取代旧的应用程序。

2.  相同，但没有集成应用程序 - 但现有应用程序无法适应（人员离开、技术发生变化、当前 IT 政策发生变化、用户不喜欢现有应用程序。）

3.  您从那里获得基本应用程序以根据您的需要对其进行定制的公司已经消失了。

4.  或者你不再和他们相处得很好。

5.  现有应用程序的技术是“过时的”（根据框架供应商/微软/顾问/行业专家/新 IT 经理的说法，他们有管理层的耳朵。）

6.  “我们正在逐步淘汰（Windows 95/Windows 98/Windows 2000/Windows XP/NT），我们需要在我们的应用程序中使用匹配技术”。

7.  “我们从（App 版本 n）中学到了很多东西，我们会在第二次/第三次/第四次/n+1 次时做得更好。”

8.  开发人员/IT经理/部门副总裁/咨询公司的工作理由。

9.  用户讨厌它。

10.  我们已经合并/收购了竞争对手/被竞争对手收购，而他们的更好。

其中一些是不可避免的（例如，您的公司被收购），但总的来说，这肯定是需要避免的事情。您的组织是否有意对抗这种综合症？你会推荐什么有效的策略？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-29T22:15:41.087

这就是为什么应用程序需要易于扩展，并且您应该能够轻松添加所有流行语。

如果您有可靠的基本代码，那么大多数流行语都与 UI 相关（Vista Controls、Ajax、.net、ASP.net 3.5）...

您可以在后端运行 COBOL（我不会）。

1.  实施了一个新的主要系统-您无能为力。
2.  当前的 IT 政策已经改变， - 应用程序应该具有适应性。
3.  用户不喜欢/讨厌现有的应用程序 - 为什么？大多数情况下，UI 中的外观更改可以解决此问题。
4.  您从那里获得基本应用程序以根据您的需要对其进行定制的公司已经消失了。- 我不会那样做，我宁愿自己写。
5.  现有应用程序的技术是“过时的”（根据框架供应商/微软/顾问/行业专家/有管理层耳朵的新 IT 经理。） - 与上述相同，如果后端可靠，您应该遵循这些在前端。
6.  “我们正在逐步淘汰（Windows 95/Windows 98/Windows 2000/Windows XP/NT），我们需要在我们的应用程序中使用匹配技术”。- 一个简单的兼容性测试和次要的 UI 元素解决了这个问题。

我还要说，当您将内部应用程序与商业应用程序进行比较时，这是不同的，如果您正在开发内部应用程序，那么更改可以保证您的工作（如果您知道自己在做什么）。如果你在做一个商业应用程序，改变是一个赚更多钱的机会，新功能会让你从现有客户和正在寻找流行语的新客户那里升级，与竞争对手相比，这些流行语可能会成为你的优势。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-29T22:34:00.317

我目前编写的软件的平均寿命可能是几天。（我写了很多脚本，所以我可能是个变态。;-) 但是我使用的核心系统现在可能有 15 到 20 年的历史。底层操作系统大约有 30 年的历史。旧软件或新软件本质上都没有错。事实上，当软件可以适应新用途时，它的老化最好。

在功能部件之间具有抽象层可以更容易地替换系统中的功能。例如，我们已经检查了系统上的几个不同的磁带库，现在我们正在考虑将来使用磁盘存档。由于我们系统的“存档”部分位于抽象层之后，我们可以相当容易地替换它，而无需替换系统的其余部分。

如果可能，最好使用标准零件。这样，如果您遇到一些限制，其他人很可能会遇到同样的问题，更有可能有人会提出解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-29T22:32:03.583

*   持续改进 - 定期添加有用的功能
*   新版本中没有显示停止的错误 - 测试，测试，测试......
*   善待你的客户并尊重他们（大多数用户真的不想每三年更换一次他们的 ERP，所以如果你与他们有良好的关系，他们会站在你这边）
*   随时了解新技术并在需要时将它们集成到您的应用程序中

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-30T01:34:12.280

当收集需求并且有人说“情况 X 将始终如此，没有例外”时，使其可配置。它总是会改变，没有例外。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-10-11T01:28:11.650

大多数公司5年都做不到。他们的软件实施预计不会持续那么久。

# objective-c - Objective-C：如何进行控制台输入？

> ID：493688
> 
> 赞同：10
> 
> 时间：2009-01-29T22:09:56.777
> 
> 标签：objective-c

如何从控制台输入中获取 NSString，然后尝试将其转换为 int？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-29T22:29:40.530

您可以从控制台（scanf 或其他）读取`char*`字符串，就像在常规 C 程序中一样。然后，`NSString`使用`stringFromCString:withEncoding:`. 最后，使用`NSString`'`integerValue`函数得到它的数值。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-14T09:10:06.920

你也可以直接用scanf来做。例子

```
int number = 0;
scanf("%d", &number); 
```

# winforms - 您如何处理 Winforms 中的临时无用控件（隐藏与禁用）？

> ID：493702
> 
> 赞同：5
> 
> 时间：2009-01-29T22:12:59.563
> 
> 标签：winforms, user-interface, usability

有一个带有“使用 foo”复选框的表单是很常见的，紧接着是一个文本框，用户可以在其中输入他想要使用的“foo 值”。当然，这个文本框只有在“Use foo”被选中时才有用

我不知道处理这种情况的最佳方法：

1.  禁用文本框（即 textboxfoo.Enabled=false;）
2.  隐藏它（即 textboxfoo.Visible=false;）
3.  如果他愿意，让用户输入一个 foo 值，并忽略他输入的值。

有没有我可以遵循的最佳实践？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-29T22:16:41.897

文本框应该被禁用。

如果文本框被隐藏，那么表单的可见更改将使程序的用户友好性降低。这方面的一个例子是以前在 Microsoft Office 中的旧（非常不受欢迎）消失的菜单项。人们不希望屏幕上的东西四处移动。这令人迷惑。

如果允许用户输入一个无用的值，那么就会给人一种错误的印象，即输入该值有一些效果。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-29T22:22:29.780

在这种情况下，禁用文本框是最好的选择。当复选框被选中/取消选中时文本框被启用/禁用的事实为用户提供了有用的反馈：use foo 选项需要一个 foo 值，并且 foo 值只有在选择了 use foo 选项时才有意义。

隐藏文本框不太令人满意 - 如果未选中该框，用户将不会意识到启用 foo 选项将允许他们指定 foo 值。想象他们在想：“我最好不要选择 use foo 选项，因为我不知道将使用什么 foo 值。”

第三个选项是最差的，因为并不表示输入的值将被忽略。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-29T22:19:40.533

禁用文本框

隐藏文本框后，用户可能会跳过“使用 Foo”选项，因为他们不清楚他们将如何或应该如何定义“foo”。当文本框可见但被禁用时，用户将认识到他们可以定义“foo”，一旦他们说他们想使用它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-29T22:36:50.187

显然禁用文本框是有利的，因为用户仍然可以直观地了解“Foo”将使他们能够做什么。

但是，当“Foo”被选中/取消选中时打开或关闭的“更多选项>>”/“<<更少选项”面板呢？从开发人员的角度来看，工作量太大，和/或从用户的角度来看，工作量太大？我自己，我喜欢它清理界面的方式，因为“Foo”的默认值（隐藏时）是合适的。

（话虽如此，我并没有在任何地方都使用它。在所有好事中都要适度。）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-29T22:17:26.810

我喜欢禁用而不是隐藏，只是因为它可以避免对话框中不必要的空白。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-29T22:24:27.747

禁用文本框。
它让用户清楚地知道有一个选项碰巧不可用。隐藏它有时会得到“我的盒子去哪儿了”的用户响应。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-29T22:51:03.030

另一种选择是让输入者也输入一些数据，但如果他开始输入 foo 文本框，则自动检查 foo 复选框。

# .net - Visual C++ GUI 应用程序卡在 MTA 模式

> ID：493718
> 
> 赞同：1
> 
> 时间：2009-01-29T22:18:21.537
> 
> 标签：.net, c++-cli, sta, mta

我有一个 C++ gui 项目表现出一些奇怪的行为。在我的机器上，代码编译并运行得很好。但是，在另一台机器上，代码编译但最终以某种方式在 MTA 中运行。显然，在 MTA 中会导致 GUI 出现各种运行时问题。这是我的主要内容：

```
 [STAThreadAttribute]
        int main(array<System::String ^> ^args)
        {
            Application::EnableVisualStyles();
            Application::SetCompatibleTextRenderingDefault(false); 
            Application::Run(gcnew Form1());
            return 0;
        } 
```

我可以在 main 的第一行放置一个断点来检查公寓状态，并且在正确构建/执行的机器上，它将是“STA”，正如预期的那样。但是，在有问题的机器上，它将是“MTA”。我什至可以尝试将公寓模式切换到 STA，但没有效果。

我已经尝试在编译之前删除调试/发布目录并清理项目，在没有附加调试器的情况下运行，都无济于事。我无法确定哪些机器工作和哪些不工作的任何模式。如果我在工作机器上编译 exe 并将其带到有问题的机器上，它将正确执行，所以我怀疑这在某种程度上是构建环境问题。所涉及的所有机器都运行带有 Visual Studio 2008 标准的 Windows XP。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-05T21:43:00.057

弄清楚了。我们的项目正在从 openCV 调用 dll，并且该 dll 已为多个线程编译。Visual Studio 注意到了这一点，并强制该应用程序也针对多个线程进行编译。从一台机器到另一台机器的不同版本的 dll 是导致问题的不规则性的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-01T20:01:43.000

我刚刚用 OpenCV 1.1 和托管代码修复了一个类似的错误。由于某种原因，OpenCV 库似乎强制应用程序进入 MTA（可能是 OpenCV DShow 接口中的 COM 对象）。无论如何，我找到了这个解决方案： [http ://www.gamedev.net/community/forums/mod/journal/journal.asp?userid=62708](http://www.gamedev.net/community/forums/mod/journal/journal.asp?userid=62708)

如果您在主应用程序中重新初始化 COM，它应该可以解决所有问题。您需要链接到 OLE32.lib 才能使用 CoUninitialize()。我使用了以下代码：

```
int main(array<System::String ^> ^args)
{

    System::Threading::Thread::CurrentThread->ApartmentState = System::Threading::ApartmentState::STA;
    if (Thread::CurrentThread->GetApartmentState() != ApartmentState::STA)
    {
        CoUninitialize();
        CoInitialize(NULL);
    }

    Application::EnableVisualStyles();
    Application::SetCompatibleTextRenderingDefault(false); 

    // Create the main window and run it
    Application::Run(gcnew Form1());
    return 0;
} 
```

# javascript - 与客户端的持久连接

> ID：493720
> 
> 赞同：13
> 
> 时间：2009-01-29T22:18:40.863
> 
> 标签：javascript, connection, persistence

有没有一种通用的方法来使用 JavaScript 实现应用程序的一部分并提供到服务器的持久连接？无论客户端是否位于防火墙后面，我都需要服务器能够将数据推送到客户端。提前致谢

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-29T22:25:42.283

请参阅[Comet](http://en.wikipedia.org/wiki/Comet_%28programming%29) - 它类似于 ajax，但它保持连接打开，因此服务器可以将信息推送到客户端。

请注意，兼容的浏览器将仅保留 2 个连接（注意：[大多数现代浏览器不再](https://stackoverflow.com/questions/5751515/official-references-for-default-values-of-concurrent-http-1-1-connections-per-se)兼容）到特定域（默认情况下），因此您可能希望拆分您的域（例如 www.yourdomain.com 和 comet.yourdomain.com）这样您就不会大大减慢页面的加载速度。或者您可以确保在加载其他所有内容之前不要打开彗星连接。这只是需要小心的事情。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-29T22:24:55.517

你应该看看彗星：

[http://ajaxian.com/archives/comet-a-new-approach-to-ajax-applications](http://ajaxian.com/archives/comet-a-new-approach-to-ajax-applications)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-29T22:25:41.740

使用 HTTP，连接必须从客户端开始。但是有一些技术可以让服务器保持连接打开并根据需要刷新数据。

这些通常被认为是[**Comet**](http://en.wikipedia.org/wiki/Comet_(programming))或[**HTTP Streaming**](http://ajaxpatterns.org/HTTP_Streaming)架构。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-29T22:26:39.850

您可以为此使用[Comet](http://en.wikipedia.org/wiki/Comet_(programming))编程技术。基本上，页面调用服务器直到服务器有东西要发送（此时客户端立即进行相同的调用）才返回。这样，服务器几乎可以随时将内容推送到客户端。

支持因平台而异，服务器的问题比客户端的问题更大。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-29T22:43:16.120

这里有几个类似的问题。当然，所有标记为[彗星的问题](https://stackoverflow.com/questions/tagged/comet)

*   [实现自重置 XMLHttpRequest 对象](https://stackoverflow.com/questions/395506/implementing-a-self-resetting-xmlhttprequest-object)
*   [Rails 中的服务器端推送](https://stackoverflow.com/questions/440140/server-side-push-in-rails)
*   [是否有不需要在服务器端修改的情况下轮询的 ajax 替代方案？](https://stackoverflow.com/questions/427861/is-there-an-alternative-of-ajax-that-does-not-require-polling-without-sever-side)
*   [与 Apache/PHP/Javascript 的长期连接（异步服务器推送）？](https://stackoverflow.com/questions/399366/long-lived-connections-asynchronous-server-push-with-apache-php-javascript)

# cocoa-touch - 从 UIScrollView 中删除视图

> ID：493726
> 
> 赞同：0
> 
> 时间：2009-01-29T22:19:22.453
> 
> 标签：cocoa-touch

我有两个 UIScrollView 可以在它们之间移动图像。用户可以在滚动视图之间来回拖动。我正在尝试为图像从一个滚动视图到另一个滚动视图的移动设置动画。在`-touchesMoved`（在我的 UIViewController 中处理，它有两个自定义 UIScrollViews 拦截触摸并发送到我的 UIViewController），我试图设置正在移动的 UIImageView 的“中心”。当它被移动时，图像被隐藏在 UIScrollView 后面并且不可见。如何让它出现在 UIScrollView 的顶部？我可以`-touchesEnded`通过在目标滚动视图中设置动画来正确处理。

我也`-convertPoint:fromView:`对 iPhone 编程指南中的用法感到困惑（参见第 3 章，事件处理）。如果触摸坐标在窗口坐标中，则不必使用中心来更改我的视图（UIScrollView 内的 UIImageView 位于 UIView 和窗口内）中心`-convertPoint:toView:`，即

```
imageView.center = [self.view.window convertPoint:currentTouchPosition toView:imageView]; 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-30T05:49:08.193

您可以使用方法 - (void)bringSubviewToFront:(UIView *)view 使图像视图成为最前面的视图。

约翰

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-30T18:51:08.693

这取决于您如何构建视图。如果滚动视图和图像视图都在同一级别，它应该可以工作。如果 imageview 是其中一个滚动视图的子视图，您可以尝试将滚动视图放在前面。这样，图像视图也将被绘制在另一个滚动视图上。

约翰

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-30T19:37:49.033

我有一个带有两个 ScrollViews 的视图控制器。图像作为子视图添加。ScrollViews 已经在前面了。我尝试将滚动视图放在前面，并将滚动视图的图像视图放在前面。但不知何故，当我拖动时，图像的中心越过了我也尝试发回的另一个 scrollview2。但似乎不起作用。这是我在 TouchesMove 中所做的（在 ViewController 内）

view= [[scrollView1 子视图] objectAtIndex:currentImageIndex];

[self.view bringSubviewToFront:scrollView1];

[scrollView1 带来SubviewToFront:view];

[self.view sendSubviewToBack:scrollView2];

scrollView1 和 scrollView2 是两个滚动视图，它们是 ViewController 视图的一部分。这有意义吗？

谢谢莫汉

# c# - Outlook 自定义任务窗格控件

> ID：493731
> 
> 赞同：0
> 
> 时间：2009-01-29T22:21:07.067
> 
> 标签：c#, .net, outlook, visual-studio-addins

我正在开发一个 Outlook 插件，该插件在自定义任务窗格（位于检查器窗口中）中有一个按钮。当它被点击时，我希望它对当前的活动项目做一些事情（在我的例子中，它是约会项目）。我已经尝试过了（此代码在自定义任务窗格类中）：

```
 private void button1_Click(object sender, EventArgs e)
    {

        Outlook.Inspector inspector = (Outlook.Inspector)Globals.ThisAddIn.Application.ActiveInspector;
        Outlook.AppointmentItem appt = (Outlook.AppointmentItem)inspector.CurrentItem;
        appt.Body += "this is a test";
    } 
```

但它通过我这个错误：

> 无法将方法组“ActiveInspector”转换为非委托类型“Microsoft.Office.Interop.Outlook.Inspector”。您是否打算调用该方法？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-30T06:53:51.603

我认为 ActiveInspector 是一种方法而不是一种属性。

试试这个
Outlook.Inspector 检查器 = (Outlook.Inspector)Globals.ThisAddIn.Application.ActiveInspector**()**;

# c# - 反思找到嵌套类？

> ID：493732
> 
> 赞同：2
> 
> 时间：2009-01-29T22:21:17.847
> 
> 标签：c#, reflection

我有一个看起来像这样的类：

```
public class Parent
{
    public class Subclass
    {
    }
} 
```

并使用反射我试图找到子类

```
void main
{
    Parent p = new Parent();
    Type t = p.GetType();
    Type s = t.GetNestedType("Subclass"); //s is not set
} 
```

这不起作用，因为显然没有嵌套类型。如何找到子类的类型？我需要获取 s 的原因是稍后调用 .GetMethod("someMethod").Invoke(...) 。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-29T22:28:46.430

我只是尝试了完全相同的东西，它对我有用：

```
 public class ParentClass
    {
        public class NestedClass
        {

        }
    }

       private void button1_Click(object sender, EventArgs e)
        {
            Type t = typeof(ParentClass);
            Type t2 = t.GetNestedType("NestedClass");
            MessageBox.Show(t2.ToString());
        } 
```

您确定 NestedClass 是公开的吗？

# sharepoint - 如何创建一个以 Doc Lib 为目标并使用文档“名称”的查找列？

> ID：493734
> 
> 赞同：4
> 
> 时间：2009-01-29T22:21:35.193
> 
> 标签：sharepoint, content-type, lookup, document-library

如何为使用文档的“名称”作为查找值的文档库创建查找列？

我发现一篇博客文章建议添加另一个自定义字段，例如“文件名”，然后使用项目接收器使用名称字段中的值填充自定义字段，但这似乎很俗气。如果人们感兴趣，可以链接到博客：http: [//blogs.msdn.com/pranab/archive/2008/01/08/sharepoint-2007-moss-wss-issue-with-lookup-column-to-doc-库名称字段.aspx](http://blogs.msdn.com/pranab/archive/2008/01/08/sharepoint-2007-moss-wss-issue-with-lookup-column-to-doc-lib-name-field.aspx)

我有一堆自定义文档内容类型，我不想用一个无论如何都应该真正工作的解决方法弄乱它们。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-11-04T18:12:41.930

我创建了一个一步的工作流程来从名称中设置标题，在修改和创建时触发。似乎工作并花了几秒钟的时间来创建。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-30T00:33:13.930

您可以执行此操作的一种方法（尽管不是最简单的方法）是创建扩展 SPFieldLookup 类的自定义字段类型。SharePoint 的查找字段字段编辑器有意隐藏查找字段不支持的任何列类型，但您可以为显示它们的自定义字段类型创建字段编辑器。

但是，我之前已经创建了一个指向文档库中的名称列的查找列，它可能不像您期望的那样工作。虽然查找列中存储的值有效，但它不会显示在列表视图或视图属性表单中。

您发布的解决方案实际上可能是处理此问题的最佳方法。如果您想处理更复杂的场景，查找字段需要一些杂项，但这是因为它们并不意味着提供与数据库中的外键关系相同的功能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-01-27T04:02:58.390

任何形式的编码总是让我害怕。所以这就是我所做的：我只是将愚蠢的“标题”字段重命名为别的东西，比如“关键字”，因为你不能对那个字段做任何事情：甚至不能让它成为强制性的。然后我创建了另一个名为“Title”的单行字段并将该字段用于查找

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-12-03T22:11:37.653

好吧，有一个简单的解决方案，并且在某些情况下可能会起作用。简而言之，如果您将 Title 字段设为 Mandatory，这将强制用户输入标题。通过这种方式，我们可以将标题字段用作查找字段。

现在该怎么做？完成创建文档库后，转到库设置。选择高级设置并为选项“允许管理内容类型？”选择是。然后返回库设置并在内容类型下选择“文档”内容类型。然后选择标题列，然后选择“必填（必须包含信息）”并说确定。

现在尝试将文档上传到此文档库。您将在表单中看到标题字段。

希望这有助于干杯 Vaqar

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-06-21T14:26:54.507

您必须将字段添加为 XML，ShowField 为“FileLeafRef”

```
var XmlFieldDefinition = "<Field DisplayName='myLookupColumn' Type='LookupMulti' StaticName='myLookupColumn' Name='myLookupColumn' Required='FALSE' List='THE LOOKUP ID HERE' WebId='THE WEB ID HERE' UnlimitedLengthInDocumentLibrary='TRUE' Mult='TRUE' Sortable='FALSE' ShowField='FileLeafRef' />"

Field fld = fieldCollection.AddFieldAsXml(XmlFieldDefinition, true, AddFieldOptions.DefaultValue);
ClientContext.Load(fld);

ClientContext.ExecuteQuery();
```

# open-source - 我的 Web 应用程序同时使用 GPL 和 LGPL 的开源许可证是什么？建议？

> ID：493740
> 
> 赞同：3
> 
> 时间：2009-01-29T22:23:21.727
> 
> 标签：open-source, gpl, lgpl

我已经编写了一个我想作为开源发布的应用程序，但我不确定要根据什么许可它。

*除了*GPL 2.1 的 jQuery 和 LGPL 2.1 的 TinyMCE 编辑器之外，这都是我自己的代码。如果可能的话，我想将这两个库与我的应用程序一起分发。我可以在 GPL2.1 下发布吗？

我想做的就是适当地获得许可，并向 jQuery 和 TinyMCE 的聪明作者支付我的开源费用。

有什么建议么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-29T22:29:39.797

jQuery 在[MIT 或 GPL 许可](http://docs.jquery.com/License)下可用。如果您乐于让您的应用程序代码在 GPL 下可用，那么您很好。通常人们有问题是因为他们不想。似乎分发您的应用程序（包括 jquery）会触发 GPL 的特定部分，但 IANAL 所以不要把它当作福音。

如果您不想将代码发布到您的应用程序，您还可以考虑（侵入性较小的）MIT 许可证和 LGPL 之间的兼容性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-29T22:52:16.070

我喜欢 perl 的[Artistic License 2.0](http://www.perlfoundation.org/attachment/legal/artistic-2_0.txt)。它是[与 GPL 兼容](http://www.gnu.org/licenses/license-list.html#GPLCompatibleLicenses)的，但要短一些，并且具有较少的传教性。但是如果你对 GPL 没问题，最好坚持使用它，因为你的脚本所依赖的库正在使用它......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-05-14T18:01:13.937

由于 jQuery 在 MIT License 下可用，而 TinyMCE 在 LGPL 下可用，所以只要您使用 Tiny MCE 作为库，您自己的源代码就可以是封闭源代码、GPL'ed、LGPL'ed 甚至 BSD/麻省理工学院版。

如果您不希望其他人获取您的源代码然后关闭它，您应该使用 GPL 或 LGPL 或 MPL2。LGPL 允许您的部分代码在其他人的闭源应用程序中用作开源库。在您的情况下，我会选择 LGPL 或 MPL2。

如果您不介意其他人获取您的源代码并在他们的闭源应用程序中使用它，那么请使用 BSD/MIT。

# wpf - WPF 实现 INotifyPropertyChanged

> ID：493747
> 
> 赞同：2
> 
> 时间：2009-01-29T22:24:40.540
> 
> 标签：wpf, data-binding, inotifypropertychanged

我已经设置了一个属性并实现了 INotifyPropertyChanged

像这样...

```
public event PropertyChangedEventHandler PropertyChanged;

public FlowProcess LastSelectedFlowProcess
{
    get { return _lastSelectedFlowProcess; }
    set
    {
        _lastSelectedFlowProcess = value;
        Notify("LastSelectedFlowProcess");
        UpdateFlows();
    }
}

private void Notify(string propName)
{
    if (PropertyChanged != null)
        PropertyChanged(this, new PropertyChangedEventArgs(propName));
} 
```

我在其他类上使用了这种精确设置，但由于某种原因，在 Notify 方法中，PropertyChanged 变量返回 null。

在其他类中，当此方法起作用时，PropertyChanged 事件不为空并评估为委托？我在这里想念什么？

我从类内部调用公共访问器会有所作为吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-29T22:32:14.207

委托是否为空取决于是否有任何东西订阅了该事件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-10-19T07:43:09.780

添加此代码

```
event PropertyChangedEventHandler INotifyPropertyChanged.PropertyChanged {
 add { this.PropertyChanged += value; }
 remove { this.PropertyChanged -= value; }
} 
```

# winforms - 在数据网格中显示工具提示

> ID：493756
> 
> 赞同：0
> 
> 时间：2009-01-29T22:25:56.123
> 
> 标签：winforms, datagrid, tooltip

我正在尝试在数据网格中显示 Windows 窗体工具提示以突出显示错误。我遇到的问题是，每次我调用`tooltip.Show("You have an error", datagrid, 0, 0)`时，工具提示都被限制在数据网格边界内并且不会向外，这最终意味着工具提示本身会覆盖发生错误的实际行。

我想过，`tooltip.Show("You have an error", Form1, ?, ?)`但我没有看到一种简单的方法来计算表单上数据网格的偏移量。由于所有控件都停靠，因此根据用户调整表单大小的方式，位置会发生变化。

需要注意的是，数据网格本身不是 Forms.DataGrid，而是一个 Infragistics UltraGrid，它本身可能会做一些有趣的事情，这超出了我的能力范围。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-29T23:42:40.850

你看过这些：

[HOWTO：为 WinGrid 创建高级工具提示](http://devcenter.infragistics.com/Support/KnowledgeBaseArticle.Aspx?ArticleID=5646)

[BeforeDisplayDataErrorTooltip 事件](http://help.infragistics.com/Help/NetAdvantage/NET/2007.3/CLR2.0/html/Infragistics2.Win.UltraWinGrid.v7.3~Infragistics.Win.UltraWinGrid.UltraGrid~BeforeDisplayDataErrorTooltip_EV.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-02-23T23:13:54.727

事实证明，通过查询与其关联的 UIElement 从 UltraGrid 中获取 Show 命令的位置很容易。这就是我正在做的事情：

```
private void ultraGrid1_BeforeCellUpdate(object sender, BeforeCellUpdateEventArgs e)
{
    if (!DataFormat.CanEdit(e.Cell.Row.ListObject, e.Cell.Column.PropertyDescriptor))
    {  
        var tip = new System.Windows.Forms.ToolTip();
        tip.BackColor = Color.Orange;
        tip.Show("unable to edit", this, e.Cell.GetUIElement().Rect.Left, e.Cell.GetUIElement().Rect.Top, 500);
        e.Cancel = true;
    }
} 
```

# mysql - 使用哪种类型的连接？

> ID：493765
> 
> 赞同：0
> 
> 时间：2009-01-29T22:27:23.810
> 
> 标签：mysql

我有一个名为 PROJECT_CATEGORY 的表，它包含两个字段

cat_id 和 cat_title

我将 cat_id 存储在另一个名为 PROJECTS 的表中，因此：

```
project_category.cat_id = projects.cat_id 
```

使用 MySQL 运行查询以显示`cat_title`. 换句话说，我想显示名称而不是表的 ID 号。这会起作用吗：

```
SELECT * FROM projects INNER JOIN projects ON project_category.cat_id = projects.cat_id 
```

然后调用它：

```
'.$row['cat_title'].' 
```

有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-29T22:30:59.387

如果*每个*项目都有一个有效的 cat_id 并且 cat_id 是唯一的，那么 INNER JOIN 就可以了。

如果任何项目的 cat_id 为 NULL，则需要 LEFT JOIN。

如果 cat_id 不是唯一字段（主键），您可能希望使用子查询将自己限制为每个项目一个结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-29T22:31:20.900

```
SELECT
  projects.cat_id cat_id
FROM
  projects INNER JOIN
  project_category ON project_category.cat_id = projects.cat_id 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-29T22:32:03.490

```
SELECT cat_title 
FROM projects 
    INNER JOIN project_category ON project_category.cat_id = projects.cat_id 
```

那应该行得通。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-29T23:13:42.767

您的加入看起来不错。FWIW，在这种情况下，我会使用该`USING`子句。它的工作原理相同，但更清晰简洁：

```
SELECT * FROM projects INNER JOIN project_category USING (cat_id); 
```

如果您在`$row`关联数组中查找列时遇到问题，我会检查列定义的拼写，包括大小写。如果您以这种方式声明您的表：

```
CREATE TABLE `Project_Category` (
  `Cat_ID`    INTEGER NOT NULL,
  `Cat_Title` VARCHAR(20) NOT NULL
); 
```

然后结果集可以在数组键中使用该文字拼写和大写。PHP 数组键区分大小写。

```
print $row['Cat_Title']; 
```

您可能应该转储`$row`数组以查看它认为它的键是什么：

```
print_r($row); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-29T22:34:47.757

尽量不要使用 SELECT *，而是选择您需要的特定字段。此外，如果您在查询中使用多个表，请正确为它们设置别名，以便您可以根据需要提取值而不会遇到歧义问题。

无论如何，您可以尝试以下方法：

```
SELECT       
 project_category.cat_title 
 ,projects.*  
FROM   
 projects   
  LEFT OUTER JOIN     
   project_category
    ON project_category.cat_id = projects.cat_id 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-01-27T22:42:32.457

您可以使用`NATURAL JOIN`：

```
SELECT CAT_TITLE
FROM projects
NATURAL JOIN project_category 
```

如果列是相同类型且不为空，则无需将字段放入连接中，它会正常工作。

# asp.net - 灵活的分层 ASP.NET 框架（Digg/Blog/CMS）

> ID：493771
> 
> 赞同：0
> 
> 时间：2009-01-29T22:28:04.637
> 
> 标签：asp.net, frameworks, content-management-system, digg, kigg

对于我的下一个网站，我不想从头开始编写所有内容。同时，我不想过多地关注一个框架。所以我想要一些我可以在所有级别使用的东西。

1.  直接访问数据库（SQL Server）（数据库布局不应该比自己编写的应用程序复杂得多）
2.  商业逻辑
3.  界面组件（Web 部件/控件） - 例如登录，阅读最多的文章。

对于前端，应该有我可以轻松更改的示例页面。

该应用程序将有点像 DIGG，但具有不同的前端。有一个名为 [KIGG](http://www.codeplex.com/Kigg)的框架。但我不太了解它如何符合我的标准。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-30T06:33:07.403

Kigg 符合你的大部分标准——我会从那里开始。现在有一个构建在 Kigg 之上的站点，名为 http://DotNetShoutout.com [，](http://DotNetShoutout.com)它向您展示了该框架可以做什么。

# asp.net - 使用 Visual Studio Web 服务器运行时的身份验证对话框

> ID：493772
> 
> 赞同：3
> 
> 时间：2009-01-29T22:28:11.827
> 
> 标签：asp.net, visual-studio, iis, authentication, cassini

使用 Visual Studio 的内置 Web 服务器时，每次我发出页面请求时，都会弹出标准登录框并要求提供凭据。如果我真的输入我的凭据，它就不起作用，所以我只需要点击取消 5 次，它就会消失。

当我通过 IIS（本地或在测试服务器上）运行应用程序时，它工作得很好（没有登录框出现）。

任何人都知道如何解决这个问题或知道可能是什么原因造成的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-29T23:02:47.123

我假设您的意思是 JavaScript 警报框外观的登录对话框，对吧？当您向 IIS 禁用匿名访问的网站部分发出请求时，会弹出此对话框。它不同于 ASP.NET 身份验证。

您是否对网站的某些部分进行了保护？或者您是否向外部站点发出任何 HTTP 请求，例如图像等？

如果您的页面在多次点击取消后看起来还不错，那么它一定是对受保护文件（如图像、css、js 或其他文件）的 HTTP 请求之一。

当您在该登录对话框中点击取消时，我会查看 Fiddler 或 Firebug 以查看是否有任何请求失败。

我还会尝试清除在 IIS 上运行的页面上的缓存/身份验证会话，以查看它是否真的向您显示了该登录对话框。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-30T23:58:21.320

我有同样的问题。但是，我的解决方案不同，问题似乎也不同。

我一直在使用 VS 2008 开发 ASP.NET 2.0 Web 应用程序。内置 IIS 服务器一切正常。我大约一周没有打开这个项目，然后当我在 VS 中选择“在浏览器中查看”时，系统提示我输入我的 Windows 登录凭据。这个项目以前从来没有这样做过，所以我有点困惑。我检查了所有 web.config 设置，一切似乎都很好。我的项目设置似乎也正确。我决定通过在 VS 中使用网络路径在我的网络上的一个单独的开发盒上打开同一个项目来测试该项目。我再次选择了“在浏览器中查看”，它运行良好。没有登录提示。

这告诉我问题不在于实际的 Web 项目本身，而在于我的开发环境。我按照上面的建议检查了所有浏览器设置，它们是正确的。然后我比较了我的项目设置，同时我在两个开发框中都打开了相同的项目（相同的物理文件）。我注意到了一个不同...

在属性页中的启动选项下，Web 服务器被设置为在这两种情况下都使用默认 Web 服务器。但是，在询问我的凭据的框中，选择了 NTLM 身份验证复选框。我取消选择它，它解决了这个问题。

我不确定这是怎么可能的，因为我打开的是相同的项目文件，并且会假设项目设置完全相同。一周前它运行良好的事实真的让我感到困惑。我把它归结为 VS 2008 的问题。我希望这对可能遇到此问题的其他人有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-19T14:59:11.680

这是因为 localhost 不在我受信任的站点中，所以它不会进行自动 NTLM 身份验证......我不确定为什么会这样，但它是......将 localhost 添加到列表中修复了它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-09-23T20:24:00.713

在您的项目中，应该有一个**vwd.webinfo**文件。

以下行在调试时控制身份验证（在 IISExpress 中）。如下设置以避免所有对话框。

```
<VisualWebDeveloper>
<iisExpressSettings anonymousAuthentication="enabled" windowsAuthentication="disabled" useClassicPipelineMode="false"/>
</VisualWebDeveloper> 
```

如果`windowsAuthentication="enabled"` 您仍然可以得到一个对话框，即使`anonymousAuthentication="enabled"`:-)

# c++ - 为什么标准的 C++ 容器适配器不提供明确的功能？

> ID：493774
> 
> 赞同：23
> 
> 时间：2009-01-29T22:29:11.997
> 
> 标签：c++, stl, standards

有谁知道为什么 std::queue、std::stack 和 std::priority_queue 不提供`clear()`成员函数？我必须像这样伪造一个：

```
std::queue<int> q;
// time passes...
q = std::queue<int>();  // equivalent to clear() 
```

IIRC，`clear()`由所有可以作为底层容器的东西提供。是否有充分的理由不让容器适配器提供它？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-01-29T22:57:36.167

好吧，我认为这是因为`clear`没有被认为是对队列、priority_queue 或堆栈的有效操作（顺便说一下，deque 不是适配器，而是容器）。

> 使用容器适配器队列而不是容器双端队列的唯一原因是要明确说明您只执行队列操作，而不执行其他操作。[（来自队列中的 sgi 页面）](http://www.sgi.com/tech/stl/queue.html)

因此，当使用队列时，您所能做的就是推送/弹出元素；清除队列可以看作是对 FIFO 概念的违反。因此，如果您需要清除队列，也许它并不是真正的队列，您最好使用双端队列。

但是，这种观念有点狭隘，我觉得像你这样排长队是公平的。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-01-29T22:48:41.100

双端队列有 clear()。参见例如[http://www.cplusplus.com/reference/stl/deque/clear.html](http://www.cplusplus.com/reference/stl/deque/clear.html)。

但是，队列没有。但是你为什么要选择队列而不是双端队列呢？

> 使用容器适配器队列而不是容器双端队列的唯一原因是要明确您只执行队列操作，而不执行其他操作。

( [http://www.sgi.com/tech/stl/queue.html](http://www.sgi.com/tech/stl/queue.html) )

所以我猜 clear() 不是队列操作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-29T22:56:07.700

我会说这是因为容器适配器不是容器。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-29T22:59:33.370

您可以清除队列（以及 std::stack 和 priority_queue），只要您从它继承即可。容器故意受到保护以允许这样做。

```
#include <queue>

using namespace std;

class clearable_queue : public queue<int>
{
public:
  void clear()
    {
      // the container 'c' in queues is intentionally left protected
      c.clear();
    }
};   

int main(int argc, char** argv)
{
  clearable_queue a;
  a.clear();
} 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-01-29T22:46:05.490

我认为这取决于实现——直到最近微软 STL 还没有明确几个容器。（现在可以了，例如[这个快速的谷歌结果](http://support.microsoft.com/kb/156590)）

然而，clear() 通常只是对 erase(begin(), end()) 的调用，因此请实现您自己的等价物并改用它。

我认为该标准将 clear 称为在迭代器范围内擦除，因此以上是大多数实现将提供的。（[例如 Dinkumware 的](http://www.dinkumware.com/manuals/?manual=compleat&page=lib_cont.html#Container::clear)）

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-01-29T22:58:32.373

std::queue、std::deque 和 std::priority_queue 是容器适配器，仅提供少量方法来访问底层容器。

您可以清除底层容器，只要您可以访问它。为此，请创建底层容器以传递给 apadptor 构造函数。例如：

```
std::deque< int > d;
std::queue< int > q( d );

... time passes ...

d.clear(); 
```

编辑：附加信息

我还应该警告您在这里小心行事，因为在底层容器上调用方法可能会破坏适配器所做的假设。在这方面，您当前清除队列的方式似乎更可取。

# ruby-on-rails - 引用的 add_column (Rails)

> ID：493777
> 
> 赞同：64
> 
> 时间：2009-01-29T22:30:19.157
> 
> 标签：ruby-on-rails, schema

我有以下完美运行的 Rails 迁移（删除了不相关的部分）：

```
create_table :comments do |t|
  t.text :body
  t.references :post
end 
```

现在我想`author`在我的表中添加一列`comments`（这是用户的用户 ID），但我不知道该怎么做（我很想只使用 编写 MySql 特定的语法`execute`）。

我一直在看 add_column[这里](http://api.rubyonrails.com/classes/ActiveRecord/ConnectionAdapters/SchemaStatements.html#M001658)没有提到`references`. 我实际上找到了[TableDefinition#references](http://api.rubyonrails.com/classes/ActiveRecord/ConnectionAdapters/TableDefinition.html#M001737)但我不知道如何将它与`add_column`语句一起使用。

这可能吗？另外，对于 MySql，“引用”功能是否真的没有在表之间建立关系？

* * *

## 回答 #1

> 赞同：116
> 
> 时间：2010-10-15T18:21:39.023

虽然现在想从中得到任何点都为时已晚，但我想我会为后代发布最好的方法:)

使用`change_table`而不是`create_table`向已经存在的表添加列，具有所有 TableDefinition 优点：

```
self.up do
  change_table :comments do |t|
    t.references :author
  end
end 
```

这可能看起来微不足道，但是像 Devise 这样的其他 gem 大量使用了它们自己的自定义表定义，这样您仍然可以使用它们。

* * *

## 回答 #2

> 赞同：96
> 
> 时间：2014-01-07T19:25:17.997

```
add_reference :table_name, :reference, index: true 
```

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2011-04-21T10:12:26.633

终于明白了

```
add_column :locations, :state_id , :integer, :references => "states" 
```

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2009-01-29T22:39:52.397

首先，做：

```
script/generate migration AddAuthorIdToComments 
```

打开生成的文件并添加以下行：

```
add_column :comments, :author_id, :integer 
```

然后在您的模型文件中：

```
class User < ActiveRecord::Base
  has_many :comments, :foreign_key => "author_id"
end

class Comment
  belongs_to :author, :class_name => User
end 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-29T22:43:39.270

自从我看过这个已经有一段时间了，但最后我检查了迁移不支持创建外键。不过幸运的是，[它有一个插件](http://github.com/harukizaemon/foreign_key_migrations/tree/master)。我用过这个，效果很好。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-29T22:34:37.947

`add_column(:table, :column_name, :type, :options)`您可以在新的迁移中添加列。

# vba - VBA：复制时删除前面的零

> ID：493780
> 
> 赞同：4
> 
> 时间：2009-01-29T22:31:08.357
> 
> 标签：vba, excel

我正在使用 VBA 创建 Excel 文件的副本。在该文件中，有一列包含前面带有零的数字。创建了文件的副本，但删除了该列中的数据。我需要保留前面零的值。如何使用 VBA 解决此问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-30T00:13:59.617

最好的方法是通过将 Range.NumberFormat 设置为“@”来将列预格式化为文本。这样，如果用户编辑单元格，则单元格将保持为文本并保持其前导零。这是一个 VBA 示例：

ActiveSheet.Range("C:C").NumberFormat = "@"

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-29T22:33:03.190

在导出之前将该列中的每个单元格转换为文本字段。这应该确保每个字符都被保留（而不是像数字一样对待，这听起来像是正在发生的事情）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-18T20:20:53.613

另一种可能性是将撇号附加到每个单元格。这会将所有值视为文本，这在不同选项卡将常见值视为文本与数字（即复制与计算）时很有用。

这是通过使用 Chr() 函数并为其分配字符代码 39(') 来完成的：

```
For x = 1 to 100
If Sheets(origSheet).Cells(x, "A").Value <> "" Then
            Sheets(origSheet).Cells(x, "A").Value = Chr(39) & Sheets(origSheet).Cells(x, "A").Value
        End If 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-30T00:14:02.923

鉴于已接受的答案，它可能不是您需要的，但设置自定义数字格式也会使前面的零回到显示的值。

例如，要显示前导零最多 8 位的值，将格式设置为 00000000，则 123 将显示为 00000123。

此处的方法和格式为文本的方法都将导致在计算中仍然有效的单元格值，尽管默认情况下水平对齐方式会有所不同。另请注意，例如，将字符串连接到值将导致差异：

作为文本：显示 00000123，附加“x”以获得 00000123x

作为具有自定义格式的数字：显示 00000123，附加“x”以获得 123x，因为它仍然是一个数字。

不过可能是 TMI！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-05-21T12:39:33.397

这是我为解决此问题而创建的代码：

```
Public Sub Change_10_Digit()
'----------------------------------------------------------------------------
' Change numeric loan number ot a 10 digit text number
' 2010-05-21 by Jamie Coxe
'
' Note: Insure exracted data Column is formated as text before running macro
'----------------------------------------------------------------------------

        Dim Lastrow As Long
        Dim StartRow As Long
        Dim Col As String
        Dim RowNum As Long
        Dim nCol As String
        Dim Loan As String
        Dim Digit_Loan As String
        Dim MyCell As String
        Dim NewCell As String
        Dim Cell_Len As Long
        Dim MyOption As Long

'----- Set Options -------------------------------------------------------

    MyOption = 2 '1 = place data in new column, 2 = Replace data in cell
    StartRow = 2 'Start processing data at this row (skip header row)
    Col = "B" 'Loan number in this colmun to be changed to 10 digit
    nCol = "G" 'New column to place value (option 1 only)

'----- End Option Setings ------------------------------------------------

    'Get last row
    Lastrow = Range(Col & "65536").End(xlUp).Row

    For RowNum = StartRow To Lastrow
        'Combined Column and Row number to get cell data
        MyCell = Col & RowNum

        'Get data in cell
        Loan = Range(MyCell).Value

        'Change data in cell to 10 digit numeric with leading zeros
        Digit_Loan = Format(Loan, "0000000000")

        If My0ption = 1 Then
            'Option 1 enter value in new cell
            NewCell = nCol & RowNum
            Range(NewCell).Value = Digit_Loan
        Else
            'Option 2 replace value in cell
            Range(MyCell).Value = Digit_Loan
        End If

    Next RowNum

End Sub 
```

# asp.net - 如何构建 ImageButton 控件适配器（或者更一般地说，如何构建一个简单的控件适配器）？

> ID：493800
> 
> 赞同：0
> 
> 时间：2009-01-29T22:38:49.653
> 
> 标签：asp.net, css, control-adapter

这个问题的灵感来自于我`border-width: 0px;`在 ImageButton Web 控件上发现了非常烦人的默认样式 ( )。简单的解决方案是通过将您自己的样式添加到控件来覆盖它，例如`Style="border-width: 2px;"`.

无论如何，如果只是制作一个简单的控件适配器，它会在正确的位置介入并告诉控件不要呈现默认样式，那就太好了。

在查看了来自 CSSFriendly ControlAdapter 项目的代码之后，似乎他们正在重新创建大部分渲染，这对于我想要做的事情来说太过分了——即只需更改渲染出来的默认样式。

那么问题来了，如何只通过控制适配器修改默认样式的渲染，其余的保持原样？

甚至可能吗？

谢谢，埃吉尔。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-04T01:53:24.500

有两种方法可以做到这一点。两者都需要编写自定义控制适配器。您可以在代码中设置实际值，也可以根本不包含该值，然后使用 CSS 设置您的值。这是您需要执行此操作的代码。

```
namespace TestApp
{
    using System.IO;
    using System.Web.UI;
    using System.Web.UI.Adapters;

    public class ImageAdapter : ControlAdapter
    {
        protected override void Render(HtmlTextWriter writer)
        {
            base.Render(new RewriteImageHtmlTextWriter(writer));
        }

        public class RewriteImageHtmlTextWriter : HtmlTextWriter
        {
            public RewriteImageHtmlTextWriter(TextWriter writer)
                : base(writer)
            {
                InnerWriter = writer;
            }

            public RewriteImageHtmlTextWriter(HtmlTextWriter writer)
                : base(writer)
            {
                InnerWriter = writer.InnerWriter;
            }

            public override void AddAttribute(HtmlTextWriterAttribute key, string value, bool fEncode)
            {
                if (key == HtmlTextWriterAttribute.Border)
                {
                    // change the value
                    //value = "2";

                    // -or-

                    // don't include the value
                    //return;
                }

                base.AddAttribute(key, value, fEncode);
            }

            public override void AddStyleAttribute(HtmlTextWriterStyle key, string value)
            {
                if (key == HtmlTextWriterStyle.BorderWidth)
                {
                    // change the value
                    //value = "2px";

                    // -or-

                    // don't include the value
                    //return;
                }

                base.AddStyleAttribute(key, value);
            }
        }
    }
} 
```

然后，您需要在其中一个浏览器文件中添加一个条目，如下所示

```
<browsers>
  <browser refID="Default">
    <controlAdapters>
      <adapter controlType="System.Web.UI.WebControls.Image" adapterType="TestApp.ImageAdapter, TestApp" />
    </controlAdapters>
  </browser>
</browsers> 
```

# asp.net - 如何在 ASP.NET 中使用标签？

> ID：493801
> 
> 赞同：53
> 
> 时间：2009-01-29T22:39:38.403
> 
> 标签：asp.net, html, usability, label

如何`<label>`在 ASP.NET 应用程序中使用标记？我希望它是有效的、可访问的和可用的。

我了解最佳的 HTML 方式是这样的：

```
<label for="Username">Username:</label>
<input type="text" id="Username" runat="server" /> 
```

但是如果上面的代码在一个 ASP.NET 用户控件中，输入 ID 会改变，这意味着标签的“for”属性是没有用的。我可以将标签标记作为服务器控件并在代码 ( `Username.ClientID`) 中设置其“for”属性，但对于这样一个简单的事情来说似乎需要做很多工作。

我也见过过去使用的这个 HTML：

```
<label>
    <span>Username</span>
    <input type="text" id="Username" runat="server" />
</label> 
```

什么是正确的方法？

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2009-01-29T22:41:30.660

我`<asp:Label ... AssociatedControlID="Username" ...>`为此使用控件。它们被渲染为`<label>`标签并`for`适当地设置属性。

请注意，如果您愿意，还可以在 Label 控件中嵌套其他标签：

```
<asp:Label ID="UsernameLabel"
           Text="Username:"
           AssociatedControlID="UsernameTextBox"
           runat="server">
    <asp:TextBox ID="UsernameTextBox" runat="server" />
</asp:Label> 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2010-07-29T04:43:08.010

你也可以这样写：

```
<label for="<%= Username.ClientID %>">Username:</label>
<asp:TextBox ID="Username" runat="server" /> 
```

Phil Haack 有[一篇](http://haacked.com/archive/2007/02/15/asp.net_tip_-_use_the_label_control_correctly.aspx)关于这个主题的博文

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-01-29T22:43:35.447

使用`<asp:Label>`服务器控件。它具有可用于设置关联控件 ID 的属性。

```
<asp:Label ID="label1" runat="server" Text="Username" AssociatedControlID="Text1" />
<asp:TextBox ID="Text1" runat="server" /> 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-01-29T22:43:44.883

我想最简单的方法就是这个。

```
<asp:Label AssociatedControlID="Username" runat="server" Text="Username:"></asp:Label>
<asp:TextBox ID="Username" runat="server"></asp:TextBox> 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2015-10-13T13:45:43.440

如果你想要一个标签，但没有另一个控件可以使用，`AssociatedControlID`可以使用标签本身

```
<asp:Label ID="Not_Span" AssociatedControlID="Not_Span" Text="Will be rendered as label" /> 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2011-05-21T14:21:21.473

如果您使用的是 .NET 4，您现在可以使用 ClientIDMode 属性来配置一个或多个控件以使用静态或可预测的 ID。ClientIDMode 属性可以直接在 TextBox 上设置，也可以在任何父控件或包含页面上设置。

```
<label for="Username">Username:</label>
<asp:TextBox ID="Username" runat="server" ClientIDMode="Static" /> 
```

[在MSDN](http://msdn.microsoft.com/en-us/library/system.web.ui.control.clientidmode.aspx)上阅读有关 ClientIDMode 的更多信息

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-01-30T09:53:24.253

```
<p><asp:Label ID="label1"           Text="Username:"           AssociatedControlID="txtUserName"           runat="server">    <asp:TextBox ID="txtUserName" runat="server" /></asp:Label></p> 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2016-05-10T12:29:18.493

你我也试试这个：

```
<asp:Label  ID="Label1" runat="server" Text="label"></asp:Label> 
```

如果您拖放标签，这就是 Visual Studio 或任何其他软件为您提供的。

# python - 输出到文本文件

> ID：493816
> 
> 赞同：2
> 
> 时间：2009-01-29T22:44:05.117
> 
> 标签：python, text

如何将以下代码打印到 .txt 文件

```
y = '10.1.1.' # /24 network, 
for x in range(255):
    x += 1
    print y + str(x) # not happy that it's in string, but how to print it into a.txt 
```

有复制粘贴，但宁愿尝试更有趣的东西。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-29T22:46:38.747

```
f = open('myfile.txt', 'w')
for x in range(255):
    ip = "10.1.1.%s\n" % str(x)
    f.write(ip)
f.close() 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-29T22:46:56.500

脚本名.py >> output.txt

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-29T23:26:55.377

是`x += 1`为了什么？这似乎是一种`range(255)`基于 0 的解决方法 - 它给出了序列 0,1,2...254。

`range(1,256)`会更好地给你你想要的。

其他答案的替代方案：

```
NETWORK = '10.1.1'
f = open('outfile.txt', 'w')
try:
    for machine in range(1,256):
        print >> f, "%s.%s" % (NETWORK, machine)
finally:
    f.close() 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-31T00:38:51.003

在 Python 3 中，您可以使用 print 函数的名为 file 的关键字参数。“a”的意思是“追加”。

```
f = open("network.txt", "a")
for i in range(1, 256):
    print("10.1.1." + str(i), file=f)
f.close() 
```

# iphone - 如何创建浮点值的 NSMutableArray

> ID：493817
> 
> 赞同：30
> 
> 时间：2009-01-29T22:44:06.023
> 
> 标签：iphone, objective-c, arrays, double

我是 Objective-C 和 iPhone 开发的新手，我正在尝试将浮点值存储在 NSMutableArray 中，但是当我这样做时，我收到一条错误消息，提示“'addObject 的参数 1 的类型不兼容”。我究竟做错了什么？我正在尝试创建一个可以用来执行数学计算的双精度数组。

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2009-01-29T22:55:15.937

NSMutableArray 仅保存对象，因此您希望使用 NSNumber 对象加载数组。创建每个 NSNumber 以保存您的双精度，然后将其添加到您的数组中。也许是这样的。

```
NSMutableArray *array = [[NSMutableArray alloc] init];
NSNumber *num = [NSNumber numberWithFloat:10.0f];
[array addObject:num]; 
```

根据需要重复。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-01-29T22:52:34.710

使用 NSNumber 来包装你的浮点数，因为字典需要一个对象：

```
[myDictionary setObject:[NSNumber numberWithFloat:0.2f] forKey:@"theFloat"];
/* or */
[myDictionary setObject:@0.2f forKey:@"theFloat"]; 
```

通过发送 floatValue 检索它：

```
float theFloat = [[myDictionary objectForKey:@"theFloat"] floatValue]; 
```

代码未经测试。

您也可以在 NSNumber 中包装许多其他数据类型，请查看[文档](http://developer.apple.com/DOCUMENTATION/Cocoa/Reference/Foundation/Classes/NSNumber_Class/Reference/Reference.html)。NSPoint 和 NSRect 等结构也有[NSValue](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/nsvalue_Class/Reference/Reference.html)。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-29T23:03:06.110

在 Cocoa 中，NSMutableDictionary（以及所有的集合，真的）需要对象作为值，所以你不能简单地传递任何其他数据类型。正如 sjmulder 和 Ryan 所建议的那样，您可以将标量值包装在 NSNumber（用于数字）和 NSValue 用于其他对象的实例中。

如果您代表十进制数字，例如价格，我建议您也查看和使用[NSDecimalNumber](https://developer.apple.com/iphone/library/documentation/Cocoa/Reference/Foundation/Classes/NSDecimalNumber_Class/Reference/Reference.html#//apple_ref/doc/uid/20000179-1904)。然后，您可以避免浮点不准确问题，并且通常可以将“值”作为[NSDecimalNumber](https://developer.apple.com/iphone/library/documentation/Cocoa/Reference/Foundation/Classes/NSDecimalNumber_Class/Reference/Reference.html#//apple_ref/doc/uid/20000179-1904)使用和存储，而不是用代码中的原语表示它。

例如：

```
// somewhere
NSDecimalNumber* price = [[NSDecimalNumber decimalNumberWithString:@"3.50"] retain];
NSMutableArray*  prices= [[NSMutableArray array] retain];

// ...

[prices addObject:price]; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-05-22T07:00:57.640

```
NSMutableArray *muArray = [[NSMutableArray alloc] init];
NSNumber *float = [NSNumber numberWithFloat:210.0f];
NSNumber *float1 = [NSNumber numberWithFloat:211.0f];
[muArray addObject:float];
[muArray addObject:float1];

NSlog(@"my array is--%@",muArray); 
```

# python - 为什么是 string.join(list) 而不是 list.join(string)？

> ID：493819
> 
> 赞同：1961
> 
> 时间：2009-01-29T22:45:13.697
> 
> 标签：python, string, list

这一直让我感到困惑。看起来这样会更好：

```
my_list = ["Hello", "world"]
print(my_list.join("-"))
# Produce: "Hello-world" 
```

比这个：

```
my_list = ["Hello", "world"]
print("-".join(my_list))
# Produce: "Hello-world" 
```

有这样的具体原因吗？

* * *

## 回答 #1

> 赞同：1364
> 
> 时间：2009-01-29T22:51:18.363

这是因为可以连接任何可迭代对象（例如，list、tuple、dict、set），但其内容和“joiner”*必须是*字符串。

例如：

```
'_'.join(['welcome', 'to', 'stack', 'overflow'])
'_'.join(('welcome', 'to', 'stack', 'overflow')) 
```

```
'welcome_to_stack_overflow' 
```

使用字符串以外的东西会引发以下错误：

> 类型错误：序列项 0：预期的 str 实例，找到 int

* * *

## 回答 #2

> 赞同：377
> 
> 时间：2012-09-30T15:21:16.000

这在[String 方法中进行了讨论......最终](http://mail.python.org/pipermail/python-dev/1999-June/095366.html "字符串方法...终于")在 Python-Dev 归档中进行了讨论，并被 Guido 接受。该线程始于 1999 年 6 月，并`str.join`包含在 2000 年 9 月发布的 Python 1.6 中（并支持 Unicode）。Python 2.0（支持的`str`方法包括`join`）于 2000 年 10 月发布。

*   此线程中提出了四个选项：
    *   `str.join(seq)`
    *   `seq.join(str)`
    *   `seq.reduce(str)`
    *   `join`作为内置函数
*   Guido 不仅希望支持`list`s 和`tuple`s，还希望支持所有序列/可迭代对象。
*   `seq.reduce(str)`对于新人来说很难。
*   `seq.join(str)`从序列到 str/unicode 引入了意外的依赖性。
*   `join()`作为内置函数将仅支持特定的数据类型。所以使用内置命名空间并不好。如果`join()`支持多种数据类型，则创建优化的实现将很困难，如果使用该`__add__`方法实现，那么它将 ve `O(n²)`。
*   `sep`不应省略分隔符字符串 ( )。显式优于隐式。

以下是一些额外的想法（我自己的和我朋友的）：

*   Unicode 支持即将到来，但它不是最终的。那时 UTF-8 最有可能取代 UCS2/4。要计算 UTF-8 字符串的总缓冲区长度，需要知道字符编码规则。
*   那时，Python 已经决定了一个通用的序列接口规则，用户可以在其中创建一个类似序列（可迭代）的类。但是 Python 直到 2.2 才支持扩展内置类型。当时很难提供基础`iterable`课程（在另一条评论中提到）。

Guido 的决定记录在[历史邮件](http://mail.python.org/pipermail/python-dev/1999-June/095436.html "历史邮件")中，决定`str.join(seq)`：

> 有趣，但它似乎是正确的！巴里，加油……
> 吉多·范·罗森

* * *

## 回答 #3

> 赞同：256
> 
> 时间：2009-01-29T22:48:38.650

因为`join()`方法在字符串类，而不是列表类？

我同意这看起来很有趣。

请参阅[http://www.faqs.org/docs/diveintopython/odbchelper_join.html](http://www.faqs.org/docs/diveintopython/odbchelper_join.html)：

> **历史注释。**当我第一次学习 Python 时，我期望 join 是一个列表的方法，它将分隔符作为参数。很多人都有同样的感受，join 方法背后有一个故事。在 Python 1.6 之前，字符串没有所有这些有用的方法。有一个单独的字符串模块，其中包含所有字符串函数；每个函数都将一个字符串作为它的第一个参数。这些函数被认为足够重要，可以放在字符串本身上，这对于像 lower、upper 和 split 这样的函数是有意义的。但是许多核心 Python 程序员反对新的 join 方法，认为它应该是列表的一个方法，或者它根本不应该移动，而只是保留旧字符串模块的一部分（它仍然有很多里面有用的东西）。我专门使用新的加入方法，
> 
> --- Mark Pilgrim，潜入 Python

* * *

## 回答 #4

> 赞同：75
> 
> 时间：2009-01-29T23:03:45.953

我同意一开始这是违反直觉的，但这是有充分理由的。Join 不能是列表的方法，因为：

*   它也必须适用于不同的可迭代对象（元组、生成器等）
*   它必须在不同类型的字符串之间具有不同的行为。

实际上有两种连接方法（Python 3.0）：

```
>>> b"".join
<built-in method join of bytes object at 0x00A46800>
>>> "".join
<built-in method join of str object at 0x00A28D40> 
```

如果 join 是一个列表的方法，那么它必须检查它的参数来决定调用其中的哪一个。而且你不能将 byte 和 str 连接在一起，所以他们现在拥有它的方式是有意义的。

* * *

## 回答 #5

> 赞同：47
> 
> 时间：2015-04-14T00:45:18.070

> # 为什么是它`string.join(list)`而不是`list.join(string)`？

这是因为`join`是一个“字符串”方法！它从任何可迭代对象中创建一个字符串。如果我们将方法固定在列表上，那么当我们有不是列表的可迭代对象时呢？

如果你有一个字符串元组怎么办？如果这是一种`list`方法，则必须将每个这样的字符串迭代器转换为 a `list`，然后才能将元素连接成单个字符串！例如：

```
some_strings = ('foo', 'bar', 'baz') 
```

让我们滚动我们自己的列表连接方法：

```
class OurList(list): 
    def join(self, s):
        return s.join(self) 
```

要使用它，请注意，我们必须首先从每个可迭代对象中创建一个列表，以将字符串连接到该可迭代对象中，这会浪费内存和处理能力：

```
>>> l = OurList(some_strings) # step 1, create our list
>>> l.join(', ') # step 2, use our list join method!
'foo, bar, baz' 
```

所以我们看到我们必须添加一个额外的步骤来使用我们的列表方法，而不是仅仅使用内置的字符串方法：

```
>>> ' | '.join(some_strings) # a single step!
'foo | bar | baz' 
```

## 发电机的性能警告

Python 用来创建最终字符串的算法`str.join`实际上必须两次传递可迭代对象，因此如果您为其提供生成器表达式，它必须先将其具体化为列表，然后才能创建最终字符串。

因此，虽然传递生成器通常比列表推导更好，但这`str.join`是一个例外：

```
>>> import timeit
>>> min(timeit.repeat(lambda: ''.join(str(i) for i in range(10) if i)))
3.839168446022086
>>> min(timeit.repeat(lambda: ''.join([str(i) for i in range(10) if i])))
3.339879313018173 
```

尽管如此，该操作在语义上仍然是一个“字符串”操作，因此将它放在对象上比放在其他可迭代对象上`str.join`仍然有意义。`str`

* * *

## 回答 #6

> 赞同：24
> 
> 时间：2009-01-30T02:43:51.500

将其视为拆分的自然正交操作。

我理解为什么它适用于任何可迭代的东西，因此不能轻易地*在*列表中实现。

为了可读性，我希望在语言中看到它，但我认为这实际上不可行 - 如果可迭代性是一个接口，那么它可以添加到接口中，但这只是一个约定，所以没有中心方法将其添加到可迭代的事物集中。

* * *

## 回答 #7

> 赞同：14
> 
> 时间：2017-12-04T12:22:56.047

`-`in`"-".join(my_list)`声明您正在从加入列表的元素转换为字符串。它是面向结果的。（只是为了便于记忆和理解）

我制作了一个详尽的 methods_of_string 备忘单供您参考。

```
string_methods_44 = {
    'convert': ['join','split', 'rsplit','splitlines', 'partition', 'rpartition'],
    'edit': ['replace', 'lstrip', 'rstrip', 'strip'],
    'search': ['endswith', 'startswith', 'count', 'index', 'find','rindex', 'rfind',],
    'condition': ['isalnum', 'isalpha', 'isdecimal', 'isdigit', 'isnumeric','isidentifier',
                  'islower','istitle', 'isupper','isprintable', 'isspace', ],
    'text': ['lower', 'upper', 'capitalize', 'title', 'swapcase',
             'center', 'ljust', 'rjust', 'zfill', 'expandtabs','casefold'],
    'encode': ['translate', 'maketrans', 'encode'],
    'format': ['format', 'format_map']} 
```

* * *

## 回答 #8

> 赞同：13
> 
> 时间：2009-01-29T22:51:45.010

主要是因为 a 的结果`someString.join()`是一个字符串。

序列（列表或元组或其他）不会出现在结果中，只是一个字符串。因为结果是一个字符串，所以它作为一个字符串的方法是有意义的。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2018-05-07T19:32:51.803

两个都不好看。

string.join(xs, delimit) 意味着字符串模块知道存在一个列表，它不知道该列表的存在，因为字符串模块仅适用于字符串。

list.join(delimit) 更好一些，因为我们已经习惯了字符串作为基本类型（从语言上讲，它们确实如此）。然而，这意味着 join 需要动态分派，因为在`a.split("\n")`python 编译器的任意上下文中可能不知道 a 是什么，并且需要查找它（类似于 vtable 查找），如果你经常这样做，这会很昂贵次。

如果 python 运行时编译器知道 list 是一个内置模块，它可以跳过动态查找并将意图直接编码到字节码中，否则它需要动态解析 "a" 的 "join"，这可能需要好几层每个调用的继承（由于调用之间，join的含义可能已经改变，因为python是一种动态语言）。

可悲的是，这是抽象的终极缺陷；无论你选择什么抽象，你的抽象只会在你试图解决的问题的背景下才有意义，因此，当你开始粘合它们时，你永远不可能有一个不会与潜在意识形态不一致的一致抽象在一起，而不是将它们包装在与您的意识形态一致的视图中。知道了这一点，python 的方法更加灵活，因为它更便宜，您可以通过制作自己的包装器或自己的预处理器来支付更多费用以使其看起来“更好”。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2019-10-15T19:38:12.670

变量`my_list`和`"-"`都是对象。具体来说，它们分别是类`list`和的实例`str`。该`join`函数属于类`str`。因此，使用该语法`"-".join(my_list)`是因为对象`"-"`作为`my_list`输入。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2022-03-03T12:30:41.063

你不能只加入列表和元组。你可以加入几乎任何可迭代的。可迭代对象包括生成器、地图、过滤器等

```
>>> '-'.join(chr(x) for x in range(48, 55))
'0-1-2-3-4-5-6'

>>> '-'.join(map(str, (1, 10, 100)))
'1-10-100' 
```

使用生成器、地图、过滤器等的美妙之处在于它们消耗的内存很少，并且几乎是即时创建的。

从概念上讲，这只是另一个原因：

```
str.join(<iterator>) 
```

仅授予 str 这种能力是有效的。而不是向所有迭代器授予连接：列表、元组、集合、字典、生成器、映射、过滤器，所有这些都只有对象作为公共父级。

当然 range() 和 zip() 也是迭代器，但它们永远不会返回 str，因此它们不能与 str.join() 一起使用

```
>>> '-'.join(range(48, 55))
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: sequence item 0: expected str instance, int found 
```

# svn - 如何在硬盘驱动器之间复制整个工作副本？

> ID：493820
> 
> 赞同：2
> 
> 时间：2009-01-29T22:45:20.467
> 
> 标签：svn, windows-vista, tortoisesvn, copying, working-copy

每当我尝试在两台计算机之间使用简单的拖放操作复制整个工作副本（例如，从旧计算机到新计算机，或从一台 VM 到另一台），以避免必须重新下载整个几 GB 的代码集我们的在线存储库一旦到达任何隐藏的 SVN-BASE 文件，就会收到错误消息。

有没有办法在这些完整的情况下复制整个工作副本？

我正在使用 Vista x64。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-29T22:56:44.327

我无法回答 Vista，但在 XP 上，您只需复制目录即可。

我猜Vista已经决定这些文件是隐藏的，因此不需要复制，或者它们被锁定并且不可复制。在前者中，使它们不隐藏（使用资源管理器的组织菜单中的全局文件选项，在文件夹和搜索选项下，查看选项卡下），在后者中，尝试停止可能保留它们的 TortoiseSVN 缓存。

或从命令提示符尝试 Xcopy。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-29T23:12:21.520

我建议在实用程序上使用命令行作为 Total Commander；Explorer 和 Drag&Drop 只是不可靠。通过告诉您遇到什么错误，您可能会更有帮助。

对于命令行，有 xcopy，它将完全满足您的需要。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-29T23:22:07.773

当我设置一台新的 Windows 机器时，我首先安装的东西之一是 Cygwin。我几乎不认为 Windows 已经准备好，直到它在那里。使用 Cygwin，我确保包含 rsync，并且我会使用 rsync 来进行复制，因为它很快并且稍后当我只需要复制差异时会更快。

如果这是您安装 Cygwin 的唯一原因，那么这是一个大锤子。但是如果你已经有了它，没有比 rsync 更好的方法了。另外，rsync 白皮书是我一直以来的最爱之一。;)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-29T23:23:03.917

您是否尝试过[rsync](http://samba.anu.edu.au/rsync/)，它可以选择跳过诸如 SVN 存储库之类的目录？

此外，它使用了一种非常高效的增量文件传输算法来节省传输时间。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-02-10T13:34:05.607

你可以试试

```
xcopy /h /e <src dir> <dest dir> 
```

这将复制“src dir”的全部内容，包括空文件夹和隐藏文件。

# .net - 自定义对象从 WCF 返回为“空”？

> ID：493827
> 
> 赞同：8
> 
> 时间：2009-01-29T22:47:16.530
> 
> 标签：.net, wcf

出于什么原因，WCF 应该返回我一个“空”的实例化对象，当它在我的 WCF 服务返回之前明确填充它通过线路之前？

例如一个简单的`OperationContract`方法：

```
response.Client = new Client();
response.Client.ID = 99;
return response; 
```

返回一个“空”客户端对象（在客户端接收端），所有字段都为空或零。但是就在响应之前，如果我检查 response.Client.ID 它填充了 99？

更糟糕的是，我有一个错误对象，我这样填充：

```
response.Errors.Add(new CodedError(Errors.ErrorCodes.LOGIN_AUTHENTICATION_ERROR)); 
```

但是我可以看到接收端的错误列表吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-29T23:52:46.913

如果有人遇到这个问题，我已经找到了解决方法。由于业务需求，我用`[Serializable]`和标记了我的自定义类，`[DataContract]`从 .NET 3.5 SP1 开始，这似乎是非法的？

我有一个朋友在 .NET 3.5 SP1 之前发送具有这两个属性的 WCF 对象，并且工作正常。有趣的。

仅供参考，我只是使用`[Serializable]`它，它正确地通过我的对象图发送。我需要这个来进行 xml 序列化。

这是一个痛苦的问题，但很高兴它现在终于可以正常工作了......

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-29T22:52:08.940

您的对象是标记为 [Serializable] 还是 [DataContract]？您需要将您的对象标记为一个或另一个。

WCF 只知道如何通过网络传递原语或可序列化对象。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-29T23:48:05.363

客户端代理是最新的吗？我已经看到当合同更改并且客户端没有更新以反映更改时会发生这种情况。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-02-10T08:56:35.913

现在可能为时已晚，但是对于这个特殊问题有一个简单的解决方法。至少有人会发现这很有用。

我有 2 个具有不同名称空间的项目。

1.  **MyProject.Business.Entities**（标有`[DataContract]`）
2.  **MyProject.Client.Entities**（代表业务对象的客户端实体）

使用**AssemblyInfo.cs**并将以下行添加到每个业务和客户项目。

```
[assembly: ContractNamespace("http://www.tempuri.org/MyProject",
                              ClrNamespace = "MyProject.Business.Entities")]

[assembly: ContractNamespace("http://www.tempuri.org/MyProject",
                              ClrNamespace = "MyProject.Client.Entities")] 
```

或者，您也可以这样做。

```
[DataContract (Namespace = "http://www.tempuri.org/MyProject")]
public class Account
{} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-02-08T11:58:37.163

我遇到过同样的问题。我已经更改了服务器端对象上的命名空间，虽然我已经更新了服务参考配置，但仔细观察命名空间是旧的命名空间，所以虽然提琴手确认数据正在正确地通过网络传输，但数据没有传递到我的客户对象。删除并重新添加服务引用就可以了

# javascript - JavaScript中的全局用户定义函数列表？

> ID：493833
> 
> 赞同：30
> 
> 时间：2009-01-29T22:49:10.227
> 
> 标签：javascript, function

是否可以在 JavaScript 中获取用户定义函数的列表？

我目前正在使用它，但它返回的函数不是用户定义的：

```
var functionNames = [];

for (var f in window) {
    if (window.hasOwnProperty(f) && typeof window[f] === 'function') {
        functionNames.push(f);
    }
} 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-01-29T23:07:28.347

我假设您要过滤掉本机功能。在 Firefox 中，`Function.toString()`返回函数体，对于本机函数，它将采用以下形式：

```
function addEventListener() { 
    [native code] 
} 
```

您可以匹配`/\[native code\]/`循环中的模式并省略匹配的函数。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2014-08-09T08:31:09.447

正如 Chetan Sastry 在他的回答中建议的那样，您可以检查`[native code]`字符串化函数内部是否存在：

```
Object.keys(window).filter(function(x)
{
    if (!(window[x] instanceof Function)) return false;
    return !/\[native code\]/.test(window[x].toString()) ? true : false;
}); 
```

或者简单地说：

```
Object.keys(window).filter(function(x)
{
    return window[x] instanceof Function && !/\[native code\]/.test(window[x].toString());
}); 
```

在 chrome 中，您可以通过以下方式获取所有非本地变量和函数：

```
Object.keys(window); 
```

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2010-01-08T03:04:26.860

使用 Internet Explorer：

```
var objs = [];
var thing = {
  makeGreeting: function(text) {
    return 'Hello ' + text + '!';
  }
}

for (var obj in window){window.hasOwnProperty(obj) && typeof window[obj] === 'function')objs.push(obj)}; 
```

未能报告“事情”。

# html - 定位为相对的 Html 元素，然后移动 -15px 仍占用相同的物理空间

> ID：493837
> 
> 赞同：0
> 
> 时间：2009-01-29T22:50:20.097
> 
> 标签：html, css

我在一个页面上有一系列标签。选项卡设置为相对位置。然后将它们向左移动 15px。生成的样式如下所示：

```
style="position:relative;left:-15px" 
```

（请注意，每个选项卡的左侧将是 -15 * 选项卡编号 - 所以 #2 将是 -15，#3 是 -30，等等）

这给标签带来了很好的重叠感，这是想要的。但是，缺点是`width`在表格居中时使用选项卡的原始（没有向左移动）。结果是桌子感觉偏斜。

有没有办法调整这种行为？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-30T18:37:45.567

`<li>`您可以将其应用于每个选项卡（第一个选项卡除外），而不是用“位置：相对”轻推s：

```
margin-left: -15px; 
```

**编辑：** 概念的例子......

```
<div style="text-align:center;">
<img src="http://www.google.com/intl/en_ALL/images/logo.gif" />
<img style="margin-left: -54px;" src="http://www.google.com/intl/en_ALL/images/logo.gif" />
<img style="margin-left: -54px;" src="http://www.google.com/intl/en_ALL/images/logo.gif" />
<img style="margin-left: -54px;" src="http://www.google.com/intl/en_ALL/images/logo.gif" />
</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-29T22:55:53.473

也许您可以在左侧添加一个填充元素。宽度：#tabs * 15

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-29T22:56:16.637

您可以定位选项卡容器：左：（7.5 * 选项卡编号）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-30T18:41:35.607

将容器的左边距设置为 -((tabWidth) * (numTabs)) 可能吗？

# eclipse - Mac OSX 中的 Eclipse 键盘快捷键

> ID：493838
> 
> 赞同：21
> 
> 时间：2009-01-29T22:50:23.577
> 
> 标签：eclipse, macos

我正在运行 Leopard 并在 Eclipse 中进行所有 Java 开发。一些快捷方式可以使用，例如 Command-1，它会提供快速建议。但是，如何使功能键（F5 用于在包资源管理器中刷新）工作？现在它会显示空间或任何系统偏好设置映射到它。

当我在调试并想直接转到所选函数时，Control-click 进入断点怎么样？有没有办法让我的 Eclipse 键盘快捷键优先于其他程序？

我正在运行 eclipse 3.4，尽管自 eclipse 3.2 以来我就遇到了这个问题。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-01-29T23:25:36.673

自从我在 mac 上使用 eclipse 已经有一段时间了，但我认为你必须去 Preferences.app 并检查“键盘”窗格。应该有一个选项可以选择其 `Fn`-function-key 还是仅用于按键的功能键。在那之后，它将是 `Fn+F5`为了暴露并且只是 `F5`为了 `F5`. 您将失去调暗屏幕和调整键盘声音的能力。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-01-29T22:53:13.383

在键盘下的系统偏好中，有一个切换键可以将 f 键变成真正的功能键

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-29T22:53:14.913

你用的是macbook吗？至少在 OO.org 中，您必须按 fn-fx 才能获得应用程序快捷方式，否则您将获得系统范围的快捷方式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-29T22:54:06.410

这听起来不像是 Eclipse 问题。

您使用的是外接键盘还是 macbook？

如果你想使用调试器之类的东西，你需要改变功能键的解释。您必须手动按下笔记本电脑键盘上的 FN 键。某些外接键盘具有功能锁。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-25T03:44:09.353

控制点击并直接进入功能呢？这适用于 eclipse 的 windows 版本，但我似乎无法让它在 Mac OSX 中运行。试过：命令点击=没有选项点击=没有控制点击=打开上下文菜单（就像点击鼠标右键）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-06-25T12:07:22.023

正如@sorin 解释的那样，您可以从首选项更改系统级别的默认行为。对最后一句中的声明进行更正，“您可以使用`Fn`-function-key 调暗屏幕并调整键盘的声音。”

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-05-14T23:53:34.970

默认情况下使功能键适用于外部键盘（并且不必按下额外的 fn 键）：

更改默认功能键行为 选取苹果菜单  > 系统偏好设置。单击键盘。选择“使用 F1、F2 等键作为外部键盘上的标准功能键”。

# c# - C#双重标准？

> ID：493841
> 
> 赞同：4
> 
> 时间：2009-01-29T22:51:16.243
> 
> 标签：c#, interface

我在两个类中做同样的事情，其中​​一个编译器允许它很好，但另一个给我一个错误。为什么要双重标准？有 15 个类使用相同的模式，但只有一个拒绝编译，并出现以下错误：

> “AWWAInvoicingXML.AwwaTransmissionInfo”没有实现接口成员“AWWAInvoicingXML.IXmlSerializable.fromXML(System.Xml.XmlDocumentFragment)”。'AWWAInvoicingXML.AwwaTransmissionInfo.fromXML(System.Xml.XmlDocumentFragment)' 是静态的、非公开的，或者返回类型错误。

这是我的源代码......如果我注释掉 AwwaTransmissionInfo 类，文件的其余部分编译得很好，所以我知道它不是编译器在第一个错误后就死掉的那些。而且我知道，我知道，我在这里尝试做的事情有内置的东西，但只是假设我真的知道我在做什么，并且出于某种原因跳过了内置的序列化程序:)

```
 public interface IXmlSerializable {
    //if this interface is implemented, the object can be serialized to XML
    string toXML();
    IXmlSerializable fromXML(XmlDocumentFragment inXml);
}

public class AwwaTransmissionInfo : IXmlSerializable {

    public DateTime DateTime = DateTime.Now;
    public int ItemCount;

    public string toXML() {
        throw new Exception("The method or operation is not implemented.");
    }

    public AwwaTransmissionInfo fromXML(XmlDocumentFragment inXml) {
        throw new Exception("The method or operation is not implemented.");
    }

}

public class CEmail {
    public string Email = "";

    public string toXML() {
        throw new System.Exception("The method or operation is not implemented.");
    }

    public CEmail fromXML(XmlDocumentFragment inXml) {
        throw new System.Exception("The method or operation is not implemented.");
    }
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-29T22:58:15.340

问题是方法签名必须与接口完全匹配。

最简单的解决方法是改变

```
 public AwwaTransmissionInfo fromXML(XmlDocumentFragment inXml) { 
```

到

```
 public IXmlSerializable fromXML(XmlDocumentFragment inXml) { 
```

如果你对此不满意，你可以显式地实现接口。添加这个：

```
 public IXmlSerializable IXmlSerializable.fromXML(XmlDocumentFragment inXml) {
        return this.fromXML(inXml);
    } 
```

然后，您将有两个 fromXML() 定义，一个用于作为类的实例调用时使用，一个用于通过接口调用时使用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-29T23:05:47.947

IXmlSerializable 已存在于 .NET 框架中。我建议您在自己动手并重新发明轮子之前实施这一点。

请参阅 msdn [1](http://msdn.microsoft.com/en-us/library/system.xml.serialization.ixmlserializable.aspx)。

至于您的代码无法编译的原因：

fromXml 方法需要返回 IXmlSerializable。

```
public IXmlSerializable fromXML(XmlDocumentFragment inXml)
{
    throw new Exception("The method or operation is not implemented.");
} 
```

如果您想返回其他内容，请考虑使用通用接口。

IE。

```
public interface IXmlSerializable<T>
{
    //if this interface is implemented, the object can be serialized to XML
    string toXML();
    T fromXML(XmlDocumentFragment inXml);
}

public class AwwaTransmissionInfo : IXmlSerializable<AwwaTransmissionInfo>
{

    public DateTime DateTime = DateTime.Now;
    public int ItemCount;

    public string toXML()
    {
        throw new Exception("The method or operation is not implemented.");
    }

    public AwwaTransmissionInfo fromXML(XmlDocumentFragment inXml)
    {
        throw new Exception("The method or operation is not implemented.");
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-29T22:56:08.620

`AwwaTransmissionInfo.fromXml`需要返回一个`IXmlSerializable`类型，而不是一个`AwwaTransmissionInfo`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-29T23:14:19.097

CEmail 类编译良好的原因是它没有被标记为实现接口。当我这样标记它时，我得到了与其他类相同的错误。以下是它必须是的......我没有注意到这一点很愚蠢。我们现在在这里承受着很大的压力，我不敢相信我在发布问题之前盯着这段代码大约一个小时，而且它是如此简单......我猜总是这样:)

```
 public interface IXmlSerializable {
    //if this interface is implemented, the object can be serialized to XML
    string toXML();
    IXmlSerializable fromXML(XmlDocumentFragment inXml);
}

public class AwwaTransmissionInfo : IXmlSerializable {

    public DateTime DateTime = DateTime.Now;
    public int ItemCount;

    public string toXML() {
        throw new Exception("The method or operation is not implemented.");
    }

    public IXmlSerializable fromXML(XmlDocumentFragment inXml) {
        throw new Exception("The method or operation is not implemented.");
    }

}

public class CEmail : **IXmlSerializable** {
    public string Email = "";

    public string toXML() {
        throw new System.Exception("The method or operation is not implemented.");
    }

    public IXmlSerializable fromXML(XmlDocumentFragment inXml) {
        throw new System.Exception("The method or operation is not implemented.");
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-29T22:57:46.150

您的 CEmail 类根本没有实现 IXmlSerializable 接口。实现它并将您的 CEmail 和 AWwaTransmissionInfo 的返回类型从 XML 更改为 IXmlSerializable。

```
public IXmlSerializable fromXML(XmlDocumentFragment inXml){
   throw new System.Exception("The method...");
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-29T23:04:41.817

派生的 AwwaTransmissionInfo 类上的“fromXml”方法返回 AwwaTransmissionInfo 类型，其中接口定义该方法应返回 IXmlSerializable 类型。由于 AwwaTransmissionInfo 派生自 IXmlSerializable，您可能会想，哦，很酷，这行得通，但它不在接口上。我认为那将是差异（相反或共同，我永远不记得是哪一个）？？

如果您要使用泛型对其进行重构，那么您可以使用允许您绕过其中一些的约束。

# .net - 获取静态库的 ResourceManager

> ID：493847
> 
> 赞同：0
> 
> 时间：2009-01-29T22:52:27.253
> 
> 标签：.net, c++, winforms

我有一个托管 C++ 项目，它编译为 lib 并由 windows 窗体 .exe 引用。这个库又引用了一个包含本地化代码的 DLL。ResourceManager 的构造函数需要一个代表资源父级的 Assembly 对象。如何创建引用存储在 lib 项目中的资源的新 ResourceManager？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-09T18:42:36.007

嗯，您使用的是哪个版本的 VisualStudio？VS2008 (C#) 自动围绕您添加到项目中的任何资源创建一个强类型包装类（使用 resgen.exe）。请检查这是否也适用于 C++/CLI。

# python - 哪个 Python 模块适合列表中的数据操作？

> ID：493853
> 
> 赞同：3
> 
> 时间：2009-01-29T22:54:02.133
> 
> 标签：python, module

我有一系列 x、y 和 z 坐标，我需要对其进行操作。它们位于三个元组的一个列表中，例如 {(x1, y1, z1), (x2, y2, z2), ...}。

我需要加法、乘法和对数来处理我的数据。

我想研究一个模块，它和 awk 语言一样强大。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-30T00:10:42.370

我不确定你到底在追求什么。你可以用列表推导做很多事情。例如，如果要翻转列表：

```
coords = [(x1, y1, z1), (x2, y2, z2), (x3, y3, z3)]  # etc 
```

进入一个 tuple `(x1+x2+x3, y1+y2+y3, z1+z2+z3)`，那么你可以这样做：

```
sums = (sum(a[0] for a in coords), sum(a[1] for a in coords), sum(a[2] for a in coords)) 
```

事实上，一个有经验的 Python 程序员可能会这样写：

```
sums = map(sum, zip(*coords)) 
```

尽管对于初学者来说这看起来有点像魔术。

如果你想跨坐标相乘，那么这个想法是相似的。唯一的问题是 python 没有与`sum`. 我们可以构建自己的：

```
import operator
def prod(lst):
    return reduce(operator.mul, lst) 
```

然后你可以将你的元组坐标相乘：

```
prods = map(prod, zip(*coords)) 
```

如果你想用乘法（内积？）做一些更复杂的事情，那将需要更多的工作（尽管它不会很困难）。

我不确定你想取什么对数。但是你可以在 math 模块中找到 log 函数：

```
from math import log 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-30T11:28:15.513

如果你需要很多数组操作，那么 numpy 是 python 中的最佳选择

```
>>> import numpy
>>> data = numpy.array([(2, 4, 8), (3, 6, 5), (7, 5, 2)])
>>> data
array([[2, 4, 8],
       [3, 6, 5],
       [7, 5, 2]])

>>> data.sum()  # product of all elements
42
>>> data.sum(axis=1)   # sum of elements in rows
array([14, 14, 14])
>>> data.sum(axis=0)   # sum of elements in columns
array([12, 15, 15])
>>> numpy.product(data, axis=1)   # product of elements in rows
array([64, 90, 70])
>>> numpy.product(data, axis=0)   # product of elements in columns
array([ 42, 120,  80])
>>> numpy.product(data)      # product of all elements
403200 
```

或对数组进行元素明智的操作

```
>>> x,y,z = map(numpy.array,[(2, 4, 8), (3, 6, 5), (7, 5, 2)])
>>> x
array([2, 4, 8])
>>> y
array([3, 6, 5])
>>> z
array([7, 5, 2])

>>> x*y
array([ 6, 24, 40])
>>> x*y*z
array([ 42, 120,  80])
>>> x+y+z
array([12, 15, 15]) 
```

元素明智的数学运算，例如

```
>>> numpy.log(data)
array([[ 0.69314718,  1.38629436,  2.07944154],
       [ 1.09861229,  1.79175947,  1.60943791],
       [ 1.94591015,  1.60943791,  0.69314718]])
>>> numpy.exp(x)
array([    7.3890561 ,    54.59815003,  2980.95798704]) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-30T11:42:37.997

您不需要单独的库或模块来执行此操作。Python 在语言中内置了列表推导，它允许您操作列表并执行计算。如果你想做很多科学计算，或者如果你想做很多繁重的数字运算，你可以使用 numpy 模块来做同样的事情。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-30T00:38:38.740

在 Python 3 中，该`reduce`函数消失了。你可以做：

```
def prod(lst):
    return [x*y*z for x, y, z in list(zip(*lst))]

coords = [(2, 4, 8), (3, 6, 5), (7, 5, 2)]
print(prod(coords))
>>> [42, 120, 80] 
```

# .net - 当视图不与模型交互时，它是 MVC 吗？

> ID：493867
> 
> 赞同：5
> 
> 时间：2009-01-29T22:57:28.337
> 
> 标签：.net, model-view-controller, design-patterns

我设计了一个 MVC（在 .NET 中），其中视图没有到模型的链接。它只知道Controller。传统的 MVC 模式的所有部分都相互通信。就我而言，Controller 基本上是一个中介。这会将任何异常或逻辑排除在视图之外。它对模型的依赖性为零。这不再是 MVC 了吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-01-29T23:22:47.443

您所描述的实际上是 Model-View-Controller 的一个子集，称为[Passive View](http://martinfowler.com/eaaDev/PassiveScreen.html)。

![替代文字](https://martinfowler.com/eaaDev/passiveScreen/deps.gif)

> 被动视图是模型视图控制器和模型视图呈现器的另一种变体。与这些一样，UI 分为处理显示的视图和响应用户手势的控制器。**被动视图的显着变化是视图完全被动，不再负责从模型更新自身。**因此，所有的视图逻辑都在控制器中。因此，视图和模型之间的任一方向都没有依赖关系。

[Martin Fowler在](http://en.wikipedia.org/wiki/Martin_Fowler)[上面的链接](http://martinfowler.com/eaaDev/PassiveScreen.html)中谈到了它，并[在这里](http://martinfowler.com/eaaDev/ModelViewPresenter.html)简要讨论了其他变体。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-29T23:21:23.857

我猜不是MVC，而是VC，嗯？;)

在 MVC 实现中，视图订阅模型中的更改，并作用于控制器；控制器对模型进行更改，这些更改通过它们对模型的引用传播到视图。就您而言，听起来更像是您将模型埋在了控制器中（毕竟，您必须从某个地方获取数据）；这不一定是坏事或任何东西，但它也不是严格意义上的 MVC。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-29T23:02:02.570

从最严格的意义上说，没有。但是，如果需要，视图是否可以在不更改架构/接口的情况下与模型进行通信？

[例如，如果你实现了一个 TalkToModel() 方法，即使你还没有使用它，在我看来它也是一个 MVC。]

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-29T23:26:48.277

您的方法看起来很像[MVP](http://en.wikipedia.org/wiki/Model_View_Presenter)，但如果没有更多细节，我不能肯定地说。

# .net - Silverlight+WCF 异常：期望应用程序/soap+xml，收到文本/xml

> ID：493883
> 
> 赞同：12
> 
> 时间：2009-01-29T23:03:33.380
> 
> 标签：.net, wcf, silverlight, exception-handling, wcf-configuration

我有一个 Silverlight 应用程序，我想在其中调用 WCF 服务。调用服务时，我从服务器收到以下响应：

> 415 无法处理消息，因为内容类型为 'text/xml; charset=utf-8' 不是预期的类型 'application/soap+xml; 字符集=utf-8

有没有人遇到过这个问题？有谁知道我需要调整哪些配置设置？任何有关如何解决此问题的信息将不胜感激。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-29T23:07:03.323

那么，您可以尝试在VS2008中使用“Silverlight-enabled WCF Service”模板，并比较差异？我希望您需要使用`basicHttpBinding`并且正在使用更具异国情调的东西。

有关信息，这是默认 Silverlight/WCF 服务的 web.config 部分：

```
 <system.serviceModel>
  <behaviors>
   <serviceBehaviors>
    <behavior name="MySite.Service1Behavior">
     <serviceMetadata httpGetEnabled="true" />
     <serviceDebug includeExceptionDetailInFaults="false" />
    </behavior>
   </serviceBehaviors>
  </behaviors>
  <serviceHostingEnvironment aspNetCompatibilityEnabled="true" />
  <services>
   <service behaviorConfiguration="MySite.Service1Behavior"
       name="MySite.Service1">
    <endpoint address="" binding="basicHttpBinding"
       contract="MySite.Service1" />
    <endpoint address="mex" binding="mexHttpBinding"
       contract="IMetadataExchange" />
   </service>
  </services>
 </system.serviceModel> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-23T07:19:10.413

我在尝试将 Silverlight 应用程序连接到 WCF 服务时遇到此错误。

根本原因是 WCF 服务是使用 wsHttpBinding 绑定的，而 Silverlight 仅支持 basicHttpBinding。

因此，请检查`<bindings>`web.config 中的元素，并确保服务的绑定信息在元素中`<basicHttpBinding>`，并且`<endpoint>`服务定义的元素使用 basicHttpBinding。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-29T23:21:59.427

可能该服务正在引发异常。异常消息不是服务调用所期望的格式，因此是“不是预期的类型”消息。

如果调用的方法没有在内部引发异常，请根据 Marc Gravell 的有用答案检查服务或其他配置项的安全设置。

有几种方法可以检查异常：详细查看异常消息，或跟踪 WCF 服务调用。

1.  要查看异常消息，请在服务调用周围放置一个 try-catch 并在 catch 块中设置断点。这将允许您检查异常内容。您可能希望*临时*配置服务以[在故障消息中包含异常详细信息](http://msdn.microsoft.com/en-us/library/system.servicemodel.servicebehaviorattribute.includeexceptiondetailinfaults.aspx)。

2.  通过为服务启用消息日志记录，您可以轻松地跟踪 WCF 消息。您可以在配置文件中执行此操作（请参阅[配置消息日志](http://msdn.microsoft.com/en-us/library/ms730064.aspx)）或使用 WCF 服务配置编辑器（在 VS 2008 工具菜单下或通过右键单击配置文件可用）。然后使用服务跟踪查看器浏览日志文件。查看器是 SDK 的一部分，可在此处找到：`"C:\Program Files\Microsoft SDKs\Windows\v6.0A\bin\SvcTraceViewer.exe"`.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-30T12:27:54.830

[您可以使用WebOperationContext 类](http://msdn.microsoft.com/en-us/library/system.servicemodel.web.weboperationcontext.aspx)在 WCF Web 服务上的任何方法中更改响应的内容类型。

作为示例，以下代码显示了如何使用此类将内容类型设置为 application/xml 并返回 UTF-8 编码流：

```
[ServiceContract]
public interface IPolicyProvider
{
    [OperationContract, WebGet(UriTemplate = "/ClientAccessPolicy.xml")]
    Stream ProvidePolicy();
}

public sealed class StockService : IPolicyProvider
{
    public Stream ProvidePolicy()
    {
        WebOperationContext.Current.OutgoingResponse.ContentType = "application/xml";
        return new MemoryStream( Encoding.UTF8.GetBytes(File.ReadAllText("ClientAccessPolicy.xml"))  , false);
    }
} 
```

如果您对此示例感兴趣，目的是在自托管 WCF Web 服务中启用 Silverlight 客户端的跨域调用，请查看[此处](http://blogs.msdn.com/carlosfigueira/archive/2008/03/07/enabling-cross-domain-calls-for-silverlight-apps-on-self-hosted-web-services.aspx)了解更多信息，我[在这篇文章中附有](http://petermcg.wordpress.com/2008/09/03/silverlight-polling-duplex-part-2-the-server/)代码下载。

在您的情况下，对于来自 WCF 服务的响应，您可以将内容类型设置为 application/soap+xml 并使用 UTF-8。

WebOperationContext 类位于 System.ServiceModel.Web 程序集中，是 .NET Framework 3.5 的一部分。

希望这可以帮助。

# database - SQL Server 自动备份

> ID：493886
> 
> 赞同：29
> 
> 时间：2009-01-29T23:03:47.917
> 
> 标签：database, sql-server-2008, backup

对于创建 SQL Server 2008 数据库的自动备份的软件产品有哪些建议？

备份应该在不使数据库脱机/分离的情况下发生。

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2009-01-29T23:32:02.213

如果您使用的是**SQL Server Express**，您将找不到运行定期备份的 UI。
在这种情况下，您必须使用 Windows 计划任务或类似的东西运行批处理。

不要忘记使用具有足够权限的用户来访问 SQL Server。

## 在批处理文件中

```
"C:\Program Files\Microsoft SQL Server\100\Tools\Binn\SQLCMD.EXE" -S 
(local)\SQLExpress -i D:\dbbackups\SQLExpressBackups.sql 
```

## 在 SQLExpressBackups.sql 中

```
BACKUP DATABASE MyDataBase1 TO  DISK = N'D:\DBbackups\MyDataBase1.bak' 
WITH NOFORMAT, INIT,  NAME = N'MyDataBase1 Backup', SKIP, NOREWIND, NOUNLOAD,  STATS = 10

BACKUP DATABASE MyDataBase2 TO  DISK = N'D:\DBbackups\MyDataBase2.bak' 
WITH NOFORMAT, INIT,  NAME = N'MyDataBase2 Backup', SKIP, NOREWIND, NOUNLOAD,  STATS = 10

GO 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-01-29T23:11:05.080

我建议只在 SQL Server 中创建一个维护计划来处理备份，它可以配置为在指定时间备份到指定位置，而不会使数据库脱机，并且会处理您的增量备份清理。

[http://msdn.microsoft.com/en-us/library/ms189715.aspx](http://msdn.microsoft.com/en-us/library/ms189715.aspx)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2011-05-02T07:40:18.530

我为此苦苦挣扎了一段时间，因为不清楚如何使用一种生成具有不同名称的文件的机制，以便一次运行不会覆盖另一次运行。最后它创建了以下 Windows 批处理文件

```
:: Daily Backup of SQLSERVER databases

:: AKC 30 Apr 2011

::

:: Set environment variables

SET SQLCMDPASSWORD=xxxxxx
SET BACKUPDIR=C:\backups\db\

SET SCRIPTDIR=D:\Public\DB\batch_scripts\

:: Issue backup commands from a sql script

SQLCMD -U a_backup -S SERVER\SQLEXPRESS -i %SCRIPTDIR%daily_backup.sql

:: Tidy Up Old Backup Files (keep for 5 days)

FORFILES /P %BACKUPDIR% /S /M "*.bak" /D -5 /C "cmd /c del @path" 
```

其中 a_backup 是我的具有备份权限的 sqlserver 登录名。对应的sql是

```
DECLARE @thistime nvarchar(25);

DECLARE @filename nvarchar(255);

SET @thistime = CONVERT(nvarchar,GETDATE(),126);

SET @filename = "$(BACKUPDIR)" + N'PASL' + SUBSTRING(@thistime,1,10) + N'_DB.bak';

BACKUP DATABASE DB_live

    TO DISK = @FILENAME

    WITH INIT;

GO 
```

发现清除旧文件的“FORFILES”命令是我的关键发现。

事务日志等价物是

```
:: Transaction Log Backups of SQLSERVER databases

:: AKC 30 Apr 2011

:: Run at reasonably spread out times of the day

:: Set environment variables

SET SQLCMDPASSWORD=xxxxxx
SET BACKUPDIR=C:\backups\db\
SET SCRIPTDIR=D:\Public\DB\batch_scripts\

:: Issue backup commands from a sql script

SQLCMD  -U a_backup -S SERVER\SQLEXPRESS -i %SCRIPTDIR%tlog_backup.sql 
```

带有 sql 文件

```
DECLARE @thistime nvarchar(25);

DECLARE @filename nvarchar(255);

SET @thistime = CONVERT(nvarchar,GETDATE(),126);

SET @filename = "$(BACKUPDIR)" + N'PASL' + SUBSTRING(@thistime,1,10) + SUBSTRING(@thistime,11,3) + N'_LOG.bak';

BACKUP LOG DB_live

    TO DISK = @FILENAME

    WITH INIT;

GO 
```

我应该注意数据库文件在我的 D: 驱动器上，这就是我将备份放到 C: 驱动器上的原因。

每日备份作为作业输入到 Windows 任务计划程序中，每天凌晨 4:00 运行。事务日志备份设置为每天上午 8:00 运行，每 4 小时重复一次，13 小时后完成（导致它在每天上午 8 点、中午 4 点和晚上 8 点运行）

# c# - 尊重对 Windows 时间格式的即时更改

> ID：493888
> 
> 赞同：2
> 
> 时间：2009-01-29T23:04:26.090
> 
> 标签：c#, .net, datetime, formatting

我正在开发一个 C# 应用程序，它试图尊重它运行的系统的时间格式。如果 Windows 控制面板更改为 24 小时格式，这就是应用程序将显示时间的格式。无论如何，它会成功执行此操作，但只有在应用程序运行之前更改时间格式时才会起作用。如果您在应用程序运行时更改 Windows 时间格式，它将不会使用更新后的格式。

是否有任何类型的 Windows 事件或其他方式来检索最新的时间格式？我们目前使用 DateTimeFormatInfo LongTimePattern，因为它会根据我们是 12 小时还是 24 小时制而变化。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-29T23:14:01.157

命名空间中有一个类`SystemEvents`，`Microsoft.Win32`它有一组可以订阅的静态事件。您需要订阅 UserPreferenceChanged 事件：

```
SystemEvents.UserPreferenceChanged += new UserPreferenceChanged;

/* Other stuff... */

private static void UserPreferenceChanged(object s, UserPreferenceChangedEventArgs e)
{
    if (e.Category == UserPreferenceCategory.Locale)
    {
        /* They changed regional settings, so do your work here */
    }
} 
```

# c# - 多对多过滤器

> ID：493893
> 
> 赞同：1
> 
> 时间：2009-01-29T23:05:21.283
> 
> 标签：c#, c#-3.0, delegates, predicate

今天我们遇到了一个非常简单的问题，而亲爱的谓词使这个问题变得更加简单。我们有一种事件日志，并希望使用标准列表过滤它的客户端（Windows 窗体）。我们首先实现了按多个类别进行过滤。

```
private List<Events> FilterEventsByCategory(List<Events> events,
                                        List<Category> categories) 
{
  return events.FindAll(ev => 
      categories.Exists(category => category.CategoryId==ev.CategoryId)); 
} 
```

下一步是实现几个其他过滤器。您是否知道一种将这些概括为可能不必为每个过滤器编写一个方法的好方法？或者至少是一种干净的方式来获得我们想要同时应用的过滤器的动态列表。

客户端仍在框架 3.0 上，因此没有 LINQ。

**更新：** 我很难决定我的解决方案应该归功于谁。Marc 有一些不错的想法，并且非常擅长解释它们。如果我能更好地解释我的问题，我很可能会从他那里得到答案。最终，是 cmartin 提供的通用 Filter 类让我走上了正轨。下面使用的过滤器类可以在 cmartins 的答案和您自己梦想的用户类中找到。

```
var categoryFilter = new Filter<Event>(ev => categories.Exists(category => category.CategoryId == ev.CategoryId));
var userFilter = new Filter<Event>(ev => users.Exists(user => user.UserId == ev.UserId));

var filters = new List<Filter<Event>>();
filters.Add(categoryFilter);
filters.Add(userFilter);

var eventsFilteredByAny = events.FindAll(ev => filters.Any(filter => filter.IsSatisfied(ev)));
var eventsFilteredByAll = events.FindAll(ev => filters.All(filter => filter.IsSatisfied(ev))); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-29T23:13:27.803

重新“所以没有 LINQ” - 你看过[LINQBridge](http://www.albahari.com/nutshell/linqbridge.aspx)吗？由于您使用的是 C# 3.0，这将是理想的...

恐怕主要问题是，我不完全理解您要做什么以及要避免什么-您能澄清一下吗？但是，如果您使用 LINQBridge 方法，您可以使用连续`.Where()`调用来组合过滤器。

对这个问题的一种解释是，您不想要很多过滤器方法 - 所以也许将一个或多个进一步的谓词传递给该方法 - 基本上作为 a `Func<Event, Func<Category, bool>>`- 或纯 2.0 术语， a `Converter<Event, Predicate<Category>>`：

```
private static List<Events> FilterEvents(
    List<Events> events,
    List<Category> categories,
    Converter<Events, Predicate<Category>> func)
{
    return events.FindAll(evt =>
        categories.Exists(func(evt)));
} 
```

然后将其用作（如上）：

```
var result = FilterEvents(events, categories,
      evt => category => category.CategoryId==evt.CategoryId); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-29T23:25:19.217

这是我将从哪里开始的一个非常基本的示例。

```
internal class Program
{
    private static void Main()
    {
        var ms = new Category(1, "Microsoft");
        var sun = new Category(2, "Sun");

        var events = new List<Event>
                         {
                             new Event(ms, "msdn event"),
                             new Event(ms, "mix"),
                             new Event(sun, "java event")
                         };

        var microsoftFilter = new Filter<Event>(e => e.CategoryId == ms.CategoryId);

        var microsoftEvents = FilterEvents(events, microsoftFilter);

        Console.Out.WriteLine(microsoftEvents.Count);
    }

    public static List<Event> FilterEvents(List<Event> events, Filter<Event> filter)
    {
        return events.FindAll(e => filter.IsSatisfied(e));
    }
}

public class Filter<T> where T: class
{
    private readonly Predicate<T> criteria;

    public Filter(Predicate<T> criteria)
    {
        this.criteria = criteria;
    }

    public bool IsSatisfied(T obj)
    {
        return criteria(obj);
    }
}

public class Event
{
    public Event(Category category, string name)
    {
        CategoryId = category.CategoryId;
        Name = name;
    }

    public int CategoryId { get; set; }
    public string Name { get; set; }
}

public class Category
{
    public Category(int categoryId, string name)
    {
        CategoryId = categoryId;
        Name = name;
    }

    public string Name { get; set; }
    public int CategoryId { get; set; }
} 
```

# php - PHP/Django/Rails/Flex 混合演示 - 需要项目想法

> ID：493905
> 
> 赞同：2
> 
> 时间：2009-01-29T23:11:38.010
> 
> 标签：php, ruby-on-rails, django, apache-flex

假设您非常疯狂，想要尝试结合多种不同的技术来证明您可以这样做——什么样的应用程序适合这种类型的项目作为潜在雇主的演示？

具体来说，我正在考虑结合以下技术：

PHP/Django/Rails/Flex

这听起来很荒谬，还是对个人能力的有用锻炼/展示？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-30T15:50:34.330

如果我是雇主，如果你能实现相同的示例应用程序 3 次，我会印象深刻：

*   导轨/弹性
*   Django/Flex
*   PHP/弹性

如果您使用 ReST，那么 Flex 端不需要进行太多更改来支持每种服务器技术，并且您将证明您是一个可以快速学习新技术的多才​​多艺的开发人员。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-30T13:33:59.067

[博客](https://stackoverflow.com/questions/471940/why-does-every-man-and-his-dog-want-to-code-a-blogging-engine/472130#472130)怎么样？

当然，有些人可能会认为这是陈词滥调，但它也是一种相当全面的 Web 项目——其中有一些数据库设计，一些应用程序开发，使用您选择的语言，一些 SOA（使用 SOAP 或REST，也许还有一些 RSS），一些 UI 设计，Flex 中的一些 UI 开发，等等。

对于那些可能会采访你的人来说，这也是一个足够熟悉的想法，因此在深入研究技术细节之前，你不必花费大量时间来解释它是什么，这并不重要，但仍然您可以控制其范围的东西。我认为这是一个学习新 Web 技术的好项目。

至于哪个部分做什么，你可以考虑用 Flex 做 CMS，大多数面向公众的网站都用 PHP（或 Rails）和 HTML/CSS，然后添加一两个 Flex 附加功能——一个照片库，也许，或者一个视频/媒体播放器。或者到底是什么，与众不同——只需在 Flex 中构建整个东西，就像 Adob​​e 使用[其 XD 站点](https://xd.adobe.com/#/home)所做的那样。

玩得开心，祝你好运！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-29T23:18:26.327

我认为混合 php、django 和 rails 对演示没有意义......

我会混合使用 flex + django、php 或 rails 之一。

然后，您可以使用 pyamf，例如，这样您的 flex 应用程序就可以与 django 对话。然后查找一些 php JSON lib 并使用 php + flex 与 json 相同，依此类推...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-29T23:39:54.193

我认为结合 PHP 和 Rails 或 PHP 和 Django 是有意义的，但可能不结合 Rails 和 Django。Rails 和 Django 太相似了。它们是基于现代语言的现代 Web 框架。与 PHP 相比，它们缺少的是开源应用程序。

我建议将 WordPress 或 Drupal 与 Django 或 Rails 结合起来。要将 Drupal 与 Rails 结合使用，您可以尝试使用[drupal_fu](http://github.com/harukizaemon/drupal_fu/tree/master)。您可以尝试一个 Django 站点，它很好地集成了 WordPress 博客，包括使用 Django 身份验证在 WordPress 博客上发表评论。或者，您可以创建一个 Drupal 站点，其中包含用 Rails 编写的站点的自定义部分。

也许您可以同时使用 Django 和 Rails 的一种方法是使用 Rails 作为您网站的基础，并使用 Django 作为使用 Python 库的一种方式（用于在 Python 中做得更好的东西）。我知道在 Ruby 应用程序中使用 Python 的一个例子是 GitHub，它使用 Pygments（一个用 Python 编写的库）来突出显示源代码。我不认为他们使用 Django，但你可以！

# asp.net - 在哪里可以找到或复制产生 HttpRequestValidationException 的代码

> ID：493909
> 
> 赞同：3
> 
> 时间：2009-01-29T23:13:04.810
> 
> 标签：asp.net, ajax, xss

我在`<WebMethod>`某些页面上定义了一些 PageMethods （页面中的静态方法标记为 ），并使用 ajax 调用来调用它们。如果发送的数据被认为可能是 XSS，那么这个到服务器的 POST 显然不会触发会引发 HttpRequestValidationException 的 ASP.NET 代码，所以我想复制该检查代码以在我的页面方法中运行它。

任何人都知道该代码的详细信息或我在哪里可以找到它？我查看了 MS AntiXss 库，但它只进行编码，而不是实际检查输入，AFAIK。

编辑：或者指出我的代码方向或进行类似检查的库。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-03-24T16:56:28.867

在引发 System.Web.HttpRequestValidationException 时分析堆栈跟踪，我们可以找出抛出它的代码。

System.Web.HttpRequestValidationException (0x80004005)：从客户端检测到潜在危险的 Request.Form 值（IdentifierTextBox="

在 System.Web.HttpRequest.ValidateString（字符串值，字符串 collectionKey，RequestValidationSource requestCollection）

使用 Reflector 我们发现 ValidateString 正在调用：RequestValidator.Current.IsValidRequestString，而后者又调用 CrossSiteScriptingValidation.IsDangerousString，即：

```
internal static bool IsDangerousString(string s, out int matchIndex)
{
matchIndex = 0;
int startIndex = 0;
while (true)
{
    int num2 = s.IndexOfAny(startingChars, startIndex);
    if (num2 < 0)
    {
        return false;
    }
    if (num2 == (s.Length - 1))
    {
        return false;
    }
    matchIndex = num2;
    char ch = s[num2];
    if (ch != '&')
    {
        if ((ch == '<') && ((IsAtoZ(s[num2 + 1]) || (s[num2 + 1] == '!')) || ((s[num2 + 1] == '/') || (s[num2 + 1] == '?'))))
        {
            return true;
        }
    }
    else if (s[num2 + 1] == '#')
    {
        return true;
    }
    startIndex = num2 + 1;
}
} 
```

# java - 如何使用 Java 中的过滤器输出基于 HTML 文档的二进制文档

> ID：493924
> 
> 赞同：4
> 
> 时间：2009-01-29T23:18:20.867
> 
> 标签：java, image, servlets, httpresponse, servlet-filters

这可能有点令人困惑，但我遇到了一些麻烦。我的目标是获取输入的 HTML 文档，然后处理该文档并使用 HTML 数据输出图像文档。例如，用户将请求一个 URL，在查询字符串中包含一些 action=png，然后将为 URL 调用过滤器并输出图像文档。

我已经尝试了一切，但在我的环境（Websphere）中，我只能输出一种类型。如果输入类型是 text/html 那么我只能输出一个文本文档，我似乎不能输出一个二进制文档。为什么？因为我每次都得到一个非法的状态异常。

[1/29/09 17:59:57:576 EST] 00000020 SystemErr R java.lang.IllegalStateException: SRVE0209E: Writer 已经获得 [1/29/09 17:59:57:576 EST] 00000020 SystemErr R at com。 ibm.ws.webcontainer.srt.SRTServletResponse.getOutputStream(SRTServletResponse.java:505)

我使用伪代码不显示我的所有代码：

```
<filter>
    <filter-name>TestFilter</filter-name>
    <filter-class>
        com.util.TestFilter
    </filter-class>
</filter>

<filter-mapping>
    <filter-name>TestFilter</filter-name>
    <url-pattern>/index_test2.html</url-pattern>
</filter-mapping> 
```

Wrapper 类的代码本质上是这样的：

```
public class ContentCaptureServletResponse extends HttpServletResponseWrapper { 
    private ByteArrayOutputStream contentBuffer;
    private PrintWriter writer; 
    public PrintWriter getWriter() throws IOException {
        if (writer == null) {
            contentBuffer = new ByteArrayOutputStream();
            writer = new PrintWriter(contentBuffer);
        }       
        return writer;
    }   
    public String getContent(){
        try {
            writer = getWriter();
        } catch (IOException e) {           
            e.printStackTrace();
        }
        writer.flush();
        String xhtmlContent = new String(contentBuffer.toByteArray());                 
        System.out.println(xhtmlContent);                
        return xhtmlContent; 
    }
} 
```

过滤器代码是这样的：

```
public void doFilter(ServletRequest req, ServletResponse resp, FilterChain filterChain) throws IOException, ServletException {

        HttpServletRequest request = (HttpServletRequest) req;
        HttpServletResponse response = (HttpServletResponse) resp;
        final String renderType = request.getParameter("R"); 
        final String renderClassName = request.getParameter("C");
        if ((renderType != null) && (renderClassName != null)) {
            try {
                this.setFilterChain(filterChain);
                response.setContentType("image/png");
                PrintWriter out = response.getWriter();                             
                // I call getWriter but not BOTH!
                //response.getOutputStream();               
                response.getWriter();

                // Build up the HTML document into a string.
                    CaptureResponse capContent = new CaptureResponse(response);            
                this.mainFilterChain.doFilter(req, );
                String myString = capHtmlContent.getContent();

                // What I really want to do here is output an output stream
                // so I can write a binary image
                processStr(myString);
                response.getOutputStream();             
                response.write(binaryimage)

            } catch (Exception e) {            
                e.printStackTrace();
            }
            // No data will be output to the user.
        } else {
            filterChain.doFilter(request, response);
        }  // End of if-else        
    } // End of the method. 
```

如果我想获取一些输入的 html 文本文档，则该代码有效。我假设是因为打开了 printwriter 流。但是我在使用不同的格式时遇到了麻烦。基本上，因为我不能调用 response.getOutputStream()

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-31T06:05:42.357

问题似乎是您在包装响应之前打开了响应编写器。

看起来你应该能够做到：

```
this.setFilterChain(filterChain);
CaptureContent capContent = new CaptureResponse(response);
doFilter()
process();
response.setContentType("image/png");
response.getOutputStream().write(imagedata); 
```

您绝对不能安全地打开 Writer 和 OutputStream

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-30T07:39:11.247

我没有使用 Websphere 的经验，但一个常见的问题是，在您已经承诺发送正文之后，您尝试操纵 HTTP 标头——一旦网络服务器开始交付内容，您就无法再更新标头，因为它们已经已经发送。

也许您需要查看您的文档和示例。例如，我不明白你为什么在没有实际查看结果的情况下调用 response.get*() 。您确定这是必要的还是因为您修剪了代码？

干杯，沃尔克

# authentication - 从 Grails 中的过滤器定义控制器可访问变量

> ID：493926
> 
> 赞同：4
> 
> 时间：2009-01-29T23:18:37.140
> 
> 标签：authentication, grails, controller

我正在 Grails 中编写一个小型 Web 应用程序，为了确保所有用户都经过身份验证，我使用了以下过滤器：

```
class LoginFilters {
  static filters = {
    loginCheck(controller:'*', action:'*') {
      before = {
        if (session.user_id) {
          request.user = User.get(session.user_id)
        } else if (!actionName.equals("login")) {
          redirect(controller: "login", action: "login")
          return false
        }
      }
    }
  }
} 
```

所有控制器方法都从读取请求对象的用户属性开始：

```
def actionName = {
   def user = request.user
   ...
} 
```

上面的代码有效，但我宁愿避免所有控制器方法中的重复代码。过滤器是否可以将用户对象绑定到一个名为“user”而不是“request.user”的变量，所有控制器都可以访问该变量？

我知道可能存在范围界定问题使这成为不可能，但 Grails 框架似乎能够在幕后创造相当多的魔力，所以我认为这可能值得一问。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-31T03:34:37.527

在控制器中使用 beforeInterceptor 可能会有所帮助：

```
class LoginController {

    def user

    def beforeInterceptor = {
        user = request.user
    }

    def index = { 
        render text:"index: ${user}"        
    }

    def test = {
        render text:"test: ${user}"         
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-12-08T17:52:52.203

I think it generally not a good idea insert the user object into the request object every time:

The request lifetime is very short, so you might end up making round trips to caches or even worse to the database on each http-request to retrieve an object, that you might not even need and that get's deleted immideately afterwards. So if you must, better store the whole object in the session instead of just the id.

Generally, I'd suggest you write a `AuthenticationService` with a method `isLoggedIn()` that returns true when the user is authenticated and a method `getLoggedInUser()` that returns this object.

```
class AuthenticationService {
    def transactional = false
    boolean isLoggedIn() { return session.user_id }
    def getLoggedInUser() { return User.get(session.user_id) }
} 
```

Then you use the Filter for redirection if not authenticated, and maybe the Interceptor for storing the local reference `user = authenticationService.loggedInUser`. But also I don't think this the best way to go. I suggest you'd create an abstract `AuthenticationAwareController` as base class for all your controllers in src/groovy and there have the convenience method like `user`

```
class AuthenticationAwareController {
    def authenticationService
    def getUser() { return authenticationService.loggedInUser() }
} 
```

This way, you can later change you mind about storing the user however you like and don't have to change your code. Also you benefit from Caches in Hibernate, that share already retrieved user object instances between different sessions, so db roundtrips are avoided.

You still should check the retrieved user object for validity or throw an `AuthenticationException` in case the retrieval does not succeed. (Maybe something like `AuthenticationService.getLoggedInUser(failOnError = false)`.)

You can even make this Service/ControllerBase a small plugin an reuse that on every application or go directly with the spring security plugin... ;-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-01T07:01:24.457

I think you can do this but is it really worth the trouble? It seems to me your only advantage is typing "user" instead of "request.user". Not a big gain. Anyway, I think you could follow the instructions in "12.7 Adding Dynamic Methods at Runtime" of the User Guide. I think that if you created a dynamic method "getUser() {return request.user}" that the Groovy JavaBeans getter/setter access would allow you to simply reference "user" the way you want.

If you do add a dynamic method you might want to skip the filter and do it all in the dynamic method.

# perl - 如何结合 Catalyst 和 ngettext？

> ID：493935
> 
> 赞同：3
> 
> 时间：2009-01-29T23:24:10.450
> 
> 标签：perl, internationalization, gettext, catalyst

我正在尝试使用 Catalyst 了解 i18n。据我了解，使用 Perl 进行翻译有两种方法：**Maketext**和**Gettext**。但是，我需要支持 gettext 的**.po**格式，所以基本上我会使用 gettext。

现在，我找到了 Catalyst::Plugin::I18n 和 Locale::Maketext::Lexicon，它大部分时间都能满足我的需求。但是，它不会生成正确的复数形式，即正确写入**`msgid_plural`**并**`msgstr[x]`**写入**.pot**文件。这可能是因为 Maketext 依赖于它的括号符号`[quant,_1...]`，因此在翻译中必须具有相同的符号。

另一个解决方案可能是使用一些直接的 gettext 端口，例如 Locale::Messages，但这意味着重写 C::P::I18n。

除了重写几个模块之外，是否有人对这个问题有适当的解决方案？任何将适当的 gettext 与其所有功能和 Catalyst 相结合的东西都可以。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-30T18:52:01.980

您可能会在邮件列表中得到更好的答案：

[http://lists.scsys.co.uk/cgi-bin/mailman/listinfo/catalyst](http://lists.scsys.co.uk/cgi-bin/mailman/listinfo/catalyst)

我假设你也读过这个：

[http://www.catalystframework.org/calendar/2006/18](http://www.catalystframework.org/calendar/2006/18)

# ruby-on-rails - protect_from_forgery 与 Firefox

> ID：493940
> 
> 赞同：2
> 
> 时间：2009-01-29T23:26:11.303
> 
> 标签：ruby-on-rails, firefox

我最近从将会话数据存储在 cookie 中切换到将其存储在数据库中。

现在每个 POST 请求都会导致**ActionController::InvalidAuthenticityToken**错误。它只发生在 Firefox 中，并且只发生在我的家用机器上（我今天在工作中使用相同版本的 FF 进行了尝试，一切都很好）。这让我相信这与我昨天删除的 cookie 有关...

这是 environment.rb 的相关部分：

```
# Your secret key for verifying cookie session data integrity.
# If you change this key, all old sessions will become invalid!
# Make sure the secret is at least 30 characters and all random, 
# no regular words or you'll be exposed to dictionary attacks.
config.action_controller.session = {
:session_key => '_basillslam_session',
:secret      => '373ee5b69a4a31d3318485fs368c41fac6b797a1f5c35693b49bd34e8a96291b92dd577bd49de7aeea56c9ffa1af2d8386bafe857220cafacfa0028f01be357d78'
}

# Use the database for sessions instead of the cookie-based default,
# which shouldn't be used to store highly confidential information
# (create the session table with 'rake db:sessions:create')
config.action_controller.session_store = :active_record_store 
```

在 application.rb 中：

```
protect_from_forgery :secret => 'f1d54db45b47ec94a6a54b1e744fafa6' 
```

这是引发错误的完整跟踪的一部分：

```
C:/INSTAN~1/ruby/lib/ruby/gems/1.8/gems/actionpack-2.0.2/lib/action_controller/request_forgery_protection.rb:79:in `verify_authenticity_token'
C:/INSTAN~1/ruby/lib/ruby/gems/1.8/gems/actionpack-2.0.2/lib/action_controller/filters.rb:469:in `send!'
C:/INSTAN~1/ruby/lib/ruby/gems/1.8/gems/actionpack-2.0.2/lib/action_controller/filters.rb:469:in `call'
C:/INSTAN~1/ruby/lib/ruby/gems/1.8/gems/actionpack-2.0.2/lib/action_controller/filters.rb:441:in `run'
C:/INSTAN~1/ruby/lib/ruby/gems/1.8/gems/actionpack-2.0.2/lib/action_controller/filters.rb:716:in `run_before_filters'
C:/INSTAN~1/ruby/lib/ruby/gems/1.8/gems/actionpack-2.0.2/lib/action_controller/filters.rb:695:in `call_filters'
C:/INSTAN~1/ruby/lib/ruby/gems/1.8/gems/actionpack-2.0.2/lib/action_controller/filters.rb:689:in `perform_action_without_benchmark'
C:/INSTAN~1/ruby/lib/ruby/gems/1.8/gems/actionpack-2.0.2/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
C:/INSTAN~1/ruby/lib/ruby/1.8/benchmark.rb:293:in `measure'
C:/INSTAN~1/ruby/lib/ruby/gems/1.8/gems/actionpack-2.0.2/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
C:/INSTAN~1/ruby/lib/ruby/gems/1.8/gems/actionpack-2.0.2/lib/action_controller/rescue.rb:199:in `perform_action_without_caching'
C:/INSTAN~1/ruby/lib/ruby/gems/1.8/gems/actionpack-2.0.2/lib/action_controller/caching.rb:678:in `perform_action'
C:/INSTAN~1/ruby/lib/ruby/gems/1.8/gems/activerecord-2.0.2/lib/active_record/connection_adapters/abstract/query_cache.rb:33:in `cache'
C:/INSTAN~1/ruby/lib/ruby/gems/1.8/gems/activerecord-2.0.2/lib/active_record/query_cache.rb:8:in `cache'
[etc. ... ] 
```

以前有人经历过吗？或者有人知道为什么会发生这种情况吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-30T00:34:41.493

当我切换我的一个网站时，完全相同的事情发生在我身上。在您的家庭 Firefox 浏览器中删除该站点的 Rails 会话 cookie。

仅当您有一个使用 cookie 存储的预先存在的会话时才会发生这种情况。因此，希望只有您和您的浏览器才能看到此问题。删除 cookie 后，您将永远不会再看到错误。

有了数据库中的会话，并且只有一个随机密钥映射到浏览器 cookie 中的该会话，会话保护魔法就不再需要了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-30T04:32:14.620

多亏了奥托，我现在知道了发生这种情况的原因。`<%= token_tag %>`虽然，我可以通过在发布的表单中编写来解决这个问题。在`token_tag`表单中放置一个包含真实性令牌的隐藏字段，因此**ActionController::InvalidAuthenticityToken 错误**消失了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-02-24T15:59:16.873

如果您的应用程序上有多个用户，那么让他们全部删除 cookie 并不容易。当您切换到数据库存储时，为防止 cookie 和数据库存储之间的会话数据冲突，您还可以更改

```
config.action_controller.session[:session_key] 
```

# java - 如果我在使用 JDBC 时不包含 db 驱动程序会怎样？

> ID：493947
> 
> 赞同：0
> 
> 时间：2009-01-29T23:27:34.703
> 
> 标签：java, database, jdbc

我是 java 开发的新手，很高兴看到与我习惯的 php 环境相比，在支持多个平台时数据库实现要容易得多。

然而，有一件事我很困惑 - 我到处阅读我必须对我想要使用的数据库驱动程序进行运行时包含，即：

Class.forName(com.example.jdbc.Driver).newInstance();

但是，省略这似乎也可以正常工作 - 所以我的问题是，jdbc 是否会根据服务器 url 自动找到驱动程序？如果是这样，为什么我阅读的所有关于该主题的教程中都包含这一行？

另外-如果有人对在线Java学习资源（尤其是企业开发）有任何好的提示，请分享！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-29T23:35:29.493

是的，这在 JDK 6 中得到了改进。[有关 JDBC 4.0 的改进，请参阅这篇 O'Reilly 文章](http://www.onjava.com/pub/a/onjava/2006/08/02/jjdbc-4-enhancements-in-java-se-6.html)。

尤其：

> 在 JDBC 4.0 中，我们不再需要使用 Class.forName() 显式加载 JDBC 驱动程序。当调用 getConnection 方法时，DriverManager 将尝试从初始化时加载的 JDBC 驱动程序和使用与当前应用程序相同的类加载器显式加载的那些 JDBC 驱动程序中找到合适的驱动程序。

另请参阅JDK 6[中 DriverManager 的 JavaDoc 。](http://java.sun.com/javase/6/docs/api/java/sql/DriverManager.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-29T23:28:43.483

这在 JDK 6 中没有改变吗？

# php - CakePHP 与 Ruby on Rails 有何不同？

> ID：493950
> 
> 赞同：18
> 
> 时间：2009-01-29T23:30:30.143
> 
> 标签：php, ruby-on-rails, cakephp, comparison

不久之后，我几乎从来没有听到过CakePHP 这个词而没有听到Rails 这个词。这两个框架主要是基于它们如何遵循 MVC 模型而相似的，还是它们有其​​他显着的相似之处/不同之处？

对我来说，Rails 的主要吸引力之一是做 Ajax 是多么容易。CakePHP 也是这样吗？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-01-30T04:40:11.187

CakePHP 就像是对 Rails 的廉价盗版。它试图像 Rails 一样，但不做任何让 Rails 变得伟大的事情。感觉有点像，我猜。

CakePHP 有一个 Ajax 帮助器，它的作用类似于 Rails 中与 Ajax 相关的帮助器方法，所以是的，在某些方面也是如此。

但是 CakePHP 确实是徒劳的：它的作者编写它是为了让他们不必学习 Ruby，尽管一起学习 Ruby 和 Rails 可能比弄清楚 CakePHP 的巨大混乱要容易。

（这个，来自一个在他的日常工作中使用 CakePHP 的人。）

* * *

既然你们都问了，我对 CakePHP 最大的抱怨是它如何设法完全扼杀了面向对象编程的便利性：当然，它实现了与 Rails 一样多的 Active Record 模式，但它让你绕过数据结构。

我觉得任何有逻辑的人都会使用错误和动态加载对象的属性来实现 ORM，这正是 ActiveRecord（Rails 库）所做的。设置一个调用成员变量来确定要加载哪些关系的整个想法`$recursive`是完全有缺陷的。

基于 PHP 也很致命。你不能对全局状态做任何事情，你必须依赖`mod_rewrite`，你为每个请求支付启动罚款。当然，您使用的任何环境都有优化，但仍然如此。人们说 Ruby 很慢，但我自己的 Rails 应用程序比他们的 CakePHP 同类应用程序运行得更快，最后我检查了一下。我承认没有这方面的数据。

最糟糕的是，CakePHP 中的错误几乎为我杀死了它。我可以讲很多关于

*   我们花了两天时间弄清楚为什么 CakePHP 拒绝连接到正确的数据库主机
*   由于使用太多组件导致内存上限，我们一半的页面变成空白的时间
*   AppController 中的代码量，因为每个组件加载都需要**几兆字节**的内存
*   按摩数据结构以使 XML 输出正常工作的黑魔法
*   我们如何追踪`<javascript>`显示在每页末尾的空白标签

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-30T03:39:24.943

Cake 的布局很像 Rails，显然从中汲取了很多灵感和想法。Cake 是对 MVC 框架的一个很好的介绍，而且从 cake 经验来看，rails 似乎很简单。

使用 JS 助手的 Cake，Ajax 非常简单。事实上，一切都超级简单。它是一个很棒的框架，特别是对于分布式应用程序（例如 cms）或任何其他易于托管 php 应用程序的情况。

我会看到 Rails 的主要优势是 Ruby（因此更好的 OO 实现 rails 等）和社区。宝石（少得多/不那么全面的蛋糕插件），在线培训材料，书籍（有口才的红宝石吗？）聚会小组等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-01T00:55:18.503

我没有用过CakePHP，但我对它的印象不是太好。如果您正在寻找类似 Rails 的 PHP 框架，我认为您最好还是研究一下[Symfony](http://www.symfony-project.org/)。开始可能有点复杂，但整个项目似乎比 CakePHP 组织得更好。

当然，请持保留态度，因为这些事情是相当主观的。

# open-source - 从开源创建软件衍生作品

> ID：493959
> 
> 赞同：6
> 
> 时间：2009-01-29T23:35:50.553
> 
> 标签：open-source, licensing, derived

这个问题一直萦绕在我的脑海中。

有人可以基于现有的开源项目创建新产品吗？

假设你想创建一个基本上是 Apache 的“Apaxe 网络服务器”，带有一些额外的插件（比如支持 ASP 或类似的东西）

这可能吗？

您能否创建一个封闭源代码产品（免费或许可）

至于 GPL 似乎很清楚这是不可能的，因为源应该是开放的。但是 Apache 许可证、BSD 和其他“企业友好型”呢？

价格（大部分项目免费）、错误修复和核心开发团队的计数是唯一阻止其他人将这些操作系统产品商业化的因素吗？

怎么样：Khrome 一个基于 Chrome 并支持 ActiveX 的商业产品（谁敢做这样的事情：P）

**编辑**

谢谢大家的回答。

所以，再一次

***是什么阻止了类似（克隆）产品出现在市场上？***

:)

注意：我知道我们不是律师，我们可以在[http://www.opensource.org/licenses](http://www.opensource.org/licenses)阅读每个 OSS 许可证。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-30T22:07:40.370

没有什么能阻止克隆产品出现在市场上。例如，查看所有各种 linux 发行版。X.org 项目是从 XFree86 派生的。等等。

不过，这种情况相对较少发生，原因有两个：

*   原项目具有先入市优势
*   原件通常免费赠送

因此，除非您的版本比原来的版本好很多，否则您不会得到太多的吸收或从中赚到很多钱。如果您的版本**明显**更好，请继续！

从原始开发者的角度来看，GPL 的强大之处在于它迫使此类克隆与世界其他地方共享任何改进，因此它们可以重新合并到原始版本中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-29T23:43:24.810

这是我对开源许可证的 10,000 英尺视图：

“真正的”开源许可证（例如：我认为是 MIT、BSD、Apache 等）：您可以使用许可衍生作品做任何您想做的事情。它可以是封闭的、开放的等。该许可对您对衍生作品的许可没有任何限制。

“受限”开源许可（例如：GPL、LGPL）：衍生作品必须包含特定的许可限制；例如，GPL 要求衍生作品必须经过 GPL 编辑。本质上，您对衍生作品的权利受到限制。

对产品的收费与其中任何一项都是分开的；这两种类型都不限制对产品收费，尽管某些许可对您可以保留和/或必须传达给软件接收者的权利进行了限制（即：“受限”许可）。

希望这可以帮助。

编辑：将 GPL 类型许可的原始“DRM”术语更改为“受限”，导致某些人对 DRM 附加负面含义，和/或无法理解 GPL 如何以与任何其他类型几乎相同的方式限制您对衍生作品的权利DRM（即：控制你可以用它做什么）。说真的，你可以成为 FSF 的支持者，但仍然理解 GPL 比“真正的”开源许可证更具限制性的概念。问题不在于哪种类型是对还是错，而在于区别是什么。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-30T07:05:02.113

通常，我对许可证的阅读是：

1.  您可以根据一种流行的许可证（即 GPL、LGPL、Apache、MIT、BSD）制作任何项目的衍生作品。
2.  您至少可以为衍生作品的分发和打包收费。
3.  根据许可，您可能还必须以源代码形式分发您的修改和/或在您的分发中包含通知。

所以对于你关于 Apaxe 的问题：是的，据我所知你可以做到这一点。我相信 Oracle HTTPD 服务器其实是从 Apache 衍生而来的，而且绝对不是免费的！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-29T23:45:00.970

Red Hat（和大多数其他 Linux 供应商）收取支持费用，而不是他们的软件——这主要是公司可以从 GPL 许可的代码中赚钱的方式。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-29T23:46:29.877

这实际上取决于开源项目使用的许可证。

免责声明：我不是律师；您应该始终阅读许可证以获取完整的详细信息。

如果一个项目在 GPL 下，那么你从它派生的任何东西也必须在 GPL 下发布（或兼容的许可证，如果它已经发布的话）。你仍然可以为它收费，但任何购买它的人都必须提供完整的来源，你不能阻止他们也出售它，或者免费赠送它。

如果一个项目在 BSD 许可下，您几乎可以用它做任何事情，包括将其合并到专有的闭源产品中。Windows里面有BSD代码！

其他许可证介于两者之间。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-31T01:53:15.970

看看MyEclipse，它真的只是eclipse+免费插件+myeclipse的插件，而且还需要一些钱。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-12T00:08:32.063

> 是什么阻止了类似（克隆）产品出现在市场上？

没有。*真正的*问题是：类似的克隆产品如何比原始产品更受欢迎？

在某些情况下，有人可能会克隆/分叉一个项目：

*   捡起一个死去的开源项目并继续它的开发。如果新的衍生产品定期维护并且比原始版本获得更多更新，那么人们将开始使用新版本。这是开源的一大好处——好的软件不需要死，因为最初的开发人员停止开发它，但其他人可以从他们离开的地方继续。这种项目的一个例子（我已经使用过）是[Turck MMCache](http://turck-mmcache.sourceforge.net/index_old.html)的开发在 2003 年已经停止，所以[eAccelerator](http://eaccelerator.net/)将它分叉并在 2004 年继续开发。我相信还有很多其他例子。

*   一个开源项目的开发者社区存在分歧，项目一分为二。这就是为什么最好争取在开源项目中达成共识，这样社区就不会被不必要地分裂。如果一个项目被拆分，如果它们成功地吸引了足够多的开发者和用户，它们可能会继续存在，否则它们可能会慢慢消亡。一般来说，应该避免分裂，因为它会使社区更加碎片化和弱化。IIRC，在[生产开源软件的视频演示中](http://producingoss.com/)（好东西！）他们提到了一个案例，一个项目的原始开发者想要在开发中采取一个全新的方向，但其他开发者的社区想要保持旧的方向。结果是原开发者被踢出项目，所以他创建了项目的一个分支，而社区的其他人继续原项目的开发。

*   在许可许可（例如 BSD）下发布的开源项目的商业闭源衍生产品。衍生产品需要在功能或支持方面比原始产品好得多。否则人们会更喜欢使用原始的开放和免费产品。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-29T23:40:20.310

这不是红帽的本质吗？即使他们有fedora，他们也在为他们的Linux 发行版收费。当然，他们已经为它编写了很多代码，它仍然基于开源的东西。

# java - 摇摆的骨架应用程序

> ID：493965
> 
> 赞同：2
> 
> 时间：2009-01-29T23:39:12.637
> 
> 标签：java, swing

我正在摇摆中开始一个简单的项目，但我不想从头开始我正在使用工具栏、文件菜单和基本功能（从应用程序退出、带有简单 actionListener 的按钮工具栏）搜索基本起点。 ..)。我知道有 eclipse rcp 和 netbeans 之一，但它们对于我的项目来说太大了。我正在搜索类似于[jgoodies 骨架](http://www.jgoodies.com/freeware/skeleton/index.html)的东西，但它必须是开源的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-30T00:09:11.810

我不确定它是否正是您想要的，但[Swing 应用程序框架](https://appframework.dev.java.net/)项目可能值得一看。它是“一小组简化构建桌面应用程序的 Java 类”而不是“骨架”。

我自己没有用过，所以不能保证它的用处。

# python - 动态语言的用途

> ID：493973
> 
> 赞同：8
> 
> 时间：2009-01-29T23:42:47.293
> 
> 标签：python, programming-languages, language-design, dynamic-languages, duck-typing

我现在的主要语言是 D，我正在学习 Python，因为它是我正在学习的课程所必需的。虽然我理解为什么动态语言对于在没有类型推断或模板的情况下使用静态语言进行编程的人们来说是一股新鲜空气（恕我直言，模板在很大程度上是编译时的鸭子类型），但我很好奇动态语言有什么好处即使你有这些。

底线是，如果我要学习 Python，我想以一种真正改变我对编程的想法的方式来学习它，而不是仅仅用 Python 编写 D。我没有使用过动态语言，因为我是一个相当新手的程序员，无法欣赏它们应该提供的灵活性，并且现在想学习充分利用它们。什么可以在动态类型的解释语言中轻松/优雅地完成，而这在静态语言中是尴尬或不可能的，**即使使用模板、多态性、静态类型推断，也许还有运行时反射？**

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-30T00:23:01.423

从理论上讲，动态语言不能做任何事情，而静态语言不能。*聪明的人在制作非常好的*动态语言方面付出了很多努力，导致目前人们认为动态语言领先而静态语言需要迎头赶上。

随着时间的推移，这将转向另一个方向。各种静态语言已经有：

*   泛型，通过在传递对象时让它选择正确的类型来减少静态类型的愚蠢，从而使程序员不必自己强制转换

*   类型推断，这样就不必浪费时间编写应该显而易见的东西了

*   闭包，除*其他*外，它有助于将机制与意图分开，让您将复杂的算法与大多数现有成分结合在一起。

*   隐式转换，它可以让您模拟“猴子修补”而没有通常涉及的风险。

*   代码加载和对编译器的轻松编程访问，因此用户和第三方可以编写您的程序。谨慎使用！

*   更有利于在其中创建领域特定语言的语法。

...毫无疑问还有更多。动态运动催生了静态语言设计的一些有趣发展，我们都从竞争中受益。我只希望更多这些功能成为主流。

有一个地方我没有看到主要的动态语言被替换，那就是浏览器中的 Javascript。现有市场有太多需要替代，所以重点似乎是让 Javascript 本身变得更好。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-29T23:54:36.100

[这是史蒂夫·耶格（Steve Yegge](http://steve-yegge.blogspot.com/2008/05/dynamic-languages-strike-back.html)）的主题。

[Guido van Rossum 在他对 Scala 的看法中](http://neopythonic.blogspot.com/2008/11/scala.html)也与那次谈话有关。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-30T01:00:21.100

> “我很好奇动态语言有什么好处，即使你拥有这些。”

与 D 编程语言相比：

*   Python 是一种更紧凑的语言。它允许您表达与 D 一样多的内容，但它使用更少的不同概念来实现它——*少即是多*。

*   Python 有一个强大的标准库——*包括电池*。

我不知道 D 是否有交互式提示，但在 Python 中，像[ipython](http://ipython.scipy.org/moin/Documentation)这样的交互式 shell是开发过程的一个组成部分。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-30T19:45:27.053

Python 中的示例：

```
def lengths(sequence):
    try:
        return sum(len(item) for item in sequence)
    except TypeError:
        return "Wolf among the sheep!"

>>> lengths(["a", "b", "c", (1, 2, 3)])
6
>>> lengths( ("1", "2", 3) )
'Wolf among the sheep!' 
```

你认为这花了我多长时间，以及多少编译-运行-调试周期？

如果您认为我的示例微不足道，我可以回答说动态语言使许多编程任务变得微不足道。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-29T23:59:50.893

在动态语言中，您可以以您知道正确的方式使用值。在静态类型语言中，您只能以编译器知道正确的方式使用值。你需要你提到的所有东西来重新获得被类型系统带走的灵活性（我不是在抨击静态类型系统，灵活性经常被带走是有充分理由的）。如果您想以语言设计者没有预料到的方式使用值（例如，将不同类型的值放入哈希表中），那么您不必在动态语言中处理这种复杂性。

所以并不是说你不能在静态类型语言中做这些事情（如果你有运行时反射），它只是更复杂。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-30T00:27:21.853

我实际上为此写了一篇博客文章： [linky](http://jasonmbaker.wordpress.com/2008/12/11/duck-typing-vs-interfaces/)。但是那个帖子基本上可以这样总结：

您会惊讶于不必在编译时命名您的变量是什么类型是多么令人费解的事情。因此，python 往往是一种非常高效的语言。

另一方面，即使有好的单元测试，你也会对你允许自己犯的愚蠢错误感到惊讶。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-30T03:49:42.193

*使用对象时动态类型*的一大优势是，当您希望多个类具有相同的接口时，您不再需要使用类层次结构——这或多或少称为鸭子类型。糟糕的继承很难在之后修复——这使得重构通常比在像 python 这样的语言中更难。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-30T12:02:25.913

关键是，在动态语言中，您可以比在静态类型语言中更快地实现相同的功能。因此，生产率通常要高得多。

原则上，模板或多态之类的东西给了你很大的灵活性，但你必须编写大量代码才能使其工作。在动态语言中，这种灵活性几乎是免费的。

所以我认为你以错误的方式看待差异，生产力确实是这里的重点（就像垃圾收集提高生产力一样，但实际上并不能让你做新的事情）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-29T23:51:36.747

我要说闭包，但发现[了这个线程](http://www.digitalmars.com/webnews/newsgroups.php?art_group=digitalmars.D&article_id=61016)......（不是我理解它在“静态”语言中的工作方式）

相关概念是[作为第一类对象的函数](http://en.wikipedia.org/wiki/First-class_function)和[高阶过程](http://en.wikipedia.org/wiki/Higher-order_function)。（例如，将函数作为输入和/或返回函数作为输出的函数）

编辑：（对于这里的挑剔者）我会回应我在@David Locke 的帖子上发表的评论。动态解释的语言可以将现有的软件程序/项目与临时创建的小功能或类结合使用，以交互方式探索某些东西。最好的例子可能是函数图。如果我用函数编写了一个函数绘图对象`graph(f,xmin,xmax)`，我可以用它来探索诸如 x ²或 sin(x) 之类的函数。我一直在 MATLAB 中这样做；它被解释并具有匿名函数`@(x) x^2`（

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-29T23:52:10.410

使用动态语言，拥有命令行解释器要容易得多，因此您可以在命令行上测试事物，而不必担心编译步骤来查看它们是否有效。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-30T01:01:42.640

我发现像 Perl 这样的动态语言以及在较小程度上 Python 允许我为我需要做的事情编写快速而肮脏的脚本。动态语言的运行周期要短得多，并且通常需要编写的代码比使用静态类型语言要少得多，这提高了我的工作效率。不幸的是，这是以可维护性为代价的，但这是我用动态语言而不是它们本身的语言编写程序的方式的错误。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-20T17:59:33.347

看一下JavaScript中的这个[e4x示例：](http://en.wikipedia.org/wiki/ECMAScript_for_XML)

```
var sales = <sales vendor="John">
    <item type="peas" price="4" quantity="6"/>
    <item type="carrot" price="3" quantity="10"/>
    <item type="chips" price="5" quantity="3"/>
  </sales>;

alert( sales.item.(@type == "carrot").@quantity );
alert( sales.@vendor );
for each( var price in sales..@price ) {
  alert( price );
} 
```

特别是，看看线：

```
alert( sales.item.(@type == "carrot").@quantity ); 
```

在典型的静态语言中，您不必编写 sales.item，因为直到运行时您才能知道该 item 是 sales 的属性。这不仅限于 e4x。在编写 SOAP 客户端或任何其他直到运行时才知道的底层类型时，您可以在连接时以类似的风格进行编程。在静态语言中，您通常需要运行一个以非常冗长的方式生成存根类或程序的工具。然后，如果 Web 服务发生变化，您需要重新生成存根。看一下java DOM代码：

```
import org.dom4j.Document;
import org.dom4j.DocumentHelper;
import org.dom4j.Element;

public class Foo {

    public Document createDocument() {
        Document document = DocumentHelper.createDocument();
        Element root = document.addElement( "root" );

        Element author1 = root.addElement( "author" )
            .addAttribute( "name", "James" )
            .addAttribute( "location", "UK" )
            .addText( "James Strachan" );

        Element author2 = root.addElement( "author" )
            .addAttribute( "name", "Bob" )
            .addAttribute( "location", "US" )
            .addText( "Bob McWhirter" );

        return document;
    }
} 
```

绝对比您的动态代码详细得多。而且，当然，它不是静态类型的。在运行之前，无法检查您是否将“作者”拼写为“作者”。所有这些冗长的内容本质上都是为了让您以静态风格捕捉本质上是动态的东西。

I think this is one of the strong points of dynamic languages.

* * *

## 回答 #13

> 赞同：-2
> 
> 时间：2009-01-30T01:01:51.643

当效率和类型安全是优先事项时，倾向于使用编译语言。否则我想不出任何人不使用红宝石的理由:)

# python - 使用 python 从 FireFox 检索当前 URL

> ID：493978
> 
> 赞同：4
> 
> 时间：2009-01-29T23:44:47.320
> 
> 标签：python, firefox, python-extensions

我想知道从 python 模块运行 firefox 实例时活动选项卡的当前 url 是什么。FireFox 是否有任何 API 并且 python 知道可以使用它吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-25T03:46:56.113

最方便的方法可能是安装一个firefox扩展来打开一个tcp服务，然后你可以与firefox交换信息。

[mozrepl](http://wiki.github.com/bard/mozrepl)可以设置一个telnet服务，你可以调用类似js的命令来获取信息。

使用 telnetscript（http://code.activestate.com/recipes/152043/），您可以编写：

```
 import telnetscript

script = """rve
w content.location.href;
ru repl>
w repl.quit()
cl
"""

conn = telnetscript.telnetscript( '127.0.0.1', {}, 4242 )
ret = conn.RunScript( script.split( '\n' )).split( '\n' )
print ret[-2][6:] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-30T00:27:25.987

如果在 Windows 上，您可以使用 win32com

```
import win32clipboard
import win32com.client
shell = win32com.client.Dispatch("WScript.Shell")
shell.AppActivate('Some Application Title') 
```

然后使用 shell.SendKeys 来做一个 ctrl+l 和一个 ctrl+c

然后读取剪贴板中的字符串。

虽然它可以工作，但它很有趣，或者您可以使用 AutoIt 之类的东西将代码编译为您可以使用的 exe。

希望这可以帮助。

# python - 用于调整图像大小的 CDN 选项

> ID：493981
> 
> 赞同：2
> 
> 时间：2009-01-29T23:45:54.697
> 
> 标签：python, google-app-engine, rest, image-manipulation, cdn

背景：

我在 Google App Engine 上开发一个应用程序。在我达到他们的文件大小限制之一——1MB 之前，它一直运行良好。我的应用程序的一个组件调整了用户上传的图像大小。这些文件通过 POST直接上传到 S3 ( [http://developer.amazonwebservices.com/connect/entry.jspa?externalID=1434 )。](http://developer.amazonwebservices.com/connect/entry.jspa?externalID=1434)我正计划使用 CDN 来交付调整大小的图像。

问题：

我想知道是否有 CDN 提供了通过 HTTP 调用调整图像大小的 API。我发现 SimpleCDN 曾经提供过该服务，但感觉已将其删除。我想告诉 CDN 调整我从 URL 请求的图像的大小。

例如，

原始网址： [http](http://cdn.example.com/images/large_picture.jpg) ://cdn.example.com/images/large_picture.jpg 将图像大小调整为 125x100： [http ://cdn.example.com/images/large_picture.jpg/125/100](http://cdn.example.com/images/large_picture.jpg/125/100)

有谁知道提供这种功能的 CDN？或者有一个建议来绕过 Google App Engine 的 1MB 限制（不是 hack，而是代码的替代方法）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-09T19:52:56.990

看起来我找到了一项可以提供我真正想要的服务的服务。[Nirvanix](http://developer.nirvanix.com/files/folders/python/entry1253.aspx)提供了一个图像大小调整 API，甚至还有一个很好的库供 Google App Engine 与他们的 API 一起使用。只是想我会分享我的发现。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-11-27T08:15:48.047

SteadyOffload 也是如此。

# c++ - C++ 编译器找不到函数（命名空间相关）

> ID：493985
> 
> 赞同：2
> 
> 时间：2009-01-29T23:49:08.233
> 
> 标签：c++, namespaces, operator-keyword

我在 Visual Studio 2008 中从事 C++ 编程任务。我们提供了定义以下命名空间层次结构的文件（名称只是为了这篇文章，我知道“命名空间 XYZ-NAMESPACE”是多余的）：

```
(MAIN-NAMESPACE){

      a bunch of functions/classes I need to implement...

      (EXCEPTIONS-NAMESPACE){

            a bunch of exceptions
      }

      (POINTER-COLLECTIONS-NAMESPACE){

            Set and LinkedList classes, plus iterators
      }
} 
```

MAIN-NAMESPACE 内容在一堆文件之间拆分，出于某种我不理解的原因，Set 和 LinkedList 的 operator<< 完全在 MAIN-NAMESPACE 之外（但在 Set 和 LinkedList 的头文件中）。这是套装版本：

```
template<typename T>
std::ostream& operator<<(std::ostream& os, 
                         const MAIN-NAMESPACE::POINTER-COLLECTIONS-NAMESPACE::Set<T>& set) 
```

现在问题来了：我有以下数据结构：

```
Set A
Set B
Set C
double num 
```

它被定义在 MAIN-NAMESPACE 中的一个类中。当我创建该类的一个实例并尝试打印其中一组时，它告诉我：错误 C2679：二进制“<<”：未找到采用“const MAIN-NAMESPACE”类型的右侧操作数的运算符： :POINTER-COLLECTIONS-NAMESPACE::Set' （或没有可接受的转换）

但是，如果我只是编写一个 main() 函数，并创建 Set A，填充它并使用运算符 - 它可以工作。

知道有什么问题吗？（注意：我尝试了 using 和 include 我能想到的任何组合）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-30T00:48:27.987

奇怪 - 尽管将与类型关联的自由函数放到不同的命名空间是一种不好的做法，但全局命名空间声明始终是可见的。

我唯一能想到的是，具有相同名称的声明 in`MAIN-NAMESPACE`会影响全局命名空间中的声明 - 在 中是否有`operator<<`可能是完全不相关的类型`MAIN-NAMESPACE`？如果是这样，您应该通过`using ::operator<<`在`MAIN-NAMESPACE`. 例子：

```
namespace A
{
namespace B
{
  class C{};
}

}

void f(A::B::C*);

namespace A
{
  void f(int*); // try commenting
  using ::f; // these two lines
  void g()
  {
    B::C* c;
    f(c);
  }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-30T13:38:47.277

好的，我想通了。jpalecek 关于命名空间中存在另一个 operator<< 的直觉是正确的（显然我忘了将其注释掉）。

命名空间的查找规则首先在函数调用的命名空间中开始搜索，然后搜索封闭的命名空间，直到全局命名空间（如果没有找到匹配项，它会执行依赖于参数的查找）。但是，如果一路上它找到了一些与 operator<< 的匹配项，它就会停止搜索，而不管这些函数中使用的类型可能不兼容，就像这里的情况一样。

解决方案是将其包含到 MAIN-NAMESPACE 中（我不允许这样做），或者使用“使用 ::operator<<”从全局命名空间中导入它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-30T00:23:32.187

尝试显式调用该函数？

```
::operator<<( cout, myObj ); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-30T00:31:42.670

正如 SoaBox 指出的那样，尝试显式调用它。

供您参考，如果您希望调用已隐藏在当前命名空间中的全局函数，请在函数前加上 :: 以绕过局部函数并调用全局函数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-30T00:39:13.793

**更正**：以下文本基于 g++ 系列编译器的经验。在对答案发表评论后，我重新阅读了标准（其中指出 ADL 将用于常规名称查找，并且常规名称查找应该找到运算符<<）。我也尝试过使用[comeau](http://www.comeaucomputing.com/)编译器（我所知道的最符合标准的编译器）并且找到了符号。这似乎是 g++ 的问题（尝试了 3.3、4.1、4.3 版）。

*原答案：*

搜索 Koening 查找（技术上是 ADL：参数相关查找）。

简短的回答是，如果您有以下课程：

```
namespace test {
    class A {};
} 
```

流插入运算符应定义为：

```
namespace test {
    std::ostream& operator<<( std::ostream&, A const & );
} 
```

函数或运算符应与它所采用的参数之一在同一命名空间中定义。(*)

当编译器发现一个函数调用时，例如：

```
namespace test2 {
   void g() {
      namespace1::class1 c1;
      namespace2::namespace3::class2 c2;
      f( c1, c2 );
   }
} 
```

它将尝试在当前命名空间（调用位置）或 c1 和 c2 类型的封闭命名空间（命名空间 1、命名空间 2::命名空间 3）中查找*f*函数，但不会在搜索中尝试其他命名空间。

(*) 在这种情况下，您几乎只能使用*test*命名空间，因为不允许您将函数添加到 std 命名空间（仅限模板特化）。

*原帖结束*。

即使如前所述，这可能只是编译器的问题，这是常见的用法，建议在与类型本身相同的命名空间中定义对用户定义类型进行操作的所有自由函数。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-30T00:50:31.260

> 尝试显式调用该函数？
> 
> ::operator<<( cout, myObj );

是的，这确实有效！

> 它将尝试在当前命名空间（调用位置）或 c1 和 c2 类型的封闭命名空间（命名空间 1、命名空间 2::命名空间 3）中查找 f 函数，但不会在搜索中尝试其他命名空间。

所以让我们看看我是否做对了：从 main() 函数调用 operator<< 的原因是因为我在全局命名空间中（就像 operator<<）。从我实现的类调用时失败的原因是该类位于非全局命名空间中，并且其中没有将编译器指向全局命名空间的变量。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-30T01:07:20.337

好的人们要求一个具体的例子，所以这里是代码的相关部分。//免责声明：在slim case中，我大学的某个人看到了这个，在提交文件中遇到了它，并决定我复制了它什么的，我的学号是311670137

这是头文件 Set.h：

```
 namespace MTM {//This is the MAIN-NAMESPACE

    namespace PointerCollections {

        (ITERATORS AND PREDICATE CLASSES)

        template<typename T>
        class Set {
        public:

        /////////////////////////////////
        // Definitions
        /////////////////////////////////

        private:

        /////////////////////////////////
        // Definitions
        /////////////////////////////////

        };

///////////////////////////////////////////////////////////////////////////////
// The implementation part. 
///////////////////////////////////////////////////////////////////////////////
      }
}
// operator<< - the same a Set::print(std::ostream& os,
//                                    const BinaryPredicate<T>& predicate) 
// function called with the 'predicate' parameter omitted
template<typename T>
std::ostream& operator<<(std::ostream& os, 
                         const MTM::PointerCollections::Set<T>& set){

    set.print(os);
    return os;
} 
```

这是我在另一个文件中定义的：

```
namespace MTM {
    using std::ostream;

    class Schedule {
    public:
      ///////////////////
      //Definitions, including: 
      ///////////////////
    void registerStation(string stationName);
    void reportRegisteredStations(std::ostream& outputStream) const;

    private:     //My database
               //All the classes Set recieves are defined elsewhere
        Set<RegisteredStation> places;
        Set<BusLine> busses;
        Set<TrainLine> trains;
        double tarifForBuses;
        double tarifForTrains;
    };

} 
```

以下是主要内容：

```
Schedule s();
s.registerStation("1");
s.reportRegisteredStations(cout);//This invokes the error. Definition follows: 
```

reportRegisteredStations 定义为：

```
void Schedule::reportRegisteredStations(std::ostream& outputStream) const{

        outputStream<<places;
    } 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-30T01:26:55.743

这对我有用

```
#include <iostream>
#include <string>
using std::string;

   namespace MTM {//This is the MAIN-NAMESPACE

    namespace PointerCollections {

        template<typename T>
        class Set {
        };

      }
}
template<typename T>
std::ostream& operator<<(std::ostream& os, 
                         const MTM::PointerCollections::Set<T>& set){

    return os;
}

namespace MTM {
    using std::ostream;
  using PointerCollections::Set;
    class Schedule {
    public:
      ///////////////////
      //Definitions, including: 
      ///////////////////
    void registerStation(string stationName);
    void reportRegisteredStations(std::ostream& outputStream) const;

    private:     //My database
               //All the classes Set recieves are defined elsewhere
        Set<int> places;
        Set<int> busses;
        Set<int> trains;
        double tarifForBuses;
        double tarifForTrains;
    };
void Schedule::reportRegisteredStations(std::ostream& outputStream) const{

        outputStream<<places;
    }

}

int main()
{
  MTM::Schedule s;
  s.reportRegisteredStations(std::cout);
} 
```

# asp.net - 控件可见属性的数据绑定函数不起作用

> ID：493986
> 
> 赞同：2
> 
> 时间：2009-01-29T23:49:31.477
> 
> 标签：asp.net

我正在使用数据绑定来设置控件上的可见属性，如下所示：

页面控制：

```
<asp:LinkBut​​ton ID="ApproveTimeLink" runat="server" Visible="<%# CanApprove() %>">批准时间</asp:LinkBut​​ton>

```

CodeBehind 上的代码：

```
受保护的布尔 CanApprove()
{
  返回假；
}

```

如您所见，控件不应该显示，但仍然显示。我没有收到任何错误，我很困惑为什么这不起作用。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-30T07:04:20.443

你所要做的就是以下

```
protected void Page_Load(object sender, EventArgs e)
{
    this.DataBind();
}
public bool CanApprove()
{
    return false;
} 
```

那么您可以在 asp-control 上使用此方法，如您之前提到的！

但请注意！页面的每个属性都必须**不为 null**，否则数据绑定将失败并出现异常！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-30T06:35:49.393

有时您无法使用 <%# %> 设置控件属性，您必须求助于使用 OnItemDataBound(...) 来获取对控件的引用并在那里设置其 Visible 属性。有时可能成为问题的另一件事是嵌套引号，但在您的示例代码中，我不认为这是一个问题。如果您的真实代码包含嵌套引号，例如 Visible="<%# CanApprove(Eval("ID"))%>" 那么这可能是您真正的问题。您可以通过使用单引号并与双引号交替来解决此问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-03-11T15:45:54.957

这对我也很有用...谢谢！

```
<asp:Label runat="server" ID="lblLocaton" Text='<%# String.Format("{0}, {1}", Eval("City"), Eval("Region.Code")) %>'  Visible="<%# ShowLocation() %>" /> 
```

和

```
MfnPresenter.Website.Presenters.IInstituitonListView.ShowLocation

    Get

    End Get
    Set(ByVal value As Boolean)

        'Used by visibility binding expression on lblLocation control inside dlFinancialInsitution

    End Set
End Property 
```

# video - 什么是最安全的流媒体视频格式？

> ID：493996
> 
> 赞同：12
> 
> 时间：2009-01-29T23:53:22.420
> 
> 标签：video, streaming, drm

我有一个项目需要播放视频但不允许下载。

我很想使用 Flash，但我见过一些应用程序可以让你从 YouTube 下载文件——这让我怀疑 Flash 是否不那么安全。

*我必须*使用 Quicktime 还是 Windows Media？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-01-29T23:59:02.173

如果您将数据发送给某人，则无法阻止他们捕获数据以供以后重播。故事结局。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-01-30T00:07:22.830

如果您想使用 Flash，那么您可以结合使用 RTMPE 协议（重要的是“E”部分）和[SWF 验证](http://livedocs.adobe.com/flashmediaserver/3.0/docs/help.html?content=03_configtasks_22.html)来保护您的媒体流。这并非牢不可破，因为数据必须解密才能播放并且不受 DRM 保护，但它提供了合理的威慑力，并且可能足以阻止大多数人尝试使用您的数据。

受 DRM 保护的媒体可提供更高的安全性。Adobe 有一个适用于 Flex 的版本，但我不相信它目前适用于 Flash。除此之外，您还拥有 Apple 或 Microsoft 的实现，它们都非常安全（请注意，Microsoft 刚刚发布了用于 DRM 应用程序的下一代 PlayReady 服务器 SDK）。

坚定的破解者会得到你的数据，不管它对他们有价值；你所能做的就是设置足够多的障碍，让它比它的价值更麻烦。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-30T00:00:11.750

YouTube 可能会使用 Flash 作为播放器，但视频本身是以相当正常的格式下载的。如果您知道 URL（位于 HTML 文件中），那么您可以捕获它。

Quicktime 和 Windows Media 流也可以被捕获。用户可以播放的任何流也可以以某种方式被捕获。**没有任何形式的保护是牢不可破的**。

我想最安全的方法是编写自己的浏览器插件，但这太疯狂了。使用专有格式会使捕捉视频变得更加困难，但仍然不是不可能的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-30T00:02:21.060

我至少能想到该领域的另一个竞争对手：[RealPlayer](http://real.com)。没有好的选择，因为每个 DRM 系统最终都会被破坏，这只是它有多难的问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-30T00:09:36.413

DRM 的本质永远不会是完美的。DRM 的整个想法只是一种通过默默无闻来实现安全的奇特方式，任何称职的安全专业人士都会说这几乎总是错误的解决方案。为了获得适当的安全性，您不会让锁很难找到：您可以保护实际的钥匙。

现在，话虽如此，我可以设想一种接近您想要的方法：但它需要一个自定义插件。您可以使用频繁更改的密钥（例如每隔几秒）对视频流进行加密。这意味着您的插件必须不断请求下一个密钥才能解密下一段视频。即使您使用其他正常格式，这种方法也会使下载的视频毫无用处。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-05-20T16:26:59.150

正如有人之前所说的“模拟孔”。

**引用维基百科：**

> “一旦将数字信息转换为人类可感知的（模拟）形式，以不受限制的形式以数字方式重新捕获模拟再现是一件相对简单的事情”

所以，如果你能看到它——你就可以记录下来。您无法下载原始副本，但谁在乎副本何时变得难以察觉？

只需下载fraps - 命中记录。*****