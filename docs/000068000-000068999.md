# StackOverflow 问答 000068000-000068999

# windows - 用于将 Windows XP + 标准化应用程序推广到小型计算机实验室的简单免费或廉价工具？

> ID：68006
> 
> 赞同：3
> 
> 时间：2008-09-15T23:43:09.033
> 
> 标签：windows, system-administration

我管理着一个拥有约 40 台机器的高中计算机实验室，拥有配备不同硬件的旧 PC。我需要为新机器推出 Windows XP + 一套标准的应用程序和设置，并重新格式化旧机器。

有什么工具可以帮助解决这个问题？它不一定是完美的，但如果它能最大限度地减少我在机器前安装程序和调整设置的时间，那就是一场胜利。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-15T23:46:10.617

远程安装服务和/或 Windows 部署服务。一个或另一个随 Windows Server“免费”提供（RIS 带有 Windows Server 2003 SP1 或更早版本；WDS 带有 Windows Server 2003 SP2 或更高版本），并且非常易于设置和使用。:-) 但是，需要您的计算机支持 PXE 引导。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-16T00:02:02.137

如果您正在处理类似（嗯，完全相同）的配置，答案是 Microsoft Sysprep & Norton/Symantec Ghost。

您实际上要寻找的是为特定计算机进行设置并将它们克隆到不同的硬件。nLite 和无人值守安装对于启动和运行操作系统来说非常棒，但在将单个应用程序设置为非常特定的设置时它们就很糟糕了。Sysprep 和 Ghost 克隆整个设置，从而节省大量时间。

这个过程相当简单：

1.  构建一台计算机，从头开始。
2.  在计算机上创建一个名为“用户”或类似名称的用户。
3.  登录用户并执行所有应用程序安装、自定义和更新。
4.  将所有其他机器的驱动程序添加到 Windows 驱动程序文件夹中。
5.  运行 sysprep.exe，选择使用 minisetup 选项。
6.  Sysprep 关闭机器，然后使用 ghost 制作硬盘映像。
7.  如有必要，使用 ghost 网络副本或串行电缆将磁盘映像克隆到其他机器。
8.  启动时，机器会提示您输入新的网络名称。（实验室环境必不可少。不能有 40 台计算机都命名为 LABMACHINE-1。）

一路上有很多小步骤，但这是要走的路。我还要说这比编程更多的是 IT，但 <3 IT。

好处：

1.  在学术界大量使用。
2.  适用于超低端机器。
3.  [Sysprep 和整个过程都记录在案](http://support.microsoft.com/kb/302577)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-04T11:05:00.850

如果您将 Sysprep 安装在同一硬件上的操作系统上，它的效果很好。但是，如果您有不同的版本，则必须手动为每个版本安装驱动程序。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-15T23:46:25.950

您可以为 XP 创建“无人值守安装”磁盘来设置配置、基本软件等。在[http://unattended.msfn.org/unattended.xp/](http://unattended.msfn.org/unattended.xp/)上有这方面的信息.. 只需写很多 CD 并在驱动器中弹出它们。顾名思义，安装从头到尾自动进行。你只需要交叉你的手指，并希望他们真的这样做。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-15T23:51:34.037

Almeza MultiSet ( [http://www.almeza.com/content/view/31/41/](http://www.almeza.com/content/view/31/41/) ) 或 nLite ( [http://www.nliteos.com/guide/](http://www.nliteos.com/guide/) )。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-14T10:22:05.727

嗯，刚刚遇到[FOG](http://www.fogproject.org/)，可能适合您的需求。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-17T07:46:52.000

**试试[net-runna Enterprise](http://www.net-runna.com/Products/net-runna_Enterprise/)。**

它所做的不仅仅是部署操作系统。通常在实验室环境中，您希望能够将桌面恢复到已知的良好状态。该产品可以配置为在每次启动时执行此操作，并且需要几分钟，因为它是基于文件的，而不是基于扇区的。它不是免费的，但物有所值，因为它可以节省您观看进度条的时间。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-05T08:14:13.423

没有可以满足您需求的工具，但如果您最终不得不在每台机器上手动安装，您可能会发现[Project Dakota](http://www.projectdakota.net/)有助于使机器完全打上补丁并保持最新状态。

# javascript - 我对内联和包含的 Javascript 有疑问

> ID：68012
> 
> 赞同：0
> 
> 时间：2008-09-15T23:45:52.893
> 
> 标签：javascript

我对 JavaScript 比较陌生，正在尝试了解如何正确使用它。

如果我将 JavaScript 代码包装在匿名函数中以避免生成变量`public`，则 JavaScript 中的函数在包含 JavaScript 的 html 中不可用。

在最初加载页面时，JavaScript 会加载并执行，但在随后重新加载页面时，JavaScript 代码不会再次执行执行过程。具体来说，有一个 ajax 调用`httprequest`用于从 PHP 文件中获取数据并将返回的数据传递给回调函数，该回调函数在*成功*处理数据时，如果我可以调用`httprequest`从 html 中执行的函数

```
<script type="text/javascript" ></script> 
```

在每个页面加载时阻止我已经准备好了 - 因为我必须将整个 JavaScript 代码注入该块以使其在页面加载时工作，希望有人可以教育我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-16T00:00:46.307

如果您没有使用 javascript 框架，我强烈建议您使用它。我使用 MooTools，但还有许多其他非常可靠的工具（Prototype、YUI、jQuery 等）。其中包括将功能附加到 DomReady 事件的方法。问题在于：

```
window.onload = function(){...}; 
```

是您只能将一个函数附加到该事件（后续分配将覆盖该事件）。

框架为此提供了更合适的方法。例如，在 MooTools 中：

```
window.addEvent('domready', function(){...}); 
```

最后，还有其他方法可以避免污染全局命名空间。只需命名您自己的代码 (mySite.foo = function...) 将帮助您避免任何潜在的冲突。

还有一件事。从您的评论中，我不能 100% 确定您遇到的问题是特定于页面加载事件的。您是说在ajax返回时也需要执行代码吗？如果是这种情况，请编辑您的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-16T04:51:05.173

> 在最初加载页面时，js 会加载并执行，但在随后重新加载页面时，js 代码不会再次执行执行过程

我不确定我是否完全理解您的问题，因为 JS 应该每次都执行，无论它是包含脚本还是内联脚本。但我想知道您的问题是否与浏览器缓存有关。缓存问题可能有两个不同的点：

1.  您的 javascript 包含正在被缓存，并且您正在尝试从该包含中提供动态生成或最近编辑的 javascript。

2.  您的 ajax 请求正在被缓存。

您应该能够通过在服务器上[设置响应标头来避免缓存。](http://www.google.com/search?q=force+no+cache)
此外，[此页面](http://radio.javaranch.com/pascarello/2005/10/21/1129908221072.html)还描述了另一种解决 ajax 请求缓存问题的方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-15T23:52:03.003

我建议只做window.onload：

```
<script type="text/javascript">
(function() {
    var private = "private var";
    window.onload = function() {
        console.log(private);
    }
})();
</script> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-15T23:48:54.527

最好不要将所有内容都包装在匿名函数中，只希望它被执行。您可以命名该函数，并将其名称放在 body 标记的 onload 处理程序中。这应该确保它在每次加载页面时运行。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-15T23:55:16.227

取决于你想要做什么，但为了避免污染全局命名空间，你可以将你的代码附加到你关心的元素上。

例如

```
<div id="special">Hello World!</div>
<script>
  (function(){
    var foo = document.getElementById('special');
    foo.mySpecialMethod = function(otherID, newData){
      var bar = document.getElementById(otherID);
      bar.innerHTML = newData;
    };
    //do some ajax... set callback to call "special" method above...
    doAJAX(url, 'get', foo.mySpecialMethod);
  })();
</script> 
```

我不确定这是否会解决您的问题，但它是处理它的一种方法。

# windows - 带扩展名的文件夹

> ID：68015
> 
> 赞同：1
> 
> 时间：2008-09-15T23:46:15.843
> 
> 标签：windows, registry

我希望 Windows 能够识别某些文件夹与我的应用程序相关联 - 也许通过命名文件夹“folder.myExt”。

这可以通过注册表完成吗？

更多信息
- 这是针对 x 平台应用程序的（这就是为什么我建议使用带有扩展名的文件夹 - mac 可以处理）
- 我使用的 RAD 读取写入二进制数据的效率不如这个大小“文件夹”将超过 2000 个文件和 500Mb

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-09-15T23:48:07.273

您可以在文件夹上添加“扩展名”，但据我所知，Windows 只是将其全部视为文件夹名称，并在您单击它时像平常一样打开该文件夹。

有几次我在 Windows 系统上打开 .app 时搞砸了，它的行为就像是一个普通文件夹。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-16T01:13:55.303

Windows 中的文件夹根本不受 name.extension 规则的约束，注册表的文件类型处理中只有 1 个条目用于“文件夹”类型。（如果你试图改变它，你将面临非常非常艰难的时期）

获得您想要的效果的唯一简单方法是执行 OpenOffice、MS Office 2007 和大型视频游戏一段时间以来一直在做的事情，使用 ZIP 文件作为容器。（它不一定是“ZIP”，但某些类型的现成容器文件类型比编写自己的更好）像 OO.org 和 Office 2K7 一样，您可以使用自定义扩展名并将您的应用程序指定为处理程序。这也适用于 Mac，因此它可以是跨平台的。然而，它可能不会很快。使用低压缩或不压缩可能会有所帮助。

# java - 来自 Java/Struts 的 ResourceBundle 和替换表达式

> ID：68018
> 
> 赞同：4
> 
> 时间：2008-09-15T23:46:38.900
> 
> 标签：java, jakarta-ee, struts, resourcebundle

如果我有一个资源包属性文件：

A.属性：

```
thekey={0} This is a test 
```

然后我有加载资源包的java代码：

```
ResourceBundle labels = ResourceBundle.getBundle("A", currentLocale);
labels.getString("thekey"); 
```

如何用某个值替换 {0} 文本

```
labels.getString("thekey", "Yes!!!"); 
```

这样输出结果如下：

```
Yes!!! This is a test. 
```

资源包中没有任何方法可以执行此操作。另外，我在 Struts 中，有没有办法使用 MessageProperties 进行替换。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-15T23:59:14.687

您要查找的类是 java.text.MessageFormat；具体来说，调用

```
MessageFormat.format("{0} This {1} a test", new Object[] {"Yes!!!", "is"}); 
```

或者

```
MessageFormat.format("{0} This {1} a test", "Yes!!!", "is"); 
```

将返回

```
"Yes!!! This is a test" 
```

[不幸的是，我无法帮助 Struts 连接，尽管[这](http://www.jguru.com/faq/view.jsp?EID=915891)看起来很相关。]

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-16T00:15:18.457

[org.apache.struts.util.MessageResources](http://struts.apache.org/1.2.7/api/org/apache/struts/util/MessageResources.html)类具有各种方法 getMessage，其中一些带参数插入到实际消息中。

例如。：

```
messageResources.getMessage("thekey", "Yes!!!"); 
```

# mysql - 如何解决存储引擎的错误 122？

> ID：68029
> 
> 赞同：6
> 
> 时间：2008-09-15T23:49:08.347
> 
> 标签：mysql

从一些 mysql 查询中得到这个，感到困惑，因为错误 122 通常是“空间不足”错误，但服务器上还有足够的空间......有什么想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-16T17:02:45.773

答案：由于某种原因，Mysql 在 /tmp 分区上有它的 tmp 表，该分区限制为 100M，并且被 eaccelerator 缓存填充到 100M，即使 eaccel 的使用量限制为 16M。很奇怪，但我只是将 eaccel 缓存移到其他地方并解决了问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-15T23:50:37.640

错误 122 通常表示“磁盘超出配额”错误。服务器上是否可能存在磁盘配额？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-01-21T00:43:50.917

尝试使用 quotaoff 命令关闭磁盘配额。

使用 -a 标志将关闭所有文件系统配额。

```
quotaoff -a 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-05-22T01:01:18.167

我通过增加磁盘大小来解决此问题。尝试 df -h 检查服务器上是否有足够的磁盘空间。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-16T13:53:46.537

are you using innodb tables? if so, you might not have auto-grow turned on and inno can't expand the table space any more.

if these are myisam tables and it only happens on specific tables, i would suspect corruption. do a REPAIR on the tables in question.

# java - 如何将 jstring 转换为 wchar_t *

> ID：68042
> 
> 赞同：13
> 
> 时间：2008-09-15T23:51:29.293
> 
> 标签：java, c++, java-native-interface

假设在 C++ 端，我的函数采用`jstring`名为`myString`. 我可以将其转换为 ANSI 字符串，如下所示：

```
const char* ansiString = env->GetStringUTFChars(myString, 0); 
```

有没有办法得到

`const wchar_t* unicodeString =`...

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-02-01T17:08:03.337

如果这对某人有帮助...我已将此功能用于 Android 项目：

```
std::wstring Java_To_WStr(JNIEnv *env, jstring string)
{
    std::wstring value;

    const jchar *raw = env->GetStringChars(string, 0);
    jsize len = env->GetStringLength(string);
    const jchar *temp = raw;
    while (len > 0)
    {
        value += *(temp++);
        len--;
    }
    env->ReleaseStringChars(string, raw);

    return value;
} 
```

改进的解决方案可能是（感谢您的反馈）：

```
std::wstring Java_To_WStr(JNIEnv *env, jstring string)
{
    std::wstring value;

    const jchar *raw = env->GetStringChars(string, 0);
    jsize len = env->GetStringLength(string);

    value.assign(raw, raw + len);

    env->ReleaseStringChars(string, raw);

    return value;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-16T02:04:03.123

JNI 也有一个 GetStringChars() 函数。返回类型是 const jchar*，jchar 在 win32 上是 16 位的，因此在某种程度上与 wchar_t 兼容。不确定它是真正的 UTF-16 还是其他的东西......

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-02-19T10:48:26.520

谁释放了wsz？我会推荐STL！

```
std::wstring JavaToWSZ(JNIEnv* env, jstring string)
{
    std::wstring value;
    if (string == NULL) {
        return value; // empty string
    }
    const jchar* raw = env->GetStringChars(string, NULL);
    if (raw != NULL) {
        jsize len = env->GetStringLength(string);
        value.assign(raw, len);
        env->ReleaseStringChars(string, raw);
    }
    return value;
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-15T23:57:31.947

一个可移植且强大的解决方案是使用[iconv](http://www.gnu.org/software/libiconv/)，您必须知道您的系统`wchar_t`使用什么编码（例如，Windows 上的 UTF-16，许多 Unix 系统上的 UTF-32）。

如果您想尽量减少对第三方代码的依赖，您还可以手动滚动您自己的 UTF-8 转换器。如果转换为 UTF-32，这很容易，但使用 UTF-16 会有些困难，因为您也必须处理代理对。:-P 此外，您必须小心拒绝[非最短](http://www.google.com/search?q=utf-8+non-shortest)表单，否则在某些情况下会引发安全漏洞。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-11-03T10:36:39.970

我知道这是一年前问的，但我不喜欢其他答案，所以无论如何我都会回答。以下是我们在源代码中的操作方式：

```
wchar_t * JavaToWSZ(JNIEnv* env, jstring string)
{
    if (string == NULL)
        return NULL;
    int len = env->GetStringLength(string);
    const jchar* raw = env->GetStringChars(string, NULL);
    if (raw == NULL)
        return NULL;

    wchar_t* wsz = new wchar_t[len+1];
    memcpy(wsz, raw, len*2);
    wsz[len] = 0;

    env->ReleaseStringChars(string, raw);

    return wsz;
} 
```

**编辑**：此解决方案在 wchar_t 为 2 字节的平台上运行良好，某些平台具有 4 字节 wchar_t 在这种情况下此解决方案将不起作用。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-15T23:58:13.690

如果我们对跨平台能力不感兴趣，在 Windows 中，您可以使用 MultiByteToWideChar 函数，或有用的宏 A2W（参考[示例](http://weblogs.asp.net/kennykerr/archive/2008/07/24/visual-c-in-short-converting-between-unicode-and-utf-8.aspx)）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-29T22:59:03.340

只需使用 env->GetStringChars(myString, 0); Java 传递 Unicode 的本质

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-11-11T12:38:08.817

相当简单。但不要忘记通过 ReleaseStringChars 释放内存

```
JNIEXPORT jboolean JNICALL Java_TestClass_test(JNIEnv * env, jobject, jstring string)
{
    const wchar_t * utf16 = (wchar_t *)env->GetStringChars(string, NULL);
    ...
    env->ReleaseStringChars(string, utf16);
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-12-10T08:52:54.680

我尝试 jstring->char->wchar_t

```
char* js2c(JNIEnv* env, jstring jstr)
{
    char* rtn = NULL;
    jclass clsstring = env->FindClass("java/lang/String");
    jstring strencode = env->NewStringUTF("utf-8");
    jmethodID mid = env->GetMethodID(clsstring, "getBytes", "(Ljava/lang/String;)[B");
    jbyteArray barr = (jbyteArray)env->CallObjectMethod(jstr, mid, strencode);
    jsize alen = env->GetArrayLength(barr);
    jbyte* ba = env->GetByteArrayElements(barr, JNI_FALSE);
    if (alen > 0)
    {
        rtn = (char*)malloc(alen + 1);
        memcpy(rtn, ba, alen);
        rtn[alen] = 0;
    }
    env->ReleaseByteArrayElements(barr, ba, 0);
    return rtn;
}

jstring c2js(JNIEnv* env, const char* str) {
    jstring rtn = 0;
    int slen = strlen(str);
    unsigned short * buffer = 0;
    if (slen == 0)
        rtn = (env)->NewStringUTF(str);
    else {
        int length = MultiByteToWideChar(CP_ACP, 0, (LPCSTR)str, slen, NULL, 0);
        buffer = (unsigned short *)malloc(length * 2 + 1);
        if (MultiByteToWideChar(CP_ACP, 0, (LPCSTR)str, slen, (LPWSTR)buffer, length) > 0)
            rtn = (env)->NewString((jchar*)buffer, length);
        free(buffer);
    }
    return rtn;
}

jstring w2js(JNIEnv *env, wchar_t *src)
{
    size_t len = wcslen(src) + 1;
    size_t converted = 0;
    char *dest;
    dest = (char*)malloc(len * sizeof(char));
    wcstombs_s(&converted, dest, len, src, _TRUNCATE);

    jstring dst = c2js(env, dest);
    return dst;
}

wchar_t *js2w(JNIEnv *env, jstring src) {

    char *dest = js2c(env, src);
    size_t len = strlen(dest) + 1;
    size_t converted = 0;
    wchar_t *dst;
    dst = (wchar_t*)malloc(len * sizeof(wchar_t));
    mbstowcs_s(&converted, dst, len, dest, _TRUNCATE);
    return dst;
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-07-15T05:25:03.713

这是我如何转换`jstring`为`LPWSTR`.

```
const char* nativeString = env->GetStringUTFChars(javaString, 0);
size_t size = strlen(nativeString) + 1;
LPWSTR lpwstr = new wchar_t[size];
size_t outSize;
mbstowcs_s(&outSize, lpwstr, size, nativeString, size - 1); 
```

# c# - 如何从服务器生成 Javascript 文件

> ID：68067
> 
> 赞同：2
> 
> 时间：2008-09-15T23:58:22.147
> 
> 标签：c#, asp.net, javascript, tinymce, blogengine.net

我正在使用 BlogEngine.NET（一个很好的工具），我正在使用 TinyMCE 编辑器，并注意到我可以创建一个外部链接列表，但它必须是一个 javascript 文件：

`external_link_list_url : "example_link_list.js"`

这当然很棒，但是我要使用的链接列表需要从数据库中动态生成。这意味着我需要在页面加载时从服务器创建这个 JS 文件。有谁知道这样做的方法？理想情况下，我只想在每次访问编辑器时覆盖这个文件。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-16T00:09:32.603

我将创建一个 HTTPHandler 响应从数据库读取的所需数据。只需将 HTTPHandler 与 web-config 中的特定文件名“example_link_list.js”相关联。确保你设置

```
context.Response.ContentType = "text/javascript"; 
```

然后只是 context.Response.Write(); 您的外部链接列表

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-16T02:17:00.333

如果您的第 3 方代码不需要 javascript 文件具有 .js 扩展名，那么您可以创建 HTTPHandler 并将其映射到 web.config 中的 .axd 或 .ashx 扩展名 - 无需更改 IIS 设置，因为这些扩展由 IIS 自动配置为由 asp.net 处理。

```
<system.web>
  <httpHandlers>
    <add verb="*" path="example_link_list.axd" type= "MyProject.MyTinyMCE, MyAssembly" />
  </httpHandlers>
</system.web> 
```

这指示 IIS 将对“example_link_list.axd”的所有请求（通过 POST 和 GET）传递给 MyAssembly 程序集中的 MyProject.MyTinyMCE 类的 ProcessRequest 方法（您的 .dll 的名称）

您也可以改用 Visual Studio 的“通用处理程序”模板 - 这将为您创建一个 .ashx 文件和代码隐藏类。也无需编辑 web.config。

使用 HTTPHandler 比使用 .aspx 页面更可取，因为 .aspx 请求具有更多相关的开销（所有页面事件等）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-16T00:06:49.473

如果您不能更改文件扩展名（并且只返回纯文本，调用者不应该关心文件扩展名，js 是纯文本）那么您可以在 IIS 上设置一个处理程序（假设它是 IIS）来处理 javascript 文件.

请参阅此链接 - [http://msdn.microsoft.com/en-us/library/bb515343.aspx](http://msdn.microsoft.com/en-us/library/bb515343.aspx) - 了解如何在 Windows 中设置 IIS 6 以处理任何文件扩展名。然后设置一个 HttpHandler 来接收对 .js 的请求（只要谷歌 httphandler 就可以看到很多像这样的好教程：http: [//www.devx.com/dotnet/Article/6962/0/page/3](http://www.devx.com/dotnet/Article/6962/0/page/3)）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-16T01:23:39.650

只需将它指向一个 aspx 文件，然后让该文件吐出您需要的任何 javascript。我最近用 PHP 中的 TinyMCE 做了这个，它就像一个魅力。

external_link_list_url：“example_link_list.aspx”

在您的 aspx 文件中：

```
<%@ Page Language="C#" AutoEventWireup="false" CodeFile="Default.aspx.cs" Inherits="Default" %>
```

在您的代码隐藏（C#）中：

```
使用系统；

公共部分类默认值：System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        Response.Write("var tinyMCELinkList = new Array(");
        // 将所有链接以正确的格式放在这里..
        Response.Write(string.Format("['{0}', '{1}']", "name", "url"));
        Response.Write(");");
    }
}

```

# wpf - 如何在 WPF 中托管外部应用程序？

> ID：68072
> 
> 赞同：4
> 
> 时间：2008-09-15T23:58:57.277
> 
> 标签：wpf, hosting, external

如何`.Net, Java, VB6, MFC, etc`在 ? 中托管 ( ) 应用程序`WPF window`。

我需要使用`WPF windows`来包装外部应用程序并控制窗口大小和位置。

有没有人对如何实现这一目标或研究方向有任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-16T00:01:55.943

使用 HwndHost 在您的应用程序中托管外部窗口。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-16T00:05:20.087

本文[介绍](http://www.ddj.com/windows/197003872?pgno=2)了如何使用 HwndHost 以及其他一些 Win32 API 调用来完成该任务。

# c# - 从 C# 切换到 C++。有什么必读的吗？

> ID：68084
> 
> 赞同：19
> 
> 时间：2008-09-16T00:00:46.477
> 
> 标签：c#, c++

我试图找到一条从 C# 到 C++ 的阻力最小的路径，虽然我觉得在两年后我能很好地处理 C#，但我仍然不确定我是否已经掌握了 C++ 的“凹槽”，尽管进行了多次尝试.

是否有任何特定的书籍或网站可能适合这种过渡？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-09-16T04:36:42.633

大约两年前，我从 C# 切换到 C++（在编写 java 10 年后）。对我来说最有用的书是 Bruce Eckel 的*Thinking in C++* [ [AMZN](https://rads.stackoverflow.com/amzn/click/com/0139798099) ]。您也可以在[Eckel 的网站上](http://mindview.net/Books/DownloadSites "埃克尔的网站")在线阅读这本书。这是一本写得很好的书——你可以在床上阅读的那种——作为键盘参考也很有用。它假定您对 OO 和一般编程概念非常熟悉。

Stroustrup [ [AMZN](https://rads.stackoverflow.com/amzn/click/com/0201700735) ] 作为参考是非常宝贵的，但除非你试图回答一个非常具体的问题，否则基本上是不可理解的——即使那样，这也是一场斗争。几年来我还没有破解我的 K&R [ [AMZN ]。](https://rads.stackoverflow.com/amzn/click/com/0131103628)我不认为它作为 C++ 参考有多大价值。Myers 的*Effective C++* [ [AMZN](https://rads.stackoverflow.com/amzn/click/com/0321334876) ]（以及，一旦你到达那里，*Effective STL* [ [AMZN](https://rads.stackoverflow.com/amzn/click/com/0201749629) ]）是很棒的书。不过，它们非常具体（例如，“36\. Design functor classes for pass-by-value”），因此在进行转换时不如 Eckel 有用。

在编写托管语言多年后，我编写 C++ 的经验非常棒。C++ 的表达能力是 C# 的 100 倍，而且编写起来非常令人满意——这是有保证的。另一方面，在我仍然可以编写 C# 的极少数情况下，我总是对自己能够快速简洁地完成工作感到惊讶。

无论如何，Eckel 的*Effective C++*可以帮助您进行过渡。有第二卷很好，但没有那么好。坚持原来的。

祝你好运！

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-09-16T00:09:19.343

我推荐Bjarne Stroustrup*的 The C++ Programming language*。这不是一本适合新程序员的书，但我发现它对于有其他语言经验并且不想浪费太多时间来学习 while 循环如何工作的程序员来说非常有效。这是一本内容丰富但内容相当全面的书。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-09-16T00:06:51.020

我建议您阅读[The C++ Programming Language](http://www.research.att.com/~bs/3rd.html)一书（由 Bjarne Stroustrup 撰写）。它可能不是最好的书，但绝对是你迟早应该读的。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-09-16T00:10:32.243

任何由[Meyers写的、由](http://www.aristeia.com/books.html)[相同](http://www.artima.com/cppsource/top_cpp_books.html)的推荐或由[Sutter](http://www.gotw.ca/publications/)写的。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-16T00:18:26.733

Koenig 加速的 C++（**编辑**：和 Moo。）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-16T00:18:04.097

它们从根本上是非常不同的野兽，因此它们之间没有最小的阻力路径。但是，我建议您事先阅读[http://www.phpcompiler.org/doc/virtualinheritance.html](http://www.phpcompiler.org/doc/virtualinheritance.html)，以防您需要重要的继承。它可以为您省去一些麻烦。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-16T00:23:09.483

Bjarne Stroustrup 的 C++ 编程语言是必读的。Effective C++ (Scott Meyers) 是另一本我觉得很有帮助的书。

为了平衡这一切，请阅读 C++ FQA（[http://yosefk.com/c++fqa/](http://yosefk.com/c++fqa/)）——虽然它不是一本书，但它是一种宝贵的资源，我希望我在开始使用它时能够访问它C++。只是不要让它气馁。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-16T00:54:57.627

我发现 Lippman 等人的“C++ Primer：第 4 版”非常出色。它从一开始就强调 STL 的使用、最佳实践和 auto_ptr 的使用。我从 Java 职位转到 C++ 职位，这真的很棒。

作为纯粹的参考，Josuttis 的“C++ 标准库”是最好的 STL（也是最糟糕的......这家伙真的不擅长）

最后，正如其他人所说，Meyer 的 Effective C++ 是 C++ 固有的“陷阱”的必读书籍

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-16T04:41:26.630

这是#C++ EFNet 中人们推荐的书籍列表：[http ://rafb.net/efnet_cpp/books/](http://rafb.net/efnet_cpp/books/)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-16T00:14:41.390

我认为 [K&R]( [http://en.wikipedia.org/wiki/The_C_Programming_Language_(book))](http://en.wikipedia.org/wiki/The_C_Programming_Language_(book)))是 C++ 的先决条件。也许 C++ 最好的一点是它是一个更好的 C。

当然，Stroustrup（如 Mladen Jankovic 所建议）是必读的。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-16T00:17:48.467

我的两本标准书籍是 The Waite Group 出版的 Robert LaFore 的第三版“C++ 中的面向对象编程”，以及 Osborne McGraw-Hill 出版的 Herbert Shildt 的“C++ from the Ground Up”。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-09-18T04:02:16.230

您应该阅读已发布的其他书籍之一，然后还要阅读[The Design & Evolution of C++](https://rads.stackoverflow.com/amzn/click/com/0201543303)。它可以帮助您深入了解该语言试图做什么。

# javascript - 如何在我的 XUL 应用程序中将图像数据复制到剪贴板？

> ID：68103
> 
> 赞同：3
> 
> 时间：2008-09-16T00:05:01.350
> 
> 标签：javascript, xul, xpcom, xulrunner

我有一个需要将图像数据复制到剪贴板的 XULRunner 应用程序。我已经弄清楚如何处理将文本复制到剪贴板，并且可以从剪贴板粘贴 PNG 数据。我想不通的是如何从数据 URL 中获取数据到剪贴板，以便可以将其粘贴到其他应用程序中。

这是我用来复制文本的代码（嗯，XUL）：

```
var transferObject=Components.classes["@mozilla.org/widget/transferable;1"].
    createInstance(Components.interfaces.nsITransferable);

var stringWrapper=Components.classes["@mozilla.org/supports-string;1"].
    createInstance(Components.interfaces.nsISupportsString);

var systemClipboard=Components.classes["@mozilla.org/widget/clipboard;1"].
    createInstance(Components.interfaces.nsIClipboard);

var objToSerialize=aDOMNode;

transferObject.addDataFlavor("text/xul");

var xmls=new XMLSerializer();
var serializedObj=xmls.serializeToString(objToSerialize);

stringWrapper.data=serializedObj;

transferObject.setTransferData("text/xul",stringWrapper,serializedObj.length*2); 
```

而且，正如我所说，我尝试传输的数据是作为数据 URL 的 PNG。所以我正在寻找与上面相同的方法，例如 Paint.NET 可以粘贴我的应用程序的数据。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-25T00:57:38.020

这是我最终使用的一种解决方法，可以很好地解决问题。变量`dataURL`是我最初试图到达剪贴板的图像。

```
var newImg=document.createElement('img');
newImg.src=dataURL;

document.popupNode=newImg;

var command='cmd_copyImageContents'

var controller=document.commandDispatcher.getControllerForCommand(command);

if(controller && controller.isCommandEnabled(command)){
    controller.doCommand(command);
} 
```

这会将图像作为“图像/jpg”复制到剪贴板。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-16T03:16:35.273

Neal Deakin 有一篇关于在 xulrunner[中操作剪贴板的文章。](http://developer.mozilla.org/en/Using_the_Clipboard)我不确定它是否能具体回答您的问题，但绝对值得一试。

# java - Java 是否保存其运行时优化？

> ID：68109
> 
> 赞同：4
> 
> 时间：2008-09-16T00:05:38.527
> 
> 标签：java, optimization, caching

我的教授对一个小程序做了一个非正式的基准测试，Java 时间是：第一次运行 1.7 秒，之后运行 0.8 秒。

*   这完全是由于将运行时环境加载到操作环境中吗？

    或者

*   它是否受到 Java 优化代码和存储这些优化结果的影响（对不起，我不知道技术术语）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-16T00:20:27.880

好的，我找到了我读到的地方。这全部来自“学习 Java”（O'Reilly 2005）：

> 传统 JIT 编译的问题在于优化代码需要时间。因此，JIT 编译器可以产生不错的结果，但在应用程序启动时可能会出现明显的延迟。对于长时间运行的服务器端应用程序来说，这通常不是问题，但对于在功能有限的小型设备上运行的客户端软件和应用程序来说却是一个严重的问题。为了解决这个问题，Sun 的称为 HotSpot 的编译器技术使用了一种称为自适应编译的技巧。如果您查看程序实际花费时间在做什么，就会发现它们几乎将所有时间都花在一次又一次地执行相对较小的部分代码上。重复执行的代码块可能只是整个程序的一小部分，但它的行为决定了程序的整体性能。
> 
> 为了利用这一事实，HotSpot 一开始是一个普通的 Java 字节码解释器，但有一点不同：它在代码执行时测量（分析）代码，以查看哪些部分正在重复执行。一旦知道代码的哪些部分对性能至关重要，HotSpot 就会将这些部分编译为最佳的本机机器代码。由于它只将程序的一小部分编译成机器代码，因此它可以花费必要的时间来优化这些部分。程序的其余部分可能根本不需要编译——只需解释——节省内存和时间。事实上，Sun 的默认 Java VM 可以运行在两种模式中的一种：客户端和服务器，这告诉它是强调快速启动时间和内存节省还是平坦性能。
> 
> 此时要问的一个自然问题是，为什么每次应用程序关闭时都丢弃所有这些好的分析信息？嗯，随着 Java 5.0 的发布，Sun 通过使用以优化形式永久存储的共享只读类部分地提出了这个主题。这显着减少了在给定机器上运行许多 Java 应用程序的启动时间和开销。这样做的技术很复杂，但想法很简单：优化程序中需要快速运行的部分，其余部分不用担心。

我有点想知道自 Java 5.0 以来 Sun 已经用它走了多远。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-16T00:07:55.713

我不知道有任何广泛使用的虚拟机可以在程序调用之间保存统计使用数据——但这对于未来的研究来说无疑是一个有趣的可能性。

您所看到的几乎可以肯定是由于磁盘缓存。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-16T01:38:40.597

我同意这可能是磁盘缓存的结果。

仅供参考，IBM Java 6 VM 确实包含提前编译器 (AOT)。代码不像 JIT 生成的那样优化，但它存储在 VM 之间，我相信某种持久共享内存。它的主要好处是提高启动性能。默认情况下，IBM VM 在调用 1000 次后 JIT 方法。如果它知道一个方法将在 VM 启动期间被调用 1000 次（想想一个常用的方法`java.lang.String.equals(...)`，如运行。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-16T04:35:44.773

我同意海报看到的性能差异很可能是由于磁盘延迟将 JRE 带入内存造成的。即时编译器 (JIT) 不会对小应用程序的性能产生影响。

Java 1.6u10 ( [http://download.java.net/jdk6/](http://download.java.net/jdk6/) ) 在后台进程（即使 Java 没有运行）中接触运行时 JAR，以将数据保存在磁盘缓存中。这显着减少了启动时间（这对桌面应用程序来说是一个巨大的好处，但对服务器端应用程序可能具有边际价值）。

在大型、长时间运行的应用程序中，JIT 会随着时间的推移产生很大的不同 - 但与整体生命周期相比，JIT 积累足够的统计数据以启动和优化所需的时间（5-10 秒）非常非常短应用程序（大多数运行数月和数月）。虽然存储和恢复 JIT 结果是一项有趣的学术练习，但实际改进并不是很大（这就是为什么 JIT 团队更专注于诸如 GC 策略以最小化内存缓存未命中等的原因......）。

运行时类的预编译确实对桌面应用程序有很大帮助（就像前面提到的 6u10 磁盘缓存预加载一样）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-16T18:06:16.883

您应该描述您的基准测试是如何完成的。尤其是在您开始测量时间的时候。

如果您包括 JVM 启动时间（这对基准测试用户体验很有用，但对优化 Java 代码没那么有用），那么它可能是文件系统缓存效应，或者它可能是由称为“Java 类数据共享”的特性引起的：

对于太阳：

[http://java.sun.com/j2se/1.5.0/docs/guide/vm/class-data-sharing.html](http://java.sun.com/j2se/1.5.0/docs/guide/vm/class-data-sharing.html)

这是一个选项，JVM 将准备好的运行时类图像保存到文件中，以便在下次启动时更快地加载（和共享）这些图像。您可以通过 Sun JVM 使用 -Xshare:on 或 -Xshare:off 来控制它。默认值为 -Xshare:auto ，如果存在，它将加载共享类图像，如果不存在，如果目录可写，它将在第一次启动时写入它。

使用 IBM Java 5，BTW 更加强大：

[http://www.ibm.com/developerworks/java/library/j-ibmjava4/](http://www.ibm.com/developerworks/java/library/j-ibmjava4/)

我不知道有任何主流 JVM 可以保存 JIT 统计信息。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-16T00:09:22.073

Java JVM（实际上可能会从不同的 JVM 实现中改变）在刚开始时会解释字节码。一旦它检测到代码将运行足够多次 JIT 将其转换为本地机器语言，它就会运行得更快。

# java - 如何从 Java 应用程序创建 Windows 服务

> ID：68113
> 
> 赞同：232
> 
> 时间：2008-09-16T00:06:34.937
> 
> 标签：java, windows-services

我刚刚继承了一个需要在 XP 和 vista 上作为服务安装的 java 应用程序。自从我以任何形式使用 Windows 已经有大约 8 年了，而且我从来不需要创建服务，更不用说像 java 应用程序之类的东西了（我有一个应用程序的 jar 和一个单一的依赖 jar - log4j ）。使它作为服务运行所需的魔法是什么？我有源代码，因此可以进行代码修改，尽管最好避免。

* * *

## 回答 #1

> 赞同：107
> 
> 时间：2010-03-25T18:02:02.067

[Apache Commons Daemon](http://commons.apache.org/daemon/index.html)是一个不错的选择。它有适用于 windows 服务的[Procrun](http://commons.apache.org/daemon/procrun.html)和适用于 unix 守护进程的[Jsvc 。](http://commons.apache.org/daemon/jsvc.html)它使用限制较少的 Apache 许可证，而 Apache Tomcat 将其作为自身的一部分在 Windows 和 Linux 上运行！让它工作有点棘手，但有一篇[详尽的文章](http://web.archive.org/web/20090228071059/http://blog.platinumsolutions.com/node/234)和工作示例。

除此之外，您可以查看[Apache Tomcat](http://tomcat.apache.org/)中的 bin\service.bat以了解如何设置服务。在 Tomcat 中，他们重命名 Procrun 二进制文件（prunsrv.exe -> tomcat6.exe、prunmgr.exe -> tomcat6w.exe）。

我在使用 Procrun 时遇到了一些困难，您的启动和停止方法必须接受参数 (String[] argv)。例如“start(String[] argv)”和“stop(String[] argv)”会起作用，但“start()”和“stop()”会导致错误。如果您无法修改这些调用，请考虑制作一个引导程序类，该类可以按摩这些调用以满足您的需求。

* * *

## 回答 #2

> 赞同：73
> 
> 时间：2008-09-16T00:11:11.727

我[对 Java Service Wrapper很幸运](http://wrapper.tanukisoftware.org/doc/english/introduction.html)

* * *

## 回答 #3

> 赞同：65
> 
> 时间：2012-05-25T14:45:15.130

**使用[Apache Commons Daemon](http://commons.apache.org/daemon/index.html)，您现在可以拥有自定义的可执行文件名称和图标！** 您还可以获得带有您自己的名称和图标的自定义 Windows 托盘监视器！

现在我的服务使用我自己的名称和图标 (prunsrv.exe) 运行，系统托盘监视器 (prunmgr.exe) 也有我自己的自定义名称和图标！

1.  下载[Apache Commons Daemon 二进制文件](http://www.apache.org/dist/commons/daemon/binaries/windows/)（您将需要 prunsrv.exe 和 prunmgr.exe）。

2.  将它们分别重命名为`MyServiceName.exe`和`MyServiceNamew.exe`。

3.  下载[WinRun4J](http://winrun4j.sourceforge.net/)并使用`RCEDIT.exe`它附带的程序来修改 Apache 可执行文件以嵌入您自己的自定义图标，如下所示：

    ```
    > RCEDIT.exe /I MyServiceName.exe customIcon.ico
    > RCEDIT.exe /I MyServiceNamew.exe customTrayIcon.ico 
    ```

4.  现在像这样安装您的 Windows 服务（有关更多详细信息和选项，请参阅[文档）：](http://commons.apache.org/daemon/procrun.html)

    ```
    > MyServiceName.exe //IS//MyServiceName \
      --Install="C:\path-to\MyServiceName.exe" \
      --Jvm=auto --Startup=auto --StartMode=jvm \
      --Classpath="C:\path-to\MyJarWithClassWithMainMethod.jar" \
      --StartClass=com.mydomain.MyClassWithMainMethod 
    ```

5.  现在你有了你的 Jar 的 Windows 服务，它将使用你自己的图标和名称运行！您还可以启动监视器文件，它将在系统托盘中以您自己的图标和名称运行。

    ```
    > MyServiceNamew.exe //MS//MyServiceName 
    ```

* * *

## 回答 #4

> 赞同：31
> 
> 时间：2013-01-28T00:07:21.180

一个简单的方法是[NSSM Wrapper](http://nssm.cc/) Wrapper（[参见我的博客条目](http://giordanomaestro.blogspot.it/2013/01/running-java-applications-as-windows.html)）。

* * *

## 回答 #5

> 赞同：27
> 
> 时间：2009-05-11T07:50:53.723

另一种选择是[WinRun4J](http://winrun4j.sourceforge.net/ "WinRun4J")。这是一个可配置的 java 启动器，可兼作 Windows 服务主机（32 位和 64 位版本）。它是开源的，对其使用没有任何限制。

（完全披露：我在这个项目上工作）。

* * *

## 回答 #6

> 赞同：18
> 
> 时间：2010-09-02T11:02:18.097

另一个答案是[Yet Another Java Service Wrapper](http://yajsw.sourceforge.net)，这似乎是 Java Service Wrapper 的一个很好的替代品，因为它具有更好的许可。它还旨在易于从 JSW 迁移到 YAJSW。当然，对我来说，Windows 服务器的新手并试图让 Java 应用程序作为服务运行，它非常易于使用。

我发现了其他一些，但最终没有使用：

*   [Java Service Launcher](http://jslwin.sourceforge.net/-)我没有使用它，因为它看起来比 YAJSW 更复杂。我不认为这是一个包装。
*   [JSmooth](http://jsmooth.sourceforge.net/index.php)创建 Window 的服务不是它的主要目标，但[可以做到](http://jsmooth.sourceforge.net/docs/jsmooth-doc.html#N103CD)。我没有使用它，因为自 2007 年以来没有任何活动。

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2017-08-01T16:33:19.930

如果你使用 Gradle Build Tool，你可以试试我的[windows-service-plugin](https://github.com/alexeylisyutenko/windows-service-plugin)，它有助于使用[Apache Commons Daemon Procrun](http://commons.apache.org/proper/commons-daemon/procrun.html)。

要使用插件创建 java windows 服务应用程序，您需要执行几个简单的步骤。

1.  使用适当的方法创建一个主服务类。

    ```
    public class MyService {

        public static void main(String[] args) {
            String command = "start";
            if (args.length > 0) {
                command = args[0];
            }
            if ("start".equals(command)) {
                // process service start function
            } else {
                // process service stop function
            }
        }

    } 
    ```

2.  将插件包含到您的`build.gradle`文件中。

    ```
    buildscript {
      repositories {
        maven {
          url "https://plugins.gradle.org/m2/"
        }
      }
      dependencies {
        classpath "gradle.plugin.com.github.alexeylisyutenko:windows-service-plugin:1.1.0"
      }
    }

    apply plugin: "com.github.alexeylisyutenko.windows-service-plugin" 
    ```

    Gradle 2.1 中引入的新的孵化插件机制的相同脚本片段：

    ```
    plugins {
      id "com.github.alexeylisyutenko.windows-service-plugin" version "1.1.0"
    } 
    ```

3.  配置插件。

    ```
    windowsService {
      architecture = 'amd64'
      displayName = 'TestService'
      description = 'Service generated with using gradle plugin'   
      startClass = 'MyService'
      startMethod = 'main'
      startParams = 'start'
      stopClass = 'MyService'
      stopMethod = 'main'
      stopParams = 'stop'
      startup = 'auto'
    } 
    ```

4.  运行**createWindowsService** gradle 任务以创建 Windows 服务分发。

这就是创建一个简单的 Windows 服务所需要做的一切。该插件将自动下载 Apache Commons Daemon Procrun 二进制文件，将此二进制文件解压缩到服务分发目录并创建用于安装/卸载服务的批处理文件。

在`${project.buildDir}/windows-service`目录中，您将找到服务可执行文件、用于安装/卸载服务的批处理脚本和所有运行时库。安装服务运行`<project-name>-install.bat`，如果你想卸载服务运行`<project-name>-uninstall.bat`。要启动和停止服务，请使用`<project-name>w.exe`可执行文件。

注意，处理服务启动的方法应该创建并启动一个单独的线程来进行处理，然后返回。启动和停止服务时，会从不同的线程调用 main 方法。

有关更多信息，请阅读有关插件和 Apache Commons Daemon Procrun 的信息。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2008-09-16T02:34:49.947

我认为[Java Service Wrapper](http://wrapper.tanukisoftware.org/doc/english/download.jsp)运行良好。请注意，有[三种方法](http://wrapper.tanukisoftware.org/doc/english/integrate.html)可以集成您的应用程序。鉴于您不想更改代码，听起来选项 1 最适合您。配置文件可能有点疯狂，但请记住（对于选项 1）您正在启动的程序以及您将为其指定参数的程序是他们的帮助程序，然后它将启动您的程序。他们为此提供了一个[示例配置文件](http://wrapper.tanukisoftware.org/doc/english/props-example-config.html)。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2011-05-10T18:03:04.203

使用为 Glassfish v3 编写的“ [winsw](https://github.com/kohsuke/winsw) ”，但通常适用于 Java 程序。

需要安装 .NET 运行时。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2009-10-12T08:51:49.800

[JavaService](http://forge.objectweb.org/projects/javaservice/)是 LGPL。这是非常容易和稳定的。强烈推荐。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2010-12-30T02:38:35.777

不同解决方案的一个很好的比较可以在：http: [//yajsw.sourceforge.net/#mozTocId284533](http://yajsw.sourceforge.net/#mozTocId284533)

个人喜欢launch4j

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2017-08-24T01:57:45.047

使用 Java 8，我们可以在没有任何外部工具的情况下处理这种情况。[java 8 附带的javapackager](https://docs.oracle.com/javase/8/docs/technotes/tools/windows/javapackager.html)工具提供了创建自包含应用程序包的选项：

-native type 生成独立的应用程序包（如果可能）。使用 -B 选项为正在使用的捆绑程序提供参数。如果指定了类型，则仅创建此类型的捆绑包。如果未指定类型，则使用 all。

以下值对类型有效：

```
-native type
Generate self-contained application bundles (if possible). Use the -B option to provide arguments to the bundlers being used. If type is specified, then only a bundle of this type is created. If no type is specified, all is used.

The following values are valid for type:

all: Runs all of the installers for the platform on which it is running, and creates a disk image for the application. This value is used if type is not specified.
installer: Runs all of the installers for the platform on which it is running.
image: Creates a disk image for the application. On OS X, the image is the .app file. On Linux, the image is the directory that gets installed.
dmg: Generates a DMG file for OS X.
pkg: Generates a .pkg package for OS X.
mac.appStore: Generates a package for the Mac App Store.
rpm: Generates an RPM package for Linux.
deb: Generates a Debian package for Linux. 
```

如果是 Windows，请参阅以下[文档](https://docs.oracle.com/javase/8/docs/technotes/tools/windows/javapackager.html)，我们可以根据需要创建 msi 或 exe。

```
exe: Generates a Windows .exe package.
msi: Generates a Windows Installer package. 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2008-09-16T02:20:33.537

我以前使用过[JavaService](http://forge.objectweb.org/projects/javaservice/)并取得了很好的成功。它已经有几年没有更新了，但是当我使用它时，它已经非常坚如磐石了。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2008-09-16T02:27:05.580

我不喜欢 Java Service Wrapper 的许可。我使用 ActiveState Perl 编写了一个可以完成这项工作的服务。

我想过用 C# 写一个服务，但是我的时间太紧了。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2008-09-16T02:34:18.263

我总是只使用 sc.exe（参见[http://support.microsoft.com/kb/251192](http://support.microsoft.com/kb/251192)）。它应该从 SP1 安装在 XP 上，如果它不符合您的 Vista 风格，您可以使用 Vista 资源工具包下载加载它。

我没有用 Java 做任何太复杂的事情，但是使用完全限定的命令行参数 (x:\java.exe ....) 或使用 Ant 创建包含依赖项和设置参数的脚本对我来说效果很好。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2017-02-13T12:29:31.490

这很简单，因为您必须输入快捷方式

**Windows 7** `C:\users\All Users\Start Menu\Programs\Startup`（管理员）或`User home directory(%userProfile%)`

**Windows 10：** 运行中 `shell:startup`

在它的属性->快捷方式->目标->`java.exe -jar D:\..\runJar.jar`

**注意：这只会在您登录后运行**

* * *

**具有管理员权限**

`sc create serviceName binpath= "java.exe -jar D:\..\runJar.jar"`将创建 windows 服务

如果你得到**超时**使用`cmd /c D:\JAVA7~1\jdk1.7.0_51\bin\java.exe -jar d:\jenkins\jenkins.war`但即使这样你也会得到超时但在后台 java.exe 将被启动。签入任务管理器

**注意：这将在 Windows 登录启动时运行（登录前，基于服务' `Startup Type`'）**

[创建windows服务详解](https://stackoverflow.com/questions/3663331/creating-a-service-with-sc-exe-how-to-pass-in-context-parameters)

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2008-09-16T06:40:59.463

另一个不错的选择是[FireDaemon](http://www.firedaemon.com/)。它被 NASA、IBM 等一些大商店使用；查看他们的网站以获取完整列表。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2008-09-23T00:26:54.570

我目前需要它来运行基于 Eclipse 的应用程序，但我需要首先设置一些对该应用程序本地的变量。sc.exe 将只允许可执行文件，但不允许脚本，所以我求助于 autoexnt.exe，它是[Windows 2003 资源工具包](http://www.microsoft.com/downloads/details.aspx?FamilyID=9D467A69-57FF-4AE7-96EE-B18C4790CFFD&displaylang=en)的一部分。它将服务限制为单个批处理文件，但我只需要一个批处理脚本即可转换为服务。

再见！

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2021-08-22T02:49:52.550

过去几年我一直在使用[jar2exe在 Windows 上将我们的 Java 应用程序作为服务运行。](https://www.jar2exe.com/)它提供了一个选项来创建一个可以作为 Windows 服务安装的 exe 文件。

# java - Tomcat Servlet 的 context.xml 中资源的通配符

> ID：68120
> 
> 赞同：2
> 
> 时间：2008-09-16T00:07:20.050
> 
> 标签：java, tomcat

我对 Tomcat 并不太熟悉，但我的团队继承了一个复杂的项目，该项目围绕着一个 Java Servlet，该 Java Servlet 托管在多个服务器上的 Tomcat 中。使用自定义配置管理软件写出server.xml，写入server.xml的各种资源（连接池、bean、服务器变量等）配置servlet。这一切都很好。

但是，某些资源的名称事先并不知道。例如，Servlet 可能需要访问操作员配置的任意数量的“匿名器”。每个匿名者都有一个与之关联的唯一名称。我们使用类似于以下的 java bean 创建和配置每个匿名器：

```
<Resource
  name="bean/Anonymizer_toon"
  type="com.company.tomcatutil.AnonymizerBean"
  factory="org.apache.naming.factory.BeanFactory"
  className="teAnonymizer"
  databaseId="50"
/>
<Resource
  name="bean/Anonymizer_default"
  type="com.company.tomcatutil.AnonymizerBean"
  factory="org.apache.naming.factory.BeanFactory"
  className="teAnonymizer"
  databaseId="54"
/> 
```

但是，这似乎要求我们在 Servlet 的 context.xml 文件中为每个可能的资源名称提前明确条目。我想用通配符替换显式 context.xml 条目，或者知道是否有更好的解决方案来解决此类问题。

目前：

```
 <ResourceLink name="bean/Anonymizer_default"
                global="bean/Anonymizer_default"
                type="com.company.tomcatutil.AnonymizerBean"/>

  <ResourceLink name="bean/Anonymizer_toon"
                global="bean/Anonymizer_toon"
                type="com.company.tomcatutil.AnonymizerBean"/> 
```

替换为：

```
 <ResourceLink name="bean/Anonymizer_*"
                global="bean/Anonymizer_*"
                type="com.company.tomcatutil.AnonymizerBean"/> 
```

但是，我无法弄清楚这是否可能或正确的语法可能是什么。任何人都可以就更好的方法来处理这个问题提出任何建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-16T02:37:46.553

我不知道这是否是您需要的，但也许您可能想研究为 Tomcat 创建自己的自定义资源工厂。以下是通过 Tomcat 获取所有事物资源的一般文档：[Tomcat 资源](http://tomcat.apache.org/tomcat-6.0-doc/jndi-resources-howto.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-19T20:52:33.927

我没有遇到过这种情况，但是将像 AnonymizerService 之类的东西作为资源来显示所有不同的所需 AnonymizerBean 可能会更容易。这样，您就不会遇到通配符问题，只需将一个资源发布到 Web 应用程序，您就可以回到定义明确且易于理解的路径上。

希望在最初的问题后大约一个月有所帮助......

# django - Django中类似Plone的搜索框？

> ID：68136
> 
> 赞同：1
> 
> 时间：2008-09-16T00:10:24.317
> 
> 标签：django, search

Plone 有一个漂亮的搜索框，其网站具有类似“Google 建议”的功能。它甚至可以索引上传的文档，例如 PDF。有谁知道可以在 Django 站点中提供这种功能的模块？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-16T00:53:30.080

Plone 通过维护一个单独的索引属性元数据表来实现它的 LiveSearch 功能（最后修改、创建者、标题等字段从内容对象复制到此表中）。内容对象然后发送 ObjectAdded/ObjectModified/ObjectRemoved 事件，事件订阅者监听这些事件并负责更新元数据表（在 Django 中事件被命名为信号）。然后有一个浏览器视图暴露在一个固定的 URL 中，它搜索元数据并返回适当的 LiveSearch HTML，最后每个 HTML 页面都被发送适当的 JavaScript 来处理自动完成 AJAX 功能来查询这个视图并将生成的 HTML 结果放入DOM。

如果您希望 LiveSearch 查询多个模型/内容类型，您可能需要发送自己的事件并让订阅者适当地处理它们。对于较小的数据集或较低流量的站点，这不是必需的，在这些站点中，对单个搜索执行多个查询的性能损失不是问题（或者您只想搜索单个内容类型），您可以只做几个来自您的视图的查询。

至于 JavaScript 方面，您可以自行开发或使用现有的 JavaScript 库。这通常在 JS 库中称为自动完成。初学者有 YUI 自动完成和 Scriptaculous 自动完成，可能还有更多的 JavaScript 自动完成实现。Plone 使用 KSS 作为它的 JavaScript 库，如果要从中寻找示例代码，KSS livesearch 插件是一个很好的起点。

[http://pypi.python.org/pypi/kss.plugin.livesearch](http://pypi.python.org/pypi/kss.plugin.livesearch)

还有一个关于在 Django 中使用 KSS 的教程：

[http://kssproject.org/docs/tutorial/kss-in-django-with-kss-django-application](http://kssproject.org/docs/tutorial/kss-in-django-with-kss-django-application)

KSS 非常好，因为它干净地将行为与客户端的内容分开（无需编写 JavaScript），但 Scriptaculous 在概念上更简单一些，并且具有更好的文档（[http://github.com/madrobby/scriptaculous/wikis/ ajax 自动完成器](http://github.com/madrobby/scriptaculous/wikis/ajax-autocompleter)）。

# c++ - 在 C++ 和 Windows 中使用 XmlRpc

> ID：68144
> 
> 赞同：7
> 
> 时间：2008-09-16T00:12:14.033
> 
> 标签：c++, windows, ssl, xml-rpc

我需要在 Windows 平台上使用 C++ 中的 XmlRpc。尽管我的朋友们向我保证 XmlRpc 是一种“广泛使用的标准技术”，但可用的库并不多。事实上，我只找到了一个在 Windows 上执行此操作的库（加上另一个声称“您必须做很多工作才能在 Windows 上编译它）。我找到的库是 Chris Morley 的“XmlRpc++”。但是，它不支持 SSL。

因此，我的问题是：我应该使用什么库？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-16T02:07:44.777

我已经编写了自己的 C++ 库。可在 sourceforge 获得： [xmlrpcc4win](http://sourceforge.net/projects/xmlrpcc4win/)

我写它而不是使用 Chris Morley 的原因是：

*   Windows“wininet.lib”库为您提供了处理 Http 请求的所有功能，所以我宁愿使用它。结果，我只需要 1700 LOC。
*   “wininet.lib”，因此我的实现，支持 HTTPS
*   Chris Morley 对 STL 容器的使用非常低效（Chris，如果您阅读了这篇文章，请给我发邮件）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-09T07:29:52.547

在我编写自己的库之前，（见上文）这是我的答案：

目前， Chris Morley 的 XmlRpc [++ 库](http://xmlrpcpp.sourceforge.net/)是 Windows 上 C++ 的唯一公共域/LPGL XmlRpc 实现。

Linux 有几个 C++ 实现，其中任何一个都可以很容易地移植到 Windows，但事实似乎是还没有人这样做并使其公开可用。此外，正如 eczamy 所说，“XML-RPC 规范有些简单，实现您自己的 XML-RPC 客户端并不难。”

我成功地使用了 Chris Morley 的库，尽管必须找到并修复相当多的错误。该项目的[帮助论坛](http://sourceforge.net/forum/forum.php?forum_id=240495 "帮助论坛")似乎有些活跃，但没有人修复这些错误并发布新版本。我一直在与 Chris Morley 通信，他模糊地希望发布一个新版本，他为这个 stackOverflow 问题做出了贡献（见下文/上文），他声称已经修复了大部分错误，但到目前为止他还没有发布了一个修复了许多错误的版本。最后一次发布是在 2003 年。

令我失望的是，一个被广泛支持（而且很简单！）的协议在 Windows + C++ 上的支持如此糟糕。请阅读此页面的人拿起接力棒，例如接管 XmlRpc++ 或正确移植 Linux 实现之一。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-16T00:38:06.013

[XML-RPC implementations](http://www.xmlrpc.com/directory/1568/implementations)的实现有几十种，其中一些使用 C++，但大多数使用其他语言。例如，除了 XmlRpc++ 之外，还有[用于 C 和 C++ 的 XML-RPC](http://xmlrpc-c.sourceforge.net/)。这是关于如何使用 C 和 C++ 库的 XML-RPC的[HOWTO 。](http://tldp.org/HOWTO/XML-RPC-HOWTO/xmlrpc-howto-c.html)

XML-RPC 规范有些简单，实现您自己的 XML-RPC 客户端并不困难。更不用说，还可以将现有的 C 语言 XML-RPC 实现引入您的 C++ 项目。

XML-RPC[主页](http://www.xmlrpc.com/)也提供了很多有用的信息。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-10T00:03:45.300

只想注意几点：

*   XmlRpc++ 的 cvs 存储库中的源代码支持 OpenSSL（虽然我没有尝试过，它是由另一个开发人员提供的）。

*   大多数报告的错误已在 cvs 中修复；我目前无法访问 linux 机器，所以我还没有正式发布。

*   [XmlRpc++](http://xmlrpcpp.sourceforge.net/)不是公共领域。它受版权保护和许可 (LGPL)。

谢谢，克里斯·莫利

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-06T20:40:53.353

我能够使用 https 和基本的用户名/密码身份验证获得 Tim 的 xml rpc 版本。

对于身份验证：

1) 用户名​​和密码需要传递给 InternetConnect(...) 函数

2）发送HttpSendRequest(...)命令前需要添加“Authorization: Basic base64encoded(user:pass)”的http请求头。

# code-reuse - 您将代码保留多长 时间？

> ID：68150
> 
> 赞同：5
> 
> 时间：2008-09-16T00:13:16.120
> 
> 标签：code-reuse

去年我学习了 C++ 的数据结构课程，因此在模板代码中实现了所有主要的数据结构。我将它全部保存在闪存驱动器上，因为我有一种感觉，在我生命中的某个时刻，我会再次使用它。我想我最终编程的*东西*需要一个 B-Tree，还是只是妄想？您通常将编写的代码保存多长时间以供可能重用？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2008-09-16T00:14:06.587

永远（或尽可能接近）。这就是源代码控制系统的全部意义所在。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-12T13:53:03.163

-1 保存曾经生产的所有东西。我把这比作一位自豪的父母，他们节省了每一个用过的尿布，以修饰他们小钳子的脸颊。它很糟糕，世界并没有从它的存在中受益。

这里有多少人定期浏览谷歌的第一页？周围有这么多废话似乎很难找到任何有用的东西。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-16T01:07:32.683

+1 永久保留代码。在这个时代，没有理由删除未来可能有价值的数据。即使您不使用 B-Tree 作为有用的结构，您也可能希望查看代码以了解您是如何做某事的。或者更好的是，您可能希望有一天回到代码中用于教学目的。您永远不会知道何时可能想要查看以某种方式完成任务的特定代码片段。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-16T00:16:38.373

如果我使用它，它会卡在 Bazaar 存储库中并上传到 Launchpad。如果它是一个小项目，我通常把它移到一个`junk/`子目录中。

> 我会再次使用它。我想我最终编程的东西需要一个 B-Tree，还是只是妄想？

你写的东西需要一个 B-tree，但你可以为它使用一个库，因为现实世界重视工作解决方案而不是额外的代码。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-16T00:15:01.890

我会尽可能长时间地备份我的所有代码。重要的东西备份在我的网络服务器和外部硬盘上。您以后可以随时删除东西，但如果您认为您可能会发现它的用途，为什么不保留它呢？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-16T01:00:57.597

我仍然有（一些）我在大学时写的代码，那是 18 年前的 :-)。通常情况下，拥有它而不想要它比想要它而不拥有它要好。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-16T00:15:43.073

源代码控制，异地保存，终身保存！你永远不必担心它。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-16T00:20:44.200

我有很多很多年前的代码。事实上，我想我还有我的第一个 php 脚本。如果没有别的，这是一个很好的方式来看看你随着时间的推移发生了多少变化。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-16T00:55:59.840

我同意其他海报。我将我的代码从学校保存在个人源代码存储库中。坚持到底有什么害处？

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-16T01:02:17.673

出于历史原因，我只是将其放在磁盘上。使用 [标准模板库](http://www.sgi.com/tech/stl/)——人们犯的一个错误是假设他们对中度到复杂数据结构的实现是最好的。我无法告诉你我在自制的 B-tree 实现中发现了多少次错误。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-16T01:08:23.197

保留一切！你永远不知道什么时候它会为你节省一些工作。大约一年前，我需要一些 c 代码来解析表达式，将其标记化以进行存储，然后评估结果。丑陋的一小段代码.. 但它似乎很熟悉，因为它应该有——我不得不在大学里做一个修复后评估器（30 年前）——并且仍然有代码。诚然，它需要进行一些清理，但为我节省了几天的工作时间。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-12-12T13:48:29.600

我在大学的时候用 Java 实现了一个红黑树。我一直想再次找到该代码，但找不到。

现在我没有时间从头开始重新创建它，因为我有三个孩子并且不使用 Java 开发。

我现在保留所有东西，以便我可以更快地重新学习。看到我在 1、5、10 年前是如何做某事的，我也觉得很有趣。这让我感觉很好，因为我要么做对了，要么我现在变得更好，并且会以不同的方式做

如果我回到大学给未来的学生讲课，它在要做的事情清单上：

保存一切...

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-12-12T13:57:36.523

我是一个代码打包者，无论好坏，但我会保护它，因为有时它是客户机密。

有时，这真的很有用，比如客户丢失了他们的东西或文档。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-12-12T14:02:23.283

由于没有备份的计算机故障，我丢失了很多旧代码（从 10 年前开始），但实际上我并不在意，因为我真的不想看到用非常古老的语言编写的代码。大部分代码是用VB5编写的......

我同意现在保留所有内容很容易，但我认为有时清理我们的备份/计算机存储是件好事，因为就像在现实世界中一样，我们不需要永远保留所有内容。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-07-07T23:47:57.033

***永远***是电子媒体的美丽。这对我来说是最吸引人的方面之一。

但是，它的保存取决于你的编码风格，以及你用它做什么。

如果你是那种类型，我建议你扔掉你的代码......

*   从不回头。
*   宁愿从你的记忆中重写以提高你的手艺。
*   不是很有条理。
*   被潜藏所困扰，没有尽头。
*   喜欢生活在边缘。
*   崇拜记忆的效率。

折腾的逻辑原因可能是......

*   它困扰着你。
*   它会妨碍您的工作，从而扰乱您的工作流程。
*   你为此感到羞耻。
*   它使您感到困惑并分散您的注意力。

就像生活中任何占用物理空间的东西一样，它的价值与它的实用性相权衡。

我所有的代码都被无限期保留，并计划在某个时候返回到它，反映和重构。我这样做是因为看到我的进步很有趣，并且提供了非常容易获得的学习体验。此外，将我所有的代码合并到一个统一的框架中是我一直努力的方向。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-10-20T14:59:03.637

永远...

好的代码永不消亡。;)

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-10-20T15:13:45.737

我不拥有我开发的大部分代码：我的雇主拥有。所以我不保留该代码（我的雇主会 - 或应该）。

自从我发现了计算，我为不再存在的设备编写了不再有价值的语言的代码。也许有一些模拟器，但保留该代码并运行它会让人怀念。

您可以在 Wikipedia（和许多其他地方）上找到[B-tree](http://en.wikipedia.org/wiki/B-tree)信息（和许多其他主题）。无需保留该代码。

最后，我只保留我拥有和维护的代码。

# c# - 取消全局变量？

> ID：68156
> 
> 赞同：3
> 
> 时间：2008-09-16T00:13:58.693
> 
> 标签：c#, java, oop, global-variables

我有一组深度在 20 年代某处的树对象。这棵树中的每个节点都需要访问其树的根。

几个解决方案：

1.  每个节点可以直接存储对根的引用（浪费内存）
    *   我可以通过“上升”（浪费周期）在运行时计算根
    *   ~~我可以使用静态字段（但这相当于全局）~~

有人可以提供一种不使用全局（在任何变体中）但在内存或周期中分别比 #1 或 #2 更有效的设计吗？

**编辑：**由于我有一组树，我不能简单地将它存储在静态中，因为很难区分树。（感谢麦克库尔特）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-16T00:16:39.153

将根作为参数传递给节点中需要它的任何函数。

编辑：选项实际上如下：

1.  将根引用存储在节点中
2.  根本不存储根引用
3.  将根引用存储在全局中
4.  将根引用存储在堆栈上（我的建议，访问者模式或递归）

我认为这是所有可能性，没有选项5。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-16T00:19:13.297

为什么需要取消全局变量？我理解全局变量的污名是坏的，但有时仅仅拥有一个包含所有元素的全局数据结构是最快的解决方案。

您进行了权衡：代码清晰，未来的性能问题更少。这就是'不要优化'的意思。由于您处于优化阶段，因此有时有必要删除一些可读性和良好的编程实践以提高性能。我的意思是，按位破解是不可读的，但它们很快。

我不确定你有多少树对象，但我个人会选择选项一。除非您要处理数千棵树，否则指针实际上不会超过几个字符串。如果内存确实是一个非常重要的问题，请尝试这两种方法（它们似乎很容易实现）并通过分析器运行它。或者使用优秀的[Process Explorer](http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx)。

编辑：我正在开发的一个应用程序有一个包含大约 55K 节点的节点树。我们构建了树结构，但也维护了一个用于 O(1) 查找的数组。比我们在使用递归 FindNodeByID 方法时得到的 O(m*n) 好得多。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-16T00:38:24.297

将根作为参数传递通常是最好的。如果您使用某种迭代器来导航树，另一种方法是在其中存储对 root 的引用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-16T00:27:53.200

第 1 点是过早的内存优化。#2 是过早的性能优化。您是否分析过您的应用程序以确定内存或 CPU 瓶颈是否给您带来了问题？如果不是，为什么要牺牲一个更可维护的设计来进行对用户没有帮助的“优化”？

我强烈建议您使用#2。每当你存储一些你可以计算的东西时，你所做的就是缓存。有几次缓存是一个好主意，但它也是一个令人头疼的维护问题。（例如，如果您通过更改其父节点将节点从一棵树移动到另一棵树，但忘记更新根字段怎么办？）如果不需要，请不要缓存。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-16T00:31:00.557

您可以从 TreeView 派生一个类，然后添加一个单例静态属性。这样，您就可以有效地添加一个引用该类的单个实例的全局字段，但可以将其命名空间范围限定为该类。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-16T00:37:30.603

忽略对内部类的厌恶，我可以定义一个 Tree 类并将节点定义为内部类。每个节点都可以访问其树的状态，包括其根。

这可能最终与 #1 相同，具体取决于 Java 如何将节点与其父节点关联起来。（我不确定，我必须对其进行分析）

# debugging - 是否可以获得正在运行的进程及其符号表的核心转储？

> ID：68160
> 
> 赞同：69
> 
> 时间：2008-09-16T00:14:57.177
> 
> 标签：debugging, coredump

是否可以获取 gdb 或使用其他一些工具来创建正在运行的进程的核心转储及其符号表？如果有办法在不终止进程的情况下做到这一点，那就太好了。

如果这是可能的，你会使用什么命令？（我正在尝试在 Linux 机器上执行此操作）

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2008-09-16T00:19:07.917

```
$ gdb --pid=26426
(gdb) gcore
保存的 corefile core.26426
(gdb) 分离

```

* * *

## 回答 #2

> 赞同：76
> 
> 时间：2013-01-11T13:34:08.597

或运行`gcore $(pidof processname)`。

这样做的好处是（通过运行 gdb 并向 CLI 发出命令）可以在最短的时间内附加和分离。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-03-29T16:33:33.167

您可以`generate-core-file`在 gdb 中使用命令来生成正在运行的进程的核心转储。

# javascript - JavaScript 将长页面滚动到 DIV

> ID：68165
> 
> 赞同：114
> 
> 时间：2008-09-16T00:15:24.977
> 
> 标签：javascript, html

我在一个长的 HTML 页面上有一个链接。当我单击它时，我希望`div`通过滚动到视图中可以在窗口中看到页面的另一部分。

有点像 `EnsureVisible`其他语言。

我已经检查过了`scrollTop`，`scrollTo`但它们看起来像红鲱鱼。

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：392
> 
> 时间：2010-03-03T02:37:10.640

老问题，但是如果有人通过谷歌找到这个（就像我一样）并且谁不想使用锚或jquery；有一个内置的 javascriptfunction 可以“跳转”到一个元素；

```
document.getElementById('youridhere').scrollIntoView(); 
```

还有什么更好的；根据 quirksmode 上的出色兼容性表，[所有主流浏览器都支持](http://www.quirksmode.org/dom/w3c_cssom.html#t23)此功能！

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2008-09-16T02:58:08.407

如果您不想添加额外的扩展，下面的代码应该适用于 jQuery。

```
$('a[href=#target]').
    click(function(){
        var target = $('a[name=target]');
        if (target.length)
        {
            var top = target.offset().top;
            $('html,body').animate({scrollTop: top}, 1000);
            return false;
        }
    }); 
```

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2008-09-16T00:18:31.803

[JQuery ScrollTo](http://demos.flesler.com/jquery/scrollTo/)怎么样 - 请参阅此示例代码

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2008-09-16T00:17:07.640

```
<a href="#myAnchorALongWayDownThePage">Click here to scroll</a>

<A name='myAnchorALongWayDownThePage"></a> 
```

没有花哨的滚动，但它应该带你去那里。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2018-04-19T09:00:08.930

您可以使用`Element.scrollIntoView()`上面提到的方法。如果你在里面没有任何参数，你会***立刻得到一个丑陋的滚动***。为防止这种情况，您可以添加此参数 - `behavior:"smooth"`。

例子：

```
document.getElementById('scroll-here-plz').scrollIntoView({behavior: "smooth", block: "start", inline: "nearest"}); 
```

只需在网站上替换`scroll-here-plz`为您的`div`或元素即可。如果您在窗口底部看到您的元素，或者位置不是您所期望的，请使用 parameter `block: ""`。您可以使用`block: "start"`或。`block: "end"``block: "center"`

请记住：始终在对象 {} 中使用参数。

如果您仍然有问题，请转到[https://developer.mozilla.org/en-US/docs/Web/API/Element/scrollIntoView](https://developer.mozilla.org/en-US/docs/Web/API/Element/scrollIntoView)

此方法有详细的文档。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2008-09-16T01:51:02.080

滚动的困难在于您可能不仅需要滚动页面以显示 div，而且您可能还需要在任意数量的级别上滚动可滚动的 div。

scrollTop 属性可用于任何 DOM 元素，包括文档正文。通过设置它，您可以控制向下滚动的内容。您还可以使用 clientHeight 和 scrollHeight 属性来查看需要多少滚动（当 clientHeight（视口）小于 scrollHeight（内容的高度）时可以滚动。

您还可以使用 offsetTop 属性来确定元素在容器中的位置。

要从头开始构建一个真正通用的“滚动到视图”例程，您需要从要公开的节点开始，确保它位于其父节点的可见部分，然后对父节点重复相同的操作，等等，所有直到你到达顶部的方式。

其中一个步骤看起来像这样（未经测试的代码，不检查边缘情况）：

```
function scrollIntoView(node) {
  var parent = node.parent;
  var parentCHeight = parent.clientHeight;
  var parentSHeight = parent.scrollHeight;
  if (parentSHeight > parentCHeight) {
    var nodeHeight = node.clientHeight;
    var nodeOffset = node.offsetTop;
    var scrollOffset = nodeOffset + (nodeHeight / 2) - (parentCHeight / 2);
    parent.scrollTop = scrollOffset;
  }
  if (parent.parent) {
    scrollIntoView(parent);
  }
} 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2016-12-20T07:31:19.847

这对我有用

```
document.getElementById('divElem').scrollIntoView(); 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2008-09-16T00:17:18.903

[此处](https://stackoverflow.com/questions/66964/how-do-i-create-a-link-to-a-footnote-in-html)发布的答案- 您的问题的相同解决方案。

编辑：如果你想要一个平滑的滚动，JQuery 的答案非常好——我以前没有看到过。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2008-09-16T00:15:57.423

为什么不是命名锚？

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2008-09-16T00:19:04.563

您需要的属性是 location.hash。例如：

location.hash = 'top'; //将跳转到命名锚“顶部

我不知道如何在不使用 dojo 或类似工具包的情况下制作漂亮的滚动动画，但如果您只需要它跳转到锚点，location.hash 应该可以做到。

（在 FF3 和 Safari 3.1.2 上测试）

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2016-01-14T11:28:22.907

我无法在上面的 futtta 回复中添加评论，但为了更顺畅地滚动使用：

```
onClick="document.getElementById('more').scrollIntoView({block: 'start', behavior: 'smooth'});" 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-09-16T12:31:09.200

对于滚动到 DOM 元素的一般情况，有一个[jQuery 插件](http://demos.flesler.com/jquery/scrollTo/)，但如果性能是一个问题（什么时候不是？），我建议手动进行。这包括两个步骤：

1.  查找您正在滚动到的元素的位置。
2.  滚动到那个位置。

[quirksmode](http://www.quirksmode.org/js/findpos.html)很好地解释了前者背后的机制。这是我的首选解决方案：

```
function absoluteOffset(elem) {
    return elem.offsetParent && elem.offsetTop + absoluteOffset(elem.offsetParent);
} 
```

它使用从 null 到 0 的强制转换，这在某些圈子中是不恰当的礼仪，但我喜欢它:) 第二部分使用`window.scroll`. 所以剩下的解决方案是：

```
function scrollToElement(elem) {
    window.scroll(0, absoluteOffset(elem));
} 
```

瞧！

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2021-09-20T11:20:37.313

As stated already, [Element.scrollIntoView()](https://developer.mozilla.org/en-US/docs/Web/API/Element/scrollIntoView) is a good answer. Since the question says "I have a link on a long HTML page..." I want to mention a relevant detail. If this is done through a functional link it may not produce the desired effect of scrolling to the target div. For example:

HTML:

```
<a id="link1" href="#">Scroll With Link</a> 
```

JavaScript:

```
const link = document.getElementById("link1");
link.onclick = showBox12;

function showBox12()
{
  const box = document.getElementById("box12");
  box.scrollIntoView();
  console.log("Showing Box:" + box);
} 
```

Clicking on *Scroll With Link* will show the message on the console, but it would seem to have no effect because the `#` will bring the page back to the top. Interestingly, if using `href=""` one might actually *see* the page scroll to the div and jump back to the top.

One solution is to use the standard JavaScript to properly disable the link:

```
<a id="link1" href="javascript:void(0);">Scroll With Link</a> 
```

Now it will go to box12 and *stay* there.

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2021-12-21T11:04:51.067

```
<button onClick="scrollIntoView()"></button>
<br>
<div id="scroll-to"></div>

function scrollIntoView() {
 document.getElementById('scroll-to').scrollIntoView({
      behavior: 'smooth'
 });
} 
```

scrollIntoView 方法接受滚动选项来为滚动设置动画。

平滑滚动

```
document.getElementById('scroll-to').scrollIntoView({
          behavior: 'smooth'
 }); 
```

没有动画

```
document.getElementById('scroll-to').scrollIntoView(); 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-09-16T00:20:15.213

scrollTop (IIRC) 是文档中页面顶部滚动到的位置。scrollTo 滚动页面，以便页面顶部是您指定的位置。

你需要的是一些 Javascript 操作的样式。假设您希望 div 离开屏幕并从右侧滚动，您可以将 div 的 left 属性设置为页面的宽度，然后每隔几秒将其减小一个设定的量，直到它到达您想要的位置。

这应该为您指明正确的方向。

附加：对不起，我以为你想要一个单独的 div 从某个地方“弹出”（有点像这个网站有时会这样做），而不是将整个页面移动到一个部分。正确使用锚可以达到这种效果。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2010-03-10T22:13:29.310

我个人发现上面 Josh 的基于 jQuery 的答案是我见过的最好的，并且非常适合我的应用程序......当然，我*已经在*使用 jQuery......我当然不会仅仅为此包含整个 jQ 库一个目的。

干杯!

编辑：好的...发布此消息后仅几秒钟，我就在我的*下方*看到了另一个答案（不确定编辑后是否仍在我下方）说要使用：

document.getElementById('your_element_ID_here').scrollIntoView();

这可以完美运行，并且比 jQuery 版本的代码少得多！我不知道 JS 中有一个名为 .scrollIntoView() 的内置函数，但它确实存在！因此，如果您想要精美的动画，请使用 jQuery。Quick n'dirty...使用这个！

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2015-12-14T21:42:35.390

对于平滑滚动，此代码很有用

```
$('a[href*=#scrollToDivId]').click(function() {
    if (location.pathname.replace(/^\//,'') == this.pathname.replace(/^\//,'') && location.hostname == this.hostname) {
      var target = $(this.hash);
      target = target.length ? target : $('[name=' + this.hash.slice(1) +']');
      var head_height = $('.header').outerHeight(); // if page has any sticky header get the header height else use 0 here
      if (target.length) {
        $('html,body').animate({
          scrollTop: target.offset().top - head_height
        }, 1000);
        return false;
      }
    }
  }); 
```

* * *

## 回答 #18

> 赞同：-2
> 
> 时间：2008-09-16T06:27:25.440

如果我错了，请纠正我，但我一遍又一遍地阅读这个问题，仍然认为 Angus McCoteup 正在询问如何将元素设置为位置：固定。

Angus McCoteup，查看[http://www.cssplay.co.uk/layouts/fixed.html](http://www.cssplay.co.uk/layouts/fixed.html) - 如果您希望您的 DIV 表现得像那里的菜单，请查看那里的 CSS

# version-control - 使用 Visual Source Safe 进行分支的正确方法是什么？

> ID：68169
> 
> 赞同：34
> 
> 时间：2008-09-16T00:16:27.097
> 
> 标签：version-control, branch, visual-sourcesafe

我目前所做的是将项目链接到另一个位置并为其命名，然后选中“共享后分支”框。然后我会检查共享项目并完成它。最后与原项目合并。

这行得通，但感觉很笨拙：我的驱动器上有多个项目实例；每次在不同的分支机构工作时，我都必须更改网站的物理地址（我使用 asp.net 1.1）；

感觉这不是正确的做法。您如何使用 VSS 对项目进行分支？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-16T00:18:37.137

我认为您在问题中描述的方式是您可以在 sourceSafe 中执行此操作的唯一方法。

我通常将复制的目录命名为“V1.0”（或任何合适的名称）并将它们全部保存在作为主项目名称的文件夹中。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-16T00:41:44.010

这是在 SourceSafe 中对源代码进行分支的普遍接受的方式。如果合并和保留历史不成问题，唯一的其他方法是将文件复制到新文件夹，删除只读属性，删除 .vssscc 和 .scc 文件，然后添加新的项目到 SourceSafe。那时，你有一个全新的项目，没有以前的历史。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2011-04-27T10:24:20.613

你可以在这里找到一个很好的参考：http: [//www.codepool.biz/version-control/sourcesafe/branch-in-sourcesafe-vss.html](http://www.codepool.biz/version-control/sourcesafe/branch-in-sourcesafe-vss.html)

基本上右键单击并将您的文件夹拖动到您想要分支的位置，当您放手时，您将获得共享/分支/递归选项。

不寒而栗。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-16T00:19:05.357

您描述的方式是唯一受支持的“分支”方式。正如你指出的那样，它相当笨重。在 VSS 中，最好避免一起分支，因为它会破坏您的源历史记录。

# indexing - 建立索引以获得最快的读取响应的最佳方法是什么？

> ID：68174
> 
> 赞同：1
> 
> 时间：2008-09-16T00:17:06.640
> 
> 标签：indexing

我需要索引多达 500,000 个条目以获得最快的阅读速度。索引需要定期在磁盘上重建。我试图在一个简单的文件（如磁盘上的哈希）或嵌入式数据库中的单个表之间做出决定。我不需要 RDBMS 引擎。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-16T00:54:00.437

也许是[BDB](http://en.wikipedia.org/wiki/Berkeley_DB)？这是一个高性能。不使用 DBMS 的数据库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-16T01:34:36.410

[cdb](http://cr.yp.to/cdb.html)如果数据没有改变。

/艾伦

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-16T01:41:37.577

PyTables Pro 声称“对于不需要快速更新或删除的情况，OPSI 可能是最好的索引引擎之一”。不过我没有亲自使用过，但是 PyTables 的 F/OSS 版本已经给了你很好的性能：

[http://www.pytables.org/moin/PyTablesPro](http://www.pytables.org/moin/PyTablesPro)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-16T00:59:07.680

如果您通过键存储状态对象，那么[Berkeley DB](http://en.wikipedia.org/wiki/Berkeley_DB)怎么样。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-16T00:22:40.950

我假设您指的是关系 DBMS（如 mySql、Oracle 或 Postgres）上的索引表。

索引是辅助数据存储，它按特定顺序保存表的字段子集的记录。

如果创建索引，任何包含在其 WHERE 子句中索引的字段子集的查询都将执行得更快。

但是，添加索引会降低 INSERT 性能。

通常，除非索引损坏，否则不需要重建索引。它们应该由您的 DBMS 动态维护。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-16T00:20:39.987

这就是[MapReduce](http://en.wikipedia.org/wiki/MapReduce)的发明目的。[Hadoop](http://hadoop.apache.org/)是一个很酷的 java 实现。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-16T00:27:57.177

如果数据不需要完全是最新的，您可能还想考虑使用用于 OLAP 目的的数据仓库工具（例如[MSOLAP](http://www.mosha.com/msolap/)）。可以基于预先计算的数据执行闪电般快速的只读查询。

# ms-word - 需要一个可以导出到 Word 的 wiki

> ID：68178
> 
> 赞同：3
> 
> 时间：2008-09-16T00:17:34.923
> 
> 标签：ms-word, wiki, requirements

我正在寻找一个可用于跟踪项目需求的 wiki，但我们希望能够将 wiki（带格式）导出到 Microsoft Word。有谁知道这样做的wiki？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-16T00:19:50.003

[Confluence](http://www.atlassian.com/software/confluence/)就是这样做的。也可以导出为 PDF。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T14:25:49.737

正如 tgamblin 已经提到的那样， [Confluence](http://www.atlassian.com/software/confluence/)可以满足您的需求 - 它会导出到 Word。然而，它的作用还不止于此；使用（免费）[Office 连接器](http://www.atlassian.com/office/)，您可以在 word 中编辑 wiki 页面、在 excel 中编辑单个表格、将 word 文档导入 wiki 等。如果您正在寻找那种级别的集成，那就太棒了。

（公平的警告——虽然他们声称它可以与 OpenOffice 一起使用，但我无法让它工作。虽然使用 MS Office 真的很漂亮。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-09-07T06:38:30.157

我的公司正在为 Confluence 提供一个改进的 Word 导出器，名为“Scroll Office”。与标准导出器相比，您可以导出多个页面并上传带有样式等的 Word 文档来定义输出文档的设计。更多信息：[https ://plugins.atlassian.com/plugin/details/24982](https://plugins.atlassian.com/plugin/details/24982)

（免责声明：我为 Scroll Office 的制造商工作）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-16T00:23:49.107

如果您正在寻找免费的解决方案，MediaWiki 有一些[替代解析器](http://www.mediawiki.org/wiki/Alternative_parsers)可能是一个不错的选择。不过，您可能需要经历多个阶段才能将其转换为 Microsoft Word 格式。

# java - Microsoft Reporting Services Web 服务和 Java

> ID：68209
> 
> 赞同：0
> 
> 时间：2008-09-16T00:22:52.523
> 
> 标签：java, web-services, reporting-services, axis

是否有人成功实施了使用 Microsoft SQL Server 2005 Reporting Services 的基于 Java 的解决方案？Reporting Services 带有一组 Web 服务，允许您控制报表的创建、报表的执行等，而我刚刚开始开发此集成的 POC。我尚未做出的几个选择是，我是想将 Axis2 用于 wsdl-to-java 功能还是使用 WebLogic 的 clientgen (wsdl 2 java) 解决方案。我想我也可以使用 JAX-WS 和 wsimport。在我深入研究之前，我想看看是否有人使用众多可用选项之一成功地做到了这一点。

过去，我遇到了一些关于如何在 .NET 和 Java Web 服务之间处理 null/blank/empty 的问题，我只是想看看这是否是 SSRS 和 Java 集成的问题。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-16T16:52:23.770

我在 RS 方面的经验将引导我建议您使用其他任何东西。我认为 Web 服务部分可以正常工作，但我会担心 RS 如何管理内存以及在做出任何决定之前需要同时运行多少报告。我今天正在与 RS 的内存管理问题作斗争，即使在顶级硬件上也很难运行大型报告（返回的大量行和广泛的结果集）。

话虽如此，如果您认为 RS 可以处理您的使用情况，那么它可能会很好。开发环境很好，很容易理解和布置报告。它拥有的表格布局范例非常好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-21T22:38:26.227

我只是想回来回答我自己的问题。我从 Axis2 开始，它是 Apache 的 SOAP 实现。在使用 WSDL2Java 生成客户端后，我能够成功调用 Microsoft Reporting Services WebService 并生成报表，输出为 Excel、PDF、CSV 和其他格式。在我的例子中，我还使用 Axis2 或 HttpClient 的 NTML 身份验证机制让我的应用程序使用来自 Active Directory 的凭据自动“登录”，并生成报告并将其分发给许多用户。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-04-21T09:52:26.893

我们已经成功地实现了：JBoss 5 -> IIS 代理 -> MS Reporting Services 2008（通过 webservice）。

有几个缺陷：MS RS 2008 不再支持“匿名”访问（2005 支持），并且强制使用 NTLM 身份验证。这在 Java 世界中仍然是一个挑战，没有好的 NTLM 库可用。

为了克服这个问题，我们实现了简单的代理（IIS7 + ashx），它在 RS 上进行 NTLM 身份验证（用户/密码硬编码）并允许 JBoss 匿名访问（通过简单地重写 http 响应）。

工作正常:)

干杯P

# asp.net-mvc - MVC 在每个请求上检索模型

> ID：68234
> 
> 赞同：0
> 
> 时间：2008-09-16T00:26:56.790
> 
> 标签：asp.net-mvc

假设我正在开发一个将由多个部门使用的帮助台应用程序。应用程序中的每个 URL 都将包含一个表示特定部门的键。密钥始终是系统中每个操作的第一个参数。例如

```
http://helpdesk/HR/Members
http://helpdesk/HR/Members/PeterParker
http://helpdesk/HR/Categories
http://helpdesk/Finance/Members
http://helpdesk/Finance/Members/BruceWayne
http://helpdesk/Finance/Categories 
```

问题是，在每个请求的每个操作中，我都必须采用此参数，然后根据该密钥从存储库中检索 Helpdesk Department 模型。从该模型中，我可以检索成员、类别等的列表，这对于每个帮助台部门都是不同的。这显然违反了 DRY。

我的问题是，我如何创建一个基本控制器，它为我执行此操作，以便 URL 中指定的特定帮助台部门可用于所有派生控制器，并且我可以专注于操作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-17T13:29:51.453

我的一个项目中有一个类似的场景，我倾向于使用 ModelBinder 而不是使用单独的继承层次结构。您可以创建一个 ModelBinder 属性来从 RouteData 中获取实体/实体：

```
public class HelpdeskDepartmentBinder : CustomModelBinderAttribute, IModelBinder {

    public override IModelBinder GetBinder() {
        return this;
    }

    public object GetValue(ControllerContext controllerContext, string modelName, Type modelType, ModelStateDictionary modelState) {
        //... extract appropriate value from RouteData and fetch corresponding entity from database. 
    }
} 
```

...然后您可以使用它使 HelpdeskDepartment 可用于您的所有操作：

```
public class MyController : Controller {
    public ActionResult Index([HelpdeskDepartmentBinder] HelpdeskDepartment department) {
        return View();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-16T00:53:00.940

*免责声明：我目前正在运行 MVC Preview 5，所以其中一些可能是新的。*

最佳实践方法：只需实现一个静态实用程序类，该类提供一个执行模型查找的方法，将动作中的 RouteData 作为参数。然后，从需要模型的所有操作中调用此方法。

笨拙的方式，仅当每个控制器中的每个操作都需要模型时，并且您真的不希望在您的操作中调用额外的方法：在您的控制器实现基类中，覆盖 ExecuteCore()，使用 RouteData 填充模型，然后调用 base.ExecuteCore()。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-16T13:42:45.427

您可以通过普通的 C# 继承创建一个基本控制器类：

```
public abstract class BaseController : Controller 
{
}

public class DerivedController : BaseController 
{
} 
```

您只能将此基类用于需要部门的控制器。您不必执行任何特殊操作来实例化派生控制器。

从技术上讲，这很好用。然而，从设计的角度来看，存在一些风险。如您所说，如果您的所有控制器都需要一个部门，那很好。如果只有其中一些需要一个部门，那可能还是可以的。但是，如果某些控制器需要一个部门，而其他控制器需要一些其他继承行为，并且两个子集相交，那么您可能会发现自己陷入了多重继承问题。这表明继承不是解决您陈述的问题的最佳设计。

# python - 什么是开始编写编程语言的好资源，不是上下文无关的？

> ID：68243
> 
> 赞同：14
> 
> 时间：2008-09-16T00:28:16.567
> 
> 标签：python, compiler-construction, programming-languages, interpreter

我正在寻找一种有趣的编程语言，但是我所看到的大部分资源都是用于编写无上下文语言的，但是我希望编写一种像 python 一样使用缩进的语言，据我所知，这意味着它可以不要与上下文无关。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-11-04T10:56:31.770

简单地说，上下文无关文法是不需要符号表即可正确解析代码的文法。上下文相关的语法可以。

D 编程语言是上下文无关文法的一个例子。C++ 是一种上下文敏感的。（例如，T*x 是声明 x 是指向 T 的指针，还是将 T 乘以 x ？我们只能通过在符号表中查找 T 来判断它是类型还是变量。）

空白与它无关。

D 使用上下文无关文法是为了大大简化解析它，以便简单的工具可以解析它（例如语法高亮编辑器）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-16T00:42:28.500

您可能想阅读这篇写得很好的关于解析 Python 的文章，[Python: Myths about Indentation](http://www.secnetix.de/olli/Python/block_indentation.hawk)。

虽然我没有尝试使用 yacc 之类的东西编写上下文无关解析器，但我认为可以使用条件词法分析器来返回 url 中描述的缩进更改标记。

顺便说一下，这里是来自 python.org 的官方 python 语法：http: [//www.python.org/doc/current/ref/grammar.txt](http://www.python.org/doc/current/ref/grammar.txt)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-16T09:41:38.563

我会首先通过阅读有关该主题的一些文献来熟悉该问题。Aho 等人的经典*编译器*书籍。人。可能对数学和comp sci 很重，但更平易近人的文本是Jack Crenshaw 的[*Let's Build a Compiler*](http://compilers.iecc.com/crenshaw/)文章。这是 Crenshaw 先生在 80 年代后期写的一系列文章，也是有史以来关于编译器最不被重视的文章。方法简单明了：Crenshaw 先生展示了“ **A**" 可行的方法。您可以在几个晚上轻松浏览内容，并且更好地理解编译器的全部内容。需要注意的是，文本中的示例是用 Turbo Pascal 编写的，并且编译器发出 68K 汇编程序。这些示例很容易移植到更新的编程语言，为此我建议使用 Python。但如果您想按照示例进行操作，您至少需要[Turbo Pascal 5.5](http://dn.codegear.com/article/20803)和[68K 汇编程序和模拟器](http://www.easy68k.com/). 该文本在今天仍然具有相关性，使用这些旧技术真的很有趣。我强烈推荐它作为任何人关于编译器的第一本书。好消息是 Python 和 Ruby 等语言是开源的，您可以下载和研究 C 源代码，以便更好地了解它是如何完成的。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-09-24T17:54:45.073

“上下文无关”是一个相对术语。大多数无上下文解析器实际上解析了一个无上下文语言的超集，然后检查生成的解析树以查看它是否有效。例如，以下两个 C 程序根据 C 的上下文无关文法是有效的，但在上下文检查过程中一个很快就失败了：

```
int main()
{
    int i;
    i = 1;
    return 0;
}

int main()
{
    int i;
    i = "Hello, world";
    return 0;
} 
```

没有上下文，`i = "Hello, world";`是一个完全有效的赋值，但在上下文中你可以看到类型都是错误的。如果上下文是`char* i;`，那就没问题了。因此，上下文无关解析器不会发现该分配有任何问题。直到编译器开始检查类型（取决于上下文）它才会捕获错误。

任何可以用键盘产生的东西都可以被解析为上下文无关的；至少您可以检查所有使用的字符是否有效（仅包含可显示 Unicode 字符的所有字符串的集合是上下文无关语法）。唯一的限制是您的语法有多有用，以及您必须对生成的解析树进行多少上下文相关检查。

像 Python 这样的依赖于空格的语言会降低上下文无关语法的用处，因此以后需要更多的上下文相关检查（其中大部分是在 Python 中通过动态类型在运行时完成的）。但是在需要上下文相关检查之前，上下文无关解析器仍然可以做很多事情。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-16T00:40:10.190

我不知道任何教程/指南，但您可以尝试查看[tinypy](http://www.tinypy.org/)的源代码，它是类似 python 的语言的一个非常小的实现。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-16T00:45:43.127

在语言中使用缩进并不一定意味着该语言的语法不能是上下文无关的。即缩进将确定语句存在的范围。无论在哪个范围内定义语句，它仍然是一个语句（范围通常可以由编译器/解释器的不同部分处理，通常在语义解析期间）。

也就是说，一个很好的资源是 antlr 工具 ( [http://www.antlr.org](http://www.antlr.org) )。该工具的作者还制作了一本关于使用 antlr ( [http://www.pragprog.com/titles/tpantlr/the-definitive-antlr-reference](http://www.antlr.org) ) 创建语言解析器的书。有很好的文档和很多示例语法。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-11-24T21:03:52.997

如果您真的要在语言设计和实现方面有所尝试，您可能需要将以下内容添加到您的书架中：

*   编程语言语用学，斯科特等人。
*   编程语言中的设计概念，Turbak 等人。
*   现代编译器设计，Grune 等。（比起 Aho 等人的《龙之书》，我更喜欢这本书。）

更温和的介绍，例如：

*   Crenshaw 的教程（这里由@'Jonas Gorauskas' 建议）
*   Parr 的权威 ANTLR 参考
*   Martin Fowler 最近在 DSL 方面的工作

您还应该考虑您的实现语言。这是不同语言在它们所促进的方面有*很大差异的领域之一。*您应该考虑 LISP、F#/OCaml 和 Gilad Bracha 的新语言 Newspeak 等语言。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-16T03:34:58.443

你读过 Aho、Sethi、Ullman：“编译器：原理、技术和工具”吗？这是一本经典的语言参考书。

/艾伦

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-16T01:33:10.763

我建议您手动编写解析器，在这种情况下，有大量空白不应出现任何实际问题。

使用解析器生成器的主要问题是很难在解析器中获得良好的错误恢复。如果您计划为您的语言实现 IDE，那么良好的错误恢复对于让 Intellisence 之类的东西正常工作很重要。智能总是在不完整的句法结构上工作，解析器越能弄清楚用户试图输入什么结构，你就能提供更好的智能体验。

如果你编写一个手写的自上而下的解析器，你几乎可以在任何地方实现你想要的任何规则。这使得提供错误恢复变得容易。它还将使您实现重要的空白变得微不足道。您可以简单地将当前缩进级别存储在解析器类中的变量中，并且当您在新行上遇到列位置小于当前缩进级别的标记时，可以停止解析块。此外，您可能会在语法中遇到歧义。大多数广泛使用的“生产”语言都有语法歧义。一个很好的例子是 C# 中的泛型（在表达式上下文中“<”周围存在歧义，它可以是“小于”运算符，也可以是“泛型参数列表”的开头）。在手写解析器中，解决这样的歧义是微不足道的。您可以在需要的地方添加一点不确定性，而对解析器的其余部分影响相对较小，

此外，由于您自己设计语言，您应该假设它的设计将迅速发​​展（对于一些有标准委员会的语言，例如 C++，情况并非如此）。对自动生成的解析器进行更改以处理歧义或改进语言可能需要您对语法进行重大重构，这既烦人又耗时。对手写解析器的更改，尤其是自上而下的解析器，通常是相当本地化的。

我会说解析器生成器只有在以下情况下才是一个不错的选择：

1.  你从来没有打算写一个 IDE，
2.  该语言的语法***非常***简单，或者
3.  您需要一个非常快速的解析器，并且可以接受糟糕的用户体验

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-16T04:52:55.247

如果您以前从未编写过解析器，请从简单的东西开始。解析器非常微妙，如果您从未研究过编程语言的结构，您可能会在编写它们时遇到各种麻烦。

阅读 Aho、Sethi 和 Ullman（被称为“龙之书”）是一个不错的计划。与其他贡献者相反，我说您应该首先使用更简单的解析器生成器，例如 Yacc 和 Bison，并且只有当您因为无法使用该工具做某事而被烧毁时，您才应该继续尝试使用 LL(* ) 像 Antlr 这样的解析器。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-16T05:04:33.503

A context-sensitive language? This one's non-indented: Protium ([http://www.protiumble.com](http://www.protiumble.com))

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-16T00:55:23.477

仅仅因为一种语言使用重要的缩进并不意味着它本质上是上下文相关的。例如，Haskell 使用了重要的缩进，并且（据我所知）它的语法是上下文无关的。

需要上下文相关语法的源代码示例可能是来自 Ruby 的以下代码段：

```
my_essay = << END_STR
This is within the string
END_STR

<< self
  def other_method
    ...
  end
end 
```

另一个例子是 Scala 的 XML 模式：

```
def doSomething() = {
  val xml = <code>def val <tag/> class</code>
  xml
} 
```

作为一般规则，上下文相关语言在任何精确意义上都稍微难以想象，因此不太常见。甚至 Ruby 和 Scala 也*不算数*，因为它们的上下文敏感特性只包含该语言的一小部分。如果我是你，我会根据灵感来制定我的语法，然后再担心以后的解析方法。我想你会发现你想出的任何东西都会自然地与上下文无关，或者非常接近它。

最后一点，如果你*真的*需要上下文相关的解析工具，你可以尝试一些不太严格的正式技术。解析器组合器用于 Scala 的解析。它们有一些烦人的限制（没有词法分析），但它们不是一个坏工具。像 ANTLR 这样的 LL(*) 工具似乎也更擅长表达这种“临时”解析转义。不要尝试将 Yacc 或 Bison 与上下文相关的语法一起使用，它们对于轻松表达这些概念来说太严格了。

# apache-flex - 什么导致 Flash 错误 #2012（无法实例化类）？

> ID：68244
> 
> 赞同：13
> 
> 时间：2008-09-16T00:28:35.507
> 
> 标签：apache-flex, flash, actionscript-3, flexbuilder

我是 ActionScript 3 的新手，遇到了一个问题：

使用 Flex Builder 3，我创建了一个包含几个简单类的项目。如果 A 类中的代码实例化 B 类的对象（B 类在其自己的源文件中），则代码编译正常，但出现以下运行时错误：

> ArgumentError：错误 #2012：无法实例化 B 类。

有人可以解释我做错了什么吗？

**更新：**请在下面查看我自己的答案（由于我尚未注册，我无法将其投票到顶部）。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-09-16T02:58:42.993

我终于意识到出了什么问题：B 类是 DisplayObject 的子类，我现在看到它是一个抽象类。B 类没有实现抽象成员，因此出现错误。我可能会将 B 类更改为 Sprite 的子类。

这似乎是编译器应该发现的问题。这并不意味着抽象成员的实现可以等到运行时吗？即使是这样，至少得到一个编译器警告会很好。

感谢大家的回答，希望他们能帮助其他遇到错误 2012 的人。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-16T00:44:12.537

这通常意味着类信息不包含在 SWF 中。

确保您正在导入该类，并且在某处有对它的引用（因此编译器会将其包含在 SWF 中）。

顺便说一句，这里是运行时错误代码：

[http://livedocs.adobe.com/flex/201/langref/runtimeErrors.html](http://livedocs.adobe.com/flex/201/langref/runtimeErrors.html)

（虽然没有太多有用的信息）

迈克室

网格@adobe.com

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-16T01:07:43.087

值得注意的是，如果您包含其他人构建的类，并且他们使用 Flash CS3 而您使用的是 Flex，或者反之亦然，那么每个类的核心库是不同的，并且有些东西不包含在两者中。查看两个参考文档以确保：

CS3： http: [//livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/)

弹性： http: [//livedocs.adobe.com/flex/2/langref/](http://livedocs.adobe.com/flex/2/langref/)

# c - 什么是帮助浏览/遵循 C 代码的好工具？

> ID：68247
> 
> 赞同：14
> 
> 时间：2008-09-16T00:30:44.737
> 
> 标签：c, browser, code-search-engine

我有时需要修改 OSS 代码或其他人的代码（通常是基于 C 的，但有时是 C++/Java）并发现自己在遵循代码流并尝试理解系统时“grep”类型、函数声明等的标头. 是否存在有助于代码浏览的好工具。我希望能够单击一个类型并被带到声明中，或者单击一个函数名并被带到它的实现中。我在一个 linux 机器上，所以像“只使用 Visual Studio”这样的回复不一定对我有用。谢谢！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-09-16T00:31:42.143

您无法得到比[SourceInsight](http://www.sourceinsight.com)更好的东西。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-09-16T00:34:12.967

我将[Vim](http://www.vim.org)与[ctags](http://ctags.sourceforge.net/)和[taglist](http://www.vim.org/scripts/script.php?script_id=273)插件一起使用。您可以将光标移动到变量名上，并使用组合键将您带到变量的声明（并返回）。Taglist 还将在侧栏中显示所有功能、类等的概述。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-09-16T00:42:09.110

[Doxygen](http://www.doxygen.nl/)可以生成一组包含源浏览器的网页。不像 IDE 那样花哨，但它只需要一个 Web 浏览器。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-09-16T00:31:48.027

我听说过关于[OpenGrok](http://opengrok.github.io/OpenGrok/)的惊人事情。我知道我所在单位的另一个团队使用它，他们发现它非常方便。从其网站：

> OpenGrok 是一个快速且可用的源代码搜索和交叉引用引擎。它可以帮助您搜索、交叉引用和导航您的源代码树。它可以理解各种程序文件格式和版本控制历史，如 Mercurial、Git、SCCS、RCS、CVS、Subversion、Teamware、ClearCase、Perforce 和 Bazaar。换句话说，它可以让你深入了解（深入了解）开源，因此得名 OpenGrok。它是用 Java 编写的。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-09-16T00:34:16.303

除了 Java 之外，Eclipse IDE 还能够使用 C/C ++ [。](http://www.eclipse.org/)在 IBM 的 Developer Works 站点上有一篇[关于](http://www.ibm.com/developerworks/opensource/library/os-eclipse-stlcdt/index.html)如何为 C/C++ 开发配置 Eclipse 的文章。

*编辑：*为什么这被否决了？这是一个有效的答案。带有 C/C++ 插件的 Eclipse 将允许问题作者做他想做的事情。我不是唯一一个提出建议的人，但其他人都没有被否决。那么为什么这个被否决了呢？

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-09-16T00:55:53.647

我在内核空间做了一些工作，并不断返回范围。

例如：

$ cd /usr/src/redhat/BUILD/kernel-version

$ cscope -R -p4

```
 Find this C symbol:
   Find this function definition:
   Find functions called by this function:
   Find functions calling this function:
   Find this text string:
   Change this text string:
   Find this egrep pattern:
   Find this file:
   Find files #including this file: 
```

在处理别人的项目时，我通常“生活”在 c-scope 中。我用它用“gvim”（我的 IDE）打开文件，编辑东西，然后退出“返回”到 c-scope，它帮助我保持任务专注。

我相信 cscope 可以配置为与 vim 和 emacs 一起使用，尽管我看到人们也使用其他编辑器。

祝你好运。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-16T00:35:02.963

[Vim](http://www.vim.org)和[Ctags](http://ctags.sourceforge.net/)适合我。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-16T03:22:09.287

ctags 非常有用。涉及两个步骤。首先在所有源代码和包含目录上运行程序 ctags。这会在本地目录中创建一个名为“tags”的文件。如果您的所有源代码都在一个目录中，ctags *.c *.h 就可以了。当您在多个目录中使用源代码时，值得在多个位置运行 ctags。然后，在 vi 中，将光标放在任何函数、定义的类型或变量上，使用 ctl-] 转到该实体的定义。如果您使用 emacs，请使用 etags。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-07T02:44:56.313

选择 Doxygen 并将 EXTRACT_ALL 设置为 YES。它简单而强大。一旦你喜欢它，你就可以在所有平台和语言上坚持下去。

[http://www.doxygen.org](http://www.doxygen.org)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-16T15:23:24.670

多氧是美妙的。我必须处理几个我以前从未参与过的遗留代码库，这真是太棒了（即使代码库没有使用 Doxygen 格式记录）。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-09-16T07:38:29.653

我支持使用[doxygen](http://www.doxygen.nl/)。

这个工具生成了一个类似 html 页面的 javadoc，允许索引所有代码，在其中浏览（这个函数在哪里使用，以及由哪个函数......），就像你可以在 IDE 中做的那样。让它工作很容易。

我曾经维护一个 15 年的 C 项目的 2000 个 C 代码文件。我花了一个小时用 doxygen 索引代码，并为其他开发人员提供生成的文档。（我知道，这句话听上去像是加法，但确实是这样……真是个不错的工具）

一个很棒的工具，适用于所有类 C 语言。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-09-16T00:34:56.943

如果您正在寻找简单且无处不在的东西，请尝试[etags](http://www.linuxjournal.com/article/153)。它不会像重量级工具那样好，但它几乎适用于所有东西，并且可以与 emacs 一起使用。对 vi 使用 ctags。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2011-04-28T11:11:32.207

如果您参与的项目混合了 HLL 代码和 Assembly，我会推荐 Opengrok，我最近转移到 Opengrok 并发现它很棒，在我看来，Opengrok + Firefox + Extensions 是最好的组合，一些 firefox 扩展像剪贴簿等允许您在浏览代码时修改和添加注释，这主要是为了通过代码“浏览”而不是动态修改它。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-16T02:17:43.497

cscope一直是我的最爱。也有cbrowser，但我没试过。ctags 也用的很多。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-08-22T20:48:59.053

可以在[SD Source Code Search Engine](http://www.semanticdesigns.com/Products/SearchEngine)找到对语言敏感的源代码搜索引擎。它可以同时处理多种语言。可以对特定语言的模式或跨语言的模式执行搜索（例如“查找涉及 TAX 的标识符”）。通过对语言标记敏感，可以减少误报的数量，从而为用户节省时间。它理解 C、C++、C#、COBOL、Java、ECMAScript、Java、XML、Verilog、VHDL 和许多其他语言。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-09-16T00:37:06.483

我没有直接使用它，但我使用过用[lxr](http://sourceforge.net/projects/lxr)创建的网站，并认为它非常方便。它使用指向交叉引用函数和文件名的链接将您的项目转换为行号和交叉引用的 HTML 文件。[这里](http://lxr.linux.no/)有一些用它索引的项目源示例。

似乎没有比 2006 年更新的版本，但它仍然可以满足您的需求。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-09-16T00:40:07.023

我使用 Anjuta IDE。不错。不确定它与 Eclipse IDE 相比如何。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-09-16T00:46:21.237

任何 IDE 都可以正常工作。Netbeans 和 Eclipse 基于 java，但有 C/C++ 插件

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-11-04T07:11:14.083

[我从这里](http://sourcenav.sourceforge.net/)使用 Source-Navigator(TM) 。这是相当令人印象深刻的，并有很大帮助。它是用 Tcl/Tk 编写的，可作为 Windows 的可执行文件和可在 *nix 上构建的源代码。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2008-09-16T10:22:05.360

我使用 doxygen 取得了巨大的成功。为了获得最佳结果（特别是在为 c++ 创建文档时）安装 graphviz 并在您的 doxygen 配置文件中启用。

这将自动生成链接到 html 文档的其余部分的依赖关系图和类图。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2008-09-16T10:24:43.500

即使您不是开发人员，也可以选择[**Source Insight**](http://www.sourceinsight.com/)

如果你是，它是必须的:)

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2009-04-01T00:09:30.683

我发现[ID Utils](http://www.gnu.org/software/idutils/)非常方便。它就像一个即时递归 grep。有一堆 vim 食谱可以搭配它。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2008-09-16T00:35:16.473

IntelliJ 作为 Linux 下的源代码浏览器相当不错。它对在源和函数声明之间跳转提供了很好的支持。没有用 C/C++ 代码尝试过，但它适用于 Ruby 和 Java。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2008-09-16T01:02:42.257

我使用 kscope，它在后台使用 cscope，但也提供函数列表等。似乎也能很好地处理像 linux 内核这样的大型项目。[kscope 主页](http://kscope.sourceforge.net/)对它做什么和不做什么有一个很好的简明描述。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2008-09-16T07:48:11.767

我使用[对 C++ 的理解](http://www.scitools.com/products/understand/)。它是处理大量代码的非常方便的工具。它还可以计算代码统计和绘制调用图。一定有！

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2008-09-17T00:38:24.477

示波器。（想修改其他范围的帖子，但我还没有业力）。

*   全局搜索和替换
*   查找调用函数的所有位置
*   查找函数调用的所有位置
*   查找包含此文件的文件。

非常简单的用法：$ cscope -R

如果您不知道 vi，请将您的 EDITOR 和 VIEWER 环境变量更改为您喜欢的编辑器。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2009-05-07T17:16:21.520

我使用并喜欢免费软件工具[GNU global](http://www.gnu.org/software/global/)。

# python - 为什么需要在 Python 方法中显式使用“self”参数？

> ID：68282
> 
> 赞同：213
> 
> 时间：2008-09-16T00:39:55.150
> 
> 标签：python, oop, methods, self

在 Python 中为类定义方法时，它看起来像这样：

```
class MyClass(object):
    def __init__(self, x, y):
        self.x = x
        self.y = y 
```

但在其他一些语言中，例如 C#，您可以使用“this”关键字引用该方法绑定到的对象，而无需在方法原型中将其声明为参数。

这是 Python 中有意的语言设计决定，还是有一些实现细节需要将“self”作为参数传递？

* * *

## 回答 #1

> 赞同：95
> 
> 时间：2008-09-16T00:47:55.133

我喜欢引用 Peters 的 Python Zen。“显式胜于隐式。”

在 Java 和 C++ 中，`this.`可以推导出 ' '，除非您的变量名称无法进行推导。所以你有时需要它，有时不需要。

Python 选择使这样的事情变得明确而不是基于规则。

此外，由于没有任何暗示或假设，因此公开了部分实现。 `self.__class__`，`self.__dict__`并且其他“内部”结构以明显的方式可用。

* * *

## 回答 #2

> 赞同：69
> 
> 时间：2008-09-16T00:47:18.487

这是为了尽量减少方法和功能之间的差异。它允许您轻松地在元类中生成方法，或在运行时将方法添加到预先存在的类中。

例如

```
>>> class C:
...     def foo(self):
...         print("Hi!")
...
>>>
>>> def bar(self):
...     print("Bork bork bork!")
...
>>>
>>> c = C()
>>> C.bar = bar
>>> c.bar()
Bork bork bork!
>>> c.foo()
Hi!
>>> 
```

它还（据我所知）使 python 运行时的实现更容易。

* * *

## 回答 #3

> 赞同：57
> 
> 时间：2008-11-21T06:28:26.760

我建议人们应该阅读[Guido van Rossum](http://neopythonic.blogspot.com/)关于这个主题的博客 -[为什么明确的自我必须留下](http://neopythonic.blogspot.com/2008/10/why-explicit-self-has-to-stay.html)。

> 当一个方法定义被装饰时，我们不知道是否自动给它一个'self'参数：装饰器可以把函数变成一个静态方法（它没有'self'），或者一个类方法（它有一种有趣的 self 指的是一个类而不是一个实例），或者它可以做一些完全不同的事情（在纯 Python 中编写一个实现 '@classmethod' 或 '@staticmethod' 的装饰器是微不足道的）。没有办法不知道装饰器做什么，是否赋予被定义的方法一个隐式的“自我”参数。
> 
> 我拒绝像特殊外壳'@classmethod'和'@staticmethod'这样的黑客攻击。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2008-09-16T01:15:16.377

Python 不会强迫你使用“self”。你可以给它任何你想要的名字。您只需要记住方法定义标头中的第一个参数是对对象的引用。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2015-07-12T11:18:06.863

还允许您这样做：（简而言之，调用`Outer(3).create_inner_class(4)().weird_sum_with_closure_scope(5)`将返回 12，但会以最疯狂的方式这样做。

```
class Outer(object):
    def __init__(self, outer_num):
        self.outer_num = outer_num

    def create_inner_class(outer_self, inner_arg):
        class Inner(object):
            inner_arg = inner_arg
            def weird_sum_with_closure_scope(inner_self, num)
                return num + outer_self.outer_num + inner_arg
        return Inner 
```

当然，这在 Java 和 C# 等语言中是难以想象的。通过使自引用显式，您可以自由地通过该自引用引用任何对象。此外，在运行时使用类的这种方式在更静态的语言中更难做到——这不一定是好或坏。只是明确的自我允许所有这些疯狂存在。

此外，想象一下：我们想要自定义方法的行为（用于分析，或一些疯狂的黑魔法）。这可以让我们思考：如果我们有一个`Method`可以覆盖或控制其行为的类怎么办？

那么这里是：

```
from functools import partial

class MagicMethod(object):
    """Does black magic when called"""
    def __get__(self, obj, obj_type):
        # This binds the <other> class instance to the <innocent_self> parameter
        # of the method MagicMethod.invoke
        return partial(self.invoke, obj)

    def invoke(magic_self, innocent_self, *args, **kwargs):
        # do black magic here
        ...
        print magic_self, innocent_self, args, kwargs

class InnocentClass(object):
    magic_method = MagicMethod() 
```

现在：`InnocentClass().magic_method()`将像预期的那样行事。该方法将与`innocent_self`参数绑定到`InnocentClass`，并与`magic_self`MagicMethod 实例绑定。很奇怪吧？这就像有 2 个关键字`this1`和`this2`Java 和 C# 等语言。像这样的魔法允许框架做一些原本会更冗长的事情。

同样，我不想评论这些东西的道德规范。我只是想展示如果没有明确的自我引用会更难做的事情。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2015-03-31T13:29:09.163

我认为这与 PEP 227 有关：

> 类范围内的名称不可访问。名称在最里面的封闭函数范围内解析。如果类定义出现在嵌套范围链中，则解析过程会跳过类定义。此规则防止类属性和局部变量访问之间的奇怪交互。如果在类定义中发生名称绑定操作，它会在生成的类对象上创建一个属性。要在方法中或嵌套在方法中的函数中访问此变量，必须使用属性引用，通过 self 或通过类名。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2016-05-01T16:01:06.157

我认为除了“Python 之禅”之外的真正原因是函数是 Python 中的一等公民。

这基本上使它们成为一个对象。现在的基本问题是，如果您的函数也是对象，那么在面向对象的范例中，当消息本身是对象时，您将如何向对象发送消息？

看起来像鸡蛋问题，为了减少这种悖论，唯一可能的方法是将执行上下文传递给方法或检测它。但是由于 python 可以具有嵌套函数，因此不可能这样做，因为内部函数的执行上下文会发生变化。

这意味着唯一可能的解决方案是显式传递“自我”（执行的上下文）。

所以我相信这是一个实现问题，Zen 来得太晚了。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-02-04T05:52:03.703

# 正如[Python 中的 self 所解释的那样，揭秘](https://www.programiz.com/article/python-self-why)

> 像 obj.meth(args) 这样的任何东西都会变成 Class.meth(obj, args)。调用过程是自动的，而接收过程不是（其显式的）。这就是类中函数的第一个参数必须是对象本身的原因。

```
class Point(object):
    def __init__(self,x = 0,y = 0):
        self.x = x
        self.y = y

    def distance(self):
        """Find distance from origin"""
        return (self.x**2 + self.y**2) ** 0.5 
```

调用：

```
>>> p1 = Point(6,8)
>>> p1.distance()
10.0 
```

**init** () 定义了三个参数，但我们只传递了两个（6 和 8）。同样 distance() 需要一个但零个参数被传递。

为什么 Python 不抱怨**这个参数编号不匹配**？

> 通常，当我们调用带有一些参数的方法时，通过将方法的对象放在第一个参数之前来调用相应的类函数。所以，像 obj.meth(args) 这样的东西就变成了 Class.meth(obj, args)。**调用过程是自动的，而接收过程不是（其显式的）。**
> 
> **这就是类中函数的第一个参数必须是对象本身的原因。将此参数写为 self 只是一种约定**。它不是关键字，在 Python 中没有特殊含义。我们可以使用其他名称（例如这样），但我强烈建议您不要这样做。大多数开发人员不赞成使用 self 以外的名称，这会降低代码的可读性（“可读性很重要”）。
> ...
> 在第一个示例中，self.x 是实例属性，而 x 是局部变量。它们不相同并且位于不同的命名空间中。

> ## 自我在这里留下
> 
> 许多人建议**在 Python 中将 self 作为关键字，就像在 C++ 和 Java 中一样。这将消除方法中形式参数列表中显式 self 的冗余使用。**虽然这个想法看起来很有希望，但它不会发生。至少在不久的将来不会。**主要原因是向后兼容**。这是 Python 的创建者自己写的一篇博客，解释了为什么显式的 self 必须保留。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-08-19T07:01:27.260

'self' 参数保留当前调用对象。

```
class class_name:
    class_variable
    def method_name(self,arg):
        self.var=arg 
obj=class_name()
obj.method_name() 
```

这里，self 参数包含对象 obj。因此，语句 self.var 表示 obj.var

* * *

## 回答 #10

> 赞同：-5
> 
> 时间：2008-09-16T00:49:26.970

还有一个非常简单的答案：根据[python 的禅宗](http://www.python.org/dev/peps/pep-0020/)，“显式胜于隐式”。

# c# - 查看/编辑 MP3 文件的 ID3 数据

> ID：68283
> 
> 赞同：154
> 
> 时间：2008-09-16T00:40:03.373
> 
> 标签：c#, .net, mp3, id3

使用 C# 查看和编辑 ID3 标签（艺术家、专辑等）的快速简便的方法是什么？

* * *

## 回答 #1

> 赞同：189
> 
> 时间：2008-11-11T16:34:53.380

第三个[TagLib Sharp](https://github.com/mono/taglib-sharp)。

```
TagLib.File f = TagLib.File.Create(path);
f.Tag.Album = "New Album Title";
f.Save(); 
```

* * *

## 回答 #2

> 赞同：65
> 
> 时间：2008-09-16T01:03:15.157

[TagLib Sharp](http://www.novell.com/products/linuxpackages/opensuse11.1/taglib-sharp.html)非常受欢迎。

作为旁注，如果您想快速而肮脏地看一下自己做的事情..这是我发现的一个 C# 片段，用于读取 mp3 的标签信息。

```
class MusicID3Tag

{

    public byte[] TAGID = new byte[3];      //  3
    public byte[] Title = new byte[30];     //  30
    public byte[] Artist = new byte[30];    //  30 
    public byte[] Album = new byte[30];     //  30 
    public byte[] Year = new byte[4];       //  4 
    public byte[] Comment = new byte[30];   //  30 
    public byte[] Genre = new byte[1];      //  1

}

string filePath = @"C:\Documents and Settings\All Users\Documents\My Music\Sample Music\041105.mp3";

        using (FileStream fs = File.OpenRead(filePath))
        {
            if (fs.Length >= 128)
            {
                MusicID3Tag tag = new MusicID3Tag();
                fs.Seek(-128, SeekOrigin.End);
                fs.Read(tag.TAGID, 0, tag.TAGID.Length);
                fs.Read(tag.Title, 0, tag.Title.Length);
                fs.Read(tag.Artist, 0, tag.Artist.Length);
                fs.Read(tag.Album, 0, tag.Album.Length);
                fs.Read(tag.Year, 0, tag.Year.Length);
                fs.Read(tag.Comment, 0, tag.Comment.Length);
                fs.Read(tag.Genre, 0, tag.Genre.Length);
                string theTAGID = Encoding.Default.GetString(tag.TAGID);

                if (theTAGID.Equals("TAG"))
                {
                    string Title = Encoding.Default.GetString(tag.Title);
                    string Artist = Encoding.Default.GetString(tag.Artist);
                    string Album = Encoding.Default.GetString(tag.Album);
                    string Year = Encoding.Default.GetString(tag.Year);
                    string Comment = Encoding.Default.GetString(tag.Comment);
                    string Genre = Encoding.Default.GetString(tag.Genre);

                    Console.WriteLine(Title);
                    Console.WriteLine(Artist);
                    Console.WriteLine(Album);
                    Console.WriteLine(Year);
                    Console.WriteLine(Comment);
                    Console.WriteLine(Genre);
                    Console.WriteLine();
                }
            }
        } 
```

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2008-11-11T16:26:26.097

~~[UltraID3Lib](http://UltraID3Lib.com) ...~~

请注意，UltraID3Lib 不再正式可用，因此不再维护。请参阅下面的评论以获取包含此库的 Github 项目的链接

```
//using HundredMilesSoftware.UltraID3Lib;
UltraID3 u = new UltraID3();
u.Read(@"C:\mp3\song.mp3");
//view
Console.WriteLine(u.Artist);
//edit
u.Artist = "New Artist";
u.Write(); 
```

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2008-09-16T00:44:21.380

[TagLib Sharp](http://www.novell.com/products/linuxpackages/opensuse11.1/taglib-sharp.html)支持读取 ID3 标签。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-08-24T19:43:16.853

我包装了 mp3 解码器库，并将其提供给 .net 开发人员。你可以在这里找到它：

[http://sourceforge.net/projects/mpg123net/](http://sourceforge.net/projects/mpg123net/)

包括将 mp3 文件转换为 PCM 和读取 ID3 标签的示例。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-10-18T20:23:05.900

[ID3.NET](http://id3.codeplex.com/)实现了 ID3v1.x 和 ID3v2.3 并支持对 MP3 文件中 ID3 部分的读/写操作。还有一个[NuGet 包](https://www.nuget.org/packages/ID3/)可用。

# algorithm - 在新闻网站上进行 A/B 测试以提高相关性

> ID：68291
> 
> 赞同：1
> 
> 时间：2008-09-16T00:41:48.737
> 
> 标签：algorithm, testing

如果您正在运行一个创建了 10 个热门新闻故事列表的新闻网站，并且您想对您的算法进行调整，看看人们是否更喜欢新的热门故事组合，您将如何处理？

简单点击登录与帖子条目关联的数据库？

A/B 测试在哪里您将向 A 组显示算法的一个版本，向 B 组显示另一个版本并测量点击次数？

你会根据什么样的特征来决定这些变化是否更好？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-17T02:27:29.847

除了监控点击次数之外，监控他们查看他们点击的故事的时间也可能会有所帮助。它是更复杂的数据，但提供了另一个层次的信息。然后，您不仅会看到您挑选的故事是否吸引了用户的注意力，而且还会看到这些故事能够留住用户的注意力。

您可以进行统计分析（即像 Tim 建议的 T 检验），但您可能不会在任一度量上获得足够低的标准偏差来证明显着性。不过，这并不重要：您所需要的只是让其中一种算法具有更高的平均点击次数和/或花费的时间。希望没有必要胡乱进行假设检验。

当然，总是可以选择简单地询问用户推荐是否相关，但这可能不适合您的情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-16T01:11:38.430

A/B 测试似乎是一个好的开始，并且随机分配参与者。你必须记住它们，这样它们就永远不会同时看到它们。

您可以将其视为行为心理学实验，进行 T 检验等...

# java - Ubuntu 中的良好 Java 实践

> ID：68298
> 
> 赞同：5
> 
> 时间：2008-09-16T00:43:08.450
> 
> 标签：java, linux, ubuntu

大家好，我这学期的计算科学课程完全是用 Java 完成的。我想知道是否有一套好的/首选的工具可以在 ubuntu 中使用。目前我使用 gedit 和在底部运行的终端，但我想要一个 API 浏览器。

我考虑过 Eclipse，但对于快速程序来说，它似乎臃肿且不友好。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-16T00:49:37.763

Java 编辑倾向于采用两种方式之一；人们要么坚持使用简单的编辑器并使用终端来编译/运行他们的程序，要么他们使用具有无数功能的大型 IDE。

我通常走简单的路线，只使用纯文本编辑器和终端，但对于 IDE，还有很多话要说。在学习语言时尤其如此，因为遇到“垃圾邮件”。显示垃圾邮件对象的所有字段和方法的下拉列表。这不仅对初学者有用；以后在使用不熟悉的库和第三方模块时，它仍然很有用。

IDE 还具有有用的工具，例如 GUI 构建器，这些工具在进行专业 Java 工作时变得非常宝贵。因此，尽管我通常更喜欢简单的编辑器/终端组合，但我强烈建议您试用 Eclipse 或 Netbeans 等 IDE，看看您是否喜欢它，以便您以后知道如何使用它。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-16T12:28:29.317

Eclipse 可能因学习需要而臃肿，但可能会为您提供最佳的整体 Java 体验。如果您发现界面令人困惑，请尝试阅读一些内置教程。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-18T13:55:13.927

我也支持eclipse（或者IDEA，如果你有钱，实际上IDEA比eclipse好一点）。

但是，请确保您首先知道如何在没有 IDE 的情况下进行编译和调试，并且还要学习阅读编译器的警告/错误消息 - 对于使用 IDE 会妨碍您学习的开发人员来说，这些是必不可少的技能。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-16T00:47:08.753

[Eclipse](http://eclipse.org)和[NetBeans](http://netbeans.org)都是不错的选择。如果您不介意花一点钱，那么[IntelliJ IDEA](http://jetbrains.org)也是如此（学术许可证费用为 99 美元）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-16T00:56:05.720

就 IDE 而言，我发现 Eclipse 是您所要求的最好的。如果你习惯了像 VS 这样的充满特性的 IDE，它应该就在你的小巷里，而且它不是特别需要资源；它组织您的项目的方式也使整个事情变得非常简单，并且在您的简历中也很好。如果您正在寻找一种非侵入式 IDE，主要是直观的，并且可以作为一个出色的助手完成工作，请选择 Eclipse。更不用说它的自定义选项了。

另一方面，如果您想要一个更轻量级的 IDE，textPad 风格（为什么？），我推荐[Geany](http://www.geany.org/)；我过去曾使用过它，它具有开始使用该语言的所有基本功能，并且不会被大型 IDE 可以提供的所有功能所淹没。但是我仍然建议您在习惯该语言并需要 IDE 更像是一个助手后立即使用 Eclipse。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-16T00:58:36.387

再次为 Eclipse 投票。特别是，您应该能够从 Ubuntu 中安装它，因为其中一个存储库中有它的软件包（我忘记了具体是哪一个，因为我现在不在我的 Ubuntu 机器上）。如果您使用“Admin”菜单下的 GUI 包管理应用程序，您应该能够找到 Eclipse 和相关包。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-16T01:02:31.103

我实际上只是推荐 Eclipse。一开始它看起来很臃肿，但是一旦你习惯了它，你就可以用它来非常快速地开发代码（因此它是快速学习 Java 的绝佳选择）。

我喜欢的功能：

Control+1 用于错误修复 - 它知道如何修复大多数编译错误 - 只需突出显示代码中的错误（将以红色下划线显示），它会为您提供建议列表。Control+1 选择第一个建议，这几乎总是正确的。

您可以使用此错误修复功能编写使用您尚未编写的方法的代码 - 错误修复将在您调用它的类/接口上创建具有正确参数/名称/可见性等的方法。或者，如果有一个类似名称的方法具有类似的参数，它会提示你在调用它时拼写错误。

重构工具也很棒——您可以突出显示要提取为方法的代码块，它会计算出需要传入哪些变量，以及它应该返回什么（如果有的话）。您可以在字段和方法之间移动变量。您可以更改类/接口/变量名称，它只会在需要的地方更正它们（这比任何一天的搜索和替换都要好）。

你真的不需要知道很多 eclipse 的特性来获得使用它的好处——它会大大加快你的编码速度。我希望我知道如何在大学里使用它。

基本上，我会推荐 Eclipse。节省的编码时间将弥补您在开始项目时必须单击“是”几次。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-16T00:46:40.860

我现在正在成功使用 NetBeans。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-16T00:59:15.137

我通常只使用 vim，但实际上我发现 IDE Geany 非常直观，有很多很好的功能，但并没有被夸大。看看这个。

编辑：我认为 Geany 不适合企业级编程，但对于快速程序，它是我见过的更好的 IDE 之一，特别是如果您像我一样对 NetBeans 或 Eclipse 有过不好的体验。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-18T13:49:14.660

在我们的工作环境中，我们必须使用免费的 Oracle JDeveloper ...*叹息*.. 在家里我倾向于更多地使用 Eclipse，我真的很喜欢它

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-11-14T10:24:06.053

和其他许多人一样，我建议您使用 Eclipse。它在 linux 中运行良好，几天后你会发现它并不那么不友好。

此外，如果您开始使用 java 开发更复杂的程序，您已经熟悉了一个标准、完整和开源的 IDE，这也是许多其他语言的专业 IDE 的基础，如 Adob​​e Flex Builder、Aptana Red Rails等等。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-20T08:28:53.420

有一个专门为学习而设计的交互式“IDE”：BlueJ，位于[http://www.bluej.org/](http://www.bluej.org/)

虽然我普遍同意 Eclipse、NetBeans 或其他 IDE 可能非常有用，但它们对于学习环境来说是相当重量级的；您最终可能会花时间与 IDE 搏斗，而不是学习 Java。

在我的职业生涯中，我还发现有些人并不真正了解 IDE 为他们做了什么。没有它，他们完全迷失了（参见[Voodoo 编程](http://catb.org/jargon/html/V/voodoo-programming.html)）。我建议您至少花一些时间使用简单的编辑器，例如 gedit 或[vim](http://www.vim.org/ "喜欢那个vim！")以及命令行 javac 编译器。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-06-24T12:08:16.337

Netbeans 是一个沉重但很好的 IDE。Netbeans 总是有很多你并不真正需要的特性，但是因为它是用 netbeans 平台制作的，你总是可以把它精简到基本的！

如果您不喜欢所有的工作，请使用 eclipse。这是一个更轻量级的 IDE。

Geany 非常方便，不太了解 Java 编程如何，但对于 C 和 C++ 编程，它是一个不错的轻量级 IDE。（警告：在 geany 中构建大型项目通常会失败。解决方法：在终端中编译 Geany 构建）

*   布莱恩

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-06-24T14:00:03.727

[BlueJ](http://www.bluej.org/)被认为是一个很好的 Java 编辑器，主要针对初学者。它不像 Eclipse 那样臃肿，但包含许多有用的特性。它也是一个开源项目，因此欢迎您尝试一下。

# windows - 在 Windows Vista 上以管理员身份运行快捷方式时，如何在不同的目录中启动快捷方式？

> ID：68307
> 
> 赞同：8
> 
> 时间：2008-09-16T00:44:21.473
> 
> 标签：windows, windows-vista, uac, shortcuts, cmd

我的桌面上有一个快捷方式，可以打开一个带有许多我需要的参数的命令提示符。我将“开始于”字段设置为 d:\，它按预期工作（提示从 d: 开始）。当我选择高级 -> 以管理员身份运行然后打开快捷方式时，它会在 C:\Windows\System32 中启动，即使我没有更改“开始于”字段。我怎样才能让它在 d:\ 中启动？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-16T01:20:22.963

如果使用 /k 参数，则可以添加一行来执行更改驱动器和更改目录。例如：

`C:\Windows\System32\cmd.exe /k "d: & cd d:\storage"`

使用`&`您可以在一行中将许多命令串在一起。

编辑：您也可以单独使用 cd 命令更改驱动器`"cd /d d:\storage"`。感谢亚当米茨的评论。

# css - 有没有人有适用于大多数手机/设备的移动 CSS 模板的好资源？

> ID：68312
> 
> 赞同：6
> 
> 时间：2008-09-16T00:46:13.950
> 
> 标签：css, templates, mobile

越来越多的移动设备正在使用我的电子商务网站上的内容。iPhone、黑莓、PSP、Windows Mobile 等，我需要一些想法，如何使用这些设备的 CSS 模板处理我的数据的再利用。任何想法都会很棒。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-16T01:48:29.387

[我建议您在http://mobile.delta.com](http://mobile.delta.com)上查看 Delta Airlines 如何使用 CSS 。他们从一家名为 MShift 的公司那里获得帮助，该公司从事大量移动银行业务（显然，必须在许多不同的设备上工作）。

[您可以通过https://my.mshift.com/deltacss.css](https://my.mshift.com/deltacss.css)从 Delta 网站使用的样式表中获得一些灵感。

[最后，在http://www.mshift.com/demo.html](http://www.mshift.com/demo.html)上有一长串来自 MShift 的演示移动站点。

FWIW，我与 Delta 或 MShift 没有任何关联，我只是欣赏他们的移动 UI。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-16T14:44:00.490

我有一个 PSP，它有一个基于 WebKit 的浏览器（谷歌 Chrome 和 Safari 也使用 WebKit 引擎），所以任何在 Safari/Chrome 上运行良好的网站都可以在 PSP 上运行良好。但是，PSP 有 480×272 的分辨率，所以如果你想以 PSP 平台为目标，你必须牢记这个小分辨率。

您可能会发现这些资源很有趣：

1.  IEMobile 博客 - [http://www.microsoft.com/windowsmobile/en-us/downloads/microsoft/internet-explorer-mobile.mspx](http://www.microsoft.com/windowsmobile/en-us/downloads/microsoft/internet-explorer-mobile.mspx)
2.  索尼 PSP 的网页设计 - [http://www.brothercake.com/site/resources/reference/psp/](http://www.brothercake.com/site/resources/reference/psp/)
3.  iPhone 的网络开发 - [http://www.evotech.net/blog/2007/07/web-development-for-the-iphone/](http://www.evotech.net/blog/2007/07/web-development-for-the-iphone/)

所以一般来说，如果你想定位移动设备，你必须确保你的电子商务网站在小分辨率下工作正常，它不使用 activeX（因为它不能在 iPhone Safari、Opera Mini 和 PSP 浏览器上工作）等。保持简单:)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-16T18:13:15.463

[WURFL](http://wurfl.sourceforge.net)是处理特定设备浏览器属性（包括 CSS）的最佳开放资源。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-16T02:31:15.447

我会说尽可能简单。手机上的互联网可以是 3g/wifi，也可以是您可以想象的慢速。如果您的目标是触摸设备，我会保持测试较大，以便更容易阅读，并且链接易于点击。我也会对图像说不，除非它们是 1kb 或更少。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-03-08T08:47:30.053

I don´t forget [Nokia Mobile Web Template](http://www.forum.nokia.com/Technology_Topics/Web_Technologies/Browsing/Web_Templates/). It is bigger phone vendor.

# sql - 实现软删除的最佳方法是什么？

> ID：68323
> 
> 赞同：56
> 
> 时间：2008-09-16T00:47:54.557
> 
> 标签：sql, database, database-design, backup

目前正在处理一个项目，我们必须为大多数用户（用户角色）实施软删除。我们决定`is_deleted='0'`在数据库中的每个表上添加一个字段，并将其设置为`'1'`如果特定用户角色在特定记录上点击了删除按钮。

对于现在的未来维护，每个`SELECT`查询都需要确保它们不包含记录`where is_deleted='1'`。

是否有更好的解决方案来实现软删除？

更新：我还应该注意到，我们有一个审计数据库，它跟踪应用程序数据库中所有表/字段的更改（字段、旧值、新值、时间、用户、ip）。

* * *

## 回答 #1

> 赞同：101
> 
> 时间：2008-09-16T00:50:42.990

我倾向于`deleted_at`包含**删除发生日期时间的**列。然后你会得到一些关于删除的免费元数据。对于你`SELECT`刚刚得到的行`WHERE deleted_at IS NULL`

* * *

## 回答 #2

> 赞同：54
> 
> 时间：2008-09-16T00:49:19.310

您可以针对包含该`WHERE IS_DELETED='0'`子句的视图执行所有查询。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2008-09-16T01:01:14.727

拥有`is_deleted`列是一种相当不错的方法。如果它在 Oracle 中，为了进一步提高性能，我建议通过在`is_deleted`列上创建列表分区来对表进行分区。然后已删除和未删除的行将物理上位于不同的分区中，尽管对您来说它将是透明的。

因此，如果您键入类似的查询

```
SELECT * FROM table_name WHERE is_deleted = 1 
```

然后 Oracle 将执行“分区修剪”并仅查看适当的分区。在内部，一个分区是一个不同的表，但它对作为用户的您来说是透明的：无论它是否已分区，您都可以在整个表中进行选择。但是 Oracle 将能够只查询**它需要的分区**。例如，假设您有 1000 行`is_deleted = 0`和 100000 行`is_deleted = 1`，并且您在 上对表进行分区`is_deleted`。现在，如果您包括条件

```
WHERE ... AND IS_DELETED=0 
```

那么 Oracle 将只扫描 1000 行的分区。如果表未分区，则必须扫描 101000 行（两个分区）。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2008-09-16T00:49:49.217

如果表很大并且性能存在问题，您可以随时将“已删除”记录移动到另一个表，其中包含删除时间、删除记录等附加信息

这样您就不必在主表中添加另一列

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2008-09-16T12:47:20.113

遗憾的是，最好的响应取决于您尝试通过软删除来完成什么以及您在其中实现此功能的数据库。

在 SQL Server 中，最好的解决方案是使用类型为 SMALLDATETIME 或 DATETIME（取决于必要的粒度）的 deleted_on/deleted_at 列，并使该列可以为空。在 SQL Server 中，行标题数据包含表中每个列的 NULL 位掩码，因此执行 IS NULL 或 IS NOT NULL 比检查存储在列中的值要快一些。

如果您有大量数据，您将需要考虑通过数据库本身或通过两个单独的表（例如 Products 和 ProductHistory）或通过索引视图对数据进行分区。

我通常会避免使用 is_deleted、is_archive 等标志字段，因为它们只具有一种含义。可为空的 deleted_at、archived_at 字段为您自己和继承您的应用程序的人提供了额外的意义。而且我避免使用像瘟疫这样的位掩码字段，因为它们需要了解位掩码是如何构建的才能理解任何含义。

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2008-09-16T00:57:24.003

这取决于您需要哪些信息以及您想要支持哪些工作流程。

您是否希望能够：

*   知道那里有什么信息（在被删除之前）？
*   知道什么时候删除的吗？
*   知道是谁删的吗？
*   知道他们删除它时以什么身份行事吗？
*   可以取消删除记录吗？
*   能知道它什么时候没有被删除吗？
*   等等

如果记录被删除和取消删除四次，您是否足以知道它当前处于未删除状态，或者您是否希望能够知道在此期间发生了什么（包括连续两次之间的任何编辑）删除！）？

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2011-05-04T14:16:18.183

小心导致违反唯一性约束的软删除记录。如果您的数据库具有具有唯一约束的列，请注意先前软删除的记录不会阻止您重新创建记录。

想想循环：

1.  创建用户（登录=JOE）
2.  软删除（将已删除的列设置为非空。）
3.  （重新）创建用户（登录=JOE）。错误。LOGIN=JOE 已被占用

第二次创建会导致违反约束，因为 login=JOE 已经在软删除的行中。

一些技巧： 1\. 将删除的记录移动到新表中。2\. 在 login 和 deleted_at 时间戳列中设置唯一性约束

我自己的意见是 +1 移动到新表。在所有查询中维护 *AND delete_at = NULL* 需要大量的纪律（对于所有开发人员）

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2008-09-16T00:57:50.757

如果您像 Jim 所说的那样将已删除的数据移动到另一个表中，并记录删除的时间、原因和删除者，您肯定会获得更好的性能。

添加到所有查询中会显着减慢它们的速度，并阻碍使用表上可能拥有的任何索引。尽可能避免在表格中使用“标志”。`where `deleted`=0`

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-09-16T14:15:30.400

您没有提及什么产品，但 SQL Server 2008 和 postgresql（以及我确定的其他产品）允许您创建过滤索引，因此您可以创建一个覆盖索引，其中 is_deleted=0，减轻这种特定方法的一些负面影响.

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-16T05:31:44.153

我在项目中使用的东西是 statusInd tinyint not null default 0 列，使用 statusInd 作为位掩码，允许我执行数据管理（删除、存档、复制、恢复等）。在视图中使用它，我可以为消费应用程序进行数据分发、发布等。如果性能是关于视图的问题，请使用小型事实表来支持此信息，删除事实，删除关系并允许所谓的删除。

可以很好地扩展并且以数据为中心，保持数据占用空间非常小 - 对于 350gb+ dbs 具有实时问题的关键。使用替代品、表、触发器会产生一些开销，具体取决于需要，也可能不适合您。

SOX 相关审核可能需要的不仅仅是一个字段来帮助您解决问题，但这可能会有所帮助。享受

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-16T01:09:30.370

我更喜欢保留一个状态列，所以我可以将它用于几个不同的配置，即发布、私有、删除、需要批准...

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-16T03:25:48.247

使用检查的视图、函数或过程`is_deleted = 0`；即不要直接在表上选择，以防以后由于其他原因需要更改表。

并为更大的表索引`is_deleted`列。

由于您已经有了审计跟踪，因此跟踪删除日期是多余的。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2011-06-27T11:15:50.090

创建另一个架构并将其全部授予您的数据架构。在您的新架构上实施 VPD，以便每个查询都具有允许选择仅附加到它的未删除行的谓词。 [http://download.oracle.com/docs/cd/E11882_01/server.112/e16508/cmntopc.htm#CNCPT62345](http://download.oracle.com/docs/cd/E11882_01/server.112/e16508/cmntopc.htm#CNCPT62345)

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2014-05-21T14:26:36.643

```
@AdditionalCriteria("this.status <> 'deleted'") 
```

把它放在你的上面`@entity`

[http://wiki.eclipse.org/EclipseLink/Examples/JPA/SoftDelete](http://wiki.eclipse.org/EclipseLink/Examples/JPA/SoftDelete)

# python - 在 Python 中更改 Tkinter 按钮的命令方法

> ID：68327
> 
> 赞同：18
> 
> 时间：2008-09-16T00:48:37.410
> 
> 标签：python, user-interface, tkinter

我创建了一个新的 Button 对象，但没有`command`在创建时指定选项。Tkinter 有没有办法在创建对象后更改命令（onclick）功能？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-09-16T01:24:37.087

尽管[Eli Courtwright 的](https://stackoverflow.com/questions/68327/change-command-method-for-tkinter-button-in-python#68455)程序可以正常工作¹，但您真正想要的只是一种在实例化后重新配置您在实例化时可以设置的任何属性的方法²。你如何做到这一点是通过 configure() 方法。

```
from Tkinter import Tk, Button

def goodbye_world():
    print "Goodbye World!\nWait, I changed my mind!"
    button.configure(text = "Hello World!", command=hello_world)

def hello_world():
    print "Hello World!\nWait, I changed my mind!"
    button.configure(text = "Goodbye World!", command=goodbye_world)

root = Tk()
button = Button(root, text="Hello World!", command=hello_world)
button.pack()

root.mainloop() 
```

¹ 如果您只使用鼠标，则“很好”；如果您关心制表符并在按钮上使用 [Space] 或 [Enter]，那么您也必须实现（复制现有代码）按键事件。通过设置`command`选项`.configure`要容易得多。

² 实例化后唯一不能改变的属性是`name`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-16T01:12:22.860

当然; 只需`bind`在创建按钮后使用该方法指定回调即可。我刚刚编写并测试了下面的示例。[您可以在http://www.pythonware.com/library/tkinter/introduction/events-and-bindings.htm](http://www.pythonware.com/library/tkinter/introduction/events-and-bindings.htm)找到一个很好的教程

```
from Tkinter import Tk, Button

root = Tk()
button = Button(root, text="Click Me!")
button.pack()

def callback(event):
    print "Hello World!"

button.bind("<Button-1>", callback)
root.mainloop() 
```

# python - 如何使用 SCP 或 SSH 将文件复制到 Python 中的远程服务器？

> ID：68335
> 
> 赞同：123
> 
> 时间：2008-09-16T00:50:10.837
> 
> 标签：python, ssh, automation, scp

我的本地机器上有一个文本文件，它是由在 cron 中运行的每日 Python 脚本生成的。

我想添加一些代码以将该文件通过 SSH 安全地发送到我的服务器。

* * *

## 回答 #1

> 赞同：167
> 
> 时间：2008-09-16T05:27:59.390

要在 Python 中使用[Paramiko](https://github.com/paramiko/paramiko)库执行此操作（即不通过 subprocess.Popen 或类似方法包装 scp），您可以执行以下操作：

```
import os
import paramiko

ssh = paramiko.SSHClient() 
ssh.load_host_keys(os.path.expanduser(os.path.join("~", ".ssh", "known_hosts")))
ssh.connect(server, username=username, password=password)
sftp = ssh.open_sftp()
sftp.put(localpath, remotepath)
sftp.close()
ssh.close() 
```

（您可能想要处理未知主机、错误、创建任何必要的目录等等）。

* * *

## 回答 #2

> 赞同：64
> 
> 时间：2008-09-16T00:55:43.850

您可以使用以下命令调用[`scp`](https://en.wikipedia.org/wiki/Secure_copy)bash 命令（它通过[SSH](https://en.wikipedia.org/wiki/Secure_Shell)复制文件）[`subprocess.run`](https://docs.python.org/library/subprocess.html#subprocess.run)：

```
import subprocess
subprocess.run(["scp", FILE, "USER@SERVER:PATH"])
#e.g. subprocess.run(["scp", "foo.bar", "joe@srvr.net:/path/to/foo.bar"]) 
```

如果您正在创建要在同一个 Python 程序中发送的文件，您需要在用于打开文件`subprocess.run`的块之外调用命令（如果您不使用块），所以您知道它已从 Python 刷新到磁盘。`with``.close()``with`

您需要预先生成（在源计算机上）并安装（在目标计算机上）一个 ssh 密钥，以便 scp 自动使用您的公共 ssh 密钥进行身份验证（换句话说，因此您的脚本不会要求输入密码） .

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2008-09-16T00:58:49.473

您可能会使用[subprocess 模块](http://docs.python.org/lib/module-subprocess.html)。像这样的东西：

```
import subprocess
p = subprocess.Popen(["scp", myfile, destination])
sts = os.waitpid(p.pid, 0) 
```

`destination`大概是哪里的形式`user@remotehost:remotepath`。感谢@Charles Duffy 指出我原来的答案中的弱点，它使用单个字符串参数来指定 scp 操作`shell=True`- 这不会处理路径中的空格。

模块文档包含[您可能希望与此操作一起执行的错误检查示例。](http://docs.python.org/lib/node536.html)

确保您已设置正确的凭据，以便您可以[在机器之间执行无人值守、无密码的 scp](http://www.debian.org/devel/passwordlessssh)。已经有一个[stackoverflow 问题](https://stackoverflow.com/questions/7260/how-do-i-setup-public-key-authentication)。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2008-09-16T01:32:08.070

有几种不同的方法可以解决这个问题：

1.  包装命令行程序
2.  使用提供 SSH 功能的 Python 库（例如 - [Paramiko](https://www.paramiko.org/)或[Twisted Conch](https://twistedmatrix.com/trac/wiki/TwistedConch)）

每种方法都有自己的怪癖。如果要包装系统命令，如“ssh”、“scp”或“rsync”，则需要设置 SSH 密钥以启用无密码登录。您可以使用 Paramiko 或其他一些库在脚本中嵌入密码，但您可能会发现缺少文档令人沮丧，尤其是如果您不熟悉 SSH 连接的基础知识（例如 - 密钥交换、代理等）。毋庸置疑，对于这类东西，SSH 密钥几乎总是比密码更好。

注意：如果您计划通过 SSH 传输文件，则很难击败 rsync，特别是如果替代方案是普通的旧 scp。

我使用 Paramiko 着眼于替换系统调用，但由于它们易于使用和立即熟悉，我发现自己又回到了包装命令。你可能不一样。前段时间我给了海螺一次，但它对我没有吸引力。

如果选择系统调用路径，Python 会提供一系列选项，例如 os.system 或 commands/subprocess 模块。如果使用 2.4+ 版本，我会使用 subprocess 模块。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2016-07-24T20:12:13.240

达到了同样的问题，但不是“黑客”或模拟命令行：

[在这里](https://pypi.python.org/pypi/scp)找到了这个答案。

```
from paramiko import SSHClient
from scp import SCPClient

ssh = SSHClient()
ssh.load_system_host_keys()
ssh.connect('example.com')

with SCPClient(ssh.get_transport()) as scp:
    scp.put('test.txt', 'test2.txt')
    scp.get('test2.txt') 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2019-07-02T10:16:23.637

您也可以执行类似的操作来处理主机密钥检查

```
import os
os.system("sshpass -p password scp -o StrictHostKeyChecking=no local_file_path username@hostname:remote_path") 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2014-03-28T10:41:18.170

[`fabric`](http://fabfile.org)可用于通过 ssh 上传文件：

```
#!/usr/bin/env python
from fabric.api import execute, put
from fabric.network import disconnect_all

if __name__=="__main__":
    import sys
    # specify hostname to connect to and the remote/local paths
    srcdir, remote_dirname, hostname = sys.argv[1:]
    try:
        s = execute(put, srcdir, remote_dirname, host=hostname)
        print(repr(s))
    finally:
        disconnect_all() 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2017-07-12T01:51:37.600

使用外部资源 paramiko；

```
 from paramiko import SSHClient
    from scp import SCPClient
    import os

    ssh = SSHClient() 
    ssh.load_host_keys(os.path.expanduser(os.path.join("~", ".ssh", "known_hosts")))
    ssh.connect(server, username='username', password='password')
    with SCPClient(ssh.get_transport()) as scp:
            scp.put('test.txt', 'test2.txt') 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2018-11-16T19:47:12.487

您可以使用专为此设计的 vassal 包。

您所需要的只是安装vassal并执行

```
from vassal.terminal import Terminal
shell = Terminal(["scp username@host:/home/foo.txt foo_local.txt"])
shell.run() 
```

此外，它将为您保存身份验证凭据，而无需一次又一次地键入它们。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2018-02-06T02:58:25.743

我使用[sshfs](https://wiki.archlinux.org/index.php/SSHFS)通过 ssh 挂载远程目录，并[使用shutil](https://docs.python.org/3/library/shutil.html)复制文件：

```
$ mkdir ~/sshmount
$ sshfs user@remotehost:/path/to/remote/dst ~/sshmount 
```

然后在python中：

```
import shutil
shutil.copy('a.txt', '~/sshmount') 
```

此方法的优点是，如果您正在生成数据而不是在本地缓存并发送单个大文件，则可以流式传输数据。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2018-11-27T17:32:19.453

如果您不想使用 SSL 证书，请尝试以下操作：

```
import subprocess

try:
    # Set scp and ssh data.
    connUser = 'john'
    connHost = 'my.host.com'
    connPath = '/home/john/'
    connPrivateKey = '/home/user/myKey.pem'

    # Use scp to send file from local to host.
    scp = subprocess.Popen(['scp', '-i', connPrivateKey, 'myFile.txt', '{}@{}:{}'.format(connUser, connHost, connPath)])

except CalledProcessError:
    print('ERROR: Connection to host failed!') 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2014-03-28T10:50:46.607

通过子进程调用`scp`命令不允许在脚本中接收进度报告。`pexpect`可用于提取该信息：

```
import pipes
import re
import pexpect # $ pip install pexpect

def progress(locals):
    # extract percents
    print(int(re.search(br'(\d+)%$', locals['child'].after).group(1)))

command = "scp %s %s" % tuple(map(pipes.quote, [srcfile, destination]))
pexpect.run(command, events={r'\d+%': progress}) 
```

查看[本地网络中的 python 复制文件 (linux -> linux)](https://stackoverflow.com/q/22687296/4279)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2018-01-04T15:40:07.140

一个非常简单的方法如下：

```
import os
os.system('sshpass -p "password" scp user@host:/path/to/file ./') 
```

不需要 python 库（仅 os），它可以工作，但是使用此方法依赖于安装另一个 ssh 客户端。如果在另一个系统上运行，这可能会导致不良行为。

* * *

## 回答 #14

> 赞同：-3
> 
> 时间：2008-09-16T00:56:31.070

有点hacky，但以下应该工作:)

```
import os
filePath = "/foo/bar/baz.py"
serverPath = "/blah/boo/boom.py"
os.system("scp "+filePath+" user@myserver.com:"+serverPath) 
```

# frameworks - 什么级别的复杂性需要一个框架？

> ID：68340
> 
> 赞同：1
> 
> 时间：2008-09-16T00:51:01.710
> 
> 标签：frameworks, complexity-theory

切换到现有的 Web 开发框架的复杂程度是多少？

什么样的复杂性度量对于 Web 开发是实用的？代码长度？功能列表？数据库大小？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-16T00:54:04.570

如果您在几个不同的站点上工作，那么通过在所有站点上使用一个通用框架，您可以花时间处理代码，而不是试图记住什么位于何处以及为什么。

我总是使用某种框架，即使它是你自己的，因为统一性将帮助你构建你的项目。除非它是一页静态 HTML 项目。

然而，没有强制性限制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-16T00:52:45.340

我不认为有一定程度的复杂性需要框架。对我来说，每当我编写一个动态站点时，我都会立即考虑一个框架，如果它可以节省我的时间，我就会使用它（它几乎总是这样，而且我几乎总是这样做）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-16T00:56:07.233

考虑到这个问题可能有问题。许多最复杂的网站不使用任何流行的、预先存在的框架。谷歌有自己的网络服务器和自定义的做事方式，亚马逊也有，可能还有很多其他网站。

如果一个框架使您的任务更容易，或提供附加值，那就去吧。但是，当您获得该框架时，您将被绑定到一个新的依赖项。我开始实质上重新创建 Joel on Software 帖子，因此我将在此处重定向您以了解更多关于向您的代码添加不需要的依赖项的信息：

[http://www.joelonsoftware.com/articles/fog0000000007.html](http://www.joelonsoftware.com/articles/fog0000000007.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-16T00:53:27.303

所有因素都很重要。您应该衡量使用 3rd 方框架可以节省多少时间，并将其与使用其他代码的风险进行比较

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-16T00:53:50.873

从不“强制”。任何框架都不能很好地解决一些问题。当您正在实现的大部分代码已经由相关框架以适合您的特定应用程序的方式实现时，切换到框架是值得建议的。这可以节省您的时间和精力，并且很可能比您编写的新代码更稳定。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-16T00:54:58.360

这真的是两个问题，你意识到。:-) 第一个问题的答案是它从来都不是*强制性*的，但老实说，直接解析 HTML 请求参数从一开始就非常糟糕。我什至不想做一次，所以我倾向于相对较早地使用框架。

至于什么测量是实用的，那么，你担心什么？您列出的所有描述都有价值。在我看来，数据库大小主要对扩展很重要（如果你有一个非常简单的模式，你可以编写一个非常简单的应用程序，即使数据库中有数十万行）。功能列表可能会决定 UI 页面的数量和复杂性，这反过来又有助于规定代码长度。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-16T00:55:57.797

有一些框架可以通过简单的博客、[django](http://www.djangoproject.com)或[RoR](http://www.rubyonrails.org)快速移动到企业全栈应用程序[Zope](http://www.zope.org)。不仅限于嗡嗡声世界，您还拥有 ASP.Net 和 J2EE 等。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-16T00:55:58.327

所有框架和库都是您可以使用的工具。确定哪些可以让您的给定项目的生活更轻松并使用它们。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-16T01:00:58.847

我会说反之亦然。在某些时候，您的项目变得如此庞大，以至于您实际上会因框架的缺点而减慢速度。实际上，对于足够大的项目，您最好开发自己的框架以满足您自己的需求。我曾多次看到人们在他们可以做出的决定或他们可以生产的工作上受到阻碍，因为他们试图做一些框架没有预料到的事情。而做这些框架没有预料到的事情可能会很麻烦。制作自己的框架的好处是它可以随着您的项目而发展，成为您系统的帮助，而不是障碍。

所以，总而言之，小项目应该使用现有的框架。大型项目应该包含自己的框架。

# sql - 在 SQL Server 中实现对称差异？

> ID：68346
> 
> 赞同：1
> 
> 时间：2008-09-16T00:52:53.997
> 
> 标签：sql, sql-server

这是我在工作中一直试图解决的一个问题。我不是数据库专家，所以这可能有点幼稚。很抱歉。

我有一个给定的数据库 D，它已在另一台机器上复制（以一种可能可疑的方式），导致数据库 D'。我的任务是检查数据库 D 和 D' 实际上是否完全相同。

当然，问题是如果他们不是，该怎么做。为此，我的想法是在每个对应的表上运行对称差异并查看差异。

有“大量”表格，所以我不希望手动运行每个对称差异。然后，我如何实现可以在任意表上运行而无需显式枚举列的对称差异“函数”（或存储过程，或任何您想要的）？

这是在 Windows 上运行的，如果你不遵守，你的对冲基金就会爆炸。祝你好运。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-03-28T17:24:45.277

这是解决方案。示例数据来自 SSRS 2008 R2 附带的 ReportServer 数据库，但您可以在任何数据集上使用它：

```
SELECT s.name, s.type 
FROM 
(
    SELECT s1.name, s1.type
    FROM syscolumns s1
    WHERE object_name(s1.id) = 'executionlog2'
    UNION ALL 
    SELECT s2.name, s2.type
    FROM syscolumns s2 
    WHERE object_name(s2.id) = 'executionlog3'
) AS s 
GROUP BY s.name, s.type   
HAVING COUNT(s.name) = 1 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-08T11:31:51.137

你可以通过做这样的事情来实现这一点。

我使用了一个函数将逗号分隔值拆分为一个表来演示。

```
CREATE FUNCTION [dbo].[Split]
(
    @RowData nvarchar(2000),
    @SplitOn nvarchar(5)
)  
RETURNS @RtnValue table 
(
    Id int identity(1,1),
    Data nvarchar(100)
) 
AS  
BEGIN 
    Declare @Cnt int
    Set @Cnt = 1

    While (Charindex(@SplitOn,@RowData)>0)
    Begin
        Insert Into @RtnValue (data)
        Select 
            Data = ltrim(rtrim(Substring(@RowData,1,Charindex(@SplitOn,@RowData)-1)))

        Set @RowData = Substring(@RowData,Charindex(@SplitOn,@RowData)+1,len(@RowData))
        Set @Cnt = @Cnt + 1
    End

    Insert Into @RtnValue (data)
    Select Data = ltrim(rtrim(@RowData))

    Return
END
GO

DECLARE @WB_LIST varchar(1024) = '123,125,764,256,157';
DECLARE @WB_LIST_IN_DB varchar(1024) = '123,125,795,256,157,789';

DECLARE @TABLE_UPDATE_LIST_IN_DB TABLE ( id varchar(20));
DECLARE @TABLE_UPDATE_LIST TABLE ( id varchar(20));

INSERT INTO @TABLE_UPDATE_LIST
SELECT data FROM dbo.Split(@WB_LIST,',');

INSERT INTO @TABLE_UPDATE_LIST_IN_DB
SELECT data FROM dbo.Split(@LIST_IN_DB,',');

SELECT * FROM @TABLE_UPDATE_LIST
EXCEPT
SELECT * FROM @TABLE_UPDATE_LIST_IN_DB
UNION
SELECT * FROM @TABLE_UPDATE_LIST_IN_DB
EXCEPT
SELECT * FROM @TABLE_UPDATE_LIST; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-16T01:00:59.407

我的第一反应是建议以毫不怀疑的方式再次复制到另一台机器。

如果这不是一个选项，也许[Red Gate](http://www.red-gate.com/products/index.htm)提供的一些工具可以满足您的需求。

（我与 Red Gate 没有任何关系，只记得 Joel 在播客中提到他们的工具有多好。）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-30T15:36:03.513

SQL Server 2000 增加了“EXCEPT”关键字，与Oracle的“减号”几乎一模一样

```
SELECT * FROM TBL_A WHERE ...
EXCEPT
SELECT * FROM TBL_B WHERE ... 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-16T01:02:19.327

使用[Red Gate](http://www.red-gate.com/)的 SQL 比较工具。它比较模式，SQL 数据比较工具比较数据。我认为您可以免费试用它们，但如果这是一个反复出现的问题，您不妨购买它们。可能有像这样的开源或免费工具，但你最好只得到这个。

# list - 列表比较

> ID：68352
> 
> 赞同：0
> 
> 时间：2008-09-16T00:53:58.753
> 
> 标签：list, perl

我在面试中使用这个问题，我想知道最好的解决方案是什么。

编写一个 Perl 子程序，它接受*n 个*列表，然后返回 2^ *n* -1 个列表，告诉您哪些项目在哪些列表中；也就是说，哪些项目只在第一个列表、第二个列表、第一个和第二个列表以及所有其他列表组合中。假设*n*相当小（小于 20）。

例如：

```
list_compare([1, 3], [2, 3]);
  => ([1], [2], [3]); 
```

在这里，第一个结果列表给出了仅在列表 1 中的所有项目，第二个结果列表给出了仅在列表 2 中的所有项目，第三个结果列表给出了两个列表中的所有项目。

```
list_compare([1, 3, 5, 7], [2, 3, 6, 7], [4, 5, 6, 7])
  => ([1], [2], [3], [4], [5], [6], [7]) 
```

在这里，第一个列表给出了仅在列表 1 中的所有项目，第二个列表给出了仅在列表 2 中的所有项目，第三个列表给出了列表 1 和 2 中的所有项目，如第一个示例所示。第四个列表给出了仅在列表 3 中的所有项目，第五个列表给出了仅在列表 1 和 3 中的所有项目，第六个列表给出了仅在列表 2 和 3 中的所有项目，第七个列表给出了所有项目在所有 3 个列表中。

我通常将此问题作为*n* = 2 的此问题子集的后续问题。

解决办法是什么？

跟进：列表中的项目是字符串。可能有重复项，但由于它们只是字符串，因此应在输出中压缩重复项。输出列表中项目的顺序无关紧要，列表本身的顺序很重要。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-16T09:33:47.660

您给定的解决方案仍然可以简化很多。

在第一个循环中，您可以使用简单的加法，因为您只使用单个位进行 ORing，并且您可以`$bit`通过迭代索引来缩小范围。在第二个循环中，您可以从索引中减去 1，而不是生成需要删除的不必要的第 0 个输出列表元素`shift`，并且您不必要地迭代 m*n 次（其中 m 是输出列表的数量，n 是唯一元素的数量），迭代唯一元素会将迭代减少到只有 n （这在 m 远大于 n 的典型用例中是一个显着的胜利），*并且*会简化代码。

```
sub list_compare {
    my ( @list ) = @_;
    my %dest;

    for my $i ( 0 .. $#list ) {
        my $bit = 2**$i;
        $dest{$_} += $bit for @{ $list[ $i ] };
    }

    my @output_list;

    for my $val ( keys %dest ) {
        push @{ $output_list[ $dest{ $val } - 1 ] }, $val;
    }

    return \@output_list;
} 
```

还要注意，一旦以这种方式考虑，结果收集过程可以借助[List::Part](http://search.cpan.org/perldoc?List::Part)模块非常简洁地编写：

```
use List::Part;

sub list_compare {
    my ( @list ) = @_;
    my %dest;

    for my $i ( 0 .. $#list ) {
        my $bit = 2**$i;
        $dest{$_} += $bit for @{ $list[ $i ] };
    }

    return [ part { $dest{ $_ } - 1 } keys %dest ];
} 
```

但请注意，这`list_compare`是一个可怕的名字。类似的东西`part_elems_by_membership`会好得多。此外，Ben Tilly 指出的问题中的不精确之处需要纠正。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-16T07:18:43.477

首先，我想指出 nohat 的回答根本行不通。尝试运行它，并查看 Data::Dumper 中的输出以验证这一点。

也就是说，你的问题不是很好。看起来您正在使用集合作为数组。您希望如何处理重复项？你想如何处理复杂的数据结构？你想要元素的顺序是什么？为方便起见，我假设答案是重复的，可以对复杂的数据结构进行字符串化，顺序无关紧要。在这种情况下，以下是一个完全足够的答案：

```
sub list_compare {
  my @lists = @_;

  my @answers;
  for my $list (@lists) {
    my %in_list = map {$_=>1} @$list;
    # We have this list.
    my @more_answers = [keys %in_list];
    for my $answer (@answers) {
      push @more_answers, [grep $in_list{$_}, @$answer];
    }
    push @answers, @more_answers;
  }

  return @answers;
} 
```

如果要调整这些假设，则需要调整代码。例如，不压缩复杂数据结构和不压缩重复数据可以通过以下方式完成：

```
sub list_compare {
  my @lists = @_;

  my @answers;
  for my $list (@lists) {
    my %in_list = map {$_=>1} @$list;
    # We have this list.
    my @more_answers = [@$list];
    for my $answer (@answers) {
      push @more_answers, [grep $in_list{$_}, @$answer];
    }
    push @answers, @more_answers;
  }

  return @answers;
} 
```

然而，这是使用数据结构的字符串化来检查存在于一个中的事物是否存在于另一个中。放松这种情况需要更多的工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-16T01:05:47.430

这是我的解决方案：

构造一个哈希，其键是输入列表中所有元素的并集，值是位字符串，如果元素存在于列表 i 中，则设置*位**i*。位串是使用按位或构造的。然后，通过迭代散列的键来构造输出列表，将键添加到关联的输出列表中。

 *```
sub list_compare {
    my (@lists) = @_;
    my %compare;
    my $bit = 1;
    foreach my $list (@lists) {
        $compare{$_} |= $bit foreach @$list;
        $bit *= 2; # shift over one bit
    }

    my @output_lists;
    foreach my $item (keys %compare) {
        push @{ $output_lists[ $compare{$item} - 1 ] }, $item;
    }

    return \@output_lists;

} 
```

更新以包括亚里士多德建议的反向输出列表生成

# bash - 你最喜欢使用 Bash 的命令行技巧是什么？

> ID：68372
> 
> 赞同：156
> 
> 时间：2008-09-16T00:55:59.653
> 
> 标签：bash, command-line

我们都知道如何使用`<ctrl>-R`反向搜索历史，但你知道`<ctrl>-S`如果你设置了你可以使用前向搜索`stty stop ""`吗？另外，您是否尝试过运行 bind -p 来查看列出的所有键盘快捷键？默认情况下，Mac OS X 上有超过 455 个。

您最喜欢使用 bash 的一个不起眼的技巧、键盘快捷键或 shopt 配置是什么？

* * *

## 回答 #1

> 赞同：156
> 
> 时间：2008-09-16T01:38:33.607

快速重命名/移动带有后缀的文件：
`cp /home/foo/realllylongname.cpp{,-old}`

这扩展为：
`cp /home/foo/realllylongname.cpp /home/foo/realllylongname.cpp-old`

* * *

## 回答 #2

> 赞同：149
> 
> 时间：2008-09-16T01:01:43.710

```
cd - 
```

它是后退按钮的命令行等效项（将您带到您所在的上一个目录）。

* * *

## 回答 #3

> 赞同：135
> 
> 时间：2008-09-16T01:07:26.317

另一个最爱：

```
!! 
```

重复上一个命令。最有用的形式：

```
sudo !! 
```

* * *

## 回答 #4

> 赞同：81
> 
> 时间：2008-09-16T06:17:29.863

我最喜欢的是 '^string^string2'，它采用最后一个命令，用 string2 替换字符串并执行它

```
$ ehco foo bar baz
bash: ehco: command not found
$ ^ehco^echo
foo bar baz 
```

[Bash 命令行历史指南](http://www.catonmat.net/blog/the-definitive-guide-to-bash-command-line-history/)

* * *

## 回答 #5

> 赞同：64
> 
> 时间：2008-09-16T01:06:54.400

改名

例子：

```
$ ls
this_has_text_to_find_1.txt
this_has_text_to_find_2.txt
this_has_text_to_find_3.txt
this_has_text_to_find_4.txt

$ rename 's/text_to_find/been_renamed/' *.txt
$ ls
this_has_been_renamed_1.txt
this_has_been_renamed_2.txt
this_has_been_renamed_3.txt
this_has_been_renamed_4.txt 
```

太有用了

* * *

## 回答 #6

> 赞同：60
> 
> 时间：2008-09-16T01:19:53.947

我是`!$`,`!^`和`!*`expandos 的粉丝，从最近提交的命令行返回：最后一项、第一个非命令项和所有非命令项。也就是说（请注意，shell 首先打印出命令）：

```
$ echo foo bar baz
foo bar baz
$ echo bang-dollar: !$ bang-hat: !^ bang-star: !*
echo bang-dollar: baz bang-hat: foo bang-star: foo bar baz
bang-dollar: baz bang-hat: foo bang-star: foo bar baz 
```

`ls filea fileb`当您说，并且想要编辑其中一个:`vi !$`或两个:时，这会派上用场`vimdiff !*`。它也可以推广到“第`n`th 论点”，如下所示：

```
$ echo foo bar baz
$ echo !:2
echo bar
bar 
```

最后，使用路径名，您可以通过将`:h`和附加`:t`到上述任何扩展来获取路径的某些部分：

```
$ ls /usr/bin/id
/usr/bin/id
$ echo Head: !$:h  Tail: !$:t
echo Head: /usr/bin Tail: id
Head: /usr/bin Tail: id 
```

* * *

## 回答 #7

> 赞同：47
> 
> 时间：2008-09-16T01:06:25.057

运行命令时，有时我会想使用前面的参数运行命令。为此，您可以使用以下快捷方式：

```
$ mkdir /tmp/new
$ cd !!:* 
```

有时，如果我需要在文件列表上运行一堆命令，我会打破一个单行循环来代替使用 find。

```
for file in *.wav; do lame "$file" "$(basename "$file" .wav).mp3" ; done; 
```

在我的 .bash_login（或 .bashrc）中配置命令行历史选项非常有用。以下是我在 Macbook Pro 上使用的一系列设置。

设置以下内容会使 bash 删除历史记录中的重复命令：

```
export HISTCONTROL="erasedups:ignoreboth" 
```

我也把我的历史记录放大了很多。为什么不？它似乎并没有减慢当今微处理器的速度。

```
export HISTFILESIZE=500000
export HISTSIZE=100000 
```

我要做的另一件事是忽略我历史记录中的一些命令。无需记住退出命令。

```
export HISTIGNORE="&:[ ]*:exit" 
```

你肯定想设置 histappend。否则，bash 会在您退出时覆盖您的历史记录。

```
shopt -s histappend 
```

我使用的另一个选项是 cmdhist。这使您可以将多行命令作为一个命令保存到历史记录中。

```
shopt -s cmdhist 
```

最后，在 Mac OS X 上（如果您不使用 vi 模式），您需要将 <CTRL>-S 重置为滚动停止。这可以防止 bash 将其解释为前向搜索。

```
stty stop "" 
```

* * *

## 回答 #8

> 赞同：43
> 
> 时间：2008-10-05T13:02:11.790

如何*仅*列出当前目录中的子目录？

```
ls -d */ 
```

这是一个简单的技巧，但你不会知道我需要多少时间才能找到那个！

* * *

## 回答 #9

> 赞同：41
> 
> 时间：2008-09-16T01:05:55.480

`ESC``.`

插入最后一个 bash 命令的最后一个参数。它比你想象的更有用。

```
cp file /to/some/long/path 
```

光盘`ESC``.`

* * *

## 回答 #10

> 赞同：36
> 
> 时间：2008-10-02T21:57:41.073

当然，你可以“ `diff file1.txt file2.txt`”，但是 Bash 支持[进程替换](http://www.gnu.org/software/bash/manual/html_node/Process-Substitution.html)，它允许你`diff`输出命令。

例如，假设我想确保我的脚本给我期望的输出。我可以将我的脚本包装在 <( ) 中并将其提供`diff`给以进行快速而肮脏的单元测试：

```
$ cat myscript.sh
#!/bin/sh
echo -e "one\nthree"
$
$ ./myscript.sh 
one
three
$
$ cat expected_output.txt
one
two
three
$
$ diff <(./myscript.sh) expected_output.txt
1a2
> two
$ 
```

再举一个例子，假设我想检查两台服务器是否安装了相同的 RPM 列表。而不是 ssh 到每个服务器，将每个 RPM 列表写入单独的文件，然后`diff`对这些文件执行操作，我可以`diff`从我的工作站执行：

```
$ diff <(ssh server1 'rpm -qa | sort') <(ssh server2 'rpm -qa | sort')
241c240
< kernel-2.6.18-92.1.6.el5
---
> kernel-2.6.18-92.el5
317d315
< libsmi-0.4.5-2.el5
727,728d724
< wireshark-0.99.7-1.el5
< wireshark-gnome-0.99.7-1.el5
$ 
```

在[http://tldp.org/LDP/abs/html/process-sub.html](http://tldp.org/LDP/abs/html/process-sub.html)的 Advanced Bash-Scripting Guide 中有更多示例。

* * *

## 回答 #11

> 赞同：35
> 
> 时间：2008-09-16T04:55:59.217

我最喜欢的命令是“ls -thor”

它召唤[众神的力量](http://en.wikipedia.org/wiki/Thor)以方便阅读的格式列出最近修改的文件。

* * *

## 回答 #12

> 赞同：28
> 
> 时间：2008-09-16T01:00:00.360

更多的是新奇，但它很聪明......

使用的前 10 个命令：

```
$ history | awk '{print $2}' | awk 'BEGIN {FS="|"}{print $1}' | sort | uniq -c | sort -nr | head 
```

样本输出：

```
 242 git
  83 rake
  43 cd
  33 ss
  24 ls
  15 rsg
  11 cap
  10 dig
   9 ping
   3 vi 
```

* * *

## 回答 #13

> 赞同：25
> 
> 时间：2008-09-16T01:33:13.230

^R 反向搜索。点击 ^R，键入您想要匹配的上一个命令的片段，然后点击 ^R 直到找到您想要的那个。这样我就不必记住最近使用过的仍然在我的历史记录中的命令。不仅是 bash，还有：^E 表示行尾，^A 表示行首，^U 和 ^K 分别删除光标前后。

* * *

## 回答 #14

> 赞同：20
> 
> 时间：2008-09-16T11:12:02.480

我经常有 vi、ls 等的别名，但有时你想转义别名。只需在前面的命令中添加一个反斜杠：

例如：

```
$ alias vi=vim
$ # To escape the alias for vi:
$ \vi # This doesn't open VIM 
```

酷，不是吗？

* * *

## 回答 #15

> 赞同：17
> 
> 时间：2008-09-16T01:11:15.887

以下是一些配置调整：

`~/.inputrc`：

```
"\C-[[A": history-search-backward
"\C-[[B": history-search-forward 
```

这与使用箭头键相同`^R`但使用箭头键。这意味着我可以键入（例如）`cd /media/`然后按向上箭头以转到文件夹`cd`中的最后一个内容。`/media/`

（我使用 Gnome 终端，您可能需要更改其他终端模拟器的转义码。）

Bash 补全也非常有用，但它是一个更微妙的补充。在`~/.bashrc`：

```
if [ -f /etc/bash_completion ]; then
    . /etc/bash_completion
fi 
```

这将启用每个程序的制表符补全（例如，在命令行开始时尝试制表符补全`evince`将仅显示 evince 可以打开的文件，并且它还将制表符补全命令行选项）。

在以下情况下也可以很好地工作`~/.inputrc`：

```
set completion-ignore-case on
set show-all-if-ambiguous on
set show-all-if-unmodified on 
```

* * *

## 回答 #16

> 赞同：17
> 
> 时间：2008-09-16T04:47:06.400

我经常使用以下内容：

`:p`打印历史结果的修饰符。例如

```
!!:p 
```

将打印最后一条命令，以便您在再次运行之前检查它是否正确。只需输入`!!`即可执行。

与此相类似：

```
!?foo?:p 
```

将在您的历史记录中搜索包含字符串 'foo' 的最新命令并打印出来。

如果不需要打印，

```
!?foo 
```

进行搜索并立即执行。

* * *

## 回答 #17

> 赞同：16
> 
> 时间：2008-09-21T14:22:52.423

我有一个秘密武器：[shell-fu。](http://www.shell-fu.org/)

有数以千计的聪明技巧、酷技巧和有效的食谱，大多数时候都放在一条线上。

我喜欢的一个（但我有点作弊，因为我现在大多数 Unix 系统上都安装了 Python）：

```
alias webshare='python -m SimpleHTTPServer' 
```

现在每次键入“webshare”时，当前目录都将通过端口 8000 可用。当您想在本地网络上与朋友共享文件时，无需 USB 密钥或远程目录，这真是太好了。流媒体视频和音乐也可以。

当然还有经典的叉子炸弹，它完全没用，但仍然很有趣：

```
$ :(){ :|:& };: 
```

不要在生产服务器中尝试...

* * *

## 回答 #18

> 赞同：12
> 
> 时间：2008-09-16T00:59:17.430

您可以将 watch 命令与另一个命令结合使用来查找更改。这方面的一个例子是当我测试我的路由器时，我想获得关于信噪比等内容的最新数字。

```
watch --interval=10 lynx -dump http://dslrouter/stats.html 
```

* * *

## 回答 #19

> 赞同：11
> 
> 时间：2008-09-16T01:10:05.220

我喜欢用**echo**构造命令并将它们传送到 shell：

```
$ find dir -name \*~ | xargs echo rm
...
$ find dir -name \*~ | xargs echo rm | ksh -s 
```

为什么？因为它允许我在做之前先看看要做什么。这样，如果我有一个可怕的错误（比如删除我的主目录），我可以在它发生之前抓住它。显然，这对于破坏性或不可撤销的行为最为重要。

* * *

## 回答 #20

> 赞同：11
> 
> 时间：2008-09-16T06:07:16.940

```
type -a PROG 
```

为了找到 PROG 可用的所有位置，通常在 ~/bin 中的某个位置，而不是 /usr/bin/PROG 中可能预期的位置。

* * *

## 回答 #21

> 赞同：10
> 
> 时间：2008-09-16T01:05:12.860

下载大文件时，我经常这样做：

```
while ls -la <filename>; do sleep 5; done 
```

然后当我完成时只需 ctrl+c （或者如果`ls`返回非零）。它与`watch`程序类似，但它使用 shell，所以它可以在没有`watch`.

另一个有用的工具是 netcat，或`nc`. 如果你这样做：

```
nc -l -p 9100 > printjob.prn 
```

然后您可以在另一台计算机上设置打印机，但使用运行 netcat 的计算机的 IP 地址。发送打印作业时，运行 netcat 的计算机会接收它并转储到`printjob.prn`.

* * *

## 回答 #22

> 赞同：10
> 
> 时间：2008-09-16T02:07:14.130

`pushd`几乎`popd`总是派上用场

* * *

## 回答 #23

> 赞同：10
> 
> 时间：2008-09-16T03:07:58.977

当我在树层次结构中广泛分离的位置使用多个目录时，一种首选的导航方式是使用 acf_func.sh（如下所列）。一旦定义，你可以做

光盘——

查看最近的目录列表，带有数字菜单

光盘 -2

转到第二个最近的目录。

非常容易使用，非常方便。

这是代码：

```
# do ". acd_func.sh"
# acd_func 1.0.5, 10-nov-2004
# petar marinov, http:/geocities.com/h2428, this is public domain

cd_func ()
{
  local x2 the_new_dir adir index
  local -i cnt

  if [[ $1 ==  "--" ]]; then
    dirs -v
    return 0
  fi

  the_new_dir=$1
  [[ -z $1 ]] && the_new_dir=$HOME

  if [[ ${the_new_dir:0:1} == '-' ]]; then
    #
    # Extract dir N from dirs
    index=${the_new_dir:1}
    [[ -z $index ]] && index=1
    adir=$(dirs +$index)
    [[ -z $adir ]] && return 1
    the_new_dir=$adir
  fi

  #
  # '~' has to be substituted by ${HOME}
  [[ ${the_new_dir:0:1} == '~' ]] && the_new_dir="${HOME}${the_new_dir:1}"

  #
  # Now change to the new dir and add to the top of the stack
  pushd "${the_new_dir}" > /dev/null
  [[ $? -ne 0 ]] && return 1
  the_new_dir=$(pwd)

  #
  # Trim down everything beyond 11th entry
  popd -n +11 2>/dev/null 1>/dev/null

  #
  # Remove any other occurence of this dir, skipping the top of the stack
  for ((cnt=1; cnt <= 10; cnt++)); do
    x2=$(dirs +${cnt} 2>/dev/null)
    [[ $? -ne 0 ]] && return 0
    [[ ${x2:0:1} == '~' ]] && x2="${HOME}${x2:1}"
    if [[ "${x2}" == "${the_new_dir}" ]]; then
      popd -n +$cnt 2>/dev/null 1>/dev/null
      cnt=cnt-1
    fi
  done

  return 0
}

alias cd=cd_func

if [[ $BASH_VERSION > "2.05a" ]]; then
  # ctrl+w shows the menu
  bind -x "\"\C-w\":cd_func -- ;"
fi 
```

* * *

## 回答 #24

> 赞同：10
> 
> 时间：2011-01-06T13:50:41.943

### 在击中可怕的输入之前扩展复杂的行

*   `Alt`+ `Ctrl`+ `e`— *shell-expand-line* (可能需要在你的键盘上使用`Esc`, `Ctrl`+ )`e`
*   `Ctrl`+ `_`— *撤消*
*   `Ctrl`+ `x`, `*`— *全局扩展词*

$ `echo !$ !-2^ *` `Alt`+ `Ctrl`+ `e`
$ `echo aword someotherword *` `Ctrl`+ `_`
$ `echo !$ !-2^ *` `Ctrl`+ `x`, `*`
$`echo !$ !-2^ LOG Makefile bar.c foo.h`

＆C。

* * *

## 回答 #25

> 赞同：9
> 
> 时间：2008-09-16T03:38:50.587

我一直偏爱：

```
ctrl-E # move cursor to end of line
ctrl-A # move cursor to beginning of line 
```

我也使用`shopt -s cdable_vars`, 然后你可以为公共目录创建 bash 变量。因此，对于我公司的源代码树，我创建了一堆变量，例如：

```
export Dcentmain="/var/localdata/p4ws/centaur/main/apps/core" 
```

然后我可以通过`cd Dcentmain`.

* * *

## 回答 #26

> 赞同：8
> 
> 时间：2009-10-05T15:32:02.933

`pbcopy`

这将复制到 Mac 系统剪贴板。您可以通过管道向它发送命令...尝试：

`pwd | pbcopy`

* * *

## 回答 #27

> 赞同：7
> 
> 时间：2008-09-16T01:28:31.073

```
$ touch {1,2}.txt
$ ls [12].txt
1.txt  2.txt
$ rm !:1
rm [12].txt
$ history | tail -10
...
10007  touch {1,2}.txt
...
$ !10007
touch {1,2}.txt
$ for f in *.txt; do mv $f ${f/txt/doc}; done 
```

* * *

## 回答 #28

> 赞同：7
> 
> 时间：2008-09-16T02:52:18.470

在命令行中使用“set -o vi”，或者在 .bashrc 中使用更好，可以让您在命令行中进入 vi 编辑模式。您从“插入”模式开始，因此您可以正常键入和退格，但如果您犯了“大”错误，您可以按 esc 键，然后使用“b”和“f”来移动，就像在 vi 中一样。cw 改变一个词。在您提出要更改的历史命令后特别有用。

* * *

## 回答 #29

> 赞同：7
> 
> 时间：2008-09-16T03:02:12.080

**使用&&**命令将多个命令串在一起：

```
./run.sh && tail -f log.txt 
```

或者

```
kill -9 1111 && ./start.sh 
```

* * *

## 回答 #30

> 赞同：7
> 
> 时间：2008-09-16T08:58:49.977

与上述许多类似，我目前最喜欢的是击键 [alt]。（Alt 和“.”键一起使用）这与 $! （插入上一个命令的最后一个参数）除了它是直接的并且对我来说更容易输入。（只是不能在脚本中使用）

例如：

```
mkdir -p /tmp/test/blah/oops/something
cd [alt]. 
```

* * *

## 回答 #31

> 赞同：7
> 
> 时间：2010-08-08T23:15:02.153

**重复文件查找器**

这将从当前目录递归运行校验和，并返回所有相同校验和结果的文件名：

```
find ./ -type f -print0 | xargs -0 -n1 md5sum | sort -k 1,32 | uniq -w 32 -d --all-repeated=separate | sed -e 's/^[0-9a-f]*\ *//;' 
```

当然，您可以更改路径。
也许将其放入函数或别名中，并将目标路径作为参数传入。

* * *

## 回答 #32

> 赞同：6
> 
> 时间：2008-09-16T19:37:40.347

`!`<命令的前几个字符> 将执行匹配的最后一个命令。

例子：

`!b`将运行“构建任何 -O -p -t -i -on” `!.`将运行`./a.out`

它最适用于冗长且重复的命令，例如编译、构建、执行等。它在编码和测试时为我节省了很多时间。

* * *

## 回答 #33

> 赞同：5
> 
> 时间：2010-09-16T06:46:39.107

我有很多我想快速访问的目录，`CDPATH`变量是极大地加快我的工作流程的解决方案：

```
export CDPATH=.:/home/gadolin/sth:/home/gadolin/dir1/importantDir 
```

现在`cd`我可以跳转到任何子目录`/home/gadolin/sth`或`/home/gadolin/dir1/importantDir`不提供完整路径。也在`<tab>`这里工作，就像我在那里一样！因此，如果有目录`/home/gadolin/sth/1` `/home/gadolin/sth/2`，我`cd 1`在任何地方输入，我就在那里。

* * *

## 回答 #34

> 赞同：4
> 
> 时间：2008-09-16T02:58:02.603

`Ctrl`+`L`通常会清除屏幕。在 Bash 提示符（显然）和[GDB](http://en.wikipedia.org/wiki/GNU_Debugger)以及许多其他提示符下工作。

* * *

## 回答 #35

> 赞同：4
> 
> 时间：2008-09-16T11:19:54.957

您应该能够将以下内容粘贴到 bash 终端窗口中。

**显示 ANSI 调色板：**

```
e="\033["
for f in 0 7 `seq 6`; do
  no="" bo=""
  for b in n 7 0 `seq 6`; do
    co="3$f"; p="  "
    [ $b = n ] || { co="$co;4$b";p=""; }
    no="${no}${e}${co}m   ${p}${co} ${e}0m"
    bo="${bo}${e}1;${co}m ${p}1;${co} ${e}0m"
  done
  echo -e "$no\n$bo"
done 
```

**256色演示：**

```
yes "$(seq 232 255;seq 254 -1 233)" |
while read i; do printf "\x1b[48;5;${i}m\n"; sleep .01; done 
```

* * *

## 回答 #36

> 赞同：4
> 
> 时间：2008-09-26T14:15:20.690

删除**除** *重要文件之外的*所有内容：

```
# shopt -s extglob
# rm -rf !(important-file) 
```

在[zsh](http://www.zsh.org/)中相同：

```
# rm -rf *~important-file 
```

之前我知道我必须将重要的字段移到另一个字典中，删除所有内容并再次将重要的字段移回。

* * *

## 回答 #37

> 赞同：4
> 
> 时间：2008-09-30T15:57:30.987

使用历史替换字符`!#`来访问当前命令行，结合`^`,`$`等。

例如，将带有“old-”前缀的文件移开：

`mv file-with-long-name-typed-with-tab-completion.txt old-!#^`

* * *

## 回答 #38

> 赞同：4
> 
> 时间：2009-08-09T06:31:19.473

[http://www.commandlinefu.com](http://www.commandlinefu.com)也是一个很棒的网站。

我在那里学到了很多有用的东西，比如：

```
sudo !! 
```

或者

```
mount | column -t 
```

* * *

## 回答 #39

> 赞同：3
> 
> 时间：2008-09-16T00:59:12.953

好吧，这可能有点跑题了，但是如果您是 Emacs 用户，我会说“emacs”是最强大的技巧...在您对此投反对票之前，请在 emacs 实例中尝试“Mx shell”...您在 emacs 中获得了一个 shell，并拥有 emacs 的所有功能以及 shell 的功能（有一些限制，例如在其中打开另一个 emacs，但在大多数情况下，它比 vanilla bash 提示更强大）。

* * *

## 回答 #40

> 赞同：3
> 
> 时间：2008-09-16T01:04:32.567

我喜欢在我的提示中加入一点色彩：

```
export PS1="\[\033[07;31m\] \h \[\033[47;30m\] \W \[\033[00;31m\] \$ \[\e[m\]" 
```

恐怕我没有关于它的截图，但它应该是这样的（全部在一条线上）：

```
[RED BACK WHITE TEXT] Computer name 
[BLACK BACK WHITE TEXT] Working Directory 
[WHITE BACK RED TEXT] $ 
```

根据您喜欢看到的内容进行自定义`:)`

* * *

## 回答 #41

> 赞同：3
> 
> 时间：2008-09-16T01:18:40.487

作为 CTRL-r 向后搜索的扩展，如果绑定“history-search-backward”，您可以使用历史记录自动完成当前输入。我通常将它绑定到它在 tcsh 中的相同键：ESC-p。您可以通过在 .inputrc 文件中添加以下行来执行此操作：

`"\M-p": history-search-backward`

例如，如果您之前执行过“make some_really_painfully_long_target”，您可以输入：

`> make <ESC p>`

它会给你

`> make some_really_painfully_long_target`

* * *

## 回答 #42

> 赞同：3
> 
> 时间：2008-09-16T09:15:10.013

当你意识到你刚刚输入了错误的行时，要做的一件简单的事情就是按下 Ctrl+C；如果您想保留该行，但需要先执行其他操作，请以反斜杠 - \ 开始新行，然后按 Ctrl+C。该行将保留在您的历史记录中。

* * *

## 回答 #43

> 赞同：3
> 
> 时间：2009-09-21T08:21:32.110

**插入前几行最终参数**

`ALT`-`.` 有史以来最有用的组合键，试试看，不知为何没人知道这个组合。

一次又一次地按下它以选择较旧的最后一个参数。

当您想对刚才使用的东西做其他事情时，这很棒。

* * *

## 回答 #44

> 赞同：3
> 
> 时间：2010-05-22T23:44:02.560

***花括号展开：***

在运行`./configure`带有很多选项的 a 时真的很方便：

```
./configure --{prefix=/usr,mandir=/usr/man,{,sh}libdir=/usr/lib64,\
enable-{gpl,pthreads,bzlib,lib{faad{,bin},mp3lame,schroedinger,speex,theora,vorbis,xvid,x264},\
pic,shared,postproc,avfilter{-lavf,}},disable-static} 
```

这实际上是我对 ffmpeg 的配置设置。没有大括号，它是 409 个字符。

或者，甚至更好：

```
echo "I can count to a thousand!" ...{0,1,2,3,4,5,6,7,8,9}{0,1,2,3,4,5,6,7,8,9}{0,1,2,3,4,5,6,7,8,9}... 
```

* * *

## 回答 #45

> 赞同：2
> 
> 时间：2008-09-16T02:57:04.340

我在别名中有各种印刷错误更正

```
alias mkae=make

alias mroe=less 
```

* * *

## 回答 #46

> 赞同：2
> 
> 时间：2008-09-16T03:01:58.837

“最后一个命令的最后一个参数”对我来说最简单的击键是！$

```
echo what the heck?

what the heck?

echo !$

heck? 
```

* * *

## 回答 #47

> 赞同：2
> 
> 时间：2008-09-16T04:51:31.567

`$_`（美元下划线）：上一个命令的最后一个单词。类似于，`!$`除了它不会像它那样将它的替换放在你的历史记录`!$`中。

* * *

## 回答 #48

> 赞同：2
> 
> 时间：2008-09-16T05:16:25.847

消除文件中的重复行

```
#sort -u filename > filename.new 
```

列出所有不符合条件的行

```
#grep -v ajsk filename 
```

这些不一定是 Bash 特定的（但也不是`ls -thor`:)）

其他一些有用的cmd：

prtdiag、psrinfo、prtconf - 更多信息[在这里](http://shiv.me/2008/09/09/unix-removing-duplicates-from-a-file/)和[这里](http://shiv.me/2007/09/08/unix-how-to-check-system-configuration-on-solaris/)（我的博客上的帖子）。

* * *

## 回答 #49

> 赞同：2
> 
> 时间：2008-09-16T06:17:32.547

不是很晦涩，但我绝对*喜欢*的功能之一是制表符补全。
当您在整个子树结构中导航时，或者当您使用一些晦涩或长命令时，它真的很有用！

* * *

## 回答 #50

> 赞同：2
> 
> 时间：2008-09-16T11:37:03.980

**CTRL+D**退出外壳。

* * *

## 回答 #51

> 赞同：2
> 
> 时间：2009-01-06T20:26:11.620

使用**别名**可以节省时间

```
alias myDir = "cd /this/is/a/long/directory; pwd" 
```

* * *

## 回答 #52

> 赞同：2
> 
> 时间：2009-04-15T16:58:44.977

[我是 Bash作业控制](http://web.mit.edu/gnu/doc/html/features_5.html)的忠实粉丝，主要是使用`Control-Z`and `fg`，尤其是当我在终端中进行开发时。如果我打开了 emacs 并需要编译、部署等。我只是`Control-Z`暂停 emacs，做我需要的，然后`fg`将其恢复。这使所有 emacs 缓冲区保持完整，并且比重新启动我正在做的任何事情都容易得多。

* * *

## 回答 #53

> 赞同：2
> 
> 时间：2009-10-17T06:01:58.230

`alias ..='cd ..'`

因此，在导航备份目录时，只需使用`..<Enter>`

* * *

## 回答 #54

> 赞同：2
> 
> 时间：2010-08-21T23:45:38.910

SSH隧道：

```
ssh -fNR 1234:localhost:22 root@123.123.123.123 
```

* * *

## 回答 #55

> 赞同：2
> 
> 时间：2011-03-02T05:26:44.693

不是我最喜欢的，如果您使用复制和粘贴尝试任何其他答案，这将非常有帮助：

```
function $
{
    "$@"
} 
```

`$`现在您可以粘贴在每行开头包含提示的示例。

* * *

## 回答 #56

> 赞同：1
> 
> 时间：2008-09-16T01:02:16.987

bash 可以重定向到 TCP/IP 套接字。/dev/tcp/ 和 /dev/udp。

有些人认为这是一个安全问题，但这就是像 Solaris X 的监狱这样的操作系统级别的安全性。

正如 Will Robertson 所说，更改提示符以执行操作... print the command # for !nn 设置 Xterm 终端名称。如果它是一个旧的 Xterm，它不会嗅探流量来设置它的标题。

* * *

## 回答 #57

> 赞同：1
> 
> 时间：2008-09-16T01:29:54.063

这实际上对我来说很关键：

设置-o vi

/艾伦

* * *

## 回答 #58

> 赞同：1
> 
> 时间：2008-09-16T01:35:51.197

我一直很喜欢这个。将此添加到您的 /etc/inputrc 或 ~/.inputrc

"\e[A":history-search-backward "\e[B":history-search-forward

当您键入`ls <up-arrow>`时，它将被最后一个以“ls”开头的命令或您输入的任何其他命令替换。

* * *

## 回答 #59

> 赞同：1
> 
> 时间：2008-09-16T02:53:48.620

这可以防止[更少](http://en.wikipedia.org/wiki/Less_%28Unix%29)（少即是多）在文件末尾清除屏幕：

```
export LESS="-X" 
```

* * *

## 回答 #60

> 赞同：1
> 
> 时间：2008-09-16T03:16:28.473

在两个单独的目录之间导航并来回复制文件时，我这样做：

```
cd /some/where/long
src=`pwd`
cd /other/where/long
dest=`pwd`

cp $src/foo $dest

command completion will work by expanding the variable, so you can use tab completion to specify a file you're working with. 
```

* * *

## 回答 #61

> 赞同：1
> 
> 时间：2008-09-16T04:28:57.817

<任何东西> | 排序 | 唯一的-c | 排序 -n

将为您提供 <anything> 的所有不同出现次数。

通常，awk、sed 或 cut 有助于解析 <anything> 中的数据。

* * *

## 回答 #62

> 赞同：1
> 
> 时间：2008-09-16T04:30:44.253

杜-a | 排序-n | 尾-99

查找要清理的大文件（或文件目录）以释放磁盘空间。

* * *

## 回答 #63

> 赞同：1
> 
> 时间：2008-09-16T06:38:17.350

几年前，我发现了**p***命令或获取有关进程的信息：**ptree**、**pgrep**、**pkill**和**pfiles**。当然，它们的母亲都是**ps**，但是您需要将输出通过管道传输到**less**、**grep**和/或**awk**以了解重负载下的输出。 **顶部**（和变体）也有帮助。

* * *

## 回答 #64

> 赞同：1
> 
> 时间：2008-09-16T11:35:00.007

想要获取日志文件的最后几行？

```
tail /var/log/syslog 
```

想要密切关注日志文件何时发生变化？

```
tail -f /var/log/syslog 
```

想从一开始就快速读取文件吗？

```
more /var/log/syslog 
```

想要快速查找文件是否包含一些文本？

```
grep "find this text" /var/log/syslog 
```

* * *

## 回答 #65

> 赞同：1
> 
> 时间：2008-09-16T19:02:39.540

当您希望 TAB 完成忽略具有某些后缀的文件或文件夹时，FIGNORE 环境变量非常有用，例如：

```
export FIGNORE="CVS:.svn:~" 
```

如果要定义除空格以外的项目分隔符，请使用 IFS 环境变量，例如：

```
export IFS="
" 
```

这将使您能够在不执行任何魔术的情况下循环浏览带有空格的文件和文件夹，如下所示：

```
$ touch "with spaces" withoutspaces
$ for i in `ls *`; do echo $i; done
with
spaces
withoutspaces
$ IFS="
"
$ for i in `ls *`; do echo $i; done
with spaces
withoutspaces 
```

* * *

## 回答 #66

> 赞同：1
> 
> 时间：2008-09-18T00:03:11.137

适合对包含符号链接的目录进行精确的递归复制/备份（而不是像 cp 一样跟随它们或忽略它们）：

```
$ mkdir new_dir
$ cd old_dir
$ tar cf - . | ( cd ../old_dir; tar xf - ) 
```

* * *

## 回答 #67

> 赞同：1
> 
> 时间：2008-09-18T18:51:09.240

再次排名前 10 的命令（如[ctcherry](https://stackoverflow.com/questions/68372/what-are-some-of-your-favorite-command-line-tricks-using-bash#68390)的帖子，只是更短）：

```
history | awk '{ print $2 }' | sort | uniq -c |sort -rn | head 
```

* * *

## 回答 #68

> 赞同：1
> 
> 时间：2008-09-19T16:13:05.840

我是在 mac 上编程的新手，我想念能够从 bash 启动 gui 程序......所以我必须创建这样的函数：

```
function macvim
{
/Applications/MacVim.app/Contents/MacOS/Vim "$@" -gp &
} 
```

* * *

## 回答 #69

> 赞同：1
> 
> 时间：2008-09-21T01:58:22.727

```
while IFS= read -r line; do
echo "$line"
done < somefile.txt 
```

这是逐行处理文件的好方法。需要清除 IFS 以获取行首或行尾的空白字符。需要“-r”来获取所有原始字符，包括反斜杠。

* * *

## 回答 #70

> 赞同：1
> 
> 时间：2008-09-24T15:02:30.027

一些 Bash 掘金也在这里：

[http://codesnippets.joyent.com/tag/bash](http://codesnippets.joyent.com/tag/bash)

* * *

## 回答 #71

> 赞同：1
> 
> 时间：2008-09-26T13:59:53.580

我最喜欢的 bash 技巧之一是“tar pipe”。当你有大量的文件要从一个目录复制到另一个目录时，如果文件数量太高并爆炸 bash globber，则执行“cp * /an/other/dir”将不起作用，因此，tar 管道：

`(cd /path/to/source/dir/ ; tar cf - * ) | (cd /path/to/destination/ ; tar xf - )`

...如果你有netcat，你甚至可以[通过网络做“netcat tar pipe”！](http://compsoc.dur.ac.uk/~djw/tarpipe.html)

* * *

## 回答 #72

> 赞同：1
> 
> 时间：2008-09-30T10:57:22.097

在导航深度树结构时，我有一个非常愚蠢但非常有用的方法。把它放在 .bashrc （或类似的）中：

```
alias cd6="cd ../../../../../.."
alias cd5="cd ../../../../.."
alias cd4="cd ../../../.."
alias cd3="cd ../../.."
alias cd2="cd ../.." 
```

* * *

## 回答 #73

> 赞同：1
> 
> 时间：2008-10-02T22:13:09.430

在 Mac OS X 上，

```
ESC . 
```

将循环浏览最近的论点。即：按下并释放`ESC`，然后按下并释放`.`（句点键）。在 Ubuntu 上，我认为它是`ALT+.`.

您可以多次这样做，以回顾您最近的所有论点。有点像`CTRL`+ `R`，但仅用于参数。它也比`!!`or更安全`$!`，因为您在实际运行命令之前就**看到**了将要得到的结果。

* * *

## 回答 #74

> 赞同：1
> 
> 时间：2008-10-05T13:05:30.863

```
sudo !! 
```

以管理员权限运行最后一个命令。

* * *

## 回答 #75

> 赞同：1
> 
> 时间：2009-04-15T16:43:17.247

[Shell-fu](http://www.shell-fu.org/)是一个存储、调整和传播命令行提示和技巧的地方。有点像 StackOverflow，但仅适用于 shell。你会在那里找到很多这个问题的答案。

* * *

## 回答 #76

> 赞同：1
> 
> 时间：2009-07-16T16:54:28.180

因为我总是需要这个`for i in $(ls)`声明，所以我做了一个捷径：

```
fea(){
   if test -z ${2:0:1}; then action=echo; else action=$2; fi
   for i in $(ls $1);
      do $action $i ;
   done;
} 
```

另一个是：

```
echo ${!B*} 
```

它将打印以“B”开头的所有已定义变量的列表。

* * *

## 回答 #77

> 赞同：1
> 
> 时间：2010-05-24T04:48:16.057

ctrl-u 删除所有写的东西

* * *

## 回答 #78

> 赞同：1
> 
> 时间：2010-05-27T14:45:17.533

***快速文本***

我经常使用这些文本序列，所以我把它们的快捷方式放在了`.inputrc`：

```
# redirection short cuts
"\ew":            "2>&1"
"\eq":            "&>/dev/null &"
"\e\C-q":         "2>/dev/null"
"\eg":            "&>~/.garbage.out &"
"\e\C-g":         "2>~/.garbage.out"

$if term=xterm
"\M-w":           "2>&1"
"\M-q":           "&>/dev/null &"
"\M-\C-q":        "2>/dev/null"
"\M-g":           "&>~/.garbage.out &"
"\M-\C-g":        "2>~/.garbage.out"
$endif 
```

* * *

## 回答 #79

> 赞同：1
> 
> 时间：2010-05-27T14:46:01.510

***可编程完成：***

没有什么花哨。当我使用 Knoppix 时，我总是禁用它，因为它经常妨碍我。只是一些基本的：

```
shopt -s progcomp

complete -A stopped -P '%'          bg
complete -A job     -P '%'          fg jobs disown wait
complete -A variable                readonly export
complete -A variable -A function    unset
complete -A setopt                  set
complete -A shopt                   shopt
complete -A helptopic               help
complete -A alias                   alias unalias
complete -A binding                 bind
complete -A command                 type which \
                                    killall pidof
complete -A builtin                 builtin
complete -A disabled                enable 
```

* * *

## 回答 #80

> 赞同：1
> 
> 时间：2010-05-27T14:51:52.247

不是真正的交互式 shell 技巧，但作为编写好脚本的技巧仍然有效。

***getopts, 转移, $OPTIND, $OPTARG:***

我喜欢制作可定制的脚本：

```
while getopts 'vo:' flag; do
    case "$flag" in
        'v')
        VERBOSE=1
        ;;
        'o')
        OUT="$OPTARG"
        ;;
    esac
done
shift "$((OPTIND-1))" 
```

* * *

***xargs(1):***

我有一个三核处理器，喜欢运行对一组文件执行压缩或其他一些 CPU 密集型串行操作的脚本。`xargs`我喜欢将其用作作业队列来加速它。

```
if [ "$#" -gt 1 ]; then
    # schedule using xargs
    (for file; do
        echo -n "$file"
        echo -ne '\0'
    done) |xargs -0 -n 1 -P "$NUM_JOBS" -- "$0"
else
    # do the actual processing
fi 
```

这很像`make -j [NUM_JOBS]`.

* * *

## 回答 #81

> 赞同：1
> 
> 时间：2010-05-27T14:59:58.627

***信号捕获：***

您可以捕获发送到 shell 进程的信号，并让它们在各自的环境中静默运行命令，就像在命令行上键入一样：

```
# TERM or QUIT probably means the system is shutting down; make sure history is
# saved to $HISTFILE (does not do this by default)
trap 'logout'                      TERM QUIT

# save history when signalled by cron(1) script with USR1
trap 'history -a && history -n'    USR1 
```

* * *

## 回答 #82

> 赞同：1
> 
> 时间：2010-08-23T15:24:38.800

对于纯粹的幽默因素，创建一个空文件“我自己”，然后：`$ touch myself`

* * *

## 回答 #83

> 赞同：1
> 
> 时间：2010-11-16T22:04:05.570

扩展通配符：

```
rm !(foo|bar) 
```

像`*`没有`foo`or一样展开`bar`：

```
$ ls
foo
bar
foobar
FOO
$ echo !(foo|bar)
foobar FOO 
```

* * *

## 回答 #84

> 赞同：1
> 
> 时间：2010-11-17T03:09:47.677

GNU/Linux 的 pbcopy 和 pbpaste 别名

```
alias pbcopy='xclip -selection clipboard'
alias pbpaste='xclip -selection clipboard -o' 
```

* * *

## 回答 #85

> 赞同：1
> 
> 时间：2010-11-23T12:49:41.237

其他人在 Emacs 中推荐了“Mx shell RET”。我认为“Mx eshell RET”更好。

* * *

## 回答 #86

> 赞同：0
> 
> 时间：2008-09-16T01:05:18.053

我在寻找一些音频和视频编辑工具时发现了一些有用的 mencoder 命令：

从 .xxx 到 .avi

```
mencoder movie.wmv -o movie.avi -ovc lavc -oac lavc 
```

从视频中转储声音：

```
mplayer -ao pcm -vo null -vc dummy -dumpaudio -dumpfile fileout.mp3 filein.avi 
```

* * *

## 回答 #87

> 赞同：0
> 
> 时间：2008-09-16T02:55:04.843

我更喜欢在 vi 中阅读手册页，因此我的 .profile 或 .bashrc 文件中有以下内容

```
man () {
    sought=$*
    /usr/bin/man $sought | col -b | vim -R -c "set nonumber" -c "set syntax=man"  -
} 
```

* * *

## 回答 #88

> 赞同：0
> 
> 时间：2008-09-16T06:12:07.710

```
alias mycommand = 'verylongcommand -with -a -lot -of -parameters'
alias grep='grep --color' 
```

用 grep 查找多个单词：

```
netstat -c |grep 'msn\|skype\|icq' 
```

* * *

## 回答 #89

> 赞同：0
> 
> 时间：2008-09-16T06:42:17.747

您更改到一个新目录并希望将文件从新目录移动到旧目录。一举一动：`mv file $OLDPWD`

* * *

## 回答 #90

> 赞同：0
> 
> 时间：2008-09-16T07:05:37.597

如果我正在搜索目录中的某些内容，但我不确定该文件，那么我只需通过以下方式 grep 目录中的文件：

```
find . -exec grep whatIWantToFind {} \; 
```

* * *

## 回答 #91

> 赞同：0
> 
> 时间：2008-09-16T07:51:45.800

```
alias -- ddt='ls -trFld'
dt () { ddt --color "$@" | tail -n 30; } 
```

为您提供当前目录中的最新文件。我用它所有的时间...

* * *

## 回答 #92

> 赞同：0
> 
> 时间：2008-09-16T17:48:28.987

为了能够快速编辑您知道位于 $PATH 中的 shell 脚本（不要尝试使用 ls...）：

```
function viscr { vi $(which $*); } 
```

* * *

## 回答 #93

> 赞同：0
> 
> 时间：2008-09-16T18:02:35.177

恰当的历史——使用神秘的插入符号等并不完全直观。要打印包含给定字符串的所有历史记录项：

```
function histgrep { fc -l -$((HISTSIZE-1)) | egrep "$@" ;} 
```

* * *

## 回答 #94

> 赞同：0
> 
> 时间：2008-09-18T15:28:41.660

自定义选项卡完成（compgen 和完整的 bash 内置）

Tab Completion 很好，但能够将其应用于不仅仅是文件名也很棒。我用它来创建自定义函数来扩展我一直使用的命令的参数。例如，假设您经常需要将 FQDN 作为参数添加到命令（例如`ping blah.really.long.domain.name.foo.com`）。您可以使用 compgen 和 complete 创建一个读取 /etc/hosts 文件以获取结果的 bash 函数，因此您只需键入：

```
ping blah.<tab> 
```

它将显示您当前的所有匹配选项。

所以基本上任何可以返回单词列表的东西都可以用作函数。

* * *

## 回答 #95

> 赞同：0
> 
> 时间：2008-09-18T16:45:08.980

当运行具有大量输出的命令时（比如一个大的“make”），我不仅要保存输出，还要查看它：

安装 2>&1 | tee E.make

* * *

## 回答 #96

> 赞同：0
> 
> 时间：2008-09-18T17:33:56.647

作为一个快速计算器，比如说计算一个百分比：

```
$ date
Thu Sep 18 12:55:33 EDT 2008
$ answers=60
$ curl "http://stackoverflow.com/questions/68372/what-are-some-of-your-favorite-command-line-tricks-using-bash"  > tmp.html
$ words=`awk '/class="post-text"/ {s = s $0} \
> /<\/div>/ { gsub("<[^>]*>", "", s); print s; s = ""} \
> length(s) > 0 {s = s $0}' tmp.html \
> |  awk '{n = n + NF} END {print n}'`
$ answers=`awk '/([0-9]+) Answers/ {sub("<h2>", "", $1); print $1}' tmp.html` 
```

最后：

```
$ echo $words words, $answers answers, $((words / $answers)) words per answer
4126 words, 60 answers, 68 words per answer
$ 
```

并不是说除法被截断，而不是四舍五入。但通常这对于快速计算来说已经足够了。

* * *

## 回答 #97

> 赞同：0
> 
> 时间：2008-09-19T19:11:04.977

我总是将默认提示设置为“username@hostname:/current/path/name/in/full>”

```
PS1='\u@\h:\w> '
export PS1 
```

当您处理许多不同的机器时，可以避免很多混乱。

* * *

## 回答 #98

> 赞同：0
> 
> 时间：2008-10-06T09:30:26.567

```
find -iregex '.*\.py$\|.*\.xml$' | xargs egrep -niH 'a.search.pattern'  | vi -R - 
```

在所有 Python 文件和所有 XML 文件中搜索模式，并将结果通过管道传输到只读[Vim](http://en.wikipedia.org/wiki/Vim_%28text_editor%29)会话中。

* * *

## 回答 #99

> 赞同：0
> 
> 时间：2008-11-30T05:41:34.420

我最喜欢的两个是：

1）使制表符完成不区分大小写（例如，“cd /home/User”将您的命令行转换为：“cd /home/user”，如果后者存在而前者不存在。您可以使用“设置完成”打开它-ignore-case on”，或者通过将“set completion-ignore-case on”添加到您的 .inputrc 文件来永久添加它。

2) 内置的 'type' 命令类似于 "which" 但也知道别名。例如

```
$ type cdhome
cdhome is aliased to 'cd ~'
$ type bash
bash is /bin/bash 
```

* * *

## 回答 #100

> 赞同：0
> 
> 时间：2008-12-06T23:51:45.090

我喜欢设置一个提示，在 xterm 的窗口标题中显示当前目录。它还显示时间和当前目录。此外，如果 bash 想要报告后台作业已完成，则使用 ANSI 转义序列以不同的颜色报告。我使用的是黑底光控制台，所以如果你喜欢黑底光，我的颜色可能不适合你。

```
PROMPT_COMMAND='echo -e "\033]0;${USER}@${HOSTNAME%%.*}:${PWD/#$HOME/~}\007\033[1;31m${PWD/#$HOME/~}\033[1;34m"'
PS1='\[\e[1;31m\]\t \$ \[\e[0m\]' 
```

确保您了解如何正确使用PS1 字符串`\[`，`\]`以便 bash 知道您的提示字符串在屏幕上实际呈现多长时间。这样当您超出单行命令时，它可以正确重绘您的命令行。

* * *

## 回答 #101

> 赞同：0
> 
> 时间：2008-12-22T01:12:40.050

我想提一下我们如何使用它的批处理模式（-b）将顶级命令输出重定向到文件

$ top -b -n 1 > top.out.$(date +%s)

默认情况下，top 使用交互模式调用，其中 top 无限期运行并接受 keypress 以重新定义 top 的工作方式。

我写的一篇文章可以在[这里找到](http://unstableme.blogspot.com/2008/12/redirect-top-command-output-to-file.html)

* * *

## 回答 #102

> 赞同：0
> 
> 时间：2009-12-02T15:30:43.560

如何使用 find | 查找与文本匹配的文件 grep -H 在这个例子中，哪个 ruby​​ 文件包含跳转字符串 -

寻找 。-name '*.rb' -exec grep -H jump {} \;

* * *

## 回答 #103

> 赞同：0
> 
> 时间：2010-03-18T11:17:38.493

仅限 Mac。这很简单，但我真希望我几年前就知道这一点。

```
open ./ 
```

在 Finder 中打开当前目录。您还可以使用它通过其默认应用程序打开任何文件。也可用于 URL，但前提是您在 URL 前加上`http://`，这限制了它打开偶尔随机站点的实用程序。

* * *

## 回答 #104

> 赞同：0
> 
> 时间：2010-05-27T14:58:43.073

./mylittlealgorithm < input.txt > output.txt

* * *

## 回答 #105

> 赞同：0
> 
> 时间：2010-11-16T21:50:22.313

```
# Batch extension renamer (usage: renamer txt mkd)
renamer() {
   local fn
   for fn in *."$1"; do
     mv "$fn" "${fn%.*}"."$2"
   done
} 
```

# ruby-on-rails - 如何编写跨模型、控制器和视图的 Rails mixin

> ID：68391
> 
> 赞同：6
> 
> 时间：2008-09-16T01:00:29.470
> 
> 标签：ruby-on-rails, ruby, refactoring, dry

为了减少我的小 Rails 应用程序中的代码重复，我一直致力于将我的模型之间的通用代码放入它自己的单独模块中，到目前为止一切都很好。

模型的东西相当简单，我只需要在开始时包含模块，例如：

```
class Iso < Sale
  include Shared::TracksSerialNumberExtension
  include Shared::OrderLines
  extend  Shared::Filtered
  include Sendable::Model

  validates_presence_of   :customer
  validates_associated    :lines

  owned_by :customer

  def initialize( params = nil )
    super
    self.created_at ||= Time.now.to_date
  end

  def after_initialize
  end

  order_lines             :despatched

  # tracks_serial_numbers   :items
  sendable :customer

  def created_at=( date )
    write_attribute( :created_at, Chronic.parse( date ) )
  end
end 
```

这工作正常，但是现在，我将有一些控制器和视图代码，这些代码在这些模型之间也将是通用的，到目前为止，我有这个用于我的可发送内容：

```
# This is a module that is used for pages/forms that are can be "sent"
# either via fax, email, or printed.
module Sendable
  module Model
    def self.included( klass )
      klass.extend ClassMethods
    end

    module ClassMethods
      def sendable( class_to_send_to )
        attr_accessor :fax_number,
                      :email_address,
                      :to_be_faxed,
                      :to_be_emailed,
                      :to_be_printed

        @_class_sending_to ||= class_to_send_to

        include InstanceMethods
      end

      def class_sending_to
        @_class_sending_to
      end
    end # ClassMethods

    module InstanceMethods
      def after_initialize( )
        super
        self.to_be_faxed    = false
        self.to_be_emailed  = false
        self.to_be_printed  = false

        target_class = self.send( self.class.class_sending_to )
        if !target_class.nil?
          self.fax_number     = target_class.send( :fax_number )
          self.email_address  = target_class.send( :email_address )
        end
      end
    end
  end # Module Model
end # Module Sendable 
```

基本上我打算只为控制器和视图做一个包含 Sendable::Controller 和 Sendable::View （或等效的），但是，有没有更干净的方法来做到这一点？我正在寻找一种在我的模型、控制器和视图之间拥有一堆公共代码的简洁方法。

编辑：澄清一下，这只能在 2 或 3 个模型之间共享。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-16T02:35:38.587

如果需要将该代码添加到所有模型和所有控制器中，您始终可以执行以下操作：

```
# maybe put this in environment.rb or in your module declaration
class ActiveRecord::Base
  include Iso
end

# application.rb
class ApplicationController
  include Iso
end 
```

如果您需要此模块中可用于视图的函数，您可以使用`helper_method`application.rb 中的声明单独公开它们。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-16T03:36:54.057

你可以插件化它（使用脚本/生成插件）。

然后在您的 init.rb 中执行以下操作：

```
ActiveRecord::Base.send(:include, PluginName::Sendable)
ActionController::Base.send(:include, PluginName::SendableController) 
```

和你的 self.included 一起应该可以正常工作。

查看一些 act_* 插件，这是一种非常常见的模式（[http://github.com/technoweenie/acts_as_paranoid/tree/master/init.rb](http://github.com/technoweenie/acts_as_paranoid/tree/master/init.rb)，查看第 30 行）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-16T04:34:14.387

如果您确实走插件路线，请查看[Rails-Engines](http://rails-engines.org/)，它旨在以清晰的方式将插件语义扩展到控制器和视图。

# c# - 比较名称

> ID：68408
> 
> 赞同：2
> 
> 时间：2008-09-16T01:03:22.880
> 
> 标签：c#, string, comparison

是否有任何**简单的算法**来确定代表同一个人的 2 个名字的可能性？

我不是要求自定义部门可能使用的级别。只是一个简单的算法，它会告诉我“James T. Clark”是否很可能与“J. Clark”同名。托马斯·克拉克”或“詹姆斯·克拉克”。

如果有一个算法`C#`会很棒，但我可以翻译任何语言。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-16T01:22:33.863

听起来您正在寻找基于语音的算法，例如[soundex](http://en.wikipedia.org/wiki/Soundex)、[NYSIIS](http://en.wikipedia.org/wiki/New_York_State_Identification_and_Intelligence_System)或[double metaphone](http://en.wikipedia.org/wiki/Double_Metaphone)。第一个实际上*是*几个政府部门使用的，实施起来很简单（有许多现成的实施[）](http://www.google.com/search?q=soundex+c%23)。第二个是第一个稍微复杂和更精确的版本。后者最适用于一些非英文名称和字母。

[Levenshtein 距离](http://en.wikipedia.org/wiki/Levenshtein_distance)是两个任意字符串之间距离的定义。它为您提供相同字符串之间的距离为 0，不同字符串之间的距离为非零，如果您决定制作自定义算法，这也可能很有用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-16T01:06:39.237

[Levenshtein](http://en.wikipedia.org/wiki/Levenshtein_distance)很接近，虽然可能不是你想要的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-16T01:32:58.753

我遇到过类似的问题并尝试先使用 Levenstein 距离，但它对我来说效果不佳。我想出了一种算法，它可以为您提供两个字符串之间的“相似性”值（更高的值意味着更多相似的字符串，“1”表示相同的字符串）。这个值本身并不是很有意义（如果不是“1”，则始终为 0.5 或更小），但是当您输入匈牙利矩阵以从两个字符串列表中查找匹配对时，它的效果非常好。

像这样使用：

```
PartialStringComparer cmp = new PartialStringComparer();
tbResult.Text = cmp.Compare(textBox1.Text, textBox2.Text).ToString(); 
```

后面的代码：

```
public class SubstringRange {
    string masterString;

    public string MasterString {
        get { return masterString; }
        set { masterString = value; }
    }
    int start;

    public int Start {
        get { return start; }
        set { start = value; }
    }
    int end;

    public int End {
        get { return end; }
        set { end = value; }
    }
    public int Length {
        get { return End - Start; }
        set { End = Start + value;}
    }

    public bool IsValid {
        get { return MasterString.Length >= End && End >= Start && Start >= 0; }
    }

    public string Contents {
        get {
            if(IsValid) {
                return MasterString.Substring(Start, Length);
            } else {
                return "";
            }
        }
    }
    public bool OverlapsRange(SubstringRange range) {
        return !(End < range.Start || Start > range.End);
    }
    public bool ContainsRange(SubstringRange range) {
        return range.Start >= Start && range.End <= End;
    }
    public bool ExpandTo(string newContents) {
        if(MasterString.Substring(Start).StartsWith(newContents, StringComparison.InvariantCultureIgnoreCase) && newContents.Length > Length) {
            Length = newContents.Length;
            return true;
        } else {
            return false;
        }
    }
}

public class SubstringRangeList: List<SubstringRange> {
    string masterString;

    public string MasterString {
        get { return masterString; }
        set { masterString = value; }
    }

    public SubstringRangeList(string masterString) {
        this.MasterString = masterString;
    }

    public SubstringRange FindString(string s){
        foreach(SubstringRange r in this){
            if(r.Contents.Equals(s, StringComparison.InvariantCultureIgnoreCase))
                return r;
        }
        return null;
    }

    public SubstringRange FindSubstring(string s){
        foreach(SubstringRange r in this){
            if(r.Contents.StartsWith(s, StringComparison.InvariantCultureIgnoreCase))
                return r;
        }
        return null;
    }

    public bool ContainsRange(SubstringRange range) {
        foreach(SubstringRange r in this) {
            if(r.ContainsRange(range))
                return true;
        }
        return false;
    }

    public bool AddSubstring(string substring) {
        bool result = false;
        foreach(SubstringRange r in this) {
            if(r.ExpandTo(substring)) {
                result = true;
            }
        }
        if(FindSubstring(substring) == null) {
            bool patternfound = true;
            int start = 0;
            while(patternfound){
                patternfound = false;
                start = MasterString.IndexOf(substring, start, StringComparison.InvariantCultureIgnoreCase);
                patternfound = start != -1;
                if(patternfound) {
                    SubstringRange r = new SubstringRange();
                    r.MasterString = this.MasterString;
                    r.Start = start++;
                    r.Length = substring.Length;
                    if(!ContainsRange(r)) {
                        this.Add(r);
                        result = true;
                    }
                }
            }
        }
        return result;
    }

    private static bool SubstringRangeMoreThanOneChar(SubstringRange range) {
        return range.Length > 1;
    }

    public float Weight {
        get {
            if(MasterString.Length == 0 || Count == 0)
                return 0;
            float numerator = 0;
            int denominator = 0;
            foreach(SubstringRange r in this.FindAll(SubstringRangeMoreThanOneChar)) {
                numerator += r.Length;
                denominator++;
            }
            if(denominator == 0)
                return 0;
            return numerator / denominator / MasterString.Length;
        }
    }

    public void RemoveOverlappingRanges() {
        SubstringRangeList l = new SubstringRangeList(this.MasterString);
        l.AddRange(this);//create a copy of this list
        foreach(SubstringRange r in l) {
            if(this.Contains(r) && this.ContainsRange(r)) {
                Remove(r);//try to remove the range
                if(!ContainsRange(r)) {//see if the list still contains "superset" of this range
                    Add(r);//if not, add it back
                }
            }
        }
    }

    public void AddStringToCompare(string s) {
        for(int start = 0; start < s.Length; start++) {
            for(int len = 1; start + len <= s.Length; len++) {
                string part = s.Substring(start, len);
                if(!AddSubstring(part))
                    break;
            }
        }
        RemoveOverlappingRanges();
    }
}

public class PartialStringComparer {
    public float Compare(string s1, string s2) {
        SubstringRangeList srl1 = new SubstringRangeList(s1);
        srl1.AddStringToCompare(s2);
        SubstringRangeList srl2 = new SubstringRangeList(s2);
        srl2.AddStringToCompare(s1);
        return (srl1.Weight + srl2.Weight) / 2;
    }
} 
```

Levenstein 距离一要简单得多（改编自[http://www.merriampark.com/ld.htm](http://www.merriampark.com/ld.htm)）：

```
public class Distance {
    /// <summary>
    /// Compute Levenshtein distance
    /// </summary>
    /// <param name="s">String 1</param>
    /// <param name="t">String 2</param>
    /// <returns>Distance between the two strings.
    /// The larger the number, the bigger the difference.
    /// </returns>
    public static int LD(string s, string t) {
        int n = s.Length; //length of s
        int m = t.Length; //length of t
        int[,] d = new int[n + 1, m + 1]; // matrix
        int cost; // cost
        // Step 1
        if(n == 0) return m;
        if(m == 0) return n;
        // Step 2
        for(int i = 0; i <= n; d[i, 0] = i++) ;
        for(int j = 0; j <= m; d[0, j] = j++) ;
        // Step 3
        for(int i = 1; i <= n; i++) {
            //Step 4
            for(int j = 1; j <= m; j++) {
                // Step 5
                cost = (t.Substring(j - 1, 1) == s.Substring(i - 1, 1) ? 0 : 1);
                // Step 6
                d[i, j] = System.Math.Min(System.Math.Min(d[i - 1, j] + 1, d[i, j - 1] + 1), d[i - 1, j - 1] + cost);
            }
        }
        // Step 7
        return d[n, m];
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-16T01:09:21.430

我怀疑有，考虑到即使是[海关部门似乎也没有令人满意的答案](http://www.upgradetravelbetter.com/2008/09/14/tired-of-secondary-screenings-change-your-name/)......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-16T01:11:46.167

如果这个问题有解决方案，我严重怀疑它是核心 C# 的一部分。在我的脑海中，它需要一个包含名字，中间名和姓氏频率的数据库，以及首字母缩写，就像你的例子一样。这是一个相当复杂的逻辑，依赖于信息数据库。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-16T01:13:34.680

仅次于 Levenshtein 距离，你想要什么语言？我能够很容易地在 codeproject 上找到 C# 中的实现。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-16T01:16:07.890

在我处理的一个应用程序中，姓氏字段被认为是可靠的。因此将所有具有相同姓氏的所有记录呈现给用户。用户可以按其他字段排序以查找相似的名称。该解决方案足以大大减少用户创建重复记录的问题。

基本上看起来这个问题需要人工判断。

# flash - 将 SWF 和其他资源合并到一个 SWF 文件中

> ID：68444
> 
> 赞同：2
> 
> 时间：2008-09-16T01:10:33.580
> 
> 标签：flash

我们有一个程序，它可以生成多个 SWF 文件、一些 CSS 和 XML 文件，所有这些都需要部署才能使事物正常工作。

是否有将所有这些文件打包成一个 SWF 文件的程序或技术？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-10T20:27:47.133

如果您使用 Flex 编译器（`mxmlc`或 FlexBuilder），您可以嵌入 SWF 文件并在运行时创建它们，或多或少类似于创建任何显示对象：

```
package {

  public class Assets {

    [Embed(source="another.swf")]
    public var another : Class;

  }

} 
```

上面的代码嵌入了文件`another.swf`并可以在另一个 SWF 中创建它，如下所示：

```
package {

  import flash.display.Sprite;

  public class MyFancySite extends Sprite {

    public function MyFancySprite( ) {
      var theOther : DisplayObject = new Assets.another();

      addChild(theOther);
    }

  }

} 
```

CSS、XML 和任何其他文件都可以以类似的方式嵌入。这是一个描述： http://livedocs.adobe.com/flex/3/html/help.html?content= [embed_4.html](http://livedocs.adobe.com/flex/3/html/help.html?content=embed_4.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-07T13:24:10.107

您可以对所有这些文件使用 flex sdk 和 [EMBED] 标签，至于 xml 和 css，您可以在 flex 生成的包装器 swf 中编译它们。它的工作原理是拥有一个“骨架”mxml 文件，该文件将注入 css 和 xml，然后嵌入 swf 文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-12T09:05:21.253

using flex to easily embed them is a good way to go, and if that doesn't sound like fun, think of it this way - XML and CSS data is really just a big long string - so hard-code the string data as a variable inside of your project, and use it as normal.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-16T01:15:56.093

我认为您可以将它们拖到主 swf 的库中并引用它们。至少您可以使用其他 SWF，但不确定 CSS 和 XML。

# applescript - 如何通过 AppleScript 更改主显示？

> ID：68447
> 
> 赞同：8
> 
> 时间：2008-09-16T01:10:40.443
> 
> 标签：applescript

在“系统偏好设置”的“显示器”窗格中，我可以通过将菜单栏从一个显示器拖到另一个显示器来手动更改主显示器。我想将其自动化并使其成为 AppleScript 的一部分。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-12-15T09:46:49.660

显示由`/Library/Preferences/com.apple.windowserver.plist`首选项文件控制：

1.  一个标志控制主显示器是否是板载屏幕的`DisplayMainOnInternal`关键。
2.  该`DisplaySets`键包含显示集的列表。第一组是使用的（要检查的事实）。
3.  在集合中，每个项目都包含屏幕属性。该`IOFlags`键似乎表明显示器是主要显示器（值为 7）还是不是（值为 3）。

在使用 Apple Script 之前，您可以手动更改显示配置，并保存文件副本`/Library/Preferences/com.apple.windowserver.plist`以研究它。

***请注意，以下程序尚未经过测试！！！***

使用 AppleScript，plist 文件中的键会单独更改，以更改主显示：

1.  备份`/Library/Preferences/com.apple.windowserver.plist`（以防万一）
2.  使用命令更改显示设置选择主显示（`DisplaySets`和`IOFlags`键）`defaults`
3.  重新启动窗口服务器：`killall -KILL SystemUIServer`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2019-05-18T17:09:00.720

我编写的工具[displayplacer](https://github.com/jakehilborn/displayplacer)就是这样做的。

配置你喜欢的屏幕，在 macOS 系统设置中将“白条”拖到你的主屏幕，然后执行`displayplacer list`. 它将输出要运行的命令，以将您的屏幕置于其当前配置中。屏幕`origin:(0,0)`是带有“白条”的主显示屏。通过脚本、Automator、BetterTouchTool 等运行此终端命令。

示例配置文件 1 将白条放在左侧监视器的菜单栏上。 `displayplacer "id:<leftScreenId> res:1920x1080 scaling:on origin:(0,0) degree:0" "id:<rightScreenId> res:1920x1080 scaling:on origin:(1920,0) degree:0"`

示例配置文件 1 将白色条放在右侧显示器的菜单栏上。 `displayplacer "id:<leftScreenId> res:1920x1080 scaling:on origin:(1920,0) degree:0" "id:<rightScreenId> res:1920x1080 scaling:on origin:(0,0) degree:0"`

也可通过 Homebrew 获得`brew tap jakehilborn/jakehilborn && brew install displayplacer`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-12-12T23:06:35.963

你应该看看你是否可以通过 AppleScript 的用户界面脚本来做到这一点。它允许您操作应用程序的 GUI 元素；当应用程序不直接支持脚本时很有用。我会自己测试它，但我周围没有任何额外的显示器。

这是[MacTech 的一个很好的概述](http://www.mactech.com/articles/mactech/Vol.21/21.06/UserInterfaceScripting/index.html)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-16T08:11:37.500

就像您可以告诉 System Events.app 让您的 Mac 进入睡眠状态一样，您也可以让 Image Events.app 扰乱您的显示器。Image Events 应用程序提供了一个“显示”集合。每个显示器都有一个包含很多好东西的“配置文件”。但是，我刚刚提到的所有内容都是只读的，因此我没有从脚本中执行此操作的好方法。

您可能在 Automator 中运气更好——点击记录，运行系统偏好设置，转到显示，将菜单栏拖到另一个屏幕，然后点击停止。我敢打赌有些东西会奏效。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-12-15T23:29:22.440

使用 AppleScript，您可以调用`default`来编写更改主监视器的设置。

# svn - 如何在SVN中从一个分支合并到另一个分支并再次返回（双向合并）？

> ID：68448
> 
> 赞同：2
> 
> 时间：2008-09-16T01:11:14.733
> 
> 标签：svn, version-control

使用 svnmerge.py 工具可以在分支之间上下合并。很难找到这样做的细节。希望 v1.5 将有一个简洁的方法来做到这一点，而无需使用 svnmerge.py - 需要详细信息！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-16T01:22:45.767

看起来您在询问 1.5 合并跟踪。这是对主干（或其他分支）进行合并的快速概述：[http ://blog.red-bean.com/sussman/?p=92](http://blog.red-bean.com/sussman/?p=92)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-16T01:30:11.397

使用 svnmerge.py，您可以初始化两个分支（当朝一个方向前进时，您只需要初始化其中一个分支）。然后使用 -b （用于双向标志）合并。这是从分支一到分支二的总结。$REPO 是存储库的协议和路径。

> svn copy $REPO/branches/one $REPO/branches/two \
> -m "从分支一创建分支二。"
> svn checkout 分支/一一
> svn checkout 分支/二二
> 
> cd 一个 svnmerge init ../两个
> cd ../两个
> svnmerge init ../一个

您现在可以编辑两个分支。从一到二的更改可以通过以下方式合并：

> cd 两个
> svnmerge 合并 -b -S 一个
> svn commit -F svnmerge-commit-message.txt

相反，从二到一的更改可以通过以下方式合并：

> cd 一个
> svnmerge 合并 -b -S 两个
> svn 提交 -F svnmerge-commit-message.txt

请务必注意 -b 标志！

# asp.net-mvc - 有人在实时站点上使用 ASP.NET MVC 框架吗？

> ID：68456
> 
> 赞同：3
> 
> 时间：2008-09-16T01:12:26.587
> 
> 标签：asp.net-mvc, web-applications

准备好了吗？

我已经玩了很短的时间，这似乎很合理。有人将它用于实时网站吗？

有什么需要注意的问题吗？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-09-16T01:13:14.917

好吧，[stackoverflow.com](http://stackoverflow.com)是。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-16T01:13:32.090

是的，这个。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-16T01:44:17.900

是的，www.jobtree.com.au 是。在接下来的几天里，我还有另一个新网站 www.afterkickoff.com/football 正在使用它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-18T10:31:22.263

[http://weblogs.asp.net/mikebosch/archive/2008/05/05/gallery-of-live-asp-net-mvc-sites.aspx](http://weblogs.asp.net/mikebosch/archive/2008/05/05/gallery-of-live-asp-net-mvc-sites.aspx)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-18T18:13:00.907

我认为 StackOverflow 本身是建立在 ASP.NET MVC 之上的。只需阅读以下内容：http: [//haacked.com/archive/2008/09/15/stackoverflow-at-pdc.aspx](http://haacked.com/archive/2008/09/15/stackoverflow-at-pdc.aspx)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-06-26T12:13:36.407

我们在[伯明翰博物馆和美术馆的拉斐尔前派在线收藏](http://www.preraphaelites.org "拉斐尔前派收藏")中使用它，我们对结果非常满意。还使用我们定制的 Silverlight deepzoom..

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-16T07:24:23.197

您应该看看如何使 ASP.NET MVC 在您计划使用的特定版本的 IIS 上工作。[在http://www.asp.net/learn/mvc/tutorial-08-vb.aspx](http://www.asp.net/learn/mvc/tutorial-08-vb.aspx)上有一整页关于这个主题（使用 ASP.NET MVC 和不同版本的 IIS）

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-17T13:35:32.127

自预览版 2 以来，我一直在多个站点的生产环境中使用 ASP.NET MVC，并且随着每个版本的发布，它都变得越来越好。

最新版本（预览版 5）需要注意的一个问题是 VirtualPathProviderViewEngine 中存在一个错误，如果您在生产模式下运行（使用 <compilation debug="false" />），可能会导致呈现错误的视图. 有关更多信息，请参阅[MVC 论坛上的这篇文章](http://forums.asp.net/t/1316297.aspx)。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-18T18:16:37.777

请记住，asp.net MVC 是建立在坚实的 asp.net/.net 基础之上的，该基础已经得到充分证明，如果您愿意，您可以混合使用这些技术。除了学习曲线之外，我已经使用它没有任何问题。

我唯一要注意的是，目前，Telerik、ComponentArt 等第三方控件供应商并不能很好地与 MVC 配合使用。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-16T01:14:08.987

Stackoverflow 使用 ASP.Net MVC。根据我在网站上的经验，这里似乎做得很好。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-16T02:12:37.487

我没有任何用 ASP.NET MVC 编写的完整站点，但我有一个正在开发中，还有一些其他的在 MVC 中是理想的。

该产品是可靠的，您可以期待在未来几个月继续看到发展。您应该注意的唯一问题是代码可能会更改。尽管我确信它已经开始稳定下来，但您应该期望更新您的代码以适应这些变化。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-18T10:35:06.000

是的，我们最近使用 MonoRail 完成了一个站点，并且也拥有我们自己的专有 MVC 框架来生成内容。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-06-03T15:16:53.380

我们刚刚使用 ASP.NET MVC 部署了 www.homespothq.com。我对它的工作方式感到非常满意。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-06-30T02:17:04.320

我在一个大容量的私有站点上使用 ASP.NET-MVC，它的表现非常好。这种架构方法的组件分离非常吸引人。

# version-control - 重构和源代码控制：如何？

> ID：68459
> 
> 赞同：3
> 
> 时间：2008-09-16T01:12:56.523
> 
> 标签：version-control, refactoring, tdd

我完全赞同 TDD、重构和模式背后的想法，但是这些想法似乎确实存在巨大的差距，主要是它们非常适合 1 人的开发团队，但是当你开始重构代码时，10 人是处理您的工作时，您开始在各处遇到合并冲突，并且大多数 diff/merge 软件无法判断您将函数重构为自己的类。

你如何通过重构来清理你的代码，而不会给团队中的每个人带来严重的麻烦？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-16T01:17:57.527

经常提交的小改动。

至于您的示例，您将从创建类开始，提交该更改。然后在类中添加一个与旧函数类似的函数并提交该更改。然后将所有引用从旧函数更改为新的类函数，提交。然后删除旧函数并提交该更改。

当然，没有人说这会很容易。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-16T01:52:38.067

我认为你应该问一些问题来了解为什么重构会损害源代码控制。

*   为什么 10 个人同时更改相同的代码？
*   在进行重构/合并（可能是[分布式版本控制](http://www.infoq.com/articles/dvcs-guide)）时，有更好的工具可以帮助您吗？

对于第一个问题，可能你没有很好的关注点分离，代码是紧耦合的。或者，在分配任务时，团队可能没有很好地沟通。对于第二个问题，好吧，尝试一些好的 dvcs（[git](http://git.or.cz/)、[mercurial](http://www.selenic.com/mercurial/wiki/)、[bazaar](http://bazaar-vcs.org/)），看看是否有帮助。

亲切的问候

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-16T01:20:36.020

经常签到。团队成员应该每天**至少检查一次他们的更改并重新同步他们的沙箱。**随着更频繁的签入，合并冲突将更少发生，并且在发生时更易于管理。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-27T03:48:03.637

当我认为重构将难以合并时，我会这样做：

1.  警告我的团队即将发生更改，并检查是否有任何难以合并的待处理更改。
2.  确保我了解我将要做出的改变，这样我才能快速做出改变。如果需要，现在增强测试覆盖率。
3.  将我的机器同步到最新的源。
4.  重构、测试和提交。
5.  通知我的团队，以便他们可以同步我的更改。

请注意，我将重构更改与功能更改分开进行。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-16T01:16:37.293

好吧，在实践中，这很少成为问题。通常不同的团队成员在代码的不同区域工作，所以没有冲突。此外，大部分重构将在您进行 TDD 时进行（甚至可能在您签入代码之前，但最肯定的是在其他人开始使用和修改它之前）。

如果您发现由于重构而产生了很多冲突，请尝试更频繁地签入，或者让人们知道谁可能正在处理您即将进行一些重大返工的相同代码。沟通总是有帮助的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-16T01:27:39.983

我认为你的团队必须支持你的改变。如果您正在进行大型重构，对代码库和对象层次结构进行重大更改，您将希望作为一个团队讨论这些更改。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-16T01:30:10.443

根据我的经验，在对敏捷项目进行中小型重构时，合并冲突很少成为问题。大量的重构工作可能会引入一些合并的痛苦，但如果它以一口大小的块完成，则可以显着减少痛苦。使用 Subversion 作为 SCM 也可以减少合并的痛苦，因为 SVN 会自动合并非冲突的更改。

这种策略对于我参与过的团队来说效果很好，而且这些团队中的大多数都是 4 个以上的开发人员对。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-16T01:25:18.443

你必须从小而慢开始。取一部分代码并查看所有外部接口。你必须绝对确保这些不会改变。现在您已经定义了它，开始查看它的内部结构并慢慢改变它。您必须分小步进行工作并经常签入以避免大规模的合并冲突，这是您必须解决的最大问题之一。在这样规模的团队中，您永远无法检查所有内容并神奇地让他们变得更好。您可能想让人们提前知道您将要做什么。（无论如何，您应该始终计划好您要做什么）。如果其他人正在研究它，让他们知道会发生什么变化以及它将如何影响课堂等。

在你开始尝试之前，你要知道的最重要的事情是人们是否和你在一起。如果没有，它可能是一个失败的原因，并会引起冲突。在这种情况下，糟糕的代码和一个能够以这种方式理解混乱的运作团队可能比重构的代码更好。知道这是违反直觉的，但是我以前工作的老板是这样说的。他说代码很糟糕，但它可以工作，这里的开发人员知道它是如何工作的，这意味着使用它的 1000 人可以完成他们的工作，这意味着我们可以保留我们的工作。我们讨厌代码并想更改它，但他是对的。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-09-16T01:20:03.260

沟通。

工具无法为您解决这个问题，除非特定工具是您的电子邮件或 IM 客户端。

就像您在共享项目中进行任何其他重大更改一样 - 您需要能够告诉您的同事/合作者“嘿，放手几个小时，我对 FooBar 模块进行了重大更改在”。

或者，如果您要进行重大更改以致可能与其他 10 人的工作造成巨大的合并冲突，请事先由他们进行更改。进行代码审查。请求架构输入。然后，当您尽可能接近达成共识时，将虚拟锁锁定在您需要的存储库部分，签入您的更改，然后发出一个完全清除的消息。

这不是一个完美的解决方案，但它尽可能接近。许多源代码控制系统支持对源代码库的各个部分进行显式锁定，但我从未真正看到那些在这些领域产生好的结果。这是一个社会问题，如果你不能信任与你一起工作的人，你才真正需要求助于技术解决方案。

# python - 使用 POST 从 Python 脚本发送文件

> ID：68477
> 
> 赞同：162
> 
> 时间：2008-09-16T01:16:24.830
> 
> 标签：python, post, file-upload, http-post

有没有办法使用 Python 脚本中的 POST 发送文件？

* * *

## 回答 #1

> 赞同：236
> 
> 时间：2012-04-19T18:40:02.080

来自：[https ://requests.readthedocs.io/en/latest/user/quickstart/#post-a-multipart-encoded-file](https://requests.readthedocs.io/en/latest/user/quickstart/#post-a-multipart-encoded-file)

Requests 使上传多部分编码文件变得非常简单：

```
with open('report.xls', 'rb') as f:
    r = requests.post('http://httpbin.org/post', files={'report.xls': f}) 
```

而已。我不是在开玩笑——这是一行代码。文件已发送。让我们检查：

```
>>> r.text
{
  "origin": "179.13.100.4",
  "files": {
    "report.xls": "<censored...binary...data>"
  },
  "form": {},
  "url": "http://httpbin.org/post",
  "args": {},
  "headers": {
    "Content-Length": "3196",
    "Accept-Encoding": "identity, deflate, compress, gzip",
    "Accept": "*/*",
    "User-Agent": "python-requests/0.8.0",
    "Host": "httpbin.org:80",
    "Content-Type": "multipart/form-data; boundary=127.0.0.1.502.21746.1321131593.786.1"
  },
  "data": ""
} 
```

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2008-09-16T01:21:20.247

是的。您将使用该模块，并使用内容类型`urllib2`进行编码。`multipart/form-data`这里有一些示例代码可以帮助您入门——它不仅仅是文件上传，但您应该能够通读它并了解它是如何工作的：

```
user_agent = "image uploader"
default_message = "Image $current of $total"

import logging
import os
from os.path import abspath, isabs, isdir, isfile, join
import random
import string
import sys
import mimetypes
import urllib2
import httplib
import time
import re

def random_string (length):
    return ''.join (random.choice (string.letters) for ii in range (length + 1))

def encode_multipart_data (data, files):
    boundary = random_string (30)

    def get_content_type (filename):
        return mimetypes.guess_type (filename)[0] or 'application/octet-stream'

    def encode_field (field_name):
        return ('--' + boundary,
                'Content-Disposition: form-data; name="%s"' % field_name,
                '', str (data [field_name]))

    def encode_file (field_name):
        filename = files [field_name]
        return ('--' + boundary,
                'Content-Disposition: form-data; name="%s"; filename="%s"' % (field_name, filename),
                'Content-Type: %s' % get_content_type(filename),
                '', open (filename, 'rb').read ())

    lines = []
    for name in data:
        lines.extend (encode_field (name))
    for name in files:
        lines.extend (encode_file (name))
    lines.extend (('--%s--' % boundary, ''))
    body = '\r\n'.join (lines)

    headers = {'content-type': 'multipart/form-data; boundary=' + boundary,
               'content-length': str (len (body))}

    return body, headers

def send_post (url, data, files):
    req = urllib2.Request (url)
    connection = httplib.HTTPConnection (req.get_host ())
    connection.request ('POST', req.get_selector (),
                        *encode_multipart_data (data, files))
    response = connection.getresponse ()
    logging.debug ('response = %s', response.read ())
    logging.debug ('Code: %s %s', response.status, response.reason)

def make_upload_file (server, thread, delay = 15, message = None,
                      username = None, email = None, password = None):

    delay = max (int (delay or '0'), 15)

    def upload_file (path, current, total):
        assert isabs (path)
        assert isfile (path)

        logging.debug ('Uploading %r to %r', path, server)
        message_template = string.Template (message or default_message)

        data = {'MAX_FILE_SIZE': '3145728',
                'sub': '',
                'mode': 'regist',
                'com': message_template.safe_substitute (current = current, total = total),
                'resto': thread,
                'name': username or '',
                'email': email or '',
                'pwd': password or random_string (20),}
        files = {'upfile': path}

        send_post (server, data, files)

        logging.info ('Uploaded %r', path)
        rand_delay = random.randint (delay, delay + 5)
        logging.debug ('Sleeping for %.2f seconds------------------------------\n\n', rand_delay)
        time.sleep (rand_delay)

    return upload_file

def upload_directory (path, upload_file):
    assert isabs (path)
    assert isdir (path)

    matching_filenames = []
    file_matcher = re.compile (r'\.(?:jpe?g|gif|png)$', re.IGNORECASE)

    for dirpath, dirnames, filenames in os.walk (path):
        for name in filenames:
            file_path = join (dirpath, name)
            logging.debug ('Testing file_path %r', file_path)
            if file_matcher.search (file_path):
                matching_filenames.append (file_path)
            else:
                logging.info ('Ignoring non-image file %r', path)

    total_count = len (matching_filenames)
    for index, file_path in enumerate (matching_filenames):
        upload_file (file_path, index + 1, total_count)

def run_upload (options, paths):
    upload_file = make_upload_file (**options)

    for arg in paths:
        path = abspath (arg)
        if isdir (path):
            upload_directory (path, upload_file)
        elif isfile (path):
            upload_file (path)
        else:
            logging.error ('No such path: %r' % path)

    logging.info ('Done!') 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-07-08T22:51:47.043

看起来 python 请求不能处理非常大的多部分文件。

该文档建议您查看`requests-toolbelt`.

[这是他们文档中的相关页面](https://toolbelt.readthedocs.org/en/latest/uploading-data.html)。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2011-11-01T16:43:03.240

阻止您直接在文件对象上使用 urlopen 的唯一原因是内置文件对象缺少**len**定义。一个简单的方法是创建一个子类，它为 urlopen 提供正确的文件。我还修改了下面文件中的 Content-Type 标头。

```
import os
import urllib2
class EnhancedFile(file):
    def __init__(self, *args, **keyws):
        file.__init__(self, *args, **keyws)

    def __len__(self):
        return int(os.fstat(self.fileno())[6])

theFile = EnhancedFile('a.xml', 'r')
theUrl = "http://example.com/abcde"
theHeaders= {'Content-Type': 'text/xml'}

theRequest = urllib2.Request(theUrl, theFile, theHeaders)

response = urllib2.urlopen(theRequest)

theFile.close()

for line in response:
    print line 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-08T05:20:36.840

Chris Atlee 的[海报](http://atlee.ca/software/poster/)库对此非常有效（尤其是便利功能`poster.encode.multipart_encode()`）。作为奖励，它支持大文件的流式传输，而无需将整个文件加载到内存中。另请参阅[Python 问题 3244](http://bugs.python.org/issue3244)。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-05-10T15:23:21.690

我正在尝试测试 django rest api 及其对我的工作：

```
def test_upload_file(self):
        filename = "/Users/Ranvijay/tests/test_price_matrix.csv"
        data = {'file': open(filename, 'rb')}
        client = APIClient()
        # client.credentials(HTTP_AUTHORIZATION='Token ' + token.key)
        response = client.post(reverse('price-matrix-csv'), data, format='multipart')

        print response
        self.assertEqual(response.status_code, status.HTTP_200_OK) 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-04-26T20:34:56.333

`pip install http_file`

```
#импорт вспомогательных библиотек
import urllib3
urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)
import requests
#импорт http_file
from http_file import download_file
#создание новой сессии
s = requests.Session()
#соеденение с сервером через созданную сессию
s.get('URL_MAIN', verify=False)
#загрузка файла в 'local_filename' из 'fileUrl' через созданную сессию
download_file('local_filename', 'fileUrl', s) 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-16T18:03:09.857

You may also want to have a look at [httplib2](http://code.google.com/p/httplib2/), with [examples](http://bitworking.org/projects/httplib2/doc/html/libhttplib2.html#examples). I find using httplib2 is more concise than using the built-in HTTP modules.

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-03-18T06:59:16.480

```
def visit_v2(device_code, camera_code):
    image1 = MultipartParam.from_file("files", "/home/yuzx/1.txt")
    image2 = MultipartParam.from_file("files", "/home/yuzx/2.txt")
    datagen, headers = multipart_encode([('device_code', device_code), ('position', 3), ('person_data', person_data), image1, image2])
    print "".join(datagen)
    if server_port == 80:
        port_str = ""
    else:
        port_str = ":%s" % (server_port,)
    url_str = "http://" + server_ip + port_str + "/adopen/device/visit_v2"
    headers['nothing'] = 'nothing'
    request = urllib2.Request(url_str, datagen, headers)
    try:
        response = urllib2.urlopen(request)
        resp = response.read()
        print "http_status =", response.code
        result = json.loads(resp)
        print resp
        return result
    except urllib2.HTTPError, e:
        print "http_status =", e.code
        print e.read() 
```

# jquery - How to show loading spinner in jQuery?

> ID：68485
> 
> 赞同：429
> 
> 时间：2008-09-16T01:18:15.590
> 
> 标签：jquery, spinner, prototypejs, equivalence, language-interoperability

In **Prototype** I can show a "loading..." image with this code:

```
var myAjax = new Ajax.Request( url, {method: 'get', parameters: pars, 
onLoading: showLoad, onComplete: showResponse} );

function showLoad () {
    ...
} 
```

In **jQuery**, I can load a server page into an element with this:

```
$('#message').load('index.php?pg=ajaxFlashcard'); 
```

but how do I attach a loading spinner to this command as I did in Prototype?

* * *

## 回答 #1

> 赞同：821
> 
> 时间：2008-09-16T01:21:26.487

There are a couple of ways. My preferred way is to attach a function to the ajaxStart/Stop events on the element itself.

```
$('#loadingDiv')
    .hide()  // Hide it initially
    .ajaxStart(function() {
        $(this).show();
    })
    .ajaxStop(function() {
        $(this).hide();
    })
; 
```

The ajaxStart/Stop functions will fire whenever you do any Ajax calls.

**Update**: As of jQuery 1.8, the documentation states that `.ajaxStart/Stop` should only be attached to `document`. This would transform the above snippet to:

```
var $loading = $('#loadingDiv').hide();
$(document)
  .ajaxStart(function () {
    $loading.show();
  })
  .ajaxStop(function () {
    $loading.hide();
  }); 
```

* * *

## 回答 #2

> 赞同：229
> 
> 时间：2010-03-05T15:12:31.163

For jQuery I use

```
jQuery.ajaxSetup({
  beforeSend: function() {
     $('#loader').show();
  },
  complete: function(){
     $('#loader').hide();
  },
  success: function() {}
}); 
```

* * *

## 回答 #3

> 赞同：56
> 
> 时间：2012-08-30T05:37:28.507

You can just use the jQuery's `.ajax` function and use its option `beforeSend` and define some function in which you can show something like a loader div and on success option you can hide that loader div.

```
jQuery.ajax({
    type: "POST",
    url: 'YOU_URL_TO_WHICH_DATA_SEND',
    data:'YOUR_DATA_TO_SEND',
    beforeSend: function() {
        $("#loaderDiv").show();
    },
    success: function(data) {
        $("#loaderDiv").hide();
    }
}); 
```

You can have any Spinning Gif image. Here is a website that is a great AJAX Loader Generator according to your color scheme: [http://ajaxload.info/](http://ajaxload.info/)

* * *

## 回答 #4

> 赞同：25
> 
> 时间：2008-09-16T01:28:12.460

You can insert the animated image into the DOM right before the AJAX call, and do an inline function to remove it...

```
$("#myDiv").html('<img src="images/spinner.gif" alt="Wait" />');
$('#message').load('index.php?pg=ajaxFlashcard', null, function() {
  $("#myDiv").html('');
}); 
```

This will make sure your animation starts at the same frame on subsequent requests (if that matters). Note that old versions of IE *might* have difficulties with the animation.

Good luck!

* * *

## 回答 #5

> 赞同：24
> 
> 时间：2013-06-05T11:09:43.653

If you are using `$.ajax()` you can use somthing like this:

```
$.ajax({
  url: "destination url",
  success: sdialog,
  error: edialog,
  // shows the loader element before sending.
  beforeSend: function() {
    $("#imgSpinner1").show();
  },
  // hides the loader after completion of request, whether successfull or failor.             
  complete: function() {
    $("#imgSpinner1").hide();
  },
  type: 'POST',
  dataType: 'json'
}); 
```

Although the setting is named "beforeSend", as of [jQuery 1.5 "beforeSend" will be called regardless of the request type.](https://api.jquery.com/jQuery.ajax/) i.e. The `.show()` function will be called if `type: 'GET'`.

* * *

## 回答 #6

> 赞同：21
> 
> 时间：2008-09-16T01:23:33.410

```
$('#message').load('index.php?pg=ajaxFlashcard', null, showResponse);
showLoad();

function showResponse() {
    hideLoad();
    ...
} 
```

[http://docs.jquery.com/Ajax/load#urldatacallback](http://docs.jquery.com/Ajax/load#urldatacallback)

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2009-07-29T16:16:14.657

Use the loading plugin: [http://plugins.jquery.com/project/loading](http://plugins.jquery.com/project/loading)

```
$.loading.onAjax({img:'loading.gif'}); 
```

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2011-05-02T22:41:38.360

Variant: I have an icon with id="logo" at the top left of the main page; a spinner gif is then overlaid on top (with transparency) when ajax is working.

```
jQuery.ajaxSetup({
  beforeSend: function() {
     $('#logo').css('background', 'url(images/ajax-loader.gif) no-repeat')
  },
  complete: function(){
     $('#logo').css('background', 'none')
  },
  success: function() {}
}); 
```

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2013-04-02T11:48:48.443

I ended up with two changes to the [original reply](https://stackoverflow.com/a/68503/117268).

1.  As of jQuery 1.8, ajaxStart and ajaxStop should only be attached to `document`. This makes it harder to filter only a some of the ajax requests. Soo...
2.  Switching to [ajaxSend](http://api.jquery.com/ajaxSend/) and [ajaxComplete](http://api.jquery.com/ajaxComplete/) makes it possible to interspect the current ajax request before showing the spinner.

This is the code after these changes:

```
$(document)
    .hide()  // hide it initially
    .ajaxSend(function(event, jqxhr, settings) {
        if (settings.url !== "ajax/request.php") return;
        $(".spinner").show();
    })
    .ajaxComplete(function(event, jqxhr, settings) {
        if (settings.url !== "ajax/request.php") return;
        $(".spinner").hide();
    }) 
```

* * *

## 回答 #10

> 赞同：9
> 
> 时间：2014-02-21T09:17:49.930

I also want to contribute to this answer. I was looking for something similar in jQuery and this what I eventually ended up using.

I got my loading spinner from [http://ajaxload.info/](http://ajaxload.info/). My solution is based on this simple answer at [http://christierney.com/2011/03/23/global-ajax-loading-spinners/](http://christierney.com/2011/03/23/global-ajax-loading-spinners/).

Basically your HTML markup and CSS would look like this:

```
<style>
     #ajaxSpinnerImage {
          display: none;
     }
</style>

<div id="ajaxSpinnerContainer">
     <img src="~/Content/ajax-loader.gif" id="ajaxSpinnerImage" title="working..." />
</div> 
```

And then you code for jQuery would look something like this:

```
<script>
     $(document).ready(function () {
          $(document)
          .ajaxStart(function () {
               $("#ajaxSpinnerImage").show();
          })
          .ajaxStop(function () {
               $("#ajaxSpinnerImage").hide();
          });

          var owmAPI = "http://api.openweathermap.org/data/2.5/weather?q=London,uk&APPID=YourAppID";
          $.getJSON(owmAPI)
          .done(function (data) {
               alert(data.coord.lon);
          })
          .fail(function () {
               alert('error');
          });
     });
</script> 
```

It is as simple as that :)

* * *

## 回答 #11

> 赞同：8
> 
> 时间：2011-09-12T14:26:31.683

You can simply assign a loader image to the same tag on which you later will load content using an Ajax call:

```
$("#message").html('<span>Loading...</span>');

$('#message').load('index.php?pg=ajaxFlashcard'); 
```

You can also replace the span tag with an image tag.

* * *

## 回答 #12

> 赞同：7
> 
> 时间：2012-09-04T16:51:37.173

As well as setting global defaults for ajax events, you can set behaviour for specific elements. Perhaps just changing their class would be enough?

```
$('#myForm').ajaxSend( function() {
    $(this).addClass('loading');
});
$('#myForm').ajaxComplete( function(){
    $(this).removeClass('loading');
}); 
```

Example CSS, to hide #myForm with a spinner:

```
.loading {
    display: block;
    background: url(spinner.gif) no-repeat center middle;
    width: 124px;
    height: 124px;
    margin: 0 auto;
}
/* Hide all the children of the 'loading' element */
.loading * {
    display: none;  
} 
```

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2014-10-23T07:20:30.977

Note that you must use asynchronous calls for spinners to work (at least that is what caused mine to not show until after the ajax call and then swiftly went away as the call had finished and removed the spinner).

```
$.ajax({
        url: requestUrl,
        data: data,
        dataType: 'JSON',
        processData: false,
        type: requestMethod,
        async: true,                         <<<<<<------ set async to true
        accepts: 'application/json',
        contentType: 'application/json',
        success: function (restResponse) {
            // something here
        },
        error: function (restResponse) {
            // something here                
        }
    }); 
```

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2016-10-11T17:17:25.940

```
$('#loading-image').html('<img src="/images/ajax-loader.gif"> Sending...');

        $.ajax({
            url:  uri,
            cache: false,
            success: function(){
                $('#loading-image').html('');           
            },

           error:   function(jqXHR, textStatus, errorThrown) {
            var text =  "Error has occured when submitting the job: "+jqXHR.status+ " Contact IT dept";
           $('#loading-image').html('<span style="color:red">'+text +'  </span>');

            }
        }); 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2008-10-26T20:23:40.450

### JavaScript

```
$.listen('click', '#captcha', function() {
    $('#captcha-block').html('<div id="loading" style="width: 70px; height: 40px; display: inline-block;" />');
    $.get("/captcha/new", null, function(data) {
        $('#captcha-block').html(data);
    }); 
    return false;
}); 
```

### CSS

```
#loading { background: url(/image/loading.gif) no-repeat center; } 
```

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2011-12-02T17:55:44.740

I've used the following with jQuery UI Dialog. (Maybe it works with other ajax callbacks?)

```
$('<div><img src="/i/loading.gif" id="loading" /></div>').load('/ajax.html').dialog({
    height: 300,
    width: 600,
    title: 'Wait for it...'
}); 
```

The contains an animated loading gif until its content is replaced when the ajax call completes.

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2013-11-11T15:48:22.167

This is the best way for me:

**jQuery**:

```
$(document).ajaxStart(function() {
  $(".loading").show();
});

$(document).ajaxStop(function() {
  $(".loading").hide();
}); 
```

**Coffee**:

```
 $(document).ajaxStart ->
    $(".loading").show()

  $(document).ajaxStop ->
    $(".loading").hide() 
```

Docs: [ajaxStart](http://api.jquery.com/ajaxStart/), [ajaxStop](http://api.jquery.com/ajaxStop/)

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2016-12-06T16:39:58.443

This is a very simple and smart plugin for that specific purpose: [https://github.com/hekigan/is-loading](https://github.com/hekigan/is-loading)

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2011-09-29T12:46:35.610

I do this:

```
var preloaderdiv = '<div class="thumbs_preloader">Loading...</div>';
           $('#detail_thumbnails').html(preloaderdiv);
             $.ajax({
                        async:true,
                        url:'./Ajaxification/getRandomUser?top='+ $(sender).css('top') +'&lef='+ $(sender).css('left'),
                        success:function(data){
                            $('#detail_thumbnails').html(data);
                        }
             }); 
```

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2012-07-12T15:12:40.837

I think you are right. This method is too global...

However - it is a good default for when your AJAX call has no effect on the page itself. (background save for example). ( you can always switch it off for a certain ajax call by passing "global":false - see documentation at [jquery](http://api.jquery.com/jQuery.ajax/)

When the AJAX call is meant to refresh part of the page, I like my "loading" images to be specific to the refreshed section. I would like to see which part is refreshed.

Imagine how cool it would be if you could simply write something like :

```
$("#component_to_refresh").ajax( { ... } ); 
```

And this would show a "loading" on this section. Below is a function I wrote that handles "loading" display as well but it is specific to the area you are refreshing in ajax.

First, let me show you how to use it

```
<!-- assume you have this HTML and you would like to refresh 
      it / load the content with ajax -->

<span id="email" name="name" class="ajax-loading">
</span>

<!-- then you have the following javascript --> 

$(document).ready(function(){
     $("#email").ajax({'url':"/my/url", load:true, global:false});
 }) 
```

And this is the function - a basic start that you can enhance as you wish. it is very flexible.

```
jQuery.fn.ajax = function(options)
{
    var $this = $(this);
    debugger;
    function invokeFunc(func, arguments)
    {
        if ( typeof(func) == "function")
        {
            func( arguments ) ;
        }
    }

    function _think( obj, think )
    {
        if ( think )
        {
            obj.html('<div class="loading" style="background: url(/public/images/loading_1.gif) no-repeat; display:inline-block; width:70px; height:30px; padding-left:25px;"> Loading ... </div>');
        }
        else
        {
            obj.find(".loading").hide();
        }
    }

    function makeMeThink( think )
    {
        if ( $this.is(".ajax-loading") )
        {
            _think($this,think);
        }
        else
        {
            _think($this, think);
        }
    }

    options = $.extend({}, options); // make options not null - ridiculous, but still.
    // read more about ajax events
    var newoptions = $.extend({
        beforeSend: function()
        {
            invokeFunc(options.beforeSend, null);
            makeMeThink(true);
        },

        complete: function()
        {
            invokeFunc(options.complete);
            makeMeThink(false);
        },
        success:function(result)
        {
            invokeFunc(options.success);
            if ( options.load )
            {
                $this.html(result);
            }
        }

    }, options);

    $.ajax(newoptions);
}; 
```

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2013-04-09T16:08:17.840

If you don't want to write your own code, there are also a lot of plugins that do just that:

*   [https://github.com/keithhackbarth/jquery-loading](https://github.com/keithhackbarth/jquery-loading)
*   [http://plugins.jquery.com/project/loading](http://plugins.jquery.com/project/loading)

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2016-03-03T21:09:55.407

If you plan to use a loader everytime you make a server request, you can use the following pattern.

```
 jTarget.ajaxloader(); // (re)start the loader
 $.post('/libs/jajaxloader/demo/service/service.php', function (content) {
     jTarget.append(content); // or do something with the content
 })
 .always(function () {
     jTarget.ajaxloader("stop");
 }); 
```

This code in particular uses the jajaxloader plugin (which I just created)

[https://github.com/lingtalfi/JAjaxLoader/](https://github.com/lingtalfi/JAjaxLoader/)

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2018-06-04T10:44:43.280

My ajax code looks like this, in effect, I have just commented out async: false line and the spinner shows up.

```
$.ajax({
        url: "@Url.Action("MyJsonAction", "Home")",
        type: "POST",
        dataType: "json",
        data: {parameter:variable},
        //async: false, 

        error: function () {
        },

        success: function (data) {
          if (Object.keys(data).length > 0) {
          //use data 
          }
          $('#ajaxspinner').hide();
        }
      }); 
```

I am showing the spinner within a function before the ajax code:

```
$("#MyDropDownID").change(function () {
        $('#ajaxspinner').show(); 
```

For Html, I have used a font awesome class:

`<i id="ajaxspinner" class="fas fa-spinner fa-spin fa-3x fa-fw" style="display:none"></i>`

Hope it helps someone.

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2017-08-15T16:10:58.753

You can always use [Block UI jQuery plugin](http://malsup.com/jquery/block/#overview) which does everything for you, and it even blocks the page of any input while the ajax is loading. In case that the plugin seems to not been working, you can read about the right way to use it [in this answer.](https://stackoverflow.com/questions/29796115/jquery-blockui-not-working) Check it out.

# email - 如何通过垃圾邮件过滤器？

> ID：68495
> 
> 赞同：0
> 
> 时间：2008-09-16T01:19:52.887
> 
> 标签：email, email-bounces

我上周发送了 3 封电子邮件作为我们网站的回复。没有人收到！一个是雅虎、hotmail 和一个海外域。我想知道是否以我们的域名作为用户开设一个雅虎帐户只是为了回复潜在买家不是一个好主意。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-16T01:53:54.473

If your email is business critical, then you need to get a dedicated server with a white-hat hosting company, control over DNS to set up your SPF/SenderID record, and to register with the Hotmail, AOL and Yahoo postmasters for whitelisting and feedback loops. Most of these will only accept requests for dedicated servers, where you have 100% control over the email they send.

If you are using an online contact form, make people double-enter their email address and check the entries match - otherwise you'll have no end of typos, which are naturally undeliverable and frustrating for both you and your customers.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-16T01:21:57.297

您的邮件服务器的 IP 可能已被列入黑名单。这在共享服务器上很常见。 [http://www.mxtoolbox.com/blacklists.aspx](http://www.mxtoolbox.com/blacklists.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-16T01:22:02.553

首先，检查[dnsbl.info](http://www.dnsbl.info/advanced.asp)以查看您的邮件服务器的 IP 是否被任何黑名单阻止。如果是，请联系黑名单管理员调查是否删除了该阻止。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-16T01:24:52.267

您也可以尝试查看[域名的 gmail](http://www.google.com/apps/intl/en/business/index.html)。这是我使用的，到目前为止我还没有遇到任何垃圾邮件过滤器的问题。还要确保您没有将邮件内容写入垃圾邮件过滤器可能将其标记为垃圾邮件的位置。网上某处有一些指南。我发现，通过从邮件中删除“免费”一词，电子邮件开始发送（在我使用 gmail 之前）。

# asp.net - 您的 aspx 页面中的内联代码是一种好习惯吗？

> ID：68509
> 
> 赞同：7
> 
> 时间：2008-09-16T01:22:23.583
> 
> 标签：asp.net, coding-style

如果我使用以下代码，我将无法右键单击后面代码中的变量并重构（在本例中为重命名）它们

```
<a href='<%# "/Admin/Content/EditResource.aspx?ResourceId=" + Eval("Id").ToString() %>'>Edit</a> 
```

我到处都看到这种做法，但对我来说这似乎很奇怪，因为如果我更改属性名称，我将不再能够获得编译时错误。我的首选方法是做这样的事情

```
<a runat="server" id="MyLink">Edit</a> 
```

然后在后面的代码中

```
MyLink.Href= "/Admin/Content/EditResource.aspx?ResourceId=" + myObject.Id; 
```

我真的很想知道人们是否认为上述方法更好，因为这是我在流行的编码网站和博客（例如 Scott Guthrie）上经常看到的，而且它的代码更小，但我倾向于使用 ASP.NET，因为它是经过编译和更愿意知道在编译时是否有问题，而不是在运行时。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-16T01:25:32.170

我不会将其称为不好的做法（有些人会不同意，但为什么他们首先给了我们这个选项？），但我会说如果你不接受这种做法，你会提高整体的可读性和可维护性。您已经传达了一个很好的观点，那就是 IDE 功能限制（即设计时检查、编译时警告等）。

我可以继续讨论它违反了多少原则（代码重用、关注点分离等），但我可以想到许多应用程序几乎违反了所有原则，但几年后仍然有效。一方面，我更喜欢使我的代码尽可能模块化和可维护。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-16T01:25:40.113

它被称为意大利面条代码，许多程序员觉得它令人反感……再说一次，如果您和您公司的其他开发人员发现它可读且可维护，我该告诉您该怎么做。

不过可以肯定的是，使用包含来减少冗余（DRY - 不要重复自己）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-16T02:22:47.010

我只是偶尔使用它，通常是出于某种特殊原因。我将永远是一个更快乐的开发人员，我的代码完全与我的 HTML 标记分离。这在某种程度上是个人喜好，但我会说这是一种更好的做法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-16T01:30:09.320

由你决定。有时“spagehetti”代码比为简单的事情构建/使用完整的模板系统更容易维护，但是一旦你得到相当复杂的页面，或者更具体地说，一旦你开始在页面本身中包含很多逻辑，它就可以得到脏得真快。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-16T02:16:34.483

我认为有趣的是更多的 asp.net 需要在 aspx 页面中的代码。3.5 中的列表视图，甚至是 ASP.NET MVC。MVC 后面基本上没有代码，而是在页面中呈现信息的代码。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-16T02:33:36.453

如果您从模板开发的角度考虑它，那么将其保留在视图中而不是隐藏在代码中是明智的。如果需要使用不显眼的 JS 将锚点更改为列表项来处理点击怎么办？是的，这不是最好的例子，而只是那个例子。

我总是试着思考如果我有一个设计师（HTML，CSS，任何东西），我会让他做什么，我会在后面的代码中做什么，以及我们如何不踩到对方的脚趾。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-16T02:36:41.190

如果你不能很好地封装它，它只是一个不好的做法。

像其他所有东西一样，您可以创建令人讨厌的、不可读的意大利面条代码，但现在您可以使用标签来满足需求，而这些标签在设计上并不是世界上最易读的东西。

我尝试将大量 if 保留在 hte 模板之外，但过度封装导致不得不查看 13 个不同的地方以查看为什么 div x 没有向客户端触发，因此这是一种权衡。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-16T02:45:23.150

它不是，但有时它是一种必要的邪恶。

以你的情况为例，虽然后面的代码似乎有更好的关注点分离，但它的问题是它可能无法像你希望的那样清楚地分离出关注点。通常，当我们编写代码背后的东西时，我们并不是在 MVC 框架中构建应用程序。无论如何，代码背后的代码也不容易维护和测试，至少与 MVC 相比是这样。

如果您正在构建 ASP.NET MVC 应用程序，那么我认为您肯定会被内联代码所困扰。但是就可维护性和可测试性而言，以 MVC 模式构建是最好的方法。

总而言之：内联代码不是一个好的做法，但它是一个必要的邪恶。

我的 2 美分。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-16T07:36:00.847

通常我是这样使用的。

```
<a href='<%# DataBinder.Eval(Container.DataItem,"Id",""/Admin/Content/EditResource.aspx?ResourceId={0}") %'> 
```

# java - 我应该为我的业务层使用 EJB3 还是 Spring？

> ID：68527
> 
> 赞同：73
> 
> 时间：2008-09-16T01:25:16.790
> 
> 标签：java, performance, spring, ejb-3.0, scalability

我的团队正在开发一种带有 Web 前端的面向服务的新产品。在讨论我们将使用什么技术时，我们决定运行 JBoss 应用程序服务器、Flex 前端（可能使用 Adob​​e AIR 进行桌面部署）以及连接客户端和服务器的 Web 服务。

在为我们的业务逻辑使用哪种服务器技术时，我们陷入了僵局。最大的争论是在 EJB3 和 Spring 之间，我们最大的担忧是可伸缩性和性能，以及代码库的可维护性。

以下是我的问题：

1.  支持或反对 EJB3 与 Spring 的论点是什么？
    *   我可以期待每个陷阱有哪些陷阱？
    *   我在哪里可以找到好的基准信息？

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2008-09-16T12:07:55.187

基于性能的 EJB3 和 Spring 之间不会有太大区别。我们选择 Spring 的原因如下（问题中未提及）：

*   Spring 推动架构朝着更容易支持单元测试的方向发展。例如，注入一个模拟 DAO 对象对您的业务层进行单元测试，或者利用 Spring 的 MockHttpRequest 对象对一个 servlet 进行单元测试。我们为单元测试维护一个单独的 Spring 配置，允许我们将测试隔离到特定层。
*   最重要的驱动程序是兼容性。如果您需要支持多个 App Server（或最终希望选择从 JBoss 迁移到 Glassfish 等），您基本上将随身携带容器（Spring），而不是依赖于不同实现之间的兼容性EJB3 规范。
*   Spring 允许对 Persistence、对象远程处理等技术进行选择。例如，我们还使用 Flex 前端，并使用 Hessian 协议在 Flex 和 Spring 之间进行通信。

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2008-12-05T13:29:19.713

显然，EJB3 和 Spring 之间的差距比以前要小得多。也就是说，现在 EJB3 的一个缺点是您只能注入到 bean 中，因此您最终可以将组件转换为不需要的 bean。

现在关于单元测试的争论已经无关紧要了——EJB3 显然被设计成更容易进行单元测试。

上面的兼容性论点也有点无关紧要：无论您使用 EJB3 还是 Spring，您仍然依赖于第 3 方提供的事务管理器、JMS 等的实现。

然而，对我来说，能动摇它的是社区的支持。去年在一个 EJB3 项目上工作，只是没有很多人在那里使用它并谈论他们的问题。无论对错，Spring 在企业中都非常普遍，特别是，这使得找到遇到与您要解决的相同问题的人变得更加容易。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2008-09-16T04:49:50.137

**支持或反对 EJB3 与 Spring 的论点是什么？** Spring 始终在创新并认识到现实世界的限制。Spring 为 Java 1.4 应用程序服务器提供了简单和优雅，并且不需要在 2004 年至 2006 年期间没有人可以访问的 J2EE 规范版本。在这一点上，它几乎是一场你可以陷入的宗教辩论 - Spring + 抽象 + 开源与 Java Enterprise Edition (Java EE) 5.0 规范。

我认为 Spring 对 Java EE 规范的**补充不仅仅是竞争。**随着 Spring 曾经独有的特性继续被纳入规范，许多人会争辩说 EJB 3 为大多数内部业务应用程序提供了“足够好”的特性集。

**我可以期待每个陷阱有哪些陷阱？** 如果您将此视为持久性问题（Spring+JPA）与 EJB3，那么您真的不会做出那么大的选择。

**我在哪里可以找到好的基准信息？** 我有一段时间没有关注[specj 基准测试结果](http://www.spec.org/jAppServer2004/results/jAppServer2004.html)，但它们流行了一段时间。似乎每个供应商（IBM、JBOSS、Oracle 和 Sun）对拥有兼容的服务器越来越不感兴趣。随着您从 1.3、1.4 开始，列表会越来越短。1.5 Java 企业版。我认为完全符合所有规范的巨型服务器的时代已经结束。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-09-16T02:09:48.337

我肯定会在春季推荐 EJB3。我们发现它更精简、更好地编写代码并且得到更好的支持。我过去使用过 Spring，发现它非常令人困惑，并且没有 EJB3（或者我猜在一天结束时的 JPA）那样有文档记录

1.  从 EJB3 开始，您不再需要处理外部配置文件，并且每个数据库表只需注释一个 POJO。这个 POJO 可以毫无问题地传递到您的 Web 层。像 Netbeans 这样的 IDE 甚至可以为您自动生成这些 POJO。我们现在已经使用 EJB3 作为很多大型应用程序的后端，并且没有发现任何性能问题。您的会话 Bean 可以很容易地公开为您可以公开给 Flex 前端的 Web 服务。如果需要，会话 bean 很容易在方法或类级别锁定以分配角色和类似的东西。

我不能说太多关于春天的事，因为我只尝试了几个星期。但我对它的总体印象很差。这并不意味着它是一个糟糕的框架，但我们这里的团队发现 EJB3 是持久性/业务层的最佳选择。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-09-16T16:06:11.743

我倾向于选择 Spring 而不是 EJB3，但我的建议是无论您采用哪种方法，都尽量坚持编写 POJO 并尽可能使用标准注解，例如与 EJB3 一起使用的 @PostConstruct、@PreDestroy 和 @Resource 等 JSR 注解或 Spring，因此您可以选择您喜欢的任何框架。

例如，您可以决定在某个项目上使用 Guice 代替 IoC。

如果您想在 Web 应用程序中使用预请求注入，您可能会发现 Guice 的依赖注入比 Spring 快得多。

会话 bean 主要归结为依赖注入和事务；所以 EJB3 和 Spring 确实有点相似。Spring 的优势在于更好的依赖注入和对 JMS 之类的更好的抽象

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-16T05:27:56.287

我过去使用过非常相似的架构。Spring + Java 1.5 + Actionscript 2/3 与 Flex Data Services 结合使用后，编写代码变得非常简单（而且有趣！）。不过，Flex 前端意味着您需要足够强大的客户端机器。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-01-04T02:07:05.507

关于你的问题：

> 支持或反对 EJB3 与 Spring 的论点是什么？

我建议阅读专家的回复：[A RESPONSE TO: EJB 3 AND SPRING COMPARATIVE ANALYSIS by Mark Fisher](http://blog.springsource.org/2007/11/09/a-response-to-ejb-3-and-spring-comparative-analysis/)。阅读评论以找到 Reza Rahman 的评论 (EJB 3.0)。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-05T14:32:12.130

支持 spring 的另一件事是大多数其他工具/框架对与 spring 的集成都有更好的支持，其中大多数也在内部使用 spring（例如 activemq、camel、CXF 等）。

它也比 EJB3 更成熟，有更多的资源（书籍、文章、最佳实践等）和有经验的开发人员可用。

* * *

## 回答 #9

> 赞同：-3
> 
> 时间：2011-02-22T02:16:39.220

我认为 EJB 是一个很好的组件技术，但不是一个很好的框架。Spring 是目前可用的最好的框架。所以我应该将 Spring 视为框架意义上的 JEE 的最佳实现，我的建议是在每个框架中都使用 spring该项目使我们能够灵活地轻松与任何组件技术集成。

# c# - 关于具有许多不同子类的类型切片的设计问题

> ID：68537
> 
> 赞同：3
> 
> 时间：2008-09-16T01:27:15.193
> 
> 标签：c#, design-patterns, type-slicing

我经常遇到的一个基本问题，但曾经找到一个干净的解决方案，就是你想要为公共基类或接口的不同对象之间的交互编写行为代码。为了使其更具体，我将举一个例子；

*Bob 一直在编写一款支持“酷地理效应”的策略游戏。这些都是简单的限制，例如如果部队在水中行走，他们会减慢 25%。如果他们在草地上行走，他们会减慢 5%，如果他们在人行道上行走，他们会减慢 0%。*

*现在，管理层告诉鲍勃他们需要新的部队。会有吉普车、船和气垫船。此外，他们希望吉普车在驶入水中时受到伤害，而气垫船将忽略所有三种地形类型。也有传言说他们可能会添加另一种地形类型，其功能比减缓单位减速和受到伤害还要多。*

一个非常粗略的伪代码示例如下：

```
public interface ITerrain
{
    void AffectUnit(IUnit unit);
}

public class Water : ITerrain
{
    public void AffectUnit(IUnit unit)
    {
        if (unit is HoverCraft)
        {
            // Don't affect it anyhow
        }
        if (unit is FootSoldier)
        {
            unit.SpeedMultiplier = 0.75f;
        }
        if (unit is Jeep)
        {
            unit.SpeedMultiplier = 0.70f;
            unit.Health -= 5.0f;
        }
        if (unit is Boat)
        {
            // Don't affect it anyhow
        }
        /*
         * List grows larger each day...
         */
    }
}
public class Grass : ITerrain
{
    public void AffectUnit(IUnit unit)
    {
        if (unit is HoverCraft)
        {
            // Don't affect it anyhow
        }
        if (unit is FootSoldier)
        {
            unit.SpeedMultiplier = 0.95f;
        }
        if (unit is Jeep)
        {
            unit.SpeedMultiplier = 0.85f;
        }
        if (unit is Boat)
        {
            unit.SpeedMultiplier = 0.0f;
            unit.Health = 0.0f;
            Boat boat = unit as Boat;
            boat.DamagePropeller();
            // Perhaps throw in an explosion aswell?
        }
        /*
         * List grows larger each day...
         */
    }
} 
```

如您所见，如果 Bob 从一开始就有可靠的设计文档，情况会更好。随着单位数量和地形类型的增加，代码的复杂性也在增加。Bob 不仅需要担心确定哪些成员可能需要添加到单元界面，而且他还必须重复大量代码。新的地形类型很可能需要从基本 IUnit 接口获得的附加信息。

每次我们在游戏中添加另一个单位时，都必须更新每个地形以处理新单位。显然，这会导致大量重复，更不用说丑陋的运行时检查，它决定了正在处理的单元的类型。在此示例中，我选择了对特定子类型的调用，但这些调用是必需的。*一个例子是，当一艘船撞到陆地时，它的螺旋桨应该被损坏。并非所有单位都有螺旋桨。*

我不确定这种问题叫什么，但它是一个多对多的依赖关系，我很难解耦。我不希望 ITerrain 上的每个 IUnit 子类都有 100 个重载，因为我想通过耦合来干净利落。

任何关于这个问题的观点都备受追捧。也许我正在考虑一起脱离轨道？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-16T03:18:15.503

将交互规则与 Unit 和 Terrain 类解耦；交互规则比这更通用。例如，可以使用哈希表，其中键是一对交互类型，值是对这些类型的对象进行操作的“效应器”方法。

当两个对象必须交互时，在哈希表中找到所有交互规则并执行它们

这消除了类间依赖关系，更不用说原始示例中可怕的 switch 语句

如果性能成为问题，并且交互规则在执行期间没有更改，则在遇到类型对时缓存它们的规则集，并发出一个新的 MSIL 方法来一次运行它们

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-16T02:27:51.227

您在这里遇到的限制是，与其他一些 OOP 语言不同，C# 缺少[多个 dispatch](http://en.wikipedia.org/wiki/Multiple_dispatch)。

换句话说，给定这些基类：

```
public class Base
{
    public virtual void Go() { Console.WriteLine("in Base"); }
}

public class Derived : Base
{
    public virtual void Go() { Console.WriteLine("in Derived"); }
} 
```

这个功能：

```
public void Test()
{
    Base obj = new Derived();
    obj.Go();
} 
```

即使引用“obj”是 Base 类型，也会正确输出“in Derived”。这是因为*在运行时*C# 会正确找到最衍生的 Go() 来调用。

然而，由于 C# 是一种单一的调度语言，它只对“第一个参数”执行此操作，在 OOP 语言中隐式为“this”。以下代码不像上面*那样*工作：

```
public class TestClass
{
    public void Go(Base b)
    {
        Console.WriteLine("Base arg");
    }

    public void Go(Derived d)
    {
        Console.WriteLine("Derived arg");
    }

    public void Test()
    {
        Base obj = new Derived();
        Go(obj);
    }
} 
```

这将输出“Base arg”，因为除了“this”之外，所有其他参数都是*静态*分派的，这意味着它们在编译时绑定到被调用的方法。在编译时，编译器唯一知道的是传递的参数的声明类型（“Base obj”）而不是它的实际类型，因此方法调用绑定到 Go(Base b) 之一。

那么，解决您的问题的方法基本上是手动编写一个小方法调度程序：

```
public class Dispatcher
{
    public void Dispatch(IUnit unit, ITerrain terrain)
    {
        Type unitType = unit.GetType();
        Type terrainType = terrain.GetType();

        // go through the list and find the action that corresponds to the
        // most-derived IUnit and ITerrain types that are in the ancestor
        // chain for unitType and terrainType.
        Action<IUnit, ITerrain> action = /* left as exercise for reader ;) */

        action(unit, terrain);
    }

    // add functions to this
    public List<Action<IUnit, ITerrain>> Actions = new List<Action<IUnit, ITerrain>>();
} 
```

您可以使用反射来检查传入的每个动作的通用参数，然后选择与给定单位和地形匹配的最派生参数，然后调用该函数。添加到 Actions 的功能可以在任何地方，甚至分布在多个程序集中。

有趣的是，我遇到过几次这个问题，但从来没有脱离游戏的背景。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-16T03:51:36.877

这里肯定有三个对象在起作用：

> 1) 地形
> 2) 地形效果
> 3) 单位

我不建议以地形/单位*对*作为查找动作的关键来创建地图。这将使您难以确保随着单位和地形列表的增长，您已经涵盖了所有组合。

事实上，似乎每个地形单元组合都具有独特的地形效果，因此您是否会从拥有一个通用的地形效果列表中看到好处是值得怀疑的。

相反，我会让每个单位保持自己的地形对地形效果的地图。然后，地形可以调用 Unit->AffectUnit(myTerrainType) 并且单元可以查找地形对自身的影响。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-16T01:49:03.223

Terrain has-a 地形属性

地形属性是多维的。

单位有推进力。

推进与地形属性兼容。

单位通过地形访问移动，以推进作为参数。这被委托给推进。

作为访问的一部分，单位*可能*会受到地形的影响。

单位代码对推进一无所知。地形类型可以改变而无需改变任何东西，除了地形属性和推进力。Propuslion 的构造器保护现有单元免受新的旅行方式的影响。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-16T01:31:29.257

老想法：

> 创建一个类 iTerrain 和另一个类 iUnit，它接受一个地形类型的参数，包括一个影响每个单位类型的方法
> 
> 例子：
> 
> ```
>   boat = new
> iUnit("watercraft") field = new
> iTerrain("grass")
> field.effects(boat)
> ```

好吧，忘记我有一个更好的主意：

使每个地形的效果成为每个单位的属性

例子：

```
 public class hovercraft : unit {
    #You make a base class for defaults and redefine as necessary
    speed_multiplier.water = 1
}

public class boat : unit {
    speed_multiplier.land = 0
} 
```

# python - OS X 10.5 上的 libxml2-p25 需要 sudo？

> ID：68541
> 
> 赞同：0
> 
> 时间：2008-09-16T01:27:28.110
> 
> 标签：python, macos, libxml2

当我尝试自己使用时`libxml2`，我收到一条错误消息，说找不到包。如果我以超级用户身份运行，我可以正常导入。

我已经通过 fink 安装了`python25`所有`libxml2`和`libxml2-py25`相关的库，并拥有包括库在内的整个路径。任何想法为什么我仍然需要sudo？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-16T05:01:08.830

Check your path by running:

```
'echo $PATH' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-16T10:04:43.420

我会怀疑图书馆的权限。您可以执行 strace 或类似操作来找出它正在寻找的文件名，然后检查它们的权限吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-16T21:08:07.913

`PATH`环境变量是错误的。

# .net - 在 ASP.net 中创建无控件数据表的最佳实践

> ID：68543
> 
> 赞同：1
> 
> 时间：2008-09-16T01:27:42.353
> 
> 标签：.net, asp.net

所以，我对 ASP.net 开发还是有点陌生​​，而且我已经不喜欢股票 ASP.net 控件以表格格式显示我的数据库查询结果。（即我更愿意自己处理 HTML，设计师也一样！）

所以我的问题是：在不使用 ASP.net 控件的情况下，最好和最安全的做法是什么？到目前为止，我唯一的想法是在 Page_Load 事件期间填充我的查询结果，然后通过 getter 将 DataTable 公开给 *.aspx 页面。从那里我想我可以迭代一个 foreach 循环并按照我认为合适的方式制作我的表。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-16T01:30:18.820

我相信你正在寻找一个`<Repeater>`控制。它包含一些类似于 GridViews 的功能，但允许您自己手工制作 Header、Item 和 Footers 的所有 HTML。只需像调用 gridview 一样调用数据绑定代码，然后更改 ASPX 页面以满足您确切的 HTML 需求。

[http://msdn.microsoft.com/en-us/magazine/cc163780.aspx](http://msdn.microsoft.com/en-us/magazine/cc163780.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-16T01:32:14.497

中继器的继任者是[ListView](http://aspnet.4guysfromrolla.com/articles/010208-1.aspx)，它也将帮助您手工制作 HTML。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-16T01:35:07.483

如果您对手动编写 HTML 代码更感兴趣，那么可能值得一看[ASP.NET MVC 项目](http://www.asp.net/mvc/)。与标准 WebForms 相比，您可以对事物进行更多控制。

顺便说一句，在 Page_Load 中插入数据访问代码绝不是一个好主意。它将您的演示文稿与您的数据代码联系得太紧密。看看上面建议的 MVC，它应用标准设计模式来分离关注点，或者在谷歌搜索“ASP.NET nTier”或类似的东西。启动和运行网站可能需要更长的时间，但从长远来看，它会为您省去痛苦。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-16T03:10:45.053

三个选项：

1.  学习使用现有的控件，如 GridView；使用适当的 CSS，它们看起来会非常漂亮，因为它们只是在客户端生成 HTML

2.  使用模板或 StringBuilder 生成 HTML 并将其放入网页上的文字控件中

3.  购买具有您喜欢的控件的第三方库

从长远来看，数字 1 是 asp.net 的“最佳”选项，因为您实际上将掌握其他人使用的控件；选项 2 很乏味；选项 3 是一种快速解决方案，可能很昂贵

# oop - 具有 sysadmin/Perl/Linux 背景的“获胜”OO 编程工作面试？

> ID：68548
> 
> 赞同：3
> 
> 时间：2008-09-16T01:28:41.477
> 
> 标签：oop, sysadmin, candidate

我是蒙特利尔软件工程专业的学生。在过去的 3 年中，我进行了几次实习（每年一次）。前两个（在同一家公司）主要是系统管理员工作，但我确实做了一些 Perl 程序（主要是日志文件分析和统计生成）。

我的另一个实习是在 IT 安全领域。我做了一个巨大的 CGI Perl 脚本来分析用户在 Internet 上花费的时间。

问题是，我真正想做的是编程，但我的实习主要是一些编程的系统管理员工作（由于我以前在 Linux 和 UNIX 方面的经验）。

今年冬天我还有另一个实习，但是我希望它是在 OO 编程领域和 SW 工程领域。

我有系统管理方面的背景，但由于我的大学课程和项目（C++、Java、VB.NET、ASP.NET，但不幸的是不是 C# :( ），我非常了解 OO。

我的问题是：如何在面试中与其他有 OO 经验的学生竞争以前的实习？

我的“卖点”应该是什么？我认为自己是一个很好的程序员，但由于缺乏经验，我之前的面试结果并不好。事实上，我去年冬天在系统管理部门获得了实习机会，因为，嗯……那是我的背景！

尽管我缺乏专业经验（但有很多个人知识（和兴趣）），如何让潜在雇主相信我是完美的候选人，有什么技巧吗？

谢谢，

纪尧姆。

[编辑]

谢谢大家的支持！

我还没有离开学校；我还是个全日制学生！我的大学课程是合作课程：我必须获得 3 次实习才能获得文凭。

让我简单解释一下我的背景：今年冬天将是我的第四次实习。

我的前两个是在我在魁北克的高中后但大学预科学校 CÉGEP 学习的时候。

第一个是 CÉGEP 实际给我的：一位雇主来找我，寻找有 Linux 系统管理知识的人。我非常适合这份工作，因为我是唯一一个在校外了解 Linux 的学生。我的面试甚至不是真正的面试，因为所有细节都在我的学校和雇主之间讨论过：我知道在面试之前我就被录用了。

一年后，第二个在同一家公司，因为我非常喜欢我的第一个。

然后我到达了我的大学，每个学生都必须有 3 次实习才能获得他（或她）的文凭。在计算机科学面试方面没有真正的经验（因为我的第一次实习是“给予”我的），我在为 OO 工作进行面试时做了一些搞砸的事情。我终于在庞巴迪宇航公司获得了安全/系统管理员/Perl 编程工作的面试机会。

我的实习很顺利，但现在我想要一份真正的软件开发工作。我认识的所有人去年冬天都有过一次，这意味着我在经验方面处于不利地位。

但是，我确实有编程经验。我所有的实习都要求我进行大量的编程，尤其是在 Perl 方面。我的 Perl 技能非常好，我必须为我工作的两家公司开发一些不错的工具。我解决了在学校没有遇到的实际问题（比如如何有效地解析 5 GB 的日志文件，同时保持尽可能低的内存使用）。

显然，如果我申请 sysadmin 领域或 Linux 领域的工作，我可以在今年冬天轻松获得实习机会。每年都有一些可用的，我在该领域有很多经验，但如前所述，我希望我的下一个实习是在软件开发方面。

我目前正在开发一个 Java 个人项目，这是一个小型 UML 类编辑器。所以我开始处理 Swing 框架、侦听器、MVC 架构等。这并不像在“现实世界”中所做的那么大，但它是一个有趣的项目，我在做这件事时很开心，如果我能在下个月取得进展，我可能会加入 SourceForge。同时我也在学习JSP。

至于OO开源项目，这是我应该研究的。作为一名全日制学生，我现在可能没有时间，距离我的第一次面试还有一个月的时间，但我不会放弃这个选项。

无论如何，谢谢你！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-16T03:07:18.060

没有冒犯，但从您的描述看来，您并不真正有资格从事“真正的”面向对象编程工作。学术课程是对语言的一个很好的介绍，但不能替代解决截止日期波动、挑剔的用户、挑剔的经理等的实际问题；-)

这留下了三个选择：

1.  加入一个使用 OO 和您知道的语言的开源项目，并为之做出重大贡献。这将提供真实编程经验的模拟[但不是真实的工作经验]，并*可能*帮助您在另一年或两年内获得一份编程工作

2.  或者，申请一个入门级的 OO 编程工作，并用你的沟通技巧、传染性的热情、渴望学习、对客户/用户/任何事物的承诺等给面试官留下深刻印象。换句话说，展示和推销自己说实话，但作为“完整的包裹”，只需要爆炸的机会。

    *   如果你被拒绝了很多，不要气馁
    *   不要申请你并不真正想要的工作
    *   如果不是两到三年，希望在工作中至少工作一年，以便真正学习如何在非学术环境中编程
3.  以顾问、程序员、自由职业者和/或开发产品的身份开始自己的事业，并按照自己的节奏学习。这在放学时是有风险的，在学校时风险较小，如果你发生在一个无人居住的地方可能会非常有利可图

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-16T01:38:55.010

嗯，获得即时、记录、经验的一个地方是通过开源项目。加入一个项目，或开始一个新项目。帮助有关 OSS 项目的文档（雇主很乐意看到这一点）。帮助编写单元测试、贡献补丁等。越早开始越好。

开源经验是好的和经验，它显示了对开发和您工作的语言的奉献精神。

祝你好运

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-16T01:38:14.620

能力和热情会让你走得很远。如果你能回答面试问题，解决编程问题，并且你有正在从事的个人项目，那么缺乏经验不应该让你退缩太多。

不过，请确保您提出问题。如果你没有经验，你必须知道你的东西冷以弥补它。

一定要强调副业。如果我采访一个喜欢把空闲时间花在家里编码的人，他们会得到很多加分。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-16T01:38:28.677

首先，我一直遵循的一件事从未让我犯错，那就是诚实。如果你不知道某事，就说“我不知道”。这对于编程面试非常重要，而且很容易理解。

接下来，花时间开始和/或参与一些开源项目。说你在一个开源项目上工作说明了很多。首先，它表明您可以了解其他人的代码，并有决心与编程社区中的其他人协作。这有很长的路要走。我遇到过一些雇主，当他们可以确认我为各种开源项目做出贡献时，他们实际上会跳过筛选过程。这可能是你在该领域缺乏经验的最佳防御。

如果您有经验/驱动力，那么请在用户组会议和/或代码营中进行演示和/​​或编码会议。这也有很长的路要走。显示您可以在这样的场景中与其他程序员交谈和交谈，它向雇主表明您喜欢编程和与社区合作。

最后，从低位开始。你需要从图腾柱的底部开始，但要努力工作并证明你是一个优秀的程序员，招聘人员/雇主会敲你的门。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-16T01:42:23.800

你 A) 在这个网站上发布了一个问题并且 B) 有一个博客出现，这表明你有激情。这是很多人没有的一件事，所以你对你有利。用这种热情来扩展你的知识。

如果你真的像你所说的那样对编程充满热情，那么就开始编程吧。你不能通过思考自己的方式来学习如何编程。获得经验的唯一方法是编程。对于像你这样的人，找到一个你想要帮助的开源项目并开始贡献。这将为您提供使用源代码控制等方面的宝贵经验。

另一件事是找到一种你认为你可以真正落后并深入研究的技术，尽可能地学习关于该技术和该平台的所有内容。让自己沉浸。我这么说的原因是因为如果你对这个和那个知之甚少，有人不会雇用你。他们希望你能够走进去工作。这并不意味着你不应该“玩”其他东西，而是帮自己一个忙，把它们从你的简历中删除，除非你有生产经验。

希望有帮助。-基思

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-16T20:01:25.093

带上一些 Perl 代码：

*   展示了一种你可以引以为豪的编程风格，
*   做一些有意义且有用的事情，并且
*   是面向对象的（有充分的理由，不仅仅是为了证明你可以反刍语法）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-24T22:16:52.993

[为某些CPAN](http://search.cpan.org)发行版贡献补丁。这将向您展示：1) 使用 CPAN - 经理喜欢可以更快编写代码的人 2) 可以阅读和修改某人的代码。

学习[Moose](http://search.cpan.org/dist/Moose) / [Mouse](http://search.cpan.org/dist/Mouse) - 这是 Perl 的现代 OO 系统，它比从 Python 复制的旧 OO 系统要好得多。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-21T06:47:32.743

每个公司都不一样。我一直是软件公司的高级软件开发人员，甚至从未有人问过我编程问题。

在面试中尽力而为，做你自己。

我发现 OOP 很有用，但有时在其中工作的范式被高估了。功能分解可以让你走得很远。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-17T20:59:53.857

你可能在 C++ 课上取得了不错的成绩，但教授会推荐你实习吗？

您学校的声誉或缺乏声誉可能会影响选拔过程。

# visual-studio - 如何阻止 Visual Studio 生成的 Web 服务代理类进行编码？

> ID：68555
> 
> 赞同：2
> 
> 时间：2008-09-16T01:30:11.927
> 
> 标签：visual-studio, web-services, wsdl, proxy-classes

我正在使用 Visual Studio 生成的代理类来访问 Web 服务（将 Web 服务添加为我的项目的 Web 引用）。问题是 Web 服务公开的函数需要一个 CDATA 元素，即：

```
<Function><![CDATA[<Blah></Blah>]]></Function> 
```

不幸的是，当我将 "" 传入代理类时，它使用以下命令调用 Web 服务：

```
<Function>&lt;![CDATA[&lt;Blah&gt;&lt;/Blah&gt;]]&gt;</Function> 
```

这似乎会导致 Web 服务出现问题。有什么办法可以在仍然使用 Visual Studio 生成的代理类的同时解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-16T03:33:38.010

您能否提供如何调用 Web 服务的代码示例？如果它是一个带有已发布 WSDL 的 Web 服务，我不知道您为什么还要处理这种级别的实现细节，所以我怀疑您以某种方式将其称为错误。

# .net-3.5 - VS2008 安装项目在安装时总是需要 .NET 3.5，但我不需要它！

> ID：68561
> 
> 赞同：12
> 
> 时间：2008-09-16T01:31:31.300
> 
> 标签：.net-3.5, .net-2.0, installation

1、创建并构建一个默认的Windows Forms项目并查看项目属性。它说该项目的目标是 .NET Framework 2.0。

2，创建一个安装项目，它只安装来自 Windows 窗体项目的单个可执行文件。

3，运行那个安装程序，它总是说它需要在机器上安装.NET 3.5 SP1。但它显然只需要 2.0，所以我不希望客户在不需要时被迫安装 .NET 3.5。他们可能已经安装了 2.0，所以强制升级是不可取的！

我查看了安装项目的先决条件并检查了 .NET Framework 2.0 条目，其余所有条目均未选中。所以我找不到这个奇怪的运行时要求的任何原因。有人知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-09-16T10:56:09.367

无需手动编辑文件。提示就在 GUID 的上方：“LaunchCondition”。

1.  右键单击设置项目
2.  选择“查看”->“启动条件”
3.  展开“启动条件”节点（如果尚未展开）
4.  右键单击“.NET Framework”节点并选择“属性窗口”
5.  在“属性”窗口中，将“版本”值更改为适当的值，在您的情况下为 2.0.50727。

我不确定为什么从一开始就没有正确设置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-16T01:35:19.073

即使您的目标是 2.0 部署，您的某些程序集也可能需要 3.5。例如，LINQ 需要 3.0。但是，这应该在您构建时反映出来。检查每个程序集以确保它与 2.0 兼容。你不希望任何 3.5 的东西偷偷溜进来。如果是这样的话，我的猜测将是一个支持 WPF 的 3rd 方控件库。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-16T10:26:09.190

我最终找到了我自己问题的答案。

使用记事本比较项目文件，我注意到 VS2008 中的安装项目有一个请求版本 3.5 的条目，并且 VS2005 项目中的相同部分标记为 2.0。奇怪的是，该部分看起来像您无法在 Visual Studio 环境中手动更改的内容，因此您被迫手动更新项目文件。对于遇到相同问题的人来说，这里的任何地方都是项目文件的违规区域......

```
"Deployable"
{
    "CustomAction"
    {
    }
    "DefaultFeature"
    {
    "Name" = "8:DefaultFeature"
    "Title" = "8:"
    "Description" = "8:"
    }
    "ExternalPersistence"
    {
        "LaunchCondition"
        {
            "{A06ECF26-33A3-4562-8140-9B0E340D4F24}:_FC497D835F7243569DCCC3E3ACE4196D"
            {
            "Name" = "8:.NET Framework"
            "Message" = "8:[VSDNETMSG]"
            "Version" = "8:3.5.30729"  <--- UPDATE THIS TO 8:2.0.50727
            "AllowLaterVersions" = "11:FALSE"
            "InstallUrl" = "8:http://go.microsoft.com/fwlink/?LinkId=76617"
            }
        }
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-28T03:56:25.440

我一直使用 Innosetup 来部署我的项目。它非常快，而且非常可定制。几乎没有什么你不能用一点脚本来做的。Innosetup 可以检测安装了哪个版本的框架，并在不存在正确版本时提示用户（使用脚本）。

我建议您尝试其他部署工具，例如 Innosetup，看看您是否喜欢它们。那里有很多机会。

# php - 您对 PHP 使用什么 XML 解析器？

> ID：68565
> 
> 赞同：3
> 
> 时间：2008-09-16T01:32:02.313
> 
> 标签：php, xml

我喜欢 XMLReader 类，因为它简单且速度快。但我喜欢 xml_parse 相关函数，因为它更好地允许错误恢复。如果 XMLReader 类会为无效的实体引用之类的事情抛出异常，而不是仅仅发出警告，那就太好了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-16T01:41:12.587

如果可以的话，我会避免使用 SimpleXML。尽管通过避免大量“丑陋”的代码看起来很诱人，但这正是它的名字所暗示的：简单。例如，它不能处理这个：

```
<p>
    Here is <strong>a very simple</strong> XML document.
</p> 
```

咬紧牙关，转到 DOM 函数。它的力量远远超过了一点点额外的复杂性。如果您完全熟悉 Javascript 中的 DOM 操作，那么您会对这个库感到宾至如归。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-16T01:34:42.383

[SimpleXML](http://us2.php.net/simplexml)似乎对我来说做得很好。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-16T21:55:32.963

SimpleXML 和 DOM 可以无缝地协同工作，因此您可以使用与 SimpleXML 或 DOM 相同的 XML 与之交互。

例如：

```
$simplexml = simplexml_load_string("<xml></xml>");
$simplexml->simple = "it is simple.";

$domxml = dom_import_simplexml($simplexml);
$node = $domxml->ownerDocument->createElement("dom", "yes, with DOM too.");
$domxml->ownerDocument->firstChild->appendChild($node);

echo (string)$simplexml->dom; 
```

你会得到结果：

```
"yes, with DOM too." 
```

因为当您导入对象（导入 simplexml 或 dom）时，它通过引用使用相同的下划线 PHP 对象。

当我试图通过扩展/包装对象来纠正 SimpleXML 中的一些错误时，我发现了这一点。

有关示例，请参见[http://code.google.com/p/blibrary/source/browse/trunk/classes/bXml.class.inc](http://code.google.com/p/blibrary/source/browse/trunk/classes/bXml.class.inc)。

这对于小块 XML (-2MB) 非常有用，因为 DOM/SimpleXML 将整个文档拉入内存并增加了一些额外开销（想想 x2 或 x3）。对于大型 XML 块 (+2MB)，您需要使用 XMLReader/XMLWriter 来解析 SAX 样式，并且内存开销较低。我已经通过 XMLReader/XMLWriter 成功使用了 14MB 以上的文档。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-16T05:03:47.450

使用 PHP5 解析 XML 文件时，至少有四个选项。最佳选择取决于 XML 文件的复杂性和大小。

有一个非常棒的 3 部分文章系列，标题为“<a href="http://www.ibm.com/developerworks/xml/library/x-xmlphp1.html" rel="nofollow noreferrer">XML for PHP 开发人员”在 IBM developerWorks。

“使用现在完全符合 W3C 标准的 DOM 进行解析是一个熟悉的选项，并且是您处理复杂但相对较小的文档的选择。SimpleXML 是处理基本且不太大的 XML 文档的方法，而 XMLReader 比 SAX 更简单、更快速，是大型文档的首选流解析器。”</p>

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-16T01:35:12.303

我主要坚持使用 SimpleXML，至少每当 PHP5 可供我使用时。

[http://www.php.net/simplexml](http://www.php.net/simplexml)

# html - 网页上的文字水印？怎么做？

> ID：68569
> 
> 赞同：15
> 
> 时间：2008-09-16T01:32:20.440
> 
> 标签：html, watermark

我是一名 C++/C# 开发人员，从未花时间在网页上工作。我想在某些页面的背景上以大写字母（可能是随机和对角线）放置文本。我希望能够阅读前景文本并能够阅读“水印”。我知道这可能更多是颜色选择的功能。

我一直在尝试做我想做的事，但没有成功。我想这对于具有网页设计工具或 html 知识的人来说非常简单。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2010-03-21T10:57:56.273

```
<style type="text/css">
#watermark {
  color: #d0d0d0;
  font-size: 200pt;
  -webkit-transform: rotate(-45deg);
  -moz-transform: rotate(-45deg);
  position: absolute;
  width: 100%;
  height: 100%;
  margin: 0;
  z-index: -1;
  left:-100px;
  top:-200px;
}
</style> 
```

这使您可以仅使用文本作为水印 - 适用于网页的开发/测试版本。

```
<div id="watermark">
<p>This is the test version.</p>
</div> 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-16T15:06:13.523

正如建议的那样，png背景可以工作，甚至只是一个绝对定位的png，其大小适合页面，但你在评论中询问什么是创建一个好的工具 - 如果你想免费使用，试试[GIMP](http://www.gimp.org/)。创建一个具有透明背景的画布，添加一些文本，旋转它并根据需要调整大小，然后降低图层的不透明度以适应口味。

如果您希望它覆盖整个页面，请使用“水印”类创建一个 div，并将其样式定义为：

```
.水印
{
   背景图片：网址（image.png）；
   背景位置：中心中心；
   背景尺寸：100%；/* 仅限 CSS3，但如果你制作足够大的图像，则不是必需的 */
   位置：绝对；
   宽度：100%；
   高度：100%；
   边距：0；
   z 指数：10；
}

```

如果您真的希望图像拉伸以适应，您可以更进一步，将图像添加到该 div 中，并定义其样式以适应（宽度/高度：100%；）。

当然，这有一个非常重要的警告：IE6 和一些旧浏览器可能不知道如何处理透明 png。用一张巨大的、不透明的图片覆盖你的网站*肯定*不行。但是幸运的是，有[一些技巧](http://bjorkoy.com/past/2007/4/8/the_easiest_way_to_png/)可以解决这个问题，如果您确实使用透明 png，您很可能会想要这样做。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-16T18:18:01.787

如果您在上面kavendek的建议中将“背景附件：固定”添加到css中，您可以将背景图像“固定”到窗口中的指定位置。这样，无论用户在页面上的哪个位置滚动，水印都将始终可见。

就个人而言，我发现固定的背景图像在视觉上很烦人，但我听说网站所有者说他们喜欢知道他们的徽标或版权声明（大概呈现为图像）总是就在用户的眼皮底下。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-16T01:36:09.883

您可以制作带有水印的图像，然后通过 css 将图像设置为背景。

例如：

```
<style type="text/css">
.watermark{background:url(urltoimage.png);}
</style>
<div class="watermark">
<p>this is some text with the watermark as the background.</p>
</div> 
```

那应该行得通。

# nhibernate - 流畅的 NHibernate 架构问题

> ID：68572
> 
> 赞同：1
> 
> 时间：2008-09-16T01:33:02.373
> 
> 标签：nhibernate, architecture, fluent

我有一个问题，在这一点上我可能想多了，但这里......

我有 2 类用户和组。用户和组有多对多的关系，我想加入表 group_users 我想要一个 IsAuthorized 属性（因为有些组是私有的——用户需要授权）。

**您是否建议为连接表以及用户和组表创建一个类？**目前我的课程看起来像这样。

```
public class Groups
{
    public Groups()
    {
        members = new List<Person>();
    }
    ...
    public virtual IList<Person> members { get; set; }
}

public class User
{

    public User()
    {
       groups = new Groups()
    }
    ...
    public virtual IList<Groups> groups{ get; set; }

} 
```

我的映射在两个类中都如下所示（我只在用户映射中显示一个，但它们非常相似）：

```
HasManyToMany<Groups>(x => x.Groups)
.WithTableName("GroupMembers")
.WithParentKeyColumn("UserID")
.WithChildKeyColumn("GroupID")
.Cascade.SaveUpdate(); 
```

**我应该为看起来像这样的连接表编写一个类吗？**

```
public class GroupMembers
{
    public virtual string GroupID { get; set; }
    public virtual string PersonID { get; set; }
    public virtual bool WaitingForAccept { get; set; }
} 
```

我真的很希望能够调整组成员身份，我想我正在尝试考虑解决此问题的最佳方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-16T02:53:08.653

是的，你肯定需要另一个类，比如 UserGroupBridge。另一个好的副作用是您可以修改用户成员资格和组成员，而无需将可能很重的用户/组对象加载到 NHibernate 会话。

干杯。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-16T03:04:44.400

我通常只喜欢创建代表实际业务实体的类。在这种情况下，我认为 'groupmembers' 在您的代码中不代表任何有价值的东西。对我来说，ORM 应该将数据库映射到您的业务对象。这意味着您的类不必完全反映数据库布局。

另外我怀疑通过实现 GroupMembers，你最终会在你的用户和组类中得到一些讨厌的集合。IE 组类将具有用户列表以及引用用户的组成员列表，反之亦然。对我来说，这不是那么干净，并且会使维护和传播对表的更改变得更加困难。

我建议按照您的建议将连接表保留在数据库中，并在用户中添加一个名为 waitingtoaccept 的组列表，并且（如果也有意义的话）在组中添加一个名为 waitingtoaccept 的用户列表。

然后，这些将根据 waitingtoaccept 标志从数据库中的连接表中提取它们的值。

# c# - switch 语句中的多个情况

> ID：68578
> 
> 赞同：680
> 
> 时间：2008-09-16T01:34:41.277
> 
> 标签：c#, switch-statement

有没有办法在不`case value:`重复陈述的情况下通过多个案例陈述？

我知道这有效：

```
switch (value)
{
   case 1:
   case 2:
   case 3:
      // Do some stuff
      break;
   case 4:
   case 5:
   case 6:
      // Do some different stuff
      break;
   default:
       // Default stuff
      break;
} 
```

但我想做这样的事情：

```
switch (value)
{
   case 1,2,3:
      // Do something
      break;
   case 4,5,6:
      // Do something
      break;
   default:
      // Do the Default
      break;
} 
```

这是我从不同语言中想到的语法，还是我遗漏了什么？

* * *

## 回答 #1

> 赞同：785
> 
> 时间：2010-08-01T13:29:29.027

我想这已经回答了。但是，我认为您仍然可以通过以下方式以语法更好的方式混合这两个选项：

```
switch (value)
{
    case 1: case 2: case 3:          
        // Do Something
        break;
    case 4: case 5: case 6: 
        // Do Something
        break;
    default:
        // Do Something
        break;
} 
```

* * *

## 回答 #2

> 赞同：360
> 
> 时间：2008-09-16T01:40:32.557

您提到的第二种方法在 C++ 和 C# 中都没有语法。

你的第一种方法没有问题。但是，如果您有很大的范围，只需使用一系列 if 语句。

* * *

## 回答 #3

> 赞同：99
> 
> 时间：2017-06-30T14:21:18.090

在 C# 7（在 Visual Studio 2017/.NET Framework 4.6.2 中默认可用）中，现在可以使用[switch 语句](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/switch)进行基于范围的切换，这将有助于解决 OP 的问题。

**例子：**

```
int i = 5;

switch (i)
{
    case int n when (n >= 7):
        Console.WriteLine($"I am 7 or above: {n}");
        break;

    case int n when (n >= 4 && n <= 6 ):
        Console.WriteLine($"I am between 4 and 6: {n}");
        break;

    case int n when (n <= 3):
        Console.WriteLine($"I am 3 or less: {n}");
        break;
}

// Output: I am between 4 and 6: 5 
```

**笔记：**

*   括号`(`和`)`在条件中不是必需的`when`，但在此示例中用于突出显示比较。
*   `var`也可以用来代替`int`。例如：`case var n when n >= 7:`。

* * *

## 回答 #4

> 赞同：74
> 
> 时间：2008-09-16T01:41:50.493

此语法来自 Visual Basic [Select...Case Statement](https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/statements/select-case-statement#Anchor_3)：

```
Dim number As Integer = 8
Select Case number
    Case 1 To 5
        Debug.WriteLine("Between 1 and 5, inclusive")
        ' The following is the only Case clause that evaluates to True.
    Case 6, 7, 8
        Debug.WriteLine("Between 6 and 8, inclusive")
    Case Is < 1
        Debug.WriteLine("Equal to 9 or 10")
    Case Else
        Debug.WriteLine("Not between 1 and 10, inclusive")
End Select 
```

您不能在 C# 中使用此语法。相反，您必须使用第一个示例中的语法。

* * *

## 回答 #5

> 赞同：37
> 
> 时间：2008-09-16T03:11:37.313

您可以省略换行符，它为您提供：

```
case 1: case 2: case 3:
   break; 
```

但我认为这种糟糕的风格。

* * *

## 回答 #6

> 赞同：21
> 
> 时间：2008-09-16T10:27:16.660

.NET Framework 3.5 有范围：

[来自 MSDN 的 Enumerable.Range](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.range.aspx)

您可以将它与“包含”和 IF 语句一起使用，因为就像有人说 SWITCH 语句使用“==”运算符一样。

这里有一个例子：

```
int c = 2;
if(Enumerable.Range(0,10).Contains(c))
    DoThing();
else if(Enumerable.Range(11,20).Contains(c))
    DoAnotherThing(); 
```

但我认为我们可以玩得更开心：因为你不需要返回值并且这个动作不带参数，你可以很容易地使用动作！

```
public static void MySwitchWithEnumerable(int switchcase, int startNumber, int endNumber, Action action)
{
    if(Enumerable.Range(startNumber, endNumber).Contains(switchcase))
        action();
} 
```

使用这种新方法的旧示例：

```
MySwitchWithEnumerable(c, 0, 10, DoThing);
MySwitchWithEnumerable(c, 10, 20, DoAnotherThing); 
```

由于您传递的是操作而不是值，因此您应该省略括号，这非常重要。如果您需要带参数的函数，只需将类型更改`Action`为`Action<ParameterType>`。如果您需要返回值，请使用`Func<ParameterType, ReturnType>`.

在 C# 3.0 中，没有简单的[Partial Application](http://www.haskell.org/haskellwiki/Partial_application)来封装 case 参数相同的事实，但是您创建了一个小辅助方法（虽然有点冗长）。

```
public static void MySwitchWithEnumerable(int startNumber, int endNumber, Action action){ 
    MySwitchWithEnumerable(3, startNumber, endNumber, action); 
} 
```

这是一个示例，说明新的功能导入语句如何比旧的命令式语句更强大和优雅。

* * *

## 回答 #7

> 赞同：21
> 
> 时间：2021-01-23T20:51:12.177

C#9 出现了关系模式匹配。这使我们能够：

```
switch (value)
{
    case 1 or 2 or 3:
      // Do stuff
      break;
    case 4 or 5 or 6:
      // Do stuff
      break;
    default:
        // Do stuff
        break;
} 
```

[在 C#9 中的关系模式的深度教程中](https://dotnetcoretutorials.com/2020/08/10/relational-pattern-matching-in-c-9/)

[C# 9.0 的模式匹配更改](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/proposals/csharp-9.0/patterns3)

> 关系模式允许程序员表示输入值与常量值相比必须满足关系约束

* * *

## 回答 #8

> 赞同：16
> 
> 时间：2018-12-27T23:23:36.807

这是完整的 C# 7 解决方案...

```
switch (value)
{
   case var s when new[] { 1,2,3 }.Contains(s):
      // Do something
      break;
   case var s when new[] { 4,5,6 }.Contains(s):
      // Do something
      break;
   default:
      // Do the default
      break;
} 
```

它也适用于字符串......

```
switch (mystring)
{
   case var s when new[] { "Alpha","Beta","Gamma" }.Contains(s):
      // Do something
      break;
...
} 
```

* * *

## 回答 #9

> 赞同：13
> 
> 时间：2012-11-04T00:03:55.193

下面的代码*不起作用*：

```
case 1 | 3 | 5:
// Not working do something 
```

这样做的唯一方法是：

```
case 1: case 2: case 3:
// Do something
break; 
```

您正在寻找的代码在 Visual Basic 中工作，您可以在其中轻松放入范围......在方便的语句或块`none`选项中，我建议在非常极端的情况下使用 Visual Basic 制作 .dll 并导入回来到您的 C# 项目。`switch``if else`

注意：Visual Basic 中的等效开关是`Select Case`.

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2008-09-16T03:30:13.947

另一种选择是使用例程。如果案例 1-3 都执行相同的逻辑，则将该逻辑包装在一个例程中并为每个案例调用它。我知道这实际上并没有摆脱案例陈述，但它确实实现了良好的风格并将维护降至最低......

[编辑] 添加替代实现以匹配原始问题...[/编辑]

```
switch (x)
{
   case 1:
      DoSomething();
      break;
   case 2:
      DoSomething();
      break;
   case 3:
      DoSomething();
      break;
   ...
}

private void DoSomething()
{
   ...
} 
```

**Alt**

```
switch (x)
{
   case 1:
   case 2:
   case 3:
      DoSomething();
      break;
   ...
}

private void DoSomething()
{
   ...
} 
```

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2019-09-05T09:02:21.927

在 C# 7 中，我们现在有了[**模式匹配**](https://visualstudiomagazine.com/articles/2017/02/01/pattern-matching.aspx)，因此您可以执行以下操作：

```
switch (age)
{
  case 50:
    ageBlock = "the big five-oh";
    break;
  case var testAge when (new List<int>()
      { 80, 81, 82, 83, 84, 85, 86, 87, 88, 89 }).Contains(testAge):
    ageBlock = "octogenarian";
    break;
  case var testAge when ((testAge >= 90) & (testAge <= 99)):
    ageBlock = "nonagenarian";
    break;
  case var testAge when (testAge >= 100):
    ageBlock = "centenarian";
    break;
  default:
    ageBlock = "just old";
    break;
} 
```

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2008-09-16T02:16:25.293

**C# 中switch**的一个鲜为人知的方面是它依赖于**operator=**并且因为它可以被覆盖，所以你可以有这样的东西：

```
 string s = foo();

switch (s) {
  case "abc": /*...*/ break;
  case "def": /*...*/ break;
} 
```

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2008-09-16T02:59:52.583

gcc 实现了对 C 语言的扩展以支持顺序范围：

```
switch (value)
{
   case 1...3:
      //Do Something
      break;
   case 4...6:
      //Do Something
      break;
   default:
      //Do the Default
      break;
} 
```

**编辑**：刚刚注意到问题上的 C# 标签，所以大概 gcc 的答案没有帮助。

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2011-09-08T08:21:39.153

其实我也不喜欢 GOTO 命令，但它在微软官方资料中，这里都是允许的语法。

如果 switch 部分的语句列表的端点是可到达的，则会发生编译时错误。这被称为“不失败”规则。这个例子

```
switch (i) {
case 0:
   CaseZero();
   break;
case 1:
   CaseOne();
   break;
default:
   CaseOthers();
   break;
} 
```

是有效的，因为没有开关部分具有可到达的端点。与 C 和 C++ 不同，switch 部分的执行不允许“落入”下一个 switch 部分，示例

```
switch (i) {
case 0:
   CaseZero();
case 1:
   CaseZeroOrOne();
default:
   CaseAny();
} 
```

导致编译时错误。当一个 switch 部分的执行之后要执行另一个 switch 部分时，必须使用显式 goto case 或 goto default 语句：

```
switch (i) {
case 0:
   CaseZero();
   goto case 1;
case 1:
   CaseZeroOrOne();
   goto default;
default:
   CaseAny();
   break;
} 
```

一个开关部分允许有多个标签。这个例子

```
switch (i) {
case 0:
   CaseZero();
   break;
case 1:
   CaseOne();
   break;
case 2:
default:
   CaseTwo();
   break;
} 
```

我相信在这种特殊情况下，可以使用 GOTO，它实际上是唯一的失败方法。

[来源](https://web.archive.org/web/20150110043637/http://msdn.microsoft.com/en-us/library/aa664749(v=vs.71).aspx)

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2021-06-22T23:00:53.840

在 C# 8.0 中，您可以使用最适合您的情况的新[switch 表达式语法。](https://docs.microsoft.com/en-us/dotnet/csharp/whats-new/csharp-8#switch-expressions)

```
var someOutput = value switch
{
    >= 1 and <= 3 => <Do some stuff>,
    >= 4 and <= 6 => <Do some different stuff>,
    _ => <Default stuff>
}; 
```

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2018-03-29T16:00:21.063

如果您有大量字符串（或任何其他类型）都在做同样的事情，我建议使用字符串列表和 string.Contains 属性。

所以如果你有一个像这样的大 switch 语句：

```
switch (stringValue)
{
    case "cat":
    case "dog":
    case "string3":
    ...
    case "+1000 more string": // Too many string to write a case for all!
        // Do something;
    case "a lonely case"
        // Do something else;
    .
    .
    .
} 
```

您可能想用这样的`if`语句替换它：

```
// Define all the similar "case" string in a List
List<string> listString = new List<string>(){ "cat", "dog", "string3", "+1000 more string"};
// Use string.Contains to find what you are looking for
if (listString.Contains(stringValue))
{
    // Do something;
}
else
{
    // Then go back to a switch statement inside the else for the remaining cases if you really need to
} 
```

这适用于任何数量的字符串情况。

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2020-04-24T14:40:30.927

我认为这个在 C# 7 或更高版本中更好。

```
switch (value)
{
    case var s when new[] { 1,2 }.Contains(s):
    // Do something
     break;

    default:
    // Do the default
    break;
 } 
```

您还可以检查 C# 开关案例中的范围：[开关案例：我可以使用范围而不是一个数字](https://stackoverflow.com/questions/20147879/switch-case-can-i-use-a-range-instead-of-a-one-number) 或者如果您想了解 [C# 开关案例的基础知识](https://qawithexperts.com/tutorial/c-sharp/13/c-sharp-switch-statement)

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2021-02-10T14:13:48.887

你也可以有完全不同的条件

```
 bool isTrue = true;

            switch (isTrue)
            {
                case bool ifTrue when (ex.Message.Contains("not found")):
                case bool ifTrue when (thing.number = 123):
                case bool ifTrue when (thing.othernumber != 456):
                    response.respCode = 5010;
                    break;
                case bool ifTrue when (otherthing.text = "something else"):
                    response.respCode = 5020;
                    break;
                default:
                    response.respCode = 5000;
                    break;
            } 
```

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2012-02-23T06:25:00.577

似乎已经投入了大量的工作来寻找使 C# 最少使用的语法之一以某种方式看起来更好或工作得更好的方法。就我个人而言，我发现 switch 语句很少值得使用。我强烈建议分析您正在测试的数据以及您想要的最终结果。

例如，假设您想快速测试已知范围内的值以查看它们是否为素数。您希望避免让您的代码进行无用计算，并且可以在线找到所需范围内的素数列表。您可以使用大量 switch 语句将每个值与已知的素数进行比较。

或者您可以创建一个素数数组映射并立即获得结果：

```
 bool[] Primes = new bool[] {
        false, false, true, true, false, true, false,    
        true, false, false, false, true, false, true,
        false,false,false,true,false,true,false};
    private void button1_Click(object sender, EventArgs e) {
        int Value = Convert.ToInt32(textBox1.Text);
        if ((Value >= 0) && (Value < Primes.Length)) {
            bool IsPrime = Primes[Value];
            textBox2.Text = IsPrime.ToString();
        }
    } 
```

也许您想查看字符串中的字符是否为十六进制。你可以使用一个笨拙且有点大的 switch 语句。

或者您可以使用正则表达式来测试 char 或使用 IndexOf 函数在已知的十六进制字母字符串中搜索 char：

```
 private void textBox2_TextChanged(object sender, EventArgs e) {
        try {
            textBox1.Text = ("0123456789ABCDEFGabcdefg".IndexOf(textBox2.Text[0]) >= 0).ToString();
        } catch {
        }
    } 
```

假设您要根据 1 到 24 范围内的值执行 3 种不同操作中的一种。我建议使用一组 IF 语句。如果这变得太复杂（或者数字更大，例如 5 个不同的操作，具体取决于 1 到 90 范围内的值），则使用枚举来定义操作并创建枚举的数组映射。然后该值将用于索引数组映射并获取所需操作的枚举。然后使用一小组 IF 语句或一个非常简单的 switch 语句来处理生成的枚举值。

此外，将一系列值转换为操作的数组映射的好处在于它可以通过代码轻松更改。使用硬连线代码，您无法在运行时轻松更改行为，但使用数组映射很容易。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2019-07-03T00:32:08.727

只是为了添加到对话中，使用 .NET 4.6.2 我还能够执行以下操作。我测试了代码，它确实对我有用。

您还可以执行多个“OR”语句，如下所示：

```
 switch (value)
            {
                case string a when a.Contains("text1"):
                    // Do Something
                    break;
                case string b when b.Contains("text3") || b.Contains("text4") || b.Contains("text5"):
                    // Do Something else
                    break;
                default:
                    // Or do this by default
                    break;
            } 
```

您还可以检查它是否与数组中的值匹配：

```
 string[] statuses = { "text3", "text4", "text5"};

            switch (value)
            {
                case string a when a.Contains("text1"):
                    // Do Something
                    break;
                case string b when statuses.Contains(value):                        
                    // Do Something else
                    break;
                default:
                    // Or do this by default
                    break;
            } 
```

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2021-09-07T13:15:39.840

# 一种更漂亮的处理方式

```
if ([4, 5, 6, 7].indexOf(value) > -1)
    //Do something 
```

您可以对具有相同结果的多个值执行此操作

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2021-12-12T18:06:08.867

我们也可以使用这种方法来实现 switch 语句中的多个情况......您可以使用这种方法使用尽可能多的条件..

```
 int i = 209;
    int a = 0;
    switch (a = (i>=1 && i<=100) ? 1 : a){    
    case 1:
        System.out.println ("The Number is Between 1 to 100 ==> " + i);
        break;
    default:
        switch (a = (i>100 && i<=200) ? 2 : a) {
            case 2:
                System.out.println("This Number is Between 101 to 200 ==> " + i);
                break;

            default:
                switch (a = (i>200 && i<=300) ? 3 : a) {
                    case 3:
                        System.out.println("This Number is Between 201 to 300 ==> " + i);
                        break;

                    default:
                        // You can make as many conditions as you want;
                        break;
                }
        }

    } 
```

* * *

## 回答 #23

> 赞同：-6
> 
> 时间：2011-07-09T22:41:49.140

为此，您将使用 goto 语句。如：

```
 switch(value){
    case 1:
        goto case 3;
    case 2:
        goto case 3;
    case 3:
        DoCase123();
    //This would work too, but I'm not sure if it's slower
    case 4:
        goto case 5;
    case 5:
        goto case 6;
    case 6:
        goto case 7;
    case 7:
        DoCase4567();
    } 
```

# php - foreach 访问索引或关联数组

> ID：68583
> 
> 赞同：5
> 
> 时间：2008-09-16T01:35:07.843
> 
> 标签：php, foreach

我有以下代码片段。

```
$items['A'] = "Test";
$items['B'] = "Test";
$items['C'] = "Test";
$items['D'] = "Test";

$index = 0;
foreach($items as $key => $value)
{
    echo "$index is a $key containing $value\n";
    $index++;
} 
```

预期输出：

```
0 is a A containing Test
1 is a B containing Test
2 is a C containing Test
3 is a D containing Test 
```

有没有办法省略`$index`变量？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-09-16T01:41:00.467

你的 $index 变量有点误导。该数字不是索引，您的“A”、“B”、“C”、“D”键是。您仍然可以通过编号索引 $index[1] 访问数据，但这并不是重点。如果您真的想保留编号索引，我几乎会重组数据：

```
$items[] = array("A", "Test");
$items[] = array("B", "Test");
$items[] = array("C", "Test");
$items[] = array("D", "Test");

foreach($items as $key => $value) {
    回声$键。是一个'.$value[0]。' 包含 '.$value[1];
}

```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-16T01:47:09.157

你可以这样做：

```
$items[A] = "Test";
$items[B] = "Test";
$items[C] = "Test";
$items[D] = "Test";

for($i=0;$i<count($items);$i++)
{
    list($key,$value) = each($items[$i]);
    echo "$i $key contains $value";
} 
```

我以前没有这样做过，但理论上它应该可以工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-16T02:32:29.390

小心你在那里定义你的钥匙。虽然您的示例有效，但它可能并不总是：

```
$myArr = array();
$myArr[A] = "a";  // "A" is assumed.
echo $myArr['A']; // "a" - this is expected.

define ('A', 'aye');

$myArr2 = array();
$myArr2[A] = "a"; // A is a constant

echo $myArr['A']; // error, no key.
print_r($myArr);

// Array
// (
//     [aye] => a
// ) 
```

# unit-testing - 测试通过 HTTP 通信的单元的好方法

> ID：68592
> 
> 赞同：3
> 
> 时间：2008-09-16T01:37:18.477
> 
> 标签：unit-testing, language-agnostic, http

通常，我发现自己想为一部分访问 HTTP 资源的代码编写单元测试，作为其正常功能的一部分。你有没有找到编写这类测试的好方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-16T01:42:35.080

从主代码中提取访问 HTTP 资源的部分。为该新组件创建一个接口，在您的测试中，模拟该接口并返回您可以可靠控制的数据。

您可以将 HTTP 访问作为集成测试进行测试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-16T01:39:08.800

这通常是我会为测试模拟的功能......我不喜欢我的测试依赖于任何外部......更糟糕的是，如果它是我无法控制的外部资源（例如第 3 方网站） .

数据库是我经常不会模拟的为数不多的外部资源之一……我使用 DBUnit 代替。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-16T01:41:27.517

我最近不得不编写一个访问 wiki 并进行一些基本文本抓取的组件。我编写的大多数测试都验证了正确的 HTTP 响应代码。就验证实际资源而言，我将保存已知资源的离线版本并检查算法是否正在收集/处理正确的数据。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T07:28:06.027

根据您使用的语言或框架，启动本地运行的 HTTP 服务器可能很简单，该服务器提供您想要的资源。

# c# - 如何将文件拖放到应用程序中？

> ID：68598
> 
> 赞同：263
> 
> 时间：2008-09-16T01:38:27.897
> 
> 标签：c#, winforms, drag-and-drop

我已经在 Borland 的[Turbo C++](https://en.wikipedia.org/wiki/Turbo_C++)环境中看到了这一点，但我不确定如何为我正在开发的 C# 应用程序执行此操作。是否有需要注意的最佳实践或陷阱？

* * *

## 回答 #1

> 赞同：527
> 
> 时间：2008-09-18T02:26:35.033

一些示例代码：

```
 public partial class Form1 : Form {
    public Form1() {
      InitializeComponent();
      this.AllowDrop = true;
      this.DragEnter += new DragEventHandler(Form1_DragEnter);
      this.DragDrop += new DragEventHandler(Form1_DragDrop);
    }

    void Form1_DragEnter(object sender, DragEventArgs e) {
      if (e.Data.GetDataPresent(DataFormats.FileDrop)) e.Effect = DragDropEffects.Copy;
    }

    void Form1_DragDrop(object sender, DragEventArgs e) {
      string[] files = (string[])e.Data.GetData(DataFormats.FileDrop);
      foreach (string file in files) Console.WriteLine(file);
    }
  } 
```

* * *

## 回答 #2

> 赞同：152
> 
> 时间：2011-01-25T04:10:03.280

请注意 windows vista/windows 7 安全权限 - 如果您以管理员身份运行 Visual Studio，当您从 Visual Studio 中运行时，您将无法将文件从非管理员资源管理器窗口拖到您的程序中。与拖动相关的事件甚至不会触发！我希望这可以帮助其他人不要浪费他们的生命......

* * *

## 回答 #3

> 赞同：46
> 
> 时间：2008-09-16T01:58:30.003

In Windows Forms, set the control's AllowDrop property, then listen for DragEnter event and DragDrop event.

When the `DragEnter` event fires, set the argument's `AllowedEffect` to something other than none (e.g. `e.Effect = DragDropEffects.Move`).

When the `DragDrop` event fires, you'll get a list of strings. Each string is the full path to the file being dropped.

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2008-09-16T02:11:28.940

你需要知道一个陷阱。在拖放操作中作为[DataObject](http://msdn.microsoft.com/en-us/library/system.windows.forms.dataobject%28v=vs.110%29.aspx)传递的任何类都必须是可序列化的。因此，如果您尝试传递一个对象，但它不起作用，请确保它可以被序列化，因为这几乎肯定是问题所在。这让我抓到了好几次！

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2008-11-18T21:21:16.490

另一个问题：

调用 Drag-events 的框架代码会吞下所有异常。您可能会认为您的事件代码运行平稳，而它却到处涌现异常。您看不到它们，因为框架窃取了它们。

这就是为什么我总是在这些事件处理程序中放置一个 try/catch，这样我就知道它们是否会抛出任何异常。我通常放一个 Debugger.Break(); 在捕获部分。

在发布之前，在测试之后，如果一切似乎都正常，我会删除或用真正的异常处理替换它们。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2008-09-16T02:32:48.750

另一个常见的问题是认为您可以忽略 Form DragOver（或 DragEnter）事件。我通常使用 Form 的 DragOver 事件来设置 AllowedEffect，然后使用特定控件的 DragDrop 事件来处理拖放的数据。

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2016-04-19T14:25:36.793

这是我用来删除文件和/或充满文件的文件夹的东西。在我的情况下，我只过滤`*.dwg`文件并选择包含所有子文件夹。

`fileList`是一个`IEnumerable`或类似的在我的情况下绑定到一个 WPF 控件...

```
var fileList = (IList)FileList.ItemsSource; 
```

有关该技巧的详细信息，请参阅[https://stackoverflow.com/a/19954958/492](https://stackoverflow.com/a/19954958/492)。

下降处理程序...

```
 private void FileList_OnDrop(object sender, DragEventArgs e)
  {
    var dropped = ((string[])e.Data.GetData(DataFormats.FileDrop));
    var files = dropped.ToList();

    if (!files.Any())
      return;

    foreach (string drop in dropped)
      if (Directory.Exists(drop))
        files.AddRange(Directory.GetFiles(drop, "*.dwg", SearchOption.AllDirectories));

    foreach (string file in files)
    {
      if (!fileList.Contains(file) && file.ToLower().EndsWith(".dwg"))
        fileList.Add(file);
    }
  } 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2018-02-05T10:10:45.420

Judah Himango 和 Hans Passant 的解决方案在 Designer 中可用（我目前使用的是 VS2015）：

[![在此处输入图像描述](https://i.stack.imgur.com/chX8I.png)](https://i.stack.imgur.com/chX8I.png)

[![在此处输入图像描述](https://i.stack.imgur.com/2R8Wx.png)](https://i.stack.imgur.com/2R8Wx.png)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-04-27T09:47:39.890

您可以在 WinForms 和 WPF 中实现拖放。

*   WinForm（从应用程序窗口拖动）

您应该添加 mousemove 事件：

```
private void YourElementControl_MouseMove(object sender, MouseEventArgs e)

    {
     ...
         if (e.Button == MouseButtons.Left)
         {
                 DoDragDrop(new DataObject(DataFormats.FileDrop, new string[] { PathToFirstFile,PathToTheNextOne }), DragDropEffects.Move);
         }
     ...
    } 
```

*   WinForm（拖动到应用程序窗口）

您应该添加 DragDrop 事件：

私人无效YourElementControl_DragDrop（对象发送者，DragEventArgs e）

```
 {
       ...
       foreach (string path in (string[])e.Data.GetData(DataFormats.FileDrop))
            {
                File.Copy(path, DirPath + Path.GetFileName(path));
            }
       ...
    } 
```

[带有完整代码的源代码](https://www.brainbeast.best/drag-and-drop-on-c-sharp-in-wpf-dot-net/)。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-07-16T22:32:10.943

请注意，为此，您还需要在 _drawEnter 中设置 dragDropEffect...

```
private void Form1_DragEnter(object sender, DragEventArgs e)
{
    Console.WriteLine("DragEnter!");
    e.Effect = DragDropEffects.Copy;
} 
```

来源：[拖放在 C# Winforms 应用程序中不起作用](https://stackoverflow.com/questions/26628492/drag-and-drop-not-working-in-c-sharp-winforms-application)

# css - 使用 CSS 的文本居中在 IE 中不起作用

> ID：68610
> 
> 赞同：6
> 
> 时间：2008-09-16T01:40:10.450
> 
> 标签：css, internet-explorer, center, text-align

我在获取表格中的文本以在 IE 中居中显示时遇到问题。

在 Firefox 2、3 和 Safari 中一切正常，但由于某种原因，文本不会在 IE 6 或 7 中居中显示。

我正在使用：

```
h2 {
  font: 300 12px "Helvetica", serif; 
  text-align: center; 
  text-transform: uppercase;
} 
```

我也尝试添加`margin-left:auto;`,`margin-right:auto`和`position:relative;`

无济于事。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-16T01:52:35.990

CSS text-align 属性应该在父元素上声明，而不是在你试图居中的元素上。IE 使用 text-align: center 属性使文本居中。Firefox 使用 margin: 0 auto 并且必须在您尝试居中的元素上声明。

```
<div style="text-align: center">
    <h2 style="margin: 0 auto">Some text</h2>
</div> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-16T01:41:55.440

表格单元格需要文本对齐：居中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-16T01:56:14.640

可能是错字，但您在这里缺少分号：

```
margin-left:auto; margin-right:auto position:relative; 
```

应该：

```
margin-left:auto; margin-right:auto; position:relative; 
```

如果这不起作用，请确保您尝试将文本居中的元素具有一定的宽度。尝试将宽度设置为 100%，看看是否有任何变化。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-16T01:45:34.230

`text-align: center`应该足够了，因为您将文本置于块元素（h2）内的中心 - 调整边距将更改块的位置，而不是文本。

`font`我想知道是否只是 IE 对你的声明有一个愚蠢的吐口水？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-16T01:46:23.290

在 h2 周围的 div/td 中使用 text-align:center。

```
<table style = "width:400px;border:solid 1px;">
    <tr>
        <td style = "text-align:center;"><h2>hi</h2></td>
    </tr>
</table> 
```

编辑：哇，stackoverflow 的社区非常快！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-10-26T13:43:01.207

如果您可以/想要使用 flexbox，您也可以使用以下内容。

```
display: flex;
justify-content: center;
align-items:center 
```

# java - 将 EJB 2.x BMP 实体 bean 与 Hibernate 3.x 混合

> ID：68614
> 
> 赞同：6
> 
> 时间：2008-09-16T01:41:07.923
> 
> 标签：java, hibernate, jakarta-ee, ejb-2.x

我有一个使用 EJB 2.x 实体 bean (BMP) 的大型应用程序。众所周知，这是一种可怕的持久性策略（如有必要，我可以详细说明）。

我想开始迁移这个应用程序以使用更具表现力、透明和非侵入性的持久性策略，并且鉴于我公司以前的经验，Hibernate 3.x 是显而易见的选择。

迁移到 Hibernate 需要一段时间，因为应用程序中有超过 100 个表使用实体 bean。因此，我正在研究一种分阶段的方法，其中两种持久性策略并行运行，如果可能的话，最好同时在同一张表上运行。

我的问题是，将这两种持久性策略结合起来有哪些陷阱（如果有的话）？他们会互相妨碍吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-16T01:48:09.950

我想真正要小心的是使用 Hibernate 会话。Hibernate 缓存东西，这可能会妨碍。

坦率地说，如果您采用 Hibernate，我会建议您完全放弃 Entity bean。在会话 bean 中执行您的 Hibernate 工作，并让会话 bean 管理您的事务。

或者使用 EJB 3，它是 Hibernate 标准化到 Java Persistence API 中的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-12T23:43:55.067

正如jodonnel所说，你必须注意缓存，因为如果你在Hibernate中使用二级缓存并且在Hibernate之外修改了一个表，那么Hibernate无法知道它的缓存条目是陈旧的。

对于事务，它们都应该使用容器提供的 JTA，因此它应该是安全的。

# oop - 设计问题：是Phone拨打PhoneNumber，还是PhoneNumber在Phone上自己拨打？

> ID：68617
> 
> 赞同：9
> 
> 时间：2008-09-16T01:41:13.490
> 
> 标签：oop

这是从我在 DDD Yahoo! 上发布的内容重新发布的。团体。

在所有条件相同的情况下，你写的是 phone.dial(phoneNumber) 还是 phoneNumber.dialOn(phone)？记住未来可能的要求（除了电话号码之外的帐号，除了电话之外的计算器）。

该选择倾向于说明信息专家、单一职责原则和告诉不要问的习语是如何相互矛盾的。

phoneNumber.dialOn(phone) 支持信息专家并告诉不要问，而 phone.dial(phoneNumber) 支持单一责任原则。

如果您熟悉 Ken Pugh 在 Prefactoring 中的工作，这就是[电子表格难题](http://moffdub.wordpress.com/2008/09/10/the-spreadsheet-conundrum/)；你添加行还是列？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-09-16T01:42:37.043

`phone.dial()`，因为是电话进行拨号。

Actor.Verb( 输入 ) -> 输出。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-09-16T01:54:41.370

Meh - User.Dial（号码）。电话在给定的上下文中毫无意义。SOL（大声说出来）是一种很好的思考方式（除了成语和原则）：

电话有拨号盘。他们不能自己拨号。电话号码是数字。用户在电话拨号上拨打电话号码。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-16T02:52:08.703

问题假设了答案的上下文，因此造成了错误的困境

在这个例子中，“电子表格难题”是一种错误的二分法：行和列是表示层，不一定是数据层。下面的评论告诉我我误解了这个类比，但我不这么认为——说“这应该是一行还是一列，哪一个更有可能改变”正在迫使对问题空间进行不必要的选择——它们都是同样可能改变。而在这个具体的例子中，这会导致选择错误的 [yes *wrong*] 范式为解决方案。拨打电话是旧机械设备如何启动与另一个旧机械设备的连接；对于现代电话来说，这几乎不是一个恰当的类比。并假设有一个“用户”发起呼叫只是移动了问题 - 尽管它朝着正确的方向移动它，即远离旋转电话模型;-)

如果您查看 TAPI [抱歉之前的错字，它是 TAPI 而不是 ATAPI！] 协议是如何工作的，那么有一个呼叫控制器——我想在某种意义上相当于“用户”——管理设备之间的连接。一台设备不呼叫另一台设备，呼叫控制器连接设备。所以下面的例子基本上还是正确的。使用 CallController 对象而不是通用 Connection 可能更正确，但类比应该足够清楚。

在此示例中，电话是具有地址又称为“电话号码”的设备。“拨号”操作员在两个设备之间建立连接。所以答案是：

```
Phone p1 = new Phone(phoneNumber1);
Phone p2 = new Phone(phoneNumber2);
Connection conn = new Connection(p1,p2);
conn.Open();
//...talk
conn.Close(); 
```

这也将支持多方通话，通过重载 Connection 以包含设备列表或其他连接，例如

```
Connection confCall = new Connection(p1,p2,p3,p4,p5,p6);
confCall.Open();

Connection joinCall = new Connection(confCall,p7,p8,conn);
joinCall.Open(); 
```

查看 TAPI 协议以获取更多示例

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-16T01:43:04.593

如果你写的是面向对象，那么你从基本对象开始，它不是号码，号码进入手机，所以 phone.dial() 这样你也可以 phone.answer() phone.disconnect() phone.powerOFF等。

另一种看待它的方式是电话拨打号码还是号码拨打电话？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-16T01:46:00.157

显然，phone.Dial(number)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-16T02:44:35.243

显然，您可以从 PhoneUserFactory.CreatePhoneUser() 方法中获得实现的 PhoneUserInterface 接口有一个方法 dial(Phone, Number) 可以用来拨打电话。

编辑：回答评论。两者都不。电话应该有一个 buttonPressed() 或类似的东西。用户通过该界面输入电话号码的数字/字符。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-16T02:50:43.730

两者都不。用户在电话上拨打电话号码。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-17T01:00:38.963

A: phone.dial(phone_number)

PhoneNumber 是愚蠢的，只是一个数据集。当“拨号”发生时，PhoneNumber 对象是否应该知道如何拨号？有许多状态需要跟踪，例如：

*   电话是否已经在另一个通话中？（如果是/否，怎么办？）
*   如果拨号方式发生变化会怎样？（全球漫游、不同运营商等）
*   另外，范围呢？拨打电话时，需要将电话号码添加到最近拨出电话列表中。

如果您的 PhoneNumber 对象需要知道所有这些，那么它不是 DRY 并且您的代码将不那么可移植并且更有可能被破坏。

我会说 Steven A. Lowe 已经做到了。这应该由一个控制器类型的对象来完成，以处理不同的状态，等等。让你的 PhoneNumber 对象保持沉默，并把聪明才智交给需要担心手机嗡嗡声的中间人。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-17T03:52:49.203

选择是给列对象还是行对象 dial 方法不会改变程序的缩放方式。

dial 方法本身就是一系列行和列方法。您必须询问这些方法依赖于什么。

如果行方法的序列不依赖于确切知道涉及哪个列对象（但确实取决于涉及哪个特定的行对象），*反之亦然*，对于列方法的序列，那么问题缩放为 m + n (m = 行数，n = 数列）。当您创建一个新行时，如果为 column 方法分配了“dial”方法，它实际上并没有为您节省任何工作。您仍然必须指定唯一的行方法序列以在某处的“拨号”中使用！

但是，如果说“dial”中的列方法序列甚至不依赖于涉及哪个*列*对象（它们使用一个“通用”列方法序列），那么问题只是缩放为 m。是否将“dial”方法分配给列对象实际上并不重要，程序仍按 m 缩放；当再添加 1 个列对象时，基本上不需要任何工作来创建新的 dial 方法，并且您显然可以选择将所有这些 dial 方法本身抽象为一个通用的 dial 方法。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-16T02:00:40.357

在这里不要消极，但这类问题非常学术。这完全取决于应用程序。无论哪种方式，我都能想到很好的理由，而且我已经看到太多优秀的程序员陷入这种没有意义的设计细节中。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-16T02:04:48.503

我不确定这与电子表格难题有何关系。您希望将来使用电话拨打帐号吗？在计算器上使用电话号码？你的“未来需求准备”的例子不是很好......

另外，您使用动词“拨号”。当然，我可以想象在电话上“拨打”一个帐号。（不过，这是一个很大的延伸。）但是如果这个电话号码要在计算器上使用，你会称这个动作为“拨号”吗？如果函数的名称根据传递的参数类型而改变，则说明设计错误。

在典型的 OO 设计中，对象会收到携带数据的消息，而不是相反。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-16T02:12:23.900

电话.拨号（）+1。

PhoneNumber 的变体状态或行为是什么？唯一想到的是“拨号规则”（如果在外面，请拨打国家代码，拨打“9”以获取外线等）。这种情况似乎很适合电话。

如果您的对象模型不需要变化——一个数字只是一个数字序列，“拨号”只是 foreach(digit in phonenumber) { press(digit); } 我和 Rob Conery 在一起：嗯。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-16T02:56:57.117

我根本不会将电话号码作为一个类，因为它没有任何行为，它只是一个数据元素。

# .net - 如何将查询字符串解析为 .NET 中的 NameValueCollection

> ID：68624
> 
> 赞同：188
> 
> 时间：2008-09-16T01:42:35.453
> 
> 标签：.net, parsing, query-string

我想将一个字符串解析`p1=6&p2=7&p3=8`成一个`NameValueCollection`.

当您无权访问`Page.Request`对象时，最优雅的方法是什么？

* * *

## 回答 #1

> 赞同：363
> 
> 时间：2008-09-16T01:47:17.690

为此有一个内置的 .NET 实用程序： [HttpUtility.ParseQueryString](http://msdn.microsoft.com/en-us/library/ms150046.aspx)

```
// C#
NameValueCollection qscoll = HttpUtility.ParseQueryString(querystring); 
```

```
' VB.NET
Dim qscoll As NameValueCollection = HttpUtility.ParseQueryString(querystring) 
```

您可能需要替换`querystring`为`new Uri(fullUrl).Query`.

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2008-09-16T02:10:24.247

只要您在 Web 应用程序中或不介意包含对 System.Web 的依赖项，HttpUtility.ParseQueryString 就可以工作。另一种方法是：

```
NameValueCollection queryParameters = new NameValueCollection();
string[] querySegments = queryString.Split('&');
foreach(string segment in querySegments)
{
   string[] parts = segment.Split('=');
   if (parts.Length > 0)
   {
      string key = parts[0].Trim(new char[] { '?', ' ' });
      string val = parts[1].Trim();

      queryParameters.Add(key, val);
   }
} 
```

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2014-03-04T09:25:55.730

由于接受的答案依赖于[System.Web](http://msdn.microsoft.com/en-us/library/system.web.aspx) ，许多答案都提供了自定义示例。从[Microsoft.AspNet.WebApi.Client](http://www.nuget.org/packages/Microsoft.AspNet.WebApi.Client) NuGet 包中，有一个[UriExtensions.ParseQueryString](http://msdn.microsoft.com/en-us/library/system.net.http.uriextensions.parsequerystring.aspx)方法，也可以使用：

```
var uri = new Uri("https://stackoverflow.com/a/22167748?p1=6&p2=7&p3=8");
NameValueCollection query = uri.ParseQueryString(); 
```

因此，如果您想避免[System.Web](http://msdn.microsoft.com/en-us/library/system.web.aspx)依赖并且不想自己滚动，这是一个不错的选择。

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2009-08-24T15:08:27.693

我想删除对 System.Web 的依赖，以便我可以解析 ClickOnce 部署的查询字符串，同时将先决条件限制为“仅限客户端的框架子集”。

我喜欢 rp 的回答。我添加了一些额外的逻辑。

```
public static NameValueCollection ParseQueryString(string s)
    {
        NameValueCollection nvc = new NameValueCollection();

        // remove anything other than query string from url
        if(s.Contains("?"))
        {
            s = s.Substring(s.IndexOf('?') + 1);
        }

        foreach (string vp in Regex.Split(s, "&"))
        {
            string[] singlePair = Regex.Split(vp, "=");
            if (singlePair.Length == 2)
            {
                nvc.Add(singlePair[0], singlePair[1]);
            }
            else
            {
                // only one key with no value specified in query string
                nvc.Add(singlePair[0], string.Empty);
            }
        }

        return nvc;
    } 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2013-05-15T12:57:08.300

我需要一个比处理 OLSC 查询时已经提供的功能更通用的功能。

*   值可能包含多个等号
*   解码名称和值中的编码字符
*   能够在客户端框架上运行
*   能够在移动框架上运行。

这是我的解决方案：

```
Public Shared Function ParseQueryString(ByVal uri As Uri) As System.Collections.Specialized.NameValueCollection
    Dim result = New System.Collections.Specialized.NameValueCollection(4)
    Dim query = uri.Query
    If Not String.IsNullOrEmpty(query) Then
        Dim pairs = query.Substring(1).Split("&"c)
        For Each pair In pairs
            Dim parts = pair.Split({"="c}, 2)

            Dim name = System.Uri.UnescapeDataString(parts(0))
            Dim value = If(parts.Length = 1, String.Empty,
                System.Uri.UnescapeDataString(parts(1)))

            result.Add(name, value)
        Next
    End If
    Return result
End Function 
```

`<Extension()>`将其添加到 Uri 本身可能不是一个坏主意。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2015-10-19T21:43:59.117

要做到这一点`System.Web`，无需自己编写，也无需额外的 NuGet 包：

1.  添加对的引用`System.Net.Http.Formatting`
2.  添加`using System.Net.Http;`
3.  使用此代码：

    ```
    new Uri(uri).ParseQueryString() 
    ```

[https://msdn.microsoft.com/en-us/library/system.net.http.uriextensions(v=vs.118).aspx](https://msdn.microsoft.com/en-us/library/system.net.http.uriextensions(v=vs.118).aspx)

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2017-08-16T14:37:49.317

如果您想避免使用[HttpUtility.ParseQueryString](https://msdn.microsoft.com/en-us/library/ms150046.aspx)所需的对 System.Web 的依赖，您可以`Uri`使用.`ParseQueryString``System.Net.Http`

`System.Net.Http`确保在您的项目中添加一个引用（如果您还没有） 。

请注意，您必须将响应正文转换为有效的`Uri`，以便`ParseQueryString`(in `System.Net.Http`) 起作用。

```
string body = "value1=randomvalue1&value2=randomValue2";

// "http://localhost/query?" is added to the string "body" in order to create a valid Uri.
string urlBody = "http://localhost/query?" + body;
NameValueCollection coll = new Uri(urlBody).ParseQueryString(); 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2014-07-23T21:28:43.080

我刚刚意识到[Web API 客户端](https://www.nuget.org/packages/Microsoft.AspNet.WebApi.Client/)有一个`ParseQueryString`扩展方法，它适用于 a`Uri`并返回 a `HttpValueCollection`：

```
var parameters = uri.ParseQueryString();
string foo = parameters["foo"]; 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2016-07-03T14:40:39.650

# 如果您不想要 System.Web 依赖项，只需从 HttpUtility 类粘贴此源代码。

我只是从[Mono](https://github.com/mono/mono/tree/master/mcs/class/System.Web)的源代码中将其组合在一起。它包含 HttpUtility 及其所有依赖项（如 IHtmlString、Helpers、HttpEncoder、HttpQSCollection）。

*然后*使用`HttpUtility.ParseQueryString`.

[https://gist.github.com/bjorn-ali-goransson/b04a7c44808bb2de8cca3fc9a3762f9c](https://gist.github.com/bjorn-ali-goransson/b04a7c44808bb2de8cca3fc9a3762f9c)

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-09-16T02:00:02.103

```
 private void button1_Click( object sender, EventArgs e )
    {
        string s = @"p1=6&p2=7&p3=8";
        NameValueCollection nvc = new NameValueCollection();

        foreach ( string vp in Regex.Split( s, "&" ) )
        {
            string[] singlePair = Regex.Split( vp, "=" );
            if ( singlePair.Length == 2 )
            {
                nvc.Add( singlePair[ 0 ], singlePair[ 1 ] );    
            }    
        }
    } 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-09-16T01:46:27.737

只需访问 Request.QueryString。作为另一个答案提到的 AllKeys 只会为您提供一组键。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2011-11-17T15:05:03.747

`HttpUtility.ParseQueryString(Request.Url.Query)`返回是`HttpValueCollection`（内部类）。它继承自`NameValueCollection`.

```
 var qs = HttpUtility.ParseQueryString(Request.Url.Query);
    qs.Remove("foo"); 

    string url = "~/Default.aspx"; 
    if (qs.Count > 0)
       url = url + "?" + qs.ToString();

    Response.Redirect(url); 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2014-01-23T13:30:42.557

由于每个人似乎都在粘贴他的解决方案.. 这是我的 :-) 我需要从类库中获取此解决方案，而无需`System.Web`从存储的超链接中获取 id 参数。

想我会分享，因为我发现这个解决方案更快更好看。

```
public static class Statics
    public static Dictionary<string, string> QueryParse(string url)
    {
        Dictionary<string, string> qDict = new Dictionary<string, string>();
        foreach (string qPair in url.Substring(url.IndexOf('?') + 1).Split('&'))
        {
            string[] qVal = qPair.Split('=');
            qDict.Add(qVal[0], Uri.UnescapeDataString(qVal[1]));
        }
        return qDict;
    }

    public static string QueryGet(string url, string param)
    {
        var qDict = QueryParse(url);
        return qDict[param];
    }
} 
```

用法：

```
Statics.QueryGet(url, "id") 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-16T01:45:40.377

点击 Request.QueryString.Keys 获取所有查询字符串参数的 NameValueCollection。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2015-02-24T10:36:23.970

要获取所有 Querystring 值，请尝试以下操作：

```
 Dim qscoll As NameValueCollection = HttpUtility.ParseQueryString(querystring)

Dim sb As New StringBuilder("<br />")
For Each s As String In qscoll.AllKeys

  Response.Write(s & " - " & qscoll(s) & "<br />")

Next s 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2016-01-21T09:42:04.580

```
 var q = Request.QueryString;
        NameValueCollection qscoll = HttpUtility.ParseQueryString(q.ToString()); 
```

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2016-08-20T15:14:37.777

我在 VB 中翻译成 C# 版本的 josh-brown

```
private System.Collections.Specialized.NameValueCollection ParseQueryString(Uri uri)
{
    var result = new System.Collections.Specialized.NameValueCollection(4);
    var query = uri.Query;
    if (!String.IsNullOrEmpty(query))
    {
        var pairs = query.Substring(1).Split("&".ToCharArray());
        foreach (var pair in pairs)
        {
            var parts = pair.Split("=".ToCharArray(), 2);
            var name = System.Uri.UnescapeDataString(parts[0]);
            var value = (parts.Length == 1) ? String.Empty : System.Uri.UnescapeDataString(parts[1]);
            result.Add(name, value);
        }
    }
    return result;
} 
```

* * *

## 回答 #18

> 赞同：-1
> 
> 时间：2020-04-14T22:00:24.403

```
let search = window.location.search;

console.log(search);

let qString = search.substring(1);

while(qString.indexOf("+") !== -1)

   qString  = qString.replace("+", "");

let qArray = qString.split("&");

let values = [];

for(let i = 0; i < qArray.length; i++){
   let pos = qArray[i].search("=");
   let keyVal = qArray[i].substring(0, pos);
   let dataVal = qArray[i].substring(pos + 1);
   dataVal = decodeURIComponent(dataVal);
   values[keyVal] = dataVal;
} 
```

* * *

## 回答 #19

> 赞同：-2
> 
> 时间：2013-11-10T18:19:55.213

这是我的代码，我认为它非常有用：

```
public String GetQueryString(string ItemToRemoveOrInsert = null, string InsertValue = null )
{
    System.Collections.Specialized.NameValueCollection filtered = new System.Collections.Specialized.NameValueCollection(Request.QueryString);
    if (ItemToRemoveOrInsert != null)
    {
        filtered.Remove(ItemToRemoveOrInsert);
        if (!string.IsNullOrWhiteSpace(InsertValue))
        {
            filtered.Add(ItemToRemoveOrInsert, InsertValue);
        }
    }

    string StrQr = string.Join("&", filtered.AllKeys.Select(key => key + "=" + filtered[key]).ToArray());
    if (!string.IsNullOrWhiteSpace(StrQr)){
        StrQr="?" + StrQr;
    }

    return StrQr;
} 
```

# python - 元组比 Python 中的列表更有效吗？

> ID：68630
> 
> 赞同：276
> 
> 时间：2008-09-16T01:43:39.040
> 
> 标签：python, performance, list, tuples, python-internals

在实例化和检索元素时，元组和列表之间是否存在性能差异？

* * *

## 回答 #1

> 赞同：301
> 
> 时间：2014-03-03T06:30:39.500

## 概括

*几乎在每个类别中，*元组的性能都比列表好：**

 *1）元组可以是[常数折叠](https://en.wikipedia.org/wiki/Constant_folding)。

2）元组可以重复使用而不是复制。

3）元组是紧凑的，不会过度分配。

4) 元组直接引用它们的元素。

## 元组可以不断折叠

常量元组可以由 Python 的窥孔优化器或 AST 优化器预先计算。另一方面，列表是从头开始构建的：

```
 >>> from dis import dis

    >>> dis(compile("(10, 'abc')", '', 'eval'))
      1           0 LOAD_CONST               2 ((10, 'abc'))
                  3 RETURN_VALUE   

    >>> dis(compile("[10, 'abc']", '', 'eval'))
      1           0 LOAD_CONST               0 (10)
                  3 LOAD_CONST               1 ('abc')
                  6 BUILD_LIST               2
                  9 RETURN_VALUE 
```

## 元组不需要复制

运行`tuple(some_tuple)`会立即返回。由于元组是不可变的，因此不必复制它们：

```
>>> a = (10, 20, 30)
>>> b = tuple(a)
>>> a is b
True 
```

相反，`list(some_list)`需要将所有数据复制到新列表中：

```
>>> a = [10, 20, 30]
>>> b = list(a)
>>> a is b
False 
```

## 元组不会过度分配

由于元组的大小是固定的，因此它可以比需要过度分配以提高*append()*操作效率的列表更紧凑地存储。

这给元组一个很好的空间优势：

```
>>> import sys
>>> sys.getsizeof(tuple(iter(range(10))))
128
>>> sys.getsizeof(list(iter(range(10))))
200 
```

这是来自*Objects/listobject.c*的注释，它解释了列表的作用：

```
/* This over-allocates proportional to the list size, making room
 * for additional growth.  The over-allocation is mild, but is
 * enough to give linear-time amortized behavior over a long
 * sequence of appends() in the presence of a poorly-performing
 * system realloc().
 * The growth pattern is:  0, 4, 8, 16, 25, 35, 46, 58, 72, 88, ...
 * Note: new_allocated won't overflow because the largest possible value
 *       is PY_SSIZE_T_MAX * (9 / 8) + 6 which always fits in a size_t.
 */ 
```

## 元组直接引用它们的元素

对对象的引用直接合并到元组对象中。相反，列表对外部指针数组有一个额外的间接层。

这为元组索引查找和解包提供了小的速度优势：

```
$ python3.6 -m timeit -s 'a = (10, 20, 30)' 'a[1]'
10000000 loops, best of 3: 0.0304 usec per loop
$ python3.6 -m timeit -s 'a = [10, 20, 30]' 'a[1]'
10000000 loops, best of 3: 0.0309 usec per loop

$ python3.6 -m timeit -s 'a = (10, 20, 30)' 'x, y, z = a'
10000000 loops, best of 3: 0.0249 usec per loop
$ python3.6 -m timeit -s 'a = [10, 20, 30]' 'x, y, z = a'
10000000 loops, best of 3: 0.0251 usec per loop 
```

[以下](https://github.com/python/cpython/blob/54ba556c6c7d8fd5504dc142c2e773890c55a774/Include/cpython/tupleobject.h#L9)是元组`(10, 20)`的存储方式：

```
 typedef struct {
        Py_ssize_t ob_refcnt;
        struct _typeobject *ob_type;
        Py_ssize_t ob_size;
        PyObject *ob_item[2];     /* store a pointer to 10 and a pointer to 20 */
    } PyTupleObject; 
```

[以下](https://github.com/python/cpython/blob/master/Include/listobject.h)是列表`[10, 20]`的存储方式：

```
 PyObject arr[2];              /* store a pointer to 10 and a pointer to 20 */

    typedef struct {
        Py_ssize_t ob_refcnt;
        struct _typeobject *ob_type;
        Py_ssize_t ob_size;
        PyObject **ob_item = arr; /* store a pointer to the two-pointer array */
        Py_ssize_t allocated;
    } PyListObject; 
```

请注意，元组对象直接合并了两个数据指针，而列表对象对保存两个数据指针的外部数组有一个额外的间接层。

* * *

## 回答 #2

> 赞同：225
> 
> 时间：2008-09-16T01:57:10.723

通常，您可能希望元组稍快一些。但是，您绝对应该测试您的具体情况（如果差异可能会影响程序的性能——请记住“过早的优化是万恶之源”）。

Python 让这变得非常简单：[timeit](https://docs.python.org/2/library/timeit.html)是你的朋友。

```
$ python -m timeit "x=(1,2,3,4,5,6,7,8)"
10000000 loops, best of 3: 0.0388 usec per loop

$ python -m timeit "x=[1,2,3,4,5,6,7,8]"
1000000 loops, best of 3: 0.363 usec per loop 
```

和...

```
$ python -m timeit -s "x=(1,2,3,4,5,6,7,8)" "y=x[3]"
10000000 loops, best of 3: 0.0938 usec per loop

$ python -m timeit -s "x=[1,2,3,4,5,6,7,8]" "y=x[3]"
10000000 loops, best of 3: 0.0649 usec per loop 
```

所以在这种情况下，元组的实例化速度几乎快了一个数量级，但列表的项目访问实际上要快一些！因此，如果您要创建几个元组并多次访问它们，实际上使用列表可能会更快。

当然，如果您想*更改*一项，列表肯定会更快，因为您需要创建一个全新的元组来更改其中一项（因为元组是不可变的）。

* * *

## 回答 #3

> 赞同：201
> 
> 时间：2008-09-16T02:13:29.577

该[`dis`](https://docs.python.org/3/library/dis.html)模块对函数的字节码进行反汇编，有助于查看元组和列表之间的区别。

在这种情况下，您可以看到访问元素会生成相同的代码，但分配元组比分配列表要快得多。

```
>>> def a():
...     x=[1,2,3,4,5]
...     y=x[2]
...
>>> def b():
...     x=(1,2,3,4,5)
...     y=x[2]
...
>>> import dis
>>> dis.dis(a)
  2           0 LOAD_CONST               1 (1)
              3 LOAD_CONST               2 (2)
              6 LOAD_CONST               3 (3)
              9 LOAD_CONST               4 (4)
             12 LOAD_CONST               5 (5)
             15 BUILD_LIST               5
             18 STORE_FAST               0 (x)

  3          21 LOAD_FAST                0 (x)
             24 LOAD_CONST               2 (2)
             27 BINARY_SUBSCR
             28 STORE_FAST               1 (y)
             31 LOAD_CONST               0 (None)
             34 RETURN_VALUE
>>> dis.dis(b)
  2           0 LOAD_CONST               6 ((1, 2, 3, 4, 5))
              3 STORE_FAST               0 (x)

  3           6 LOAD_FAST                0 (x)
              9 LOAD_CONST               2 (2)
             12 BINARY_SUBSCR
             13 STORE_FAST               1 (y)
             16 LOAD_CONST               0 (None)
             19 RETURN_VALUE 
```

* * *

## 回答 #4

> 赞同：39
> 
> 时间：2008-09-16T10:16:52.160

元组是不可变的，内存效率更高；列表，为了速度效率，过度分配内存以允许没有常量`realloc`s 的追加。所以，如果你想在你的代码中迭代一个恒定的值序列（例如`for direction in 'up', 'right', 'down', 'left':`），元组是首选，因为这样的元组是在编译时预先计算的。

读取访问速度应该相同（它们都作为连续数组存储在内存中）。

但是，在处理可变数据时`alist.append(item)`更可取。`atuple+= (item,)`请记住，元组旨在被视为没有字段名称的记录。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2018-08-25T08:06:33.077

这是另一个小基准，只是为了它..

```
In [11]: %timeit list(range(100))
749 ns ± 2.41 ns per loop (mean ± std. dev. of 7 runs, 1000000 loops each)

In [12]: %timeit tuple(range(100))
781 ns ± 3.34 ns per loop (mean ± std. dev. of 7 runs, 1000000 loops each) 
```

* * *

```
In [1]: %timeit list(range(1_000))
13.5 µs ± 466 ns per loop (mean ± std. dev. of 7 runs, 100000 loops each)

In [2]: %timeit tuple(range(1_000))
12.4 µs ± 182 ns per loop (mean ± std. dev. of 7 runs, 100000 loops each) 
```

* * *

```
In [7]: %timeit list(range(10_000))
182 µs ± 810 ns per loop (mean ± std. dev. of 7 runs, 10000 loops each)

In [8]: %timeit tuple(range(10_000))
188 µs ± 2.38 µs per loop (mean ± std. dev. of 7 runs, 10000 loops each) 
```

* * *

```
In [3]: %timeit list(range(1_00_000))
2.76 ms ± 30.5 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)

In [4]: %timeit tuple(range(1_00_000))
2.74 ms ± 31.8 µs per loop (mean ± std. dev. of 7 runs, 100 loops each) 
```

* * *

```
In [10]: %timeit list(range(10_00_000))
28.1 ms ± 266 µs per loop (mean ± std. dev. of 7 runs, 10 loops each)

In [9]: %timeit tuple(range(10_00_000))
28.5 ms ± 447 µs per loop (mean ± std. dev. of 7 runs, 10 loops each) 
```

让我们平均一下：

```
In [3]: l = np.array([749 * 10 ** -9, 13.5 * 10 ** -6, 182 * 10 ** -6, 2.76 * 10 ** -3, 28.1 * 10 ** -3])

In [2]: t = np.array([781 * 10 ** -9, 12.4 * 10 ** -6, 188 * 10 ** -6, 2.74 * 10 ** -3, 28.5 * 10 ** -3])

In [11]: np.average(l)
Out[11]: 0.0062112498000000006

In [12]: np.average(t)
Out[12]: 0.0062882362

In [17]: np.average(t) / np.average(l)  * 100
Out[17]: 101.23946713590554 
```

你可以说它几乎没有定论。

但可以肯定的是，与列表相比，元组需要`101.239%`时间或额外的时间来完成这项工作。`1.239%`

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2008-09-16T11:14:08.450

如果列表或元组中的所有项目都属于相同的 C 类型，您还应该考虑`array`标准库中的模块。它将占用更少的内存并且可以更快。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-09-16T01:45:39.753

元组应该比列表更有效，因此比列表更快，因为它们是不可变的。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2020-10-04T04:19:25.873

元组表现更好，但如果元组的所有元素都是不可变的。如果元组的任何元素是可变的列表或函数，则编译将花费更长的时间。在这里，我编译了 3 个不同的对象：

[![在此处输入图像描述](https://i.stack.imgur.com/HfsPB.png)](https://i.stack.imgur.com/HfsPB.png)

在第一个示例中，我编译了一个元组。它在元组中作为常量加载，它加载并返回值。编译需要一步。这称为**常量折叠**。当我用相同的元素编译一个列表时，它必须首先加载每个单独的常量，然后构建列表并返回它。在第三个示例中，我使用了一个包含列表的元组。我为每个操作计时。

[![在此处输入图像描述](https://i.stack.imgur.com/mvl7O.png)](https://i.stack.imgur.com/mvl7O.png)

--**内存分配**

在创建列表、集合、字典等可变容器对象时，在它们的生命周期内，这些容器的分配容量（它们可以包含的项目数）大于容器中的元素数。这样做是为了使向集合中添加元素更有效，称为**过度分配**。因此，列表的大小不会在每次添加元素时都增加——它只是偶尔会增加。调整列表的大小非常昂贵，因此每次添加项目时不要调整大小会有所帮助，但您不想过度分配太多，因为这会消耗内存。

另一方面，不可变容器，因为它们的项目数量在创建后是固定的，不需要这种**过度分配**- 因此它们的存储效率更高。随着元组变大，它们的大小也会增加。

--**复制**

制作不可变序列的浅拷贝是没有意义的，因为无论如何您都无法对其进行变异。所以复制元组只是返回自身，带有内存地址。这就是复制元组更快的原因

## 检索元素

我 timeD 从一个元组和一个列表中检索一个元素：

[![在此处输入图像描述](https://i.stack.imgur.com/On8U0.png)](https://i.stack.imgur.com/On8U0.png)

从元组中检索元素比从列表中检索元素要快得多。因为，在 CPython 中，元组可以直接访问（指针）它们的元素，而列表需要首先访问另一个包含指向列表元素的指针的数组。

* * *

## 回答 #9

> 赞同：-6
> 
> 时间：2018-11-20T01:57:54.663

Tuple 在阅读方面非常高效的主要原因是它是不可变的。

## 为什么不可变对象易于阅读？

原因是元组可以存储在内存缓存中，这与列表不同。程序总是从列表内存位置读取，因为它是可变的（可以随时更改）。

# java - 将匹配 Java 方法声明的正则表达式

> ID：68633
> 
> 赞同：18
> 
> 时间：2008-09-16T01:44:18.960
> 
> 标签：java, regex, methods

我需要一个匹配 java 方法声明的正则表达式。我想出了一个匹配方法声明的方法，但它要求方法的左括号与声明在同一行。如果您对改进我的正则表达式有任何建议，或者只是有一个更好的建议，请提交答案。

这是我的正则表达式：`"\w+ +\w+ *\(.*\) *\{"`

对于那些不知道 java 方法是什么样子的人，我将提供一个基本的方法：

```
int foo()
{

} 
```

java方法有几个可选部分也可以添加，但这些是方法保证具有的唯一部分。

更新：我当前的正则表达式是`"\w+ +\w+ *\([^\)]*\) *\{"`为了防止 Mike 和 adkom 描述的情况。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-05-11T10:23:14.347

```
(public|protected|private|static|\s) +[\w\<\>\[\]]+\s+(\w+) *\([^\)]*\) *(\{?|[^;]) 
```

我认为上面的正则表达式几乎可以匹配Java方法声明的所有可能组合，甚至包括泛型和数组都是返回参数，这是原作者提供的正则表达式不匹配的。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-04-20T09:42:20.850

我也需要这样的正则表达式并想出了这个解决方案：

```
(?:(?:public|private|protected|static|final|native|synchronized|abstract|transient)+\s+)+[$_\w<>\[\]\s]*\s+[\$_\w]+\([^\)]*\)?\s*\{?[^\}]*\}? 
```

这个[语法](http://cui.unige.ch/isi/bnf/JAVA/BNFindex.html)和 Georgios Gousios 的答案对于构建正则表达式很有用。

**编辑：**考虑到 tharindu_DG 的反馈，使组不被捕获，改进了格式。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-09-26T13:56:31.937

在浏览了其他答案后，我想到了以下内容：

```
#permission
   ^[ \t]*(?:(?:public|protected|private)\s+)?
#keywords
   (?:(static|final|native|synchronized|abstract|threadsafe|transient|{#insert zJRgx123GenericsNotInGroup})\s+){0,}
#return type
   #If return type is "return" then it's actually a 'return funcName();' line. Ignore.
   (?!return)
   \b([\w.]+)\b(?:|{#insert zJRgx123GenericsNotInGroup})((?:\[\]){0,})\s+
#function name
   \b\w+\b\s*
#parameters
   \(
      #one
         \s*(?:\b([\w.]+)\b(?:|{#insert zJRgx123GenericsNotInGroup})((?:\[\]){0,})(\.\.\.)?\s+(\w+)\b(?![>\[])
      #two and up
         \(\s*(?:,\s+\b([\w.]+)\b(?:|{#insert zJRgx123GenericsNotInGroup})((?:\[\]){0,})(\.\.\.)?\s+(\w+)\b(?![>\[])\s*){0,})?\s*
   \)
#post parameters
   (?:\s*throws [\w.]+(\s*,\s*[\w.]+))?
#close-curly (concrete) or semi-colon (abstract)
   \s*(?:\{|;)[ \t]*$ 
```

* * *

哪里`{#insert zJRgx123GenericsNotInGroup}`等于

```
`(?:<[?\w\[\] ,.&]+>)|(?:<[^<]*<[?\w\[\] ,.&]+>[^>]*>)|(?:<[^<]*<[^<]*<[?\w\[\] ,.&]+>[^>]*>[^>]*>)` 
```

限制：

*   任何参数都可以有省略号：“...”（Java 只允许最后一个）
*   最多三层嵌套泛型：（`<...<...<...>...>...>`好的，`<...<...<...<...>...>...>...>`坏的）。泛型内部的语法可能非常虚假，并且对于这个正则表达式来说似乎还可以。
*   类型和它们的（可选的）开放泛型之间不需要空格'<'
*   识别内部类，但不阻止相邻的两个点，例如 Class....InnerClass

下面是原始的 PhraseExpress 代码（第 1 行的自动文本和描述，第 2 行的正文）。打电话`{#insert zJRgxJavaFuncSigThrSemicOrOpnCrly}`，你会得到这个：

```
^[ \t]*(?:(?:public|protected|private)\s+)?(?:(static|final|native|synchronized|abstract|threadsafe|transient|(?:<[?\w\[\] ,&]+>)|(?:<[^<]*<[?\w\[\] ,&]+>[^>]*>)|(?:<[^<]*<[^<]*<[?\w\[\] ,&]+>[^>]*>[^>]*>))\s+){0,}(?!return)\b([\w.]+)\b(?:|(?:<[?\w\[\] ,&]+>)|(?:<[^<]*<[?\w\[\] ,&]+>[^>]*>)|(?:<[^<]*<[^<]*<[?\w\[\] ,&]+>[^>]*>[^>]*>))((?:\[\]){0,})\s+\b\w+\b\s*\(\s*(?:\b([\w.]+)\b(?:|(?:<[?\w\[\] ,&]+>)|(?:<[^<]*<[?\w\[\] ,&]+>[^>]*>)|(?:<[^<]*<[^<]*<[?\w\[\] ,&]+>[^>]*>[^>]*>))((?:\[\]){0,})(\.\.\.)?\s+(\w+)\b(?![>\[])\s*(?:,\s+\b([\w.]+)\b(?:|(?:<[?\w\[\] ,&]+>)|(?:<[^<]*<[?\w\[\] ,&]+>[^>]*>)|(?:<[^<]*<[^<]*<[?\w\[\] ,&]+>[^>]*>[^>]*>))((?:\[\]){0,})(\.\.\.)?\s+(\w+)\b(?![>\[])\s*){0,})?\s*\)(?:\s*throws [\w.]+(\s*,\s*[\w.]+))?\s*(?:\{|;)[ \t]*$ 
```

* * *

原始代码：

```
zJRgx123GenericsNotInGroup -- To precede return-type    (?:<[?\w\[\] ,.&]+>)|(?:<[^<]*<[?\w\[\] ,.&]+>[^>]*>)|(?:<[^<]*<[^<]*<[?\w\[\] ,.&]+>[^>]*>[^>]*>)  zJRgx123GenericsNotInGroup
zJRgx0OrMoreParams  \s*(?:{#insert zJRgxParamTypeName}\s*(?:,\s+{#insert zJRgxParamTypeName}\s*){0,})?\s*   zJRgx0OrMoreParams
zJRgxJavaFuncNmThrClsPrn_M_fnm -- Needs zvFOBJ_NAME (?<=\s)\b{#insert zvFOBJ_NAME}{#insert zzJRgxPostFuncNmThrClsPrn}   zJRgxJavaFuncNmThrClsPrn_M_fnm
zJRgxJavaFuncSigThrSemicOrOpnCrly -(**)-    {#insert zzJRgxJavaFuncSigPreFuncName}\w+{#insert zzJRgxJavaFuncSigPostFuncName}    zJRgxJavaFuncSigThrSemicOrOpnCrly
zJRgxJavaFuncSigThrSemicOrOpnCrly_M_fnm -- Needs zvFOBJ_NAME    {#insert zzJRgxJavaFuncSigPreFuncName}{#insert zvFOBJ_NAME}{#insert zzJRgxJavaFuncSigPostFuncName}  zJRgxJavaFuncSigThrSemicOrOpnCrly_M_fnm
zJRgxOptKeywordsBtwScopeAndRetType  (?:(static|final|native|synchronized|abstract|threadsafe|transient|{#insert zJRgx123GenericsNotInGroup})\s+){0,}    zJRgxOptKeywordsBtwScopeAndRetType
zJRgxOptionalPubProtPriv    (?:(?:public|protected|private)\s+)?    zJRgxOptionalPubProtPriv
zJRgxParamTypeName -(**)- Ends w/ '\b(?![>\[])' to NOT find <? 'extends XClass'> or ...[]>  (*Original: zJRgxParamTypeName, Needed by: zJRgxParamTypeName[4FQPTV,ForDel[NmsOnly,Types]]*){#insert zJRgxTypeW0123GenericsArry}(\.\.\.)?\s+(\w+)\b(?![>\[])   zJRgxParamTypeName
zJRgxTypeW0123GenericsArry -- Grp1=Type, Grp2='[]', if any  \b([\w.]+)\b(?:|{#insert zJRgx123GenericsNotInGroup})((?:\[\]){0,}) zJRgxTypeW0123GenericsArry
zvTTL_PRMS_stL1c    {#insert zCutL1c}{#SETPHRASE -description zvTTL_PRMS -content {#INSERTCLIPBOARD} -autotext zvTTL_PRMS -folder ctvv_folder}  zvTTL_PRMS_stL1c
zvTTL_PRMS_stL1cSvRstrCB    {#insert zvCB_CONTENTS_stCB}{#insert zvTTL_PRMS_stL1c}{#insert zSetCBToCB_CONTENTS} zvTTL_PRMS_stL1cSvRstrCB
zvTTL_PRMS_stPrompt {#SETPHRASE -description zvTTL_PRMS -content {#INPUT -head How many parameters? -single} -autotext zvTTL_PRMS -folder ctvv_folder}  zvTTL_PRMS_stPrompt
zzJRgxJavaFuncNmThrClsPrn_M_fnmTtlp -- Needs zvFOBJ_NAME, zvTTL_PRMS    (?<=[ \t])\b{#insert zvFOBJ_NAME}\b\s*\(\s*{#insert {#COND -if {#insert zvTTL_PRMS} = 0 -then z1slp -else zzParamsGT0_M_ttlp}}\)    zzJRgxJavaFuncNmThrClsPrn_M_fnmTtlp
zzJRgxJavaFuncSigPostFuncName   {#insert zzJRgxPostFuncNmThrClsPrn}(?:\s*throws \b(?:[\w.]+)\b(\s*,\s*\b(?:[\w.]+)\b))?\s*(?:\{|;)[ \t]*$   zzJRgxJavaFuncSigPostFuncName
zzJRgxJavaFuncSigPreFuncName    (*If a type has generics, there may be no spaces between it and the first open '<', also requires generics with three nestings at the most (<...<...<...>...>...> okay, <...<...<...<...>...>...>...> not)*)^[ \t]*{#insert zJRgxOptionalPubProtPriv}{#insert zJRgxOptKeywordsBtwScopeAndRetType}(*To prevent 'return funcName();' from being recognized:*)(?!return){#insert zJRgxTypeW0123GenericsArry}\s+\b  zzJRgxJavaFuncSigPreFuncName
zzJRgxPostFuncNmThrClsPrn   \b\s*\({#insert zJRgx0OrMoreParams}\)   zzJRgxPostFuncNmThrClsPrn
zzParamsGT0_M_ttlp -- Needs zvTTL_PRMS  {#insert zJRgxParamTypeName}\s*{#insert {#COND -if {#insert zvTTL_PRMS} = 1 -then z1slp -else zzParamsGT1_M_ttlp}}  zzParamsGT0_M_ttlp
zzParamsGT1_M_ttlp  {#LOOP ,\s+{#insert zJRgxParamTypeName}\s* -count {#CALC {#insert zvTTL_PRMS} - 1 -round 0 -thousands none}}    zzParamsGT1_M_ttlp 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-16T01:50:52.330

您是否考虑过匹配实际可能的关键字？如：

```
(?:(?:public)|(?:private)|(?:static)|(?:protected)\s+)* 
```

它可能更有可能正确匹配，尽管它也可能使正则表达式更难阅读......

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-16T01:54:17.127

我很确定 Java 的正则表达式引擎在默认情况下是贪婪的，这意味着它`"\w+ +\w+ *\(.*\) *\{"`永远不会匹配，因为`.*`括号内的将吃掉左括号后的所有内容。我建议您将 替换为`.*`[^)]，这样您将选择所有非关闭括号字符。

**注意：** Mike Stone 在评论中纠正了我，因为大多数人并没有真正打开评论（我知道我经常没有注意到它们）：

> 贪婪并不意味着它永远不会匹配......但如果有更多的括号来满足正则表达式的其余部分，它会吃掉括号......例如“public void foo（int arg）{ if（test）{ System.exit(0); } }" 将无法正确匹配...

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-16T02:28:16.217

我想出了这个：

```
\b\w*\s*\w*\(.*?\)\s*\{[\x21-\x7E\s]*\} 
```

我针对 PHP 函数对其进行了测试，但它应该可以正常工作，这是我使用的代码片段：

```
function getProfilePic($url)
 {
    if(@open_image($url) !== FALSE)
     {
        @imagepng($image, 'images/profiles/' . $_SESSION['id'] . '.png');
        @imagedestroy($image);
        return TRUE;
     }
    else 
     {
        return FALSE;
     }
 } 
```

更多信息：

```
Options: case insensitive

Assert position at a word boundary «\b»
Match a single character that is a “word character” (letters, digits, etc.) «\w*»
   Between zero and unlimited times, as many times as possible, giving back as needed (greedy) «*»
Match a single character that is a “whitespace character” (spaces, tabs, line breaks, etc.) «\s*»
   Between zero and unlimited times, as many times as possible, giving back as needed (greedy) «*»
Match a single character that is a “word character” (letters, digits, etc.) «\w*»
   Between zero and unlimited times, as many times as possible, giving back as needed (greedy) «*»
Match the character “(” literally «\(»
Match any single character that is not a line break character «.*?»
   Between zero and unlimited times, as few times as possible, expanding as needed (lazy) «*?»
Match the character “)” literally «\)»
Match a single character that is a “whitespace character” (spaces, tabs, line breaks, etc.) «\s*»
   Between zero and unlimited times, as many times as possible, giving back as needed (greedy) «*»
Match the character “{” literally «\{»
Match a single character present in the list below «[\x21-\x7E\s]*»
   Between zero and unlimited times, as many times as possible, giving back as needed (greedy) «*»
   A character in the range between ASCII character 0x21 (33 decimal) and ASCII character 0x7E (126 decimal) «\x21-\x7E»
   A whitespace character (spaces, tabs, line breaks, etc.) «\s»
Match the character “}” literally «\}»

Created with RegexBuddy 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2018-01-03T06:19:49.123

`(public|private|static|protected|abstract|native|synchronized) +([a-zA-Z0-9<>._?, ]+) +([a-zA-Z0-9_]+) *\\([a-zA-Z0-9<>\\[\\]._?, \n]*\\) *([a-zA-Z0-9_ ,\n]*) *\\{`

上面的 Regex 将检测所有可能的 java 方法定义。在大量源代码文件上进行了测试。要包含构造函数，请使用以下正则表达式：

`(public|private|static|protected|abstract|native|synchronized) +([a-zA-Z0-9<>._?, ]*) +([a-zA-Z0-9_]+) *\\([a-zA-Z0-9<>\\[\\]._?, \n]*\\) *([a-zA-Z0-9_ ,\n]*) *\\{`

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-16T05:31:29.867

一个提示：

如果您打算在 Perl 中编写正则表达式，请使用“xms”选项，以便您可以留下空格并记录正则表达式。例如，您可以编写如下正则表达式：

```
 m{\w+ \s+      #return type
   \w+ \s*      #function name
   [(] [^)]* [)] #params
   \s* [{]           #open paren
  }xms 
```

其中一个选项（想想 x）允许在正则表达式中使用 # 注释。也使用 \s 而不是“”。\s 代表任何“空白”字符。所以标签也会匹配——这就是你想要的。在 Perl 中你不需要使用 //，你可以使用 { } 或 < > 或 | |。

不确定其他语言是否有这种能力。如果他们这样做，那么请使用它们。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-01-16T20:30:04.873

这是针对更具体的用例，但它非常简单，我相信它值得分享。我这样做是为了找到“公共静态无效”方法，即播放控制器操作，我是从 Windows/Cygwin 命令行使用 grep 完成的；见：[https ://stackoverflow.com/a/7167115/34806](https://stackoverflow.com/a/7167115/34806)

```
cat Foobar.java | grep -Pzo '(?s)public static void.*?\)\s+{' 
```

我输出的最后两个条目如下：

```
public static void activeWorkEventStations (String type,
            String symbol,
            String section,
            String day,
            String priority,
            @As("yyyy-MM-dd") Date scheduleDepartureDate) {
public static void getActiveScheduleChangeLogs(String type,
            String symbol,
            String section,
            String day,
            String priority,
            @As("yyyy-MM-dd") Date scheduleDepartureDate) { 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2018-10-25T19:09:52.247

从 git 2.19.0 开始，[Java 的内置正则表达式](https://git.kernel.org/pub/scm/git/git.git/tree/userdiff.c)现在似乎运行良好，因此可能不需要提供您自己的正则表达式。

```
"!^[ \t]*(catch|do|for|if|instanceof|new|return|switch|throw|while)\n"
"^[ \t]*(([A-Za-z_][A-Za-z_0-9]*[ \t]+)+[A-Za-z_][A-Za-z_0-9]*[ \t]*\\([^;]*)$" 
```

（第一行似乎是为了过滤掉类似于方法声明但不是的行。）

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2019-03-07T19:01:16.883

这将选择方法的名称而不是整行。

```
(?<=public static void )\w+|(?<=private static void )\w+|(?<=protected static void )\w+|(?<=public void )\w+|(?<=private void )\w+|(?<=protected void )\w+|(?<=public final void)\w+|(?<=private final void)\w+|(?<=protected final void)\w+|(?<=private void )\w+|(?<=protected void )\w+|(?<=public static final void )\w+|(?<=private static final void )\w+|(?<=public final static void )\w+|(?<=protected final static void )\\w+|(?<=private final static void )\w+|(?<=protected final static void )\w+|(?<=void )\w+|(?<=private static )\w+ 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-07-26T15:02:50.220

我根据 Georgios Gousios 的回答为[ctrlp/funky构建了一个 vim 正则表达式。](https://github.com/pydave/ctrlp-funky/blob/master/autoload/ctrlp/funky/java.vim)

```
 let regex = '\v^\s+'                " preamble
    let regex .= '%(<\w+>\s+){0,3}'     " visibility, static, final
    let regex .= '%(\w|[<>[\]])+\s+'    " return type
    let regex .= '\w+\s*'               " method name
    let regex .= '\([^\)]*\)'           " method parameters
    let regex .= '%(\w|\s|\{)+$'        " postamble 
```

我猜这在 Java 中看起来像这样：

```
^\s+(?:<\w+>\s+){0,3}(?:[\w\<\>\[\]])+\s+\w+\s*\([^\)]*\)(?:\w|\s|\{)+$ 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2016-03-25T09:23:53.573

我发现**seba229**的答案很有用，它捕获了大多数场景，但不是以下场景，

```
public <T> T name(final Class<T> x, final T y) 
```

这个正则表达式也将捕捉到这一点。

```
((public|private|protected|static|final|native|synchronized|abstract|transient)+\s)+[\$_\w\<\>\w\s\[\]]*\s+[\$_\w]+\([^\)]*\)?\s* 
```

希望这可以帮助。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2017-08-27T01:18:58.510

```
(public|private|static|protected) ([A-Za-z0-9<>.]+) ([A-Za-z0-9]+)\( 
```

此外，这是您可以在 IntelliJ 中使用的替换序列

```
$1 $2 $3( 
```

我这样使用它：

```
$1 $2 aaa$3( 
```

在将 Java 文件转换为 Kotlin 以防止以“get”开头的函数自动变成变量时。不适用于“默认”访问级别，但我自己并没有使用那么多。

# c# - 你可以在结构中有一个类吗？

> ID：68640
> 
> 赞同：30
> 
> 时间：2008-09-16T01:45:44.510
> 
> 标签：c#, class, struct, value-type, reference-type

在 C# 中是否可以有一个带有类类型成员变量的 Struct？如果是这样，信息存储在哪里，在堆栈、堆或两者上？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-09-16T01:53:07.223

是的你可以。指向类成员变量的指针与结构的其余值一起存储~~在堆栈中，类实例的数据存储在堆中。~~

结构也可以包含类定义作为成员（内部类）。

这是一些非常无用的代码，至少可以编译并运行以表明它是可能的：

```
using System;

namespace ConsoleApplication1
{
    class Program
    {
        static void Main(string[] args)
        {
            MyStr m = new MyStr();
            m.Foo();

            MyStr.MyStrInner mi = new MyStr.MyStrInner();
            mi.Bar();

            Console.ReadLine();
        }
    }

    public class Myclass
    {
        public int a;
    }

    struct MyStr
    {
        Myclass mc;

        public void Foo()
        {
            mc = new Myclass();
            mc.a = 1;
        }

        public class MyStrInner
        {
            string x = "abc";

            public string Bar()
            {
                return x;
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2011-07-23T15:53:20.620

类内容存储在堆上。

对类的引用（几乎与指针相同）与结构内容一起存储。结构内容的存储位置取决于它是局部变量、方法参数还是类的成员，以及它是被装箱还是被闭包捕获。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-09T16:14:14.513

如果结构的字段之一是类类型，则该字段将保存类对象的*标识*或空引用。如果所讨论的类对象是不可变的（例如`string`），则存储其身份也将有效地存储其内容。但是，如果所讨论的类对象是可变的，则存储标识将是存储内容的一种有效方法，*当且仅当引用永远不会落入一旦存储在 field 中可能会改变它的任何代码的手中*。

通常，除非以下两种情况之一适用，否则应避免在结构中存储可变类类型：

1.  实际上，人们感兴趣的是类对象的身份而不是其内容。例如，可以定义一个 `FormerControlBounds` 结构，该结构包含 `Control` 和 `Rectangle` 类型的字段，并表示控件在某个时刻具有的 `Bounds`，以便以后能够恢复该控件到它之前的位置。'Control' 字段的目的不是保存控件状态的副本，而是标识应该恢复其位置的控件。一般来说，结构应该避免访问它持有引用的对象的任何可变成员，除非这种访问很明显是指所讨论对象的当前可变状态（例如在`CaptureControlPosition`或` RestoreControlToCapturedPosition` 方法，
2.  该字段是“私有”的，读取它的唯一方法是为了检查其属性而不将对象本身暴露给外部代码，并且写入它的唯一方法将创建一个新对象，执行所有突变这将发生在它身上，然后存储对该对象的引用。例如，可以设计一个“结构”，它的行为很像一个数组，但具有值语义，通过让结构在私有字段中保存一个数组，并通过每次尝试写入数组来创建一个包含数据的新数组从旧数组修改新数组，并将修改后的数组存储到该字段。请注意，即使数组本身是可变类型，但存储在该字段中的每个数组实例实际上都是不可变的，

请注意，场景 #1 在泛型类型中很常见；例如，有一个字典，其“值”是可变对象的身份是很常见的；枚举该字典将返回`KeyValuePair`其`Value`字段包含该可变类型的实例。

场景 #2 不太常见。唉，没有办法告诉编译器除了属性设置器之外的结构方法会修改结构，因此应该禁止在只读上下文中使用它们；可以有一个行为类似于 a 的结构`List<T>`，但具有值语义，并包含一个`Add`方法，但尝试调用`Add`在只读结构实例上会生成虚假代码而不是编译器错误。此外，这种结构上的变异方法和属性设置器通常会表现得很差。当此类结构作为不可变包装存在于其他可变类上时，它们可能很有用；如果这样的结构从不装箱，性能通常会比类好。如果只装箱一次（例如通过转换为接口类型），性能通常与类相当。如果反复装箱，性能可能会比班级差得多。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-16T02:12:00.640

这样做可能不是推荐的做法：请参阅[http://msdn.microsoft.com/en-us/library/ms229017(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms229017(VS.85).aspx)

> 引用类型在堆上分配，内存管理由垃圾收集器处理。
> 
> 值类型在堆栈或内联上分配，并在超出范围时被释放。
> 
> 通常，值类型的分配和解除分配成本更低。但是，如果在需要大量装箱和拆箱的场景中使用它们，则与引用类型相比，它们的性能较差。

# python - Python中可以使用静态类变量吗？

> ID：68645
> 
> 赞同：2309
> 
> 时间：2008-09-16T01:46:36.847
> 
> 标签：python, class, oop, static, class-variables

Python中是否可以有静态类变量或方法？执行此操作需要什么语法？

* * *

## 回答 #1

> 赞同：2192
> 
> 时间：2008-09-16T01:51:06.713

在类定义内但不在方法内声明的变量是类或静态变量：

```
>>> class MyClass:
...     i = 3
...
>>> MyClass.i
3 
```

正如[@millerdev](https://stackoverflow.com/questions/68645/static-class-variables-in-python#answer-69067)指出的那样，这会创建一个类级`i`变量，但这与任何实例级`i`变量不同，所以你可以

```
>>> m = MyClass()
>>> m.i = 4
>>> MyClass.i, m.i
>>> (3, 4) 
```

这与 C++ 和 Java 不同，但与 C# 并没有太大不同，后者不能使用对实例的引用来访问静态成员。

看看[Python 教程中关于类和类对象的内容](https://docs.python.org/3/tutorial/classes.html#class-objects)。

@Steve Johnson 已经回答了有关[静态方法](http://web.archive.org/web/20090214211613/http://pyref.infogami.com/staticmethod)的问题，也记录在[Python 库参考中的“内置函数”](https://docs.python.org/3/library/functions.html#staticmethod)下。

```
class C:
    @staticmethod
    def f(arg1, arg2, ...): ... 
```

@beidy 建议使用[classmethod](https://docs.python.org/3/library/functions.html#classmethod)而不是 staticmethod，因为该方法会接收类类型作为第一个参数。

* * *

## 回答 #2

> 赞同：715
> 
> 时间：2008-09-16T03:04:08.783

@Blair Conrad 说在类定义中声明但不在方法中声明的静态变量是类或“静态”变量：

```
>>> class Test(object):
...     i = 3
...
>>> Test.i
3 
```

这里有一些问题。从上面的例子继续：

```
>>> t = Test()
>>> t.i     # "static" variable accessed via instance
3
>>> t.i = 5 # but if we assign to the instance ...
>>> Test.i  # we have not changed the "static" variable
3
>>> t.i     # we have overwritten Test.i on t by creating a new attribute t.i
5
>>> Test.i = 6 # to change the "static" variable we do it by assigning to the class
>>> t.i
5
>>> Test.i
6
>>> u = Test()
>>> u.i
6           # changes to t do not affect new instances of Test

# Namespaces are one honking great idea -- let's do more of those!
>>> Test.__dict__
{'i': 6, ...}
>>> t.__dict__
{'i': 5}
>>> u.__dict__
{} 
```

注意`t.i`当属性`i`直接设置在`t`. 这是因为在命名空间`i`内重新绑定`t`，这与`Test`命名空间不同。如果要更改“静态”变量的值，则必须在最初定义的范围（或对象）内更改它。我将“静态”放在引号中，因为 Python 并没有 C++ 和 Java 那样的静态变量。

虽然它没有具体说明静态变量或方法，但[Python 教程](http://docs.python.org/tut/)有一些关于[类和类对象](https://docs.python.org/2/tutorial/classes.html)的相关信息。

@Steve Johnson 还回答了有关静态方法的问题，也记录在 Python 库参考中的“内置函数”下。

```
class Test(object):
    @staticmethod
    def f(arg1, arg2, ...):
        ... 
```

@beid 还提到了 classmethod，它类似于 staticmethod。类方法的第一个参数是类对象。例子：

```
class Test(object):
    i = 3 # class (or static) variable
    @classmethod
    def g(cls, arg):
        # here we can use 'cls' instead of the class name (Test)
        if arg > cls.i:
            cls.i = arg # would be the same as Test.i = arg1 
```

[![上述示例的图示](https://i.stack.imgur.com/xqnxe.jpg)](https://i.stack.imgur.com/xqnxe.jpg)

* * *

## 回答 #3

> 赞同：247
> 
> 时间：2014-12-19T15:16:36.027

## 静态和类方法

正如其他答案所指出的，静态和类方法可以使用内置装饰器轻松完成：

```
class Test(object):

    # regular instance method:
    def my_method(self):
        pass

    # class method:
    @classmethod
    def my_class_method(cls):
        pass

    # static method:
    @staticmethod
    def my_static_method():
        pass 
```

像往常一样，第一个参数`my_method()`绑定到类实例对象。相反，第一个参数 to*绑定到类对象本身*`my_class_method()`（例如，在这种情况下，）。对于，没有任何参数是绑定的，并且完全有参数是可选的。*`Test``my_static_method()`*

 *## “静态变量”

但是，实现“静态变量”（无论如何，*可变*静态变量，如果这在术语上不矛盾的话......）并不那么简单。正如 millerdev[在他的回答中指出的那样](https://stackoverflow.com/a/69067/2437514)，问题在于 Python 的类属性并不是真正的“静态变量”。考虑：

```
class Test(object):
    i = 3  # This is a class attribute

x = Test()
x.i = 12   # Attempt to change the value of the class attribute using x instance
assert x.i == Test.i  # ERROR
assert Test.i == 3    # Test.i was not affected
assert x.i == 12      # x.i is a different object than Test.i 
```

这是因为该行`x.i = 12`添加了一个新的实例属性`i`，`x`而不是更改`Test`类`i`属性的值。

*部分*预期的静态变量行为，即多个实例之间的属性同步（但**不**与类本身同步；参见下面的“gotcha”），可以通过将类属性转换为属性来实现：

```
class Test(object):

    _i = 3

    @property
    def i(self):
        return type(self)._i

    @i.setter
    def i(self,val):
        type(self)._i = val

## ALTERNATIVE IMPLEMENTATION - FUNCTIONALLY EQUIVALENT TO ABOVE ##
## (except with separate methods for getting and setting i) ##

class Test(object):

    _i = 3

    def get_i(self):
        return type(self)._i

    def set_i(self,val):
        type(self)._i = val

    i = property(get_i, set_i) 
```

现在你可以这样做：

```
x1 = Test()
x2 = Test()
x1.i = 50
assert x2.i == x1.i  # no error
assert x2.i == 50    # the property is synced 
```

静态变量现在将*在所有类实例之间*保持同步。

（注意：也就是说，除非一个类实例决定定义它自己的版本`_i`！但是如果有人决定这样做，他们应该得到他们得到的，不是吗？？？）

请注意，从技术上讲，`i`它仍然根本不是“静态变量”；它是 a `property`，它是一种特殊类型的描述符。但是，该`property`行为现在等效于跨所有类实例同步的（可变）静态变量。

## 不可变的“静态变量”

对于不可变的静态变量行为，只需省略`property`setter：

```
class Test(object):

    _i = 3

    @property
    def i(self):
        return type(self)._i

## ALTERNATIVE IMPLEMENTATION - FUNCTIONALLY EQUIVALENT TO ABOVE ##
## (except with separate methods for getting i) ##

class Test(object):

    _i = 3

    def get_i(self):
        return type(self)._i

    i = property(get_i) 
```

现在尝试设置实例`i`属性将返回`AttributeError`：

```
x = Test()
assert x.i == 3  # success
x.i = 12         # ERROR 
```

## 需要注意的一个问题

请注意，上述方法仅适用于您的类的*实例*——它们在*使用类本身时***不起作用**。例如：

 *```
x = Test()
assert x.i == Test.i  # ERROR

# x.i and Test.i are two different objects:
type(Test.i)  # class 'property'
type(x.i)     # class 'int' 
```

该行`assert Test.i == x.i`产生错误，因为 和 的属性`i`是两个不同的对象。`Test``x`

许多人会对此感到惊讶。但是，它不应该。如果我们返回并检查我们的`Test`类定义（第二个版本），我们会注意到这一行：

```
 i = property(get_i) 
```

显然，成员`i`必须`Test`是`property`对象，也就是`property`函数返回的对象类型。

如果您觉得上述内容令人困惑，那么您很可能还在从其他语言（例如 Java 或 c++）的角度来思考它。你应该去研究`property`对象，了解 Python 属性的返回顺序、描述符协议和方法解析顺序 (MRO)。

我在下面提出了上述“问题”的解决方案；但是，我会强烈建议您不要尝试执行以下操作，直到（至少）彻底理解`assert Test.i = x.i`导致错误的原因。

## *REAL，ACTUAL*静态变量 -`Test.i == x.i`

我在下面提供（Python 3）解决方案仅供参考。我不认可它是一个“好的解决方案”。我怀疑在 Python 中模拟其他语言的静态变量行为是否真的有必要。但是，不管它是否真的有用，下面的内容应该有助于进一步理解 Python 的工作原理。

更新：这个尝试**真的很糟糕**；如果您坚持做这样的事情（提示：请不要；Python 是一种非常优雅的语言，并且没有必要将它硬塞到像另一种语言一样的行为中），请改用[Ethan Furman 的答案](https://stackoverflow.com/a/36216964/2437514)中的代码。

**使用元类模拟其他语言的静态变量行为**

元类是类的类。Python 中所有类的默认元类（即，我相信 Python 2.3 之后的“新样式”类）是`type`. 例如：

```
type(int)  # class 'type'
type(str)  # class 'type'
class Test(): pass
type(Test) # class 'type' 
```

但是，您可以像这样定义自己的元类：

```
class MyMeta(type): pass 
```

并将其应用到您自己的类中（仅限 Python 3）：

```
class MyClass(metaclass = MyMeta):
    pass

type(MyClass)  # class MyMeta 
```

下面是我创建的一个元类，它试图模拟其他语言的“静态变量”行为。它基本上通过将默认的 getter、setter 和 deleter 替换为检查请求的属性是否是“静态变量”的版本来工作。

“静态变量”的目录存储在`StaticVarMeta.statics`属性中。最初尝试使用替代解析顺序来解析所有属性请求。我称其为“静态解决顺序”或“SRO”。这是通过在给定类（或其父类）的“静态变量”集中查找请求的属性来完成的。如果属性未出现在“SRO”中，则该类将回退到默认属性获取/设置/删除行为（即“MRO”）。

```
from functools import wraps

class StaticVarsMeta(type):
    '''A metaclass for creating classes that emulate the "static variable" behavior
    of other languages. I do not advise actually using this for anything!!!

    Behavior is intended to be similar to classes that use __slots__. However, "normal"
    attributes and __statics___ can coexist (unlike with __slots__). 

    Example usage: 

        class MyBaseClass(metaclass = StaticVarsMeta):
            __statics__ = {'a','b','c'}
            i = 0  # regular attribute
            a = 1  # static var defined (optional)

        class MyParentClass(MyBaseClass):
            __statics__ = {'d','e','f'}
            j = 2              # regular attribute
            d, e, f = 3, 4, 5  # Static vars
            a, b, c = 6, 7, 8  # Static vars (inherited from MyBaseClass, defined/re-defined here)

        class MyChildClass(MyParentClass):
            __statics__ = {'a','b','c'}
            j = 2  # regular attribute (redefines j from MyParentClass)
            d, e, f = 9, 10, 11   # Static vars (inherited from MyParentClass, redefined here)
            a, b, c = 12, 13, 14  # Static vars (overriding previous definition in MyParentClass here)'''
    statics = {}
    def __new__(mcls, name, bases, namespace):
        # Get the class object
        cls = super().__new__(mcls, name, bases, namespace)
        # Establish the "statics resolution order"
        cls.__sro__ = tuple(c for c in cls.__mro__ if isinstance(c,mcls))

        # Replace class getter, setter, and deleter for instance attributes
        cls.__getattribute__ = StaticVarsMeta.__inst_getattribute__(cls, cls.__getattribute__)
        cls.__setattr__ = StaticVarsMeta.__inst_setattr__(cls, cls.__setattr__)
        cls.__delattr__ = StaticVarsMeta.__inst_delattr__(cls, cls.__delattr__)
        # Store the list of static variables for the class object
        # This list is permanent and cannot be changed, similar to __slots__
        try:
            mcls.statics[cls] = getattr(cls,'__statics__')
        except AttributeError:
            mcls.statics[cls] = namespace['__statics__'] = set() # No static vars provided
        # Check and make sure the statics var names are strings
        if any(not isinstance(static,str) for static in mcls.statics[cls]):
            typ = dict(zip((not isinstance(static,str) for static in mcls.statics[cls]), map(type,mcls.statics[cls])))[True].__name__
            raise TypeError('__statics__ items must be strings, not {0}'.format(typ))
        # Move any previously existing, not overridden statics to the static var parent class(es)
        if len(cls.__sro__) > 1:
            for attr,value in namespace.items():
                if attr not in StaticVarsMeta.statics[cls] and attr != ['__statics__']:
                    for c in cls.__sro__[1:]:
                        if attr in StaticVarsMeta.statics[c]:
                            setattr(c,attr,value)
                            delattr(cls,attr)
        return cls
    def __inst_getattribute__(self, orig_getattribute):
        '''Replaces the class __getattribute__'''
        @wraps(orig_getattribute)
        def wrapper(self, attr):
            if StaticVarsMeta.is_static(type(self),attr):
                return StaticVarsMeta.__getstatic__(type(self),attr)
            else:
                return orig_getattribute(self, attr)
        return wrapper
    def __inst_setattr__(self, orig_setattribute):
        '''Replaces the class __setattr__'''
        @wraps(orig_setattribute)
        def wrapper(self, attr, value):
            if StaticVarsMeta.is_static(type(self),attr):
                StaticVarsMeta.__setstatic__(type(self),attr, value)
            else:
                orig_setattribute(self, attr, value)
        return wrapper
    def __inst_delattr__(self, orig_delattribute):
        '''Replaces the class __delattr__'''
        @wraps(orig_delattribute)
        def wrapper(self, attr):
            if StaticVarsMeta.is_static(type(self),attr):
                StaticVarsMeta.__delstatic__(type(self),attr)
            else:
                orig_delattribute(self, attr)
        return wrapper
    def __getstatic__(cls,attr):
        '''Static variable getter'''
        for c in cls.__sro__:
            if attr in StaticVarsMeta.statics[c]:
                try:
                    return getattr(c,attr)
                except AttributeError:
                    pass
        raise AttributeError(cls.__name__ + " object has no attribute '{0}'".format(attr))
    def __setstatic__(cls,attr,value):
        '''Static variable setter'''
        for c in cls.__sro__:
            if attr in StaticVarsMeta.statics[c]:
                setattr(c,attr,value)
                break
    def __delstatic__(cls,attr):
        '''Static variable deleter'''
        for c in cls.__sro__:
            if attr in StaticVarsMeta.statics[c]:
                try:
                    delattr(c,attr)
                    break
                except AttributeError:
                    pass
        raise AttributeError(cls.__name__ + " object has no attribute '{0}'".format(attr))
    def __delattr__(cls,attr):
        '''Prevent __sro__ attribute from deletion'''
        if attr == '__sro__':
            raise AttributeError('readonly attribute')
        super().__delattr__(attr)
    def is_static(cls,attr):
        '''Returns True if an attribute is a static variable of any class in the __sro__'''
        if any(attr in StaticVarsMeta.statics[c] for c in cls.__sro__):
            return True
        return False 
```

* * *

## 回答 #4

> 赞同：40
> 
> 时间：2008-09-17T08:06:22.340

您还可以动态地将类变量添加到类中

```
>>> class X:
...     pass
... 
>>> X.bar = 0
>>> x = X()
>>> x.bar
0
>>> x.foo
Traceback (most recent call last):
  File "<interactive input>", line 1, in <module>
AttributeError: X instance has no attribute 'foo'
>>> X.foo = 1
>>> x.foo
1 
```

并且类实例可以改变类变量

```
class X:
  l = []
  def __init__(self):
    self.l.append(1)

print X().l
print X().l

>python test.py
[1]
[1, 1] 
```

* * *

## 回答 #5

> 赞同：24
> 
> 时间：2008-09-16T02:02:45.623

就个人而言，每当我需要静态方法时，我都会使用类方法。主要是因为我将课程作为论据。

```
class myObj(object):
   def myMethod(cls)
     ...
   myMethod = classmethod(myMethod) 
```

或使用装饰器

```
class myObj(object):
   @classmethod
   def myMethod(cls) 
```

对于静态属性..是时候查找一些python定义了..变量总是可以改变的。它们有可变和不可变两种类型。此外，还有类属性和实例属性。在 java 和 c++ 的意义上，没有什么像静态属性那样

如果它与类没有任何关系，为什么要在 Python 意义上使用静态方法！如果我是你，我要么使用 classmethod，要么定义独立于类的方法。

* * *

## 回答 #6

> 赞同：20
> 
> 时间：2008-09-16T02:05:49.923

python 中的静态方法称为[classmethod](http://pyref.infogami.com/classmethod)。看看下面的代码

```
class MyClass:

    def myInstanceMethod(self):
        print 'output from an instance method'

    @classmethod
    def myStaticMethod(cls):
        print 'output from a static method'

>>> MyClass.myInstanceMethod()
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: unbound method myInstanceMethod() must be called [...]

>>> MyClass.myStaticMethod()
output from a static method 
```

请注意，当我们调用方法*myInstanceMethod*时，会出现错误。这是因为它要求在此类的实例上调用该方法。方法*myStaticMethod使用*[装饰器](http://www.python.org/dev/peps/pep-0318/) *@classmethod*设置为类方法。

只是为了好玩和咯咯笑，我们可以通过传入类的实例来调用类的*myInstanceMethod ，如下所示：*

```
>>> MyClass.myInstanceMethod(MyClass())
output from an instance method 
```

* * *

## 回答 #7

> 赞同：20
> 
> 时间：2012-03-08T06:06:05.493

关于静态属性和实例属性的一件特别需要注意的事情，如下例所示：

```
class my_cls:
  my_prop = 0

#static property
print my_cls.my_prop  #--> 0

#assign value to static property
my_cls.my_prop = 1 
print my_cls.my_prop  #--> 1

#access static property thru' instance
my_inst = my_cls()
print my_inst.my_prop #--> 1

#instance property is different from static property 
#after being assigned a value
my_inst.my_prop = 2
print my_cls.my_prop  #--> 1
print my_inst.my_prop #--> 2 
```

这意味着在将值分配给实例属性之前，如果我们尝试通过实例访问属性，则使用静态值。**在 python 类中声明的每个属性在内存中总是有一个静态槽**。

* * *

## 回答 #8

> 赞同：14
> 
> 时间：2013-03-26T17:56:19.287

在任何成员方法之外定义一些成员变量时，该变量可以是静态的或非静态的，具体取决于变量的表达方式。

*   CLASSNAME.var 是静态变量
*   INSTANCENAME.var 不是静态变量。
*   类中的 self.var 不是静态变量。
*   类成员函数里面的var没有定义。

例如：

```
#!/usr/bin/python

class A:
    var=1

    def printvar(self):
        print "self.var is %d" % self.var
        print "A.var is %d" % A.var

    a = A()
    a.var = 2
    a.printvar()

    A.var = 3
    a.printvar() 
```

结果是

```
self.var is 2
A.var is 1
self.var is 2
A.var is 3 
```

* * *

## 回答 #9

> 赞同：14
> 
> 时间：2016-03-25T09:02:25.293

可以有`static`类变量，但可能不值得努力。

这是一个用 Python 3 编写的概念验证——如果任何确切的细节有误，可以调整代码以匹配您所说的任何内容`static variable`：

* * *

```
class Static:
    def __init__(self, value, doc=None):
        self.deleted = False
        self.value = value
        self.__doc__ = doc
    def __get__(self, inst, cls=None):
        if self.deleted:
            raise AttributeError('Attribute not set')
        return self.value
    def __set__(self, inst, value):
        self.deleted = False
        self.value = value
    def __delete__(self, inst):
        self.deleted = True

class StaticType(type):
    def __delattr__(cls, name):
        obj = cls.__dict__.get(name)
        if isinstance(obj, Static):
            obj.__delete__(name)
        else:
            super(StaticType, cls).__delattr__(name)
    def __getattribute__(cls, *args):
        obj = super(StaticType, cls).__getattribute__(*args)
        if isinstance(obj, Static):
            obj = obj.__get__(cls, cls.__class__)
        return obj
    def __setattr__(cls, name, val):
        # check if object already exists
        obj = cls.__dict__.get(name)
        if isinstance(obj, Static):
            obj.__set__(name, val)
        else:
            super(StaticType, cls).__setattr__(name, val) 
```

并在使用中：

```
class MyStatic(metaclass=StaticType):
    """
    Testing static vars
    """
    a = Static(9)
    b = Static(12)
    c = 3

class YourStatic(MyStatic):
    d = Static('woo hoo')
    e = Static('doo wop') 
```

和一些测试：

```
ms1 = MyStatic()
ms2 = MyStatic()
ms3 = MyStatic()
assert ms1.a == ms2.a == ms3.a == MyStatic.a
assert ms1.b == ms2.b == ms3.b == MyStatic.b
assert ms1.c == ms2.c == ms3.c == MyStatic.c
ms1.a = 77
assert ms1.a == ms2.a == ms3.a == MyStatic.a
ms2.b = 99
assert ms1.b == ms2.b == ms3.b == MyStatic.b
MyStatic.a = 101
assert ms1.a == ms2.a == ms3.a == MyStatic.a
MyStatic.b = 139
assert ms1.b == ms2.b == ms3.b == MyStatic.b
del MyStatic.b
for inst in (ms1, ms2, ms3):
    try:
        getattr(inst, 'b')
    except AttributeError:
        pass
    else:
        print('AttributeError not raised on %r' % attr)
ms1.c = 13
ms2.c = 17
ms3.c = 19
assert ms1.c == 13
assert ms2.c == 17
assert ms3.c == 19
MyStatic.c = 43
assert ms1.c == 13
assert ms2.c == 17
assert ms3.c == 19

ys1 = YourStatic()
ys2 = YourStatic()
ys3 = YourStatic()
MyStatic.b = 'burgler'
assert ys1.a == ys2.a == ys3.a == YourStatic.a == MyStatic.a
assert ys1.b == ys2.b == ys3.b == YourStatic.b == MyStatic.b
assert ys1.d == ys2.d == ys3.d == YourStatic.d
assert ys1.e == ys2.e == ys3.e == YourStatic.e
ys1.a = 'blah'
assert ys1.a == ys2.a == ys3.a == YourStatic.a == MyStatic.a
ys2.b = 'kelp'
assert ys1.b == ys2.b == ys3.b == YourStatic.b == MyStatic.b
ys1.d = 'fee'
assert ys1.d == ys2.d == ys3.d == YourStatic.d
ys2.e = 'fie'
assert ys1.e == ys2.e == ys3.e == YourStatic.e
MyStatic.a = 'aargh'
assert ys1.a == ys2.a == ys3.a == YourStatic.a == MyStatic.a 
```

* * *

## 回答 #10

> 赞同：10
> 
> 时间：2011-11-20T12:06:23.343

您还可以使用元类强制类是静态的。

```
class StaticClassError(Exception):
    pass

class StaticClass:
    __metaclass__ = abc.ABCMeta

    def __new__(cls, *args, **kw):
        raise StaticClassError("%s is a static class and cannot be initiated."
                                % cls)

class MyClass(StaticClass):
    a = 1
    b = 3

    @staticmethod
    def add(x, y):
        return x+y 
```

然后，每当您不小心尝试初始化**MyClass**时，您都会得到一个 StaticClassError。

* * *

## 回答 #11

> 赞同：9
> 
> 时间：2017-09-21T04:04:17.877

关于 Python 的属性查找的一个非常有趣的点是它可以用来创建“[虚拟](https://en.wikipedia.org/wiki/Virtual_function)变量”：

```
class A(object):

  label="Amazing"

  def __init__(self,d): 
      self.data=d

  def say(self): 
      print("%s %s!"%(self.label,self.data))

class B(A):
  label="Bold"  # overrides A.label

A(5).say()      # Amazing 5!
B(3).say()      # Bold 3! 
```

通常在它们创建后没有任何分配。请注意，查找使用`self`是因为，尽管`label`在不与*特定*实例关联的意义上是静态的，但该值仍然取决于实例的（类）。

* * *

## 回答 #12

> 赞同：9
> 
> 时间：2021-01-27T12:00:07.527

@dataclass 定义提供了用于定义实例变量和初始化方法的类级别名称`__init__()`。如果你想要类级别的变量，`@dataclass`你应该使用[`typing.ClassVar`](https://docs.python.org/3/library/typing.html#typing.ClassVar)类型提示。类型的`ClassVar`参数定义了类级变量的类型。

```
from typing import ClassVar
from dataclasses import dataclass

@dataclass
class Test:
    i: ClassVar[int] = 10
    x: int
    y: int

    def __repr__(self):
        return f"Test({self.x=}, {self.y=}, {Test.i=})" 
```

使用示例：

```
> test1 = Test(5, 6)
> test2 = Test(10, 11)

> test1
Test(self.x=5, self.y=6, Test.i=10)
> test2
Test(self.x=10, self.y=11, Test.i=10) 
```

* * *

## 回答 #13

> 赞同：8
> 
> 时间：2018-12-14T08:01:42.557

是的，绝对可以在 python 中编写静态变量和方法。

**静态变量：** 在类级别声明的变量称为静态变量，可以使用类名直接访问。

```
 >>> class A:
        ...my_var = "shagun"

    >>> print(A.my_var)
        shagun 
```

**实例变量：**类的实例相关和访问的变量是实例变量。

```
 >>> a = A()
   >>> a.my_var = "pruthi"
   >>> print(A.my_var,a.my_var)
       shagun pruthi 
```

**静态方法：**与变量类似，静态方法可以直接使用类名访问。无需创建实例。

但请记住，静态方法不能在 python 中调用非静态方法。

```
 >>> class A:
   ...     @staticmethod
   ...     def my_static_method():
   ...             print("Yippey!!")
   ... 
   >>> A.my_static_method()
   Yippey!! 
```

* * *

## 回答 #14

> 赞同：7
> 
> 时间：2014-07-03T12:14:47.123

关于这个[答案](https://stackoverflow.com/a/68672/717357)，对于*常量*静态变量，您可以使用描述符。这是一个例子：

```
class ConstantAttribute(object):
    '''You can initialize my value but not change it.'''
    def __init__(self, value):
        self.value = value

    def __get__(self, obj, type=None):
        return self.value

    def __set__(self, obj, val):
        pass

class Demo(object):
    x = ConstantAttribute(10)

class SubDemo(Demo):
    x = 10

demo = Demo()
subdemo = SubDemo()
# should not change
demo.x = 100
# should change
subdemo.x = 100
print "small demo", demo.x
print "small subdemo", subdemo.x
print "big demo", Demo.x
print "big subdemo", SubDemo.x 
```

导致 ...

```
small demo 10
small subdemo 100
big demo 10
big subdemo 10 
```

`pass`如果悄悄地忽略设置值（上面）不是你的事，你总是可以引发异常。如果您正在寻找 C++、Java 风格的静态类变量：

```
class StaticAttribute(object):
    def __init__(self, value):
        self.value = value

    def __get__(self, obj, type=None):
        return self.value

    def __set__(self, obj, val):
        self.value = val 
```

查看[此答案](https://stackoverflow.com/a/102062/717357)和官方文档[HOWTO](https://docs.python.org/2/howto/descriptor.html)以获取有关描述符的更多信息。

* * *

## 回答 #15

> 赞同：7
> 
> 时间：2017-02-22T13:01:13.113

绝对是的，Python 本身没有明确的静态数据成员，但我们可以这样做

```
class A:
    counter =0
    def callme (self):
        A.counter +=1
    def getcount (self):
        return self.counter  
>>> x=A()
>>> y=A()
>>> print(x.getcount())
>>> print(y.getcount())
>>> x.callme() 
>>> print(x.getcount())
>>> print(y.getcount()) 
```

输出

```
0
0
1
1 
```

解释

```
here object (x) alone increment the counter variable
from 0 to 1 by not object y. But result it as "static counter" 
```

* * *

## 回答 #16

> 赞同：7
> 
> 时间：2021-08-06T13:34:46.930

使用 Object 数据类型是可能的。但是像 `bool`,或bahaviour 这样`int`的原始类型与其他 OOP 语言不同。因为在继承类中不存在静态属性。如果继承类中不存在属性，Python 开始在父类中查找它。如果在父类中找到，则返回其值。当您决定更改继承类中的值时，将在运行时创建静态属性。在下一次读取继承的静态属性时，它的值将被返回，因为它已经被定义了。对象（列表、字典）用作引用，因此将它们用作静态属性并继承它们是安全的。当您更改其属性值时，对象地址不会更改。`float``str`

整数数据类型的示例：

```
class A:
    static = 1

class B(A):
    pass

print(f"int {A.static}")  # get 1 correctly
print(f"int {B.static}")  # get 1 correctly

A.static = 5
print(f"int {A.static}")  # get 5 correctly
print(f"int {B.static}")  # get 5 correctly

B.static = 6
print(f"int {A.static}")  # expected 6, but get 5 incorrectly
print(f"int {B.static}")  # get 6 correctly

A.static = 7
print(f"int {A.static}")  # get 7 correctly
print(f"int {B.static}")  # get unchanged 6 
```

基于[refdatatypes](https://pypi.org/project/refdatatypes/)库的解决方案：

```
from refdatatypes.refint import RefInt

class AAA:
    static = RefInt(1)

class BBB(AAA):
    pass

print(f"refint {AAA.static.value}")  # get 1 correctly
print(f"refint {BBB.static.value}")  # get 1 correctly

AAA.static.value = 5
print(f"refint {AAA.static.value}")  # get 5 correctly
print(f"refint {BBB.static.value}")  # get 5 correctly

BBB.static.value = 6
print(f"refint {AAA.static.value}")  # get 6 correctly
print(f"refint {BBB.static.value}")  # get 6 correctly

AAA.static.value = 7
print(f"refint {AAA.static.value}")  # get 7 correctly
print(f"refint {BBB.static.value}")  # get 7 correctly 
```

* * *

## 回答 #17

> 赞同：5
> 
> 时间：2008-09-17T04:01:08.467

为了避免任何潜在的混淆，我想对比静态变量和不可变对象。

一些原始对象类型，如整数、浮点数、字符串和 touples 在 Python 中是不可变的。这意味着由给定名称引用的对象如果属于上述对象类型之一，则不能更改。名称可以重新分配给不同的对象，但对象本身不能更改。

通过禁止变量名指向除当前指向的对象之外的任何对象，将变量设为静态更进一步。（注意：这是一个通用的软件概念，并非特定于 Python；有关在 Python 中实现静态的信息，请参阅其他人的帖子）。

* * *

## 回答 #18

> 赞同：5
> 
> 时间：2013-02-27T17:00:43.647

我发现最好的方法是使用另一个类。您可以创建一个对象，然后在其他对象上使用它。

```
class staticFlag:
    def __init__(self):
        self.__success = False
    def isSuccess(self):
        return self.__success
    def succeed(self):
        self.__success = True

class tryIt:
    def __init__(self, staticFlag):
        self.isSuccess = staticFlag.isSuccess
        self.succeed = staticFlag.succeed

tryArr = []
flag = staticFlag()
for i in range(10):
    tryArr.append(tryIt(flag))
    if i == 5:
        tryArr[i].succeed()
    print tryArr[i].isSuccess() 
```

通过上面的示例，我创建了一个名为`staticFlag`.

这个类应该呈现`__success`静态变量（Private Static Var）。

`tryIt`class 代表我们需要使用的常规类。

现在我为一个标志 ( `staticFlag`) 制作了一个对象。该标志将作为对所有常规对象的引用发送。

所有这些对象都被添加到列表中`tryArr`。

* * *

此脚本结果：

```
False
False
False
False
False
True
True
True
True
True 
```

* * *

## 回答 #19

> 赞同：5
> 
> 时间：2021-10-26T12:34:18.537

**总结其他人的答案并补充，在python**中声明静态方法或变量的方法有很多。

# 1.使用[staticmethod()](https://docs.python.org/3/library/functions.html#staticmethod)作为装饰器：

可以简单地将装饰器放在声明的方法（函数）之上，使其成为静态方法。例如。

```
class Calculator:
    @staticmethod
    def multiply(n1, n2, *args):
        Res = 1
        for num in args: Res *= num
        return n1 * n2 * Res

print(Calculator.multiply(1, 2, 3, 4))              # 24 
```

# 2.使用[staticmethod()](https://docs.python.org/3/library/functions.html#staticmethod)作为参数函数：

此方法可以接收函数类型的参数，并返回传递的函数的静态版本。例如。

```
class Calculator:
    def add(n1, n2, *args):
        return n1 + n2 + sum(args)

Calculator.add = staticmethod(Calculator.add)
print(Calculator.add(1, 2, 3, 4))                   # 10 
```

# 3.使用[classmethod()](https://docs.python.org/3/library/functions.html#classmethod)作为装饰器：

@classmethod 对函数的影响与 @staticmethod 类似，但这次需要在函数中接受一个额外的参数（类似于实例变量的 self 参数）。例如。

```
class Calculator:
    num = 0
    def __init__(self, digits) -> None:
        Calculator.num = int(''.join(digits))

    @classmethod
    def get_digits(cls, num):
        digits = list(str(num))
        calc = cls(digits)
        return calc.num

print(Calculator.get_digits(314159))                # 314159 
```

# 4.使用[classmethod()](https://docs.python.org/3/library/functions.html#classmethod)作为参数函数：

@classmethod 也可以用作参数函数，以防万一不想修改类定义。例如。

```
class Calculator:
    def divide(cls, n1, n2, *args):
        Res = 1
        for num in args: Res *= num
        return n1 / n2 / Res

Calculator.divide = classmethod(Calculator.divide)

print(Calculator.divide(15, 3, 5))                  # 1.0 
```

# 5.直接申报

在所有其他方法之外但在类内部声明的方法/变量自动是静态的。

```
class Calculator:   
    def subtract(n1, n2, *args):
        return n1 - n2 - sum(args)

print(Calculator.subtract(10, 2, 3, 4))             # 1 
```

# 整个节目

```
class Calculator:
    num = 0
    def __init__(self, digits) -> None:
        Calculator.num = int(''.join(digits))

    @staticmethod
    def multiply(n1, n2, *args):
        Res = 1
        for num in args: Res *= num
        return n1 * n2 * Res

    def add(n1, n2, *args):
        return n1 + n2 + sum(args)

    @classmethod
    def get_digits(cls, num):
        digits = list(str(num))
        calc = cls(digits)
        return calc.num

    def divide(cls, n1, n2, *args):
        Res = 1
        for num in args: Res *= num
        return n1 / n2 / Res

    def subtract(n1, n2, *args):
        return n1 - n2 - sum(args)

Calculator.add = staticmethod(Calculator.add)
Calculator.divide = classmethod(Calculator.divide)

print(Calculator.multiply(1, 2, 3, 4))              # 24
print(Calculator.add(1, 2, 3, 4))                   # 10
print(Calculator.get_digits(314159))                # 314159
print(Calculator.divide(15, 3, 5))                  # 1.0
print(Calculator.subtract(10, 2, 3, 4))             # 1 
```

请参阅[Python 文档](https://www.python.org/doc/versions/)以掌握 Python 中的 OOP。

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2017-01-01T02:56:08.727

# 类工厂python3.6中的静态变量

对于使用**python3.6**及更高版本的类工厂的任何人，请使用`nonlocal`关键字将其添加到正在创建的类的范围/上下文中，如下所示：

```
>>> def SomeFactory(some_var=None):
...     class SomeClass(object):
...         nonlocal some_var
...         def print():
...             print(some_var)
...     return SomeClass
... 
>>> SomeFactory(some_var="hello world").print()
hello world 
```

* * *

## 回答 #21

> 赞同：3
> 
> 时间：2020-04-07T12:34:27.193

所以这可能是一个 hack，但我一直在使用`eval(str)`在 python 3 中获取一个静态对象，有点矛盾。

有一个 Records.py 文件，它只包含`class`使用静态方法和保存一些参数的构造函数定义的对象。然后从另一个 .py 文件中，`import Records`但我需要动态选择每个对象，然后根据读取的数据类型按需实例化它。

所以在哪里`object_name = 'RecordOne'`或类名，我调用`cur_type = eval(object_name)`然后实例化它你做`cur_inst = cur_type(args)` 但是在你实例化之前你可以调用静态方法`cur_type.getName()`，例如，有点像抽象基类实现或任何目标。但是在后端，它可能在 python 中实例化并且不是真正的静态，因为 eval 正在返回一个对象......它必须已经实例化......它给出了类似静态的行为。

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2019-11-03T18:27:09.840

您可以使用列表或字典来获取实例之间的“静态行为”。

```
class Fud:

     class_vars = {'origin_open':False}

     def __init__(self, origin = True):
         self.origin = origin
         self.opened = True
         if origin:
             self.class_vars['origin_open'] = True

     def make_another_fud(self):
         ''' Generating another Fud() from the origin instance '''

         return Fud(False)

     def close(self):
         self.opened = False
         if self.origin:
             self.class_vars['origin_open'] = False

fud1 = Fud()
fud2 = fud1.make_another_fud()

print (f"is this the original fud: {fud2.origin}")
print (f"is the original fud open: {fud2.class_vars['origin_open']}")
# is this the original fud: False
# is the original fud open: True

fud1.close()

print (f"is the original fud open: {fud2.class_vars['origin_open']}")
# is the original fud open: False 
```

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2020-05-14T19:31:11.837

例如，如果您尝试共享一个静态变量，以便在其他实例中增加它，则类似此脚本的内容可以正常工作：

```
# -*- coding: utf-8 -*-
class Worker:
    id = 1

    def __init__(self):
        self.name = ''
        self.document = ''
        self.id = Worker.id
        Worker.id += 1

    def __str__(self):
        return u"{}.- {} {}".format(self.id, self.name, self.document).encode('utf8')

class Workers:
    def __init__(self):
        self.list = []

    def add(self, name, doc):
        worker = Worker()
        worker.name = name
        worker.document = doc
        self.list.append(worker)

if __name__ == "__main__":
    workers = Workers()
    for item in (('Fiona', '0009898'), ('Maria', '66328191'), ("Sandra", '2342184'), ('Elvira', '425872')):
        workers.add(item[0], item[1])
    for worker in workers.list:
        print(worker)
    print("next id: %i" % Worker.id) 
```

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2020-07-17T19:36:14.383

这么说，当用户定义的类出现时创建静态变量，并定义一个静态变量，它应该遵循关键字self，

```
class Student:

    the correct way of static declaration
    i = 10

    incorrect
    self.i = 10 
```

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2021-02-18T07:58:16.407

不像，`@staticmethod`但类变量是类的静态方法，并与所有实例共享。

现在您可以像访问它一样

```
instance = MyClass()
print(instance.i) 
```

或者

```
print(MyClass.i) 
```

您必须将值分配给这些变量

我在尝试

```
class MyClass:
  i: str 
```

并在一个方法调用中分配值，在这种情况下它将不起作用并会引发错误

```
i is not attribute of MyClass 
```

# php - 让 PHP 停止替换 '.' $_GET 或 $_POST 数组中的字符？

> ID：68651
> 
> 赞同：86
> 
> 时间：2008-09-16T01:47:44.363
> 
> 标签：php, regex, postback

如果我通过 $_GET 传递名称中带有 PHP 变量，`.`PHP 会自动将它们替换为`_`字符。例如：

```
<?php
echo "url is ".$_SERVER['REQUEST_URI']."<p>";
echo "x.y is ".$_GET['x.y'].".<p>";
echo "x_y is ".$_GET['x_y'].".<p>"; 
```

...输出以下内容：

```
url is /SpShipTool/php/testGetUrl.php?x.y=a.b
x.y is .
x_y is a.b. 
```

...我的问题是：有**什么**办法可以让这停止？无法为我的生活弄清楚我做了什么值得这个

我运行的 PHP 版本是 5.2.4-2ubuntu5.3。

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2008-09-16T02:01:36.047

这是 PHP.net 对它为什么这样做的解释：

> ### 传入变量名中的点
> 
> 通常，PHP 在将变量传递到脚本时不会更改它们的名称。但是，应该注意点（句点、句号）不是 PHP 变量名中的有效字符。究其原因，请看：
> 
> ```
> <?php
> $varname.ext;  /* invalid variable name */
> ?> 
> ```
> 
> 现在，解析器看到的是一个名为 $varname 的变量，后跟字符串连接运算符，然后是裸字符串（即不匹配任何已知键或保留字的未加引号的字符串）'ext'。显然，这并没有达到预期的结果。
> 
> 出于这个原因，重要的是要注意 PHP 会自动将传入变量名中的任何点替换为下划线。

那来自[http://ca.php.net/variables.external](http://ca.php.net/variables.external)。

此外，根据[此评论](http://ca.php.net/manual/en/language.variables.external.php#81080)，这些其他字符将转换为下划线：

> PHP 转换为 _（下划线）的字段名称字符的完整列表如下（不仅仅是点）：
> 
> *   chr(32) ( ) （空格）
> *   chr(46) (.) (点)
> *   chr(91) ([)（开方括号）
> *   chr(128) - chr(159)（各种）

所以看起来你被困住了，所以你必须使用[黎明的建议](https://stackoverflow.com/questions/68651/can-i-get-php-to-stop-replacing-characters-in-get-or-post-arrays#68667)将下划线转换回脚本中的点（不过我只是使用[str_replace](http://php.net/str_replace)。）

* * *

## 回答 #2

> 赞同：62
> 
> 时间：2009-12-21T12:47:21.840

很久以来回答的问题，但实际上有一个更好的答案（或解决方法）。PHP 让你在[原始输入流](http://php.net/manual/en/wrappers.php.php)，所以你可以做这样的事情：

```
$query_string = file_get_contents('php://input'); 
```

这将为您提供查询字符串格式的 $_POST 数组，它们应该是句点。

然后，您可以根据需要对其进行解析（根据[POSTer 的评论](http://www.php.net/manual/en/language.variables.external.php#94607)）

```
<?php
// Function to fix up PHP's messing up input containing dots, etc.
// `$source` can be either 'POST' or 'GET'
function getRealInput($source) {
    $pairs = explode("&", $source == 'POST' ? file_get_contents("php://input") : $_SERVER['QUERY_STRING']);
    $vars = array();
    foreach ($pairs as $pair) {
        $nv = explode("=", $pair);
        $name = urldecode($nv[0]);
        $value = urldecode($nv[1]);
        $vars[$name] = $value;
    }
    return $vars;
}

// Wrapper functions specifically for GET and POST:
function getRealGET() { return getRealInput('GET'); }
function getRealPOST() { return getRealInput('POST'); }
?> 
```

对于同时包含“.”的 OpenID 参数非常有用 和'_'，每个都有一定的含义！

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2013-12-04T01:36:13.060

在上面的评论中突出显示 Johan 的实际答案 - 我只是将我的整个帖子包装在一个顶级数组中，它完全绕过了这个问题，不需要繁重的处理。

在你做的形式

```
<input name="data[database.username]">  
<input name="data[database.password]">  
<input name="data[something.else.really.deep]"> 
```

代替

```
<input name="database.username"> 
<input name="database.password"> 
<input name="something.else.really.deep"> 
```

在 post 处理程序中，只需打开它：

```
$posdata = $_POST['data']; 
```

对我来说，这是一个两行的变化，因为我的观点完全是模板化的。

供参考。我在字段名称中使用点来编辑分组数据树。

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2013-08-13T12:59:30.670

您是否想要一个**符合标准**并适用于**深度数组**的解决方案（例如：） `?param[2][5]=10`？

要修复此问题的所有可能来源，您可以在 PHP 代码的最顶部应用：

```
$_GET    = fix( $_SERVER['QUERY_STRING'] );
$_POST   = fix( file_get_contents('php://input') );
$_COOKIE = fix( $_SERVER['HTTP_COOKIE'] ); 
```

这个函数的工作是我在 2013 年暑假期间提出的一个好主意。不要被一个简单的正则表达式气馁，它只是抓取所有查询名称，对它们进行编码（因此保留点），然后使用普通的`parse_str()`功能。

```
function fix($source) {
    $source = preg_replace_callback(
        '/(^|(?<=&))[^=[&]+/',
        function($key) { return bin2hex(urldecode($key[0])); },
        $source
    );

    parse_str($source, $post);

    $result = array();
    foreach ($post as $key => $val) {
        $result[hex2bin($key)] = $val;
    }
    return $result;
} 
```

ps：如果您在项目中使用此解决方案，请使用`@author Rok Kralj`.

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2013-01-21T04:52:26.717

发生这种情况是因为句点是变量名称中的无效字符，其[原因](http://php.net/variables.external#language.variables.external.dot-in-names)在于 PHP 的实现非常深入，因此（目前）还没有简单的修复方法。

同时，您可以通过以下方式解决此问题：

1.  通过`php://input`POST 数据或`$_SERVER['QUERY_STRING']`GET 数据访问原始查询数据
2.  使用转换函数。

下面的转换函数（PHP >= 5.4）将每个键值对的名称编码为十六进制表示，然后执行正则`parse_str()`；完成后，它将十六进制名称恢复为原始形式：

```
function parse_qs($data)
{
    $data = preg_replace_callback('/(?:^|(?<=&))[^=[]+/', function($match) {
        return bin2hex(urldecode($match[0]));
    }, $data);

    parse_str($data, $values);

    return array_combine(array_map('hex2bin', array_keys($values)), $values);
}

// work with the raw query string
$data = parse_qs($_SERVER['QUERY_STRING']); 
```

或者：

```
// handle posted data (this only works with application/x-www-form-urlencoded)
$data = parse_qs(file_get_contents('php://input')); 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2013-08-10T15:31:14.197

这种方法是 Rok Kralj 的修改版本，但需要进行一些调整以提高效率（避免对未受影响的键进行不必要的回调、编码和解码）并正确处理数组键。

提供了带有测试的[要点，](https://gist.github.com/elyobo/6200838)欢迎在这里或那里提供任何反馈或建议。

```
public function fix(&$target, $source, $keep = false) {                        
    if (!$source) {                                                            
        return;                                                                
    }                                                                          
    $keys = array();                                                           

    $source = preg_replace_callback(                                           
        '/                                                                     
        # Match at start of string or &                                        
        (?:^|(?<=&))                                                           
        # Exclude cases where the period is in brackets, e.g. foo[bar.blarg]
        [^=&\[]*                                                               
        # Affected cases: periods and spaces                                   
        (?:\.|%20)                                                             
        # Keep matching until assignment, next variable, end of string or   
        # start of an array                                                    
        [^=&\[]*                                                               
        /x',                                                                   
        function ($key) use (&$keys) {                                         
            $keys[] = $key = base64_encode(urldecode($key[0]));                
            return urlencode($key);                                            
        },                                                                     
    $source                                                                    
    );                                                                         

    if (!$keep) {                                                              
        $target = array();                                                     
    }                                                                          

    parse_str($source, $data);                                                 
    foreach ($data as $key => $val) {                                          
        // Only unprocess encoded keys                                      
        if (!in_array($key, $keys)) {                                          
            $target[$key] = $val;                                              
            continue;                                                          
        }                                                                      

        $key = base64_decode($key);                                            
        $target[$key] = $val;                                                  

        if ($keep) {                                                           
            // Keep a copy in the underscore key version                       
            $key = preg_replace('/(\.| )/', '_', $key);                        
            $target[$key] = $val;                                              
        }                                                                      
    }                                                                          
} 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-09-16T01:56:15.687

发生这种情况的原因是 PHP 的旧 register_globals 功能。这 。字符不是变量名中的有效字符，因此 PHP 将其转换为下划线以确保兼容性。

简而言之，在 URL 变量中添加句点不是一个好习惯。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2013-08-15T00:28:57.950

如果正在寻找**任何**方式 让*PHP*停止替换 '.' $_GET 或 $_POST 数组中的字符，那么一种方法是修改 PHP 的源代码（在这种情况下相对简单）。

*警告：修改 PHP C 源代码是一个高级选项！*

另请参阅此[PHP 错误报告](https://bugs.php.net/bug.php?id=45272)，该报告建议进行相同的修改。

要探索，您需要：

*   下载[PHP的C源代码](http://www.php.net/downloads.php)
*   禁用`.`替换检查
*   *./configure*，*制作*和部署您定制的 PHP 构建

源更改本身是微不足道的，只涉及更新[一行](https://github.com/php/php-src/blob/f01c295d/main/php_variables.c#L94)中的一半`main/php_variables.c`：

```
....
/* ensure that we don't have spaces or dots in the variable name (not binary safe) */
for (p = var; *p; p++) {
    if (*p == ' ' /*|| *p == '.'*/) {
        *p='_';
.... 
```

*注：与原文相比`|| *p == '.'` 已注释掉*

* * *

示例输出：

给定一个 QUERY_STRING `a.a[]=bb&a.a[]=BB&c%20c=dd`，现在运行`<?php print_r($_GET);`会产生：

```
大批
(
    [aa] => 数组
        (
            [0] => bb
            [1] => BB
        )

    [c_c] => dd
)

```

*笔记：*

**   此补丁仅解决原始问题（它停止替换点，而不是空格）。*   在这个补丁上运行将比脚本级解决方案更快，但那些纯 .php 答案仍然是普遍首选的（因为它们避免更改 PHP 本身）。*
*   *`parse_str()`理论上，这里可以使用 polyfill 方法，并且可以组合方法——使用和（如果不可用）回退到较慢的方法来 测试 C 级更改。*

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2011-02-07T22:35:54.737

我对这个问题的解决方案既快速又肮脏，但我仍然喜欢它。我只是想发布在表单上检查的文件名列表。我曾经`base64_encode`在标记中对文件名进行编码，然后`base64_decode`在使用它们之前对其进行解码。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2013-08-03T01:54:05.590

在查看了 Rok 的解决方案后，我想出了一个版本，它解决了我在下面的答案中的限制，上面的 crb 和 Rok 的解决方案也是如此。查看[我的改进版本](/questions/68651/get-php-to-stop-replacing-characters-in-get-or-post-arrays/18163411#18163411)。

* * *

@crb[上面](/questions/68651/get-php-to-stop-replacing-characters-in-get-or-post-arrays#1939911)的回答是一个好的开始，但有几个问题。

*   它重新处理所有内容，这太过分了；只有那些有“。”的字段 在名称中需要重新处理。
*   它无法像原生 PHP 处理那样处理数组，例如像“foo.bar[]”这样的键。

下面的解决方案现在解决了这两个问题（请注意，它自最初发布以来已经更新）。在我的测试中，这比我上面的答案快了大约 50%，但不会处理数据具有相同键（或提取相同的键，例如 foo.bar 和 foo_bar 都被提取为 foo_bar）的情况。

```
<?php

public function fix2(&$target, $source, $keep = false) {                       
    if (!$source) {                                                            
        return;                                                                
    }                                                                          
    preg_match_all(                                                            
        '/                                                                     
        # Match at start of string or &                                        
        (?:^|(?<=&))                                                           
        # Exclude cases where the period is in brackets, e.g. foo[bar.blarg]
        [^=&\[]*                                                               
        # Affected cases: periods and spaces                                   
        (?:\.|%20)                                                             
        # Keep matching until assignment, next variable, end of string or   
        # start of an array                                                    
        [^=&\[]*                                                               
        /x',                                                                   
        $source,                                                               
        $matches                                                               
    );                                                                         

    foreach (current($matches) as $key) {                                      
        $key    = urldecode($key);                                             
        $badKey = preg_replace('/(\.| )/', '_', $key);                         

        if (isset($target[$badKey])) {                                         
            // Duplicate values may have already unset this                    
            $target[$key] = $target[$badKey];                                  

            if (!$keep) {                                                      
                unset($target[$badKey]);                                       
            }                                                                  
        }                                                                      
    }                                                                          
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-09-12T01:27:53.107

好吧，我在下面包含的函数“getRealPostArray()”不是一个很好的解决方案，但它处理数组并支持两个名称：“alpha_beta”和“alpha.beta”：

```
 <input type='text' value='First-.' name='alpha.beta[a.b][]' /><br>
  <input type='text' value='Second-.' name='alpha.beta[a.b][]' /><br>
  <input type='text' value='First-_' name='alpha_beta[a.b][]' /><br>
  <input type='text' value='Second-_' name='alpha_beta[a.b][]' /><br> 
```

而 var_dump($_POST) 产生：

```
 'alpha_beta' => 
    array (size=1)
      'a.b' => 
        array (size=4)
          0 => string 'First-.' (length=7)
          1 => string 'Second-.' (length=8)
          2 => string 'First-_' (length=7)
          3 => string 'Second-_' (length=8) 
```

var_dump(getRealPostArray()) 产生：

```
 'alpha.beta' => 
    array (size=1)
      'a.b' => 
        array (size=2)
          0 => string 'First-.' (length=7)
          1 => string 'Second-.' (length=8)
  'alpha_beta' => 
    array (size=1)
      'a.b' => 
        array (size=2)
          0 => string 'First-_' (length=7)
          1 => string 'Second-_' (length=8) 
```

该功能，对于它的价值：

```
function getRealPostArray() {
  if ($_SERVER['REQUEST_METHOD'] !== 'POST') {#Nothing to do
      return null;
  }
  $neverANamePart = '~#~'; #Any arbitrary string never expected in a 'name'
  $postdata = file_get_contents("php://input");
  $post = [];
  $rebuiltpairs = [];
  $postraws = explode('&', $postdata);
  foreach ($postraws as $postraw) { #Each is a string like: 'xxxx=yyyy'
    $keyvalpair = explode('=',$postraw);
    if (empty($keyvalpair[1])) {
      $keyvalpair[1] = '';
    }
    $pos = strpos($keyvalpair[0],'%5B');
    if ($pos !== false) {
      $str1 = substr($keyvalpair[0], 0, $pos);
      $str2 = substr($keyvalpair[0], $pos);
      $str1 = str_replace('.',$neverANamePart,$str1);
      $keyvalpair[0] = $str1.$str2;
    } else {
      $keyvalpair[0] = str_replace('.',$neverANamePart,$keyvalpair[0]);
    }
    $rebuiltpair = implode('=',$keyvalpair);
    $rebuiltpairs[]=$rebuiltpair;
  }
  $rebuiltpostdata = implode('&',$rebuiltpairs);
  parse_str($rebuiltpostdata, $post);
  $fixedpost = [];
  foreach ($post as $key => $val) {
    $fixedpost[str_replace($neverANamePart,'.',$key)] = $val;
  }
  return $fixedpost;
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2014-10-05T20:26:30.073

使用 crb's 我想重新创建整个`$_POST`数组，但请记住，您仍然必须确保在客户端和服务器上都正确编码和解码。了解一个字符何时*真正*无效以及何时真正*有效*是很重要的。此外，在将客户端数据与*任何*数据库命令一起使用之前，人们仍应始终转义客户端*数据**，**无一例外*。

 **```
<?php
unset($_POST);
$_POST = array();
$p0 = explode('&',file_get_contents('php://input'));
foreach ($p0 as $key => $value)
{
 $p1 = explode('=',$value);
 $_POST[$p1[0]] = $p1[1];
 //OR...
 //$_POST[urldecode($p1[0])] = urldecode($p1[1]);
}
print_r($_POST);
?> 
```

我建议仅将其仅用于个别情况，我不确定将其放在主头文件顶部的负面影响。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2015-11-16T12:36:11.030

我当前的解决方案（基于上一个主题回复）：

```
function parseQueryString($data)
{
    $data = rawurldecode($data);   
    $pattern = '/(?:^|(?<=&))[^=&\[]*[^=&\[]*/';       
    $data = preg_replace_callback($pattern, function ($match){
        return bin2hex(urldecode($match[0]));
    }, $data);
    parse_str($data, $values);

    return array_combine(array_map('hex2bin', array_keys($values)), $values);
}

$_GET = parseQueryString($_SERVER['QUERY_STRING']); 
```

# algorithm - 在字符串列表中查找相同位置的字符的算法？

> ID：68664
> 
> 赞同：3
> 
> 时间：2008-09-16T01:50:33.813
> 
> 标签：algorithm, string

假设我有：

1.  托比
2.  微小的
3.  保守党
4.  蒂莉

是否有一种算法可以轻松地在所有这些字符串的相同位置创建一个常见字符列表？（在这种情况下，常见字符是位置 0 的“T”和位置 3 的“y”）

我尝试查看一些用于 DNA 序列匹配的算法，但似乎它们中的大多数只是用于查找公共子串，而不管它们的位置如何。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-16T01:54:57.157

在某个位置查找所有字符串中常见的字符列表非常简单。只需为每个字符位置迭代每个字符串，一次 1 个字符位置。如果任何字符串的字符与其最近邻字符串的字符不匹配，则该位置不包含公共字符。

对于任何 i = 0 到长度 -1... 一旦你找到 Si[x] != Si+1[x] 你可以跳到下一个位置 x+1。

其中 Si 是列表中的第 i 个字符串。[x] 是位置 x 处的字符。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-16T02:03:49.850

一些性能很差的通用代码 O(n^2)

```
str[] = { "Toby", "Tiny", "Tory", "Tily" };
result = null;
largestString = str.getLargestString(); // Made up function
str.remove(largestString)
for (i = 0; i < largestString.length; i++) {
   hits = 0;
   foreach (str as value) {
      if (i < value.length) {
         if (value.charAt(i) == largestString.charAt(i))
            hits++;
      }
   }
   if (hits == str.length)
      result += largestString.charAt(i);
}
print(str.items); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-16T02:07:01.150

我想不出任何特别优化的东西。

你可以做这样的事情，这不应该太难：

```
 //c# -- assuming your strings are in a List<string> named Names
        int shortestLength = Names[0].Length, j;
        char[] CommonCharacters;
        char single;

        for (int i = 1; i < Names.Count; i++)
        {
            if (Names[i].Length < shortestLength) shortestLength = Names[i].Length;
        }

        CommonCharacters = new char[shortestLength];
        for (int i = 0; i < shortestLength; i++)
        {
            j = 1;
            single = Names[0][i];
            CommonCharacters[i] = single;
            while (j < shortestLength)
            {
                if (single != Names[j][i])
                {
                    CommonCharacters[i] = " "[0];
                    break;
                }
                j++;
            }
        } 
```

这将为您提供一个字符数组，这些字符在列表中的所有内容中都是相同的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-16T02:12:24.617

这样的事情呢？

```
strings = %w(Tony Tiny Tory Tily)
positions = Hash.new { |h,k| h[k] = Hash.new { |h,k| h[k] = 0 } }
strings.each { |str| 
  0.upto(str.length-1) { |i| 
    positions[i][str[i,1]]+=1 
  }
} 
```

在执行结束时，结果将是：

```
positions = {
  0=>{"T"=>4},
  1=>{"o"=>2, "i"=>2}, 
  2=>{"l"=>1, "n"=>2, "r"=>1},
  3=>{"y"=>4}
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-16T02:24:45.213

这是 5 行 ruby​​ 中的算法：

```
#!/usr/bin/env ruby
chars = STDIN.gets.chomp.split("")
STDIN.each do |string|
  chars = string.chomp.split("").zip(chars).map {|x,y| x == y ? x : nil }
end
chars.each_index {|i| puts "#{chars[i]}  #{i}" if chars[i] } 
```

把它放在commonletters.rb 中。示例用法：

```
$ commonletters.rb < input.txt
T  0
y  3 
```

假设 input.txt 包含：

```
Toby
Tiny
Tory
Tily 
```

这应该适用于您投入的任何输入。如果输入文件为空，它将中断，但您可以自己修复它。这是 O(n) （n 是输入中的字符总数）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-19T17:16:16.563

这是 Python 中的一个简单版本：

```
items = ['Toby', 'Tiny', 'Tory', 'Tily']
tuples = sorted(x for item in items for x in enumerate(item))
print [x[0] for x in itertools.groupby(tuples) if len(list(x[1])) == len(items)] 
```

哪个打印：

```
[(0, 'T'), (3, 'y')] 
```

编辑：这是一个更好的版本，不需要创建（可能）巨大的元组列表：

```
items = ['Toby', 'Tiny', 'Tory', 'Tily']
minlen = min(len(x) for x in items)
print [(i, items[0][i]) for i in range(minlen) if all(x[i] == items[0][i] for x in items)] 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-21T18:50:03.107

```
#include <iostream>

int main(void)
{
    char words[4][5] = 
    {
        "Toby",
        "Tiny",
        "Tory",
        "Tily"
    };

    int wordsCount = 4;
    int lettersPerWord = 4;

    int z;
    for (z = 1; z < wordsCount; z++)
    {
        int y;
        for (y = 0; y < lettersPerWord; y++)
        {
            if (words[0][y] != words[z][y])
            {
                words[0][y] = ' ';
            }
        }
    }

    std::cout << words[0] << std::endl;

    return 0;
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-19T18:35:16.343

在口齿不清：

```
CL-USER> (defun common-chars (&rest strings)
           (apply #'map 'list #'char= strings))
COMMON-CHARS 
```

只需传入字符串：

```
CL-USER> (common-chars "Toby" "Tiny" "Tory" "Tily")
(T NIL NIL T) 
```

如果你想要角色本身：

```
CL-USER> (defun common-chars2 (&rest strings)
           (apply #'map
                  'list
                  #'(lambda (&rest chars)
                      (when (apply #'char= chars)
                        (first chars))) ; return the char instead of T
                  strings))
COMMON-CHARS2

CL-USER> (common-chars2 "Toby" "Tiny" "Tory" "Tily")
(#\T NIL NIL #\y) 
```

如果您不关心位置，而只想列出常见字符：

```
CL-USER> (format t "~{~@[~A ~]~}" (common-chars2 "Toby" "Tiny" "Tory" "Tily"))
T y 
NIL 
```

我承认这不是一种算法......只是一种使用现有功能在 lisp 中实现它的方法

如果您想手动进行，如前所述，您可以循环比较给定索引处的所有字符。如果它们都匹配，则保存匹配的字符。

# .net - 从 .NET 设置剪贴板时出现 CLIPBRD_E_CANT_OPEN 错误

> ID：68666
> 
> 赞同：58
> 
> 时间：2008-09-16T01:50:35.403
> 
> 标签：.net, wpf, clipboard

为什么以下代码有时会导致内容为“CLIPBRD_E_CANT_OPEN”的异常：

```
Clipboard.SetText(str); 
```

这通常发生在应用程序中第一次使用剪贴板时，而不是之后。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2008-09-16T03:07:04.067

这是由终端服务剪贴板（以及可能的其他事情）中的错误/功能和剪贴板的 .NET 实现引起的。打开剪贴板的延迟会导致错误，该错误通常会在几毫秒内通过。

解决方案是在一个循环中多次尝试并在其间休眠。

```
for (int i = 0; i < 10; i++)
{
    try
    {
        Clipboard.SetText(str);
        return;
    }
    catch { }
    System.Threading.Thread.Sleep(10);
} 
```

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2008-09-16T02:21:31.710

实际上，我认为这是[Win32 API 的错](https://cloudblogs.microsoft.com/enterprisemobility/2006/11/20/why-does-my-shared-clipboard-not-work-part-2/)。

要在剪贴板中设置数据，您必须先将其[打开](http://msdn.microsoft.com/en-us/library/ms649048(VS.85).aspx)。一次只有一个进程可以打开剪贴板。因此，当您检查时，如果另一个进程*出于任何原因*打开了剪贴板，您打开它的尝试将会失败。

碰巧终端服务会跟踪剪贴板，而在旧版本的 Windows（Vista 之前）上，您必须打开剪贴板才能查看里面的内容……这最终会阻止您。唯一的解决方案是等到终端服务关闭剪贴板并重试。

重要的是要意识到这并不特定于终端服务：它可以发生在任何事情上。在 Win32 中使用剪贴板是一个巨大的竞争条件。但是，由于按照设计，您只应该使用剪贴板来响应用户输入，这通常不会出现问题。

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2016-08-24T13:46:06.440

我知道这个问题很老，但问题仍然存在。如前所述，当系统剪贴板被另一个进程阻塞时会发生此异常。不幸的是，有许多截图工具、截图程序和文件复制工具可以阻止 Windows 剪贴板。`Clipboard.SetText(str)`因此，当您在 PC 上安装此类工具时，每次尝试使用时都会出现异常。

解决方案：

从不使用

```
Clipboard.SetText(str); 
```

改为使用

```
Clipboard.SetDataObject(str); 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2012-07-30T16:57:43.207

实际上手头可能还有另一个问题。框架调用（WPF 和 winform 风格）是这样的（代码来自反射器）：

```
private static void SetDataInternal(string format, object data)
{
    bool flag;
    if (IsDataFormatAutoConvert(format))
    {
        flag = true;
    }
    else
    {
        flag = false;
    }
    IDataObject obj2 = new DataObject();
    obj2.SetData(format, data, flag);
    SetDataObject(obj2, true);
} 
```

请注意，在这种情况下，SetDataObject 始终以 true 调用。

在内部，这会触发对 win32 api 的两次调用，一次用于设置数据，一次用于从您的应用程序中刷新数据，以便在应用程序关闭后可用。

我见过几个监听剪贴板事件的应用程序（一些 chrome 插件和下载管理器）。一旦第一次调用命中，应用程序将打开剪贴板以查看数据，第二次调用 flush 将失败。

除了编写我自己的使用直接 win32 API 的剪贴板类或使用 false 直接调用 setDataObject 以在应用程序关闭后保留数据之外，还没有找到一个好的解决方案。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2015-05-11T10:45:36.950

我使用本机 Win32 函数为我自己的应用程序解决了这个问题：OpenClipboard()、CloseClipboard() 和 SetClipboardData()。

在我制作的包装类下面。任何人都可以**检查**它并**告诉它是否正确**。特别是当托管代码作为 x64 应用程序运行时（我在项目选项中使用 Any CPU）。**当我从 x64 应用程序链接到 x86 库时会发生什么？**

谢谢！

这是代码：

```
public static class ClipboardNative
{
    [DllImport("user32.dll")]
    private static extern bool OpenClipboard(IntPtr hWndNewOwner);

    [DllImport("user32.dll")]
    private static extern bool CloseClipboard();

    [DllImport("user32.dll")]
    private static extern bool SetClipboardData(uint uFormat, IntPtr data);

    private const uint CF_UNICODETEXT = 13;

    public static bool CopyTextToClipboard(string text)
    {
        if (!OpenClipboard(IntPtr.Zero)){
            return false;
        }

        var global = Marshal.StringToHGlobalUni(text);

        SetClipboardData(CF_UNICODETEXT, global);
        CloseClipboard();

        //-------------------------------------------
        // Not sure, but it looks like we do not need 
        // to free HGLOBAL because Clipboard is now 
        // responsible for the copied data. (?)
        //
        // Otherwise the second call will crash
        // the app with a Win32 exception 
        // inside OpenClipboard() function
        //-------------------------------------------
        // Marshal.FreeHGlobal(global);

        return true;
    }
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2020-11-04T18:26:30.430

使用 WinForms 版本（是的，在 WPF 应用程序中使用 WinForms 没有害处），它可以处理您需要的一切：

```
System.Windows.Forms.SetDataObject(yourText, true, 10, 100); 
```

这将尝试将 yourText 复制到剪贴板，它会在您的应用程序存在后保留，最多尝试 10 次，每次尝试之间将等待 100 毫秒。

参考。[https://docs.microsoft.com/en-us/dotnet/api/system.windows.forms.clipboard.setdataobject?view=netframework-4.7.2#System_Windows_Forms_Clipboard_SetDataObject_System_Object_System_Boolean_System_Int32_System_Int32](https://docs.microsoft.com/en-us/dotnet/api/system.windows.forms.clipboard.setdataobject?view=netframework-4.7.2#System_Windows_Forms_Clipboard_SetDataObject_System_Object_System_Boolean_System_Int32_System_Int32) _

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-05-11T08:36:59.407

这发生在我的 WPF 应用程序中。我的 OpenClipboard 失败（来自 HRESULT 的异常：0x800401D0 (CLIPBRD_E_CANT_OPEN)）。

我用

```
ApplicationCommands.Copy.Execute(null, myDataGrid); 
```

解决方法是先清除剪贴板

```
Clipboard.Clear();
ApplicationCommands.Copy.Execute(null, myDataGrid); 
```

# sql-server - 如何在 TSQL 中将二进制值打印为十六进制？

> ID：68677
> 
> 赞同：37
> 
> 时间：2008-09-16T01:52:12.077
> 
> 标签：sql-server, tsql

我正在使用 SQL Server 2000 从使用`PRINT`. 对于大多数非字符串数据，我可以转换为 nvarchar 以便能够打印它，但二进制值会尝试使用字符的位表示进行转换。例如：

```
DECLARE @binvalue binary(4)
SET @binvalue = 0x12345678
PRINT CAST(@binvalue AS nvarchar) 
```

预期的：

> 0x12345678

相反，它会打印两个乱码。

如何打印二进制数据的值？有内置的还是我需要自己滚动？

更新：这不是唯一的值，所以我不能只打印@binvalue。它更像是 PRINT N'other stuff' + ???? + N'更多的东西'。不确定这是否会有所不同：我并没有单独尝试 PRINT @binvalue。

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2012-08-18T06:23:34.430

> 不要使用`master.sys.fn_varbintohexstr`- 它*非常缓慢*、无文档、不受支持，并且*可能会在 SQL Server 的未来版本中消失*。

如果您需要转换`binary(16)`为十六进制字符，请使用`convert`：

```
convert(char(34), @binvalue, 1) 
```

为什么是34？因为`16*2 + 2 = 34`，即 "0x" - 2 个符号，每个字符加上 2 个符号。

我们尝试对一个有 200000 行的表进行 2 次查询：

1.  ```
    select master.sys.fn_varbintohexstr(field)
    from table` 
    ```

2.  ```
    select convert(char(34), field, 1)
    from table` 
    ```

第一个运行 2 分钟，而第二个运行 - 4 秒。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2008-09-16T02:23:39.303

如果你在 Sql Server 2005 上，你可以使用这个：

```
print master.sys.fn_varbintohexstr(@binvalue) 
```

不过，我认为这在 2000 年不存在，所以你可能不得不自己动手。

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2012-09-23T05:04:08.987

```
select convert(varchar(max), field , 1) 
from table 
```

`using varchar(max)`您不必担心指定大小（种类）。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2013-07-30T15:26:36.177

添加一个答案，显示将*二进制*数据转换为十六进制字符串的另一个示例，然后再返回。

我想将最高`timestamp`值转换为`varchar`：

```
SELECT 
   CONVERT(
      varchar(50), 
      CAST(MAX(timestamp) AS varbinary(8)), 
      1) AS LastTS
FROM Users 
```

返回：

```
LastTS
==================
0x000000000086862C 
```

**注意**：重要的是你`CONVERT`用来转换`varbinary -> varchar`。使用`CAST`将不起作用：

```
SELECT 
   CAST(
      CAST(MAX(timestamp) AS varbinary(8)) 
      AS varchar(50) ) AS LastTS
FROM Users 
```

将二进制数据视为*字符*而不是十六进制值，返回一个空字符串。

# 扭转它

要将存储的十六进制字符串转换回时间戳：

```
SELECT CAST(CONVERT(varbinary(50), '0x000000000086862C', 1) AS timestamp) 
```

> **注意**：任何代码都会发布到公共领域。无需归属。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-16T02:21:33.957

```
DECLARE @binvalue binary(4)
SET @binvalue = 0x61000000
PRINT @binvalue 
PRINT cast('a' AS binary(4))
PRINT cast(0x61 AS varchar) 
```

不要施放。

Casting 在特定数据库的相应排序规则设置上按值将二进制文件转换为文本。

[开始编辑] 如果您需要字符串变量中的打印值，请使用 Eric Z Beard 建议的函数。

```
DECLARE @mybin1 binary(16)
DECLARE @s varchar(100)
SET @mybin1 = 0x098F6BCD4621D373CADE4E832627B4F6
SET @s = 'The value of @mybin1 is: ' + sys.fn_varbintohexsubstring(0, @mybin1,1,0)
PRINT @s 
```

如果由于服务器版本或需要特殊权限而无法使用此功能，您可以创建自己的功能。

要查看该功能在 SQL Server 2005 Express 版本中是如何实现的，您可以执行：

```
sp_helptext 'fn_varbintohexsubstring' 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-10-16T09:18:34.243

在打印从 SQL Server 2005 中的“哈希字节”函数返回的十六进制值时，我在寻找类似问题的解决方案时遇到了这个问题。

可悲的是，在这个版本的 SQL Server 中，CONVERT 似乎根本不起作用，只有 fn_varbintohexsubstring 做正确的事情：

我做了：

```
DECLARE @binvalue binary(4)
SET @binvalue = 0x12345678
PRINT 'cast(@binvalue AS nvarchar): ' + CAST(@binvalue AS nvarchar)
PRINT 'convert(varchar(max), @binvalue, 0): ' + CONVERT(varchar(max), @binvalue, 0)
PRINT 'convert(varchar(max), @binvalue, 1): ' + CONVERT(varchar(max), @binvalue, 1)
PRINT 'convert(varchar(max), @binvalue, 2): ' + CONVERT(varchar(max), @binvalue, 2)
print 'master.sys.fn_varbintohexstr(@binvalue): ' + master.sys.fn_varbintohexstr(@binvalue) 
```

这是我在 SQL Server 2005 中得到的结果（

```
cast(@binvalue AS nvarchar): 㐒硖
convert(varchar(max), @binvalue, 0): 4Vx
convert(varchar(max), @binvalue, 1): 4Vx
convert(varchar(max), @binvalue, 2): 4Vx
master.sys.fn_varbintohexstr(@binvalue): 0x12345678 
```

（在 '4Vx's 之前实际上有一个不可打印的字符 - 我会发布一张图片，但我还没有足够的分数）。

* * *

**编辑**：只需添加 - 在 SQL Server 2008 R2 上，CONVERT 的问题已通过以下输出修复：

```
cast(@binvalue AS nvarchar): 㐒硖
convert(varchar(max), @binvalue, 0): 4Vx
convert(varchar(max), @binvalue, 1): 0x12345678
convert(varchar(max), @binvalue, 2): 12345678
master.sys.fn_varbintohexstr(@binvalue): 0x12345678 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-12-05T18:36:51.803

主题中的 tl;dr 真的太多了 :( 将尝试按照[这个答案](https://stackoverflow.com/a/12549880/10815638)修复它。

```
with 
sq1 as (select '41424344' as v), -- this is 'ABCD'
-- Need binary size, otherwise it sets binary(30) in my case
sq2 as (select v, convert(binary(4), v, 2) as b from sq1), 
sq3 as (select b, v, convert(varchar, b, 2) as v1 from sq2)
--
select b, v, v1 from sq3
where v = v1
; 
```

输出是：

```
b   |v       |v1      |
----|--------|--------|
ABCD|41424344|41424344| 
```

另见：[文档](https://docs.microsoft.com/en-us/sql/t-sql/functions/cast-and-convert-transact-sql?view=sql-server-ver15)

# asp.net - ASP.NET 表单中的 DefaultButton

> ID：68688
> 
> 赞同：1
> 
> 时间：2008-09-16T01:53:29.500
> 
> 标签：asp.net, enter, defaultbutton, pressed

ASP.NET 2.0-3.5 表单的 defaultButton 和“按下 Enter 键”的最佳解决方案是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-16T01:54:56.907

Just add the "defaultbutton" attribute to the form and set it to the ID of the button you want to be the default.

```
<form defaultbutton="button1" runat="server">
    <asp:textbox id="textbox1" runat="server"/>
    <asp:button id="button1" text="Button1" runat="server"/>
</form> 
```

NOTE: This only works in ASP.NET 2.0+

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-16T02:22:41.847

由于按 Enter 键提交表单是 HTML 生活的一部分，因此您必须使用 javascript 捕获 Enter 键，并且只允许它在有效时通过（例如在 textareas 中）。查看[http://brennan.offwhite.net/blog/2004/08/04/the-single-form-problem-with-aspnet/](http://brennan.offwhite.net/blog/2004/08/04/the-single-form-problem-with-aspnet/)有一个很好的解释。

# java - 从一组 HTML 文件中提取表格内容的最佳方法是什么？

> ID：68691
> 
> 赞同：1
> 
> 时间：2008-09-16T01:53:46.097
> 
> 标签：java, html, excel, csv, extract

用 TIDY 清理了一个充满 HTML 文件的文件夹后，如何提取表格内容以进行进一步处理？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-16T01:56:12.270

过去，我曾将 BeautifulSoup 用于此类事情并取得了巨大成功。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-16T15:13:48.653

取决于你想要做什么样的处理。您可以告诉 Tidy 生成 XHTML，它是一种 XML，这意味着您可以对结果使用所有常用的 XML 工具，例如 XSLT 和 XQuery。

如果您想在 Microsoft Excel 中处理它们，那么您应该能够从 HTML 中切出表格并将其放入文件中，然后在 Excel 中打开该文件：它会很高兴地将 HTML 表格转换为电子表格页面。然后，您可以将其保存为 CSV 或 Excel 工作簿等。（您甚至可以在 Web 服务器上使用它——返回 HTML 表格，但将`Content-Type`标题设置为`application/ms-vnd.excel`：Excel 将打开并导入表格并将其转入电子表格.)

如果您希望将 CSV 输入数据库，那么您可以像以前一样通过 Excel，或者如果您想自动化该过程，您可以编写一个程序，使用您选择的 XML 导航 API 来迭代表行和将它们保存为 CSV。Python 的 Elementtree 和 CSV 模块将使这变得非常容易。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T19:15:10.477

在查看了这些建议后，我最终使用了[HtmlUnit](http://htmlunit.sourceforge.net/ "html单元")。

使用 HtmlUnit，我能够自定义 Java 代码以打开文件夹中的每个 HTML 文件，导航到 TABLE 标记，查询每列内容并提取创建 CSV 文件所需的数据。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-16T01:59:55.507

在 .NET 中，您可以使用[HTMLAgilityPack](http://www.codeplex.com/htmlagilitypack)。

有关更多信息，请参阅StackOverflow 上的上[一个问题。](https://stackoverflow.com/questions/2861/options-for-html-scraping)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-16T02:03:57.057

如果你想从 HTML 标记中提取内容，你应该使用某种类型的 HTML 解析器。为此，那里有很多，这里有两个可能适合您的需求：

[http://jtidy.sourceforge.net/](http://jtidy.sourceforge.net/)
[http://htmlparser.sourceforge.net/](http://htmlparser.sourceforge.net/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-17T02:40:16.753

遍历文本并使用正则表达式:)

[http://www.knowledgehouse.sg](http://www.knowledgehouse.sg)

# php - PHP：我可以引用函数返回的数组的单个成员吗？

> ID：68711
> 
> 赞同：11
> 
> 时间：2008-09-16T01:56:27.980
> 
> 标签：php, arrays, function

任何想法如何在 PHP 中作为单行执行以下操作？：

```
<?php
$firstElement = functionThatReturnsAnArray()[0]; 
```

......它似乎没有“接受”。我需要以两步法执行此操作：

```
<?php
$allElements = functionThatReturnsAnArray();
$firstElement = $allElements[0]; 
```

...只是好奇-我使用的其他语言允许这样的事情，而且我懒得在 PHP 中错过这一点...任何见解都值得赞赏...

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-16T02:19:32.790

@斯科特·雷宁

这不是真的。这将起作用：

```
list(,,$thirdElement) = $myArray; 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-16T02:02:30.820

尝试：

```
<?php
$firstElement = reset(functionThatReturnsAnArray()); 
```

如果您只是在寻找数组的第一个元素。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-09-16T01:57:41.097

不幸的是，这在 PHP 中是不可能的。你必须使用两条线来做到这一点。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-09-16T04:03:45.520

您*可以*在一行中完成此操作！使用[array_shift()](http://us.php.net/array_shift)。

```
<?php

echo array_shift(i_return_an_array());

function i_return_an_array() {
    return array('foo', 'bar', 'baz');
} 
```

执行此操作时，它将回显“ `foo`”。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-16T02:15:51.490

list() 在这里很有用。对于除第一个数组元素之外的任何元素，您都需要用无用的变量填充它。例如：

```
list( $firstElement ) = functionThatReturnsAnArray();
list( $firstElement , $secondElement ) = functionThatReturnsAnArray(); 
```

等等。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-16T07:34:38.320

要么 要么`current($array)`将`array_shift($array)`工作，前者将保持*阵列*完好无损。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-16T09:25:13.360

你可以`array_slice()`像这样使用：

```
$elementX = array_slice(functionThatReturnsAnArray(), $x, 1); 
```

还注意到`end()`没有提到。它返回数组的最后一个元素。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-16T16:58:07.517

我实际上使用了我为此目的编写的便利函数：

```
/**
 * Grabs an element from an array using a key much like array_pop
 */
function array_key_value($array, $key) {
    if(!empty($array) && array_key_exists($key, $array)) {
        return $array[$key];
    }
    else {
        return FALSE;
    }
} 
```

然后你就这样称呼它：

```
$result = array_key_value(getMeAnArray(), 'arrayKey'); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-16T02:33:54.440

nickf，很高兴知道，谢谢。不幸的是，除了几个逗号之外，还有可读性问题。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-16T08:19:24.690

好吧，我找到了几种方法来获得你想要的东西，而无需调用另一个函数。

```
$firstElement = ($t = functionThatReturnsAnArray()) ? $t[0] : false; 
```

对于你可以使用的字符串

```
$string = (($t = functionThatReturnsAnArray())==0) . $t[0]; 
```

.. 有趣的问题

德拉科

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-16T13:55:33.133

我认为以上任何一项都需要评论来解释你在做什么，因此变成两行。我发现这样做更简单：

```
$element = functionThatReturnsArray();
$element = $element[0]; 
```

这样一来，您就没有使用额外的变量，而且很明显您在做什么。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-16T14:28:45.033

```
$firstItem = current(returnsArray()); 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-11-18T15:41:36.287

我猜这是一个内置或库函数，因为听起来你不能直接编辑它。我建议创建一个包装函数来为您提供所需的输出：

```
function functionThatReturnsOneElement( $arg )
{
    $result = functionThatReturnsAnArray( $arg );
    return $result[0];
}
$firstElement = functionThatReturnsOneElement(); 
```

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2008-09-16T01:57:59.910

据我所知，这是不可能的，我曾多次想自己做这件事。

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2008-09-16T02:08:52.037

[http://us3.php.net/reset](http://us3.php.net/reset)

仅在 php 版本 5 中可用。

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2008-09-16T02:39:51.963

如果它总是第一个元素，您可能应该考虑让函数只返回数组中的第一项。如果这是最常见的情况，您可以使用一点冷静：

```
function func($first = false) {
    ...
    if $first return $array[0];
    else return $array;
}

$array = func();
$item = func(true); 
```

我的 php 有点生锈，但我很确定它可以工作。

您还可以查看 array_shift() 和 array_pop()。

这可能也是可能的：

```
array(func())[0][i]; 
```

0 代表函数。

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2008-09-16T15:59:23.990

有时我会更改函数，因此它可以选择返回一个元素而不是整个数组：

```
<?php
function functionThatReturnsAnArray($n = NULL) {
  return ($n === NULL ? $myArray : $myArray[$n]);
}
$firstElement = functionThatReturnsAnArray(0); 
```

# java - 向现有应用程序添加审计的良好模式或框架？

> ID：68746
> 
> 赞同：10
> 
> 时间：2008-09-16T02:02:35.467
> 
> 标签：java, jakarta-ee, aop, crud, audit

我有一个现有的 J2EE 企业应用程序，我需要在其中添加审计，即能够记录几个重要域类型（Employee、AdministratorRights 等）上的 CRUD 操作。

该应用程序具有标准的 n 层架构：

*   网页界面
*   封装在无状态会话 bean 和事务性 POJO 的混合体中的业务操作（使用 Spring）
*   持久性是直接 JDBC（来自业务层内）和 EJB 2.x BMP 实体 bean（我知道，我知道）的混合体

我的问题是：是否有任何标准模式或（更好的）框架/库专门用于将审计添加为横切关注点？我知道 AOP 通常可用于实现横切关注点；我想知道是否有专门针对审计的东西。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2015-07-08T07:47:18.573

也许您应该看看[Audit4j](http://audit4j.org/)，它提供了对业务功能的审计并有几个配置选项。另一个框架是[JaVers](http://javers.org/)，它更侧重于审计持久层的低级修改，这可能更符合您的情况。

这两个框架都提供了超越普通 AOP/拦截器的特定于审计的功能。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-16T02:03:45.137

现在我倾向于使用 Spring AOP（使用“@AspectJ”样式）来建议暴露给 Web 层的业务操作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-30T15:25:22.937

我将在这里有点反对，并建议您查看较低层的解决方案。我们在我们的应用程序中有一个类似的架构，对于我们的审计，我们使用了数据库级审计触发器来跟踪 RDBMS 中的操作。这可以按照您喜欢的细粒度或粗粒度来完成，您只需确定要跟踪的实体即可。

现在，这不是一个纯粹的意识形态解决方案。它涉及将逻辑放入可以说应该保留在业务层中的数据库中，我不能否认这个视图具有价值，但在我们的例子中，我们有许多独立的应用程序与数据模型交互，其中一些是用 C 编写的，一些脚本化的应用程序和其他 J2EE 应用程序，所有这些应用程序都必须进行一致的审计。

请注意，在 J2EE 方面可能还有一些 AOP 工作需要完成；任何更新数据库的方法都可能需要做一些额外的工作来告诉数据库哪个用户正在做这项工作。我们使用数据库会话变量来执行此操作，但当然还有其他解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-16T02:04:03.453

尝试[面向方面](http://en.wikipedia.org/wiki/Aspect-oriented_programming)的编程框架。

来自维基百科“面向方面的编程（AOP）是一种编程范式，它通过允许分离横切关注点来增加模块化”。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-16T10:28:45.237

对于所有 EJB，您可以使用 EJB 3.0 拦截器（这类似于 Servlet 过滤器）和另一个类似的 Spring 拦截器（不熟悉 spring）因为您使用 EJB 以及可能无法覆盖整个事务的 Spring。另一种方法可能是使用前端控制器，但这需要在客户端进行一些修改。另一种方法可能是使用 Servlet 过滤器，但这意味着在表示层中实现域逻辑。

在这种情况下，我会推荐前端控制器。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-02-10T22:16:21.440

我刚刚了解了一个名为 Spring Data JPA 的新 Spring 项目，它提供了[基于 AOP 的审计功能](http://static.springsource.org/spring-data/data-jpa/docs/1.0.0.M1/reference/html/#jpa.auditing)。它还不是 GA，但值得关注。

# .net - 在 .NET 中使用 USB 设备

> ID：68749
> 
> 赞同：48
> 
> 时间：2008-09-16T02:02:58.073
> 
> 标签：.net, usb, communication

使用 .Net (C#)，如何使用 USB 设备？

如何检测 USB 事件（连接/断开连接）以及如何与设备通信（读/写）。

是否有本地 .Net 解决方案可以做到这一点？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2010-04-16T08:37:22.177

我试过使用 SharpUSBLib，但它搞砸了我的电脑（需要系统还原）。也发生在同一个项目的同事身上。

我在 LibUSBDotNet 中找到了一个替代方案：http: [//sourceforge.net/projects/libusbdotnet](http://sourceforge.net/projects/libusbdotnet) 还没有使用太多，但看起来不错并且最近更新了（与 Sharp 不同）。

编辑：截至 2017 年 2 月中旬，LibUSBDotNet 大约在 2 周前更新。同时 SharpUSBLib 自 2004 年以来一直没有更新。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2008-09-16T02:15:41.380

对此没有*本机*（例如，系统库）解决方案。[这就是moobaa](https://stackoverflow.com/questions/68749/working-with-usb-devices-in-net#68777)提到的[SharpUSBLib](http://www.icsharpcode.net/OpenSource/SharpUSBLib/)存在的原因。

如果您希望为 USB 设备滚动您自己的处理程序，您可以查看[System.IO.Ports 的 SerialPort 类](https://docs.microsoft.com/en-us/dotnet/api/system.io.ports.serialport)。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2012-12-11T22:33:46.580

我使用以下代码来检测 USB 设备何时从我的计算机上插入和拔出：

```
class USBControl : IDisposable
    {
        // used for monitoring plugging and unplugging of USB devices.
        private ManagementEventWatcher watcherAttach;
        private ManagementEventWatcher watcherRemove;

        public USBControl()
        {
            // Add USB plugged event watching
            watcherAttach = new ManagementEventWatcher();
            //var queryAttach = new WqlEventQuery("SELECT * FROM Win32_DeviceChangeEvent WHERE EventType = 2");
            watcherAttach.EventArrived += new EventArrivedEventHandler(watcher_EventArrived);
            watcherAttach.Query = new WqlEventQuery("SELECT * FROM Win32_DeviceChangeEvent WHERE EventType = 2");
            watcherAttach.Start();

            // Add USB unplugged event watching
            watcherRemove = new ManagementEventWatcher();
            //var queryRemove = new WqlEventQuery("SELECT * FROM Win32_DeviceChangeEvent WHERE EventType = 3");
            watcherRemove.EventArrived += new EventArrivedEventHandler(watcher_EventRemoved);
            watcherRemove.Query = new WqlEventQuery("SELECT * FROM Win32_DeviceChangeEvent WHERE EventType = 3");
            watcherRemove.Start();
        }

        /// <summary>
        /// Used to dispose of the USB device watchers when the USBControl class is disposed of.
        /// </summary>
        public void Dispose()
        {
            watcherAttach.Stop();
            watcherRemove.Stop();
            //Thread.Sleep(1000);
            watcherAttach.Dispose();
            watcherRemove.Dispose();
            //Thread.Sleep(1000);
        }

        void watcher_EventArrived(object sender, EventArrivedEventArgs e)
        {
            Debug.WriteLine("watcher_EventArrived");
        }

        void watcher_EventRemoved(object sender, EventArrivedEventArgs e)
        {
            Debug.WriteLine("watcher_EventRemoved");
        }

        ~USBControl()
        {
            this.Dispose();
        }

    } 
```

您必须确保在关闭应用程序时调用 Dispose() 方法。否则，您将在关闭时在运行时收到 COM 对象错误。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-10-02T00:25:13.110

我推荐[LibUSBDotNet](https://www.nuget.org/packages/LibUsbDotNet/)，我已经使用了 2 年的库。如果您必须使用 USB 设备（发送请求、处理响应），这个库是我能找到的最佳解决方案。

**优点：**

*   拥有在同步或异步模式下工作所需的所有方法。
*   提供的源代码
*   足够的样本可以立即开始使用。

**缺点：**

*   糟糕的文档（这是开源项目的常见问题）。基本上，您可以在 CHM 帮助文件中找到常见的方法描述，仅此而已。但我仍然发现提供的示例和源代码足以进行编码。只是有时我看到一个奇怪的行为，想知道为什么以这种方式实现它，甚至无法得到提示......
*   似乎不再支持了。上一个版本是 2010 年 10 月发布的。有时很难得到答案。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2018-08-15T06:55:23.180

USB 设备通常分为两类：Hid 和 USB。USB 设备可能是也可能不是 Hid 设备，反之亦然。Hid 通常比直接 USB 更容易使用。不同的平台有不同的 API 来处理 USB 和 Hid。

这是 UWP 的文档：

USB： [https ://docs.microsoft.com/en-us/windows-hardware/drivers/usbcon/how-to-connect-to-a-usb-device--uwp-app-](https://docs.microsoft.com/en-us/windows-hardware/drivers/usbcon/how-to-connect-to-a-usb-device--uwp-app-)

隐藏： [https ://docs.microsoft.com/en-us/uwp/api/windows.devices.humaninterfacedevice](https://docs.microsoft.com/en-us/uwp/api/windows.devices.humaninterfacedevice)

这是 Android 的文档： [https ://developer.xamarin.com/api/namespace/Android.Hardware.Usb/](https://developer.xamarin.com/api/namespace/Android.Hardware.Usb/)

以下是在原始 Windows API 级别处理 USB/Hid 的两个类：

[https://github.com/MelbourneDeveloper/Device.Net/blob/master/src/Hid.Net/Windows/HidAPICalls.cs](https://github.com/MelbourneDeveloper/Device.Net/blob/master/src/Hid.Net/Windows/HidAPICalls.cs)

```
public static class HidAPICalls 
{
    #region Constants
    private const int DigcfDeviceinterface = 16;
    private const int DigcfPresent = 2;
    private const uint FileShareRead = 1;
    private const uint FileShareWrite = 2;
    private const uint GenericRead = 2147483648;
    private const uint GenericWrite = 1073741824;
    private const uint OpenExisting = 3;
    private const int HIDP_STATUS_SUCCESS = 0x110000;
    private const int HIDP_STATUS_INVALID_PREPARSED_DATA = -0x3FEF0000;
    #endregion

    #region API Calls

    [DllImport("hid.dll", SetLastError = true)]
    private static extern bool HidD_GetPreparsedData(SafeFileHandle hidDeviceObject, out IntPtr pointerToPreparsedData);

    [DllImport("hid.dll", SetLastError = true, CallingConvention = CallingConvention.StdCall)]
    private static extern bool HidD_GetManufacturerString(SafeFileHandle hidDeviceObject, IntPtr pointerToBuffer, uint bufferLength);

    [DllImport("hid.dll", SetLastError = true, CallingConvention = CallingConvention.StdCall)]
    private static extern bool HidD_GetProductString(SafeFileHandle hidDeviceObject, IntPtr pointerToBuffer, uint bufferLength);

    [DllImport("hid.dll", SetLastError = true, CallingConvention = CallingConvention.StdCall)]
    private static extern bool HidD_GetSerialNumberString(SafeFileHandle hidDeviceObject, IntPtr pointerToBuffer, uint bufferLength);

    [DllImport("hid.dll", SetLastError = true)]
    private static extern int HidP_GetCaps(IntPtr pointerToPreparsedData, out HidCollectionCapabilities hidCollectionCapabilities);

    [DllImport("hid.dll", SetLastError = true)]
    private static extern bool HidD_GetAttributes(SafeFileHandle hidDeviceObject, out HidAttributes attributes);

    [DllImport("hid.dll", SetLastError = true)]
    private static extern bool HidD_FreePreparsedData(ref IntPtr pointerToPreparsedData);

    [DllImport("hid.dll", SetLastError = true)]
    private static extern void HidD_GetHidGuid(ref Guid hidGuid);

    private delegate bool GetString(SafeFileHandle hidDeviceObject, IntPtr pointerToBuffer, uint bufferLength);

    #endregion

    #region Helper Methods

    #region Public Methods
    public static HidAttributes GetHidAttributes(SafeFileHandle safeFileHandle)
    {
        var isSuccess = HidD_GetAttributes(safeFileHandle, out var hidAttributes);
        WindowsDeviceBase.HandleError(isSuccess, "Could not get Hid Attributes");
        return hidAttributes;
    }

    public static HidCollectionCapabilities GetHidCapabilities(SafeFileHandle readSafeFileHandle)
    {
        var isSuccess = HidD_GetPreparsedData(readSafeFileHandle, out var pointerToPreParsedData);
        WindowsDeviceBase.HandleError(isSuccess, "Could not get pre parsed data");

        var result = HidP_GetCaps(pointerToPreParsedData, out var hidCollectionCapabilities);
        if (result != HIDP_STATUS_SUCCESS)
        {
            throw new Exception($"Could not get Hid capabilities. Return code: {result}");
        }

        isSuccess = HidD_FreePreparsedData(ref pointerToPreParsedData);
        WindowsDeviceBase.HandleError(isSuccess, "Could not release handle for getting Hid capabilities");

        return hidCollectionCapabilities;
    }

    public static string GetManufacturer(SafeFileHandle safeFileHandle)
    {
        return GetHidString(safeFileHandle, HidD_GetManufacturerString);
    }

    public static string GetProduct(SafeFileHandle safeFileHandle)
    {
        return GetHidString(safeFileHandle, HidD_GetProductString);
    }

    public static string GetSerialNumber(SafeFileHandle safeFileHandle)
    {
        return GetHidString(safeFileHandle, HidD_GetSerialNumberString);
    }
    #endregion

    #region Private Static Methods
    private static string GetHidString(SafeFileHandle safeFileHandle, GetString getString)
    {
        var pointerToBuffer = Marshal.AllocHGlobal(126);
        var isSuccess = getString(safeFileHandle, pointerToBuffer, 126);
        Marshal.FreeHGlobal(pointerToBuffer);
        WindowsDeviceBase.HandleError(isSuccess, "Could not get Hid string");
        return Marshal.PtrToStringUni(pointerToBuffer);     
    }
    #endregion

    #endregion 
```

}

[https://github.com/MelbourneDeveloper/Device.Net/blob/master/src/Usb.Net/Windows/WinUsbApiCalls.cs](https://github.com/MelbourneDeveloper/Device.Net/blob/master/src/Usb.Net/Windows/WinUsbApiCalls.cs)

```
public static partial class WinUsbApiCalls
{
    #region Constants
    public const int EnglishLanguageID = 1033;
    public const uint DEVICE_SPEED = 1;
    public const byte USB_ENDPOINT_DIRECTION_MASK = 0X80;
    public const int WritePipeId = 0x80;

    /// <summary>
    /// Not sure where this constant is defined...
    /// </summary>
    public const int DEFAULT_DESCRIPTOR_TYPE = 0x01;
    public const int USB_STRING_DESCRIPTOR_TYPE = 0x03;
    #endregion

    #region API Calls
    [DllImport("winusb.dll", SetLastError = true)]
    public static extern bool WinUsb_ControlTransfer(IntPtr InterfaceHandle, WINUSB_SETUP_PACKET SetupPacket, byte[] Buffer, uint BufferLength, ref uint LengthTransferred, IntPtr Overlapped);

    [DllImport("winusb.dll", SetLastError = true, CharSet = CharSet.Auto)]
    public static extern bool WinUsb_GetAssociatedInterface(SafeFileHandle InterfaceHandle, byte AssociatedInterfaceIndex, out SafeFileHandle AssociatedInterfaceHandle);

    [DllImport("winusb.dll", SetLastError = true)]
    public static extern bool WinUsb_GetDescriptor(SafeFileHandle InterfaceHandle, byte DescriptorType, byte Index, ushort LanguageID, out USB_DEVICE_DESCRIPTOR deviceDesc, uint BufferLength, out uint LengthTransfered);

    [DllImport("winusb.dll", SetLastError = true)]
    public static extern bool WinUsb_GetDescriptor(SafeFileHandle InterfaceHandle, byte DescriptorType, byte Index, UInt16 LanguageID, byte[] Buffer, UInt32 BufferLength, out UInt32 LengthTransfered);

    [DllImport("winusb.dll", SetLastError = true)]
    public static extern bool WinUsb_Free(SafeFileHandle InterfaceHandle);

    [DllImport("winusb.dll", SetLastError = true)]
    public static extern bool WinUsb_Initialize(SafeFileHandle DeviceHandle, out SafeFileHandle InterfaceHandle);

    [DllImport("winusb.dll", SetLastError = true)]
    public static extern bool WinUsb_QueryDeviceInformation(IntPtr InterfaceHandle, uint InformationType, ref uint BufferLength, ref byte Buffer);

    [DllImport("winusb.dll", SetLastError = true)]
    public static extern bool WinUsb_QueryInterfaceSettings(SafeFileHandle InterfaceHandle, byte AlternateInterfaceNumber, out USB_INTERFACE_DESCRIPTOR UsbAltInterfaceDescriptor);

    [DllImport("winusb.dll", SetLastError = true)]
    public static extern bool WinUsb_QueryPipe(SafeFileHandle InterfaceHandle, byte AlternateInterfaceNumber, byte PipeIndex, out WINUSB_PIPE_INFORMATION PipeInformation);

    [DllImport("winusb.dll", SetLastError = true)]
    public static extern bool WinUsb_ReadPipe(SafeFileHandle InterfaceHandle, byte PipeID, byte[] Buffer, uint BufferLength, out uint LengthTransferred, IntPtr Overlapped);

    [DllImport("winusb.dll", SetLastError = true)]
    public static extern bool WinUsb_SetPipePolicy(IntPtr InterfaceHandle, byte PipeID, uint PolicyType, uint ValueLength, ref uint Value);

    [DllImport("winusb.dll", SetLastError = true)]
    public static extern bool WinUsb_WritePipe(SafeFileHandle InterfaceHandle, byte PipeID, byte[] Buffer, uint BufferLength, out uint LengthTransferred, IntPtr Overlapped);
    #endregion

    #region Public Methods
    public static string GetDescriptor(SafeFileHandle defaultInterfaceHandle, byte index, string errorMessage)
    {
        var buffer = new byte[256];
        var isSuccess = WinUsb_GetDescriptor(defaultInterfaceHandle, USB_STRING_DESCRIPTOR_TYPE, index, EnglishLanguageID, buffer, (uint)buffer.Length, out var transfered);
        WindowsDeviceBase.HandleError(isSuccess, errorMessage);
        var descriptor = new string(Encoding.Unicode.GetChars(buffer, 2, (int)transfered));
        return descriptor.Substring(0, descriptor.Length - 1);
    }
    #endregion
} 
```

使用这些解决方案中的任何一个，您要么需要按时间间隔轮询设备，要么使用 API 的本机设备侦听类之一。但是，此库在所有平台上跨 Hid 和 USB 放置一个层，以便您可以轻松检测连接和断开连接：[https](https://github.com/MelbourneDeveloper/Device.Net/wiki/Device-Listener) ://github.com/MelbourneDeveloper/Device.Net/wiki/Device-Listener 。这是你将如何使用它：

```
internal class TrezorExample : IDisposable
{
    #region Fields
    //Define the types of devices to search for. This particular device can be connected to via USB, or Hid
    private readonly List<FilterDeviceDefinition> _DeviceDefinitions = new List<FilterDeviceDefinition>
    {
        new FilterDeviceDefinition{ DeviceType= DeviceType.Hid, VendorId= 0x534C, ProductId=0x0001, Label="Trezor One Firmware 1.6.x", UsagePage=65280 },
        new FilterDeviceDefinition{ DeviceType= DeviceType.Usb, VendorId= 0x534C, ProductId=0x0001, Label="Trezor One Firmware 1.6.x (Android Only)" },
        new FilterDeviceDefinition{ DeviceType= DeviceType.Usb, VendorId= 0x1209, ProductId=0x53C1, Label="Trezor One Firmware 1.7.x" },
        new FilterDeviceDefinition{ DeviceType= DeviceType.Usb, VendorId= 0x1209, ProductId=0x53C0, Label="Model T" }
    };
    #endregion

    #region Events
    public event EventHandler TrezorInitialized;
    public event EventHandler TrezorDisconnected;
    #endregion

    #region Public Properties
    public IDevice TrezorDevice { get; private set; }
    public DeviceListener DeviceListener { get; private set; }
    #endregion

    #region Event Handlers
    private void DevicePoller_DeviceInitialized(object sender, DeviceEventArgs e)
    {
        TrezorDevice = e.Device;
        TrezorInitialized?.Invoke(this, new EventArgs());
    }

    private void DevicePoller_DeviceDisconnected(object sender, DeviceEventArgs e)
    {
        TrezorDevice = null;
        TrezorDisconnected?.Invoke(this, new EventArgs());
    }
    #endregion

    #region Public Methods
    public void StartListening()
    {
        TrezorDevice?.Dispose();
        DeviceListener = new DeviceListener(_DeviceDefinitions, 3000);
        DeviceListener.DeviceDisconnected += DevicePoller_DeviceDisconnected;
        DeviceListener.DeviceInitialized += DevicePoller_DeviceInitialized;
    }

    public async Task InitializeTrezorAsync()
    {
        //Get the first available device and connect to it
        var devices = await DeviceManager.Current.GetDevices(_DeviceDefinitions);
        TrezorDevice = devices.FirstOrDefault();
        await TrezorDevice.InitializeAsync();
    }

    public async Task<byte[]> WriteAndReadFromDeviceAsync()
    {
        //Create a buffer with 3 bytes (initialize)
        var writeBuffer = new byte[64];
        writeBuffer[0] = 0x3f;
        writeBuffer[1] = 0x23;
        writeBuffer[2] = 0x23;

        //Write the data to the device
        return await TrezorDevice.WriteAndReadAsync(writeBuffer);
    }

    public void Dispose()
    {
        TrezorDevice?.Dispose();
    }
    #endregion
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-03-08T16:35:47.200

这里有一个关于使用 C# 获取 SharpUSBLib 库和 HID 驱动程序的教程：

[http://www.developerfusion.com/article/84338/making-usb-c-friendly/](http://www.developerfusion.com/article/84338/making-usb-c-friendly/)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-16T08:31:25.253

有一个通用工具包[WinDriver](http://www.jungo.com/st/windriver_usb_pci_driver_development_software.html#)用于在用户模式下编写支持#.NET 的 USB 驱动程序

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-02-27T22:50:04.270

如果您的 PC 上有**National Instruments**软件，您可以使用他们的*“NI-VISA 驱动程序向导”*创建 USB 驱动程序。

创建 USB 驱动程序的步骤：http: [//www.ni.com/tutorial/4478/en/](http://www.ni.com/tutorial/4478/en/)

创建驱动程序后，您将能够向任何 USB 设备写入和读取字节。

确保设备管理器下的 Windows 可以看到驱动程序：

![在此处输入图像描述](https://i.stack.imgur.com/ZJBla.png)

C#代码：

```
 using NationalInstruments.VisaNS;

    #region UsbRaw
    /// <summary>
    /// Class to communicate with USB Devices using the UsbRaw Class of National Instruments
    /// </summary>
    public class UsbRaw
    {
        private NationalInstruments.VisaNS.UsbRaw usbRaw;
        private List<byte> DataReceived = new List<byte>();

        /// <summary>
        /// Initialize the USB Device to interact with
        /// </summary>
        /// <param name="ResourseName">In this format: "USB0::0x1448::0x8CA0::NI-VISA-30004::RAW".  Use the NI-VISA Driver Wizard from Start»All Programs»National Instruments»VISA»Driver Wizard to create the USB Driver for the device you need to talk to.</param>
        public UsbRaw(string ResourseName)
        {
            usbRaw = new NationalInstruments.VisaNS.UsbRaw(ResourseName, AccessModes.NoLock, 10000, false);
            usbRaw.UsbInterrupt += new UsbRawInterruptEventHandler(OnUSBInterrupt);
            usbRaw.EnableEvent(UsbRawEventType.UsbInterrupt, EventMechanism.Handler);
        }

        /// <summary>
        /// Clears a USB Device from any previous commands
        /// </summary>
        public void Clear()
        {
            usbRaw.Clear();
        }

        /// <summary>
        /// Writes Bytes to the USB Device
        /// </summary>
        /// <param name="EndPoint">USB Bulk Out Pipe attribute to send the data to.  For example: If you see on the Bus Hound sniffer tool that data is coming out from something like 28.4 (Device column), this means that the USB is using Endpoint 4 (Number after the dot)</param>
        /// <param name="BytesToSend">Data to send to the USB device</param>
        public void Write(short EndPoint, byte[] BytesToSend)
        {
            usbRaw.BulkOutPipe = EndPoint;
            usbRaw.Write(BytesToSend);       // Write to USB
        }

        /// <summary>
        /// Reads bytes from a USB Device
        /// </summary>
        /// <returns>Bytes Read</returns>
        public byte[] Read()
        {
            usbRaw.ReadByteArray();     // This fires the UsbRawInterruptEventHandler                

            byte[] rxBytes = DataReceived.ToArray();      // Collects the data received

            return rxBytes;
        }

        /// <summary>
        /// This is used to get the data received by the USB device
        /// </summary>
        /// <param name="sender"></param>
        /// <param name="e"></param>
        private void OnUSBInterrupt(object sender, UsbRawInterruptEventArgs e)
        {
            try
            {
                DataReceived.Clear();     // Clear previous data received
                DataReceived.AddRange(e.DataBuffer);                    
            }
            catch (Exception exp)
            {
                string errorMsg = "Error: " + exp.Message;
                DataReceived.AddRange(ASCIIEncoding.ASCII.GetBytes(errorMsg));
            }
        }

        /// <summary>
        /// Use this function to clean up the UsbRaw class
        /// </summary>
        public void Dispose()
        {
            usbRaw.DisableEvent(UsbRawEventType.UsbInterrupt, EventMechanism.Handler);

            if (usbRaw != null)
            {
                usbRaw.Dispose();
            }              
        }

    }
    #endregion UsbRaw 
```

用法：

```
UsbRaw usbRaw = new UsbRaw("USB0::0x1448::0x8CA0::NI-VISA-30004::RAW");

byte[] sendData = new byte[] { 0x53, 0x4c, 0x56 };
usbRaw.Write(4, sendData);      // Write bytes to the USB Device
byte[] readData = usbRaw.Read();   // Read bytes from the USB Device

usbRaw.Dispose(); 
```

希望这可以帮助某人。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-16T02:11:02.687

大多数 USB 芯片组都带有驱动程序。 [Silicon Labs](https://www.silabs.com/products/mcu/usb/Pages/default.aspx)有一个。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-08-19T15:45:29.067

[使用这篇文章](http://www.codeproject.com/Articles/18099/A-USB-HID-Component-for-C)，我得到了一个工作得很好的[Teensy界面](http://www.pjrc.com/teensy/index.html)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-06-19T20:56:36.883

我尝试了其中的几个建议，但都没有成功。我最终使用 Java 和[hid4java](https://github.com/gary-rowe/hid4java)库编写了一个可行的解决方案。作为一个控制台应用程序，我可以从 C# 中使用`Process.Start()`、传递参数以及读取响应。这提供了基本的 HID I/O，但没有连接/断开事件。为此，我需要重写它以作为守护程序/服务运行并使用命名管道或其他一些服务器/客户端传输。现在，完成这项工作就足够了，因为 hi4java 库“正常工作”。

# c# - 如何为泛型类编写 C# 扩展方法

> ID：68750
> 
> 赞同：11
> 
> 时间：2008-09-16T02:03:16.387
> 
> 标签：c#, asp.net-mvc, generics, extension-methods

这应该是一个简单的。

我想向 System.Web.Mvc.ViewPage< T > 类添加一个扩展方法。

这个扩展方法应该怎么看？

我的第一个直觉想法是这样的：

```
namespace System.Web.Mvc
{
    public static class ViewPageExtensions
    {
        public static string GetDefaultPageTitle(this ViewPage<Type> v)
        {
            return "";
        }
    }
} 
```

**解决方案**

一般的解决方案是[这个答案](https://stackoverflow.com/questions/68750/how-do-you-write-a-c-extension-method-for-a-generically-typed-class#68772)。

扩展 System.Web.Mvc.ViewPage 类的具体解决方案是[我](https://stackoverflow.com/questions/68750/how-do-you-write-a-c-extension-method-for-a-generically-typed-class#68802)下面的回答，从[通用解决方案](https://stackoverflow.com/questions/68750/how-do-you-write-a-c-extension-method-for-a-generically-typed-class#68772)开始。

不同之处在于，在特定情况下，您需要一个泛型类型的方法声明和一个将泛型类型强制为引用类型的语句。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-09-16T02:05:58.580

我当前的机器上没有安装 VS，但我认为语法是：

```
namespace System.Web.Mvc
{
    public static class ViewPageExtensions
    {
        public static string GetDefaultPageTitle<T>(this ViewPage<T> v)
        {
            return "";
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-16T02:10:13.750

谢谢leddt。这样做会产生错误：

> 类型“TModel”必须是引用类型才能在泛型类型或方法中用作参数“TModel”

这指向了[这个页面](http://forums.asp.net/p/1311022/2581563.aspx)，它产生了这个解决方案：

```
namespace System.Web.Mvc
{
    public static class ViewPageExtensions
    {
        public static string GetDefaultPageTitle<T>(this ViewPage<T> v) 
          where T : class
        {
            return "";
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-16T02:06:55.940

它只需要函数上的泛型类型说明符：

```
namespace System.Web.Mvc
{
    public static class ViewPageExtensions
    {
        public static string GetDefaultPageTitle<Type>(this ViewPage<Type> v)
        {
            return "";
        }
    }
} 
```

编辑：只是错过了几秒钟！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-16T02:35:50.833

```
namespace System.Web.Mvc
{
    public static class ViewPageExtensions
    {
        public static string GetDefaultPageTitle<T>(this ViewPage<T> view)
            where T : class
        {
            return "";
        }
    }
} 
```

您可能还需要/希望将“new()”限定符添加到泛型类型（即“where T : class, new()”以强制 T 既是引用类型（类）又具有无参数构造函数。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-16T02:15:24.737

如果您希望扩展仅适用于指定类型，您只需指定您将要处理的实际类型

就像是...

```
public static string GetDefaultPageTitle(this ViewPage<YourSpecificType> v)
{
  ...
} 
```

请注意，智能感知将仅在您声明（在本例中）具有匹配类型的 ViewPage 时显示扩展方法。

另外，最好不要使用 System.Web.Mvc 命名空间，我知道不必在 usings 部分中包含命名空间会很方便，但如果为扩展函数创建自己的扩展命名空间，它更易于维护。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-16T02:22:28.430

[Glenn Block](http://codebetter.com/blogs/glenn.block/archive/2008/08/19/foreach-a-simple-but-very-useful-extension-method.aspx)有一个很好的例子来`ForEach`实现`IEnumerable<T>`.

从他的[博客文章](http://codebetter.com/blogs/glenn.block/archive/2008/08/19/foreach-a-simple-but-very-useful-extension-method.aspx)：

```
public static class IEnumerableUtils
{
    public static void ForEach<T>(this IEnumerable<T> collection, Action<T> action)
    {
        foreach(T item in collection)
            action(item);
    }
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-08-02T05:21:07.907

这是 Razor 视图的示例：

```
public static class WebViewPageExtensions
{
    public static string GetFormActionUrl(this WebViewPage view)
    {
        return string.Format("/{0}/{1}/{2}", view.GetController(), view.GetAction(), view.GetId());
    }

    public static string GetController(this WebViewPage view)
    {
        return Get(view, "controller");
    }

    public static string GetAction(this WebViewPage view)
    {
        return Get(view, "action");
    }

    public static string GetId(this WebViewPage view)
    {
        return Get(view, "id");
    }

    private static string Get(WebViewPage view, string key)
    {
        return view.ViewContext.Controller.ValueProvider.GetValue(key).RawValue.ToString();
    }
} 
```

您真的不需要使用通用版本，因为通用版本扩展了非通用版本，因此只需将其放在非通用基类中即可：)

# asp.net - 如何判断 ASP.Net 应用程序中的视图状态是否已被篡改？

> ID：68764
> 
> 赞同：1
> 
> 时间：2008-09-16T02:05:26.723
> 
> 标签：asp.net, viewstate

在一次关于安全性的讨论中，我团队的一位开发人员询问是否有办法判断视图状态是否被篡改。我很尴尬地说我不知道​​答案。我告诉他我会知道的，但我想我会给这里的人一个机会先回答。我知道有一些自动验证，但是如果未启用事件验证，有没有办法手动进行？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-16T02:05:48.503

EnableViewStateMac 页面指令

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-16T02:21:37.793

默认情况下，ViewState 使用 MAC 密钥（来自机器或来自 web.config 文件）进行 MIME 编码和散列，这有助于防止篡改（即解码崩溃）。如果您愿意，也可以分别加密和压缩 ViewState 以获得进一步的保护和更少的开销。请参阅[MS ViewState](http://msdn.microsoft.com/en-us/library/bb386448.aspx#SecuringViewState)和[CodeProject.com](http://www.codeproject.com/KB/viewstate/ViewStateCompression.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-16T02:11:05.493

您可能可以手动执行此操作，但您只是实现了已经为您提供的相同算法。在页面上禁用 ViewState 验证通常是个坏主意。

# python - 在 Python 中打开套接字的最佳方法

> ID：68774
> 
> 赞同：48
> 
> 时间：2008-09-16T02:06:11.857
> 
> 标签：python, networking, tcp

我想在 Python 中打开一个 TCP 客户端套接字。我是否必须通过所有低级 BSD create-socket-handle / connect-socket 的东西，还是有更简单的单行方式？

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2008-09-16T02:09:46.170

在 python 中打开套接字非常简单。你真的只需要这样的东西：

```
import socket
sock = socket.socket()
sock.connect((address, port)) 
```

然后你可以像任何其他插座`send()`一样`recv()`

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2008-09-16T02:31:24.120

好的，这段代码有效

```
s = socket.socket()
s.connect((ip,port))
s.send("my request\r")
print s.recv(256)
s.close() 
```

从 Python 套接字模块文档中很难解决这个问题。所以我会接受 The.Anti.9 的回答。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-09-16T02:28:38.197

对于用 Python 开发任何类型的可移植网络程序，[Twisted](http://twistedmatrix.com)非常有用。它的好处之一是在低级套接字 API 之上提供了一个方便的层。

# authentication - 贵公司如何管理凭据？

> ID：68792
> 
> 赞同：8
> 
> 时间：2008-09-16T02:09:21.053
> 
> 标签：authentication, passwords, credentials

这是对建议甚至可能的解决方案的呼吁。我还没有在一家似乎真正让证书管理“正确”的公司工作。

我看过 excel/word 文档，甚至是便利贴“解决方案”。

但我的主要问题是正确的方法是什么？

我最初认为它会围绕 KeePass 展开，但是您将如何管理用户之间的这些数据库？

此外，在我见过的所有在线密码管理器中，没有一个是真正的多用户。

希望这可以带来一些观点，并对我没有看到任何好的答案的事情有所启发。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-26T17:32:52.953

我工作的公司销售数据中心自动化工具来帮助解决这个问题。我不会说我为谁工作，也不会说它要花多少钱（但它显然并不便宜）。

我们使用该工具（由数百家大公司使用）采用的基本方法是将 LDAP/AD 身份验证与公司目录服务器集成。然后，当代理部署到托管服务器时，可以在产品中设置权限控制，然后根据您的用户/组权限管理对给定设备组/服务器类/设施/等的访问。

至于*我们*如何在内部管理凭据-我将第二次@ [irixman](https://stackoverflow.com/questions/68792/how-does-your-company-manage-credentials#68823)的评论-我们做得非常非常糟糕:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-16T02:14:47.030

回答你的问题：很差。

我们正在寻求标准化用于无密码身份验证和共享组/密码文件的公钥。到目前为止，我们的测试看起来不错，但我们仍在努力消除一些粗糙的边缘。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-26T17:42:55.913

这个问题问得好。我去过的两家公司都不好处理。

我想听听一些有经验的人以可管理且有效的方式执行此操作。我对此的感觉是，这是一个普遍的问题，人们不谈论，而只是应付它。

+1 为问题和一颗星:-)

# cocoa - 在 NSTableView 中动态隐藏列

> ID：68821
> 
> 赞同：2
> 
> 时间：2008-09-16T02:14:21.743
> 
> 标签：cocoa, macos

我想根据要显示的数据动态隐藏/显示 NSTableView 中的某些列 - 基本上，如果一列为空，我希望隐藏该列。我目前正在使用控制器类作为表的委托填充表。

有任何想法吗？我看到我可以在 Interface Builder 中设置隐藏的列，但是似乎不是检查这些列并检查它们是否为空的好时机，因为似乎没有一种方法是在填充表中的所有数据之前/之后调用。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-02-28T21:45:27.273

在 Mac OS X v10.5 及更高版本中，有NSTableColumn的[`setHidden:`选择器。](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/ApplicationKit/Classes/NSTableColumn_Class/Reference/Reference.html#//apple_ref/occ/instm/NSTableColumn/setHidden:)

这允许使用标识符动态隐藏/显示列：

```
NSInteger colIdx;
NSTableColumn* col;

colIdx = [myTable columnWithIdentifier:@"columnIdent"];
col = [myTable.tableColumns objectAtIndex:colIdx];
[col setHidden:YES]; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-16T12:12:54.847

我已经通过绑定完成了这项工作，但是以编程方式而不是通过 Interface Builder 设置它们。

这个伪片段应该给你它的要点：

```
NSTableColumn *aColumn = [[NSTableColumn alloc] initWithIdentifier:attr];
[aColumn setWidth:DEFAULTCOLWIDTH];
[aColumn setMinWidth:MINCOLWIDTH];
[[aColumn headerCell] setStringValue:columnLabel];

[aColumn bind:@"value"
     toObject:arrayController 
  withKeyPath:keyPath 
  options:nil];             

[tableView addTableColumn:aColumn];
[aColumn release]; 
```

当然，您也可以添加格式化程序和所有这些东西。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-10-09T11:58:07.060

它在界面生成器中不起作用。但是它以编程方式工作。下面是我如何将带有标识符“Status”的 NSTableViewColumn 绑定到我的 NSUserDefaults 中的键：

**迅速：**

```
tableView.tableColumnWithIdentifier("Status")?.bind("hidden", toObject: NSUserDefaults.standardUserDefaults(), withKeyPath: "TableColumnStatus", options: nil) 
```

**目标-C：**

```
[[self.tableView tableColumnWithIdentifier:@"Status"] bind:@"hidden" toObject:[NSUserDefaults standardUserDefaults] withKeyPath:@"TableColumnStatus" options:nil]; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-16T04:09:36.753

我目前没有完整的答案，但请查看 Bindings。使用 Cocoa Bindings 通常可以做各种各样的事情。

NSTableColumn 没有可见性绑定，但您可以将宽度设置为 0。

然后你可以将它绑定到 Null 占位符，并将这个值设置为 0 - 但不要忘记将其他占位符设置为合理的值。

（正如我所说，这只是一个开始，可能需要一些调整）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-16T12:01:25.233

没有一次填充所有数据。NSTableView 不存储数据，它动态地从其数据源（或绑定到对象，如果您使用绑定）中请求它。它只是使用从数据源获取的数据进行绘制并将其丢弃。例如，您不应该看到表格要求任何不可见的数据。

听起来您正在使用数据源？当数据发生变化时，你有责任在表上调用 -reloadData，这有点用词不当。这更像是“使一切无效”。

也就是说，您应该已经知道数据何时更改。这就是您可以计算应该隐藏哪些列的点。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T23:41:34.573

@amrox - 如果我正确理解您的建议，您是说我应该将值绑定到表中 NSTableColumns 的隐藏属性？这似乎可行，但是我认为 NSTableColumn 没有隐藏属性，因为 isHidden 和 setHidden 消息控制列的可见性 - 这告诉我这不是属性，除非我错过了一些东西（这是很有可能的）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-30T10:48:50.090

NSTable 只是绘制表格的类。正如您自己所说，您有一些类将表作为委托，并且该类为表提供要显示的数据。如果您将表数据作为 NSArray 存储在您的委托类中，那么应该很容易找出一列是否为空，不是吗？并且 NSArray 通过委托方法询问您的类有多少列，所以当您被问到时，为什么不查找您有多少列数据并报告该数字而不是您在内部存储的实际列数，然后在被要求时提供（列，行）的数据，只需跳过空列。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-11-02T01:22:45.780

我想使用 Cocoa 绑定和实际`isHidden`标志发布我为 Swift 4 更新的解决方案，而不触及列宽（因为之后您可能需要恢复原始值......）。假设我们有一个复选框来切换某些列的可见性（或者您可以随时`hideColumnsFlag`以您喜欢的任何其他方式切换下面示例中的变量）：

```
class ViewController: NSViewController {

     // define the boolean binding variable to hide the columns and use its name as keypath
     @objc dynamic var hideColumnsFlag = true

     // Referring the column(s)
     // Method 1: creating IBOutlet(s) for the column(s): just ctrl-drag each column here to add it
     @IBOutlet weak var hideableTableColumn: NSTableColumn!
     // add as many column outlets as you need...

     // or, if you prefer working with columns' string keypaths
     // Method 2: use just the table view IBOutlet and its column identifiers (you **must** anyway set the latter identifiers manually via IB for each column)
     @IBOutlet weak var theTableView: NSTableView! // this line could be actually removed if using the first method on this example, but in a real case, you will probably need it anyway.

     // MARK: View Controller Lifecycle

     override func viewDidLoad() {
         super.viewDidLoad()

         // Method 1
         // referring the columns by using the outlets as such:
         hideableTableColumn.bind(.hidden, to: self, withKeyPath: "hideColumnsFlag", options: nil)
         // repeat for each column outlet.

         // Method 2
         // or if you need/prefer to use the column identifiers strings then:
         // theTableView.tableColumn(withIdentifier: .init("columnName"))?.bind(.hidden, to: self, withKeyPath: "hideColumnsFlag", options: nil)
         // repeat for each column identifier you have set.

         // obviously use just one method by commenting/uncommenting one or the other.
     }

     // MARK: Actions

     // this is the checkBox action method, just toggling the boolean variable bound to the columns in the viewDidLoad method.
     @IBAction func hideColumnsCheckboxAction(_ sender: NSButton) {
         hideColumnsFlag = sender.state == .on
     }
} 
```

您可能已经注意到，还没有办法`Hidden`像在 XCode10 上那样在 Interface Builder 中绑定标志：您可以看到`Enabled`or`Editable`绑定，但只有通过编程才能访问`isHidden`列的标志，因为它在 Swift 中被调用。

如评论中所述，第二种方法依赖于您必须在选择相关列后通过 Identity 字段上的 Interface Builder 手动设置的列标识符，或者，如果您有一个列名数组，您可以枚举表列并分配标识符以及绑定，而不是重复类似的代码行。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-08-17T02:42:46.460

我找到了一个简单的解决方案。

如果要使用 Cocoa 绑定技术隐藏任何列：

1.  在您的实例中`NSArrayController,`创建一个属性/参数/槽/键值，`NSNumber`如果您希望隐藏特定列，则该值为 0，否则为任何值。
2.  将表列对象的`maxWidth`参数绑定到数据槽，如（1）中所述。我们将使用`maxWidth`绑定参数作为消息接收者。
3.  子类化 NSTableColumn：

```
import Cocoa

class Column: NSTableColumn {

    /// Observe the binding messages
    override func setValue(_ value: Any?, forKey key: String) {
        if key == "maxWidth" && value != nil { // Filters the signal
            let w = value as! NSNumber // Explores change
            if w == NSNumber(integerLiteral: 0) {
                self.isHidden = true
            } else {
                self.isHidden = false
            }
            return // No propagation for the value change
        }
        super.setValue(value, forKey: key) // Propagate the signal
    }

} 
```

4.  将列的类更改为`Column.`

# visual-studio - 防止 Visual Studio 崩溃（有时）

> ID：68832
> 
> 赞同：-1
> 
> 时间：2008-09-16T02:17:24.620
> 
> 标签：visual-studio

当我选择“关闭除此之外的所有”选项时，如何阻止 Visual Studio（2005 和 2008）崩溃（有时）？这也不会一直发生。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-16T02:26:10.577

首先，检查[Windows 更新](http://www.windowsupdate.com)并确保两个 VS 环境都是最新的。

如果这没有帮助，请完全卸载它们，仅重新安装 2005，更新并测试它。如果 2005 没有崩溃，请安装 2008，更新并测试它们。在重新安装和测试两个版本的 VS 之前，请勿安装您可能一直在使用的任何附加组件。

如果其中一个确实崩溃了，您应该尝试[针对 Visual Studio 提交一个错误](http://blogs.msdn.com/astebner/articles/451329.aspx)。

如果它们没有崩溃，请安装您一次使用的任何附加组件，并在每个版本之后继续测试这两个版本。（这需要很长时间，但这就是必须的）当它们开始崩溃时，删除有问题的插件，并向插件开发人员提交错误。（请务必告诉他们您正在使用哪些其他附加组件，以防它仅在安装 2 个冲突附加组件时发生。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-16T02:20:40.697

我会高度考虑卸载然后再次安装 Visual Studio。然后确保你已经为你的 VS 版本安装了可用的服务包。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-16T02:22:49.133

*   它发生在所有项目还是特定项目上？
*   它仅在打开特定文件时发生吗？
*   尝试重新安装 Visual Studio 和任何/所有服务包。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-16T02:27:32.927

尝试重置 Visual Studio 设置（**工具->导入和导出设置->重置所有设置**）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-16T02:28:39.603

也许您可以尝试使用特定的解决方案和 csproject 文件重现此问题并将其报告给 Microsoft？

这是你能拍到的最好的一枪。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-09-16T02:20:32.163

另一种选择：

1.  学习10年成为真正优秀的程序员
2.  在 Visual Studio 团队中申请（并获得）Microsoft 的工作
3.  修复错误

# c - 为什么即使我们在 C 程序中不包含 stdio.h 也不会出现编译时错误？

> ID：68843
> 
> 赞同：6
> 
> 时间：2008-09-16T02:19:57.033
> 
> 标签：c, compiler-construction

当我一开始没有包含任何头文件时，编译器如何知道 sleep 函数甚至 printf 函数的原型？

此外，如果我指定`sleep(1,1,"xyz")`或任意数量的参数，编译器仍会编译它。但奇怪的是 gcc 能够在链接时找到这个函数的定义，我不明白这怎么可能，因为实际`sleep()`的函数只接受一个参数，但我们的程序提到了三个参数。

```
/********************************/
int main()
{
 short int i;
 for(i = 0; i<5; i++)
 {
    printf("%d",i);`print("code sample");`
    sleep(1);
 }
 return 0;
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-16T02:34:28.230

由于缺少更具体的原型，编译器将假定函数返回 int 并采用您提供的任何数量的参数。

根据 CPU 体系结构，参数可以在寄存器中传递（例如，MIPS 上的 a0 到 a3）或通过将它们压入堆栈，就像在原始 x86 调用约定中一样。在任何一种情况下，传递额外的参数都是无害的。被调用的函数不会使用传入的寄存器，也不会引用堆栈上的额外参数，但不会发生任何不好的事情。

传入更少的参数会更成问题。被调用的函数将使用恰好在适当的寄存器或堆栈位置中的任何垃圾，并且可能会出现问题。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-16T03:23:03.370

在经典 C 中，调用函数不需要原型。编译器将推断该函数返回一个 int 并采用未知数量的参数。这可能适用于某些体系结构，但如果函数返回非 int 的内容（如结构）或有任何参数转换，它将失败。

在您的示例中，可以看到 sleep 并且编译器假定一个原型

```
int sleep(); 
```

请注意，参数列表为空。在 C 中，这与 void 不同。这实际上意味着“未知”。如果您正在编写 K&R C 代码，您可能会通过代码获得未知参数，例如

```
int sleep(t)
int t;
{
   /* do something with t */
} 
```

这很危险，特别是在一些嵌入式芯片上，未原型函数的参数传递方式与原型函数不同。

注意：链接不需要原型。通常，链接器会自动与 Linux 上的 glibc 等 C 运行时库链接。您对 sleep 的使用与实现它的代码之间的关联发生在源代码处理很久之后的链接时间。

我建议您使用编译器的功能来要求原型以避免此类问题。对于 GCC，它是 -Wstrict-prototypes 命令行参数。在 CodeWarrior 工具中，它是 C/C++ 编译器面板中的“需要原型”标志。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-16T02:22:05.640

C 将猜测 int 的未知类型。所以，它可能认为 sleep 有这个原型：

```
int sleep(int); 
```

至于提供多个参数和链接......我不确定。这确实让我感到惊讶。如果这真的有效，那么在运行时发生了什么？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-16T12:31:34.457

其他答案涵盖了可能的机制（未指定编译器的所有猜测）。

您遇到的问题是您的编译器和链接器尚未设置为启用所有可能的错误和警告。对于任何新项目，（实际上）没有理由不这样做。 *为遗留项目提供更多借口——但应努力启用尽可能多的*

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-16T03:56:12.480

这与称为“K & R C”和“ANSI C”的东西有关。在良好的旧 K 和 RC 中，如果未声明某些内容，则假定为 int。因此，任何看起来像函数调用但未声明为函数的东西都会根据实际调用自动获取“int”的返回值和参数类型。

然而人们后来发现这有时会非常糟糕。所以几个编译器添加了警告。C++ 犯了这个错误。我认为 gcc 有一些标志（ -ansic 或 -pedantic? ），这使这种情况成为错误。

所以，简而言之，这是历史包袱。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-16T03:25:33.380

在非玩具示例中，另一个文件可能包含您错过的文件。查看预处理器的输出是查看最终编译结果的好方法。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-16T02:24:25.667

取决于编译器，但使用 gcc（例如，因为这是您提到的那个），一些标准（C 和 POSIX）函数具有内置的“编译器内在函数”。这意味着您的编译器附带的编译器库（在本例中为 libgcc）包含该函数的实现。编译器将允许隐式声明（即，使用不带标头的函数），并且链接器将在编译器库中找到实现，因为您可能将编译器用作链接器前端。

尝试使用“-c”标志编译您的对象（仅编译，无链接），然后使用链接器直接链接它们。你会发现你得到了你期望的链接器错误。

或者，gcc 支持禁用内部函数的选项：`-fno-builtin`或用于精细控制，`-fno-builtin-function`. 如果您正在执行诸如构建自制内核或某种其他类型的实体应用程序之类的操作，那么还有一些可能有用的选项。

# php - 我应该在哪里看到 FirePHP 输出？

> ID：68851
> 
> 赞同：4
> 
> 时间：2008-09-16T02:21:04.597
> 
> 标签：php, firebug, firephp

我正在尝试 FirePHP。

我安装了它并重新启动了 Firefox，为我的 localhost 启用了 Firebug，`oo.php`将下载附带的演示文件移动到 IIS 虚拟目录中，更改了包含路径，删除了`apache_request_headers()`调用，因为我正在运行 IIS，我看到的唯一输出是

> 注意：未定义的偏移量：1 在 C:\Documents and Settings\georgem\My Documents\projects\auctronic\FirePHPCore\FirePHP.class.php 在第 167 行
> Hello World

Firebug 控制台中不显示任何内容。

我错过了什么吗？

**编辑：** 注意到它说必须启用输出缓冲，所以我[`ob_start()`](http://php.net/manual/en/function.ob-start.php)在文件顶部添加了一个调用......结果相同。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-16T02:51:58.923

我相信 FirePHP 需要您安装一个 Firefox 扩展（除了 Firebug）来监视 HTTP 标头并将它们放在控制台中。

如果那不是问题，那么我建议您获取一份[Charles](http://www.charlesproxy.com/)的副本。它将让您查看 HTTP 响应的标头。FirePHP 输出应该在那里可见。如果不是，则问题出在您的服务器设置中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-16T22:59:44.930

确保您拥有最新版本的两个扩展，Firebug 和 FirePHP - 最近的 Firebug 和较旧的 FirePHP 出现了一些事故（是的，FirePHP 需要在服务器上包含 PHP 并在“狐狸”上安装扩展）。包括`fb.php`，做`ob_start()`，组成你自己的变量，然后

```
fb($myErrorVariable, 'My brand new error', FirePHP::ERROR); 
```

您应该在 Firebug 控制台和 Net 选项卡下都看到输出（将与您的脚本相关的第一行和选项卡扩展到“服务器”）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-30T10:50:42.530

I had the same issue and it turned out that the 'Net' tab of firebug wasn't enabled caused firephp to not show anything in the console. Enabled Net tab and voila!

# testing - Web 的自动国际化测试

> ID：68898
> 
> 赞同：0
> 
> 时间：2008-09-16T02:29:43.717
> 
> 标签：testing, internationalization

如果您的目标是国际友好，是否存在网站服务或脚本集可以告诉您您的网页是否配置错误？

更准确地说，我想知道是否存在这样的事情：

```
Checking URL: http://www.example.com
GET / HTTP/1.0
Accept-Charset: utf8
...

HTTP/1.0 200 OK
Charset: iso-8859-1
..<?xml version="1.0" charset="utf8" ?>

WARNING: Header document conflict, your server claims to return iso-8859-1, but
includes octet values outside the legal range.  This can happen when your documents
are saved with a different character set than your web server is configured to serve. 
```

据我了解，这不太可能帮助我创建一个允许人们用日语或希伯来语发帖的网站，但它可能能够帮助我的英语网站吸引更多的国际受众。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-09-16T02:31:45.680

我相信[W3C 验证器](http://validator.w3.org/)可以做到这一点，但可能不是您正在寻找的程度......

# time - 你如何衡量一个函数的执行时间？

> ID：68907
> 
> 赞同：4
> 
> 时间：2008-09-16T02:30:56.740
> 
> 标签：time, embedded, profiling

你如何衡量一个函数的执行时间？

这是一个相对较短的函数，执行时间可能在毫秒范围内。

这个特定的问题与使用 C 或 C++ 编程的嵌入式系统有关。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-16T02:36:25.263

在嵌入式系统上执行此操作的最佳方法是在您进入该功能时设置一个外部硬件引脚，并在您离开该功能时清除它。最好用一点汇编指令来完成，这样你就不会过多地扭曲你的结果。

编辑：好处之一是您可以在实际应用程序中执行此操作，并且不需要任何特殊的测试代码。像这样的外部调试引脚是（应该是！）每个嵌入式系统的标准做法。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-09-16T02:44:45.180

有三种可能的解决方案：

**硬件解决方案**：

使用处理器上的空闲输出引脚并将示波器或逻辑分析仪连接到该引脚。将引脚初始化为低电平状态，在调用要测量的函数之前，将引脚置为高电平状态，然后在从函数返回后，取消置位引脚。

```
 *io_pin = 1;
    myfunc();
    *io_pin = 0; 
```

**书虫解决方案**：

如果函数相当小，并且您可以管理反汇编代码，则可以打开处理器架构数据手册并计算处理器执行每条指令所需的周期。这将为您提供所需的周期数。
时间 = # 个周期 * 处理器时钟速率 / 每条指令的时钟滴答数

对于较小的功能或用汇编程序编写的代码（例如，对于 PIC 微控制器），这更容易做到

**时间戳计数器解决方案**：

一些处理器有一个时间戳计数器，它会快速递增（每隔几个处理器时钟滴答声）。只需读取函数前后的时间戳即可。这将为您提供经过的时间，但请注意您可能必须处理计数器翻转。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-16T02:33:51.197

在具有大量调用的循环中调用它，然后除以调用次数以获得平均时间。

所以：

```
// begin timing
for (int i = 0; i < 10000; i++) {
    invokeFunction();
}
// end time
// divide by 10000 to get actual time. 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-16T02:42:11.067

如果您使用的是 linux，您可以通过在命令行中键入来计时程序的运行时间：

```
time [funtion_name] 
```

如果您只运行 main() 中的函数（假设 C++），则应用程序的其余时间应该可以忽略不计。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-01T15:47:57.430

我多次重复函数调用（数百万次），但也使用以下方法来降低循环开销：

```
start = getTicks();

repeat n times {
    myFunction();
    myFunction();
}

lap = getTicks();

repeat n times {
    myFunction();
}

finish = getTicks();

// overhead + function + function
elapsed1 = lap - start;

// overhead + function
elapsed2 = finish - lap;

// overhead + function + function - overhead - function = function
ntimes = elapsed1 - elapsed2;

once = ntimes / n; // Average time it took for one function call, sans loop overhead 
```

而不是在第一个循环中调用 function() 两次，在第二个循环中调用一次，您可以在第一个循环中调用它一次，并且在第二个循环中根本不调用它（即空循环），但是空循环可以由编译器优化，给你负时序结果:)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-16T02:32:30.373

```
start_time = timer
function()
exec_time = timer - start_time 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-16T03:01:05.827

## Windows XP/NT Embedded 或 Windows CE/Mobile

您可以使用 QueryPerformanceCounter() 在函数之前和之后获取 VERY FAST 计数器的值。然后你减去那些 64 位值并得到一个增量“滴答声”。使用 QueryPerformanceCounterFrequency() 您可以将“增量刻度”转换为实际时间单位。您可以参考有关这些 WIN32 调用的 MSDN 文档。

## 其他嵌入式系统

如果没有操作系统或只有基本操作系统，您将不得不：

*   编程内部 CPU 定时器之一以自由运行和计数。
*   将其配置为在定时器溢出时产生中断，并在此中断例程中增加一个“进位”变量（这样您实际上可以测量比所选定时器的分辨率更长的时间）。
*   在您的函数之前，您保存“进位”值和 CPU 寄存器的值，该值保存您配置的计数计时器的运行滴答。
*   在你的函数之后相同
*   减去它们以获得增量计数器刻度。
*   从那里开始，只需知道在给定外部时钟和您在设置计时器时配置的去乘法的情况下，您的 CPU/硬件上的滴答声意味着多长时间。您将“刻度长度”乘以刚刚得到的“增量刻度”。

**非常重要**不要忘记在获取这些计时器值（进位和寄存器值）之前禁用并恢复中断，否则您可能会保存不正确的值。

**笔记**

*   这非常快，因为只需要几条汇编指令就可以禁用中断、保存两个整数值并重新启用中断。实际减法和转换为实时单位发生在时间测量区域之外，即在您的函数之后。
*   您可能希望将该代码放入一个函数中以重用该代码，但由于函数调用和将所有寄存器推入堆栈，加上参数，然后再次弹出它们，它可能会减慢速度。在嵌入式系统中，这可能很重要。在 C 中使用 MACROS 或编写自己的汇编例程仅保存/恢复相关寄存器可能会更好。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-16T03:27:17.433

取决于您的嵌入式平台和您正在寻找的时间类型。对于嵌入式 Linux，有几种方法可以完成。如果您希望测量函数使用的 CPU 时间量，可以执行以下操作：

```
#include <time.h>
#include <stdio.h>
#include <stdlib.h>

#define SEC_TO_NSEC(s) ((s) * 1000 * 1000 * 1000)

int work_function(int c) {
    // do some work here
    int i, j;
    int foo = 0;
    for (i = 0; i < 1000; i++) {
        for (j = 0; j < 1000; j++) {
            for ^= i + j;
        }
    }
}

int main(int argc, char *argv[]) {
    struct timespec pre;
    struct timespec post;
    clock_gettime(CLOCK_THREAD_CPUTIME_ID, &pre);
    work_function(0);
    clock_gettime(CLOCK_THREAD_CPUTIME_ID, &post);

    printf("time %d\n",
        (SEC_TO_NSEC(post.tv_sec) + post.tv_nsec) -
        (SEC_TO_NSEC(pre.tv_sec) + pre.tv_nsec));
    return 0;
} 
```

您需要将其与实时库链接，只需使用以下代码编译您的代码：

```
gcc -o test test.c -lrt 
```

您可能还想阅读有关`clock_gettime`在基于 SMP 的系统上运行此代码的一些问题的手册页，这可能会使您的测试无效。您可以使用类似的东西`sched_setaffinity()`或命令行`cpuset`来强制仅在一个核心上执行代码。

如果您正在寻找测量用户和系统时间，那么您可以使用`times(NULL)`which 返回类似 jiffies 的东西。或者您可以将参数`clock_gettime()`from更改`CLOCK_THREAD_CPUTIME_ID`为`CLOCK_MONOTONIC`...，但请注意使用`CLOCK_MONOTONIC`.

对于其他平台，您就靠自己了。

德鲁

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-10-01T15:28:38.240

我总是实现一个中断驱动的股票程序。然后这会更新一个计数器，该计数器计算自启动以来的毫秒数。然后使用 GetTickCount() 函数访问此计数器。

例子：

```
#define TICK_INTERVAL 1    // milliseconds between ticker interrupts
static unsigned long tickCounter;

interrupt ticker (void)  
{
    tickCounter += TICK_INTERVAL;
    ...
}

unsigned in GetTickCount(void)
{
    return tickCounter;
} 
```

在您的代码中，您将按如下方式对代码进行计时：

```
int function(void)
{
    unsigned long time = GetTickCount();

    do something ...

    printf("Time is %ld", GetTickCount() - ticks);
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-16T02:36:43.700

如果您正在寻找亚毫秒级的分辨率，请尝试其中一种计时方法。它们都会在至少几十或几百微秒内为您解决问题：

如果是嵌入式 Linux，请查看 Linux 计时器：

[http://linux.die.net/man/3/clock_gettime](http://linux.die.net/man/3/clock_gettime)

嵌入式 Java，看看 nanoTime()，虽然我不确定这是否在嵌入式版本中：

[http://java.sun.com/j2se/1.5.0/docs/api/java/lang/System.html#nanoTime()](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/System.html#nanoTime())

如果您想获得硬件柜台，请尝试 PAPI：

[http://icl.cs.utk.edu/papi/](http://icl.cs.utk.edu/papi/)

否则你总是可以去汇编程序。如果您需要一些帮助，您可以查看您的体系结构的 PAPI 源代码。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-09-16T02:37:23.527

在 OS X 终端（也可能是 Unix）中，使用“时间”：

```
time python function.py 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-09-16T02:39:15.630

如果代码是 .Net，请使用秒表类 (.net 2.0+) 而不是 DateTime.Now。DateTime.Now 更新不够准确，会给你带来疯狂的结果

# delphi - 如何修复 Nevrona Rave 中的无限打印循环错误

> ID：68929
> 
> 赞同：4
> 
> 时间：2008-09-16T02:34:38.310
> 
> 标签：delphi, infinite-loop, rave-reports

[Nevrona Designs 的](http://www.nevrona.com/) [Rave Reports](http://www.nevrona.com/Products/RaveReports/StandardEdition/tabid/66/Default.aspx)是一个供[Embarcadero 的](http://www.embarcadero.com/) [Delphi](http://www.codegear.com/products/delphi/win32) IDE 使用的报告引擎。

这就是我所说的 Rave Endless Loop 错误。在与 Delphi 2006 捆绑在一起的 Rave Reports 版本 6.5.0 (VCL10) 中，有一个臭名昭著的错误困扰着许多 Rave 报告开发人员。如果您有一个非空数据集，并且该数据集的数据行完全适合一个页面（也就是说，有零个寡妇行），那么在 PrintPreview 时，Rave 将陷入生成页面的无限循环。

此新闻组先前已在以下标题下报告过此问题：

1.  “错误：生成无限页”；雨果·海拉姆 20/9/2006 8:44PM
2.  “狂欢循环错误。请帮助”；托马斯·拉扎尔 2006 年 11 月 7 日晚上 7:35
3.  “循环整页数据？”；托尼·奇斯蒂安森 23/12/2004 下午 3:41
4.  另一投诉人对（3）的答复；奥利弗·皮切
5.  “无尽的 lopp 打印错误”；Richso 2004 年 9 月 11 日下午 4:44

在每个帖子中，Nevrona 都没有回应，也没有报告解决方案。

可能，相关新闻组 (nevrona.public.rave.reports.general) 也报告了该问题，即： 6\. “持续生成报告”；Jobard 20/11/2005 虽然我不清楚 (6) 是 Rave Endless 循环错误还是其他问题。这篇帖子确实得到了 Nevrona 的回复，但它更多地与多个区域有关（“使用多个区域时会出现问题，跨越分页符。”）而不是零寡妇的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-16T02:37:26.023

这与其说是真正的解决方案，不如说是一种变通方法。我首先在 Nevrona 新闻组上发布了这个解决方法（Group=nevrona.public.rave.developer.delphi.rave; Subject="你是否患有 Rave Endless Loop 错误？：解决方法已宣布。"; Date=13 /11/2006 下午 7:06)

所以这是我的解决方案。这与其说是一个好的长期解决方案，不如说是一种变通方法，我希望 Nevrona 在不久的将来会认真关注这个问题。

1.  给定您的特定报表布局，计算每页的最大行数。让我们说这是40。
2.  设置一个计数器来计算页面中的行数（而不是整个报告中的行数）。您可以通过事件脚本或 CalcTotal 组件来执行此操作。
3.  为主数据带定义一个 OnBeforePrint 脚本事件处理程序。
4.  在此事件处理程序中，当每页行数低于最大值一或两（在我们的示例中，这将是 38）时，将主数据带的 FinishNewPage 属性设置为 True。并在所有其他情况下将其设置为 False。这样做的效果是给每个页面一个非零数量的寡妇（在本例中为 1..38），从而避免了导致 Rave Endless 循环问题的条件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-23T23:47:29.283

非常感谢这个 Sean - 不幸的是，这对我不起作用，但我想出了另一个解决方案......你看我在区域顶部有一个备忘录，可能会根据用户有多少笔记而扩展或收缩留在数据库中。这意味着页面上可以容纳的行数会有所不同。然而。还有另一种解决方案 - 您使用数据带的 MaxHeightLeft 属性。您所做的就是测量数据带的高度，将其乘以 2，然后将其放入您的 MaxHeightLeft 属性中。如果它填满了那么多，这将强制 1 或 2 条记录进入下一页。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-12T16:36:18.733

非常感谢，这个线程帮助我解决了我在 Nevrona Rave 中无休止打印循环的问题......，我将 MinHeightLeft 设置为 0,500，这个设置是有效的，但我不确定它是否适用于我的其他结果集查询报告。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-06-22T12:48:48.693

大师，解决方案是 MinHeightLeft 到 0,500 ，我在 true 中使用属性 wastefit area 并在第二次打印中生成循环，但是当将属性 MinHeightLeft 更改为 0,500 时，错误消失了。

谢谢 ！

阿特·法比奥拉·埃雷拉。Fabi_ucv@hotmail.com

# algorithm - 给定一个无符号整数，获取设置位的“索引”的最快方法是什么？

> ID：68964
> 
> 赞同：3
> 
> 时间：2008-09-16T02:39:51.057
> 
> 标签：algorithm, bit-manipulation

因此，例如 0110 设置了位 1 和 2，1000 设置了位 3 1111 设置了位 0、1、2、3

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-16T02:51:53.370

如果真的只有 4 位，那么最快的方法肯定是使用查找表。毕竟只有 16 种不同的可能性。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-16T03:15:16.730

互联网上所有这些**小技巧**的最佳参考-[小技巧](http://graphics.stanford.edu/~seander/bithacks.html)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-16T02:42:17.353

我会将它向下移动并测试循环中的最低有效位。使用 32 位掩码（或 unsigned int 的任何长度）进行测试可能会更快。

/艾伦

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-16T02:48:34.640

```
for( int i = 0; variable ; ++i, variable >>= 1 ) {
  if( variable & 1 )
    // store bit index - i
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-16T13:39:51.627

If it was .NET and you'd have to use it a lot I would like a nice fluent interface.

I would create the following class (not totally happy with the name BitTools).

```
[Flags]
public enum Int32Bits
{
    // Lookup table but nicer
    None = 0,
    Bit1 = 1,        Bit2  = 1 << 1,  Bit3  = 1 << 2,  Bit4  = 1 << 3,  Bit5  = 1 << 4,  Bit6  = 1 << 5,  Bit7  = 1 << 6,  Bit8  = 1 << 7,
    Bit9  = 1 << 8,  Bit10 = 1 << 9,  Bit11 = 1 << 10, Bit12 = 1 << 11, Bit13 = 1 << 12, Bit14 = 1 << 13, Bit15 = 1 << 14, Bit16 = 1 << 15,
    Bit17 = 1 << 16, Bit18 = 1 << 17, Bit19 = 1 << 18, Bit20 = 1 << 19, Bit21 = 1 << 20, Bit22 = 1 << 21, Bit23 = 1 << 22, Bit24 = 1 << 23,
    Bit25 = 1 << 24, Bit26 = 1 << 25, Bit27 = 1 << 26, Bit28 = 1 << 27, Bit29 = 1 << 28, Bit30 = 1 << 29, Bit31 = 1 << 30, Bit32 = 1 << 31,
}

public static class BitTools
{
    public static Boolean IsSet(Int32 value, Int32Bits bitToCheck)
    {
        return ((Int32Bits)value & bitToCheck) == bitToCheck;
    }

    public static Boolean IsSet(UInt32 value, Int32Bits bitToCheck)
    {
        return ((Int32Bits)value & bitToCheck) == bitToCheck;
    }

    public static Boolean IsBitSet(this Int32 value, Int32Bits bitToCheck)
    {
        return ((Int32Bits)value & bitToCheck) == bitToCheck;
    }
    public static Boolean IsBitSet(this UInt32 value, Int32Bits bitToCheck)
    {
        return ((Int32Bits)value & bitToCheck) == bitToCheck;
    }
} 
```

And you could use it the following ways:

```
static void Main(string[] args)
{
    UInt32 testValue =  5557; //1010110110101;

    if (BitTools.IsSet(testValue, Int32Bits.Bit1))
    {
        Console.WriteLine("The first bit is set!");
    }
    if (testValue.IsBitSet(Int32Bits.Bit5))
    {
        Console.WriteLine("The fifth bit is set!");
    }
    if (!testValue.IsBitSet(Int32Bits.Bit2))
    {
        Console.WriteLine("The second bit is NOT set!");
    }
} 
```

For each (U)Int size you could make another Int*Bits enum and the correct overloads of IsSet and IsBitSet.

EDIT: I misread, you're talking about unsigned ints, but it's the same in this case.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-16T02:50:16.447

取决于你所说的最快是什么意思。

如果您的意思是“代码简单”，那么在 .NET 中，您可以使用 BitArray 类并将每个位称为布尔值 true/false。

[位数组类](http://msdn.microsoft.com/en-us/library/system.collections.bitarray.aspx)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-16T03:02:16.400

@艾伦风...

不需要额外的位移。不进行位移更有效，因为比较最低有效位与比较第二个最低有效位一样有效，依此类推。进行位移也只是将所需的位操作加倍。

```
firstbit = (x & 0x00000001) 
secondbit = (x & 0x00000002) 
thirdbit = (x & 0x00000004)   //<-- I'm not saying to store these values, just giving an example. 
... 
```

无论如何，x86 系统上的所有操作都是使用 32 位寄存器完成的，因此单个位比较与 32 位比较一样有效。

更不用说拥有循环本身的开销了。

问题可以在恒定数量的代码行中完成，无论代码是在 x86 还是 x64 上运行，我描述的方式更有效。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-16T06:57:35.587

您可以采用迭代 int 字节的混合方法，使用查找表来确定每个字节中设置位的索引（分成半字节）。然后您需要向索引添加偏移量以反映其在整数中的位置。

即假设您从 32 位 int 的 MSB 开始。我将上半字节索引称为upper_idxs，而将下半字节索引称为lower_idxs。然后需要给lower_idxs的每个元素加24，给upper_idxs的每个元素加28。下一个字节将被类似地处理，除了偏移量将分别为 16 和 20，因为该字节是 8 位“向下”。

对我来说，这种方法似乎是合理的，但我很乐意证明是错误的 :-)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-16T23:34:11.183

两步：

1.  提取每个设置位`set_bit= x & -x; x&= x - 1;`

2.  减 1 并计数设置的位数。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-06-21T07:55:00.143

我认为这会有所帮助

```
import java.util.*;
public class bitSet {

    public static void main(String[]args) {
        Scanner scnr = new Scanner(System.in);
        int x = scnr.nextInt();
        int i = 0;
        while (i<32) {
            if ( ((x>>i)&1) == 1) {
                System.out.println(i);
            }
            i++;
        }
    }
} 
```

# .net - 有人知道像程序构建 UI 框架这样的划痕吗？

> ID：68976
> 
> 赞同：1
> 
> 时间：2008-09-16T02:41:42.393
> 
> 标签：.net, mit-scratch

我非常喜欢从头开始的拖放式可插拔编程块（[http://scratch.mit.edu/](http://scratch.mit.edu/)）

我希望能够让用户使用相同的技术创建自己的迷你脚本......

只是想知道是否有人知道我可以在 .NET 中使用类似的东西？理想情况下在 WPF 中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-09T14:40:30.623

也许[Windows Workflow Foundation](http://msdn.microsoft.com/en-us/netframework/aa663328.aspx)适合您。您可以在自己的应用程序中[托管设计器。](http://msdn.microsoft.com/nl-be/library/cc835242(en-us).aspx)所以最终用户可以改变逻辑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-16T02:47:58.823

它不是 .NET，但你看过 Alice 吗？( [http://www.alice.org/](http://www.alice.org/) )

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-16T02:50:15.290

是的.....爱丽丝很有趣....但是从头开始就像爱丽丝，但更简单。我认为针对的是更年轻的年龄组。

但是 UI 非常适合简单的脚本编写

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-07-29T23:06:10.207

StarLogo TNG 可以工作，但它是为 3D 模拟而设计的。

# windows-mobile - windows mobile 开发入门

> ID：68985
> 
> 赞同：12
> 
> 时间：2008-09-16T02:44:24.150
> 
> 标签：windows-mobile

我有一个我想开始的个人宠物项目，针对 windows mobile 6。我从来没有做过 win mobile dev 并且想知道那里有什么资源，好用的工具，也许是一个快速入门教程，以及我在为平台开发时可能要记住的任何问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-16T16:24:30.170

Windows Mobile 6 设备在 ROM 中带有 .NET Compact Framework 2.0，并且还公开了用于许多事物（相机、系统通知、电子邮件、联系人等）的 .NET API。

我建议使用 Visual Studio 2008 和[Windows Mobile 6 SDK 的更新版本](http://www.microsoft.com/downloads/details.aspx?familyid=06111A3A-A651-4745-88EF-3D48091A390B&displaylang=en)，其中包括模拟器、文档、工具和示例。

除了 MSDN，一个很好的 Windows Mobile 示例资源是 Chris Craft 的博客，[他最近在 30 天内构建了 30 个移动应用程序](http://www.cjcraft.com/blog/CategoryView,category,30%2BDay%2Bof%2B.NET.aspx)。有许多不同技术的示例可用于快速启动。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-04T15:37:02.690

如果你有 C# 背景跳转到 windows mobile 开发是相当容易的。当然有很多不同，但你会得到它的窍门。

一些陷阱：

熟悉 .NET CF 内存管理以及垃圾收集器在移动设备上的工作原理。 [Steven Pratschner 的 .Net CF WebLog](http://blogs.msdn.com/stevenpr/archive/2004/07/26/197254.aspx)。Steve 也有很好的教程如何使用 RPM（远程性能管理器）工具来消除内存泄漏等。

还有一些事情是通过诸如 core.dll 之类的 pinvoking 库完成的，因此请浏览 [P/Invoke.net](http://www.pinvoke.net/)并查看 Smart Device Functions 下的方法。

最后几篇博客

[Rob Tiffany 的 Windows Mobile 加速器](http://blogs.msdn.com/robtiffany/default.aspx)

[Raffaele Limosani 的移动开发](http://blogs.msdn.com/raffael/default.aspx)

编辑：哦，似乎有类似的问题，答案很好@Windows [Mobile Development - 从哪里开始？](https://stackoverflow.com/questions/377604/windows-mobile-development-where-to-begin)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-16T03:01:00.290

根据项目的规模，看看 .NET 紧凑框架。如果您完全熟悉 Visual Studio，那么它很容易上手。当然，MSDN 是资源的地方。

在移动设备上运行托管代码确实会对性能造成很大影响，但对于小型个人项目来说，这已经相当不错了。

此外，大多数设备都有各种奇怪的怪癖以及奇怪的硬件配置。从您的设备制造商那里寻找任何类型的开发者计划。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-16T03:01:36.887

对于 Visual Studio，您可以下载随入门工具包和模拟器一起提供的 Windows Mobile SDK。您可以轻松快速地编写本机 C++ 或 .Net 应用程序。查看随 SDK 提供的示例以获得良好的切入点。这可能是最好的入门资源。我建议安装 SDK，然后运行一些示例来弄湿你的脚。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-16T03:03:52.043

从[Windows Mobile 开发人员中心](http://msdn.microsoft.com/en-us/windowsmobile/default.aspx)开始。在那里，您会找到一个很棒的入门部分，其中包含许多指向您需要的软件和教程的链接。Windows Mobile 开发非常有趣。:)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-16T16:40:32.520

Wigley、Moth 和 Foot 合着的“Microsoft Mobile Development Handbook”是一本很好的参考书。它涵盖了使用 .NET 紧凑框架以及 Windows Mobile 平台进行移动开发的许多主题。

您可能还想了解 Windows CE，这是 Windows Mobile 的一种。windowsembedded.com 是一个开始学习 Windows CE 的好地方。从那里您可以下载“Platform Builder”的评估版，它是创建 Windows CE 映像进行测试的工具。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-18T12:22:12.840

另一个很好的 Windows Mobile 开发代码示例和示例应用程序来源可以在[Chris Fairbairn 的博客](http://www.christec.co.nz/blog/)中找到。

# emacs - 如何让 Emacs 解包代码块？

> ID：68993
> 
> 赞同：4
> 
> 时间：2008-09-16T02:46:04.070
> 
> 标签：emacs

假设我在 emacs 缓冲区中有一行，如下所示：

```
foo -option1 value1 -option2 value2 -option3 value3 \
    -option4 value4 ... 
```

我希望它看起来像这样：

```
foo -option1 value1 \
    -option2 value2 \
    -option3 value3 \
    -option4 value4 \
    ... 
```

我希望每个选项/值对在单独的行上。我还希望那些后续行根据模式适当缩进，而不是添加固定数量的空白。我希望代码在当前块上工作，在第一个非空行或不包含选项/值对的行处停止，尽管我可以满足于它在选定区域上工作。

有人知道 elisp 函数可以做到这一点吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-16T20:48:20.800

没有人拥有我想要的东西，所以我决定把我的 elisp 手册上的灰尘擦掉，自己做。这似乎工作得很好，尽管输出并不完全符合我的要求。在这个版本中，第一个选项单独出现在一行，而不是像我原来的问题那样停留在第一行。

```
(defun tcl-multiline-options ()
  "spread option/value pairs across multiple lines with continuation characters"
  (interactive)
  (save-excursion
    (tcl-join-continuations)
    (beginning-of-line)
    (while (re-search-forward " -[^ ]+ +"  (line-end-position) t)
      (goto-char (match-beginning 0))
      (insert " \\\n")
      (goto-char (+(match-end 0) 3))
      (indent-according-to-mode)
      (forward-sexp))))

(defun tcl-join-continuations ()
  "join multiple continuation lines into a single physical line"
  (interactive)
  (while (progn (end-of-line) (char-equal (char-before) ?\\))
    (forward-line 1))
  (while (save-excursion (end-of-line 0) (char-equal (char-before) ?\\))
    (end-of-line 0)
    (delete-char -1)
    (delete-char 1)
    (fixup-whitespace))) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-16T02:54:04.160

在这种情况下，我会使用宏。您可以使用 Cx ( 开始录制宏，并使用 Cx 停止录制)。当你想重播宏类型 Cx e.

在这种情况下，我会输入 Ca Cx ( Cs value Cf Cf \ RET SPC SPC SPC SPC Cx )

这将记录一个搜索“值”的宏，向前移动 2，插入斜杠和换行符，最后将新行隔开以对齐。然后你可以重复这个宏几次。

编辑：我刚刚意识到，您的文字可能不像“value1”那样容易搜索。您还可以搜索空格并循环点击。例如，在第一场比赛后击中 Cs 几次以跳过一些比赛。

注意：由于您的示例是“临时”的，因此该解决方案也是如此。当您需要临时解决方案时，通常会使用宏。使宏应用更一致的一种方法是将原始语句全部放在一行上（也可以通过宏或手动完成）。

编辑：感谢您对 ( 与 C-( 的评论，您是对的，我的错误！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-16T03:26:28.247

就个人而言，我一直在做这样的事情。

但是我不会写一个函数来做这件事，除非我会每天都这样做一年。

您可以使用查询替换轻松完成，如下所示：

mx（查询替换“-option”“^Q^J -option”）

我说 ^Q^J 因为这是您将键入的内容来引用换行符并将其放入字符串中。

然后只需按“y”替换要替换的字符串，然后按“n”跳过你会发现的奇怪的角落案例。

另一个主力函数是 query-replace-regexp，它可以替换正则表达式。

还有 grep-query-replace，它将通过解析 grep 命令的输出来执行查询替换。这很有用，因为您可以在 100 个文件中搜索“foo”，然后在每次出现时执行查询替换，从一个文件跳到另一个文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-16T03:55:29.580

您的模式可能已经支持这一点。至少在 C 模式和 Makefile 模式下，Mq（填充段落）将在填充列中插入续行并换行。

你在什么模式下编辑这个？

# java - 如何通过 Socket 找到 HTTP 请求的响应时间

> ID：68999
> 
> 赞同：20
> 
> 时间：2008-09-16T02:46:46.283
> 
> 标签：java, http

我正在使用连接到服务器的 Java 套接字。如果我发送 HEADER http 请求，我如何测量服务器的响应时间？我必须使用提供的 java 计时器，还是有更简单的方法？

我正在寻找一个简短的答案，我不想使用其他协议等。显然我也不希望有一个将我的应用程序与特定操作系统联系起来的解决方案。请人们，仅限 IN-CODE 解决方案。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-09-21T08:08:10.983

`curl -s -w "%{time_total}\n" -o /dev/null http://server:3000`

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-09-16T03:44:09.577

我想说这取决于您尝试测量的确切时间间隔，从您发送的请求的最后一个字节到您收到的响应的第一个字节的时间量？或者直到收到整个回复？还是您只想测量服务器端时间？

如果您尝试仅测量服务器端处理时间，您将很难计算出请求到达和响应返回所花费的网络传输时间量。否则，由于您自己通过 Socket 管理请求，因此您可以通过检查系统计时器并计算差值来测量任意两个时刻之间经过的时间。例如：

```
public void sendHttpRequest(byte[] requestData, Socket connection) {
    long startTime = System.nanoTime();
    writeYourRequestData(connection.getOutputStream(), requestData);
    byte[] responseData = readYourResponseData(connection.getInputStream());
    long elapsedTime = System.nanoTime() - startTime;
    System.out.println("Total elapsed http request/response time in nanoseconds: " + elapsedTime);
} 
```

此代码将测量从您开始写出请求到完成接收响应的时间，并打印结果（假设您实现了特定的读/写方法）。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-09-16T03:11:13.557

您可以在命令行上使用 time 和 curl 和 time。curl 的 -I 参数指示它仅请求标头。

```
time curl -I 'http://server:3000' 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-09-16T03:38:21.353

这样的事情可能会奏效

```
import java.io.IOException;

import org.apache.commons.httpclient.HttpClient;
import org.apache.commons.httpclient.HttpMethod;
import org.apache.commons.httpclient.URIException;
import org.apache.commons.httpclient.methods.HeadMethod;
import org.apache.commons.lang.time.StopWatch;
//import org.apache.commons.lang3.time.StopWatch

public class Main {

    public static void main(String[] args) throws URIException {
        StopWatch watch = new StopWatch();
        HttpClient client = new HttpClient();
        HttpMethod method = new HeadMethod("http://stackoverflow.com/");

        try {
            watch.start();
            client.executeMethod(method);
        } catch (IOException e) {
            e.printStackTrace();
        } finally {
            watch.stop();
        }

        System.out.println(String.format("%s %s %d: %s", method.getName(), method.getURI(), method.getStatusCode(), watch.toString()));

    }
} 
```

```
HEAD http://stackoverflow.com/ 200: 0:00:00.404 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-16T03:41:14.483

也许我错过了一些东西，但你为什么不直接使用：

```
// open your connection
long start = System.currentTimeMillis();
// send request, wait for response (the simple socket calls are all blocking)
long end = System.currentTimeMillis();
System.out.println("Round trip response time = " + (end-start) + " millis"); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-16T04:54:13.200

使用 AOP 拦截对套接字的调用并测量响应时间。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-01-24T13:49:42.427

```
@Aspect
@Profile("performance")
@Component
public class MethodsExecutionPerformance {
    private final Logger logger = LoggerFactory.getLogger(getClass());

    @Pointcut("execution(* it.test.microservice.myService.service.*.*(..))")
    public void serviceMethods() {
    }

    @Around("serviceMethods()")
    public Object monitorPerformance(ProceedingJoinPoint proceedingJoinPoint) throws Throwable {
        StopWatch stopWatch = new StopWatch(getClass().getName());
        stopWatch.start();
        Object output = proceedingJoinPoint.proceed();
        stopWatch.stop();
        logger.info("Method execution time\n{}", stopWatch.prettyPrint());
        return output;
    }
} 
```

通过这种方式，您可以计算出您的服务的真实响应时间，而与网络速度无关。******