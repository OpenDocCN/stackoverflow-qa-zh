# StackOverflow 问答 000358000-000358999

# c - Linux C 库中的 SetFileLength() 等函数

> ID：358003
> 
> 赞同：0
> 
> 时间：2008-12-10T23:30:41.417
> 
> 标签：c, linux, file, io, std

Linux下的C库中是否有可以设置文件长度的函数？在 Windows 下，我知道有一个 SetFileLength() 函数。如果没有，在不删除和重写文件的情况下缩短文件的最佳方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-10T23:33:03.003

您可以使用[截断功能](http://homepages.cwi.nl/~aeb/linux/man2html/man2/truncate.2.html)。

`int truncate(const char *path, off_t length);`

从手册页：

“truncate() 和 ftruncate() 函数导致由 path 命名或由 fd 引用的常规文件被截断为精确长度字节的大小。如果文件先前大于此大小，则额外的数据将丢失。如果以前的文件更短，它被扩展，扩展部分读取为空字节”

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-10T23:33:17.853

```
 #include <unistd.h>
   #include <sys/types.h>

   int truncate(const char *path, off_t length);
   int ftruncate(int fd, off_t length); 
```

从它的手册页：

> truncate() 和 ftruncate() 函数导致由 path 命名或由 fd 引用的常规文件被截断为精确长度字节的大小。
> 
> 如果文件以前大于此大小，则多余的数据将丢失。如果文件先前较短，则将其扩展，扩展部分读取为空字节 ('\0')。

# oracle - 将 JDBCRealm 从 tomcat 移植到 OC4J

> ID：358004
> 
> 赞同：0
> 
> 时间：2008-12-10T23:30:56.860
> 
> 标签：oracle, authentication, tomcat, authorization, oc4j

我正在将 servlet 从 移植`Tomcat 5.5`到`OC4J 10.1.3.1`.

在Tomcat中我们设置了一个`JDBCRealm`用于认证和授权。这是通过`$TOMCAT_HOME/conf/server.xml`.

有没有类似的机制`OC4J`？我从哪里开始寻找它？我如何定义它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-13T18:40:05.903

是的，OC4J 中也有类似的机制。[DBTableOraDataSourceLoginModule](http://download.oracle.com/docs/cd/B31017_01/web.1013/b28957/loginmod.htm#BABCDDAI)是OC4J 附带的登录模块。

# javascript - 将 WCF 服务与 ScriptService 一起使用时在 javascript 中实例化 DataContract

> ID：358011
> 
> 赞同：0
> 
> 时间：2008-12-10T23:35:30.690
> 
> 标签：javascript, wcf

我有一个使用 .svc 公开的简单 WCF 服务。该服务有一些与 ServiceContracts 一起使用的相关 DataContract 类。当调用获取一些数据的方法时，返回的 json 具有您所期望的所有属性。

我的问题是如何在 javascript 中获取这些 DataContract 对象之一的新实例。

```
<asp:ScriptManager ID="ScriptManager1" runat="server">
  <Services>
    <asp:ServiceReference 
      Path="./Service1.svc" />
  </Services>
</asp:ScriptManager>

<script>
// what I'd like to be able to do in javascript
var myInstance = new MyNamespace.MyDataContractClassName();
myInstance.someProperty = "Prop Value";
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-12T03:19:05.137

如果您浏览到 ./Service1.svc/js，您可以看到服务器生成的确切客户端代理脚本。

在这个文件的末尾，你应该看到将你的数据协定类型注册为客户端类型的行——这只是使它们在客户端类型系统中可用，并允许你调用一个众所周知的构造函数，但它实际上并没有编码它们的属性，因为您可以在 JavaScript 中的任何对象上设置任意属性。

因此，您实际编写的代码是正确的，假设命名空间和类声明与代理代码中的内容相匹配，但您可以自己验证。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-12T16:45:45.420

谢谢@Sam，我希望有一种方法可以创建所有属性，以便当我执行 new MyDataContractClassname(); 我可以有一个很好的完整对象，我可以传递并且不必测试属性的存在等等 - 只需将它视为我从返回 DataContract 的服务中获得的对象。如果说我有一个方法可以向用户显示该对象的内容，有时它会显示一个新的，有时会显示来自服务的一个，那么假设所有属性都在那里就好了，就像你想的那样实例化一个手写的“类”

# c# - 停止箭头键滚动 TabControl C# Winform 上的选项卡

> ID：358025
> 
> 赞同：2
> 
> 时间：2008-12-10T23:42:12.593
> 
> 标签：c#, winforms, tabcontrol

我需要防止箭头键滚动浏览我的各个选项卡。有人知道这样做的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-11T21:59:53.267

我用下面的代码解决了这个问题

```
string tempstring = e.KeyValue.ToString();
if (tempstring == "37" || tempstring == "38" || tempstring == "39" || tempstring == "40")
{
     e.Handled = true;
} 
```

我将它放在 tabControl1_KeyDown(object sender, KeyEventArgs e) 方法中。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2008-12-10T23:46:15.393

我认为您可以为该控件捕获事件“KeyPress”

然后在你的把手上

```
System::Windows::Forms::KeyPressEventArgs^  e 
```

然后你检查

```
if (e->KeyChar == [find the number representing the arrow key])
  e->Handled = true; // Meaning that no one will receive it afterwards 
```

# c# - 在 C# 中，我如何监听已经打开的 COM（串行）端口？

> ID：358037
> 
> 赞同：10
> 
> 时间：2008-12-10T23:51:09.270
> 
> 标签：c#, serial-port, listener, sniffing

我正在使用一个与我的 COMM 端口对话的程序，但我已经制作了另一个程序，我想“嗅探”通信端口消息并对这些消息执行它自己的操作。这在 .NET c# 中可行吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-11T01:08:54.073

有第三方库/工具/产品可以公开您感兴趣的流量。

这是我用于串行端口仿真的一个 - 但我认为它提供了一些你可以使用的东西： http: [//com0com.sourceforge.net/](http://com0com.sourceforge.net/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-11T07:38:43.723

如果您可以控制与您的 COMM 端口通信的第一个程序，为什么不更改程序以通过远程处理或任何其他类型的 IPC 将从端口接收的数据传递给您的第二个程序。如果您可以编写一个连接到 COMM 端口的代理程序，并让其他程序中的 2 个与该代理通信以完成通信，那就更好了。

另一个想法是，如果你只需要嗅探传入的数据，你可以得到一根 Y 型电缆（分路器）并连接到 2 个 COMM 端口，每个程序连接到每个 COMM 端口。但是您需要确保第二个程序没有尝试传输。在某些情况下，您可能需要一个仅连接第二个输出的 RX 引脚的分离器。如果您需要图表，请告诉我。

如果您没有 2 个 COMM，您可以轻松获得一个不到 10 美元的 USB-Serial 转换器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-10T23:56:49.727

可以从串口嗅探流量

但是似乎没有“COMPortSniffer”控件

[此处](http://technet.microsoft.com/en-us/sysinternals/bb896644.aspx)介绍了 sysinternals 使用的有效技术

它似乎依赖于 Win32 编程但是，我不认为这样的事情可以直接用 C#

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-09-03T08:10:02.597

代码项目（[http://www.codeproject.com/Articles/75770/Basic-serial-port-listening-application](http://www.codeproject.com/Articles/75770/Basic-serial-port-listening-application)）有一个很好的教程。

它显示了如何读取来自串行端口的数据，并且您应该能够从中读取数据。

一个简短的片段：

```
void _serialPort_DataReceived(object sender, SerialDataReceivedEventArgs e)
{
    int dataLength = _serialPort.BytesToRead;
    byte[] data = new byte[dataLength];
    int nbrDataRead = _serialPort.Read(data, 0, dataLength);
    if (nbrDataRead == 0)
        return;

    // Send data to whom ever interested
    if (NewSerialDataRecieved != null)
        NewSerialDataRecieved(this, new SerialDataEventArgs(data));
} 
```

# xml - 是否有使用 XML 进行无开销对象序列化的模式？

> ID：358038
> 
> 赞同：1
> 
> 时间：2008-12-10T23:52:19.983
> 
> 标签：xml, json, object-persistence

就像你可以在 javascript 中使用 JSON 一样？至少静态属性？

或者甚至可能用于哈希表流？

希望找到类似的东西是否过于简单化

Object.Serialize(stream) 其中流是一个文件，可以通过您选择的其他可能的候选目标覆盖，使用一些默认格式，比如 XML？

使用 Object obj = stream.Deserialize() ...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-04T10:40:40.663

Java从 1.4 开始使用[XMLEncoder](http://java.sun.com/products/jfc/tsc/articles/persistence4/)支持这一点。格式非常紧凑，并且 XMLEncoder 允许覆盖特定对象类的序列化，因此您可以在适合的地方使用默认值，并在其他地方做任何您想做的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-26T20:19:37.220

我建议您查看[XStream for .Net](http://code.google.com/p/xstream-dot-net/)。我没有使用过那个变体，但发现原始的 XStream 在 Java 中使用起来非常简单。

# ruby-on-rails - Array(x) 是哪种ruby方法调用

> ID：358039
> 
> 赞同：4
> 
> 时间：2008-12-10T23:53:31.883
> 
> 标签：ruby-on-rails, ruby, arrays

是什么意思，以及以下语法的 Ruby 文档在哪里：

```
Array(phrases) 
```

我发现在这里浏览 Rails 源代码：

```
# File actionpack/lib/action_view/helpers/text_helper.rb, line 109
...
119:           match = Array(phrases).map { |p| Regexp.escape(p) }.join('|') 
```

我认为 Array.new 通常会用于创建一个数组，所以这里肯定会发生一些不同的事情。顺便说一句，从这段代码的上下文来看，`phrases`变量可以是字符串或字符串数​​组。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-12-11T00:13:25.153

这很可能是该`Kernel#Array`方法，请参见[此处](http://www.ruby-doc.org/core/classes/Kernel.html#M005989)。`Array.new`它与;略有不同 它更像是一个数组。（它尝试`to_ary`和`to_a`。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-11T00:17:59.277

Array(x) 的行为似乎与 x.to_a 完全相同。

@Brian 是对的-这是内核的一种方法。镐 说：

**数组（arg）-> 一个数组**

返回 arg .to_a。

```
Array(1..5)  » [1, 2, 3, 4, 5] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-23T09:32:09.323

[`Kernel#Array`](http://www.ruby-doc.org/core-1.9.3/Kernel.html#M005989)正如其他人已经说过的那样，这是方法。

但是 Ruby 文档并没有对这种方法在简化代码方面的作用给予肯定。它也没有告诉您没有 a`to_ary`或`to_a`方法的对象被封装在数组中。

```
Array([1,2,3])        -> [1,2,3]
Array(1..3)           -> [1,2,3]
Array({ a: 1, b: 2 }) -> [[:a, 1],[:b,2]]
Array("Hello World")  -> ["Hello World"]
Array(1)              -> [1] 
```

所有这些功能都`Kernel#Array`允许您在一行中处理带有参数的典型极端情况。

看这段代码，这是很多 API 或 DSL 中的典型情况：

```
# data can be nil, a single value or an array
def handle(data)
  data ||= Array.new   #Case 1: Data is nil
  data = [data] unless data.is_a?(Array)   #Case 2: Data is a single value
  data.each { |d| ... }
end 
```

这可以通过使用来简化`Kernel#Array`：

```
def handle(data)
  Array(data).each { |d| ... }
end 
```

当然，必须小心为`data`参数提供不同的类型，因为`to_ary`/`to_a`方法可能会或可能不会给您所期望的。

# java - Java 更改和移动非标准 XML 文件

> ID：358048
> 
> 赞同：2
> 
> 时间：2008-12-10T23:57:40.643
> 
> 标签：java, xml, dom, parsing

我正在使用第三方应用程序并想更改其中一个文件。该文件以 XML 格式存储，但文档类型无效。

当我尝试阅读使用它时出错，因为文档类型包含“file:///ReportWiz.dtd”（如图所示，带引号）并且我得到了一个找不到文件的异常。有没有办法告诉 docbuilder 忽略这一点？我已尝试将 DocumentBuilderFactory 的 setValidate 设置为 false 并将 setNamespaceAware 设置为 false。

我能想到的唯一解决方案是

*   将文件逐行复制到一个新文件中，省略有问题的行，做我需要做的事情，然后复制到另一个新文件中并将有问题的行重新插入，或者
*   上面做的基本相同，但使用某种 FileStream （虽然我不清楚我怎么能做到这一点..帮助？）

```
DocumentBuilderFactory docFactory = DocumentBuilderFactory
                    .newInstance();
docFactory.setValidating(false);
DocumentBuilder docBuilder = docFactory.newDocumentBuilder();
文档 doc = docBuilder.parse(file);
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-11T00:34:54.250

告诉您的 DocumentBuilderFactory 忽略 DTD 声明，如下所示：

```
docFactory.setFeature("http://apache.org/xml/features/nonvalidating/load-external-dtd", false); 
```

有关可用功能的列表，请参见[此处](http://xerces.apache.org/xerces2-j/features.html)。

您可能还会发现 JDOM 比 org.w3c.dom 更容易使用：

```
org.jdom.input.SAXBuilder builder = new SAXBuilder();
builder.setFeature("http://apache.org/xml/features/nonvalidating/load-external-dtd", false);
org.jdom.Document doc = builder.build(file); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-11T00:29:47.600

手动处理 DTD 的解析，方法是返回 DTD 文件的副本（从类路径加载）或返回一个空文件。您可以通过在文档构建器上设置实体解析器来做到这一点：

```
 EntityResolver er = new EntityResolver() {
        @Override
        public InputSource resolveEntity(String publicId, String systemId)
                throws SAXException, IOException {
            if ("file:///ReportWiz.dtd".equals(systemId)) {
                System.out.println(systemId);
                InputStream zeroData = new ByteArrayInputStream(new byte[0]);
                return new InputSource(zeroData);
            }
            return null;
        }
    }; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-11T00:07:08.440

我的第一个想法是把它当作一个流来处理。您可以在某个级别创建一个新适配器，然后将输入复制到输出，但有问题的文本除外。

如果文件很短（大约不到半个演出），您还可以将整个内容读入一个字节数组并在那里进行修改，然后从字节数组创建一个新流到您的构建器中。

这就是 Java 处理流的惊人的庞大方式的优势，您实际上有很大的灵活性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-11T00:08:00.297

我正在争论的另一件事是将所有文件存储在一个字符串中，然后进行操作并将字符串连接到一个文件。这些看起来都不干净或容易，但是最好的方法是什么？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-07-07T17:10:53.280

如果您不想假设解析器是 xerces，并且想要通用解决方案，请参阅[此](http://www.jroller.com/santhosh/entry/putoff_dtd_parsing_html)

# c# - C# ANTLR 语法？

> ID：358052
> 
> 赞同：11
> 
> 时间：2008-12-11T00:00:20.203
> 
> 标签：c#, antlr

我正在寻找 C# 的交钥匙[ANTLR](http://www.antlr.org/)语法，它生成可用的抽象语法树 (AST)，并且与后端语言无关或以 C#、C、C++ 或 D 为目标。

它不需要支持错误报告。

PS 我不愿意做任何修复，因为替代方案不是很难。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-12-07T00:11:21.330

这可能为时已晚，但您可以获得[C# 4 语法](http://www.antlr3.org/grammar/list.html)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-11T15:26:37.553

这是[C# 语法](http://www.antlr.org/grammar/1151612545460/CSharpParser.g)链接，以及[C# 和 ANTLR](http://www.manuelabadia.com/blog/PermaLink,guid,ff1dc504-f854-40b4-bfe7-250ce91efad7.aspx)的概述。[您在此处](http://www.antlr.org/grammar/list)提到的其他语言还有其他语言。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-08-27T03:42:57.553

[DMS Software Reengineering Toolkit](http://www.semanticdesigns.com/Products/DMS/DMSToolkit.html)为 C# 1.2、2.0 和 3.0 提供了一个完整的、经过验证的语法以及泛型和 LINQ 表达式。

它自动构建 AST，允许您以编程方式访问 AST 以进行分析或转换，或者您可以应用也直接操作树的源到源转换。生成的 AST 可以漂亮地打印回源代码，甚至保留缩进和注释。

DMS 还拥有成熟的前端，适用于 Java、PHP5、JavaScript、COBOL、C 和 C++ 等其他语言。

编辑：2010 年 1 月 31 日：DMS C# 解析器已扩展为处理完整的 C# 4.0。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-02-02T07:47:48.767

[您可以在官方语法存储库](https://github.com/antlr/grammars-v4/tree/master/csharp)中找到 C#6 ANTLR 语法。

# sql-server-2005 - 使用 SQL Server 开发人员版

> ID：358069
> 
> 赞同：2
> 
> 时间：2008-12-11T00:09:16.020
> 
> 标签：sql-server-2005, development-environment

我刚购买了 Visual Studio 2008 Professional，它附带 SQL Server 2005 开发人员版。我在工作中习惯使用 SQL Server 2005，但是开发者版似乎没有附带 Server Management Studio，所以我有点茫然。几个问题：

1.  有哪些资源可用于配置和设置 SQL Server 2005 Developer Edition？
2.  管理数据库有哪些资源（我知道我可以使用 SQL Server 2005 拥有多个数据库），以及 Developer Edition 提供了哪些“附加功能”？
3.  如果我要创建数据库并将其从 Developer Edition 移动到实际的部署服务器，是否需要了解一些有趣的事情？
4.  还有其他“陷阱”吗？

* * *

编辑：我已经回答了下面的“为什么没有显示 SQL Server Management Studio”的问题。其他问题的资源仍然值得赞赏。

还有其他见解吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-11T00:20:07.697

好的，如果您实际上在 SQL2005 上拥有完整的 Developer 版本，它确实具有 SSMS，您只是没有在安装中选择该选项。

更有可能的是您安装了不包含 SSMS 的 SQL 2005 Express Edition

（SSMS = SQL Server 管理工作室）

要管理您的 SQL 实例，您应该从这里下载 SQL Server Management Studio Express [http://www.microsoft.com/downloads/details.aspx?FamilyId=C243A5AE-4BD1-4E3D-94B8-5A0F62BF7796&displaylang=en](http://www.microsoft.com/downloads/details.aspx?FamilyId=C243A5AE-4BD1-4E3D-94B8-5A0F62BF7796&displaylang=en)

请记住，Express 使用实例名称安装，因此默认情况下您的服务器实际上是 MACHINENAME\SqlExpress。

SQLExpress 数据库与常规 SQL Server 完全相同 - 数据库引擎在运行 Express 时有限制。

祝你好运。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-11T00:20:29.740

它确实带有 SSMS 和 BIDS，但默认情况下可能不会安装它们。重新运行安装程序并确保安装了“工作站”（IIRC）位。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-11T00:57:26.810

事实证明，在也有 Express Edition 的系统上安装 SQL Server 2005 Developer Edition 需要用户从命令行运行安装程序，如下所示：

`D:\SQL Server x86\Servers\setup.exe -SKUUPGRADE=1`

然而，其他问题仍有待回答。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-11T15:53:10.340

Developer Edition 包含 Enterprise 拥有的所有功能（或至少大部分功能）。如果您没有意识到，这可能会很糟糕。

我的一些前辈完成了一个很好的项目，该项目需要使用分区表来大大加快我们吱吱作响的数据库。它很有魅力。在部署前几周，有人指出只有企业版支持分区表。他们不得不向首席财务官和首席执行官索要约 16,000 英镑的额外许可费用。

# javascript - 如何检测页面高度何时发生变化？

> ID：358072
> 
> 赞同：11
> 
> 时间：2008-12-11T00:11:16.310
> 
> 标签：javascript, html, css

我有一个 javascript 繁重的应用程序，其中包含自动完成下拉列表和选项卡等小部件。有时，当下拉菜单出现和消失时，或者当您在选项卡之间切换时，它会改变文档的高度。如果滚动条快速出现和消失，这可能会导致烦恼，因为它会移动页面。我想检测页面何时更改其高度，因此我可以将高度固定为目前为止的最大值，这样如果滚动条出现，它不会在一秒钟后消失。有什么建议么？

*更新：onresize 不起作用，因为那是为了改变视口/窗口的大小——我想要改变文档的长度。我不知道 watch 功能，看起来它至少适用于 FF，但 IE 不支持它。*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-01-15T07:55:23.030

我相信这个问题已经在stackoverflow上得到了回答： [检测文档高度变化](https://stackoverflow.com/questions/14866775/detect-document-height-change)

基本上，您必须存储当前文档高度并通过超时调用继续检查更改

这里要注意的元素是 document.body.clientHeight （或在 jquery $(document).height() 中）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-11T00:13:07.557

我认为您可以捕获“onresize”事件

[这是 w3schools.com 描述的链接](http://www.w3schools.com/jsref/jsref_onresize.asp)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-12-11T01:15:45.027

One idea would be to use the watch() method on the clientHeight property:

```
document.body.watch("clientHeight", function(property, oldHeight, newHeight) {
  // what you want to do when the height changes
}); 
```

The function you specify will get executed whenever the specified property changes. At any point you can use the unwatch() method to get it to stop.

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2015-03-11T10:51:23.310

您可以使用 jquery 用户调整大小事件来捕获窗口大小的变化，如下所示：

```
$(window).resize(function(){
   // your code to check sizes and take action
  }
); 
```

或者，您可以跟踪文档中的更改（未测试）

```
$(document).resize(function(){
   // your code to check sizes and take action
  }
); 
```

# c# - 将null转换为对象？

> ID：358079
> 
> 赞同：26
> 
> 时间：2008-12-11T00:13:54.700
> 
> 标签：c#, class, syntax, casting, null

我今天遇到了这段代码

```
AsyncInvoke(OnTimeMessageTimer, (object)null, (ElapsedEventArgs)null); 
```

有什么问题吗？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2008-12-11T00:17:06.143

有时，当方法重载时，您需要这样做......告诉编译器您正在调用哪个。一个 null 对象仍然是 null 并且它是安全的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-11T00:16:17.860

它可能需要强制转换来解决重载

# vb.net - VB.NET创建类，什么是Public Class MyClass(Of Type)？

> ID：358091
> 
> 赞同：0
> 
> 时间：2008-12-11T00:21:14.590
> 
> 标签：vb.net, inheritance, interface

我还在学习 ASP.NET，我经常在我们框架的各个部分看到这样的代码：

```
Public MustInherit Class DBFileManager(Of F As IDBFile, FC As IDBFileContent, FT As IDBFileThumb) 
```

谁能告诉我这是什么意思？非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-11T00:33:37.717

它是通用的。这意味着可以创建一个 DBFileManager，它作用于实现 3 个命名接口的 3 个类

有关详细信息，请参阅[http://msdn.microsoft.com/en-us/library/w256ka79(VS.80).aspx](http://msdn.microsoft.com/en-us/library/w256ka79(VS.80).aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-11T00:42:31.770

建立在@Jimmy 所说的基础上：它也是一个抽象类，这意味着它充当基类 - 你不能直接使用它，你必须对其进行子类化才能使用。该子类必须实现类头中的 3 种类型。

# sql - SQL CASE 语句

> ID：358092
> 
> 赞同：0
> 
> 时间：2008-12-11T00:21:39.940
> 
> 标签：sql, sql-server, sql-server-2000, case-statement

在 SQL Server 2000 中是否可以执行以下操作？

```
CREATE FUNCTION getItemType  (@code varchar(18))
RETURNS int
AS
BEGIN
Declare @Type tinyint
Select @Type = case len(@code)
WHEN 12,14,17 THEN 1
WHEN 13,15,18 THEN 2
WHEN 8,10 THEN 3
ELSE  0
END
RETURN (@Type)
END 
```

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-11T00:31:53.010

这应该这样做：

```
CREATE FUNCTION getItemType(@code VARCHAR(18))
RETURNS INT
AS
BEGIN
    RETURN CASE 
        WHEN LEN(@code) IN (12,14,17) THEN 1
        WHEN LEN(@code) IN (13,15,18) THEN 2
        WHEN LEN(@code) IN (8,100)    THEN 3
        ELSE  0
    END
END 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-11T00:28:46.743

试试这个：

```
Select @Type = 
(select case 
WHEN len(@code) IN (12,14,17) THEN 1
WHEN len(@code) IN (13,15,18) THEN 2
WHEN len(@code) IN (8,10) THEN 3
ELSE  0
END) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-11T00:25:03.320

```
 try  
  SELECT CASE
           WHEN LEN(@gcode) IN(x, y, z) THEN a  
         END
 etc. 
```

或者你可能需要

```
SELECT CASE LEN(@gcode)  
         WHEN x THEN a  
         WHEN y THEN a  
       END 
```

等等

[这是参考。](http://msdn.microsoft.com/en-us/library/ms181765.aspx)

# apache - 如何使用 VisualSVN 服务器绑定到一个 IP 地址？

> ID：358095
> 
> 赞同：1
> 
> 时间：2008-12-11T00:24:10.670
> 
> 标签：apache, svn, visualsvn-server

我已经在我的 Windows Server 2008 上安装了 VisualSVN。我在这台服务器上有多个 IP 地址，但我希望 VisualSVN 只绑定到其中一个。默认情况下，它绑定到所有可用地址。如何让 VisualSVN 只处理一个 IP 地址上的请求？

我尝试添加

```
BindAddress xxx.xxx.xxx.xxx 
```

到 httpd-custom.conf 并重新启动服务，但这似乎不起作用。

我对 httpd.conf 进行了同样的尝试，但也没有用。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-21T20:14:37.137

澄清一下，将 VisualSVN 绑定到明确定义的 IP 地址的方法是：

1.  加载**VisualSVN 服务器管理器**MMC 管理单元
2.  在左窗格中，右键单击**VisualSVN 服务器**项并从上下文菜单中选择**属性**
3.  单击**网络**选项卡
4.  在**服务器绑定**组中，选择**这些 IP 地址的单选按钮**
5.  对于您要指定的每个 IP 地址：单击**添加...**按钮
6.  在文本框中输入 IP 地址，然后单击**确定**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-11T00:50:16.403

我找到了一个简单的方法！我刚刚升级到 VisualSVN 1.6。然后，在管理控制台中，右键单击 VisualSVN 服务器节点，选择网络选项卡，然后输入您的 IP 地址。凉爽的！

# internet-explorer - 当您在 HTML 表单中选择一个不存在的文件进行上传时会发生什么？

> ID：358120
> 
> 赞同：2
> 
> 时间：2008-12-11T00:38:34.557
> 
> 标签：internet-explorer, error-handling, upload, fckeditor

在 Internet Explorer 上，标准 HTML 文件上传表单还允许直接输入文件名（而不是使用文件选择器对话框）。这使得输入不存在的文件成为可能。在其他浏览器（不允许您这样做）上，我想如果您在选择文件后删除文件，这种情况仍然会发生。

为了处理由这个问题引起的错误（比如[这个](http://dev.fckeditor.net/ticket/2716)），我需要在服务器端添加一些验证代码（这只有在请求实际发送到服务器时才有可能，对此我不确定点），或者在客户端（这不是很简单，因为您无法从 JavaScript 沙箱访问实际文件）。除此之外，唯一（并且可能是最好的）选项似乎是使用 CSS 魔法隐藏输入框，就像 GMail 对附件文件所做的那样。

那么，当您尝试上传不存在的文件时会发生什么？是否仍有 POST 请求正在发送？或者浏览器会中止，如果中止，我如何检测到它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-12T05:12:47.887

我想我想通了。

首先，似乎只是文件不存在，或者整个路径不正确，这似乎有所不同。如果只有文件丢失，显然 POST 确实发生了。

至少在我提到的情况下（FCKEditor 在 WinXP 和 IE6 上的图像上传对话框），浏览器根本不提交表单（因此没有什么可以在服务器端完成）。

可以在客户端检测到问题，方法是不使用正常的表单提交，而是使用 onSubmit 处理程序来停止提交（返回 false），而是使用 form.submit() 提交表单本身。如果文件丢失，则会出现异常。

```
try{
   form.submit();
}
catch (e){
// show some error message
}
return false; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-11T02:01:41.500

非常好的问题，在 .net 中有 Request.IsClientConnected，但不知道在这种情况下这是否对您有用，或者您是否首先使用 .net。

我会尝试通过客户端的 Fiddler 和服务器端的 WireShark 运行它，看看你是否通过查看流量模式获得任何见解。然后，您可能能够弄清楚如何检测到这一点。

有兴趣看看你想出什么。抱歉无法给出更好的答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-11T02:06:46.407

该帖子发生了，但至少在 .Net 中，System.Web.UI.WebControls.FileUpload 控件有一个 HasFile 属性，该属性将为 False（我试图上传 c:\tmp\foo.pdf）。在处理之前检查该属性将防止因丢失文件而引起的任何错误。

# java - Java bytecode specification

> ID：358121
> 
> 赞同：35
> 
> 时间：2008-12-11T00:39:20.840
> 
> 标签：java, jvm, bytecode

Is there a nice place for learning the JVM bytecode instruction set. The specification perhaps and maybe some tutorials?

I ask because I would like to design a toy language and a compiler for it that generates JVM bytecode.

Thanks for your knowledge and perhaps googling.

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-12-11T00:41:50.260

A good reference for Java bytecode specification is the [The Java Virtual Machine Specification](https://docs.oracle.com/javase/specs/jvms/se8/html/).

See [Chapter 4\. The class File Format](https://docs.oracle.com/javase/specs/jvms/se8/html/jvms-4.html) and [Chapter 6\. The Java Virtual Machine Instruction Set](https://docs.oracle.com/javase/specs/jvms/se8/html/jvms-6.html).

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-12-11T00:56:55.347

A little more "graphic" explanation, IBM developer works: [Understanding bytecode makes you a better programmer](http://www.ibm.com/developerworks/ibm/library/it-haggar_bytecode).

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-01T16:26:39.883

[《 Java 虚拟机编程](https://rads.stackoverflow.com/amzn/click/com/0201309726)》一书解释了 JVM 指令集以及如何为其编写代码。它还介绍了一个名为 Oolong 的字节码汇编器，我一直无法下载。但是，您可以使用Oolong 的前身[Jasmin](http://jasmin.sourceforge.net/)。本质上，你编写一个带有指令的文本文件，Jasmin 会输出一个 .class 文件。这本书出版于 1999 年，但它仍然是对 VM 的良好而温和的介绍。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-11T00:50:03.317

Also useful are the [javap](http://java.sun.com/javase/6/docs/technotes/tools/) disassembler and bytecode manipulation frameworks like [ASM](http://asm.objectweb.org/) and [BCEL](http://jakarta.apache.org/bcel/), even if all you want to do is verify your classes.

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-08T19:13:31.990

[Java 虚拟机规范](http://docs.oracle.com/javase/specs/jvms/se5.0/html/VMSpecTOC.doc.html)是一个很好的起点。

请参阅第 4 章[类文件格式](http://docs.oracle.com/javase/specs/jvms/se5.0/html/ClassFile.doc.html)。更新涵盖了自第 2 版制作以来添加的新属性。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-08T19:06:32.273

首先，我建议从您的语言生成 Java 代码。

这将使阅读和调试变得更加简单。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-09-26T07:38:49.610

或许可以查看[Preon 关于如何解析 Java 类文件的示例](https://github.com/preon/preon/blob/master/preon-samples/preon-sample-bytecode/src/main/java/org/codehaus/preon/sample/bytecode/ClassFile.java)。它在 Java 对象模型中具有相当完整的字节码表示。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-02-13T16:02:47.053

该规范的新版本已发布：

[Java 虚拟机规范，Java SE 7 版](http://docs.oracle.com/javase/specs/jvms/se7/html/index.html)

这个新增的内容确实排除了人们可能会或可能不会觉得有用的*Java 编程语言概念一章。*有关规范第二版中的该章节，请参见[此处。](http://docs.oracle.com/javase/specs/jvms/se5.0/html/Concepts.doc.html)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-12-11T14:44:23.193

这有点专业，但[这里](http://www.infoq.com/presentations/click-fast-bytecodes-funny-languages)有一个关于如何优化生成的字节码以在 JVM 上运行的在线演示。它是在最近的[JVM 语言峰会](http://openjdk.java.net/projects/mlvm/jvmlangsummit/)上提出的。InfoQ[收集了该会议的演讲集，](http://www.infoq.com/JVMLanguageSummit)这可能对想要在 JVM 上提出一种语言（或了解已经完成的工作）的人有所帮助。

# jmx - Java app performance counters viewed in Perfmon

> ID：358129
> 
> 赞同：5
> 
> 时间：2008-12-11T00:42:23.580
> 
> 标签：jmx, perfmon, mbeans

I have a Java app running on Tomcat, and I would like to monitor counters using Windows Performance Monitor. Is this possible using a JMX adapter for the Java MBeans or by some other means?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-17T12:10:33.783

以下教程可能有用： http: [//www.developer.com/java/ent/article.php/3087741/Hooking-to-PerfMon-from-Java.htm](http://www.developer.com/java/ent/article.php/3087741/Hooking-to-PerfMon-from-Java.htm)

它显示了 Java 应用程序如何定义可以在 Perfmon 中监视的自定义计数器。它基本上归结为使用性能监视器的扩展 DLL 并通过内存映射文件与之通信。然后，您可以将 JMX 计数器挂接到类似的机制中，以便可以从 Perfmon 监视它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T05:24:50.593

由于您使用 JMX 和 MBean 标记了它，我假设您的计数器可以从 Java MBean 访问。如果是这样，您可以使用随 Java SDK 提供的 jconsole 来监控计数器。在 MBeans 选项卡中找到您的 MBean 后，双击该值，它将绘制一个漂亮的折线图以便于监控。

有关详细信息，请参阅[JConsole 指南](http://java.sun.com/javase/6/docs/technotes/guides/management/jconsole.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-11T11:11:24.997

这似乎正是您正在寻找的，但它不是免费的：http: [//www.adventnet.com/products/snmpadaptor/faqs/general.html](http://www.adventnet.com/products/snmpadaptor/faqs/general.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-04T11:35:57.523

如果您想以编程方式执行此操作，您可以创建一个到机器的 JMXConnection，然后从那里访问 MBean。我们自己为一个函数测试做了这个，该测试涉及跟踪应用程序中的线程数，有一个计数器可以通过 JMX 访问。如果你想要漂亮的图表和类似的东西，我建议使用 JConsole，如上所述。还有一个叫做[JProfiler](http://www.ej-technologies.com/products/jprofiler/overview.html)的程序，它基本上像 JConsole 的类固醇一样工作。有一个免费试用版，您可以尝试一下。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-08-30T12:29:41.020

本文概述了如何从 Java 访问 Windows PerfMon 统计信息并通过 JMX 将它们公开为 MBean 属性[。](http://www.javaworld.com/javaworld/jw-09-2005/jw-0919-windowspm.html)

# c# - 当连接关闭时，ODP.net 是否会关闭引用游标？

> ID：358135
> 
> 赞同：6
> 
> 时间：2008-12-11T00:44:56.213
> 
> 标签：c#, oracle, odp.net

我还没有在任何地方找到明确的说明，但是我在网上找到的一堆例子遵循了我一直在做的事情。

我有一个 C# 类，它使用 ODP.net 连接到 Oracle DB 并运行包中的过程。

我的包有存储过程，它采用 ref 游标输出参数。该过程所做的只是为特定的选择语句打开游标。

如果我直接在 oracle db 上执行此过程，那么最终我会遇到最大打开游标数错误。

所以我想知道 ODP.net 是否确实关闭了在我的程序中打开的这个游标？

我正在使用 OracleDataApaper.Fill(DataSet) 方法。

例如。

```
DataSet ds = new DataSet();
OracleConnection conn = new OracleConnection(this.connStr);
OracleCommand com = new OracleCommand("MYPKG.MYQUERY", conn);
OracleDataAdapter adapter = new OracleDataAdapter(com);
conn.Open();
com.Parameters.Add("searchParam", OracleDbType.Varchar2).Value = "myName";
com.Parameters.Add("outCursor", OracleDbType.RefCursor, ParameterDirection.Output);
com.CommandType = CommandType.StoredProcedure;

adapter.Fill(ds);
conn.Close();

PROCEDURE GETALLEMAILS(searchParamIN VARCHAR2, outCursor OUT sys_refcursor) AS
  BEGIN
    open outCursor
      select 
        EAEMAL as Email
      from 
        EmailTable
      where 
        EmailName = searchParam;  
  END GETALLEMAILS; 
```

我只是害怕在数据库上留下打开的游标。如果有人可以提供官方文档的链接，那就太好了！

* * *

更新：

感谢您的输入。我在打电话

```
com.Dispose();
conn.Close();
conn.Dispose(); 
```

但把它们排除在我的例子之外。

我找到了这个论坛帖子，其中指出 OracleDataAdapter.Fill(Dataset) 方法在 Fill() 方法执行后确实释放了引用光标。
[http://www.frontoracle.com/oracle-archive/140/386140-close-ref-cursor.html](http://www.frontoracle.com/oracle-archive/140/386140-close-ref-cursor.html)

不过，我希望 Oracle 文档能更明确地描述这个过程。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-11T08:46:54.290

ODP.NET 要求你清理东西。那么你：

*   必须处理 OracleParameter 实例，因为它们包含非托管资源（！）并且 Odp.net 不这样做
*   必须处理 OracleCommand 对象，因为它们也包含非托管资源并且关闭连接不会关闭这些
*   如果没有打开的连接，打开的游标就无法生存，尽管在 odp.net 中，连接关闭（或被处理）后什么都不会被清理，所以你也必须清理这些（当然在连接关闭之前）。

Iow：清理你创造的东西。

它可能是 OracleDataAdapter 已经为您执行此操作，但这尚不清楚（并且 odp.net 文档没有这样说，因此您必须使用反射器检查（不可读的）代码以确保。虽然 odp 的经验法则.net：为避免内存泄漏，请始终按顺序对所有内容调用 dispose：参数、游标、命令、事务、连接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-11T01:40:31.387

我不确定您是否偶然发现了[这篇](http://www.oracle.com/technology/oramag/oracle/06-jan/o16odpnet.html)文章，它并不直接适用于您的问题，但它说明了我在使用 ODP.Net 时学到的一些东西：如有疑问，请始终关闭（连接）并处理。我编写的每个使用 ODP 连接、命令和/或游标实例的方法都有一个 finally 子句来处理所有内容。

# performance - Remove duplicate items with minimal auxiliary memory?

> ID：358136
> 
> 赞同：3
> 
> 时间：2008-12-11T00:45:46.990
> 
> 标签：performance, algorithm, optimization, sorting, hash

What is the most efficient way to remove duplicate items from an array under the constraint that axillary memory usage must be to a minimum, preferably small enough to not even require any heap allocations? Sorting seems like the obvious choice, but this is clearly not asymptotically efficient. Is there a better algorithm that can be done in place or close to in place? If sorting is the best choice, what kind of sort would be best for something like this?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-11T15:45:49.170

我会回答我自己的问题，因为在发布之后，我想出了一个非常聪明的算法来做到这一点。它使用散列，在适当的位置构建类似于散列集的东西。它保证在腋窝空间中是 O(1)（递归是尾调用），并且通常是 O(N) 时间复杂度。算法如下：

1.  取数组的第一个元素，这将是**sentinel**。
2.  尽可能对数组的其余部分重新排序，以使每个元素都位于与其哈希对应的位置。完成此步骤后，将发现重复项。将它们设置为哨兵。
3.  将索引等于散列的所有元素移动到数组的开头。
4.  将所有等于 sentinel 的元素（数组的第一个元素除外）移动到数组的末尾。
5.  正确散列的元素和重复元素之间剩下的将是由于冲突而无法放入与其散列对应的索引中的元素。递归处理这些元素。

这可以证明是 O(N)，前提是在散列中没有病态场景：即使没有重复，每次递归也会消除大约 2/3 的元素。每个级别的递归都是 O(n)，其中小的 n 是剩余元素的数量。唯一的问题是，在实践中，当重复项很少时，它比快速排序要慢，即很多冲突。然而，当有大量重复时，它的速度惊人地快。

编辑：在 D 的当前实现中，hash_t 是 32 位。这个算法的所有内容都假设在完整的 32 位空间中，哈希冲突非常少（如果有的话）。然而，碰撞可能经常发生在模数空间中。但是，对于任何合理大小的数据集，这个假设很可能是正确的。如果密钥小于或等于 32 位，它可以是它自己的哈希，这意味着在完整的 32 位空间中发生冲突是不可能的。如果它更大，那么您根本无法将足够多的它们放入 32 位内存地址空间中，这将成为一个问题。我假设在 D 的 64 位实现中 hash_t 将增加到 64 位，其中数据集可以更大。此外，如果这确实被证明是一个问题，则可以在每个递归级别更改散列函数。

这是 D 编程语言中的一个实现：

```
void uniqueInPlace(T)(ref T[] dataIn) {
    uniqueInPlaceImpl(dataIn, 0);
}

void uniqueInPlaceImpl(T)(ref T[] dataIn, size_t start) {
    if(dataIn.length - start < 2)
        return;

    invariant T sentinel = dataIn[start];
    T[] data = dataIn[start + 1..$];

    static hash_t getHash(T elem) {
        static if(is(T == uint) || is(T == int)) {
            return cast(hash_t) elem;
        } else static if(__traits(compiles, elem.toHash)) {
            return elem.toHash;
        } else {
            static auto ti = typeid(typeof(elem));
            return ti.getHash(&elem);
        }
    }

    for(size_t index = 0; index < data.length;) {
        if(data[index] == sentinel) {
            index++;
            continue;
        }

        auto hash = getHash(data[index]) % data.length;
        if(index == hash) {
            index++;
            continue;
        }

        if(data[index] == data[hash]) {
            data[index] = sentinel;
            index++;
            continue;
        }

        if(data[hash] == sentinel) {
            swap(data[hash], data[index]);
            index++;
            continue;
        }

        auto hashHash = getHash(data[hash]) % data.length;
        if(hashHash != hash) {
            swap(data[index], data[hash]);
            if(hash < index)
                index++;
        } else {
            index++;
        }
    }

    size_t swapPos = 0;
    foreach(i; 0..data.length) {
        if(data[i] != sentinel && i == getHash(data[i]) % data.length) {
            swap(data[i], data[swapPos++]);
        }
    }

    size_t sentinelPos = data.length;
    for(size_t i = swapPos; i < sentinelPos;) {
        if(data[i] == sentinel) {
            swap(data[i], data[--sentinelPos]);
        } else {
            i++;
        }
    }

    dataIn = dataIn[0..sentinelPos + start + 1];
    uniqueInPlaceImpl(dataIn, start + swapPos + 1);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-11T01:15:56.743

Keeping auxillary memory usage to a minimum, your best bet would be to do an efficient sort to get them in order, then do a single pass of the array with a FROM and TO index.

You advance the FROM index every time through the loop. You only copy the element from FROM to TO (and increment TO) when the key is different from the last.

With Quicksort, that'll average to O(n-log-n) and O(n) for the final pass.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-11T09:16:28.440

您是否有两个不同的 var 用于遍历仅包含一个的 datadet，然后您可以通过消除当前已经在数据集中的所有重复项来限制输出。

很明显，C 中的这个示例不是一种高效的排序算法，但它只是查看问题的一种方式的示例。

您也可以先对数据进行盲目排序，然后重新定位数据以删除重复数据，但我不确定这会更快。

```
#define ARRAY_LENGTH 15
int stop = 1;
int scan_sort[ARRAY_LENGTH] = {5,2,3,5,1,2,5,4,3,5,4,8,6,4,1};

void step_relocate(char tmp,char s,int *dataset)
{
    for(;tmp<s;s--)
        dataset[s] = dataset[s-1];
}
int exists(int var,int *dataset)
{
    int tmp=0;
    for(;tmp < stop; tmp++)
    {
        if( dataset[tmp] == var)
            return 1;/* value exsist */
        if( dataset[tmp] > var)
            tmp=stop;/* Value not in array*/
    }
    return 0;/* Value not in array*/
}
void main(void)
{
    int tmp1=0;
    int tmp2=0;
    int index = 1;
    while(index < ARRAY_LENGTH)
    {
        if(exists(scan_sort[index],scan_sort))
            ;/* Dismiss all values currently in the final dataset */
        else if(scan_sort[stop-1] < scan_sort[index])
        {
            scan_sort[stop] = scan_sort[index];/* Insert the value as the highest one */
            stop++;/* One more value adde to the final dataset */
        }
        else
        {
            for(tmp1=0;tmp1<stop;tmp1++)/* find where the data shall be inserted */
            {
                if(scan_sort[index] < scan_sort[tmp1])
                {
                    index = index;
                    break;
                }
            }
            tmp2 = scan_sort[index]; /* Store in case this value is the next after stop*/
            step_relocate(tmp1,stop,scan_sort);/* Relocated data already in the dataset*/
            scan_sort[tmp1] = tmp2;/* insert the new value */
            stop++;/* One more value adde to the final dataset */
        }
        index++;
    }
    printf("Result: ");
    for(tmp1 = 0; tmp1 < stop; tmp1++)
        printf( "%d ",scan_sort[tmp1]);
    printf("\n");
    system( "pause" );
} 
```

我喜欢这个问题，所以我为它写了一个简单的 C 测试程序，如上所示。如果我应该详细说明或您发现任何错误，请发表评论。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-11T01:05:43.347

If you sort the array, you will still need another pass to remove duplicates, so the complexity is O(N*N) in the worst case (assuming Quicksort), or O(N*sqrt(N)) using Shellsort.

You can achieve O(N*N) by simply scanning the array for each element removing duplicates as you go.

Here is an example in Lua:

```
function removedups (t)
    local result = {}
    local count = 0
    local found
    for i,v in ipairs(t) do
        found = false
        if count > 0 then
            for j = 1,count do
                if v == result[j] then found = true; break end
            end
        end
        if not found then 
            count = count + 1
            result[count] = v 
        end
    end
    return result, count
end 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-11T03:19:16.040

如果没有诸如冒泡排序之类的东西，我看不出有任何方法可以做到这一点。当你找到一个骗子时，你需要减少数组的长度。快速排序不是为改变数组的大小而设计的。

这个算法总是 O(n^2) 但它也几乎不使用额外的内存——堆栈或堆。

```
// returns the new size
int bubblesqueeze(int* a, int size) {
   for (int j = 0; j < size - 1; ++j) {
      for (int i = j + 1; i < size; ++i) {
          // when a dupe is found, move the end value to index j
          // and shrink the size of the array
          while (i < size && a[i] == a[j]) {
             a[i] = a[--size];
          }
          if (i < size && a[i] < a[j]) {
             int tmp = a[j];
             a[j] = a[i];
             a[i] = tmp;
          }
      }
   }
   return size;
} 
```

# c# - 我认为这是某种编码问题

> ID：358147
> 
> 赞同：0
> 
> 时间：2008-12-11T00:53:04.930
> 
> 标签：c#, xml, encoding, datagridview

我有两台电脑。两者都运行 WinXP SP2（我真的不知道它们是否相似）。我在两者上都运行 MS Visual C# 2008 速成版，这就是我目前用来编程的。

我制作了一个加载 XML 文件并在 DataGridView 中显示内容的应用程序。

我的 xml 文件的第一行是：

```
<?xml version="1.0" encoding="utf-8"?> 
```

......真的......它是utf-8（至少当我在那里打开文件时根据MS VS C#）。

我编译代码并在一台计算机上运行它，我的 DataGridView 的内容看起来很正常。没有有趣的角色。我编译代码并在另一台计算机上运行它（或者只是从计算机＃1获取已发布的版本并将其安装在计算机＃2上 - 我尝试了这两种方式）和datagridview，其中有换行符/换行符xml 文件，我看到有趣的方形字符。

我是编码新手......所以我真正尝试解决的唯一问题是使用同一个程序将我的 xml 的内容写入一个新的 xml 文件（但我实际上是将它写入一个文本文件，带有 xml 标签），因为默认写入文本文件似乎是 utf-8。然后我将这个新文件读回到我的程序中。我得到相同的结果。

我不知道还能做什么或如何解决这个问题，或者我可能从根本上做错了什么。

-阿迪娜

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-11T01:01:39.923

这与 UTF-8 或字符编码无关——这个问题与[行尾](http://en.wikipedia.org/wiki/Line_ending)有关。在 Windows 中，文本文件的每一行都以两个字符回车符 (CR) 和换行符 (LF，用于换行) 结束，它们分别是代码点 U+000D 和 U+000A。在 ASCII 和 UTF-8 中，它们被编码为两个字节`0D 0A`。另一方面，大多数非 Windows 系统，包括 Linux 和 Mac OS X，只使用换行符来表示换行符，因此在 Windows 和非 Windows 之间传输文本文件时出现换行问题并不少见系统。

但是，由于您在两个系统上都只使用 Windows，所以这更加神秘。一个应用程序将 CRLF 组合正确解释为换行符，但另一个应用程序被 CR 混淆了。回车不是可打印的字符，所以它用一个占位符框替换了 CR，这就是你所看到的；然后它正确地将换行解释为行尾。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-11T01:02:08.987

当您使用不同类型的换行符时，通常会出现方形。

*   Linux -`(0A)`低频
*   赢 - `(0D0A)`CRLF
*   Mac- `(0D)`CR

该应用程序可能是使用 1 种类型创建的，而正在运行的应用程序需要另一种类型。

* * *

查看[`Environment.NewLine`](http://msdn.microsoft.com/en-us/library/system.environment.newline.aspx)

而且，你可以试试这个：（不保证——我写的 C# 不多）

```
strInput = Regex.Replace(strInput, "\\r?\\n?", Environment.NewLine) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-12T06:23:48.400

我不确定你的问题的原因，但一种解决方案是从你的字符串中去掉回车。对于您添加的每个字符串，只需调用`TrimEnd(null)`它以删除尾随空格：

```
newrow["topic"] = att1.ToString().TrimEnd(null); 
```

如果您的字符串可能以其他空格（即空格或制表符）结尾并且您想保留它们，那么只需将一个仅包含回车符的数组传递给`TrimEnd`：

```
newrow["topic" = att1.ToString().TrimEnd(new Char[]{'\r'}); 
```

免责声明：我不是 C# 程序员；第二个语句可能在语法上不正确

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-11T23:45:05.163

//@亚当：对不起！错过了你之前的陈述。

要将文档加载到程序中并在 DataGridView 中显示，我目前正在做（我说“当前”，因为我尝试了其他事情，比如使用 XDocument 而不是 Xelement）：

```
XElement xe1 = XElement.Load(filePath);

DataTable myTable = new DataTable();
myTable = mkTable();   // calls a function that makes the table
var _categories = (from p1 in xe1.Descendants("category") select p1);
int numCat = _categories.Count();
int i = 0;

while (i < numCat)
{
    DataRow newrow;
    newrow = myTable.NewRow();

    if (_categories.ElementAt(i).Parent.Name == "topic")
    {
        string att1 = _categories.ElementAt(i).Parent.Attribute("name").Value.ToString();
        newrow["topic"] = att1.ToString();
    }
    // repeat the above for the different things in my document
    myTable.Rows.Add(newrow);

    i++;
}
myDataSet.Merge(myTable);
bindingSourceIn.DataSource = myDataSet;
myDataGridView.DataSource = bindingSourceIn;
myDataGridView.DataMember = "xmlthing"; 
```

（显然这里的东西有点缩写......即，我的 bindingsource/datagridview 等在其他地方声明......但希望这足以有意义）

-阿迪娜

# asp.net - Binding gridviews to viewstate until being able to write to database

> ID：358151
> 
> 赞同：2
> 
> 时间：2008-12-11T00:55:27.657
> 
> 标签：asp.net, gridview, viewstate

I recently began working on a project which has many gridviews on a single page. During creation of a new record, the user needs to be able to add/remove/edit these gridviews and then save to the database at the end. The problem with this obviously is that there is no datasource to bind the data too until after its written to the database.

This data represents a 1..* relationship, which is why the gridview data cannot be written to the database until the parent record has been created first.

The best way I have found so far to solve this is to use viewstate. This solution however does not seem ideal to me. I am also forced to manually create the gridview functionality with OnDeleting, OnUpdating, etc so that I can manage the binding of the viewstate with the gridview.

Does anyone have any suggestions on a better way to manage this situation, it seems like it would be a common thing?

UPDATE:

Keep in mind this data needs to be around throughout postbacks.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-11T01:06:27.277

Use a DataSet as an intermediate connection to your data source. Fill the DataSet with your data and then bind your GridView to the DataSet setting the GridView DataMember to the name of the table it is supposed to bind to.

As the user updates tables it will add/modify records in the DataTables in the DataSet. When the user is done editing and clicks "Save" your code can then update the database from the datasets, either automatically using a DataAdapter, or manually looking at the RowState of the rows in the DataTables.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-11T01:16:59.610

Use a DataAdapter and a Dataset. Invoke the fillschema method in the adapter to create de metadata (cols, constraints, relations, etc) in the dataset. bind the data tables created to the different grid views. update manually cheking each row rowstate on each table or call the adapter's update method to do it automatically. If you do it automatically you need to define commands for insert, delete, and update in the adapter.

# unit-testing - 使用 ExpectSet() 和 It.Is 进行最小起订量测试 () 的行为不符合...预期

> ID：358160
> 
> 赞同：0
> 
> 时间：2008-12-11T00:58:17.277
> 
> 标签：unit-testing, tdd, mocking, moq

我已将行为隔离到以下测试用例中。我会感谢任何能告诉我如何期待/验证属性集的人`List<T>`- 似乎里面发生了一些事情，`It.Is<T>(predicate)`现在对我来说没有多大意义。示例代码将作为 VS2008 中的控制台应用程序运行 - 您需要添加对 Moq 2.6 的引用（我在 2.6.1014.1 上） - 请尝试取消注释不同的 ExpectSet 语句以查看发生了什么...

```
using System;
using Moq;
using System.Collections.Generic;

namespace MoqDemo {

    public interface IView {
        List<string> Names { get; set; }
    }

    public class Controller {
        private IView view;

        public Controller(IView view) {
            this.view = view;
        }

        public void PopulateView() {
            List<string> names = new List<string>() { "Hugh", "Pugh", "Barney McGrew" };
            view.Names = names;
        }

        public class MyApp {
            public static void Main() {
                Mock<IView> mockView = new Mock<IView>();

                // This works - and the expectation is verifiable.
                mockView.ExpectSet(mv => mv.Names);

                // None of the following can be verified.
                // mockView.ExpectSet(mv => mv.Names, It.Is<Object>(o => o != null));
                // mockView.ExpectSet(mv => mv.Names, It.Is<List<string>>(names => names.Count == 3));
                // mockView.ExpectSet(mv => mv.Names, It.IsAny<IList<String>>());

                Controller controller = new Controller(mockView.Object);
                controller.PopulateView();
                try {
                    mockView.VerifyAll();
                    Console.WriteLine("Verified OK!");
                } catch (MockException ex) {
                    Console.WriteLine("Verification failed!");
                    Console.WriteLine(ex.Message);
                }
                Console.ReadKey(false);
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-11T01:27:37.827

ExpectSet() 的第二个参数是您期望的值。您不能`It.Is<T>`在这种情况下使用，因为没有采用谓词的重载 - 尽管它会很好；）这是您的示例的（简化）摘录，说明了值的使用：

```
var mockView = new Mock<IView>();
var list = new List<string> { "Hugh", "Pugh", "Barney McGrew" };

mockView.ExpectSet(mv => mv.Names, list);

mockView.Object.Names = list; 
```

希望有帮助。

编辑：修正错字。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-11T01:53:37.900

我没有使用最新版本的 Moq，所以我没有使用两个参数的 ExpectSet 重载，但我在这种模式上取得了一些成功：

```
mockView.ExpectSet(mv => mv.Names).Callback(n => Assert.That(n != null)); 
```

如果分配给 .Names 的值与谓词不匹配，回调中的 Assert（来自 NUnit）调用将引发异常。但是，当测试失败时，它确实很难追踪。我同意将 It.Is 或 It.IsAny 作为第二个参数传递的能力会很方便。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-03T21:24:43.127

顺便说一句，ExpectSet 不支持 It.Is。您的代码编译只是因为它们在用作值（而不是表达式）时是常规方法调用，而在 Expect*表达式*中使用时，它们由 Moq 预处理并赋予特定含义（而不是所有它的 null/默认值.Is 成员实际上返回）。

您可以在给定属性 (mockView.Stub(mv => mv.Names)) 上使用存根行为，然后在执行后直接断言其值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-03T21:17:11.877

Moq 不提供接收 It.IsAny 的重载，因为它实际上与在不传递预期值的情况下调用 ExpectSet 相同；）

# jquery - 如何创建自定义“确认”并暂停 js 执行，直到用户单击按钮？

> ID：358168
> 
> 赞同：13
> 
> 时间：2008-12-11T01:04:27.623
> 
> 标签：jquery, ajax, ria, javascript

好的，我正在做一堆 RIA/AJAX 的东西，需要创建一个“漂亮”的自定义确认框，它是一个 DIV（不是内置的 javascript 确认）。我无法确定如何在执行中暂停以让用户有机会在恢复或停止执行之前接受或拒绝条件。（取决于他们的回答）

所以这是我正在处理的一般逻辑流程：

1.  用户从下拉列表中选择一个项目并单击按钮。
2.  在按钮的客户端javascript事件处理程序中，我需要检查他们在下拉列表中选择的项目的一系列条件（这是关键）。
3.  这些条件可能会导致根本不显示任何确认，或者可能只有某些条件评估为真，这意味着我需要在继续之前要求用户接受或拒绝该条件。一次只能显示一个确认。

演示逻辑：

```
function buttonEventHandler() {

if (condition1) {
  if(!showConfirmForCondition1) // want execution to pause while waiting for user response.
     return; // discontinue execution
}

if (condition2) {
  if (!showConfirmForCondition2) // want execution to pause while waiting for user response.

     return; // discontinue execution
}

if (condition3) {
  if (!showConfirmForCondition3) // want execution to pause while waiting for user response.

     return; // discontinue execution
}

...  
} 
```

如果有人以前处理过这个挑战并找到了解决方案，我们将不胜感激。需要注意的是，我还在使用**MS Ajax**和**jQuery**库，尽管我还没有找到任何可能已经包含在解决这个问题的功能中。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-11T01:12:26.093

恐怕不能以与“确认”和“警报”对话框暂停它相同的方式暂停 Javascript 运行时。要使用 DIV 执行此操作，您将不得不将代码分成多个块，并让自定义确认框上的事件处理程序调用下一段代码。

已经有一些项目将“延续”支持引入 Javascript，例如[Narrative Javascript](http://www.neilmix.com/narrativejs/doc/)，所以如果你真的热衷于让它在单个代码块中工作，你可以研究一下。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2010-08-17T12:35:25.670

我如何做到这一点的方式：

1.  创建您自己的带有按钮的确认对话框，比如“是”和“否”。
2.  创建触发对话框的函数，比如说`confirmBox(text, callback)`.
3.  在“是”和“否”按钮上绑定事件 - “是” - `callback(true)`，“否” - `callback(false)`。
4.  当您调用该函数时，请使用以下语法：

    ```
    confirmBox("Are you sure", function(callback){
        if (callback) {
            // do something if user pressed yes
        } 
        else {
            // do something if user pressed no
        }
    }); 
    ```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-11T02:40:46.027

试试这个，将你的javascript客户端函数传递给'this'对象并启动你的自定义确认对话框，但***总是***返回false以防止回发触发。但是，在您退出处理功能之前，请将相关信息手动触发回发到您的自定义确认框的“是”按钮。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-23T17:30:11.667

就我而言，目标是`customConfirm`每当用户单击嵌入在 .Net 中继器每一行中的删除链接时显示一个框

每当用户单击任何特定行的删除链接时，都会调用自定义确认函数。现在在confirm函数里面，除了渲染新的盒子，还需要做以下2件事：

```
// obtain the element(we will call it targetObject) that triggered the event

targetObject = (event.target==undefined ? event.srcElement : event.target);

// include a call to _doPostBack in the onclick event of OK/YES button ONLY

(targetObject.href!=undefined){ eval(targetObject.href); } else{ _doPostBack(targetObject.name,''); // it is assumed that name is available 
```

上面的 if/else 结构与我的情况有关。主要是知道您可以使用事件对象和`__doPostBack`函数来模拟确认暂停和连续性。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-16T12:06:10.713

就像保罗说的......这对我有用（我猜你使用 ASP.NET，但如果不是你可以轻松地重写它）：

```
function BeforeDelete(controlUniqueId) {
    confirmPopup('question...?', function() { __doPostBack(controlUniqueId, ''); });
    return false;
}

function confirmPopup(message, okCallback) {
    $('#popup-buttons-confirm').click(okCallback);
    // set message
    // show popup
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-08-19T14:37:08.250

使用 JqueryUI modal查看我的 Fiddle 模式警报框：http: [//jsfiddle.net/katiabaer/UXM9y/33/](http://jsfiddle.net/katiabaer/UXM9y/33/)

```
 showAlert = function (msg, header, callback) {
      var mydiv = $("<div id='mydiv'> </div>");
      mydiv.alertBox({
          message: msg,
          header: header,
          callback: callback
      });

  },

  $('#show').click(function () {
      var m = $('#message').val();
      var h = $('#header').val();
      var callback = function () {
          alert("I can do anything here");
      }
      showAlert(m, h, callback);

  });

  $.widget("MY.alertBox", {
      options: {
          message: "",
          header: "",
          callback: ''
      },

      _create: function () {
          var self = this;
          self.callback = self.options.callback;

          self.container = $(".alert-messagebox");
          var header = self.container.find(".alert-header");
          header.html(self.options.header);

          var message = self.container.find(".alert-message");
          message.html(self.options.message);

          var closeButton = self.container.find("button.modal-close-button");
          closeButton.click(function () {
              self.close();
          });

          self.show();
      },

      show: function () {
          var self = this;
          self.container.modal({
              maxWidth: 500
          });
      },

      close: function () {

          if (this.callback != null) {
              this.callback();
              $.modal.close();
              return;
          }
          $.modal.close();

      },

      destroy: function () {
          $.Widget.prototype.destroy.call(this);
      }

  }); 
```

# ruby-on-rails - 需要帮助为这种情况设置脚手架

> ID：358178
> 
> 赞同：1
> 
> 时间：2008-12-11T01:09:37.083
> 
> 标签：ruby-on-rails, scaffolding

[我之前问了一个问题](https://stackoverflow.com/questions/354900/use-references-for-multiple-items-of-same-type)，并得到了很好的回应，但是，作为 Rails 的新手并且还在学习基础知识，我需要有人告诉我如何为 Hates_ 足以为我概述的情况搭建一些脚手架. 我已经设置了我的应用程序等等，但我基本上想要拥有，例如：

*   “故事”表，用于故事列表
*   “页面”表，用于可以附加到故事的页面列表
*   “LinkedPages”表，将一个页面链接到多个其他页面

这个想法是用户可以创建故事。故事有页面。页面以分支方式链接到其他页面，Hates_ 建议使用 LinkedPages 表来帮助确定哪些页面链接到哪些其他页面的过程。

如果有人可以使用上面链接中提供的示例模型 Hates_（或者如果需要的话给我更好的模型），并告诉我如何开始，我将非常感激。Rails 的初始学习曲线是我过去学习过的任何编程或脚本语言中最高的，我刚刚开始了解许多基础知识。

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-11T02:23:16.717

这是一个更新的快节奏视频，它通过一个有点做作的博客教程快速展示了 Rails 中一些令人讨厌的甜蜜功能。

[http://media.rubyonrails.org/video/rails_blog_2.mov](http://media.rubyonrails.org/video/rails_blog_2.mov)

演示者在很短的时间内将大量信息塞入其中，并且不时粘贴一些准备好的代码，但总的来说，他提到了许多关键功能。

他解释了如何在大约最后 5 分钟左右搭建脚手架。

# asp.net - How would I dynamically add a new XML node based on the values of other nodes?

> ID：358185
> 
> 赞同：1
> 
> 时间：2008-12-11T01:13:46.137
> 
> 标签：asp.net, xml, regex, parsing

**Background:**
I have an old web CMS that stored content in XML files, one XML file per page. I am in the process of importing content from that CMS into a new one, and I know I'm going to need to massage the existing XML in order for the import process to work properly.

Existing XML:

```
<page>
    <audience1>true</audience>
    <audience2>false</audience>
    <audience3>true</audience>
    <audience4>false</audience>
    <audience5>true</audience>
</page> 
```

Desired XML:

```
<page>
    <audience1>true</audience>
    <audience2>false</audience>
    <audience3>true</audience>
    <audience4>false</audience>
    <audience5>true</audience>
    <audiences>1,3,5</audiences>
</page> 
```

**Question:**
The desired XML adds the node, with a comma-delimited list of the other nodes that have a "true" value. I need to achieve the desired XML for several files, so what is the best way to accomplish this? Some of my ideas:

*   Use a text editor with a regex find/replace. But what expression? I wouldn't even know where to begin.
*   Use a programming language like ASP.NET to parse the files and append the desired node. Again, not sure where to begin here as my .NET skills are only average.

Suggestions?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-12T13:12:52.527

我可能会使用 XSLT 样式表来解决这个问题。我构建了以下样式表，使其有点通用，完全符合您的要求，但如果您确实需要确切的输出，则可以轻松修改它以提供您指定的确切输出。

```
<?xml version="1.0" encoding="utf-8"?>

<xsl:stylesheet version="1.0"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

<xsl:template match="/">
  <xsl:apply-templates select="/*"/>
</xsl:template>

  <xsl:template match="/*">
    <xsl:copy>
      <xsl:copy-of select="*"/>

        <xsl:element name="nodes">
          <xsl:apply-templates select="*[normalize-space(.) = 'true']"/>
        </xsl:element>
      </xsl:copy>
  </xsl:template>

  <xsl:template match="/*/*">
    <xsl:value-of select="concat(',', local-name())"/>
  </xsl:template>

  <xsl:template match="/*/*[1]">
    <xsl:value-of select="local-name()"/>
  </xsl:template>

</xsl:stylesheet> 
```

这个 XSLT 的输出将是：

```
<page>
  <audience1>
    true
  </audience1>
  <audience2>
    false
  </audience2>
  <audience3>
    true
  </audience3>
  <audience4>
    false
  </audience4>
  <audience5>
    true
  </audience5>
  <nodes>audience1,audience3,audience5</nodes>
</page> 
```

XSLT 非常适合这种情况，因为您可以使用几乎任何您想要的编程语言，或者您可以使用 Visual Studio 来应用模板。还有许多[免费工具](http://saxon.sourceforge.net/)可用于应用转换。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-11T01:27:39.853

I would probably use the XmlDocument class in .net, but that's just me because I've never been that fond of regexs.

You could then use XPath expressions to pull out the child nodes of each page node, evaluate them, and append a new node at the end of the page children, save the XmlDocument when you are done.

Xsl is an option too, but the initial learning curve is a bit painful.

There's probably a more elegant way with a regex, but if you are only running it once, it only matters that it works.

# python - 我可以在 wxpython 中使用图表模块吗？

> ID：358189
> 
> 赞同：5
> 
> 时间：2008-12-11T01:15:41.423
> 
> 标签：python, wxpython

是否可以将任何图表模块与 wxpython 一起使用？那里有什么好的吗？

我正在考虑 PyCha ( [http://www.lorenzogil.com/projects/pycha/](http://www.lorenzogil.com/projects/pycha/) ) 之类的东西或任何等价物。许多模块似乎需要 PyCairo，但我不知道是否可以在我的 wxpython 应用程序中使用这些模块。

我的应用程序有一个笔记本窗格，我想将图表放在其中。图表必须是动态的——即用户可以选择查看什么样的数据——所以我猜测制作图表图像的模块已经出局了。

为清楚起见，我所说的图表是指饼图、线条和条形图等。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-11T02:54:33.330

我最近重新访问了[matplotlib](http://matplotlib.sourceforge.net/index.html)，对结果非常满意。如果您使用的是 Windows，则可以使用 Windows 安装程序来使您的安装过程不那么痛苦。

但是，一个潜在的缺点是它需要安装[numpy](http://sourceforge.net/project/showfiles.php?group_id=1369&package_id=175103)。

我对它的交互性没有经验，但它确实支持[事件处理](http://matplotlib.sourceforge.net/users/event_handling.html?highlight=wxpython)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-11T05:11:51.930

matplotlib 确实很好地嵌入了[wxpython](http://www.scipy.org/Cookbook/Matplotlib/EmbeddingInWx)。我只在 Tkinter 中使用过它，这对我来说很顺利。我喜欢允许直接操作绘图的可选工具栏（调整大小和平移等）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-13T09:40:03.703

使用 matplotlib。它与 wxPython 很好地集成。[这是一个](http://eli.thegreenplace.net/2008/08/01/matplotlib-with-wxpython-guis/)带有 wxPython 和 matplotlib 的交互式图表示例。

# javascript - 将字符串拆分为键/值的最简单方法

> ID：358195
> 
> 赞同：2
> 
> 时间：2008-12-11T01:18:59.263
> 
> 标签：javascript, regex

从这样的字符串中提取键和值的最佳方法是什么：

```
var myString = 'A1234=B1234'; 
```

我最初有这样的事情：

```
myString.split('='); 
```

这很好用，但是等号（=）可以用作字符串中的键或值，加上字符串可以有引号，如下所示：

```
var myString = '"A123=1=2=3=4"="B1234"'; 
```

字符串也只能有一对引号和空格：

```
var myString = ' "A123=1=2=3=4" = B1234 '; 
```

我不太擅长正则表达式，但我猜这就是前进的方向？

我想要结束的是两个变量，键和值，在上述情况下，键变量最终将是*A123=1=2=3=4*，值变量将是*B1234*。

如果不存在任何值，例如，如果这是原始字符串：

```
var myString = 'A1234'; 
```

然后我希望 key 变量为 'A1234' 并且 value 变量为 null 或 false - 或者我可以测试的东西。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-11T01:25:20.733

无法使用单线，但我会建议幼稚的方式：

```
var inQuote = false;
for(i=0; i<str.length; i++) {
   if (str.charAt(i) == '"') {
      inQuote = !inQuote;
   }
   if (!inQuote && str.charAt(i)=='=') {
      key = str.slice(0,i);
      value = str.slice(i+1);
      break;
   }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-11T02:53:50.787

```
/^(\"[^"]*\"|.*?)=(\"[^"]*\"|.*?)$/ 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-11T01:32:57.940

我倾向于在配置文件中做的是确保分隔符**不可能**进入键或值。

有时，如果您可以说“不允许使用 '=' 字符”，这很容易，但我不得不在某些地方对这些字符进行编码。

我通常将它们十六进制，这样如果你想要一个 '=' 字符，你必须输入 %3d （和 %25 用于 '%' 字符，所以你不认为它是一个十六进制起始字符）。您也可以将 %xx 用于任何字符，但只有这两个字符才**需要**。

这样，您可以检查该行以确保它只有一个“=”字符，然后对键和值进行后处理以将十六进制字符转换回真实字符。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-11T06:50:19.063

如果我们制定一个规则，所有带等号的键都需要嵌入引号中，那么这很好用（我无法想象有什么好的理由让键中的转义引号。）

```
/ ^               # Beginning of line
  \s*             # Any number of spaces
  ( " ( [^"]+) "  # A quote followed by any number of non-quotes, 
                  # and a closing quote
  | [^=]*         # OR any number of not equals signs 
    [^ =]         # and at least one character that is not a equal or a space
  )               
  \s*             # any number of spaces between the key and the operator
  =               # the assignment operator
  \s*             # Any number of spaces 
  (.*?\S)         # Then any number of any characters, stopping at the last non-space
  \s*             # Before spaces and...
  $               # The end of line. 
```

/

Now in Java, properties files (they break at the first ':' or '=', though) you can have multiple lines in a property by putting '\' at the end of the line, so it would be a little trickier.

# c# - 进行单元测试时的 C#“内部”访问修饰符

> ID：358196
> 
> 赞同：570
> 
> 时间：2008-12-11T01:20:30.163
> 
> 标签：c#, .net, unit-testing, tdd

我是单元测试的新手，我试图弄清楚是否应该开始使用更多的`internal`访问修饰符。我知道，如果我们使用`internal`和设置程序集变量`InternalsVisibleTo`，我们可以测试我们不想从测试项目中公开的函数。这让我觉得我应该总是使用`internal`，因为至少每个项目（应该？）都有自己的测试项目。你们能告诉我为什么我不应该这样做吗？我应该什么时候使用`private`？

* * *

## 回答 #1

> 赞同：1362
> 
> 时间：2009-11-27T15:53:54.033

内部类需要测试，并且有一个程序集属性：

```
using System.Runtime.CompilerServices;

[assembly:InternalsVisibleTo("MyTests")] 
```

将此添加到项目信息文件中，例如`Properties\AssemblyInfo.cs`，用于正在测试的项目。在这种情况下，“MyTests”是测试项目。

* * *

## 回答 #2

> 赞同：134
> 
> 时间：2008-12-11T05:49:57.640

如果您想测试私有方法，请查看命名空间中的`PrivateObject`和。它们围绕必要的反射代码提供易于使用的包装器。`PrivateType``Microsoft.VisualStudio.TestTools.UnitTesting`

文档： [PrivateType](https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.testtools.unittesting.privatetype?view=mstest-net-1.2.0) , [PrivateObject](https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.testtools.unittesting.privateobject?view=mstest-net-1.2.0)

对于 VS2017 和 2019，您可以通过下载 MSTest.TestFramework nuget 找到这些

* * *

## 回答 #3

> 赞同：109
> 
> 时间：2019-04-27T16:04:45.277

添加到 Eric 的答案中，您还可以在`csproj`文件中进行配置：

```
<ItemGroup>
    <AssemblyAttribute Include="System.Runtime.CompilerServices.InternalsVisibleTo">
      <_Parameter1>MyTests</_Parameter1>
    </AssemblyAttribute>
</ItemGroup> 
```

或者，如果每个要测试的项目都有一个测试项目，则可以在`Directory.Build.props`文件中执行以下操作：

```
<ItemGroup>
    <AssemblyAttribute Include="System.Runtime.CompilerServices.InternalsVisibleTo">
      <_Parameter1>$(MSBuildProjectName).Test</_Parameter1>
    </AssemblyAttribute>
</ItemGroup> 
```

请参阅：[https](https://stackoverflow.com/a/49978185/1678053)
://stackoverflow.com/a/49978185/1678053 示例：[https ://github.com/gldraphael/evlog/blob/master/Directory.Build.props#L5-L12](https://github.com/gldraphael/evlog/blob/master/Directory.Build.props#L5-L12)

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2020-02-07T06:29:41.930

我正在使用`.NET Core 3.1.101`，对我有用的`.csproj`补充是：

```
<PropertyGroup>
  <!-- Explicitly generate Assembly Info -->
  <GenerateAssemblyInfo>true</GenerateAssemblyInfo>
</PropertyGroup>

<ItemGroup>
  <AssemblyAttribute Include="System.Runtime.CompilerServices.InternalsVisibleToAttribute">
  <_Parameter1>MyProject.Tests</_Parameter1>
  </AssemblyAttribute>
</ItemGroup> 
```

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2008-12-11T06:27:57.097

默认情况下继续使用私人。如果一个成员不应该暴露在那个类型之外，那么它不应该暴露在那个类型之外，即使在同一个项目中也是如此。这使事情变得更安全和更整洁 - 当您使用对象时，您可以更清楚地使用哪些方法。

话虽如此，我认为有时出于测试目的将自然私有方法设为内部是合理的。我更喜欢使用反射，因为它对重构不友好。

要考虑的一件事可能是“ForTest”后缀：

```
internal void DoThisForTest(string name)
{
    DoThis(name);
}

private void DoThis(string name)
{
    // Real implementation
} 
```

然后，当您在同一个项目中使用该类时，很明显（现在和将来）您不应该真正使用这种方法 - 它只是用于测试目的。这有点老套，不是我自己做的，但至少值得考虑。

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2008-12-11T01:53:23.000

您也可以使用私有方法，也可以使用反射调用私有方法。如果您使用的是 Visual Studio Team Suite，它具有一些不错的功能，可以生成代理来为您调用私有方法。这是一篇代码项目文章，演示了如何自己完成对私有和受保护方法的单元测试：

[http://www.codeproject.com/KB/cs/testnonpublicmembers.aspx](http://www.codeproject.com/KB/cs/testnonpublicmembers.aspx)

至于您应该使用哪个访问修饰符，我的一般经验法则是从私有开始并根据需要升级。这样，您将尽可能少地公开真正需要的类的内部细节，并有助于隐藏实现细节，因为它们应该是。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2021-06-15T15:49:37.137

对于 .NET 核心，您可以将属性添加到命名空间作为 [程序集：InternalsVisibleTo("MyUnitTestsAssemblyName")]。例如类似的东西

```
using System.Runtime.CompilerServices;
[assembly: InternalsVisibleTo("Applications.ExampleApp.Tests")]
namespace Applications.ExampleApp
 internal sealed class ASampleClass : IDisposable
    {
        private const string ApiVersionPath = @"api/v1/";
        ......
        ......
        ......
        }
    } 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2020-09-28T15:46:25.670

在 .NET Core 2.2 中，将此行添加到 Program.cs：

```
using ...
using System.Runtime.CompilerServices;

[assembly: InternalsVisibleTo("MyAssembly.Unit.Tests")]

namespace
{
... 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-04-18T13:14:39.930

将文件添加`InternalsVisibleTo.cs`到文件所在的项目根文件夹`.csproj`。

的内容`InternalsVisibleTo.cs`应如下

```
using System.Runtime.CompilerServices;

[assembly: InternalsVisibleTo("AssemblyName.WhichNeedAccess.Example.UnitTests")] 
```

# ios - iPhone：如何获得当前的毫秒数？

> ID：358207
> 
> 赞同：246
> 
> 时间：2008-12-11T01:29:38.603
> 
> 标签：ios, iphone, time, timestamp, current-time

获取当前系统时间毫秒的最佳方法是什么？

* * *

## 回答 #1

> 赞同：323
> 
> 时间：2010-04-30T05:03:12.507

如果您正在考虑将其用于相对时间（例如用于游戏或动画），我宁愿使用[CACurrentMediaTime()](https://developer.apple.com/documentation/quartzcore/1395996-cacurrentmediatime)

```
double CurrentTime = CACurrentMediaTime(); 
```

这是推荐的方式；`NSDate`从网络同步时钟中提取，并且在与网络重新同步时偶尔会打嗝。

它返回当前的绝对时间，以秒为单位。

* * *

如果您*只*想要小数部分（通常在同步动画时使用），

```
let ct = CACurrentMediaTime().truncatingRemainder(dividingBy: 1) 
```

* * *

## 回答 #2

> 赞同：282
> 
> 时间：2008-12-11T01:39:48.910

```
[[NSDate date] timeIntervalSince1970]; 
```

它返回自纪元以来的秒数作为双精度数。我几乎可以肯定你可以从小数部分访问毫秒。

* * *

## 回答 #3

> 赞同：98
> 
> 时间：2012-08-18T16:35:58.717

我在 iPhone 4S 和 iPad 3（发布版本）上对所有其他答案进行了基准测试。`CACurrentMediaTime`具有最小的开销。`timeIntervalSince1970`比其他慢得多，可能是由于`NSDate`实例化开销，尽管对于许多用例来说可能无关紧要。

`CACurrentMediaTime`如果您想要最少的开销并且不介意添加 Quartz Framework 依赖项，我建议您这样做。或者`gettimeofday`，如果便携性是您的首要任务。

**iPhone 4S**

```
CACurrentMediaTime: 1.33 µs/call
gettimeofday: 1.38 µs/call
[NSDate timeIntervalSinceReferenceDate]: 1.45 µs/call
CFAbsoluteTimeGetCurrent: 1.48 µs/call
[[NSDate date] timeIntervalSince1970]: 4.93 µs/call 
```

**平板电脑 3**

```
CACurrentMediaTime: 1.25 µs/call
gettimeofday: 1.33 µs/call
CFAbsoluteTimeGetCurrent: 1.34 µs/call
[NSDate timeIntervalSinceReferenceDate]: 1.37 µs/call
[[NSDate date] timeIntervalSince1970]: 3.47 µs/call 
```

* * *

## 回答 #4

> 赞同：59
> 
> 时间：2015-10-02T19:22:02.777

在 Swift 中，我们可以创建一个函数并执行以下操作

```
func getCurrentMillis()->Int64{
    return  Int64(NSDate().timeIntervalSince1970 * 1000)
}

var currentTime = getCurrentMillis() 
```

虽然它在**Swift 3.0**中运行良好，但我们可以修改和使用`Date`该类而不是`NSDate`在**3.0中**

**斯威夫特 3.0**

```
func getCurrentMillis()->Int64 {
    return Int64(Date().timeIntervalSince1970 * 1000)
}

var currentTime = getCurrentMillis() 
```

* * *

## 回答 #5

> 赞同：31
> 
> 时间：2011-10-25T07:23:03.943

到目前为止，我`gettimeofday`在 iOS (iPad) 上找到了一个很好的解决方案，当您想要执行一些间隔评估（例如，帧速率、渲染帧的时间......）时：

```
#include <sys/time.h>
struct timeval time;
gettimeofday(&time, NULL);
long millis = (time.tv_sec * 1000) + (time.tv_usec / 1000); 
```

* * *

## 回答 #6

> 赞同：28
> 
> 时间：2018-07-10T07:11:40.053

获取当前日期的毫秒数。

**斯威夫特 4+：**

```
func currentTimeInMilliSeconds()-> Int
    {
        let currentDate = Date()
        let since1970 = currentDate.timeIntervalSince1970
        return Int(since1970 * 1000)
    } 
```

* * *

## 回答 #7

> 赞同：18
> 
> 时间：2016-01-18T14:39:24.653

**斯威夫特 2**

```
let seconds = NSDate().timeIntervalSince1970
let milliseconds = seconds * 1000.0 
```

**斯威夫特 3**

```
let currentTimeInMiliseconds = Date().timeIntervalSince1970.milliseconds 
```

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2011-06-27T23:45:01.260

了解 CodeTimestamps 可能很有用，它提供了基于马赫的计时函数的包装器。这为您提供了纳秒分辨率的计时数据 - 比毫秒精度高 1000000 倍。是的，精确到一百万倍。（前缀是毫、微、纳米，每一个都比上一个精确 1000 倍。）即使您不需要 CodeTimestamps，也请查看代码（它是开源的），看看它们如何使用 mach 来获取计时数据。当您需要更高的精度并且想要比 NSDate 方法更快的方法调用时，这将很有用。

[http://eng.pulse.me/line-by-line-speed-analysis-for-ios-apps/](http://eng.pulse.me/line-by-line-speed-analysis-for-ios-apps/)

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2014-09-24T12:28:44.050

```
// Timestamp after converting to milliseconds.

NSString * timeInMS = [NSString stringWithFormat:@"%lld", [@(floor([date timeIntervalSince1970] * 1000)) longLongValue]]; 
```

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2013-05-11T09:38:28.777

我需要一个`NSNumber`包含`[[NSDate date] timeIntervalSince1970]`. 由于这个函数被调用了很多次，而且我真的不需要创建一个`NSDate`对象，所以性能不是很好。

所以要得到原始函数给我的格式，试试这个：

```
#include <sys/time.h>
struct timeval tv;
gettimeofday(&tv,NULL);
double perciseTimeStamp = tv.tv_sec + tv.tv_usec * 0.000001; 
```

哪个应该给你完全相同的结果`[[NSDate date] timeIntervalSince1970]`

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2015-12-31T07:24:17.403

## [CFAbsoluteTimeGetCurrent()](https://developer.apple.com/library/mac/documentation/CoreFoundation/Reference/CFTimeUtils/#//apple_ref/c/func/CFAbsoluteTimeGetCurrent)

> 绝对时间以相对于绝对参考日期 2001 年 1 月 1 日 00:00:00 GMT 的秒数为单位测量。正值表示参考日期之后的日期，负值表示参考日期之前的日期。例如，绝对时间 -32940326 相当于 1999 年 12 月 16 日 17:54:34。重复调用此函数并不能保证结果单调递增。由于与外部时间参考同步或由于用户明确更改时钟，系统时间可能会减少。

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2016-12-28T04:49:13.557

这与@TristanLorach 发布的答案基本相同，只是为 Swift 3 重新编码：

```
 /// Method to get Unix-style time (Java variant), i.e., time since 1970 in milliseconds. This 
   /// copied from here: http://stackoverflow.com/a/24655601/253938 and here:
   /// http://stackoverflow.com/a/7885923/253938
   /// (This should give good performance according to this: 
   ///  http://stackoverflow.com/a/12020300/253938 )
   ///
   /// Note that it is possible that multiple calls to this method and computing the difference may 
   /// occasionally give problematic results, like an apparently negative interval or a major jump 
   /// forward in time. This is because system time occasionally gets updated due to synchronization 
   /// with a time source on the network (maybe "leap second"), or user setting the clock.
   public static func currentTimeMillis() -> Int64 {
      var darwinTime : timeval = timeval(tv_sec: 0, tv_usec: 0)
      gettimeofday(&darwinTime, nil)
      return (Int64(darwinTime.tv_sec) * 1000) + Int64(darwinTime.tv_usec / 1000)
   } 
```

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2015-12-02T14:16:40.090

试试这个 ：

```
NSDate * timestamp = [NSDate dateWithTimeIntervalSince1970:[[NSDate date] timeIntervalSince1970]];

NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];
[dateFormatter setDateFormat:@"YYYY-MM-dd HH:mm:ss.SSS"];

NSString *newDateString = [dateFormatter stringFromDate:timestamp];
timestamp = (NSDate*)newDateString; 
```

在此示例中，dateWithTimeIntervalSince1970 与格式化程序 @"YYYY-MM-dd HH:mm:ss.SSS" 结合使用，它将返回带有年、月、日的日期和带有小时、分钟、秒和毫秒的时间. 请参阅示例：“2015-12-02 04:43:15.008”。我使用 NSString 来确保格式之前已经写入。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2018-04-07T03:08:58.393

```
 func currentmicrotimeTimeMillis() -> Int64{
let nowDoublevaluseis = NSDate().timeIntervalSince1970
return Int64(nowDoublevaluseis*1000) 
```

}

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2019-04-25T07:12:29.870

```
let timeInMiliSecDate = Date()
let timeInMiliSec = Int (timeInMiliSecDate.timeIntervalSince1970 * 1000)
print(timeInMiliSec) 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2016-01-13T19:46:33.233

这是我用于 Swift 的

```
var date = NSDate()
let currentTime = Int64(date.timeIntervalSince1970 * 1000)

print("Time in milliseconds is \(currentTime)") 
```

使用此站点来验证准确性[http://currentmillis.com/](http://currentmillis.com/)

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2018-01-11T11:31:31.517

```
NSTimeInterval time = ([[NSDate date] timeIntervalSince1970]); //double
long digits = (long)time; //first 10 digits        
int decimalDigits = (int)(fmod(time, 1) * 1000); //3 missing digits
/*** long ***/
long timestamp = (digits * 1000) + decimalDigits;
/*** string ***/
NSString *timestampString = [NSString stringWithFormat:@"%ld%03d",digits ,decimalDigits]; 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2011-04-05T01:33:34.390

`[NSDate timeIntervalSinceReferenceDate]`是另一种选择，如果您不想包含 Quartz 框架。它返回一个双精度数，表示秒。

# c# - Can't Rebind FormView Control on Postback

> ID：358209
> 
> 赞同：0
> 
> 时间：2008-12-11T01:31:55.447
> 
> 标签：c#, asp.net, xml, data-binding, formview

Greetings!

I have a DropDownList within a FormView which are bound to XmlDataSources:

```
<asp:FormView ID="MyFormView" runat="server" DataSourceID="MyXmlDataSource">
    <ItemTemplate>
        <h1><%# XPath("SomeNode")%></h1>
        <asp:Label ID="MyLabel" runat="server" AssociatedControlID="MyDdl" Text='<%# XPath("SomeOtherNode")%>' />
        <asp:DropDownList ID="MyDdl"
                          runat="server"
                          DataSourceID="MyDdlDataSource"
                          DataTextField="name"
                          DataValueField="value"
                          AutoPostBack="true"
                          OnSelectedIndexChanged="MyDdl_SelectedIndexChanged">
        </asp:DropDownList>
    </ItemTemplate>
</asp:FormView>
<asp:XmlDataSource ID="MyXmlDataSource" runat="server" XPath="Root/MainSection" />
<asp:XmlDataSource ID="MyDdlDataSource" runat="server" XPath="Root/MainSection/Areas/*" /> 
```

In the page's codebehind, I have the following OnLoad() method as well as the method for getting the selected value dropdownlist during postback:

```
private m_key;

protected override void OnLoad(EventArgs e)
{
    base.OnLoad(e);

    string xml_data;
    if (!IsPostBack)
    {
        xml_data = GetMyXml(0); // default value
        MyXmlDataSource.Data = xml_data;
        MyDdlDataSource.Data = xml_data;
    }
    else
    {
        GetSelections();
        xml_data = GetMyXml(m_key);
        MyXmlDataSource.Data = xml_data;
        MyXmlDataSource.DataBind();
    }
}

private void GetSelections()
{
    DropDownList l_MyDdl = FindMyControl<DropDownList>("MyDdl");
    if (l_MyDdl != null)
        if (!Int32.TryParse(l_MyDdl.SelectedItem.Value, out m_key))
            m_key = 0;
} 
```

Everything works great, up until a postback as a result of the dropdown list changing occurs. When this happens, I get the value of the selected item in the dropdown list, pass it to my GetMyXml() method with the value from the dropdown list as a parameter and then set the FormView's datasource to the newly returned XML data from GetMyXml(). I've looked at the value of "xml_data" during postback and it's definitely correct. However, the values displayed on the page the FormView (like XPath("SomeNode")) are the values from before the postback happened and not the ones returned in xml_data. Why would this happen and how would I go about resolving it? Thanks in advance.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-29T16:00:41.983

为了自动重新绑定，您必须在该控件上启用 ViewState。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-03T06:43:50.953

```
formView.Databind();
this.page.databind(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-11T06:38:11.397

`MyFormView.DataBind()`之后你可以试试`MyXmlDataSource.DataBind();`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-12-04T21:07:09.300

当您使用 DataSource 对象时，您不必在后面的 coe 代码中进行任何手动数据绑定。实现数据源的 OnSelecting 事件并`GetSelections`在该方法中调用。

编辑：我在这里太快了。XmlDataSource 没有 OnSelecting 事件。它有一个 OnDataBind，但这里的事件参数只是一个标准`EventArg`，所以我不知道如何将 GetSelections 的结果绑定到它。对不起

# asp.net-mvc - Best practices to test Asp.net MVC applications

> ID：358210
> 
> 赞同：3
> 
> 时间：2008-12-11T01:32:00.860
> 
> 标签：asp.net-mvc, unit-testing, testing

Whats the best practice to test an Asp.net MVC application?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-11T01:42:58.387

选择你的测试框架——我推荐[xUnit.net](http://www.codeplex.com/ "xUnit.net")。

使用接口解耦类并在控制器中使用构造函数注入来满足依赖关系。在您的测试中，使用模拟框架将模拟传递给您的控制器 - 我推荐[MoQ](http://code.google.com/p/moq/)。

当运行网站而不是测试时，要么在你的控制器上使用默认构造函数来调用其他构造函数并传递你的接口的真实实现；或使用依赖注入 (DI) 容器自动完成 - 我推荐[StructureMap](http://structuremap.sourceforge.net/Default.htm)。

希望有帮助。

# asp.net-mvc - 模拟数据库调用 Asp.net MVC 应用程序

> ID：358213
> 
> 赞同：4
> 
> 时间：2008-12-11T01:34:04.413
> 
> 标签：asp.net-mvc, testing, mocking

如何模拟数据库调用以使我的应用程序逻辑在没有数据库的情况下进行测试？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-11T02:10:08.893

使用[存储库模式并使用](http://martinfowler.com/eaaCatalog/repository.html)[MoQ](http://code.google.com/p/moq/)等模拟框架在您的测试中对其进行模拟。

**编辑：**查看Stephen Walther 在 MoQ 上的[这篇文章](http://stephenwalther.com/blog/archive/2008/06/12/tdd-introduction-to-moq.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-11T04:49:49.900

具有硬编码实现的存储库模式或使用 XML 文件（我的偏好）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-11T01:51:59.680

```
procedure GetData (output arrayOfData)
  arrayOfData.record1.field1 = "dataA"
  arrayOfData.record1.field2 = "dataAB"
  arrayOfData.record2.field1 = "dataB"
  arrayOfData.record2.field2 = "dataBB"
  return arrayOfData)
end procedure 
```

然后调用 GetData 并使用您需要为您的逻辑定义的数据块。稍后，更改 GetData 以真正从数据库中获取数据。现在，只是伪造它，并手动为其分配合理的数据。

# language-agnostic - 你有没有遇到过三级间接的任何原因？

> ID：358220
> 
> 赞同：2
> 
> 时间：2008-12-11T01:40:02.310
> 
> 标签：language-agnostic, pointers, coding-style, indirection

只需浏览我最喜欢的一本书（Ellen Ullman 的 The Bug），就会发现一个程序员在三个间接级别上遇到另一个程序员：

```
***object_array = ***winarray; 
```

我得到了双重间接的想法——一种将指针传递给函数的方法，并允许它指向在函数中创建的对象。

但是你有没有遇到过使用三个（或更多）间接级别的理由？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-11T01:47:14.573

当然是
4 维数组。
这样一个数组的应用程序也不需要太多。说某种查找表。我有 8 个或更多维度的查找表。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-11T02:14:13.130

正如 David Wheele 所说：“计算机科学中的任何问题都可以通过另一层间接来解决。” 您几乎可以肯定地使用了三层间接，如下所示：

```
int x = 3; 
```

毕竟，芯片是通过两层 L1 和 L2 缓存来间接访问内存的。操作系统通过虚拟内存页间接访问内存。您的 C# 编译器通过虚拟机中的对象间接访问内存。当然，它并没有一长串的星号，但那是因为所有这些间接都被抽象为机器、操作系统或编译器之类的东西。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-11T02:19:27.660

您现在可能正在运行 3 个或更多级别。可以是 jQuery on javascript 在 Mac（或 VM）上通过远程访问在 Mac（或 VM）上运行的浏览器中运行的...。

或者，从更接近您问题上下文的另一个角度来看，3 个级别是我们拥有的最常见的工件。

指向 Window 中容器中控件的指针是什么？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-11T14:25:50.517

不，我实际上从未见过或使用过它（据我回忆，至少在没有合理的 typedef 以使其不那么令人毛骨悚然的情况下并非如此），但我可以设计一个可能是 [可疑] 有效用途的示例：

```
struct Foo{
    struct greater{
        bool operator()(Foo const *a, Foo const *b) const{
            return a->place > b->place ||
                   a->place == b->place && a->holder > b->holder;
        }
    };

    int place;
    int holder;
};

template<typename T, typename Comparer>
void Sort(T const *unorderedList, int count, T const ***orderedList, Comparer &cmp);

void UseOrderedList(Foo const **orderedList, int count);

int main(){
    Foo list[] = {{1, 2}, {3, 4}, {5, 6}, {7, 8}};
    Foo const **orderedList;

    Sort(list, sizeof list / sizeof *list, &orderedList, Foo::greater());
    UseOrderedList(orderedList, sizeof list / sizeof *list);
    delete[] orderedList;
    return 0;
}

void UseOrderedList(Foo const **orderedList, int count){/*...*/}

template<typename T, typename Comparer>
void Sort(T const *unorderedList, int count, T const ***orderedList, Comparer &cmp){
    /*
     * The result array stores pointers to the items in the original array.
     * This way, the original array is unmodified, and the result array
     * doesn't create duplicate items.  This makes sense if the objects
     * are large and copying them would be slow (another argument against
     * in-place sorting), or if duplicating them violates some design
     * principle.
     */
    *orderedList = new const T*[count];

    for(int i = 0; i < count; i++)
        (*orderedList)[i] = unorderedList + i;

    std::sort(*orderedList, &(*orderedList)[count], cmp);
} 
```

我实际上不会做我在这里做过的事情。这只是您如何最终获得三个指针级别的示例。不过，我无法想象你经常遇到这种情况。

# java - 每个日志条目带有时间戳的 log4j

> ID：358225
> 
> 赞同：61
> 
> 时间：2008-12-11T01:44:39.943
> 
> 标签：java, python, log4j, jython

这是我的日志输出

```
INFO main digestemails - process inbox
INFO main digestemails - checking for emails in c:\development\DCMail\email\KN-Source
INFO main digestemails - digesting 003d01c95a7b_3446880_0202fea9@xxxx.com.eml
INFO main digestemails - extracting attachments
INFO main digestemails - no attachments or no attachments supported
INFO main digestemails - updating database
INFO main digestemails - email -> COMPLETED folder
INFO main digestemails - 
```

我想要每条日志消息的时间戳，即

```
INFO 2008-12-25 13:14:00 digestemails - email -> COMPLETED folder 
```

这是我的 log4j 配置文件

```
log4j.rootLogger=debug, stdout, R

log4j.appender.stdout=org.apache.log4j.ConsoleAppender
log4j.appender.stdout.layout=org.apache.log4j.PatternLayout

# Pattern to output the caller's file name and line number.
log4j.appender.stdout.layout.ConversionPattern=%5p [%t] (%F:%L) - %m%n

log4j.appender.R=org.apache.log4j.RollingFileAppender
log4j.appender.R.File=c:\\development\\DCMail\\logs\\digestlogfolder\\digest-logfile.log

log4j.appender.R.MaxFileSize=100KB
# Keep one backup file
log4j.appender.R.MaxBackupIndex=1

log4j.appender.R.layout=org.apache.log4j.PatternLayout
log4j.appender.R.layout.ConversionPattern=%p %t %c - %m%n 
```

我该怎么做？

* * *

## 回答 #1

> 赞同：104
> 
> 时间：2008-12-11T01:59:03.067

`%d`在您的 PatternLayout 中使用。

也`%d`可以采用格式模式，因为`%d{dd MMM yyyy HH:mm:ss,SSS}`您可以选择所需的元素。当省略格式模式时，日期将采用 ISO8601 格式。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-12-11T07:45:42.073

我的属性文件的摘录

```
log4j.rootLogger=INFO, stdout, logfile

log4j.appender.stdout=org.apache.log4j.ConsoleAppender
log4j.appender.stdout.layout=org.apache.log4j.PatternLayout
log4j.appender.stdout.layout.ConversionPattern=%d %p (%t) [%c] - %m%n

log4j.appender.logfile=org.apache.log4j.RollingFileAppender
log4j.appender.logfile.File=C:/log/client.log
log4j.appender.logfile.MaxFileSize=5MB
log4j.appender.logfile.MaxBackupIndex=0
log4j.appender.logfile.layout=org.apache.log4j.PatternLayout
log4j.appender.logfile.layout.ConversionPattern=%d %p [%c] - %m%n 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-12-11T03:29:46.190

您可以在 log4j javadoc 中找到更多转换字符的用法。例如，在[http://logging.apache.org/log4j/1.2/apidocs/org/apache/log4j/PatternLayout.html](http://logging.apache.org/log4j/1.2/apidocs/org/apache/log4j/PatternLayout.html)。

# jquery - jQuery：我可以用 $('.superset').$('.within') 代替 $('.within', $('.superset')) 吗？

> ID：358230
> 
> 赞同：1
> 
> 时间：2008-12-11T01:48:29.313
> 
> 标签：jquery, css-selectors

可以扩展 jQuery 以便我可以使用上述语法吗？

我不知道如何对 $() 返回的东西进行原型制作，以便我可以调用 $().$()

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-11T01:50:22.397

您可以使用[`find()`](http://docs.jquery.com/Traversing/find)

例如：`$('.superset').find('.within');`

或者更简单，`$('.superset .within');`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-16T20:25:38.413

> 可以扩展 jQuery 以便我可以使用上述语法吗？

是的！

```
$.fn.$ = $.fn.find; 
```

现在你可以使用`.$()`

# java - 用于存储单词列表的节省空间的数据结构？

> ID：358240
> 
> 赞同：6
> 
> 时间：2008-12-11T01:54:52.093
> 
> 标签：java, data-structures

在这种情况下，还有什么比[Trie更好的吗？](http://en.wikipedia.org/wiki/Trie)

*   存储约 10 万个英语单词的列表
*   需要使用最少的内存
*   查找需要合理，但不必快如闪电

我正在使用 Java，所以我的第一次尝试是只使用 Set<String>。但是，我的目标是移动设备并且内存已经不足。由于许多英语单词都有共同的前缀，因此 trie 似乎是节省一些记忆的不错选择——有人知道其他一些好的选择吗？

编辑 - 更多信息 - 数据结构将用于两个操作

*   回答：列表中是否有某个单词 XYZ？
*   用一个不同的字母生成围绕 XYZ 的单词邻域

谢谢你的好建议

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-11T02:26:03.310

我看到的一种用于最小化拼写词典中空间的结构是将每个单词编码为：

*   与最后一个共同的字符数（一个字节）；和
*   新的结局。

所以单词列表

```
HERE            would encode as    THIS
sanctimonious                      0,sanctimonious
sanction                           6,on
sanguine                           3,guine
trivial                            0,trivial 
```

你在那里直接节省了 7 个字节（19%），我怀疑这对于 20,000 个单词的字典来说是相似的，只是因为相邻单词（公共前缀）之间的最小距离。

例如，我在一个排序的字典上运行了一个测试程序，并将旧存储空间计算为单词长度加一（用于终止符），并将新存储空间计算为公共长度、不常见后缀长度和终止符长度。这是该测试程序的最后一部分，表明您可以超过 50%：

```
zwiebacks   -> zygote      common=        old=1044662 new=469762 55.0%
zygote      -> zygotes     common=zygote  old=1044670 new=469765 55.0%
zygotes     -> zygotic     common=zygot   old=1044678 new=469769 55.0%
zygotic     -> zymase      common=zy      old=1044685 new=469775 55.0%
zymase      -> zymogenic   common=zym     old=1044695 new=469783 55.0%
zymogenic   -> zymology    common=zymo    old=1044704 new=469789 55.0%
zymology    -> zymolysis   common=zymol   old=1044714 new=469795 55.0%
zymolysis   -> zymoplastic common=zymo    old=1044726 new=469804 55.0%
zymoplastic -> zymoscope   common=zymo    old=1044736 new=469811 55.0%
zymoscope   -> zymurgy     common=zym     old=1044744 new=469817 55.0%
zymurgy     -> zyzzyva     common=zy      old=1044752 new=469824 55.0%
zyzzyva     -> zyzzyvas    common=zyzzyva old=1044761 new=469827 55.0% 
```

为了加快查找速度，内存中有一个包含 26 个条目的表，用于保存以 a、b、c、...、z 开头的单词的起始偏移量。这些偏移量处的单词总是以 0 作为第一个字节，因为它们与前一个单词没有相同的字母。

这似乎是一种 trie 但没有指针，如果树中的每个字符都有一个与之关联的 4 字节指针，这肯定会占用空间。

请注意，这是从我的 CP/M 时代开始的，那时记忆比现在少得多。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-11T03:35:29.970

Patricia trie 可能更合适：

[http://en.wikipedia.org/wiki/Patricia_tree](http://en.wikipedia.org/wiki/Patricia_tree)

我的（模糊）记忆告诉我，一些早期的全文搜索引擎中使用过……

保罗。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-11T02:05:58.373

你在做什么？如果是拼写检查，您可以使用布隆过滤器 - 请参阅此[代码 kata](http://codekata.pragprog.com/2007/01/kata_five_bloom.html)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-11T02:05:41.853

您仍然必须使用 Trie 维护树结构本身。[Huffman 编码](http://en.wikipedia.org/wiki/Huffman_coding)字母表或 N 字母（对于“tion”、“un”、“ing”等常见形式）可以利用字典中的出现频率并将条目压缩为位。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-11T04:17:01.807

完全疯狂的想法......（即很可能是非常错误的）

将单词存储为所有可能的字母组合的树怎么样？

然后每个“单词”只花费一个字符和两个指针（一个指向字符，一个指向终止符）。这样，它们共有的字母越多，每个单词的成本就越少。

```
 . .
     / /
    r-p-s-.
   /\\
  a  \s-.
 /    t-.
c      \
        s-. 
```

汽车 鲤鱼 鲤鱼 汽车 推车 推车

因此，对于 9 个字符和 14 个指针，我们得到 6 个“单词”，总共 25 个字母。

搜索会很快（指针查找而不是字符比较），您可以进行一些词干优化以节省更多空间......？

编辑：看起来我重新发明了轮子。;-)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-12T14:58:20.613

与保罗的帖子相关：

有什么理由不能在您的情况下考虑使用 Trie 吗？如果这只是一个实现问题，这里是 Patricia trie 在 C 中插入和搜索的紧密实现（来自 NIST）：

[帕特里夏插入 C](http://www.dcc.uchile.cl/~rbaeza/handbook/algs/3/3445.ins.c)

[C语言中的帕特里夏搜索](http://www.dcc.uchile.cl/~rbaeza/handbook/algs/3/3445.srch.c)

# django - 将 Django 站点转储为静态 HTML？

> ID：358245
> 
> 赞同：25
> 
> 时间：2008-12-11T01:56:52.103
> 
> 标签：django, hosting

我已经确定我当地的网络托管公司不能支持 Django。

*   他们运行 Python 2.2。
*   不支持`mod_python`、FastCGI 或 SCGI。
*   不支持`mod_rewrite`.

其中任何一项都会阻止我在该托管服务上将我的网站部署为 Django 应用程序。

我意识到我的网站基本上是静态的。我想知道是否可以将 Django 缓存用于文件系统，并部署该缓存中的内容。或者`wget`用于递归捕获我在 localhost 上运行的站点。有人做过这种手术吗？有可能吗，值得付出努力吗？

我意识到我至少有两个其他选择：

*   使用 PHP CMS 解决方案。
*   将我的域切换到另一个托管服务。

**编辑：**谢谢大家的建议！我已经向我的托管服务提供商发送了一封电子邮件，让他们有机会为我提供升级服务。如果他们无法通过，我将[WebFaction](http://www.webfaction.com/)视为提供者。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-12-11T04:10:10.167

Django 的 StaticGenerator 就是你想要的。它旨在拉取 Django 视图并将它们保存为静态 HTML 文件。这就是我发布我的网站 ( [http://nedbatchelder.com](http://nedbatchelder.com) ) 的方式。

更新：原始链接消失了，但包在 PyPI 上：http: [//pypi.python.org/pypi/staticgenerator](http://pypi.python.org/pypi/staticgenerator)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-12-11T02:26:28.143

[带有“-m”（镜像）开关的Wget](http://en.wikipedia.org/wiki/Wget)可能是您正在寻找的。这样做的“更干净”的方法可能是只获取通常由上下文处理器传递的所有内容，然后手动将其组合到您的模板中。

顺便说一句，这真是太糟糕了，伙计。Django 的动态特性是它如此伟大的重要组成部分。如果您不打算使用荒谬的传输量（假设 > 10 GB），我可能会免费托管您。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-09-16T20:39:23.613

我的项目[Cactus](http://github.com/koenbok/Cactus)允许您使用 django 构建静态站点。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-11T02:09:53.263

我曾多次使用[http://www.httrack.com/](http://www.httrack.com/)将动态网站翻录成静态 html，总体来说还不错。

如果您有类似 Dreamweaver 之类的工具可以在完成后检查所有链接，这很有帮助，但这取决于它有多大。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-11T02:05:54.910

我会说切换到另一个托管服务。实际上有一个支持 Django 并提供免费托管包的[法国托管服务（但您只能获得 10 MB）。](http://www.alwaysdata.com/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-11T02:11:37.003

[Wget](http://en.wikipedia.org/wiki/Wget)有一个递归镜像选项......只是谷歌的 Wget 镜像。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-11T04:26:49.900

要么使用 PHP CMS 解决方案，要么获得新主机。为什么复杂的事情更进一步？（真正的问题是你为什么要使用 Django（或任何框架）作为一个主要是静态的站点？）

# c# - 有谁知道如何在 C# 中从已经运行的 cctray 进程中监听构建事件？

> ID：358251
> 
> 赞同：1
> 
> 时间：2008-12-11T02:02:09.037
> 
> 标签：c#, events, triggers, cruisecontrol.net, cctray

我已经制作了一个 C# 应用程序，我想知道是否可以利用 cctray（巡航控制托盘）的构建事件？我不想重新发明轮子，我只想知道我的构建何时失败或成功（在客户端计算机上），以便我的自定义 C# 应用程序可以执行一组特定的例程。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-11T16:29:10.643

您可以将 CruiseControl 远程库添加为引用并创建 CruiseManagerFactory 的实例，此行将为您提供所有项目的状态。ServerUri 是一个字符串，格式为 tcp://ServerName:Port/CruiseManager.rem

```
ProjectStatus[] currentStatuses = managerFactory.GetCruiseManager(ServerUri).GetProjectStatus(); 
```

在此示例中，我显然将 CruiseManagerFactory 实例命名为 managerFactory。ProjectStatus 数组则具有 ServerUri 地址处所有项目的当前状态。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2008-12-11T06:37:19.277

为什么你不能使用你的构建工具来做到这一点？
例如，在[Nant中，您可以使用](http://nant.sourceforge.net/)[nant.onfailure 和 nant.onsuccess 属性](http://nant.sourceforge.net/release/0.85/help/fundamentals/properties.html#built-in-properties)指定构建失败或成功时要执行的目标。在构建目标中，您可以通过执行任务调用您的 C# 应用程序。
CruiseControl 有[onSuccess 和 onFailure 发布](http://cruisecontrol.sourceforge.net/main/configxml.html)者……但奇怪的是在 CruiseControl.net 中找不到它们。

# asp.net-mvc - ASP.NET MVC 升级到 Beta：IControllerFactory 定义在未引用的程序集中

> ID：358260
> 
> 赞同：3
> 
> 时间：2008-12-11T02:08:23.797
> 
> 标签：asp.net-mvc, castle-windsor, upgrade, asp.net-mvc-beta1

我目前正在将站点从 ASP.NET MVC 预览版 2 更新到 Beta 版。经过详尽的搜索，我遇到了最后一个编译错误，但在站点中没有解决方案。我在 Global.asax.cs 中有一些代码使用 Windsor 容器设置 IOC：

```
ControllerBuilder.Current.SetControllerFactory(typeof(WindsorControllerFactory)); 
```

编译器抱怨：

```
The type 'System.Web.Mvc.IControllerFactory' is defined in an assembly that is not referenced. 
You must add a reference to assembly 'System.Web.Mvc, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null'. 
```

奇怪的是这个程序集**被**引用了。我从 MVC beta 程序集文件夹中引用它并设置为复制本地。我什至可以删除 bin 目录，重建，然后在反射器中查看程序集并查看界面。我尝试删除并重新添加引用，更改 web.config 的程序集和命名空间部分。我什至从 GAC 中删除了 System.Web.Mvc，以确保它使用的是正确的副本。

在写这个问题时，我想到温莎可能在内部期待旧版本的程序集。我正在从 MvcContrib 下载最新版本以确定这是否是问题所在，我将发布结果。如果是这种情况，程序集的版本号不应该随着最新版本而改变以使这一点显而易见吗？

感谢阅读，布雷特

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-11T02:27:11.170

PublicKeyToken=null 似乎不对...

**编辑：**我是对的，PublicKeyToken 应该是“31bf3856ad364e35”。听起来它们与未签名的 System.Web.Mvc.dll 的私有构建相关联。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-11T02:16:28.320

检查您是否已在 web.config 文件中更新了对 3.5.0.0 的相应程序集引用，如 Beta 版更新说明中所述。

# php - 是否可以重定向帖子数据？

> ID：358263
> 
> 赞同：61
> 
> 时间：2008-12-11T02:10:07.070
> 
> 标签：php, apache, .htaccess

我有一个网站，所有请求都被静默（通过`.htaccess`）重定向到`index.php`，然后 PHP 用于显示正确的页面（通过解析`REQUEST_URI`）。

我想知道是否也可以将 POST 数据提交到假地址？

我目前的表格是这样的......

```
<form action="/send-mail" method="post"> 
```

而我的`.htaccess`规则是...

```
# redirect mail posting to index
RewriteRule send-mail index.php?send-mail [NC,L] 
```

我的`index.php`支票`isset($_GET['send-mail'])`工作正常。

然而，这似乎丢弃了所有应该发送给它的 POST 数据。

有没有办法保留帖子数据？我不想使用 GET，因为它无法发送尽可能多的信息，尽管它可能不是简单的查询表单的问题。

这是我`.htaccess`的重定向到`index.php`

```
# serve files and dirs if they exist please, otherwise send to index
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule . index.php 
```

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2008-12-11T02:57:41.793

试试这个：

```
# redirect mail posting to index
     RewriteRule send-mail index.php?send-mail [NC,P] 
```

“P”的作用类似于“L”，它停止处理规则，但它也告诉模块该请求应该原封不动地传递给代理模块（意味着保留 POST 数据）。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-12-11T03:04:45.757

您应该能够简单地重定向到`index.php`，然后在该脚本中访问`$_SERVER['REQUEST_URI']`以查看原始请求，并且“发送邮件”完好无损。

顺便说一句，“不能发送尽可能多的信息”不是使用 POST 的原因。使用 POST 的原因是该请求将修改您网站上的数据，而不是简单地检索数据。

假设您在您的页面上放置了一个超链接，其中包含像“ `/delete_user?id=1234`,”这样的 GET 请求，然后某个搜索引擎在为您的网站编制索引时无辜地跟踪该链接。这就是为什么 GET 请求不适用于修改数据的请求。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2021-07-27T15:32:51.153

我发现最可靠的方法是使用`307`状态码。

`RewriteRule send-mail index.php?send-mail [R=307,L]`

状态码 307 表示应使用相同的 HTTP 方法和数据重复请求。因此`POST`，如果您使用此状态代码，您的请求将与其数据一起重复。

您可以检测请求是否为`POST`请求，以防您需要支持非请求的标准`301`重定向。`POST`

```
# POST requests.
RewriteCond %{REQUEST_METHOD} POST
RewriteRule send-mail index.php?send-mail [R=307,L]

# Standard GET requests.
RewriteRule send-mail index.php?send-mail [R=301,L] 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-12-04T23:42:01.720

为避免某些代理和 Apache 重写出现问题，请传入`POST`数据或`Content-Length: 0`为具有空正文的请求设置标头。

我最近遇到了 Apache 将我的请求转换为 a`GET`时`POST`使用空正文的问题。所以，而不是这个：

```
 curl -X POST https://example.com/api/user/123456789 
```

传递`Content-Length`标题：

```
 curl -X POST https://example.com/api/user/123456789 -H 'Content-Length: 0' 
```

或在体内传递一些东西：

```
 curl -X POST https://example.com/api/user/123456789 -d '' 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-11T02:59:59.217

只要您只使用内部重写，而不是 HTTP 重定向，就不应丢失 POST 数据。这是我在我的网站上使用的规则：

```
RewriteRule ^(.*)$ index.php/$1 [L] 
```

尝试使用 Firefox 的 HTTPLiveHeaders 扩展（或类似的东西）并跟踪整个页面请求。确保您没有收到 HTTP 重定向。如果您收到**HTTP/1.1 3xx**响应和**Location: *[http://address](http://address)***标头，那就是问题所在。您发布的重写规则不应导致这种情况发生。如果您被重定向，则可能是您的 PHP 代码中存在错误或正在应用另一个重写规则。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-02-27T13:08:04.010

我想将 user_login.php 重定向到 seo 友好的 url，如 /user-login 和发布表单数据，这对我有用。

```
RewriteCond %{THE_REQUEST} ^[A-Z]{3,}\s/user_login\.php [NC]
RewriteRule ^ user-login [QSA,R=301]
RewriteRule ^user-login$ user_login.php [QSA,L] 
```

在视图文件中

```
<form action="<?php $siteurl;?>/user-login" method="post" id="user_login"> 
```

# c# - 如何从 C# 中加载的 SSIS 包中捕获事件？

> ID：358273
> 
> 赞同：2
> 
> 时间：2008-12-11T02:18:54.133
> 
> 标签：c#, sql-server, database, ssis, dts

我有一个执行多个任务的 SSIS 包。我在 Business Intelligence Studio 2005 中为 OnExecStatusChanged 事件在包级别手动添加了一个事件处理程序。

我的问题是，如何在 C# 中为此事件添加处理程序？我已经加载了[这里](http://msdn.microsoft.com/en-us/library/microsoft.sqlserver.dts.runtime.application.loadfromsqlserver.aspx)指出的包，我还创建了一个继承自 Microsoft.SqlServer.Dts.Runtime.DefaultEvents 的自定义类，这是我的“监听器”：

```
 Microsoft.SqlServer.Dts.Runtime.SqlPackageEventListener sqlListener = new SqlPackageEventListener();
    Microsoft.SqlServer.Dts.Runtime.Application sqlPackageLoader = new Application();
    Microsoft.SqlServer.Dts.Runtime.Package sqlPackage = sqlPackageLoader.LoadPackage(@"path\MigrateData.dtsx", sqlListener);
    sqlPackage.Execute(null, null, sqlListener, null, null); 
```

如果我检查 sqlPackage.EventHandlers.Count 属性，我会得到在 Business Intelligence Studio 中添加的处理程序的正确编号。

有没有办法在 C# 中处理这些事件？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-12T00:35:29.070

好吧，我没有找到任何东西，所以我想出了一个解决方法，所以我会自动回复我：

由于无法直接捕获 SSIS 包产生的事件，因此我在[侦听](http://msdn.microsoft.com/en-us/library/ms136090.aspx)器中实现了自己的事件：

```
public class SqlPackageEventListener : DefaultEvents
{
    public SqlPackageChangedHandler OnPackageError;

    public override bool OnError(DtsObject source, int errorCode, string subComponent, string description, string helpFile, int helpContext, string idofInterfaceWithError) {
        OnPackageError(this, new PackageErrorEventArgs(source, subComponent, description));
        return base.OnError(source, errorCode, subComponent, description, helpFile, helpContext, idofInterfaceWithError);
    }

    public delegate void SqlPackageChangedHandler(
        object sqlPackage,
        EventArgs packageInfo
        );
}

public class PackageErrorEventArgs : EventArgs 
{
    private DtsObject source;
    public DtsObject Source {
        get { return source; }
        set { source = value; }
    }

    private string subcomponent;
    public string Subcomponent {
        get { return subcomponent; }
        set { subcomponent = value; }
    }

    private string description;
    public string Description {
        get { return description; }
        set { description = value; }
    }

    public PackageErrorEventArgs(DtsObject source, string subcomponent, string description) {
        this.description = description;
        this.source = source;
        this.subcomponent = subcomponent;
    }
}

public class Test 
{
    SqlPackageEventListener sqlListener = new SqlPackageEventListener();
    sqlListener.OnPackageError += new SqlPackageEventListener.SqlPackageChangedHandler(sqlListener_OnPackageError);
    Microsoft.SqlServer.Dts.Runtime.Application sqlPackageLoader = new Microsoft.SqlServer.Dts.Runtime.Application();
    Microsoft.SqlServer.Dts.Runtime.Package sqlPackage = Microsoft.SqlServer.Dts.Runtime.sqlPackageLoader.LoadPackage(@"path_to\file.dtsx", sqlListener);
    sqlPackage.Execute(null, null, sqlListener, null, null)

    public void sqlListener_OnPackageError(object sender, EventArgs args) {
        //code to handle the event
    }
} 
```

因此，“技巧”是将委托添加到您传递给 Package 对象的 LoadPackage 方法的“侦听器”对象，这样，我们可以访问侦听器内部的“OnError”覆盖并引发事件。如您所见，我实现了自己的 EventArguments 类，因此我们可以将重要数据传递给我们的处理程序代码，并查看正在运行的包或从 DefaultEvents 继承时通过覆盖方法可以获得的任何其他信息。

当然，我在这里只实现了 OnError，您可以实现 SQL Server 支持的任何其他您喜欢的处理程序，并且可以覆盖，因为这是我们引发事件的范围。

这样，我可以创建我的 SqlPackageEventListener 对象并使用 sqlListener_OnPackageError 方法处理它的“OnPackageError”事件，并在 SSIS 包的执行导致任何错误的情况下做任何我需要的事情。

# sql - 将具有特定前缀的表移动到新数据库

> ID：358278
> 
> 赞同：0
> 
> 时间：2008-12-11T02:22:49.307
> 
> 标签：sql

我在 sql server 数据库中有一堆表（所有表都带有特定前缀，例如 ABC_table1），我想将所有带有此前缀的表移动到另一个数据库。

有没有办法可以做到这一点？

我正在使用 SQL Server 2k5。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-11T02:55:20.443

找出 ABC 模式的 uid：

```
SELECT * from sys.schemas 
```

然后将 schema_id 替换为下面脚本中的 5（uid）并运行它：

```
SELECT 
    'SELECT * INTO OtherDB.ABC.' + name +
    ' FROM ABC.' + name
FROM 
    sysobjects 
WHERE 
    xtype = 'U' 
    AND uid = 5 
```

然后剪切并粘贴生成的结果并运行它。或者，创建一个游标并 sp_execute 每一行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-11T03:07:03.383

不确定 2k5 中的术语有多少变化，但这里是 2k 术语中的说明。只需创建新数据库并从旧数据库导出到新数据库。在导出向导中，您要传输对象和数据。选择“对象”时，选择所有以 ABC_ 开头的表，这很容易，因为它们是按字母顺序列出的。然后导出。

除非这是您想要定期执行的操作（我不明白为什么），否则我认为这可能是一次性操作的最简单解决方案。

# sql-server - 在存储过程中，如何获取 SQL Server 2005 中存储过程的名称？

> ID：358285
> 
> 赞同：0
> 
> 时间：2008-12-11T02:28:24.770
> 
> 标签：sql-server

我想动态获取当前存储过程的名称以用于记录目的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-11T02:46:22.363

试试这个：

```
OBJECT_NAME(@@PROCID) 
```

# testing - 帮助测试人员的最佳方法是什么？

> ID：358291
> 
> 赞同：3
> 
> 时间：2008-12-11T02:33:09.987
> 
> 标签：testing

我的公司很小，只有一名全职测试员，而且我们大部分时间都在做网络应用程序。所以我很高兴我们有测试人员，因为我认为在调试我自己的代码时我可能会偏心或懒惰......

而且我们的测试人员实际上位于另一个国家/地区，因此通常我们仅通过 IM 或电子邮件进行交流。通常我会尝试尽可能多地进行白盒测试，但有时由于时间紧迫，我需要同时处理一些东西，这就是我在后期测试中变得相当懒惰的地方...... :(

目前我们通常做的是提供一些文档，说明功能应该是什么样的，希望他们有足够的信息来打破那些不能正常工作的东西。

有时我还包括关于我已经完成的一些测试的信息或测试用例，并且还包括一些基于我希望她明确测试的潜在错误代码逻辑的测试。

无论她发现什么，她都会登录我们的 bugzilla，我会继续检查、修复并让她再次验证。

所以我的问题是你有什么好的提示或更好的方法，以便我们可以更好地帮助我们的测试人员找到更多的错误？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-11T02:40:24.637

由于您的测试人员在另一个国家/地区，并且在您将某些内容传递给您的测试人员和您的测试人员返回结果之间会有一些滞后时间，我认为您自己做很多质量保证以确保您的代码是很重要的是

1.  功能齐全
2.  处理输入错误等基本问题

这样您就不会浪费测试人员的时间和您自己的时间来处理甚至不应该进入测试阶段的错误。希望，因为您将与测试人员密切合作，测试人员将了解您的标准错误并能够快速测试这些东西，并希望他们能够传递他们认为常见的问题，以便类似的错误不要一直弹出。我认为这里的关键是沟通，以确保您不会浪费任何时间一遍又一遍地修复同一件事。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-11T02:45:33.143

独立测试人员的*巨大好处之一是她将发明我们作为开发人员永远不会考虑的场景。*所以很大程度上取决于她对系统和用户的理解，以及她的创造力。

我尝试通过以下方式帮助我们的测试人员：

1.  告诉他们我改变了什么，系统的其他部分可能会受到影响，

2.  确保他们了解客户要求，因此他们知道系统*应该*如何工作，

3.  要求对他们的*主观*观察提供反馈（这太难了……；花费太长时间……；屏幕很丑，因为……），以及

4.  鼓励他们在验证系统按照“预期”输入应有的方式工作后，找到创造性的方法来*破坏系统。*

此外，如果您在不同的时区工作，请利用这一点，在您离开一天之前提供尽可能多的更新、修复*等*，这样她就可以在您睡觉的时候工作。

请记住，验证有两个部分：

1.  系统*应该*做它应该做的事情，并且

2.  它*不应该*做它*不*应该做的事！

祝你好运！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-11T02:54:23.877

听起来您已经在做两件重要的事情：

1.  你最好找到自己的缺陷。（虽然听起来你没有使用任何自动化单元测试，这可能会在这方面有所帮助）
2.  重视从测试中获得的反馈。

我会推荐另外两件事。

1.  你们都需要清楚地定义需要做什么。
2.  定期提供完整的功能。

这是一个平衡点：

A. 提供版本说明，清楚说明所做的工作

B. 定期发布并引入增量功能。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-11T04:43:01.380

我自己实际上是一名测试人员。我从我们的开发者那里得到的最好的帮助就是我们所说的快乐路径测试。这基本上是在告诉我程序是否根据技术要求完全按照它应该运行的方式运行。

例如，如果您有一个 hello world 应用程序，如果您单击标签上写着 hello 的按钮，您会准确地说 Click button label text with be Hello。

我们还让我们的开发人员将他们记录在案的单元测试传递给我，然后我只是让测试比他们更广泛。这是一个很大的帮助。我们的单元测试将始终回答这四个基本问题，谁在什么时候做什么以及如何做。谁做的改变。改变了什么。现在如何运作。当它被改变。

及时回答问题并将所有信息提前提供给测试人员也很棒。我讨厌开发人员给我一个应用程序，然后说“你准备好测试了”。这是最糟糕的情况，因为我不知道它是什么，也不知道它应该如何运作。

如果您向测试人员提供此信息，他们将能够找到真正的错误和可能遗漏的需求。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-11T04:52:58.987

让他失业！当然，你不能那样做，但你应该有一个好的、快速的自动化测试套件，这样他就可以专注于那些无法自动化的事情。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-12-11T04:34:07.967

在某些情况下不帮助测试人员不是更好吗？当所有用户运行你的程序时，你会在场帮助他们吗？

# html - 为什么文本在带有浮动的图像内部流动：左；不包装？

> ID：358297
> 
> 赞同：1
> 
> 时间：2008-12-11T02:39:15.920
> 
> 标签：html, css, css-float

我有以下 HTML

```
<div>
    <img id="image1"
         src="http://valleywag.com/assets/resources/2008/03/BlackGoogleLogo.jpg" 
         alt="Why doesn't this float correcly?"
         style="border-width: 0px; float: left;" />
    <div id="divText" style="font-family: Arial, Helvetica, sans-serif; font-size: 11px;"
          class="txt-Normal">
        <div style="background-color: Green; color: White;">
            <p>
                <strong><span style="font-size: xx-large;">This is going to be big title</span></strong>
            </p>
            <ul>
                <li>
                    <span style="font-size: small;">Foo</span>
                </li>
                <li>
                    <span style="font-size: small;">Bar</span>
                </li>
                <li>
                    <span style="font-size: small;">FooBar</span>
                </li>
                <li>
                    <span style="font-size: small;">BarFoo</span>
                </li>
            </ul>
        </div>
    </div>
</div> 
```

文本不会在图像周围浮动。不管是浏览器IE还是Firefox。

如何解决此问题以在图像周围浮动？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-11T03:17:35.390

如果您正在谈论与图像重叠的项目符号，您可以增加`margin-right`图像上的 ，或将列表更改为`list-style-position: inside`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-11T03:12:06.227

在 IE6 和 FireFox2 中，文本确实漂浮在图像周围。您是否有任何 CSS 留给我们测试？

这是我看到的：

[示例 1 http://img214.imageshack.us/img214/6906/ff2topie6bottomhz5.gif](http://img214.imageshack.us/img214/6906/ff2topie6bottomhz5.gif)

*您提供的*HTML 示例在 HTML 文档中，对吗？如果是这样，您使用的是什么文档类型？

如果您试图使所有文本与图像的右侧对齐，您可能还需要将文本的容器向左浮动。这将产生如下输出：

[两个元素都浮动 http://img518.imageshack.us/img518/4619/bothfloatedsd7.gif](http://img518.imageshack.us/img518/4619/bothfloatedsd7.gif)

您可以通过像这样修改代码来做到这一点：

```
<div id="divText" style="font-family: Arial, Helvetica, sans-serif; font-size: 11px; float:left;" class="txt-Normal"> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-11T03:51:49.657

`<ul>`在标签中试试这个

```
style="margin-top: 70px" 
```

[![替代文字](https://i.stack.imgur.com/n5Kh8.png)](https://i.stack.imgur.com/n5Kh8.png)

我只有 IE6，因为我在 xp 上，我想 ie7 会比 6 更好（我们至少可以希望）。旧 IE 版本笨拙地处理块级元素，新版本更好。块级元素应该有自己的整行，就像`<p>`标签一样。如果您想查看哪些标签是块级别的，您可以将此行放在您的 CSS 中以快速达到峰值：

```
* {
border: 1px solid black;
} 
```

或者下载 Firefox 的[Web Developer](https://addons.mozilla.org/firefox/addon/60)插件，它有一堆漂亮的工具，并且它有一个内置的“突出显示块级元素”功能，它在你的元素周围放置不同颜色的边框。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-11T02:46:18.400

文本在 Firefox2 中为我环绕图像。您能否发布屏幕截图以便我更好地理解问题？

如果您的意思是项目符号与图像重叠（我确实注意到了），那么我可以建议的最好的方法是在图像上的边距或禁用项目符号样式：

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-11T02:47:19.180

我猜这是因为列表标记出现在边距中，所以边距正在折叠。

您可以尝试使用`<ul style="margin-left: 291px;">`.

# flowchart - Windows 上的流程图 好用的免费软件？

> ID：358304
> 
> 赞同：37
> 
> 时间：2008-12-11T02:41:55.867
> 
> 标签：flowchart

我必须在周五的工作中介绍一些应用程序的“过程”或“流程”。我希望在开始演示之前准备一个流程图。

关于免费软件 sw 在 Windows 上制作简单流程图的任何建议？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2010-11-16T21:52:03.920

找到此线程后尝试了[yEd 。](http://www.yworks.com/en/index.html)这个棒极了。没有更好的，免费的。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2008-12-11T02:53:20.507

[迪亚](http://live.gnome.org/Dia)可能值得一看。

> 它可以用来绘制许多不同类型的图表。它目前有特殊的对象来帮助绘制实体关系图、UML 图、流程图、网络图和许多其他图表。也可以通过编写简单的 XML 文件来添加对新形状的支持，使用 SVG 的子集来绘制形状。

这是一个[下载页面](http://dia-installer.de/)。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2010-06-19T18:00:28.257

我使用[了draw.io](https://www.draw.io)，它非常好。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-12-11T04:17:08.420

使用[GraphViz](http://www.graphviz.org/)。它的核心是一种描述语言，可以自动生成像样的图形。另一个答案推荐 Dia... Dia 是一个生成 GraphViz .dot 文件的 GUI 工具。如果您想要全面的布局控制（流程图通常不需要），请使用 Dia. 如果您只想要自己产生合理布局的东西，请直接使用 GraphViz。

作为一个额外的好处，GraphViz 可以与许多 wiki 包一起作为插件使用……Confluence、MediWiki、Trac，对于初学者来说。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-10-18T07:03:03.903

[可爱的图表](http://www.lovelycharts.com/)- 在线解决方案。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2010-06-08T04:28:20.897

[自此问题得到解答后， Google 绘图](http://google.com/google-d-s/drawings/)已发布。它有几个内置的流程图模板，或者查看模板以找到一些更精细的流程图元素，您可以将它们复制粘贴到文档中。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2014-03-18T12:26:28.197

[code2flow](http://code2flow.com)是流程图生成器的在线伪代码，只需单击图像即可使用它：

[![码流](https://i.stack.imgur.com/0DmM2.png)](http://code2flow.com)

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2013-03-03T15:28:56.780

[Bizagi](http://www.bizagi.com/index.php?option=com_content&view=article&id=95&Itemid=107&lang=en) Process Modeler 是一款功能丰富的免费软件。仅适用于 Windows

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2014-02-28T07:12:59.643

试试这个：

[http://www.nchsoftware.com/chart/](http://www.nchsoftware.com/chart/)

简单...免费...大小小于 1MB。它做得很好。我很喜欢它。试试看。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-11T02:57:24.167

如果您有 Microsoft Word 或 Excel，您可以选择插入|形状|流程图来创建流程图。我知道它不是免费的，但如果您已经拥有 Microsoft Office，它可能是一种选择。

# algorithm - 随机播放列表（带有重复项）以避免相同的元素彼此相邻

> ID：358307
> 
> 赞同：3
> 
> 时间：2008-12-11T02:43:14.007
> 
> 标签：algorithm, language-agnostic, shuffle

我想知道是否有一种“最佳”方法来洗牌包含重复项的元素列表，以便尽可能避免 array[i] == array[i+1] 的情况。

我正在研究加权广告展示（我可以为任何给定的广告商调整每次旋转的展示次数），并希望避免同一广告商连续出现两次。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-11T02:53:38.823

[这与这个问题](https://stackoverflow.com/questions/344860/good-algorithm-for-combining-items-from-n-lists-into-one-with-balanced-distribu)非常相似。如果您将上面给出的示例中的 A、B 和 C 替换为您的广告客户，我认为您会遇到同样的问题。也许为此建议的一些解决方案可以帮助您。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-11T03:03:15.107

基本随机化应该在一个大集合中引起足够的分散。

如果您想进一步减少它（根据集合甚至可能不需要），最简单的方法是在随机化后肯定找到靠近的骗子并移动它们（但您可能会创建模式）。更好的方法可能是创建包含并排欺骗的子集并重做随机化。

对于较小的集合，没有什么是可能的，这取决于欺骗的数量。所以对于一个非常小的集合的解决方案只会是好的基本随机化（我们回到第一句话）。

![Dilbert 随机数发生器](https://www.random.org/analysis/dilbert.jpg)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-11T02:53:13.097

就我个人而言，我认为最简单的处理方法是将数组随机化，然后对其进行迭代，直到找到 2 个具有相同值且彼此相邻的元素。当您在彼此旁边找到 2 个相同的值时，通过遍历数组将后者移动到数组中的另一个位置，直到找到一个位置，使其不在另一个相同值旁边。如果找不到值，只需将其保留在原处，然后继续处理数组的下一个元素。这可能不是最优化的解决方案，但适用于较小的数据集，并且可能是最容易编程的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-11T02:52:57.497

您可能拥有的最大重复次数是多少？2、3，有吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-11T03:15:08.873

作为参考，我的（非常）天真的方法是这样的（实际上使用 LINQ/SQL 调用，但这是简化的）：

```
var advertisers = getAdvertisers();
var returnList = new List();
int totalWeight = sumOfAllAdvertisersWeight();
while (totalWeight > 0)
{
    for (int i=0; i<advertisers.Count; i++)
    {
        if (advertisers[i].Weight > 0)
        {
            returnList.add(advertisers[i]);
            advertisers[i].Weight--;
            totalWeight--;
        }
    }
}
return returnList; 
```

这将避免重复直到最后，但是是的，之后通过 returnList 向后检查是值得的，如果有任何重复的拖尾，请尝试早点将它们放入混合中。

# java - 如何从 Java 中使用 SQL Server Compact Edition (CE)？

> ID：358318
> 
> 赞同：7
> 
> 时间：2008-12-11T02:48:18.350
> 
> 标签：java, sql-server, jdbc, sql-server-ce

我想从 Java 访问 Microsoft SQL Server Compact Edition 数据库。我怎样才能做到这一点？我搜索了 SQLCE 的 JDBC 驱动程序，但没有找到。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-13T08:49:25.070

根据[Jimmy Wu@Mircrosoft 本周二 (2008-12-09) 发送的新闻组帖子](http://groups.google.com/group/microsoft.public.sqlserver.jdbcdriver/browse_thread/thread/2ba56d70e6b35ee7)：

> Microsoft SQL Server JDBC 驱动程序不支持连接到 SQL Server Compact。目前，对于 SQL Server Compact 版本没有计划的 JDBC 支持。感谢您对 SQL Server 的持续支持。
> 
> 此致， 吴吉米

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-11T03:00:07.467

根据[MSDN](http://forums.microsoft.com/msdn/ShowPost.aspx?PostID=770916&SiteID=1)，没有，也没有任何计划。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-18T17:50:02.443

虽然我不熟悉 SQL Server CE，但我认为 MS 为它提供了一个 ODBC 驱动程序。尽管不建议将其用于生产用途，但您可以使用 JDBC-ODBC 桥来建立连接。

```
Class.forName("sun.jdbc.odbc.JdbcOdbcDriver"); 
Connection con = DriverManager.getConnection("jdbc:odbc:<yourODBC_DSN>"); 
```

*重申一下，JDBC 提供的 JDBC-ODBC 桥驱动程序仅推荐用于开发和测试，或者在没有其他替代方案可用的情况下。*

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-11T09:19:22.383

搜索**SqlJDBC4**库。我知道一个同事使用它。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-12-12T05:39:40.860

很好的教程[sqljdbc-tut](http://www.herongyang.com/jdbc/sqljdbc-jar-Microsoft-JDBC-Driver.html)

最新的驱动程序（在技术预览中）是[sqljdbc-jars](http://www.microsoft.com/downloads/details.aspx?familyid=F914793A-6FB4-475F-9537-B8FCB776BEFD&displaylang=en)

# unix - 规范与非规范终端输入

> ID：358342
> 
> 赞同：49
> 
> 时间：2008-12-11T03:10:57.883
> 
> 标签：unix, input, curses

我正在为考试而学习，我对规范与非规范输入/输出在 Unix 中的工作方式感到困惑（例如，curses）。我知道有一个缓冲区适用于规范输入的“线路规则”。这是否意味着非规范输入绕过了缓冲区，还是仅仅意味着没有应用任何线路规则？这个过程对于输入和输出操作有何不同？

在我使用的演示规范输入的 curses 程序中，用户输入的输入是在输入一定数量的字符或经过一定时间后自动输入的。这些东西中的任何一个都被认为是“线学科”还是完全是另外一回事？

* * *

## 回答 #1

> 赞同：96
> 
> 时间：2008-12-11T03:37:36.533

对于规范输入——想想 shell；实际上，想想老式的 Bourne shell，因为 Bash 和亲戚都有命令行编辑。你输入一行输入；如果你犯了一个错误，你使用擦除字符（默认是`Backspace`，通常；有时`Delete`）来擦除前一个字符。如果你完全搞砸了，你可以用 line kill 字符取消整行（不完全标准化，经常`Control-X`）。在某些系统上，您会使用`Control-W`. 所有这些都是规范输入。整行被收集和编辑，直到行尾字符 - `Return`- 被按下。因此，整条线路可供等待程序使用。根据`read()`未完成的系统调用，整行都可以读取（通过一次或多次调用`read()`）。

对于非规范输入——想想`vi`或`vim`其他什么——你按下一个字符，它立即可供程序使用。直到您返回时，您才会被阻止。系统不对字符进行编辑；它们在输入后立即可供程序使用。由程序来适当地解释事物。现在，`vim`确实做了一些看起来有点像规范输入的事情。例如，退格键向后移动，在输入模式下会擦除那里的内容。但那是因为`vim`选择让它表现得像那样。

规范和非规范输出是一个不那么严肃的事情。有一些点点滴滴的差异，例如是否在换行之前回显回车，以及是否进行延迟（对于电子设备来说不是必需的；在输出设备可能是 110- 的日子里很重要波特电传）。它还可以处理诸如处理不区分大小写的输出设备之类的事情——又是电传打字机。小写字母以大写字母输出，大写字母以反斜杠和大写字母输出。

过去，如果您在登录提示符下键入所有大写字母，那么登录程序将自动转换为所有大写字母输出的模式，每个实际大写字母前都有一个反斜杠。我怀疑这不再在电子终端上完成。

* * *

在评论中，TitaniumDecoy 问道：

> 那么对于非规范输入，输入缓冲区是否完全绕过？此外，线学科从何而来？

对于非规范输入，仍然使用输入缓冲区；如果没有程序`read()`调用等待来自终端的输入，则字符将保存在输入缓冲区中。不会发生输入缓冲区的任何编辑。

行规则类似于输入编辑所做的一组操作。因此，行规则的一个方面是擦除字符在规范输入模式中擦除先前的字符。如果您设置了`icase`(input case-mapping) ，则大写字符将映射为小写，除非前面有反斜杠；我相信，那是一线学科，或者是一线学科的一个方面。

* * *

我忘了提到EOF处理（`Control-D`）是在规范模式下处理的；它实际上意味着'使累积的输入可用于`read()`'；如果没有累积输入（如果您`Control-D`在行首键入），`read()`则将返回零字节，然后程序将其解释为 EOF。当然，之后您可以愉快地在键盘上键入更多字符，忽略 EOF（或以非规范模式运行）的程序会非常高兴。

当然，在规范模式下，在键盘上键入的字符通常会回显到屏幕上；您可以控制是否发生回显。然而，这与规范输入有些相切；即使关闭回声，也会进行正常编辑。

类似地，中断和退出信号是规范模式处理的产物。作业控制信号也是如此，例如`Control-Z`暂停当前进程并返回外壳。同样，规范模式提供流控制（停止和启动输出）`Control-S`。`Control-Q`

Rochkind 的[Advanced Unix Programming, 2nd Edn](https://rads.stackoverflow.com/amzn/click/com/0131411543)的第 4 章涵盖了终端 I/O 并提供了大部分信息——以及更多信息。其他 UNIX 编程书籍（至少是好的书籍）也将涵盖它。

# jquery - 为什么这个 Javascript (jQuery) 不进入无限循环？

> ID：358344
> 
> 赞同：2
> 
> 时间：2008-12-11T03:13:26.410
> 
> 标签：jquery, loops, jquery-events

[我在Karl Swedberg 的博客](http://www.learningjquery.com/2008/05/working-with-events-part-2)上阅读了关于绑定和解除绑定事件的精彩文章（因为我是一个使用 jQuery 的 js 初学者），我对这部分代码完全感到困惑（为简洁起见）：

```
 function addItemUnbind() {
      $Add a button but it won't have it's event added;
      addItemUnbind();
  }); 
```

为什么通过将相同的函数放在自身内部，它不会继续执行无限循环？但是，它用于将事件重新绑定到元素......！？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-11T03:22:26.330

据我所知，你的例子会。但是，您的示例与您引用的网站上的示例不同。

```
function addItemUnbind() {
  $('#list6 li.special button')
    .unbind('click')
    .bind('click', function() {
      var $newLi = $('<li class="special">special and new <button>I am new</button></li>');
      $(this).parent().after($newLi);
      addItemUnbind();
  });
} 
```

在此示例中，当用户单击按钮时会调用“addItemUnbind”。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-11T03:23:07.483

因为调用在内部函数中。

例如，他在 addItemUnbind() 中做了一些事情，其中​​之一是将函数绑定到按钮单击。

然后声明这个函数，例如在 addItemUnbind() 中有：

```
.bind('click', function() {
  var $newLi = $('<li class="special">special and new <button>I am new</button></li>');
  $(this).parent().after($newLi);
  addItemUnbind();
  } 
```

此处大括号内的代码不会在调用 addItemUnbind() 时进行评估，而是在单击发生时进行评估。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-11T03:31:23.600

答案隐藏在您取出的部分代码中。您发布的内容确实是一个无限循环。但是，这是一个更完整（但仍然简化）的示例，从链接的博客文章中修改：

```
function addItemUnbind() {
  bind('click', function() {
    addItemUnbind();
  });
} 
```

对 addItemUnbind 的调用在一个闭包内——一个新的匿名函数，它与创建它的 addItemUnbind 函数是分开的。不是立即调用，而是将新函数的引用传递给绑定函数。所以如果绑定函数看起来像这样：

```
function bind(eventName, eventHandler) {
  eventHandler();
} 
```

那么你将有一个无限循环，因为对 eventHandler 的调用会导致返回到 addItemUnblind。但如果它看起来像这样：

```
function bind(eventName, eventHandler) {
  this.events[eventName] = eventHandler; // save the event handler to call when an event happens
} 
```

那么就没有问题了。它不调用 addItemUnbind，它只是保存对稍后将调用它的函数的引用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-11T04:27:33.953

啊......就像在很多事情......“观察丹尼尔！”。诚然，我认为事件处理工作的方式也存在异常，这导致我浏览了我认为我已经知道的文章。由于您的仔细解释，我现在看清楚了。

# c# - 在 where 表达式中使用 Guid.Empty 挂起 Linq 查询

> ID：358345
> 
> 赞同：3
> 
> 时间：2008-12-11T03:13:56.100
> 
> 标签：c#, linq, linq-to-sql, csla

我对以下代码有疑问：

```
 private void DataPortal_Fetch(TaskCriteria criteria)
    {
        using (var ctx = ContextManager<Gimli.Data.GimliDataContext>
                    .GetManager(Database.ApplicationConnection, false))
        {
            this.RaiseListChangedEvents = false;
            this.IsReadOnly = false;

            IQueryable<Data.Task> query = ctx.DataContext.Tasks;

            if (criteria.ReadyForPricing)
            {
                query = query.Where(row => row.IsPriced != true);
                query = query.Where(row => row.Status == (int)TaskStatus.Closed);
                query = query.Where(row => row.InvoiceId == Guid.Empty);
            }

            if (criteria.ReadyForInvoicing)
            {
                query = query.Where(row => row.IsPriced == true);
                query = query.Where(row => row.Status == (int)TaskStatus.Closed);
                query = query.Where(row => row.InvoiceId == Guid.Empty);
            }

            var data = query.Select(row => TaskInfo.FetchTaskInfo(row));

            this.AddRange(data);

            this.IsReadOnly = true;
            this.RaiseListChangedEvents = true;
        }
    } 
```

如果我不注释掉以下行，我的 Web 应用程序在调用此方法时总是挂起：

```
query = query.Where(row => row.InvoiceId == Guid.Empty) 
```

知道为什么会发生这种情况吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-11T03:37:29.700

以下代码有效……有趣的是……知道为什么吗？

```
query = query.Where(row => row.InvoiceId == new Guid("00000000-0000-0000-0000-000000000000")); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-11T03:18:26.137

尝试将代码更改为：

```
query.Where(row => object.Equals(row.InvoiceId, Guid.Empty)) 
```

如果有帮助，请回帖...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-11T03:29:07.237

@BFree ...尝试了您的建议...并且仍然做同样的事情。奇怪的是，我可以毫无问题地在 LinqPad 中运行以下代码：

```
from t in Tasks
where  t.IsPriced == false
&& t.IsNotInvoiceable == false
&& t.Status == 5
&& t.InvoiceId == Guid.Empty
select t 
```

我也可以毫无问题地使用以下代码行：

```
if (criteria.ProjectId != Guid.Empty)
     query = query.Where(row => row.ProjectId == criteria.ProjectId); 
```

就在我使用 Guid.Empty 的时候。简直太奇怪了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-11T05:14:15.857

这可能是因为 lambda 的解释方式；对于“Guid.Empty”，“Guid.Empty”是最终 lambda 的一部分。我想知道 LINQ 提供者是否以某种方式将此视为特殊情况？

你可以试试：

```
Guid empty = Guid.Empty;
query = query.Where(row => row.InvoiceId == empty); 
```

但实际上，除了`Guid`一些编译器生成的捕获类之外，表达式树是相同的（它们都涉及 lambda=>BinaryExpression=>MemberExpression）。

如果上述情况*也*出现问题，请尝试启用 TSQL 跟踪，或启用您的 LINQ 提供程序日志记录 - 对于 LINQ-to-SQL，类似以下的工作（不要引用我的话！）：

```
ctx.Log = Console.Out; 
```

# java - 从 JUnit 测试确认 FileReader 已正确关闭

> ID：358347
> 
> 赞同：2
> 
> 时间：2008-12-11T03:16:51.413
> 
> 标签：java, unit-testing, junit, filereader

我正在编写一些 Java 代码，它使用 FileReader 从几个输入文件中加载数据。我正在大量使用 TDD，并且我想添加一些测试，以确保我在完成后通过在阅读器上调用 close() 来正确清理它。不幸的是，我想不出一个好的方法来测试这个。有人有任何见解吗？

编辑添加：我知道我可以使用模拟对象显式测试关闭调用，但如果可能的话我想避免它，部分原因是我发现它们会导致代码有些脆弱，部分原因是我很好奇它是否可能编写可以识别不关闭文件的影响的代码。）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-11T03:28:33.933

我认为这样做的方法是将 FileReader 或创建 FileReader 的工厂注入您的班级。然后在您的单元测试中，您可以注入 FileReader 的模拟版本并检查它是否已调用正确的方法。您可能希望查看[JMock](http://www.jmock.org/)以创建模拟 FileReader 并设置对 close 方法调用的期望。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-11T03:43:05.620

一种可行的方法是在关闭 FileReader 后测试 ready() 方法，这应该会引发异常。例如：

```
FileReader fr = new FileReader("somefile");
// ... file reader activity
fr.close();

// After closing the reader, the ready() method should cause an IOException:
boolean isOpen = true;
try {
  isOpen = fr.ready();
} catch (IOException e) {
  isOpen = false;
}
assertFalse("FileReader is still open", isOpen); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-11T03:26:51.453

如果您可以将 FileReader 对象传递给调用，那么您可以提供一个自定义 FileReader，它具有一个覆盖的 close 方法——在这种情况下，您有一个布尔变量来检查是否关闭。然后，您可以将其用于单元测试。

# html - 列表项的备用背景颜色

> ID：358350
> 
> 赞同：110
> 
> 时间：2008-12-11T03:18:05.043
> 
> 标签：html, css

我有一个列表，每个项目都是链接的，有没有办法可以交替每个项目的背景颜色？

```
<ul>
    <li><a href="link">Link 1</a></li>
    <li><a href="link">Link 2</a></li>
    <li><a href="link">Link 3</a></li>
    <li><a href="link">Link 4</a></li>
    <li><a href="link">Link 5</a></li>
</ul> 
```

* * *

## 回答 #1

> 赞同：310
> 
> 时间：2010-03-19T13:25:28.647

一些可爱的 CSS3 怎么样？

```
li { background: green; }
li:nth-child(odd) { background: red; } 
```

* * *

## 回答 #2

> 赞同：52
> 
> 时间：2008-12-11T03:26:07.120

如果您想纯粹在 CSS 中执行此操作，那么您将拥有一个分配给每个备用列表项的类。例如

```
<ul>
    <li class="alternate"><a href="link">Link 1</a></li>
    <li><a href="link">Link 2</a></li>
    <li class="alternate"><a href="link">Link 3</a></li>
    <li><a href="link">Link 4</a></li>
    <li class="alternate"><a href="link">Link 5</a></li>
</ul> 
```

如果您的列表是动态生成的，则此任务会容易得多。

如果您不想每次都手动更新此内容，您可以使用 jQuery 库并将样式交替应用于`<li>`列表中的每个项目：

```
<ul id="myList">
    <li><a href="link">Link 1</a></li>
    <li><a href="link">Link 2</a></li>
    <li><a href="link">Link 3</a></li>
    <li><a href="link">Link 4</a></li>
    <li><a href="link">Link 5</a></li>
</ul> 
```

还有你的 jQuery 代码：

```
$(document).ready(function(){
  $('#myList li:nth-child(odd)').addClass('alternate');
}); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-12-11T03:22:20.917

您可以通过向每个列表项添加交替样式类来实现此目的

```
<ul>
    <li class="odd"><a href="link">Link 1</a></li>
    <li><a href="link">Link 2</a></li>
    <li class="odd"><a href="link">Link 2</a></li>
    <li><a href="link">Link 2</a></li>
</ul> 
```

然后像

```
li { backgorund:white; }
li.odd { background:silver; } 
```

您可以使用 javascript 进一步自动化此过程（下面的 jQuery 示例）

```
$(document).ready(function() {
  $('table tbody tr:odd').addClass('odd');
}); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-11T03:31:32.117

尝试在交替的列表元素中添加一对类属性，比如“偶数”和“奇数”，例如

```
<ul>
    <li class="even"><a href="link">Link 1</a></li>
    <li class="odd"><a href="link">Link 2</a></li>
    <li class="even"><a href="link">Link 3</a></li>
    <li class="odd"><a href="link">Link 4</a></li>
    <li class="even"><a href="link">Link 5</a></li>
</ul> 
```

在 HTML 页面的 <style> 部分或链接样式表中，您将定义这些相同的类，指定所需的背景颜色：

```
li.even { background-color: red; }
li.odd { background-color: blue; } 
```

随着需求的发展，您可能希望使用模板库来为您提供更大的灵活性并减少打字。为什么要手动输入所有这些列表元素？

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2018-01-24T10:12:03.060

这是在偶数和奇数 li 上设置的背景颜色：

```
 li:nth-child(odd) { background: #ffffff; }
  li:nth-child(even) { background: #80808030; } 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-11T03:22:26.457

由于您使用标准 HTML，因此您需要为这些类定义单独的类并手动将行设置为这些类。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-11T03:25:24.313

您可以通过在行上指定交替的类名来做到这一点。我更喜欢使用`row0`and `row1`，这意味着如果列表是以编程方式构建的，您可以轻松地添加它们：

```
for ($i = 0; $i < 10; ++$i) {
    echo '<tr class="row' . ($i % 2) . '">...</tr>';
} 
```

另一种方法是使用javascript。本例中使用了 jQuery：

```
$('table tr:odd').addClass('row1'); 
```

编辑：*我不知道为什么我使用表格行给出示例...替换为`tr`和`li`它适用于您的示例`table``ul`*

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-03-19T10:13:45.033

如果您使用 jQuery 解决方案，**它将适用**于 IE8：

jQuery

```
$(document).ready(function(){
$('#myList li:nth-child(odd)').addClass('alternate');
}); 
```

CSS

```
.alternate {
background: black;
} 
```

如果您使用 CSS解决方案，**它将无法**在 IE8 上运行：

```
li:nth-child(odd) {
    background: black;
} 
```

* * *

## 回答 #9

> 赞同：-8
> 
> 时间：2008-12-11T03:22:15.177

您可以通过对序列进行硬编码，如下所示：

```
li, li + li + li, li + li + li + li + li {
  background-color: black;
}

li + li, li + li + li + li {
  background-color: white;
} 
```

# visual-studio - VS2005 + SharePoint 部署的最佳项目格式？

> ID：358367
> 
> 赞同：4
> 
> 时间：2008-12-11T03:26:03.437
> 
> 标签：visual-studio, sharepoint, deployment, stsadm

首先，让我用一句话来表达一些沮丧：我的天，为 SharePoint 开发真是一团糟！

好的，抱歉，让我专注于 1 个特定场景。我已经开发了（VS2005）一些功能，如果我将它作为 DLL 部署在 SharePoint（MOSS2007）服务器上，它就可以工作。现在我正在尝试确定将其打包为可部署功能的最佳方式。

根据搜索结果，您会认为没有人以可重复的方式成功地做到这一点！每篇文章都与下一篇文章相矛盾，或者记录了一种用其他人的技术修补某些问题的技术，并且反过来可能会在另一篇文章中进行更新。许多似乎基于 2003、WSS 等的旧方法。一些建议使用 MSBuild 任务部署到您的代码，手动将文件复制到名称为“12”的目录中，或使用 SharePoint Designer 等工具或直接对服务器进行修改. 这些听起来像是开发人员用来安装在测试服务器上的 hack。有没有人创建过一个项目，在成功构建后，可以将其带到另一台机器并通过 STSADM 使用安装程序或单个命令行指令进行部署？

我承认我对 SharePoint 管理只有初学者的了解，但它一定比看起来容易。我想我了解[http://msdn.microsoft.com/en-us/library/ms413687.aspx](http://msdn.microsoft.com/en-us/library/ms413687.aspx)的基本概念，但没有办法自动化吗？对于要在 2007 服务器上部署的打包功能，必须有*一种*推荐的做法。但对于我的生活，我无法弄清楚它是哪一种。（我最好的猜测是它是这样的：http: [//www.codeplex.com/sptemplateland](http://www.codeplex.com/sptemplateland)，但自 2007 年 2 月以来一直没有更新。）

任何人都可以帮忙吗？非常感谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-11T04:51:16.777

“街头谈话”通常围绕 SharePoint 开发的三个选项展开。

1.  [VSeWSS，微软自己的 Visual Studio 扩展](http://blogs.msdn.com/sharepoint/archive/2008/06/04/announcing-the-vsewss-version-1-2.aspx)。
2.  [STSDEV](http://www.codeplex.com/stsdev)，根据您的规格预先创建一个 VS 解决方案
3.  [WSPBuilder](http://codeplex.com/wspbuilder)，我的偏好是因为它的 VS 集成

都有优点和缺点，我建议你尝试所有三个来找到你的偏好。

.b

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-11T06:50:30.450

使用过 VSeWSS 1.2 后，我建议创建一个 STSDEV 解决方案，将代码打包并将 Web 部件复制到正确的位置。

**更新** 然而，VSeWSS 1.3 现在是 MS 的“官方”版本，并将在 Visual Studio 的未来版本中得到支持，所以这可能是现在采取的路线。

不幸的是，您仍然需要知道每件事情都必须适合 SharePoint 以使其正常工作。在幕后，解决方案和功能仍然使用粗糙的 XML 格式来控制解决方案的所有部分的方向。

一段时间后，您会感到剧烈的疼痛变得迟钝到低沉的悸动。

# macos - 替换 OS X Leopard 中 SystemConfiguration 中的 kicker.bundle

> ID：358373
> 
> 赞同：4
> 
> 时间：2008-12-11T03:30:46.157
> 
> 标签：macos, osx-leopard, system-configuration

我正在尝试找到在 OS X pre 10.5 (Leopard) 的 /System/Library/SystemConfiguration 中找到的 kicker.bundle 的替代品。我似乎找不到任何关于此事的官方文件。有谁知道替代品是什么？

谢谢，克。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-08-16T12:40:47.167

一组系统管理员创建了“crankd”作为 kicker.xml 的替代品。您可以在以下位置找到它作为 PyMacAdmin 的一部分：

[http://code.google.com/p/pymacadmin/](http://code.google.com/p/pymacadmin/)

Crankd 可以“执行 Python 代码或 shell 脚本以响应许多系统事件：网络更改、文件系统活动、应用程序启动等”</p>

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-11T18:08:45.700

我花了相当多的时间寻找解决方案。似乎没有直接替代 kicker.bundle 和 kicker.xml 来帮助在发生网络更改时启动脚本。也就是说，我找到了另一种可能会解决问题的解决方案：

[http://tech.inhelsinki.nl/locationchanger/](http://tech.inhelsinki.nl/locationchanger/)

ķ。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-10-28T19:53:55.817

configd 的 Apple 源代码包含一个 kicker 插件，我试图编译它，但它加载了某种循环引用错误。也许一些聪明的程序员可以弄清楚。

# sharepoint - Sharepoint 网站需要一段时间才能在早上加载第一件事

> ID：358377
> 
> 赞同：11
> 
> 时间：2008-12-11T03:31:41.663
> 
> 标签：sharepoint, performance

我们的团队使用 Sharepoint 和一些自定义 Web 部件构建了一个站点。我们注意到，早上第一次访问该网站时，该网站需要一段时间才能加载。后续访问没问题。我们怀疑 Sharepoint 正在重新索引其列表等。

有没有其他人看到 Sharepoint 的这个问题？有没有人有建议的修复？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-12-11T04:38:57.410

默认情况下，IIS 应用程序将在夜间回收其工作进程。您可以在 IIS 管理器中将其关闭，但更好的选择可能是将预热脚本添加到定时作业。您可以在 SharePoint 中执行此操作，但更简单的可能是在 Windows 中添加计划任务，以便在回收完成后触发预热脚本。

“sharepoint warmup script”的谷歌会产生几个结果，[包括这个](http://kirkhofer.wordpress.com/2008/10/18/sharepoint-warm-up-script/)，这实际上也解释了同样的情况:-)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-11T04:40:19.497

我的猜测是应用程序池的工作进程被设置为在 IIS 中每晚的某个时间回收，这导致早上第一件事就是延迟。右键单击 IIS -> 属性 -> 中的应用程序池，然后查看“在以下时间回收工作进程：”的位置，亲自查看。

您可以禁用此选项来解决您的问题，但我不建议这样做，因为让工作进程每晚回收会回收任何可能泄漏的内存。内存泄漏在 SharePoint 开发期间尤其可能发生，因为您可能知道 SharePoint 对象模型中的许多对象在未管理的内存中执行其大部分工作。如果这些对象没有妥善处理，可能会占用大量内存，而对 .NET 垃圾收集器增加的内存压力很小，从而延迟垃圾收集。

[最佳实践：使用一次性 Windows SharePoint Services 对象](http://msdn.microsoft.com/en-us/library/aa973248.aspx "最佳实践：使用一次性 Windows SharePoint Services 对象")

我同意seanb 的建议，即设置一个计划任务在早上加载站点以解决延迟问题。只要确保在工作进程明显回收后安排一段时间即可。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-11T03:41:12.317

不，我猜应用程序中的已编译组件已从内存中卸载，必须重新加载到缓存中。这也发生在我的 ASP.NET Web 应用程序中。我特别注意到它在 QA 站点上几乎没有被击中，因此当我去访问它们时几乎总是从缓存中刷新。

您可以考虑增加站点的[应用程序池](http://technet.microsoft.com/en-us/library/cc735247.aspx)在回收空闲工作进程之前等待的时间。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-11T03:58:37.070

同意 tvanfosson 的观点，这听起来很像您在使用 aspnet 应用程序时遇到的启动滞后。

一个快速而肮脏的解决方法可能是设置一个计划任务，将 WebClient 指向该站点，并在人们开始使用它之前每天早上将其启动。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-11T07:28:21.450

当然，Bjorn 强调了“问题”的主要原因。应用程序池在夜间被回收。

但是，这应该需要大约 30 秒。

如果需要 2 或 3 分钟，请考虑阅读[此](http://www.muhimbi.com/blog/2009/04/new-approach-to-solve-sharepoints.html)内容。如果您的服务器无法访问互联网，它主要解释为什么它这么慢。只需尝试从 microsoft.com 下载证书吊销列表，看看它是否有所作为。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-10-19T14:17:02.663

~~[如果您运行的是 Windows Server 2008 R2，现在可以免费获得适用](https://forums.iis.net/t/1176740.aspx)于 IIS 7.5 的应用程序预热扩展。在撰写本文时，它处于测试阶段。~~

~~这会“预热”直接从 IIS 配置的应用程序池，也可以使用自定义初始化逻辑进行扩展。~~

[根据 Microsoft](https://docs.microsoft.com/en-us/archive/blogs/bryang/iis-application-warm-up-module)的说法，应用程序预热扩展不再可用，并将“针对 IIS 的下一个版本进行重新调整” 。

# sql - SQL Server 2008 中的 Open Table 去了哪里？

> ID：358382
> 
> 赞同：26
> 
> 时间：2008-12-11T03:38:20.823
> 
> 标签：sql, database, sql-server-2008

从 SQL Server 2005 开始，您可以在 SQL Management Studio 中打开任何数据库表的右键菜单中的平面文件。打开后，您可以在网格中添加或更新记录。

现在 SQL Server 2008 已经发布，微软已经隐藏了该功能，至少在右键菜单中是这样。

它去哪儿了？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2008-12-11T04:03:13.083

它被“编辑前 200 行”所取代。您可以在工具 > 选项 > SQL Server 对象资源管理器 > 命令中更改该命令。

但是一旦你右键单击一个表，选择“编辑前 200 行”，在工具栏上寻找一个名为“显示 SQL 窗格”的按钮。您可以在此处编辑查询，以便网格显示您想要的数据的子集。

他们这样做是因为人们不小心用旧的 Open Table 命令打开了巨大的桌子。这种方法似乎工作得很好，虽然总的来说我发现 2008 版本在与 2005 数据库交谈时非常不稳定，但这是另一回事....

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-01-28T16:25:16.217

将选项中的值更改为 0，您可以打开整个表格。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2010-01-05T21:11:18.607

您可以将“编辑前 200 行”的默认值设置为“0”

在 SQL server Object Explorer\Table 下的 Tools Menu -> Options... 和 view options\Value Edit Top Rows Command 下。将默认值 200 也更改为“0”。

您现在应该有选项“编辑所有行”而不是“编辑前 200 行”作为默认选项，如果您知道它是一个 laaarge 表，请使用“选择前 1000 行”作为表的回顾。

# asp.net - ASP.NET - 回收表明更大问题的应用程序池？

> ID：358384
> 
> 赞同：2
> 
> 时间：2008-12-11T03:40:20.007
> 
> 标签：asp.net, iis

是否必须在 ASP.NET 中回收 App-Pool 是否表明 Web-App 中存在更大的问题？或者这只是 ASP.NET 和 IIS 的“现状”？

编辑：由于其中一个错误是“OutOfMemory”异常，您对行动方案有何建议？你会加内存吗？分析应用程序？（重要的是要注意，我对此有自己的想法，并且有一条路线，但想听听你的答案）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-11T03:48:15.593

IIS 的运行状况监控功能可以自动回收应用程序池。所以一个应用程序池只是回收自身并不一定表明存在问题；它可能只是 IIS 的预防功能已打开。这个想法是，如果您的应用程序发生内存泄漏或忘记释放某些内容，我们可以通过每隔一段时间重新启动它来提高应用程序的整体可用性，就像您在桌面上运行一个月后重新启动 Windows 一样许多应用程序的小不良行为的净影响开始产生影响。

在其他一些平台上，您可能不会很快注意到这些问题，尤其是在 CGI 环境中，因为整个框架都已设置好，然后随着每个页面请求而拆除。

理想情况下，您永远不必重新启动应用程序池，而不得不这样做通常是某种问题的征兆。回收功能是一种针对我们自己的错误的责任保险，或者那些“行星只是如此对齐”的错误，这些错误很难追踪、重新创建，而且发生频率如此之低，以至于它们可能不值得进行故障排除。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-11T03:43:53.933

就个人而言，我认为这是更大问题的迹象。我的应用程序运行了数周而没有回收利用。他们回收的唯一原因是因为我们推送代码更新。我认为您应该查看您的事件日志，看看您是否可以找到应用程序池回收的任何原因。我已经看到它经常发生内存泄漏，最终会导致您的内存耗尽，从而迫使您的应用程序池重新启动。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-11T04:45:46.320

应用程序池可以回收利用的原因有很多。未处理的异常或线程挂起是常见原因。如果您没有关闭所有 SqlConnections 并且连接池为空也可能导致它回收。死锁超时是另一种情况，如果您有死锁，它将挂起工作进程，这将导致回收。另外，如果IIS在服务器上使用了异常量的资源，它会回收（我认为默认是60%）

还有很多 iis 设置会触发它。有一些设置可以定期回收（为了清除会话状态），我认为默认情况下它是每 24 小时一次。我们有大约 40 处中型到重型面向公众的房产，我们将在低潮期进行回收利用。

我很确定还有其他原因。人们失去他们的会话可能比应用程序崩溃或服务器挂起更好，这就是为什么它内置在 IIS 中。不幸的是，它会使诊断问题变得非常困难。我会在回收发生时查看您的事件查看器，看看是否有任何有趣的事情可以作为开始的地方。跟踪内存使用情况将是我的下一步，然后是一些详细的日志记录。

# php - 是否可以使用 PHP 获取图像鼠标单击位置？

> ID：358387
> 
> 赞同：3
> 
> 时间：2008-12-11T03:41:23.750
> 
> 标签：php, image, mouse, click, location

基本上就是标题所说的...

我需要一个图像，当我点击它时，我调用 script.php，在那个 PHP 脚本文件中，我得到了鼠标点击的图像坐标。

这可能吗？

**编辑：**
经过几个答案后，我意识到我没有正确描述我的问题......问题是，我无法完全控制 HTML。我对图像和图像链接的控制是 BBCode 为我提供的控制。

基本上我想做的是有一个论坛签名，其中包含指向我网站上各个部分的链接。您可能会争辩说我可以使用多张图片，但大多数论坛限制了您可以为签名输入的数量，这对于多张图片来说是不够的。

所以，我只能做这样的事情：

```
[url=http://www.mydomain.com/script.php]
[img]http://www.mydomain.com/signature.jpg[/img]
[/url] 
```

翻译成这样的：

```
<a href="http://www.mydomain.com/script.php">
<img src="http://www.mydomain.com/signature.jpg" />
</a> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-11T03:47:01.243

如果您使用输入 type="image"，它的作用类似于按钮，它将向您发送鼠标单击的 x 和 y 坐标（也提交表单）。

更多信息在这里：[http ://www.htmlhelp.com/reference/html40/forms/input.html#image](http://www.htmlhelp.com/reference/html40/forms/input.html#image)

我已经很久没有使用它了，但我确实让它适用于“球在哪里？” 多年前在一个网站上的竞争。

更新：

听起来环境太有限了，无法做你想做的事。如果论坛让你做一个可行的图像地图，但我怀疑他们会让你。只有我能想到的其他东西是 flash 或 javascript，同样，它们可能不允许它们。你需要一些比图像和锚更聪明的东西来完成这项工作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-11T05:01:16.770

如果你不能：

1.  使用 JavaScript，或
2.  使用输入类型=“图像”，或
3.  将任何属性添加到您的 img 标签（执行创建图像映射等操作）

那么，不，您将无法按照您的描述进行操作。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-11T03:52:50.280

如果你设置了图像输入`name="foo"`，那么`$\_POST['foo\_x']`和`$\_POST['foo\_y']`将被设置为图像坐标。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-11T05:12:12.303

您可以尝试使用 [W3C Image Maps](http://www.w3.org/TR/REC-html40/struct/objects.html#h-13.6)

> Image maps allow authors to specify regions of an image or object and assign a specific action to each region (e.g., retrieve a document, run a program, etc.) When the region is activated by the user, the action is executed.

But on a forum in BBCode, I really don't think you're going to be able to get what you're after.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-11T04:50:22.347

除非您可以将内联事件处理程序添加到 bbcode 中的 url，否则这是不可能的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-11T05:34:22.757

Another solution, though not for BBCode is to use the ismap attribute for img. But may be valuable to others needing exact coordinates. Example:

```
<a href="link.html"><img src="shapes.jpg" alt="Shapes" ismap="ismap"/></a> 
```

The x and y coordinates will be passed as GET parameters to link.html

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2008-12-11T04:32:10.513

您可以在执行“onclick”时使用 ajax 请求向“script.php”发送请求。否则我会阅读 php，这是一种服务器端语言。

# c# - 您将如何重构此条件以使用多态性？

> ID：358389
> 
> 赞同：8
> 
> 时间：2008-12-11T03:42:40.237
> 
> 标签：c#, .net, polymorphism

我刚刚在 YouTube 上观看了关于从代码中删除语句并改用多态性 的 Google 干净代码视频（参见[链接](http://googletesting.blogspot.com/)，第一篇文章） 。`if`

看完视频看了看视频之前写的一些代码，发现有些地方可以使用这种方法，主要是同一种逻辑多次实现的地方。举个例子：

我有一些这样的代码。

```
public int Number
{
    get
    {
        string returnValue;
        if (this.internalTableNumber == null)
             returnValue = this.RunTableInfoCommand(internalTableName,
                                                    TableInfoEnum.TAB_INFO_NUM);
        else
             returnValue = this.RunTableInfoCommand(internalTableNumber.Value,
                                                    TableInfoEnum.TAB_INFO_NUM);
        return Convert.ToInt32(returnValue);
    }
} 
```

RunTableInfoCommand 的作用并不重要，但主要是我有许多具有完全相同`if`语句的属性，唯一改变的是 TableInfoEnum。

我想知道是否有人可以帮助我重构它，以便它仍然做同样的事情但没有任何`if`声明？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-11T04:08:42.947

在看到其中一些（技术上正确的）响应后，这里只是一个警告，只是摆脱 If 语句不应该是您的唯一目标，目标应该是使您的代码可扩展、可维护和简单，如果这意味着摆脱if 语句，很好，但它本身不应该是一个目标。

在您提供的代码示例中，并且不了解您的应用程序的更多信息，并且假设您不会扩展太多过去的空值测试，我认为 If（甚至可能是三元）是更易于维护的解决方案非常坦率。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-11T03:55:59.603

您实际上将实现类似策略模式的东西。首先定义一个超类，我们称之为 AbstractTableInfoCommand。此类可能是抽象的，但必须指定一个名为 runTableInfoCommand() 的方法。

然后，您可以定义几个子类，每个子类都实现 runTableInfoCommand() 方法。您的类，即具有 Number 属性的类，将具有 AbstractTableInfoCommand 类型的新属性（我们称之为 tableInfoCommand），它将被实例化为 AbstractTableInfoCommand 的具体子类之一。

然后代码将是：

```
public int Number
    {
        get
        {

            return this.tableInfoCommand.runTableInfoCommand();
        }
    } 
```

因此，您可以创建 NullTableInfoCommand 和 SomeOtherTableInfoCommand 等。优点是，如果您有一些返回 tableinfocommand 的新条件，那么您可以添加一个新类而不是编辑此代码。

话虽如此，并非每种情况都一定适合这种模式。因此，它可以生成更多可扩展的代码，但如果您处于不需要可扩展性的情况下，它可能会有点矫枉过正。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-11T04:39:10.047

我觉得你的代码非常好。可读。简单的。（我希望它有效）。如果您有此代码块重复 n 次，则需要通过应用 Extract 方法删除重复项。

您指出的重构旨在替换重复出现的 switch 案例.. 不像您的示例中那样简单的 if 语句。[用多态替换条件](http://www.refactoring.com/catalog/replaceConditionalWithPolymorphism.html)。记住“最简单的工作”......这意味着完成工作所需的最少数量的类和方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-11T03:54:57.420

我可能会考虑将返回值的获取传递给另一个可以在运行时注入的类。

```
public class Thing
{
  public IValueFetcher ValueFetcher { get; set; }

  public int Number 
  { 
    get 
    {
      return this.ValueFetcher.GetValue<int>(/* parameters to identify the value to fetch */);
    }
  }
} 
```

这将处理大量重复代码并减少您对接口值来源的依赖。

我认为在某些时候您可能会有一个 if 语句，因为您仍然需要决定要调用哪个版本的 RunTableInfoCommand。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-11T04:00:49.653

我假设`internTableName`并且`InternalTableNumber`是同一件事的某种价值。为什么不将它包装在一个类中并将该类的一个实例传递给`this.RunTableInfoCommand`这样：

```
public int Number
        {
            get
            {
                string returnValue;
                internalTableClass myinstance(parameters);
                return Convert.ToInt32(this.RunTableInfoCommand(myinstance, TableInfoEnum.TAB_INFO_NUM));
            }
        } 
```

如果您仍然想使用多态，则可以在该类中通过重载例如`giveInternalTableIdentifier`返回数字或名称的 a 来实现

此处的代码可能如下所示：

```
public int Number
        {
            get
            {
                string returnValue;
                internalTableClass myinstance(parameters);
                return Convert.ToInt32(this.RunTableInfoCommand(myinstance.giveInternalTableIdentifier, TableInfoEnum.TAB_INFO_NUM));
            }
        } 
```

并且 internalTableClass 的代码将很简单（使用：internalAbstractTableClass，以及从它继承的两个类，一个给出名称，另一个给出编号）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-11T04:02:35.017

**编辑 2**我将如何真正解决问题。

我会让 InternalTableNumber 成为延迟加载的属性。如果它不可用，那么我会通过 InternalTableName 查找它。然后我总是只使用 InternalTableNumber 属性作为我的方法。

```
 private int? internalTableNumber;
 private int InternalTableNumber
 {
     get
     {
         if (!internalTableNumber.HasValue)
         {
             internalTableNumber = GetValueFromTableName( internalTableName );
         }
         return internalTableNumber;
     }
     set
     {
         internalTableNumber = value;
     }
 }

 public int Number
 {
     get
     {
        string value = this.RunTableInfoCommand(InternalTableNumber,
                                                TableInfoEnum.TAB_INFO_NUM);
        return Convert.ToInt32( value );
     }
 } 
```

**编辑** 使用多态性...

假设您当前的类名为 Foo，那么我会将它重构为两个类，FooWithName 和 FooWithNumber。FooWithName 将是您在拥有表名时使用的类，而 FooWithNumber 将是在您拥有表号时使用的类。然后，我将使用 Number 方法编写每个类——实际上，我将编写一个接口 IFoo 以及每个接口，以便它们可以互换使用。

```
public interface IFoo
{
     int Number { get; }|

}

public class FooWithName : IFoo
{
     private string tableName;
     public FooWithName( string name )
     {
         this.tableName = name;
     }

     public int Number
     {
        get { return this.RunTableInfoCommand(this.tableName,
                                       TableInfoEnum.TAB_INFO_NUM);
     }

     ... rest of class, including RunTableInfoCommand(string,int);
}

public class FooWithNumber : IFoo
{
     private int tableNumber;
     public FooWithNumber( int number )
     {
         this.tableNumber = number;
     }

     public int Number
     {
        get { return this.RunTableInfoCommand(this.tableNumber,
                                       TableInfoEnum.TAB_INFO_NUM);
     }

     ... rest of class, including RunTableInfoCommand(int,int);
} 
```

你会这样使用它：

```
IFoo foo;

if (tableNumber.HasValue)
{
    foo = new FooWithNumber( tableNumber.Value );
}
else
{
    foo = new FooWithName( tableName );
}

int number = foo.Number; 
```

显然，除非您在现有类中有很多 if-then-else 构造，否则此解决方案实际上并没有对其进行太大改进。该解决方案使用多态创建 IFoo，然后只使用接口方法而不关心实现。这可以很容易地扩展为在继承 IFoo 并且是 FooWithNum 和 FooWithName 的基类的抽象类中继承 RunTableCommand( int ) 的通用实现。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-11T04:03:32.630

我会这样重构它：

```
table = this.internalTableNumber == null ? internalTableName : internalTableNumber.Value;
return Convert.ToInt32(this.RunTableInfoCommand(table, TableInfoEnum.TAB_INFO_NUM)); 
```

喜欢三元运算符。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-11T04:49:13.567

在这种情况下，进行涉及多态性的重构可能是矫枉过正（取决于您可能从多态性中获得哪些其他优势）。在这种情况下，添加一个简单的重载来封装`RunTableInfoCommand()`要调用的逻辑可能是有序的。

由于`RunTableInfoCommand()`,`internalTableNumber`和`internalTableName`all 似乎是同一个类的成员，一个不错的、简单的重构可能是添加一个重载`RunTableInfoCommand()`，它只需要一个`TableInfoEnum`值并执行确定`RunTableInfoCommand()`需要调用哪个其他重载的逻辑：

```
private string RunTableInfoCommand( TableInfoEnum infoEnum)
{
    if (this.internalTableNumber == null) {
        return this.RunTableInfoCommand( internalTableName, infoEnum);
    }

    return this.RunTableInfoCommand( internalTableNumber.Value, infoEnum);
} 
```

然后可以将具有相同`if`决策逻辑的众多呼叫站点折叠为：

```
returnValue = this.RunTableInfoCommand( TableInfoEnum.TAB_INFO_NUM);    
                                        // or whatever enum is appropriate 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-11T06:18:00.657

我将如何重构这些特定的 if 语句以使用多态性？

嗯......我不会。您不需要多态性来消除 if 语句。

请注意，if 语句本身并不“坏”，if 语句是由表示选择引起的，其中

```
(internalTableNumber == null) ==> 
    internalTableName else internalTableNumber.Value 
```

*这种关联意味着缺少类*，即拥有一个拥有 internalTableName 和 internalTablenumber 的 InternalTable 类会更有意义，因为这两个值与 null 检查规则密切相关。

*   这个新类可以提供一个执行 internalTableNumber == null 检查的 TableNumber 属性
*   并且 RunTableInfoCommand 可以将 InternalTable 实例作为参数（但不是必须的，请参阅下一项）。
*   但更好的是，新类应该具有执行整数转换的 RunTableInfoCommand 方法（可能是静态的）的外观。

假设 InternalTable 实例被命名为 iTable，那么重构后的代码将如下所示：

```
public int Number
{
    get
    {
        return iTable.RunTableInfoCommand(TableInfoEnum.TAB_INFO_NUM);
    }
} 
```

This would encapsulate the null-check in the InternalTable class. Modifying the original RunTableInfoCommand signature is optional.

Note that this does *not* "replace the if statements with polymorphism", but it does eliminate the if statements from the consuming class via encapsulation.

# c++ - 单个连接上的多个数据库事务

> ID：358396
> 
> 赞同：3
> 
> 时间：2008-12-11T03:49:21.863
> 
> 标签：c++, mysql, transactions, database-connection

我有一个多线程程序，而每个线程在开始执行时从 MySql 连接池类获取单个连接。然后，该线程通过将其数据库连接传递给包装器类来使用许多数据库表包装器类来执行其业务逻辑。这些包装类上的操作不一定是顺序的，我希望这些包装类能够使用单个数据库连接相互独立地提交或回滚其数据库表上的更改。我知道 MySql 不允许嵌套事务并且还没有找到实现此目的的方法。任何帮助是极大的赞赏。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-11T04:26:17.327

听起来您必须将事务与表包装器关联起来，而不是仅仅在一个线程一个线程的基础上。IOW，您需要创建一个事务类。事务类在事务打开和关闭时从/向连接池获取/释放连接。

然后，该事务成为您的表格包装器的工厂。事务创建的任何表包装器都在事务内部，因为除了事务所在的连接之外，它无法访问任何连接。

令人讨厌的部分是阻止所有对象访问死对象。将需要某种形式的 SmartPtr 来处理事务提交时发生的事情，但某些事情会再次尝试使用表包装器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-11T04:04:31.893

如果我正确理解了这个问题，我相信您唯一的选择是实现某种事务队列，允许您的多个线程共享单个连接。然后，您的每个线程都可以将“任务”添加到需要在事务中执行的队列中。然后你有一个进程从队列中挑选这些任务（你甚至可以在这里实现某种优先级）并将它们发送到数据库，然后再将结果返回给发起请求的线程。调用线程会阻​​塞，直到它们收到结果，这并不理想，但如果你真的需要多个线程和多个事务，我看不到没有多个连接的另一种方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-11T04:25:10.527

好吧，这是多个线程使用单个资源的经典示例。

解决方案就是在 mysql 连接操作上使用[互斥锁。](http://en.wikipedia.org/wiki/Mutex)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-11T04:39:43.400

有一个连接池，你为什么不获取更多的连接？并且可能使用信号量来限制同时连接的数量。否则，您需要锁定单个连接或使用客户端事务（使用框架，这并不简单，如果只有一个连接，您无论如何都需要锁定连接，但与没有事务相比，等待时间会非常短在您的代码方面）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-11T04:55:23.617

最简单的解决方案是为每个线程创建一个新连接——这通常是使用 Apache/PHP 完成的。

如果您的写入远远少于读取（10 个线程中只有 1 个需要写入），您可以为 SELECT 使用一个全局连接，并为每个需要更新的线程创建一个新连接。

之后，您可能会拥有一个包含多达 10 个线程的池用于写入（因此您可以拥有多达 10 个并发事务）。归根结底，如果您想要并发，那么您需要多个连接。

# javascript - 检测Skype的Javascript？

> ID：358397
> 
> 赞同：21
> 
> 时间：2008-12-11T03:49:37.057
> 
> 标签：javascript, skype

**某些 Javascript 是否可以检测是否安装了 Skype？**

我问的原因是我想基于此更改链接的 href：如果未安装 Skype，则显示一个弹出窗口，说明 Skype 是什么以及如何安装它，如果已安装，请将链接更改`skype:my.contact.name?call`为单击将开始通话。房地产问题意味着我宁愿只显示一个链接。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2008-12-11T06:15:00.430

感谢大家的回答：从链接和方法 seanb 和一些张贴的，我能够想出一个适用于 IE 和 Firefox 的解决方案，所以我想我会发布一个“完整”的答案。这是一个方便的 jQuery 扩展！

## jQuery 扩展

```
jQuery.extend({
    skype : function(failureFunction) {
        var $ = jQuery;

        if ($.browser.safari || $.browser.opera) {
            return true;
        } else if ($.browser.msie) {
            try {
                if (new ActiveXObject("Skype.Detection")) return true;
            } catch(e) { }
        } else {
            if (typeof(navigator.mimeTypes["application/x-skype"]) == "object") {
                return true;
            }
        }
        $('a[href^="skype:"]').click(function() {
            failureFunction();
            return false;
        });
        return false;
    }
}); 
```

## 用法

HTML：

```
<a href="skype:your.skype.username?call">Call me</a>
<a href="skype:your.skype.username?add">Add me</a> 
```

Javascript：

```
jQuery(function($) {
    $.skype(function() {
        // this function gets called if they don't have skype.
        alert("Looks like you don't have skype. Bummer.");
    });
}); 
```

就是这样！

如果有人使用 Safari、Opera 或 Chrome，它只会让浏览器处理它。

*编辑：重新调整功能，使其仅在页面加载时执行检查，而不是每次加载页面时执行检查。该`$.skype`函数现在将返回一个布尔值，告诉您是否检测到Skype*。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-11T04:07:18.643

适用于 IE 和 Firefox，但不适用于 Chrome 或 Opera

```
function isSkypeInstalled(str) {
    try {
        /*@cc_on
        //The Microsoft way, thanks to the conditional comments only run in IE
        if (new ActiveXObject("Skype.Detection")) return true;
        @*/

        //Tested for firefox on win
        if (navigator.mimeTypes["application/x-skype"]) return true;
    }
    catch(e){}
    return false;
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-07T16:22:22.527

依靠 nickf 可靠的检测方法，我只需将 skype 用户名添加到数据属性（“ ***data-skype ”）并更改所有******tel:***链接的 href 值（如果不支持 skype）。工作得很好，使用普通***电话的全局应用程序：***如果禁用 Javascript，超链接仍然保持完好。

```
<!-- the links -->
<a href="tel:+15035551212" data-skype="yourskypeusername" title="Call">Call</a>

/* the javascript*/
function hasSkype() {
    if ($.browser.safari || $.browser.opera) {
        return true;
    } else if ($.browser.msie) {
        try {
            if (new ActiveXObject("Skype.Detection")) return true;
        } catch(e) { }
    } else {
        if (typeof(navigator.mimeTypes["application/x-skype"]) == "object") {
            return true;
        }
    }
    return false;
}

$('a[href^="tel:"]').each(function() {
    if(hasSkype()) {
        // if Skype is available, update the link to use Skype
        $(this).attr('href','skype:'+$(this).attr('data-skype')+'?call');
    }
}); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-11T04:10:51.773

用于 IE 的 skype 插件修改了 DOM，因此您始终可以在某处拥有一个“虚拟”电话号码字段，并注意任何注入的“跨度”元素，类名为“skype_tb_injection”...

你正在寻找的是这样的：

```
<SPAN onmouseup=".." class="skype_tb_injection" onmousedown="..." id="softomate_highlight_0" onmouseover="..." title="Call this phone number in Thailand with Skype: +66812341234" onclick="..." onmouseout="..." durex="0" context="+66 8 1234 1234" IamRTL="0">
  <SPAN class="skype_tb_nop">&nbsp;</SPAN>
  <SPAN onmouseup="..." class="skype_tb_imgA_flex" onmousedown="..." id="skype_tb_droppart_0" onmouseover="..." title="Skype actions" style="..." onclick="..." onmouseout="...">
    &nbsp;&nbsp;
    <SPAN class="skype_tb_nop">&nbsp;</SPAN>
    <SPAN class="skype_tb_imgFlag" id="skype_tb_img_f0" style="...">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN>
    &nbsp;
    <SPAN class="skype_tb_nop">&nbsp;</SPAN>
  </SPAN>
  <SPAN class="skype_tb_imgS" id="skype_tb_img_s0" style="...">&nbsp;</SPAN>
  <SPAN class="skype_tb_injectionIn" id="skype_tb_text0" style="...">
    <SPAN class="skype_tb_innerText" id="skype_tb_innerText0"> +6...</SPAN>
  </SPAN>
  <SPAN class="skype_tb_imgR" id="skype_tb_img_r0" style="...">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <SPAN class="skype_tb_nop">&nbsp;</SPAN>
  </SPAN>
</SPAN> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-11T04:41:10.027

听起来你正在把自己编码到一个角落里……试图用 JS 检测 Skype，用完屏幕空间。

相反，如果“联系”链接将用户带到联系页面，其中包含您的“Skype：”链接和说明性的 Skype 下载内容，那么整个事情可能会更友好。它会比 JS 弹出窗口更有用。

您可以在此页面上添加一些首选项，例如“我有 Skype 不再显示此页面”复选框。然后使用该首选项来切换您的“联系”链接。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-11T03:59:22.763

不，通常无法检测是否从网页安装了 Skype 或任何其他软件，除非应用程序执行特定操作以使信息可用，例如修改用户代理字符串 la .Net 或您有特殊的浏览器扩展程序，

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-11T04:05:40.690

那不是javascript的安全策略想要的。

如果没有插件或其他第三方的东西，你永远不会得到这样的信息。您只能获取缺少插件的信息，但不能获取操作系统上缺少的软件的信息。

同时让它在mac&linux&windows上工作也应该是有问题的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-08-28T06:31:58.677

所有浏览器插件都在名为的全局数组中注册它们的 mime 类型`mimeTypes`，可以通过 navigator object 访问`navigator.mimeTypes`。

所以你可以用它来检查插件是否活跃。如果插件安装和禁用 - 将不会为该禁用插件注册任何 mime 类型。如果插件已安装并处于活动状态 - 他在`navigator.mimeTypes`

一些使用 jQuery 的代码实现：

```
jQuery.extend({checkPlugin: function(mimetype_substr) {
    for (var i = 0; i < navigator.mimeTypes.length; i++) {
        if (navigator.mimeTypes[i]['type'].toLowerCase().indexOf(mimetype_substr) >= 0) {
                console.log("Gotcha! Here it is: "+navigator.mimeTypes[i]['type']);
                return true;
        }
    }
    return false;
}}); 
```

所以这个：如果Skype click2call插件已安装并处于活动状态，则`$.checkPlugin("skype");`返回。`true`如果`false`没有活动插件或插件未安装。

实际上需要在另一个全局数组中搜索 - `navigator.plugins`，但是所有活动插件的记录都在 中`navigator.mimeTypes`，这更容易一些。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-02-19T10:00:26.117

您可以使用 W3C 标准，浏览器将确定安装哪些软件来管理呼叫：

```
<a href="callto:<phone_number>"><phone_number></a> 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-07-24T18:50:00.720

我只是在我的 Fedora 12 中测试，使用 firefox 或其他浏览器的 Linux 平台无法使用 skype 协议。

即使安装了 linux skype。

注意：以上参考适用于 Windows 平台

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2008-12-11T04:29:16.947

编写一个签名的 Java 小程序可能是值得的。这样，您至少可以访问操作系统并确定是否以这种方式安装了 Skype。否则，如注意到的那样，Javascript 不允许这种事情（如果允许，您的计算机可能已经受到损害）。

# python - 保持一个变量从发布到获取？

> ID：358398
> 
> 赞同：0
> 
> 时间：2008-12-11T03:50:02.937
> 
> 标签：python, google-app-engine, post, get

我有一个名为 myClass 的类，它定义了 post() 和 get() 方法。

在*index.html*中，我有一个带有调用 myClass.post() 的操作的表单，它从数据库中获取一些数据，设置几个变量并将用户发送到*new.html*。

现在，*new.html*有一个调用 myClass.get() 的表单。

**我希望 get() 方法知道我在 post() 中获得的变量的值。**这是这里的重点。

我认为来自 new.html 的提交会创建一个单独的 myClass 实例，该实例由来自 index.html 的提交创建。

有没有办法以某种方式访问​​“发布实例”？

有解决方法吗？如果必须，是否有一种既定的方法可以将值从 post 发送到“new.html”并与 get-submit 一起发回？

更一般地说，我想我在网络编程时不了解我的实例的生命周期。在正常的交互环境中，我知道实例何时被创建和销毁，但是当我仅通过调用其方法来使用该类时，我不明白这一点。除非调用它们的方法，否则这些类是否会被实例化？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-11T11:24:44.733

你在说的是建立一个“会话”。也就是说，一种记住用户及其交易状态的方法。

有几种方法可以解决这个问题，所有这些方法都依赖于记住您首先在会话中的技术。

HTTP 没有为您提供任何帮助。您必须在服务器上找到保存会话状态的地方，并在客户端上找到记录会话标识的地方。两大技术是

*   使用 cookie 来识别会话。无缝而沉默。

*   在 URL 中使用查询字符串来标识会话。很明显，因为您`?sessionid=SomeSessionGUID`的 URL 中有一个。这暴露了很多，使书签变得烦人。清理完会话后，您仍然可以在人们的书签中看到此会话 ID。

*   在有限的情况下，您还可以在表单中使用隐藏字段。这仅在您在每个页面上都有表单时才有效。并非总是如此。

以下是它在实践中的表现。

1.  获取响应。检查标头中的 cookie。

    一个。没有饼干。初次使用者。创建会话。将其保存在某处（内存、文件、数据库）。将唯一 ID 放入 cookie。响应知道这是他们的第一次。

    湾。曲奇饼。最近来过这里。尝试获取 cookie。

    *   F找到会话对象。使用 cookie 中的信息进行响应。

    *   德拉特。没有会话。老饼干。创建一个新的并表现得像这是他们的第一次访问。

2.  发布响应。检查标头中的 cookie。

    一个。没有饼干。怎么回事？傻孩子。从我的草坪上离开！有人在 POST 上添加了书签或试图弄乱你的脑袋。像第一次 GET 一样响应。

    湾。曲奇饼。出色的。得到饼干。

    *   找到会话对象。在会话对象中找到你需要的东西。回应。

    *   德拉特。没有会话。老饼干。创建一个新的并像第一次 GET 一样响应。

您可以使用查询字符串而不是 cookie 来做同样的事情。或表单上的隐藏字段。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-11T09:18:31.447

HTTP 是无状态的，因此您无法（内置）知道加载一个页面的用户是否与加载另一个页面的用户相同。此外，即使您确实知道这一点，例如，由于会话 cookie，您也无法判断他们加载后续页面的浏览器窗口是否与他们加载前一页面的浏览器窗口相同。用户可能有多个标签访问您的站点，并且您不希望一个页面的状态更改破坏另一个页面。

考虑到这一点，您最好的选择是在指向使用 GET 获取的页面的链接中包含查询参数，对要发送到“获取”页面的变量进行编码（确保它们不敏感，因为用户可以修改它们！）。然后你可以通过get请求中的self.request.GET来访问它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-11T07:12:22.140

这不是如何管理实例的问题。因为 HTTP 是无状态的，所以您的程序实际上也是无状态的。（对于长时间运行的进程，如 GAE，可以采用其他方式，但我不确定您是否需要这种复杂性）

你没有提供任何代码，但我假设你得到一个 POST，然后你[重定向](http://en.wikipedia.org/wiki/Post/Redirect/Get)到结果（这是一个 GET）。所以保存参数应该很容易：

```
def save_foo(request):
    if request.method == 'POST':
        save(request.POST)
        return HttpRedirect(reverse(
            'Some_Target',
            {'bar': 'baz', 'foo': request.POST['foo']}))
    else:
        # do something else 
```

在 POST 的情况下，此视图会导致客户端向任何带有别名的 URL 发出 GET 请求`Some_Target`。这个 GET 将包含`foo`来自 POST 的参数。

此解决方案适用于单一视图。如果您在项目方面需要这种行为，您可以使用中间件。这一次缓存变量是有意义的。

有两点让我对这种方法有点不舒服：

1.  混合 GET 和 POST 参数。GET 参数应该用于没有副作用的指令，例如过滤。POST 参数应该用于有副作用的指令，即修改数据。恕我直言，应避免将参数从 POST 移动到 get 。
2.  如果我们需要持久性，使用对象实例（或我的示例中的函数范围）通常不是一个好主意。
    1.  如果它是具有较低保留需求的非敏感信息，`cookies`则可以选择。它们是客户端的一种持久性机制，因此您可以从请求中获取它们，除非您更改它们，否则它们将被保留（当然直到到期。）
    2.  如果您需要对保留进行更多控制，则应使用本地持久性机制。服务器缓存（任何类型）、文件系统、数据库......当然，您需要手动过滤每个用户。

无论如何，我都会避免缓存实例。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-11T04:09:50.213

我不具体了解谷歌应用引擎，但通常情况如下：

服务器将具有某种线程池。每次向服务器发送 http 请求时，都会从池中选择或创建一个线程。

在该线程中，将创建某种控制器对象的实例。该对象将决定如何处理请求（例如实例化其他类和预处理 http 请求参数）。通常，这个对象是 Web 框架的核心。请求参数也是浏览器每次重新发送的（服务器无法猜测浏览器想要什么）。

Web 服务器通常具有永久或会话状态的对象的状态存储。会话由唯一用户（通常由 url 中的 cookie 或 GUID）表示，该用户在一定时间后过期。

现在，在您的情况下，您需要从第一个函数中获取值，将其存储在会话存储中，然后在第二个函数中，从会话存储中获取这些值。

另一种解决方案是将项目作为您从第一个函数生成的 HTML 中的 url 参数发送回页面，然后您将“照常”从第二个函数中获取这些项目。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-11T18:02:19.237

好的——谢谢大家。

我会尽快尝试其中的一些想法，然后回复大家。

似乎我可以通过从数据存储中进行大量写入和读取来解决这些问题*，但我认为可能有一种更简单的方法来保留该类的实例（我正在尝试使用我的已知技术一个我还没有完全掌握的网络框架）。

*例如，根据 POST 中的数据创建唯一记录，并让一些变量“标记”。这是一个不好的做法吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-11T09:41:01.467

为什么不直接使用 memcache 临时存储变量，然后重定向到 POST URL？这似乎是最简单的解决方案。

# sql-server-2005 - 查询以查找其中包含日期列的所有表

> ID：358410
> 
> 赞同：24
> 
> 时间：2008-12-11T04:00:52.697
> 
> 标签：sql-server-2005, tsql, date, types

任何人都可以让我知道查询以查找所有具有日期列的表。

谢谢

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-12-11T04:15:27.317

这应该可以解决问题，如果需要，只需添加其他类型：

```
select
    so.name table_name
   ,sc.name column_name
   ,st.name data_type
from sysobjects so
inner join syscolumns sc on (so.id = sc.id)
inner join systypes st on (st.type = sc.type)
where so.type = 'U'
and st.name IN ('DATETIME', 'DATE', 'TIME', 'SMALLDATETIME') 
```

***编辑：****这也适用于 Sybase 和任何其他 T-SQL 变体。*

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-12-11T04:09:01.620

这对当前数据库中的表使用 INFORMATION_SCHEMA。
在 SQL Server 2008 中测试。

```
 select distinct c.TABLE_NAME     
    from INFORMATION_SCHEMA.COLUMNS as c
    where c.DATA_TYPE = 'datetime' 
```

另一个使用系统视图查询 SQL 2005/2008：

```
select tbl.name as 'Table', c.name as 'Column Name', t.name as 'Type'
from sys.columns as c
inner join sys.tables as tbl
on tbl.object_id = c.object_id
inner join sys.types as t
on c.system_type_id = t.system_type_id
where t.name in ('datetime', 'date')
order by tbl.name 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2013-10-28T19:59:56.587

这是 RobS 的另一个答案，它将获得自引入日期、日期时间 2 和时间以来所有不同类型的日期格式和时间格式。

```
SELECT TABLE_CATALOG, TABLE_SCHEMA, TABLE_NAME, COLUMN_NAME, DATA_TYPE
FROM INFORMATION_SCHEMA.COLUMNS
WHERE DATA_TYPE LIKE '%date%' OR DATA_TYPE LIKE '%time%' 
```

在 SQL Server 2012 和 2014 中测试，但应该在 2003、2005、2008 和许多 ODBC 连接中工作。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-25T14:57:18.420

对上面的 RobS 查询略有改进。这也返回架构名称列。

```
select s.name as 'SchemaName',
tbl.name as 'Table', c.name as 'Column Name', t.name as 'Type'
from sys.columns as c
inner join sys.tables as tbl
on tbl.object_id = c.object_id
inner join sys.types as t
on c.system_type_id = t.system_type_id
inner join sys.schemas s
on  tbl.schema_id = s.schema_id
where t.name in ('datetime', 'date')
order by s.name, tbl.name 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-08-20T10:36:57.177

## 这是下面的测试代码：

```
SELECT DISTINCT(TABLE_NAME) 
FROM INFORMATION_SCHEMA.COLUMNS
WHERE 
DATA_TYPE='datetime' 
```

## **对于多种数据类型，您可以使用以下代码：**

```
SELECT DISTINCT(TABLE_NAME) 
FROM INFORMATION_SCHEMA.COLUMNS
WHERE 
DATA_TYPE IN ('datatype1','datatype2') 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-03-01T08:36:27.060

我知道这是一个老问题，但我发现它正在寻找类似的问题解决方案。
这就是我正在使用的：

```
SELECT
    DISTINCT OBJECT_NAME(col.OBJECT_ID) AS [TableName]
FROM
    sys.all_columns col
    INNER JOIN sys.types typ
    ON col.user_type_id = typ.user_type_id
WHERE
    col.user_type_id IN (61) 
```

您可以在此处找到所有基本数据类型：[http ://www.sqlservercurry.com/2008/06/find-all-columns-with-varchar-and.html](http://www.sqlservercurry.com/2008/06/find-all-columns-with-varchar-and.html)

如果您想在特定表中查找具有特定类型的所有列，只需使用以下命令：

```
SELECT
    OBJECT_NAME(col.OBJECT_ID) AS [TableName]
    ,col.[name] AS [ColName]
    ,typ.[name] AS [TypeName]
FROM
     sys.all_columns col
     INNER JOIN sys.types typ
     ON col.user_type_id = typ.user_type_id
WHERE
    col.user_type_id IN (61)
    AND
    OBJECT_NAME(col.OBJECT_ID) = 'TABLE_NAME' 
```

也许有人会发现它很有用:)

# c# - 类型化数据集未在添加列时更新

> ID：358429
> 
> 赞同：1
> 
> 时间：2008-12-11T04:12:29.817
> 
> 标签：c#, .net, strongly-typed-dataset

我有一个在 Visual Studio 2008 中用于 winforms 应用程序的 datagridview。datagridview 绑定到一个类型化的数据集。我在从类型化数据集引用的表中添加了几列。因此，我打开输入的数据集并重新配置数据表以显示新列。当我进行预览时，这些列就在那里。但是，当我查看 datagridview 时，没有任何变化。我什至反弹没有变化。我还尝试创建一个新的表适配器，当为数据网格视图选择源时它甚至没有出现？

想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-27T17:30:09.010

我有同样的问题。datagridview 不会自动接受您的数据源配置的更改。如果向数据源添加列，则需要配置 datagridview 以显示新列。

打开 datagridview 的属性并编辑/添加列。它将允许您添加新列。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-11T04:33:41.367

如果您在 Properties->Data Sources 文件夹下创建了任何数据源，请尝试删除它们。

# django - 带有动态表单的 Django FormWizard

> ID：358430
> 
> 赞同：6
> 
> 时间：2008-12-11T04:13:41.203
> 
> 标签：django, forms, dynamic, formwizard

我想实现一个简单的 2 部分 FormWizard。表格 1 将动态生成如下内容：

```
class BuyAppleForm(forms.Form):
   creditcard = forms.ChoiceField(widget = forms.RadioSelect)
   type = forms.ChoiceField(widget = forms.RadioSelect)
   def __init__(self,*args, **kwargs):
        user = kwargs['user']
        del kwargs['user']

        super(BuyAppleForm, self).__init__(*args, **kwargs)

        credit_cards = get_credit_cards(user)
        self.fields['creditcard'].choices = [(card.id,str(card)) for card in credit_cards]

        apple_types= get_types_packages()
        self.fields['type'].choices = [(type.id,str(type)) for type in apple_types] 
```

这将动态创建一个包含可用选项列表的表单。

我的第二种形式，我实际上不想输入。我只想显示一个确认屏幕，其中包含信用卡信息、苹果信息和金额（总额、税金、运费）。一旦用户点击确定，我希望苹果购买开始。

我能够通过在 kwargs 中传入 request.user 对象来实现单一形式的方式。但是，使用 FormWizard，我无法弄清楚这一点。

我是不是错误地处理了这个问题，FormWizard 不是正确的方法吗？如果是，Form`__init__`方法如何从 HTTP 请求中访问用户对象？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-11T12:14:22.403

我没有使用它，但是对于您描述的情况，您似乎可能想尝试使用[FormPreview](http://docs.djangoproject.com/en/dev/ref/contrib/formtools/form-preview/#ref-contrib-formtools-form-preview)而不是 FormWizard。从文档来看，这听起来像是您所追求的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-02-01T01:39:11.620

当我试图弄清楚 FormWizard 时，我搜索了所有内容，并找到了诸如大多数这些只是说不要使用它的响应。FormPreview 可以正常工作，因为 OP 只对一级表单感兴趣，但问题在如何使用 FormWizard 方面仍然有效。

尽管这个问题太老了，但我认为在这里回答很有价值，因为这个问题在很多网站上都被问到了，我没有看到对它的一致回应，也没有在文档中给出明确的解决方案。

我认为就 OPs 问题而言，覆盖 process_step 是要走的路。诀窍是在此方法中创建将从第一个表单接收数据的表单（或视图）。

我将此 form_setup 添加到我的 forms.py 作为实用程序包装器（想想构造函数）：

```
def form_setup(**kwargs):
    def makeform(data, prefix=None, initial=None):
        form = FormLev2(data, prefix, initial)
        for k, v in kwargs.items():
            if k == 'some_list':
                form.fields['some_list'].choices = v
            ...
        return form
    return makeform 
```

然后覆盖 process_step 如下：

```
def process_step(self, request, process, step):
    if step == 1
        if form.is_valid():  #form from step 1
            objs = Table.objects.filter(...) #based on last form 
            self.form_list[1] = form_setup(some_list=[(o.id,o.name) for o in objs])  #(*)
    ... 
```

这样，您可以动态修改 form_list(*)，即修改 FormWizard 实例中的 form_list，而不是修改表单定义本身。包装函数对于此功能至关重要，因为它返回一个函数，该函数将实例化一个新的 Form 对象，然后在 FormWizard 中使用该对象与下一个表单的数据一起调用，并允许您使用前一个表单中的数据.

编辑：对于 Erik 的评论，并澄清最后一部分。

另请注意，在步骤 n 之后，将使用步骤 [0,n] 调用 process_step。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-11T06:18:07.600

我不知道回答自己的问题是否是 StackOverflow 上可接受的行为，这是我对自己问题的解决方案。

首先，抛弃 FormWizard。

我有一个表格。两种观点：`buy_apples`和`buy_apples_confirm`

第一个视图只处理 GET。它打印出未绑定的表单，并带有一个转到第二个视图的 URL 的操作。

第二个视图检查是否存在名为“confirm”的 POST 参数。如果它不存在（因为第一次加载视图时不存在）它：

1.  将所有字段上的小部件调整为 HiddenInput
2.  写出提供订单摘要的模板。此模板还将一个名为“确认”的隐藏字段设置为 1（即使表单上不存在此字段）

当用户点击购买苹果时，表单被提交回来并再次`buy_apples_confirm`调用视图。这一次，出现了一个名为“confirm”的 POST 参数，因此我们实际处理了购买交易并且用户得到了他的苹果。

我欢迎对这种方法或处理这种情况的更好方法的任何批评。我是 Django 新手，发现有很多不同的方法可以解决问题。我想向最好的人学习。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-12T10:43:10.763

感谢您 krys 回答您自己的问题。帮助了我，但我仍然有一些评论。

FormPreview 不是要走的路，因为据我所知它不支持动态表单。它依赖于一个固定的表单类来从那里生成。但是我们在这里使用函数动态生成。也许 FormPreview 有一天会支持这一点（或者已经支持但我不知道如何）。

Krys 解决方案似乎与 FormPreview 一样。只有散列被遗漏了，所以用户可以更改隐藏字段中的数据，或者您是否再次检查它？如果您再次检查它，那将不会遵循 DRY，因为您重复了检查（好吧，可能是可重用的方法，所以只有很小的重复）。

我想知道，你如何调整小部件？您是否使用新的小部件复制表单，或者有没有办法动态更改它？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-05-03T02:38:48.577

如何更改**调用**方法以获取额外的参数？

类似的东西：http: [//dw.me/blog/2010/3/18/15/](http://d-w.me/blog/2010/3/18/15/)

# wpf - 子元素使用的自定义 UserControl 属性

> ID：358443
> 
> 赞同：1
> 
> 时间：2008-12-11T04:25:45.313
> 
> 标签：wpf, xaml, user-controls, properties

我正在尝试了解一些 WPF 概念，因此我整理了一个简单的示例来说明我正在尝试做的事情。我想设置用户控件的自定义属性，并让它被控件中​​的元素使用。

我一直在研究和试验，但我并没有完全理解这里的一切。任何帮助，将不胜感激。

这个例子的用户控件是一个简单的正方形，里面有一个圆圈：

```
<UserControl x:Class="CircleInSquare"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" Width="100" Height="100" >
    <Grid Background="#000000">
        <Ellipse Name="Circle"
                 Margin="10"
                 Fill="?????????"
                 >
        </Ellipse>
    </Grid>
</UserControl> 
```

其背后的VB代码：

```
Partial Public Class CircleInSquare

    Private _CircleColor As Color

    Public Property CircleColor() As Color
        Get
            Return _CircleColor
        End Get
        Set(ByVal value As Color)
            _CircleColor = value
        End Set
    End Property

End Class 
```

当我使用此用户控件时，如何将 CircleColor 应用于控件，并将其显示为 Ellipse 的填充颜色？更好...我可以给它一个默认颜色，显示在 VS2008 Designer 中吗？

所以...如果我将其中之一放入我的窗口 XAML 中，如下所示：

```
<app:CircleInSquare CircleColor="Blue" /> 
```

我希望圆圈显示为蓝色（或我为该实例选择的任何其他颜色）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-11T20:04:47.603

抱歉重新发布，但在重新阅读您的帖子后，我认为您可能会更好地使用模板。我在 VB 中附加了一些示例

窗口.xaml

```
<Window x:Class="Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:app="clr-namespace:WpfApplicationVB1"
    Title="Window1" Height="300" Width="300">
    <Grid>
        <app:CircleInSquare Height="50" Width="50" CircleColor="Blue" SquareColor="Red"  />
    </Grid>
</Window> 
```

CircleInSquare.xaml.vb

```
Partial Public Class CircleInSquare
    Public Property CircleColor() As Brush
        Get
            Return GetValue(CircleColorProperty)
        End Get

        Set(ByVal value As Brush)
            SetValue(CircleColorProperty, value)
        End Set
    End Property

    Public Shared ReadOnly CircleColorProperty As DependencyProperty = _
                           DependencyProperty.Register("CircleColor", _
                           GetType(Brush), GetType(CircleInSquare), _
                           New FrameworkPropertyMetadata(Brushes.Black))

    Public Property SquareColor() As Brush
        Get
            Return GetValue(SquareColorProperty)
        End Get

        Set(ByVal value As Brush)
            SetValue(SquareColorProperty, value)
        End Set
    End Property

    Public Shared ReadOnly SquareColorProperty As DependencyProperty = _
                           DependencyProperty.Register("SquareColor", _
                           GetType(Brush), GetType(CircleInSquare), _
                           New FrameworkPropertyMetadata(Brushes.Gray))

End Class 
```

CircleInSquare.xaml

```
<UserControl x:Class="CircleInSquare"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:app="clr-namespace:WpfApplicationVB1"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <UserControl.Template>
        <ControlTemplate>
        <Border x:Name="PART_Square" Height="{TemplateBinding Height}"  Width="{TemplateBinding Width}" Background="{TemplateBinding app:CircleInSquare.SquareColor}">
        <Ellipse x:Name="PART_Ellipse" Height="{TemplateBinding Height}"
                 Width="{TemplateBinding Width}" Fill="{TemplateBinding app:CircleInSquare.CircleColor}" />
            </Border>
        </ControlTemplate>
    </UserControl.Template>
</UserControl> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-11T04:37:22.157

您需要在 CircleInSquare 类中创建一个 DependencyProperty。做一些谷歌搜索。像下面这样为您的 circle 类使用属性的概念称为 AttachedProperties，您可能需要处理 CircleColorChanged 事件来做您需要的事情。

```
<Ellipse app:CircleInSquare.CircleColor="Blue" /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-11T06:01:35.293

将椭圆的 DataContext 设置为 CircleInSquare 类的实例。并确保在此类上使用实现 INotifyProperychanged 以启用其属性更改。如果您需要有关[Propertychange的更多信息，请查看此链接](http://msdn.microsoft.com/en-us/library/ms743695.aspx)

```
 <Ellipse Name="Circle"
             Margin="10"
             Fill="{Binding Path= CircleColor}"
             >
    </Ellipse> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-11T14:49:51.060

您像这样设置依赖项属性：

```
Public Shared ReadOnly MouseOverBrushProperty As DependencyProperty = DependencyProperty.Register("MouseOverBrush", GetType(Brush), GetType(BrushableComboBox), New UIPropertyMetadata())
Public Property MouseOverBrush() As Brush
    Get
        Return CType(GetValue(MouseOverBrushProperty), Brush)
    End Get
    Set(ByVal value As Brush)
        SetValue(MouseOverBrushProperty, value)
    End Set
End Property 
```

然后在你的xaml中你做这样的事情

```
Background="{TemplateBinding MouseOverBrush}" 
```

您可以在控件模板之外设置默认样式，如下所示：

```
<Style TargetType="{x:Type local:BrushableComboBox}">
    <Setter Property="MouseOverBrush" Value="Blue" />
    ... 
```

您也可以使用普通属性来完成此操作，但依赖属性支持绑定，这使得以后的样式更容易。

高温高压

# asp.net - ASP.NET 受保护的配置 - 如何仅使用公钥加密？

> ID：358449
> 
> 赞同：2
> 
> 时间：2008-12-11T04:28:28.367
> 
> 标签：asp.net, configuration, encryption, asp.net-2.0

使用受 ASP.NET 保护的配置时，如何仅使用公钥加密配置？

我可以导出一个公钥文件。然后，我想使用此公钥加密另一台服务器上的配置文件以供以后部署。但是，我不知道如何让 aspnet_regiis 使用导出的公钥。

基本上，我尝试仅将公钥导入容器，然后对其进行加密。但是，当我这样做时，它不是使用现有密钥进行加密，而是创建一个全新的密钥对，覆盖现有的公钥。在下面的脚本中，如果您将每个复制的文件重命名回connections.config，并尝试解密它们，第一个（connectionstring_server.encrypted）将失败，而第二个（connectionstring_build.encrypted）将成功），证明创建了一个新的密钥对。

这是一个批处理文件，演示了我尝试过的方法（编辑：这只是一个测试 aspnet_regiis 功能的示例。显然，我的实际用法会略有不同）：

```
REM delete container in case it already exists
\WINDOWS\Microsoft.NET\Framework\v2.0.50727\aspnet_regiis -pz "MyKeys"

REM create container
\WINDOWS\Microsoft.NET\Framework\v2.0.50727\aspnet_regiis -pc "MyKeys"

REM export key
\WINDOWS\Microsoft.NET\Framework\v2.0.50727\aspnet_regiis -px "MyKeys" "publicKey.xml"

REM encrypt file
\WINDOWS\Microsoft.NET\Framework\v2.0.50727\aspnet_regiis -pef "connectionStrings" . -prov "MyProvider"

REM copy encrypted file for later comparison
copy connections.config connectionstring_server.encrypted
pause

REM decrypt file
\WINDOWS\Microsoft.NET\Framework\v2.0.50727\aspnet_regiis -pdf "connectionStrings" .

REM delete continer
\WINDOWS\Microsoft.NET\Framework\v2.0.50727\aspnet_regiis -pz "MyKeys"

REM import public key
\WINDOWS\Microsoft.NET\Framework\v2.0.50727\aspnet_regiis -pi "MyKeys" publicKey.xml

REM encrypt file with just public key - THIS DOES NOT WORK CORRECTLY, it creates a new keypair
\WINDOWS\Microsoft.NET\Framework\v2.0.50727\aspnet_regiis -pef "connectionStrings" . -prov "MyProvider"

REM copy back encrypted file
copy connections.config connectionstring_build.encrypted
pause

REM decrypt file
\WINDOWS\Microsoft.NET\Framework\v2.0.50727\aspnet_regiis -pdf "connectionStrings" . 
```

这是一个示例 web.config

```
<?xml version="1.0"?>
<configuration>
    <configProtectedData>
        <providers>
            <add name="MyProvider" keyContainerName="MyKeys" type="System.Configuration.RsaProtectedConfigurationProvider, System.Configuration, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL" useMachineContainer="true" />
        </providers>
    </configProtectedData>
  <connectionStrings configSource="connections.config" />
</configuration> 
```

以及对应的connections.config：

```
<connectionStrings>
  <add name="SomConnectionName" connectionString="Data Source=somedatasource; Initial Catalog=somedatabase; Integrated Security=SSPI; Persist Security Info=False;" providerName="System.Data.SqlClient" />
</connectionStrings> 
```

**编辑：** 下面的答案建议我也可以导出私钥。这确实允许加密工作，但我不应该需要私钥来加密。我想要做的是将私钥留在将使用配置文件的服务器上，并将公钥存储在更易于访问的位置。无法做到这一点仅仅是aspnet_regiis的限制吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-11T19:51:11.420

我不知道这是否是一个错误，但我肯定也遇到了这个问题。公钥和私钥需要导入到 Windows 密钥库中才能使任何 .net 功能正常工作。但是，可以通过在导入密钥时不指定 -exp 开关来保护私钥。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-11T05:24:57.707

我认为您的问题出在 export 命令中，当您导出时，您需要指定 -pri 参数来告诉 aspnet_regiis 您要导出私钥和公钥。

```
REM export key
\WINDOWS\Microsoft.NET\Framework\v2.0.50727\aspnet_regiis -px "MyKeys" "publicKey.xml" -pri 
```

如果没有私钥，您的导入仍在创建自己的密钥对。这可能是 Microsoft 的错误，aspnet_regiis 至少应该警告您它无法导入您的不完整密钥，而是创建了一个新密钥...

仅导出公钥可能很有用，然后您可以将 xml 文件提供给您的操作或开发组，他们将能够在将配置文件部署到服务器之前对其进行加密，而无需泄露私钥。此外，这样您就不需要在场中的每台服务器上运行加密过程。

# java - 您应该在哪里使用 BlockingQueue 实现而不是简单队列实现？

> ID：358457
> 
> 赞同：29
> 
> 时间：2008-12-11T04:35:46.667
> 
> 标签：java, queue

我想我应该从

您应该在哪里使用 BlockingQueue 实现而不是简单队列实现？

到

**考虑到速度、并发性或其他属性（例如访问最后一个元素的时间）等方面，BlockingQueue 相对于队列实现的优点/缺点是什么。**

我用过这两种队列。我知道阻塞队列通常用于并发应用程序。我正在编写简单的 ByteBuffer 池，我需要一些 ByteBuffer 对象的占位符。我需要最快的、线程安全的队列实现。甚至还有像 ArrayList 这样的 List 实现，它对元素具有恒定的访问时间。

任何人都可以讨论 BlockingQueue vs Queue vs List 实现的优缺点吗？

目前我已经使用 ArrayList 来保存这些 ByteBuffer 对象。

**我应该使用哪种数据结构来保存这些对象？**

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2008-12-11T06:20:37.593

`BlockingQueue`如果您想限制某种请求，有限的容量也很有帮助。使用无界队列，生产者可以远远领先于消费者。这些任务最终会被执行（除非有太多以至于它们会导致`OutOfMemoryError`），但生产者可能早就放弃了，所以努力就白费了。

在这种情况下，最好向潜在的生产者发出队列已满的信号，并在失败后迅速放弃。例如，生产者可能是一个 web 请求，用户不想等待太久，即使它在等待时不会消耗很多 CPU 周期，但它正在使用有限的资源，如套接字和一些内存. 放弃将使已经排队的任务有更好的机会及时完成。

* * *

关于修改后的问题，我将其解释为“什么是在池中保存对象的好集合？”

无界[`LinkedBlockingQueue`](http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/LinkedBlockingQueue.html)是许多池的不错选择。但是，根据您的池管理策略，a[`ConcurrentLinkedQueue`](http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/ConcurrentLinkedQueue.html)也可能有效。

在池应用程序中，阻塞“放置”是不合适的。控制队列的最大大小是池管理器的工作——它决定何时为池创建或销毁资源。池的客户端从池中借用和归还资源。添加新对象，或将以前借用的对象返回到池中应该是快速、非阻塞的操作。因此，有限容量队列对于池来说不是一个好的选择。

另一方面，当从池中检索对象时，大多数应用程序都希望等到资源可用。至少暂时阻塞的“获取”操作比“忙等待”（重复轮询直到资源可用）效率高得多。在这种情况下，这`LinkedBlockingQueue`是一个不错的选择。借款人可以无限期地阻止[`take`](http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/LinkedBlockingQueue.html#take())，或限制它愿意阻止的时间[`poll`](http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/LinkedBlockingQueue.html#poll(long,%20java.util.concurrent.TimeUnit))。

一个不太常见的情况是客户端根本不愿意阻塞，但如果池为空，它有能力为自己创建资源。在这种情况下，a`ConcurrentLinkedQueue`是一个不错的选择。这是一个灰色地带，尽可能多地共享资源（例如内存）会很好，但速度更为重要。在更坏的情况下，这会退化为每个线程都有自己的资源实例；那么不必费心尝试在线程之间共享会更有效。

这两个集合都在并发应用程序中提供了良好的性能和易用性。对于非并发应用程序，an`ArrayList`很难被击败。即使对于动态增长的集合， a 的每个元素开销也`LinkedList`允许`ArrayList`带有一些空槽的 a 在内存方面保持竞争力。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-11T04:40:50.713

您会`BlockingQueue`在多线程情况下看到。例如，如果要使用构造函数创建一个，则需要传入 a`BlockingQueue`作为参数来创建。[`ThreadPoolExecutor`](http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/ThreadPoolExecutor.html)根据您在执行程序中传递的队列类型，可能会有不同的行为。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-08-21T07:00:53.317

它是一种`Queue`额外支持以下操作的实现

> 在检索元素时等待队列变为非空，

和

> 存储元素时等待队列中的空间可用。

如果您需要上述功能，那么您的实施将遵循您的要求，`Queue`然后使用`Blocking Queue`

# css - 7行HTML中的IE6不可见文本，有解决办法吗？

> ID：358462
> 
> 赞同：2
> 
> 时间：2008-12-11T04:39:49.153
> 
> 标签：css, internet-explorer-6

我花了很长时间才解决这个问题。我无法表达我所经历的挫败感，如果我这样做了，它就不适合任何网站。曾经。这是给我带来巨大痛苦的 HTML 代码：

```
<div style="padding: 5px; background: #EEE">
    This text is invisible. Remove either padding or background to see this.  
    <div>
        <div style="float: left;">left</div>
        <div style="clear: both;"></div>
    </div>
</div> 
```

文本是不可见的，除非你突出显示它或在它上面拖动一个窗口，或者类似的东西。

如果您删除填充或删除背景，此问题将得到解决。

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-11T04:43:08.853

你被[Peek-a-boo](http://www.positioniseverything.net/explorer/peekaboo.html)咬了。

从该链接，您的选择是：

1.  保持清除 div 不接触浮动，或避免在 div#floatholder 上使用背景。不完全理想。
2.  给 div#floatholder 和 div#float 'position: relative'。请务必全面测试此方法。
3.  给 div#floatholder hasLayout （现在首选方法）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-11T04:45:24.027

看起来像经典的 hasLayout 问题。为最外层的 div 添加宽度或尝试[此处](http://www.satzansatz.de/cssd/onhavinglayout.html)描述的任何其他方法。

# python - 用于 python 的 XMODEM

> ID：358471
> 
> 赞同：2
> 
> 时间：2008-12-11T04:49:04.707
> 
> 标签：python, serial-port, file-transfer, xmodem

我正在编写一个需要使用 XMODEM 从传感器设备传输数据的程序。我想避免编写自己的 XMODEM 代码，所以我想知道是否有人知道是否有任何地方可用的 python XMODEM 模块？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-01T12:40:00.007

```
def xmodem_send(serial, file):
t, anim = 0, '|/-\\'
serial.setTimeout(1)
while 1:
    if serial.read(1) != NAK:
        t = t + 1
        print anim[t%len(anim)],'\r',
        if t == 60 : return False
    else:
        break

p = 1
s = file.read(128)
while s:
    s = s + '\xFF'*(128 - len(s))
    chk = 0
    for c in s:
        chk+=ord(c)
    while 1:
        serial.write(SOH)
        serial.write(chr(p))
        serial.write(chr(255 - p))
        serial.write(s)
        serial.write(chr(chk%256))
        serial.flush()

        answer = serial.read(1)
        if  answer == NAK: continue
        if  answer == ACK: break
        return False
    s = file.read(128)
    p = (p + 1)%256
    print '.',
serial.write(EOT)
return True 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-03-04T16:37:34.073

PyPi 上有 XMODEM 模块。它使用 XModem 处理数据的发送和接收。以下是其用法示例：

```
import serial
try:
    from cStringIO import StringIO
except:
    from StringIO import StringIO
from xmodem import XMODEM, NAK
from time import sleep

def readUntil(char = None):
    def serialPortReader():
        while True:
            tmp = port.read(1)
            if not tmp or (char and char == tmp):
                break
            yield tmp
    return ''.join(serialPortReader())

def getc(size, timeout=1):
    return port.read(size)

def putc(data, timeout=1):
    port.write(data)
    sleep(0.001) # give device time to prepare new buffer and start sending it

port = serial.Serial(port='COM5',parity=serial.PARITY_NONE,bytesize=serial.EIGHTBITS,stopbits=serial.STOPBITS_ONE,timeout=0,xonxoff=0,rtscts=0,dsrdtr=0,baudrate=115200)
port.write("command that initiates xmodem send from device\r\n")
sleep(0.02) # give device time to handle command and start sending response
readUntil(NAK)
buffer = StringIO()
XMODEM(getc, putc).recv(buffer, crc_mode = 0, quiet = 1)
contents = buffer.getvalue()
buffer.close()
readUntil() 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-11T04:56:57.217

我认为你坚持自己滚动。

您也许可以使用[sz](http://linux.about.com/library/cmd/blcmdl1_sz.htm)，它实现了 X/Y/ZMODEM。您可以调用二进制文件，或将必要的代码移植到 Python。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-11T05:32:48.143

这是[XMODEM](http://www.programmersheaven.com/download/2167/download.aspx)文档的链接，如果您必须编写自己的文档，它将很有用。它对原始的XMODEM、XMODEM-CRC 和XMODEM-1K 有详细的描述。

您可能还会发现此[c 代码](http://www.menie.org/georges/embedded/index.html)感兴趣。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-11T07:26:04.873

您可以尝试使用[SWIG](http://www.swig.org/)为上面链接的 C 库（或您在网上找到的任何其他 C/C++ 库）创建 Python 绑定。这将允许您直接从 Python 使用相同的 C API。

实际的实现当然仍然是 C/C++，因为 SWIG 只是创建与感兴趣的函数的绑定。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-11-05T10:09:10.057

您可以使用一个 python 模块-> [https://pypi.python.org/pypi/xmodem](https://pypi.python.org/pypi/xmodem)

[您可以在http://pythonhosted.org//xmodem/xmodem.html](http://pythonhosted.org//xmodem/xmodem.html)中查看传输协议

# jquery - jQuery TabData：是否可以获取 ClickedTab 数据，而不是索引？

> ID：358495
> 
> 赞同：0
> 
> 时间：2008-12-11T05:12:30.603
> 
> 标签：jquery, tabs, click

我已经设计了 TabMenu 如下

```
<script type="text/javascript">
    $(function() {
      $('#container-1').tabs();
      $('#container-2').tabs();
    }
</script>

.....
<div id="container-1">
    <ul>
    <li><a href="#fragment-1"><span id="start">First</span></a></li>
    </ul>
</div>
<div id="container-2">
    <ul>
    <li><a href="#fragment-1"><span id="end">Last</span></a></li>
    </ul>
</div>
..... 
```

是否可以获取 ClickedTab 数据而不是索引？就像 ClickTab 是 first then 一样`#fragment1`。否则，如果 ClickTab 是最后一个，`#fragment2`.

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-11T05:30:26.727

你能澄清你的意思吗？

如果你改变这个：

```
<li><a href="#fragment-1"><span id="end">Last</span></a></li> 
```

至：

```
<li><a href="#fragment-2"><span id="end">Last</span></a></li> 
```

然后它会在您单击它时加载#fragment-2。

如果您确实想获取单击选项卡的数据，则可以挂钩到 tabsselect 事件

```
$('.ui-tabs-nav').bind('tabsselect', function(event, ui) {
//ui.panel is a dom element that contains the contents of the clicked tab.
} 
```

进一步阅读可在[Jquery UI 文档中找到](http://docs.jquery.com/UI/Tabs)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-11T14:16:27.353

我希望这意味着你得到了另一部分的工作。在前面的示例的基础上，这是可能的：

```
 $(document).ready(function() {
      $('#container-1').tabs({
          selected : function(e, ui) {
            if ($($("a", e.target).get(ui.index)).attr('href') == '#fragment-1') {
                alert('First clicked!');
            }
          }        
      }); 
  });
   ....
  <div  id="container-1">
        <ul>
            <li><a href="#fragment-1"><span>Home</span></a></li>
            <li><a href="#fragment-2"><span>Contact</span></a></li>

         </ul>
  </div> 
```

最终，使用 index 可能会更好，因为这需要您了解一些选项卡实现细节，并且您可以使用开关来处理每个选项卡的逻辑。但是，如果您觉得内容更适合您的需求，那么这应该可以正常工作。

# mysql - MySQL中的base64编码

> ID：358500
> 
> 赞同：53
> 
> 时间：2008-12-11T05:20:08.823
> 
> 标签：mysql, base64

我想从一个表中选择一个 blob col，base64 对其进行编码并将其插入到另一个表中。有什么方法可以做到这一点，而无需将数据从数据库和我的应用程序中往返？

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2011-09-08T16:27:07.473

我一直在寻找同样的东西，我刚刚看到 MySQL 5.6 有几个新的字符串函数支持这个功能：[TO_BASE64](http://dev.mysql.com/doc/refman/5.6/en/string-functions.html#function_to-base64)和[FROM_BASE64](http://dev.mysql.com/doc/refman/5.6/en/string-functions.html#function_from-base64)。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-08-27T08:33:06.160

[当编码字符串为 32 字节（空格）时，来自http://wi-fizzle.com/downloads/base64.sql](http://wi-fizzle.com/downloads/base64.sql)的函数包含一些错误，例如 BASE64_ENCODE(CONCAT(CHAR(15), CHAR(32)))。这是修正功能

```
DELIMITER $$

USE `YOUR DATABASE`$$

DROP TABLE IF EXISTS core_base64_data$$
CREATE TABLE core_base64_data (c CHAR(1) BINARY, val TINYINT)$$
INSERT INTO core_base64_data VALUES 
('A',0), ('B',1), ('C',2), ('D',3), ('E',4), ('F',5), ('G',6), ('H',7), ('I',8), ('J',9),
('K',10), ('L',11), ('M',12), ('N',13), ('O',14), ('P',15), ('Q',16), ('R',17), ('S',18), ('T',19),
('U',20), ('V',21), ('W',22), ('X',23), ('Y',24), ('Z',25), ('a',26), ('b',27), ('c',28), ('d',29),
('e',30), ('f',31), ('g',32), ('h',33), ('i',34), ('j',35), ('k',36), ('l',37), ('m',38), ('n',39),
('o',40), ('p',41), ('q',42), ('r',43), ('s',44), ('t',45), ('u',46), ('v',47), ('w',48), ('x',49),
('y',50), ('z',51), ('0',52), ('1',53), ('2',54), ('3',55), ('4',56), ('5',57), ('6',58), ('7',59),
('8',60), ('9',61), ('+',62), ('/',63), ('=',0) $$

DROP FUNCTION IF EXISTS `BASE64_ENCODE`$$

CREATE DEFINER=`YOUR DATABASE`@`%` FUNCTION `BASE64_ENCODE`(input BLOB) RETURNS BLOB
    DETERMINISTIC
    SQL SECURITY INVOKER
BEGIN
    DECLARE ret BLOB DEFAULT '';
    DECLARE done TINYINT DEFAULT 0;
    IF input IS NULL THEN
        RETURN NULL;
    END IF;
each_block:
    WHILE NOT done DO BEGIN
        DECLARE accum_value BIGINT UNSIGNED DEFAULT 0;
        DECLARE in_count TINYINT DEFAULT 0;
        DECLARE out_count TINYINT;
each_input_char:
        WHILE in_count < 3 DO BEGIN
            DECLARE first_char BLOB(1);

            IF LENGTH(input) = 0 THEN
                SET done = 1;
                SET accum_value = accum_value << (8 * (3 - in_count));
                LEAVE each_input_char;
            END IF;

            SET first_char = SUBSTRING(input,1,1);
            SET input = SUBSTRING(input,2);

            SET accum_value = (accum_value << 8) + ASCII(first_char);
            SET in_count = in_count + 1;
        END; END WHILE;

        -- We've now accumulated 24 bits; deaccumulate into base64 characters
        -- We have to work from the left, so use the third byte position and shift left
        CASE
            WHEN in_count = 3 THEN SET out_count = 4;
            WHEN in_count = 2 THEN SET out_count = 3;
            WHEN in_count = 1 THEN SET out_count = 2;
            ELSE RETURN ret;
        END CASE;

        WHILE out_count > 0 DO BEGIN
            BEGIN
                DECLARE out_char CHAR(1);
                DECLARE base64_getval CURSOR FOR SELECT c FROM core_base64_data WHERE val = (accum_value >> 18);
                OPEN base64_getval;
                FETCH base64_getval INTO out_char;
                CLOSE base64_getval;
                SET ret = CONCAT(ret,out_char);
                SET out_count = out_count - 1;
                SET accum_value = accum_value << 6 & 0xffffff;
            END;
        END; END WHILE;
        CASE
            WHEN in_count = 2 THEN SET ret = CONCAT(ret,'=');
            WHEN in_count = 1 THEN SET ret = CONCAT(ret,'==');
            ELSE BEGIN END;
        END CASE;

    END; END WHILE;
    RETURN ret;
END$$

DELIMITER ; 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2016-06-15T14:17:09.903

```
SELECT `id`,`name`, TO_BASE64(content) FROM `db`.`upload` 
```

这会将 blob 值从**内容**列转换为 base64 字符串。然后你可以用这个字符串做任何你想做的事情，甚至将它插入另一个表

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-12-11T05:23:41.267

看起来没有，虽然[它是请求](http://bugs.mysql.com/bug.php?id=18861)的，并且有一个 UDF。

编辑：或者有……[这个](http://209.85.173.132/search?q=cache:Wzk4yszgatQJ:www.phpobjectgenerator.com/plog/file_download/25+mysql+mime+encode&hl=en&ct=clnk&cd=6&gl=us)。啊。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2011-08-17T06:12:45.373

对于那些感兴趣的人，这些是迄今为止唯一的选择：

1）使用这些功能：

[http://wi-fizzle.com/downloads/base64.sql](http://wi-fizzle.com/downloads/base64.sql)

2）如果你已经有[sys_eval UDF](http://www.mysqludf.org/lib_mysqludf_sys/index.php)，（Linux）你可以这样做：

```
sys_eval(CONCAT("echo '",myField,"' | base64")); 
```

已知第一种方法很慢。第二个问题是编码实际上发生在 MySQL 的“外部”，这可能存在编码问题（除了您使用 sys_* 函数添加的安全风险之外）。

不幸的是，在 MySQL 中没有 UDF 编译版本（应该更快）也没有原生支持（[Posgresql 支持它](http://www.postgresql.org/docs/9.0/static/functions-string.html)！）。

MySQL 开发团队似乎[对实现它不感兴趣，](http://dbaspot.com/mysql/450824-re-adding-native-base64-functions-mysql-server.html)因为这个功能已经存在于其他语言中，这对我来说似乎很愚蠢。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-03-07T12:29:18.790

另一个不需要支持表的自定义实现：

```
drop function if exists base64_encode;
create function base64_encode(_data blob)
returns text
begin
    declare _alphabet char(64) default 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';
    declare _lim int unsigned default length(_data);
    declare _i int unsigned default 0;
    declare _chk3 char(6) default '';
    declare _chk3int int default 0;
    declare _enc text default '';

    while _i < _lim do
        set _chk3 = rpad(hex(binary substr(_data, _i + 1, 3)), 6, '0');
        set _chk3int = conv(_chk3, 16, 10);
        set _enc = concat(
            _enc
            ,                  substr(_alphabet, ((_chk3int >> 18) & 63) + 1, 1)
            , if (_lim-_i > 0, substr(_alphabet, ((_chk3int >> 12) & 63) + 1, 1), '=')
            , if (_lim-_i > 1, substr(_alphabet, ((_chk3int >>  6) & 63) + 1, 1), '=')
            , if (_lim-_i > 2, substr(_alphabet, ((_chk3int >>  0) & 63) + 1, 1), '=')
        );
        set _i = _i + 3;
    end while;

    return _enc;
end;

drop function if exists base64_decode;
create function base64_decode(_enc text)
returns blob
begin
    declare _alphabet char(64) default 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';
    declare _lim int unsigned default 0;
    declare _i int unsigned default 0;
    declare _chr1byte tinyint default 0;
    declare _chk4int int default 0;
    declare _chk4int_bits tinyint default 0;
    declare _dec blob default '';
    declare _rem tinyint default 0;
    set _enc = trim(_enc);
    set _rem = if(right(_enc, 3) = '===', 3, if(right(_enc, 2) = '==', 2, if(right(_enc, 1) = '=', 1, 0)));
    set _lim = length(_enc) - _rem;

    while _i < _lim
    do
        set _chr1byte = locate(substr(_enc, _i + 1, 1), binary _alphabet) - 1;
        if (_chr1byte > -1)
        then
            set _chk4int = (_chk4int << 6) | _chr1byte;
            set _chk4int_bits = _chk4int_bits + 6;

            if (_chk4int_bits = 24 or _i = _lim-1)
            then
                if (_i = _lim-1 and _chk4int_bits != 24)
                then
                    set _chk4int = _chk4int << 0;
                end if;

                set _dec = concat(
                    _dec
                    ,                        char((_chk4int >> (_chk4int_bits -  8)) & 0xff)
                    , if(_chk4int_bits >  8, char((_chk4int >> (_chk4int_bits - 16)) & 0xff), '\0')
                    , if(_chk4int_bits > 16, char((_chk4int >> (_chk4int_bits - 24)) & 0xff), '\0')
                );
                set _chk4int = 0;
                set _chk4int_bits = 0;
            end if;
        end if;
        set _i = _i + 1;
    end while;

    return substr(_dec, 1, length(_dec) - _rem);
end; 
```

[要旨](https://gist.github.com/bbars/d7d16c22da7c414e5f2d5fc812a01ac0)

您应该在解码后转换字符集：`convert(base64_decode(base64_encode('ёлка')) using utf8)`

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-12-01T22:50:20.993

如果您在 < 5.6 时需要这个，我偶然发现了这个似乎工作正常的 UDF：

[https://github.com/y-ken/mysql-udf-base64](https://github.com/y-ken/mysql-udf-base64)

* * *

## 回答 #8

> 赞同：-4
> 
> 时间：2018-05-22T12:16:44.527

创建表加密（用户名 varchar(20)，密码 varbinary(200)）

插入加密值('raju',aes_encrypt('kumar','key')) select *,cast(aes_decrypt(password,'key') as char(40)) from encrypt where username='raju';

# wpf - WPF - 添加自定义字体

> ID：358501
> 
> 赞同：15
> 
> 时间：2008-12-11T05:21:13.050
> 
> 标签：wpf, fonts, embedded-resource

我正在尝试在我的应用程序中添加自定义字体作为资源。我在应用程序中有一个“CustomFont”目录，其中的所有字体都设置为“Resource”

```
<Window.Resources>
    <Style x:Key="Gotham-XLight">
        <Setter Property="TextElement.FontFamily" 
                Value="/CustomFonts;Component/#Gotham-XLight" />
    </Style>
</Window.Resources> 
```

然后在我的 TextBlock 上我有这个：（在网格内）

```
<TextBlock x:Name="TimeTextBlock" Style="{DynamicResource Gotham-XLight}" 
           TextAlignment="Center" FontSize="25" FontWeight="Bold" 
           Foreground="White" Text="TextBlockTimer" 
           Margin="105,242.974,0,226.975" HorizontalAlignment="Left" 
           Width="221.919" /> 
```

但我没有像人们说的那样看到我的字体。难道我做错了什么？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-12-11T05:58:34.300

您可能想要检查字体的名称，您需要指定字体的名称而不是文件的名称。

双击字体文件，它应该显示一个“字体名称：”，这就是您要确保在您的样式中指定的内容。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-11T05:33:34.570

试试这个

```
<Window.Resources>
    <Style x:Key="Gotham-XLight">
        <Setter Property="TextElement.FontFamily" Value="CustomFonts/#Gotham-XLight" />
    </Style>
</Window.Resources> 
```

此外，如果您不打算在运行时更改样式，`{StaticResource Gotham-XLight}`则性能会更高。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-05-24T10:20:02.620

在 xaml 我这样做是这样的：

```
 <Button Grid.Column="1" Grid.RowSpan="2" Name="start" Margin="5" Click="start_Click">
        <TextBlock Name="test" FontFamily="pack://application:,,,/Y_Yoga;Component/Resources/#FontAwesome">&#xF04B;</TextBlock>
    </Button> 
```

但是，我不知道#FontAwesome 是字体的嵌入名称还是我重命名了 .ttf 文件的结果。

希望对您有所帮助！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-02-11T14:37:32.390

迟到的回复，但值得一提。要添加将在您的窗口中全局应用的自定义字体，您可以将其添加到您的 csproj 文件中，以将项目的 Fonts 文件夹中的字体作为资源包含在内。

```
 <ItemGroup>
    <Resource Include="Fonts\*.ttf" />
 </ItemGroup> 
```

然后在您的窗口 XAML 中，您可以在窗口部分指定 FontFamily：

```
<Window x:Class="Namespace.MainWindow"
    ...
    FontFamily="/Fonts/#[FONT NAME]"
    Title="">
  <Grid>
    ...
  </Grid>
</Window> 
```

我希望这可以帮助某人，因为我花了一些时间来弄清楚。

# html - 考虑到黑莓的 html 电子邮件

> ID：358518
> 
> 赞同：5
> 
> 时间：2008-12-11T05:42:41.960
> 
> 标签：html, css, email, blackberry

我支持发送自动填充电子邮件警报的系统。我已经使用 CSS 和 html 的组合呈现了页面。警报是从名为 Salesforce 的系统发送的。我的问题是，我从来没有拥有过黑莓，也无权使用黑莓进行测试，但我知道警报看起来像废话。

在渲染并剥离所有样式、表格等之后，它似乎将页面作为纯文本读取。我应该采用哪些考虑因素来增加黑莓上警报的可读性。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-07-13T15:27:18.560

首先，为了在 BlackBerry 模拟器上查看 HTML 呈现的电子邮件，无论型号如何，模拟器都必须通过 BES 连接（企业 BlackBerry 服务器）运行，因为**包含的 ESS**（软件 POP/SMTP 代理应用程序）允许您在本地测试 BlackBerry 电子邮件服务），**不支持 HTML 电子邮件**。

或者，如果您无法访问 BES，您仍然可以使用 BIS（个人互联网连接）测试 HTML 电子邮件呈现，但您需要在**真实设备**上进行。您可以相当快速地构建一个程序，该程序在设备上侦听收到的电子邮件，然后将收到的电子邮件的原始来源提供给您进行调试。

话虽如此，旧型号的 BlackBerry（围绕 RIM OS 4.1）不支持 HTML 电子邮件。如果他们收到 HTML 电子邮件，**他们将显示完整的 HTML 源代码**、标签和所有内容。

从 RIM OS 4.5 开始，HTML 支持已在 BlackBerry 电子邮件应用程序中实现。在这些情况下，如果设备接收到 HTML 消息，它将尽可能地尝试显示 HTML 呈现的格式。

如果设备由于某种原因无法呈现 HTML（例如，如果这是使用 ESS 运行的模拟器），并且消息是**MIME 混合**，其中**在一条消息中包含 HTML 和纯文本部分**，则设备将显示电子邮件的纯文本版本。**如果电子邮件仅为 HTML**，并且在同一电子邮件中不包含纯文本等效项，则设备将尝试去除 HTML 位和标签等，并尝试呈现 HTML 消息因为它是自己的纯文本版本。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-11T15:59:19.407

一种测试选项是运行[BlackBerry 模拟器](http://na.blackberry.com/eng/developers/resources/simulators.jsp)。向他们发送电子邮件非常棘手，但如果您将消息设置为网页，您至少可以使用浏览器来测试渲染。

我不相信 joshperry 的评论，即浏览器和电子邮件应用程序的渲染是相同的，但是黑莓平台再次成为开发的噩梦，我在很多事情上都错了......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-11T16:06:02.000

也许您应该以 HTML 和纯文本格式发送电子邮件。使用纯文本，您仍然可以以体面的方式格式化内容。有更多的群体更喜欢纯文本而不是 HTML。电子邮件协议以及大多数客户端和服务器都支持以这两种格式发送消息。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-23T23:59:17.093

最后检查了 Litmus 在多个浏览器中的兼容性，然后确保文本呈现是可识别的，并且我所有的“替代文本”都是有序的。( [litmusapp.com](http://litmusapp.com) ) 非常漂亮的工具不会让您知道任何兼容性问题，但允许您参考一个链接，以便那些相信您当前的 Microsoft Word 电子邮件模板在他们的计算机上正常工作的营销人员。PS它免费呈现gmail和hotmail。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-12-11T06:14:54.110

直到最近，RIM 才发布了支持 HTML 电子邮件的固件。该固件仍然需要由运营商定制并由消费者更新。此外，BES 服务器必须升级到最新版本才能支持 HTML 电子邮件。

我的猜测是，此时支持 HTML 电子邮件的黑莓用户并不多。我已经用盗版固件升级了我的，不得不说即使支持 HTML 电子邮件也很受欢迎。有时他们渲染，有时他们不渲染；有时取决于发件人，有时仅取决于一天中的时间。

不过，黑莓对 HTML 电子邮件的支持非常符合行业标准，如果它能够在黑莓网络浏览器中正确呈现，它应该看起来像电子邮件一样好。

# java - Java：如何创建特定父类型而不是其子类型的集合？

> ID：358521
> 
> 赞同：1
> 
> 时间：2008-12-11T05:43:40.150
> 
> 标签：java, generics

我正在学习 Java 进行测试（明天），并且想知道一个可能永远不会出现但让我好奇的问题。

是否可以创建一个新的集合类，例如列表或只能包含特定类型而不是其子类型的东西？我会使用泛型来实现这个目标吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-11T05:47:36.600

不是真的，或者至少实际上不是。

子类型应该像数学集合论中的集合一样运行。如果 B 是 A 的子集，则 B 中的任何项目也是 A 中的项目。

同样，如果 B 是 A 的子类型，则 B 中的任何项也是 A 的项。因此，A 的任何集合必须能够维护 B 的项。

话虽如此，B 可能会以令人不安的方式覆盖某些操作，以显式破坏在集合中使用它或实例化它的能力。

我认为泛型不会解决这个问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-11T06:00:06.217

如果创建自定义集合类，则可以在插入时使用反射检查对象的类，如果它不是特定的确切类型，则拒绝它。或者，如果您可以控制集合中包含的类的类定义，将其设为 final 将阻止创建子类。（如果您需要子类用于其他用途，显然这是一个问题）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-11T09:56:17.737

问题是：你为什么要这样。如果您有一个包含动物的列表，为什么要仅使用“基本动物”填充该列表，但要防止将狗或猫添加到列表中。OO 的基本概念之一是您在需要基类实例的任何地方都使用子类的实例（[维基百科：Liskov 替换原则](http://en.wikipedia.org/wiki/Liskov_substitution_principle)）。如果这不适用于您的情况，则您的类层次结构可能有问题。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-11T05:59:29.027

您可以在包含的类的类定义中使用“final”来禁止对其进行子类型化。我没有立即看到如何对此进行测试或将泛型限制为需要最终类。您可以使用反射来测试该类是否具有 final 修饰符集，例如在构造集合时，如果没有，则抛出。

如果类本身不是最终类，您可以检查添加到集合中的每个对象，以确保其运行时类正是该集合想要的类，而不是它的子类。

有关 Java 反射的信息，请参见[http://java.sun.com/docs/books/tutorial/reflect/ 。](http://java.sun.com/docs/books/tutorial/reflect/)

# windows - 如何判断鼠标指针图标是否改变

> ID：358527
> 
> 赞同：1
> 
> 时间：2008-12-11T05:50:00.293
> 
> 标签：windows, mouse, capture

我正在 Delphi 7 中为 Windows 编写屏幕录制应用程序，并希望知道鼠标指针何时在我的应用程序中发生变化（例如从普通指针到调整大小指针等）。

目前我正在做的是将鼠标指针绘制到内存中的位图上，每次鼠标移动（以及在计时器上），并将其与我绘制的最后一个位图进行逐个像素的比较。

虽然比较相当快（大约 2-5 毫秒），因为它经常发生（每次鼠标移动）它加起来。我认为必须有一种更快、更简单的方法！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-11T06:28:02.523

你有光标的句柄，对吧？如果它与您之前的句柄值相同，那么我认为假设它看起来也相同是合理的。如果光标看起来不同，它将具有不同的句柄值。

对于标准系统游标，这当然应该是正确的。如果您正在记录的应用程序正在运行时创建新游标，那么它*可能*能够更新当前游标的外观，而无需在操作系统中实际创建新游标对象（从而保持相同的句柄值），但是我认为这不太可能，特别是因为`SetCursor`当光标没有改变时立即退出，而且我希望 API 函数也不会进行您试图避免的图形比较。它只是比较`HCursor`值。

# c++ - 对于 C++ 开发人员来说，学习 Boost 有多重要？

> ID：358533
> 
> 赞同：25
> 
> 时间：2008-12-11T06:00:44.653
> 
> 标签：c++, boost, libraries

我很想学习[Boost](http://www.boost.org/)。但我想问：

*   努力学习 Boost 有多重要？
*   在加入 Boost 之前应该具备哪些先决条件？

为什么我很想知道 Boost 是因为很多人在 IRC 的频道和 StackOverflow 上都在谈论 Boost。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2008-12-11T06:35:21.090

我认为任何认真考虑将 C++ 开发作为职业的人都应该学习 Boost，并且学好它。一旦你开始认真的编程，你就会意识到这些库有多大的好处，以及它们可以让你提高多少工作效率。它们不仅是跨平台的，而且一旦你开始处理大量数据，数学库尤其会像是上天赐予的礼物。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-12-11T07:54:06.440

作为一名游戏开发者，我对有多少人不了解 Boost 感到震惊。我已经向各个游戏工作室的联系人提到过它，不仅它经常不使用（许可或移植它是一个问题吗？）而且很多人甚至没有听说过它。这让我相信，从职业的角度来看，学习 Boost 实际上并不重要，但从个人发展的角度来看，它绝对是至关重要的。:)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-12-11T06:14:30.337

之前讨论过：[使用 c++ boost 库有什么好处](https://stackoverflow.com/questions/125580/what-are-the-advantages-of-using-the-c-boost-libraries#125922)。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-12-11T09:18:20.357

至于任何先决条件，您应该熟悉 STL，并且有一些模板经验不会有什么坏处。我总是对有多少 C++ 程序员实际上既不使用 STL 也不使用模板感到惊讶。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-12-11T08:30:55.723

这非常重要，尤其是当许多来自 Boost 的库正在进入 C++ 标准时——通过使用 Boost，您可以及早了解标准的外观（`shared_ptr`有人知道吗？）。

此外，即使您不使用它们，Boost 库也写得非常好，而且通常看起来很有趣；他们做了一些非常高级的 C++。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-12-12T01:02:58.110

我觉得 boost 是一种生产力增强剂，我认为我不会接受在不使用 boost 的 C++ 商店的工作。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2010-06-03T05:09:04.780

语言是一种工具。如果它可以帮助您完成某事，请使用它。

我厌倦了这些宗教。“我应该使用 Boost 吗？如果我不使用 Boost，那是否意味着我不是真正的 C++ 程序员？其他 C++ 程序员会喜欢我吗？” 请。*任何关心你是否*使用 Boost 或任何其他库的C++ 程序员都是思想封闭的混蛋，你应该与他无关。

相反，去找一个聪明、思想开放的人，他可以告诉你 Boost 和 who-knows-what-other 库如何帮助他完成自己的工作。他甚至会承认有时你不需要那些库。

替代答案：自己重新实现部分 Boost 或 STL 是保持编程能力敏锐的好方法。换句话说，一个因为没有库而不能回退到 C 的 C++ 程序员是一个弱程序员。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-12-11T06:13:30.057

Boost 拥有丰富的库，您可以免费获得它。了解 boost 中可用的所有库，以便在需要时可以使用。关于学习，请选择包含在 c++0X 中的库，以便你可以使用它，很快编译器就会支持。关于特定的库，当你需要的时候学习它。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-12-11T06:43:37.470

从关于 C++ 的大量关于 SO 的问题（从科学上 :-) 来看，这些问题在“使用 Boost::SomethingOrOther”方面具有最高评价的答案，我会说这非常重要。

吸引我从 C 到 Java 而不是 C++ 的原因是 Java 中提供的**大量**类。Boost 几乎设法说服我回去，除了我现在深陷在以 Java 为通用语的 Web 服务中。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-12-11T15:28:34.930

请记住，boost 只是一组可用于提高生产力的库（停止重新发明轮子）。

众所周知，它们写得很好，并且使用了您可能不会（即绝对不会）自己想到的技术。如果您的目的是查看源代码以学习高级 C++ 技术，那么您将自己淘汰，但我想我会买一本好书。

另一方面，如果您只想使用一些库函数来提高工作效率，请考虑您的选择。你在开发什么，你需要什么样的库？

我们公司有广泛使用 boost 的跨平台产品，但我们也有使用一些 boost 但在大多数情况下依赖于 Microsoft 库的仅限 Windows 的产品。MS 库质量很好，并且有（imo）优秀的文档（MS 成功的一部分在于使 Windows 尽可能易于为第三方开发人员编程）。我特别提到了 MS，因为它们提供了广泛的库，用于提升等多种用途。我们还使用了许多其他更专注的第 3 方库（即在某个领域提供功能的库，例如密码学）。

# mysql - 类似 Twitter 的“关注用户”和“观看这个”问题

> ID：358534
> 
> 赞同：1
> 
> 时间：2008-12-11T06:00:50.270
> 
> 标签：mysql, database, triggers, many-to-many

处理多对多触发关系的最佳方法是什么，例如 Twitter“关注此用户”问题。

我对用户“观看”线程的回复有类似的问题。如果有 10,000 个用户在观看一个帖子，并且有人回复，那么如何最好地通知观看者？我能想到的只有以下几点：

插入后，检查“监视表”[字段：user_id，thread_id] 是否有任何匹配此线程 ID 的线程。这是我需要通知的用户列表。对于每个需要通知的用户，在“通知表”[字段：user_id、message、addon 等]中插入一行。现在我可以通过这个表向任何用户显示他们的通知。

问题是，这一切听起来非常非常昂贵。尤其是 10,000 刀片部分。

必须有更好的方法来做到这一点......想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-11T06:43:05.600

在您的监视表中，您可以添加一个`last_updated`字段并在监视线程更新时进行设置。还要添加一个字段`last_notified`，当你通知用户时设置这个，你就会知道如果你需要通知用户`last_updated > last_notified`。当您决定需要通知用户时，只需向他们显示来自线程的所有消息，并带有`post_date >= last_updated`.

# javascript - Firefox 3 中的 getImageData 导致 NS_ERROR_DOM_SECURITY_ERR

> ID：358538
> 
> 赞同：2
> 
> 时间：2008-12-11T06:02:45.710
> 
> 标签：javascript, firefox, getimagedata

我正在尝试开发一个将在 Firefox 3 中使用 javascript 中的 getImageData 的应用程序，但我`NS_ERROR_DOM_SECURITY_ERR`在 getImageData 调用中得到一个“”。javascript 和图像当前都由硬盘驱动器提供服务，这显然违反了安全性？当这是现场直播时，它们都将由同一个域提供服务，所以这不会成为问题，但同时我该如何开发呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-14T12:34:17.577

您可以告诉浏览器关闭错误。根据您的情况，解决方案是好是坏。我尝试将其包装起来，因此如果不是问题，将不会显示安全对话框。

```
 var data;
  try {
    try {
      data = context.getImageData(sx, sy, sw, sh).data;
    } catch (e) {
      netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead");
      data = context.getImageData(sx, sy, sw, sh).data;
    }
  } catch (e) {
    throw new Error("unable to access image data: " + e);
  } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-11T06:06:45.000

您可以尝试安装本地网络服务器，例如 Apache（在 unix 上）或 IIS（在 Windows 上）。这最终将为您提供与 Web 相关的内容的最佳本地测试平台，因为正如您所发现的，浏览器处理来自文件系统的文件与来自网络服务器的内容完全不同。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-08-06T15:19:00.400

在 Firefox 中，在地址栏中输入“about:config”。然后使用搜索字段搜索“security.fileuri.strict_origin_policy”。双击它以将其设置为“false”。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-22T03:49:38.923

我在 FireFox 11.0 中使用时遇到了同样的问题`getImageData`……我所有的文件和代码都在我的服务器上，而我的本地计算机上什么也没有。

我想也许这对和我有同样问题的人有帮助。

看起来 Firefox 对待

```
http://mySite.com 
```

作为不同的域

```
http://www.mySite.com 
```

所以我曾经在用户不输入时`.htaccess`添加`www.`

```
RewriteEngine On
RewriteCond %{HTTP_HOST} ^mySite\.com$ [NC]
RewriteRule ^(.*)$ http://www.mySite.com/$1 [L,R=301] 
```

现在它工作正常并且不再显示`NS_ERROR_DOM_SECURITY_ERR`。

# load-testing - 负载测试工具

> ID：358539
> 
> 赞同：-1
> 
> 时间：2008-12-11T06:04:59.047
> 
> 标签：load-testing, trialware

我正在寻找一个负载测试工具，它在试用版中支持 20 多个虚拟用户。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-11T07:48:19.553

模棱两可的问题，但请检查The [Grinder](http://grinder.sourceforge.net/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-11T08:01:33.820

Apache JMeter 应该足以应付快速工作。但是，我确实发现 Webload（仅在 Windows 上支持）对于运行更长时间的测试来说更复杂和更舒适的选择。不过，我继续使用它们，这取决于我的情绪波动。

普拉萨纳 S

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-11T08:36:08.243

我曾经将[Apache jMeter](http://jakarta.apache.org/jmeter/ "阿帕奇 jMeter")用于我的毕业论文。借助分布式负载生成的可能性及其直观和强大的配置 gui，您可以模拟大量“老练”用户，使用大量服务，仅受计算能力（例如您控制的机器数量）的限制. 我也建议看看它。

如果您正在寻找网络测试工具，这个答案只会有帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-02T15:11:24.503

[您可以在http://browsermob.com](http://browsermob.com)免费获得 25 个虚拟用户。这是一种不同类型的负载测试。它使用真正的浏览器来回放每笔交易，这意味着您的脚本可以更简单，产生的流量也更真实。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-11T06:30:33.847

在什么类型的环境中？你需要更具体。如果是简单的服务器环境呢？您需要使用物理用户，还是可以使用[Apache JMeter 之类的东西？](http://jakarta.apache.org/jmeter/)

# sql - 如何在 SQL Server 的单个查询中找到第五高薪水

> ID：358542
> 
> 赞同：6
> 
> 时间：2008-12-11T06:06:46.903
> 
> 标签：sql, sql-server, sql-server-2005

如何在 SQL Server 的单个查询中找到第五高薪水

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-12-11T06:11:11.780

在 SQL Server 2005 和 2008 中，创建一个排序的子选择查询，然后添加一个 where 子句，其中 rank = 5。

```
select
  *
from
(
  Select
    SalesOrderID, CustomerID, Row_Number() Over (Order By SalesOrderID) as RunningCount
  From
    Sales.SalesOrderHeader
  Where
    SalesOrderID > 10000
  Order By
    SalesOrderID 
) ranked
where 
  RunningCount = 5 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-11T06:11:21.920

这些在 SQL Server 2000 中工作

```
DECLARE @result int

SELECT TOP 5 @result = Salary FROM Employees ORDER BY Salary DESC 
```

语法应该很接近。我暂时无法测试它。

或者您可以使用子查询：

```
SELECT MIN(Salary) FROM (
    SELECT TOP 5 Salary FROM Employees ORDER BY Salary DESC
) AS TopFive 
```

同样，如果语法完全正确，则不是肯定的，但该方法有效。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-03-30T06:30:42.943

```
SELECT MIN(Salary) FROM (
    SELECT TOP 2 Salary FROM empa ORDER BY Salary DESC
) AS TopFive 
```

它工作正常，请使用它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-06T07:36:38.707

```
SELECT TOP 1 salary
FROM (
    SELECT DISTINCT TOP n salary
    FROM employee
    ORDER BY salary DESC) a
ORDER BY salary
where n > 1 -- (n is always greater than one) 
```

您可以使用此查询找到任意数量的最高薪水。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-02-09T06:55:08.470

要从数据库中查找第 5 高的薪水，查询是..

```
select MIN(esal) from (
    select top 5 esal from tbemp order by esal desc) as sal 
```

它的工作检查出来

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-11-28T19:09:16.633

最容易通过以下方式解决：

```
SELECT MIN(Salary) FROM (
SELECT Salary FROM empa ORDER BY Salary DESC limit 5
)TopFive 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-11T09:51:14.657

您可以尝试以下操作：

```
select salary
from Employees a
where 5=(select count(distinct salary)
         from Employees b
         where a.salary > b.salary)
order by salary desc 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-07-17T09:50:18.837

您可以使用以下查询找到它：

```
select top 1 salary 
from (select top 5 salary
      from tbl_Employee
      order by salary desc) as tbl 
order by salary asc 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-07-23T17:03:32.860

```
select * from employee2 e
where 2=(select count(distinct salary) from employee2
         where e.salary<=salary) 
```

它的工作

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-05-03T07:30:48.043

下面的查询在特定员工姓名之后获得最高薪水。

看看那个！

```
SELECT TOP 1 salary FROM (
    SELECT DISTINCT min(salary) salary
    FROM emp where salary > (select salary from emp where empname = 'John Hell') 
    ) a 
ORDER BY salary 
```

# java - Java中ArrayList之间的转换

> ID：358546
> 
> 赞同：8
> 
> 时间：2008-12-11T06:09:35.387
> 
> 标签：java, casting, arraylist

抱歉，我认为这是一个继承问题：一直是一个 ArrayList 问题！

好的，我的问题比我想象的更具体。所以我有两个班级。卡片和区域。区域是存放卡片的盒子。

Zone 的前两个子类 ZoneList 和 ZoneMap 是存储卡片的两种不同方式。其他子类，例如 Hand 和 PokerHand，有自己特定的方式来处理它们存储的牌。

复杂之处在于 Card 也有子类，例如 PokerCard，而 ZoneList 和 ZoneMap 的子类旨在组织这些子类。

所以在 ZoneList 我有`protected ArrayList<Card> cardBox;`，在 PokerHand 我希望能够声明`cardBox = new ArrayList<PokerCard>();`，因为 PokerCard 是一张卡片。我得到的错误是，当涉及到 ArrayLists 时，我显然无法在 Card 和 GangCard 之间进行转换......所以我试图通过`private ArrayList<PokerCard> cardBox;`在 PokerHand 中重新声明 cardBox 来解决这个问题，但这导致了隐藏的问题我的程序。

所以真的，问题是关于 ArrayLists 之间的转换？Java告诉我我不能，所以有什么想法可以吗？

z。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-12-11T07:23:07.030

Marc 和 kolstae 就如何解决该问题给出了很好的答案，但我认为值得解释*为什么*您的原始代码不起作用。

为了简化问题，我倾向于将问题放在水果方面。假设我们有：

```
List<Banana> bananaBunch = new ArrayList<Banana>();
List<Fruit> fruitBowl = bananBunch;
fruitBowl.add(new Apple()); 
```

如果允许这样做，我们最终会得到一堆香蕉中的一个苹果，这显然是一件坏事。那么，问题出在哪里？第一行必须没问题，第三行必须没问题——你可以添加任何种类的水果`List<Fruit>`——所以问题必须在第二行。这就是被禁止的，正是为了避免这种问题。

这些帮助有用？

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-12-11T07:10:18.320

如果我对您的理解正确，您可能应该声明：

```
public class ZoneList<T extends Card> {
   protected List<T> cardBox;
}

public class PokerHand extends ZoneList<PokerCard> {
   public PokerHand() {
      cardBox = new ArrayList<PokerCard>();
   }
} 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-12-11T07:09:34.237

首先，使用 getter/setter 方法通常比直接访问属性更好，尤其是当您要进行大量复杂的继承时。

至于泛型问题，您可以尝试将超类（或顶级接口/抽象类）中的 cardBox getter 定义为：

```
protected ArrayList<? extends Card> getCardBox(); 
```

这样，您可以在子类中覆盖它并让它们返回任何类型的 Card 子类的列表。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2014-08-10T22:11:42.860

一种方法是先转换为 ArrayList：

```
ArrayList<Card> cards = (ArrayList<Card>)(ArrayList<?>) (pokerCardObjects); 
```

没有铸造的另一种选择：

使用流：

```
ArrayList<Card> cards = pokerCardObjects.stream().collect(Collectors.toCollection(ArrayList::new); 
```

或者创建一个新的 ArrayList：

```
ArrayList<Card> cards = new ArrayList<>(pokerCardObjects); 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-12-11T09:43:59.773

如前所述，您不能`ArrayList<PokerCard>`转换为`ArrayList<Card>`，但可以`ArrayList<PokerCard>`转换为`ArrayList<? extends Card>`。或者更好地`List<? extends Card>`用作您的返回值，因为您可能无论如何都不依赖 ArrayList 实现：

```
protected ArrayList<? extends Card> getCardBox(); 
```

至于您在评论中的问题，构造应该按照您的描述工作：`List<? extends Card> list = new ArrayList<Card>();`. 您可能必须填写您的列表，因此该方法可能是这样的：

```
protected ArrayList<? extends Card> getCardBox() {
    List<Card> list = new ArrayList<Card>();
    list.add(pokerCard1);
    list.add(pokerCard2);
    return java.util.Collections.unmodifiableList(list);
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-11T06:32:01.580

这将取决于 Arraylist 中的访问控制是什么`Zonelist`。我对调试器语句的假设是它要么是未标记的，要么是公开的，要么是受保护的。子类可以通过定义具有相同名称的变量来“隐藏”它可以访问的父类变量。您还可以使用`this`关键字来引用特定对象实例和`super`关键字来引用父对象。

这是Java中基本访问控制的一个很好的链接：

[http://java.sun.com/docs/books/tutorial/java/javaOO/accesscontrol.html](http://java.sun.com/docs/books/tutorial/java/javaOO/accesscontrol.html)

这可能对您也有帮助

[http://java.sys-con.com/node/46344](http://java.sys-con.com/node/46344)

# math - 通过 3 点相关性对齐点云？

> ID：358557
> 
> 赞同：2
> 
> 时间：2008-12-11T06:18:24.977
> 
> 标签：math, 3d, geometry, points, vertices

假设我有 3 个点云：第一个点云有 3 个点 {x1,y1,z1}、{x2,y2,z2}、{x3,y3,z3}，第二个点云与 {xx1,yy1, zz1}, {xx2,yy2,zz2}, {xx3,yy3,zz3} ...我假设将第二个点云与第一个点云对齐，我必须将第二个点乘以 T[3x3matrix]。

1）那么我如何找到这个变换矩阵（T）？我试图用手做方程式，但未能解决它们。某处是否有解决方案，因为我很确定我不是第一个遇到问题的人。

2）我假设矩阵可能包括倾斜和剪切。有没有办法找到只有 7 个自由度（3translation、3rotation、1scale）的矩阵？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-11T06:27:45.147

将单位向量 {1, 0, 0}, {0, 1, 0} 和 {0, 0, 1} 取为 {x1, y1, z1}, {x2, y2, z2} 的变换矩阵 T1， {x3, y3, z3} 很简单

```
     | x1 x2 x3 |
T1 = | y1 y2 y3 |
     | z1 z2 z3 |
```

同样，将这 3 个单位向量带到第二组点的变换 T2 是

```
     | xx1 xx2 xx3 |
T2 = | yy1 yy1 yy3 |
     | zz1 zz2 zz3 |
```

因此，前三点到后三点的矩阵由 T2 * T1 ^(-1)给出。如果 T1 是非奇异的，那么这个变换是唯一确定的，所以它没有自由度。如果 T1 是奇异矩阵，则可能没有解，或者可能有无穷多个解。

当你说你想要 7 个自由度时，这有点误用了术语。在一般情况下，该矩阵由 3 个旋转自由度、3 个缩放度和 3 个剪切度组成，总共 9 个。您可以通过执行[QR 分解](http://en.wikipedia.org/wiki/QR_factorization)来计算这些参数。Q 矩阵为您提供旋转参数，R 矩阵为您提供缩放参数（沿对角线）和剪切参数（对角线上方）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-11T07:24:59.197

Adam Rosenfield 的方法是正确的。但是 T2 * Inv (T1) 的解决方案是错误的。由于在矩阵乘法中 A * B != B * A ：因此结果为 Inv(T1) * T2

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-11T07:53:40.090

您所说的[七参数变换](http://www.sedris.org/stc/2004/tu/srm/sld033.htm)被称为 3d 保形变换，或者有时是 3d 相似变换，因为这两个云是相似的。如果两个形状相同，则 Adam Rosenfields 解决方案很好。如果差异很小，并且您希望获得最佳拟合，最常用的解决方案是[Helmert 变换](http://en.wikipedia.org/wiki/Helmert_transformation)，它使用最小二乘法来最小化残差。乍一看，维基百科和谷歌的东西似乎并不好。我对此的参考是 Ghilani & Wolf 的[调整计算](http://eu.wiley.com/WileyCDA/WileyTitle/productCd-0471697281.html)，p345。这也是一本很好的关于矩阵数学的书，适用于空间问题，也是图书馆的一个很好的补充。

编辑：此变换的 Adam 的 9 参数版本称为[仿射变换](http://en.wikipedia.org/wiki/Affine_transformation)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-29T18:53:27.937

这是计算 R 中 2D 仿射变换参数的最小二乘估计的[示例。](http://casoilresource.lawr.ucdavis.edu/drupal/node/532)

# sql-server - 从 SQL Server 2005 升级到 2008

> ID：358586
> 
> 赞同：2
> 
> 时间：2008-12-11T06:37:19.760
> 
> 标签：sql-server, upgrade

我已使用升级向导从 SQL Server 2008 升级到 SQL Server 2005。完成后，我发现 SQL 2005 仍然存在。我使用了与 SQL Server 2005 相同的实例，但无法连接。并且存储在 SQL Server 2005 上的所有数据在具有相同实例的 SQL Server 2008 上都找不到。我需要手动导入数据吗？还是我在升级过程中错过了任何步骤？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-11T07:22:18.640

您可能没有正确执行就地升级？
服务器现在是否运行了两个 SQL Server 实例？看看服务。

如果您现在正在运行 2005 和 2008 SQL，则可以使用[数据库复制向导迁移 2005 数据库。](http://msdn.microsoft.com/en-us/library/ms190775.aspx)

您也可以尝试在 2008 年附加 Management Studio 中的 2005 mdf 文件，右键单击用户数据库并选择附加。这应该允许您附加 2005 数据库并将它们升级到 2008。

# vb6 - 如何在VB6中设置启动项目？

> ID：358587
> 
> 赞同：2
> 
> 时间：2008-12-11T06:37:46.513
> 
> 标签：vb6, ide

能否在 Visual Basic 6 IDE 中设置启动项目？

我浏览了所有设置，但找不到方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-11T08:20:05.217

我假设您在一个组中有多个项目，例如一个 dll 和一个依赖 exe，并且您希望将 exe 设置为“启动”项目。这样做，在项目资源管理器中选择 exe 项目，右键单击并从上下文菜单中选择“设置为启动”。“启动”项目的名称将在项目资源管理器中显示为粗体文本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-11T13:30:48.520

Dave 和 OneDayWhen 正确地说，您需要在 IDE 中右键单击所需的项目，并在加载多个项目并选择执行哪个项目时选择设置为启动。

> 任何人都知道如何设置 VB6 IDE 以加载最后加载​​的项目或更改加载的默认项目？

复制图标将目标更改为类似

"C:\Program Files\Microsoft Visual Studio\VB98\VB6.EXE" "D:\MyProjects\MyOneProject\trunk\MyOneProject.vbp"

将启动更改为 D:\MyProjects\MyOneProject\trunk

我发现它只是将 StartupIn 更改为我的主项目目录，而不是为特定项目设置图标。喜欢 D:\MyProjects

罗伯康利

PS 如果你想知道为什么你会选择一个非 EXE 项目作为启动。您有时在调试非 EXE 时执行此操作。当您启动非 EXE 时，您有多种选择。其中你可以启动一个应用程序，或者坐在那里直到有人调用它。当您调试活动 DLL 或控件并使用 Excel 或您也没有源代码的其他第 3 方软件时很有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-11T07:35:00.940

我不知道 VB6 中的“启动项目”设置，但您可以通过打开“项目”菜单选择“启动对象”，选择最后一个菜单项（“X 属性”，其中 X 是项目的名称） ，然后在“项目属性”窗口中选择“常规”选项卡。您寻找的选择器位于右上角。

# c# - 何时使用 LINQ2SQL 加载相关表中的记录

> ID：358591
> 
> 赞同：0
> 
> 时间：2008-12-11T06:42:34.337
> 
> 标签：c#, linq-to-sql, database-relations, loadoptions

假设我有两张桌子：

*   报告
*   评论

并假设我有一个数据库上下文：

```
var reports = db.Reports(); 
```

如何确保每个报告的所有评论都已加载？

此时我想断开与数据库的连接，但仍然可以访问评论。（例如：）

```
reports[0].Comments[0].Subject 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-11T08:11:40.973

我假设报告和评论之间存在 1-M FK 关系（1 份报告可以有很多评论）？

一种选择是使用[DataLoadOptions.LoadWith](http://msdn.microsoft.com/en-us/library/system.data.linq.dataloadoptions.loadwith.aspx)方法 - 如下所示：

```
var reports = db.Reports();
DataLoadOptions dlo = new DataLoadOptions();
dlo.LoadWith<Reports>(r => r.Comments);      // Ask for Comments along with reports
reports.LoadOptions = dlo; 
```

现在，每次您选择有关该数据上下文的报告时，都会从数据库中获取评论。

请注意，将选择评论中的所有字段 - 无法使用此方法选择字段子集。

另一个选项是具体说明您要在 Linq 查询中选择的内容，例如

```
var myReportsList = from report in db.Reports
                    select new {  // Using anonymous type, but could use a custom class
                       Report = report,
                       Comment = report.Comment.Detail,   // for example
                       Subject = report.Comment.Subject
                    }; 
```

要了解查询何时运行以及数据库连接何时关闭，您需要了解：

*   Linq 和 Linq To Sql 的延迟执行模型（基本上，对于 Linq to SQL，查询仅在请求结果时运行，例如通过迭代集合或绑定到网格）
*   IQueryable 和 IEnumerable 的区别

Jon Skeets "C# in depth" 对这些进行了很好的概述，我也听说过关于 "Linq in Action" 的好消息——此外，还有很多关于这些概念的博客文章比我能做的更公正在这里;o)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-11T08:37:28.223

请记住，如果您使用 LoadOptions 定义多跳路径（报告、评论、另一个实体），则通过代码加载第 3 跳和更远的跳（如果通过 1:n 关系相关）效率非常低：它们将执行每个父母一个查询。对于报告评论，没关系，它们将在 2 个查询中获取。

# jquery - 如何启用超链接？

> ID：358601
> 
> 赞同：3
> 
> 时间：2008-12-11T06:52:07.140
> 
> 标签：jquery, hyperlink

有 2 个单选按钮和一个超链接。如果选择“radiobutton1”，则启用超链接。如果选择“radiobutton2”，超链接将被禁用。我可以使用 jquery 禁用超链接，但不能启用它。如何使用 jquery 启用超链接？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-11T08:04:22.113

您可以尝试添加一个单击事件处理程序，并根据单选按钮的状态从单击处理程序返回 true 或 false。

返回 false 应该取消对链接的点击，例如：

```
$("#hyperlink1").click(function(){                      
    // return true or false based on your radio buttons  
    return enableLink;                  
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-04T21:34:38.330

'disabled' 属性可以被获取和设置。但是，此属性适用于单个对象，而不适用于对象集。

```
if (!$("#ContinueButton")[0].disabled) {  
    UserContinue();  
} 
```

写：

```
$("#ContinueButton")[0].disabled = !canContinue; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-11T09:28:31.333

要禁用超链接，您可以将 onclick 处理程序添加到它返回 false；

像这样的东西：

```
$("#radioDisable").click(function() {
    $(“hyperlink”).click(function(){
        return false;
    });
    $(“hyperlink”).addClass(“disabled”);
});

$("#radioEnable").click(function() {
    $(“hyperlink”).click(function(){
        return true;
    });
    $(“hyperlink”).removeClass(“disabled”);
}); 
```

# .net - sqlConnection如何隐藏连接字符串的密码

> ID：358602
> 
> 赞同：6
> 
> 时间：2008-12-11T06:52:10.200
> 
> 标签：.net, ado.net

我正在制作一个使用一些数据连接到数据库的组件，这些数据包括用户 ID 和密码，它将这些值存储在私有变量中，但是任何程序员都可以在初始化后在调试器中看到该值，所以我想知道SqlConnection 如何隐藏该值，当我看到属性 ConnectionString 的值时，我看到了除密码之外的所有信息，将其存储在某处但不使其可见，即使在调试器中我也看不到任何存储的变量密码，我知道我可以使用 SecureString 保护密码，但我想知道 SqlConnection 对象的实现如何。

谢谢。

胡安·扎穆迪奥

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-11T07:54:18.233

从[手册](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlconnection_properties.aspx)：

> ConnectionString 类似于 OLE DB 连接字符串，但不相同。与 OLE DB 或 ADO 不同，返回的连接字符串与用户设置的 ConnectionString 相同，如果 Persist Security Info 值设置为 false（默认值），则减去安全信息。除非将 Persist Security Info 设置为 true，否则用于 SQL Server 的 .NET Framework 数据提供程序不会在连接字符串中保留或返回密码。

我不确定这是如何实现的。我**未经证实的猜测**是，它用安全参数填充了一个结构，然后发送到服务器，除非您将 Persist Security Info 设置为 true，否则从不实际存储它们。

# excel - 将表数据访问到 Excel

> ID：358603
> 
> 赞同：3
> 
> 时间：2008-12-11T06:52:12.460
> 
> 标签：excel, ms-access

我有一个问题，我被困住了。

我想将我的 Access 表导出到 Excel 文件。目前，我使用 来执行此操作`DoCmd.TransferSpreadsheet`，但我希望对导出的数据进行某种格式设置。我可以格式化发送到 Excel 的数据，还是必须在 Excel 中编写一个宏，以便在从 Access 导出数据后对其进行格式化？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-11T10:35:44.647

此**Excel**宏从您的 MS Access 数据库中检索数据：

```
Sub Makro1()
''
Const sDB = "c:\db1.mdb"
Const sSQL = "SELECT * FROM Table1"

    With ActiveSheet.QueryTables.Add(Connection:= _
        "ODBC;DSN=MS Access-database;DBQ=" + sDB + ";FIL=MS Access;MaxBufferSize=2048;PageTimeout=5;" _
        , Destination:=Range("A1"))
        .CommandText = Array(sSQL)
        .Name = "Query1"
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = True
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = True
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .PreserveColumnInfo = True
        .Refresh BackgroundQuery:=False
    End With
End Sub 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-12T09:41:04.210

我们有一个通用函数，可以将我们的连续表单直接导出到 Excel。您需要将 Microsoft Excel 库添加到可用工具中，以使其在您的代码中运行。您可以在所有表​​单中将此功能提供给用户。如果您想直接从表中导出，您可以轻松地对其进行调整。

```
Public Function ExportToExcel(x_frm as Form)

Dim ctl As Control, _
    xlApp As Excel.Application, _
    xlBook As Excel.Workbook, _
    xlSheet As Excel.Worksheet, _
    columnName() As String, _
    columnCount as Integer

'suppose Excel is not opened. You can add an extra control for that'
Set xlApp = CreateObject("Excel.Application")

'create an Excel workbook, declare the first sheet'
Set xlBook = xlApp.Workbooks.Add
Set xlSheet = xlBook.Worksheets(1)
xlApp.Visible = False

columnCount = fc().section(0).Controls.Count

'use array columnName() to collect the column names of detail section in tabbed order'
ReDim columnName(columnCount)

For Each ctl In fc().section(0).Controls
    columnName(ctl.TabIndex) = ctl.Name
Next ctl

'This function will add a title to the excel sheet with my favorite formating'
'I can for example decide this title to be bold/Arial/16 on cell(B2)'
addTitleToExcelSheet xlSheet, x_frm.Name

'This function will add the column names to my Excel sheet with my favorite formating'
'for example column names will be added on row 4, columns B to B + columnCount'
addColumnNameToExcelSheet xlSheet, columnName()

'This function will add the column values to my Excel sheet with specific format (date, number, etc)'
'Data will be added to the range defined by '
'row 5 to row 5 + x_frm.recordset.recordcount, '
'columns B to B + columnCount.'
'Recordset values will have to be read according to tab order'
'exported data can depend on recordset filter and orderBy property: your choice'
addColumnValueToExcelSheet xlSheet, columnName(), x_frm.Recordset

'The Excel sheet is made visible and saved under the current folder with the forms name'
xlApp.Visible = True
xlBook.SaveAs x_frm.Name & ".xls"

Set xlBook = Nothing
Set xlSheet = Nothing
Set xlApp = Nothing

End Function 
```

这是结果的视图。左边是 Access 表单，右边是 Excel exportToExcel 结果。希望你喜欢。

![替代文字](https://farm4.static.flickr.com/3143/3102444890_062f3fe2b9.jpg)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-11T07:12:53.840

我对这个域没有任何经验，但请注意 Excel 的行限制比 Access 小得多。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-11T07:14:09.857

从预先配置了格式的 Excel 电子表格开始可能会更容易。从 excel 中使用 VBA 并从 Access 中提取数据（并对其进行格式化）而不是从 Access 中推送数据也可能更容易。Excel VBA 将更好地为您进行 Excel 格式设置。一个和另一个一样容易。如果您尝试仅使用宏来执行此操作，那么使用 Excel 宏可能仍然比使用 Access 宏更容易。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-07-30T14:38:09.670

如果您使用`DoCmd.TransferSpreadsheet`并创建原件，然后对其进行编辑以使格式正确，则可以`DoCmd.TransferSpreadsheet`再次运行，它将使用值更新文件但保留格式。

但是，如果人随后通过添加新选项卡或添加计算等来编辑文件，`DoCmd.TransferSpreadsheet`则将不再工作并且将失败并显示丑陋的错误消息。因此，我们在我们的环境中所做的就是`DoCmd.TransferSpreadsheet`对原始文件进行格式化，然后将文件复制到用户桌面，然后打开该副本，这样用户就不会打扰原始文件。

这种方法是代码最少、干净且易于维护的解决方案。但它确实需要一个额外的“源”或原始文件。在 Access 2007 中工作。

# vb.net - 如何使用 vb.net 从 MS Access DB 表单中找出 Activex 控件

> ID：358609
> 
> 赞同：1
> 
> 时间：2008-12-11T07:07:56.720
> 
> 标签：vb.net, ms-access

我正在 vb.net 中开发一个工具，需要从 MS Access DB 表单中找出 Activex 控件。我可以在表单中输入多个控件，但无法仅从表单中获取 Activex 控件。任何人都可以知道如何实现这一目标，请提出建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-11T13:19:49.433

您可以访问 controltype 属性吗？如果是这样，我对 vb.net 无能为力，但这里有一些 VBA 可能会有所帮助。

```
ActiveXCount = 0
For Each ctl In Screen.ActiveForm
    If ctl.ControlType = 119 Then 'Custom control'
        'Debug.Print ctl.Class'
        ActiveXCount = ActiveXCount + 1
    End If
Next 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-11T12:52:34.153

我不确定你想要什么是可能的。
试试这个：进入 MS 访问并创建新属性，即表单上的控件计数。在 VBA 中，me.Countrolls.Count。使用 Access 自动化打开表单。OnFOrmLoad() 将控件的数量连同窗体的名称一起写入文本文件，然后关闭窗体。然后在 VB.net 中打开文本文件。这是间接的，但它会起作用。

[如何从 Visual Basic .NET 自动化 Microsoft Access](http://support.microsoft.com/kb/317113)

自动化：

```
Dim oAccess As Access.Application

' Start a new instance of Access for Automation:
oAccess = New Access.ApplicationClass()

' Open a database in exclusive mode:
oAccess.OpenCurrentDatabase(filepath:="c:\mydb.mdb", Exclusive:=True)

oAccess.DoCmd.OpenForm(FormName:="Employees") 
```

# gdi - 如何设置 GDI HDC 的可绘制区域？

> ID：358611
> 
> 赞同：1
> 
> 时间：2008-12-11T07:10:04.093
> 
> 标签：gdi, stretchdibits

我想在 HDC 上绘制 HBITMAP，

我使用了 StretchDIBits。它工作正常。::拉伸DIBits。

但是，我只想要一个窗口来观看绘图结果，在窗口旁边，我希望stretchDIBits不生效（它不能在其他区域上绘制），我该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-11T07:31:58.013

创建子窗口时，请确保将`WS_CLIPSIBLINGS`样式设置为不允许在`WM_PAINT`.

除此之外，`SelectClipRegion`可能是您想要的。

# odbc - iSeries AS400 ODBC 连接的文件 DSN

> ID：358617
> 
> 赞同：3
> 
> 时间：2008-12-11T07:20:26.023
> 
> 标签：odbc, dsn

如何使用 iSeries ODBC 驱动程序创建文件 dsn 以连接到 AS400 系统？

iSeries ODBC 驱动程序允许配置许多设置。在哪里可以找到可以在文件 DSN 中设置的所有属性的列表？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-11T08:05:10.457

关于各种风格的连接字符串，有一个很好的互联网资源：

[**http://www.connectionstrings.com/**](http://www.connectionstrings.com/)

这是 AS400 ODBC 驱动程序的页面：http: [//www.connectionstrings.com/as-400](http://www.connectionstrings.com/as-400)

* * *

## ODBC

**IBM 客户端访问 ODBC 驱动程序**

```
Driver={Client Access ODBC Driver (32-bit)};System=my_system_name;
Uid=myUsername;Pwd=myPassword; 
```

**IBM iSeries Access ODBC 驱动程序**

此驱动程序比上述驱动程序更新。

```
Driver={iSeries Access ODBC Driver};System=my_system_name;
Uid=myUsername;Pwd=myPassword; 
```

## IBM .Net 数据提供者

使用 IBM.Data.DB2.iSeries 名称空间

```
DataSource=myServerAddress;UserID=myUsername;
Password=myPassword; DataCompression=True; 
```

## OLE DB、OleDbConnection

**IBM 客户端访问 OLE DB 提供程序**

```
Provider=IBMDA400;Data Source=MY_SYSTEM_NAME;
User Id=myUsername;Password=myPassword; 
```

*其中 MY_SYSTEM_NAME 是 OperationsNavigator 中系统连接的名称*

**IBM 客户端访问 OLE DB 提供程序**

```
Provider=IBMDA400;Data Source=MY_SYSTEM_NAME;User Id=myUsername;
Password=myPassword;Default Collection=MY_LIBRARY; 
```

*其中 MY_SYSTEM_NAME 是系统连接的名称，MY_LIBRARY 是 iSeries Navigator 中的库名称。*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-11T07:29:25.053

*Driver={iSeries Access ODBC Driver};System=server;Uid=user;Pwd=password;*

其中 server 是要连接的系统（IP 地址或主机名）、用户名和密码。

你可以有一个这样的 .dsn 文件：

```
[ODBC]
DRIVER=iSeries Access ODBC Driver
System=server;
Uid=user;
Pwd=password;
Initial Catalog=library; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-12T14:32:47.153

我刚刚发现您可以使用 ODCB 管理工具为任何类型的 ODBC 驱动程序创建文件 DSN。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-10-07T18:06:15.973

Here's a great detailed description of what each keyword is and how you can configure them. The discusion is for DSN-less connections, in applications, but is useful if you want to customize your file DSN. I found it more useful than the IBM documentation.

[http://www.sqlthing.com/HowardsODBCiSeriesFAQ.htm](http://www.sqlthing.com/HowardsODBCiSeriesFAQ.htm)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-05-14T09:40:47.437

这是[关于 ODBC 连接字符串参数的 IBM 文档](http://publib.boulder.ibm.com/infocenter/iseries/v5r4/index.jsp?topic=/rzaik/rzaikconnstrkeywordsservprop.htm)。

# sql - 如何在 SQL 中搜索日期？

> ID：358630
> 
> 赞同：3
> 
> 时间：2008-12-11T07:32:31.537
> 
> 标签：sql, sql-server, date, sql-server-2000

我有一个我想要的事件管理系统，

如果一个活动注册了 5 天（2009 年 1 月 21 日到 2009 年 1 月 26 日），那么如果另一个人想要在 2009 年 1 月 22 日到 2009 年 1 月 24 日之间注册一个活动，那么它将不允许注册。我想使用 SQL 查询来检查这个，所以请告诉我该怎么做。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-11T07:49:33.500

只是为了完成其他答案，您有一篇关于**[如何使用 SQL Server 2000 搜索日期和时间值的好文章](http://www.devarticles.com/c/a/SQL-Server/Date-and-Time-Values-Using-SQL-Server-2000/)**

它提醒您日期/时间值的存储方式（两种日期/时间数据类型：datetime 和 smalldatetime）

它还指出 Datetime 和 smalldatetime 类似于浮点数据类型，float 和 real，因为它们是近似数字。这意味着从 SQL Server 检索的值可能与最初存储的值不同。

另外，它警告数据库设计者并不总是正确使用日期/时间列。在设计数据库时，应确定每个日期/时间列是否将同时存储日期和时间、仅存储日期或仅存储时间。

它以[对 data/time 的实际查询结束](http://www.devarticles.com/c/a/SQL-Server/Date-and-Time-Values-Using-SQL-Server-2000/6/)。

您还可以在[此处对 DATEADD 和 DATEDIFF](http://searchsqlserver.techtarget.com/tip/0,289483,sid87_gci1333669,00.html#)进行很好的描述。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-11T07:38:49.510

SELECT *
FROM events e
WHERE (@startDate BETWEEN e.startDate and e.endDate)
OR (@endDate BETWEEN e.startDate and e.endDate)
OR (@startDate < e.startDate AND @endDate > e.endDate)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-11T07:40:35.513

在 SQL 帮助中查找 DATEDIFF。

# sharepoint - 将 Infopath 字段映射到 Sharepoint 列

> ID：358633
> 
> 赞同：6
> 
> 时间：2008-12-11T07:36:56.880
> 
> 标签：sharepoint, wss, infopath

任何人都知道如何将信息路径字段映射到类型选择的共享点列？infopath 字段是一个重复字段，因此用户可以选择多个选项，我希望能够将它们映射到 sharepoint 中的选择字段。有任何想法吗？

更新：我想要做的是以下。我在 sharepoint 中有一个选择列，允许用户输入值。在 infopath 中，我有一个重复字段。我将该字段绑定到下拉列表。下拉列表由 Web 服务填充。此下拉列表位于重复部分中，因此用户可以从多个下拉列表中进行选择。因此，假设用户添加了 2 个下拉列表，并从每个下拉列表中选择一个选项。我希望能够将这些选择添加为共享点选择列中的选择。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-03T19:19:01.537

当您将重复部分中的字段提升到 SharePoint 列中时，可用的选项是将列提升为：

*   第一个（即只提升第一个选择）
*   最后的
*   数数
*   合并（我相信这会将所有选定的值合并到一个条目中）

[截图 http://img4.imageshack.us/img4/5539/repeatinggrouptr3.png](http://img4.imageshack.us/img4/5539/repeatinggrouptr3.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-15T00:02:12.477

SharePoint 列表是一个平面结构，因此 Infopath 不允许您将重复部分映射到列表列。

您可能需要考虑以下解决方法：

*   将 Infopath 表单存储到一个库（连同非重复字段）
*   使用[这些](http://www.codeplex.com/SPDActivities)自定义活动之一从重复表中提取数据并将其复制到另一个列表
*   创建自定义数据视图或 Web 部件以显示这些项目（如有必要）

如果您需要对重复数据执行一些额外的任务，这种方法会很有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-16T20:58:02.317

取决于它是选择字段的类型。如果它是多选（复选框）选择字段，您可以通过对象模型（从共享点站点）或通过 Web 服务设置字段，通过使用“;#”为您要选中的每个项目标记，其中是复选框列出的值。我不记得该选项仅适用于单选，但它具有相同的性质。如果您正在谈论查找字段，它与您正在查找的列表中的字段的索引号有关。此外，如果选择字段允许用户输入或指定他们自己的选项，则还有其他步骤。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-11T07:56:15.483

它与从以下位置创建重复级联列表不同吗：

*   [平面数据源](http://www.infopathdev.com/blogs/greg/archive/2005/07/14/Create-a-Repeating-Cascading-List-from-a-Flat-Data-Source.aspx)或
*   [分层数据源](http://www.infopathdev.com/blogs/greg/archive/2005/07/14/Create-a-Repeating-Cascading-List-from-a-Hierarchical-Data-Source.aspx)？

如果是的话，那两篇文章或许能给你一些指点。

# iis-7 - Vista IIS7“主”配置文件存储在哪里？

> ID：358645
> 
> 赞同：1
> 
> 时间：2008-12-11T07:49:54.043
> 
> 标签：iis-7

在 IIS7 for Vista 中，您可以选择您的机器，它为您提供了几个可用于配置系统的选项。这个文件存储在哪里？似乎有一个很大的 master.config 文件，其中存储了我的所有设置，例如网页继承的“连接字符串”。

假设它是一个名为 machine.config 的文件，但我在 IIS 管理器中没有任何更改，因为我的机器在那里发生了变化。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-11T07:55:32.800

如果您正在谈论机器范围的 ASP.NET 配置，请查看您的 .NET 框架配置目录，例如`C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\CONFIG`- 检查 web.config 和 machine.config 以了解您一直在配置的设置。

（注意：这是一个有根据的猜测。不要在没有检查的情况下认为它是绝对正确的。不幸的是，我现在自己不能这样做......）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-11T08:03:52.800

“连接字符串”似乎在[web.config 文件中](http://chiragrdarji.wordpress.com/2008/08/11/how-to-encrypt-connection-string-in-webconfig/)

一个 web 项目中可以有多个 web.config 文件（但不能在一个目录中），但这里指的是[配置系统文件](http://chiragrdarji.wordpress.com/2008/08/11/how-to-encrypt-connection-string-in-webconfig/)，包括：

*   `windows\microsoft.net\framework\v2.0.50727\config\machine.config`：保存 .NET 框架设置的全局默认值，包括一些 ASP.NET 设置
*   **root`web.config`**：相同的位置，其余设置。

# c# - 以编程方式将用户权限添加到 Sharepoint 中的列表

> ID：358647
> 
> 赞同：10
> 
> 时间：2008-12-11T07:51:49.470
> 
> 标签：c#, sharepoint, permissions, moss

如何以编程方式将用户权限添加到 Sharepoint 中的列表？我想为某个列表的用户或组添加“贡献”权限。我正在使用 C#。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-11T08:23:07.580

您可以使用[SPRoleAssignment](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.sproleassignment.aspx)对象执行此操作，例如

```
// Assuming you already have SPWeb and SPList objects
...
SPRoleAssignment roleAssignment = new SPRoleAssignment("dom\\user", "user@dom", "user", "some notes");
SPRoleDefinition roleDefinition = web.RoleDefinitions.GetByType(SPRoleType.Contributor);
roleAssignment.RoleDefinitionBindings.Add(roleDefinition);
if (!myList.HasUniqueRoleAssignments)
{
    myList.BreakRoleInheritance(true); // Ensure we don't inherit permissions from parent
} 
myList.RoleAssignments.Add(roleAssignment);
myList.Update(); 
```

# .net - 在 .NET 中为 .config 文件使用环境变量

> ID：358654
> 
> 赞同：25
> 
> 时间：2008-12-11T07:56:11.053
> 
> 标签：.net

我需要在 .config 文件中指定程序集引用的 dll 的路径。问题是路径可以在环境中找到。多变的。是否可以在 .config 文件中使用某种 %DLLPATH% 宏？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-12-11T08:17:52.927

是的，这是可能的！假设你的配置中有类似的东西：

```
<configuration>
  <appSettings>
    <add key="mypath" value="%DLLPATH%\foo\bar"/>
  </appSettings>
</configuration> 
```

然后，您可以通过以下方式轻松获取路径：

```
var pathFromConfig = ConfigurationManager.AppSettings["mypath"];
var expandedPath = Environment.ExpandEnvironmentVariables(pathFromConfig); 
```

`ExpandEnvironmentVariables(string s)`通过将字符串中的所有环境变量替换为其当前值来发挥作用。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-11T08:12:50.363

这是*您正在*阅读的配置条目，还是.NET 正在阅读它？如果您自己阅读，您可以自己进行适当的替换（使用[Environment.ExpandEnvironmentVariables](http://msdn.microsoft.com/en-us/library/system.environment.expandenvironmentvariables.aspx)来做很多事情，如果您想更有选择性，可以使用 Environment.GetEnvironmentVariable）[。](http://msdn.microsoft.com/en-us/library/system.environment.getenvironmentvariable.aspx)

如果它是 .NET 将要读取的，我不知道有什么方法可以让它扩展环境变量。配置文件在您的控制之下吗？你可以重写它吗？

事实上，即使你*可以*做替换，那真的是你想做的吗？如果您需要指定 DLL 的完整路径，我怀疑您需要*通过*DLLPATH 找到它（检查它是否存在于路径的每个部分），然后用完整路径替换 %DLLPATH%\Foo.dll到 Foo.dll。

# vb6 - 用于 VB6 的最佳 RDBMS

> ID：358656
> 
> 赞同：-1
> 
> 时间：2008-12-11T07:56:36.590
> 
> 标签：vb6, oledb, rdbms, provider

我们正在着手进行一个宏大/巨大的项目，这将需要我们大约 1 年的编码时间（由 4 名开发人员完成）才能脱离启动台。

它是一个完整的业务管理系统。

我们可以使用任何商业上可用的 RDBMS，如 Oracle、MS SQL Server 等，但我们正在寻找使用免费软件和开源 RDBMS 系统，如 FireBirdSQL、PostgreSQL 等。

我想知道哪个是最好的 RDBMS，哪个对稳定的 OLEDB 提供程序有最好的支持。我们已经尝试过 OLEDB 提供程序，它们是 FireBird 和 pgSQL 的免费软件，但对它们的性能和功能并不满意。

有什么建议请......

如果除了上面列出的具有高性能 OLEDB 提供程序的任何其他免费软件和/或开源 RDBMS，请赐教。

杨瑜珈

*注意：我们将仅使用 VB 6，不使用其他开发工具或编译器！目标软件必须在基于 Windows9x 的 PC（大约 60 个用户）上运行，而 RDBMS 服务器将在合适的 Linux/Windows 上运行。*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-11T08:01:05.363

我会尽可能保守，因为您的客户端硬件和软件需要细心呵护。由于 SQL Server 和 VB6（和 Windows）都来自 Microsoft，我看不出您还有其他选择。

您甚至可以考虑使用旧版本的 SQL Server，因为标准 OLEDB 服务器和客户端部件可能排列得更好，并且重量更轻。否则，我认为 Windows XP 上的 SQL Server Express 可以提供这么多的连接。它肯定会有马力。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-11T08:24:21.743

SQL Server 和 SQL Native Client 的 OLE DB 提供程序可以很好地与 SQL Server Express 配合使用，正如您对 Microsoft 所期望的那样，因此是 VB6 的绝佳选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-11T09:05:32.393

> 我们可以使用任何商业上可用的 RDBMS，如 Oracle、MS SQL Server 等，但我们正在寻找使用免费软件和开源 RDBMS 系统，如 FireBirdSQL、PostgreSQL 等。

SQL Server、Oracle 或 DB2 的免费版本有什么问题？它们都比您提到的替代方案强大得多，如果您需要，它们会为您提供升级路径。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-19T00:46:31.260

我在 MSSQL2005 数据库后端有很好的经验，VB6 客户端超过 60-100 个并发客户端实例……这是一个数据繁重的应用程序，有大量的数据库流量、行锁定等等。

工作得很好。与数据库交互是最少的问题。

在那张纸条上...

请使用参数化查询，除非您讨厌自己并且想遭受不必要的痛苦。

# css - 我应该使用什么标签而不是 html 中已弃用的标签字体（不能使用 CSS）

> ID：358663
> 
> 赞同：14
> 
> 时间：2008-12-11T08:02:46.920
> 
> 标签：css, xhtml, transitional

这个问题可能会造成误解：我知道我必须使用 CSS 来成功验证我的文档是否为 XHTML 1.0 Transitional。事实是我必须在我的网页中嵌入一张由零和用[文本图像](http://www.text-image.com/index.html "文字图片")创建的图片组成的图片，问题是代码使用了不推荐使用的标签字体，看起来像这样

```
<!-- IMAGE BEGINS HERE -->
<pre>
    <font size="-3">
        <font color="#000000">0001100000101101100011</font>
        <font color="#010000">00</font>
        <font color="#020101">0</font>
        <font color="#040101">0</font>
        <font color="#461919">1</font>
        <font color="#b54f4f">1</font>
        ...etc.etc...
    </font>
</pre>
<!-- IMAGE ENDS HERE --> 
```

（在这个代码示例中，我在每两个标签之后插入了一个换行符以使其更具可读性，但由于标签，原始代码都在一行中`<pre>`）。字体的颜色至少会改变数千次，所以我从未考虑在 CSS 中为每个组合创建一个字段。希望有人至少知道在哪里可以找到解决方案，我到处搜索 :) 谢谢

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2008-12-11T08:05:16.527

你可以更换

`<font color="#000000">0001100000101101100011</font>`

和

`<span style="color:#000000">0001100000101101100011</span>`

ETC...

*编辑：我知道这是 CSS，但它不涉及像问题状态那样的单独样式表，这可能没问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-11T08:43:08.400

javascript 呢？

将颜色数据作为 JSON 数组发送，将“0”和“1”作为另一个数组发送，并动态生成 DOM 元素。

```
<script>
values = [1, 0, 0, 1, ... ]
colors = ["010000", "020101", ...]

for (i = 0; i < values.length; i++) {
    span = createElement("span"); // use a portable function for creating elements
    span.setAttribute("style", "color:#"+colors[i]);
    txtNode = document.createTextNode(values[i]); 
    span.appendChild(txtNode);
    document.appendChild(span);
}
</script> 
```

或者类似的东西...

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-11T09:22:30.270

非常感谢！:DI 使用了这个代码

```
<!-- IMAGE BEGINS HERE -->
<div style="font-size:x-small;font-family:monospace">
    <span style="color:#000000">0001100000101101100011</span>
    <span style="color:#010000">00</span>
    ...etc.etc...
</div>
<!-- IMAGE ENDS HERE --> 
```

它工作正常！:D

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-11T09:22:39.460

为什么需要验证？

您已经获得的解决方案绝对适合您正在做的事情。有用。这不是一个有意义的文档，应该用语义标签进行标记以提高可访问性；这是一件艺术品，所以如果它可以帮助您更清楚地表达您的意图，请随意忽略规则。

如果验证是您尝试制作的艺术声明的一部分，请`<span style="color:#ff00ff;">00</span>`按照其他海报的建议使用 - 但这会大大增加您的文件大小。

另一种方法只是更改文档类型，这样您就不会以 XHTML 过渡为目标 - 使用`<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">`或一些较早的 HTML 修订版。

# php - propel-gen 的“convert-conf”目标失败

> ID：358681
> 
> 赞同：3
> 
> 时间：2008-12-11T08:21:18.023
> 
> 标签：php, orm, propel, phing

我正在尝试使用最新版本的 PHP & Propel 1.3 & Phing 从 OSX 10.5 上的 schema.xml 文件生成我的模型。所有的模型类实际上都被创建了，然后它就死了，就在最后一步。我已经试过了

> chmod -R 777 ./application/config

但这没有帮助。我也试过了

> 推进力 ./ 反向

和

> 推进根./克里奥尔语

两者都产生了相同的错误。这个错误：

```
propel > convert-conf:
[echo] Output file: models-conf.php
[echo] XMLFile: /application/config/runtime-conf.xml
Execution of target "convert-conf" failed for the following reason: pear/data/propel_generator/build-propel.xml:514:20: No valid xmlConfFile specified.
[phingcall] /pear/data/propel_generator/build-propel.xml:514:20: No valid xmlConfFile specified.

Execution of target "main" failed for the following reason: 
pear/data/propel_generator/build-propel.xml:94:18: Execution of the target buildfile failed. Aborting.
[phing] pear/data/propel_generator/build-propel.xml:94:18: Execution of the target buildfile failed. Aborting.

BUILD FINISHED 
```

这是我的 build.properties 文件：

```
propel.project = models
propel.database = mysql
propel.database.encoding = utf8
propel.database.url = mysql:host=localhost;dbname={$myDBName}
propel.database.user = {$myDBuser}
propel.database.password = {$myDBpass}
propel.output.dir  = /application
propel.php.dir     = ${propel.output.dir}/
propel.sql.dir     = ${propel.output.dir}/models/sql
propel.schema.dir  = ${propel.output.dir}/config
propel.conf.dir    = ${propel.output.dir}/config
propel.phpconf.dir = ${propel.output.dir}/config
propel.addGenericAccessors = true 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-07-14T16:23:29.460

我发现我有同样的问题要解决我必须设置

```
propel.runtime.conf.file=runtime-config.xml 
```

在`build.properties`文件中。

之后它完美地工作了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-11T19:38:03.570

我不知道这是怎么发生的，但是我的 runtime-conf.xml 文件中有一行错误：

```
<datasource id="models"> <!-- this ID must match <database name=""> in schema.xml --> 
```

看看它怎么说这些东西*必须*匹配？我的没有。我一定是在我不注意的时候按了一个键，不小心编辑了它。匹配这些，现在构建正常。呸。

# sql-server - 未考虑数据库大小

> ID：358687
> 
> 赞同：2
> 
> 时间：2008-12-11T08:23:20.343
> 
> 标签：sql-server, database

我目前有一个 20GB 大小的数据库。我已经运行了一些脚本，这些脚本显示了每个表的大小（以及其他非常有用的信息，例如索引内容），最大的表是 110 万条记录，占用了 150MB 的数据。我们有不到 50 个表，其中大部分占用不到 1MB 的数据。

查看每个表的大小后，我不明白为什么数据库在缩小后不应该是 1GB。SqlServer (2005) 报告的可用空间量为 0%。日志模式设置为简单。在这一点上，我主要担心的是我觉得我有 19GB 的未使用空间。还有什么我应该看的吗？

通常我不会在意，并且会将此作为被动研究项目，除非这种特殊情况要求我们每周进行备份和恢复以将副本放在卫星上（没有互联网，因此必须手动完成）。我宁愿每周复制 1GB（或者即使它降至 5GB！）也不愿复制 20GB 数据。

sp_spaceused 报告以下内容：

```
Navigator-Production    19184.56 MB 3.02 MB 
```

它的第二部分：

```
19640872 KB 19512112 KB 108184 KB   20576 KB 
```

虽然我发现了一些其他脚本（例如这里的两个服务器数据库大小问题中的一个，它们都报告了在上面或下面找到的相同信息）。我使用的脚本来自 SqlTeam。这是标题信息：

```
*  BigTables.sql
*  Bill Graziano (SQLTeam.com)
*  graz@<email removed>
*  v1.11 
```

前几个表显示了这一点（表、行、保留空间、数据、索引、未使用等）：

```
Activity    1143639     131 MB  89 MB   41768 KB    1648 KB 46% 1%
EventAttendance 883261      90 MB   58 MB   32264 KB    328 KB  54% 0%
Person  113437      31 MB   15 MB   15752 KB    912 KB  103%    3%
HouseholdMember 113443      12 MB   6 MB    5224 KB 432 KB  82% 4%
PostalAddress   48870       8 MB    6 MB    2200 KB 280 KB  36% 3% 
```

其余的桌子要么大小相同，要么更小。不超过50张桌子。

更新 1： - 所有表都使用唯一标识符。通常一个 int 每行递增 1。

*   我还重新索引了所有内容。

*   我运行了 dbcc shrink 命令并在前后更新了使用情况。而且一遍又一遍。我发现一个有趣的事情是，当我重新启动服务器并确认*没有人*在使用它（并且没有维护过程正在运行，这是一个非常新的应用程序 - 不到一周）并且当我去运行收缩时，每个有时它会说一些关于数据改变的事情。谷歌搜索得到的有用答案太少，明显不适用（当时是凌晨 1 点，我断开了所有人的连接，所以情况似乎不可能）。数据是通过 C# 代码迁移的，该代码基本上是查看另一台服务器并将事情带过来。此时，删除的数量可能低于 50k 行。即使这些行是最大的行，我想也不会超过 100M。

*   当我通过 GUI 进行收缩时，它会报告 0% 可用于收缩，这表明我已经将它缩小到它认为可以去的最小程度。

更新 2：

*   sp_spaceused 'Activity' 产生了这个（这看起来很划算）：

    活动 1143639 134488 KB 91072 KB 41768 KB 1648 KB

*   填充因子为 90。

*   所有主键都是整数。

*   这是我用来“updateusage”的命令：

    DBCC UPDATEUSAGE(0);

更新 3：

*   根据 Edosoft 的要求：图像 111975 2407773 19262184 看起来好像图像表认为它是 19GB 部分。我不明白这是什么意思。它*真的是*19GB 还是被歪曲了？

更新 4：

*   与一位同事交谈，我发现这是因为页面，因为这里的其他人也说明了这种可能性。图像表上的唯一索引是聚集的 PK。这是我可以解决的问题还是我只需要处理它？常规脚本显示 Image 表的大小为 6MB。

更新 5：

*   我想我将不得不在进一步研究后处理它。这些图像已调整为每个大约 2-5KB 的大小，并且在普通文件系统上不会消耗太多空间，但在 SqlServer 上似乎消耗的空间要多得多。从长远来看，真正的答案可能是将该表分成另一个分区或类似的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-11T08:48:21.760

您可能还想在运行查询之前更新 systables 中的使用情况，以确保它们是准确的。

```
DECLARE @DbName NVARCHAR(128)
SET @DbName = DB_NAME(DB_ID())
DBCC UPDATEUSAGE(@DbName) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-11T14:05:31.463

您在重新索引中使用的填充因子是多少？它必须很高。从 90-100% 取决于 PK 数据类型。如果您的填充因子很低，那么您将有很多无法缩小的半空页面。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-11T14:33:22.513

试试这个查询：

```
SELECT object_name(object_id)  AS name, rows,  total_pages, 
  total_pages * 8192 / 1024 as [Size(Kb)]
FROM sys.partitions p
INNER JOIN sys.allocation_units a
  ON p.partition_id = a.container_id 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-11T08:33:50.023

您是否尝试使用 dbcc 命令来缩小目录？如果将所有数据传输到一个空目录，它也是 20GB 吗？

数据库使用基于页面的文件系统，因此由于大量的行删除，您可能会遇到很多松弛（页面之间的空白空间）：如果 dbms 期望在该位置插入行，最好离开景点开放。您是否使用具有聚集索引的基于唯一标识符的 PK？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-11T08:58:27.807

你可以尝试做一个数据库真空，如果你以前从未做过，这通常可以产生很大的空间改进。

希望这可以帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-11T09:03:02.993

您是否检查过“收缩数据库”对话框下的统计信息？在 SQL Server Management Studio (2005 / 2008) 中，右键单击数据库，单击任务 -> 收缩 -> 数据库。这将向您显示分配给数据库的空间量，以及当前未使用的分配空间量。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-12T00:33:35.937

您是否确保事务日志没有占用空间？如果您处于完全恢复模式，则在您执行事务日志备份之前，t-log 不会收缩。

# windows - Windows 上的 GHC + wxHaskell

> ID：358693
> 
> 赞同：4
> 
> 时间：2008-12-11T08:35:52.830
> 
> 标签：windows, haskell, ghc, wxhaskell

在 Windows XP 计算机上安装 GHC 6.8.3 和 wxHaskell-0.10.3。两者都作为二进制发行版安装，而不是从源代码构建。使用以下命令构建示例：

ghc --make Paint.hs

它可以在构建它的同一台计算机上运行（安装了 GHC 和 wxHaskell），但如果转移到另一台计算机（两者都没有安装）则失败。它会抛出一个“应用程序错误”框，其中包含“应用程序无法正确初始化（0xc0150002）。单击确定以终止程序。”

它想要的唯一非系统 dll 是 wxc-msw2.6.4-0.10.3.dll，我将其复制到它的文件夹中。

可能是什么原因？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-12T20:17:49.390

该错误来自 DLL 清单中提到的依赖项（可能是带有 wxHaskell 的第三方），您的系统期望在 Windows 目录中的 WinSxS 和 SoftwareDistribution 等位置找到这些依赖项。我猜 wxHaskell 安装会将文件放在那里。

您可以通过查看故障机器上的事件查看器来找到程序正在寻找的文件。您甚至可以通过从工作机器中移动文件来修复它们，但是，VC++ 2005 运行时是最有可能的，正如建议的那样 - [wxHaskell 疑难解答](http://www.haskell.org/haskellwiki/WxHaskell/Troubleshooting#Runtime_issues)建议您尝试 VC++ 2005 **service pack 1**可再发行组件：

[http://www.microsoft.com/downloads/details.aspx?FamilyID=200b2fd9-ae1a-4a14-984d-389c36f85647&DisplayLang=en](http://www.microsoft.com/downloads/details.aspx?FamilyID=200b2fd9-ae1a-4a14-984d-389c36f85647&DisplayLang=en)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-11T09:08:55.897

我的猜测是，您想将 VC++ 运行时可再发行文件安装到目标计算机上。使用 Visual Studio 2005 构建的应用程序的可再分发文件可从此处获得：

[http://www.microsoft.com/downloads/details.aspx?familyid=32bc1bee-a3f9-4c13-9c99-220b62a191ee&displaylang=en](http://www.microsoft.com/downloads/details.aspx?familyid=32bc1bee-a3f9-4c13-9c99-220b62a191ee&displaylang=en)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-13T00:23:00.113

数据点：在 XP sp2 机器上为我工作。

# c# - 如何在 C# 中以编程方式安装 Windows 服务？

> ID：358700
> 
> 赞同：83
> 
> 时间：2008-12-11T08:38:48.440
> 
> 标签：c#, .net, windows-services, setup-project, visual-studio-setup-proje

我的 VS 解决方案中有 3 个项目。其中一个是 Web 应用程序，第二个是 Windows 服务，最后一个是我的 Web 应用程序的安装项目。

我想要的是在我的安装项目中安装 Web 应用程序结束时，在我的自定义操作中尝试安装我的 Windows 服务，因为那时我已经有了程序集的位置。

* * *

## 回答 #1

> 赞同：95
> 
> 时间：2009-07-23T14:22:45.963

我在您重用的代码中发现了几个错误，并已修复这些错误并对其进行了一些清理。同样，原始代码取自[此处](http://www.tech-archive.net/Archive/VB/microsoft.public.vb.winapi/2006-08/msg00238.html)。

```
public static class ServiceInstaller
{
    private const int STANDARD_RIGHTS_REQUIRED = 0xF0000;
    private const int SERVICE_WIN32_OWN_PROCESS = 0x00000010;

    [StructLayout(LayoutKind.Sequential)]
    private class SERVICE_STATUS
    {
        public int dwServiceType = 0;
        public ServiceState dwCurrentState = 0;
        public int dwControlsAccepted = 0;
        public int dwWin32ExitCode = 0;
        public int dwServiceSpecificExitCode = 0;
        public int dwCheckPoint = 0;
        public int dwWaitHint = 0;
    }

    #region OpenSCManager
    [DllImport("advapi32.dll", EntryPoint = "OpenSCManagerW", ExactSpelling = true, CharSet = CharSet.Unicode, SetLastError = true)]
    static extern IntPtr OpenSCManager(string machineName, string databaseName, ScmAccessRights dwDesiredAccess);
    #endregion

    #region OpenService
    [DllImport("advapi32.dll", SetLastError = true, CharSet = CharSet.Auto)]
    static extern IntPtr OpenService(IntPtr hSCManager, string lpServiceName, ServiceAccessRights dwDesiredAccess);
    #endregion

    #region CreateService
    [DllImport("advapi32.dll", SetLastError = true, CharSet = CharSet.Auto)]
    private static extern IntPtr CreateService(IntPtr hSCManager, string lpServiceName, string lpDisplayName, ServiceAccessRights dwDesiredAccess, int dwServiceType, ServiceBootFlag dwStartType, ServiceError dwErrorControl, string lpBinaryPathName, string lpLoadOrderGroup, IntPtr lpdwTagId, string lpDependencies, string lp, string lpPassword);
    #endregion

    #region CloseServiceHandle
    [DllImport("advapi32.dll", SetLastError = true)]
    [return: MarshalAs(UnmanagedType.Bool)]
    static extern bool CloseServiceHandle(IntPtr hSCObject);
    #endregion

    #region QueryServiceStatus
    [DllImport("advapi32.dll")]
    private static extern int QueryServiceStatus(IntPtr hService, SERVICE_STATUS lpServiceStatus);
    #endregion

    #region DeleteService
    [DllImport("advapi32.dll", SetLastError = true)]
    [return: MarshalAs(UnmanagedType.Bool)]
    private static extern bool DeleteService(IntPtr hService);
    #endregion

    #region ControlService
    [DllImport("advapi32.dll")]
    private static extern int ControlService(IntPtr hService, ServiceControl dwControl, SERVICE_STATUS lpServiceStatus);
    #endregion

    #region StartService
    [DllImport("advapi32.dll", SetLastError = true)]
    private static extern int StartService(IntPtr hService, int dwNumServiceArgs, int lpServiceArgVectors);
    #endregion

    public static void Uninstall(string serviceName)
    {
        IntPtr scm = OpenSCManager(ScmAccessRights.AllAccess);

        try
        {
            IntPtr service = OpenService(scm, serviceName, ServiceAccessRights.AllAccess);
            if (service == IntPtr.Zero)
                throw new ApplicationException("Service not installed.");

            try
            {
                StopService(service);
                if (!DeleteService(service))
                    throw new ApplicationException("Could not delete service " + Marshal.GetLastWin32Error());
            }
            finally
            {
                CloseServiceHandle(service);
            }
        }
        finally
        {
            CloseServiceHandle(scm);
        }
    }

    public static bool ServiceIsInstalled(string serviceName)
    {
        IntPtr scm = OpenSCManager(ScmAccessRights.Connect);

        try
        {
            IntPtr service = OpenService(scm, serviceName, ServiceAccessRights.QueryStatus);

            if (service == IntPtr.Zero)
                return false;

            CloseServiceHandle(service);
            return true;
        }
        finally
        {
            CloseServiceHandle(scm);
        }
    }

    public static void InstallAndStart(string serviceName, string displayName, string fileName)
    {
        IntPtr scm = OpenSCManager(ScmAccessRights.AllAccess);

        try
        {
            IntPtr service = OpenService(scm, serviceName, ServiceAccessRights.AllAccess);

            if (service == IntPtr.Zero)
                service = CreateService(scm, serviceName, displayName, ServiceAccessRights.AllAccess, SERVICE_WIN32_OWN_PROCESS, ServiceBootFlag.AutoStart, ServiceError.Normal, fileName, null, IntPtr.Zero, null, null, null);

            if (service == IntPtr.Zero)
                throw new ApplicationException("Failed to install service.");

            try
            {
                StartService(service);
            }
            finally
            {
                CloseServiceHandle(service);
            }
        }
        finally
        {
            CloseServiceHandle(scm);
        }
    }

    public static void StartService(string serviceName)
    {
        IntPtr scm = OpenSCManager(ScmAccessRights.Connect);

        try
        {
            IntPtr service = OpenService(scm, serviceName, ServiceAccessRights.QueryStatus | ServiceAccessRights.Start);
            if (service == IntPtr.Zero)
                throw new ApplicationException("Could not open service.");

            try
            {
                StartService(service);
            }
            finally
            {
                CloseServiceHandle(service);
            }
        }
        finally
        {
            CloseServiceHandle(scm);
        }
    }

    public static void StopService(string serviceName)
    {
        IntPtr scm = OpenSCManager(ScmAccessRights.Connect);

        try
        {
            IntPtr service = OpenService(scm, serviceName, ServiceAccessRights.QueryStatus | ServiceAccessRights.Stop);
            if (service == IntPtr.Zero)
                throw new ApplicationException("Could not open service.");

            try
            {
                StopService(service);
            }
            finally
            {
                CloseServiceHandle(service);
            }
        }
        finally
        {
            CloseServiceHandle(scm);
        }
    }

    private static void StartService(IntPtr service)
    {
        SERVICE_STATUS status = new SERVICE_STATUS();
        StartService(service, 0, 0);
        var changedStatus = WaitForServiceStatus(service, ServiceState.StartPending, ServiceState.Running);
        if (!changedStatus)
            throw new ApplicationException("Unable to start service");
    }

    private static void StopService(IntPtr service)
    {
        SERVICE_STATUS status = new SERVICE_STATUS();
        ControlService(service, ServiceControl.Stop, status);
        var changedStatus = WaitForServiceStatus(service, ServiceState.StopPending, ServiceState.Stopped);
        if (!changedStatus)
            throw new ApplicationException("Unable to stop service");
    }

    public static ServiceState GetServiceStatus(string serviceName)
    {
        IntPtr scm = OpenSCManager(ScmAccessRights.Connect);

        try
        {
            IntPtr service = OpenService(scm, serviceName, ServiceAccessRights.QueryStatus);
            if (service == IntPtr.Zero)
                return ServiceState.NotFound;

            try
            {
                return GetServiceStatus(service);
            }
            finally
            {
                CloseServiceHandle(service);
            }
        }
        finally
        {
            CloseServiceHandle(scm);
        }
    }

    private static ServiceState GetServiceStatus(IntPtr service)
    {
        SERVICE_STATUS status = new SERVICE_STATUS();

        if (QueryServiceStatus(service, status) == 0)
            throw new ApplicationException("Failed to query service status.");

        return status.dwCurrentState;
    }

    private static bool WaitForServiceStatus(IntPtr service, ServiceState waitStatus, ServiceState desiredStatus)
    {
        SERVICE_STATUS status = new SERVICE_STATUS();

        QueryServiceStatus(service, status);
        if (status.dwCurrentState == desiredStatus) return true;

        int dwStartTickCount = Environment.TickCount;
        int dwOldCheckPoint = status.dwCheckPoint;

        while (status.dwCurrentState == waitStatus)
        {
            // Do not wait longer than the wait hint. A good interval is
            // one tenth the wait hint, but no less than 1 second and no
            // more than 10 seconds.

            int dwWaitTime = status.dwWaitHint / 10;

            if (dwWaitTime < 1000) dwWaitTime = 1000;
            else if (dwWaitTime > 10000) dwWaitTime = 10000;

            Thread.Sleep(dwWaitTime);

            // Check the status again.

            if (QueryServiceStatus(service, status) == 0) break;

            if (status.dwCheckPoint > dwOldCheckPoint)
            {
                // The service is making progress.
                dwStartTickCount = Environment.TickCount;
                dwOldCheckPoint = status.dwCheckPoint;
            }
            else
            {
                if (Environment.TickCount - dwStartTickCount > status.dwWaitHint)
                {
                    // No progress made within the wait hint
                    break;
                }
            }
        }
        return (status.dwCurrentState == desiredStatus);
    }

    private static IntPtr OpenSCManager(ScmAccessRights rights)
    {
        IntPtr scm = OpenSCManager(null, null, rights);
        if (scm == IntPtr.Zero)
            throw new ApplicationException("Could not connect to service control manager.");

        return scm;
    }
}

public enum ServiceState
{
    Unknown = -1, // The state cannot be (has not been) retrieved.
    NotFound = 0, // The service is not known on the host server.
    Stopped = 1,
    StartPending = 2,
    StopPending = 3,
    Running = 4,
    ContinuePending = 5,
    PausePending = 6,
    Paused = 7
}

[Flags]
public enum ScmAccessRights
{
    Connect = 0x0001,
    CreateService = 0x0002,
    EnumerateService = 0x0004,
    Lock = 0x0008,
    QueryLockStatus = 0x0010,
    ModifyBootConfig = 0x0020,
    StandardRightsRequired = 0xF0000,
    AllAccess = (StandardRightsRequired | Connect | CreateService |
                 EnumerateService | Lock | QueryLockStatus | ModifyBootConfig)
}

[Flags]
public enum ServiceAccessRights
{
    QueryConfig = 0x1,
    ChangeConfig = 0x2,
    QueryStatus = 0x4,
    EnumerateDependants = 0x8,
    Start = 0x10,
    Stop = 0x20,
    PauseContinue = 0x40,
    Interrogate = 0x80,
    UserDefinedControl = 0x100,
    Delete = 0x00010000,
    StandardRightsRequired = 0xF0000,
    AllAccess = (StandardRightsRequired | QueryConfig | ChangeConfig |
                 QueryStatus | EnumerateDependants | Start | Stop | PauseContinue |
                 Interrogate | UserDefinedControl)
}

public enum ServiceBootFlag
{
    Start = 0x00000000,
    SystemStart = 0x00000001,
    AutoStart = 0x00000002,
    DemandStart = 0x00000003,
    Disabled = 0x00000004
}

public enum ServiceControl
{
    Stop = 0x00000001,
    Pause = 0x00000002,
    Continue = 0x00000003,
    Interrogate = 0x00000004,
    Shutdown = 0x00000005,
    ParamChange = 0x00000006,
    NetBindAdd = 0x00000007,
    NetBindRemove = 0x00000008,
    NetBindEnable = 0x00000009,
    NetBindDisable = 0x0000000A
}

public enum ServiceError
{
    Ignore = 0x00000000,
    Normal = 0x00000001,
    Severe = 0x00000002,
    Critical = 0x00000003
} 
```

如果有人发现此代码有任何问题，请告诉我！

* * *

## 回答 #2

> 赞同：77
> 
> 时间：2009-03-12T08:26:10.267

好的，这对我来说真的很有效，它已经在具有不同操作系统（Vista、XP、Win2k、Win2003 服务器）的多台机器上进行了测试

代码是从[这里](http://www.tech-archive.net/Archive/VB/microsoft.public.vb.winapi/2006-08/msg00238.html)获取的，因此完全归功于编写这段代码的人。

一旦将 dll 或源文件添加到项目中，请确保添加 ServiceTools 命名空间，然后您就可以访问一些非常方便的功能，例如...

```
//Installs and starts the service
ServiceInstaller.InstallAndStart("MyServiceName", "MyServiceDisplayName", "C:\\PathToServiceFile.exe");

//Removes the service
ServiceInstaller.Uninstall("MyServiceName");

//Checks the status of the service
ServiceInstaller.GetServiceStatus("MyServiceName");

//Starts the service
ServiceInstaller.StartService("MyServiceName");

//Stops the service
ServiceInstaller.StopService("MyServiceName");

//Check if service is installed
ServiceInstaller.ServiceIsInstalled("MyServiceName"); 
```

我希望这有帮助。

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2008-12-11T08:43:35.713

请看看[这篇文章](http://www.c-sharpcorner.com/UploadFile/sachin.nigam/InstallingWinServiceProgrammatically11262005061332AM/InstallingWinServiceProgrammatically.aspx)。

* * *

有时您可能希望以编程方式安装 Windows 服务，但目标计算机没有 InstallUtil.exe。

添加对的引用`System.Configuration.Install`

使用下面的代码。

请注意，这`exeFileName`是 InstallerClass .exe 而不是 ServiceClass .exe。

```
public static void InstallService(string exeFilename)
{
    string[] commandLineOptions = new string[1] { "/LogFile=install.log" };

    System.Configuration.Install.AssemblyInstaller installer = new System.Configuration.Install.AssemblyInstaller(exeFilename, commandLineOptions);

    installer.UseNewContext = true;    
    installer.Install(null);    
    installer.Commit(null);

} 
```

要卸载：

```
public static void UninstallService(string exeFilename)
{
    string[] commandLineOptions = new string[1] { "/LogFile=uninstall.log" };

    System.Configuration.Install.AssemblyInstaller installer = new System.Configuration.Install.AssemblyInstaller(exeFilename, commandLineOptions);

    installer.UseNewContext = true;    
    installer.Uninstall(null);

} 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2012-07-23T19:48:41.333

在为我的服务（非常基本）创建安装程序类的实例后，我所要做的就是调用：

```
ManagedInstallerClass.InstallHelper(new string[] { 
    Assembly.GetExecutingAssembly().Location }); 
```

安装它并

```
ManagedInstallerClass.InstallHelper(new string[] { "/u", 
    Assembly.GetExecutingAssembly().Location }); 
```

卸载服务。此处，调用代码与服务可执行文件位于同一程序集中。

要通过命令行安装服务，我所要做的就是通过命令行参数将其连接到可执行文件并测试`System.Environment.UserInteractive`以了解它是正在执行的服务还是有人试图安装-卸载它，瞧……不时髦的互操作的东西......没有指针泄漏......

总共大约 20 行代码分布在两个类中就可以了。

替换 InstallUtil 只需看看[ManagedInstallerClass.InstallHelper](http://msdn.microsoft.com/en-us/library/system.configuration.install.managedinstallerclass.installhelper.aspx)

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2010-12-10T03:51:55.247

通过使用[Topshelf](http://topshelf-project.com/)项目，您可以通过调用可执行文件来安装：

```
MyService.exe install 
```

Topshelf 还负责其他 Windows 服务管道。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2014-11-27T19:31:59.980

因为我面临着以编程方式安装在特定用户下运行的服务的挑战。我扩展了该`InstallAndStart`方法以使用`lp`和`lpPassword`...

不多，但可能会有所帮助。

```
public static void InstallAndStart(
    string serviceName, 
    string displayName, 
    string fileName, 
    string username, 
    string password)
{
    IntPtr scm = OpenSCManager(ScmAccessRights.AllAccess);

    try
    {
        IntPtr service = OpenService(
            scm, 
            serviceName, 
            ServiceAccessRights.AllAccess);

        if (service == IntPtr.Zero)
            service = CreateService(
                scm, 
                serviceName, 
                displayName, 
                ServiceAccessRights.AllAccess, 
                SERVICE_WIN32_OWN_PROCESS, 
                ServiceBootFlag.AutoStart, 
                ServiceError.Normal, 
                fileName, 
                null, 
                IntPtr.Zero, 
                null, 
                username, 
                password);

        if (service == IntPtr.Zero)
            throw new ApplicationException("Failed to install service.");

        try
        {
            StartService(service);
        }
        finally
        {
            CloseServiceHandle(service);
        }
    }
    finally
    {
        CloseServiceHandle(scm);
    }
} 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2020-04-21T16:00:59.750

我使用 Lars answer 来管理我的服务，它运行良好。但是我需要将参数传递给服务，我花了几个小时才弄清楚如何去做。因此，我决定发布具有使用参数启动服务的能力的更改类：

```
 public static class ServiceHelper
    {
        private const int STANDARD_RIGHTS_REQUIRED = 0xF0000;
        private const int SERVICE_WIN32_OWN_PROCESS = 0x00000010;

        [StructLayout(LayoutKind.Sequential)]
        private class SERVICE_STATUS
        {
            public int dwServiceType = 0;
            public ServiceState dwCurrentState = 0;
            public int dwControlsAccepted = 0;
            public int dwWin32ExitCode = 0;
            public int dwServiceSpecificExitCode = 0;
            public int dwCheckPoint = 0;
            public int dwWaitHint = 0;
        }

        #region OpenSCManager
        [DllImport("advapi32.dll", EntryPoint = "OpenSCManagerW", ExactSpelling = true, CharSet = CharSet.Unicode, SetLastError = true)]
        static extern IntPtr OpenSCManager(string machineName, string databaseName, ScmAccessRights dwDesiredAccess);
        #endregion

        #region OpenService
        [DllImport("advapi32.dll", SetLastError = true, CharSet = CharSet.Auto)]
        static extern IntPtr OpenService(IntPtr hSCManager, string lpServiceName, ServiceAccessRights dwDesiredAccess);
        #endregion

        #region CreateService
        [DllImport("advapi32.dll", SetLastError = true, CharSet = CharSet.Auto)]
        private static extern IntPtr CreateService(IntPtr hSCManager, string lpServiceName, string lpDisplayName, ServiceAccessRights dwDesiredAccess, int dwServiceType, ServiceBootFlag dwStartType, ServiceError dwErrorControl, string lpBinaryPathName, string lpLoadOrderGroup, IntPtr lpdwTagId, string lpDependencies, string lp, string lpPassword);
        #endregion

        #region CloseServiceHandle
        [DllImport("advapi32.dll", SetLastError = true)]
        [return: MarshalAs(UnmanagedType.Bool)]
        static extern bool CloseServiceHandle(IntPtr hSCObject);
        #endregion

        #region QueryServiceStatus
        [DllImport("advapi32.dll")]
        private static extern int QueryServiceStatus(IntPtr hService, SERVICE_STATUS lpServiceStatus);
        #endregion

        #region DeleteService
        [DllImport("advapi32.dll", SetLastError = true)]
        [return: MarshalAs(UnmanagedType.Bool)]
        private static extern bool DeleteService(IntPtr hService);
        #endregion

        #region ControlService
        [DllImport("advapi32.dll")]
        private static extern int ControlService(IntPtr hService, ServiceControl dwControl, SERVICE_STATUS lpServiceStatus);
        #endregion

        #region StartService
        [DllImport("advapi32.dll", SetLastError = true)]
        private static extern int StartService(IntPtr hService, int dwNumServiceArgs, string[] lpServiceArgVectors);
        #endregion

        public static void Uninstall(string serviceName)
        {
            IntPtr scm = OpenSCManager(ScmAccessRights.AllAccess);

            try
            {
                IntPtr service = OpenService(scm, serviceName, ServiceAccessRights.AllAccess);
                if (service == IntPtr.Zero)
                    throw new ApplicationException("Service not installed.");

                try
                {
                    StopService(service);
                    if (!DeleteService(service))
                        throw new ApplicationException("Could not delete service " + Marshal.GetLastWin32Error());
                }
                finally
                {
                    CloseServiceHandle(service);
                }
            }
            finally
            {
                CloseServiceHandle(scm);
            }
        }

        public static bool ServiceIsInstalled(string serviceName)
        {
            IntPtr scm = OpenSCManager(ScmAccessRights.Connect);

            try
            {
                IntPtr service = OpenService(scm, serviceName, ServiceAccessRights.QueryStatus);

                if (service == IntPtr.Zero)
                    return false;

                CloseServiceHandle(service);
                return true;
            }
            finally
            {
                CloseServiceHandle(scm);
            }
        }

        public static void InstallAndStart(string serviceName, string displayName, string fileName,string[] args)
        {
            IntPtr scm = OpenSCManager(ScmAccessRights.AllAccess);

            try
            {
                IntPtr service = OpenService(scm, serviceName, ServiceAccessRights.AllAccess);

                if (service == IntPtr.Zero)
                    service = CreateService(scm, serviceName, displayName, ServiceAccessRights.AllAccess, SERVICE_WIN32_OWN_PROCESS, ServiceBootFlag.AutoStart, ServiceError.Normal, fileName, null, IntPtr.Zero, null, null, null);

                if (service == IntPtr.Zero)
                    throw new ApplicationException("Failed to install service.");

                try
                {
                    StartService(service,args);
                }
                finally
                {
                    CloseServiceHandle(service);
                }
            }
            finally
            {
                CloseServiceHandle(scm);
            }
        }

        public static void StartService(string serviceName,string[] args)
        {
            IntPtr scm = OpenSCManager(ScmAccessRights.Connect);

            try
            {
                IntPtr service = OpenService(scm, serviceName, ServiceAccessRights.QueryStatus | ServiceAccessRights.Start);
                if (service == IntPtr.Zero)
                    throw new ApplicationException("Could not open service.");

                try
                {
                    StartService(service,args);
                }
                finally
                {
                    CloseServiceHandle(service);
                }
            }
            finally
            {
                CloseServiceHandle(scm);
            }
        }

        public static void StopService(string serviceName)
        {
            IntPtr scm = OpenSCManager(ScmAccessRights.Connect);

            try
            {
                IntPtr service = OpenService(scm, serviceName, ServiceAccessRights.QueryStatus | ServiceAccessRights.Stop);
                if (service == IntPtr.Zero)
                    throw new ApplicationException("Could not open service.");

                try
                {
                    StopService(service);
                }
                finally
                {
                    CloseServiceHandle(service);
                }
            }
            finally
            {
                CloseServiceHandle(scm);
            }
        }

        private static void StartService(IntPtr service,string[] args)
        {
            SERVICE_STATUS status = new SERVICE_STATUS();
            StartService(service, args.Length, args);
            var changedStatus = WaitForServiceStatus(service, ServiceState.StartPending, ServiceState.Running);
            if (!changedStatus)
                throw new ApplicationException("Unable to start service");
        }

        private static void StopService(IntPtr service)
        {
            SERVICE_STATUS status = new SERVICE_STATUS();
            ControlService(service, ServiceControl.Stop, status);
            var changedStatus = WaitForServiceStatus(service, ServiceState.StopPending, ServiceState.Stopped);
            if (!changedStatus)
                throw new ApplicationException("Unable to stop service");
        }

        public static ServiceState GetServiceStatus(string serviceName)
        {
            IntPtr scm = OpenSCManager(ScmAccessRights.Connect);

            try
            {
                IntPtr service = OpenService(scm, serviceName, ServiceAccessRights.QueryStatus);
                if (service == IntPtr.Zero)
                    return ServiceState.NotFound;

                try
                {
                    return GetServiceStatus(service);
                }
                finally
                {
                    CloseServiceHandle(service);
                }
            }
            finally
            {
                CloseServiceHandle(scm);
            }
        }

        private static ServiceState GetServiceStatus(IntPtr service)
        {
            SERVICE_STATUS status = new SERVICE_STATUS();

            if (QueryServiceStatus(service, status) == 0)
                throw new ApplicationException("Failed to query service status.");

            return status.dwCurrentState;
        }

        private static bool WaitForServiceStatus(IntPtr service, ServiceState waitStatus, ServiceState desiredStatus)
        {
            SERVICE_STATUS status = new SERVICE_STATUS();

            QueryServiceStatus(service, status);
            if (status.dwCurrentState == desiredStatus) return true;

            int dwStartTickCount = Environment.TickCount;
            int dwOldCheckPoint = status.dwCheckPoint;

            while (status.dwCurrentState == waitStatus)
            {
                // Do not wait longer than the wait hint. A good interval is
                // one tenth the wait hint, but no less than 1 second and no
                // more than 10 seconds.

                int dwWaitTime = status.dwWaitHint / 10;

                if (dwWaitTime < 1000) dwWaitTime = 1000;
                else if (dwWaitTime > 10000) dwWaitTime = 10000;

                Thread.Sleep(dwWaitTime);

                // Check the status again.

                if (QueryServiceStatus(service, status) == 0) break;

                if (status.dwCheckPoint > dwOldCheckPoint)
                {
                    // The service is making progress.
                    dwStartTickCount = Environment.TickCount;
                    dwOldCheckPoint = status.dwCheckPoint;
                }
                else
                {
                    if (Environment.TickCount - dwStartTickCount > status.dwWaitHint)
                    {
                        // No progress made within the wait hint
                        break;
                    }
                }
            }
            return (status.dwCurrentState == desiredStatus);
        }

        private static IntPtr OpenSCManager(ScmAccessRights rights)
        {
            IntPtr scm = OpenSCManager(null, null, rights);
            if (scm == IntPtr.Zero)
                throw new ApplicationException("Could not connect to service control manager.");

            return scm;
        }
    }

    public enum ServiceState
    {
        Unknown = -1, // The state cannot be (has not been) retrieved.
        NotFound = 0, // The service is not known on the host server.
        Stopped = 1,
        StartPending = 2,
        StopPending = 3,
        Running = 4,
        ContinuePending = 5,
        PausePending = 6,
        Paused = 7
    }

    [Flags]
    public enum ScmAccessRights
    {
        Connect = 0x0001,
        CreateService = 0x0002,
        EnumerateService = 0x0004,
        Lock = 0x0008,
        QueryLockStatus = 0x0010,
        ModifyBootConfig = 0x0020,
        StandardRightsRequired = 0xF0000,
        AllAccess = (StandardRightsRequired | Connect | CreateService |
                     EnumerateService | Lock | QueryLockStatus | ModifyBootConfig)
    }

    [Flags]
    public enum ServiceAccessRights
    {
        QueryConfig = 0x1,
        ChangeConfig = 0x2,
        QueryStatus = 0x4,
        EnumerateDependants = 0x8,
        Start = 0x10,
        Stop = 0x20,
        PauseContinue = 0x40,
        Interrogate = 0x80,
        UserDefinedControl = 0x100,
        Delete = 0x00010000,
        StandardRightsRequired = 0xF0000,
        AllAccess = (StandardRightsRequired | QueryConfig | ChangeConfig |
                     QueryStatus | EnumerateDependants | Start | Stop | PauseContinue |
                     Interrogate | UserDefinedControl)
    }

    public enum ServiceBootFlag
    {
        Start = 0x00000000,
        SystemStart = 0x00000001,
        AutoStart = 0x00000002,
        DemandStart = 0x00000003,
        Disabled = 0x00000004
    }

    public enum ServiceControl
    {
        Stop = 0x00000001,
        Pause = 0x00000002,
        Continue = 0x00000003,
        Interrogate = 0x00000004,
        Shutdown = 0x00000005,
        ParamChange = 0x00000006,
        NetBindAdd = 0x00000007,
        NetBindRemove = 0x00000008,
        NetBindEnable = 0x00000009,
        NetBindDisable = 0x0000000A
    }

    public enum ServiceError
    {
        Ignore = 0x00000000,
        Normal = 0x00000001,
        Severe = 0x00000002,
        Critical = 0x00000003
    } 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-08-26T15:01:02.563

在这篇文章中，我阅读了所有的帖子和评论，但我仍然不知道如何在添加 Windows 服务时设置帐户类型和 StartType 方法。这个代码示例在我这边工作得很好，它只是添加了一个服务自己的本地系统）但是我准备了安装程序，由于客户系统，我必须考虑**StartMode**和**User Account Type方法。**
ServiceBootFlag枚举似乎提供了 StartType，但**Account** **Type**仍然是一个问题。

```
 [DllImport("advapi32.dll", EntryPoint = "CreateServiceA")]

    private static extern IntPtr CreateService(IntPtr hSCManager, string

    lpServiceName, string lpDisplayName, ServiceRights dwDesiredAccess, int

    dwServiceType, ServiceBootFlag dwStartType, ServiceError dwErrorControl,

    string lpBinaryPathName, string lpLoadOrderGroup, IntPtr lpdwTagId, string

    lpDependencies, string lp, string lpPassword); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-03-15T12:30:16.993

使用以下代码使用 C# 安装 Windows 服务：

```
public void InstallWinService(string winServicePath)
{
        try
        {
            ManagedInstallerClass.InstallHelper(new string[] { winServicePath});
        }
        catch (Exception)
        {

            throw;
        }
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-06-13T20:38:10.083

另一种方法可能是在命令提示符下使用 SC.exe：

```
 System.Diagnostics.Process process = new System.Diagnostics.Process();
 System.Diagnostics.ProcessStartInfo startInfo = new 
 System.Diagnostics.ProcessStartInfo();
 startInfo.WindowStyle = System.Diagnostics.ProcessWindowStyle.Hidden;
 startInfo.FileName = "cmd.exe";
 startInfo.Arguments = "/C sc create MyService binpath=\"c:\\...\\MyService.exe\"";
 process.StartInfo = startInfo;
 process.Start(); 
```

# keyboard-shortcuts - 在解决方案资源管理器中找到 reSharper 快捷方式

> ID：358711
> 
> 赞同：18
> 
> 时间：2008-12-11T08:49:17.420
> 
> 标签：keyboard-shortcuts, resharper

我正在使用 ReSharper 并且喜欢它！

但是我有一个问题，当我点击 Shift-Alt-L ReSharper 时，如果它所在的文件夹是打开的，ReSharper 只会在解决方案资源管理器中找到该文件。如果文件夹未打开，ReSharper 不会找到该文件。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-04T16:58:07.013

实际上，对于 ReSharper 4.5，我们找到了解决 VS 问题的方法，因此在 ReSharper 4.5 中，这不再是问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-11T12:02:04.847

Visual Studio 中的已知错误 - 解决方案文件夹未以编程方式打开。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-11T09:11:01.290

`Ctrl`++结合 Visual Studio 的“解决方案资源管理器中的跟踪项目”对我有用`Shift`。`N`缺点是文件实际上是打开的。

# c# - 带有过滤器的 HttpModule - Writer 方法被调用两次

> ID：358712
> 
> 赞同：1
> 
> 时间：2008-12-11T08:49:21.413
> 
> 标签：c#, asp.net, httpmodule

我有一个带有过滤器（PageFilter）的 HttpModule，其中 PageFilter 的 Writer 方法为每个页面请求调用两次，不幸的是结果不同。

过滤器的想法是定位“”并在其前面插入一些文本/脚本。我找到了一堆小错误（并更正了它们），但是这个错误在欺骗我......

构造函数 og PageFilter 被调用一次，但它的 writer 方法每次请求被调用两次？

下面是 PageFilter.Writer 的内容（运行两次）

```
string strBuffer = System.Text.UTF8Encoding.UTF8.GetString (buffer, offset, count); 

try 
{
    Regex eof = new Regex("</html>", RegexOptions.IgnoreCase);

    if (!eof.IsMatch(strBuffer))
    {
       //(1)
       responseHtml.Append(strBuffer);
    }
    else
    {
        //(2)
        responseHtml.Append (strBuffer);
        string  finalHtml = responseHtml.ToString ();
        Regex   re = null;

        re = new Regex ("</body>", RegexOptions.IgnoreCase);
        finalHtml = re.Replace(finalHtml, new MatchEvaluator(lastWebTrendsTagMatch));
        // Write the formatted HTML back
        byte[] data = System.Text.UTF8Encoding.UTF8.GetBytes (finalHtml);

        responseStream.Write(data, 0, data.Length);       

       }
    }
    catch (Exception ex)
    {
       Logging.Logger(Logging.Level.Error, "Failed writing the HTML...", ex);
    } 
```

该方法第一次运行 case (1) 运行并在第二个 case (2) 运行......这不是我想要的，任何人都知道为什么和/或如何让它工作（一致地）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-11T10:55:09.460

可以为单个页面多次调用 Write 方法。HttpWriter 对象将数据分块在一起，然后将其写入其输出流。每次 HttpWriter 发出一大块数据时，都会调用响应过滤器的 Write 方法。

请参阅此以获取一种解决方案...

1.  [HttpResponse.Filter 多次写入](http://www.codeproject.com/KB/aspnet/RemovingWhiteSpacesAspNet.aspx?fid=151088&df=90&mpp=25&noise=3&sort=Position&view=Quick&select=1347107)

而不是 responseStream.Write(data, 0, data.Length); 尝试 responseStream.Write(data, 0, data.Length-1);

希望您觉得这个有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-11T12:29:24.247

这些“事件”发生在 1 页请求期间：

> isAspx = true og /_layouts/ 未找到（我验证文件是 .aspx 且 URL 不包含 /_layouts/）
> 
> 调用 PageFilter 构造函数
> 
> 编写器方法已启动...
> 
> eof（正则表达式）：（包含为匹配而创建的正则表达式）
> 
> !eof.IsMatch(strBuffer): （与正则表达式不匹配）
> 
> 编写器方法已启动...（第二次调用编写器）
> 
> eof（正则表达式）：（包含为匹配而创建的正则表达式）
> 
> 正则表达式启动（匹配正则表达式）
> 
> re（正则表达式）：（找到插入脚本所需的正文标签）
> 
> ScriptInclude = true（我发现 web.config 键告诉我的应用它应该包含脚本）
> 
> 使用的美国脚本（我也使用了基于 Web 配置密钥的美国版本的脚本）

问题是：在我的开发部署中，编写器运行了两次，以上述序列和包含的脚本结束。在我的测试部署中，作者运行了两次，最终不包括脚本......

我想避免两次调用 Writer，但更希望将脚本包含在测试部署中

# c# - CLR 什么时候说一个对象有一个终结器？

> ID：358714
> 
> 赞同：10
> 
> 时间：2008-12-11T08:51:38.850
> 
> 标签：c#, .net, memory-management, garbage-collection

我知道在 C# 中，如果您编写`~MyClass()`，这基本上会转换为`override System.Object.Finalize()`. 因此，无论您是否编写*析构函数*，CLR 中的每种类型都将有一个`Finalize()`方法（`System.Object`至少）。

1] 那么，这是否意味着，默认情况下，每个对象**都有**一个终结器？

2] CLR 决定一个对象应该进入终结队列的依据是什么？

我问这个，因为，我有一个类，说`ManagedResourceHolder`已实现`IDisposable`，但没有调用`GC.SuppressFinalize(this)`它的`IDisposable.Dispose()`方法。该类没有任何非托管资源，并且不需要该`~ManagedResourceHolder()`方法，这反过来意味着不需要 `GC.SuppressFinalize(this)`调用，因为没有*终结*器。

3] 在上述情况下，实现 IDisposable 时是否**总是**需要提供终结器？（即使在一个没有非托管资源的类上）

FxCop 规则[CA1816](http://msdn.microsoft.com/en-us/library/ms182269.aspx)违反了这一点，当我在 MSDN 上的 CA 论坛上提问时，我得到的回复让我感到困惑[。](http://social.msdn.microsoft.com/Forums/en-US/vstscode/thread/4e8a3155-6f12-4888-9ca1-f6762761e038)

谢谢。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-12-11T08:56:03.537

**问题 1 和 2**：CLR 基本上检查终结器是否被覆盖。如果不是，它会将其视为没有终结器。

在 System.Object 中有一个终结器的好处是编译器知道他们*总是*可以调用`base.Finalize()`in。这避免了版本控制问题。考虑一个没有 的世界`System.Object.Finalize()`：

*   System.Object（没有完成）
*   Acme.BaseClass（没有 Finalize）
*   MyCompany.DerivedClass（完成）

如果对象中没有`Finalize`方法，MyCompany.DerivedClass 中的终结器就不能调用任何东西。当 Acme.BaseClass 的第 2 版*带有*终结器时，这会导致问题。除非您重新编译 MyCompany.DerivedClass，否则 DerivedClass 的实例将在不调用 BaseClass.Finalize 的情况下完成，这显然是一件坏事。

现在考虑*与*System.Object.Finalize 相同的情况 - 编译器在 DerivedClass.Finalize 中自动插入对 base.Finalize 的调用，在版本 1 中它只是调用 System.Object 中的无操作实现。当 Acme.BaseClass 的第 2 版发布时，对`base.Finalize`will 的调用（无需重新编译 DerivedClass）调用 BaseClass.Finalize。

**问题 3**：不，你不需要仅仅因为你实现了 IDisposable 就拥有一个终结器。终结器应该只用于非托管资源，*没有其他东西可以清理*- 即您可以*直接*引用的资源。例如，假设您有一个具有`FileStream`成员变量的类。如果调用者记得，您想要实现`IDisposable`以便可以尽快关闭流 - 但如果他们*不*记得调用`Dispose()`，则流将与您的对象同时有资格进行垃圾收集。相信`FileStream`有一个适当的终结器（或使用终结器等引用其他东西），而不是试图在你自己的终结器中清理它。

从 .NET 2.0 开始，使用[SafeHandle](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.safehandle.aspx)类，您需要自己的终结器应该是*非常罕见的。*

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-11T09:00:26.180

1：只有在被覆盖时才真正重要（在有用的意义上）

2：如 1 所定义，并且 GC.SuppressFinalize 没有被调用（加上重新注册等）

3：当然不是；事实上，除非您直接处理非托管资源，否则您**不应该**有终结器。您不应该仅仅因为它是 IDisposable 而添加终结器 - 但具有终结器的东西通常也应该是 IDisposable。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-11T08:55:40.043

1.  不，不是这个意思。只有被覆盖`Finalize()`的才会被 CLR 计算在内。
2.  通过具有如上所述的终结器。
3.  不，这并不**总是**必要的。这只是一个很好的模式。我的意思是，没有人强迫你这样做。但是，如果您有非托管资源，这是一件好事，因为如果有人忘记处置它，非托管资源将在某个时候被释放。FxCop 不执行严格的规则。如果您不注意，它会强制执行可能导致未来失败的良好模式。

更新：每个班级都负责管理自己的资源。由于面向对象范式的抽象和封装特性，一个类的使用者不应该间接关心它拥有什么资源。因此，你应该要么手动释放你拥有的资源（你拥有的就是你**直接拥有的**，你把其他东西看成一个**黑盒子**）或者把它留给GC来释放它们。对于非托管资源，您没有选择将其留给 GC，因此您必须手动释放它。从这个意义上说，Jon 提到的 SafeHandle 是非**托管资源的托管抽象**，因此它应该被视为有价值的托管资源（这是一个管理非托管资源本身的最终确定的黑匣子）。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2008-12-11T09:01:29.970

1) 是（通过继承）

2) 没有任何东西持有对类实例的引用（这将使它有资格进行终结）

3) 是的（为什么要实现 IDisposable，除非它要求用户显式调用 dispose？.net 中的连接类在后台使用非托管资源＆如果您不调用 dispose，它将挂在它上面。由于 GC 时间未知，连接将保持打开直到那个时间）

这是我的理解。

我可能是错的。在这种情况下，专家会为我纠正问题。

# java - 存储和查找双数组

> ID：358718
> 
> 赞同：1
> 
> 时间：2008-12-11T08:57:42.630
> 
> 标签：java, lookup

我有一个相当昂贵的数组计算（SpectralResponse），我希望将其保持在最低限度。我认为最好的方法是存储它们并在将来再次需要相同的阵列时将其恢复。使用 BasicParameters 做出决定。

所以现在，我为 SpectralResponse 的数组使用对象的 LinkedList，为 BasicParameter 使用另一个 LinkedList。并且 BasicParameters 有一个 isParamsEqualTo(BasicParameters) 方法来比较参数集。

```
LinkedList<SpectralResponse> responses
LinkedList<BasicParameters> fitParams
LinkedList<Integer> responseNumbers 
```

所以要查找，我只是通过 BasicParameters 列表，检查匹配，如果匹配，则返回 SpectralResponse。如果不匹配，则计算 SpectralResponse。

这是我用来查找的 for 循环。

```
size: LinkedList size, limited to a reasonable value
responseNumber: just another variable to distinguish the SpectralResponse.

    for ( i = size-1; i > 0 ; i--) {
        if (responseNumbers.get(i) == responseNum)
        {
            tempFit = fitParams.get(i);
            if (tempFit.isParamsEqualTo(fit))
            {
                return responses.get(i);
            }
        }
    } 
```

但不知何故，这样做不仅会占用大量内存，而且实际上比直接计算 SpectralResponse 慢。慢得多。

所以是我的实现错了，还是我误以为预先计算和查找更快？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-11T09:01:57.237

您正在按索引访问 LinkedList，这是访问它的最糟糕的方法；）

您应该改用 ArrayList，或者对所有列表使用迭代器。

可能您应该将三个对象合并为一个，并将它们保存在以 responseNum 为键的映射中。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-11T09:03:53.833

您可能应该使用数组类型（实际的数组，如 Vector、ArrayList），而不是链接列表。链表最适合堆栈或队列操作，而不是索引（因为您必须从一端遍历它）。Vector 是一个自动调整大小的数组，访问 inexes 的开销更少。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-11T09:06:12.563

LinkedList 的 get(i) 方法要求获取每个项目，它必须沿着列表越来越远。考虑使用 ArrayList、iterator() 方法或仅使用数组。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-17T22:11:55.117

第二行 ' `if (responseNumbers.get(i) == responseNum)`' 也将是低效的，因为它`responseNumbers.get(i)`是一个整数，并且必须将其拆箱为一个 int（Java 5 及更高版本会自动执行此操作；如果 responseNum 被声明为一个 int，您的代码将不会在 Java 1.4 或更早版本上编译）。有关拳击的更多信息，请参阅[此内容。](http://en.wikipedia.org/wiki/Object_type)

要消除此拆箱开销，请使用 apache 原语库中的[IntList](http://commons.apache.org/primitives/api-release/org/apache/commons/collections/primitives/IntList.html)。该库包含将基础对象（在您的情况下为整数）存储为原始数组（例如 int[]）而不是对象数组的集合。这意味着不需要装箱，因为 IntList 的方法返回原始类型，而不是整数。

# c# - 当所有后台线程池线程完成时收到通知

> ID：358721
> 
> 赞同：10
> 
> 时间：2008-12-11T08:58:57.307
> 
> 标签：c#, multithreading, threadpool

当我使用 ThreadPool 启动 3..10 个线程时，我有一个场景。每个线程完成其工作并返回到 ThreadPool。当所有后台线程完成时，在主线程中通知哪些可能的选项？

目前我正在使用一种本土方法，为每个创建的线程增加一个变量，并在后台线程即将完成时减少它。这工作得很好，但我很好奇是否有更好的选择。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-11T09:05:39.290

减少变量（在线程之间）是有一点风险的，除非用`Interlocked.Decrement`. 请注意，它必须位于“finally”块中，以避免在异常情况下丢失它（另外你不想终止进程）。

在“Parallel Extensions”（或使用 .NET 4.0）中，您还可以查看`Parallel.ForEach`此处的选项……这可能是另一种将所有内容作为一个块完成的方式。无需手动观看它们。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-12-03T07:35:47.620

试试这个：[https ://bitbucket.org/nevdelap/poolguard](https://bitbucket.org/nevdelap/poolguard)

```
using (var poolGuard = new PoolGuard())
{
    for (int i = 0; i < ...
    {
        ThreadPool.QueueUserWorkItem(ChildThread, poolGuard);
    }
    // Do stuff.
    poolGuard.WaitOne();
    // Do stuff that required the child threads to have ended.

void ChildThread(object state)
{
    var poolGuard = state as PoolGuard;
    if (poolGuard.TryEnter())
    {
        try
        {
            // Do stuff.
        }
        finally
        {
            poolGuard.Exit();
        }
    }
} 
```

可以以不同的方式使用多个 PoolGuard 来跟踪线程何时结束，并在池已关闭时处理尚未启动的线程。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-11T11:27:19.083

如果等待的线程不超过 64 个，您可以使用 WaitHandle.WaitAll 方法，如下所示：

```
List<WaitHandle> events = new List<WaitHandle>();
for (int i = 0; i < 64; i++)
{
    ManualResetEvent mre = new ManualResetEvent(false);
    ThreadPool.QueueUserWorkItem(
        delegate(object o)
        {
            Thread.Sleep(TimeSpan.FromMinutes(1));
            ((ManualResetEvent)o).Set();
        },mre);
    events.Add(mre);
}
WaitHandle.WaitAll(events.ToArray()); 
```

执行将等到所有 ManualResetEvents 都设置完毕，或者，您可以使用 WaitAny 方法。

WaitAny 和 WaitAll 方法将阻止执行，但您可以简单地使用列表或链接到生成的任务的 ManualResetEvents 字典，以便稍后确定线程是否已完成。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-11T09:09:51.543

目前还没有内置的方法可以做到这一点——我发现这是使用池线程的最大痛苦之一。

正如 Marc 所说，这是在 Parallel Extensions / .NET 4.0 中修复的那种东西。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-11T10:11:04.867

难道你不能给每个线程一个不同的 ManualResetEvent 并在完成后让每个线程设置事件。然后，在主线程中，您可以等待所有传入的事件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-11T10:15:10.383

如果您只想知道所有工作何时完成，并且不需要比这更精细的信息（似乎是您的情况），Marc 的解决方案是最好的。

如果您希望某个线程生成作业，并希望某个其他线程接收通知，您可以使用 WaitHandle。代码要长得多。

```
 int length = 10;
    ManualResetEvent[] waits = new ManualResetEvent[length];
    for ( int i = 0; i < length; i++ ) {
        waits[i] = new ManualResetEvent( false );
        ThreadPool.QueueUserWorkItem( (obj) => {
            try {

            } finally {
                waits[i].Set();
            }
        } );
    }

    for ( int i = 0; i < length; i++ ) {
        if ( !waits[i].WaitOne() )
            break;
    } 
```

正如所写的，WaitOne 方法总是返回 true，但我这样写是为了让您记住一些重载将 Timeout 作为参数。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-12T11:55:28.377

使用 Semaphore 怎么样，并对其设置与线程池一样多的限制。有一个获取信号量的方法，在你启动线程时调用，在线程结束时释放它，如果你已经占用了所有信号量，则引发一个事件。

# ms-access - 通过 VBA 链接 Powerpoint 和 Access？

> ID：358722
> 
> 赞同：2
> 
> 时间：2008-12-11T08:59:15.823
> 
> 标签：ms-access, vba, powerpoint

我有一个包含文本框的 Powerpoint 幻灯片。我想将这些文本框与 Access 中数据表的过滤视图链接起来。

例如，如果我在 Access 中有一个 TaskList 应用程序，它显示具有不同优先级和影响的任务；有没有办法打开该文件，选择该视图，并根据我的 Powerpoint 演示文稿触发的 vba（或其他）onclick 按钮事件对其进行过滤？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-11T14:28:42.103

当然可以从 Powerpoint 获取 Access 数据。

您需要确保`Microsoft DAO Object Library`在您的 VBA 项目中设置了正确的引用。

然后，要在 PowerPoint 演示文稿中填充文本框，您可以调用类似于以下函数的内容，例如，返回包含与给定 TaskPriority 匹配的任务列表的字符串。

```
Function GetTaskListFromAccess(taskPriority as Integer) as String
  Dim db As DAO.Database
  Dim rs As DAO.Recordset
  Dim listOfTasks as String

  Set db = DBEngine.OpenDatabase(“C:\my_database.accdb”)

  Set rs = db.OpenRecordset("SELECT * FROM TaskTable WHERE TaskPriority=" & _
                            taskPriority, dbOpenSnapshot)
  If not rs is nothing then
    If rs.RecordCount > 0 then
      With rs
        While Not .EOF
          if listOfTask = "" then 
            listOfTasks = !TaskName
           Else 
            listOfTasks = listOfTasks & vbCrLf & !TaskName
          End If
          .MoveNext
        Loop
      .Close
      End With
    End If
    Set rs = nothing
  End If
  Set db = nothing

  GetTaskListFromAccess = listOfTasks
End Function 
```

# html - 使用 struts 自动检查单选按钮

> ID：358730
> 
> 赞同：0
> 
> 时间：2008-12-11T09:04:08.263
> 
> 标签：html, jsp, struts2, radio-button

我有一个带有两个无线电标签的 jsp 页面。

该页面包含一个struts2 表单。当我提交表单时，必须自动检查两个收音机之一。

有可能这样做吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-11T09:15:36.773

单选输入的一个特点是单选集中的项目一旦被选中就不能被取消选择，除非被选中的集合的另一个成员（与复选框“集合”不同）。即，如果您使用选择初始化页面，您可以保证您将获得一个值。是否存在您可以执行此操作的默认值？然后你可以只设置`checked="checked"`那个项目。

或者，您只需在 JS 和/或服务器端添加另一个验证规则。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-11T09:15:49.613

我相信：

```
<html:radio property="foo" value="yes"/> 
```

`getFoo()`如果form-b​​ean 的方法返回字符串“yes”，则此单选标记将显示为选中（默认情况下） 。

也许您可以使用它来将您的表单提交链接到您的无线电标签？

# sql - 使用外键向数据库添加新项目时，是否应该使用 SQL 触发器在其他表中创建相关行？

> ID：358760
> 
> 赞同：2
> 
> 时间：2008-12-11T09:19:55.440
> 
> 标签：sql, database-design, triggers, foreign-keys, constraints

我正在使用 SQL 2005 实现具有车辆表、车辆发动机和车辆齿轮表的数据库设计。

每个表都有一个 ID，它是一个 SQL 标识号，每个引擎和齿轮都与车辆 ID 有关系。因此，在我创建车辆之前，我必须创建引擎和齿轮。

创建引擎和齿轮时如何知道车辆识别号？由于发动机和齿轮表的外键约束，尚未创建车辆行？

我是否应该实施一个自动触发器，在创建车辆时为连接到车辆的发动机和齿轮创建一个空行？但是我又怎么知道车辆ID呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-11T10:09:28.053

无论哪种方式，都无需在您没有数据的任何表中创建行。例如，拥有与车辆不匹配的发动机排是很好的。您可以在找到时添加缺少的内容。

我想我理解设计。每辆车可以有一个发动机和一个变速器。但是您可以在找到车辆之前记录变速器或发动机。

它们确实是独立的实体，因此请这样对待它们。您可能很容易得到与车辆永远不匹配的发动机和变速箱。

另一个更有趣的问题是，您是否可能最终得到与发动机匹配的变速器，但没有车辆。人们经常看到发动机和电车用螺栓固定在一起，却看不到任何车辆。它们也经常一起出售。

事实上，您可以想象这三个中的任何一个单独存在，或者与其他实体中的一个或两个匹配。

触发器在这里没有任何作用。如果使用，触发器应该被限制为关于模式结构的细粒度的参照完整性规则——而不是像这样的业务规则。没有强制性约束 - 每个外键都是可选的（可为空的）。并且有几种不同的方法来设置 FK 字段。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-11T10:38:35.607

您在表之间具有外键关系这一事实并不意味着您必须按特定顺序创建数据。通常，人们会期望首先创建 Vehicle 记录，然后再为其分配引擎和齿轮，但情况并非如此。

如果在您的场景中，引擎或齿轮可能在分配给车辆之前记录在数据库中，那么您需要使引用车辆 ID 的 FK 列允许为空。一旦创建了车辆行，就可以将这些链接到车辆 ID。

或者，您可以创建您的车辆记录，然后在创建时为其分配发动机和齿轮记录。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-11T09:55:54.227

你确定你的桌子设计正确吗？我真的不明白你们实体之间有什么样的关系。例如：您是否尝试在 Vehicle 和 Engine 之间创建一对多或多对一的关系？

一种选择可能是（如果它满足您的需求）：

车辆：（ID、EngineID、GearID、...）

引擎（ID、其他引擎数据）

齿轮（ID，其他齿轮数据）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-11T14:41:53.010

感谢所有的答案。

实际上我的意思是：车辆：（ID，其他车辆数据，...）发动机（ID，车辆ID，其他发动机数据）齿轮（ID，车辆ID，其他齿轮数据）

所以每辆车都可以有多个引擎和齿轮……（是的，我知道在现实世界中，一个引擎可以安装多辆汽车，但这不是我的目标）

我不知道在 SQL 2005 中默认设置为 YES 的强制外键约束。

所以将其设置为 NO 并知道它的工作正常。

再次感谢，

暗里。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-11T09:54:52.343

每辆车只有一个发动机和一个齿轮吗？如果是这样，那么为什么它们在不同的表中？

如果您必须将它们放在两个表中，您可以创建一个 INSTEAD OF INSERT 触发器，如下所述：http: [//msdn.microsoft.com/en-us/library/ms175089.aspx](http://msdn.microsoft.com/en-us/library/ms175089.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-11T10:04:58.000

如果您必须有两个单独的表，您可以将它们加入一个视图，然后更新/插入到视图中......

```
CREATE VIEW VehicleComplete AS SELECT * FROM Vehicle INNER JOIN VehicleEngine USING(VehicleID)

UPDATE VehicleComplete SET Rego = 'ABC 123', EngineModel = '380' WHERE VehicleID = 1 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-11T10:10:51.280

我不得不说，我个人认为这种情况没有意义，真的。

为了使齿轮或发动机存在，您需要车辆。您的业​​务规则/域模型应该真正强制执行，然后外键关系只是验证这种情况的一种方式。

或者，最好将发动机-车辆关系视为多对多。为此，您需要一个附加表来链接车辆和发动机。这意味着您可以有外键约束，但这也意味着一个引擎可以链接到许多汽车，反之亦然。这更真实地模拟了现实世界，在许多汽车模型中使用相同的引擎，并且汽车可能有多种引擎可供选择。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-11T10:15:51.037

这类事情可以通过任何持久性框架来解决。在典型的 O/R 映射器场景中，您只需创建所需的实体（例如间接地），然后 O/R 映射器以正确的顺序保存它们并自动同步 FK/PK 字段。

如果您正在与这些问题作斗争，那么您真的会在已经为您解决的事情上浪费时间（因此也浪费金钱），并且您不能将这些时间花在为客户解决问题上。因此，请帮您自己和您的客户一个忙，至少看看那里的一些持久性框架。

（免责声明：我是 o/r 映射器框架的主要开发人员）

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-11T10:18:01.233

> 但是我又怎么知道车辆ID呢？

插入触发器中有一个名为[INSERTED的表。](http://msdn.microsoft.com/en-us/library/ms191300.aspx)您将在此处找到车辆 ID。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2008-12-11T10:38:19.960

如果你真的不能在不同的时刻创建每个实体，你应该在事务中创建它们，明确显示创建每个实体的必要步骤。

很多时候更容易实现的触发器解决方案将是最难维护的，因为它“隐藏”在 curtins 重要的业务规则后面。

好吧....在任何一种情况下，你都应该看看你的问题定义，因为这类问题通常是由糟糕的业务领域定义引起的。

**底线：您拥有的每个触发器都会为下一个项目迭代带来另一个麻烦。**

# svn - (Visual)SVN 通过正则表达式忽略文件

> ID：358764
> 
> 赞同：4
> 
> 时间：2008-12-11T09:20:57.387
> 
> 标签：svn, visualsvn

我需要排除具有以下模式的文件：

ProjectFoo.Data[0-9]{14}.lgp

如何将 RegEx 用于（Visual）SVN 忽略列表？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-11T10:32:35.947

颠覆忽略列表不支持正则表达式。它们被实现为 glob/file 模式。

这些模式不支持 {14} 重复结构。

图案

```
ProjectFoo.Data[0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9].lgp 
```

应该按照您的要求做，但我建议使用 ProjectFoo.Data[0-9]*.lgp 之类的东西，因为那样就“足够好”了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-11T10:20:08.453

由于该文件看起来像一个 LLBLGen Pro 项目备份文件，您可以强制 llblgen pro 将备份文件存储到一个单独的文件夹中（参见首选项：默认备份文件夹），例如 .\Backup。这样你就可以在 svn 中排除该文件夹，你就完成了:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T22:10:13.650

关于如何在此页面上使用由 VisualSVN 服务器支持的 TortoiseSVN 的其他答案的一些基本建议。您可以手动将 svn:ignore 属性添加到文件夹。Bert 对模式的 glob/file 建议在那里运行良好（我自己选择了“足够好”[0-9]*）。[更多信息在这里](http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-dug-ignore.html)。

导航到您想要的文件夹并右键单击 | TortoiseSVN | 属性 | 新 | 先进的。选择 svn:ignore 的属性名称，然后在值框中的单独行中输入您的 glob/文件模式。

# php - Symfony Action Security - 成功认证后如何转发？

> ID：358772
> 
> 赞同：1
> 
> 时间：2008-12-11T09:28:22.007
> 
> 标签：php, security, symfony1, action

使用 Symfony 的 Action Security，如果用户未被识别，他将被转发到应用程序 settings.yml 文件中定义的默认登录操作。用户成功通过身份验证后，如何将用户转发到最初请求的操作？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-12T21:39:04.203

在第一次点击您的登录操作时，将引用存储到用户会话：

```
if(!$this->getUser()->hasParameter('referer'))
{
  $this->getUser()->setParameter('referer',$this->getRequest()->getReferer());
} 
```

然后当登录成功时，将用户重定向到存储的引用者：

```
$this->redirect($this->getUser()->getParameter('referer')); 
```

您在 sfGuardPlugin 中有完整的示例：

[http://www.symfony-project.org/plugins/sfGuardPlugin](http://www.symfony-project.org/plugins/sfGuardPlugin)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-09T05:27:30.173

更简单...

```
$this->getUser()->setReferer($this->getRequest()->getReferer()); 
```

像

```
setReferer($referer)
{
  if (!$this->hasAttribute('referer'))
    $this->setAttribute('referer', $referer);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-07-28T17:53:34.653

一个相关的问题，而是尝试从不同的操作执行转发：

如果你有一个受 sfGuard 保护的动作试图重定向到referrer，你会在登录后得到一个重定向循环。这是因为 sfGuard 的登录页面将成为referrer。如果将参数或属性存储在上述登录操作中，则可以将参数或属性保存在多个请求中，这意味着如果已登录，该操作可能会重定向到不正确的页面。解决方案是使用会被遗忘的闪存。这可以通过 sfGuardAuthActions 的 executeSignin 方法中的以下代码来完成：

```
if ($this->getUser()->hasFlash('referer'))
{
  $this->getUser()->setFlash('referer', $this->getUser()->getFlash('referer'));
}
else
{   
  $this->getUser()->setFlash('referer', $this->getRequest()->getReferer());
} 
```

通过在第一个块中重置 flash，在登录尝试之间不会忘记它，并且通过使用 flash，从其他页面登录不会干扰您的操作。

# javascript - JQuery 循环 JQueryObjects

> ID：358780
> 
> 赞同：2
> 
> 时间：2008-12-11T09:30:30.067
> 
> 标签：javascript, jquery

我有一个方法，它将接受一个 JQuery 对象的参数并计算一个部分的总数。因此，如果您给它一个包含该部分的 div 的 JQuery 对象，它将计算它的总数

所以你可以这样做：

var $totalcompletion = CalculateSectionCompletion(jQuery("#Section1"));

现在我有多个带有部分容器类的 div。我希望能够在具有该类的任何 div 上调用上述方法。

我正在这样做：

jQuery("div.SectionContainer").each(function(i, valueOfElement){
CalculateSectionCompletion(valueOfElement);
});

问题是 valueOfElement 实际上是 DOM 对象而不是 JQuery 对象，所以我不能将它传递给我的方法。

无论如何，我是否可以遍历查询选择的所有 JQuery 对象，而无需编写一些脏代码来从 DOM 对象中提取 Id，然后调用 JQuery(valueOfElement.id) 并将其传入？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-11T09:41:03.040

您可以将任何 DOM 元素包装在 $(..) 中，就像使用 $(document) 一样。

所以我认为你应该能够

```
jQuery("div.SectionContainer").each( function(i, valueOfElement){
  CalculateSectionCompletion($(valueOfElement));
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-11T10:04:04.367

您也可以完全忽略 i 和 valueOfElement 参数并使用**this**。

```
jQuery("div.SectionContainer").each(function(){
  CalculateSectionCompletion(jQuery(this));
}); 
```

您甚至可以让 CalculateSectionCompletion 函数将其参数包装在 jQuery 对象中。

```
jQuery("div.SectionContainer").each(function(){
  CalculateSectionCompletion(this);
});

function CalculateSectionCopletion(e){
  jQuery(e).dostuff();
} 
```

# python - python，在pexpect中设置终端类型

> ID：358783
> 
> 赞同：4
> 
> 时间：2008-12-11T09:32:43.853
> 
> 标签：python, pexpect

我有一个使用 pexpect 启动 CLI 程序的脚本。它的工作方式有点像一个 shell，你会得到一个提示，你可以在其中输入一些命令。

我认为，我遇到的问题是该程序使用了彩色提示。

这就是我所做的

```
import pprint
import pexpect

1 a = pexpect.spawn('program')
2 a.expect("prompt>")
3 print "---------start------------"
4 print(a.before)
5 a.sendline("command")
6 a.expect("prompt>")
7 print "---------before------------"
8 pprint.pprint(a.before)
9 print "---------after------------"
10 pprint.pprint(a.after) 
```

这是输出：

```
> python borken.py
---------start------------
A lot of text here from the enjoying programs start-up, lorem ipsum ...  
---------before------------
' \x1b[0m\x1b[8D\x1b[K\x1b[1m\x1b[34m'
---------after------------
'prompt>' 
```

由于某种原因，第一个提示颜色编码使事情变得混乱，并且第 8 行的 a.before 是乱码，正常打印不起作用，即使我看到第 5 行的命令实际上产生了很多输出。

有人知道问题可能是什么，或者是否可以设置终端类型以避免颜色？

我正在使用 tcsh 外壳

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-11T12:52:34.980

好的，我找到了答案。csl 的回答让我走上了正确的道路。

pexpect 有一个我认为可以使用的“env”选项。像这样：

```
a = pexpect.spawn('program', env = {"TERM": "dumb"}) 
```

但这会产生一个对我不起作用的新外壳，我们的开发环境取决于很多环境变量：/

但是如果我在生成 shell 之前这样做：

```
import os
os.environ["TERM"] = "dumb" 
```

我更改了当前的 "TERM" 和 "dumb" 不支持颜色，这解决了我的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-11T09:38:59.270

[在pexpect 文档](http://pexpect.sourceforge.net/pexpect.html)中找不到用于设置终端的任何内容，但您可能可以使用 shell 显式启动程序，然后在此处设置终端类型：

```
shell_cmd = 'ls -l | grep LOG > log_list.txt'
child = pexpect.spawn('/bin/bash', ['-c', shell_cmd])
child.expect(pexpect.EOF) 
```

你可以尝试类似的东西

```
child = pexpect.spawn('TERM=vt100 /bin/bash', ['-c', shell_cmd]) 
```

您也可以使用 --norc 和类似的方式启动 bash，以避免读取初始化文件。查看[bash 手册页](http://linux.die.net/man/1/bash)。

# java - Javolution 测试模式，注意事项

> ID：358786
> 
> 赞同：2
> 
> 时间：2008-12-11T09:33:04.103
> 
> 标签：java, unit-testing

[为Javolution](http://javolution.org/)测试编写测试时有哪些模式和注意事项？我特别想知道：

*   TestCase.execute() 不允许抛出异常。如何对付他们？重新抛出 RuntimeException 或存储在变量中并在 TestCase.validate() 中断言或其他什么？
*   是否有任何图形运行程序向您显示失败的测试，即在 Eclipse 中？也许有人写了一个 JUnit-Wrapper 以便我可以使用 Eclipse JUnit Runner？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-22T09:54:00.933

javadoc 和 javolution 源提供了一些示例和设计原理。另请参阅[有关服务器端的文章](http://www.theserverside.com/news/thread.tss?thread_id=46761)。

Javolution 测试只包含一个测试，并且测试代码的执行与验证分离为不同的方法 execute() 和 validate()。因此，相同的测试类可用于回归测试和速度测试（省略了对 validate() 的调用）。许多测试的执行也很容易并行化。

这种分离的一个缺点是：你会消耗更多的内存，因为在调用 validate() 之前需要保存执行代码的执行结果。（在 tearDown 中释放这些结果可能是一个好主意。）如果 validate 来自与 exercise 不同的类，那么可能很难调试失败。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-22T10:06:05.650

您可以通过使用以下 JUnit 适配器并在 eclipse 中运行它来获得某种图形测试运行程序。您可以单独启动/调试失败的测试。不幸的是，图形表示不包含有关实际测试的任何内容 - 它仅显示数字 [0]、[1] 等。

@RunWith(Parameterized.class) 公共类 JavolutionJUnit4Adapter {

```
protected final javolution.testing.TestCase test;

public JavolutionJUnit4Adapter(javolution.testing.TestCase testcase) {
    this.test = testcase;
}

@org.junit.Test
public void executeTest() throws Exception {
    enter(REGRESSION);
    try {
        new javolution.testing.TestSuite() {
            @Override
            public void run() {
                test(test);
            }
        }.run();
    } finally {
        exit();
    }
}

@Parameters
public static Collection<javolution.testing.TestCase[]> data() {
    javolution.testing.TestSuite fp = new WhateverSuiteYouWantToRun();
    List<javolution.testing.TestCase> tests = fp.getTestCases();
    Collection<javolution.testing.TestCase[]> res = new ArrayList<javolution.testing.TestCase[]>();
    for (javolution.testing.TestCase t : tests) {
        res.add(new javolution.testing.TestCase[] { t });
    }
    return res;
} 
```

}

# php - 如何使用 PHPMailer 发送包含 CSS 的 HTML 邮件？

> ID：358788
> 
> 赞同：7
> 
> 时间：2008-12-11T09:33:56.487
> 
> 标签：php, html, css, phpmailer

我在使用[PHPMailer](http://phpmailer.worxware.com/index.php?pg=phpmailer)发送 HTML 邮件时遇到问题。我制作了一个[Smarty](http://en.wikipedia.org/wiki/Smarty)模板，并从中获得了所有的 HTML 代码。但是当我发送邮件时，我收到的邮件没有包含 CSS（它只有背景颜色、字体或类似的东西）。在 PHPMailer 中，我将邮件设置为 HTML。

有没有办法发送包含 CSS 的 HTML 邮件？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2010-02-05T19:31:59.197

有办法...

```
 $body = <<< YOUR_HTML_WITH_CSS_STYLE_TAGS
<html>
<head>
    <style>
        body * {width:1px;}
        #adiv {padding:2px;}
        .aclass {margin:3px;}
    </style>
</head>
<body>
    <div>
        some html
    </div>
    <div id="adiv">
        <p class="aclass">
        </p>
    </div>
</body>
</html>
YOUR_HTML_WITH_CSS_STYLE_TAGS;
    $doc = new DOMDocument();
    @$doc->loadHTML($body);
    $xpd = new DOMXPath($doc);
    0&&$node = new DOMElement();
    $result = $xpd->query('//img');
    foreach($result as $node){
        $attr = $node->getAttribute('src');
        $re = '/(http:\/\/.*?)?(\/.*+)/i';
        if(preg_match_all($re, $attr, $matches)){
            if(!empty($matches[1][0])&&0)
                continue;
            $attr = 'http://'.$_SERVER['HTTP_HOST'].$matches[2][0];
        }
        $node->setAttribute('src',$attr);
    }
    false&&$node=new DOMElement()&&$child=new DOMElement();
    $result = $xpd->query('//style/..');
    foreach($result as $node){
        foreach($node->childNodes as $child){
            if(strtolower($child->nodeName)=='style'){
                $node->removeChild($child);
                $css = $child->textContent;
                $re = '/(.*?)\{([^}]+)\}/';
                if(preg_match_all($re, $css, $matches)){
                    foreach($matches[1] as $idx=>$css_selector){
                        $css_text = $matches[2][$idx];
                        $css_text = preg_replace('/\s+/',' ',$css_text);
                        $css = new CSSQuery($doc);
                        foreach($css->query($css_selector) as $selected_node){
                            $style = $selected_node->getAttribute('style');
                            $selected_node->setAttribute('style', $style?$css_text:$style.';'.$css_text);
                        }
                    }
                }
            }
        }
    }
    $body = $doc->saveHTML(); 
```

该代码将在 $body 中生成一个 HTML 输出，如下所示：

```
<html>
<head>
</head>
<body>
    <div style="width:1px;">
        some html
    </div>
    <div id="adiv" style="width:1px;padding:2px;">
        <p class="aclass" style="width:1px;margin:3px;">
        </p>
    </div>
</body>
</html> 
```

该类`CSSQuery`可以在[phpclasses.org](http://www.phpclasses.org/)找到。这个实现是基于这样一个事实，即大多数网络邮件只允许通过内联标签属性样式添加样式，而不是通过样式标签或链接标签。

它非常有限，并且由于正则表达式的语法受到限制，它有点简单，但它仍然比你自己在每个 HTML 标记中编写内联样式属性要好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-11T09:48:44.850

至少，电子邮件中的 CSS 支持非常有限。最大的问题是不同的客户端支持不同的 CSS 属性集。

您为我们提供的工作环境非常少。

*   您的电子邮件显示如何？CSS根本没有解析吗？您的 CSS 是否在屏幕上显示为文本？
*   你的 CSS 看起来如何？
*   您的电子邮件模板看起来如何？

有关电子邮件中 ​​CSS 支持的更多信息，请参阅此[出色的概述。](http://www.campaignmonitor.com/css/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-11T10:38:34.190

这是一篇关于 HTML 电子邮件的非常好的[SitePoint](http://en.wikipedia.org/wiki/SitePoint)文章，“[如何编写 HTML 电子邮件通讯](http://www.sitepoint.com/article/code-html-email-newsletters/)”。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-11T09:39:41.670

HTML 和 CSS 充满了痛苦和挫败感。与 PHP 无关，很明显，大多数实现*咳咳*前景*咳咳*，并且仍然过时。

这是我建议的唯一领域（其他人可能有更好的理解/计划*），但您应该考虑使用 <table>、<font> 和 <hr 剪切 CSS 并编写 90 年代中期的样式 html > 标签（哦，我的）

** 请分享 ：）*

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-11T10:13:41.930

一些电子邮件客户端会去掉 <head> 部分，因此将 <style></style> 标签放在 <body> 中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-11T09:40:57.580

您的样式表是如何引用的？

对于电子邮件，您要么必须提供样式表的绝对路径，要么将样式包含在模板的头部

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-11T09:41:32.650

我假设您将 CSS 保存在外部文件中，如果是这样，最简单的解决方案是将其简单地移动到邮件内的 html 标头中。

但是，电子邮件客户端中的 CSS 支持*非常*不稳定，因此它们可能只是糟糕的渲染。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-11T10:22:26.903

我发现对 CSS 的最佳（阅读最广泛）支持是内联（style=""）。悲伤，但真实。

# javascript - IE6 有时不加载样式表

> ID：358789
> 
> 赞同：0
> 
> 时间：2008-12-11T09:34:39.793
> 
> 标签：javascript, css, iis, internet-explorer-6

我们遇到了一个问题，IE6（我们注意到发生这种情况的唯一浏览器）似乎正在缓存我们主样式表的空版本。解决问题的唯一方法是直接在浏览器中输入样式表的 url 来请求样式表，然后当您刷新页面时，它将与样式一起出现。大约一周左右后，它会再次发生。

并非所有用户都会发生这种情况，但我们无法弄清楚为什么会发生这种情况。

我们在 Server 2003 上运行 IIS，这个问题在几个月前开始发生（在此之前从未出现过任何问题）。

感谢您提供的任何帮助。

保罗

*我仔细看了看，现在它也对某些 Javascript 做同样的事情。

*   2008 年 12 月 12 日

感谢Grant 的帮助，IE 已经被锁死了，但是检查了可以改的，没问题，没有安装额外的插件。

如果您 Ctrl-F5 或终止临时文件，它似乎没有做任何事情。直到您直接请求文件，它才真正解决了问题，这确实表明 IE 缓存损坏或空版本存在问题。不幸的是，我现在必须等到它再次发生，然后我要检查服务器上的日志文件。

再一次感谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-11T17:44:22.393

我不能给你一个直接的答案，但我会首先安装[Fiddler](http://www.fiddlertool.com/fiddler/)并调查导致你问题的文件的响应头`Content-type`。`last-modified`

还要注意`If-Modified-Since`和`Pragma`请求标头值。

同样，我会检查 IE 中的辅助功能设置（工具 > Internet 选项... > 辅助功能）。

此外，请确保他们没有安装任何可能导致此类行为的附加组件。一个不相关的例子：几年前，我们遇到了一个问题，即 IE6 停止在我们的一个用户的浏览器窗口之间共享会话 cookie。原来是IE的一些光标插件导致了这个问题。

显然，如果您的用户使用的是 IE 的锁定副本，则上述建议不适用。

最后，如果用户按住 CTRL 并按 F5 无条件刷新页面会发生什么，那么他们是否获得了样式表和 JavaScript 文件的最新副本？您是否尝试过完全清除浏览器历史记录并加载页面的新副本（也许缓存本身已损坏）？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-11T09:44:00.210

我也有过同样的行为。但是，我使用的是 php 生成的样式表，标题和所有其他信息（客户端缓存、服务器端缓存、压缩）在 PHP 中进行了微调以获得最佳性能。

工作就像一个魅力，但似乎 IE6 没有以不可重现的方式在某些计算机上加载样式表。我没有时间调查，也无法访问有问题的计算机，所以我们回到了普通的简单样式表，一切都恢复了正常。我们说它与防火墙有关，但我敢肯定 IE6 中隐藏着一些令人讨厌的东西。

我想知道它是什么...

# xhtml - DocType xhtml1-transitional.dtd 忽略表格单元格高度

> ID：358791
> 
> 赞同：3
> 
> 时间：2008-12-11T09:36:57.387
> 
> 标签：xhtml, html-table, doctype

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" >
<head runat="server">
    <title>Untitled Page</title>
    <link href="Stylesheet.css" rel="stylesheet" type="text/css" />
</head>
<body>
    <table style="height: 100%; width: 100%;">
        <tr>
            <td colspan="2" style="height: 100px;">Header</td>
        </tr>
        <tr>
            <td style="width: 180px;">Links</td>
            <td>Content</td>
        </tr>
        <tr>
            <td colspan="2" style="height: 25px;">Footer</td>
        </tr>
    </table>
</body>
</html> 
```

Stylesheet.css 如下所示：

```
*
{
    margin: 0;
    padding: 0; 
}
html, body
{
    height: 100%;
    width: 100%;
} 
```

上面的第 1 行和第 3 行具有固定的高度。第 3 行未填充剩余空间。如果我省略了文档类型，它会按预期工作。我需要使用这个文档类型。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-11T09:43:01.790

请说明您尝试修复此问题的浏览器。

`<div>`如果你想正确地做事，你应该使用's ;)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-17T15:50:05.527

这是由`Transitional DOCTYPE`. 改为使用`Strict DOCTYPE`。

```
https://developer.mozilla.org/en/Gecko's_%22Almost_Standards%22_Mode 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-06-17T17:57:11.553

如果您遇到与我相同的问题，您会大喊大叫。尝试在每个声明之后放置 px 。如果没有该像素指定，它在任何一个浏览器中都不起作用。我发现这个问题到处都是，而且真的很头疼。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-11T10:03:30.593

我不是网络开发人员，但高度不只适用于块对象吗？因此尝试设置 TR 的高度，而不是 TD 的高度。

# delphi - 我如何在 Delphi 中做连接点？

> ID：358792
> 
> 赞同：0
> 
> 时间：2008-12-11T09:38:25.060
> 
> 标签：delphi, excel, idispatch, iconnectionpoint

我正在编写一个 DLL，它通过其 IDispatch 接口与 Excel 对话。从 VBA 中，我传入一个 Variant 包含`Application.Caller`我从中绘制 IDispatch 指针通过`.pDispVal`.

我想知道的是如何通过 IDispatch 指针查询接口。我想设置一个连接点容器，并从那里找到一个到 Excel 的连接点。最终目标是将事物与 Excel 的计算事件联系起来，并能够操作 Excel 数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-11T11:05:47.347

Brian Long 解释： http: [//www.blong.com/Conferences/IConUK2000/DelphiMoreAutomation/More%20Automation%20In%20Delphi.htm#Events](http://www.blong.com/Conferences/IConUK2000/DelphiMoreAutomation/More%20Automation%20In%20Delphi.htm#Events)

其他资源：

*   [http://dn.codegear.com/article/27126](http://dn.codegear.com/article/27126)
*   [http://www.gtro.com/delphi/comevents_e.php](http://www.gtro.com/delphi/comevents_e.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-11T23:16:47.090

我会推荐 Binh Ly 在[http://www.techvanguards.com/](http://www.techvanguards.com/)上的永恒优秀的 (Delphi) COM 教程，其中包括完全致力于[`IConnectionPoint`和相关机制](http://www.techvanguards.com/com/concepts/connectionpoints.asp)的章节。

他还提供了用于生成 EventSink 代码的免费工具。

`Application`不过，我有一种强烈的感觉，如果您只想对 Excel对象触发的事件做出反应，那么这根本就没有必要。您是否尝试过简单地使用 Delphi 类型库导入器为您生成的包装对象？当然，您也可以编写自己的包装器。

再说一次，我实际上还没有为 Excel 编写任何插件 - 但我确实为 Outlook 和 Word 编写插件，而 Excel 在这方面确实应该没有太大的不同。

# design-patterns - 另一个类中方法的设计模式

> ID：358793
> 
> 赞同：1
> 
> 时间：2008-12-11T09:38:50.813
> 
> 标签：design-patterns, oop

我正在寻找一个特定的设计模式。

例如，我有一个文章类 clsArticle。此类包含成员变量，如 Id、标题、作者、文章等。想象一下，我想在列表中显示所有文章。所以在某个地方我必须创建一个方法 getAllArticles()。由于 clsArticle 不负责获取所有文章，因此我必须将此方法放在另一个类 clsArticleFact（Fact 代表工厂）中。

有人知道这种模式的名称吗？这种工作方式是设计模式吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-11T09:44:48.510

是的。这是正确的。

它可以是 AbstractFactory 或 DataAccessObject。

第一个是当你想让实现返回不同类型的文章时

例如，假设您有一个条件，即文章的行为因平台而异。

```
ArticleFactory.getAll(): Article[] 
```

将在每个平台中返回正确的列表。

impl 可能是：

```
WindowsArticleFactory 
```

或者

```
OSXArticleFactory 
```

前者可用于抽象检索文章的位置：

你可能有

```
ArticleDao.getAll(): Article[] 
```

和实现：

```
XmlArticleDao // Return a list of articles from an XML 
```

或者

```
DatabaseArticleDao // return the list from the database. 
```

这里的重点是将创建（ getAll() ）与使用（ Article ）分离

如果您的应用程序足够简单，则可以改用 factoryMethod。

```
 class Article { 
     static Article[] getAll() {
         // do whatever is neede here...
     }
 } 
```

我希望这有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-11T10:26:02.293

您还可以使用 Rails ActiveRecord 模型类采用的方法

```
public class clsArticle
{
  public static clsArticle[] findAll() { /*... */ }

  // the other regular code here;
}

// client code
foreach(clsArticle obArticle in clsArticle.findAll())
{
  list.add(clsArticle)
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-11T10:03:14.230

好吧，为此目的创建一个静态类：

```
public static class clsArticles
{
    public static clsArticles[] GetAllArticles() { /* actual code */ }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-11T10:27:07.037

您所描述的并不是真正的模式，而是一种称为“**关注点分离**”的编程原则。

根据您的描述，我强烈认为您遵循结构设计模式，而不是创建设计模式，因为编码关注点的分配是在创建共谋上讨论的。

所以，我最好的猜测是你所追求的模式可能是**Facade Pattern**或**Gateways**。通常将实体（您的 clsClass）与网关一起使用。

但是，我不一定鼓励将您的方法设为静态，但是从那时起，在测试业务逻辑期间就不能模拟这些方法。如果这些类型的方法形成应用程序的数据层，您将希望模拟这些返回数据访问对象的方法，因为当业务逻辑依赖于这些网关/门面时，您不希望访问数据库。

```
public class clsClass
{
    public int ID;
    public string title;
    public string author;
    public string article;
}

public class BookGateway
{
    public List<clsClass> GetAllArticles()
    {
        var result = new List<clsClass>();

        // Add items here.
        // Can call database and populate each new clsClass
        // and add to result object.

        return result;
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-11T10:51:46.440

不要创建静态方法！

您首先想到的应该是**interface**。

也许您可以编写类似（Java 中的示例）

```
public interface ArticleService {
    Article[]  getAllArticles() throws ServiceException();
} 
```

您需要对文章执行的所有其他操作也进入此界面。将此类（DbArticleService、XmlArticleService、...）的具体实现注入到需要处理文章的每个对象中。

这样，正如其他海报所提到的，您可以获得解耦的代码和很好的关注点分离。

但无论你做什么，都不要让事情变得静态。

# c# - 将邮件转移到其他邮箱

> ID：358797
> 
> 赞同：1
> 
> 时间：2008-12-11T09:39:23.777
> 
> 标签：c#, outlook, exchange-server, mapi

我正在开发一个应用程序，我需要将邮件从邮箱传输到另一个邮箱。我无法使用 smtp 发送这些邮件，因为这会更改标题信息。我正在使用 C# 和 outlook api 来处理邮件。有什么方法可以在不更改邮件标题的情况下将邮件转移到其他邮箱。

* * *

转移我的意思是，我需要从一个邮箱中取出一封邮件并将其移动到另一个邮箱而不更改任何标题信息。如果我使用 smtp ，标题信息将被更改。我听说使用 MAPI 邮件可以从一个邮箱移动到另一个邮箱。任何指针。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-17T10:06:58.743

我能够使用 Redemption 将邮件从一个邮箱移动到另一个邮箱。这就像从一个邮箱复制邮件到另一个邮箱。首先使用兑换登录到目标邮箱。获取对要移动邮件的文件夹的引用。就我而言，它是收件箱。现在将 Outlook 邮件项目转换为 RDOMail 并将 rdomail 复制到目标文件夹。这是代码 -

```
 rdoSession.LogonExchangeMailbox("TEST", "ServerName");
 RDOExchangeMailboxStore mailBoxStore = (Redemption.RDOExchangeMailboxStore)
 rdoSession.Stores.DefaultStore;
 RDOFolder inboxFolder = null;

            foreach (RDOFolder rdoFolder in mailBoxStore.IPMRootFolder.Folders)
            {
                if (rdoFolder.Name.Equals("Inbox", StringComparison.InvariantCultureIgnoreCase))
                {
                    inboxFolder = rdoFolder;
                    break;
                }
            }
            rdoMail.CopyTo(inboxFolder); 
```

这样，邮件将被复制到新邮箱，而不更改任何标题信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T14:56:21.303

如果您无法将所有相关邮箱加载到单个 Outlook 配置文件中，则无法使用 Outlook API 解决此问题。但是，应该可以从通过扩展 MAPI 直接访问 Exchange 信息存储的管理帐户运行独立应用程序。然后，您可以按顺序打开源邮箱并将相关邮件项目移动到目标邮箱。

这将允许您在单个巨型操作中运行从中央位置收集所有邮箱的批处理作业。但是，如果您的任务是在消息出现时移动它们，那么也许通过安装在源计算机上的 Outlook 插件以更加分散的方式解决这个问题可能是一种更明智的方法。也许如果你告诉我们更多关于你移动这些物品的动机，我们可以想出一个更好的解决方案。

如果您采用集中式收割机方法，我强烈建议您为此使用像[Redemption](http://dimastr.com/redemption/)这样的辅助库，否则可能需要几个月的时间才能收集到足够的知识来完成任务。[RDO](http://dimastr.com/redemption/rdo/)框架（赎回数据对象）应该特别适合让您尽快运行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-11T11:46:41.133

如果您使用 Outlook API，我确信支持备份和恢复。因此，从一个帐户备份您的邮件并在另一个帐户上恢复它。这将是我的第一次尝试。PS：我不熟悉API。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-11T13:20:26.560

邮箱是什么关系？它们在同一个 Exchange 服务器上吗？如果是这样，最好的办法是使用 MAPI 来复制消息。如果没有，您可以将消息导出到 PST 或 .msg 文件的集合。这需要自动化吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-11T18:23:00.630

你所说的“转移”到底是什么意思？如果您说的相当于将邮件从一个邮箱拖放到加载在同一 Outlook 配置文件中的另一个邮箱，那么只需使用该`MailItem.Move`方法即可。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-12T12:42:23.600

那么你需要的是 MAPI。这是一个相当复杂的 API。有一本关于它的绝版书，但仅此而已。最好的起点是下载 MFCMapi 并查看您可能会如何做您需要做的事情，例如打开两个用户的邮箱并在他们之间复制一条消息。然后，查看 MFCMapi 的源代码，看看它是如何完成的，然后从那里开始工作。

# java - 具有动态测试数量的 JUnit 测试

> ID：358802
> 
> 赞同：96
> 
> 时间：2008-12-11T09:39:45.010
> 
> 标签：java, unit-testing, junit, parameterized-unit-test

在我们的项目中，我有几个[JUnit](http://www.junit.org/)测试，例如从目录中获取每个文件并对其运行测试。如果我在其中实现一个`testEveryFileInDirectory`方法，那么`TestCase`这将显示为只有一个可能失败或成功的测试。但我对每个单独文件的结果感兴趣。如何编写`TestCase`/`TestSuite`以使每个文件显示为单独的测试，例如在 Eclipse 的图形 TestRunner 中？（为每个文件编写明确的测试方法不是一种选择。）

还将问题[ParameterizedTest 与 Eclipse Testrunner 中的名称进行比较](https://stackoverflow.com/questions/385925/parameterizedtest-with-a-name-in-eclipse-testrunner)。

* * *

## 回答 #1

> 赞同：104
> 
> 时间：2008-12-11T10:32:28.833

看看JUnit 4 中的**参数化测试**。

实际上我几天前就这样做了。我会尽力解释...

首先正常构建您的测试类，就像您只使用一个输入文件进行测试一样。用以下方式装饰你的班级：

```
@RunWith(Parameterized.class) 
```

构建一个构造函数，该构造函数接受在每次测试调用中都会更改的输入（在这种情况下，它可能是文件本身）

然后，构建一个返回`Collection`数组的静态方法。集合中的每个数组都将包含您的类构造函数的输入参数，例如文件。使用以下方法装饰此方法：

```
@Parameters 
```

这是一个示例类。

```
@RunWith(Parameterized.class)
public class ParameterizedTest {

    private File file;

    public ParameterizedTest(File file) {
        this.file = file;
    }

    @Test
    public void test1() throws Exception {  }

    @Test
    public void test2() throws Exception {  }

    @Parameters
    public static Collection<Object[]> data() {
        // load the files as you want
        Object[] fileArg1 = new Object[] { new File("path1") };
        Object[] fileArg2 = new Object[] { new File("path2") };

        Collection<Object[]> data = new ArrayList<Object[]>();
        data.add(fileArg1);
        data.add(fileArg2);
        return data;
    }
} 
```

还要检查这个[例子](http://www.nofluffjuststuff.com/blog/paul_duvall/2007/04/take_heed_of_mixing_junit_4_s_parameterized_tests)

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2008-12-11T11:04:15.337

**JUnit 3**

```
public class XTest extends TestCase {

    public File file;

    public XTest(File file) {
        super(file.toString());
        this.file = file;
    }

    public void testX() {
        fail("Failed: " + file);
    }

}

public class XTestSuite extends TestSuite {

    public static Test suite() {
        TestSuite suite = new TestSuite("XTestSuite");
        File[] files = new File(".").listFiles();
        for (File file : files) {
            suite.addTest(new XTest(file));
        }
        return suite;
    }

} 
```

**JUnit 4**

```
import org.junit.Test;
import org.junit.runner.RunWith;
import org.junit.runners.Parameterized;
import org.junit.runners.Parameterized.Parameters;

@RunWith(Parameterized.class)
public class TestY {

    @Parameters
    public static Collection<Object[]> getFiles() {
        Collection<Object[]> params = new ArrayList<Object[]>();
        for (File f : new File(".").listFiles()) {
            Object[] arr = new Object[] { f };
            params.add(arr);
        }
        return params;
    }

    private File file;

    public TestY(File file) {
        this.file = file;
    }

    @Test
    public void testY() {
        fail(file.toString());
    }

} 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2017-03-27T20:18:48.667

**Junit 5 参数化测试**

[JUnit 5](https://junit.org/junit5/docs/current/user-guide/#writing-tests-parameterized-tests)参数化测试通过允许使用[方法作为数据源](https://junit.org/junit5/docs/current/user-guide/#writing-tests-parameterized-tests-sources-MethodSource)来支持这一点：

```
@ParameterizedTest
@MethodSource("fileProvider")
void testFile(File f) {
    // Your test comes here
}

static Stream<File> fileProvider() {
    return Arrays.asList(new File(".").list()).stream();
} 
```

**JUnit 5 动态测试**

[JUnit 5](http://junit.org/junit5/docs/current/user-guide/#writing-tests-dynamic-tests)还通过 a 的概念支持这一点，该概念通过静态方法`DynamicTest`在 a 中生成。`@TestFactory``dynamicTest`

```
import org.junit.jupiter.api.DynamicTest;
import org.junit.jupiter.api.TestFactory;
import static org.junit.jupiter.api.DynamicTest.dynamicTest;

import java.util.stream.Stream;

@TestFactory
public Stream<DynamicTest> testFiles() {
    return Arrays.asList(new File(".").list())
            .stream()
            .map((file) -> dynamicTest(
                    "Test for file: " + file,
                    () -> { /* Your test comes here */ }));
} 
```

在您的 IDE（此处为 IntelliJ）中运行的测试将显示如下：

[![IntelliJ 中的输出](https://i.stack.imgur.com/9dCJk.png)](https://i.stack.imgur.com/9dCJk.png)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-11T10:16:57.353

在 JUnit 3 中应该可以通过继承`TestSuite`和覆盖`tests()`列出文件的方法并为每个返回一个子类的实例，该实例`TestCase`将文件名作为构造函数参数并具有测试构造函数中给出的文件的测试方法。

在 JUnit 4 中它可能更容易。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-05-20T21:09:28.990

您可以考虑使用[JUnitParams library](https://github.com/Pragmatists/JUnitParams)，因此您将有更多（更清洁）选项：

```
@org.junit.runner.RunWith(junitparams.JUnitParamsRunner.class)
public class ParameterizedTest {

    @org.junit.Test
    @junitparams.Parameters(method = "data")
    public void test1(File file) throws Exception {  }

    @org.junit.Test
    @junitparams.Parameters(method = "data")
    public void test2(File file) throws Exception {  }

    public static File[] data() {
        return new File[] { new File("path1"), new File("path2") };
    }
} 
```

* * *

```
@org.junit.runner.RunWith(junitparams.JUnitParamsRunner.class)
public class ParameterizedTest {

    @org.junit.Test
    @junitparams.Parameters(value = { "path1", "path2" })
    public void test1(String path) throws Exception {
        File file = new File(path);
    }

    @org.junit.Test
    @junitparams.Parameters(value = { "path1", "path2" })
    public void test2(String path) throws Exception {
        File file = new File(path);
    }
} 
```

* * *

您可以在此处查看更多[使用示例](https://github.com/Pragmatists/JUnitParams/blob/master/src/test/java/junitparams/usage/Samples_of_Usage_Test.java)。

除了[关于 JUnitParams，为什么用它编写参数化测试更容易、更易读](https://github.com/Pragmatists/JUnitParams#about)：

> JUnitParams 项目为 JUnit 添加了一个新的运行器，并为 JUnit >=4.6 提供了更容易和可读的参数化测试。
> 
> 与标准 JUnit 参数化运行器的主要区别：
> 
> *   更明确 - 参数在测试方法参数中，而不是类字段
> *   更少的代码 - 你不需要构造函数来设置参数
> *   您可以在一个类中混合使用参数化方法和非参数化方法
> *   params 可以作为 CSV 字符串或从参数提供程序类传递
> *   参数提供者类可以有尽可能多的参数提供方法，以便您可以对不同的情况进行分组
> *   你可以有一个提供参数的测试方法（不再有外部类或静态）
> *   您可以在 IDE 中看到实际的参数值（在 JUnit 的参数化中，它只是连续的参数数量）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-07-17T02:44:10.937

如果 TestNG 是一个选项，您可以将[Parameters 与 DataProviders 一起](http://testng.org/doc/documentation-main.html#parameters-dataproviders)使用。

每个单独文件的测试都将在基于文本的报告或 Eclipse 的 TestNG 插件 UI 中显示其结果。运行的总测试数将单独计算每个文件。

此行为与 JUnit [Theories](https://github.com/junit-team/junit/wiki/Theories)不同，其中所有结果都集中在一个“理论”条目下，并且仅计为 1 个测试。如果您想在 JUnit 中单独报告结果，可以尝试[Parameterized Tests](https://github.com/junit-team/junit/wiki/Parameterized-tests)。

## 测试和输入

```
public class FileTest {

    @DataProvider(name="files")
    public File[][] getFiles(){
        return new File[][] {
            { new File("file1") },
            { new File("file2") }
        };
        // or scan a directory
    }

    @Test(dataProvider="files")
    public void testFile(File file){
        //run tests on file
    }
} 
```

## 示例输出

```
PASSED: testFile(file1)
PASSED: testFile(file2)

===============================================
    Default test
    Tests run: 2, Failures: 0, Skips: 0
=============================================== 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-04-08T19:04:29.767

我遇到了类似的问题，最后编写了一个简单的 JUnit 4 运行程序，允许 med 动态生成测试。

[https://github.com/kimble/junit-test-factory](https://github.com/kimble/junit-test-factory)

# asp.net - 在默认超时后更新 ASP.net 会话

> ID：358807
> 
> 赞同：1
> 
> 时间：2008-12-11T09:41:18.970
> 
> 标签：asp.net, session

如果会话超时超过默认的 20 分钟，我需要更新我的旧会话。ASP.net 中是否有任何会话更新概念？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-11T09:50:10.510

如果您在会话到期后续订会话，并且该会话到期时您将对其进行续订，那么您真正要做的就是根本不让它过期。

为什么不首先将会话时间延长到 20 分钟以上？是有条件的吗？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-11T09:53:41.423

不久前我遇到[了类似的问题](https://stackoverflow.com/questions/308893/forms-authentication-timing-out-when-it-shouldnt)，发现[这篇文章](http://www.codeproject.com/KB/session/Session_Defibrillator.aspx)很有帮助——至少在克服部分问题方面。

我还在除颤器页面中添加了以下行以防止缓存，它对我们来说很好用。

基本上它在即将到期之前执行一个不可见的回发（更新会话） - 我们实际上比这更早一点。

希望这会有所帮助，但如果你想看看，我可以挖掘出我使用的一些代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-11T09:46:49.207

一种方法是编写一个在某个时间间隔触发的 JS 函数。此函数将对服务器进行异步调用 (AJAX) 以保持会话处于活动状态。这样会话不会超时。这是我知道并看到使用的一种方式。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-11T09:50:35.627

并不真地。至少，不会过期。

我见过的最常见的是定期发送 Ajax“PING”请求。只是访问服务器并重新启动会话的超时计数。

杰夫不久前[写过这篇文章](http://www.codinghorror.com/blog/archives/001100.html)。

# .net - 带有标识增量字段的 Linq to sql 错误

> ID：358821
> 
> 赞同：5
> 
> 时间：2008-12-11T09:45:31.690
> 
> 标签：.net, sql, linq, auto-increment

我刚刚开始使用 linq to sql 并遇到了插入带有自动递增字段的记录的问题。

我创建了一个由 linq 定义的公司对象的新实例。它已将自动递增字段“companyID”初始化为 0。InsertOnSubmit() 失败并出现以下 invalidOperationException。

> 成员“companyID”的自动同步规范不正确

companyID 属性的列属性 IsDbGenerated 为 true。我正在使用 sql server 2000。

编辑：自动同步设置为 OnIsert。数据类型在 TSQL 中是 BigInt，在 c# 中是 long。

有谁知道为什么会发生此错误以及如何解决？

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-11T10:30:48.573

找到了答案。这与主键有关。在 linq 设计器中，主键已按应有的方式设置。在数据库中，相关字段未设置为主键。我修复了数据库中的键，这解决了问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-11T09:59:42.770

什么是数据类型？诠释？（在 TSQL 和 C# 中都是 int 吗？）

你有什么自动同步设置？对于主键，它应该是“OnInsert”

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-10-22T19:18:58.710

同样的问题。在 DB 中设置主键并将 AutoSync 属性更改为`"OnInsert"`DBML 有助于

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-11T09:59:12.427

该类/表上的“自动同步”属性的值是多少？

我刚刚检查了一下，它设置为“OnInsert”。此外，“自动生成的值”设置为 true。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-06-18T20:13:14.120

仅当您在数据库中插入值时才设置插入选项。如果您对数据库的安全选项没有任何问题，请始终在数据库中使用 Never 选项。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-11-06T14:03:17.753

如果可能，请删除您的数据库并重新创建。我的情况是当我忘记在表上添加主键时。然后在第一次插入数据库后，我得到了关于缺少主键的提示。我在 dbml 设计器中手动应用了它，但第一个 ID 已经被占用，导致“不正确的自动同步”异常。

# javascript - Javascript错误...我认为

> ID：358826
> 
> 赞同：1
> 
> 时间：2008-12-11T09:48:08.627
> 
> 标签：javascript, vbscript

我一直试图解决这个问题连续两个小时，我无法弄清楚。

```
onclick = "location='exceltest.asp?vanjaar=<%=vanjaar%>&vanmaand=<%=vanmaand%>&vandag=<%=vandag%>&totjaar=<%=totjaar%>&totmaand=<%=totmaand%>&totdag=<%=totdag%>'" 
```

那行代码位于 < input type="button" /> 属性中。该按钮链接到应触发 Excel 下载的页面。URL 中的值是起始日期和截止日期部分。（年月日）

这：

```
onclick = "location='exceltest.asp?fromdate=<%=fromdate%>&todate=<%=todate%>'" /> 
```

不起作用，因为 IE7 以某种方式读取日期（例如 2008/1/1）错误。我认为与斜线有关。

但是当我尝试单击 IE 中的按钮并下载生成的文件时，Internet Explorer 会尝试下载文件

> exceltest.asp?vanjaar=2008vanmaand=1vandag=1totjaar=2008totmaand=2totdag=1

而不是我想要的excel文件。
FF 提供下载 excelfile，但（在该 excelfile 中）提供了一个带有错误消息的 htmlpage 的概述，告诉我我的查询是错误的（在与请求的名称或序号相对应的集合中找不到项目。）但这不能是，我在其他地方使用完全相同的查询，使用相同的（但重新启动）连接。

这是我用来实例化文件下载的代码：

```
Response.Buffer = TRUE  
Response.ContentType = "application/vnd.ms-excel"  
Response.AddHeader "content-disposition", "attachment; filename=overicht.xls" 
```

这里可能确实发生了一些事情，但我最感兴趣的是为什么 IE 想要下载 asp 页面而 FF 提供了正确的下载。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-11T09:59:50.537

内部应该是 html 编码`&`的`onclick=""``&amp;`

如果 fromdate 包含斜杠，那么您也可能最安全地对其进行 url 编码（尽管您似乎与示例 URL 相矛盾）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-11T10:03:53.493

可能有帮助的东西：[`Server.URLEncode`](http://www.w3schools.com/asp/met_urlencode.asp)

```
fromdate=<%=Server.URLEncode(fromdate)%> 
```

但是，您的 Excel 文件错误 -**在与请求的名称或序号相对应的集合中找不到项目。**——来自**`Recordset.Fields()`**。您正在尝试获取一个不可用的字段——查询中没有的列名或超出列数的索引。

# visual-studio-2008 - 我无法将 VS2008 的服务添加到 Sharepoint 服务

> ID：358829
> 
> 赞同：0
> 
> 时间：2008-12-11T09:48:50.437
> 
> 标签：visual-studio-2008, sharepoint, service

当我尝试将 VS2008 上的服务添加到 Sharepoint 服务时，我无法添加

[http://tomasekweb.com/Test1/_vti_bin/Lists.asmx](http://tomasekweb.com/Test1/_vti_bin/Lists.asmx) 并点击 GO

需要用户名和密码，我输入了，但仍然需要。我不知道，我必须在 sharepoint 网站上设置什么。我在 Sharepoint 服务器上只有一个用户。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-11T10:05:06.580

我假设您已将服务器名称放在该 URL 中？

您应该将包含服务器名称的 Web 服务的完整路径放入其中，然后将其转换为动态 Web 服务，以便您可以在运行时适当地调整 URL（通过配置或在代码中）。

如果路径正确（且完整），则连接应该可以正常工作。

如果仍然无法正常工作，请考虑您是否通过代理连接到共享点实例。由于身份验证令牌只能进行一次网络跃点，Windows 身份验证无法通过代理工作……这被称为双跃点错误。这不是一个真正的错误，它是设计使然，旨在防止中间人攻击......所以不要使用代理。

# .net - 关于 powershell 脚本语言中的一致性，使用 .NET 类型

> ID：358834
> 
> 赞同：0
> 
> 时间：2008-12-11T09:50:54.690
> 
> 标签：.net, powershell, oop, types

如果我想在 powershell 中创建一个 .NET 对象，我会编写如下内容：

```
[System.Reflection.Assembly]::LoadWithPartialName("System.Xml") | out-null"
$doc = new-object -typename System.Xml.XmlDocument" 
```

如果我想调用静态 .Net 方法，我使用类似于以下行的命令：

```
$path = [System.String]::Format("{0} {1}", "Hello", "World") 
```

我看不出这背后的规律。如果它在第一个示例中有效，为什么我不能`System.String.Format`在第二个示例中使用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-12T02:25:47.210

当您在给定类上使用静态方法时，将使用方括号。当您实例化特定类的新对象时，您不需要括号。

括号还用于将变量转换为某种类型

```
PS C:\> $i = [int]"1"
PS C:\> $i.gettype().Name
Int32
PS C:\> $j = "1"
PS C:\> $j.gettype().Name
String
PS C:\> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-11T10:30:06.233

我相信您在这里混淆了类型和成员。

```
// type "Assembly" in the "System.Reflection" namespace
[System.Reflection.Assembly] 

// member method "LoadWithPartialName" of type "Assembly"
[System.Reflection.Assembly]::LoadWithPartialName 

// type "String" in the "System" namespace
[System.String] 

// member method "Format" of type "String"
[System.String]::Format 
```

它正在按应有的方式工作。你的困惑从何而来？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-11T14:07:18.027

是的，您提出问题的方式有点令人困惑。System.Xml.XmlDocument 和 System.String 被定义为类，因此您可以为每个类使用 new-object 来创建该特定类型的对象。

仅仅因为你有“foo.bar.joe”并不意味着你正在做与“abc.def”不同的事情。两者都是有效的类，只是碰巧它们具有不同的命名空间长度/定义。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-11T16:10:24.940

我明白了，我的问题可能有点令人困惑。

我要问的是：这种带括号和冒号的语法的原因是什么？为什么微软没有像在 C# 中那样定义它——一切都由点分隔？

当我看到以下行时，问题出现了（我实际上是想引起注意）：

```
$doc = new-object -typename "System.Xml.XmlDocument" 
```

显然，有时括号/冒号语法是不需要的，那么为什么它甚至存在呢？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-11T16:14:01.640

我猜 new-object 只是将它传递给 Activator，它需要一个以句点分隔的名称——powershell 实际上并不管理该部分。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-11T16:16:21.400

在线路的情况下：

```
$doc = new-object -typename "System.Xml.XmlDocument" 
```

不需要括号，因为参数 -typename 是字符串类型。从技术上讲，我们可以这样称呼它：

```
$doc = new-object -typename "TypeThatDoesntExsit" 
```

它会显示一个错误，因为它会尝试将类型动态解析为字符串。

# c# - GetProperties() 返回接口继承层次结构的所有属性

> ID：358835
> 
> 赞同：105
> 
> 时间：2008-12-11T09:51:00.057
> 
> 标签：c#, .net, reflection

假设以下假设的继承层次结构：

```
public interface IA
{
  int ID { get; set; }
}

public interface IB : IA
{
  string Name { get; set; }
} 
```

使用反射并进行以下调用：

```
typeof(IB).GetProperties(BindingFlags.Public | BindingFlags.Instance) 
```

只会产生 interface 的属性`IB`，即“ `Name`”。

如果我们要对以下代码进行类似的测试，

```
public abstract class A
{
  public int ID { get; set; }
}

public class B : A
{
  public string Name { get; set; }
} 
```

该调用将为“ ”和“ ”返回一个对象`typeof(B).GetProperties(BindingFlags.Public | BindingFlags.Instance)`数组。`PropertyInfo``ID``Name`

有没有一种简单的方法可以像第一个示例一样在接口的继承层次结构中找到所有属性？

* * *

## 回答 #1

> 赞同：114
> 
> 时间：2010-03-14T22:36:44.513

我已经将@Marc Gravel 的示例代码调整为一个有用的扩展方法，封装了类和接口。它还首先添加了接口属性，我认为这是预期的行为。

```
public static PropertyInfo[] GetPublicProperties(this Type type)
{
    if (type.IsInterface)
    {
        var propertyInfos = new List<PropertyInfo>();

        var considered = new List<Type>();
        var queue = new Queue<Type>();
        considered.Add(type);
        queue.Enqueue(type);
        while (queue.Count > 0)
        {
            var subType = queue.Dequeue();
            foreach (var subInterface in subType.GetInterfaces())
            {
                if (considered.Contains(subInterface)) continue;

                considered.Add(subInterface);
                queue.Enqueue(subInterface);
            }

            var typeProperties = subType.GetProperties(
                BindingFlags.FlattenHierarchy 
                | BindingFlags.Public 
                | BindingFlags.Instance);

            var newPropertyInfos = typeProperties
                .Where(x => !propertyInfos.Contains(x));

            propertyInfos.InsertRange(0, newPropertyInfos);
        }

        return propertyInfos.ToArray();
    }

    return type.GetProperties(BindingFlags.FlattenHierarchy
        | BindingFlags.Public | BindingFlags.Instance);
} 
```

* * *

## 回答 #2

> 赞同：94
> 
> 时间：2014-11-05T20:13:13.400

`Type.GetInterfaces`返回扁平的层次结构，因此不需要递归下降。

使用 LINQ 可以更简洁地编写整个方法：

```
public static IEnumerable<PropertyInfo> GetPublicProperties(this Type type)
{
    if (!type.IsInterface)
        return type.GetProperties();

    return (new Type[] { type })
           .Concat(type.GetInterfaces())
           .SelectMany(i => i.GetProperties());
} 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2008-12-11T10:02:35.057

接口层次结构很痛苦——它们并没有真正“继承”，因为你可以有多个“父母”（因为需要一个更好的术语）。

“扁平化”（再次，不是完全正确的术语）层次结构可能涉及检查接口实现的所有接口并从那里工作......

```
interface ILow { void Low();}
interface IFoo : ILow { void Foo();}
interface IBar { void Bar();}
interface ITest : IFoo, IBar { void Test();}

static class Program
{
    static void Main()
    {
        List<Type> considered = new List<Type>();
        Queue<Type> queue = new Queue<Type>();
        considered.Add(typeof(ITest));
        queue.Enqueue(typeof(ITest));
        while (queue.Count > 0)
        {
            Type type = queue.Dequeue();
            Console.WriteLine("Considering " + type.Name);
            foreach (Type tmp in type.GetInterfaces())
            {
                if (!considered.Contains(tmp))
                {
                    considered.Add(tmp);
                    queue.Enqueue(tmp);
                }
            }
            foreach (var member in type.GetMembers())
            {
                Console.WriteLine(member.Name);
            }
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-11T10:06:40.710

完全相同的问题具有[此处](http://web.archive.org/web/20100106143516/http://saftsack.fs.uni-bayreuth.de/~dun3/archives/weird-surprise-while-using-flattenhierarchy-on-interfaces/160.html)描述的解决方法。

顺便说一句，FlattenHierarchy 不起作用。（仅在静态变量上。在智能感知中这么说）

解决方法。谨防重复。

```
PropertyInfo[] pis = typeof(IB).GetProperties(BindingFlags.Public | BindingFlags.Instance);
Type[] tt = typeof(IB).GetInterfaces();
PropertyInfo[] pis2 = tt[0].GetProperties(BindingFlags.Public | BindingFlags.Instance); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-11-14T04:13:10.680

回应@douglas 和@user3524983，以下应该回答OP 的问题：

```
 static public IEnumerable<PropertyInfo> GetPropertiesAndInterfaceProperties(this Type type, BindingFlags bindingAttr = BindingFlags.Public | BindingFlags.Instance)
    {
        if (!type.IsInterface) {
            return type.GetProperties( bindingAttr);
        }

        return type.GetInterfaces().Union(new Type[] { type }).SelectMany(i => i.GetProperties(bindingAttr)).Distinct();
    } 
```

或者，对于单个财产：

```
 static public PropertyInfo GetPropertyOrInterfaceProperty(this Type type, string propertyName, BindingFlags bindingAttr = BindingFlags.Public|BindingFlags.Instance)
    {
        if (!type.IsInterface) {
            return type.GetProperty(propertyName, bindingAttr);
        }

        return type.GetInterfaces().Union(new Type[] { type }).Select(i => i.GetProperty( propertyName, bindingAttr)).Distinct().Where(propertyInfo => propertyInfo != null).Single();
    } 
```

好的，下次我会在发布之前而不是之后调试它:-)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-12-14T14:38:46.453

这在自定义 MVC 模型绑定器中对我来说非常有效且简洁。不过，应该能够推断出任何反射场景。仍然有点臭，它太过去了

```
 var props =  bindingContext.ModelType.GetProperties(BindingFlags.DeclaredOnly | BindingFlags.Public | BindingFlags.Instance).ToList();

    bindingContext.ModelType.GetInterfaces()
                      .ToList()
                      .ForEach(i => props.AddRange(i.GetProperties()));

    foreach (var property in props) 
```

# ms-access - Access Datasheet 视图在 WSS3.0 中显示为空白（字符显示为白色，因此不可见）

> ID：358838
> 
> 赞同：0
> 
> 时间：2008-12-11T09:53:58.380
> 
> 标签：ms-access, wss

Access Datasheet 视图在 WSS3.0 中显示为空白（字符显示为白色，因此不可见）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-11T14:55:49.303

这听起来像是您的 SharePoint 页面上的样式问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-12T09:25:36.847

我解决了这个问题，只需要更改页面属性并且它可以工作。现在数据表可见，其中的数据为黑色

# jsf - 使用 rich:dataTable 制作可扩展/可折叠子表的最佳方法

> ID：358840
> 
> 赞同：0
> 
> 时间：2008-12-11T09:55:26.927
> 
> 标签：jsf, jakarta-ee, richdatatable

我最近将一个应用程序从 JSF 1.1 移植到 JSF 1.2。在此过程中，我们删除了 tomahawk 并决定改用 Rich。

现在我需要一种方法来为表中的每一行制作一个可展开/可折叠的 detailViev。

我唯一能想到的就是这些方面的东西（改编自 docs.jboss.com 上的文档）：

```
<rich:dataTable value="#{capitalsBean.capitals}" var="capitals">
    <rich:column>
        ...
    </rich:column>
    <rich:subTable value="#{capitals.details}" var="detail" ajaxKeys="#{bean.ajaxSet}" binding="#{bean.subtable}" id="subtable" rendered="detail.detailOpened">
        <rich:column>
            ...
        </rich:column>
    </rich:subTable>
</rich:dataTable> 
```

我想这样的事情会奏效。问题是我要么必须向我使用的对象添加 getDetailOpened 和 setDetailOpened，要么将每个对象包装在提供这两种方法的另一个对象中。

任何人都知道更好的方法，或者应该如何完成？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-12T11:57:15.063

I've often added methods to my beans (or wrapper beans) which contain those properties as a way of working around JSF. It's not pretty but it works.

The only other option I can think of at the moment is to use a JavaScript function to toggle the state of the details view. That wouldn't be ideal for a number of reasons but it would save you having to keep state server-side.

# build - 哪种构建系统对跨平台驱动程序、库和 GUI 构建的支持最好？

> ID：358849
> 
> 赞同：3
> 
> 时间：2008-12-11T09:58:16.033
> 
> 标签：build, makefile, multiplatform

对于超过一百万行的多平台项目，构建系统的最佳选择是什么，该项目使用 GNU 和 Microsoft 工具链为所有主流操作系统生成驱动程序、库、命令行工具、GUI 和操作系统安装包？

我们的源代码主要是 C，带有 Python、C# 和 GNU makefile，以及一点 C++ 和 bash。它主要驻留在一个存储库中，但我们将源代码推送给各种第三方，这些第三方都有自己的源代码存储库。保持快速构建也有一些兴趣，这可能涉及拆分项目。

目前我们混合使用 GNU make、bash、python 和微软的 DDKBUILD。主要问题是我们在 make 之上维护了一组复杂的脚本，并且更愿意使用第三方（最好是开源）工具，而且 cygwin 在 Windows 上并没有被证明是健壮的（例如，fork 并不总是可能的） )，并且我们当前的构建系统不会构建或安装工具链，因此容易受到工具链版本更改的影响。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-10T15:15:16.717

我投票支持 CMake，它是一个真正从头开始重写 KDE4 构建系统的元构建工具——并使 KDE4 现在成为一个跨平台的桌面，甚至可以在 WindowsCE 上运行！

CMake 是将 KDE4 移植到地球上任何操作系统的载体——通过为大约 40 个具有相关工具链的操作系统生成 Makefile（或 Windows 中的 vcprojs）！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-11T10:22:39.667

JetBrains TeamCity 总体上运行良好，因此值得列入评估列表。

ThoughtWorks Cruise 也在同一空间。虽然它是 v1，但它来自一个已经存在了一段时间的马厩。

Team Foundation Server 没有什么可以让您根据您的情况将其计算在内，但开箱即用的它可能比我提到的其他两个更以 MS-shop 为中心。

作为一般评论，随着您拥有的多样性水平，您肯定想尝试任何您想要使用的东西 - 仅仅因为某些东西被支持作为盒子上的勾号并不意味着它会适合 oyu 正在寻找的东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-11T17:59:33.283

迪克森，

您的构建主要是单片的还是您想单独构建一些库并将它们组装到更大的应用程序中？如果项目间的依赖关系很重要，那么您的选择很快就会受到限制。[AnthillPro](http://www.anthillpro.com)做得很好，我认为[TeamCity](http://www.jetbrains.com/teamcity/)有一些 Ivy 集成支持。根据您的说法，这听起来不是绝对需要，但可能有助于加快构建速度。这当然是我们已经看到许多团队有效执行的策略。

由于您正在查看跨平台（我假设是多台机器）构建，因此排除了 Hudson 以外的大多数开源工具。

构建服务器比较矩阵由我们在 Thoughtworks 的朋友在这里托管：[confluence.public.thoughtworks.org/display/CC/CI+Feature+Matrix](http://confluence.public.thoughtworks.org/display/CC/CI+Feature+Matrix)

祝你好运。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-30T23:04:44.887

您应该将[CMake](http://cmake.org)列在要调查的替代方案列表中。CMake 是一个元工具，即它为您选择的构建工具（GNU make、Visual Studio 等）生成输入。我可以强烈推荐它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-03T14:22:52.790

你可能想看看[克鲁斯](http://studios.thoughtworks.com/cruise-continuous-integration)。它基于 Java 构建，因此可以在任何支持它的平台上运行。您还可以在不同的机器上拥有多个构建代理，它们可以在不同的平台上执行不同的任务。Thoughtworks 仍在构建它，因此缺少一些功能，但它可能是一个不错的选择，因为您正在寻找真正的跨平台功能。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-29T16:30:11.607

[SCons](http://www.scons.org/)是一个用 Python 实现的跨平台构建系统。我们使用它在三个平台上构建我们的代码。它可以自动检测您的构建工具，但您也可以将任意 Python 代码放入构建脚本中。它还允许您将环境设置与项目结构的描述分开，这是在不同环境中重用您的 buidl 脚本的一个很好的功能。除了直接构建项目外，它还可以生成 Visual Studio 项目文件。

# html - 如何在 HTML 工具提示中使用回车？

> ID：358874
> 
> 赞同：367
> 
> 时间：2008-12-11T10:11:55.273
> 
> 标签：html, title, tooltip

我目前正在向我们的网站添加详细的工具提示，并且我希望（不必求助于 jQuery 插件，我知道有很多！）使用回车来格式化工具提示。

要添加我正在使用该`title`属性的提示。我浏览了常见的网站并使用了以下基本模板：

```
<a title='Tool?Tip?On?New?Line'>link with tip</a> 
```

我尝试将其替换为`?`：

*   `<br />`
*   `&013; / &#13;`
*   `\r\n`
*   `Environment.NewLine`（我正在使用 C#）

以上都不起作用。是否可以？

* * *

## 回答 #1

> 赞同：337
> 
> 时间：2008-12-11T10:33:36.850

[最新](http://www.whatwg.org/specs/web-apps/current-work/multipage/dom.html#the-title-attribute)的规范允许换行符，所以属性或实体内的简单换行符`&#10;`（注意字符`#`和`;`是必需的）是可以的。

* * *

## 回答 #2

> 赞同：319
> 
> 时间：2008-12-11T10:24:34.450

它是如此简单，你会踢自己：只需按下`Enter`！

```
<a href="#" title='Tool
Tip
On
New
Line'>link with tip</a>
```

* * *

## 回答 #3

> 赞同：88
> 
> 时间：2008-12-11T10:15:46.123

试试第 10 个字符。但它在 Firefox 中不起作用。:(

> 文本以与浏览器相关的方式显示（如果有的话）。小工具提示适用于大多数浏览器。IE 和 Safari 中的长工具提示和换行工作（使用`&#10;`或`&#13;`用于新的换行符）。Firefox 和 Opera 不支持换行符。Firefox 不支持长工具提示。

[http://modp.com/wiki/htmltitletooltips](http://web.archive.org/web/20080919232812/http://modp.com/wiki/htmltitletooltips)

## 更新：

截至 2015 年 1 月，Firefox 确实支持在 HTML属性`&#13;`中插入换行符。`title`请参阅下面的代码段示例。

```
<a href="#" title="Line 1&#13;Line 2&#13;Line 3">Hover for multi-line title</a>
```

* * *

## 回答 #4

> 赞同：68
> 
> 时间：2012-11-27T13:34:19.933

在 IE、Chrome、Safari、Firefox（最新版本 2012-11-27）中对此进行了测试：
`&#13;`

适用于所有这些...

* * *

## 回答 #5

> 赞同：60
> 
> 时间：2012-11-03T01:15:41.373

另外值得一提的是，如果您使用 Javascript 设置 title 属性，如下所示：

`divElement.setAttribute("title", "Line one&#10;Line two");`

它行不通。您必须以 Javascript 转义的方式将该 ASCII 十进制 10 替换为 ASCII 十六进制 A。像这样：

`divElement.setAttribute("title", "Line one\x0ALine two");`

* * *

## 回答 #6

> 赞同：31
> 
> 时间：2012-04-25T15:53:43.383

从 Firefox 12 开始，它们现在支持使用换行 HTML 实体的换行符：`&#10;`

```
<span title="First line&#10;Second line">Test</span> 
```

这在 IE 中有效，并且根据 HTML5 规范的[title 属性](http://www.whatwg.org/specs/web-apps/current-work/#the-title-attribute)是正确的。

* * *

## 回答 #7

> 赞同：18
> 
> 时间：2012-10-18T14:54:25.970

如果您使用的是 jQuery：

```
$(td).attr("title", "One \n Two \n Three"); 
```

将工作。

在 IE-9 中测试：工作。

* * *

## 回答 #8

> 赞同：17
> 
> 时间：2020-01-08T22:36:23.477

在 Chrome 79 上，`&#13;`不再工作。

我成功了：

`&#13;&#10;`

这适用于所有主要浏览器。

* * *

## 回答 #9

> 赞同：16
> 
> 时间：2016-09-20T11:57:40.553

作为对解决方案的贡献，如果您需要做类似的事情`&#013;`，我们也可以使用标签。`&#009`

```
<button title="My to-do list:&#013;&#009;-Item 2&#013;&#009;-Item 3&#013;&#009;-Item 4&#013;&#009;&#009;-Subitem 1">TEST</button>
```

## 演示

[![在此处输入图像描述](https://i.stack.imgur.com/42xUv.png)](https://i.stack.imgur.com/42xUv.png)

* * *

## 回答 #10

> 赞同：11
> 
> 时间：2008-12-11T10:17:14.277

`&#13;`适用于所有专业浏览器（包括 IE）

* * *

## 回答 #11

> 赞同：8
> 
> 时间：2014-11-03T15:10:55.380

我知道我迟到了，但对于那些只想看到这个工作的人，这里有一个演示：http: **[//jsfiddle.net/rzea/vsp6840b/3/](http://jsfiddle.net/rzea/vsp6840b/3/)**

**使用的 HTML：**

```
<a href="#" title="First Line&#013;Second Line">Multiline Tooltip</a>
<br>
<br>
<a href="#" title="List:
  • List item here
  • Another list item here
  • Aaaand another list item, lol">Unordered list tooltip</a> 
```

* * *

## 回答 #12

> 赞同：7
> 
> 时间：2010-03-26T12:17:47.947

`&#xD;` <----- 这是插入进位返回所需的文本。

* * *

## 回答 #13

> 赞同：7
> 
> 时间：2016-09-23T10:07:29.320

我们有一个要求，我们需要测试所有这些，这就是我想分享的

```
document.getElementById("tooltip").setAttribute("title", "Tool\x0ATip\x0AOn\x0ANew\x0ALine")
```

```
<p title='Tool
Tip
On
New
Line'>Tooltip with <pre>
  new 
  line</pre> Works in all browsers</p>
<hr/>

<p title="Tool&#13;Tip&#13;On&#13;New&#13;Line">Tooltip with <code>&amp;#13;</code> Not works Firefox browsers</p>
<hr/>

<p title='Tool&#10;Tip&#10;On&#10;New&#10;Line'>Tooltip with <code>&amp;#10;</code> Works in some browsers</p>
<hr/>

<p title='Tool&#x0aTip&#x0aOn&#x0aNew&#x0aLine'>Tooltip with <code>&amp;#xD;</code> May work in some browsers</p>
<hr/>

<p id='tooltip'>Tooltip with <code>document.getElementById("tooltip").setAttribute("title", "Tool\x0ATip\x0AOn\x0ANew\x0ALine")</code> May work in some browsers</p>
<hr/>

<p title="List:
  • List item here
  • Another list item here
  • Aaaand another list item, lol">Tooltip with <code>• </code>Unordered list tooltip</p>
<hr/>

<p title='Tool\nTip\nOn\nNew\nLine'>Tooltip with <code>\n</code> May not work in modern browsers</p>
<hr/>

<p title='Tool\tTip\tOn\tNew\tLine'>Tooltip with <code>\t</code> May not work in modern browsers</p>
<hr/>

<p title='Tool&#013;Tip&#013;On&#013;New&#013;Line'>Tooltip with <code>&amp;#013;</code> Works in most browsers</p>
<hr/>
```

[小提琴](https://jsfiddle.net/xameeramir/mrya78a8/)

* * *

## 回答 #14

> 赞同：7
> 
> 时间：2018-04-17T10:42:03.447

`&#013;`如果您只使用简单的标题属性，这应该可以工作。

在引导弹出框上，只需在属性中使用`data-html="true"` 和使用 html 。`data-content`

```
<div title="Hello &#013;World">hover here</div>
```

* * *

## 回答 #15

> 赞同：6
> 
> 时间：2008-12-11T10:23:08.447

我不相信它是。无论如何，Firefox 2 会修剪长链接标题，它们实际上应该只用于传达少量的帮助文本。如果您需要更多解释文本，我建议它属于与链接相关的段落。然后，您可以添加工具提示 JavaScript 代码以隐藏这些段落并将它们显示为悬停时的工具提示。这是让它跨浏览器 IMO 工作的最佳选择。

* * *

## 回答 #16

> 赞同：6
> 
> 时间：2011-10-25T23:56:43.540

在 Chrome 16 以及可能的更早版本上，您可以使用“\n”。作为旁注，“\t”也适用

* * *

## 回答 #17

> 赞同：6
> 
> 时间：2016-07-04T13:23:26.267

至于谁`&#10;`没有工作，您必须将其中可见行的元素设置为：`white-space: pre-line;`

从此答案引用：[https ://stackoverflow.com/a/17172412/1460591](https://stackoverflow.com/a/17172412/1460591)

* * *

## 回答 #18

> 赞同：5
> 
> 时间：2014-03-27T10:02:07.667

**只需使用这个：**

```
<a title='Tool&#x0aTip&#x0aOn&#x0aNew&#x0aLine'>link with tip</a> 
```

您可以使用 this 在标题上添加新行`&#x0a`。

* * *

## 回答 #19

> 赞同：5
> 
> 时间：2016-06-20T16:58:45.083

只需使用 JavaScript。然后与大多数和较旧的浏览器兼容。使用转义序列 \n 换行。

```
 document.getElementById("ElementID").title = 'First Line text \n Second line text' 
```

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2011-08-06T21:32:43.277

从有关可访问性的可用信息和使用 CR 或换行符使它们变大的工具提示的使用受到赞赏，各种浏览器不能/不会就基本知识达成一致的事实表明它们不太关心可访问性。

* * *

## 回答 #21

> 赞同：3
> 
> 时间：2011-08-24T05:29:44.057

根据[w3c 网站上的这篇文章](http://www.w3.org/TR/html4/types.html#type-cdata)：

> CDATA 是来自文档字符集的字符序列，可能包括字符实体。用户代理应该如下解释属性值：
> 
> *   用字符替换字符实体，
> *   忽略换行，
> *   用一个空格替换每个回车符或制表符。

这意味着（至少）CR 和 LF 在 title 属性中不起作用。我建议您使用工具提示插件。这些插件中的大多数都允许将任意 HTML 显示为元素的工具提示。

* * *

## 回答 #22

> 赞同：3
> 
> 时间：2018-06-20T15:48:10.437

可以手动创建更好看的工具提示，并且可以包含 HTML 格式。

```
<!DOCTYPE html>
<html>
<style>
.tooltip {
    position: relative;
    display: inline-block;
    border-bottom: 1px dotted black;
}

.tooltip .tooltiptext {
    visibility: hidden;
    width: 120px;
    background-color: #555;
    color: #fff;
    text-align: center;
    border-radius: 6px;
    padding: 5px 0;
    position: absolute;
    z-index: 1;
    bottom: 125%;
    left: 50%;
    margin-left: -60px;
    opacity: 0;
    transition: opacity 0.3s;
}

.tooltip .tooltiptext::after {
    content: "";
    position: absolute;
    top: 100%;
    left: 50%;
    margin-left: -5px;
    border-width: 5px;
    border-style: solid;
    border-color: #555 transparent transparent transparent;
}

.tooltip:hover .tooltiptext {
    visibility: visible;
    opacity: 1;
}
</style>
<body style="text-align:center;">

<h2>Tooltip</h2>
<p>Move the mouse <a href="#" title="some text
more&#13;&#10;and then some">over</a> the text below:</p>

<div class="tooltip">Hover over me
<span class="tooltiptext">Tooltip text
some <b>more</b><br/>
<i>and</i> more</span>
</div>

<div class="tooltip">Each tooltip is independent
<span class="tooltiptext">Other tooltip text
some more<br/>
and more</span>
</div>

</body>
</html> 
```

这取自[w3schools](https://www.w3schools.com/howto/howto_css_tooltip.asp)关于此的帖子。[在这里试验上面的代码](https://www.w3schools.com/code/tryit.asp?filename=FSI3QJ91V4M2)。

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2017-07-14T12:50:16.010

**剃刀语法**

在 ASP.NET MVC 的情况下，您可以将标题存储为变量作为使用`\r\n`，它会工作。

```
@{ 
    var logTooltip = "Sunday\r\nMonday\r\netc.";
}

<h3 title="@logTooltip">Logs</h3> 
```

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2022-02-15T13:13:39.937

有多种方法可以做到这一点，`&#13`或者`&#010;`取决于浏览器。但以下示例适用于我的 chrome 和 firefox。

```
 <a href="javascript:;" title="Tooltip Line One &#10;Tooltip Line Two &#10;Tooltip Line Three">Tooltip</a>
```

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2017-04-28T19:01:06.887

破解但有效 - （在 chrome 和移动设备上测试）

只需在中断之前不添加中断空格 - 您可能必须根据内容量限制工具提示的大小，但对于小文本消息，这有效：

```
&nbsp;&nbsp; etc 
```

尝试了以上所有方法，这是唯一对我有用的方法-

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2019-11-06T06:09:32.110

我试过用“”在新行中显示标题文本，它的工作就像一个魅力

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2020-04-30T22:43:42.537

我在 Firefox 68.7.0esr 上并且`&#013;`不起作用。通过确实可以打破界限，`<CR>`所以我会这样做，因为它简单而前进。IE

```
<option title="Constraint PSC/SCS/Activity
Definition Constraint Checker
Database Start Notifier">CnCk 
```

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2021-03-19T01:31:19.880

“只需按 Enter” 解决方案在这里不起作用，所以好的旧 vanilla js 似乎是一种非常有效和干净的方式。

```
function customTitle(event, textHeader, text){
    let eventOrigin = event.target || event.srcElement;
    eventOrigin.title = textHeader + '\n\n' + text;
} 
```

在元素 onmouseover

```
onmouseover="customTitle(event, 'Some Caput', 'Some more or less complete description');" 
```

瞧！适用于chrome和firefox（不排除其他人，我只是没有检查过）。

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2021-12-06T09:55:13.920

如果您尝试在以以下格式呈现的 React 项目中执行此操作：

```
title={`First line of text ${varOne} &#13; Second line of text ${varTwo} &#13; Third line of text ${varThree}`} 
```

然后`&#13;`，`&#10;`类似的解决方案不起作用。它们实际上将呈现为文本。

相反，根据需要实际创建文本是更好的选择。一个更好理解的例子：

```
title={`First line of text ${varOne}
Second line of text ${varTwo}
Third line of text ${varThree}`} 
```

确保在 和 之前删除制表符/空格缩进`Second line of text`，`Third line of text`否则它们也会呈现。

在 Google Chrome 96 和 Firefox 95.0b12（开发版，因为，为什么不）上测试过。它也应该适用于大多数现代浏览器。

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2022-02-26T08:33:37.520

**在搜索在引导**工具提示中显示断线的解决方案时，我被定向到此页面。**Bootstrap**工具提示在`data-toggle="tooltip"`添加到 HTML 标记时会显示。最后，我发现`data-html="true"`应该将 a 添加到标签中，这样你的 HTML`title`就会被渲染。然后用于`<br>`断线。结帐样品如下：

**之前（不显示任何断线）：**

```
<i class="bi bi-x-circle" data-toggle="tooltip" data-placement="top" title="test1 <br> test2"></i> 
```

**之后（显示断线）：**

```
<i class="bi bi-x-circle" data-toggle="tooltip" data-html="true" data-placement="top" title="test1 <br> test2"></i> 
```

*- Laravel 和 Blade 程序员的提示：您可以转换`\n`为`<br>`with`nl2br("string")`函数。*

*- 上述解决方案已在 chrome 98 中进行了测试。*

* * *

## 回答 #31

> 赞同：-2
> 
> 时间：2018-09-05T12:03:21.513

使用`data-html="true"`和应用`<br>`。

# ruby-on-rails - Rails：从 JSON 数组重建 ActiveRecord 对象

> ID：358878
> 
> 赞同：0
> 
> 时间：2008-12-11T10:14:40.307
> 
> 标签：ruby-on-rails, activerecord

我有一个带有 ActiveRecord 对象的 JSON 数组。这些对象可以使用每个 AR 对象都有的 from_json 方法重建。但是使用 from_json 只能重建一个对象。

要处理一个数组，我当然可以从 JSON 数组中提取子字符串，然后在一个循环中从它自己的子字符串中创建每个对象。但是我想知道是否有更好的方法来做到这一点，而不涉及字符串操作。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-11T11:55:56.700

我会做

```
sudo gem install json 
```

之后只是

```
require "json" 
```

做

```
JSON.load(array_of_ar_json_representation) 
```

或者

```
JSON.parse(array_of_ar_json_representation) 
```

什么更适合你。

这两种方法都返回对应于 json 结构的 Ruby 数据结构。因此，如果您有一个 json 对象数组，在 JSON.load 或 JSON.parse 之后，您将获得 Ruby 哈希数组。操作这种结构应该没有任何问题。

# perl - 如何找到我的 Perl 脚本的模块依赖项？

> ID：358891
> 
> 赞同：30
> 
> 时间：2008-12-11T10:19:53.307
> 
> 标签：perl, dependencies, module, cpan

我希望另一个开发人员运行我编写的 Perl 脚本。该脚本使用许多 CPAN 模块，必须先安装这些模块才能运行该脚本。是否可以让脚本（或`perl`二进制文件）转储所有缺失模块的列表？当我尝试运行脚本时，Perl 会打印出丢失模块的名称，但这很冗长，并且不会一次列出所有丢失的模块。我想做类似的事情：

```
$ cpan -i `said-script --list-deps` 
```

甚至：

```
$ list-deps said-script > required-modules # on my machine
$ cpan -i `cat required-modules` # on his machine 
```

有没有简单的方法来做到这一点？这不是一个表演障碍，但我想让其他开发人员的生活更轻松。（所需的模块分散在几个文件中，因此我很难手动列出列表而不会遗漏任何内容。我知道[PAR](http://search.cpan.org/~smueller/PAR-0.983/lib/PAR.pm)，但对于我想要的来说似乎有点太复杂了。）

* * *

**更新：**谢谢，曼尼，这样就可以了。我不知道`%INC`，我只知道`@INC`。我解决了这样的问题：

```
print join("\n", map { s|/|::|g; s|\.pm$||; $_ } keys %INC); 
```

打印出来：

```
Moose::Meta::TypeConstraint::Registry
Moose::Meta::Role::Application::ToClass
Class::C3
List::Util
Imager::Color
… 
```

看起来这会奏效。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-12-11T15:19:55.027

查看[Module::ScanDeps](http://search.cpan.org/dist/Module-ScanDeps)和它附带的“scandeps.pl”实用程序。它可以在编译或运行程序后对您的代码进行依赖关系以及 %INC 转储的静态（和递归）分析。

请注意，静态源扫描总是在包含太多依赖项的情况下出错。（它是 PAR 使用的依赖扫描器，旨在使最终用户最容易使用。）

最后，您可以选择将脚本作为 CPAN 分发版分发。这听起来比实际上要复杂得多。您可以使用[Module::Starter](http://search.cpan.org/dist/Module-Starter)之类的东西来设置暂定 App::YourScript 分发的基本框架。将您的脚本放在 bin/ 子目录中并编辑 Makefile.PL 以引用您的所有*直接*依赖项。然后，对于分发，您执行以下操作：

1.  perl 生成文件.PL
2.  制作
3.  使分布

最后一步生成一个不错的 App-YourScript-VERSION.tar.gz 现在，当客户端想要安装所有依赖项时，他执行以下操作：

1.  正确设置 CPAN 客户端。只需运行它并回答问题。但无论如何，你已经需要了。
2.  “tar -xz App-YourScript-VERSION.tar.gz && cd App-YourScript-VERSION”
3.  运行“cpan”。

CPAN 客户端现在将自动安装所有直接依赖项和这些发行版的依赖项。根据您的设置方式，它会自动递归地遵循先决条件，或者每次都使用 ay/n 提示。

例如，您可以查看 CPAN 上的一些 App::* 发行版。我认为 App::Ack 是一个很好的例子。可能是我的 CPAN 目录 (SMUELLER) 中的 App::* 发行版之一。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2008-12-11T10:43:10.653

`%INC`您可以在脚本末尾转储。它将包含所有使用和必需的模块。但是，当然，这只有在您没有条件地需要模块时才有用（如果 $bar 则需要 Foo）。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2008-12-11T18:44:01.477

对于又快又脏、不经常使用的情况，这`%INC`是最好的方法。如果您必须通过持续集成测试或更健壮的东西来做到这一点，那么还有一些其他工具可以提供帮助。

Steffen 已经提到了 Module::ScanDeps。

[Test::Prereq](http://search.cpan.org/dist/Test-Prereq)中的代码执行此操作，但它有一个附加层，可确保您的 Makefile.PL 或 Build.PL 将它们列为依赖项。如果你让你的[脚本看起来像一个普通的 Perl 发行版](http://www.ddj.com/web-development/184416112)，那么检查新的依赖关系就变得相当容易；再次运行测试套件。

除此之外，您可能会使用诸如[Module::Extract::Use](http://search.cpan.org/dist/Module-Extract-Use)之类的工具，它会解析静态代码以查找 use 和 require 语句（尽管它不会在字符串 eval 中找到它们）。这让你得到你告诉你的脚本加载的模块。此外，一旦您知道加载了哪些模块，就可以将其与 David Cantrell 的[CPANdeps](http://cpandeps.cantrell.org.uk/)工具相结合，该工具已经为大多数 CPAN 模块创建了依赖关系树。

请注意，您还必须考虑可选功能。在这种情况下，您的代码我没有它们，但有时您在需要时才加载模块：

```
子富
    {
    需要酒吧；# 在我们需要使用之前不要加载
    ……
    }

```

如果您在试运行或测试中不使用该功能，您将不会看到该功能需要 Bar。当一个模块在不同的环境（例如，mod_perl 或 Windows 等）中加载一组不同的依赖模块时，也会出现类似的问题。

没有一种很好的自动化方式来测试这样的可选功能，以便您可以获取它们的依赖关系。但是，我认为这应该在我的待办事项列表中，因为这听起来是一个有趣的问题。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2011-05-05T14:11:16.270

[该领域的另一个工具是Perl::PrereqScanner](http://search.cpan.org/dist/Perl-PrereqScanner/)，它被 Dist::Zilla 及其 AutoPrereqs 插件使用。它安装了一个`scan-perl-prereqs`程序，该程序将使用 PPI 和一些插件来搜索大多数类型的 prereq 声明，使用您定义的最低版本。一般来说，我建议这种过度扫描`%INC`，这会带来虚假的需求并忽略版本。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-05-16T11:57:38.843

今天，我使用[Dist::Zilla](http://search.cpan.org/perldoc?Dist::Zilla)将我的 Perl 应用程序开发为[类似 CPAN 的发行版](https://stackoverflow.com/questions/1679835)，它可以通过[AutoPrereq](http://search.cpan.org/perldoc?Dist::Zilla::Plugin::AutoPrereq)插件处理依赖关系。这个领域另一个有趣的代码是[carton](http://search.cpan.org/perldoc?carton)。

# .net - 包含 using 语句的单元测试方法

> ID：358894
> 
> 赞同：5
> 
> 时间：2008-12-11T10:22:09.837
> 
> 标签：.net, unit-testing, dispose

我想知道单元测试和 using 语句是否真的可以齐头并进，因为没有办法模拟在 using 语句中实例化的一次性对象。我如何能够有效地对包含以下 using 语句的方法进行单元测试？

```
公共无效我的方法（）
{
   使用(MyDisposableClass disp = new MyDisposableClass())
   {
       ...
   }
}

```

当您进行单元测试时，是否完全禁止使用语句？

任何意见表示赞赏。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-11T10:28:15.893

不，当然不禁止使用语句。但是 MyDisposableClass 实际上做了什么？令我震惊的是，这实际上并不是 using 语句成为问题的问题-而是创建要模拟的新对象的方法问题-这*就是*问题所在。

你真的需要模拟 MyDisposableClass 吗？它可以传递给 MyMethod 而不是在其中创建吗？与以往一样，诀窍是弄清楚如何在需要时加入进程并注入自己的对象......

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-11T11:10:05.030

由于您想模拟资源类，我假设您已经拥有

```
interface IResource : IDisposable
{
        void DoSomething();
}

class DisposableResource : IResource
{
    public void Dispose()       {  Console.WriteLine("That's it. I'm outta here!");  }
    public void  DoSomething()  {  Console.WriteLine("Hard work this");  }
} 
```

为了能够注入 obj，您需要一个接缝.. 即 GetResource()

```
class MyClass
{
    protected virtual IResource GetResource()
    {
        return new DisposableResource();
    }
    public void MyMethod1()
    {
        using (IResource r = GetResource())
        {
            r.DoSomething();
        }
    }
} 
```

在您的测试代码中，只需子类化并覆盖 GetResource() 即可返回一个模拟。

```
class MySubClassForTest : MyClass
{
    protected override IResource GetResource()
    {
        return new MockResource();
    }
}
class MockResource : IResource    // or use a mock framework to create one
{
    public void  DoSomething()        { Console.WriteLine("Me work?"); }
    public void  Dispose()            { Console.WriteLine("Disposed Mock!"); }
} 
```

而已。

```
 MyClass obj = new MyClass();           // production code
 obj.MyMethod1();

 obj = new MySubClassForTest();         // test code
 obj.MyMethod1(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-11T10:42:37.690

使用[工厂模式](http://en.wikipedia.org/wiki/Factory_method_pattern)和/或[依赖注入模式](http://en.wikipedia.org/wiki/Dependency_injection)将大大简化您对实例化自己资源的方法进行单元测试的方式。

这是一个很好的阅读主题：

*   [单元测试、模拟和依赖注入](http://quickduck.com/blog/2008/02/18/unit-testing-mocking-and-dependency-injection/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-11T11:14:59.247

TypeMock 将允许你模拟它。它通过动态修改 IL 来工作，因此在模拟你无法模拟的东西时没有问题。

但即使使用 TypeMock，您仍然应该看看 Jon Skeet 和 Pop Catalin 上面所说的内容。如果您尝试减少依赖项的数量，您的代码将更易于维护。

# c# - 使用正则表达式删除字符

> ID：358912
> 
> 赞同：1
> 
> 时间：2008-12-11T10:28:28.530
> 
> 标签：c#, regex, string

我有一个字符串。我需要从这个原始字符串中替换给定字符串数组的所有实例 - 我该怎么做？

目前我正在使用...

```
var inputString = "this is my original string.";
var replacement = "";
var pattern = string.Join("|", arrayOfStringsToRemove);

Regex.Replace(inputString, pattern, replacement); 
```

这很好用，但不幸的是，当有人试图删除正则表达式中具有特殊含义的字符时，它会崩溃。

我该怎么做？有没有更好的办法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-11T10:50:48.593

使用 Regex.Escape 构建模式：

```
StringBuilder pattern = new StringBuilder();
foreach (string s in arrayOfStringsToRemove)
{
    pattern.Append("(");
    pattern.Append(Regex.Escape(s));
    pattern.Append(")|");
}
Regex.Replace(inputString, pattern.ToString(0, pattern.Length - 1), // remove trailing |
    replacement); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-11T10:39:03.237

看看[Regex.Escape](http://msdn.microsoft.com/en-us/library/system.text.regularexpressions.regex.escape.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-11T10:29:44.707

您需要使用反斜杠转义特殊字符

```
\ 
```

有时您可能需要使用两个反斜杠

```
\\ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-11T10:31:02.957

当然，您需要转义具有空间含义的字符。

```
var str_to_replace = "removing \[this\]\(link\)"; 
```

# database - 数据库模式 - 预订/可用性系统

> ID：358913
> 
> 赞同：9
> 
> 时间：2008-12-11T10:28:41.523
> 
> 标签：database, database-design, schema

最近有人问我一个关于假设的基于 Web 的预订系统的面试问题，以及我将如何设计数据库模式以最大限度地减少重复并最大限度地提高灵活性。

用例是管理员将属性的可用性输入系统。可以设置多个时间段。例如，2009 年 4 月 1 日至 2009 年 4 月 14 日和 2009 年 7 月 3 日至 2009 年 7 月 21 日。

然后，用户只能在相等或更短的可用时段内进行预订。

您将如何将这些信息存储在数据库中？

你会使用简单（真正简化）的东西吗？

```
AVAILABILITY(property_id, start_date, end_date);
BOOKING(property_id, start_date, end_date); 
```

然后，您能否轻松地构建一个网页，显示一个可用日历，其中包含已预订的时段。从这个数据库模式构建报告会很容易吗？是否像看起来那么容易？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-12-11T14:38:06.747

对于可用性和预订，使用单个表可能更容易，粒度为 1 天：

```
property_date (property_id, date, status); 
```

列状态将（至少）具有以下两个值：

*   可用的
*   已预订

输入可用时间段，例如 4 月 1 日至 14 日，将需要（应用程序）在 property_date 中插入 14 行，每行的状态为“可用”。（对用户来说，它应该是一个单一的动作）。

在 4 月 3 日至 11 日期间预订该物业需要检查每天是否存在“可用”行，并将状态更改为“已预订”。

这个模型可能看起来有点“冗长”，但它有一些优点：

1.  检查任何日期的可用性很容易
2.  添加预订会自动更新可用性，没有单独的可用性表来保持同步。
3.  在网页中显示可用性将非常简单
4.  添加新状态以记录不同类型的不可用性很容易 - 例如，为维护而关闭。

NB 如果“可用”是属性的最常见状态，最好颠倒逻辑，以便出现“不可用”状态，并且日期没有行意味着它可用。

# sharepoint - 如何使用 C# 在 SharePoint 中创建任务

> ID：358924
> 
> 赞同：0
> 
> 时间：2008-12-11T10:31:38.163
> 
> 标签：sharepoint, task

我需要使用 c# 在 SharePoint 任务列表中创建任务。

我可以像这样使用 SharePoint API`SPList.Items.Add()`吗？创建后我不会监视任务更改。或者我应该考虑使用 Outlook API 吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-11T10:35:47.533

你第一次就做对了。

使用 SharePoint 对象模型。它非常容易使用并且相当直观。您唯一需要注意的是填充字段（首先检查它们是否存在，因为 SharePoint 是可自定义的，并且有人可以删除或重命名字段），并且当您创建 SPWeb 和 SPSite 对象时，请务必使用 dispose()他们之后。

# sql - 很奇怪的 SQL 更新问题

> ID：358927
> 
> 赞同：1
> 
> 时间：2008-12-11T10:32:30.330
> 
> 标签：sql, sql-update

我有一个名为 ApprovalTask​​s 的表... Approvals 有一个状态列

我还有一个名为 ApprovalsView 的视图

当我尝试直接更新时：

```
update ApprovalTasks set Status = 2 where ApprovalTaskID = 48 
```

我收到此错误消息：

```
Msg 2601, Level 14, State 1, Line 1
Cannot insert duplicate key row in object 'dbo.ApprovalsView' with unique index 'IX_ApprovalTaskID'.
The statement has been terminated. 
```

知道为什么会这样吗？

这是创建表脚本：

```
USE [CSPMOSSApplication]
GO
/****** Object:  Table [dbo].[ApprovalTasks]    Script Date: 12/11/2008 12:41:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[ApprovalTasks](
    [ApprovalTaskID] [int] IDENTITY(1,1) NOT NULL,
    [ApproverID] [int] NOT NULL,
    [DueDate] [datetime] NULL,
    [Status] [smallint] NOT NULL,
    [ApprovedRejectedDate] [datetime] NULL,
    [Reason] [nvarchar](1024) COLLATE Finnish_Swedish_CI_AS NULL,
    [OrganizationID] [int] NOT NULL,
    [TicketID] [int] NOT NULL,
    [Link] [nchar](255) COLLATE Finnish_Swedish_CI_AS NULL,
    [GlobalApproverID] [int] NULL,
 CONSTRAINT [PK_Approval_Tasks] PRIMARY KEY CLUSTERED 
(
    [ApprovalTaskID] ASC
)WITH (IGNORE_DUP_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]

GO
USE [CSPMOSSApplication]
GO
ALTER TABLE [dbo].[ApprovalTasks]  WITH NOCHECK ADD  CONSTRAINT [FK_Approval_Tasks_ApprovalTaskStatuses] FOREIGN KEY([Status])
REFERENCES [dbo].[ApprovalTaskStatuses] ([ApprovalTaskStatusID])
GO
ALTER TABLE [dbo].[ApprovalTasks] CHECK CONSTRAINT [FK_Approval_Tasks_ApprovalTaskStatuses]
GO
ALTER TABLE [dbo].[ApprovalTasks]  WITH NOCHECK ADD  CONSTRAINT [FK_Approval_Tasks_Organizations] FOREIGN KEY([OrganizationID])
REFERENCES [dbo].[Organizations] ([OrganizationID])
GO
ALTER TABLE [dbo].[ApprovalTasks] CHECK CONSTRAINT [FK_Approval_Tasks_Organizations]
GO
ALTER TABLE [dbo].[ApprovalTasks]  WITH NOCHECK ADD  CONSTRAINT [FK_Approval_Tasks_Tickets] FOREIGN KEY([TicketID])
REFERENCES [dbo].[Tickets] ([TicketID])
GO
ALTER TABLE [dbo].[ApprovalTasks] CHECK CONSTRAINT [FK_Approval_Tasks_Tickets]
GO
ALTER TABLE [dbo].[ApprovalTasks]  WITH NOCHECK ADD  CONSTRAINT [FK_Approval_Tasks_Users] FOREIGN KEY([ApproverID])
REFERENCES [dbo].[Users] ([UserID])
GO
ALTER TABLE [dbo].[ApprovalTasks] CHECK CONSTRAINT [FK_Approval_Tasks_Users] 
```

PK_Approval_Tasks（集群）

```
USE [CSPMOSSApplication]
GO
/****** Object:  Index [PK_Approval_Tasks]    Script Date: 12/11/2008 12:45:50 ******/
ALTER TABLE [dbo].[ApprovalTasks] ADD  CONSTRAINT [PK_Approval_Tasks] PRIMARY KEY CLUSTERED 
(
    [ApprovalTaskID] ASC
)WITH (SORT_IN_TEMPDB = OFF, IGNORE_DUP_KEY = OFF, ONLINE = OFF) ON [PRIMARY] 
```

IX_ApprovalTask​​ID（集群）

```
SE [CSPMOSSApplication]
GO
SET ARITHABORT ON
GO
SET CONCAT_NULL_YIELDS_NULL ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_NULLS ON
GO
SET ANSI_PADDING ON
GO
SET ANSI_WARNINGS ON
GO
SET NUMERIC_ROUNDABORT OFF
GO
/****** Object:  Index [IX_ApprovalTaskID]    Script Date: 12/11/2008 12:47:27 ******/
CREATE UNIQUE CLUSTERED INDEX [IX_ApprovalTaskID] ON [dbo].[ApprovalsView] 
(
    [ApprovalTaskID] ASC
)WITH (SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, IGNORE_DUP_KEY = OFF, ONLINE = OFF) ON [PRIMARY] 
```

创建视图脚本

```
USE [CSPMOSSApplication]
GO
-- =============================================
-- Script Template
-- =============================================

-- [ApprovalTasks]: add columns Link, GlobalApproverID
IF NOT EXISTS(SELECT 1 FROM sysobjects,syscolumns WHERE sysobjects.id = syscolumns.id 
AND sysobjects.name = 'ApprovalTasks' AND syscolumns.name = 'Link')
BEGIN
    ALTER TABLE ApprovalTasks ADD [Link] [nchar] (255) COLLATE Finnish_Swedish_CI_AS NULL
    PRINT 'Column ApprovalTasks.Link was added.'
END
IF NOT EXISTS(SELECT 1 FROM sysobjects,syscolumns WHERE sysobjects.id = syscolumns.id 
AND sysobjects.name = 'ApprovalTasks' AND syscolumns.name = 'GlobalApproverID')
BEGIN
    ALTER TABLE ApprovalTasks ADD [GlobalApproverID] [int] NULL
    PRINT 'Column ApprovalTasks.GlobalApproverID was added.'

    ALTER TABLE [dbo].[ApprovalTasks]  WITH NOCHECK ADD  CONSTRAINT [FK_Approval_Tasks_GlobalApproverID] FOREIGN KEY([GlobalApproverID])
    REFERENCES [dbo].[Users] ([UserID])

    ALTER TABLE [dbo].[ApprovalTasks] CHECK CONSTRAINT [FK_Approval_Tasks_GlobalApproverID]
END

-- [ApprovalsView]
IF EXISTS (SELECT * FROM sys.fulltext_indexes fti WHERE fti.object_id = OBJECT_ID(N'[dbo].[ApprovalsView]'))
BEGIN
    DROP FULLTEXT INDEX ON [dbo].[ApprovalsView]
    PRINT 'FULLTEXT INDEX on [ApprovalsView] was dropped.'
END
GO

IF EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[ApprovalsView]') AND name = N'IX_ApprovalTaskID')
BEGIN
    DROP INDEX IX_ApprovalTaskID ON [dbo].[ApprovalsView] WITH ( ONLINE = OFF )
    PRINT 'INDEX IX_ApprovalTaskID was dropped.'
END
GO

IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[ApprovalsView]'))
DROP VIEW [dbo].[ApprovalsView]

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE VIEW [dbo].[ApprovalsView]
WITH SCHEMABINDING 
AS
SELECT      at.ApprovalTaskID, 
            at.ApproverID, 
            at.DueDate, 
            at.Status,  
            ats.ApprovalTaskStatusTranslationKey AS StatusText, 
            at.ApprovedRejectedDate, 
            at.Reason, 
            at.OrganizationID,
            ord.Name AS OrderName, 
            ord.TotalPrice, 
            ord.SubmitDate, 
            ord.OrdererID,
            usr.FirstName AS OrdererFirstName, 
            usr.LastName AS OrdererLastName,
            ordi.Items_Name AS ItemName,
            ordi.Items_Description AS ItemDescription,
            ordi.OtherInformation AS ItemInformation,
            oir.RecipientFullName,
            CONVERT(nvarchar(250), oir.DeliveryAddress) As DeliveryAddress,
            ti.Description

FROM        dbo.ApprovalTasks at
    INNER JOIN 
        dbo.ApprovalTaskStatuses ats ON ats.ApprovalTaskStatusID = at.Status
    INNER JOIN
        dbo.Orders_Items_Recipients oir ON oir.TicketID = at.TicketID
    INNER JOIN
        dbo.Orders_Items ordi ON ordi.Orders_ItemsID = oir.Orders_ItemsID
    INNER JOIN
        dbo.Orders ord ON ordi.OrderID = ord.OrderID 
    INNER JOIN
        dbo.Users usr ON ord.OrdererID = usr.UserID
    INNER JOIN
        dbo.Tickets ti ON ti.TicketID = at.TicketID
GO

CREATE UNIQUE CLUSTERED INDEX [IX_ApprovalTaskID] ON [dbo].[ApprovalsView] 
(
    [ApprovalTaskID] ASC
)WITH (IGNORE_DUP_KEY = OFF) ON [PRIMARY]
GO

CREATE FULLTEXT INDEX ON [dbo].[ApprovalsView](
[DeliveryAddress] LANGUAGE [Neutral], 
[ItemDescription] LANGUAGE [Neutral], 
[ItemInformation] LANGUAGE [Neutral], 
[ItemName] LANGUAGE [Neutral], 
[OrdererFirstName] LANGUAGE [Neutral], 
[OrdererLastName] LANGUAGE [Neutral], 
[OrderName] LANGUAGE [Neutral], 
[Reason] LANGUAGE [Neutral], 
[RecipientFullName] LANGUAGE [Neutral])
KEY INDEX [IX_ApprovalTaskID] ON [ApprovalSearchCatalog]
WITH CHANGE_TRACKING AUTO
GO

ALTER FULLTEXT CATALOG [ApprovalSearchCatalog] rebuild

PRINT 'Catalog [ApprovalSearchCatalog] task to rebuild fulltext index was sent.'

-- STORED PROCEDURES

IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ReceiveApprovalTasksFromQueue]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[ReceiveApprovalTasksFromQueue]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
EXEC dbo.sp_executesql @statement = N'
-- =============================================
-- Author:      Petr Klozik
-- Create date: 19.11.2008
-- Description: Gets approvals which DueDate is over ReferenceDate (now)
-- =============================================
CREATE Procedure [dbo].[ReceiveApprovalTasksFromQueue] 
    @Limit int
As
BEGIN

    SET NOCOUNT ON;

    If Not @Limit Is Null Set RowCount @Limit

    -- Status: WaitingForApproval = 1
    Select Tasks.ApprovalTaskID
    From ApprovalTasks Tasks
    Where Status = 1 And DueDate < GetDate()

END
' 
GO
GRANT EXECUTE ON [dbo].[ReceiveApprovalTasksFromQueue] TO [OMT_IntegrationRole]
GO
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[UpdateApprovalTaskInfo]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[UpdateApprovalTaskInfo]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
EXEC dbo.sp_executesql @statement = N'
-- =============================================
-- Author:      Klozik Petr
-- Create date: 2008-11-25
-- Description: Updates Approval task info to DB
-- =============================================
CREATE PROCEDURE [dbo].[UpdateApprovalTaskInfo] 
    @ApprovalTaskID int, 
    @DueDate datetime,
    @ApprovalRejectDate datetime,
    @Reason nvarchar(1024),
    @Status int,
    @GlobalApproverID int
AS
BEGIN
    SET NOCOUNT ON;

    Update ApprovalTasks
        Set DueDate = @DueDate,
        ApprovedRejectedDate = @ApprovalRejectDate, 
        Reason = @Reason,
        Status = @Status,
        GlobalApproverID = @GlobalApproverID
        Where ApprovalTaskID = @ApprovalTaskID
END

' 
GO
GRANT EXECUTE ON [dbo].[UpdateApprovalTaskInfo] TO [OMT_IntegrationRole]
GO
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[GetUserById]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[GetUserById]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
EXEC dbo.sp_executesql @statement = N'
-- =============================================
-- Author:      Klozik Petr
-- Create date: 2008-12-04
-- Description: Gets user row by the specified ID.
-- =============================================

CREATE PROCEDURE [dbo].[GetUserById]
(
    @UserID int
)

AS
BEGIN
    SELECT
        UserID,
        RTRIM(SID) [SID],
        RTRIM(OMTGUID) [OMTGUID],
        RTRIM(UserAccount) [UserAccount],
        RTRIM(Email) [Email],
        RTRIM(FirstName) [FirstName],
        RTRIM(LastName) [LastName],
        RTRIM(Country) [Country],
        RTRIM(City) [City],
        RTRIM(PostalNumber) [PostalNumber],
        RTRIM(StreetAddress) [StreetAddress],
        RTRIM(PhoneNumber) PhoneNumber,
        Modified, 
        Deleted,
        Uploaded,
        UploadCode, 
        UploadStatus, 
        RTRIM(Users.ADUserAccount) AS ADUserAccount
    FROM 
        [dbo].[Users]
    WHERE 
        UserID = @UserID
END
' 
GO
GRANT EXECUTE ON [dbo].[GetUserById] TO [OMT_IntegrationRole]
GO
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[GetApprovalTaskInfoById]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[GetApprovalTaskInfoById]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
EXEC dbo.sp_executesql @statement = N'

-- =============================================
-- Author:      Petr Klozik
-- Create date: 19.11.2008
-- Description: Gets approvals which DueDate is over ReferenceDate (now)
-- =============================================
CREATE Procedure [dbo].[GetApprovalTaskInfoById] 
    @ApprovalTaskID int
As
BEGIN

    SET NOCOUNT ON;

    Declare @OrganizationID int
    Declare @CurrentApproverID int
    Declare @NewApproverID int
    Declare @NewOrganizationID int

    Select @OrganizationID = OrganizationID, @CurrentApproverID = ApproverID 
        From ApprovalTasks 
        Where ApprovalTaskID = @ApprovalTaskID

    Set @NewApproverID = (
            Select Top 1 o.GlobalApproverID
            From Organizations o
                Inner Join OrganizationDescendants od On od.OrganizationID = o.OrganizationID
            Where od.DescendantID = @OrganizationID
                And Not(o.GlobalApproverID Is Null)
            Order By o.OrganizationLevel Desc
        )

    If Not(@NewApproverID Is Null) 
    Begin
        Set @NewOrganizationID = (
            Select OrganizationID 
                from Organizations 
                Where GlobalApproverID = @NewApproverID)
    End

    Select Tasks.*, Tickets.Description AS TicketDescription, 
        Tickets.RequestorID, Tickets.OrdererID,
        @NewApproverID AS OrgGlobalApproverID, 
        @NewOrganizationID AS OrgGlobalApproverOrganizationID
    From ApprovalTasks Tasks
    inner join Tickets Tickets on Tasks.TicketID = Tickets.TicketID
    Where ApprovalTaskID = @ApprovalTaskID

END
' 
GO
GRANT EXECUTE ON [dbo].[GetApprovalTaskInfoById] TO [OMT_IntegrationRole]
GO 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-11T10:52:05.020

幸运的猜测：定义了任何更新触发器？

第二个幸运的猜测：ApprovalsView 是一个[索引视图](http://www.microsoft.com/technet/prodtechnol/sql/2005/impprfiv.mspx)，它的索引在更新 ApprovalTask​​ 表后被违反。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-11T10:44:43.677

查看索引 IX_ApprovalTask​​ID 的定义 ApprovalTask​​ID, StatusID 是否可能存在唯一键约束，这意味着表中有另一行 Status = 2 & ApprovalTask​​ID = 48

我同意用户学习，看起来 ApprovalTask​​s 上有一个 FOR UPDATE 触发器，它将 ApprovalTask​​ID 插入 ApprovalView

尝试运行`DISABLE TRIGGER ALL ON ApprovalTasks`并重新运行更新

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-11T11:04:07.477

由于错误来自对象 dbo.ApprovalsView ，因此问题在于 ApprovalsTask 上的触发器试图更新该表。我真的认为 ApprovalsView 是一个表而不是一个视图。但你必须已经检查过了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-11T10:58:49.763

看起来已经创建了一个视图，该视图属于或包含您正在更新的表，并且在使用更改更新视图时发生错误。

也许视图包含来自不兼容的不同表的数据，或者具有更严格的约束集？

# asp.net - ASP.NET 中的 Mozilla Firefox 和 Internet Explorer 兼容剪贴板

> ID：358931
> 
> 赞同：1
> 
> 时间：2008-12-11T10:34:11.280
> 
> 标签：asp.net, internet-explorer, firefox, clipboard

我需要使用 ASP.NET 将文本从文本框中复制到剪贴板。我想要一个与 Mozilla Firefox 和 IE 相媲美的代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-11T10:41:36.383

Internet Explorer 剪贴板副本很简单：

```
// set the clipboard
var x = 'Whatever you want on the clipboard';
window.clipboardData.setData('Text',x);

// get the clipboard data
window.clipboardData.getData('Text'); 
```

Firefox，一点也不小。除非您已签署脚本等，否则实际上不可能使用纯 JS。但是，有一种使用 Flash 对象的解决方法。[在这里](http://www.jeffothy.com/weblog/clipboard-copy/)阅读

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-11T11:06:49.670

对于非 IE 浏览器，请使用这个世界通用的脚本。谷歌搜索“_clipboard.swf”文件。（不过，出于安全原因，此代码不适用于最新的 Flash 10）

var flashcopier = 'flashcopier';

```
 if(!document.getElementById(flashcopier)) {
        var divholder = document.createElement('div');
        divholder.id = flashcopier;
        document.body.appendChild(divholder);
     }

     document.getElementById(flashcopier).innerHTML = '';
     var divinfo = '<embed src="_clipboard.swf" FlashVars="clipboard='+encodeURIComponent('YOUR_VALUE_FOR_CLIPBOARD')+'" width="0" height="0" type="application/x-shockwave-flash"></embed>';
     document.getElementById(flashcopier).innerHTML = divinfo; 
```

# php - PHP脚本不返回数据库行

> ID：358934
> 
> 赞同：0
> 
> 时间：2008-12-11T10:35:35.333
> 
> 标签：php

```
include("conn.php");
$result = mysql_query("SELECT * FROM sggame");

while($row = mysql_fetch_assoc($result));
{
    $id = $row['id'];
    echo $id;
    echo 'working?';
} 
```

上面的代码根本不会从数据库中返回任何内容。行名正确，循环运行，说明数据库中有东西。但是，该行根本没有回显。这是我之前使用过一千次的代码，我很困惑为什么它现在停止了！任何帮助，一如既往，非常感谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-11T10:37:15.673

代替

```
while($row = mysql_fetch_assoc($result)); 
```

和

```
while($row = mysql_fetch_assoc($result)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-11T10:51:53.973

当您在哪里运行此代码时，它是否发出通知或警告？我只是好奇问题出在分号上。

# php - Unicode编程问题，php输出原始代码

> ID：358942
> 
> 赞同：0
> 
> 时间：2008-12-11T10:37:15.313
> 
> 标签：php, mysql, unicode

我有一个 mysql 数据库设置为 utf-8，csv 数据设置为 utf-8，用分号分隔并用双引号括起来。

从数据库进行直接转储时，数据似乎导入得很好。但是，当尝试通过在 PHP 中回显来显示包含 html 的字段之一时，会显示部分 html 代码而不是链接文本。Firefox 将页面视为 utf-8，所以这不是问题。

这是包含我要输出的 html 字段的记录的直接转储。似乎 html 可能没有正确完成。

```
ARTICLE_NO  ARTICLE_NAME    SUBTITLE    CURRENT_BID START_PRICE BID_COUNT   QUANT_TOTAL QUANT_SOLD  ACCESSSTARTS    ACCESSENDS  ACCESSORIGIN_END    USERNAME    BEST_BIDDER_ID  FINISHED    WATCH   BUYITNOW_PRICE  PIC_URL PRIVATE_AUCTION AUCTION_TYPE    ACCESSINSERT_DATE   ACCESSUPDATE_DATE   CATEGORY    CATPATH ARTICLE_DESC    COUNTRYCODE LOCATION    CONDITIONS  REVISED PAYPAL_ACCEPT   PRE_TERMINATED  SHIPPING_TO FEE_INSERTION   FEE_FINAL   FEE_LISTING PIC_XXL PIC_DIASHOW PIC_COUNT   ITEM_SITE_ID    STARTS  ENDS    ORIGIN_END
220288560247    Ed Hardy Herren Shirt Rock & Roll Weiss XXL Neu & OVP       0.00    49.00   0   1   0   1.10.2008 16:22:09  6.10.2008 16:22:09  6.10.2008 16:22:09  fashionticker1  0   1   0   59.00   http://storage.supremeauction.com/flash/ebay2/10/49/76/10497654/13895964e.jpg   0   1   6.10.2008 16:21:47  6.10.2008 16:28:31  32315   0   <!-- +++++++++++++++++++++++++ Bitte ÃƒÂ¤ndern Sie im eigenen Interesse nichts an diesem Code! ++++++++++++++++++++++++ -->\n<!-- +++++++++++++++++++++++++ Das kann massive Feggggggghldarstellungen ihrer Auktion zur Folge haben! +++++++++++++++++++ -->\n<!-- +++++++++++++++++++++++++ ++++++++++++++++++++++++++ Ihr Supreme Team +++++++++++++++++++++++++++++++++++++++++ -->\n\t\n<br>\n<br>\n<style type="text/css">\n<!--\n#doc {\n height: 577px;\n width: 989px;\n position: relative;\n top: 10px;\n left: 0px;\n background-color: #ffffff;\n border: 1px solid #CCCCCC;\n z-index:1;\n margin: 0px;\n padding: 0px;\n clear: none;\n float: none;\n}\n#doc2 {\n line-height: 30px;\n width: 989px;\n position: relative;\n top: 10px;\n left: 20px;\n background-color: #ffffff;\n margin: 0px;\n padding: 0px;\n clear: none;\n float: none;\n font-family: Arial, Helvetica, sans-serif;\n text-align: left;\n font-size: 11px;\n}\n#flash:before {\n height: 575px;\n width: 987px;\n position: relative;\n top: -273px;\n left: 0px;\n z-index: 3;\n visibility: visible;\n margin: 0px;\n padding: 0px;\n clear: none;\n float: none;\n}\n#flash{\n height: 575px;\n width: 987px;\n position: absolute;\n top: 0px;\n left: 0px;\n z-index: 3;\n visibility: visible;\n margin: 0px;\n padding: 0px;\n clear: none;\n float: none;\n}\n#pannel{\n float: left;\n height: 360px;\n width: 687px;\n background-image: url(http://storage.supremeauction.com/flash/html/pic/panel2.jpg);\n background-repeat: no-repeat;\n padding: 0px;\n position: relative;\n top: 80px;\n left: 150px;\n}\n#imageholder {\n float: left;\n height: 200px;\n width: 232px;\n padding: 0px;\n margin: 0px;\n background-color: #CCCCCC;\n position: relative;\n top: 4px;\n left: 29px;\n}\n#textfield {\n\tfloat: right;\n\tmargin: 0px;\n\tposition: relative;\n\ttop: 4px;\n\tright: 44px;\n\tpadding:5px; \n\toverflow:hidden;\n\theight: 256px;\n\twidth: 356px;\n\tborder: 1px solid #CCCCCC;\n\tfont-family: Arial, Helvetica, sans-serif;\n\tfont-size: 12px;\n\tcolor: #333333;\n}\n#headline{\n float: left;\n height: 40px;\n width: 610px;\n position: relative;\n top:  20px;\n left: 30px;\n font-family: Arial, Helvetica, sans-serif;\n font-size: 12pt;\n font-weight: bolder;\n color: #B50000;\n}\n\n#wrapper {\n\twidth: 100%;\n \n.clear {\n clear:both;\n}\n-->\n</style>\n<!--[if IE]>\n<style type="text/css">\n\t#textfield {\n\t\ttop: 4px;\n\t\tright: 44px;\n\t\theight: 275px;\n\t\twidth: 365px;\n\t\toverflow:auto;\n\t}\n</style>\n<![endif]-->\n\n<!-- +++++++++++++++++++++++++ Bitte ÃƒÂ¤ndern Sie im eigenen Interesse nichts an diesem Code! ++++++++++++++++++++++++ -->\n<!-- +++++++++++++++++++++++++ Das kann massive Fehldarstellungen ihrer Auktion zur Folge haben! +++++++++++++++++++ -->\n<!-- +++++++++++++++++++++++++ ++++++++++++++++++++++++++ Ihr Supreme Team +++++++++++++++++++++++++++++++++++++++++ -->\n<!-- image1eWidth.intValue(): 235 --- image1eHeight.intValue(): 300 --&&--  height="200"\t -->\n\t\n<center>\n<div id="wrapper">\n<div id="doc">\n\t<div id="pannel">\n\t\t<div id="headline">Ed Hardy Herren Shirt Rock & Roll Weiss XXL Neu & OVP</div>\n\t\t<div class="clear"></div>\n\t\t<div id="imageholder"><table width="232" height="200" border="0" cellpadding="0" cellspacing="0" margin="0">\n\t\t  <tr align="center" valign="middle">\n\t\t\t<td>\n\t\t\t\t<img src="http://storage.supremeauction.com/flash/ebay2/10/49/76/10497654/13895964e.jpg" \n\t\t\t\t\t height="200" \n\t\t\t\t\t  border="0" align="middle"/>\n\t\t\t</td>\n\t\t  </tr></table></div>\n\t\t<div id="textfield"><P ALIGN="LEFT"><FONT COLOR="#000000" SIZE="+0">Zur Auktion steht ein Exklusives ED HARDY Herren T-Shirt in weiÃŸer Farbe, orginalverpackt und mit Etikett in der GrÃ¶ÃŸe XXL.</FONT></P><P ALIGN="LEFT"></P><P ALIGN="LEFT"><FONT COLOR="#000000" SIZE="+0">Das Shirt hat auf der Brust den Schriftzug &quot;Rock &amp; Roll Lives&quot; in Orange und Gelb besetzt mit Strass Steinen. </FONT></P><P ALIGN="LEFT"><FONT COLOR="#000000" SIZE="+0">Auf dem RÃ¼cken ist wie auf dem Foto zu erkennen eine hochwertiger Aufdruck mit dem Schriftzug &quot;Beast of Burden&quot; in Gelb gedruckt.</FONT></P><P ALIGN="LEFT"></P><P ALIGN="LEFT"><FONT COLOR="#000000" SIZE="+0">Ich wÃ¼nsche Ihnen viel SpaÃŸ beim steigern und bitte beachten</FONT></P><P ALIGN="LEFT"><FONT COLOR="#000000" SIZE="+0">Sie auch meine anderen Angebote in Ebay!!</FONT></P> <br><P ALIGN="LEFT"><FONT COLOR="#000000" SIZE="+0">100% Orginal</FONT></P><P ALIGN="LEFT"><FONT COLOR="#000000" SIZE="+0">Top QualitÃ¤t zu Top Preisen</FONT></P><P ALIGN="LEFT"><FONT COLOR="#000000" SIZE="+0">Hochwertigste Materialien</FONT></P><P ALIGN="LEFT"><FONT COLOR="#000000" SIZE="+0">Aufwendige Stickerein</FONT></P><P ALIGN="LEFT"><FONT COLOR="#000000" SIZE="+0">Top Verarbeitung</FONT></P><P ALIGN="LEFT"><FONT COLOR="#000000" SIZE="+0">ExklusivitÃ¤t Pur</FONT></P><P ALIGN="LEFT"></P><P ALIGN="LEFT"></P> <br><P ALIGN="LEFT"><FONT COLOR="#000000" SIZE="+0">Der Versand erfolgt mit der Deutschen Post. </FONT></P><P ALIGN="LEFT"><FONT COLOR="#000000" SIZE="+0">Preise fÃ¼r EU LÃ¤nder auf Anfrage</FONT></P><P ALIGN="LEFT"></P><P ALIGN="LEFT"><FONT COLOR="#000000" SIZE="+0">Falls mehrere Produkte gekauft werden fallen nur einmal Versandkosten an!!!! </FONT></P><P ALIGN="LEFT"><FONT COLOR="#000000" SIZE="+0">Bitte per Mail vorher mitteilen</FONT></P> <br> <br><P ALIGN="LEFT"><FONT COLOR="#000000" SIZE="-3">Allgemeinen GeschÃ¤fts- und Lieferbedingungen (AGB)</FONT></P><P ALIGN="LEFT"><FONT COLOR="#000000" SIZE="-3">Diese AGBs gelten fÃ¼r alle Internet- Bestellungen und Auktionen:</FONT></P><P ALIGN="LEFT"></P><P ALIGN="LEFT"><FONT COLOR="#000000" SIZE="-3">Anwendungsbereich:</FONT></P><P ALIGN="LEFT"><FONT COLOR="#000000" SIZE="-3">FÃ¼r VertrÃ¤ge gelten ausschlieÃŸlich diese GeschÃ¤ftsbedingungen. Abweichenden Regelungen wird widersprochen. Andere als die hierin enthaltenen Regelungen werden nur mit unserer ausdrÃ¼cklichen schriftlichen Anerkennung wirksam. Die gelieferte Ware bleibt bis zur vollstÃ¤ndigen Bezahlung Eigentum des VerkÃ¤ufers.</FONT></P><P ALIGN="LEFT"><FONT COLOR="#000000" SIZE="-3">Auktionsende:</FONT></P><P ALIGN="LEFT"><FONT COLOR="#000000" SIZE="-3">Nach Ende der Auktion erhÃ¤lt der HÃ¶chst bietende von uns eine email mit der KaufbestÃ¤tigung und den AGB.</FONT></P><P ALIGN="LEFT"><FONT COLOR="#000000" SIZE="-3">Bitte beachten Sie hierzu dringend, dass Ihre bei eBay hinterlegte email-Adresse aktuell ist, damit Sie sÃ¤mtliche Informationen zur Kaufabwicklung erhalten.</FONT></P><P ALIGN="LEFT"><FONT COLOR="#000000" SIZE="-3">Zahlungsbedingungen:</FONT></P><P ALIGN="LEFT"><FONT COLOR="#000000" SIZE="-3">Die Zahlung muss innerhalb von 7 Werktagen eingegangen sein. Ansonsten, stelle wir die Ware wieder ein und wir mÃ¼ssen dann leider eine Meldung bei eBay abgeben. Kann die Zahlung nicht rechtzeitig erfolgen, bitten wir um eine kurze Mail.</FONT></P><P ALIGN="LEFT"><FONT COLOR="#000000" SIZE="-3">Lieferungs- und Versandbedingungen:</FONT></P><P ALIGN="LEFT"><FONT COLOR="#000000" SIZE="-3">Lieferung der bestellten Ware nur nach vorheriger Bezahlung per Ãœberweisung, PayPal oder Nachname. Lieferung und Versand, nach Eingang des kompletten Betrages innerhalb des nÃ¤chsten Werktages. Versandkosten siehe Artikelbeschreibung. Bitte die gewÃ¼nschte Versandart angeben. Bei Mehrfach auktionen Sammellieferung mÃ¶glich.</FONT></P><P ALIGN="LEFT"><FONT COLOR="#000000" SIZE="-3">Impressum</FONT></P><P ALIGN="LEFT"><FONT COLOR="#000000" SIZE="-3">Robert Wehowski</FONT></P><P ALIGN="LEFT"><FONT COLOR="#000000" SIZE="-3">Lange str. 72</FONT></P><P ALIGN="LEFT"><FONT COLOR="#000000" SIZE="-3">76530 Baden-Baden</FONT></P><P ALIGN="LEFT"><FONT COLOR="#000000" SIZE="-3">fashionticker@gmx.de</FONT></P><P ALIGN="LEFT"></P><P ALIGN="LEFT"><FONT COLOR="#000000" SIZE="-3">Mit der Abgabe Ihres Gebotes geben Sie sich mit den GeschÃ¤ftsbedingungen einverstanden.</FONT></P><P ALIGN="LEFT"><FONT COLOR="#000000" SIZE="-3">Widerrufsbelehrung</FONT></P><P ALIGN="LEFT"><FONT COLOR="#000000" SIZE="-3">Widerrufsrecht</FONT></P><P ALIGN="LEFT"><FONT COLOR="#000000" SIZE="-3">Sie kÃ¶nnen Ihre VertragserklÃ¤rung innerhalb von einem Monat ohne Angabe von GrÃ¼nden in Textform (z. B. Brief, Fax, E-Mail) oder - wenn Ihnen die Sache vor Fristablauf Ã¼berlassen wird - durch RÃ¼cksendung der Sache widerrufen. Die Frist beginnt nach Erhalt dieser Belehrung in Textform, jedoch nicht vor Eingang der Ware beim EmpfÃ¤nger (bei der wiederkehrenden Lieferung gleichartiger Waren nicht vor Eingang der ersten Teillieferung) und auch nicht vor ErfÃ¼llung unserer Informationspflichten gemÃ¤ÃŸ Â§ 312c Abs. 2 BGB in Verbindung mit Â§ 1 Abs. 1, 2 und 4 BGB-InfoV sowie unserer Pflichten gemÃ¤ÃŸ Â§ 312e Abs. 1 Satz 1 BGB in Verbindung mit Â§ 3 BGB-InfoV. Zur Wahrung der Widerrufsfrist genÃ¼gt die rechtzeitige Absendung des Widerrufs oder der Sache.</FONT></P><P ALIGN="LEFT"><FONT COLOR="#000000" SIZE="-3">Der Widerruf ist zu richten an:</FONT></P><P ALIGN="LEFT"><FONT COLOR="#000000" SIZE="-3">Robert Wehowski</FONT></P><P ALIGN="LEFT"><FONT COLOR="#000000" SIZE="-3">Lange str. 72</FONT></P><P ALIGN="LEFT"><FONT COLOR="#000000" SIZE="-3">76530 Baden-Baden</FONT></P><P ALIGN="LEFT"><FONT COLOR="#000000" SIZE="-3">email: fashionticker@gmx.de</FONT></P><P ALIGN="LEFT"><FONT COLOR="#000000" SIZE="-3">Widerrufsfolgen</FONT></P><P ALIGN="LEFT"><FONT COLOR="#000000" SIZE="-3">Im Falle eines wirksamen Widerrufs sind die beiderseits empfangenen Leistungen zurÃ¼ckzugewÃ¤hren und ggf. gezogene Nutzungen (z. B. Zinsen) herauszugeben. KÃ¶nnen Sie uns die empfangene Leistung ganz oder teilweise nicht oder nur in verschlechtertem Zustand zurÃ¼ckgewÃ¤hren, mÃ¼ssen Sie uns insoweit ggf. Wertersatz leisten. Bei der Ãœberlassung von Sachen gilt dies nicht, wenn die Verschlechterung der Sache ausschlieÃŸlich auf deren PrÃ¼fung - wie sie Ihnen etwa im LadengeschÃ¤ft mÃ¶glich gewesen wÃ¤re - zurÃ¼ckzufÃ¼hren ist. FÃ¼r eine durch die bestimmungsgemÃ¤ÃŸe Ingebrauchnahme der Sache entstandene Verschlechterung mÃ¼ssen Sie keinen Wertersatz leisten.</FONT></P><P ALIGN="LEFT"><FONT COLOR="#000000" SIZE="-3">PaketversandfÃ¤hige Sachen sind auf unsere Gefahr zurÃ¼ckzusenden. Sie haben die Kosten der RÃ¼cksendung zu tragen, wenn die gelieferte Ware der bestellten entspricht und wenn der Preis der zurÃ¼ckzusendenden Sache einen Betrag von 40 Euro nicht Ã¼bersteigt oder wenn Sie bei einem hÃ¶heren Preis der Sache zum Zeitpunkt des Widerrufs noch nicht die Gegenleistung oder eine vertraglich vereinbarte Teilzahlung erbracht haben. Anderenfalls ist die RÃ¼cksendung fÃ¼r Sie kostenfrei. Die Frist beginnt fÃ¼r Sie mit der Absendung Ihrer WiderrufserklÃ¤rung oder der Sache, fÃ¼r uns mit deren Empfang.</FONT></P><P ALIGN="LEFT"><FONT COLOR="#000000" SIZE="-3">Ende der Widerrufsbelehrung</FONT></P><br><p style="font-size: 9px;" align="right">Diese Auktion wurde erstellt mit: <a href="http://www.supreme-auction.de">Supreme Auction</a> - die Software, Tool f&uuml;r die einfache Erstellung von professionellen Design Auktionen / Widgets.</p> </div>\n\t\t<div class="clear"><div style="visibility:hidden"><a href="http://www.supreme-auction.de">www.supreme-auction.de</a></div></div>\n \t</div>\n\t<div id="flash">\n\t\t<SCRIPT LANGUAGE="JavaScript">\n\t\tdocument.writeln('<OBJECT classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,0,0" width="987" height="575" align="middle"> <param name="WMODE" value="transparent" /> <PARAM NAME="FlashVars" VALUE="cPath=http://storage.supremeauction.com/flash/ebay2/10/49/76/10497654/collector.swf&basePath=http%3A%2F%2Fstorage%2Esupremeauction%2Ecom%2Fflash%2F"> <PARAM NAME="movie" VALUE="http://storage.supremeauction.com/flash/startLoader2.swf"> <PARAM NAME="quality" VALUE="high"> <PARAM NAME="bgcolor" VALUE="#FFFFFF"> <embed src="http://storage.supremeauction.com/flash/startLoader2.swf" FlashVars="cPath=http://storage.supremeauction.com/flash/ebay2/10/49/76/10497654/collector.swf&basePath=http%3A%2F%2Fstorage%2Esupremeauction%2Ecom%2Fflash%2F" width="987" height="575" align="middle" wmode="transparent" menu="false" quality="high" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" /></OBJECT><BR>');\n\t\t</SCRIPT>\n\t\t<NOSCRIPT>\n\t\t<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,0,0" width="987" height="575" align="middle">\n\t\t\t<param name="movie" value="http://storage.supremeauction.com/flash/startLoader2.swf" />\n\t\t\t<param name="quality" value="high" />\n\t\t\t<param name="menu" value="false" />\n\t\t\t<param name="WMODE" value="transparent" />\n\t\t\t<param name="FlashVars" value="cPath=http://storage.supremeauction.com/flash/ebay2/10/49/76/10497654/collector.swf&basePath=http%3A%2F%2Fstorage%2Esupremeauction%2Ecom%2Fflash%2F" />\n\t\t\t<embed src="http://storage.supremeauction.com/flash/startLoader2.swf" FlashVars="cPath=http://storage.supremeauction.com/flash/ebay2/10/49/76/10497654/collector.swf&basePath=http%3A%2F%2Fstorage%2Esupremeauction%2Ecom%2Fflash%2F" width="987" height="575" align="middle" wmode="transparent" menu="false" quality="high" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" />\n\t\t</object>\n\t\t</NOSCRIPT>\t\t\n\t</div>\n\t<div class="clear"></div>\n</div>\n<div class="clear"></div>\n\n<div id="doc2">\n<a href="http://www.supreme-auction.de">Supreme Auction: Kostenlose Startzeit, Bilder und Designs. Klick hier!</a>\n</div>\n<!-- +++++++++++++++++++++++++ Bitte ÃƒÂ¤ndern Sie im eigenen Interesse nichts an diesem Code! ++++++++++++++++++++++++ -->\n<!-- +++++++++++++++++++++++++ Das kann massive Fehldarstellungen ihrer Auktion zur Folge haben! +++++++++++++++++++ -->\n<!-- +++++++++++++++++++++++++ ++++++++++++++++++++++++++ Ihr Supreme Team +++++++++++++++++++++++++++++++++++++++++ -->\n<br>\n<br>\n\n</div>\n</center>\n<span style="color:white">supremeauctiononlinesoftware.flash.auction_de</span>\n\n<!-- +++++++++++++++++++++++++ Bitte ÃƒÂ¤ndern Sie im eigenen Interesse nichts an diesem Code! ++++++++++++++++++++++++ -->\n<!-- +++++++++++++++++++++++++ Das kann massive Fehldarstellungen ihrer Auktion zur Folge haben! +++++++++++++++++++ -->\n<!-- +++++++++++++++++++++++++ ++++++++++++++++++++++++++ Ihr Supreme Team +++++++++++++++++++++++++++++++++++++++++ -->\n<!-- Supreme Automatic START -->\n<style type="text/css">\n<!--\n#automaticWidget {\n height: 252px;\n width: 989px;\n position: relative;\n}\n#automaticWidget .saline {\n\tline-height: 24px;\n\tbackground-color: #FFFFFF;\n\tfont-size: 11px;\n\tfont-family: Arial, Helvetica, sans-serif;\n\tcolor: #FFFFFF;\n\ttext-align: right;\n\tpadding-right: 5px;\n\t}\n\n-->\n</style>\n\n<center>\n\t<div id="automaticWidget">\n\t\t<SCRIPT LANGUAGE="JavaScript">\n\t\tdocument.writeln(\n\t\t\t'<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"  codebase="http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,0,0"  width="987" height="227" id="loader" align="middle">'+\n\t\t\t'<param name="allowScriptAccess" value="sameDomain" /> <param name="movie" value="http://storage.supremeauction.com/flash/automatic2/loaderWide.swf" /> <param name="quality" value="high" /> <param name="bgcolor" value="#ffffff" />'+\n\t\t\t'<param name="FlashVars" value="userPath=automatic/31/41/314162&rootPath=http://storage.supremeauction.com/flash/automatic2/" />'+\n\t\t\t'<embed src="http://storage.supremeauction.com/flash/automatic2/loaderWide.swf" FlashVars="userPath=automatic/31/41/314162&rootPath=http://storage.supremeauction.com/flash/automatic2/" '+\n\t\t\t'quality="high" bgcolor="#ffffff" width="987" height="227" name="loader" align="middle" allowScriptAccess="sameDomain" type="application/x-shockwave-flash" '+\n\t\t\t'pluginspage="http://www.macromedia.com/go/getflashplayer" /></object>');\n\t\t</SCRIPT>\n\t\t<NOSCRIPT>\n\t\t\t<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"\n\t\t\t        codebase="http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,0,0"\n\t\t\t        width="987" height="227" id="loader" align="middle">\n\t\t\t  \t\t<param name="allowScriptAccess" value="sameDomain" />\n\t\t\t  \t\t<param name="movie" value="http://storage.supremeauction.com/flash/automatic2/loaderWide.swf" />\n\t\t\t  \t\t<param name="quality" value="high" />\n\t\t\t  \t\t<param name="bgcolor" value="#ffffff" />\n\t\t\t  \t\t<param name="FlashVars"\n\t\t\t         value="userPath=automatic/31/41/314162&rootPath=http://storage.supremeauction.com/flash/automatic2/" />\n\t\t\t  \t\t<embed src="http://storage.supremeauction.com/flash/automatic2/loaderWide.swf"\n\t\t\t         FlashVars="userPath=automatic/31/41/314162&rootPath=http://storage.supremeauction.com/flash/automatic2/"\n\t\t\t         quality="high"\n\t\t\t         bgcolor="#ffffff"\n\t\t\t         width="987" height="227" name="loader" align="middle"\n\t\t\t         allowScriptAccess="sameDomain"\n\t\t\t         type="application/x-shockwave-flash"\n\t\t\t         pluginspage="http://www.macromedia.com/go/getflashplayer" />\n\t\t\t</object>\n\t\t</NOSCRIPT>\n\t\t<div class="saline">supremeauctiononlinesoftware.automatic.gallery <a href="http://www.supreme-auction.de">Supreme Auction:</a> <a href="http://www.supreme-automatic.de">Kostenlose eBay Tools! Klick hier!</a></div>\n\t</div>\t\n</center>\n<!-- Supreme Automatic END --><!-- Supreme Automatic START -->\n<style type="text/css">\n<!--\n#automaticWidget {\n\theight: 252px;\n\twidth: 989px;\n\tposition: relative;\n}\n#automaticWidget .saline {\n\tline-height: 24px;\n\tbackground-color: #FFFFFF;\n\tfont-size: 11px;\n\tfont-family: Arial, Helvetica, sans-serif;\n\tcolor: #FFFFFF;\n\ttext-align: right;\n\tpadding-right: 5px;\n\t}\n\n-->\n</style>\n\n<center>\n\t<div id="automaticWidget">\n\t\t<SCRIPT LANGUAGE="JavaScript">\n\t\t\t\n\t\tdocument.writeln(\n\t\t\t'<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"  codebase="http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,0,0"  width="987" height="135" id="loader" align="middle">'+\n\t\t\t'<param name="allowScriptAccess" value="sameDomain" /> <param name="movie" value="http://storage.supremeauction.com/flash/automatic2/feedback.swf" /> <param name="quality" value="high" /> <param name="bgcolor" value="#ffffff" />'+\n\t\t\t'<param name="FlashVars" value="userPath=automatic/31/41/314162&rootPath=http://storage.supremeauction.com/flash/automatic2/" />'+\n\t\t\t'<embed src="http://storage.supremeauction.com/flash/automatic2/feedback.swf" FlashVars="userPath=automatic/31/41/314162&rootPath=http://storage.supremeauction.com/flash/automatic2/" '+\n\t\t\t'quality="high" bgcolor="#ffffff" width="987" height="135" name="loader" align="middle" allowScriptAccess="sameDomain" type="application/x-shockwave-flash" '+\n\t\t\t'pluginspage="http://www.macromedia.com/go/getflashplayer" /></object>');\n\t\t</SCRIPT>\n\t\t\n\t\t<NOSCRIPT>\n\t\t\t<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"\n\t\t\t        codebase="http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,0,0"\n\t\t\t        width="987" height="135" id="loader" align="middle">\n\t\t\t  \t\t<param name="allowScriptAccess" value="sameDomain" />\n\t\t\t  \t\t<param name="movie" value="http://storage.supremeauction.com/flash/automatic2/feedback.swf" />\n\t\t\t  \t\t<param name="quality" value="high" />\n\t\t\t  \t\t<param name="bgcolor" value="#ffffff" />\n\t\t\t  \t\t<param name="FlashVars"\n\t\t\t         value="userPath=automatic/31/41/314162&rootPath=http://storage.supremeauction.com/flash/automatic2/" />\n\t\t\t  \t\t<embed src="http://storage.supremeauction.com/flash/automatic2/feedback.swf"\n\t\t\t         FlashVars="userPath=automatic/31/41/314162&rootPath=http://storage.supremeauction.com/flash/automatic2/"\n\t\t\t         quality="high"\n\t\t\t         bgcolor="#ffffff"\n\t\t\t         width="987" height="135" name="loader" align="middle"\n\t\t\t         allowScriptAccess="sameDomain"\n\t\t\t         type="application/x-shockwave-flash"\n\t\t\t         pluginspage="http://www.macromedia.com/go/getflashplayer" />\n\t\t\t</object>\n\t\t</NOSCRIPT>\n\t\t<div class="saline">supremeauctiononlinesoftware.automatic.gallery <a href="http://www.supreme-auction.de">Supreme Auction:</a> <a href="http://www.supreme-automatic.de">Kostenlose eBay Tools! Klick hier!</a></div>\n\t</div>\t\n</center>\n<!-- Supreme Automatic END -->    77  Baden-Baden 1   0   1   0   -10006  1.00    0.00    1.00    0   0   1   77  NULL    NULL    NULL 
```

它应该在哪里点击这里继续它只是显示：

```
1.00 
<\/OBJECT>
');\n\t\t<\/SCRIPT>\n\t\t 
```

其他 html 记录显示正常

这是我用来这样做的代码：

```
<?php
session_start();
if (isset($_GET["cmd"]))
  $cmd = $_GET["cmd"];
else
  die("You should have a 'cmd' parameter in your URL");
 $pk = $_GET["pk"];
$con = mysql_connect("localhost","x","geheim");
if(!$con)
{
die('Connection failed because of' .mysql_error());
}
mysql_select_db("ebay",$con);
if($cmd=="GetAuctionData")
{
$sql="SELECT * FROM Auctions WHERE ARTICLE_NO ='$pk'";
$sql2="SELECT ARTICLE_DESC FROM Auctions WHERE ARTICLE_NO ='$pk'";
$htmlset = mysql_query($sql2);
$row2 = mysql_fetch_array($htmlset);

// <p><strong>Category</strong></p> ".$row['CATEGORY']."

$result = mysql_query($sql);
while ($row = mysql_fetch_array($result))
{
echo "<div id='leftlayer'>
  <strong>Article Number</strong> ".$row['ARTICLE_NO']."
    <p><strong>Article Name</strong></p> ".$row['ARTICLE_NAME']."
    <p><strong>Subtitle</strong></p> ".$row['SUBTITLE']."
    <p><strong>Username</strong></p> ".$row['USERNAME']."
    <p><strong>Total Selling</strong></p> ".$row['QUANT_TOTAL']."
    <p><strong>Total Sold</strong></p> ".$row['QUANT_SOLD']."

    <p><strong>Highest Bidder</strong></p> ".$row['BEST_BIDDER_ID']."
  </div>
<div class='leftlayer2'>
  <strong>Current Bid</strong> ".$row['CURRENT_BID']."
  <p><strong>Start Price</strong></p> ".$row['START_PRICE']."
  <p><strong>Buyitnow Price</strong></p> ".$row['BUYITNOW_PRICE']."
  <p><strong>Bid Count</strong></p> ".$row['BID_COUNT']."
  <p><strong>Start Date</strong></p> ".$row['ACCESSSTARTS']."
  <p><strong>End Date</strong></p> ".$row['ACCESSENDS']."
  <p><strong>Original End</strong></p> ".$row['ACCESSORIGIN_END']."
  <p><strong>Auction Type</strong></p> ".$row['AUCTION_TYPE']."
</div>
<div class='leftlayer2'>
  <strong>Private Auction</strong></p> ".$row['PRIVATE_AUCTION']."
  <p><strong>Paypal Accepted</strong></p> ".$row['PAYPAL_ACCEPT']."
  <p><strong>Auction Watched</strong></p> ".$row['WATCH']."
  <p><strong>Finished</strong></p> ".$row['FINISHED']."

  <p><strong>Location</strong></p> ".$row['LOCATION']."
  <p><strong>Conditions</strong></p> ".$row['CONDITIONS']."
</div>
<div class='leftlayer2'>
  <strong>Auction Revised</strong></p> ".$row['REVISED']."
  <p><strong>Cancelled</strong></p> ".$row['PRE_TERMINATED']."
  <p><strong>Shipping to</strong></p> ".$row['SHIPPING_TO']."
  <p><strong>Fee Insertion</strong></p> ".$row['FEE_INSERTION']."
  <p><strong>Fee Final</strong></p> ".$row['FEE_FINAL']."
  <p><strong>Fee Listing</strong></p> ".$row['FEE_LISTING']."
  <p><a href='#' onclick='makewindows(" . json_encode($row2["ARTICLE_DESC"]) . "); return false;'>Click for full description </a></p>
</div>";
$lastImg = $row['PIC_URL'];
echo "<div id='rightlayer'>Picture Picture
<img src='".$lastImg."'>
</div>";

}

}
mysql_close($con);
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-11T12:26:44.157

一方面，您需要转义嵌入到 HTML 中的所有值。

你的一切`$row['WHATEVER']`都应该是。此外，您的 json 数据可能包含引号，因此应另外转义：[`htmlspecialchars`](http://www.php.net/htmlspecialchars)`($row['WHATEVER'])`

```
htmlspecialchars(json_encode($row2["ARTICLE_DESC"]), ENT_QUOTES) 
```

附带说明一下，您的代码容易受到 mysql 注入的影响。您需要转义嵌入到 SQL 中的任何值：

```
$sql = "SELECT * FROM Auctions WHERE ARTICLE_NO ='" . mysql_real_escape_string($pk) . "'"; 
```

（看到那里的模式吗？**您需要转义嵌入到 XXX 中的任何值，**其中 XXX 是某种代码。）

# asp.net - 如何使用 URL 设置 ASP.NET 2.0 Web App 中的当前区域性？

> ID：358949
> 
> 赞同：1
> 
> 时间：2008-12-11T10:39:10.007
> 
> 标签：asp.net, localization, url-rewriting, asp.net-2.0, url-routing

我正在寻找使网站基本上具有以下功能的方法：

[http://mysite.com/](http://mysite.com/) **en-US** /index.aspx`

“en-US”可能因文化而异。

然后，URL 中的这种文化将基本上`CurrentUICulture`为应用程序设置 ..

基本上，我们目前有一个页面，用户明确点击它，但有些人喜欢过去，这导致了一些问题..

我知道这种事情在 ASP.NET MVC 中很容易完成，但是我们这些仍在 2.0 中工作的人呢？你们能提供任何可以让我开始的建议/指针/任何东西吗？这对我来说是新的:)

我确定必须有某种方法来接收请求并酌情设置/退回..`HttpModule`也许？

### 更新

刚刚想到.. 最好在 IIS 中创建 VirtDirs，然后从请求的 URL 中提取适当的部分并将文化设置为`InitializeCulture`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-11T11:02:27.557

将选择存储在 cookie 中是不可能的吗？你们很高兴为用户提供选择，但为什么不直接使用用户客户端/Web 浏览器设置？

如果他们为页面添加了书签并且丢失了 cookie，您可以退回到默认设置，如果这是您不支持的文化，则进一步退回到 en-US。

如果你想保留你的解决方案，你可以使用重写引擎。我过去使用过[http://www.managedfusion.com/products/url-rewriter/](http://www.managedfusion.com/products/url-rewriter/)。有关引擎列表，请参阅[http://en.wikipedia.org/wiki/Rewrite_engine#IIS](http://en.wikipedia.org/wiki/Rewrite_engine#IIS)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-11T10:54:44.047

您可以通过 Web 表单轻松使用为 MVC 开发的路由功能。这个 SO question 解决了这样做的问题：

[带有 Web 窗体的 ASP.NET 路由](https://stackoverflow.com/questions/174849/aspnet-routing-with-web-forms)

如果您不能使用 3.5 框架，则有许多 URL 重写模块。我没有任何经验可以提出建议。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-11T11:18:09.040

我在一些使用 ASP.net 路由的站点中这样做。

这是代码：

```
Sub Application_Start(ByVal sender As Object, ByVal e As EventArgs)
    ' Code that runs on application startup
    RegisterRoutes(RouteTable.Routes)
End Sub

Public Sub RegisterRoutes(ByVal routes As RouteCollection)
    Dim reportRoute As Route
    Dim DefaultLang As String = "es"

    reportRoute = New Route("{lang}/{page}", New LangRouteHandler)
    '* if you want, you can contrain the values
    'reportRoute.Constraints = New RouteValueDictionary(New With {.lang = "[a-z]{2}"})
    reportRoute.Defaults = New RouteValueDictionary(New With {.lang = DefaultLang, .page = "home"})

    routes.Add(reportRoute)
End Sub 
```

然后是 LangRouteHandler.vb 类：

```
Public Class LangRouteHandler
     Implements IRouteHandler

  Public Function GetHttpHandler(ByVal requestContext As System.Web.Routing.RequestContext) As System.Web.IHttpHandler _
      Implements System.Web.Routing.IRouteHandler.GetHttpHandler

    'Fill the context with the route data, just in case some page needs it
    For Each value In requestContext.RouteData.Values
        HttpContext.Current.Items(value.Key) = value.Value
    Next

    Dim VirtualPath As String
    VirtualPath = "~/" + requestContext.RouteData.Values("page") + ".aspx"

    Dim redirectPage As IHttpHandler
    redirectPage = BuildManager.CreateInstanceFromVirtualPath(VirtualPath, GetType(Page))
    Return redirectPage

  End Function
End Class 
```

最后，我使用根目录中的 default.aspx 重定向到浏览器列表中使用的默认语言。
也许这可以通过 route.Defaults 完成，但不能在 Visual Studio 中工作（也许它可以在服务器中工作）

```
Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs)
    Dim DefaultLang As String = "es"
    Dim SupportedLangs As String() = {"en", "es"}
    Dim BrowserLang As String = Mid(Request.UserLanguages(0).ToString(), 1, 2).ToLower
    If SupportedLangs.Contains(BrowserLang) Then DefaultLang = BrowserLang

    Response.Redirect(DefaultLang + "/")
End Sub 
```

一些资料来源：
* [Mike Ormond 的博客](http://blogs.msdn.com/mikeormond/archive/2008/05/14/using-asp-net-routing-independent-of-mvc.aspx)
* [Chris Cavanagh 的博客](http://chriscavanagh.wordpress.com/2008/04/25/systemwebrouting-with-webforms-sample/)
* [MSDN](http://msdn.microsoft.com/en-us/library/cc668201.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-15T18:01:23.367

只需尝试添加该参数

```
http://yoursite/yourPage.aspx?lang=en-US 
```

如果您正在使用资源文件，它将自动运行。

祝你好运

# tfs - 如何完全删除 TFS 绑定

> ID：358951
> 
> 赞同：243
> 
> 时间：2008-12-11T10:40:02.313
> 
> 标签：tfs, version-control, source-control-bindings

我有一个包含大量项目的解决方案，

我想完全删除源代码控制绑定，我该怎么做？

**更新：** 我真正想做的是将一个解决方案及其项目从 TFS 2005 -> 2008 转移。这就是我删除绑定的原因，有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：269
> 
> 时间：2008-12-11T12:15:04.150

文件 -> 源代码管理 -> 高级 -> 更改源代码管理，然后取消绑定和/或断开所有项目和解决方案的连接。

这应该从解决方案和项目文件中删除所有绑定。（之后您可以在工具 -> 选项 -> 源代码管理 -> 插件选择中切换 SCC 提供程序）。

SCC 规范规定所有 SCC 提供者都应实现此行为。（我只测试了 VSS、TFS 和 AnkhSVN）

* * *

## 回答 #2

> 赞同：154
> 
> 时间：2011-05-26T11:38:17.823

我在 Visual Studio 中没有 File -> Source Control 菜单，因为我从未在此 Visual Studio 安装中使用过 TFS。

我的问题是我正在从互联网上打开一个解决方案，而原作者忘记删除 TFS 绑定，所以每次我打开解决方案时，我都会收到一个烦人的弹出窗口说

```
"Go Offline

The Team Foundation Server http://some-other-guys-tfs-server/ 
is currently unavailable.

The solution will be opened offline." 
```

为了摆脱这种情况，我删除了 .sln 文件旁边的 .suo，然后在记事本中打开 .sln 文件并删除了整个部分：

```
GlobalSection(TeamFoundationVersionControl) = preSolution
    SccNumberOfProjects = 2
    SccEnterpriseProvider = {xxxxx}
    SccTeamFoundationServer = http://some-other-guys-tfs-server/
    SccLocalPath0 = .
    SccProjectUniqueName1 = xxDemo\\xxDemo.csproj
    SccProjectName1 = xxDemo
    SccLocalPath1 = xxDemo
EndGlobalSection 
```

将 .sln 保存在记事本中，然后在 Visual Studio 中打开，问题解决。

更新：[Saveen Reddy](http://blogs.msdn.com/b/saveenr/archive/2012/08/11/a-tool-to-remove-source-control-bindings-from-visual-studio-solutions-and-projects.aspx)创建[了一个工具](https://github.com/saveenr/VS_unbind_source_control)来执行此操作。我还没有尝试过。

* * *

## 回答 #3

> 赞同：41
> 
> 时间：2008-12-11T10:47:50.270

**最简单的解决方案是打开 Visual Studio，在“工具”>“选项”>“源代码管理**”中停用 TFS 插件，然后重新打开要清理的解决方案。Visual Studio 将要求删除源代码控制绑定

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2012-08-12T04:43:19.120

如果有人需要在 Visual Studio 应用程序的上下文之外执行此操作 - 例如通过命令行，我编写了一个小工具，它将从解决方案和项目文件中剥离源代码控制绑定。源代码在这里：[https ://github.com/saveenr/VS_unbind_source_control](https://github.com/saveenr/VS_unbind_source_control)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2014-01-31T01:25:07.733

旧帖子，所以只需添加@Matt Frear 和@Johan Buret 的答案。**两者都工作**。

但在马特的情况下，您*还*需要在记事本/文本编辑器中设置这些（VS 2012）：

```
SccProjectName = ""
SccAuxPath = ""
SccLocalPath = ""
SccProvider = "" 
```

到解决方案文件 (.sln) 中的每个项目。

@Johan 的回答有效地做到了这一点......

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2015-08-13T16:12:40.030

有时，绑定信息被缓存

要清除团队资源管理器的缓存：

```
Go to C:\Users\<user>\AppData\Local\Microsoft\Team Foundation\2.0
Delete or rename the Cache folder. 
```

这来自一个我现在找不到的网站。谢谢那个家伙的提示。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2019-02-08T12:02:59.510

接下来对我有用：

1.  删除所有 .vssscc（解决方案绑定）和 .vspscc（项目绑定）文件
2.  从解决方案文件中删除块 GlobalSection(TeamFoundationVersionControl) = preSolution

`proj`标签中的文件中还可能包含有关源代码控制的信息

`<SccProjectName>SAK</SccProjectName> <SccLocalPath>SAK</SccLocalPath> <SccAuxPath>SAK</SccAuxPath> <SccProvider>SAK</SccProvider>`

SAK 声明[“应该已经知道”](https://stackoverflow.com/a/25309354/514449)，因此可以保留。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-02-02T09:32:43.083

您可以尝试使用此工具自动从项目中删除 Team Foundation 绑定。 [http://www.softpedia.com/get/Programming/Other-Programming-Files/Team-Foundation-Binding-Remover.shtml](http://www.softpedia.com/get/Programming/Other-Programming-Files/Team-Foundation-Binding-Remover.shtml)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-11-29T16:05:26.113

我发现这个工具可以帮助我完全摆脱 tfs 绑定，它在这里找到 [https://marketplace.visualstudio.com/items?itemName=RonJacobs.CleanProject-CleansVisualStudioSolutionsForUploadi](https://marketplace.visualstudio.com/items?itemName=RonJacobs.CleanProject-CleansVisualStudioSolutionsForUploadi)

它使用已删除的源绑定创建一个 zip，而无需修改原始项目。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2017-04-19T03:54:31.620

在视觉工作室 2015 中，

1.  取消绑定解决方案和项目`File->Source Control->Advanced->Change Source Control`
2.  删除缓存`C:\Users\<user>\AppData\Local\Microsoft\Team Foundation\6.0`

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-01-07T07:01:37.943

在 VS2017 中

1.  在团队资源管理器中转到主页
2.  单击项目部分中的**设置**
3.  单击Git 部分中的**存储库设置**
4.  从下一个窗口看**遥控器**部分。你会看到**删除选项**

注意：我检查了 git 存储库

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-01-19T20:26:53.897

**另一种选择是**

删除工作区

需要时重新映射

确保检查，回滚（撤消挂起的更改）

在删除工作区之前

这是最快最可靠的

**祝你好运**

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2018-08-07T08:24:15.460

1.  转到文件 -> 源代码管理 -> 高级 -> 更改源代码管理（如果没有出现更改源代码管理，请单击解决方案资源管理器中的解决方案，然后重试）
2.  取消绑定解决方案和所有项目

现在右键单击解决方案，您将看到“将项目添加到源代码管理”。如果您想再次将项目添加到源代码管理中，您可能会遇到一些错误，要求您更改 TFS 上的解决方案文件夹。发生这种情况是因为您的解决方案在工作区中有一些映射。删除映射或删除工作区。现在，您的解决方案已完全解除绑定，并与 TFS 或工作区解除映射。

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2013-08-26T08:07:28.010

[在这里，您可以找到另一个工具](http://blog.instance-factory.com/?p=565)（包括源代码），用于从解决方案和项目文件以及 .vssscc 和 .vspscc 文件中删除 SCC 占用空间。此外，它还删除了输出和其他可配置目录。

Hth

斯特凡

# jquery - 带有ajax的IE6表格单元格对齐问题

> ID：358952
> 
> 赞同：0
> 
> 时间：2008-12-11T10:40:17.337
> 
> 标签：jquery, html, ajax, internet-explorer

这个很诡异

[我有一个页面，它由一个名为 'rates-viewer' 的 div 中的 html 表组成](http://www.pickledegg.orchardhostings6.co.uk/bug/wp-test.php)。如果您在 IE（6 或 7）中加载此页面，您会注意到表格标题的内容未对齐到左侧。

如果您从下拉列表中选择一个国家/地区，它会触发对脚本的 ajax 调用。此脚本将完全相同的 html 返回到“rates-viwer”div 中，以替换原始表。

*奇怪的是，当它这样做时，表头内容正确对齐。*

为什么将相同的 html 加载到同一个 div 中，会导致我的表头内容被这样更正？

我假设我的 html 略有不同，我确信它是相同的。

任何人都可以帮忙解决这个问题，这让我皱起了眉头:) 我基本上需要正确排列原始 html，但我很想知道为什么会这样。

JS 有点像 jquery，它在 wp-test.php 源代码中。我的脚本称为rates-viewer-test.php，CSS在main.css中......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-11T13:30:12.470

您是否尝试过使用 jQuery 调用在页面加载时加载初始值？让 jQuery 调用你用来加载的函数，然后淡入这些值，应该给它们正确的对齐方式。

我找不到关于他们最初离线的具体问题。不过我只是看了一眼。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-11T21:42:42.647

当表格的宽度大于列的组合宽度时，您的问题在于 IE 处理列的方式。您的表格是 739 像素宽，您的 6 列是 95 像素 (95 * 6 = 570) 看起来默认的文本对齐方式是居中。删除 css 文件中列的宽度应该可以解决此问题。

顺便说一句，我查看了您的 css 文件，发现您在 3 个位置定义这些列的宽度。事实上，看起来几乎所有事情都在重复。您`.rates-section table th`在第 438、1492 和 2122 行定义，所有这些都具有宽度分配。

# cocoa - 寻找带有 Interface Builder 插件的框架的好地方……

> ID：358964
> 
> 赞同：5
> 
> 时间：2008-12-11T10:45:00.713
> 
> 标签：cocoa, macos, plugins, interface-builder

最近有人推荐了BWToolkit，给我留下了深刻的印象，所以我开始搜索更多的IB插件。我在随机博客上找到了几个，但无法为他们找到任何类型的存储库/聚合器。有人知道我在哪里可以找到更多这些吗？

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-11T19:33:14.717

我刚刚[在 CocoaDev 上创建了一个页面来列出它们](http://cocoadev.com/index.pl?InterfaceBuilderPlugins)[编辑：问题最初只是说“Interface Builder 插件”，没有提到 Cocoa 框架]，列出了我知道的两个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-12T05:53:16.277

嗯，这是一个好的开始。我猜现在 wiki 页面是事实上的存储库。好像外面的东西不多。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-13T08:37:43.733

您不是在寻找 Interface Builder 插件。你认为你是，但你不是。您在问题中使用的示例 BWToolkit 不是 Inteface **Builder**插件。Brandon*将其*称为 Interface Builder 插件，但它实际上是一个框架*和*插件。该框架包含实际的控件。该插件包含与 Interface Builder 的集成。

所以真的，您正在寻找的是**包含**或**提供**Interface Builder 插件的框架。我已更改您的问题以反映这一点，因此将来使用 Google 搜索类似事物的人更有可能找到它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-13T09:02:56.070

我知道我在寻找什么。并非所有框架都包含 IB 插件。我正在寻找包含 IB 插件的特定框架子集。没有框架的 IB 插件是无用的，因此假定框架部分。我不是在寻找常规的旧框架，所以不要再试图将我的问题改成那样。您的添加似乎只会使人们感到困惑。

我已经举报了你的帖子，希望版主能够阻止你的讨厌行为。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-14T11:26:31.003

“如果没有框架，你必须将什么插入到 IB 中？”

你的话，不是我的。不管怎样，我和你争论完了。请记住，每次您编辑时我都可以回滚。

很明显，您在该领域拥有丰富的经验，但您没有提供答案，而是决定在没有可挑剔的地方挑剔。

此外，您没有“更改问题以反映这一点”，您已将问题更改为完全不同的问题。我会认为，在四次回滚之后，你会意识到你做的弊大于利。停下来，好吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-11-20T07:42:19.470

当然，Chris Hanson 说没有附带框架的 Interface Builder 插件毫无用处是绝对正确的。Interface Builder 仅提供了一种图形方式来管理框架中的对象；没有框架本身，Interface Builder 就没有什么可管理的了。

但是，我确实认为有一种完全有效的 Interface Builder 插件，它不需要安装随附的框架，并且可以为 Cocoa/Cocoa Touch 中的对象提供 Interface Builder 集成功能，否则会出现只是通用对象。

对于那些来到谷歌这个页面的人，请认识到 Interface Builder 插件和框架之间的区别：即使上面提到的示例也适用于框架（它们可能是 Foundation、AppKit、UIKIt 等）

# dll - 使用 MSBuild 输出正在操作的当前 DLL 的名称

> ID：358966
> 
> 赞同：0
> 
> 时间：2008-12-11T10:45:41.333
> 
> 标签：dll, msbuild

这可能是一个非常愚蠢的 MSBuild 问题，但如果我有

```
<ItemGroup>
<Dll Include="<Path_to_DLLs>\*.dll" />
</ItemGroup> 
```

进而

```
<SomeTarget useFiles=@(Dll)>
....do stuff
</someTarget> 
```

我想要做的是输出`@(Dll)`循环通过的当前项目。基本上我想输出当前正在执行的 DLL 的名称。

我认为这一定是可能的，它可能很简单，但它让我发疯！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-11T11:16:39.167

啊哈元数据的乐趣。

在 MSBuild 中创建每个项目时，都会为其分配特定的元数据。

在这种情况下，我可以使用 %(Filename) 来检索文件名

[这是众所周知的元数据的完整列表](http://msdn.microsoft.com/en-us/library/ms164313.aspx)

# security - 如何通过 Mac OS X 上的 Unix 域套接字传递用户凭据？

> ID：358967
> 
> 赞同：4
> 
> 时间：2008-12-11T10:46:19.057
> 
> 标签：security, macos, sockets

在许多操作系统下，Unix 域套接字允许进程以无法被恶意破坏的方式可靠地将其凭据传递给另一个进程。例如，这在 Linux 上通过[SO_PASSCRED 和 SO_PEERCRED 选项](http://linux.die.net/man/7/socket)完成，在 FreeBSD 上[通过传递包含 cmsgcred 结构的消息来完成](http://books.google.gr/books?id=ptSC4LpwGA0C&pg=PA429&lpg=PA429&source=web&ots=Kq2FUpbqTu&sa=X&oi=book_result&ct=result)，在 NetBSD 上[通过设置 LOCAL_CREDS 选项完成](http://julipedia.blogspot.com/2006/08/more-on-localcreds.html)。但是，我还没有找到在 Mac OS X 下执行此操作的方法。相应的头文件 (socket.h) 似乎禁用了 Apple 构建的功能。

```
#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
#ifndef __APPLE__
// ...
struct cmsgcred { 
```

知道另一个可以实现相同结果的 Mac OS X 工具吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-11T15:46:58.887

我从未使用过它，但我认为您正在寻找 LOCAL_PEERCRED。（见 man unix）

*您可以使用 Mac OS X 10.4 中引入的 LOCAL_PEERCRED 套接字选项来确认套接字另一端的程序的身份。*

请参阅[技术说明 TN2083。守护进程和代理](http://developer.apple.com/technotes/tn2005/tn2083.html)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-11T16:47:29.233

更好的是，由于接受了答案，我发现 getpeereid() 直接返回所需的数据。

# c++ - _di_IXMLNode 中不需要的 xmlns=""

> ID：358972
> 
> 赞同：0
> 
> 时间：2008-12-11T10:47:53.017
> 
> 标签：c++, xml, c++builder, xmldocument

我正在使用 _di_IXMLDocument 创建一个用于在 Excel 中显示的 xml 文件。但是对于某些标签，我得到了一个不需要的额外（空）xmlns 属性，女巫使 Excel 无法读取文件......这就是我所做的：

```
...
_di_IXMLNode worksheet = workbook->AddChild("Worksheet");
worksheet->SetAttribute("ss:Name",Now().DateString());
... 
```

这就是结果：

```
<Worksheet xmlns="" ss:Name="2008-12-11"> 
```

xmlns 是从哪里来的？我该如何摆脱它？

编辑：更多信息：如果我尝试自己将 xmlns 属性添加到 Worksheet，如下所示：

```
...
_di_IXMLNode worksheet = workbook->AddChild("Worksheet");
worksheet->SetAttribute("xlmns","Foo");
worksheet->SetAttribute("ss:Name",Now().DateString());
... 
```

然后“工作表”的子节点都获得了空的xmlns属性！

```
<Worksheet xmlns="Foo" ss:Name="2008-12-11">
  <Table xmlns=""> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-11T12:47:54.223

xmlns 代表 xml 命名空间，如果一个属性没有收到明确的命名空间，它就没有。

[http://www.w3.org/TR/REC-xml-names/](http://www.w3.org/TR/REC-xml-names/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-11T13:06:57.290

好的，我看了一下[这个](https://stackoverflow.com/questions/135000/how-to-prevent-blank-xmlns-attributes-in-output-from-nets-xmldocument)问题。诀窍是创建子节点并告诉它们属于哪个命名空间，然后不输出它......

```
_di_IXMLNode worksheet = workbook->AddChild("Worksheet","workbooks-namespace",false);
worksheet->SetAttribute("ss:Name",Now().DateString()); 
```

这会产生所需的输出：

```
<Worksheet ss:Name="2008-12-11"> 
```

# c# - 在编辑菜单中删除

> ID：358973
> 
> 赞同：0
> 
> 时间：2008-12-11T10:48:35.057
> 
> 标签：c#, winforms

在一个简单的对话框应用程序中，使用设计器，我在编辑菜单中设置了剪切、复制、粘贴和删除的常用快捷键。

我的问题是我只想在某个树控件处于焦点时处理删除事件。否则，例如，在我的 datagrid 控件中，我希望 delete 像往常一样工作。

最好的方法是什么？目前我在主窗体类中收到一个删除事件，但删除键在数据网格控件的编辑控件中不起作用。

**编辑**- 指定删除键在编辑子控件中不起作用

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-11T11:42:02.203

看来，如果您想使用菜单项的快捷键，这`keycombination`将在整个表单中使用，无论您是否将您设置`eventhandler`为不做任何事情，除非某个树控件处于焦点状态（无法设置键-事件为`.Handled=false`）。

因此，最好的方法是不在菜单条中设置快捷键，而是`KeyDown`在表单 ( ) 或特定树控件上挂钩事件`keypreview`，并处理删除快捷键应该在那里执行的任何操作。

如果您需要显示快捷方式文本，即使您没有在菜单条中定义快捷键，请使用`.ShortcutKeyDisplayString`菜单项上的属性来设置文本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-11T11:25:01.117

如果您只有一个表单和一个数据网格，最简单的方法是从您的菜单项调用的单击事件中触发您的数据网格删除事件。无论哪一行是当前的（绑定源）或选定的（数据网格），您都可以通过编程方式删除。

# xml - 使用 nant 将属性添加到 xml 节点

> ID：358974
> 
> 赞同：5
> 
> 时间：2008-12-11T10:49:05.947
> 
> 标签：xml, nant, xmlpoke

有没有办法使用 nant 向 xml 节点（我有 xpath）添加属性？试过 xmlpoke 但它看起来只能更新现有属性。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-15T05:19:48.567

XmlPoke 肯定不起作用，因为 xpath 必须首先匹配某些东西才能替换它。

我知道这样做的唯一方法是创建自己的任务，允许您将数据添加到 xml 文件。这些新任务可以单独构建并通过将 dll 复制到 NAnt\bin 文件夹中添加到 NAnt，或者直接从构建文件扩展 NAnt

[可以在<script/> 任务](http://nant.sourceforge.net/release/0.85/help/tasks/script.html)中找到帮助您入门的信息

如果您碰巧使此任务足够通用，那么尝试将其提交给[NAntContrib](http://nantcontrib.sourceforge.net/)可能会很好，这样每个人都会受益。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-10-20T22:25:09.070

我最近做了类似的东西。这是用于插入节点，但应该很容易更改。

```
<script language="C#" prefix="test" >
        <references>
            <include name="System.Xml.dll" />
        </references>
        <code>
            <![CDATA[
              [TaskName("xmlinsertnode")]
              public class TestTask : Task {
                #region Private Instance Fields
                private string _filename;
                private string _xpath;
                private string _fragment;
                #endregion Private Instance Fields

                #region Public Instance Properties
                [TaskAttribute("filename", Required=true)]
                public string FileName {
                    get { return _filename; }
                    set { _filename = value; }
                }

                [TaskAttribute("xpath", Required=true)]
                public string XPath {
                    get { return _xpath; }
                    set { _xpath = value; }
                }

                [TaskAttribute("fragment", Required=true)]
                public string Fragment {
                    get { return _fragment; }
                    set { _fragment = value; }
                }

                #endregion Public Instance Properties

                #region Override implementation of Task
                protected override void ExecuteTask() {
                    System.Xml.XmlDocument document = new System.Xml.XmlDocument();
                    document.Load(_filename);
                    System.Xml.XPath.XPathNavigator navigator = document.CreateNavigator();
                    navigator.SelectSingleNode(_xpath).AppendChild(_fragment);
                    document.Save(_filename);
                }
                #endregion Override implementation of Task
              }
            ]]>
        </code>
    </script> 
```

# java - 是否有任何用于将文档从 pdf 转换为 html 的 java 库？

> ID：358975
> 
> 赞同：6
> 
> 时间：2008-12-11T10:49:48.673
> 
> 标签：java, html, pdf

开源实现将是首选。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-11T12:59:35.807

显然，这不是一件容易的事，PDF 格式比 HTML 格式要丰富得多（另外，您必须提取图像并链接它们等）。
简单的文本提取要简单得多（虽然不是微不足道的......）。
我在您问题的侧边栏中看到了一个类似的问题：[Converting PDF to HTML with Python](https://stackoverflow.com/questions/276434/converting-pdf-to-html-with-python "使用 Python 将 PDF 转换为 HTML") which pointing to a library（poppler，这显然是用 C++ 编写的，也许可以用 JNI/JNA 访问）和一个相关的问题，它甚至提供更多答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-11T11:08:28.090

只有我认识的人需要付费。

[BFO](http://bfo.co.uk/)
[JPedal](http://www.jpedal.org/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-11-04T23:03:20.457

尝试使用apache 基金会的[PDFBox](http://pdfbox.apache.org)。

# jquery - jQuery中的选项卡选择

> ID：358986
> 
> 赞同：0
> 
> 时间：2008-12-11T10:54:35.280
> 
> 标签：jquery

我需要一个点击标签事件。我正在使用以下代码。

```
<script type="text/javascript">
    $(function() {
        $('#container-1').tabs();
        $('#start').bind('tabsselect', function(event, ui) {
            alert('tab label ' + ui.tab.text());
        });
     });
 </script>

    .....

 <div id="container-1">
     <ul>
         <li><a href="#fragment-1"><span id="start">Start</span></a></li>
         <li><a href="#fragment-2"><span id="mid">Mid </span></a></li>
           ....
         List of tabs
    </ul>
 </div> 
```

在这里，我需要单击的选项卡名称作为警报。但我无法执行它。我尝试使用 jQuery 1.2.6。我应该在此代码中添加任何其他内容吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-11T11:04:11.483

[您是否获得了jQuery UI](http://en.wikipedia.org/wiki/JQuery_UI)选项卡方法所需的完整要求列表？

jQuery 网站上的[下载助手](http://ui.jquery.com/download_builder/)非常有用。

# php - 如何在 CakePHP 中实现高级组合框？

> ID：358990
> 
> 赞同：0
> 
> 时间：2008-12-11T10:57:22.777
> 
> 标签：php, cakephp, combobox

我使用以下语句在 CakePHP 中实现了组合框：

```
echo $form->select('brand_id',array($brands),null,array(),'Choose Brand'); 
```

对于品牌和类别的输入形式：

```
echo $form->input('category_id',array('type'=>'select',$categories,'empty'=>'Choose Category')); 
```

但是以上选项都不允许我将我的文本输入添加到品牌或类别，比如说我想添加一个组合框中不存在的输入，我应该怎么做。

喜欢组合框中的链接或组合框中的文本框？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-12T09:42:52.257

有 2 个“其他”字段：

```
echo $form->input('brand_other');
echo $form->input('category_other'); 
```

对于此表单的模型，您需要在数据库表中再添加 2 个字段，或者在控制器中将这些“其他”字段中发布的值添加到您的品牌和类别表中的逻辑，然后在保存之前添加插入`$this->data` `brand_id`的`category_id`ID这个模型。

此外，您可以`$form->input()`对两个选择框使用该方法，并且不需要显式发送它`$brands`或`$categories`变量，如果它们在您的视图中可用，表单助手将检测到这一点并自动打印选择框。

# java - 如何在 Metro/JavaEE 自动生成的 WSDL 中自定义命名空间前缀？

> ID：358991
> 
> 赞同：0
> 
> 时间：2008-12-11T10:58:27.503
> 
> 标签：java, web-services, jakarta-ee, wsdl, java-metro-framework

我将 Java 6 + JavaEE + Tomcat 6 + Metro 用于 SOAP Web 服务。在响应中，命名空间前缀是 ns2、ns3、ns4 等。我希望能够指示 Web 服务堆栈改用自定义名称。

我该怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-19T22:17:55.223

使用 @XmlSchema 注释（假设您使用的是 JAXB2.x）

```
@XmlSchema (
  xmlns = { 
    @XmlNs(prefix = "so", 
               namespaceURI="http://stackoverflow.com/questions/358991")
  )
) 
```

会导致：

```
<schema
    xmlns:so="http://stackoverflow.com/questions/358991"
    targetNamespace="http://stackoverflow.com/questions/358991"> 
```

# xml - 如何从 TeamCity 检索 XML 中的构建状态

> ID：358999
> 
> 赞同：4
> 
> 时间：2008-12-11T11:01:19.790
> 
> 标签：xml, rss, teamcity

我需要以 XML 的形式从 TeamCity 检索构建状态，RSS 格式将是理想的。

我熟悉 Teamcity 中的 RSS 提要，但这没有用，因为它更像是一个历史视图。我正在寻找更像是由状态小部件生成的页面，但采用 XML 形式。（仅供参考，状态小部件页面不是 XHTML - 试过了！）

我想知道是否有人有任何可以提供帮助的东西？

亲切的问候，大卫克里斯蒂安森

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-15T16:09:22.023

我一直在研究这个问题一段时间

[这是一篇文章，向您展示如何在 c# 中使用代码登录到 teamcity](https://stackoverflow.com/questions/190587/how-can-i-pull-artifacts-from-teamcity)

那么它只是使用 HTMLAgilityPack 查看表格的问题。

如果您打开访客访问，它会更容易。如果有帮助，我将尽快清理代码以供发布。如果您使用另一种语言进行开发，我也可以提供帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-01-05T04:16:40.997

您可以使用`Syndication Feed`下面的工具`My Settings And Tools`生成 RSS URL（[此处](http://confluence.jetbrains.net/display/TCD5/Feed+URL+Generator)的文档），并跟踪更改与构建结果以确定状态（即构建和之前成功/失败）

例如，我刚刚创建了这个 URL 来查看最后 5 个构建结果：

```
http://teamcity:8111/feed.html?buildTypeId=bt2&itemsType=builds&itemsCount=5 
```

在哪里：

*   `buildTypeId`是配置的 ID（通过检查构建的 URL 来获取）
*   `itemsType`可能是“构建”或“更改”或两者兼而有之

您可以使用“更改”类型来确定当前是否正在进行构建...

[这里](http://confluence.jetbrains.net/display/TCD5/RSS+Feed)有 TeamCity RSS 的其他 URL 选项，例如`buildStatus`和`sinceDate`。

*注意*：根据您是否启用了访客访问，您可能需要使用不同的上下文，例如`/httpAuth/feed.html`或`/guestAuth/feed.html`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-11T11:37:15.177

**编辑：**正如您所指出的，来自 TeamCity 的 RSS 提要仅包括已完成的构建。

一种可能性是从您感兴趣的项目的详细信息页面中获取 HTML，然后从那里的构建表的顶部条目中提取当前状态。

另一种选择：您是否考虑过使用 Jabber 或电子邮件通知系统？它有更细粒度的事件通知：

*   构建开始
*   构建成功或失败

两者都会生成通知，您可以从中推断构建状态。围绕电子邮件的自动化很简单，而且 Jabber 是一个开放标准，所以我想这也相当容易。

这些选项中的任何一个都需要一些包装代码才能转换为 RSS。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-16T00:18:23.847

可能最好编写自己的插件。如果你当然知道 Java。您可以创建自定义 Web 控制器并将其绑定到您喜欢的 url，此控制器可以接受 buildId 参数，搜索构建 (SBuildServer.findBuildInstanceById()) 并输出 XML。

查看与 TeamCity (TeamCity/devPackage) 捆绑在一起的 samplePlugin.zip 中的 HelloUserController.java。

还值得检查一些 TeamCity 插件的来源：http: [//www.jetbrains.net/confluence/display/TW/TeamCity+Plugins](http://www.jetbrains.net/confluence/display/TW/TeamCity+Plugins)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-14T10:41:26.120

[这个标准 XML 状态格式的摘要](http://confluence.public.thoughtworks.org/display/CI/Multiple+Project+Summary+Reporting+Standard)是否描述了您的意思？我很确定 TeamCity 可以生成这种格式，但不确定如何生成。Hudson 使用类似[http://my.hudson.server.example.com:3030/cc.xml](http://my.hudson.server.example.com:3030/cc.xml)的 URL 来实现。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-11-06T10:42:27.047

我使用每个构建类型的 API 做到了：

```
curl -k "https://${SERVER}/guestAuth/app/rest/buildTypes/${BUILDTYPE}/builds/?locator=lookupLimit:1"|xpath -q -e //build/@status 
```