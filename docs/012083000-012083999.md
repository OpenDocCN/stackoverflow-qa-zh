# StackOverflow 问答 12083000-12083999

# r - 将线图放在条形图的前面

> ID：12083000
> 
> 赞同：1
> 
> 时间：2012-08-22T23:56:35.707
> 
> 标签：r

我在同一张图中有一条线和一个条形图。但是，条形图位于折线图的前面。如何将线图发送到前面？

```
h<-hist(loose_All, breaks="FD", plot=FALSE)
xfit<-seq(min(loose_All),max(loose_All),length=100)
x.norm<-rnorm(n=100000, mean=mapply("[", results[1], 1),
         sd=mapply("[", results[1], 2))
yfit<-dnorm(xfit,mean=mean(x.norm),sd=sd(x.norm))
yfit <- yfit*max(h$counts)/max(yfit)
plot(xfit*1.1, yfit*1.1, col="blue", lwd=2, type="l", xlab="Looseness",
 main="Normal pdf and histogram",)
plot(h, add=TRUE, col="grey",freq=TRUE) 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T00:20:31.020

使用：par(new=TRUE) plot(data, function, axes = FALSE, xlab = "", ylab = "")

# ios - 部分卷曲下UISegmentedControl的流氓动画

> ID：12083001
> 
> 赞同：11
> 
> 时间：2012-08-22T23:56:42.553
> 
> 标签：ios, uisegmentedcontrol, ios5

我有一个带有按钮的视图控制器，该按钮可以激活带有部分卷曲过渡的 Storyboard Modal Segue。

在显示的视图控制器上，我有一个`UISegmentedControl`.

最后，我减小了`UISegmentedControl`.

当按下按钮时，页面卷曲以显示分段控件 - 在卷曲动画期间，您可以清楚地看到分段控件从零宽度动画到实际宽度 - 看起来非常奇怪和凌乱，我想不通找出为什么会这样！

我能够重现如下效果：

*   创建单视图项目
*   将第二个视图控制器添加到情节提要
*   将 a 添加`UIButton`到第一个视图控制器
*   将 a 添加`UISegmentedControl`到新的视图控制器
*   使用 Partial Curl Modal Segue 将按钮链接到第二个视图
*   在项目中添加一个类文件，继承自 UIViewController
*   将分段控件添加`IBOutlet`到新类
*   将第二个视图控制器链接到新类，将分段控件链接到插座
*   在`viewDidLoad:`新类中添加：

    ```
    [segmentedControl setTitleTextAttributes:[NSDictionary dictionaryWithObject:[UIFont boldSystemFontOfSize:14] forKey:UITextAttributeFont] forState:UIControlStateNormal]; 
    ```

如果允许以横向打开卷曲，也会看到类似的效果

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-23T08:25:01.783

我遇到过类似的事情。尝试更改`selectedSegmentIndex`curl 之前的右侧（您可以将其设置为 -1 以取消选择）以强制控件具有宽度。

# .net - Nihbernate 和 MySql：无法找到或加载已注册的 .Net Framework 数据提供程序

> ID：12083002
> 
> 赞同：0
> 
> 时间：2012-08-22T23:56:42.247
> 
> 标签：.net, mysql, nhibernate, hosting

我的网站在本地工作（解决方案是本地的，数据库是我的托管公司的 mysql db）。

我现在将我的代码上传到我的托管公司，当我尝试运行该项目时，我收到了这个错误

```
Server Error in '/' Application.
Failed to find or load the registered .Net Framework Data Provider.
Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code.

Exception Details: System.Configuration.ConfigurationErrorsException: Failed to find or load the registered .Net Framework Data Provider.

Source Error:

An unhandled exception was generated during the execution of the current web request. Information regarding the origin and location of the exception can be identified using the exception stack trace below.

Stack Trace:

[ConfigurationErrorsException: Failed to find or load the registered .Net Framework Data Provider.]
   System.Data.Common.DbProviderFactories.GetFactory(DataRow providerRow) +1420114
   System.Data.Common.DbProviderFactories.GetFactory(String providerInvariantName) +88
   NHibernate.Driver.ReflectionBasedDriver..ctor(String providerInvariantName, String driverAssemblyName, String connectionTypeName, String commandTypeName) +130
   NHibernate.Driver.MySqlDataDriver..ctor() +29

[TargetInvocationException: Exception has been thrown by the target of an invocation.]
   System.RuntimeTypeHandle.CreateInstance(RuntimeType type, Boolean publicOnly, Boolean noCheck, Boolean& canBeCached, RuntimeMethodHandleInternal& ctor, Boolean& bNeedSecurityCheck) +0
   System.RuntimeType.CreateInstanceSlow(Boolean publicOnly, Boolean skipCheckThis, Boolean fillCache) +98
   System.RuntimeType.CreateInstanceDefaultCtor(Boolean publicOnly, Boolean skipVisibilityChecks, Boolean skipCheckThis, Boolean fillCache) +241
   System.Activator.CreateInstance(Type type, Boolean nonPublic) +69
   NHibernate.Bytecode.ActivatorObjectsFactory.CreateInstance(Type type) +8
   NHibernate.Connection.ConnectionProvider.ConfigureDriver(IDictionary`2 settings) +127

[HibernateException: Could not create the driver from NHibernate.Driver.MySqlDataDriver, NHibernate, Version=3.3.1.4000, Culture=neutral, PublicKeyToken=aa95f207798dfdb4.]
   NHibernate.Connection.ConnectionProvider.ConfigureDriver(IDictionary`2 settings) +241
   NHibernate.Connection.ConnectionProvider.Configure(IDictionary`2 settings) +86
   NHibernate.Connection.ConnectionProviderFactory.NewConnectionProvider(IDictionary`2 settings) +351
   NHibernate.Cfg.SettingsFactory.BuildSettings(IDictionary`2 properties) +1005
   NHibernate.Cfg.Configuration.BuildSettings() +29
   NHibernate.Cfg.Configuration.BuildSessionFactory() +44
   FluentNHibernate.Cfg.FluentConfiguration.BuildSessionFactory() +49

[FluentConfigurationException: An invalid or incomplete configuration was used while creating a SessionFactory. Check PotentialReasons collection, and InnerException for more detail.

]
   FluentNHibernate.Cfg.FluentConfiguration.BuildSessionFactory() +69
   PTBurner.Models.Nhibernate.NhibernateSessionFactory.GetSessionFactory() in NhibernateSessionFactory.cs:19
   PTBurner.Models.Nhibernate.NhibernateSessionFactoryProvider.CreateInstance(IContext context) in NhibernateSessionFactoryProvider.cs:11
   Ninject.Activation.Provider`1.Create(IContext context) in c:\Projects\Ninject\ninject\src\Ninject\Activation\Provider.cs:38
   Ninject.Activation.Context.Resolve() in c:\Projects\Ninject\ninject\src\Ninject\Activation\Context.cs:157
   Ninject.<>c__DisplayClass10.<Resolve>b__c(IBinding binding) in c:\Projects\Ninject\ninject\src\Ninject\KernelBase.cs:386
   System.Linq.WhereSelectEnumerableIterator`2.MoveNext() +151
   System.Linq.<CastIterator>d__b1`1.MoveNext() +92
   System.Linq.Enumerable.Single(IEnumerable`1 source) +196
   Ninject.ResolutionExtensions.Get(IResolutionRoot root, IParameter[] parameters) in c:\Projects\Ninject\ninject\src\Ninject\Syntax\ResolutionExtensions.cs:37
   PTBurner.Models.Ninject.NhibernateModule.<Load>b__0(IContext context) in Ninject\NhibernateModule.cs:15
   Ninject.Activation.Providers.CallbackProvider`1.CreateInstance(IContext context) in c:\Projects\Ninject\ninject\src\Ninject\Activation\Providers\CallbackProvider.cs:45
   Ninject.Activation.Provider`1.Create(IContext context) in c:\Projects\Ninject\ninject\src\Ninject\Activation\Provider.cs:38
   Ninject.Activation.Context.Resolve() in c:\Projects\Ninject\ninject\src\Ninject\Activation\Context.cs:157
   Ninject.<>c__DisplayClass10.<Resolve>b__c(IBinding binding) in c:\Projects\Ninject\ninject\src\Ninject\KernelBase.cs:386
   System.Linq.WhereSelectEnumerableIterator`2.MoveNext() +151
   System.Linq.Enumerable.SingleOrDefault(IEnumerable`1 source) +4222421
   Ninject.Planning.Targets.Target`1.GetValue(Type service, IContext parent) in c:\Projects\Ninject\ninject\src\Ninject\Planning\Targets\Target.cs:197
   Ninject.Planning.Targets.Target`1.ResolveWithin(IContext parent) in c:\Projects\Ninject\ninject\src\Ninject\Planning\Targets\Target.cs:165
   Ninject.Activation.Providers.StandardProvider.GetValue(IContext context, ITarget target) in c:\Projects\Ninject\ninject\src\Ninject\Activation\Providers\StandardProvider.cs:114
   Ninject.Activation.Providers.<>c__DisplayClass4.<Create>b__2(ITarget target) in c:\Projects\Ninject\ninject\src\Ninject\Activation\Providers\StandardProvider.cs:96
   System.Linq.WhereSelectArrayIterator`2.MoveNext() +85
   System.Linq.Buffer`1..ctor(IEnumerable`1 source) +217
   System.Linq.Enumerable.ToArray(IEnumerable`1 source) +78
   Ninject.Activation.Providers.StandardProvider.Create(IContext context) in c:\Projects\Ninject\ninject\src\Ninject\Activation\Providers\StandardProvider.cs:96
   Ninject.Activation.Context.Resolve() in c:\Projects\Ninject\ninject\src\Ninject\Activation\Context.cs:157
   Ninject.<>c__DisplayClass10.<Resolve>b__c(IBinding binding) in c:\Projects\Ninject\ninject\src\Ninject\KernelBase.cs:386
   System.Linq.WhereSelectEnumerableIterator`2.MoveNext() +151
   System.Linq.Enumerable.SingleOrDefault(IEnumerable`1 source) +4222421
   Ninject.Planning.Targets.Target`1.GetValue(Type service, IContext parent) in c:\Projects\Ninject\ninject\src\Ninject\Planning\Targets\Target.cs:197
   Ninject.Planning.Targets.Target`1.ResolveWithin(IContext parent) in c:\Projects\Ninject\ninject\src\Ninject\Planning\Targets\Target.cs:165
   Ninject.Activation.Providers.StandardProvider.GetValue(IContext context, ITarget target) in c:\Projects\Ninject\ninject\src\Ninject\Activation\Providers\StandardProvider.cs:114
   Ninject.Activation.Providers.<>c__DisplayClass4.<Create>b__2(ITarget target) in c:\Projects\Ninject\ninject\src\Ninject\Activation\Providers\StandardProvider.cs:96
   System.Linq.WhereSelectArrayIterator`2.MoveNext() +85
   System.Linq.Buffer`1..ctor(IEnumerable`1 source) +217
   System.Linq.Enumerable.ToArray(IEnumerable`1 source) +78
   Ninject.Activation.Providers.StandardProvider.Create(IContext context) in c:\Projects\Ninject\ninject\src\Ninject\Activation\Providers\StandardProvider.cs:96
   Ninject.Activation.Context.Resolve() in c:\Projects\Ninject\ninject\src\Ninject\Activation\Context.cs:157
   Ninject.<>c__DisplayClass10.<Resolve>b__c(IBinding binding) in c:\Projects\Ninject\ninject\src\Ninject\KernelBase.cs:386
   System.Linq.WhereSelectEnumerableIterator`2.MoveNext() +151
   System.Linq.Enumerable.SingleOrDefault(IEnumerable`1 source) +4222421
   Ninject.Web.Mvc.NinjectDependencyResolver.GetService(Type serviceType) in c:\Projects\Ninject\ninject.web.mvc\mvc3\src\Ninject.Web.Mvc\NinjectDependencyResolver.cs:56
   System.Web.Mvc.DefaultControllerActivator.Create(RequestContext requestContext, Type controllerType) +51

[InvalidOperationException: An error occurred when trying to create a controller of type 'PTBurner.Controllers.HomeController'. Make sure that the controller has a parameterless public constructor.]
   System.Web.Mvc.DefaultControllerActivator.Create(RequestContext requestContext, Type controllerType) +182
   System.Web.Mvc.DefaultControllerFactory.GetControllerInstance(RequestContext requestContext, Type controllerType) +80
   System.Web.Mvc.DefaultControllerFactory.CreateController(RequestContext requestContext, String controllerName) +74
   System.Web.Mvc.MvcHandler.ProcessRequestInit(HttpContextBase httpContext, IController& controller, IControllerFactory& factory) +232
   System.Web.Mvc.<>c__DisplayClass6.<BeginProcessRequest>b__2() +49
   System.Web.Mvc.<>c__DisplayClassb`1.<ProcessInApplicationTrust>b__a() +13
   System.Web.Mvc.SecurityUtil.<GetCallInAppTrustThunk>b__0(Action f) +7
   System.Web.Mvc.SecurityUtil.ProcessInApplicationTrust(Action action) +22
   System.Web.Mvc.SecurityUtil.ProcessInApplicationTrust(Func`1 func) +124
   System.Web.Mvc.MvcHandler.BeginProcessRequest(HttpContextBase httpContext, AsyncCallback callback, Object state) +98
   System.Web.Mvc.MvcHandler.BeginProcessRequest(HttpContext httpContext, AsyncCallback callback, Object state) +50
   System.Web.Mvc.MvcHandler.System.Web.IHttpAsyncHandler.BeginProcessRequest(HttpContext context, AsyncCallback cb, Object extraData) +16
   System.Web.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +8970356
   System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) +184 
```

mysql版本是5.1

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T09:33:30.883

我猜你在本地安装了 Mysql ADO.Net 提供程序，它包含在 GAC（全局程序集缓存）中。您的房东没有这样做。解决它的最简单方法是在项目的 bin 文件夹中包含 Mysql ADO.Net 提供程序 dll。

# javascript - 如何模拟 jQuery 摇动动画？

> ID：12083004
> 
> 赞同：1
> 
> 时间：2012-08-22T23:57:37.533
> 
> 标签：javascript, jquery

我正在尝试在没有 Flash 的情况下制作一些动画，我需要加载一个徽标，然后在完全停止之前摇动

我需要它在加载时发生（抖动是客户端请求）。

现在，当您单击它时，它可以工作，但我需要它自动运行。

这是我的 JavaScript 代码：

```
$(window).load(function() {
  jQuery.fn.shake = function() {
    this.each(function(i) {
      $(this).css({"position": "absolute"});
      for(var x = 1; x <= 3; x++) {
        $(this).animate({left: 43}, 10)
          .animate({left: 23}, 50)
          .animate({left: 23}, 10)
          .animate({left: 13}, 50)
          .animate({left: 43}, 50)
          .animate({left: 33}, 50)
          .animate({left: 43}, 50);
      }
    });
    return this;
  }

  $("#logo").click(function() {
    $(this).shake();
  });
}); 
```

`#logo`元素是包含图像的 div 。

任何帮助将不胜感激，谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T00:02:33.773

```
<script type='text/javascript'>
    jQuery.fn.shake = function() {
        this.each(function(i) {
            $(this).css({
                "position": "absolute"
            });
            for (var x = 1; x <= 3; x++) {
                $(this).animate({
                    left: 43
                }, 10).animate({
                    left: 23
                }, 50).animate({
                    left: 23
                }, 10).animate({
                    left: 13
                }, 50).animate({
                    left: 43
                }, 50).animate({
                    left: 33
                }, 50).animate({
                    left: 43
                }, 50);
            }
        });
        return this;
    }
    $(document).ready(function() {
        $("#logo").shake();
    });
</script>​​​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T00:00:38.580

如果您需要模拟点击，您可以将其添加到您的代码中：

```
$("#logo").click(); 
```

无论如何，我建议您使用 $(document).ready 而不是 window，因为它允许您在加载文档后让脚本执行。

```
<script type='text/javascript'>//<![CDATA[ $(document).ready(function(){ jQuery.fn.shake = function() { this.each(function(i) { $(this).css({ "position" : "absolute" }); for (var x = 1; x <= 3; x++) { $(this).animate({ left: 43 }, 10).animate({ left: 23 }, 50).animate({ left:23},10).animate({ left: 13 }, 50).animate({ left: 43 }, 50).animate({ left: 33 },50).animate({ left: 43 }, 50); } }); return this; } $("#logo").click(function() { $(this).shake(); }); });//]]> </script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T23:59:28.943

`$("#logo").shake()`在加载功能结束时不起作用？

而不是使用：

```
$("#logo").click(function() {
  $(this).shake();
}); 
```

利用：

```
$("#logo").shake(); 
```

您不必添加`onclick`事件侦听器并模拟点击，您可以直接触发该函数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T00:00:17.577

你实际上应该打电话`$('#logo').shake();`，但你也可以这样做`$('#logo').trigger('click');`

查看[触发](http://api.jquery.com/trigger/)方法的文档。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-23T00:04:56.620

如果您想在不单击 div 的情况下执行此操作，那么为什么要使用该单击处理程序。当页面像这样加载时，您可以这样做：

```
<script type='text/javascript'>//<![CDATA[ 
    $(window).load(function(){

        jQuery.fn.shake = function() {
            this.each(function(i) {
            $(this).css({ "position" : "absolute" });
            for (var x = 1; x <= 3; x++) {
            $(this).animate({ left: 43 }, 10).animate({ left: 23 }, 50).animate({ left:23},10).animate({ left: 13 }, 50).animate({ left: 43 }, 50).animate({ left: 33 },50).animate({ left: 43 }, 50);
                }
            });
            return this;
            }

        $(this).shake();
});//]]>  

</script> 
```

# silverlight - Silverlight DataGrid 在页眉上添加按钮

> ID：12083008
> 
> 赞同：0
> 
> 时间：2012-08-22T23:58:10.003
> 
> 标签：silverlight, datagrid

我有一个 DataGrid 作为 rowDetailTemplate。在这个网格中，我想在标题上添加一个按钮。我制作了以下 XAML 代码

```
 <sdk:DataGridTemplateColumn   >
                                        <sdk:DataGridTemplateColumn.Header>
                                            <DataTemplate>
                                                <Button Content="Row" Height="23" HorizontalAlignment="Left"  VerticalAlignment="Top" Width="30" />
                                            </DataTemplate>
                                        </sdk:DataGridTemplateColumn.Header>
                                         <sdk:DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <Button Content="Del"></Button>
                                            </DataTemplate>
                                        </sdk:DataGridTemplateColumn.CellTemplate>
                                    </sdk:DataGridTemplateColumn> 
```

一切正常，但此列标题。我得到`System.Windows.DataTemplate` 的不是按钮。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T22:04:05.190

最后我通过编译一些答案找到了方法。以下将添加一个带有 header-Body 包含控件的模板列：

```
 <sdk:DataGridTemplateColumn >
          <sdk:DataGridTemplateColumn.HeaderStyle>
              <Style TargetType="sdk:DataGridColumnHeader">
                  <Setter Property="ContentTemplate">
                        <Setter.Value>
                            <DataTemplate>
                                  <Button Content="Row" />
                             </DataTemplate>
                         </Setter.Value>
                  </Setter>
              </Style>
          </sdk:DataGridTemplateColumn.HeaderStyle>
          <sdk:DataGridTemplateColumn.CellTemplate>
              <DataTemplate>
                 <Button Content="Del"  ></Button>
              </DataTemplate>
          </sdk:DataGridTemplateColumn.CellTemplate>
        </sdk:DataGridTemplateColumn> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T15:40:54.010

试试这个下面的链接，这将帮助你 [在 DataGrid 标题中的按钮](http://www.exploresilverlight.com/2012/08/adding-button-in-datagrid-header-in.html)

干杯! 维诺德

# ruby-on-rails - 如何拆分长行的 Ruby

> ID：12083011
> 
> 赞同：48
> 
> 时间：2012-08-22T23:58:29.013
> 
> 标签：ruby-on-rails, ruby, coding-style

我总是在我的 Rails 顶部获得大量的代码`models`。我正在寻找使用标准 Ruby 样式分解它们的最佳方法的建议。例如，我现在正在查看的一行是：

```
delegate :occupation, :location, :picture_url, :homepage_url, :headline, :full_name, :to => :profile, :prefix => true, :allow_nil => true 
```

打破这些长方法调用行的传统风格是什么？

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2014-06-20T01:16:28.243

简短的回答是**视情况而定**。

## 基本

首先，您可以使用“新”Ruby 哈希语法保存几个字符：

```
result = very_long_method_name(something: 1, user: user, flange_factor: 1.34) 
```

对比

```
result = very_long_method_name(:something => 1, :user => user, :flange_factor => 1.34) 
```

## 哈希/数组

有时你需要初始化一个数组或散列，特别是对于散列，最好这样写：

```
args = {
  first_name: "Aldo",
  email: "nospam@mail.example.com",
  age: Float::INFINITY
} 
```

同一行上的相同哈希将是（不那么好）：

```
args = {first_name: "Aldo", email: "nospam@mail.example.com", age: Float::INFINITY} 
```

## 各种方法调用

有些方法需要很多参数，或者这些参数的名称很长：

```
%table
  %thead
    %th
      %td= t("first_name", scope: "activemodel.lazy_model.not_so_active_model", some_interpolation_argument: "Mr.", suffix: "(Jr.)") 
```

在这种情况下，我可能会这样写：

```
%table
  %thead
    %th
      %td= t("first_name",
             scope: "activemodel.lazy_model.not_so_active_model",
             some_interpolation_argument: "Mr.",
             suffix: "(Jr.)") 
```

它仍然不是很漂亮，但我想不那么丑了。

```
class person < ActiveRecord::Base
  validates :n_cars, numericality: {
                       only_integer: true,
                       greater_than: 2,
                       odd: true,
                       message: t("greater_than_2_and_odd",
                                  scope: "activerecord.errors.messages")
                     }
end 
```

同样，它不是地球上最漂亮的代码，但它具有某种结构。

此外，有时您可以使用变量来分割行。这只是一个例子，但基本上你命名事物块（有时在此之后你意识到你实际上可以在一个方法中移动那个块）

```
class person < ActiveRecord::Base
  NUMERICALITY_OPTS = {
    only_integer: true,
    greater_than: 2,
    odd: true,
    message: t("greater_than_2_and_odd", scope: "activerecord.errors.messages")
  }
  validates :n_cars, numericality: NUMERICALITY_OPTS
end 
```

## 块

说到块（闭包）：

```
User.all.map { |user| user.method_name } 
```

可以这样写：

```
User.all.map(&:method_name) 
```

如果您有适当的块，请尝试使用 do-end 而不是花括号：

```
nicotine_level = User.all.map do |user|
  user.smoker? ? (user.age * 12.34) : 0.1234
end 
```

## 有条件的

不要将三元 if 运算符用于复杂的事情：

```
nicotine_level = user.smoker? ? (user.age * 1.234 + user.other_method) : ((user.age - 123 + user.flange_factor) * 0)

if user.smoker?
  nicotine_level = user.age * 1.234 + user.other_method
else
  nicotine_level = (user.age - 123 + user.flange_factor) * 0
end 
```

如果您有这样的复杂 if 语句：

```
if user.vegetarian? && !user.smoker? && (user.age < 25) && (user.n_girlfriends == 0) && (user.first_name =~ /(A|Z)[0-1]+/)
end 
```

在方法中移动东西可能会更好，使东西不仅更短而且更易读：

```
if user.healthy? && user.has_a_weird_name?
  # Do something
end

# in User
def healthy?
  vegetarian? && !smoker? && (age < 25) && (n_girlfriends == 0)
end

def user.has_a_weird_name?
  user.first_name =~ /(A|Z)[0-1]+/
end 
```

## 长弦

Heredoc 是你的朋友......我总是需要谷歌才能获得正确的语法，但一旦你做对了，就会让某些东西更容易阅读：

```
execute <<-SQL
  UPDATE people
  SET smoker = 0
  OK, this is a very bad example.
SQL 
```

## 查询

对于简单的情况，我倾向于这样做：

```
# Totally random example, it's just to give you an idea
def cars_older_than_n_days(days)
  Car.select("cars.*, DATEDIFF(NOW(), release_date) AS age")
     .joins(:brand)
     .where(brand: {country: "German"})
     .having("age > ?", days)
end 
```

有时查询甚至是最糟糕的。如果我使用[squeel](https://github.com/activerecord-hackery/squeel)并且查询很大，我倾向于使用这样的括号：

```
# Again, non-sense query
Person.where {
  first_name = "Aldo" |
  last_name = "McFlange" |
  (
    age = "18" &
    first_name = "Mike" &
    email =~ "%@hotmail.co.uk"
  ) |
  (
    person.n_girlfriends > 1 &
    (
      country = "Italy" |
      salary > 1_234_567 |
      very_beautiful = true |
      (
        whatever > 123 &
        you_get_the_idea = true 
      )
    )
  )
} 
```

我想说，如果可能的话，尽量避免复杂的查询，并将它们分成更小的范围或其他：

```
scope :healthy_users, lambda {
  younger_than(25).
  without_car.
  non_smoking.
  no_girlfriend
}

scope :younger_than, lambda { |age|
  where("users.age < ?", age)
}

scope :without_car, lambda {
  where(car_id: nil)
}

scope :non_smoking, lambda {
  where(smoker: false)
}

scope :no_girlfriend, lambda {
  where(n_girlfriends: 0)
} 
```

这可能是最好的方法。

## 现实

不幸的是，人们倾向于写长线，这很糟糕：

*   长行难以阅读（印刷书籍没有超大页面是有原因的）
*   的确，我们主要使用 2 个屏幕，但是当使用诸如`git diff`从控制台中排长队之类的东西时会很痛苦
*   有时您在屏幕面积较小的 13 英寸笔记本电脑上工作
*   即使我喜欢使用 2 个屏幕，我也喜欢拆分我的编辑器以同时编辑 2 个文件 - 长行迫使我使用水平滚动条（地球上最讨厌的东西）
*   是的，您可以在您的编辑器中启用自动换行，但它仍然不是那么好（恕我直言）

我的编辑器中有一把尺子，这样我就知道何时要越过该行的第 80 个字符。但很少通过几个字符越过这条线，它实际上比拆分它更好。

## 结论

有几种方法可以保持 80 年代以下的线条，并且通常取决于具体情况。长线的问题不仅仅是风格不好，**长线通常是过于复杂的症状**。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-08-23T01:14:14.660

类似于以下内容：

```
delegate :occupation, :location, :picture_url, 
         :homepage_url, :headline, :full_name, 
         :to => :profile, :prefix => true, :allow_nil => true 
```

或者，如果您想突出显示选项哈希（合理的事情）：

```
delegate :occupation, :location, :picture_url, 
         :homepage_url, :headline, :full_name, 
     :to => :profile, :prefix => true, :allow_nil => true 
```

将所有内容放在一行上的想法让我觉得这是一个疯狂的想法，这意味着您必须滚动任意数量才能查看委派的内容。嗯。

我可能也会把东西排列一下，也许按字母顺序排列。

```
delegate :full_name, :headline,   :homepage_url,
         :location,  :occupation, :picture_url,
     :to => :profile, :prefix => true, :allow_nil => true 
```

如果文件没有太多/任何其他实质性内容，我可能会将每个方法符号放在自己的行中，以使编辑更容易。在更大的文件中，我不想为此占用空间。

我从来没有想过这种事情。

*编辑*我想我这样做：/

这些天我可能会按“相似性”对委托方法进行分组，大致如下：

```
delegate :full_name, :headline,
         :location,  :occupation,
         :homepage_url, picture_url,
     to: :profile, prefix: true, allow_nil: true 
```

当值也是一个符号时，我的陪审团坚持使用 1.9 哈希语法；我觉得这看起来很有趣。我也不确定在哪里缩进它——在 IDE 重新格式化期间可能会丢失它，但如果我使用新语法，我有点喜欢上面的样子。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2014-08-26T20:03:30.357

尽管这个问题已经有了两个很好的答案，但我想将未来的读者推荐给[Ruby Style Guide](https://github.com/bbatsov/ruby-style-guide)来解决这些问题。

目前，[源代码布局](https://github.com/bbatsov/ruby-style-guide#consistent-multi-line-chains)部分有大量关于如何在各种情况下换行的信息：

```
# starting point (line is too long)
def send_mail(source)
  Mailer.deliver(to: 'bob@example.com', from: 'us@example.com', subject: 'Important message', body: source.text)
end

# bad (double indent)
def send_mail(source)
  Mailer.deliver(
      to: 'bob@example.com',
      from: 'us@example.com',
      subject: 'Important message',
      body: source.text)
end

# good
def send_mail(source)
  Mailer.deliver(to: 'bob@example.com',
                 from: 'us@example.com',
                 subject: 'Important message',
                 body: source.text)
end

# good (normal indent)
def send_mail(source)
  Mailer.deliver(
    to: 'bob@example.com',
    from: 'us@example.com',
    subject: 'Important message',
    body: source.text
  )
end 
```

```
# bad - need to consult first line to understand second line
one.two.three.
  four

# good - it's immediately clear what's going on the second line
one.two.three
  .four 
```

正如@Aldo 已经提到的，对于过于复杂的代码，它通常是一个“解决方案”：

```
# bad
some_condition ? (nested_condition ? nested_something : nested_something_else) : something_else

# good
if some_condition
  nested_condition ? nested_something : nested_something_else
else
  something_else
end 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-23T01:09:10.107

根据我的经验，似乎惯例实际上并不是为了打破界限。我见过的大多数项目，包括 rails 本身的代码库，似乎对有很长的不间断线路没有问题。

所以我想说如果你想遵循惯例，不要打破界限。如果您决心打破界限，那么就没有广泛遵循的惯例来说明如何做到这一点。您可以使用您喜欢的任何编码风格。

# ruby-on-rails - 选择何时发送确认邮件

> ID：12083012
> 
> 赞同：0
> 
> 时间：2012-08-22T23:58:42.477
> 
> 标签：ruby-on-rails, ruby, devise

我需要选择何时发送确认邮件。我覆盖了 send_confirmation_instructions 并在我的用户模型上添加了一个名为邀请的日期字段。如果受邀字段为空，则发送邮件，否则不发送。

**这是我的代码：**

```
 def send_confirmation_instructions
    unless invited.nil?
      self.confirmation_token = nil if reconfirmation_required?
      @reconfirmation_required = false
      generate_confirmation_token! if self.confirmation_token.blank?
    else
      self.confirmation_token = nil if reconfirmation_required?
      @reconfirmation_required = false
      generate_confirmation_token! if self.confirmation_token.blank?
      self.devise_mailer.confirmation_instructions(self).deliver
    end
  end 
```

**我的控制台的输出是：**

> 加载开发环境 (Rails 3.0.10) 1.9.3-p0 :001 > User.create!(:email => "hello@test.com") NoMethodError: undefined method `reconfirmation_required?' 为了

我已经重写了许多其他设计方法而没有问题。任何想法 ？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T15:20:16.333

最好的解决方案是手动连接到数据库并将字段添加到用户表中。

```
# read configuration from database.yml
config = Rails.application.config.database_configuration[Rails.env]
host = config["host"]
database = config["database"]
username = config["username"]
password = config["password"]

# stablish db connection
mysql = Mysql2::Client.new(:host => host, :username => username, :database => database, :password => password)

# generate devise confirmation token
token = (Digest::MD5.hexdigest "#{ActiveSupport::SecureRandom.hex(10)}-#{DateTime.now.to_s}")

# made the sql
sql = "INSERT INTO users (email, confirmation_token, confirmation_sent_at) VALUES ('email@test.com', '#{token}', '#{Time.now.to_s}')"

# execute query
mysql.query(sql)

# close mysql connection
mysql.close 
```

我希望这会有用。

# asp.net-mvc-3 - MVC3 Html 编码？？Html.TextBoxFor Html.EditorFor

> ID：12083014
> 
> 赞同：0
> 
> 时间：2012-08-22T23:58:56.007
> 
> 标签：asp.net-mvc-3, razor, html-helper

使用 Html.TextBoxFor 或 Html.EditorFor 将类似“hi person”的内容传递到文本框的值中

不幸的是，该值没有被 Html 编码。任何人都可以解释为什么会这样，它在 MVC4 中是否已修复。

我知道您可以执行类似 @Html.TextBox("Description", Server.HtmlDecode(Model.Description)) 的操作，但是是否有一个开箱即用的 Html Helper 实际上只是为您编码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T00:10:39.880

在处理那些 HTML 助手中使用的值时，或者当这些值在 POST 上返回到 Web 服务器时，不需要编码/解码。这一切都由框架处理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T00:10:37.947

`Html.TextBoxFor` *对*值进行 html 编码 - 它使用`TagBuilder`下面的类，该类进行编码。

我不确定您对“hi person”的期望是什么，该字符串中没有任何字符在其编码时会发生变化。

# json - Sencha Touch Store 未加载

> ID：12083015
> 
> 赞同：0
> 
> 时间：2012-08-22T23:59:01.517
> 
> 标签：json, sencha-touch-2

我有一个需要加载 DataView 的商店，直到今天我都使用 Dummy Data，它工作得很好，我想使用网页来加载数据。我的商店代码是：

```
Ext.define("myApp.store.myStore", {
    extend: "Ext.data.Store",
    alias: "widget.myStore",   
    model: "myApp.model.myModel",
    proxy: new Ext.data.HttpProxy({
        type: 'ajax',
        method: 'post',
        url: 'URL'
        }),     
        reader: new Ext.data.JsonReader(
            {
                type:'json',
                rootProperty:'Results'
            }),    

autoLoad: true,
config: {
    sorters: [{ property: 'MyProp', direction: 'ASC'}],
    grouper: {
        sortProperty: "MyOtherProp",
        direction: "ASC",
        groupFn: function (record) {
            if (record && record.data.MyOtherProp) {
                return record.data.MyProp;
            } else {
                return '';
            }

           }
        }

    }
}); 
```

在 Firebug 中，我可以看到结果是 0 个项目（并且 url 有 2 个项目..）我在做什么错？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T00:06:26.810

您可能需要将 URL 设置为特定位置。

# ajax - extjs4 data.store 与代理一起使用

> ID：12083018
> 
> 赞同：0
> 
> 时间：2012-08-22T23:59:22.480
> 
> 标签：ajax, yii, extjs4

我想使用以下代码从 Ext.data.store 中的 Yii 控制器操作中获取数据：

```
var vehicles = new Ext.data.Store({
        reader: new Ext.data.JsonReader({
            fields: ['vehiclename'],
            root: 'vehicles'
        }),
        proxy: new Ext.data.HttpProxy({
            url: '<?php echo $this->createUrl('GetVehicles');?>'
        }),
        autoLoad: true
    }); 
```

或以下车辆代码：

```
var vehicles = Ext.create('Ext.data.Store', {
        fields: [
            {name: 'vehiclename'}
        ],
        proxy: {
            type: 'ajax',
            url: '<?php echo  $this->createUrl('GetVehicles'); ?>',
            reader: {
                type: 'json',
                root:'vehicles'
            }
        },
        autoLoad: true
    }); 
```

我的操作代码是：

```
public function actionGetVehicles()
{
    $sql = "select vehicleName from vehicletbl inner join companytbl on vehicletbl.companyid=companytbl.companyid and companytbl.companyid='2';";
    $vehicles = Yii::app()->db->createCommand($sql)->queryAll();
    //var_dump($vehicles);
    echo '{vehicles:'.json_encode($vehicles).'}';
} 
```

当我使用浏览器地址栏发送操作请求时，我得到以下 json：

```
{vehicles:[{"vehiclename":"pride"},{"vehiclename":"benz"}]} 
```

但我不知道为什么 Ext.data.store 无法获取数据和存储主题！
我的代码有什么问题？
我在以下位置使用商店：

```
items: [treePanel,Ext.create('Ext.grid.PropertyGrid', {
                            title: 'History',
                            closable: false,
                            header: true,
                            sortableColumns: false,
                            customEditors: {
                                Vehicle: Ext.create('Ext.form.ComboBox', {                       
                                    store: vehicles,
                                    queryMode: 'local',
                                    displayField: 'vehiclename'

                                })
                            },
                            /*propertyNames: {
                                'evtStart': 'Start Time'
                            },*/
                            source: {
                                "Vehicle": 'Select Vehicle',
                                "Select Start Date": false,
                                "Select End Date": true
                            }
                        })] 
```

Chrome 开发者工具输出：
![在此处输入图像描述](../Images/7401cf9336bfdb6ed07363a16baf1e60.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T00:27:27.317

您返回的 json 无效。它应该是：

```
{"vehicles":[{"vehiclename":"pride"},{"vehiclename":"benz"}]} 
```

（根周围的引号`vehicles`）。

# android - Android 从 HTML 文件中读取

> ID：12083020
> 
> 赞同：1
> 
> 时间：2012-08-22T23:59:30.580
> 
> 标签：android, html, nullpointerexception

我正在尝试从 url 源读取 html 文件，但出现空指针异常。这是我的代码：

```
public class NetworkThread extends AsyncTask<String, Integer, String> {

    URL url;
    StringBuffer sb;
    InputStream is;

    @Override
    protected String doInBackground(String... arg0) {
        // TODO Auto-generated method stub
        String webUrl = etUrl.getText().toString();
        try {
            url = new URL(webUrl);
            BufferedReader in = new BufferedReader(
            new InputStreamReader(url.openStream()));
            String htmlLine;
            while ((htmlLine = in.readLine()) != null) 
                sb.append(htmlLine);

            in.close();
        } catch (MalformedURLException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
            return "Bad URL";
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
            return "Input / Output";
        } catch (NullPointerException e) {
            e.printStackTrace();
            return "Null";
        }
        return sb.toString();
    }

    @Override
    protected void onPostExecute(String result) {
        // TODO Auto-generated method stub
        super.onPostExecute(result);
        html.setText(result);
    }

} 
```

我尝试在常规 Java 中运行这个程序——对 URL 进行硬编码，它运行良好。

但是，当我在 android 上运行它时，我在 TextView 中收到“Null”消息。

LogCat 说 NullPointerException 来自**sb.append(htmlLine);** .

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T00:07:02.880

你还没有初始化你的 StringBuffer 对象：

```
StringBuffer sb = new StringBuffer(); 
```

您还可以尝试使用此代码从 url 读取内容：

```
public class ReadWebpageAsyncTask extends Activity {
  private TextView textView;

/** Called when the activity is first created. */

  @Override
  public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    textView = (TextView) findViewById(R.id.TextView01);
  }

  private class DownloadWebPageTask extends AsyncTask<String, Void, String> {
    @Override
    protected String doInBackground(String... urls) {
      String response = "";
      for (String url : urls) {
        DefaultHttpClient client = new DefaultHttpClient();
        HttpGet httpGet = new HttpGet(url);
        try {
          HttpResponse execute = client.execute(httpGet);
          InputStream content = execute.getEntity().getContent();

          BufferedReader buffer = new BufferedReader(new InputStreamReader(content));
          String s = "";
          while ((s = buffer.readLine()) != null) {
            response += s;
          }

        } catch (Exception e) {
          e.printStackTrace();
        }
      }
      return response;
    }

    @Override
    protected void onPostExecute(String result) {
      textView.setText(result);
    }
  }

  public void readWebpage(View view) {
    DownloadWebPageTask task = new DownloadWebPageTask();
    task.execute(new String[] { "http://www.stackoverflow.com" });

  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T00:03:12.430

> LogCat 说 NullPointerException 来自`sb.append(htmlLine);`.

`sb`为空，因为您从未初始化它。尝试添加：

```
StringBuffer sb = new StringBuffer(); 
```

# jquery - 我可以从带有查询字符串的 url 执行 .load 吗？

> ID：12083024
> 
> 赞同：1
> 
> 时间：2012-08-23T00:00:18.173
> 
> 标签：jquery, load

我对 jQuery 的 .load 功能并不十分熟悉，但如果我能做 url 中的内容，那就太酷了。

基本上，我有一个 PHP 循环，每页循环 10 条内容。这是基于查询字符串

`http://domain.com/page/?offSet=0&rpp=10`

将加载 10 个最新的内容位 (rpp=10)

`http://domain.com/page/?offSet=10&rpp=10`

这会加载内容 11-20（注意 offset=10）。偏移 20 将产生 21-30 等。

基本上 - 我在底部有一些链接，它们使用 PHP 数学来确定当前偏移量并加 10 或减 10。

目前，他们重新加载整个页面（总）。我可以将 .load 与查询字符串一起使用来获取包含其他内容的容器 div 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T00:23:07.203

是的，你可以这么做。您可以在 URL 之后添加一个选择器，以仅指示要插入当前页面容器的已加载 HTML 的哪一部分。

例如：

```
$('#myGridOfData').load('/page/?offSet=10&rpp=10 #container'); 
```

这只会将`#container`您加载的资源中的内容加载到`#myGridData`.

有关详细信息，请参阅 jQuery [API 。](http://api.jquery.com/load/)

# php - 安装了梨的 ubuntu 服务器 12.04 上的 Xampp 在尝试使用 php mail() 时返回错误

> ID：12083025
> 
> 赞同：0
> 
> 时间：2012-08-23T00:00:19.627
> 
> 标签：php, xampp, pear, postfix-mta, lampp

我试图让 php 在创建帐户时向新用户发送激活电子邮件。我的问题不在于此过程的代码，而在于 php 发送电子邮件。

到目前为止，我已经在安装了 Kubuntu 桌面的 Ubuntu 服务器 12.04 上安装了 Xampp。我还使用该`sudo apt-get install php-pear`命令安装了 pear。

最后我安装了postfix。当我在浏览器中加载我的页面时，我收到以下错误：

> 不推荐使用：在第 55 行的 /opt/lampp/lib/php/Mail.php 中不推荐使用通过引用分配 new 的返回值
> 
> 不推荐使用：在第 135 行的 /opt/lampp/lib/php/Mail.php 中不推荐使用通过引用分配 new 的返回值
> 
> 严格标准：不应静态调用非静态方法 PEAR::isError()，假设 $this 来自第 167 行 /opt/lampp/lib/php/Mail/smtp.php 中的不兼容上下文
> 
> 严格标准：不应静态调用非静态方法 PEAR::isError()，假设 $this 来自第 290 行 /opt/lampp/lib/php/Net/SMTP.php 中的不兼容上下文
> 
> 严格标准：不应静态调用非静态方法 PEAR::raiseError()，假设 $this 来自第 168 行 /opt/lampp/lib/php/Mail/smtp.php 中的不兼容上下文

感谢您的回复！尽管继承了我的代码，但我仍然遇到一些问题：

```
<?php 
include("Mail.php"); 

$recipients = "noreply.njmedia@gmail.com"; 

$headers["From"]    = "noreply.njmedia@gmail.com"; 
$headers["To"]      = "noreply.njmedia@gmail.com"; 
$headers["Subject"] = "Test message"; 

$body = "TEST MESSAGE!!!"; 

$params["host"] = "smtp.google.com"; 
$params["port"] = "465"; 
$params["auth"] = true; 
$params["username"] = "noreply.njmedia@gmail.com"; 
$params["password"] = "gmailpassword(my real password is entered here)"; 

// Create the mail object using the Mail::factory method 
$mail_object =& Mail::factory("smtp", $params); 

$mail_object->send($recipients, $headers, $body); 
?> 
```

这是调试的结果：

```
object(PEAR_Error)#4 (8) {
  ["error_message_prefix"]=> string(0) ""
  ["mode"]=> int(1)
  ["level"]=> int(1024)
  ["code"]=> NULL
  ["message"]=> string(52) "unable to connect to smtp server smtp.google.com:465"
  ["userinfo"]=> NULL
  ["backtrace"]=> array(3) { [0]=> array(6) { ["file"]=> string(27) "/opt/lampp/lib/php/PEAR.php" ["line"]=> int(533) ["function"]=> string(10) "PEAR_Error" ["class"]=> string(10) "PEAR_Error" ["type"]=> string(2) "->" ["args"]=> array(5) { [0]=> string(52) "unable to connect to smtp server smtp.google.com:465" [1]=> NULL [2]=> int(1) [3]=> int(1024) [4]=> NULL } } [1]=> array(7) { ["file"]=> string(32) "/opt/lampp/lib/php/Mail/smtp.php" ["line"]=> int(169) ["function"]=> string(10) "raiseError" ["class"]=> string(4) "PEAR" ["object"]=> object(Mail_smtp)#1 (10) { ["host"]=> string(15) "smtp.google.com" ["port"]=> string(3) "465" ["auth"]=> bool(true) ["username"]=> string(25) "noreply.njmedia@gmail.com" ["password"]=> string(28) "Fakepasswordforstackoverflow" ["localhost"]=> string(9) "localhost" ["timeout"]=> NULL ["verp"]=> bool(false) ["debug"]=> bool(false) ["sep"]=> string(2) " " } ["type"]=> string(2) "->" ["args"]=> array(1) { [0]=> string(52) "unable to connect to smtp server smtp.google.com:465" } } [2]=> array(7) { ["file"]=> string(32) "/media/HDD2/NJmedia/mailtest.php" ["line"]=> int(23) ["function"]=> string(4) "send" ["class"]=> string(9) "Mail_smtp" ["object"]=> object(Mail_smtp)#1 (10) { ["host"]=> string(15) "smtp.google.com" ["port"]=> string(3) "465" ["auth"]=> bool(true) ["username"]=> string(25) "noreply.njmedia@gmail.com" ["password"]=> string(28) "Fakepasswordforstackoverflow" ["localhost"]=> string(9) "localhost" ["timeout"]=> NULL ["verp"]=> bool(false) ["debug"]=> bool(false) ["sep"]=> string(2) " " } ["type"]=> string(2) "->" ["args"]=> array(3) { [0]=> string(25) "noreply.njmedia@gmail.com" [1]=> array(3) { ["From"]=> string(25) "noreply.njmedia@gmail.com" ["To"]=> string(25) "noreply.njmedia@gmail.com" ["Subject"]=> string(12) "Test message" } [2]=> string(15) "TEST MESSAGE!!!" } } }
  ["callback"]=> NULL
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T11:48:49.263

使用命令：`whereis pear`

它会给你梨的道路。

```
sudo  <the path where Pear is located>  install mail <br/>
sudo  <the path where Pear is located>  install Net_SMTP <br/>
sudo  <the path where Pear is located>  install Auth_SASL <br/>
sudo  <the path where Pear is located>  install mail_mime <br/> 
```

对我来说是

```
sudo /opt/lampp/bin/pear install mail <br/>
sudo /opt/lampp/bin/pear install Net_SMTP <br/>
sudo /opt/lampp/bin/pear install Auth_SASL <br/>
sudo /opt/lampp/bin/pear install mail_mime <br/> 
```

请重新启动您的 XAMP 服务器

启动灯

```
sudo /opt/lampp/lampp start 
```

停止兰普

```
sudo /opt/lampp/lampp stop 
```

谢谢

# javascript - Sencha Touch 2 Slider 产生黑屏

> ID：12083026
> 
> 赞同：0
> 
> 时间：2012-08-23T00:00:23.177
> 
> 标签：javascript, slider, extjs, sencha-touch-2, cordova

当用户单击按钮时，我正在尝试使用 sencha touch 2 为移动设备创建一个垂直“滑块”。我对 Javascript 很陌生，但我已经介绍了基础知识。我尝试按照此处所做的操作：[在 Sencha Touch 中显示/隐藏带有幻灯片动画的工具栏，](https://stackoverflow.com/questions/6618606/show-hide-a-toolbar-with-slide-animation-in-sencha-touch) 但会产生空白屏幕。为什么会出现这种情况？

```
<script type="text/javascript">
        function clicked(id) {
        if(id == "hist"){

    var showAlert = function(btn, event) {
        Ext.Msg.alert('Title', 'Diste ' + event.type + ' en el botón "' + btn.text + '"', Ext.emptyFn);
    };

    var tapHandler = function(button, event) {
        mainPanel.setActiveItem(blue, {type: 'slide'});
    };

    var backHandler = function(button, event) {
        mainPanel.setActiveItem(green, {type: 'slide', direction: 'right'});
    };

    var green = new Ext.Panel({
        dockedItems: [{
            xtype: 'toolbar',
            ui: 'light',
            title: 'My Toolbar',
            items: [{
                text: 'Sobre App',
                ui: 'round',
                handler: showAlert
            }, { xtype:'spacer'}, {
                text: 'Check-in',
                ui: 'forward',
                handler: tapHandler
            }]
        }],
        style: 'background-color:#3b7E3b',
        html: 'Green'
    });

    var blue = new Ext.Panel({
        dockedItems: [{
            xtype: 'toolbar',
            ui: 'light',
            title: 'Check-in',
            items: [{
                text: 'Back',
                ui: 'back',
                handler: backHandler
            }]
        }],
        style: 'background-color:#3b3b7E',
        html: 'Blue'
    });

    var mainPanel = new Ext.Panel({
        layout: 'card',
        fullscreen : true,
        items: [green, blue]
    });
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T02:27:37.233

试试这个

```
var mainPanel,blue,green;

Ext.application({
    launch: function() {
        green = new Ext.Panel({
            items:[
                {
                    xtype:'toolbar',
                    title:'My Toolbar',
                    ui:'light',
                    docked:'top',
                    items: [
                        {
                            text: 'Sobre App',
                            ui: 'round',
                            handler: showAlert
                        },
                        {
                            xtype:'spacer'
                        },
                        {
                            text: 'Check-in',
                            ui: 'forward',
                            handler: tapHandler
                        }
                    ]
                }
            ],
            style: 'background-color:#3b7E3b',
            html: 'Green'
        });

        blue = new Ext.Panel({
            items:[
                {
                    xtype:'toolbar',
                    title:'Check-In',
                    ui:'light',
                    docked:'top',
                    items: [
                        {
                            text: 'Back',
                            ui: 'back',
                            handler: backHandler
                        }
                    ]
                }
            ],
            style: 'background-color:#3b3b7E',
            html: 'Blue'
        });

        mainPanel = new Ext.Panel({
            layout: 'card',
            fullscreen : true,
            items: [green,blue]
        });
        Ext.Viewport.add(mainPanel);
    }
});

var showAlert = function(btn, event) {
    Ext.Msg.alert('Title', 'Diste ' + event.type + ' en el botón "'
            + btn.text + '"', Ext.emptyFn);
};

var tapHandler = function(button, event) {
    mainPanel.animateActiveItem(blue,{type: 'slide'});
};

var backHandler = function(button, event) {
    mainPanel.animateActiveItem(green, {type: 'slide', direction: 'right'});
}; 
```

您的 html 文件应如下所示

```
<!DOCTYPE HTML>
<html manifest="" lang="en-US">
    <head>
        <meta charset="UTF-8">
        <title>Sencha Touch Knob</title>
        <link rel="stylesheet" type="text/css" href="stylesheets/sencha-touch.css">
        </link>
        <script type="text/javascript" src="javascripts/sencha-touch-all-debug.js">  
        </script>
        <script type="text/javascript" src="javascripts/app.js"></script>
    </head>
    <body>
    </body>
</html> 
```

sencha-touch.css,sencha-touch-all-debug.js 文件将随库一起提供。把上面的javascript代码放到一个新的js文件中，命名为app.js。

如果有任何错误，它们将显示在 chrome 开发者工具控制台中。

# python - PyQt：从回调更新 GUI

> ID：12083034
> 
> 赞同：6
> 
> 时间：2012-08-23T00:00:45.443
> 
> 标签：python, multithreading, user-interface, pyqt4

使用 Python3 和 PyQt4，我有一个函数 ( **run** )，它将一个可调用对象作为输入来提供状态更新。

```
class Windows(QtGui.QWidget):
    # Creates a widget containing:
    # - a QLineEdit (status_widget)
    # - a button, connected to on_run_clicked

    def on_run_clicked(self):
        def update(text):
            self.widget.setText(text)

        threading.Thread(target=run, args=(update, )).start() 
```

这工作正常（即文本更新正确显示在小部件中）。但是，当我用 QTextEdit 替换QLineEdit**并****使用**append**方法**添加文本时，我得到：

 ****> QObject::connect: 不能将“QTextCursor”类型的参数排队
> 
> （确保使用 qRegisterMetaType() 注册了“QTextCursor”。）

它仍然有效，但指出我做错了什么，我不确定当更多线程处于活动状态时我会继续工作。通常，我使用信号和插槽进行此类更新，但**运行**函数不是 PyQt 特定的。问题是：

1.  为什么它在没有警告 QLineEdit 而不是 QTextEdit 的情况下工作？
2.  处理这种情况的正确方法是什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-23T01:37:33.730

我不知道一个类有效而另一个无效的具体原因——我也不知道使用 Python 线程与 Qt 线程之间的区别......但是，我可以告诉你，如果你不要正确设置它。也就是说，您不能（或至少不应该）从线程修改 GUI 对象。同样，不确定 python 与 Qt 线程的区别。但是，从 GUI 修改界面的安全方法是向窗口发送信号……我知道的最简单的方法是通过 Qt 线程。

```
class MyThread(QtCore.QThread):
    updated = QtCore.pyqtSignal(str)

    def run( self ):
        # do some functionality
        for i in range(10000):
            self.updated.emit(str(i))

class Windows(QtGui.QWidget):
    def __init__( self, parent = None ):
        super(Windows, self).__init__(parent)

        self._thread = MyThread(self)
        self._thread.updated.connect(self.updateText)

        # create a line edit and a button

        self._button.clicked.connect(self._thread.start)

    def updateText( self, text ):
        self.widget.setText(text) 
```****

# android - EXIF getAttributes 返回 null

> ID：12083041
> 
> 赞同：3
> 
> 时间：2012-08-23T00:02:13.543
> 
> 标签：android, exif

我正在尝试列出与图库中的图像关联的所有 exif 属性。每个 getAttribute() 都返回 null。当我调试和检查 ExifInterface 时，它​​有一个有效文件，当我展开“mAttributes”节点时，“表”包含我正在寻找的所有 EXIF 数据，但“值”、“keySet”和“valuescollection” " 为空。知道我哪里出错了吗？

编辑：也许问题在于我如何获取文件名？我更新了下面的代码以提供更完整的图片。

```
//create an array of thumbnail IDs
String[] ids = {MediaStore.Images.Thumbnails._ID};
//this pulls the file locations
cursor = managedQuery(MediaStore.Images.Thumbnails.EXTERNAL_CONTENT_URI, ids, null, null, MediaStore.Images.Thumbnails.IMAGE_ID);
colIndex = cursor.getColumnIndexOrThrow(MediaStore.Images.Thumbnails._ID);

//at this point we need to target the gridview.
GridView gallery = (GridView) findViewById(R.id.gridView1);
//borrowed an adapter provided in the tutorial at http://mihaifonoage.blogspot.com/2009/09/displaying-images-from-sd-card-in.html
gallery.setAdapter(new ImageAdapter(this));

//now we attach a listener to our gridview.
gallery.setOnItemClickListener(new OnItemClickListener(){
    public void onItemClick(AdapterView parent, View v, int position, long id)
    {
        String[] ids = {MediaStore.Images.Media.DATA};
        cursor = managedQuery(MediaStore.Images.Media.EXTERNAL_CONTENT_URI, ids, null, null, null);
        colIndex = cursor.getColumnIndexOrThrow(MediaStore.Images.Media.DATA);
        cursor.moveToPosition(position);
        String image = cursor.getString(cursor.getColumnIndexOrThrow(MediaStore.Images.Media.DATA));
        ExifInterface clicked = null;
        try {
            clicked = new ExifInterface(image);
    } catch (IOException e) {
            // TODO Auto-generated catch block
        e.printStackTrace();
    }

        if(clicked==null)
        {
        Toast.makeText(getApplicationContext() , "We were not able to load the file." , Toast.LENGTH_LONG).show();
        }
        else
        {
        TextView tv = (TextView) findViewById(R.id.messageCenter);
        String message;
        message = "Latitude: " +  clicked.getAttribute(ExifInterface.TAG_GPS_LATITUDE)  + "\n";
        message += "Longitude: " + clicked.getAttribute(ExifInterface.TAG_GPS_LONGITUDE) + "\n";
        message += "Make: " + clicked.getAttribute(ExifInterface.TAG_MAKE) + "\n"; 
        message += "Model: " + clicked.getAttribute(ExifInterface.TAG_MODEL) + "\n";
        message += "Date/Time: " + clicked.getAttribute(ExifInterface.TAG_DATETIME) + "\n";
        message += "Flash: " + clicked.getAttribute(ExifInterface.TAG_FLASH) + "\n";
        message += "Flocal Length: " + clicked.getAttribute(ExifInterface.TAG_FOCAL_LENGTH) + "\n";
        message += "White Balance: " + clicked.getAttribute(ExifInterface.TAG_WHITE_BALANCE);

        tv.setText(message);
    }
}
}); 
```

这是运行时点击的样子 ![在此处输入图像描述](../Images/9f1a1cef4561a38c2ccc9d6a12a01d64.png)

编辑：我发现调用表中列出的值是有效的。但是，如果我展开 mAttributes.table.[0].value.value 我要查找的其他信息列在 char 数组中。为什么不传递这些信息？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T19:01:39.287

您必须怀疑用于编辑图像的任何软件。即使它只是您用来以不同格式保存它的“查看器”。有些人会破坏 EXIF，有些人会一起剥离它。此外，即使您认为 EXIF 是一种标准，制造商之间也存在很大差异，他们实现和命名标签的精确程度。有一个名为[ExifTool](http://owl.phy.queensu.ca/~phil/exiftool/)的工具，您不仅可以使用它来转储 EXIF，还可以对其进行修改和标准化。也许您可以将其嵌入到您的流程中或从您的代码中调用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T11:33:02.460

有些图片工作正常 - 所以问题是数据，而不是类或我的代码。我怀疑某些设备/应用程序以 ExifInterface 无法解析的非标准方式对其 exif 数据进行编码。

# iphone - AVPlayerLayer中视频帧的实时处理

> ID：12083043
> 
> 赞同：2
> 
> 时间：2012-08-23T00:02:24.763
> 
> 标签：iphone, ios, opengl-es-2.0, avfoundation, video-processing

我需要实时处理来自远程视频的视频帧，并将处理后的帧呈现在屏幕上。

我曾尝试使用 AVAssetReader，但由于 AVURLAsset 正在访问远程 URL，调用`AVAssetReader:initWithAsset`将导致崩溃。

AVCaptureSession 看起来不错，但它适用于相机而不是视频文件（更不用说远程文件）。

因此，我现在正在探索：在 AVPlayerLayer 中显示远程视频，然后使用 GL ES 访问显示的内容。

问题：

1.  如何将 AVPlayerLayer（或一般的 CALayer）转换为 CAEAGLLayer 并使用 读取像素`CVOpenGLESTextureCacheCreateTextureFromImage()`？

2.  还是有其他更好的方法？

注意：性能是一个重要的考虑因素，否则一个简单的屏幕捕获技术就足够了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-20T21:15:58.737

据我所知，Apple 不提供对 h.264 解码器的直接访问，也没有办法解决这个问题。您可以使用的一个 API 是资产接口，您可以在其中给它一个 URL，然后磁盘上的该文件被读取为 CoreVideo 像素缓冲区。您可以尝试从您的 URL 下载，然后一次写入一个新资源（tmp 目录中的文件）一个视频帧。然后，一旦下载完成并且新的 h264 文件被完全写入，关闭写入会话，然后将文件作为资产读取器打开。您将无法使用这种方法进行流式传输，需要先下载整个文件。否则，您可以尝试使用 AVPlayerLayer 方法来查看它是否直接支持流式传输。请注意，纹理缓存逻辑并不容易实现，

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-09-12T19:52:03.280

这现在可以在现代 iOS 上实现。如果你能够用 Core Image 来表示你的实时处理——并且你现在应该能够给予 Core Image 对自定义过滤器的广泛支持——你可以利用它[`AVAsynchronousCIImageFilteringRequest`](https://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&uact=8&ved=2ahUKEwiYqMfBhMzkAhVQjlkKHWLZCr0QFjAAegQIARAB&url=https%3A%2F%2Fdeveloper.apple.com%2Fdocumentation%2Favfoundation%2Favasynchronousciimagefilteringrequest&usg=AOvVaw0BxHpEu1mx2WAIdbCQMeGT)来传递给`AVPlayerItem`每个文档。

如果您宁愿完全手动处理事情，您可以签出[`AVPlayerItemVideoOutput`](https://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&uact=8&ved=2ahUKEwjv3v2khszkAhVLwlkKHSOOBbcQFjAAegQIAhAB&url=https%3A%2F%2Fdeveloper.apple.com%2Fdocumentation%2Favfoundation%2Favplayeritemvideooutput&usg=AOvVaw0ARDz5yPC9I0rxaAqgUEpp)和[`CVMetalTextureCache`](https://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&uact=8&ved=2ahUKEwi44Ie8hszkAhWq1FkKHeqBDasQFjAAegQIAxAB&url=https%3A%2F%2Fdeveloper.apple.com%2Fdocumentation%2Fcorevideo%2Fcvmetaltexturecache-q3j&usg=AOvVaw1PskHYYthsPWWjeSqLN_MM). 使用这些，您可以直接从视频中读取样本缓冲区，并将它们从纹理缓冲池中转换为金属纹理。从那里，你可以对纹理做任何你想做的事情。请注意，使用这种方法，您负责显示生成的纹理（在您自己的 Metal 或 SceneKit 渲染管道中）。

[这是一篇](https://www.invasivecode.com/weblog/metal-video-processing-ios-tvos/)展示这种技术的博客文章。

或者，如果您不想管理自己的渲染管道，您仍然可以使用`AVPlayerItemVideoOutput`抓取样本缓冲区，使用 vImage 和 Core Image 之类的东西处理它们（理想情况下使用基本的 Metal-backed`CIContext`以获得最大性能！），然后将它们发送到[`AVSampleBufferDisplayLayer`](https://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&uact=8&ved=2ahUKEwjYxa_qg8zkAhWnxVkKHUP1D6oQFjAAegQIBhAB&url=https%3A%2F%2Fdeveloper.apple.com%2Fdocumentation%2Favfoundation%2Favsamplebufferdisplaylayer&usg=AOvVaw2tTW40qt1PYFMqwBvftCwP)直接显示在层树中。这样您就可以根据自己的喜好处理帧，并且仍然让 AVFoundation 管理图层的显示。

# css - 修复了 twitter bootstrap 2.0 中的侧边栏导致重叠

> ID：12083050
> 
> 赞同：0
> 
> 时间：2012-08-23T00:03:08.777
> 
> 标签：css, twitter-bootstrap, css-position

当我在这篇文章的最佳答案中遵循所有 3 个选项时： [Fixed sidebar navigation in Fluid twitter bootstrap 2.0](https://stackoverflow.com/questions/9350818/fixed-sidebar-navigation-in-fluid-twitter-bootstrap-2-0/)

侧边栏确实是固定的，但该行中另一个 div（span9）中的内容与侧边栏重叠。当我删除 CSS 添加时，重叠消失了。我已经三重检查了我的 html 以确保现在有挂起的 div 并且一切似乎都检查出来了。

核心引导 CSS 是否发生了实质性变化，还是我遗漏了什么？

这是一个屏幕截图： ![](../Images/d7af6815e13bc1e57e6628a5bc597493.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T22:36:14.773

我通过使用我的评论中提到的偏移类自己解决了这个问题。在引用的问题的答案中未使用它来引用它。感谢大家的帮助/编辑。

# c# - 用 Ninject 拦截。无法加载 IProxyRequestFactory

> ID：12083052
> 
> 赞同：5
> 
> 时间：2012-08-23T00:03:13.073
> 
> 标签：c#, ninject, castle-dynamicproxy, ninject-extensions, ninject-interception

我正在学习使用 Ninject 和 Interceptor 模式。

我有以下拦截器。

```
public class MyInterceptor:IInterceptor
{
    public void Intercept(IInvocation invocation)
    {
        Console.WriteLine("Pre Execute: " + invocation.Request.Method.Name);

        foreach (var param in invocation.Request.Arguments)
        {
            Console.WriteLine("param : " + param);
        }

        invocation.Proceed();

        Console.WriteLine("Post Execute: " + invocation.Request.Method.Name);
        Console.WriteLine("Returned: " + invocation.ReturnValue);
    }
} 
```

并且有一个名为的类`MyClass`，它除了 2 个简单的方法之外什么都没有，它们是虚拟的，以允许拦截器对其进行处理。（两种方法是 Echo 和 double，正如他们的名字所说的那样。）

我通过 NuGet 将 Ninject、Ninject.Extensions.Interception 和 Ninject.Extensions.Interception.DynamicProxy 添加到我的项目中。

添加了以下`using`语句。

```
using Ninject;
using Ninject.Extensions.Interception.Infrastructure.Language;
using Ninject.Extensions.Interception; 
```

我的主要方法，它进行引导看起来像这样。

```
static void Main(string[] args)
    {
        MyClass o = null;

        using (IKernel kernel = new StandardKernel())
        {

            kernel.Bind<MyClass>().ToSelf().Intercept().With(new MyInterceptor());
            o = kernel.Get<MyClass>();
        }

        o.Echo("Hello World!"); // Error
        o.Double(5);
    } 
```

我在指定的行收到以下错误。

```
Error loading Ninject component IProxyRequestFactory
No such component has been registered in the kernel's component container.

Suggestions:
  1) If you have created a custom subclass for KernelBase, ensure that you have  properly
     implemented the AddComponents() method.
  2) Ensure that you have not removed the component from the container via a call to RemoveAll().
  3) Ensure you have not accidentally created more than one kernel.. 
```

谁能告诉我我做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T00:34:41.373

好的，我终于能够重现（忘记将 MyClass 方法设为虚拟）。我解决它的方法是从内核周围删除 using 块：

```
 static void Main(string[] args)
    {
        MyClass o = null;

        var kernel = new StandardKernel();
        kernel.Bind<MyClass>().ToSelf().Intercept().With(new MyInterceptor());
        o = kernel.Get<MyClass>();

        o.Echo("Hello World!"); // Error
        o.Double(5);
        Console.ReadKey(true);
    } 
```

我**猜**这行得通的原因是因为它在幕后为它创建了一个代理类，`MyClass`并以某种方式传递`IKernel`给代理。当您调用该方法（在代理上）时，它会返回内核并解决一些额外的依赖关系（包括`IProxyRequestFactory`. 由于您正在处理它，它不再能够解决这种依赖关系。

# java - 如何在java中获取两个日期之间的日期列表？如何也包括/排除开始日期/结束日期？

> ID：12083053
> 
> 赞同：2
> 
> 时间：2012-08-23T00:03:13.577
> 
> 标签：java, jodatime

我已经尝试了堆栈溢出中给出的示例 [如何在java中获取两个日期之间的日期列表](https://stackoverflow.com/questions/2689379/how-to-get-a-list-of-dates-between-two-dates-in-java)

该代码完美运行。但是有一个小问题。我的列表中也没有结束日期。如何选择包含/排除开始日期并包含结束日期？我可以通过使用 remove() 和 add() 手动执行此操作，还是 Joda API 可以为我执行此操作？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T00:06:21.007

基于[API](http://joda-time.sourceforge.net/apidocs/org/joda/time/Days.html)，似乎没有直接的方法来选择包含。

一个技巧可能是，只需将 +1 添加到天数。

```
List<LocalDate> dates = new ArrayList<LocalDate>();
int days = Days.daysBetween(startDate, endDate).getDays()+1;
for (int i=0; i < days; i++) {
    LocalDate d = startDate.withFieldAdded(DurationFieldType.days(), i);
    dates.add(d);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-02-20T07:26:02.397

# c++ - 是否可以以编程方式使 OS X 中的 dlopen() 返回 NULL？

> ID：12083056
> 
> 赞同：1
> 
> 时间：2012-08-23T00:03:26.740
> 
> 标签：c++, c, macos, dylib

我们称它为 x.dylib。我只希望有时加载 x.dylib。

在 dylib 的初始化中，有什么方法可以设置一些逻辑，导致尝试加载 x.dylib 的 dlopen() 调用无法加载 x.dylib 并返回 NULL？

重命名 x.dylib 不是一种选择。

我浏览了[http://opensource.apple.com/source/dyld/dyld-210.2.3/src/dyldAPIs.cpp](http://opensource.apple.com/source/dyld/dyld-210.2.3/src/dyldAPIs.cpp)但我不熟悉代码。

我想也许这会做到：

```
__attribute__((constructor))                                                   
void initializer(void) {                                                       
    fprintf(stderr, "initializer\n");                                          
    throw;                                                                     
} 
```

但是当我使用该初始化程序在 dylib 上调用 dlopen() 时，我只是得到“ `initializer terminate called without an active exceptionAbort trap: 6`”

所以我很难过；任何帮助都会很棒。

编辑：使用 gdb 查看时的堆栈跟踪如下：

```
Program received signal SIGABRT, Aborted.
0x00007fff9128a82a in __kill ()
(gdb) bt
#0  0x00007fff9128a82a in __kill ()
#1  0x00007fff93539a9c in abort ()
#2  0x00007fff987f07bc in abort_message ()
#3  0x00007fff987edfcf in default_terminate ()
#4  0x00007fff987ee001 in safe_handler_caller ()
#5  0x00007fff987ee05c in std::terminate ()
#6  0x00007fff987ef152 in __cxa_throw ()
#7  0x0000000100003eb5 in initializer ()
#8  0x00007fff5fc0fda6 in __dyld__ZN16ImageLoaderMachO18doModInitFunctionsERKN11ImageLoader11LinkContextE ()
#9  0x00007fff5fc0faf2 in __dyld__ZN16ImageLoaderMachO16doInitializationERKN11ImageLoader11LinkContextE ()
#10 0x00007fff5fc0d2e4 in __dyld__ZN11ImageLoader23recursiveInitializationERKNS_11LinkContextEjRNS_21InitializerTimingListE ()
#11 0x00007fff5fc0d27d in __dyld__ZN11ImageLoader23recursiveInitializationERKNS_11LinkContextEjRNS_21InitializerTimingListE ()
#12 0x00007fff5fc0e0b7 in __dyld__ZN11ImageLoader15runInitializersERKNS_11LinkContextERNS_21InitializerTimingListE ()
#13 0x00007fff5fc034dd in __dyld__ZN4dyld24initializeMainExecutableEv ()
#14 0x00007fff5fc0760b in __dyld__ZN4dyld5_mainEPK12macho_headermiPPKcS5_S5_ ()
#15 0x00007fff5fc01059 in __dyld__dyld_start () 
```

来自：

*   [http://opensource.apple.com/source/dyld/dyld-210.2.3/src/dyld.cpp](http://opensource.apple.com/source/dyld/dyld-210.2.3/src/dyld.cpp)
*   [http://opensource.apple.com/source/dyld/dyld-210.2.3/src/ImageLoader.cpp](http://opensource.apple.com/source/dyld/dyld-210.2.3/src/ImageLoader.cpp)
*   [http://opensource.apple.com/source/dyld/dyld-210.2.3/src/ImageLoaderMachO.cpp](http://opensource.apple.com/source/dyld/dyld-210.2.3/src/ImageLoaderMachO.cpp)

我很惊讶我没有在堆栈跟踪中看到 dlopen() 。

# wpf - 当前项目与组合框的绑定

> ID：12083058
> 
> 赞同：1
> 
> 时间：2012-08-23T00:03:53.850
> 
> 标签：wpf, icollectionview

我有以下 XAML

```
<TextBox Text="{Binding MyView/Name}" />
<ComboBox ItemsSource="{Binding States}" SelectedItem="{Binding MyView/State}"/> 
```

其中 MyView 是 ICollectionView，具有 Name 和 State 属性。该控件显示了正确的名称和状态，但是当我编辑组合框时，State 上的设置器永远不会被调用。

关于我在这里缺少什么的任何想法？

# html - Html5 MP4 文件大小未知流式传输。最好的方法？

> ID：12083063
> 
> 赞同：0
> 
> 时间：2012-08-23T00:04:47.697
> 
> 标签：html, streaming, h.264, rtp, ogg

是否可以创建没有大小的 mp4 文件/容器。

我正在使用媒体基础将一些文件转换为 h264/acc 并将其包装在 mp4 周围。发生的情况是，随着文件完成，编码器会增加文件的大小。

我需要在编码器开始编码数据后立即开始流式传输。

客户端将进行渐进式下载。

这是否可行。当然我使用的是 html5 所以 rtp/rtsp 是不可能的。

或者 Ogg/Theora 是更好的方法吗？我们需要知道文件大小还是可以直接流式传输它？我知道每个浏览器都有不同的解码器。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T07:41:45.477

是否有可能在 mp4 的标题中撒谎？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-26T16:25:50.283

这里的问题是如果没有完全编写原子，您将无法获得可播放的 mp4。[所有块的确切大小和位置]。所以你的第一个问题的答案是否定的。你不能用 mp4 做到这一点。传输流是最好的方法。我没有尝试过 Ogg/theora，所以不知道，但是可以立即流式传输 ts。

如果您需要一个适用于所有浏览器的解决方案，那就有点麻烦了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-26T20:37:21.683

我想我不明白你在做什么，但我流式传输 mp4 并且它在现代浏览器中运行良好。只有 IE9 与它作斗争，并且不会像您期望的那样播放。Ogg 文件也可以正常工作。

我发现用任何转换器编码的 mp4 也可以在任何现代浏览器中正常工作，但我需要使用手刹让它们在 IE9 中工作。仍然没有弄清楚为什么，微软也没有人知道这两个原因，因为我几乎在任何地方都问过这个问题而没有回应。

# mysql - Codeigniter query not working

> ID：12083066
> 
> 赞同：0
> 
> 时间：2012-08-23T00:05:05.067
> 
> 标签：mysql, codeigniter

I have tried to fix the query but it still doesn't work

This is the error:

> Error Number: 1064
> 
> You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'INSERT INTO user_notifications (`id,` usr_id`,` notification_message`,` sender`,' at line 3
> 
> 从 account_requests 中删除，其中`usrs_id`= '' AND `account_requesting`= '2'；INSERT INTO user_notifications ( `id,` usr_id `,` notification_message `,` sender `, show,` date `) VALUES (NULL, '', 'Successful account upgrade. You are now a Tutor', 'Codeg Account Wizard', 1, CURDATE()); INSERT INTO usrs_acc_type (`usr_usr_id `,` account_type_type_id `) VALUES (, 2); UPDATE` transaction `SET`order_status `= 'Completed' WHERE`usr_id `= AND`purchase_type `= 'Account Upgrade' AND`order_status `= 'Pending' AND`item` = 'Tutor Account';
> 
> 文件名：C:\Users\Supremekhaoz\Downloads\Dropbox\htdocs\codeg\system\database\DB_driver.php
> 
> 行号：330

查询：

```
DELETE FROM account_requests WHERE `usrs_id` = '$usr_id' AND `account_requesting` = '$type_id'; 

INSERT INTO user_notifications (`id, `usr_id`, `notification_message`, `sender`, show, `date`) VALUES (NULL, '$usr_id', 'Successful account upgrade. You are now a $type', 'Codeg Account Wizard', 1, CURDATE()); 

INSERT INTO usrs_acc_type (`usrs_usr_id`, `account_type_type_id`) VALUES ($usr_id, $type_id);

UPDATE `transaction` SET `order_status` = 'Completed' WHERE `usr_id` = $usr_id AND `purchase_type` = 'Account Upgrade' AND `order_status` = 'Pending' AND `item` = '$type Account'; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T02:30:09.937

如果您使用的是 codeigniter 为什么不尝试活动记录

```
$data = array(
   'id' => NULL ,
   'usr_id' => $usr_id ,
   'notification_message' => 'Successful account upgrade. You are now a '.$type,
   'sender' => 'Codeg Account Wizard',
   'show' => 1,
   'date' => time()
);

$this->db->insert('user_notifications', $data); 
```

并检查你`$usr_id`的价值，我认为它没有价值

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-05-11T10:00:00.203

```
$this->db->where('usrs_id',$usr_id);
$this->db->where('account_requesting',$type_id);
$this->db->delete('account_requests '); 
```

您可以使用此代码删除

# cocoa - 修改 NSArrayController 对象的值会导致错误

> ID：12083068
> 
> 赞同：1
> 
> 时间：2012-08-23T00:05:10.417
> 
> 标签：cocoa, nsarraycontroller, key-value-coding

我有一个 NSArrayController，我正在尝试修改所选对象的值。我在用

```
[[[ideasListController selectedObjects] objectAtIndex:0] setValue:@"test" forKey:@"title"]; 
```

尝试更改标题，但这会导致错误：

```
[<__NSDictionaryI 0x10065e6c0> setValue:forUndefinedKey:]:
this class is not key value coding-compliant for the key title. 
```

我对 Cocoa 和 Objective-C 还很陌生，所以我担心我可能会在这里遗漏一些相当明显的东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T04:37:30.627

您的字典是不可变的（这就是 <__NSDictionaryI 0x10065e6c0> 中的“I”的含义），这就是为什么在尝试更改它时会收到错误消息的原因。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T00:13:42.770

尝试这个：

```
[ideasListController insertObject:[NSDictionary dictionaryWithObject:@"test" forKey:@"title"] atArrangedObjectIndex:0]; 
```

**更新：**

```
NSMutableDictionary *dict = [[NSMutableDictionary alloc] init];

[dict setObject:[NSString stringWithFormat:@"test"] forKey:@"title"];

[ideasListController insertObject:dict atArrangedObjectIndex:0];

[dict release];

NSLog(@"%@", [[ideasListController selectedObjects] objectAtIndex:0]); 
```

# c++ - C++ 向量和错误“没有重载函数的实例”

> ID：12083070
> 
> 赞同：1
> 
> 时间：2012-08-23T00:05:30.137
> 
> 标签：c++, vector

我定义了一个简单的类

```
#pragma once
#include "aSuit.h";
class Card
{
private:
    aSuit theSuit;
public:
    Card(void);
    ~Card(void);
    aSuit getSuit();
    void setSuit(aSuit theSuit);
}; 
```

然后我定义了一个向量

```
vector<Card> theCards; 
```

然后我想用

```
theCards.push_back(new Card()); 
```

我去编译错误“没有重载函数的实例”。

vector.push_back 使用字符串向量，但不适用于我定义的类。我正在使用 Visual C++ 2010。请帮忙。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-23T00:07:06.327

```
vector<Card> theCards; 
```

这将创建一个向量`Card`。

```
theCards.push_back(new Card()); 
```

这假定您有一个“指向`Card`”的向量。

“指向”`Card`的指针和“ `Card`”**不是**一回事。你的意思是：

```
theCards.push_back(Card()); 
```

# sql-server - T-SQL SELECT 查询返回多个表的组合结果

> ID：12083079
> 
> 赞同：0
> 
> 时间：2012-08-23T00:07:04.157
> 
> 标签：sql-server, sql-server-2008, tsql

我想知道是否有可能并且更有效地做一些我目前在代码中做的事情，而不是在 T-SQL 中做。

我有一个包含课程的数据库。每门课程可以有不同的课程，这些课程是在不同地点和不同奖项的课程的变体。

这是我的（简化的）数据库结构和一些示例数据：

```
CREATE TABLE tblCourse (CourseId int, CourseName varchar(50))
CREATE TABLE tblOffering (OfferingId int, CourseId int, LocationId int, AwardId int)
CREATE TABLE tblLocation (LocationId int, LocationName varchar(50))
CREATE TABLE tblAward (AwardId int, AwardName varchar(50))

INSERT INTO tblCourse VALUES (1, 'Course A')
INSERT INTO tblCourse VALUES (2, 'Course B')

INSERT INTO tblOffering VALUES (1, 1, 1, 1)
INSERT INTO tblOffering VALUES (2, 1, 2, 1)
INSERT INTO tblOffering VALUES (3, 1, 3, 1)
INSERT INTO tblOffering VALUES (4, 1, 1, 2)
INSERT INTO tblOffering VALUES (5, 2, 3, 1)

INSERT INTO tblLocation VALUES (1, 'Location A')
INSERT INTO tblLocation VALUES (2, 'Location B')
INSERT INTO tblLocation VALUES (3, 'Location C')

INSERT INTO tblAward VALUES (1, 'Award A')
INSERT INTO tblAward VALUES (2, 'Award B') 
```

我想从 SQL 中检索的是每个课程/奖励组合的单行。每行都有每个位置的列，以及该 CourseId/AwardId 组合的课程是否可用。现在将有没有提供的课程/奖励组合的行。

来自示例数据的所需结果将是这样的记录集：

```
CourseId | CourseName | AwardId | AwardName | LocationA | LocationB | LocationC
---------+------------+---------+-----------+-----------+-----------+----------
1        | Course A   | 1       | Award A   | True      | True      | True
1        | Course A   | 2       | Award B   | True      | NULL      | NULL
2        | Course B   | 1       | Award A   | NULL      | NULL      | True 
```

（NULL 也可能是 False）

目前，我正在做一个带有各种 JOINS 的简单 SELECT 语句，它为每个课程/奖励组合提供了多行，然后我遍历代码中的所有行并构建所需的结果。但是，我认为这不是那么有效，因为我还需要对结果进行分页。

我想我可以通过创建一个临时表和一堆单独的查询在存储过程中相当容易地做到这一点，但我认为这不会太有效。想知道在 T-SQL 中是否有更好的方法？

所以澄清一下，我正在寻找的是一个 T-SQL 查询或存储过程，它将产生上述示例记录集，并且我可以调整分页。

注意。我正在使用 SQL Server 2008

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T01:49:23.430

对于动态列：

```
DECLARE  @COLUMNS VARCHAR(max)
        ,@query varchar(1024)
        ,@True varchar(6)

SELECT @COLUMNS = 
COALESCE(
@Columns + ',[' + L.LocationName + ']',
'[' + L.LocationName +']'
)
FROM tblLocation L

SELECT @True = '''True'''

SELECT @QUERY = 'SELECT C.CourseName
                 ,A.AwardName
                 , pvt.*
FROM (SELECT O.OfferingID AS OID
            ,O.AwardID AS AID
            ,O.CourseID AS CID
            ,L.LocationName AS LID
       FROM tblOffering O Inner Join tblLocation L on L.LocationID = O.LocationID) AS S
PIVOT
(
    count(oID) For LID IN (' +@COLUMNS+ ')
) As pvt
inner join tblCourse C on C.CourseID = CID
inner join tblAward A on A.AwardID = pvt.AID'

EXEC (@QUERY)
GO 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-23T01:48:26.973

这将生成示例结果的分页版本：

```
declare @tblCourse as table (CourseId int, CourseName varchar(50)) 
declare @tblOffering as table (OfferingId int, CourseId int, LocationId int, AwardId int) 
declare @tblLocation as table (LocationId int, LocationName varchar(50))
declare @tblAward as table (AwardId int, AwardName varchar(50)) 

INSERT INTO @tblCourse VALUES (1, 'Course A') 
INSERT INTO @tblCourse VALUES (2, 'Course B') 

INSERT INTO @tblOffering VALUES (1, 1, 1, 1) 
INSERT INTO @tblOffering VALUES (2, 1, 2, 1) 
INSERT INTO @tblOffering VALUES (3, 1, 3, 1) 
INSERT INTO @tblOffering VALUES (4, 1, 1, 2) 
INSERT INTO @tblOffering VALUES (5, 2, 3, 1) 

INSERT INTO @tblLocation VALUES (1, 'Location A') 
INSERT INTO @tblLocation VALUES (2, 'Location B') 
INSERT INTO @tblLocation VALUES (3, 'Location C') 

INSERT INTO @tblAward VALUES (1, 'Award A') 
INSERT INTO @tblAward VALUES (2, 'Award B') -- This had id 1 in your example.

-- Set the following parameters to control paging:
declare @PageSize as Int = 5
declare @PageNumber as Int = 1

; with CourseAwardSummary as (
  select distinct C.CourseId, C.CourseName, A.AwardId, A.AwardName,
    case when exists ( select 42 from @tblOffering where CourseId = C.CourseId and AwardId = A.AwardId and LocationId = 1 ) then 'True' end as LocationA,
    case when exists ( select 42 from @tblOffering where CourseId = C.CourseId and AwardId = A.AwardId and LocationId = 2 ) then 'True' end as LocationB,
    case when exists ( select 42 from @tblOffering where CourseId = C.CourseId and AwardId = A.AwardId and LocationId = 3 ) then 'True' end as LocationC
  from @tblCourse as C inner join
    @tblOffering as O on O.CourseId = C.CourseId inner join
    @tblAward as A on A.AwardId = O.AwardId
    ),
  CourseAwardSummaryRows as (
    select *, Row_Number() over ( order by CourseName, AwardName ) as RowNumber
      from CourseAwardSummary
    )
    select CourseId, CourseName, AwardId, AwardName, LocationA, LocationB, LocationC
  from CourseAwardSummaryRows
  where ( @PageNumber - 1 ) * @PageSize + 1 <= RowNumber and RowNumber <= @PageNumber * @PageSize
  order by CourseName, AwardName 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T01:55:10.757

以下查询通过连接和聚合提供表，然后将结果连接到课程表和奖励表来完成此操作：

```
select c.CourseId, c.CourseName, oa.AwardId, oa.AwardName,
       oa.LocationA, oa.LocationB, oa.LocationC
from tblCourse c left outer join
     (select o.CourseId, o.AwardId, a.awardName
             max(case when LocationName = 'Location A' then 'true' end) as LocationA,
             max(case when LocationName = 'Location B' then 'true' end) as LocationB,
             max(case when LocationName = 'Location C' then 'true' end) as LocationC
      from tblOffering o join
           tblLocation l
           on o.LocationId = l.LocationId join
           tblAward a
           on a.awardID = o.AwardId
      group by o.CourseId, o.AwardId, a.awardName
     ) oa
     on oa.CourseId = c.CourseId 
```

# python - 我将如何编写一个用我的 sqlite3 数据库填充的 CSV 文件？

> ID：12083081
> 
> 赞同：4
> 
> 时间：2012-08-23T00:07:21.397
> 
> 标签：python, django, csv, sqlite

我对如何使用我的 models.py 中给定用户的信息填充以下 csv 函数有点困惑。谁能指出我正确的方向？我需要在单独的 py 文件中处理信息，还是可以在我的视图中处理？

我对下载信息的看法

```
def download(request):
    response = HttpResponse(mimetype='text/csv')
    response['Content-Disposition'] = 'attachment; filename=UserData.csv'
    writer = csv.writer(response)
    writer.writerow(['Date', 'HighBGL', 'LowBGL', 'Diet', 'Weight', 'Height', 'Etc'])
    writer.writerow(['Info pertaining to date 1'])
    writer.writerow(['info pertaining to date 2'])
    return response 
```

我感兴趣的信息模型之一

```
class DailyVital(models.Model):
    user =  models.ForeignKey(User)
    entered_at = models.DateTimeField()
    high_BGL = models.IntegerField()
    low_BGL = models.IntegerField()
    height = models.IntegerField(blank = True, null = True)
    weight = models.IntegerField(blank = True, null = True) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T02:31:42.203

首先，您需要查询您的 django 模型，例如：`DailyVital.objects.all()`或`DailyVital.objects.filter(user=request.user)`

然后，您可以手动将对象转换为元组，也可以使用带有字段名称列表的 Django 方法来返回元组而不是`QuerySet`对象[`values_list`。](https://docs.djangoproject.com/en/dev/ref/models/querysets/#values-list)就像是：

```
def download(request):
    response = HttpResponse(mimetype='text/csv')
    response['Content-Disposition'] = 'attachment; filename=UserData.csv'
    writer = csv.writer(response)
    writer.writerow(['Date', 'HighBGL', 'LowBGL', 'Weight', 'Height'])
    query = DailyVital.objects.filter(user=request.user)
    for row in query.values_list('entered_at', 'high_BGL', 'low_BGL', 'weight', 'height'):
       writer.writerow(row)
    return response 
```

如果你在 Django 中不需要它，你也可以考虑`sqlite3`命令行程序的`-csv`选项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T02:18:43.520

一种简单的方法是将模型转换为列表列表。

首先你需要一个对象来列出函数：

```
def object2list(obj, attr_list):
    " returns values (or None) for the object's attributes in attr_list"
    return [getattr(obj, attr, None) for attr in attr_list] 
```

然后你只需将它传递给带有列表理解的 csvwriter（给定一些`list_of_objects`你查询过的）

```
attr_list = ['date', 'high_BGL', 'low_BGL', 'diet', 'weight', 'height']

writer.writerows([object2list(obj, attr_list) for obj in list_of_objects]) 
```

# ipad - 我可以在 ViewController 中有多个隐藏视图吗？

> ID：12083082
> 
> 赞同：0
> 
> 时间：2012-08-23T00:07:37.903
> 
> 标签：ipad, menu, subview

我知道，这似乎是一个糟糕的解决方案，但我想不出或想出如何让事情变得更好。我需要做的就像一个菜单，iPad 菜单，上下都有一个工具栏，背景中有一个图像。在底部工具栏中，我将有 4 个不同的按钮。每个按钮都将在屏幕中间创建选项菜单。一个按钮需要显示 3 个选项（带有图像的按钮），另外 4 个选项，另外 8 个选项（为此，我将使用 Scroll View 和 Page Control，因为我需要 2 个页面），另外 2 个选项. 我试图使用子视图，每个按钮一个子视图，我在子视图中添加了选项。当我选择一个按钮时，它的子视图被加载，但是当我试图改变它的位置和大小时，它的按钮被错过了，子视图是空的......现在我 m 将在 ViewController 中有 4 个子视图，但被隐藏。当我选择一个按钮时，该视图将出现，而其他视图将被隐藏。这意味着，所有子视图都将被加载。这方便吗？这种方法需要很多内存吗？如果有人有另一个更好的解决方案，我将不胜感激......谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T00:45:26.733

是的，您可以在视图控制器中拥有多个隐藏的子视图，但我认为这不是最实用的方法。

您提到菜单将出现在屏幕中央。在这种情况下，我认为更好的方法是为每个菜单创建一个单独的视图控制器，然后让主视图控制器使用视图控制器的`modalPresentationStyle`属性以模态方式呈现它们。通过这样做，您不必编写代码来检查哪些视图是隐藏的，哪些是不隐藏的，从而为自己节省了大量时间；你让 API 完成它的工作，所以你最多需要实现一些方法，比如`dismissModalViewControllerAnimated:`.

查看 Apple[关于 UIViewController 的文档](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIViewController_Class/Reference/Reference.html)，更具体地说，是名为“呈现另一个视图控制器的内容”的部分。

# git - 您合并的 Git 分支是否成为您合并的 Git 分支的一部分？

> ID：12083084
> 
> 赞同：2
> 
> 时间：2012-08-23T00:08:12.833
> 
> 标签：git

，假设我有一个“master”Git 分支和一个“master”分支。

```
master    A -> B -> C -> D
feature        B -> E -> F -> G 
```

我将“功能”合并到“主”中，即合并，而不是变基：

```
master    A -> B -> C -> D -> H 
```

现在该功能的整个提交历史（无论是概念上还是实际上）是否都成为 master 历史的一部分，因为 H 将有两个父级：D 和 G，因此您可以从 master 的尖端（即“H”）到达所有提交 A 到 H 包括在内？

所以现在真正的主人是：

```
master A -> B -> C -> D -> H
            \             /
              E -> F -> G 
```

在我看来，这似乎与 CVS/SVN 分支不同，在我将功能分支合并到主分支之后，我实际上并不认为功能分支是主分支历史的一部分。我认为 Git 中“分支”的概念与 CVS/SVN 分支以这种方式不同的想法是否正确 - 显然它们的实现是完全不同的，但它是分支的概念，以这种方式与合并有关在功能分支中，使该分支现在成为主分支历史的一部分，包括对分支的所有临时提交/签入，CVS/SVN 和 Git 之间相同还是不同？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T00:10:23.183

是的，添加了历史记录。

是的，在分支、分叉和克隆方面，git 与 SVN 完全不同。

更多信息在：[git branch、fork、fetch、merge、rebase 和 clone，有什么区别？](https://stackoverflow.com/questions/3329943/what-is-the-difference-between-branch-fork-and-clone-in-git/9204499#9204499)

# function - lua post 挂钩一个函数

> ID：12083085
> 
> 赞同：0
> 
> 时间：2012-08-23T00:08:25.040
> 
> 标签：function, lua, hook

我找到了一个关于 post hooking 的主题，但我认为这与我想要完成的事情不同。 [我发现的话题](https://stackoverflow.com/questions/11961442/post-hook-a-function-post-process-and-pass-through-all-returns)

我需要的是以下内容：

```
local someBoolean = false
function doSomething() -- this is the function used in __index in a proxy table
  someBoolean = true
  return aFunction -- this is function that we can NOT alter
end 
```

我需要能够在返回后运行代码“someBoolean = false”......（是的，我知道这不应该发生：p）考虑到 aFunction 本身可能包含其他函数，我希望 someBoolean 对整个都是真的aFunction 的作用域，但在那之后，它必须变回 false

如果我没有设法解释得足够好，我很抱歉。复制粘贴我实际项目的相关代码会太大，我不想浪费你的时间。我已经被困了一段时间了，我似乎无法弄清楚......

（编辑：我不能只在函数后面加上 someBoolean = false ，因为该函数实际上是代理表上的 __index 函数）

编辑：相关的一段代码。我希望它有点清楚

```
local function objectProxyDelegate(t, key)
  if not done then  -- done = true when our object is fully initialised
    return cls[key]   -- cls is the class, newinst is the new instance (duh...)
  end
  print("trying to delegate " .. key)
  if accessTable.public[key] then
    print(key .. " passed the test")
    objectScope = true
    if accessTable.static[key] then -- static function. return the static one
      return cls[key]   -- we need to somehow set objectScope back to false after this, otherwise we'll keep overriding protected/private functions
    else
      return newinst[key]
    end
  elseif objectScope then
    print("overridden protected/private")
    return cls[key]
  end
  if accessTable.private[key] then
    error ("This function is not visible. (private)", 2)
  elseif accessTable.protected[key] then
    error ("This function is not visible to an instance. (protected)", 2)
  else
    error ("The function " .. key .. " doesn't exiist in " .. newinst:getType(), 2)                      -- den deze...
  end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T03:44:56.570

由于您需要返回一个函数（而不是评估一个函数），您可以为 the 创建一个代理`aFunction`并返回它。以下是它的工作原理（使用 Nicol Bolas 的解决方案中的一堆代码）：

```
local someBoolean = false

function doSomething(...) -- this is the function used in __index in a proxy table
  someBoolean = true

  -- Return a proxy function instead of aFunction
  return function(...)
    local rets = { aFunction(...) }
    someBoolean = false
    return table.unpack(rets)
  end
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T00:27:18.783

您不能在语句*之后执行代码。*`return`正确答案是调用函数，捕获返回值，设置变量，*然后*返回返回值。例如：

```
local someBoolean = false
function doSomething(...) -- this is the function used in __index in a proxy table
  someBoolean = true
  local rets = { aFunction(...) } -- this is function that we can NOT alter
  someBoolean = false
  return table.unpack(rets)
end 
```

# php - 使用 session_id 的会话安全

> ID：12083087
> 
> 赞同：0
> 
> 时间：2012-08-23T00:08:57.733
> 
> 标签：php, security, session

我正在处理登录脚本。当用户成功登录我设置`$_SESSION['logged_in'] = TRUE;`

然后，我只需检查其他页面，`$_SESSION['logged_in'] = TRUE;`如果是的话，我会显示适当的内容

一切正常，但现在我正在添加更多安全性。`session_id`登录时检查当前用户与`session_id`存储在数据库中的用户是否有益？这是否有助于防止会话劫持？如果没有，我应该采取其他预防措施吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T00:40:35.643

不，对照存储在数据库中的 session_id 检查 session_id 是没有好处的。如果会话被劫持，则意味着劫持者*拥有*会话 ID。因此，根据数据库检查它只会显示劫持者拥有有效的会话令牌。

正如 noko 所说，您可以检查 IP，但那是您需要存储的其他内容，也是您需要针对*每个*请求执行的其他操作。检查用户代理将毫无意义。

防止会话劫持的最佳方法是：

1.  为您的登录表单和用户登录后的每个页面使用 TLS/SSL。理想情况下，最好将其用于所有内容。
2.  用户登录后轮换您的会话令牌。如果用户的 session_id 在他们登录之前被泄露，那么在他们登录后它仍然会被泄露。
3.  确保您使用足够随机的会话令牌。这将使它们难以猜测，并使对您的会话管理的暴力攻击非常非常困难。

更新：为了详细说明#3（根据要求），我将引用并参考[OWASP 会话管理备忘单](https://www.owasp.org/index.php/Session_Management_Cheat_Sheet#Session_ID_Length)

> 会话 ID 必须足够长以防止暴力攻击，攻击者可以遍历整个 ID 值范围并验证有效会话的存在。会话 ID 长度必须至少为 128 位（16 字节）。

和

> 会话 ID 必须是不可预测的（足够随机）以防止猜测攻击，攻击者能够通过统计分析技术猜测或预测有效会话的 ID。为此，必须使用良好的 PRNG（伪随机数生成器）。会话 ID 值必须提供至少 64 位的熵（如果使用好的 PRNG，该值估计为会话 ID 长度的一半）。

# sql - SQL 原型设计：使用 varchar(N) 面对数据的静默截断——还有更好的选择吗？(Teradata)

> ID：12083089
> 
> 赞同：3
> 
> 时间：2012-08-23T00:09:02.600
> 
> 标签：sql, database-design, varchar, teradata

**情况：**

`varchar(20)`似乎在 Teradata中**静默截断，并且在遇到长度超过 20 个字符的字符串时****不会**扩展或抱怨......这有点令人惊讶，因为我希望自动扩展列以适应更大的字符串，比如 30 个字符，或者如果遇到更大的字符串，则抛出错误。沉默的截断似乎让我成为世界上最糟糕的事情......

**并发症：**

对于我的应用程序（原型分析设计），我事先不知道我将在几周内摄取的数据有多大。这似乎排除了使用 varchar(N)，除了 max

**问题：**

所以现在我有几个选择，并且正在寻找一些指导：

Q1。用户错误？我是否误解了一个关键概念`varchar(N)`？

如果这实际上是 Teradata 处理`varchar`字段的方式，那么

Q2。为什么有人会指定任何内容，`varchar(max)`尤其是在事先不清楚字段中可能需要存储多少字符的情况下。

Q3。是否存在允许灵活调整字符串大小的不同数据类型——即真正的*可变*长度字符串？

如果我记得，其他 SQL 方言实现`varchar(n)`为字符串的建议初始大小，但允许它根据需要扩展以适应所抛出数据字符串的最大长度。Teradata 中是否有类似的数据类型？

（注意：由于我正在对表格进行原型设计，因此我现在不太关心性能效率；更关心允许原型进行的快速但安全的设计。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T02:27:23.423

我不熟悉任何实现 varchar(n) 的 SQL 方言，它的行为与您的建议一样——推荐的初始大小，然后让它增长。这将适用于 Oracle、SQL Server、MySQL 和 Postgres。在所有这些数据库中，varchar(n) 的行为与您在 Teradata 中使用显式类型转换的 SELECT 语句中的行为非常相似。我不相信将较长的字符串放入较短的字符串时会导致截断错误。

正如 Branko 在他的评论中指出的那样，数据修改步骤中的行为是不同的，其中隐式转换确实会导致错误。

我不熟悉 Teradata 的所有细节。在 SQL Server 中，历史上 varchar(max) 和 varchar(8000) 之间存在天壤之别。前者将分配在单独的数据页上，而后者将分配在与数据相同的页上。（在最近的版本中，规则已被修改，因此 varchars 可以溢出数据页。）

换句话说，在使用 varchar(max) 时可能还有其他考虑因素，包括数据如何存储在页面上、如何在页面上构建索引，也许还有其他考虑因素。

我的建议是你选择一个相当大的尺寸，比如 1000 左右，然后让应用程序从那里继续。如果您想要真正的灵活性，请使用 varchar(max)。您还应该通过 Teradata 文档和/或技术联系人调查声明非常大的字符串存在哪些问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-06-30T17:12:48.917

Teradata 以两种模式工作：Teradata (BT; .. ET;) 和 ANSI(commit;)。它们有差异列表，其中一个是您在开发过程中遇到的——Teradata 模式允许截断显示数据。相反 - ANSI 禁止这样的截断，所以，你会看到一个错误。要了解这个想法，只需使用简单的示例： create table check_exec_mode (str varchar(5)) ; 从 check_exec_mode 中选择 * ；插入 check_exec_mode 值（'123456'）；如果您在 TMODE(transaction mode)=TERA 中配置您的 teradata 客户端（例如，Teradata Studio Express）的连接，那么您将在表中得到一个截断的行（'12345'）。将事务模式更改为 ANSI 并执行插入语句，将导致错误“字符串数据右截断”。

# php - 我不断收到以下错误。注意：未定义索引：asset_tag in

> ID：12083090
> 
> 赞同：-1
> 
> 时间：2012-08-23T00:09:04.137
> 
> 标签：php, mysql

```
$result = mysql_query("UPDATE inventory1.asset_details SET status='". 
$_POST['status']."', To='" . $_POST['location_name']."', notes='". 
$_POST['notes']."' WHERE asset_tag=" . $_POST['asset_tag']); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T00:10:07.303

这意味着它`'asset_tag'`不会作为您的`$_POST[]`数组中的键出现。您应该检查您的 HTTP 请求以确保该值被传入。

# jquery - 如何简化我的 Jquery 代码

> ID：12083091
> 
> 赞同：2
> 
> 时间：2012-08-23T00:09:20.780
> 
> 标签：jquery, css

我试图让我的代码不那么难看。这里有很多 if 语句和重复代码。主要区别在于 insertBefore 和 prependTo 单独更改了很少的 css 属性。有什么建议可以在这里简化我的代码吗？太感谢了。

```
if($element.closest('div').hasClass('links')){
    $(document.createElement('img'))
        .attr({src:'inc/images/bubble_anim.gif',  'class': 'helpImg'})
        .insertBefore($element)
        .css({'position':'absolute',
            'z-index':99,
            'top': topPos+30,
            'left': leftPos
         })

     return true;
 }

 if($element.attr('id')=='option'){
     $(document.createElement('img'))
         .attr({src:'inc/images/bubble_anim.gif',  'class': 'helpImg'})
         .prependTo($element)
         .css({ 'z-index':99  })

     return true;
 }           

 //if the element is a td element, using propendTo method.
 if($element.is('td')){
     $(document.createElement('img'))
     .attr({src:'inc/images/bubble_anim.gif',  'class': 'helpImg'})
     .prependTo($element)
     .css({'position':'absolute',
         'z-index':99,
         'top': topPos,
         'left': leftPos
     })

     return true;
}

//regular elements...
$(document.createElement('img'))
    .attr({src:'inc/images/bubble_anim.gif',  'class': 'helpImg'})
    .insertBefore($element)
    .css({'position':'absolute',
        'z-index':99,
        'top': topPos,
        'left': leftPos
    }) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T00:28:41.027

这是我的看法：

```
<style>
    .helpImg{
        position: absolute;
        z-index: 99;
    }   
</style>

var image = $("<img src='inc/images/bubble_anim.gif' class='helpImg'>");

if ($element.closest('div').hasClass('sub_links')) {

    image.css({
       'top': topPos+30,
       'left': leftPos
    }).insertBefore($element);

} else if ($element.attr('id')=='asmnt_option_label_q_count') {

    image.prependTo($element);          

} else {

    image.css({
        'top': topPos,
        'left': leftPos
    }).prependTo($element);

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T00:25:04.093

也许是这样的：

```
$('<img />', {src: 'inc/images/bubble_anim.gif', 'class': 'helpImg'})
    [($element.attr('id')=='asmnt_option_label_q_count'||$element.is('td'))?'prependTo':'insertBefore']($element)
    .css({
        zIndex: 99,
        position: $element.attr('id')=='asmnt_option_label_q_count'?'static':'absolute',
        top: $element.closest('div').hasClass('sub_links')?topPos+30:$element.attr('id') == 'asmnt_option_label_q_count'?'':topPos,
        left: $element.attr('id') == 'asmnt_option_label_q_count'?'':leftPos
    });
​return true; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T00:44:33.000

怎么样：

```
var img = $("<img src='inc/images/bubble_anim.gif' class='helpImg'>");

var css = {'position':'absolute',
           'z-index':99,
           'top': topPos,
           'left': leftPos
};

if($element.attr('id')=='asmnt_option_label_q_count'){
    $img.prependTo($element).css({ 'z-index':99})
}
else if($element.is('td')){
    $img.prependTo($element).css(css);
}
else{      
    css.top += ($element.closest('div').hasClass('sub_links')) ? 30 : 0;         
    img.insertBefore($element).css(css)​;
}
​ 
```

# html - 无法在我的代码中添加边距权限

> ID：12083092
> 
> 赞同：0
> 
> 时间：2012-08-23T00:09:22.937
> 
> 标签：html, css

我正在尝试`padding-right`添加[代码](http://classicbackpack.com/)。尽管尝试过，但我无法完成（甚至尝试过`margin-right`）。

```
.widget-title {
    color: #454545;
    font-size: 14px;
    font-weight: bold;
    padding-bottom: 10px;
    padding-right: 20px !important; /*First tried it without !important but it did not worked in both the cases.*/
    text-transform: uppercase;
} 
```

这是标记，

```
<li id="categories-2" class="widget-container widget_categories"><h3 class="widget-title">Categories</h3>       <ul> 
```

请帮我看看我该怎么做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T00:21:36.187

把你的`<h3>`标签放在`display:block;`. 一旦你有了一个块元素（层或 div/span），你就可以给它添加填充。

`h3`附带说明：元素内带有标签的 SEO 没有附加价值`ul`。你应该使用`<span class="widget-title">my title</span>`. 那你就不需要了`display: block;`。

**编辑：**因为我觉得这很有趣，所以我去寻找证明我之前关于 SEO 附加值的声明： [http ://www.seobythesea.com/2010/05/google-defines-semantic-closeness-as-a-ranking -signal/](http://www.seobythesea.com/2010/05/google-defines-semantic-closeness-as-a-ranking-signal/)（请参阅：**用于确定语义结构的 HTML 格式**）他们似乎声称相反。但试想一下，有人在寻找“类别背包”的目标`h3`是`ul`. 人们不会像那样搜索恕我直言。当人们使用“high sierra Backpack”找到您的内容时，这是有道理的。因此，`h3`可以这么说，它不会在搜索词中增加价值，并且在您的情况下更像是一个视觉指标。

# java - 如何定义确定点是否在纬度、经度区域内？

> ID：12083093
> 
> 赞同：7
> 
> 时间：2012-08-23T00:09:25.140
> 
> 标签：java

我有一个由一组地理点列表定义的区域，我需要知道坐标是否在该区域内

```
public class Region{
    List<Coordinate> boundary;

}

public class Coordinate{

    private double latitude;
    private double longitude;

}

public static boolean isInsideRegion(Region region, Coordinate coordinate){

} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-23T00:33:25.687

您可以从[计算几何问题集中应用](http://en.wikipedia.org/wiki/Computational_geometry)[多边形](http://en.wikipedia.org/wiki/Point_in_polygon)算法中的点。

Paul Bourke 用 C 语言编写了四种算法，您可以在[此处](http://paulbourke.net/geometry/insidepoly/)查看代码。[在Processing Forum](http://forum.processing.org/topic/how-do-i-find-if-a-point-is-inside-a-complex-polygon)中有一个对 Java 的改编，以防万一你不能使用 Java7：

```
public class RegionUtil {

    boolean coordinateInRegion(Region region, Coordinate coord) {
        int i, j;
        boolean isInside = false;
        //create an array of coordinates from the region boundary list
        Coordinate[] verts = (Coordinate)region.getBoundary().toArray(new Coordinate[region.size()]);
        int sides = verts.length;
        for (i = 0, j = sides - 1; i < sides; j = i++) {
            //verifying if your coordinate is inside your region
            if (
                (
                 (
                  (verts[i].getLongitude() <= coord.getLongitude()) && (coord.getLongitude() < verts[j].getLongitude())
                 ) || (
                  (verts[j].getLongitude() <= coord.getLongitude()) && (coord.getLongitude() < verts[i].getLongitude())
                 )
                ) &&
                (coord.getLatitude() < (verts[j].getLatitude() - verts[i].getLatitude()) * (coord.getLongitude() - verts[i].getLongitude()) / (verts[j].getLongitude() - verts[i].getLongitude()) + verts[i].getLatitude())
               ) {
                isInside = !isInside;
            }
        }
        return isInside;
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-23T00:22:14.863

用于[`Path2D`](http://docs.oracle.com/javase/7/docs/api/java/awt/geom/Path2D.html)构造区域边界形状。然后，创建一个[`Area`](http://docs.oracle.com/javase/7/docs/api/java/awt/geom/Area.html)使用`Path2D`，您可以`contains`快速查询以确定您的点是否包含在该区域中。:-)

```
/* assuming a non-zero winding rule */
final Path2D boundary = new Path2D.Double();
/* initialize the boundary using moveTo, lineTo, quadTo, etc. */
final Area area = new Area(boundary);
...
/* test for whether a point is inside */
if (area.contains(...)) {
  ...
} 
```

注意：几乎没有理由为Java 几何类提供的内容滚动您自己的类`Region`和类。`Coordinate`我建议你放弃`Coordinate`（这在技术上是一个误称，因为它实际上是*一对*经纬度坐标）而支持`Point2D`.

* * *

请注意，有*一个*类[`Polygon`](http://docs.oracle.com/javase/7/docs/api/java/awt/Polygon.html)，尽管它是针对图形的实际使用和过去的遗物而定制的。它仅支持`int`坐标，这在使用地理点时可能对您没有任何好处！

# jquery - JQuery JConfirm 不能在 iOS 上使用 UIWebview

> ID：12083094
> 
> 赞同：1
> 
> 时间：2012-08-23T00:09:37.743
> 
> 标签：jquery, ios, uiwebview

我们有一个 iOS 应用程序，它使用 UIWebView 控件来显示网页。该网页使用 JQuery 来显示一个 jConfirm 确认对话框。当用户按下取消按钮时，它没有响应。Javascript 应该向我们的 asp.net 页面发出回发以处理取消。它可以在 Safari/iPhone、Chrome/Android 甚至是 Android/WEBview 原生应用程序中正常工作。但它不适用于使用 UIWebView 的 iPhone 本机应用程序。

下面是我们在按下取消时调用 JConfirm 和 DoPostback 的代码片段。我们在 JQuery 1.6.4 上。有人知道这是否是 JConfirm 和 UIWEbView 控件的已知问题吗？谢谢，丹

```
 function showCancelDialog() {
        //set up the confirmation dialog
        $.alerts.okButton = "Yes";
        $.alerts.cancelButton = "No";
        $.alerts.buttonStyle = "font-size:medium; border-bottom: 1px solid #666688; border-right: 1px solid #666688; border-left: 1px solid #eaeaea;  border-top: 1px solid #eaeaea; background-color: #dCdBd6;";
        $.alerts.overlayOpacity = 0.7;

        //confirm to cancel or not
        jConfirm('Your payment will be cancelled. <br> Continue to cancel?', 'Cancel Payment?', function (r) {

            if (r) {
                //they have pressed Yes.
                //now force a server side post back on the asp.net Cancel button
                __doPostBack($(cancelButton).attr('name'), '');
                return true;
            } else {
                return false;
            }
        })

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T22:23:48.170

更新：我在另一个 SO 博客条目上找到了这个问题的答案。

[UIWebview 和 iPhone 内容不回发（ASP.NET 浏览器功能问题）](https://stackoverflow.com/questions/7275695/uiwebview-and-iphone-content-does-not-postback-asp-net-browser-capability-issue)

简而言之，解决方案是设置@Page 级别指令 ClientTarget = "uplevel" 或在页面加载中使用代码进行设置。

旁注，我不知道如何将 ClientTarget 放在 web.config 中以使其在站点范围内发生。如果有人知道这一点，请在此处发布解决方案。

# javascript - 多个变量在 Javascript 中不起作用

> ID：12083101
> 
> 赞同：0
> 
> 时间：2012-08-23T00:10:25.267
> 
> 标签：javascript

我正在尝试采用以英尺和英寸为单位的高度并将其转换为英寸（例如，6'1" 将是 73"）。当我只有一个选择框（英尺框）时，我可以成功地将其转换为英寸。但是，当我添加“英寸”变量并尝试将其添加到转换后的“英尺”变量中时，什么也没有发生。

这是脚本：

```
<script type="text/javascript" language="javascript">

function Calculate() {

    var feet = document.getElementById("feet").value;
    var inches = document.getElementbyId("inches").value;

    height = ((feet*12) + inches);

    document.write ('This is your height in inches:<b>   ' + height.toFixed(0) + '</b><br>');
}

</script> 
```

和 HTML：

```
<div class="form">
Height:
<select id="feet">
  <option value="4">4</option>
  <option value="5">5</option>
  <option value="6">6</option>
  <option value="7">7</option>
</select>

<select id="inches">
  <option value="0">0</option>
  <option value="1">1</option>
  <option value="2">2</option>
  <option value="3">3</option>
  <option value="4">4</option>
  <option value="5">5</option>
  <option value="6">6</option>
  <option value="7">7</option>
  <option value="8">8</option>
  <option value="9">9</option>
  <option value="10">10</option>
  <option value="11">11</option>
</select>
<br />
<input type="submit" value="Calculate" onclick="Calculate()" /> 
```

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T00:15:55.373

`feet`和`inches`是字符串，所以`+`连接。将强制转换乘以`feet`一个整数，所以你的结果`6'1"`是 721 ( `72+"1"`)

您应该手动转换为整数：

```
feet = parseInt(feet,10);
inches = parseInt(inches,10); 
```

编辑：另外，正如 João 指出的那样，您`getElementById`在第二个上大写错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T00:17:43.350

有两个问题。

首先，在这一行

```
var inches = document.getElementbyId("inches").value; 
```

你忘了大写`b`. 应该是`getElementById`。

此外，`inches`来自一个文本框，这意味着它是一个字符串，所以

```
height = ((feet * 12) + inches); 
```

也将是一个字符串，因为`+`它也是一个字符串连接运算符。既然是字符串，就说明`toFixed`它的原型中没有方法。

您可以通过将字符串传递给`Number`或添加 a`+`以使其成为数字来解决此问题，如下所示：

```
height = Number((feet * 12) + inches);
//OR
height = +((feet * 12) + inches); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T00:14:56.747

您应该将英尺和英寸的值包装在`parseInt`函数中以确保它是整数。

使用输入`type='submit'`时，它的行为与常规输入不同，`type='button'`因此您需要将类型更改为`button`或将 a`return false`放在计算函数的末尾

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T00:30:04.197

我知道这可能有点晚了，但我把它扔进了 jsFiddle 并稍微清理了 JS 代码（我把它换成了 jQuery）。这可能值得一试。

[示例 - jsFiddle](http://jsfiddle.net/8Z5X5/2/)

# android - 在安卓中播放视频

> ID：12083112
> 
> 赞同：0
> 
> 时间：2012-08-23T00:12:02.380
> 
> 标签：android, video

我有 4 个需要在 Android 应用中播放的 .mp4 视频。我设法播放了 1 个视频，但其他 3 个无法播放。我认为视频大小是问题所在。我设法播放的视频大小为 1.4mb，其他 3 个大小为 6mb、2.2mb、3.8mb。

这是我播放它们的代码。

```
public void onCreate(Bundle savedInstanceState) {

        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_videoviewer);

         Bundle extras = getIntent().getExtras();
            if (extras != null) {   
                String value = extras.getString("VidName");

                if(value.equals("MinorBurnVid"))
                {
                    try
                    {
                    videoView1 = (VideoView)findViewById(R.id.Video1);

                    videoView1.setVideoPath("android.resource://dr.droid/" + R.raw.burn);
                    videoView1.setMediaController(new MediaController(this));
                    videoView1.requestFocus();
                    videoView1.start();

                    } catch (Exception e) {
                        Toast.makeText(getBaseContext(), e.getMessage(),
                                Toast.LENGTH_SHORT).show();
                    }
                }
                else if(value.equals("ChokingAdultVid"))
                {
                    try
                    {
                        videoView1 = (VideoView)findViewById(R.id.Video1);

                        videoView1.setVideoPath("android.resource://dr.droid/" + R.raw.chokingadult);
                        videoView1.setMediaController(new MediaController(this));
                        videoView1.requestFocus();
                        videoView1.start();

                        } catch (Exception e) {
                            Toast.makeText(getBaseContext(), e.getMessage(),
                                    Toast.LENGTH_SHORT).show();
                        }
                }
                else if(value.equals("CPRAdultVid"))
                {
                    try
                    {
                        videoView1 = (VideoView)findViewById(R.id.Video1);

                        videoView1.setVideoPath("android.resource://dr.droid/" + R.raw.cpr);
                        videoView1.setMediaController(new MediaController(this));
                        videoView1.requestFocus();
                        videoView1.start();

                        } catch (Exception e) {
                            Toast.makeText(getBaseContext(), e.getMessage(),
                                    Toast.LENGTH_SHORT).show();
                        }
                }
                else if(value.equals("Fracture"))
                {
                    try
                    {
                        videoView1 = (VideoView)findViewById(R.id.Video1);

                        videoView1.setVideoPath("android.resource://dr.droid/" + R.raw.fracture);
                        videoView1.setMediaController(new MediaController(this));
                        videoView1.requestFocus();
                        videoView1.start();

                        } catch (Exception e) {
                            Toast.makeText(getBaseContext(), e.getMessage(),
                                    Toast.LENGTH_SHORT).show();
                        }
                }
            }

    } 
```

刻录视频是我设法播放的一个，但其他 3 个，没有运气！有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T00:19:28.050

您是遇到异常还是只是忽略了代码片段？如果没有例外，请确保“value”中存储的字符串是正确的，这可能是一个小问题，比如区分大小写。希望。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T01:17:28.870

```
String uri = "android.resource://dr.droid/" + R.raw.fracture;
videoView1.setVideoURI(Uri.parse(uri)); 
```

# php - Zend 数据库处理

> ID：12083113
> 
> 赞同：1
> 
> 时间：2012-08-23T00:12:23.683
> 
> 标签：php, oop, zend-framework

我是 Zend 的新手，但对 PHP 和其他 MVC 框架非常熟悉。客户要求将 Zend 用于应用程序，而我在寻找自己喜欢的数据库方法时遇到了一些麻烦。我只连接到一个数据库（现在是 MySQL，生产中的 MS SQL）并且实际上只与一个表交互。话虽如此，我想找到一种打开该数据库句柄并保持其打开状态的好方法，以便它在我的所有控制器中都可用，并允许我使用诸如 fetchAll、fetchOne 等方法。

理想情况下，我希望能够从我的控制器进行如下调用，并将结果传递给视图。

```
$this->db->fetchAll("SELECT * FROM TABLE"); 
```

我已按照 Zend 站点上的教程进行操作，但在使用 Zend_Db_Table 方法后，我无法找到我想要的灵活性，因此希望这里的人可以为我指明不同的方向。我似乎很难理解 Zend 数据库模型如何与 Zend 控制器交互，但我确信有很多 SO 用户可以提供一些可靠的输入。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T07:23:12.627

当您将此配置放入 application.ini 时，Zend 将在您尝试查询时建立与数据库的连接（其中一些是可选的）：

```
resources.db.adapter = "pdo_mysql"
resources.db.params.host = "[主机地址]"
resources.db.params.username = "[db_username]"
resources.db.params.password = "[db_password]"
资源.db.params.dbname = "[db_name]"
resources.db.isDefaultTableAdapter = true
resources.db.params.charset = "utf8"
resources.db.params.driver_options.1002 = "设置名称 utf-8"
```

要查询数据库，最好使用 Zend 模型，例如定义如下模型：

```
类 Application_Model_Book 扩展 Zend_Db_Table_Abstract{
    公共函数 getBookById($id){
        返回 $this->find($id);
    }
}

```

然后在您的控制器中使用它，例如：

```
$mBook = new Application_Model_Book();
$myBook = $mBook->getBookById(5);

```

当然这是一个简单的例子，很容易在控制器中制作。但是对于更复杂的查询，它将大量组织和清理您的代码。阅读[http://framework.zend.com/manual/1.11/en/zend.db.select.html](http://framework.zend.com/manual/1.11/en/zend.db.select.html)并在模型中使用知识。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T09:13:47.077

`$this->db->fetchAll("SELECT * FROM TABLE");`实际上是相当容易完成的。

我将假设您已经在 application.ini 或 bootstrap.php 中设置了一个数据库适配器，只要您在某个地方定义了一个适配器，那实际上并不重要。

```
//simplified for demonstration
class SomeController extends Zend_Controller_Action

    protected $db;

    //items that are put into init() or predispatch() or similar function 
    //can usually be put into a frontcontroller plugin if needed app wide.
    public function init() {
        //this works as long as you have only one adapter defined or have set one as default.
        $this->db = Zend_Db_Table::getDefaultAdapter();
    }
    public function indexAction() {
        //with your db adapter defined you have access to the api for Zend_Db_Table_Abstract
        $result = $this->db->fetchRow($sql);
        //while a simple string will work as $sql I would
        //recommend the select() be used if for not other reason then that
        //the queries are built programatically
        $select = $this->db->select();
        $select->where('id = ?', $id)->orWhere('role = ?', 1); //selects can be chained or separated
        $select->order('id','ASC');

        $rows = $this->db->fetchAll($select);//returns rowset object, toArray() if needed.

    }
} 
```

我认为大多数人在第一次使用[Zend_Db](http://framework.zend.com/manual/en/zend.db.html)时遇到的最大问题是找出使用它的最佳方式。有很多方法可以使用这个组件，我们大多数人都会找到我们喜欢的一种并将其用于所有事情。

例如，一个简单的 sql 查询可以表示为一个字符串，如我的示例代码中 `$sql = "SELECT * FROM TABLE";`
的[select() 对象。](http://framework.zend.com/manual/en/zend.db.select.html)
您可以使用[Zend_Db_Expr](http://framework.zend.com/manual/en/zend.db.select.html#zend.db.select.building.columns-expr)来表示更复杂的表达式`$select->where(new Zend_Db_Expr("FIND_IN_SET('$genre', genre)"));`
，不要忘记[Zend_Db_Statement](http://framework.zend.com/manual/en/zend.db.statement.html)（我从未使用过，因此无法正确演示）。

如果需要[，可以引用值和标识符。](http://framework.zend.com/manual/en/zend.db.adapter.html#zend.db.adapter.quoting)
***[编辑]***

如前所述，您必须定义一个[数据库适配器](http://framework.zend.com/manual/en/zend.db.adapter.html#zend.db.adapter.adapter-notes)。我更喜欢在我的*application.ini*中执行此操作，但是*Bootstrap.php*也是定义适配器的常见位置。

在您的*application.ini*中确保您至少有以下几行：

```
resources.db.adapter = "pdo_Mysql" //or your chosen adapter
resources.db.params.username = "username"
resources.db.params.password = "password"
resources.db.params.dbname = "dbname" 
```

我希望这至少能给你指明方向。祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T02:14:18.157

您应该记住 Zend 模型完全不知道您的控制器。这是 MVC 模式思想的一部分。

你似乎非常接近你正在寻找的东西。如果您想使用 SQL 语句直接查询您的数据库，请参阅 Zend_DB->query() 方法。我认为这正是你所要求的。 [http://framework.zend.com/manual/en/zend.db.statement.html](http://framework.zend.com/manual/en/zend.db.statement.html)

但实际上，这样做会丢掉 Zend_DB 的很多好处。如果您使用 Zend_Select 对象构建查询，您将获得表/字段前缀的自动插值、所有查询的参数化、连接等。如果您能获得 SQL->ORM 学习曲线，它们真的很棒。 [http://framework.zend.com/manual/en/zend.db.select.html](http://framework.zend.com/manual/en/zend.db.select.html)

无论如何，一定要使用 Zend 的参数化进行查询，否则您将丢弃 DB 层的所有出色的安全性和安全性功能。

# python - django 会话以防止用户多次投票

> ID：12083117
> 
> 赞同：2
> 
> 时间：2012-08-23T00:13:59.243
> 
> 标签：python, django, django-sessions

# 视图.py

```
def like(request,option="food",restaurant = 1):
    if request.is_ajax:
        rest = 'rest'
        like = '%s-like' % str(option)

        if restaurant in request.session:

            if like not in request.session[restaurant]:
                request.session[restaurant][like] = str(like)
            else:
                return HttpResponse('warning')
        if restaurant not in request.session:
            request.session[restaurant] = restaurant

        r = Restaurant.objects.get(pk=restaurant)
        if option == "food":
            r.food_likes +=1
            r.save()
            return HttpResponse(str(r.food_likes))
        elif option=="service":
            r.service_likes +=1
            r.save()
            return HttpResponse(str(r.service_likes))
        elif option == "ambience":
            r.ambience_likes +=1
            r.save()
            return HttpResponse(str(r.ambience_likes))
    else:
        return redirect(request.META.get('HTTP_REFERER')) 
```

# 错误

```
'unicode' object does not support item assignment 
```

# 线

```
request.session[restaurant][like] = str(like) 
```

# 怀疑

我在使用变量字符串设置会话密钥时遇到问题，我应该如何在“餐厅”键中设置会话密钥“like”？？请帮忙

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T06:54:55.053

首先创建一个空字典 `request.session[restaurant] = dict()`

然后做作业 `request.session[restaurant][like] = str(like)`

# android - Android udp 多播失败，权限被拒绝

> ID：12083123
> 
> 赞同：2
> 
> 时间：2012-08-23T00:14:43.643
> 
> 标签：android, udp, broadcast, multicast

尝试广播 udp 数据包时遇到问题。

```
08-22 16:36:13.359 E/UDPTester.UDPEndpoint( 3657): IOException : Permission denied
08-22 16:36:13.359 W/System.err( 3657): java.net.SocketException: Permission denied
08-22 16:36:13.369 W/System.err( 3657):     at org.apache.harmony.luni.platform.OSNetworkSystem.send(Native Method)
08-22 16:36:13.369 W/System.err( 3657):     at dalvik.system.BlockGuard$WrappedNetworkSystem.send(BlockGuard.java:308)
08-22 16:36:13.369 W/System.err( 3657):     at org.apache.harmony.nio.internal.DatagramChannelImpl.send(DatagramChannelImpl.java:359)
08-22 16:36:13.369 W/System.err( 3657):     at zexing.udptester.UDPEndpoint.broadcast(UDPEndpoint.java:151)
08-22 16:36:13.369 W/System.err( 3657):     at zexing.udptester.MainActivity.onClickBroadcast(MainActivity.java:162)
08-22 16:36:13.369 W/System.err( 3657):     at java.lang.reflect.Method.invokeNative(Native Method)
08-22 16:36:13.369 W/System.err( 3657):     at java.lang.reflect.Method.invoke(Method.java:507)
08-22 16:36:13.369 W/System.err( 3657):     at android.view.View$1.onClick(View.java:2155)
08-22 16:36:13.369 W/System.err( 3657):     at android.view.View.performClick(View.java:2501)
08-22 16:36:13.369 W/System.err( 3657):     at android.view.View$PerformClick.run(View.java:9107)
08-22 16:36:13.369 W/System.err( 3657):     at android.os.Handler.handleCallback(Handler.java:587)
08-22 16:36:13.369 W/System.err( 3657):     at android.os.Handler.dispatchMessage(Handler.java:92)
08-22 16:36:13.369 W/System.err( 3657):     at android.os.Looper.loop(Looper.java:130)
08-22 16:36:13.369 W/System.err( 3657):     at android.app.ActivityThread.main(ActivityThread.java:3835)
08-22 16:36:13.369 W/System.err( 3657):     at java.lang.reflect.Method.invokeNative(Native Method)
08-22 16:36:13.369 W/System.err( 3657):     at java.lang.reflect.Method.invoke(Method.java:507)
08-22 16:36:13.369 W/System.err( 3657):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:847)
08-22 16:36:13.369 W/System.err( 3657):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:605)
08-22 16:36:13.369 W/System.err( 3657):     at dalvik.system.NativeStart.main(Native Method) 
```

在 AndroidManifest.xml 中，我已经添加了这些权限。

```
<uses-permission android:name="android.permission.ACCESS_WIFI_STATE"/>
<uses-permission android:name="android.permission.CHANGE_WIFI_MULTICAST_STATE"/>
<uses-permission android:name="android.permission.INTERNET"/> 
```

另外，我在广播之前获得了多播锁定

// 创建多播锁@Activity.onCreate

```
mcastLock =  wifiManager.createMulticastLock("zexing.udptester.Multicast"); 
```

// 在广播期间获取多播锁

```
mcastLock.acquire();
if (mcastLock.isHeld()) {
    Log.i(TAG, "held multicast lock");
}
udpEndpoint.broadcast(msg, port);
Log.v(TAG, "broadcast " + msg + " to port : " + port);
Log.d(TAG, "Release wifi Multicast lock to enable wifi UDP broadcast");
mcastLock.release(); 
```

// UdpEndpoint.broadcast

```
public void broadcast(String msg, int port) {
    try {
        if (broadcastChannel == null) {
            Log.v(TAG, "opening write DatagramChannel");
            broadcastChannel = DatagramChannel.open();
            Log.v(TAG, "config write channel to non-blocking");
            broadcastChannel.configureBlocking(false);
            Log.v(TAG, "reuse address");
            broadcastChannel.socket().setReuseAddress(true);
            Log.v(TAG, "set broadcast to true");
            broadcastChannel.socket().setReuseAddress(true);
            Log.v(TAG, "register broadcast Channel");
            broadcastChannel.register(selector, SelectionKey.OP_READ);
            Log.v(TAG, "register broadcast channel successfully");
        }
        if (msg.length() == 0) {
            Log.w(TAG, "message to broadcast is null, skip sending");
        }
        SocketAddress addr = new InetSocketAddress(InetAddress.getByName("255.255.255.255"), port);
        Log.v(TAG, "allocate " + msg.length() + " bytes. msg.getBytes().length = " + msg.getBytes().length);
        ByteBuffer bb = ByteBuffer.allocate(msg.length());
        bb.clear();
        bb.put(msg.getBytes());
        bb.flip();
        Log.v(TAG, "write channel broadcast " + msg + " to " + addr);
        int bytes = broadcastChannel.send(bb, addr);
        Log.v(TAG, "broadcast " + bytes + " bytes to " + addr);
    } catch (UnknownHostException uhe) {
        Log.e(TAG, "UnknownHostException : " + uhe.getMessage());
    } catch (IOException e) {
        Log.e(TAG, "IOException : " + e.getMessage());
        e.printStackTrace();
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-07-11T16:29:51.467

尝试将广播发送到子网的广播地址示例：192.168.1.255 而不是 255.255....另外确保您的端口大于 1024 或仅端口 0，系统会为您选择一个

# objective-c - UIPageViewController 捕获所有 UITapGestureRecognizer 事件

> ID：12083124
> 
> 赞同：5
> 
> 时间：2012-08-23T00:14:44.673
> 
> 标签：objective-c, uiview, addsubview, uipageviewcontroller, uitapgesturerecognizer

在键盘上度过了漫长的一天，所以我伸出手来:-)

我有一个`UIPageViewController`基本遵循 Apple 标准模板的典型实现。我正在尝试添加一个覆盖层，允许用户执行诸如触摸按钮以跳转到某些页面或关闭视图控制器以转到应用程序的另一部分的操作。

我的问题是`UIPageViewController`从我的覆盖子视图中捕获所有事件，我正在努力寻找可行的解决方案。

这是一些帮助示例的代码...

**在 viewDidLoad**

```
// Page creation, pageViewController creation etc....

self.pageViewController.delegate = self;

[self.pageViewController setViewControllers:pagesArray
                                  direction:UIPageViewControllerNavigationDirectionForward
                                   animated:NO
                                completion:NULL];

self.pageViewController.dataSource = self;

[self addChildViewController:self.pageViewController];
[self.view addSubview:self.pageViewController.view];

// self.overlay being the overlay view

if (!self.overlay) 
{
   self.overlay = [[MyOverlayClass alloc] init];  // Gets frame etc from class init
   [self.view addSubview:self.overlay];
} 
```

这一切都很好。`UIPageViewController`覆盖被创建，它会显示在您所期望的页面顶部。当页面翻转时，它们会在覆盖层下方翻转 - 正如您所期望的那样。

但是，视图`UIButtons`内`self.overlay`永远不会获得点击事件。`UIPageViewController`响应所有事件。

我已尝试`-(BOOL)gestureRecognizer:(UIGestureRecognizer *)gestureRecognizer shouldReceiveTouch:(UITouch *)touch`根据此处的建议覆盖但没有成功。

[UIPageViewController 手势识别器](https://stackoverflow.com/questions/7788780/uipageviewcontroller-gesture-recognizers)

我已经尝试手动捕获所有事件并自己处理它们 - 不起作用（老实说，即使它这样做似乎有点像黑客）。

有没有人有关于如何捕获事件的建议或者更好的方法来使用覆盖在`UIPageViewController`.

非常感谢任何和所有帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-10T09:32:26.073

尝试迭代`UIPageViewController.GestureRecognizers`并指定`self`为这些手势的代表并实现

```
-(BOOL)gestureRecognizer:(UIGestureRecognizer *)gestureRecognizer shouldReceiveTouch:(UITouch *)touch; 
```

你的代码可能是这样的：

在 viewDidLoad

```
for (UIGestureRecognizer * gesRecog in self.pageViewController.gestureRecognizers)
{
        gesRecog.delegate = self;
} 
```

并添加以下方法：

```
-(BOOL)gestureRecognizer:(UIGestureRecognizer *)gestureRecognizer shouldReceiveTouch:(UITouch *)touch
{
    if (touch.view != self.pageViewController.view]
    {
        return NO;
    }
    return YES;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-07T00:16:39.943

防止`UIPageViewController`滚动的记录方法是不分配`dataSource`属性。如果您分配数据源，它将进入“基于手势”的导航模式，这是您试图阻止的。

如果没有数据源，您可以在需要使用`setViewControllers:direction:animated:completion`方法时手动提供视图控制器，它会根据需要在视图控制器之间移动。

以上可以从[苹果的 UIPageViewController 文档中](https://developer.apple.com/library/ios/documentation/uikit/reference/UIPageViewControllerClassReferenceClassRef/UIPageViewControllerClassReference.html)推导出来（Overview，第二段）：

> 要支持基于手势的导航，您必须使用数据源对象提供视图控制器。

# php - 将类添加到 基于文件名

> ID：12083127
> 
> 赞同：1
> 
> 时间：2012-08-23T00:15:01.920
> 
> 标签：php, css, wordpress, class

我正在寻找解决方法的解决方案。现在，我确定的最佳解决方法是能够将类添加到 wordpress 页面上的附件中。目前，Wordpress 没有任何简单的方法可以简单地为以后的 CSS 样式添加一个类。

当前，当生成 HTML 时，它会将其包装在 div 中。这就是它的生成方式（我认为）：

```
<?php   
   $bigsrc =  wp_get_attachment_image_src( $attachment->ID, 'full'); 
   $zoom = $bigsrc[0];
   $src = wp_get_attachment_image_src( $attachment->ID, 'post-thumb'); 
   $attachmenttitle = apply_filters('the_title', $attachment->post_title); 
   $class = "media-image";
?>

<div class="item-photo <?php echo $class;?>"> 
```

有没有办法根据文件名添加一个类？我可以轻松地重命名文件“red-01.jpg”和“blue-01.jpg”。我希望有一些脚本可以将 html 输出为：

```
<div class="item-photo media-image red"><img src="red-01.jpg" /></div>
<div class="item-photo media-image blue"><img src="blue-01.jpg" /><div> 
```

我必须使用 Wordpress 附件方法，因为我用于项目的脚本已经调用了页面的附件，并且非常复杂。如果在 Wordpress 媒体上传中添加一个简单的类，我的问题将得到解决。谢谢百亿！

我对任何解决方案都完全开放......只要我可以像上面那样向 div 添加一个类！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T01:35:51.507

关于什么

```
div class="item-photo <?php echo ($class." ".$src); ?>"> 
```

或 $bigsrc，或任何对识别图像最有用的值（不确定这些值是什么）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T02:59:23.890

而不是使用`wp_get_attatchment_image()`，使用`wp_get_attatchment_image_src()`并自己填写值。一旦你有了图像源，你可以做一个`substr_replace()`去掉文件扩展名并将它扔到类中。

# php - PHPUnit：我如何模拟这个文件系统？

> ID：12083134
> 
> 赞同：16
> 
> 时间：2012-08-23T00:15:56.967
> 
> 标签：php, mocking, phpunit, vfs-stream

考虑以下场景（这不是生产代码）：

```
 class MyClass {
    public function myMethod() {
        // create a directory
        $path = sys_get_temp_dir() . '/' . md5(rand());
        if(!mkdir($path)) {
            throw new Exception("mkdir() failed.");
        }

        // create a file in that folder
        $myFile = fopen("$path/myFile.txt", "w");
        if(!$myFile) {
            throw new Exception("Cannot open file handle.");
        }
    }
} 
```

对，那有什么问题？代码覆盖率报告此行未涵盖：

```
throw new Exception("Cannot open file handle."); 
```

这是正确的，但是由于我在逻辑上创建了上面的文件夹，因此似乎不可能`fopen()`失败（可能在极端情况下除外，例如 100% 的磁盘）。

我可以忽略代码覆盖率中的代码，但那是一种作弊。有什么方法可以模拟文件系统，以便它可以识别`myFile.txt`和模拟无法创建文件的文件系统？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-23T00:23:03.967

`vfsStream`是一个`stream wrapper`用于`virtual filesystem`模拟真实文件系统的单元测试。您可以从[composer](https://packagist.org/packages/mikey179/vfsStream)安装它。

更多信息在：

[https://github.com/mikey179/vfsStream](https://github.com/mikey179/vfsStream)

[https://phpunit.de/manual/current/en/test-doubles.html](https://phpunit.de/manual/current/en/test-doubles.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-28T20:03:44.870

您还可以将函数分解为 2 种方法，一种用于创建路径，另一种用于使用它。然后，可以进行单独的测试以确保创建路径。当您尝试使用错误路径时，第二组测试可以检查并捕获异常。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-23T00:23:42.027

是的！

您应该以某种方式注入完整路径，并且不要在该方法中直接调用 sys_get_temp_dir() 。

任何不存在的路径都应该引发问题。你不需要VFS。

但是在触发异常之前，您会收到 E_NOTICE（或警告？）。所以你可能应该首先检查 is_writable，如果它返回 false，则抛出异常。

# tridion - 安装 Tridion 2011 SP1 后，Content Delivery 服务在哪里？

> ID：12083135
> 
> 赞同：2
> 
> 时间：2012-08-23T00:16:09.220
> 
> 标签：tridion, tridion-2011

我们正在从 Tridion 5.3 SP1 升级到 Tridion 2011 SP1。我们正在新机器上进行安装。

内容管理服务器的安装很顺利。但似乎 Ccontent Delivery (.NET) 的安装并不顺利。“startCDinstaller.bat”成功执行，但我们在服务部分找不到任何与 Tridion 相关的服务（在 5.3 中，我们有 Tridion 内容代理、tridion 内容部署器等）。

甚至我也无法确定安装的哪个部分应该充当“Web 应用程序”，哪个应该充当“Web 服务”。谁能帮我理解正确的安装过程。

注意：我们不使用任何高级主题，如受众管理器、交易管理器、出站电子邮件等。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-23T00:35:33.977

在 Tridion 2009 之前安装在 Tridion 内容交付服务器上的许多 Windows 服务过去只是简单的包装服务，以在调用之间保持底层 JVM 活动。只有 ASP 和 ASP.NET 网站才需要它们。基于 Java 的网站会将 Content Delivery jar 托管在他们自己的应用程序服务器的 JVM 中，因此他们不需要这些服务。

自 Tridion 2009 以来，JVM 在托管使用 Tridion 内容交付功能的 ASP.NET 网站的每个应用程序池中实例化。由于这意味着 JVM 现在托管在您的 .NET 进程中，因此不再需要用于此功能的 Windows 服务。

在 Tridion 2009 及更高版本上通常不再需要的 Windows 服务（除非您使用的是经典 ASP）：

*   内容交付代理
*   内容交付链接

您可能/可能仍需要以下 Windows 服务：

*   内容交付缓存通道
*   Content Delivery Deployer（除非您使用 HTTP 传输并将 InProcessDeploy 设置为 false）

我根本不记得曾经有哪些其他服务。如果您发现自己想知道其中一项服务发生了什么，请在评论中提及（或更新问题），我会将其添加到正确的列表中。

# php - 扩展 ad.fly 链接？

> ID：12083139
> 
> 赞同：0
> 
> 时间：2012-08-23T00:16:28.313
> 
> 标签：php, decode, expand, url-shortener

我通过我自己的脚本的 PHP 请求使用这个网站，一次解码多个 ad.fly 链接：

[http://www.kassio.altervista.org/deadfly.php](http://www.kassio.altervista.org/deadfly.php)

但它已更新，不再处理直接的 PHP 请求。似乎有很多网站可以解码 ad.fly 链接。有谁知道这样做的方法是什么。我很想将它包含在我自己的脚本中，而不是依靠第三方来扩展/解码链接？

TIA

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T00:19:36.127

URL 可能是他们数据库中的一个键。没有他们的工具，您无法自己完成。

这个：[http](http://pastebin.com/zFB6iUcq) ://pastebin.com/zFB6iUcq让我相信他们有一些你可以访问的 API。

# jquery - Onclick 显示/隐藏多个 Divs Jquery

> ID：12083142
> 
> 赞同：2
> 
> 时间：2012-08-23T00:17:06.450
> 
> 标签：jquery, html, css

我需要创建显示/隐藏多个 div 的导航。

**这是我需要做的事情**：如果用户单击任何“**选项**”，我需要一个名为“已**选择**”的类，该类与导航中当前选择或选择的项目相关联 - 这意味着向锚点添加一个类. 您将在下面的示例中看到“选定”类的 CSS 样式。

[查看当前进度](http://jsfiddle.net/XwN2L/402/)

我也无法尝试在加载时选择“选项 1”或“选项 2”，以便所有 div 都不会出现 - 加载时我只需要一个 div 显示正确的“**选项**”“**选择**”如果那样说得通。

欢迎所有建议！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T00:30:46.763

您应该使用数据属性，因为它`target`不是真正有效的。我将其更改为`data-target`并做了：

```
$('.showSingle').on('click', function () {
    $(this).addClass('selected').siblings().removeClass('selected');
    $('.targetDiv').hide();
    $('#div' + $(this).data('target')).show();
});​ 
```

[**小提琴**](http://jsfiddle.net/XwN2L/420/)

`on()`只能在 jQuery 1.7+ 中使用，所以如果使用旧版本的 jQuery（你的小提琴是），坚持使用`click()`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T00:30:48.467

请参阅[http://jsfiddle.net/XwN2L/415/](http://jsfiddle.net/XwN2L/415/)。它从所有锚点中删除“选定”类`.showSingle`，然后将“选定”类添加到单击的锚点。`.targetDiv`此外，它通过隐藏所有s 并仅显示第一个来处理 onload 问题。

**编辑：**也应该在页面加载时以红色突出显示第一个选项。[http://jsfiddle.net/XwN2L/421/](http://jsfiddle.net/XwN2L/421/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T00:32:43.777

**编辑：**对于非 JQuery 解决方案，试试这个：

```
function showHide(element) { 
     var field = document.getElementById(element); 
     if (element) { 
          if (field.style.display == 'none') { 
                field.style.display = 'block'; 
          } else { 
                field.style.display = 'none'; 
          } 
     } 
} 
```

那将是您在 JS 中显示和隐藏的代码

```
<div class="buttons">
    <button class="showSingle" target="1" onClick="showHide(div1);">Option 1</button>
    <button class="showSingle" target="2" onClick="showHide(div2);">Option 2</button>
    <button class="showSingle" target="3" onClick="showHide(div3);">Option 3</button>
    <button class="showSingle" target="4" onClick="showHide(div4);">Option 4</button>
</div>

<div id="div1" class="targetDiv" style="display:none">Lorum Ipsum 1</div>
<div id="div2" class="targetDiv" style="display:none">Lorum Ipsum 2</div>
<div id="div3" class="targetDiv" style="display:none">Lorum Ipsum 3</div>
<div id="div4" class="targetDiv" style="display:none">Lorum Ipsum 4</div>​ 
```

这应该让你开始:-)

完全错过了我的 Jquery

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-23T00:41:39.963

```
$('.showSingle').click(function () {
   $('.targetDiv').hide();
   $('#div' + $(this).attr('target')).show();
   $('.showSingle').removeClass('selected')
   $(this).addClass('selected');           
});

var active_link = 1; // Change this value to set the active link
$('a[target='+active_link+']').trigger('click');​ 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-23T01:10:33.747

对于您的第一个麻烦，您可以在点击事件中添加以下两行：

```
 $(".buttons .selected").removeClass("selected");
    $(this).addClass("selected"); 
```

或者正如 Irrelepant 所说（实际上是更好的方法）：

```
$(this).addClass('selected').siblings().removeClass('selected'); 
```

# unity3d - UNITY3D：有人能帮我把它从电脑转换到移动平台吗？

> ID：12083143
> 
> 赞同：-1
> 
> 时间：2012-08-23T00:17:15.727
> 
> 标签：unity3d

我在移动平台上收到此错误：“GetComponent”在移动平台上不是“对象”的成员，但在 Windows 上工作正常。请帮我解决这个问题。提前谢谢。:D

```
for (stage = 2; stage <= cells.length; stage++) 

{

for (i = 0; i <= cells.length - 1; i++) 

{ 

if (doorsToCells[i] == stage - 1)

for (var checkDoor : GameObject in cells[i].GetComponent(AIpathCellScript).… /*is is the line with error*/

{

if (checkDoor != gameObject)

{

for (var checkCell : GameObject in checkDoor.GetComponent(AIpathDoorScript)…

{

for (var j : int = 0; j <= cells.length - 1; j++)

{

if (cells[j] == checkCell && doorsToCells[j] == null)

doorsToCells[j] = stage;

}
}
}
}
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T10:31:06.823

首先，您需要将变量转换为您想要的类型......在这种情况下为 GameObject

第二你的循环似乎是错误的......你在一个脚本组件中循环游戏对象，这真的很奇怪......（除非你没有显示你的所有代码）

# c++ - 期货是检查单个线程完成的安全方法吗？

> ID：12083144
> 
> 赞同：1
> 
> 时间：2012-08-23T00:17:17.163
> 
> 标签：c++, multithreading, boost, thread-safety

我一直在玩弄 Boost 的未来，想知道它们是否是一种可接受且安全的方式来检查单个线程是否已完成。

我以前从未使用过它们，所以我编写的大部分代码都是基于[Boost 的同步文档](http://www.boost.org/doc/libs/1_41_0/doc/html/thread/synchronization.html#thread.synchronization.futures.reference)。

```
#include <iostream>
#include <boost/thread.hpp>
#include <boost/thread/future.hpp>

int calculate_the_answer_to_life_the_universe_and_everything()
{
    boost::this_thread::sleep(boost::posix_time::seconds(10));
    return 42;
}

int main()
{
    boost::packaged_task<int> task(calculate_the_answer_to_life_the_universe_and_everything);
    boost::unique_future<int> f(task.get_future());

    boost::thread th(boost::move(task));

    while(!f.is_ready())
    {
        std::cout << "waiting!" << std::endl;
        boost::this_thread::sleep(boost::posix_time::seconds(1));
    }

    std::cout << f.get() << std::endl;

    th.join();
} 
```

这似乎在等待 calculate_the_answer_to_life_the_universe_and_everything() 线程返回 42。这可能会出现问题吗？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T00:56:17.650

是的，future 以这种方式使用是安全的，并且代码（一目了然）安全且正确。

还有其他方法可以做同样的事情（例如，使用`atomic_flag`，或互斥保护数据，或许多其他方法），但您的代码是一种有效的方法。

NB 而不是`f.is_ready()`and`this_thread::sleep(seconds(1))`你可以使用`f.wait_for(seconds(1))`，一旦结果准备好就会唤醒。直接等待未来，而不是检查未来，然后使用单独的机制等待，然后检查，然后使用单独的机制等。

而不是`packaged_task`and`thread`你可以使用`async`.

使用 C++11 名称而不是 boost ...

```
int main()
{
    auto f =  std::async(std::launch::async, calculate_the_answer_to_life_the_universe_and_everything);

    while(f.wait_for(std::chrono::seconds(1)) == std::future_status::timeout)
        std::cout << "waiting!" << std::endl;

    std::cout << f.get() << std::endl;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T00:29:56.550

> 我一直在玩弄 Boost 的未来，想知道它们是否是一种可接受且安全的方式来检查单个线程是否已完成。

Futures 是一种异步评估机制，而不是同步机制。尽管某些原语确实具有同步属性 ( `future<>::get`)，但该库并非旨在*同步*，而是触发任务并在需要结果之前忽略它。

# c# - 将 Firefox 嵌入到 .NET 控件中

> ID：12083146
> 
> 赞同：3
> 
> 时间：2012-08-23T00:17:28.317
> 
> 标签：c#, .net, firefox, webbrowser-control, instance

我是 c# 和 .net 编程的初学者，我想知道我是否可以使用 Mozilla Firefox 作为 webBrowser 控件的实例浏览器，因为默认情况下 webBrowser 控件使用 Internet Explorer。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-23T00:23:47.960

[Mozilla ActiveX 控件](http://www.adamlock.com/mozilla/control.htm)使用Gecko 布局引擎为 ActiveX 开发人员提供完全可编程的 HTML 和 XML 呈现控件。

该 API 类似于 Internet Explorer ActiveX 控件，因此它保持了高度的兼容性。

Gecko 与支持 Mozilla、Mozilla Firefox 的引擎相同

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T00:21:17.587

某处有一个旧的 WinForms Gecko (Firefox) 控件，但您将获得的最好的非 IE .NET 控件是基于 Chrome的[Awesomium 。](http://awesomium.com/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T00:29:06.410

这是您可以使用的[Mozilla ActiveX 控件。](http://www.adamlock.com/mozilla/control.htm#download)

安装后，
在 Visual Studio 中转到

```
 Toolbox>right-click>choose items>COM Components>Mozilla Browser Class 
```

# c++ - 哪个寄存器指向堆？

> ID：12083148
> 
> 赞同：4
> 
> 时间：2012-08-23T00:17:57.037
> 
> 标签：c++, assembly, arm, heap-memory

我刚学完 ARM 架构/汇编。如果 SP 寄存器保存下一个要放入数据的内存位置的地址，那么堆的地址是什么？例如，在 C++ 中，如果您在堆上声明一个对象（例如`MyObj example = new MyObj();`），程序集会是什么样子，从某种意义上说，它知道在哪里`example`吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-23T00:22:18.540

SP 寄存器通常用于跟踪堆栈中的当前位置。这意味着它几乎需要始终指向堆栈。

对于堆则不能这样说。当您需要访问变量时，该变量的地址将存储在指针或应用程序的其他内存引用中。在需要该地址时，可以使用寄存器来进行引用。但是，哪个寄存器的详细信息不仅取决于编译器，而且还可能取决于从同一编译器优化代码后哪个寄存器可用。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-23T06:33:30.917

在这种情况下，堆栈是 OS/EABI 提供的较低级别的结构。这就是为什么有一个传统的寄存器。但是，堆是操作系统提供的更高级别的结构。因此，管理和使用它取决于与您的应用程序和操作系统的协议。在汇编术语中，您将使用该堆并通过寄存器取消引用某些地址。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-23T10:52:11.607

处理器需要一个用于堆栈指针的特殊寄存器，因为有时（中断或异常）处理器硬件必须直接修改 SP，而不执行任何代码。这对于堆来说不是必需的，因此不需要使用特殊的寄存器来指向堆。在运行时，操作系统决定特定代码块可以在堆上存储东西的位置，并且任何寄存器都可以用来保存该地址。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T05:55:36.627

在 ARM 的 EABI 中，R13 (SP) 指向完整降序堆栈上最后推送的数据。然而，没有必要一直指出，这样的代码可以是合法的：

考虑到 r0 指向我们的程序可以访问的有效内存位置。

```
stmfd r0!, {r1-r12, sp, lr}
ldr   r1, [r0]
mov   r2, lr
sub   lr, sp, #4
str   sp, [r4]
add   sp, lr, #4
ldmfd r0!, {r1-r12, sp, pc} 
```

当然这没有意义，但唯一的一点是，如果你可以安全地重新加载 sp、lr 和所有其他被调用者保存的寄存器，你可以随意刮擦它们，同时记住在返回调用者之前恢复它们的值.

另一点，堆栈和堆可能不一定相同，堆是 malloc/free 类型构造的更高级别抽象，而堆栈用于在只有 4 个寄存器不够或用于传递函数参数、数据结构和你可以想象，但堆栈有点难以管理，因为你必须自己跟踪所有数据，而不是仅仅将区域分配给指针，然后在完成后释放它。

通常取决于程序和环境，您可以使用各种技巧和东西进行优化，例如故意破坏一些非临时寄存器并摆脱它，但是您必须在调用者函数中管理它，并且它应该知道寄存器这将在随后的函数调用中被划伤，因此 EABI 可能仅在将控制权转移到另一个程序或接管时才有意义，您可以在 cpu 上做您喜欢的事情，只要确保它像之前一样干净进入了那个地方。

# regex - Vim 中将计数 1 或冒号的正则表达式

> ID：12083154
> 
> 赞同：0
> 
> 时间：2012-08-23T00:19:31.997
> 
> 标签：regex, vim

我对使用带有正则表达式的 vim 相当陌生，我需要计算 .csv 文件中的特定条目。条目采用以下形式：

```
9,1,8-Mar-11,high,A2,mid,500,1000,0.143494345,0.153521446,1121.386992,409.6833333,,
9,2,8-Mar-11,high,A2,mid,500,1000,0.180015537,0.256840072,1190.977918,420.8229933,1,
9,3,8-Mar-11,high,A2,mid,500,1000,0.250273568,0.16378268,1061.417761,419.1692065,,1 
```

我需要计算 11 年 3 月 8 日的 A2 条件的数量，这些条件在行的末尾有一个`,,`或一个`,1 (,|1)`或一个。`(,|1),1`

这是我在 vim 中用来获取一些计数数据的正则表达式：

```
:%s/.*8-Mar-11.*A2.*,,1$//gn 
```

我想知道有没有办法在vim中使用？像：

```
:%s/.*8-Mar-11.*A2.*,1\(,|1\)//gn 
```

非常感谢任何建议或帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T00:23:17.463

VIM 正则表达式很奇怪而且令人困惑。你必须逃避`|`as `\|`for 或

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T03:25:34.000

当您编写一个搜索一个或另一个字符的正则表达式时，使用管道进行交替是多余的。改用字符类：

```
:%s/.*8-Mar-11.*A2.*,1[,1]//gn 
```

# python - setup.py 遇到问题

> ID：12083158
> 
> 赞同：2
> 
> 时间：2012-08-23T00:19:41.940
> 
> 标签：python, module, setup.py

我使用 python 已经有一段时间了，但我不记得我以前是如何安装模块的，我不需要永远这样做。我最近重新安装了 ubuntu，所以现在我需要。

首先，我尝试运行 setup.py 并得到这个：

```
nicholas@nicholas-K53E:~$ python setup.py install
python: can't open file 'setup.py': [Errno 2] No such file or directory 
```

我尝试使用突触来安装 BeautifulSoup，但它也没有工作，python 告诉我没有命名的模块。

一些论坛说这与位于错误的工作目录有关，因此我 cd 进入我的 Python26 文件夹并尝试从那里运行 python ./setup.py install ，但它仍然无法正常工作。我不确定这笔交易是什么。

有什么指导吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T00:36:25.707

```
sudo apt-get install python-setuptools 
```

**或者**

```
sudo aptitude install python-setuptools 
```

然后运行：

```
sudo easy_install <module> 
```

例如

```
sudo easy_install BeautifulSoup 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T00:32:44.127

`sudo aptitude install python-beautifulsoup`应该为你做。Synaptic 没问题，但我更喜欢 aptitude 有很多原因（CLI 显然是其中之一）。你想要的大部分模块都应该可以通过你的包管理器获得，beautifulsoup 绝对应该是。如果该命令对您不起作用，则您需要查看其他问题。

您绝对应该能够将[easy_install](http://packages.python.org/distribute/easy_install.html)用于更流行的软件包，并且就使用而言，`setup.py`您需要位于实际包含它的目录中。`ls | grep setup.py`当您在正确的工作目录中时，会为您返回什么？`setup.py`通常附带下载的包，因此请确保您实际上位于包含该包的文件夹中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T00:42:59.167

查看其他建议使用 Ubuntu (aptitude) 附带的包管理器的答案。这是最简单的方法。

但是，要回答您的具体问题，要安装基于[Distutils](http://docs.python.org/install/index.html#the-new-standard-distutils)的包，您需要下载包，解压缩，然后运行 ​​setup.py 脚本。

以 BeautifulSoup 为例：

从[Beautiful Soup 4.1.3](http://www.crummy.com/software/BeautifulSoup/bs4/download/)下载包（在撰写本文时获取 beautifulsoup4-4.1.3.tar.gz 压缩包）。

```
wget http://www.crummy.com/software/BeautifulSoup/bs4/download/beautifulsoup4-4.1.3.tar.gz
tar xvfz beautifulsoup4-4.1.3.tar.gz
cd beautifulsoup4-4.1.3
sudo python setup.py install 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-06-17T18:51:06.857

Sudo 命令在 Windows 中不起作用。

如果您有要安装的东西，请不要使用 Sudo，而是直接安装您的文件：

例如：如果你**sudo python3 setup.py install**

然后 Windows 用户只需键入**setup.py install**

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-08-15T03:45:48.900

你在用窗户吗？如果是这样，请将其替换为`python`并`C:\python39\python.exe` 键入命令的其余部分。

# java - 使用 Scanner 扫描 Java 中的输入

> ID：12083159
> 
> 赞同：3
> 
> 时间：2012-08-23T00:20:02.413
> 
> 标签：java, loops, input, while-loop, java.util.scanner

此代码检查用户输入是否有效。如果它不是一个数字，它将继续循环，直到它收到一个数字。之后，它将检查该数字是否在界限内或小于界限。它将继续循环，直到收到入站号码。但我的问题是，当我打印选择时，它只显示插入的最后一个数字之后的前一个数字。为什么会这样？

```
public void askForDifficulty(){
    System.out.println("Difficulty For This Question:\n1)Easy\n2)Medium\n3)Hard\nChoice: ");
    int choice = 0;
    boolean notValid = true;
    boolean notInbound = true;
    do{
        while(!input.hasNextInt()){
            System.out.println("Numbers Only!");
            System.out.print("Try again: ");
            input.nextLine();
        }
            notValid = false;
            choice = input.nextInt();
    }while(notValid);

    do{
        while(input.nextInt() > diff.length){
            System.out.println("Out of bounds");
            input.nextLine();
        }
        choice = input.nextInt();
        notInbound = false;
    }while(notInbound);

    System.out.println(choice);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T00:24:51.690

这是因为条件`input.nextInt()`内部`while`消耗了整数，所以它后面的一个读取了下一个。**编辑**您还需要组合这两个循环，如下所示：

```
int choice = 0;
for (;;) {
    while(!input.hasNextInt()) {
        System.out.println("Numbers Only!");
        System.out.print("Try again: ");
        input.nextLine();
    }
    choice = input.nextInt();
    if (choice <= diff.length) break;
    System.out.println("Out of bounds");
}
System.out.println(choice); 
```

# php - PHP gd imagettftext() 高度

> ID：12083160
> 
> 赞同：0
> 
> 时间：2012-08-23T00:20:14.263
> 
> 标签：php, image, gd

有没有办法获得 PHP[`imagettftext()`](http://php.net/manual/en/function.imagettftext.php)字体高度？

我知道我们可以得到宽度[`imagettfbbox()`](http://php.net/manual/en/function.imagettfbbox.php)。我们也可以得到高度吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T00:28:58.067

是的，您显然可以简单地查看[文档](http://php.net/manual/en/function.imagettfbbox.php)。向下滚动并使用浏览器的查找功能搜索以下内容：

```
jodybrabec at gmail dot com 
```

在他的名字下方，他提供了一个不错的 cusotm 功能供您使用。（实际上在这里有一个链接，无需使用查找功能： http: [//php.net/manual/en/function.imagettfbbox.php#105593](http://php.net/manual/en/function.imagettfbbox.php#105593)）

# jquery - AJAX + JQuery 同步问题

> ID：12083172
> 
> 赞同：1
> 
> 时间：2012-08-23T00:22:53.047
> 
> 标签：jquery, ajax

从另一种方法我调用下面的方法，问题是它总是返回 0 而 data[4] 不是 0。如果 javascript 是单线程的，这里怎么会有同步问题？如果不能，请您解释并提出修复建议。

```
function GetVMData(url_s){
    var cpu_USG = 0;
    $.ajax({
           url: url_s,
           crossDomain: true, 
           dataType: 'jsonp',
           success: function(data) {
                   cpu_USG = data[4];
           },
           error: function(xhr, status, error) { 
               alert('failed')
            } 
       });
    return cpu_USG;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T00:27:22.153

您可以使用[jquery deferreds](http://api.jquery.com/category/deferred-object/)：

```
// the function definition
function GetVMData(url_s){
    return $.ajax({
           url: url_s,
           crossDomain: true, 
           dataType: 'jsonp',
           error: function(xhr, status, error) { 
               alert('failed')
            } 
       }).pipe(function(data) { return data[4]; });
}

// function call example
GetVMData('some url').done(function(cpu_USG) {
    alert(cpu_USG);
}); 
```

这个解决方案比使 ajax 请求同步要好得多**。**

# jquery - 查找 html 元素相对于可见浏览器区域的位置

> ID：12083173
> 
> 赞同：1
> 
> 时间：2012-08-23T00:22:55.090
> 
> 标签：jquery, html, position

我有一个很长的网页，所以用户需要滚动才能看到整个内容。

在页面的一半处，我有一个图像元素`<img>`。当此元素位于浏览器的可视区域时，我希望能够确定元素顶部与浏览器中搜索栏底部之间的距离。

我已经安装了 jquery，所以我可以利用它的功能。

有没有一种简单的方法来实现我正在寻找的东西？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T00:30:19.480

你需要[**.offset()**](http://api.jquery.com/offset/)和[**.scrollTop()**](http://api.jquery.com/scrollTop/)然后减去。

# winforms - 制作计时器 c#

> ID：12083181
> 
> 赞同：1
> 
> 时间：2012-08-23T00:23:32.680
> 
> 标签：winforms, c#-4.0

我正在尝试制作一个计时器表单应用程序，该应用程序既可以用作秒表，也可以用作倒计时并勾选一个选项。问题是我似乎无法绘制毫秒。现在，没有毫秒，Tick 方法看起来像这样：

```
 private void timer_Tick(object sender, EventArgs e)
    {
        if (timespan.TotalSeconds > 0)
        {
            timespan = timespan.Add(new TimeSpan(0, 0, -1));
            updateNumericUpDowns();
        }
        else
        {
            timerCountown.Stop();
        }
    } 
```

更新UI的方法：

```
 private void updateNumericUpDowns()
    {
        numericUpDownSeconds.Value = Convert.ToInt32(timespan.Seconds);
        numericUpDownMinutes.Value = Convert.ToInt32(timespan.Minutes);
        numericUpDownHours.Value = Convert.ToInt32(timespan.Hours);
    } 
```

帮助表示赞赏，tnx大家！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T00:28:07.103

不确定我是否在关注。为什么不直接使用`timespan.Milliseconds`？

实际上，您使用的是小时、分钟和秒。如果要显示毫秒，请添加。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T00:31:36.987

我不认为我会相信毫秒分辨率的“timer_Tick”：如果系统负载很重，滴答声会比 1 秒慢还是快？（这会影响经过的毫秒数吗？）尝试将当前时间与已知的开始时间进行比较。

```
private DateTime startTime;

void StartTimer() {
    startTime = DateTime.Now;
    //start timer
}

private void timer_Tick(object sender, EventArgs e)
{
    var currentTime = DateTime.Now;
    timespan = currentTime - startTime; //positive
    bool hasCountdownTerminated = ... //maybe something like timespan < duration + timerResolution
    if (hasCountdownTerminated)
    {
        timerCountown.Stop();
    }
    else
    {
        updateNumericUpDowns();
    }
}    

void updateNumericUpDowns() {
    //use timespan.Milliseconds;
} 
```

# android - Android EditText 最大长度

> ID：12083183
> 
> 赞同：93
> 
> 时间：2012-08-23T00:23:41.167
> 
> 标签：android, android-edittext

我在 EditText 字段中设置了最大文本长度。

```
<EditText
            android:id="@+id/courseDescriptionField"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:inputType="textMultiLine"
            android:lines="5"
            android:maxLength="@integer/max_course_description_limit"
            android:gravity="left|top" >
        </EditText> 
```

然而对我来说问题是，文本 STOPS 出现在 140 个字符之后，但它仍然继续输入，除了文本没有出现，但是，它确实出现在“缓冲区”中（意思是建议的东西）如果这就是你所说的。

作为旁注，我正在使用 TextWatcher 来跟踪限制。有没有办法完全限制文本的数量，这样当有 140 个字符时，按下退格/删除以外的东西时什么都不会发生？

* * *

## 回答 #1

> 赞同：107
> 
> 时间：2012-08-23T00:53:32.323

[Android中EditText的限制文本长度](https://stackoverflow.com/questions/3285412/limit-text-length-of-edittext-in-android)可能重复

采用`android:maxLength="140"`

那应该行得通。:)

希望有帮助

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2013-10-07T10:17:44.820

我有同样的问题。

这是一个解决方法

```
android:inputType="textNoSuggestions|textVisiblePassword"
android:maxLength="6" 
```

感谢[我如何关闭 EditText 中的建议？](https://stackoverflow.com/questions/3789905/how-can-i-turnoff-suggestions-in-edittext)

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2015-12-14T06:47:06.733

```
EditText editText= ....;
InputFilter[] fa= new InputFilter[1];
fa[0] = new InputFilter.LengthFilter(8);
editText.setFilters(fa); 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2016-01-29T17:23:22.923

我有同样的问题。当你添加这个时它工作得很好：

```
android:inputType="textFilter" 
```

到你的`EditText`.

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2017-11-30T11:33:39.850

**你可以试试这个**

```
 EditText et = (EditText) findViewById(R.id.myeditText);
    et.setFilters(new InputFilter[]{ new InputFilter.LengthFilter(140) }); // maximum length is 140 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-09-01T09:42:30.993

如果您使用`maxLength = 6`，有时您输入的这些字符会添加到键盘顶部，称为建议。因此，当您删除输入的字母时，它会先删除建议，然后再删除里面的实际文本`EditText`。为此，您需要删除建议。只需添加

```
android:inputType="textNoSuggestions"` 
```

或者

```
android:inputType="textFilter" 
```

它将删除这些建议。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-08-23T02:19:23.793

如果您想查看计数器标签，您可以使用`app:counterEnabled`and `android:maxLength`，例如：

```
<android.support.design.widget.TextInputLayout
  android:layout_width="match_parent"
  android:layout_height="wrap_content"
  app:counterEnabled="true">

  <EditText
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:maxLength="420" />

</android.support.design.widget.TextInputLayout> 
```

**不要**设置`app:counterMaxLength`，`TextInputLayout`因为它会与`android:maxLength`文本达到大小限制后导致不可见字符的问题发生冲突。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-03-22T09:15:56.360

对我来说，这个解决方案有效：

```
edittext.setInputType(InputType.TYPE_TEXT_FLAG_NO_SUGGESTIONS | InputType.TYPE_TEXT_VARIATION_VISIBLE_PASSWORD); 
```

# dart - 从关闭中抛出异常

> ID：12083186
> 
> 赞同：2
> 
> 时间：2012-08-23T00:23:55.230
> 
> 标签：dart

我一直在尝试设置一个简单的 Serversocket，如果遇到一些错误，我想抛出一个异常（除了一些其他的东西，即设置一个 var 为 false），它使用外部回调工作，但是闭包呢？Dart 编辑器给我一个错误并拒绝运行它！

```
Server(String address,int port,int backlog)
{
    this.s = new ServerSocket(address,port,backlog);
    this.s.onError = (e) => throw new Exception(e);
} 
```

我也尝试过“throw e”之类的东西，但只要“throw”存在，ide就不会运行它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T09:52:39.177

我遇到了同样的问题，Dart 接缝无法接受单行闭包中的抛出。你应该能够做到：

```
Server(String address,int port,int backlog)
{
    this.s = new ServerSocket(address,port,backlog);
    this.s.onError = (e) {
       throw new Exception(e);
    };
} 
```

我没有查看规范，所以我不知道它是故意的还是错误的。

# javascript - Cloudfoundry 上的 JSDOM 抓取不起作用

> ID：12083190
> 
> 赞同：1
> 
> 时间：2012-08-23T00:24:51.797
> 
> 标签：javascript, node.js, cloud-foundry, jsdom

我正在为一个应用程序使用 jsdom node.js 模块，该应用程序执行一些网络抓取以获取它需要的一些数据。当我在本地运行时，这非常有效。

但是，当我将应用程序推送到 cloudfoundry 时，它会崩溃。日志如下：

> ====> /logs/stderr.log <====
> 
> /var/vcap/data/dea/apps/caretogethersandbox-0-8b20af9255bbf552d0f490cb60d0df55/app/node_modules/jsdom/lib/jsdom.js:171 个特征 = JSON.parse(JSON.stringify(window.document.implementation._fea ^TypeError:无法读取未定义的属性“实现”

我在这里缺少什么吗？我很困惑。我知道我编写的代码工作正常，这似乎是模块和 cloudfoundry 之间的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T06:31:12.693

我能够很容易地重现这个问题。似乎 jsdom 依赖于一个名为 Contextify ( [https://github.com/brianmcd/contextify](https://github.com/brianmcd/contextify) ) 的本地编译库，并且从我可以收集到的内容中也有一些与 Python 的绑定。Cloud Foundry 目前不支持这些。Github上有一个关于这个问题的类似问题；

[https://github.com/tmpvar/jsdom/issues/436](https://github.com/tmpvar/jsdom/issues/436)

撰写本文时的最后一篇文章建议使用两个 100% JS 库，称为 Domino 和 Zepto Node，它们可能值得一试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T02:36:16.460

只有你发布的内容几乎不可能给你一个直接的答案。

但我有几个建议。

1.  您的环境变量在生产中的工作方式与在开发中的工作方式不同。

2.  jsdom 依赖于通常从外部加载的 jquery。也许 jquery 没有正确加载。

你听说过[cheerio吗](https://github.com/MatthewMueller/cheerio)？它是 jsdom 的替代方案，它实现了 jquery 的一个子集，并且不需要从外部加载 jquery。这比 jsdom 快得多。

您可以观看作者创建的这个[视频](https://vimeo.com/31950192)，用于介绍 Cheerio 并了解更多它的好处。

使用[Cheerio](https://github.com/MatthewMueller/cheerio) github 页面上的示例代码并将其上传到您的 cloudfoundry 帐户，以查看是否一切正常。然后你可以决定天气切换到cheerio。

# c# - UI 测试生成器未跟踪 UI 对象

> ID：12083198
> 
> 赞同：1
> 
> 时间：2012-08-23T00:26:55.963
> 
> 标签：c#

我正在使用 VS 编码的 UI 测试构建器进行 UI 自动化，有没有办法从 UI 中跟踪控件 ID？我正在为重新运行测试时没有用的控件获取输入捕获窗口的坐标。例如。Mouse.Click(passwordReset, new Point(408, 398)); [我对 msdn http://msdn.microsoft.com/en-us/library/dd286671.aspx](http://msdn.microsoft.com/en-us/library/dd286671.aspx)做了一些研究，并尝试过，但似乎没有任何东西可以映射没有坐标的 UI 控件。请指教。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T01:55:13.760

[这](http://blogs.msdn.com/b/balagans/archive/2009/12/28/9941582.aspx)应该会有所帮助。您真的想使用使用 AutomationId (WPF) 或 Name 的 SearchProperties（WinForms：Name 相当于 SearchProperty Id，Text 相当于 SearchProperty Name，如果我没记错的话，没有多大意义）。我不确定您是如何做到这一点的，但我们必须回到我们的 WPF 视图并将 AutomationId 添加到每个控件中，以便我的同事在设置自动化测试时可以选择它们。

# java - Minecraft ModLoader mod，私有字段 netManager 的问题

> ID：12083205
> 
> 赞同：3
> 
> 时间：2012-08-23T00:28:11.873
> 
> 标签：java, minecraft

所以，我一直在为 Minecraft 制作一个 mod，我需要在其中检查服务器 IP。我目前有代码，但我得到了 NoSuchFieldException，因为它是另一个类的私有字段。我正在使用使用反射的 ModLoaders getPrivateValue。我宁愿不使用私有值，它需要保持私有。这是问题代码：

```
public boolean isMCMEServer(EntityClientPlayerMP player) throws NoSuchFieldException {
    NetworkManager manager = (NetworkManager) ModLoader.getPrivateValue(NetClientHandler.class, player.sendQueue, "netManager");

    Socket socket = (Socket) ModLoader.getPrivateValue(NetworkManager.class, manager, "networkSocket");

    InetAddress address = socket.getInetAddress();
    if(address != null) {
        String hostName = address.getHostName();
        String hostAddress = address.getHostAddress();  
            if((hostAddress.equals(SERVER)) || (hostName.equals(SERVER))) {

                return true;
            }
    }
    return false;
} 
```

我希望我已经提供了足够的信息，提前谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T04:05:54.703

仍在使用私有字段，但事实证明问题在于混淆。

# jquery - 幻灯片动画

> ID：12083208
> 
> 赞同：0
> 
> 时间：2012-08-23T00:28:32.073
> 
> 标签：jquery, animation

我有一个简单的动画问题，基本上，我需要制作一个元素，就好像它看起来向左滑动并从右侧返回下一张图像。画廊作为这样的作品，但不是动画。

这是我所拥有的：

```
$('.slideshow-container').animate({ left: -$(document).width()}, 'slow', function() {
    $('.prev').click();
    $('.slideshow-container').css({left: 'auto'});
    $('.slideshow-container').css({right: $(document).width()});
    $('.slideShow-container').animate({right : 'auto'});
}); 
```

它滑出但并没有真正回来:(

有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T01:23:02.503

**首先**jQuery 动画必须使用数值才能正常工作，不能使用 'auto' 或其他非数值。

**其次**，您不能只使用 1 个元素来执行此操作，因为您希望显示 ONE 从左侧来，而另一个 ONE 则从右侧离开。

**第三**，当使用 jQuery 动画 API 时，我建议只使用类似属性之一，例如*left-right*、*up-down*等等...

所以，你应该做的是实现你想要的：

1.  使用元素在滑块中显示实际图像。
2.  如果用户按下“下一步”，第二个元素的位置就是第一个元素的宽度（您也可以浮动元素来执行此操作）。
3.  如果用户按下“prev”，则第二个元素的位置是其自身的负数。
4.  一旦元素定位正确，您只需要修改Left OR Right CSS属性，但只有一个，同时修改两个都会给您带来麻烦。

干杯

# git - 删除某个提交，就好像它从未发生过一样

> ID：12083212
> 
> 赞同：4
> 
> 时间：2012-08-23T00:29:05.943
> 
> 标签：git

我有一个看起来像的日志

> c2ba4f3cfd3e8b29e634b41d7178ffe38f8c9f0a版本0.1 d825b48fe86107c3842f62c9e9bc5f290a2c2475 TEST2 0a06037c3c29a0c9446707e884d9b2777336db59测试c7453d959fc86d2868076b3900e0fd1ed63e2709开始

所有内容都已推送到我的原始服务器，但我想以这样一种方式合并提交，看起来我所做的唯一一个就是带有评论的那个`version 0.1`。当我推送它时，服务器必须反映提交合并。

简而言之，我希望存储库有一个包含我命名的内容的单一提交。

我整天都在尝试变基，但未能获得预期的结果。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T02:21:33.960

强制性警告：更改已推送到远程存储库的历史记录对于使用该存储库的其他人来说可能是一个巨大的头痛。

交互式[变基](http://git-scm.com/docs/git-rebase "变基")将带您到达那里。

```
# start an interactive rebase onto the parent (~) of 'begin'
git rebase -i c7453d9~ 
```

交互式 rebase 会将您弹出到如下所示的编辑器中：

```
pick c7453d9 begin
pick 0a06037 test
pick d825b48 test2
pick c2ba4f3 version 0.1 
```

**如果您想保留所有提交中的所有更改但使它们看起来像一个提交**，请将其更改为：

```
reword c7453d9 begin
fixup 0a06037 test
fixup d825b48 test2
fixup c2ba4f3 version 0.1 
```

`reword`将提示您更改提交消息（将其更改为“版本 0.1”），并将`fixup`从提交中提取所有内容到上一个提交中。最终结果将是一个包含所有四个内容的提交。

完成同样事情的另一种方法：

```
pick c7453d9 begin
fixup 0a06037 test
fixup d825b48 test2
squash c2ba4f3 version 0.1 
```

`squash`将提交的内容拉入上一个提交，但允许您更改提交消息（在本例中为“版本 0.1”）。

**如果您想完全放弃前三个提交的更改并只保留最后一个提交的更改**，请将 rebase 行更改为：

```
pick c2ba4f3 version 0.1 
```

本质上，删除前三行。最终结果将只是“版本 0.1”提交，没有来自先前提交的任何内容。

[修改历史记录](http://git-scm.com/docs/git-push)后，您需要使用`--force`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T01:30:28.900

您可以删除其间的提交。

```
git reset --mixed c7453d9
git checkout c2ba4f3cf -- .
git add -A
git commit -C c2ba4f3cf 
```

# xcode - 如何解决在 Xcode 中使用 Mercurial 进行的重构

> ID：12083215
> 
> 赞同：1
> 
> 时间：2012-08-23T00:29:40.483
> 
> 标签：xcode, mercurial, refactoring

我有一些我开始在 iOS 项目中重构的文件。我通过 Xcode 进行了重构，当我运行“hg status”时，它显示了一堆新的和已删除的文件（如预期的那样）。我想弄清楚的是解决这个问题并让 Mercurial 知道这些变化的最佳方法。有没有我可以用来处理这个的命令？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T02:56:10.067

`hg addremove`是你的朋友。[您可以在此处](http://hgtip.com/tips/advanced/2009-09-30-detecting-renames-automatically/)获取更多信息并运行`hg help addremove`

# iphone - 无法获取 MKMapView 的 UIBezierPath

> ID：12083220
> 
> 赞同：0
> 
> 时间：2012-08-23T00:30:10.723
> 
> 标签：iphone, objective-c, ios

我有一个 MKMap，除此之外我还有一个小传奇。图例中的标签和图像成功显示在地图顶部，但矩形/贝塞尔曲线本身不显示。我尝试将其添加为子视图，但失败了。有没有解决的办法？

我需要触摸才能为地图启用。

谢谢。

```
- (void) drawRect:(CGRect)rect
{
    //TODO
        //Hover view for touching icons
        //Get rect on top of map as well
        //Border on frame
        //IsIpad slight larger frame/text/image
    int conX = [GeneralHelper GetCenteredXPosForObj:220 :self];
    int conY = 60;

    //Create box
    CGRect container = CGRectMake(conX, conY, 220, 50);
    UIBezierPath* path = [UIBezierPath bezierPathWithRoundedRect:container cornerRadius:5.0];
    [[UIColor blueColor] setFill];
    [path fillWithBlendMode:kCGBlendModeNormal alpha:0.7];
    //How to add to subview..?

    //NZPost image 38x37
    UIImageView *nzPostImageView = [[UIImageView alloc] initWithFrame:CGRectMake(conX + 20, conY+15, 25, 24)];
    [nzPostImageView setImage:[UIImage imageNamed:@"icon-map-post.png"]];
    [self addSubview:nzPostImageView];

    //NZPost label
    LegendLabel *postLabel = [[LegendLabel alloc] initWithFrame:CGRectMake(conX + 50, 78, conY, 15) ];
    postLabel.text = @"NZ post";
    [self addSubview: postLabel];

    //Incharge image 38x38
    UIImageView *inChargeImageView = [[UIImageView alloc] initWithFrame:CGRectMake(conX + 120, conY+15, 25, 24)];
    [inChargeImageView setImage:[UIImage imageNamed:@"icon-map-incharge.png"]];
    [self addSubview:inChargeImageView];

    //Incharge label
    LegendLabel *inChargeLabel = [[LegendLabel alloc] initWithFrame:CGRectMake(conX + 150, conY+18, 60, 15) ];
    inChargeLabel.text = @"In charge";
    [self addSubview: inChargeLabel];

} 
```

# shell - 如何加快异步 shell 命令的 emacs 输出？

> ID：12083228
> 
> 赞同：19
> 
> 时间：2012-08-23T00:31:18.893
> 
> 标签：shell, emacs, elisp

我正在使用 shell 命令在 emacs 缓冲区中运行应用程序的输出。

```
(shell-command "verbose-app &" "*verbose-app*") 
```

问题是这个命令非常冗长。如此之多，以至于 emacs 缓冲区有时需要几秒钟才能赶上。它与实际输出滞后几秒钟。

有什么方法可以通过禁用某些东西来加速输出滚动？像正则表达式匹配或语法高亮？

备查：

详细的应用程序是 adb logcat。我改变了我现有的功能：

```
(defun adb-logcat ()
  (interactive)
  (shell-command "adb logcat -v threadtime&" "*adb-logcat*")
  (pop-to-buffer "*adb-logcat*")
  (buffer-disable-undo)) 
```

到以下：

```
(defun adb-logcat ()
  (interactive)
  (start-process "*adb-logcat*" "*adb-logcat*" "/bin/sh" "-c" "adb logcat -v threadtime")
  (pop-to-buffer "*adb-logcat*")
  (buffer-disable-undo)) 
```

它现在滚动得更快。耶！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-28T07:41:21.753

就像文档说的那样，`shell-command`在劣质 shell 中运行命令，暗示`shell-mode`. 如果您只想要输出而不想要任何功能，那么运行命令`start-process`可能更接近您想要的。

```
(start-process "*verbose-app*" "*verbose-app*"
 "/bin/sh" "-c" "verbose-app") 
```

将它包装成一个函数应该不会太难。您可能想看看如何`shell-command`实现异步命令；例如，如果您在另一个已经存在的情况下尝试创建一个进程，它会询问是否应该终止现有进程。 [http://git.savannah.gnu.org/cgit/emacs.git/tree/lisp/simple.el#n2447](http://git.savannah.gnu.org/cgit/emacs.git/tree/lisp/simple.el#n2447)可能是一个很好的起点。（如果链接坏了，这是一个到 inside 的链接`defun shell-command`，指向一个关于处理 & 符号的评论。如果它在那里，命令将异步运行。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T00:27:33.343

如果命令很冗长，那么实时捕获完整输出有什么用吗？也许您可以`verbose-app > app.log`在后台运行，然后`while true; do tail -n50 app.log; sleep 1; done`在 emacs 中运行类似的东西来不断更新缓冲区以查看日志文件的最后几行。稍后当您想要完整输出时，您可以在 emacs 中打开日志文件。

# iphone - 如何在 UIBezierPath 上获得边框

> ID：12083229
> 
> 赞同：6
> 
> 时间：2012-08-23T00:31:24.423
> 
> 标签：iphone, objective-c, ios

我有这个

```
CGRect container = CGRectMake(conX, conY, 220, 50);
    UIBezierPath* path = [UIBezierPath bezierPathWithRoundedRect:container cornerRadius:5.0];
    [[UIColor blueColor] setFill];
    [path fillWithBlendMode:kCGBlendModeNormal alpha:0.7]; 
```

我想在它周围找一个灰色的蛀虫，在网上看了很多东西，但看不到一种容易做到的方法，这可能吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-08-23T01:04:29.213

如果您不反对使用图层，那么这样的事情可能对您有用：

```
//create triangle path
UIBezierPath* path = [UIBezierPath bezierPath];
[path moveToPoint:CGPointMake(0, 30)];
[path addLineToPoint:CGPointMake(100, 30)];
[path addLineToPoint:CGPointMake(100, 0)];
[path addLineToPoint:CGPointMake(0, 30)];

//apply path to shapelayer 
CAShapeLayer* greenPath = [CAShapeLayer layer];
greenPath.path = path.CGPath;
[greenPath setFillColor:[UIColor greenColor].CGColor];
[greenPath setStrokeColor:[UIColor blueColor].CGColor];
greenPath.frame=CGRectMake(0, 0,100,30);

//add shape layer to view's layer
[[self layer] addSublayer:greenPath]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-04-09T22:50:17.457

您可以使用此扩展获得 bezierPath。

```
let path = UIBezierPath(yourView.bounds, cornerRadius: 12) 

let layer = CAShapeLayer()
layer.masksToBounds = false
layer.path = path.cgPath
layer.strokeColor = UIColor.red.cgColor
layer.fillColor = UIColor.clear.cgColor
layer.lineWidth = 5
layer.addSublayer(topLayer)

extension UIBezierPath {

        static func borderPathInRect(_ drawRect: CGRect, cornerRadius: CGFloat) -> UIBezierPath {
            let path = UIBezierPath()
            path.move(to: CGPoint(x: drawRect.origin.x, y: cornerRadius))

            path.addArc(withCenter: CGPoint(x: cornerRadius, y: cornerRadius),
                        radius: cornerRadius,
                        startAngle: CGFloat.pi,
                        endAngle: 3/2*CGFloat.pi ,
                        clockwise: true)

            path.addLine(to: CGPoint(x: drawRect.size.width - cornerRadius, y: 0))
            path.addArc(withCenter: CGPoint(x: drawRect.size.width - cornerRadius, y: cornerRadius),
                        radius: cornerRadius,
                        startAngle: 3/2*CGFloat.pi,
                        endAngle:  2*CGFloat.pi,
                        clockwise: true)

            path.addLine(to: CGPoint(x: drawRect.size.width, y: drawRect.size.height  - cornerRadius))
            path.addArc(withCenter: CGPoint(x: drawRect.size.width - cornerRadius, y: drawRect.size.height - cornerRadius),
                        radius: cornerRadius,
                        startAngle: 0,
                        endAngle:  CGFloat.pi/2,
                        clockwise: true)

            path.addLine(to: CGPoint(x: cornerRadius, y: drawRect.size.height))
            path.addArc(withCenter: CGPoint(x: cornerRadius, y: drawRect.size.height - cornerRadius),
                        radius: cornerRadius,
                        startAngle: CGFloat.pi/2,
                        endAngle:  CGFloat.pi,
                        clockwise: true)

            path.addLine(to: CGPoint(x: 0, y: cornerRadius))
            path.lineJoinStyle = .round

            return path
        }
    } 
```

# python - python urllib2 urlopen 响应

> ID：12083231
> 
> 赞同：19
> 
> 时间：2012-08-23T00:32:02.507
> 
> 标签：python, urllib2, urlopen

python urllib2 urlopen 响应：

```
<addinfourl at 1081306700 whose fp = <socket._fileobject object at 0x4073192c>> 
```

预期的：

{“令牌”：“mYWmzpunvasAT795niiR”}

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-08-23T00:47:26.073

您需要将生成的类文件对象绑定到一个变量，否则解释器只是通过以下方式转储它`repr`：

```
>>> import urllib2
>>> urllib2.urlopen('http://www.google.com')
<addinfourl at 18362520 whose fp = <socket._fileobject object at 0x106b250>>
>>> 
>>> f = urllib2.urlopen('http://www.google.com')
>>> f
<addinfourl at 18635448 whose fp = <socket._fileobject object at 0x106b950>> 
```

要获取实际数据，您需要执行`read()`.

```
>>> data = f.read()
>>> data[:50]
'<!doctype html><html itemscope="itemscope" itemtyp' 
```

要查看返回的标题：

```
>>> print f.headers
Date: Thu, 23 Aug 2012 00:46:22 GMT
Expires: -1
Cache-Control: private, max-age=0
... etc ... 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-23T00:47:09.163

在您致电后添加以下内容`urlopen`

```
print feed.read() 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T02:18:33.130

也许您会发现使用该[`requests`库](http://docs.python-requests.org)比使用`urllib2`.

# c++ - pthread 比没有线程慢

> ID：12083234
> 
> 赞同：1
> 
> 时间：2012-08-23T00:32:37.907
> 
> 标签：c++, multithreading, thread-safety, pthreads

您好，我尝试在我的塔防中添加线程以使其更快，但现在速度慢了很多。

代码的结构很简单

主要从 sdl opengl init 和 init 开始。然后游戏循环。无线程顺序：1：键盘和鼠标事件优先 2：gameManager 3：drawGlScene

gameManager 计算一切：移动怪物，攻击怪物，创建攻击动画和声音，检查你是赢还是松，如果波完成，怪物产卵和功能运行 2 次如果速度模式打开。和其他一些小功能。

绘图功能使用所有数据来绘制一切。使用绘图功能修改数据为 0

我使用的 cpu 是四核的，这里是 main 中的视觉部分第一步 init 线程的东西

```
int main ( int argc, char** argv )
{
 pthread_t t_engine;
 pthread_attr_t attr;
 pthread_attr_init(&attr);
 pthread_attr_setdetachstate(&attr, PTHREAD_CREATE_JOINABLE); 
```

然后所有其他初始化内容和游戏循环的开始都以 sdl 事件开关开始（仍在游戏循环中）：

```
//calculate everything if we are in playing gamestate
    if(id == MODE_PLAY)
    {
        rc = pthread_create(&t_engine, &attr, gameManager, (void *)t);
        if (rc)
        {
            printf("ERROR; return code from pthread_create() is %d\n", rc);
            exit(-1);
        }
        //gameManager((void *)t);
    }

    //draw everything
    DrawGLScene();

if(id == MODE_PLAY)
    {
        rc = pthread_join(t_engine, &status);
        if (rc)
        {
            printf("ERROR; return code from pthread_create() is %d\n", rc);
            exit(-1);
        }
    } 
```

游戏管理器：

```
void *gameManager(void *t)
{
  //then lot of stuff
  //function ending like this
  pthread_exit((void*) t);
} 
```

ps：我使用的是 Windows 7，我的 ide 是代码块，我使用 gnu gcc 编译器 pps：我也尝试过互斥锁、sem 和其他东西，但没有真正的不同，谢谢你花时间帮助我（=

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T01:21:50.463

这一点来自您对问题的解释：

> 然后是所有其他初始化内容和游戏循环的开始

让我相信执行上述`pthread_create()`/的代码片段`pthread_join()`是在循环中完成的。

如果是这种情况，请意识到重复创建/销毁线程是昂贵的。您需要考虑在您的对象中放置一个游戏循环，并将该循环与使用信号量、条件变量或线程屏障等`gameManger`执行该循环的循环同步。`DrawGLScene()`除了使用线程终止作为同步技术之外，几乎没有其他任何东西。

# rdf - 带三重存储的 PAAS？

> ID：12083237
> 
> 赞同：-1
> 
> 时间：2012-08-23T00:33:21.910
> 
> 标签：rdf, paas

有谁知道提供 RDF 三元存储作为存储选项的 PAAS？我的 google foo 让我失望了。

我正在寻找一个类似于 OpenRDF/sesame 的三元存储库，具有 RDFS 和 OWL 推理支持。PAAS 最好支持 ruby​​ 和 nodejs。任何语言支持都很好...

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T13:39:51.420

[我认为Dydra](http://dydra.com/)有资格成为 PaaS，但我认为他们不会进行任何推理。我可能是错的，但我认为是这种情况，您需要在将它们从列表中删除之前仔细检查。

[Stardog](http://stardog.com)虽然不是 PaaS，但确实提供了可扩展的 RDFS 和 OWL2 配置文件推理。它为 Sesame 的 Repository API 提供 API 绑定，并有一个非常完善的 HTTP API 和基于 Google 协议缓冲区的本机协议。一个实现 HTTP API 的 javascript 库计划在未来几周内发布。

[OWLIM](http://www.ontotext.com/owlim)类似于 Stardog，是一个 rdf 数据库，我认为它提供了 RDFS & OWL2 RL 推理。我知道他们为 Sesame 的 Repository API 提供支持，但我不知道他们是否也实现了他们的 HTTP API。如果您只坚持使用 Java，可能是一个选择。

免责声明是我是 Stardog 的首席开发人员。

# mysql - linq mysql：选择多个列并发送到查看

> ID：12083239
> 
> 赞同：1
> 
> 时间：2012-08-23T00:33:35.460
> 
> 标签：mysql, linq, select

我从表中选择了多个列，但我不知道如何将其传递给我的视图。

```
 var result = (from f in db.firmware
               where f.firmware_release_type_text != "" 
                     || f.firmware_release_type_text != null 
                     || f.firmware_release_number_int != 0
               select new{
                    f.firmware_release_type_text, 
                    f.firmware_release_number_int
               }).Distinct(); 
```

结果是 f__anonymous2。我想知道如何在我看来使用它。所有的论坛都刚刚回答了如何选择多个列，但没有人提到如何通过它们。我想我错过了一些明显的东西。

我希望能够使用这些字段，甚至将它们合并为一个字符串。

我已经尝试过 Cast 和许多其他不起作用的选项。

当我尝试强制施放它时，我得到：

```
Unable to cast the type 'Anonymous type' to type 'System.String' 
```

谢谢

更新：

最后我选择了：

```
var result = (from f in db.firmware
              where (f.firmware_release_type_text != "") 
                    && (f.firmware_release_type_text != null) 
                    && (f.firmware_release_number_int != 0)
              select  new{
                          f.firmware_release_type_text, 
                          f.firmware_release_number_int
                      }
              ).Distinct();

        List<string> result2 = new List<string>();
        foreach (var item in result)
        {
            result2.Add(item.firmware_release_type_text 
                        + "-" + item.firmware_release_number_int);
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T00:40:08.317

如果要将数据作为字符串返回，则必须说明应如何格式化。例如，您可以更改此：

```
select new
{
    f.firmware_release_type_text , f.firmware_release_number_int
} 
```

对此：

```
select f.firmware_release_type_text + " v" + (int)f.firmware_release_number_int 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T20:19:17.420

您有两个选项可以首先创建模型，然后在服务器端格式化数据。

# ios - 录制音频时状态栏不会变为红色

> ID：12083242
> 
> 赞同：1
> 
> 时间：2012-08-23T00:34:03.097
> 
> 标签：ios, avfoundation, statusbar

我在 Mountain Lion 上使用 Xcode 4.4 和 iOS 5.1 模拟器。我尝试先用 AVAudioRecorder 录制一些东西，我以为状态栏会变成红色，但事实并非如此。

如何将状态栏的颜色更改为红色？

编辑 .plist 文件对我没有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-08-29T14:38:35.667

The red bar doesn't show up on the simulator. Only on real devices.

# winapi - 选项卡控件工具提示的位置

> ID：12083243
> 
> 赞同：0
> 
> 时间：2012-08-23T00:34:22.193
> 
> 标签：winapi, tabs, tabcontrol, tooltip

我创建了一个 TCS_TOOLTIPS 样式的选项卡控件，因此当鼠标悬停在选项卡项目上时，它会显示一个工具提示，其中显示一些信息。

工具提示始终与光标和光标下方具有相同的 x 位置。

我想让工具提示的 y 位置准确地位于选项卡控件的底部。在这种情况下，我还需要增加工具提示的 x 位置，以避免光标和工具提示重叠。

但是我找不到任何信息来调整选项卡控件的工具提示的位置。这与`TTM_TRACKPOSITION`国旗有关`TOOLINFO`吗？当我创建这个选项卡控件时，我只知道：通过发送 TCM_GETTOOLTIPS 消息获取工具提示的 hwnd ；处理 WM_NOTIFY 消息并填充 TTN_GETDISPINFO 结构以显示工具提示。但是我没有找到任何有关该职位的信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T01:04:11.403

子类化工具提示控件并通过捕获 WM_WINDOWPOSCHANGING 消息来修改它的位置。

# web-services - Apache CXF (2.6.1)：客户端得到“prolog 中不允许内容”

> ID：12083244
> 
> 赞同：1
> 
> 时间：2012-08-23T00:34:40.950
> 
> 标签：web-services, apache, jaxb, cxf, xmlbeans

我在我的 java 应用程序中使用 Apache CXF (2.6.1) 来使用 3rd 方 Web 服务。但是我有一个问题，特别是如果我在生成存根时使用 JAXB 进行数据绑定，我的客户端将始终发送带有“标头”的请求，例如“--uuid:e47f145b-38f7-4402-8eec-657d71bc8ad4...”（参见下面的客户端请求），即除了 XML 部分还有一些特殊信息......

看起来这个特殊信息会导致来自服务器的错误回复“序言中不允许内容”（请参阅​​下面的服务器响应），即服务器不期望这样的正文。这里有趣的是，如果我使用 XMLBEANS 生成存根进行数据绑定，一切都开始正常工作（请求正文中没有这样的“特殊”信息，只有 XML）。经过一番谷歌搜索后，我怀疑我的客户出于某种原因尝试使用 MTOM（带有 JAXB），但我不知道如何将其关闭。我已经尝试了以下方法来关闭 MTOM（没有运气）：

```
((BindingProvider)port).getRequestContext().put("mtom-enabled", Boolean.FALSE);
((BindingProvider)port).getRequestContext().put("write.attachments", Boolean.FALSE);
((BindingProvider)port).setMTOMEnabled(false); 
```

请帮助我真的很想迁移到 JAXB，因为它与 XMLBEANS 相比更紧凑......

**客户端代码：**

```
AdminServiceV2 ws = new AdminServiceV2();
AdminV2 port = ws.getAdminPortV2();

Client client = ClientProxy.getClient(port);
HTTPConduit http = (HTTPConduit) client.getConduit();

AuthorizationPolicy authorizationPolicy = new AuthorizationPolicy();
authorizationPolicy.setUserName("user1");
authorizationPolicy.setPassword("password1");
authorizationPolicy.setAuthorizationType("Basic");
http.setAuthorization(authorizationPolicy); 

try {
    port.getUsersInfo("user1");
} catch (Exception e) {
    e.printStackTrace();
} 
```

**客户要求：**

```
--uuid:e47f145b-38f7-4402-8eec-657d71bc8ad4
Content-Type: text/xml; charset=UTF-8; type="text/xml";
Content-Transfer-Encoding: binary
Content-ID: <root.message@cxf.apache.org>

<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Body><ns2:getUsersInfo xmlns:ns2="http://service.admin.ws.five9.com/v2/"><userNamePattern>user1</userNamePattern></ns2:getUsersInfo></soap:Body></soap:Envelope>
--uuid:e47f145b-38f7-4402-8eec-657d71bc8ad4-- 
```

**服务器响应：**

```
<env:Envelope xmlns:env='http://schemas.xmlsoap.org/soap/envelope/'><env:Header></env:Header><env:Body><env:Fault xmlns:env='http://schemas.xmlsoap.org/soap/envelope/'><faultcode>env:Client</faultcode><faultstring>org.xml.sax.SAXParseException: Content is not allowed in prolog.</faultstring></env:Fault></env:Body></env:Envelope> 
```

谢谢，康斯坦丁

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T20:26:26.877

Daniel Kulp 在 CXF 用户邮件列表中回答了这个问题，详情请参阅 [http://cxf.547215.n5.nabble.com/Apache-CXF-2-6-1-Client-gets-Content-is-not-允许在序言 td5713009.html#a5713055](http://cxf.547215.n5.nabble.com/Apache-CXF-2-6-1-Client-gets-Content-is-not-allowed-in-prolog-td5713009.html#a5713055)。简而言之，问题在于 WSDL（它包含 swaRefs），它强制 CXF 发送带有附件的消息。还提供了解决方法...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T00:50:17.083

没有 CXF 请求通常以 --uuid 开头。这是通过多部分 HTTP 消息的一部分。不管有没有 MTOM，一个普通的 SOAP 消息都由一个 HTTP 头和 XML 内容组成。如果是 MTOM，则 HTTP 标头声明为多部分，然后有多部分分隔符和子标头。

如果您使用自定义前端来请求没有通常所需的 HTTP 标头的“纯 XML”消息，那么与 MTOM 结合使用可能会产生不良影响。

`@XmlMimeType("application/octet-stream")`如果您有注释，JAXB 通常只会启用 MTOM 。您还应该查看服务的 WSDL/XSD，看看它是否有 xmime 注释。

有关详细信息，请参阅[CXF MTOM 文档](http://cxf.apache.org/docs/mtom-attachments-with-jaxb.html)。

您尚未指定 CXF 版本或如何配置 CXF 客户端端点。通过将所有数据发送到 CXF 用户邮件列表，您可能会获得更好的帮助。

# javascript - Dijit 小部件添加另一个输入字段？

> ID：12083250
> 
> 赞同：0
> 
> 时间：2012-08-23T00:35:15.467
> 
> 标签：javascript, html, dojo

我在推荐我可以在下面的屏幕截图中使用什么 dijit 小部件。我们的用户将需要添加另一行。

![添加另一行](../Images/6ed134d44ed85bb0fd292a66dc497b7c.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T19:58:48.093

可以使用

```
function createRow(ParentNode) {
    require(["dojo/_base/parser", "dojo/dom-construct"], function(parser, domConstruct){
      var div = dojo.create("div", { 'data-dojo-type' : 'dijit.form.TextBox' }, ParentNode);
      parser.parse(div);
    };
} 
```

或者

```
function createRow(ParentNode) {
     var row = new dijit.form.TextBox( { /* params */ } );
     row.placeAt(ParentNode);
     row.startup();
} 
```

和

```
<div id="parent">
  <div data-dojo-type="dijit.form.TextBox"></div>
</div>
<div 
  data-dojo-type="dijit.form.Button"
  data-dojo-props="onClick: function() { createRow('parent'); }"
></div> 
```

# python - 是否可以使用 NDB 确定模型是否在数据存储中持久化？

> ID：12083254
> 
> 赞同：15
> 
> 时间：2012-08-23T00:35:44.197
> 
> 标签：python, google-app-engine

我正在从迁移`db.Model`到`ndb.Model`. 在完成此迁移之前我必须解决的唯一问题是没有`Model.is_saved`方法。我`db.Model.is_saved`在我的应用程序中使用来确定是否必须在`put`/上更新分片计数器`delete`，以检查创建实体时是否存在冲突键等。

文档说`ndb.Model`没有等效的`is_saved`方法。`get_or_insert`我可以用而不是重新实现一些用例`is_saved`。但不是全部。

作为一个肮脏的黑客，我可以`_in_memory_instance`为我通过调用构造函数创建的每个实例设置标志。但这并不能解决我的问题。至少在每次`put()`通话后我仍然需要更新这个标志。

问题是：是否有更好的方法来确定模型是否在数据存储中持久存在而没有额外的数据存储命中？

编辑1：忘了提：所有实体都有密钥，所以检查对`Model._has_complete_key()`我不起作用。

编辑 2：经过讨论[https://groups.google.com/d/topic/google-appengine/Tm8NDWIvc70/discussion](https://groups.google.com/d/topic/google-appengine/Tm8NDWIvc70/discussion)似乎是解决我的问题的唯一方法是使用`_post_get_hook`/ `_post_put_hook`。我想知道为什么官方 API 中没有包含这样一个微不足道的东西。

编辑 3：我最终为所有模型创建了下一个基类。现在我可以（几乎）保持我的代码库不变：

```
class BaseModel(ndb.Model):

    @classmethod
    def _post_get_hook(cls, key, future):
        self = future.get_result()
        if self:
            self._is_saved = bool(key)

    def _post_put_hook(self, future):
        self._is_saved = future.state == future.FINISHING

    def is_saved(self):
        if self._has_complete_key():
            return getattr(self, "_is_saved", False)
        return False 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-23T16:20:45.103

要在 NDB 中获得相同的状态，您需要组合使用 post-get-hook 和 post-put-hook 来设置标志。这是一个工作示例：

```
class Employee(ndb.Model):
  <properties here>

  saved = False  # class variable provides default value

  @classmethod
  def _post_get_hook(cls, key, future):
    obj = future.get_result()
    if obj is not None:
      # test needed because post_get_hook is called even if get() fails!
      obj.saved = True

  def _post_put_hook(self, future):
    self.saved = True 
```

没有必要检查未来的状态——当任何一个钩子被调用时，未来总是有结果的。这是因为钩子实际上是对未来的回调。但是，需要检查其结果是否为无！

PS：在事务中，一旦 put() 调用返回，挂钩就会被调用；交易的成功或失败不会影响他们。有关在成功提交后运行挂钩的方法，请参阅[https://developers.google.com/appengine/docs/python/ndb/contextclass#Context_call_on_commit 。](https://developers.google.com/appengine/docs/python/ndb/contextclass#Context_call_on_commit)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T07:26:05.957

基于@Tim Hoffmans 的想法，您可以像这样发布挂钩：

```
class Article(ndb.Model):
    title = ndb.StringProperty()

    is_saved = False

    def _post_put_hook(self, f):
        if f.state == f.FINISHING:
            self.is_saved = True
        else:
            self.is_saved = False

article = Article()
print article.is_saved ## False
article.put()
print article.is_saved ## True 
```

我不能保证它会保留在数据存储中。在谷歌上没有找到任何关于它的东西:)

另一方面，查看 ndb.Model 实例是否具有密钥可能无法正常工作，因为新实例似乎在将密钥发送到数据存储之前就已获得密钥。您可以查看[源代码](http://code.google.com/p/googleappengine/source/browse/trunk/python/google/appengine/ext/ndb/model.py#2570)以了解在创建 ndb.Model 类的实例时会发生什么。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-06-11T11:05:34.443

如果您在创建模型实例时未提及键，则可以使用以下实现`is_saved()`来了解对象是否已写入数据存储区或至少一次。（如果您要从 google.appengine.ext.db 迁移到 google.appengine.ext.ndb，应该是合适的）

使用@fredrik给出的例子，

```
class Article(ndb.Model):
    title = ndb.StringProperty()

    def is_saved(self):
        if self.key:
            return True
        return False 
```

PS - 我不知道这是否适用于 google.cloud.ndb

# php - 基本 PHP 变量本地/全局问题

> ID：12083260
> 
> 赞同：0
> 
> 时间：2012-08-23T00:36:38.000
> 
> 标签：php, variables

我来自 C++ 背景，对 PHP 的世界还比较陌生。我目前正在写一个有index.php 和defines.php 的小片段。

在定义中我有变量

```
$passfile = "../ass1_data/passwords.txt"; 
```

我想在我的索引中的函数内使用 $passfile。我可以只使用它 $passfile 还是我也必须使用 global ？这就是我所拥有的

```
function checkPasswd($login,$passwd){    
global $passfile;
$p = $passfile;
foreach ($p as $line) {
// some code  
}
} 
```

目前我收到错误“foreach() 提供的参数无效”任何帮助或解释将不胜感激，谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T00:40:08.043

假设文本文件中包含带有密码的行，您需要先读取文件的内容，然后遍历结果：

```
$passfile= file('../ass1_data/passwords.txt');

function checkPasswd($login,$passwd){    
  global $passfile;
  foreach ($passfile as $line) {
    // some code  
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T00:42:34.443

1-您必须使用`global`关键字才能在函数内使用全局变量。
2- 对于第二种情况（`foreach`），首先您必须读取文件，然后使用`explode`函数将其拆分并在 foreach 中使用。：

```
$passfile = "../ass1_data/passwords.txt";  
function checkPasswd($login,$passwd){    
global $passfile;
$p = explode("\n",file_get_contents($passfile));

foreach ($p as $line) {
// some code  
}
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T00:38:07.497

您不能简单地`foreach`覆盖一个字符串（即使您可以使用下标表示法访问它的字节）。

你需要先把它变成一个数组，这样做的一个选择是[`explode("\n")`](http://php.net/manual/en/function.explode.php).

但是，听起来您想在该位置打开文件。在这种情况下，您可以使用[`file()`](http://php.net/manual/en/function.file.php)，它将自动为您提供该文件中的行数组。

# html - 去除不必要的空格——“不必要”是关键

> ID：12083262
> 
> 赞同：2
> 
> 时间：2012-08-23T00:37:05.317
> 
> 标签：html, whitespace, bandwidth

为了减少带宽，我试图去除不必要的空白。通过“不必要的”，我指的是任何垂直空格，以及行首或行尾的水平空格，但如果它在`<textarea>`标签中则不是。

虽然我对[The Pony He Comes](https://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags/1732454#1732454)并不陌生，但我相当肯定一个完整的 HTML 解析器对于这项任务来说太过分了。据我了解，正则表达式可以工作。

我现在拥有的正则表达式是：

```
$out = preg_replace("/[ \t]*\r?\n[ \t]*/","",$in); 
```

这似乎去掉了我上面指定的空白，除了`<textarea>`规则。我的问题归结为：如何确保不会在指定范围内发生替换？可以安全地假设所有 HTML 实体都在`<textarea>`s 中正确转义。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T00:43:38.363

如果你有 html：

```
<P>a
b</P> 
```

然后你去掉你最终会得到的垂直空白`ab`而不是`a b`. 因此，您需要将其转换为空格（这是毫无意义的）。

仅在标签附近剥离也无济于事，因为您可以（例如）两个`SPAN`标签彼此靠近。

您可以去除行首或行尾的空格 - 但只是因为您已经有垂直空格。

因此，如果您真的想这样做，您可以将多次出现的空白折叠到一个空格中。

如果您避免使用 javascript、输入字段、pre 和 textareas，您应该没问题。但是如果没有完整的解析器，就不可能真正避免这些！例如，有人可以`<TEXTAREA>`在评论中添加一个，如果没有解析器，您将继续寻找 textarea 的结尾而永远找不到它。

但更糟糕的是 的`value`属性`input`。您不想弄乱它-但是如果没有解析器，甚至完全不可能找到它：

```
<INPUT name="value='hello'" value='name="hi"'> 
```

颜色编码清楚地表明了属性是什么，但请尝试在没有解析器的情况下查找它们。

避免标签的内部也无济于事，因为您可以合法地放入`>`评论中。

# css - 文字精灵样式

> ID：12083263
> 
> 赞同：0
> 
> 时间：2012-08-23T00:37:10.687
> 
> 标签：css, extjs, extjs4, extjs4.1

是否有某种方法可以定义具有更多样式选项的文本[精灵](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.draw.Sprite)，然后只是大小和字体，如示例中所示？

```
{
    type: "text",
    text: "Hello, Sprite!",
    fill: "green",
    font: "18px monospace"
} 
```

具体来说，我想让它加粗或加下划线。

我尝试了`style`这样的配置：

```
style: {
    'text-decoration': 'underline'
} 
```

我也尝试在字体配置中设置它，如下所示：

```
font: "underline 18px monospace" 
```

都没有奏效。

[文档](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.draw.Sprite-cfg-font)`Ext.draw.Sprite#font`中配置中的这句话听起来很有希望，但它非常神秘：

> 使用与 CSS 字体参数相同的语法

我一直在搜索**CSS**字体参数，但没有发现太多用处。也许如果有人知道这意味着什么，他们可以对此有所了解。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T00:53:12.733

`font`css 属性将允许您指定粗体和斜体，但使用该属性设置下划线`text-decoration`。您需要使用样式配置：

```
{
    type: "text",
    text: "Hello, Sprite!",
    fill: "green",
    font: "bold 18px monospace",
    style: {
        textDecoration: "underline"
    }
} 
```

**工作演示：http:** [//jsfiddle.net/gilly3/WSQv9/](http://jsfiddle.net/gilly3/WSQv9/)。在 Chrome 和 IE9 中测试。 [Firefox 尚不支持 SVG 中的下划线](https://stackoverflow.com/questions/10906380/firefox-svg-text-decoration)。

作为参考，这里是字体参数定义：
[MSDN](http://msdn.microsoft.com/en-us/library/ie/ms530756(v=vs.85).aspx)
[MDN](https://developer.mozilla.org/en-US/docs/CSS/font)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T01:01:17.397

我从未使用过 extjs，但对我来说它看起来像 SVG。不幸的是，Firefox 不支持`text-decoration`svg 元素的属性，因此您可能正在 Firefox 中进行测试，但在 Chrome 中，您的`style`属性可能会正常显示。

`line`解决方法是使用元素手动绘制下划线。使用 javascript 并不困难，但我不知道如何以 extjs 方式完成此操作。

# javascript - 内容定位在背景图像上

> ID：12083264
> 
> 赞同：0
> 
> 时间：2012-08-23T00:37:15.067
> 
> 标签：javascript, html, css, background, positioning

我正在尝试根据背景图像的某些元素定位内容。我做了很多研究，似乎可以通过 JavaScript 实现，但我对 JavaScript 的功能不是很熟悉。

这是我正在使用的背景图片：http: [//dl.dropbox.com/u/4650892/bg2.jpg](http://dl.dropbox.com/u/4650892/bg2.jpg)

我试图确保信息保持在该图像上的 4 个框中。目前，我使用以下 CSS 来确保背景图像在浏览器中保持完美大小：

```
background-image: url('../images/bg2.jpg'); <br />
background-repeat:no-repeat; <br />
background-position:center center; <br />
background-attachment:fixed; <br />
-o-background-size: 100% 100%, auto; <br />
-moz-background-size: 100% 100%, auto; <br />
-webkit-background-size: 100% 100%, auto; <br />
background-size: 100% 100%, auto; 
```

这段代码对于我想要实现的目标可能不是必不可少的，我不完全确定。

当内容保持在一种分辨率时，定位内容很容易，但是一旦浏览器调整大小，内容就会与图像不连贯地移动。

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T00:47:37.527

您不能将 Buffalo 图像和该图像中的其他元素分开吗？还是所有这些都必须是背景图像的一部分？

If it was me I would make only the buffalo picture be a background image. I would create the other elements in HTML. You can change their size if you have to based on media queries.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T00:46:19.533

我建议将整个 UI 放在一张完整的图像中，然后在其上应用您的文本可能会让您感到最悲伤。

我建议您将动物作为背景图像的唯一元素，然后您可以在其顶部添加其他 HTML 元素（例如徽标），然后可以在其他所有内容下方再次添加四个框。

这样，您可以确保使用 CSS 将主图形（即徽标和“即将推出”文本）定位在中心，您可以使用 CSS 将框的大小专门设置为固定比例，并且这些将根据浏览器分辨率更有效地缩放。

# jquery - 以 LI 为限展开 UL LI

> ID：12083265
> 
> 赞同：1
> 
> 时间：2012-08-23T00:37:16.127
> 
> 标签：jquery, html

我有以下 HTML 输出；

```
<div id="list">
<ul>
 <li>Test 1</li>
 <li>Test 2.</li>
 <li>Test 3</li>
 <li>Test 4</li>
 <li>Test 5</li>
 <li>Test 6</li>
 <li>Test 7</li>
 <li>Test 8</li>
 <li>Test 9</li>
 <li>Test 10</li>
 <li>Test 11</li>
 </ul>
</div> 
```

我需要做的是显示相同的 HTML，但有一个按钮可以在 3 上扩展 3 或在 4 上扩展 4

我使用这个脚本来显示和隐藏

```
$('#list ul li:gt(3)').hide();
$('.show_button').click(function() {
    $('#list ul li:gt(3)').slideToggle();
    return false;
}); 
```

所以，假设我有 10 个 LI，在页面加载时只显示 3，如果我单击按钮展开为 6，再单击一次展开为 9....

谢谢你的帮助

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T00:40:47.053

```
$('#list ul li:gt(2)').hide();
$('.show_button').click(function() {
    $('#list ul li:hidden:lt(3)').slideToggle();

    if( ! $('#list ul li').is(':hidden') )
        $(this).hide();

    return false;
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T00:47:59.210

要一次增加三个，您需要创建某种计数器。我创建了一个名为 count 的变量，因为它是一个从 0 开始的索引，所以我们从 2（第三项）开始计数。每次单击时，计数器都会增加三并显示新结果。这是结果的 jsFiddle：http: [//jsfiddle.net/qPBxs/](http://jsfiddle.net/qPBxs/)

```
count = 2;
$('#list ul li:gt('+count+')').hide();
$('.show_button').live('click',function() {
    $('#list ul li:gt('+count+')').slideDown();
    $('#list ul li:gt('+(count + 3)+')').hide();
    count = count + 3;
    return false;
});​ 
```

# batch-file - 如何批量读取文本文件然后在控制台上显示文本

> ID：12083266
> 
> 赞同：1
> 
> 时间：2012-08-23T00:37:37.123
> 
> 标签：batch-file, cmd

我正在尝试制作一个批处理文件，该文件将读取文本文件的内容，然后将其全部显示到控制台上，这可能吗？它也有可能只搜索一个关键字然后它只会显示该行吗？

这是文本文件的示例

```
test, C:\users\documents\picture
test1, C:\program files\ 
```

等等等等

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T00:44:02.850

```
C:\>ECHO test, C:\users\documents\picture >foo
C:\>ECHO test1, C:\program files\ >>foo 
```

显示整个文本文件：

```
C:\>TYPE foo
test, C:\users\documents\picture
test1, C:\program files\ 
```

只显示包含“test1”的行：

```
C:\>FINDSTR "test1," foo
test1, C:\program files\ 
```

* * *

了解更多信息：

```
C:\>HELP TYPE
C:\>HELP FINDSTR 
```

一般来说：

```
C:\>HELP 
```

# c++ - C++ 中的 dyn_cast 与 dynamic_cast

> ID：12083268
> 
> 赞同：13
> 
> 时间：2012-08-23T00:37:59.807
> 
> 标签：c++, llvm, dynamic-cast

我在我正在处理的代码库中遇到了很多 dyn_cast。

它与 dynamic_cast 是一样的吗？或不同的东西？我搜索了一下，但找不到太多信息..

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-23T00:48:48.213

`dyn_cast`是 LLVM API 的一部分（也是第一个、第二个、第三个等。在 google 上点击）就像 dynamic_cast 一样工作，但是，一个区别是该类不需要像 dynamic_cast 这样的 v-table。请参阅[手册](http://llvm.org/docs/ProgrammersManual.html#isa)了解更多信息。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-05-07T13:15:28.277

实际上，它`llvm::dyn_cast_or_null`相当于`dynamic_cast`.

如果传递一个空指针，这些将产生一个空指针，而`llvm::dyn_cast`将保释。

# javascript - 在日期列表中查找最早的日期

> ID：12083270
> 
> 赞同：0
> 
> 时间：2012-08-23T00:38:06.953
> 
> 标签：javascript, date

我需要帮助来提出 JavaScript 中的函数。该函数应该能够从这种格式的日期列表中找到最早的日期`yyyy-mm-dd hh:mm:ss`。因此，该函数将接收一个文本，并在这些行中找到最旧的日期条目并选择与该日期关联的文本。

此外，如果有可以解决这个问题的 Java 解决方案，我将使用一些东西将 Java 包含在 JavaScript 中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T00:42:13.473

这是您将如何做到的...

1.  将日期作为数组进行迭代，将它们转换为 Unix 纪元。
2.  找到最古老的`Math.min.apply(Math, arrayOfDates)`或更好的`Math.min(...arrayOfDates)`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-23T00:45:10.587

这可行，假设`datelist`是字符串并且每个日期都在自己的行上：

```
var oldest = (function() {var o = ":", c, a=datelist.split(/\r?\n/); while(c=a.shift()) o = o < c ? o : c; return o;})(); 
```

打破它，它是这样工作的：它基本上是创建一个函数，运行它，然后获取它的返回值。函数是这样的：

```
var o = ":",
  // ":" comes after "9" in the character map, so it will be greater than any date
    c, a = datelist.split(/\r?\n/);
  // split on newlines, accomodating both \r and `\r\n` options.
while(c = a.shift()) {
  // basically loop through each date
    o = o < c ? o : c;
  // if the current oldest date is older than the one we're looking at, keep the old one
  // otherwise the new date is older so should be kept
}
return o;
  // return the result 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T00:45:49.817

您可以将所有日期字符串转换为[`Date`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date)对象，然后按[数字](https://stackoverflow.com/q/7000851/1048572)对列表进行排序并获取第一项。或者[`Math.min`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Math/min)，如果您不需要排序列表，您可以只应用它以获得最低值。

```
var minDate = Math.min.apply(null, datestrings.map(Date)); 
```

或者，由于您的格式确实有前导零，因此简单的[字符串排序](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/sort)也会这样做。要仅搜索最小字符串，您可以使用以下命令：

```
var min = datestrings.reduce(function(min, cur) {
    return cur < min ? cur : min;
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T01:16:08.807

使用 jquery 的 Wibbly-wobbly $$$y-wollarsy 示例：

```
 $("body").append($("<div>").attr("id", "q")); //some gratuitous jquery
  var timelist = "2012-03-03 10:14:21 \r\n 2012-05-15 21:21:12\r\n 2012-07-01 10:19:19\r\n2012-02-11 21:21:12";
  var datelist = timelist.split("\r\n");
  var oldest = ":";
  $.each(datelist, function (a) {
    var trimmedThis = $.trim(this);
    if (trimmedThis < latest) oldest = trimmedThis;
  });
  $("#q").text(oldest); //just to beef up the $ count 
```

# javascript - 如何在我的情况下创建加载脚本

> ID：12083284
> 
> 赞同：0
> 
> 时间：2012-08-23T00:41:32.147
> 
> 标签：javascript, jquery

我正在尝试为我的网站创建加载脚本。当用户点击按钮时，它会调用一堆函数，加载需要时间。我不希望用户在不加载 gif 的情况下等待。有没有办法解决这个问题？非常感谢。

加载似乎不起作用...

```
$('.test').click(function(){
  fun1();
  fun2();
  fun3();
  ....more
}) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T00:55:20.877

你不能先显示加载 gif 并在一切完成后隐藏它吗？

```
$('.test').click(function(){
  $("#LoadingGifId").show();
  fun1();
  fun2();
  fun3();
  ....more
  $("#LoadingGifId").hide();
}); 
```

如果任何函数正在执行 AJAX 请求，您将希望从您希望最后完成的请求的成功回调函数中隐藏 gif。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T00:56:39.303

一个简单的解决方案可能是在函数开始之前显示加载 gif，然后在它们完成时将其隐藏。

```
$('.test').click(function(){

    $('.loadingGif').show();
    fun1();
    fun2();
    fun3();
    $('.loadingGif').hide();

}); 
```

如果您的函数都没有异步运行，这应该可以工作。如果是，您可能需要使用回调函数。

# ubuntu - 在 Ubuntu 中为 Eclipse IDE 聊天

> ID：12083285
> 
> 赞同：1
> 
> 时间：2012-08-23T00:41:34.893
> 
> 标签：ubuntu, eclipse-plugin, chat

我需要在 Eclipse IDE 中在使用 Eclipse 的开发人员之间使用 Chat 插件。有没有可用的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T15:58:12.113

Eclipse 通信框架有一个内置的 Jabber 客户端……[这里](http://www.eclipsezone.com/eclipse/forums/t98659.html)是关于如何设置它的基本说明。

# jquery - 使用 ajax 和 tab 从 div id 获取内容

> ID：12083289
> 
> 赞同：0
> 
> 时间：2012-08-23T00:41:44.027
> 
> 标签：jquery, html, get

我有一个带有 ajax 加载的 jQuery 选项卡。

```
<script type='text/javascript'>
$(document).ready(function() {
    $("#nav li a").click(function() {

        $("#ajax-content").empty().append("<div id='loading'><img src='{THEME}/images/loading.gif' alt='Loading' /></div>");
        $("#nav li a").removeClass('current');
        $(this).addClass('current');

        $.ajax({ url: this.href, success: function(html) {
            $("#ajax-content").empty().append(html);
            }
    });
    return false;
    });
});
</script> 
```

**HTML 代码：**

```
<ul id="nav">
  <li><a href="test1.html">Page 1</a></li>
  <li><a href="test2.html">Page 2</a></li>
</ul>
<div id="ajax-content">This is default text, which will be replaced</div> 
```

一切都很好，运行良好，但我需要别的东西。

我只需要在 test1.html 和 test2.html 中使用答案 ID 从 div 获取内容。我不想加载所有页面。

在这些页面中，我的答案有一个 div，我的 test1.html 页面：

```
<div>Questions</div>
Some Questions

<div id="answers">Some answers</div> 
```

我只需要显示并从**id="answers"**获取内容 我该怎么做？

以及如何在内容加载后添加淡入淡出效果？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T00:49:05.760

用这个替换你的`$.ajax()`电话：

```
var location = this.href +" #answers";
$("#ajax-content").load(location); 
```

请参阅有关加载页面片段的[jQuery ajax文档。`.load()`](http://api.jquery.com/load/#loading-page-fragments)

* * *

完整代码：

```
$(document).ready(function() {
    $("#nav li a").click(function() {

        $("#ajax-content").html("<div id='loading'><img src='{THEME}/images/loading.gif' alt='Loading' /></div>");

        $("#nav li a").removeClass('current');
        $(this).addClass('current');

        var location = this.href +" #answers";
        $("#ajax-content").load(location);

        return false;
    });
}); 
```

# c# - Linq to Entities where in Clause Many to Many

> ID：12083290
> 
> 赞同：0
> 
> 时间：2012-08-23T00:41:53.617
> 
> 标签：c#, linq, entity-framework, entity, entity-relationship

我正在尝试让 Where In 子句与 linq to 实体一起使用并遇到问题。我的问题是我有几个不同实体的列表，我想从这些列表中选择一组游戏实体，基本上为它们设置一个 SQL WHERE IN 子句。问题是实体列表正在与游戏实体的相关实体进行比较，这些实体具有多对多关系。我已经做了很多研究并尝试了很多解决方案来解决这个问题，但就是不能完全正确，我非常感谢 stackoverflow 社区的一些帮助。

提前致谢。

编辑：

我试过这样做而不是工会：

```
 var relatedGames = from game in ugdb.Games
                        where game.Developers.Any(d => relatedDevelopers.Any(r => r.DeveloperID == d.DeveloperID))
                        || game.Publishers.Any(d => relatedPublishers.Any(r => r.PublisherID == d.PublisherID))
                        || game.Genres.Any(d => relatedGenres.Any(r => r.GenreID == d.GenreID))
                        select game; 
```

与工会和这个我收到以下错误消息：

base {System.SystemException} = {“无法创建“UltimateGameDB.Domain.Entities.Developer”类型的常量值。在此上下文中仅支持原始类型（“例如 Int32、String 和 Guid”）。”}

有谁知道如何在没有

我当前的代码：

```
 public IQueryable<Video> GetSimilarVideos(Guid videoId)
  {
     IQueryable<Video> result = null;
     List<Video> similarVideoList = null;

     Video currentVideo = ugdb.Videos.Find(videoId);

     List<Genre> relatedGenres = new List<Genre>();
     List<Developer> relatedDevelopers = new List<Developer>();
     List<Publisher> relatedPublishers = new List<Publisher>();

     foreach (var game in currentVideo.Games)
     {
        relatedDevelopers.AddRange(game.Developers);
        relatedPublishers.AddRange(game.Publishers);
        relatedGenres.AddRange(game.Genres);
     }

     relatedDevelopers = relatedDevelopers.Distinct().ToList<Developer>();
     relatedPublishers = relatedPublishers.Distinct().ToList<Publisher>();
     relatedGenres = relatedGenres.Distinct().ToList<Genre>();

     //This is the piece I am having trouble with!
     var relatedGames = from game in ugdb.Games
                        where game.Developers.Union(relatedDevelopers).Count() > 0
                          || game.Genres.Union(relatedGenres).Count() > 0
                          || game.Publishers.Union(relatedPublishers).Count() > 0
                        select game;

     foreach (var game in relatedGames)
     {
        similarVideoList.AddRange(game.Videos.Where(v => v.VideoType.Equals(currentVideo.VideoType)));
     }

     result = similarVideoList.Distinct().AsQueryable<Video>();

     return result;
  } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T03:24:33.360

您不能传递本地实体 - 它们不会转换为 sql，在您的情况下是相关的开发人员。Linq to Entities 无法转换`relatedDevelopers.Contains`为 Sql `IN`。

您可以投射游戏列表并在内存中进行调用，这样就不必将其转换为 sql - 这更容易，但如果您的数据库很大，加载它可能会很糟糕，只需`ToList()`在最后添加的`ugdb.Games`

```
 var relatedGames = from game in ugdb.Games.ToList()
                    where game.Developers.Any(d => relatedDevelopers.Any(r => r.DeveloperID == d.DeveloperID))
                    || game.Publishers.Any(d => relatedPublishers.Any(r => r.PublisherID == d.PublisherID))
                    || game.Genres.Any(d => relatedGenres.Any(r => r.GenreID == d.GenreID))
                    select game; 
```

或者，您可以创建一个 Id 列表并传递它，因为这是 SQL 可以识别的原始类型：

```
 var relatedDevelopers = currentVideo.Games.SelectMany( g => g.Developers ).Select( g => g.DeveloperID ).ToArray();
     var relatedPublishers = currentVideo.Games.SelectMany( g => g.Developers ).Select( g => g.DeveloperID ).ToArray();
     var relatedGenres = currentVideo.Games.SelectMany( g => g.Developers ).Select( g => g.DeveloperID ).ToArray();

     //This is the piece I am having trouble with!
     var relatedGames = from game in ugdb.Games
                        where game.Developers.Any( d => relatedDevelopers.Contains(d.DeveloperID) )
                        || game.Publishers.Any( d => relatedPublishers.Contains(d.PublisherID))
                        || game.Genres.Any( d => relatedGenres.Contains(d.GenreID) )
                        select game; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T01:00:08.833

该模式通常是使用嵌套的`Any`，或`Any`带有`Contains`

```
var relatedDeveloperIds = relatedDevelopers.Select(r => r.Id).ToList();
game.Developers.Any(d => relatedDeveloperIds.Contains(d.Id)) 
```

# ruby-on-rails - 如何使用 Capybara 和 RSpec 检查会话哈希？

> ID：12083296
> 
> 赞同：1
> 
> 时间：2012-08-23T00:43:03.370
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rspec, capybara, bdd

在 Stack Overflow 上找到了有关此的各种帖子，但没有找到解决方案。

在集成测试中，如何使用 Capybara 和 RSpec 检查会话哈希？

`puts session.inspect`引发`undefined method for nil`错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T01:32:48.650

根据[您的评论](https://stackoverflow.com/questions/12083296/how-to-inspect-the-session-hash-with-capybara-and-rspec#comment16165302_12083296)，您需要调试，以便您可以使用：

```
save_and_open_page 
```

拍摄页面快照并查看它，或者您可以使用：

```
print page.html 
```

如果您想以字符串形式检索 DOM 的当前状态

来源：[水豚调试](https://github.com/jnicklas/capybara#debugging)

# c++ - 非模板类 T 的模板成员函数（在类型 T 上）

> ID：12083301
> 
> 赞同：0
> 
> 时间：2012-08-23T00:44:05.330
> 
> 标签：c++, templates

我想做类似的事情：

```
class A {
  public:
    void f();
  private:
    void g() { };
};

class B {
  public:
    void f();
  private:
    void g() { };
};

template<typename T>
void T::f() {
    g();
}

int main() {
    A a;
    B b;
    a.f();
    b.f();
} 
```

但是 T::f() 无法编译。

可能的解决方法可能是使 f() 成为非成员：

```
template<typename T>
void f(T* t); 
```

或使用 CRTP：[http ://en.wikipedia.org/wiki/Curiously_recurring_template_pattern](http://en.wikipedia.org/wiki/Curiously_recurring_template_pattern)

但是没有 C++ 语法可以像上面那样做吗？

编辑：我有一个大函数 f()，其代码由 2 个类 A 和 B 共享。A 和 B 具有相同的接口，f() 使用。但是，因为我们没有使用运行时多态性（即虚函数），所以 f() 的语料库需要在编译时实例化两次，一次用于 A，一次用于 B。模板正是为此目的而制作的。就我而言，函数 f() 应该是模板函数，其模板类型是 *this 的类型。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T02:20:27.170

自由函数是正确答案。无论如何，你应该更喜欢自由函数而不是成员函数，因为这个确切的原因：你扩展接口而不侵入类。

在这种情况下，带有无约束模板的自由函数有点难看，因为您只需要它为两种情况工作，而不是所有情况。你应该这样做：

```
namespace detail
{
    template <typename T>
    void f(T* t)
    {
        // implement stuff
    }
}

void f(A* x)
{
    detail::f(x);
}

void f(B* x)
{
    detail::f(x);
} 
```

现在您可以通过重载来限制对该函数的访问。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T02:49:33.703

这是一个使用自由函数并保留`instance.f()`语法的示例。该函数需要标记为好友才能访问私有方法：

```
#include <iostream>

namespace details
{
    template<class T>
    static void f_impl(T* _this)
    {
        _this->g();
    }
}

class A {
public:
    template<class T> friend void details::f_impl(T*);
    void f()
    {
        details::f_impl(this);
    }
private:
    void g()
    {
        std::cout << "A" << std::endl;
    }
};

class B {
public:
    template<class T> friend void details::f_impl(T*);
    void f()
    {
        details::f_impl(this);
    }
private:
    void g()
    {
        std::cout << "B" << std::endl;
    }
};

int main() {
    A a;
    B b;
    a.f();
    b.f();
} 
```

# python - 如何在 jython 中使用 gtk/pywebkitgtk？

> ID：12083302
> 
> 赞同：1
> 
> 时间：2012-08-23T00:44:11.447
> 
> 标签：python, gtk, jython

在我的 ubuntu 12.04 上安装的独立 jython 中，运行它，但如果我尝试`import gtk`，我会`no module named gtk`在 python 控制台中运行它。

**更新：**

我已经做好了

`>> sys.path.insert(1,"/usr/lib/python2.7/dist-packages/gtk-2.0")`

和

`>> sys.path.insert(1,'/usr/lib/python2.7/dist-packages")`

现在是

```
 from glib._glib import *
ImportError: No module named _glib 
```

什么时候：

```
argon@vprime:/usr/lib/python2.7$ find | grep _glib
./dist-packages/gi/_glib
./dist-packages/gi/_glib/option.pyc
./dist-packages/gi/_glib/option.py
./dist-packages/gi/_glib/_glib.so
./dist-packages/gi/_glib/__init__.pyc
./dist-packages/gi/_glib/__init__.py
./dist-packages/glib/_glib.so
./dist-packages/twisted/internet/test/test_glibbase.pyc
./dist-packages/twisted/internet/test/test_glibbase.py
./dist-packages/twisted/internet/_glibbase.py
./dist-packages/twisted/internet/_glibbase.pyc
./dist-packages/_dbus_glib_bindings.so 
```

所以，`glib/_glib`在下面`dist-packages`，我不知道出了什么问题......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T02:15:23.053

并非所有模块都在 Jython 和 CPython（标准 Python 解释器）之间兼容。特别是，编译为原生字节码的模块，通常用 C/++（或 Cython）编写，不能用 Java 加载，因为它使用自己的虚拟机（JVM），无法理解原生字节码。

CPython 中的许多本机/二进制模块的名称都带有下划线前缀，例如上面的 _glib。

你至少有两个选择：

*   使用 Jython 和 Java GTK 包。
*   使用 CPython，如果您需要与 Java 对话，请使用 CPython 和 JVM 之间的接口包之一（例如[jpype](http://jpype.sourceforge.net)、[py4j](http://py4j.sourceforge.net/)）。

# javascript - jQuery UI 颜色选择器问题

> ID：12083303
> 
> 赞同：0
> 
> 时间：2012-08-23T00:44:26.273
> 
> 标签：javascript, jquery, html, css, jquery-ui

我想创建一个颜色选择器，但它需要像这样 [http://jqueryui.com/demos/slider/](http://jqueryui.com/demos/slider/)是水平 的，它需要是一个可以滚动所有颜色的水平滑块。我试图将它基于 jquery ui 滑块。

有谁知道网上有这方面的例子吗？或者可以告诉我如何做到这一点？

我在考虑根据滑块设置的距离说 50% 我需要将该值转换为颜色值。

0% 距离是白色，100% 是黑色。

注意：它需要是 1 个可以在`all`颜色范围内变化的滑块，并且颜色必须是平滑过渡而不是全部随机的。

就像这张图片： ![在此处输入图像描述](../Images/3c9cdd82767df61b0ad4ed3a1b6ee140.png) 但它需要在其中加入白色和黑色。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T01:28:26.337

您可以将 HTML 颜色表示为十六进制值。考虑到这一点，我们可以创建一个从`#000000`to `#FFFFFF`（或十进制的 0 到 16777215）的滑块：

```
$("#slider").slider({
    min: 0,
    max: 16777215,
    slide: function (event, ui) {
        var hex = "#" + ui.value.toString(16);
        $("#color").css("background-color", hex);
    }
}); 
```

请注意，要使其远程可用，您必须有一个相当长的滑块。为了更好地了解它的工作原理，请使用键盘箭头而不是鼠标来滑动颜色。

**示例：http:** [//jsfiddle.net/4extL/46/](http://jsfiddle.net/4extL/46/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T02:06:04.997

I don't think this is possible. I would recommend using one of the many jQuery colorpicker plugins. Or you could look at this jQuery UI example - not exactly what you wanted but it does use the jQueryUI slider: [http://jqueryui.com/demos/slider/#colorpicker](http://jqueryui.com/demos/slider/#colorpicker)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T01:09:56.387

[这里](http://wiki.jqueryui.com/w/page/12137750/ColorPicker)有很多颜色选择器的 jQuery UI 示例。他们甚至有示例，您可以在其中滚动浏览所有颜色。希望这可以帮助。

# jquery - 换班不起作用

> ID：12083305
> 
> 赞同：0
> 
> 时间：2012-08-23T00:44:33.053
> 
> 标签：jquery

Total Jquery noob，按照我的方式工作。它托管在这里：[mySite](http://bungle.ca/jquery/)

感兴趣的是页脚。想按下站点地图并让页脚很好地展开以显示它正在做的漂亮站点地图。想将站点地图按钮更改为另一个按钮以将其关闭。

使用 replaceWith() 它可以很好地更改按钮，但我不能使用新的 HTML 来做任何事情，它完全没有响应。已经为此苦苦挣扎了一个半小时，尝试了 toggleClass() 等。无法让它工作。不关心我在关闭方法中可能搞砸的任何其他内容，更愿意自己学习。

干杯。

```
<script>
 $(document).ready(function(){
  $(".siteMap").click(function(){
   $("#footer").animate({
      height:  '150px'
      }, 1000);
    $("#table").fadeIn('20000');
    $(".siteMap").replaceWith('<span class="close"><a>CLOSE</a></span>')
   }); // end .click

  $(".close").click(function(){
    $("#footer").css('height', '25px');
    $("#table").fadeOut('20000');
    $(".close").replaceWith('<span class="siteMap"><a>SITE MAP</a></span>');
   }); // end .click
  }); // end .ready
</script>

<div id="footer">
 <div id="table">
  <table width="100%">
   <tr>
    <td><a href="#">Link One</a></td>
    <td><a href="#">Link One</a></td>
    <td><a href="#">Link One</a></td>
    <td><a href="#">Link One</a></td>
    <td><a href="#">Link One</a></td>
   </tr>
   <tr>
    <td><a href="#">Link One</a></td>
    <td><a href="#">Link One</a></td>
    <td><a href="#">Link One</a></td>
    <td><a href="#">Link One</a></td>
    <td><a href="#">Link One</a></td>
   </tr>
   <tr>
    <td><a href="#">Link One</a></td>
    <td><a href="#">Link One</a></td>
    <td><a href="#">Link One</a></td>
    <td><a href="#">Link One</a></td>
    <td><a href="#">Link One</a></td>
   </tr>                    
   <tr>
    <td><a href="#">Link One</a></td>
    <td><a href="#">Link One</a></td>
    <td><a href="#">Link One</a></td>
    <td><a href="#">Link One</a></td>
    <td><a href="#">Link One</a></td>
   </tr>    
   <tr>
    <td><a href="#">Link One</a></td>
    <td><a href="#">Link One</a></td>
    <td><a href="#">Link One</a></td>
    <td><a href="#">Link One</a></td>
    <td><a href="#">Link One</a></td>
   </tr>
  </table>
 </div>
 <span id="home"><a href="#">HOME</a></span>
 <span id="top"><a href="#banner">TOP</a></span>
 <span class="siteMap"><a>SITE MAP</a></span>
</div>

#table{
    display:    none;
    z-index:    999;
    }

#table  table{
    border: 0;
    }

#table  td{
    border: 0;
    }

#footer{
    padding:    5px;
    height: 25px;
    border: 1px solid   #ff0000;
    border-radius:  20px;
    margin: auto;
    text-align: center;
    background: url('../images/backgroundNavy.jpg') top left;
    background-repeat:  repeat-x;
    }

#footer a{
    text-decoration:    none;
    color:  white;
    font-size:  15px;
    font-family:    proxima;
    font-weight:    bold;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T01:11:45.917

它变得无响应的原因是因为您没有将点击事件重新绑定到元素。

调用 replaceWith 后，您必须将单击重新绑定到该元素。

但是，我建议显示/隐藏您的站点地图/关闭按钮，而不是创建新按钮。使用这种方法，您无需重新绑定单击。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T01:10:40.020

在您绑定事件时，您将单击事件附加到的元素不存在。您需要将这些事件委托给确实存在的元素，例如：

```
$(document).ready(function() {
    $("#footer").on('click', ".siteMap", function() {
        $("#footer").animate({
            height: '150px'
        }, 1000);
        $("#table").fadeIn('20000');
        $(".siteMap").replaceWith('<span class="close"><a>CLOSE</a></span>')
    }); // end .click
    $("#footer").on('click', ".close", function() {
        $("#footer").css('height', '25px');
        $("#table").fadeOut('20000');
        $(".close").replaceWith('<span class="siteMap"><a>SITE MAP</a></span>');
    }); // end .click
}); // end .ready​​ 
```

[**小提琴**](http://jsfiddle.net/XwN2L/444/)

`on()`仅适用于 jQuery 1.7+，对于旧版本，有`delegate()`或`live()`.

最好的办法是隐藏/显示元素，而不是像这样不断替换它们：[**FIDDLE**](http://jsfiddle.net/XwN2L/447/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T01:11:16.107

问题是您在页面加载时将单击事件处理程序附加到元素。但是，当页面第一次加载您`<span>`的类时，“close”还不是 DOM 的一部分，因为您稍后会动态添加它。当您稍后添加它时，它没有附加事件处理程序。

解决此问题的一种方法是使用 JQuery`.on()`方法，该方法会将事件处理程序附加到与您的选择器匹配的所有现有元素，以及添加的任何未来元素。 [这是 JQuery 文档。](http://api.jquery.com/on/)

您的 JavaScript 看起来像这样（注意，在将事件处理程序添加到“siteMap”元素时，您需要进行相同的更改，否则您将无法在折叠后再次显示站点地图。）

```
 $(document).ready(function(){
  $("#footer").on("click", ".siteMap", function(){
   $("#footer").animate({
      height:  '150px'
      }, 1000);
    $("#table").fadeIn('20000');
    $(".siteMap").replaceWith('<span class="close"><a>CLOSE</a></span>')
   }); // end .click

  $("#footer").on("click", ".close", function(){
    $("#footer").css('height', '25px');
    $("#table").fadeOut('20000');
    $(".close").replaceWith('<span class="siteMap"><a>SITE MAP</a></span>');
   }); // end .click
  }); // end .ready​​​​ 
```

但是我同意@Ariel 的评论，即在这种情况下更改 HTML 通常不是最好的方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T01:11:42.447

问题是在您创建带有 class 的元素之前，您的 javascript 已被解析`.close`。为了解决这个问题，jquery 有一个内置的[on() 函数](http://api.jquery.com/on/)。

```
$('.close').on('click',function(){
    //your function here
}); 
```

# regex - 在正则表达式中，匹配字符串的结尾或特定字符

> ID：12083308
> 
> 赞同：65
> 
> 时间：2012-08-23T00:44:48.467
> 
> 标签：regex, pattern-matching

我有一个字符串。结尾不同，例如`index.php?test=1&list=UL`or `index.php?list=UL&more=1`。我正在寻找的一件事是`&list=`。

我如何匹配它，无论是在字符串的中间还是在末尾？到目前为止，我得到了`[&|\?]list=.*?([&|$])`，但该`([&|$])`部分实际上不起作用；我正在尝试使用它来匹配字符串的任何一个`&`或结尾，但字符串部分的结尾不起作用，因此此模式与第二个示例匹配，但与第一个不匹配。

* * *

## 回答 #1

> 赞同：88
> 
> 时间：2012-08-23T00:49:30.643

利用：

```
/(&|\?)list=.*?(&|$)/ 
```

请注意，当您使用方括号表达式时，其中的每个字符（有[一些](http://en.wikipedia.org/wiki/Regular_expression#POSIX_Basic_Regular_Expressions)例外）都将按字面意思解释。换句话说，`[&|$]`匹配**字符** `&`、`|`和`$`。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2018-07-02T11:08:47.140

**简而言之**

内部的任何零宽度断言`[...]`都失去了零宽度断言的含义。`[\b]`不匹配单词边界（它匹配一个退格，或者，在 POSIX 中，`\`或者`b`），`[$]`匹配一个文字`$`字符，`[^]`或者是一个错误，或者，在 ECMAScript 正则表达式风格中，任何字符。与`\z`, `\Z`,`\A`锚点相同。

您可以使用以下任何模式解决问题：

```
[&?]list=([^&]*)
[&?]list=(.*?)(?=&|$)
[&?]list=(.*?)(?![^&]) 
```

如果您需要检查“绝对”、明确的字符串结束锚点，您需要记住这是各种正则表达式风格，它用不同的结构表示：

```
[&?]list=(.*?)(?=&|$)  - OK for ECMA regex (JavaScript, default C++ `std::regex`)
[&?]list=(.*?)(?=&|\z) - OK for .NET, Go, Onigmo (Ruby), Perl, PCRE (PHP, base R), Boost, ICU (R `stringr`), Java/Andorid
[&?]list=(.*?)(?=&|\Z) - OK for Python 
```

**字符序列与单个字符或字符串结尾之间的匹配（当前场景）**

该`.*?([YOUR_SINGLE_CHAR_DELIMITER(S)]|$)`模式（[由 João Silva 建议](https://stackoverflow.com/a/12083343/3832970)）效率相当低，因为正则表达式引擎首先检查出现在惰性点模式右侧的模式，并且只有当它们不匹配时，它才会“扩展”惰性点模式。

在这些情况下，建议使用[*否定字符类*](https://www.regular-expressions.info/charclass.html#negated)（或POSIX 谈话中的*括号表达式）：*

```
[&?]list=([^&]*) 
```

[见演示](https://regex101.com/r/ZQb63I/1)。**细节**

*   `[&?]``&`- 匹配或匹配的正字符类`?`（注意字符类中字符/字符范围之间的关系是 OR 关系）
*   `list=`- 一个子字符串，字符序列
*   `([^&]*)`- 捕获组 #1：除 ( ) 之外的零个或多个 ( )`*`字符，尽可能多`&``[^&]`

**检查尾随单个字符分隔符的存在而不返回它或字符串的结尾**

大多数正则表达式风格（包括从 ECMAScript 2018 开始的 JavaScript）支持环视，即仅在模式匹配或不匹配时才返回 true 或 false 的构造。在预期可能以相同字符开头和结尾的连续匹配时，它们至关重要（请参阅原始模式，它可能匹配以 开头和结尾的字符串`&`）。尽管在查询字符串中不应该出现这种情况，但这是一种常见的情况。

在这种情况下，您可以使用两种方法：

*   具有包含正字符类的交替的正前瞻：`(?=[SINGLE_CHAR_DELIMITER(S)]|$)`
*   只有负字符类的负前瞻：`(?![^SINGLE_CHAR_DELIMITER(S)])`

负前瞻解决方案效率更高一些，因为它不包含增加匹配过程复杂性的交替组。OP 解决方案看起来像

```
[&?]list=(.*?)(?=&|$) 
```

或者

```
[&?]list=(.*?)(?![^&]) 
```

在这里查看[这个正则表达式演示](https://regex101.com/r/ZQb63I/2)和[另一个](https://regex101.com/r/ZQb63I/3)。

当然，如果尾随定界符是多字符序列，则只有肯定的前瞻解决方案才会起作用，因为`[^yes]`它不会否​​定字符序列，而是会否定类中的字符（即`[^yes]`匹配除`y`,`e`和之外的任何字符`s`）。

# android - Nginx：在 Android 上通过 SSL 提供静态文件

> ID：12083317
> 
> 赞同：0
> 
> 时间：2012-08-23T00:45:51.553
> 
> 标签：android, static, nginx

我正在开发一个 Web 应用程序，它必须提供一些静态 pdf 文件。一切都在桌面和 iOS 上运行良好，但静态文件不会在 Android 上下载。它只是挂起下载。这是外观的屏幕截图：

[https://www.dropbox.com/s/r3qz9cia9vwwgam/2012-08-22%2020.38.37.png](https://www.dropbox.com/s/r3qz9cia9vwwgam/2012-08-22%2020.38.37.png)

安卓版本为 4.1.1

nginx版本是：

```
$ /usr/local/nginx/sbin/nginx -V
nginx version: nginx/1.2.3
built by gcc 4.6.3 (Ubuntu/Linaro 4.6.3-1ubuntu5) 
TLS SNI support enabled
configure arguments: --prefix=/usr/local/nginx-1.2.3 --user=nginx --group=nginx --with-http_ssl_module --with-http_realip_module 
```

这是 nginx 配置的主要部分：

```
server {
    server_name .foosite.com;
    listen 443;

    ssl on;
    ssl_certificate /etc/ssl/certs/foo.crt;
    ssl_certificate_key /etc/ssl/private/foo.key;

    access_log logs/foo.log;

    gzip                on;
    gzip_http_version   1.0;
    gzip_comp_level     2;
    gzip_proxied        any;
    gzip_min_length     1100;
    gzip_buffers        16 8k;
    gzip_types          text/plain text/html text/css application/x-javascript text/xml application/xml application/xml+rss text/javascript;

    # Some version of IE 6 don't handle compression well on some mime-types, so just disable for them
    gzip_disable "MSIE [1-6].(?!.*SV1)";

    # Set a vary header so downstream proxies don't send cached gzipped content to IE6
    gzip_vary on;

    location / {
        # some proxy_pass stuff here        
    }

    location /media {
        alias   /foo/path/to/media/;
        expires 1y;
    }
} 
```

这是我使用 curl 得到的响应标头：

```
$ curl -I https://foosite.com/media/path/to/foopdf.pdf
HTTP/1.1 200 OK
Server: nginx/1.2.3
Date: Thu, 23 Aug 2012 00:40:16 GMT
Content-Type: application/pdf
Content-Length: 136833
Last-Modified: Wed, 22 Aug 2012 21:14:50 GMT
Connection: keep-alive
Expires: Fri, 23 Aug 2013 00:40:16 GMT
Cache-Control: max-age=31536000
Accept-Ranges: bytes 
```

我还尝试通过提供用户代理标头来模仿我的 chrome android 浏览器：

```
$ curl -A "Mozilla/5.0 (Linux; Android 4.1.1; Nexus 7 Build/JRO03D) AppleWebKit/535.19 (KHTML, like Gecko) Chrome/18.0.1025.166  Safari/535.19" -I https://foosite.com/media/path/to/foopdf.pdf
HTTP/1.1 200 OK
Server: nginx/1.2.3
Date: Thu, 23 Aug 2012 00:33:09 GMT
Content-Type: application/pdf
Content-Length: 136833
Last-Modified: Wed, 22 Aug 2012 21:14:50 GMT
Connection: keep-alive
Expires: Fri, 23 Aug 2013 00:33:09 GMT
Cache-Control: max-age=31536000
Accept-Ranges: bytes 
```

关于为什么会发生这种情况的任何想法？同样，这个问题只影响我所有的安卓设备（Galaxy Nexus 和 Nexus 7）。在桌面和 iOS 设备上运行良好。如果我禁用 SSL 并通过端口 80 提供服务，那么一切正常。

谢谢你。

# python - 在 Jinja2 中添加自定义令牌（例如 %% somevar %%）

> ID：12083319
> 
> 赞同：5
> 
> 时间：2012-08-23T00:45:57.430
> 
> 标签：python, flask, syntax, jinja2, template-engine

我正在为最终将通过 ASP.NET 提供的 HTML 模板的本地开发（在 Mac 上）制作 Flask 应用程序。

`%% ... %%`出于本地开发的目的，我想要一种用一些数据替换 .NET 样式标记的内容的方法，这意味着除了标准标记之外，Jinja2 还需要能够识别标记： `{{ ... }}`、`<% ... %>`等。

我在网上找到的所有内容都与在**现有**标签中包含一些新功能有关（例如`{{ my_custom_function | arg1 arg2 }}`）

但是，如何为标签完全定义一个新模式呢？有没有人成功做到这一点？是否需要对 Jinja2 核心进行修改？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-23T00:55:02.557

据我所知，您可以将一组用于`block_start_string`and `block_end_string`，以及一组用于`variable_start_string`and `variable_end_string`。

来自 jinja2/environment.py

```
`block_start_string`
    The string marking the begin of a block.  Defaults to ``'{%'``.

`block_end_string`
    The string marking the end of a block.  Defaults to ``'%}'``.

`variable_start_string`
    The string marking the begin of a print statement.
    Defaults to ``'{{'``.

`variable_end_string`
    The string marking the end of a print statement.  Defaults to
    ``'}}'``. 
```

您可以使用环境变量覆盖这些。不过，我认为没有办法识别多种类型。例如，你不能同时拥有`{{`并且`<%`两者都工作，但如果你有一点hackery，你当然可以。

# ruby-on-rails - 表单模板在 Rails 中的工作原理

> ID：12083322
> 
> 赞同：0
> 
> 时间：2012-08-23T00:46:31.207
> 
> 标签：ruby-on-rails, ruby, forms, dry

如果我们在 Rails 中创建默认的脚手架，则两者的`edit.html.erb`内部`new.html.erb`渲染相同`_form.html.erb`。两者都创建具有某些相似之处和不同之处的形式。

如：

*   两者都创建`<form method="post" ...>`
*   提交按钮有不同的文本`<input value='Create model' ..`和`<input value='New model' ..`

我的问题：

1.  条件渲染是如何工作的？
2.  如何有条件地显示表单元素？例如， `<input>`仅当它被 via 调用时才`edit.html.erb`显示它，但如果被调用 via 则不显示它`new.html.erb`。
3.  如果 q.2 中的方法可能，它是正确的方法吗？我们正在重用代码而不是重新复制表单，不是吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T01:14:11.227

假设您遵循 RESTful 约定，您看到的 edit 和 new 之间的差异基于您传递给表单的对象的状态。`#new_record?`Rails 可以通过使用该方法来区分新对象和已持久化对象之间的区别。

```
Model.new.new_record? # => true
Model.first.new_record? # => false 
```

在您的`#new`控制器操作中，您可能有以下内容：

```
@model = Model.new 
```

在你的`#edit`行动中，你可能有这样的事情：

```
@model = Mode.find(params[:id]) 
```

然后将该`@model`对象传递给表单，该表单在内部处理条件逻辑。您应该注意到的表单的另一个区别是该`#edit`版本有一个隐藏的输入字段，告诉服务器使用`PUT`HTTP 方法。

**更新**

看起来 Rails 实际上使用了[持久化？内部方法](https://github.com/rails/rails/blob/beba8267c96a3dbc1f505ecc099dbf14db8dde4c/actionpack/lib/action_view/helpers/form_helper.rb#L1419)而不是 new_record?。区别就在于坚持？检查记录是否已被删除。否则，它们是相同的（但相反）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T00:53:14.387

你可以这样做：

在 new.html.erb 中： `<%= render :partial =>'form', :locals => {:action => 'new', :f => f } %>`

在 edit.html.erb 中： `<%= render :partial =>'form', :locals => {:action => 'edit', :f => f } %>`

在 _form.html.erb: `if action == 'new'` 或 `if action == 'edit'`

您也可以发送其他参数，`:locals`例如`:show_mobile => false`.

# objective-c - 如何在 64 位的 Objective-C 中获取 Quicktime-Movie 的开始时间码 (SMPTE)？

> ID：12083325
> 
> 赞同：3
> 
> 时间：2012-08-23T00:47:08.027
> 
> 标签：objective-c, cocoa, quicktime

我一直在为此拔头发。

我在这里找到了一些东西，但实际上似乎没有任何效果。而且文档真的很有限。

我在这里试图弄清楚的是如何从时间码轨道中获取 Objective-C 中 Quicktime 电影的开始时间码，并从中获得人类可读的输出。

我发现了这个： [来自 Quick Time 的 SMPTE TimeCode](https://stackoverflow.com/questions/7310299/smpte-timecode-from-quick-time)

它在 32 位模式下完美运行。但由于 Quicktime API，它不能在 64 位模式下工作。我需要将其合并到的软件已经并且必须继续运行 64 位。

我在这里失去理智。有人知道这些 API 吗？

最终，这里的目标是找出 Quicktime 的开始时间码，因为它需要在 FCP-X XML 文件中设置偏移量。没有它，视频文件会在没有音频的情况下被引入（或者，真的，它只是滑了很多）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T04:40:00.040

使用*AVFoundation*框架而不是*QuickTime*。播放器初始化在文档中有很好的解释：[https ://developer.apple.com/library/mac/#documentation/AudioVideo/Conceptual/AVFoundationPG/Articles/02_Playback.html#//apple_ref/doc/uid/TP40010188-CH3 -SW2](https://developer.apple.com/library/mac/#documentation/AudioVideo/Conceptual/AVFoundationPG/Articles/02_Playback.html#//apple_ref/doc/uid/TP40010188-CH3-SW2)

一旦您的*AVAsset*加载到内存中，您可以通过读取时间码轨道的内容（如果存在）来提取第一个样本帧号（ *timeStampFrame ）：*

```
long timeStampFrame = 0;
for (AVAssetTrack * track in [_asset tracks]) {
    if ([[track mediaType] isEqualToString:AVMediaTypeTimecode]) {
        AVAssetReader *assetReader = [AVAssetReader assetReaderWithAsset:_asset error:nil];
        AVAssetReaderTrackOutput *assetReaderOutput = [AVAssetReaderTrackOutput assetReaderTrackOutputWithTrack:track outputSettings:nil]; 
        if ([assetReader canAddOutput:assetReaderOutput]) {
            [assetReader addOutput:assetReaderOutput];
            if ([assetReader startReading] == YES) {
                int count = 0;

                while ( [assetReader status]==AVAssetReaderStatusReading ) {
                    CMSampleBufferRef sampleBuffer = [assetReaderOutput copyNextSampleBuffer];
                    if (sampleBuffer == NULL) {
                        if ([assetReader status] == AVAssetReaderStatusFailed) 
                            break;
                        else    
                            continue;
                    }
                    count++;

                    CMBlockBufferRef blockBuffer = CMSampleBufferGetDataBuffer(sampleBuffer);
                    size_t length = CMBlockBufferGetDataLength(blockBuffer);

                    if (length>0) {
                        unsigned char *buffer = malloc(length);
                        memset(buffer, 0, length);
                        CMBlockBufferCopyDataBytes(blockBuffer, 0, length, buffer);

                        for (int i=0; i<length; i++) {
                            timeStampFrame = (timeStampFrame << 8) + buffer[i];
                        }

                        free(buffer);
                    }

                    CFRelease(sampleBuffer);
                }

                if (count == 0) {
                    NSLog(@"No sample in the timecode track: %@", [assetReader error]);
                }

                NSLog(@"Processed %d sample", count);

            }

        }

        if ([assetReader status] != AVAssetReaderStatusCompleted)
            [assetReader cancelReading];
    }
} 
```

*这比QuickTime* API稍微复杂一些，上面的代码必须有一些改进，但它对我有用。

# ios - IOS 5.1 从文档目录到/从 iCloud 备份/恢复应用程序文件

> ID：12083327
> 
> 赞同：0
> 
> 时间：2012-08-23T00:47:15.953
> 
> 标签：ios, ipad, sdk, icloud

我已经为 iPad 创建了一个带有 XCode 4.3.3 的数据库 (IOS 5.1) 并进行了设置，以便用户可以将数据库文件 (*.sqlite) 备份和恢复到 DropBox。一切正常...

现在我想做同样的过程，但是，为 iCloud 设置它。寻找以下功能：

1.  点击一个按钮，根据用户偏好将 *.sqlite 文件从 Apps Document Directory 备份到 iCloud。
2.  点击按钮将 *.sqlite 文件从 iCloud 复制到 Apps Document Directory。

我一直在努力寻找解决方案，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-09T05:20:23.130

要将任何文件移入和移出 icloud，您可以使用下面的代码。

```
[[[NSFileManager alloc]init] setUbiquitous:YES itemAtURL:your iCloudURL destinationURL:localDirectoryURL error:&errorsss]; 
```

唯一的问题是，如果您要迁移到 icloud，则代码应该是：

```
[[[NSFileManager alloc]init] setUbiquitous:YES itemAtURL:localDirectoryURL destinationURL:your_iCloudURL error:&errorsss]; 
```

如果你是从 iCloud 获取到 Apps Documents 目录

```
[[[NSFileManager alloc]init] setUbiquitous:NO itemAtURL:your_iCloudURL destinationURL:localDirectoryURL error:&errorsss]; 
```

# powershell - 在多台计算机上获取修补程序并导出为 CSV

> ID：12083341
> 
> 赞同：1
> 
> 时间：2012-08-23T00:49:19.270
> 
> 标签：powershell, hotfix

如何在输出文件中正确使用 $_？这是我的代码：

```
get-content computers.txt | 
  Where {$_ -AND (Test-Connection $_ -Quiet)} |
    foreach { Get-Hotfix -computername $_ } | 
      Select CSName,Description,HotFixID,InstalledBy,InstalledOn |
        convertto-csv | out-file "C:\$_.csv" 
```

我正在尝试为文本文件中列出的所有计算机执行 get-hotfix，然后我希望它们以计算机名称作为文件名导出到 CSV。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T01:15:10.790

您需要一个管道来处理computers.txt 文件，并在其中嵌套一个管道来处理`foreach`每台计算机的修补程序列表：

```
get-content .\computers.txt |
  Where {$_ -AND (Test-Connection $_ -Quiet)} |
    foreach { 
      Get-Hotfix -computername $_ |
        Select CSName,Description,HotFixID,InstalledBy,InstalledOn |
          convertto-csv | out-file "C:\$_.csv" 
    } 
```

**编辑：**更改`computers.txt`为`.\computers.txt`，因为这是 powershell 中的本地路径所必需的

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-09-24T15:53:49.360

我可以看到：get-content .\computers.txt | 其中 {$_ -AND (Test-Connection $_ -Quiet)} | foreach{ Get-Hotfix -id KB4012212 -computername $_ | 选择 CSName、描述、HotFixID、InstalledBy、InstalledOn | 转换成csv | out-file "C:\$_.csv" } 我只能看到安装了修复程序 (KB4012212) 的 PC。可以看到以下内容

*   CSNAME 修复（Inst/NotInst）

    PC1 已安装

    PC2 Fix未安装

    PC3 未安装

.. .. ETC

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-08-20T17:53:16.250

在我使用这个组合之前，我一直在玩这个，但我发现在线上没有任何效果。 

我使用的方法是这个线程，但它太慢了，我想了解更多关于使用作业的信息，所以这最终在 Windows 7 PS Ver 4 上为我工作。所有其他选项要么太慢，要么没有从远程系统。

```
$VMs = get-content C:\WinVms.txt #Generate your hostnames list however you deem best.
foreach ($vm in $vms)
{
Write-Host "Attempting to get hotfixes on:" $vm
invoke-command -computername $vm -ScriptBlock {start-job -scriptblock {(get-hotfix | sort installedon)[-1]} | wait-job | receive-job} -AsJob
}
start-sleep 60 # give it a minute to complete
get-job | ? { $_.state -eq "Completed"} | receive-job -keep | export-csv c:\temp\win-patch.csv 
```

你也可以像这样检查你的失败： 

```
get-job | ? { $_.state -eq "Failed"} 
```

# mysql - 注释附加到特定对象的 django-taggit 标签

> ID：12083342
> 
> 赞同：1
> 
> 时间：2012-08-23T00:49:25.520
> 
> 标签：mysql, django, django-queryset, django-taggit

[我有一个使用django-taggit](https://github.com/alex/django-taggit)标记的对象。如果我想获取附加到该对象的所有标签的列表，我会像这样遵循文档：

```
apple = Food.objects.create(name="apple")
apple.tags.add("red", "green", "delicious")
apple.tags.all() 
```

如果我想知道每个标签上附加了多少 Food 对象，我会执行以下操作：

```
Tag.objects.all().annotate(food_count=Count('food')) 
```

如果我想计算*仅*附在“苹果”标签上的所有食品，我可以执行以下操作：

```
apple = Food.objects.create(name="apple")
apple.tags.add("red", "green", "delicious")
apple.tags.all().annotate(food_count=Count('food')) 
```

好的，所以对于我的问题。假设我的 Food 模型有一个带有标志的字段：

```
class Food(models.Model):
    name = models.CharField(max_length=200, unique = True)
    healthy_flag = models.BooleanField(default=False) 
```

如何计算*仅附加到“苹果”标签上的所有**健康*食品（健康食品由healthy_flag = 1表示）？基本上，对于每个“苹果”标签，有多少健康食品共享该标签？

 ** * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T14:39:31.237

[在这里](https://docs.djangoproject.com/en/dev/topics/db/aggregation/#filtering-on-annotations)找到了答案。

```
apple.tags.all().annotate(food_count=Count('food')).filter(food__health_flag = True) 
```*

# validation - 灵巧：在程序化创建之前验证数据

> ID：12083349
> 
> 赞同：0
> 
> 时间：2012-08-23T00:50:32.597
> 
> 标签：validation, plone, dexterity

以编程方式创建 Dexterity 类型时，是否可以验证传递给工厂的数据，就好像它来自表单一样？

我有一个带有许多约束、不变量和验证器的 Dexterity 内容类型：

```
from zope import schema
from zope import interface
from z3c.form import validator
from plone import dexterity
from plone.directives import form
from five import grok

def is_not_foo(value):
    return value is not 'foo'

class IMyType(form.Schema):
    my_value = schema.TextLine(
        constraint = is_not_foo
    )
    min = schema.Int(default=0)
    max = schema.Int(default=99)

    @interface.invariant
    def max_more_than_min(data):
        if data.min is not None and data.max is not None:
            if data.min >= data.max:
                raise interface.Invalid( u'Min is more than Max' )

@form.error_message(form=IMyType['my_value'], error=schema.interfaces.ConstraintNotSatisfied)
def error_my_value_is_foo(value):
    return u'my_value must not be "foo"'

class ValidateMyValue(validator.SimpleFieldValidator):
    def validate(self, value):
        if value is not None:
            # value passes some test

validator.WidgetValidatorDiscriminators(
    ValidateMyValue,
    form = IMyType['my_value'],
)
grok.global_adapter(ValidateMyValue) 
```

为了确保 MyType 的所有实例都具有正确的默认值，我为它创建了一个自定义类，其属性使用 FieldProperty 映射，并在类型的 FTI 声明中分配它：

```
class MyType(dexterity.content.Item):
    interface.implements(IMyType)

    my_value = schema.fieldproperty.FieldProperty(IMyType['my_value'])
    min = schema.fieldproperty.FieldProperty(IMyType['min'])
    max = schema.fieldproperty.FieldProperty(IMyType['max']) 
```

但是，使用 时`plone.dexterity.utils.createContentInContainer`，可能会实例化*不*符合所施加的约束等的对象。理想情况下，我希望能够在创建之前自己执行此验证。

我在这里缺少一种简单的方法吗？我已经简要查看了collective.transmogrifier，但我没有看到输入验证的提及。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T06:25:33.107

您可以使用以下[`zope.schema.getValidationErrors()`功能](http://docs.zope.org/zope.schema/validation.html)：

```
 newInstance = createContentInContainer(folder, id, **schemavalues)
 errors = getValidationErrors(IMyType, newInstance)
 if errors:
     # Schema not validated; errors is a sequence of (field, exception) tuples
     # field is None if the error is for an invariant. 
```

# javascript - 如何正确呈现使用 jQuery 插件的部分模板？

> ID：12083351
> 
> 赞同：2
> 
> 时间：2012-08-23T00:51:00.193
> 
> 标签：javascript, ruby-on-rails, ruby, ruby-on-rails-3, jquery-ui

我正在使用 Ruby on Rails 3.2.2 和 jquery-rails 2.0.2 gem（包括[jQuery UI](http://jqueryui.com)插件）。为了干燥（不要重复自己）我的代码，我计划在部分模板中“提取” [jQuery Dialog Widget](http://jqueryui.com/demos/dialog)，该模板将以几乎相同的方式呈现在我的应用程序中；所以，我正在考虑通过在整个[`:locals`](http://guides.rubyonrails.org/layouts_and_rendering.html#passing-local-variables)语句中传递一些“复杂”代码（可能是 JavaScript 代码）来实现和呈现该模板......但我在如何正确传递该代码方面遇到了一些麻烦。

具体来说，我想通过传递`:locals` *which "build"* / *that "populate"*一些 jQuery Dialog *Option*、*Event*、*Method*来呈现模板（有关更多信息，请参阅[jQuery UI 官方文档](http://jqueryui.com/demos/dialog)），例如，选项`title`或事件`close`（*注意*：“通过”/“构建”/“填充”内容是 JavaScript 代码或 JavaScript 和 Ruby 代码）。

为了实现我的目标，我应该/如何/应该做什么？有一些“通用”的方法或做法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T04:59:52.240

这是一个简单的例子。看看这是否有帮助，以及 YMMV。

部分可以包含 JavaScript 和 Ruby 代码作为 ERB（或 HAML，或您想要使用的任何模板）。

我使用将共享部分放在目录中的约定`./app/views/shared`。

示例文件`./app/views/shared/_dialog.html.erb`：

```
<!-- typical jQuery dialog box creator -->
<script>
  $(function() {
    $( "#dialog" ).dialog();
  });
</script>

<!-- typical dialog with Ruby ERB for title and message -->
<div id="dialog" title="<%= title %>">
  <p><%= message %></p>
</div> 
```

要从您的视图页面调用部分：

```
<h1>My Page</h1>
<%= render :partial => "shared/dialog",
    :locals => { :title => :"Hello", :message => "World" } %> 
```

# ios - 捆绑包标识符与之前的捆绑包标识符不同，无法将名称改回原来的名称

> ID：12083352
> 
> 赞同：0
> 
> 时间：2012-08-23T00:51:07.900
> 
> 标签：ios, xcode, cfbundleidentifier

好吧，我知道它不正确，因为我的应用程序的名称是小写字母而不是大写字母。当我尝试对其进行总结时，它说无法移动，因为存在同名文件，而我找不到它。任何帮助都会有所帮助！谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T00:57:38.090

在 info .plist 中更改您的显示名称

# ios - 什么会导致视图控制器失去 firstResponder 状态？

> ID：12083354
> 
> 赞同：0
> 
> 时间：2012-08-23T00:51:23.253
> 
> 标签：ios, events, uiviewcontroller, first-responder

在我的父视图控制器中，我有这个：

```
- (BOOL)canBecomeFirstResponder
{
    return YES;
}

- (void)viewDidAppear:(BOOL)animated {
[super viewDidAppear:animated];
NSLog(@"BECOMING FIRST RESPONDER");
[[UIApplication sharedApplication] beginReceivingRemoteControlEvents];
[self becomeFirstResponder];
}

- (void) viewWillDisappear:(BOOL)animated {

[[UIApplication sharedApplication] endReceivingRemoteControlEvents];
[self resignFirstResponder];
[super viewWillDisappear:animated];

} 
```

在我想处理远程控制事件的任何子视图控制器中，我这样做：

```
- (void) remoteControlReceivedWithEvent: (UIEvent *) receivedEvent {

if (receivedEvent.type == UIEventTypeRemoteControl) {
    switch (receivedEvent.subtype) {

        case UIEventSubtypeRemoteControlTogglePlayPause:
        {
            //do something
            break;
        }

        default:
            break;
    }
} 
```

}

问题是事件是在其中一个子类中接收的，而不是在另一个子类中接收的，即使它们非常相似。它们以相同的方式呈现。它们都不会覆盖 viewDidAppear，因此它们在出现并接收远程控制事件时都应该成为第一响应者。

所以我的问题是，是什么让一个视图控制器失去了第一响应者的状态？

编辑：一些调试日志显示视图控制器实际上是第一响应者。但由于某种原因，它没有收到事件。

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2012-11-09T13:48:06.933

尝试以下操作：

```
[self resignFirstResponder]; 
```

# algorithm - 穿过二叉树

> ID：12083360
> 
> 赞同：1
> 
> 时间：2012-08-23T00:52:43.977
> 
> 标签：algorithm, search, scheme, binary-tree, racket

我在编写一个遍历二叉树的函数时遇到问题，该函数接受 search_term、list 并返回 true 或 false。这就是我所拥有的，这与我在谷歌搜索如何在 Scheme 中实现二进制搜索时发现的基本相同。

```
(define (tree-lookup val tree)
  (if (empty-tree? tree) 
      #f
  (let ((curr-val (node-value tree))
    (left (node-left tree))
    (right (node-right tree)))
    (cond ((equal? val curr-val) #t)
      ((< val curr-val))
       (tree-lookup val left)
      (else
       (tree-lookup val right))))))

(define tree-test '(((1 2) 3)(4 (5 6)) 7 (8 9 10)))  ; Test tree 
```

当它试图将“val”变量与节点进行比较时，问题就来了。这意味着我将实数与列表进行比较，例如 (< 2 '((1 2) 3))。我尝试只测试原子值，但是当我到达一片叶子时，我被困在如何回到树上。

这是错误消息：

```
 <: contract violation
  expected: real?
  given: '{{1 2} 3}
  argument position: 2nd
  other arguments...:
  8 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T01:13:55.503

乍一看，程序看起来不错。我怀疑问题出在`node-value`,`node-left`和`node-right`过程中，或者在您构建树的方式中 - 对于初学者来说，问题中提供的示例树对我来说似乎不合适。

想想看，错误信息表明`<`操作符被应用到了 list `'{{1 2} 3}`，这意味着它`curr-val`是一个列表，但它应该是一个值。

# javascript - 用默认内容初始化 tinyMCE

> ID：12083361
> 
> 赞同：1
> 
> 时间：2012-08-23T00:53:01.497
> 
> 标签：javascript, html, initialization, tinymce, default

我有一个关于**tinyMCE**的快速问题。我有一个 textarea，带有`id="mainbuffer"`和函数`tinyMCE.get(id).setContent(data)`。

仅在`onclick="function()"`从链接调用时有效，在我加载页面时无效。就我而言，它是：`tinyMCE.get('mainbuffer').setContent( localStorage.getItem('mainbuffer') );`

我试过`tinyMCE.execCommand()`了，但这也不起作用。

我希望 JavaScript 函数使用存储在 localStorage 中的数据初始化 textarea，我已经检查过，它工作正常。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T01:29:43.030

如果您想在页面加载时放置脚本，请确保将代码放在 document.ready 或 TinyMCE 之后，并且您的元素已加载。

```
document.ready=function(){
   //debug document.getElementById('mainbuffer') return not undefined?
   tinyMCE.get('mainbuffer').setContent( localStorage.getItem('mainbuffer') );
} 
```

# iptables - iptables NEW STATE 的“定义”

> ID：12083364
> 
> 赞同：2
> 
> 时间：2012-08-23T00:53:23.307
> 
> 标签：iptables

测试环境为：

2 操作系统 ubuntu server 10.04 安装在 VirtualBox 上

iptables v1.4.4

已加载 ip_conntrack 模块

这些是我的测试规则：

```
 $IPTABLES -A INPUT -p TCP -m state --state NEW -j LOG --log-prefix "[-IPT-]NEW:"
    $IPTABLES -A INPUT -p TCP -m state --state ESTABLISHED -j LOG --log-prefix "[-IPT-]ESTABLISHED:"
    $IPTABLES -A INPUT -p TCP -m state --state RELATED -j LOG --log-prefix "[-IPT-]RELATED:"
    $IPTABLES -A INPUT -p TCP -m state --state INVALID -j LOG --log-prefix "[-IPT-]INVALID:" 
```

使用

```
hping3 -c 1 192.168.0.1 -p 80 [flags combination] 
```

我得到：

```
no flag     INVALID
syn         NEW
ack         NEW
rst         INVALID
fin         INVALID
syn ack INVALID
syn rst INVALID
syn fin INVALID
ack rst INVALID
ack fin INVALID
rst fin INVALID
syn ack rst INVALID
syn rst fin INVALID
ack rst fin INVALID
syn ack rst fin INVALID 
```

我读过更多的教程说netfilter看到的第一个数据包必须是新的（在用户领域）。我不明白我的电脑中是否有什么东西不能工作。

然后，在互联网上，有很多规则可以同时考虑连接状态和 tcp 标志。这些都是错的吗？原因很简单：如果他们丢弃了匹配 new 和 ! --syn，结果很痛苦……很多数据包通过“防火墙”（如果可以这样命名的话）

新版本的 iptables 是否有可能有不同的行为？

请问，如果你在你的电脑上得到同样的结果，你能确认我吗？thx，我会很感激的！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T11:11:49.487

看看你的结果，它们几乎是我所期望的。一些决定是基于`conntrack`模块做出的，其他的我相信是基于[TCP RFC](http://www.ietf.org/rfc/rfc793.txt)中允许的行为（即标志组合） 。

当没有标志时，根据 RFC，这是完全无效的。

我相信您知道原因`SYN`被归类为`NEW`，这非常符合预期:)

`ACK`被归类为新模块，因为`conntrack`模块 (afaik) 直到 3 次握手的第三步才开始跟踪连接。

两者`RST`和`FIN`仅作为实时的当前 TCP 连接的一部分有效，因此此拒绝基于在`conntrack`此处跟踪连接的模块。

当您将 TCP 标志组合为“新”数据包时，在某些情况下（例如，ere 应该是以前的连接），而在其他情况下，根据 RFC，它们都只是明显无效的组合（再次）。例如，一个 TCP 段不应该设置`RST`and`FIN`标志，因为`ACK`和`RST`要设置应该有一个当前的 TCP 连接已经建立，以便拆除某些东西（再次提到`conntrack`模块正在跟踪这里的连接）。

您是否尝试过在 Ubuntu 12.04 或 RHEL 上运行相同的测试？我会看看我是否可以稍后再试，但我相信您的计算机正在按预期工作。不错的测试虽然:)

> 然后，在互联网上，有很多规则可以同时考虑连接状态和 tcp 标志。这些都是错的吗？

我不这么认为，我认为每个人的用例都是不同的，通过将两者结合起来，人们通常会保持谨慎。然而，大多数人没有像你那样做那么多的测试（赞），也不是所有人都理解。

> 新版本的 iptables 是否有可能有不同的行为？

不，据我所知。

# cocoa-touch - 使用 Splitview 控制器传递数据

> ID：12083365
> 
> 赞同：0
> 
> 时间：2012-08-23T00:53:28.493
> 
> 标签：cocoa-touch, xcode4

将主视图控制器之间的数据传递到拆分视图控制器中的细节控制器的最佳方法是什么？

协议/代表可以吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T01:18:44.137

查看[这篇](https://stackoverflow.com/questions/10019422/passing-values-between-master-and-detail-in-uisplitviewcontroller-using-storyboa)关于在主/详细视图控制器之间设置委托的帖子。

# php - 使用 PHP 回显 XML 文件内容

> ID：12083366
> 
> 赞同：0
> 
> 时间：2012-08-23T00:53:29.207
> 
> 标签：php, xml, xmltable

我想使用简单的表格格式回显以下 XML 文件`file_get_contents($xml)`...

```
<CallOverview>
<Calls Count="3">
<Call StartTime="10:26:25  (UTC)" Destination="+12345" Duration="00:02:25" Charge="0.039"/>
<Call StartTime="10:22:04  (UTC)" Destination="+12345" Duration="00:01:20" Charge="0.026"/>
<Call StartTime="10:08:28  (UTC)" Destination="+12345" Duration="00:02:24" Charge="0.039"/>
</Calls>
<MoreData>True</MoreData>
</CallOverview> 
```

要转换为的简单表格格式...

```
Calls Count: 3

Start Time    Destination    Duration    Charge
10:26:25      +12345         00:02:25    0.039
10:22:04      +12345         00:01:20    0.026
10:08:28      +12345         00:02:24    0.039 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T02:23:14.487

检查这个。

```
$xmltext = '<CallOverview>
                <Calls Count="3">
                <Call StartTime="10:26:25  (UTC)" Destination="+12345" Duration="00:02:25" Charge="0.039"/>
                <Call StartTime="10:22:04  (UTC)" Destination="+12345" Duration="00:01:20" Charge="0.026"/>
                <Call StartTime="10:08:28  (UTC)" Destination="+12345" Duration="00:02:24" Charge="0.039"/>
                </Calls>
                <MoreData>True</MoreData>
                </CallOverview>';
$xml = simplexml_load_string($xmltext);
foreach($xml->Calls->Call as $call)
{
    $attributes = $call->attributes();
    echo $attributes['StartTime'];
} 
```

我认为您可以改进此代码示例并完成您的工作。

# iphone - 如何让我的 iOS 应用程序处理 Web 链接

> ID：12083373
> 
> 赞同：0
> 
> 时间：2012-08-23T00:54:30.280
> 
> 标签：iphone, ios, sms

我必须让我的应用程序处理网络像（就像网络浏览器一样）。我将 CFBundleURLTypes 添加到我的 plist 文件中，然后在 CFBundleURLSchemes 中放入 http 和 CFBundleURLName com.mydomaine.myapp。然后我尝试发送带有网络链接的短信：当我点击收到的链接时它仍然打开 Safari！

这适用于自定义架构：myapp://mylink.com！但问题是：我必须向我的应用程序用户发送带有链接的短信，然后他们可以点击这些链接并打开我的应用程序，他们会做流动链接内容！Message 应用程序无法将 cutome url 架构识别为可点击的链接！所以我找到的唯一解决方案是使用 http 链接进行此操作！

（我知道我的问题可以使用 APN 解决！但由于某些原因我不能使用它！）

谢谢您的帮助 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T00:59:07.633

您不能覆盖 http 链接以重定向到您的应用程序；这会破坏系统的许多其他部分。

您应该向他们发送一个指向您设置的服务器的 http 链接。然后，该服务器可以将用户重定向到您的自定义链接方案，或提供让他们下载应用程序等。

# asp.net - ASP.NET Universal Providers 1.2 - “找不到连接名称‘LocalSqlServer’”

> ID：12083375
> 
> 赞同：0
> 
> 时间：2012-08-23T00:54:52.330
> 
> 标签：asp.net, universal, provider-model

我正在尝试 使用 Visual Studio 2010 和 Sql Server 2008中的[http://nuget.org/packages/System.Web.Providers中的“ASP.NET Universal Providers 1.2”](http://nuget.org/packages/System.Web.Providers)

一切都可以在我的本地开发盒上找到。但是，但是当我将代码部署到 DEV 服务器时，第一次访问网站时出现以下错误（我在应用程序启动中有代码创建默认角色和默认成员身份用户（如果不存在）：

“在应用程序配置中未找到连接名称‘LocalSqlServer’或连接字符串为空。”

我创建了 sql 脚本来创建 SqlMembershipProvider 表（当提供程序在本地正确运行时，从临时数据库反向工程）。正确的表在那里，使用我的开发箱上的主 sql 服务器实例可以正常工作。

我不确定为什么它试图在远程 DEV 服务器上使用旧的提供程序。我假设它是一个权限错误。在我的开发箱上，我是一名管理员，并且正在使用集成安全性。对于 DEV 服务器，我使用的是 SQL Server 帐户（请参阅下面的连接字符串），它作为 SELECT INSERT UPDATE DELETE perms 在每个 SqlMembershipProvider 表上使用。SQL Server 帐户是否需要更多权限？

这是来自 web.config 的提供程序值

```
<profile defaultProvider="DefaultProfileProvider" enabled="true">
  <providers>
    <add name="DefaultProfileProvider"
      type="System.Web.Providers.DefaultProfileProvider, System.Web.Providers, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"
      connectionStringName="MasterSqlClientConnectionString" applicationName="PortalDEV"/>
  </providers>
</profile>
<membership defaultProvider="DefaultMembershipProvider">
  <providers>
    <add name="DefaultMembershipProvider"
      type="System.Web.Providers.DefaultMembershipProvider, System.Web.Providers, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"
      applicationName="PortalDEV" connectionStringName="MasterSqlClientConnectionString" enablePasswordRetrieval="true" enablePasswordReset="true"
      requiresQuestionAndAnswer="true" requiresUniqueEmail="true" maxInvalidPasswordAttempts="3" minRequiredPasswordLength="8"
      minRequiredNonalphanumericCharacters="0" passwordAttemptWindow="10" passwordFormat="Encrypted"/>
  </providers>
</membership>
<roleManager defaultProvider="DefaultRoleProvider" enabled="true" cacheRolesInCookie="false" cookiePath="/" cookieProtection="All" cookieRequireSSL="true"
  cookieSlidingExpiration="true" cookieTimeout="16" maxCachedResults="25">
  <providers>
    <add name="DefaultRoleProvider"
      type="System.Web.Providers.DefaultRoleProvider, System.Web.Providers, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"
      connectionStringName="MasterSqlClientConnectionString" applicationName="PortalDEV"/>
  </providers>
</roleManager>
<sessionState mode="InProc" customProvider="DefaultSessionProvider" compressionEnabled="true" timeout="16">
  <providers>
    <add name="DefaultSessionProvider"
      type="System.Web.Providers.DefaultSessionStateProvider, System.Web.Providers, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"/>
  </providers>
</sessionState> 
```

这是我的连接字符串（数据被屏蔽）：

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-05-05T17:26:23.760

诀窍是在配置文件的部分开头添加“< clear />”行。 [ASP.NET Universal Providers 1.2 - “找不到连接名称‘LocalSqlServer’”](https://stackoverflow.com/questions/12083375/asp-net-universal-providers-1-2-the-connection-name-localsqlserver-was-not)

# asp.net-mvc - ASP.NET MVC 4 移动站点的错误缓存

> ID：12083381
> 
> 赞同：0
> 
> 时间：2012-08-23T00:56:14.850
> 
> 标签：asp.net-mvc, caching

在 MVC 4 APP 中，我有 Index.cshtml 和 Index.Mobile.cshtml。我已将控制器缓存设置为 varyByParam="*"。

如果我更改浏览器的用户代理，则会在开发环境中加载移动站点，但在生产中它可以正常工作几分钟。几分钟后，如果我加载移动网站，它仍然显示非移动页面的缓存版本，即 index.cshtml。

如何使用缓存并仍然加载正确的网站。我应该通过自定义还是 UserAgent 缓存它？

如果我通过用户代理使用缓存，缓存中每个页面的版本不会太多吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T03:45:23.933

这是固定在这里...

[http://aspnetwebstack.codeplex.com/workitem/280](http://aspnetwebstack.codeplex.com/workitem/280)

# r - 插入符号的预测区间

> ID：12083386
> 
> 赞同：3
> 
> 时间：2012-08-23T00:57:26.147
> 
> 标签：r, confidence-interval, r-caret

我一直在使用 R 中的 caret 包来运行一些增强的回归树和随机森林模型，并希望使用内置的交叉验证例程为一组新案例生成预测区间。

trainControl 函数允许您保存每个 n 折叠处的保留预测，但我想知道是否也可以使用内置函数在每个折叠处预测未知情况，或者我是否需要使用单独的循环构建模型 n 次。

非常感谢任何建议

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T12:48:56.263

查看 CRAN 提供的 R 包 quantregForest。它可以轻松计算随机森林模型的预测区间。该软件包的作者有一篇不错的[论文](http://www.stats.ox.ac.uk/~meinshau/quantregforests.pdf)，解释了该方法的背景。（抱歉，关于 BRT 模型的预测区间我不能说什么；我正在自己寻找它们……）

# r - 如何在 R 中创建带有误差范围的折线图

> ID：12083387
> 
> 赞同：2
> 
> 时间：2012-08-23T00:57:26.160
> 
> 标签：r, charts, plot, margin, linechart

我正在寻找一种方法来绘制随时间变化的人口比例数据，并显示边距或错误，类似于以下示例：http: [//goo.gl/dbrbu](http://goo.gl/dbrbu)。但找不到任何说明。谢谢！

![在此处输入图像描述](../Images/e210da7b3fced7e4bf6a21ae1963186b.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T02:55:28.930

一个`ggplot2`解决方案：

我将在 R 中使用美国人口数据集：

```
population <- data.frame(Year=seq(1790, 1970, length.out=length(uspop)), 
                         Population=uspop, 
                         Error=rnorm(length(uspop), 5))

library(ggplot2)
ggplot(population, aes(x=Year, y=Population, 
                       ymin=Population-Error, ymax=Population+Error))+
  geom_line(colour="red", size=1.2)+
  geom_point(pch=2)+
  geom_errorbar(width=0.9) 
```

![在此处输入图像描述](../Images/669c9a3e591c7a9773df525ae508b472.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T01:47:12.633

plotrix 包有 plotCI：

```
 require(plotrix)
 y<-runif(10)
 err<-runif(10)
 plotCI(1:10,y,err,2*err,lwd=2,col="red",scol="blue", 
                  main="Add colors to the points and error bars")
 lines(1:10, y) 
```

![在此处输入图像描述](../Images/ee72bc780e58f798942ce38df7e5f80d.png)

（对示例代码的一个非常小的调整是添加连接中点的线。）

# php - 使用多级数组

> ID：12083388
> 
> 赞同：5
> 
> 时间：2012-08-23T00:57:32.310
> 
> 标签：php, arrays

你好，我正在学习 PHP，并在使用 print_r 后遇到了这个多级数组`$this->root`

```
 Array ( 
    [0] => 9 
    [obj] => 3562 
    [gen] => 0 
    [1] => Array ( 
        [0] => 5 
        [1] => Array ( 
            [/AcroForm] => Array ( 
                [0] => 8 
                [1] => 3563 
                [2] => 0 
                ) 
            [/Metadata] => Array ( 
                [0] => 8 
                [1] => 3559 
                [2] => 0 
                ) 
            [/PageLabels] => Array ( 
                [0] => 8 
                [1] => 3389 
                [2] => 0 
                ) 
            [/Pages] => Array ( 
                [0] => 8 
                [1] => 3392 
                [2] => 0 
                ) 
            [/Type] => Array ( 
                [0] => 2 
                [1] => /Catalog 
                ) 
            ) 
        ) 
    ) Array ( 
        [0] => 9 
        [obj] => 8 
        [gen] => 0 
        [1] => Array ( 
            [0] => 5 
            [1] => Array ( 
                [/Type] => Array ( 
                    [0] => 2 
                    [1] => /Catalog 
                    ) 
                [/Pages] => Array ( 
                    [0] => 8 
                    [1] => 1 
                    [2] => 0 
                    ) 
                [/OpenAction] => Array ( 
                    [0] => 6 
                    [1] => Array ( 
                        [0] => Array ( 
                            [0] => 8 
                            [1] => 3 
                            [2] => 0 
                            ) 
                        [1] => Array ( 
                            [0] => 2 
                            [1] => /FitH 
                            ) 
                        [2] => Array ( 
                            [0] => 0 
                            ) 
                        ) 
                    ) 
                [/PageLayout] => Array ( 
                    [0] => 2 
                    [1] => /OneColumn 
                    ) 
                ) 
            ) 
        ) 
```

我对使用多级数组的行为有疑问，我想使用这个函数

```
$pages = $this->pdf_resolve_object($this->c, $this->root[1][1]['/Pages']); 
```

我相信它用于检查这些键的数组， `$this->root[1][1]['/Pages']`如果它存在，则用作 pdf_resolve_object 的变量

所以我的问题是 2 倍，一个是`$this->root[1][1]['/Pages']`检查数组并通过键？如果不是，它的行为是什么？和 2 当它检查数组时，它是通过前 4 个键还是所有子键？

如果有人可以帮助我或将我链接到一些非常感谢的学习材料，谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T01:01:22.607

1）它不检查数组键的存在——而是*假设*这些键已经存在并将值传递给函数。如果任何键不存在，PHP 会发出一个提示`E_NOTICE`，`Notice: Undefined index:`即未找到该键。要检查它们，需要致电`isset()`或`array_key_exists()`喜欢：

```
if (isset($this->root[1][1]['/Pages'])) {
  $pages = $this->pdf_resolve_object($this->c, $this->root[1][1]['/Pages']);
} 
```

2）它不需要遍历来找到键。知道数组键已经意味着可以直接访问它们而无需迭代。在内存中，PHP 存储了数组键和它们指向的值的内存位置。因此，仅凭键，PHP 就可以返回值，而无需遍历数组。

[PHP 手册](http://php.net/manual/language.types.array.php)中有很多关于数组的好信息

# vb.net - 当 datagridview 中的一行发生更改时，如何更新标签的文本？

> ID：12083391
> 
> 赞同：0
> 
> 时间：2012-08-23T00:58:19.877
> 
> 标签：vb.net, datagridview

在我的表单上，我有一个标签 (lblBalance)，我有一个从 Access 数据库填充的 DGV。如果我添加、删除或更新一行，如何刷新标签文本以反映新余额？

到目前为止，这是我的 frmMain 代码：

```
 Public Class frmMain

      Private Sub TransactionsBindingNavigatorSaveItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles TransactionsBindingNavigatorSaveItem.Click
        Me.Validate()
        Me.TransactionsBindingSource.EndEdit()
        Me.TableAdapterManager.UpdateAll(Me.CheckingDataSet)

      End Sub

      Private Sub frmMain_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
        'TODO: This line of code loads data into the 'CheckingDataSet.Transactions' table. You can move, or remove it, as needed.
        Me.TransactionsTableAdapter.Fill(Me.CheckingDataSet.Transactions)
        lblTotalCredits.Text = BalanceTotal().ToString("c")
      End Sub

      Private Function BalanceTotal() As Double
        Dim tot As Double = 0
        Dim i As Integer = 0
        For i = 0 To TransactionsDataGridView.Rows.Count - 1
            tot = tot + Convert.ToDouble(TransactionsDataGridView.Rows(i).Cells(3).Value)
        Next i
        Return tot
      End Function
    End Class 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T01:04:16.157

BindingSource 控件有一个`ListChanged`事件，您可以尝试使用它来更新余额标签。

```
Private Sub TransactionsBindingSource_ListChanged(_
                sender As Object, _
                e As ListChangedEventArgs) _
                Handles TransactionsBindingSource.ListChanged

  lblTotalCredits.Text = BalanceTotal().ToString("c")

End Sub 
```

# c# - 获取 T 类型的所有控件的通用方法

> ID：12083404
> 
> 赞同：0
> 
> 时间：2012-08-23T01:02:08.037
> 
> 标签：c#, asp.net, generics

我有一个返回`List<T>`子控件的方法，如下所示：

```
void GetAllControlsOfType<T>(List<T> lst, Control parent) where T:class
{
    if (parent.GetType() == typeof(T))
        lst.Add(parent as T);

    foreach (Control ch in parent.Controls)
        this.GetAllControlsOfType<T>(lst, ch);
} 
```

但我必须像这样使用它：

```
List<WebControl> foo = new List<WebControl>();
GetAllControlsOfType<WebControl>(foo, this); //this = webpage instance 
```

当然，有一些 c# 魔法可以让我编写一个可以这样调用的方法：

```
List<WebControl> foo = GetAllControlsOfType<WebControl>(this); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T01:09:15.470

“魔术”只是声明另一种返回`List<T>`而不是的方法`void`。

```
List<T> GetAllControlsOfType<T>(Control parent) where T : class {
    List<T> list = new List<T>();
    GetAllControlsoFType<T>(list, parent);   // Invoke your existing method
    return list;
} 
```

因为您使用的是递归，所以不能简单地将现有方法*修改*`List<T>`为 return ，因为这样做会使您无法跟踪该列表并在其上构建。

其他几个小点：

*   你有：

    ```
    if (parent.GetType() == typeof(T)) 
    ```

    但写成这样会更清楚：

    ```
    if (parent is T) 
    ```

    当然，除非你真的希望你的方法*在*与`T`.

*   您可能需要考虑将新方法声明为扩展方法，方法是`parent`声明为`this Control parent`（假设它是在静态类中声明的）

    这将允许您调用该方法`this.GetAllControlsOfType<WebControl>()`

# android - 如何根据sqlite数据库中的文件名显示实际图像

> ID：12083405
> 
> 赞同：0
> 
> 时间：2012-08-23T01:02:20.093
> 
> 标签：android, image, sqlite, imageview, android-imageview

我有一个看起来像这样的本地 sqlite 数据库文件……</p>

```
_ID | Color_Name | Image_Name  
1   | Red        | red.png  
2   | Blue       | blue.png  
3   | Green      | green.png  
Etc. 
```

数据库的 Image_Name 列仅包含文件名，而不包含图像本身。所有图像都存储在本地 res/drawable-mdpi 目录中。

目标是有一个列表，显示数据库中该颜色的颜色名称和相关图像。例如，列表看起来像这样 [下面的加号表示实际的 .png 图像]...</p>

```
____________________________________________

Red (text only on this line)  
+ (actual red.png image on this line)  
____________________________________________

Blue (text only on this line)  
+ (actual blue.png image on this line)  
____________________________________________

Etc. 
```

我可以获得要显示的颜色名称，但我不知道如何让图像本身显示。显示名称的相关代码部分如下...</p>

```
static class ColorHolder {
    private TextView name=null;

     ColorHolder(View row) {             
        name=(TextView)row.findViewById(R.id.colorName);

        }
           void populateFrom(Cursor c, ColortHelper r) {

               name.setText(r.getName(c)) ;
          }
} 
```

名称和图像的 xml 文件的相关部分如下......</p>

```
<TextView 
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:layout_gravity="bottom|left"
android:id="@+id/colorName"/>

<ImageView
 android:id="@+id/ImageView00"
 android:layout_width="fill_parent"
 android:layout_height="fill_parent"
 android:src="@drawable/image1" <!--[NOTE: THIS DEFAULT IMAGE FILE SHOULD BE REPLACED ON THE FLY W/THE CORRECT IMAGE FILE FOR EACH RECORD]-->
  > 
```

我发现的其他问题都没有帮助我解决这个问题。有人可以帮我解决这个问题吗？我很乐意为您提供任何帮助，但如果您可以在您的解释中使用我的实际文件名/路径/变量/ID 等（如上所示），这将特别有帮助，以便我可以最轻松地遵循和理解您的回复。指向我的教程可能没有帮助，因为我已经看过很多材料但没有解决这个问题。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T02:12:13.207

使用[Resources.getIdentifier(String name, String defType, String defPackage)](http://developer.android.com/reference/android/content/res/Resources.html#getIdentifier%28java.lang.String,%20java.lang.String,%20java.lang.String%29)

此外，您不需要存储资源图像名称......只需将它们命名为与颜色相同的名称（正如您已经完成的那样），只需确保正如我在这里展示的那样它们是小写的

要使用您的示例：

```
void populateFrom(Cursor c, ColorHelper r) {

    //get the color name from your database (only once)

    String strColor = r.getName(c);

    // set the text on your TextView as before

    TextView clrName = (TextView)findViewById(R.id.ImageView00);
    clrName.setText(strColor);

    // get the resource ID - note "name" without extension

    int resourceID = context.getResources().getIdentifier(strColor.toLower(),
            "drawable", context.getPackageName());

    //get a reference to your imageview and set the image

    ImageView clrImage = (ImageView)findViewById(R.id.ImageView00);
    clrImage.setImageResource(resourceID);

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T01:31:32.837

有几种方法可以做到这一点。如果我必须自己做，我会将图像保存为数据库中的 Blob。直接且易于使用。另一种选择是使用 if - else if - else if 像这样：

```
ImageView imageview = findViewById(R.id.ImageView00);
    if( colorname.equals("Red") )
        imageview.setImageResource(R.drawable.red);
    else if( colorname.equals("Red") )
        imageview.setImageResource(R.drawable.blue); 
```

# performance - FORTRAN - 减少函数调用开销

> ID：12083406
> 
> 赞同：3
> 
> 时间：2012-08-23T01:02:24.800
> 
> 标签：performance, function, optimization, fortran, fortran90

我有一个这样的fortran代码：

文件1.f90

```
program myprog
 use func1mod
    do i=1,N
       call subroutine1
    enddo
    subroutine subroutine1
         integer*8::var1,var2,var3,...
         do j=1,N
            x=func1(var1,var2,var3,..)
            computations based on x
         enddo
    return
    end
end 
```

文件2.f90

```
 module func1mod
 contains
     func1(var1,var2,var3,....)
         func1=some computations based on var1, var2, var3, ...
      return
     end function func1
 end module func1mod 
```

函数 func1 不修改其任何参数。它根据参数计算一个值并返回一个值。# of arguments 很大，但函数少于 30 行代码。减少函数调用开销的最佳方法是什么。一种方法是内联函数。有没有其他的出路？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-23T01:31:34.087

您能做的最好的事情就是尽可能明确地说明函数的语义，尽可能提高优化，让编译器就如何最好地实现调用做出最佳决策。确保虚拟变量被标记`intent(in)`，并将函数标记为`pure`- 虽然如果它只有 30 行，编译器无疑会在高度优化时注意到这些东西 - 并检查你的编译器选项，看看你是否可以做任何事情来鼓励（对于实例）内联。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-23T01:21:18.520

通常，过程调用的开销很低。如果函数有 30 行代码，您可能会获得很少的收益，因为实际函数将支配函数调用。如果您想确定，请测量当前实现的运行时间，然后内联代码并测量该运行时间。

# javascript - 如何点击页面上的坐标？

> ID：12083408
> 
> 赞同：1
> 
> 时间：2012-08-23T01:03:07.160
> 
> 标签：javascript, jquery

这可能是一个如此简单的问题，但是在阅读了一些关于 Stack Overflow 的教程和其他帖子之后，我无法得到我想要的东西。

使用`.click()`jQuery 中的函数，我想单击页面上的特定`X`, 和`Y`位置。我发现的只是有关如何查找坐标的教程，但没有专门单击它们。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T01:39:32.120

请参阅[使用 jQuery 在特定位置查找元素？](https://stackoverflow.com/questions/3942776/jquery-find-element-at-a-particular-position)

要获取点 (x,y) 下的元素，请使用 document.elementFromPoint。您可以将其包装在 jquery 对象中并调用单击处理程序来模拟实际单击。

```
function click(x,y) {
   var element = document.elementFromPoint(x,y);
   $(element).click();
} 
```

小心使用 elementFromPoint 关于绝对坐标与视口相对坐标的缺点[http://www.zehnet.de/2010/11/19/document-elementfrompoint-a-jquery-solution/](http://www.zehnet.de/2010/11/19/document-elementfrompoint-a-jquery-solution/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T01:06:52.697

只需将点击事件绑定到一个元素，然后相应地处理它......没有什么不符合规范的。举个例子：

```
$(el).bind('click', function(event){
     var x = event.pageX,
         y = event.pageY;

     console.log(x + " : " + y); // change to alert to see results with no console
}); 
```

您不必担心如何正确处理获取鼠标偏移量。jQuery 对其进行了修复，因此您可以简单地说`event.pageX`/`event.pageY`来获取任何浏览器中的位置。在上面的示例中，我只是将 x 和 y 设置为局部变量，但是如果您必须在可调用范围之外使用它，则可以将它们设为全局变量。请注意，这会将坐标记录到您的 Web 控制台，如果您无法访问它，请更改`console.log`为`alert`确保一切正常。

编辑：重读您的问题后，我的答案发生了变化：

您可以通过使用设置特定元素的 x 和 y 坐标来定位特定元素[`document.elementFromPoint`](https://developer.mozilla.org/en-US/docs/DOM/document.elementFromPoint)。根据[this page](http://www.quirksmode.org/dom/w3c_cssom.html#documentview)似乎在主要浏览器中都支持。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-23T01:06:32.370

这是一个关于 jQuery 文档的[不错的小教程。](http://docs.jquery.com/Tutorials%3aMouse_Position)基本上它是这样的：

```
$('#chosen_element').click(function(e){
    alert('X position is:' + e.pageX + 'Y position is:' + e.pageY);
}); 
```

# github - 我已经在 github 上创建了一个 repo。我如何从原始仓库中获取所有更改？

> ID：12083409
> 
> 赞同：1
> 
> 时间：2012-08-23T01:03:07.000
> 
> 标签：github, repository, fork

在这种情况下，我从 github 分叉了grocery-CRUD repo。我做了一些更改，并提交了一个拉取请求。作者接受它，并做一些其他的修改。如何获取对我的杂货店 CRUD 存储库的最新修改？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T01:13:25.653

您将他的 repo 添加为远程 ( `git remote add <his repo> <repo spec>`)。

然后，您从他的 repo 中提取更改 ( `git pull <his repo>`)

然后，您将更改推送到您的 repo ( `git push origin`)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T01:22:52.690

```
git pull git://github.com/scoumbourdis/grocery-crud.git 
```

这将获取更改并将它们与本地存储库中的当前分支合并。如果你想把它放在你的遥控器上，你需要推送

```
git push origin 
```

# java - 序列化/反序列化缓冲图像

> ID：12083412
> 
> 赞同：0
> 
> 时间：2012-08-23T01:03:58.377
> 
> 标签：java, bufferedimage, javax.imageio

我有一组要序列化然后反序列化的缓冲图像。例如，我有一个 arrayList 充满了缓冲图像，这些图像被迭代并写入 ObjectOutputStream

```
for (BufferedImages i : images{

ImageIO.write(i,"png",ImageIO.createImageOutputStream(output));

} 
```

当我去重新序列化图像时，我尝试使用

```
 BufferedImage image =ImageIO.read(ImageIO.createImageInputStream(input)); 
```

但它只读取一张图片。

重新序列化存储在同一序列化文件中的缓冲图像集合的正确方法是什么？

此外，一旦图像被重新序列化，它们就会被重绘为 JLabel，我如何知道哪个图像是每个 JLabel 的正确图像？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T04:53:19.863

**编辑：问题已解决**

最终将缓冲的图像转换为字节数组，然后将它们放入哈希映射并使用一些哈希码作为键。然后序列化哈希图。都好。

# uistoryboard - 禁止 Storyboard Segue 执行 segue 动作

> ID：12083415
> 
> 赞同：1
> 
> 时间：2012-08-23T01:04:08.207
> 
> 标签：uistoryboard, segue, uistoryboardsegue

**问题** 我如何拒绝故事板转场的发生？

**上下文：** 我在第一个可见的视图控制器上有一个静态分组表视图（如果你愿意的话，主菜单）。

我特意提前展示 UI，让用户有机会进行交互并感知快速的加载响应。例如，可能正在导入数据的其他操作发生在后台操作队列上。事实上，我的大部分 UI 功能都可以在您看到它们时立即使用。

但是，特别是一个菜单项（表格行）在导入一些数据之前还没有准备好（当一切准备好时我会发送通知）。

虽然我可以删除这个动作的情节提要转场，但它让我思考如何因为不满足某个条件而阻止转场触发。

我可能会在实践中允许 segue，并让目标视图控制器限制初始化，直到它收到它正在等待的通知。

但是可以以编程方式拦截并阻止它吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-26T06:46:07.923

在 iOS 6.0 及更高版本中，您可以通过覆盖 -[UIViewController shouldPerformSegueWithIdentifier:sender:] 方法并返回 NO 来防止在通常触发它的操作发生后触发 segue。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T02:25:51.977

你可以做一个程序化的转场，而不是使用控制器本身的转场，然后你使用 performSegueWithIdentifier 进行转场，然后你可以测试这个特定的转场并决定是否这样做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-25T12:48:55.487

您可以将 UIStoryboardSegue 子类化，如其[参考](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIStoryboardSegue_Class/Reference/Reference.html)中所述。

一个可能的实现：

。H

```
@interface MYPushNoAnimationSegue : UIStoryboardSegue
@end 
```

.m

```
#import "MYPushNoAnimationSegue.h"

@implementation MYPushNoAnimationSegue

- (void)perform {
    if (condition) {
        [[(UIViewController *)self.sourceViewController navigationController] pushViewController:self.destinationViewController animated:NO];
    }
}

@end 
```

完成后，您可以在情节提要中选择现有的 segue，然后将其样式设置为自定义，并在属性检查器中将 MYPushNoAnimationSegue 输入到 Segue 类。

我知道很多时间过去了，也许你已经解决了它，但它可能会帮助其他面临同样问题的人。

# c# - 比较两个 DateTimeOffset 对象

> ID：12083422
> 
> 赞同：6
> 
> 时间：2012-08-23T01:05:44.330
> 
> 标签：c#, .net, silverlight

我想以天为单位计算两个[DateTimeOffset](http://msdn.microsoft.com/en-us/library/system.datetimeoffset.aspx)对象的差异（例如检查差异是否小于 40 天）。

我知道可以通过将其更改为 FileTime 来完成，但想知道是否有更好的方法。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-23T01:19:34.577

最简单的方法是从彼此中减去偏移量。它返回一个`TimeSpan`你可以比较的。

```
var timespan = DateTimeOffset1 - DateTimeOffset2;
// timespan < TimeSpan.FromDays(40);
// timespan.Days < 40 
```

我倾向于将其添加到传递 TimeSpan 的另一种方法中的能力，因此您不仅限于几天或几分钟，而只是一段时间。就像是：

```
bool IsLaterThan(DateTimeOffset first, DateTimeOffset second, TimeSpan diff){} 
```

为了好玩，如果你喜欢流畅的代码（除了测试和配置之外，我不是它的忠实粉丝）

```
public static class TimeExtensions
{
    public static TimeSpan To(this DateTimeOffset first, DateTimeOffset second)
    { 
        return first - second;
    }

    public static bool IsShorterThan(this TimeSpan timeSpan, TimeSpan amount)
    {
        return timeSpan > amount;
    }

    public static bool IsLongerThan(this TimeSpan timeSpan, TimeSpan amount)
    {
        return timeSpan < amount;
    }
} 
```

将允许类似：

```
var startDate = DateTimeOffset.Parse("08/12/2012 12:00:00");
var now = DateTimeOffset.UtcNow;

if (startDate.To(now).IsShorterThan(TimeSpan.FromDays(40)))
{
    Console.WriteLine("Yes");
} 
```

上面写着“如果从开始日期到现在的时间短于 40 天”。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-23T01:19:51.340

`DateTimeOffset`有一个返回 a 的 Subtract 运算符`TimeSpan`：

```
if((dto1 - dto2).Days < 40)
{
} 
```

# excel - Excel宏根据条件计算值

> ID：12083424
> 
> 赞同：0
> 
> 时间：2012-08-23T01:05:51.090
> 
> 标签：excel, vba

嗨，我需要一个宏来根据某些条件计算发生次数。这是数据表的示例：

```
ID     Paydate        # of payments
1       5/1/2011            3
1       5/1/2011            3
1       3/1/2011            2
1       2/1/2011            1
2       6/12/2011           3
2       5/12/2011           2
2       4/12/2011           1
3       4/25/2011           2
3       3/25/2011           1 
```

我想计算一个 ID 到该日期为止的付款次数（第三列是我需要的）。例如，对于 ID =1 和 paydate = 5/1/2011，有 3 笔付款，对于 ID=1 和 paydate = 3/1/2011，有 2 笔付款。宏应该计算小于或等于当前日期的付款次数，如果有多个 ID 具有相同的日期，则不会增加计数。

如果有一种方法可以使用很棒的公式来做到这一点，但它似乎太复杂了。任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T01:54:47.740

您不需要宏或 vba。

```
=COUNTIFS(A:A,A2,B:B,"<=" & B2) 
```

把它放在C2中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T02:21:35.677

没有足够的信息可以继续，例如您是否获得要查找的日期以及您在哪里获得要查找的 ID。因此，如果我做出一堆假设，我可以编写一些这样的 VBA。这也有点长，可以分解成另一个函数来获取用户响应

```
Option Explicit
Sub numberOfPayments()
On Error Resume Next
Dim iRow As Integer
Dim iCol As Integer
Dim dtDate As Date
Dim iID As Integer
Dim sResponse As String
Dim iNumberOfPayments As Integer

'initialize the variables
iNumberOfPayments = 0
iRow = 2
iCol = 1

'get the date
sResponse = InputBox("Calculate for what date? (M/D/YYYY)", "Get Payment Date")

'check to make sure its a valid date
If IsDate(sResponse) Then
    'set date we are looking for
    dtDate = CDate(sResponse)
Else
    MsgBox "You must enter a valid date"
    Exit Sub
End If

'reset the response
sResponse = ""
'get the ID
sResponse = InputBox("Calculate for what ID?", "Get Payment ID")

'set the ID to look for
iID = CInt(sResponse)

'if the conversion failed there will be an error
If Err.Number <> 0 Then
    MsgBox "You must enter a valid ID"
    Exit Sub
End If

'assumes you have data in each cell
Do While Cells(iRow, iCol).Value <> ""
    'check the ID
    If Cells(iRow, iCol).Value = iID Then
        'this is done as not sure if the column is formatted as a date or just text
        If IsDate(Cells(iRow, iCol + 1).Text) Then
            If dtDate <= CDate(Cells(iRow, iCol + 1).Text) Then
                'add the payments
                iNumberOfPayments = iNumberOfPayments + Cells(iRow, iCol + 2).Value
            End If
        End If
    End If
    'move to the next row
    iRow = iRow + 1
Loop
'inform them of the number of payments
MsgBox "there are " + Str(iNumberOfPayments) + " total payments."

End Sub 
```

# list - 尝试创建用户定义对象的列表，得到 NullPointerException

> ID：12083427
> 
> 赞同：0
> 
> 时间：2012-08-23T01:06:15.150
> 
> 标签：list

我正在开发一个 Android 应用程序。我（在一个单独的 .java 文件中）创建了一个像这样的对象：

```
class RRS_Location {
String tagname;
String href;

// Constructor
public RRS_Location(String tagname, String href) {
    this.tagname = tagname;
    this.href = href;
}

public String getTagname()  {
    return tagname;
}

public String getHref() {
    return href;
}
} 
```

在一个活动中，我声明了这些项目的列表
`List<RRS_Location> rrs_list;`

当我尝试将 RRS_Location 对象添加到列表时，我收到了 NullPointerException。我正在使用此代码
`rrs_list.add(new RRS_Location(e1, e2));`

我用 Toast 向我回显我有有效的字符串 e1 和 e2。关于为什么我得到例外的任何想法？蒂亚！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T01:15:26.757

您是否`rrs_list`在调用之前进行实例化`add`？

`List<RRS_Location> rrs_list = new ArrayList<RRS_Location>();`

如果没有，这就是为什么你得到一个 NullPointerException，你试图调用一个`null`对象的方法。

# android - Android 4.1 AcousticEcho Canceler - 它是一个完整的解决方案吗？

> ID：12083432
> 
> 赞同：0
> 
> 时间：2012-08-23T01:07:37.153
> 
> 标签：android

在 Android 4.1 中，AcousticEchoCancel 预处理器是实际的回声消除器还是只是对单独的非 Android 代码或硬件模块的调用？我正在构建一个需要声学回声消除器的免提电话，并且需要澄清运行 Android 4.1 是否能让我获得此功能的完整版本。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T02:34:35.083

此效果在 android 框架中实现，并保证在任何运行 JB 的设备上都可用。它不是某些本机实现的包装器。

# ruby-on-rails - 弹性搜索/轮胎：如何过滤布尔属性？

> ID：12083434
> 
> 赞同：11
> 
> 时间：2012-08-23T01:08:39.540
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, elasticsearch, tire

我想过滤我班级的私有布尔值，因此它只显示非私有但对我不起作用的资源。（我大大简化了代码）

```
mapping do
  indexes :private,  type: "boolean"
  indexes :name, type: "string"
 end 
end

def self.search(params)
    tire.search(load: true, page: params[:page], per_page: 20) do
       query  { string params[:query] } if params[:query].present?
       # So far I've tried...
       # filter :bool, :private => ["false"] 
       # filter :bool,  private: false
    end
end 
```

我该如何正确地做到这一点？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-08-25T05:05:00.900

```
 filter :term, :private => false 
```

应该做的伎俩。根据您是否要使用方面做一些事情，过滤过滤后的查询可能比在顶级过滤更有效，即

```
tire.search(...) do 
  query do
    filtered do
      query { string, params[:query] }
      filter :term, :private => false
    end
  end
end 
```

它不应该改变结果。

您也可以使用`bool`过滤器执行此操作，但与您尝试的方式不同 - 在 bool 过滤器中，您需要构建一个[结构](http://www.elasticsearch.org/guide/reference/query-dsl/bool-filter.html)，说明哪些是可选的，哪些不是

例如

```
tire.search(load: true, page: params[:page], per_page: 20) do
   query  { string params[:query] } if params[:query].present
   filter :bool, :must => {:term => {:private => true}}
end 
```

`bool`过滤器比使用过滤器慢（`and`如果您指定多个过滤器，这就是轮胎在幕后所做的事情），但显然会给您更多的灵活性。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-25T04:50:34.453

你可以试试：

```
tire.search(load: true, page: params[:page], per_page: 20) do
    query do
        boolean do
            must { string params[:query] } if params[:query].present?
            must { term :private, true }
        end
    end
end 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-25T04:50:19.923

根据[elasticsearch-guide](http://www.elasticsearch.org/guide/reference/mapping/core-types.html)，布尔值存储为 T 或 F，所以我会尝试按 T 或 F 过滤。

例如

```
filter :terms, :private => ['T'] 
```

我实际上并没有使用过轮胎，这只是基于对指南和[示例](https://github.com/karmi/tire/blob/master/examples/tire-dsl.rb)的一些研究。

# ruby-on-rails - 通过 CYGWIN 在 Windows 上安装 Ruby on Rails

> ID：12083436
> 
> 赞同：1
> 
> 时间：2012-08-23T01:08:58.853
> 
> 标签：ruby-on-rails, ruby, cygwin

我正在尝试按照此页面上的说明进行操作：

[http://www.agilereasoning.com/2011/05/25/ruby-on-rails-on-windows-7-using-cygwin/](http://www.agilereasoning.com/2011/05/25/ruby-on-rails-on-windows-7-using-cygwin/)

我一直在尝试首先使用 railsinstaller 安装 Rails，但我遇到了诸如没有 vim 之类的困难，我无法从 Windows 命令提示符复制和粘贴，所以我安装了 CYGWIN。它没有正确下载文件，所以我手动下载了它们，有些很难找到。我找不到作为 .tar 文件的最终包，所以我下载了 libxslt-devel-1.1.20-1.i386.rpm。

> ## 右键单击 Cygwin 快捷方式并从菜单中选择编辑。将内容更改为 >match：
> 
> 1 @echo 关闭 2 C:\cygwin\bin\rxvt -sr -sl 1500 -e C:\cygwin\bin\bash.exe --login -i

我是否必须将其作为命令在可执行文件或 cygwin 命令提示符内运行？当我尝试这样做时，我得到了这个：

> ## -bash：“命令”：找不到命令

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T02:14:08.900

这里有很多问题。

*   您可以使用 Edit->Mark 或 Edit->Paste 复制/粘贴命令提示符
*   libxslt-devel-1.1.20-1.i386.rpm 是一个 linux 文件。
*   C:\cygwin\bin\rxvt - 你为什么要搞乱 rxvt？

我建议您安装[ruby​​installer + devkit](http://rubyinstaller.org/downloads/)，然后执行 gem install rails。但是，不要期望对 Rails 在 Windows 上的性能感到满意。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-27T06:54:10.610

通过 CYGWIN 在 Windows 上运行 Ruby on Rails
尝试：

*   安装[流浪者](https://www.vagrantup.com)*   [虚拟盒子](http://www.virtualbox.org)，*   和 Cygwin（或 PuTTy，我正在使用 Cygwin）。
使用此设置，打开 Cygwin，转到您的项目文件夹，运行`vagrant init <box>`（我的盒子是[hashcorp/precise64 - 查看其他](https://atlas.hashicorp.com/boxes/search "查看其他可用的盒子")）（您可能还想 cfg 您的[Vagrantfile](https://gist.github.com/jacksonpires/403ac7e61dfd70e302b1da281decbe15 "我的设置是这样的")？）。

一切就绪，运行：`vagrant up`现在`vagrant ssh`
你有一个正在运行的虚拟机（Ubuntu），你可以安装rvm（推荐......这样你就可以拥有不同版本的Ruby），或者直接使用ruby，rails等......（`sudo apt-get ruby -v x.x.x`，等）

- Vagrant “创建和配置轻量级、可重现和可移植的开发环境”。
- Cygwin 帮助解决 ssh 问题等...
- Virtual Box 管理机器（Ubuntu 或其他操作系统）

有了这套，我在 Windows 上运行 Ruby（在 Rails 上）完全没有问题。

# java - GWT 定时器生命周期

> ID：12083437
> 
> 赞同：0
> 
> 时间：2012-08-23T01:09:00.617
> 
> 标签：java, gwt, timer

假设我有以下（[参考页](http://google-web-toolkit.googlecode.com/svn/javadoc/2.4/com/google/gwt/user/client/Timer.html)）：

```
public class TimerExample implements EntryPoint, ClickHandler {

  public void onModuleLoad() {
    Button b = new Button("Click and wait 5 seconds");
    b.addClickHandler(this);

    RootPanel.get().add(b);
  }

  public void onClick(ClickEvent event) {
    // Create a new timer that calls Window.alert().
    Timer t = new Timer() {
      @Override
      public void run() {
        Window.alert("Nifty, eh?");
      }
    };

    // Schedule the timer to run once in 5 seconds.
    t.schedule(5000);
  }
} 
```

`onClick`方法退出后 Timer 怎么还在？自动局部变量不应该被垃圾收集吗？

这是否与我们谈论 HTML 计时器的事实有关，因此该对象存在于自动局部变量之外？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T02:27:38.163

该`Timer.schedule(int delayMillis)`方法将自身（Timer 的实例）添加到 Timer 列表（来自 2.5.0-rc1 的源代码）：

```
 /**
   * Schedules a timer to elapse in the future.
   * 
   * @param delayMillis how long to wait before the timer elapses, in
   *          milliseconds
   */
  public void schedule(int delayMillis) {
    if (delayMillis < 0) {
      throw new IllegalArgumentException("must be non-negative");
    }
    cancel();
    isRepeating = false;
    timerId = createTimeout(this, delayMillis);
    timers.add(this);  // <-- Adds itself to a static ArrayList<Timer> here
  } 
```

* * *

来自@veer 解释调度程序线程的评论：

> 计时器将由一个调度程序线程处理，该线程持有对计时器的引用，因此可以*正确地*防止它被垃圾收集。

# sql-server - 替换所有数据库字段中的字符

> ID：12083439
> 
> 赞同：1
> 
> 时间：2012-08-23T01:09:10.710
> 
> 标签：sql-server, quotes, double-quotes

我们收到了一个 MSSQL 数据库，其中包含许多需要清理的表和字段。我们需要做的一件事是从任何文本字段中删除所有引号（chr(34) 和 chr(39)）。

寻找一种自动而不是手动执行此操作的方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T01:37:09.667

一种基于非集合的方法：
下面的 sproc 基本上可以满足您的需求。
它使用嵌套的 WHILE 循环

*   父 WHILE 循环获取所有用户定义的表
*   嵌套的 WHILE 循环遍历所有基于字符的列（您可以修改）。然后它使用动态 SQL 来更新新字符串。

对于许多桌子和大型桌子，这显然需要相当长的时间才能完成。我相信这可以更好地优化。
如果有人能找到基于集合的方法，那就太好了。

来源和礼貌：[Vyaskn](http://vyaskn.tripod.com/sql_server_search_and_replace.htm)

```
CREATE PROC SearchAndReplace
(
    @SearchStr nvarchar(100),
    @ReplaceStr nvarchar(100)
)
AS
BEGIN

    SET NOCOUNT ON

    DECLARE @TableName nvarchar(256), @ColumnName nvarchar(128), @SearchStr2 nvarchar(110), @SQL nvarchar(4000), @RCTR int
    SET  @TableName = ''
    SET @SearchStr2 = QUOTENAME('%' + @SearchStr + '%','''')
    SET @RCTR = 0

    WHILE @TableName IS NOT NULL
    BEGIN
        SET @ColumnName = ''
        SET @TableName = 
        (
            SELECT MIN(QUOTENAME(TABLE_SCHEMA) + '.' + QUOTENAME(TABLE_NAME))
            FROM    INFORMATION_SCHEMA.TABLES
            WHERE       TABLE_TYPE = 'BASE TABLE'
                AND QUOTENAME(TABLE_SCHEMA) + '.' + QUOTENAME(TABLE_NAME) > @TableName
                AND OBJECTPROPERTY(
                        OBJECT_ID(
                            QUOTENAME(TABLE_SCHEMA) + '.' + QUOTENAME(TABLE_NAME)
                             ), 'IsMSShipped'
                               ) = 0
        )

        WHILE (@TableName IS NOT NULL) AND (@ColumnName IS NOT NULL)
        BEGIN
            SET @ColumnName =
            (
                SELECT MIN(QUOTENAME(COLUMN_NAME))
                FROM    INFORMATION_SCHEMA.COLUMNS
                WHERE       TABLE_SCHEMA    = PARSENAME(@TableName, 2)
                    AND TABLE_NAME  = PARSENAME(@TableName, 1)
                    AND DATA_TYPE IN ('char', 'varchar', 'nchar', 'nvarchar')
                    AND QUOTENAME(COLUMN_NAME) > @ColumnName
            )

            IF @ColumnName IS NOT NULL
            BEGIN
                SET @SQL=   'UPDATE ' + @TableName + 
                        ' SET ' + @ColumnName 
                        + ' =  REPLACE(' + @ColumnName + ', ' 
                        + QUOTENAME(@SearchStr, '''') + ', ' + QUOTENAME(@ReplaceStr, '''') + 
                        ') WHERE ' + @ColumnName + ' LIKE ' + @SearchStr2
                EXEC (@SQL)
                SET @RCTR = @RCTR + @@ROWCOUNT
            END
        END 
    END

    SELECT 'Replaced ' + CAST(@RCTR AS varchar) + ' occurence(s)' AS 'Outcome'
END 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-16T16:14:10.127

如果要替换 Unicode 字符，请使用以下代码：

```
CREATE PROC SearchAndReplace
(
    @SearchStr nvarchar(100),
    @ReplaceStr nvarchar(100)
)
AS
BEGIN

    SET NOCOUNT ON

    DECLARE @TableName nvarchar(256), @ColumnName nvarchar(128), @SearchStr2 nvarchar(110), @SQL nvarchar(4000), @RCTR int
    SET  @TableName = ''
    SET @SearchStr2 = QUOTENAME('%' + @SearchStr + '%','''')
    SET @RCTR = 0

    WHILE @TableName IS NOT NULL
    BEGIN
        SET @ColumnName = ''
        SET @TableName = 
        (
            SELECT MIN(QUOTENAME(TABLE_SCHEMA) + '.' + QUOTENAME(TABLE_NAME))
            FROM    INFORMATION_SCHEMA.TABLES
            WHERE       TABLE_TYPE = 'BASE TABLE'
                AND QUOTENAME(TABLE_SCHEMA) + '.' + QUOTENAME(TABLE_NAME) > @TableName
                AND OBJECTPROPERTY(
                        OBJECT_ID(
                            QUOTENAME(TABLE_SCHEMA) + '.' + QUOTENAME(TABLE_NAME)
                             ), 'IsMSShipped'
                               ) = 0
        )

        WHILE (@TableName IS NOT NULL) AND (@ColumnName IS NOT NULL)
        BEGIN
            SET @ColumnName =
            (
                SELECT MIN(QUOTENAME(COLUMN_NAME))
                FROM    INFORMATION_SCHEMA.COLUMNS
                WHERE       TABLE_SCHEMA    = PARSENAME(@TableName, 2)
                    AND TABLE_NAME  = PARSENAME(@TableName, 1)
                    AND DATA_TYPE IN ('char', 'varchar', 'nchar', 'nvarchar')
                    AND QUOTENAME(COLUMN_NAME) > @ColumnName
            )

            IF @ColumnName IS NOT NULL
            BEGIN
                SET @SQL=   'UPDATE ' + @TableName + 
                        ' SET ' + @ColumnName 
                        + ' =  REPLACE(' + @ColumnName + ', N' 
                        + QUOTENAME(@SearchStr, '''') + ', N' + QUOTENAME(@ReplaceStr, '''') + 
                        ') WHERE ' + @ColumnName + ' LIKE N' + @SearchStr2
                EXEC (@SQL)
                SET @RCTR = @RCTR + @@ROWCOUNT
            END
        END 
    END

    SELECT 'Replaced ' + CAST(@RCTR AS varchar) + ' occurence(s)' AS 'Outcome'
END 
```

# java - WEBDAV java库连接Exchange server 2007

> ID：12083443
> 
> 赞同：0
> 
> 时间：2012-08-23T01:09:31.910
> 
> 标签：java, .net, outlook, webdav, exchange-server-2007

是否有任何 Webdav 开源 java 库用于连接 Exchange 2007 以访问邮件、日历和联系人（必须使用 httpclient 4.*）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T05:22:00.643

I don't know of a library using WebDAV, however, if you can guarantee at least Exchange 2007, SP1 Microsoft put out a Java wrapper for Exchange Web Services (a more functional SOAP based interface).

You can find it at [http://archive.msdn.microsoft.com/ewsjavaapi](http://archive.msdn.microsoft.com/ewsjavaapi)

Edit: actually just noticed I'm using httpclient 3.1 with it... not 4... might not suit your usecase...

# xml - 是否可以在此 XSLT 上构建以转换为 CSV 格式的文件？

> ID：12083445
> 
> 赞同：0
> 
> 时间：2012-08-23T01:09:39.277
> 
> 标签：xml, xslt, csv

我目前正在使用 xslt 将我的 xml 转换为我可以使用的格式的 xml。我有一个新要求，即以 csv 格式的文件提供转换后的输出 xml。

这是 xslt 之前的 xml：

```
<?xml version='1.0' encoding='UTF-8'?>
<bb:Report_Data xmlns:bb="urn:com.playdate.report/Absence_Balances-Outbound">
   <bb:Report_Entry>
      <bb:projectedBalanceTotal.principalId>1040182074</bb:projectedBalanceTotal.principalId>
      <bb:All_Eligible_Time_Off_Plans_for_Worker>
         <bb:projectedBalanceTotal.planCodeId>Sick</bb:projectedBalanceTotal.planCodeId>
         <bb:projectedBalanceTotal.leaveDescription>Sick</bb:projectedBalanceTotal.leaveDescription>
         <bb:projected_balance_accrual_amount_for_the_pay_period>0</bb:projected_balance_accrual_amount_for_the_pay_period>
      </bb:All_Eligible_Time_Off_Plans_for_Worker>
      <bb:All_Eligible_Time_Off_Plans_for_Worker>
         <bb:projectedBalanceTotal.planCodeId>Vacation</bb:projectedBalanceTotal.planCodeId>
         <bb:projectedBalanceTotal.leaveDescription>Vacation</bb:projectedBalanceTotal.leaveDescription>
         <bb:projected_balance_accrual_amount_for_the_pay_period>3.323077</bb:projected_balance_accrual_amount_for_the_pay_period>
      </bb:All_Eligible_Time_Off_Plans_for_Worker>
      <bb:All_Eligible_Time_Off_Plans_for_Worker>
         <bb:projectedBalanceTotal.planCodeId>Winter Recess</bb:projectedBalanceTotal.planCodeId>
         <bb:projectedBalanceTotal.leaveDescription>Winter Recess</bb:projectedBalanceTotal.leaveDescription>
         <bb:projected_balance_accrual_amount_for_the_pay_period>0</bb:projected_balance_accrual_amount_for_the_pay_period>
      </bb:All_Eligible_Time_Off_Plans_for_Worker>
      <bb:projectedBalanceTotal.effectiveDate1>08122012</bb:projectedBalanceTotal.effectiveDate1>
      <bb:projectedBalanceTotal.effectiveDate2>08262012</bb:projectedBalanceTotal.effectiveDate2>
      <bb:projectedBalanceTotal.effectiveDate3>09092012</bb:projectedBalanceTotal.effectiveDate3>
                <bb:projectedBalanceTotal.employeeId>0260971</bb:projectedBalanceTotal.employeeId>
   </bb:Report_Entry>

</bb:Report_Data> 
```

这是在 @Tim C 的帮助下使用的 XSLT：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:bb="urn:com.playdate.report/Absence_Balances-Outbound">
   <xsl:output method="xml" indent="yes"/>

   <xsl:template match="/">
      <bb:Report_Data>
         <xsl:apply-templates select="bb:Report_Data/bb:Report_Entry"/>
      </bb:Report_Data>
   </xsl:template>

   <xsl:template match="bb:Report_Entry">
      <xsl:apply-templates select="*[starts-with(local-name(),'projectedBalanceTotal.effectiveDate')]"/>
   </xsl:template>

   <xsl:template match="*[starts-with(local-name(),'projectedBalanceTotal.effectiveDate')]">
      <xsl:apply-templates select="../bb:All_Eligible_Time_Off_Plans_for_Worker">
         <xsl:with-param name="date" select="."/>
      </xsl:apply-templates>
   </xsl:template>

   <xsl:template match="bb:All_Eligible_Time_Off_Plans_for_Worker">
      <xsl:param name="date"/>
      <projectedBalanceTotal>
         <xsl:copy-of select="../bb:projectedBalanceTotal.principalId"/>
         <xsl:copy-of select="*"/>
         <bb:projectedBalanceTotal.effectiveDate>
            <xsl:value-of select="$date"/>
         </bb:projectedBalanceTotal.effectiveDate>
         <xsl:copy-of select="../bb:projectedBalanceTotal.employeeId"/>
      </projectedBalanceTotal>
   </xsl:template>
</xsl:stylesheet> 
```

这是输出：

```
<?xml version="1.0"?>
<bb:Report_Data xmlns:bb="urn:com.playdate.report/Absence_Balances-Outbound">
   <projectedBalanceTotal>
      <bb:projectedBalanceTotal.principalId>1040182074</bb:projectedBalanceTotal.principalId>
      <bb:projectedBalanceTotal.planCodeId>Sick</bb:projectedBalanceTotal.planCodeId>
      <bb:projectedBalanceTotal.leaveDescription>Sick</bb:projectedBalanceTotal.leaveDescription>
      <bb:projected_balance_accrual_amount_for_the_pay_period>0</bb:projected_balance_accrual_amount_for_the_pay_period>
      <bb:projectedBalanceTotal.effectiveDate>08122012</bb:projectedBalanceTotal.effectiveDate>
      <bb:projectedBalanceTotal.employeeId>0260971</bb:projectedBalanceTotal.employeeId>
   </projectedBalanceTotal>
   <projectedBalanceTotal>
      <bb:projectedBalanceTotal.principalId>1040182074</bb:projectedBalanceTotal.principalId>
      <bb:projectedBalanceTotal.planCodeId>Vacation</bb:projectedBalanceTotal.planCodeId>
      <bb:projectedBalanceTotal.leaveDescription>Vacation</bb:projectedBalanceTotal.leaveDescription>
      <bb:projected_balance_accrual_amount_for_the_pay_period>3.323077</bb:projected_balance_accrual_amount_for_the_pay_period>
      <bb:projectedBalanceTotal.effectiveDate>08122012</bb:projectedBalanceTotal.effectiveDate>
      <bb:projectedBalanceTotal.employeeId>0260971</bb:projectedBalanceTotal.employeeId>
   </projectedBalanceTotal>
   <projectedBalanceTotal>
      <bb:projectedBalanceTotal.principalId>1040182074</bb:projectedBalanceTotal.principalId>
      <bb:projectedBalanceTotal.planCodeId>Winter Recess</bb:projectedBalanceTotal.planCodeId>
      <bb:projectedBalanceTotal.leaveDescription>Winter Recess</bb:projectedBalanceTotal.leaveDescription>
      <bb:projected_balance_accrual_amount_for_the_pay_period>0</bb:projected_balance_accrual_amount_for_the_pay_period>
      <bb:projectedBalanceTotal.effectiveDate>08122012</bb:projectedBalanceTotal.effectiveDate>
      <bb:projectedBalanceTotal.employeeId>0260971</bb:projectedBalanceTotal.employeeId>
   </projectedBalanceTotal>
   <projectedBalanceTotal>
      <bb:projectedBalanceTotal.principalId>1040182074</bb:projectedBalanceTotal.principalId>
      <bb:projectedBalanceTotal.planCodeId>Sick</bb:projectedBalanceTotal.planCodeId>
      <bb:projectedBalanceTotal.leaveDescription>Sick</bb:projectedBalanceTotal.leaveDescription>
      <bb:projected_balance_accrual_amount_for_the_pay_period>0</bb:projected_balance_accrual_amount_for_the_pay_period>
      <bb:projectedBalanceTotal.effectiveDate>08262012</bb:projectedBalanceTotal.effectiveDate>
      <bb:projectedBalanceTotal.employeeId>0260971</bb:projectedBalanceTotal.employeeId>
   </projectedBalanceTotal>
   <projectedBalanceTotal>
      <bb:projectedBalanceTotal.principalId>1040182074</bb:projectedBalanceTotal.principalId>
      <bb:projectedBalanceTotal.planCodeId>Vacation</bb:projectedBalanceTotal.planCodeId>
      <bb:projectedBalanceTotal.leaveDescription>Vacation</bb:projectedBalanceTotal.leaveDescription>
      <bb:projected_balance_accrual_amount_for_the_pay_period>3.323077</bb:projected_balance_accrual_amount_for_the_pay_period>
      <bb:projectedBalanceTotal.effectiveDate>08262012</bb:projectedBalanceTotal.effectiveDate>
      <bb:projectedBalanceTotal.employeeId>0260971</bb:projectedBalanceTotal.employeeId>
   </projectedBalanceTotal>
   <projectedBalanceTotal>
      <bb:projectedBalanceTotal.principalId>1040182074</bb:projectedBalanceTotal.principalId>
      <bb:projectedBalanceTotal.planCodeId>Winter Recess</bb:projectedBalanceTotal.planCodeId>
      <bb:projectedBalanceTotal.leaveDescription>Winter Recess</bb:projectedBalanceTotal.leaveDescription>
      <bb:projected_balance_accrual_amount_for_the_pay_period>0</bb:projected_balance_accrual_amount_for_the_pay_period>
      <bb:projectedBalanceTotal.effectiveDate>08262012</bb:projectedBalanceTotal.effectiveDate>
      <bb:projectedBalanceTotal.employeeId>0260971</bb:projectedBalanceTotal.employeeId>
   </projectedBalanceTotal>
   <projectedBalanceTotal>
      <bb:projectedBalanceTotal.principalId>1040182074</bb:projectedBalanceTotal.principalId>
      <bb:projectedBalanceTotal.planCodeId>Sick</bb:projectedBalanceTotal.planCodeId>
      <bb:projectedBalanceTotal.leaveDescription>Sick</bb:projectedBalanceTotal.leaveDescription>
      <bb:projected_balance_accrual_amount_for_the_pay_period>0</bb:projected_balance_accrual_amount_for_the_pay_period>
      <bb:projectedBalanceTotal.effectiveDate>09092012</bb:projectedBalanceTotal.effectiveDate>
      <bb:projectedBalanceTotal.employeeId>0260971</bb:projectedBalanceTotal.employeeId>
   </projectedBalanceTotal>
   <projectedBalanceTotal>
      <bb:projectedBalanceTotal.principalId>1040182074</bb:projectedBalanceTotal.principalId>
      <bb:projectedBalanceTotal.planCodeId>Vacation</bb:projectedBalanceTotal.planCodeId>
      <bb:projectedBalanceTotal.leaveDescription>Vacation</bb:projectedBalanceTotal.leaveDescription>
      <bb:projected_balance_accrual_amount_for_the_pay_period>3.323077</bb:projected_balance_accrual_amount_for_the_pay_period>
      <bb:projectedBalanceTotal.effectiveDate>09092012</bb:projectedBalanceTotal.effectiveDate>
      <bb:projectedBalanceTotal.employeeId>0260971</bb:projectedBalanceTotal.employeeId>
   </projectedBalanceTotal>
   <projectedBalanceTotal>
      <bb:projectedBalanceTotal.principalId>1040182074</bb:projectedBalanceTotal.principalId>
      <bb:projectedBalanceTotal.planCodeId>Winter Recess</bb:projectedBalanceTotal.planCodeId>
      <bb:projectedBalanceTotal.leaveDescription>Winter Recess</bb:projectedBalanceTotal.leaveDescription>
      <bb:projected_balance_accrual_amount_for_the_pay_period>0</bb:projected_balance_accrual_amount_for_the_pay_period>
      <bb:projectedBalanceTotal.effectiveDate>09092012</bb:projectedBalanceTotal.effectiveDate>
      <bb:projectedBalanceTotal.employeeId>0260971</bb:projectedBalanceTotal.employeeId>
   </projectedBalanceTotal>
</bb:Report_Data> 
```

我有一个紧急要求，需要 csv 格式的每条记录，例如：

```
projectedBalanceTotal.principalId, projectedBalanceTotal.planCodeId, projectedBalanceTotal.leaveDescription, projected_balance_accrual_amount_for_the_pay_period, projectedBalanceTotal.effectiveDate, projectedBalanceTotal.employeeId
1040182074, Sick, Sick, 0, 08122012, 0260971
1040182074, Vacation, Vacation, 3.323077, 0260971
1040182074, Winter Recess, Winter Recess, 0, 0260971 
```

等等等等

我可以在这个模板上堆叠另一个模板来完成这个吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T04:07:53.750

> 我可以在这个模板上堆叠另一个模板来完成这个吗？

是的。但是“怎么样？” 是一个稍微棘手的问题。

如果您可以使用 XSLT 2.0，只需从现有模板中获取输出，并将其视为另一个输出 CSV 模板的输入文档。

如果您坚持使用 XSLT 1.0，则需要使用 nodeset() 扩展（非标准，但在 XSLT 实现中很常见）。使用此函数将现有模板的输出从结果树片段 (RTF) 转换为节点集，以便新模板可以使用它来将其转换为 CSV。

## 更新

好的，所以将 XSLT 版本 =“1.0”更改为“2.0”。现在将输出方法从“xml”更改为“text”。

然后修改 match="/" 模板说：

```
<xsl:template match="/">
   <xsl:variable name="reportData">
      <bb:Report_Data>
         <xsl:apply-templates select="bb:Report_Data/bb:Report_Entry"/>
      </bb:Report_Data>
   </xsl:variable>
   <xsl:text>projectedBalanceTotal.principalId, projectedBalanceTotal.planCodeId, projectedBalanceTotal.leaveDescription, projected_balance_accrual_amount_for_the_pay_period, projectedBalanceTotal.effectiveDate, projectedBalanceTotal.employeeId</xsl:text>
   <xsl:apply-templates select="$reportData//projectedBalanceTotal" mode="xml2csv" />
</xsl:template> 
```

然后添加一个模板将 a`<projectedBalanceTotal>`转换为 CSV 记录：

```
<xsl:template match="projectedBalanceTotal" mode="xml2csv">
   <xsl:value-of select="bb:projectedBalanceTotal.principalId" />
   <xsl:text>, </xsl:text>
   ...
   <xsl:text>&#10;</xsl:text> <!-- end of line -->
</xsl:template> 
```

# c++ - 返回与使用参考参数

> ID：12083451
> 
> 赞同：21
> 
> 时间：2012-08-23T01:11:05.143
> 
> 标签：c++, return-value, ref

这真的让我很烦，来自 C# 背景。

有时，我会看到这样写的函数：

```
int computeResult(); 
```

这是我习惯的。但后来我看到它们是这样写的：

```
void computeResult(int &result); 
```

我觉得这很奇怪。如果有的话，第二种方法比第一种方法有什么好处？一定有什么，因为我经常看到。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-08-23T01:15:59.957

此类非常量引用参数有两个常见原因：

*   您可能需要在一个函数中使用多个“out”参数，并且使用引用参数可以做到这一点。

*   您的对象复制起来可能很昂贵，因此您传入一个将被变异的引用，而不是返回一个可能会作为返回过程的一部分被复制的对象。昂贵的复制对象可能包括标准容器（如`vector`）和管理堆内存的对象，其中会发生分配-复制-解除分配序列。请注意，编译器在可能的情况下非常擅长优化这些副本，因此这个原因的导入量比以前少了。

编辑：我应该澄清，即使在 C++ 中，您提供的带有单个内置类型引用参数的特定示例也非常不典型。在这种情况下，返回值几乎总是首选。

# java - 如果需要参数，如何实例化新的公共 Java 类？

> ID：12083456
> 
> 赞同：-2
> 
> 时间：2012-08-23T01:12:28.280
> 
> 标签：java, constructor, parameter-passing

我需要一个公开的数组（类中的其他方法可以访问），但该数组需要一个输入值“T”来创建它。如何实例化需要用户输入的“全局”变量？

我的代码如下：

```
public class PercolationStats {
    **private double myarray[];**
    public PercolationStats(int N, int T) {
        **double myarray = new double[T];**
        for (i=0;i<T;i++) {
            Percolation percExperiment as new Percolation(N);
            //do more stuff, make calls to percExperiment.publicmethods
            myarray[i] = percExperiment.returnvalue;
        }
    }
    public static void main(String[] args) {
        int N = StdIn.readInt();
        int T = StdIn.readInt();
        PercolationStats percstats = new PercolationStats(N, T);
        //do more stuff, including finding mean and stddev of myarray[]
        StdOut.println(output);
    } 
```

伪代码中的另一个示例：

```
class PercolationStats {
    Constructor(N, T) {
        new Percolation(N) //x"T" times
    }
    Main {
        new PercolationStats(N, T) //call constructor
    }
}
class Percolation {
    Constructor(N) {
        **new WQF(N)** //another class that creates an array with size dependent on N
    }
    Main {
        **make calls to WQF.publicmethods**
    }
} 
```

在第二个示例中，在我看来，我需要在 Percolation 的构造函数中创建类 WQF 的新实例，以便接受参数 N。但是，WQF 不能被 Percolation 的 Main 方法访问。帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T02:14:34.973

Tedd Hopp 的回答纠正了您代码中的错误。

我只想指出这`myarray`不是全局变量。

1.  Java没有全局变量，
2.  它最接近的是`static`变量，并且
3.  `myarray`也不是其中之一。正如您声明的那样，它是一个**实例**变量。

（并且一个实例变量是实现这个的正确方法...... IMO）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T01:18:46.720

不要在构造函数中包含类型声明。您正在创建一个屏蔽该字段的局部变量。它应该如下所示：

```
public class PercolationStats {
    public double myarray[];
    public PercolationStats(int n, int y) {
        myarray = new double[t];
        for (i=0; i<t; i++) {
            Percolation percExperiment = new Percolation(n);
            //do more stuff, make calls to percExperiment.publicmethods
            myarray[i] = percExperiment.returnvalue;
        }
    }
    public static void main(String[] args) {
        int n = StdIn.readInt();
        int t = StdIn.readInt();
        PercolationStats percstats = new PercolationStats(n, t);
        //do more stuff, including finding mean and stddev of myarray[]
        StdOut.println(output);
    }
} 
```

在创建新数组时使用变量作为长度当然没有问题。

# sql - 如何创建 SQL IF 语句来检查字段是否需要更新

> ID：12083457
> 
> 赞同：0
> 
> 时间：2012-08-23T01:12:40.027
> 
> 标签：sql, stored-procedures

我创建了一个更新过程，如果另一个表中的匹配记录发生更改，它将更改表中记录的值，但是，我如何设置它是即使有 12 个字段可以更新，即使只更改了 1 个字段，该过程也会更新它们中的每一个

这是因为效率低下，仅 1 条记录大约需要 50 秒，如果有几百条记录就不好了，我想出了足够简单的伪代码

```
if olddata != newdata

    UPDATE!!!

endif 
```

问题是我对 SQL 中的 if 语句几乎没有经验，如果我可以使用 PHP，那么只需运行带有 WHERE 子句的 SELECT 就很容易了，就像上面的 if 语句然后检查它返回的行数（如果为 0，则没有变化）但程序必须只是 SQL，我能想到的最好的就是这个

```
IF(SELECT o.field FROM originaltbale AS o INNER JOIN updatetable AS u ON o.primarykey = u.primarykey WHERE o.field <> u.field) != 0

     UPDATE!!!

ENDIF 
```

但我怀疑这会起作用，因为我确定 SELECT 不会返回行数，我怎样才能创建一个像这样工作的 if 语句

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T03:35:22.860

我不确定我是否完全理解您要更新的内容，但是最好在单个语句中执行此操作并将 IF 合并到 WHERE 子句中。

```
UPDATE updatetable u
   SET ... something ...
 WHERE EXISTS ( SELECT 1 FROM originaltable o WHERE o.primarykey = u.primarykey AND ... ) 
```

但是，如果您将相同的字段存储在两个表中，您确定这是您的表的最佳数据库设计吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T02:30:07.187

如果您想知道是否存在满足您的条件的行，则`EXISTS`可以使用该子句。

```
-- If the original table doesn't have a record with the state same as that in updatetable
IF NOT EXISTS (SELECT o.field FROM originaltbale AS o INNER JOIN updatetable AS u ON o.primarykey = u.primarykey WHERE o.field <> u.field)
BEGIN

    UPDATE !!!

END 
```

希望这可以帮助。

# javascript - Windows 8 Market App，JS，访问远程 XML 文件？

> ID：12083460
> 
> 赞同：3
> 
> 时间：2012-08-23T01:12:54.810
> 
> 标签：javascript, jquery, xml, windows-8

我之前在进行标准 Web 开发时遇到过同源策略问题。我通常最终编写一个 vb.net Web 服务作为代理。但是，既然我正在尝试使用 Javascript 涉足 Windows 8 开发（由于熟悉），我想知道我的选择是什么来避免这个问题。

我需要做的就是获取一个远程 XML 文件并从中显示信息。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T02:33:12.757

只要您启用了 Internet（客户端）功能（默认情况下），您就可以直接对 xml 文件进行 WinJS.xhr 调用。我一直在几个应用程序中这样做。

我假设您要做的就是下载一个 xml 文档并处理数据。

如果您正在查看发送跨文档消息，您应该查看[http://msdn.microsoft.com/en-us/library/windows/apps/hh441295.aspx 。](http://msdn.microsoft.com/en-us/library/windows/apps/hh441295.aspx)如果您想深入讨论动态 Web 内容、安全上下文等 - 这是一个很好的起点，虽然有点过时[http://channel9.msdn.com/Events/BUILD/BUILD2011/APP-476T](http://channel9.msdn.com/Events/BUILD/BUILD2011/APP-476T)

# node.js - Express Node.js 应用程序使用 Mongoose 失去与 MongoLab 数据库的连接

> ID：12083461
> 
> 赞同：0
> 
> 时间：2012-08-23T01:12:59.480
> 
> 标签：node.js, heroku, express, mongoose, mlab

所以在尝试了很多事情之后，我已经使用 Heroku 连接到我的 MongoLab 服务器。唯一的问题是在我真正去我的网站之前，它给了我一个`Process exited with status 1`（下面的完整日志）。该应用程序在我的本地服务器上运行良好。下面是 app.js 代码。该应用程序本身位于 brads-testing.herokuapp.com。

**应用程序.js**：

```
//requires and start up app
var express = require('express');
var mongoose = require('mongoose')
  , dbURI = 'localhost/test';
var app = express();

//configures app for production, connects to mongoLab databse rather than localhost
app.configure('production', function () {
    //app.use(express.logger());
    console.log("production!");
    dbURI = 'mongodb://USERNAME:PASSWORD@ds037387.mongolab.com:37387/test';
});

//configures app for general stuff needed
app.configure(function () {
    //app.use(express.logger());
    app.use(express.bodyParser());
    app.use(express.static(__dirname + '/static'));
});

//tries to connect to database. If it does, connected set to true. If not, connected stays false
var connected = false;
mongoose.connect(dbURI);
mongoose.connection.on('open', function () {
    console.log("connected!");
    connected = true;
    //creates new schema for object post and saves it to the database
    var postSchema = new mongoose.Schema({
        body: String
    });

    var Post = mongoose.model('Post', postSchema);

    app.set('views', __dirname + '/views');
    app.set('view engine','jade');

    app.get('/', function(request, response) {
        response.render('index');
    });

    app.post('/result', function(request, response) {
    if (connected) {
        var post = new Post({body: request.body.text});
        console.log(post);
        post.save(function (err) {
            if (err) {
                console.log("error!");
            } else {
                console.log("saved!");
            }
        });

        Post.find(function (err, posts) {
            if (!err) {
                console.log("found!");
                console.log(posts);
                response.render('result', {posts: posts});
            } else {
                connected = false;
                var error = "The server had an issue sending/executing the query..."
                response.render('result_error', {error: error});
            }
        });
        } else {
        var error = "The server didn't end up connecting..."
        response.render('result_error', {error: error});
        }
    });

    app.get('/result', function (request, response) {
        if (connected) {
        Post.find(function (err, posts) {
            if (!err) {
                console.log("found!");
                console.log(posts);
                response.render('result', {posts: posts});
            } else {
                connected = false;
                var error = "The server had an issue sending/executing the query..."
                response.render('result_error', {error: error});
            }
        });
        } else {
            var errorText = "The server didn't end up connecting..."
            response.render('result_error', {error: errorText});
        }
    });

    app.listen(process.env.PORT || 5000);

});
mongoose.connection.on('error', console.error.bind(console, 'connection error:')); 
```

**终端日志**：

```
2012-08-22T19:19:26+00:00 heroku[web.1]: Starting process with command `node app.js`
2012-08-22T19:19:26+00:00 heroku[web.1]: Stopping all processes with SIGTERM
2012-08-22T19:19:28+00:00 app[web.1]: production!
2012-08-22T19:19:28+00:00 app[web.1]: connected!
2012-08-22T19:19:28+00:00 heroku[web.1]: State changed from starting to up
2012-08-22T19:19:29+00:00 heroku[web.1]: Process exited with status 1 
```

可悲的是，`connected!`信息和信息`Process exited with status 1`是可以互换的。有时一个在另一个之前，有时它是相反的。希望有人可以提供帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T01:49:25.250

获得更多日志信息会很好。我代替它，这里有几件事可以在你自己的环境中尝试：

*   已知某些驱动程序不适用于所有版本的 MongoDB。MongoLab 正在运行 2.0.x，这是目前最新的稳定代码线。但由于我们正处于 2.2.x GA 版本的风口浪尖上，所以有一些驱动程序，特别是一些驱动程序版本，需要最新的 2.2.x 开发版本。我不确定 Mongoose 是否是其中之一，但您应该尝试在本地运行与您的 MongoLab 实例正在运行的版本相同的版本。

*   MongoLab 数据库以身份验证模式运行，并且用户仅被授予对他们自己的数据库的权限（出于明显的安全原因）。这意味着某些命令（例如列出所有数据库）将失败。因此，请尝试以身份验证模式运行本地数据库并以非管理员用户身份进行身份验证。

# unit-testing - Windows Store 应用程序的单元测试库中选择的模拟框架是什么？

> ID：12083462
> 
> 赞同：17
> 
> 时间：2012-08-23T01:13:09.570
> 
> 标签：unit-testing, mocking, windows-8

当我编写单元测试时，我喜欢使用 Rhino Mocks。

因此，当我开始我的第一个 Windows 应用商店应用程序时，我自然而然地首先开始了我的单元测试。当我尝试通过[NuGet添加](https://nuget.org/)[RhinoMocks](http://ayende.com/blog/tags/rhino-mocks)时，收到以下错误

> 无法安装软件包“RhinoMocks 3.6.1”。您正在尝试将此包安装到以“.NETCore,Version=v4.5”为目标的项目中，但该包不包含与该框架兼容的任何程序集引用。有关详细信息，请联系包作者。

我对起订量有同样的问题。

.NETCor,Version=v4.5 是否有模拟框架？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-25T03:54:55.760

大多数模拟框架都基于`Reflection.Emit`. 不幸`Reflection.Emit`的是不在 WinRT 中。这意味着你不能做动态代理。（即运行时模拟）。这留下了在编译时引用的模拟的预生成。我知道的唯一框架是 Moq 的一个实验分支：[https ://github.com/mbrit/moqrt](https://github.com/mbrit/moqrt)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-24T08:56:21.033

我制作这个是为了与 Windows Phone 7 一起使用，应该与 Win 8 一起使用，因为它只是一个后期构建步骤：

[http://dontcodetired.com/blog/post/Introducing-%28probably%29-The-Worlds-Only-Mocking-Framework-for-Windows-Phone-7-%28WP7%29.aspx](http://dontcodetired.com/blog/post/Introducing-%28probably%29-The-Worlds-Only-Mocking-Framework-for-Windows-Phone-7-%28WP7%29.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-27T00:26:28.143

这是我的建议，请注意我自己还没有测试过这些。 [这](http://www.richonsoftware.com/post/2012/04/05/Using-Stubs-and-Shim-to-Test-with-Microsoft-Fakes-in-Visual-Studio-11.aspx)是讨论前两个选项的文章的链接。

1.  TypeMock Isolator - 昂贵，但看起来可以完成这项工作
2.  Microsoft Fakes（从 MSR 的一个名为 Moles 的项目演变而来）
3.  您可以使用不同的技术，而不是模拟（或进行依赖注入）。您可以使用参数化注入并只传递您需要测试的信息。这将大对象简化为委托和原语，从而减轻了对模拟框架的需求。[这里](http://arlobelshee.com/post/easily-eliminate-most-mocks)有更多关于这一点的内容，包括一个实际应用的技术[示例](http://blog.approvaltests.com/2012/03/testing-difficult-code.html)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-01T09:57:29.767

实际上，[FakeItEasy](https://github.com/FakeItEasy/FakeItEasy)的贡献者之一[Philipp Dolder](https://twitter.com/philippdolder)提出了一种基于可移植类库的有趣且可行的方法。 [http://www.planetgeek.ch/2013/02/01/fakeiteasy-and-windows-store-apps-are-becoming-friends/](http://www.planetgeek.ch/2013/02/01/fakeiteasy-and-windows-store-apps-are-becoming-friends/)

本质上，他提出了以下解决方案：

1.  将所有将被 TDD 编辑的生产代码放入 PCL 类库中，您可以在其中选择您喜欢支持的任何目标框架
2.  将您的测试程序集创建为常规类库
3.  添加对 FakeItEasy 的引用和您选择的测试框架（例如 NUnit + FluentAssertions）到您的 *.Test 程序集
4.  仅将无法测试的 UI 内容放入 Windows Store App 项目中

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2015-07-30T13:28:52.637

我知道最初的问题已经过时了，但我们中的许多人仍然试图在 Windows 应用商店应用程序中完成模拟。

我最近开始使用[MoqaLate](https://moqalate.codeplex.com/)，它指出：Mocking for Windows Phone & Windows Store apps。在您构建解决方案之后，它实际上会物理创建 MockingClasses。因此，在构建之后，您将拥有一个文件夹，其中包含您的类的一些 Mock 实现。

我认为不是最好的选择。运行时模拟将是理想的，但同时它为我创建了模拟。

# php - 未显示带有 Infobox PHP/SQL 的 Google Map API v3

> ID：12083463
> 
> 赞同：0
> 
> 时间：2012-08-23T01:13:11.800
> 
> 标签：php, javascript, sql, google-maps-api-3

当我尝试将自定义信息框与 google API v3 PHP / SQL 数据库一起使用时，我遇到了当前问题。我很难弄清楚我在哪里搞砸了，div 显示为空白而不是地图。任何帮助都会很棒！

```
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<script src="http://maps.google.com/maps/api/js?sensor=false" type="text/javascript"></script>
<script type="text/javascript" src="http://google-maps-utility-library-v3.googlecode.com/svn/trunk/infobox/src/infobox.js"></script>
<script type="text/javascript">

var customIcons = {
  Clinic: {
    icon: 'icon_2.png',
  },
  Secondary: {
    icon: 'icon_1.png',
  }
};

function initialize() {
    var map = new google.maps.Map(document.getElementById("map_canvas"), {
        center: new google.maps.LatLng(47.6145, -122.3418),
        zoom: 13,
        scrollwheel: false,
        mapTypeId: 'roadmap'
    });

    downloadUrl("xml.php", function(data) {
        function createMarker(markerXML) {
            var name = markerXML.getAttribute("name"),
                postid = markers [i].getAttribute("post_id"),
                address = markers[i].getAttribute("address"),
                phone = markers[i].getAttribute("phone"),          
                listtype = markers[i].getAttribute("type"),
                monday = markers[i].getAttribute("monday"),
                tuesday = markers[i].getAttribute("tuesday"),
                wednesday = markers[i].getAttribute("wednesday"),
                thursday = markers[i].getAttribute("thursday"),
                friday = markers[i].getAttribute("friday"),
                saturday = markers[i].getAttribute("saturday"),
                sunday = markers[i].getAttribute("sunday"),
                type = markers[i].getAttribute("type"),
                point = new google.maps.LatLng(
                lat = parseFloat(markerXML.getAttribute("lat")),
                lng = parseFloat(markerXML.getAttribute("lng")),

                icon = customIcons[type] || {},

                marker = new google.maps.Marker({
                    map: map,
                    position: new google.maps.LatLng(lat, lng),
                    icon: icon.icon,
                }),

                boxText = document.createElement("div");

            boxText.style.cssText = "border: 1px solid black; margin-top: 8px; background: yellow; padding: 5px;";
            boxText.innerHTML = "<b>" + name + "</b> <br/> <i>" + listtype + "</i> <br/>" + address + "<br/>" + phone + "<br/>" + monday + tuesday + wednesday + thursday + friday + saturday + sunday;

            var myOptions = {
                content: boxText,
                disableAutoPan: false,
                maxWidth: 0,
                pixelOffset: new google.maps.Size(-140, 0),
                zIndex: null,
                boxStyle: {
                    background: "url('tipbox.gif') no-repeat",
                    opacity: 0.75,
                    width: "280px"
                },
                closeBoxMargin: "10px 2px 2px 2px",
                closeBoxURL: "http://www.google.com/intl/en_us/mapfiles/close.gif",
                infoBoxClearance: new google.maps.Size(1, 1),
                isHidden: false,
                pane: "floatPane",
                enableEventPropagation: false
            };

            var infoBox = new InfoBox(myOptions);

            google.maps.event.addListener(marker, 'click', function () {
                    infoBox.open(map, marker);
                }
            });
        }

        var xml = data.responseXML,
            markers = xml.documentElement.getElementsByTagName("marker"),
            numMarkers = markers.length;

        for (var i = 0; i < numMarkers; i++) {
            createMarker(markers[i]);
        }
    });
}

function downloadUrl(url, callback) {
  var request = window.ActiveXObject ?
      new ActiveXObject('Microsoft.XMLHTTP') :
      new XMLHttpRequest;

  request.onreadystatechange = function() {
    if (request.readyState == 4) {
      request.onreadystatechange = doNothing;
      callback(request, request.status);
    }
  };

  request.open('GET', url, true);
  request.send(null);
}

function doNothing() {}

</script> 
```

```
<div id="map_canvas" style="width: 500px; height: 300px"></div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T02:39:56.007

查看 javascript 控制台并修复您在那里发现的错误。只需注释掉 dowloadUrl 调用即可让您恢复地图。

您没有提供 xml 示例，但第二步（在修复 javascript 错误之后）是在浏览器中打开 xml 提要并查看它是否有效（或者您可以通过 xml 验证器运行它）

[这篇文章](https://developers.google.com/maps/articles/phpsqlajax_v3)（看起来你可能已经开始阅读了）还提供了一些调试建议。

[工作版](http://www.geocodezip.com/v3_soq_infoboxA.html)

# matlab - 找到两组矩阵之间最近的点对

> ID：12083467
> 
> 赞同：3
> 
> 时间：2012-08-23T01:13:33.630
> 
> 标签：matlab, nearest-neighbor

假设我有两组矩阵（**A**和**B**），每个矩阵内包含几个点坐标，我想找出**B**中最接近**A 的**点并输出一个单元格数组**C**列出最近的点对坐标和一个单元格数组**D**注册未配对的点，我该怎么做？

更具体地说，这就是我想要的

两组矩阵包含点 xy 坐标；

```
A=[ 1 2; 3 4]; B=[1 3; 5 6; 2 1]; 
```

想得到`C{1,1}=[1 2; 1 3]; C{2,1}= [3 4; 5 6]; D{1,1}=[2 1];`

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T07:11:45.827

这个问题并没有一个确切的解决方案，例如（一维，但可扩展为 ND）的情况：

```
A= [1; 3];
B= [2]; 
```

然后要么 要么`A(1)`可以`A(2)`是剩余点。你的算法吐出哪一个，将取决于它是如何工作的，即你首先采取哪个点来找到最近的点。

这种算法包括imo

1.  `A(i)`查找和的每个组合之间的距离`B(j)`。如果您有统计工具箱，[pdist2](http://www.mathworks.nl/help/toolbox/stats/pdist2.html)会为您执行此操作：

    ```
    A=[ 1 2; 3 4];
    B=[1 3; 5 6; 2 1];
    dist = pdist2(A,B); 
    ```

2.  循环遍历最小的`A`or `B`（我将采用 A，因为它在您的示例中是最小的）并`A`在剩余的集合中找到最近点中的每个点`B`：

    ```
    N = size(A,1);
    matchAtoB=NaN(N,1);
    for ii=1:N
        dist(:,matchAtoB(1:ii-1))=Inf; % make sure that already picked points of B are not eligible to be new closest point
        [~,matchAtoB(ii)]=min(dist(ii,:));
    end
    matchBtoA = NaN(size(B,1),1);
    matchBtoA(matchAtoB)=1:N;
    remaining_indices = find(isnan(matchBtoA)); 
    ```

3.  将结果组合到您想要的输出矩阵`C`和`D`：

    ```
    C=arrayfun(@(ii) [A(ii,:) ; B(matchAtoB(ii),:)],1:N,'uni',false);
    D=mat2cell(B(remaining_indices,:),ones(numel(remaining_indices),1),size(B,2)); 
    ```

请注意，此代码也适用于 1D 点或更高 (ND) 点，将`pdist2`所有内容展平为标量距离。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T07:34:22.127

这是我对这个问题的看法：

```
A=[1 2
   3 4]; 

B=[1 3
   5 6
   2 1];

dists = pdist2(A,B);

[dists, I] = sort(dists,2);

c = NaN(size(A,1),1);
for ii = 1:size(A,1)    
    newC = find(~any(bsxfun(@eq, I(ii,:), c), 1));
    c(ii) = I(ii,newC(1));
end

C = cellfun(@(x)reshape(x,2,2).',...
        mat2cell([A B(c,:)], ones(size(A,1),1), 4), 'uni', false);
D = {B(setdiff(1:size(B,1),c), :)} 
```

该解决方案假设

*   你所有的向量都是二维的
*   堆叠成行`A`和`B`
*   并且`A`始终是源（即，所有内容都与 进行比较`A`）

如果这些假设不（总是）成立，您将不得不采取更通用的方法，例如@GuntherStruyf 建议的方法。

# ios - 在 iOS 上，如何避免在具有固定或可变行数的 UITableView 中重新获取图像？

> ID：12083470
> 
> 赞同：0
> 
> 时间：2012-08-23T01:13:54.457
> 
> 标签：ios, uitableview

如果我们从 Internet 上获取一张小图像（例如 60 x 60），则在方法内部：

```
-(UITableViewCell *) tableView:(UITableView *) tableView 
                       cellForRowAtIndexPath:(NSIndexPath *)indexPath {  ...  } 
```

如果有固定的 25 行，而长度可以是可变的（例如，100，或者可以是 1000），该怎么办？如果我们使用`dequeueReusableCellWithIdentifier`“重用”一个单元格，我们可能需要删除该单元格中的子视图（其中一个是 60 x 60 图像），因此当用户上下滚动列表时，单元格会被重用，并且图像是从网上重新获取的，并且在滚动时可以在这里和那里暂停。

但是，如果我删除`dequeueReusableCellWithIdentifier`并始终分配一个新单元格：

```
 cell = [[UITableViewCell alloc] 
               initWithStyle:UITableViewCellStyleDefault
               reuseIdentifier:TableViewCellIdentifier]; 
```

然后当我再次向下和向上滚动时，`NSLog`显示图像仍在获取中。如果我们不想单独使用数组来存储获取的图像，有没有办法防止这种情况发生？

（现在，最初的行为是获取大约 7 张图像，如果表格向下滚动 3 行，则获取 3 张图像，如果表格向上滚动 3 行，则再次获取 3 张图像）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T01:22:31.503

你应该有一个图像缓存机制。如果图像不存在，请下载该图像。设置一个过期时间，您需要重新获取它。然后显示它。

下次你加载它。您显示已下载的图像并检查到期时间。如果它过期，你再次下载它，并更新显示。

很简单。

唯一复杂的是，下载后应该覆盖图像。我用 GUID 测试这个。当请求图像下载时，我将 UUID 放在 tableview 或图像对象本身中。我还将该 UUID 与下载任务一起发送。当下载返回时，您可以根据显示项目的 UUID 测试下载的 UUID。如果它们相等。然后你更新显示。如果它们已更改，则请求另一个下载并覆盖您的下载。因此，该过程更改了图像，并且具有该 UUID 的下载将很快完成，并将使用其下载的内容更改图像。

希望有帮助:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T01:57:28.303

至于暂停滚动视图，您应该在另一个线程上加载您的图像（如果它们没有被缓存或需要根据 DarkAngel 的回答进行更新）。我会使用 NSOperationQueue。 这是关于设置 NSOperationQueue[的一个很好的教程。](http://www.cimgf.com/2008/02/16/cocoa-tutorial-nsoperation-and-nsoperationqueue/)一个好主意是在您的应用程序委托中使用共享队列，您可以在需要时添加任务。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T04:22:44.980

只需使用 SDWebImage 或 AFNetworking。它们都提供了一个 UIImageView 类别，为您提供缓存机制。

这意味着如果图像下载器库（SDWebImage 或 AFNetworking）在其缓存中找到了图像，那么它只会从磁盘中获取该图像，而不是从网络重新下载图像。

您看到延迟很可能是因为在您的 cellForRowAtIndexPath: 表视图委托方法中，您可能正在使用主线程上的 NSURLConnection 下载缩略图。

SDWebImage 或 AFNetworking 基本上将为您完成所有艰苦的工作并使您的表格响应。你所要做的就是：

```
[myThumbnailImageView imageWithURL:imageURL placeholder:[UIImage imageNamed:@"myPlaceholderImage.png"]]; 
```

一旦你把那条线放进去，就是这样。您的真实图像将在下载后出现，在此之前您可以继续平滑滚动表格视图。当图像尚未下载时，每个单元格将显示您指定的占位符图像（参见上面的代码行）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-23T01:42:40.117

您可以使用 Volure 提到的图像缓存。我还建议您为这些图像实施某种形式的延迟加载。为此有许多不同的实现。[本项目](https://github.com/rs/SDWebImage)是 UIImageView 的子类，支持异步加载。

另外，看看[这个问题](https://stackoverflow.com/questions/1130089/lazy-load-images-in-uitableview)，答案可能会有所帮助。

希望这可以帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-10-23T07:21:59.310

[为了更方便下载图像，请使用 EGOImageLoader/EGOImageView 通过此链接https://github.com/enormego/EGOImageLoading](https://github.com/enormego/EGOImageLoading)下载此类。

从此 EGOCache 用于存储您的图像。第一次下载时，在滚动 UITableview 时从 EGOCache 存储中获取图像。在该类中，它使用密钥存储下载的图像。关键是您的 imageUrl 的散列值。使用相同的键从缓存中检索图像。泰米拉桑

# c++ - 路径规划 - 多个目的地

> ID：12083472
> 
> 赞同：1
> 
> 时间：2012-08-23T01:14:00.457
> 
> 标签：c++, algorithm, path-finding, motion-planning

问题是这样的：

我有一个图 G=(V,E)。顶点子组 U<=V 和起始顶点 s。边缘的权重函数 w。

我需要从 's' 中找到穿过 U 中所有顶点的最短路径。

*   计算可以近似，计算时间和路径长度之间应该有一些平衡。我需要一种快速算法/启发式算法，它将为最短路径产生一个精细的近似值。
*   这个算法不应该太复杂而难以实现（在 C++ 中）。例如，我已经想到了一种将其变成旅行推销员问题的方法，并使用 TSP 求解器库或使用某种启发式但找不到任何东西的方法，并且我自己也会实现启发式难的。

感谢先进！=]

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T03:37:21.440

这是旅行商问题的一个变体，称为集合 TSP 问题或广义 TSP。这是维基百科[链接](http://en.wikipedia.org/wiki/Set_TSP_problem)。

上述文章的参考链接到了一种将广义 TSP 问题转换为 TSP 问题的[方法](http://www.ee.ucla.edu/~abehzad/ICSE02.pdf)，而无需将图中的节点数加倍。

保持记录的 TSP 求解器是免费提供的，被称为 Concorde，可以从[这里](http://www.tsp.gatech.edu/concorde.html)下载，它可以作为命令行工具运行（可能作为库，不确定）。

[我在尝试为RevolvoMan4k](http://www.bullsquared.com/gameRevolvoMan.html)游戏创建求解器时遇到了 GTSP，方法是通过最少的按钮按下次数获得每个级别的所有钱。（这是一个有趣的游戏，但是50级之后，关卡是随机的，所以有些可能是不可能的，需要用'N'跳过）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T03:22:58.513

假设您有 3 个顶点：S、A 和 B。现在，假设我们需要找到从 S 通过 A 和 B 的最短路径。最简单的方法是找到离 S 更近的点：A 或B. 如果你的图实际上有一些空间数据，你可以使用顶点的坐标来近似，否则，你必须得到从 S 到每个目的地的最短路径。选择最近的目的地，在这种情况下，假设是 A，然后前往那里。现在你唯一可以去的地方是 B。计算从 A 到 B 的最短路径，然后去那里。

现在，在有两个以上目的地的情况下，您可以递归地执行此操作。我不懂 C++，但这里有一些伪代码可以帮助你入门

```
function pathThrough(startNode,destinationNodes[])
    closestNode = getClosestNode(startNode,destinationNodes)
    newDestinations = removeFromArray(destinationNodes,closestNode)
    return joinPaths(getShortestPath(startNode,closestNode),pathThrough(closestNode,newDestinations.)) 
```

对于最接近的节点和 getShortestPath 函数，您可以使用任何适合您的图形的搜索算法、A*、dijkstra 算法，...

# geometry - 求多边形的内角

> ID：12083480
> 
> 赞同：6
> 
> 时间：2012-08-23T01:15:44.247
> 
> 标签：geometry, computational-geometry

我有一些**线**，它们的交点描述了一个多边形，如下所示：

![主多边形](../Images/8be1644a32e5d5faa0555ffc24c03b83.png)

我知道线条的顺序和它们的方程式。

为了找到内角，我找到了每条线的方向。但是我很困惑，因为减去两条线的方向会给出两个不同的角度，即使我是按照多边形边的顺序来做的。

例如，在下图中，如果我只是减去线的方向，我会得到以下任何角度：

![缺陷1](../Images/a3b3ce286c15727c5406951a5eaee82b.png)

让我更困惑的是，当多边形不是凸面时，我的角度会大于 180，并且使用我的方法我根本没有得到正确的角度：

![缺陷 2](../Images/98acf3e4ab295724eb915f2d26fca32b.png)

我发现这种解决问题的方法是错误的。

**那么，仅使用线条**找到内角的最佳方法是什么？我知道对于凸多边形，我可能会找到向量，然后找到它们之间的角度，但即使在我的示例中，对于 P6，向量方法也失败了。

无论如何，我更喜欢一种不包括解决该凹面问题的条件案例的方法。

谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-23T11:40:39.660

使用有序线，可以按顺时针顺序找到交点（多边形顶点）。然后你可以计算内角：

```
Angle[i] =  Pi + ArcTan2(V[i] x V[i+1], V[i] * V[i+1]) 
```

（每个顶点的传入和传出向量的叉积和点积）

或者

```
Angle[i] = Pi + ArcTan2( dx_in*dy_out-dx_out*dy_in, dx_in*dx_out+dy_in*dy_out2 ) 
```

注意：将加号后面的加号`Pi`改为减号为逆时针方向。

编辑：

请注意，叉积和点积是标量，而不是向量。

您的数据示例：

```
dx1 = 5; dy1 = -15; dx2 = -15; dy2 = 5

Angle = Pi + ArcTan2(5*5-15*15, -5*15-5*15) = Pi - 2.11 radians ~ 59 degrees 
```

向量示例：

```
(0,-1) (1,0) (L-curve)

Angle = Pi + ArcTan2(1, 0) =  270 degrees 
```

# php - 我应该如何使用 PHP 散列我的密码？

> ID：12083486
> 
> 赞同：1
> 
> 时间：2012-08-23T01:16:56.227
> 
> 标签：php, algorithm, encryption, hash

> **可能重复：**
> [PHP 密码的安全哈希和盐](https://stackoverflow.com/questions/401656/secure-hash-and-salt-for-php-passwords)

`haval160,4`我尝试创建一个函数，使用散列算法用盐对我的密码进行散列。但我不明白它的安全性。我提供以下代码：

请让我知道如何改进安全系统。

```
<?php    
defined("SALT")? NULL : define("SALT", "abcdefthijklmnopqursuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ*/\|[]{}()~!@#$%^&*_+:.,;1234567890");

function createSalt(){
        static $random_string;
        for($i=0;$i<64;$i++){
            $random_string .= substr(str_shuffle(SALT), 0,25);
        }
    return $random_string;
}

global $salts;// I want to store the salt value into my database with password
$salt = createSalt();
$salts = $salt;//I keep this cause I will check the matching password without database

function createPassword($input_data,$salt){
    static $hash;
    $cryc = crypt($input_data,$salt);

      $hash = hash("haval160,4",$cryc);

    return $hash;
}

$password = createPassword("123456",$salt);
$stored_password = $password ; // I stored value into a variable cause I want to test without database
//echo $password.'<hr>';

echo "Your Password: ".$password;
echo "<br/> Your SALT VALUE: ".$salt.'<hr>';

function checkPassword($uid,$password,$salts,$stored_password){//this is just a test function... actual function don't require $salts and $stored_password
    $db_uid = 1 ;
    if($uid === $db_uid){

        $db_salt = $salts;

        $db_password = createPassword($password,$db_salt);
        if($db_password == $stored_password){
            echo "Password Match";
        }else{
            echo"password don't match";
        }

    }

}

checkPassword(1,"123456",$salts,$stored_password);

?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T01:32:08.800

您不应该设计自己的加密算法。

使用这个 bcrypt 实现：[http ://www.openwall.com/phpass/](http://www.openwall.com/phpass/)

```
require '../PasswordHash.php';
$hasher = new PasswordHash($hash_cost_log2=2, $hash_portable=false); // increase the first parameter if you need it to be slower (more secure)

// Create hash
$hash = $hasher->HashPassword($pass);

// Check password
$hasher->CheckPassword($pass, $hash); 
```

这是尽可能安全的，不要费心寻找“更安全”的东西，也不要尝试添加盐或其他任何东西。

# eclipse - tc 服务器无法在 SpringsourceToolSuite 中启动

> ID：12083489
> 
> 赞同：0
> 
> 时间：2012-08-23T01:17:32.927
> 
> 标签：eclipse, spring, tomcat

就在今天，我的 STS 实例无法启动 tcserver。

我们正在使用 tc server 2.7.1

在 Eclipse 中启动服务器会给出：

```
23/08/2012 11:07:29 AM com.springsource.tcserver.security.PropertyDecoder <init>
INFO: tc Runtime property decoder using memory-based key
23/08/2012 11:07:29 AM com.springsource.tcserver.security.PropertyDecoder <init>
INFO: tcServer Runtime property decoder has been initialized in 363 ms
23/08/2012 11:07:30 AM org.apache.coyote.AbstractProtocol init
INFO: Initializing ProtocolHandler ["http-bio-8080"]
23/08/2012 11:07:30 AM com.springsource.tcserver.serviceability.rmi.JmxSocketListener init
INFO: Started up JMX registry on 127.0.0.1:6969 in 113 ms
23/08/2012 11:07:30 AM org.apache.catalina.startup.Catalina load
INFO: Initialization processed in 1197 ms 
```

然后没有更多的日志记录。

Eclipse 在 120 秒后超时

如果我将超时时间增加到 520 秒，那没有什么区别。

今天和昨天之间唯一改变的是 Subclipse 插件已更新。

请帮忙？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T20:52:33.483

结果发现其中一个 JNDI 数据源（用于 INGRESS 数据库）没有响应。

如果 tc server 记录一个错误说明连接超时，那就太好了。

注释掉条目允许 tc 服务器正确启动

# java - Socket 编程中 BufferedInputStream.available() 是否可靠？

> ID：12083493
> 
> 赞同：2
> 
> 时间：2012-08-23T01:18:02.833
> 
> 标签：java, sockets, inputstream, bufferedinputstream

`available()`在 Java 中用于套接字编程是否可靠？

我只关心它告诉我何时有可读取的字节，以便当我调用读取方法时它们不会阻塞。

`BufferedInputStream.available()`依靠`InputStream.available()`.

InputStream.available() 的文档是这样说的：

> 请注意，虽然 InputStream 的某些实现会返回流中的字节总数，但许多不会。使用此方法的返回值来分配旨在保存此流中所有数据的缓冲区是不正确的。 [http://docs.oracle.com/javase/6/docs/api/java/io/InputStream.html#available()](http://docs.oracle.com/javase/6/docs/api/java/io/InputStream.html#available())

我不在乎它是否给出了正确的字节数，只是当有字节可供读取时它不会给我 0 。我想知道 BufferedInputStream.available() 是否总是在 Windows 和 Linux 上用于此目的。

另外，我不确定文档中的“实现”是什么意思。那指的是什么？InputStream 的子类？不同操作系统上的Java？到不同的JVM？

有没有人在 Windows 或 Linux 或其他系统上使用 available() 并且它不起作用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T01:23:38.937

您在问题中链接到的同一个文档说：

> 单次读取或跳过这么多字节不会阻塞，但可能会读取或跳过更少的字节。

所以我会说它是“安全的”，因为当 I/O 不返回 0 时，它不会阻塞。另一方面，不能保证它会返回非零，事实上，要读取的字节。

请注意，这`InputStream`是一个抽象类，因此`InputStream`您拥有的任何对象都必须是子类。这就是文档所说的“实施”的意思。任何具体的子类都将实现所有抽象方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T03:20:31.260

[正如我在你的另一个线程](https://stackoverflow.com/questions/12082709/when-is-inputstream-available-useful)中已经告诉你的那样，当包裹在 SSLSocket 上时它绝对*不*可靠。它总是返回零。

# android - 如何使用 Cyber Linkforjava API 在 UPnP 媒体服务器中定义媒体文件的 URL？

> ID：12083494
> 
> 赞同：0
> 
> 时间：2012-08-23T01:18:10.353
> 
> 标签：android, upnp

如何使用 Cyber​​Linkforjava API 在 UPnP 媒体服务器中定义媒体文件的 URL？我使用 Cyber​​Linkforjava API 创建 DMS，但我知道如何定义媒体文件的 URL。我阅读了 clinkjavaproguide.pdf 文件，但没有任何关于它的信息。有没有关于它的材料？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T13:43:13.923

URL 完全取决于您，即您对 DMS 的实施。您作为媒体文件的 URL 呈现的内容（当 DMR 浏览您的 DMS 时），您必须能够根据 DMR 的 GET 请求提供。

Cyber​​link 是一个通用的 UPnP 框架，可用于实现任何 UPnP DCP（设备控制协议）。Cyber​​link 本身不提供任何特定的 DCP 实施。DMS 是`MediaServer`DCP，您至少需要`ContentDirectory`为 URL 操作提供服务。快速谷歌搜索得出[x360mediaserver](https://code.google.com/p/x360mediaserver/source/browse/trunk/x360MediaServer/x360mediaserver/upnpmediaserver/upnp/contentdirectory/ContentDirectory.java)是基于网络车库的，所以去获得一些想法 :) 阅读[UPnP 规范](http://upnp.org/resources/upnpresources.zip)也`MediaServer.ContentDirectory`不会受到伤害。在“操作理论”一章中，您有一个关于 URL 外观的简单示例。

# sql - 如何使用 oci8 和 ruby 执行标量查询

> ID：12083495
> 
> 赞同：0
> 
> 时间：2012-08-23T01:18:20.847
> 
> 标签：sql, ruby, oci8

我想使用 oci8 和 ruby​​ 从 oracle 中的序列中选择下一个 id。这样做的简单方法是什么？错误代码示例：

```
id = @conn.exec( 'Select NEXT_ID.NEXTVAL from dual' ) 
```

.exec 返回一个游标。有没有一种简单的方法可以从 exec 或类似方法中获取我需要的一个值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T03:30:12.970

```
@conn.exec('Select NEXT_ID.NEXTVAL from dual') {|row| id = row[0]} 
```

你也可以做

```
id = @conn.exec('Select NEXT_ID.NEXTVAL from dual').fetch[0] 
```

# java - Java Date.parse IllegalArgument

> ID：12083496
> 
> 赞同：0
> 
> 时间：2012-08-23T01:18:32.937
> 
> 标签：java, date

我正在为调用 Date.parse() 的方法编写测试。代码看起来像这样

```
 public void someMethod(String s){

         Date date = new Date();

         date.setTime(Date.parse(s));

         //other methods
    } 
```

在我的测试中，我做了这样的事情

```
 public void test(){
          ...

          Date date = new Date();
          someMethod(date.toString());

          //assert statements
    } 
```

它在我的机器上运行良好，我在我的 eclipse 和 IntelliJ IDEA 中尝试过。但是，当我将它推送到我们的服务器进行构建时，测试失败了。它抛出 IllegalArgumentException。我的队友也收到了同样的例外。我们使用相同的 sdk：jdk1.7.0 和 IDE eclipse 和 IntelliJ。唯一的区别是我的机器上安装了 jre7。我还尝试了一个简单的测试：

```
 public void test(){
          Date d = new Date();
          String s = d.toString();

          Date e = new Date();
          e.setTime(Date.parse(s));

          sysout(e);
    } 
```

在我的机器上运行良好，但在他的机器上收到 IllegalArgumentException。我无法更改被测方法，因此无法执行从字符串到日期的其他转换。谢谢

编辑 - StackTrace

```
 java.lang.IllegalArgumentException
        at java.util.Date.parse(Date.java:598)
        at package.Class.Method(Class.java:135)
        at package.TestClass.TestMethod(TestMethod.java:192)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.junit.internal.runners.TestMethod.invoke(TestMethod.java:66)
        at org.powermock.modules.junit4.internal.impl.PowerMockJUnit44RunnerDelegateImpl$PowerMockJUnit44MethodRunner.runTestMethod(PowerMockJUnit44RunnerDelegateImpl.java:312)
        at org.junit.internal.runners.MethodRoadie$2.run(MethodRoadie.java:86)
        at org.junit.internal.runners.MethodRoadie.runBeforesThenTestThenAfters(MethodRoadie.java:94)
        at org.powermock.modules.junit4.internal.impl.PowerMockJUnit44RunnerDelegateImpl$PowerMockJUnit44MethodRunner.executeTest(PowerMockJUnit44RunnerDelegateImpl.java:296)
        at org.powermock.modules.junit4.internal.impl.PowerMockJUnit47RunnerDelegateImpl$PowerMockJUnit47MethodRunner.executeTestInSuper(PowerMockJUnit47RunnerDelegateImpl.java:112)
        at org.powermock.modules.junit4.internal.impl.PowerMockJUnit47RunnerDelegateImpl$PowerMockJUnit47MethodRunner.executeTest(PowerMockJUnit47RunnerDelegateImpl.java:73)
        at org.powermock.modules.junit4.internal.impl.PowerMockJUnit44RunnerDelegateImpl$PowerMockJUnit44MethodRunner.runBeforesThenTestThenAfters(PowerMockJUnit44RunnerDelegateImpl.java:284)
        at org.junit.internal.runners.MethodRoadie.runTest(MethodRoadie.java:84)
        at org.junit.internal.runners.MethodRoadie.run(MethodRoadie.java:49)
        at org.powermock.modules.junit4.internal.impl.PowerMockJUnit44RunnerDelegateImpl.invokeTestMethod(PowerMockJUnit44RunnerDelegateImpl.java:209)
        at org.powermock.modules.junit4.internal.impl.PowerMockJUnit44RunnerDelegateImpl.runMethods(PowerMockJUnit44RunnerDelegateImpl.java:148)
        at org.powermock.modules.junit4.internal.impl.PowerMockJUnit44RunnerDelegateImpl$1.run(PowerMockJUnit44RunnerDelegateImpl.java:122)
        at org.junit.internal.runners.ClassRoadie.runUnprotected(ClassRoadie.java:34)
        at org.junit.internal.runners.ClassRoadie.runProtected(ClassRoadie.java:44)
        at org.powermock.modules.junit4.internal.impl.PowerMockJUnit44RunnerDelegateImpl.run(PowerMockJUnit44RunnerDelegateImpl.java:120)
        at org.powermock.modules.junit4.common.internal.impl.JUnit4TestSuiteChunkerImpl.run(JUnit4TestSuiteChunkerImpl.java:102)
        at org.powermock.modules.junit4.common.internal.impl.AbstractCommonPowerMockRunner.run(AbstractCommonPowerMockRunner.java:53)
        at org.powermock.modules.junit4.PowerMockRunner.run(PowerMockRunner.java:42)
        at org.apache.maven.surefire.junit4.JUnit4TestSet.execute(JUnit4TestSet.java:53)
        at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:123)
        at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:104)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:164)
        at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:110)
        at org.apache.maven.surefire.booter.SurefireStarter.invokeProvider(SurefireStarter.java:175)
        at org.apache.maven.surefire.booter.SurefireStarter.runSuitesInProcessWhenForked(SurefireStarter.java:107)
        at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:68) 
```

抱歉，我无法正确编辑它，我的机器中禁用了 javascript

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T01:24:28.773

`Date.toString()`并且`Date.parse()`依赖于语言环境。因此，`toString()`' 的输出可能不会被`parse()`. 最好传递日期的时间戳，因为这只是一个数字，因此是唯一的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T05:05:16.997

Although this may not resolve your problem, i think having a look at the [DateFormatter](http://docs.oracle.com/javase/7/docs/api/java/text/DateFormat.html) class would be very helpful for your case.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T02:28:31.130

从JDK 1.1 开始， [Javadocs已被弃用](http://docs.oracle.com/javase/7/docs/api/java/util/Date.html#Date%28java.lang.String%29) `Date.parse()`

因此，您最好更改以下代码：

```
Date d = new Date();
String s = d.toString();

Date e = new Date();
e.setTime(Date.parse(s)); 
```

像这样：

```
Date d = new Date();

Date e = new Date(); 
e.setTime(d.getTime()); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T05:57:25.640

Date.parse() 已被弃用。改变方法如下，再试一次。

```
public void someMethod(String s){
     Date date = new Date();
     try {
      date=DateFormat.getDateInstance().parse(s);
     } catch (ParseException e) {

     e.printStackTrace();
     }

     //other methods
} 
```

# javascript - 像谷歌一样改变滚动网站

> ID：12083501
> 
> 赞同：-1
> 
> 时间：2012-08-23T01:18:56.810
> 
> 标签：javascript, css

> **可能重复：**
> [像谷歌这样的滚动条正在使用](https://stackoverflow.com/questions/7971069/scroll-bar-like-google-is-using)

网站默认滚动看起来很简单，最近我访问博客，博客中的滚动不像默认网站那样用户滚动。他们将其更改为图像（也许），所以我想问每个人。“我可以将我的网站的 Scroll 更改为像 Google 一样吗？”

也许我的英语不好，但因为我是印尼人：D

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T01:27:45.323

这可以通过[CSS 和 Webkit](http://www.webkit.org/blog/363/styling-scrollbars/)或[jScrollPane](http://jscrollpane.kelvinluck.com/)来完成。另请参阅[此](https://stackoverflow.com/questions/7742143/how-are-scrollbars-in-new-google-docs-ui-styled-esp-the-arrow-buttons)SO 问题。请注意，如果您使用 Webkit，它只会在 Chrome 和 Safari 中呈现。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T01:32:35.120

我相信他们只更改了某些浏览器（如 Chrome）中的滚动条。操作方法如下：[http ://css-tricks.com/custom-scrollbars-in-webkit/](http://css-tricks.com/custom-scrollbars-in-webkit/)

# php - 用 PHP 解码 JSON

> ID：12083502
> 
> 赞同：1
> 
> 时间：2012-08-23T01:19:03.173
> 
> 标签：php, jquery, ajax, json, post

有人能说出为什么这个带有 JqUERY 的简单 JSON 对我不起作用吗？

我有这个JS代码，

```
var jsonParam = <? $json = $_SESSION['searchSess']; echo json_encode($json);?>;
jsonParam = JSON.stringify(jsonParam);
$(document).ready(function(){
      $.post("searching.php?rdr=search", {data: jsonParam,}, function (data){
        alert(data)
    })
}); 
```

这是PHP代码，

```
$data = json_decode($_POST['jsonParam'], true);
var_dump($data); 
```

响应为空或什么都没有，

可以请人帮忙这里有什么问题吗？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T01:21:05.610

你想要`$_POST['data']`，没有`$_POST['jsonParam']`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-23T01:20:53.520

`jsonParam`是 JavaScript 变量，但`$_POST['data']`自从您`{data: jsonParam}`传入`$.post`.

```
// Instead:
$data = json_decode($_POST['data'], TRUE);
var_dump($data); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-23T01:23:11.567

`{jsonParam: jsonParam,}`代替`{data: jsonParam,}`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-23T01:21:57.433

`$data = json_decode($_POST['jsonParam'], true);`应该`$data = json_decode($_POST['data'], true);`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-23T01:37:26.387

尝试以下操作：

JS：

```
var jsonParam = <? 
    $json = $_SESSION['searchSess']; 
    $json['longitude'] = (string) $json['longitude'];
    $json['latitude'] = (string) $json['latitude'];

    echo json_encode($json);
?>

$(document).ready(function(){
      $.post("searching.php?rdr=search", {data: jsonParam }, function (data){
        alert(data)
    })
}); 
```

PHP：

```
$data = json_decode($_POST['data'], true);
var_dump($data); 
```

我怀疑您的经度和纬度字段没有被正确解析为浮点数。

# c++ - 有没有办法让每个类的对象都有一个提升线程？

> ID：12083503
> 
> 赞同：0
> 
> 时间：2012-08-23T01:19:20.647
> 
> 标签：c++, multithreading, oop, boost-thread

在我的代码中，我想创建一个类的一堆对象，然后给每个对象一个单独的线程，这样对象就可以同时执行操作。

```
for (i = 0; i < ROBOTCOUNT; i++)
{
    Robot* r = new Robot;
    boost::thread t(r);
    robotList.push_back(r);
} 
```

我想做类似上面代码的事情。如果是这样，代码不会编译，但这是我想要的一般想法。有谁知道如何做我想做的事？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T01:23:48.367

以下代码应在 C++11`Worker::foo()`中工作并并行执行多个 s：

```
#include <thread>
#include <memory>
#include <vector>

struct Worker
{
    void foo();
};

int main()
{
    std::vector<std::unique_ptr<Worker>> workers;
    std::vector<std::thread>             threads;

    workers.reserve(N);
    threads.reserve(N);

    for (unsigned int i = 0; i != N; ++i)
    {
        workers.emplace_back(new Worker);
        threads.emplace_back(&Worker::foo, workers.back().get());
    }

    // ... later ...

    for (auto & t : threads) { t.join(); }
} 
```

* * *

如果您相信您的元素引用保持有效，您甚至可以不使用唯一指针：

```
std::deque<Worker> workers;

// ...

for (unsigned int i = 0; i != N; ++i)
{
    workers.emplace_back(); // pray this doesn't invalidate
    threads.emplace_back(&Worker::foo, std::ref(workers.back()));
} 
```

# wpf - 在服务上实施 INotifyCollectionChanged 或 INotifyPropertyChanged 可以吗？

> ID：12083504
> 
> 赞同：1
> 
> 时间：2012-08-23T01:19:24.560
> 
> 标签：wpf, data-binding, mvvm

假设我有一个服务，它的接口是这样的：

```
public interface IProxyRotator
{
    ProxyRotationMode RotationMode { get; set; }

    void Add(Proxy proxy);
    void AddRange(IEnumerable<Proxy> proxies);
    bool Remove(Proxy proxy);
    void Clear();
    Proxy Peek();
} 
```

问题在于我应该如何将服务中包含的代理绑定到视图。

我正在做的方式是在服务接口上创建一个 ProxyList 数组并通知对该属性的更改。像这样：

```
public interface IProxyRotator : INotifyPropertyChanged
{
    // ... omited for brevity
    Proxy[] ProxyList { get; }
} 
```

在 ViewModel 上，我有另一个用于代理的数组属性。当 ViewModel 被实例化时，它会订阅 IProxyRotator PropertyChanged 事件并“转发”该事件，以便 View 可以实际看到代理数组已更改。像这样：

```
public class ViewModel : INotifyPropertyChanged
{
    public ViewModel(IProxyRotator proxyRotator)
    {
        this.proxyRotator = proxyRotator;
        this.proxyRotator.PropertyChanged += (sender, e) =>
        {
            if (e.PropertyName == "ProxyList")
            {
                this.RaisePropertyChanged("ProxyList");
            }
        }
    }

    public Proxy[] ProxyList
    {
        get { return this.proxyRotator.ProxyList; }
    }

    private IProxyRotator proxyRotator;
} 
```

问题是必须拦截服务 PropertyChanged 事件并转发它的开销让我感到困惑，感觉.. 错了。当我不得不依赖实现 INotifyPropertyChanged 的​​众多不同对象而不是正确实现 INotifyCollectionChanged 时，这也是一个主要缺点。我是否应该考虑在 IProxyRotator 服务上实现 INotifyCollectionChanged（我知道这也意味着实现 IEnumerable）并简单地引用 ViewModel 上的服务，将视图直接绑定到服务实例？

非常感谢您对此的评论！谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T02:10:48.483

INotifyCollectionChanged 将通知您（或视图）有关添加/删除的信息，但不会通知您（或视图）属性的更改（在更新的情况下）。IPropertyChanged 可以通知视图某个属性（对于实例 ProxyList）已更改（但不能通知此集合中项目的属性更改）。

此外，我认为您的服务不需要 INotifyCollectionChanged 接口。只需对 ProxyList 使用适当的实现，例如：

```
public interface IProxyRotator : INotifyPropertyChanged
{
    // ... omited for brevity    
    ObservableCollection<Proxy> ProxyList { get; }
} 
```

# jquery - jQuery 窗口宽度 else if 语句

> ID：12083508
> 
> 赞同：4
> 
> 时间：2012-08-23T01:19:34.173
> 
> 标签：jquery, if-statement, window, width

我想知道为什么我的最后一个 else if 语句永远不会被执行。我正在尝试这样做：

```
$(document).ready(function() {
    function checkWidth() {
        var windowSize = $(window).width();

        if (windowSize <= 479) {
            console.log("screen width is less than 480");
        }
        else if (windowSize = 480 && windowSize <= 719) {
            console.log("screen width is less than 720 but greater than or equal to 480");
        }
        else if (windowSize = 720 && windowSize <= 959) {
            console.log("screen width is less than 960 but greater than or equal to 720");
        }
        else if (windowSize >= 960) {
            console.log("screen width is greater than or equal to 960");
        }
    }

    // Execute on load
    checkWidth();
    // Bind event listener
    $(window).resize(checkWidth);
});​ 
```

除了最后一个 else if 之外，所有内容都记录在控制台中。我究竟做错了什么？

谢谢，

**更新：**

对于仍然感兴趣的人，我强烈推荐 enquire.js 插件：

[http://wicky.nillia.ms/enquire.js/](http://wicky.nillia.ms/enquire.js/)

我发现在 JS 中识别媒体查询的最佳方法。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-08-23T01:23:54.267

您的代码中缺少一对**>=**，并且 windowSize 没有被比较，而是由于像`windowSize = 480`. 试试这个版本：

```
$(document).ready(function() {
    function checkWidth() {
        var windowSize = $(window).width();

        if (windowSize <= 479) {
            console.log("screen width is less than 480");
        }
        else if (windowSize <= 719) {
            console.log("screen width is less than 720 but greater than or equal to 480");
        }
        else if (windowSize <= 959) {
            console.log("screen width is less than 960 but greater than or equal to 720");
        }
        else if (windowSize >= 960) {
            console.log("screen width is greater than or equal to 960");
        }
    }

    // Execute on load
    checkWidth();
    // Bind event listener
    $(window).resize(checkWidth);
});​ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T01:24:02.940

您缺少一个大于号：

```
else if (windowSize = 720 
```

并且只使用等号？

试试这个：

```
$(document).ready(function() {
    function checkWidth() {
        var windowSize = $(window).width();

        if (windowSize < 480) {
            console.log("screen width is less than 480");
        }
        else if (windowSize < 720) {
            console.log("screen width is less than 720 but greater than or equal to 480");
        }
        else if (windowSize < 960) {
            console.log("screen width is less than 960 but greater than or equal to 720");
        }
        else {
            console.log("screen width is greater than or equal to 960");
        }
    }

    // Execute on load
    checkWidth();
    // Bind event listener
    $(window).resize(checkWidth);
});​ 
```

[**小提琴**](http://jsfiddle.net/4nuzM/1/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-23T01:24:42.300

这是因为你的 else if 语句。您正在检查一个等号，它正在分配值。

```
if ( windowSize = 480 && windowSize <= 719 ) 
```

当你应该做

```
if ( windowSize == 480 && windowSize <= 719 ) 
```

或 >=，如果这是预期的逻辑。

# c# - C#如何在silverlight中使用河豚？

> ID：12083509
> 
> 赞同：0
> 
> 时间：2012-08-23T01:19:41.853
> 
> 标签：c#, silverlight, blowfish

我在[http://www.broccoliproducts.com/softnotebook/desblowfish/BlowFishCrytography.cs找到了这个免费的源代码](http://www.broccoliproducts.com/softnotebook/desblowfish/BlowFishCrytography.cs)

当我在我的项目中导入它时，它给了我一些关于

当前上下文中不存在名称“_assertBufferMatch”

当前上下文中不存在名称“_assertBufferMatch”

当前上下文中不存在名称“Trace”

我没有修改所有内容，只是重建项目，然后发生错误。

这个错误之一是

```
 public static void Test()
        {

            // Declaration of local variables
            Random rnd = new Random(1);
            byte[] Key = null;
            byte[] bufferIn = null;
            byte[] bufferOut = null;
            byte[] bufferReturned = null;

            // Loop through the test vectors
            for (int iTest = 0; iTest < TestKeys.Length; iTest++)
            {

                // Load the key and plain-text
                Key = BitConverter.GetBytes(TestKeys[iTest]).Reverse().ToArray();
                bufferIn = BitConverter.GetBytes(TestPlainText[iTest]).Reverse().ToArray();

                // Encrypt with BlowFish
                BlowFishCrytography.BlowFish(bufferIn, ref bufferOut, Key, true);

                // Compare with expected result
                byte[] expectedBufferOut = BitConverter.GetBytes(TestCypherText[iTest]).Reverse().ToArray();
                _assertBufferMatch(expectedBufferOut,bufferOut);

            }

            // Loop through decrypt-encrypt tests
            for (int iTest = 0; iTest < 100*1000; iTest++)
            {

                // Dump progress
                if ((iTest % 100) == 0)
                    Trace.TraceInformation("Test {0}", iTest);

                // Load the key and plain-text
                Key = CreateBlowFishKey(rnd, MAX_KEY_BYTE_LENGTH);

                // Create a buffer of data
                int iLength = rnd.Next(1, 10*1024);
                _softCreateBuffer(ref bufferIn, iLength);
                rnd.NextBytes(bufferIn);

                // Encrypt with BlowFish
                BlowFishCrytography.BlowFishWithPadding(bufferIn, ref bufferOut, Key, true);

                // Decrypt with BlowFish
                BlowFishCrytography.BlowFishWithPadding(bufferOut, ref bufferReturned, Key, false);

                // Compare buffers
                _assertBufferMatch(bufferIn, bufferReturned);

            }

        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T01:31:30.673

该代码是模块的单元测试。似乎该测试包含在 Silverlight 中，但`_assertBufferMatch`它所需的方法不包含在 Silverlight 中。

我只会删除该方法和对它的任何调用。它只会在调试版本中运行，因此算法不需要实际工作。

# java - 不使用拆分解析电话号码

> ID：12083521
> 
> 赞同：1
> 
> 时间：2012-08-23T01:21:40.723
> 
> 标签：java

我正在尝试为学校编写一个 JAVA 程序。它要求我们使用提供的类，避免使用拆分，并解析`:`不同部分之间分隔的电话号码。

```
 package aaronjonesprog1;

public class AaronJonesProg1 {
    /**
     * @param args the command line arguments
     */
    public static void main(String[] args) 
    {
        AJDissector phone = new AJDissector("1:919:882:5000");
        System.out.println(phone.getPhoneNumber());
        System.out.println(phone.getPhoneNumber(4));
        System.out.println(phone.getPhoneNumber(1));
        System.out.println(phone.getPhoneNumber(3));
        System.out.println(phone.getPhoneNumber(2));
    }
} 
```

我的司机：

```
 package aaronjonesprog1;

/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */

/**
 *
 * @author Aaron
 */
public class AJDissector
{

    private String phoneColon;
    private int areaCode, preCode, number, countryCode, emptyNum;   

    public AJDissector(String phoneNum)
    {
        this.phoneColon         = phoneNum;
        int index0      = phoneNum.indexOf(":");
        int index1      = phoneNum.indexOf(":", index0);
        int index2      = phoneNum.lastIndexOf(":");

        this.countryCode    = Integer.parseInt(phoneNum.substring(0, index0));
        this.areaCode       = Integer.parseInt(phoneNum.substring(index0, index1));
        this.preCode        = Integer.parseInt(phoneNum.substring(index1, index2));
        this.number         = Integer.parseInt(phoneNum.substring(index2));
    }

    public String getPhoneNumber()
    {
        return this.phoneColon;
    }

    public int getPhoneNumber(int a)
    {
        switch (a) 
        {
            case 1:
                return this.number;
            case 2:
                return this.countryCode;
            case 3:
                return this.preCode;
            case 4:
                return this.number;
            default:
                return this.emptyNum;
        }
    }
} 
```

我收到的错误是：

```
 Exception in thread "main" java.lang.NumberFormatException: For input string: ""
    at java.lang.NumberFormatException.forInputString(NumberFormatException.java:65)
    at java.lang.Integer.parseInt(Integer.java:504)
    at java.lang.Integer.parseInt(Integer.java:527)
    at aaronjonesprog1.AJDissector.<init>(AJDissector.java:26)
    at aaronjonesprog1.AaronJonesProg1.main(AaronJonesProg1.java:18)
Java Result: 1
BUILD SUCCESSFUL (total time: 0 seconds) 
```

有人可以帮我理解我做错了什么吗？我不相信我用`parseInt`错了。我查看了[http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/Integer.html](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/Integer.html)试图弄清楚，但我认为我的代码是正确的。谁能告诉我我在这里做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T01:25:39.660

请注意，该`substring`方法在指定索引处*开始*子字符串，包括在内。您从中获得的值是字符`indexOf`的索引。*您对和*`:`的使用存在问题。`substring` *`indexOf(char, index)`*

 *在尝试解析它们之前打印出 - 或在调试器中检查 - 你得到的每个索引和你的子字符串，你会看到有什么问题。

例如，在您`AJDissector`获取子字符串的构造函数中，尝试：

```
System.out.println("substring 2 indexes: " + index0 + ", " + index1);
System.out.println("substring 2: " + phoneNum.substring(index0, index1)); 
```

对于每个索引，查看整个索引`String`，并且 - 记住索引开始于`0`-`substring`在您的脑海中完成工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T03:24:45.877

还有另一种方法可以做到这一点。您可以使用 string.replace 方法将其分解或插入您的 : 符号这里是来自另一个程序的示例

```
 outputString = outputString.replaceAll(",",",\n" + " " );
 outputString = outputString.replaceAll("\\{","\\{\n" +" ");
 outputString = outputString.replaceAll(":",": ");
 outputString = outputString.replaceAll("}",",\n}");
 StringTokenizer output2 = new StringTokenizer(outputString,", ",true); 
```

这组替换字符串做了一些奇怪的格式化，对于这篇文章的主题来说很难解释，但是研究一下 ythis，你就会明白。要理解这一点，请参阅 java String api

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T03:33:37.993

也许您应该进一步了解 Java API，可能是这样的：`java.util.Scanner`.

从javadocs：

> 一个简单的文本扫描器，可以使用正则表达式解析原始类型和字符串。
> 
> Scanner 使用分隔符模式将其输入分解为标记，默认情况下匹配空格。然后可以使用各种 next 方法将生成的标记转换为不同类型的值。

[java.util.Scanner API 文档](http://docs.oracle.com/javase/6/docs/api/index.html?java/util/Scanner.html)*

# internet-explorer - 返回元素实际属性宽度 % 不是 px IE

> ID：12083523
> 
> 赞同：1
> 
> 时间：2012-08-23T01:21:53.640
> 
> 标签：internet-explorer, mootools

疯狂的！！说真的，每个其他浏览器都会返回实际以属性样式编写的内容，我怎样才能获得 css 样式中定义的宽度？

```
<div id="mywidth" style="width:50%">Div div</div>​ 
```

JavaScript：

```
var mydith = $('mywidth').getStyle('width');

document.write(mydith);​ // 50% 
```

小提琴：http: [//jsfiddle.net/2fGjR/2/](http://jsfiddle.net/2fGjR/2/)

# objective-c - 断点改变程序流程

> ID：12083526
> 
> 赞同：3
> 
> 时间：2012-08-23T01:22:32.537
> 
> 标签：objective-c, gdb, reverse-engineering, breakpoints, disassembly

我正在尝试分析和反转我拥有的 Objective-C 程序。

我通过手动更改一些操作码对可执行文件进行了一些修改。但是，当我测试修改后的软件时，我得到

> 击杀：9

没关系，我想我碰了一些我不应该碰的东西。然后我启动`gdb myprogram`以分析错误。这里发生了一些事情（对我来说很奇怪）：如果我没有放置任何断点，程序会收到 SIGKILL，而如果我尝试在收到信号的断点之前放置几行断点，似乎什么也没发生，程序似乎可以工作美好的。

从这里我的问题是：断点会改变程序流程吗？
如果答案是否定的，那么我想我写的信息不足以解决所以请询问，如果您有一些提示或建议可以为我指明正确的方向，我将不胜感激。

我正在使用 MacOS 10.7.4 和`gdb 6.3.50 (Apple version gdb-1752)`. 假设我无权访问源代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T01:28:50.643

断点改变代码工作方式的第一大原因是竞争条件。它基本上是这样的：

```
Without breakpoints:
    make some asynchronous request
    do something with response
    ERROR because request hasn't responded yet

With breakpoints:
    send some asynchronous request
    wait for user to continue
    response arrived while waiting for the continue
    do something with response
    OK! 
```

# java - TrueZip 从 netbeans/jar 启动时可以正常工作，但 javaws 不能

> ID：12083528
> 
> 赞同：1
> 
> 时间：2012-08-23T01:22:42.700
> 
> 标签：java, netbeans, jar, truezip

我在我的应用程序中使用 TrueZip 将文件/文件夹添加到模板 zip，然后将 zip 移动到用户指定的位置。当我从 Netbeans 运行应用程序或从命令提示符运行 .jar 时，一切都按我的意愿运行。如果用户将 zip 命名为“test”，则将在指定位置创建两个文件，即 test.zip 和一个名为“test.zip.{random-number}.tmp”的 tmp 文件，当应用程序关闭时，tmp 文件是删除。

现在，当我使用 Java Web Start 将我的应用程序部署到 Web 服务器并运行它时，会再次创建两个文件，但是当应用程序关闭时，tmp 文件不会被删除，当我尝试打开创建的 zip 时，我会收到消息，“存档格式未知或已损坏”。

我不知道为什么它可以从 netbeans 或 .jar 正常工作，但不能通过 web 启动。

**调用创建 zip 的类的代码：**

```
JFileChooser chooser = new JFileChooser();
    chooser.setAcceptAllFileFilterUsed(false);
    chooser.addChoosableFileFilter(new FileFilter() { 
        @Override
        public boolean accept(File file) {
            if (file.isDirectory()) {
                return true;
            }
            if(file.getName().toLowerCase().endsWith(".zip")) {
                return true;
            }
            return false;
        }
        @Override
        public String getDescription() {
            return "*.zip";
        }
    });

    int rVal = chooser.showSaveDialog(this);

    if (rVal == JFileChooser.APPROVE_OPTION) {
        try {
            //Get savepath and ensure it ends with .zip extension
            String savePath = chooser.getSelectedFile().getCanonicalPath();
            if (!savePath.endsWith(".zip")) {
                savePath = savePath.concat(".zip");
            }

            PackageBuilder build = new PackageBuilder(groups, calibData);
            build.buildZip(savePath);
        } catch (IOException ex) {
            System.out.println(ex);
        }

    } 
```

**PackageBuilder 类：**

```
package apkinstallingaromacreator;

import de.schlichtherle.truezip.file.TFile;
import de.schlichtherle.truezip.file.TFileWriter;
import java.io.File;
import java.io.IOException;
import java.io.Writer;
import java.net.URL;
import java.util.logging.Level;
import java.util.logging.Logger;
import org.apache.commons.io.FileUtils;

public class PackageBuilder {

    private File workingArchive;
    private AromaConfigBuilder aromaBuilder;
    private UpdaterScriptBuilder updaterBuilder;
    private ApkGroup[] groups;

    public PackageBuilder(ApkGroup[] groups, String calibData) {
        workingArchive = new File(System.getProperty("java.io.tmpdir"), "aromabuild.zip");
        aromaBuilder = new AromaConfigBuilder(groups, calibData);
        updaterBuilder = new UpdaterScriptBuilder(groups);
        this.groups = groups;

        //Get template.zip from jar package and move it to system tmp directory
        URL templateUrl = getClass().getResource("resources/template.zip");
        try {
            FileUtils.copyURLToFile(templateUrl, workingArchive);
        } catch (IOException ex) {
            System.out.println("Failed to copy template zip from resources");
            Logger.getLogger(PackageBuilder.class.getName()).log(Level.SEVERE, null, ex);
        }
    }

    public void importApkFiles() {
        //For each Apk in each ApkGroup add Apk file to zip in system tmp directory
        //If Apk doesn't list a file, create an empty directory for adding manually
        for (int x = 0; x < groups.length; x++) {
            Apk[] apks = groups[x].getApkArray();
            for (int y = 0; y < apks.length; y++) {
                if (apks[y].getApkFileLocation().isEmpty()) {
                    TFile dir = new TFile(workingArchive, "data/" + apks[y].getApkName());
                    dir.mkdir();
                }
                else {
                    TFile src = new TFile(apks[y].getApkFileLocation());
                    TFile dst = new TFile(workingArchive, "data/" + apks[y].getApkName() + 
                            "/" + apks[y].getApkName() + ".apk");
                    try {
                        src.cp_rp(dst);
                    } catch (IOException ex) {
                        Logger.getLogger(PackageBuilder.class.getName()).log(Level.SEVERE, null, ex);
                    }
                }
            } 
        }
    }

    public void buildZip(String savePath) {
        //populate aroma-config file within template.zip
        File aroma = new TFile(workingArchive, "META-INF/com/google/android/aroma-config");
        try {
            Writer aromaWriter = new TFileWriter(aroma);
            aromaWriter.write(aromaBuilder.buildConfig());
            aromaWriter.close();
        } catch (IOException ex) {
            Logger.getLogger(PackageBuilder.class.getName()).log(Level.SEVERE, null, ex);
        }

        //Populate updater-script file within template.zip
        File updater = new TFile(workingArchive, "META-INF/com/google/android/updater-script");
        try {
            Writer updaterWriter = new TFileWriter(updater);
            updaterWriter.write(updaterBuilder.buildConfig());
            updaterWriter.close();
        } catch (IOException ex) {
            Logger.getLogger(PackageBuilder.class.getName()).log(Level.SEVERE, null, ex);
        }

        importApkFiles();

        //Copy the zip from system tmp directory to user specified location
        TFile src = new TFile(workingArchive);
        TFile dst = new TFile(savePath);

        try {
           src.cp_rp(dst);
        } catch (IOException ex) {
            Logger.getLogger(PackageBuilder.class.getName()).log(Level.SEVERE, null, ex);
        }   
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T05:42:19.140

显然关闭挂钩不会运行以将您的更改提交到任何存档文件。只需在适当的地方添加一个调用`TVFS.umount()`，例如在 finally 块中`buildZip`。确保在完成存档文件后只调用一次，而不是每次更改，因为这会导致二次运行时间。

需要改进的地方：

*   制作`workingArchive`a`TFile`而不仅仅是 a`File`来提高性能。
*   `dir.mkdir()`删除对in的调用`importApkFiles()`。在存档文件中，它不是必需的，并且会导致多余的存档条目。

# objective-c - 在 Mac 上更改使用 AVFoundation 录制的比特率

> ID：12083529
> 
> 赞同：5
> 
> 时间：2012-08-23T01:22:45.780
> 
> 标签：objective-c, avfoundation

我正在使用 AVFoundation 在 OSX 10.8 上进行一些屏幕录制。我正在使用 sessionPreset "AVCaptureSessionPresetPhoto" 来记录整个屏幕。我想改变的一件事是创建的电影文件的质量。

似乎需要 AVCaptureSessionPresetPhoto 才能实际捕获全屏而不进行剪辑。

根据这里的文档：http: [//developer.apple.com/library/mac/#documentation/AVFoundation/Reference/AVCaptureSession_Class/Reference/Reference.html](http://developer.apple.com/library/mac/#documentation/AVFoundation/Reference/AVCaptureSession_Class/Reference/Reference.html)

```
"You use this property to customize the quality level or bitrate of the output. For possible values of sessionPreset, see “Video Input Presets.” The default value is AVCaptureSessionPresetHigh." 
```

但是，对于视频输入预设，唯一的选项是这些常量：http: [//developer.apple.com/library/ios/#documentation/AVFoundation/Reference/AVCaptureSession_Class/Reference/Reference.html#//apple_ref/occ/cl /AVCaptureSession](http://developer.apple.com/library/ios/#documentation/AVFoundation/Reference/AVCaptureSession_Class/Reference/Reference.html#//apple_ref/occ/cl/AVCaptureSession)

```
NSString *const AVCaptureSessionPresetPhoto;

NSString *const AVCaptureSessionPresetHigh;

NSString *const AVCaptureSessionPresetMedium;

NSString *const AVCaptureSessionPresetLow;

NSString *const AVCaptureSessionPreset320x240;

NSString *const AVCaptureSessionPreset352x288;

NSString *const AVCaptureSessionPreset640x480;

NSString *const AVCaptureSessionPreset960x540;

NSString *const AVCaptureSessionPreset1280x720; 
```

AVCaptureSessionPresetPhoto 可以在不裁剪的情况下捕获全屏，但最终的质量有些令人印象深刻。由于默认使用的较低比特率，存在可见的伪影。

如何提高最终录制的比特率？

以下是我当前代码的示例。

```
 mSession = [[AVCaptureSession alloc] init];

    mSession.sessionPreset = AVCaptureSessionPresetPhoto;

    CGDirectDisplayID displayId = kCGDirectMainDisplay;

    AVCaptureScreenInput *input = [[AVCaptureScreenInput alloc] initWithDisplayID:displayId];
    if (!input) {
        mSession = nil;
        return;
    }        

    if ([mSession canAddInput:input]){
        [mSession addInput:input];
    }

    mMovieFileOutput = [[AVCaptureMovieFileOutput alloc] init];
    if ([mSession canAddOutput:mMovieFileOutput])
        [mSession addOutput:mMovieFileOutput];

    [mSession startRunning];

    if ([[NSFileManager defaultManager] fileExistsAtPath:[destPath path]])
    {
        NSError *err;
        if (![[NSFileManager defaultManager] removeItemAtPath:[destPath path] error:&err])
        {
            NSLog(@"Error deleting existing movie %@",[err localizedDescription]);
        }
    }

    [mMovieFileOutput startRecordingToOutputFileURL:destPath recordingDelegate:self];

    mTimer = [NSTimer scheduledTimerWithTimeInterval:5 target:self selector:@selector(finishRecord:) userInfo:nil repeats:NO]; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-23T22:04:26.310

如果您需要对 MP4/MOV H.264 比特流的比特率进行精细控制，那么您将需要使用 AVFoundation 的 AVAssetWriter。对于视频输入，您可以像这篇[文章](https://stackoverflow.com/questions/11296642/avassetwriter-how-to-create-mov-video-with-no-compression/11320724#11320724)一样设置属性。看看**AVVideoAverageBitRateKey**。还要注意**AVVideoMaxKeyFrameIntervalKey**键。如果您打算对视频进行后期制作，那么我建议您使用 1 作为关键帧间隔。有关使用 AVAssetWriter 的示例，请查看 Apple 的 RosyWriter 或 AVCamDemo 示例应用程序。如果您需要更多解释，请告诉我。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-01-29T16:17:13.970

这实际上可以在不使用 AVAssetWriter 的情况下完成。这是一些示例代码。

```
for connection in movieFileOutput.connections {
     let settings = movieFileOutput.outputSettings(for: connection)
     var newSettings = settings
     var sub = newSettings[AVVideoCompressionPropertiesKey] as? [String: Any]
     sub![AVVideoAverageBitRateKey] = NSNumber(integerLiteral: 4000000)
     newSettings[AVVideoCompressionPropertiesKey] = sub!
     movieFileOutput.setOutputSettings(newSettings, for: connection)
  } 
```

当然，您仍然需要确定您的 AVCaptureConnection 是您的视频连接。（与我的示例代码不同，您还应该安全地打开选项）

# matlab - 如何将字符串数组转换为字符串元胞数组？

> ID：12083533
> 
> 赞同：1
> 
> 时间：2012-08-23T01:23:06.187
> 
> 标签：matlab

我有一个字符串数组：

```
array = ['123';'abc';'uvw']; 
```

我想将其转换为字符串的单元格数组：

```
cellArr = {'123';'abc';'uvw'}; 
```

我的想法有两种方法：分配一个单元格数组，然后使用 for 循环或

```
cellArr = arrayfun(@(x) array(x,:),1:size(array,1),'UniformOutput',false)'; 
```

但我不确定是否有一个内置函数这样做更有效。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T02:14:38.280

使用`cellstr()`. 简单地`cellstr (array)`应该工作。它也适用于 Octave。

或者，一种更复杂但更有趣的研究方法是

`mat2cell (array, ones (size (array, 1), 1), size (array, 2))`

在八度可以是

`mat2cell (array, ones (rows (array), 1), columns (array))`

# sql-server - SQL Server 2008 R2 - 备份没有结束

> ID：12083535
> 
> 赞同：1
> 
> 时间：2012-08-23T01:23:20.930
> 
> 标签：sql-server, backup

我有一个包含 10 个表的小型数据库（500 MB）。我可以在所有桌子上进行选择。

但是当我做备份时，它永远不会结束。我已尝试通过 UI 并使用以下命令：

```
BACKUP DATABASE DB_NAME to
    Disk = N'C:\temp\DB_Aug22.bak
    With noformat, noinit, name = N'DB_Aug22.bak,
    STATS = 10 
```

我究竟做错了什么？

问候， 希亚姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T11:07:02.330

如果您仍然遇到任何问题，您可以按照以下方法（17 分）：http:
[//msdn.microsoft.com/en-us/library/ms187510.aspx](http://msdn.microsoft.com/en-us/library/ms187510.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T07:50:30.663

使用 SSMS 备份非常简单。

1.  转到数据库右键单击然后任务----->备份
2.  选择您想要的备份类型（日志、差异、完整），但如果您的恢复类型不简单，则允许使用日志。
3.  只需选择要保存此备份的位置，例如 ('D:/backup/full.bak') 点击确定

这对我有用。

# python - os.O_EXLOCK（排他锁）在 Linux 上的 Python 中不存在

> ID：12083536
> 
> 赞同：4
> 
> 时间：2012-08-23T01:23:22.830
> 
> 标签：python, python-2.6

正如您在下面看到的，我在 Linux (RHEL) 上运行 Python 2.6，但由于某种原因它没有 os.O_EXLOCK。有什么原因吗？有没有办法解决这个问题？

```
Python 2.6.5 (r265:79063, Apr  9 2010, 11:16:46) 
[GCC 4.1.2 20080704 (Red Hat 4.1.2-48)] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> import os
>>> os.O_EXLOCK
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
AttributeError: 'module' object has no attribute 'O_EXLOCK'
>>> os.O_DSYNC
4096
>>> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-23T01:39:10.793

如[Python 标准库文档中所述](http://docs.python.org/library/os.html#open-flag-constants)，

> 以下常量是 open() 函数的 flags 参数的选项。可以使用按位 OR 运算符 | 组合它们。其中一些并非在所有平台上都可用。有关它们的可用性和使用的描述，请参阅 Unix 上的 open(2) 手册页或 Windows 上的 MSDN。

`O_EXLOCK` [起源于BSD世界](http://www.gnu.org/software/libc/manual/html_node/Open_002dtime-Flags.html)；它在 Linux 上通常不可用。您也许可以改用[Python`fcntl`模块](http://docs.python.org/library/fcntl.html)。

# android - 检测软键盘中的删除按钮

> ID：12083540
> 
> 赞同：21
> 
> 时间：2012-08-23T01:23:51.317
> 
> 标签：android, android-edittext, android-softkeyboard

我有两个 EditText（每个只接受一个字符），我想像只有一个一样处理这两个字段。

当用户在第一个字符中写入字符时，我正在使用 TextWatcher 在第二个字符中设置焦点，但我不知道如何做相反的事情。

如果用户按下第二个 EditText 中的删除按钮（这个 EditText 为空），我想将焦点移动到第一个 EditText 并删除那里的字符。

问题是当用户尝试删除一个空字段时 TextWatcher 不起作用（因为实际上没有任何变化）。而且 onKeyDown 事件仅适用于硬键盘，所以我不知道如何处理这个问题......

谢谢！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-23T04:16:49.527

[Android EditText delete(backspace) 键事件](https://stackoverflow.com/questions/4886858/android-edittext-deletebackspace-key-event)的可能重复项

刚刚检查了该问题的代码（实际上来自提供的问题并由 Labeeb P 回答）与测试项目中只有两个布局编辑，它似乎工作得很好 - 即使编辑是我也能收到删除空的。

```
 final EditText edit1 = (EditText) findViewById(R.id.editText1);

    edit1.setOnKeyListener(new View.OnKeyListener() {
        @Override
        public boolean onKey(View v, int keyCode, KeyEvent event) {
            // You can identify which key pressed buy checking keyCode value
            // with KeyEvent.KEYCODE_
            if (keyCode == KeyEvent.KEYCODE_DEL) {
                // this is for backspace
                Log.e("IME_TEST", "DEL KEY");
            }
            return false;
        }
    }); 
```

似乎应该使 EditText 的 android 文档更加清晰，或者至少提供任何关于 EditText 的指南 - 提供软键盘交互，因为几乎每个开发人员都应该制定许多典型的文档。

**更新：** 似乎这种方式不适用于最新的（至少在 4.1 之后）Android 版本。[这个答案](https://stackoverflow.com/a/11377462/657487)似乎适用于 4.1 之后的版本。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2017-04-09T17:35:03.047

我偶然发现的一个更简单的解决方案是使用[InputFilter](https://android.googlesource.com/platform/frameworks/base/+/master/core/java/android/text/InputFilter.java)。InputFilter 的`filter()`方法似乎报告了所有软键盘事件——即使是那些 EditText 的值没有改变的事件。

因此，为了解决您的具体情况，构造一个输入过滤器并进行相应设置：

```
private InputFilter filter = (charSequence, start, end, dest, dStart, dEnd) -> {

    if (end == 0 || dStart < dEnd) {
        // backspace was pressed! handle accordingly
    }

    return charSequence;
};

...

myEditText.setFilters(new InputFilter[] { filter }); 
```

退格事件可以使用`end`、`dStart`和来评估`dEnd`。`dStart`将始终小于`dEnd`删除字符的情况。如果`EditText`为空，您仍然可以通过检查 if `end`== 0 来评估退格键。

请注意，此语句中也会捕获批量删除`if`，因此您可能需要进行一些额外的检查`filter()`。另请注意，如果您使用计算机键盘在模拟器中输入 EditTexts，您可能会得到意想不到的结果。最好点击软件按钮进行测试。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-04-25T10:07:49.100

[使用https://github.com/ciasaboark/Android-Shell/blob/master/src/com/example/com/programmingthetux/tutorial/ZanyEditText.java](https://github.com/ciasaboark/Android-Shell/blob/master/src/com/example/com/programmingthetux/tutorial/ZanyEditText.java)提供的扩展

```
import java.util.Random;

import android.content.Context;
import android.util.AttributeSet;
import android.view.KeyEvent;
import android.view.inputmethod.EditorInfo;
import android.view.inputmethod.InputConnection;
import android.view.inputmethod.InputConnectionWrapper;
import android.widget.EditText;
/**
 * Created by mkallingal on 4/25/2016.
 */
public class CustomEditText extends EditText {

    private Random r = new Random();

    public CustomEditText(Context context, AttributeSet attrs, int defStyle) {
        super(context, attrs, defStyle);
    }

    public CustomEditText(Context context, AttributeSet attrs) {
        super(context, attrs);
    }

    public CustomEditText(Context context) {
        super(context);
    }

    public void setRandomBackgroundColor() {

    }

    @Override
    public InputConnection onCreateInputConnection(EditorInfo outAttrs) {
        return new ZanyInputConnection(super.onCreateInputConnection(outAttrs),
                true);
    }

    private class ZanyInputConnection extends InputConnectionWrapper {

        public ZanyInputConnection(InputConnection target, boolean mutable) {
            super(target, mutable);
        }

        @Override
        public boolean sendKeyEvent(KeyEvent event) {
            if (event.getAction() == KeyEvent.ACTION_DOWN
                    && event.getKeyCode() == KeyEvent.KEYCODE_DEL) {
                CustomEditText.this.setRandomBackgroundColor();
                // Un-comment if you wish to cancel the backspace:
                // return false;
            }
            return super.sendKeyEvent(event);
        }

        @Override
        public boolean deleteSurroundingText(int beforeLength, int afterLength) {
            // magic: in latest Android, deleteSurroundingText(1, 0) will be called for backspace
            if (beforeLength == 1 && afterLength == 0) {
                // backspace
                return sendKeyEvent(new KeyEvent(KeyEvent.ACTION_DOWN, KeyEvent.KEYCODE_DEL))
                        && sendKeyEvent(new KeyEvent(KeyEvent.ACTION_UP, KeyEvent.KEYCODE_DEL));
            }

            return super.deleteSurroundingText(beforeLength, afterLength);
        }

    }
} 
```

现在您可以像这样在 Activity 中使用它：

```
final CustomEditText editText = new CustomEditText(cxt);

editText.setOnKeyListener(new View.OnKeyListener() {
                    @Override
                    public boolean onKey(View v, int keyCode, KeyEvent event) {
                        if (keyCode == KeyEvent.KEYCODE_DEL) {
                            String _text= editText.getText().toString();
                            if(StringUtils.isBlank(_text))
                                 //editText is now empty
                            }
                        }
                        return false;
                    }
                }); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-01-18T15:17:22.030

我通过覆盖来实现它，`EditText`以便访问`InputConnection`包含`deleteSurroundingText`方法的对象。它有助于检测删除（退格）事件。请看一下我在那里提供的解决方案：[Android - 无法以软方式捕获退格/删除键。键盘](https://stackoverflow.com/questions/18581636/android-cannot-capture-backspace-delete-press-in-soft-keyboard/34857618#34857618)

此解决方案适用于硬键盘和软键盘。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-11-09T09:42:47.407

```
package com.bikash.layout;

import androidx.appcompat.app.AppCompatActivity;

import android.os.Bundle;
import android.text.Editable;
import android.text.TextWatcher;
import android.view.KeyEvent;
import android.view.View;
import android.widget.EditText;

public class MainActivity extends AppCompatActivity implements View.OnKeyListener, TextWatcher {
    EditText otp1, otp2, otp3, otp4, otp5, otp6;
    private boolean canDelete = false;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        otp1 = findViewById(R.id.otp1);
        otp2 = findViewById(R.id.otp2);
        otp3 = findViewById(R.id.otp3);
        otp4 = findViewById(R.id.otp4);
        otp5 = findViewById(R.id.otp5);
        otp6 = findViewById(R.id.otp6);

        otp1.addTextChangedListener(this);
        otp2.addTextChangedListener(this);
        otp3.addTextChangedListener(this);
        otp4.addTextChangedListener(this);
        otp5.addTextChangedListener(this);
        otp6.addTextChangedListener(this);

        otp1.setOnKeyListener(this);
        otp2.setOnKeyListener(this);
        otp3.setOnKeyListener(this);
        otp4.setOnKeyListener(this);
        otp5.setOnKeyListener(this);
        otp6.setOnKeyListener(this);

        otp1.requestFocus();
    }

    @Override
    public void beforeTextChanged(CharSequence s, int start, int count, int after) {

    }

    @Override
    public void onTextChanged(CharSequence s, int start, int before, int count) {

    }

    @Override
    public void afterTextChanged(Editable s) {
        if (otp1.isFocused()) {
            if (otp1.getText().toString().length() == 1) {
                otp2.requestFocus();
            }
        }
        if (otp2.isFocused()) {
            if (otp2.getText().toString().length() == 1) {
                otp3.requestFocus();
            }
        }
        if (otp3.isFocused()) {
            if (otp3.getText().toString().length() == 1) {
                otp4.requestFocus();
            }
        }
        if (otp4.isFocused()) {
            if (otp4.getText().toString().length() == 1) {
                otp5.requestFocus();
            }
        }
        if (otp5.isFocused()) {
            if (otp5.getText().toString().length() == 1) {
                otp6.requestFocus();
            }
        }
        if (otp6.isFocused()) {
            if (otp6.getText().toString().length() == 1) {

            }
        }

    }

    @Override
    public boolean onKey(View v, int keyCode, KeyEvent event) {

        switch (v.getId()) {
            case R.id.otp2: {
                if (keyCode == KeyEvent.KEYCODE_DEL) {

                        otp1.setText("");
                        otp1.requestFocus();
                }
                break;
            }
            case R.id.otp3: {
                if (keyCode == KeyEvent.KEYCODE_DEL) {

                        otp2.setText("");
                        otp2.requestFocus();
                }
                break;
            }case R.id.otp4: {
                if (keyCode == KeyEvent.KEYCODE_DEL) {

                        otp3.setText("");
                        otp3.requestFocus();
                }
                break;
            }case R.id.otp5: {
                if (keyCode == KeyEvent.KEYCODE_DEL) {

                        otp4.setText("");
                        otp4.requestFocus();
                }
                break;
            }case R.id.otp6: {
                if (keyCode == KeyEvent.KEYCODE_DEL) {

                        otp5.setText("");
                        otp5.requestFocus();
                }
                break;
            }
        }
        return false;
    }
} 
```

# c# - ASP.NET 4.5 从客户端检测到潜在危险的 Request.Form 值

> ID：12083544
> 
> 赞同：9
> 
> 时间：2012-08-23T01:24:11.160
> 
> 标签：c#, asp.net, exception, .net-4.5, dangerous-request

我在用户控件上嵌入了一个所见即所得的编辑器，该控件显然会进入网页。当我提交页面时，我收到“从客户端检测到潜在危险的 Request.Form 值”异常。在以前版本的 .NET 中，我只需要关闭页面的 ValidateRequest。

但是，在 .NET 4.5 中，它似乎具有 ValidateRequestMode 的属性。当我将其设置为禁用时，我仍然继续收到错误。关于 .NET 4.5 错误还没有太多，所以有人知道解决方案吗？

提前致谢。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-23T02:24:06.763

我发现了这个问题。它与 TinyMCE 编辑器有关，该编辑器需要在尝试阅读和发布内容之前对内容进行编码。解决方案是按照 m0s 的建议通过 javascript 进行编码。TinyMCE 有一个内置选项，您可以设置

```
encoding: "xml" 
```

我已经设置了它，但它不编码我在内容中的撇号。因此，为了修复它，您必须将其添加到页面上的 TinyMCE 初始化函数中：

TinyMCE 3.x

```
setup: function (ed) {
    ed.onSaveContent.add(function (i, o) {
        o.content = o.content.replace(/&#39/g, "&apos");
    });
} 
```

TinyMCE 4.x

```
setup: function(editor) {
    editor.on("SaveContent", function(i) {
        i.content = i.content.replace(/&#39/g, "&apos");
    });
} 
```

我在这里找到了解决方案：http: [//blog.tentaclesoftware.com/archive/2012/05/21/asp-net-4-0-tinymce-and-ldquoa-potentially-dangerous-request.aspx](http://blog.tentaclesoftware.com/archive/2012/05/21/asp-net-4-0-tinymce-and-ldquoa-potentially-dangerous-request.aspx)

希望对某人有所帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-05-04T20:09:31.833

我通过`[AllowHtml]`在 content 属性之前添加解决了这个问题`public virtual string content{ get; set; }`。

# jsf - 意外的命令按钮行为

> ID：12083555
> 
> 赞同：0
> 
> 时间：2012-08-23T01:25:52.853
> 
> 标签：jsf, jsf-2, primefaces

问题：当光标在 inputText 中并且我按下“Enter”时，将弹出对话框这发生在 Chrome 中，但不是通过 IE：

```
 <h:form id="mainForm" prependId="false">   
        <h:inputText id="globalFilter" onkeypress="if(event.keyCode == 13){}"/>
        <p:commandButton id="Button1" 
                         oncomplete="widgetVar.show()"/>
        <p:dialog id="Dialog1" 
                  widgetVar="widgetVar"
                  appendToBody="true"
                  dynamic="true"/>
    </h:form> 
```

我该如何预防？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T02:25:50.353

您只需添加`return false`即可停止此事件。
像`onkeypress="if(event.keyCode == 13){return false;}"`

# asp.net - 直接调用控制器时的 ASP.Net MVC OutputCache

> ID：12083558
> 
> 赞同：2
> 
> 时间：2012-08-23T01:26:46.227
> 
> 标签：asp.net, asp.net-mvc

在给定几个输入参数的情况下，我有一个动态呈现图形的控制器操作。由于图形渲染时会稍微显眼，因此我使用输出缓存来避免重新渲染。

有几十个非常常用的输入参数组合。我认为预热缓存是个好主意，这样第一个使用这些组合的访问者就不会遇到延迟。

为此，我直接从 Application_Start() 调用控制器，如下所示：

```
UtilController uc = new UtilController();
uc.GenerateImage(p1, p2, p3); 
```

通过设置断点，我看到调用了控制器动作并生成了图像。但是，浏览器第一次（也是唯一一次）请求该图像时，它会再次生成。出于此测试的目的，浏览器被配置为不缓存任何内容，我仔细比较了用于调用控制器操作的参数。

直接调用控制器动作时是否不调用输出缓存？有没有更好的预热缓存的方法（希望是一个独立于网络项目的方法）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T05:53:10.637

> 直接调用控制器动作时是否不调用输出缓存？

它没有被调用，因为您没有经历触发它的 HTTP 请求/响应周期。您正在直接调用恰好是您的操作的方法。

> 有没有更好的预热缓存的方法（希望是一个独立于网络项目的方法）？

您可以使用 WebClient 向给定地址发送 HTTP 请求。这当然只有在您将缓存配置为存储在服务器上时才有效。如果您将位置配置为下游或客户端上，它将没有任何用处。

# python - Boost::Python 和带变量的函数

> ID：12083562
> 
> 赞同：2
> 
> 时间：2012-08-23T01:27:42.847
> 
> 标签：python, boost

**目标：**我正在尝试使用 Boost::Python 库在我的 c++ 代码中以交互方式使用 python。我的目标是从 python 解释器更改我在 c++ 中定义的某些类的变量。

代码附在下面。

**问题：**我可以在python接口中加载库（即加载hello）并从中创建一个对象（obj = hello.World（））。我什至可以访问没有变量的函数（ obj.greet() ），但是当我想访问带变量的函数（obj.Set("Hello") ）时，我会遇到内存访问冲突（“访问冲突读取位置 0xffffffffffffffff”）。即使该函数是一个只需要一些字符串的空函数。

```
struct World
{
    void set(string _msg) {}
    string greet() { return msg; }
    string msg;
};
typedef boost::shared_ptr<World> World_ptr;
BOOST_PYTHON_MODULE(hello)
{
    bp::class_<World, World_ptr>("World")
        .def("greet", &World::greet)
        .def("set", &World::set)
    ;
}
int main(int argc, char **argv)
{
    Py_Initialize();    

    bp::object main = bp::object(bp::handle<>(bp::borrowed(PyImport_AddModule("__main__"))));
    bp::object global(main.attr("__dict__"));
    inithello();
    // Bring up Python interpreter
    Py_Main(argc, argv);

    Py_Finalize();

    return 0;
} 
```

实际上，这来自 Boost::Python 教程，对使用 Python 解释器进行了一些修改 [http://www.boost.org/doc/libs/1_51_0/libs/python/doc/tutorial/doc/html/python/exposing.html](http://www.boost.org/doc/libs/1_51_0/libs/python/doc/tutorial/doc/html/python/exposing.html)

非常感谢

---------------------**编辑**---------

我进行了很多测试，发现问题仅出在字符串输入上。即char* 或int 没有问题。boost python中的字符串有问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T19:06:34.047

[我没有看到任何错误](https://gist.github.com/735d280eec2a5124279a/#file_main.cpp)：

```
/**
 $ sudo apt-get install libboost-python-dev
 $ ./do
*/
#include <boost/python.hpp>

struct World
{
    void set(std::string msg) { this->msg = msg; }
    std::string greet() { return msg; }
    std::string msg;
};

namespace py = boost::python;

BOOST_PYTHON_MODULE(hello)
{
  py::class_<World>("World")
    .def("greet", &World::greet)
    .def("set", &World::set)
    ;
}

int main(int argc, char* argv[]) {
  Py_Initialize();
  inithello();

  PySys_SetArgv(argc, argv); // use later in Python
  if (PyRun_SimpleString("import hello\n"
                         "planet = hello.World()\n"
                         "planet.set('howdy')\n"
                         "print(planet.greet())\n"

                         // start interactive Python shell if `-i`
                         "import sys\n"
                         "if '-i' in sys.argv:\n"
                         "  import code\n"
                         "  code.interact()\n" //NOTE: namespace may be provided
                         ) < 0)
    return 1; // an exception is raised in Python

  Py_Finalize();
} 
```

另请参阅[如何在程序中启动 python 控制台（以便于调试）？](https://stackoverflow.com/q/4511763/4279).

编译：

```
$ c++ main.cpp -o main `python-config --cflags` \
     `python-config --ldflags` -lboost_python 
```

跑：

```
$ ./main -i 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T22:52:22.810

我发现我犯了一个错误，并将 boost_python 的静态库（.lib 文件）添加到链接器页面中。我不确定它导致了什么，但是在我删除它之后，我发现程序使用的是“boost_python-vc100-mt-1_51.dll”而不是“boost_python-vc100-mt-gd-1_51.dll”。

问题解决了，但是谁能解释一下是什么问题？

非常感谢所有的帮助

# jquery-mobile - 使用 jQuery mobile、google maps API v3 将 infoWindow 添加到地图标记

> ID：12083564
> 
> 赞同：1
> 
> 时间：2012-08-23T01:27:56.910
> 
> 标签：jquery-mobile, google-maps-api-3, infowindow, jquery-ui-map

我有一个简单的脚本，当您使用 jQuery mobile 和 Google Maps API v3 单击按钮时，它会在地图上添加一个标记。我想为该标记添加一个基本的 infoWindow，这样当您单击它时，它会显示“Hello World”。

这似乎应该很容易，但我似乎无法正确使用语法。我正在添加这样的标记

```
$('#map_canvas').gmap('addMarker', { 'position': chicago } ); 
```

而且我似乎找不到任何很好的例子，当您还设置标记时，您还设置了一个信息窗口。

这是我的代码。如果保存在`jquery-ui-map-3.0-rc\demos\`目录中，则所有路径都是正确的。当您单击“添加更多标记”时，该`chicago`位置的标记会添加到地图中。我希望能够单击该标记并弹出一个显示“Hello World！”的信息窗口。

```
<!doctype html>
<html lang="en">
   <head>
        <title>jQuery mobile with Google maps - Google maps jQuery plugin</title>
        <link rel="stylesheet" href="http://code.jquery.com/mobile/1.0.1/jquery.mobile-1.0.1.min.css" />
        <script type="text/javascript" src="http://code.jquery.com/jquery-1.6.4.min.js"></script>
        <script type="text/javascript" src="http://code.jquery.com/mobile/1.0.1/jquery.mobile-1.0.1.min.js"></script>
        <script type="text/javascript" src="http://maps.google.com/maps/api/js?v=3&sensor=false&language=en"> </script>
        <script type="text/javascript" src="http://jquery-ui-map.googlecode.com/svn/trunk/ui/min/jquery.ui.map.min.js"></script>
        <script type="text/javascript">

            var chicago = new google.maps.LatLng(41.850033,-87.6500523);
            var mobileDemo = { 'center': '41,-87', 'zoom': 7 };
            var cityList = [];

            function initialize()
            {
                $('#map_canvas').gmap({ 'center': mobileDemo.center, 'zoom': mobileDemo.zoom, 'disableDefaultUI':false });
            }

            $(document).ready(function() 
            {
                initialize();
                $('.add-markers').click(function() {
                    $('#map_canvas').gmap('addMarker', { 'position': chicago } );
                });
            });
        </script>
    </head>
    <body>
        <div id="basic-map" data-role="page">
            <div data-role="header">
                <h1><a data-ajax="false" href="/">jQuery mobile with Google maps v3</a> examples</h1>
                <a data-rel="back">Back</a>
            </div>
            <div data-role="content">   
                <div class="ui-bar-c ui-corner-all ui-shadow" style="padding:1em;">
                    <div id="map_canvas" style="height:350px;"></div>
                </div>
                <a href="#" class="add-markers" data-role="button" data-theme="b">Add Some More Markers</a>
            </div>
        </div>      
    </body>
</html> 
```

如果我将内部代码更改为`$(document).ready(function()){}`以下内容，则标记甚至不再显示。

```
 $(document).ready(function()
        {
            initialize();
            $('.add-markers').click(function() {
                //$('#map_canvas').gmap('addMarker', { 'position': chicago, 'content': "Hello World!"} );
                $('#map_canvas').gmap({'callback': function() {
                    var self = this;
                    self.addMarker({'position': chicago }).click(function() {
                        self.openInfoWindow({ 'content': 'Hello World!' }, this);
                    });
                    }});
                });
            }); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T08:41:41.480

我已经添加了请求的打开信息窗口。请检查以下代码：

```
<!doctype html>
<html lang="en">
   <head>
        <title>jQuery mobile with Google maps - Google maps jQuery plugin</title>
        <link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css" />
        <script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
        <script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script>
        <script type="text/javascript" src="http://maps.google.com/maps/api/js?v=3&sensor=false&language=en"> </script>
        <script type="text/javascript" src="http://jquery-ui-map.googlecode.com/svn/trunk/ui/min/jquery.ui.map.min.js"></script>
        <script type="text/javascript">

            var chicago = new google.maps.LatLng(41.850033,-87.6500523),
            mobileDemo = { 'center': '41,-87', 'zoom': 7 };

            function initialize() {
                $('#map_canvas').gmap({ 'center': mobileDemo.center, 'zoom': mobileDemo.zoom, 'disableDefaultUI':false });
            }

            $(document).on("pageinit", "#basic-map", function() {
                initialize();
            });

            $(document).on('click', '.add-markers', function(e) {
                e.preventDefault();
                $('#map_canvas').gmap('addMarker', { 'position': chicago } ).click(function() {
                    $('#map_canvas').gmap('openInfoWindow', {'content': 'Hello World!'}, this);
                });
            });
        </script>
    </head>
    <body>
        <div id="basic-map" data-role="page">
            <div data-role="header">
                <h1><a data-ajax="false" href="/">jQuery mobile with Google maps v3</a> examples</h1>
                <a data-rel="back">Back</a>
            </div>
            <div data-role="content">   
                <div class="ui-bar-c ui-corner-all ui-shadow" style="padding:1em;">
                    <div id="map_canvas" style="height:350px;"></div>
                </div>
                <a href="#" class="add-markers" data-role="button" data-theme="b">Add Some More Markers</a>
            </div>
        </div>      
    </body>
</html> 
```

**没有 jQuery-ui-maps 插件的示例：**

```
<!doctype html>
<html lang="en">
   <head>
        <title>jQuery mobile with Google maps - Google maps jQuery plugin</title>
        <link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css" />
        <script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
        <script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script>
        <script type="text/javascript" src="http://maps.google.com/maps/api/js?v=3&sensor=false&language=en"> </script>
        <script type="text/javascript">

            var cityList = [
                ['Chicago', 41.850033, -87.6500523, 1],
                ['Illinois', 40.797177,-89.406738, 2]
            ],
            demoCenter = new google.maps.LatLng(41,-87),
            map;

            function initialize()
            {
                map = new google.maps.Map(document.getElementById('map_canvas'), {
                   zoom: 7,
                   center: demoCenter,
                   mapTypeId: google.maps.MapTypeId.ROADMAP
                 });
            }

            function addMarkers()
            {
                var marker, 
                i,
                infowindow = new google.maps.InfoWindow();

                for (i = 0; i < cityList.length; i++) 
                {  
                    marker = new google.maps.Marker({
                        position: new google.maps.LatLng(cityList[i][1], cityList[i][2]),
                        map: map,
                        title: cityList[i][0]
                    });

                    google.maps.event.addListener(marker, 'click', (function(marker, i) {
                        return function() {
                            infowindow.setContent(cityList[i][0]);
                            infowindow.open(map, marker);
                        }
                    })(marker, i));
                }
            }
            $(document).on("pageinit", "#basic-map", function() {
                initialize();
            });

            $(document).on('click', '.add-markers', function(e) {
                e.preventDefault();
                addMarkers();
            });

        </script>
    </head>
    <body>
        <div id="basic-map" data-role="page">
            <div data-role="header">
                <h1><a data-ajax="false" href="/">jQuery mobile with Google maps v3</a> examples</h1>
                <a data-rel="back">Back</a>
            </div>
            <div data-role="content">   
                <div class="ui-bar-c ui-corner-all ui-shadow" style="padding:1em;">
                    <div id="map_canvas" style="height:350px;"></div>
                </div>
                <a href="#" class="add-markers" data-role="button" data-theme="b">Add Some More Markers</a>
            </div>
        </div>      
    </body>
</html> 
```

# facebook - Facebook 是否在过期后重用/回收访问令牌？

> ID：12083568
> 
> 赞同：0
> 
> 时间：2012-08-23T01:29:41.000
> 
> 标签：facebook, facebook-graph-api

假设用户的 FB access_token 出于某种原因已过期（过期时间已过、用户更改密码、用户从仪表板中删除了应用程序等）。我是否保证永远不会再将这个 access_token 分发给任何用户？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T02:14:32.350

访问令牌可以由 Facebook 调试器解码。这暗示它们是一些数据的哈希，包括用户、授予的范围、请求的应用程序和到期时间。

使用此协议，访问令牌不应重复。但是，这并不意味着 Facebook 将来不会更改他们的协议，这*可能会*导致重复。这似乎不太可能。

# salesforce - Visualforce：Jquery 树视图不工作

> ID：12083572
> 
> 赞同：0
> 
> 时间：2012-08-23T01:30:04.790
> 
> 标签：salesforce, apex-code, visualforce, force.com

我在 Visualforce 页面上尝试使用 jQuery 的 Treeview，但由于某种原因它无法正常工作。

这是相关的代码。

```
 <apex:outputPanel id="invisibleSection" layout="block" styleClass="invisibleSectionClass">
          <script type="text/javascript">
          $("#browser").treeview();
           document.write('hi');
                $(document).ready(function() {
                        $("#navigation").treeview({
                        persist: "location",
                        collapsed: false,
                        animated: "medium"
                         });
                });

          </script>
          <ul id="browser" class="filetree">
            <li><span class="folder">Folder 1</span>
                <ul>
                    <li><span class="file">Item 1.1</span></li>
                </ul>
            </li>
            <li><span class="folder">Folder 2</span>
                <ul>
                    <li><span class="folder">Subfolder 2.1</span>
                        <ul id="folder21">
                            <li><span class="file">File 2.1.1</span></li>
                            <li><span class="file">File 2.1.2</span></li>
                        </ul>
                    </li>
                    <li><span class="file">File 2.2</span></li>
                </ul>
            </li>
            <li class="closed"><span class="folder">Folder 3 (closed at start)</span>
                <ul>
                    <li><span class="file">File 3.1</span></li>
                </ul>
            </li>
            <li><span class="file">File 4</span></li>
        </ul> 
```

我`document.write('hi');`检查了是否甚至调用了javascript部分并正在打印它。因此，我认为还有其他问题。我已将 Treeview（zip 文件）作为静态资源包含在内。

那么我做错了什么让这不起作用。

```
<apex:includeScript value="{!URLFOR($Resource.Jtreeview,'Jquerytreeview/jquery.js')}"/>
<apex:includeScript value="{!URLFOR($Resource.Jtreeview,'Jquerytreeview/jquery.cookie.js')}"/>
<apex:includeScript value="{!URLFOR($Resource.Jtreeview,'Jquerytreeview/jquery.treeview.js')}"/>

<apex:stylesheet value="{!URLFOR($Resource.Jtreeview,'Jquerytreeview/jquery.treeview.css')}" /> 
```

更新基于约翰的以下建议：

```
 $(document).load(function () {

             $("#browser").treeview();

             $("#navigation").treeview({
                        persist: "location",
                        collapsed: false,
                        animated: "medium"
                         });

            }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T01:49:48.447

乍一看，您可能需要将脚本标签移到 UL 标签下方。因为它是一个内联脚本标记，所以 DOM 在脚本运行时可能不知道 UL id“浏览器”。我什至会移动 `$("#browser").treeview();`document.load 方法的内部。这将确保在页面完成渲染并建立 DOM 之后调用代码。

# c# - 我如何才能从 xml 文件中读取文本，并从 xml 文件中逐行解析日期和时间？

> ID：12083574
> 
> 赞同：1
> 
> 时间：2012-08-23T01:30:24.883
> 
> 标签：c#

在此代码中，我使用 InnerText 仅查看 xml 文件中的文本，没有任何标签。但我现在想要改变两件事：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.Xml;

namespace WindowsFormsApplication1
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        private void button1_Click(object sender, EventArgs e)
        {
            string xmlString = @"d:\adilipman1937067724.xml";

            XmlDocument doc = new XmlDocument();
            doc.Load(xmlString);
            string t = doc.InnerText;
            textBox1.Text = t;
        }
    }
} 
```

1.  将文本解析为行。

2.  解析并将日期和时间添加到每一行。

这是我要从中解析的 xml 文件的示例：

```
FriendlyName="adilipman@yahoo.com"/></To><Text Style="font-family:Segoe UI; color:#000000; ">testing the test.</Text></Message><Message Date="31/01/2012" Time="10:15:58" DateTime="2012-01-31T08:15:58.897Z" SessionID="1"><From><User FriendlyName="Chocolade"/></From><To><User 
```

而不是只输入一个字符串“测试测试”我希望它在 textBox1 中的格式如下：

```
adilipman 10:15:58 31/01/2012 testing the test 
```

这是一条线。下一行将是例如：

```
adilipman 10:15:59 31/01/2012 testing the test was ok 
```

但现在我在 textBox1 中得到的是这样的：

```
testing the test testing the test was ok 
```

xml文件中的更多文本：

```
<?xml version="1.0"?>
<?xml-stylesheet type='text/xsl' href='MessageLog.xsl'?>
<Log FirstSessionID="1" LastSessionID="2"><Message Date="31/01/2012" Time="10:15:42" DateTime="2012-01-31T08:15:42.467Z" SessionID="1"><From><User FriendlyName="Chocolade"/></From><To><User FriendlyName="adilipman@yahoo.com"/></To><Text Style="font-family:Segoe UI; color:#000000; ">היי</Text></Message><Message Date="31/01/2012" Time="10:15:55" DateTime="2012-01-31T08:15:55.097Z" SessionID="1"><From><User FriendlyName="Chocolade"/></From><To><User FriendlyName="adilipman@yahoo.com"/></To><Text Style="font-family:Segoe UI; color:#000000; ">הייתה לי בעיה עם התוכנת ברקים אבל עכשיו הכל עובד.</Text></Message><Message Date="31/01/2012" Time="10:15:58" DateTime="2012-01-31T08:15:58.897Z" SessionID="1"><From><User FriendlyName="Chocolade"/></From><To><User FriendlyName="adilipman@yahoo.com"/></To><Text Style="font-family:Segoe UI; color:#000000; ">מה השלב הבא ?</Text></Message><Message Date="31/01/2012" Time="10:16:27" DateTime="2012-01-31T08:16:27.775Z" SessionID="1"><From><User FriendlyName="Chocolade"/></From><To><User FriendlyName="adilipman@yahoo.com"/></To><Text Style="font-family:Segoe UI; color:#000000; ">אמרת לי בזמנו לחשב ממוצע של 1000 ערכים ? הכוונה 1000 ערכים בפריים ? כי בפריים יש 256 מספרים לא ?</Text></Message><Message Date="31/01/2012" Time="10:17:03" DateTime="2012-01-31T08:17:03.405Z" SessionID="1"><From><User FriendlyName="adilipman@yahoo.com"/></From><To><User FriendlyName="Chocolade"/></To><Text Style="font-family:Segoe UI; color:#000000; ">לחשב ממוצע של 1000 הערכים הגבוהים ביותר בהיסטוגרמה</Text></Message><Message Date="31/01/2012" Time="10:17:10" DateTime="2012-01-31T08:17:10.405Z" SessionID="1"><From><User FriendlyName="adilipman@yahoo.com"/></From><To><User FriendlyName="Chocolade"/></To><Text Style="font-family:Segoe UI; color:#000000; ">ז"א בפריים</Text></Message><Message Date="31/01/2012" Time="10:17:14" DateTime="2012-01-31T08:17:14.135Z" SessionID="1"><From><User FriendlyName="adilipman@yahoo.com"/></From><To><User FriendlyName="Chocolade"/></To><Text Style="font-family:Segoe UI; color:#000000; ">לא בהיסטוגרמה</Text></Message><Message Date="31/01/2012" Time="10:17:20" DateTime="2012-01-31T08:17:20.142Z" SessionID="1"><From><User 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T04:19:21.813

解析 xml 文档有很多不同的方法...使用`XmlDocument`, `XmlTextReader`s 但我更喜欢使用 Linq to xml 类来解析现有的 xml 文档，但是如果我必须创建我的 oun xml 文档然后解析它，我更喜欢使用序列化。我比因为我不知道你把那个 xml 文件带到哪里去了？？？你自己开的？？？如果是，您应该使用 xml 序列化将您自己的对象保存到 xml 并反序列化以将它们读回。它比解析 xml 文档要容易得多。

这是一个与您的问题类似的最简单示例：正如我从您的 xml 示例中可以理解的那样......我使用了这个 xml 片段：

```
<Message Date="31/01/2012" 
         Time="10:15:58" 
         DateTime="2012-01-31T08:15:58.897Z" 
         SessionID="1">
         <From>
               <User FriendlyName="Chocolade"/>
         </From>
         <To>
               <User FriendlyName="adilipman@yahoo.com"/>
         </To>
         <Text >testing the test.</Text>
</Message> 
```

您应该使用 DateTime、SessionId、From、To 和 Text 字段创建 Message 类。就像是：

```
[Serializable]
public class User
{
      public string FriendlyName { get; set; }
}

[Serializable]
public class Message
{
      public string Text { get; set; }
      public DateTime DateTime { get; set; }
      public int SessionID { get; set; }
      public User Form { get; set; }
      public User To { get; set; }
} 
```

[Serializable] 属性是编译器知道您的类型（消息）可以序列化所必需的。在创建类 xml 结构之后，您可以序列化它们的任何实例`Message`或它们的前夕数组`List<Message>`。接下来你应该做：

```
private void button1_Click(object sender, EventArgs e)
{
string xmlToSerializePath = @"c:/temp/stackowrflowquestionxml.xml";

XmlSerializer serializer = new XmlSerializer(typeof(Message));
StreamWriter writer = new StreamWriter(xmlToSerializePath);

Message messageToSerialize = new Message
                                    {
                                        DateTime = new DateTime(2012, 1, 31, 8, 15, 58),
                                        Form = new User()
                                                  {
                                                        FriendlyName = "Chocolade"
                                                  },
                                        To = new User
                                                  {
                                                        FriendlyName = "adilipman@yahoo.com"
                                                  },
                                        SessionID = 1,
                                        Text = "testing the test."
                                     };
       serializer.Serialize(writer, messageToSerialize);
       writer.Close();
} 
```

您将获得下一个 xml 文档：

```
<?xml version="1.0" encoding="utf-8"?>
<Message xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <Text>testing the test.</Text>
  <DateTime>2012-01-31T08:15:58</DateTime>
  <SessionID>1</SessionID>
  <Form>
    <FriendlyName>Chocolade</FriendlyName>
  </Form>
  <To>
    <FriendlyName>adilipman@yahoo.com</FriendlyName>
  </To>
</Message> 
```

它与您的非常相似，但现在如果您需要获取有关该消息的所有信息，您不需要粘贴 xml，您只需要反序列化它并获取您自己的`Message`类的正确实例：

```
StreamReader reader = new StreamReader(xmlToSerializePath);
Message deserializedMessage = (Message)serializer.Deserialize(reader);
reader.Close(); 
```

当您获得消息实例时，您可以随意操作它，并用您的消息的任何信息填充该文本框：

```
textBox1.Text = string.Format("{0} {1} {2} {3}", 
          deserializedMessage.DateTime, 
          deserializedMessage.Form.FriendlyName, 
          deserializedMessage.To.FriendlyName, 
          deserializedMessage.SessionID); 
```

文本框文本如下：

```
31.01.2012 8:15:58 Chocolade adilipman@yahoo.com 1 
```

/ *================================================== ==================================* /

如果您不喜欢或不想使用这种方法，或者您只需要解析已经由某些第三方 xml 创建的，您可以使用 linq to xml 语法。例如：

创建 XDocument 实例：

```
string xmlStringPath = @"d:/adilipman1937067724.xml";
XDocument document = new XDocument(xmlStringPath); 
```

但有时它会抛出异常，因此您需要创建 XmlDocument，将 xml 作为字符串加载，并使用静态 XDocument 方法来解析该字符串：

```
XmlDocument doc = new XmlDocument();
doc.Load(xmlString);
XDocument document = XDocument.Parse(doc.OuterXml); 
```

注意 XDocument 和 XmlDocument。这是两种不同的类型。然后您可以使用 linq 语法解析您的文档：

```
// Get root message element
var messageElement = (from element in document.Elements()
                                  where element.Name == "Message"
                                  select element).FirstOrDefault();

// Get date attribute of message element
string date = messageElement.Attribute("Date").Value;

// Get To element
// Notice that we make select from elements of message element messageElement.Elements()
// You should closely follow about what attribute are you making select from,
// because your selection will return null, and you will get errors.
var toElement = (from element in messageElement.Elements()
                             where element.Name == "To"
                                select element).FirstOrDefault();

// Then we take value of user element friendly name attribute
// We get element (tag) User of all possible existing sub tags of tag To
string toFriendlyName =
                (from element in toElement.Elements()
                 where element.Name == "User"
                 select element.Attribute("FriendlyName").Value).FirstOrDefault(); 
```

对于每个属性或元素，依此类推。如您所见，“手动”解析 xml 是一项非常困难且庞大的工作。所以我建议你使用序列化。希望我的回答对你有所帮助。

# php - php如何创建动态xml站点地图

> ID：12083576
> 
> 赞同：1
> 
> 时间：2012-08-23T01:30:49.883
> 
> 标签：php

我有以下代码，但我想要正确的站点地图标准。

**我的代码**

```
$xml = new DomDocument('1.0', 'utf-8'); 
$xml->formatOutput = true; 
$products= $xml->createElement('url'); 
$product = $xml->createElement('url'); 
$xml->appendChild($products); 
$products->appendChild($product); 
$product->appendChild(new DomAttr('loc', '123')); 
$xml->save("data.xml"); 
```

**但所述代码的输出是lile：**

```
<?xml version="1.0" encoding="utf-8"?>
<url>
<url loc="123"/>
</url> 
```

**但我想要以下标准......**

```
<?xml version="1.0" encoding="UTF-8"?>
<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9">
   <url>
      <loc>http://www.example.com/</loc>
      <lastmod>2012-08-11T04:08:53+01:00</lastmod>
      <changefreq>monthly</changefreq>
      <priority>0.5</priority>
   </url>
</urlset> 
```

请在这方面帮助我。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T01:53:33.110

您已经证明可以通过您的语法创建 XML 文档 - 只需重新创建标准模板。

例如，我会假装您的网站信息存储在数组中，例如：

```
$yourSiteContent = array(
    array('permalink' => 'http://www.somesite.com/someurl1', 'updated' => '2012-08-11T04:08:53+01:00'),
    array('permalink' => 'http://www.somesite.com/someurl2', 'updated' => '2012-09-11T04:08:53+01:00'),
    array('permalink' => 'http://www.somesite.com/someurl3', 'updated' => '2012-10-11T04:08:53+01:00')
); 
```

然后回到你的例子：

```
$xml = new DomDocument('1.0', 'utf-8'); 
$xml->formatOutput = true; 

// creating base node
$urlset = $xml->createElement('urlset'); 
$urlset -> appendChild(
    new DomAttr('xmlns', 'http://www.sitemaps.org/schemas/sitemap/0.9')
);

    // appending it to document
$xml -> appendChild($urlset);

// building the xml document with your website content
foreach($yourSiteContent as $entry)
{

    //Creating single url node
    $url = $xml->createElement('url'); 

    //Filling node with entry info
    $url -> appendChild( $xml->createElement('loc', $entry['permalink']) ); 
    $url -> appendChild( $lastmod = $xml->createElement('lastmod', $entry['updated']) ); 
    $url -> appendChild( $changefreq = $xml->createElement('changefreq', 'monthly') ); 
    $url -> appendChild( $priority = $xml->createElement('priority', '0.5') ); 

    // append url to urlset node
    $urlset -> appendChild($url);

}

$xml->save("data.xml"); 
```

剩下的就看你了。

# ruby-on-rails - 渲染 json：作用域子资源

> ID：12083577
> 
> 赞同：0
> 
> 时间：2012-08-23T01:30:58.083
> 
> 标签：ruby-on-rails, ruby-on-rails-3

以前我使用下面的代码成功地呈现了一个客户资源，包括它的嵌套折扣资源：

```
class Discount < ActiveRecord::Base
  belongs_to :customer
end

format.json { render json: Customer.find(params[:id]), :include => { :discounts =>
  {:include => {...}
  }}
}} 
```

我后来在我的折扣中添加了一个范围，即

```
class Discount < ActiveRecord::Base
  belongs_to :customer

  scope :current, where('(begin_on <= ? OR begin_on IS NULL) AND (? <= end_on OR end_on IS NULL)', Date.today, Date.today)
end 
```

如何使上述 json 调用仅呈现这些当前折扣而不是所有 Customer.discounts？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T03:15:16.363

好的，所以我想出了一个解决方案。我会对任何替代答案感兴趣，但就我的目的而言，这似乎可行：

```
format.json { render json: @customer, :methods => [:current_discounts]}

class Customer < ActiveRecord::Base
  has_many :discounts

  def current_discounts
    discounts.current
  end
end 
```

# php - 与开头为零的数字相加

> ID：12083580
> 
> 赞同：0
> 
> 时间：2012-08-23T01:31:32.327
> 
> 标签：php

我有这个变量`$value1= 000001;`，如您所见，它包含一些以 0 开头的数字。

我想要的是在变量中添加“1”，这样当我回显时它看起来像这样`000002`。再例如，如果变量是这样的，`$value1= 012001;`我想让它看起来像`012002`.

我试过像下面这样，但它产生的结果只有“2”

```
$value1= 000001;  
echo $value+1; 
```

你能告诉我如何实现这一目标吗？

谢谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T01:46:11.510

有很多方法可以做到这一点，这里有一个不同的方法：

```
$value1 = '000101';

$strLen = strlen($value1);
$value  = (((int) $value1) + 1);
echo str_pad($value, $strLen, '0', STR_PAD_LEFT); 
```

php test.php 000102

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T01:35:16.483

使用 printf

```
<?php 
$value1 = 2;
printf("%06d", 2); 
```

更正： number_format 在这里没有用，将其删除。

附录：除非您打算使用八进制数字，否则不要以 0 开头的数字文字，因为 PHP 将以 0 开头的数字解释为八进制。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T01:36:16.240

我会选择`str_pad`，因为它更快，更重要的是：比`printf`(`number_format`在这里不相关) 更具可读性。`echo str_pad($value+1, 6, '0', STR_PAD_LEFT);`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T01:38:32.923

```
$value1= 000001;
printf( "%06d", $value + 1 ); 
```

# c++ - “CV_EXPORTS_W”是什么意思

> ID：12083583
> 
> 赞同：7
> 
> 时间：2012-08-23T01:31:55.210
> 
> 标签：c++, opencv

最近，我尝试在OpenCV库中查找“calcOpticalFlowPyrLK”函数的源代码。当我搜索它的定义时，我发现了一个名为“CV_EXPORTS_W”的宏。有谁知道是什么意思？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-23T02:09:31.870

[`CV_EXPORTS_W`在 modules/core/include/opencv2/core/types_c.h](https://github.com/Itseez/opencv/blob/master/modules/core/include/opencv2/core/types_c.h#L179)中定义为 的别名`CV_EXPORTS`，并且在同一文件[`CV_EXPORTS`中定义为](https://github.com/Itseez/opencv/blob/master/modules/core/include/opencv2/core/types_c.h#L147)：

```
#if (defined WIN32 || defined _WIN32 || defined WINCE) && defined CVAPI_EXPORTS
# define CV_EXPORTS __declspec(dllexport)
#else
# define CV_EXPORTS
#endif 
```

换句话说，它是定义[`__declspec(dllexport)`](https://stackoverflow.com/q/2284610/424459)在windows平台上的别名`CVAPI_EXPORTS`，否则为空。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-12-29T11:52:29.503

您可以使用 __declspec(dllexport) 关键字从 DLL 导出数据、函数、类或类成员函数。

Microsoft 在 Visual C++ 的 16 位编译器版本中引入了 __export，以允许编译器自动生成导出名称并将它们放在 .lib 文件中。然后可以像使用静态 .lib 一样使用此 .lib 文件与 DLL 链接。

在较新的编译器版本中，您可以使用 __declspec(dllexport) 关键字从 DLL 导出数据、函数、类或类成员函数。__declspec(dllexport) 将导出指令添加到目标文件，因此您不需要使用 .def 文件。

在尝试导出修饰的 C++ 函数名称时，这种便利最为明显。因为没有名称修饰的标准规范，导出函数的名称可能会在编译器版本之间发生变化。如果您使用 __declspec(dllexport)，则只需重新编译 DLL 和相关的 .exe 文件，以解决任何命名约定更改。

许多导出指令，例如序数、NONAME 和 PRIVATE，只能在 .def 文件中生成，没有 .def 文件就无法指定这些属性。但是，除了使用 .def 文件之外，使用 __declspec(dllexport) 不会导致构建错误。

要导出函数，如果指定了关键字，则 __declspec(dllexport) 关键字必须出现在调用约定关键字的左侧。例如：

__declspec(dllexport) 无效 __cdecl Function1(void);

要导出类中的所有公共数据成员和成员函数，关键字必须出现在类名的左侧，如下所示：

类 __declspec(dllexport) CExampleExport : public CObject { ... 类定义 ... };

注意注意

__declspec(dllexport) 不能应用于具有 __clrcall 调用约定的函数。

在构建 DLL 时，通常会创建一个头文件，其中包含要导出的函数原型和/或类，并将 __declspec(dllexport) 添加到头文件中的声明中。为了使您的代码更具可读性，请为 __declspec(dllexport) 定义一个宏，并将该宏与您要导出的每个符号一起使用：

# 定义 DllExport __declspec( dllexport )

__declspec(dllexport) 将函数名称存储在 DLL 的导出表中。如果要优化表的大小，请参阅按序号而不是按名称从 DLL 导出函数。

# android - 将 Android-SQLite 代码移植到非 Android SQLite

> ID：12083587
> 
> 赞同：1
> 
> 时间：2012-08-23T01:32:21.743
> 
> 标签：android, sqlite, portability, android-sqlite, sqljet

有一个很棒的 Android 库，我想将它重用于桌面应用程序。

这个库中唯一特定于 Android 的部分是使用[android.database.sqlite](http://developer.android.com/reference/android/database/sqlite/package-summary.html)。

在这种情况下，最佳做法是什么？

*   替换所有调用以使用像[SQLJet](http://sqljet.com)这样的可移植纯 Java SQLite 包？
*   [将一些 SQLite Java 库](https://stackoverflow.com/questions/41233/java-and-sqlite)包装在 a 中`android.database.sqlite`并在不进行任何修改的情况下使用该库？
*   还有其他聪明的解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T01:59:39.947

首先，这对您的应用程序来说可能是多余的。

我的建议是将数据库调用抽象为接口。因此，对于需要 SQLite 的库的所有部分，请使用新接口，并实现一个“扩展”接口的“SQLite 数据库提供程序”，该接口调用 SQLite 方法。

我的建议是使用“依赖注入”将数据库部分注入到您的库中。

因此，当您在桌面应用程序中使用该库时，您可以简单地注入接口的不同实现（MySql 提供程序？），然后您就可以开始了。

这也将允许您随时注入任何其他数据库提供程序，而无需再次更改核心库代码。

# php - 访问使用 php zend-soap 创建的 Web 服务时出错

> ID：12083588
> 
> 赞同：0
> 
> 时间：2012-08-23T01:32:27.640
> 
> 标签：php, web-services, zend-framework, soap, infopath

我正在尝试将 InfoPath 表单与 PHP 一起使用。这就是为什么我在教程的帮助下使用zend 框架soap 库创建了一个Web 服务。

```
require("Zend/Soap/Server.php");
require("Zend/Soap/Wsdl.php");
require("Zend/Soap/Wsdl/Strategy/ArrayOfTypeComplex.php");
require("Zend/Soap/AutoDiscover.php");

$serviceURL = 'http://localhost/zendwebservice/';

class MyService {

    function GetCoupons($UserID) {
        // do some work here

    }
}

// Generate WSDL relevant to code
if (isset($_GET['wsdl']) || isset($_GET['WSDL'])){
    $autodiscover = new Zend_Soap_AutoDiscover('Zend_Soap_Wsdl_Strategy_ArrayOfTypeComplex');
    $autodiscover->setClass('MyService');
    $autodiscover->handle();
} else {
    $server = new Zend_Soap_Server($serviceURL . "?WSDL");
    $server->setClass('MyService');
    $server->setObject(new MyService());
    $server->handle();
} 
```

然后，我尝试使用 infopath 数据连接向导进行 Web 服务，但出现这些错误

```
InfoPath cannot find and cannot access the specified Web service description.

Details:
SoapMapper:The SoapMapper for element Array could not be created.
 - WSDLOperation:Initialization of a SoapMapper for operation GetCoupons failed. 
 - WSDLOperation:Initializing of the output message failed for operation GetCoupons. 
 - WSDLPort:An operation for port MyServicePort could not be initialized.
 - WSDLPort:Analyzing the binding information for port MyServicePort failed. 
 - WSDLService:Initialization of the port for service MyServiceService failed. 
 - WSDLReader:Analyzing the WSDL file failed. 
```

因为我是网络服务的新手，所以我无法弄清楚。感谢所有帮助。

# php - MySQL 或 PHP：链接两个字段，然后与另一个时间填充的字段进行比较

> ID：12083593
> 
> 赞同：0
> 
> 时间：2012-08-23T01:32:43.463
> 
> 标签：php, mysql

我对 MySQL 和 PHP 很陌生。通常我需要一些语言方面的帮助，然后我才能从那里开始。所以我真的很感谢我的第一个“复杂”问题的帮助。我有下面的数据库，其中包含有关网络的数据，并且每五分钟填充一次。MAC 地址是唯一真正静态的值，因为它附加到硬件（make），因此可以用作密钥。其他一切都可能发生变化。这是我的数据库的截断示例。有时每次有或多或少的行。

我一直在使用 PHP 前端来显示数据，我想添加的一个功能是比较列出的 IP，以及从最近一次到上次的 MAC-IP 对。如果与前一次相比，当前时间存在或不存在 IP，则获取这些行。此外，如果 MAC 切换到不同的 IP 或 IP 切换到不同的 MAC，也获取这些行。

基本上，这些是我用来获取数据以在 PHP 中显示的一些查询，但它们对于显示表中的内容非常基本。谢谢你，我很感激你的帮助。任何答案都会帮助我学到很多东西，在此之后我应该能够自己弄清楚更多。谢谢！

```
/* Get all results for Today's Date */
$result = mysql_query("SELECT * FROM hosts WHERE date = '$DateToday' ORDER BY date DESC,time DESC") or die('Error with mysql_query');

$CurrentLogTime = $row['time']; // Variable set to time field of first row.

/* Get all results for Today's Date and most recent log time. */
$result2 = mysql_query("SELECT * FROM hosts WHERE date = '$DateToday' and time = '$CurrentLogTime'") or die('Error with result2');

/* Get all results for Today's Date and previous log time. */
$result3 = mysql_query("SELECT * FROM hosts WHERE date = '$DateToday' and time = TIMEDIFF ('$CurrentLogTime', '00:05')") or die('Error with result3'); 
```

* * *

```
+------------+----------+----------------------+-------------------+------+------+----------------------+-------+------+--------+-------+------+
| date       | time     | ip                   | mac               | name | dns  | make                 | owner | note | status | specs | os   |
+------------+----------+----------------------+-------------------+------+------+----------------------+-------+------+--------+------+-------+
| 2012-08-22 | 00:00:00 | 192.168.30.1         | 00:00:00:00:00:00 | NULL | NULL | Supermicro Computer  | NULL  | NULL | NULL   | NULL  | NULL |
| 2012-08-22 | 00:00:00 | 192.168.30.10        | BB:BB:BB:BB:BB:BB | NULL | NULL | Generic Server       | NULL  | NULL | NULL   | NULL  | NULL |
| 2012-08-22 | 00:05:00 | 192.168.30.1         | 11:11:11:11:11:11 | NULL | NULL | Supermicro Computer  | NULL  | NULL | NULL   | NULL  | NULL |
| 2012-08-22 | 00:05:00 | 192.168.30.2         | 00:50:56:A4:52:5E | NULL | NULL | VMware               | NULL  | NULL | NULL   | NULL  | NULL |
| 2012-08-22 | 00:05:00 | 192.168.30.3         | 00:0A:9C:52:88:8C | NULL | NULL | Server Technology    | NULL  | NULL | NULL   | NULL  | NULL |
| 2012-08-22 | 00:05:00 | 192.168.30.10        | BB:BB:BB:BB:BB:BB | NULL | NULL | Generic Server       | NULL  | NULL | NULL   | NULL  | NULL | 
```

作为一个例子来澄清我想要做什么。我总是希望我的 HTML/PHP 前端显示最新日期和时间的行。如果我们使用上面的示例，我希望我的用户在浏览网页时看到 00:05 的所有行。这很容易。现在假设在 00:00，我将 MAC 00:00:00:00:00:00 与 192.168.30.1 配对。但是在 00:05，MAC 11:11:11:11:11:11 占用了 192.168.30.1。我想在我的 HTML 中突出显示该行。另外，假设在 00:00，当时唯一的 IP 是 192.168.30.1 和 192.168.30.10。但是在 00:05，不仅有 192.168.30.1 和 .10，而且还有 192.168.30.2 和 192.168.30.3。我想突出显示在 00:05 出现的新 IP 行。最后，我们看到 192.168.30.10 的 IP-MAC 对在两次之间是相同的。当我生成最终用户表时，我仍然想回应这一​​点，但我不想以任何方式突出显示它。所以最终的结果应该是一个类似这样的网页生成的网页，其中与上次不同的 IP-MAC 组合以粗体显示。

**| 2012-08-22 | 00:05:00 | 192.168.30.1 | 11:11:11:11:11:11 | 空 | 空 | 超微电脑 | 空 | 空 | 空 | 空 | 空 |**
**| 2012-08-22 | 00:05:00 | 192.168.30.2 | 00:50:56:A4:52:5E | 空 | 空 | 虚拟机 | 空 | 空 | 空 | 空 | 空 |**
**| 2012-08-22 | 00:05:00 | 192.168.30.3 | 00:0A:9C:52:88:8C | 空 | 空 | 服务器技术 | 空 | 空 | 空 | 空 | 空 |**
| 2012-08-22 | 00:05:00 | 192.168.30.10 | BB:BB:BB:BB:BB:BB | 空 | 空 | 通用服务器 | 空 | 空 | 空 | 空 | 空 |

而当谈到确定已更改的行时，我不知道是最好使用 MySQL 还是只获取最近两次更新的行并使用 PHP 来找出发生了什么变化？请记住，我的实际数据库每次将有超过 100 个条目。

从逻辑上讲，这里有一些关于我想要做的事情的更多细节。基本上，使用上面的示例，我想创建两个数组进行比较。我已经想出了如何将这两个字段连接起来进行比较，但是虽然我仍在研究，但我真的不知道从那里去哪里。这对我来说非常令人沮丧，因为我可以通过 shell 脚本轻松获得这些结果并将它们直接输入数据库。我试图在 PHP 和 MySQL 中做尽可能多的事情，但是让我的 shell 脚本解决这个问题的想法变得越来越有食欲。但基本上这就是我想要对上表做的事情，但我什至不知道最好使用 MySQL 还是 PHP 进行操作。>.<

```
Array1
mac               | ip
00:00:00:00:00:00 | 192.168.30.1
BB:BB:BB:BB:BB:BB | 192.168.30.10

Array2
mac               | ip
11:11:11:11:11:11 | 192.168.30.1
00:50:56:A4:52:5E | 192.168.30.2
00:0A:9C:52:88:8C | 192.168.30.3
BB:BB:BB:BB:BB:BB | 192.168.30.10 
```

WHERE Array1.ip == Array2.ip 或 Array1.mac == Array2.mac
执行
CONCAT Array1.ip,Array1.mac = Compare1 和 CONCAT Array2.ip,Array2.mac = Compare2
if Compare1 != Compare2
然后
将该行回显为大胆的

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T02:11:47.477

使用单独的`date`和`time`字段不会对您有太大帮助。如果有的话，你应该有一个单一的`datetime`，除非你需要按天做报告，在这种情况下，这`date`与创建适当的索引有关。请注意，尽量避免在内部 SQL 类型之后命名列。`date`可能`on_date`而且`time`可能`at_time`只是为了消除混乱。另外，在查询中使用这些内容时不必转义。

使用`datetime`名为的索引字段`created_At`允许您`ORDER BY created_at DESC`在尝试确定是否发生更改时可能是您想要的。

您还可以使用`BETWEEN`运算符选择日期时间值的范围，以检查特定时间间隔内的更改。

您的要求并不完全清楚，因此您可能必须更具体，或者尝试重新构建它，以便查询变得更加不言自明。

# ruby-on-rails - rails 成员路线

> ID：12083596
> 
> 赞同：4
> 
> 时间：2012-08-23T01:33:33.950
> 
> 标签：ruby-on-rails, routes

我正在创建一个应该有类似 url 的路线`http://mysite/cars/1/similar/`，这将获得所有与具有指定 id 的汽车相似的汽车（在本例中为 1）

我已经看到您可以使用语法在 routes.rb 文件中创建 rails 成员路由

```
resources :cars do
  member do
    get :similar
  end
end 
```

我也可以做类似的事情

```
match 'cars/:id/similar' => 'cars#similar', :via => "get 
```

这两种语法有什么区别

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-23T01:53:29.727

这两种方法是不等价的。

第一种方法产生一个`similar_car`辅助方法。第二种方法不行。

如果您打算执行以下操作，辅助方法很重要

```
= link_to "Similar", similar_car_path(@car) 
```

为了使它们等效，您必须提供一个`:as`选项：

```
get "cars/:id/similar" => "cars#similar", :as => "similar_car" 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-08-23T01:39:15.383

一种是在默认资源路由声明中统一，IMO 更容易找到。另一个不是，这可能导致拼写错误等。这没什么大不了的*，*但是对于 RESTful 操作，我宁愿使用足智多谋的机制。

您还可以使用单行版本，我更喜欢单行路线：

```
resources :cars do
  get :similar, :on => :member
end 
```

Meagar 是正确的，我忘记了匹配表单不会创建辅助方法。

# jquery - jQuery Ajax 问题

> ID：12083602
> 
> 赞同：0
> 
> 时间：2012-08-23T01:34:14.363
> 
> 标签：jquery, ajax

我正在为我的项目制作一个提示弹出窗口。当用户单击“打开提示”按钮时，提示窗口将显示在某些元素旁边。

我的问题是我从 ajax 创建的元素也需要在它们旁边显示提示窗口，如果用户在调用 ajax 之前单击按钮，这些元素将不会显示提示窗口，因为它们不存在。对这个问题有什么建议吗？非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T01:37:03.340

您可以使用`on()`充当`delegate`动态元素来绑定事件。下面，我将事件注册到现在或以后存在于上的`click`任何事件。`document``class``tips`

```
$(document).on('click','.tips', function(){
   // show tips;
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T01:36:46.303

我通过调用一个函数来解决此类问题`dommods()`。调用时，它会将我想要的任何效果应用于文档，例如工具提示。我只是在每次更改 DOM 后调用它，这样就解决了问题。

# ios - 为信用卡输入格式化 UITextField，例如 (xxxx xxxx xxxx xxxx)

> ID：12083605
> 
> 赞同：75
> 
> 时间：2012-08-23T01:35:27.080
> 
> 标签：ios, objective-c, swift, uitextfield, credit-card

我想格式化一个`UITextField`用于输入信用卡号码的格式，以便它只允许输入数字并自动插入空格，以便数字格式如下：

```
XXXX XXXX XXXX XXXX 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：145
> 
> 时间：2013-10-03T14:11:41.447

如果您使用的是 Swift，请阅读[我对 Swift 4 的这个答案的端口，](https://stackoverflow.com/a/48252437/1709587)然后改用它。

如果你在 Objective-C...

首先，在您的`UITextFieldDelegate`中，添加这些实例变量...

```
NSString *previousTextFieldContent;
UITextRange *previousSelection; 
```

...以及这些方法：

```
// Version 1.3
// Source and explanation: http://stackoverflow.com/a/19161529/1709587
-(void)reformatAsCardNumber:(UITextField *)textField
{
    // In order to make the cursor end up positioned correctly, we need to
    // explicitly reposition it after we inject spaces into the text.
    // targetCursorPosition keeps track of where the cursor needs to end up as
    // we modify the string, and at the end we set the cursor position to it.
    NSUInteger targetCursorPosition = 
        [textField offsetFromPosition:textField.beginningOfDocument
                           toPosition:textField.selectedTextRange.start];

    NSString *cardNumberWithoutSpaces = 
        [self removeNonDigits:textField.text
                  andPreserveCursorPosition:&targetCursorPosition];

    if ([cardNumberWithoutSpaces length] > 19) {
        // If the user is trying to enter more than 19 digits, we prevent 
        // their change, leaving the text field in  its previous state.
        // While 16 digits is usual, credit card numbers have a hard 
        // maximum of 19 digits defined by ISO standard 7812-1 in section
        // 3.8 and elsewhere. Applying this hard maximum here rather than
        // a maximum of 16 ensures that users with unusual card numbers
        // will still be able to enter their card number even if the
        // resultant formatting is odd.
        [textField setText:previousTextFieldContent];
        textField.selectedTextRange = previousSelection;
        return;
    }

    NSString *cardNumberWithSpaces = 
        [self insertCreditCardSpaces:cardNumberWithoutSpaces
           andPreserveCursorPosition:&targetCursorPosition];

    textField.text = cardNumberWithSpaces;
    UITextPosition *targetPosition = 
        [textField positionFromPosition:[textField beginningOfDocument]
                                 offset:targetCursorPosition];

    [textField setSelectedTextRange:
        [textField textRangeFromPosition:targetPosition
                              toPosition:targetPosition]
    ];
}

-(BOOL)textField:(UITextField *)textField 
         shouldChangeCharactersInRange:(NSRange)range 
                     replacementString:(NSString *)string
{
    // Note textField's current state before performing the change, in case
    // reformatTextField wants to revert it
    previousTextFieldContent = textField.text;
    previousSelection = textField.selectedTextRange;

    return YES;
}

/*
 Removes non-digits from the string, decrementing `cursorPosition` as
 appropriate so that, for instance, if we pass in `@"1111 1123 1111"`
 and a cursor position of `8`, the cursor position will be changed to
 `7` (keeping it between the '2' and the '3' after the spaces are removed).
 */
- (NSString *)removeNonDigits:(NSString *)string
                andPreserveCursorPosition:(NSUInteger *)cursorPosition 
{
    NSUInteger originalCursorPosition = *cursorPosition;
    NSMutableString *digitsOnlyString = [NSMutableString new];
    for (NSUInteger i=0; i<[string length]; i++) {
        unichar characterToAdd = [string characterAtIndex:i];
        if (isdigit(characterToAdd)) {
            NSString *stringToAdd = 
                [NSString stringWithCharacters:&characterToAdd
                                        length:1];

            [digitsOnlyString appendString:stringToAdd];
        }
        else {
            if (i < originalCursorPosition) {
                (*cursorPosition)--;
            }
        }
    }

    return digitsOnlyString;
}

/*
 Detects the card number format from the prefix, then inserts spaces into
 the string to format it as a credit card number, incrementing `cursorPosition`
 as appropriate so that, for instance, if we pass in `@"111111231111"` and a
 cursor position of `7`, the cursor position will be changed to `8` (keeping
 it between the '2' and the '3' after the spaces are added).
 */
- (NSString *)insertCreditCardSpaces:(NSString *)string
                          andPreserveCursorPosition:(NSUInteger *)cursorPosition
{
    // Mapping of card prefix to pattern is taken from
    // https://baymard.com/checkout-usability/credit-card-patterns

    // UATP cards have 4-5-6 (XXXX-XXXXX-XXXXXX) format
    bool is456 = [string hasPrefix: @"1"];

    // These prefixes reliably indicate either a 4-6-5 or 4-6-4 card. We treat all
    // these as 4-6-5-4 to err on the side of always letting the user type more
    // digits.
    bool is465 = [string hasPrefix: @"34"] ||
                 [string hasPrefix: @"37"] ||

                 // Diners Club
                 [string hasPrefix: @"300"] ||
                 [string hasPrefix: @"301"] ||
                 [string hasPrefix: @"302"] ||
                 [string hasPrefix: @"303"] ||
                 [string hasPrefix: @"304"] ||
                 [string hasPrefix: @"305"] ||
                 [string hasPrefix: @"309"] ||
                 [string hasPrefix: @"36"] ||
                 [string hasPrefix: @"38"] ||
                 [string hasPrefix: @"39"];

    // In all other cases, assume 4-4-4-4-3.
    // This won't always be correct; for instance, Maestro has 4-4-5 cards
    // according to https://baymard.com/checkout-usability/credit-card-patterns,
    // but I don't know what prefixes identify particular formats.
    bool is4444 = !(is456 || is465);

    NSMutableString *stringWithAddedSpaces = [NSMutableString new];
    NSUInteger cursorPositionInSpacelessString = *cursorPosition;
    for (NSUInteger i=0; i<[string length]; i++) {
        bool needs465Spacing = (is465 && (i == 4 || i == 10 || i == 15));
        bool needs456Spacing = (is456 && (i == 4 || i == 9 || i == 15));
        bool needs4444Spacing = (is4444 && i > 0 && (i % 4) == 0);

        if (needs465Spacing || needs456Spacing || needs4444Spacing) {
            [stringWithAddedSpaces appendString:@" "];
            if (i < cursorPositionInSpacelessString) {
                (*cursorPosition)++;
            }
        }
        unichar characterToAdd = [string characterAtIndex:i];
        NSString *stringToAdd =
        [NSString stringWithCharacters:&characterToAdd length:1];

        [stringWithAddedSpaces appendString:stringToAdd];
    }

    return stringWithAddedSpaces;
} 
```

其次，设置`reformatCardNumber:`为在文本字段触发`UIControlEventEditingChanged`事件时调用：

```
[yourTextField addTarget:yourTextFieldDelegate 
                             action:@selector(reformatAsCardNumber:)
                   forControlEvents:UIControlEventEditingChanged]; 
```

（当然，您需要在文本字段及其委托实例化后的某个时间点执行此操作。如果您使用情节提要，则`viewDidLoad`视图控制器的方法是一个合适的位置。

## 一些解释

这是一个看似复杂的问题。三个可能不是立即显而易见的重要问题（以及这里以前的答案都没有考虑到）：

1.  虽然`XXXX XXXX XXXX XXXX`信用卡和借记卡号码的格式是最常见的一种，但它并不是唯一的一种。例如，美国运通卡有 15 位数字，通常以`XXXX XXXXXX XXXXX`格式书写，如下所示：

    ![美国运通卡](../Images/828bd1dd1092b4793cd4a016b68eec4e.png)

    甚至 Visa 卡的位数也可以[少于](http://web.archive.org/web/20101201110138/http://visaeurope.com/en/businesses__retailers/retailers_and_merchants/training_your_staff/recognising_valid_visa_cards.aspx)16 位，而 Maestro 卡的位数可以更多：

    ![一张 18 位数字的俄罗斯大师卡](../Images/b9a5e830cae26196ee59c5f07593383c.png)

2.  用户可以通过更多方式与文本字段进行交互，而不仅仅是在现有输入的末尾键入单个字符。您还必须正确处理用户在字符串**中间添加字符、****删除**单个字符、删除多个选定字符以及**粘贴**多个字符。解决这个问题的一些更简单/更天真的方法将无法正确处理其中一些交互。最反常的情况是用户在字符串中间粘贴多个字符以替换其他字符，而这种解决方案足以应对这种情况。

3.  您不仅需要在用户修改后正确地重新格式化文本字段的文本 - 您还需要合理地定位**文本光标。**在某些情况下，不考虑这一点的问题的幼稚方法几乎肯定会最终对文本光标做一些愚蠢的事情（比如在用户在中间添加一个数字后将其放在文本字段的末尾）。

为了解决问题 #1，我们使用卡号前缀的部分映射到由 Baymard 研究所在[https://baymard.com/checkout-usability/credit-card-patterns](https://baymard.com/checkout-usability/credit-card-patterns)策划的格式。我们可以从前几位数字中自动检测卡提供商，并（在*某些*情况下）推断格式并相应地调整我们的格式。感谢[cnotethegr8](https://stackoverflow.com/users/278629/cnotethegr8)为这个答案贡献了这个想法。

处理问题*#2*（以及上面代码中使用的方法）的最简单和最简单的方法是在每次文本字段的内容发生变化时去掉所有空格并将它们重新插入到正确的位置，这样我们就不需要计算找出正在进行的文本操作（插入、删除或替换）的类型，并以不同的方式处理这些可能性。

为了处理问题*#3*，我们在删除非数字然后插入空格时跟踪光标的所需索引如何变化。这就是为什么代码相当冗长地使用 逐个字符地执行这些操作`NSMutableString`，而不是使用`NSString`的字符串替换方法。

最后，还有一个陷阱潜伏着：`NO`从`textField: shouldChangeCharactersInRange: replacementString`中断返回用户在文本字段中选择文本时获得的“剪切”按钮，这就是我不这样做的原因。从该方法返回`NO`导致“剪切”根本不更新剪贴板，而且我知道没有修复或解决方法。因此，我们需要在`UIControlEventEditingChanged`处理程序中重新格式化文本字段，而不是（更明显地）`shouldChangeCharactersInRange:`本身。

幸运的是，UIControl 事件处理程序似乎在 UI 更新刷新到屏幕之前被调用，因此这种方法可以正常工作。

还有一大堆关于文本字段应该如何表现的小问题没有明显的正确答案：

*   如果用户尝试粘贴会导致文本字段内容超过 19 位的内容，是否应该插入粘贴字符串的开头（直到达到 19 位）并裁剪其余部分，或者根本不插入任何内容?
*   如果用户试图通过将光标放在空格后面并按下退格键来删除单个空格，如果没有任何反应并且光标保持在原处，光标应该向左移动一个字符（将其放在空格之前），或者应该空格左侧的数字被删除，就好像光标已经离开了空格？
*   当用户键入第四位、第八位或第十二位时，是应该立即插入一个空格并将光标移到后面，还是应该在用户键入第五位、第九位或第十三位之后才插入空格？
*   当用户删除空格后的第一个数字时，如果这不会导致空格被完全删除，这应该导致他们的光标定位在空格之前还是之后？

可能对这些问题中的任何一个问题的任何答案都足够了，但我列出它们只是为了清楚地表明，如果你足够痴迷的话，实际上有很多特殊情况你可能需要在这里仔细考虑。在上面的代码中，我选择了对我来说似乎合理的这些问题的答案。如果您碰巧对这些与我的代码行为方式不兼容的任何一点有强烈的感觉，那么根据您的需要调整它应该很容易。

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2018-01-14T17:51:35.100

下面是[Logicopolis 答案的工作 Swift 4 端口（这又是我在 Objective-C 中](https://stackoverflow.com/a/37732709/1709587)[接受的答案](https://stackoverflow.com/a/19161529/1709587)的旧版本的 Swift 2 端口）增强了[cnotethegr8](https://stackoverflow.com/users/278629/cnotethegr8) 支持美国运通卡的技巧，然后进一步增强以支持更多卡格式。如果您还没有，我建议您查看已接受的答案，因为它有助于解释许多此代码背后的动机。

请注意，看到这一点所需的最少步骤是：

1.  在 Swift 中创建一个新的*单视图应用程序。*
2.  上`Main.storyboard`，添加一个*文本字段*。
3.  制作*Text Field*`ViewController`的代表。
**   将下面的代码粘贴到`ViewController.swift`.*   连接`IBOutlet`到*Text Field*。*   运行您的应用程序并在*Text Field*中输入。*

 ** * *

```
import UIKit

class ViewController: UIViewController, UITextFieldDelegate {
    private var previousTextFieldContent: String?
    private var previousSelection: UITextRange?
    @IBOutlet var yourTextField: UITextField!;

    override func viewDidLoad() {
        super.viewDidLoad()
        // Do any additional setup after loading the view, typically from a nib
        yourTextField.addTarget(self, action: #selector(reformatAsCardNumber), for: .editingChanged)
    }

    override func didReceiveMemoryWarning() {
        super.didReceiveMemoryWarning()
        // Dispose of any resources that can be recreated.
    }

    func textField(_ textField: UITextField, shouldChangeCharactersIn range: NSRange, replacementString string: String) -> Bool {
        previousTextFieldContent = textField.text;
        previousSelection = textField.selectedTextRange;
        return true
    }

    @objc func reformatAsCardNumber(textField: UITextField) {
        var targetCursorPosition = 0
        if let startPosition = textField.selectedTextRange?.start {
            targetCursorPosition = textField.offset(from: textField.beginningOfDocument, to: startPosition)
        }

        var cardNumberWithoutSpaces = ""
        if let text = textField.text {
            cardNumberWithoutSpaces = self.removeNonDigits(string: text, andPreserveCursorPosition: &targetCursorPosition)
        }

        if cardNumberWithoutSpaces.count > 19 {
            textField.text = previousTextFieldContent
            textField.selectedTextRange = previousSelection
            return
        }

        let cardNumberWithSpaces = self.insertCreditCardSpaces(cardNumberWithoutSpaces, preserveCursorPosition: &targetCursorPosition)
        textField.text = cardNumberWithSpaces

        if let targetPosition = textField.position(from: textField.beginningOfDocument, offset: targetCursorPosition) {
            textField.selectedTextRange = textField.textRange(from: targetPosition, to: targetPosition)
        }
    }

    func removeNonDigits(string: String, andPreserveCursorPosition cursorPosition: inout Int) -> String {
        var digitsOnlyString = ""
        let originalCursorPosition = cursorPosition

        for i in Swift.stride(from: 0, to: string.count, by: 1) {
            let characterToAdd = string[string.index(string.startIndex, offsetBy: i)]
            if characterToAdd >= "0" && characterToAdd <= "9" {
                digitsOnlyString.append(characterToAdd)
            }
            else if i < originalCursorPosition {
                cursorPosition -= 1
            }
        }

        return digitsOnlyString
    }

    func insertCreditCardSpaces(_ string: String, preserveCursorPosition cursorPosition: inout Int) -> String {
        // Mapping of card prefix to pattern is taken from
        // https://baymard.com/checkout-usability/credit-card-patterns

        // UATP cards have 4-5-6 (XXXX-XXXXX-XXXXXX) format
        let is456 = string.hasPrefix("1")

        // These prefixes reliably indicate either a 4-6-5 or 4-6-4 card. We treat all these
        // as 4-6-5-4 to err on the side of always letting the user type more digits.
        let is465 = [
            // Amex
            "34", "37",

            // Diners Club
            "300", "301", "302", "303", "304", "305", "309", "36", "38", "39"
        ].contains { string.hasPrefix($0) }

        // In all other cases, assume 4-4-4-4-3.
        // This won't always be correct; for instance, Maestro has 4-4-5 cards according
        // to https://baymard.com/checkout-usability/credit-card-patterns, but I don't
        // know what prefixes identify particular formats.
        let is4444 = !(is456 || is465)

        var stringWithAddedSpaces = ""
        let cursorPositionInSpacelessString = cursorPosition

        for i in 0..<string.count {
            let needs465Spacing = (is465 && (i == 4 || i == 10 || i == 15))
            let needs456Spacing = (is456 && (i == 4 || i == 9 || i == 15))
            let needs4444Spacing = (is4444 && i > 0 && (i % 4) == 0)

            if needs465Spacing || needs456Spacing || needs4444Spacing {
                stringWithAddedSpaces.append(" ")

                if i < cursorPositionInSpacelessString {
                    cursorPosition += 1
                }
            }

            let characterToAdd = string[string.index(string.startIndex, offsetBy:i)]
            stringWithAddedSpaces.append(characterToAdd)
        }

        return stringWithAddedSpaces
    }
} 
```

将此适应其他情况 - 例如您的代表不是 a `ViewController`- 留给读者作为练习。

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2012-08-23T04:00:58.757

您可能可以优化我的代码，或者可能有更简单的方法，但这段代码应该可以工作：

```
-(BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string {

    __block NSString *text = [textField text];

    NSCharacterSet *characterSet = [NSCharacterSet characterSetWithCharactersInString:@"0123456789\b"];
    string = [string stringByReplacingOccurrencesOfString:@" " withString:@""];
    if ([string rangeOfCharacterFromSet:[characterSet invertedSet]].location != NSNotFound) {
        return NO;
    }

    text = [text stringByReplacingCharactersInRange:range withString:string];
    text = [text stringByReplacingOccurrencesOfString:@" " withString:@""];

    NSString *newString = @"";
    while (text.length > 0) {
        NSString *subString = [text substringToIndex:MIN(text.length, 4)];
        newString = [newString stringByAppendingString:subString];
        if (subString.length == 4) {
            newString = [newString stringByAppendingString:@" "];
        }
        text = [text substringFromIndex:MIN(text.length, 4)];
    }

    newString = [newString stringByTrimmingCharactersInSet:[characterSet invertedSet]];

    if (newString.length >= 20) {
        return NO;
    }

    [textField setText:newString];

    return NO;
} 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2016-11-04T12:57:21.517

**使用**Fawkes**回答作为基本的**Swift 3解决方案。**添加了美国运通卡格式支持。当卡片类型改变时增加了改革。**

 **首先使用以下代码创建新类：

```
extension String {

    func containsOnlyDigits() -> Bool
    {

        let notDigits = NSCharacterSet.decimalDigits.inverted

        if rangeOfCharacter(from: notDigits, options: String.CompareOptions.literal, range: nil) == nil
        {
            return true
        }

        return false
    }
}
import UIKit

var creditCardFormatter : CreditCardFormatter
{
    return CreditCardFormatter.sharedInstance
}

class CreditCardFormatter : NSObject
{
    static let sharedInstance : CreditCardFormatter = CreditCardFormatter()

    func formatToCreditCardNumber(isAmex: Bool, textField : UITextField, withPreviousTextContent previousTextContent : String?, andPreviousCursorPosition previousCursorSelection : UITextRange?) {
        var selectedRangeStart = textField.endOfDocument
        if textField.selectedTextRange?.start != nil {
            selectedRangeStart = (textField.selectedTextRange?.start)!
        }
        if  let textFieldText = textField.text
        {
            var targetCursorPosition : UInt = UInt(textField.offset(from:textField.beginningOfDocument, to: selectedRangeStart))
            let cardNumberWithoutSpaces : String = removeNonDigitsFromString(string: textFieldText, andPreserveCursorPosition: &targetCursorPosition)
            if cardNumberWithoutSpaces.characters.count > 19
            {
                textField.text = previousTextContent
                textField.selectedTextRange = previousCursorSelection
                return
            }
            var cardNumberWithSpaces = ""
            if isAmex {
                cardNumberWithSpaces = insertSpacesInAmexFormat(string: cardNumberWithoutSpaces, andPreserveCursorPosition: &targetCursorPosition)
            }
            else
            {
                cardNumberWithSpaces = insertSpacesIntoEvery4DigitsIntoString(string: cardNumberWithoutSpaces, andPreserveCursorPosition: &targetCursorPosition)
            }
            textField.text = cardNumberWithSpaces
            if let finalCursorPosition = textField.position(from:textField.beginningOfDocument, offset: Int(targetCursorPosition))
            {
                textField.selectedTextRange = textField.textRange(from: finalCursorPosition, to: finalCursorPosition)
            }
        }
    }

    func removeNonDigitsFromString(string : String, andPreserveCursorPosition cursorPosition : inout UInt) -> String {
        var digitsOnlyString : String = ""
        for index in stride(from: 0, to: string.characters.count, by: 1)
        {
            let charToAdd : Character = Array(string.characters)[index]
            if isDigit(character: charToAdd)
            {
                digitsOnlyString.append(charToAdd)
            }
            else
            {
                if index < Int(cursorPosition)
                {
                    cursorPosition -= 1
                }
            }
        }
        return digitsOnlyString
    }

    private func isDigit(character : Character) -> Bool
    {
        return "\(character)".containsOnlyDigits()
    }

    func insertSpacesInAmexFormat(string : String, andPreserveCursorPosition cursorPosition : inout UInt) -> String {
        var stringWithAddedSpaces : String = ""
        for index in stride(from: 0, to: string.characters.count, by: 1)
        {
            if index == 4
            {
                stringWithAddedSpaces += " "
                if index < Int(cursorPosition)
                {
                    cursorPosition += 1
                }
            }
            if index == 10 {
                stringWithAddedSpaces += " "
                if index < Int(cursorPosition)
                {
                    cursorPosition += 1
                }
            }
            if index < 15 {
               let characterToAdd : Character = Array(string.characters)[index]
                stringWithAddedSpaces.append(characterToAdd)
            }
        }
        return stringWithAddedSpaces
    }

    func insertSpacesIntoEvery4DigitsIntoString(string : String, andPreserveCursorPosition cursorPosition : inout UInt) -> String {
        var stringWithAddedSpaces : String = ""
        for index in stride(from: 0, to: string.characters.count, by: 1)
        {
            if index != 0 && index % 4 == 0 && index < 16
            {
                stringWithAddedSpaces += " "

                if index < Int(cursorPosition)
                {
                    cursorPosition += 1
                }
            }
            if index < 16 {
                let characterToAdd : Character = Array(string.characters)[index]
                stringWithAddedSpaces.append(characterToAdd)
            }
        }
        return stringWithAddedSpaces
    }

} 
```

在您的 ViewControllerClass 添加此功能

```
func reformatAsCardNumber(textField:UITextField){
  let formatter = CreditCardFormatter()
  var isAmex = false
  if selectedCardType == "AMEX" {
    isAmex = true
    }
  formatter.formatToCreditCardNumber(isAmex: isAmex, textField: textField, withPreviousTextContent: textField.text, andPreviousCursorPosition: textField.selectedTextRange)
} 
```

然后将目标添加到您的文本字段

```
youtTextField.addTarget(self, action: #selector(self.reformatAsCardNumber(textField:)), for: UIControlEvents.editingChanged) 
```

注册新变量并向其发送卡片类型

```
var selectedCardType: String? {
  didSet{
    reformatAsCardNumber(textField: yourTextField)
  }
} 
```

感谢 Fawkes 的代码！

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2013-01-25T22:17:23.190

我觉得这个不错：

```
-(BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string
    {

        NSLog(@"%@",NSStringFromRange(range));

        // Only the 16 digits + 3 spaces
        if (range.location == 19) {
            return NO;
        }

        // Backspace
        if ([string length] == 0)
            return YES;

        if ((range.location == 4) || (range.location == 9) || (range.location == 14))
        {

            NSString *str    = [NSString stringWithFormat:@"%@ ",textField.text];
            textField.text   = str;
        }

        return YES;
    } 
```

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2017-07-25T08:24:36.797

所以我想用更少的代码来做这个，所以我在[这里](https://stackoverflow.com/a/34455435)使用了代码并稍微改变了它的用途。我在屏幕上有两个字段，一个是数字，一个是到期日期，所以我让它更易于重复使用。

**斯威夫特 3 替代答案**

```
func textField(_ textField: UITextField, shouldChangeCharactersIn range: NSRange, replacementString string: String) -> Bool {
    guard let currentText = (textField.text as NSString?)?.replacingCharacters(in: range, with: string) else { return true }

    if textField == cardNumberTextField {
        textField.text = currentText.grouping(every: 4, with: " ")
        return false
    }
    else { // Expiry Date Text Field
        textField.text = currentText.grouping(every: 2, with: "/")
        return false
    }
}

extension String {
    func grouping(every groupSize: String.IndexDistance, with separator: Character) -> String {
       let cleanedUpCopy = replacingOccurrences(of: String(separator), with: "")
       return String(cleanedUpCopy.characters.enumerated().map() {
            $0.offset % groupSize == 0 ? [separator, $0.element] : [$0.element]
       }.joined().dropFirst())
    }
} 
```

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2016-03-17T06:51:36.400

```
func textField(textField: UITextField, shouldChangeCharactersInRange range: NSRange, replacementString string: String) -> Bool
    {
        if textField == CardNumTxt
        {
            let replacementStringIsLegal = string.rangeOfCharacterFromSet(NSCharacterSet(charactersInString: "0123456789").invertedSet) == nil

            if !replacementStringIsLegal
            {
                return false
            }

            let newString = (textField.text! as NSString).stringByReplacingCharactersInRange(range, withString: string)
            let components = newString.componentsSeparatedByCharactersInSet(NSCharacterSet(charactersInString: "0123456789").invertedSet)

            let decimalString = components.joinWithSeparator("") as NSString
            let length = decimalString.length
            let hasLeadingOne = length > 0 && decimalString.characterAtIndex(0) == (1 as unichar)

            if length == 0 || (length > 16 && !hasLeadingOne) || length > 19
            {
                let newLength = (textField.text! as NSString).length + (string as NSString).length - range.length as Int

                return (newLength > 16) ? false : true
            }
            var index = 0 as Int
            let formattedString = NSMutableString()

            if hasLeadingOne
            {
                formattedString.appendString("1 ")
                index += 1
            }
            if length - index > 4
            {
                let prefix = decimalString.substringWithRange(NSMakeRange(index, 4))
                formattedString.appendFormat("%@-", prefix)
                index += 4
            }

            if length - index > 4
            {
                let prefix = decimalString.substringWithRange(NSMakeRange(index, 4))
                formattedString.appendFormat("%@-", prefix)
                index += 4
            }
            if length - index > 4
            {
                let prefix = decimalString.substringWithRange(NSMakeRange(index, 4))
                formattedString.appendFormat("%@-", prefix)
                index += 4
            }

            let remainder = decimalString.substringFromIndex(index)
            formattedString.appendString(remainder)
            textField.text = formattedString as String
            return false
        }
        else
        {
            return true
        }
    } 
```

formattedString.appendFormat("%@-", prefix) chage of "-" 任何其他你选择

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2020-03-09T17:20:08.577

在斯威夫特 5 中：

```
func textField(_ textField: UITextField, shouldChangeCharactersIn range: NSRange, replacementString string: String) -> Bool {
        if textField == cardNumberTextField {
            return formatCardNumber(textField: textField, shouldChangeCharactersInRange: range, replacementString: string)
        }
        return true
    }

    func formatCardNumber(textField: UITextField, shouldChangeCharactersInRange range: NSRange, replacementString string: String) -> Bool {
        if textField == cardNumberTextField {
            let replacementStringIsLegal = string.rangeOfCharacter(from: NSCharacterSet(charactersIn: "0123456789").inverted) == nil

            if !replacementStringIsLegal {
                return false
            }

            let newString = (textField.text! as NSString).replacingCharacters(in: range, with: string)
            let components = newString.components(separatedBy: NSCharacterSet(charactersIn: "0123456789").inverted)
            let decimalString = components.joined(separator: "") as NSString
            let length = decimalString.length
            let hasLeadingOne = length > 0 && decimalString.character(at: 0) == (1 as unichar)

            if length == 0 || (length > 16 && !hasLeadingOne) || length > 19 {
                let newLength = (textField.text! as NSString).length + (string as NSString).length - range.length as Int

                return (newLength > 16) ? false : true
            }
            var index = 0 as Int
            let formattedString = NSMutableString()

            if hasLeadingOne {
                formattedString.append("1 ")
                index += 1
            }
            if length - index > 4 {
                let prefix = decimalString.substring(with: NSRange(location: index, length: 4))
                formattedString.appendFormat("%@ ", prefix)
                index += 4
            }

            if length - index > 4 {
                let prefix = decimalString.substring(with: NSRange(location: index, length: 4))
                formattedString.appendFormat("%@ ", prefix)
                index += 4
            }
            if length - index > 4 {
                let prefix = decimalString.substring(with: NSRange(location: index, length: 4))
                formattedString.appendFormat("%@ ", prefix)
                index += 4
            }

            let remainder = decimalString.substring(from: index)
            formattedString.append(remainder)
            textField.text = formattedString as String
            return false
        } else {
            return true
        }
    } 
```

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2016-06-09T17:34:47.037

Swift 2 中公认答案的另一个版本......

确保您的委托实例中有这些：

```
private var previousTextFieldContent: String?
private var previousSelection: UITextRange? 
```

并确保您的文本字段调用重新格式化AsCardNumber：

```
textField.addTarget(self, action: #selector(reformatAsCardNumber(_:)), forControlEvents: .EditingChanged) 
```

您的文本字段委托将需要这样做：

```
func textField(textField: UITextField, shouldChangeCharactersInRange range: NSRange, replacementString string: String) -> Bool {
    previousTextFieldContent = textField.text;
    previousSelection = textField.selectedTextRange;
    return true
} 
```

最后包括以下方法：

```
func reformatAsCardNumber(textField: UITextField) {
    var targetCursorPosition = 0
    if let startPosition = textField.selectedTextRange?.start {
        targetCursorPosition = textField.offsetFromPosition(textField.beginningOfDocument, toPosition: startPosition)
    }

    var cardNumberWithoutSpaces = ""
    if let text = textField.text {
        cardNumberWithoutSpaces = self.removeNonDigits(text, andPreserveCursorPosition: &targetCursorPosition)
    }

    if cardNumberWithoutSpaces.characters.count > 19 {
        textField.text = previousTextFieldContent
        textField.selectedTextRange = previousSelection
        return
    }

    let cardNumberWithSpaces = self.insertSpacesEveryFourDigitsIntoString(cardNumberWithoutSpaces, andPreserveCursorPosition: &targetCursorPosition)
    textField.text = cardNumberWithSpaces

    if let targetPosition = textField.positionFromPosition(textField.beginningOfDocument, offset: targetCursorPosition) {
        textField.selectedTextRange = textField.textRangeFromPosition(targetPosition, toPosition: targetPosition)
    }
}

func removeNonDigits(string: String, inout andPreserveCursorPosition cursorPosition: Int) -> String {
    var digitsOnlyString = ""
    let originalCursorPosition = cursorPosition

    for i in 0.stride(to: string.characters.count, by: 1) {
        let characterToAdd = string[string.startIndex.advancedBy(i)]
        if characterToAdd >= "0" && characterToAdd <= "9" {
            digitsOnlyString.append(characterToAdd)
        }
        else if i < originalCursorPosition {
            cursorPosition -= 1
        }
    }

    return digitsOnlyString
}

func insertSpacesEveryFourDigitsIntoString(string: String, inout andPreserveCursorPosition cursorPosition: Int) -> String {
    var stringWithAddedSpaces = ""
    let cursorPositionInSpacelessString = cursorPosition

    for i in 0.stride(to: string.characters.count, by: 1) {
        if i > 0 && (i % 4) == 0 {
            stringWithAddedSpaces.appendContentsOf(" ")
            if i < cursorPositionInSpacelessString {
                cursorPosition += 1
            }
        }
        let characterToAdd = string[string.startIndex.advancedBy(i)]
        stringWithAddedSpaces.append(characterToAdd)
    }

    return stringWithAddedSpaces
} 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2015-10-01T18:20:41.333

这是一个 Swift 版本，以防这对仍在寻找此答案但使用 Swift 而不是 Objective-C 的任何人有用。无论如何，概念仍然相同。

```
func textField(textField: UITextField, shouldChangeCharactersInRange range: NSRange, replacementString string: String) -> Bool
{
    //range.length will be greater than 0 if user is deleting text - allow it to replace
    if range.length > 0
    {
        return true
    }

    //Don't allow empty strings
    if string == " "
    {
        return false
    }

    //Check for max length including the spacers we added
    if range.location == 20
    {
        return false
    }

    var originalText = textField.text
    let replacementText = string.stringByReplacingOccurrencesOfString(" ", withString: "")

    //Verify entered text is a numeric value
    let digits = NSCharacterSet.decimalDigitCharacterSet()
    for char in replacementText.unicodeScalars
    {
        if !digits.longCharacterIsMember(char.value)
        {
            return false
        }
    }

    //Put an empty space after every 4 places
    if originalText!.length() % 5 == 0
    {
        originalText?.appendContentsOf(" ")
        textField.text = originalText
    }

    return true
} 
```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2017-04-18T22:14:22.433

为了达到格式化文本字段中输入的文本的目的，以这种方式 XXXX XXXX XXXX XXXX 很重要，要记住一些重要的事情。除了每四位分隔的 16 位卡号是最常用的格式之外，还有 15 位的卡号（AmEx 格式为 XXXX XXXXXX XXXXX）和其他 13 位甚至 19 位的卡（[https://en. wikipedia.org/wiki/Payment_card_number](https://en.wikipedia.org/wiki/Payment_card_number) ）。您应该考虑的其他重要事项是将 textField 配置为仅允许数字，将键盘类型配置为 numberPad 是一个好的开始，但便于实现保护输入的方法。

一个起点是决定何时要格式化数字，而用户正在输入数字或用户何时离开文本字段。如果您想在用户离开 textField 时进行格式化，可以方便地使用 textFieldDidEndEditing(_:) 委托的方法获取 textField 的内容并对其进行格式化。

如果您在用户输入数字时很有用，则 textField(_:shouldChangeCharactersIn:replacementString:) 委托方法会在当前文本更改时调用。

在这两种情况下仍然存在问题，找出输入号码的正确格式，恕我直言，根据我看到的所有号码，只有两种主要格式：上述 15 位数字的美国运通格式和格式化哪个组卡号每四位数不关心有多少位数，这种情况就像一个通用规则，例如一张13位数的卡将被格式化为XXXXX XXXX XXXX X，而19位数的卡将看起来像这样XXXX XXXX XXXX XXXX XXX，这将适用于最常见的情况（16 位）和其他情况。所以你可以弄清楚如何使用下面的相同算法来管理 AmEx 案例。

在其他特定格式的情况下，我使用 RegEx 确保 15 位数字卡是美国运通卡

```
let regex = NSPredicate(format: "SELF MATCHES %@", "3[47][A-Za-z0-9*-]{13,}" )
let isAmex = regex.evaluate(with: stringToValidate) 
```

我强烈建议使用特定的 RegEx，它有助于识别发行人并确定应该接受多少位数。

现在我使用 textFieldDidEndEditing 的快速解决方案是

```
func textFieldDidEndEditing(_ textField: UITextField) {

    _=format(cardNumber: textField.text!)

}
func format(cardNumber:String)->String{
    var formatedCardNumber = ""
    var i :Int = 0
    //loop for every character
    for character in cardNumber.characters{
        //in case you want to replace some digits in the middle with * for security
        if(i < 6 || i >= cardNumber.characters.count - 4){
            formatedCardNumber = formatedCardNumber + String(character)
        }else{
            formatedCardNumber = formatedCardNumber + "*"
        }
        //insert separators every 4 spaces(magic number)
        if(i == 3 || i == 7 || i == 11 || (i == 15 && cardNumber.characters.count > 16 )){
            formatedCardNumber = formatedCardNumber + "-"
            // could use just " " for spaces
        }

        i = i + 1
    }
    return formatedCardNumber
} 
```

对于 shouldChangeCharactersIn:replacementString: a Swift 3.0 来自 Jayesh Miruliya 的回答，在四个字符组之间放置一个分隔符

```
 func textField(textField: UITextField, shouldChangeCharactersInRange range: NSRange, replacementString string: String) -> Bool
    {
        if textField == CardNumTxt
        {
            let replacementStringIsLegal = string.rangeOfCharacter(from: CharacterSet(charactersIn: "0123456789").inverted) == nil

        if !replacementStringIsLegal
        {
            return false
        }

        let newString = (textField.text! as NSString).replacingCharacters(in: range, with: string)
        let components = newString.components(separatedBy: CharacterSet(charactersIn: "0123456789").inverted)

        let decimalString = components.joined(separator: "") as NSString
        let length = decimalString.length
        let hasLeadingOne = length > 0 && decimalString.character(at: 0) == (1 as unichar)

        if length == 0 || (length > 16 && !hasLeadingOne) || length > 19
        {
            let newLength = (textField.text! as NSString).length + (string as NSString).length - range.length as Int

            return (newLength > 16) ? false : true
        }
        var index = 0 as Int
        let formattedString = NSMutableString()

        if hasLeadingOne
        {
            formattedString.append("1 ")
            index += 1
        }
        if length - index > 4 //magic number separata every four characters
        {
            let prefix = decimalString.substring(with: NSMakeRange(index, 4))
            formattedString.appendFormat("%@-", prefix)
            index += 4
        }

        if length - index > 4
        {
            let prefix = decimalString.substring(with: NSMakeRange(index, 4))
            formattedString.appendFormat("%@-", prefix)
            index += 4
        }
        if length - index > 4
        {
            let prefix = decimalString.substring(with: NSMakeRange(index, 4))
            formattedString.appendFormat("%@-", prefix)
            index += 4
        }

        let remainder = decimalString.substring(from: index)
        formattedString.append(remainder)
        textField.text = formattedString as String
        return false
        }
        else
        {
            return true
        }
    } 
```

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2017-10-18T13:43:25.100

**斯威夫特 3.2**

swift 3.2 中的@Lucas 答案和工作代码几乎没有更正。还会自动删除空格字符。

```
func textField(_ textField: UITextField, shouldChangeCharactersIn range: NSRange, replacementString string: String) -> Bool {

    if range.location == 19 {
        return false
    }

    if range.length == 1 {
        if (range.location == 5 || range.location == 10 || range.location == 15) {
            let text = textField.text ?? ""
            textField.text = text.substring(to: text.index(before: text.endIndex))
        }
        return true
    }

    if (range.location == 4 || range.location == 9 || range.location == 14) {
        textField.text = String(format: "%@ ", textField.text ?? "")
    }

    return true
} 
```

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2014-11-26T06:08:27.770

定义下面的方法并在 UITextfield 委托或任何需要的地方调用它

```
-(NSString*)processString :(NSString*)yourString
{
    if(yourString == nil){
        return @"";
    }
    int stringLength = (int)[yourString length];
    int len = 4;  // Length after which you need to place added character
    NSMutableString *str = [NSMutableString string];
    int i = 0;
    for (; i < stringLength; i+=len) {
        NSRange range = NSMakeRange(i, len);
        [str appendString:[yourString substringWithRange:range]];
        if(i!=stringLength -4){
            [str appendString:@" "]; //If required string format is XXXX-XXXX-XXXX-XXX then just replace [str appendString:@"-"]
        }
    }
    if (i < [str length]-1) {  // add remaining part
        [str appendString:[yourString substringFromIndex:i]];
    }
    //Returning required string

    return str;
} 
```

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2020-08-19T20:11:52.140

这是[Mark Amery 接受的答案的](https://stackoverflow.com/questions/12083605/formatting-a-uitextfield-for-credit-card-input-like-xxxx-xxxx-xxxx-xxxx/19161529#19161529)**Swift 5**版本。

在您的类中添加这些变量：

```
@IBOutlet weak var cardNumberTextField: UITextField!
private var previousTextFieldContent: String?
private var previousSelection: UITextRange? 
```

还要确保您的文本字段调用`reformatAsCardNumber`: from `viewDidLoad()`:

```
cardNumberTextField.addTarget(self, action: #selector(reformatAsCardNumber), for: .editingChanged) 
```

将此添加到您的`UITextFieldDelegate`：

```
func textField(_ textField: UITextField, shouldChangeCharactersIn range: NSRange, replacementString string: String) -> Bool {

    if textField == cardNumberTextField {
        previousTextFieldContent = textField.text;
        previousSelection = textField.selectedTextRange;
    }

    return true
} 
```

最后在您的 中包含以下方法`viewController`：

```
@objc func reformatAsCardNumber(textField: UITextField) {
    var targetCursorPosition = 0
    if let startPosition = textField.selectedTextRange?.start {
        targetCursorPosition = textField.offset(from: textField.beginningOfDocument, to: startPosition)
    }

    var cardNumberWithoutSpaces = ""
    if let text = textField.text {
        cardNumberWithoutSpaces = self.removeNonDigits(string: text, andPreserveCursorPosition: &targetCursorPosition)
    }

    if cardNumberWithoutSpaces.count > 19 {
        textField.text = previousTextFieldContent
        textField.selectedTextRange = previousSelection
        return
    }

    let cardNumberWithSpaces = self.insertSpacesEveryFourDigitsIntoString(string: cardNumberWithoutSpaces, andPreserveCursorPosition: &targetCursorPosition)
    textField.text = cardNumberWithSpaces

    if let targetPosition = textField.position(from: textField.beginningOfDocument, offset: targetCursorPosition) {
        textField.selectedTextRange = textField.textRange(from: targetPosition, to: targetPosition)
    }
}

func removeNonDigits(string: String, andPreserveCursorPosition cursorPosition: inout Int) -> String {
    var digitsOnlyString = ""
    let originalCursorPosition = cursorPosition

    for i in Swift.stride(from: 0, to: string.count, by: 1) {
        let characterToAdd = string[string.index(string.startIndex, offsetBy: i)]
        if characterToAdd >= "0" && characterToAdd <= "9" {
            digitsOnlyString.append(characterToAdd)
        }
        else if i < originalCursorPosition {
            cursorPosition -= 1
        }
    }

    return digitsOnlyString
}

func insertSpacesEveryFourDigitsIntoString(string: String, andPreserveCursorPosition cursorPosition: inout Int) -> String {
    var stringWithAddedSpaces = ""
    let cursorPositionInSpacelessString = cursorPosition

    for i in Swift.stride(from: 0, to: string.count, by: 1) {
        if i > 0 && (i % 4) == 0 {
            stringWithAddedSpaces.append(contentsOf: " ")
            if i < cursorPositionInSpacelessString {
                cursorPosition += 1
            }
        }
        let characterToAdd = string[string.index(string.startIndex, offsetBy: i)]
        stringWithAddedSpaces.append(characterToAdd)
    }

    return stringWithAddedSpaces
} 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2019-07-22T06:26:50.527

**斯威夫特 5.1，Xcode 11**

在尝试了许多解决方案之后，我遇到了设置正确的光标位置和根据需要格式化等问题，在结合2个帖子（[https://stackoverflow.com/a/38838740/10579134，https://stackoverflow](https://stackoverflow.com/a/38838740/10579134) [. com/a/45297778/10579134](https://stackoverflow.com/a/45297778/10579134) )

```
func textField(_ textField: UITextField, shouldChangeCharactersIn range: NSRange, replacementString string: String) -> Bool {
    guard let currentText = (textField.text as NSString?)?.replacingCharacters(in: range, with: string) else { return true }

    if textField == yourTextField  {

        textField.setText(to: currentText.grouping(every: 4, with: "-"), preservingCursor: true)

        return false
    }
    return true
} 
```

并添加此扩展

```
extension UITextField {

public func setText(to newText: String, preservingCursor: Bool) {
    if preservingCursor {
        let cursorPosition = offset(from: beginningOfDocument, to: selectedTextRange!.start) + newText.count - (text?.count ?? 0)
        text = newText
        if let newPosition = self.position(from: beginningOfDocument, offset: cursorPosition) {
            selectedTextRange = textRange(from: newPosition, to: newPosition)
        }
    }
    else {
        text = newText
    }
} 
```

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2016-10-23T13:24:41.707

基于[Mark Amery 的 Objective-C 解决方案的](https://stackoverflow.com/a/19161529/1709587)Swift 3 解决方案：

1.  实现动作和委托方法：

    ```
    textField.addTarget(self, action: #selector(reformatAsCardNumber(_:))
    textField.delegate = self 
    ```

2.  TextField 委托方法和其他方法：

    ```
    func textField(_ textField: UITextField, shouldChangeCharactersIn range: NSRange, replacementString string: String) -> Bool {
        previousTextFieldContent = textField.text;
        previousSelection = textField.selectedTextRange;
        return true
    }

    func reformatAsCardNumber(_ textField: UITextField) {
        var targetCursorPosition = 0
        if let startPosition = textField.selectedTextRange?.start {
            targetCursorPosition = textField.offset(from:textField.beginningOfDocument, to: startPosition)
        }

        var cardNumberWithoutSpaces = ""
        if let text = textField.text {
            cardNumberWithoutSpaces = removeNonDigits(string: text, andPreserveCursorPosition: &targetCursorPosition)
        }

        if cardNumberWithoutSpaces.characters.count > 19 {
            textField.text = previousTextFieldContent
            textField.selectedTextRange = previousSelection
            return
        }

        let cardNumberWithSpaces = self.insertSpacesEveryFourDigitsIntoString(string: cardNumberWithoutSpaces, andPreserveCursorPosition: &targetCursorPosition)
        textField.text = cardNumberWithSpaces

        if let targetPosition = textField.position(from: textField.beginningOfDocument, offset: targetCursorPosition) {
            textField.selectedTextRange = textField.textRange(from: targetPosition, to: targetPosition)
        }
    }

    func removeNonDigits(string: String, andPreserveCursorPosition cursorPosition: inout Int) -> String {
        var digitsOnlyString = ""
        let originalCursorPosition = cursorPosition

        for i in stride(from: 0, to: string.characters.count, by: 1) {
            let characterToAdd =  string[string.index(string.startIndex, offsetBy: i)]
            if characterToAdd >= "0" && characterToAdd <= "9" {
                digitsOnlyString.append(characterToAdd)
            }
            else if i < originalCursorPosition {
                cursorPosition -= 1
            }
        }

        return digitsOnlyString
    }

    func insertSpacesEveryFourDigitsIntoString(string: String, andPreserveCursorPosition cursorPosition: inout Int) -> String {
        var stringWithAddedSpaces = ""
        let cursorPositionInSpacelessString = cursorPosition

        for i in stride(from: 0, to: string.characters.count, by: 1) {
            if i > 0 && (i % 4) == 0 {
                stringWithAddedSpaces.append(" ")
                if i < cursorPositionInSpacelessString {
                    cursorPosition += 1
                }
            }
            let characterToAdd = string[string.index(string.startIndex, offsetBy: i)]
            stringWithAddedSpaces.append(characterToAdd)
        }

        return stringWithAddedSpaces
    } 
    ```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2018-07-05T18:07:13.213

这是基于[Mark Amery](https://stackoverflow.com/questions/12083605/formatting-a-uitextfield-for-credit-card-input-like-xxxx-xxxx-xxxx-xxxx/19161529#19161529)的 Kotlin 答案：

```
fun formatCardNumber(cardNumber: String): String {
    var trimmedCardNumber = cardNumber.replace(" ","")

    // UATP cards have 4-5-6 (XXXX-XXXXX-XXXXXX) format
    val is456 = trimmedCardNumber.startsWith("1")

    // These prefixes reliably indicate either a 4-6-5 or 4-6-4 card. We treat all these
    // as 4-6-5-4 to err on the side of always letting the user type more digits.
    val is465 = listOf("34", "37", "300", "301", "302", "303", "304", "305", "309", "36", "38", "39")
            .any { trimmedCardNumber.startsWith(it) }

    // In all other cases, assume 4-4-4-4.
    val is4444 = !(is456 || is465)

    trimmedCardNumber = if (is456 || is465) {
         trimmedCardNumber.take(cardNumberMaxLengthAmex)
    } else {
         trimmedCardNumber.take(cardNumberMaxLength)
    }

    var cardNumberWithAddedSpaces = ""

    trimmedCardNumber.forEachIndexed { index, c ->
        val needs465Spacing = is465 && (index == 4 || index == 10 || index == 15)
        val needs456Spacing = is456 && (index == 4 || index == 9 || index == 15)
        val needs4444Spacing = is4444 && index > 0 && index % 4 == 0

        if (needs465Spacing || needs456Spacing || needs4444Spacing) {
            cardNumberWithAddedSpaces += " "
        }

        cardNumberWithAddedSpaces += c
    }

    return cardNumberWithAddedSpaces
} 
```

然后在编辑文本上添加一个文本更改侦听器：

```
var flag = false

editText.addTextChangedListener(object : TextWatcher {
        override fun beforeTextChanged(s: CharSequence?, start: Int, count: Int, after: Int) {}

        override fun onTextChanged(s: CharSequence?, start: Int, before: Int, count: Int) {
            if (flag) { 
                flag = false 
            } else {
                val text = formatCardNumber(s.toString())
                flag = true
                editText.setText(text)
                editText.setSelection(text.count())
            }
        }

        override fun afterTextChanged(s: Editable?) {}
    }) 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2016-05-07T16:29:54.043

这是已接受答案的快速副本。它基本上是一个包装类：

```
var creditCardFormatter : CreditCardFormatter
{
    return CreditCardFormatter.sharedInstance
}

class CreditCardFormatter : NSObject
{
    static let sharedInstance : CreditCardFormatter = CreditCardFormatter()

    func formatToCreditCardNumber(textField : UITextField, withPreviousTextContent previousTextContent : String?, andPreviousCursorPosition previousCursorSelection : UITextRange?)
    {
        if let selectedRangeStart = textField.selectedTextRange?.start, textFieldText = textField.text
        {
            var targetCursorPosition : UInt = UInt(textField.offsetFromPosition(textField.beginningOfDocument, toPosition: selectedRangeStart))

            let cardNumberWithoutSpaces : String = removeNonDigitsFromString(textFieldText, andPreserveCursorPosition: &targetCursorPosition)

            if cardNumberWithoutSpaces.characters.count > 19
            {
                textField.text = previousTextContent
                textField.selectedTextRange = previousCursorSelection
                return
            }

            let cardNumberWithSpaces : String = insertSpacesIntoEvery4DigitsIntoString(cardNumberWithoutSpaces, andPreserveCursorPosition: &targetCursorPosition)

            textField.text = cardNumberWithSpaces

            if let finalCursorPosition = textField.positionFromPosition(textField.beginningOfDocument, offset: Int(targetCursorPosition))
            {
                textField.selectedTextRange = textField.textRangeFromPosition(finalCursorPosition, toPosition: finalCursorPosition)
            }
        }
    }

    func removeNonDigitsFromString(string : String,inout andPreserveCursorPosition cursorPosition : UInt) -> String
    {
        var digitsOnlyString : String = ""

        for index in 0.stride(to: string.characters.count, by: 1)
        {
            let charToAdd : Character = Array(string.characters)[index]

            if isDigit(charToAdd)
            {
                digitsOnlyString.append(charToAdd)
            }
            else
            {
                if index < Int(cursorPosition)
                {
                    cursorPosition -= 1
                }
            }
        }

        return digitsOnlyString
    }

    private func isDigit(character : Character) -> Bool
    {
        return "\(character)".containsOnlyDigits()
    }

    func insertSpacesIntoEvery4DigitsIntoString(string : String, inout andPreserveCursorPosition cursorPosition : UInt) -> String
    {
        var stringWithAddedSpaces : String = ""

        for index in 0.stride(to: string.characters.count, by: 1)
        {
            if index != 0 && index % 4 == 0
            {
                stringWithAddedSpaces += " "

                if index < Int(cursorPosition)
                {
                    cursorPosition += 1
                }
            }

            let characterToAdd : Character = Array(string.characters)[index]

            stringWithAddedSpaces.append(characterToAdd)
        }

        return stringWithAddedSpaces
    }

}

extension String
{
    func containsOnlyDigits() -> Bool
    {
        let notDigits : NSCharacterSet = NSCharacterSet.decimalDigitCharacterSet().invertedSet

        if (rangeOfCharacterFromSet(notDigits, options: NSStringCompareOptions.LiteralSearch, range: nil) == nil)
        {
            return true
        }

        return false
    }
} 
```

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2020-03-16T21:49:12.230

你可以使用我的简单库：[DECardNumberFormatter](https://github.com/Darkngs/DECardNumberFormatter)

**例子：**

```
// You can use it like default UITextField
let textField = DECardNumberTextField()
// Custom required setup
textField.setup() 
```

**输出：**

```
For sample card number (Visa) 4111111111111111
Format (4-4-4-4): 4111 1111 1111 1111

For sample card number (AmEx) 341212345612345
Format (4-6-5): 3412 123456 12345 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2015-04-30T07:55:53.817

查看此解决方案。我在[Autorize.net SDK](https://github.com/AuthorizeNet/sdk-ios)示例中找到。

将您的`UITextField`键盘类型设置为`Numeric`.

它将用“X”掩盖信用卡号，并通过添加空格来制作`'XXXX XXXX XXXX 1234'`格式。

> 在头 .h 文件中

```
 #define kSpace @" "
    #define kCreditCardLength 16
    #define kCreditCardLengthPlusSpaces (kCreditCardLength + 3)
    #define kCreditCardObscureLength (kCreditCardLength - 4)

    @property (nonatomic, strong) NSString *creditCardBuf;
    IBOutlet UITextField *txtCardNumber; 
```

> 在 .m 文件中

```
- (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string
{
    if (textField == txtCardNumber) {
        if ([string length] > 0) { //NOT A BACK SPACE Add it

            if ([self isMaxLength:textField])
                return NO;

            self.creditCardBuf  = [NSString stringWithFormat:@"%@%@", self.creditCardBuf, string];
        } else {

            //Back Space do manual backspace
            if ([self.creditCardBuf length] > 1) {
                self.creditCardBuf = [self.creditCardBuf substringWithRange:NSMakeRange(0, [self.creditCardBuf length] - 1)];
            } else {
                self.creditCardBuf = @"";
            }
        }
        [self formatValue:textField];
    }

    return NO;
}

- (BOOL) isMaxLength:(UITextField *)textField {

    if (textField == txtCardNumber && [textField.text length] >= kCreditCardLengthPlusSpaces) {
        return YES;
    }
    return NO;
}

- (void) formatValue:(UITextField *)textField {
    NSMutableString *value = [NSMutableString string];

    if (textField == txtCardNumber) {
        NSInteger length = [self.creditCardBuf length];

        for (int i = 0; i < length; i++) {

            // Reveal only the last character.
            if (length <= kCreditCardObscureLength) {

                if (i == (length - 1)) {
                    [value appendString:[self.creditCardBuf substringWithRange:NSMakeRange(i,1)]];
                } else {
                    [value appendString:@“X”];
                }
            }
            // Reveal the last 4 characters
            else {

                if (i < kCreditCardObscureLength) {
                    [value appendString:@“X”];
                } else {
                    [value appendString:[self.creditCardBuf substringWithRange:NSMakeRange(i,1)]];
                }
            }

            //After 4 characters add a space
            if ((i +1) % 4 == 0 &&
                ([value length] < kCreditCardLengthPlusSpaces)) {
                [value appendString:kSpace];
            }
        }
        textField.text = value;
    }
} 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2018-05-23T12:36:14.063

创建新的 swift 文件并粘贴以下代码，将文本字段类更改为 VSTextField

```
import UIKit

public enum TextFieldFormatting {
    case uuid
    case socialSecurityNumber
    case phoneNumber
    case custom
    case noFormatting
}

public class VSTextField: UITextField {

    /**
     Set a formatting pattern for a number and define a replacement string. For example: If formattingPattern would be "##-##-AB-##" and
     replacement string would be "#" and user input would be "123456", final string would look like "12-34-AB-56"
     */
    public func setFormatting(_ formattingPattern: String, replacementChar: Character) {
        self.formattingPattern = formattingPattern
        self.replacementChar = replacementChar
        self.formatting = .custom
    }

    /**
     A character which will be replaced in formattingPattern by a number
     */
    public var replacementChar: Character = "*"

    /**
     A character which will be replaced in formattingPattern by a number
     */
    public var secureTextReplacementChar: Character = "\u{25cf}"

    /**
     True if input number is hexadecimal eg. UUID
     */
    public var isHexadecimal: Bool {
        return formatting == .uuid
    }

    /**
     Max length of input string. You don't have to set this if you set formattingPattern.
     If 0 -> no limit.
     */
    public var maxLength = 0

    /**
     Type of predefined text formatting. (You don't have to set this. It's more a future feature)
     */
    public var formatting : TextFieldFormatting = .noFormatting {
        didSet {
            switch formatting {

            case .socialSecurityNumber:
                self.formattingPattern = "***-**-****"
                self.replacementChar = "*"

            case .phoneNumber:
                self.formattingPattern = "***-***-****"
                self.replacementChar = "*"

            case .uuid:
                self.formattingPattern = "********-****-****-****-************"
                self.replacementChar = "*"

            default:
                self.maxLength = 0
            }
        }
    }

    /**
     String with formatting pattern for the text field.
     */
    public var formattingPattern: String = "" {
        didSet {
            self.maxLength = formattingPattern.count
        }
    }

    /**
     Provides secure text entry but KEEPS formatting. All digits are replaced with the bullet character \u{25cf} .
     */
    public var formatedSecureTextEntry: Bool {
        set {
            _formatedSecureTextEntry = newValue
            super.isSecureTextEntry = false
        }

        get {
            return _formatedSecureTextEntry
        }
    }

    override public var text: String! {
        set {
            super.text = newValue
            textDidChange() // format string properly even when it's set programatically
        }

        get {
            if case .noFormatting = formatting {
                return super.text
            } else {
                // Because the UIControl target action is called before NSNotificaion (from which we fire our custom formatting), we need to
                // force update finalStringWithoutFormatting to get the latest text. Otherwise, the last character would be missing.
                textDidChange()
                return finalStringWithoutFormatting
            }
        }
    }

    required public init?(coder aDecoder: NSCoder) {
        super.init(coder: aDecoder)
        registerForNotifications()
    }

    override init(frame: CGRect) {
        super.init(frame: frame)
        registerForNotifications()
    }

    deinit {
        NotificationCenter.default.removeObserver(self)
    }

    /**
     Final text without formatting characters (read-only)
     */
    public var finalStringWithoutFormatting : String {
        return _textWithoutSecureBullets.keepOnlyDigits(isHexadecimal: isHexadecimal)
    }

    // MARK: - INTERNAL
    fileprivate var _formatedSecureTextEntry = false

    // if secureTextEntry is false, this value is similar to self.text
    // if secureTextEntry is true, you can find final formatted text without bullets here
    fileprivate var _textWithoutSecureBullets = ""

    fileprivate func registerForNotifications() {
        NotificationCenter.default.addObserver(self,
                                               selector: #selector(VSTextField.textDidChange),
                                               name: NSNotification.Name(rawValue: "UITextFieldTextDidChangeNotification"),
                                               object: self)
    }

    @objc public func textDidChange() {
        var superText: String { return super.text ?? "" }

        // TODO: - Isn't there more elegant way how to do this?
        let currentTextForFormatting: String

        if superText.count > _textWithoutSecureBullets.count {
            currentTextForFormatting = _textWithoutSecureBullets + superText[superText.index(superText.startIndex, offsetBy: _textWithoutSecureBullets.count)...]
        } else if superText.count == 0 {
            _textWithoutSecureBullets = ""
            currentTextForFormatting = ""
        } else {
            currentTextForFormatting = String(_textWithoutSecureBullets[..<_textWithoutSecureBullets.index(_textWithoutSecureBullets.startIndex, offsetBy: superText.count)])
        }

        if formatting != .noFormatting && currentTextForFormatting.count > 0 && formattingPattern.count > 0 {
            let tempString = currentTextForFormatting.keepOnlyDigits(isHexadecimal: isHexadecimal)

            var finalText = ""
            var finalSecureText = ""

            var stop = false

            var formatterIndex = formattingPattern.startIndex
            var tempIndex = tempString.startIndex

            while !stop {
                let formattingPatternRange = formatterIndex ..< formattingPattern.index(formatterIndex, offsetBy: 1)
                if formattingPattern[formattingPatternRange] != String(replacementChar) {

                    finalText = finalText + formattingPattern[formattingPatternRange]
                    finalSecureText = finalSecureText + formattingPattern[formattingPatternRange]

                } else if tempString.count > 0 {

                    let pureStringRange = tempIndex ..< tempString.index(tempIndex, offsetBy: 1)

                    finalText = finalText + tempString[pureStringRange]

                    // we want the last number to be visible
                    if tempString.index(tempIndex, offsetBy: 1) == tempString.endIndex {
                        finalSecureText = finalSecureText + tempString[pureStringRange]
                    } else {
                        finalSecureText = finalSecureText + String(secureTextReplacementChar)
                    }

                    tempIndex = tempString.index(after: tempIndex)
                }

                formatterIndex = formattingPattern.index(after: formatterIndex)

                if formatterIndex >= formattingPattern.endIndex || tempIndex >= tempString.endIndex {
                    stop = true
                }
            }

            _textWithoutSecureBullets = finalText

            let newText = _formatedSecureTextEntry ? finalSecureText : finalText
            if newText != superText {
                super.text = _formatedSecureTextEntry ? finalSecureText : finalText
            }
        }

        // Let's check if we have additional max length restrictions
        if maxLength > 0 {
            if superText.count > maxLength {
                super.text = String(superText[..<superText.index(superText.startIndex, offsetBy: maxLength)])
                _textWithoutSecureBullets = String(_textWithoutSecureBullets[..<_textWithoutSecureBullets.index(_textWithoutSecureBullets.startIndex, offsetBy: maxLength)])
            }
        }
    }
}

extension String {

    func keepOnlyDigits(isHexadecimal: Bool) -> String {
        let ucString = self.uppercased()
        let validCharacters = isHexadecimal ? "0123456789ABCDEF" : "0123456789"
        let characterSet: CharacterSet = CharacterSet(charactersIn: validCharacters)
        let stringArray = ucString.components(separatedBy: characterSet.inverted)
        let allNumbers = stringArray.joined(separator: "")
        return allNumbers
    }
}

// Helpers
fileprivate func < <T: Comparable>(lhs: T?, rhs: T?) -> Bool {
    switch (lhs, rhs) {
    case let (l?, r?):
        return l < r
    case (nil, _?):
        return true
    default:
        return false
    }
}

fileprivate func > <T: Comparable>(lhs: T?, rhs: T?) -> Bool {
    switch (lhs, rhs) {
    case let (l?, r?):
        return l > r
    default:
        return rhs < lhs
    }
} 
```

更多用途将在以下链接中找到：

*   [http://vojtastavik.com/2015/03/29/real-time-formatting-in-uitextfield-swift-basics/](http://vojtastavik.com/2015/03/29/real-time-formatting-in-uitextfield-swift-basics/)
*   [https://github.com/VojtaStavik/VSTextField](https://github.com/VojtaStavik/VSTextField)

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2016-11-13T16:40:04.600

我修改了@ilesh 答案，所以无论长度如何，它都只显示最后 4 位数字。还要忽略空格和“-”字符。这样，如果我们有一个格式为 0000 - 0000 - 0000 - 0000 的数字，它会显示 XXXX - XXXX - XXXX - 0000

```
func setStringAsCardNumberWithSartNumber(Number:Int,withString str:String) -> String{
    let arr = str.characters
    var CrediteCard : String = ""
    let len = str.characters.count-4
    if arr.count > (Number + len) {
        for (index, element ) in arr.enumerated(){
            if index >= Number && index < (Number + len) && element != "-" && element != " " {
                CrediteCard = CrediteCard + String("X")
            }else{
                CrediteCard = CrediteCard + String(element)
            }
        }
        return CrediteCard
    }else{
        print("\(Number) plus \(len) are grether than strings chatarter \(arr.count)")
    }
    print("\(CrediteCard)")
    return str
} 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2016-12-19T09:17:33.927

以下是来自@sleeping_giant 的快速修改答案。此解决方案将文本格式化为`xxxx-xxxx-xxxx-xxxx-xxxx`format 并停止接受超出该范围的任何数字：

```
func textField(_ textField: UITextField, shouldChangeCharactersIn range: NSRange, replacementString string: String) -> Bool
{
    if string == ""{
        return true
    }

    //range.length will be greater than 0 if user is deleting text - allow it to replace
    if range.length > 0
    {
        return true
    }

    //Don't allow empty strings
    if string == "-"
    {
        return false
    }

    //Check for max length including the spacers we added
    print(range.location)
    if range.location > 23
    {
        return false
    }

    var originalText = textField.text
    let replacementText = string.replacingOccurrences(of: "-", with: "")

    //Verify entered text is a numeric value
    let digits = NSCharacterSet.decimalDigits
    for char in replacementText.unicodeScalars
    {
        if !(digits as NSCharacterSet).longCharacterIsMember(char.value)
        {
            return false
        }
    }

    //Put an empty space after every 4 places
    if (originalText?.characters.count)! > 0
    {
        if (originalText?.characters.count)! < 5 && (originalText?.characters.count)! % 4 == 0{
            originalText?.append("-")
        }else if(((originalText?.characters.count)! + 1) % 5 == 0){
            originalText?.append("-")
        }

    }

    textField.text = originalText

    return true
} 
```

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2016-08-08T21:24:17.353

这是 Swift 2.2.1 中的解决方案

```
extension UITextField {

    func setText(to newText: String, preservingCursor: Bool) {
        if preservingCursor {
            let cursorPosition = offsetFromPosition(beginningOfDocument, toPosition: selectedTextRange!.start) + newText.characters.count - (text?.characters.count ?? 0)
            text = newText
            if let newPosition = positionFromPosition(beginningOfDocument, offset: cursorPosition) {
                selectedTextRange = textRangeFromPosition(newPosition, toPosition: newPosition)
            }
        }
        else {
            text = newText
        }
    }
} 
```

现在只需在您的视图控制器中放置一个 IBAction：

```
@IBAction func textFieldEditingChanged(sender: UITextField) {
    var digits = current.componentsSeparatedByCharactersInSet(NSCharacterSet.decimalDigitCharacterSet().invertedSet).joinWithSeparator("") // remove non-digits
    // add spaces as necessary or otherwise format your digits.
    // for example for a phone number or zip code or whatever
    // then just:
    sender.setText(to: digits, preservingCursor: true)
} 
```

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2022-02-11T15:38:42.260

您可以使用`StringPatternFormatter`吊舱：

```
pod 'StringPatternFormatter' 
```

`UITextField`需要从以下方法实现`UITextFieldDelegate`：

```
import StringPatternFormatter

...

textField.delegate = self

...

func textField(_ textField: UITextField, shouldChangeCharactersIn range: NSRange, replacementString string: String) -> Bool {
    guard let text = textField.text else {
        return true
    }

    let lastText = (text as NSString).replacingCharacters(in: range, with: string) as String

    textField.text = lastText.format("nnnn nnnn nnnn nnnn", oldString: text)
    return false
} 
```

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2017-02-20T21:30:24.763

在 Github 中找到了一个 GIST，这正是我在 Swift3 中所需要的（[https://gist.github.com/nunogoncalves/6a8b4b21f4f69e0fc050190df96a1e56](https://gist.github.com/nunogoncalves/6a8b4b21f4f69e0fc050190df96a1e56)）

通过做实现->

```
if creditCardNumberTextView.text?.characters.first == "3" {
    let validator = Validator(cardType: .americanExpress, value:  self.creditCardNumberTextView.text!).test()

      if validator == true {

       } else {

       }
   } 
```

在我正在开发的使用信用卡的 APP 中运行良好。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2017-02-21T05:42:44.337

就我而言，我们必须格式化 IBAN 号码。我认为，下面的代码块可以帮助你

首先，检查用户输入的值是否有效：

```
-(BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string{

    if(textField == self.ibanTextField){

           BOOL shouldChange =  ([Help checkTextFieldForIBAN:[NSString stringWithFormat:@"%@%@",textField.text,string]]);
 }
} 
```

其次，您可以看到如下所示的 iban 格式化方法。我们的 IBAN 格式以 2 个字母开头。

```
+(BOOL)checkTextFieldForIBAN:(NSString*)string{

    string = [string stringByReplacingOccurrencesOfString:@" " withString:@""];

    if ([string length] <= 26) {

        if ([string length] > 2) {

            if ([self isLetter:[string substringToIndex:2]]) {

                if ([self isInteger:[string substringFromIndex:2]])
                    return YES;
                else
                    return NO;

            }else {

                return NO;
            }
        }else{

            return [self isLetter:string];
        }

    }
    else {

        return NO;
    }

    return YES;
} 
```

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2016-09-20T07:38:07.240

请检查下面的解决方案，它对我来说工作正常 -

```
func textField(textField: UITextField, shouldChangeCharactersInRange range: NSRange, replacementString string: String) -> Bool {

        let subString = (textField.text as! NSString).substringWithRange(range)
        if subString == " " && textField == cardNumberTextfield
        {
            return false     // user should not be able to delete space from card field
        }
        else if string == ""
        {
            return true      // user can delete any digit
        }

        // Expiry date formatting

        if textField == expiryDateTextfield
        {
            let str = textField.text! + string

            if str.length == 2 && Int(str) > 12
            {
                return false                  // Month should be <= 12
            }
            else if str.length == 2
            {
                textField.text = str+"/"      // append / after month
                return false
            }
            else if str.length > 5
            {
                return false                  // year should be in yy format
            }
        }

        // Card number formatting

        if textField == cardNumberTextfield
        {
            let str = textField.text! + string

            let stringWithoutSpace = str.stringByReplacingOccurrencesOfString(" ", withString: "")

            if stringWithoutSpace.length % 4 == 0 && (range.location == textField.text?.length)
            {
                if stringWithoutSpace.length != 16
                {
                    textField.text = str+" "    // add space after every 4 characters
                }
                else
                {
                    textField.text = str       // space should not be appended with last digit
                }

                return false
            }
            else if str.length > 19
            {
                return false
            }
        }

        return true
    } 
```

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2016-09-13T14:04:51.797

请使用信用卡的简单形式 /** 请参见示例用法：### let str = "41111111111111111"

```
 let x = yourClassname.setStringAsCardNumberWithSartNumber(4, withString: str!, withStrLenght: 8)

 ### output:- 4111XXXXXXXX1111

 let x = yourClassname.setStringAsCardNumberWithSartNumber(0, withString: str!, withStrLenght: 12)

 ### output: - XXXXXXXXXXXX1111

 */
func setStringAsCardNumberWithSartNumber(Number:Int,withString str:String ,withStrLenght len:Int ) -> String{
    //let aString: String = "41111111111111111"
    let arr = str.characters
    var CrediteCard : String = ""
    if arr.count > (Number + len) {
        for (index, element ) in arr.enumerate(){
            if index >= Number && index < (Number + len) {
                CrediteCard = CrediteCard + String("X")
            }else{
                CrediteCard = CrediteCard + String(element)
            }
        }
      return CrediteCard
    }else{
            print("\(Number) plus \(len) are grether than strings chatarter \(arr.count)")
    }
    print("\(CrediteCard)")
    return str
} 
```***

# php - UNION表查询错误数据

> ID：12083607
> 
> 赞同：0
> 
> 时间：2012-08-23T01:35:49.827
> 
> 标签：php, mysql, union

我是使用 UNION 命令添加 2 个查询表的新 mySQL 用户。联合工作，但如果它们具有相同的 ID，则结果会重复。如果我通过 phpMyAdmin 删除或更改 ID，您会看到该条目。例子：'

```
My day | today | 12:00
My day | today | 12:00 
```

并更改ID：

```
OK day | other | 12:01
My day | today | 12:00 
```

和 PHP 代码

```
$query = "SELECT id,title,day,time 
          FROM $db_1 
          UNION 
          SELECT id,title,day,time 
          FROM $db_2 
          WHERE month='$month' AND year='$year' ORDER BY time" ;enter code here
$query_result = mysql_query ($query);
while ($info = mysql_fetch_array($query_result))

{
$day = $info['day'];
$event_id = $info['id'];
$events[$day][] = $info['id'];
$event_info[$event_id]['0'] = substr($info['title'], 0, 8);;
$event_info[$event_id]['1'] = $info['time'];
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T01:40:37.843

这应该为您解决问题：

```
select distinct *
from
(
    SELECT 
        id,
        title,
        day,
        time 
    FROM 
        $db_1 
    UNION ALL
    SELECT 
        id,
        title,
        day,
        time 
    FROM 
        $db_2 
    WHERE 
        month='$month' 
        AND year='$year' 
)
ORDER BY time 
```

虽然可以使用 group by，但效率较低。我在下面的查询中遇到了麻烦，最后运行了一些统计信息，因为第一个查询在大约 10 秒内返回，第二个查询在半秒内返回。

不同之处在于，使用 group by 将在子查询中引入文件排序，在我的情况下这会导致所有问题：

```
mysql> EXPLAIN select
    ->  a.mCode as cCode,
    ->  a.mName as cName
    -> from
    ->  _user_UserStructure a
    -> where
    ->  a.pCode in
    ->  (
    ->          select
    ->                  b.pCode
    ->          from
    ->                  _user_userStructure b
    ->          where
    ->                  b.mCode='RBM1'
    ->                  and b.pCode!=b.cCode
    ->          group by
    ->                  b.pCode
    ->  )
    ->  and a.cCode != ''
    ->  and a.pCode != a.mCode
    ->  and a.mCode!='RBM1'
    -> group by
    ->  a.mCode,
    ->  a.mName
    -> order by
    ->  a.mName asc;
+----+--------------------+-------+-------+---------------+-------+---------+------+------+----------------------------------------------+

| id | select_type        | table | type  | possible_keys | key   | key_len | ref  | rows | Extra                                        |

+----+--------------------+-------+-------+---------------+-------+---------+------+------+----------------------------------------------+

|  1 | PRIMARY            | a     | ALL   | cCode         | NULL  | NULL    | NULL | 1769 | Using where; Using temporary; Using filesort |

|  2 | DEPENDENT SUBQUERY | b     | index | NULL          | pCode | 13      | NULL |    2 | Using where; Using filesort                  |

+----+--------------------+-------+-------+---------------+-------+---------+------+------+----------------------------------------------+

2 rows in set (0.00 sec)

mysql> EXPLAIN select distinct
    ->  a.mCode as cCode,
    ->  a.mName as cName
    -> from
    ->  _user_UserStructure a
    -> where
    ->  a.pCode in
    ->  (
    ->          select distinct
    ->                  b.pCode
    ->          from
    ->                  _user_userStructure b
    ->          where
    ->                  b.mCode='RBM1'
    ->                  and b.pCode!=b.cCode
    ->  )
    ->  and a.cCode != ''
    ->  and a.pCode != a.mCode
    ->  and a.mCode!='RBM1'
    -> order by
    ->  a.mName asc;
+----+--------------------+-------+----------------+---------------+-------+---------+------+------+----------------------------------------------+

| id | select_type        | table | type           | possible_keys | key   | key_len | ref  | rows | Extra                                        |

+----+--------------------+-------+----------------+---------------+-------+---------+------+------+----------------------------------------------+

|  1 | PRIMARY            | a     | ALL            | cCode         | NULL  | NULL    | NULL | 1769 | Using where; Using temporary; Using filesort |

|  2 | DEPENDENT SUBQUERY | b     | index_subquery | pCode         | pCode | 13      | func |    2 | Using where                                  |

+----+--------------------+-------+----------------+---------------+-------+---------+------+------+----------------------------------------------+

2 rows in set (0.00 sec) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T01:39:54.590

你可以使用 GROUP BY

```
SELECT * from 
(SELECT id,title,day,time FROM $db_1 
 UNION 
 SELECT id,title,day,time FROM $db_2 
 WHERE month='$month' AND year='$year' ORDER BY time) m
GROUP BY id 
```

# android - Xtify Cordova 插件在注册期间挂起“inProgress”错误

> ID：12083613
> 
> 赞同：0
> 
> 时间：2012-08-23T01:36:45.030
> 
> 标签：android, push, cordova, xtify

我刚刚为 android 安装了 Xtify Cordova 插件。遵循实施指南后，我无法注册新用户。它卡在“进行中”错误上。

这是 deviceready 事件函数：

```
var onDeviceReady=function()
{    
    // Xtify stuff
    // Start Xtify
    window.plugins.XtifySDK.start(notificationCallBack,
        function (error)
        {
            console.log("Error occurred while starting Xtify SDK.");
        });

    // get the xid
    window.plugins.XtifySDK.getXid(function(xid)
        {
            console.log('XID is: ' + xid );
        },
        function(error)
        {
        console.log("Error: " + error);
        });

    // test for registration success
    window.plugins.XtifySDK.isRegistered(function()
        {
            console.log("device is registered");
        },
        function (errorId)
        {
            if (errorId == "inProgress")
            {
                console.log("Registration in progress.");
            }
            else
            {
                console.log("Error: " + errorId);
            }
        });
}; 
```

返回的错误只是“进行中”。此外，我尝试在 isRegistered() 函数上设置 1、2 和 5 秒的超时，但无济于事。在正确注册之前尝试获取 xid 会记录以下内容：“错误：XID 在设备注册之前不可用”。最后一件事。我确实尽可能地追溯了错误，这是 Xtify 本身。插件的一切似乎都是犹太洁食。

有人知道我错在哪里了吗？我仔细检查了实施指南，但这些说明中的某个地方一定是问题所在。提前致谢！

鲍勃

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T01:43:25.707

Bob，我认为您的 javascript 部分没有包含 Xtify 完成注册所需的所有功能。重新构建您的示例应用程序后，我能够注册并接收到您的应用程序的推送。

# c# - 在 C# 中，如何输出 Dictionary 类的内容？

> ID：12083616
> 
> 赞同：0
> 
> 时间：2012-08-23T01:36:53.247
> 
> 标签：c#, dictionary

在 C# 中，如何输出 Dictionary 类的内容？

一旦你加载了一个带有键和值的 Dictionary 类，我如何循环它们并在 foreach 循环中输出各个值？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T02:03:16.603

If you just want to output them you dont need a [foreach](http://msdn.microsoft.com/en-us/library/ttw7t8t6%28VS.80%29.aspx) loop.
You can use LINQ [ForEach](http://msdn.microsoft.com/en-us/library/bwabdf9z.aspx):

```
myDictionary.ToList().ForEach(x => Console.WriteLine(x.Key + " : " + x.Value)); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-23T01:39:53.833

[这是来自http://www.dotnetperls.com/dictionary](http://www.dotnetperls.com/dictionary)的示例

```
using System;
using System.Collections.Generic;

class Program
{
    static void Main()
    {
    // Example Dictionary again
    Dictionary<string, int> d = new Dictionary<string, int>()
    {
        {"cat", 2},
        {"dog", 1},
        {"llama", 0},
        {"iguana", -1}
    };
    // Loop over pairs with foreach
    foreach (KeyValuePair<string, int> pair in d)
    {
        Console.WriteLine("{0}, {1}",
        pair.Key,
        pair.Value);
    }
    // Use var keyword to enumerate dictionary
    foreach (var pair in d)
    {
        Console.WriteLine("{0}, {1}",
        pair.Key,
        pair.Value);
    }
    }
} 
```

最后一个循环使用*var*来声明 KeyValuePair 对象。这种方式更容易，因为您不必担心声明字典中使用的类型，并为 CLR 生成相同的结果。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-23T01:39:39.190

```
foreach (KeyValuePair<string, int> pair in myDictionary)
{
    Console.WriteLine("{0}, {1}",
    pair.Key,
    pair.Value);
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-23T03:18:54.270

尝试这个

```
Dictionary<object, object> dummyDictionary = new Dictionary<object, object>
            {
                {"India","Delhi"},
                {"USA","WashingtonDC"},
                {"Bangaladesh","Dhaka"},
                {"Pakistan","Karachi"}
            }; 
```

**//foreach循环构造**

```
foreach (KeyValuePair<object, object> kvp in dummyDictionary)
{
  Console.WriteLine(string.Format("Key = {0}  Value = {1}", kvp.Key, kvp.Value));
} 
```

**//使用 Linq 和 Foreach 扩展方法**

```
var result =
             (from kvp in dummyDictionary
              select new
              {
                Key = kvp.Key
                ,
                 Value = kvp.Value
              });
result.ToList().ForEach(kvp => Console.WriteLine(string.Format("Key = {0}  Value = {1}", kvp.Key, kvp.Value)));

Console.ReadKey(); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-23T01:41:09.253

```
foreach(var key in pair.Keys){
   Console.WriteLine("{0} - {1}", key, pair[key]);      
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-23T02:09:36.440

你是什​​么意思，说出*并输出个人价值观*？您是否希望只看​​到独特的价值？

```
 Dictionary<string, string> dict = new Dictionary<string, string>
        {
            {"1","one"},
            {"2","two"},
            {"3","three"},
            {"4","one"}
        };

        foreach (var value in dict.Values.Distinct())
        {
            Console.WriteLine(value);
        }
        Console.ReadLine(); 
```

也就是说，您可以使用`Distinct()`来获取唯一值，而 `dict.Values`字典`ValueColection`的

# java - 读取文本文件并将其导入过滤器排序

> ID：12083620
> 
> 赞同：0
> 
> 时间：2012-08-23T01:37:15.400
> 
> 标签：java, replace

我想要一个文件，上面写着：

```
wordone
somthing16
wordsof
varyinglengths 
```

我想做的是拥有

```
message.replace(textabove, "***") 
```

并让它循环，以便它覆盖文本文件中的任何内容。我目前有

```
message = message.replaceall("wordone", "foxin");
message = message.replaceall("somthing16", "derp"); 
```

等等一遍又一遍。并试图让我更轻松。

# ruby-on-rails-3 - 向 _ids Active Record 属性添加范围

> ID：12083624
> 
> 赞同：0
> 
> 时间：2012-08-23T01:37:30.663
> 
> 标签：ruby-on-rails-3, activerecord

我有一个包含多个 Item 类的 Location。项目具有 is_enabled 的范围。我可以

```
loc=Location.find(1)
loc.items.is_enabled
# and
loc.item_ids

# how would I do?
loc.item_ids.is_enabled 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T01:39:49.027

采用：

```
loc.items.is_enabled.map &:id 
```

# powershell - Powershell 中的直接无缓冲写入

> ID：12083627
> 
> 赞同：0
> 
> 时间：2012-08-23T01:37:49.740
> 
> 标签：powershell

目前我正在尝试运行一个测试，该测试将在写入文件时突然关闭机器。当掉电发生时，最后一部分数据不存在，因为它在掉电之前从未刷新到磁盘。

当以下列方式打开文件时，Perl（在 Linux 中）允许直接无缓冲写入。

```
sysopen(F, $file, O_WRONLY|O_DIRECT) or die "Couldn't direct open file $file\n"; 
```

这允许在机器由于某种原因崩溃时写入数据直到最后一个字符。同样，对于 Windows，当使用“FILE_FLAG_NO_BUFFERING”标志打开文件进行写入时，C++ 允许直接写入。

如何使用 powershell 允许直接/无缓冲写入磁盘？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T05:21:52.733

You could drop down to .NET and use a FileStream object to write the file. Use the constructor that takes FileOptions and [try the FileOptions.WriteThrough](https://stackoverflow.com/questions/122362/how-to-empty-flush-windows-read-disk-cache-in-c) enum value, e.g.:

```
$fileStream = New-Object System.IO.FileStream($file,
    [System.IO.FileMode]::Create, 
    [System.Security.AccessControl.FileSystemRights]::Modify,
    [System.IO.FileShare]::None,
    1,
    [System.IO.FileOptions]::WriteThrough) 
```

# python - 发出 512 UDP 字节的 DNS 请求

> ID：12083628
> 
> 赞同：0
> 
> 时间：2012-08-23T01:37:55.810
> 
> 标签：python, dns, size

我有个问题。我在互联网上阅读了各种 RFC 和许多信息。我读到通过 UDP 的 DNS 有 512 字节的限制。我想编写一个 python 程序，使用这个最大限制来创建一个生成良好的 DNS 请求。使用 UDP 而不是 TCP DNS 实现非常重要。我曾尝试使用公共库，但他们没有使用 RFC 所说的可以使用的 512 字节。

使用 ~ 512 字节在单个请求中发送如此多的数据也很重要。

感谢您的帮助！

让我们让它发生！;)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T05:40:11.097

您不应该对您的 DNS 请求完全强制 512 字节限制或 UDP 传输。[RFC 1035](https://www.rfc-editor.org/rfc/rfc1035)对传输（第 4.2 节）的确切说法是`datagrams are preferred for queries due to their lower overhead and better performance`.

也就是说，在适用的情况下，UDP**优先**作为更轻量级的传输，这主要是请求大小的问题。经验法则是通过 UDP 传输长度小于 512 字节的请求，通过 TCP 传输长度超过 512 字节的请求。（但也有例外，如`zone refresh activities`第 4.2 节所述。）

大多数流行的 Python DNS 库（如[dnspython](http://www.dnspython.org/)）在使用高级查询时可以正确处理这个问题。无需重新发明轮子。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-23T08:44:14.470

512字节的限制是针对dns**消息**的，不是专门针对请求的，限制只对**responses**有效，response可以包含Resource Records。

对于**请求**，您仅限于域名的 253 个字节。

您也许可以手动创建一个包含资源记录的查询，但它可能会被您的本地 dns 服务器删除。

# ios - 带有 UITableview 的 JSONKit

> ID：12083629
> 
> 赞同：0
> 
> 时间：2012-08-23T01:38:14.297
> 
> 标签：ios, uitableview, jsonkit

在解析表格视图时，我遇到了 JsonKit 的问题，基本上我尝试了以下操作：

```
- (void)viewDidLoad {

 [super viewDidLoad];

     //1 check if is it the login plist
     NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
     NSString *documentsDirectory = [paths objectAtIndex:0];
     NSString *path = [documentsDirectory stringByAppendingPathComponent:@"login.plist"];
     NSLog(@"path='%@'",path);

     NSFileManager *nfm = [[NSFileManager alloc] init];
     if([nfm fileExistsAtPath:path])
     {
         //Start login process
         NSArray* dict = [[NSArray alloc] initWithContentsOfFile:path];
         NSLog(@"content from the login.plist :%@",dict);
         NSString *emailstring = [dict objectAtIndex:0];
         NSString *passstring = [dict objectAtIndex:1];

         // Create the URL from a string.
         NSURL *url = [NSURL URLWithString:[NSString stringWithFormat:@"http://www.mywebsite.com/API/expert?format=json&email=%@&password=%@&start=1&end=10",emailstring,passstring]];

         // Creating a request object using the URL.
         NSURLRequest *request = [NSURLRequest requestWithURL:url];

         // Prepare for the response back from the server    
         NSHTTPURLResponse *response = nil;
         NSError *error = nil;

         // Send a synchronous request to the server (i.e. sit and wait for the response)
         NSData *responseData = [NSURLConnection sendSynchronousRequest:request returningResponse:&response error:&error];
         NSLog(@"Repoonse from web:%@", response);

         // Check if an error occurred    
         if (error != nil) {
             NSLog(@"%@", [error localizedDescription]);

         }

         // View the data returned - should be ready for parsing.
         resultsDictionary = [responseData objectFromJSONData];
         NSLog(@"ResultsDictionary:%@", resultsDictionary);

         numberexp = [resultsDictionary count];
         printf("Results dictionary online %d\n", numberexp);

     }

   }

// Customize the appearance of table view cells.
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {

static NSString *CellIdentifier = @"Cell";

    CellExpOnline *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) {

        NSArray* views = [[NSBundle mainBundle] loadNibNamed:@"CellExpOnline" owner:nil options:nil];

        for (UIView *view in views) {
            if([view isKindOfClass:[UITableViewCell class]])
            {
                cell = (CellExpOnline*)view;
            }
        }
    }

    cell.textLabel.text = [[resultsDictionary objectAtIndex:indexPath.row] valueForKey:@"titulo"];
    cell.detailTextLabel.text = [[resultsDictionary objectAtIndex:indexPath.row] valueForKey:@"description"];

    cell.backgroundColor = [UIColor clearColor];
    cell.selectionStyle = UITableViewCellSelectionStyleNone;
    return cell;

} 
```

resultsDictionary 是一本字典，我也尝试过使用数组，但总是让应用程序在滚动 tableview 后崩溃！请有任何提示，以正确解析 UITableview 的 JSONKit 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T04:12:40.017

不确定这是否是问题所在，但您似乎缺少一行来初始化您的 UITableViewCell：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {

    static NSString *CellIdentifier = @"Cell";

    CellExpOnline *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) 
    {
        // -----------------------------------------------------------
        // Aren't you missing something like this here:
        // (assuming you're not using Automatic Rreference Counting)
        // -----------------------------------------------------------

        cell = [[[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:cellID] autorelease];

        // -----------------------------------------------------------

        NSArray* views = [[NSBundle mainBundle] loadNibNamed:@"CellExpOnline" owner:nil options:nil];

        for (UIView *view in views) {
            if([view isKindOfClass:[UITableViewCell class]])
            {
                cell = (CellExpOnline*)view;
            }
        }
    }

    ...

} 
```

# c# - 如何在 RestSharp 中发送 POST 请求？

> ID：12083630
> 
> 赞同：5
> 
> 时间：2012-08-23T01:38:20.337
> 
> 标签：c#, rest, restsharp

我有这段代码，我正在尝试将其转换为 RestSharp。为了清楚起见，我删除了 using 块来压缩它。

```
using System.IO;
using System.Net;
using RestSharp;

string GetResponse(string url,string data)
{
    var request = (HttpWebRequest)WebRequest.Create(url);
    request.Method = "POST";
    request.ContentType = "application/x-www-form-urlencoded";
    var bytes = Encoding.UTF8.GetBytes(data);
    request.ContentLength = bytes.Length;
    request.GetRequestStream().Write(bytes, 0, bytes.Length);
    var response = (HttpWebResponse)request.GetResponse();
    var stream = response.GetResponseStream();
    if (stream == null) return string.Empty;
    var reader = new StreamReader(stream);
    return reader.ReadToEnd();
} 
```

我尝试了以下顺序：

```
string GetResponse(string url, string data)
{
    var client = new RestClient(url);
    var request = new RestRequest("", RestSharp.Method.POST);
    request.AddParameter("application/x-www-form-urlencoded", data);
    var response = client.Execute(request);
    return response.Content;
} 
```

我似乎无法使用 RestSharp 发布请求，发送 POST 请求的正确格式是`application/x-form-urlencoded`什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-05-01T16:26:33.933

所以事实证明参数都已经在数据字符串中序列化了。而我需要手动将它们添加到 RestSharp 请求中。

```
foreach (var pair in data) 
{ 
    request.AddParameter(pair.Key, pair.Value); 
} 
```

其中数据是键/值对结构

# c# - UI 自动化在窗格中找不到按钮

> ID：12083631
> 
> 赞同：0
> 
> 时间：2012-08-23T01:38:30.763
> 
> 标签：c#, c#-4.0, c#-3.0

希望遇到过类似情况的朋友。。

我正在挖掘从 Web 服务器返回到我的 WebBroswer WPF 的窗格。

这个窗格位于我的 WebBrowser 的顶部，有 14 个组件，包括我看到的所有内容（例如电子邮件：文本框、密码：密码框、超链接等），除了右下角的两个按钮（确定和取消按钮）。

我怀疑这两个按钮可能与其他控件不在同一个窗格中，因为我在集合中看不到它们。我一直在尝试不同的命令行来获取这两个按钮的句柄，但没有成功。我用来获取除按钮之外的其他控件的方法调用：

```
AutomationElementCollection Child4 =
     Child3.FindAll(TreeScope.Children, System.Windows.Automation.Condition.TrueCondition); 
```

Child3 是本地化的ControlType：“Pane”，Frameworkid：“Win32”。在 Child4 中，我可以看到除两个按钮之外的所有其他控件。我在 Child3 上尝试了不同的命令，例如：

```
AutomationElementCollection btns =
      Child3.FindAll(TreeScope.Children, new PropertyCondition(AutomationElement.IsEnabledProperty, true));

AutomationElementCollection btns =
      Child3.FindAll(TreeScope.Children, new PropertyCondition(AutomationElement.iskeyboardfocusable, true));

AutomationElementCollection btns =
      Child3.FindAll(TreeScope.Children, new PropertyCondition(AutomationElement.IsControlElementProperty, true)); 
```

我找不到这两个按钮。如果有人能告诉我为什么我找不到按钮并教我怎么做，那就太好了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T16:27:41.170

我应该从一开始就使用 UI Spy..

从 web 服务器返回的窗格有文本，并且按钮在 controltype: text..

# php - PHP & @: 这有效吗？

> ID：12083633
> 
> 赞同：-2
> 
> 时间：2012-08-23T01:38:33.620
> 
> 标签：php

> **可能重复：**
> [参考 - 这个符号在 PHP 中是什么意思？](https://stackoverflow.com/questions/3737139/reference-what-does-this-symbol-mean-in-php)

下面的代码有效，但我不确定它是否有效：

```
// It should print $param or $_GET['uuu'] if isset:

function test($param) {
    echo @$_GET['uuu'] ? $_GET['uuu'] : $param;

}

test('param'); 
```

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-23T01:40:11.960

如果它*无效*，它将无法*工作*。

`@`使用它来代替仅仅保存击键或使代码看起来更干净是非常糟糕的做法`isset()`，因为这不是它的作用。它所做的是尝试访问您的变量*，无论它是否已设置*，并抑制`E_NOTICE`如果变量不存在则不可避免地出现。

所以不要`@`用于检查变量，因为它不是为此目的而设计的。使用`isset()`which 确实服务于该目的：

```
echo isset($_GET['uuu']) ? $_GET['uuu'] : $param; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-23T01:40:45.773

`@``$_GET['uuu']`如果不存在，则禁止显示警告消息。这通常不是推荐的做法，因为它会避开可能对您有用的错误消息。例如，在这个例子中，我不知道是否`$_GET['uuu']`真的没有设置，或者`form`我的 html 中有错误没有发送`uuu`到服务器。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-23T01:41:28.347

@ 符号仅用于忽略错误和警告。使用它不是一个好习惯。我建议你尽量**不要**使用它。

至于功能，它是有效的。

# javascript - 为 RPG 游戏制作 HTML5 游戏框架

> ID：12083637
> 
> 赞同：0
> 
> 时间：2012-08-23T01:39:19.130
> 
> 标签：javascript, html, game-engine

我真的很想知道在开发一般的 HTML 框架时从哪里开始。我用lime.js 制作了HTML5+javascript 游戏，但我对HTML5 框架的实际构成（即lime.js、impact.js 等）感到困惑。我的主要问题是“有人如何开始开发 HTML5+javascript 游戏引擎？”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T02:09:51.383

你看过 Kinect.js 框架吗？[http://www.kineticjs.com/](http://www.kineticjs.com/)

似乎有不少用它创建的 2D 游戏。还有用于 3D 画布内容的 three.js。[http://www.html5canvastutorials.com/webgl/part-3-html5-canvas-webgl-with-three-js/](http://www.html5canvastutorials.com/webgl/part-3-html5-canvas-webgl-with-three-js/)

您可以将您的框架基于这些库或将它们用作参考。

# google-chrome-extension - 将右键单击选项添加到 chrome 扩展的图标

> ID：12083638
> 
> 赞同：9
> 
> 时间：2012-08-23T01:39:22.350
> 
> 标签：google-chrome-extension

这些问题中的大多数似乎都与使用上下文菜单向元素和页面添加右键单击有关。我想知道是否可以为 Chrome 扩展程序的图标添加右键单击选项。即在“选项”和“禁用”之间放置一个选项，例如“文档”

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2016-06-07T10:46:49.393

您可以使用 Chrome 创建**contextMenus** API 并设置 contexts="browser_action"

**例子**

```
chrome.contextMenus.create({
  "type":"checkbox",
  "checked":true,
  "title":"Connect via Cloud",
  "contexts":["browser_action"],
  "onclick":function(info, tab) {
      console.log(info);
  }
}); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-23T01:41:46.113

目前没有 API，我不知道有任何 API。

如果有的话，它会在[Browser Action](http://developer.chrome.com/extensions/browserAction.html)或[Page Action](http://developer.chrome.com/extensions/pageAction.html)文档中。

# iphone - 在目标 C 中管理数据（对象、键）

> ID：12083639
> 
> 赞同：1
> 
> 时间：2012-08-23T01:39:25.370
> 
> 标签：iphone, objective-c, ios, nsdictionary

我想在目标C中以集合（对象，键）的形式保存一些对象。我发现`NSMutableDictionary`很合适，但问题是我无法取回我想要的对象（最后添加的对象，第一个添加的对象.. .)。有更好的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T01:51:38.100

您可以使用您添加到 Dictionary 的对象的键来取回您的对象：

```
NSMutableDictionary *dict = [NSMutableDictionary dictionary];
[dict setObject:@"A" forKey:@"a"];

NSString *strA = [dict objectForKey:@"a"]; 
```

将您的密钥放入 NSMutableArray 将帮助您获得最后一个/第一个密钥。

希望有帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T01:50:51.580

对于键值对，NSDictionary 或 NSMutableDictionary 是正确的解决方案。

任何给定键只有一个值，设置新值将覆盖旧值。

```
NSMutableDictionary *myDictionary = [[NSMutableDictionary alloc] init];
[myDictionary setValue:@"World" forKey:@"Hello"];
NSLog(@"Hello %@", [myDictionary objectForKey:@"Hello"]); // prints Hello World
[myDictionary setValue:@"StackOverflow" forKey:@"Hello"];
NSLog(@"Hello %@", [myDictionary objectForKey:@"Hello"]); // prints Hello StackOverflow
[myDictionary setValue:nil forKey:@"Hello"];
NSLog(@"Hello %@", [myDictionary objectForKey:@"Hello"]); // prints Hello (null) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T01:55:49.253

字典用于在您拥有密钥时访问数据。它们不是有序容器。

如果您需要根据将数据添加到容器的时间来检索数据，则需要 LIFO（又名堆栈）、FIFO（又名队列）或 deque（又名双端队列）类型的容器。您可以先在 wikipedia 上阅读它们，但如果您想成为一名程序员，我建议您至少阅读一本像样的算法和数据结构书籍。

AFAIK 没有预定义的类可以在可可中实现这些抽象，但它们都很容易用数组来完成。`NSArray`has`lastObject`和`objectAtIndex:`方法，`NSMutableArray`还有`addObject:`,和方法`insertObject:atIndex:`，它们基本上是 LIFO/FIFO/deque 访问的原语（假设当这些方法需要索引时使用 0 ）。`removeLastObject``removeObjectAtIndex:`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T02:32:22.497

如果您想获取最后添加的对象或按索引获取对象，NSMutablearray 是最好的方法。首先添加的对象位于对象索引 0 处，最后添加的对象位于 [count-1] 索引处

# python - 在mac osx中设置python路径？

> ID：12083640
> 
> 赞同：3
> 
> 时间：2012-08-23T01:39:28.660
> 
> 标签：python, macos, python-2.7

我用 Macports 在 mac os（山狮）上安装了 python。当我运行 $python 时，当我尝试导入 pandas 或 matplotlib 时出现“无法导入 urandom”错误。

如果我运行 $python 2.7 一切运行完美。

我想将 python 更改为始终使用 python2.7。

我尝试使用 sudo port select python python27。但这没有帮助。

请帮助我，我是mac的新手。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T01:52:21.250

首先让我先说 OSX 已经安装了 python。Lion 和 Mountain Lion 将 python2.7 作为系统默认设置。

现在假设您确实想使用 macports 版本，我的猜测是您只安装了它，但没有执行修改您的步骤`PATH`以使其首先查找 macport 安装的可执行文件...

[安装 MacPorts](https://trac.macports.org/wiki/InstallingMacPorts)

1.  编辑您的`~/.profile`
2.  添加这一行： `export PATH=/opt/local/bin:/opt/local/sbin:$PATH`

下次打开 shell 时，它会将 macports 安装位置放在路径的前面，让您可以访问可执行文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T02:10:49.017

如果我没记错的话，你可能想做一个`"sudo port activate python"`. `"which python"`告诉你什么？如果是`/usr/bin/python`，则您正在运行 OSX Python。如果，OTOH，`/usr/local/bin/python`您可能正在使用端口版本。

# iphone - 如何在 iOS 6 中正确使用 ABAddressBookCreateWithOptions 方法？

> ID：12083643
> 
> 赞同：34
> 
> 时间：2012-08-23T01:39:43.680
> 
> 标签：iphone, objective-c, ios, cocoa-touch, abaddressbook

我正在尝试了解 iOS 6 中的`ABAdressBookCreateWithOptions`和`ABAddressBookRequestAccessWithCompletion`方法。

我能找到的最多信息如下，“要请求访问联系人数据，请在调用该`ABAddressBookRequestAccessWithCompletion`函数后调用该`ABAddressBookCreateWithOptions`函数。”

我相信这些方法一起应该提醒用户决定是否允许应用程序访问联系人，但是当我使用它们时，我没有看到任何提示。

有人可以提供一些示例代码，说明在现实世界的示例中如何将这些方法一起调用吗？如何创建 ( `CFDictionary`) 选项？我有使用已弃用`ABAddressBookCreate`方法的工作代码，但需要更新到 iOS 6 以适应隐私问题。

提前感谢任何可以在这里有所启发的人！

* * *

## 回答 #1

> 赞同：83
> 
> 时间：2012-09-20T10:22:36.897

现在 NDA 已经解除，这是我的解决方案，您需要替换返回数组的方法。（如果您不想在用户决定并准备重写您现有的一些代码时阻止，请查看下面的 David 的解决方案）：

```
ABAddressBookRef addressBook = ABAddressBookCreate();

__block BOOL accessGranted = NO;

if (ABAddressBookRequestAccessWithCompletion != NULL) { // we're on iOS 6
    dispatch_semaphore_t sema = dispatch_semaphore_create(0);

    ABAddressBookRequestAccessWithCompletion(addressBook, ^(bool granted, CFErrorRef error) {
        accessGranted = granted;
        dispatch_semaphore_signal(sema);
    });

    dispatch_semaphore_wait(sema, DISPATCH_TIME_FOREVER);
    dispatch_release(sema);    
}
else { // we're on iOS 5 or older
    accessGranted = YES;
}

if (accessGranted) {

    NSArray *thePeople = (__bridge_transfer NSArray*)ABAddressBookCopyArrayOfAllPeople(addressBook);
    // Do whatever you need with thePeople...

} 
```

希望这可以帮助某人...

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2013-05-02T06:24:55.223

我在这个问题上看到的大多数答案都用 GCD 做疯狂的复杂事情，最终**阻塞了主线程**。这不是必需的！

这是我一直在使用的解决方案（适用于 iOS 5 和 iOS 6）：

```
- (void)fetchContacts:(void (^)(NSArray *contacts))success failure:(void (^)(NSError *error))failure {
  if (ABAddressBookRequestAccessWithCompletion) {
    // on iOS 6

    CFErrorRef err;
    ABAddressBookRef addressBook = ABAddressBookCreateWithOptions(NULL, &err);

    if (err) {
      // handle error
      CFRelease(err);
      return;
    }

    ABAddressBookRequestAccessWithCompletion(addressBook, ^(bool granted, CFErrorRef error) {
      // ABAddressBook doesn't gaurantee execution of this block on main thread, but we want our callbacks to be
      dispatch_async(dispatch_get_main_queue(), ^{
        if (!granted) {
          failure((__bridge NSError *)error);
        } else {
          readAddressBookContacts(addressBook, success);
        }
        CFRelease(addressBook);
      });
    });
  } else {
    // on iOS < 6

    ABAddressBookRef addressBook = ABAddressBookCreate();
    readAddressBookContacts(addressBook, success);
    CFRelease(addressBook);
  }
}

static void readAddressBookContacts(ABAddressBookRef addressBook, void (^completion)(NSArray *contacts)) {
  // do stuff with addressBook
  NSArray *contacts = @[];

  completion(contacts);
} 
```

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2012-12-14T21:33:23.527

另一个排名靠前的答案有问题：

*   它无条件地调用iOS 6 之前不存在的API，因此您的程序将在旧设备上崩溃。
*   它阻塞了主线程，因此在系统警报启动期间，您的应用程序没有响应，并且没有取得进展。

这是我的 MRC 对此的看法：

```
 ABAddressBookRef ab = NULL;
        // ABAddressBookCreateWithOptions is iOS 6 and up.
        if (&ABAddressBookCreateWithOptions) {
          NSError *error = nil;
          ab = ABAddressBookCreateWithOptions(NULL, (CFErrorRef *)&error);
    #if DEBUG
          if (error) { NSLog(@"%@", error); }
    #endif
          if (error) { CFRelease((CFErrorRef *) error); error = nil; }
        }
        if (ab == NULL) {
          ab = ABAddressBookCreate();
        }
        if (ab) {
          // ABAddressBookRequestAccessWithCompletion is iOS 6 and up.
          if (&ABAddressBookRequestAccessWithCompletion) {
            ABAddressBookRequestAccessWithCompletion(ab,
               ^(bool granted, CFErrorRef error) {
                 if (granted) {
                   // constructInThread: will CFRelease ab.
                   [NSThread detachNewThreadSelector:@selector(constructInThread:)
                                            toTarget:self
                                          withObject:ab];
                 } else {
                   CFRelease(ab);
                   // Ignore the error
                 }
                 // CFErrorRef should be owned by caller, so don't Release it.
               });
          } else {
            // constructInThread: will CFRelease ab.
            [NSThread detachNewThreadSelector:@selector(constructInThread:)
                                     toTarget:self
                                   withObject:ab];
          }
        }
      } 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-02-05T19:37:17.490

这与原始问题周边相关，但我在其他任何地方都没有看到它，我花了大约两天时间才弄清楚。如果您为地址簿更改注册回调，它必须在主线程上。

例如，在这段代码中，只有 sync_address_book_two() 会被调用：

```
ABAddressBookRequestAccessWithCompletion(_addressBook, ^(bool granted, CFErrorRef error) {
    if (granted) {
        ABAddressBookRegisterExternalChangeCallback (_addressBook, sync_address_book_one, NULL);
        dispatch_async(dispatch_get_main_queue(), ^{
            ABAddressBookRegisterExternalChangeCallback (_addressBook, sync_address_book_two, NULL);
        });
    }
}); 
```

# c - 接受我的输入并在while循环中比较它，fgets？

> ID：12083648
> 
> 赞同：1
> 
> 时间：2012-08-23T01:40:33.997
> 
> 标签：c, loops, comparison, while-loop, fgets

编辑：我不得不添加一个 getchar(); scanf("%i", &choice); 现在它只问一次！

显然它是导致它输出两次的 case 开关。如果我在 case 开关之外调用该函数，它会输出 1，但如果我在开关内部调用它，它会输出两次

这是什么原因造成的？我怀疑scanf的选择？

```
 #include <stdio.h>
        #include <stdlib.h>
        #include <string.h>

        void test();
        void choose();
        int main(void)
        {   
//if i call here its fine
            test();
            choose();
            return 0; 
        }

        void choose()
        {
            int choice;

            do
            {
                printf("1 - Testing if double ask\n");
                printf("2 - Exit\n");
                printf("Please enter your choice: ");       
                scanf("%i", &choice);

                switch(choice)
                {//but pressing 1 here asks twice?
                    case 1:         
                        test();
                        break;
                    default:
                        if(choice !=2)
                            printf("Input Not Recognized!\n");
                        break;          
                }
            }
            while(choice !=2);
            if(choice == 2)
                printf("Ciao!");
        }
        void test()
        {
printf("HELLO");
                char *name = malloc (256);

                do      
                {
                    printf("Would you like to continue (y/n)\n");
                    fgets(name, 256, stdin);
                }
                while(strncmp(name, "n", 1) != 0);
                free (name);
        } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T01:45:03.270

第一：您不能将 C 字符串与比较运算符`!=`和`==`. 你需要使用[`strcmp`](http://en.cppreference.com/w/c/string/byte/strcmp)这个。

Furthermore I think you'll find a `do { ... } while` loop more useful in this case. You're checking `name` once before the user has had a chance to add any input.

The next thing to be aware of is that `fgets` will retain the newline in your input, so you'll need to address this in your usage of `strcmp`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T01:43:59.857

字符串比较在 C 中不像那样工作，您必须在 string.h 中使用 strcmp。

或者，您可以只查看名称中的第一个字符。

```
while(name[0] != 'n') 
```

# mysql - 用户 'ODBC'@'localhost' 的访问被拒绝

> ID：12083655
> 
> 赞同：8
> 
> 时间：2012-08-23T01:41:40.930
> 
> 标签：mysql

我收到一个错误： `mysqladmin.exe: connect to server at 'localhost' failed error: 'Access denied for user 'ODBC'@'localhost' (using password: YES)'`

我试图授予权限

```
mysqladmin.exe grant all ON *.* TO 'myuser'@'localhost' 
```

我正在尝试创建一个数据库：

```
CD C:\Program Files\MySQL\MySQL Server 5.5\bin
mysqladmin.exe create database comersus -p 
```

我刚刚安装了 MySQL 5.5.27.2 我创建了一个名为 myuser 的用户我正在使用 XP Pro sp3

请让我知道正确的命令行（我想我需要先授予权限）创建数据库文件。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-23T05:40:41.387

尝试使用以下选项运行 mysql 命令：

```
C:> mysql -u root 
```

这指定连接时的“root”MySQL 用户。

因为您没有指定任何用户，所以它默认为“匿名”（未命名）用户。在 Windows 上，由于某种我不知道的原因，用户名设置为“ODBC”。

阅读有关连接到服务器的[此页面（教程的一部分）。](http://dev.mysql.com/tech-resources/articles/mysql_intro.html)

并阅读以下链接开始的[文档](http://dev.mysql.com/doc/refman/5.5/en/privilege-system.html)部分，以了解超出您想象的有关用户和权限的更多信息。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2017-12-12T19:37:33.210

我遇到了同样的问题并找到了我的解决方案。

转到路径 MySQL/数据。在此文件夹下检查 (.err) ERR 文件。可能会生成如下临时密码。

**【注意】root@localhost 生成临时密码：_yJU=h0P!E<0**

希望它对某人有所帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T19:31:39.000

我能够创建一个数据库，授予权限和刷新权限以激活批处理文件中的新权限：

MySQLrun.bat 的启动

```
 @echo off
    :: I had to use the root user because the user I created didn't have any authority 
    set user=root
    ::set user=MyUser
    :: When I first installed MySQL I set a password
    set password=MyPassword
    set host=localhost

    CD C:\Program Files\MySQL\MySQL Server 5.5\bin
    :: Create a database file
    :: The log will be in C:\Program Files\MySQL\MySQL Server 5.5\bin

    mysql  -h %host% -u %user% -p%password% < c:\Dnload\MySQLCommands.sql --tee=Run.log --comments --debug-info --verbose
    cmd 
```

MySQLrun.bat 结束

bat 文件运行 MySQLCommands.sql 文件中的命令：

MySQLCommands.sql 的开始

```
 drop database if exists MyDatabaseFileName;
    CREATE DATABASE MyDatabaseFileName;
    # An example of how to GRANT ALL privileges to a user 
    #grant all ON mydatabasefilename.* TO 'Myuser'@localhost identified by 'MyPassword';
    # GRANT INSERT, DELETE, UPDATE, SELECT ON databasename.* TO ‘username’@'localhost’   IDENTIFIED BY ‘password’;
    # To activate the new permissions, issue the following command:
    FLUSH PRIVILEGES;
    #  How to log in to a specific database on a MySQL server:
show grants for 'MyUser'@'localhost' 
```

MySQLCommands.sql 结束

请注意：所有用户名、数据库名称和密码都区分大小写。

创建数据库的方法有很多。这只是其中之一。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-10-26T17:54:50.757

我的情况是一个愚蠢的错误，我输入了**mysql u -jim -p**

# .net - 无法调试 windows 服务 - 当前不会命中断点

> ID：12083657
> 
> 赞同：3
> 
> 时间：2012-08-23T01:42:31.917
> 
> 标签：.net, visual-studio-2010, windows-services

我似乎无法调试最近修改的 Windows 服务。当我第一次安装它时，我能够通过将调试器附加到这个正在运行的服务来调试它（例如，在 Visual Studio 中使用“附加到进程”）。

但是，最近我修改了服务代码，重新构建并重新安装了它。现在我似乎无法调试它 - 它说'断点当前不会被命中'。

我希望我提供了足够的信息。非常感谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-23T02:03:01.750

或者，您可以指定符号的路径以供 Visual Studio 查找。

工具 > 选项 > 调试 > 符号 > 添加到您的 pdb 文件目录中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-09-03T18:57:31.713

确保您使用的是**程序集的最新更新**。在我的情况下，installUtil.exe 会继续安装我的 Windows 服务的旧版本。

> 决心是：
> 
> (1)**卸载**服务
> 
> (2)**删除**bin/Debug 文件夹中的所有文件，然后重建项目
> 
> (3)再次**安装**服务

然后调试工作得很好

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-03-19T05:33:06.250

卸载该服务并在调试模式下构建它并重新安装它。注意：确保在附加到进程时切换到调试配置。

# multithreading - PostSharp OnMethodBoundaryAspect 不是线程安全的

> ID：12083658
> 
> 赞同：3
> 
> 时间：2012-08-23T01:42:39.750
> 
> 标签：multithreading, thread-safety, aop, postsharp

我正在尝试 PostSharp AOP，但很惊讶 OnMethodBoundaryAspect 不是线程安全的。

方面的相同实例在方法调用之间共享。

这使得它的实用性在可以应用的用例数量上非常有限。

有什么办法解决这个问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T02:05:38.410

所有 OnEntry、OnExit 和 OnException 方法都接收 MethodExecutionArgs 类型的参数。此参数有一个名为 MethodExecutionTag 的属性，该属性可用于在这些事件之间共享信息。

[http://doc.sharpcrafters.com/postsharp-2.1/Default.aspx##PostSharp-2.1.chm/html/P_PostSharp_Aspects_MethodExecutionArgs_MethodExecutionTag.htm](http://doc.sharpcrafters.com/postsharp-2.1/Default.aspx##PostSharp-2.1.chm/html/P_PostSharp_Aspects_MethodExecutionArgs_MethodExecutionTag.htm)

[链接http://www.sharpcrafters.com/blog/post/Stay-DRY-Webinar.aspx](http://www.sharpcrafters.com/blog/post/Stay-DRY-Webinar.aspx)上的第三个问题与您的相似。

# android - 使用 com.markupartist.android.widget.ActionBar 在操作栏中单击按钮找到我的位置

> ID：12083662
> 
> 赞同：1
> 
> 时间：2012-08-23T01:42:49.950
> 
> 标签：android, google-maps, android-actionbar

我在 mapview [https://github.com/johannilsson/android-actionbar](https://github.com/johannilsson/android-actionbar)中将此库用于操作栏，我想在按钮单击操作栏中的项目时显示我的位置，但我不知道该怎么做我挣扎了好几个小时......这是我的代码：

```
ActionBar actionBar = (ActionBar) findViewById(R.id.actionbar);

        actionBar.setTitle("Home");
        actionBar.setHomeAction(new IntentAction(this, Main.createIntent(this), R.drawable.ic_title_home_default));

                actionBar.addAction(new locationAction());

                // add a listener to the title

                actionBar.setOnTitleClickListener(new OnClickListener() {
        @Override   
       public void onClick(View v) {

         makeToast("Title clicked...");
                    }

                });
    }

        // the location action should go here

        private class locationAction implements Action {

            @Override

            public int getDrawable() {

                return R.drawable.location;
            } 

            @Override

            public void performAction(View view) {

                makeToast("Refreshing...");
}
}

     // a simple method to create an intent

        public static Intent createIntent(Context context) {

            Intent i = new Intent(context, Main.class);

            i.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);

            return i;

        }

        public void makeToast(String message) {

            Toast.makeText(this, message, Toast.LENGTH_SHORT).show();

        }       } 
```

请帮忙！

# ios - 在设备方向更改时交叉淡入某些 UIView

> ID：12083668
> 
> 赞同：2
> 
> 时间：2012-08-23T01:44:29.023
> 
> 标签：ios, uiview, uiviewcontroller, uikit, core-animation

当 iOS 设备改变方向时，我对某些视图如何旋转有一些疑问。

我现在正在开发一个应用程序，它基本上由 2 个视图控制器组成：第一个是嵌入在 UINavigationController 中的 UITableViewController，第二个是构建在标准 UIViewController 上的完全自定义的。

我注意到在我的 UINavigationController 视图中，当设备旋转时，UINavigationBar 和 UIToolbar 在转换到横向尺寸时都会执行交叉淡入淡出动画。

![我的应用程序的主屏幕。 当设备旋转时，UINavigationController 元素交叉淡入淡出。](../Images/4f68eb4dfa6949e921ad63d8102ba238.png)

由于技术原因，我没有为我的自定义视图控制器使用 UINavigationController，但是我在相同的位置手动添加了 UINavigationBar 和 UIToolbar（基本上是因为我需要这些元素能够覆盖在背景之上视图，因为它们可以选择隐藏，我希望直接控制来做到这一点）。

但是，当我的自定义视图控制器可见时旋转我的设备时，两个条不会执行交叉淡入淡出过渡。取而代之的是，所有的子视图都在滑动（看起来有点混乱），并且背景图像在动画实际开始之前立即被交换到 iPhone 横向版本而扭曲（即，它开始将 32pt 高的艺术品平铺在一个44pt 高的 UIToolbar）。

我只是想知道，当设备方向发生变化时，现在有没有人真正为某些 UIViews 创建这种交叉淡入淡出混合效果？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T04:52:50.493

不要使用本机自动旋转来旋转您的视图。手动旋转它们。在这里查看第二个答案：http://stackoverflow.com/questions/1220580/iphone-dev-manually-rotate-view。本质上，您注册设备旋转通知并自己进行视图旋转。

如果你想交叉淡入淡出除了上面链接中指定的 UIView 动画块之外的两个视图，请转到：

```
[UIView transitionWithView:superViewOfButtonView duration:2.0 options:UIViewAnimationOptionTransitionCrossDissolve animations:^{
    [thebuttonViewIWantToCrossFade setFrame:newPositionRect];
}completion:^(BOOL finished){
    //any completion code   
}]; 
```

让我知道这是否适合您！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T14:03:43.297

我实际上回来并重新探索了这一点。虽然 UIView 和 CAAnimation 转换方法确实有效，但它们各自在不同 iOS 设备上的帧率变化如此之大，以至于我认为实现它们并不是最好的解决方案。

我终于硬着头皮联系了苹果开发者关系，直接问了他们（如果你不知道，每个 Mac/iOS 开发者每年可能会免费向这些家伙问 2 个问题！）。

他们迅速回复并告诉我，实际上有几位 Apple 工程师在 WWDC 2012 上就该主题发表了演讲。

演讲被录制下来，在 iTunes 上注册的 Apple 开发者可以在标题为“Polishing Your Interface Rotations”下观看。它涵盖了处理界面方向的许多不同方法，非常值得一看。:)

希望这也有帮助！

# c - 空字符之前的这些附加字符是什么？

> ID：12083671
> 
> 赞同：3
> 
> 时间：2012-08-23T01:44:56.633
> 
> 标签：c, ascii, getchar

我正在关注 Kernighan 和 Ritchie 的 C 书，但在处理字符串时遇到了一些困难。

在下面的代码中，似乎我的字符串虽然是从用户输入的，但在 null ( ) 字符`getchar()`之前包含额外的，我想说的是垃圾字符。`\0`

这是代码：

```
#include <stdio.h>
main() {

        char s[200];
        int c, i;

        printf("Enter input string:\n");
        for (i = 0; ( c = getchar()) != '\n'; i++) {
                s[i] = c;
        }   

        printf("Contents of input string:\n");
        for (i = 0; s[i] != '\0'; i++) {
                printf("%d: (%d) = ", i, s[i]);
                putchar(s[i]);
                printf("\n");
        }   

        return 0;
} 
```

这是一个一个显示字符数组的每个元素的输出。这意味着以下内容：

`Array_element: (ascii_number) = ascii_character`

```
0: (72) = H
1: (101) = e
2: (108) = l
3: (108) = l
4: (111) = o
5: (32) =  
6: (87) = W
7: (111) = o
8: (114) = r
9: (108) = l
10: (100) = d
11: (33) = !
12: (-1) = ?
13: (127) = 
```

你看到元素 12 和 13 了吗？（元素 14 可能是空字符`\0`）。威士忌酒。探戈。狐步舞。

这是真正的关键，如果我将字符数组定义为只有**100 个元素**，而不是 200 个，那么输出是合理的。例如，如果我简单地替换

`char s[200]` 和 `char s[100]`

那么输出如下：

```
0: (72) = H
1: (101) = e
2: (108) = l
3: (108) = l
4: (111) = o
5: (32) =  
6: (87) = W
7: (111) = o
8: (114) = r
9: (108) = l
10: (100) = d
11: (33) = !
12: (9) = 
```

（我仍然不确定换行符在哪里。那不是 ascii 字符＃10吗？）

再次，威士忌探戈狐步舞。

这里发生了什么？

***更新***

因此，根据下面的答案，当我将字符数组的大小设置为 100 或 200 个元素时，输出的差异似乎真的是巧合——我只是在未初始化的内存中处理垃圾/噪声。

`\0`正如答案敏锐地表明的那样，我需要明确地终止我的数组。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-23T01:48:41.943

在本练习中，如果您希望输入后的字符串中存在空字符，那么您需要自己添加它。

您正在观察奇怪的字符，因为 C 中的变量和数组*未初始化*：它们可以包含任何垃圾值，可能包括随机放置的空字符。

当您更改数组大小时，您可能会观察到不同的输出，但不要期望任何合理的、预期的或可重复的行为——它是*未定义*的——因为这些数组值可以是任何东西。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-23T01:48:32.043

您需要将空终止符 ( `\0`) 放在收到的字符串的末尾，以便在字符串末尾停止下一次检查。

否则，循环将进入垃圾内存。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T06:48:21.093

您必须`s[i] = '\0';`在阅读完键盘输入后添加到您的程序中。否则，您的字符串将不正确。它不会包含“\0”终止字符。

这是更改后的代码：

```
#include <stdio.h> main() 
{         
 char s[200];        
 int c, i;        
  printf("Enter input string:\n");       
  for (i = 0; ( c = getchar()) != '\n'; i++)
 {               
  s[i] = c;        
 }     

s[i] = '\0';  //here, I added the '\0' character. (the only change i made in your code.)

  printf("Contents of input string:\n");      
   for (i = 0; s[i] != '\0'; i++) {        
         printf("%d: (%d) = ", i, s[i]);  
               putchar(s[i]);            
     printf("\n");       
  }           
  return 0;
 } 
```

2 - 字符串 s 的大小是 200，所以你必须关心缓冲区溢出：（`for (i = 0; ( c = getchar()) != '\n' && i < 199 ; i++)`最后一个字符是`\0`）。您还可以在读取输入字符时调整字符串的大小：

```
int size = 200;
char* s = malloc(size);
 for (i = 0; ( c = getchar()) != '\n'; i++)
 {  
   if(i >= size)
   {
      char* tmp = malloc(size + 200);
      memcpy(tmp , s , size);
      size += 200;
      free(s);
   }   

   s[i] = c;        
 } 
```

并且，在代码末尾添加：

`free(s);`// 当你不再需要它时释放最后创建的字符串。

# django - django 创建模板过滤器

> ID：12083676
> 
> 赞同：0
> 
> 时间：2012-08-23T01:46:02.863
> 
> 标签：django, django-template-filters

# 视图.py

```
@register.filter(name="avl")
def avl_facilities(obj):
    return obj.avl_facilities()

@register.filter
def na_facilities(obj):
    return obj.na_facilities() 
```

# 模型.py

```
class Model(models.Model):
#some code .....
    def avl_facilities(self):
        item = ['bar','bank','music','wifi','offers','credit']
        avl = []
        for i in item:
            if getattr(self,i) == True:
                avl.append(i)
        return avl
    def na_facilities(self):
        item = ['bar','bank','music','wifi','offers','credit']
        na = []
        for i in item:
            if getattr(self,i) == False:
                na.append(i)
        return na 
```

# html

```
<div class="facility pad10">
    {% for item in data.rest|avl %}
/* data.rest is appropriate instance of model defined above*/
    <span class="label label-danger mrg2 pad5 pull-left">
    {{item|title}}
    </span>
    {% endfor %}
</div> 
```

# 错误

```
Invalid filter: 'avl_facilities' 
```

# 怀疑

我无法理解，如果模型中的 avl_facilities 返回正确的可迭代列表，但它不能作为模板过滤器工作，在此先感谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T06:28:21.343

您不能在 views.py 中定义过滤器。您必须将它们放在 templatetags 目录中的新文件中。

您应该知道，这两个过滤器都是完全没有必要的。很可能从模板调用模型方法，只要它们不带参数：

```
{% for item in data.rest.avl_facilities %} 
```

# java - 我可以（安全地）为变量提供与方法名称相同的变量吗？

> ID：12083678
> 
> 赞同：1
> 
> 时间：2012-08-23T01:46:35.613
> 
> 标签：java, coding-style

在我的 java 代码中，我做了类似的事情：

```
int sleep = 0;
sleep(sleep);
sleep++; 
```

我的老板指出这不好。它不会在 php 中正确工作。

在java中使用上面的代码有什么问题/危险吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T01:51:22.863

没有危险，因为在没有参数括号的情况下永远不会引用方法，因此名称永远不会冲突。

但是，如果方法名称是动词而变量名称是名词，通常会更清晰、更直观，例如：

```
int sleepMillis = 0;
sleep(sleepMillis);
sleepMillis++; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T01:49:14.563

你不能这样做没有语法原因，但作为一般的开发原则，为了清楚起见，如果你不使用相同的名称，通常会更清楚。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T01:51:15.280

我以前从未尝试过，但我认为它可以正常工作，因为 Java 应该能够区分变量和方法之间的差异。它应该可以工作，但这样的代码令人困惑。不要让变量名称与您将使用的方法相匹配。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-23T01:51:43.877

至少可以说，这令人困惑。这并不是一个真正的问题，因为如果您尝试使用预期变量的方法（反之亦然），编译器会指向您，这要归功于 Java 是静态类型的。

在具有一阶函数的动态类型语言中，相同的代码会出现更多问题，实际上变量可以指向一个函数或一个值，直到运行时才能区分它们。

# jsf - primefaces checkboxcolumn，选定的值不会传递给后台bean

> ID：12083682
> 
> 赞同：0
> 
> 时间：2012-08-23T01:47:34.893
> 
> 标签：jsf, datatable

我在我的应用程序中使用prime faces数据表，我在数据表中有一个复选框列来选择某些行并将值发送到回bean但它总是传递空值，任何人都可以建议我的代码有什么问题

```
 <p:dataTable id="tblStatusSearch" var="item"
          selection="#{StatusAction.listBEeans}" 
            value="#{bondLocationStatusAction.listLocationEBeans}"
         rowKey="#{item.LocationId}">
             <p:column selectionMode="multiple"/> 
```

BackBean 代码：

私人名单 listBEeans;

```
INFO: java.lang.NullPointerException
java.lang.NullPointerException
    at java.lang.reflect.Array.newArray(Native Method)
    at java.lang.reflect.Array.newInstance(Array.java:52)
    at org.primefaces.component.datatable.DataHelper.decodeMultipleSelection(DataHelper.java:268)
    at org.primefaces.component.datatable.DataHelper.decodeSelection(DataHelper.java:240)
    at org.primefaces.component.datatable.DataTableRenderer.decode(DataTableRenderer.java:72)
    at javax.faces.component.UIComponentBase.decode(UIComponentBase.java:787)
    at javax.faces.component.UIData.processDecodes(UIData.java:1162)
    at org.primefaces.component.datatable.DataTable.processDecodes(DataTable.java:554)
    at com.sun.faces.context.PartialViewContextImpl$PhaseAwareVisitCallback.visit(PartialViewContextImpl.java:506)
    at com.sun.faces.component.visit.PartialVisitContext.invokeVisitCallback(PartialVisitContext.java:183)
    at javax.faces.component.UIData.visitTree(UIData.java:1411)
    at javax.faces.component.UIComponent.visitTree(UIComponent.java:1623)
    at javax.faces.component.UIForm.visitTree(UIForm.java:371)
    at javax.faces.component.UIComponent.visitTree(UIComponent.java:1623)
    at javax.faces.component.UIComponent.visitTree(UIComponent.java:1623)
    at com.sun.faces.context.PartialViewContextImpl.processComponents(PartialViewContextImpl.java:376)
    at com.sun.faces.context.PartialViewContextImpl.processPartial(PartialViewContextImpl.java:252)
    at javax.faces.context.PartialViewContextWrapper.processPartial(PartialViewContextWrapper.java:183)
    at javax.faces.context.PartialViewContextWrapper.processPartial(PartialViewContextWrapper.java:183)
    at org.openfaces.ajax.PartialViewContext.processPartial(PartialViewContext.java:131)
    at javax.faces.context.PartialViewContextWrapper.processPartial(PartialViewContextWrapper.java:183)
    at javax.faces.component.UIViewRoot.processDecodes(UIViewRoot.java:931)
    at com.sun.faces.lifecycle.ApplyRequestValuesPhase.execute(ApplyRequestValuesPhase.java:78)
    at com.sun.faces.lifecycle.Phase.doPhase(Phase.java:101)
    at com.sun.faces.lifecycle.LifecycleImpl.execute(LifecycleImpl.java:118)
    at javax.faces.webapp.FacesServlet.service(FacesServlet.java:593)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
    at org.apache.myfaces.webapp.filter.ExtensionsFilter.doFilter(ExtensionsFilter.java:349)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:293)
    at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:859)
    at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:602)
    at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489)
    at java.lang.Thread.run(Thread.java:662) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T15:47:48.537

我找到了解决方案，我应该使用数组而不是数组列表

```
private LocationEBean[] listBEeans; 
```

# php - 如何在 symfony2 的未认证页面中访问用户的角色

> ID：12083684
> 
> 赞同：2
> 
> 时间：2012-08-23T01:48:19.290
> 
> 标签：php, symfony

在我的主页模板`Index.html.twig`中，我有一个导航栏，我只想在管理员用户登录时向他们显示，否则不会。

我试过这个

```
{% if is_granted('ROLE_ADMIN') %}
       <div class="navigation">
       </div>
{% endif %} 
```

但我得到这个错误

> 在呈现模板期间抛出异常（“安全上下文不包含身份验证令牌。一个可能的原因可能是没有为此 URL 配置防火墙。

现在因为这是主页我不能把它放在防火墙后面。有什么办法吗

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T02:19:52.303

像这样包装一个 if 块：

```
{% if app.user is not null %}
    {% if is_granted('ROLE_ADMIN') %}
        {# your code #}
    {% endif %}
{% endif %} 
```

# dart - 使用 dart 将数据获取到 sqljocky 上的变量

> ID：12083687
> 
> 赞同：2
> 
> 时间：2012-08-23T01:48:32.733
> 
> 标签：dart

我想使用 Dart 库“sqljocky”从 mysql 获取数据到一个变量。然后我将通过 Socket 将该变量发送给客户端

```
 cnx.connect(user:user, password:password, port:port, db:db, host:host).chain((nothing) {
    log.debug("got connection");
    return cnx.useDatabase(db);
  }).chain((dummy) {
    return cnx.query("select * from tablename");
  }); 
```

无论如何都要这样做，谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T14:48:07.970

自问题发布以来，Dart 的语法和 sqljocky 的 API 略有变化。这就是您现在从 sqljocky 中的查询获取结果的方式。

```
var pool = new ConnectionPool(user:user, password:password, port:port, db:db, host:host);
pool.query('select * from tablename').then((result) {
  for (var row in result) {
    print("A row:");
    for (var col in row) {
      print(col);
    }
  }
}); 
```

# salesforce - 实体 'Lead' 上没有这样的列 'Owner'

> ID：12083690
> 
> 赞同：0
> 
> 时间：2012-08-23T01:48:49.200
> 
> 标签：salesforce, apex-code

我收到以下错误

错误：编译错误：实体 'Lead' 上没有这样的列 'Owner'。如果您尝试使用自定义字段，请务必在自定义字段名称后附加“__c”。请参考您的 WSDL 或相应名称的描述调用。在第 8 行第 17 列

```
trigger Lead_Assignment on Lead (after insert) {

     List<Lead> le=trigger.new;
     User us=le.get(0).CreatedBy;
    List<User> u=[SELECT id from USER WHERE At_Work__c=true];    
    List<integer> ii=new List<Integer>();
    for(User uu:u){
    Integer xx= [SELECT count() from Lead WHERE Owner=:uu];

    }

} 
```

Lead Object 中有一个名为 Owner 的字段，为什么我会收到此错误，请帮助解决此错误。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-23T01:59:10.900

我认为您最好使用类似于以下的查询：

```
Integer xx= [SELECT count() from Lead WHERE OwnerId=:uu.Id]; 
```

潜在客户对象上的 Owner 字段实际上是对所有者用户对象的引用。如果您执行类似于以下的查询，通常会填充此内容：

```
[SELECT id, Owner.Name, Owner.Email FROM Lead] 
```

要访问 Owner 字段，您将访问主要对象所有者属性：

```
Lead myLead = [SELECT Id, Owner.Name, Owner.Email FROM Lead limit 1];
System.debug(myLead.Owner.Email); 
```

但是，这里有一个更大的问题。在这样的循环中查询不是最佳做法。你最好使用如下聚合查询：

```
 AggregateResult[] results = [SELECT COUNT(ID), OwnerId FROM LEAD GROUP BY OwnerId WHERE OwnerId IN :listOfUserIds] 
```

# ruby-on-rails - 用于订阅的短信支付平台？

> ID：12083693
> 
> 赞同：3
> 
> 时间：2012-08-23T01:48:55.497
> 
> 标签：ruby-on-rails, ruby, sms, payment-gateway, sms-gateway

在 WhitePages.com 上，他们有一种机制，可以通过输入您的电话号码来促进付款。输入号码后，您会收到一条短信，指示您输入“GO”以完成交易。在您做出购买的回复后，您会收到另一条消息，建议您支付一定的月费，可以无限制地使用该服务。我以前从未见过任何具有如此动态的东西，我很好奇人们会使用哪些服务来为 Ruby on Rails 应用程序构建这样的支付系统？

我对允许从尽可能多的国家/地区进行这种付款的平台特别感兴趣，因为我目前在另一个应用程序上使用 Twilio 进行 SMS 消息传递。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-31T12:40:12.463

在不知道 WhitePages.com 提供的全部细节的情况下，听起来他们正在使用 Premium SMS 作为从手机收取付款的一种方法。

在您输入您的电话号码后，他们会向您发送一条短信，其中发起人设置为高级短代码（而不是来自长号码）。您向高级短代码发送回的回复被视为您接受的费用高于您的标准网络 SMS 费率。收费金额可能会有所不同，但在收费前应让订阅者清楚。这个移动发起的回复文本 (MO) 是导致从您的移动电话号码帐单中扣除费用的原因。

高级订阅服务随后可以产生进一步的费用，而用户仍然通过发送来自高级短代码的消息进行订阅。接收这些消息的行为会导致向您的移动电话账单收取费用。这些被视为移动终端文本 (MT)。

由于多种原因，Premium SMS 不是一个简单的收款解决方案。

1.  由于移动网络为提供服务而保留了一部分，因此您通常只能收到用户账单上的一小部分费用。
2.  由于这依赖于高级短代码，您可能必须接受您将在每个要运营的国家/地区拥有不同的号码，因为您必须在每个国家/地区组织高级短代码。
3.  在每个国家/地区，您需要了解有关高级服务的不同规定。例如，用户需要能够在订阅后取消订阅/退出高级服务，因此高级服务通常必须遵守接收用户的“停止”和“停止所有”消息。

据我所知，Twilio 目前不支持高级短代码。还有其他支持高级 SMS 的 SMS 网关，但您不会获得适合您希望运营的任何国家/地区的单一解决方案。与这种系统交互通常不比发送和接收普通 SMS 复杂，因此使用 Ruby on Rails 应用程序创建它应该不会更复杂。

普通短信几乎是全球通用的。高级 SMS 是一项额外的国家特定功能。

# c - Linux 上 C 中的原子操作

> ID：12083694
> 
> 赞同：5
> 
> 时间：2012-08-23T01:49:08.397
> 
> 标签：c, linux, gcc, atomic

我正在尝试将我编写的一些代码从 Mac OS X 移植到 Linux，并且正在努力寻找仅适用于 OSX 的替代品`OSAtomic.h`。我找到了 gcc`__sync*`系列，但我不确定它是否与我拥有的旧编译器/内核兼容。我需要代码在 GCC v4.1.2 和内核 2.6.18 上运行。

我需要的特定操作是：

*   增量
*   递减
*   比较和交换

奇怪的是，`locate stdatomic.h`在 linux 机器上运行会找到头文件（在 c++ 目录中），而在我的 OSX 机器（gcc v4.6.3）上运行相同的命令不会返回任何内容。我必须安装什么才能获得 stdatomic 库，它可以与 gcc v 4.1.2 一起使用吗？

作为旁注，我不能使用任何第三方库。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-23T01:54:55.547

好吧，没有什么可以阻止您`OSAtomic`在其他平台上使用操作。ARM、x86 和 PPC的操作源`OSAtomic`是 Apple 开源的 libc 的一部分。只要确保你没有使用`OSSpinLock`Mac OS X 特有的，但这可以很容易地被 Linux futexes 取代。

见这些：

[http://opensource.apple.com/source/Libc/Libc-594.1.4/i386/sys/OSAtomic.s](http://opensource.apple.com/source/Libc/Libc-594.1.4/i386/sys/OSAtomic.s) [http://opensource.apple.com/source/Libc/Libc-594.1.4/ppc/sys /OSAtomic.s](http://opensource.apple.com/source/Libc/Libc-594.1.4/ppc/sys/OSAtomic.s) [http://opensource.apple.com/source/Libc/Libc-594.1.4/arm/sys/OSAtomic.s](http://opensource.apple.com/source/Libc/Libc-594.1.4/arm/sys/OSAtomic.s)

或者，您可以使用该`sync_*`系列，我认为它应该适用于大多数平台，我相信这里有描述：http: [//gcc.gnu.org/wiki/Atomic](http://gcc.gnu.org/wiki/Atomic)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-23T02:13:38.390

OpenPA[项目](http://trac.mcs.anl.gov/projects/openpa/)在 MIT 风格的许可下提供了一个可移植的原子操作库。这是我以前使用过的一个，它非常简单。您的操作代码如下所示

```
#include "opa_primitives.h"

OPA_int_t my_atomic_int = OPA_INT_T_INITIALIZER(0);

/* increment */
OPA_incr_int(&my_atomic_int);

/* decrement */
OPA_decr_int(&my_atomic_int);

/* compare and swap */
old = OPA_cas_int(&my_atomic_int, expected, new); 
```

它还包含细粒度的内存屏障（即读、写和读/写），而不仅仅是一个完整的内存栅栏。

主[头文件](http://trac.mcs.anl.gov/projects/openpa/browser/trunk/src/opa_primitives.h#L29)有一个注释，显示库中可用的操作。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-23T02:29:49.210

GCC 原子内在函数自 GCC 4.0.1 起就可用。

没有什么可以阻止您使用 GCC 4.1.2 构建[GCC 4.7](http://gcc.gnu.org/gcc-4.7/changes.html)或 Clang，然后获得所有新功能，例如[C11 atomics](http://en.wikipedia.org/wiki/C11_%28C_standard_revision%29)。

作为最后的手段，您可以在许多地方找到 BSD 许可的原子汇编器实现。

# node.js - 带有 socket.io 和 expressjs 的节点集群

> ID：12083701
> 
> 赞同：6
> 
> 时间：2012-08-23T01:50:27.223
> 
> 标签：node.js, redis, socket.io, cluster-computing, node-cluster

这是我的服务器代码：

我正在尝试将集群与 socket.io 和 expressjs 一起使用。我正在我的四核台式机上对此进行测试。

```
var cluster = require('cluster')
var numCPUs = require('os').cpus().length

if (cluster.isMaster) {
  // Fork workers.
  for (var i = 0; i < numCPUs; i++) {
    cluster.fork()
  }

  console.log(new Date());
}
else {
  // get required modules
  var connect = require('connect');
  var express = require('express');
  var mongo = require('mongodb');
  var MongoStore = require('connect-mongo')(express);
  var server;
  var redis = require('redis');
  var http = require('http');

  // create server object
  app = exports.module = express();

  function configureServer() {
    //configure environments
    app.configure('production', function() {
      app.use(express.errorHandler());
    });

    //configure server instance
    app.configure(function() {
      app.use(express.compress())
      // set jade as default view engine
      app.set('view engine', 'jade');
      app.use(express.bodyParser());
      app.use(express.cookieParser("refdgfd"));

      app.use(express.methodOverride());
      app.use(app.router);
      // use express logger
    });

    loadModules();
  }

  var server = http.createServer(app).listen(80);

  socket = require('socket.io').listen(server);

  var RedisStore = require('socket.io/lib/stores/redis')
    , pub    = redis.createClient()
    , sub    = redis.createClient()
    , client = redis.createClient();
  socket.set('store', new RedisStore({
    redisPub : pub
  , redisSub : sub
  , redisClient : client
  }));

  socket.configure(function() {
    socket.set('log level', 1);
    socket.set('transports', ['websocket']);
  });

  configureServer();
} 
```

有什么明显是错误的吗？

日志表明一切都发生了 4 次。这似乎是正确的。但是我的 socket.io 的频道用户也表明，每当我连接到一个页面时，我都会连接 4 次，（创建 4 个用户套接字）。这似乎是错误的。我该如何修复它，我的代码是否还有其他问题。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T02:24:26.687

此刻`socket.io`已经没有全力支持`node.js cluster`。它适用于我的`websocket`运输，但`xhr-pooling`失败了。您可以在此问题中了解更多信息：[#939](https://github.com/LearnBoost/socket.io/issues/939)、[#917](https://github.com/LearnBoost/socket.io/issues/917)。问题是`xhr-pooling`请求可以进入与最初授权的线程不同的线程。

# java - 403 在 servlet 中被禁止

> ID：12083703
> 
> 赞同：1
> 
> 时间：2012-08-23T01:50:48.167
> 
> 标签：java, servlets, youtube, http-status-code-403

我有一个文件的 url，它在浏览器和 Java SE 应用程序中完美运行，但它`403 forbidden`在 servlet 中给了我错误。以下是 Java SE 程序和 servlet 的代码

**Java SE 代码**

```
public class UrlDownload {
    final static int size=1024;
    public static void fileUrl(){
        OutputStream outStream = null;
        URLConnection  uCon = null;

        InputStream is = null;
        try{
            URL Url;
            byte[] buf;
            int ByteRead,ByteWritten=0;
            Url= new URL("http://o-o---preferred---bharti-del2---v17---    lscache7.c.youtube.com/videoplayback?upn=6BFud0UQ_-0&sparams=cp%2Cgcr%2Cid%2Cip%2Cipbits%2Citag%2Cratebypass%2Csource%2Cupn%2Cexpire&fexp=900147%2C907217%2C922401%2C919804%2C920704%2C912806%2C906831%2C911406%2C913550%2C912706&key=yt1&itag=37&ipbits=8&signature=6EBF4572274A427AFF58E023CEC8B62439E0B914.BD6827306B81393BE3998FA0F0701E6F2701A3F8&mv=m&sver=3&mt=1345685891&ratebypass=yes&source=youtube&ms=au&gcr=in&expire=1345708167&ip=116.203.237.173&cp=U0hTSldLVl9LUUNOM19PRVpCOkV6WE5pcUF1NjQ5&id=9d8c9310d90eae67&quality=hd1080&fallback_host=tc.v17.cache7.c.youtube.com&type=video/mp4");
            outStream = new BufferedOutputStream(new
            FileOutputStream("video"));

            uCon = Url.openConnection();
            is = uCon.getInputStream();
            buf = new byte[size];
            while ((ByteRead = is.read(buf)) != -1)
            {
                System.out.println("Downloading file");
                outStream.write(buf, 0, ByteRead);
                ByteWritten += ByteRead;
            }
            System.out.println("Downloaded Successfully.");
        }catch (Exception e) {
            e.printStackTrace();
        }finally {
            try {
                is.close();
                outStream.close();
            }catch (IOException e) {
                e.printStackTrace();
            }
        }
    }
} 
```

**小服务程序代码**

```
protected void processRequest(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
    response.setContentType("video/mp4");
    String url=request.getParameter("url");
    URLConnection  con = null;

    BufferedOutputStream out = new BufferedOutputStream(response.getOutputStream());
    InputStream in=null;
    byte[] buffer;
    int ByteRead,ByteWritten=0;
    try {
        URL dUrl=new URL(url);
        con=dUrl.openConnection();
        in=con.getInputStream();
        buffer = new byte[1024];
        while ((ByteRead = in.read(buffer)) != -1)
        {
            System.out.println("Downloading file");
            out.write(buffer, 0, ByteRead);
            ByteWritten += ByteRead;
        }   
    } finally {            
      out.close();
      in.close();
    }
} 
```

`url``url`与`parameter`此相同`servlet`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T02:16:24.110

YouTube 下载 URL 仅供一次性使用 - 它们绑定到最初为其生成的 IP 范围，并在一段时间后过期。正如您在此处所做的那样，在您的应用程序中进行硬编码将导致不可避免的失败。

# objective-c - 在 iOS 中获取 AVPlayer 的音量

> ID：12083706
> 
> 赞同：2
> 
> 时间：2012-08-23T01:50:52.253
> 
> 标签：objective-c, ios, avplayer

有很多问题询问如何**设置**音量`AVPlayer`，但是*如何在 iOS 中获取播放器的当前音量*？

例如，我试图将一首歌曲从其当前级别淡出。我可以将音量保存在其他地方并引用它，但宁愿直接从 AVPlayer 读取值。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-23T14:53:39.570

`AVPlayer`is 包含一个或多个`AVPlayerItem`对象，通过这些对象，您可以获取和设置 AVPlayer 播放的媒体的音频电平。前往[AVPlayerItem 文档](https://developer.apple.com/library/ios/#documentation/AVFoundation/Reference/AVPlayerItem_Class/Reference/Reference.html)并查看该`audioMix`属性，并查看我对一个[稍微不同的问题](https://stackoverflow.com/questions/10206991/avplayer-dynamic-volume-control/10218004#10218004)的回答，该问题仍应提供一些信息。

* * *

在您发表评论后跟进，这是（我认为）您将如何从该`- (BOOL)getVolumeRampForTime:(CMTime)time startVolume:(float *)startVolume endVolume:(float *)endVolume timeRange:(CMTimeRange *)timeRange`方法中获取音量值：

```
// Get your AVAudioMixInputParameters instance, here called audioMixInputParameters
// currentTime is the current playhead time of your media

float startVolume;
float endVolume;
CMTimeRange timeRange;

bool success = [audioMixInputParameters getVolumeRampForTime: currentTime
                                                 startVolume: &startVolume
                                                   endVolume: &endVolume
                                                   timeRange: &timeRange];

// startVolume and endVolume should now be set
NSLog(@"Start volume: %f | End volume: %f", startVolume, endVolume); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T03:23:08.750

根据 Apple 的[`AVPlayer`OS X 文档](https://developer.apple.com/library/mac/#documentation/AVFoundation/Reference/AVPlayer_Class/Reference/Reference.html)，它列出了一个 volume 属性，但[iOS 中同一类](http://developer.apple.com/library/ios/#DOCUMENTATION/AVFoundation/Reference/AVPlayer_Class/Reference/Reference.html)的文档没有列出一个。你的项目会允许你使用`AVAudioPlayer`吗？那个*确实*有一个 iOS 的综合卷属性，它更容易设置/检索。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-23T03:22:33.947

~~您可以使用 AVPlayer 类的 volume 属性。这是[AVPlayer 类参考](https://developer.apple.com/library/mac/#documentation/AVFoundation/Reference/AVPlayer_Class/Reference/Reference.html)链接。引用它：~~

> volume
> 表示播放器当前的音量。
> 
> @property(nonatomic) float volume
> Discussion
> 0.0 表示“静音所有音频”，1.0 表示“以当前项目的最大音量播放”。
> 
> 可用性
> 适用于 OS X v10.7 及更高版本。
> 
> ~~在
> AVPlayer.h 中声明~~

编辑：

您可以尝试获取系统卷。此[链接](https://stackoverflow.com/questions/7255006/get-system-volume-ios)提供了 2 种方式。

# javascript - 这种无缝的选框风格使每个卷轴都感到不安

> ID：12083708
> 
> 赞同：2
> 
> 时间：2012-08-23T01:50:58.647
> 
> 标签：javascript, jquery, html, marquee

我正在使用此代码创建一个向上滚动的选框文本，但在 7000 毫秒后它会抖动，因此无法很好地查看里面的文本。

你知道我可以在哪里修吗？

```
<script language="javascript">
jQuery(function() {

    var marquee = jQuery("#marquee");
    marquee.css({"overflow": "hidden", "height": "100%"});
    marquee.wrapInner("<span>");
    marquee.find("span").css({ "height": "50%", "display": "inline-block", "text-align":"left" });
    marquee.append(marquee.find("span").clone());
    marquee.wrapInner("<div>");
    marquee.find("div").css("height", "200%");
    var reset = function() {
        jQuery(this).css("margin-top", "0%");
        jQuery(this).animate({ "margin-top": "-100%" }, 7000, 'linear', reset);
    };
    reset.call(marquee.find("div"));
}); 
```

顺便说一句，你可以这样

```
<div id="marquee">text</div> 
```

[**更新**]抱歉，Kamal 不得不编辑这篇文章以添加 jsfiddle 来重现问题 [我一直知道我可以做到这一点：-D] [http://jsfiddle.net/xRcwH/](http://jsfiddle.net/xRcwH/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T20:11:26.340

我已经在[<marquee> html tag usage/replacement](https://stackoverflow.com/questions/4423618/marquee-html-tag-usage-replacment/14285710#14285710)回答了同样的问题。

有 CSS3 WebKit 特定`-webkit-marquee-`的，您可以在[http://davidwalsh.name/webkit-marquee-css](http://davidwalsh.name/webkit-marquee-css)阅读。然而，无论出于何种原因，即使是原生 CSS marquee 实现也是有问题的。

这同样适用于`<marquee>`元素。浏览器很好地支持它，但是，除了被弃用之外，它还存在故障。

我一直在寻找最*有效*和*跨浏览器支持的*字幕实现。以上都不符合要求。常见的做法是使用计时器（或 jQuery animate 实现）来调整元素的 CSS 边距属性。这就是你的脚本所做的。不幸的是，此操作非常耗费资源。它需要每隔几毫秒应用新的 CSS，从而重新计算整个布局。

我想出了在支持它的浏览器上使用*CSS3 转换*`scrollLeft`的实现，并以其他方式为包含元素的属性设置动画。这是一个实验性的实现，尽管它在 IE7+ 上运行良好。该代码可在[https://github.com/gajus/marquee](https://github.com/gajus/marquee)获得（演示[https://dev.anuary.com/60244f3a-b8b2-5678-bce5-f7e8742f0c69/](https://dev.anuary.com/60244f3a-b8b2-5678-bce5-f7e8742f0c69/)）。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-11T17:12:09.573

为什么不使用`<marquee>`标签？

```
<marquee  behavior="scroll" direction="up">Your upward scrolling text goes here</marquee> 
```

# sql - ORA-00604: 递归 SQL 级别 1 发生错误

> ID：12083712
> 
> 赞同：2
> 
> 时间：2012-08-23T01:51:16.370
> 
> 标签：sql, oracle, prepared-statement, sqlexception

我开始收到以下`SQL exception`内容，但我不知道此异常的根本原因是什么？我也关闭`dbconnection`了`prepared statement`。那么有什么问题呢？

```
java.sql.SQLException: ORA-00604: error occurred at recursive SQL level 1
ORA-01000: maximum open cursors exceeded
ORA-00604: error occurred at recursive SQL level 1
ORA-01000: maximum open cursors exceeded
ORA-01000: maximum open cursors exceeded 
```

下面是我正在使用的代码。我的代码有什么问题吗？

```
for (Entry<Integer, LinkedHashMap<Integer, String>> entry : GUID_ID_MAPPING.entrySet()) {

    pstatement = db_connection.prepareStatement(PDSLnPConstants.UPSERT_SQL); // create a statement
    pstatement.setInt(1, entry.getKey());
    pstatement.setString(2, entry.getValue().get(PDSLnPConstants.CGUID_ID));
    pstatement.setString(3, entry.getValue().get(PDSLnPConstants.PGUID_ID));
    pstatement.setString(4, entry.getValue().get(PDSLnPConstants.SGUID_ID));
    pstatement.setString(5, entry.getValue().get(PDSLnPConstants.UID_ID));
    pstatement.setString(6, entry.getValue().get(PDSLnPConstants.ULOC_ID));
    pstatement.setString(7, entry.getValue().get(PDSLnPConstants.SLOC_ID));
    pstatement.setString(8, entry.getValue().get(PDSLnPConstants.PLOC_ID));
    pstatement.setString(9, entry.getValue().get(PDSLnPConstants.ALOC_ID));
    pstatement.setString(10, entry.getValue().get(PDSLnPConstants.SITE_ID));
    pstatement.executeUpdate();

    }

} catch (SQLException e) {
    getLogger().log(LogLevel.ERROR, e);
} finally {
    if (pstatement!= null) {
    try {
        pstatement.close();
        pstatement = null;
    } catch (SQLException e) {
        getLogger().log(LogLevel.ERROR, e.getMessage(), e.fillInStackTrace());
    }
    }
    if (db_connection!= null) {
    try {
        db_connection.close();
        db_connection = null;
    } catch (SQLException e) {
        getLogger().log(LogLevel.ERROR, e.getMessage(), e.fillInStackTrace());
    }
    } 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-23T02:24:19.983

我认为`PreparedStatement`定义应该被拉出循环并通过调用在循环中重用`clearParameters`：

```
pstatement = db_connection.prepareStatement(PDSLnPConstants.UPSERT_SQL); // create a statement

for (Entry<Integer, LinkedHashMap<Integer, String>> entry : GUID_ID_MAPPING.entrySet()) {

    pstatement.setInt(1, entry.getKey());
    pstatement.setString(2, entry.getValue().get(PDSLnPConstants.CGUID_ID));
    pstatement.setString(3, entry.getValue().get(PDSLnPConstants.PGUID_ID));
    pstatement.setString(4, entry.getValue().get(PDSLnPConstants.SGUID_ID));
    pstatement.setString(5, entry.getValue().get(PDSLnPConstants.UID_ID));
    pstatement.setString(6, entry.getValue().get(PDSLnPConstants.ULOC_ID));
    pstatement.setString(7, entry.getValue().get(PDSLnPConstants.SLOC_ID));
    pstatement.setString(8, entry.getValue().get(PDSLnPConstants.PLOC_ID));
    pstatement.setString(9, entry.getValue().get(PDSLnPConstants.ALOC_ID));
    pstatement.setString(10, entry.getValue().get(PDSLnPConstants.SITE_ID));
    pstatement.executeUpdate();

    pstatement.clearParameters();

} 
```

您可能还想研究批处理 ( `addBatch`)。如果您正在测试，您可能需要稍等片刻，以便清理现有的“打开”游标。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-07-08T15:12:53.160

好吧，我想我给你一种解决方法，但无论如何很多人都会遇到这样的问题，所以我不妨分享一下。

我正在使用 NetBeans 7.3.1 并引用远程服务器上的 Oracle 数据库，因此我无法编辑注册表项，而是意识到我正在使用**ojdbc14.jar** ，而我只需要在我的类路径中使用**ojdbc6.jar** 。

解决方案：使用**ojdbc6.jar**代替**ojdbc14.jar**

# php - 多个同名表单数据

> ID：12083723
> 
> 赞同：4
> 
> 时间：2012-08-23T01:53:24.497
> 
> 标签：php, html

我有一个 html 表单具有相同名称的多个数据。像这样...

HTML 代码

```
<tr>
  <td valign="top"><input id="" type="text" name="asset_id" size="15"/></td>
  <td valign="top"><input id="" type="text" name="batch_code" size="15"/></td>
  <td valign="top"><input id="" type="text" name="description" size="50"/></td>
</tr>
<tr>
  <td valign="top"><input id="" type="textbox" name="asset_id" size="15"/></td>
  <td valign="top"><input id="" type="textbox" name="batch_code" size="15"/></td>
  <td valign="top"><input id="" type="textbox" name="description" size="50"/></td>
</tr> 
```

如何在 php $_POST[] 中将其发送到后端进程。请帮我..

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T01:57:54.753

附加`Square Bracket []`到您的姓名：

```
<tr>
    <td valign="top"><input id="" type="text" name="asset_id[]" size="15"/></td>
    <td valign="top"><input id="" type="text" name="batch_code[]" size="15"/></td>
    <td valign="top"><input id="" type="text" name="description[]" size="50"/></td>
</tr>
<tr>
    <td valign="top"><input id="" type="textbox" name="asset_id[]" size="15"/></td>
    <td valign="top"><input id="" type="textbox" name="batch_code[]" size="15"/></td>
    <td valign="top"><input id="" type="textbox" name="description[]" size="50"/></td>
</tr> 
```

在你的 php 中：

```
<?php
    print_r( $_POST['asset_id'] );
    print_r( $_POST['batch_code'] );
    print_r( $_POST['description'] );
?> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-23T01:58:49.753

使用这个 HTML：

```
<tr>
  <td valign="top"><input id="" type="text" name="asset_id[]" size="15"/></td>
  <td valign="top"><input id="" type="text" name="batch_code[]" size="15"/></td>
  <td valign="top"><input id="" type="text" name="description[]" size="50"/></td>
</tr>
<tr>
  <td valign="top"><input id="" type="text" name="asset_id[]" size="15"/></td>
  <td valign="top"><input id="" type="text" name="batch_code[]" size="15"/></td>
  <td valign="top"><input id="" type="text" name="description[]" size="50"/></td>
</tr> 
```

请注意，没有`type="textbox"`; 正确`type`的是`text`。
在 PHP 中，像这样访问数据：

```
$_POST["asset_id"]; // this is an array of the values of the asset_id textboxes
$_POST["batch_code"]; // array of batch codes
$_POST["description"]; // array of descriptions 
```

# c++ - C++ 链表删除所有

> ID：12083726
> 
> 赞同：1
> 
> 时间：2012-08-23T01:53:50.600
> 
> 标签：c++, memory-management, data-structures, linked-list, removeall

所以这是一个概念性的问题。我正在用 C++ 编写 LinkedList，因为 Java 是我的第一语言，所以我开始编写我的 removeAll 函数，以便它只连接头部和尾部节点（顺便说一句，我正在使用哨兵节点）。但我立即意识到这在 C++ 中不起作用，因为我必须为节点释放内存！

有没有办法遍历整个列表，手动删除每个元素？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-23T02:15:29.747

你可以让每个节点拥有下一个，即当它自己被销毁时负责销毁它。您可以使用以下智能指针来执行此操作`std::unique_ptr`：

```
struct node {
    // blah blah
    std::unique_ptr<node> next;
}; 
```

然后你可以只销毁第一个节点，所有其他节点都将被计算在内：它们都将在 unique_ptr 析构函数的连锁反应中被销毁。

但是，如果这是一个双向链表，则不应`unique_ptr`在两个方向上都使用 s。这将使每个节点拥有下一个节点，并由下一个节点拥有！您应该使这种所有权关系仅存在于一个方向。在另一个使用常规的非拥有指针：`node* previous;`

但是，这对哨兵节点不起作用：它不应该被销毁。如何处理取决于如何识别哨兵节点以及列表的其他属性。

如果您可以轻松区分哨兵节点，例如检查布尔成员，则可以使用自定义删除器来避免删除哨兵：

```
struct delete_if_not_sentinel {
    void operator()(node* ptr) const {
        if(!ptr->is_sentinel) delete ptr;
    }
};

typedef std::unique_ptr<node, delete_if_not_sentinel> node_handle;

struct node {
    // blah blah
    node_handle next;
}; 
```

这停止了​​哨兵的连锁反应。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T02:04:33.807

[如果您使用 c++垃圾收集器](http://en.wikipedia.org/wiki/Garbage_collection_%28computer_science%29)，您可以像 Java 一样进行操作。没有多少人这样做。无论如何，它最多可以为您节省运行时间的一个常数因素，因为无论如何您都要花费成本来分配列表中的每个元素。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T02:14:35.270

是的。好吧，有点...如果您实现列表以使用内存池，那么它负责该池中的所有数据，并且可以通过删除内存池（可能包含一个或多个大块内存）来删除整个列表）。

使用内存池时，通常至少有以下考虑之一：

*   对象创建和销毁方式的限制；
*   您可以存储何种数据的限制；
*   每个节点的额外内存需求（引用池）；
*   一个简单、直观的池与一个复杂、令人困惑的池。

我不是这方面的专家。通常，当我需要快速内存管理时，它是用于填充一次的内存，无需维护空闲列表等。当您有特定的目标和设计约束时，内存池更容易设计和实现。如果你想要一些适用于所有情况的灵丹妙药，那你可能就不走运了。

# grails - 找不到名称 [top_menu] 和路径 [//_top_menu.gsp] 的模板

> ID：12083727
> 
> 赞同：0
> 
> 时间：2012-08-23T01:54:04.510
> 
> 标签：grails

我正在研究 grails 应用程序，并且在 root 中呈现模板会出现错误。以下是采取的步骤：

1.  我有一个控制器“公共”，每个页面都有显示的操作......其中包括我的默认页面的“主页”
2.  我更改了 URL 映射（在 UrlMappings.groovy 中）以将根指向我的默认控制器和操作，如下所示：“/”（控制器：'public'，视图：'home'）
3.  之后，指向根“app-name/”，我得到：

    类：org.codehaus.groovy.grails.web.taglib.exceptions.GrailsTagException
    消息：找不到名称 [top_menu] 和路径 [//_top_menu.gsp] 的模板

我在 home.gsp 的 view/public/ 文件夹中有模板 _top_menu.gsp

如果我指向 app-name/public/home，它可以正常工作，但是，当指向 root 时则不行。为什么它不在根目录中呈现模板？

谢谢你的帮忙

ps Grails 2.04。Windows 7的

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T06:43:04.360

UrlMappings 应该是：

```
"/" ( controller:'public', action:'home' ) 
```

..所以没有“view:'home'”，而是“action:'home'”

# html - CSS高度至少#px？

> ID：12083730
> 
> 赞同：1
> 
> 时间：2012-08-23T01:54:32.363
> 
> 标签：html, css

有没有办法将 CSS 元素（在这种情况下为 div）设置为某个高度，除非其中的内容导致它更大？我有一个 CSS 布局，我希望我的“内容”div 至少有 600px 高，但是是否有 700px 的内容，允许它被扩展。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-23T01:55:47.433

```
div {
    min-height: 600px;
} 
```

# asp.net - 托管服务器中的日期格式

> ID：12083731
> 
> 赞同：0
> 
> 时间：2012-08-23T01:54:43.603
> 
> 标签：asp.net, iis-7, web-config

在我们的网站搜索和业务流程中，我们依赖日期格式 dd/mm/yyyy 和时间格式 HH:MM

但我发现站点和托管服务器日期格式看起来像 M/dd/yyyy H:MM PM/AM。

我尝试在 web.config 中使用以下内容来覆盖它，但我失败了

```
 <globalization
   requestEncoding="utf-8"
   responseEncoding="utf-8"
   culture="en-GB"
   uiCulture="es" /> 
```

解决这个问题的任何其他想法，我无法在服务器上更改日期，这是 Godaddy 托管

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T02:16:51.363

您将无法使用 web.config 覆盖任何服务器设置。但是，在您的代码中，您可以采用这种方式格式化日期时间字符串。您可以在此处查看有关如何执行此操作的更多信息：http: [//msdn.microsoft.com/en-us/library/8kb3ddd4.aspx](http://msdn.microsoft.com/en-us/library/8kb3ddd4.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-21T11:49:27.913

日期和字符串转换可能需要很长时间的修改，而且有点混乱。将以下内容添加到您的 web.config。注意不要添加重复的全球化或 system.web 标签。

```
<system.web>
<globalization  culture="en-NZ"  uiCulture="en-NZ"/>
</system.web> 
```

在 ASP.NET 4.5 GoDaddy 主机中测试，它可以工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2022-01-10T16:34:07.637

正如 Josh Harris 所说，在 web config 中添加配置：

```
<system.web>
  <globalization  culture="es"  uiCulture="es-MX"/>
</system.web> 
```

它适用于我在 goDaddy 中的网站托管 -

# c#-4.0 - 实体框架 - IQueryable 到 DataTable

> ID：12083740
> 
> 赞同：4
> 
> 时间：2012-08-23T01:55:57.603
> 
> 标签：c#-4.0, entity-framework-4, datatable, linq-to-entities, iqueryable

我正在尝试将`IQueryable`对象转换为`DataTable`. 这是我想转换为的查询示例`DataTable`：

```
var query = DbContext.SomeObjectSet.Select(x => new { PropertyName1 = x.ColumnName1, PropertyName2 = x.ColumnName2 }); 
```

请注意在`Select`方法中创建的匿名对象和属性名称：

```
new { PropertyName1 = x.ColumnName1, PropertyName2 = x.ColumnName2 } 
```

在谷歌搜索这个问题之后，我遇到了以下将`IQueryable`对象转换为 a 的代码`DataTable`：

```
public static DataTable EntityToDatatable(this IQueryable result)
{
    ObjectQuery query = (result as ObjectQuery);

    ObjectContext context = query.Context;

    EntityConnection entityCon = (context.Connection as EntityConnection);

    using (SqlConnection sqlCon = new SqlConnection(entityCon.StoreConnection.ConnectionString))
    {
        using (SqlCommand cmd = new SqlCommand(query.ToTraceString(), sqlCon))
        {
            foreach (var param in query.Parameters)
            {
                cmd.Parameters.AddWithValue(param.Name, param.Value);

            }

            using (SqlDataAdapter dataAdapter = new SqlDataAdapter(cmd))
            {
                using (DataTable dataTable = new DataTable())
                {
                    dataAdapter.Fill(dataTable);

                    return dataTable;

                }

            }

        }

    }

} 
```

上面的代码“工作”和`ToTraceString()`方法中的 SQL 语句如下：

```
SELECT [Extent1].[ColumnName1] AS [ColumnName1], [Extent1].[ColumnName2] AS [ColumnName2] FROM [dbo].[TableName] AS [Extent1] 
```

**问题**：如果在. `columnName1`_ `columnName2`_ `PropertyName1`_ `PropertyName2`_ 如果 SQL 语句列的顺序与匿名对象属性的顺序相同，这不会那么糟糕……但是，**情况并非总是如此**。某处（我猜在 IQueryable 对象内部）SQL 语句列名和生成的匿名对象属性名之间必须存在映射。`ToList()``AsEnumerable()``query`

 **有谁知道如何获得这个映射？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T04:06:24.920

我设法找到了解决我的问题的方法：

首先，您需要以下代码（来自[实体框架如何管理将查询结果映射到匿名类型？](https://stackoverflow.com/questions/7808607/how-does-entity-framework-manage-mapping-query-result-to-anonymous-type?rq=1)），它将我的匿名对象属性的位置映射到 SQL 语句列的位置：

```
public static Int32[] GetPropertyPositions(this ObjectQuery query)
{
    // get private ObjectQueryState ObjectQuery._state; 
    // of actual type internal class 
    //      System.Data.Objects.ELinq.ELinqQueryState 

    Object queryState = GetProperty(query, "QueryState");
    AssertNonNullAndOfType(queryState, "System.Data.Objects.ELinq.ELinqQueryState");

    // get protected ObjectQueryExecutionPlan ObjectQueryState._cachedPlan; 
    // of actual type internal sealed class 
    //      System.Data.Objects.Internal.ObjectQueryExecutionPlan 
    Object plan = GetField(queryState, "_cachedPlan");
    AssertNonNullAndOfType(plan, "System.Data.Objects.Internal.ObjectQueryExecutionPlan");

    // get internal readonly DbCommandDefinition ObjectQueryExecutionPlan.CommandDefinition; 
    // of actual type internal sealed class 
    //      System.Data.EntityClient.EntityCommandDefinition 
    Object commandDefinition = GetField(plan, "CommandDefinition");
    AssertNonNullAndOfType(commandDefinition, "System.Data.EntityClient.EntityCommandDefinition");

    // get private readonly IColumnMapGenerator EntityCommandDefinition._columnMapGenerator; 
    // of actual type private sealed class 
    //      System.Data.EntityClient.EntityCommandDefinition.ConstantColumnMapGenerator 
    Object columnMapGenerator = GetField(commandDefinition, "_columnMapGenerator");
    AssertNonNullAndOfType(columnMapGenerator, "System.Data.EntityClient.EntityCommandDefinition+ConstantColumnMapGenerator");

    // get private readonly ColumnMap ConstantColumnMapGenerator._columnMap; 
    // of actual type internal class 
    //      System.Data.Query.InternalTrees.SimpleCollectionColumnMap 
    Object columnMap = GetField(columnMapGenerator, "_columnMap");
    AssertNonNullAndOfType(columnMap, "System.Data.Query.InternalTrees.SimpleCollectionColumnMap");

    // get internal ColumnMap CollectionColumnMap.Element; 
    // of actual type internal class 
    //      System.Data.Query.InternalTrees.RecordColumnMap 
    Object columnMapElement = GetProperty(columnMap, "Element");
    AssertNonNullAndOfType(columnMapElement, "System.Data.Query.InternalTrees.RecordColumnMap");

    // get internal ColumnMap[] StructuredColumnMap.Properties; 
    // array of internal abstract class 
    //      System.Data.Query.InternalTrees.ColumnMap 
    Array columnMapProperties = GetProperty(columnMapElement, "Properties") as Array;
    AssertNonNullAndOfType(columnMapProperties, "System.Data.Query.InternalTrees.ColumnMap[]");

    Int32 n = columnMapProperties.Length;

    Int32[] propertyPositions = new Int32[n];

    for (Int32 i = 0; i < n; ++i)
    {
        // get value at index i in array 
        // of actual type internal class 
        //      System.Data.Query.InternalTrees.ScalarColumnMap 
        Object column = columnMapProperties.GetValue(i);
        AssertNonNullAndOfType(column, "System.Data.Query.InternalTrees.ScalarColumnMap");

        //string colName = (string)GetProp(column, "Name"); 
        // can be used for more advanced bingings 

        // get internal int ScalarColumnMap.ColumnPos; 
        Object columnPositionOfAProperty = GetProperty(column, "ColumnPos");
        AssertNonNullAndOfType(columnPositionOfAProperty, "System.Int32");

        propertyPositions[i] = (int)columnPositionOfAProperty;

    }

    return propertyPositions;

}

static object GetProperty(object obj, string propName)
{
    PropertyInfo prop = obj.GetType().GetProperty(propName, BindingFlags.NonPublic | BindingFlags.Instance);
    if (prop == null) throw EFChangedException();
    return prop.GetValue(obj, new object[0]);

}

static object GetField(object obj, string fieldName)
{
    FieldInfo field = obj.GetType().GetField(fieldName, BindingFlags.NonPublic | BindingFlags.Instance);
    if (field == null) throw EFChangedException();
    return field.GetValue(obj);

}

static void AssertNonNullAndOfType(object obj, string fullName)
{
    if (obj == null) throw EFChangedException();
    string typeFullName = obj.GetType().FullName;
    if (typeFullName != fullName) throw EFChangedException();

}

static InvalidOperationException EFChangedException()
{
    return new InvalidOperationException("Entity Framework internals has changed, please review and fix reflection code");

} 
```

然后我可以修改`EntityToDatatable`方法如下：

```
public static DataTable EntityToDatatable(this IQueryable query)
{
    SqlConnection sqlConnection = null;
    SqlCommand sqlCommand = null;
    SqlDataAdapter sqlDataAdapter = null;
    DataTable dataTable = null;

    try
    {
        ObjectQuery objectQuery = (query as ObjectQuery);

        ObjectContext objectContext = objectQuery.Context;

        EntityConnection entityConnection = (objectContext.Connection as EntityConnection);

        sqlConnection = new SqlConnection(entityConnection.StoreConnection.ConnectionString);

        sqlCommand = new SqlCommand(objectQuery.ToTraceString(), sqlConnection);

        foreach (var parameter in objectQuery.Parameters)
        {
            sqlCommand.Parameters.AddWithValue(parameter.Name, parameter.Value);

        }

        sqlDataAdapter = new SqlDataAdapter(sqlCommand);

        dataTable = new DataTable();

        sqlDataAdapter.Fill(dataTable);

        // Get the mapping between the object property position and 
        // the SQL statment column position.
        Int32[] propertyPositions = objectQuery.GetPropertyPositions();

        // Create a column name to column position (ordinal) lookup.
        Dictionary<String, Int32> mapColumnNameToColumnPosition = new Dictionary<string, int>();

        // Populate the lookup.
        for (Int32 i = 0; i < propertyPositions.Length; ++i)
        {
            mapColumnNameToColumnPosition.Add(dataTable.Columns[propertyPositions[i]].ColumnName, i);

        }

        // Get the object's property information.
        PropertyInfo[] pi = query.GetType().GetGenericArguments()[0].GetProperties();

        // Iterate through the lookup and change the position of the datatable columns.
        // The order of the datatable columns will now correspond to the order of the object
        // properties.
        foreach (var map in mapColumnNameToColumnPosition)
        {
            // Change the column position.
            dataTable.Columns[map.Key].SetOrdinal(map.Value);

            // Change the column name.
            dataTable.Columns[map.Key].ColumnName = pi[map.Value].Name;

        }

        return dataTable;

    }
    catch (Exception ex)
    {
        // Something went wrong and we're going to raise an exception...we
        // might as well dispose of the datatable if it exists because it's
        // not going to be used.
        if (dataTable != null) dataTable.Dispose();

        throw new Exception("IQueryable to DataTable conversion error.", ex);

    }
    finally
    {
        // Do some cleanup on objects that are no longer needed.

        if (sqlDataAdapter != null) sqlDataAdapter.Dispose();

        if (sqlCommand != null) sqlCommand.Dispose();

        if (sqlConnection != null) sqlConnection.Dispose();

    }

} 
```**

# iphone - Iphone NSStreamDelegate 连接到 java 套接字服务器的问题

> ID：12083744
> 
> 赞同：0
> 
> 时间：2012-08-23T01:56:51.723
> 
> 标签：iphone, sockets

我正在尝试从我的 iphone 模拟器打开一个套接字连接，并将一个简单的 NSString 发送到我在端口 80 中使用 java 设置的本地主机服务器。

我遇到的问题是，当我在 NSOutputStream 上写入数据时，服务器不会接收到它，直到我关闭模拟器。然后服务器接收到数据并抛出此异常 java.net.SocketException: Broken pipe

我知道与关闭 NSOutputStream 和刷新有关，但是如何在 Objective c 中实现这一点？

我在我的初始 ViewController 中调用 ProtocolCommunication，如下所示：

```
 protocol = [[ProtocolCommunication alloc] init];
    [protocol initNetworkCommunication];
    [protocol sendData]; 
```

协议通信类 (IOS)

```
@implementation ProtocolCommunication
@synthesize inputStream, outputStream

- (void) initNetworkCommunication {

CFReadStreamRef readStream;
CFWriteStreamRef writeStream;
CFStreamCreatePairWithSocketToHost(NULL, (CFStringRef)@"localhost", 80, &readStream, &writeStream);
inputStream = (NSInputStream *)readStream;
outputStream = (NSOutputStream *)writeStream;
[inputStream setDelegate:self];
[outputStream setDelegate:self];
//do the Looping
[inputStream scheduleInRunLoop:[NSRunLoop currentRunLoop] forMode:NSDefaultRunLoopMode];
[outputStream scheduleInRunLoop:[NSRunLoop currentRunLoop] forMode:NSDefaultRunLoopMode];
[inputStream open];
[outputStream open];
NSLog(@"INIT COMPLETE");

}

- (void) sendData {

NSString *response  = @"HELLO from my iphone";
NSData *data = [[NSData alloc] initWithData:[response dataUsingEncoding:NSASCIIStringEncoding]];
[outputStream write:[data bytes] maxLength:[data length]];

} 
```

Java 服务器

```
String msgReceived;     
    try {
        ServerSocket serverSocket = new ServerSocket(80);
        System.out.println("RUNNING SERVER");
        while (running) {
            Socket connectionSocket  = serverSocket.accept();
            BufferedReader inFromClient = new BufferedReader(
                    new InputStreamReader(connectionSocket.getInputStream()));
            DataOutputStream outToClient = new DataOutputStream(connectionSocket.getOutputStream());
            msgReceived = inFromClient.readLine();
            System.out.println("Received: " + msgReceived);             
            outToClient.writeBytes("Aloha from server");
            outToClient.flush();
            outToClient.close();
        }

    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } 
```

有任何想法吗？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T02:14:07.300

我通过像这样将 \n 添加到 NSString 来解决它：

```
NSString *response  = @"HELLO from my iphone \n"; // This flushes the NSOutputStream so becarefull everyone 
```

# f# - 反应式框架与 F# 事件有何不同？

> ID：12083747
> 
> 赞同：12
> 
> 时间：2012-08-23T01:57:24.750
> 
> 标签：f#, reactive-programming

如果我已经熟悉 F# 事件，并且我不打算有太多 C# 互操作，那么是否有重要的理由考虑使用反应式框架？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-23T04:00:16.357

我认为有两个主要区别：

*   `IEvent<'T>`首先，接口（和`Event`模块中的函数）和`IObservable<'T>`接口（由`Observable`模块和 Reactive Fx中的函数使用）之间存在差异。[早先已在 SO 上讨论过](https://stackoverflow.com/questions/11747861/what-are-the-similarities-differences-between-control-observable-and-control-e)差异。

*   `Observable`Reactive Framework 是一个更复杂的库，因此它实现了许多 F# 中或模块中不可用的组合器`Event`（尽管有一个[开源项目添加了许多](http://trelford.com/blog/post/MiniRx.aspx)组合器）

总结是，您应该更喜欢`Observable`模块中的功能。如果它拥有你需要的一切，那么就不需要 Reactive Framework。如果没有，那么您将需要 Reactive Framework 或 MiniRx（我相信有时也更有效）。

F#`Event`模块[可以追溯到 2006 年](http://blogs.msdn.com/b/dsyme/archive/2006/03/24/559582.aspx)，所以我认为 Reactive Framework 显然受到了启发，但它并没有完全取代 F# 功能（主要是因为它不是 .NET 或 F# 核心的标准部分）。

# git - Git - 当我提交时，颜色在 vi 中是否意味着什么？

> ID：12083754
> 
> 赞同：30
> 
> 时间：2012-08-23T01:58:08.180
> 
> 标签：git, syntax-highlighting, commit, vi

我在 Windows 上使用 Git Bash，当我运行 时`git commit`，vi 编辑器会打开以允许我编写提交注释。我注意到我写的文本的第一行是黄色的（虽然不是全部，只有前 30 或 40 个字符），第二行是红色背景上的白色，从第三行开始它们是灰色的。这种颜色编码是否意味着什么，还是只是某种奇怪的故障？我来自 SVN 背景，其中 Commit 评论是纯文本，我没想到会出现这种“彩虹”。:)

提前感谢您的答案。

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2012-08-23T02:10:45.567

Vi 提示您“正确”格式化您的提交消息。

虽然没有针对另一种消息样式的特定强制执行，但“[传统上](http://git-scm.com/book/ch5-2.html#_commit_guidelines)”Git 提交消息的结构是这样的：

*   描述变更集的简短标题（通常少于 50-60 个字符）；
*   一个空行；
*   更完整的提交描述，可选地用其他空行分成段落。

最后一段通常用于“元数据”条目，例如`Signed-off-by:`.

因此，在您的情况下，Vi 可能会警告您第一行比平时长一点，并且您没有在其后留下空白行（我说“可能”是因为我不使用 Vi，所以我不确定关于它）。

# apache - 多个相同的 url htaccess 重定向

> ID：12083755
> 
> 赞同：0
> 
> 时间：2012-08-23T01:58:38.620
> 
> 标签：apache, .htaccess, redirect

我创建了一个自定义产品/电子商务网站。它有一个类别、子类别和产品。以下是我要重定向的网址：

```
website.com/clothes
website.com/clothes/
website.com/clothes/tshirts
website.com/clothes/tshirts/
website.com/clothes/tshirts/bluepinned
website.com/clothes/tshirts/bluepinned/ 
```

这是 .htaccess 条目。有没有办法在一行中写下以下内容？例如，如果 URL 是 website.com/clothes/tshirts 确保 PHP 文件意识到我想要加载 tshirts 类别，而不是在衣服类别中显示名为 tshirts 的产品。

```
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^(clothes)/([^/\.]+)/([^/\.]+)/?$ products.php?c=$1&sc=$2&p=$3 [NC,L,QSA] 
RewriteRule ^(clothes)/([^/\.]+)/?$ products.php?c=$1&sc=$2 [NC,L,QSA] 
RewriteRule ^(clothes)/?$ products.php?c=$1 [NC,L,QSA] 
```

在加载产品图像时，有时我也会遇到 406 错误 - 是否有任何重写规则可能导致这种情况发生。无论如何，实际的图像都在一个单独的目录中 website.com/images/clothes/tshirts/bluepinned.jpg

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T02:07:22.657

您需要将条件分别应用于每个规则：

```
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^(clothes)/([^/\.]+)/([^/\.]+)/?$ products.php?c=$1&sc=$2&p=$3 [NC,L,QSA] 

RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^(clothes)/([^/\.]+)/?$ products.php?c=$1&sc=$2 [NC,L,QSA] 

RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^(clothes)/?$ products.php?c=$1 [NC,L,QSA] 
```

也可能存在相对路径与绝对路径问题，可以通过添加

```
<base href="/"> 
```

在您的页眉中。

# python - python: raw_input 函数再次回到顶部

> ID：12083758
> 
> 赞同：-4
> 
> 时间：2012-08-23T01:58:59.633
> 
> 标签：python

我有一个 raw_function 看起来像： number = raw_input('number (empty to finish):')

```
if len(number) == 0:
    print
    print
    print 'finished'
    print
    print
    return def()

else:
    pass

while True:
    try:
        column2 = int(raw_input('Enter column: '))
        break
    except ValueError:
        print 'You did not supply an integer. Please try again. ' 
```

当我回答完我的第二个 raw_input 后​​，我​​想回到第一个 raw_input。我怎样才能做到这一点？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T02:02:30.513

```
 while True:
     number = raw_input('number (empty to finish): ')
     if not number:
        print "\n\nfinished\n\n\n"
        return def()
     while True:
        try:
            column2 = int(raw_input('Enter column: '))
            break
        except ValueError:
            print 'You did not supply an integer. Please try again. ' 
```

# php - modx /Manager shows only 0

> ID：12083760
> 
> 赞同：0
> 
> 时间：2012-08-23T01:59:28.400
> 
> 标签：php, modx

I have received the famous white screen of death before on modx but this is new to me; it is similar to the WSoD but a 0 is written to the page. The manager page used to work and I have not made any changes to the code on the site in quite some time (although someone has modified page content within modx)...

I am using:

PHP Version 5.2.17 MySql Client 5.0.51a PHP safemode is off.

Any ideas would be appreciated. Could this possibly be something with server memory?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T02:16:15.033

您当然已经转储了缓存，删除了 core/cache 目录 etc-etc-etc 中的所有文件/文件夹。

如果您的 php post_max_size 太小、内存不足 [至少 32M] 您的安全模式正确、全局寄存器已关闭，管理器中可能会发生非常奇怪的事情？我发现的唯一方法是我正在调整 php 设置并在 128 之后忘记了“M”，使我的帖子大小为 128 字节......不好。

另外 - 我通过将管理器文件夹移动到备份 [mv manager manager.bak] 然后“升级”到相同版本解决了一些无法解决的管理器问题。

# objective-c - const global string literal corrupted

> ID：12083765
> 
> 赞同：1
> 
> 时间：2012-08-23T02:00:41.080
> 
> 标签：objective-c, ios, xcode

I have a const string literal that is getting corrupted.

What is strange is that it is apparently behaving differently depending upon the version of XCode that is installed (I've got to do a few more experiments before I can 100% confirm this), but even if its not Xcode then I'm wondering what the cause could be.

If the exact same code is run on the exact same handset but with one run its connected to a laptop running Xcode 3.3.3 then this problem is manifesting, if the same code and same handset is run with a different laptop with XCode 4.3.2 or 4.4 installed then the problem does not manifest.

The issues is this:

```
HeaderFile.h
extern NSString* const kValue;

HeaderFile.m
NSString* const kValue = @"Some Value";

OtherFile.m
#import "HeaderFile.h"
...
NSLog(@"Value is: %@", kValue); 
```

When connected to the laptop with Xcode 4.3.3 then the value logged or observed when debugging for the global constant is corrupt.

Any ideas how this could be?

As its a const literal it should not be possible for it to be scribbled over if there is a bug in my code.

UPDATE: I examined the value of kValue immediately after didFinishLaunchingWithOptions: gets called and its already corrupted at that point, so there's no opportunity for my code to scribble on it, even if it is scribable.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T03:43:30.047

*由于它是一个 const 文字，如果我的代码中有错误，它不应该被乱写。*

这并不完全正确。

首先， const 甚至可以通过简单的强制转换来移除。其次，如果您有一个严重的错误，您可能正在写入存储变量的内存，因为您正在访问另一个变量的内存之外（例如，如果您获取 a 的地址`short`并将其转换为类型`long*`然后访问它）。第三，您将指针本身声明为 const，但指向的数据不是 const（至少不是根据声明）。

另一方面，一般来说，你观察到的东西确实是不可能的。通常，声明为 const 的全局变量放在运行时只读的内存区域中。但并非所有硬件都允许这样做，并且对编译器没有真正的要求。通常，字符串文字也被视为 const，这意味着实际上您指向的内容也可能存储在 const 区域中（即使指针不是 const）。

我不知道你为什么会观察到这种行为，而且我不知道编译器和 iPhone 硬件的内部结构，所以我不能说是否真的不可能因为错误而修改该数据。但我知道根据语言规则，编译器（和硬件）将所有内容存储在可修改区域中是完全合法的。如果这就是他们所做的，那么是的，一个错误可能是问题所在。

# php - 将值计算从 SQL 移到 PHP 层会更好吗？

> ID：12083767
> 
> 赞同：1
> 
> 时间：2012-08-23T02:01:47.100
> 
> 标签：php, mysql, performance, query-optimization

此方法用于选择用户和目标用户之间的操作数，例如仅在两个用户之间。此方法的结果值取决于`GetTotalOfPossibleActions()`动态的返回值（每个用户都有自己的编号）。

**问题：**将值计算从 SQL 移到 PHP 层会更好吗？

```
public function GetAction() {

    // ...

    $MaxActionCount = $this->GetTotalOfPossibleActions();

    return registry::getInstance()->get('DB')->select(
        'SELECT
            `Action`
            , `HA`.`Id` AS `ActionId`
            , IF(`Count` IS NULL
                , IF('.$MaxActionCount.' % 2
                    , IF(`HA`.`Id` = 1
                        , CEIL('.$MaxActionCount.' / 2)
                        , FLOOR('.$MaxActionCount.' / 2))
                    , '.$MaxActionCount.' / 2)
                , GREATEST(IF('.$MaxActionCount.' % 2
                    , IF(`HA`.`Id` = 1
                        , CEIL('.$MaxActionCount.' / 2) -  CONVERT(`H`.`Count`, SIGNED)
                        , FLOOR('.$MaxActionCount.' / 2) - CONVERT(`H`.`Count`, SIGNED))
                    , '.$MaxActionCount.' / 2 - `H`.`Count`), 0)
            ) AS `CountLeft`
        FROM `Help` AS `H`
        RIGHT JOIN `HelpAction`  AS `HA`
        ON `H`.`ActionId` = `HA`.`Id`
        AND `UserId` = '.$this->UserId.'
        AND `TargetUserId` = '.$this->TargetUserId.'
        AND `CreatedDate` = CURDATE()'));

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T06:50:56.133

没有硬性和快速的答案，但以下是我应用的一般指南。

PHP 服务器可以负载平衡和倍增。因此，如果您的 CPU 周期不足，您可以相对轻松地添加另一个 PHP 服务器。反之，MySQL 服务器也不能轻易成倍增加。您可以添加复制服务器并在从属服务器上运行复杂的“选择”，但复制会增加一点压力，并且在主服务器上的更新与从服务器上可用之间总是存在延迟。（永远不要相信说它是毫秒的数据库管理员；当服务器处于压力之下/有备份等时它会变慢。）

所以 +1 给 PHP。

但是，SQL 的构建和设计目的是对数据进行计算。这就是它的工作。它的效率要高得多（假设您正确设计了表、查询和索引）。

所以 +1 到 mySQL。

如果在 MySQL 上进行计算，也不需要将整个数据表转给 PHP 进行处理和处理。这节省了两者之间的网络流量。

所以 +1 到 mySQL。

但是，如果您正在努力获取正确的查询，或者 MySQL 正在耗尽所有内存，不停地创建临时表并交换到硬盘，那么通过分解 PHP 中的计算来调试和发现问题要容易得多. MySQL EXPLAIN 和慢查询日志有时令人沮丧。

所以 +1 给 PHP。

所以... 2个。如果您在一台服务器上同时拥有两者，并且查询没有给您带来问题，那么让 MySQL 来完成它的工作。如果您遇到查询问题，请退回到 PHP。如果您在多台服务器上，请尽可能多地使用 MySQL，而不会遇到瓶颈。如果 MySQL 是瓶颈并且无法复制，请退回到 PHP。但随后检查网络流量。

然后记得在你的负载增加时重新评估......

# javascript - Chrome 中的本地文件访问

> ID：12083769
> 
> 赞同：0
> 
> 时间：2012-08-23T02:02:07.993
> 
> 标签：javascript, html, css, google-chrome

我遇到了一些本地网络原型设计的问题；

我一直在通过使用--allow-file-access-from-files 启动我的Chrome 来访问C:/ 上的文件的单个页面。太好了，我的第一页已经成功运行，它按预期加载到我的 .js、.css 文件等中。

但是，当我单击链接进入下一页时，会加载 HTML，但没有加载任何样式、javascript（甚至图像）。

尽管 file:// url 指向正确的位置，但我在控制台中收到“加载资源失败”错误。

有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T02:12:41.533

代替解决方案，一些建议：在您的计算机上设置一个 Web 服务器进行测试。在类似于“生产”环境的环境中开发，而不是解决本地文件访问的怪癖，从长远来看，将为您节省相当多的时间。

有许多工具可以帮助您设置开发 Web 服务器；[XAMPP](http://www.apachefriends.org/en/xampp.html)是一个流行的。

# c++ - c++ std::sort a std::vector using a function return value

> ID：12083770
> 
> 赞同：1
> 
> 时间：2012-08-23T02:02:10.143
> 
> 标签：c++, sorting, stl, vector

I have a `Policy` class with the following function:

```
double Policy::meanResponse(); 
```

Suppose I have a vector of `Policy` objects (`myPolicies`) that I wish to sort, and I wish to sort based on the value of `Policy::meanResponse()`. I have tried the following:

```
bool compare_by_function(const Policy& p1, const Policy& p2)
{
    return ( p1.meanResponse() < p2.meanResponse() );
}

sort(myPolicies.begin(), myPolicies.end(), compare_by_function); 
```

But I get the error:

> "error: passing 'const Policy' as 'this' argument of 'double Policy::meanResponse()' discards qualifers"

**Can someone please explain how to correctly sort in this case?**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T02:05:19.690

Did you try changing meanResponse to const?

```
double Policy::meanResponse()const; 
```

Since you are passing the Policy objects to the compare function with const reference you can't call non-const methods on them.

[http://www.parashift.com/c++-faq-lite/const-member-fns.html](http://www.parashift.com/c++-faq-lite/const-member-fns.html)

# java - 我如何将 getsource() 与来自 [org.eclipse.swt.widgets.Event] 的事件一起使用

> ID：12083773
> 
> 赞同：0
> 
> 时间：2012-08-23T02:02:33.930
> 
> 标签：java, eclipse, swt, verify

我想验证文本中的输入。确保该值在 0 到 100 之间。但由于某种原因，我无法使用`VerifyEvent`它。如下，我想在公共无效中获得“检查”值`handleEvent(Event event)`我该怎么做

```
control.addListener (SWT.Verify, new Listener () {
    public void handleEvent(VerifyEvent e) {
        // TODO Auto-generated method stub
        Text text = (Text)e.getSource();
        String t = text.getText();
        String check = t.substring(0, e.start) + e.text + t.substring(e.end);
        e.doit = validateInput(check);
    }
    @Override
    public void handleEvent(Event event) {
        // TODO Auto-generated method stub
    }
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T07:34:30.330

好的，所以您想添加 a `SWT.Verify`，但您不能使用 a `VerifyListener`with `VerifyEvent`，因此无法访问`event.getSource()`. 但是，由于您`Listener`手动添加，因此您知道来源：

```
final Text textField = new Text(shell, SWT.BORDER);
textField.addListener(SWT.Verify, new Listener() {
    @Override
    public void handleEvent(Event e) {
        // You can access textField, since it is final
        final String oldS = textField.getText();
        String newS = oldS.substring(0, e.start) + e.text + oldS.substring(e.end);

        boolean isValid = true;

        if("".equals(newS))
        {
        }
        else
        {
            try
            {
                // first check, if text really is a number
                float value = Float.parseFloat(newS);

                // then check if it's between 0 and 100
                if(value < 0 || 100 < value)
                    isValid = false;
            }
            catch(NumberFormatException ex)
            {
                isValid = false;
            }
        }

        // if text is not a valid number, prevent user input
        if(!isValid)
            e.doit = false;
    }
}); 
```

所以你添加`Listener`到`textField`. 因此，您不需要该`getSource()`方法，因为`textField`来源...

# java - profile in eclipse/jetty

> ID：12083774
> 
> 赞同：1
> 
> 时间：2012-08-23T02:02:36.400
> 
> 标签：java, jetty, profile

I have installed runjettyrun in Eclipse, now I can run/profile with jetty; but in the profiler config tab, there's no jetty selection. How can I add jetty to profile selections; or are there some other ways that can meet my need to profile a jetty hosted WS? Thanks!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T12:35:40.653

在这种情况下，我很少使用 eclipse 插件，而是选择编写一个小的 main 方法来连接并运行它，或者编写一个可以暂停以检查状态或调试的单元测试。测试用例中嵌入式使用的jetty源码中有很多例子。

[http://git.eclipse.org/c/jetty/org.eclipse.jetty.project.git/tree/example-jetty-embedded/src/main/java/org/eclipse/jetty/embedded](http://git.eclipse.org/c/jetty/org.eclipse.jetty.project.git/tree/example-jetty-embedded/src/main/java/org/eclipse/jetty/embedded)

如果您选择研究此选项，这些示例可以帮助您继续前进。

# java - Java Returning a Boolean Error

> ID：12083775
> 
> 赞同：4
> 
> 时间：2012-08-23T02:02:39.230
> 
> 标签：java, methods, boolean, return, collision

I am a new-comer to the java language, and I'm confused as to why I am getting an error here. It's a very short piece of code that I seem to have a mental block about. Any suggestions?

```
public class Rigidbody {
    public boolean checkCircleCollision(float x1,float y1,float size1,float x2,float y2,float size2){
        if(Math.sqrt(((x2-x1)^2)+((y2-y1)^2))<=(size1+size2)){
            return true;
        }
    }
} 
```

Does anyone know what I'm missing here? (It's probably really obvious).

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-23T02:05:24.143

Well, firstly, [you forgot to have an `else` clause](https://stackoverflow.com/a/12083785/591495):

```
public boolean checkCircleCollision(float x1, float y1, float r1,
    float x2, float y2, float r2) {
  if (Math.sqrt(((x2 - x1) ^ 2) + ((y2 - y1) ^ 2)) <= (r1 + r2)){
    return true;
  } else {
    return false;
  }
} 
```

[Someone else already pointed out](https://stackoverflow.com/a/12083789/591495) this can be shortened as follows:

```
public boolean checkCircleCollision(float x1, float y1, float r1,
    float x2, float y2, float r2) {
  return Math.sqrt(((x2 - x1) ^ 2) + ((y2 - y1) ^ 2)) <= (r1 + r2);
} 
```

(make sure to upvote them for pointing those out :-)

* * *

However, your code is still wrong.

As stated [here](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/op3.html), Java's `^` operator is for *exclusive bitwise OR*, not exponentiation. Perhaps you want [`Math.pow()`](http://docs.oracle.com/javase/7/docs/api/java/lang/Math.html#pow(double,%20double))?

> Returns the value of the first argument raised to the power of the second argument.

```
public boolean checkCircleCollision(float x1, float y1, float r1,
    float x2, float y2, float r2) {
  return Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2)) <= (r1 + r2);
} 
```

Or, you can also just use [`Math.hypot`](http://docs.oracle.com/javase/7/docs/api/java/lang/Math.html#hypot(double,%20double)) rather than rolling your own!

> Returns sqrt(x^2 + y^2) without intermediate overflow or underflow.

```
public boolean checkCircleCollision(float x1, float y1, float r1,
    float x2, float y2, float r2) {
  return Math.hypot(x2 - x1, y2 - y1) <= (r1 + r2);
} 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-08-23T02:04:06.710

You can make the method's body much simpler...

```
public class Rigidbody {
    public boolean checkCircleCollision(float x1,float y1,float size1,float x2,float y2,float size2){
        return Math.sqrt(((x2-x1)^2)+((y2-y1)^2))<=(size1+size2)    
    }
} 
```

The result of `<=` is always a Boolean.

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-08-23T02:03:24.890

You forgot the `else` part of the `if`.

```
public boolean checkCircleCollision(float x1,float y1,float size1,float x2,float y2,float size2){
    if (Math.sqrt(Math.pow(x2-x1, 2)+ Math.pow(y2-y1,2)) <= (size1+size2)) {
        return true;
    } else {
        return false;
    }
} 
```

Which can be simplified to:

```
public boolean checkCircleCollision(float x1,float y1,float size1,float x2,float y2,float size2){
  return Math.sqrt(Math.pow(x2-x1, 2)+ Math.pow(y2-y1,2)) <= (size1+size2);
} 
```

**EDIT**: Also, as noted by **@veer**, you are using `^2` when you should be using `Math.pow`, since the `^` operator in Java is a bitwise XOR, not the power operator. So go **upvote and accept his [answer](https://stackoverflow.com/a/12083804/140816)**, as that is the main cause of the error.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-23T02:24:44.200

OP 在他/她的代码中存在问题，因为`^`应该替换为 的符号用法，`Math#pow()`每个都好！但他/她在问**它缺少什么**。答案很简单：每个方法都必须返回一个值，方法*除外*`void`。

如果你有

```
public boolean aBooleanMethod(int x) {
    //some fancy and nice code!
    return true;
} 
```

编译器会很高兴。但是，如果你这样做：

```
public boolean anotherBooleanMethod(int x) {
    if (x < 2) {
        return true;
    }
} 
```

编译器会抛出异常：

> 此方法必须返回布尔类型的结果。

为什么是这样？因为在方法结束时，编译器会找到一个无法返回值的路径，因此`false`Java 编译器不会让程序崩溃或返回意外结果（比如没有关联的返回），而是会抛出异常。

如何解决？简单：**不要忘记**在方法中的每条路径上返回一个值。

最后一段代码解决问题的方法：

1.  `return`在方法的末尾添加一个默认值。这是几乎所有程序员都使用的常用方法。

    ```
    public boolean anotherBooleanMethod(int x) {
        if (x < 2) {
            return true;
        }
        //if the method has never returned true, then it must return false...
        return false;
    } 
    ```

2.  对于布尔结果，您可以返回一个条件：

    ```
    public boolean anotherBooleanMethod(int x) {
        //your method always return a value, no compiler problems
        //the value depends if x is less than 2 (true) or 2 or more (false)
        return (x < 2);
    } 
    ```

关于`void`方法的异常，这并不意味着void方法不能使用`return`关键字，只是意味着它必须返回“nothing”。要发布示例：

```
public void theVoidMethod(int x) {
    System.out.println("Welcome to theVoidMethod!");
    if (x < 2) {
        //return nothing! End of the method
        return;
    }
    System.out.println("You've reached the bottom of theVoidMethod!");
    //here, the Java compiler will add a return sentence for you, no need to code it
    //return
} 
```

如果您使用 1 和 2 作为参数测试此方法，您将得到不同的结果：

虚空方法（1）：

```
Welcome to theVoidMethod! 
```

虚空方法（2）：

```
Welcome to theVoidMethod!
You've reached the bottom of theVoidMethod! 
```

现在，要解决代码中的另一个问题，您应该使用该`Math#pow`方法而不是`^`符号，但这在其他答案中有大量解释。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-08-23T02:09:41.043

试试这个，我已经使用 Math.pow 作为正方形。还为 else 条件添加了 return 语句。

```
 public class Rigidbody {

     public boolean checkCircleCollision(float x1,float y1,float size1,float x2,float                     y2,float size2){
            return (Math.sqrt(Math.pow((x2-x1), 2) + Math.pow((y2-y1), 2)) <= (size1+size2));   
     } } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-23T03:27:45.253

当该条件为假时，它不会返回任何东西，这就是它错误的原因。

```
public class Rigidbody {
public boolean checkCircleCollision(float x1,float y1,float size1,float x2,float y2,float size2){
    if(Math.sqrt(((x2-x1)^2)+((y2-y1)^2))<=(size1+size2)){
        return true;
    }
    else{
        return false
    }
}
} 
```

# php - 当目录中存在文件时如何运行 PHP 文件 - 编码服务器

> ID：12083786
> 
> 赞同：0
> 
> 时间：2012-08-23T02:03:44.510
> 
> 标签：php, file, encoding, cron, video-encoding

我正在制作一个编码服务器，需要一点帮助

我有一个名为 upload 的目录和一个名为 videoConverter.php 的 php 文件，当它运行时它有一个循环，将转换上传目录中的所有视频文件并将完成的文件通过 FTP 传输到流媒体服务器。

脚本没有问题，但问题是一旦循环完成，它不会转换循环结束后上传的任何新文件。当文件上传到上传的目录时，我需要找到执行 php 文件或脚本。

我正在考虑使用 cron 作业并每秒运行 php 文件，但它不会在脚本已经运行时继续运行吗？

有谁知道解决这个问题的好方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T02:20:22.057

对于这样的任务，我不会坚持使用 PHP，它只是编码工具和文件本身之间的低效层——你需要一个事件驱动的工具，而不是脚本语言。

我最好查看[inotify](http://inotify.aiken.cz/)以了解上传文件夹中的本地更改，然后随时随地处理新文件。

我的第一个想法是在**Node.js**环境中使用[inotify 包装器：](https://github.com/c4milo/node-inotify)

 ***   每当出现新文件时，`encode(newFile)`都会调用它；
*   编码过程完成后，`pushToFTP(encodedFile)`会触发回调并开始传输。

奖励，由于异步 js 架构，较小的文件不必等到整个工作完成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T02:08:55.053

你可以这样做：

1.  脚本从 cron 唤醒，检查 'pid' 文件。
2.  如果它找到一个 pid 文件，它会关闭
3.  如果没有找到 pid 文件，则将其 pid 写入当前目录。
4.  然后它开始处理视频文件。
5.  完成后，或在必须退出的任何故障时，它会删除/取消链接 pid 文件。

现在，如果进程失败并且从不取消失败的链接，这可能会产生问题，不会运行其他作业。

您可以做的另一件事是执行引导脚本 exec('ps aux | grep VIDEO_SCRIPTNAME'); （或其他），如果您看到脚本已经在运行，请不要执行视频转换脚本。在该示例中，您将有两个文件，一个由 cron 运行并检查当前是否正在进行视频转换的引导程序，以及第二个文件，即实际执行工作的文件。**

# ios - iPad SplitViewController Memory Warning Causes Problems With Master View

> ID：12083788
> 
> 赞同：0
> 
> 时间：2012-08-23T02:03:56.630
> 
> 标签：ios, ipad, uisplitviewcontroller, memory-warning

I have an iPad SplitViewController application with the following features:

*   master (left hand) view controller is hidden in both portrait and landscape by returning YES in the shouldHideViewController delegate method
*   master view controller contains a tab bar controller
*   I utilise a multiple master detail manager to manage swapping the detail view controller based upon the selection made by the user in the master tab bar

I have a problem that only occurs after a memory warning is received by the application. When the master view slides in (either via a swipe or tapping the left bar button) the view appears effectively empty i.e. it does not contain any table view, just the semi-transparent background where the table view should be. If I tap the other view in my tab bar it loads it's master view correctly. If I then tap back to the problem view it now appears correctly.

Originally I had another problem in that not only was the view empty but it was also sized for full screen. I was able to fix the size problem via the solution proposed in [this SO question](https://stackoverflow.com/questions/9649608/uisplitview-new-slide-in-popover-becomes-fullscreen-after-memory-warning-in-ios) - it is noted in the solution that "Apparently when a memory warning is received, the view controller gets released, so when it presents itself again, it gets it's size from it's parent view, which is full screen. So you just have to reset the frame every time it gets loaded."

By putting break points in my code I can verify that when I first try to access the master view after a memory warning the ViewDidLoad event is called (this does not occur if there has not been a memory warning), however the ViewDidAppear & ViewWillAppear events are not called. So the app is aware that it needs to reload the master view after a memory warning, but for some reason it does not seem to show the master view.

I'm struggling to work out how to correctly make the view appear again after a memory warning. Or is there something I should be doing to prevent the master view from being unloaded when a memory warning is received?

UPDATE: I have also observed that if the master view is showing at the time of the memory warning then this problem does not occur.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T01:47:47.000

我向 Apple 技术支持提出了这个问题。他们的答复如下：

> 对雷达的搜索表明这是 iOS 5.1 中的一个已知问题，并且工程部门已经意识到了这一点。目前，除了确保您没有收到内存警告外，似乎没有解决此问题的方法。
> 
> 如果您愿意，可以在 [http://bugreporter.apple.com/](http://bugreporter.apple.com/)提交其他错误。此外，我建议您尝试一下，看看它在 iOS 6 中是否仍然存在问题。如果是，请提交错误并将雷达编号发送给我，以便我跟踪它。

我按照他们的建议做了，并在 iOS 6 中进行了尝试。我发现问题没有出现，因此似乎在 iOS 6 中得到了修复。Apple 没有为 iOS 5.1 提供解决方案。

# sql - 从 2 个表中创建 2 个 select 语句，然后将结果与第三个表连接

> ID：12083794
> 
> 赞同：0
> 
> 时间：2012-08-23T02:04:39.343
> 
> 标签：sql, sqlite

我有一个包含三个表的数据库：

表格1

```
CREATE TABLE "A" ( "id" INTEGER PRIMARY KEY  NOT NULL 
                  ,"cat_id" INTEGER NOT NULL
                  ,"date" DATETIME NOT NULL
                  ,"amount" VARCHAR NOT NULL  DEFAULT (0.0)
                  ,"notes" VARCHAR) 
```

表 2：

```
CREATE TABLE "B" ( "id" INTEGER PRIMARY KEY  NOT NULL
                  ,"cat_id" INTEGER NOT NULL
                  ,"date" DATETIME NOT NULL
                  ,"amount" VARCHAR NOT NULL  DEFAULT (0.0)
                  ,"notes" VARCHAR) 
```

表3：

```
CREATE TABLE "c" ( "id" INTEGER PRIMARY KEY  NOT NULL
                  ,"parent_id" INTEGER NOT NULL  DEFAULT (0)
                  ,"name" VARCHAR NOT NULL
                  ,"position" INTEGER NOT NULL
                  ,"importance" INTEGER NOT NULL  DEFAULT (0)
                  ,"transaction_type" VARCHAR NOT NULL  DEFAULT expenses
                  ,"icon" VARCHAR NOT NULL  DEFAULT default
                  ,"budget" INTEGER NOT NULL  DEFAULT 0
                  ,"status" INTEGER NOT NULL  DEFAULT 1) 
```

我使用此语句从表中进行选择，`A`并且`B`：

```
SELECT * FROM A
UNION ALL
SELECT * FROM B 
ORDER BY date 
```

我想将此 select 语句的结果与第三个表`C`连接起来：

```
RIGHT JOIN C on A.cat_id = C.id
RIGHT JOIN C on B.cat_id = C.id 
```

我怎样才能做到这一点？！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T02:19:13.087

您可以通过组合 SQL 语言的元素来做到这一点：

```
select ab.*, c.*
from ((SELECT *
       FROM A
      ) UNION ALL
      (SELECT *
       FROM B
      )
     ) ab right join
     C
     on ab.cat_id = c.id
ORDER BY date 
```

这使得联合全部成为子查询，然后从那里进行连接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T02:34:03.480

你也可以加入联合表）就像数学中的分配属性：

```
select *
from (
      (SELECT * FROM A right join C
        on ab.cat_id = c.id) 
      UNION ALL
      (SELECT * FROM B right join C
        on ab.cat_id = c.id)
     ) ab 
ORDER BY date 
```

但是，由于双重连接，这不是最好的方法。

# node.js - How can I make a union of mongoose queries in node.js?

> ID：12083795
> 
> 赞同：-1
> 
> 时间：2012-08-23T02:04:39.800
> 
> 标签：node.js, mongodb

Here's my current code:

```
Model.containing(req.user.location, function(err, models) {
  if (err) throw err;
  res.render('models/index', {title: 'Models', models: models});
}); 
```

I get a list of models that contain the user's location. It works great. Now I want to get all of those previous models and one extra. I could retrieve this extra model with something like:

```
Model.find().where('name').equals('desired name').exec(function(err, models) {
 //got my models!
}); 
```

Could I combine them to do something like this?

```
Model.containing(req.user.location, function(err, models) {
  if (err) throw err;
  Model.find().where('name').equals('desired name').exec(function(err, newModels) {
    var allModels = models + newModels;
    res.render('models/index', {title: 'Models', models: allModels});
  });
}); 
```

Thanks!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T04:17:48.017

几乎，但是因为`models`和`newModels`是数组，您需要调用`concat`来合并它们而不是使用`+`：

```
var allModels = models.concat(newModels); 
```

# html - mysterious space between images in a table

> ID：12083798
> 
> 赞同：1
> 
> 时间：2012-08-23T02:05:07.590
> 
> 标签：html, css, layout

> **Possible Duplicate:**
> [html, css - weird invisible margin below pictures](https://stackoverflow.com/questions/1383048/html-css-weird-invisible-margin-below-pictures)

I'm working on this site: [https://dl.dropbox.com/u/2241201/tivoli-animation/index.html](https://dl.dropbox.com/u/2241201/tivoli-animation/index.html)

It's just a table with a bunch of `<td><img src='' /></td>`

I've set the width and height, but I don't know where that weird white space is coming from. I also know the images are the correct size, and there doesn't seem to be any padding or margin issues here when I `inspect element` in chrome.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-23T02:11:29.857

发生这种情况是因为您的图像默认情况下是内联的，所以基本上它们就像文本一样，在基线下留下空间。您可以使用`block`以下方法制作它们：

```
table img {
    display: block;
} 
```

您可以在此处阅读更多相关信息：[图像、表格和神秘差距 - MDN 上](https://developer.mozilla.org/en-US/docs/Images,_Tables,_and_Mysterious_Gaps)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T02:49:35.803

尝试将 DOCTYPE 部分更改为：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"> 
```

你也可以检查这个： [http ://www.emailonacid.com/blog/details/C18/12_fixes_for_the_image_spacing_in_html_emails](http://www.emailonacid.com/blog/details/C18/12_fixes_for_the_image_spacing_in_html_emails)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T02:31:03.163

我不会尝试教您正确的 html 网页设计，但表格实体并不像您使用它那样用于页面组织。查看这些幻灯片以了解正确的浮动/定位、页面部分和 html 框模型。

[http://www.cs.washington.edu/education/courses/cse190m/12su/lectures/slides/lecture05-float.shtml#](http://www.cs.washington.edu/education/courses/cse190m/12su/lectures/slides/lecture05-float.shtml#)

# javascript - JavaScript - ( 函数 () {} () )？

> ID：12083806
> 
> 赞同：3
> 
> 时间：2012-08-23T02:05:50.013
> 
> 标签：javascript

> **可能重复：**
> [javascript函数与（函数（）{...}（））；](https://stackoverflow.com/questions/4806150/javascript-function-vs-function)

我在几个[TodoMVC](http://addyosmani.github.com/todomvc/)的 JS[源代码](http://addyosmani.github.com/todomvc/architecture-examples/backbone/js/models/todo.js%29)中看到了这种模式：

```
(function() {
    // ...
    // ...
}()); 
```

这个模式的具体含义是什么？请注意，它不是自调用函数`(function() {})();`

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-23T02:07:10.207

> 这个模式的具体含义是什么？请注意，它不是自调用函数`(function() {})();`

你错了，它**是**一个立即调用函数表达式（IIFE）。括号只是在不同的位置，但它们的绑定方式完全相同。

人们经常按照您描述的方式来验证[JSLint](http://www.jslint.com/)。

它用于范围界定，因为 JavaScript 只有函数和全局范围（忽略`let`）。

# windows - x64 调用约定（堆栈）和可变参数

> ID：12083810
> 
> 赞同：5
> 
> 时间：2012-08-23T02:06:34.377
> 
> 标签：windows, 64-bit, calling-convention, win64

我已经阅读了[微软的文档](http://msdn.microsoft.com/en-us/library/dd2wa36c.aspx)，但是这个方案太尴尬了，我想我会仔细检查以确保我理解正确......

我的理解是传递参数的通用方法是这样的：

```
--- bottom of stack ---
(return address)
[shadow space for arg 1]
[shadow space for arg 2]
[shadow space for arg 3]
[shadow space for arg 4]
arg N
arg N - 1
arg N - 2
...
arg 6
arg 5
---- top of stack ----- 
```

实施时似乎很尴尬`va_arg`……这真的正确吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-23T05:39:33.690

正确的图是

```
--- Bottom of stack ---    RSP + size     (higher addresses)
arg N
arg N - 1
arg N - 2
...
arg 6
arg 5
[shadow space for arg 4]
[shadow space for arg 3]
[shadow space for arg 2]
[shadow space for arg 1]
(return address)
---- Top of stack -----    RSP            (lower addresses)
[grows downward] 
```

返回地址位于堆栈顶部（最近被压入），后跟前四个参数的影子空间，然后是参数 5 及以后的参数。

参数从右向左压入：最后一个参数（N）被最先压入，所以它最接近栈底。

# asp.net - css 960 网格系统问题

> ID：12083818
> 
> 赞同：0
> 
> 时间：2012-08-23T02:07:58.533
> 
> 标签：asp.net, css

我正在使用 960 网格系统和`container_12`. 问题是我正在使用 2 `grid_6`col 并且文本重叠。当我尝试将`overflow`属性设置为时，`auto`我得到一个滚动面板，但文本不会在宽度之后的下一行移动。

```
 <%@ Page Language="C#" AutoEventWireup="true" CodeFile="Default.aspx.cs" Inherits="_Default" %>

    <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title></title>
    <link href="css/960.css" rel="stylesheet" type="text/css" />

    <link href="css/reset.css" rel="stylesheet" type="text/css" />
    <link href="css/text.css" rel="stylesheet" type="text/css" />
    <link href="css/Style.css" rel="stylesheet" type="text/css" />
</head>
<body>
    <form id="form1" runat="server">
    <div id="body" class="container_12">

    <div id="header" class ="grid_12">This is header</div>
    <div id="nav" class="grid_3">
    Navigation
    <ul>
    <li><a href ="google.com">Google</a></li>
     <li><a href ="yahoo.com">yahoo</a></li>
      <li><a href ="bing.com">bing</a></li>
    </ul>
    <p>dcjkldsjfkdjkljdsklvjkjvkdjkfljdskfjkdsjfkldjsfkjdksjkfjkd</p>
    </div>
    <div class="grid_9" >
    <div id="content">
    <h1>Content</h1>
    <p>The premise of the system is ideally suited to rapid prototyping, 
    but it would work equally well when integrated into a production environment. 
    There are printable sketch sheets, design layouts, and a CSS file that have identical  measurements.</p></div></div>
                   </div>
                  </form>
                  </body>
                  </html>
Problem here-:
<p>dcjkldsjfkdjkljdsklvjkjvkdjkfljdskfjkdsjfkldjsfkjdksjkfjkd</p> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T02:20:52.900

确保容器内只有一层网格，例如：

```
<div class="container_12">
  <div class="grid_6"></div>
  <div class="grid_6"></div>
</div> 
```

如果要为内容区域添加填充，请在网格内添加一个额外的 div，不要向网格本身添加填充，即。

```
<div class="container_12">
  <div class="grid_6"><div class="space"></div></div>
  <div class="grid_6"><div class="space"></div></div>
</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-02T18:41:17.633

我有同样的问题。我有一个“grid_3”，我把虚拟内容放在那里，但它一直从 div 中溢出。我也只是从头到尾复制并粘贴了一个单词，看看它是什么样子的。我回去并在单词之间添加了空格，并且效果很好。不会在 div 之外扩展，它会停止并垂直扩展。960 中存在什么样的错误或故障？

# java - 自定义 PDF 创建 - 大图像

> ID：12083820
> 
> 赞同：1
> 
> 时间：2012-08-23T02:08:16.457
> 
> 标签：java, pdf, pdf-generation

寻找基于 Java 的 PDF 创建库。我们目前正在使用带有 HTML 的 Apache Velocity 来动态渲染 PDF。

我们希望能够找到一种在 PDF 容器中以创造性的方式渲染大图像（有时大至 3000 x 1700）的方法。例如，PDF 中的可滚动图像窗格。这在 PDF 中可能是不可能的，我可能错了。

开源将是理想的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T03:20:57.190

对于一个好的 PDF 库，你应该看看 iText： http: [//itextpdf.com/](http://itextpdf.com/) 我已经使用了大约 5000x4000 的 iText 图像，没有任何问题。

我不知道是否可以在 PDF 中创建一个工作滚动窗格，除非您当然是通过自定义 PDF 创建者/查看器来完成的。

iText 是开源的，但请务必在商业使用之前查看 AGPL 许可证：http: [//itextpdf.com/terms-of-use/agpl.php](http://itextpdf.com/terms-of-use/agpl.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T20:06:10.460

对于仅从图像创建 PDF 文件，iText 的尺寸有点过大。给[xsPDF](http://code.google.com/p/xspdf/)一个机会，它对图像大小没有限制，似乎适合您的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-27T21:23:59.627

对于将来可能遇到这种情况的任何人，仅供参考：

我使用了一个名为 PDFBox (http://pdfbox.apache.org/) 的库来打开一个预先存在的 PDF，并使用带有图像尺寸的自定义大小的 PDFRectangle 修改 PDF。然后将图像和矩形插入该新页面并获得所需的结果。

我没有意识到您可以在一个 PDF 中拥有多个页面大小。

# python - UPDATE 和 INSERT 在 Python 中不起作用

> ID：12083821
> 
> 赞同：0
> 
> 时间：2012-08-23T02:08:34.693
> 
> 标签：python, mysql

我使用此代码来检索 id。有用：

```
 db = MySQLdb.connect("localhost","root","","proyectoacademias" )

        cursor = db.cursor()

        sql = "SELECT id FROM test WHERE url=\'"
        sql = sql + self.start_urls[0]
        sql = sql + "\'"

        cursor.execute(sql)

        data = cursor.fetchone()

        for row in data:
            self.id_paper_web=str(row)

        db.close() 
```

它给了我必须更新的当前行的 ID...

但是后来我尝试更新或插入，它不起作用....

```
 def guardarDatos(self):
    db = MySQLdb.connect("localhost","root","","proyectoacademias" )

    cursor = db.cursor()

    sql = "UPDATE test SET abstract=\'"+str(self.abstracto)+"\', fecha_consulta=\'"+str(self.fecha_consulta)+"\', anio_publicacion=\'"+str(self.anio_publicacion)+"\', probabilidad="+str(self.probabilidad)+" WHERE id = "+str(self.id_paper_web)

    print "\n\n\n"+sql+"\n\n\n"
    cursor.execute(sql)      

    for i in range (len(self.nombres)):
        sql = "INSERT INTO test_autores VALUES (\'"+self.nombres.keys()[i]+"\', "+str(self.id_paper_web)+", \'"+self.instituciones[self.nombres[self.nombres.keys()[i]]]+"\', "+str((i+1))+")"
        print "\n\n\n"+sql+"\n\n\n"
        cursor.execute(sql)

    db.close() 
```

我打印了我发送的每个 sql 查询，它们似乎很好......没有抛出异常，只是没有更新或插入数据库......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T02:10:13.833

您必须提交...或将数据库设置为自动提交

```
db.commit() 
```

那里有很多 py sqlite3 教程

> 默认情况下，sqlite3 模块在数据修改语言 (DML) 语句（即 INSERT/UPDATE/DELETE/REPLACE）之前隐式打开事务，并在非 DML、非查询语句（即除了 SELECT 或之前所提）。
> 
> 因此，如果您在事务中并发出诸如 CREATE TABLE ...、VACUUM、PRAGMA 之类的命令，则 sqlite3 模块将在执行该命令之前隐式提交。这样做有两个原因。首先是其中一些命令在事务中不起作用。另一个原因是 sqlite3 需要跟踪事务状态（如果事务处于活动状态）。
> 
> 您可以通过 connect() 调用的isolation_level 参数或连接的isolation_level 属性来控制sqlite3 隐式执行（或根本不执行）哪种BEGIN 语句。
> 
> 如果您想要自动提交模式，则将isolation_level 设置为None。
> 
> 否则将其保留为默认值，这将产生一个简单的“BEGIN”语句，或者将其设置为 SQLite 支持的隔离级别之一：“DEFERRED”、“IMMEDIATE”或“EXCLUSIVE”。

*   [http://docs.python.org/library/sqlite3.html](http://docs.python.org/library/sqlite3.html) Section 11.13.6

# air - 如何将 Flash Builder 4.6 升级到 AIR 3.4？

> ID：12083822
> 
> 赞同：0
> 
> 时间：2012-08-23T02:08:53.743
> 
> 标签：air, adobe, flash-builder

AIR 3.4 刚刚发布，具有工作者和原生 APN 支持等功能。

如何升级现有的 Flash Builder 安装以使用新的 AIR SDK？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-23T02:08:53.743

**将 Flash Builder 4.6 升级到 AIR 3.4**

Mac OSX 的使用说明。

1) 转到现有 FB 目录中的**sdks**目录。在我的机器上是 /Applications/Adobe Flash Builder 4.6/sdks。

**编辑：我发现合并的 Flex/AIR SDK 在这里可用：http: [//gaming.adobe.com/getstarted/](http://gaming.adobe.com/getstarted/)**

**我之前在这里的指令的合并版本不会产生稳定的 SDK。从上面的链接下载 SDK，解压到某个地方（注意如果你在 Flash Builder 的 sdks 目录下解压它会覆盖你现有的 4.6.0 目录），然后执行以下操作。**

2) 将新的 SDK 添加到 Flash Builder，在**Project -> Properties -> Flex Compiler -> Configure Flex SDKs**下。单击**Add**，然后选择新的 SDK 文件夹。

**在“其他编译器参数”**字段中将以下命令行标志添加到您的项目中：

```
-swf-version=17 
```

**3) 将-app.xml**文件（项目目录的根目录）中的目标更改为 3.4：

```
<application xmlns="http://ns.adobe.com/air/application/3.X"> 
```

到

```
<application xmlns="http://ns.adobe.com/air/application/3.4"> 
```

4) 开始使用新功能，如工人和 iOS 推送通知支持。创建引人入胜的应用程序，带来疯狂的硬币，并在向我支付适度的（按百分比计算）津贴以实现您新发现的财务独立后，年轻而快乐地退休。

那应该这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-25T16:43:54.587

不要使用以下文件： -air-config.xml -airmobile-config.xml -flex-config.xml - 位于主题中的 build.xml 文件 -flex-config.xml

还需要更改才能使用 3.4 sdk？

# python - 代码执行中的小问题，python纸牌游戏模拟

> ID：12083834
> 
> 赞同：1
> 
> 时间：2012-08-23T02:10:10.587
> 
> 标签：python, simulation, game-engine

给所有可能相关的人，

这是纸牌游戏模拟的一些代码。（战争游戏）。当我运行它时，我收到此错误：

```
player0.append(player1[range(warcard1 + 1)] 
      ^
SyntaxError: invalid syntax 
```

我不知道错误是什么，但也许这里有人知道。希望有人可以为我解决这个问题。当然，该代码仍在进行中，因此如果有任何其他错误，我很乐意听到它们及其可能的解决方案。

```
import random

cards = ['ace', 'ace', 'ace', 'ace', '1', '1', '1', '1', '2', '2', '2', '2', '3', '3', '3', '3', '4', '4', '4', '4', '5', '5', '5', '5', '6', '6', '6', '6', '7', '7', '7', '7', '8', '8', '8', '8', '9', '9', '9', '9', '10', '10', '10', '10', 'jack', 'jack', 'jack', 'jack', 'queen', 'queen', 'queen', 'queen', 'king', 'king', 'king', 'king']

order = ['ace', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', 'jack', 'queen', 'king'] 

print "shuffling cards" 
random.shuffle(cards,random.random)
print "lets play"
player0 = [cards[i] for i in range(len(cards)) if i % 2 == 1]

player1 = [cards[i] for i in range(len(cards)) if i % 2 == 0]

while (len(player0) > 0 or len(player1) > 0):

    nextcard0 = player0[0]
    nextcard1 = player1[0]

    cardplayed0 = order.index(nextcard0)

    cardplayed1 = order.index(nextcard1)

    if cardplayed0 > cardplayed1:

        player0.append(nextcard0)
        player0.append(nextcard1)
        player0.remove(nextcard0)
        player1.remove(nextcard1)

    elif cardplayed0 < cardplayed1:

        player1.append(nextcard1)
        player1.append(nextcard0)
        player1.remove(nextcard1)
        player0.remove(nextcard0)

    elif cardplayed0 == cardplayed1:
        while warcardvalue0 == warcardvalue1:
            if len(player0) >= 4:
                warcard0 = 4
            elif len(player0) < 4:
                warcard0 = len(player0)

            if len(player1) >= 4:
                warcard1 = 4
            elif len(player1) < 4:
                warcard1 = len(player1)

            warcardvalue0 = order.index(warcard0)
            warcardvalue1 = order.index(warcard1)

            if warcardvalue0 > warcardvalue1:
                player0.append(player0[range(warcard0 + 1)]
                player0.append(player1[range(warcard1 + 1)] 
                player0.remove(player0[range(warcard0 + 1)]
                player1.remove(player1[range(warcard1 + 1)] 

            elif warcardvalue0 < warcardvalue1:
                player1.append(player1[range(warcard1 + 1)]
                player1.append(player0[range(warcard0 + 1)] 
                player1.remove(player1[range(warcard1 + 1)]
                player0.remove(player0[range(warcard0 + 1)] 
            else
                print "another war!" 

if len(player1) == 0:
    print "player1 won!"
elif len(player0) == 0:
    print "player0 won!" 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T02:11:36.613

错误消息中指示的行

```
player0.append(player1[range(warcard1 + 1)] 
                                           ^ 
```

缺少一个结束`)`

事实上，所有这些行都缺少结束括号：

```
 if warcardvalue0 > warcardvalue1:
            player0.append(player0[range(warcard0 + 1)]
            player0.append(player1[range(warcard1 + 1)] 
            player0.remove(player0[range(warcard0 + 1)]
            player1.remove(player1[range(warcard1 + 1)] 

        elif warcardvalue0 < warcardvalue1:
            player1.append(player1[range(warcard1 + 1)]
            player1.append(player0[range(warcard0 + 1)] 
            player1.remove(player1[range(warcard1 + 1)]
            player0.remove(player0[range(warcard0 + 1)] 
```

您可能需要查看您的代码以确保没有其他此问题的实例。

*此外*，您可能会考虑（并且肯定会受益）为您进行[paren匹配](http://en.wikipedia.org/wiki/Brace_matching)的编辑器，并会提醒您类似的问题。我用了一个，绝对值得。

如果您对此类编辑器感兴趣，这可能是一个开始探索选项的地方：[带大括号匹配的 10 大最佳文本编辑器](http://text-editor.pikimal.com/top/10/with-brace-matching/pikirank)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T02:12:10.980

`append`您在每个/`remove`行上都缺少右括号。

# ios - 如何确保在 iOS MapKit 中显示叠加层

> ID：12083836
> 
> 赞同：3
> 
> 时间：2012-08-23T02:10:34.833
> 
> 标签：ios, mkmapview, overlay, mapkit

我查看了几篇关于如何在 MKMapView 中实现覆盖的 StackOverflow 帖子和 Apple 文档。对我来说，我对在我的地图上显示 MKPolygon 对象特别感兴趣。我发现从根本上说，这个过程归结为以下几点：

*   链接到 MapKit 和 CoreLocation 框架
*   为 MKMapKit 对象创建一个出口并将视图控制器声明为委托
*   声明一个包含多边形点的 CLLocationCoordinate2D 数组，并使用类方法 polygonWithCoordinates:count 创建一个 MKPolygon 对象：
*   调用 map 的 addOverlay: 并将新创建的 MKPolygon 对象作为参数传递
*   实现 (MKOverlayView *)mapView:(MKMapView *)mapView viewForOverlay:(id)overlay

稍后，我可能不得不在给定时间在地图上显示 20-30 个多边形。但是，在我探索如何显示叠加层（现在硬编码测试示例，而不是从文件中读取数据）时，我发现我可以显示一些叠加层，但不能显示其他叠加层。阅读 Apple 的 Location Awareness Programming Guide 时，我遇到了一个覆盖在科罗拉多州上方的多边形示例。那行得通。但是当我试图制作一个覆盖堪萨斯州的多边形时，我无法让它工作。似乎我尝试自己制作的任何多边形（安柏瑞德航空大学多边形和堪萨斯多边形）都不会显示，但我在网上获得的那些多边形工作得很好。我使用 Google Earth 创建多边形，然后将它们导出为 KML 文件以获取坐标。

我的 ViewController 的实现代码如下。只是想找出我可能无意中做错了什么来造成这个问题。提前感谢您的帮助。

```
#import "ViewController.h"
#import <CoreLocation/CoreLocation.h>

@interface ViewController ()

@end

@implementation ViewController

@synthesize mapView;

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.

    // Array of coordinates for polygon covering state of Colorado ... DISPLAYS PERFECTLY

    CLLocationCoordinate2D points[4];

    points[0] = CLLocationCoordinate2DMake(41.000512, -109.050116);
    points[1] = CLLocationCoordinate2DMake(36.99892, -109.045267);
    points[2] = CLLocationCoordinate2DMake(36.993076, -102.041981);
    points[3] = CLLocationCoordinate2DMake(41.002371, -102.052066);

    MKPolygon *polygon = [MKPolygon polygonWithCoordinates:points count:4];
    [mapView addOverlay:polygon];
    [polygon release];

    // Array of coordinates for polygon covering state of Kansas ... DOESN'T DISPLAY

    CLLocationCoordinate2D kansasPoints[9];

    kansasPoints[0] = CLLocationCoordinate2DMake(-102.0595440241806, 39.99774930940907);
    kansasPoints[1] = CLLocationCoordinate2DMake(-102.0424467175215, 36.99846609483674);
    kansasPoints[2] = CLLocationCoordinate2DMake(-94.62550551403953, 36.98936020770036);
    kansasPoints[3] = CLLocationCoordinate2DMake(-94.58798745384412, 39.11683771419185);
    kansasPoints[4] = CLLocationCoordinate2DMake(-94.79955391183, 39.21290793052091);
    kansasPoints[5] = CLLocationCoordinate2DMake(-95.13489191971419, 39.51613476830012);
    kansasPoints[6] = CLLocationCoordinate2DMake(-94.86553124171813, 39.78380472206268);
    kansasPoints[7] = CLLocationCoordinate2DMake(-95.02618283417986, 39.89072859904893);
    kansasPoints[8] = CLLocationCoordinate2DMake(-95.31904155494097, 39.99390420513669);

    MKPolygon *kansasPolygon = [MKPolygon polygonWithCoordinates:kansasPoints count:9];
    [mapView addOverlay:kansasPolygon];
    [kansasPolygon release];

    // Array of coordinates for polygon covering part of Daytona Beach, FL campus
    // of Embry-Riddle Aeronautical University... DOESN'T DISPLAY

    CLLocationCoordinate2D erauPoints[7];

    erauPoints[0] = CLLocationCoordinate2DMake(-81.05176, 29.18492);
    erauPoints[1] = CLLocationCoordinate2DMake(-81.04409, 29.18801);
    erauPoints[2] = CLLocationCoordinate2DMake(-81.05166, 29.19293);
    erauPoints[3] = CLLocationCoordinate2DMake(-81.05365, 29.19536);
    erauPoints[4] = CLLocationCoordinate2DMake(-81.05465, 29.19493);
    erauPoints[5] = CLLocationCoordinate2DMake(-81.05376, 29.19323);
    erauPoints[6] = CLLocationCoordinate2DMake(-81.05506, 29.19188);

    MKPolygon *erauPolygon = [MKPolygon polygonWithCoordinates:erauPoints count:7];
    [mapView addOverlay:erauPolygon];
    [erauPolygon release];

    // Array of coordinates taken from http://www.shawngrimes.me/2011/04/adding-polygon-map-overlays/
    // for commuter parking lot at Capitol College in Maryland ... DISPLAYS PERFECTLY

    CLLocationCoordinate2D commuterLotCoords[5]={
        CLLocationCoordinate2DMake(39.048019,-76.850535),
        CLLocationCoordinate2DMake(39.048027,-76.850234),
        CLLocationCoordinate2DMake(39.047407,-76.850181),
        CLLocationCoordinate2DMake(39.047407,-76.8505),
        CLLocationCoordinate2DMake(39.048019,-76.850535)
    };

    MKPolygon *commuterPoly1 = [MKPolygon polygonWithCoordinates:commuterLotCoords count:5];
    [mapView addOverlay:commuterPoly1];
    [commuterPoly1 release];
}

- (void)viewDidUnload
{
    [super viewDidUnload];
    // Release any retained subviews of the main view.
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return (interfaceOrientation != UIInterfaceOrientationPortraitUpsideDown);
}

- (MKOverlayView *)mapView:(MKMapView *)mapView viewForOverlay:(id<MKOverlay>)overlay {
    if ([overlay isKindOfClass:[MKPolygon class]]) {
        MKPolygonView *polygonView = [[[MKPolygonView alloc] initWithOverlay:overlay] autorelease];
        polygonView.fillColor = [[UIColor cyanColor] colorWithAlphaComponent:0.3f];
        polygonView.strokeColor = [UIColor redColor];
        polygonView.lineWidth = 1.0f;

        return polygonView;
    }

    return nil;
}

@end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T02:17:23.160

看起来不显示的多边形的坐标的纬度和经度参数是向后的。

例如，这个：

```
kansasPoints[0] = CLLocationCoordinate2DMake(-102.0595440241806, 39.99774930940907); 
```

应该

```
kansasPoints[0] = CLLocationCoordinate2DMake(39.99774930940907, -102.0595440241806); 
```

此外，您不应该调用您正在使用`release`的对象，因为它们将被自动释放。`MKPolygon``polygonWithCoordinates`

# ios - 通用iphone、ipad应用

> ID：12083847
> 
> 赞同：0
> 
> 时间：2012-08-23T02:12:11.243
> 
> 标签：ios, objective-c

我正在使用比例`< 1.1` 或`> 1.9`区分低分辨率和视网膜版本：

```
if (([[UIScreen mainScreen] scale] < 1.1) {}
if (([[UIScreen mainScreen] scale] > 1.9) {} 
```

我的问题：是否所有 iPhone 都具有`< 1.1`低分辨率刻度，所有 iPad 都具有`< 1.1`低分辨率刻度？

所有具有比例视网膜的 iPhone`> 1.9`和所有具有比例视网膜的 iPad `> 1.9`？

似乎是这样，但我只想确定有这么多设备。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T04:14:37.117

只要您可以依靠 iOS 4.0 或更高版本，您的建议就可以正常工作。然而，正如其他人所指出的，您不需要检查分数比例。从[UIScreen 文档](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIScreen_Class/Reference/UIScreen.html)：

> 默认逻辑坐标空间使用点进行测量，其中一个点大约等于 1/160 英寸。如果设备的屏幕具有相当相似的像素密度，则比例因子通常设置为 1.0，以便一个点映射到一个像素。但是，具有显着不同像素密度的屏幕可能会将此属性设置为更高的值。

对于所有当前设备`scale`，将返回 1.0 或 2.0。

一个需要注意的警告在这个 StackOverflow 答案中讨论了如何[检测 Retina Display](https://stackoverflow.com/a/4641481/1441264)。那就是原来的 iPad 运行的是 iOS 3.2，没有这个`scale`属性。如果您的目标是那么远，则需要考虑这一点，并假设您没有视网膜显示器，如果`UIScreen`不响应`scale`.

# php - 在 PHP 中解析/覆盖日期

> ID：12083861
> 
> 赞同：0
> 
> 时间：2012-08-23T02:14:30.747
> 
> 标签：php

如何以如下格式解析日期：

```
Wen, 22-Jul-2010 12:33:10 +0200 
```

以 RFC_922 格式或其他类似的格式`Y-m-d H:i:s`？

谢谢你的帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T02:15:43.883

`date('Y-m-d H:i:s', strtotime('Wed, 22-Jul-2010 12:33:10 +0200') );`

一个班轮，请注意，它不能直接与提供的日期一起使用，因为您写的是“Wen”而不是“Wed”，但我认为您不会收到以这种方式出错的日期。

如果你这样做了，那么`str_replace`像这样调用：`$yourDate = str_replace('Wen', 'Wed', $yourDate);`在将日期传递给 strtotime 之前。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T02:19:20.480

`date_parse()`也可能是一个不错的选择

# android - unregisterReceiver 杀死了我的 Toast 弹出窗口

> ID：12083863
> 
> 赞同：0
> 
> 时间：2012-08-23T02:14:34.583
> 
> 标签：android, broadcastreceiver, toast

我正在编写我的第一个 Android 应用程序，一个音板/铃声应用程序，但我的 Toast 通知没有显示有问题。我有一个调用 DownloadManager 的按钮，从 Internet 下载 mp3，将其保存到 sdcard，并将其分配为铃声。这一切都很好，但我知道我必须在 DownloadManager 完成后取消注册接收器。一旦 DownloadManager.STATUS_SUCCESSFUL 出现，我想要一个 Toast 弹出说“铃声已设置”，如果我注释掉我的“onStop / unregisterReceiver”块，它确实有效。一旦我重新激活该块，Toast 就不会显示。我感谢任何帮助，而且我对 android 编码或任何编程都非常陌生。谢谢！

```
package com.gameringers.ffringers;

import java.io.File;

import android.app.Activity;
import android.app.DownloadManager;
import android.app.DownloadManager.Query;
import android.app.DownloadManager.Request;
import android.content.BroadcastReceiver;
import android.content.ContentValues;
import android.content.Context;
import android.content.Intent;
import android.content.IntentFilter;
import android.database.Cursor;
import android.media.RingtoneManager;
import android.net.Uri;
import android.os.Bundle;
import android.os.Environment;
import android.provider.MediaStore;
import android.view.View;

import android.widget.Toast;

public class DownloadActivity extends Activity {
private long enqueue;
private DownloadManager dm;

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    Intent intent = getIntent();
    String songfile = intent.getStringExtra(FFVI.SONG_FILE);
    String songtitle = intent.getStringExtra(FFVI.SONG_TITLE);
    setContentView(R.layout.activity_download);

    BroadcastReceiver receiver = new BroadcastReceiver()

    {

        @Override
        public void onReceive(Context context, Intent intent)
        {

                Query query = new Query();

                Cursor c = dm.query(query);
                if (c.moveToFirst()) {
                    int columnIndex = c
                            .getColumnIndex(DownloadManager.COLUMN_STATUS);

                    if (DownloadManager.STATUS_SUCCESSFUL == c
                            .getInt(columnIndex)) {

                        Toast.makeText(getBaseContext(), "Ringtone Has Been Set!",
                                Toast.LENGTH_LONG).show();  

                          finish();

                    }

                  } 

                }   

           // }

    };  

    registerReceiver(receiver, new IntentFilter(
            DownloadManager.ACTION_DOWNLOAD_COMPLETE));

    String path=(Environment.getExternalStorageDirectory()+"/gameringers");
   // String filename="Test11"+".mp3"; 

    sendBroadcast(new Intent(Intent.ACTION_MEDIA_SCANNER_SCAN_FILE, Uri.parse(path+songfile)));

    File k = new File(path, songfile);

    ContentValues values = new ContentValues();
    values.put(MediaStore.MediaColumns.DATA, k.getAbsolutePath());
    values.put(MediaStore.MediaColumns.TITLE, (songtitle));
    values.put(MediaStore.MediaColumns.MIME_TYPE, "audio/mp3");
    values.put(MediaStore.Audio.Media.ARTIST, "N/A");
    values.put(MediaStore.Audio.Media.IS_RINGTONE, true);
    values.put(MediaStore.Audio.Media.IS_NOTIFICATION, false);
    values.put(MediaStore.Audio.Media.IS_ALARM, false);
    values.put(MediaStore.Audio.Media.IS_MUSIC, false);

    //Insert it into the database
    Uri newUri= this.getContentResolver().insert(MediaStore.Audio.Media.getContentUriForPath(k.getAbsolutePath()), values);

    RingtoneManager.setActualDefaultRingtoneUri(
    this,
    RingtoneManager.TYPE_RINGTONE,
    newUri);

    onStop();
    {

        unregisterReceiver(receiver);
        super.onStop();
    }

}

public void setringtone(View v) {

    Intent intent = getIntent();
    String songfile = intent.getStringExtra(FFVI.SONG_FILE);
    String songtitle = intent.getStringExtra(FFVI.SONG_TITLE);
     Toast.makeText(getBaseContext(), songfile+songtitle,
            Toast.LENGTH_LONG).show();

    dm = (DownloadManager) getSystemService(DOWNLOAD_SERVICE);

    Request request = new Request(
            Uri.parse("http://www.gameringers.com/ringers/ff/"+songfile));

    request.setDestinationInExternalPublicDir("/gameringers",songfile);

    enqueue = dm.enqueue(request);

}

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T02:32:11.650

```
onStop();
{

    unregisterReceiver(receiver);
    super.onStop();
} 
```

问题中的上述代码看起来很奇怪。正确的应该是

```
/** Receiver for download completion */
BroadcastReceiver mReceiver;

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    Intent intent = getIntent();
    String songfile = intent.getStringExtra(FFVI.SONG_FILE);
    String songtitle = intent.getStringExtra(FFVI.SONG_TITLE);
    setContentView(R.layout.activity_download);

    mReceiver = new BroadcastReceiver()

    {

        @Override
        public void onReceive(Context context, Intent intent)
        {
                Query query = new Query();

                Cursor c = dm.query(query);
                if (c.moveToFirst()) {
                    int columnIndex = c
                            .getColumnIndex(DownloadManager.COLUMN_STATUS);

                    if (DownloadManager.STATUS_SUCCESSFUL == c
                            .getInt(columnIndex)) {

                        Toast.makeText(getBaseContext(), "Ringtone Has Been Set!",
                                Toast.LENGTH_LONG).show();  

                          finish();

                    }

                  } 

                }   

           // }

    };  

    registerReceiver(receiver, new IntentFilter(
            DownloadManager.ACTION_DOWNLOAD_COMPLETE));

    String path=(Environment.getExternalStorageDirectory()+"/gameringers");
   // String filename="Test11"+".mp3"; 

    sendBroadcast(new Intent(Intent.ACTION_MEDIA_SCANNER_SCAN_FILE, Uri.parse(path+songfile)));

    File k = new File(path, songfile);

    ContentValues values = new ContentValues();
    values.put(MediaStore.MediaColumns.DATA, k.getAbsolutePath());
    values.put(MediaStore.MediaColumns.TITLE, (songtitle));
    values.put(MediaStore.MediaColumns.MIME_TYPE, "audio/mp3");
    values.put(MediaStore.Audio.Media.ARTIST, "N/A");
    values.put(MediaStore.Audio.Media.IS_RINGTONE, true);
    values.put(MediaStore.Audio.Media.IS_NOTIFICATION, false);
    values.put(MediaStore.Audio.Media.IS_ALARM, false);
    values.put(MediaStore.Audio.Media.IS_MUSIC, false);

    //Insert it into the database
    Uri newUri= this.getContentResolver().insert(MediaStore.Audio.Media.getContentUriForPath(k.getAbsolutePath()), values);

    RingtoneManager.setActualDefaultRingtoneUri(
    this,
    RingtoneManager.TYPE_RINGTONE,
    newUri);
}

@Override
public void onStop();
{
   unregisterReceiver(mReceiver);
   mReceiver = null;
   super.onStop();
}

public void setringtone(View v) {

    Intent intent = getIntent();
    String songfile = intent.getStringExtra(FFVI.SONG_FILE);
    String songtitle = intent.getStringExtra(FFVI.SONG_TITLE);
     Toast.makeText(getBaseContext(), songfile+songtitle,
            Toast.LENGTH_LONG).show();
} 
```

因此，使用您当前拥有的代码，您只需在您的 onCreate() 方法中调用 onStop() 并取消注册接收器。我相信这只是语法错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T19:14:26.030

```
@Override
public void onStop();
{
   unregisterReceiver(mReceiver);
   mReceiver = null;
   super.onStop();
} 
```

绝对是正确的。我只需要弄清楚在我的代码中放置它的位置。它现在有效！谢谢你！

# javascript - 我可以在不显示 webview 的情况下使用 phonegap 吗？

> ID：12083873
> 
> 赞同：4
> 
> 时间：2012-08-23T02:16:17.497
> 
> 标签：javascript, cordova

我知道可以通过插件访问 PhoneGap 应用程序中的本机代码。但是，是否有可能有一个完全原生的接口（在 Android、iOS 和可能的 Windows Phone 上）连接到非 UI 层的 JavaScript 代码（通过 PhoneGap 库增强）？

*我试图解决的问题：*

我正在计划一个至少部分跨平台的应用程序，这样我就不必写三遍了。但是，我也关心为用户界面提供原生性能和外观。

我的理论是，我可以通过编写几个应用程序来获得两全其美的效果，这些应用程序由围绕一个内部共享代码库的瘦 UI 组成。由于我对 JavaScript 相当有能力，我想我会从它开始我的研究。如果 PhoneGap 允许我在没有 webview 的情况下访问 JavaScript，那么我有很多框架代码（例如 i/o）都为我准备好了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T03:14:25.610

我认为PhoneGap 的使用仅限于WebView。

来自[http://phonegap.com/2012/05/02/phonegap-explained-visually/](http://phonegap.com/2012/05/02/phonegap-explained-visually/)：

```
The web view used by PhoneGap is the same web view used by the native 
operating system. On iOS, this is the Objective-C UIWebView class; on Android, 
this is android.webkit.WebView. 
```

然而，制作某种混合应用程序是可能的。您可以在 Objective-C 中编写一个 UITabBar 和其他原生 iOS 内容，然后为典型的 PhoneGap 内容添加一个 UIWebView。但是，如果您支持多个平台，这当然需要额外的工作。

我在[youtube](http://www.youtube.com/watch?v=KVvV_QYnjLo)上找到了一个演示此类应用程序的视频。我发现[这个 SO question/answer](https://stackoverflow.com/questions/9778505/is-the-facebook-app-built-using-a-mobile-development-framework-like-phonegap-or)也非常有用。

# database - 没有数据库和数据集的水晶报表

> ID：12083877
> 
> 赞同：0
> 
> 时间：2012-08-23T02:16:58.977
> 
> 标签：database, vb.net, crystal-reports, dataset

是否可以在不需要数据集和数据库的情况下使用 Crystal Reports？

我有一个带有很多文本框和函数的 gui，它返回很多我需要报告的变量，我设法在没有数据库的情况下使用 Crystal Reports，但没有数据集就没有运气

* * *

抱歉英语不好:(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T03:26:56.117

可以使用 ADO.NET 对象，创建一个具有“列”作为属​​性的类，然后在代码中填充此类的数组。完成后，您将数组指定为报告中的数据源

```
 report.SetDataSource(objectList.ToArray()) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-17T17:02:25.317

你可以在没有数据集的情况下做到这一点，

直接使用下面提到的代码

```
Imports CrystalDecisions.CrystalReports.Engine

     Dim fname20 As TextObject
                fname20 = objRpt.ReportDefinition.ReportObjects("rptdate")
                fname20.Text = "your text" 
```

它很简单，这就是您所需要的

# objective-c - MKMapView 中的注释未显示标题

> ID：12083879
> 
> 赞同：0
> 
> 时间：2012-08-23T02:17:05.653
> 
> 标签：objective-c, ios, mkmapview

我已经成功地在用户位置的点击事件上显示了标题，但我无法让它为我自己的自定义注释工作。我已经尝试在其上设置标题，但它明确但不起作用，我该如何实现？

```
- (MKAnnotationView *)mapView:(MKMapView *)mapView viewForAnnotation:(id <MKAnnotation>)annotation {
    MKPinAnnotationView *userMarkerView = nil; 
    PayMarkerAnnotationView *payMarkerView = nil;

    if(annotation != mapView.userLocation) 
    {
        payMarkerView = (PayMarkerAnnotationView *)[mapView dequeueReusableAnnotationViewWithIdentifier:@"markerView"];
        if(payMarkerView == nil) {
            payMarkerView = [[PayMarkerAnnotationView alloc] initWithAnnotation:annotation reuseIdentifier:@"markerView"];
        }

        payMarkerView.annotation = annotation;
        return payMarkerView;
    } 
    else {
        [mapView.userLocation setTitle:@"You are here"];
        return userMarkerView;
    }
} 
```

班级：

```
@interface PaymentMarker : NSObject <MKAnnotation> {
    NSString* type;
    NSString* address;
    float latitude;
    float longitude;
    NSString* title;
}

@property (nonatomic, copy) NSString* address;
@property (nonatomic, copy) NSString* type;
@property (nonatomic) float latitude;
@property (nonatomic) float longitude;
@property (nonatomic, copy) NSString* title;

//MKAnnotation
@property (nonatomic, readonly) CLLocationCoordinate2D coordinate;

@end

- (id)initWithAnnotation:(id <MKAnnotation>)annotation reuseIdentifier:(NSString *)reuseIdentifier {
    if(self = [super initWithAnnotation:annotation reuseIdentifier:reuseIdentifier]) {
        self.backgroundColor = [UIColor clearColor];
        NSString* imageName;

        if ([annotation isMemberOfClass:[PaymentMarker class]])
        {
            PaymentMarker *pm = (PaymentMarker *)self.annotation;
            if([pm.type isEqualToString:@"nzpost"]) {
                imageName = @"icon-map-post.png";
            } else {
                imageName = @"icon-map-incharge.png";
            }

            self.image = [UIImage imageNamed:imageName];
        }
    }
    return self;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T02:23:14.937

您需要将注释视图的`canShowCallout`属性设置为`YES`.

您可以在块`initWithAnnotation`内的方法中执行此操作`if`：

```
self.canShowCallout = YES;

self.backgroundColor = ... 
```

# javascript - 在 JSON 中对二级数组进行分组

> ID：12083884
> 
> 赞同：1
> 
> 时间：2012-08-23T02:17:51.863
> 
> 标签：javascript, json

我正在寻找 group by 在二级 JSON 字符串中执行。例如，我使用下面的代码来使用 group by 它在 JSON 字符串中有 1 级数组的情况下工作得很好。

```
Array.prototype.groupBy = function(keyName) {
  var res = {};
  this.forEach(function(x) {
    var k = x[keyName];
    var v = res[k];
    if (!v) v = res[k] = [];
    v.push(x);
  });
  return res;
};

var myObject = {
      "groups": [{
            "id": "2",
            "name": "test group 1",
            "category": "clinical note",
            "author": "RRP"
        }, {
            "id": "1",
            "name": "test group 2",
            "category": "clinical image",
            "author": "LKP"
        }, {
            "id": "2",
            "name": "test group 1",
            "category": "clinical document",
            "author": "RRP"
        }, {
            "id": "4",
            "name": "test group 4",
            "category": "clinical note",
            "author": "John"
        }]

}

myObject.groups.sort(function(a,b) { return a.author > b.author } );    

var byJob = myObject.groups.groupBy('id');

for (var author in byJob) {
  document.write('<h3>'+author+','+byJob[author].length+'</h3>');  
  byJob[author].forEach(function(e) {  
    document.write('<p>'+e.id +', '+e.name+'</p>');
  }); 
```

输出：：

```
1,1

1, test group 2

2,2

2, test group 1

2, test group 1

4,1

4, test group 4 
```

现在上面的例子工作得很好，但我正在寻找 JSON 字符串中的二级数组分组。例如，如果我有以下 JSON 字符串::

```
{
    "Category": {
        "old_modi":1,
        "new_modi":1,
        "FORM": [{
            "name":"form1",
            "date":"08/08/2012",
            "location":"abc",
            "PERSON":[{
                "ID":1,
                "author":"xyz"
            }]
        }]
    }
} 
```

期望输出（作者姓名将按其表单名称、日期和位置分组）::

```
xyz
  form1 08/08/2012 xyz 
```

有人知道我在顶部发布的工作副本的哪一部分需要更改吗？

提前致谢..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T03:51:28.623

您可以递归地遍历 javascript 对象。一件棘手的事情是 javascript 对象可以是 json 对象或数组。在我的示例解决方案中，我为它们中的每一个定义了两个不同的 for 循环，可能有一种简单的方法可以做到这一点。无论如何，我的解决方案适用于任何级别的 groupby。这是[jsFiddle](http://jsfiddle.net/kswishaq/QtJax/)

# php - 使用 php 和 css 在样式列表中显示存储在 MySQL 数据库中的图像

> ID：12083885
> 
> 赞同：1
> 
> 时间：2012-08-23T02:18:18.637
> 
> 标签：php, mysql, css, mime-types

我有几个图像存储在数据库中，我试图在样式列表中显示它们。这个想法是当我从数据库中调用图像时，php代码将在样式`<div>`元素内生成列表......不幸的是，情况并非如此。该列表正在生成，但它没有遵循我的任何样式并且图像没有显示。

图像在页面上显示其宽度和高度的边框，但中心缺少文件图标......当我转到数据库时，文件显然在那里，命名和一切。即使我在 URL 末尾输入**file_display.php?id=1**，图像也会出现......

图像以 jpeg 格式保存在数据库中，表中除 LONGBLOG 数据

这是我获取图像并将其显示在列表中的代码：

```
 <div class="template_container">
    <h2>Templates</h2>  
    <ul style="margin: 0 50px;">

        <?php   

            // Grab the data 
            $sql = "select * from templates";
            $result = mysql_query($sql) or die ("Could not access DB: " . mysql_error());
            while ($row = mysql_fetch_assoc($result))
            {
                echo "<li>";
                echo "<a class=\"caption" . "href=\"cart.php?id=<?=" . $row['id'] . "&action=add>";

                echo "<img src=\"http://URL-REMOVED.com/file_display.php?id=<?=" . $row['id'] . "\" alt=\"\" /><br />";
                echo "<span>";
                echo "<big>" . $row['name'] . "<br />";
                echo $row['description'];
                echo "</span>";
                echo "</li>";

            }

        ?>
    </ul>
</div> 
```

这是应该为列表设置样式的css：

```
.template_container {
    width: 100%;
    height: auto;
    border-top: 1px solid #e8e8e8;
    margin: 75px auto 25px auto;
    padding-top: 25px;
}

.template_container h2 {
    font-family: 'Podkova', serif;
    font-size: 58px;
    line-height: 66px;
    color: #2d9dc8; font-weight: normal;
    text-transform: uppercase;
    letter-spacing: -2px; 
    text-align: center;
    margin-bottom: 50px;
}

.template_container ul li { 
    list-style-type: none; 
    display: inline; 
    text-align: center;
    zoom:1; 
    *display:inline;
}

.template_container ul { vertical-align: inherit; }
.template_container li { margin-left: 25px;}
.template_container img { 
    width: 180px;
    margin-bottom: 50px; 
    box-shadow: 0px 0px 10px #888;
    -moz-box-shadow: 0px 0px 10px #888;
    -webkit-box-shadow: 0px 0px 10px #888;
    -khtml-box-shadow: 0px 0px 10px #888;
}

a.caption { 
    position: relative !important;
}
a.caption span { 
    background: #000; 
    background: rgba(0,0,0,0.8); 
    color: white !important; 
    display: none; 
    padding: 5px 10px !important; 
    text-align: center; 
    position: absolute !important;
    bottom: 0 !important; 
    left: 0 !important; 
}
a.caption:hover {
    text-decoration: none;
} 
```

对于那些想知道列表项中的`<a class="caption">`和`<span>`元素的人，我有一个 javascript 可以在悬停时显示这些元素。

**更新：**我发现了我的样式问题，我搞砸了，忘记关闭链接，我不小心`<br />`在图像标签的末尾添加了一个，使得列表不是内联的。

但是我仍然无法看到我的图像......仍在寻找解决方案......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T02:27:29.313

我认为图像 URL 生成有问题：

```
echo "<img src=\"http://URL-REMOVED.com/file_display.php?id=<?=" . $row['id'] . "\" alt=\"\" /><br />"; 
```

为什么需要“<？=”？为什么不只是

```
echo "<img src=\"http://URL-REMOVED.com/file_display.php?id=" . $row['id'] . " alt=\"\" /><br />"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T02:26:52.420

请参考：

[http://en.wikipedia.org/wiki/Data_URI_scheme#Inclusion_in_HTML_or_CSS_using_PHP](http://en.wikipedia.org/wiki/Data_URI_scheme#Inclusion_in_HTML_or_CSS_using_PHP)

# javascript - node.js 上的程序二维数组 mongoDB 插入内存 不足

> ID：12083900
> 
> 赞同：2
> 
> 时间：2012-08-23T02:21:13.787
> 
> 标签：javascript, node.js, mongodb, nodejitsu

我正在尝试通过我的 node.js 服务器将 2000 x 2000 2d 数组插入到我的 mongoDB 实例中。

现在我这样做的方式是：

```
for (i=0; i<2000; i++){
            //i = height of the tile map
            for(x=0; x<2000; x++){
                //x is the width of the tile map
                driver.mongo.insert('worldTiles', {loc: [x,i], elevation: obj.server.theArray[i][x]}, function (err,results){
                    if(!err){

                    }else{
                        console.log('Ran into an error inserting into worldTiles on Mongo');
                    }
                })
            }
            console.log(i);
        } 
```

现在，我面临的问题是，在第 576 行左右，我的 node.js 实例显着减慢（每 40 秒左右处理一行），然后内存不足。我不明白这是如何/为什么会发生的。

我是否正确地解决了这个问题？关于如何在不费力的情况下将这个二维数组放入我的数据库的任何想法？

谢谢大家的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T00:08:32.580

看起来问题出在我的 mongoDB 实例的提供者上。我刚刚发现，在 jitsu 上假脱机 mongo 实例时，内存使用量的大小有 ~64MB 的限制。因此，正是在那一点上，我得到了“内存不足”的错误。

希望他们能以某种方式使错误消息更具描述性，包括*什么设备*内存不足......*翻白眼*。

结案。

# c# - InvalidConstraintException 的自定义消息

> ID：12083904
> 
> 赞同：0
> 
> 时间：2012-08-23T02:21:45.600
> 
> 标签：c#, exception-handling

我正在删除因外部约束而失败的 DataRow。抛出了一个 InvalidConstraintException，我想捕获、记录，然后向用户显示一条消息，说明由于使用它的*表名而无法删除。*

使用 ConstraintException 它会在 DataSet 上设置信息，例如特定行是否存在错误。在这种情况下，有足够的信息让我通过利用该信息来生成消息。InvalidConstraintException 似乎没有设置任何信息。

无论如何，当抛出 InvalidConstraintException 时，我是否可以找到涉及哪些表？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T06:01:02.380

您可以找到数据行的表，请尝试 DataRow.Table

# ruby-on-rails - Rails.js data-remote AJAX 表单出现提交 display:none 元素

> ID：12083911
> 
> 赞同：0
> 
> 时间：2012-08-23T02:24:09.027
> 
> 标签：ruby-on-rails, ajax, forms

我正在使用标准 rails remote => true 方法通过 ajax 提交表单。我在表单中有一些输入文本字段，根据情况选择性地隐藏（通过显示：无）。当这些被隐藏时，我希望它们不会被提交（就像标准表单帖子的情况一样）。

相反，这些字段正在以某种方式与表单一起提交。我在这里梳理了 rails.js 文件：[https](https://github.com/rails/jquery-ujs/blob/master/src/rails.js) ://github.com/rails/jquery-ujs/blob/master/src/rails.js但一直无法找到原因可能正在发生。

这是 ajax 数据远程表单发布方法的预期行为吗？如果是这样，我想我需要完全采用不同的方法，或者在提交之前将这些元素完全移出表单范围。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T02:56:52.990

如果开始时不加载它们的条件，则将它们包装在服务器端。用css隐藏它是愚蠢的。我可以检查 chrome 中的元素，删除隐藏属性，然后用一堆废话发送该字段。

# notifications - 未调用 didReceiveRemoteNotification

> ID：12083915
> 
> 赞同：7
> 
> 时间：2012-08-23T02:24:42.810
> 
> 标签：notifications, push

我对apns问题感到疯狂。

我正在测试 apns 推送通知。我可以很好地收到推送消息。

但现在有些大问题。我想像下面这样讲述我的情况。

*   当我的应用程序运行时，didReceiveRemoteNotification 被很好地调用。

*   当我的应用程序进入后台并收到推送消息，然后如果我触摸我的应用程序，

    1.  未调用 didFinishLaunchingWithOptions。

    2.  未调用 didReceiveRemoteNotification。

    3.  只有 applicationDidBecomeActive 被调用。

那么，在这种情况下如何显示到达的推送消息呢？

我无法访问方法中`(NSDictionary *)userInfo`的对象`applicationDidBecomeActive`。

我找不到任何用于访问 userInfo 的 API。

当从后台变为前台时，我无法访问到达的推送消息，这是胡说八道。

那么我应该再次从我的服务器检索消息吗？如果我应该这样做，为什么存在推送消息架构？这是不合理的。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-12T20:13:54.230

通过点击图标打开应用程序永远不会为您提供有关以前通知的信息。只有当您实际通过通知打开应用程序时，您才能访问通知数据。

如果您点击该图标，如果最近有多个通知，应用程序如何知道您正在响应哪个通知？应用程序如何知道用户甚至完全响应了通知，而不仅仅是出于其他原因打开应用程序？通知并非旨在做你想做的事。

有关更多讨论，请参阅[iOS 推送通知 - 如何在单击应用程序图标而不是通知时获取通知数据](https://stackoverflow.com/questions/12084015/ios-push-notification-how-to-get-the-notification-data-when-you-click-on-the-a)。

# sql - 我的世界时间数据库设计/ORM

> ID：12083917
> 
> 赞同：0
> 
> 时间：2012-08-23T02:25:02.427
> 
> 标签：sql, orm, foreign-keys, many-to-many, relation

我有一个数据库设计，我想获得一些反馈/帮助。

我有 3 个不同的实体：`Cities`, `TimeZones`, `Rules`.

*   a`City`与 1 相关联且仅与 1 相关联`TimeZone`（不是 < 1，不是 > 1：仅 1）
*   a`TimeZone`可能与许多相关联`Cities`（不确定城市的最小数量）。
*   a`TimeZone`正好是 2 `Rules`（DST 和 ST）。
*   每个都`Rule`可能与许多不同的`TimeZones`

我使用 ORM 设计器设计了我的表格，只是为了帮助我可视化：

![我的数据库 ORM](../Images/0b416c4fd92ab3b9831f787e5e0fdd13.png)

在这个 ORM 中，有：

*   `TimeZones`父母和孩子之间的一对多关系`Cities`
*   `TimeZones`父母和孩子之间的一对多关系`TimeZoneRule`
*   `Rule`父母和孩子之间的一对多关系`TimeZoneRule`

现在我的问题：

*   这个多对多连接表可以工作吗？

*   我怎么知道什么`Rule`属于什么`TimeZone`？我有`TimeZone.RuleName`获取`Rule`a的属性，`TimeZone`但是如果我想倒退，说找到所有`TimeZones`适用于规则的内容？

*   我如何使用字符串 ( `RuleName`) 来查找 TimeZone，`Rule`因为 a`TimeZone`有 2 条规则（名称相同但 ID 不同/唯一）。

*   如何使用正确的 ID/行填充此联结表？

*   我知道`City`有一个`TimeZoneId`我添加了实际值的 a，我可以使用它`TimeZoneId`来查找`TimeZone`a`City`所属的，但是我怎样才能找到所有`Cities`a`TimeZone`包含的内容？

下面我粘贴了我为创建这些表而编写的 TSQL 代码，我唯一没有的是关联，因为我从未在 TSQL 中建立关联（很明显）。

```
 USE World_Time

            IF OBJECT_ID('timezones', 'U') IS NOT NULL
                DROP TABLE timezones;
            IF OBJECT_ID('rules', 'U') IS NOT NULL
                DROP TABLE rules;
            IF OBJECT_ID('leaps', 'U') IS NOT NULL
                DROP TABLE leaps;
            IF OBJECT_ID('cities', 'U') IS NOT NULL
                DROP TABLE cities;
            IF OBJECT_ID('timezone_rule', 'U') IS NOT NULL
                DROP TABLE timezone_rule;

            CREATE TABLE timezones
            (
                [id] INT NOT NULL PRIMARY KEY,
                [name] VARCHAR(30) NOT NULL,
                [bias] SMALLINT NOT NULL,
                [rule_name] VARCHAR(10),
                [tz_abreviation] VARCHAR(7) NOT NULL,
                [country_code] CHAR(2) NOT NULL,
                [country_name] VARCHAR(42) NOT NULL,
                [comments] VARCHAR(100),
                [coordinates] VARCHAR(20),
                [version] ROWVERSION
            );

            CREATE TABLE rules
            (
                [id] INT NOT NULL IDENTITY PRIMARY KEY,
                [name] VARCHAR(10) NOT NULL,
                [bias] SMALLINT NOT NULL,
                [start_year] SMALLINT NOT NULL,
                [end_year] SMALLINT NOT NULL,
                [month] TINYINT NOT NULL,
                [date] VARCHAR(7) NOT NULL,
                [time] TIME(0) NOT NULL,
                [time_type] CHAR(1),
                [letter] CHAR(1),
                [version] ROWVERSION
            );

            CREATE TABLE leaps
            (
                [id] INT NOT NULL IDENTITY PRIMARY KEY,
                [year] SMALLINT NOT NULL,
                [month] VARCHAR(3),
                [day] SMALLINT NOT NULL,
                [time] TIME(0) NOT NULL,
                [correction] VARCHAR(1) NOT NULL,
                [rs] VARCHAR(1) NOT NULL,
                [version] ROWVERSION
            );

            CREATE TABLE cities
            (
                [id] INT NOT NULL IDENTITY PRIMARY KEY,
                [name] VARCHAR(200) NOT NULL,
                [ascii_name] VARCHAR(200),
                [alternate_names] VARCHAR(5000),
                [latitude] FLOAT(24),
                [longitude] FLOAT(24),
                [feature_class] CHAR(1),
                [feature_code] VARCHAR(10),
                [country_code] CHAR(2) NOT NULL,
                [country_code2] VARCHAR(60),
                [population] BIGINT,
                [elevation] INT,
                [modification_date] DATETIME NOT NULL,
                [admin1code] VARCHAR(20),
                [admin2code] VARCHAR(80),
                [admin3code] VARCHAR(20),
                [admin4code] VARCHAR(20),
                [gtopo30] INT,
                [timezone_id] INT NOT NULL,
                [timezone_name] VARCHAR(60) NOT NULL,
                [version] ROWVERSION
            );

            CREATE TABLE timezone_rule
            (
                [timezone_id] INT NOT NULL,
                [rule_id] INT NOT NULL,
                PRIMARY KEY (timezone_id, rule_id),
                [version] ROWVERSION
            );

            -- Is this how I would populate the junction table?
            --INSERT INTO timezone_rule
            --  (timezone_id)
            --SELECT id
            --FROM timezones;
            --INSERT INTO timezone_rule
            --  (rule_id)
            --SELECT id
            --FROM rules; 
```

我为我几个月来一直试图这样做的可怕帖子道歉，我厌倦了每天几个小时的 Binging/谷歌搜索：P 感谢您抽出时间阅读，我真的很感激/

-弗朗西斯科

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T03:09:11.760

我将跳过关于您是否真的需要/应该这样做而不是使用标准库的部分，而只是解决时区映射到两个规则的问题。

`Timezone`有一个`RuleId`。它可以有两个`RuleId`s：

*   DstRuleId
*   StruleId

例如：

```
 CREATE TABLE timezones
        (
            [id] INT NOT NULL PRIMARY KEY,
            [name] VARCHAR(30) NOT NULL,
            [bias] SMALLINT NOT NULL,

            [dst_rule_id] INT,
            [st_rule_id]  INT,

            [tz_abreviation] VARCHAR(7) NOT NULL,
            [country_code] CHAR(2) NOT NULL,
            [country_name] VARCHAR(42) NOT NULL,
            [comments] VARCHAR(100),
            [coordinates] VARCHAR(20),
            [version] ROWVERSION
        ); 
```

那将是最简单的。为了获得更大的灵活性，并沿着更关系的路线走下去，`RuleType`可以引入一个表，该表仅以两个条目开头：

*   夏令时
*   英石

这将允许将来扩展规则的能力。但是，您需要从`Rule`表到`RuleType`表的映射，并且`TimeZoneRule`表将引用这些映射。如果高度确信这不会改变，则使用 DstRuleId 和 StRuleId 会更容易。

*   查找规则适用的所有时区？

    `SELECT timezoneid FROM TimeZoneRule WHERE RuleId = ?`

*   我如何使用字符串 (RuleName) 来查找 TimeZone 的规则，因为 TimeZone 有 2 条规则（名称相同但 ID 不同/唯一）。

    *如果您在 TimeZoneRule 中有两列，则为隐式*

*   如何使用正确的 ID/行填充此联结表？

    `INSERT INTO timezone_rule(timezone_id, rule_id) VALUES (?, ?)`

*   我知道 City 有一个 TimeZoneId，我为其添加了实际值，我可以使用这个 TimeZoneId 来查找 City 所属的 TimeZone，但是如何找到 TimeZone 包含的所有 Cities？

    `SELECT id FROM city WHERE timezone_id = ?`

# sql-server - 在 SQL Server 2008 中创建链接服务器以通过 ODBC 推进 Open Edge 10.1C？

> ID：12083918
> 
> 赞同：-1
> 
> 时间：2012-08-23T02:25:27.857
> 
> 标签：sql-server, odbc, linked-server, openedge, progress-db

我有一个到 Progress Open Edge 10.1C 服务器的有效 ODBC 连接（当我单击“测试连接”时它通过了）

如何在使用 ODBC 连接的 SQL Server 中创建链接服务器？我已经尝试过，但收到此错误消息：

![在此处输入图像描述](../Images/b92b1c6bfb22f295723d08316f9d4bb7.png)

我在 Win 2008 服务器上使用 SQL Server 2008。我不知道 Progress 服务器正在运行什么。ODBC DSN 是在 WOW64 ODBC 管理器（不是 32 位 ODBC 管理器）中创建的。

这个页面是谷歌搜索该错误消息时出现的内容：http: [//msdn.microsoft.com/en-us/library/windows/desktop/ms712362 (v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms712362(v=vs.85).aspx)

> "管理64位平台下连接32位驱动的数据源，使用c:\windows\sysWOW64\odbcad32.exe。管理连接64位驱动的数据源，使用c:\ windows\system32\odbcad32.exe。在 64 位 Windows 8 操作系统的管理工具中，有 32 位和 64 位 ODBC 数据源管理器对话框的图标。如果使用 64 位 odbcad32。 exe 配置或删除连接到 32 位驱动程序的 DSN，例如 Driver do Microsoft Access (*.mdb)，您将收到以下错误消息：
> 
> 指定的 DSN 包含驱动程序和应用程序之间的体系结构不匹配
> 
> 要解决此错误，请使用 32 位 odbcad32.exe 配置或删除 DSN。”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T00:55:21.667

最后，正确的答案是四处寻找并找到 OpenEdge 的 64 位 ODBC 驱动程序。

它不容易找到，我无法在此处放置链接，我没有，驱动程序已通过电子邮件发送给我。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-09T14:22:47.870

使用 32 位 ODBC 接口，运行 C:\Windows\SysWOW64\odbcad32.exe（32 位）并在此处设置与 Progress DB 的连接。（这是Skyward吗？）

# c# - 如何使用简单的注入器在运行时更改依赖项注册？

> ID：12083919
> 
> 赞同：6
> 
> 时间：2012-08-23T02:25:32.973
> 
> 标签：c#, .net, dependency-injection, ioc-container, simple-injector

我正在使用[Simple Injector](http://simpleinjector.codeplex.com) IoC 框架，我希望能够在运行时更改依赖项注册。例如，我有两个实现，`A`和`B`，接口`I`。实现`A`是在应用程序启动时注册的，但是根据一些在运行时可能会改变的标志，我想切换实现。我们目前正在执行我们的`OnActionExecuting`事件，我们`BaseController`所有的控制器都继承自该事件。这是我正在尝试做的示例代码。

```
protected override void OnActionExecuting(
    ActionExecutingContext filterContext)
{
    if (IsRuntimeFlag)
    {
        // check current implementation type and 
        // change implementation to A
    }
    else
    {
        // check current implementation type and 
        // change implementation to B
    }

    base.OnActionExecuting(filterContext);
} 
```

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-23T05:56:43.137

如果`IsRuntimeFlag`是配置值（因此在应用程序的生命周期内不能更改），您可以按如下方式进行注册：

```
if (IsRuntimeFlag)
{
    container.Register<I, A>();
}
else
{
    container.Register<I, B>();
} 
```

或同样：

```
container.Register(typeof(I), IsRuntimeFlag ? typeof(A) : typeof(B)); 
```

如果值可以在应用程序的生命周期内发生变化，那么处理分派到正确实例的代理或[组合是正确的解决方案：](https://en.wikipedia.org/wiki/Composite_pattern)

```
public sealed class RuntimeFlagIComposite : I
{
    private readonly A a;
    private readonly B b;

    public RuntimeFlagIComposite(A a, B b) {
        this.a = a;
        this.b = b;
    }

    void I.Method() => this.Instance.Method();

    private I Instance => IsRuntimeFlag ? this.a : this.b;
} 
```

因为复合直接依赖于`A`and `B`，所以可以简单的注册如下：

```
container.Register<I, RuntimeFlagIComposite>();

// Register A and B with their required lifestyles
container.Register<A>(Lifestyle.Singleton);
container.Register<B>(Lifestyle.Transient); 
```

您还可以让您的组合依赖于`I`抽象本身而不是具体`A`和`B`实现：

```
public class RuntimeFlagIComposite : I
{
    private I a;
    private I b;

    public RuntimeFlagIComposite(I a, I b)
    {
        this.a = a;
        this.b = b;
    }
} 
```

依赖于`I`抽象使得这个类更灵活，更可测试。但是，这确实意味着您需要注册它有点不同。这可以使用`RegisterConditional`. 这是一个例子：

```
container.Register<I, RuntimeFlagIComposite>();

container.RegisterConditional<I, A>(c => c.Consumer.Target.Name == "a");
container.RegisterConditional<I, B>(c => c.Consumer.Target.Name == "b"); 
```

# mongodb - 如何在 Rockmongo 或 mongovue 中执行 shell 一些查询？

> ID：12083926
> 
> 赞同：6
> 
> 时间：2012-08-23T02:26:03.923
> 
> 标签：mongodb

我在 mongo.exe 中执行了一个命令。让我们尝试使用最基本的命令。

```
> db.tablebusiness.find({"_id": "the-simmons-paradise__41.85_-87.88"}); 
```

我得到了结果：

现在我在rockmongo中尝试类似的命令。如果我执行

```
db.tablebusiness.find(
    {"_id": "the-simmons-paradise__41.85_-87.88"}
    ); 
```

结果：

```
{
   "retval": null,
   "ok": 1
} 
```

基本上它似乎告诉我结果没问题或类似的东西？我不确定。

如果我详细说明：

```
var cur = db.tablebusiness.find(
{"_id": "the-simmons-paradise__41.85_-87.88"}
);
cur.forEach(function(x){print(tojson(x))}); 
```

结果：

```
{
   "retval": null,
   "ok": 1
} 
```

同样的问题。

如果我做：

```
function () {
   return db.tablebusiness.find({"_id": "the-simmons-paradise__41.85_-87.88"});
} 
```

我有：

```
 {
   "retval": {
     "value": "DBQuery: hello.tablebusiness -> undefined"
  },
   "ok": 1
} 
```

hello.tablebusiness -> undefined 是什么意思超出了我的理解。正如您从上面看到的，我在 mongo.exe 中成功执行了查询

看起来rockmongo的功能非常有限。我想知道如何实际看到结果。如何在rockmongo中执行随机mongodb命令并观察结果。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-08T16:37:49.493

首先我同意你的观点：rockmongo 目前的功能非常有限。我将它用于简单查询，因为它允许我从任何支持浏览的设备访问我的远程服务器。

rockmongo 中的“执行”区域使用[“Javascript API”](http://api.mongodb.org/js/)运行，其行为不像 mongo shell。

试试这个：

```
function () {
    var cur = db.tablebusiness.find(
    {"_id": "the-simmons-paradise__41.85_-87.88"}
    );
    var out = [];
    cur.forEach(function(x){out.push(x);});
    return(out);
} 
```

您可以单击集合名称运行简单查询，在上方区域输入您的查询条件...

```
 {"_id": "the-simmons-paradise__41.85_-87.88"} 
```

...然后“提交查询”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-09T01:34:54.240

另一个答案 - 可能看起来有点奇怪 - 是使用该[`aggregate`](http://docs.mongodb.org/manual/reference/method/db.collection.aggregate/)方法，但仅在单个[`$match`](http://docs.mongodb.org/manual/reference/operator/aggregation/match/#pipe._S_match)命令中使用管道，如下所示：

```
function () {
  return db.tablebusiness.aggregate([
    { $match: {
      "_id": "the-simmons-paradise__41.85_-87.88"
    }}
  ]);
} 
```

# matlab - fft 和小波

> ID：12083930
> 
> 赞同：2
> 
> 时间：2012-08-23T02:26:43.277
> 
> 标签：matlab, fft, octave, wavelet

我可以使用 fft 来获取加载的 1 秒音频文件的频率、相位和幅度，并重新创建它。我现在要做的是找出每个频率在 1 秒音频文件中的开始位置和结束位置，并将数据放入数组中

示例：100hz 从 0.23 秒到 0.34 秒开始，104.34hz 从 0.35 秒开始，到 0.37 秒结束。

fft 可以做到这一点还是我需要改变我的整个程序以使用小波？还有八度音程中的小波示例可以显示如何做我想要完成的事情吗？

我正在使用来自 repo 的 Ubuntu Linux 12.04 和 Octave 3.2.4

谢谢瑞克

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T06:12:47.907

FFT 作为一种估计离散傅里叶变换 ( [DFT](http://en.wikipedia.org/wiki/Discrete_Fourier_transform) ) 的算法，提供音频信号的频率内容（如您所提到的幅度和相位）。这将为您提供每个离散频率仓的一组幅度/相位值，您可以将其映射到连续频率值（基于仓索引或离散频率、FFT 点的数量和信号的采样频率）。

虽然 DFT（通过 FFT）是一种全局变换，也就是说，由于您正在移动到频域，因此您将失去时间的概念。您需要的是短时傅里叶变换 (STFT)，即在信号的短时间帧（窗口）上进行 FFT。这将为您提供时频表示作为输出，您可以在其中指定每个分析窗口的频率内容，从而指定每个短时间实例。

**方法草图**：定义时间窗口长度和窗口偏移（基于所需的时间分辨率或线性采样时间实例），运行 STFT，然后对每个窗口中的傅里叶幅度进行峰值拾取或局部最大值估计的方法。这将为您提供可以跨时间跟踪的主要频率位置（发作等）

在 MATLAB 中检查[频谱图](http://www.mathworks.com/help/toolbox/signal/ref/spectrogram.html)以了解 STFT 的实现以帮助您入门。

# algorithm - 选择一个整数来最大化总和

> ID：12083938
> 
> 赞同：0
> 
> 时间：2012-08-23T02:27:39.007
> 
> 标签：algorithm, math

如果给定整数对`(a1,b1),(a2,b2),(a3,b3),..(an,bn)`并且存在最大和值 =`X`那么我们如何选择给定的对，使得所选对中的第一个条目（即 a1、a2、..ap）的总和为`maximum but <= X`？例如，如果给定的对是`(43,9),(57,12),(13,4)`并且最大和是，`71`那么我们可以选择的对是`(57,12)`并且`(13,4)`给出最大和 <=71(X) 为 70 。我最初的方法是根据第一个条目值按降序对对进行排序，然后可能是 O(n^2) 算法..但我不确定这一点，对于大量数据来说它也可能太慢..所以有什么有效的方法吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T02:38:11.573

听起来这可以通过修改[0-1 背包](http://en.wikipedia.org/wiki/Knapsack_problem)问题来实现。

# php - 当我在邮件正文中有一个 url 时 PHP mail() 不发送邮件

> ID：12083939
> 
> 赞同：1
> 
> 时间：2012-08-23T02:27:41.513
> 
> 标签：php, sendmail

我不明白为什么当我尝试使用 PHP 邮件功能发送邮件时，当邮件正文中有一个带有变量的 URL（例如 [http://www.chicmaker.com/ ）时，我没有收到任何邮件fr/xxx.html?id_client=2](http://www.chicmaker.com/fr/xxx.html?id_client=2) ? 任何想法或线索？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T02:31:07.460

您似乎遇到了垃圾邮件过滤器，该过滤器检查是否有理由相信链接归发件人所有。您应该确保所有链接的域部分与发件人电子邮件域相对应。例如：

```
http://www.chicmaker.com/fr/xxx.html 
```

应对应于：

```
noreply@chicmaker.com 
```

# ios - iOS - 未收到 UIEventTypeRemoteControl 事件

> ID：12083940
> 
> 赞同：4
> 
> 时间：2012-08-23T02:28:11.520
> 
> 标签：ios, events, event-handling, uiwindow

我在 AppDelegate (didFinishLaunching) 中有这个：

```
[[UIApplication sharedApplication] beginReceivingRemoteControlEvents]; 
```

我尝试在相关的视图控制器中处理事件，但结果参差不齐（一些视图控制器会收到事件，而另一些则不会，即使他们是第一响应者）。我尝试子类化 UIApplication。那没有用。现在我正在尝试继承 UIWindow 并执行此操作（请参阅评论）：

```
- (void)sendEvent:(UIEvent *)event {
if (event.type == UIEventTypeRemoteControl) {
    NSLog(@"I wish this happened"); //this never happens
}
else
{
    NSLog(@"some other event"); //this does happen on any other interaction
    [super sendEvent:event];
}
}

- (void) remoteControlReceivedWithEvent: (UIEvent *) receivedEvent {

if (receivedEvent.type == UIEventTypeRemoteControl) {
    NSLog(@"got remote event"); // this never happens either
    switch (receivedEvent.subtype) {

        case UIEventSubtypeRemoteControlTogglePlayPause:
        {
            NSLog(@"handle play/pause");
            break;
        }

        default:
            break;
    }
}
} 
```

我在 info plist 中尝试了有和没有这个：

```
<key>UIBackgroundModes</key>
<array>
        <string>audio</string>
</array> 
```

没什么区别。正如 Apple 文档所述，您可以使用音频控件模拟远程控制事件（双击主页按钮并在底部滚动到它们）。当我按下播放或暂停时，它只会播放我的 iTunes 资料库中的音频。我也试过苹果耳机上的按钮。没有。

我要做的就是检测遥控器上的播放/暂停按钮，并处理事件。我还需要做什么来捕捉这些事件？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-23T03:41:44.373

好的，我的生命中还有几个小时进入了​​苹果的黑洞。事实证明，您只能在使用 AVAudioPlayer 播放某种音频或播放有音频的视频文件后才能捕获远程控制事件。[这在此处](http://developer.apple.com/library/IOS/#documentation/EventHandling/Conceptual/EventHandlingiPhoneOS/RemoteControl/RemoteControl.html)没有记录。

所以在我的情况下，我必须先播放一个虚拟的无声音频文件，然后再尝试捕获远程控制事件。希望这可以帮助某人。

**（更新）**请注意，[更新后的文档](http://developer.apple.com/library/IOS/#documentation/EventHandling/Conceptual/EventHandlingiPhoneOS/Remote-ControlEvents/Remote-ControlEvents.html)现在声明如下：

> 要接收远程控制事件，您的应用必须做三件事：
> 
> *   **成为第一响应者。**呈现多媒体内容的视图或视图控制器必须是第一响应者。
> *   **打开远程控制事件的传递。**您的应用必须明确请求开始接收远程控制事件。
> *   **开始播放音频。**您的应用必须是“正在播放”应用。重申，即使您的应用程序是第一响应者并且您已打开事件传递，您的应用程序在开始播放音频之前不会接收远程控制事件。

# jquery - 堆栈 jQuery ajaxComplete 事件

> ID：12083941
> 
> 赞同：0
> 
> 时间：2012-08-23T02:28:21.857
> 
> 标签：jquery, ajax

*搜索并没有找到我要找的东西*

鉴于有一大堆现有代码，我想附加一个 ajaxComplete 事件

```
$.ajaxSetup({
  complete: function(jqXHR, textStatus) {
    console.log('always called');
  }
}); 
```

因此，任何可能实现也可能不实现 ajaxComplete 的现有代码都将调用它的现有完整函数以及全局完整函数。

目前只存在 1 个实现，所以如果我设置了一个全局包罗万象，那么以后的任何设置都会覆盖该请求的全局设置，并且此时我需要执行的代码将不会被执行。

```
$.ajax(...).always(function(){
  console.log('always called but prevents global');
}); 
```

希望这是有道理的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T02:54:04.450

`ajaxComplete`将覆盖全局回调，因此您可以执行以下操作。

```
funciton foo() {
  console.log('always called');
}

$.ajaxSetup({
  complete: function(jqXHR, textStatus) {
    foo();
  }
});

$.ajax(...).ajaxComplete(function(){
  foo();
  console.log('always called but prevents global');
}); 
```

# paypal - 仅需要前端的支付提供商？

> ID：12083943
> 
> 赞同：1
> 
> 时间：2012-08-23T02:28:47.890
> 
> 标签：paypal, payment, frontend

大多数支付提供商（Stripe、Braintree、Samurai 等）都需要后端实现。

我的网站使用从 CDN 提供的静态 HTML，并且没有后端，因为我使用的是 Kinvey（后端即服务）。

我想知道是否有只需要前端实现 (JS/HTML) 的支付提供商，所以我可以在没有后端的情况下继续进行，因为支付是我网站上唯一缺少的功能。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T16:03:07.477

是的，PayPal 网站支付标准非常适合这种情况。它只需要一个简单的就可以添加到您的站点中。

例如;
`<form method="POST" action="http://www.paypal.com/cgi-bin/webscr"> <input type="hidden" name="cmd" value="_xclick">
<input type="hidden" name="business" value="you@yourdomain.com">
<input type="hidden" name="item_name" value="Your item name">
<input type="hidden" name="amount" value="0.99">
<input type="hidden" name="currency_code" value="GBP">
<input type="submit" name="submit" value="Continue to PayPal">
</form>`

当然，您需要记住，即使金额在“隐藏”输入字段中，它仍然可以被操纵。
相反，您也可以使用登录到您的 PayPal 帐户并转到“[按钮工厂](https://www.paypal.com/buttonfactory)”并创建一个所谓的“托管按钮”。
在这里，金额是固定的并存储在 PayPal 一方，因此无法被操纵。
缺点是它是固定数量，如果您希望自动更新它，您需要进行 API 调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T20:17:39.337

我用[Google checkout shopping cart](https://checkout.google.com/seller/integrate_shoppingcart.html)做了类似的事情。

我发现将静态服务器提供的页面集成到我的页面中非常容易且轻松，并且最初对获得一个可以接受付款的页面的简单和快速印象深刻。

另一方面，我失去了很多销售，因为人们说他们不准备“创建一个谷歌帐户”只是为了付钱给我。在接下来的几个月内，我将把它撕掉并用另一个替换它。可能是 PayPal 一个，因为这是我所知道的唯一一个在没有服务器的情况下工作的另一个，并且支付过程更轻量级并且为用户提供更好的体验，尽管很遗憾它似乎没有提供类似购物车的设施，与谷歌不同。

此外，最初谷歌的人弄乱了表格，几个月都没有修复它，尽管我恳求指出确切的问题。因此，即使您因此失去销售，您也不能依赖他们快速为您解决问题。

# php - 获取基于数据库的复选框

> ID：12083944
> 
> 赞同：1
> 
> 时间：2012-08-23T02:28:48.713
> 
> 标签：php, codeigniter

```
<td><input type="checkbox" name="cb"  /></td> 
```

我如何根据我的数据库字段上的数据库内容检查此复选框内容为 1 和 0

如果选中 1 个复选框，如果未选中 0 个复选框

我是怎么做到的

在我看来，我有 5 个复选框......

```
 1  2  3  4  5
1.[] [] [] [] []
2.[] [] [] [] []
3.[] [] [] [] []
4.[] [] [] [] [] 
```

我在数据库中的字段状态............

```
| Status    |
| 1,2,3     |
| 1,2,3,4,5 |
| 2,3,4     |
| 1,2,5     | 
```

**更新**

我如何检查复选框

```
 <?php $j=1; foreach ($dudu as $row2 ): ?>

    <td><input type="checkbox" name="popok[]"
  <?php if(strrpos($row->menu_allowed,''.$j.'')!==FALSE){echo 'checked';$j++;}/></td>

    <?php endforeach; ?> 
```

如果数据 1,2,3,4 它将检查

```
1    2   3   4
[v] [v] [v] [v] 
```

但如果数据不像 1,3,4 那样连续，它只检查第一个框

```
1    3  4
[v] [] [] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T02:41:38.653

在您的控制器中获取复选框值

```
<?php
class Test extends CI_Controller {

    function index()
    {

        $check_status = $this->test_model->get_checkbox_status();
        $data['check_status'] = $check_status;

        $this->load->view('testview', $data);
    }
}
?> 
```

那么在你看来

```
<td><input <?php if($check_status==1){"checked='checked'";}?> type="checkbox" name="cb"  /></td> 
```

**更新**

采用`strrpos`

```
<?php if(strrpos($check_status,'1')!==false){"checked='checked'";}?> 
```

这将检查`1`

另一种使用 for 循环的方法

```
<?php  for($i=1;$<6;$i++) { >?

<td><input <?php if(strrpos($check_status,$i)!==false){"checked='checked'";}?> type="checkbox" name="cb"  /></td>

<?php } ?> 
```

[http://php.net/manual/en/function.strrpos.php](http://php.net/manual/en/function.strrpos.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T02:35:55.190

当你的数据库中的字段是一个打印这个而不是你现有的代码。

```
<input type="checkbox" name="cb" checked="checked"  />​ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T02:45:15.437

假设您在以下变量中获取值

```
var cbValue = getValueFromDB(); 
```

使用 JQuery：

```
if (cbValue == 1 ){
    $('input[name="cb"]).attr(this.checked);
}
if (cbValue == 0){{
    $('input[name="cb"]).removeAttr("checked");
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T04:13:35.367

试试这个：

```
$check_val = //Collect from db
<input type="checkbox" name="check1" <?php if($check_val=='1') echo checked;?>>
<input type="checkbox" name="check2" <?php if($check_val=='0') echo checked;?>> 
```

你可以从中得到

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-23T11:42:29.337

或者你也可以使用

```
 1    2    3    4    5
 1 [00] [01] [02] [03] [04]
 2 [10] [11] [12] [13] [14]
 3 [20] [21] [22] [23] [24]
 4 [30] [31] [32] [33] [34] 
```

单独作为id，然后将其存储在数据库中

# javascript - 使用 RequireJS 的优势？

> ID：12083946
> 
> 赞同：4
> 
> 时间：2012-08-23T02:29:01.217
> 
> 标签：javascript, requirejs

我正在比较以下两个 TodoMVC 示例的渲染速度：

1.  骨干网 - [http://addyosmani.github.com/todomvc/architecture-examples/backbone/](http://addyosmani.github.com/todomvc/architecture-examples/backbone/)

    ```
    -> (on 1st loading) 14 requests  ❘  62.19KB transferred  ❘  2.01s (onload: 2.10s, DOMContentLoaded: 2.10s)

    -> (on cache loading) 14 requests  ❘  0B transferred  ❘  176ms (onload: 177ms, DOMContentLoaded: 175ms) 
    ```

2.  骨干 + RequireJS - [http://addyosmani.github.com/todomvc/dependency-examples/backbone_require/](http://addyosmani.github.com/todomvc/dependency-examples/backbone_require/)

    ```
    -> (on 1st loading) 19 requests  ❘  73.95KB transferred  ❘  2.57s (onload: 2.57s, DOMContentLoaded: 1.14s)

    -> (on cache loading) 19 requests  ❘  0B transferred  ❘  224ms (onload: 244ms, DOMContentLoaded: 87ms) 
    ```

我是否可以这样解释，即使用 RequireJS 会`$(document).ready()`尽可能早地被触发，但是页面完成渲染所需的总时间实际上会变得更长？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T03:21:07.610

你的解释是正确的。

但是，值得注意的是，在给定的示例中，[`r.js`优化器](http://requirejs.org/docs/optimization.html)并未在代码上运行，因此每个单独的模块都是单独加载的，因此在这种情况下确实具有这种效果。但是，如果他们**使用**的是应用程序的优化版本，所有依赖项都将被编译到一个文件中（除非另有说明），并且该示例将仅加载*四个*文件（如果查看器使用的 IE 版本低于 10 ）。我不能确定这会对加载时间和 产生多大影响`DOMContentLoaded`，但我的*猜测*是这会降低他们俩的时间。

# solr - solr fieldtype 字符串或分词器

> ID：12083947
> 
> 赞同：0
> 
> 时间：2012-08-23T02:29:13.803
> 
> 标签：solr, tokenize, fieldtype

我需要使用标记器和字符串搜索特定字段。仅当没有为字符串 1 找到结果时，我才会使用标记器。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T10:08:42.100

您可以在两个单独的字段中索引您的内容，一个已分析（例如`text_general`字段类型），另一个作为单个标记（字段类型`string`）。然后，当您搜索 Solr 时，您在两个字段上都进行了搜索，但您提升了未分析的字段，以便将这些结果排在首位。

我使用类似的场景来提升具有完全匹配的结果并在下面显示部分匹配。

# php - 如何让“onclick”内容显示在动态创建的内容旁边

> ID：12083948
> 
> 赞同：2
> 
> 时间：2012-08-23T02:29:17.350
> 
> 标签：php, javascript, jquery, ajax, javascript-events

我有一个动态创建的列表，在它旁边显示单选按钮。当单选按钮更改时，我希望在动态创建的列表和已更改的单选按钮旁边显示一个下拉列表。基本上，如果我将按钮更改为是（可见），我希望在它旁边出现一个下拉列表......所以取决于我的列表中有多少项目以及哪些项目设置为是，将是设置位置的下拉列表（每个动态创建的下拉列表中有 8 个相同的固定选项）。

到目前为止，我想出的只是在 jquery 中创建一个 onchange 事件并“取消隐藏”一个预制的下拉列表 - 代码工作正常，但它不是所需要的。我将在下面发布代码和图片：

```
//K's function:
        function get_all_pages() {
        global $connection;
        $query = "SELECT * 
                FROM pages ";
        $query .= "WHERE visible = 1 ";
        $query .= "ORDER BY position ASC";
        $page_set = mysql_query($query, $connection);
        confirm_query($page_set);
        return $page_set;
    }
//K's function:
function list_all_pages(){
$output = "<ul>";
$page_set = get_all_pages();
while ($page = mysql_fetch_array($page_set)) {
$output .= "<li><a href=\"add_feature.php?page=" . urlencode($page["id"]) . "\">{$page["menu_name"]}</a></li>";
$output .= "&nbsp;&nbsp;<input type=\"radio\" class=\"unchecked\" onclick=\"uncheck()\" name=\"visible_{$page["id"]} \" value=\"0\" checked=\"checked\" /> No <input type=\"radio\" class=\"checked\" onclick=\"check()\" name=\"visible_{$page["id"]} \"value=\"1\" /> Yes";
    }
$output .= "</ul>";
return $output;
}   
---------- jquery
<script type="text/javascript">
 $(document).ready(function() {
//alert("document ready");
   $('#position').hide();

 });

$('.checked').change(function() {
     $('#position').show();
});
$('.unchecked').change(function() {
     $('#position').hide();
});
</script>

--------- html (not what is wanted but the only thing I've got going right now....

<form>
<?php echo list_all_pages(); ?>

<div id="position">

<select name="position">
var count;
for (count=1; count <= 8; count++) {
<option value='count'>count</option>;
        }
</select>

</div>

</form> 
```

![在此处输入图像描述](../Images/f66f89e9ff957346105d96e7cd2578e3.png)

![在此处输入图像描述](../Images/6e33d9561d220e0dcc922dcbebceacdb.png)

截至 8 月 27 日的新信息 由于 rerazor11 在 jfiddle 中的帮助，它是半工作的...... php 循环中的 javascript onchange 正在工作，但仅适用于第一个`<li>`......事实上，当我点击其他`<li>`单选按钮时，下拉菜单有时会再次出现在第一个之下`<li>`...代码和新图片发布在下面：

```
 //K's function:
    function list_all_pages(){
    $output = "<ul>";
    $page_set = get_all_pages();
    while ($page = mysql_fetch_array($page_set)) {
    $output .= "<li><a href=\"add_feature.php?page=" . urlencode($page["id"]) . "\">{$page["menu_name"]}</a></li>";

    $output .= "&nbsp;&nbsp;<input onchange=\"javascript:document.getElementById(1).style.display = 'block';\" type=\"radio\" name=\"visible_{$page["id"]} \" value=\"0\" checked=\"checked\" /> No <input onchange=\"javascript:document.getElementById(1).style.display = 'none';\" type=\"radio\" name=\"visible_{$page["id"]} \"value=\"1\" /> Yes";

    $output .= "<div id='1' style='display: none'><select name='position'><option value='count'>1</option><option value='count'>2</option><option value='count'>3</option></select></div>";

        }
    $output .= "</ul>";
    return $output;
    } 
```

![在此处输入图像描述](../Images/2f1c5fbee3b40f4e9a18a2e7dd9a0d66.png) ![在此处输入图像描述](../Images/b25042cfd9ac6e23857fd03428051241.png) ![在此处输入图像描述](../Images/277dd0fe42da20f079240c40f39d9488.png)

9 月 2 日编辑：我尝试将 $counter 作为 ID，然后尝试使用 $page[id] 并且两者都返回了使 div 显示在每个 li 中的结果......但似乎有问题onclick javascript 正常工作...如果 redrazor11 或有人可以看一下，我将发布链接，也许可以找出 onclick 上发生的这种奇怪行为？关联：

[http://www.firetreegraphics.com/widget_corp-final/add_feature.php](http://www.firetreegraphics.com/widget_corp-final/add_feature.php)

这是最近更改的代码：

```
//K's function:
function list_all_pages(){
$output = "<ul>";
//$output .= $counter = 0;
$page_set = get_all_pages();
while ($page = mysql_fetch_array($page_set)) {
$output .= "<li><a href=\"add_feature.php?page=" . urlencode($page["id"]) . "\">{$page["menu_name"]}</a></li>";

$output .= "&nbsp;&nbsp;<div id=\"$page[id]\" style='display: none'><select name='position'><option value='count'>1</option><option value='count'>2</option><option value='count'>3</option></select></div>";

$output .= "&nbsp;&nbsp;<input onchange=\"javascript:document.getElementById('$page[id]').style.display = 'block';\" type=\"radio\" name=\"visible_{$page["id"]} \" value=\"0\" checked=\"checked\" /> No <input onchange=\"javascript:document.getElementById('$page[id]').style.display = 'none';\" type=\"radio\" name=\"visible_{$page["id"]} \"value=\"1\" /> Yes";

//$output .= $counter = $counter+1;

    }
$output .= "</ul>";
return $output;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T02:33:23.467

请参阅我在较早的堆栈交换帖子中找到的这个小提琴。

这个想法是用选择框隐藏 div，直到您准备好显示/填充它。根据选择的内容，您可以使用不同的 id'd div。在此示例中，它是一个下拉菜单，导致内容出现，但它与单选按钮的想法类似。

[http://jsfiddle.net/cpradio/YvN4Q/](http://jsfiddle.net/cpradio/YvN4Q/)

# html - 如何使按钮和输入保持在表格单元格内的同一行？

> ID：12083954
> 
> 赞同：0
> 
> 时间：2012-08-23T02:30:16.533
> 
> 标签：html, css, vertical-alignment

鉴于：

```
<table>
<tr>
    <td>
        <div id="dv">
            <button id="bt" type="button">X</button>
            <input id="num" type="number" value="1"/>
        </div>
    </td>
    <td>
        <input type="text" value="aaa"/>
    </td>
</tr>
</table>​ 
```

[http://jsfiddle.net/mark69_fnd/ZZFc5/1/](http://jsfiddle.net/mark69_fnd/ZZFc5/1/)

![在此处输入图像描述](../Images/03e12d912b83ce437fcf4eec4b7df703.png)

但是，如果我调整窗口大小，我会得到：

![在此处输入图像描述](../Images/a0cec47fa93320f91293fc434a05f580.png)

我想要实现的是：

1.  即使调整了窗口大小，所有控件都保持在同一行。
2.  输入控件占据所有可用空间（按钮大小可以保持不变）。
3.  当窗口调整大小时，输入控件也会调整大小。
4.  X 按钮必须与输入控件共享第一个单元格。
5.  除 X 按钮外，不应使用绝对尺寸。

这应该很简单，但我无法理解它。

请分享你的智慧。

**编辑**

如果可能的话，我想避免为所有人指定绝对值（如像素），但 X 按钮可能会被赋予绝对宽度和高度。

**编辑2**

添加了第 5 个约束。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T02:42:58.563

> < nobr > 是你的朋友在这里

```
<table>
<tr>
    <td>
        <div id="dv">
          <nobr>
            <button id="bt" type="button">X</button>
            <input id="num" type="number" value="1"/>
          </nobr>
        </div>
    </td>
    <td>
        <input type="text" value="aaa"/>
    </td>
</tr>
</table> 
```

[http://jsfiddle.net/mXSgd/](http://jsfiddle.net/mXSgd/)

对于实际可调整大小的表单元素，这可能会有所帮助：

[http://dev.sencha.com/deploy/ext-4.0.0/examples/form/anchoring.html](http://dev.sencha.com/deploy/ext-4.0.0/examples/form/anchoring.html)

或这个：

[http://www.switchonthecode.com/tutorials/javascript-tutorial-resizeable-textboxes](http://www.switchonthecode.com/tutorials/javascript-tutorial-resizeable-textboxes)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T02:49:10.870

在这种情况下，您可以为容器（或子项）设置最小宽度，在本例中为表格，见下文。或者以百分比重置表格，使其灵活且可控。

```
<table style="min-width:300px"> 
```

[http://jsfiddle.net/mark69_fnd/ZZFc5/1/](http://jsfiddle.net/mark69_fnd/ZZFc5/1/)

您可以放弃表格方法并使用 css 浮点数

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T02:57:06.193

在表格上设置样式表可能会对您有所帮助。

> 表格{宽度：200px;}
> 表格tr td {宽度：30%;}

[http://jsfiddle.net/ZZFc5/2/](http://jsfiddle.net/ZZFc5/2/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T03:14:40.650

如果您可以在桌子上粘贴一个宽度，例如`100%`，那么您可以尝试以下操作。

我修改了您的 HTML 以在文本字段中添加一个 id；而已。

HTML：

```
<table>
    <tr>
        <td>
            <div id="dv">
                <button id="bt" type="button">X</button>
                <input id="num" type="number" value="1"/>
            </div>
        </td>
        <td>
            <input id="txt" type="text" value="aaa"/>
        </td>
    </tr>
</table>​​​​ 
```

CSS：

```
table {
    width: 100%;
}
tr td {
    position: relative;
    width: 50%;
}

#bt {
    width: 25px;
    top: 0;
    left: 0;
    position: absolute;
}

button {
    padding: 0;
    margin: 0;
}

#num {
    position: absolute;
    top: 0;
    left: 25px;
    right: 0;
}

#txt {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
} 
```

请参阅[我从你那里分叉的 JSFiddle](http://jsfiddle.net/f37xJ/2/)。

基本上我将按钮的大小设置为 25px，然后将每个`<td>`s 的宽度设置为表格宽度的 50%。然后我使用绝对定位来告诉文本字段和输入字段占用所有可用的水平空间，仅此而已。因此，当您调整窗口大小时，组件将调整大小，但永远不会“下降”到第二行。​</p>

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-08-19T14:10:26.837

```
<table>
    <tr>
        <td>
           <table>
             <tr>
                <td>
                    <button id="bt" type="button">X</button>
                </td>
                <td>
                    <input id="num" type="number" value="1"/>
                </td>                    
              </tr>
           </table>
        </td>
        <td>
            <input type="text" value="aaa"/>
        </td>
    </tr>
</table> 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2020-08-17T20:00:04.717

将这些元素放在单元格旁边的另一个表格中

# javascript - YouTube API 需要 postMessage()。为什么？

> ID：12083956
> 
> 赞同：2
> 
> 时间：2012-08-23T02:30:29.653
> 
> 标签：javascript, api, youtube

我一直在尝试让 YouTube JS API 的`stopVideo()`方法工作一段时间。每个人都说它就像在 iframe 元素上调用它一样简单，但我能够让它工作的唯一方法是通过`postMessage()`我在别人的 Stackoverflow 帖子上找到的一种方法。

**编码：**

```
$('iframe').postMessage('{"event":"command","func":"stopVideo","args":""}', '*') 
```

是什么最终让它为我工作。但是，我仍然不明白我在做什么。谁能给我解释一下？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T02:44:16.293

[来自 MDN postMessage](https://developer.mozilla.org/en-US/docs/DOM/window.postMessage)

> `window.postMessage`是一种安全启用跨域通信的方法。通常，不同页面上的脚本只有当且仅当执行它们的页面位于具有相同协议（通常都是 http）、端口号（http 的默认值为 80）和主机（模document.domain 被两个页面设置为相同的值）。window.postMessage 提供了一种受控机制，以在正确使用时以一种安全的方式规避此限制。

所以它的作用是让你绕过[相同的源策略](https://developer.mozilla.org/en-US/docs/Same_origin_policy_for_JavaScript)并与其他域交谈。唯一的问题，并非所有浏览器都支持它。

# c# - 在使用 ItemsSource 之前，项目集合必须为空：尝试了现有的解决方案 :(

> ID：12083958
> 
> 赞同：-2
> 
> 时间：2012-08-23T02:30:45.400
> 
> 标签：c#, .net, wpf, xaml, datagrid

我知道这是一个非常普遍且存在的问题，但是我从这里尝试了许多解决方案，但我一直遇到同样的错误。

请让我知道错误在哪里:(如果我遗漏任何信息，请编辑/建议

代码：XAML：

```
 <DataGrid Name="dtgQCNumbers"  
                              Width="409"
                              AutoGenerateColumns="False" 
                              ItemsSource="{Binding Path=.}"
                              CanUserResizeColumns="True" 
                              SelectionChanged="dtgQCNumbers_SelectionChanged" 
                              >

                          <DataGrid.Columns>
                            <DataGridCheckBoxColumn Header="IsChecked" Width="100" 
                                                                         Binding="{Binding Path=IsActive}"
                                                                        CanUserResize="True"/>                                 

                                                <DataGridTextColumn Header="QC_ID" Width="100" 
                                                                    Binding="{Binding Path=DataGridTextBox_QCList1}"
                                                                    CanUserResize="True"/>

                                                <DataGridTextColumn Header="Summary" Width="100"
                                                                    Binding="{Binding Path=DataGridTextBox_QCSummary}"
                                                                    CanUserResize="True"/>

                                                <DataGridComboBoxColumn Header="ControlOption" Width="100"
                                                                        SelectedItemBinding="{Binding Path=DataGridComboxBox_Control}"
                                                                        ScrollViewer.CanContentScroll="True"
                                                                        ScrollViewer.VerticalScrollBarVisibility="Auto"
                                                                        IsReadOnly="True"
                                                                        CanUserResize="True">
                                                <DataGridComboBoxColumn.ItemsSource>
                                                        <col:ArrayList>
                                                            <sys:String>AVS</sys:String>
                                                            <sys:String>DB</sys:String>
                                                                  <sys:String>AVS_DB</sys:String>
                                                        </col:ArrayList>
                                                    </DataGridComboBoxColumn.ItemsSource>

                                                </DataGridComboBoxColumn>

                        </DataGrid.Columns>
                         grid.ColumnWidth = new DataGridLength(100);

</DataGrid> 
```

*数据绑定背后的代码是：*

```
private void OnInitialized()
  {
      string projectName = null;
      string crNumber = null;
      ComboBoxItem selectedProject;
      selectedProject = (ComboBoxItem)ddlProject.SelectedItem;
      projectName = selectedProject.Content.ToString();

      ActiveDirectoryWrapper.ApplicationUserData userData = Common.GetUserData(userName);

      string queryString;
      if (rdoMyQCs.IsChecked == true)
      {
          queryString = "Blalalalala";
      }
      else
      {
          queryString = "Blahblah";
      }

      Recordset qcIdSet = Common.queryTestDirector(projectName, queryString);
      qcIdSet.First();
      string colname = qcIdSet.get_ColName(0);

      _ds = new DataSet();
      DataTable table = new DataTable();
      _ds.Tables.Add(table);

      DataColumn c1 = new DataColumn("IsChecked", typeof(bool));
      table.Columns.Add(c1);
      DataColumn c2 = new DataColumn("QC_ID", typeof(string));
      c2.MaxLength = 500;
      table.Columns.Add(c2);
      DataColumn c3 = new DataColumn("QC_Summary", typeof(string));
      c3.MaxLength = 500;
      table.Columns.Add(c3);
      DataColumn c4 = new DataColumn("Control Option", typeof(string));
      c4.MaxLength = 500;
      table.Columns.Add(c4);
      while (!qcIdSet.EOR)
      {
          DataRow rw = table.NewRow();
          rw["IsChecked"] = true;
          rw["QC_ID"] = qcIdSet["BG_BUG_ID"].ToString();
          rw["QC_Summary"] = "";
          rw["Control Option for Deployment"] = "AVS_DB";
          table.Rows.Add(rw);
          qcIdSet.Next();
      }

      dtgQCNumbers.DataContext = _ds.Tables[0];
      throw new NotImplementedException();
  } 
```

我不断收到错误消息“在使用 ItemsSource 之前，项目集合必须为空”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T02:35:04.040

你到底为什么要`string`在你的`DataGrid.Items`.

```
 </DataGrid.Columns>
    grid.ColumnWidth = new DataGridLength(100);
</DataGrid> 
```

你会得到那个错误并不奇怪......

# vim - snipMate 文件类型设置不正确

> ID：12083959
> 
> 赞同：2
> 
> 时间：2012-08-23T02:31:01.420
> 
> 标签：vim, go, snipmate

我下载了 vim 并在 python 文件中使用它，代码片段运行良好。但是当我尝试在 .go 文件（golang）中使用 snipMate 时，它​​不起作用。我阅读了文档并找不到答案，但是当我手动使用命令“：set ft = go”时，片段起作用了。为什么 snipMate 自动为 python 工作而不去。提供了两种语言的片段文件。如何让 go 片段自动工作？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-23T02:33:22.593

听起来您的 .go 文件没有设置为适当的文件类型。您可以使用

```
au BufRead,BufNewFile *.go setl ft=go 
```

在你的 ~/.vimrc 中解决这个问题。

此类文件的适当位置是在您的`~/.vim/ftdetect`目录中。例如，您可以创建一个名为的文件`~/.vim/ftdetect/go.vim`并将命令放入其中。

# c# - 是否可以将模型状态错误传递给不同的操作？

> ID：12083962
> 
> 赞同：1
> 
> 时间：2012-08-23T02:31:31.187
> 
> 标签：c#, asp.net-mvc-3, routing

我正在使用两个操作，一个用于我的请求的获取部分（一个通用的 url），另一个用于帖子。

如果帖子有 ModelState 错误，我想查看返回以显示错误，但我希望 url 是通用 url。

这就是目前发生的情况：

```
Get: http://foo.com/mycontroller  
Post: http://foo.com/mycontroller/specificviewaction (validation error occurs)  
Resultant url is: http://foo.com/mycontroller/specificviewaction 
```

我希望它是[http://foo.com/mycontroller](http://foo.com/mycontroller)适当的错误。

这是我当前的代码：

```
 public ActionResult Index()
    {
        // ... do stuff
        return View("specificviewaction ", model);
    }

    [HttpPost] 
    public ActionResult specificviewaction(Model model)
    {
        if (ModelState.IsValid)
        {
        // ... do stuff
        }

        return View("specificviewaction", model);
    } 
```

请注意，没有实际的索引视图，只有特定视图。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T02:54:38.743

删除索引操作 - 你不需要它。取而代之的是，只需添加一个更具体的视图操作，但对于 Get：

```
[HttpGet]
public ActionResult specificviewaction()
{
    //do smth
    return View("specificviewaction", model);
} 
```

并将以下路由器添加到 Global.asax（在默认路由之前）：

```
routes.MapRoute("MyControllerRoute", // Route name
                "MyController/{action}/{id}", // URL with parameters
                new { controller = "MyController", action = "specificviewaction", id = UrlParameter.Optional } // Parameter defaults); 
```

默认情况下，此 url 之后“/MyController/”将指向您的“specificviewaction”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-30T04:18:00.593

这就是我最终做的。

我按照默认实现离开了路由表。

然后对于每种模型类型，我在表单中放置一个隐藏字段，它是哪种类型。

在帖子中，我检查它是什么类型，并使用`TryUpdateModel`正确的表单值更新模型实例。

如果它成功了很好，如果没有，我可以返回适当的错误。

我试图过度思考，最简单的方法是最好的。

# node.js - 为什么我无法连接到 websocket？

> ID：12083966
> 
> 赞同：0
> 
> 时间：2012-08-23T02:31:53.703
> 
> 标签：node.js, coffeescript, websocket

`ws`带模块的节点服务器代码：

```
show = console.log

WS = require('ws').Server
wss = new WS port: 8080
wss.on 'connection', (ws) ->
  show 'a connection'
  ws.on 'message', (message) ->
    show 'received: %s', message
  ws.send 'something' 
```

我可以通过在同一台服务器上运行下面的代码来连接到 websocket，它给出了`"a connection"`：

```
WS = require 'ws'
ws = new WS 'ws://localhost:8080' 
```

但是当我从浏览器运行这些代码行时，没有响应：

```
s = new WebSocket('ws://184.82.253.196:8080');
s.send('nothing'); 
```

什么问题，我该如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T02:58:19.963

Websocket 服务器`127.0.0.1`默认只开始监听。使用此代码开始监听所有接口。

```
show = console.log

WS = require('ws').Server
wss = new WS port: 8080, host: '0.0.0.0'
wss.on 'connection', (ws) ->
  show 'a connection'
  ws.on 'message', (message) ->
    show 'received: %s', message
  ws.send 'something' 
```

# php - 在 PHP 中从 Android 发送的带有评论的图像

> ID：12083967
> 
> 赞同：0
> 
> 时间：2012-08-23T02:31:55.790
> 
> 标签：php, android, json, image

我想将带有一些评论的图像从 Android 设备发送到 PHP 服务器。我想利用 JSON 来交换数据。我看了很多地方，但我没有得到正确的提示。任何人都可以提出一些建议来让它与 PHP 一起使用吗？

我不想使用 base65，因为它会增加数据负载，并且图像大小也是一个问题。请提出您的想法和正确的方法来发展它。

我的安卓代码：

```
 // Building Parameters
                List<NameValuePair> params = new ArrayList<NameValuePair>();
                params.add(new BasicNameValuePair("name", name));
                params.add(new BasicNameValuePair("price", price));
                params.add(new BasicNameValuePair("description", description));
                params.add(new BasicNameValuePair("image","/sdcard/DCIM/android_1.png"));
// getting JSON Object       
            JSONObject json = jsonParser.makeHttpRequest(url_create_product,"POST", params);

            // check log cat fro response
            Log.d("Create Response", json.toString());
// check for success tag
            try {
                int success = json.getInt(TAG_SUCCESS);

                if (success == 1) {
                    // successfully created product
                    Intent i = new Intent(getApplicationContext(), AllProductsActivity.class);
                    startActivity(i);

                    // closing this screen
                    finish();
                } else {
                    // failed to create product
                }

            } catch (JSONException e) {
                e.printStackTrace();
            } 
```

当我使用多部分在其中添加图像时：

```
 MultipartEntity reqEntity = new MultipartEntity(HttpMultipartMode.BROWSER_COMPATIBLE);
            try {
                reqEntity.addPart("name", new StringBody(name));
                reqEntity.addPart("Id", new StringBody(price));
                reqEntity.addPart("title",new StringBody(description));
                //reqEntity.addPart("pic", new FileBody(new File("/sdcard/DCIM/android_1.png")));

            } catch (UnsupportedEncodingException e1) {
                // TODO Auto-generated catch block
                e1.printStackTrace();
            }
            Bitmap bitmap = null ;
            ByteArrayOutputStream bos = new ByteArrayOutputStream();
            bitmap.compress(CompressFormat.JPEG, 100, bos);
             byte[] data = bos.toByteArray();
             ByteArrayBody bab = new ByteArrayBody(data, "/sdcard/android_1.png");
            reqEntity.addPart("pic", bab); 
```

我不确定如何使用 JSON 传递这个多部分请求：

// 获取 JSON 对象
JSONObject json = jsonParser.makeHttpRequest(url_create_product,"POST", params);

以及如何在 PHP 中将其读取为图像。没有图像PHP工作代码如下：

```
<?php

/*
 * Following code will create a new product row
 * All product details are read from HTTP Post Request
 */

// array for JSON response
$response = array();
$target_path1 = "uploads/";

// check for required fields
if (isset($_POST['name']) && isset($_POST['price']) && isset($_POST['description'])) {

    $name = $_POST['name'];
    $price = $_POST['price'];
    $description = $_POST['description'];    
//I have data from android here now but How I can read image here ? 
```

所以我在这里有两个问题： 1\. 如何将图像作为 JSONObject 的一部分传递（第一个代码在没有图像的情况下工作） 2\. 如何在 PHP 中读回这个图像？

我真的很感激任何意见或建议。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T03:24:18.733

我从来没有使用 JSON 来传递图像，只有文本，但是你可以使用 android 通过 HTTP 来发布信息。查看本教程，它帮助了我[http://reecon.wordpress.com/2010/04/25/uploading-files-to-http-server-using-post-android-sdk/](http://reecon.wordpress.com/2010/04/25/uploading-files-to-http-server-using-post-android-sdk/)

# node.js - Azure SDK 导致 Node.js 服务总线调用运行缓慢

> ID：12083970
> 
> 赞同：0
> 
> 时间：2012-08-23T02:32:16.863
> 
> 标签：node.js, azure, sdk

我正在使用这段代码从使用 web 矩阵在本地运行的 node.js 服务器调用服务总线队列，我还上传到 Windows azure“网站”，但它仍然执行缓慢。

```
var sb1 = azure.createServiceBusService(config.serviceBusNamespace, config.serviceBusAccessKey);
sbMessage = {
    "Entity": {
        "SerialNumbersToCreate": '0',
        "SerialNumberSize": config.usageRates[3],
        "BlobName": 'snvideos' + channel.ChannelTableName,
        "TableName": 'snvideos' + channel.ChannelTableName
    }
};

sb1.getQueue('serialnumbers', function(error, queue){
    if (error === null){
        sb1.sendQueueMessage('serialnumbers', JSON.stringify(sbMessage), function(error) {
            if (!error)
                res.send(req.query.callback + '({data: ' + JSON.stringify({ success: true, video: newVideo }) + '});');
            else 
                res.send(req.query.callback + '({data: ' + JSON.stringify({ success: false }) + '});');
        });
    }
    else res.send(req.query.callback + '({data: ' + JSON.stringify({ success: false }) + '});');
}); 
```

服务器最多可能需要 5 秒才能将返回结果返回给客户端。当我注释掉 sb1.getQueue('serialnumbers', function(error, queue){ 并让它返回而不发送队列消息时，它会在不到 1 秒的时间内执行。这是为什么？我使用 azure sdk 的方法是服务总线正确吗？

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T23:20:13.390

谢谢马克回复。我遇到的问题与 IISNode 有关，显然如果有人在他们的程序中使用 console.log，那么 IISNode 最终会在某个阶段崩溃。在 web.config 中，如果您不时调整此设置：

```
loggingEnabled="true" 
```

为 false 不再崩溃，并且队列调用工作。我应该指出我所有的队列调用都是在同一个线程中完成的，我有一个 cron 作业检查队列中的消息，因此当 IISNode 崩溃并再次重新启动时，它看起来好像队列以某种方式延迟了。

干杯

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T21:35:42.840

在这种情况下，您的 getQueue 调用确实不是很实用，因为您没有使用输出，您可以尝试 CreateQueueIfNotExists，看看是否有性能差异

# recursion - Bat文件递归子目录并做某事

> ID：12083971
> 
> 赞同：0
> 
> 时间：2012-08-23T02:32:16.897
> 
> 标签：recursion, batch-file

我需要编写一个 .bat 文件，该文件将通过目录结构递归并在命令行上将所有 epub 转换为 mobis。我安装了 Calibre，基本的命令行是

```
ebook-convert MyFile.epub MyFile.mobi. 
```

我敢肯定这对那里的某个人来说是同步的，但我已经尝试了半个早上但没有成功。

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T10:05:08.387

好的，最终让它工作：

```
FOR /r "THE_FOLDER I AM RECURSING TO/" %%f IN (*.epub) do (
SET FILE= %%f
SET TITLE=!FILE:~1,-5!
ebook-convert %%f "!TITLE!.mobi"
) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-02-05T13:45:32.583

尝试：

```
for /r %I in (*.epub) do "ebook-convert.exe" "%I" "%~nI.mobi" 
```

祝你好运！

# excel - Excel Web 查询 - 仅在 10 个循环后超时

> ID：12083973
> 
> 赞同：0
> 
> 时间：2012-08-23T02:32:23.343
> 
> 标签：excel, vba, web

我正在尝试使用 excel 网络查询从多个网页中提取数据。

代码在前 10 个循环中运行良好，之后我收到错误消息：

> “运行时错误 1004：无法打开 URL。连接到此 Internet 站点的时间超过了分配的时间”

我会很感激任何指针。网站链接在[这里](http://www.skmm.gov.my/link_file/registers1/aa2.asp?cc=293468954920264181618&vl=&aa=celcom_cell&fpg=1)

完整代码如下：

```
Sub DataPull()
Dim page As Integer
Dim Summary As Worksheet
Dim Query As Worksheet
Dim x As Integer
Dim n As Integer

Set Summary = ActiveWorkbook.Sheets("Summary")
Set Query = ActiveWorkbook.Sheets("Query")

x = 2

For n = 1 To 11
With
Query.QueryTables.Add(Connection:="URL;http://www.skmm.gov.my/link_file/registers1/_
aa2.aspcc=83885232640314699294053&vl=&aa=celcom_cell&fpg=" &n,_
Destination:=Query.Cells(1, 1))
.Name = "aa2.asp?cc=83885232640314699294053&vl=&aa=celcom_cell&fpg=1"
.FieldNames = True
.RowNumbers = False
.FillAdjacentFormulas = False
.PreserveFormatting = True
.RefreshOnFileOpen = False
.BackgroundQuery = False
.RefreshStyle = xlOverwriteCells
.SavePassword = False
.SaveData = True
.AdjustColumnWidth = True
.RefreshPeriod = 0
.WebSelectionType = xlAllTables
.WebFormatting = xlWebFormattingNone
.WebPreFormattedTextToColumns = True
.WebConsecutiveDelimitersAsOne = True
.WebSingleBlockTextImport = False
.WebDisableDateRecognition = False
.WebDisableRedirections = False
.Refresh BackgroundQuery:=False
End With

Query.Range("A6:H35").Copy Destination:=Summary.Range("A" & x)
x = x + 30
Query.QueryTables(1).Delete

Next n
End Sub` 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T07:03:31.630

我有一个非常相似的问题，但网页完全不同。我正在导入 12 页的内容，在第 10 页，它会冻结。我发现在每次迭代结束时放置一个等待语句“修复”了问题。

```
Application.Wait Now() + TimeValue("00:00:05") 
```

我很想知道什么样的时间适合你。我知道 5 秒对我有用。但我没有尝试任何更低的东西。我让它工作，这就是我所需要的。

如果微软设置一个可配置的超时值，或者给我们一种方法来等待后台查询一段时间然后取消它，我会喜欢它。但是很可惜，我还没有找到方法。也就是说，这似乎是 Excel 不喜欢快速连续地以编程方式创建、刷新和删除 10 个 Web 查询的问题，而不是被查询的基础站点的一些问题。

# python - CookieError：合法的键值

> ID：12083974
> 
> 赞同：0
> 
> 时间：2012-08-23T02:32:23.963
> 
> 标签：python, google-app-engine, cookies

```
Dump Error:

Traceback (most recent call last):
  File "/base/data/home/apps/s~tagtoo-ec/1.361220954515344675/libs/handlers.py", line 69, in get
    self.beforeFilter()
  File "/base/data/home/apps/s~tagtoo-ec/1.361220954515344675/libs/handlers.py", line 51, in beforeFilter
    self.set_track()
  File "/base/data/home/apps/s~tagtoo-ec/1.361220954515344675/libs/handlers.py", line 99, in set_track
    track_id = self.request.cookies.get("tagtoo_user_track", None)
  File "/base/python_runtime/python_lib/versions/1/webob/__init__.py", line 985, in cookies
    vars = self.str_cookies
  File "/base/python_runtime/python_lib/versions/1/webob/__init__.py", line 973, in str_cookies
    cookies.load(source)
  File "/base/python_runtime/python_dist/lib/python2.5/Cookie.py", line 619, in load
    self.__ParseString(rawdata)
  File "/base/python_runtime/python_dist/lib/python2.5/Cookie.py", line 650, in __ParseString
    self.__set(K, rval, cval)
  File "/base/python_runtime/python_dist/lib/python2.5/Cookie.py", line 572, in __set
    M.set(key, real_value, coded_value)
  File "/base/python_runtime/python_dist/lib/python2.5/Cookie.py", line 451, in set
    raise CookieError("Illegal key value: %s" % key)
CookieError: Illegal key value: tagtoo_u{er_track 
```

我多次收到此错误消息。

问题是

1.  我使用的关键值是“tagtoo_user_track”。“tagtoo_u{er_track”来自哪里？
2.  这个错误并不总是发生。我在每个请求中都使用了相同的方法。如果完全错误，则应在每个请求中引发此异常。但是，错误消息只引发了几次。

它是谷歌应用引擎的错误吗？

# 编辑1

它再次发生在另一个 cookie 键“tagtoo_user_track”上。看起来 cookie 引擎不喜欢“s”。

```
Traceback (most recent call last):
  File "/base/data/home/apps/s~tagtoo-ec/1.361220954515344675/libs/handlers.py", line 69, in get
    self.beforeFilter()
  File "/base/data/home/apps/s~tagtoo-ec/1.361220954515344675/libs/handlers.py", line 51, in beforeFilter
    self.set_track()
  File "/base/data/home/apps/s~tagtoo-ec/1.361220954515344675/libs/handlers.py", line 99, in set_track
    track_id = self.request.cookies.get("tagtoo_user_track", None)
  File "/base/python_runtime/python_lib/versions/1/webob/__init__.py", line 985, in cookies
    vars = self.str_cookies
  File "/base/python_runtime/python_lib/versions/1/webob/__init__.py", line 973, in str_cookies
    cookies.load(source)
  File "/base/python_runtime/python_dist/lib/python2.5/Cookie.py", line 619, in load
    self.__ParseString(rawdata)
  File "/base/python_runtime/python_dist/lib/python2.5/Cookie.py", line 650, in __ParseString
    self.__set(K, rval, cval)
  File "/base/python_runtime/python_dist/lib/python2.5/Cookie.py", line 572, in __set
    M.set(key, real_value, coded_value)
  File "/base/python_runtime/python_dist/lib/python2.5/Cookie.py", line 451, in set
    raise CookieError("Illegal key value: %s" % key)
CookieError: Illegal key value: tagtoo_user_ses{ion 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T06:28:19.300

看起来 cookie 字符串中存在格式错误。无论用户是否使用相关的 cookie 值，python 2.5 cookie 库都会引发异常。

可以通过以下方式检测错误的 cookie 值 `self.request.environ.get("HTTP_COOKIE")`

因此，我在引发异常时手动解析 cookie 以避免此问题。

# javascript - JavaScript 对象参数 - 似乎合法

> ID：12083975
> 
> 赞同：0
> 
> 时间：2012-08-23T02:32:34.710
> 
> 标签：javascript, function, object

有很多 JavaScript 函数可以直接接受一个对象，这里有一些例子。这不是特定于这些函数 jquery`$.ajax()`或 nodejs 模块中的任何一个`request()`，两者都只是示例。

```
$.ajax({
  method: "post",
  data: {'hello':'world'},
})

request({
  method : "post",
  body : "hello world",
}); 
```

我只是尝试了一些我认为可行的方法，这是一个更精细的版本。

```
request({
  method : function(){
    return "post";
  },
  data: {'hello':'world'},
}); 
```

令我惊讶的是，它没有用。这个也不行。

```
var m = function(){
  return "post";
};

request({
  method : m,
  data: {'hello':'world'},
}); 
```

我错过了什么吗？有什么方法可以将生成的函数放入这些对象中？我希望得到一些反馈。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T02:34:13.750

你不想在这里传递一个函数，你想传递它的返回值。

```
request({
  method: (function() {
    return "post";
  })(),
  data: {'hello':'world'}
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-23T02:34:42.557

您需要执行函数并使用返回值，而不是函数本身。

```
var m = function(){
  return "post";
};

var data = function() {
  return {'hello':'world'};
}

request({
  method : m(),
  data: data()
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T02:59:40.727

当文档加载时执行该函数，如下所示。这将使 m = 'post'

```
var m = (function(){
  return "post";
})();

request({
  method : m,
  data: {'hello':'world'},
}); 
```

# opencl - OpenCL 编译选项 ATI 与 NVIDIA

> ID：12083978
> 
> 赞同：2
> 
> 时间：2012-08-23T02:32:48.070
> 
> 标签：opencl

我尝试运行的一个示例程序具有来自 makefile 的编译选项。

```
ATISTREAMSDKROOT=/home/david/src/ati-stream-sdk-v2.0-lnx64
CC=gcc
CCFLAGS=-O3 -msse2 -mfpmath=sse -ftree-vectorize -funroll-loops -Wall \
    -I$(ATISTREAMSDKROOT)/include -L$(ATISTREAMSDKROOT)/lib/x86_64 -lglut -lOpenCL 
```

但我使用的是 Nvidia 的 OpenCL 实现，所以我将把选项改为这样。

```
CC=gcc
CCFLAGS=-O3 -msse2 -mfpmath=sse -ftree-vectorize -funroll-loops -Wall \
    -I ~/NVIDIA_GPU_Computing_SDK/OpenCL/common/inc/ -lglut -lOpenCL 
```

你能告诉我它是否正确吗？顺便说一句，我找不到与 ATI 对应的 NVIDIA 的“-L”选项的正确路径。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T10:36:29.793

有点令人困惑的是，NVIDIA 的 GPU 计算 SDK 根本不是一个真正的 SDK，它只是用 CUDA 和 OpenCL 编写的示例程序的集合。它不包含构建和运行 OpenCL 程序所需的头文件和库（这同样适用于 CUDA）。

您将在 NVIDIA GPU 计算工具包中找到您要查找的内容，其发布版本包含其 OpenCL 标头。你的编译命令应该是这样的：

```
CCFLAGS=-O3 -msse2 -mfpmath=sse -ftree-vectorize -funroll-loops -Wall \
    -I PATH_TO_NVIDIA_TOOLKIT/include/CL -lglut -lOpenCL 
```

`PATH_TO_NVIDIA_TOOLKIT`如果您接受工具包安装程序默认设置，则为 /usr/local/cuda。NVIDIA OpenCL 库在其驱动程序包中提供，`libOpenCL.so`应该以默认搜索路径结束，并且不需要显式搜索路径让链接器找到它。

# javascript - CoffeeScript 是否支持单引号字符串中的插值？

> ID：12083986
> 
> 赞同：8
> 
> 时间：2012-08-23T02:33:36.353
> 
> 标签：javascript, ruby, coffeescript

我来到这个问题：

```
 f = (param) ->
      console.info '#{param}'
 f(1) 
```

结果是`#{param}`

当我用双引号将字符串括起来时，这只是 print `1`。我也在 Ruby 中测试过它，它的行为是一样的。但这与 CoffeeScript.org 中的规则相矛盾：

**CoffeeScript 的黄金法则是：“它只是 JavaScript”。**

因为我认为在Javascript中，单引号和双引号是平等对待的。而且我不经常使用 Ruby。谁能解释为什么？

非常感谢。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-23T02:35:41.857

从[CoffeeScript 文档](http://coffeescript.org)：

> Ruby 风格的字符串插值包含在 CoffeeScript 中。双引号字符串允许使用 #{ ... } 进行插值，而单引号字符串是文字。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-08-23T02:40:06.190

“它只是 javascript”意味着它从根本上编译为普通的 JavaScript，并且不会尝试采用完全不同的编程范式并将其编译为 JavaScript。CoffeeScript 主要关注的是避免“不好的部分”、样板文件和不必要的语法，而不是引入完全不同的基本结构，例如数据类型等。

JavaScript 没有字符串插值。CoffeeScript 为方便起见从 Ruby 中引入了这一点。为单引号禁用它只是为您提供了一种在不解释插值的情况下获取字符串的干净方法。

不要把**It's just JavaScript 理解**为**It IS JavaScript**。这是一种风味/变体/兄弟姐妹。

# php - php 5.2.17 中的 $_GET['character'] 没有下降

> ID：12083987
> 
> 赞同：0
> 
> 时间：2012-08-23T02:33:51.607
> 
> 标签：php, get

我用这个

```
<a href='download.php/download=true' >download link here</a> 
```

所以现在的网址是

```
example.com/download.php/download=true 
```

我的download.php上有这个

```
if(isset($_GET['download'])) 
```

我也试过这个

```
if($_GET['download'] == 'true' ) 
```

这两个 $_GET 都不起作用......我所做的是我试图删除 IF CONDITION，并直接进入它的（IF 条件）内容，并且它有效。这就是为什么我得出结论 $_GET 在这里不起作用的原因。

有什么帮助吗？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T02:34:48.593

您没有在 URL 中提交查询字符​​串。你需要改变这个：

```
<a href='download.php/download=true'> 
```

对此：

```
<a href='download.php?download=true'>
                     ^
                     Note the changed character 
```

然后你可以使用：

```
if( isset( $_GET['download'])) {
} 
```

# c# - 调试拦截器模式

> ID：12083988
> 
> 赞同：3
> 
> 时间：2012-08-23T02:33:59.110
> 
> 标签：c#, ninject, interceptor, ninject-interception

我正在学习将拦截器模式与 Ninject 一起使用。

我有一个拦截器如下。

```
public class MyInterceptor:IInterceptor
{
    public void Intercept(IInvocation invocation)
    {
        Console.WriteLine("Pre Execute: " + invocation.Request.Method.Name);

        invocation.Proceed();

        Console.WriteLine("Post Execute: " + invocation.Request.Method.Name);
        Console.WriteLine("Returned: " + invocation.ReturnValue);
    }
} 
```

我正在我的 Main Method 中设置我的 Ninject 内核，如下所示。

```
kernel = new StandardKernel();

kernel.Bind<MyClass>().ToSelf().Intercept().With(new MyInterceptor());
myClass = kernel.Get<MyClass>(); 
```

问题是，在调试对 的方法调用时`myClass`，（我在语句上放置一个断点`myClass.methodName()`并按 F11）在我看到对我的拦截器的调用之前，有很多堆栈帧要传递，然后是实际的方法调用。

我确实意识到 Ninject 创建了 Dynamic Proxies .etc。在幕后，但这使事情变得更加困难，如果我想查看我的代码流程，从所有拦截器到实际方法。（想象一下调试以查看哪个拦截器阻塞了方法调用）

有没有办法告诉 Visual Studio 不要中断 Ninject 堆栈帧？（反正我没有 Ninject 源）

**更新** 本质上，我想做的是告诉VS不要破坏我没有源代码的代码......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T08:51:57.347

在选项对话框中挖掘了 4 个小时并在 Google 上搜索某些复选框的作用（单个对话框可以有多复杂？）后，我找到了答案。

实际上，您可以告诉 Visual Studio 不要担心某些 DLL 或 EXE，并在不中断和询问源代码的情况下逐步“通过”它们。

这是如何做到的。

1.  在 Visual Studio 中打开选项对话框。（工具 > 选项）
2.  导航到调试 > 符号部分

或者在 VS 2012+ 的右上角“快速启动”框中键入“符号”，然后按 Enter。

4.  在右下角，选择“所有模块，除非排除”

    [屏幕截图 http://i40.tinypic.com/10gaedt.png](http://i40.tinypic.com/10gaedt.png)

5.  单击该链接并指定要排除的 DLL 或 EXE。

6.  添加你~~不关心~~不想调试的模块。

[![屏幕截图](../Images/cde1e13f45d3becaacfa9c8f323eebc0.png)](https://i.stack.imgur.com/MVCS0.png)

就我而言，我必须添加

*   `Ninject.dll`
    *   Ninject 核心 DLL
*   `Ninject.Extensions.Interception.dll`
    *   这是忍者拦截模块
*   `Ninject.Extensions.Interception.DynamicProxy.dll`
    *   我使用动态代理实现拦截模块，而不是 LinFu 实现。我也不想调试这个。

从本质上讲，这个对话框的意思是，'我不关心这些 DLL。当我调试时忽略它们'。

似乎您只需要 EXE 或 DLL 名称，而不是整个路径。而且它似乎不区分大小写。

此选项在 VS 2010 和 VS 2012 中。如果您有旧版本并需要此功能，您*可能*会不走运。

添加后，所有 'Step-Into' (F11) 命令仅转到我编写的代码，不要求符号，也不要求我找到 Ninject 的源文件。在调用堆栈窗口中，来自这些程序集的所有堆栈帧都合并到名为“[外部代码]”的一行。

快乐编码。

我希望这能让你的生活更轻松。

# java - 如何在java中检测鼠标位置

> ID：12083993
> 
> 赞同：0
> 
> 时间：2012-08-23T02:34:15.460
> 
> 标签：java, mouseevent, mousemove

`MouseInfo`我在使用Java Applets 中的类时遇到了问题。

```
int somex = MouseInfo.getPointerInfo().getLocation().x;         
int somey = MouseInfo.getPointerInfo().getLocation().y;` 
```

上面的代码在普通的java程序中工作得很好，但是在applet中，我得到了一个

```
Exception in thread "AWT-EventQueue-1" java.security.AccessControlException: access denied (java.awt.AWTPermission watchMousePointer)
at java.security.AccessControlContext.checkPermission(AccessControlContext.java:374)
    at java.security.AccessController.checkPermission(AccessController.java:546)
    at java.lang.SecurityManager.checkPermission(SecurityManager.java:532)
    at java.awt.MouseInfo.getPointerInfo(MouseInfo.java:62)
    at Mousefollow.getCOOR(Mousefollow.java:208)
    at Mousefollow.paint(Mousefollow.java:160)
    at javax.swing.RepaintManager.paintDirtyRegions(RepaintManager.java:796)
    at javax.swing.RepaintManager.paintDirtyRegions(RepaintManager.java:713)
    at javax.swing.RepaintManager.seqPaintDirtyRegions(RepaintManager.java:693)
    etc etc etc. 
```

有谁知道为什么我不能在小程序中使用该代码？如何更改安全管理器以使其正常工作？

我问这个的原因是我有一个大的小程序（游戏），效果很好，除了我需要添加鼠标控件。

如果有人对如何调整上述代码或找到鼠标/键盘位置的完全不同的方法有任何建议，我们将不胜感激。

它通过使用`KeyListener`、`MouseListener`、`MouseMotionListener`等相对工作`ActionListener`，但问题`MouseMotion`是如果鼠标保持不动，它就无法检测到鼠标的位置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T02:46:37.837

小程序不是普通的应用程序。请参阅Java 教程中的文档[What Applets Can and Cannot Do。](http://docs.oracle.com/javase/tutorial/deployment/applet/security.html)我建议您在游戏中使用`MouseMotionListener`.

只需将最后一个已知位置保存在一个变量中，这样您就可以在用户不移动鼠标时检测到该位置。

如果您希望您的小程序表现得更像一个适当的应用程序，您将需要对其进行签名：请参阅Java 教程[中的富 Internet 应用程序中的安全性。](http://docs.oracle.com/javase/tutorial/deployment/doingMoreWithRIA/security.html)

# objective-c - 更改核心情节中图例的大小？

> ID：12083994
> 
> 赞同：1
> 
> 时间：2012-08-23T02:34:33.607
> 
> 标签：objective-c, macos, cocoa, core-plot

我有一个带有相应图例的饼图。如何更改图例框的大小？（使包括文本、颜色框和框架在内的所有内容变小）。

注意我正在为 OSX 而不是 iOS 构建应用程序。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T03:23:48.710

如果您只是设置较小的文本样式，则`CPTLegend`所有内容都将根据要求调整大小。因此，对于您，`CPTGraph`您将要做：

```
CPMutableTTextStyle *mySmallerTextStyle = [[[CPTMutableTextStyle alloc] init] autorelease];
[textStyle setFontName:fontName];
[textStyle setColor:color];

//This is the important property for your needs
[textStyle setFontSize:5];

//Set this up with your graph
[graph setLegend:[CPTLegend legendWithGraph:graph]];
[[graph legend] setTextStyle:(CPTTextStyle *)mySmallerTextStyle]; 
```

CorePlot 论坛上对此进行了讨论[。](https://groups.google.com/d/topic/coreplot-discuss/LMEtRt1b4zI/discussion)

# php - 在 PHP 中使用回调函数时的问题

> ID：12083995
> 
> 赞同：0
> 
> 时间：2012-08-23T02:34:34.027
> 
> 标签：php, callback

我在使用回调函数时遇到了这个问题

```
Class My_Class {

     public function my_function() {

            $pad = function($value) {
            return str_pad($value, 2, '0', STR_PAD_LEFT);
            };

            function pad_function($value) {
                 return str_pad($value, 2, '0', STR_PAD_LEFT);
            }

            array_map($pad, range(0,100)); //This fails with an exception "Invalid opcode 153/1/8."
            array_map("pad_function", range(0,100)); //This works ok
        }

} 
```

我正在使用 PHP 版本 5.3.3-7。

关于为什么会发生这种情况的任何想法？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T06:27:43.037

最后，问题出在加速器上。

执行代码时，eaccelerator 的 1.0-dev 版本会出现斜杠。eaccelerator 0.9.6.1 版不会因代码而崩溃。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T02:47:05.590

除了错别字，`$pad`从来没有定义过。

然后`array_map`不会调用您的`$my_pad_function`lambda 函数，因为您将`my_pad_function`字符串作为第一个参数传递，告诉 PHP 查找*名为* `my_pad_function`: 的函数，这与调用存储在`$my_pad_function`.

无论如何，我建议您不要将所有内容都称为“my_function”、“myPrettyFunction”、“myPointlessNameVar”：即使在操场代码中也可以给出有意义的名称，您的目标会更清晰。

最后一件事：

```
lambdas : PHP = lipstick : pig 
```

# javascript - 流星无限循环

> ID：12083997
> 
> 赞同：0
> 
> 时间：2012-08-23T02:34:41.760
> 
> 标签：javascript, node.js, meteor

我正在尝试更改 Collection 的属性以在渲染之前为它们提供绝对位置。如果该项目是集合中的第一个，则它的顶部为 0，左侧为 0。第二个的顶部为 0，左侧为 20，依此类推。但是当我尝试将此逻辑构建到我的模板中时，它会导致无限循环。这是我的代码：

```
if (Meteor.is_client) {

  _.extend(Template.movies, {

    movies: function() {
      var movies = Movies.find({}, {sort: {name: 1}});

      var determineLocation = function(){
        console.log('hello');

          var count = 0; 

            movies.forEach(function(movie){
              // do some math
              Movies.update(movie._id, {$set: {left: 10, top: 20}});
              count++; 
            });
          }; 

      determineLocation(); 

      return movies; 
    }
  });
}; 
```

我认为这样做是因为 Movies.update 命令触发了 movies 函数再次渲染，从而导致了无限循环。我应该如何解决这个问题？放置确定位置函数的正确位置在哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-02T14:25:05.073

将你的流星扩展放在启动流星启动函数中：

```
Meteor.startup( function(){
if (Meteor.is_client) {

  _.extend(Template.movies, {

    movies: function() {
    var movies = Movies.find({}, {sort: {name: 1}});

    var determineLocation = function(){
    console.log('hello');

    var count = 0; 

    movies.forEach(function(movie){
          // do some math
          Movies.update(movie._id, {$set: {left: 10, top: 20}});
          count++; 
        });
      }; 

      determineLocation(); 

      return movies; 
    }
  });
}; 
```

初创公司或多或少是合并的，所以不用担心。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T03:06:07.603

您希望此代码在客户端首次加载时运行一次吗？我认为`Meteor.startup`打电话是合适的：

```
 Meteor.startup(function() {
   // do the updating part
 }); 
```