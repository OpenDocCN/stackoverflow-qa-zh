# StackOverflow 问答 10183000-10183999

# r - 向量的 R 函数

> ID：10183000
> 
> 赞同：0
> 
> 时间：2012-04-16T23:16:44.757
> 
> 标签：r, function

我有一个数据框，我试图采用一个因子变量，只保留前 31 个级别，并使所有其他级别成为通用级别。

我需要跨多个向量执行此操作，所以我想我会创建函数，但我运气不佳。我认为我需要以某种方式使用`mapply`，或者`Vectorize`但我认为我没有正确执行它，因为我收到有关无法分配 3.6 gigs 内存的错误消息。

这是函数，其中 x 是向量，topCount 是要保留的级别数

```
createFactor <-function(x, topCount){
    table1 <- data.frame(table(x))
    table1 <- table1[order(-table1$Freq),]
    noChange <- table1$Var1[1:topCount]
    newVals1 <- factor(ifelse(x %in% noChange, x, "-1000"))
    newVals1
} 
```

我希望能够写出这样的东西：

```
df1$topLevels <- createFactor(df1$fact1, 31) 
```

有什么建议么 ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-16T23:44:21.387

我不完全确定它的性能特征，但我可能会写这个函数更像这样：

```
topK <- function(x,k){
    tbl <- tabulate(x)
    names(tbl) <- levels(x)
    x <- as.character(x)
    levelsToKeep <- names(tail(sort(tbl),k))
    x[!(x %in% levelsToKeep)] <- '-1000'
    factor(x)
} 
```

我使用过的地方`tabulate`而不是`table`因为我怀疑它可能会更快（这在你的情况下似乎很重要），尽管我没有测试过它实际上会快多少。

# wpf - 跨不同 DataGrid 行的 DataTemplate 重复

> ID：10183003
> 
> 赞同：0
> 
> 时间：2012-04-16T23:17:56.660
> 
> 标签：wpf, datagrid, datatemplate, datagridcomboboxcolumn, datatemplateselector

我有一个 WPF 4 DataGrid，其中第一个 ComboBox 通过使用 DataTemplateSelector 键控一个 id 来更改第二个 ComboBox 绑定的内容。出于某种奇怪的原因，第二列中的任何相同类型的单元格似乎都绑定到相同的值。我相信这与使用 DataTemplate 有关，因为我以前见过这个问题，但显然我不了解我需要知道的东西。

这是我到目前为止组装的代码：

MainWindow.xaml：

```
<Window x:Class="WpfApplication1.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:WpfApplication1" Title="MainWindow" Height="300" Width="300"  Loaded="WindowLoaded">
    <Window.Resources>
        <CollectionViewSource x:Key="MainSource" />
        <CollectionViewSource x:Key="TypeSource" />
        <CollectionViewSource x:Key="DaysInMonthSource" />
        <CollectionViewSource x:Key="DaysInWeekSource" />

        <local:TypeSelector x:Key="cbTypeSelector">
            <local:TypeSelector.EmptyTemplate>
                <DataTemplate x:Name="Emptied">
                    <Grid></Grid>
                </DataTemplate>
            </local:TypeSelector.EmptyTemplate>
            <local:TypeSelector.DaysInWeekTemplate>
                <DataTemplate>
                    <ComboBox SelectedValue="{Binding Path=dayNumber, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, NotifyOnSourceUpdated=True}" 
                              ItemsSource="{Binding Source={StaticResource DaysInWeekSource}}" 
                              DisplayMemberPath="name" SelectedValuePath="id" Name="cb" Padding="3,2,3,3" />
                </DataTemplate>
            </local:TypeSelector.DaysInWeekTemplate>
            <local:TypeSelector.DaysInMonthTemplate>
                <DataTemplate>
                    <ComboBox SelectedValue="{Binding Path=dayNumber, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, NotifyOnSourceUpdated=True}" 
                              ItemsSource="{Binding Source={StaticResource DaysInMonthSource}}" 
                              DisplayMemberPath="name" SelectedValuePath="id" Name="cb" Padding="3,2,3,3"  />
                </DataTemplate>
            </local:TypeSelector.DaysInMonthTemplate>
        </local:TypeSelector>
    </Window.Resources>
    <Grid>
        <DataGrid AutoGenerateColumns="False" Name="DataGrid1" CanUserAddRows="True" SelectionMode="Single" 
                   EnableColumnVirtualization="True" EnableRowVirtualization="True" >
            <DataGrid.Columns>
                <DataGridComboBoxColumn 
                    Header="Type" IsReadOnly="False"
                    DisplayMemberPath="name" SelectedValuePath="id" SelectedValueBinding="{Binding Path=type_id, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, NotifyOnSourceUpdated=True}"
                    ItemsSource="{Binding Source={StaticResource TypeSource}}">
                </DataGridComboBoxColumn>
                <DataGridTemplateColumn Header="Day" IsReadOnly="False">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <ContentPresenter local:Helper.UpdateTrigger="{Binding Path=type_id}" ContentTemplateSelector="{StaticResource cbTypeSelector}"/>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
            </DataGrid.Columns>
        </DataGrid>
    </Grid>
</Window> 
```

主窗口.xaml.cs

```
using System.Collections.Generic;
using System.Globalization;
using System.Linq;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Media;

namespace WpfApplication1
{

    public class DayContainer
    {
        public int id { get; set; }
        public string type_id { get; set; }
        public string dayNumber { get; set; }
    }

    public class TypeSelector : DataTemplateSelector
    {
        public DataTemplate EmptyTemplate { get; set; }
        public DataTemplate DaysInWeekTemplate { get; set; }
        public DataTemplate DaysInMonthTemplate { get; set; }

        public override DataTemplate SelectTemplate(object item, DependencyObject container)
        {
            var element = container as FrameworkElement;
            if (element == null || item == null) return EmptyTemplate;
            var dgr = FindVisualParent<DataGridRow>(element);
            var drv = dgr.Item as DayContainer;
            if (drv == null) return EmptyTemplate;
            if (drv.type_id == "1")
                return DaysInWeekTemplate;
            if (drv.type_id == "2")
                return DaysInMonthTemplate;
            return EmptyTemplate;
        }

        public static T FindVisualParent<T>(UIElement element) where T : UIElement
        {
            var parent = element;
            while (parent != null)
            {
                var correctlyTyped = parent as T;
                if (correctlyTyped != null) return correctlyTyped;
                parent = VisualTreeHelper.GetParent(parent) as UIElement;
            }
            return null;
        }
    }

    public class Helper
    {
        public static object GetUpdateTrigger(DependencyObject obj)
        {
            return obj.GetValue(UpdateTriggerProperty);
        }
        public static void SetUpdateTrigger(DependencyObject obj, object value)
        {
            obj.SetValue(UpdateTriggerProperty, value);
        }
        public static readonly DependencyProperty UpdateTriggerProperty =
            DependencyProperty.RegisterAttached("UpdateTrigger", typeof(object), typeof(Helper), new FrameworkPropertyMetadata(OnUpdateTriggerChanged));
        public static void OnUpdateTriggerChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
        {
            var cp = d as ContentPresenter;
            if (cp == null) return;
            var temp = cp.Content;
            cp.Content = null;
            cp.Content = temp;
        }
    }

    public partial class MainWindow
    {
        public MainWindow()
        {
            InitializeComponent();
        }

        private void WindowLoaded(object sender, RoutedEventArgs e)
        {
            var source = (CollectionViewSource)FindResource("MainSource");
            source.Source = new List<DayContainer>
                                {
                                    new DayContainer {id = 1, type_id = "1", dayNumber = "1"},
                                    new DayContainer {id = 2, type_id = "1", dayNumber = "2"},
                                    new DayContainer {id = 3, type_id = "2", dayNumber = "3"},
                                };
            DataGrid1.ItemsSource = source.View;

            source = (CollectionViewSource)FindResource("TypeSource");
            if (source != null && source.Source == null)
                source.Source
                    = new[]
                          {
                              new {id = "1", name = "Week"},
                              new {id = "2", name = "Month"}
                          };

            source = (CollectionViewSource)FindResource("DaysInWeekSource");
            if (source != null && source.Source == null)
                source.Source
                    = new[]
                          {
                              new {id = "1", name = "Sunday"},
                              new {id = "2", name = "Monday"},
                              new {id = "3", name = "Tuesdsay"},
                              new {id = "4", name = "Wedsnesday"},
                              new {id = "5", name = "Thursday"},
                              new {id = "6", name = "Friday"},
                              new {id = "7", name = "Saturday"}
                          };

            source = (CollectionViewSource)FindResource("DaysInMonthSource");
            if (source != null && source.Source == null)
                source.Source = from n in Enumerable.Range(1, 31)
                                select new { id = n.ToString(CultureInfo.InvariantCulture), name = n.ToString(CultureInfo.InvariantCulture) };
        }
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T16:25:12.830

找到解决方案，以防它帮助任何人。

只需将 IsSynchronizedWithCurrentItem="False" 添加到每个 ComboBox。

# ajax - Rails 3.1 和 AJAX - 如何实现它？

> ID：10183005
> 
> 赞同：1
> 
> 时间：2012-04-16T23:18:17.470
> 
> 标签：ajax, ruby-on-rails-3, jquery

我的 Rails 应用程序存在大量 AJAX 设计问题。要了解 APP - 您有一个可以注册的课程列表。它以前都是 HTML，但我想重写它并在其中放入一些 AJAX。它看起来很像图片中的：

![应用程序的图片](../Images/bf352e8a9b3716f7f46108aa6f066f3c.png)

主表是类列表。蓝色按钮表示“注册课程”，红色表示“退出”，绿色表示正在处理 AJAX 请求。在左上角有一个搜索表格。显然它有效（我的意思是搜索，我希望它通过 AJAX -> 刷新类工作。左侧列表显示您登录的所有类。

我有一个很大的设计问题。似乎我知道如何分别实现所有 ajax 操作，但是当我尝试将它们全部组合起来时，一切都搞砸了。没有关于如何做到这一点的全面教程，不是吗？我尝试使用 jquery。

控制器称为**wyklads**，动作**wyklady** 所以这就是我所拥有的：

**0\. 布局**

```
<div class="span3">
    <div class="row-fluid">

        <div class="well wyszukiwarka">
            <%= render 'search'%> #search form
        </div>

        <div class="well usuwanie">
            <%= render 'usuwanie' %> #left list of my classes
        </div>
    </div>
</div>

<div class="span9">
       <%= render 'wyklady' %> #table of classes
    </div> 
```

**1\. 搜索**

```
 application.js
 $('div.wyszukiwarka form input.btn').submit(function() {
    $.get($this.action, $(this).serialize(), null, "script");
    return false;
 });

 the table with classes is refreshed because of wyklady.js.erb that loads automatically
 $('div.tab-przedmioty').html("<%= escape_javascript(render('wyklady')) %>"); 
```

**2\. 控制器**

```
 def wyklady
  if params[:search]
   @wyklads = Wyklad.where(:pozstudiow => poziom, :typo => 1).search(params[:search])
   @labs = Lab.where(:pozstudiow => poziom, :typo => 1).search(params[:search])
  else
   @wyklads = Wyklad.where(:pozstudiow => poziom, :typo => 1)
   @labs = Lab.where(:pozstudiow => poziom, :typo => 1)
  end
 end 
```

**3\. 用于添加类的按钮**（我使用的是 twitter 引导程序）

```
 <%= button_to 'Dodaj do planu', {:controller => :plans, :action => :create, :przedmiot_id => wyklad.id, :typ => 0}, :method => :post, :remote => true, :class => 'btn btn-small btn-primary addprzedmiot-btn', :style => 'padding: 2px 5px; margin: 0; width: 90px;', :"data-toggle" => 'button', :"data-loading-text" => 'Dodano' %> 
```

起初我试图从 jquery中放入**wyklady.js.erb条件状态：**

```
 $('.addprzedmiot-btn').click(function() {
   $('div.tab-przedmioty').html("<%= escape_javascript(render('wyklady')) %>");
 }); 
```

然后我试图从计划控制器执行js（当你注册一个类时，你会创建一个新计划）：

```
 in Plans controller

 def create
 ...
  if @plan.save
  respond_to do |format|
    format.js
  end
 end

 and plans/create.js.erb

 $('div.usuwanie').html("<%= escape_javascript(render('wyklads/usuwanie')) %>"); 
```

但它说它没有在左侧呈现列表，在日志中说它缺少来自 Wyklads 控制器的一些对象（nil 类）。

唯一可行的解​​决方案是每次调用后都通过 ajax 刷新所有内容，这是非常无效的。我想避免它，因为类表很长，并且需要大量时间来填充它。

**我希望这一切都表现得像这样：** 1.只有在您提交搜索时才会刷新课程表，2.当您注册课程时蓝色按钮变为绿色（表示按下按钮，由引导程序处理得很好），列出左侧刷新，但右侧的表格不再填充一次。刷新整个页面后，绿色按钮变为红色。

所以这个问题有点宽泛。如果有人能如此耐心地解释解决方案以及解释混合多个 ajax 事件并处理它们的一些关键概念（或给出一些建议、教程），我将非常感激。纯代码不如概念重要。在那之后，我想再“ajaxify”一点，但首先必须了解基础知识。

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T06:15:06.333

可能是ajax调用的问题，

在 application.js 中

```
 $('div.wyszukiwarka form input.btn').submit(function() {
    $.get($this.action, $(this).serialize(), null, "script"); // what is $this? $(this) is button instead of form
    return false;
 }); 
```

尝试这个

```
 $('div.wyszukiwarka form').submit(function() {
    $this = $(this)
    $.get($this.action, $this.serialize(), null, "script");
    return false;
 }); 
```

# c++ - cin 没有操作数 >>

> ID：10183008
> 
> 赞同：3
> 
> 时间：2012-04-16T23:18:38.963
> 
> 标签：c++, iostream, cin

我不明白为什么这不起作用。出于某种原因，我收到了错误：

`error C2678: binary '>>' : no operator found which takes a left-hand operand of type 'std::istream' (or there is no acceptable conversion)`

如果有帮助，我将在 Visual Studio2010 C++ Express 中执行此操作。不知道为什么它给我这个错误我已经使用其他程序完成了`cin`......

我的代码：

```
#include <iostream>
#include <iomanip>
#include <fstream>
using namespace std;

int main(int argc, char* argv){
    string file;

    if (argc > 1)
    {
        file = argv[1];
    }
    else
    {
        cout << "Please Enter Your Filename: ";
        cin >> file;
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-16T23:23:36.080

包括`<string>`

最重要的是，我建议您改用 getline，因为 >> 将在您输入的第一个单词处停止。

例子：

```
std::cin >> file; // User inputs C:\Users\Andrew Finnell\Documents\MyFile.txt 
```

结果是“C:\Users\Andrew”，考虑到数据直到换行才会被消耗，这是相当意外的，下一次读取的 std::string 将自动被消耗并填充为“Finnell\Documnts\MyFile.txt”

```
std::getline(std::cin, file); 
```

这将消耗所有文本，直到换行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T23:21:26.450

您忘记了 include `<string>`，这是定义该函数的地方。请记住，每种类型都将其自己定义`operator>>`为静态函数，以便通过流进行操作。不可能编写输入流来考虑将来可能创建的所有类型，因此以这种方式进行扩展。

# android - 尝试下载apk文件时文件不喜欢异常

> ID：10183009
> 
> 赞同：0
> 
> 时间：2012-04-16T23:18:51.630
> 
> 标签：android, iis-7

我有一个托管在 iis 7 中的 android apk 文件，我想从一个 android 应用程序中下载并安装它。我非常依赖[这个问题](https://stackoverflow.com/questions/4967669/android-install-apk-programmatically)中的代码，但我在收到 fileNotFound 异常`InputStream is = con.getInputStream();`

我可以在我的桌面和手机（三星 Galaxy Nexus）上的浏览器中下载 apk 文件，并且我已将 apk mime 类型添加到 iis。

这是我的代码。

```
protected Void doInBackground(Void... params) {
        try {
            URL url = new URL("http://android.atomweb.net.au/CasLite.apk");
            HttpURLConnection con = (HttpURLConnection) url.openConnection();

            con.setRequestMethod("POST");
            con.setDoOutput(true);
            con.connect();

            String PATH = Environment.getExternalStorageDirectory() + "/download/";
            File file = new File(PATH);
            file.mkdirs();
            File outputFile = new File(file, "app.apk");
            FileOutputStream fos = new FileOutputStream(outputFile);

            InputStream is = con.getInputStream();

            byte[] buffer = new byte[1024];
            int len1 = 0;
            while ((len1 = is.read(buffer)) != -1) {
                fos.write(buffer, 0, len1);
            }

            fos.close();
            is.close();

            Intent intent = new Intent(Intent.ACTION_VIEW);
            intent.setDataAndType(
                    Uri.fromFile(new File(Environment.getExternalStorageDirectory() + "/download/" + "app.apk")),
                    "application/vnd.android.package-archive");

            startActivity(intent);

        } catch (IOException e) {
            Log.d("Error", e.getLocalizedMessage());
        }
        return null;

    } 
```

当我在建立连接之后但在 getInputStream 之前发布断点并查看连接响应代码时，它是 405。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T23:23:07.310

那不应该是 GET，而不是 POST 吗？

# tumblr - 对 tumblr 中的类别使用不同的样式？

> ID：10183010
> 
> 赞同：1
> 
> 时间：2012-04-16T23:18:58.417
> 
> 标签：tumblr

我希望能够将带有不同标签（例如汽车、摩托车、船舶）的照片发布到 tumblr。然后，在帖子中，每个标签应为每个标签显示不同颜色的水平线，例如蓝色代表汽车，红色代表摩托车，绿色代表轮船。如果我放一张带有其他标签（如自行车或飞机）的照片，它应该显示一条灰线。

我真的找不到解决方案。

在这里，但它显示了每个帖子的所有行：http: [//ekoba.tumblr.com](http://ekoba.tumblr.com)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T11:27:14.243

如果您更改主题的标记以将帖子标签添加为 HTML 类，那么您可以基于标签设置 CSS 属性。例如，您将主题设置为：

```
{block:Posts}
    <div class="post {TagsAsClasses}">
         .... 
```

并像这样设置你的 CSS：

```
div.cars hr {
   color: blue;
}

div.motorcycles hr {
   color: red;
} 
```

这将为每个帖子的容器元素添加 HTML 类，这些元素基于您定义的标签，并允许您根据这些标签创建不同的样式。

你可以看到这个以获取更多信息：[http ://www.tumblr.com/docs/en/custom_themes#posts](http://www.tumblr.com/docs/en/custom_themes#posts)

# mysql - Zend_Db_Table 选择缺失数据，直接PHP查询ok

> ID：10183011
> 
> 赞同：2
> 
> 时间：2012-04-16T23:18:59.810
> 
> 标签：mysql, zend-framework, mysqli, json, zend-db-table

我正在将一个 php 应用程序转换为 zend 框架并利用 Zend_Db_Table 进行查询。我的问题是，在转换为 zend 格式后，我对文本格式字段的预期结果返回一个空字符串而不是存储的数据。

文本字段长度为 11000 的记录总是返回空，但是另一个长度为 2500 的记录总是正确返回。

有什么我需要配置的吗？使用 zend db 表返回的数据是否有限制？

PHP MySQL 使用 mysqli，返回 true，var 有值

```
$db = new mysqli(DB_HOST, DB_USER, DB_PASSWORD, DB_NAME);
$stmt= "select * from m_message where m.m_id='".$m_id."'";
$result = $db->query($q_message); 
```

$result['m_content'] 等于“我得到了...的副本”（11000 个字符/长度）

Zend 使用 pdo_mysql，返回 true，var 没有值

```
$this->_db = Zend_Db_Table::getDefaultAdapter();
$stmt = $this->_db->query('SELECT m_content FROM m_message WHERE m_id = ? ', $messageId);
$result = $stmt->fetchAll(); 
```

$result['m_content'] 等于（字符串）

```
$this->_db = Zend_Db_Table::getDefaultAdapter(); 
$stmt = $this->_db->select()->from('m_message', 'm_content')->where('m_id = ?',$messageId );
$result = $this->_db->fetchAll($stmt); 
```

$result['m_content'] 等于（字符串）

# 更新

事实证明，在 Netbeans 中调试时观察变量时显示为空。正如预期的那样，变量的 var_dump 实际上显示了数据。问题是当我使用 JSON 助手将数组作为 json 返回时。查看 json_last_error() 时，它返回 5，JSON_ERROR_UTF8。

我的数据库字符集是 UTF-8，但是为了解决这个问题，我必须在将其传递给 json 助手之前执行 utf8_encode($result['m_content']) ：/

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T08:57:48.760

对于您的最后一次更新，试试这个，这样您的连接实际上是 UTF-8。

```
$db = new mysqli(DB_HOST, DB_USER, DB_PASSWORD, DB_NAME);
$this->_db->query("SET NAMES 'utf8'"); 
```

# android - 是否可以在 Android 应用程序中使用差异？

> ID：10183012
> 
> 赞同：0
> 
> 时间：2012-04-16T23:19:07.937
> 
> 标签：android, diff

diff 是否以任何方式、形状或形式包含在 Android 中，以便可以从 Android 应用程序调用？还是我只需要使用可用的 java 包之一（例如[Generate formatted diff output in Java](https://stackoverflow.com/questions/319479/generate-formatted-diff-output-in-java)）。

基本上我要做的是打开一个 xml 文件，然后立即输出一个 xml 文件，以确保我的应用程序不会在其导入/导出过程中搞砸任何事情。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T01:16:30.467

我会看看这篇文章：[我的 Android 应用程序的数据文件在哪里？](https://stackoverflow.com/questions/5053252/where-are-my-android-apps-data-files)

您可以尝试读取 XML，然后将其写入新文件，然后使用 adb 提取这两个文件并在您的计算机上（而不是在设备上）进行比较。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T23:26:25.950

我不认为它是可用的，我会使用其中一种 java 实现。我怀疑你甚至可以在没有越狱的情况下可靠地掏出或任何东西。

# asp.net - Asp.Net开发服务器文件路径

> ID：10183014
> 
> 赞同：1
> 
> 时间：2012-04-16T23:19:39.040
> 
> 标签：asp.net, asp.net-mvc

我应该如何设置 vs 开发服务器以有可能通过相对路径获取文件？我的意思是，当我输入文件的路径时：“somefile.txt”服务器应该在 web 项目文件夹中搜索，但现在在设置 asp.net 开发服务器的文件夹中

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T23:25:38.033

我相信这可能会对您有所帮助：

如果要获取文件夹的路径（例如图像文件夹）：

```
String pathToImgFolder = VirtualPathUtility.ToAbsolute("~/Content/imgs/"); 
```

查看[VirtualPathUtility](http://msdn.microsoft.com/en-us/library/system.web.virtualpathutility.aspx)文档以获取更多详细信息。

我希望这有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T23:46:31.890

在服务器端，我通常会选择：

```
Server.MapPath(@"~\your\relative\path") 
```

在客户端（如果项目不是根站点）：

```
<script src="<%: Url.Content("~/Scripts/jquery-1.5.1.min.js") %>" type="text/javascript"></script> 
```

如果项目是根站点（即-some.site.com），那么在视图上我并不担心它，只需使用站点的相对路径。

```
<script src="/Scripts/jquery-1.5.1.min.js" type="text/javascript"></script> 
```

但这只是个人喜好，除非您完全确定，否则不应真正使用它。虽然是个人喜好，但我个人也不得不重构很多断开的链接。因此，对于视图，第一个选项是通过相对路径访问文件的最佳方式。

# javascript - 不显眼的快速过滤器下拉菜单 实施

> ID：10183016
> 
> 赞同：1
> 
> 时间：2012-04-16T23:19:59.033
> 
> 标签：javascript, jquery, autocomplete

我正在使用 UFD 自动完成插件，谁能建议如何在这个插件中实现 OPTGROUP 功能？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T23:46:26.337

从[功能](http://code.google.com/p/ufd/wiki/Features)页面...

> **限制**
> 
> 听起来不错，但是对于您的情况，您可能想了解哪些缺失的功能呢：
> 
> *   ***没有`<OPTGROUP ..>`支持。***有可能实现。
> *   没有复杂的每项内容，例如多个图像或 HTML。一个`<LI .. >`带有背景图像、悬停/活动类和 CSS 的块就是你所得到的——性能更重要，抱歉。
> *   不支持多选，即`<SELECT multiple .. >`. (thetoolman) 不推荐它们作为一个好的 UI 小部件： ctrl + 单击以输入表单？不，谢谢。使用复选框或一些更好的比喻！
> *   没有 JSON/ajax/ajax-autocomplete 支持。这只是`<SELECT.. >`标签上的一个包装器，因此您可以通过您喜欢的任何技术/工具修改或注入新`<OPTION ..>`的主节点，然后只需从该主节点触发重新加载`<SELECT ..>`:)
> *   如果您正在升级，则与性感组合配置、CSS、回调等的向后兼容性有限。然而，过渡应该很容易，因为包含的皮肤或多或少使用相同的文件布局。
> *   许多事件没有传递，例如关键事件。欢迎使用其他类型的事件模拟的用例建议。
> *   尚未使用屏幕阅读器和其他特殊访问技术进行测试。很高兴接受建议，尤其是在上面链接的当前演示页面中启用虚拟 ARIA 的主题滚轮测试。

如果您要问如何自己实现它，则需要从它开始，并在遇到困难时提出问题。

# algorithm - PCA 和 KNN 算法

> ID：10183017
> 
> 赞同：15
> 
> 时间：2012-04-16T23:20:02.107
> 
> 标签：algorithm, pca, knn

我正在使用 KNN 对手写数字进行分类。我现在也实施了 PCA 来降低维度。从 256 到 200。但我只注意到大约 0.10% 的信息丢失。我删除了 56 维。损失不应该更大吗？只有当我下降到 5 个维度时，我才会损失约 20%。这是正常的吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-18T13:30:20.793

你是说去掉56维后，你几乎没有丢失任何信息？当然，这就是 PCA 的重点！[主成分分析](http://en.wikipedia.org/wiki/Principal_component_analysis)，顾名思义，可以帮助您确定哪些维度承载信息。您可以删除其余部分，这是其中最大的一部分。

我想要一些例子，在基因分析中，我已经阅读了使用 PCA 将维度从 40'000 减少到 100 的论文，然后他们做了一些神奇的事情，并拥有一个具有 19 个维度的出色分类器。这隐含地告诉您，当他们删除 39,900 个维度时，他们几乎没有丢失任何信息！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T21:02:16.643

这很正常，是的（就像 Fezvez 所说的那样）。你的案例实际上是一个很好的例子，你可以看到这是怎么可能的。

查看您的数据（这在机器学习中始终很重要，*了解您的数据*）。如果您在白色上有黑色手写数字的图像，则很可能所有样本的某些角落的像素都是白色的（当我对手写数字进行机器学习时，我在一个角落有这种情况）。因此，该像素中实际上没有任何信息。如果您将其作为 KNN 或 ANN 或其他任何东西的输入，您将得到相同的结果。

# c - Microchip C18裸函数

> ID：10183019
> 
> 赞同：2
> 
> 时间：2012-04-16T23:20:03.907
> 
> 标签：c, pic18, c18

有人知道在 C18 编译器上声明裸函数的方法吗？

裸函数是指没有任何结语和序言的函数。

在 gcc 中我使用：

```
__attribute__((naked)) int func(int par1) 
```

也许是一个#pragma 或一些技巧来获得相同的结果......？？

谢谢！

# objective-c - UISearchDisplayController tableView 不会触发 prepareForSegue

> ID：10183020
> 
> 赞同：0
> 
> 时间：2012-04-16T23:20:13.813
> 
> 标签：objective-c

我究竟做错了什么？

我有 2 个 tableViewControllers。其中一个工作正常。当我进行搜索时，右侧的附件按钮会显示结果，并且 prepareForSegue 运行良好。

但是另一个tableViewController和第一个完全一样。搜索工作正常，但不显示附件按钮，并且不会触发 prepareForSegue。

无法弄清楚缺少什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T15:46:27.503

我做了这样的解决方法：

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
     if (tableView == self.searchDisplayController.searchResultsTableView) {
         [tableView deselectRowAtIndexPath:indexPath animated:YES];
         [self performSegueWithIdentifier:@"ShowComment" sender:self];
     }
} 
```

我仍然不明白为什么 prepareForSeque 不会为 searchDisplay tableview 触发。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-13T01:45:19.963

我也花了一些时间浏览这个。我遇到了完全相同的问题，我没有为这个特定的构建使用故事板，因为我以编程方式将搜索添加到导航栏。这一切都归结为一件简单的事情，添加以下内容：

[searchDisplayController setSearchResultsDelegate:self]

一旦我这样做了，didSelectRowAtIndexPath 最终会因为从我的 searchResults tableView 中选择一个结果而被触发！

# apache - 如何将一个目录中的所有文件重定向到另一个目录？

> ID：10183022
> 
> 赞同：2
> 
> 时间：2012-04-16T23:20:19.147
> 
> 标签：apache, .htaccess

我已将服务器上的文件移动到新目录，并希望 301 将所有请求重定向到新目录中的文件。

说我有：

*   domain.com/test/apples.php
*   domain.com/test/oranges.php
*   domain.com/test/bananas.php

我如何将它们重定向到：

*   domain.com/apples.php
*   domain.com/oranges.php
*   domain.com/bananas.php

无需单独重定向每个？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-16T23:29:33.837

假设您正在使用带有 mod_rewrite 的服务器，在您的根目录中创建一个名为“.htaccess”的文件并插入以下内容：

```
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteRule ^test/(.*) http://domain.com/$1 [R=301,L]
</IfModule> 
```

请注意，这会将测试目录中的每个文件重写到您插入的域。

如果您只想重定向 .php 文件，请使用：

```
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteRule ^test/(.*).php http://domain.com/$1.php [R=301,L]
</IfModule> 
```

**注意：** 不要忘记将 domain.com 更改为您的域名，这种类型的重定向也会进行[301 重定向](http://support.google.com/webmasters/bin/answer.py?hl=en&answer=93633)，这对于永久重定向文件的 url 很有用（**这将有助于搜索引擎更新您的链接**）。

# c# - 用 lambdas c# 替换嵌套的 foreachs

> ID：10183023
> 
> 赞同：1
> 
> 时间：2012-04-16T23:20:26.283
> 
> 标签：c#, lambda, foreach

是否可以用 lambdas 而不是 foreachs 来表达以下代码块？

```
 IEnumerable<BODSurveys.SurveysAnwer> resp = new List<SurveysAnwer>();
    foreach (var section in Sections)
    {
      foreach (var question in section.Questions)
      {
        foreach (var answer in question.SurveysAnwers)
        {
          yield return answer;
        }
      }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T23:25:20.033

是的：

```
return Sections.SelectMany(s => s.Questions.SelectMany(q => q.SurveyAnswers)); 
```

# c# - 根据特定内容将大txt文件拆分为小文件

> ID：10183027
> 
> 赞同：1
> 
> 时间：2012-04-16T23:20:44.507
> 
> 标签：c#, save, streamreader, delimiter, split

我有一个大的基因组序列，我需要将它拆分成小的 .txt 文件。

序列看起来像这样

```
>supercont1.1 of Geomyces destructans 20631-21
AGATTTTCTTAATAACTTGTTCAATGTGTGTTCAAATGATATGCCGTGATGTATGTAGCA
TAAACAGATGTAGTAGAAGAGTTTGCAGCAATCGTTGAGTAGTATTGCTTCTGTTGTTGG
>supercont1.2 of Geomyces destructans 20631-21
AGATTTTCTTAATAACTTGTTCAATGTGTGTTCAAATGATATGCCGTGATGTATGTAGCA
TAAACAGATGTAGTAGAAGAGTTTGCAGCAATCGTTGAGTAGTATTGCTTCTGTTGTTGG
TAAACAGATGTAGTAGAAGAGTTTGCAGCAATCGTTGAGTAGTATTGCTTCTGTTGTTGG
>supercont1.3 of Geomyces destructans 20631-21
AGATTTT (...) 
```

并且应该将其拆分为具有以下名称的小文件：“1.1-Geomyces-destructans--20631-21”、“1.2-Geomyces...”，并包含基因组数据。

@JimMischel 帮助后的代码如下所示：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.IO;

namespace genom1
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        string filter = "Textové soubory|*.txt|Soubory FASTA|*.fasta|Všechny soubory|*.*";

        private void doit_Click(object sender, EventArgs e)
        {
            bar.Value = 0;

            OpenFileDialog opf = new OpenFileDialog();

            // filter for choosing file types
            opf.Filter = filter;

            string lineo = "error"; // test

            if (opf.ShowDialog() == DialogResult.OK)
            {
                var lineCount = 0;
                using (var reader = File.OpenText(opf.FileName))
                {
                    while (reader.ReadLine() != null)
                    {
                        lineCount++;
                    }
                }

                bar.Maximum = lineCount;
                bar.Step = 1;

                FolderBrowserDialog fbd = new FolderBrowserDialog();

                fbd.Description = "Vyber složku, do které chceš rozdělit načtený soubor: \n\n" + opf.FileName; // dialog desc
                if (fbd.ShowDialog() == DialogResult.OK)
                {
                    List<string> lines = new List<string>();
                    foreach (var line in File.ReadLines(opf.FileName))
                    {
                        bar.PerformStep();

                        if (line[0] == '>')
                        {
                           if (lines.Count >= 0)
                            {
                                // write contents of lines list to file

                                //quicker replace for better file name
                                StringBuilder prep = new StringBuilder(line);
                                prep.Replace(">supercont", "");
                                prep.Replace("of", "");
                                prep.Replace(" ", "-");
                                lineo = prep.ToString();

                                // append or writeall? how to writeall lines without append?
                                //System.IO.File.WriteAllText(fbd.SelectedPath + "\\" + lineo + ".txt", lineo);
                                StreamWriter SW;
                                SW = File.AppendText(fbd.SelectedPath + "\\" + lineo + ".txt");

                                foreach (string s in lines)
                                    {
                                        SW.WriteLine(s);
                                    }

                                SW.Close();

                                // and clear the list.
                                lines.Clear();
                            }
                        }
                        lines.Add(line);
                    }
                    // here, do the last part
                    if (lines.Count >= 0)
                    {
                        // write contents of lines list to file.

                        /* starts being little buggy here...

                        StreamWriter SW;
                        SW = File.AppendText(fbd.SelectedPath + "\\" + lineo + ".txt");
                        foreach (string s in lines)
                        {
                            SW.WriteLine(s);
                        }
                        SW.Close();

                        */
                    }
                }

            }
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T23:44:35.127

如果文件足够大以适合内存，则可以调用`File.ReadAllText`将其转换为字符串。然后你遍历并提取字符之间的文本`>`。就像是：

```
string s = File.ReadAllText("filename");
int pos = s.IndexOf('>');
while (pos != -1)
{
    int newpos = s.IndexOf('>', pos+1);
    string text = s.Substring(pos+1, newpos - pos);
    // now write text to a file

    // update current position
    pos = newpos;
}
// here you'll have to handle the last part of the file specially. 
```

我假设您可以弄清楚如何正确命名文件。

如果您无法将整个文件放入内存，那么您可以逐个字符地读取文件或进行某种缓冲。如果你知道`>`总是在一行的开头，问题就更容易了。然后你可以写：

```
List<string> lines = new List<string>();
foreach (var line in File.ReadLines("filename"))
{
    if (line[0] == '>')
    {
        if (lines.Count > 0)
        {
            // write contents of lines list to file.
            // and clear the list.
            lines.Clear();
        }
    }
    lines.Add(line);
}
// here, do the last part
if (lines.Count > 0)
{
    // write contents of lines list to file.
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T23:44:23.847

我想说最简单的方法是首先使用[File.ReadAllText()](http://msdn.microsoft.com/en-us/library/system.io.file.readalltext.aspx)读取整个文件。然后只需使用[String.Split(">")](http://msdn.microsoft.com/en-us/library/b873y76a.aspx)它将返回一个我认为是您的新文件内容的数组。

# ruby - Ruby中的正则表达式双字符入口

> ID：10183031
> 
> 赞同：-3
> 
> 时间：2012-04-16T23:20:51.787
> 
> 标签：ruby, regex

`.`我需要在字符串输入中不允许超过一个句点 ( )。使用 Ruby 正则表达式的最佳方法是什么？

回复评论：

我想在电子邮件注册期间限制在电子邮件地址中仅输入一个句点。我有用于电子邮件输入的基本电子邮件正则表达式。我想知道，如果可以`.`通过正则表达式本身限制 () 的数量，或者我应该使用 Ruby 库。

是的，这是一个新手问题。

正则表达式就是这样

```
/\A([^@\s]+)@((?:[-a-z0-9]+\.)+[a-z]{2,})\Z/i 
```

如何在它的任何部分中只允许一个句点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T00:01:20.083

假设您的意思是 @ 之前的部分中最多一个句点，理论上可以使用以下正则表达式执行此操作（它不允许将点作为第一个或最后一个字符，并且不进行任何其他验证）：

```
^[^.]+(\.[^.]+)?$ 
```

上面的正则表达式只处理@之前的部分，你必须自己添加正则表达式的其余部分。它基本上匹配一组 1 个或多个非句点字符，后跟一个可选的句点组，然后是 1 个或多个非句点字符。

但是我很好奇为什么您希望将注册限制在其电子邮件地址中最多一个句点的用户...这似乎不是一个明智的限制，因为用户合法拥有超过 1 个句点是非常现实的期间在他们的地址。

# php - php：失败的电子邮件（“错误的标题和消息内容”）

> ID：10183032
> 
> 赞同：-3
> 
> 时间：2012-04-16T23:21:00.557
> 
> 标签：php, email, sendmail, email-headers

我需要知道为什么我的电子邮件没有在收件箱中发送并且无法附加文件

这是我的标题和消息

**标头**

```
MIME-Version: 1.0; \r\nContent-Type: multipart/mixed; boundary="PHP-mixed-MIME_BOUNDARY_MESSAGE_PARTS";Return-Path:mx@mozhl.com;\r\nOrganization: Shbkat.com;\r\n\r\n From: mx@shbkat.com; \r\nBcc : samarlover.php@gmail.com \r\n 
```

**信息**

```
\n --PHP-mixed-MIME_BOUNDARY_MESSAGE_PARTS \r\n Content-Type:text/html;\r\n Content-Transfer-Encoding: 7bit \n\n I Love Egypt\r\n\r\n --PHP-mixed-MIME_BOUNDARY_MESSAGE_PARTS \r\n Content-Type: application/octet-stream; name="file.txt" ; \r\n Content-Description: file.txt; \r\n Content-Disposition: attachment;filename=file.txt; size=38; \r\n Content-Transfer-Encoding: base64 \n\ndGhpcyBpcyBhdHRhY2hlZCBmaWxlIGluIG1haWwgZnVuY3Rpb24= 
```

问题是什么以及如何解决

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T23:33:08.503

```
MIME-Version: 1.0; \r\n
Content-Type: multipart/mixed;boundary="PHP-mixed-MIME_BOUNDARY_MESSAGE_PARTS";\r\n
Return-Path:mx@mozhl.com;\r\n
Organization: Shbkat.com;\r\n 
From: mx@shbkat.com; \r\n
Bcc: samarlover.php@gmail.com \r\n

\n --PHP-mixed-MIME_BOUNDARY_MESSAGE_PARTS \r\n 
Content-Type:text/html;\r\n 
Content-Transfer-Encoding: 7bit \n\n I Love Egypt\r\n\r\n --PHP-mixed-MIME_BOUNDARY_MESSAGE_PARTS \r\n 
Content-Type: application/octet-stream; name="file.txt"; \r\n 
Content-Description: file.txt; \r\n 
Content-Disposition: attachment;filename=file.txt; size=38; \r\n 
Content-Transfer-Encoding: base64 \n\ndGhpcyBpcyBhdHRhY2hlZCBmaWxlIGluIG1haWwgZnVuY3Rpb24= 
```

# flash - 希望我的学生观看链接到外部 html 进行测试的电影

> ID：10183037
> 
> 赞同：1
> 
> 时间：2012-04-16T23:21:38.153
> 
> 标签：flash

我是 Flash 新手，所以请多多包涵。我希望我的学生观看 Flash 电影，并且在电影结尾处会出现一个链接，将他们引导至外部 html 页面以进行测试。如何对电影进行编码以使链接出现在末尾。如果是AS，必要的代码是什么？电影太大而无法在时间轴中显示。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T03:40:49.680

应该做的`VideoEvent.COMPLETE`伎俩

像这样的东西......

```
import fl.video.*;

// Video component instance name
var flvControl:FLVPlayback = display;
var flvSource:String = "Call_to_Action.flv";

// Loop the video when it completes
function completeHandler(event:VideoEvent):void
{
   // DISPLAY LINK HERE, LIKELY USING addChild
}
flvControl.addEventListener(VideoEvent.COMPLETE, completeHandler);

// Set video
flvControl.source = flvSource; 
```

取自[http://www.adobe.com/devnet/flash/articles/flvplayback_programming.html](http://www.adobe.com/devnet/flash/articles/flvplayback_programming.html)

# java - 数据库中的 Lucene 索引

> ID：10183038
> 
> 赞同：2
> 
> 时间：2012-04-16T23:21:38.967
> 
> 标签：java, database, oracle, lucene

是否有可能做到这一点？我有一个 oracle 数据库，想知道在内部存储索引是否是最有效的方式，而不是在文件系统上存储索引。有没有人这样做过？lucene 3.x版可以吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T02:04:44.750

可以使用 Lucene Directory 界面，但这并不容易。很多人都尝试过，但你得到的表现很糟糕。原因是要执行搜索，您必须从数据库中读取整个索引（或段）作为 blob 并在其上运行搜索。非常低效。

# authentication - OAuth 和基本身份验证一起使用

> ID：10183040
> 
> 赞同：4
> 
> 时间：2012-04-16T23:22:07.623
> 
> 标签：authentication, oauth, oauth-2.0, basic-authentication

我有一个使用 OAuth 的 Web 应用程序，并且还想添加基本身份验证来查看页面。我已经修改了我的 .htaccess 文件，添加了一个 .htpasswd 文件，并让基本身份验证工作正常。但现在它破坏了我的应用程序的 OAuth ......我收到以下错误：

> 发现不以“令牌”开头的身份验证标头

我正在使用 Tim Ridgely 的 oauth 库，可在此处找到：[http ://code.google.com/p/oauth2-php/](http://code.google.com/p/oauth2-php/)

有没有一种简单的方法可以让这两个身份验证模型一起工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T15:02:07.493

问题是您只有一个 Authorization HTTP 标头，并且 Basic 和 OAuth 持有者令牌机制都使用它。

一般来说，允许这样的多个授权机制最好通过引入一个单独的授权组件来完成。例如，假设您在接受基本身份验证的应用程序旁边托管了一个单独的端点，然后生成了一个 OAuth 令牌供您的应用程序使用。现在您的应用程序只需查找 OAuth 令牌。

# html - 如何阻止 Django 在链接之前添加路径？

> ID：10183044
> 
> 赞同：0
> 
> 时间：2012-04-16T23:22:41.850
> 
> 标签：html, django, templates, views, hyperlink

Django 坚持在我放入页面上的 a> 标记的链接之前添加当前路径：示例：

```
 <h6><a href="{{ officialUrl }}">Read More</a></h6> 
```

现在假设 officialUrl 是“www.google.com” - Django 将改为链接到“http://www.mysite.com/this/page/www.google.com”

知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-16T23:24:59.147

Django 没有这样做，浏览器这样做是因为您没有指定协议。标签内的正确链接通常以其他协议或其他协议`<a>`开头。简单地说不是一个正确的链接。`http://``XXX://``www.google.com`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T23:29:59.573

`www.google.com`不是网址。

`http://www.google.com/`是。

由于前者不是 URL，因此您的浏览器（注意，您的浏览器，而不是 Django - 查看 HTML 输出以确认这一点）将假定它与当前页面相关。

# c# - 带有单个客户端的 Asp.net mvc。值得？

> ID：10183048
> 
> 赞同：0
> 
> 时间：2012-04-16T23:23:33.180
> 
> 标签：c#, asp.net, asp.net-mvc

我正在为我的下一个项目寻找对 asp.net mvc 的见解。Mvc 看起来确实不错，但我仍然对先入为主有一些保留意见。

该应用程序将包含一些数据输入，然后用户从数据中生成报告。我的目标是使应用程序具有高度交互性（动态图表、自动完成、验证、服务器通知更新等），但我遇到了问题。

目前，我正在构建一个 Webforms 应用程序，但在回发后显示通知时继续遇到“视图状态已损坏”。我了解页面已更改并且在显示模式时不再有效......但必须有更好的方法来创建客户端交互。

这导致我研究asp.net mvc。到目前为止，我发现的一切似乎都很棒（测试能力、关注点分离、支持松散（r）耦合视图），但与使用 webforms 相比，使用 mvc 启动和运行似乎要多做很多工作......这种情况？？？

PS。我将只有一个客户端（台式机/笔记本电脑而不是移动设备）并且想知道这有多重要。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T00:44:13.260

这取决于您的付款方式以及时间表。如果您已经开始并且已经完成了足够多的应用程序，那么切换的工作将增加超过 10% 的时间线，我会说继续原样并弄清楚如何解决您在视图状态方面遇到的问题。如果这是一个较小的项目，较大的延迟可能更容易接受。真是任性。鉴于您是 MVC 的新手，因此会有一个学习曲线，因此几乎可以肯定，在 MVC 中执行此操作要比在 Web 表单中付出更多的努力。

既然我已经在 asp.net-MVC 中完成了一个重要的项目，我将永远不会在 webforms 中开始一个新项目。所以尽快学习MVC绝对是值得的。如果您可以在不被解雇或损害客户/业务的情况下为这个项目切换而侥幸，那么您可能想要去做。如果这次没有，那就下一次，或者做一些事情来掌握它。

# java - 使用 Ormlite 在 Android 项目中实现 OnClickListener

> ID：10183052
> 
> 赞同：1
> 
> 时间：2012-04-16T23:23:58.743
> 
> 标签：java, android, ormlite, onclicklistener

我正在使用 Ormlite 来实现持久层，并且由于我的应用程序包含可以在代码的多个部分中重用的按钮，我想创建一个实现`View.OnClickListener`和扩展的类，我的数据库操作助手`OrmLiteBaseActivity<DataBaseHelper>`在哪里。`DataBaseHelper`但是当我这样做并尝试让一个 Dao`onClick()`在我的类的方法中持久化一个对象时`Button`，我得到一个`IllegalArgumentException`，说它`onCreate()`从未被调用过。我这样做如下：

```
saveButton = (Button) findViewById(R.id.SaveProfileButton);
saveButton.setTag(profile);
saveButton.setOnClickListener(new SaveButton()); 
```

然后，在`SaveButton`课堂上：

```
Dao<Profile, Long> profileDao = null;
Profile profileToSave = null;

try {
    profileDao = getHelper().getProfileDao();
} catch (SQLException e1) {
    // TODO Auto-generated catch block
    e1.printStackTrace();   
} 
```

评估时发生错误`getHelper`。有任何想法吗？提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T01:42:43.267

你不能像这样实例化一个 Activity() 类，你只能使用系统已经启动的活动，否则它们的 Context 将无法正确设置。

在您设置 onClickListener 的 Activity 中，您应该传入 (this) 并在那里处理点击事件，或者您可以尝试：

编辑：

```
saveButton = (Button) findViewById(R.id.SaveProfileButton);
saveButton.setTag(profile);
saveButton.setOnClickListener(new SaveButtonListener(this)); 
```

SaveButtonListener.java：

```
public class SaveButtonListener extends OnClickListener() { 

    private Activity context;

    public SaveButton(Activity c) {
        this.context = c;
    }

    @Override
    public void onClick(...) {
        ... your logic ...
        context.doSomething();
        context.findViewById(R.id.something);
    }
} 
```

# macos - 文件是为不受支持的文件格式构建的，该文件格式不是被链接的体系结构 (x86_64)

> ID：10183053
> 
> 赞同：8
> 
> 时间：2012-04-16T23:23:59.560
> 
> 标签：macos, gcc, makefile, gnu-make

我在 OSX Lion 上有一个构建文件

```
VPATH = src include
CFLAGS ="-I include -std=gnu99"

hello: hello.o
    gcc $^ -o $@

hello.o: hello.h hello.c
    gcc $(CFLAGS) -c $< -o $@ 
```

但是当我尝试运行这个make文件时，我得到了以下错误

```
 ld: warning: ignoring file hello.o, file was built for unsupported file format which is not the architecture being linked (x86_64)
Undefined symbols for architecture x86_64:
  "_main", referenced from:
      start in crt1.10.6.o
ld: symbol(s) not found for architecture x86_64
collect2: ld returned 1 exit status 
```

我尝试使用该标志`-arch x86_64`，但仍然出现相同的错误。

运行`arch`命令给出：`i386`.

`uname -a`告诉我：`Darwin Kernel Version 11.3.0: Thu Jan 12 18:47:41 PST 2012; root:xnu-1699.24.23~1/RELEASE_X86_64 x86_64`

我还尝试`-march=x86-64`按照此答案[文件中所述添加开关，该文件是为 i386 构建的，它不是在 Mac OSX 10.6 上为 iOS 4.2 编译 OpenCV2.2 时链接的体系结构（x86_64），](https://stackoverflow.com/questions/5220435/file-was-built-for-i386-which-is-not-the-architecture-being-linked-x86-64-whil)但这对我不起作用。

命令行的输出是：

```
gcc -I include -std=gnu99 -m64  -c include/hello.h -o hello.o  
gcc -I include -std=gnu99 -m64  hello.o -o hello
ld: warning: ignoring file hello.o, file was built for unsupported file format which is not the architecture being linked (x86_64)
Undefined symbols for architecture x86_64:
  "_main", referenced from:
      start in crt1.10.6.o
ld: symbol(s) not found for architecture x86_64
collect2: ld returned 1 exit status
make: *** [hello] Error 1 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T01:35:10.950

1.  删除所有目标文件。
2.  修改 makefile 更像：

    ```
    VPATH   = src include
    CFLAGS  = -I include -std=gnu99 -m64
    CC      = gcc
    LDLIBS  =
    LDFLAGS =

    hello: hello.o
        $(CC) $(CFLAGS) $^ -o $@

    hello.o: hello.c hello.h
        $(CC) $(CFLAGS) -c $< -o $@ $(LDFLAGS) $(LDLIBS) 
    ```

请注意，我已将命令行上的所有内容都进行了宏化。CFLAGS 用于所有编译。它们没有用双引号括起来。该`-m64`选项请求 64 位构建；它不应该是必要的，但它使它明确。您还不需要 LDFLAGS 或 LDLIBS 宏（因此您可以省略它们而不会给您自己造成问题），但它们显示了当您在链接时确实需要一些库时您可以如何进行。

对于我自己的 makefile，我会执行以下操作：

```
IFLAGS = -Iinclude
WFLAG1 = -Wall
WFLAG2 = -Werror
WFLAG3 = -Wextra
WFLAGS = $(WFLAG1) $(WFLAG2) $(WFLAG3)
OFLAGS = -g -O3
SFLAG1 = -std=c99
SFLAG2 = -m64
SFLAGS = $(SFLAG1) $(SFLAG2)
DFLAGS = # -Doptions
UFLAGS = # Set on make command line only
CFLAGS = $(SFLAGS) $(DFLAGS) $(IFLAGS) $(OFLAGS) $(WFLAGS) $(UFLAGS) 
```

这样我就可以在命令行上调整 C 编译器的任何单个参数。例如，要进行 32 位构建，我可以运行：

```
make SFLAG2=-m32 
```

等等。缺点是我永远记不起哪个*xFLAGn*选项会影响哪个。但是，快速查看 makefile 可以纠正这一点，我可以更改编译而不修改 makefile。

（我也经常`CC="gcc -m64"`在其他人的软件上强制进行 64 位编译。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-17T12:33:56.387

当我不小心在存档中包含一个 .h 文件时，我遇到了这个问题......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-06T15:01:57.527

就我而言， -M 选项造成了这个问题。我将此选项添加到项目依赖项中，但不知何故它导致了问题。

# c# - 从 C# 自动打开 SSMS

> ID：10183054
> 
> 赞同：2
> 
> 时间：2012-04-16T23:24:00.540
> 
> 标签：c#, sql, wpf, ssms

我有一个带有列表框的 WPF 应用程序，列表框包含项目，这些项目是服务器的连接字符串，如下所示

instance1\server1 instance2\server2 所以我有下面的代码这只是一个示例

```
private void ListBox1_SelectionChanged(object sender, SelectionChangedEventArgs e)
        {
            string sli=ListBox1.SelectedValue.ToString();

            MessageBox.Show(sli);
        } 
```

因此，我不想显示消息框，而是使用提供的用户名和密码打开与 SSMS 的连接，如果 ssms 已经打开，我不想打开另一个 SSMS，如果一个已经打开，则打开其中的连接..如何实现这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T23:59:34.880

您可以使用一组命令行参数来启动应用程序。我不认为你可以操纵现有的实例......也许可以通过powershell。

SSMS 有许多命令行选项，可让您指定许多内容。这些可以通过执行 /? 命令。这是该命令的结果。

* * *

## Microsoft SQL Server 管理工作室

```
Usage:
sqlwb.exe [-S server_name[\instance_name]] [-d database] [-U user] [-P password] [-E] [file_name[, file_name]] [/?]

 [-S The name of the SQL Server instance to which to connect]
 [-d The name of the SQL Server database to which to connect]
 [-E] Use Windows Authentication to login to SQL Server
 [-U The name of the SQL Server login with which to connect]
 [-P The password associated with the login]
 [file_name[, file_name]] names of files to load
 [-nosplash] Supress splash screen
 [/?] Displays this usage information
---------------------------
OK   
---- 
```

* * *

# asp.net - 没有默认扩展程序 ID 时如何隐藏面板

> ID：10183055
> 
> 赞同：0
> 
> 时间：2012-04-16T23:24:09.650
> 
> 标签：asp.net, ajaxcontroltoolkit

我正在使用.NET AjaxControlToolkit（不要问为什么，我继承了这个项目）。我创建面板，然后使用按钮，按如下方式弹出面板：

```
<asp:LinkButton ID="lbReplaceImage" runat="server"><img src="/images/pencil.gif" alt="edit image" /></asp:LinkButton>
<cc1:ModalPopupExtender ID="mpeReplaceImages" runat="server" TargetControlID="lbReplaceImage" BackgroundCssClass="modalBackground" 
                            PopupControlID="pnlReplaceImage" CancelControlID="btnReplaceImageCancel" OkControlID="btnReplaceImageOK">
</cc1:ModalPopupExtender> 
```

进而：

```
<asp:Panel ID="pnlReplaceImage" runat="server" BackColor="White" CssClass="container">
 .
 .
 .
</asp:Panel> 
```

我的问题是第一次进入系统，表格中没有数据，所以面板没有被系统隐藏。我尝试使用 CSS 来隐藏面板，但它永远不会重新打开。即使页面上没有模式弹出控件，是否有一些操作员可以使面板保持隐藏状态？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-17T04:43:06.487

你用什么 CSS 来隐藏面板？可见性：隐藏？

你有没有尝试过：

```
style="display:none" 
```

我以前遇到过这个问题，这对我有用。

**编辑**：如下所述，为了使上面的行起作用，它必须作为内联 CSS 放置：

```
<asp:Panel ID="pnlReplaceImage" runat="server" CssClass="container" style="display:none">
 .
 .
 .
</asp:Panel> 
```

# json - AVRO 验证

> ID：10183056
> 
> 赞同：8
> 
> 时间：2012-04-16T23:24:13.493
> 
> 标签：json, encoding, validation, avro

我对 AVRO 相当陌生，所以如果我遗漏了任何明显的东西，请原谅。是否有根据 AVRO 模式验证输入的 AVRO 验证器/命令行实用程序？或者可能指向错误在 json 输入中的位置。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-18T15:02:06.817

不是我知道的。我写了这个小 Python 脚本，它会告诉你一个 json 文件是否匹配一个模式，但它不会告诉你错误*在哪里*，如果有的话。

这取决于[Python avro 库](http://pypi.python.org/pypi/avro)。

```
#!/usr/bin/env python

from avro.io import validate
from avro.schema import parse
from json import loads
from sys import argv

def main(argv):
    valid = set()
    invalid_avro = set()
    invalid_json = set()

    if len(argv) < 3:
        print "Give me an avro schema file and a whitespace-separated list of json files to validate against it."
    else:
        schema = parse(open(argv[1]).read())
        for arg in argv[2:]:
            try:
                json = loads(open(arg, 'r').read())
                if validate(schema, json):
                    valid.add(arg)
                else:
                    invalid_avro.add(arg)
            except ValueError:
                invalid_json.add(arg)
    print ' Valid files:\n\t' + '\n\t'.join(valid)
    print 'Invalid avro:\n\t' + '\n\t'.join(invalid_avro)
    print 'Invalid json:\n\t' + '\n\t'.join(invalid_json)

if '__main__' == __name__:
    main(argv) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T05:35:50.220

我不确定您的问题是否有意义：由于在处理 Avro 数据时 Avro Schema 是强制性的，因此默认情况下它总是基本得到验证。换句话说，解析 Avro 的行为必然会验证它。

不幸的是，鉴于 Avro 数据中的元数据非常少，所有不兼容的更改本质上都是数据损坏；你很可能会得到垃圾。这是因为没有字段 ID 或分隔符：所有数据都根据 Schema 所说的必须遵循的内容进行解释。这种冗余的缺乏使数据非常紧凑，但也意味着即使是最小的数据损坏也可能使整个数据流无用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-07T19:17:56.110

我为 JavaScript 制作了一个 Avro 验证器，可以在 JSON 上运行。它还不是 Avro 版本的一部分，但应该很快就会提交。[您可以在https://issues.apache.org/jira/browse/AVRO-485](https://issues.apache.org/jira/browse/AVRO-485)找到补丁。

# vb.net - 直到用逗号分隔值填充字符串

> ID：10183057
> 
> 赞同：-1
> 
> 时间：2012-04-16T23:24:18.740
> 
> 标签：vb.net, arrays, populate

嘿，我正在尝试像这样填充数组：

```
Dim tmpArray As String = ""

Do Until x = Form1.arrayCal.Length
    tmpArray = tmpArray & "," & x
    x += 1
Loop

tmpArray = Replace(tmpArray, ",1", "1")

Dim arrDaysInMonth As String() = {tmpArray} 
```

Dim arrNumOfVisits As Double() = {10, 20, 30, 40, 50, 52, 20, 20, 10, 35, 3, 8, 47, 7, 2, 5, 55, 8, 0, 0, 6, 55, 0, 2, 12, 0, 0, 21, 14, 0, 3}

```
 Me.ChartControl1.Series.Clear()
    Dim s As New DataDynamics.ActiveReports.Chart.Series()

    s.Type = DataDynamics.ActiveReports.Chart.ChartType.Bar2D
    s.Points.DataBindXY(arrDaysInMonth, arrNumOfVisits) 
```

但是，我似乎不能那样做..这样做似乎只将​​它放在一维数组中，而不是 {1,2,3,4,5...} 类型的数组，因为它需要将在。

任何帮助都会很棒！

大卫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T00:00:51.007

我认为您想要的可以通过以下方式完成：

```
 Dim daysCount As Integer = 31
    Dim arrDaysInMonth As String() = New String(daysCount - 1) {}

    For index As Integer = 0 To arrDaysInMonth.Length - 1
        arrDaysInMonth(index) = (index + 1).ToString()
    Next

    ' arrDaysInMonth(0) = "1"
    ' arrDaysInMonth(1) = "2"
    ' ... 
```

或者，也许你想要这个：

```
 Dim arrayCal As String = "1,2,3,4,5,6"
    Dim tmpArray As String() = arrayCal.Split(","c)

    ' tmpArray(0) = "1"
    ' tmpArray(1) = "2"
    ' ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T23:36:41.873

如果要动态创建数组，我建议不要使用数组，应该使用集合，因为它们更快并且节省资源：

```
Dim array As New System.Collections.ArrayList

Do Until x = Form1.arrayCal.Length
   array.Add(x)
   x += 1
Loop 
```

您还可以通过索引访问 ArrayList 的元素。

顺便说一句：您的版本不工作，因为您需要编译和运行它正在工作的代码。

这个

```
Dim arrDaysInMonth() As String = {"1,2,3"} 
```

不像这样

```
Dim arrDaysInMonth() As String = {"1","2","3"} 
```

# arrays - 数组中的 as3 影片剪辑动态名称为空

> ID：10183060
> 
> 赞同：1
> 
> 时间：2012-04-16T23:24:34.857
> 
> 标签：arrays, actionscript-3, flash

**我正在使用下面的代码，当我“跟踪（TheVar）；” 它是空的。有谁知道为什么？**

```
var TheVar:MovieClip; 
var myArray:Array = ["TheContent", "TheContent2"];

function RandomM()
{
    trace(myArray.length);
    var r = Math.round(Math.random() * myArray.length);
    trace(myArray[r]);
    var TheVar:MovieClip =  myArray[r] as MovieClip;
    trace(TheVar);
}

RandomM(); 
```

## 更新：

我正在输入完整的代码来展示我正在尝试做的事情

```
this.stage.scaleMode = StageScaleMode.NO_SCALE;
this.stage.align = StageAlign.TOP_LEFT;

var TheContent:Loader = new Loader();
var TheContent2:Loader = new Loader();

function Load1()
{
    TheContent.load(new URLRequest("1.png"));
    TheContent.contentLoaderInfo.addEventListener(Event.COMPLETE, LoadContent);

    function LoadContent(e:Event)
    {
        addChild(TheContent);
        TheContent.width = ScreenX;
        TheContent.height = ScreenY;
        Load2()
    }
}

function Load2()
{
    TheContent2.load(new URLRequest("2.png"));
    TheContent2.contentLoaderInfo.addEventListener(Event.COMPLETE, LoadContent);

    function LoadContent(e:Event)
    {
        trace("Jesus");
        addChild(TheContent2);
        TheContent2.width = ScreenX;
        TheContent2.height = ScreenY;
        RandomM();
    }
} 
```

在函数中`RandomM()`，我想将加载器“TheVar”更改为这些数组之一，其中也是加载器。我想最终创建一个补间，它将根据用户的滑动在加载器之间发生变化。

```
var TheVar:MovieClip; 
var myArray:Array = [TheContent, "TheContent2"];

function RandomM()
{
    trace(myArray.length);
    var r = Math.round(Math.random() * myArray.length);
    trace(myArray[r]);
    var Base:Class = getDefinitionByName(myArray[r]) as Class;
    var TheVar:MovieClip = new Base();
}

Load1();

Multitouch.inputMode = MultitouchInputMode.GESTURE;

stage.addEventListener(TransformGestureEvent.GESTURE_SWIPE, fl_SwipeHandler);

function fl_SwipeHandler(event:TransformGestureEvent):void
{
    switch(event.offsetX)
    {
        // swiped right
        case 1:
        {
            // Start your custom code
            // This example code moves the selected object 200 pixels to the right.
            TheVar.x += 200;
            // End your custom code

            break;
        }
        // swiped left
        case -1:
        {
            // Start your custom code
            // This example code moves the selected object 200 pixels to the left.
            TheVar.x -= 200;
            // End your custom code

            break;
        }
    }

    switch(event.offsetY)
    {
        // swiped down
        case 1:
        {
            // Start your custom code
            // This example code moves the selected object 200 pixels down.
            TheVar.y += 200;
            // End your custom code
            break;
        }
        // swiped up
        case -1:
        {
            // Start your custom code
            // This example code moves the selected object 200 pixels up.
            TheVar.y -= 200;
            // End your custom code
            break;
        }
    }
} 
```

## 添加更新以澄清：

我有一个名为 TheContent 的 LOADER：这是代码：

```
var TheContent:Loader = new Loader(); 
```

我想创建几个具有图像和 SWF 内容的“加载器”。然后我想使用 ONE TWEEN 将它们移出屏幕，但通过动态补间，因此它将根据我在该 TWEEN 中制作 MovieClip 的 VAR 移动不同的 LOADERS。要做到这一点，我需要为 TWEEN 制作电影...... 多变的。我认为最好的方法是创建一个包含 LOADERS 的所有名称的数组，然后随机调用它们并在 TWEEN 中移动内容。因此我做了一个数组：

```
var myArray:Array = ["TheContent", "TheContent2"]; 
```

但我根本无法从函数 RandomM(); 中获取随机变量。所以我可以稍后在 TWEEN 中使用它。该加载程序称为“TheVar”；

```
function RandomM()
{

trace(myArray.length);
var r = Math.round(Math.random() * (myArray.length -1) );

var theMC:String = myArray[r];
TheVar=this[theMC] as MovieClip;

trace(TheVar); //// TO BE USED LATER IN A TWEEN. 
///   IT WILL BE ONE TWEEN BUT WILL ANIMATE DIFFERENT MOVIES

} 
```

我希望这是有道理的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-16T23:28:19.050

`"TheContent"`并且`"TheContent2"`是字符串，而不是 MovieClips。

如果这些是舞台上 MovieClip 的实例名称，则需要使用如下内容：

```
var myArray:Array = [this["TheContent"], this["TheContent2"]); 
```

或者更简单地说：

```
var myArray:Array = [TheContent, TheContent2]; 
```

假设您正在按照时间线工作。

* * *

如果`TheContent`并且`TheContent2`是您拥有的类，您可以使用`getDefinitionByName()`您拥有的字符串创建这些类的实例。例子：

```
var Base:Class = getDefinitionByName("TheContent") as Class;
var TheVar:MovieClip = new Base();

addChild(TheVar); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T05:33:40.233

根据您的编辑，这是一个希望能涵盖您的问题的答案。

首先就像我提到的，你的数组包含字符串而不是加载器本身。你想这样做：

```
var myArray:Array = [ TheContent, TheContent2 ]; 
```

请注意没有`"`包装每个。

要选择一个随机加载器并将其分配给`TheVar`，请执行以下操作：

```
var TheVar:Loader = Loader( myArray[int(Math.random() * myArray.length)] ); 
```

您现在可以`TheVar`按预期使用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T01:45:53.497

你的问题是这条线

```
var r = Math.round(Math.random() * myArray.length); 
```

random 会给你一个从 0 到 1 的数字

```
myArray.length //will give (in your example) 2 
```

假设 random 给你一个值 .75
.75 * 2 = 1.5
当你使用 round 函数时，它会四舍五入到最接近的整数，在这种情况下 2（1.5 和向上四舍五入）
当你有一个 2 时，它就出来了你的数组索引应该给你一个空值。
你需要做的是

```
var r = Math.round(Math.random() * (myArray.length -1) ); 
```

然后您需要访问正确的元素并获取影片剪辑的名称

```
var mcName:String = myArray[r] 
```

然后访问影片剪辑本身

```
var THEVAR:MovieClip = this[mcName];
trace(THEVAR); 
```

# oracle - PL/SQL 游标循环

> ID：10183061
> 
> 赞同：4
> 
> 时间：2012-04-16T23:24:36.013
> 
> 标签：oracle, for-loop, plsql, database-cursor

我相信我需要一个用于循环的游标来遍历表 test_data 中的 street1 列。我有一个程序需要测试表中的每一行。

这是我到目前为止所拥有的：

```
cursor c1 is
street1
from test_data

Begin
    If Instr(street1, ‘Cnr’, 1) >= 1;
    Then
        Newstreetname := Substr(street1, Instr(street1, ‘Cnr’, 1)+3);
    Else if
        Instr(street1, ‘PO Box’, 1) >= 1;
    Then
        Newstreetname:= Substr(street1, Instr(street1, ‘PO Box’, 1));
    Else if
        REGEXP_ Instr (street1, [\d], 1) = 0; 
    Then
        Newstreetname:= street1;
    Else if
        REGEXP_ Instr (street1, [\d], 1) >= 1;
    Then
        Newstreetnumber:= regexp_substr(street1, '\d+(\s|\/)(\d+)?-?(\d+)?(\w {1})?'); 
        Newstreetname:= regexp_substr(street1, '(\w+\s\w+)$'); 
End 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-17T03:56:38.847

1.  您需要在游标定义中使用 SELECT 和分号

2.  您可以在光标上添加 FOR LOOP

    例如：

    ```
     DECLARE
       cursor c1 is
         SELECT street1
         from test_data;
       r1 c1%ROWTYPE;
     BEGIN
       FOR r1 IN c1 LOOP
          ... do your stuff with r1.street1
       END LOOP;
     END; 
    ```

    或者，您可以完全避免显式游标定义，例如：

    ```
    FOR r1 IN (SELECT street1 FROM test_data) LOOP
      ... do your stuff with r1.street1
    END LOOP; 
    ```

3.  您的 IF 语句不能包含分号 - 例如：

    ```
     If
     Instr(r1.street1, 'Cnr', 1) >= 1
     Then 
    ```

4.  [编辑] 所以你想更新你的表、列`newstreetnumber`和`newstreetname`- 在这种情况下你可以做这样的事情：

    ```
     DECLARE
       cursor c1 is
         SELECT street1
         from test_data
         FOR UPDATE;
       r1 c1%ROWTYPE;
     BEGIN
       FOR r1 IN c1 LOOP
          ... do your stuff with r1.street1
          UPDATE test_data
          SET newstreetnumber = ...
             ,newstreetname = ...
          WHERE CURRENT OF c1;
       END LOOP;
     END; 
    ```

    但是请注意，这对于大容量不会很好，我更愿意在一个 UPDATE 语句中完成所有操作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T07:43:32.140

正如 Jeffrey Kemp 所说，这可以在一个更新声明中完成：

```
UPDATE test_data
   SET newstreetname = CASE WHEN Instr(street1, ‘Cnr’, 1) >= 1 
                             THEN Substr(street1, Instr(street1, ‘Cnr’, 1)+3)
                            WHEN Instr(street1, ‘PO Box’, 1) >= 1 
                             THEN Substr(street1, Instr(street1, ‘PO Box’, 1))
                            WHEN REGEXP_Instr (street1, '[\d]', 1) = 0 
                             THEN street1
                            WHEN REGEXP_Instr (street1, '[\d]', 1) >= 1 
                             THEN regexp_substr(street1, '(\w+\s\w+)$')
                       END,
       newstreetnumber = CASE WHEN .....
                       END; 
```

# mysql - MySQL 对用户的权限

> ID：10183062
> 
> 赞同：0
> 
> 时间：2012-04-16T23:24:45.750
> 
> 标签：mysql, phpmyadmin, database-permissions

我的朋友有一个VPS。他信任我，或多或少会帮助我做任何我想做的事情。我正在使用一些 MySQL 用户（特权较少）和数据库。例如，我是 my_user，我创建了 mydomain_select 和 mydomain_insert 来隔离权限（因为 PHP->MySQL 密码在文本中）。目前，我无法以我的用户身份编辑任何权限，并且每当我想更改任何权限时都必须打扰我的朋友。

有什么方法可以让我的用户权限来改变某些其他用户的权限（像'mydomain_%'这样的用户）？我可以这样设置，以便在 phpMyAdmin 中获得权限选项卡吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T05:59:08.383

您不能从 phpMyAdmin 更改您自己的用户名权限。只有管​​理员用户名可以更改您的用户名。更新您的朋友以使用管理员登录登录到 phpMyAdmin。

1.  点击权限链接。
2.  选择您的用户名。
3.  单击“检查所有”权限链接。
4.  点击前往按钮。

# ruby - Tk DSL 无法访问实例方法和变量？

> ID：10183063
> 
> 赞同：1
> 
> 时间：2012-04-16T23:24:46.090
> 
> 标签：ruby, tk

我知道这不是 tk 特有的，而是 ruby​​ DSL 和 instance_eval 的一个更普遍的问题，但这是我的问题，如果我想将 DSL 用于 tk，我不知道如何使某些事情起作用。例如，如果我想通过按下按钮来调用实例方法，这将不起作用，因为它认为我正在尝试在 Tk 父类（即 Tk::Button）中调用具有相同名称的方法，如下面的代码：

```
require 'tk'
class MyApp
  def initialize
    @root = TkRoot.new
    TkFrame.new {|f|
      TkButton.new(f) {
        text "Press Me"
        command proc {do_something()}
        pack
      }
      pack
    }
  end
  def do_something
    puts "Hello!"
  end
  def run
    Tk.mainloop
  end
end

MyApp.new.run 
```

如果我不使用 DSL 重写它，我可以避免这个问题，但出于各种原因，我更喜欢 DSL：

```
class MyApp
  def initialize
    @root = TkRoot.new
    f = TkFrame.new
    TkButton.new(f, text: "Press Me", command: proc {do_something()}).pack
    f.pack
  end
  def do_something
    puts "Hello!"
  end
  def run
    Tk.mainloop
  end
end

MyApp.new.run 
```

MyApp 类的实例变量也是如此。有什么办法解决这个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T23:44:07.783

`proc { do_something }`可能正在`TkButton`实例的上下文中进行评估。这可能就是你可以调用的方式`text`，`command`并且`pack`在块内时。

这实际上意味着`self`不再是`MyApp`实例；它已更改为`TkButton`实例。

尝试这个：

```
def initialize
  my_app = self  # self is the MyApp instance here
  @root = TkRoot.new
  TkFrame.new do |f|
    TkButton.new f do
      text "Press Me"
      command proc { my_app.do_something }
      pack
    end
    pack
  end
end 
```

由于块是闭包，因此`my_app`局部变量将可用于块。

# django - 从内联表单 clean() 访问父表单的cleaned_data

> ID：10183066
> 
> 赞同：5
> 
> 时间：2012-04-16T23:25:05.853
> 
> 标签：django, django-forms, cleaned-data

我有一个具有内联表单的主表单。是否可以从内联表单的 clean 函数访问主表单的 clean_data ？

这就是我问的原因。

主表单有一个字段来定义房产是出售还是出租。然后，内联表单显示销售价格字段或租赁金额和押金字段。我正在尝试验证如果该物业是待售的，那么租约和押金字段应该是空的。

我可以在前端界面的视图中执行此操作，但是可以在 forms.py 中为前端和管理员执行此操作吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-17T04:13:20.790

不，这些形式是独立的对象，完全不知道彼此。但是您为`data`所有表单提供相同的内容，因此您应该能够检查来自`self.data`.

# javascript - 调用 JavaScript 函数时遇到问题？

> ID：10183069
> 
> 赞同：1
> 
> 时间：2012-04-16T23:25:20.083
> 
> 标签：javascript, raphael

我正在测试 Raphael javascript 库，我会遇到一个小问题。我正在画布上绘制四个形状。然后我允许一个对象通过单击成为当前选定的对象。然后我添加一个事件处理程序来监听删除键的按下。这工作正常，但我似乎无法调用函数。下面是说明我的问题的代码。

这是一个代表画布上每个圆圈的类：

```
var Shape = new Class({
    initialize: function(x, y, color)
    {
        this.shape = paper.circle(x, y, 25);
        this.shape.attr("fill", color);

        this.shape.click(function()
        {
            if(selectedObj == null)
            {
                selectedObj = this;
                selectedObj.attr({'stroke':'orange', 'stroke-width':'5'});
            }
            else if(selectedObj != this)
            {
                selectedObj.attr({'stroke':'orange', 'stroke-width':'0'});
                selectedObj = this;
                selectedObj.attr({'stroke':'orange', 'stroke-width':'5'});
            }
            else if(selectedObj == this)
            {
                selectedObj.attr({'stroke':'orange', 'stroke-width':'0'});
                selectedObj = null;
            }
        });
    },
    deleteThis: function()
    {
        alert("Inside The deleteThis() Function.");
    }
}); 
```

这将创建一个形状，单击它时会执行以下操作：

1.  如果`selectedObj`为空，则单击的形状将设置为`selectedObj`并在形状周围绘制一个小的橙色边缘。
2.  如果`selectedObj`不是被点击的形状，它会取之前选中对象的小边框，然后将新点击的形状设置为当前选中的项目。
3.  如果形状是选定的对象，再次单击时，它会取消选择它。

然后我将四个形状推到画布上：

```
objShapes.push(new Shape(50, 50, "red"));   
objShapes.push(new Shape(250, 50, "blue")); 
objShapes.push(new Shape(50, 250, "yellow"));   
objShapes.push(new Shape(250, 250, "green")); 
```

现在我可以成功选择和取消选择画布上的对象，我需要能够调用所选对象的函数。要触发我正在使用键盘的功能。以下代码是我使用的：

```
$(document).keydown(function(event)
{
    if(event.keyCode == 46)
    {
        if(selectedObj == null)
        {
            alert("nothing to delete");
        }
        else
        {
            alert("Deleting " + selectedObj.attr('fill') + " Circle.");
            selectedObj.deleteThis();
        }
    }
}); 
```

只有部分事件处理程序起作用。当我按下删除键并且没有选择任何内容时，警报窗口告诉我没有选择删除任何内容，但是，当我选择了一个对象并按下删除键时，会出现警报并告诉我我正在删除哪个圆圈但是然后它无法调用该`deleteThis()`函数。我不明白为什么它会调用`.attr()`函数而不是`deleteThis()`函数。

无法调用函数的原因是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T23:44:00.117

问题是`selectedObj`引用内部`shape`变量，而不是类的对象。您可以使其引用对象本身（参见下面的代码；基本上将对象缓存在一个变量中，通常称为`self`or `that`，然后在闭包内将其用作您要存储的对象）。然后引用形状 do`selectedObj.shape`而不是 just `selectedObj`。混淆是由于您的类已命名`Shape` *并且*您有一个名为 的成员变量`shape`。也许考虑更改这些名称中的一个或另一个以避免这种混淆。

此外，您应该使用带有 javascript 控制台的调试器。如果是这样，您会看到一条错误消息，例如“`deleteThis`未在对象上定义”之类的内容，这将有助于您追踪这一点。

无论如何，这是具有上述更改的代码：

```
var Shape = new Class({
    initialize: function(x, y, color)
    {
        // To keep track of the object itself
        var self = this;

        this.shape = paper.circle(x, y, 25);
        this.shape.attr("fill", color);

        this.shape.click(function()
        {
            if(selectedObj == null)
            {
                selectedObj = self; // Assign the object, not the shape
                selectedObj.shape.attr({'stroke':'orange', 'stroke-width':'5'});
            }
            else if(selectedObj != self) // Compare the object, not the shape
            {
                selectedObj.shape.attr({'stroke':'orange', 'stroke-width':'0'});
                selectedObj = this; // Assign the object, not the shape
                selectedObj.shape.attr({'stroke':'orange', 'stroke-width':'5'});
            }
            else if(selectedObj == self) // Compare the object, not the shape
            {
                selectedObj.shape.attr({'stroke':'orange', 'stroke-width':'0'});
                selectedObj = null;
            }
        });
    },
    deleteThis: function()
    {
        alert("Inside The deleteThis() Function.");
    }
}); 
```

然后在另一部分进行同样的调整：

```
$(document).keydown(function(event)
{
    if(event.keyCode == 46)
    {
        if(selectedObj == null)
        {
            alert("nothing to delete");
        }
        else
        {
            alert("Deleting " + selectedObj.shape.attr('fill') + " Circle."); // Reference the shape here
            selectedObj.deleteThis(); // This is the object now
        }
    }
}); 
```

# php - 关于在 Javascript 和 PHP 之间共享验证规则的建议？

> ID：10183072
> 
> 赞同：13
> 
> 时间：2012-04-16T23:25:54.403
> 
> 标签：php, validation, shared, jquery-tools

我们正在编写一个新表单，我们的前端编码器已经包含了大量的 JavaScript 验证（技术上是 jQuery 工具验证）。

我正在编写该过程的 PHP 服务器端部分，当然，我自己的代码将对收到的数据进行自己的验证。

您不必维护两组验证规则——jQuery 和 PHP——你对创建验证规则的中央列表的方法有什么建议吗——即字段 X 的大小必须 > 1 和 < 10，等等。 - 所以我可以更改单个文件或数据库表中的验证规则，然后将其同时传递给 PHP 和 jQuery？

例如，将我上面提到的相同规则“字段 X 的大小必须 > 1 且 < 10”更改为“字段 X 的大小必须 > 3 且 < 5”，我所要做的就是编辑文件或数据库表，然后PHP 和 jQuery 都会相应地检索和解析这些数据吗？

在此先感谢您的帮助，

菲尔

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T00:06:00.860

这些方面的东西可能会很好：

```
<?php
$validation = Array(
    "field1" => Array( // "field1" is the name of the input field
        "required" => true, // or false
        "minlength" => 5, // use 0 for no minimum
        "maxlength" => 10, // use 9999 (or other high number) for no maximum
        "regex" => "^[a-zA-Z0-9]+$" // use empty string for no regex
    ),
    "field2" => .......
    ....
);
if( $_POST) {
    foreach($validation as $k=>$v) {
        if( !isset($_POST[$k])) {
            if( $v['required']) die("Field ".$k." is required");
        }
        else {
            $l = strlen($_POST[$k]);
            if( $l < $v['minlength']) die("Field ".$k." too short");
            if( $l > $v['maxlength']) die("Field ".$k." too long");
            if( !preg_match("(".$v['regex'].")",$_POST[$k])) die("Field ".$k." incorrect format");
        }
    }
    // all ok!
}
?>
<script type="text/javascript">
    (function(rules) {
        var die = function(str) {alert(str); return false;};
        document.getElementById('myForm').onsubmit = function() {
            var elms = this.elements, i, it, r, s;
            for( i in rules) {
                r = rules[i];
                it = elms.namedItem(i);
                if( typeof it == "undefined") {
                    if( r.required) return die("Field "+i+" is required");
                }
                else {
                    s = it.length;
                    if( s < r.minlength) return die("Field "+i+" too short");
                    if( s > r.maxlength) return die("Field "+i+" too short");
                    if( !s.match(new RegExp(r.regex))) return die("Field "+i+" incorrect format");
                }
            }
            return true;
        };
    })(<?=json_encode($validation)?>);
</script> 
```

正如你所看到的，一般的想法是定义一组规则，然后神奇的发生在`json_encode($validation)`- 这将规则传递到 JavaScript 环境中。您仍然必须复制验证代码以使其在 PHP 和 JS 中运行，但至少现在您可以添加更多规则，而无需在两个地方更改代码。希望这可以帮助！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-17T00:10:33.177

[Nette 框架](http://nette.org/en/)这样做：[http](http://doc.nette.org/en/forms) : //doc.nette.org/en/forms

整个表单和验证规则在 PHP 文件中定义。然后框架生成带有 javascript 验证的 HTML 代码，并在提交后执行服务器端验证。

您甚至可以单独使用框架的 Forms 部分。

# c# - C# 应用程序的最大开放端口数

> ID：10183077
> 
> 赞同：1
> 
> 时间：2012-04-16T23:26:54.157
> 
> 标签：c#, networking, port

我正在开发一个服务器应用程序，我想打开很多端口。我可以打开的最大端口数和一台 Windows 机器是多少？谢谢！

编辑：我的意思是我可以打开多少个端口进行监听（作为服务器）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T03:56:47.123

除了 tsells 的一条评论外，大多数人没有向您解释的是，您很可能对 tcp 堆栈通常如何工作有一个无效的假设（这实际上是我直到不久前才混淆的东西）。

原因是当您有一个 TcpListener （特定于 DotNet 但可能适用于大多数其他 tcp 库）时，当您开始侦听并发生传入连接时，堆栈将侦听您选择的端口（例如：端口：1234 ) 但一旦连接就会将连接移动到（通常）随机未分配的端口。

因此，例如查看以下代码。

```
 // Set the TcpListener on port 13000.
  Int32 port = 13000;
  IPAddress localAddr = IPAddress.Parse("127.0.0.1");

  // TcpListener server = new TcpListener(port);
  server = new TcpListener(localAddr, port);

  // Start listening for client requests.
  server.Start();

  // Buffer for reading data
  Byte[] bytes = new Byte[256];
  String data = null;

  // Enter the listening loop.
  while(true) 
  {
    Console.Write("Waiting for a connection... ");

    // Perform a blocking call to accept requests.
    // You could also user server.AcceptSocket() here.
    TcpClient client = server.AcceptTcpClient();            
    Console.WriteLine("Connected!");
    //Here you will find that if you look at the client LocalEndPoint a random dynamic port will be assigned.
  } 
```

这基本上意味着，除非你有一个*非常好的*理由，否则你不应该真正关心这些实现细节，并且最大开放端口基本上是无关紧要的（也祝你好运尝试编写产生 30000 个线程并正确维护这些连接的东西并且有效）。

PS：当提供端口号时，我还在 System.Net.Sockets.TcpListener 内部验证了以下代码，如果它未通过此测试，将抛出 ArgumentOutOfRangeException。这证实了“Igby Largeman”所说的，它是一个 16 位无符号整数。

```
public static bool ValidateTcpPort(int port) 
{
    if (port >= 0)
    {
        return port <= 0xffff;  //65535
    }
    return false;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T23:37:06.620

..要看。我在 W2K 上有 24000 个连接，尽管它需要一些注册表调整。我确信 Windows Server 2008 将允许接近 64K 最大值。

# ios5 - 如何影响带有部分卷页的模态视图的大小？

> ID：10183079
> 
> 赞同：3
> 
> 时间：2012-04-16T23:27:14.150
> 
> 标签：ios5, modalviewcontroller, page-curl

我需要为应用程序中的视图提供一些额外的数据，并且我想使用部分卷页来实现它，就像谷歌地图应用程序使用部分卷页进行设置一样。

我遇到的问题是呈现的视图占据了整个屏幕：

![在此处输入图像描述](../Images/0421e793e1e1d2daf0969b6ac113fda5.png)

如何调整呈现的视图的大小？理想情况下，我希望它像 Google Maps 应用程序一样占据右下角。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-17T12:40:41.937

我已经对此进行了很好的测试，看来以下陈述是正确的：

1.  UIModalTransitionStylePartialCurl 的最小卷曲约为页面的一半。
2.  没有什么（我能找到）可以阻止这个最小值。
3.  您可以通过将内容放置在您“显示”的 UIViewController 中来影响卷曲量（在半页和整页之间）。

所以，在你展示的第二张图片中，对我来说，部分卷曲上升大约一半是完全合理的。它还解释了为什么您的初始图像会以这种方式出现。

此外，如果您查看 Google 地图，他们似乎正在使用某种专有/私有 API 来获得部分卷曲。或者可能是因为他们使用的是缩小尺寸的 UIViewController。无论如何，我希望这能帮助你更接近你的目标。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T00:12:09.370

好的，所以部分属于“我的坏”类别。我以前显示的是`UITableViewController`，我认为我不想这样做。然而，我确实想要一张桌子——但它只有几行。我已经切换到使用`UIViewController`管理小表格视图的普通子类。

然而，模态视图仍然太大了：

![在此处输入图像描述](../Images/33a36f9009c8bdb291ba69dac843fd4b.png)

问题仍然存在——我可以做些什么来影响 IOS 为我生成的 curl 的大小？

# ios - 动态开启 NSLogs

> ID：10183087
> 
> 赞同：2
> 
> 时间：2012-04-16T23:27:38.383
> 
> 标签：ios, objective-c, macros, c-preprocessor, nslog

我目前正在使用以下 DebugLog 宏

```
#if defined(DEBUG) && defined(useDebugLogs)
#define DebugLog( s, ... ) NSLog( @"<%s:(%d)> %@", __PRETTY_FUNCTION__, __LINE__, [NSString stringWithFormat:(s), ##__VA_ARGS__] )
#else
#define DebugLog( s, ... ) 
#endif 
```

然而，现在通过允许远程记录的试飞，这有点过时了。

基本上我想要做的是在我的 settings.plist 中添加一个开关，以允许用户打开远程日志记录。

我遇到过本教程 [http://jomnius.blogspot.com/2011/09/how-to-do-dynamic-debug-logging-in.html](http://jomnius.blogspot.com/2011/09/how-to-do-dynamic-debug-logging-in.html)

但是，这是一个非常糟糕的解释，实际上似乎不起作用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T08:23:44.633

好吧，IMO 最好的方法是始终发送日志并调整您的实施，以便您准确地看到您想要的。您要么需要分析，要么不会使用它们。有错误，或者没有。通过它们工作并提高您的信噪比。反正……</p>

您可以为此目的创建一个专用功能。它可以根据您的实现中的某些变量有条件地记录或不记录。请注意，您可以通过调用`NSLogv`而不是转发您的 va_list `NSLog`，或者您可以使用`-[NSString initWithFormat:arguments:]`在其他地方转发消息 + 参数：

**MONDebugLog.h**

```
extern void MONDebugLog(NSString * format, ... ) NS_FORMAT_FUNCTION(1,2); 
```

**MONDebugLog.m**

```
void MONDebugLog(NSString * format, ... ) {

    enum {
        MONLog_Undefined,
        MONLog_Enable,
        MONLog_Disable
    };

    static int DoLog = MONLog_Undefined;
    if (MONLog_Undefined == DoLog) {
        DoLog = ...load from plist or defaults and set to Log_Enable or Log_Disable...;
    }

    if (MONLog_Disable == DoLog) {
        return;
    }
    va_list arguments;
    va_start(arguments, format);
    NSString * str = [[NSString alloc] initWithFormat:format arguments:arguments];
    va_end(arguments);
    ...now log or xmit str...
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T09:31:41.203

如果您只想打开或关闭日志记录，那么有一个简单而强大的解决方案。这个想法是将stderr重定向到/dev/null：

```
#include <fcntl.h>
#include <unistd.h>

void setLoggingEnabled(BOOL enabled)
{
    static int copyOfStdErr = -1;
    if (enabled) {
        if (copyOfStdErr == -1)
            return;
        dup2(copyOfStdErr, STDERR_FILENO);
        close(copyOfStdErr);
        copyOfStdErr = -1;
    } else {
        if (copyOfStdErr != -1)
            return;
        copyOfStdErr = dup(STDERR_FILENO);
        int fd = open("/dev/null", O_WRONLY);
        dup2(fd, STDERR_FILENO);
        close(fd);
    }
} 
```

该解决方案有一些优点：

*   您不必在代码中使用自己的日志记录机制，它只适用于`NSLog`
*   不涉及预处理器魔法。
*   它也适用于发出输出的第三方库。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-20T07:45:05.087

你可以尝试这样的事情：

```
#define boolDebug_IsActivated       [[NSUserDefaults standardUserDefaults] boolForKey:@"UseDebug"]

#define DebugLog( s, ... ) \
if (boolDebug_IsActivated) {\
    NSLog( @"<%s:(%d)> %@", __PRETTY_FUNCTION__, __LINE__, [NSString stringWithFormat:(s), ##__VA_ARGS__] );\
} \
else {\
} 
```

当您想要激活/停用时，只需更改`NSUserDefaults`.

例子 ：

```
[[NSUserDefaults standardUserDefaults] setObject:[NSNumber numberWithBool:NO] forKey:@"UseDebug"];
DebugLog(@"comment that should not appear");
[[NSUserDefaults standardUserDefaults] setObject:[NSNumber numberWithBool:YES] forKey:@"UseDebug"];
DebugLog(@"comment that should appear"); 
```

# c - 插入排序汇编代码（从C翻译而来）

> ID：10183088
> 
> 赞同：1
> 
> 时间：2012-04-16T23:27:44.330
> 
> 标签：c, algorithm, sorting, assembly, insertion-sort

*我对汇编编程*没有深入的了解。

我正在尝试将以下代码从*纯 C*转换为*汇编语言*。

**纯C**

```
int i,j,temp;
for ( i = 0 ; i < 10 ; i++ )
{
    temp = global_array[i];
    for ( j = i-1 ; j >= 0 ; j-- )
    {
        if ( global_array[j] <= temp ) break; //if first value is bigger than the second value
            global_array[j+1] = global_array[j];
    }
    global_array[j+1]=temp;
} 
```

*请检查我从纯 C 语言到汇编语言的翻译效果如何？*

**ASM**

```
.globl _Sort
//.type AtoI,@function

//Declaration of variables
.comm _global_array,40 //this is an array of integers
.comm _temp,4 //this is the variable temp
.comm _i,4 //used for loop
.comm _j,4 //used for loop

_Sort:
/*prolog*/
pushl %ebp
pushl %ebx
movl %esp, %ebp //move the special ptr to base ptr
subl $8, %esp //allocate space for the variables local_var and temp_var

pushl %esi //index register
pushl %edi //index register

/*put code here*/
//for ( i = 0 ; i < 10 ; i++ )
//first for loop
movl $0, _i //index i = 0

ForOne:
movl _i, %eax
movl _i, %esi //move i into index register
cmp $10, %eax //if i is less than or equal 9, continue this loop
jge return
movl _global_array, %ebx
movl (%ebx,%esi,4), _%ecx
movl %ecx, _temp //temp = global_array[i]
movl _i, %eax //i-1
subl $1, %eax
movl %eax, _j //move j into index register
jmp ForTwo //jump to second for loop

ForTwo:
movl _j, %eax
cmp $0, %eax //j >= 0
jl ForOneFn //get out of 2nd loop to end of 1st loop
movl _global_array, %ebx
cmp _temp, (%ebx,%edi,4) //if ( global_array[j] <= temp ) break;
jle ForOneFn //jump to end of first loop after break
movl (%ebx,%edi,4),%ecx
addl $1,%eax //j+1
movl _j, %edi //move j into index register 
movl _global_array, %ebx
movl %ecx, (%ebx,%edi,4) //global_array[j+1] = global_array[j];

//last line of code is jump to reloop/finish 2nd loop
jmp ForTwoFn

ForTwoFn:
subl $1, _j
jmp ForTwo

ForOneFn:
addl $1, _i
jmp ForOne

return:
/*epilog*/
movl %ebp,%esp
popl %ebx
popl %ebp
ret 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T17:06:19.910

第一个建议：更密集地使用寄存器。

你有 2 个索引变量，临时变量和 global_array 地址，所以你有足够的寄存器。

代码应该编译如果行：

```
cmp _temp, (%ebx,%edi,4) //if ( global_array[j] <= temp ) break; 
```

将被替换为：

```
cmp eax, (%ebx,%edi,4) //if ( global_array[j] <= temp ) break;, where eax is yours temp 
```

如果你只使用寄存器来编写这个例程，它会更小，更容易理解和调试。

# javascript - 我应该如何编写简单的顺序 GET？

> ID：10183089
> 
> 赞同：1
> 
> 时间：2012-04-16T23:28:03.490
> 
> 标签：javascript, node.js, redis

Node.js 和 redis 看起来很热，但我被烧毁了。我无法优雅地克服看似非常简单的任务：

**给定 3 个数字，检查前两个是否大于 10。如果是，则打印第三个数字。**

我确实用这个相当滑稽的脚本完成了这项任务：

```
var http = require("http");
var redis = require("redis");
client = redis.createClient();

http.createServer(function(request, response) {
    client.SET("key1", "11");
    client.SET("key2", "9");
    client.SET("key3", "3");

    response.writeHead(200, {"Content-Type": "text/plain"});
    response.write("Hello\n\n");
    client.GET("key1", function(err, reply) {
        response.write(reply + "\n\n");

        if(parseInt(reply) > 10) {
          client.GET("key2", function(err, reply) {
              response.write(reply + "\n\n");

              if(parseInt(reply) > 10) {
                client.GET("key3", function(err, reply) {
                    response.write(reply + "\n\n");

                    response.end();
                    client.end();
                  });
              } else {
                response.end();
                client.end();
              }

            });
        } else {
          response.end();
          client.end();
        }
      });
  }).listen(8000); 
```

我注意到的几件事是：

*   每次我想要一个新的 GET 时都需要嵌套吗？
*   `response.end()`需要在某个地方调用`write`s 才能出现。如何避免在`else`块中重复它们？

然后我尝试了这种查询数据库的方式：

```
http.createServer(function(request, response) {

client.SET("key1", "11");
client.SET("key2", "9");
client.SET("key3", "3");

var key1 = 0;
var key2 = 0;
var key3 = 0;

response.writeHead(200, {"Content-Type": "text/plain"});
response.write("Hello\n\n");
client.GET("key1", function(err, reply) {
        response.write(reply + "\n\n");
        key1 = parseInt(reply);
    });

client.GET("key2", function(err, reply) {
        response.write(reply + "\n\n");
        key2 = parseInt(reply);
    });

client.GET("key3", function(err, reply) {
        response.write(reply + "\n\n");
        key3 = parseInt(reply);
    });

response.write(key1 + "\n\n");
response.write(key2 + "\n\n");
response.write(key3 + "\n\n");

response.end();
client.end(); 
```

经过一番阅读和思考，我的解释是代码`response.write`在异步 GET 返回之前到达 s，然后关闭响应，因此内部写入永远不会发生。至少我从第一个示例中注意到，可以轻松调用 SET，但我不知道（这似乎并不重要）它们是否实际上是按该顺序设置的。

所以，也许我正在做一些不适合node和redis的事情。而且我一定遗漏了一些基本而明显的东西。我需要做什么才能升级？

或者告诉我我必须回到 PhpMyAdmin :(

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T00:09:43.363

看看 async 它可以帮助你组织你的代码 [https://github.com/caolan/async](https://github.com/caolan/async) 希望这会有所帮助

# r - 如何计算R中每次迭代的每种组合

> ID：10183092
> 
> 赞同：0
> 
> 时间：2012-04-16T23:28:27.240
> 
> 标签：r

我正在与`loglm(count~A+B+C+D+E, data=whatever)`.

我的问题是我想计算所有效果的每种可能组合。即：A 和 A+A:B 和 A+C+C:B+A:B:C:D:E 等等进入（看似）无穷大。

有什么建议么？

编辑数据看起来像

```
df <- structure(list(count = c(0L, 2L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 
1L, 1L, 1L, 1L, 1L, 0L, 1L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 1L, 0L, 1L),  
A = c(1L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, 1L,  
2L, 1L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, 1L), B = c(1L, 1L, 1L, 1L, 1L,  
1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 2L, 2L, 2L, 2L, 2L, 2L,  
2L, 2L, 2L, 2L, 2L, 2L), C = c(1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 2L, 2L,  
2L, 2L, 2L, 2L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 2L, 2L, 2L, 2L),  
D = c(1L, 1L, 1L, 1L, 2L, 2L, 2L, 2L, 1L, 1L, 1L, 1L, 2L, 2L, 2L, 2L, 1L,  
1L, 1L, 1L, 2L, 2L, 2L, 2L, 1L, 1L, 1L, 1L, 2L), E = c(1L, 1L, 2L, 2L, 1L,  
1L, 2L, 2L, 1L, 1L, 2L, 2L, 1L, 1L, 2L, 2L, 1L, 1L, 2L, 2L, 1L, 1L, 2L,  
2L, 1L, 1L, 2L, 2L, 1L)), .Names = c("count", "A", "B", "C", "D", "E"),  
class = "data.frame", row.names = c(NA, -29L)) 
```

我得到的问题是：

```
> data(SampleData)
Warning message:
In data(SampleData) : data set ‘SampleData’ not found
> fm1 <- loglm(count ~ ., data = SampleData)
> dd <- dredge(fm1)
Error in rownames(ct)[match(names(coef1), rownames(ct))] <- fxdCoefNames : 
  NAs are not allowed in subscripted assignments
In addition: Warning messages:
1: In table(fac) : attempt to set an attribute on NULL (model 1 skipped)
2: In data[do.call("cbind", lapply(fac, as.numeric))] <- rsp :
  number of items to replace is not a multiple of replacement length
3: In st[do.call("cbind", lapply(fac, as.numeric))] <- exp(offset) :
  number of items to replace is not a multiple of replacement length
4: In double(nmar) : vector size cannot be NA/NaN (model 2 skipped)
5: In data[do.call("cbind", lapply(fac, as.numeric))] <- rsp :
  number of items to replace is not a multiple of replacement length
6: In st[do.call("cbind", lapply(fac, as.numeric))] <- exp(offset) :
  number of items to replace is not a multiple of replacement length
7: In double(nmar) : vector size cannot be NA/NaN (model 3 skipped)
> subset(dd, delta < 4)
Error in subset(dd, delta < 4) : object 'dd' not found 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T13:37:36.220

正如我常说的，“你要解决的问题是什么？” 大概您实际上并不需要所有这些 2^N 结果，那么您在寻找什么？也许您希望某种筛子将对结果具有最强、错误...效果的效果归零？

顺便说一句，你可能想玩一点，来自[http://creativemachines.cornell.edu/eureqa](http://creativemachines.cornell.edu/eureqa)`Eureqa`的一个包 。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T23:51:53.763

我相信这会得到你想要的，

```
install.packages('MuMIn', dependencies = TRUE)
library(MuMIn) 
```

来自 Burnham 和 Anderson (2002)，第 100 页的示例：（取自`?dredge`）

```
data(Cement)
fm1 <- lm(y ~ ., data = Cement)
dd <- dredge(fm1)
subset(dd, delta < 4) 
```

您所要做的就是替换`lm(y ~`并`loglm(count~`删除数据中的所有非解释性变量。

# ruby-on-rails - 我应该/我可以使用多个数据库吗？

> ID：10183095
> 
> 赞同：0
> 
> 时间：2012-04-16T23:28:56.703
> 
> 标签：ruby-on-rails, database, dns

我正在使用 Ruby on Rails 并设计用于身份验证。我有一个用户（客户）模型和一个商业模型。我希望用户（客户）通过特定业务注册并属于特定业务。一个企业有很多用户（客户），但一个用户只属于一个企业。我最终希望让企业能够使用他们自己域的子域来对应他们自己的 id，但是现在我已经到了这一点，我不知道如何解决这个问题..

老实说，我还在上高中，我不知道这一切是如何结合在一起的。所以我打算把这个应用程序授权给企业（在我开发这个东西之前已经有一些已经预付了）。每个业务的数据都需要与其他业务分开。有些企业根本没有域，所以我必须在我的服务器上使用子域。有些企业确实有一个网站，所以我想通过他们的企业域使用一个子域。

我现在认为使用多个数据库肯定更好。老实说，我对数据库结构的了解非常有限。我相信可以运行单独的单个应用程序，我一直认为这可能是最好的方式。也可能是最容易开发/维护的？

所以我的问题是运行多个数据库与运行单独的单个应用程序的权衡是什么？我在哪里可以找到有关如何实际执行此操作的更多信息？也有人可以引导我进入正确的方向，了解如何转发这些域或我必须做的事情吗？

如果我的问题不够清楚，也请发表评论......对不起，它太长了，哈哈。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T23:34:39.450

一旦走上了多数据库的路，就不能轻易回头，所以最好有一个很好的理由去做。除非您有严重的扩展问题，否则最好尽可能延迟该决定，而是使用标准关系对数据库进行分区。

Rails 可以很容易地做到这一点，因为您可以将作用域应用于几乎任何东西。例如，您创建一个业务模型，然后不是直接获取其他对象，而是始终在特定上下文中进行。在实践中，这看起来像：

```
@orders = @business.orders.paginated 
```

您可以使所有“面向业务的”控制器成为父类的后代，该父类将`@business`使用 a 加载到正确的模型中`before_filter`，这样就不必在许多不同的控制器中进行复制。

如果在任何时候您确实想要拆分数据库，您可以通过基于`business_id`或其他派生关系分离表来实现。

我发现这对大多数应用程序都非常有效，并且可以很好地扩展。请记住，扩展的第一步不是共享而是复制，因为拥有多个只读副本可以大大提高读取性能，而不会使您的应用程序内部复杂化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T01:30:26.193

[这是关于主题http://www.robbyonrails.com/articles/2009/01/11/subdomain-accounts-with-ruby-on-rails-explained](http://www.robbyonrails.com/articles/2009/01/11/subdomain-accounts-with-ruby-on-rails-explained)的非常好的帖子

也看看[http://37signals.com/svn/posts/1512-how-to-do-basecamp-style-subdomains-in-rails](http://37signals.com/svn/posts/1512-how-to-do-basecamp-style-subdomains-in-rails)

# javascript - 单击链接时javascript获取href

> ID：10183102
> 
> 赞同：9
> 
> 时间：2012-04-16T23:30:17.100
> 
> 标签：javascript, onclick

这是我的情况。我在整个网站上有一些链接。其中一些看起来像这样：

`<a target="_blank" onclick="someFunction()" href="/somFile.pdf">some file</a>`

有些看起来像这样：

`<a target="_blank" href="/somFile.pdf">some file</a>`

单击时，所有链接都应调用 someFunction() 。在 onclick 属性中有调用的是旧的内容页面。较新的页面附加了一个 jQuery click 事件，如下所示：

```
$(document).ready(function(){
  $('a[href$=".pdf"]').click(function() {
    someFunction();
  });
}); 
```

事情就是这样。我可以更新 someFunction()，但我无法触及实际的链接或 jQuery。我需要知道点击链接的 href 值。我尝试在 someFunction() 中使用以下内容：

```
var ev = window.event;
origEl = ev.target || ev.srcElement;
console.log(origEl.href); 
```

但这不起作用。我也试过`console.log(window.event)`但什么也没得到，说它是未定义的。知道我在这里缺少什么，或者在调用函数时如果不传递对它的引用基本上是不可能的吗？

编辑：需要明确的是，我不能作为短期甚至中期解决方案`someFunction()`在 onclick 或黑色 jQuery 代码中编辑调用，因此我不能例如将它们更改为`someFunction(this)`或类似的。我不确定是否可以从 someFunction() 中获取 href ，除非我这样做:(

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2014-06-14T18:58:08.073

这里是纯 JavaScript

```
 //assuming links inside of a shared class "link"
    for(var i in document.getElementsByClassName('link')) {
        var link = document.getElementsByClassName('link')[i];

        link.onclick = function(e) { 
            e.preventDefault();

            //using returned e attributes
            window.location = e.srcElement.attributes.href.textContent;     
        } 
    } 

    //tested on Chrome v31 & IE 11
    //not working in Firefox v29
    //to make it work in all browsers use something like:

    if (e.srcElement === undefined){
    //scrElement is undefined in Firefox and textContent is depreciated

      window.location = e.originalTarget.attributes.href.value;
    } else {
      window.location = e.srcElement.attributes.href.textContent;
    }

    //Furthermore; when you setAttribute("key" "value"); 
    //you can access it with the above node link. 
    //So say you want to set an objectId on something     
    //manually and then grab it later; you can use 

    //Chrome & IE
    //srcElement.attributes.objectid.textContent; 

    //Firefox
    //e.originalTarget.attributes.objectid.value;

    //*Note: for some unknown reason the attribute being defined as "objectId" is changed to "objectid" when it's set. 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-04-16T23:32:39.850

除了回调`this.href`内部之外，您不需要任何其他内容。`click`

```
$(document).ready(function()
{    
    function someFunction(foo)
    {
        console.log(foo);
    }

    $('a[href$=".pdf"]').click(function()
    {
        someFunction(this.href);
    });
}); 
```

或者，您可以`this`指出 的`<a>`偶数内部`someFunction`，如下所示：

```
$(document).ready(function()
{    
    function someFunction()
    {
        console.log(this.href);
        console.log(event);
    }

    $('a[href$=".pdf"]').click(someFunction);
}); 
```

或者，如果这不适合您，我们可以通过以下方式获得更好的体验`Function.apply`：

```
$(document).ready(function()
{    
    function someFunction(event)
    {
        console.log(this.href);
        console.log(event);
    }

    $('a[href$=".pdf"]').click(function (event)
    {
        someFunction.apply(this, event);
    });
}); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-19T04:02:12.423

所以我让它慢了一会儿，我确实想出了一个短期的解决方案……这很老套，我觉得这样做有点脏，但有时你只需要做你必须做的事情，直到你能做你需要做的事情做...无论如何，我在这里为其他可能被支持到类似角落的人发布我丑陋的解决方案...

请记住，我可以在 OP 中接触的唯一代码是 someFunction() 函数本身。另外，我可以在它所在的位置添加一些额外的代码，这就是我所做的......

基本上，解决方案是制作一个额外的点击监听器，将 href 值放入暴露给函数的变量中，然后将 someFunction() 代码包装在一个小的超时中，以确保新的点击函数可以做它的事情。

```
<!-- STUFF I CAN'T TOUCH! (located on-page) -->
<a target="_blank" onclick="someFunction()" href="/somFile.pdf">some file</a>
<a target="_blank" href="/somFile.pdf">some file</a>

<script type='text/javascript'>
$(document).ready(function(){
  $('a[href$=".pdf"]').click(function() {
    someFunction();
  });
});
</script>
<!-- END STUFF I CAN'T TOUCH! -->

/*** STUFF I CAN TOUCH! (located in a script include) ***/
// hackjob!
$(document).ready(function(){
  $('a').click(function() {
    if ($(this).attr('href')) someFunction.href = $(this).attr('href');
  });
});

function someFunction(a) {
  // more hackjob!
  window.setTimeout("console.log(someFunction.href);",200);
}
/*** END STUFF I CAN TOUCH!***/ 
```

所以无论如何，是的，这很丑陋，但如果他们绝望的话，希望它可以拯救某人的屁股。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-16T23:33:54.507

使用`this.href`jQuery 或更合适的 jQuery`$(this).attr('href')`来获取每个链接的值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-16T23:52:13.530

给你。试试这个。根据您的需要进行相应调整（我删除了 pdf 链接，因为我的小提琴中不存在该链接）。

编辑：在 FF 和 Chrome 中测试。让我知道它是否适合你。

[http://jsfiddle.net/lazerblade01/dTVz5/22/](http://jsfiddle.net/lazerblade01/dTVz5/22/)

# php - 使用 PHP 的 mt_rand() 生成哈希盐的安全性？

> ID：10183103
> 
> 赞同：6
> 
> 时间：2012-04-16T23:30:35.323
> 
> 标签：php, hash, salt, prng

我正在尝试生成河豚哈希，我想知道依靠[mt_rand()](http://php.net/manual/en/function.mt-rand.php)为我生成盐是否足够安全？

```
function blowfish($string, $salt = NULL, $iterations = '08')
{
    if( ! $salt)
    {
        $seed = "./ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";
        for ($i = 0; $i < 22; $i++)
        {
            $salt .= $seed{mt_rand(0, 63)};
        }
        $salt = '$2a$' . $iterations . '$' . $salt;
    }

    return crypt($string, $salt);
} 
```

上面的字符 $seed 是允许的 64 个字符的[河豚盐字母表](http://us3.php.net/crypt)。我打算用它来生成和比较密码。

```
$password = 'my^$%#password';
$hash = blowfish($password);

if($hash = blowfish($password, $hash))
{
    print "Matches\n";
    print $hash . "\n";
} 
```

### 编辑

我从来没有意识到这一点，但@zerkms 说的是真的。盐只是为了防止可重用的预计算攻击，因为盐在他们可以访问散列的同一点上是已知的。所以目标不是一种*不可逆的盐*——它是一种**随机**的盐。

那么，这有什么问题吗？

```
function blowfish($string, $salt = NULL, $iterations = '12')
{
    return crypt($string, $salt ?: "$2a\$$iterations$" . md5(uniqid('', true)));
} 
```

此外，如标题和上面的代码中所述，我*没有*实现自己的哈希算法。

### 更新 2

如果加载，使用 mcrypt 扩展会导致以下结果，这实际上更快可能是因为`uniqid`(u)sleeps 或其他原因。

```
function blowfish($string, $salt = NULL, $iterations = '12')
{
    return crypt($string, $salt ?: "$2a\$$iterations$" . base64_encode(mcrypt_create_iv(22, MCRYPT_DEV_URANDOM)));
} 
```

### 更新 3

base64_encode 比 md5 快 - 但它包含**无效**的河豚字符，如`+`. 所以现在改成md5。

```
function blowfish($string, $salt = NULL, $iterations = '12')
{
    return crypt($string, $salt ?: "$2a\$$iterations$" . md5(mcrypt_create_iv(22, MCRYPT_DEV_URANDOM)));
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-16T23:40:40.823

使用[mcrypt](http://docs.php.net/mcrypt_create_iv)创建盐。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-16T23:44:06.017

使用 mt_rand 作为盐，足够安全；显然，您使用每个密码不同的随机盐。

然而，话虽如此；几乎所有自行实现的密码散列系统都是不安全的。很少有人精通生成和维护安全的密码散列系统。作为参考，我恳请您阅读一些 SO 线程：

[PHP/密码最佳实践](https://stackoverflow.com/questions/401656/secure-hash-and-salt-for-php-passwords)

[盐生成和 PHP](https://stackoverflow.com/questions/1645161/salt-generation-and-open-source-software/1645190#1645190)

[不要自己滚动](https://stackoverflow.com/a/9985430/1209423)

我建议**不要自己动手**。时期。如果可能，请考虑使用已建立的PHP[密码散列 PhPass](http://www.openwall.com/phpass/)库。好处包括真实世界的应用程序测试、高度安全的实施和极易使用。

# ruby-on-rails - 通过简单的文本输入充当可标记

> ID：10183105
> 
> 赞同：1
> 
> 时间：2012-04-16T23:30:52.893
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我是 RoR 新手，我正在尝试创建一个简单的博客平台。Currenty 我坚持做标记的可能性。

我已经安装[了作为可标记的](https://github.com/mbleigh/acts-as-taggable-on)gem，添加`acts_as_taggable`到我的`post`模型中。这是我的表格（基于[本](https://we.riseup.net/rails/tagging-tutorial)教程）：

```
<%= form_for(@post) do |f| %>
  <div class="field">
    <%= f.label :title %><br />
    <%= f.text_field :title %>
  </div>
  <div class="field">
    <%= f.label :tag_list %><br />
    <%= f.text_field :tags, :tag_list %>
  </div>
  <div class="actions">
    <%= f.submit %>
  </div>
<% end %> 
```

但是当我试图通过浏览器指向 ie`edit`表单时，我得到的只是以下错误：

```
undefined method `merge' for :tag_list:Symbol 
```

你知道我在做什么错吗？这可能是非常简单的事情:) 在此先感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T00:13:51.877

我相信您只需要将标签输入字段更改为

```
<%= f.text_field :tag_list %> 
```

act-as-taggable-on gem 创建一个模型属性`tag_list`，您应该能够像表单中的任何其他模型属性一样访问它。

# svg - SVG 文本在 Firefox 中被截断，独立于 CSS/HTML 结构

> ID：10183106
> 
> 赞同：1
> 
> 时间：2012-04-16T23:31:14.360
> 
> 标签：svg

页面通过验证器，适用于 IE9 和 Chrome。但我不知道为什么文本会在 Firefox 中被截断？我尝试过使用 CSS，更改标签的宽度和高度（没有做任何事情），更改标签的绝对位置（仍然在完全相同的位置被切断），几乎尝试了任何 HTML/明智的 CSS。

截图：http: [//i44.tinypic.com/10qjp5t.png](http://i44.tinypic.com/10qjp5t.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T07:20:12.617

将 svg 元素的宽度和高度属性都设置为 100%。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-29T16:07:13.453

添加属性“background-size”，并为其指定 SVG 图像的宽度和高度值，如下所示： background-size: (width)px (height)px;

因此，如果您的 SVG 的宽度为 100px，高度为 50px，请在 SVG 的 CSS 中使用以下规则： background-size: 100px 40px;

此外，要添加对旧浏览器的支持，请在 SVG 背景之前在 CSS 中为您的 SVG 定义一个备用 png 背景，按以下方式（和顺序）： background: url(fallback_image.png) no-repeat; 背景：url（svg_image.svg）不重复；

这是因为大多数支持 SVG 的浏览器也支持多背景，因此将应用后一种背景 (SVG)。如果浏览器不支持 SVG，它将只使用第一个背景（非 SVG）。

来源：[http ://css-tricks.com/using-svg](http://css-tricks.com/using-svg)

# linux - linux是如何保护内存的？

> ID：10183110
> 
> 赞同：2
> 
> 时间：2012-04-16T23:31:50.003
> 
> 标签：linux, memory-management, assembly, linux-kernel, kernel

从汇编的角度来看，我对 linux 如何在保护模式下运行很感兴趣。在将 cpu 置于 i386:0x86_64 机器的保护模式时，使用了哪些寄存器和中断？当我查看诸如 mmap 和 mprotect 之类的函数的 c 源时，我了解内存管理是如何工作的，但是是什么让我无法接管汇编？我在哪里可以获得更多信息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T23:40:34.060

我相信您正在寻找[`arch/x86/mm/`](http://lxr.linux.no/#linux+v3.3.2/arch/x86/mm/)——[`arch/x86/mm/init.c`](http://lxr.linux.no/#linux+v3.3.2/arch/x86/mm/init.c)为正确的架构（ia32 或 AMD64）设置页表并考虑可用的处理器功能（PSE、PGE 等）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T00:02:43.563

需要强调的是：这是处理器的功能。Linux 告诉处理器要保护什么，然后处理器来做。

AFA 系统调用接口，看一下[http://stromberg.dnsalias.org/~strombrg/pbmonherc.html](http://stromberg.dnsalias.org/~strombrg/pbmonherc.html)从 C 库有 mmap 之前，但在 Linux 内核有之后。参见文件 mmap.c。

# android - LibGDX - 最后被调用的东西

> ID：10183111
> 
> 赞同：1
> 
> 时间：2012-04-16T23:31:50.170
> 
> 标签：android, libgdx

我不知道把我的 `Debug.stopMethodTracing();`

在销毁活动之前（运行 LibGDX 时）调用的最后一个函数是什么？

**编辑：**我试图将它放在 AndroidApplication 的重写方法 onDestroy() 中，但每当我按下主页按钮或在 eclipse 中终止活动时，它似乎都没有被调用。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T01:37:30.567

libGDX`ApplicationListener`具有将在退出路径上调用的回调`pause`。`dispose`退出时调用（`pause`不仅仅是暂停/恢复），所以它是我保持游戏状态的地方。

请参阅[http://code.google.com/p/libgdx/wiki/ApplicationLifeCycle](http://code.google.com/p/libgdx/wiki/ApplicationLifeCycle)

# php - 是否可以告诉页面正在等待的 $_GET 变量的名称？

> ID：10183115
> 
> 赞同：-1
> 
> 时间：2012-04-16T23:32:18.567
> 
> 标签：php

您好，我有一个关于 PHP $_POST 和 $_GET 的问题。

假设我有一个期待 $_GET 变量的网页。

变量名是匿名的吗？

假设 index.php 有脚本

```
if( isset( $_GET['somevariale'] ) )
{
  rest of the code
} 
```

任何人都可以找出页面正在等待的 $_GET 变量的名称吗？还是他们必须玩猜谜游戏？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T23:35:02.790

如果您没有发布它或者无法从您网站上的现有链接推断出它，他们将不得不玩猜谜游戏。

当然，也不要放进去`robots.txt`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T23:54:30.830

除非他们直接打开文件，否则他们无论如何都看不到您的 index.php PHP 代码（更不用说变量了）。他们只会看到 HTML。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-16T23:52:31.113

不解析就看不到 PHP 代码。所以不，你不能得到它。但也许把它保存在其他地方，我。E. 数据库？

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-04-17T00:25:24.113

这简直是​​不可能的。他们能找到的唯一方法是您的服务器没有正确处理 PHP 并按原样输出。

但是，您可以通过多种方式保护您的脚本，例如在脚本中引入密码等，但您的来源必须知道该密码才能使用该脚本。阅读有关 HTTP 身份验证、领域等的更多信息。

但是，在您的情况下，他们将需要玩猜谜游戏。

# sql-server - 定义外键有什么好处

> ID：10183116
> 
> 赞同：36
> 
> 时间：2012-04-16T23:32:30.113
> 
> 标签：sql-server, database-design, foreign-keys, relational-database

在使用处理关系的 MVC 框架时定义外键有什么好处？

我正在使用带有允许模型定义与关系的框架的关系数据库。因为外键是通过模型定义的，所以外键似乎是多余的。在开发中管理应用程序的数据库时，编辑/删除使用外键的表是一件麻烦事。

通过完全放弃使用外键来使用我放弃的外键有什么好处吗？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-04-16T23:37:18.233

具有约束的外键（在某些数据库引擎中）为您提供低级别（数据库级别）的数据完整性。这意味着您不能实际创建不满足关系的记录。这只是一种更安全的方法。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-04-16T23:39:41.300

它为您提供在数据库级别强制执行的数据完整性。这有助于防止可能导致无效数据的应用程序逻辑错误。

如果任何数据操作是直接在 SQL 中绕过应用程序逻辑进行的，它还可以防止破坏这些约束的不良数据。

另一个好处是它允许工具自动生成数据库图表，其中包含从模式本身推断出的关系。现在理论上所有图表都应该在创建数据库之前完成，但是随着数据库的发展超出其最初的化身，这些图表通常不会保持最新，并且从现有数据库生成图表的能力对双方都有帮助审查，以及向加入项目的新开发人员解释结构。

在数据库结构仍在变化时禁用 FK 可能会有所帮助，但是当模式更加稳定时，它们是很好的保护措施。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2012-04-16T23:43:09.330

外键保证匹配的记录存在于外部表中。想象一个名为 的表在名为 的表`Books`上有一个 FK 约束`Authors`。保证每本书都有一个`Author`.

现在，您可以执行以下查询：

```
SELECT B.Title, A.Name FROM Books B
INNER JOIN Authors A ON B.AuthorId = A.AuthorId; 
```

如果没有 FK 约束，丢失的`Author`行会导致整`Book`行被删除，从而导致数据集中的书籍丢失。

此外，使用 FK 约束，尝试删除至少被一本书引用的作者将导致错误，而不是损坏您的数据库。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-04-16T23:50:50.823

虽然在处理开发/测试数据时它们可能会很痛苦，但它们在生产中为我省去了很多麻烦。

将它们视为维护数据完整性的一种方式，尤其是作为防止孤立记录的保护措施。

例如，如果您有一个将许多`PhoneNumber`记录与一个相关联的数据库`Person`，那么`PhoneNumber`当`Person`记录因某种原因被删除时，记录会发生什么情况？它们仍将存在于数据库中，但与`Person`它们相关的 ID 将不再存在于相关`Person`表中，并且您有孤立记录。

是的，您可以编写一个触发器以在删除`PhoneNumber`a`Person`时删除 a ，但如果您不小心删除 a`Person`并需要回滚，这可能会变得混乱。

是的，您可能记得`PhoneNumber`手动删除记录，但是您在 9 个月后编写的其他开发人员或方法呢？

通过创建确保 any`PhoneNumber`与现有 相关的外键`Person`，您既可以确保不会破坏这种关系，也可以为预期的数据结构添加“线索”。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-04-16T23:44:54.183

主要好处是数据完整性和级联删除。当它们被定义并且这些字段被正确索引时，您还可以获得性能提升。例如，您将无法创建不属于联系人的电话号码，或者当您删除联系人时，您可以将其设置为自动删除他们的所有电话号码。是的，您可以在您的 UI 或中间层中建立这些连接，但如果有人使用 SQL 而不是您的 UI 直接针对服务器运行更新，您仍然会遇到孤立的问题。“麻烦”部分只是迫使您在进行批量更改之前考虑这些联系。FK 救了我的培根很多次。

# javascript - 将 DOM 元素转换为 HTML 代码并显示在页面文本区域中？

> ID：10183117
> 
> 赞同：2
> 
> 时间：2012-04-16T23:32:33.633
> 
> 标签：javascript, jquery

我需要从 HTML 页面中获取一些 DOM 元素并将它们的 HTML（代码）发送到同一页面上的文本区域中。目的是允许查看者将代码复制并粘贴到他们自己的页面中。

这甚至可能吗？

我尝试过类似的东西（在 jQuery 中）：

```
$('textarea').val( $('.container').html() ); 
```

我首先将我需要的元素克隆到 a`div.container`中，但这只是给了我类似`object #<HTMLImageElement>`textarea 的东西。我希望得到的是`<img src="http://www.domain.com/images/file.png" alt="My Image">`根据我克隆的元素的结构。

任何指针表示赞赏！谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-16T23:36:00.060

试试这个：

$('textarea').val($('.container').get(0).innerHTML);

# ios5 - TWRequest 缓存

> ID：10183119
> 
> 赞同：1
> 
> 时间：2012-04-16T23:32:41.070
> 
> 标签：ios5, twitter, twrequest

我在 ios5 中使用 TWRequest 来获取用户帐户的头像。

返回的图像数据似乎没有被缓存。如果我检查 Cache.db sqlite 数据库，所有图像都有记录，但是它们不包含任何数据。

有没有什么简单的方法可以使用 TWRequest 缓存头像（图像）？

# c# - 在 asp 中继器中更改标签的值并隐藏图像按钮

> ID：10183121
> 
> 赞同：1
> 
> 时间：2012-04-16T23:32:43.920
> 
> 标签：c#, asp.net, .net, linq, repeater

我有一个ASP 中继器，它在ItemTemplate 中有一些字段。转发器中的每个项目都有一个“添加到购物车”asp:ImageButton 和一个不可见的 asp:Label。代码如下所示：

```
<asp:Repeater ID="Repeater1" runat="server" OnItemCommand="addToCart">
        <HeaderTemplate>
            <table id="displayTable"> 
        </HeaderTemplate>
        <ItemTemplate>
           <td>
                <!-- fields like name, description etc in the repeater are present; i've omitted to show them here-->
                <asp:Label ID="addedToCartLabel" runat="server" Visible="false"></asp:Label>       
                <asp:ImageButton ID="addToCartImg" runat="server" ImageUrl="hi.jpg" Width="75px" Height="50px" />
           </td>
        </ItemTemplate>
        <FooterTemplate>
           </table>
        </FooterTemplate>
</asp:Repeater> 
```

当单击转发器中的特定 ImageButton 时，我试图将“已添加到购物车”显示为其相应标签的文本，并使单击的 ImageButton Visible=false。我已经尝试对 ASP:Repeater 使用 OnItemCommand 函数。方法是“addToCart”：<>

```
void addToCart(Object Sender, RepeaterCommandEventArgs e)
{
    Cart cart = new Cart();
    cart.instrument_id = //id of product from repeater based on user click
    String userName = Membership.GetUser().ToString();
    cart.user_name = userName;
    cart.quantity = 1;
    var thisLbl = (Label)e.Item.FindControl("addedToCartLabel");
    var thisImg = (ImageButton)e.Item.FindControl("addToCartImg");
    try
    {
        database.Carts.InsertOnSubmit(cart);
        database.SubmitChanges();

        thisImg.Visible = false;
        thisLbl.Text = "Added to Cart!";
        thisLbl.Visible = true;

    }
    catch (Exception ex)
    {
        thisImg.Visible = false;
        thisLbl.Text = "Processing failed;please try again later";
        thisLbl.Visible = true; ;
    }

} 
```

aspx 页面已正确填充。但是，当我单击转发器中的任何 ImageButtons 时，我收到以下错误：

```
 Server Error in '/mysite' Application.
    Invalid postback or callback argument.  Event validation is enabled using <pages enableEventValidation="true"/> in configuration or <%@ Page EnableEventValidation="true" %> in a page.
For security purposes, this feature verifies that arguments to postback or callback events originate from the server control that originally rendered them. 
If the data is valid and expected, use the ClientScriptManager.RegisterForEventValidation method in order to register the postback
or callback data for validation. 
```

有人可以帮我弄这个吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T23:43:46.360

我可以建议使用客户端 javascript 而不是服务器端调用来执行此操作吗？

```
<asp:Label ID="addedToCartLabel" runat="server" Visible="false"></asp:Label>       
<asp:ImageButton ID="addToCartImg" runat="server" ImageUrl="hi.jpg" Width="75px" Height="50px" /> 
```

变成

```
<asp:Label ID="addedToCartLabel" runat="server" Visible="false"></asp:Label>       
<asp:ImageButton ID="addToCartImg" runat="server" onclick="javascript:function() { this.this.style.display='none'; document.getElementById(this.parentNode.firstChild.id).style.display='block'; }"  ImageUrl="hi.jpg" Width="75px" Height="50px" /> 
```

# java - 我在 tabhost 中的 Android Scrollview 消耗了太多内存

> ID：10183122
> 
> 赞同：0
> 
> 时间：2012-04-16T23:32:44.697
> 
> 标签：java, android, memory, scrollview, android-tabhost

我有一个带有滚动视图的活动，用于选项卡主机中的某些选项复选框和按钮，每当第一次在选项卡主机中切换到活动时，我的应用程序内存使用量就会增加约 7 mb。

这使我超过了 16mb 的堆限制。

有没有办法以某种方式减少这种大量内存消耗并在用户从选项选项卡切换到另一个选项卡时完全删除它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T01:20:24.087

在您的 TabActivity 中，尝试像这样创建您的 Intent：

```
Intent myIntent = new Intent(this, MyAwesomeTabView.class).addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP); 
```

这将确保每当用户单击选项卡时，单击的选项卡将是堆上唯一的活动（其他活动将被销毁）。

# linux - Compiz-Snow 插件

> ID：10183127
> 
> 赞同：3
> 
> 时间：2012-04-16T23:33:31.247
> 
> 标签：linux, graphics

看起来不错：[http](http://www.youtube.com/watch?v=EtClcwRgJxU) ://www.youtube.com/watch?v=EtClcwRgJxU 。还能怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T00:16:56.750

如果您在谈论 X11，您可以编写一个 Composite Manager 来实现这一点。您的复合管理器可能希望使用 OpenGL 来实现这些效果，因为 texture_from_pixmap 起着重要的作用。

您可以从这两个关键字开始。不自己写整个东西，而是写一个插件到 Compiz 可能是一种选择。另一个关键字:)

# assembly - Eclipse 显示 .asm 文件中每一行的编译错误

> ID：10183131
> 
> 赞同：0
> 
> 时间：2012-04-16T23:33:48.817
> 
> 标签：assembly, eclipse-cdt

刚刚将我要接管的项目导入 Eclipse。我之前用 g++ 编译得很好，但进展缓慢，因为我更像是一个 IDE 人，我决定将所有源代码导入 Eclipse 并创建一个新项目。

现在在编译时，我的 .asm 文件的每一行都有一个错误，就好像 Eclipse-CDT 不理解汇编代码一样。

我在 Ubuntu 10.04 x86 上运行 Eclipse CDT。如果有帮助，程序集是在 Windows 平台上编写的（我正在尝试将项目移植到 Linux）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T23:36:29.733

你确定 Eclipse 支持汇编吗？是否知道文件正在汇编中？它知道它们的语法吗？

# python - 在 mac osx lion 中安装（构建）matplotlib

> ID：10183144
> 
> 赞同：5
> 
> 时间：2012-04-16T23:35:16.823
> 
> 标签：python, matplotlib, osx-lion

我安装了 pynum 和 scipy（在带有 python 2.7 的 osx Lion 上），但是当我尝试构建 matplotlib

```
git clone https://github.com/matplotlib/matplotlib.git
cd matplotlib
python setup.py build
python setup.py install 
```

我有这些错误：

```
/System/Library/Frameworks/ApplicationServices.framework/Frameworks/ATS.framework/Headers/ATSTypes.h:242: error: declaration for parameter ‘FMFontDirectoryFilter’ but no such parameter
src/_macosx.m:5912: error: expected ‘{’ at end of input
lipo: can't open input file: /var/folders/qw/pr2f7vq91b3c3ngkxrrqplm8zkv09r/T//ccAgEklo.out (No such file or directory)
error: command 'llvm-gcc-4.2' failed with exit status 1 
```

有人可以告诉我有什么问题吗？

PS一开始我尝试这样安装：

```
pip install -e git+https://github.com/matplotlib/matplotlib#egg=matplotlib-dev 
```

但这对我不起作用

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-17T00:04:40.867

我总是觉得这个过程比它应该的更痛苦，但我已经做过几次了，我相信这些步骤应该能让你做好准备：

1.  获取 Xcode 4.3.2，它是后面一些步骤所必需的。
2.  从 python.org[下载最新版本的 Python for OSX](http://python.org/download/)
3.  抓住[Scipy 超级包装](http://fonnesbeck.github.com/ScipySuperpack/)。
4.  卸载您当前拥有的任何以前版本的 numpy/matplotlib/scipy。这包括`cd /Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/`将任何 numpy/matplotlib/scipy 目录或 egg 移动到临时目录中。
5.  `cd ~/Downloads`（或您将 superpack 脚本下载到的任何位置）并运行`sh install_superpack.sh`. 对问题**回答“否**`are you installing from a repository cloned to this machine`”，否则您会对脚本为何不断失败感到困惑。

应该是这样！您现在应该能够启动 python 控制台和`import numpy, scipy, matplotlib`.

# c# - C# - 如何将消息发布到嵌入在 WebBrowser 中的 Flash 窗口？

> ID：10183146
> 
> 赞同：4
> 
> 时间：2012-04-16T23:35:24.667
> 
> 标签：c#, flash, browser, postmessage

我想知道是否有任何方法可以锁定 Flash 窗口并向其发布消息？这里的另一个人有答案，他的名字是 Spencer K。他的问题是： [Send simulation click via WebBrowser in C# to flash object embedded in HTML](https://stackoverflow.com/questions/9653086/sending-simulated-click-via-webbrowser-in-c-sharp-to-flash-object-embedded-in-ht)

不幸的是，K 先生并不是很具体，他给阅读他问题的人留下的只是他“得到了句柄，然后遍历了句柄”。我不太确定他的意思是什么。我使用 EnumWindows 遍历了所有可见的句柄但无济于事，因为它没有返回一个作为 Flash 窗口的窗口。

我希望这里有人能告诉我，因为过去几天它一直让我发疯。

编辑：我刚刚决定在我的表单中插入一个 SWF 对象并将消息发布到它的句柄。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-22T17:56:51.067

实际上 Flash 窗口也有自己的句柄。要获得它，您必须从 Spy++ 中获取它嵌入的控件的类名，然后您可以像这样访问它：

```
 [DllImport("user32.dll", SetLastError = true)]
    public static extern IntPtr FindWindowEx(IntPtr parentHandle, IntPtr childAfter, string className, IntPtr windowTitle);
    public IntPtr Flash()
    {
        IntPtr pControl;
        pControl = FindWindowEx(webBrowser1.Handle, IntPtr.Zero, "Shell Embedding", IntPtr.Zero);
        pControl = FindWindowEx(pControl, IntPtr.Zero, "Shell DocObject View", IntPtr.Zero);
        pControl = FindWindowEx(pControl, IntPtr.Zero, "Internet Explorer_Server", IntPtr.Zero);
        pControl = FindWindowEx(pControl, IntPtr.Zero, "MacromediaFlashPlayerActiveX", IntPtr.Zero);
        return pControl;
    } 
```

获得句柄后，您可以发布点击：

```
 [DllImport("user32.dll", SetLastError = true)]
    static extern bool PostMessage(IntPtr hWnd, uint Msg, int wParam, int lParam);
    public enum WMessages : int
    {
        WM_LBUTTONDOWN = 0x201,
        WM_LBUTTONUP = 0x202
    }
    private int MAKELPARAM(int p, int p_2)
    {
        return ((p_2 << 16) | (p & 0xFFFF));
    }
    public void DoMouseLeftClick(IntPtr handle, Point x)
    {
        PostMessage(handle, (uint)WMessages.WM_LBUTTONDOWN, 0, MAKELPARAM(x.X, x.Y));
        PostMessage(handle, (uint)WMessages.WM_LBUTTONUP, 0, MAKELPARAM(x.X, x.Y));            
    } 
```

这些点是相对于客户端的，所以当你保存它们时，你应该像这样保存它：

```
 List<Point> plist = new List<Point>();
    private void webBrowser1_PreviewKeyDown(object sender, PreviewKeyDownEventArgs e)
    {
        switch (e.KeyCode)
        {
            case Keys.C:                   
                plist.Add(webBrowser1.PointToClient(Cursor.Position));                    
                break;
            default:
                break;
        }
    } 
```

希望这有帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T23:59:13.787

你可以通过javascript来做到这一点。

导入这个：

```
import flash.external.ExternalInterface; 
```

将此添加到您的 AS 代码中：

```
if (ExternalInterface.available) {
   // add external interface
   ExternalInterface.addCallback("jsFunction", asFunction);
}

public static function asFunction(message:String):void {
} 
```

在 flash 对象的 JS 对象上，您可以调用此函数：

```
jsObject.jsFunction("message"); 
```

这是获取flash对象的js对象的函数：

```
var InternetExplorer = navigator.appName.indexOf("Microsoft") != -1;
jsObject = InternetExplorer ? window.jsObjectName: window.document.jsObjectName; 
```

我没有测试这段代码，我只是把它从一个项目中复制出来。

编辑：添加 js 函数来获取 js 对象

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T00:00:40.767

Flash 窗口可能没有自己的句柄，因为它嵌入在网页中。您可能希望将消息发布到 Web 浏览器窗口（这就是 K 先生所做的）。

如果这对您不起作用，我知道的唯一其他选择是通过 WebDriver 或 WatiN 控制浏览器并使用 javascript 与 flash 对象交互。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-22T18:02:56.473

要在 Flash 对象中调用函数，您可以使用此代码

```
 swfobject.CallFunction(
               "<invoke name=\"yourfunction\" returntype=\"xml\">" +
               " <arguments><number>" yourvalue "</number></arguments> </invoke> "); 
```

欲了解更多信息，请点击此链接：[communicate-betwen-c-and-an-embeded-flash-application](http://blog.another-d-mention.ro/programming/communicate-betwen-c-and-an-embeded-flash-application/)

我在我的表单应用程序中尝试将它用于 Flash 对象并且它可以工作，但我没有将它用于 webbrowser

# xml - jQuery XML 不工作

> ID：10183152
> 
> 赞同：1
> 
> 时间：2012-04-16T23:36:40.533
> 
> 标签：xml, ajax, jquery

[http://jsfiddle.net/bpBtC/](http://jsfiddle.net/bpBtC/)

我正在使用博客 xml 提要，但它不起作用，有人可以帮助我了解我哪里出错或缺少什么。

```
$(document).ready(function () {
    $.ajax({
        type: "GET",
        url: "http://www.blogger.com/feeds/2399953/posts/default",
        dataType: "xml",
        success: xmlParser
    });
});

function xmlParser(xml) { 
    $(xml).find("entry").each(function () {
        $(".entirecont").append($(this).find('title').text());
    });
} 
```

​</p>

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T23:38:41.070

您正在尝试访问您的域之外的域。尝试在您的服务器上创建代理以检索 xml。浏览器不允许在 javascript 中进行跨域访问。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T00:03:56.657

您需要 jsonp 数据类型才能访问跨域 ajax 调用。请参阅下面的示例并查看[http://www.ibm.com/developerworks/library/wa-aj-jsonp1/中的 jsonp 是什么](http://www.ibm.com/developerworks/library/wa-aj-jsonp1/)

```
$(document).ready(function () {
    $.ajax({
        type: "GET",
        url: "http://www.blogger.com/feeds/2399953/posts/default",
        dataType: "xml",
        success: xmlParser,
        dataType: "jsonp" // add this line
    });
}); 
```

希望能帮助到你

更新

这是[您的 jsfiddle的更新版本](http://jsfiddle.net/bpBtC/1/)

# python - 使用pylast后写入txt文件 - 编码错误

> ID：10183167
> 
> 赞同：0
> 
> 时间：2012-04-16T23:39:06.217
> 
> 标签：python, character-encoding

我在写入使用 pylast 的文件时遇到问题。按照 pylast 中给出的模板，我添加了一个正则表达式来提取我需要的内容（这很好），但是当我尝试打印到文件时，我得到一个错误，并且不知道如何修复它（我我正在自学 python 和它的一些库）。我怀疑我需要在某处制定编码规范（某些屏幕输出也显示非标准字符）。我不知道如何解决我的问题。有人可以帮忙吗？谢谢

```
import re
import pylast

RawArtistList = []
ArtistList = []

# You have to have your own unique two values for API_KEY and API_SECRET
# Obtain yours from http://www.last.fm/api/account for Last.fm
API_KEY = "XXX"
API_SECRET = "YYY"

###### In order to perform a write operation you need to authenticate yourself
username = "username"
password_hash = pylast.md5("password")
network = pylast.LastFMNetwork(api_key = API_KEY, api_secret = API_SECRET, username = username, password_hash = password_hash)

##          _________INIT__________
COUNTRY = "Germany"

#---------------------- Get Geo Country --------------------
geo_country = network.get_country(COUNTRY)

#----------------------  Get artist --------------------
top_artists_of_country = str(geo_country.get_top_artists())

RawArtistList = re.findall(r"u'(.*?)'", top_artists_of_country)

top_artists_file = open("C:\artist.txt", "w")
for artist in RawArtistList:
  print artist
  top_artists_file.write(artist + "\n")

top_artists_file.close() 
```

我试图创建“artist.txt”的文件的名称更改为“x07rtist.txt”并且错误开始出现。我明白了：

```
Traceback (most recent call last):
File "C:\music4A.py", line 32, in <module>
top_artists_file = open("C:\artist.txt", "w")
IOError: [Errno 22] invalid mode ('w') or filename:'C:\x07rtist.txt' 
```

非常感谢您的帮助！干杯。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T23:43:04.067

[Python 文档](http://docs.python.org/reference/lexical_analysis.html#string-literals)说：

> 反斜杠 () 字符用于转义具有特殊含义的字符，例如换行符、反斜杠本身或引号字符。

...所以当你说

```
top_artists_file = open("C:\artist.txt", "w") 
```

该字符串文字被解释为

```
C:  \a rtist.txt 
```

...其中`\a`是一个值为 0x07 的单个字符。

...那行应该是：

```
# doubling the backslash prevents misinterpreting the 'a'
top_artists_file = open("C:\\artist.txt", "w") 
```

或者

```
# define the string literal as a raw string to prevent the escape behavior
top_artists_file = open(r"C:\artist.txt", "w") 
```

或者

```
# forward slashes work just fine as path separators on Windows.
top_artists_file = open("C:/artist.txt", "w") 
```

# java - Spring中如何实现基于客户端令牌的限速？

> ID：10183168
> 
> 赞同：17
> 
> 时间：2012-04-16T23:39:32.993
> 
> 标签：java, spring, spring-security, oauth-2.0, rate-limiting

我正在使用 Spring 3 + Spring MVC 开发一个简单的 REST API。身份验证将通过 OAuth 2.0 或使用 Spring Security 的带有客户端令牌的基本身份验证来完成。这仍在辩论中。所有连接都将强制通过 SSL 连接。

我一直在寻找有关如何实施速率限制的信息，但似乎没有很多信息。该实现需要分布式，因为它可以跨多个 Web 服务器工作。

例如，如果有三个 api 服务器 A、B、C 并且客户端每秒限制为 5 个请求，那么像这样发出 6 个请求的客户端会发现对 C 的请求被拒绝并出现错误。

```
A recieves 3 requests   \
B receives 2 requests    | Executed in order, all requests from one client.
C receives 1 request    / 
```

**它需要基于请求中包含的令牌工作**，因为一个客户端可能代表许多用户发出请求，并且每个用户应该受到速率限制而不是服务器 IP 地址。

该设置将是 HAProxy 负载平衡器后面的多个 (2-5) Web 服务器。有一个 Cassandra 支持，并且使用了 memcached。Web 服务器将在 Jetty 上运行。

一个潜在的解决方案可能是编写一个自定义 Spring Security 过滤器，该过滤器提取令牌并检查在最后 X 秒内使用它发出了多少请求。这将允许我们为不同的客户做一些事情，比如不同的速率限制。

关于如何完成的任何建议？是否有现有的解决方案，还是我必须编写自己的解决方案？我以前没有做过很多网站基础设施。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2019-04-01T02:40:37.497

> > 它需要基于请求中包含的令牌工作，因为一个客户端可能代表许多用户发出请求，并且每个用户应该受到速率限制而不是服务器 IP 地址。
> > 
> > 该设置将是 HAProxy 负载平衡器后面的多个 (2-5) Web 服务器。有一个 Cassandra 支持，并且使用了 memcached。Web 服务器将在 Jetty 上运行。

我认为该项目是请求/响应 http(s) 协议。并且您使用 HAProxy 作为前端。也许 HAProxy 可以负载均衡`token`，你可以从[这里](https://serverfault.com/questions/206082/haproxy-load-balancing-with-http-headers)检查。

然后相同的`token`请求将到达相同的 webserver，webserver 可以使用内存缓存来实现速率限制器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T00:56:41.540

如果可能的话，我会避免修改应用程序级别的代码来满足这个要求。

我查看了[HAProxy](http://haproxy.1wt.eu/download/1.4/doc/configuration.txt) LB 文档，那里没有什么太明显的地方，但是这个要求可能需要对 ACL 进行全面调查。

将 HAProxy 放在一边，一种可能的架构是将 Apache WebServer 放在前面并使用 Apache 插件来进行速率限制。超出限制的请求会在前面被拒绝，然后 Apache 后面的层中的应用程序服务器将与速率限制问题分开，从而使它们更简单。您还可以考虑从 Web 服务器提供静态内容。

请参阅此问题的答案[如何使用 Apache 实现速率限制？（每秒请求数）](https://stackoverflow.com/questions/131681/apache-rate-limiting-options)

我希望这有帮助。抢

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T11:00:33.967

您可以在流程中的各个点设置速率限制（通常越高越好），您所采用的一般方法很有意义。实现的一种选择是使用 3scale 来完成它（[http://www.3scale.net](http://www.3scale.net)） - 它执行速率限制、分析、密钥管理等，并且可以与代码插件一起使用（Java 插件在这里：[https ://github.com/3scale/3scale_ws_api_for_java](https://github.com/3scale/3scale_ws_api_for_java)），它推动或通过将 Varnish（http://www.varnish-cache.org）之类的东西放入管道中并具有应用速率限制。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-12-11T06:39:34.947

几天前我也在考虑类似的解决方案。基本上，我更喜欢“中央控制”的方案来保存分布式环境中客户端请求的状态。

在我的应用程序中，我使用“session_id”来识别请求客户端。然后创建一个 servlet 过滤器或 spring HandlerInterceptorAdapter 来过滤请求，然后使用中央控制的数据存储库检查“session_id”，它可以是 memcached、redis、cassandra 或 zookeeper。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-04-06T06:10:20.437

我们使用 redis 作为漏桶后端

添加控制器作为入口

谷歌将该令牌缓存为具有过期时间的键

然后过滤每个请求

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-12-31T11:59:10.007

最好使用 REDIS 实现[ratelimit](http://redis.io/)。有关更多信息，请查看此[速率限制 js 示例。](https://chris6f.com/rate-limiting-with-redis)

# c - 通过内存访问跟踪文件确定缓存读/写/命中/未命中

> ID：10183172
> 
> 赞同：1
> 
> 时间：2012-04-16T23:39:43.710
> 
> 标签：c, caching, trace

我的作业是通过示例程序确定给定跟踪文​​件的缓存读取/写入/未命中/命中数。

比如说，这是示例跟踪输出的前 10 行。

```
0x37c852: W 0xbfd4b18c
0x37cfe0: W 0xbfd4b188
0x37cfe3: W 0xbfd4b184
0x37xfe4: W 0xbfd4b180
0x37cfe5: W 0xbfd4b17c
0x37cfe9: W 0xbfd4b128
0x395bcb: R 0xbfd4b128
0x395bce: R 0xbfd4b128
0x37cff4: W 0xbfd4b158
0x37cff9: W 0x39deac 
```

如何通过分析每一行来确定我需要知道的内容？

谢谢，如果您有任何教育资源，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-09-05T00:07:04.147

是的，您可以从跟踪文件中确定缓存参数。但是您需要具备以下任一条件：

1.  跟踪文件的格式。（我怀疑你可以访问）
2.  了解系统的参数，即缓存大小、寻址位（解释）

实际上缓存是基于时间局部性和空间局部性的。所以为你确定

*   **空间局部性：**检查获取的地址是否是最近获取的地址 + 字长（可以是双字长等）例如：您最近获取了 0x4000，下一次访问是 0x4008。如果行/块长度（即缓存一次性获取的数据长度）。准确地说，您还需要知道缓存是否设置为关联以及多少，这将有助于替换以及更准确的替换策略（我非常怀疑有人会要求做作业）
*   **时间局部性：**检查访问的地址是否在不久的将来再次被调用以及是否没有被替换（因为请求了具有相同索引和不同标签的其他地址）

我希望这将试图弄清楚如何处理。为了更好地理解，我会推荐计算机组织和设计一本书的内存层次结构。

# c# - 如何使用 c# 序列化对象数组服务器端？

> ID：10183176
> 
> 赞同：0
> 
> 时间：2012-04-16T23:40:23.017
> 
> 标签：c#, ajax, json, serialization, webforms

我需要从服务器端返回一个对象数组。如何序列化下面的示例，使其看起来像使用 c# 和 webforms？

```
var word_list = [
          {text: "Lorem", weight: 15},
          {text: "Ipsum", weight: 9, url: "http://jquery.com/", title: "I can haz URL"},
          {text: "Dolor", weight: 6},
          {text: "Sit", weight: 7},
          {text: "Amet", weight: 5}
          // ...other words
      ]; 
```

我尝试了以下方法，但它在属性中添加了引号并且似乎不起作用。

```
 JavaScriptSerializer serializer = new JavaScriptSerializer();
            return serializer.Serialize(obj); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T23:33:20.120

我最终从服务器端返回了一个 json 对象，然后循环通过它来创建正确的格式。

# c# - Metro 应用程序中的异步调用链

> ID：10183179
> 
> 赞同：2
> 
> 时间：2012-04-16T23:40:50.847
> 
> 标签：c#, user-interface, asynchronous, microsoft-metro, async-await

我对 Metro 开发人员很陌生，我只希望我能够以一种可以理解的方式表达我的问题......

实际上，我正在将旧应用程序的一部分移植到 Metro。逻辑部分是一个单独的项目（便携式库），它应该用于 1）旧的 WPF 应用程序和 2）新的 Metro 应用程序。基本逻辑是相同的，但某些子系统（例如文件操作管理器）必须以不同方式编码 - 即 Metro 的异步方式。

我的问题是：我是否必须将调用者-被调用者的整个方法链重写为新的异步范式？假设我有 4 个方法链，从方法 A = Metro UI 事件异步处理程序开始（对我来说，将其编码为 async void 是有意义的，因为它是最重要的 fire&forget 事件），通过接下来的 2 个方法（B 和 C ) 放置在我的应用程序的不同层中，一直到包含“await CreateFileAsync”方法的方法 D（由 Microsoft 实现异步）。

现在：异步 CreateFileAsync 方法应该用 await 调用。这迫使我也使方法 D 异步。要从 C 调用方法 D，从 B 调用 C，从 A 调用 B - 我是否必须将所有 A、B 和 C 重写为 async-await 样式？

我能感觉到我缺少更深层次的知识，所以我正在努力教育自己，但同时我想在这里碰碰运气......

我必须重写大部分代码吗？我上面的任何陈述是错误的吗？

非常感谢，汉斯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-16T23:52:30.530

我建议您将可移植库重写为异步的。它不像以前那么糟糕了；Microsoft 在`async`/上非常努力地工作`await`，以尽可能轻松地将同步代码转换为异步代码。我预计在不久的将来会有很多其他人这样做，并且 R# 可能会实现“make async”重写。

混合同步和异步代码时存在不明显的缺陷 - 请参阅 Stephen Toub 的上一篇博客文章[我应该为异步方法公开同步包装器吗？](http://blogs.msdn.com/b/pfxteam/archive/2012/04/13/10293638.aspx)出于这个原因，我认为将异步操作公开为异步 API（以及将同步操作公开为同步 API）更简洁。

**更新：**如果您确实希望同步代码调用异步代码，那么您可以使用[我的 AsyncEx 库](http://nitoasyncex.codeplex.com)`Task.WaitAndUnwrapException`中的扩展方法。但是，您仍然遇到 Stephen Toub 的帖子中提到的问题，即：

1.  如果您的库不能`ConfigureAwait(false)`在任何地方使用它，您可能会陷入僵局。
2.  如果遇到线程池中的最大线程数，也可能会死锁。

(2) 不再那么常见，但 (1) 是一种真正的可能性。它经常由刚刚进行测试的人提出，[因此](http://social.msdn.microsoft.com/Forums/en-AU/async/thread/269172a3-adb9-4b5e-9ac1-8b67ff920177#48b596cc-5eca-4d0e-8743-10d59b64e2ce)`async`他们将其与同步代码混合在一起。

# visual-studio - VSX：自定义项目类型

> ID：10183183
> 
> 赞同：2
> 
> 时间：2012-04-16T23:41:37.033
> 
> 标签：visual-studio, visual-studio-2010, vsx, vsix

我正在尝试创建一个适用于 VS2010 Standard/Pro/Ultimate 以及 Integrated Shell 的项目模板。

我已经让 VS2010 Std 部分工作了，但对于我的生活，我无法让它与 Int Shell 一起工作——可能是因为我的安装没有任何 CSharp 项目。

在谷歌搜索了一整天之后，我偶然发现了 IronPython 的 vstemplate 文件，它看起来像这样：

```
<VSTemplate Version="2.0.0" Type="Project" xmlns="http://schemas.microsoft.com/developer/vstemplate/2005">
  <TemplateData>
    <Name>Python Application</Name>
    <Description>A project for creating a command-line application</Description>
    <Icon>__TemplateIcon.ico</Icon>
    <ProjectType>Python</ProjectType>
    <SortOrder>50</SortOrder>
    <NumberOfParentCategoriesToRollUp>2</NumberOfParentCategoriesToRollUp>
    <CreateNewFolder>false</CreateNewFolder>
    <DefaultName>PythonApplication</DefaultName>
    <ProvideDefaultName>true</ProvideDefaultName>
  </TemplateData>
  <TemplateContent>
    <Project File="PythonApp.pyproj" ReplaceParameters="true">
      <ProjectItem ReplaceParameters="true" OpenInEditor="true" TargetFileName="$safeprojectname$.py">Program.py</ProjectItem>
    </Project>
  </TemplateContent>
</VSTemplate> 
```

[这些模板适用于所有版本，并且具有与MSDN](http://msdn.microsoft.com/en-us/library/5we0w25d.aspx)中提到的不同的 ProjectType ：ProjectType = Python。他们是怎么做到的？如果我使用 CSharp/Web/VisualBasic 以外的其他东西，我的项目类型就会付诸东流。

谢谢;

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T13:00:34.397

我没有深入了解您所描述的问题，但我想这 2 条提示将帮助您解决问题。简而言之，您应该关心您的自定义 ProjectNode 类的 ProjectType 属性，并确保您已在 VSX 属性和自定义 .template 文件中的某处指定它（我不记得我到底在哪里做的）。所以有我提到的那些链接：

*   [演练：第 1 部分 - 创建基本项目系统](http://msdn.microsoft.com/en-us/library/cc512961.aspx)（在页面上搜索“ProjectType”和“ProjectGuid”字样）

*   [“新建项目”对话框中自定义项目类型的根节点](http://social.msdn.microsoft.com/Forums/en-US/vsx/thread/990f5e61-dbbc-449d-b492-7c182af95048) （另请查看页面右侧的“相关主题”）

希望有帮助！

# html - Chrome 渲染奇怪的 CSS 布局（Firefox 和 IE 都不错）

> ID：10183184
> 
> 赞同：0
> 
> 时间：2012-04-16T23:42:01.910
> 
> 标签：html, css, google-chrome, layout, page-layout

这是我的 HTML 页面在 Firefox 和 IE 中的样子： ![Firefox 和 IE 中的页面布局](../Images/060380a7275ea4198cfe3c5dff3053f3.png)

这是谷歌浏览器中的同一页面： ![Google Chrome 中的页面布局](../Images/d80e4dccd75d6f77454b71235d458e36.png)

这是HTML代码：

```
<div id="container">

  <div id="header">
    <div id="navigation">
      <ul>
        <li><a href="#">Info</a></li>
        <li><a href="#">My menu</a></li>
        <li><a href="#">Members</a></li>
        <li><a href="#">Manage</a></li>
      </ul>
    </div>
  </div>

  <div id="sidebar"></div>

  <div id="content">
    <div id="articles-overflow"> 
      <div id="articles-strip">

        <div class="article-month-column">
          <div class="article">
            <div>
              <h1>Article 1.1</h1>
              <p>
                This is some idiotic text.
                This is some idiotic text.
                This is some idiotic text.
                This is some idiotic text.
                This is some idiotic text.
              </p>
            </div>
          </div>
          <div class="article">
            <div>
              <h1>Article 1.2</h1>
              <p>
                This is some idiotic text.
                This is some idiotic text.
                This is some idiotic text.
                This is some idiotic text.
                This is some idiotic text.
              </p>
            </div>
          </div>
        </div>

        <div class="article-month-column">
          <div class="article">
            <div>
              <h1>Article 2</h1>
              <p>
                This is some idiotic text.
                This is some idiotic text.
                This is some idiotic text.
                This is some idiotic text.
                This is some idiotic text.
              </p>
            </div>
          </div>
        </div>

        <div class="article-month-column"></div>
        <div class="article-month-column"></div>
        <div class="article-month-column"></div>

      </div>
    </div>
  </div>

  <div id="footer"></div>

</div> 
```

这是红色、黄色、紫色、白色和绿色容器的 CSS。

```
#sidebar {
  float: left;
  width: 180px;
  height: 200px;
  background: blue;
}

#content {
  overflow: auto;
  display: block;
  background: red;
}

#articles-overflow {
  margin: 10px 5px;
  overflow: auto;
  display: block;
  background: yellow;
}

#articles-strip {
  white-space: nowrap;
}

.article-month-column {
  width: 224px;
  height: 450px;
  margin-right: 15px;
  background: darkviolet;
  display: inline-block;
  overflow: auto;
  white-space: normal;
}

.article {
  display: block;
  clear: both;
  margin: 0px 5px 10px 0px;
  padding: 10px;
  background: white;
  border-radius: 5px;
}

p {
  padding: 0px 7px 0px 0px;
  margin: 0px 0px 1em 0px;
  font-size: 7.5pt;
  text-align: justify;
  background: green;
} 
```

请问，有什么办法可以解决这个问题吗？我已经为此苦苦挣扎了一天，我简直无法理解为什么 Google Chrome 会以这种奇怪的方式呈现页面布局。任何帮助是极大的赞赏。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T23:57:35.830

您只需要`vertical-align`为这些`inline-block`元素指定 。

此外，在为旧版本的 IE 使用 inline-block 时，您应该拥有一些额外的 CSS。

> ```
> .article-month-column {
>   width: 224px;
>   height: 450px;
>   margin-right: 15px;
>   background: darkviolet;
>   display: inline-block;
>   overflow: auto;
>   white-space: normal;
>   vertical-align:top;
> 
>   /*For IE*/
>   *display: inline;
>   zoom:1;
> } 
> ```

# c++ - " :: " 在变量名之前 c++

> ID：10183185
> 
> 赞同：2
> 
> 时间：2012-04-16T23:42:07.417
> 
> 标签：c++, variables, scope

```
#include <iostream>

using namespace std;

int d = 10;

int main()
{
    int d = 20;

    {
        int d = 30;
        cout << d << endl << ::d; // what does it mean?
    }

    return 0;
} 
```

输出是：

> 30
> 10

**我不明白为什么“ `::d`”给出10？有人可以向我解释一下吗？**

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-16T23:44:21.060

`::d``d`来自全局命名空间的意思

编辑：有三个具有相似名称的不同变量`d`。一个在全局命名空间`d=10`中，一个在函数范围内`main`（`20`），最后一个在主函数的内部块内（`30`）。

在每个块中，您都可以（通过名称）访问相应的变量**，并且**始终可以访问全局命名空间（通过`::`）。

# php - 来自两个表的 SQL 中的求和列

> ID：10183186
> 
> 赞同：0
> 
> 时间：2012-04-16T23:42:18.340
> 
> 标签：php, mysql, sql, sum

我正在使用 MySQL 并尝试汇总用户参与活动的小时数，但仅针对特定组织。

编辑：我有另一张桌子（misEvents）。我认为 GROUP BY 语句引起了一些问题，但我不太确定该怎么做。

```
table events: contains the "event" information. orgID is the ID of the organization hosting it
-each listing is a separate event

ID | orgID | hours
1  |   1   |   1
2  |   1   |   2
3  |   2   |   1

table eventUserInfo: shows which users attended the events
-refID references the ID column from the events table

ID | refID | userID
 1 |   1   |   1
 2 |   1   |   3
 3 |   2   |   2
 4 |   2   |   1 
 5 |   3   |   2

table miscEvents
-these are entered in manually if an event by an organization wasn't posted on the site, but
the users still wants to keep track of the hours

ID |  userID  | orgID |  Hours
1  |    1     |  1    |    2 
```

因此，当我查看组织 1 的成员活动时，应显示下表

```
userid | total hours
  1    |      5      //participated in ID #1 and 2 and a misc event, total of 4 hours
  2    |      2      //participated in ID #2 only for org 1
  3    |      1      //participated only in ID #1 
```

假设给定的输入是 $orgID 在这种情况下设置为 1

```
SELECT eventUserInfo.userID, sum(events.hours) as hours,sum(miscEvents.hours) AS mhours FROM events 
JOIN eventUserInfo ON events.ID = eventUserInfo.refID 
JOIN miscEvents ON events.orgID = miscEvents.orgID
WHERE events.orgID = '$orgID'
GROUP BY eventUserInfo.userID 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T23:59:54.697

或者因为 eventINFO 似乎是查询中的主表：

```
SELECT eventINFO.userID, SUM(events.hours)
FROM eventINFO
JOIN events ON eventINFO.refID = events.ID
WHERE events.orgID = '$orgID'
GROUP BY eventINFO.userID 
```

`FROM`应该导致与 ypercube 相同，但对我来说，在通话中调用您的主表似乎更清楚一些

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-16T23:50:45.260

我认为应该是：

```
SELECT eventInfo.userID               --- there is no "events.userID" column
     , SUM(events.hours) AS hours     --- alias added
FROM events 
  JOIN eventInfo                      --- no need for LEFT JOIN
    ON events.ID = eventInfo.refID    
WHERE events.orgID = '$orgID'
GROUP BY eventInfo.userID 
```

问题可能在于您尝试打​​印`"hours"`with:`$event['hours']`但没有`hours`返回列（只有`userID`and `SUM(event.hours)`。在列表中使用别名`SELECT`，如上所述。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T03:25:38.187

对于你的新问题，你需要摆脱这个：

```
sum(events.hours + miscEvents.hours) 
```

如果我没记错的话，你不能有多个列，`SUM`每次调用只能添加一个列。

我会尝试类似的东西：

```
SUM(events.hours) AS hours, SUM(miscEvents.hours) AS mhours 
```

然后，在您的函数中，将这些值相加`$total = hours + mhours`

# ruby-on-rails-3 - 如何保护 Heroku 上的 Rails App 和远程 IIS 服务器之间的数据传输？

> ID：10183189
> 
> 赞同：0
> 
> 时间：2012-04-16T23:42:38.110
> 
> 标签：ruby-on-rails-3, security, windows-server-2008

我正在 Heroku 的 Cedar 堆栈上运行 Rails 应用程序。我需要访问远程 Windows Server（通过 Internet，而不是 LAN）来查询 SQL Server 数据库。

首先，我使用 TinyTDS 访问数据库，但在 Heroku 上配置它真的很痛苦。
其次，我在 IIS 远程服务器上创建了一个动态网页，并发出 http get 请求来检索数据。但这并不安全。

我需要一个好的和安全的解决方案（ssh 隧道？）。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T00:27:45.287

使用 HTTP 请求在两者之间进行交互并没有错。如果要加密，只需使用 HTTPS。如果只是供内部使用，则不需要购买 SSL 证书，您可以自己生成。

# ios - iOS 应用提交备忘单

> ID：10183194
> 
> 赞同：1
> 
> 时间：2012-04-16T23:43:06.027
> 
> 标签：ios, app-store

是否有用于向 App Store 提交 iOS 应用程序的“备忘单”

应用程序已经过测试并准备好提交

分发配置文件已创建并下载当尝试将分发配置文件添加到库 > 配置文件时 - 我收到“未找到有效签名身份”

我花了一整天的时间浏览零散的信息，但似乎没有任何信息可以概述整个工作流程——苹果让它变得如此困难是有原因的吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-17T00:42:59.470

试试这个由两部分组成的系列教程“如何将您的应用程序提交给 Apple”。

[http://www.raywenderlich.com/8003/how-to-submit-your-app-to-apple-from-no-account-to-app-store-part-1](http://www.raywenderlich.com/8003/how-to-submit-your-app-to-apple-from-no-account-to-app-store-part-1)

编辑：教程的第二部分： [http ://www.raywenderlich.com/8045/how-to-submit-your-app-to-apple-from-no-account-to-app-store-part-2](http://www.raywenderlich.com/8045/how-to-submit-your-app-to-apple-from-no-account-to-app-store-part-2)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T01:12:07.133

这不是一个完整的工作流程，但它是我所知道的要检查预提交的最全面的列表：[https ://ontestpad.com/library/201/ios-app-store-submission-checklist](https://ontestpad.com/library/201/ios-app-store-submission-checklist)

这绝不是一步一步的演练，但如果您可以对每个项目回答是并且仍然有提交问题，我会感到惊讶。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T18:39:21.620

尽管您可以使用各种在线列表来帮助检查您是否忘记了任何东西，但没有什么比阅读 Apple 的所有文档更好的了. Apple 的文档是他们的最新词，它会不时更改，并且包含大量不在所有摘要列表中的细节，如果你不了解所有这些细节，可能会给你带来麻烦。

关注各种 iPhone/iOS 开发者论坛，了解开发者偶尔会犯的各种错误，以及有趣的新的或意外的应用被拒绝原因，这也很有帮助。

# c# - 在实体框架 edmx 设计器上查看自定义属性

> ID：10183197
> 
> 赞同：0
> 
> 时间：2012-04-16T23:43:20.487
> 
> 标签：c#, entity-framework

我向部分类添加了一个自定义属性，如下所示：

```
public partial class Survey
{
public IEnumerable<BODSurveys.SurveysAnwer> answers
  {
   get;
   set;
  }
} 
```

我该怎么做才能在设计器中看到自定义属性？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T08:40:52.410

没有。EDMX 设计器仅显示在其内部结构中定义的映射属性。它看不到你在课堂上做了什么。

# mysql - 更好的查询来选择 Count Where

> ID：10183198
> 
> 赞同：0
> 
> 时间：2012-04-16T23:43:32.520
> 
> 标签：mysql, count

我在 Godaddy 托管，他们给了我一个可以理解的问题。我想知道是否有更好的方法来重写此查询我必须使其资源友好：

```
SELECT count(*) as count
FROM 'aaa_db'
WHERE 'callerid' LIKE '16602158641' AND 'clientid'='41' 
```

我有超过 100 万行，并且有重复项，因此我编写了一个小脚本来输出重复项并删除它们，而不是更改表等。

请帮忙。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T00:00:46.517

在 clientid 和 callerid 上有单独的索引会导致 MySQL 只使用一个索引，或者在某些情况下尝试索引合并 (MySQL 5.0+)。这些都没有多列索引那么有效。

`callerid`在和列上创建多列索引`clientid`将减轻 CPU 和磁盘 IO 资源（无表扫描），但会增加磁盘存储和 RAM 使用率。我想你可以试一试，看看 Godaddy 是否更喜欢这个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T00:06:57.647

我要尝试的第一件事是确保您在 clientid 列上有一个索引，然后重写您的查询以首先查找 clientid，这应该从加快查询速度的考虑中删除行。此外，正如 Marcus 所说，添加多列索引会更快，但请记住将其添加为 (clientid, callerid)，因为 mysql 从左到右读取索引。

```
SELECT count(*) as count
FROM aaa_db
WHERE clientid = 41 and callerid LIKE '16602158641'; 
```

请注意，我从 clientid 值中删除了引号，因为它应该是 int 数据类型，如果不是，转换为 int 数据类型也应该更快。另外，我不确定您为什么要在`LIKE`没有通配符运算符的情况下进行操作，如果您可以将其更改为`=`也会有所帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T00:23:14.530

我喜欢 Marcus 的回答，但我会首先尝试在 just 上使用单个索引`callerid`，因为对于像这样的值`16602158641`，一百万中有多少行可以匹配？不是很多，所以单索引可以匹配或超过双索引的性能。

另外，删除`LIKE`并使用`=`：

```
SELECT count(*) as count
FROM aaa_db
WHERE callerid = '16602158641' -- equals instead of like
AND clientid = '41' 
```

# ruby-on-rails - button_to 自定义命名路由返回路由错误

> ID：10183199
> 
> 赞同：0
> 
> 时间：2012-04-16T23:43:33.533
> 
> 标签：ruby-on-rails, ruby-on-rails-3, haml

我正在使用 Rails 3.2.3 和 Haml 3.1.4。

这是我的 routes.rb 与自定义命名路由：

```
resources :netscalers do
  resources :vips
  member do
    post :refresh
  end
end 
```

这是当我运行“rake routes”时，我看到它已定义：

```
refresh_netscaler POST   /netscalers/:id/refresh(.:format)     netscalers#refresh 
```

这是我的观点（app/views/netscalers/index.haml）：

```
= button_to 'refresh vips for ns', :refresh_netscaler 
```

这是我单击“为 ns 刷新 vips”按钮后的错误：

```
Routing Error

No route matches {:action=>"refresh", :controller=>"netscalers"} 
```

我在看什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T23:59:49.060

它应该看起来像

```
= button_to 'refresh vips for ns', refresh_netscaler_path(??) 
```

这 ？？应该用产生 netscaler.id 的东西代替，你没有发布足够的代码来弄清楚什么？应该。

# objective-c - 按下按钮时如何登录到文本文件？

> ID：10183200
> 
> 赞同：0
> 
> 时间：2012-04-16T23:43:37.090
> 
> 标签：objective-c, cocoa, button, logging

我目前正在开发一个小的增量接口。我有两个按钮，`up`和`down`。如果我按下`up`按钮，数字将增加 1，如果我按下`down`按钮，数字将减少 1。

我是 Xcode 的新手，不知道如何创建日志文件或如何记录操作。

例如，如果用户按下向上按钮，我如何创建日志？它应该保存在这样的文本文件中：

```
Number at start: 001 - button pressed: [up], new number: 002; 
```

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T00:33:27.303

初始化您的课程时：

```
NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
NSString *rootPath = [paths objectAtIndex:0];

NSString *logFilePath = [path stringByAppendingPathComponent:@"log.txt"];
if(![fm fileExistsAtPath:logFilePath]) {
  unsigned char data = {' '};
  [fm createFileAtPath:logFilePath contents:[NSData dataWithBytes:&data length:1] attributes:nil];
}

NSFileHandle *logFile = [NSFileHandle fileHandleForUpdatingAtPath:logFilePath]; 
```

然后保留日志文件的句柄，以及何时记录。假设`count`和 `oldCount' 变量具有您当前和以前的计数：

```
NSString *message = [NSString stringWithFormat:@"Number at start: %i - button pressed: [%@], new number: %i\n", oldCount, count > oldCount ? @"up" : @"down", count];
NSData *dataLog = [message dataUsingEncoding: NSUTF8StringEncoding];
[logFile seekToEndOfFile];
[logFile writeData:dataLog]; 
```

# database - 我正在尝试在大量二进制加载后重建 Progress 数据库上的索引，出现此错误

> ID：10183201
> 
> 赞同：1
> 
> 时间：2012-04-16T23:43:44.810
> 
> 标签：database, openedge, progress-db

刚刚使用批处理脚本通过二进制加载将 655 个表导入到 650gb 硬盘驱动器上新创建的数据库中。

idxbuild 带线程运行，最大线程数为 1。(13942) TMB 值为 8，TM 值为 8，SG 值为 48，打包因子为 100。(16141) 临时排序文件位于：C:\Progress\ OpenEdge\bin 将使用可用的磁盘空间。(11443) 系统错误：无法在区域架构区域内扩展数据库。(8897)

我在文档中找不到任何解决方案。

Tom Bascom——我知道你知道解决这个问题的方法。

谢谢社区！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T01:27:28.207

What version of Progress?

As Tim says, that's a very odd place for your temp files. How did that happen? My guess is that your working directory is %DLC%\bin.

You're extending the schema area? Why? Did you forget to move all of your data, indexes and LOBs to type 2 storage?

By eliminating all of the AREA information from the structure file you put everything in the schema area.

You probably also did not create a structure file with multiple extents and so forth? Thus there is just the single initial extent.

It also seems likely that you did not enable large files. Which means that once that extent hits 2GB it cannot grow.

So the quick and easy solution is probably:

```
proutil dbName -C enablelargefiles 
```

Note: this is a terrible way to set setup a database -- don't do it for a real system. But, as I understand it, you are just trying to do a one-time load of this data so that you can export it as CSV data.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T23:52:13.247

从知识库：

> 当数据库存储区域为：
> 
> a.) 完全由固定长度的扩展区组成，最后一个扩展区已被填满，b.) 可变长度扩展区需要超过 2Gig 文件大小限制以适应写入并且尚未启用大文件，或 c.) 当用户达到其 .profile (UNIX) 或磁盘配额限制 (Windows) 中定义的 ulimit
> 
> 在上述任何一种情况下，PROGRESS 运行都会中止，并且必须运行恢复。

* * *

还：

> 必须使数据库增长的更多范围可用。prostrct 实用程序必须用于添加额外的空间。将来，可以监测一个区域中最后一个范围的高水位线，以预警这种情况。完成此操作后，重新启动数据库并允许进行崩溃恢复。

和

> References to Written DocumentationReferences to ProgressManuals:Database Administration Guide and Reference - Chapter 9 "Maintaining the Database Structure"

* * *

Also, why are you pointing your temp space for sorting at the progress bin directory? Point it at an empty temp directory instead.

Use the Temporary Directory (-T) startup parameter to identify or redirect temporary files created by the PROUTIL utility to a specified directory when sorting and handling space issues.

# jquery - 隐藏表行取决于 td （数字）中的数据与 jquery

> ID：10183203
> 
> 赞同：0
> 
> 时间：2012-04-16T23:43:56.733
> 
> 标签：jquery, numbers, hide, html-table

我有一个表，我想隐藏其中有一个 td 值小于 100 的行。例如，我的表看起来像

```
<table>
<tr><td>key</td><td>value</td></tr>
<tr><td>key1</td><td>30</td></tr>
<tr><td>key2</td><td>60</td></tr>
<tr><td>key3</td><td>90</td></tr>
<tr><td>key4</td><td>200</td></tr>
</table> 
```

所以在这个例子中，前 3 行应该被隐藏。我正在使用带有非数字值的 :contains 来执行此操作，但我不确定是否可以使用数字来执行此操作。

我想到的其他选项是为 td 提供一个具有 td 值的属性，并根据属性的值隐藏它们。

就像是

`$('tr td[attr>"100"']).hide();`

但我不确定这是最好的方法，因为我是 jquery 新手

感谢您的输入！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T23:47:08.667

我建议：

```
$('tr td:last-child').each(
    function(){
        if (parseInt($(this).text(),10) <= 100){
             $(this).closest('tr').hide();
        }
    }); 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/PpaUw/2/)。

参考：

*   [`closest()`](http://api.jquery.com/closest/).
*   [`hide()`](http://api.jquery.com/hide/).
*   [`:last-child`选择器](http://api.jquery.com/last-child-selector/)。
*   [`parseInt()`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/parseInt).
*   [`text()`](http://api.jquery.com/text/).

# pyqt - 当从另一个 QMainWindow 调用时，QMainWindow 闪烁并消失

> ID：10183213
> 
> 赞同：2
> 
> 时间：2012-04-16T23:44:31.997
> 
> 标签：pyqt, pyside, qmainwindow

这个相当少的代码创建了一个带有三个右键单击选项的系统托盘项。一个是QDialog的实例，另一个是QMainWindow，还有Quit。它适用于一个系统托盘驱动的应用程序，它将有一些 qdialogs 和一个包含 table 小部件的 qmainwindow（或者，是否可以在 qdialog 中创建一个表？）。我已经坚持了一个星期左右，阅读了很多相关材料，不明白如何解决它。

从系统托盘图标菜单中，单击 QDialog，对话框打开，等待用户操作，然后单击 Ok 或 Cancel 按钮将打印单击了哪一个。看起来这很有效，因为 QDialog 有自己的 exec_()。到目前为止很棒。

但是，单击 QMainWindow 菜单选项，主窗口对话框会短暂出现并消失，用户当然没有机会输入。也许相反，qmainwindow 对话框需要依赖于 QApplication 的 exec_() ，其中对象可能会在 app.exec_() 之前被初始化？如果这样可行，我不清楚 def qmainwindow() 如何从用户那里检索信息。

希望对于知道的人来说是一件简单的事情，一些变化，宾果游戏。

*当前环境：Windows 7 或 XP、Python 2.7、Pyside*

*如果您运行此程序，系统托盘中将有一个可单击（右键单击）的空白占位符，或者您也可以给它一个实际图像来代替“sample.png”。*

```
#!python

from PySide       import QtGui, QtCore
from PySide.QtGui import QApplication, QDialog, QMainWindow

def qdialog():
    qdialog_class_obj = TestClassQDialog()
    qdialog_class_obj.show()
    qdialog_class_obj.exec_()    # wait for user

    print "qdialog_user_action: ", qdialog_class_obj.qdialog_user_action

def qmainwindow():
    qmainwindow_class_obj = TestClassQMainWindow()
    qmainwindow_class_obj.show()
    #qmainwindow_class_obj.exec_()  # 'TestClassQMainWindow' object has no attribute 'exec_'

class TestClassQDialog(QDialog):
    def __init__(self, parent=None):    
        super(TestClassQDialog, self).__init__(parent)
        self.ok_cancel = QtGui.QDialogButtonBox(self)
        self.ok_cancel.setStandardButtons(QtGui.QDialogButtonBox.Ok|QtGui.QDialogButtonBox.Cancel)
        QtCore.QObject.connect(self.ok_cancel, QtCore.SIGNAL("accepted()"), self.button_ok)
        QtCore.QObject.connect(self.ok_cancel, QtCore.SIGNAL("rejected()"), self.button_cancel)

    def button_ok(self):
        self.qdialog_user_action = 'ok'
        self.hide()

    def button_cancel(self):
        self.qdialog_user_action = 'cancel'
        self.hide()

class TestClassQMainWindow(QMainWindow):
    def __init__(self, parent=None):    
        super(TestClassQMainWindow, self).__init__(parent)
        self.ok_cancel = QtGui.QDialogButtonBox(self)
        self.ok_cancel.setStandardButtons(QtGui.QDialogButtonBox.Cancel|QtGui.QDialogButtonBox.Ok)
        QtCore.QObject.connect(self.ok_cancel, QtCore.SIGNAL("accepted()"), self.button_ok)
        QtCore.QObject.connect(self.ok_cancel, QtCore.SIGNAL("rejected()"), self.button_cancel)

    def button_ok(self):
        self.hide()

    def button_cancel(self):
        self.hide()

class SysTrayIcon(QMainWindow):
    def __init__(self, parent=None):
        super(SysTrayIcon, self).__init__(parent)

        self.qdialog_action     = QtGui.QAction("QDialog",     self, triggered=qdialog)
        self.qmainwindow_action = QtGui.QAction("QMainWindow", self, triggered=qmainwindow)
        self.quit_action        = QtGui.QAction("Quit",        self, triggered=QtGui.qApp.quit)

        self.createSystrayIcon()
        self.systrayIcon.show()

    def createSystrayIcon(self):
        self.systrayIconMenu = QtGui.QMenu(self)
        self.systrayIconMenu.addAction(self.qdialog_action)
        self.systrayIconMenu.addAction(self.qmainwindow_action)
        self.systrayIconMenu.addSeparator()
        self.systrayIconMenu.addAction(self.quit_action)
        self.systrayIcon = QtGui.QSystemTrayIcon(self)
        self.systrayIcon.setContextMenu(self.systrayIconMenu)
        self.systrayIcon.setIcon(QtGui.QIcon('sample.png')) # point to a valid image if you want.
        self.systrayIcon.setVisible(True)

if __name__ == '__main__':
    app = QtGui.QApplication([])
    systrayicon = SysTrayIcon()
    app.exec_() 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T01:56:10.743

我已经让它工作了。我所做的是将您的外部方法移到您的`qmainwindow`内部 `SysTrayIcon`并创建了类参数`self.qmainwindow_class_obj = TestClassQMainWindow()`。我在下面附上了工作代码。另外，您使用的是旧式信号槽方法，我认为您来自老式 PyQt。新方法非常好，干净和pythonic。我还将新样式方法放在下面的代码中。我要做的另一件事是将您的`qdialog`方法移动到`SysTrayIcon`类中。我真的不明白你为什么在课外有它，但也许我错过了一些东西。希望这可以帮助。

```
#!python

from PySide       import QtGui, QtCore
from PySide.QtGui import QApplication, QDialog, QMainWindow

def qdialog():
    qdialog_class_obj = TestClassQDialog()
    qdialog_class_obj.show()
    qdialog_class_obj.exec_()    # wait for user
    print "qdialog_user_action: ", qdialog_class_obj.qdialog_user_action

class TestClassQDialog(QDialog):
    def __init__(self, parent=None):    
        super(TestClassQDialog, self).__init__(parent)
        self.ok_cancel = QtGui.QDialogButtonBox(self)
        self.ok_cancel.setStandardButtons(QtGui.QDialogButtonBox.Ok|QtGui.QDialogButtonBox.Cancel)        
        self.ok_cancel.accepted.connect(self.button_ok)
        self.ok_cancel.rejected.connect(self.button_cancel)

    def button_ok(self):
        self.qdialog_user_action = 'ok'
        self.hide()

    def button_cancel(self):
        self.qdialog_user_action = 'cancel'
        self.hide()

class TestClassQMainWindow(QMainWindow):
    def __init__(self, parent=None):    
        super(TestClassQMainWindow, self).__init__(parent)
        self.ok_cancel = QtGui.QDialogButtonBox(self)
        self.ok_cancel.setStandardButtons(QtGui.QDialogButtonBox.Cancel|QtGui.QDialogButtonBox.Ok)
        self.ok_cancel.accepted.connect(self.button_ok)
        self.ok_cancel.rejected.connect(self.button_cancel)

    def button_ok(self):
        self.hide()

    def button_cancel(self):
        self.hide()

class SysTrayIcon(QMainWindow):
    def __init__(self, parent=None):
        super(SysTrayIcon, self).__init__(parent)

        self.qmainwindow_class_obj = TestClassQMainWindow()

        self.qdialog_action     = QtGui.QAction("QDialog",     self, triggered=qdialog)
        self.qmainwindow_action = QtGui.QAction("QMainWindow", self, triggered=self.qmainwindow)
        self.quit_action        = QtGui.QAction("Quit",        self, triggered=QtGui.qApp.quit)

        self.createSystrayIcon()
        self.systrayIcon.show()

    def createSystrayIcon(self):
        self.systrayIconMenu = QtGui.QMenu(self)
        self.systrayIconMenu.addAction(self.qdialog_action)
        self.systrayIconMenu.addAction(self.qmainwindow_action)
        self.systrayIconMenu.addSeparator()
        self.systrayIconMenu.addAction(self.quit_action)
        self.systrayIcon = QtGui.QSystemTrayIcon(self)
        self.systrayIcon.setContextMenu(self.systrayIconMenu)
        self.systrayIcon.setIcon(QtGui.QIcon('linux.jpeg')) # point to a valid image if you want.
        self.systrayIcon.setVisible(True)

    def qmainwindow(self):
        self.qmainwindow_class_obj.show()

if __name__ == '__main__':
    app = QtGui.QApplication([])
    systrayicon = SysTrayIcon()
    app.exec_() 
```

# ios - 为什么（或何时）我的应用会被 iOS 重置？

> ID：10183225
> 
> 赞同：0
> 
> 时间：2012-04-16T23:46:27.410
> 
> 标签：ios, reset, null

有什么理由让我的应用程序完全被 iPhone 重置？

我有一个计时器应用程序，其中包含带有每个计时器通知的计时器。有时，（可能与手机充电有关）应用程序会完全重置，所有计时器都会停止并重置，就好像该应用程序以前从未运行过一样。

应用程序是否有时会接到 nil-out 的调用？我是否应该存储计时器开始时间和一个 BOOL 表示计时器正在 NSUserDefaults （或类似）中运行？

提前致谢，

迈克尔。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T23:48:13.330

应用程序可以随时被操作系统和用户杀死***，***从而让我们的开发人员一直担心像你这样的硬数据。如果必须，请将其保存到 NSUserDefault 以便下次启动您的应用程序。

# java - 在贝塞尔剪裁中计算距离函数时遇到问题

> ID：10183230
> 
> 赞同：3
> 
> 时间：2012-04-16T23:47:21.520
> 
> 标签：java, graphics, geometry, processing, bezier

[我正在尝试实现一种称为贝塞尔剪裁的曲线相交算法，该算法在本文](http://processingjs.nihongoresources.com/bezierinfo/#clipping_fl)末尾的一节中进行了描述（尽管本文称其为“粗线剪裁”）。我一直在阅读示例的文章和源代码（可[在此处](http://processingjs.nihongoresources.com/bezierinfo/sketchsource.php?sketch=cubicFatLine1)获得）。

注意：其他来源包括[本文](http://www.tsplines.com/technology/edu/CurveIntersection.pdf)。如果我能找到它们，将发布更多内容。

该算法的核心部分是计算曲线 1 和曲线 2 的“基线”（曲线 2 的一个端点到另一个端点的线）之间的“距离函数”。所以我有一些东西可以比较我的结果，我使用了第一个示例源代码中的曲线。我设法从示例中复制了距离函数的*形状，但函数的距离位置已关闭。*在尝试另一条曲线时，距离函数与其他两条曲线相去甚远，尽管两条曲线明显相交。我可能对这个算法的工作很天真，但我认为这会导致没有检测到交叉点。

据我了解（这很可能是错误的），定义距离函数的过程涉及以**x *a + y* b + c = 0**的形式表示曲线 2 的基线，其中**a ² + b ² = 1**。系数是通过以**y = u *x + v****的形式重新排列线的项来获得的，其中**u**等于斜率，x 和 y 是基线上的任意点。可以重新排列公式以给出**v**：**v = y - u*** **x**。再次重新排列公式，我们得到**-u*x + 1*y - v = 0**，其中**a = -u**，**b = 1**，并且**c = -v**。为了确保条件**a ² + b ² = 1**，系数除以**Math.sqrt(u *u + 1)****的标量。然后将线的这种表示代入另一条曲线的函数（与基线无关的曲线）以获得距离函数。此距离函数表示为贝塞尔曲线，其中**y [i] = a*** **P [i x] + b*P [i y] + c**和**x [i] = (1 - t) *x1 + t* x2**，其中**t**等于**0、1/3、2 /3**和**3**米**x1****x2**是基线的端点，P **i[是]**曲线 1 的控制点。

下面是与计算距离函数有关的示例程序（用语言处理编写）的一些源代码，奇怪的是，它使用与上述段落略有不同的方法来计算基线的替代表示。

```
/**
 * Set up four points, to form a cubic curve, and a static curve that is used for intersection checks
 */
void setupPoints()
{
points = new Point[4];
points[0] = new Point(85,30);
points[1] = new Point(180,50);
points[2] = new Point(30,155);
points[3] = new Point(130,160);

curve = new Bezier3(175,25,  55,40,  140,140,  85,210);
curve.setShowControlPoints(false);
}

...

flcurve = new Bezier3(points[0].getX(), points[0].getY(),
                                        points[1].getX(), points[1].getY(),
                                        points[2].getX(), points[2].getY(),
                                        points[3].getX(), points[3].getY());

...

void drawClipping()
{
    double[] bounds = flcurve.getBoundingBox();

    // get the distances from C1's baseline to the two other lines
    Point p0 = flcurve.points[0];
    // offset distances from baseline
    double dx = p0.x - bounds[0];
    double dy = p0.y - bounds[1];
    double d1 = sqrt(dx*dx+dy*dy);
    dx = p0.x - bounds[2];
    dy = p0.y - bounds[3];
    double d2 = sqrt(dx*dx+dy*dy);

    ...

    double a, b, c;
a = dy / dx;
b = -1;
c = -(a * flcurve.points[0].x - flcurve.points[0].y);
// normalize so that a² + b² = 1
double scale = sqrt(a*a+b*b);
a /= scale; b /= scale; c /= scale;     

// set up the coefficients for the Bernstein polynomial that
// describes the distance from curve 2 to curve 1's baseline
double[] coeff = new double[4];
for(int i=0; i<4; i++) { coeff[i] = a*curve.points[i].x + b*curve.points[i].y + c; }
double[] vals = new double[4];
for(int i=0; i<4; i++) { vals[i] = computeCubicBaseValue(i*(1/3), coeff[0], coeff[1], coeff[2], coeff[3]); }

translate(0,100);

...

// draw the distance Bezier function
double range = 200;
for(float t = 0; t<1.0; t+=1.0/range) {
    double y = computeCubicBaseValue(t, coeff[0], coeff[1], coeff[2], coeff[3]);
    params.drawPoint(t*range, y, 0,0,0,255); }

...

translate(0,-100);
}

...

/**
 * compute the value for the cubic bezier function at time=t
 */
double computeCubicBaseValue(double t, double a, double b, double c, double d) {
double mt = 1-t;
return mt*mt*mt*a + 3*mt*mt*t*b + 3*mt*t*t*c + t*t*t*d; } 
```

这是我为重新创建上述代码而编写的类（javax.swing.JPanel 的扩展）：

```
package bezierclippingdemo2;

import java.awt.BasicStroke;
import java.awt.Color;
import java.awt.Graphics;
import java.awt.Graphics2D;

import javax.swing.JPanel;

public class ReplicateBezierClippingPanel extends JPanel {

CubicCurveExtended curve1, curve2;

public ReplicateBezierClippingPanel(CubicCurveExtended curve1, CubicCurveExtended curve2) {

    this.curve1 = curve1;
    this.curve2 = curve2;

}

public void paint(Graphics g) {

    super.paint(g);
    Graphics2D g2d = (Graphics2D) g;
    g2d.setStroke(new BasicStroke(1));
    g2d.setColor(Color.black);
    drawCurve1(g2d);
    drawCurve2(g2d);
    drawDistanceFunction(g2d);

}

public void drawCurve1(Graphics2D g2d) {

    double range = 200;

    double t = 0;

    double prevx = curve1.x1*(1 - t)*(1 - t)*(1 - t) + 3*curve1.ctrlx1*(1 - t)*(1 - t)*t + 3*curve1.ctrlx2*(1 - t)*t*t + curve1.x2*t*t*t;
    double prevy = curve1.y1*(1 - t)*(1 - t)*(1 - t) + 3*curve1.ctrly1*(1 - t)*(1 - t)*t + 3*curve1.ctrly2*(1 - t)*t*t + curve1.y2*t*t*t;

    for(t += 1.0/range; t < 1.0; t += 1.0/range) {

        double x = curve1.x1*(1 - t)*(1 - t)*(1 - t) + 3*curve1.ctrlx1*(1 - t)*(1 - t)*t + 3*curve1.ctrlx2*(1 - t)*t*t + curve1.x2*t*t*t;
        double y = curve1.y1*(1 - t)*(1 - t)*(1 - t) + 3*curve1.ctrly1*(1 - t)*(1 - t)*t + 3*curve1.ctrly2*(1 - t)*t*t + curve1.y2*t*t*t;

        g2d.draw(new LineExtended(prevx, prevy, x, y));

        prevx = x;
        prevy = y;

    }

}

public void drawCurve2(Graphics2D g2d) {

    double range = 200;

    double t = 0;

    double prevx = curve2.x1*(1 - t)*(1 - t)*(1 - t) + 3*curve2.ctrlx1*(1 - t)*(1 - t)*t + 3*curve2.ctrlx2*(1 - t)*t*t + curve2.x2*t*t*t;
    double prevy = curve2.y1*(1 - t)*(1 - t)*(1 - t) + 3*curve2.ctrly1*(1 - t)*(1 - t)*t + 3*curve2.ctrly2*(1 - t)*t*t + curve2.y2*t*t*t;

    for(t += 1.0/range; t < 1.0; t += 1.0/range) {

        double x = curve2.x1*(1 - t)*(1 - t)*(1 - t) + 3*curve2.ctrlx1*(1 - t)*(1 - t)*t + 3*curve2.ctrlx2*(1 - t)*t*t + curve2.x2*t*t*t;
        double y = curve2.y1*(1 - t)*(1 - t)*(1 - t) + 3*curve2.ctrly1*(1 - t)*(1 - t)*t + 3*curve2.ctrly2*(1 - t)*t*t + curve2.y2*t*t*t;

        g2d.draw(new LineExtended(prevx, prevy, x, y));

        prevx = x;
        prevy = y;

    }

}

public void drawDistanceFunction(Graphics2D g2d) {

    double a = (curve1.y2 - curve1.y1)/(curve1.x2 - curve1.x1);
    double b = -1;
    double c = -(a*curve1.x1 - curve1.y1);

    double scale = Math.sqrt(a*a + b*b);

    a /= scale;
    b /= scale;
    c /= scale;

    double y1 = a*curve2.x1 + b*curve2.y1 + c;
    double y2 = a*curve2.ctrlx1 + b*curve2.ctrly1 + c;
    double y3 = a*curve2.ctrlx1 + b*curve2.ctrly2 + c;
    double y4 = a*curve2.x2 + b*curve2.y2 + c;

    double range = 200;
    double t = 0;
    double prevx = t*range;
    double prevy = (1 - t)*(1 - t)*(1 - t)*y1 + 3*(1 - t)*(1 - t)*t*y2 + 3*(1 - t)*t*t*y3 + t*t*t*y4;

    for(t += 1.0/range; t < 1.0; t += 1.0/range) {

        double x = t*range;
        double y = (1 - t)*(1 - t)*(1 - t)*y1 + 3*(1 - t)*(1 - t)*t*y2 + 3*(1 - t)*t*t*y3 + t*t*t*y4;

        g2d.draw(new LineExtended(prevx, prevy, x, y));

        prevx = x;
        prevy = y;

    }
}

} 
```

其中 CubicCurveExtended 和 LineExtended 是 java.awt.geom.CubicCurve2D.Double 和 java.awt.geom.Line2D.Double 的次要扩展。在将曲线传递到构造函数之前，曲线会均匀旋转，因此曲线 1 的端点是水平的，导致基线的斜率为零。

对于曲线 1 的输入 (485, 430, 580, 60, 430, 115, 530, 160) 和曲线 2 的 (575, 25, 455, 60, 541, 140, 486, 210)（请记住，这些值以curve1的端点之间的负角旋转），结果如下图（距离函数是在距离处相对平滑的曲线）：

![在此处输入图像描述](../Images/44d29b32238f7bc017b8c7a931c00db0.png)

我真的不确定我做错了什么。y 值似乎以正确的模式排列，但与它所基于的两条曲线相距甚远。我意识到有可能我有可能沿着曲线而不是基线以间隔排列 x 值，但是 y 值是我真正感到困惑的。如果有人可以看看这个并解释我做错了什么，我会非常感激。感谢您花时间阅读这个相当冗长的问题。如果需要更多细节，请随时在评论中告诉我。

更新：我已经测试了我计算的线的表示。a *x + b* y + c = 0 表示显然仍然代表同一行，因为我仍然可以插入 x1 并获得 y1。此外，对于插入函数的任意两个坐标对，f(x, y) = 0 成立。此外，我发现文章中描述的表示和源代码中实际使用的表示可以互换地表示同一行。从这一切来看，我可以假设问题不在于计算线。额外的兴趣点

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T05:51:14.063

您的距离函数不一定在您的两条原始曲线附近：它使用完全不同的坐标系，即 t vs D，而不是使用 x 和 y 的原始曲线。[编辑] 即 t 仅上升到 1.0，并测量沿曲线的总长度的比率，D 测量曲线 2 与曲线 1 基线的距离。

此外，当您说“curve1 和curve2 的“基线”之间的“距离函数””时，我认为您在这里混淆了curve1 和curve2，就像在您的代码中一样，您显然使用的是curve1 的基线。

该算法还假设“每条贝塞尔曲线都完全包含在连接所有起点/控制/终点的多边形中，称为其“凸包””，在您的情况下，[编辑]curve1是一个三角形，其中控制第二个起始值的点不是顶点。我不确定这如何影响算法。

否则，看起来您的距离计算很好（尽管您确实可以稍微优化一下:)）。

# jquery - 如何知道 jQuery 是否完全加载？

> ID：10183237
> 
> 赞同：0
> 
> 时间：2012-04-16T23:48:41.770
> 
> 标签：jquery, jquery-mobile

我在 android 上，因为我很懒，所以我将 jquery 加载到 webview 中来操作 DOM。

我加载了我的 webview，直到没有定义 jQuery，我有一个加载屏幕来指示用户他不能做任何事情。

```
if(info.equalsIgnoreCase("undefined")) 
```

信息是 typeof(jQuery)。他一开始是未定义的，大约 1 秒后它被定义了，但是 SURPRISE ！你没有所有的功能...

说明：就在定义 jQuery 之后，我尝试了一个 jQuery('body').remove()... 我需要等待大约 4 秒后才能执行此操作。但是如果我只是想改变我身体的背景，它会立即起作用。

我的问题是：如何知道 jQuery 何时完全加载？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T23:52:38.050

为什么不直接使用[ready()](http://api.jquery.com/ready/)来确定目标选择器何时可用？

```
$(document).ready(function() {
  // load things
}); 
```

另一种选择是填充正文的 onload 事件以在文档正文完成加载时触发，确保在正文中包含 jQuery：

```
<body onload="fireItUp();">
  <script src="/path/to/jquery.js"></script>
  <script>
  window.fireItUp = function() {
    // load things
  }
  </script>
</body> 
```

丑陋，但实用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T23:52:53.000

一旦`jQuery`可用，您*就*拥有了所有可用的方法。

您需要等待 DOM 准备就绪。

```
$(function() {
    // DOM may be manipulated here.
}); 
```

# iphone - 在 iPhone 上放大 Youtube 视频？

> ID：10183239
> 
> 赞同：0
> 
> 时间：2012-04-16T23:48:49.563
> 
> 标签：iphone, video

在 iPhone 上播放 Youtube 视频（通过 webview 启动）时，如何以编程方式控制缩放和偏移以仅关注屏幕的特定部分？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T00:03:42.410

一点也不——你不能那样做。

# android - Ui 没有出现在 Ice Cream Sandwitch 上

> ID：10183240
> 
> 赞同：0
> 
> 时间：2012-04-16T23:48:49.847
> 
> 标签：android, user-interface, android-activity, android-4.0-ice-cream-sandwich, background-foreground

我有在冰淇淋三明治诞生之前就可以使用的代码。但似乎现在我对这个孩子有问题。

```
Intent intent=new Intent(this, com.myUI.class)
intent.addFlags(Intent.FLAG_ACTIVITY_SINGLE_TOP 
            | Intent.FLAG_ACTIVITY_REORDER_TO_FRONT);
startActivity(intent); 
```

顺便说一句，我试图在通话结束后将我的 UI 放在前台。我的应用程序自动拨号并假设在拨号器完成呼叫后显示自己的 UI，或者至少到目前为止它没有任何问题。

伙计们，我做错了什么，我应该怎么做才能解决它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T12:26:50.970

我有同样的问题，并已更改为下面的代码。似乎运作良好。

```
PackageManager pm = context.getPackageManager();
Intent intent = pm.getLaunchIntentForPackage(context.getPackageName());
intent.addFlags( Intent.FLAG_ACTIVITY_REORDER_TO_FRONT );
context.startActivity(intent); 
```

希望有帮助

# ios - segues：调用序列的控制器实例会发生什么？

> ID：10183241
> 
> 赞同：1
> 
> 时间：2012-04-16T23:49:08.753
> 
> 标签：ios, storyboard, segue, uistoryboard

起初我不太相信 segues（因为如果设置不正确会导致崩溃，而且我不清楚引擎盖下发生了什么），但我发现我更多地使用它们。我仍然不完全“了解”正在发生的事情。

我在 ViewController A 和 ViewController B 之间有一个不涉及 UINavigationController 的 segue。它做了一个 FlipHorizo​​ntal 过渡，我喜欢。

当 A 启动 segue 时，A 实例会发生什么？我在 A 的方法中放了一条日志语句，`viewDidUnload`它没有被调用。那么A还潜伏着吗？我希望能够继续回到 A 的同一个实例，并且它的所有变量都完好无损，但我无法弄清楚如何做到这一点。

作为测试，我将 A 嵌入到导航控制器中，并尝试了对 B 的转场和推送——但无法回到我的 A 实例。我在这里搞砸了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T01:18:14.280

记住视图和控制器之间的区别。调用控制器仍然存在，它的视图也是如此。但是，任何不在屏幕上的 VIEW 都可以被系统卸载。那是 viewDidUnload 将被调用的时候。

基本上，一个控制器，就像所有其他对象一样，一直存在，直到所有对它的引用都消失了。此外，控制器拥有的任何东西也仍然存在。然而，当它还活着的时候，它会收到两条重要的信息，告诉它“摆脱任何你不需要或可以重建的东西”。

其中之一是 viewDidUnload。另一个是 didReceiveMemoryWarning。

所以，是的，如果你在 NavController 深处有一个堆栈 100 个视图控制器，那么所有 100 个视图控制器仍然存在……尽管它们的某些视图可能不是。

# java - 标准方法名称，为什么 println 中的 l 不是大写？

> ID：10183242
> 
> 赞同：2
> 
> 时间：2012-04-16T23:49:12.093
> 
> 标签：java, standards, convention

我已经用 Java 编程 6 周了，想知道为什么在 println 中 l 是小写的，但在大多数其他方法中，每个单词都以大写字母开头。

这是因为 line 被缩写了吗？在命名方法时是否有一套我应该注意的标准。我已经查看了 Sun 标准，但在任何地方都找不到关于将缩写词的第一个字母小写的规则......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T00:12:30.220

如果你足够努力的话，还有许多其他更令人不快的不一致之处。命名标准建议永远不应该有大写字母，即使是缩写。 `Uri`, `Url`, `UrlConnection`,`HttpClient`是案例的预期名称。

不幸的是，改变它们不太可能值得付出努力？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-16T23:51:13.937

这是因为`println`在 Java 之前就已经存在了

# apache - Apache 2.0.61 没有开始缺少 libaprutil-0.so.0，但它存在

> ID：10183244
> 
> 赞同：1
> 
> 时间：2012-04-16T23:50:16.637
> 
> 标签：apache

我们在启动 Apache 时遇到了这个问题。Apache的版本是：2.0.61。

我们面临的错误如下：

/home/ndipiazza/apache-2.0/bin/rotatelogs：加载共享库时出错：libaprutil-0.so.0：无法打开共享对象文件：没有这样的文件或目录

但是，您可以从以下命令中看到该文件确实存在：

```
[ /home/ndipiazza/apache-2.0/bin ]
ndipiazza@mybox > ldd /home/ndipiazza/apache-2.0/bin/httpd
        linux-vdso.so.1 => (0x00007fffe3de3000)
        libssl.so.0.9.8 => /usr/lib64/libssl.so.0.9.8 (0x00007f0a55c61000)
        libcrypto.so.0.9.8 => /usr/lib64/libcrypto.so.0.9.8 (0x00007f0a558e5000)
        libaprutil-0.so.0 => /home/ndipiazza/apache-2.0/lib/libaprutil-0.so.0 (0x00007f0a556cd000)
        libexpat.so.0 => /home/ndipiazza/apache-2.0/lib/libexpat.so.0 (0x00007f0a554a7000)
        libapr-0.so.0 => /home/ndipiazza/apache-2.0/lib/libapr-0.so.0 (0x00007f0a5527e000)
        librt.so.1 => /lib64/librt.so.1 (0x00007f0a55075000)
        libm.so.6 => /lib64/libm.so.6 (0x00007f0a54e1f000)
        libcrypt.so.1 => /lib64/libcrypt.so.1 (0x00007f0a54be3000)
        libnsl.so.1 => /lib64/libnsl.so.1 (0x00007f0a549cb000)
        libpthread.so.0 => /lib64/libpthread.so.0 (0x00007f0a547ae000)
        libdl.so.2 => /lib64/libdl.so.2 (0x00007f0a545a9000)
        libc.so.6 => /lib64/libc.so.6 (0x00007f0a5424b000)
        libz.so.1 => /lib64/libz.so.1 (0x00007f0a54035000)
        /lib64/ld-linux-x86-64.so.2 (0x00007f0a55ec3000)
[ /home/ndipiazza/apache-2.0/lib ]
ndipiazza@mybox > ll
total 3764
-rw-r----- 1 nddsrvr ndd 7891 2012-03-29 09:04 apr.exp
-rw-r----- 1 nddsrvr ndd 3692 2012-03-29 09:04 aprutil.exp
-rw-r--r-- 1 nddsrvr ndd 1124092 2012-03-29 09:04 libapr-0.a
-rw-r----- 1 nddsrvr ndd 851 2012-03-29 09:04 libapr-0.la
lrwxrwxrwx 1 nddsrvr ndd 18 2012-03-29 09:04 libapr-0.so -> libapr-0.so.0.9.16
lrwxrwxrwx 1 nddsrvr ndd 18 2012-03-29 09:04 libapr-0.so.0 -> libapr-0.so.0.9.16
-rwxr-x--x 1 nddsrvr ndd 614060 2012-03-29 09:04 libapr-0.so.0.9.16
-rw-r--r-- 1 nddsrvr ndd 622102 2012-03-29 09:04 libaprutil-0.a
-rw-r----- 1 nddsrvr ndd 841 2012-03-29 09:04 libaprutil-0.la
lrwxrwxrwx 1 nddsrvr ndd 22 2012-03-29 09:04 libaprutil-0.so -> libaprutil-0.so.0.9.16
lrwxrwxrwx 1 nddsrvr ndd 22 2012-03-29 09:04 libaprutil-0.so.0 -> libaprutil-0.so.0.9.16
-rwxr-x--x 1 nddsrvr ndd 344948 2012-03-29 09:04 libaprutil-0.so.0.9.16
-rw-r--r-- 1 nddsrvr ndd 687836 2012-03-29 09:04 libexpat.a
-rwxr-xr-x 1 nddsrvr ndd 811 2012-03-29 09:04 libexpat.la
lrwxrwxrwx 1 nddsrvr ndd 17 2012-03-29 09:04 libexpat.so -> libexpat.so.0.1.0
lrwxrwxrwx 1 nddsrvr ndd 17 2012-03-29 09:04 libexpat.so.0 -> libexpat.so.0.1.0
-rwxr-xr-x 1 nddsrvr ndd 404946 2012-03-29 09:04 libexpat.so.0.1.0 
```

我们尝试了

```
export LD_LIBRARY_PATH=/home/ndipiazza/apache-2.0/lib:$LD_LIBRARY_PATH 
```

然后启动apache，但这并没有解决问题。

我们能做什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T21:33:05.403

我们发现像这样的早期版本的 Apache 2 有时会在从 rotatelogs 进程中获取 LD_LIBRARY_PATH 导出时出现问题。

我们没有使用 rotatelogs 来轮换日志，而是使用了自定义脚本 custom_rotatelogs.sh：

```
#!/bin/sh
export LD_LIBRARY_PATH=/home/ndipiazza/apache-2.0/lib:$LD_LIBRARY_PATH
rotatelogs $1 $2 $3 $4 $5 
```

这运作良好。

# c# - 处理带有不准确自然语言字符串的命令

> ID：10183245
> 
> 赞同：0
> 
> 时间：2012-04-16T23:50:23.543
> 
> 标签：c#, .net, nlp

我们正在设计一个可以接受这种格式命令的系统

```
command context 
```

上下文是从大约 200 个单词元组的列表中定义的，例如：

```
physical therapy
cardiac
physician visit
hospital inpatient
hospital outpatient
etc. 
```

我们希望系统能够纠正用户错误，例如拼写错误，同时也能理解“物理治疗”与“物理治疗师”相同，并且接受同义词

最后，如果不是完全匹配，它应该要求用户消除最佳匹配之间的歧义

这就是我的想法：

1.  词干上下文词和传入查询
2.  从查询中删除/隔离命令字符串
3.  检查并更正任何字谜（但是：这仅涵盖一类拼写错误）
4.  寻找完全匹配的单词
5.  寻找“近距离匹配”

这感觉不是一个巧妙的解决方案，尤其是第 3 步和第 5 步。

有什么更好/更简单的方法来做到这一点？任何在 C# 中执行此操作的库，奖金。

Lucene 可以做到这一点吗？任何指导表示赞赏。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T23:55:26.380

对于您的目的而言，它可能过于不精确，但[Soundex](http://en.wikipedia.org/wiki/Soundex)是一种常用算法，用于判断两个单词是否“听起来相似”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T20:30:46.503

我认为 Lucene 最好只应用于第 4 步和第 5 步，因为 Lucene 目前仅支持“glob”意义上的近似匹配（通配符——“？”用于匹配单个字符，“*”用于匹配多个字符）。

有一整套关于近似匹配的文献——我将从[agrep](http://en.wikipedia.org/wiki/Agrep)工作开始，然后从那里开始（但部分是因为我熟悉 agrep）。

# php - Oracle SQL 合并查询在 GUI 中工作，在 PHP 脚本中失败

> ID：10183251
> 
> 赞同：0
> 
> 时间：2012-04-16T23:51:31.237
> 
> 标签：php, oracle

我的应用程序代码中有一个无法运行的 Oracle 合并查询。但是，当我回显查询并在 sqldeveloper 中运行它时，它运行良好。奇怪的是，我只有合并查询的这个问题；使用直接插入查询，一切正常。

代码示例：

```
$sql = "merge into table1 c using (select '$value' as value from table1  where ROWNUM=1) cd
    on (c.value = cd.value)
    when matched then
       update set c.col1 = '$col1val', c.col2= '$col2val'
    when not matched then
        insert (c.col2, c.col2, c.col3)
    values ('$col1val', '$col2val', '$col3val')";

$stid = oci_parse($conn, $sql); 
$result = oci_execute($stid);

//Checking to see if it ran properly
if(!$result)
{
  echo "query failed:  $sql";
}

echo $sql;  //If I copy what gets echoed onto the screen into my db gui and run it, I get '1 row merged' with no warnings or errors 
```

在上面的代码片段中，我总是得到“查询失败”语句。另外，当我检查数据库时，我注意到没有执行任何更新或插入。相反，如果我要将合并查询更改为直接插入查询，例如：

```
$sql = "insert into table1 (col1, col2, col3) 
        values ('$col1val', '$col2val', '$col3val')";
$stid = oci_parse($conn, $sql); 
$result = oci_execute($stid);

//Checking to see if it ran properly
if(!$result)
{
  echo "query failed:  $sql";
} 
```

然后它根本不会失败。我没有得到“查询失败”，我看到数据库表中的新行。

我不知道为什么这只发生在合并查询中。作为参考，我使用的是 Oracle 10g 和 PHP 5。任何帮助将不胜感激。谢谢。

****** *** ** *** ****找到答案****** ** *** ** *******

 **正如 Roger 指出的那样，查询需要被绑定。这就是我解决问题的方式：

```
//REMOVE  single quoted variable ('$var') and used binding instead (:val)
$sql = "merge into table1 c using (select :value as value from table1  where ROWNUM=1) cd
    on (c.value = cd.value)
    when matched then
       update set c.col1 = :col1val, c.col2= :col2val
    when not matched then
        insert (c.col2, c.col2, c.col3)
    values (:col1val, :col2val, :col3val)";

$stid = oci_parse($conn, $sql); 

//BIND VALUES
oci_bind_by_name($stid, ":col1val", $col1val);
oci_bind_by_name($stid, ":col2val", $col2val);    
oci_bind_by_name($stid, ":col3val", $col3val);

$result = oci_execute($stid); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T12:14:11.267

在某些操作系统中，您需要以某种方式转义特殊字符，例如“$”，另一件要检查的事情是，如果操作系统在多行上存在 sql 问题，那么您可能需要在其中构建一个包含 SQL 的字符串。**

# java - 高效部署相同 WAR 的多个实例（不同的上下文，相同的容器）

> ID：10183255
> 
> 赞同：11
> 
> 时间：2012-04-16T23:52:04.133
> 
> 标签：java, tomcat, glassfish, jetty, war

我有一个 WAR（app.war）和一个容器（Tomcat、Jetty、Glassfish 等等）。我的目标是按需在容器上部署数百个相同 Web 应用程序的实例。

```
http://foo/app1 --> app.war
http://foo/app2 --> app.war
http://foo/app3 --> app.war 
...
http://foo/appN --> app.war 
```

实现这一目标的一些明显方法：

*   在 Tomcat 中，为每个应用程序（名为 appN.xml）创建一个 context.xml 文件，所有文件都指向同一个 WAR。其他容器也有类似的方法
    *   这种方法的问题：它会爆炸WAR N次，占用大量磁盘空间
*   使用符号链接创建 webapp/{app1,app2,appN} 文件夹，指向 app.war 的扩展版本。这可以防止磁盘空间爆炸，但是 JVM 仍然将许多重复的 JAR 加载到内存中
*   使用一些共享 lib 文件夹来包含大多数 jars（以及前两个选项的组合）。

我想知道是否有更好的方法来做到这一点。理想情况下，创建一个新实例不应该占用更多的磁盘空间（除了边缘配置文件），并且只占用与线程执行堆栈和其他运行时分配相关的内存。

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-17T17:56:52.693

Jetty 通过所谓的叠加层增加了对您正在寻找的内容的支持。

[http://wiki.eclipse.org/Jetty/Tutorial/Configuring_the_Jetty_Overlay_Deployer](http://wiki.eclipse.org/Jetty/Tutorial/Configuring_the_Jetty_Overlay_Deployer)

从wiki页面复制一点：

*   您可以保持 WAR 文件不可变，甚至已签名，以便清楚您部署了哪个版本。
*   您为自定义/配置 Web 应用程序所做的所有修改都是单独的 WAR，因此很容易识别，以便查看和迁移到新版本。
*   您可以创建一个参数化模板覆盖，其中包含适用于 Web 应用程序的许多实例（例如，用于多租户部署）的常见自定义和配置。
*   因为分层部署清楚地识别了通用和实例特定的组件，Jetty 能够为模板共享类加载器和静态资源缓存，大大减少了多个实例的内存占用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T09:07:22.440

抱歉有点跑题了，但在我看来，您的场景大喊“多租户”应用程序，因此您有一个应用程序可以为多个“租户”（客户）提供服务。

对于多租户设置，必须考虑以下注意事项：

*   客户不能访问彼此的数据（如果他们的数据存储在相同的数据库、相同的模式并使用“鉴别器”字段来分隔数据）。这可以通过使用带有[访问控制列表的 Spring Security 来实现](http://static.springsource.org/spring-security/site/docs/3.0.x/reference/domain-acls.html)
*   Hibernate从 4.0 版开始内置了[对多租户应用程序的支持。](https://community.jboss.org/wiki/Multi-tenancyDesign)
*   这两个 SO 问题也可能有用
    *   [使用多个数据源时 Spring 中的多个实体管理器问题](https://stackoverflow.com/questions/3731016/multiple-entity-manager-issue-in-spring-when-using-more-than-one-datasource/6796136#6796136)（用于使用不同的数据源（不同的数据库或每个客户在同一数据库上的不同模式）。
    *   [Java EE 6 中的多租户支持](https://stackoverflow.com/questions/6478370/multi-tenancy-support-in-java-ee-6)

多租户的好处：

*   共享代码意味着为一个客户修复的错误对所有人都已修复（如果不同的客户对什么构成错误和什么构成功能有不同的看法，这也可能是一个缺点）。
*   集群部署可以在客户之间分担负载（但是，需要确保峰值容量可供所有客户使用）。

缺点：

*   代码将变得更加复杂，因为查询需要确保客户之间的“区别”有效，而不会意外地将客户暴露给彼此的数据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T01:07:37.390

您可以在前端配置 Apache (mod_proxy/mod_proxy_ajp) 以将命名虚拟主机指向部署在 Tomcat 上的单个 WAR。您的应用程序应该以服务所有请求的方式设计/编写——每个网站名称的特定配置可以存储在数据库中或作为应用程序中的配置文件——您的应用程序只需要探测用户的请求域名即可确保应用正确的设置（每个会话一次）。一般来说，您应该能够通过一个应用程序解决此问题。伟大的开发者都是懒惰的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-17T01:34:16.960

好吧，如果这是用于实验，那么您列出的任何方法都可以使用。

如果这是用于生产，那么我建议不要这样做。虽然我没有测试所有容器，但我使用过的容器让我相信，简单地为无头虚拟机提供容器会更有弹性。Linux VM 可以非常小，使用 VM 技术，您可以根据需要添加或减少任意数量的实例。

如果您真的想要一个动态增长的解决方案，那么您应该寻求消除单点故障，而不是尝试将您的整个世界集中在一起。

如果您确实需要“高达第二”的负载扩展/收缩，那么您应该查看 AWS 或 CloundFoundry。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-17T01:58:42.883

如果您使用的是 Jetty，则可以通过编程方式添加上下文。

```
WebAppContext webapp = new WebAppContext();
webapp.setBaseResource(myBaseDirectory);
webapp.setContextPath(myContextPath); 
```

只需为所有上下文循环执行此操作。它应该具有接近于零的磁盘空间开销。

在Tomcat中可能有类似的方法。

# memory - 访问数组中的第 n 个元素

> ID：10183262
> 
> 赞同：0
> 
> 时间：2012-04-16T23:52:31.190
> 
> 标签：memory, assembly, arm

我正在翻译伪代码

```
for(i=1; i<MAX; i++)
    if(split[j] = 1)
        for(j=i*3; j<MAX; j=j+i)
            split[j]=0 
```

进入 ARM 程序集。老实说，我不确定如何做到这一点，展示我的尝试将是浪费时间。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-04-18T10:28:26.580

我在您的代码中发现的错误之一是您将零存储在寄存器中，而不是存储到它指向的地址。

```
ldr R2, [R1, R0]
mov R2, #0 ; This is wrong. You are zeroing a register and not the address to 
           ; which it points to 
```

这是带有注释的程序集的等效程序集

```
for(i=1; i<MAX; i++)
    for(j=i*3; j<MAX; j=j+i)
        split[j]=0

           ldr r0,=split
           ldr r4, =MAX
           xor r5,r5  ; this is the zero we shall store into split[j]  

           mov r2, #1 ; i
outer_loop cmp r2,r4 ; i<MAX
           bge end_loop1
           add r1, r2, r2, lsl #1 ; j=i*2+i
inner_loop cmp r1, r4 ; j<MAX
           bge end_loop2
           str r5,[r0], r1, lsl #2 ;split[j]=0
           add r1,r1,r2 ; j=j+i
           b inner_loop
end_loop2  add r2,r2,#1 ; i++
           b outer_loop

end_loop1  end 
```

# android - Android 应用程序：在用户之间共享数据

> ID：10183263
> 
> 赞同：2
> 
> 时间：2012-04-16T23:52:35.637
> 
> 标签：android, database, synchronization, data-sharing

我正在开发一个用于构建和共享自行车道数据库的安卓应用程序。

用户将能够将他们自己的位置和轨迹添加到他们的本地数据库副本中，或者编辑现有的描述、详细信息等。
我想要一种机制，让应用程序的所有用户都可以相互共享他们的数据。例如，通过基于网络的中央数据库或其他方式。仅仅上传整个数据库实际上并不奏效，因为我预计会有多个用户想要同时进行编辑的时候，可能是对同一个对象。

是否有明确的“最佳实践”来完成这种数据共享？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T00:11:48.450

您应该创建一个服务器应用程序来处理所有客户端的数据交换。您的服务器应用程序必须链接到您的数据库。此外，您的客户端应用程序（又名：用户）将仅与服务器应用程序通信，这将刷新您的其他客户端应用程序。看看 Java 套接字，记得把它们放在一个 AsyncTask 类中（类似于 Thread，但仅用于 android）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T01:12:04.257

看看杰克逊：[http ://wiki.fasterxml.com/JacksonDataBinding](http://wiki.fasterxml.com/JacksonDataBinding)

如果您的应用程序中有标准 Java 模型，Jackson 将帮助您将其转换为 JSON，您可以轻松地将其发送到中央服务器。

当您从中央服务器拉下新路由时，您只需使用 Jackson 将 JSON 反序列化回您的 Java 模型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T13:32:45.933

我认为算法应该是这样的：

注意：您需要一种确定两个位置是否相同的好方法。据推测，一个位置可能有不同的名称或拼写，以及稍微不同的 GPS 坐标。此外，多条路径可能从相同的 GPS 坐标开始。

```
 Iterate through the remote records, one by one
      If the location doesn't exist locally
        create it.
      else if the record is identical
             ignore it
           else 
             if only one record changed
               copy it to the opposite database
             else
               merge the data from the 2 records together somehow 
```

最后，您需要将任何本地创建的记录上传到远程数据库。

# objective-c - 带有 UISegmented 控件和复选标记附件的 UITableView

> ID：10183264
> 
> 赞同：0
> 
> 时间：2012-04-16T23:52:37.977
> 
> 标签：objective-c, uitableview, uisegmentedcontrol, checkmark, pass-data

我是 Objective-C 和 iOS 编码领域的新手，所以我会很感激一些帮助。

这是我的问题。我有一个带有 UISegmentedControl 的 UITableView。这个有 6 个不同的段，它们通过修改 NSMutableArray 来修改表的内容。我设法做到了，所以我已经为自己感到非常自豪，但今天仍然是新手诅咒。我想实现复选标记以选择单元格并将单元格的数据传递给另一个 UITableView。第一个问题是我有我的复选标记，但我点击了不同的部分，数据已更新，但前一个部分的复选标记仍然存在。如何解决这个问题。

其次，通过选择单元格将数据从 UITableView 的所有段传递到另一个 tableview 的最佳方法是什么？

这是我的 UITableViewController.h

```
@class MesExercicesViewController;

@protocol MesExercicesViewControllerDelegate <NSObject>

- (void) mesExercicesViewControllerDidCancel:
(MesExercicesViewController *) controller;

- (void) mesExercicesViewControllerDidSave:
(MesExercicesViewController *)controller;

@end

@interface MesExercicesViewController : UITableViewController {
NSMutableArray *exercicesList;
UISegmentedControl *segment;
}

- (IBAction)segmentChange;

@property (nonatomic, retain) IBOutlet UISegmentedControl *segment;

@property (nonatomic, weak) id <MesExercicesViewControllerDelegate> delegate;

- (IBAction)cancel:(id)sender;

- (IBAction)done:(id)sender;

@end 
```

这是 UITableViewController.m 中 UISegmentedControl 的代码

```
- (void)viewDidLoad {

[super viewDidLoad];
exercicesList = [NSMutableArray arrayWithObjects: 

@"A",@"A1",@"A2",@"A3",@"A4",@"A5",@"A6",@"A7", nil];
}

- (IBAction)segmentChange {
if (segment.selectedSegmentIndex == 0) {
    exercicesList = [NSMutableArray arrayWithObjects:@"A",@"A1",@"A2",@"A3",@"A4",@"A5",@"A6", nil];
    [[self tableView]reloadData]; 

} else if (segment.selectedSegmentIndex == 1) {
    exercicesList = [NSMutableArray arrayWithObjects:@"C",@"C1",@"C2",@"C3",@"C4", nil];
    [[self tableView] reloadData];

} else if (segment.selectedSegmentIndex == 2) {
    exercicesList = [NSMutableArray arrayWithObjects:@"E",@"E1",@"E2",@"E3",@"E4",@"E5",@"E6",@"E7",@"F",@"F1", nil];
    [[self tableView] reloadData];
} else if (segment.selectedSegmentIndex == 3) {
    exercicesList = [NSMutableArray arrayWithObjects:@"I",@"I1",@"I2",@"I3",@"I4",@"I5",@"I6",@"I7",@"I8",@"J", nil];
    [[self tableView] reloadData];

} else if (segment.selectedSegmentIndex == 4) {
    exercicesList = [NSMutableArray arrayWithObjects:@"L",@"M",@"M1",@"N",@"N1", nil];
    [[self tableView] reloadData];

} else if (segment.selectedSegmentIndex == 5) {
    exercicesList = [NSMutableArray arrayWithObjects:@"R",@"S",@"T",@"U",@"V",@"W",@"X",@"Y",@"Z", nil];
    [[self tableView] reloadData];

}
}

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
[tableView deselectRowAtIndexPath:[tableView indexPathForSelectedRow] animated:NO];
UITableViewCell *cell = [tableView cellForRowAtIndexPath:indexPath];
if (cell.accessoryType == UITableViewCellAccessoryNone) {
    cell.accessoryType = UITableViewCellAccessoryCheckmark;

    //reflect selection in data model
}else if (cell.accessoryType == UITableViewCellAccessoryCheckmark) {
    cell.accessoryType = UITableViewCellAccessoryNone;

    //reflect the deselection in data model
} 
```

非常感谢您提前提供的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T05:33:49.660

首先，在你的 cellForRowAtIndexPath 集中

> cell.accessoryType = UITableViewCellAccessoryNone;

这样，每当您在 tableView 上重新加载数据时，它都会摆脱复选标记。您可以在点击新段时执行此操作。

# 第二次编辑

其次，设置 2 个免费方法 - 在 didSelectRow 和 didDeselectRow 中。在您的 viewDidLoad 中创建一个 NSMutableArray，然后添加到它。所以你的 didSelectRow 会有：

> *   (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
>     {
>     [mutableArray addObject:[exercisesList objectAtIndex:indexPath.row]];
>     }

你的 didDeselectRow 会有

> *   (void)tableView:(UITableView *)tableView didDeselectRowAtIndexPath:(NSIndexPath *)indexPath
>     {
>     [mutableArray removeObject:[exercisesList objectAtIndex:indexPath.row]];
>     }

就复选标记而言，您实施了吗？

> [[self tableView] setEditing:YES 动画:YES];

然后，您将使用这个 mutableArray 来填充新表。

# 第一次编辑

*   这是有关如何设置委托的一些额外细节

因此，让我们调用具有原始表的 VC - OriginalTableViewController 和具有要从 mutableArray 填充的新表的 VC - NextTableViewController（最好在任何名称的开头远离“新”一词......）

NextTableViewController.h - 在# import < UIKit/UIKit.h> 之后

> ```
> @class NextTableViewController;
> 
> @protocol NextTableViewControllerDelegate  
>  -(NSMutableArray*)sendThroughTheMutableArray;  
> @end 
> ```

声明你的代表

> @property (nonatomic, assign) id 委托；

NextTableViewController.m

> @synthesize 代表；

然后，您可能熟悉对 self 的调用 - [self getThatArray]; 与委托相同，但您只需调用委托而不是自我

这是假设您已经在 h 文件中声明了 myTablePopulatingArray：

> if(delegate != nil)
> {
> myTablePopulatingArray = [[NSMutableArray Alloc] initWithArray: [delegate sendThroughTheMutableArray]];
> }

基本上到此为止，我们刚刚设置了委托。我们说，这就是我需要的。谁愿意呢？谁将自愿从事这项工作。我们将 if(delegate != nil) 作为安全措施 - 但您将确保有委托，因此您可能并不需要它

现在对于代表本身 - 你只需要两件事：

1.  在 OriginalTableViewController.h 文件中

> #import "NextTableViewController.h"
> 
> @class DetailViewController; 原始表视图控制器

1.  在您的 OriginalTableViewController.m 文件中，您必须放置您之前声明的方法

    > -(NSMutableArray*)sendThroughTheMutableArray
    > {
    > return mutableArray;
    > }

所以这个 mutableArray 现在已准备好填充您的 tableView。

# xml - 什么是动作脚本的体面 xml cms？

> ID：10183266
> 
> 赞同：0
> 
> 时间：2012-04-16T23:52:42.713
> 
> 标签：xml, sqlite, actionscript, air, typo3

我的客户想要一个带有来自 Typo3 CMS 的菜单、文本和视频的 xml 驱动的 flash actionscript cms。当他想离线浏览网站时，我可以建议他使用替代网络服务器吗？或者我可以推荐任何 decdnt xml flash actionscript cms 吗？我有一个 cd 上的网络服务器许可证，将站点放在 cd 或任何其他虚拟文件上然后提供 actionscript 和 sqlite 解决方案会更容易吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T06:06:47.763

有一个扩展[T3flex](http://forge.typo3.org/projects/show/extension-t3flex)提供了 TYPO3 和 AS3 之间的这种抽象。

尽管扩展失去了一点动力，但我仍然认为值得一试。

# c++ - 带有派生类的 base_class 上的 C++ 继承和虚拟关键字

> ID：10183267
> 
> 赞同：3
> 
> 时间：2012-04-16T23:52:44.823
> 
> 标签：c++, inheritance, virtual

抱歉，也许我应该以更好的方式重写我的问题。

我有一个`ABC`具有函数名称的基类名称。

```
void saysez(ostream &os) const // this is NOT virtual!!
            { os << sez; } 
```

`DEF`以及也有函数名的派生类名

```
void saysez(ostream &os) const { os << extra << " ";
                         scary::saysez(os); 
```

所以我们可以从上面的代码中看到两者都具有相同的签名。

据我了解，如果没有`virtual`指定关键字，它应该使用基类函数，但在我的演练实践中，输出结果证明它正在使用派生函数。

所以我想知道为什么它使用派生函数而不是基函数？

以下是来自的电话`int main`

```
 w.saysez(cout);  cout << '\n'; 
```

`w`是派生类的对象。

下面是带有输出的截断代码的链接

[http://codepad.org/Pz5jwMVP](http://codepad.org/Pz5jwMVP)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T00:22:27.717

我很难理解你的问题。virtual 关键字似乎与这个问题无关。你的女巫类有一个成员函数 void sayez(ostream&)，当你创建这个类的一个实例并调用 w.saysez 时，编译器会匹配它在你的女巫实现中找到的 sayez 的定义。

virtual 关键字在这里真的无关紧要。如果不想看到“Double Double”部分，则将 w 转换为可怕的：

```
((scary*)&w)->saysez(cout) 
```

而且您不会看到打印出的“双倍”部分。

请参阅[此](http://publib.boulder.ibm.com/infocenter/comphelp/v8v101/index.jsp?topic=/com.ibm.xlcpp8a.doc/language/ref/cplr139.htm)站点或任何其他讨论虚拟关键字的站点以获取更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T00:11:57.567

这是您可以发布的一个较小的示例，它仍然可以证明您的问题：

```
#include <iostream>
using namespace std;
#include <cstring>

class scary {
    char is[31];
    char sez[31];
public:
    scary() {
        strcpy(is, "Creep");
        strcpy(sez, "boooo");
    }
    scary(const char i[], const char s[])
    {
        strcpy(is, i); strcpy(sez, s);
    }
    virtual void sayis(ostream &os) const { os << is; }
    void saysez(ostream &os) const // this is NOT virtual!!
        { os << sez; }
};

ostream &operator<<(ostream &os, const scary &x) {
    x.saysez(os);
    os << ", said the ";
    x.sayis(os);
    return os;
}

class ghost: public scary {
public:
    ghost():scary("Ghost", "Boo!")
    {
    }
};

class witch: public scary {
    char extra[31];
public:
    witch(): scary("Witch", "Toil and Trouble") {
        strcpy(extra, "Double, Double");
    }
    void saysez(ostream &os) const {
        os << extra << " ";
        scary::saysez(os);
    }
};

int main() {
    scary s; 
    ghost g; 
    witch w;
    cout << s << '\n' << g << '\n' << w << '\n';
    return 0;
} 
```

输出：

```
boooo, said the Creep
Boo!, said the Ghost
Toil and Trouble, said the Witch 
```

在`witch`的构造函数中，您将`sez`数组设置为`"Toil and Trouble"`，然后在您打印出并调用打印出的函数中`saysez`声明。发生这种情况是因为可以（但不鼓励）[覆盖非虚拟成员函数](http://www.parashift.com/c++-faq-lite/strange-inheritance.html#faq-23.8)。`witch``extra``scary``saysez``sez`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T00:14:45.783

我猜 w 被声明为 witch 类型的元素，所以它当然会调用 witch::saysez()。但是，如果您这样做了：

```
scary* w2 = new witch();
w2->saysez(cout); 
```

...那么你应该看到可怕的::saysez() 行为。

看起来您误解了非虚函数如何与继承的类一起工作。虚拟和非虚拟功能都可以被覆盖。在 Foo 类的对象上，如果调用 Foo::MyNonVirtualFn()，它只会执行 Foo::MyNonVirtualFn() 的主体。如果 Foo 有一个实现 MyNonVirtualFn() 的超类，或者如果它被调用的对象实际上是 Foo 的子类的一个实例，它覆盖了 MyNonVirtualFn() —— 这些都不重要。如果函数调用是 Foo::MyNonVirtualFn()，那么这就是运行的函数的版本。（如果您没有明确说明您调用的 MyNonVirtualFn() 版本是从您调用它的类型推断出来的——对于指针或引用类型，这可能与目的。）

虚函数的不同之处在于，如果您在对象上调用 Foo::MyVirtualFn() ，它将*检查该对象是否是已覆盖 MyVirtualFn() 的 Foo 子类的实例*。因此，例如：

```
Base* base = new Base();
Derived* derived = new Derived();
Base* derived_as_base = derived;

base->MyNonVirtualFn();  // Calls Base::MyNonVirtualFn().
derived->MyNonVirtualFn();  // Calls Derived::MyNonVirtualFn().
derived_as_base->MyNonVirtualFn();  // Calls Base::MyNonVirtualFn() because it's called on a Base*.

base->MyVirtualFn();  // Calls Base::MyNonVirtualFn().
derived->MyVirtualFn();  // Calls Derived::MyNonVirtualFn().
derived_as_base->MyVirtualFn();  // Calls Derived::MyNonVirtualFn() because it uses a lookup table. 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-17T00:25:37.473

首先，如果我不正确理解您的问题，请纠正我。

我们使用继承有很多原因，其中之一是高效编码。例如，在您的情况下，

你想继承可怕的类，这意味着你想在派生类中拥有可怕的类的功能。您可以复制基类中的所有成员函数以具有与基类调用相同的功能，但是如果您决定更改其中一个函数中的某些内容怎么办？你必须改变所有这些。所以这是一种低效的编码方式。

现在在你的类中，你问为什么对象 w 在这一行`w.saysez(cout); cout << '\n';`，因为类可怕和具有相同成员函数的类，`w`应该首先在它的类中查找匹配，如果它没有找到它，它会查找在基础类中。因此，您的对象正在调用`saysez`其类中的成员函数。

希望这会有所帮助。

# c# - 找到存储在数组 C# 中的一组结果的最小值

> ID：10183269
> 
> 赞同：1
> 
> 时间：2012-04-16T23:53:04.460
> 
> 标签：c#, arrays, visual-studio-2010, class

我的程序有文本框和列表视图，信息被输入文本框，然后单击按钮显示到列表视图中。信息是身份证、名字、姓氏和年薪。信息存储在数组中。

我想找到薪水最低的人。我该怎么做呢？（在 C# 中）

这是我的 Form1：

```
 using System;
    using System.Collections.Generic;
    using System.ComponentModel;
    using System.Data;
    using System.Drawing;
    using System.Linq;
    using System.Text;
    using System.Windows.Forms;
    using System.Collections;

    namespace Employee_Program
    {
        public partial class Form1 : Form
        {

            public Form1()
            {
        em = new ArrayList();
        InitializeComponent();
    }

    public ArrayList em = new ArrayList();

    private void show_employee()
    {
        listView1.Items.Clear();
        foreach(Employee a in em)
        {
            int i = listView1.Items.Count;
            listView1.Items.Add(a.EmployeeId.ToString());
            listView1.Items[i].SubItems.Add(a.FirstName);
            listView1.Items[i].SubItems.Add(a.LastName);
            listView1.Items[i].SubItems.Add(a.YearSalary.ToString());

        }
    }

    private void button1_Click(object sender, EventArgs e)
    {
        Employee a = new Employee();
        a.EmployeeId = float.Parse(employeeId.Text);
        a.FirstName = firstName.Text;
        a.LastName = lastName.Text;
        a.YearSalary = float.Parse(yearSalary.Text);
        em.Add(a);
        show_employee();

    }

    private void button2_Click(object sender, EventArgs e)
    {

    // this is the button that will return the lowest salary value. Preferably in a                        
    //message box? Any idea?

        }
    }} 
```

这是我的班级，员工：

```
 using System;
       using System.Collections.Generic;
       using System.Linq;
       using System.Text;

       namespace Employee_Program
       {
class Employee
{
    protected float employeeId;
    protected string firstName;
    protected string lastName;
    protected float yearSalary;

    // first constructor
    public Employee()
    {
        employeeId = 0;
        firstName = "";
        lastName = "";
        yearSalary = 0;
    }

    // second constructor
    public Employee(float EmployeeId, string FirstName,
                           string LastName, float YearSalary) 
    {
        employeeId = EmployeeId;
        firstName = FirstName;
        lastName = LastName;
        yearSalary = YearSalary;
    }

    public float EmployeeId
    {
        get
        {
            return employeeId;
        }

        set
        {
            employeeId = value;
        }
    }

    public string FirstName
    {
        get
        {
            return firstName;
        }

        set
        {
            firstName = value;
        }
    }
    public string LastName
    {
        get
        {
            return lastName;
        }

        set
        {
            lastName = value;
        }
    }

    public float YearSalary
    {
        get
        {
            return yearSalary;
        }

        set
        {
            yearSalary = value;
        }
    }

           }

       } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T23:57:11.293

**注意：**一定要包括：

```
using System.Linq; 
```

您可以使用 LINQ 表达式，例如：

```
Employee[] employees;
//Populate employees   
var min = (from e in employees select e.YearSalary).Min(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T00:16:33.287

[MoreLINQ](http://code.google.com/p/morelinq/)有一个 MinBy 方法。如果您不想使用 MinBy，有几种方法可以做到。我推荐这种方法：

```
// Don't use an ArrayList, use a List<Employee>
Employee minEmp = employees.Aggregate(float.MinValue, (min, e) => (e.YearSalary < min.YearSalary) ? e : min); 
```

如果您需要所有具有匹配最低工资的员工的列表，您可以执行以下操作：

```
float min = employees.Min(e => e.YearSalary);
var minEmps = employees.Where(e => e.YearSalary == min); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T00:07:22.560

研究使用`MinBy`扩展方法。它在 Linq 中明显缺乏。可以在[此处](http://code.google.com/p/morelinq/source/browse/trunk/MoreLinq/MinBy.cs)找到实现。

然后你会简单地：

```
Employee aCheapEmployee = employees.MinBy(e => e.Salary); 
```

如果您需要查找所有薪酬最低的员工：

```
var minSalary = employees.Min(e => e.Salary); 
IEnumerable<Employee> slaveLabourers = employees.Where(e => e.Salary==minSalary); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-17T01:03:31.410

考虑重构你的代码。

*   您可以使用[链构造函数](http://geekswithblogs.net/kaju/archive/2005/12/05/62266.aspx)来避免初始化重复
*   你可以使用[自动属性](http://msdn.microsoft.com/en-us/library/bb384054.aspx)
*   您使用 float 作为 id 非常奇怪。考虑使用类似 int 的东西
*   通常camelCase用于参数命名
*   考虑使用小数类型的薪水

你的 Employee 类现在更干净了：

```
public class Employee
{   
    public Employee()
        : this(0, "", "", 0)
    {
    }

    public Employee(int employeeId, string firstName,
                           string lastName, decimal yearSalary) 
    {
        EmployeeId = employeeId;
        FirstName = firstName;
        LastName = lastName;
        YearSalary = yearSalary;
    }

    public int EmployeeId  { get; set; }
    public string FirstName { get; set; }
    public string LastName { get; set;}
    public decimal YearSalary { get; set; }
} 
```

*   考虑对数值输入使用 NumericUpDown 控件
*   考虑为控件使用描述性名称
*   考虑将新员工添加到 listView 的末尾，而不是重新加载所有员工
*   考虑使用通用列表来收集员工
*   通常 PascalCase 用于方法命名

这是Form1代码：

```
private List<Employee> employees = new List<Employee>();

private void ShowEmployee(Employee employee)
{
    var item = employeeListView.Items.Add(employee.EmployeeId.ToString());
    item.SubItems.Add(employee.FirstName);
    item.SubItems.Add(employee.LastName);
    item.SubItems.Add(employee.YearSalary.ToString());
}

private void AddEmployeeButton_Click(object sender, EventArgs e)
{
    Employee employee = new Employee();
    employee.EmployeeId = (int)idNumericUpDown.Value;
    employee.FirstName = firstNameTextBox.Text;
    employee.LastName = lastNameTextBox.Text;
    employee.YearSalary = salaryNumericUpDown.Value;
    employees.Add(employee);
    ShowEmployee(employee);
}

private void LowestSalaryButton_Click(object sender, EventArgs e)
{
    decimal minSalary = employees.Min(em => em.YearSalary);
    MessageBox.Show(minSalary.ToString("C"), "Min salary");
} 
```

# mysql - 以下操作是否原子？

> ID：10183271
> 
> 赞同：2
> 
> 时间：2012-04-16T23:53:11.207
> 
> 标签：mysql

```
INSERT INTO my_table (pseudo_id)
    SELECT `AUTO_INCREMENT`
    FROM information_schema.TABLES
    WHERE TABLE_SCHEMA = 'my_db'
    AND TABLE_NAME = 'my_table' 
```

...并像内置的 MySQL 排序功能一样并行？

请提供参考链接。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T00:08:51.017

是的，它是原子的，因为每个“单命令”查询（即使它包含子查询）都是原子的。

（嗯，这对 InnoDB 引擎有效，现在我不确定它是否对 MyISAM 也有效......）

# java - 在 Android 中检索 JSON 的问题

> ID：10183277
> 
> 赞同：1
> 
> 时间：2012-04-16T23:54:18.063
> 
> 标签：java, android, json

我查看了无数项目和教程，但无法弄清楚为什么我的应用程序一运行就崩溃。如果我注释掉 try catch "JSONObject dataObject = json.getJSONObject("data");" 中的第一行，它似乎运行良好 我试图解析的 JSON 格式如下：

```
 {"recordcount":3,
 "columnlist":"department,emailaddress,firstname,has_photos,job_full_title,job_title,kid,lastname,location,middlename,no_show_photo,phone,school",
 "data":
 {"department":["Public Safety","Information Technology","Information Technology"],
 "emailaddress":["todd.mongeon@wne.edu","amutti@wne.edu","fatemeh.shams@wne.edu"],
 "firstname":["Todd","Tony","Toffee"],
 "has_photos":["Y","Y","N"],
 "job_full_title":["Officer","Director, Administrative Information Systems","Sr.Technical Programmer/Analyst and Integ Specialist"],
 "job_title":["Officer","Director, Administrative Information Systems","Sr.Technical Programmer/Analyst and Integ Specialist"],
 "kid":[286899,2497,297411],
 "lastname":["Mongeon","Mutti","Shams"],
 "location":["PS","12 V","12 V"],
 "middlename":["A.","M.",""],
 "no_show_photo":["","",""],
 "phone":["413-782-1207","413-782-1212","413-796-2398"],
 "school":["Public Safety Group","Information Technology Group","Information Technology Group"]}} 
```

我的程序看起来像这样（请原谅格式/不需要的东西......它需要从我试图让它工作的很多东西中清理出来......）

```
 public class Directory_finalActivity extends ListActivity {

public static String url = "http://www1.wne.edu/webservices/directorydemo.cfc?wsdl&method=getEmployees&limit=25&firstname=to&outputtype=JSON";

// JSON array names
private static final String TAG_FIRST = "firstname";
private static final String TAG_LAST = "lastname";
private static final String TAG_SCHOOL = "school";
private static final String TAG_DEPARTMENT = "department";
private static final String TAG_EMAIL = "emailaddress";
private static final String TAG_PHONE = "phone";
private static final String TAG_JOB = "job_title";
private static final String TAG_LOCATION = "location";

//create JSON array
JSONArray firstNames = null;

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    // Hashmap for ListView
    ArrayList<HashMap<String, String>> contactList = new ArrayList<HashMap<String, String>>();
    // Creating JSON Parser instance
    JSONParser jParser = new JSONParser();        
    // getting JSON string from URL
    JSONObject json = jParser.getJSONFromUrl(url);

    String[] firstNames = null;
    try {
        // Getting the data object
        JSONObject dataObject = json.getJSONObject("data");  //This is the line that seems to be causing the error.
        int numResults = json.getInt("recordcount");
        /**
        JSONArray firstNameArray =  dataObject.getJSONArray("firstname");
        JSONArray lastNameArray =  dataObject.getJSONArray("lastname");
        JSONArray schoolArray =  dataObject.getJSONArray("school");
        JSONArray departmentArray =  dataObject.getJSONArray("department");
        JSONArray eMailArray = dataObject.getJSONArray("emailaddress");
        JSONArray phoneNumberArray = dataObject.getJSONArray("phone");
        JSONArray jobTitleArray = dataObject.getJSONArray("job_title");
        JSONArray locationArray = dataObject.getJSONArray("location");
        //Loop through index of array(s)
        for(int i = 0; i <= numResults; i++)
        {   
            //Store value of JSONArray at index "i" into string variables.
            String firstName = firstNameArray.getString(i);
            String eMail = eMailArray.getString(i);
            String phone = phoneNumberArray.getString(i);

            // creating new HashMap
            HashMap<String, String> map = new HashMap<String, String>();

            // adding each child node to HashMap key => value
            map.put(TAG_FIRST, firstName);
            map.put(TAG_EMAIL, eMail);
            map.put(TAG_PHONE, phone);

            //add the hashmap to array list.
            contactList.add(map);
        }*/
    }
    catch (JSONException e) {
        e.printStackTrace();
    }

    /**
     * Updating parsed JSON data into ListView
     * */
    //ListAdapter adapter = new SimpleAdapter(this, contactList,
    //      R.layout.list_item,
    //      new String[] { TAG_FIRST, TAG_EMAIL, TAG_PHONE }, new int[] {
    //              R.id.name, R.id.email, R.id.mobile });

    //setListAdapter(adapter);

} 
```

}

我的 JSONParser 类 public class JSONParser {

```
static InputStream is = null;
static JSONObject jObj = null;
static String json = "";

// constructor
public JSONParser() {

}

public JSONObject getJSONFromUrl(String url) {

    // Making HTTP request
    try {
        // defaultHttpClient
        DefaultHttpClient httpClient = new DefaultHttpClient();
        HttpPost httpPost = new HttpPost(url);

        HttpResponse httpResponse = httpClient.execute(httpPost);
        HttpEntity httpEntity = httpResponse.getEntity();
        is = httpEntity.getContent();           

    } catch (UnsupportedEncodingException e) {
        e.printStackTrace();
    } catch (ClientProtocolException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    }

    try {
        BufferedReader reader = new BufferedReader(new InputStreamReader(
                is, "iso-8859-1"), 8);
        StringBuilder sb = new StringBuilder();
        String line = null;
        while ((line = reader.readLine()) != null) {
            sb.append(line + "\n");
        }
        is.close();
        json = sb.toString();
    } catch (Exception e) {
        Log.e("Buffer Error", "Error converting result " + e.toString());
    }

    // try parse the string to a JSON object
    try {
        jObj = new JSONObject(json);
    } catch (JSONException e) {
        Log.e("JSON Parser", "Error parsing data " + e.toString());
    }

    // return JSON String
    return jObj;

} 
```

}

我可能在这里做了一些非常愚蠢的事情，我是新手，所以请让我休息一下，哈哈。我很感激你们可能为我提供的任何信息。

出于好奇，最终目标是搜索数据库（名字、姓氏、学校和部门）并将结果放入列表视图中，单击时会弹出一个窗口，显示其他相关信息以及其他一些功能。

似乎我看到他们从 url 收到的 JSON 输出的每个示例的格式都大不相同，所以即使有大量可用的示例，我也无法完成此操作（抱歉重新发布）。再次感谢您的任何帮助。

编辑 1：LOGCAT：

```
 04-17 00:45:35.828: W/System.err(305): java.net.UnknownHostException:     api.androidhive.info
04-17 00:45:35.828: W/System.err(305):  at java.net.InetAddress.lookupHostByName(InetAddress.java:513)
04-17 00:45:35.838: W/System.err(305):  at java.net.InetAddress.getAllByNameImpl(InetAddress.java:278)
04-17 00:45:35.838: W/System.err(305):  at java.net.InetAddress.getAllByName(InetAddress.java:242)
04-17 00:45:35.838: W/System.err(305):  at org.apache.http.impl.conn.DefaultClientConnectionOperator.openConnection(DefaultClientConnectionOperator.java:136)
04-17 00:45:35.838: W/System.err(305):  at org.apache.http.impl.conn.AbstractPoolEntry.open(AbstractPoolEntry.java:164)
04-17 00:45:35.838: W/System.err(305):  at org.apache.http.impl.conn.AbstractPooledConnAdapter.open(AbstractPooledConnAdapter.java:119)
04-17 00:45:35.838: W/System.err(305):  at    org.apache.http.impl.client.DefaultRequestDirector.execute(DefaultRequestDirector.java:348)
04-17 00:45:35.838: W/System.err(305):  at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:555)
04-17 00:45:35.838: W/System.err(305):  at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:487)
04-17 00:45:35.838: W/System.err(305):  at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:465)
04-17 00:45:35.838: W/System.err(305):  at directory.plus.JSONParser.getJSONFromUrl(JSONParser.java:39)
04-17 00:45:35.838: W/System.err(305):  at directory.plus.Directory_finalActivity.onCreate(Directory_finalActivity.java:53)
04-17 00:45:35.849: W/System.err(305):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
04-17 00:45:35.849: W/System.err(305):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2627)
04-17 00:45:35.849: W/System.err(305):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679)
04-17 00:45:35.849: W/System.err(305):  at android.app.ActivityThread.access$2300(ActivityThread.java:125)
04-17 00:45:35.849: W/System.err(305):  at     android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)
04-17 00:45:35.849: W/System.err(305):  at android.os.Handler.dispatchMessage(Handler.java:99)
04-17 00:45:35.849: W/System.err(305):  at android.os.Looper.loop(Looper.java:123)
04-17 00:45:35.849: W/System.err(305):  at android.app.ActivityThread.main(ActivityThread.java:4627)
04-17 00:45:35.849: W/System.err(305):  at java.lang.reflect.Method.invokeNative(Native Method)
04-17 00:45:35.849: W/System.err(305):  at java.lang.reflect.Method.invoke(Method.java:521)
04-17 00:45:35.858: W/System.err(305):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
04-17 00:45:35.858: W/System.err(305):  at  com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
04-17 00:45:35.858: W/System.err(305):  at dalvik.system.NativeStart.main(Native Method)
04-17 00:45:35.858: E/Buffer Error(305): Error converting result java.lang.NullPointerException
04-17 00:45:35.868: E/JSON Parser(305): Error parsing data org.json.JSONException: End of input at character 0 of 
04-17 00:45:35.868: D/AndroidRuntime(305): Shutting down VM
04-17 00:45:35.868: W/dalvikvm(305): threadid=1: thread exiting with uncaught exception (group=0x4001d800)
04-17 00:45:35.888: E/AndroidRuntime(305): FATAL EXCEPTION: main
04-17 00:45:35.888: E/AndroidRuntime(305): java.lang.RuntimeException: Unable to start activity ComponentInfo{directory.plus/directory.plus.Directory_finalActivity}: java.lang.NullPointerException
04-17 00:45:35.888: E/AndroidRuntime(305):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2663)
04-17 00:45:35.888: E/AndroidRuntime(305):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679)
04-17 00:45:35.888: E/AndroidRuntime(305):  at android.app.ActivityThread.access$2300(ActivityThread.java:125)
04-17 00:45:35.888: E/AndroidRuntime(305):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)
04-17 00:45:35.888: E/AndroidRuntime(305):  at android.os.Handler.dispatchMessage(Handler.java:99)
04-17 00:45:35.888: E/AndroidRuntime(305):  at android.os.Looper.loop(Looper.java:123)
04-17 00:45:35.888: E/AndroidRuntime(305):  at android.app.ActivityThread.main(ActivityThread.java:4627)
04-17 00:45:35.888: E/AndroidRuntime(305):  at java.lang.reflect.Method.invokeNative(Native Method)
04-17 00:45:35.888: E/AndroidRuntime(305):  at java.lang.reflect.Method.invoke(Method.java:521)
04-17 00:45:35.888: E/AndroidRuntime(305):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
04-17 00:45:35.888: E/AndroidRuntime(305):  at  com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
04-17 00:45:35.888: E/AndroidRuntime(305):  at dalvik.system.NativeStart.main(Native Method)
04-17 00:45:35.888: E/AndroidRuntime(305): Caused by: java.lang.NullPointerException
04-17 00:45:35.888: E/AndroidRuntime(305):  at directory.plus.Directory_finalActivity.onCreate(Directory_finalActivity.java:59)
04-17 00:45:35.888: E/AndroidRuntime(305):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
04-17 00:45:35.888: E/AndroidRuntime(305):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2627) 
```

编辑 2：新的 LOGCAT 输出：

```
04-17 01:26:12.899: E/JSON Parser(548): Error parsing data in JSONParser org.json.JSONException: Value <wddxPacket of type java.lang.String cannot be converted to JSONObject
04-17 01:26:12.899: D/AndroidRuntime(548): Shutting down VM
04-17 01:26:12.899: W/dalvikvm(548): threadid=1: thread exiting with uncaught exception (group=0x4001d800)
04-17 01:26:12.919: E/AndroidRuntime(548): FATAL EXCEPTION: main
04-17 01:26:12.919: E/AndroidRuntime(548): java.lang.RuntimeException: Unable to start activity ComponentInfo{directory.plus/directory.plus.Directory_finalActivity}: java.lang.NullPointerException
04-17 01:26:12.919: E/AndroidRuntime(548):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2663)
04-17 01:26:12.919: E/AndroidRuntime(548):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679)
04-17 01:26:12.919: E/AndroidRuntime(548):  at android.app.ActivityThread.access$2300(ActivityThread.java:125)
04-17 01:26:12.919: E/AndroidRuntime(548):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)
04-17 01:26:12.919: E/AndroidRuntime(548):  at android.os.Handler.dispatchMessage(Handler.java:99)
04-17 01:26:12.919: E/AndroidRuntime(548):  at android.os.Looper.loop(Looper.java:123)
04-17 01:26:12.919: E/AndroidRuntime(548):  at android.app.ActivityThread.main(ActivityThread.java:4627)
04-17 01:26:12.919: E/AndroidRuntime(548):  at java.lang.reflect.Method.invokeNative(Native Method)
04-17 01:26:12.919: E/AndroidRuntime(548):  at java.lang.reflect.Method.invoke(Method.java:521)
04-17 01:26:12.919: E/AndroidRuntime(548):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
04-17 01:26:12.919: E/AndroidRuntime(548):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
04-17 01:26:12.919: E/AndroidRuntime(548):  at dalvik.system.NativeStart.main(Native Method)
04-17 01:26:12.919: E/AndroidRuntime(548): Caused by: java.lang.NullPointerException
04-17 01:26:12.919: E/AndroidRuntime(548):  at directory.plus.Directory_finalActivity.onCreate(Directory_finalActivity.java:59)
04-17 01:26:12.919: E/AndroidRuntime(548):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
04-17 01:26:12.919: E/AndroidRuntime(548):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2627)
04-17 01:26:12.919: E/AndroidRuntime(548):  ... 11 more
04-17 01:26:33.279: I/Process(548): Sending signal. PID: 548 SIG: 9 
```

编辑最后：问题已解决：需要获取从 html 返回的结果的子字符串并将其传递给 json 对象

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T01:06:04.347

> > java.net.UnknownHostException：api.androidhive.info

您的应用似乎无法访问网络。您是否添加了：

`<uses-permission android:name="android.permission.INTERNET" />`

到您的代码 AndroidManifest.xml？

# c - C 编程。为什么“这个”代码有效但“那个”代码无效？

> ID：10183279
> 
> 赞同：-3
> 
> 时间：2012-04-16T23:54:38.430
> 
> 标签：c

您好，我正在学习 C 编程课程介绍的测试，昨天我试图编写这个程序来打印 2 和用户输入的任何数字之间的偶数素数，我花了大约 2 个小时试图正确地编写它和最终我做到了。我在下面上传了 2 张图片。其中之一显示正确的代码和正确的输出。另一个显示了我对无法正常工作的问题的第一次尝试，我返回并使其与工作代码尽可能相似，而无需直接复制和粘贴所有内容。

不幸的是，不允许新用户发布图片，希望下面的这些链接可以正常工作。

这失败了，它不会用自然平方根打印范围内的所有数字：

```
for (i = 2; i <= x; i++)
{
   //non relevant line
   a = sqrt(i);
   aa = a * a;
   if (aa == i); 
       printf("%d ",i);
} 
```

来源：http: [//i.imgur.com/WGG6n.jpg](http://i.imgur.com/WGG6n.jpg)

虽然这成功了，并用自然平方根打印偶数

```
for (i = 2; i <= x; i++) 
{
   a = sqrt(i);
   aa = a * a;
   if (aa == i && ((i/2) *2) == i)
        printf("%d ", i);
} 
```

来源：http: [//i.imgur.com/Kpvpq.jpg](http://i.imgur.com/Kpvpq.jpg)

希望你能看到并阅读我在这里的屏幕截图。我知道“不正确的代码”图片没有 (i/2)*2 == i 部分，但我认为它仍然会打印奇数和偶数，它还有计算“sqrd”的代码但是这不应该影响输出。如果我在最后一部分错了，请纠正我。

是的，我正在使用我读过的 Dev-C++，这有点糟糕，但我最初是在 code::blocks 上这样做的，它做了同样的事情......

请我非常感谢任何关于我在实际让该死代码为我工作之前 2 小时做错了什么的建议或建议。

谢谢你，亚当

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-17T00:01:08.670

您在“that”中的代码包括：

```
if (aa == i);
//          ^
   printf(...); 
```

[注意`;`if 条件末尾的 ]

因此，如果`aa == i`- 一个空语句发生，并且打印总是发生，因为它超出了 if 语句的范围。

为避免将来出现此问题，您可能希望使用显式范围¹ [使用`{`, `}`after control flow statements] - 至少在您对语言进行编程的第一步中。

* * *

1：spartan 程序员可能会讨厌这种说法

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-11T12:41:04.517

此类错误很常见。我使用“step Over”、“Step Into”、“Break Points”和“watch window”来调试我的程序。使用这些选项，您可以逐行执行程序并跟踪每行中使用的变量。这样，您将知道哪一行没有以所需的方式执行。

# python - Apache 服务器无法连接到 Django

> ID：10183280
> 
> 赞同：0
> 
> 时间：2012-04-16T23:55:09.623
> 
> 标签：python, django, apache, configuration

因此，我在 Linux 机器上运行 Apache2，并且尝试使用 Django 1.3 提供页面。我在[这里](http://www.youtube.com/watch?v=yAyWM-iEIos)找到了执行此操作的指南。

我已`django.wsgi`配置、`settings.py`配置和创建数据库并成功与 Django 同步。但是，当我尝试访问该网站时，我看到的是由 Apache 而不是 Django 提供的页面。我根本没有收到任何错误/警告。

`django.wsgi`我在and中都放入了 print 语句`settings.py`（因为它们都只是 python 文件），但没有打印任何内容。

有没有人知道可能出了什么问题或我可以采取的任何诊断步骤？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T06:37:42.257

正如每个人在评论中所说，您需要`WSGIServerAlias`在 Apache 配置中添加一个指令，然后才能正常工作。否则，Apache 不可能知道使用 WSGI 来为您的站点提供服务。

# c++ - VirtualTreeView 在 C++ Builder 中完成 UnicodeString

> ID：10183284
> 
> 赞同：3
> 
> 时间：2012-04-16T23:55:28.703
> 
> 标签：c++, delphi, memory-leaks, c++builder, virtualtreeview

我在 C++ Builder 中使用 VirtualTreeView 并使用如下结构：

```
struct TVTNodeData
   {
   int Index;
   UnicodeString Caption;
   } 
```

我使用具有以下内容的循环预填充树的节点：

```
TVirtualNode *Node = VTree->AddChild(NULL);
pNode = (TVTNodeData *)VTree->GetNodeData(Node);
pNode->Index = 1;
pNode->Caption = "Whatever"; 
```

我注意到应用程序的内存在不断增加（内存泄漏），即使我清除了树并重新加载它。此页面 - [http://www.remkoweijnen.nl/blog/2010/06/09/memory-leaks-when-using-virtual-treeview-component/](http://www.remkoweijnen.nl/blog/2010/06/09/memory-leaks-when-using-virtual-treeview-component/)建议在`OnFreeNode`事件中执行 Finalize()。目前很好。

但是 C++ 中没有 Finalize()。`pNode->Caption=""`我在事件中尝试过`OnFreeNode`，内存不再分配得那么剧烈，但它仍然有点。我认为即使 UnicodeString 被清空（引用计数> 0），也可能会留下对 UnicodeString 的引用。

如何`OnFreeNode`在 C++ 中为 UnicodeString 释放节点数据？我知道分配 UnicodeString 直到所有引用计数都为零 - 那么如何强制引用计数变为零？

另外，如果节点被分配了怎么办`OnNodeInit`- 这同样适用于`OnFreeNode`事件吗？

如果 TVTNodeData 结构是纯虚拟的 - 节点既不可见，也不使用 AddChild 或 OnNodeInit 初始化，然后需要 Finalize，那么该结构是否存在于内存中？

**更新：**我后来发现我错误地测量了内存使用情况，并且对于字符串将它们设置为空字符串确实足以清除内存数据。但是 - 正如 Rob Kennedy 在下面的回答中所建议的那样，调用 struct ~destructor 甚至更好，相当于 Finalize 并且更容易，因为它清除了整个结构（如果你有更多的字符串）。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-17T16:19:30.287

Delphi`Finalize`具有释放记录中任何编译器管理的类型的效果。在 C++ 中，这通常是类型的*析构函数*的工作。在您的`OnFreeNode`事件处理程序中，直接调用您的数据类型的析构函数：

```
TVTNodeData* const pNode = static_cast<TVTNodeData*>(Sender->GetNodeData(Node));
pNode->~TVTNodeData(); 
```

这将调用`UnicodeString`对象的析构函数，这将释放相关的字符数据。当树控件`TVTNodeData`为一个节点`TVirtualNode`分配`delete`.

树控件使用所有位为零来初始化数据。如果您的数据中有一个不是正确初始化的对象（正式正确，包括*所有*非 POD 类型），那么您应该在事件中调用数据的*构造函数。*`OnInitNode`使用*placement new*来做到这一点。例如：

```
TVTNodeData* const pNode = static_cast<TVTNodeData*>(Sender->GetNodeData(Node));
new (pNode) TVTNodeData(); 
```

这将调用`TVTNodeData`成员的构造函数，而无需为其他`TVTNodeData`实例分配内存。

如果一个节点从未被初始化，那么它也不会被最终确定。该`OnInitNode`事件将永远不会运行，因此树将知道该节点尚未初始化。未初始化的节点不会最终确定，因此您无需担心。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T13:59:19.647

我认为并非所有节点都经过验证，可能是因为它们没有显示。尝试在 AddChild 之后调用 ValidateNode。

# asp.net-mvc-3 - MVC 3 路由混淆

> ID：10183286
> 
> 赞同：0
> 
> 时间：2012-04-16T23:56:00.707
> 
> 标签：asp.net-mvc-3, routing, guid

好的，我一直在查看 MVC 3 路由问题/答案的代表性样本，我回答了 80% 的问题。一件好事，但现在最困难的部分仍未解决。

在我的世界里，我有一个 URL localhost/Location/ *Guid*

效果很好，基于我在默认路线之前输入的这条路线：

```
routes.MapRoute(
    "Location",
    "Location/{id}",
    new { controller = "Location", action = "Details", id = System.Guid.Empty }
); 
```

我可以在 Guid 中传递我想要显示的位置，但这完全是 FUGLY。我真的很想看到地址栏中显示的 URL，并在页面中链接为：localhost/Location/Paris

显然，我可以将参数更改为字符串并传入“Paris”，但我不明白如何让数据库了解我想要法国巴黎而不是德克萨斯巴黎而不使用 Guid。

我真的需要一些帮助，不仅是为了解决我眼前的问题，也是为了更好地理解一般的路由。我以为我对它的处理足以满足我的需要，但显然，我没有。

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T00:36:21.503

您必须在 URL 中添加一些内容以消除法国巴黎和德克萨斯州巴黎之间的歧义。

1.  您可以将您的路线模式设置为 `/Location/{country}/{region}/{city}'，或者您可以在应用程序中对每个可能的位置进行 slugify
2.  使用这些位置信息：`/Location/{locationSlug}`。如果您有多个名为“Paris”的位置，则对它们进行 slugify 并在末尾附加一个自动递增的 #（例如，/Location/paris、/Location/paris-1、/Location/paris-2）。或者您可以将地区/城市/国家信息添加到 slug 以消除歧义，而不是 #。
3.  做它堆栈溢出问题样式，你有一个ID，然后是位置slug。如果您能够将您的 GUID 转换或映射为整数，它看起来更漂亮、更简洁，因此您的模式将是这样的：（`Location/{id}/{locationSlug}`例如，/Location/1245/paris）。

# node.js - 如何在 Express 中获取完整的 URL？

> ID：10183291
> 
> 赞同：605
> 
> 时间：2012-04-16T23:57:06.567
> 
> 标签：node.js, url, express

假设我的示例网址是

> [http://example.com/one/two](http://example.com/one/two)

我说我有以下路线

```
app.get('/one/two', function (req, res) {
    var url = req.url;
} 
```

`url`的值为`/one/two`。

如何在 Express 中获取**完整的 URL ？**例如，在上述情况下，我想收到`http://example.com/one/two`.

* * *

## 回答 #1

> 赞同：892
> 
> 时间：2012-04-17T05:12:03.537

1.  该协议可作为`req.protocol`. [文档在这里](http://expressjs.com/api.html#req.protocol)

    1.  在 express 3.0 之前，您可以假设的协议，`http`除非您看到它`req.get('X-Forwarded-Protocol')`已设置并具有 value `https`，在这种情况下您知道这是您的协议
2.  `req.get('host')`正如 Gopal 所指出的，主机来自

3.  希望您的 URL 中不需要非标准端口，但如果您确实需要知道它，您将在应用程序状态中拥有它，因为它是您`app.listen`在服务器启动时传递给的任何内容。但是，在非标准端口上进行本地开发的情况下，Chrome 似乎将端口包含在主机标头中，因此`req.get('host')`返回`localhost:3000`，例如。因此，至少对于标准端口上的生产站点并直接浏览到您的快速应用程序（没有反向代理）的情况，`host`标题似乎对 URL 中的端口做了正确的事情。

4.  路径来自`req.originalUrl`（感谢@pgrassant）。请注意，这确实包括查询字符串。[req.url 和 req.originalUrl 上的文档](http://expressjs.com/api.html#req.originalUrl)。根据您打算对 URL 执行的操作，`originalUrl`与`req.url`.

将这些组合在一起以重建绝对 URL。

```
 var fullUrl = req.protocol + '://' + req.get('host') + req.originalUrl; 
```

* * *

## 回答 #2

> 赞同：157
> 
> 时间：2013-04-10T09:47:49.493

[您可以将 node.js API 用于 URL](http://nodejs.org/api/url.html "网址 Node.js v0.10.3")`URL.format()`并从 express传递信息，而不是自己将这些东西连接在一起。

例子：

```
var url = require('url');

function fullUrl(req) {
  return url.format({
    protocol: req.protocol,
    host: req.get('host'),
    pathname: req.originalUrl
  });
} 
```

* * *

## 回答 #3

> 赞同：41
> 
> 时间：2012-10-21T08:06:26.877

我发现获取请求的 url 有点像 PITA。我不敢相信没有更简单的表达方式。应该只是 req.requested_url

但我是这样设置的：

```
var port = req.app.settings.port || cfg.port;
res.locals.requested_url = req.protocol + '://' + req.host  + ( port == 80 || port == 443 ? '' : ':'+port ) + req.path; 
```

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2014-03-06T23:07:32.690

这是添加函数的好方法，您可以在 req 对象上调用以获取 url

```
 app.use(function(req, res, next) {
    req.getUrl = function() {
      return req.protocol + "://" + req.get('host') + req.originalUrl;
    }
    return next();
  }); 
```

现在你有了一个可以按需调用的函数。

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2015-08-02T07:24:42.457

使用[url.format](https://nodejs.org/api/url.html#url_url_format_urlobj)：

```
var url = require('url'); 
```

这支持所有协议并包括端口号。如果您的 originalUrl 中没有查询字符串，您可以使用这个更简洁的解决方案：

```
var requrl = url.format({
    protocol: req.protocol,
    host: req.get('host'),
    pathname: req.originalUrl,
}); 
```

如果您有查询字符串：

```
var urlobj = url.parse(req.originalUrl);
urlobj.protocol = req.protocol;
urlobj.host = req.get('host');
var requrl = url.format(urlobj); 
```

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2015-12-31T08:26:35.730

用这个，

```
var url = req.headers.host + '/' + req.url; 
```

* * *

## 回答 #7

> 赞同：13
> 
> 时间：2016-06-15T01:58:16.570

使 req.host/req.hostname 生效必须有两个条件[Express 后面的代理](http://expressjs.com/en/guide/behind-proxies.html)：

1.  `app.set('trust proxy', 'loopback');`在 app.js 中
2.  `X-Forwarded-Host`标头必须由您在网络服务器中指定。例如。阿帕奇, nginx

**nginx**：

```
server {
    listen myhost:80;
    server_name  myhost;
    location / {
        root /path/to/myapp/public;
        proxy_set_header X-Forwarded-Host $host:$server_port;
        proxy_set_header X-Forwarded-Server $host;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_pass http://myapp:8080;
    }
} 
```

**阿帕奇**：

```
<VirtualHost myhost:80>
    ServerName myhost
    DocumentRoot /path/to/myapp/public
    ProxyPass / http://myapp:8080/
    ProxyPassReverse / http://myapp:8080/
</VirtualHost> 
```

* * *

## 回答 #8

> 赞同：12
> 
> 时间：2021-07-14T05:34:26.253

**2021年**

上面的答案工作正常，但文档不喜欢，因为`url.parse`现在是，所以如果你想获得更多的控制权，`legacy`我建议你使用函数。`new URL()``url`

## 高速公路

你可以`Full URL`从下面的代码中得到。

```
`${req.protocol}://${req.get('host')}${req.originalUrl}` 
```

示例 URL：http://localhost:5000/a/b/c?d=true&e=true#f=false

**固定属性**（您将在所有路线中获得相同的结果）

```
req.protocol: http
req.hostname: localhost
req.get('Host'): localhost:5000
req.originalUrl: /a/b/c?d=true&e=true
req.query: { d: 'true', e: 'true' } 
```

**不固定属性**（每条路线都会改变，因为它由快递本身控制）

路线：`/`

```
req.baseUrl: <blank>
req.url: /a/b/c?d=true&e=true
req.path: /a/b/c 
```

路线`/a`

```
req.baseUrl: /a
req.url: /b/c?d=true&e=true
req.path: /b/c 
```

文档：[http ://expressjs.com/en/api.html#req.baseUrl](http://expressjs.com/en/api.html#req.baseUrl)

## URL封装方式

在`URL`函数中，您将在每条路线中获得相同的结果，因此属性**始终是固定**的。

**特性**

[![在此处输入图像描述](../Images/dd0ed3e58a3f96727dea6265b880ea51.png)](https://i.stack.imgur.com/QKa0Q.png)

```
const url = new URL(`${req.protocol}://${req.get('host')}${req.originalUrl}`);
console.log(url) 
```

您将得到如下所示的结果。我根据图像更改了属性的顺序，以便它可以匹配图像流。

```
URL {
  href: 'http://localhost:5000/a/b/c?d=true&e=true',
  protocol: 'http:',
  username: '',
  password: '',
  hostname: 'localhost',
  port: '5000',
  host: 'localhost:5000',
  origin: 'http://localhost:5000',
  pathname: '/a/b/c',
  search: '?d=true&e=true',
  searchParams: URLSearchParams { 'd' => 'true', 'e' => 'true' },
  hash: ''
} 
```

**注意**：`Hash`不能发送到服务器，因为它被视为`Fragment`在服务器中，但您将在客户端即浏览器中得到它。

文档：[https ://nodejs.org/api/url.html#url_new_url_input_base](https://nodejs.org/api/url.html#url_new_url_input_base)

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2020-06-04T02:08:01.157

只是下面的代码对我来说就足够了！

```
const baseUrl = `${request.protocol}://${request.headers.host}`;
// http://127.0.0.1:3333 
```

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2014-02-18T19:30:41.200

我建议使用 originalUrl 而不是 URL：

```
var url = req.protocol + '://' + req.get('host') + req.originalUrl; 
```

在此处查看 originalUrl 的描述：http: [//expressjs.com/api.html#req.originalUrl](http://expressjs.com/api.html#req.originalUrl)

在我们的系统中，我们做了这样的事情，所以 originalUrl 对我们很重要：

```
 foo = express();
  express().use('/foo', foo);
  foo.use(require('/foo/blah_controller')); 
```

blah_controller 看起来像这样：

```
 controller = express();
  module.exports = controller;
  controller.get('/bar/:barparam', function(req, res) { /* handler code */ }); 
```

所以我们的 URL 具有以下格式：

```
www.example.com/foo/bar/:barparam 
```

因此，我们需要在 bar 控制器 get 处理程序中使用 req.originalUrl。

* * *

## 回答 #11

> 赞同：8
> 
> 时间：2017-01-18T10:08:16.070

```
var full_address = req.protocol + "://" + req.headers.host + req.originalUrl; 
```

或者

```
var full_address = req.protocol + "://" + req.headers.host + req.baseUrl; 
```

* * *

## 回答 #12

> 赞同：7
> 
> 时间：2012-04-17T00:08:00.520

您需要使用`req.headers.host + req.url`. 当然，如果您在不同的端口托管，那么您就会明白；-)

* * *

## 回答 #13

> 赞同：6
> 
> 时间：2013-06-12T08:02:24.690

我的代码看起来像这样，

`params['host_url'] = req.protocol + '://' + req.headers.host + req.url;`

* * *

## 回答 #14

> 赞同：6
> 
> 时间：2014-10-12T13:56:36.747

我使用节点包'url'（npm install url）

它的作用是当你打电话时

```
url.parse(req.url, true, true) 
```

它将使您能够检索全部或部分 url。更多信息：[https ://github.com/defunctzombie/node-url](https://github.com/defunctzombie/node-url)

我以以下方式使用它来获取[http://www.example.com/](http://www.example.com/)中 / 之后的任何内容以用作变量并提取特定配置文件（有点像 facebook：[http://www.facebook. com/用户名](http://www.facebook.com/username)）

```
 var url = require('url');
    var urlParts = url.parse(req.url, true, true);
    var pathname = urlParts.pathname;
    var username = pathname.slice(1); 
```

尽管要使其正常工作，但您必须在 server.js 文件中以这种方式创建路由：

```
self.routes['/:username'] = require('./routes/users'); 
```

并以这种方式设置您的路线文件：

```
router.get('/:username', function(req, res) {
 //here comes the url parsing code
} 
```

* * *

## 回答 #15

> 赞同：6
> 
> 时间：2019-11-19T13:05:58.647

您可以像这样在路线中使用此功能

```
app.get('/one/two', function (req, res) {
    const url = getFullUrl(req);
}

/**
 * Gets the self full URL from the request
 * 
 * @param {object} req Request
 * @returns {string} URL
 */
const getFullUrl = (req) => `${req.protocol}://${req.headers.host}${req.originalUrl}`; 
```

`req.protocol`会给你 http 或 https， `req.headers.host`会给你完整的主机名，比如 www.google.com， `req.originalUrl`会给你剩下的`pathName`（在你的情况下`/one/two`）

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2019-03-08T21:43:44.993

谢谢大家提供这些信息。这是令人难以置信的烦人。

将此添加到您的代码中，您将永远不必再考虑它：

```
var app = express();

app.all("*", function (req, res, next) {  // runs on ALL requests
    req.fullUrl = req.protocol + '://' + req.get('host') + req.originalUrl
        next()
}) 
```

您也可以在那里执行或设置其他操作，例如登录到控制台。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2021-12-15T13:18:28.923

您可以从 express 的 req 中获取完整的 url。

```
function fetchPages(req, res, next) {

    let fullUrl = req.headers.host + req.originalUrl;
    console.log("full url ==> ",fullUrl);
} 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2020-12-28T06:05:18.840

```
async function (request, response, next) {
  const url = request.rawHeaders[9] + request.originalUrl;
  //or
  const url = request.headers.host + request.originalUrl;
} 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2021-11-22T22:32:06.213

您可以组合`req.protocol`、`req.hostname`和`req.originalUrl`。注意`req.hostname`而不是`req.host`或`req.get("host")`哪个有效但更难阅读。

```
const completeUrl = `${req.protocol}://${req.hostname}${req.originalUrl}`; 
```

* * *

## 回答 #20

> 赞同：-1
> 
> 时间：2021-10-15T02:38:14.470

通常我依赖这2个，取决于服务器和代理是否存在：

`req.socket.remoteAddress`

`req.headers.referer`

* * *

## 回答 #21

> 赞同：-2
> 
> 时间：2021-12-07T07:36:27.970

只需将其放在`.env`.gitignore 忽略 .env 文件的位置，因此对于每个服务器环境，您将拥有不同的 .env，其中包含该服务器的主机字符串

.env 代码

```
HOSTNAME=example.com 
```

您想要热名称的文件。

```
const dotenv = require("dotenv");
dotenv.config();

console.log('hostname: '+process.env.HOSTNAME) 
```

输出：

```
hostname: example.com 
```

* * *

## 回答 #22

> 赞同：-3
> 
> 时间：2021-11-10T14:13:04.400

```
const fullUrl = `${protocol}://${host}:${port}${url}`

    const responseString = `Full URL is: ${fullUrl}`;                       
    res.send(responseString);  
}) 
```

# r - 如何从 ggplot2 方面删除空因子？

> ID：10183292
> 
> 赞同：34
> 
> 时间：2012-04-16T23:57:07.807
> 
> 标签：r, ggplot2

我正在尝试通过根据因子变量引入构面来修改[简单森林图的示例。](http://statbandit.wordpress.com/2010/11/01/forest-plots-using-r-and-ggplot2/)

假设这个结构的数据：

```
test <- structure(list(characteristic = structure(c(1L, 2L, 3L, 1L, 2L
), .Label = c("Factor1", "Factor2", "Factor3"), class = "factor"), 
    es = c(1.2, 1.4, 1.6, 1.3, 1.5), ci_low = c(1.1, 1.3, 1.5, 
    1.2, 1.4), ci_upp = c(1.3, 1.5, 1.7, 1.4, 1.6), label = structure(c(1L, 
    3L, 5L, 2L, 4L), .Label = c("1.2 (1.1, 1.3)", "1.3 (1.2, 1.4)", 
    "1.4 (1.3, 1.5)", "1.5 (1.4, 1.6)", "1.6 (1.5, 1.7)"), class = "factor"), 
    set = structure(c(1L, 1L, 1L, 2L, 2L), .Label = c("H", "S"
    ), class = "factor")), .Names = c("characteristic", "es", 
"ci_low", "ci_upp", "label", "set"), class = "data.frame", row.names = c(NA, 
-5L)) 
```

并运行代码：

```
p <- ggplot(test, aes(x=characteristic, y=es, ymin=ci_low, ymax=ci_upp)) + geom_pointrange() +
  coord_flip() + geom_hline(aes(x=0), lty=2) + 
  facet_wrap(~ set, ncol = 1) +
  theme_bw() + 
  opts(strip.text.x = theme_text()) 
```

产生这样的输出：

![在此处输入图像描述](../Images/1bb77108370efbd8f297cef56017cf08.png)

到目前为止一切都很好。但是，我想从我的下部面板中删除空的 Factor3 级别，并且找不到这样做的方法。有没有办法做到这一点？

感谢帮助。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-04-18T23:38:43.843

**EDIT** Updated to ggplot2 0.9.3

Here's another solution. It uses `facet_grid` and `space = "free"`; also it uses `geom_point()` and `geom_errorbarh()`, and thus there is no need for `coord.flip()`. Also, the x-axis tick mark labels appear on the lower panel only. In the code below, the `theme` command is not essential - it is used to rotate the strip text to appear horizontally. Using the `test` dataframe from above, the following code should produce what you want:

```
library(ggplot2)

p <- ggplot(test, aes(y = characteristic, x = es, xmin = ci_low, xmax = ci_upp)) +
   geom_point() +
   geom_errorbarh(height = 0) +
   facet_grid(set ~ ., scales = "free", space = "free") +
   theme_bw() +
   theme(strip.text.y = element_text(angle = 0))

p 
```

The solution is based on the example on page 124 in Wickham's ggplot2 book.

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2012-04-17T00:07:29.927

使用`scales = "free"`如下：

```
p <- ggplot(test, aes(x=characteristic, y=es, ymin=ci_low, ymax=ci_upp)) + geom_pointrange() +
  coord_flip() + geom_hline(aes(x=0), lty=2) + 
  facet_wrap(~ set, ncol = 1, scales="free") +
  theme_bw() + 
  opts(strip.text.x = theme_text())

p 
```

产生：

![在此处输入图像描述](../Images/bfc8444cc683022c3858b1f89f847e48.png)

编辑：我实际上认为我`drop = TRUE`更喜欢这个解决方案的论点，如：

```
p <- ggplot(test, aes(x=characteristic, y=es, ymin=ci_low, ymax=ci_upp)) + 
  geom_pointrange() +
  coord_flip() + geom_hline(aes(x=0), lty=2) + 
  facet_wrap(~ set, ncol = 1,  drop=TRUE) +
  theme_bw() + 
  opts(strip.text.x = theme_text())

p 
```

# microsoft-metro - WinRT GridView 但没有 GridViewColumn

> ID：10183294
> 
> 赞同：1
> 
> 时间：2012-04-16T23:57:19.037
> 
> 标签：microsoft-metro, windows-runtime

我没有安装 Windows 8 和 Metro。我的问题是基于文档。

似乎 DataGrid 消失了，但 ListView 和 GridView 仍然存在。GridViewColumn 不见了。我得到了地铁的瓷砖性质。我的问题是可以为行列显示配置 GridView 吗？

我有一个应用程序，大部分情况下在 Metro 下都会表现出色，并且会从版权合同中受益。但是有一页我需要像演示文稿一样的老式 GridViewColumn。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T09:32:46.437

我不确定我是否有你的问题。您希望添加到 ListView/GridView 的元素连续显示吗？我使用以下代码以水平方向显示项目：

```
<GridView>
 <GridView.ItemsPanel>
  <ItemsPanelTemplate>
   <WrapGrid Orientation="Horizontal"/>
  </ItemsPanelTemplate>
 </GridView.ItemsPanel>
</GridView> 
```

# c# - 如何检测用户的行走方向？

> ID：10183296
> 
> 赞同：-2
> 
> 时间：2012-04-16T23:57:46.497
> 
> 标签：c#, console-application, kinect, openkinect

我正在尝试使用 Kinect 创建一个程序，在该程序中观察用户，程序的输出告诉用户行走的方向。

我的意思是，如果用户向前走，输出应该是.. UP

```
0    <=  8 <=        // the user (8) is walking forward  (<=) to the camera (0=kinect) 
```

如果用户往回走，则输出应为 DOWN。如果用户向左走，则输出应为 LEFT。RIGHT 也是如此。

直到我拥有的是：

```
 private static  KinectSensor kinectSensor;
    static void Main(string[] args)
    {
        kinectSensor = KinectSensor.KinectSensors[0];
        kinectSensor.SkeletonStream.Enable();
        kinectSensor.Start();
        kinectSensor.SkeletonFrameReady += kinectRuntime_SkeletonFrameReady;

        while (true) { }
    }

    private static Skeleton[] data;
    static void kinectRuntime_SkeletonFrameReady(object sender, SkeletonFrameReadyEventArgs e)
    {
        using (SkeletonFrame skeletonFrame = e.OpenSkeletonFrame())
        {
            if (skeletonFrame != null)
            {
                if ((data == null) || (data.Length != skeletonFrame.SkeletonArrayLength))
                    data = new Skeleton[skeletonFrame.SkeletonArrayLength];
                skeletonFrame.CopySkeletonDataTo(data);

                foreach (Skeleton ske in data)
                {
                    if (ske.TrackingState == SkeletonTrackingState.Tracked)
                    {
                        var joints = ske.Joints;

                        foreach (Joint joint in ske.Joints)
                        {
                            if (joint.JointType == JointType.HandLeft)
                            {
                                Console.WriteLine(joint.Position.X.ToString(".##"));
                                Console.WriteLine(joint.Position.Y.ToString(".##"));
                                Console.WriteLine(joint.Position.Z.ToString(".##"));
                            }
                        }
                    }
                }
            }
        }
    } 
```

这只是告诉你左手的位置。我对 Kinect 库了解不多，所以我需要一点帮助来做这件事。

我看过帖子，但我仍然不明白这对我有什么帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T02:37:12.043

由于所有关节都有一个 X、Y、Z 值，因此检测向前和向后（向上和向下）就像监控关节的 Z 坐标一样容易。检测左右就像监控 X 坐标值一样简单。显然，您需要一点缓冲空间，因为很难期望有人专门在每个轴上移动。

`Spine`可能是一个很好的监测关节，因为走路时手会摆动。您需要做的就是比较最后 3 或 4 个骨架帧，以查看用户似乎正在朝哪个方向移动，并将其映射到您需要的任何方向。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T06:04:39.100

要检查某个方向的运动，您需要保留一段时间的关节历史记录。例如最后 0.5 秒的最后 16 帧。如果你有，你可以分析运动的方向，将关节的实际位置（例如 HipCenter）与历史进行比较。通过检查所有 3 个轴，您可以说用户是向右、向左、向前、向后移动。他是在跳还是蹲。

要制作这样的历史记录，您可以创建一些结构的列表。该结构需要有一个时间戳。使用时间戳，您可以删除早于 0.5 秒的条目，因此您的列表不会增长太多。在每一帧中，您将列表放入循环中，并通过比较关节位置将每个元素与实际位置进行比较

# sorting - 时间复杂度：具有唯一键的插入排序

> ID：10183297
> 
> 赞同：2
> 
> 时间：2012-04-16T23:58:01.067
> 
> 标签：sorting, data-structures, time-complexity

我有一个由 30 个元素组成的随机有序数组，其中只有 3 个不同的键（`TRUE`和`FALSE`）`NULL`，我想使用插入排序对其进行排序。时间复杂度是多少？假设最坏情况是 O(n ² )，还是假设最好情况是 O(n)，因为只有 3 个不同的键？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T00:00:14.630

*n*指的是数组的大小，而不是数组的可能元素。因此，复杂性是相同的：

*   最坏情况：O(n ² )
*   最佳情况：O(n)
*   平均情况：O(n ² )

拥有 3 个不同的元素将减少您在“插入”阶段必须检查的元素数量，但只能减少一个常数因子。这不会改变渐近运行时间。

例如，在一般情况下，插入检查*n 个*元素而不是检查*^n* / [3 个]元素。这更好，但不是渐近的。

# ruby-on-rails-3 - ActiveModel::MassAssignmentSecurity::Error：无法批量分配受保护的属性：

> ID：10183298
> 
> 赞同：4
> 
> 时间：2012-04-16T23:58:08.303
> 
> 标签：ruby-on-rails-3, activerecord

我正在关注 Lynda.com 的教程 Ruby on Rail 3 Essential Training。我很难创建一个活动记录条目。这是我在控制台中遇到的错误。

```
1.9.3p125 :007 > user = User.new(:first_name => "Mike", :last_name => "Jones")
ActiveModel::MassAssignmentSecurity::Error: Can't mass-assign protected attributes: first_name, last_name
    from /home/mark/.rvm/gems/ruby-1.9.3-p125/gems/activemodel-3.2.3/lib/active_model/mass_assignment_security/sanitizer.rb:48:in `process_removed_attributes'
    from /home/mark/.rvm/gems/ruby-1.9.3-p125/gems/activemodel-3.2.3/lib/active_model/mass_assignment_security/sanitizer.rb:20:in `debug_protected_attribute_removal'
    from /home/mark/.rvm/gems/ruby-1.9.3-p125/gems/activemodel-3.2.3/lib/active_model/mass_assignment_security/sanitizer.rb:12:in `sanitize'
    from /home/mark/.rvm/gems/ruby-1.9.3-p125/gems/activemodel-3.2.3/lib/active_model/mass_assignment_security.rb:230:in `sanitize_for_mass_assignment'
    from /home/mark/.rvm/gems/ruby-1.9.3-p125/gems/activerecord-3.2.3/lib/active_record/attribute_assignment.rb:75:in `assign_attributes'
    from /home/mark/.rvm/gems/ruby-1.9.3-p125/gems/activerecord-3.2.3/lib/active_record/base.rb:498:in `initialize'
    from (irb):7:in `new'
    from (irb):7
    from /home/mark/.rvm/gems/ruby-1.9.3-p125/gems/railties-3.2.3/lib/rails/commands/console.rb:47:in `start'
    from /home/mark/.rvm/gems/ruby-1.9.3-p125/gems/railties-3.2.3/lib/rails/commands/console.rb:8:in `start'
    from /home/mark/.rvm/gems/ruby-1.9.3-p125/gems/railties-3.2.3/lib/rails/commands.rb:41:in `<top (required)>'
    from script/rails:6:in `require'
    from script/rails:6:in `<main>` 
```

这就是我的模型中的内容：

```
class User < ActiveRecord::Base
  attr_accessible :first_name, :last_name
end 
```

我究竟做错了什么。我有导轨 3.2.3

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-22T20:37:00.763

据我所知，lynda 课程是在 rails3 和 rails 3.2.3 上开发的，默认情况下没有质量分配。你必须去你的模型并添加 attr_accessible :name, :position, :visible。基本上，您必须添加要批量分配的每个属性。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-17T00:13:37.673

尝试重新启动控制台。如果您在控制台启动后为用户创建了模型，您应该重新启动它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-12T16:57:23.087

我也遵循 Lynda.com 的教程 Ruby on Rail 3 Essential Training，如果有人遇到同样的问题，这对我有用，

关闭安全设置。打开 config/application.rb 并将 config.active_record.whitelist_attributes 更改为 false 而不是 true。这会降低您的应用程序的安全性，但可以让您快速推进本教程。这是来自：[http ://www.lynda.com/Ruby-on-Rails-3-tutorials/essential-training/55960-2/faqs](http://www.lynda.com/Ruby-on-Rails-3-tutorials/essential-training/55960-2/faqs)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-09T01:51:34.850

我刚刚将 attr_accessible :first_name, :last_name, :username 行添加到模型文件中。这对我有用。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-05-18T15:24:56.480

在没有任何预防措施的情况下，大规模赋值允许攻击者设置任何数据库列的值，因此默认情况下它已被禁用。

```
def signup
  params[:user] # => {:name => “ow3ned”, :admin => true}
  @user = User.new(params[:user])
end 
```

详细描述在[Ruby On Rails 安全指南](http://guides.rubyonrails.org/security.html#mass-assignment)中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-26T23:01:20.507

确保放入`attr_accessible :first_name, :last_name`用户模型而不是控制器。

# php - php & sum xml中的属性值

> ID：10183300
> 
> 赞同：0
> 
> 时间：2012-04-16T23:58:23.377
> 
> 标签：php, xml, xml-parsing

我有一个用 php 读取的 xml 文件。目前我已经加载了 xml，它的内容在表格中很好地显示。目前我正在尝试总结“点”属性的所有值，计算平均值并显示该数字。

任何帮助都会受到欢迎，因为目前我必须将所有这些数字加到计算器上。

xml的基本结构，大大简化：

```
<data>

...

<season id="1" foo1="bar1" points="1" />  
<season id="2" foo2="bar2" points="2" />
<season id="3" foo3="bar3" points="4" />
<season id="4" foo4="bar4" points="0" /> 

...

</data> 
```

我的PHP：

```
<?php
$url = "data.xml";
$xml = simplexml_load_file($url);

// loop through xml
foreach($xml->season as $season)
{

...

echo "<tr>";
echo "<td>".$season["id"]."</td>";
echo "</tr>";

...

}
// end ofloop

... 

// don't really know what to do here
// to get to the paragaph below:

<p>Average points = $average_points </p>
?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T00:02:01.257

```
$total = 0;
$items = 0;

foreach ($xml->season as $season) {

    ...

    $total += $season['points'];
    $items++;

}

if ($items) {
    $average_points = $total / $items;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T00:07:56.420

干得好。

```
<?php
     $url = "data.xml";
     $xml = simplexml_load_file($url);

     foreach($xml->season as $season)
     {
          echo "<tr>";
          echo "<td>".$season->id."</td>";
          echo "</tr>";
     }

     $count = 0;
     $sum = 0

     foreach($xml->season as $season)
     {
          ++$count;
          $sum += $season->points;
     }

     $average = $sum / $count; 
```

# c# - 如何在服务器上调用脚本运行中的属性

> ID：10183307
> 
> 赞同：0
> 
> 时间：2012-04-16T23:59:28.600
> 
> 标签：c#, asp.net, web

我有一个需要在 .aspx 中调用的函数，它在如下标记中，我遇到的问题是我需要评估 .cs 类中的属性。我怎么能做到这一点？

```
<script type="text/javascript">
    function Redirect() {
        location.href = "homePage.aspx";
    } 
 </script> 
     <script runat="server"> 
        protected void Button1_Click(Object sender, EventArgs e)
        {
            if (something is true from the propties set in .cs)
            {
                Page.ClientScript.RegisterStartupScript(this.GetType(),
               "ConfirmBox", "if(confirm('The numbers selected are not in the directory, you wish to continue?') == true){Redirect();};", true);
            } 
        }
    </script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T00:40:49.127

您可以使用命名空间来执行此操作：首先将您的类放在命名空间中

```
namespace testNamespace
{
  public class test
    {
       public static bool tester(int x, int y)
        {
            if (x == y)
            {
                return true;
            }
            else return false;
        }
    }
} 
```

要导入您的命名空间，请使用

```
 <%@ Import Namespace="testNamespace" %>

<script runat="server"> 
        protected void Button1_Click(Object sender, EventArgs e)
        {
            if (test.tester(2, 2))
            {
                Page.ClientScript.RegisterStartupScript(this.GetType(),
               "ConfirmBox", "if(confirm('The numbers selected are not in the directory, you wish to continue?') == true){Redirect();};", true);
            } 
        }
    </script> 
```

使用此脚本，您可以将值传递给您的类文件，对其进行验证并返回您的答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T00:08:47.257

您可以在您的 CS 类中定义一个属性，并使用像这样的 Partial 类来访问它

CS：

```
public partial class WebForm1 : System.Web.UI.Page
    {
        public bool MyProperty { get; set; }

       protected void Page_PreInit(object sender,EventArgs e)
       {
           MyProperty = true;
       }

        protected void Page_Load(object sender, EventArgs e)
        {

        }
    } 
```

ASPX：

```
<%@ Page Language="C#" AutoEventWireup="true" CodeBehind="WebForm1.aspx.cs" Inherits="WebApplication1.WebForm1" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title></title>

    <script runat="server"> 
    protected void Button1_Click(Object sender, EventArgs e)
    {
        if (MyProperty)
        {
            Page.ClientScript.RegisterStartupScript(this.GetType(),
           "ConfirmBox", "if(confirm('The numbers selected are not in the directory, you wish to continue?') == true){Redirect();};", true);
        } 
    }
</script>

</head>
<body>
    <form id="form1" runat="server">
    <div>
        <asp:Button Text="text" runat="server" OnClick=Button1_Click />
    </div>
    </form>
</body>
</html> 
```

# ruby - 创建 Mongoid 嵌入文档

> ID：10183309
> 
> 赞同：-1
> 
> 时间：2012-04-16T23:59:41.130
> 
> 标签：ruby, mongodb, mongoid

我是第一次使用 Mongoid。我想存储具有主题、正文和收件人、抄送和密件抄送收件人数组的电子邮件集合。例子：

```
{to: [{email: 'andrew@example.com', name: 'Andrew'}], cc: ... 
```

但是，我似乎无法弄清楚如何使用 Mongoid 对这些数据进行建模。我认为这些术语称为嵌入式文档，但我尝试过的所有内容似乎都无法正常工作。如何使用 Mongoid 正确创建模型？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T23:25:42.357

这是解决方案。如果要为多个字段重用一个类，可以指定类名：

```
class Email
  include Mongoid::Document

  embeds_many :to_recipients, :class_name => "Recipient"
  embeds_many :cc_recipients, :class_name => "Recipient"
  embeds_many :bcc_recipients, :class_name => "Recipient"    
  embeds_one :from, :class_name => "Recipient"

  field :subject, type: String
  field :body_text, type: String
  field :body_html, type: String
end

class Recipient
  include Mongoid::Document
  field :email_address, type: String
  field :name, type: String
  validates :email_address, :presence => true
  embedded_in :emails
end 
```

# c++ - OpenGL 混合功能可消除图元重叠但保持整体不透明度

> ID：10183311
> 
> 赞同：1
> 
> 时间：2012-04-16T23:59:54.510
> 
> 标签：c++, opengl, openscenegraph

我有一些几何图形，它有一个单一的原始集，它是一个三条带。图元中的一些三角形重叠，所以当我将材质添加到具有 alpha 值的几何体时，我看到了重叠（如预期的那样）。我想在不改变几何形状的情况下摆脱这种效果——我尝试使用不同的混合模式（glBlendFunc()），但我无法让它工作。我得到了一些有趣的结果，但没有什么可以消除三条基元中的不透明度效果，并保留整个对象的不透明度。我正在使用 OpenSceneGraph，但它提供了一种为相关几何调用 glBlendFunc() 的方法。

![在此处输入图像描述](../Images/937963c41dbfd49d2f0dec51a4622f9d.png)

所以从图中，假设粉红色的道路、紫色的道路和黄色的道路构成三个独立的对象，每个对象都使用一个三条创建（有多个条，但为了论证起见，假设这里只有三个不同颜色的三条） . 我基本上不想看到相同颜色内的自我交叉点

此外，我的问题与这个问题几乎相同：[OpenGL, Primitives with opacity without visible overlay](https://stackoverflow.com/questions/6972338/opengl-primitives-with-opacity-without-visible-overlap)，但我应该注意，当我在该问题的接受答案中尝试混合模式时，条带没有在场景中渲染全部。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T00:39:13.317

我在之前的项目中遇到过同样的问题。这是我解决它的方法：

```
glBlendFunc(GL_ONE_MINUS_DST_ALPHA, GL_DST_ALPHA) 
```

> 并绘制矩形。这背后的想法是，您绘制一个具有所需透明度的矩形，该矩形取自帧缓冲区，但在进度中掩盖您绘制的区域，以便您随后的矩形将在那里被掩盖。

来源：[Stackoverflow：重叠矩形](https://stackoverflow.com/questions/6972338/opengl-primitives-with-opacity-without-visible-overlap)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T00:40:04.293

一种方法是将每组路径渲染到纹理，然后使用 alpha 将纹理绘制到窗口上。您可以为每种颜色的路径执行此操作。

[这](http://ogltotd.blogspot.com.au/2006/12/render-to-texture.html)概述了总体思路。

# python - cvWriteFrame 抛出 IplImage *：在 python 中无法转换为 CvMat 错误

> ID：10183313
> 
> 赞同：0
> 
> 时间：2012-04-17T00:00:10.770
> 
> 标签：python, opencv

我正在尝试从 python 中的 jpeg 图像构建视频。

这是我的代码。

```
 codec = highgui.CV_FOURCC('F', 'L', 'V', '1')
    fps = 25
    colored = 1
    size = (float(width), float(height))
    video_writer = highgui.cvCreateVideoWriter(
                'out.mpg', codec, fps, cv.cvSize(1440, 553), True)

    pictures = os.listdir(folder)
    for picture in pictures:
        picture = '%s/%s' % (folder, picture)
        highgui.cvWriteFrame(self.video_writer, picture) 
```

高度、宽度和文件夹已在其他地方定义。当我运行代码时，我收到以下错误：

```
Output #0, mpeg, to 'out.mpg':
    Stream #0.0: Video: flv, yuv420p, 1440x553, q=2-31, 50964 kb/s, 90k tbn, 25 tbc
[mpeg @ 0x29425c0] VBV buffer size not set, muxing may fail
Traceback (most recent call last):
  File "./ips.py", line 109, in <module>
    main()
  File "./ips.py", line 62, in main
    video.build(configs['maps']['folder'])
  File "/home/martin/Formspring/maraca-locator-94947aa/encoder.py", line 34, in build
    highgui.cvWriteFrame(self.video_writer, picture)
TypeError: %%typemap(in) IplImage * : could not convert to CvMat 
```

我不知道我做错了什么，知道是什么原因造成的吗？有没有首选的构建框架的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T13:05:05.507

`cvWriteFrame()`需要一个有效的`IplImage*`，而你似乎没有。

考虑以下代码：

```
pictures = os.listdir(folder)
    for picture in pictures:
        picture = '%s/%s' % (folder, picture)
        highgui.cvWriteFrame(self.video_writer, picture) 
```

`listdir()`返回一个列表，其中包含由 . 给定的目录中的条目名称`folder`。之后，您声明`picture`要在此列表上进行迭代，因此它只存储一个条目。这就是您感到困惑的地方：此时，**`picture`只是一个 string**。

调用前`cvWriteFrame()`需要先从磁盘加载图片数据并查看是否加载成功：

```
pictures = os.listdir(folder)
    for picture in pictures:
        picture = '%s/%s' % (folder, picture)
        img = cv.LoadImage(picture)
        if not img:
            print "!!! Could not load image " + picture 
            break

        highgui.cvWriteFrame(self.video_writer, img) 
```

# java - 在 Hadoop 上的 Java 中运行嵌入式 pig 时权限被拒绝错误

> ID：10183321
> 
> 赞同：3
> 
> 时间：2012-04-17T00:01:16.907
> 
> 标签：java, permissions, hadoop, apache-pig

上周我使用用户“ **root** ”来启动 Hadoop 的 dfs & mapreduce 并运行 Embedded-Pig Java 代码。它运行良好。本周我想使用**非 root 用户执行相同的任务：charlie**。在更改了一些目录的用户权限设置后，现在我可以使用用户“charlie”来启动 Hadoop 的 dfs 和 mapreduce，而不会出现错误。但是，当我使用用户“charlie”运行 Embedded-Pig Java 代码时，它一直抱怨我在**core-stie.xml****中**设置为**/opt/hdfs/tmp/**的 hadoop.tmp.dir 的权限：

 **> java.io.FileNotFoundException：/opt/hdfs/tmp/mapred/local/localRunner/job_local_0001.xml（权限被拒绝）

我检查了以下目录的权限，它们看起来都不错：

```
 bash-3.2$ ls -lt /opt/hdfs/tmp
    total 4
    drwxr-xr-x 3 charlie comusers 4096 Apr 16 19:30 mapred
    bash-3.2$ ls -lt /opt/hdfs/tmp/mapred
    total 4
    drwxr-xr-x 2 charlie comusers 4096 Apr 16 19:30 local
    bash-3.2$ ls -lt /opt/hdfs/tmp/mapred/local
    total 0 
```

我需要一些关于我做错了什么的指导。我用谷歌搜索了这些关键字，但一无所获。任何帮助，将不胜感激！

我已按如下方式附加了猪输出。希望这些信息会有所帮助。

```
12/04/16 19:31:28 INFO executionengine.HExecutionEngine: Connecting to hadoop file system at: hdfs://hadoop-namenode:9000
12/04/16 19:31:29 INFO pigstats.ScriptState: Pig features used in the script: HASH_JOIN,GROUP_BY,FILTER,CROSS
12/04/16 19:31:29 INFO jvm.JvmMetrics: Initializing JVM Metrics with processName=JobTracker, sessionId=
12/04/16 19:31:29 INFO mapReduceLayer.MRCompiler: File concatenation threshold: 100 optimistic? false
12/04/16 19:31:30 INFO mapReduceLayer.CombinerOptimizer: Choosing to move algebraic foreach to combiner
12/04/16 19:31:30 INFO mapReduceLayer.MRCompiler$LastInputStreamingOptimizer: Rewrite: POPackage->POForEach to POJoinPackage
12/04/16 19:31:30 INFO mapReduceLayer.MRCompiler$LastInputStreamingOptimizer: Rewrite: POPackage->POForEach to POJoinPackage
12/04/16 19:31:30 INFO mapReduceLayer.MRCompiler$LastInputStreamingOptimizer: Rewrite: POPackage->POForEach to POJoinPackage
12/04/16 19:31:30 INFO mapReduceLayer.MRCompiler$LastInputStreamingOptimizer: Rewrite: POPackage->POForEach to POJoinPackage
12/04/16 19:31:30 INFO mapReduceLayer.MRCompiler$LastInputStreamingOptimizer: Rewrite: POPackage->POForEach to POJoinPackage
12/04/16 19:31:30 INFO mapReduceLayer.MRCompiler$LastInputStreamingOptimizer: Rewrite: POPackage->POForEach to POJoinPackage
12/04/16 19:31:30 INFO mapReduceLayer.MultiQueryOptimizer: MR plan size before optimization: 11
12/04/16 19:31:30 INFO mapReduceLayer.MultiQueryOptimizer: Merged 0 out of total 3 MR operators.
12/04/16 19:31:30 INFO mapReduceLayer.MultiQueryOptimizer: Merged 0 out of total 3 MR operators.
12/04/16 19:31:30 INFO mapReduceLayer.MultiQueryOptimizer: Merged 0 map-reduce splittees.
12/04/16 19:31:30 INFO mapReduceLayer.MultiQueryOptimizer: Merged 0 out of total 3 MR operators.
12/04/16 19:31:30 INFO mapReduceLayer.MultiQueryOptimizer: Merged 0 out of total 2 MR operators.
12/04/16 19:31:30 INFO mapReduceLayer.MultiQueryOptimizer: Merged 0 out of total 2 MR operators.
12/04/16 19:31:30 INFO mapReduceLayer.MultiQueryOptimizer: Merged 1 map-reduce splittees.
12/04/16 19:31:30 INFO mapReduceLayer.MultiQueryOptimizer: Merged 1 out of total 3 MR operators.
12/04/16 19:31:30 INFO mapReduceLayer.MultiQueryOptimizer: MR plan size after optimization: 10
12/04/16 19:31:30 INFO jvm.JvmMetrics: Cannot initialize JVM Metrics with processName=JobTracker, sessionId= - already initialized
12/04/16 19:31:30 INFO jvm.JvmMetrics: Cannot initialize JVM Metrics with processName=JobTracker, sessionId= - already initialized
12/04/16 19:31:30 INFO pigstats.ScriptState: Pig script settings are added to the job
12/04/16 19:31:30 WARN pigstats.ScriptState: unable to read pigs manifest file
12/04/16 19:31:30 INFO mapReduceLayer.JobControlCompiler: mapred.job.reduce.markreset.buffer.percent is not set, set to default 0.3
12/04/16 19:31:35 INFO mapReduceLayer.JobControlCompiler: Setting up multi store job
12/04/16 19:31:35 INFO mapReduceLayer.JobControlCompiler: BytesPerReducer=1000000000 maxReducers=999 totalInputFileSize=957600
12/04/16 19:31:35 INFO mapReduceLayer.JobControlCompiler: Neither PARALLEL nor default parallelism is set for this job. Setting number of reducers to 1
12/04/16 19:31:35 INFO jvm.JvmMetrics: Cannot initialize JVM Metrics with processName=JobTracker, sessionId= - already initialized
12/04/16 19:31:35 INFO mapReduceLayer.MapReduceLauncher: 1 map-reduce job(s) waiting for submission.
12/04/16 19:31:35 WARN mapred.JobClient: Use GenericOptionsParser for parsing the arguments. Applications should implement Tool for the same.
12/04/16 19:31:35 INFO jvm.JvmMetrics: Cannot initialize JVM Metrics with processName=JobTracker, sessionId= - already initialized
12/04/16 19:31:35 INFO jvm.JvmMetrics: Cannot initialize JVM Metrics with processName=JobTracker, sessionId= - already initialized
12/04/16 19:31:35 INFO jvm.JvmMetrics: Cannot initialize JVM Metrics with processName=JobTracker, sessionId= - already initialized
12/04/16 19:31:35 INFO input.FileInputFormat: Total input paths to process : 1
12/04/16 19:31:35 INFO util.MapRedUtil: Total input paths to process : 1
12/04/16 19:31:35 INFO util.MapRedUtil: Total input paths (combined) to process : 1
12/04/16 19:31:36 INFO mapReduceLayer.MapReduceLauncher: 0% complete
12/04/16 19:31:36 INFO mapReduceLayer.MapReduceLauncher: job null has failed! Stop running all dependent jobs
12/04/16 19:31:36 INFO mapReduceLayer.MapReduceLauncher: 100% complete
12/04/16 19:31:36 WARN mapReduceLayer.Launcher: There is no log file to write to.
12/04/16 19:31:36 ERROR mapReduceLayer.Launcher: Backend error message during job submission
java.io.FileNotFoundException: /opt/hdfs/tmp/mapred/local/localRunner/job_local_0001.xml (Permission denied)
    at java.io.FileOutputStream.open(Native Method)
    at java.io.FileOutputStream.<init>(FileOutputStream.java:194)
    at org.apache.hadoop.fs.RawLocalFileSystem$LocalFSFileOutputStream.<init>(RawLocalFileSystem.java:180)
    at org.apache.hadoop.fs.RawLocalFileSystem$LocalFSFileOutputStream.<init>(RawLocalFileSystem.java:176)
    at org.apache.hadoop.fs.RawLocalFileSystem.create(RawLocalFileSystem.java:234)
    at org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer.<init>(ChecksumFileSystem.java:335)
    at org.apache.hadoop.fs.ChecksumFileSystem.create(ChecksumFileSystem.java:368)
    at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:484)
    at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:465)
    at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:372)
    at org.apache.hadoop.fs.FileUtil.copy(FileUtil.java:208)
    at org.apache.hadoop.fs.FileUtil.copy(FileUtil.java:142)
    at org.apache.hadoop.fs.FileSystem.copyToLocalFile(FileSystem.java:1216)
    at org.apache.hadoop.fs.FileSystem.copyToLocalFile(FileSystem.java:1197)
    at org.apache.hadoop.mapred.LocalJobRunner$Job.<init>(LocalJobRunner.java:92)
    at org.apache.hadoop.mapred.LocalJobRunner.submitJob(LocalJobRunner.java:373)
    at org.apache.hadoop.mapred.JobClient.submitJobInternal(JobClient.java:800)
    at org.apache.hadoop.mapred.JobClient.submitJob(JobClient.java:730)
    at org.apache.hadoop.mapred.jobcontrol.Job.submit(Job.java:378)
    at org.apache.hadoop.mapred.jobcontrol.JobControl.startReadyJobs(JobControl.java:247)
    at org.apache.hadoop.mapred.jobcontrol.JobControl.run(JobControl.java:279)
    at java.lang.Thread.run(Thread.java:662)

12/04/16 19:31:36 ERROR pigstats.SimplePigStats: ERROR 2997: Unable to recreate exception from backend error: java.io.FileNotFoundException: /opt/hdfs/tmp/mapred/local/localRunner/job_local_0001.xml (Permission denied)
12/04/16 19:31:36 ERROR pigstats.PigStatsUtil: 1 map reduce job(s) failed!
12/04/16 19:31:36 WARN pigstats.ScriptState: unable to read pigs manifest file
12/04/16 19:31:36 INFO pigstats.SimplePigStats: Script Statistics: 

HadoopVersion   PigVersion  UserId  StartedAt   FinishedAt  Features
0.20.2      charlie 2012-04-16 19:31:30 2012-04-16 19:31:36 HASH_JOIN,GROUP_BY,FILTER,CROSS

Failed!

Failed Jobs:
JobId   Alias   Feature Message Outputs
N/A events,events1,grouped  MULTI_QUERY Message: java.io.FileNotFoundException: /opt/hdfs/tmp/mapred/local/localRunner/job_local_0001.xml (Permission denied)
    at java.io.FileOutputStream.open(Native Method)
    at java.io.FileOutputStream.<init>(FileOutputStream.java:194)
    at org.apache.hadoop.fs.RawLocalFileSystem$LocalFSFileOutputStream.<init>(RawLocalFileSystem.java:180)
    at org.apache.hadoop.fs.RawLocalFileSystem$LocalFSFileOutputStream.<init>(RawLocalFileSystem.java:176)
    at org.apache.hadoop.fs.RawLocalFileSystem.create(RawLocalFileSystem.java:234)
    at org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer.<init>(ChecksumFileSystem.java:335)
    at org.apache.hadoop.fs.ChecksumFileSystem.create(ChecksumFileSystem.java:368)
    at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:484)
    at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:465)
    at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:372)
    at org.apache.hadoop.fs.FileUtil.copy(FileUtil.java:208)
    at org.apache.hadoop.fs.FileUtil.copy(FileUtil.java:142)
    at org.apache.hadoop.fs.FileSystem.copyToLocalFile(FileSystem.java:1216)
    at org.apache.hadoop.fs.FileSystem.copyToLocalFile(FileSystem.java:1197)
    at org.apache.hadoop.mapred.LocalJobRunner$Job.<init>(LocalJobRunner.java:92)
    at org.apache.hadoop.mapred.LocalJobRunner.submitJob(LocalJobRunner.java:373)
    at org.apache.hadoop.mapred.JobClient.submitJobInternal(JobClient.java:800)
    at org.apache.hadoop.mapred.JobClient.submitJob(JobClient.java:730)
    at org.apache.hadoop.mapred.jobcontrol.Job.submit(Job.java:378)
    at org.apache.hadoop.mapred.jobcontrol.JobControl.startReadyJobs(JobControl.java:247)
    at org.apache.hadoop.mapred.jobcontrol.JobControl.run(JobControl.java:279)
    at java.lang.Thread.run(Thread.java:662)

Input(s):
Failed to read data from "/grapevine/analysis/recommendation/input/article_based/all_grapevine_events.txt"

Output(s):

Counters:
Total records written : 0
Total bytes written : 0
Spillable Memory Manager spill count : 0
Total bags proactively spilled: 0
Total records proactively spilled: 0

Job DAG:
null    ->  null,null,
null    ->  null,
null    ->  null,
null    ->  null,null,
null    ->  null,
null    ->  null,null,
null    ->  null,
null    ->  null,
null    ->  null,
null

12/04/16 19:31:36 INFO mapReduceLayer.MapReduceLauncher: Failed! 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-05-29T14:58:28.090

答案已经在评论中发布了：

> 使用 chmod -R youruser foldername 递归更改文件夹的所有者它不会给出错误**

# c++ - 在 C/C++ 中使用枚举

> ID：10183323
> 
> 赞同：1
> 
> 时间：2012-04-17T00:01:30.107
> 
> 标签：c++, c, enums

我正在修改[此处](http://arduino.cc/en/Tutorial/Tone)显示的代码，但是，我不想使用单个值，而是想创建一个可能值的枚举。

如果可能，我想将其保留在头文件中，并且我希望它包含类似...的值

```
enum Notes{
    NOTE_B0 = 31,
    NOTE_C1 = 33,
    NOTE_CS1 = 35
}; 
```

现在我正在寻找遍历枚举值，我该怎么做？

我也可以存储超过 255 的值吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T00:10:14.537

您能做的最好的事情是在某处创建一个包含所有枚举值的静态 const 数组并遍历它。如果枚举值都是连续的，您显然可以很容易地遍历它们，但如果不这样做，您就不走运了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T01:07:54.177

您可以存储适合基础整数类型的所有值。使用 C++11，您可以指定基础整数。如果您没有指定它，编译器将尝试找到一个适合所有值的值。

迭代是不可能的，因为枚举元素只是编译时值。编译器不需要在运行时存储它们。

# jquery - jQuery 活动状态

> ID：10183324
> 
> 赞同：2
> 
> 时间：2012-04-17T00:01:54.140
> 
> 标签：jquery, toggle, show-hide

我正在尝试设置一个简单的切换，但希望活动状态不可点击并隐藏其他项目。

我有一个基本的例子：

```
<script>
$(document).ready(function() {
    $('.entry-title').click(function() {
        $(".entry-content").hide("normal");
        $(this).closest('.post').find('.entry-content').fadeIn();
        return false;
    });
});
</script> 
```

我尝试了 if 语句，但没有运气。

```
$(".entry-title").click(function() {

    if ($(this).hasClass("active")) {

        $(this).removeClass('active');
        $(this).closest('.post').find('.entry-content').fadeIn();

    } else {
        $(this).addClass('active');
        $(".entry-content").hide("normal");
    }
    return false;
}); 
```

我知道必须有一种更简单的方法，但我的大脑无法正常工作。

任何帮助深表感谢。

# service - Azure 服务总线队列主题与 Web/工作者角色队列

> ID：10183326
> 
> 赞同：5
> 
> 时间：2012-04-17T00:02:10.353
> 
> 标签：service, azure, bus

我知道 [在 .NET 服务总线队列与 Azure 队列服务之间进行选择](https://stackoverflow.com/questions/1906244/choosing-between-net-service-bus-queues-vs-azure-queue-service)

提供了一些关于何时将队列用于 web/worker 角色与 Azure 服务总线的答案，但我刚刚开始研究 Azure 并正在寻找更彻底的东西。

它说“NET 服务总线更专为集成系统而设计，而不是提供通用可靠的消息传递系统”。

只是想知道我是否可以澄清这一点？这是否意味着在单独的远程应用程序之间进行通信时，最好使用服务总线队列，而在 web/worker 角色之间进行通信时，您使用普通的 Azure 队列。

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-17T00:51:49.967

与存储队列对应物相比，服务总线队列提供了更多的复杂性。这是一个比较和对比的链接。

[https://docs.microsoft.com/en-gb/azure/service-bus-messaging/service-bus-azure-and-service-bus-queues-compared-contrasted](https://docs.microsoft.com/en-gb/azure/service-bus-messaging/service-bus-azure-and-service-bus-queues-compared-contrasted)

如果我的需求更复杂，如 Pub/Sub 等，我将使用最能满足我需求的队列，优先考虑用于通用工作分配的存储队列和服务总线队列……

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-17T03:49:39.887

服务总线队列和主题遵循 AMQP，包括 FIFO 队列、发布/订阅、确认模式等。它更加标准和开放，这意味着如果您想将您的系统与其他应用程序轻松集成，如果它也遵循 AMQP。

存储队列比服务总线更简单。它为我们提供了角色之间的异步通道。通信协议、消息结构和格式都基于我们自己。

高温高压

# regex - 为什么 POSIX “可打印字符”类与简单字符串不匹配？

> ID：10183328
> 
> 赞同：4
> 
> 时间：2012-04-17T00:02:28.540
> 
> 标签：regex, linux, shell, posix, non-printable

我编写了以下脚本来测试“可打印字符”字符类，如此[处](http://www.regular-expressions.info/posixbrackets.html)所述。

```
#!/bin/sh

case "foo" in
    *[:print:]*) echo "found a printable character" ;;
    *) echo "found no printable characters" ;;
esac 
```

我希望这个脚本能够输出`found a printable character`，其中至少一个（实际上是所有）字符`"foo"`是可打印的。相反，它输出`"found no printable characters"`. 为什么中的字符`"foo"`不能被识别为可打印字符？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-17T00:19:51.650

该字符串`[:`仅*在*括号表达式中是特殊的，括号表达式本身由`[`. 所以你的例子应该是：

```
case "foo" in
    *[[:print:]]*) echo "found a printable character" ;;
    *) echo "found no printable characters" ;;
esac 
```

如果这看起来很麻烦，请考虑例如如何指定应该匹配小写字母或数字但不匹配大写字母的模式。

有关详细信息，请参阅[POSIX 规范中详细说明正则表达式中括号表达式的部分](http://pubs.opengroup.org/onlinepubs/009695399/basedefs/xbd_chap09.html#tag_09_03_05)。shell 模式中的括号表达式类似于正则表达式中的括号表达式，除了对`!`and的处理`^`。（尽管在括号表达式的上下文之外，shell 模式和正则表达式之间还有其他区别）。

# javascript - 如何运行一个在中断前循环并尝试最多 10 次的 setInterval？

> ID：10183329
> 
> 赞同：0
> 
> 时间：2012-04-17T00:02:43.250
> 
> 标签：javascript, jquery

我有以下尝试在连接断开时重新加载：

```
setInterval(window.location.reload(), 1000); 
```

我对此的担心是它可能会永远持续下去，ddos'ing 我的应用程序。

如何在放弃和打破之前更新上述内容以尝试最多 20 次？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T00:06:14.673

这让我觉得很脏，但是您可以在每次刷新时更新/提取窗口哈希：

```
function hack () {
  var last = parseInt(location.hash.slice(1));
  if (last < 20) {
    window.location.hash = last + 1;
    window.location.reload();
  }
}

window.location.hash = 0;
setTimeout(hack, 1000); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T00:25:23.697

您需要从一个页面加载到下一个页面保持一些计数器状态，这样您就可以知道何时完成了 20 次重新加载。您的选择是：

1.  哈希值
2.  查询参数
3.  cookie 值
4.  存储在本地存储中的东西

如果您不需要此值仅在此页面的重新加载后持续存在，那么选项 1) 和 2) 会更好，因为它们仅在您需要时持续存在。哈希值不会发送到您的服务器，但可能会干扰哈希值的其他用途。查询参数将被发送到服务器，但任何合理的服务器都会忽略它不知道的查询值，并且不会干扰其他任何事情。我可能会选择一个查询参数，并且实际上已经使用了一个参数来避免在我的某些代码中出现无限重定向循环。您可以像这样实现选项 2)：

```
function checkAutoReload() {
    var currentCnt = 0;
    var re = /(\?|&)(reloadCnt=)(\d+)/;
    var param = window.location.search.match(re), newURL;
    if (param) {
        currentCnt = parseInt(param[3], 10);
        newURL = window.location.href.replace(re, "$1$2" + (currentCnt + 1))
    } else {
        newURL = window.location.href;
        newURL += window.location.search ? "&" : "?";
        newURL += "reloadCnt=1";
    }
    if (currentCnt < 20) {
        window.location.replace(newURL);
    }
}

setTimeout(checkAutoReload, 1000); 
```

请注意，不需要 a，`setInterval()`因为给定页面的代码仅在重新加载或发现已完成重新加载之前运行一次。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T00:37:56.750

将 reloadCount 存储在 localStorage

[MDN DOM 存储](https://developer.mozilla.org/en/DOM/Storage)

```
 var maxReload = 20;
    var reloadPage = function() {
        if (typeof a !== "undefined" && a !== null) {
            console.log(localStorage.reloadCount);
            localStorage.reloadCount = 0;
        };
        var reloadCount = parseInt(localStorage.reloadCount, 10);
        console.log(reloadCount);
        if (reloadCount < maxReload) {
            reloadCount += 1;
            localStorage.reloadCount = reloadCount;

            // RELOAD CODE HERE
        };
    };

    // call reloadPage from your code
    reloadPage(); 
```

# bash - 在后台执行脚本运行 ssh 命令

> ID：10183331
> 
> 赞同：0
> 
> 时间：2012-04-17T00:02:45.340
> 
> 标签：bash, shell, background-process, tty

我正在尝试`requiretty`在 sudoers 文件中启用的远程服务器上执行此脚本。

```
#!/bin/bash

value=$(ssh -tt localhost sudo bash -c hostname)
echo $value 
```

如果我使用它运行脚本，`$ ./sample.sh &`它将在后台停止。只有使用`fg`我才能强制脚本运行。我认为问题在于输出缺少 tty，但我该怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-21T08:50:12.100

> ... 我能做些什么？

你可以`stty -tostop`。

# ruby - 如何使用 ruby 正则表达式找到完整的数字

> ID：10183332
> 
> 赞同：0
> 
> 时间：2012-04-17T00:03:22.937
> 
> 标签：ruby, regex

我正在寻找字符串中第一个完整出现的数字。我不是在寻找第一个数字，而是整个第一个数字。因此，例如，w134fklj342 中的第一个数字**是**134，而 1235alkj9342klja9034 中的第一个数字**是**1235。

我曾尝试使用 \d 但我不确定如何将其扩展为包含多个数字（未指定数字的长度）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T00:08:15.820

我想，你正在寻找这个正则表达式

```
\d+ 
```

“加”的意思是“一个或多个”。此正则表达式将匹配字符串中的所有数字，因此请选择第一个。

```
strings = ['w134fklj342', '1235alkj9342klja9034']

strings.each do |s|
  puts s[/\d+/]
end
# >> 134
# >> 1235 
```

演示：[http ://rubular.com/r/YE8kPE2SyW](http://rubular.com/r/YE8kPE2SyW)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T09:32:13.657

理解正则表达式的最简单方法是认为 eachbit 是一个字符；例如：`\d`或`[1234567890]`或`[0-9]`将匹配一位数字。

要扩展这一字符，您有 2 个基本选项：`*`和`+`

*   `*`将匹配字符 0 次或更多次
*   `+`将匹配一次或多次

就像塞尔吉奥说的那样，你应该用它`\d+`来匹配许多数字。

一般的正则表达式的优秀教程：[http ://www.regular-expressions.info/tutorial.html](http://www.regular-expressions.info/tutorial.html)

# django - 谷歌应用引擎任务队列未在生产中完成，但在 devserver 中完成

> ID：10183338
> 
> 赞同：0
> 
> 时间：2012-04-17T00:04:00.627
> 
> 标签：django, google-app-engine, task-queue

在开发服务器上运行一些谷歌应用引擎任务时，它以 200 状态完成，但是在生产环境中部署和运行相同的任务时，该任务不会完全执行并重试，直到它使用所有重试计数。

我认为这可能是任务超时的问题，增加它可能会解决我的问题，但不知道该怎么做！！！

顺便说一句我用过

> 打印 >>sys.stderr

跟踪我的代码执行进度以及每次代码在同一点停止时

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-03T10:06:12.397

由于执行总是在同一点停止，这不太可能是超时。您的应用程序可能正在尝试执行 App Engine 沙箱中不允许的操作。

# java - 实现依赖注入混淆

> ID：10183341
> 
> 赞同：0
> 
> 时间：2012-04-17T00:04:46.260
> 
> 标签：java, dependency-injection, inversion-of-control

我有三个主要的类，比如说 A、B 和 C。A 实例化 B 和 C。B 也依赖于 C。B 通过 setter/getter 方法访问 C 的对象。这可以。我的问题是 A 的实现与 B 和 C 的实现紧密耦合。我想解耦这个。我不想使用spring框架。还有其他方法吗？我想为他们的(B,C) 初始化创建工厂，但这意味着每当 A 或 C 需要访问 B 时，他们必须再次创建工厂的新实例。这似乎不对。我应该如何解决这个问题？我不确定 IOC 容器在这里是否有用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T00:09:57.980

`A`不应直接实例化`B`or `C`。相反，它应该接受它们的实例作为构造函数参数：

```
public class A
{
    private B b;
    private C c;

    public A(B b, C c)
    {
        this.b = b;
        this.c = c;
    }
}

// When creating your object graph, in the "composition root":
B b = new B();
C c = new C(b);
A a = new A(b, c); 
```

这与`A`实例化`B`s 和`C`s 的细节分离，通过注入这些依赖项（因此，依赖注入）。

为了与实现分离`A`，*您*`B`需要为关心的功能`C`创建接口。`A`说，`Bable`和`Cable`。然后`A`可以接受 a`Bable`和 a作为其构造函数参数，并且不关心实现这些接口的类发生了什么，或者实现是如何工作的——只要它符合and`Cable`制定的合同。`Bable``Cable`

这是我所说的一个完整的例子：[https ://gist.github.com/2402514](https://gist.github.com/2402514)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T00:11:35.070

您可以指定 A 应在其构造函数中使用的具体对象，然后将它们存储为成员变量。这样您就不必多次创建对象，并且可以提供其他类的对象（例如，实现与 B 相同的接口）

```
public class A
{
  private BIface b;
  private CIface c;
  public A(BIface b, CIface c) {
    this.b = b;
    this.c = c;
  }
}

interface BIface {
  // required B methods
}

public class B implments BIface
{
  // implement the interface
} 
```

对于 C/CIface 类似

像这样使用它：

```
BIface c = new C(); // or some other class also implementing CIface
BIface b = new B(c); // or some other class also implementing BIface
A a = new A(b, c); 
```

# php - PHP 通过引用传递

> ID：10183348
> 
> 赞同：2
> 
> 时间：2012-04-17T00:05:51.160
> 
> 标签：php

让我们假设以下内容：

```
private $array = array(/*really big multi-dimensional array*/);

public function &func1($specific_large_sub_array_key)
{
     return $this->array[$specific_large_sub_array_key]
}

public function func2()
{
    $specificArray = &$this->func1(1);

    $this->func3($specificArray);
}

public function func3($specificArray)
{
    /* do stuff here*/
} 
```

我的问题是这样的：

如果 func3 没有指定 $specificArray 不是通过引用传递给它的，那么 PHP 在 func2 内部调用 func3 时会复制 $specificArray 吗？还是 PHP 会保留引用并自动传播它？

即这会...

```
public function func3($specificArray)
{
    unset($specificArray[234]);
} 
```

...影响$array？

谢谢

请注意，此示例非常简化。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-17T00:16:26.323

PHP 在如何处理变量和副本方面非常聪明。

举个例子：

```
// Allocate one variable with content 'Hello'
$var     = 'Hello'; 
```

此时，Zend 引擎有一个字符串变量的表示形式，内容为 Hello。

现在，如果你这样做：

```
$varCopy = $var; 
```

您有 2 个自变量 (`$var`和`$varCopy`)，但由于它们的内容相同，因此内容仅存在于内存中的一个位置（基本上尚未制作真正的副本）。此时，两个变量在符号表中引用相同的值（Hello）。一旦修改了两个变量之一，它只会复制内容。同样的逻辑适用于 2 个副本到任意数量的副本。

简而言之，PHP 足够聪明，不会在不需要复制时复制变量或数组的值。

[您可以在 PHP 手册的参考计数基础](http://www.php.net/manual/en/features.gc.refcounting-basics.php)页面上了解更多信息。他们甚至在最后给出了一个特定于数组的示例。

一个有用的函数是[memory_get_usage](http://www.php.net/manual/en/function.memory-get-usage.php)，它可以显示 PHP 正在使用多少内存。您可以使用它来跟踪这样一个事实，即当您传递数组的多个副本时，内存使用量几乎不会发生变化。这可以帮助证明手册的引用计数基础部分中概述的要点。

您不需要了解有关其工作原理的所有细节，但请注意 PHP 在创建和管理引用方面非常聪明。

编辑：

要直接回答您的实际问题，不，`func3`即使您不通过引用传递它，PHP 也不会复制数组。它将使用引用计数基础部分中说明的引用，因此您可以按值传递它而无需担心。

但是，如果您调用 unset，则您取消设置的值只会从数组的本地副本中删除，因此它最终不会从源数组中删除，除非您通过对函数的引用传递它。但是按值传递它并不会创建整个巨大数组的全新副本。即使从副本中删除一个值也不会创建一个全新的副本减去您删除的条目（您只有第二个数组，其中所有引用都与第一个相同，但它缺少对已删除条目的一个引用）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T00:15:17.330

不能做多行注释，所以作为答案：

```
return &$this->array[$specific_large_sub_array_key]
       ^ 
```

但也要给你一个问题的答案：

> 即这... [...] ...影响$array吗？

简单明了：不。原因：这是一个不同的变量，而不是别名（参考）。

# jquery - 在 JQUERY 中使用 live() 和 focus()

> ID：10183349
> 
> 赞同：0
> 
> 时间：2012-04-17T00:05:53.697
> 
> 标签：jquery

我有一个用 AJAX 加载的输入字段。我需要这个字段在加载页面时获得焦点。

如何使用 jQuery 来实现，具有以下功能：LIVE 和 FOCUS？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T00:12:41.257

```
$(document).ready(function() {
     $('#yourfield').live('focus',function()
     {
         // do your stuff here
     });
}); 
```

正如所指出的，`live`自 jQuery 1.7 起已弃用，您应该`on`在 1.7+ 中使用：

```
$(document).ready(function() {
     $(document).on('focus','#yourfield',function()
     {
         // do your stuff here
     });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T00:15:38.060

```
$(document).ready(function() {
     $(document).on('focus', '#yourfield' ,function()
     {
     //your actions here
     });
}); 
```

文档在 on() 之前的位置可以用#yourfield 的任何父元素替换。

更多信息在这里：[http ://api.jquery.com/on/](http://api.jquery.com/on/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T00:10:57.240

你的意思是像这样在页面加载时还是在更新字段时将焦点设置到该字段？

```
$(document).ready(function() {
     $('#yourfield').focus();
}); 
```

# genetic-programming - 遗传编程中的指数

> ID：10183352
> 
> 赞同：2
> 
> 时间：2012-04-17T00:05:55.143
> 
> 标签：genetic-programming, exponent

我想为终端变量提供实值指数（不仅仅是整数）。例如，假设我想进化一个函数 y = x^3.5 + x^2.2 + 6。我应该如何进行？我还没有看到任何可以做到这一点的 GP 实现。我尝试使用幂函数，但有时初始解决方案的指数太多，以至于评估值超过了“双”界限！任何建议将不胜感激。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T21:48:25.413

如果只有*一些*初始种群遭受溢出问题，那么只需以较差的适应度得分惩罚它们，它们可能会在几代之内从种群中移除。

但是，如果问题是几乎所有个人都遭受这个问题的困扰，那么您将不得不添加一些约束。最简单的做法是将幂函数的指数子项限制为真正的文字 - 这意味着不允许嵌套幂。这取决于这是否足以满足您的需求。有几种方法可以添加这些（或更复杂的）约束 - 尝试查看约束句法结构和语法引导的 GP。

其他一些简单的想法：您可以使用更大范围的数据类型吗？此外，您可以减少最大深度参数，以便嵌套指数的空间更少。当然，这只是在一定程度上是可能的，这取决于功能的复杂性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T15:26:17.463

[DEAP](http://deap.googlecode.com)（在 Python 中）实现了它。事实上，有一个[例子](http://code.google.com/p/deap/source/browse/examples/gp_symbreg.py)。通过将 Python 中的 math.pow 添加到原始集中，您可以实现您想要的。

```
pset.addPrimitive(math.pow, 2) 
```

但是使用 pow 运算符可能会得到类似 x^(x^(x^(x))) 的东西，这可能是不希望的。你应该添加一个限制（通过一种我不确定的方式）在你的树中允许战俘的位置（就在一片叶子或类似的东西之前）。

[OpenBeagle](http://beagle.sourceforge.net/)（在 C++ 中）也允许，但您需要使用来自的 pow 开发自己的原语`<math.h>`，您可以使用 Sin 或 Cos 原语作为示例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T00:25:01.927

整数与实数具有不同的二进制表示，因此您必须使用稍微不同的位串表示和重组/变异运算符。

有关出色的演示，请参见 www.cs.vu.nl/~gusz/ecbook/slides/Genetic_Algorithms.ppt 的幻灯片 24 或查看 Eiben/Smith 的书“进化计算遗传算法简介”。这描述了如何将位串映射到实数。然后，您可以创建一个表示，其中 x 仅位于区间 [y,z] 内。在这种情况下，选择 y 和 z 的数量级小于您正在使用的数据类型的容量（例如 10^308 表示双精度），这样您就不会遇到您描述的溢出问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-17T21:42:11.423

您必须考虑使用实数指数和负基数，您将不会获得实数，而是复数。例如，.NET 中的[Math.Pow](http://msdn.microsoft.com/en-us/library/system.math.pow.aspx)实现表明，如果您尝试计算负基数对非整数指数的幂，则会得到 NaN。您必须确保所有 x 值都是正数。我认为这就是您“超过双重界限”时看到的问题。

顺便说一句，您可以尝试[HeuristicLab](http://dev.heuristiclab.com) GP ​​实现。它具有可配置的语法非常灵活。

# ios - 在 iOS 设备的背景上播放视频

> ID：10183355
> 
> 赞同：1
> 
> 时间：2012-04-17T00:06:15.407
> 
> 标签：ios, video, mobile, background, video-player

我的目标是播放大型音频（有些是最后 20 分钟，有些甚至是 1 小时），而耳机上的音频听起来不会失真。

我想知道视频是否可以在 iOS 设备上以后台或睡眠模式播放。

我有一些大（每个大 100mb）.mp3 文件，我可以在后台播放这些文件，修改 Info.plist 这样做：

```
<key>UIBackgroundModes</key>
<array>
<string>audio</string>
</array> 
```

并在 ti_app 上执行此操作：

```
<iphone>
<backgroundModes>
    <mode>audio</mode>
</backgroundModes>
</iphone> 
```

并将其添加到 player.js

```
Ti.Media.audioSessionMode = Ti.Media.AUDIO_SESSION_MODE_PLAYBACK; 
```

它适用于 .mp3 文件。

但是每当我插入耳机时，它听起来就会失真。我使用 SoundPlayer 播放那些本地文件。

我曾尝试使用 AudioPlayer 在本地播放它们（尝试我在论坛上找到的东西），但似乎 AudioPlayer 只接受流媒体，而不是本地。我认为必须有一种解决方法，但我找不到。所以我决定将 MP3 文件转换为视频文件，具有白色背景。我目前正在使用具有透明背景颜色和 1x1 尺寸的 VideoPlayer 播放视频文件。到目前为止，它运行良好，即使使用耳机也不会失真。

但问题是音频不再在后台播放。我在论坛和互联网上搜索过，但我没有找到答案，所以我想我会问。

我认为这与播放 MP3 文件有关`AVAudioPlayer`，而 VideoPlayer 播放其他不接受在后台播放的东西。

我正在使用 Titanium 的 Appcelerator，它是 JavaScript 中的一个 API。所以我不能在 C 或 C++ 或类似的东西上编码。这只是 JavaScript。

# android - “此版本的 ADT 需要 Android SDK Tools 版本 17 或更高版本。” 我不能让这个错误消失。

> ID：10183362
> 
> 赞同：0
> 
> 时间：2012-04-17T00:07:48.113
> 
> 标签：android, mobile

全文如下：

```
This verison of ADT requires Android SDK Tools in revision 17 or above.
Current revision is 15.
Please update your SDK Tools to the latest version 
```

当我收到此错误时，它会提示我打开 SDK 管理器。

然后我选择最新版本，并尝试安装它，但随后我收到错误消息：

```
-= Warning! =-
A folder failed to be moved. On Windows, this typically means 
that a program is using that folder... 
```

所以，我关闭了 Eclipse，然后单击“是”再试一次，但我不断收到相同的错误消息。

知道该怎么做吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-17T07:24:04.443

我通过修改文件在我的mac上解决了这个问题`plugin.prop`：

对于 mac /Users/admin/Desktop/android-sdk-macosx/tools/lib/plugin.prop

对于 ubuntu ......./android-sdk-linux/tools/lib/plugin.prop 将行从

```
plugin.version=17.0.0 
```

至

```
plugin.version=16.0.1.v201112150204-238534 
```

并重新加载 eclipse.. 它不再警告任何事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T20:34:31.147

为了在 Windows 上运行 Android SDK 中的更新，您需要以管理员身份运行它。如果您不是管理员，大多数升级操作都会因权限错误而失败（它们并不总是报告为权限错误，但事实就是如此）。

右键单击开始菜单中的 SDK 管理器工具图标，然后选择“以管理员身份运行”选项。

然后，您将能够运行升级。

# c# - 桌面 java 应用程序替代品

> ID：10183368
> 
> 赞同：0
> 
> 时间：2012-04-17T00:08:18.890
> 
> 标签：c#, java, .net, wpf, swing

我想开始开发桌面 java 应用程序，我想知道 java 社区使用什么。

我从 Swing 开始，但我发现它非常初级。

我习惯于在 Visual Studio 2010 中使用 .net c# WPF，我一直在寻找与 java 具有相同质量（或接近）的东西（Swing + Window builder 不是一个选项）

即使您不同意我的 Swing 意见，我也会感谢您的意见

谢谢大家

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T00:18:25.267

您想要查看的另一个选项是[SWT](http://www.eclipse.org/swt)（Eclipse 使用的工具包）。它主要使用本机组件进行渲染，因此感觉像真正的桌面应用程序一样强大。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-17T08:01:27.573

> 我正在寻找更好的外观和感觉的发展..

Swing 提供 4 个 PLAF 作为标准配置。至少还有十几个第 3 方 PLAF，其中一些有几十个变体。在众多可能性中，最终用户通常更喜欢“原生”PLAF——它的外观和感觉与“所有其他原生应用程序”基本相似。在他们的机器上。

你可以看到一个小应用程序。这改变了解放军。在[嵌套布局示例](https://stackoverflow.com/a/5630271/418556)上。这是Mac。本土解放军。

![](../Images/f9e492eec81701d836e83834a893afb0.png)

* * *

> ..为什么你认为这不容易？

这与一般评论有关，即在 Swing 中构建 GUI 比（例如）Visual Studio 更难。

原因是 Swing 旨在在多个平台、屏幕分辨率/尺寸、PLAF（和其他因素）上工作。因此，将组件“拖放”到最终位置是不切实际的，因为这可能会根据上面列出的因素而改变。相反，Java 依赖于布局管理器的概念，它计算组件在运行时出现的大小和位置。

布局管理器使用组件的“逻辑分组”来实现 GUI 所期望的一般形状。上图是如何组合布局以在 GUI 的不同部分实现不同效果的示例。

虽然我不使用 Java 的 GUI 构建器，但我确实觉得它们可以提高生产力，但这只是一个问题：

1.  已经知道有哪些 Java 布局可用，以及如何使用它们。
2.  在 GUI 中结合使用标准布局，以达到预期的效果。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T00:18:24.067

如果你不介意外部依赖，你也可以看看[SWT](http://www.eclipse.org/swt/ "SWT")。它是构建 eclipse 的框架，尽管它不是世界上最容易使用的东西。

它确实提供了一个名为 SWT 设计器的 GUI 构建器（如果我没记错的话）。不过，它不如您在 Visual Studio 中习惯的那样好。这是一个相当高的质量标准。在我对它的简短体验中，有相当多的样板代码，而且 API 并不像我个人想要的那么直观。

但是，它的使用相当广泛。Eclipse 是在它之上构建的，并且通过扩展，许多专业工具也是基于相同的基础构建的（例如 IBM 的 Rational 工具和 Adob​​e 的 ColdFusion Builder）。如果没有别的，那应该让您了解该工具的强大功能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-17T00:19:46.197

Mono 下的 Java 怎么样，使用 IVKM 和 Gtk？您可以使用 java 进行编程，但您的应用程序实际上是 .NET 代码......不确定这是否适合您。

如果您想完全摆脱 .NET，那么也许您可以使用 java Gtk 绑定：http: [//java-gnome.sourceforge.net/](http://java-gnome.sourceforge.net/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-17T03:04:56.590

查看[JFormDesigner](http://www.formdev.com/)。[带有Eclipse](http://www.eclipse.org/)的JFormDesigner是一个非常强大的工具集。还要寻找一个好的LaF。请参阅[合金外观和感觉](http://lookandfeel.incors.com/)和[JGoodies](http://www.jgoodies.com/)。您可能会发现[Java 中的 Look and feel](https://stackoverflow.com/q/3954616/1048330)很有用。

# ruby - Ruby 的 dup 和 clone 方法有什么区别？

> ID：10183370
> 
> 赞同：230
> 
> 时间：2012-04-17T00:08:28.927
> 
> 标签：ruby, clone, dup

[Ruby 文档`dup`](http://www.ruby-doc.org/core-2.0/Object.html#method-i-dup)说：

> 通常，`clone`并且`dup`在后代类中可能具有不同的语义。While`clone`用于复制对象，包括其内部状态，`dup`通常使用后代对象的类来创建新实例。

但是当我做一些测试时，我发现它们实际上是相同的：

```
class Test
   attr_accessor :x
end

x = Test.new
x.x = 7
y = x.dup
z = x.clone
y.x => 7
z.x => 7 
```

那么这两种方法有什么区别呢？

* * *

## 回答 #1

> 赞同：314
> 
> 时间：2012-04-17T00:24:38.137

子类可以覆盖这些方法以提供不同的语义。就`Object`其本身而言，有两个关键区别。

首先，`clone`复制单例类，而`dup`没有。

```
o = Object.new
def o.foo
  42
end

o.dup.foo   # raises NoMethodError
o.clone.foo # returns 42 
```

第二，`clone`保持冻结状态，而`dup`不是。

```
class Foo
  attr_accessor :bar
end
o = Foo.new
o.freeze

o.dup.bar = 10   # succeeds
o.clone.bar = 10 # raises RuntimeError 
```

这些方法的[Rubinius 实现](https://github.com/rubinius/rubinius/blob/master/kernel/alpha.rb#L189) 通常是我回答这些问题的来源，因为它非常清晰，并且是一个相当兼容的 Ruby 实现。

* * *

## 回答 #2

> 赞同：201
> 
> 时间：2014-07-09T09:32:36.170

When dealing with ActiveRecord there's a significant difference too:

[`dup`](http://api.rubyonrails.org/classes/ActiveRecord/Core.html#method-i-dup) creates a new object without its id being set, so you can save a new object to the database by hitting `.save`

```
category2 = category.dup
#=> #<Category id: nil, name: "Favorites"> 
```

[`clone`](http://api.rubyonrails.org/classes/ActiveRecord/Core.html#method-i-clone) creates a new object with the same id, so all the changes made to that new object will overwrite the original record if hitting `.save`

```
category2 = category.clone
#=> #<Category id: 1, name: "Favorites"> 
```

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2012-04-17T00:18:09.483

一个区别是冻结对象。冻结对象的`clone`也被冻结（而`dup`冻结对象的 a 不是）。

```
class Test
  attr_accessor :x
end
x = Test.new
x.x = 7
x.freeze
y = x.dup
z = x.clone
y.x = 5 => 5
z.x = 5 => TypeError: can't modify frozen object 
```

另一个区别是单例方法。同样的故事在这里，`dup`不复制那些，但`clone`确实如此。

```
def x.cool_method
  puts "Goodbye Space!"
end
y = x.dup
z = x.clone
y.cool_method => NoMethodError: undefined method `cool_method'
z.cool_method => Goodbye Space! 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2015-12-15T12:06:35.477

较新的[文档](http://ruby-doc.org/core-2.2.3/Object.html#method-i-dup-label-on+dup+vs+clone)包括一个很好的例子：

```
class Klass
  attr_accessor :str
end

module Foo
  def foo; 'foo'; end
end

s1 = Klass.new #=> #<Klass:0x401b3a38>
s1.extend(Foo) #=> #<Klass:0x401b3a38>
s1.foo #=> "foo"

s2 = s1.clone #=> #<Klass:0x401b3a38>
s2.foo #=> "foo"

s3 = s1.dup #=> #<Klass:0x401b3a38>
s3.foo #=> NoMethodError: undefined method `foo' for #<Klass:0x401b3a38> 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2015-02-05T13:36:34.300

两者几乎相同，但 clone 比 dup 多做一件事。在克隆中，对象的冻结状态也被复制。在 dup 中，它总是会被解冻。

```
 f = 'Frozen'.freeze
  => "Frozen"
 f.frozen?
  => true 
 f.clone.frozen?
  => true
 f.dup.frozen?
  => false 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-02-06T17:26:50.373

您可以使用 clone 在 Ruby 中进行基于原型的编程。Ruby 的 Object 类同时定义了 clone 方法和 dup 方法。clone 和 dup 都会生成它正在复制的对象的浅表副本；也就是说，对象的实例变量被复制，而不是它们引用的对象。我将演示一个例子：

```
class Apple
  attr_accessor :color
  def initialize
    @color = 'red'
  end
end

apple = Apple.new
apple.color
 => "red"
orange = apple.clone
orange.color 
 => "red"
orange.color << ' orange'
 => "red orange" 
apple.color
 => "red orange" 
```

请注意，在上面的示例中，橙色克隆复制了 apple 对象的状态（即实例变量），但在 apple 对象引用其他对象（例如 String 对象颜色）时，这些引用不会被复制。相反，apple 和 orange 都引用了同一个对象！在我们的示例中，引用是字符串对象“red”。当 orange 使用 append 方法 << 来修改现有的 String 对象时，它会将字符串对象更改为“red orange”。这实际上也改变了 apple.color，因为它们都指向同一个 String 对象。

附带说明一下，赋值运算符 = 将分配一个新对象，从而破坏一个引用。这是一个演示：

```
class Apple
  attr_accessor :color
  def initialize
    @color = 'red'
  end
end

apple = Apple.new
apple.color
=> "red"
orange = apple.clone
orange.color
=> "red"
orange.color = 'orange'
orange.color
=> 'orange'
apple.color
=> 'red' 
```

在上面的示例中，当我们将一个新对象分配给橙色克隆的颜色实例方法时，它不再引用与苹果相同的对象。因此，我们现在可以在不影响 apple 的 color 方法的情况下修改 orange 的 color 方法，但是如果我们从 apple 克隆另一个对象，则该新对象将在复制的实例变量中引用与 apple 相同的对象。

dup 还会生成它正在复制的对象的浅表副本，如果您要对 dup 进行上面所示的相同演示，您将看到它的工作方式完全相同。但是克隆和复制之间有两个主要区别。首先，正如其他人提到的， clone 复制冻结状态而 dup 没有。这是什么意思？Ruby 中的“冻结”一词是不可变的深奥术语，它本身是计算机科学中的一个命名法，这意味着某些东西是无法改变的。因此，不能以任何方式修改 Ruby 中的冻结对象；它实际上是不可变的。如果您尝试修改冻结的对象，Ruby 将引发 RuntimeError 异常。由于克隆复制冻结状态，如果您尝试修改克隆对象，它将引发 RuntimeError 异常。相反，由于 dup 不复制冻结状态，

```
class Apple
  attr_accessor :color
  def initialize
    @color = 'red'
  end
end

apple = Apple.new
apple.frozen?
 => false 
apple.freeze
apple.frozen?
 => true 
apple.color = 'crimson'
RuntimeError: can't modify frozen Apple
apple.color << ' crimson' 
 => "red crimson" # we cannot modify the state of the object, but we can certainly modify objects it is referencing!
orange = apple.dup
orange.frozen?
 => false 
orange2 = apple.clone
orange2.frozen?
 => true 
orange.color = 'orange'
 => "orange" # we can modify the orange object since we used dup, which did not copy the frozen state
orange2.color = 'orange'
RuntimeError: can't modify frozen Apple # orange2 raises an exception since the frozen state was copied via clone 
```

其次，更有趣的是，克隆复制了单例类（以及它的方法）！如果您希望在 Ruby 中进行基于原型的编程，这将非常有用。首先，让我们证明单例方法确实是用 clone 复制的，然后我们可以将它应用到 Ruby 中基于原型的编程示例中。

```
class Fruit
  attr_accessor :origin
  def initialize
    @origin = :plant
  end
end

fruit = Fruit.new
 => #<Fruit:0x007fc9e2a49260 @origin=:plant> 
def fruit.seeded?
  true
end
2.4.1 :013 > fruit.singleton_methods
 => [:seeded?] 
apple = fruit.clone
 => #<Fruit:0x007fc9e2a19a10 @origin=:plant> 
apple.seeded?
 => true 
```

如您所见，水果对象实例的单例类被复制到克隆中。因此克隆的对象可以访问单例方法:seeded?。但 dup 并非如此：

```
apple = fruit.dup
 => #<Fruit:0x007fdafe0c6558 @origin=:plant> 
apple.seeded?
=> NoMethodError: undefined method `seeded?' 
```

现在在基于原型的编程中，您没有扩展其他类然后创建其方法派生自用作蓝图的父类的类的实例的类。相反，您有一个基础对象，然后您从该对象创建一个新对象，并复制其方法和状态（当然，由于我们通过克隆进行浅拷贝，因此实例变量引用的任何对象都将像在 JavaScript 中一样共享原型）。然后，您可以通过填写克隆方法的详细信息来填写或更改对象的状态。在下面的示例中，我们有一个基础水果对象。所有水果都有种子，所以我们创建了一个方法 number_of_seeds。但是苹果只有一个种子，所以我们创建一个克隆并填写细节。现在，当我们克隆苹果时，我们不仅克隆了方法，还克隆了状态！记住 clone 对状态（实例变量）做了一个浅拷贝。正因为如此，当我们克隆苹果得到一个 red_apple 时，red_apple 将自动拥有 1 个种子！您可以将 red_apple 视为继承自 Apple 的对象，而 Apple 又继承自 Fruit。因此，这就是我将 Fruit 和 Apple 大写的原因。我们取消了由克隆提供的类和对象之间的区别。

```
Fruit = Object.new
def Fruit.number_of_seeds=(number_of_seeds)
  @number_of_seeds = number_of_seeds
end
def Fruit.number_of_seeds
  @number_of_seeds
end
 Apple = Fruit.clone
 => #<Object:0x007fb1d78165d8> 
Apple.number_of_seeds = 1
Apple.number_of_seeds
=> 1
red_apple = Apple.clone
 => #<Object:0x007fb1d892ac20 @number_of_seeds=1> 
red_apple.number_of_seeds
 => 1 
```

当然，在基于原型的编程中，我们可以有一个构造方法：

```
Fruit = Object.new
def Fruit.number_of_seeds=(number_of_seeds)
  @number_of_seeds = number_of_seeds
end
def Fruit.number_of_seeds
  @number_of_seeds
end
def Fruit.init(number_of_seeds)
  fruit_clone = clone
  fruit_clone.number_of_seeds = number_of_seeds
  fruit_clone
end
Apple = Fruit.init(1)
 => #<Object:0x007fcd2a137f78 @number_of_seeds=1> 
red_apple = Apple.clone
 => #<Object:0x007fcd2a1271c8 @number_of_seeds=1> 
red_apple.number_of_seeds
 => 1 
```

最终，使用克隆，您可以获得类似于 JavaScript 原型的行为。

# ruby-on-rails - rails find_by_id 方法的范围

> ID：10183373
> 
> 赞同：1
> 
> 时间：2012-04-17T00:08:49.587
> 
> 标签：ruby-on-rails, ruby-on-rails-3.2

假设我有一个带有两个模型`Person`和`House`. 每个`Person`对象都有一个`House_id`属性。

我想在我的`Person`模型中定义以下方法：

```
def locate_house
  current_house_id = house.find_by_id(person)
end 
```

但是我收到一个未定义的变量错误`house`，我如何确保这在范围内？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T00:12:19.533

您正在尝试重写已经内置在 rails 中的内容。使用 belongs_to 关系：

```
class Person < ActiveRecord::Base
    belongs_to :house
end 
```

然后你可以这样做：

```
person.house 
```

得到相关的房子。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T00:12:48.413

你的模型`House`————是一个需要大写的红宝石常数

```
def locate_house
  current_house_id = House.find_by_id(person)
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T00:39:36.290

House 是一个常量，需要像其他人所说的那样使用大写字母，请查看 Rails Guides 关于 Active Record 模型之间的关系。有很多可能的关系，有很多可能是您正在寻找的。因为，实际上，一个人可以拥有多个房屋。

# sql-server - SQL Server Express (2012) 和 LocalDB 之间有区别吗？

> ID：10183379
> 
> 赞同：60
> 
> 时间：2012-04-17T00:09:50.320
> 
> 标签：sql-server, localdb

在他出色且流行的[比较图表](http://erikej.blogspot.com/2011/01/comparison-of-sql-server-compact-4-and.html)中，ErikEJ 对**SQL Server Express 2012**和**SQL Server 2012 LocalDB**进行了区分。但是，我在 MSDN 文档的其他任何地方都找不到这样的区别（[官方 MS SS12 书籍](https://rads.stackoverflow.com/amzn/click/com/073566515X)或[MSDN SQL 版本比较页面](http://msdn.microsoft.com/en-us/library/cc645993.aspx)中甚至都没有提到“LocalDB” 。）这让我怀疑 Express 和 LocalDB正如 ErikEJ 所建议的那样，并不是真正的两个独立产品，而只是同一事物的两个不同术语（这可以解释为什么在[这个 MSDN 页面上](http://msdn.microsoft.com/en-us/library/hh510202.aspx)，它被称为“SQL Server 2012 ***Express LocalDB*** ”）。

如果产品之间确实存在差异，谁能指出一些比较它们的官方文档？

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2012-04-17T00:15:02.033

好的，我想我已经找到了自己问题的答案。（它被隐藏在[SS Express 产品页面的标​​签下](http://www.microsoft.com/sqlserver/en/us/editions/express.aspx)。）

以下是我在该页面上找到的 LocalDB 的独特之处的摘要：

*   LocalDB 是 SQL Server Express Edition 的轻量级部署选项，具有更少的先决条件和更快的安装。
*   LocalDB 具有与 SQL Express 相同的所有可编程特性，但在“用户模式”* 下与应用程序一起运行，而*不是作为服务运行*。
*   LocalDB 不适用于多用户场景或用作服务器。（如果您需要接受远程连接或远程管理，则需要 SQL Server Express。）
*   “Express with Tools”（包括 SS Management Studio Express、Azure 等）可以与 LocalDB 一起使用，也可以不与 LocalDB 一起使用。（“Express with Advanced Services”也是如此。）

**更新：我刚刚在**[Windows IT Pro（2012 年 7 月，第 23 页）](http://www.windowsitpro-edition.com/windowsitpro/201207#pg23)中找到了这个有用的描述：

> LocalDB 不是 SQL Server Express，也不是 SQL Server Compact。LocalDB 使用与其他版本的 SQL Server 相同的 sqlservr.exe 引擎，但它在用户模式下运行，而不是作为服务运行。LocalDB 被 SSDT 等工具用于离线开发，以确保您开发的代码与您的生产 SQL Server 数据库 100% 兼容。

如果我没看错的话，LocalDB 似乎更像是 Express 的一个配置选项，而不是一个完全独立的产品。所以很明显，如果我下载 Express（或 Express w/Tools），我可以选择安装 LocalDB 版本，据说它比完整的 Express 更容易（“零配置”）。（更新：在 VS2012 中，[LocalDB 默认安装](https://docs.microsoft.com/en-us/ef/ef6/modeling/code-first/workflows/new-database#wheres-my-data)。）

[根据这篇文章](http://blogs.msdn.com/b/sqlexpress/archive/2011/11/28/using-localdb-in-visual-studio-2010.aspx)，另一个重要区别是“当前 Visual Studio 2010 并不能真正与 LocalDB 一起使用”。（我们必须改用 SS Management Studio，至少现在是这样。）

*（“用户模式”或“用户实例”的概念是 LocalDB 的一个关键区别。事实上，根据[这篇文章](http://blogs.msdn.com/b/sqlexpress/archive/2011/07/12/introducing-localdb-a-better-sql-express.aspx)，“LocalDB 可以看作是 SQL Server Express 的用户实例特性的升级。” 了解更多关于用户实例，请参阅 MSDN 博文[“什么是 RANU？”](http://blogs.msdn.com/b/sqlexpress/archive/2008/02/22/sql-express-behaviors-idle-time-resources-usage-auto-close-and-user-instances.aspx)）

**更新 - 2021 年 2 月** LocalDB 是 SQL Server Express 版本

[来自官方文档](https://docs.microsoft.com/en-us/sql/sql-server/editions-and-components-of-sql-server-version-15?view=sql-server-ver15)

> Express 版是入门级的免费数据库，非常适合学习和构建桌面和小型服务器数据驱动的应用程序。它是构建客户端应用程序的独立软件供应商、开发人员和爱好者的最佳选择。如果您需要更高级的数据库功能，SQL Server Express 可以无缝升级到其他更高端的 SQL Server 版本。SQL Server Express LocalDB 是 Express 的轻量级版本，具有所有可编程功能，在用户模式下运行，并且具有快速、零配置的安装和简短的先决条件列表。

该文档提供了版本之间功能的非常详细的比较。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-11-25T11:51:59.650

我使用来自 ErikEJ 的表格，其中显示：[SQL CE 3.5、SQL CE 4、Local DB 和 SQL Server 2012 之间的特性和差异](http://erikej.blogspot.co.uk/2011/01/comparison-of-sql-server-compact-4-and.html)。根据此表，Local DB 和 SQL Server 2012 之间的区别是：

> **安装大小：**
> SQL Server 2012：120 MB 下载大小；在磁盘上扩展 300 MB
> 本地数据库：32 MB 下载大小；160 MB 磁盘
> 
> **作为服务运行**
> SQL Server 2012：是
> 本地数据库：否（作为应用程序启动的进程运行）
> 
> **FILESTREAM 支持**
> SQL Server 2012：是
> 本地数据库：否
> 
>  **合并复制SQL Server 2012**的订阅者**
> ：是 本地数据库：否**
> 
>  ****SQL Server 2012**的并发连接数**
> ：无限 本地数据库：无限（但仅限本地）****

 ****注意：抱歉，这不是“官方文档”，但希望它对下一个董事会有用，因为它回答了有关差异的基本查询。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-08-09T18:49:09.467

主要区别在于**Server Express**作为服务运行，而**LocalDB**不需要任何服务器或密集处理即可运行。****

# performance - iPad 上的 Adob e AIR 滚动性能 (2) - 我能期待什么？

> ID：10183386
> 
> 赞同：3
> 
> 时间：2012-04-17T00:11:07.363
> 
> 标签：performance, actionscript-3, apache-flex, ipad, air

我目前正在开发一个以 iPad2 作为硬件平台的 Adob​​e AIR 应用程序，并且无法在其中一个屏幕上获得不错的滚动性能。我正在使用一个火花列表，带有一个像这样的自定义项目渲染器：

```
<s:List id="productList" top="116" bottom="0" left="10" right="10" 
    width="100%"
    visible="true" includeInLayout="true"
    height="0"
    maxHeight="500"
    opaqueBackground="#ffffff"
    itemRenderer="myRenderer">
</s:List> 
```

最初，我使用的是 .mxml 渲染器，但在看到令人讨厌的性能后，我决定自己动手，扩展 UIComponent（我已经放弃了包和大括号以节省水平空间）：

```
import mx.controls.listClasses.IListItemRenderer;
import mx.core.UIComponent;
import mx.events.FlexEvent;
import mx.utils.ColorUtil;

import spark.components.Label;
import spark.components.TextInput;

public final class OrderViewProductLineTestIR extends UIComponent implements IListItemRenderer 
{
    public function OrderViewProductLineTestIR()
    {
        super();
    }

    // Internal variable for the property value.
    private var _data:Object;

    private var productName:Label;
    private var orderQty:TextInput;
    private var stockQty:TextInput;

    // Make the data property bindable.
    [Bindable("dataChange")]

    // Define the getter method.
    public function get data():Object
    {
        return _data;
    }

    // Define the setter method, and dispatch an event when the property
    // changes to support data binding.
    public function set data(value:Object):void
    {
        _data = value;
        invalidateProperties();
        dispatchEvent(new FlexEvent(FlexEvent.DATA_CHANGE));
    }

    override protected function createChildren():void
    {
        super.createChildren();

        productName = new Label();
        // productName.visible = true;
        addChild(productName);

        orderQty = new TextInput();
        addChild(orderQty);

        stockQty = new TextInput();
        addChild(stockQty);

    }

    override protected function commitProperties():void
    {
        super.commitProperties();
        productName.text = _data.Name;
    }

    override protected function updateDisplayList(unscaledWidth:Number, unscaledHeight:Number):void
    {
        super.updateDisplayList(unscaledWidth, unscaledHeight);
        productName.move(0, 0);
        productName.setActualSize(250, 48);

        orderQty.move(270, 0);
        orderQty.setActualSize(100, 48);

        stockQty.move(390, 0);
        stockQty.setActualSize(100, 48);
    }

    override protected function measure():void
    {
        super.measure();

        measuredWidth = 490;
        measuredHeight = 48; 
    }
} 
```

正如您所看到的，这是非常轻量级的，但我的数据提供程序包含超过 100 个项目，其中 11 个可以随时显示在屏幕上。我所读到的关于提高滚动性能的所有内容都围绕着使用`opaqueBackground`and `cacheAsBitmap`，但是无论我尝试什么，这里都没有帮助。在列表级别使用`cacheAsBitmap`并没有帮助，因为一旦您滚动了超过几行需要重新渲染整个内容的项目渲染器回收，并且在项目渲染器级别使用它仍然非常慢快速滚动——大概是因为在非常快速的滚动过程中同时回收了许多。

我知道 iPad 以 60 fps 在一帧中传送一屏信息应该没有问题，但是当我快速滚动时，我发现它很难达到 10 fps（从视线中）。所以问题是：**我是否遗漏了一些明显的东西，或者这是由于使用 AIR 时涉及的层数（和矢量渲染）而可以预料到的？**作为记录，我尝试更改应用程序的渲染模式并尝试更改帧速率以消除明显的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T10:54:36.203

这个有点猜，但是itemRenderer能优化吗？每次重绘组件时，是否需要对所有子元素进行定位和调整大小？每次 commitProperties 运行时都需要更新 productName.text 吗？

以下是我可以修改的方法：

```
import mx.controls.listClasses.IListItemRenderer;
import mx.core.UIComponent;
import mx.events.FlexEvent;
import mx.utils.ColorUtil;

import spark.components.Label;
import spark.components.TextInput;

public final class OrderViewProductLineTestIR extends UIComponent implements IListItemRenderer 
{
    public function OrderViewProductLineTestIR()
    {
        super();
    }

    // Internal variable for the property value.

private var _data:Object;

// Add a dataChanged property 
private var dataChanged :Boolean = false

private var productName:Label;
private var orderQty:TextInput;
private var stockQty:TextInput;

// Make the data property bindable.
[Bindable("dataChange")]

// Define the getter method.
public function get data():Object
{
    return _data;
}

// Define the setter method, and dispatch an event when the property
// changes to support data binding.
public function set data(value:Object):void
{
    _data = value;
    // switch the dataChanged flag 
    dataChanged = true;
    invalidateProperties();
    dispatchEvent(new FlexEvent(FlexEvent.DATA_CHANGE));
}

override protected function createChildren():void
{
    super.createChildren();

    productName = new Label();
    // productName.visible = true;
    addChild(productName);

    orderQty = new TextInput();
    addChild(orderQty);

    stockQty = new TextInput();
    addChild(stockQty);

}

override protected function commitProperties():void
{
    super.commitProperties();
    // Only update the display if the data actually changed 
    If(dataChanged){
      productName.text = _data.Name;
      dataChanged = false;
    }
}

// add variable to tell whether the component's children have been sized and positioned or not
// since they have static locations, no need to set these each time
protected var compChildrenSized :Boolean = false;
override protected function updateDisplayList(unscaledWidth:Number, unscaledHeight:Number):void
{
    super.updateDisplayList(unscaledWidth, unscaledHeight);
    if(!compChildrenSized){
     productName.move(0, 0);
     productName.setActualSize(250, 48);

     orderQty.move(270, 0);
     orderQty.setActualSize(100, 48);

     stockQty.move(390, 0);
     stockQty.setActualSize(100, 48);

     compChildrenSized = true;
    }
}

override protected function measure():void
{
    super.measure();

    measuredWidth = 490;
    measuredHeight = 48; 
}
} 
```

我想我会补充一点，我不确定措施是否会运行。如果用标签替换 textInputs 会发生什么？您使用的是 Flex 4.6，如果是，您使用的是 StyleableStageText（AKA StageText）还是使用 StyleableTextField 的 4.5 皮肤？我想知道 StageText 滚动是否会因为它挂在 Flash 显示列表上方而降低性能。

如果您完全删除 textInput 并替换为标签会发生什么？

这些都是小事，我不确定它们是否会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T22:43:23.857

在您的“Spark List 组件”上尝试此操作
1/ 添加布局（水平或垂直，取决于您想要什么；）
2/ 在您的列表组件上添加属性“useVirtualLayout=true”！

并告诉我结果是什么......但我认为它会更平滑（非常非常平滑），因为当你将元素添加到列表时，所有组件都会被渲染，即使它们不在布局中......所以“useVirtualLayout”只是在视口上的项目被渲染，其他项目被破坏......

见！并享受 Flash Builder 的乐趣！拥有多支持应用程序是一项非常酷的技术！

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-02-07T22:03:19.627

有点晚了。但。

确实，如果您想要接近原生性能的东西，最好使用八哥和羽毛。

但是你仍然可以优化你的渲染器。请不要在 Flex 移动应用程序的任何地方使用绑定。扩展 UIComponent 是正确的做法。我认为最好不要使用失效并在数据设置器中设置您的属性。

希望能帮助到你。

# android - Android Inception（线程中的线程）

> ID：10183391
> 
> 赞同：0
> 
> 时间：2012-04-17T00:11:36.430
> 
> 标签：android, multithreading, timertask

我有一个函数可以来回查询带有几个“乒乓球”的网络服务器，并编写了一个自定义处理程序来处理我的主 UI 线程和通信线程之间的消息通信（我为此使用 AsyncTask，但作为程序变得更加复杂，我决定将通信代码删除到主要活动之外的自己的类中）。

从 onCreate 触发此线程通信的单个实例可以完美地工作，没问题。我希望这个查询在应用程序使用的整个时间内定期运行 - 在后台 - 所以我设置了另一个名为 pollTimer 的线程，我试图用它来调用 OTHER定期安排线程。显然，它崩溃了，否则我不会发布这个。

有没有办法在线程中获取线程？或者换一种说法，从另一个线程触发一个线程？

```
Timer pollTimer = new Timer();
private void startPollTimer(){
    pollTimer.scheduleAtFixedRate(new TimerTask(){
        public void run(){
            Log.d(TAG,"timer dinged");
//if the following is commented out, this "dings" every 6 seconds.
//if its not commented out, it crashes
            threadedPoll();
        }
    }, 3120, 6000);
}
private void threadedPoll() {
    testThread(asciiQueries,WorkerThreadRunnable.typeLogin);        
} 
```

编辑：包含“testThread”函数可能会有所帮助，该函数在从 onCreate 调用时自行工作，但在从 Timer 调用时不起作用。“WorkerThreadRunnable”是它自己的类中的大量代码，它取代了让 AsyncTask 在主要活动中处理它的混乱。

```
private Handler runStatHandler = null;
Thread workerThread = null;

private void testThread(String[] threadCommands, int commandType){
    if(runStatHandler == null){
        runStatHandler = new ReportStatusHandler(this);
        if(commandType == WorkerThreadRunnable.typeLogin){
            workerThread = new Thread(new WorkerThreadRunnable(runStatHandler,threadCommands, WorkerThreadRunnable.typeLogin));
        }
        workerThread.start();
        return;
    }

    //thread is already there
    if(workerThread.getState() != Thread.State.TERMINATED){
        Log.d(TAG,"thread is new or alive, but not terminated");
    }else{
        Log.d(TAG, "thread is likely deaad, starting now");
        //there's no way to resurrect a dead thread
        workerThread = new Thread(new WorkerThreadRunnable(runStatHandler));
        workerThread.start();
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T00:27:41.763

sleep() 循环有什么问题吗？当你可以在一个线程中循环时，为什么会有大量复杂、狡猾的代码？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T00:30:10.967

你似乎已经在路上了——不过，处理程序的好处是它们不限于 UI 线程——所以如果你有一个由一个线程声明的处理程序，你可以将它设置为接受异步指令从另一个线程

```
mWorkerThread = new WorkerThread()

private class WorkerThread extends Thread {
  private Handler mHandler;

  @Override
  public void run() {
    mHandler = new Handler(); // we do this here to ensure that 
                              // the handler runs on this thread
  }

  public void doStuff() {
    mHandler.post(new Runnable() {
      @Override
      public void run() {
        // do stuff asynchronously
      }
    }
  }
} 
```

希望这会有所帮助...如果我完全不了解您的问题，请告诉我

# operating-system - 过程与信号通信

> ID：10183393
> 
> 赞同：0
> 
> 时间：2012-04-17T00:11:49.517
> 
> 标签：operating-system, alarm, system-calls

我正在用 C 进行系统调用编程，我想知道以下内容：

什么是您希望进程忽略警报信号的示例，例如，如果由于网络内进程中的数据包丢失而发送了信号？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T00:16:30.967

许多*重要的*守护进程对它们将响应的信号非常挑剔；他们经常安装一个处理程序`SIGHUP`来重新读取他们的配置文件，使用`SIGUSR1`或之一`SIGUSR2`来指示需要关闭和重新打开他们的日志文件以进行日志轮换，并以某种优雅的方式处理`SIGINT`, `SIGQUIT`,等`SIGTERM`.

其他一切都应该被忽略，这样意外信号就不会导致程序做有趣的事情。作为程序接口一部分的信号应该完全按照设计工作——而其他信号应该尽可能地减少危害。

# java - 处理多个表达式，并将这些表达式保存在数据库中

> ID：10183398
> 
> 赞同：1
> 
> 时间：2012-04-17T00:12:11.433
> 
> 标签：java, database

我无法提出正确的问题（堆栈溢出或谷歌）来查找可能已经存在的设计模式。我确实有一个可行的解决方案，但似乎过于复杂。我正在寻求有关在哪里寻找答案或类似问题的好例子的帮助。例如，在查询中处理多个表达式的 GUI。

这是解释该问题的尝试：

最终，要解决的问题是处理多个表达式和多个逻辑操作，并通过从数据库中读取表达式来实现。

我将表达式定义为具有左侧、运算符和右侧。就像您在声明中看到的那样：

```
(a==b) 
```

因此，多个表达式可能如下所示：

```
((a==b) && (c==d)) 
```

甚至

```
(((a==b) && (c==d)) || (e==f)) 
```

我可以很容易地将左侧、运算符和右侧存储在数据库中：

```
EXPID   LEFTID  RIGHTID LEFT    OPERATOR    RIGHT
1                       'STATE' ==          'NH'
2                       'TYPE'  ==          'FUEL'
3       1       2               && 
```

这将被读回

```
((STATE==NH) && (TYPE==FUEL)) 
```

完美的。除了它很快变得非常复杂。举个例子：

```
(ZIPCODE=='84770') AND (DEALER==NULL) AND (CAR_MODEL=='GTI') AND (CAR_BRAND=='VW') AND (LEGAL_OWNER==329778) AND (CAR_OWNER==459) AND ((STATE==UT) || (STATE==UT)) 
```

这需要一些疯狂的东西

```
EXPID   LEFTID  RIGHTID LEFT        OPERATOR    RIGHT
1                       ZIP         ==          84770
2                       DEALER      ==          NULL
3                       CAR_MODEL   ==          VW
4                       CAR_BRAND   ==          GTI
5                       STATE       ==          UT
6                       STATE       ==          NH
7       1       2                   &&
8       3       4                   &&
9       5       6                   ||
10      7       8                   &&
11      9       10                  && 
```

如果您想将所有这些都映射到 GUI，问题就会变得更糟。

不确定它是否对这个问题有帮助，但这里是处理多个表达式逻辑的输出和代码：

```
Output:
$ javac Expression.java & java Expression
exp1: Expression [(A EQ A)]   evaluates to [true]
exp2: Expression [(C EQ D)]   evaluates to [false]
expOr (exp1 or exp2): Expression [((A EQ A) OR (C EQ D))]   evaluates to [true]
expAnd (exp1 and exp2): Expression [((A EQ A) AND (C EQ D))]   evaluates to [false]
complex (exp1 NEQ expAnd): Expression [((A EQ A) NEQ ((A EQ A) AND (C EQ D)))]   evaluates to [true]
n1: Expression [(5 EQ 5)]   evaluates to [true]
n2: Expression [(6 NEQ 5)]   evaluates to [true]
n3: Expression [(5 NEQ 5)]   evaluates to [false]
n4 (n1 EQ complex): Expression [((5 EQ 5) EQ ((A EQ A) NEQ ((A EQ A) AND (C EQ D))))]   evaluates to [true]

public class Expression
{
    enum Op {EQ,NEQ,OR,AND};
    Object left;
    Object right;
    Op op;

    public Expression(Object l,Op o,Object r)
    {
        left = l;
        right = r;
        op = o;
    }

    public void test()
    {
        test("");
    }

    public void test(String msg)
    {
        System.out.println(msg + ": Expression ["+toString()+"]   evaluates to ["+evaluate()+"]");
    }

    public boolean evaluate()
    {
        if(Op.EQ == op) return equals();
        if(Op.NEQ == op) return !equals();
        if(Op.OR == op) return or();
        if(Op.AND == op) return and();
        return false;
    }

    //logical equals of expression with passed in expression
    public boolean equals(Object o)
    {
        if(o instanceof Expression)
        {
            Expression exp = (Expression)o;
            return evaluate() && exp.evaluate();
        }
        return false;
    }

    //compaire left and right for equality
    public boolean equals()
    {
        return left.equals(right);
    }

    //logical OR between left and right Expressions
    public boolean or()
    {
        if(left instanceof Expression && right instanceof Expression)
        {
            Expression expLeft = (Expression)left;
            Expression expRight = (Expression)right;
            return expLeft.evaluate() || expRight.evaluate();
        }
        return false;
    }

    //logical AND between left and right Expressions
    public boolean and()
    {
        if(left instanceof Expression && right instanceof Expression)
        {
            Expression expLeft = (Expression)left;
            Expression expRight = (Expression)right;
            return expLeft.evaluate() && expRight.evaluate();
        }
        return false;
    }

    public String toString()
    {
        StringBuilder sb = new StringBuilder();
        sb.append("("+left.toString() + " " + op.toString() + " " + right.toString()+")");
        return sb.toString();
    }

    public static void main(String[] args) throws Exception
    {
        //compare some strings
        Expression exp1 = new Expression("A",Op.EQ,"A");
        exp1.test("exp1");

        Expression exp2 = new Expression("C",Op.EQ,"D");
        exp2.test("exp2");

        Expression expOr = new Expression(exp1,Op.OR,exp2);
        expOr.test("expOr (exp1 or exp2)");

        Expression expAnd = new Expression(exp1,Op.AND,exp2);
        expAnd.test("expAnd (exp1 and exp2)");

        Expression complex = new Expression(exp1,Op.NEQ,expAnd);
        complex.test("complex (exp1 NEQ expAnd)");

        //numeric comparisons
        Expression n1 = new Expression(5,Op.EQ,5);
        n1.test("n1");

        Expression n2 = new Expression(6,Op.NEQ,5);
        n2.test("n2");

        Expression n3 = new Expression(5,Op.NEQ,5);
        n3.test("n3");

        //numeric and strings
        Expression n4 = new Expression(n1,Op.EQ,complex);
        n4.test("n4 (n1 EQ complex)");
    }
} 
```

# c# - 是否通过 LINQ Select 调用错误代码产生新线程？

> ID：10183404
> 
> 赞同：2
> 
> 时间：2012-04-17T00:12:51.567
> 
> 标签：c#, multithreading, linq, delegates, side-effects

ReSharper 重构了一个 foreach 循环，我不得不这样做。我想通过委托的 BeginInvoke 使用不同的参数生成一堆线程，存储在列表中，并将 IAsyncResults 存储在集合中：

```
var asyncResults = mylist.Select(x => myDelegate.BeginInvoke(x, null, null)); 
```

我的本能反应是，这不是一个好习惯。BeginInvoke 导致产生新线程的副作用，传递给 Select 的函数不应引起副作用。

或者也许没关系，因为我没有更改调用线程中的任何内容？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T00:16:29.863

那应该没问题。创建一个新线程并不是真正的副作用。您没有修改任何值。`BeginInvoke`被调用并且您正在存储结果`IAsyncResult`s.

但是，您必须记住，没有什么会阻止。您必须自己管理所有内容的同步。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T00:44:16.787

我认为很难说这是否是一个好习惯，这取决于你如何使用它。

但是在像这样使用 LINQ 时要记住的重要一点是`Select()`（以及许多其他 LINQ 方法）实际上并不遍历集合并执行您的代码。仅当您迭代生成的集合时才会发生这种情况，通常使用`foreach`or `ToArray()`。

# facebook - 带有 show-faces="true" 的 Facebook 登录按钮忽略注册 URL

> ID：10183405
> 
> 赞同：1
> 
> 时间：2012-04-17T00:13:00.323
> 
> 标签：facebook, facebook-login

不确定这是一个错误还是我在文档中遗漏了什么，但是当我在我的网站上为 Facebook 登录按钮插件设置 show-faces="true" 时，它似乎不再关注注册 URL范围。

这个按预期工作：

```
<fb:login-button registration-url="http://mysite.com/my_registration/"></fb:login-button> 
```

结果：

*   如果用户没有登录FB，将显示“登录”。单击后，将提示用户登录。一旦用户登录，如果他们没有在我的网站上注册，将重定向到[http://mysite.com/my_registration/](http://mysite.com/my_registration/)。如果他们已经注册，将关闭身份验证对话框。
*   如果用户已登录 FB，但未在我的网站上注册，将显示“注册”。单击后，将立即重定向到[http://mysite.com/my_registration](http://mysite.com/my_registration)。
*   如果用户已登录 FB 并已注册，将显示“登录”但单击时不会执行任何操作。

这一切都很好。但是，当我像这样添加 show-faces="true" 时：

```
<fb:login-button registration-url="mysite.com/my_registration" show-faces="true"></fb:login-button> 
```

结果：

*   面孔出现了，这很好。然而...
*   如果用户没有登录FB，将显示“登录”。单击后，将提示用户登录。一旦用户登录，如果他们还没有在我的网站上注册，它将注册他们，但它**不会重定向**到registration-url指定的url。
*   如果用户已登录 FB，但未在我的网站上注册，将显示“登录”（而不是上面示例中的“注册”）。再次单击时，**不会重定向**到 registraiton-url。
*   如果用户已登录 FB 并已注册，则会显示人脸，但不会显示登录按钮。

我找不到任何东西来解释这种行为。有人有任何想法或链接吗？提前致谢。

# matlab - MATLAB 保存和加载特征向量

> ID：10183409
> 
> 赞同：1
> 
> 时间：2012-04-17T00:13:49.840
> 
> 标签：matlab, image-processing, classification, glcm

我正在尝试将特征向量加载到分类器中，例如 k 最近邻分类器。

我有我的 GLCM 代码，所以我得到了数字（特征向量）的对比度、相关性、能量、同质性。

我的问题是，如何从所有训练图像中保存每组特征向量？我在某处看到人们有一个 .set 文件要加载到分类器中（可能是特定分类器工具箱的特殊情况）。

```
load 'mydata.set'; 
```

例如。

我想它不必是 .set 文件。
我只需要一种方法将所有训练图像中的所有特征向量存储在一个可以加载的单独文件中。

我谷歌了， [我发现这可能有用](https://stackoverflow.com/questions/5556736/how-to-save-sift-feature-vector-for-classification-using-neural-network) ，但我不完全确定。

提前感谢您的时间和帮助。

问候。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T02:20:47.687

如果您将特征向量排列为名为 的数组的列`X`，则只需发出命令

```
save('some_description.mat','X'); 
```

或者，如果您希望保存文件是可读的，比如 ASCII，那么就使用它来代替：

```
save('some_description.txt', 'X', '-ASCII'); 
```

稍后，当你想重新使用数据时，只需说

```
var = {'X'}; % <-- You can modify this if you want to load multiple variables.

load('some_description.mat', var{:});
load('some_description.txt', var{:}); % <-- Use this if you saved to .txt file. 
```

然后命名的变量`'X'`将被加载到工作空间中，其列将是您之前计算的相同特征向量。

您将需要替换`some_description`上面每个文件名的部分，而是使用可以让您轻松识别文件中保存了哪些数据集的特征向量的东西（如果您有多个数据集）。您的特征向量数组也可能被称为除 之外的东西`X`，因此您可以相应地更改名称。

# c - 在 C 中比较字符串的最快方法

> ID：10183420
> 
> 赞同：-1
> 
> 时间：2012-04-17T00:15:34.643
> 
> 标签：c, string, comparison, type-conversion

如果我有一个需要比较很多字符串的程序，那么最好的方法是什么才能使运行时间最短？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-17T01:15:35.117

`strcmp()`- 比较两个字符串。

```
const char *s1, *s2; 
```

是要比较的字符串。

```
int i;
i = strcmp( s1, s2 ); 
```

给出比较的结果。`i`如果字符串相同，则为零。`i`如果 string 大于 string则为正，如果 string`s1`大于 string则为`s2`负。“大于”和“小于”的比较是按照 ASCII 排序顺序进行的。`s2``s1`

`strcmp()`将字符串`s1`与字符串进行比较`s2`。两个字符串都必须以通常的 '`\0'`字符结尾。

* * *

`strncmp()`

```
const char *s1, *s2; 
```

是要比较的字符串。

```
size_t N; 
```

给出要检查的字符数.

```
int i;
i = strncmp( s1, s2, N ); 
```

给出比较的结果。如果字符串`i`的第一个字符相同，则为零。如果字符串“s1”大于字符串，则为正，如果字符串“s2”大于字符串，则为负。“大于”和“小于”的比较是按照 ASCII 排序顺序进行的。`N``i``s2``s1`

`strncmp()`将字符串的前 N ​​个字符与字符串`s1`的第一个`N`字符进行比较`s2`。如果其中一个或两个字符串短于`N`字符（即如果`strncmp()`遇到 ' `\0'`），则比较将在该点停止。因此`N`表示要检查的最大字符数，而不是确切的数字。（请注意，如果`N`为零，`strncmp()`则始终返回零——不检查任何字符，因此不会发现差异。）

* * *

```
memcmp()
const void *s1, *s2; 
```

是要比较的字符串。大小_t N;

给出要检查的字符数.

```
int i;
i = memcmp( s1, s2, N ); 
```

给出比较的结果。如果字符串`i`的第一个字符相同，则为零。如果 string "s1" 大于 string 则为正数，如果 string大于string则为负数。“大于”和“小于”的比较是按照 ASCII 排序顺序进行的。`N``i``s2``s2``s1`

`memcmp()`将`N`字符串 "s1" 的前 N ​​个字符与字符串 的前 N ​​个字符进行比较`s2`。

与 function 不同`strncmp()`，`memcmp()`它不检查`'\0'`任何一个终止字符串。因此它会检查一个完整的`N`字符，即使字符串实际上并没有那么长。

* * *

```
wmemcmp()
int wmemcmp(const wchar_t *a1, const wchar_t *a2, size_t size); 
```

该函数`wmemcmp()`比较从 a1 开始的尺寸宽字符和从 a2 开始的尺寸宽字符。返回的值小于还是大于零取决于第一个不同的宽字符是 a1 是小于还是大于 a2 中的相应字符。

如果两个块的内容相等，则`wmemcmp()`返回 0。

在任意数组上，该`memcmp()`函数主要用于测试相等性。对字节以外的事物数组进行按字节排序的比较通常没有意义。例如，对构成浮点数的字节进行逐字节比较可能不会告诉您有关浮点数值之间关系的任何信息。

* * *

```
wcscmp()
int wcscmp(const wchar_t *ws1, const wchar_t *ws2); 
```

wcscmp 函数将宽字符串 ws1 与 ws2 进行比较。返回的值小于还是大于零取决于第一个不同的宽字符是 ws1 是小于还是大于 ws2 中的相应字符。

如果两个字符串相等，则`wcscmp()`返回 0。

使用的排序的结果`wcscmp()`是，如果 ws1 是 的初始子字符串`ws2`，则认为 ws1 “小于” ws2。

`wcscmp()`不考虑写入字符串的语言的排序约定。要得到那个必须使用`wcscoll`.

* * *

```
wcscasecmp()
int wcscasecmp(const wchar_t *ws1, const wchar_T *ws2) 
```

此函数类似于`wcscmp()`，只是忽略大小写的差异。大写和小写字符的关联方式由当前选择的语言环境决定。在标准的“C”语言环境中，字符 Ä 和 ä 不匹配，但在将这些字符视为它们匹配的字母的一部分的语言环境中。

* * *

```
strcmpi()

int strcmpi(const char *string1, const char *string2); 
```

`strcmpi()`比较`string1`并且`string2`不区分大小写。**在比较之前，两个参数 string1 和 string2 中的所有字母字符都转换为小写**。

该函数对以空结尾的字符串进行操作。该函数的字符串参数应包含一个空字符，用于`'\0'`标记字符串的结尾。

`strcmpi()`返回一个值，指示两个字符串之间的关系，如下所示

小于 0`string1`小于`string2`

0`string1`相当于 string2

大于 0`string1`大于`string2`。

* * *

```
strcasecmp()
int strcasecmp(const char *s1, const char *s2); 
```

此函数类似于`strcmp()`，只是忽略大小写的差异。大写和小写字符的关联方式由当前选择的语言环境决定。在标准的“C”语言环境中，字符 Ä 和 ä 不匹配，但在将这些字符视为它们匹配的字母的一部分的语言环境中。

* * *

```
strncasecmp()
int strncasecmp(const char *s1, const char *s2, size_t n); 
```

此函数类似于`strncmp()`，只是忽略大小写的差异。就像`strcasecmp()`，它取决于语言环境，大写和小写字符的关系如何。

* * *

*哪种方法最好当然取决于您的要求。*

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-17T00:18:39.683

您可以使用`strcmp( string1,string2);`

如果它们是字符串数组：`strcmp(string1[i], string2[j]);`

它将返回一个数字：

*   如果为 0，那么它们是相同的。
*   如果它大于 0，则字符串一按字母顺序大于第二个。
*   如果它小于 0，则字符串一按字母顺序小于第二个。

# svn - 快速获取远程 svn 存储库的所有 svn:externals 列表

> ID：10183426
> 
> 赞同：27
> 
> 时间：2012-04-17T00:16:36.033
> 
> 标签：svn

我们有一个包含大量目录和文件的 svn 存储库，我们的构建系统需要能够找到所有 svn:externals 属性，递归地查找存储库中的一个分支，然后再检查它。目前我们使用：

```
svn propget svn:externals -R http://url.of.repo/Branch 
```

事实证明，这非常耗时，并且是真正的带宽消耗。似乎客户端正在接收 repo 中所有内容的所有道具并在本地进行过滤（尽管我尚未通过wireshark 确认这一点）。有没有更快的方法来做到这一点？最好以某种方式让服务器只返回所需的数据。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-05-03T12:11:42.397

正如您所提到的，它确实会消耗网络带宽。但是，如果您有权访问托管这些存储库的服务器，则可以通过`file://`协议运行它。事实证明，它更快且不消耗网络。

```
svn propget svn:externals -R file:///path/to/repo/Branch 
```

此外，如果你有整个工作副本，你也可以在你的 WC 中运行它。

```
svn propget svn:externals -R /path/to/WC 
```

希望它可以帮助您更快地获得结果！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-23T18:28:36.020

我终于想出了一个解决方案。我决定将请求分解为多个小的 svn 请求，然后将每个请求都设为由线程池运行的任务。这种抨击 svn 服务器，但在我们的例子中，svn 服务器在 LAN 上，并且这个查询只在完整构建期间进行，所以这似乎不是问题。

```
import os
import sys
import threading
import ThreadPool

thread_pool = ThreadPool.ThreadPool(8)
externs_dict = {}
externs_lock = threading.Lock()

def getExternRev( path, url ):
    cmd = 'svn info "%s"' % url
    pipe = os.popen(cmd, 'r')
    data = pipe.read().splitlines()

    #Harvest last changed rev
    for line in data:
        if "Last Changed Rev" in line:
            revision = line.split(":")[1].strip()
            externs_lock.acquire()
            externs_dict[path] = (url, revision)
            externs_lock.release()

def getExterns(url, base_dir):
    cmd = 'svn propget svn:externals "%s"' % url
    pipe = os.popen(cmd, 'r')
    data = pipe.read().splitlines()
    pipe.close()

    for line in data:
        if line:
            line = line.split()
            path = base_dir + line[0]
            url = line[1]
            thread_pool.add_task( getExternRev, path, url )

def processDir(url, base_dir):
    thread_pool.add_task( getExterns, url, base_dir )

    cmd = 'svn list "%s"' % url
    pipe = os.popen(cmd, 'r')
    listing = pipe.read().splitlines()
    pipe.close()

    dir_list = []
    for node in listing:
        if node.endswith('/'):
            dir_list.append(node)

    for node in dir_list:
        #externs_data.extend( analyzePath( url + node, base_dir + node ) )
        thread_pool.add_task( processDir, url+node, base_dir+node )

def analyzePath(url, base_dir = ''):
    thread_pool.add_task( processDir, url, base_dir )
    thread_pool.wait_completion()

analyzePath( "http://url/to/repository" )
print externs_dict 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2018-04-20T12:07:41.053

不知道我在哪里找到了这个宝石，但是**用自己的外部组件查看外部**组件非常有用：

```
Windows:
    svn status . | findstr /R "^X"

Linux/Unix:
    svn status . | grep -E "^X" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-20T13:31:01.373

由于 -R 开关，它很慢；递归搜索存储库路径中的所有目录以查找该属性，这需要大量工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-05-03T21:46:17.477

不是理想的解决方案（可能有副作用）并且不能回答您的问题，但是

您可以重写所有外部定义并在一个常见的已知位置添加（重写） - 这样您将在更改后消除 pg 中的递归

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-03-25T09:53:39.857

如果您不介意使用 Python 和 pysvn 库，这里是我用于 SVN 外部的完整命令行程序：

```
"""
@file
@brief SVN externals utilities.
@author Lukasz Matecki
"""
import sys
import os
import pysvn
import argparse

class External(object):

    def __init__(self, parent, remote_loc, local_loc, revision):
        self.parent = parent
        self.remote_loc = remote_loc
        self.local_loc = local_loc
        self.revision = revision

    def __str__(self):
        if self.revision.kind == pysvn.opt_revision_kind.number:
            return """\
Parent:     {0}
Source:     {1}@{2}
Local name: {3}""".format(self.parent, self.remote_loc, self.revision.number, self.local_loc)
        else:
            return """\
Parent:     {0}
Source:     {1} 
Local name: {2}""".format(self.parent, self.remote_loc, self.local_loc)

def find_externals(client, repo_path, external_path=None):
    """
    @brief Find SVN externals.
    @param client (pysvn.Client) The client to use.
    @param repo_path (str) The repository path to analyze.
    @param external_path (str) The URL of the external to find; if omitted, all externals will be searched.
    @returns [External] The list of externals descriptors or empty list if none found.
    """
    repo_root = client.root_url_from_path(repo_path)

    def parse(ext_prop):
        for parent in ext_prop:
            external = ext_prop[parent]
            for line in external.splitlines():
                path, name = line.split()
                path = path.replace("^", repo_root)
                parts = path.split("@")
                if len(parts) > 1:
                    url = parts[0]
                    rev = pysvn.Revision(pysvn.opt_revision_kind.number, int(parts[1]))
                else:
                    url = parts[0]
                    rev = pysvn.Revision(pysvn.opt_revision_kind.head)
                retval = External(parent, url, name, rev)
                if external_path and not external_path == url:
                    continue
                else:
                    yield retval

    for entry in client.ls(repo_path, recurse=True):
        if entry["kind"] == pysvn.node_kind.dir and entry["has_props"] == True:
            externals = client.propget("svn:externals", entry["name"])
            if externals:
                for e in parse(externals):
                    yield e

def check_externals(client, externals_list):
    for i, e in enumerate(externals_list):
        url = e.remote_loc
        rev = e.revision
        try:
            info = client.info2(url, revision=rev, recurse=False)
            props = info[0][1]
            url = props.URL
            print("[{0}] Existing:\n{1}".format(i + 1, "\n".join(["   {0}".format(line) for line in str(e).splitlines()])))
        except:
            print("[{0}] Not found:\n{1}".format(i + 1, "\n".join(["   {0}".format(line) for line in str(e).splitlines()])))

def main(cmdargs):
    parser = argparse.ArgumentParser(description="SVN externals processing.",
                                     formatter_class=argparse.RawDescriptionHelpFormatter,
                                     prefix_chars='-+')

    SUPPORTED_COMMANDS = ("check", "references")

    parser.add_argument(
        "action",
        type=str,
        default="check",
        choices=SUPPORTED_COMMANDS,
        help="""\
the operation to execute:
   'check' to validate all externals in a given location;
   'references' to print all references to a given location""")

    parser.add_argument(
        "url",
        type=str,
        help="the URL to operate on")

    parser.add_argument(
        "--repo", "-r",
        dest="repo",
        type=str,
        default=None,
        help="the repository (or path within) to perform the operation on, if omitted is inferred from url parameter")

    args = parser.parse_args()

    client = pysvn.Client()

    if args.action == "check":
        externals = find_externals(client, args.url)
        check_externals(client, externals)
    elif args.action == "references":
        if args.repo:
            repo_root = args.repo
        else:
            repo_root = client.root_url_from_path(args.url)
        for i, e in enumerate(find_externals(client, repo_root, args.url)):
            print("[{0}] Reference:\n{1}".format(i + 1, "\n".join(["   {0}".format(line) for line in str(e).splitlines()])))

if __name__ == "__main__":
    sys.exit(main(sys.argv)) 
```

这应该适用于 Python 2 和 Python 3。您可以像这样使用它（实际地址已删除）：

```
python svn_externals.py references https://~~~~~~~~~~~~~~/cmd_utils.py
[1] Reference:
   Parent:     https://~~~~~~~~~~~~~~/BEFORE_MK2/scripts/utils
   Source:     https://~~~~~~~~~~~~~~/tools/python/cmd_utils.py
   Local name: cmd_utils.py
[2] Reference:
   Parent:     https://~~~~~~~~~~~~~~/VTB-1425_PCU/scripts/utils
   Source:     https://~~~~~~~~~~~~~~/tools/python/cmd_utils.py
   Local name: cmd_utils.py
[3] Reference:
   Parent:     https://~~~~~~~~~~~~~~/scripts/utils
   Source:     https://~~~~~~~~~~~~~~/tools/python/cmd_utils.py
   Local name: cmd_utils.py 
```

至于性能，这工作得非常快（尽管我的存储库很小）。你必须自己检查一下。

# java - 如何在 JEditorPane 中读取 HTML 文件？

> ID：10183429
> 
> 赞同：1
> 
> 时间：2012-04-17T00:17:14.333
> 
> 标签：java

基本上我有一个名为 FlowLayout.html 的文件，我想将它读入 JEditorPane。到目前为止，我拥有所有代码，但我不知道如何在窗格中打开文件。

```
 JEditorPane jtfInfo = new JEditorPane();
  jtfInfo.setEditable(false);
  p3.add(jtfInfo);

  public void getFlowLayout(){
    jftInfo.setContentType("text/html");
  //I dont know this step and setContentType gives me an error in netbeans Cannot find symbol 
```

}

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T00:58:01.767

您可以`setPage()`使用指向 FlowLayout.html 文件的 URL 调用该方法：

```
public void getFlowLayout(){
    jftInfo.setPage(new URL("path to file"));
} 
```

来自[Java 教程：如何使用编辑器窗格和文本窗格](http://docs.oracle.com/javase/tutorial/uiswing/components/editorpane.html)：

> “setPage 方法打开 URL 指向的资源并计算出文本的格式（在示例中为 HTML）。如果文本格式已知，编​​辑器窗格将使用在 URL 中找到的文本进行初始化。A “

# jquery - 动态元素不响应 .Live() 函数

> ID：10183432
> 
> 赞同：0
> 
> 时间：2012-04-17T00:17:55.157
> 
> 标签：jquery, bind, live

我有一个生成元素列表的脚本；跨越。我有脚本可以在 DOM 层次结构中移动它们，以使用 .appendTo() 来定位 div 等。以下脚本不适用于新移动的对象，即使我使用的是 .live()。

```
 var User = 0;
    $(".List span").live('dblclick', function(e){
        e.stopPropagation();
        User = $(this).attr('class').match(/Usr1/g) ? 1
             : $(this).attr('class').match(/Usr2/g) ? 2
             : null;
        $(this).prependTo("#List_" + User); 
    }); 
```

澄清一下：我点击一个跨度；它移动到.List。我 dblclick .List 中的跨度；没发生什么事。它应该移动到#List_*。如果我对它们进行 dblclick，.List 中的跨度确实会移动。

新人怎么不动？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T02:17:40.840

我重新编写了问题脚本，现在一切正常。感谢您让我知道 .on()，我会调查一下。

# linux - 在 shell 中使用“<”比较两个参数

> ID：10183438
> 
> 赞同：1
> 
> 时间：2012-04-17T00:18:41.540
> 
> 标签：linux, shell

让我们这样分配：

```
a=7
b=29
[[ $a < $b ]] && echo dasf 
```

它不起作用！

然而，当

```
a=1 
```

b 和命令相同，效果很好。

这很时髦！有人可以解释一下吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T00:23:07.110

您是在词法上比较变量，而不是在数字上。

尝试

```
[[ $a -lt $b ]] && echo smaller 
```

或者

```
(( $a < $b )) && echo smaller 
```

# javascript - IE9 中的控制台未定义错误

> ID：10183440
> 
> 赞同：17
> 
> 时间：2012-04-17T00:18:49.807
> 
> 标签：javascript, console, internet-explorer-9

我有一个显示 SVG 图形的图形页面。我正在使用 Raphael 图形框架。该页面在 Firefox 中正确显示，此外，如果 F12 开发人员工具在 IE9 中设置为“打开”，则它可以正常工作。如果 F12 开发者模式关闭并且应用程序在清除浏览器缓存的情况下启动（模拟普通用户），该地图在 IE9 中显示部分数据（它是一个节点链接图，它仅显示 12 个节点中的一个子节点）。

更新：我保持​​调试器打开并向我显示错误“控制台未定义”。所以我认为这不是图形渲染问题，而且我没有明确使用控制台，也许思维导图 js 在内部使用它，但是如何再次摆脱这个问题呢？

**更新**：我发现了问题并注释掉了 js 文件中的 console.log 条目。

谢谢。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-04-17T00:37:18.100

可能您的代码或您正在调用的代码正在使用`console.log`或类似的东西。

您可以在全局范围内添加此代码，为 IE（或任何不支持它的浏览器）创建一个虚拟包装器。在调用任何其他库之前，只需将以下代码放在某处：

```
if(!(window.console && console.log)) {
  console = {
    log: function(){},
    debug: function(){},
    info: function(){},
    warn: function(){},
    error: function(){}
  };
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-07-24T20:04:32.297

问题是您的 js 代码有时会调用控制台方法，例如“console.log”，但您的浏览器没有控制台（或已关闭）；

要解决此问题，请在包含任何脚本之前添加（一次）：

```
//Ensures there will be no 'console is undefined' errors
window.console = window.console || (function(){
    var c = {}; c.log = c.warn = c.debug = c.info = c.error = c.time = c.dir = c.profile = c.clear = c.exception = c.trace = c.assert = function(){};
    return c;
})(); 
```

仅当它不存在时才会创建一个“伪”控制台，因此“控制台未定义”错误将消失。

希望这可以帮助。干杯

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-17T00:29:32.137

您的代码中有 console.log() 或 console.error() 调用吗？

# c# - 计算一个类中使用了多少对象

> ID：10183441
> 
> 赞同：1
> 
> 时间：2012-04-17T00:18:55.533
> 
> 标签：c#

真的很简单的问题，我似乎无法找到答案。

如何计算特定类中使用了多少对象？我正在考虑使用列表并将所有对象添加到列表中，然后计算列表...如果我要这样做，我将如何访问该列表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T00:27:34.543

如果您对创建了多少个类的实例感兴趣，可以在其构造函数中增加一个静态计数器。

```
public class C
{
  private static int numInstances;
  public C() {
    ++numInstances;
    // and whatever else is needed
  }
} 
```

请注意，此代码不是线程安全的：您需要围绕对 C.numInstances 的访问添加线程安全保护

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T00:31:27.510

基本上有两种方法可以做到这一点。

1.  在您的类中保留一个静态计数，该计数在构造函数上递增并在析构函数上递减（并且`Dispose`，如果您使用`IDisposable`）。这样做的缺点是您将延迟对象上的垃圾收集，因为它们将进入终结队列（如果不使用`Dispose`）。

2.  保留对您的实例的*弱引用*的静态列表。添加`this`到构造函数中的列表。在枚举列表或计算其元素时，检查弱引用是否仍然存在以真正计算该对象。此外，此时您可能希望*压缩*列表，即删除其失效的弱引用。您可以看一下[`ConditionalWeakTable<TKey, TValue>`](http://msdn.microsoft.com/en-us/library/dd287757.aspx)，但不幸的是，它没有为您提供简单的计数。

此外，如果多个线程可以创建您的对象，请考虑同步对这些元素的访问。

# c++ - QT 模态窗口和禁用父工具栏

> ID：10183442
> 
> 赞同：0
> 
> 时间：2012-04-17T00:19:22.717
> 
> 标签：c++, qt, user-interface, qt4, toolbar

我正在使用 Qt4 开发一个项目，但遇到了一个小问题。我正在从主窗口创建一个模式窗口。我希望这可以禁用顶部的工具栏。我有一个从菜单中生成模式的菜单项。我想要的是，当生成模式时，菜单被禁用。我曾尝试使用 setEnabled(false) 函数，但这并没有重置它。

这是代码：

```
void Main_Screen::Create_ViPro()
{
   std::auto_ptr<ViPro_Dialog> modal(new ViPro_Dialog(this));
   modal->show();
   modal->exec();
} 
```

所以它只是一个在选择菜单项时触发的简单类。我觉得问题源于我将父级设置为主屏幕的事实，但是我不知道如何在没有父级的情况下创建模式（这样做没有意义）。有没有办法从孩子禁用父母工具栏？到目前为止我唯一看到的是 _fileMenu->setEnabled(false); 只要我不创建模式，它就可以工作，但是一旦产生，菜单就会再次工作。我完全迷路了。提前致谢

以帕特里斯的身份编辑

这是构造函数

```
 Main_Screen::Main_Screen(QWidget* parent /*= NULL*/) 
                        : QMainWindow(parent),
                          _newProj(new QAction(tr("New &ViPro"), this)),
                          _fileMenu(menuBar()->addMenu(tr("&File")))
{    
  //create slot for creating a new project
  connect(_newProj.get(), SIGNAL(triggered()), this, SLOT(Create_ViPro()));
  _fileMenu->addAction(_newProj.get());
  //if i do this then setEnabled(false) works perfectly and i can't access the menu
  Create_ViPro()
} 
```

因此，该功能通过触发 newproject 动作来发出信号。如果我直接从构造函数中调用该函数，它会像您所说的那样禁用它，但是，如果我通过触发器调用了该函数，它不会禁用它。我处理信号/槽机制错了吗？再次感谢。

另一个例子，如果我创建函数 create_vipro() 如下

```
void Main_Screen::Create_ViPro()
{
     _fileMenu->setEnabled(false);
} 
```

当我触发事件时，文件菜单没有被禁用，所以它必须与模态本身无关，而是如何处理信号。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T10:52:00.510

由于 child 是一个模态对话框，主屏幕无法对事件做出反应。但是您可以在创建模态对话框之前禁用工具栏（或菜单栏），并在离开 exec 函数后立即启用它：

```
void Main_Screen::Create_ViPro()
{
   _fileMenu->setEnabled(false);

   std::auto_ptr<ViPro_Dialog> modal(new ViPro_Dialog(this));
   modal->show();
   modal->exec(); // Will stay here until you close the modal dialog

   _fileMenu->setEnabled(true);
} 
```

如果 ViPro_Dialog 真的是一个模态对话框，它将起作用。

另一件事，由于 ViPro_Dialog 是模态的，您可以在本地声明它而不使用 auto_ptr：

```
void Main_Screen::Create_ViPro()
{
   _fileMenu->setEnabled(false);

   ViPro_Dialog modal(this);
   modal.show();
   modal.exec(); // Will stay here until you close the modal dialog

   _fileMenu->setEnabled(true);
} 
```

**编辑：**

我猜（我无法在工作中测试）您在执行 QAction 时无法启用/禁用菜单。Signal 正在按顺序调用插槽，因此当您尝试禁用菜单时 QAction 很忙。试试这个：

1.  在主屏幕中，使用一个启用/禁用菜单栏的布尔参数创建一个插槽。只需调用 setEnabled 函数
2.  在 ViPro_Dialog 中，发出带有布尔参数的信号（启动时为假，验证时为真）
3.  在 Create_ViPro 中，创建对话框后，将新信号与插槽连接，执行对话框，不要忘记断开插槽与信号的连接：

void Main_Screen::Create_ViPro() { ViPro_Dialog modal(this);

// 连接信号/槽

模态的.show(); modal.exec(); // 将一直留在这里，直到您关闭模态对话框

// 断开信号/槽 }

这可以达到你想要的

**编辑2**

您在使用模态对话框时犯了一个错误。`show()`和之间有冲突`exec()`。当您显示模态对话框时，您不需要禁用其他窗口：它由对话框的模态状态自动完成。模态深度有很多：http: [//qt-project.org/doc/qt-4.8/qt.html#WindowModality-enum](http://qt-project.org/doc/qt-4.8/qt.html#WindowModality-enum)。所以你的代码应该是：

```
void Main_Screen::Create_ViPro()
{
   ViPro_Dialog modal(this);

   // modal.setWindowModality(Qt::WindowModal); // Uncomment this line if you want to only disable parent

   modal.exec();
} 
```

阅读本文了解更多详情：http: [//qt-project.org/doc/qt-4.8/QDialog.html#details](http://qt-project.org/doc/qt-4.8/QDialog.html#details)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T18:14:49.547

Using`exec()`不仅创建了一个模态对话框，它还暂停了大部分常规事件处理，并且只处理`exec()`. 这可能包括一些 UI 更新（例如从启用到禁用的转换），但我并不肯定。处理此问题的更好方法可能是显式设置对话框模式，但允许常规事件循环继续，如下所示：

```
void Main_Screen::Create_ViPro()
{
   ViPro_Dialog* modal = new ViPro_Dialog(this);
   modal->setModal(true);
   modal->show();
} 
```

该代码仍不会在视觉上禁用工具栏或菜单栏，但它们应该没有响应。要禁用它们，您可以尝试将其与[Patrice Bernassola 的答案](https://stackoverflow.com/a/10189814/9876)结合使用。

# c# - 何时分配类型？

> ID：10183443
> 
> 赞同：3
> 
> 时间：2012-04-17T00:19:33.177
> 
> 标签：c#

所以，我最近一直在学习 C#，但有一件事我无法弄清楚或找到答案：

考虑一下：

```
class Class1 {
    int myInt = 32;
} 
```

还有这个：

```
class Class1 {
    int myInt;

    public Class1(){
        myInt = 32;
    }
} 
```

我只是想知道何时以及为什么应该使用一种方法而不是另一种方法来分配或实例化值。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-17T00:34:27.223

首先，当初始化需要显式或隐式引用“this”时，您*必须在 ctor 中进行初始化：*

```
class C
{
    int x = MakeX();  
    int MakeX() { whatever } 
} 
```

这是非法的，因为调用是隐含的，`this.MakeX()`而**你甚至还没有运行 ctor，所以使用`this`.** 这是合法的：

```
class C
{
    int x;
    int MakeX() { whatever }
    public C() { this.x = this.MakeX(); } 
} 
```

因为显然我们不能限制`this` *在 ctor 主体本身中的*使用。

另请注意，*字段初始值设定项按从最多派生到最少派生的顺序运行并**首先*运行。基类构造函数按照*从最少派生到最多派生的顺序运行，**然后*运行。这很少有关系，但无论如何知道它是有帮助的。

一般来说，建议只是“保持一致”。不要使用初始化器初始化某些字段，而不要使用 ctor 主体中的语句初始化某些字段；选择一个并始终如一地做。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-17T00:25:37.127

这是您公司的品味或编码标准的问题。

我的经验法则是，如果我的所有构造函数都为变量分配相同的值，我使用第一种形式；如果值来自外部，或者不同的构造函数为变量分配不同的值，我使用第二种形式。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-17T00:25:54.293

如果您在工业界工作，这主要取决于您的项目的个人偏好或编码约定，即没有“正确”或“错误”的方式来初始化成员变量。最后，重要的是你如何做到这一点是一致的。

# ios - 将 iOS 应用从 NSCoding 转换为 Core Data

> ID：10183445
> 
> 赞同：0
> 
> 时间：2012-04-17T00:19:48.093
> 
> 标签：ios, core-data, app-store, icloud, nscoding

我的应用程序目前使用 NSCoding 来存储持久数据，但我想切换到 Core Data 以利用它与 iCloud 的集成。问题是该应用程序目前在 App Store 上运行，我担心一旦我做出更改，我当前用户本地商店的数据就会丢失。

理论上，我应该能够做到以下几点：

1.  测试是否存在 NSCoding 数据
2.  将数据转换为核心数据格式
3.  为所有未来的“保存”使用核心数据

...但我还没有找到任何有关进行转换的文档。

有任何想法吗？还是我完全不在某个地方？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T01:07:01.307

CoreData 做了一些很好的自动迁移，但那是来自不同的 CoreData 存储。在您的情况下，您将不得不编写自己的转换代码。

留下“旧”类，如果存在“旧”存储，则将其取消归档。然后，只需遍历存储中的对象，并创建它们的 CoreData 等价物。保存 CoreData，关闭它，然后重新加载它以检查以确保一切都相同。然后，删除旧的存储文件。

唯一的缺点是您必须保留旧代码（至少足以取消归档旧的对象格式）。

# mysql - 棘手的 SQL 查询

> ID：10183448
> 
> 赞同：1
> 
> 时间：2012-04-17T00:20:07.420
> 
> 标签：mysql, sql

好的，我有一个如下所示的表：

```
id | status(bool) | devicename(text) | datetime (timestamp) | kwh(float)
1  |      0       |            Light | 2012-04-17 00:40:12  | 0.6 
```

是数据的典型例子。现在我想计算出设备已经开启（状态）了多长时间。我想`TIMEDIFF(expr1,expr2)`在每组状态之间使用，`{1, 0}`因为我相信它非常适合这种任务。

我尝试创建一个查询，我可以在其中获取 1->0 对并计算出它们对应的时间差。还有一个额外的问题，如果最后一个值打开，我想让它计算出 ON 时间点和当前时间之间的时间差。我知道有一种比手动使用 php 分析表格结果更简单的方法。

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T00:26:54.580

好吧，如果你真的想在 MySQL 中使用它：

```
SET @total = 0, @lasttime = 0, @laststatus = 0;
SELECT IF(`status`=0,
          @total := IF(@lasttime=0,
                       0,
                       @total+TIMEDIFF(`datetime`,@lasttime)
          ),
          @lasttime := `datetime`
       ), (@laststatus := `status`) FROM `table`;
SET @total = @total + IF(@laststatus=1,TIMEDIFF(NOW(),@lasttime),0);
SELECT @total AS `result` 
```

老实说，选择所有行并让 PHP 处理它会更容易。

# asp.net - 数据库更新sql不影响数据库

> ID：10183449
> 
> 赞同：0
> 
> 时间：2012-04-17T00:20:20.040
> 
> 标签：asp.net, .net, sql, sql-server-2005

我有这个代码来更新数据库，但是当我用正确的数据运行它时，它执行没有错误，但数据库没有更新

```
 Dim conn As New SqlClient.SqlConnection(My.Resources.conn_str)
 Dim SQL As String = "Update vehicle SET make=@make,reg_no=@reg_no,model=@model,year=@year,type=@type,last_service=@last_service Where (id = @id)"
        conn.Open()
        Try
            Dim cmd As New SqlClient.SqlCommand(SQL, conn)
            Try
                cmd.Parameters.AddWithValue("@make", strMake)
                cmd.Parameters.AddWithValue("@reg_no", strRegnNum)
                cmd.Parameters.AddWithValue("@model", strModel)
                cmd.Parameters.AddWithValue("@year", intYear)
                cmd.Parameters.AddWithValue("@type", strType)
                cmd.Parameters.AddWithValue("@last_service", LastService)
                cmd.Parameters.AddWithValue("@id", ID.ToString)
                cmd.ExecuteNonQuery()
                cmd.Dispose()
            Catch ex As Exception
                Return ex.Message
            End Try
        Catch ex As Exception
            Return ex.Message
        Finally
            conn.Dispose()
        End Try 
```

任何人都可以帮助我解决它不工作的原因，因为我没有收到错误消息？

谢谢

编辑我将**cmd.ExecuteNonQuery()**替换为

```
Dim intAffected As Integer = cmd.ExecuteNonQuery()
Debug.Print(intaffected) 
```

我在输出窗口中得到 1

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T00:42:51.450

一些想法：

1.  如果您有权访问 SQL Profiler，则可以查看查询、值、结果、任何触发器、任何事务等。这是识别正在发生的事情的最简单方法。
2.  如果您无权访问 Profiler，请更新您的查询以包含 OUTPUT 子句，并使用 ExecuteReader 将 insert.* 和 deleted.* 中的值返回到 SqlDataReader。检查结果。
3.  如果 id 是 int，请不要在 parameter.AddWithValue 上使用 ID.ToString()。使用整数本身，因为带有字符串值的 AddWithValue 方法可能导致 ID 参数被配置为 varchar/nvarchar。

# iphone - 是否可以使用同一个项目在 Xcode 4 上生成两个不同的 IPA？iPhone 一个，iPad 一个？

> ID：10183451
> 
> 赞同：1
> 
> 时间：2012-04-17T00:20:45.773
> 
> 标签：iphone, ios, xcode4, xcode4.3, ipa

我目前有一个通用 iOS 应用程序，但是对于新的 iPad3 设备，我们需要为该特定设备添加资源/精灵，问题是由于巨大的新屏幕，IPA 的大小变得难以置信地大。我想知道是否可能只有一个 Xcode 4 项目可以生成两种不同的 IPA，一个带有 target:iphone，另一个带有 target:ipad，它还可以根据文件扩展名包含或排除文件，例如 blah-ipad .png 不会出现在 iphone 版本上。谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-17T00:52:02.337

@Conrad Shultz 关于为什么不应该将现有的付费应用一分为二的说法是正确的。

对于尚未发布其应用程序或应用程序免费的人，值得知道您可以通过右键单击（或按住 Control 单击）目标并选择复制来复制目标。我很确定复制仅通过此上下文菜单提供。更明显的“添加目标”选项涉及创建一个全新的目标并手动复制现有目标的内容和设置。

![XCode UI 显示目标上下文菜单和复制选项](../Images/65e02c43689d44eca09285d3777526ba.png)

拥有多个目标后，您可以指定每个目标分配的资源。

**编辑**：如果您有 iPhone 目标和 iPad 目标，您还需要更改“设备”设置。

![XCode UI 显示图像资源的目标成员资格选择](../Images/cbbc212243f247e48dc91faa43b0a888.png)

如果您有很多资源，请考虑将它们包含在具有文件夹引用的文件夹中。然后，您可以为整个文件夹指定目标成员身份，而无需更改单个文件。这将更改捆绑包中这些资源的路径，因此请进行相应的计划。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T00:37:12.280

是和不是。

您当然可以为不同的产品设置不同的构建目标（和方案），针对不同的设备系列、不同的架构，甚至完全不同的平台（OS X 与 iOS）。您当然可以在每个中包含不同的资产。我个人一直都这样做，所以如果这是您想要做的，请告诉我，我会尽力提供更多详细信息。

但是你*不能*为一个产品提交多个 IPA 到 App Store。如果您已经通过 App Store 分发通用应用程序，那么您唯一的办法就是拉取它并创建两个具有新捆绑标识符、产品名称等的新应用程序。（我不*认为*，但我可能错了点，您甚至可以将通用应用程序降级为单一家庭应用程序，但这是您必须在开发人员/App Store 文档和协议中检查的内容。）

如果你走这条路，你会迫使现有用户以全价再次购买新应用。这可能会受到客户的不良欢迎。如果我是你，我会看看大小差异是否真的大到足以担心，如果是这样，看看跨设备重用资产的策略（例如，在@1x 设备上缩小更高分辨率的图像），尽管这引入了可能的性能损失。

# python - 在将字典写入文件时在字典末尾添加一个 '\n'

> ID：10183453
> 
> 赞同：0
> 
> 时间：2012-04-17T00:20:50.840
> 
> 标签：python, python-3.x

我正在尝试将我的字典写入文件并且已经知道我必须将其更改为字符串。但是，有什么方法可以在末尾添加 '\n' 以保持我的文件井井有条吗？

代码如下：

```
def dictionary(grocerystock):

    with open('grocery_stock.txt','r+') as f:
        lines = f.readlines()

# filter out empty lines
    lines = [line for line in lines if line.strip() != '']

# split all lines
    lines = [line.split() for line in lines]

# convert to a dictionary
    grocerystock = dict((a, (b, c)) for a, b, c in lines)

# print
    for k, v in grocerystock.items():
        print (k, v)

    grocerystock=str(grocerystock)

    grocerystock=grocerystock.replace("{",'')
    grocerystock=grocerystock.replace("}",'')
    grocerystock=grocerystock.replace("(",'')
    grocerystock=grocerystock.replace(")",'')
    grocerystock=grocerystock.lstrip()
    grocerystock=grocerystock.rstrip()
    grocerystock=grocerystock.strip()
    grocerystock=grocerystock.replace(":",'')
    c=(grocerystock+("\n"))

    e=open('grocery_stock.txt', 'w+')

    e.write(c)
    e.close() 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-17T00:23:17.667

如果您的意图只是将其存储`dict`到文件中，则可以简单地使用[pickle](http://docs.python.org/library/pickle.html)，但是，考虑到您对可读性的关注，我认为您希望它具有人类可读性 - 在这种情况下，您可能需要考虑[JSON](http://docs.python.org/library/json.html)。

```
import json

with open('grocery_stock.txt', 'r') as file:
    grocery_stock = json.load(file)

...

with open('grocery_stock.txt', 'w') as file:
    json.dump(grocery_stock, file, indent=4) 
```

这将产生[JSON](http://json.org/)输出，看起来类似于 Python 文字：

```
{
    "title": "Sample Konfabulator Widget",
    "name": "main_window",
    "width": 500,
    "height": 500
} 
```

自然地，按照您的数据进行结构化。

使用这些模块之一意味着您不需要将自己的序列化/反序列化到/从文件滚动。

当然，如果你觉得你必须自己滚动，例如，如果其他东西（你无法控制）以这种格式期待它，那么你可以在编写时简单地将换行符连接到字符串到文件中，就像您所做的那样。这不按预期工作吗？

编辑：

现有代码无法按预期工作的原因是您将整个字典转换为字符串，然后在末尾添加一个换行符 - 这不会解决您的问题，因为您希望在每一行末尾添加一个换行符. 如果您*必须*手动执行此操作，最好的方法是遍历您的 dict，根据需要写出项目：

```
with open('grocery_stock.txt', 'w') as file:
    for key, value in grocery_stock.items():
        file.write(key+" "+value+"\n") 
```

这将在每一行写入由空格分隔的键和值。您可能需要更改它以适应字典的数据结构和您想要的输出格式。

还值得注意的是，您的阅读是以迂回的方式完成的，请考虑：

```
with open('grocery_stock.txt','r') as file:
    grocery_stock = {key: value for key, *value in (line.split() for line in file if line.strip())} 
```

但是，正如我在开头所说的那样，请记住这是一种序列化数据的脆弱方式，并且正在重新发明轮子 - 除非您无法控制的其他东西需要这种格式，否则请使用标准格式并节省您的精力。

# php - 如何从 PHP 中的 SimpleXMLObject 中获取第 n 个值？

> ID：10183457
> 
> 赞同：1
> 
> 时间：2012-04-17T00:21:46.657
> 
> 标签：php, xml, simplexml

我有一个 SimpleXMLElement 并且想在使用 foreach 循环循环之前检查特定元素是否具有非空白值。这是我的 SimpleXMLObject

假设这包含在 $myXMLElement

```
SimpleXMLElement Object ( [f] => Array ( [0] => Marcus [1] => Smith [2] => Brown University [3] => 1243123200000 [4] => Masters [5] => TestValue [6] => TestValue2 [7] => 4 [8] => SimpleXMLElement Object ( [@attributes] => Array ( [id] => 16 ) ) [9] => 0 ) [update_id] => 1325795135203 ) 
```

在数组中是一个值

```
[3] => 1243123200000 
```

这就是我想检查这个参数并确定它不是NULL。如果我想将它作为字符串抓取，那么这样做的方法是什么。

我希望有类似 (string)$myXMLElement[3] 的东西，但这似乎不是我正在尝试的正确语法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T00:39:08.293

您可以使用数组表示法，但由于数组是节点的一部分，`f`您必须像这样访问它：

```
$val = $xmlObj->f[3];

if (empty($val)) {
    // its empty
} 
```

在不相关的注释中，由于该数组中的第 8 个元素本身就是一个 SimpleXML 对象，因此您可以像这样访问它的值：

```
$val = $xmlObj->f[8]->update_id; 
```

在这些情况下，它只是对象访问和数组访问表示法的混合。

要从第 8 个元素获取属性，您还可以使用数组表示法：

```
$id = $xmlObj->f[8]['id']; // get "id" attribute 
```

[Basic SimpleXML Usage](http://www.php.net/manual/en/simplexml.examples-basic.php)页面有一些非常有用的示例，展示了如何从 SimpleXML 对象访问不同的元素。Example #5 展示了如何[访问属性](http://www.php.net/manual/en/simplexml.examples-basic.php#example-5081)。

# php - PHP - 如何处理从 HTTP POST 接收到的 unicode 以便在 HTML 中显示它们

> ID：10183458
> 
> 赞同：1
> 
> 时间：2012-04-17T00:21:47.997
> 
> 标签：php, unicode

如何转换这样的东西

> \xe6\xa6\x82\xe8\xa6\x81\n\xe3\x83\xbb\xe3\x82\xb0\xe3\x83\xaa\xe3\x83\xbc\xe3\x81\xae\xe3\x82\xa8 \xe3\x83\xb3\xe3\x82\xb8\xe3\x83\x8b\xe3\x82\xa2\xe3\x81\xab\xe5\xbf\x9c\xe5\x8b\x9f\xe3\x81\x97\xe3 \x81\xa6\xe3\x81\xbf\xe3\x81\x9f\xe3\x81\x84\xe3\x81\x8c\xe3\x80\x81\xe5\xbf\x9c\xe5\x8b\x9f\xe5\x89 \x8d\xe3\x81\xab\xe8\x87\xaa\xe5\x88\x86\xe3\x81\xae\xe5\xae\x9f\xe5\x8a\x9b\xe3\x82\x92\xe8\xa9\xa6 \xe3\x81\x97\xe3\x81\xa6\xe3\x81\xbf\xe3\x81\x9f\xe3\x81\x84\xe3\x80\x82\n\xe3\x83\xbb\xe5\x9c\xb0 \xe6\x96\xb9\xe3\x81\xab\xe4\xbd\x8f\xe3\x82\x93\xe3\x81\xa7\xe3\x81\x84\xe3\x82\x8b\xe3\x81\xae\xe3 \x81\xa7\xe9\x9d\xa2\xe6\x8e\xa5\xe5\x9b\x9e\xe6\x95\xb0\xe3\x81\x8c\xe5\xb0\x91\xe3\x81\xaa\xe3\x81 \x84\xe6\x96\xb9\xe3\x81\x8c\xe3\x81\x82\xe3\x82\x8a\xe3\x81\x8c\xe3\x81\x9f\xe3\x81\x84\xe3\x80\x82 \n\xe3\x83\xbb\xe9\x9d\xa2\xe6\x8e\xa5\xe3\x81\xaf\xe8\x8b\xa6\xe6\x89\x8b\xe3\x81\xa0\xe3\x81\x8c\xe3\x83\x97\xe3\x83\xad\xe3\x82\xb0\xe3\x83\xa9\xe3\x83\x9f\xe3\ x83\xb3\xe3\x82\xb0\xe3\x81\xab\xe3\x81\xaf\xe8\x87\xaa\xe4\xbf\xa1\xe3\x81\x8c\xe3\x81\x82\xe3\x82\ x8b\xe3\x80\x82\xe3\x81\xaf\xe3\x80\x81\xe3\x81\x93\xe3\x81\xae\xe3\x82\x88\xe3\x81\x86\xe3\x81\xaa\ xe6\x96\xb9\xe3\x80\x85\xe3\x81\xae\xe3\x81\x94\xe8\xa6\x81\xe6\x9c\x9b\xe3\x81\xab\xe3\x81\x8a\xe5\ xbf\x9c\xe3\x81\x88\xe3\x81\x99\xe3\x82\x8b\xe3\x81\x9f\xe3\x82\x81\xe3\x81\xab\xe4\xbd\x9c\xe3\x82\ x89\xe3\x82\x8c\xe3\x81\x9f\xe6\x96\xb0\xe3\x81\x97\xe3\x81\x84\xe6\x8e\xa1\xe7\x94\xa8\xe3\x83\x97\ xe3\x83\xad\xe3\x82\xb0\xe3\x83\xa9\xe3\x83\xa0\xe3\x81\xa7\xe3\x81\x99\xe3\x80\x82\n\xe3\x83\x97\ xe3\x83\xad\xe3\x82\xb0\xe3\x83\xa9\xe3\x83\x9f\xe3\x83\xb3\xe3\x82\xb0\xe3\x82\xb9\xe3\x82\xad\xe3\ x83\xab\xe3\x82\x92\xe8\xa9\x95\xe4\xbe\xa1\xe3\x81\x99\xe3\x82\x8b\xef\xbc\x91\xe6\xac\xa1\xe9\x9d\xa2\xe6\x8e\xa5\xe3\x82\x92\xe3\x83\x91\xe3\x82\xb9\xe3\x81\xa7 \xe3\x81\x8d\xe3\x81\xbe\xe3\x81\x99\xe3\x81\xae\xe3\x81\xa7\xe5\x8a\xb9\xe7\x8e\x87\xe7\x9a\x84\xe3 \x81\xaa\xe8\xbb\xa2\xe8\x81\xb7\xe6\xb4\xbb\xe5\x8b\x95\xe3\x82\x92\xe8\xa1\x8c\xe3\x81\xa3\xe3\x81 \xa6\xe9\xa0\x82\xe3\x81\x91\xe3\x81\xbe\xe3\x81\x99\xe3\x80\x82\n\xe3\x82\x82\xe3\x81\xa1\xe3\x82 \x8d\xe3\x82\x93\xe5\xad\xa6\xe7\x94\x9f\xe3\x81\xae\xe7\x9a\x86\xe3\x81\x95\xe3\x82\x93\xe3\x81\xae \xe3\x83\x81\xe3\x83\xa3\xe3\x83\xac\xe3\x83\xb3\xe3\x82\xb8\xe3\x82\x82\xe3\x81\x8a\xe5\xbe\x85\xe3 \x81\xa1\xe3\x81\x97\xe3\x81\xa6\xe3\x81\x8a\xe3\x82\x8a\xe3\x81\xbe\xe3\x81\x99\xe3\x80\x82b9\xe7\x8e\x87\xe7\x9a\x84\xe3\x81\xaa\xe8\xbb\xa2\xe8\x81\xb7\xe6\xb4\xbb\xe5\x8b\x95\xe3\x82\x92\ xe8\xa1\x8c\xe3\x81\xa3\xe3\x81\xa6\xe9\xa0\x82\xe3\x81\x91\xe3\x81\xbe\xe3\x81\x99\xe3\x80\x82\n\ xe3\x82\x82\xe3\x81\xa1\xe3\x82\x8d\xe3\x82\x93\xe5\xad\xa6\xe7\x94\x9f\xe3\x81\xae\xe7\x9a\x86\xe3\ x81\x95\xe3\x82\x93\xe3\x81\xae\xe3\x83\x81\xe3\x83\xa3\xe3\x83\xac\xe3\x83\xb3\xe3\x82\xb8\xe3\x82\ x82\xe3\x81\x8a\xe5\xbe\x85\xe3\x81\xa1\xe3\x81\x97\xe3\x81\xa6\xe3\x81\x8a\xe3\x82\x8a\xe3\x81\xbe\ xe3\x81\x99\xe3\x80\x82b9\xe7\x8e\x87\xe7\x9a\x84\xe3\x81\xaa\xe8\xbb\xa2\xe8\x81\xb7\xe6\xb4\xbb\xe5\x8b\x95\xe3\x82\x92\ xe8\xa1\x8c\xe3\x81\xa3\xe3\x81\xa6\xe9\xa0\x82\xe3\x81\x91\xe3\x81\xbe\xe3\x81\x99\xe3\x80\x82\n\ xe3\x82\x82\xe3\x81\xa1\xe3\x82\x8d\xe3\x82\x93\xe5\xad\xa6\xe7\x94\x9f\xe3\x81\xae\xe7\x9a\x86\xe3\ x81\x95\xe3\x82\x93\xe3\x81\xae\xe3\x83\x81\xe3\x83\xa3\xe3\x83\xac\xe3\x83\xb3\xe3\x82\xb8\xe3\x82\ x82\xe3\x81\x8a\xe5\xbe\x85\xe3\x81\xa1\xe3\x81\x97\xe3\x81\xa6\xe3\x81\x8a\xe3\x82\x8a\xe3\x81\xbe\ xe3\x81\x99\xe3\x80\x82\xe3\x83\xa3\xe3\x83\xac\xe3\x83\xb3\xe3\x82\xb8\xe3\x82\x82\xe3\x81\x8a\xe5\xbe\x85\xe3\x81\xa1\xe3 \x81\x97\xe3\x81\xa6\xe3\x81\x8a\xe3\x82\x8a\xe3\x81\xbe\xe3\x81\x99\xe3\x80\x82\xe3\x83\xa3\xe3\x83\xac\xe3\x83\xb3\xe3\x82\xb8\xe3\x82\x82\xe3\x81\x8a\xe5\xbe\x85\xe3\x81\xa1\xe3 \x81\x97\xe3\x81\xa6\xe3\x81\x8a\xe3\x82\x8a\xe3\x81\xbe\xe3\x81\x99\xe3\x80\x82

我在 HTTP POST 中收到，以便在 HTML 网页上正确显示它们。

我不知道我在看什么，但我认为我可以转换成这种`&#x263A;`格式的东西。

我如何在 PHP 中做到这一点

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T00:33:41.923

好像日本

```
php > echo "\xe6\xa6\x82\xe8\xa6\x81\n\xe3\x83\xbb\xe3\x82\xb0\xe3\x83\xaa\xe3\x83\xbc\xe3\x81\xae\xe3\x82\xa8\xe3\x83\xb3\xe3\x82\xb8\xe3\x83\x8b\xe3\x82\xa2\xe3\x81\xab\xe5\xbf\x9c\xe5\x8b\x9f\xe3\x81\x97\xe3\x81\xa6\xe3\x81\xbf\xe3\x81\x9f\xe3\x81\x84\xe3\x81\x8c\xe3\x80\x81\xe5\xbf\x9c\xe5\x8b\x9f\xe5\x89\x8d\xe3\x81\xab\xe8\x87\xaa\xe5\x88\x86\xe3\x81\xae\xe5\xae\x9f\xe5\x8a\x9b\xe3\x82\x92\xe8\xa9\xa6\xe3\x81\x97\xe3\x81\xa6\xe3\x81\xbf\xe3\x81\x9f\xe3\x81\x84\xe3\x80\x82\n\xe3\x83\xbb\xe5\x9c\xb0\xe6\x96\xb9\xe3\x81\xab\xe4\xbd\x8f\xe3\x82\x93\xe3\x81\xa7\xe3\x81\x84\xe3\x82\x8b\xe3\x81\xae\xe3\x81\xa7\xe9\x9d\xa2\xe6\x8e\xa5\xe5\x9b\x9e\xe6\x95\xb0\xe3\x81\x8c\xe5\xb0\x91\xe3\x81\xaa\xe3\x81\x84\xe6\x96\xb9\xe3\x81\x8c\xe3\x81\x82\xe3\x82\x8a\xe3\x81\x8c\xe3\x81\x9f\xe3\x81\x84\xe3\x80\x82\n\xe3\x83\xbb\xe9\x9d\xa2\xe6\x8e\xa5\xe3\x81\xaf\xe8\x8b\xa6\xe6\x89\x8b\xe3\x81\xa0\xe3\x81\x8c\xe3\x83\x97\xe3\x83\xad\xe3\x82\xb0\xe3\x83\xa9\xe3\x83\x9f\xe3\x83\xb3\xe3\x82\xb0\xe3\x81\xab\xe3\x81\xaf\xe8\x87\xaa\xe4\xbf\xa1\xe3\x81\x8c\xe3\x81\x82\xe3\x82\x8b\xe3\x80\x82\xe3\x81\xaf\xe3\x80\x81\xe3\x81\x93\xe3\x81\xae\xe3\x82\x88\xe3\x81\x86\xe3\x81\xaa\xe6\x96\xb9\xe3\x80\x85\xe3\x81\xae\xe3\x81\x94\xe8\xa6\x81\xe6\x9c\x9b\xe3\x81\xab\xe3\x81\x8a\xe5\xbf\x9c\xe3\x81\x88\xe3\x81\x99\xe3\x82\x8b\xe3\x81\x9f\xe3\x82\x81\xe3\x81\xab\xe4\xbd\x9c\xe3\x82\x89\xe3\x82\x8c\xe3\x81\x9f\xe6\x96\xb0\xe3\x81\x97\xe3\x81\x84\xe6\x8e\xa1\xe7\x94\xa8\xe3\x83\x97\xe3\x83\xad\xe3\x82\xb0\xe3\x83\xa9\xe3\x83\xa0\xe3\x81\xa7\xe3\x81\x99\xe3\x80\x82\n\xe3\x83\x97\xe3\x83\xad\xe3\x82\xb0\xe3\x83\xa9\xe3\x83\x9f\xe3\x83\xb3\xe3\x82\xb0\xe3\x82\xb9\xe3\x82\xad\xe3\x83\xab\xe3\x82\x92\xe8\xa9\x95\xe4\xbe\xa1\xe3\x81\x99\xe3\x82\x8b\xef\xbc\x91\xe6\xac\xa1\xe9\x9d\xa2\xe6\x8e\xa5\xe3\x82\x92\xe3\x83\x91\xe3\x82\xb9\xe3\x81\xa7\xe3\x81\x8d\xe3\x81\xbe\xe3\x81\x99\xe3\x81\xae\xe3\x81\xa7\xe5\x8a\xb9\xe7\x8e\x87\xe7\x9a\x84\xe3\x81\xaa\xe8\xbb\xa2\xe8\x81\xb7\xe6\xb4\xbb\xe5\x8b\x95\xe3\x82\x92\xe8\xa1\x8c\xe3\x81\xa3\xe3\x81\xa6\xe9\xa0\x82\xe3\x81\x91\xe3\x81\xbe\xe3\x81\x99\xe3\x80\x82\n\xe3\x82\x82\xe3\x81\xa1\xe3\x82\x8d\xe3\x82\x93\xe5\xad\xa6\xe7\x94\x9f\xe3\x81\xae\xe7\x9a\x86\xe3\x81\x95\xe3\x82\x93\xe3\x81\xae\xe3\x83\x81\xe3\x83\xa3\xe3\x83\xac\xe3\x83\xb3\xe3\x82\xb8\xe3\x82\x82\xe3\x81\x8a\xe5\xbe\x85\xe3\x81\xa1\xe3\x81\x97\xe3\x81\xa6\xe3\x81\x8a\xe3\x82\x8a\xe3\x81\xbe\xe3\x81\x99\xe3\x80\x82";
概要
・グリーのエンジニアに応募してみたいが、応募前に自分の実力を試してみたい。
・地方に住んでいるので面接回数が少ない方がありがたい。
・面接は苦手だがプログラミングには自信がある。は、このような方々のご要望にお応えするために作られた新しい採用プログラムです。
プログラミングスキルを評価する１次面接をパスできますので効率的な転職活動を行って頂けます。
もちろん学生の皆さんのチャレンジもお待ちしております。 
```

谷歌翻译

> 总结-但是我想申请glee的工程师，想在申请前试试自己的实力。次数越少，因为他们很欣赏住在农村的采访。• 节目有自信但不是很好的面试。是一个新的收养计划是为了满足这样的人的需求而创建的。你可以通过 Tenshoku 高效的活动，这样你就可以通过下一次面试来评估编程。我们期待挑战课程的学生

也许我错了 ;）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T00:35:19.573

如果您使用 HTTP 响应发送适当的字符集编码，则无需对数据执行任何操作，浏览器应将其正确解码为日语文本。

例子：

```
<?php

header('Content-Type: text/html; charset=UTF-8');
$var = "\xe6\xa6\x82\xe8\xa6\x81\n\xe3\x83\xbb\xe3\x82\xb0\xe3\x83\xaa\xe3\x83\xbc\xe3\x81\xae\xe3\x82\xa8\xe3\x83\xb3\xe3\x82\xb8\xe3\x83\x8b\xe3\x82\xa2\xe3\x81\xab\xe5\xbf\x9c\xe5\x8b\x9f\xe3\x81\x97\xe3\x81\xa6\xe3\x81\xbf\xe3\x81\x9f\xe3\x81\x84\xe3\x81\x8c\xe3\x80\x81\xe5\xbf\x9c\xe5\x8b\x9f\xe5\x89\x8d\xe3\x81\xab\xe8\x87\xaa\xe5\x88\x86\xe3\x81\xae\xe5\xae\x9f\xe5\x8a\x9b\xe3\x82\x92\xe8\xa9\xa6\xe3\x81\x97\xe3\x81\xa6\xe3\x81\xbf\xe3\x81\x9f\xe3\x81\x84\xe3\x80\x82\n\xe3\x83\xbb\xe5\x9c\xb0\xe6\x96\xb9\xe3\x81\xab\xe4\xbd\x8f\xe3\x82\x93\xe3\x81\xa7\xe3\x81\x84\xe3\x82\x8b\xe3\x81\xae\xe3\x81\xa7\xe9\x9d\xa2\xe6\x8e\xa5\xe5\x9b\x9e\xe6\x95\xb0\xe3\x81\x8c\xe5\xb0\x91\xe3\x81\xaa\xe3\x81\x84\xe6\x96\xb9\xe3\x81\x8c\xe3\x81\x82\xe3\x82\x8a\xe3\x81\x8c\xe3\x81\x9f\xe3\x81\x84\xe3\x80\x82\n\xe3\x83\xbb\xe9\x9d\xa2\xe6\x8e\xa5\xe3\x81\xaf\xe8\x8b\xa6\xe6\x89\x8b\xe3\x81\xa0\xe3\x81\x8c\xe3\x83\x97\xe3\x83\xad\xe3\x82\xb0\xe3\x83\xa9\xe3\x83\x9f\xe3\x83\xb3\xe3\x82\xb0\xe3\x81\xab\xe3\x81\xaf\xe8\x87\xaa\xe4\xbf\xa1\xe3\x81\x8c\xe3\x81\x82\xe3\x82\x8b\xe3\x80\x82\xe3\x81\xaf\xe3\x80\x81\xe3\x81\x93\xe3\x81\xae\xe3\x82\x88\xe3\x81\x86\xe3\x81\xaa\xe6\x96\xb9\xe3\x80\x85\xe3\x81\xae\xe3\x81\x94\xe8\xa6\x81\xe6\x9c\x9b\xe3\x81\xab\xe3\x81\x8a\xe5\xbf\x9c\xe3\x81\x88\xe3\x81\x99\xe3\x82\x8b\xe3\x81\x9f\xe3\x82\x81\xe3\x81\xab\xe4\xbd\x9c\xe3\x82\x89\xe3\x82\x8c\xe3\x81\x9f\xe6\x96\xb0\xe3\x81\x97\xe3\x81\x84\xe6\x8e\xa1\xe7\x94\xa8\xe3\x83\x97\xe3\x83\xad\xe3\x82\xb0\xe3\x83\xa9\xe3\x83\xa0\xe3\x81\xa7\xe3\x81\x99\xe3\x80\x82\n\xe3\x83\x97\xe3\x83\xad\xe3\x82\xb0\xe3\x83\xa9\xe3\x83\x9f\xe3\x83\xb3\xe3\x82\xb0\xe3\x82\xb9\xe3\x82\xad\xe3\x83\xab\xe3\x82\x92\xe8\xa9\x95\xe4\xbe\xa1\xe3\x81\x99\xe3\x82\x8b\xef\xbc\x91\xe6\xac\xa1\xe9\x9d\xa2\xe6\x8e\xa5\xe3\x82\x92\xe3\x83\x91\xe3\x82\xb9\xe3\x81\xa7\xe3\x81\x8d\xe3\x81\xbe\xe3\x81\x99\xe3\x81\xae\xe3\x81\xa7\xe5\x8a\xb9\xe7\x8e\x87\xe7\x9a\x84\xe3\x81\xaa\xe8\xbb\xa2\xe8\x81\xb7\xe6\xb4\xbb\xe5\x8b\x95\xe3\x82\x92\xe8\xa1\x8c\xe3\x81\xa3\xe3\x81\xa6\xe9\xa0\x82\xe3\x81\x91\xe3\x81\xbe\xe3\x81\x99\xe3\x80\x82\n\xe3\x82\x82\xe3\x81\xa1\xe3\x82\x8d\xe3\x82\x93\xe5\xad\xa6\xe7\x94\x9f\xe3\x81\xae\xe7\x9a\x86\xe3\x81\x95\xe3\x82\x93\xe3\x81\xae\xe3\x83\x81\xe3\x83\xa3\xe3\x83\xac\xe3\x83\xb3\xe3\x82\xb8\xe3\x82\x82\xe3\x81\x8a\xe5\xbe\x85\xe3\x81\xa1\xe3\x81\x97\xe3\x81\xa6\xe3\x81\x8a\xe3\x82\x8a\xe3\x81\xbe\xe3\x81\x99\xe3\x80\x82";

echo $var; 
```

由于我们发送一个标头说字符编码是 UTF-8，所以浏览器知道要这样解码。您还可以使用元标记来指定字符集。如果浏览器设置为自动检测代码，则这两个选项都不是必需的，但您不能依赖它。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-17T00:31:29.537

我实际上并没有真正的线索为什么你把它作为 POST，但我认为

```
\x82 
```

（等）代表十六进制数。要转换整个字符串（确保它是那种格式）：

```
$string = eval('return "' . $thatExactInputAsGiven . '";'); 
```

`$string`现在确实包含此提交所代表的字节序列。但是我不能告诉你它是哪种编码，但可能上面的这一行可以帮助你进行测试。

如果您害怕评估，请注意错误处理：

```
$string = implode('', array_map(function($v){
    $r = sscanf($v, '\x%x', $ord);
    if (!$r) throw new Exception('Invalid input.');
    return chr($ord);
}, str_split($thatExactInputAsGiven, 4))); 
```

# xml - xslt - 从 xml 文件中选择属性值

> ID：10183459
> 
> 赞同：14
> 
> 时间：2012-04-17T00:21:49.513
> 
> 标签：xml, xslt

我有一个 XML 文件：

```
<BatchTable>
  <UUThref SocketIndex='0 - CCM'
           UUTResult='Passed'
           URL='C:\OverrideCallbacks_BatchReport[4 16 2012][4 14 18 PM].xml'
           FileName='OverrideCallbacks_BatchReport[4 16 2012][4 14 18 PM].xml'
           ECAFailCount='1'
           Version='StationPartNumber=55555StationSerialNumber=2222TPSPartNumber=1234'/>
</BatchTable> 
```

为了在 xsl 文件中选择版本，我有：

```
<xsl:value-of select="BatchTable/UUThref/[@Version]"/> 
```

这不会返回任何值。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-04-17T00:24:20.193

它应该是

```
BatchTable/UUThref/@Version 
```

不是

```
BatchTable/UUThref/[@Version] 
```

...你从哪里得到方括号？

* * *

我已经测试了以下内容，它确实有效：

```
xmlstarlet sel -t -m 'BatchTable/UUThref/@Version' -v . <test.xml 
```

...此命令行通过应用以下 XSLT 来工作：

```
<?xml version="1.0"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:exslt="http://exslt.org/common" version="1.0" extension-element-prefixes="exslt">
  <xsl:output omit-xml-declaration="yes" indent="no"/>
  <xsl:template match="/">
    <xsl:for-each select="BatchTable/UUThref/@Version">
      <xsl:call-template name="value-of-template">
        <xsl:with-param name="select" select="."/>
      </xsl:call-template>
    </xsl:for-each>
  </xsl:template>
  <xsl:template name="value-of-template">
    <xsl:param name="select"/>
    <xsl:value-of select="$select"/>
    <xsl:for-each select="exslt:node-set($select)[position()&gt;1]">
      <xsl:value-of select="'&#10;'"/>
      <xsl:value-of select="."/>
    </xsl:for-each>
  </xsl:template>
</xsl:stylesheet> 
```

# mysql - 返回第 n 个倍数的总和

> ID：10183460
> 
> 赞同：2
> 
> 时间：2012-04-17T00:22:16.570
> 
> 标签：mysql

现在这是一个有趣的 MySQL 问题，我想知道它是否可能！

免责声明：虽然这是我之前提出的非常相似的问题，但实际上完全不同。只是在有人说我以前问过这个之前说。

**对于这个例子，假设我想要`SUMS()`20 的倍数。**

我想要`SUM()`行得分并返回日期。

假设我有下表按以下顺序排序`date ASC`：

## 数据

```
score |   date
  4     2000-01-01
  2     2000-01-02
  6     2000-01-03
  1     2000-01-04 //Score 4+2+6+1 = 13
  7     2000-01-05 //Score 4+2+6+1+7 = 20 so return this date
  1     2000-01-06
  2     2000-01-07
  1     2000-01-08
  5     2000-01-09
  1     2000-01-10
  9     2000-01-11 //Score = 39 so far.
  7     2000-01-12 //Score = 46 It's not 40 but is the closest number above 40 so return it.
  3     2000-01-13
  4     2000-01-14
  7     2000-01-15 //Score = 60, return this date. 
```

## 预期成绩：

```
score | date
 20     2000-01-05
 40     2000-01-12
 60     2000-01-15 
```

等等。是否可以在 MySQL 中执行此操作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T00:40:00.310

当然，一切皆有可能：）

```
select
    floor(partial / 20) * 20, min(date)
from
    (select
        (select sum(score) from Scores s2
         where s2.date <= s.date) as partial,
        score,
        date
    from
        Scores s) p
where
    floor(partial / 20) > 0
group by
    floor(partial / 20) 
```

演示：[http ://www.sqlfiddle.com/#!2/d44cf/3](http://www.sqlfiddle.com/#!2/d44cf/3)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-17T00:43:29.777

通过使用 SQL 变量，您不必继续对每个后续行进行递归聚合以计算给定实体。这将依次使用一个标志触发 20 的倍数。然后仅在“ThisOne”标志设置为 1 的情况下处理该结果。

```
select 
      M20.*
   from 
      ( select 
              TransDate,
              score,
              if( @runTotal + Score >= 20 * @multCnt, 1, 0 ) as ThisOne,
              @multCnt := @multCnt + if( @runTotal + Score >= 20 * @multCnt, 1, 0 ) as nextSeq,
              @runTotal := @runTotal + Score
           from Mult20s,
                ( select @multCnt := 1,
                         @runTotal := 0 ) sqlvars
           order by transdate ) M20
   where
      M20.ThisOne = 1 
```

# java - Java：我是否只负责绘制（JScrollPane）视口视图的可见区域？

> ID：10183467
> 
> 赞同：4
> 
> 时间：2012-04-17T00:23:27.147
> 
> 标签：java, swing, user-interface, jscrollpane

我正在使用 Java 教程示例来说明如何使用 JScrollPane（带有行/列标题）。该示例使用 JLabel 的子类在视口视图中显示图像。我使用示例代码来显示行/列标题（[Rule.java 示例代码](http://docs.oracle.com/javase/tutorial/displayCode.html?code=http://docs.oracle.com/javase/tutorial/uiswing/examples/components/ScrollDemoProject/src/components/Rule.java "规则.java")）并且对奇怪的结果感到困惑。我终于删除了对 getClipBounds() 的调用（显然用于确定行/列标题的哪个区域可见，仅绘制该区域）并绘制整个标题，问题得到解决。这意味着我现在正在绘制整个区域（在行/列标题和主视口中）。这让我觉得不是最优的。

1.  谁能解释为什么 Java 教程示例可以正常工作（除了源与示例中执行的不同）？
2.  即使它只是部分可见，我绘制整个窗格是否正确？
3.  如何确定整个对象的哪个区域在视口中可见（对于行/列标题和主视口），以便我可以绘制该区域？

**更新：**

我仍然不知道为什么该示例有效，但我发现如果我使用 JComponent.getVisibleRect() 而不是 Graphics.getClipBounds() 事情似乎按预期工作。不确定这是否是此方法的正确使用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T14:34:08.647

看看下面的这段代码。我只是在画可见的部分。

```
 @Override
public void paint(Graphics g) {
    Graphics2D g2d = (Graphics2D) g;
    Rectangle view = new Rectangle();
    if (getParent() instanceof JViewport) {
        JViewport vp = (JViewport) getParent();
        view = vp.getViewRect();
    } else {
        view = new Rectangle(0, 0, getWidth(), getHeight());
    }

    g2d.setColor(getBackground());
    g2d.fillRect((int) view.getX(), (int) view.getY(), (int) view.getWidth(), (int) view.getHeight());

    g2d.setColor(Color.YELLOW);
    double x = view.getX();
    double y = view.getY();
    double w = view.getWidth();
    double h = view.getHeight();

    // draw Strings
    for (StringShape ss : stringList) {
        Rectangle sb = ss.getRectangle(g2d.getFontMetrics(ss.getFont()));
        if (containShape(view, sb)) {
            g2d.setFont(ss.getFont());
            g2d.setColor(ss.getColor());
            g2d.drawString(ss.getString(), (int) sb.getX(), (int) sb.getY());

        }
    }

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T20:45:50.193

JComponent.getVisibleRect() 是诀窍。显然我误解了 getClipBounds() 的含义/用法。

# apex-code - 当前 Visualforce 页面上的链接以呈现为 PDF

> ID：10183469
> 
> 赞同：0
> 
> 时间：2012-04-17T00:23:55.280
> 
> 标签：apex-code, visualforce

我有一个使用 Visual force 创建的自定义构建列表报告页面。每行上的链接在新的视觉力量页面中打开对象详细信息。我需要有两个按钮。一个用于保存/打开当前页面及其所有信息为 PDF，另一个按钮用于打开打印对话框。

对于将当前页面呈现为 PDF 的按钮，我假设它很简单。请记住，第一次创建页面时，它被传递记录 ID 作为参数。

谢谢，卡尔文

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T21:22:54.383

要将页面呈现为 PDF，只需将 renderAs="PDF" 属性添加到 apex:page 标签。该值可以是动态的，如：`<apex:page renderAs="{!ISNULL($CurrentPage.parameters.p),'','PDF')}">`

如果 URL 中不包含名为“p”的参数（例如 /apex/myPage?id=someId），这会将页面呈现为 HTML，如果包含此参数，则呈现为 PDF（例如 /apex/myPage?id=一些Id&p = 1）。

为了使其将当前页面呈现为 PDF，我只需让按钮刷新页面并添加参数。

# f# - 这是在查询中求和十进制值类型的最佳方法吗？

> ID：10183470
> 
> 赞同：2
> 
> 时间：2012-04-17T00:24:01.623
> 
> 标签：f#

当我执行以下对不可为空的小数求和的查询时，我遇到了一个错误。当位置/组织组合没有幅度值时，幅度为空。

```
let q = query { from m in Measure do
                  where (locations.Contains(m.Location) 
                         && organizations.Contains(m.Organization))
                  sumBy m.Magnitude } 
```

错误：无法将 null 值分配给 System.Decimal 类型的成员，该类型是不可为 null 的值类型。

我通过以下方式解决了这个问题。有没有更好的方法来做到这一点？

```
let convert (n:Nullable<decimal>) =
        let c:decimal = 0M
        if n.HasValue then n.Value else c

let q = query { from m in Measure do
                  let nullable = Nullable<decimal>(m.Magnitude)
                  where (locations.Contains(m.Location) 
                         && organizations.Contains(m.Organization))
                  sumBy (convert(nullable)) } 
```

谢谢。我将查询更改为以下内容。

```
query {  for m in db.Measurement do
                let nullable = Nullable<decimal>(m.Magnitude)
                where ( m.Measure = me 
                        && (if slice.Organization > 0L then organizationUnits.Contains( m.PrimalOrganizationUnit.Value ) else true)
                        && (if slice.Location > 0L then locationUnits.Contains(m.PrimalLocationUnit.Value) else true) )
                sumByNullable (nullable) } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-17T00:26:12.453

[sumByNullable](http://msdn.microsoft.com/en-us/library/hh324035%28v=vs.110%29.aspx)？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-17T16:53:48.710

这是一个 LINQ-to-SQL 问题（但这是设计使然，因为在 SQL 中对空列求和会导致 NULL，请参见[此处](http://social.msdn.microsoft.com/Forums/en-US/linqprojectgeneral/thread/479f2823-c942-4990-adca-21e03f969a12/)），并非特定于 F#。您的解决方法似乎与链接的 MSDN 论坛线程中的建议相匹配。

# node.js - 使用nodejs时nTwitter出错

> ID：10183474
> 
> 赞同：0
> 
> 时间：2012-04-17T00:24:27.283
> 
> 标签：node.js, twitter

我正在尝试 nTwitter (nodejs v0.6.10) - 我尝试使用示例代码搜索 twitter，但在尝试库的搜索功能时出现以下错误（我使用的键似乎是正确的）：

无法将属性“q”设置为 null

任何可能导致此问题的想法 - 堆栈跟踪被复制到下面（代码也是如此）？

```
//twit is instance of Twitter (with keys assigned in)
twit.search('nodejs', function(err, data) {

if (err) {
console.log('Twitter search failed!');
}
else {
console.log('Search results:');
console.dir(data);
}
}); 
```

在 Object.merge (/opt/testDir/node/node_modules/ntwitter/lib/utils.js:9:18) 在 Twitter.search (/opt/testDir/node/node_modules/ntwitter/lib/twitter.js:167: 18) 在 Object.search (/opt/testDir/node/projects/testApp/public/javascripts/nTwitterTest.js:13:6) 在 nTwitterTestMediator (/opt/testDir/node/projects/testApp/app.js:1188: 14) 在回调 (/opt/testDir/node/projects/testApp/node_modules/express/lib/router/index.js:272:11) 在参数 (/opt/testDir/node/projects/testApp/node_modules/express/ lib/router/index.js:246:11) 在 Router._dispatch (/opt/ testDir/node/projects/testApp/node_modules/express/lib/router/index.js:280:4) 在 Object.handle (/opt/testDir/node/projects/testApp/node_modules/express/lib/router/index. js:45:10）在下一个（/opt/testDir/node/projects/testApp/node_modules/connect/lib/http.js:201:15）

Pilot 错误 - twitter 上的设置未更新（从只读到读写执行）。我切换到读取和写入（而不是读取、写入和执行）并且设置更改（这是由于我对 twitter api 和权限级别的无知）。

我能够发布推文以及使用 twitter 应用程序的读写访问级别访问流 API（使用 github 页面上的代码）。

我仍然无法使用搜索功能（下面的代码）。

```
twit.search('nodejs', function(err, data) {
if (err) {
console.log('Twitter search failed!');
}
else {
console.log('Search results:');
console.dir(data);
}
}); 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T23:17:10.090

我也有这个问题。您缺少一个参数。

尝试这个：

```
twit.search('nodejs', {}, function(err, data){ 
```

我认为这是原始 ntwitter 文档中的错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T20:26:59.733

Pilot 错误 - twitter 上的设置未更新（从只读到读写执行）。
我切换到读取和写入（而不是读取、写入和执行）并且设置更改（这是由于我对 twitter api 和权限级别的无知）。

我能够发布推文以及使用 twitter 应用程序的读写访问级别访问流 API（使用 github 页面上的代码）。

我仍然无法使用搜索功能（下面的代码）。

```
twit.search('nodejs', function(err, data) {
if (err) {
console.log('Twitter search failed!');
}
else {
console.log('Search results:');
console.dir(data);
}
}); 
```

谢谢。

# java - 有没有更好（更快）的方法将数字除为数字？

> ID：10183476
> 
> 赞同：1
> 
> 时间：2012-04-17T00:24:32.737
> 
> 标签：java

我写了这个：

```
void blah(int num)
{
    int numOfDigits = Math.log10(num);
    int arr[] = new int[numOfDigits + 1];
    for(int i = numOfDigits; i>0; i--)
    {
        arr[i] = num%10;
        num = num/10;
    }
} 
```

但我认为必须有一种更优雅的方式来做到这一点。有没有？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T00:29:04.027

如果您对字符串感到满意，您可以这样做：

```
String[] arr = Integer.toString(num).split("(?<=\\d)"); 
```

如果您想从这里转到`int[]`：

```
int[] arrint = new int[arr.length];
for (int i = 0; i < arr.length; i++)
     arrint[i] = Integer.parseInt(arr[i]); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T00:29:30.610

考虑使用将整数转换为字符串`Integer.toString`，然后使用`string.toCharArray()`并转换回来。这可能会也可能不会更“优雅”，具体取决于您的世界观。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-22T09:55:01.847

这可能是一种方式（我对此并不感到非常自豪:)）

```
Integer number = 1234567890;               // input number
String temp = number.toString();           // convert to string
int [] output = new int[temp.length()];

for (int i=0 ; i< temp.length(); i++)     // get character at index i from string
    output[i] = temp.charAt(i) - '0';      // convert it to number by removing '0' 
```

# php - 用 php 提取 Instagram 信息——解码然后呢？

> ID：10183479
> 
> 赞同：1
> 
> 时间：2012-04-17T00:25:10.353
> 
> 标签：php, json, instagram

我正在使用 curl 请求从 Instagram API 中提取 json。我想缓存这个 json 以从映射应用程序 (javascript) 中使用。

我应该直接从 API 中提取并缓存 json，还是对其进行解码、对数据进行处理、然后重新编码 json是否有*一些优势？*

我正在向一位开发人员朋友解释这种情况，他说了一些关于解码、循环数据，然后重新编码的事情。

除了以某种方式改变数据的格式——我想这样做，但决定改为客户端——这样做有什么好处？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T00:37:05.433

你问的问题没有对错之分。我会说以下内容：

1.  缓存请求：缓存远程请求通常很有用，尤其是在您开发时。您不会对远程服务器施加压力，并且您几乎可以立即获得响应。
2.  缓存数据处理也很有意义。通常实际的数据处理不会比原始请求花费更长的时间，但众所周知，处理缓存对于需要时间的处理也非常有用。
3.  两者都做 - 使用不同的超时配置 - 可能是缓存的高级艺术，但请记住，最好的缓存应该非常简单。如果您已经进行了前端缓存，通常可以忽略处理缓存，例如，如果您将您的网站置于反向代理（nginx、varnish）之后。

没有黑白之分，缓存最重要的是：做最适合*你*的事情。

# android - InflateException: Binary XML file line #60: Error inflating class com.google.android.maps.MapView

> ID：10183483
> 
> 赞同：1
> 
> 时间：2012-04-17T00:25:25.840
> 
> 标签：android

我不断收到这个错误，我不知道这个错误发生在哪里这个 xml 文件

```
?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

</LinearLayout> 
```

这是原木猫

```
04-17 02:19:25.556: W/dalvikvm(731): threadid=1: thread exiting with uncaught exception (group=0x4001d800)
04-17 02:19:25.586: E/AndroidRuntime(731): FATAL EXCEPTION: main
04-17 02:19:25.586: E/AndroidRuntime(731): java.lang.RuntimeException: Unable to start activity ComponentInfo{sbn.project.gp/sbn.project.gp.Mainevent}: android.view.InflateException: Binary XML file line #60: Error inflating class com.google.android.maps.MapView
04-17 02:19:25.586: E/AndroidRuntime(731):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2663)
04-17 02:19:25.586: E/AndroidRuntime(731):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679)
04-17 02:19:25.586: E/AndroidRuntime(731):  at android.app.ActivityThread.access$2300(ActivityThread.java:125)
04-17 02:19:25.586: E/AndroidRuntime(731):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)
04-17 02:19:25.586: E/AndroidRuntime(731):  at android.os.Handler.dispatchMessage(Handler.java:99)
04-17 02:19:25.586: E/AndroidRuntime(731):  at android.os.Looper.loop(Looper.java:123)
04-17 02:19:25.586: E/AndroidRuntime(731):  at android.app.ActivityThread.main(ActivityThread.java:4627)
04-17 02:19:25.586: E/AndroidRuntime(731):  at java.lang.reflect.Method.invokeNative(Native Method)
04-17 02:19:25.586: E/AndroidRuntime(731):  at java.lang.reflect.Method.invoke(Method.java:521)
04-17 02:19:25.586: E/AndroidRuntime(731):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
04-17 02:19:25.586: E/AndroidRuntime(731):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
04-17 02:19:25.586: E/AndroidRuntime(731):  at dalvik.system.NativeStart.main(Native Method)
04-17 02:19:25.586: E/AndroidRuntime(731): Caused by: android.view.InflateException: Binary XML file line #60: Error inflating class com.google.android.maps.MapView
04-17 02:19:25.586: E/AndroidRuntime(731):  at android.view.LayoutInflater.createView(LayoutInflater.java:513)
04-17 02:19:25.586: E/AndroidRuntime(731):  at android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:565)
04-17 02:19:25.586: E/AndroidRuntime(731):  at android.view.LayoutInflater.rInflate(LayoutInflater.java:618)
04-17 02:19:25.586: E/AndroidRuntime(731):  at android.view.LayoutInflater.inflate(LayoutInflater.java:407)
04-17 02:19:25.586: E/AndroidRuntime(731):  at android.view.LayoutInflater.inflate(LayoutInflater.java:320)
04-17 02:19:25.586: E/AndroidRuntime(731):  at android.view.LayoutInflater.inflate(LayoutInflater.java:276)
04-17 02:19:25.586: E/AndroidRuntime(731):  at com.android.internal.policy.impl.PhoneWindow.setContentView(PhoneWindow.java:198)
04-17 02:19:25.586: E/AndroidRuntime(731):  at android.app.Activity.setContentView(Activity.java:1647)
04-17 02:19:25.586: E/AndroidRuntime(731):  at sbn.project.gp.Mainevent.onCreate(Mainevent.java:27)
04-17 02:19:25.586: E/AndroidRuntime(731):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
04-17 02:19:25.586: E/AndroidRuntime(731):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2627)
04-17 02:19:25.586: E/AndroidRuntime(731):  ... 11 more
04-17 02:19:25.586: E/AndroidRuntime(731): Caused by: java.lang.reflect.InvocationTargetException
04-17 02:19:25.586: E/AndroidRuntime(731):  at com.google.android.maps.MapView.<init>(MapView.java:238)
04-17 02:19:25.586: E/AndroidRuntime(731):  at java.lang.reflect.Constructor.constructNative(Native Method)
04-17 02:19:25.586: E/AndroidRuntime(731):  at java.lang.reflect.Constructor.newInstance(Constructor.java:446)
04-17 02:19:25.586: E/AndroidRuntime(731):  at android.view.LayoutInflater.createView(LayoutInflater.java:500)
04-17 02:19:25.586: E/AndroidRuntime(731):  ... 21 more
04-17 02:19:25.586: E/AndroidRuntime(731): Caused by: java.lang.IllegalArgumentException: MapViews can only be created inside instances of MapActivity.
04-17 02:19:25.586: E/AndroidRuntime(731):  at com.google.android.maps.MapView.<init>(MapView.java:282)
04-17 02:19:25.586: E/AndroidRuntime(731):  at com.google.android.maps.MapView.<init>(MapView.java:255) 
```

这是android清单

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="tt.pp.ss"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk android:minSdkVersion="8" />

    <uses-permission android:name="android.permission.INTERNET" />
    <uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION"/>
    <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION"/>

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name" >
        <uses-library android:name="com.google.android.maps" />
        <activity
            android:name=".SbnActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>

        <activity

            android:name=".Main"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="tt.pp.ss.MAIN" />

                <category android:name="android.intent.category.DEFAULT" />
            </intent-filter>
        </activity>

        <activity
            android:name=".Db"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="tt.pp.ss.DB" />

                <category android:name="android.intent.category.DEFAULT" />
            </intent-filter>
        </activity>
        <activity
            android:name=".View"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="tt.pp.ss.VIEW" />

                <category android:name="android.intent.category.DEFAULT" />
            </intent-filter>
        </activity>
         <activity
            android:name=".Mainevent"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="tt.pp.ss.MAINEVENT" />

                <category android:name="android.intent.category.DEFAULT" />
            </intent-filter>
        </activity>
        <activity
            android:name=".Signup"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="tt.pp.ss.SIGNUP" />

                <category android:name="android.intent.category.DEFAULT" />
            </intent-filter>
        </activity>
    </application>

</manifest> 
```

我花了超过 5 个小时的任何帮助，但我无法弄清楚。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T00:33:16.617

```
MapViews can only be created inside instances of MapActivity. 
```

你在使用 MapActivity 吗？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-30T10:16:48.967

我之前遇到过同样的问题，通过以下两个步骤解决了：

1) 将以下行放入 AndroidManifest.xml 文件的应用程序（重要）元素中。

```
<uses-library android:name="com.google.android.maps" /> 
```

2）扩展**MapActivity**而不是**Activity**。

# java - 如何为 Tomcat 并行运行多个 servlet 执行？

> ID：10183484
> 
> 赞同：1
> 
> 时间：2012-04-17T00:25:29.240
> 
> 标签：java, jakarta-ee, tomcat, concurrency

我有一个 Tomcat 应用程序，我需要两个不同的 servlet 或同一个来并行响应我的请求。情况是我有第一个请求要求下载医学影像，而我有另一个 AJAX 客户端请求在第一个请求完全完成之前获取图像。但是由于某种原因，直到第一个请求结束，服务器才响应我的第二个请求。

为了实现并发 servlet 执行，必须改变什么？我们有一个非常好的服务器，它有多个驱动器、多个内核。我正在使用 Tomcat 6。任何可以探索的想法都会很棒。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T00:33:24.947

如果发生这种情况，则与 Tomcat 无关。可能您正在某处使用同步（隐式或显式）。

但是，您可以明确地管理线程池：

```
 <Connector port="8443" protocol="HTTP/1.1" SSLEnabled="true"
               maxThreads="150" scheme="https" secure="true"
               clientAuth="false" sslProtocol="TLS" /> 
```

或者

```
<Executor name="tomcatThreadPool" namePrefix="catalina-exec-"
        maxThreads="150" minSpareThreads="4"/>

<Connector executor="tomcatThreadPool"
               port="8080" protocol="HTTP/1.1"
               connectionTimeout="20000"
               redirectPort="8443" /> 
```

即您可以指定最大线程数或使用线程池。更多信息在这里[http://tomcat.apache.org/tomcat-5.5-doc/config/http.html](http://tomcat.apache.org/tomcat-5.5-doc/config/http.html)

# javascript - 下面的代码是什么意思？

> ID：10183492
> 
> 赞同：-3
> 
> 时间：2012-04-17T00:26:08.633
> 
> 标签：javascript, jquery

我想知道下面的代码是如何工作的，因为我在一个获取文件名的网站上找到了这个，但我不完全理解它是如何工作的：

```
function handleFileSelect(evt) {
    var files = evt.target.files;
    localStorage["fname"] = files[0].name; //save the name for future use
} 
```

上面的代码对于如下表单代码是否正确：

```
 <form action='imageupload.php' method='post' enctype='multipart/form-data' target='upload_target' onsubmit='return imageClickHandler(this);' class='imageuploadform' >
    <p><input name='fileImage' type='file' class='fileImage' /></p>
<iframe class='upload_target' name='upload_target' src='#' style='width:0;height:0;border:0px;solid;#fff;'></iframe></form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T00:43:13.260

该函数已绑定可能绑定到该`change`文件输入字段的事件。

所以让我们分解一下。

```
function handleFileSelect(evt) { 
```

当函数作为事件的侦听器绑定时，通常会传入一个表示该事件的对象。这是`evt`此事件处理函数接受的变量。

```
var files = evt.target.files; 
```

对于 DOM 事件，事件对象通常有一个名为的属性`target`，它是对触发事件的 DOM 元素的引用。所以`evt.target`返回文件输入元素。

文件输入元素有一个名为 的属性`files`，它是用户选择的文件对象数组（请注意，可能只选择了一个文件，但它仍然是一个只有一个项目的数组）。该行将该数组分配给`files`局部变量。

```
localStorage["fname"] = files[0].name; 
```

`localStorage`是作为 HTML5 的一部分引入的持久键值存储（类似于 cookie）。 `"fname"`是我们在其下存储值的键。并`files[0].name`获取第一个文件对象，并返回其`name`属性，有效地获取所选文件的名称。然后存储该值，因此即使您刷新页面，您也可以通过运行读取最后选择的文件名`localStorage["fname"]`

# jquery - jQuery：巧妙地消化快速事件

> ID：10183495
> 
> 赞同：0
> 
> 时间：2012-04-17T00:26:33.150
> 
> 标签：jquery, event-handling

我构建了一个 jQuery 组件，它由一组 3 个文本框组成，以图形背景 div 布局。悬停在每个盒子上会交换与盒子相关的相应背景图形。使用fadeIn/fadeOut 回调完成动画（fadeIn 在fadeOut 完成后发生）。

我遇到的问题是鼠标从框 #1 快速通过框 #3，穿过框 #2，不必要地进行与框 #2 相关的图像交换，并且由于淡入淡出设置为平滑，有时它在完成所有图像交换之前需要很长时间。当然，我说的是外行（不合格的网络用户）的话——jQuery 不知道什么是“不必要的”。我真正的意思是问是否有一种方法可以聪明地行动，并且 - 你的名字： - 将事件排队，也许在新的出现之前刷新那些没有按时完成的事件，或者可能是 stopPropagation，或者什么 -不是。

我对事件的工作不多，所以请原谅我的一般性问题。如果真的有帮助，我可以提供一些示例代码。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T00:54:42.733

如果您提供了 HTML 和 javascript，我们可以提供更具体的建议，但您可能需要`.stop(true)`在开始任何新动画之前添加。这将停止任何以前的动画并将它们从动画队列中删除，以便下一个动画可以立即开始。

例如，而不是这个：

```
$("whatever").fadeIn(); 
```

你会这样做：

```
$("whatever").stop(true).fadeIn(); 
```

如果没有`.stop(true)`，如果下一个在前一个完成之前开始，则动画可能会堆积在队列中，这在悬停触发的动画中很容易出现这种情况。

有关. [_](http://api.jquery.com/stop/) _`.stop()`

# php - 如果每个循环的 this 不为空，我想回显文本

> ID：10183497
> 
> 赞同：0
> 
> 时间：2012-04-17T00:27:04.170
> 
> 标签：php, html, foreach

下面是我的每个循环。我想检查循环是否不为空，然后回显“此循环不为空”，否则回显“此列表为空”；这是什么语法？

```
foreach ($wholikes as $key => $list2){
echo "is in the list".$list2['userid'];
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T00:30:32.783

尝试这个：

```
if(empty($wholikes)){
    echo "This list is empty";
}else{
    foreach ($wholikes as $key => $list2){
        echo "is in the list".$list2['userid'];
    } 
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T00:29:54.873

```
if( !$wholikes) echo "Empty"; 
```

这就是它的全部内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T00:32:35.603

在这种情况下，前两个答案将起作用，但在您想要的更一般的循环情况下：

```
$notEmpty = 0;
foreach ($wholikes as $key => $list2){
    $notEmpty = 1;
    echo "is in the list".$list2['userid'];
} 
if(notEmpty) {
   echo "Not empty.";
} else {
    echo "Empty";
} 
```

# python - 用于快速开发棋盘游戏动态规划解决方案的库

> ID：10183498
> 
> 赞同：3
> 
> 时间：2012-04-17T00:27:24.687
> 
> 标签：python, python-3.x, dynamic-programming

我想用 Python 来评估各种动态编程方法来进行没有不确定性的 2 人棋盘游戏（例如国际象棋等）。我对精确和启发式解决方案都感兴趣。我的“评估”包括尝试每种方法并观察它在我生成的测试用例中的表现。

我正在寻找一个非常灵活的库或框架，以帮助我尽可能快速轻松地编码、评估（和调试......）各种方法。

我只关心渐近性能（例如`O(n log n)`vs`O(n^2)`等）。所以我需要高效的数据结构，但我不介意恒定因素的性能影响。

我不介意学习图书馆是否需要一些前期投资。

我不需要任何前端；我只使用命令行界面。

我也不需要并行/分布式编程支持（尽管如果它可用我不会拒绝它）。

我现在或很快需要该库来支持 Python 3。

有没有提供这种支持的库？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T00:46:09.847

我不知道有任何特定于动态编程的库。然而，动态编程基本上是使用 memoization 来加速计算函数，并且从 Python 3.2 开始有一个灵活的函数 memoization 装饰器可用，称为`lru_cache()`.

它在`functools`，你绝对应该学习，因为它充满了漂亮的东西。

[http://docs.python.org/dev/library/functools.html](http://docs.python.org/dev/library/functools.html)

`@functools.lru_cache(maxsize=100, typed=False)`

如果您在某些早期版本的 Python 中需要此功能，则网络上有各种可用的记忆配方。

# c - 类型转换（或遵从） void * 到 struct foo*

> ID：10183499
> 
> 赞同：-2
> 
> 时间：2012-04-17T00:27:33.877
> 
> 标签：c, casting, void-pointers

在 api.h

```
typedef void* hidden_my_type;
void do_something(my_type x); 
```

在 core.c 中

```
struct _my_type
{
    int a;
}

void do_something(hidden_my_type void_x)
{
   struct *_my_type x = void_x;  /*Don't understand is that correct way to do, as I'm getting segmentation fault error */
   printf("Value: %d\n", x->a);
} 
```

我认为的其他方式，

```
struct *_my_type x = (struct _my_type *)malloc(sizeof(struct _my_type));
void_x = x
printf(Value: %d\n", x->a); 
```

但我仍然收到段错误错误。

* * *

好的，这里是 void*.... 的问题。

例如在 core.c

```
void init_my_type(hidden_my_type a)
{
   my_type *the_a = malloc(...);
   a = the_a   // <<<<<<<<<<<<<<<<<<<<<<<<<<<< is this correct?! a is void* and the_a // is original type
   pthread_cond_init(&the_a->...);
    .. (in short any other methods for init ..)
}
void my_type_destroy(my_hidden_type x)
{
    my_type *the_x = x;
    pthread_detroy(&the_x-> ...);
} 
```

在 main.c

```
test()
{
   my_hidden_type x;
   init_my_type(x);
   .... 
   my_type_detroy(x);
} 
```

这它自己应该失败。就像在 main.c 测试函数中一样， x 是 void* ... init 将分配，但在销毁时我再次传递 void* .. 这可以是任何东西！

编辑（为我解决）

在 api.h

```
typedef void* hidden_my_type;
void do_something(my_type x); 
```

在 core.c 中

```
 struct _my_type
    {
        int a;
    }

 void init_hidden_type(hidden_my_type void_p_my_type)
    {
        struct _my_type *real_my_type = (struct _my_type *)malloc(sizeof(struct _my_type));
        //--- Do init for your type ---
        void_p_my_type = real_my_type;
    }

 void do_something(hidden_my_type void_x)
    {
       struct *_my_type x = void_x; 
       printf("Value: %d\n", x->a);
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T00:35:19.060

## 版本 0 — 问题代码批判

发布的代码无法编译。

### api.h

```
typedef void* hidden_my_type;
void do_something(my_type x); 
```

这定义`hidden_my_type`但不是`my_type`传递给`do_something()`. 大概，你打算：

```
typedef void *my_type;
void do_something(my_type x); 
```

### 核心.c

```
struct _my_type
{
    int a;
} 
```

如下所述，结构定义后缺少分号。

```
void do_something(hidden_my_type void_x)
{
   struct *_my_type x = void_x;
   printf("Value: %d\n", x->a);
} 
```

你又遇到了`hidden_my_type`vs`my_type`问题。你有`*`指针不能去的地方；它必须在`struct _my_type`. 你可能打算这样：

```
void do_something(my_type void_x)
{
   struct _my_type *x = void_x;
   printf("Value: %d\n", x->a);
} 
```

这现在在语法上是正确的（我认为；我实际上并没有通过编译器运行它）。你还没有展示它是如何使用的；实际上，由于用户代码无法生成指向有效结构的指针，因此无法安全地使用此代码。

您的测试代码（未显示 - 为什么不显示您的测试代码）可能看起来像这样：

```
#include "api.h"

int main(void)
{
    my_type x = 0;
    do_something(x);
    return 0;
} 
```

或者，它可能没有`= 0`适当的初始化程序。无论哪种方式，您的代码都无法正常运行，并且核心转储几乎是不可避免的。当您向用户隐藏结构时，您必须为他们提供一种机制来获取有效的（指向）结构的（指针），而您还没有这样做。

## 版本 1

这是一种更好的方法，因为它更接近类型安全：

### api.h 版本 1

```
typedef struct _my_type *my_type;
void do_something(my_type x); 
```

### core.c 版本 1

```
#include "api.h"
struct _my_type
{
    int a;
}; 
```

注意添加的分号和`api.h`文件的包含。

```
void do_something(my_type x)
{
    // Now you don't have to do casting here!
    //struct *_my_type x = void_x;  /*Don't understand is that correct way to do, as I'm getting segmentation fault error */
    printf("Value: %d\n", x->a);
} 
```

* * *

## 版本 2

实际上，我们可以讨论隐藏指针的智慧；我宁愿不这样做：

### api.h 版本 2

```
#ifndef API_H_INCLUDED
#define API_H_INCLUDED

typedef struct my_type my_type;
extern void     do_something(my_type *x);
extern my_type *my_type_initializer(void);
extern void     my_type_release(my_type *x);

#endif /* API_H_INCLUDED */ 
```

### core.c 版本 2

```
#include "api.h"
#include <stdio.h>
#include <stdlib.h>

struct my_type
{
    int a;
};

void do_something(my_type *x)
{
    printf("Value: %d\n", x->a);
}

my_type *my_type_initializer(void)
{
    my_type *x = malloc(sizeof(*x));
    x->a = 57;  // More plausibly, this would be 0
    return x;
}

void my_type_release(my_type *x)
{
    free(x);
} 
```

### 主程序

```
#include "api.h"

int main(void)
{
    my_type *x = my_type_initializer();
    do_something(x);
    my_type_release(x);
    return 0;
} 
```

这很好，很干净。当然，用户不能分配一个`struct my_type`（只有一个指向它的指针），所以你需要一个函数来为他们分配结构。想想标准C库，`FILE`类型，`fopen()`分配和`fclose()`释放`fprintf()`等等来操作类型。`my_type_initializer()`是 的 类似物,`fopen()`类似物`my_type_release()`,`fclose()`和`do_something()`类似物`fprintf()`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T01:01:10.337

乔纳森，你打败了我，但这也可能有帮助。在这里，`api.c`包含（私有）实现，并`api.h`提供其他代码使用的接口，例如`main.c`.

```
// main.c: uses only the public interface to the private code
#include "api.h"

int main(int argc, char *argv[]) {
  void *foo;

  foo = create_foo("five", 5);
  print_foo(foo);
  delete_foo(foo);
}
// EOF main.c 
```

```
// api.h: the public interface
#ifndef _api_h_
#define _api_h_
void *create_foo(char *name, int number);
void print_foo(void *foo);
void delete_foo(void *foo);
#endif // _api_h_ 
```

```
// api.c: the private implementation
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

// The real structure is private to the implementation.
typedef struct {
        char name[20];
        int number;
} real_struct;

// Create a new structure, initialize, return as ptr-to-void.
void *create_foo(char *name, int number) {
  real_struct *s = malloc(sizeof(real_struct));
  strcpy(s->name, name);
  s->number = number;
  return (void *) s;
}

// Print the data.
void print_foo(void *foo) {
  real_struct *s = (real_struct *) foo;
  printf("name: %s, number: %d\n", s->name, s->number);
}

// Release the memory.
void delete_foo(void *foo) {
  free(foo);
}
// EOF api.c 
```

此代码应编译并运行：

```
$ gcc -o foo main.c api.c
$ ./foo

name: five, number: 5 
```

# c++ - FLTK 显示图像

> ID：10183507
> 
> 赞同：1
> 
> 时间：2012-04-17T00:29:11.427
> 
> 标签：c++, fltk

我正在制作一个简单的 FLTK 应用程序（在 Windows 中），它需要在 FL_Window 中显示 PNG 图像，从磁盘一个接一个地加载它们。我将此代码作为起点，但它没有显示我可以确认的图像与可执行文件位于同一文件夹中：

```
int main(int argc, char **argv)
{
    Fl_Window *main_window = NULL;
    fl_register_images();
    flw = new Fl_Window(1680,1050,title);
    Fl_Shared_Image *a = Fl_Shared_Image::get("picture.png");
    if (a != NULL) 
    {
       cout << "Image loaded" << endl;    
    }
    else
    {
       cout << "No image loaded" << endl;    // <==== This is printed 
    }
    flw->begin();
    // add image to window code here, not sure what to write but 
    // image doesnt even load
    flw->end(); 
    main_window->show();
    int fl_ret = Fl::run();
    return fl_ret;
} 
```

非常感谢任何帮助..

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-22T20:23:40.493

Fl_Shared_Image 类用于

“查找或加载可由多个小部件共享的图像。”

使用 Fl_PNG_Image 类

```
int main() {
    fl_register_images();                      
    Fl_Window     win(720,486);                 
    Fl_Box        box(10,10,720-20,486-20);     
    Fl_PNG_Image  png("picture.png");      
    box.image(png);                             
    win.show();
    return(Fl::run());
} 
```

# dll - .DLL 库未找到

> ID：10183510
> 
> 赞同：1
> 
> 时间：2012-04-17T00:29:17.970
> 
> 标签：dll, vst

我只是在写我的学士论文......它是一个 VST 插件（DLL 库），它依赖于 libfftw3-3.dll（FFT 库）。在我的笔记本电脑（64 位 Win7 终极版）上进行测试时，我发现了一个问题……我无法将此 VST 导入任何音乐工作室……

在我的 PC 上，我已经在 VstPlugins 目录中复制了 VST 插件 dll 和 libfftw3-3.dll，但是当我尝试导入此 VST 时，系统告诉我找不到 libfftw3-3.dll。

这不是 COM 对象，所以我无法使用 regsvr32 注册它...

你能帮我吗，我做错了什么？我怎样才能让它发挥作用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T00:39:19.520

VST 是一个 COM 组件。它由客户端程序加载，底层调用是 CoCreateInstance()。这里的问题是 Windows 只会在与您使用的 DLL 的客户端程序相关的目录中查找。您肯定没有将 DLL 复制到 EXE 的目录中，也不应该。

这是 COM 的一个普遍问题，干净利落地解决它并不容易。Windows 并排缓存是一种解决方案，但您将在解决之前就毕业了。您可以通过修改系统 PATH 环境变量来解决问题。或者绝望的举动，将 DLL 复制到 c:\windows\system32（在 64 位版本的 Windows 上为 syswow64）。只是为了让你毕业，请注意。

如果您仍然遇到问题，那么您可能还有其他不知道的依赖项。CRT dll 是一个典型的，当您使用/MD 编译代码时，您会得到它。您可以使用 SysInternals 的 ProcMon 实用程序追踪这些依赖项，您会看到客户端程序正在搜索 DLL。或 Profile 模式下的 DependencyWalker (F9)。

# html - Z-Index 现在允许链接

> ID：10183511
> 
> 赞同：0
> 
> 时间：2012-04-17T00:29:24.687
> 
> 标签：html, css

我正在建立一个带有横幅和页面顶部搜索栏的网站。按照设计，横幅的底部应该位于搜索栏的后面。我通过使用 z-indexes 做到了这一点（横幅为 0，搜索栏为 1）。我还希望横幅作为从网站上任何位置到主页的链接。

我的问题是，由于 z 索引，横幅是不可点击的。当我将横幅放在搜索栏前面时，横幅可点击且很好；但是当放在后面时，就好像标签“跟随”它并且现在无法使用。

有没有办法让我的横幅 z-index 为 0，我的链接 z-index 为 1，我的搜索栏 z-index 为 2？我尝试使用“style”参数将 z-index 分配给与图像分开的链接（ ），但它似乎不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T01:06:58.670

整个横幅是否需要可点击，或者只是搜索栏后面的区域？如果整个事情不需要，你总是可以在横幅的那部分添加一个透明层（尽管这不是我真正建议的东西，而且看起来像是一个黑客）。

据我了解，负 z-index 总是会导致无法点击的链接，但这似乎不是您的问题。您是否有机会发布一些源代码以便我们对其进行检查？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T14:39:01.053

我想到了。所有使用该`z-index`参数的元素也必须使用`position`CSS 中的参数定位。我的搜索栏没有`position`编辑。

来源：[http ://www.w3schools.com/jsref/prop_style_zindex.asp](http://www.w3schools.com/jsref/prop_style_zindex.asp)

# javascript - jquery如何将两个选择器组合到单个切换事件的第二个功能

> ID：10183513
> 
> 赞同：-1
> 
> 时间：2012-04-17T00:29:28.977
> 
> 标签：javascript, jquery

如果我有一个绑定到点击事件的常规切换功能

```
$('#work-content a').toggle(
    function() {
        // first click stuff
    }, function() {
        // second click stuff
    }
); 
```

但是，我还需要以`$(document).click`某种方式将事件绑定到第二个函数。我的逻辑可能是错误的，所以我确信需要一个新的解决方案。

功能是 1）在单击链接时执行某些操作，然后 2）在再次单击链接或单击`#work-content`div 外部时执行相反的操作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T00:38:22.577

切换功能用于隐藏/显示您的 div，不应用于维护事件的状态。只需为此使用另一个局部变量并定义两个函数来执行您的两个不同操作并将函数指针作为回调传递给您的事件侦听器。

因此：

```
var linkClicked=false;

function fun1(){}

function fun2(){}

$('#work-content a').click(
    function() {
        if(!linkClicked)
          fun1();
        else
          fun2();
    });
$("body").click(function(){
  if($(event.target).closest("#work-content")===null)  //to make sure clicking inside your div does not trigger its close
  {
    fun2();
  }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T00:34:41.763

只需提取匿名函数并为其命名：

```
var thatFunction = function () {
    ...
}

$('#work-content a').toggle(
    function() {
        // first click stuff
    },
    thatFunction);

$(document).click(thatFunction); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T22:12:47.087

```
linkClicked = false;    
$('#work-content .pic a').click(function(event) {
    event.preventDefault();

    var c = $(this);

    if (!linkClicked) {
        values = workOpen($(this));
    } else {
        workClose(c, values);
    }

    $('body').one('click',function() {
        workClose(c, values);
    });

}); 
```

这个解决方案正是我所需要的。

# php - MYSQL - 选择具有最低值和其他条件的行，或者具有最高值的回退

> ID：10183516
> 
> 赞同：2
> 
> 时间：2012-04-17T00:29:46.740
> 
> 标签：php, mysql, join, max

这里似乎有很多线程在问类似的问题，但我还没有找到可以帮助我解决问题的线程。

我正在尝试选择具有**最低**值的行，其中三个其他条件必须为真或回退到另一组条件，给定变量 ( `uc`) 并选择最高价格。

```
Table: level (sample data)
id  |price  |copies |used   |uc
--------------------------------------
1   |7      |10     |10     |charlie01
2   |17     |10     |8      |charlie01
3   |37     |5      |5      |charlie01
4   |47     |10     |9      |charlie01
7   |5      |15     |9      |charlie02
8   |15     |15     |0      |charlie02
9   |35     |15     |0      |charlie02
10  |45     |15     |0      |charlie02
11  |3      |5      |5      |charlie03
12  |13     |5      |5      |charlie03 
```

结果： **编辑结果 - charlie01 应该是 2**

```
VARIABLE    |RESULTING ROW
--------------------------
charlie01   |2
charlie02   |7
charlie03   |12 
```

**### 开始伪代码：###**

选择小于和大于等于或如果没有结果的**最低** `price`行（这意味着所有都等于） 选择等于和等于的价格最高的行`used``copies``used``0``uc``VARIABLE``used``copies``used``copies``uc``VARIABLE`

```
SELECT * 
FROM level
WHERE

    (
        used < copies
        AND used > 0
        AND uc = *VARIABLE*
    )
 ### OR IF NO RESULTS ###
    (
        used = copies
        AND uc = *VARIABLE*
    )

ORDER BY price ASC
LIMIT 1 
```

**###结束伪代码###**

这是我写的查询（`uc` `charlie01`用作示例）：

```
SELECT *
FROM (
    SELECT *
    FROM `level` 
    WHERE 
        ((
        `used` < `copies`
        AND `used` > '0'
        )
        OR
        (
        `used` = `copies`
        ))
        AND `uc` = 'charlie01'
        ORDER BY `price` ASC

        ) AS T
ORDER BY `used` ASC
LIMIT 1 
```

由于记录，它不适用于示例数据`3`，即使`used = copies`. 这是因为`used on record 3 < used on record 2 (the row we want, because it has the lowest price)`

我知道**MAX()**存在并在最后一个小时尝试使用它，但没有成功，我真的不认为我理解它是如何工作的，无论如何似乎只是选择了整个列的最大值...？

现在，我绕着圈子添加条件等，但我认为我需要做`JOIN`某种类型的，但我不确定从哪里开始。你认为我应该如何处理这个查询？

**编辑：我真的很抱歉，当我实际上试图选择最低价格时，我才意识到我说`used`的`copies`是最高价格`used``copies`**

干杯
查理

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T05:51:37.650

如果您正在使用此代码编写生产代码，我会等待更好的答案，但有几个有趣的选项可能对您有用......

```
SELECT * FROM (
  SELECT *, (used < copies and used > 0) AS copies_avail FROM level
  ORDER BY copies_avail desc, IF(copies_avail, price, -price) ASC
) AS x GROUP BY uc; 
```

（如果你想在 where 子句中指定一个 uc，你可以只使用内部部分）

更有趣的类似选项（尽量不说hackish = p）将是

```
SELECT * FROM (
  SELECT * FROM level 
  ORDER BY IF(used < copies AND used > 0, price, -price + 10000) ASC
) AS x GROUP BY uc; 
```

（其中 10000 远高于表中的任何预期价格）

无论如何...相信这两者的输出都与您编辑的结果相匹配，但在性能方面可能很糟糕。如果您在做这样的事情时遇到困难，您可能可以将copys_avail 查询结果存储在表中以避免文件排序？

此外，对 used = 0 且副本 > 0 的情况感到好奇 - 从您的描述中无法判断它是否应该使用 price asc 或 price desc 组进行排序。在这些示例中，它是价格降序。

# c# - 如何使用 WindowsForm + SqlServer 验证用户登录

> ID：10183519
> 
> 赞同：0
> 
> 时间：2012-04-17T00:29:57.427
> 
> 标签：c#, validation, stored-procedures, login, windows-forms-designer

我有像这样验证用户 ID 和密码的存储过程

```
PROCEDURE [dbo].[CheckLoginByUserIdAndPassword2]              

@UserId char(15),            
@Password char(40)        
AS                                      
BEGIN                                      
 -- SET NOCOUNT ON added to prevent extra result sets from                                      
 -- interfering with SELECT statements.                                      
 SET NOCOUNT ON;                
    select Name, UserPersonalId, UserId from MSUSERPERSONALINFO    
    where UserId = @UserId  and Password=@Password           
END 
```

但是，知道在我的 c#（windowsform 应用程序）中应该使用什么样的代码来访问这个存储过程并接收登录成功或失败的返回值吗？

我已经编写了调用该过程的代码，但我仍然无法设置返回值..

```
try
            {
                string sp_name = "dbo.CheckLoginByUserIdAndPassword2";

                SqlConnection SqlCon = new SqlConnection("Integrated Security=SSPI;Persist Security Info=False;Initial Catalog=jdwlrc_db;Data Source=.");
                SqlCon.Open();

                SqlCommand SqlCom = new SqlCommand(sp_name, SqlCon);

                SqlCom.CommandType = CommandType.StoredProcedure;

                SqlCom.Parameters.Add(new SqlParameter("@UserID",nama));
                SqlCom.Parameters.Add(new SqlParameter("@Password",password));

                SqlCom.ExecuteScalar();
                SqlCon.Close();

                return true;
            }

            catch
            {
                return false;
            } 
```

多谢..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T01:02:37.833

你可以做这样的事情。

修改存储过程如下

```
SELECT UserId FROM MSUSERPERSONALINFO WHERE UserId = @UserId AND Password=@Password 
```

在代码中

```
object result = sqlCom.ExecuteScalar();
if(result != null && int.Parse(result.ToString()) > 1)
{
//Authenticated successfully.
}
else
{
//Authentication failed 
} 
```

希望对您有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T01:17:59.483

我建议您创建一个单独的项目（一个类库）来完成所有数据库通信。那应该是我们的数据访问层。您的 Windows 应用程序应该是某种不直接连接到数据库的瘦客户端。然后在您的 windows 项目中，添加对我们创建的类库的引用。添加引用后，您应该能够从您的 UI 项目访问类库中的函数。

当使用输入用户名和密码并单击登录按钮时，您从文本框中读取值并通过传递相关数据（在本例中为用户名和密码）调用类库中的函数。得到回应并决定下一步做什么。

关于数据访问代码，我总是倾向于将我的代码包装在`using`语句中，这样我就不必担心我的连接是否仍然打开。

```
bool isValidUser=false;
try
{
 string sp_name = "dbo.CheckLoginByUserIdAndPassword2";
 using(SqlConnection SqlCon = new SqlConnection("Integrated Security=SSPI;Persist Security Info=False;Initial Catalog=jdwlrc_db;Data Source=."))
 {
   SqlCommand SqlCom = new SqlCommand(sp_name, SqlCon);
   SqlCom.CommandType = CommandType.StoredProcedure;
   SqlCom.Parameters.AddWithValue("@UserID", nama);
   SqlCom.Parameters.AddWithValue("@Password", password);
   SqlCon .Open();
   using(SQlDataReader objReader=SqlCom.ExecuteReader())
   {
      if(objReader.Read()
      {
         isValidUser=true;
         //You can read the values from reader if you want for future use like storing in session etc
      }
   }
   SqlCon.Close();
 }
}
catch(Exception ex)
{
   //Log error 
} 
```

# php - 这是使用 PHP 将数据插入数据库的正确方法吗？

> ID：10183526
> 
> 赞同：1
> 
> 时间：2012-04-17T00:30:15.513
> 
> 标签：php, mysql

我正在尝试使用以下代码将用户输入插入数据库。

```
mysql_query("INSERT INTO 'users' ('Email', 'Username', 'Password') VALUES ($email, $username, $password)"); 
```

没有错误，但数据库似乎永远不会插入代码。难道我做错了什么？

这是我的整个代码，HTML 和所有

```
<?php

    DEFINE ('SERVER', 'localhost');
    DEFINE ('PASSWORD', '');
    DEFINE ('USER', 'root');

    $email = $_POST['email'];
    $username = $_POST['username'];
    $password = SHA1($_POST['pass']);

    if(isset('submitted')
    {

    if($email && $username && $password)
    {
        $to = 'email@example.com'
        $subject = 'subject'
        $body = 'there was an error connecting to the db, please check it.'
        $dbconnect = @mysql_connect(SERVER, USER, PASSWORD) or die("NO WORK!");
        $query = "USE practice" 
        mysql_query($query);

        mysql_query("INSERT INTO users (Email, Username, Password)
             VALUES ('$email', '$username', '$password')") or die(mysql_erorr());
    }
    }

?>
<html>

<form action = "" method = "post">
<label>Email Address</label>
<input type="text" name="email" /> <br />
<label>Desired Username</label>
<input type="text" name="username" /> <br />
<label>Password</label>
<input type="password" name="pass" /> <br />
<input type="submit" value="Register"  />
<input type="hidden" name="submitted" value=1 />
</form>

</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T00:32:26.893

可能您还应该将值括在撇号中，并且您可能也不应将撇号用于表和字段名称，而应使用反引号 ` 或在您的情况下不使用！

```
mysql_query("INSERT INTO users (Email, Username, Password)
             VALUES ('$email', '$username', '$password')") 
```

但也要确保[正确转义这些变量的值](https://stackoverflow.com/a/7043398/684229)！不仅是因为 SQL 注入，而且主要是为了确保正确的 SQL 语法。想象一下名为 O'Brian 的用户 - 他会导致 SQL 错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T01:04:12.880

您可能会遇到一些错误，但可能是由于以下行导致 mysql_error as mysql_erorr 的拼写错误

```
 mysql_query("INSERT INTO users (Email, Username, Password)
             VALUES ('$email', '$username', '$password')") or die(mysql_erorr()); 
```

只需尝试修复它，看看您是否遇到一些数据库错误，以便轻松追踪和修复它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T01:08:53.490

在 mySQL 数据库中声明命名空间时也是如此。你应该像这样放反引号`。所以

```
 mysql_query("INSERT INTO users (`Email`, `Username`, `Password`)
         VALUES ('$email', '$username', '$password')") or die(mysql_erorr()); 
```

否则，您的代码看起来很可靠。

# c++ - 如何知道 C++ 中的内存使用情况

> ID：10183528
> 
> 赞同：6
> 
> 时间：2012-04-17T00:30:16.107
> 
> 标签：c++, memory, memory-management

我有一个由 Visual Studio 2010 运行的 C++ 程序，如何监控我的程序的内存使用情况？是否存在简单的 API，例如我可以调用`clock_t start1`并`start1 = clock();`监控我的程序的时间使用情况。谢谢：）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-17T00:40:58.993

内存管理不是像计时这样简单的问题，而且跟踪起来肯定更复杂。

我建议查看其他类似的 StackOverflow 帖子以开始：

[如何在 Visual Studio 2010 中分析程序的内存使用情况？](https://stackoverflow.com/questions/4213323/how-to-analyse-programs-memory-usage-in-visual-studio-2010)

[您如何检测/避免（非托管）代码中的内存泄漏？](https://stackoverflow.com/questions/45627/how-do-you-detect-avoid-memory-leaks-in-your-unmanaged-code)

[跟踪 C++ 内存分配](https://stackoverflow.com/questions/910172/track-c-memory-allocations)

这些应该可以帮助您解决与内存相关的任何特定问题，无论是寻找内存泄漏、覆盖已分配缓冲区的末尾，还是只是跟踪您分配了多少内存。

# .net - 使用 HtmlAgilityPack 时出现内存问题？

> ID：10183535
> 
> 赞同：7
> 
> 时间：2012-04-17T00:31:47.753
> 
> 标签：.net, memory-leaks, html-agility-pack

当我让我的应用程序运行很长时间时，我注意到内存问题。我实际上得到了一个内存不足的异常。我试图找出问题所在，但我一无所知，直到我让它再次运行并且我注意到

我每次都在这条线上漏水`html.LoadHtml(a_few_k_of_html);`。我怀疑 HtmlAgilityPack 正在泄漏。我尝试将它包装在使用和调用 dispose 中，但它不存在。它不仅每次都发生在该行，而且我记得更改了一些区域以使用 HtmlAgilityPack 而不是[使用正则表达式解析 html](https://stackoverflow.com/a/1732454/34537)

如果不修改 HtmlAgilityPack 本身，我该如何处理这个内存问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-17T14:26:40.627

我有同样的问题。处理完文档后，我将文档的实例设置为空，然后设置为 GC.Collect()。问题解决了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-04-16T13:02:18.360

尝试使用`HtmlAgilityPack.HtmlDocument` `Load()`insted of using 的方法`LoadHtml()`。

```
HtmlAgilityPack.HtmlDocument doc = new HtmlAgilityPack.HtmlDocument();
MemoryStream ms = new MemoryStream(Encoding.Default.GetBytes(a_few_k_of_html));
doc.Load(ms);
ms.Close();// <-- Important
//Do whatever you want with HtmlDocument 
```

# sockets - Pub Sub 实现零 mq 3.xx

> ID：10183539
> 
> 赞同：2
> 
> 时间：2012-04-17T00:32:13.693
> 
> 标签：sockets, network-programming, publish-subscribe, zeromq, messagebroker

我一直在使用 qpid，现在我正试图转向减少代理的消息传递系统，但我对 Pub Sub 模式中的网络流量感到非常困惑。我阅读了以下文档： [http](http://www.250bpm.com/pubsub#toc4) ://www.250bpm.com/pubsub#toc4 并且真的很困惑订阅转发实际上是如何完成的？

我认为零 mq 必须与底层网络拓扑无关，但似乎并非如此。每个节点如何知道要转发什么和不转发什么（例如：在 eth 网络中，可能有数百万订阅者和发布者，消息树对我来说听起来并不可行。那些甚至不知道零 mq 的存在，他们如何将数据包转发给连接到他们的订阅者，对他们来说这只是一个普通数据包，所以即使是同一个数据包，他们也只会转发多个数据包副本？我不是网络专家所以可能是我遗漏了一些关于消息树的明显内容以及它是如何创建的吗？您能否举一些示例案例，如何创建此分发树以及创建 xpub 和 xsub 套接字的确切节点？

设备（链接中使用的术语）是否类似于代理，在整篇文章中，设备似乎只是任何一般的中间跃点，它对零 mq 套接字（只是一个随机网络跃点）一无所知，如果它确实是经纪人之类的东西，这是否意味着对于 pub sub，消息树中的所有节点都必须满足作为设备的定义，因此它不是一个无故障的设计？

同样在树形图中（来自包含 P、D、C 的链接），我最初假设 C 和 C 是两个订阅者，而 P 是唯一的发布者（D 只是随机跳），但现在似乎我们将 D 作为零 mq 。C 订阅 D 并且 D 订阅 P 吗？或两者都 C 只订阅 P （更通用的是，每个节点是否仅在 中订阅其父节点）。很抱歉这个新手问题，但似乎我在这里遗漏了一些明显的东西，如果有人能提供更多见解，那就太好了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T15:27:26.683

zeromq 使用网络直接在节点之间建立连接（例如通过 tcp），但只在 1 个发送者和 1-n 个接收者之间建立连接。它们是“直接”连接的，并且可以使用底层协议交换消息。

现在，当您在 pub-sub 场景中仅订阅某些事件时，zeromq 用于过滤订阅方的消息，从而导致从发布者到至少多个订阅者的不必要的网络流量。

在较新版本的 zeromq（3.0 和 3.1）中，订阅者进程将其订阅列表发送给发布者，发布者管理订阅者列表和他们感兴趣的主题。因此，发布者可以丢弃任何订阅者也未订阅的消息，并且可能仅向感兴趣的订阅者发送有针对性的消息。

当发布者本身是事件的订阅者（例如转发或路由设备服务）时，它可能会通过类似地订阅其连接的发布者来再次转发这些订阅。

我不确定 zeromq 是否仍然在较新版本中进行客户端过滤，即使它“转发”其订阅也是如此。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T23:19:15.050

对多个订阅者发布/订阅的一种更有效的机制是使用多播，其中单个消息穿过网络并被所有订阅者接收（然后他们可以过滤他们想要的内容）。

ZeroMQ[支持](http://api.zeromq.org/2-1%3azmq-pgm)称为[实用通用多播的标准化可靠多播](http://en.wikipedia.org/wiki/Pragmatic_General_Multicast)。

这些参考资料应该让您了解它是如何工作的。请注意，多播通常仅适用于单个子 LAN，并且可能需要路由器配置或 TCP 桥接才能跨越多个子 LAN。

# c# - FileStreams 的奇怪行为

> ID：10183540
> 
> 赞同：1
> 
> 时间：2012-04-17T00:32:18.313
> 
> 标签：c#

我有一个我将要创建和写入的文件名列表。我有一个 foreach 循环遍历它们，就像这样

```
void WriteFiles(byte[] data)
{
    foreach (string fileName in fileNames)//fileNames is my List<string>
    {
        FileStream fs = File.Create(fileName)

        fs.Write(data, 0, data.Length);

        fs.Close();
    }
} 
```

假设我的文件列表是 1.txt、2.txt 和 3.txt 奇怪的是，1.txt、2.txt 和 3.txt 都被创建了。但是数据只是向1.txt写入了3次，而2.txt和3.txt都是空的。我在调试器中进行了双重检查，每次循环时文件名都不同。我编写了许多读取和写入文件的程序，但我从未遇到过这样的行为。我很困惑。

编辑

也许这会更有意义。这是我运行并产生问题的实际代码，直接从 Visual Studio 复制和粘贴。

```
using System;
using System.Collections.Generic;
using System.IO;

namespace ConsoleApplication1
{
   class Program
    {
        static List<string> fileNames = new List<string>();

        static void Main()
        {
            Directory.CreateDirectory("C:\\textfiles");
            fileNames.AddRange(new string[] { "1.txt", "2.txt", "3.txt" });
            WriteFiles();
        }

        static void WriteFiles()
        {
            foreach (string fileName in fileNames)
            {
                using (StreamWriter sw = new StreamWriter(File.Create("c:\\textfiles\\" + fileName)))
                {
                    sw.Write("This is my text");
                }
            }
        }
    }
} 
```

执行此操作后，我现在在文件夹 C:\textfiles 中有 3 个文本文件（1.txt、2.txt、3.txt），以前都不存在。

当我在记事本中打开文件时，这就是我所拥有的

1.txt - “这是我的文字这是我的文字这是我的文字”

2.txt - 没有

3.txt - 没有

怎么回事？？？这没有意义。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T02:30:47.273

您的代码在我的测试环境中完美运行，所以我不知道那里发生了什么。您要写入的实际文件是否在同一目录中？我的意思是，您的环境中的某些安全问题是否会干扰对文件 2 和 3 的写入？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T01:21:37.867

尝试使用“使用”：

```
using (FileStream fs = File.Create( filename ))
{
    fs.Write( data, 0, data.Length );
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T01:52:36.577

代码看起来不错（`using`而不是更好`.Close`）。

很可能是您的数据

*   完全为空（`data.length == 0`）
*   不代表可以显示的文本（如果您将 [0,0,0] 之类的内容写入文本文件，它将不显示任何内容。

# ruby-on-rails-3 - 不同字段的 Mongoid 相同的嵌入文档类型

> ID：10183544
> 
> 赞同：3
> 
> 时间：2012-04-17T00:33:08.540
> 
> 标签：ruby-on-rails-3, mongodb, mongoid

我正在尝试添加嵌入式文档。我知道这种语法是错误的，但它展示了我想要完成的事情。

```
class Email
  include Mongoid::Document

  embeds_many :recipients, as: :to
  embeds_many :recipients, as: :cc
  embeds_many :recipients, as: :bcc

  field :from, type: String
  field :subject, type: String
  field :body, type: String
end

class Recipient
  include Mongoid::Document
  field :email_address, type: String
  field :name, type: String
  validates :email_address, :presence => true
  embedded_in :emails
end 
```

下面的代码示例有效，但我试图避免代码重复。

```
class Email
  include Mongoid::Document

  embeds_many :to_recipients
  embeds_many :cc_recipients
  embeds_many :bcc_recipients

  field :from, type: String
  field :subject, type: String
  field :body, type: String
end

class ToRecipient
  include Mongoid::Document
  field :email_address, type: String
  field :name, type: String
  validates :email_address, :presence => true
  embedded_in :emails
end

class CcRecipient
  include Mongoid::Document
  field :email_address, type: String
  field :name, type: String
  validates :email_address, :presence => true
  embedded_in :emails
end

class BccRecipient
  include Mongoid::Document
  field :email_address, type: String
  field :name, type: String
  validates :email_address, :presence => true
  embedded_in :emails
end 
```

任何人都知道一个干净的方法来处理这个？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T18:23:13.133

这里是最佳答案！

```
class Email
  include Mongoid::Document

  embeds_many :to_recipients, :class_name => "Recipient"
  embeds_many :cc_recipients, :class_name => "Recipient"
  embeds_many :bcc_recipients, :class_name => "Recipient"    
  embeds_one :from, :class_name => "Recipient"

  field :subject, type: String
  field :body_text, type: String
  field :body_html, type: String
end

class Recipient
  include Mongoid::Document
  field :email_address, type: String
  field :name, type: String
  validates :email_address, :presence => true
  embedded_in :emails
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T15:00:02.270

我想这可能是最好的解决方案

```
class Email
  include Mongoid::Document

  embeds_many :to_recipients
  embeds_many :cc_recipients
  embeds_many :bcc_recipients

  field :from, type: String
  field :subject, type: String
  field :body_text, type: String
  field :body_html, type: String
end

class Recipient
  include Mongoid::Document
  field :email_address, type: String
  field :name, type: String
  validates :email_address, :presence => true
  embedded_in :emails
end

class ToRecipient < Recipient; end
class CcRecipient < Recipient; end
class BccRecipient < Recipient; end 
```

# mysql - SQL - 将插入的一个字段中的 LEFT 300 个字符复制到新字段

> ID：10183550
> 
> 赞同：1
> 
> 时间：2012-04-17T00:33:50.767
> 
> 标签：mysql, sql

我有一个大型 MySQL 照片表，即使有全文索引、普通索引和其他性能技巧，我发现我的查询变得有点慢（糟糕的 MySQL 全文）。

我有两个字段，一个称为“caption”，另一个称为“shortCaption”。“caption”字段包含 500,000 行数据，长度在 150 到 2000 个字符之间，新的“shortCaption”字段为空。

我的“标题”字段中的可搜索信息主要在前 300 个字符中，因此为了加快我的全文查询，我希望有一个仅包含前 300 个字符的“shortCaption”字段，从而减少我的数据库的工作量/询问。

有没有办法在一个查询中遍历每个照片记录，获取前 300 个字符（长度（字段，300））并用较短的版本更新新字段？我正要写一个小服务器端脚本来处理这个问题，但很好奇它是否可以纯粹用 SQL 来完成，因为它会更快。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T00:36:29.417

```
UPDATE tablename SET newfield = LEFT(oldfield, 300) 
```

此查询将更新中的所有行`tablename`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T00:37:17.820

可以尝试这样的事情：

```
UPDATE table
SET new_column = left(old_column, 300); 
```

我对我的一个测试表进行了测试，它起作用了。只要知道查询将需要一些时间来执行超过 500K 行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T00:42:31.267

```
UPDATE table1
SET column1 = LEFT( column2, 300 ) 
```

# vb.net - VB 日期和日期时间选择器

> ID：10183555
> 
> 赞同：0
> 
> 时间：2012-04-17T00:34:58.253
> 
> 标签：vb.net

我想知道如果 datetimepicker 日期距当前日期超过 2 周，创建 If 语句的正确方法是什么。

我在想一些事情

如果 (datetimepicker.value > DateTimeInterval.Day(14))

但我不确定正确的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T02:43:56.947

您需要从选择器日期中减去当前日期。要获得时间跨度：

```
 If DateTimePicker1.Value.Date - DateTime.Now.Date > TimeSpan.FromDays(14) Then
        '' It's more than 2 weeks
    End If 
```

# objective-c - 沙盒打开了，是否有更多的 Objective-C 方式来打开一个 com 端口？

> ID：10183558
> 
> 赞同：1
> 
> 时间：2012-04-17T00:35:14.417
> 
> 标签：objective-c, serial-port, appstore-sandbox

现在我得到了以下课程，但它不起作用。它在`open`通话中失败。我认为这是因为沙盒，但我不确定如何前进。这看起来也像 C 一样，有没有更好的 Objective-C (IOKIT?) 方法来解决这个问题？

设备本身是一个 USB 串行端口。

给出的错误：

> 打开设备失败：不允许操作

当前代码：

```
#include <termios.h>
#import "Com.h"

#define BAUDCOUNT 17
speed_t baud_const[BAUDCOUNT] = { B50,    B75,    B110,   B134,   B150,   B200,
                                  B300,   B600,   B1200,  B1800,  B2400,  B4800, 
                                  B9600,  B19200, B38400, B57600, B115200 };
unsigned long baud_value[BAUDCOUNT] = { 50,   75,    110,   134,   150,   200,
                                        300,  600,   1200,  1800,  2400,  4800, 
                                        9600, 19200, 38400, 57600, 115200 };

@interface Com()
@property (assign) int fd;
@property (assign) struct termios oldio;
@end

@implementation Com
@synthesize fd = _fd;
@synthesize oldio = _oldio;

- (id)init
{
    self = [super init];
    if (self)
    {
        self.fd = -1;
        return self;
    }
    return nil;
}

- (BOOL)open:(NSString*)device withBaud:(int)baud
{
    struct termios oldio;
    struct termios newtio;

    // Find the correct baud rate
    int baudid = -1;
    for(int i = 0; i < BAUDCOUNT; i++) {
        if (baud_value[i] == baud) {
            baudid = i;
            break;
        }
    }
    if(baudid == -1)
    {
        NSLog(@"Invlaid baud rate: %d", baud);
        return NO;
    }

    // Open the device
    self.fd = open([device UTF8String], O_RDWR | O_NOCTTY | O_NDELAY);
    if (self.fd < 0)
    {
        NSLog(@"Failed to open device: %s", strerror(errno));
        return NO;
    }

    // Save old settings
    tcgetattr(self.fd, &oldio);
    self.oldio = oldio;

    // Init memory
    memset(&newtio, 0x00 , sizeof(newtio));
    cfmakeraw(&newtio);

    // settings flags
    newtio.c_cflag |= CS8;
    newtio.c_cflag |= CLOCAL;
    newtio.c_cflag |= CREAD;
    newtio.c_iflag = IGNPAR | IGNBRK;
    newtio.c_oflag = 0;
    newtio.c_lflag = 0;

    // Timeout in 100ms
    newtio.c_cc[VTIME] = 0;
    // read 1 character
    newtio.c_cc[VMIN] = 0;

    // Setting baudrate
    cfsetispeed (&newtio, baud_const[baudid]);
    cfsetospeed (&newtio, baud_const[baudid]);

    // Flushing buffer
    tcflush(self.fd, TCIOFLUSH);

    // aplying new configuration
    tcsetattr(self.fd, TCSANOW, &newtio);

    return YES;
}
@end 
```

当前权利：

```
<key>com.apple.security.app-sandbox</key>
<true/>
<key>com.apple.security.device.usb</key>
<true/>
<key>com.apple.security.files.user-selected.read-write</key>
<true/> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T03:30:42.993

有几个用于处理串行端口的 Objective C 框架。

*   [AM串行端口](http://sourceforge.net/projects/amserial/)
*   [串行连接](http://code.google.com/p/serialconnect/)

**更新：**在我看来，您可能需要该`com.apple.security.device.serial`权利。尽管您使用的是 USB 串行适配器，但我相信操作系统设备驱动程序使所有串行端口看起来都相同，即不是 USB 设备。我怀疑`com.apple.security.device.usb`您所拥有的权利不适用于 USB 串行设备。

**更新 2：**我刚刚从去年 8 月发现了这个[Open Radar ，它报告了您的问题。](http://openradar.appspot.com/9993340)因此，该`com.apple.security.device.serial`权利似乎不起作用（或者肯定在 8 月没有起作用）。

**更新 3：**如果您确实需要直接访问 USB 设备（并假设这适用于`com.apple.security.device.usb`权利），那么您可能需要查看[http://opensource.apple.com/source/IOSerialFamily上提供的 IOSerialFamily 源代码/IOSerialFamily-59/](http://opensource.apple.com/source/IOSerialFamily/IOSerialFamily-59/)。

源码压缩包：http: [//opensource.apple.com/tarballs/IOSerialFamily/IOSerialFamily-59.tar.gz](http://opensource.apple.com/tarballs/IOSerialFamily/IOSerialFamily-59.tar.gz)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T05:38:09.487

您正在做一些内核编程，这可能是您想要做的，但如果您可以使用 IOKit，那么我建议您这样做。简而言之，我不建议您使用内核 + 沙盒进行任何操作。

IOKit 是另一种类型的动物，确实还不错。这是一个带有快速片段的示例，它将禁用系统睡眠。这演示了如何使用 IOKit，我相信它确实适用于沙盒应用程序。

```
 IOPMAssertionID assertionID;
    IOReturn err = IOPMAssertionCreateWithName(kIOPMAssertionTypeNoDisplaySleep, kIOPMAssertionLevelOn, CFSTR("Add Reason Here"), &assertionID);
    if ( err == kIOReturnSuccess ) {

        // Do stuff here while system is unable to sleep

        // Let the system resume ability to sleep
        err = IOPMAssertionRelease(assertionID);
    } 
```

该文档也应该有所帮助：[链接](https://developer.apple.com/library/mac/#documentation/DeviceDrivers/Conceptual/USBBook/USBDeviceInterfaces/USBDevInterfaces.html)

注意：“重要如果您的应用程序是沙盒的，它必须请求 com.apple.security.device.usb 授权才能访问 USB 设备。”

# ruby-on-rails - Rails - 使用 Omniauth 和 Koala 的 Facebook：如何更新过期的令牌

> ID：10183561
> 
> 赞同：8
> 
> 时间：2012-04-17T00:35:24.223
> 
> 标签：ruby-on-rails, facebook, omniauth, access-token, koala

我有一个应用程序，用户可以在其中链接他们的 Facebook 帐户。他们可以使用电子邮件登录，但可以链接他们的 Facebook 帐户。

在我显示链接的社交网络（Facebook 和其他）的视图中，我有这样的东西：

```
<%= image_tag @facebook.get_facebook_picture %> 
```

这将调用这样的实例方法：

```
def get_facebook_picture
    unless self.token.nil?
      facebook_graph = Koala::Facebook::GraphAPI.new(self.token)
      fb_picture = facebook_graph.get_picture("me", { :type => "small" })
    end
end 
```

除非我存储在我的数据库中的 Facebook 令牌已过期，否则这将运行良好。所以我在提到的控制器中添加了这个异常处理程序：

```
def facebook_exception_handler exception
    if exception.fb_error_type.eql? 'OAuthException'
      # Let's get a new auth token... How?
    else
      logger.debug "Damn it. We don't know what error is coming from FB"
      raise exception
    end
end 
```

我正确捕获了异常，但我看不到如何更新我在数据库中拥有的访问令牌。请注意，我已经使用 OmniAuth 插入了访问令牌。所以我的问题是：

鉴于我有**Omniauth**`OAuthException`，如何更新特定用户 (UID) 的访问令牌？

 *** * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-17T06:17:15.137

最简单的情况是您使用 FB 重新认证用户，就像您最初授权他们一样。首先要获得令牌，我假设您正在使用omniauth（和onmiauth-facebook）对FB进行身份验证。这意味着您有一个路由和一个控制器操作来处理身份验证回调，以及一个将令牌插入数据库的函数。

您最初使用 omniauth 获得的访问令牌可能会因各种原因而失效 - 到期，或者因为用户更改了他们的 FB 密码，可能还有其他原因。在这些情况下，另一个 OAuth 调用将返回一个有效的令牌。只需再次调用（就像您第一次授权用户时所做的那样）并在您的数据库中用新的令牌替换无效令牌，您就很好了。

[这个要点](https://gist.github.com/2394427)（[我自己](https://stackoverflow.com/questions/7668093/facebook-auth-for-a-rails-app-using-clearance/10165375#10165375)对我在这里提出的相关问题的回答）有一些代码涵盖了这一点，但听起来你已经涵盖了这一点。保存足够的状态，然后重新尝试触发异常的任何事情，你就很好了。

令牌现在也可能无效，因为用户已更改其 FB 应用程序设置以取消对您的应用程序的授权。在这种情况下，用户将看到 FB 权限对话框，就好像他们是第一次针对 FB 进行身份验证的新用户一样。（[脸书](https://developers.facebook.com/docs/authentication/access-token-expiration/)）

那有意义吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-01-24T04:56:40.877

您可以使用以下方法更改 RailsCasts koala 教程连接：

```
def facebook
  if self.facebook_expires_at < Time.now
    oauth = Koala::Facebook::OAuth.new(ENV["FACEBOOK_KEY"], ENV["FACEBOOK_SECRET"])
    new_access_info = oauth.exchange_access_token_info self.facebook_token

    new_access_token = new_access_info["access_token"]
    new_access_expires_at = DateTime.now + new_access_info["expires"].to_i.seconds

    self.update_attributes!(:facebook_token => new_access_token,
                            :facebook_expires_at => new_access_expires_at )
  end
  @facebook ||= Koala::Facebook::API.new(self.facebook_token)
  block_given? ? yield(@facebook) : @facebook

  rescue Koala::Facebook::APIError => e
    logger.info e.to_s
    nil
end 
```**

# asp.net-mvc-3 - MVC3中视图模型集合的部分刷新

> ID：10183567
> 
> 赞同：1
> 
> 时间：2012-04-17T00:36:33.280
> 
> 标签：asp.net-mvc-3

不太确定..但这对我来说真的很棘手..

我有一个 mvc 页面，其中 Customer 作为视图模型作为资源绑定到页面。在客户视图模型中，它具有`IList<Contact>`（联系人集合）。在页面中，用户可以更新他的详细信息和他的联系方式，还可以添加更多的联系方式。

在添加新的联系人详细信息时，如何进行部分加载，以便页面仅刷新联系人详细信息的集合而不刷新整个页面？另外，我如何重新绑定`IList<Contact>`到客户视图模型，以便当用户单击保存按钮时，所有数据都作为一个客户视图模型发送到控制器？

这是客户viewModel的定义：

```
public class CustomerViewModel
{
    public string FirstName { get; set; }
    public string LastName { get; set; }

    public IList<Contact> Contacts { get; set; }
}

public class Contact
{
    public string Address { get; set; }
    public string City { get; set; }

} 
```

页面定义：

```
 @model Models.CustomerViewModel

    @{
        Layout = "~/Views/Shared/_MemberLayout.cshtml";
    }

    foreach(var contact on Model.Contacts)
    {
        //population happens here
    }

   <a href="#" id="AddNewContact">Add New Contact</a> //this will pops up a new dialog to add new contact 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T06:01:24.157

您可能会发现[以下文章](http://blog.stevensanderson.com/2010/01/28/editing-a-variable-length-list-aspnet-mvc-2-style/)很有用。它展示了一种很好的技术，可用于从集合中动态添加/删除元素。

# apache-flex - 如何在 Actionscript 中使用回调

> ID：10183574
> 
> 赞同：0
> 
> 时间：2012-04-17T00:37:23.140
> 
> 标签：apache-flex, actionscript

所以假设我有以下代码：

```
public function first(text:String):String {
   _text = text;
   dispatchEvent(event);

   //Want this statement to return the value of _text
   //after handler has finished transforming text.
   return _text;
}

//handles the event
public function handler(event:Event):void {
   //does things, then changes the value of _text
   _text = "next text that first needs to return";
} 
```

我如何确保方法（first）在被（handler）转换后返回正确的_text值？

先感谢您！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T05:59:46.590

由于 ActionScript 是单线程语言并且事件处理程序不返回值，我假设如果 _text 在包范围内是变量，您的代码将可以工作。下一个代码意义不大，但如果你`first`从另一个类调用函数，它会很有用

```
package
{
    import flash.display.Sprite;
    import flash.events.Event;

    public class EventTest extends Sprite
    {
        public function EventTest()
        {
            addEventListener("sliceText", sliceHandler);

            //will be Some
            var newText:String = first("SomeText");
            trace(newText);
        }

        private var _text:String;

        public function first(text:String):String
        {
            _text = text;

            dispatchEvent(new Event("sliceText"));

            return _text;
        }

        protected function sliceHandler(event:Event):void
        {
            //let's slice text to be more valuable
            _text = _text.slice(0,4);
        }

    }
} 
```

# pdf - 如何解读“标记内容”运算符 MP、PD、BMC、BDC 和 EMC

> ID：10183575
> 
> 赞同：2
> 
> 时间：2012-04-17T00:37:26.523
> 
> 标签：pdf, pdfbox

我正在使用 PDFBox lib 来呈现 PDF 的内容。有一些限制（不支持 Type1 字体，不支持 CMYK 图像，不支持运算符 MP、PD、BMC、BDC 和 EMC）。

MP、PD、BMC、BDC、EMC这几个算子应该怎么理解？

更新：

```
operator: BDC args: [COSName{EmbeddedDocument}, COSName{MC1}]
operator: BDC args: [COSName{Document}, COSName{MC2}]
operator: gs args: [COSName{GS9}]
operator: cs args: [COSName{Pattern}]
operator: scn args: [COSName{P1}]
operator: re args: [COSInt{66}, COSFloat{570.302}, COSFloat{432.5}, COSFloat{23.278}]
operator: f args: [] // fill path
operator: k args: [COSInt{0}, COSInt{0}, COSInt{0}, COSInt{1}] // black color
operator: m args: [COSFloat{92.458}, COSFloat{559.601}] // move 
operator: l args: [COSFloat{93.769}, COSFloat{559.601}]
operator: l args: [COSFloat{94.699}, COSFloat{562.331}]
    ....
    ....
operator: l args: [COSFloat{88.003}, COSFloat{582.385}]
operator: l args: [COSFloat{92.467}, COSFloat{576.433}]
operator: l args: [COSFloat{88.196}, COSFloat{571.038}]
operator: f* args: []
operator: gs args: [COSName{GS10}]
operator: w args: [COSFloat{0.216}]
operator: M args: [COSFloat{2.613}]
operator: m args: [COSFloat{88.196}, COSFloat{571.038}]
operator: l args: [COSFloat{92.659}, COSFloat{571.038}] // add line to path
operator: l args: [COSFloat{94.624}, COSFloat{574.24}]
operator: l args: [COSFloat{96.545}, COSFloat{571.038}]
operator: l args: [COSFloat{102.076}, COSFloat{571.038}]
operator: l args: [COSFloat{97.507}, COSFloat{577.119}]
operator: l args: [COSFloat{101.649}, COSFloat{582.385}]
operator: l args: [COSFloat{97.186}, COSFloat{582.385}]
operator: l args: [COSFloat{95.328}, COSFloat{579.462}]
operator: l args: [COSFloat{93.513}, COSFloat{582.385}]
operator: l args: [COSFloat{88.003}, COSFloat{582.385}]
operator: l args: [COSFloat{92.467}, COSFloat{576.433}]
operator: l args: [COSFloat{88.196}, COSFloat{571.038}]
operator: h args: []
operator: S args: [] // stroke
operator: EMC args: []
operator: EMC args: [] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T11:58:43.993

你看过[PDF规范](http://www.adobe.com/content/dam/acom/en/devnet/pdf/pdfs/adobe_supplement_iso32000.pdf)吗？它定义了它们的用法以及它们可以使用的键（如 /ActualText）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T08:59:30.997

这些是与元数据相关的运算符，它们对渲染没有影响，除非它们与可选内容一起使用。如果它们的参数对您的应用程序具有任何逻辑意义，您可以解释它们，否则您可以忽略它们。

# jquery - JQuery 添加和删除斜线

> ID：10183579
> 
> 赞同：2
> 
> 时间：2012-04-17T00:38:01.673
> 
> 标签：jquery, hyperlink, slash

jQuery代码是

```
$(document).ready(function() {
  if (navigator.appVersion.indexOf("Win") != -1) {
   // Computers runs windows
    $("a[href$='.pdf']").each(function() {
        this.href = this.href.replace("Volumes", "KP01DS0194TG");
    });
  }
  if (navigator.appVersion.indexOf("Mac") != -1) {
    // computer is a Mac
    $("a[href$='.pdf']").each(function() {
        this.href = this.href.replace("KP01DS0194TG", "Volumes");
    });
  }
}); 
```

我需要它来删除窗户一侧的斜线，我该怎么做？

我的链接如下`href="file:///KP01DS0194TG/Quotes/Scanning/brother/Jobsheets/job no 12538.pdf">12538</a>`，对于带有卷的 mac 来说很好，但是我需要它作为 'file://KP01DS0194TG' 的 pc's ，我怎样才能删除那个斜线？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T00:51:15.287

如果您有如下链接：

```
<a href="file:///[somelink]">Click Here</a> 
```

并且您想删除一个斜线，请使用：

```
$('a').each(function() {
    var theLink = $(this).attr('href');// get href
    theLink = theLink.replace(/\/\/\//g,'//');// replace 3 slashes with 2
    $(this).attr('href', theLink);
}); 
```

# c - 三颗星：char* (*arr)[] 和 char*** arr（在 C 中）有什么区别？

> ID：10183581
> 
> 赞同：2
> 
> 时间：2012-04-17T00:38:13.347
> 
> 标签：c, arrays, pointers, syntax

基本上，我有一个 char* 数组，我想在这个函数中传递和修改，所以我传入一个指向 char* 数组的指针。也就是说，我想传递一个指向 char* arr[] 的指针。两者有什么区别？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-17T00:40:43.137

一如既往，[http](http://cdecl.org) ://cdecl.org是您的朋友：

*   [`char * (*arr)[]`](http://cdecl.ridiculousfish.com/?q=char+%2a+%28%2aarr%29%5B%5D)-“将 arr 声明为指向 char 指针数组的指针”
*   [`char *** arr`](http://cdecl.ridiculousfish.com/?q=char+%2a%2a%2a+arr)-“将 arr 声明为指向指向 char 的指针的指针”

这些不一样。首先，第一个是不完整类型（为了使用指向数组的指针，编译器需要知道数组大小）。

你的目标并不完全清楚。我猜你真正想做的就是修改你的数组中的底层数据`char *`。如果是这样，那么您只需将指针传递给第一个元素：

```
void my_func(char **pointers) { 
    pointers[3] = NULL;  // Modify an element in the array
}

char *array_of_pointers[10];

// The following two lines are equivalent
my_func(&array_of_pointers[0]);
my_func(array_of_pointers); 
```

如果你**真的**想传递一个指向数组的指针，那么这样的事情会起作用：

```
void my_func(char *(*ptr)[10]) {
    (*ptr)[3] = NULL;  // Modify an element in the array
}

char *array_of_pointers[10];

// Note how this is different to either of the calls in the first example
my_func(&array_of_pointers); 
```

有关数组和指针之间重要区别的更多信息，请参阅 C FAQ 的专用章节：http: [//c-faq.com/aryptr/index.html](http://c-faq.com/aryptr/index.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T00:56:10.867

如果您有一个具有`char *(*arr)[]`参数的函数，则需要使用地址运算符传入一个数组：

```
void afunc(char *(*arr)[]);

char *charptra, *charptrb, *charptrc;
char *arr[] = {charptra, charptrb, charptrc};

afunc(&arr); 
```

另一方面，您必须传递一个指向指针的指针，该指针指向一个指针：

```
void afunc(char ***);

char arr[] = "str";
char *arrptr = arr;
char **arrptrptr = &arrptr;
char ***arrptrptrptr = &arrptrptr;

afunc(arrptrptrptr); 
```

# ruby - ruby 中的 string.split(",", -1) 和 string.split(",",-4) 有什么区别？

> ID：10183582
> 
> 赞同：1
> 
> 时间：2012-04-17T00:38:14.710
> 
> 标签：ruby

String 类的方法状态的[ruby​​ 文档：](http://www.ruby-doc.org/core-1.9.3/String.html#method-i-split)`split`

> [如果限制为] 负数，则返回的字段数没有限制，并且不抑制尾随的空字段。

据我所知，以下任何一项都没有区别：

```
string="1,,2,3,,,4,,5,,6"

string.split(",", -1)
string.split(",", -4)
string.split(",", -1000000) 
```

它们都返回相同的值：`["1", "", "2", "3", "", "", "4", "", "5", "", "6"]`

只是想知道为什么可以以这种方式分配不同的负限制。

另外，如果我确实想删除尾随的空值（如空格）会发生什么？我知道我可以做到`string.strip.split(",",-1)`，但有没有办法不使用`strip`方法来做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T00:42:32.467

`string.split(",", -1)`根据您的测试和引用的文档，和之间似乎没有区别`string.split(",", -4)`。规范说没有区别，您在测试中没有发现任何区别。万岁。

但请注意，这`string.strip.split(..)`不会删除尾随的空值：

```
irb(main):003:0> string="1,,2,3,,,4,,5,,6,,,"
=> "1,,2,3,,,4,,5,,6,,,"
irb(main):004:0> string.split(",", -1)
=> ["1", "", "2", "3", "", "", "4", "", "5", "", "6", "", "", ""]
irb(main):005:0> string.strip.split(",", -1)
=> ["1", "", "2", "3", "", "", "4", "", "5", "", "6", "", "", ""] 
```

您必须选择另一种机制来去除空值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T00:41:44.773

Ruby 通常有不止一种方法来做同样的事情，甚至是语法。只需在您的代码中约定使用`-1`.

您是在问如何没有限制，但要进行空字段抑制？根据文档，您可以省略 limit 参数。

# ios - UITableViewCell 上的 UIPanGestureRecognizer 覆盖 UITableView 的滚动视图手势识别器

> ID：10183584
> 
> 赞同：20
> 
> 时间：2012-04-17T00:38:35.370
> 
> 标签：ios, cocoa-touch, uigesturerecognizer

我已经进行了子类化`UITableViewCell`，并在该类中应用了平移手势识别器：

```
UIPanGestureRecognizer *panning = [[UIPanGestureRecognizer alloc]initWithTarget:self action:@selector(handlePanning:)];
panning.minimumNumberOfTouches = 1;
panning.maximumNumberOfTouches = 1;
[self.contentView addGestureRecognizer:panning];
[panning release]; 
```

然后我实现了委托协议，该协议应该允许在表格视图中同时使用手势：

```
- (BOOL)gestureRecognizer:(UIGestureRecognizer *)gestureRecognizer shouldRecognizeSimultaneouslyWithGestureRecognizer:(UIGestureRecognizer *)otherGestureRecognizer {
    return YES;
} 
```

然后我在方法中放置一个日志，`handlePanning`以查看何时检测到它：

```
- (void)handlePanning:(UIPanGestureRecognizer *)sender {
    NSLog(@"PAN");
} 
```

我的问题是我无法垂直滚动表格视图中的单元格列表，`handlePanning`无论我平移哪个方向，都会调用它。

我想要的是`handlePanning`只在只有水平平移而不是垂直时才被调用。希望得到一些指导。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-17T00:45:05.590

您是否尝试过设置`pannings`委托属性？

```
panning.delegate = /* class name with the delegate method in it */; 
```

您还需要使该类符合 UIGestureRecognizerDelegate。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-17T00:46:21.160

子类化平移手势识别器并使其仅识别水平平移。有一个很棒的 WWDC 2010 视频，介绍了自定义手势识别器的问题。实际上有两个关于这个主题，请在[https://developer.apple.com/videos/archive/](https://developer.apple.com/videos/archive/)上查看它们：

*   使用手势识别器简化触摸事件处理
*   高级手势识别

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-20T07:45:03.397

在 tableview 上添加手势识别器。从中，您可以获得单元格对象。从那里您可以处理单元格功能。对于每个手势，都会有一个开始、更改和结束状态。因此，存储开始位置。

```
 CGPoint beginLocation = [gesture locationInView:tblView]; // touch begin state.

    CGPoint endLocation = [gesture locationInView:tblView]; // touch end state. 
```

利用这一点，可以得到IndexPath

```
 NSIndexPath *indexPath = [tblView indexPathForRowAtPoint:beginPoint]; 
```

从此索引路径中，您可以访问单元格。

```
 UITableViewCell *cell = [tableview cellForRowAtIndexPath : indexPath]; 
```

使用此 Cell 对象，您可以处理它。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2015-01-06T06:23:31.213

您是否尝试将反弹属性设置为 NO？

# ruby-on-rails - Rails 路由：从根路径“/”获取资源

> ID：10183585
> 
> 赞同：3
> 
> 时间：2012-04-17T00:38:39.457
> 
> 标签：ruby-on-rails, ruby-on-rails-3, routes

我有一个要路由到我的域根目录的查询资源。（所以张贴到“/”去`queries#create`行动，等等......）。

我的路线.rb：

```
root :to => "home#index"
resources :queries, :path => '' 
```

耙路线：

```
 root        /                                           home#index
        queries GET    /                                           queries#index
                POST   /                                           queries#create 
```

一切似乎都很好，但是当我尝试发布到“/”时，它会以某种方式被路由到“root_path”，即使我是通过`POST`. 因此，它不会创建新的 Query 项，而是重新加载主页。我在日志中得到这个：

```
Started POST "/" for 127.0.0.1 at 2012-04-16 20:34:58 -0400
Processing by HomeController#index as HTML 
```

知道我做错了什么吗？

# 编辑

当我移动`:root =>`到控制器的最底部时，当 I 时出现重定向循环`GET "/"`，这就是为什么我的 ':root' 定义不在底部的原因。

# 编辑

当我将 :root 定义替换为 时，它可以工作`get "/" => "home#index", :as => "root"`，但这对我来说太老套了。如何指定要在`root`定义中使用的 HTTP 动词？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-20T21:20:24.223

这有效：

`get "/" => "home#index", :as => "root"`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T00:46:53.353

您是在传递 :url => {:action = "create"} 还是 form_for 中的方法？

# jquery - Jquery淡出/淡入回调不起作用

> ID：10183591
> 
> 赞同：14
> 
> 时间：2012-04-17T00:39:15.890
> 
> 标签：jquery, callback, jquery-callback

我正在构建一个小脚本来为列表设置动画。这是我的html结构：

```
<ul>
   <li class="slider"> Item-1 </li>
   <li class="slider"> Item-2 </li>
   <li class="slider"> Item-3 </li>
   ...
   <li class="slider"> Item-13 </li>
   <li class="slider"> Item-14 </li>
   <li class="slider"> Item-15 </li>
</ul>

<button> Next </button> 
```

我一次只显示四个里，“下一步”按钮淡出显示的四个里，然后淡入接下来的四个。但是淡化是同时应用的。我尝试在第一次淡入淡出时使用回调函数，但我无法使其工作。

这是脚本：

```
$('li:gt(3)').css('display', 'none');

//Define the interval of li to display
var start = 0;
var end = 4;

//Get the ul length
var listlength = $("li").length;

$("button").click(function() { 

  // FadeOut the four displayed li 
  $('ul li').slice(start,end).fadeOut(500, function(){

        // Define the next interval of four li to show
        start = start+4;
        end = end+4;

        // Test to detect the end of list and reset next interval
        if( start > listlength ){
          start = 0;
          end = 4;
        }

        //Display the new interval
        $('ul li').slice(start,end).fadeIn(500);
  });    
}); 
```

有什么线索吗？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-04-17T01:32:30.197

问题是每个动画元素调用 .fadeOut() 回调一次，而不是最后一次。您可以修改您的代码以记录它被调用的次数，但更容易 - 假设至少 jQuery 1.6 - 是使用 .promise()，它将在所有相关动画完成后解决：

```
$(document).ready(function () {
    var $lis = $("li.slider"),
        start = 0;

    $lis.hide()
        .slice(start, start + 4)
        .show();

    $("button").click(function () {
        $lis.slice(start, start + 4)
            .fadeOut(500)
            .promise()
            .done(function () {
                start += 4;
                if (start > $lis.length) {
                    start = 0;
                }
                $lis.slice(start, start + 4).fadeIn();
            });
    });
}); 
```

演示：http: [//jsfiddle.net/w7Yuk](http://jsfiddle.net/w7Yuk)

我对您的代码进行了其他一些更改，例如，使用 li 元素缓存 jQuery 对象，并删除“end”变量。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-17T01:18:19.467

我创建了一个不错的[jsFiddle 小演示](http://jsfiddle.net/CodeMaverick/dV2zM/)，它修改了您所拥有的内容并为您提供了一个很好的平滑过渡：

## HTML：

给按钮一个“下一步”的 id，以便您可以专门针对它，以防页面上还有其他按钮。

```
<ul>
   <li class="slider"> Item-1 </li>
   <li class="slider"> Item-2 </li>
   <li class="slider"> Item-3 </li>
   <li class="slider"> Item-4 </li>
   <li class="slider"> Item-5 </li>
   <li class="slider"> Item-6 </li>
   <li class="slider"> Item-7 </li>
   <li class="slider"> Item-8 </li>
   <li class="slider"> Item-9 </li>
   <li class="slider"> Item-10 </li>
   <li class="slider"> Item-11 </li>
   <li class="slider"> Item-12 </li>
   <li class="slider"> Item-13 </li>
   <li class="slider"> Item-14 </li>
   <li class="slider"> Item-15 </li>
   <li class="slider"> Item-16 </li>
</ul>

<button id="next"> Next </button> 
```

## CSS：

从 display none 开始，这样我们就可以在加载时很好地淡入它们。

```
.slider { display: none; }
#next { display: none; } 
```

## jQuery：

我喜欢缓存元素，所以我开始这样做。然后我淡入前 4 个 LI 元素和下一个按钮。我使用推荐的处理程序[`.on()`](http://api.jquery.com/on/)来绑定下一个按钮的单击事件。在我们设置之后`start`，`end`我们调用[`.fadeOut()`](http://api.jquery.com/fadeOut/)下一个按钮和当前的 4 个 LI 元素。现在，你的回调很糟糕的原因是因为它们是你选择器中每个元素的回调（所以 4 次）。相反，我们需要使用[`.promise()`](http://api.jquery.com/promise/)等待它们全部完成，然后我们可以[`.fadeIn()`](http://api.jquery.com/fadeIn/)在下一个按钮和接下来的 4 个 LI 元素上调用该方法。只是一个旁注，我[`.stop(true,true)`](http://api.jquery.com/stop/)用来消除可能存在的任何动画排队。

```
var $list = $("ul li");
var $next = $("#next");
var start = 0;
var end = 4;

$next.fadeIn(500);
$list.slice(start,end).fadeIn(500);

$next.on("click", function() {

  start += 4;
  end += 4;

  if( start >= $list.length ){
    start = 0;
    end = 4;
  }

  $next.stop(true,true).fadeOut(500);
  $list.stop(true,true).fadeOut(500);

  $list.promise().done(function() {
    $list.slice(start,end).stop(true,true).fadeIn(500);
    $next.stop(true,true).fadeIn(500);
  });

}); 
```

# iphone - 半透明白色看起来是灰色 (OpenGL ES 2.0)

> ID：10183594
> 
> 赞同：2
> 
> 时间：2012-04-17T00:39:32.837
> 
> 标签：iphone, opengl-es-2.0, glkit

我正在使用 Ray Wenderlich 的 GLKit 教程。
我的游戏涉及气泡和里面的东西。为了
达到这个效果，我有气泡的背景
和另一个图像来创造光泽。

我希望它看起来像什么

![在此处输入图像描述](../Images/d2ecda790a4123cd05b68d4d221fad2a.png)

我的问题是当我这样做时，它看起来像
一个丑陋的灰色。我在这里有点茫然，所以
任何帮助将不胜感激。

它看起来像什么

![在此处输入图像描述](../Images/bd5f3c38b994f09cb368215d70bc4205.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T10:02:42.047

我弄清楚我刚刚改变了什么 glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);
到 glBlendFunc(GL_ONE, GL_ONE_MINUS_SRC_ALPHA);

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T00:58:40.023

疯狂的猜测：你需要通过向它们添加一些灰色来“增亮”你正在混合的颜色，即`outcol = incol + vec4(0.2,0.2,0.2,0)`在你的着色器中（或者在你的着色器之外，如果这样更方便的话）

# c# - 动态创建行和列

> ID：10183596
> 
> 赞同：0
> 
> 时间：2012-04-17T00:39:42.037
> 
> 标签：c#, wpf

对不起，如果这是一个菜鸟问题。我刚开始学习 WPF，所以希望你们不要介意。但是，是否可以通过 xaml 为每行动态创建两列，还是必须在后端代码（viewmodel、.cs）中完成？现在，通过与数据源绑定，我只有一长串项目。例如，datasource = "{binding path=House.Item}" ... Item 是一个集合，它在执行存储过程调用时存储标签和值。例如：标签=“颜色”，值=“白色”。

我目前有：

> 颜色 <-- 标签
> 
> 白色 < -- 文本块中的值
> 
> 窗口 <-- 标签
> 
> 乙烯基 < -- 文本块中的值 ...等

我希望每行的结果为 2 列（无法正确显示）：

> 颜色 | >>> 窗口
> 
> 白色 | >>> 文利
> 
> 门 | >>> 地下室
> 
> 木材 | >>> 完成

我想要实现这一点的原因是我可以消除水平滚动，以防项目变得非常长。任何意见将是有益的。非常感谢先进。

更新：

```
<ListBox.Resources>                                 
<DataTemplate DataType="{x:Type Models:HouseDetail}" >                                               
<Views:HouseView>           
</DataTemplate>
<ListBox.Resources> 
```

这几乎就是我的数据的生成方式，这再次给了我“从上到下”的流程，而我希望它显示“从左到右”。例如：1 2 3 <--（我想要的）而不是

1

2

3

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T02:58:19.043

如果要显示列表，则应查看 Listbox 控件。对于列表中的每个项目，您可以使用 ItemTemplate 描述您希望如何布置项目。有关使用 ItemTemplates 的更多信息，请参阅[ItemTemplate 文档](http://msdn.microsoft.com/en-us/library/system.windows.controls.itemscontrol.itemtemplate.aspx)。

有一个代表您的列表项的对象（例如 House 类）。创建列表项的 ObservableCollection 并将列表框绑定到 ObservableCollection。然后，在 XAML 中，描述每个 House 项目的布局以及您希望它的外观。像这样的东西应该工作：

代码

```
public class House 
{
     public string Color { get; set; }
     public string Material { get;set; }
     public string Window { get; set; }
}

public class ViewModel
{
    public ObservableCollection<House> Houses { get; set; }
} 
```

XAML：

```
 <!-- DataContext should be set to an instance of ViewModel -->
 <ListBox ItemsSource="{Binding Houses}">
     <ListBox.ItemTemplate>
         <DataTemplate>
             <StackPanel>
                 <!-- I am just using StackPanels here, but you can use any layout control you want to describe how you want each list item to look --> 
                 <StackPanel Orientation=Horizontal>
                     <TextBlock Text="House Color:"/>
                     <TextBlock Text="{Binding Path=Color}"/>
                 </StackPanel>
                 <StackPanel Orientation=Horizontal>
                     <TextBlock Text="House Material:"/>
                     <TextBlock Text="{Binding Path=Material}"/>
                 </StackPanel>
                 <!-- Add more controls to show more information -->
             </StackPanel>
         </DataTemplate>
     </ListBox.ItemTemplate>
 </ListBox> 
```

抱歉，我手边没有编译器，所以我不确定这是否会编译，但它应该很接近。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T01:48:16.663

我不确定我是否正确理解了这个问题，但我认为 stackpanel 可能是您正在寻找的。

在控件的每一行中，您都可以拥有一个包含 2 个文本块的堆栈面板。然后您可以直接将每个值绑定到文本块。

# asp.net - 谷歌在 asp.net 4 页面中映射 api v3

> ID：10183599
> 
> 赞同：0
> 
> 时间：2012-04-17T00:40:09.473
> 
> 标签：asp.net, google-maps-api-3

以下是我的一个网页的 asp.net 代码。智能感知没有接收任何 google api 命令。即，新 google.maps 中的 google ......是波浪线，地图不显示在页面上。是的，我设置了宽度和高度。我哪里错了？

```
 <asp:Content ID="Content1" ContentPlaceHolderID="MidPageContent" runat="server" onload="initialize">
<script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?key=AIzaSyCjtIboyk_zcd4SoE9fzNoGNzt_tIqG8jY&sensor=false">
    </script>
<script type="text/javascript">

    function initialize() {
        var latLng = new google.maps.LatLng(-34.397, 150.644);
        var map = new google.maps.Map(document.getElementById('GMap'), {
            zoom: 8,
            center: latLng,
            mapTypeId: google.maps.MapTypeId.ROADMAP
        });
        var marker = new google.maps.Marker({
            position: latLng,
            title: 'Point A',
            map: map,
            draggable: true
        });
        </script>

<div id="GMap" style="width:400px; height:400px;" > 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T00:52:01.410

对宽度感到抱歉，现在这是另一个简单的问题，您是`initialize()`通过电话`<body onload`还是

`google.maps.event.addDomListener(window, 'load', initialize);`

# php - 在 div 中的 php 中“回显”图像失败

> ID：10183601
> 
> 赞同：-3
> 
> 时间：2012-04-17T00:40:24.323
> 
> 标签：php, mysql

从 MySQL 服务器中选择 jpg 图像后，当我尝试在单独的分区中回显它时，当我使用它时，它会显示为一堆 ascii 字符：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="image/jpeg; charset=UTF-8" />
<title>Untitled Document</title>
</head>
<body>

<div id = "myDiv">
<h2>Div</h2>
<?php
  require_once('appvars.php');
  require_once('connectvars.php');
  $dbc = mysqli_connect(DB_HOST, DB_USER, DB_PASSWORD, DB_NAME);
  $id = 1;
  $query = "SELECT image FROM images WHERE id=?";
  $stmt = $dbc->prepare($query);
  $stmt->bind_param("i",$id);
  $stmt->execute();
  $stmt->store_result();
  $stmt->bind_result($image);
  $stmt->fetch();
  echo $image;
 ?>
</div>
</body>
</html> 
```

在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T00:43:31.077

呃……那么……你是在发送 HTML 还是图像？你不能同时发送！

（嗯，你可以通过`data:`URL，但在旧版 IE 上不太支持）

从表面上看，您使用 HTML 的唯一原因是设置内容类型标头。在这种情况下，您只需要 PHP：

```
header("Content-Type: image/jpeg"); 
```

如果您真的想将图像嵌入 HTML，请尝试：

```
echo "<img src=\"data:image/jpeg;base64,".base64_encode($image)."\" />"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T00:43:03.717

浏览器不理解它是您正在回显的“div”中的图像。您必须将这个 PHP 脚本分开并使用`<div><img src="/path/to/script.php"></div>`. 这将告诉浏览器内容是图像。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T00:45:33.513

你在这里混得很安静。首先，您有一个内容描述符错误的 HTML 文档。其次，您不能只将原始图像数据发送到 HTML 文档。- 您之前需要对其进行 base64 编码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-17T00:47:24.170

首先，我不能说我建议您将图像或其他大型二进制文件存储在数据库中 - 您最好将它们存储在文件系统中并将它们的路径存储在数据库中。

其次，您不能只将图像数据脱口而出到页面中间。您需要使用 HTML`<img>`标记。正如 Kolink 上面所说，您可以将图像嵌入 HTML，但我不建议这样做，因为这意味着它永远不会被缓存。让服务器在不同的 URL 上提供图像，并将其嵌入到页面中`<img src="path/to/image" alt="Alternate text here" />`

# perl - LVM 配置文件是什么格式的？

> ID：10183608
> 
> 赞同：1
> 
> 时间：2012-04-17T00:41:08.760
> 
> 标签：perl, lvm

所以这是我要解析的配置文件的一个片段（它是一个 LVM2 配置）：

```
VolGroup00 {
    id = "vyllep-rfI6-LCvO-h6mN-zYZu-hiAN-QShmG6"
        seqno = 3
        status = ["RESIZEABLE", "READ", "WRITE"]
        flags = []
        extent_size = 65536             # 32 Megabytes
        max_lv = 0
        max_pv = 0
        metadata_copies = 0

        physical_volumes {

                pv0 {
                        id = "1yLiSl-x0fp-ZkyU-HMQl-eTVt-xiId-cFnih0"
                        device = "/dev/xvda2"   # Hint only

                        status = ["ALLOCATABLE"]
                        flags = []
                        dev_size = 31246425     # 14.8995 Gigabytes
                        pe_start = 384
                        pe_count = 476  # 14.875 Gigabytes
                }
        }
} 
```

我想将其解析为 Perl 数据结构。这个配置是什么格式的？我的*猜测*是它看起来像一个 python 数据结构。

任何想法的格式，或者更好的是，一个现有的模块来解析它？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-17T00:53:26.153

该配置使用专门用于 LVM 的自定义配置语言。lvm 用户空间工具包括解析这种语言的代码。

您可以获取[lvm2 的用户空间代码](ftp://sources.redhat.com/pub/lvm2/)并尝试复制其解析器，可能使用[Parse::RecDescent](http://search.cpan.org/perldoc?Parse::RecDescent)。

或者也许[CPAN 中的 Perl Linux::LVM 模块](http://search.cpan.org/perldoc?Linux::LVM)提供了提取所需信息的功能。

# c++ - 继承对象列表 - C++

> ID：10183609
> 
> 赞同：0
> 
> 时间：2012-04-17T00:41:10.703
> 
> 标签：c++, polymorphism

在我的程序中，我有一个带有许多继承类的基类。我需要存储这些继承对象（或任何容器）的列表。我能想到的唯一方法是拥有一个带有某种类型枚举的基类列表，然后向下转换为继承的类型。

仅仅试图将我的对象放在某个容器中，不得不不断地投射我的对象似乎是一种沉重的惩罚。

还有其他选择吗？选角并没有看起来那么糟糕吗？

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-17T01:01:56.017

通过虚函数使用多态性，这就是它们的用途：

```
#include <algorithm>
#include <functional>
#include <iostream>
#include <list>

using namespace std;

class A {
public:
  virtual void print() {
    cout << "This is an A object" << endl;
  }
};

class B : public A {
public:
  virtual void print() {
    cout << "This is a B object" << endl;
  }
};

class C : public A {
public:
  virtual void print() {
    cout << "This is a C object" << endl;
  }
};

class D : public B {
  // empty
};

int main() {
  std::list<A*> objects;
  objects.push_back(new A());
  objects.push_back(new B());
  objects.push_back(new C());
  objects.push_back(new D());

  for_each(objects.begin(), objects.end(), mem_fun(&A::print));

  return 0;
}

// outputs:
// This is an A object
// This is a B object
// This is a C object
// This is a B object 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T00:47:52.017

没有直接支持的方式以编程方式获取基类的所有子类的列表。

您可以在代码中通过调用某个函数来注册每个子类来“宣布”自己，并让该函数接受/存储所需的数据。

但是，如果您不断地将对象从基类转换为派生类，那么您可能没有充分利用多态性。

# java - 使用 int 代替字符串：public static void main (int[] args)

> ID：10183611
> 
> 赞同：5
> 
> 时间：2012-04-17T00:41:38.280
> 
> 标签：java, command-line, cmd, arguments, main

我的印象是 main 方法必须具有“public static void main (String[] args){}”的形式，你不能传递 int[] 参数。

但是，在 Windows 命令行中，当运行以下 .class 文件时，它接受 int 和 string 作为参数。

例如，使用此命令将给出输出“stringers”：“java IntArgsTest stringers”

我的问题是，为什么？为什么这段代码会接受一个字符串作为参数而没有错误？

这是我的代码。

```
public class IntArgsTest 
{
    public static void main (int[] args)
    {

        IntArgsTest iat = new IntArgsTest(args);

    }

    public IntArgsTest(int[] n){ System.out.println(n[0]);};

} 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-04-17T00:49:04.153

传递给 main 方法的所有东西，JVM 用来启动程序的方法，都是一个字符串，所有东西。它可能看起来像 int 1，但它实际上是字符串“1”，这是一个很大的不同。

现在有了您的代码，如果您尝试运行它会发生什么？当然它可以编译得很好，因为它是有效的 Java，但是你的 main 方法签名与 JVM 要求的作为程序起点的签名不匹配。

为了让您的代码运行，您需要添加一个有效的 main 方法，例如，

```
public class IntArgsTest {
   public static void main(int[] args) {

      IntArgsTest iat = new IntArgsTest(args);

   }

   public IntArgsTest(int[] n) {
      System.out.println(n[0]);
   };

   public static void main(String[] args) {
      int[] intArgs = new int[args.length];

      for (int i : intArgs) {
         try {
            intArgs[i] = Integer.parseInt(args[i]);
         } catch (NumberFormatException e) {
            System.err.println("Failed trying to parse a non-numeric argument, " + args[i]);
         }
      }
      main(intArgs);
   }
} 
```

然后在调用程序时传入一些数字。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T00:51:07.020

好吧，您可以使用任何名称`main`和任意数量的参数的方法。但是 JVM 会寻找`main`具有确切签名的方法`public static void main(String[])`。

您定义的`main`方法只是该类的另一种方法。

我现在无法访问 Windows，但让我过会儿试试。我确实尝试过 Fedora，当然我得到了以下异常：

```
Exception in thread "main" java.lang.NoSuchMethodError: main 
```

请注意，由于上述原因，该类可以正常编译。

**更新：**我在 Windows 7 上测试过，结果是一样的。我很惊讶你说它对你有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T00:50:50.487

此代码实际上不会运行。当代码编译时（因为你不需要 main 来编译），当你尝试运行它时，你会得到一个`"Main method not found"`错误。

更好的是，当我运行它时，它说

```
 "please define the main method as: public static void main(String[] args) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-07-01T10:31:03.197

此代码包含不起作用的**public static void main (int[] args) 。**因为 JVM 将参数值作为**字符串**参数。它不需要任何 int 参数。因此，如果我们想要一个 int 参数意味着我们必须将字符串参数转换为整数参数。要运行此代码，需要**有效的 main 方法**（例如：**public static void main(String args[])**）

# sql - 在 nvarchar 列中查找两个或多个相似字符

> ID：10183612
> 
> 赞同：1
> 
> 时间：2012-04-17T00:41:41.900
> 
> 标签：sql, sql-server, database, tsql

在 T-SQL 中，如何检查一个字符串是否包含两个或多个相似字符？

我的列包含 nvarchar 的手机号码，可能是“5512111445”、“6612888445”或隐藏号码，如“5512zzz44x”

我有一个用户输入的搜索模式，它可能是“xx12yyy4zx”，我想将所有匹配的数字返回到这个模式，其中 x、y、z 代表任何数字，但如果它重复，它将代表相同的数字。例如，前面的模式应该返回上面列出的所有数字。

xx 是类似的数字，如 55 或 66.. 而 xy 是不同的数字，如 45 或 67..

如何才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T05:30:10.340

您可以将掩码和数字中的每个字符旋转到列中，然后单独对掩码进行分组，然后是掩码 + 编号。在此方法中，5512111445 和 6612888445 与掩码 xx12yyy4yz 不匹配，因为掩码中的 y 未映射到唯一数字。但是，手机号码 5512111415 和 6612888485 匹配掩码 xx12yyy4yz，手机号码 5512zzz44x 也是如此。

```
--declare @mobileNums varchar(10)='5512111445'; --no match because @mask y maps to different values
--declare @mobileNums varchar(10)='6612888445'; --no match because @mask y maps to different values
--declare @mobileNums varchar(10)='5512111415'; --no match because @mask x should not equal @mask z
--declare @mobileNums varchar(10)='6612888485'; --matches
--declare @mobileNums varchar(10)='8812888485'; --no match because @mask x should not equal @mask y
--declare @mobileNums varchar(10)='5512zzz44x'; --matches because z and x are both hidden and different
--declare @mask varchar(10)='xx12yyy4yz';

declare @mobileNums varchar(10)='3211zyy'; -- no match because @mask y <> @mask z, but @mobileNums y = y
declare @mask varchar(10)='3211yxz';

declare @t table(n char, m char);
declare @i int=1;

while @i<=LEN(@mobileNums) begin
    insert into @t values (SUBSTRING(@mobileNums,@i,1), SUBSTRING(@mask,@i,1));
    set @i+=1;
end

if exists(
    -----------------------------------------------------------------------------
    -- Group by m
    select
    m, c=count(m)
    from @t
    where ISNUMERIC(n)=0 and ISNUMERIC(m)=0
    group by m
    except
    select
    m, c=count(m+n)
    from @t
    where ISNUMERIC(n)=0 and ISNUMERIC(m)=0
    group by m,n

    union

    select
    m, c=count(m)
    from @t
    where ISNUMERIC(n)=0 and ISNUMERIC(m)=1
    group by m
    except
    select
    m, c=count(m+n)
    from @t
    where ISNUMERIC(n)=0 and ISNUMERIC(m)=1
    group by m,n

    union

    select
    m, c=count(m)
    from @t
    where ISNUMERIC(n)=1 and ISNUMERIC(m)=0
    group by m
    except
    select
    m, c=count(m+n)
    from @t
    where ISNUMERIC(n)=1 and ISNUMERIC(m)=0
    group by m,n

    union

    select
    m, c=count(m)
    from @t
    where ISNUMERIC(n)=1 and ISNUMERIC(m)=1
    group by m
    except
    select
    m, c=count(m+n)
    from @t
    where ISNUMERIC(n)=1 and ISNUMERIC(m)=1
    group by m,n

    union

    -----------------------------------------------------------------------------
    -- Group by n

    -- Add a rule that no numeric @mobileNums digit can correspond to more than one alpha @mask character
    select
    n, c=count(m)
    from @t
    where ISNUMERIC(n)=1 and ISNUMERIC(m)=0
    group by n
    except
    select
    n, c=count(m+n)
    from @t
    where ISNUMERIC(n)=1 and ISNUMERIC(m)=0
    group by m,n 

    union

    -- For GROUP BY n, include the three remaining combinations of ISNUMERIC(n) and ISNUMERIC(m)
    select
    n, c=count(m)
    from @t
    where ISNUMERIC(n)=0 and ISNUMERIC(m)=0
    group by n
    except
    select
    n, c=count(m+n)
    from @t
    where ISNUMERIC(n)=0 and ISNUMERIC(m)=0
    group by m,n    

    union

    select
    n, c=count(m)
    from @t
    where ISNUMERIC(n)=0 and ISNUMERIC(m)=1
    group by n
    except
    select
    n, c=count(m+n)
    from @t
    where ISNUMERIC(n)=0 and ISNUMERIC(m)=1
    group by m,n 

)
select patMatch='False'
else 
select patMatch='True'; 
```

**编辑**- 添加一个规则，没有数字 @mobileNums 数字可以对应多个字母 @mask 字符

**编辑**- 对于`GROUP BY n`，包括 ISNUMERIC(n) 和 ISNUMERIC(m) 的其余三个组合

**编辑**- 删除第八个`UNION`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T01:09:06.727

我不会编写整个代码，因为它会很乏味，但我认为这可以让你开始。

1.  将搜索模式转换为类似模式，将所有字母字符替换为下划线。这减少了您必须搜索的行数，但仍然可以让您筛选很多。
2.  对于模式中的每个字符，过滤与模式匹配的行。“5512zzz44x”的示例：
    1.  以“z”开头：
        *   “5512zzz44x”->“5512zzz44_”
        *   要么循环遍历结果，每次通过过滤掉行，要么生成动态 SQL，然后在创建整个事物后执行：
        *   “5512zzz44_”->`... mobile_num like '551200044_' or mobile_num like '551211144_' ... or mobile_num_like '551299944_'`
    2.  下一个字符：'x'：
        *   “5512zzz44x”->“5512___44x”
        *   （按照上面 2.1 的模式）

这个想法是逐步过滤掉结果，直到只剩下与原始模式匹配的#。

可能有更有效的方法来做到这一点。如果部署 CLR 是一种选择，那么使用 CLR 和正则表达式执行此操作可能是一个更好的主意。

# javascript - 无法在 javascript for 循环中读取 null 的属性“长度”

> ID：10183614
> 
> 赞同：3
> 
> 时间：2012-04-17T00:41:46.560
> 
> 标签：javascript, jquery, null

我正在尝试制作一个像 Stack Overflow 一样的降价编辑器。

如果我实际上没有在文本区域中键入星号和包含 http:// 的短语，则会在标题中列出此错误。如果我只键入一个包含星号的短语，则错误指的是这一行：`if(linkify.length!==0)`

这是一个[jsfiddle](http://jsfiddle.net/trpeters1/2LAL4/47/)向您展示我的意思。

这是我的 HTML：

```
<textarea></textarea>
<div></div><button type="button">Markdownify</button> 
```

这是我的 JS：

```
var val=$('textarea').val(), boldify = val.match(/\*\*[A-Za-z0-9]+\*\*/gim),
italicify = val.match(/\*[A-Za-z0-9]+\*/gim),linkify = val.match(/http\:\/\/[A-z0-9]+\.[A-z0-9]+/gim);

$(document.body).on('click', 'button', function() {

val=$('textarea').val(), boldify = val.match(/\*\*[A-Za-z0-9]+\*\*/gim),
italicify = val.match(/\*[A-Za-z0-9]+\*/gim),linkify = val.match(/http\:\/\/[A-z0-9]+\.[A-z0-9]+/gim);

if (boldify.length!== 0){
            for (var i=0; i < boldify.length; i++)  {
                var boldMatch= boldify[i],  
                boldReplace = boldMatch.replace(/\*\*[A-z0-9]+\*\*/gim, '<span style="font-weight:bold;color:blue;">'+boldMatch+'</span>'),
                val = val.replace(boldMatch, boldReplace);     
            }
        val = val.replace(/\*\*/gi, "");
}

if(italicify.length!== 0){
    for(var j=0; j < italicify.length; j++){
    var italicMatch= italicify[j],
     italicReplace = italicMatch.replace(/\*[A-z0-9]+\*/gim, '<span style="font-style:italic;color:red;">'+italicMatch+'</span>');
    val = val.replace(italicMatch, italicReplace); 
    }
    val = val.replace(/\*/gi, "");
}

if(linkify.length!== 0){
    for(var k=0; k < linkify.length; k++){
    var linkMatch= linkify[k],
    linkReplace = linkMatch.replace(/http:\/\/[A-z0-9]+\.[A-z0-9]+/gim, '<a href="'+linkMatch+'">'+linkMatch+'</a>');
        val = val.replace(linkMatch, linkReplace);
    }
}

$('div').html(val);
}); 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-17T00:46:06.303

`match`如果字符串与提供的正则表达式不匹配，则不要使用返回 null 的函数，而是使用`test`返回 true/false 的函数，然后如果需要，可以使用该`match`函数。

基本上你正在执行`null.length`这显然是无效的，因为`match`它返回你一个 null

或者您可以在`null`检查长度之前执行检查，然后只进行一次正则表达式匹配。

```
if(linkify!==null && linkify.length!== 0)
{
  //do smthing
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-17T00:46:07.030

当文本中没有“http://”匹配时，“linkify”为空，因此您需要测试该条件：

```
if(linkify && linkify.length) 
```

# asterisk - 需要与国外IVR交互

> ID：10183616
> 
> 赞同：1
> 
> 时间：2012-04-17T00:42:20.750
> 
> 标签：asterisk, asteriskami

我需要以编程方式与外国 IVR 进行交互。

我遇到的问题是，一旦进入国外 IVR，如果国外 IVR 的后端被捆绑，我偶尔会收到一个特定功能的忙信号。

据我所知，如果不使用 EAGI 并在 Perl 中编写自定义 DSP，我真的无能为力，对吧？Dial() 应用程序会认为它成功了，因为它确实成功了（在初始呼出拨号上）。

即使最初的 Dial() 成功，我也一直在思考如何检查*当前是否收到忙信号。*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T16:06:44.700

您可以使用 AMI 接口控制拨号后的呼叫流程。

您还可以使用 audiohooks（在 c/c++ 中）创建应用程序以在后台执行任何操作。

使用 perl 的唯一方法 get voice 是 EAGI 或 JACK。

# c# - 如何判断一个 Type 是否属于 RunTimeType？

> ID：10183619
> 
> 赞同：5
> 
> 时间：2012-04-17T00:42:36.793
> 
> 标签：c#

如何确定 Type 是否属于 RunTimeType 类型？我有这个工作，但它有点笨拙：

```
 private bool IsTypeOfType(Type type)
    {
        return type.FullName ==  "System.RuntimeType";
    } 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-17T00:51:00.583

我猜您实际上想知道一个`Type`对象是否描述了`Type`该类，但是该`Type`对象是`typeof(RuntimeType)`不是`typeof(Type)`，因此将其与它进行比较`typeof(Type)`失败。

您可以做的是检查`Type`对象描述的类型的实例是否可以分配给 type 的变量`Type`。这给出了预期的结果，因为`RuntimeType`源自`Type`：

```
private bool IsTypeOfType(Type type)
{
    return typeof(Type).IsAssignableFrom(type);
} 
```

* * *

如果确实需要知道`Type`描述`Type`类的对象，可以使用GetType方法：

```
private bool IsRuntimeType(Type type)
{
    return type == typeof(Type).GetType();
} 
```

但是，因为`typeof(Type) != typeof(Type).GetType()`，您应该避免这种情况。

* * *

*例子：*

```
IsTypeOfType(typeof(Type))                          // true
IsTypeOfType(typeof(Type).GetType())                // true
IsTypeOfType(typeof(string))                        // false
IsTypeOfType(typeof(int))                           // false

IsRuntimeType(typeof(Type))                         // false
IsRuntimeType(typeof(Type).GetType())               // true
IsRuntimeType(typeof(string))                       // false
IsRuntimeType(typeof(int))                          // false 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-11-25T12:05:00.163

真的，唯一的麻烦是`System.RuntimeType`，`internal`所以做一些简单的事情，比如：

```
 if (obj is System.RuntimeType) 
```

不编译：

> CS0122 'RuntimeType' 由于其保护级别而无法访问。

所以上面@dtb 的解决方案是正确的。扩展他们的答案：

```
void Main()
{
    object obj = "";
    // obj = new {}; // also works

    // This works
    IsRuntimeType(obj.GetType()); // Rightly prints "it's a System.Type"
    IsRuntimeType(obj.GetType().GetType()); // Rightly prints "it's a System.RuntimeType"

    // This proves that @Hopeless' comment to the accepted answer from @dtb does not work
    IsWhatSystemType(obj.GetType()); // Should return "is a Type", but doesn't
    IsWhatSystemType(obj.GetType().GetType());
}

// This works
void IsRuntimeType(object obj)
{
    if (obj == typeof(Type).GetType())
        // Can't do `obj is System.RuntimeType` -- inaccessible due to its protection level
        Console.WriteLine("object is a System.RuntimeType");
    else if (obj is Type)
        Console.WriteLine("object is a System.Type");
}

// This proves that @Hopeless' comment to the accepted answer from @dtb does not work
void IsWhatSystemType(object obj)
{
    if (obj is TypeInfo)
        Console.WriteLine("object is a System.RuntimeType");
    else
        Console.WriteLine("object is a Type");
} 
```

[在这里](https://dotnetfiddle.net/0WIUdQ)工作.NET 小提琴。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-17T00:47:43.420

```
return type == typeof(MyObjectType) || isoftype(type.BaseType) ; 
```

# xml - XML 复杂模式匹配表达式

> ID：10183621
> 
> 赞同：1
> 
> 时间：2012-04-17T00:42:47.910
> 
> 标签：xml, regex, xpath, pattern-matching, xquery

我需要匹配一组 XML 文档（都具有相同的模式）上的模式，当模式匹配时，我需要检索内容并对其进行一些特定的转换。

我有一个“模式”列表，它们类似于正则表达式，但包含元素和属性。

伪模式示例：

```
(//ELEMENTx) (node())* (//ELEMENTy[@ATTRIBUTEz]) (node())* (//@ATTRIBUTEw) 
```

我只在括号内使用了 XPath 语法。可以使用其他量词...

当 xml 将 ELEMENTx 作为第一个元素，以一个具有 ATTRIBUTEw 的元素结束，并且在两者之间需要一个具有 ATTRIBUTEz 的 ELEMENTy 时，这将匹配。

请注意，我需要为每个完整模式匹配整个文档，而不仅仅是其中的一部分。

在这种情况下，元素的嵌套并不重要（ELEMENTy 可以是 ELEMENTx 的子代，也可以不是），但它们需要具有特定的顺序。

编辑：澄清一下，XML 有带有语法信息的树。我需要匹配句法模式。

例子：

```

     最佳  
     / \  
    XY  
    |\ |\  
    1 2 3 4  

```

匹配模式可以是（节点名称，假设没有属性）：
XY
1 * Y
X 3 4
1 * 4

* * *

我可以使用 XPath 来获取模式的每个单独部分，但是我会失去秩序感……如果我执行两个 XPath 查询，我不知道结果相对于彼此的位置。

匹配后，我将为每个模式制定规则，指定内容的一些转换（更改顺序等）。

有没有办法使用 XPath 或 XQuery 做这样的事情？我可以使用 DOM 并自己制作模式匹配代码，但也许已经有更好的方法来做到这一点。

感谢您的任何指示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T07:50:42.500

> I need to match patterns on a set of XML documents (all with the same schema), and when a pattern matches, I need to retrieve the content and do some specific transformations on it.

So far that sounds like a pretty good description of XSLT. Until you say that you want a rule to match a sequence of nodes, rather than a single node.

But if the sequence of nodes you are matching is the sequence of children of some parent node, then you can recast this as a rule for matching the parent node.

The pattern matching language in XSLT isn't as powerful as you are looking for, but it could perhaps be adapted to your needs. Two possibilities that come to mind are (a) convert the structural information that you want to match on into a string, and use regular expression matching to assess the string, or (b) write XSD complex type definitions for the grammar that you want to match, and use the XSLT validate-by-type capability (in conjunction with XSLT 3.0's try/catch) to test whether the sequence of nodes matches a named complex type in the schema.

# facebook - 扩展 Facebook 页面访问令牌

> ID：10183625
> 
> 赞同：15
> 
> 时间：2012-04-17T00:43:04.437
> 
> 标签：facebook, access-token

我需要扩展我的 facebook 访问令牌，我称之为：

```
https://graph.facebook.com/oauth/access_token? 
client_id={MY PAGE ID}&
client_secret={THE SECRET KEY OF MY APP}&
grant_type=fb_exchange_token&
fb_exchange_token={AN ACCESS TOKEN FOR MY PAGE} 
```

我收到了这个错误：

```
 "error": {
      "message": "Error validating application. Cannot get application info due to a system error.",
      "type": "OAuthException",
      "code": 101
   } 
```

我已经看到那个 access_token 有很多问题，但是没有一个与页面相关的答案，idk 为什么 facebook 使用 api 那为什么......但是方式......

谢谢，

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-11-20T16:48:47.317

要获得长期访问令牌，您需要执行以下步骤：

1.  创建应用程序
2.  创建一个页面（您的帐户需要是页面的“管理员”）
3.  将应用程序关联到页面（与将页面选项卡添加到页面时相同的方式）

    ```
    http://facebook.com/add.php?api_key=*YOUR_APP_ID*&pages=1&page=*YOUR_PAGE_ID* 
    ```

4.  获取具有与您的应用程序关联的权限“manage_pages”的短期访问令牌。

    ```
    https://graph.facebook.com/oauth/authorize?client_id=__APP_ID__&scope=manage_pages&redirect_uri=http://www.facebook.com/connect/login_success.html
    then
    https://graph.facebook.com/oauth/access_token?client_id=__APP_ID__&redirect_uri=http://www.facebook.com/connect/login_success.html&client_secret=__APP_SECRET__&code=__CODE_FROM_PREVIOUS_REQUEST__ 
    ```

5.  将 Graph API Explorer 与请求[/me/accounts](https://developers.facebook.com/tools/explorer/?method=GET&path=me/accounts)一起使用，您可以查看您作为管理员的每个页面的访问令牌。问题是这些访问令牌是短暂的。

6.  将您的短期访问令牌转换为长期（扩展访问令牌）：

    ```
    https://graph.facebook.com/oauth/access_token?client_id=_APP_ID_&client_secret=_APP_SECRET_&grant_type=fb_exchange_token&fb_exchange_token=_ACCESS_TOKEN_ON_STEP_4_ 
    ```

7.  您现在可以使用[Access Token Debugger](https://developers.facebook.com/tools/debug/access_token?q=)测试您的新访问令牌。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T11:06:42.257

> 场景 5：页面访问令牌
> 
> 当用户授予应用程序 manage_pages 权限时，应用程序能够通过查询 [User ID]/accounts Graph API 端点来获取用户管理的页面的页面访问令牌。启用迁移后，当使用短期用户访问令牌查询此端点时，获得的页面访问令牌也是短期的。
> 
> 使用端点和前面解释的步骤将短期用户访问令牌交换为长期访问令牌。通过使用长期用户访问令牌，查询 [User ID]/accounts 端点现在将为用户管理的页面提供不会过期的页面访问令牌。当使用通过已弃用的 offline_access 权限获得的未过期用户访问令牌进行查询时，这也适用。

[https://developers.facebook.com/roadmap/offline-access-removal/](https://developers.facebook.com/roadmap/offline-access-removal/)

# php - 以表单形式显示来自 php 操作脚本的消息

> ID：10183633
> 
> 赞同：0
> 
> 时间：2012-04-17T00:44:16.660
> 
> 标签：php, javascript

如何显示来自表单的 php 操作脚本的消息？

该表单是具有这些字段的用户登录。

```
<div id="register_user_box" class="inline_form" style="position: absolute; top: 20px; right: 10px; <br/>
     <span id="user_msg"></span><br/>
     <form action="register_user.php" method="post"> 
     <input type="hidden" name="id" id="id" value="add" /> 
     <input type="hidden" name="edit_user" id="edit_user" value="y" />
     <table cellspacing="0px"> <tr><td>Username:</td></tr><tr><td>
     <input type="text" name="uname" size="30" value="" class="inline_input"/></td> </tr> <tr><td>Email:</td></tr><tr><td>
     <input type="text" name="uemail" size="30" value="" class="inline_input"/></td> </tr> <tr><td>Password:</td></tr><tr><td>
     <input type="password" name="upass" size="30" class="inline_input"/></td> </tr> <tr><td>Confirm Password:</td></tr><tr> <td> 
     <input type="password" name="cpass" size="30" class="inline_input"/></td></tr> </table></td></tr> </table> <p>
     <input class="button" type="submit" name="register" value="Register" style="float:right;"/></p>     
     </form>
</div> 
```

php 脚本 register_user.php 检查密码是否匹配，如果不匹配则显示错误消息。该脚本会检查所有其他字段并在必要时打印一条消息。

```
<?php

    $messages = array( 'usr_cred_req' => 'Must specify username, email, password.',
                        'usr_name_bad' => 'Bad username selection.  Select a different usrename.', 
                        'usr_name_exists' => 'Username selected already exists.  Select a different username.',
                        'usr_email_bad' => 'Bad email selection.  Select a different email.',
                        'usr_email_exists' => 'Email selected already exists.  Select a different email.',
                        'usr_pass_notmached' => 'Passwords do not match.  Type passwords again.', 
                        'usr_not_added' => 'User not added.',
                        'usr_not_updated' => 'User not updated.',
                        'usr_added' => 'User added.'
                        );

    $username = trim($_REQUEST['uname']);
    $email = trim($_REQUEST['uemail']);
    $password = md5(trim($_REQUEST['upass']));
    $copasswd = md5(trim($_REQUEST['cpass']));

    if ( $password != $copasswd ) { echo '<script> $("#usr_msg").html("'.$messages['usr_pass_notmached'].'"); </script>'; return;}
?> 
```

错误消息未显示，浏览器离开页面。我希望浏览器留在页面上并将错误消息添加到跨度 user_msg。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T00:47:35.823

如果您不希望浏览器在提交表单时离开页面，那么您将不得不使用 AJAX 在后台提交表单以与服务器通信，然后使用错误消息（或其他内容）更新容器成功）。

或者，让 PHP 表单发布到自身，在输出 HTML 之前检查错误消息，如果出现错误，将错误消息插入到所需位置的表单标记中，并使用所有值重新填充表单最初提交。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T01:04:56.127

[http://jquery.malsup.com/form/](http://jquery.malsup.com/form/)

这是一个很好的 jQuery AJAX 表单插件。这将防止页面在提交时刷新。希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T01:05:29.423

为什么要回显 JS 脚本来显示错误消息？你把它写出来的方式不会显示一个小弹出窗口，你只是让它填充`span`. 一个更好的方法是这样的：

```
if ( $password != $copasswd ) {
   $display_msg = $messages['usr_pass_notmached']
} 
```

然后在您的 HTML 中执行以下操作：

```
<span><?php echo $display_msg?></span> 
```

如果变量为空，则不显示任何内容。如果您对所有字段执行此操作，那么您可以确保表单中的所有信息都在错误时返回，无论实际字段是否错误，从而防止用户再次重新输入所有信息。让表单执行`$_SERVER['PHP_SELF']`以确保它重新加载同一页面

我将构建 PHP 功能（用户无法关闭）并确保您的表单在 100%（或接近）时间内正常工作。然后，一旦你的脚本工作，添加你的 JS 功能来*补充*你现有的代码。

在我的工作中，我构建了一个额外的数组，在这种情况下`$display_msg`，我会检查所有输入字段。如果一个字段失败，我将其添加到数组中，`$display_msg['password']`然后我转到下一个字段。检查完所有字段后，我会检查`$display_msg`变量是否`empty`存在。如果它不是空的，那么我让它`span`用红色字母填充输入框旁边的所有内容，解释错误。这将同时打印出所有错误，而不是一次打印出一个，而它的工作方式是在表格的下方。在每个输入旁边，我有一个`span`带有给定变量名称的，在这种情况下`<?php echo $display_msg['password']?>`，然后在用户名旁边，`<?php echo $display_msg['username']?>`依此类推。希望这足够清楚并有所帮助。

# python - 在 Django 的 POST 请求中使用可选参数验证自定义表单时出错

> ID：10183636
> 
> 赞同：0
> 
> 时间：2012-04-17T00:44:29.017
> 
> 标签：python, django, django-forms, django-views

所以我有`ModelForm`一个我创建的自定义，它接受一个变量`creator_list`，`queryset`如下所示：

```
class UserModelChoiceField(ModelChoiceField):
    def label_from_instance(self, obj):
        return obj.get_full_name()

class OrderCreateForm(ModelForm):
    class Meta:
        model=Order
        fields=('work_type', 'comment',)

    def __init__(self, creator_list=None, *args, **kwargs):
        super(OrderCreateForm, self).__init__(*args, **kwargs)

        if creator_list:
            self.fields['creator'] = UserModelChoiceField(
                queryset=creator_list,
                empty_label="Select a user",
                widget=Select(attrs={
                    'onchange': "Dajaxice.doors.orders_create_creator_changed(fill_other_fields, {'creator_pk': this.options[this.selectedIndex].value})"
                })
            )

        self.fields['place'] = UserModelChoiceField(
            queryset=User.objects.none(),
            empty_label="Select a creator first"
        ) 
```

当我只是显示字段时，一切都很完美。但是在 POST 提交期间。我收到不知道如何调试的错误。

我的`views.py`样子是这样的：

```
user = request.user
dictionary = get_order_create_dictionary(user)

if request.method == 'POST':
    #import ipdb; ipdb.set_trace()

    form = OrderCreateForm(request.POST)

    if form.is_valid():
        creator   = form.cleaned_data['creator']
        place     = form.cleaned_data['place']
        work_type = form.cleaned_data['work_type']
        comment   = form.cleaned_data['comment']

        new_order = Order.objects.create(
            creator  =creator,
            place    =place,
            work_type=work_type,
            comment  =comment
        )

        messages.success(request, "Your order #{} had been created!".format(new_order.pk))
        logger.info("{user} created order #{pk}".format(user=user, pk=new_order.pk))

        return HttpResponseRedirect(reverse('orders_detail', kwargs={'pk': new_order.pk}))
    else:
        return render(request, 'doors/orders/create.html', {'form': form, 'can_assign_creator': dictionary['can_assign_creator']})
else:
    if dictionary:
        return render(request, 'doors/orders/create.html', {
            'form': OrderCreateForm(creator_list=dictionary['creator_list']),
            'can_assign_creator': dictionary['can_assign_creator']
        })
    else:
        return HttpResponseRedirect(reverse('orders_list')) 
```

`get_order_create_dictionary()`简单地返回一个看起来像这样的字典：

```
dictionary = {
    'creator_list': Order.objects.all(), # Or some kind of filtered Order.
    'can_assign_order: 1, # Or 0\. This variable is used in the template to control access to what gets displayed.
} 
```

目前使用上面的代码，当我尝试发布一些东西时，我会收到这样的错误：

```
AttributeError: 'QueryDict' object has no attribute 'all'
on the line "return render(request, 'doors/orders/create.html', {'form': form, 'can_assign_creator': dictionary['can_assign_creator']})" 
```

我认为这与线路有关`form = OrderCreateForm(request.POST)`，所以我将其更改为`form = OrderCreateForm(request.POST, creator_list=dictionary['creator_list'])`. 但后来我得到这个错误：

```
TypeError: __init__() got multiple values for keyword argument 'creator_list'
on the line "form = OrderCreateForm(request.POST, creator_list=dictionary['creator_list'])" 
```

我不知道如何解决这个问题。我感谢任何帮助或提示！谢谢！

**编辑：**

我将行更改为`form = OrderCreateForm(dictionary['creator_list'], request.POST)`，现在验证有效，但它不会让我提交有效的 POST。它一直`Select a valid choice. That choice is not one of the available choices.`在说`place`。这可能与我如何根据实际情况使用 Ajax 来`<option>`填充。`place``creator`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T04:03:00.937

您最好只使用命名参数来实例化 Form 实例，即

```
form = OrderCreateForm(creator_list=dictionary['creator_list'], data=request.POST) 
```

一个例外是当表单只有一个参数时 - `data`. 这将帮助您避免弄乱参数顺序（这是您在此处出错的原因）。

# php - 使用雅虎天气提要的自定义图像

> ID：10183643
> 
> 赞同：1
> 
> 时间：2012-04-17T00:45:55.987
> 
> 标签：php, api, yahoo, weather

我目前正在从 Yahoo Weather 检索数据，并且能够显示到目前为止我需要的元素。我不知道如何使用条件代码（我认为我需要将数字转换为整数）来拥有一个字符串，以便我可以显示我自己的自定义图标。由于我正在跟踪的地区的天气相当温和，我只想分配少量图标，但每个图标都包含一串条件代码。到目前为止，这是我正在运行的代码——</p>

函数 bm_getWeather ($code = '', $temp = 'c') {

```
$file = 'http://weather.yahooapis.com/forecastrss?w=' . $code . '&u=' . $temp;

$request = new WP_Http;
$result = $request->request($file);

if (isset($result->errors)) {
    return FALSE;
}

$data = $result['body'];

$output = array (
    'temperature' => bm_getWeatherProperties('temp', $data),
    'weather_code' => bm_getWeatherProperties('code', $data),
    'class' =>  bm_getWeatherProperties('code', $data),
    'weather' => bm_getWeatherProperties('text', $data),        
);

return $output; 
```

}

功能天气图标（）{

```
$data = bm_getWeather($code = '', $temp = 'c');

// Error is here
$nums = (int)$data['weather_code']; // Needs to be cast as an integer

$severe = array(12, 13, 14, 16, 19);
$rain = array(3200);

// Therefore the maths is wrong
switch($nums) {
    case (in_array($nums, $severe)):
        $cat = 'severe';
    break;
    case (in_array($nums,$rain)):
        $cat = 'snow';
    break;
    default:
        $cat = 'happy';
    break;

}
return $cat; 
```

}

函数 bm_getWeatherProperties ($needle, $data) {

```
$regex = '<yweather:condition.*' . $needle . '="(.*?)".*/>';
preg_match($regex, $data, $matches);

return (string)$matches[1]; 
```

}

任何帮助将不胜感激，因为我的 php 技能现在还不够。

# sql - 垂直返回列

> ID：10183649
> 
> 赞同：1
> 
> 时间：2012-04-17T00:46:25.060
> 
> 标签：sql, sql-server-2008-r2

假设我有一个简单的选择查询，它返回以下内容：

```
ID   Name1 Name2 Description1 Description2 Notes1 Notes2
1     A     B       AA              BB       AAA    BBB
2     C     D       CC              DD       CCC    DDD 
```

我想按如下方式返回数据集：

```
ID ColumnName    1st   2nd
1   Name           A   B
1   Description   AA   BB
1   Notes        AAA   BBB
2   Name           C   D
2   Description   CC   CC
2   Notes        DDD   DDD 
```

在 sql server 2008-r2 中有什么方法吗？看起来这是 PIVOT 的工作，但我对如何使用 PIVOT 实现这一目标感到困惑

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T00:51:12.623

您可以使用它，假设这些值是静态的或不是太多以至于用您的实际值修补它并不太痛苦：

```
SELECT ID, 'Name' ColumnName, Name1 '1st', Name2 '2nd'
FROM YourTable
UNION
SELECT ID, 'Description' ColumnName, Description1 '1st', Description2 '2nd'
FROM YourTable
UNION
SELECT ID, 'Notes' ColumnName, Notes1 '1st', Notes2 '2nd'
FROM YourTable 
```

另一个很好的例子说明了为什么数据规范化如此重要。

# jquery - jQuery：切换下拉菜单的可能性

> ID：10183659
> 
> 赞同：1
> 
> 时间：2012-04-17T00:48:20.733
> 
> 标签：jquery, drop-down-menu, toggle

我在下面有以下 HTML，但我想知道的是可以使用 jQuery`.toggle`函数来使主`<li>`标题*Trails*成为一个链接，然后当您将鼠标放在主链接*Trails*上时，其他页面将显示并且您可以点击相应的页面。

**HTML:** -*这种 HTML 格式由 PYROCMS 提供，我无法控制它*

```
<li class="current">
        <a href="">Trials</a>
        <ul>
            <li class="first">
                <a href="">Link One</a>
            </li>
            <li>
                <a href="">Link Two</a>
            </li>
            <li>
                <a href="">Link Three</a>
            </li>
            <li class="last">
                <a href="">Link Four</a>
            </li>
        </ul>
    </li> 
```

**jQuery:** -*下面的变体可以用于上述问题吗？*

```
$('select[name="domainTransfer"]').change(function() {

    $('#domainToBeTransfered,#domainToBeTransfered0').toggle($(this).val() === "yes");

    }); 
```

**巴兹1nga：**

我查看了您的 jsfiddle 并注意到您已`display:none;`在子上放置了一个`<ul>`我已将其放入我的 css 的行，`#wrapper #contentarea #blue_box .centerblue_txt ul li ul{`但它似乎不与 jQuery 交互。

```
jQuery(document).ready(function () {
    $(".current a").mouseenter(function(){
       $(this).siblings("ul").show();
    }).mouseout(function(){
       $(this).siblings("ul").hide();
    });​
});​ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T01:06:02.143

```
$(".current a").mouseenter(function(){
   $(this).siblings("ul").show();
}).mouseleave(function(){
   $(this).siblings("ul").hide();
}); 
```

​</p>

这是你想要的吗？

演示：http: [//jsfiddle.net/rY8zm/](http://jsfiddle.net/rY8zm/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T04:51:52.600

Baz1nga 的解决方案在 Opera 中不适合我。当光标从标题转移到列表时，列表消失 - 因此可以查看列表，但永远无法单击其链接。

您需要采取特殊措施才能通过从元素到元素的过渡来查看光标。这是通过超时来实现的，以非常轻微地延迟列表的隐藏；并且每次光标经过任何应该保持列表活动的元素时都会取消超时。

代码比较复杂，看起来像这样：

```
function hideList($list) {
    clearTimeout($list.data('dropdown').tim);
    return setTimeout(function() {
        $list.stop(true).slideUp('slow');
    }, 125);
}

$("li.current").on('mouseover', "a.heading", function() {
    var $list = $(this).siblings("ul").slideDown('slow');
    clearTimeout($list.data('dropdown').tim);
}).on('mouseout', function() {
    var $list = $(this).children("ul");
    $list.data('dropdown').tim = hideList($list);
}).children("ul").on('mouseover', function() {
    clearTimeout($(this).data('dropdown').tim);
}).on('mouseout', function() {
    var $list = $(this);
    $list.data('dropdown').tim = hideList($list);
}).data('dropdown', {
    tim: null
}).hide(); 
```

见[小提琴](http://jsfiddle.net/R2zc5/1/)

# java - 启用 java 图像更改的转换

> ID：10183660
> 
> 赞同：3
> 
> 时间：2012-04-17T00:48:24.967
> 
> 标签：java, swing, animation, slideshow, transitions

我正在编写一个旨在在屏幕上显示目录的小型应用程序。该窗口分为三个主要块：左侧是文章列表，右侧是图像渲染面板，在最后一个组件下，我有一些信息标签。

现在，当我选择一篇文章时，我在面板上绘制图像并将信息填充到标签中。当我有多个与所选文章相关联的图像时，我会启动一个摇摆计时器，然后每隔 5 秒交换图像...

我怎样才能让照片变化更漂亮在图像变化上引入一些花哨的动画？你知道任何图书馆可以帮助我吗？如果您直接通过代码执行此操作，那么一个示例和一些解释会很棒。

在此先感谢马尔科

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T06:38:41.063

您可以使用基本的 Java2D 功能非常轻松地制作一些基本动画，但是添加一些真正有趣的东西需要更多的努力。

您可以查看我自己的库演示（包括源代码）以获取 ImageTransitionPanel 示例 - 它允许使用一些有趣的动画在两个不同的 Swing 组件之间执行转换：
[Web 外观演示](http://weblookandfeel.com/downloads/weblookandfeel.jnlp)

演示和源代码中还包含 ImageTransitionPanel 的完整源代码。该类基本上创建了所有的过渡效果并执行过渡。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T01:31:59.493

您可以通过[此处](https://stackoverflow.com/a/3078354/230513)说明的方法和[此处](https://stackoverflow.com/search?q=user:230513%20%5Bjava%5D%20alphacomposite)说明的`getSubImage()`方法获得无穷乐趣。另请参阅[Java 2D API](http://docs.oracle.com/javase/tutorial/2d/index.html)。`BufferedImage``AlphaComposite`

# iphone - UIAlertViewDelegate 类“self”实例在按钮被按下之前被释放

> ID：10183661
> 
> 赞同：0
> 
> 时间：2012-04-17T00:48:35.647
> 
> 标签：iphone, ios, xcode, ios5

几天来，我一直在寻找这个问题的解决方案，并找到了一些类似的帖子，但似乎没有人发布关于如何阻止我正在使用的实例被释放的明确答案。希望我只是错过了它，或者有人可以帮助我停止破坏我的大脑..

我有一个类 ( `LKNetworking`)，它声明它符合`UIAlertViewDelegate`协议。目前它是 的子类`NSObject`，但是我已经尝试过`UIResponder`，但都产生了同样的问题。

问题是我创建了一个 UIAlert 视图并将委托设置为`self`. UIAlert 视图显示 OK，但随后`LKNetworking`调用它的 Class 实例立即被释放（正如我在 NSLOG 中显示的那样），当我单击按钮时，消息被发送到释放的实例（LKNetworking alertView:clickedButtonAtIndex:]: message发送到释放的实例 0x6e5ce40)

所以，我试图在 .h 文件中创建一个属性，如下所示：

```
@property (strong, nonatomic) LKNetworking *strongNetworkingProperty 
```

然后我尝试将我的 UIAlertView 的委托设置为 strongNetworkingProperty ivar，并且消息似乎无处可去，所以这不好..

我看到了一些答案，人们说将警报视图设置`delegate`为`nil`，但这违背了我的整个目的，因为我需要根据用户的选择采取相应的行动。

`LKNetworking`这是调用警报的方法和方法的示例代码`delegate`：

```
-(void)checkGameServerVersion: (float) serverGameVersion {
    if (serverGameVersion == GAMEVER) {
        NSLog(@"matched");
        // Continue flow here..
    } else {
        NSLog(@"not matched");
        //Game version does not match, end game, force upgrade 
        UIAlertView *oldVersion = [[UIAlertView alloc]initWithTitle:@"Ugrade Required" message:@"A new game version is available, Please update your game and try again." delegate:self cancelButtonTitle:@"Quit" otherButtonTitles: nil];
        [oldVersion show];
    }
}

-(void)alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex {
    NSLog(@"button = %d",buttonIndex);
    if (buttonIndex == 0 ) {
        NSLog(@"pressed button 0, quitting gam");
    }
}
@end 
```

任何建议将不胜感激！

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-17T01:34:35.857

如果您希望您的 LKNetworking 继续存在，则需要保留对它的引用。那个东西可以是 LKNetworking 对象本身。创建警报视图时设置 strongNetworkingProperty = self。这会创建一个保留周期，阻止系统释放 LKNetworking 对象。然后在 alertView:clickedButtonAtIndex: 中，将 strongNetworkingProperty 设置为 nil 以打破保留循环。

# ruby-on-rails - Rails - 在方法中引用当前模型实例的正确方法？

> ID：10183662
> 
> 赞同：1
> 
> 时间：2012-04-17T00:48:35.963
> 
> 标签：ruby-on-rails, ruby, methods, model, instance

假设我有一个`Post`模型，我想在保存时运行一个方法

在`post.rb`我做：

```
:before_save some_method_on_post

def some_method_on_post
  # Do something here
end 
```

我的问题是，如何在方法内部引用当前实例化的 Post 对象？

编辑：所以澄清假设我想这样做：

```
def some_method_on_post
  post.some_property = foo
end 
```

我指的`post`是自我吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-17T01:05:31.097

> 是的。

使用属性设置方法时，参考`self`as in 方法

```
def self.attribute_name=(value)
  @attribute_name = value
end 
```

作为一种快捷方式，当您有一个检索但不设置对象的方法（因此是一个 getter）时，您可以省略`self`，例如

```
def attribute_name
  @the_value
end 
```

# django - Django factory_boy 测试中的用户身份验证

> ID：10183664
> 
> 赞同：6
> 
> 时间：2012-04-17T00:48:47.520
> 
> 标签：django, unit-testing, factory, django-authentication

当尝试对我的代码的某些部分进行单元测试时，我需要一个用户登录。为了减少我正在使用 django_factory_boy 用户工厂的装置数量，但生成的用户无法进行身份验证。

```
from django_factory_boy.auth import UserF
from django.contrib.auth import authenticate

user = UserF()
user.set_password('password') 
```

然后`authenticate(username=user.username, password='password')`返回`None`而不是用户。关于这里缺少什么的任何想法？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-12-15T09:29:55.070

@Andrew-Magee 解决方案有效，但这里的解决方案[在文档中描述](https://factoryboy.readthedocs.org/en/latest/reference.html#factory.PostGenerationMethodCall)：

```
import factory
from django.contrib.auth.models import User
#or
#from somewhere import CustomUser as User

class UserFactory(factory.DjangoModelFactory):
    FACTORY_FOR = User

    username = 'UserFactory'
    email = 'test@example.com'
    password = factory.PostGenerationMethodCall('set_password', 'password') 
```

Django控制台：

```
>>> from tests.factories import UserFactory
>>> from django.contrib.auth.models import check_password
>>> user = UserFactory()
>>> user.email
'test@example.com'
>>> check_password('password', user.password)
True

>>> user2 = UserFactory(username="SecondUserFactory", email='otheremail@example.com', password="ComplexPasswordMuchLonger!")
>>> user2.email
'otheremail@example.com'
>>> check_password('ComplexPasswordMuchLonger!', user2.password)
True 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-07-09T07:15:46.387

另一种方法：

```
import factory
from django.contrib.auth.hashers import make_password
from somewhere import YourUserModel

class UserF(factory.django.DjangoModelFactory):
    FACTORY_FOR = YourUserModel
    first_name = factory.Sequence(lambda n: "First%s" % n)
    last_name = factory.Sequence(lambda n: "Last%s" % n)
    email = factory.Sequence(lambda n: "email%s@example.com" % n)
    username = factory.Sequence(lambda n: "email%s@example.com" % n)
    password = make_password("password")
    is_staff = False

>>> u = UserF.create()
>>> u.check_password("password")
True

>>> p = UserF.create(password=make_password("password2"))
>>> p.check_password("password2")
True 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-17T03:55:06.993

您应该调用`user.save()`after`user.set_password()`因为`set_password`它本身不保存用户，只设置数据。

# xamarin.android - ASP.NET Web API 和 MonoDroid

> ID：10183666
> 
> 赞同：1
> 
> 时间：2012-04-17T00:48:52.013
> 
> 标签：xamarin.android, asp.net-web-api

我正在尝试从 MonoDroid 调用我在 IIS 中托管的 ASP.NET Web API。该服务很好，我可以从不同的端点调用它。问题是，在 MonoDroid 中，当我尝试执行此操作时，我得到了无效的强制转换异常。

```
var s = response.GetResponseStream();
var j = (JsonObject)JsonObject.Load(s); 
```

System.InvalidCastException：返回加载部分。

我做了一些阅读，人们似乎说要尝试将 Web API 切换为使用 JsonNetFormatter 类。我试过了，但仍然没有运气。

有人对我可以尝试什么有任何想法吗？

# 更新

这是有效载荷

```
<ArrayOfAlbum xmlns:xsi="w3.org/2001/XMLSchema-instance"; 
              xmlns:xsd="w3.org/2001/XMLSchema">; 
   <Album> 
      <AlbumPK>f09d14cf-3bab-44c8-b614-2b7cf728efd4</AlbumPK>
      <Name>Colorado</Name> 
      <UserName>firstUser</UserName> 
      <ParentAlbumFK xsi:nil="true" /> 
      <DateCreated>2012-03-12T19:47:54.493</DateCreated> 
   </Album> 
</ArrayOfAlbum> 
```

和

```
 [{"AlbumPK":"f09d14cf-3bab-44c8-b614-2b7cf728efd4","Name":"Colorado",
    "UserName":"emorin","ParentAlbumFK":null,
    "DateCr‌​eated":"2012-03-12T19:47:54.493"}] 
```

来自 Fiddler 的响应将接受标头更改为 JSON。

```
HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Transfer-Encoding: chunked
Content-Type: application/json; charset=utf-8
Expires: -1
Server: Microsoft-IIS/7.0
X-AspNet-Version: 4.0.30319
X-Powered-By: ASP.NET
Date: Tue, 17 Apr 2012 19:45:47 GMT

97
[{ "AlbumPK":"f09d14cf-3bab-44c8-614-2b7cf728efd4","Name":"Colorado",
   "UserName":"emorin","ParentAlbumFK":null,
   "DateCreated":"2012-03-12T19:47:54.493"}]
0 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T16:25:21.807

似乎您的服务器正在以分块编码发送数据，并且可能 MonoDroid 在理解分块编码时遇到问题。尝试在 IIS 中将其关闭。

# javascript - 从日历中删除选定的事件

> ID：10183667
> 
> 赞同：3
> 
> 时间：2012-04-17T00:48:52.237
> 
> 标签：javascript, jquery, spring-mvc, fullcalendar, freemarker

我正在使用 JQuery Full Calendar 和 Spring MVC。

你好，我做了一个这样的[演示](https://i.stack.imgur.com/zy8Aa.jpg)。

目标：我需要当用户单击她/他已经插入的事件时，会出现一个对话框，让他/她能够删除该事件或取消该事件。

问题：现在，每当用户点击任何一天时，都会出现一个对话框，允许用户输入该事件的标题，然后用户单击“确定”以保存该事件。

自由标记： 自由标记：

```
<script type="text/javascript">
    var resourceVacation;

    function censor(censor) {
        return (function() {
            var i = 0;
            return function(key, value) {
                if (i !== 0 && typeof(censor) === 'object' && typeof(value) == 'object' && censor == value)
                    return '[Circular]';                   

                ++i; // so we know we aren't using the original object anymore

                return value;
            }
        })(censor);
    }

    function doAjax() {

        $.each(resourceVacation, function(index) {
            var tmpDate = resourceVacation[index].start;
            tmpDate.setHours(tmpDate.getHours() - tmpDate.getTimezoneOffset() / 60);
            resourceVacation[index].start=tmpDate;

        });
//        var arrays = [
//            {"id":111,"title":"event1","start":"2012-04-15T22:00:00.000Z","url":"http://yahoo.com/"}
//        ];
//        var objects = {"id":111,"title":"event2","start":"2012-04-16T22:00:00.000Z","url":"http://yahoo2.com/"};
//
//        arrays.push(objects);
        var test = JSON.stringify(resourceVacation, censor(resourceVacation));
        var x = test;
        $.ajax(
        {
            url:"[@spring.url '/vacation/saveResourceVacation'/]",
            type: "POST",
            data :x ,
            dataType: "json",
            contentType: "application/json"
        });
    }

    $(document).ready(function() {

        var date = new Date();
        var d = date.getDate();
        var m = date.getMonth();
        var y = date.getFullYear();
        $.getJSON('[@spring.url '/vacation/loadResourceVacation'/]', function (data) {
            var calendar = $('#calendar').fullCalendar({
                header: {
                    left: 'prev,next today',
                    center: 'title',
                    right: 'month,agendaWeek,agendaDay'
                },
                selectable: true,
                selectHelper: true,
                select:
                        function(start, end, allDay) {
                            var title = prompt('Event Title:');

                            if (title) {
                                start.setHours(start.getHours() - start.getTimezoneOffset() / 60);
//                                var dat=$.fullCalendar.formatDate( start, "yyyy/MM/dd")

                                var newVacation= {id:133,title:'title',start:start,url: 'title'};
                                resourceVacation.push(newVacation);
                                calendar.fullCalendar('renderEvent',
                                {
                                    title: title,
                                    start: start,
                                    end: end,
                                    allDay: allDay
                                },
                                        true // make the event "stick"
                                        );
                            }
                            calendar.fullCalendar('unselect');
                        },
         eventClick: function(calEvent, jsEvent, view) {

            alert('Event: ' + calEvent.title);
            alert('start: ' + calEvent.start);             
        }

                editable: true,
                events:data
            });
            resourceVacation = data;
        });
    });

</script> 
```

控制器：

```
 @RequestMapping(value = "/vacation/loadResourceVacation", method = RequestMethod.GET)
        public
        @ResponseBody
        String loadResourceVacation(HttpServletResponse response) throws Exception {

            //Here I build my vacationFormBean
            List<VacationFormBean> vacationFormBeanList= buildVacationFormBean();
            // Convert to JSON string.
            String json = new Gson().toJson(vacationFormBeanList);

            // Write JSON string.
            response.setContentType("application/json");
            response.setCharacterEncoding("UTF-8");       

        return json;
    }

    @RequestMapping(value = "/vacation/saveResourceVacation", method = RequestMethod.POST)
    public
    @ResponseBody
    void saveResourceVacation(@RequestBody String jsonString, Principal principal) throws Exception {
        List<String> resourceVacations = extractVacationDatesFromJsonObject(jsonString);

    } 
```

VacationFormBean：

```
public class VacationFormBean {
    int id; // (With Setter & Getter)
    String title; // (With Setter & Getter)
    String start;  // (With Setter & Getter)
    String url; // (With Setter & Getter)
} 
```

我需要这样的东西：

![在此处输入图像描述](../Images/c2a12aedc488cf003939b8363c36e8f8.png)

======================更新=========================

由于 domi27 推荐，我添加了点击事件。请查看 freemarker 更新。我添加了一个 java 脚本方法，它使用：[http ://arshaw.com/fullcalendar/docs/event_data/removeEvents/](http://arshaw.com/fullcalendar/docs/event_data/removeEvents/)

新的 JS 方法：

```
 $('#calendar').fullCalendar('removeEvents', 1); 
```

此方法与最初从控制器加载的事件完美配合。但是，每当我尝试使用相同的方法来删除我刚刚添加的新事件时，什么都没有发生。当我为我创建的新事件触发“选择事件”时，我得到了它的 id“未定义”。

正如我在 freemarker 上提到的，这些行是我用来构建附加到列表的新事件对象的行。

```
var newVacation = {id:'133',title:'title',start:start,url: 'title'};
                                    resourceVacation.push(newVacation); 
```

当我调试我的脚本时，我观察到从控制器加载的对象和我在用户添加新事件时创建的新对象之间的差异。

这是我在启动日历时从控制器获得的旧对象： ![在此处输入图像描述](../Images/53cb87364e7ea9c92e1c98e3de07c2db.png)

这是我插入新事件后得到的新对象：

![在此处输入图像描述](../Images/935af1424888a3abdaa4fdf500615fc7.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-19T10:33:42.433

您可以像这样实现它：

1.  获取点击事件
2.  显示有关（如何）删除此事件的信息
3.  调用 ajax 请求处理后端事件的删除
4.  从日历前端删除事件

1）首先在这里描述：http: [//arshaw.com/fullcalendar/docs/mouse/eventClick/](http://arshaw.com/fullcalendar/docs/mouse/eventClick/)

2) 最简单的 JS：confirm("真的要删除这个事件吗？")

3) 可能像保存预订一样通过 jQuery 调用删除操作

4）通过fullcalendars“removeEvents”方法删除此事件：http: [//arshaw.com/fullcalendar/docs/event_data/removeEvents/](http://arshaw.com/fullcalendar/docs/event_data/removeEvents/)

这是一个简短且非常基本的示例：

```
eventClick: function(calEvent, jsEvent, view) {
    /**
     * calEvent is the event object, so you can access it's properties
     */
    if(confirm("Really delete event " + calEvent.title + " ?")) {
        // delete event in backend
        jQuery.post(
            "/vacation/deleteEvent"
            , { "id": calEvent.id }
        );
        // delete in frontend
        calendar.fullCalendar('removeEvents', calEvent.id);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T20:33:27.420

我通过以下方法使其工作：每当用户触发整个日历上的“选择”或“点击”事件时，我都会去搜索用户选择的日期并将其从我的 JS 数组中删除。我使用 :$('#calendar').fullCalendar('removeEvents', id) 将其从完整日历事件中删除。

```
[#ftl /]
<script type="text/javascript">
var resourceVacation;
var vacationStart;

function censor(censor) {
    return (function() {
        var i = 0;
        return function(key, value) {
            if (i !== 0 && typeof(censor) === 'object' && typeof(value) == 'object' && censor == value)
                return '[Circular]';

            ++i; // so we know we aren't using the original object anymore

            return value;
        }
    })(censor);
}

function isVacation(day) {
    for (var index = 0; index < resourceVacation.length; index++) {
        if (resourceVacation[index].id == day) {
            return true;
        }
    }
    return false;
}

function deleteVacation(day) {
    for (var index = 0; index < resourceVacation.length; index++) {
        if (resourceVacation[index].id == day)

            resourceVacation.splice(index,1);
    }  

}

function showTheCorrectDialog(vacationStartDay) {
    var vacationID = $.fullCalendar.formatDate(vacationStartDay, "yyyy-MM-dd")
    if (isVacation(vacationID))
        getDeletionConfirmationDialog(vacationID);
    else
        getInsertionConfirmationDialog(vacationStartDay)
}

function doAjax() {

    $.each(resourceVacation, function(index) {
        var tmpDate = resourceVacation[index].start;

        tmpDate.setHours(tmpDate.getHours() - tmpDate.getTimezoneOffset() / 60);
        resourceVacation[index].start = tmpDate;

    });
    var test = JSON.stringify(resourceVacation, censor(resourceVacation));
    var x = test;
    $.ajax(
    {
        url:"[@spring.url '/vacation/saveResourceVacation'/]",
        type: "POST",
        data :x ,
        dataType: "json",
        contentType: "application/json"
    });
}

$(document).ready(function() {
    var date = new Date();
    var d = date.getDate();
    var m = date.getMonth();
    var y = date.getFullYear();
    $.getJSON('[@spring.url '/vacation/loadResourceVacation'/]', function (data) {
        var calendar = $('#calendar').fullCalendar({
            header: {
                left: 'prev,next today',
                center: 'title',
                right: 'month,agendaWeek,agendaDay'
            },
            selectable: true,
            selectHelper: true,
            select:
                    function(start, end, allDay) {
                        vacationStart = start;
                        showTheCorrectDialog(vacationStart);

                    },

            eventClick: function(calEvent, jsEvent, view) {

                showTheCorrectDialog(calEvent.start);

                // change the border color just for fun
                $(this).css('border-color', 'red');
            },

            editable: true,
            events
                    :
                    data
        });
        resourceVacation = data;
    });
});

function getInsertionConfirmationDialog(vacationStart) {
      var complimentaryVacationHTML = "<input  type = \"radio\" name = \"vacationTypes\" value = \"Complimentary\">Complimentary<br>";

    var scheduledVacationHTML = "<input  type = \"radio\" name = \"vacationTypes\" value = \"Scheduled\" checked=\"checked\">Scheduled<br>";

    $('html').append('<div id="insertionConfirmDialog" align="left">' +
            complimentaryVacationHTML +scheduledVacationHTML + ' </div > ');
    var selectedVacationType = "";
    var insertionConfirmDialog = $('#insertionConfirmDialog');
    insertionConfirmDialog.dialog({
        modal: true,
        autoOpen: false,
        resizable:false,
        title: 'Please select the vacation type',
        width: 300,
        height: 310,
        buttons: {
            'Ok': function() {
                selectedVacationType = $(this).find('input:checked').val();
                $(this).remove();

                vacationStart.setHours(vacationStart.getHours() - vacationStart.getTimezoneOffset() / 60);
                var vacationID = $.fullCalendar.formatDate(vacationStart, "yyyy-MM-dd")

                var newVacation = {id:vacationID,title:selectedVacationType,start:vacationStart};
                resourceVacation.push(newVacation);
                $('#calendar').fullCalendar('refetchEvents',
                {
                    title: selectedVacationType,
                    start: vacationStart,

                    allDay: true
                },
                        true // make the event "stick"
                        );

                $('#calendar').fullCalendar('unselect');
            },
            Cancel: function() {
                $(this).remove();
            }
        }
    });

    insertionConfirmDialog.dialog('open');
}

function getDeletionConfirmationDialog(vacationStart) {

    $('html').append('<div id="deletionConfirmDialog" align="left"><p>Are you sure you need to delete your vacation on:'+vacationStart +'</p>'+
            ' </div > ');
    var deletionConfirmDialog = $('#deletionConfirmDialog');
    deletionConfirmDialog.dialog({
        modal: true,
        autoOpen: false,
        resizable:false,
        title: 'Delete Confirmation',
        width: 300,
        height: 310,
        buttons: {
            'Delete': function() {
                $(this).remove();

                deleteVacation(vacationStart);
                $('#calendar').fullCalendar('removeEvents', vacationStart);

            },
            Cancel: function() {
                $(this).remove();
            }
        }
    });

    deletionConfirmDialog.dialog('open');
}

</script>
<style type='text/css'>

    body {
        margin-top: 40px;
        text-align: center;
        font-size: 14px;
        font-family: "Lucida Grande", Helvetica, Arial, Verdana, sans-serif;
    }

    #calendar {
        width: 900px;
        margin: 0 auto;
    }

</style>
<body>
<input type="button" id="editProject" name="editProject" class="btn btn-inverse"
       value="Save Vacations"
       onclick="doAjax()"
        />

<div id='calendar'></div>

</body>
[@footer/] 
```

# c - 比较 linux 上的目标地址（内核 3.2.6）

> ID：10183670
> 
> 赞同：0
> 
> 时间：2012-04-17T00:49:42.090
> 
> 标签：c

我正在编写一个内核模块，我必须与目标地址进行比较。我有一个地址数组，我想动态添加这些地址。如果地址已经在数组中，我将其删除，但如果不是，则将其放在下一个可用索引处。

我的代码片段如下：

```
daddr = &udp_hdr(sock_buff)->dest; /* an example address just for comparison purposes */
saddr = &udp_hdr(sock_buff)->source; /* an example address just for comparison purposes */

int compare( __be32 addr1, __be32 addr2 ) {

  addr1[0] = 0xff & add1 >> 24;
  addr1[1] = 0xff & add1 >> 16;
  addr1[2] = 0xff & add1 >> 8;
  addr1[3] = 0xff & add1;

  addr2[0] = 0xff & add2 >> 24;
  addr2[1] = 0xff & add2 >> 16;
  addr2[2] = 0xff & add2 >> 8;
  addr2[3] = 0xff & add2;

  for(i=0; i<4; i++) {
    if(addr1[i]==addr2[i]) {;
      i++;
      if(i==4) {
        return 0;
        break;
      } else return 1;
    }
  }
} 
```

然后我正在使用该功能进行比较

```
int compare( __be32 addr1, __be32 addr2 ) {

  addr1[0] = 0xff & add1 >> 24;
  addr1[1] = 0xff & add1 >> 16;
  addr1[2] = 0xff & add1 >> 8;
  addr1[3] = 0xff & add1;

  addr2[0] = 0xff & add2 >> 24;
  addr2[1] = 0xff & add2 >> 16;
  addr2[2] = 0xff & add2 >> 8;
  addr2[3] = 0xff & add2;

  for(i=0; i<4; i++) {
    if(addr1[i]==addr2[i]) {;
      i++;
      if(i==4) {
        return 0;
        break;
      } else return 1;
    }
  }
} 
```

但是，用函数调用说

```
compare((__be32)daddr, (__be32)saddr) 
```

比较像 192.168.1.2 和 192.132.1.2 这样的地址返回 true（此处为 0），在某些情况下返回 false（此处为 1）。我哪里出错了，或者有没有更好的比较地址的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T01:27:53.933

如果块也是可疑的，你最终会增加`i`两次，我猜你需要的是`i++``addr1[i] == addr2[i]``else`

```
for(i=0; i<4; i++) {
   if(addr1[i]!=addr2[i]) {;
     return 1;
   }
}
return 0; 
```

# c++ - 如何使用信号和插槽从 qt 表单中获取 id，然后在链表中搜索并使用另一种表单显示结果？

> ID：10183672
> 
> 赞同：0
> 
> 时间：2012-04-17T00:50:04.403
> 
> 标签：c++, qt, qt4

使用信号和插槽连接后，应触发搜索然后显示其他类的信息的类：

```
#include "recruitsearch.h"
#include "ui_recruitsearch.h"
#include <cctype>
#include <QtGui>
#include <string>
#include <QtCore>
using namespace std;
RecruitSearch::RecruitSearch(QWidget *parent) :
    QDialog(parent),
    ui(new Ui::RecruitSearch)
{
    ui->setupUi(this);
}

RecruitSearch::~RecruitSearch()
{
    delete ui;
}

void RecruitSearch::on_pushButton_clicked()
{
    //if(EmployerSearch::ui->buttonBox->clicked();
    if(ui->rfrId->text().isEmpty() || ui->rfrId->text().isNull() || (is_Digit(ui->rfrId->text().toStdString())==false) ){
        QMessageBox::warning(this,"Error", "Please enter a valid RFR id(digits only)");
    }
    else{
        accepted();
        this->close();
    }
}

int RecruitSearch:: getRfrId(){
    return ui->rfrId->text().toInt();
}

bool RecruitSearch::is_Digit( string input){
    for (int i = 0; i < input.length(); i++) {
           if (!std::isdigit(input[i]))
               return false;
       }

       return true;
} 
```

用显示器上课。我将如何连接这两个插槽并使用第一种形式的 id 来搜索链表，然后使用另一种形式显示结果：

```
#include "rfrform.h"
#include "ui_rfrform.h"
#include <cctype>
#include <string>
#include <QString>
#include <QtGui>
#include <QtCore>
#include <iostream>
using namespace std;

RfrForm::RfrForm(QWidget *parent) :
    QDialog(parent),
    ui(new Ui::RfrForm)
{
    ui->setupUi(this);
}

RfrForm::~RfrForm()
{
    delete ui;

}

void RfrForm::setEmpName(string name){
    QString qstr=QString::fromStdString(name);
    ui->EmployerName->setText(qstr);
}

void RfrForm::setAOE(string aoe){
    QString  qstr=QString::fromStdString(aoe);
    ui->AOE->setText(qstr);
}

void RfrForm::setEmpId(int id){
    QString  qstr=QString::number(id);
    ui->EmpId->setText(qstr);
}// end of setId

void RfrForm::setNumOfPos(int num){
    QString qstr=QString::number(num);
    ui->numOfPos->setText(qstr);
}

void RfrForm::setGender(string gen){
    QString qstr=QString::fromStdString(gen);
    ui->gender->setText(qstr);
}

void RfrForm::setMaxRecruits(int max){
    QString qstr=QString::number(max);
    ui->MaxRecruits->setText(qstr);
}

void RfrForm::display(RFR *temp){

    this->show();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T13:11:52.150

将 Qt 中的信号和槽视为简单的回调。例如，标准信号/槽可能如下所示：

```
....
QAction* act = new QAction(this);
connect(act, SIGNAL(triggered()), this, SLOT(handleAct()));
.... 
```

请注意，第一个参数是指向将发出信号的对象的指针（因此，`triggered`在这种情况下，信号方法必须与我们的发送者相关联，在这种情况下`QAction`），第二个参数是信号函数签名。类似地，最后两个参数是槽的指针（即事件处理程序，在本例中为当前类）和某个处理程序函数的函数签名。

这是一些看起来像这样的类（注意`Q_OBJECT`宏）

```
class TestMe
{
  Q_OBJECT
public:
  ...
protected slots:
  void handleAct();
}; 
```

该`handleAct()`方法是您设计的任意函数。现在，为了更具体地回答您的问题，我们需要更详细地说明您正在使用哪种类型`QWidget`（即我们知道它发出哪些信号）。无论如何，基本思想是从特定元素中捕获特定类型的符号，然后相应地处理信息。

有时，要进行您正在寻找的一种信息传输，您可能需要将特定的指向对象的指针作为类成员，以便您可以轻松地获取相应的信息`QWidget`（通常是`text()`方法或类似的）。

然而，同样重要的是要注意，您可以覆盖`QWidget`类型并创建自定义信号和插槽。因此，如果您有一个返回 id 的自定义信号和一个将 id 值作为输入的信号，您可以连接这些信号和插槽（查看`emit`功能）

如果您提供一些关于`QWidget`您正在使用的更具体的信息，我们或许能够为您提供更具体的解决方案。

# php - PHP 将 utf8 Æ (195 134) 转换为 198

> ID：10183674
> 
> 赞同：1
> 
> 时间：2012-04-17T00:50:35.387
> 
> 标签：php, mysql, character-encoding

我在 PHP 中有一个奇怪的问题，希望有人以前见过。

我将 Æ 字符 (AE) 存储在设置为 utf8 的 MySql 数据库中。我有一个 PHP 应用程序可以在我的本地机器（Windows 7）上的浏览器中正确显示字符，但是当在生产中使用相同的代码和数据库（GoDaddy Linux 主机）时，字符被转换为单个 ASCII 字符（ 198），它显示为黑色三角形中的可怕问号。我已经确认两个地方的数据库和代码完全相同。我可以将字节作为数组进行迭代，并看到 MySql 输出的是两个字节，\195\134，但是 PHP 发送的内容在生产环境中以某种方式转换为单个 198。

我已经排除了字符编码的浏览器问题。我在所有使用 utf8 编码的浏览器中都得到了相同的行为。我可以查看原始响应并查看问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T01:04:04.733

如果

```
UTF8: \xC3\x86 (195 134) - LATIN CAPITAL LETTER AE (U+00C6) 
```

转换为`198`，看起来它被解释为：

```
ISO-8859-1       \xC6 198    UTF8: \xC3\x86        LATIN CAPITAL LETTER AE (U+00C6)
ISO-8859-4       \xC6 198    UTF8: \xC3\x86        LATIN CAPITAL LETTER AE (U+00C6)
ISO-8859-9       \xC6 198    UTF8: \xC3\x86        LATIN CAPITAL LETTER AE (U+00C6)
ISO-8859-15      \xC6 198    UTF8: \xC3\x86        LATIN CAPITAL LETTER AE (U+00C6)
Windows 1252     \xC6 198    UTF8: \xC3\x86        LATIN CAPITAL LETTER AE (U+00C6)
Windows 1254     \xC6 198    UTF8: \xC3\x86        LATIN CAPITAL LETTER AE (U+00C6)
Windows 1258     \xC6 198    UTF8: \xC3\x86        LATIN CAPITAL LETTER AE (U+00C6) 
```

选择其中任何一个，都匹配`LATIN CAPITAL LETTER AE`在代码点 198 十进制。

检查 PHP 输出的编码设置以及所有设置为 UTF-8 的数据库客户端连接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T01:24:19.363

我怀疑 PDO 连接是罪魁祸首，但我认为我的初始化代码已经覆盖了我。事实证明，它并不适用于所有平台。除了添加“set names 'utf8'”作为 PDO 属性之外，您还（或相反）需要在使用 PDO 引用之前使用命令实际执行查询。

```
// This doesn't seem to work on all platforms
$pdo->setAttribute(PDO::MYSQL_ATTR_INIT_COMMAND, "SET NAMES 'utf8'");

// This seems like a hack, but it works on GoDaddy Linux Hosting
$sth = $pdo->prepare("set names 'utf8'");
$sth->execute(); 
```

# linux - 2个线程可以同时运行吗？还是只有 1 个？（考虑到超线程的可能性）

> ID：10183675
> 
> 赞同：0
> 
> 时间：2012-04-17T00:50:44.877
> 
> 标签：linux, multithreading, cpu, multicore

以下是输出，`cat /etc/cpuinfo`并没有说明核心是否超线程。如何确定两个线程是否可以同时运行？

```
processor   : 0
vendor_id   : GenuineIntel
cpu family  : 6
model       : 26
model name  : Intel(R) Xeon(R) CPU           E5507  @ 2.27GHz
stepping    : 5
microcode   : 0x11
cpu MHz     : 2266.750
cache size  : 4096 KB
physical id : 0
siblings    : 1
core id     : 0
cpu cores   : 1
apicid      : 0
initial apicid  : 6
fpu     : yes
fpu_exception   : yes
cpuid level : 11
wp      : yes
flags       : fpu de tsc msr pae cx8 sep cmov pat clflush mmx fxsr sse sse2 ss ht syscall nx lm constant_tsc up rep_good nopl nonstop_tsc pni ssse3 cx16 sse4_1 sse4_2 popcnt hypervisor lahf_lm
bogomips    : 4533.50
clflush size    : 64
cache_alignment : 64
address sizes   : 40 bits physical, 48 bits virtual
power management: 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-08T11:29:10.397

> 如何确定两个线程是否可以同时运行？

如果只有处理器：0，那么你有一个物理 CPU。这意味着一次只能真正运行一个线程。引用[超线程上的维基百科页面](http://en.wikipedia.org/wiki/Hyper-threading)：

> 它们在操作系统看来是两个处理器，因此操作系统可以同时调度两个进程。此外，两个或多个进程可以使用相同的资源。如果一个进程失败，那么资源可以很容易地重新分配。

所以我很确定即使使用超线程，它们也会在您的 EC2 虚拟机中显示为多个 CPU 条目：处理器：1，处理器：2，...如果它们存在。

# sql - 如何将 JSP 连接到 MS Access 数据库？

> ID：10183679
> 
> 赞同：0
> 
> 时间：2012-04-17T00:51:03.523
> 
> 标签：sql, jsp, ms-access

我在使用以下 JSP 代码创建表时遇到问题。该错误与我的代码的第 17 行有关。我已经包含了我得到的错误以及我的代码。任何帮助深表感谢！

**我的代码**

```
<%@ page import="java.sql.*" %>
<%
 String url = "jdbc:odbc:productDSN";
 String username="";
 String password="";
 Connection  conn=null;
 String classpath = "sun.jdbc.odbc.JdbcOdbcDriver";
try{
    Class.forName(classpath);
    conn = DriverManager.getConnection(url,username,password);
   }catch(Exception exc){
     out.println(exc.toString());
}

%>
<%
    Statement stm= conn.createStatement();
    String query1, query2;
    query1="CREATE TABLE product(id char(3) PRIMARY KEY,"+
           "name varchar(15),model varchar(5), price float,"+
           "manufacturerID integer)";
    query2="CREATE TABLE manufacturer("+
  "manufacturerID integer PRIMARY KEY,"+
      "name varchar(15),address varchar(20), city varchar(20),"+
      "state varchar(15), zipCode char(5), phone varchar(15))";
try{
stm.executeUpdate(query1);
stm.executeUpdate(query2);

  out.println("Two tables were successfully created.");
}catch(Exception exc){
  out.println("These tables exist already.");
}
stm.close();
conn.close();
%> 
```

**错误**

```
HTTP Status 500 -

type Exception report

message

description The server encountered an internal error () that prevented it from fulfilling this request.

exception

org.apache.jasper.JasperException: An exception occurred processing JSP page /example1.jsp at line 17

14: 
15: %>
16: <%
17:     Statement stm= conn.createStatement();
18:     String query1, query2;
19:     query1="CREATE TABLE product(id char(3) PRIMARY KEY,"+
20:            "name varchar(15),model varchar(5), price float,"+

Stacktrace:
    org.apache.jasper.servlet.JspServletWrapper.handleJspException(JspServletWrapper.java:567)
    org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:471)
    org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:389)
    org.apache.jasper.servlet.JspServlet.service(JspServlet.java:333)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
root cause

java.lang.NullPointerException
    org.apache.jsp.example1_jsp._jspService(example1_jsp.java:82)
    org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
    org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:433)
    org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:389)
    org.apache.jasper.servlet.JspServlet.service(JspServlet.java:333)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
note The full stack trace of the root cause is available in the Apache Tomcat/7.0.21 logs.

Apache Tomcat/7.0.21 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T04:28:12.297

Your `Connection` is `NULL`

Have you created DSN ? If not then, Create the `System DSN` and then try again.

# ruby-on-rails-3 - Cabybara 和 Route 参数

> ID：10183683
> 
> 赞同：0
> 
> 时间：2012-04-17T00:51:16.533
> 
> 标签：ruby-on-rails-3, capybara

我有一个 Rails 3.0.10 应用程序，其中包含一些使用路由参数的前端表单，但我不知道如何让 capybara 访问这些动态路径。

路线.rb

```
match "weather/:region/:reporter" => "weather#new", :as => 'weather_report' 
```

在我的集成测试中，我有以下内容：

```
visit weather_report_path(:region => 'north', :reporter => 'alex' ) 
```

这给了我一个

```
NoMethodError:
       undefined method `weather_report' for #<RSpec::Core::ExampleGroup::Nested_1::Nested_1:0x007f97084a3e08> 
```

如果我试图在集成测试中硬编码路径

前任：`visit 'weather/southeast/alex'`

capybara 进入主页...

任何正确方向的指导将不胜感激。

# mysql - 限制组数据

> ID：10183686
> 
> 赞同：1
> 
> 时间：2012-04-17T00:51:49.637
> 
> 标签：mysql, group-by, limit

我正在尝试编写一个将返回一个问题及其所有相应答案的 sql 语句。在下面的示例中，我对它进行了硬编码，`subject_id`但它会被动态设置。

我想将结果限制为只有 5 个问题，但如果我只是添加`LIMIT 5`它，则将返回的整个数据限制为 5，这不是我想要的。

```
SELECT q.id,q.question,a.question_id,a.answer, a.correct
FROM questions q
JOIN answers a ON q.id = a.question_id
WHERE q.subject_id = 18 
GROUP BY q.id,a.id 
```

我还想实现其他目标，但我不确定在业务逻辑（php）中实现它是否会更好。我想返回每个问题的正确答案（a.correct = 1）加上随机的 3 个错误答案（正确 = 0）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T00:54:40.520

对于第一个问题：您需要`LIMIT`在子查询中分别将 应用于问题表。

```
 SELECT q.id,q.question,a.question_id,a.answer, a.correct
    FROM (SELECT * FROM questions q WHERE q.subject_id = 18
          ORDER BY RAND() LIMIT 5) q
    JOIN answers a on q.id = a.question_id
GROUP BY q.id, a.id 
```

# c# - 如何使用 Windows SDK 更新“附加时钟”设置

> ID：10183688
> 
> 赞同：3
> 
> 时间：2012-04-17T00:51:52.843
> 
> 标签：c#, .net, windows, winapi

我正在尝试在旅行时自动在不同时区之间移动，并且很好奇是否有人知道如何使用 Windows API/SDK 更新“附加时钟”设置。我将使用 .NET 和 C#，但肯定也会对原始 API 调用感到满意。谢谢！

![Windows 日期和时间控制面板中的附加时钟设置](../Images/4081cf867c9ee1968ca028496614910b.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T01:24:08.373

这不是它的工作原理。如果每个像这样的小调整对话框都有一个 api，winapi 将会变得庞大。相反，对话框会更改注册表项，这些注册表项稍后会被显示时钟的任何代码读回。

您可以通过运行 SysInternals 的 ProcMon 找到它们。在单击“应用”按钮之前启动它，然后立即停止它。您可以轻松找到跟踪中使用的 HCKU\Control Panel\DateTime\AdditionalClocks。将对话框中的设置映射到注册表值非常简单。

破解属于 Windows 的注册表项是非常困难的。但是，只要您不希望这在 Windows 的下一个版本中仍然有效，您就可以侥幸成功。实际上更改它们可能需要注销和登录才能使更改生效，我没有尝试过。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-02-16T17:39:29.483

这里的 FWIW 是一个 PowerShell cmd，它从注册表中获取额外的时钟设置：

```
Get-ChildItem -Path "HKCU:\Control Panel\TimeDate\AdditionalClocks" 
```

# php - 使用文件结果从 MVC 中的另一台服务器强制下载文件

> ID：10183695
> 
> 赞同：1
> 
> 时间：2012-04-17T00:52:58.513
> 
> 标签：php, model-view-controller, file, http

我有问题。我有两个完全独立的网站，一个是使用 MVC2 用 .Net 编写的，另一个是用 PHP 编写的。

我的 MVC 站点中有指向我的 PHP 站点中的媒体文件的链接，并且我试图找到一种方法来在用户单击这些链接时强制下载。

我怎么能在 MVC 中做到这一点？我了解如何返回这样的 FileResult：

```
 public FileResult Download(string path)
 {
        var contentType = "audio/mp3";

        FilePathResult result = new FilePathResult(Server.MapPath("~/Content/" 
                                                    + path), contentType);
        result.FileDownloadName = path;
        return result;
 } 
```

但是 Server.MapPath 要求文件托管在 MVC 服务器上。

**附录**

我还尝试在房子的 .php 端执行此操作，使用 download.php?file=filepath 并以这种方式设置内容标题。但是，我不断收到“无法修改标头信息 - 标头已发送”错误。 [我在 SO 上创建了一个单独的问题，询问为什么会这样。](https://stackoverflow.com/q/10183923/356544)

# c# - 图标在运行时未以派生的 Windows 形式显示

> ID：10183696
> 
> 赞同：1
> 
> 时间：2012-04-17T00:53:01.037
> 
> 标签：c#, winforms

我有一个 C# 应用程序，其中我的一个表单图标在设计器中可见，但在运行时恢复为默认图标。有问题的表单是派生表单，没有自己的 .designer.cs 文件，派生表单 .cs 文件为空。表单图标在设计器中正确显示，但在运行时图标丢失。

派生形式与基本形式在不同的项目中。基本表单图标是通过设计器添加的，并且未对基本 .designer.cs 文件进行任何修改。

有什么想法可能导致这种情况吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T21:59:05.967

在混了一会儿之后，我认为我的问题与 VS 中的这个错误有关：[https ://connect.microsoft.com/VisualStudio/feedback/details/106264/mdi-form-icon-formborderstyle-windowstate-maximized#tabs](https://connect.microsoft.com/VisualStudio/feedback/details/106264/mdi-form-icon-formborderstyle-windowstate-maximized#tabs)

我通过将 Icon 重新添加到派生表单（使用设计器）来解决我的问题，然后还必须添加一个 _Load 处理程序，其中包含以下内容

```
System.ComponentModel.ComponentResourceManager resources = new System.ComponentModel.ComponentResourceManager(typeof(MyForm));
this.Icon = ((System.Drawing.Icon)(resources.GetObject("$this.Icon"))); 
```

做这项工作，虽然我不喜欢 hacky 变通办法！

# ssrs-2008 - 如何在运行时将 SSRS 连接到 ReportViewer 2010？

> ID：10183697
> 
> 赞同：0
> 
> 时间：2012-04-17T00:53:20.043
> 
> 标签：ssrs-2008, reportviewer

我的代码如下所示，编译后显示空白页面：

```
ReportViewerControl = new ReportViewer();
            ShowZoomControl="false"
            ReportViewerControl.ServerReport.ReportServerUrl = new Uri(ReportServerUri);
            ReportViewerControl.ServerReport.ReportPath = Model.Report.ReportPath;
            ReportViewerControl.Visible = true;
            ReportViewerControl.ShowReportBody = true;
            ReportViewerControl.ShowParameterPrompts = false;
            ReportViewerControl.ProcessingMode = ProcessingMode.Remote;
            ReportViewerControl.ShowZoomControl = false;
            ReportViewerControl.ShowBackButton = false;
            ReportViewerControl.InteractivityPostBackMode = InteractivityPostBackMode.AlwaysAsynchronous;
            ReportViewerControl.Height = 780;
            ReportViewerControl.Width = 800;

            IList<ReportParameter> FishSpeciesParameters = new List<ReportParameter>();
            ReportParameter SPStatus = new ReportParameter();
            SPStatus.Name = "SPStatus";
            if (Model.Report.ID == 8)
                SPStatus.Values.Add("T,E,C");
            ReportParameter FishCode = new ReportParameter();
            FishCode.Name = "FishCode";
            FishCode.Values.Add("11");
            FishSpeciesParameters.Add(SPStatus);
            FishSpeciesParameters.Add(FishCode);

            ReportViewerControl.ServerReport.SetParameters(FishSpeciesParameters);

            ReportViewerControl.ServerReport.Refresh(); 
```

有什么想法可以即时查看 SSRS 报告到 ReportViewer 中吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T14:23:51.647

maily，您只需将 ServerReport.ReportServerUrl 设置为如下所示：

`"http://localhost:8080/ReportServer"`

和报告路径

```
reportFolder + "/" + reportName; 
```

# gmock - 你做了什么来解决你提到的 gmock（附上链接）？

> ID：10183700
> 
> 赞同：0
> 
> 时间：2012-04-17T00:54:05.203
> 
> 标签：gmock

[在 Mac 上构建 Google 测试时出现链接错误（命令行）](https://stackoverflow.com/questions/9183540/linking-error-when-building-google-test-on-mac-commandline)

在底部，您编写了关于在同一台计算机上查找多个 gmock 安装的编辑，这弄乱了编译器的包含路径，因此它使用的是旧的 1.5 32 位版本而不是正确的版本。

我通过 brew 安装了我的；brew install gmock，一切正常，但我遇到了同样的问题。如果您能像您在帖子中提到的那样告诉我如何正确编译它，我会很高兴去给您一些赞成票，或者您可以编辑链接，我会阅读它（请在您阅读时通知我虽然做）。

我已经阅读了 googlemock google 代码页上的说明以及我下载的内容，以便尝试根据它进行构建。我已经搜索了很多，我找不到任何与你所说的接近的东西。

为了向你解释我在做什么，我写了一个非常简单的测试： [http ://codepad.org/zxBugY0w](http://codepad.org/zxBugY0w)

当我尝试使用本地包含的信息编译它时，我得到： http: [//pastebin.com/fqEZ6zTq](http://pastebin.com/fqEZ6zTq)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T08:35:39.810

您需要链接到 gtest 和 gmock。

在您的 g++ 命令中，您需要添加`-L <full path to gtest lib> -L <full path to gmock lib> -lgmock -lgtest`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T17:30:34.473

实际上，问题在于我没有链接到存档的编译版本 libgmock.a

一旦我链接，它工作得很好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T15:12:37.903

`brew`通过或根本不安装 gtest不是受支持的配置。gtest 的使用方式是让您将其包含在项目中并一起编译。然后，您链接到您的版本，保证使用相同的设置进行编译。

请参阅[http://code.google.com/p/googletest/wiki/FAQ#Why_is_it_not_recommended_to_install_a_pre-compiled_copy_of_Goog](http://code.google.com/p/googletest/wiki/FAQ#Why_is_it_not_recommended_to_install_a_pre-compiled_copy_of_Goog)

另外，请注意，您遇到的错误与您链接到的问题中的错误不同。该人收到错误，因为他们不小心链接到使用不同设置编译的版本。您根本没有链接它（尽管如果您继续`brew`配置，您可能会在路上看到类似的错误）。

# clojure - 执行“lein new”时遇到错误（在 Windows 上）

> ID：10183704
> 
> 赞同：2
> 
> 时间：2012-04-17T00:54:54.093
> 
> 标签：clojure, leiningen

其他命令如*lein repl*和*lein deps*等工作正常。

输出如下

C:\Users\test>lein 版本

Java 1.7.0 Java HotSpot(TM) 64 位服务器 VM 上的 Leiningen 2.0.0-preview3

C:\Users\test>lein new first

根据“默认”模板生成一个名为 first 的项目。java.lang.IllegalArgumentException：没有实现方法：：make-reader of protocol：#'clojure.java.io/IOFactory 找到类：clojure.core$_cache_protocol_fn.invoke(core_deftype.clj:495) at clojure .java.io$fn_7795 *$G*_7790__7802.invoke(io.clj:63) at clojure.java.io$reader.doInvoke(io.clj:96) at clojure.lang.RestFn.invoke(RestFn.java:410) at leiningen.new.templates$slurp_resource .invoke(templates.clj:29) at leiningen.new.templates$renderer$fn__713.doInvoke(templates.clj:79) at clojure.lang.RestFn.invoke(RestFn.java:423) at leiningen.new.default$ default.invoke(default.clj:15) at clojure.lang.Var.invoke(Var.java:401) at clojure.lang.AFn.applyToHelper(AFn.java:161) at clojure.lang.Var.applyTo(Var .java:518) at clojure.core$apply.invoke(core.clj:602) at leiningen.new$create.doInvoke(new.clj:54) at clojure.lang.RestFn.invoke(RestFn.java:425)在 clojure.lang 的 clojure.lang.AFn.applyToHelper(AFn.java:161) 的 leiningen.new$create.invoke(new.clj:47)。RestFn.applyTo(RestFn.java:132) at clojure.core$apply.invoke(core.clj:600) at leiningen.new$new.doInvoke(new.clj:101) at clojure.lang.RestFn.invoke(RestFn .java:421) 在 clojure.lang.Var.invoke(Var.java:405) 在 clojure.lang.AFn.applyToHelper(AFn.java:163) 在 clojure.lang.Var.applyTo(Var.java:518)在 clojure.core$apply.invoke(core.clj:602) 在 leiningen.core.main$resolve_task$fn__699.doInvoke(main.clj:66) 在 clojure.lang.RestFn.applyTo(RestFn.java:139) 在clojure.lang.AFunction$1.doInvoke(AFunction.java:29) 在 clojure.lang.RestFn.applyTo(RestFn.java:137) 在 clojure.core$apply.invoke(core.clj:602) 在 leiningen.core。 main$apply_task.invoke(main.clj:88) 在 leiningen.core.main$clj:600) at leiningen.new$new.doInvoke(new.clj:101) at clojure.lang.RestFn.invoke(RestFn.java:421) at clojure.lang.Var.invoke(Var.java:405) at clojure.lang.AFn.applyToHelper(AFn.java:163) at clojure.lang.Var.applyTo(Var.java:518) at clojure.core$apply.invoke(core.clj:602) at leiningen.core.main $resolve_task$fn__699.doInvoke(main.clj:66) at clojure.lang.RestFn.applyTo(RestFn.java:139) at clojure.lang.AFunction$1.doInvoke(AFunction.java:29) at clojure.lang.RestFn .applyTo(RestFn.java:137) at clojure.core$apply.invoke(core.clj:602) at leiningen.core.main$apply_task.invoke(main.clj:88) at leiningen.core.main$clj:600) at leiningen.new$new.doInvoke(new.clj:101) at clojure.lang.RestFn.invoke(RestFn.java:421) at clojure.lang.Var.invoke(Var.java:405) at clojure.lang.AFn.applyToHelper(AFn.java:163) at clojure.lang.Var.applyTo(Var.java:518) at clojure.core$apply.invoke(core.clj:602) at leiningen.core.main $resolve_task$fn__699.doInvoke(main.clj:66) at clojure.lang.RestFn.applyTo(RestFn.java:139) at clojure.lang.AFunction$1.doInvoke(AFunction.java:29) at clojure.lang.RestFn .applyTo(RestFn.java:137) at clojure.core$apply.invoke(core.clj:602) at leiningen.core.main$apply_task.invoke(main.clj:88) at leiningen.core.main$clojure.lang.Var.applyTo(Var.java:518) 的 clojure.lang.AFn.applyToHelper(AFn.java:163) 调用(Var.java:405)$apply.invoke(core.clj :602) 在 leiningen.core.main$resolve_task$fn__699.doInvoke(main.clj:66) 在 clojure.lang.RestFn.applyTo(RestFn.java:139) 在 clojure.lang.AFunction$1.doInvoke(AFunction.java :29) at clojure.lang.RestFn.applyTo(RestFn.java:137) at clojure.core$apply.invoke(core.clj:602) at leiningen.core.main$apply_task.invoke(main.clj:88)在 leiningen.core.main$clojure.lang.Var.applyTo(Var.java:518) 的 clojure.lang.AFn.applyToHelper(AFn.java:163) 调用(Var.java:405)$apply.invoke(core.clj :602) 在 leiningen.core.main$resolve_task$fn__699.doInvoke(main.clj:66) 在 clojure.lang.RestFn.applyTo(RestFn.java:139) 在 clojure.lang.AFunction$1.doInvoke(AFunction.java :29) at clojure.lang.RestFn.applyTo(RestFn.java:137) at clojure.core$apply.invoke(core.clj:602) at leiningen.core.main$apply_task.invoke(main.clj:88)在 leiningen.core.main$applyTo(RestFn.java:139) at clojure.lang.AFunction$1.doInvoke(AFunction.java:29) at clojure.lang.RestFn.applyTo(RestFn.java:137) at clojure.core$apply.invoke(core. clj:602) 在 leiningen.core.main$apply_task.invoke(main.clj:88) 在 leiningen.core.main$applyTo(RestFn.java:139) at clojure.lang.AFunction$1.doInvoke(AFunction.java:29) at clojure.lang.RestFn.applyTo(RestFn.java:137) at clojure.core$apply.invoke(core. clj:602) 在 leiningen.core.main$apply_task.invoke(main.clj:88) 在 leiningen.core.main$*main$fn* _731.invoke(main.clj:140) at leiningen.core.main$_main.doInvoke(main.clj:140) at clojure.lang.RestFn.invoke(RestFn.java:421) at clojure.lang。 Var.invoke(Var.java:405) at clojure.lang.AFn.applyToHelper(AFn.java:163) at clojure.lang.Var.applyTo(Var.java:518) at clojure.core$apply.invoke(core .clj:600) at clojure.main$main_opt.invoke(main.clj:323) at clojure.main$main.doInvoke(main.clj:426) at clojure.lang.RestFn.invoke(RestFn.java:457)在 clojure.lang.Var.invoke(Var.java:413) 在 clojure.lang.AFn.applyToHelper(AFn.java:172) 在 clojure.lang.Var.applyTo(Var.java:518) 在 clojure.main。主要（main.java:37）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T23:52:32.470

我遇到了类似的问题并通过切换到 lein 1.7.1 解决了它。

尝试下载[https://raw.github.com/technomancy/leiningen/stable/bin/lein.bat](https://raw.github.com/technomancy/leiningen/stable/bin/lein.bat)，然后运行：

```
lein self-install 
```

# django - 在 haystack 中的 search_indexes.py 中设置“字段”和设置“facet=true”有什么区别？

> ID：10183705
> 
> 赞同：0
> 
> 时间：2012-04-17T00:54:54.797
> 
> 标签：django, django-haystack, faceted-search

我对 search_indexes.py 中的 'field' 和 'facet=true' 感到困惑

设置诸如 name=CharField(max_length=100) 之类的字段使我能够提供带有用户可以深入了解的名称的链接（窄搜索结果）？

和 facet=true 给我该字段的结果计数？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T04:39:09.920

简短的回答是肯定的。然后你可以`SearchQuerySet`像

```
sqs = sqs.facet(field_to_facet).facet_count() 
```

# jasperserver - 如何在 jasper 报表服务器中配置多个数据源

> ID：10183706
> 
> 赞同：0
> 
> 时间：2012-04-17T00:55:05.470
> 
> 标签：jasperserver

我已经看到了如何使用 mysql、oracle 和其他配置 jasper 报告服务器的教程。当我开始安装 jasperserver 4.5 时。它只显示 postgresql 数据源。我有多个数据源连接到我的报告。我不知道如何配置其他数据源。如何在 jasper 服务器报告中配置所有数据源？有人知道吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T17:40:07.893

阿明，

检查此操作方法[http://jasperforge.org/plugins/mwiki/index.php/Jasperserver/DataSources](http://jasperforge.org/plugins/mwiki/index.php/Jasperserver/DataSources)它将指导您创建新的所需步骤`datasource`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T10:53:52.770

该工具允许从 de shell 创建数据源。 [http://sourceforge.net/projects/jaspertools/?source=directory](http://sourceforge.net/projects/jaspertools/?source=directory)

再见。

# debugging - Magento：标头已经发送，正在调试，试图理解输出

> ID：10183707
> 
> 赞同：0
> 
> 时间：2012-04-17T00:55:13.753
> 
> 标签：debugging, magento, header

我知道关于这个主题的一些帖子 - 其中最全面的是[这里](https://stackoverflow.com/questions/4670031/magento-debug-headers-already-sent-error)。

我特别的小鬼看起来像这样：（无需进一步记录）

```
2012-04-17T00:28:50+00:00 DEBUG (7): HEADERS ALREADY SENT: <pre>[0] /domains/bodhi.uk.com/subdomains/dev/app/code/core/Mage/Core/Controller/Response/Http.php:51
[1] /domains/bodhi.uk.com/subdomains/dev/lib/Zend/Controller/Response/Abstract.php:766
[2] /domains/bodhi.uk.com/subdomains/dev/app/code/core/Mage/Core/Controller/Response/Http.php:89
[3] /domains/bodhi.uk.com/subdomains/dev/app/code/core/Mage/Core/Controller/Varien/Front.php:188
[4] /domains/bodhi.uk.com/subdomains/dev/app/code/core/Mage/Core/Model/App.php:349
[5] /domains/bodhi.uk.com/subdomains/dev/app/Mage.php:640
[6] /domains/bodhi.uk.com/subdomains/dev/index.php:80 
```

这可能会在加载 dev.bodhi.uk.com 上的主页时发生

按照链接帖子中接受的答案，创建一个包含大约 500 个文件的列表 - 这不是一种实用的调试方法（特别是当我在查看它时可能无法识别问题时 - 我目前假设我正在寻找用于 a 之前的空格

作为参考，上面的输出在[pastebin上](http://pastebin.com/KRXPhun8)

使用最后一条评论中的建议（似乎适用于 OP），并添加：

```
 $headers = array();
foreach ($this->_headers as $i => $header) {
    $headers[$header['name']] = $header;
}
$this->_headers = array_values($headers);
Mage::Log(array_values($headers)); 
```

给出了意想不到的回应：

```
2012-04-17T00:28:50+00:00 DEBUG (7): Array
(
[0] => Array
    (
        [name] => Content-Type
        [value] => text/html; charset=UTF-8
        [replace] => 
    )

) 
```

最终我需要防止这个错误，我正在为下一步而努力！

PS：我也尝试了 Alan 在评论 1 中的回应，但是 Abstract.php 的格式已经改变（我使用的是 1.6.2 版本），并且由于我没有得到进一步的输出，我怀疑我没有正确记录事情。

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T08:51:01.343

尝试 ob_start() 它可能对您有帮助，只需将此代码放在文件顶部

# java - 如何使 JLabel 可点击？

> ID：10183719
> 
> 赞同：5
> 
> 时间：2012-04-17T00:56:42.777
> 
> 标签：java, swing, jlabel, mouseover, mouse-cursor

我想自定义一个 JLable 以使他可点击，我不是在谈论添加一个动作侦听器，因为我已经有了，我说的是当 JLabel 获得焦点时更改鼠标光标的反应，就像鼠标悬停在上面的反应一样浏览器中的链接。

![在此处输入图像描述](../Images/578e3ee48aba65c863f36fab3ce7aaf3.png)

我有挥杆不可能的印象。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-17T01:02:16.823

怎么样：

```
label.setCursor(Cursor.getPredefinedCursor(Cursor.HAND_CURSOR)); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-17T01:03:44.947

Swing API 有办法做到这一点：

```
label.setCursor(Cursor.getPredefinedCursor(Cursor.HAND_CURSOR)); 
```

当你改变主意时：

```
label.setCursor(Cursor.getDefaultCursor()); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-04-17T01:02:24.360

> 我有挥杆不可能的印象。

或者，也许您只是还没有学会如何做到这一点？MouseListener 和 MouseMotionListener 对我来说非常有用。

编辑：并按照 Max 的说明设置 JLabel 的光标——为他投票 1+！

# javascript - CSS：使背景图像慢慢淡出

> ID：10183720
> 
> 赞同：0
> 
> 时间：2012-04-17T00:56:58.180
> 
> 标签：javascript, html, css, animation

我在这里处理遗留代码，不能使用 jQuery、CSS3 或 HTML5。

我正在为 HTML 中的输入字段使用背景图像。我试图在这里实现某种动画，图像最初出现并在“n”秒后慢慢消失。

我拥有的示例 CSS 代码是：

```
.acceptValue {
  background-image: url('../../images/accept.gif');
  background-repeat: no-repeat;
  background-position: right;
  padding-right: 20px;
} 
```

我希望将上面的 CSS 属性应用 'n' 秒，然后它应该消失。

有没有办法让这个在 IE7 和 IE8 中工作？我想要 CSS 定义中的 SetTimeout 之类的东西，其中图像（accept.gif）只出现几秒钟。

请告诉我。

# excel - 是否可以在 Excel 公式中使用单元格值作为工作簿/工作表参考？

> ID：10183722
> 
> 赞同：1
> 
> 时间：2012-04-17T00:57:06.623
> 
> 标签：excel, vba

假设我有一个名为“参考”的工作表。此工作表的单元格 B2 的值为 ，
`"C:\Documents\Workbook1.xlsx"`工作
簿的路径。

在同一工作簿中的另一张工作表上，我想要一个公式，该公式获取工作表的单元格 A1 的`"Sheet 1"`值`Workbook1.xlsx`。是否可以让公式查找值`'References'!B2`并将其用作参考。

即我希望公式类似于

```
='['References'!B2]Sheet 1'!A1 
```

我试过使用这个`CELL()`公式，但似乎无法让它以这种方式工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T01:05:04.103

假设引用的工作簿已打开，您可以使用[INDIRECT()](http://support.microsoft.com/kb/213933)函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T01:21:24.710

由于这是一个变量引用，我认为您的源工作簿可能已关闭。

附件是 Excel Daily Dose of Excel 的摘要（以及链接发生变化时的屏幕截图），涵盖如何从已关闭的工作簿中提取变量引用。请参阅[INDIRECT 和已关闭的工作簿](http://www.dailydoseofexcel.com/archives/2004/12/01/indirect-and-closed-workbooks/)

提供了三个选项：

1.  Laurent Longre 开发了包含函数 INDIRECT.EXT的免费插件[MOREFUNC.XLL](http://longre.free.fr/English/)
2.  SQL.请求
3.  Harlan Grove 的[PULL](http://tinyurl.com/63xon)功能：

![在此处输入图像描述](../Images/f8e778d1306d1948b363c29ada57cc7d.png)

# git - Git存储库的遥控器列表？

> ID：10183724
> 
> 赞同：670
> 
> 时间：2012-04-17T00:58:00.883
> 
> 标签：git

我有一个 Git 存储库。这个存储库有多个远程存储库（我认为）。如何获取属于所述存储库的远程存储库列表？

像`git list --remotes`或类似的东西？

* * *

## 回答 #1

> 赞同：924
> 
> 时间：2012-04-17T01:01:02.380

您可以使用命令获取任何已配置远程 URL 的列表`git remote -v`。

这将为您提供以下内容：

```
base    /home/***/htdocs/base (fetch)
base    /home/***/htdocs/base (push)
origin  git@bitbucket.org:*** (fetch)
origin  git@bitbucket.org:*** (push) 
```

* * *

## 回答 #2

> 赞同：90
> 
> 时间：2013-10-03T11:32:35.427

如果您只需要远程存储库的名称（而不需要任何其他数据），那么简单`git remote`就足够了。

```
$ git remote
iqandreas
octopress
origin 
```

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2016-10-27T14:31:36.290

到目前为止的答案告诉你如何找到现有的分支：

```
git branch -r 
```

或同一项目的存储库*[见下面的注释]*：

```
git remote -v 
```

还有另一种情况。您可能想了解托管在同一服务器上的其他项目存储库。

为了发现这些信息，我使用 SSH 或[PuTTY](http://en.wikipedia.org/wiki/PuTTY)登录到主机并`ls`查找包含其他存储库的目录。例如，如果我通过键入以下内容克隆了一个存储库：

```
git clone ssh://git.mycompany.com/git/ABCProject 
```

并且想知道还有什么可用的，我通过 SSH 或 PuTTY 登录 git.mycompany.com 并输入：

```
ls /git 
```

假设`ls`说：

```
 ABCProject DEFProject 
```

我可以使用命令

```
 git clone ssh://git.mycompany.com/git/DEFProject 
```

以访问其他项目。

> 注意：通常`git remote`只是简单地告诉我`origin`——我从中克隆项目的存储库。 `git remote`如果您与两个或多个从事同一项目的人合作并直接访问彼此的存储库而不是通过源传递所有内容，这将很方便。

* * *

## 回答 #4

> 赞同：34
> 
> 时间：2014-01-31T10:06:54.450

FWIW，我有完全相同的问题，但我在这里找不到答案。它可能不是便携式的，但至少对于 gitolite，我可以运行以下命令来获得我想要的：

```
$ ssh git@git.xxx.com info
hello akim, this is gitolite 2.3-1 (Debian) running on git 1.7.10.4
the gitolite config gives you the following access:
     R   W     android
     R   W     bistro
     R   W     checkpn
... 
```

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2013-11-21T00:45:20.680

查看远程分支的一种简单方法是：

```
git branch -r 
```

查看本地分支：

```
git branch -l 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2020-06-04T03:06:02.703

这些方法都不能像提问者要求的那样起作用，而我也经常需要这种方法。例如：

```
$ git remote
fatal: Not a git repository (or any of the parent directories): .git
$ git remote user@bserver
fatal: Not a git repository (or any of the parent directories): .git
$ git remote user@server:/home/user
fatal: Not a git repository (or any of the parent directories): .git
$ git ls-remote
fatal: No remote configured to list refs from.
$ git ls-remote user@server:/home/user
fatal: '/home/user' does not appear to be a git repository
fatal: Could not read from remote repository.

Please make sure you have the correct access rights
and the repository exists. 
```

这样做的全部意义在于，除了远程用户和服务器之外，您没有任何信息，并且想要找出您可以访问的内容。

大多数答案都假设您是从 git 工作集中进行查询的。提问者假设你不是。

作为一个实际示例，假设服务器上有一个存储库 foo.git。有智慧的人决定需要将其更改为 foo2.git。在服务器上做一个 git 目录的列表真的很好。是的，我看到了 git 的问题。尽管如此，它仍然会很好。

# hadoop - RecommenderJob 引发的 ClassNotFoundException（Hadoop 上的 Apache Mahout）

> ID：10183726
> 
> 赞同：1
> 
> 时间：2012-04-17T00:58:05.637
> 
> 标签：hadoop, classnotfoundexception, mahout

我正在使用 org.apache.mahout.cf.taste.hadoop.pseudo.RecommenderJob.java 文件来运行伪分布式推荐器。我正在使用它来运行 GenericItemsRecommender 类。

我正在使用的命令是

> bin/hadoop jar mahout-core-0.7-SNAPSHOT-job org.apache.mahout.cf.taste.hadoop.pesudo.RecommenderJob -Dmapred.input.dir=./ratingsLess.txt -Dmapred.output.dir=/input/输出 --tempDir /input/tmp --recommenderClassName org.apache.mahout.cf.taste.impl.recommender.GenericItemBasedRecommender

当我运行它时，我得到一个异常说：

> 线程“main”中的异常 java.lang.ClassNotFoundException: org.apache.mahout.cf.taste.hadoop.pesudo.RecommenderJob at java.net.URLClassLoader$1.run(URLClassLoader.java:202) at java.security.AccessController。 doPrivileged(Native Method) at java.net.URLClassLoader.findClass(URLClassLoader.java:190) at java.lang.ClassLoader.loadClass(ClassLoader.java:306) at java.lang.ClassLoader.loadClass(ClassLoader.java:247)在 java.lang.Class.forName0(Native Method) 在 java.lang.Class.forName(Class.java:247) 在 org.apache.hadoop.util.RunJar.main(RunJar.java:149)

你能告诉我为什么我会收到这个错误吗？

# c# - Linq 和 ListView 并包含

> ID：10183727
> 
> 赞同：2
> 
> 时间：2012-04-17T00:58:07.247
> 
> 标签：c#, linq

我有一个表“资产”和一个填充了类别的“列表视图”（assetCategoriesListView）。

我正在尝试使用类别选择来选择所有资产：

```
Assets myAsset = dbLinqManager.db.Assets.Where(a => assetCategoriesListView.CheckedIndices.Contains(a.Category)).First(); 
```

但似乎包含不能使用。有谁知道解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T02:38:33.377

你陷入了时代错误。ListView 类可以追溯到 .NET 1.0，这是泛型可用之前的黑暗日子。CheckedIndices 属性属于 ListView.CheckedIndexCollection 类型，它只实现 IEnumerable，而不是 IEnumerable<>。这就是 Contains() 不起作用的原因。

您通常可以使用 Cast() 扩展方法来修复它。但是 CheckedIndices 包含整数，而不是对象。CheckedItems 包含 ListViewItems。尚不清楚您计划如何将它们映射到“资产”。专注于将数据与视图分开。

# ms-word - MS Word - 创建模板文本

> ID：10183728
> 
> 赞同：2
> 
> 时间：2012-04-17T00:58:17.713
> 
> 标签：ms-word

我需要创建类似 的文本行`[Insert text here]`，但是当您单击这些括号之间的*任意位置时，***整个括号（包括文本）**都会突出显示。如果您使用 Words 的某些模板，这些句子会显示为占位符。这就是我想要完成的；占位符文本。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-17T23:31:36.820

键入`Ctrl`+ ...在括号内`F9`键入文本。`[macrobutton nomacro "your text here"]`

`Alt`+`F9`将打开和关闭代码。

# android - 通过 tmomail.net 发送的短信的“发件人”标签

> ID：10183735
> 
> 赞同：0
> 
> 时间：2012-04-17T01:00:11.097
> 
> 标签：android, sms, broadcast, mms, intercept

它显示了从电子邮件服务 ex 发送的消息的真正“发件人”标签。7135192435@tmomail.net 有一个不同的“发件人”标签，然后是通过 SMS 收到消息后消息详细信息显示的内容。我希望能够通过 tmomail.net 接收 SMS 消息，但缺少的链接在于手机所看到的“发件人”标签。我已成功收到其他手机的短信，我的广播接收器收到了它们。但是，我无法正确设置“发件人”过滤器以通过 tmomail.net 接收这些文本。提前感谢所有诺贝尔 android 向导，他们可能会从他们的项目中抽出时间来提供帮助。下面是代码...

```
public class SmsReceiver extends BroadcastReceiver {

    @Override
    public void onReceive(Context context, Intent intent) {

        // ---get the SMS message passed in---

        Bundle bundle = intent.getExtras();
        SmsMessage[] msgs = null;
        String str = "";

        Log.d("SMS_Project", "Beginning fired!");

        if (bundle != null) {
            // ---retrieve the SMS message received---
            Object[] pdus = (Object[]) bundle.get("pdus");
            msgs = new SmsMessage[pdus.length];
            for (int i = 0; i < msgs.length; i++) {

                msgs[i] = SmsMessage.createFromPdu((byte[]) pdus[i]);

                String mFrom = msgs[i].getOriginatingAddress();
                String mBody = msgs[i].getMessageBody().toString();

                Log.d("SMS_Project", "The From tag follows this line");

                if (mFrom.equals("JimJohanson@JollyRanchers.com"))   {

                    Log.d("SMS_Project", "above is the from tag");

                    if (mBody.indexOf("1") == 0) {
                        str += "SMS from '" + mFrom + "'";
                        str += " :";
                        str += mBody;                   

                        str += "\n";

                        // ---display the new SMS message---
                        Log.d("SMS_Project", "Toast anyone?");
                        Toast.makeText(context, str, Toast.LENGTH_LONG).show();
                        this.abortBroadcast();

                    }
                }
            }
        }
    Log.d("SMS_Project", "No toast yet");} 
```

清单信息：

```
<receiver android:name=".SmsReceiver" >
            <intent-filter android:priority="99999999" >
                <action android:name="android.provider.Telephony.SMS_RECEIVED" />
            </intent-filter>
        </receiver> 
```

这些是我的权限：

```
<uses-permission android:name="android.permission.RECEIVE_SMS" /> 
```

我怀疑问题是手机缺乏将电子邮件翻译成合法短信的能力。也许它是多媒体消息类型？在我开始之前，我将继续梳理蓝色。如果您对我到目前为止的内容有任何疑问。请告诉我。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T21:53:10.987

我将尝试通过 mFrom 字符串和 Log.d 进行检查。对于遇到这个我的其他人

//插入...

```
Log.d("SMS_Project", mFrom); 
```

//正上方...

```
(mFrom.equals("JimJohanson@JollyRanchers.com")) 
```

希望这会给我一个准确且一致的“来自”标签，以便准确地捕获结果。不敢相信我花了这么长时间才想出这么简单的测试。提示，学习如何正确调试和使用 LogCat 是任何高于复制/粘贴专业人士的必需品。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T01:18:41.617

好吧，请忽略我过去的所有下巴……对此的答案是使用 getEmailFrom() 函数。

例子 ：

```
msgs[i] = SmsMessage.createFromPdu((byte[]) pdus[i]);

String mFrom = msgs[i].getOriginatingAddress();
String mBody = msgs[i].getMessageBody().toString();
String mEmail = msgs[i].getEmailFrom().toString();
*Boolean mSomething = msgs[i].isEmail();*

Log.d("SMS_Project_From", mFrom);
Log.d("SMS_Project_mBody", mBody);
*Log.d("SMS_Project_Email", mEmail);* 
```

这包括 Logcat，以便您可以准确识别电子邮件的来源。

# javascript - 加载电影后启用 Youtube 的 JS API

> ID：10183736
> 
> 赞同：0
> 
> 时间：2012-04-17T01:00:13.440
> 
> 标签：javascript, jquery, asynchronous, youtube, youtube-api

我希望控制我页面上的视频，其中一些视频最初可能没有嵌入 (enablejsapi) 上的 JavaScript API 参数。它们可能同时出现在 iframe 或旧的对象嵌入类型中，尽管这无关紧要。

我环顾四周，似乎没有一个符合我的标准，[在现有播放器上启用 YouTube API](https://stackoverflow.com/questions/3372574/enable-youtube-api-on-existing-player) - 他的回答重新启动播放器（使用 apienabled 重新创建元素）

我很难处理这里的文档[https://developers.google.com/youtube/iframe_api_reference](https://developers.google.com/youtube/iframe_api_reference)和[https://developers.google.com/youtube/js_api_reference](https://developers.google.com/youtube/js_api_reference) 似乎都专注于不相关的东西。没有关于 API 实际如何处理元素的技术细节，所以我很难猜测到哪里去。Google 的 JavaScript API 不是第一次给我带来困难，当然也不是最后一次

因此，我希望能够控制或至少部分控制（收听播放/停止事件）页面上当前首次嵌入时没有向他们请求 API 的播放器。有没有办法为他们实时启用 JavaScript API？或破解它的方式？

更新：到目前为止，我的进展围绕着使用 API 重新创建页面上的元素，这是我极力避免的一种技术。我仍然面临着各种各样的对象/iframe api 差异，这让我想改变我的职业生涯，所以需要更多的润色。当我弄清楚一切时，我会粘贴一些咖啡代码。这没什么太花哨的，但如果你愿意的话，它是向一个充满现有嵌入式视频的页面添加“全局监听器”的唯一通用方法，不一定在其中启用 API。

**TLDR（太久没读）**：Youtube API 不完善。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-20T01:31:28.127

如更新中所述，通过重新创建 embed/iframe 元素解决了这个问题。这里没有什么神奇之处——只需将 api 变量添加到 URL 中。不幸的是，我找不到更好的方法来启用它。

# c# - 如何确定一个类型是否是 HashSet 类型以及如何转换它？

> ID：10183738
> 
> 赞同：5
> 
> 时间：2012-04-17T01:00:40.747
> 
> 标签：c#, .net

我在 GitHub 上有人要求能够比较我在 GitHub 上的项目的 HashSet：[https](https://github.com/GregFinzer/Compare-Net-Objects/) ://github.com/GregFinzer/Compare-Net-Objects/ 。我需要能够确定一个类型是否是哈希集，然后获取枚举器。我不知道要把它投射到什么地方。这是我对 IList 的要求：

```
private bool IsIList(Type type)
{
    return (typeof(IList).IsAssignableFrom(type));
}

private void CompareIList(object object1, object object2, string breadCrumb)
{
    IList ilist1 = object1 as IList;
    IList ilist2 = object2 as IList;

    if (ilist1 == null) //This should never happen, null check happens one level up
        throw new ArgumentNullException("object1");

    if (ilist2 == null) //This should never happen, null check happens one level up
        throw new ArgumentNullException("object2");

    try
    {
        _parents.Add(object1);
        _parents.Add(object2);

        //Objects must be the same length
        if (ilist1.Count != ilist2.Count)
        {
            Differences.Add(string.Format("object1{0}.Count != object2{0}.Count ({1},{2})", breadCrumb,
                                              ilist1.Count, ilist2.Count));

            if (Differences.Count >= MaxDifferences)
                return;
        }

        IEnumerator enumerator1 = ilist1.GetEnumerator();
        IEnumerator enumerator2 = ilist2.GetEnumerator();
        int count = 0;

        while (enumerator1.MoveNext() && enumerator2.MoveNext())
        {
            string currentBreadCrumb = AddBreadCrumb(breadCrumb, string.Empty, string.Empty, count);

            Compare(enumerator1.Current, enumerator2.Current, currentBreadCrumb);

            if (Differences.Count >= MaxDifferences)
                return;

            count++;
        }
    }
    finally
    {
        _parents.Remove(object1);
        _parents.Remove(object2);
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T05:00:10.033

我相信直接使用`ISet<T>`、`ICollection<T>`或`IEnumerable<T>`通用接口而不是`HashSet<T>`. 您可以使用以下方法检测这些类型：

```
// ...
    Type t = typeof(HashSet<int>);
    bool test1 = GenericClassifier.IsICollection(t); // true
    bool test2 = GenericClassifier.IsIEnumerable(t); // true
    bool test3 = GenericClassifier.IsISet(t); // true
}
//
public static class GenericClassifier {
    public static bool IsICollection(Type type) {
        return Array.Exists(type.GetInterfaces(), IsGenericCollectionType);
    }
    public static bool IsIEnumerable(Type type) {
        return Array.Exists(type.GetInterfaces(), IsGenericEnumerableType);
    }
    public static bool IsISet(Type type) {
        return Array.Exists(type.GetInterfaces(), IsGenericSetType);
    }
    static bool IsGenericCollectionType(Type type) {
        return type.IsGenericType && (typeof(ICollection<>) == type.GetGenericTypeDefinition());
    }
    static bool IsGenericEnumerableType(Type type) {
        return type.IsGenericType && (typeof(IEnumerable<>) == type.GetGenericTypeDefinition());
    }
    static bool IsGenericSetType(Type type) {
        return type.IsGenericType && (typeof(ISet<>) == type.GetGenericTypeDefinition());
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T01:14:33.427

您需要循环`GetInterfaces()`并检查它是否实现了一个`IsGenericType`真实的接口并且`GetGenericTypeDefinition() == typeof(ISet<>)`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T01:14:48.623

这是内置于 HashSets... 使用 SymmetricExceptWith 方法。还有其他内置的比较。请参阅：http: [//msdn.microsoft.com/en-us/library/bb336848.aspx](http://msdn.microsoft.com/en-us/library/bb336848.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-05-08T14:28:52.940

接受的答案不区分`Dictionary`类型和可能的其他子类`ICollection`和`IEnumerable`。这效果更好：

```
Type t1 = typeof(HashSet<int>);
bool test1 = t1.IsGenericType && 
    t1.GetGenericTypeDefinition() == typeof(HashSet<>); // true

Type t2 = typeof(Dictionary<int, string>);
bool test2 = t2.IsGenericType && 
    t2.GetGenericTypeDefinition() == typeof(HashSet<>); // false

Type t3 = typeof(int);
bool test3 = t3.IsGenericType && 
    t3.GetGenericTypeDefinition() == typeof(HashSet<>); // false 
```

# c - 使用单个语句在 C 中启动后台线程

> ID：10183747
> 
> 赞同：0
> 
> 时间：2012-04-17T01:02:17.993
> 
> 标签：c, multithreading, macros

我已经阅读了很多关于 Go 语言的内容。有很多我不喜欢它 - 足以让我不想在日常生活中使用它。然而，我真正喜欢的语言有一点：goroutines。

我正在考虑用 C 实现它的方法。到目前为止，我在互联网上能找到的最好的方法是

```
#define go if (!fork()) for(;;exit(0)) 
```

这样，您可以在函数调用前加上 go，这样

```
go printf("Hello, world!\n"); 
```

在不同的线程中运行，以及：

```
go { printf("Hello, world!\n"); foo(); bar(); baz(); } 
```

但是，当然， fork() 有速度问题。（在我的机器上，fork() 的时间是 printf() 的 7 倍，使用 rdtsc x86 指令进行基准测试并运行几次以消除在内核之间切换或被调度的可能性。）

所以，我的问题是，有没有更好的方法来实现这个，所以它更快？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T01:13:34.363

Goroutines 主要是线程的一个花哨的词，具有一些用于线程间通信等的额外功能。

我猜您感兴趣的部分是能够在单独的线程中简洁地运行一段代码。不幸的是，在 C 中没有一种简单的方法可以做到这一点 - 你必须编写一个函数，将你想要在后台运行的代码包含在内，并使用一个宏或函数来接受该函数并使用`pthread_create()`或类似的。

除非有人想出一个聪明的方法来使用宏来动态创建一个函数？任何人？

请记住，除了最基本的线程应用程序之外，您将需要某种同步，这将使事情变得不那么简单。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T01:54:17.123

看看[OpenMP](http://en.wikipedia.org/wiki/OpenMP)。`#pragma`它允许使用相对简单的指令为代码块和循环迭代生成线程。它已经存在了十多年，并且已经在许多编译器中可用（包括`gcc`.

在线程中启动工作应该比 快`fork()`，但是在不管理许多线程的简单应用程序中，性能改进可能会被后台线程池初始化开销所掩盖。

# xcode - XCode 4.3.1 下载应用程序但不运行它们

> ID：10183753
> 
> 赞同：0
> 
> 时间：2012-04-17T01:03:35.160
> 
> 标签：xcode

Xcode 4.3.1 出现了一种奇怪的行为——

它会将我的应用程序下载到连接的设备上，但不会运行它们。

我可以删除设备上的应用程序，然后让 XCode 将应用程序下载到设备（出现图标），但调试器不运行它。

是什么赋予了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T23:15:53.387

重新启动macbook解决了这个问题。

# android - 如何将 git 与 android 库一起使用？

> ID：10183756
> 
> 赞同：1
> 
> 时间：2012-04-17T01:03:45.560
> 
> 标签：android, git, android-library

像大多数 android 开发人员一样，我使用 eclipse。当您设置一个 Android 库项目时，它会在它自己的目录中创建。

例子：

/workspace/ /workspace/libproject1 /workspace/libproject2 /workspace/myapp /workspace/mysecondapp

现在 myapp 将有一个 project.properties 文件，该文件将包含以下内容：

```
android.library.reference.1=../libproject1
android.library.reference.2=../libproject2 
```

mysecondapp 可能有一个 project.properties 文件，其中包含：

```
android.library.reference.1=../libproject2 
```

这如何与 git 一起使用？我在自己的存储库中签入 libproject1 和 libproject2。但是，如果我使用 git 子模块将库项目连接到 myapp ，它希望将它们放在子目录中。然后 project.properties 文件指向错误的位置。有一个简单的解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T04:33:51.543

Git 与设置无关，除非您将它们用作子模块。我一直在单独的存储库中拥有库项目，每次有人必须克隆它们时，他们应该将它们克隆到一个公共工作区文件夹中。它应该工作。

```
android.library.reference.1=../libproject2

```

这意味着，Eclipse 将尝试在父文件夹中查找您的库项目。如果它在那里找到它，其他一切都很好。如果没有，如果您将库克隆到另一个位置，您将需要手动告诉 eclipse 在哪里可以找到它。

就个人而言，我不喜欢使用子模块。不过我没试过。

# mongodb - Mongo $and 查询从不返回任何记录

> ID：10183760
> 
> 赞同：0
> 
> 时间：2012-04-17T01:04:50.677
> 
> 标签：mongodb

我似乎无法获得任何 $and 查询以在 MongoDB 中返回结果。这是一个非常简单的示例，我希望它可以工作。这是 MongoDB v 2.0.4

> db.foo.insert({letter: 'a', number: 2})
> 
> db.foo.find()

{“_id”：ObjectId（“4f8cbf5b19a4296c4255028e”），“字母”：“a”，“数字”：2}

> db.foo.find({letter: 'a'})

{“_id”：ObjectId（“4f8cbf5b19a4296c4255028e”），“字母”：“a”，“数字”：2}

> db.foo.find({letter: 'a', number: 2})

{“_id”：ObjectId（“4f8cbf5b19a4296c4255028e”），“字母”：“a”，“数字”：2}

// 为什么没有这些返回记录？

> db.foo.find({$and: [{letter: 'a', number: 2}]})
> 
> db.foo.find({$and: [{letter: 'a'}, {number: 2}]})
> 
> db.foo.find({$and: [{letter: 'a'}]})
> 
> db.foo.find({$and: []})

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T05:38:49.720

这是因为在支持 $ 并在我的系统上自动启动之前，我有一个旧版本的 Mongo。

当连接到不同的服务器版本或使用不支持的关键字时，Mongo 不会给出警告或错误。我建议它至少打印服务器版本和警告......

# vb.net-2010 - 创建搜索并突出显示找到的项目

> ID：10183764
> 
> 赞同：0
> 
> 时间：2012-04-17T01:05:16.127
> 
> 标签：vb.net-2010

我可以创建搜索，但我不知道如何让我搜索的项目在我的列表中突出显示......这就是我所拥有的：

```
 Dim foundItem As ListViewItem = ListView1.FindItemWithText(Me.searchText.Text, False,    
 0, True)

    If (foundItem IsNot Nothing) Then
        ListView1.TopItem = foundItem
        foundItem.Selected() = True
    End If 
```

我只是不太确定如何让它突出显示，所以我可以证明它已经被发现......请帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T02:27:21.247

您是否应该尝试更改项目背景颜色，而不是使用 foundItem.Selected？我只是想知道是否找到了多个项目并且您没有在列表中设置 multiselect = true ，那么它可能无法选择所有项目。

# jquery - 查找具有特定字符串的所有 id

> ID：10183770
> 
> 赞同：2
> 
> 时间：2012-04-17T01:06:40.037
> 
> 标签：jquery

我正在尝试获取`href`页面上所有链接的所有标签，并将它们放在一个数组中。我有以下代码，但是当我检查控制台时，我得到了错误`Uncaught TypeError: Object has no method 'attr'`，我不确定从这里去哪里。有任何想法吗？

**代码**

```
function videoLinks() {
    var videoLinks = $("a[id^=a_l_]").each(function() {
        var linkArray = jQuery.makeArray(videoLinks);
        console.log(linkArray.attr("href"));
    });
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T01:08:56.917

[`$.makeArray`](http://api.jquery.com/jQuery.makeArray/)返回原生 JavaScript 数组，而不是 jQuery 对象。本机 JavaScript 数组没有 jQuery 方法，如`.attr()`. 这开始有意义了吗？

简单地传递`videoLinks`给`$.makeArray`没有意义，因为你要么传递 function ，要么传递*已经*是jQuery 对象`videoLinks`的 function-local 。所以，我认为这更符合你想要做的事情：`videoLinks`

 *```
function videoLinks() {
    $("a[id^=a_l_]").each(function() {
        console.log(this.href);
    });
} 
```

这将记录每个以开头的元素的`href`属性。也许相反，您想构建这些属性的数组而不是记录它们。然后你会使用and ：`<a>``id``'a_l_'``href`[`.map()`](http://api.jquery.com/map/)[`.get()`](http://api.jquery.com/get/)

```
function videoLinks() {
    var hrefs = $("a[id^=a_l_]").map(function() {
        return this.href;
    }).get(); // ← note the .get() call
} 
```

> 我的最终目标是随机返回其中一个链接

然后你就快到了。[只需从`hrefs`数组](https://stackoverflow.com/questions/4550505/getting-random-value-from-an-array)中获取一个随机元素：

```
function videoLinks() {
    var hrefs = $("a[id^=a_l_]").map(function() {
        return this.href;
    }).get(); // ← note the .get() call

    var randHref = hrefs[Math.floor(Math.random() * hrefs.length)];
    console.log(randHref);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-25T17:48:26.807

这对我有用..（来自上面的“Matt Ball”代码）

```
$("a[id^=a_l_]").each(function() {
        console.log(this.value);
    }); 
```*

# c# - 如何确定允许调用特定方法的对象类型？

> ID：10183777
> 
> 赞同：2
> 
> 时间：2012-04-17T01:08:26.883
> 
> 标签：c#, class, access-modifiers

我有一`Node`堂课：

```
public class Node
{
    private string name;
    private Point3D location;
    private int id;
    .
    .
} 
```

和一个`Graph`班级：

```
public class Graph
{
  ....
} 
```

id in`Node`是只读的，但我只需要从`Graph`对象而不是从`Graph`类外部设置它的值。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T01:33:21.470

一种可能有*帮助*（但不能完全*修复*它）的选项是在属性上使用修饰符[internal](http://msdn.microsoft.com/en-us/library/7c5ka91b%28v=vs.71%29.aspx)。这将属性的可访问性范围限制在它所属的程序集内，以及声明为朋友的任何程序集内。

话虽如此，您将 Id 公开但只能从 Graph 对象更改的要求违反了 OO 概念。解决此问题的一种方法是将 Node 对象的创建限制在 Graph 类中，或者从仅可用于 Graph 类的工厂方法中创建。如果你这样做并且只使用一个 getter 将 Id 属性公开为公共，并在构造函数中为其分配一个值，那么你将实现 90% 的你想要的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T01:14:58.150

您可以使`Node`该类成为类的私有嵌套类，`Graph`因此只有类可以访问和修改它，您可以拥有从类`Graph`中的公共方法访问图形节点的方法`Graph`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T01:48:56.007

```
public NameSpace{
    public class Node{
      public int Id { get; internal set; }
      // rest of the code...
    }

    public class Graph{
      // Node Id can be set here...
    }
} 
```

这行得通吗？

# java - 为什么运行后出现端口错误？

> ID：10183779
> 
> 赞同：2
> 
> 时间：2012-04-17T01:08:55.323
> 
> 标签：java, swing, japplet, jeditorpane

我在文本板中创建了这个，因为我们的讲师不希望我们使用 IDE。我正在尝试输入一个网站并在`JEditorPane`.

```
 import java.awt.*;
    import java.awt.event.*;
    import java.io.*;
    import java.net.*;
    import javax.swing.*;
    import java.util.*;

    public class ViewRemoteFile extends JApplet
    {
        private JButton jbtView = new JButton("View");
        private JTextField jtfURL = new JTextField(12);
        private JEditorPane jtaFile = new JEditorPane();
        private JLabel jlblStatus = new JLabel();

        public void init()
        {
            JPanel p1 = new JPanel();
            p1.add(new JLabel("URL"), BorderLayout.WEST);
            p1.add(jtfURL, BorderLayout.CENTER);
            p1.add(jbtView, BorderLayout.EAST);
            add(new JScrollPane(jtaFile), BorderLayout.CENTER);
            add(p1, BorderLayout.NORTH);
            add(jlblStatus, BorderLayout.SOUTH);

            jbtView.addActionListener(new ActionListener()
            {
                public void actionPerformed(ActionEvent e)
                {
                    showFile();
                }
            });
        }

        private void showFile()
        {
            //Scanner input = null;
            //URL url = null;

            try
            {
                jtaFile.setPage(new URL(jtfURL.getText().trim()));
                jlblStatus.setText("File loaded successfully");
            }
            catch(MalformedURLException ex)
            {
                jlblStatus.setText("URL " + jtfURL.getText().trim() + " not found.");
            }
            catch(IOException ex)
            {
                jlblStatus.setText(ex.getMessage());
            }
            /*finally
            {
                if(input != null)
                    input.close();
            }*/
        }
    } 
```

当我运行此代码时，它不会显示该站点，它会崩溃并用大量错误填充我的控制台。

对于[http://www.yahoo.com](http://www.yahoo.com) 我得到：

```
 at java.awt.EventDispatchThread.run(EventDispatchThread.java:90)
Caused by: java.security.AccessControlException: access denied ("java.net.Socket
Permission" "www.yahoo.com:80" "connect,resolve")
        at java.security.AccessControlContext.checkPermission(AccessControlConte
xt.java:366)
        at java.security.AccessController.checkPermission(AccessController.java:
555)
        at java.lang.SecurityManager.checkPermission(SecurityManager.java:549)
        at java.lang.SecurityManager.checkConnect(SecurityManager.java:1051)
        at sun.net.www.http.HttpClient.openServer(HttpClient.java:466)
        at sun.net.www.http.HttpClient.<init>(HttpClient.java:213)
        at sun.net.www.http.HttpClient.New(HttpClient.java:300)
        at sun.net.www.http.HttpClient.New(HttpClient.java:316)
        at sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLC
onnection.java:992)
        at sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConne
ction.java:928)
        at sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection
.java:846)
        at sun.net.www.protocol.http.HttpURLConnection.getInputStream(HttpURLCon
nection.java:1296)
        at java.net.HttpURLConnection.getResponseCode(HttpURLConnection.java:468
)
        ... 40 more 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T01:27:34.460

它是一个小程序，需要对其进行签名才能访问套接字。未签名的小程序只允许连接到它来自的主机。查看[已签名](http://java.sun.com/developer/onlineTraining/Programming/JDCBook/signed.html)的小程序以及[小程序可以做什么和不能做什么](http://docs.oracle.com/javase/tutorial/deployment/applet/security.html)

**编辑**：显示 HTML 文档：

我不确定您的目标是什么，但如果您想显示 HTML 页面，您可能会发现它`showDocument`很有用。这是一个[例子](http://docs.oracle.com/javase/tutorial/deployment/applet/browser.html)。

# php - 如何保持多个数据库处于同步状态

> ID：10183782
> 
> 赞同：0
> 
> 时间：2012-04-17T01:09:09.213
> 
> 标签：php, mysql, database

我有几个站点运行带有 mysql 后端的 php 应用程序。它们都在不同的服务器上运行，因为它们可能没有 100% 的互联网连接时间。

目前，我正在为每条记录存储修改后的日期时间。以及将记录标记为已删除的标志。由于同步，仍然需要跟踪所有已删除的记录，以便我可以同步删除。

然后每个站点都会跟踪它们何时同步到。

问题是所有网站都进行插入和更新。所以如果一个站点断开了一段时间。它会导致所有其他站点的数据同步出现问题。

关于如何保持所有网站同步的任何想法？

当前执行同步的程序是用 php.ini 编写的。它遍历所有表并检查自上次同步以来已修改的记录。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T01:03:38.593

问题解决了。或多或少。除了跟踪上次修改记录的时间之外，现在我还跟踪在当前服务器上创建/修改记录的时间。这意味着我实际上有 2 个时间戳。一个跟踪实际修改时间，一个跟踪何时将此更改复制到此服务器。我只是根据复制记录的时间来同步记录。

# javascript - 如何覆盖javascript/jquery中的默认确认

> ID：10183783
> 
> 赞同：0
> 
> 时间：2012-04-17T01:09:22.750
> 
> 标签：javascript, jquery

好的，我正在尝试为自定义确认框实现此插件，但就返回值而言，我有点迷茫。这是原文：

```
jQuery("a.confirm").click( function() { 

if ( confirm( '<?php _e( 'Are you sure?' ) ?>' ) ) return true; else return false;

}); 
```

这就是我要实现的：

```
$("a.confirm").click(function(){

    var elem = $(this).closest('.item');

    $.confirm({
        'title'     : 'Delete Confirmation',
        'message'   : 'You are about to delete this item. <br />It cannot be restored at a later time! Continue?',
        'buttons'   : {
            'Yes'   : {
                'class' : 'blue',
                'action': function(){
                    elem.slideUp();
                }
            },
            'No'    : {
                'class' : 'gray',
                'action': function(){}  // Nothing to do in this case. You can as well omit the action property.
            }
        }
    }); 
```

真的，我只需要让点击事件来识别第二个而不是第一个，并正确返回。现在，如果你点击，我会得到原始的（浏览器默认），然后我会得到第二个。我认为“if 语句”是什么让我失望。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T01:17:36.143

首先，jQuery`click`方法返回一个 jQuery 对象。它不会返回您在传递给的匿名函数中指定返回的任何内容`.click()`。

其次，您的 if 语句有语法错误。它应该这样写：

```
if ( confirm( "<?php _e( 'Are you sure?' ) ?>" ) ){
    return true;
} else {
    return false;
} 
```

# python - 有没有办法使用换行符以外的分隔符在python的循环中读取文件

> ID：10183784
> 
> 赞同：11
> 
> 时间：2012-04-17T01:09:45.723
> 
> 标签：python

我通常在 Python 中读取这样的文件：

```
f = open('filename.txt', 'r')
for x in f:
    doStuff(x)
f.close() 
```

但是，这会按换行符拆分文件。我现在有一个文件，它的所有信息都在一行中（45,000 个用逗号分隔的字符串）。虽然使用类似的东西读取这种大小的文件是微不足道的

```
f = open('filename.txt', 'r')
doStuff(f.read())
f.close() 
```

我很好奇如果一个更大的文件都在一行中，是否可以实现与第一个代码片段类似的迭代效果，但用逗号而不是换行符或任何其他字符分割？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-17T01:37:01.597

以下函数是一种相当简单的方法来做你想做的事：

```
def file_split(f, delim=',', bufsize=1024):
    prev = ''
    while True:
        s = f.read(bufsize)
        if not s:
            break
        split = s.split(delim)
        if len(split) > 1:
            yield prev + split[0]
            prev = split[-1]
            for x in split[1:-1]:
                yield x
        else:
            prev += s
    if prev:
        yield prev 
```

你会像这样使用它：

```
for item in file_split(open('filename.txt')):
    doStuff(item) 
```

这应该比 EMS 链接的解决方案更快，并且对于大文件一次读取整个文件会节省大量内存。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T01:13:53.870

使用 打开文件`open()`，然后使用该`file.read(x)`方法从文件中读取（大约）下一个`x`字节。您可以继续请求 4096 个字符的块，直到您到达文件末尾。

您必须自己实现拆分 - 您可以从`csv`模块中获取灵感，但我不相信您可以直接使用它，因为它不是为处理极长的行而设计的。

# cocos2d-iphone - Cocos2d：CCCallFuncO，目标为父级

> ID：10183786
> 
> 赞同：0
> 
> 时间：2012-04-17T01:11:21.127
> 
> 标签：cocos2d-iphone, action, parent, target

我似乎无法让 CCCallFuncO 将 actionWithTarget 设置为 (JoinedMapsLayer*)self.parent

JoinedMapsLayer 是添加精灵类的父节点。

在精灵类里面我有一个方法：

```
-(void) playAction:(NSString*)name withMessagePart:(NSString *)messagePart {

    id displayMessageBox = [CCCallFuncO actionWithTarget:(JoinedMapsLayer*)self.parent
                                                selector:@selector(displayMessageBox:)
                                                 object:[NSString stringWithFormat:messagePart]];

    if([name isEqualToString:@"shiver"]){

        id a1 = [CCMoveTo actionWithDuration:.05 position:ccp(self.sprite.position.x+2, self.sprite.position.y)];
        id a2 = [CCMoveTo actionWithDuration:.05 position:ccp(self.sprite.position.x-4, self.sprite.position.y)];
        id a3 = [CCMoveTo actionWithDuration:.05 position:ccp(self.sprite.position.x+4, self.sprite.position.y)];
        id a4 = [CCMoveTo actionWithDuration:.05 position:ccp(self.sprite.position.x-2, self.sprite.position.y)];
        [self.sprite runAction:[CCSequence actions:a1,a2,a3,a2,a3,a2,a3,a2,a3,a2,a3,a2,a3,a2,a3,a2,a3,a2,a3,a2,a3,a2,a3,a4,displayMessageBox, nil]];

    }

    else if([name isEqualToString:@"spin"]){

        id a1 = [CCRotateBy actionWithDuration:.5 angle:360];
        [self.sprite runAction:[CCSequence actions:a1,displayMessageBox, nil]];

    }
} 
```

它在精灵上运行的动作很好，但我试图让它调用父节点中的方法。我有一个 NSLog 在那里检查，没有任何反应。有什么明显的原因吗？

在我的父节点的初始化中，该类被添加到一个可变数组中

```
HummingClass *hummingChar = [[HummingClass alloc] init];

            [characterArr addObject:hummingChar] 
```

我稍后会访问该课程，例如：

```
HummingClass *hummingChar = [characterArr objectAtIndex:interactionIndex]; 
```

有趣的是它不会与 self.parent 崩溃，所以我想我没有正确指向父节点。在我有的对象标题中

```
#import "JoinedMapsLayer.h"
@class JoinedMapsLayer 
```

编辑：即使我像这样进行常规方法调用，它也不起作用：

```
[(JoinedMapsLayer*)self.parent displayMessageBox:@"whatever"]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T17:20:33.983

我在一些糟糕的论坛的帮助下弄清楚了。如果将精灵添加到数组中，则必须手动分配父属性。

在 JoinedMapsLayer 的 init 中，我创建了一个指向数组索引的临时指针：

tempHummingChar.parent = 自我；

# unix - Unix递归查找和替换？

> ID：10183787
> 
> 赞同：4
> 
> 时间：2012-04-17T01:11:21.303
> 
> 标签：unix, replace, find

希望这对这里的某人来说是一个快速的...我需要在 unix 中递归地查找和替换字符串。

通常，我使用：

```
perl -e "s/term/differenterm/g;" -pi $(find path/to/DIRECTORY -type f) 
```

但是，我需要替换的字符串包含斜杠，我不确定如何转义它们？

所以，我需要这样做：

```
perl -e "s/FIND/REPLACE/g;" -pi $(find path/to/DIRECTORY -type f) 
```

其中 FIND = '/string/path/term' 和 REPLACE = '/string/path/newterm'

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-17T01:18:17.807

除了 . 之外，您还可以使用其他字符`/`。例如：

```
perl -e "s|FIND|REPLACE|g;" -pi $(find path/to/DIRECTORY -type f) 
```

[http://perldoc.perl.org/perlop.html#Regexp-Quote-Like-Operators](http://perldoc.perl.org/perlop.html#Regexp-Quote-Like-Operators)中的更多信息

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T01:17:36.707

在 unix 中它是这样的：

```
find "$path" -type f -print0|xargs -0 \
    perl -p -i -e "s/term/differenterm/g;" 
```

这利用[find](http://unixhelp.ed.ac.uk/CGI/man-cgi?find)和[xargs](http://unixhelp.ed.ac.uk/CGI/man-cgi?xargs)来查找子树中的所有文件并将它们传递给 perl 进行处理。

请注意，如果您想在您的正则表达式中使用 /，您可以使用以下命令对它们进行转义`\`：

```
 perl -p -i -e "s/\/source\/path/\/dest\/path/g;" 
```

`/`或使用与正则表达式本身不同的分隔符：

```
 perl -p -i -e "s|/source/path|/dest/path|g;" 
```

另请注意，还有其他方法可以递归地在子树上运行程序，但它们并不能正确处理带有空格或其他特殊字符的文件名。

# php - PHP 邮件发送但发件人始终是“Apache 在我的邮件客户端或 gmail 中，发件人始终是 apache@hosting12 有什么办法可以解决这个问题？我试过设置这样的标题但没有成功。有人可以帮帮我吗？ $headers = "MIME-Version: 1.0" . "\r\n"; $headers .= "Content-type:text/html;chars 问问题 user1012032 问问题 2012-04-17T01:11:39.233 15523 次 This question shows research effort; it is useful and clear 3 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. 在我的邮件客户端或 gmail 中，发件人始终是 apache@hosting12 有什么办法可以解决这个问题？我试过设置这样的标题但没有成功。有人可以帮帮我吗？ $headers = "MIME-Version: 1.0" . "\r\n"; $headers .= "Content-type:text/html;charset=iso-8859-1" . "\r\n"; $headers .= "From: <'$from'> \r\n"; $headers .= "Reply-To: <'$from'> \r\n"; $headers .= "Return-Path: <'$from'>\r\n"; $headers .= "X-Mailer: PHP \r\n"; 或者 $headers = "From: $from"; 标题中有额外的单引号。试试这样： $headers = "MIME-Version: 1.0" . "\r\n"; $headers .= "Content-type:text/html;charset=iso-8859-1" . "\r\n"; $headers .= "From: <$from> \r\n"; $headers .= "Reply-To: <$from> \r\n"; $headers .= "Return-Path: <$from>\r\n"; $headers .= "X-Mailer: PHP \r\n"; 您也可以删除不必要的“回复”和“返回路径”。 phpemailsender 4 3 回答 3 This answer is useful 8 我在一个法语论坛上找到了这个答案。 http://www.developpez.net/forums/d413965/php/outils/configuration-sendmail_path-sender/ 您可以在邮件函数中添加第 5 个参数： mail($mail_recipient, $subject, $message, $headers, '-f'.$mail_from); Ths '-f' + mail_from 强制系统将电子邮件作为 mail_from 发送。 于 2012-12-03T20:32:51.967 回答 This answer is useful 4 标题中有额外的单引号。试试这样： $headers = "MIME-Version: 1.0" . "\r\n"; $headers .= "Content-type:text/html;charset=iso-8859-1" . "\r\n"; $headers .= "From: <$from> \r\n"; $headers .= "Reply-To: <$from> \r\n"; $headers .= "Return-Path: <$from>\r\n"; $headers .= "X-Mailer: PHP \r\n"; 您也可以删除不必要的“回复”和“返回路径”。 于 2012-04-17T01:16:08.530 回答 This answer is useful 1 请从周围删除单引号$from并使用{$from} $headers .= 'From: Birthday Reminder <birthday@example.com>' . "\r\n"; 或者您可以使用以下签名通过from mail ( string $to , string $subject , string $message [, string $additional_headers [, string $additional_parameters ]] ) 编辑： 您还想检查文件中的sendmail_from设置php.ini。 于 2012-04-17T01:16:46.187 回答 Related 1 windows - 如何阻止 IFileDialog 解析其目标的快捷方式？ 2 rabbitmq - 埃斯珀不接受后期的新陈述 1 web-services - 通过 Carrierwave 上传远程文件 Rails webservice 1 telerik - Radscheduler 将课程添加到特定日期 0 api - bing search api订阅后，如何获取app id或app key？ 1 vb.net - 获取 MQMessage 时后台工作程序完成 1 c# - 如何比较 2 个 .csv 文件并创建一个包含两个 csv 文件部分的新 .csv？ 3 c# - Windows 应用程序的免费仪表控制 3 c# - 将类型传递给方法并返回属性值 3 ios - prepareForSegue 更改后退按钮标题 Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641</birthday@example.com>

> ID：10183788
> 
> 赞同：3
> 
> 时间：
> 
> 标签：php, email, sender

在我的邮件客户端或 gmail 中，发件人始终是 apache@hosting12

有什么办法可以解决这个问题？我试过设置这样的标题但没有成功。有人可以帮帮我吗？

```
$headers = "MIME-Version: 1.0" . "\r\n";
$headers .= "Content-type:text/html;charset=iso-8859-1" . "\r\n";
$headers .= "From: <'$from'> \r\n";
$headers .= "Reply-To: <'$from'> \r\n";
$headers .= "Return-Path: <'$from'>\r\n";
$headers .= "X-Mailer: PHP \r\n"; 
```

或者

```
$headers = "From: $from"; 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-03T20:32:51.967

我在一个法语论坛上找到了这个答案。 [http://www.developpez.net/forums/d413965/php/outils/configuration-sendmail_path-sender/](http://www.developpez.net/forums/d413965/php/outils/configuration-sendmail_path-sender/)

您可以在邮件函数中添加第 5 个参数：

```
mail($mail_recipient, $subject, $message, $headers, '-f'.$mail_from); 
```

Ths '-f' + mail_from 强制系统将电子邮件作为 mail_from 发送。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-17T01:16:08.530

标题中有额外的单引号。试试这样：

```
$headers = "MIME-Version: 1.0" . "\r\n";
$headers .= "Content-type:text/html;charset=iso-8859-1" . "\r\n";
$headers .= "From: <$from> \r\n";
$headers .= "Reply-To: <$from> \r\n";
$headers .= "Return-Path: <$from>\r\n";
$headers .= "X-Mailer: PHP \r\n"; 
```

您也可以删除不必要的“回复”和“返回路径”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T01:16:46.187

请从周围删除单引号`$from`并使用`{$from}`

```
$headers .= 'From: Birthday Reminder <birthday@example.com>' . "\r\n"; 
```

或者您可以使用以下签名通过`from`

```
mail ( string $to , string $subject , string $message [, string $additional_headers [, string $additional_parameters ]] ) 
```

**编辑：**

您还想检查文件中的`sendmail_from`设置`php.ini`。

# ruby-on-rails - 可以使用 Twitter 和 Facebook 个人资料图片而不将它们存储在我的服务器中吗？

> ID：10183792
> 
> 赞同：1
> 
> 时间：2012-04-17T01:13:06.300
> 
> 标签：ruby-on-rails, facebook, heroku, twitter

目前我正在使用 Facebook connect 和 Twitter oauth 来验证用户身份。我直接使用他们的个人资料图片网址，而不是将它们存储在我的服务器上。我想最好保存缩略图并认为最终可能需要这样做，但现在我正在努力节省尽可能多的钱。（我目前正在使用 Heroku 来托管我的项目，除非我使用 S3 或类似的东西，否则我无法存储文件，这会花钱）

我想知道这是否可行，以及大多数网络应用程序是否以这种方式开始。或者，如果我需要存储图像。

另外，现在我想让用户设置没有 Twitter 或 Facebook 的帐户。在这种情况下，有没有办法免费使用“第三方缩略图托管站点”（我什至不知道是否存在这样的东西）而不是使用 S3？它甚至可以是一个短期的 hack，因为我计划最终实现图像存储，如果这得到牵引。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T01:20:47.820

我认为不存储它们是最好的方法。如果有人更改了他们的图片，您总是以这种方式显示最新的，如果您存储了他们，那么您将在一段时间后获得他们图片的旧版本，这可能会使您的应用看起来陈旧。

至于在哪里存储替代品，我真的会考虑 s3。这是非常便宜的存储，缩略图不需要很多空间。如果你有很多用户，它只会变得昂贵，如果你有很多用户，你应该能够负担得起存储。

另外，你看过 Gravatar 吗？很多人都有链接到他们的电子邮件地址，这可能是获取他们照片的另一种好方法。[http://en.gravatar.com/site/implement/](http://en.gravatar.com/site/implement/)

# android - 如何与 USB 设备通信？

> ID：10183794
> 
> 赞同：17
> 
> 时间：2012-04-17T01:13:19.613
> 
> 标签：android, usb

我正在尝试建立 USB 通信作为主机。我正在按照这里的示例[http://developer.android.com/guide/topics/usb/host.html](http://developer.android.com/guide/topics/usb/host.html)但我无法使其正常工作。这是我的代码：

```
private static final String ACTION_USB_PERMISSION = "com.multitools.andres.LCView";
    UsbDevice device;
    //Pide permisos al usuario para comunicacion con el dispositivo USB
    private final BroadcastReceiver mUsbReceiver = new BroadcastReceiver() {
        @Override
        public void onReceive(Context context, Intent intent) {
            String action = intent.getAction();
            if (ACTION_USB_PERMISSION.equals(action)) {
                synchronized (this) {
                    UsbDevice device = (UsbDevice)intent.getParcelableExtra(UsbManager.EXTRA_DEVICE);
                    if (intent.getBooleanExtra(UsbManager.EXTRA_PERMISSION_GRANTED, false)) {
                        if(device != null){
                            //call method to set up device communication
                        }
                    } 
                    else {
                        Log.d(TAG, "permission denied for device " + device);
                    }
                }
            }
        }
    };

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        if(DEBUG) Log.i(TAG, "onCreate() -> MainMenu");

        actionBar = getActionBar();                     //obtengo el ActionBar
        actionBar.setDisplayHomeAsUpEnabled(true);      //el icono de la aplicacion funciona como boton HOME
        //Menu
        setListAdapter(new ArrayAdapter<String>(MainMenu.this, android.R.layout.simple_list_item_1, MenuNames));

        //USB
        if(DEBUG) Log.i(TAG, "Setting UsbManager -> MainMenu");
        UsbManager mUsbManager = (UsbManager) getSystemService(Context.USB_SERVICE);
        PendingIntent mPermissionIntent;

        if(DEBUG) Log.i(TAG, "Setting PermissionIntent -> MainMenu");
        mPermissionIntent = PendingIntent.getBroadcast(this, 0, new Intent(ACTION_USB_PERMISSION), 0);
        if(DEBUG) Log.i(TAG, "Setting IntentFilter -> MainMenu");
        IntentFilter filter = new IntentFilter(ACTION_USB_PERMISSION);
        if(DEBUG) Log.i(TAG, "Setting registerReceiver -> MainMenu");
        registerReceiver(mUsbReceiver, filter);
        if(DEBUG) Log.i(TAG, "Setting requestPermission -> MainMenu");
        mUsbManager.requestPermission(device, mPermissionIntent);

    } 
```

当我取消注释该行时，我得到“强制关闭”对话框`mUsbManager.requestPermission(device, mPermissionIntent);`如果我评论它，我不会强制关闭，但它不起作用。我认为问题出在：

```
private static final String ACTION_USB_PERMISSION = "com.multitools.andres.LCView"; 
```

在谷歌的例子中是这样的：

```
private static final String ACTION_USB_PERMISSION = "com.android.example.USB_PERMISSION"; 
```

但我不知道我到底要放什么，我找不到任何解释。我必须放在那里或者我的错误在哪里？这是我启动应用程序时得到的 LogCat：

```
04-17 00:57:50.944: I/dalvikvm(1362): threadid=3: reacting to signal 3
04-17 00:57:51.331: I/dalvikvm(1362): Wrote stack traces to '/data/anr/traces.txt'
04-17 00:57:51.981: I/(1362): onCreate() -> MainMenu
04-17 00:57:52.013: I/dalvikvm(1362): threadid=3: reacting to signal 3
04-17 00:57:52.151: I/dalvikvm(1362): Wrote stack traces to '/data/anr/traces.txt'
04-17 00:57:52.570: I/dalvikvm(1362): threadid=3: reacting to signal 3
04-17 00:57:52.731: I/dalvikvm(1362): Wrote stack traces to '/data/anr/traces.txt'
04-17 00:57:53.122: I/dalvikvm(1362): threadid=3: reacting to signal 3
04-17 00:57:53.231: I/dalvikvm(1362): Wrote stack traces to '/data/anr/traces.txt'
04-17 00:57:53.390: I/(1362): Setting UsbManager -> MainMenu
04-17 00:57:53.451: I/(1362): Setting PermissionIntent -> MainMenu
04-17 00:57:53.470: I/(1362): Setting IntentFilter -> MainMenu
04-17 00:57:53.470: I/(1362): Setting registerReceiver -> MainMenu
04-17 00:57:53.511: I/(1362): Setting requestPermission -> MainMenu
04-17 00:57:53.660: I/dalvikvm(1362): threadid=3: reacting to signal 3
04-17 00:57:53.791: I/dalvikvm(1362): Wrote stack traces to '/data/anr/traces.txt'
04-17 00:57:54.311: I/dalvikvm(1362): threadid=3: reacting to signal 3
04-17 00:57:54.401: I/dalvikvm(1362): Wrote stack traces to '/data/anr/traces.txt'
04-17 00:57:54.531: I/(1362): onCreateOptionsMenu() -> MainMenu
04-17 00:57:54.683: I/dalvikvm(1362): threadid=3: reacting to signal 3
04-17 00:57:54.772: I/dalvikvm(1362): Wrote stack traces to '/data/anr/traces.txt'
04-17 00:57:55.186: I/dalvikvm(1362): threadid=3: reacting to signal 3
04-17 00:57:55.291: I/dalvikvm(1362): Wrote stack traces to '/data/anr/traces.txt'
04-17 00:57:55.661: I/dalvikvm(1362): threadid=3: reacting to signal 3
04-17 00:57:55.751: I/dalvikvm(1362): Wrote stack traces to '/data/anr/traces.txt'
04-17 00:57:55.791: D/gralloc_goldfish(1362): Emulator without GPU emulation detected.
04-17 01:11:47.323: I/dalvikvm(1459): threadid=3: reacting to signal 3
04-17 01:11:47.720: I/dalvikvm(1459): Wrote stack traces to '/data/anr/traces.txt'
04-17 01:11:48.124: I/dalvikvm(1459): threadid=3: reacting to signal 3
04-17 01:11:48.291: I/dalvikvm(1459): Wrote stack traces to '/data/anr/traces.txt'
04-17 01:11:48.452: I/(1459): onCreate() -> MainMenu
04-17 01:11:48.691: I/dalvikvm(1459): threadid=3: reacting to signal 3
04-17 01:11:48.813: I/dalvikvm(1459): Wrote stack traces to '/data/anr/traces.txt'
04-17 01:11:49.172: I/dalvikvm(1459): threadid=3: reacting to signal 3
04-17 01:11:49.321: I/dalvikvm(1459): Wrote stack traces to '/data/anr/traces.txt'
04-17 01:11:49.653: I/dalvikvm(1459): threadid=3: reacting to signal 3
04-17 01:11:49.821: I/dalvikvm(1459): Wrote stack traces to '/data/anr/traces.txt'
04-17 01:11:49.901: I/(1459): Setting UsbManager -> MainMenu
04-17 01:11:49.931: I/(1459): Setting PermissionIntent -> MainMenu
04-17 01:11:50.021: I/(1459): Setting IntentFilter -> MainMenu
04-17 01:11:50.031: I/(1459): Setting registerReceiver -> MainMenu
04-17 01:11:50.051: I/(1459): Setting requestPermission -> MainMenu
04-17 01:11:50.071: D/AndroidRuntime(1459): Shutting down VM
04-17 01:11:50.133: W/dalvikvm(1459): threadid=1: thread exiting with uncaught exception (group=0x409c01f8)
04-17 01:11:50.231: I/dalvikvm(1459): threadid=3: reacting to signal 3
04-17 01:11:50.331: I/dalvikvm(1459): Wrote stack traces to '/data/anr/traces.txt'
04-17 01:11:50.401: E/AndroidRuntime(1459): FATAL EXCEPTION: main
04-17 01:11:50.401: E/AndroidRuntime(1459): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.multitools.andres/com.multitools.andres.MainMenu}: java.lang.NullPointerException
04-17 01:11:50.401: E/AndroidRuntime(1459):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1956)
04-17 01:11:50.401: E/AndroidRuntime(1459):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1981)
04-17 01:11:50.401: E/AndroidRuntime(1459):     at android.app.ActivityThread.access$600(ActivityThread.java:123)
04-17 01:11:50.401: E/AndroidRuntime(1459):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1147)
04-17 01:11:50.401: E/AndroidRuntime(1459):     at android.os.Handler.dispatchMessage(Handler.java:99)
04-17 01:11:50.401: E/AndroidRuntime(1459):     at android.os.Looper.loop(Looper.java:137)
04-17 01:11:50.401: E/AndroidRuntime(1459):     at android.app.ActivityThread.main(ActivityThread.java:4424)
04-17 01:11:50.401: E/AndroidRuntime(1459):     at java.lang.reflect.Method.invokeNative(Native Method)
04-17 01:11:50.401: E/AndroidRuntime(1459):     at java.lang.reflect.Method.invoke(Method.java:511)
04-17 01:11:50.401: E/AndroidRuntime(1459):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
04-17 01:11:50.401: E/AndroidRuntime(1459):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
04-17 01:11:50.401: E/AndroidRuntime(1459):     at dalvik.system.NativeStart.main(Native Method)
04-17 01:11:50.401: E/AndroidRuntime(1459): Caused by: java.lang.NullPointerException
04-17 01:11:50.401: E/AndroidRuntime(1459):     at android.os.Parcel.readException(Parcel.java:1333)
04-17 01:11:50.401: E/AndroidRuntime(1459):     at android.os.Parcel.readException(Parcel.java:1281)
04-17 01:11:50.401: E/AndroidRuntime(1459):     at android.hardware.usb.IUsbManager$Stub$Proxy.requestDevicePermission(IUsbManager.java:535)
04-17 01:11:50.401: E/AndroidRuntime(1459):     at android.hardware.usb.UsbManager.requestPermission(UsbManager.java:361)
04-17 01:11:50.401: E/AndroidRuntime(1459):     at com.multitools.andres.MainMenu.onCreate(MainMenu.java:80)
04-17 01:11:50.401: E/AndroidRuntime(1459):     at android.app.Activity.performCreate(Activity.java:4465)
04-17 01:11:50.401: E/AndroidRuntime(1459):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049)
04-17 01:11:50.401: E/AndroidRuntime(1459):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1920)
04-17 01:11:50.401: E/AndroidRuntime(1459):     ... 11 more
04-17 01:11:50.751: I/dalvikvm(1459): threadid=3: reacting to signal 3
04-17 01:11:50.851: I/dalvikvm(1459): Wrote stack traces to '/data/anr/traces.txt'
04-17 01:11:51.331: I/dalvikvm(1459): threadid=3: reacting to signal 3
04-17 01:11:51.403: I/dalvikvm(1459): Wrote stack traces to '/data/anr/traces.txt'
04-17 01:11:51.774: I/dalvikvm(1459): threadid=3: reacting to signal 3
04-17 01:11:51.961: I/dalvikvm(1459): Wrote stack traces to '/data/anr/traces.txt' 
```

谢谢 ：）

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-04-17T01:35:48.577

该字符串只是一个标记，因此您可以识别调用时返回的意图`registerReceiver(mUsbReceiver, filter);`。那不是问题。

我认为问题出在这里：

```
UsbManager mUsbManager = (UsbManager) getSystemService(Context.USB_SERVICE); 
```

这条线应该为您提供 USB 管理器，但据我所知，并非所有手机都必须支持 Android USB 附件 API。当您在代码中进一步调用它的方法时，这一行可能只是分配`null`给`mUsbManager`它然后导致您。在拨打电话之前`NullPointerException`尝试检查是否不是。`null`

有关更多信息，请查看以下链接：

1.  [http://developer.android.com/guide/topics/usb/index.html](http://developer.android.com/guide/topics/usb/index.html)
2.  [http://developer.android.com/guide/topics/usb/accessory.html](http://developer.android.com/guide/topics/usb/accessory.html)

**编辑：**

我想我明白了现在的问题所在。你是对的，它不是 USB 管理器。它是 UsbDevice 对象 ( `device`)。它永远不会在您的代码中的任何地方初始化。在这一行：

```
mUsbManager.requestPermission(device, mPermissionIntent); 
```

您基本上是在触发询问用户是否可以使用 UsbDevice 对象表示的设备的意图`device`。但是，当此调用被触发时`device`，尚未初始化（因此具有默认值`null`）。因此，当您尝试请求许可时，您最终会得到 a`NullPointerException`而不是预期的结果。要解决此问题，您需要确定要连接的设备并将其分配给`device`. 看[这里](http://developer.android.com/guide/topics/usb/host.html)，在“枚举设备”下找出不同的方法来做到这一点。如果您知道要连接的设备的名称，一种方法是在检索 Usb 管理器后进行以下调用：

```
HashMap<String, UsbDevice> deviceList = mUsbManager.getDeviceList();
device = deviceList.get("<deviceName>"); 
```

（显然，您将替换`<deviceName>`为设备的实际名称。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-12-19T08:04:43.107

`minSdkVersion`必须 >= 12

要启用 USB 主机 API 支持，您应该添加一个名为 android.hardware.usb.host.xml 并包含以下行的文件：

```
<permissions>
 <feature name="android.hardware.usb.host"/> 
```

# sql-server - SQL如何在整数列表上获取相等比较器

> ID：10183797
> 
> 赞同：1
> 
> 时间：2012-04-17T01:14:19.610
> 
> 标签：sql-server

我正在编写如下 SQL 查询：

```
ALTER proc [dbo].[Invoice_GetHomePageInvoices] (
      @AreaIdList varchar(max)
,      @FinancialYearStartDate datetime = null
,      @FinancialYearEndDate datetime = null
) as

    set nocount on

    select *
    from Invoice i
    left outer join Organisation o on i.OrganisationId = o.Id
    left outer join Area a on i.AreaId = a.Id
where i.InvoiceDate BETWEEN @FinancialYearStartDate AND @FinancialYearEndDate 
```

@AreaIdList 参数将采用“1,2,3”等格式。

我想添加一条仅返回区域 id 等于@AreaIdList 中任何 id 的发票的行。

如果在 areaId 上搜索 ie，我知道如何做一个声明。现在问题出在哪里`i.AreaId == areaId`我有这个列表，我要比较@AreaIdList 中的每个区域 ID。

谁能告诉我你会怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T06:05:56.790

将您的 ID 列表解压缩到表格中并使用`where AreadID in (select ID from ...)`

```
ALTER proc [dbo].[Invoice_GetHomePageInvoices] (
       @AreaIdList varchar(max)
,      @FinancialYearStartDate datetime = null
,      @FinancialYearEndDate datetime = null
) as

set nocount on

set @AreaIdList = @AreaIdList+','
declare @T table(ID int primary key)
while len(@AreaIdList) > 1
begin
  insert into @T(ID) values (left(@AreaIdList, charindex(',', @AreaIdList)-1))
  set @AreaIdList = stuff(@AreaIdList, 1, charindex(',', @AreaIdList), '')
end

select *
from Invoice i
  left outer join Organisation o on i.OrganisationId = o.Id
  left outer join Area a on i.AreaId = a.Id
where i.InvoiceDate BETWEEN @FinancialYearStartDate AND @FinancialYearEndDate and
      i.AreadID in (select ID from @T) 
```

# html - 无法文本对齐：CSS 居中

> ID：10183800
> 
> 赞同：4
> 
> 时间：2012-04-17T01:14:42.383
> 
> 标签：html, css

我似乎无法将“主页”按钮置于中心位置。主页文本位于左侧而不是中心。我的 htm 和 css 链接如下：html：

```
 <html>
  <head>
  <link rel="stylesheet" type="text/css" href="background.css"/>
  </head>
  <body>
  <h1>Bully-Free Zone</h1>
  <h2>"Online harassment has an off-line impact"</h2>
  <a href="New.html" class="nav-link">Home</a>
  </body>
  </html> 
```

CSS：

```
a.nav-link:link
{
color: black;
text-decoration: underline;
font-family:broadway;
font-size:30px;
text-align:center;
}
a.nav-link:visited
{
color: black;
text-decoration: none;
}
a.nav-link:hover
{
color: black;
text-decoration: none;
}
a.nav-link:active
{
color: black;
text-decoration: none;
} 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-17T01:18:51.747

你可以把它包装在一个`div`：

```
<div align="center">
  <a href="New.html" class="nav-link">Home</a>
</div> 
```

或者您可以为以下对象创建一个类`div`：

HTML：

```
<div class="myDiv">
  <a href="New.html" class="nav-link">Home</a>
</div> 
```

CSS：

```
.myDiv {
    text-align: center;
    width: 300px;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T01:22:34.397

text-align 属性只会使文本在它所在的容器中居中。在这种情况下，a 标记仅与文本一样宽。因此，无论您如何在该链接标记上设置 text-align 属性，它都将始终显示相同。要使其居中，您需要将其放在更宽的元素中。

```
<div id="nav">
    <a href="New.html" class="nav-link>Home</a>
</div> 
```

和你的CSS：

```
#nav
{
   text-align: center;
} 
```

祝你好运！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T01:22:56.863

属性 text-align:center 应该附属于父元素

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-20T12:09:12.560

```
<a href="#">Link</a>

a {
  display: block;
  margin: auto;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-12-12T22:18:12.763

我迟到了 8 个月回复，但我遇到了与 Backtrack 相同的问题，通过尝试上述答案的组合，我设法以这种方式解决了我的不幸。我非常尊重地与您分享它，以防将来有人需要此解决方案。

CSS：

```
a {

  text-align: center;

  margin: 20px;

  display: block;

   } 
```

如果您在“a”标签中使用“Id”，它也可以工作。

# xml - 如何重用 XML 中的数据

> ID：10183801
> 
> 赞同：1
> 
> 时间：2012-04-17T01:14:48.073
> 
> 标签：xml, xpath

我想创建一组包含某些值的元素。然后我想命名这个组。最后，我想推荐这个小组。像这样的东西：

```
<catalog type="expensive">
  <powder>25</powder>
  <cream>110</cream>
</catalog>

<catalog type="normal">
  <powder>5</powder>
  <cream>45</cream>
</catalog>

<person>
  <name>Jim</name>
  <catalog type="expensive">
    <powder>25</powder>
    <cream>110</cream>
  </catalog>
</person> 
```

有没有办法让 person 元素引用已经创建的昂贵目录组，而不是用每个 person 元素重复昂贵的目录？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T11:44:17.020

简短的回答是你已经在你的例子中做到了 - 如果`type`唯一标识目录，你可以编写如下内容：

```
<person> 
  <name>Jim</name> 
  <catalogRef type="expensive" /> 
</person> 
```

你就完成了——你需要的信息都在那里。如果`type`不是唯一的，您可以添加另一个唯一属性来标识每个目录（通常是`id`）。

更长的答案将需要有关您希望如何处理和使用此 XML 的一些详细信息 - 如果您想使用 XSLT 以某种方式对其进行转换，那么上述方法很好 - 您可以使用以下内容访问每个人的目录：

```
<xsl:variable name="catalogType" select="catalogRef/@type" />
<xsl:variable name="catalog" select="/*/catalog[@type=$catalogType]" /> 
```

假设当前节点是 person 元素并且所有目录定义都在根下的同一个 XML 中。

# javascript - if Not undefined 和 indexOf ('foo') 做某事

> ID：10183803
> 
> 赞同：1
> 
> 时间：2012-04-17T01:14:58.003
> 
> 标签：javascript, jquery, undefined, indexof, typeof

所以我试图调用 where if not undefined and index is foo 所以我使用：

```
if (typeof(getdata(js, 'box1')) != "undefined" 
&& (getdata(js, 'box1')).indexOf('foo') >= 0) {
      // Do something
   } 
```

这工作正常，但我不想调用 getdata 两次。有没有办法说如果`getdata`不是**未定义**并且 indexOf 是 foo 然后做某事，而不调用该`getdata()`函数两次？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T01:31:19.080

选择：

```
if (/foo/.test(getdata(js, "box1"))) {
    // do something
} 
```

虽然这可以让您通过一次检查就可以逃脱，但是对于这样一个简单的测试涉及正则表达式可能会令人不快:)

最好使用局部变量来存储函数调用的结果：

```
var data = getdata(js, "box1");

if (data && data.indexOf("foo") ==! -1) {
    // do something
} 
```

另请注意，这`typeof`是一个运算符，而不是一个函数：

```
typeof something // instead of typeof(something) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T01:18:40.280

你有没有尝试过

```
var data = getdata(js, 'box1');
if(typeof(data) != 'undefined' && data.indexOf('foo') >= 0) {

} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T03:18:00.797

如果值未定义或为空，您可以读取值的 indexOf 或空字符串。

```
if ( (getdata(js, 'box1') || '').indexOf('foo') !=-1) {
      // Do something
   } 
```

希望您的函数将只返回一个字符串，未定义或 null。

# backbone.js - Backbone.js 导航工作一次但不再工作

> ID：10183806
> 
> 赞同：1
> 
> 时间：2012-04-17T01:15:34.350
> 
> 标签：backbone.js, coffeescript

我正在使用 Backbone-on-rails gem 中的 Backbone.js 0.9.2。我也在尝试使用新的“pushState”而不是旧的哈希 URL。

**问题**

我正在构建一个像 CRUD 一样的标准 Rails 界面来跟踪我的约会。我在 index.jst.eco 主页面上有一个“新”链接：

```
<h1>Appointments</h1>
<p><a href="/appointments/new" class="new">New Appointment</a></p> 
```

我加载页面并单击该“新”链接，并且主干会触发该事件并且不必重新加载整个页面。这是那个事件：

```
class BackboneOnRails.Views.AppointmentsIndex extends Backbone.View
  template: JST['appointments/index'],
  events: ->
    'click .new': 'newAppointment'

  newAppointment: ->
    Backbone.history.navigate("/appointments/new", {trigger: true})
    return false

  # The rest of the index methods omitted for brevity 
```

然后调用骨干路由器：

```
class BackboneOnRails.Routers.Appointments extends Backbone.Router
  routes:
    '': 'index'
    'appointments': 'index'
    'appointments/new': 'new'

  initialize: ->
    this.appointments = new BackboneOnRails.Collections.Appointments()
    this.appointmentsIndexView = new BackboneOnRails.Views.AppointmentsIndex({collection: this.appointments})
    this.appointmentsIndexView.render()

  index: ->
    $("#container").html(this.appointmentsIndexView.el)
    this.appointments.fetch()

  new: ->
    appointments = new BackboneOnRails.Collections.Appointments()
    view = new BackboneOnRails.Views.AppointmentNew({collection: appointments})
    $("#container").html(view.render().el) 
```

当我点击浏览器的返回按钮，然后再次尝试使用“新”链接时，就会出现问题。这一次它会完全重新加载页面。

当我回击浏览器时，javascript 绑定发生了什么？

我有一个项目的表演活动，我可以来回走动没有问题。我已经比较了两者，它们看起来像是同一种调用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T01:45:22.123

问题在于您尝试重新使用约会索引视图实例。从 DOM 中删除视图会破坏 DOM 事件处理程序。将视图重新添加`el`到 DOM 不会重新连接它们。

## 问题概述

`initialize`当您第一次使用路由器的和方法加载该视图`index`时，一切都很好，因为您有一个新的 IndexView 实例。DOM 事件正确地附加到视图，并且生活很好。

当您点击`new`路由器的路由/方法时，您实际上是在尝试从屏幕上删除索引视图并将其替换为添加新视图。从视觉角度和添加新视图的角度来看，这是可行的。

但是，当您点击后退按钮时，您将停留在浏览器选项卡中的同一个实时应用程序实例中。在启用 pushstate 的情况下点击后退按钮告诉浏览器不要重新加载整个应用程序，只是为了更新 url 并触发索引的路由器方法。

在这种情况下，您的索引视图不是从头开始重新构建的。您正在重新使用相同的视图实例，但使用来自服务器的数据重新加载它。数据加载工作得非常好，因为您的视图和集合仍然附加。然而，DOM 事件绑定失败了，因为它们的绑定先前已被删除，而没有重新添加。

## 2 常见解决方案

对此有两种常见的解决方案，以及这些解决方案的许多变体。

### 1）不要重复使用视图实例。

这是我强烈推荐的建议。在我尝试重用视图实例的每个实例中，我一直遇到非常大的问题 - 包括您遇到的确切问题。

相反，每次需要显示约会索引时都重新创建一个新的视图实例。这意味着您`index`在路由器的方法中创建新的索引视图，而不是`initialize`方法。

### 2) 清除并重新绑定 DOM 事件

如果出于某种原因，您觉得您确实需要重用视图实例（这绝不应该是真的），您可以使用 Tim Branyen 不久前在他的博客上发布的一些信息来解决它：

[http://tbranyen.com/post/missing-jquery-events-while-rendering](http://tbranyen.com/post/missing-jquery-events-while-rendering)

我不推荐这种方法。重用视图实例似乎是一个好主意，但它会导致其他问题的糟糕路径，包括由于在应用程序中留下太多未使用的部分而导致内存使用膨胀。

## 旁注：僵尸和内存泄漏

在任何一种情况下——无论你决定重用视图实例还是在需要时重新创建它们——你都可能会遇到一些内存泄漏。

在重用视图的情况下，当您不需要时，您会明确地保留内存中的对象。这并不是真正的“泄漏”，而是过度使用内存。您应该在不需要时取消引用该对象，并在需要时重新创建它。这将减少内存使用并让您的应用程序性能更好。

我有一篇博客文章介绍了它是如何工作的，在这里： http: [//lostechies.com/derickbailey/2012/03/19/backbone-js-and-javascript-garbage-collection/](http://lostechies.com/derickbailey/2012/03/19/backbone-js-and-javascript-garbage-collection/)

在不重用视图的情况下，您可能会在视图从可见 DOM 中删除后留下模型和集合事件绑定，从而导致真正的内存泄漏。如果您决定不重用视图，则需要使替换 `#container`html 的代码更加健壮，并让它清理旧视图。

我也有一篇博客文章详细介绍了解决方案：http: [//lostechies.com/derickbailey/2011/09/15/zombies-run-managing-page-transitions-in-backbone-apps/](http://lostechies.com/derickbailey/2011/09/15/zombies-run-managing-page-transitions-in-backbone-apps/) - be一定要阅读这篇文章中 Johnny Oshika 的评论，因为他指出了一个非常有用的 StackOverflow 答案，其中他展示了一种处理模型和集合事件的简单方法。

# ruby - Ruby，在变量名称中使用插值

> ID：10183808
> 
> 赞同：4
> 
> 时间：2012-04-17T01:15:56.013
> 
> 标签：ruby, variables, interpolation

如果我有如下变量，

```
i = 1
k1 = 20 
```

有什么方法可以通过 i 的插值获得 k1 的值？

就像是，

```
k"#{i}"
=> 20 
```

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T01:17:43.890

这取决于它是[局部变量](http://ruby-doc.org/core/doc/syntax/assignment_rdoc.html#label-Local+Variable+Scope)还是[方法](http://ruby-doc.org/core-2.3.1/doc/syntax/methods_rdoc.html)。`send "k#{i}"`应该用方法来解决问题：

```
class Foo
  attr_accessor :i, :k1

  def get
    send "k#{i}"
  end
end

foo = Foo.new
foo.i = 1
foo.k1 = "one"
foo.get
# => "one" 
```

如果你真的需要，你可以使用当前的[`Binding`](http://ruby-doc.org/core/Kernel.html#method-i-binding)and访问局部变量[`local_variable_get`](http://ruby-doc.org/core/Binding.html#method-i-local_variable_get)：

```
i = 1
k1 = "one"
local_variables
# => [:i, :k1]
binding.local_variable_get("k#{i}")
# => "one" 
```

不过这很糟糕。在这种情况下，你最好使用 a [`Hash`](http://ruby-doc.org/core/Hash.html)：

```
i = 1
k = {1 => "one"}
k[i]
# => "one" 
```

# mono - Mono Gendarme 可以在源文件上运行吗？

> ID：10183809
> 
> 赞同：1
> 
> 时间：2012-04-17T01:16:00.420
> 
> 标签：mono, gendarme

我知道该工具仅在 .net 程序集上运行。有没有办法让它在源文件上运行？即使它需要修改源代码，我也想知道这种可能性。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-17T07:19:54.680

不，它不能。它的工作方式是检查编译后的二进制文件中的 IL 代码，因此修改源代码无济于事。无论如何，这不是一个重要的限制（如果您大量使用条件，您将希望在使用不同标志构建的二进制文件上运行它）。

# java - 谷歌分析 - 在页面分析 - 不能看到每个人的日期只登录数据

> ID：10183810
> 
> 赞同：0
> 
> 时间：2012-04-17T01:16:01.963
> 
> 标签：java, javascript, google-analytics

@CliqFlip 团队建立了一个社交网络，问题是在 Google Analytics（分析）页面分析中，它仅在您登录时显示您的数据。

IE无法在未登录的情况下进入登录页面，因此您以用户身份登录，并且页面分析仅在**您**单击的位置显示您的统计信息

我们想要什么：能够看到群众点击的地方

这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T06:50:43.337

我不确定登录与这个问题有什么关系，但如果你想查看大众点击的地方，你应该使用像[疯狂鸡蛋](http://www.crazyegg.com/)这样的热图解决方案，或者在谷歌分析中实现[事件跟踪](http://code.google.com/apis/analytics/docs/tracking/eventTrackerGuide.html)。

转到[您的站点](http://cliqflip.com/)，我可以看到跟踪信标已正确发送。

在您的[测试版页面](http://cliqflip-beta.apphb.com/)上也设置了跟踪，所以我不确定这里真正的问题是什么

# php - PHP 永不重复的随机数

> ID：10183820
> 
> 赞同：0
> 
> 时间：2012-04-17T01:17:01.163
> 
> 标签：php, mysql, random, numbers

我需要为我网站上的每个用户创建一个完全随机的数字并将其插入 MySQL 数据库。这些数字永远不会重复，我不想使用 MySQL AutoIncrement，因为我需要一个特定的范围。说从`111,111`到`999,999,999,999`。目前没有更高或更低。我确实有这个范围的具体原因，以防你想知道。我知道我可以使用`unique`MySQL 上的功能，但这只会阻止我插入重复项。我在考虑有 2 个函数，一个用于生成数字，另一个用于检查是否使用了该数字。他们会一直循环，直到他们找到一个没有被使用的数字。我知道这是多么低效，以及一旦这些数字中的大部分被占用后可能需要多长时间，这就是我来这里寻求更好答案的原因。你建议我做什么，因为我完全没有想法。谢谢你的帮助！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-17T01:20:15.193

你知道你可以：

```
ALTER TABLE `mytable` AUTO_INCREMENT=111111 
```

正确的？

无论如何，如果你仍然热衷于随机性，它可能对`SELECT`所有现有值最有效，将它们加载到 PHP 数组中，然后让 PHP 调用`rand(111111,999999999999)`，直到你得到一个不是`in_array`.

旁注：PHP 不能处理 999,999,999,999，除非它是 64 位版本，因为这个数字对于 32 位来说太高了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T01:20:39.687

将自动增量编号设置为 1111111 怎么样。

```
ALTER TABLE YourTable AUTO_INCREMENT=1111111; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T12:06:54.083

假设我们可以在闭区间 [111111,999999999999] 中生成任何值，那么我们只需要找到一个与

```
999999999999 - 111111 + 1 = 999999888889 
```

这是一个复合数，具有相当大的因数 {18181, 55002469}。

所以现在构建一个简单的，不是非常随机（但在这里肯定足够）的数字生成器，它将从最后一个选择的整数中生成一个新的伪随机整数。通过简单的模块化计算来做到这一点。选择一个数字作为开始，以及另一个与上面列出的因素相对质数的整数。

```
N(1) = 111111111111
N(i+1) = mod(N(i)*2803 + 4353454321 , 999999888889) 
```

您可以重复此过程而无需骑车，直到您感到非常无聊为止。

由于您希望下限为 111111，因此只需在使用时将该值添加到每个数字。此过程产生以下序列：

```
{111111111111, 448832453975, 81861723884, 462790945592, 207518059664, 677539248004, 147076609322, 260135161619, 163292472297, 713204080539, 115613316027, 68514277966, ...} 
```

您将为每个值添加 111111 以确保下限是真正的 111111，因此将报告的序列只是：

```
{111111222222, 448832565086, 81861834995, 462791056703, 207518170775, 677539359115, 147076720433, 260135272730, 163292583408, 713204191650, 115613427138, 68514389077, ...} 
```

好消息是您需要做的就是存储序列的最后一个成员，并对适合 64 位整数的数字进行模运算。

# jquery - Jquery - 当对话框窗口打开时从数据库中获取数据

> ID：10183826
> 
> 赞同：1
> 
> 时间：2012-04-17T01:17:33.900
> 
> 标签：jquery, jquery-ui-dialog

我有一个表格，在那个表格上有一个记录表。每条记录都来自 mysql 数据库，每条记录在数据库中都有自己的唯一 ID。我正在使用 Jquery UI 对话框库，每条记录旁边都有一个编辑链接。当一个人单击编辑时，将调用对话框打开，该对话框显示表单的模式窗口以编辑该特定记录。我的问题是，当对话框打开时，我将如何通过 jquery/ajax 进行调用，以便我可以从数据库中获取该记录的最新数据，然后填充对话框中的字段？现在我只是在单击链接时打开对话框：

```
$("a.editlink").click(function() {

    $("#edit-form").dialog("open");

    return false;

}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T01:36:13.150

在 click 函数中，您需要执行 Ajax 调用以使用[http://api.jquery.com/jQuery.ajax/检索信息](http://api.jquery.com/jQuery.ajax/)

然后，在 ajax 调用的成功方法中，您可以将返回的值分配给表单上的输入字段。

我不知道你的后端是什么技术，所以你只需要确保它以可读的方式返回值（即 JSON）。

唯一需要考虑的是，当用户单击编辑时，这会变慢。如果页面没有太多数据，则可能值得将附加属性存储在单击的锚标记中，以便您可以立即填充编辑表单。

IE。有一个看起来像这样的锚标记：

```
<a class="editlink" data-field1='stuff' data-field2='stuff' data-field3='stuff'>Text</a> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T01:38:55.103

您需要将 ajax 调用放在对话框 js 代码的 OPEN 部分中：

```
$( "#dialog-form" ).dialog({
        autoOpen: false,
        height: 300,
        width: 350,
        modal: true,
        buttons: {
            "Create an account": function() {

                    $( this ).dialog( "close" );
                }
            },
            Cancel: function() {
                $( this ).dialog( "close" );
            }
        },
        close: function() {
                    $( this ).dialog( "close" );
        },
                    open: function(){ 
         PUT AJAX CALL HERE
        }
    }); 
```

并将innerHTML放入ajax成功中，将结果放入对话框表单中：

```
function ajaxSuccess(data){
                     dialogformfields.innerHTML=data.info;
                     } 
```

希望这是你需要知道的！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T01:47:45.140

让您的 a 标签将 href 值设置为可使用编辑表单的页面。您使用查询字符串将记录的 id 传递到此页面，以便您可以将该记录的详细信息加载到编辑表单。

```
<a href="edtiuser.php?userid=1">Edit User 1</a>
<a href="edtiuser.php?userid=2">Edit User 2</a> 
```

并拥有这个脚本。

```
$(function(){
        $("a.editlink").click(function (e) {
            var url = this.href;
            var dialog = $("#dialog");
            if ($("#dialog").length == 0) {
                dialog = $('<div id="dialog" style="display:hidden"></div>').appendTo('body');
            }
            dialog.load(
                url,
                {}, // omit this param object to issue a GET request instead a POST request, otherwise you may provide post parameters within the object
                function (responseText, textStatus, XMLHttpRequest) {
                    dialog.dialog({                       
                        close: function (event, ui) {                            
                            dialog.remove();
                        },
                        modal: true,
                        width: 460
                    });
                }
            );           
            return false;           
        });
  }); 
```

因此，当您单击锚标记时，您的 edituser.php 页面的内容将被加载到对话框中。这应该可以正常工作，假设您已将 jQuery 和 jQuery UI 正确加载到您的页面。

# java - 使用“this”与不在 Java 的单例类中使用它？

> ID：10183830
> 
> 赞同：1
> 
> 时间：2012-04-17T01:17:44.363
> 
> 标签：java

以下单例类工作正常，

```
public class Elvis
{
    private static Elvis elvis = new Elvis();

    private Elvis()
    {

    }

    public static Elvis Instance()
    {
        return elvis;
    }
} 
```

但是，当我更改`return elvis;`为时`return this.elvis`，我得到`non-static variable this cannot be referenced from a static context`. 为什么是这样？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-17T01:19:19.920

`this`指当前对象实例。方法`static`不包含在对象中，它包含在类中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T01:23:16.053

“this”和“static”这两个关键词在某种意义上是对立的。当您引用当前对象的成员时使用“this”，即您有一个对象，并且您可能正在访问一个非静态成员。静态成员、函数和属性是所有对象的“全局”，它们不属于任何特定对象，而是属于类本身。

悠久的历史变短了。“this”表示*此*对象的当前实例。静态成员不属于任何实例。

# git - 查看远程存储库中新功能的便捷方式？

> ID：10183836
> 
> 赞同：2
> 
> 时间：2012-04-17T01:18:32.220
> 
> 标签：git, git-remote, git-status

在 Git 中，我希望能够一目了然地查看我的存储库和工作目录是否已过时。我经常犯的错误是只运行“git status”——但这根本不做任何远程通信。或者，我会这样做：

```
git fetch --all
git status 
```

但这并没有显示其他分支机构的活动。

什么是获取信息的好方法，例如：

1.  任何远程存储库中是否有此分支的更新？
2.  是否有任何父分支的更新？
3.  是否有任何新的分支 - 谁，等等。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T05:41:40.090

我建议使用`gitk --all`. 这将启动一个显示所有本地和远程分支的图形界面。在控制台模式下，我使用以下 git 别名：

```
graph = log --graph --all --decorate --oneline 
```

但请注意，工作目录不要与分支混淆......我刚才所说的对于查看分支来说是正确的，但是工作目录中的更改（因此，未提交的东西）是完全不同的，并且`git status`正如你所说的那样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T03:51:22.163

由于分支创建实际上并未记录在任何地方，因此您无法获得“谁是谁”。（您可以找到谁拥有给定分支上的最新提交，但是，例如，如果该分支是作为另一个分支的同义词创建的，则提交通常与“谁创建它”无关。例如，如果我这样`git push origin master:newbranch`做我刚刚在遥控器上创建的分支，作为其最近的提交，与最近的提交相同`master`，这不一定是“我的”。）

不过，默认情况下，输出`git fetch --all`确实显示活动。例如：

```
$ git fetch --all
Fetching origin
Fetching rohan
From [redacted]
   55f37f2..dc439fc  master     -> rohan/master 
```

这表示我刚刚根据我从名为“rohan”的遥控器带来的东西更新了我对 rohan/master 的想法。origin/* 中没有任何更新。

# python - 使用 TAL/Chameleon 填充表单字段

> ID：10183837
> 
> 赞同：0
> 
> 时间：2012-04-17T01:18:33.957
> 
> 标签：python, templates, chameleon, template-tal

我在 Python 中使用 Chameleon 来渲染我的模板。

假设我想使用 POST/GET 数据填充表单字段：

```
<input type="text" name="foo" value="${request.params['foo']}" /> 
```

问题是如果 request.params 没有键“foo”，我会得到一个错误。如果键不存在而不是抛出错误，让 value="" 为空的最简单方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-28T15:37:50.573

`request.params`是一个 dict（或 dict-like）对象，所以你可以使用`.get()`默认值：

```
<input type="text" name="foo" value="${request.params.get('foo', '')}" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T05:30:02.383

我最终做的是用一个简单的函数扩展请求：

```
def get_param(self, name):
    if name in self.params:
        return self.params[name]
    return None 
```

# javascript - 搜索文档并找到所有带有标题的输入

> ID：10183838
> 
> 赞同：0
> 
> 时间：2012-04-17T01:18:34.287
> 
> 标签：javascript, jquery

我想搜索我的文档，找到所有带有`title`属性的输入，但同时`title`属性不能为空。因此，它应该查找每个具有至少一个字符长度的 title 属性的输入。

然后我想在这些输入上做一些事件（比如给它们添加一些 CSS 类）。

使用 jQuery 或其他 javascript 库是否有可能？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T01:22:54.353

我相信这会给你你想要的：

```
$('input[title][title!=""]') 
```

应用 css

```
$('input[title][title!=""]').addClass('class1 class2 class3'); 
```

[http://jsfiddle.net/5hkAG/](http://jsfiddle.net/5hkAG/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T01:28:14.527

```
$("input[title]").not('[title=""]') 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T01:21:29.997

```
var myInputs = [];

$("input").each(function() {
    if($(this).attr("title").length > 0) {
        myInputs.push(this);
        // do other events as usual, using $(this) as selector for current input
    }
});

// do something with myInputs, which is an array of all inputs with a title attribute 
```

# php - 无论页面重新加载如何都保持当前会话

> ID：10183840
> 
> 赞同：0
> 
> 时间：2012-04-17T01:18:51.070
> 
> 标签：php, session, persistence, refresh

所以我让`index.php (root)`那个用户提交一个表单，它在页面加载时重新生成一个 session_id 并存储在隐藏的输入中。

在`root index.php`文件中输入数据后，它们将被发送到`profile page`具有：

```
session_start(); // Bring in old sessionID
$sess_id = session_id();

// If no sessionID redirect back home.
if(empty($sess_id)) {
  header('Location: ../index.php');   
}

// If don't enter, then reload page, redirect back home
elseif(empty($_POST['firstNm']) || empty($_POST['lastNm'])) {
  header('Location: ../index.php');   
}

// If sessionID first send off this data inputted from ../index.php then regenerate session id and update db
else {  
  // Connect to db
  $_SERVER['DOCUMENT_ROOT'] = 'SiteRoot/';
  // Grabs a new user's : username, pass, email from default [index.php] once submitted
  require_once($_SERVER['DOCUMENT_ROOT'].'cfg/'.'dbi.php');
  require_once($_SERVER['DOCUMENT_ROOT'].'registration/'.'inituserCredentialsGrab.php');

  // After submitting original values, update new session ID in database since original was viewable via source hidden inputs
  require_once($_SERVER['DOCUMENT_ROOT'].'registration/'.'newUserSessIDInitReg.php');
} 
```

这个文件基本上得到了所有的初始输入。获取通过查看源...可见的初始 session_id 并重新生成它。重新生成后提交到数据库。

问题是，如果我转到`RELOAD`该页面，它似乎又重新生成了 id。我该如何解决这个问题，这样无论我在当前浏览器会话期间刷新多少次，它都不会执行`regenerate_id`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T15:10:00.347

我会在我的新会话中存储一个标识已经重新生成的标志，并在进入页面时检查它。

例如：

```
session_start(); // Bring in old sessionID              
$sess_id = session_id();              

// If no sessionID redirect back home.              
if(empty($sess_id)) {              
  header('Location: ../index.php');                 
}              

// If don't enter, then reload page, redirect back home              
elseif(empty($_POST['firstNm']) || empty($_POST['lastNm'])) {              
  header('Location: ../index.php');                 
}              

// If sessionID first send off this data inputted from ../index.php then regenerate session id and update db              
elseif(!isset($_SESSION['already_stored'])){                
  // Connect to db              
  $_SERVER['DOCUMENT_ROOT'] = 'SiteRoot/';              
  // Grabs a new user's : username, pass, email from default [index.php] once submitted              
  require_once($_SERVER['DOCUMENT_ROOT'].'cfg/'.'dbi.php');              
  require_once($_SERVER['DOCUMENT_ROOT'].'registration/'.'inituserCredentialsGrab.php');              

  // After submitting original values, update new session ID in database since original was viewable via source hidden inputs              
  require_once($_SERVER['DOCUMENT_ROOT'].'registration/'.'newUserSessIDInitReg.php');
  $_SESSION['already_stored'] = true;
} 
```

如果更新数据库的代码仍然需要在每次重新加载时运行，那么您可以移动 if 条件以仅围绕会话 id 本身的重新生成。

# android - 在 ASP.NET 网站中从 Android 接收数据

> ID：10183842
> 
> 赞同：1
> 
> 时间：2012-04-17T01:19:00.577
> 
> 标签：android, asp.net

我编写了一个将数据发送到 ASP.NET 网站的 Android 应用程序。当我测试应用程序时，我收到错误：

> 连接被`https://localhost:1863`拒绝。

我该如何解决这个问题？另外，如何将这些数据存储到[SQL Server](http://en.wikipedia.org/wiki/Microsoft_SQL_Server)中？

```
HttpClient client1 = new DefaultHttpClient();

HttpPost request = new HttpPost("http://localhost:1863");

String lat = "lat",lng = "lng";

List<NameValuePair> postParameters = new ArrayList<NameValuePair>(3);
postParameters.add(new BasicNameValuePair("lat", lat));
postParameters.add(new BasicNameValuePair("lng", lng));
try {
    request.setEntity(new UrlEncodedFormEntity(postParameters));
    UrlEncodedFormEntity formEntity = new UrlEncodedFormEntity(postParameters);
    request.setEntity(formEntity);
    // request.addHeader("Content-type", "application/x-www-form-urlencoded");
    HttpResponse response;
    response = client1.execute(request);
    BufferedReader in = new BufferedReader(new InputStreamReader(response.getEntity().getContent()));
    String line;
    String page = "";
    line = in.readLine();
    while (line != null)
    {
        page = page + line;
        line = in.readLine();
    }
}
catch (ClientProtocolException e) {
    e.printStackTrace();} catch (UnsupportedEncodingException e) {
    // TODO Auto-generated catch block
    e.printStackTrace();
} 
catch (IOException e) {
    // TODO Auto-generated catch block
    e.printStackTrace();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T01:22:24.357

您需要获取服务器的[IP 地址](http://en.wikipedia.org/wiki/IP_address)，而不是使用`localhost`，因为`localhost`它是调用计算机的本地地址，因此`localhost`Android 与 IIS 服务器不同。

**更新：**

只需使用 IP 地址`10.0.2.2`，如 Stack Overflow 问题*[How to connect to my http://localhost web server from Android Emulator in Eclipse 中](https://stackoverflow.com/questions/5806220)*所述。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-18T16:54:13.940

我制作了一个 ASP.NET 处理程序页面 (.ashx)，将其命名为`Handler`，并将“http://localhost:1863”替换为“http://localhost:1863/Handler.ashx”，它解决了问题。

# android - 如何在 Android 的 Tab Activity 中处理数据库

> ID：10183849
> 
> 赞同：0
> 
> 时间：2012-04-17T01:20:21.367
> 
> 标签：android, sql, database, tabs

所以我有一个在 TabActivity 中运行的 Android 应用程序，它通过这个选项卡分隔 3 个不同的活动。我已经用 SQLite 设置了一个 DatabaseHandler 类，一切都很好。

问题是，到目前为止，我真的不知道如何处理数据库，因为它将接收来自其中一项活动的数据，我需要在不同的活动中显示该数据。我不知道我是否应该在主 TabActivity 或在哪里声明数据库，我以前从未在 Android 中使用过 SQL，现在我很迷茫。

我试着把它画出来，这样更容易理解：[解释图](http://i.imgur.com/9LhiT.png)（对不起，我还没有足够的声誉来直接将图像发布到帖子中）

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T01:49:42.980

尽管从长远来看，在每个活动中都可以使用 DatabaseHandler，但我认为大多数重要的应用程序都会受益于使用[`ContentProvider`](http://developer.android.com/reference/android/content/ContentProvider.html%20ContentProvider)

`ContentProvider`提供对数据的抽象。当您将它与 a 结合使用时，它会变得非常强大，[`CursorLoader`](http://developer.android.com/reference/android/content/CursorLoader.html)并且[`LoaderManager`](http://developer.android.com/reference/android/app/LoaderManager.html%20LoaderManager)可以通过使用支持库回到 Android 1.6。

这些概念需要一些研究，但将使跨多个片段或活动的数据共享更简单，更不容易出错。

Mobile Tuts 有几个很好的教程，在官方 Android 文档和示例之上值得一读：

[http://mobile.tutsplus.com/tutorials/android/android-sdk_content-providers/](http://mobile.tutsplus.com/tutorials/android/android-sdk_content-providers/)

[http://mobile.tutsplus.com/tutorials/android/android-sdk_loading-data_cursorloader/](http://mobile.tutsplus.com/tutorials/android/android-sdk_loading-data_cursorloader/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T01:35:36.633

您应该没问题，只要您在完成对数据库的读/写后立即关闭与数据库的连接。

每个活动都应该能够拥有自己的 DatabaseHandler。

# ruby-on-rails - 如何将新图像添加到 Rails 项目？

> ID：10183853
> 
> 赞同：0
> 
> 时间：2012-04-17T01:20:53.040
> 
> 标签：ruby-on-rails, caching, assets

我正在研究 Rails 应用程序的前端部分。我必须添加一些图像，所以我将这些图像添加到 app/assets/images 目录中。

我可以通过 /assets/[图像名称] 访问应用程序附带的图像，但我无法访问我的新图像。我试过

```
/assets/images/[image name]
/assets/[image name]
/[image name]
/images/[image name] 
```

看起来后面有一个缓存系统，或者我做错了什么。

请给我提意见。

谢谢，月亮

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T01:28:58.140

您应该始终使用`image_tag`or`asset_path`帮助器来计算命名资产的路径 - 请参阅资产管道指南中的[链接资产](http://guides.rubyonrails.org/asset_pipeline.html#coding-links-to-assets)。

如果您使用默认的简单的基于文件的 rails 缓存，您也可以尝试 a`rake tmp:clear`以确保没有任何内容被错误地缓存。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T03:11:14.120

尝试：

```
<%= image_tag "yourfilename.png" %> 
```

# jquery - jQuery倒计时停止页面显示

> ID：10183856
> 
> 赞同：0
> 
> 时间：2012-04-17T01:21:21.590
> 
> 标签：jquery, pagination, countdown

我不确定发生了什么，但我正在设置新内容并尝试为每个项目添加倒计时但是它似乎不起作用，抱歉不太清楚如何解释它。

没有此脚本的倒计时部分，请参阅下面的脚本工作正常

倒计时部分

```
$('#countdown'+members[i]['id]']).countDown({
                            targetDate: {
                            'day':      17,
                            'month':    12,
                            'year':     2012,
                            'hour':     01,
                            'min':      0,
                            'sec':      0,
                            },omitWeeks: true

                        }); 
```

和脚本的 html 端

```
function realcashNowCallback(page_index, jq){
                // Get number of elements per pagionation page from form
                var items_per_page = 8;
                var max_elem = Math.min((page_index+1) * items_per_page, members.length);
                var newcontent = '';

                // Iterate through a selection of the content and build an HTML string
                for(var i=page_index*items_per_page;i<max_elem;i++)
                {

                    memberscountdown = members[i]['enddate'];
                    newcontent += '<div id="offer1" class="realcashnowitems">'+
                                  '<div id="title1" class="moreofferstop">' + members[i]['tradingname'] + '</div>'
                                 +' <div id="defaultCountdown" class="moreoffers"> '
                                 +'<div id="pic1" class="productimagesmall"><img style="width:180px;" src="'+ members[i]['picurl']+'"></div>'
                                 +'<div id="description1" class="descriptionsmall">'+ members[i]['des']+'</div>'
                                 +'<div id="spend1_0" class="spendget1">SPEND $'+members[i]['offers'].split('|')[0].replace('.00', '').replace(' $', '')+'<br/><span>GET $'+members[i]['offers'].split('|')[1].split(',')[0].replace(' $', '').replace('.00', '')+'</span></div>'
                                 +'<div id="countdown'+members[i]['id']+'"class="spendget2">';

                    newcontent += '</div>'
                                 +'<div class="buttonmore"><a id="link1" href="'+ members[i]['url'] +'"><img src="template/images/elmos/More_Button.png"></a></div> '           
                                 +'</div>'
                                 +'<div id="sub1" class="moreoffersbottom">'+ members[i]['suburb']+'</div>'
                                 +'</div>';     

                    $('#countdown'+members[i]['id']).countDown({
                        targetDate: {
                        'day':      17,
                        'month':    12,
                        'year':     2012,
                        'hour':     01,
                        'min':      0,
                        'sec':      0,
                        },omitWeeks: true

                    });

                }

                // Replace old content with new content
                $('#Searchresult').html(newcontent);

                // Prevent click eventpropagation
                return false;
            } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T01:26:17.610

在不了解您的问题以及“不起作用”的更多信息的情况下，我认为这是问题所在：

```
$('#countdown['+members[i]['id]']).countDown({ 
```

应该

```
$('#countdown['+members[i][id]+']').countDown({ 
```

# xcode - cocoa：如何让webView背景透明？

> ID：10183857
> 
> 赞同：7
> 
> 时间：2012-04-17T01:21:23.600
> 
> 标签：xcode, macos, cocoa

mac osx ，我想让我的 webview 看起来透明并在其上显示数据，背景显示父视图的图像。

谁能让我知道如何做到这一点？这种方法不能

```
NSString * source = @"<html><head><title></title></head><body><div id=\"box\">Example Box</div></body></html>";
[[webView mainFrame] loadHTMLString:source baseURL:[NSURL URLWithString:@""] ];
[[webView windowScriptObject] evaluateWebScript:@"document.getElementById('box').style.backgroundColor = '#dddddd';"]; // Change box background
[[webView windowScriptObject] evaluateWebScript:@"document.body.style.backgroundColor = '#dddddd';"]; // Change body background 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-04-17T01:33:41.500

您需要调用`setDrawsBackground:`并`WebView`传入`NO`。这将阻止 Web 视图绘制背景，除非 Web 视图中加载的页面明确设置了背景颜色。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2015-04-09T11:15:11.747

我们可以使用 cocoa 在 WebView 中添加背景图片。为此，我们需要为 body 标签添加 css。

**创建一个网页视图：**

```
WebView *webView; 
```

**获取图像表单捆绑路径：**

```
NSString *path = [[NSBundle mainBundle] pathForResource:@"my-bg" ofType:@"jpg"]; 
```

**为body标签编写CSS。**

```
NSMutableString *htmlBuilder = [[NSMutableString alloc] init];
[htmlBuilder appendString:@"body {"];
[htmlBuilder appendString:[NSString stringWithFormat:@" background-image: url('file://%@');",path]];
[htmlBuilder appendString:@"}"]; 
```

**在 webview 上加载此图像**

```
[[webView mainFrame] loadHTMLString:htmlBuilder baseURL:nil];
[webView setDrawsBackground:NO]; 
```

您的图像将添加到 webview 的背景中。

# android - Android - 为什么我收到致命信号？

> ID：10183861
> 
> 赞同：3
> 
> 时间：2012-04-17T01:21:31.027
> 
> 标签：android, opengl-es

我试图用opengl es在屏幕上显示一些点。这是ondraw的代码：

```
gl.glClear(GL10.GL_COLOR_BUFFER_BIT | GL10.GL_DEPTH_BUFFER_BIT);
gl.glLoadIdentity();
gl.glEnableClientState(GL10.GL_VERTEX_ARRAY);
gl.glColor4f(0, 255, 0, 0);     
gl.glVertexPointer(3, GL10.GL_FLOAT, 0, buffer);
gl.glDrawArrays(GL10.GL_POINTS, 0, points.length);
gl.glDisableClientState(GL10.GL_VERTEX_ARRAY); 
```

谁能告诉我我做错了什么？？？

编辑：生成缓冲区和点的代码

```
 points = new float[12288];
    int pos = 0;
    for (float y = 0; y < 64; y++) {
        for (float x = 0; x < 64; x++) {
            points[pos++] = x/100;
            points[pos++] = y/100;
            points[pos++] = 0;
        }
    }

    ByteBuffer vertexByteBuffer = ByteBuffer.allocateDirect(points.length * 4);
    vertexByteBuffer.order(ByteOrder.nativeOrder());     
    // allocates the memory from the byte buffer
    buffer = vertexByteBuffer.asFloatBuffer();   
    // fill the vertexBuffer with the vertices
    buffer.put(points);  
    // set the cursor position to the beginning of the buffer
    buffer.position(0); 
```

和 logcat 的错误：

04-17 06:38:11.296: A/libc(24276): 致命信号 11 (SIGSEGV) 在 0x41719000 (code=2)

此错误发生在 gl.glDrawArrays

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-20T04:56:39.003

我相信这是问题所在：

`gl.glDrawArrays(GL10.GL_POINTS, 0, points.length);`

`glDrawArrays`获取要绘制的**顶点数。**你给它的**浮点数**是 3 倍太大。因此，opengl 实际上是在尝试从您的 points 数组中读取 12288 vertices = 36,xxx 浮点数，这超出了数组的范围。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-20T02:40:26.167

**问题：**您没有调用 glBindBuffer，但随后调用了 glDrawArrays；这将导致段错误。

当我尝试使用 IBO 缓冲区而不首先使用 glBindBuffer 命令绑定缓冲区时，我遇到了同样的问题。例如，我的一个绘图函数如下所示：

```
GLES20.glBindBuffer(GLES20.GL_ARRAY_BUFFER, common.vbo);
GLES20.glBindBuffer(GLES20.GL_ELEMENT_ARRAY_BUFFER, common.ibo);

GLES20.glVertexAttribPointer(handleManager.switchPosition, 2, GLES20.GL_FLOAT, false, 0, 0);
GLES20.glEnableVertexAttribArray(handleManager.switchPosition);

GLES20.glDrawElements(GLES20.GL_TRIANGLES, common.iboPointCount, GLES20.GL_UNSIGNED_BYTE, 0);

GLES20.glDisableVertexAttribArray(handleManager.switchPosition);

GLES20.glBindBuffer(GLES20.GL_ARRAY_BUFFER, 0);
GLES20.glBindBuffer(GLES20.GL_ELEMENT_ARRAY_BUFFER, 0); 
```

所有 glBindBuffer 命令都可以对您试图让着色器识别的属性数据进行操作。

# javascript - SQLite / Javascript：如何知道A列中的所有值何时相同

> ID：10183868
> 
> 赞同：0
> 
> 时间：2012-04-17T01:22:37.123
> 
> 标签：javascript, mysql, sqlite

作为对数千行进行深入文本搜索的一部分，其中许多行在 A 列中包含相同的数据，我想知道 A 列的 sqlite 结果集中的所有行何时都相同。例如。如果搜索词是 'ai' 并且列 A = 'in pain' 的结果集中的所有行都执行此功能。

那么我如何以编程方式，无论是在 sqlite 中还是在结果集上使用 javascript 询问：A 列中的所有行是否都相同？

这可能很简单（希望如此），但它今天不会来找我......

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T01:31:55.553

```
SELECT columnA, count(*) 
FROM  MyTable 
WHERE myField like '%AI%'  
GROUP BY columnA 
```

可能不会是最快的，因为它在两边都做了一个 % ......这是一篇[SQLLite 文章](http://www.sqlite.org/lang_expr.html)

您可以在字段上使用正则表达式搜索 AI，这可能会更快

已更新，但我仍然不认为我完全理解问题示例数据会有所帮助.. 所以

COLUMNA in pain in pain in the 巢穴

你想要看

```
in pain      2
in the lair  2 
```

还是您想查看 `no records found`（因为列 A 中包含 ai 的所有值都不匹配？）

---也许这就是你所追求的......

```
select count(*) mcount from (
    SELECT columnA, count(*) 
    FROM  MyTable 
    WHERE columnA like '%AI%'  
    GROUP BY columnA) innerResult 
```

如果 mcount > 1，则 columnA 有超过 1 个匹配 '%AI%' 的值

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T18:39:04.433

这在 SQL 中会很昂贵：

```
 SELECT ColumnA, (SELECT COUNT(*) FROM YourTable WHERE ColumnA LIKE '%ai%' AND ColumnA <> outer.ColumnA) AS OtherCount
   FROM YourTable AS outer WHERE ColumnA LIKE '%ai%'; 
```

在 javascript 中，您只需遍历维护 A 列值字典的行，当字典中有两个键时，您知道并非所有结果都相同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T19:41:02.743

在db调用的成功函数中使用Javascript：

```
var detailsarr=[];
if (results.rows && results.rows.length) {
for (var i = 0; i < results.rows.length; i++) {
var details=results.rows.item(i).details;
if(detailsarr.toString().indexOf(details)===-1){detailsarr.push('"'+details+'"');}
    }
detailsarr = '['+detailsarr+']';
var detailsdata=JSON.parse(detailsarr);
if(detailsdata[1]){THEN ALL ROWS ARE NOT IDENTICAL}
} 
```

# performance - 进行整数除法的最快方法是什么？

> ID：10183872
> 
> 赞同：1
> 
> 时间：2012-04-17T01:23:15.600
> 
> 标签：performance, scheme, integer-division, chez-scheme

使用方案我需要使用以下功能。（所有参数都是自然数 [0, inf) ）

```
(define safe-div
  (lambda (num denom safe)
    (if (zero? denom)
        safe
        (div num denom)))) 
```

然而，这个函数经常被调用并且性能不够好（速度方面）。是否有更有效的方法来实现所需的行为（num 和 denom 的整数除法，如果 denom 为零则返回安全值）？

注意，我使用的是 Chez Scheme，但是它被用于仅导入 rnrs 而不是完整 Chez 的库中。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-17T04:42:31.910

为了获得最佳性能，您需要尽可能靠近硅片。添加这样的安全检查是行不通的，除非它们被方案系统及时编译成超高效的机器代码。

我看到两个选项。一种是在C（或程序集）中创建一个本地（即[外部](http://www.scheme.com/csug8/foreign.html#./foreign%3ah0)）实现并调用它。这可能与将其打包为 lambda 不兼容，但话又说回来，lambda 的动态特性导致符号效率，但不一定是运行时效率。（函数指针除外，C 中不存在 lambda 表达式是有原因的，尽管它已经老了很多年。）如果你走这条路，最好退后一步，看看哪个 safe-div 的更大处理是一部分应该是原生的。如果周围的一切仍然很慢，那么加速循环中心的划分就没有什么意义了。

假设被零除预计很少见，另一种方法是只使用`div`并希望它的实现速度很快。是的，这可能导致除以零，但在速度方面，有时请求宽恕比请求许可更好。换句话说，跳过除法前的检查，直接去做。如果失败，方案运行时应捕获除以零故障，您可以为其安装[异常处理程序](http://www.scheme.com/csug8/system.html#./system%3ah0)。这会导致异常情况下的代码变慢，而正常情况下的代码变快。希望这种权衡能够带来性能上的胜利。

最后，根据您要除以的内容，乘以倒数可能比执行实际除法更快。这需要快速的倒数计算或修改较早的计算以直接产生倒数。由于您正在处理整数，因此倒数将存储在定点中，本质上是 2^32 * 1/denom。将此乘以 num 并右移 32 位以获得商。这是成功的，因为如今更多的处理器具有单周期乘法指令，但除法在芯片上的循环中执行，这要慢得多。这可能对您的需求有点过分，但在某些时候可能会很有用。

# php - PHP MVC - 添加更多视图

> ID：10183874
> 
> 赞同：0
> 
> 时间：2012-04-17T01:23:24.333
> 
> 标签：php, model-view-controller, boilerplate

[我最近使用这个微型 mvc 样板](http://net.tutsplus.com/tutorials/php/create-your-first-tiny-mvc-boilerplate-with-php)实现了以下 MVC 代码。我不想使用 Zend 或 Symfony，因为我只需要一个小结构，但我真的需要稍微扩展一下。

我是 PHP 新手，所以想知道是否有人使用过这个或者知道我如何添加另一个视图。我已经得到了我用来加载我的布局的链接版本，但想在这个布局中添加一个能够调用其他页面的内容部分。

对此的任何帮助都会很棒！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T05:19:09.880

下面的神..那个视频太可怕了。

在现有示例中，如果您想添加另一个“视图”（实际上并不是视图），您将需要控制器中的另一个方法：

```
class Controller
{
    // -- snip --
    // you need to change the constructor too
    public function __construct()
    {
        $this->load = new Load;
        $this->model = new Model;
    }

    // -- snip --

    public function gallery()
    {
        $list = $this->model->get_urls();
        if ( count($list) > 0 )
        {
            $this->load->view('gallery.php' , $list);
        }
        else
        {
            $this->load->view('error.php', array(
                 'source' => 'gallery',
                 'reason' => 'empty'
            ));
        }
    }

    // -- snip --
} 
```

您还需要更改*tinyMvc.php*文件：

```
$c = new Controller;
$action = 'home';
if ( isset( $_GET['page']))
{
    $action = $_GET['page'];
}

if ( method_exists( $c, $action) )
{
    $c->{$action}();
}
else
{
    echo 'no such action !';
} 
```

反正。整个“教程”使用 MVC 的术语，这并不是真正的内容。他的“观点”其实只是一个简单的模板。对于初学者来说，这并不完全是学习如何做的事情，但他的实现也很糟糕。如果你想学习如何制作简单的原生 php 模板，你可能会发现[这篇文章](http://codeangel.org/articles/simple-php-template-engine.html)很有用。

# java - JAX-RS 中的 QueryParam 和 MatrixParam 有什么区别？

> ID：10183875
> 
> 赞同：28
> 
> 时间：2012-04-17T01:23:50.313
> 
> 标签：java, jax-rs

`@QueryParam`JAX-RS和 之间有什么区别`@MatrixParam`？从文档中。查询参数和矩阵参数都可以在特殊条件下定位一种资源。那么用例有什么区别呢？

ps：

查询参数：

`url ? key=value;`

矩阵参数

`url; key=value;`

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2017-10-04T13:07:19.847

> `@MatrixParam`注释将应用于 URL 中存在的特定资源， 并将`@QueryParam`应用于整个请求 URL。

以任何超市为例，如果您想要满足多种条件的所有水果，例如 type=fruits 并且价格范围从 300 开始并列出匹配的 10 种水果，您可以进行以下 API 设计，

```
http://dev.brandstore.com/inventory/grocery;type=fruits/price;range=300/?limit=10 
```

在上面的示例中，第一个 Matrix 参数`type=fruits`仅适用于**杂货**资源，同样`range=300`适用于仅**价格**资源，但用于分页的查询参数`limit=10`适用于整个请求 URL。是的，如果只使用查询参数，你最终会得到像“grocery_type”和“grocery_price”这样的参数，并且你会失去请求中参数的位置所增加的清晰度。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-04-17T03:35:37.257

# java - JVM 选项：传递了哪些值？

> ID：10183881
> 
> 赞同：0
> 
> 时间：2012-04-17T01:24:33.023
> 
> 标签：java, jvm

我在我的 Ubuntu Linux 主机上使用 commadline java 和 javac，我想知道如何获取传递给 JVM 的选项列表和值，例如 -Xmx -Xms -Xss ？

我也无法在`man java`or上找到此信息，对此`man javac`我感到非常惊讶。你能帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T01:33:14.610

我假设您在问什么是可能的命令行选项及其潜在值。

[这](http://docs.oracle.com/javase/7/docs/technotes/tools/solaris/java.html)是 JVM 的 Solaris/Linux 版本的手册页。

所有工具的特定操作系统版本的文档链接的通用页面在[这里](http://docs.oracle.com/javase/7/docs/technotes/tools/index.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T01:48:52.957

如果您需要在运行时访问此信息，您可以使用 JMX 管理 bean，特别是 [RuntimeMXBean.getInputArguments](http://docs.oracle.com/javase/6/docs/api/java/lang/management/RuntimeMXBean.html#getInputArguments%28%29)。此外，许多值可从相关 bean 获得，例如[当前堆内存](http://docs.oracle.com/javase/6/docs/api/java/lang/management/MemoryMXBean.html#getHeapMemoryUsage%28%29)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T01:39:00.800

快速浏览：
[Javac 选项](http://docs.oracle.com/javase/1.5.0/docs/tooldocs/windows/javac.html)（可能适用于 1.5，但对于最新的 JRE/JDK 仍然适用）
[Linux/Solaris](http://docs.oracle.com/javase/1.5.0/docs/tooldocs/solaris/java.html)中的 JRE 默认选项，最初在[Java](http://www.oracle.com/technetwork/java/javase/tech/vmoptions-jsp-140102.html) HotSpot VM 选项中找到（请参阅**Java HotSpot VM 选项的类别**部分）。

希望这可以帮助！

# php - 加载 100 行 mysql 行是否比仅加载 5 行更需要资源？

> ID：10183885
> 
> 赞同：1
> 
> 时间：2012-04-17T01:25:12.890
> 
> 标签：php, mysql, database

我正在为大约 100 个项目做一个分页系统。我的问题是：

我应该只加载所有 100 个然后使用 jQuery 切换页面而不重新加载吗？或者我应该使用带有“LIMIT 5”的 MySQL 查询，然后，每次用户按下下一页或上一页时，都会启动另一个带有 LIMIT 5 的 Mysql 查询？

对于每个项目，我都必须加载缩略图，但我可以将其保存在缓存中以避免使用我的服务器带宽。

从服务器资源的角度来看，哪一个是最佳选择？

提前致谢。问候

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T02:20:03.497

尝试通过命令行界面直接连接到您的 MySql 实例。在一次执行 100 的查询，然后执行`LIMIT 5`. 查看毫秒结果。这将告诉您哪个更有效或资源需求更少。

一次来自 MySql 的 100 条记录（取决于数据集）真的没什么。对于正确编写的查询/数据库模式，性能影响不会很明显。

也就是说，我投票赞成一次只调用你需要的结果。使用该`LIMIT`子句和您的 jquery 分页方法来提高效率。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-17T02:21:58.593

对于服务器来说，最有效的方法是一次抓取所有 100 个项目，将它们发送给客户端一次，然后让客户端页面在本地通过它们。这可能是一个昂贵的查询，但总体而言，这比让客户为每增加五个项目来回走动要便宜。

话虽如此，这是否可行是另一个话题。您不想一次将大量数据推送到您的客户端，因为它会减慢页面加载和客户端处理速度。事实上，通常希望将客户端消耗的带宽保持在最低限度。从那个 POV 来看，仅在必要时才发出具有五个结果的小型 AJAX 请求是更可取的。除非 100 个结果总体上太小以至于没有太大区别。

哪一个最适合你，你需要弄清楚。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-17T02:27:12.027

很大程度上取决于您的查询。如果它是从精心设计的表（索引集等）中进行的简单 SELECT，那么除非您在功能非常不足的服务器上运行，否则请求 100 行和 5 行之间不会有明显差异。如果是复杂的查询，那么您可能应该限制查询的数量。

其他需要考虑的因素是加载页面需要多长时间，例如到服务器接收客户端数据的实际往返时间。我将大胆猜测您在美国或欧洲，那里的互联网速度很快，并不是整个世界都那么幸运。限制站点必须从服务器请求数据的次数是一个比服务器负载量更好的指标。

这正在迅速进入 UX，但您的用户并不关心您的服务器负载，他们也不关心这种方式是否意味着您的平均负载是 0.01 而不是 0.02。他们会关心您是否在站点的各个部分之间进行了几乎瞬时的转换。

就个人而言，我会采用“加载所有数据，然后在本地页面”的方法。还要记住，Ajax 是您的朋友，如果必须，请加载结果页面，然后请求数据。您可以将请求分成两部分：第一页和其余页面。您可以进行许多幕后调整，以使您的网站看起来非常快，这是人们注意到的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-17T02:18:38.487

我会说，一次加载5个并分页。我的考虑：

1.  一次加载5个确实轻了很多
2.  并非所有用户都会浏览全部 100 个，因此加载的那些甚至可能不会被使用
3.  5 条记录之间的轻微加载时间是预期的（即大多数用户不会因为他们必须等待 500 毫秒 - 1 秒而抱怨）

您还可以为用户提供每页显示 x 个项目的选项，并设置`all`选项以让用户查看页面中的所有项目。随着时间的推移，您还可以根据每页要显示的 x 个项目数来监控大多数用户的偏好，然后将其作为默认设置`LIMIT`

# android - Android 代码，Activity.onTouchEvent 未知来源

> ID：10183886
> 
> 赞同：0
> 
> 时间：2012-04-17T01:25:16.130
> 
> 标签：android

您好已更改 Opencv 示例，仅在用户触摸屏幕时添加操作。代码有树类。FdActivity 扩展了 Activity，FdViewBase 扩展了 SurfaceView 并实现了 SurfaceHolder.Callback，最后 FdView 扩展了 FdViewBase。

FdActivity的onCreate方法：

```
public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        requestWindowFeature(Window.FEATURE_NO_TITLE);            
        setContentView(new FdView(this));        
      } 
```

FdViewBase 在类构造函数中有方法调用'setFocusable(true);' .
最后是 onTouchEvent 代码：

```
public boolean onTouchEvent(MotionEvent event) {                  
         //   if (event.getAction() == MotionEvent.ACTION_DOWN) 
              Log.i(TAG,"DOWN");                
            Log.i(TAG,"/\");
            return true;
        } 
```

以这种方式，代码不会发生编译或执行错误，但如果我取消注释 if 语句，我会收到以下错误消息：

```
04-16 21:59:06.011: I/OpenCV_NativeCamera(8952): ### Camera FPS ### [780] Frames, 12.84 FPS
    04-16 21:59:06.662: D/AndroidRuntime(8952): Shutting down VM
    04-16 21:59:06.662: W/dalvikvm(8952): threadid=1: thread exiting with uncaught exception (group=0x40018560)
    04-16 21:59:06.732: E/AndroidRuntime(8952): FATAL EXCEPTION: main
    04-16 21:59:06.732: E/AndroidRuntime(8952): java.lang.NullPointerException
    04-16 21:59:06.732: E/AndroidRuntime(8952):     at org.opencv.samples.fd.FdActivity.onTouchEvent(Unknown Source)
    04-16 21:59:06.732: E/AndroidRuntime(8952):     at android.app.Activity.dispatchTouchEvent(Activity.java:2099)
    04-16 21:59:06.732: E/AndroidRuntime(8952):     at com.android.internal.policy.impl.PhoneWindow$DecorView.dispatchTouchEvent(PhoneWindow.java:1721)
    04-16 21:59:06.732: E/AndroidRuntime(8952):     at android.view.ViewRoot.deliverPointerEvent(ViewRoot.java:2200)
    04-16 21:59:06.732: E/AndroidRuntime(8952):     at android.view.ViewRoot.handleMessage(ViewRoot.java:1884)
    04-16 21:59:06.732: E/AndroidRuntime(8952):     at android.os.Handler.dispatchMessage(Handler.java:99)
    04-16 21:59:06.732: E/AndroidRuntime(8952):     at android.os.Looper.loop(Looper.java:130)
    04-16 21:59:06.732: E/AndroidRuntime(8952):     at android.app.ActivityThread.main(ActivityThread.java:3835)
    04-16 21:59:06.732: E/AndroidRuntime(8952):     at java.lang.reflect.Method.invokeNative(Native Method)
    04-16 21:59:06.732: E/AndroidRuntime(8952):     at java.lang.reflect.Method.invoke(Method.java:507)
    04-16 21:59:06.732: E/AndroidRuntime(8952):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:847)
    04-16 21:59:06.732: E/AndroidRuntime(8952):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:605)
    04-16 21:59:06.732: E/AndroidRuntime(8952):     at dalvik.system.NativeStart.main(Native Method)
    04-16 21:59:07.432: I/OpenCV_NativeCamera(8952): ### Camera FPS ### [810] Frames, 21.09 FPS
    04-16 21:59:08.864: I/OpenCV_NativeCamera(8952): ### Camera FPS ### [840] Frames, 21.00 FPS
    04-16 21:59:12.588: I/OpenCV_NativeCamera(8952): ### Camera FPS ### [870] Frames, 8.04 FPS
    04-16 21:59:13.168: I/Process(8952): Sending signal. PID: 8952 SIG: 9 
```

我不知道为什么会这样，似乎事件源不可见。

Eclipse 没有显示任何警告或错误消息，LogCat 中也没有出现其他错误。所以有人知道为什么会这样吗？

谢谢=]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T02:28:44.533

```
setContentView(new FdView(this)); 
```

替换上面的代码如下

```
View view = new FdView(this);
view.setOnTouchListener(this);
setContentView(view); 
```

这是因为您没有将 ontouch 设置为任何视图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T01:28:05.977

尝试`false`从你那里返回 onTouchEvent() 监听器。

当您返回时`true`，该事件不会进一步传播，并且可能会导致 NPE。

# r - 如何在 ggplot2 中添加第二个轴标签？

> ID：10183888
> 
> 赞同：7
> 
> 时间：2012-04-17T01:25:17.687
> 
> 标签：r, ggplot2

基于我[之前的问题](https://stackoverflow.com/questions/10183292/how-can-i-remove-empty-factors-from-ggplot2-facets)，我想在绘图的另一侧添加第二个轴标签。

数据框如下所示：

```
test <- structure(list(characteristic = structure(c(1L, 2L, 3L, 1L, 2L
), .Label = c("Factor1", "Factor2", "Factor3"), class = "factor"), 
    es = c(1.2, 1.4, 1.6, 1.3, 1.5), ci_low = c(1.1, 1.3, 1.5, 
    1.2, 1.4), ci_upp = c(1.3, 1.5, 1.7, 1.4, 1.6), label = structure(c(1L, 
    3L, 5L, 2L, 4L), .Label = c("1.2 (1.1, 1.3)", "1.3 (1.2, 1.4)", 
    "1.4 (1.3, 1.5)", "1.5 (1.4, 1.6)", "1.6 (1.5, 1.7)"), class = "factor"), 
    set = structure(c(1L, 1L, 1L, 2L, 2L), .Label = c("H", "S"
    ), class = "factor")), .Names = c("characteristic", "es", 
"ci_low", "ci_upp", "label", "set"), class = "data.frame", row.names = c(NA, 
-5L)) 
```

使用[Tyler 的解决方案](https://stackoverflow.com/users/1000343/tyler-rinker)，它的图形现在看起来像这样：

![在此处输入图像描述](../Images/f07b26e69cd4eae2e72c87383b87565e.png)

以类似于森林图的方式，我想添加第二组标签（`label`我的数据框中的变量）代表图形值，最好在面板的右侧。所以这一切都模仿了类似于这个例子的森林图：

![在此处输入图像描述](../Images/332bed395db6ef47725dd9b89d7bef26.png)

我知道第二个轴[似乎不受欢迎](https://stackoverflow.com/questions/3099219/how-to-use-ggplot2-make-plot-with-2-y-axes-one-y-axis-on-the-left-and-another)。然而，这些只是另一组标签。它似乎是森林地块中的一种习俗。

我怎么能在ggplot中做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-19T01:49:51.643

**编辑**更新到 ggplot2 0.9.3

将测试数据框中的一组标签添加到多面图表非常简单。`geom_text`与标签的美学以及标签的 x 和 y 位置一起使用。在下面的代码中，`xlim`为标签创建了更多空间。以下代码：

```
library(gridExtra)
library(ggplot2)

p <- ggplot(test, aes(y = characteristic, x = es, xmin = ci_low, xmax = ci_upp)) + 
  geom_point() +   
  geom_errorbarh(height = 0) +
  geom_text(aes(label = label, x = 2, y = characteristic)) + 
  scale_x_continuous(limits = c(1, 2.2), breaks = c(1, 1.2, 1.4, 1.6, 1.8),
    labels=c("1.0", "1.2", "1.4", "1.6", "1.8")) +
  facet_grid(set ~ ., scales = "free", space = "free") +
  theme_bw() + 
  theme(strip.text.y = element_text(angle = 0),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank())
p

grid.text(expression(paste("ES " %+-% " ci")), x = 0.78,   y = .92,
   gp = gpar(fontsize = 18)) 
```

产生：

![在此处输入图像描述](../Images/3ed7ebda6f08521d28210d2928e1a589.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-10-11T11:08:58.510

这是我的答案：（由于没有找到完整的答案，我不死帖子。我仍在寻找添加“钻石”摘要）

它非常“自动化”。

*   lgOR = 具有估计值和 CI 95% 的数据。

*   ci_lower = 95% CI 更低

*   ci_upper = 95% CI 上限

*   作者=作者/日期

*   Model_pars <- paste( orH2, ort2, orI2, orModel, orModel_sig, sep=" | ") # 这些是 Heterogeneity stats - as subtitle.

    ```
     min_v     <- floor(min(lgOR$ci_lower))
     max_v     <- ceiling(max(lgOR$ci_upper))
     OR_v      <- as.matrix( round(lgOR$OR,2) )
     ORci      <- paste("(", round(lgOR$ci_lower,2), "|", round(lgOR$ci_upper,2), ")" )

     ggplot(data=lgOR, aes(y=1:nrow(lgOR), x=OR, xmin=ci_lower, xmax=ci_upper)) +
       geom_point() + 
       geom_errorbarh(height=.3) +
       scale_y_continuous(name = "", breaks=1:nrow(lgOR), labels=lgOR$author ) +
       scale_x_continuous(limits = c( min_v, max_v + 3 ), 
                          breaks = c( min_v:max_v, max_v + 3 ),
                          expand = c(0,0) )+
       labs(title='Effect Size by Study', x=Model_pars, y = 'Study') +
       geom_vline(xintercept=0, color='black', linetype='dashed', alpha=.5) +
       theme( axis.title.x = element_text(size = 8),
              axis.text.x = element_text(size = 7),
              axis.title.y = element_text(size = 1)) +
       geom_text(aes(x=9, label= paste(OR_v, ORci ))) 
    ```

# php - 如何将会话数据插入数据库？

> ID：10183890
> 
> 赞同：0
> 
> 时间：2012-04-17T01:25:36.097
> 
> 标签：php, arrays, session

我已经设置了一个购物篮，它是一个会话列表，存储在一个名为`['list']`. 我想提取会话数据（有关列表项的信息）并将它们插入数据库表中。

```
session_start();
Print_r ($_SESSION['list']);

if ( !isset($_SESSION['username']) && ($_SESSION['list']) )
{
   header("Location:index.php");
   exit();
} 
```

结果：

数组 ( [1] => 数组 ( [ISBN] => 0923184232 [书名] => asodiaso [作者] => lolstan [价格] => 5.99 ) [2] => 数组 ( [ISBN] => 6677889900 [书名] => 圣殿骑士守则 [作者] => CM Palov [价格] => 18.99 ) )

^ 我想把这个信息插入到一个表中！:)

通过使用它，我可以打印出包含在数组中的会话变量，但我需要做的是提取变量，然后将它们插入到另一个数据库表中。我不知道如何去提取它们，所以有什么建议吗？

我熟悉如何将信息插入数据库表（MYSQL）。

插入方法如下所示：

```
$query = "INSERT INTO orderhistory VALUES ('','".$ISBN."','".$bookname."','".$author."','".$price."', '')"; 
```

目前我的 addtobasket.php 看起来像：

`

```
require "dbconn.php";

//Connects to database
$connect = mysql_connect($host, $user, $password )
or die ("Hey loser, check your server connection.");

//Make sure we are using the right database
mysql_select_db($database);

$ISBN = $_SESSION['list']['ISBN'];
$bookname = $_SESSION['list']['bookname'];
$author = $_SESSION['list']['author'];
$price = $_SESSION['list']['price'];

// Set up the query using the values that were passed via the URL from the form
$query = "INSERT INTO orderhistory 
VALUES('','".$ISBN."','".$bookname."','".$author."','".$price."', '')"; 
```

是的，我知道这是错的！:((

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T02:15:29.297

```
$query = "INSERT INTO orderhistory
VALUES('','".$ISBN."','".$bookname."','".$author."','".$price."', '')"; 
```

需要是：

```
$query = "INSERT INTO orderhistory
VALUES('', '$ISBN', '$bookname', '$author', '$price')" 
```

你有太多和不必要的引号

`''`只要您在数据库中将其设置为 NULL（您不需要），您就不需要该字段中的 final 。如果您希望在`date`每次插入时都使用空白字段，我建议您`NULL`在数据库中使用

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T01:38:21.703

如果您只想将变量的内容转储到数据库字段中，您可以使用[`serialize()`](http://php.net/manual/en/function.serialize.php)或[`json_encode()`](http://php.net/manual/en/function.json-encode.php)将您的数组转换为可以轻松转换回来的字符串。

顺便说一句，我强烈建议切换到 PDO 和准备好的语句以避免基本的 sql 注入问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T01:40:08.967

也许这种代码会帮助你：

```
$con = mysql_connect('myserver', 'myusername', 'mypassword') or die('Error: ' . mysql_error());
mysql_select_db("mydatabase", $con);
mysql_query("SET NAMES 'utf8'", $con);

$insert_query = "UPDATE mytable SET field='" . $_SESSION["value"] . "' WHERE id='" . $_SESSION["id"] . "'";

$result = mysql_query($insert_query) or die(mysql_error());
mysql_close($con); 
```

# python - Python 字典

> ID：10183892
> 
> 赞同：0
> 
> 时间：2012-04-17T01:25:58.727
> 
> 标签：python, for-loop, dictionary

我是 Python 新手，正在尝试创建一个非常简化的foursquare 版本。

我希望用户能够签到以及按日期和位置搜索他们以前的签到。我拥有的代码似乎可以在签入时正常工作，但搜索并未将结果返回给用户。我知道我在`for`循环中的措辞不正确，但我对如何搜索字典感到困惑。

非常感谢您的帮助。

```
print("What would you like to do? \n1 Check-in \n" \
  "2 Search check-ins by date \n3 Search check-ins by location \n4 Exit")

while True:
    import datetime
    current_date = str(datetime.datetime.now())
    check_in = {}
    choice = input("\nYour choice: ")

    if choice == '1':
        location = input("\nPlease enter your current location: ")
        check_in[current_date] = location
        print("You have checked in at", location, current_date)

    elif choice == '2':
        date_search = input("Please enter a date (yyyy/mm/dd) ")
        for date in check_in.keys():
            if date_search in check_in(date):
                print(check_in[key])

    elif choice == '3':
        location_search = input("Please enter a location: ")
        for date in check_in.keys():
            if location_search in check_in(date):
                print(date)

    elif choice == '4':
        break 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T01:47:56.590

几点说明：

1.  每次通过循环，你都在冲洗`check_in`. 不管我们之前在里面放了什么，当我们回到它时它就不会存在了。

2.  选择 2 可以简化为一个简单的`d.get(key)`陈述。你可以在这里查看它是如何工作[的](http://docs.python.org//library/stdtypes.html#dict)。

3.  您使用的密钥不会按照您认为的方式打印。如果我输入一个位置，比如“家”，则键显示为：

    ```
    Please enter your current location: Home
    You have checked in at Home 2012-04-16 19:44:26.235305
    {'2012-04-16 19:44:26.235305': 'Home'} # Print statement added by me. 
    ```

注意到所有这些额外的信息了吗？是的，不是你所期望的。如果您只想获取日期部分，您可以更多[`datetime`](http://docs.python.org//library/datetime.html#module-datetime)地查看模块以了解如何使其完美，或者偷懒（就像我在调试时一样），并使用`datetime.datetime.now().split()[0]`. 这段令人费解的代码将字符串按空格拆分，然后获取第一个元素 - 或`'2012-04-16'`。

最后一个选择我将作为练习留给你，但我认为检查[字典文档](http://docs.python.org//library/stdtypes.html#dict)足以让你开始。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T01:51:50.687

将您的 s 更改`input`为`raw_input`s，否则在 Python 2.7.2 中，此代码将评估`input`as 代码，而不是实际的数字或字符串。不完全是你想要的，我想。

至于您在字典中搜索的最后一个问题，您在字典中的匹配检查将永远不会匹配。您在 while 的`check_in`每个循环上重新初始化变量。您还将当前日期/时间以不同于您接受用户输入的格式输入到字典中。

> 请输入您当前的位置：首页
> 
> ('你已经在', '家', '2012-04-16 20:43:08.891334')
> 
> 您的选择：2
> 
> 请输入日期 (yyyy/mm/dd) 2012/04/16
> 
> 你的选择：

您需要规范化您的数据和输入，并移出`check_in`while 循环。

```
 print("What would you like to do? \n1 Check-in \n2 Search check-ins by date \n3 Search check-ins by location \n4 Exit")

check_in = {}

while(True):
    import datetime
    current_date = datetime.datetime.now().strftime("%Y/%m/%d")
    choice = raw_input("\nYour choice: ")

    if(choice == '1'):
        location = raw_input("\nPlease enter your current location: ")
        check_in[current_date] = location
        print check_in

    elif(choice == '2'):
        date_search = raw_input("Please enter a date (yyyy/mm/dd) ")
        for date,location in check_in.iteritems():
            if date_search == date:
                print "%s - %s" % (date,location)

    elif(choice == '3'):
        location_search = raw_input("Please enter a location: ")
        for date,location in check_in.iteritems():
            if location_search == location:
                print "%s - %s" % (date,location)
    elif(choice == '4'):
        break 
```

# c# - 子字符串，如果字符串不够长，则用空格替换字符

> ID：10183896
> 
> 赞同：4
> 
> 时间：2012-04-17T01:26:53.910
> 
> 标签：c#, substring

我正在尝试比较字符串的前 3 个字符，我正在尝试使用子字符串然后进行比较。

字符串是从输入文件中读取的，字符串长度可能不是 3 个字符。如果字符串不是 3 个字符长，我希望子字符串方法用空格替换空字符。

我将如何去做。

当字符串不够长时，当前代码会引发异常。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-17T01:29:16.027

使用[String.PadRight](http://msdn.microsoft.com/en-us/library/36f2hz3a.aspx)

```
myString.PadRight(3, ' ');
// do SubString here.. 
```

您还可以创建一个在字符串不够大时不会引发异常的[`.Left`扩展方法：](http://wordaligned.org/articles/rewriting-stringleft)

```
public static string Left(this string s, int len)
{
    if (len == 0 || s.Length == 0)
        return "";
    else if (s.Length <= len)
        return s;
    else
        return s.Substring(0, len);
} 
```

用法：

```
myString.Left(3); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-17T01:31:03.497

在调用 Substring() 之前使用[String.PadRight() 方法之一：](http://msdn.microsoft.com/en-us/library/az8d6582.aspx)

```
string subString = myString.PadRight(3).Substring(0,3); 
```

如果像我上面那样使用带有一个参数的重载，它将插入空格。

```
string subString1 = string1.PadRight(3).Substring(0,3);
string subString2 = string2.PadRight(3).Substring(0,3);
if (String.Compare(subString1, subString2) == 0)
{
    // if equal
}
else
{
    // not equal
} 
```

我使用了单独的变量，因为它更具可读性，但如果您愿意，您可以将它们内联到 if 语句中。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-17T01:29:59.987

你可以使用这个肮脏的技巧：

```
var res = (myStr+"    ").Substring(...); 
```

# php - MySQL命令删除表的所有非主索引

> ID：10183897
> 
> 赞同：3
> 
> 时间：2012-04-17T01:27:02.897
> 
> 标签：php, mysql, indexing, sql-drop

是否有一个 MySQL 命令可以删除除单个表中的第一个索引之外的所有额外索引，从而只保留主索引？

我可以使用以下 MySQL 命令删除第二个**Post_Date**索引，但我在删除其余所有索引时遇到问题。

```
mysql_query("ALTER TABLE $TableName DROP INDEX Post_Date"); 
```

额外的**Post_Date**和**Post_Date_x**索引是在脚本开头创建的，所以我想在脚本末尾使用 MySQL 命令删除它们。

请记住**Post_Date_x**中的**_x**和变化，可能从 1 到 10，或从 1 到 100。因此可能需要循环或 IF 语句。

 **MySQL 命令将成为 PHP 脚本的一部分

感谢您的时间。

```
Action  Keyname Type    Unique  Packed  Column  Cardinality Collation   Null    Comment
 Edit    Drop   PRIMARY BTREE   Yes No  id  830 A       
 Edit    Drop   Post_Date   BTREE   Yes No  Post_Date   830 A       
 Edit    Drop   Post_Date_2 BTREE   Yes No  Post_Date   830 A       
 Edit    Drop   Post_Date_3 BTREE   Yes No  Post_Date   830 A       
 Edit    Drop   Post_Date_4 BTREE   Yes No  Post_Date   830 A       
 Edit    Drop   Post_Date_5 BTREE   Yes No  Post_Date   830 A       
 Edit    Drop   Post_Date_6 BTREE   Yes No  Post_Date   830 A       
 Edit    Drop   Post_Date_7 BTREE   Yes No  Post_Date   830 A       
 Edit    Drop   Post_Date_8 BTREE   Yes No  Post_Date   830 A 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T08:27:10.683

这应该这样做 -

```
$res = mysql_query("SHOW INDEX FROM `$TableName` WHERE `Key_name` LIKE 'Post_Date%'");

while ($row = mysql_fetch_object($res)) {
    mysql_query("DROP INDEX `{$row->Key_name}` ON `{$row->Table}`") or die(mysql_error());
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T01:35:08.147

抱歉，没有用于`ALTER TABLE ny_table DROP ALL INDEXES EXCEPT PRIMARY KEY`.

您必须在创建每个索引时为其创建一个特定名称，然后创建一个循环以`ALTER TABLE ... DROP INDEX`使用相同名称为每个索引单独运行 SQL 命令。

另请注意，创建索引相当昂贵 - 除非您执行 > ~200 个由索引优化的查询，否则创建和删除索引可能需要比使用它们节省的时间更多的时间。**

# vim - 在 vim 中浏览以前的编辑点？

> ID：10183898
> 
> 赞同：1
> 
> 时间：2012-04-17T01:27:15.930
> 
> 标签：vim, text, editor

vim 中是否可以递归导航到以前的编辑点（即文本已更改的点）？这样的功能对于 $\TeX$ 文档编辑非常有用，您经常需要将大块文本移动相当长的距离，并且导航会变得非常混乱。

如果无法使用基本 vim 完成，欢迎使用具有此功能的插件。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-17T04:50:21.560

像`Ctrl-O`和`Ctrl-I`？这些循环通过“跳转列表”（`O`向后，`I`向前），这是先前编辑和跳转的列表。

您可以使用打印当前的跳转列表`:ju[mps]`

有关此功能的更多详细信息，请查看`:h jumpslist`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-09-25T20:54:42.547

您可以使用`g;`移动到上次更改发生的位置。

`g,`回到最近的变化。

`:changes`向您展示`g;`并将`g,`带您去往何处。

`gi`与它相同，`g;`只是它也启动插入模式。

# python - 在 Django 模板中迭代 dict 时遇到问题

> ID：10183903
> 
> 赞同：2
> 
> 时间：2012-04-17T01:27:58.473
> 
> 标签：python, django, dictionary, django-templates

关于这个似乎有一百万个问题（和答案），但没有一个对我有用。

我有这样的事情：

```
test_dict = {'name':'Joe'}
return render_to_response('home.html',test_dict,context_instance=RequestContext(request)) 
```

在模板中，我正在尝试这样做：

```
{% for k,v in test_dict.items %}
  Hello {{ v }} <br />
{% endfor %} 
```

但没有运气。另一方面，这有效：

```
Hello {{ name }} 
```

（没有 for 循环）。我一定错过了一些非常明显的东西吗？

**编辑**
为了回应第一个答案，我也试过这个：

```
test_dict = {'name':'Joe'}
data = {'test_dict':test_dict}

return render_to_response('home.html',data,context_instance=RequestContext(request)) 
```

在模板中：

```
{% block content %}
  {% for k, v in data.items %}
    Hello {{ v }} <br />
  {% endfor %}
{% endblock %} 
```

还是什么都没有出现。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T01:31:20.663

做你想做的事，你会想要像

```
data = {'test_dict':test_dict}
return render_to_response('home.html',data,context_instance=RequestContext(request)) 
```

从[文档](https://docs.djangoproject.com/en/dev/topics/http/shortcuts/#optional-arguments)

> 要添加到模板上下文的值字典。

因此，在您的示例中， test_dict 被注入到模板上下文中。想想它是这样工作的：

```
template = Template()
for k, v in dictionary.items():
    template[k] = v 
```

所以 test_dict 没有被注入到模板的上下文中，但是 test_dict 的键和值被注入了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T19:44:45.153

什么时候：

```
test_dict = {'name':'Joe'}
data = {'test_dict':test_dict}

return render_to_response('home.html',data,context_instance=RequestContext(request)) 
```

采用：

```
{% for k, v in test_dict.items %} 
```

# node.js - 针对特定于会话的中间件的 Node.js 单元测试

> ID：10183906
> 
> 赞同：3
> 
> 时间：2012-04-17T01:28:12.677
> 
> 标签：node.js, cookies, express

我正在为依赖于连接中的持久会话的中间件编写单元测试。（即connect-mongo）。

我想创建一个假会话，但似乎无法弄清楚如何。

我的浏览器中有一个 connect.sid cookie，我假设它以某种加密方式与我的会话集合中的 _id 相关。

这是我尝试过的：

我将 cookieParser 中间件和会话存储添加到服务器，然后使用以下请求将其发送到服务器（从 chrome 的开发工具面板复制密钥）：

```
var jar = request.jar(),
    cookie = request.cookie('connect.sid=<REALLYLONGKEY>');
jar.add(cookie);
request({url : 'http://localhost:8585/',jar : jar},this.callback); 
```

在服务器端正确设置 cookie，并且我已经验证会话正在工作。

然而，从 cookie 到 session 的神奇转换并没有像我希望的那样发生——正确的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T19:24:30.213

只有存在具有该 ID 的会话时，才能在服务器上设置 cookie。谁首先创建了会话？

我可以告诉你我在我的服务器上做了什么。我想创建模拟客户端并向服务器发送请求的测试。我需要一种方法来验证客户端。我的服务器允许基于 Google OAuth 的身份验证。但是，我不想麻烦教客户登录 Google 帐户。

我的解决方案是实施另一种登录我的服务器的方法——只使用用户名。此功能仅在测试期间启用，在生产时禁用。我的测试客户现在可以毫无问题地登录。作为登录的结果，它们会收到 cookie 'connect.sid'，并在后续请求中将其发送回服务器。

我也使用 request.jar() 为我的请求创建了一个 cookie jar。但是，我应该注意，只有在同时模拟多个客户端并且每个客户端都需要一个单独的 cookie jar 时，才需要这样做。

# php - 最小脚本——仍然无法修改标头信息——标头已发送

> ID：10183923
> 
> 赞同：0
> 
> 时间：2012-04-17T01:31:02.893
> 
> 标签：php, http, file-upload, download

这真让我抓狂。这似乎是一个简单的错误——我看过几十篇关于他们的脚本的帖子比我的要复杂得多。

我有一个 php 脚本，它应该通过设置标题来强制下载。我已将脚本精简为：

```
<?php
header("Content-Type: audio/mp3");
header("Content-Disposition: attachment; filename=\"audio.mp3\";" );
readfile("audio.mp3");
exit();
?> 
```

为什么我的标头会被发送出去？我尝试了 obj_start 和 obj_flush，但到目前为止还没有运气。这可能是我的主机的问题吗？我正在使用 1and1.com

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T06:21:09.527

您的脚本在测试时运行良好——确保脚本的开头或结尾没有任何空格。

# javascript - 如何在单个页面或 div 上禁用 javascript

> ID：10183933
> 
> 赞同：1
> 
> 时间：2012-04-17T01:32:16.117
> 
> 标签：javascript, jquery, css, wordpress

我需要在单个页面上关闭一些 jquery 淡入淡出，因为它会导致它无法正确加载。

该页面不公开查看，但是当我单击选项卡时它在css中创建了选项卡，就像我正在更改页面一样淡出，然后没有加载任何内容。

是否可以更改 javascript，或在单个页面上禁用它？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T01:42:38.067

**在包含默认 JS 代码后**添加以下内容，以覆盖其行为。

```
<script type="text/javascript">
   $(document).ready(function()
   {
      $("a").unbind("click");

      $("a").click(function(event)
      {
         event.preventDefault();
      });
   });
</script> 
```

这应该消除`<a>`元素具有淡入淡出效果的投标。

文档：[http ://api.jquery.com/unbind/](http://api.jquery.com/unbind/)

# python - 在模块之间共享设置的正确方法

> ID：10183935
> 
> 赞同：3
> 
> 时间：2012-04-17T01:32:36.953
> 
> 标签：python

我有一个包含 10 个不同 python 文件的项目。它有类和功能——几乎很多。我确实想在所有项目文件之间共享代表项目设置的特定数据。

我想出了创建一个`settings.py`文件：

```
settings = {}
settings['max_bitrate'] = 160000
settings['dl_dir'] = r"C:\Downloads" 
```

然后我从每个文件中导入类。

有没有更合适的方法呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T01:49:26.917

在这方面我可能有点老派，但在我的最新项目中，我在 中创建了一个配置文件`/etc`，然后创建了一个`config`用于[`ConfigParser`](http://docs.python.org/library/configparser.html)读取它并使其可用的模块，并`config`在我需要阅读的任何地方导入该模块设置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T04:57:54.137

您的方法对我来说听起来不错，并且具有您可以轻松更改设置模块的实现的优点，例如使用配置文件或 Windows 注册表，或提供只读 API。

# c# - 从表单中删除控件

> ID：10183937
> 
> 赞同：0
> 
> 时间：2012-04-17T01:33:05.563
> 
> 标签：c#, .net, winforms, windows-forms-designer

我目前有一个自定义控件，它不知何故失去了它的父级，现在没有任何东西的父级，但它仍然在表单设计器的控件列表中。删除按钮也不起作用，因此被禁用。这种情况时不时发生，并且通过设计器代码并手动删除是一件痛苦的事情，而且还有其他开发人员认为这会惹恼并可能使他们感到困惑。

因此，我试图在控件 ComponentDesigner 中添加一个 Verb 以从表单中删除自身。但我意识到，因为它不是任何东西的“孩子”，所以它不能像孩子一样被删除。因此，我将如何通过代码从表单设计器中删除控件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T01:52:17.550

当您的某个控件在设计时引发异常时，可能会发生这种情况。这很少是无声的事件，设计师会显示一个弹出消息框。当您使用 try/catch 吞下代码中的异常时，可能不会出现消息框。

试图通过破解设计师来解决这个问题只会增加问题。通过编辑设计器代码来修复它，当您知道自己在做什么时就可以了。如果你找不到原因，那就把它弄到一个可以让它有点重现的地步。然后启动 Visual Studio 的另一个实例，Tools + Attach to Process 并选择第一个实例。调试 + 异常，勾选 CLR 异常的抛出框，以便调试器在抛出异常时停止。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T01:52:03.830

1.  备份文件。

2.  打开设计器文件；例如，`Form1.Designer.cs`

3.  展开这个区域： `Windows Form Designer generated code`

4.  您应该能够在代码中找到您的控件并将其删除。当心。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T04:27:42.440

我通过在“文档大纲”选项卡中找到松散的控件解决了这个问题。这种方式非常简单并且是图形化的。

# jquery - 在所有图像加载完成后，如何使 jquery 加载？

> ID：10183941
> 
> 赞同：0
> 
> 时间：2012-04-17T01:33:23.967
> 
> 标签：jquery

我有一页充满了不同宽度和高度的图像。我需要得到三个宽度。但是 jquery 总是在图像加载之前完成。所以我得到的图像宽度是一个破碎的图像宽度。

我试过 $(document) 和 $(window)，都失败了。任何人都可以帮助我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T03:40:19.603

您可以使用`$(window).load()`只有在所有内容都满载时才会触发的选项。主要缺点是任何交互代码（例如按钮单击）只有在所有内容加载后才可用。一个更好的选择是仅使用[imagesloaded 插件](https://github.com/desandro/imagesloaded)之类的东西来推迟图像处理代码，并将其`$(document).ready()`用于其余代码。

# javascript - 连续触发功能，每个功能之间有延迟

> ID：10183942
> 
> 赞同：0
> 
> 时间：2012-04-17T01:33:27.347
> 
> 标签：javascript, jquery, function, settimeout

我在这样的类中有一堆不同的功能：

```
var helper = {    

     h1 : function(){
           //does  stuff        
    },

     h2 : function(){   
         //does  stuff
    },

    ...

} 
```

我可以执行我需要的东西：

```
$('#helper').click(function(){
    helper.h4();
 // then delay then execute h5(), delay h6(), etc... 
     }); 
```

我怎么能拥有它，以便函数在每个函数之间定义连续执行`delay`。我不知道我怎么能做到这一点，但我怀疑我需要 使用`queue`,`dequeue`和?`delay``setTimeout`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T02:26:16.547

你可以简单地做：

```
setTimeout(helper.h4, 0);
setTimeout(helper.h5, 1000);
setTimeout(helper.h6, 2000);
… 
```

请注意，每个超时都将立即开始，因此延迟来自同一时刻（或多或少）。您可能希望从调用中捕获返回的值，以便可以取消由于任何原因尚未调用的超时。

# c - Equivalence of p[0] and *p for incomplete array types

> ID：10183943
> 
> 赞同：20
> 
> 时间：2012-04-17T01:33:34.470
> 
> 标签：c, arrays, pointers, gcc, incomplete-type

Consider the following code (it came about as a result of [this discussion](https://stackoverflow.com/a/10183715/129570)):

```
#include <stdio.h>

void foo(int (*p)[]) {          // Argument has incomplete array type
    printf("%d\n", (*p)[1]);
    printf("%d\n", p[0][1]);    // Line 5
}

int main(void) {
    int a[] = { 5, 6, 7 };
    foo(&a);                    // Line 10
} 
```

GCC 4.3.4 [complains](http://ideone.com/rsrRA) with the error message:

```
prog.c: In function ‘foo’:
prog.c:5: error: invalid use of array with unspecified bounds 
```

Same error message in GCC 4.1.2, and seems to be invariant of `-std=c99`, `-Wall`, `-Wextra`.

So it's unhappy with the expression `p[0]`, but it's happy with `*p`, even though these should (in theory) be equivalent. If I comment out line 5, the code compiles and does what I would "expect" (displays `6`).

Presumably one of the following is true:

1.  My understanding of the C standard(s) is incorrect, and these expressions *aren't* equivalent.
2.  GCC has a bug.

I'd place my money on (1).

**Question:** Can anyone elaborate on this behaviour?

**Clarification:** I'm aware that this can be "solved" by specifying an array size in the function definition. That's not what I'm interested in.

* * *

**For "bonus" points:** Can anyone confirm that MSVC 2010 is in error when it rejects line 10 with the following message?

```
1><snip>\prog.c(10): warning C4048: different array subscripts : 'int (*)[]' and 'int (*)[3]' 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-17T01:45:37.007

Section 6.5.2.1 of n1570, Array subscripting:

> **Constraints**
> 
> One of the expressions shall have type ‘‘pointer to complete object type’’, the other expression shall have integer type, and the result has type ‘‘type’’.

So the standard forbids the expression `p[0]` if `p` is a pointer to an incomplete type. There is no such restriction for the indirection operator `*`.

In older versions/drafts of the standard, however, (n1256 and C99), the word "complete" is absent in that paragraph. Not being involved in any way in the standard procedure, I can only guess whether it's a breaking change or the correction of an omission. The behaviour of the compiler suggests the latter. That is reinforced by the fact that `p[i]` is per the standard identical to `*(p + i)` and the latter expression doesn't make sense for a pointer to an incomplete type, so for `p[0]` to work if `p` is a pointer to an incomplete type, an explicit special case would be needed.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-17T01:55:13.083

My C is a bit rusty, but my reading is that when you have an `int (*p)[]` this:

```
(*p)[n] 
```

Says "dereference `p` to get an array of ints, then take the nth one". Which seems naturally to be well defined. Whereas this:

```
p[n][m] 
```

Says "take the nth array in p, then take the mth element of that array". Which doesn't seem well-defined at all; you have to know how big the arrays are to find where the nth one starts.

This *could* work for the specific special case where n = 0, because the 0th array is easy to find regardless of how big the arrays are. You've simply found that GCC isn't recognising this special case. I don't know the language spec in detail, so I don't know whether that's a "bug" or not, but my personal tastes in language design are that `p[n][m]` should either work or not, not that it should work when `n` is statically known to be 0 and not otherwise.

Is `*p <===> p[0]` really a definitive rule from the language specification, or just an observation? I don't *think* of dereferencing and indexing-by-zero as the same operation when I'm programming.

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-17T04:26:23.363

For your "bonus points" question (you probably should have asked this as a separate question), MSVC10 is in error. Note that MSVC only implements C89, so I have used that standard.

For the function call, C89 §3.3.2.2 tells us:

> Each argument shall have a type such that its value may be assigned to an object with the unqualified version of the type of its corresponding parameter.

The constraints for assignment are in C89 §3.3.16:

> One of the following shall hold: ... both operands are pointers to qualified or unqualified versions of compatible types, and the type pointed to by the left has all the qualifiers of the type pointed to by the right;

So we can assign two pointers (and thus call a function with a pointer parameter using a pointer argument) if the two pointers point to compatible types.

The compatibility of various array types is defined in C89 §3.5.4.2:

> For two array types to be compatible, both shall have compatible element types, and if both size specifiers are present, they shall have the same value.

For the two array types `int []` and `int [3]` this condition clearly holds. Therefore the function call is legal.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-17T04:43:28.523

```
void foo(int (*p)[])
{
    printf("%d\n", (*p)[1]);
    printf("%d\n", p[0][1]);    // Line 5
} 
```

Here, `p` is a pointer to an array of an unspecified number of `int`s. `*p` accesses that array, so `(*p)[1]` is the 2nd element in the array.

`p[n]` adds p and n times the size of the pointed-to array, which is unknown. Even before considering the `[1]`, it's broken. It's true that zero times anything is still 0, but the compiler's obviously checking the validity of all the terms without short-circuiting as soon as it sees zero. So...

> So it's unhappy with the expression p[0], but it's happy with *p, even though these should (in theory) be equivalent.

As explained, they're clearly not equivalent... think of `p[0]` as `p + 0 * sizeof *p` and it's obvious why....

> For "bonus" points: Can anyone confirm that MSVC 2010 is in error when it rejects line 10 with the following message? 1>\prog.c(10): warning C4048: different array subscripts : 'int (*)[]' and 'int (*)[3]'

Visual C++ (and other compilers) are free to warn about things that they think aren't good practice, things that have been found empirically to be often erroneous, or things the compiler writers just had an irrational distrust of, even if they're entirely legal re the Standard.... Examples that may be familiar include "comparing signed and unsigned" and "assignment within a conditional (suggest surrounding with extra parentheses)"

# python - 重新键入字典

> ID：10183946
> 
> 赞同：1
> 
> 时间：2012-04-17T01:33:51.023
> 
> 标签：python, random, dictionary

所以我有一个 Python 任务，我需要使用字典来保存菜单项，然后随机重新键入并重新排序菜单，以便我可以更改打印出来的菜单选项的顺序。这是我拥有的代码示例：

```
ChoiceOne = "Rekey Menu"
ChoiceTwo = "Quit"
menu = {'1':ChoiceOne, '2':ChoiceTwo,}
userChoice = input("Please Enter the Integer for Your Menu Choice: ")

while userChoice not in menu.keys():
    print("Invalid Input")
    userChoice = input("Please Enter the Integer for Your Menu Choice: ")

if menu[userChoice] == ChoiceOne:
    menu = rekey(menu)
elif menu[userChoice] == ChoiceTwo:
    quit() 
```

上面的代码在用户选择不退出时循环，一遍又一遍地重复打印菜单。以下是我的 rekey() 函数

```
def rekey(menu):
    rekey = {}
    keylist = random.sample(range(10), 2)
    for i, item in zip(keylist, menu ):
        rekey[i] = menu[item]
    return rekey 
```

我的问题似乎出现在我检查菜单选项的用户输入是否有效的行中。最初，输入“1”或“2”以外的任何内容都会导致程序进入 While 循环，直到输入有效输入。然而，在重新键入菜单后，“当 userChoice 不在 menu.keys() 中时”行总是被触发，并且没有匹配的输入来继续程序。

我试图通过打印字典中的新键并检查 userChoice 是否与其中任何一个匹配来找到问题，但即使我选择了一个有效的新键，程序似乎认为我输入的任何内容都不是一个有效的密钥。

我希望我已经很好地描述了这个问题以便理解，提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T01:42:07.123

在您的第一种情况下，菜单键是*字符串*，在 rekey 之后它们是*ints*。您需要对键或用户输入进行转换，以便它们匹配。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T01:46:53.990

根据[文档](http://docs.python.org/library/functions.html#input)，该`input(x)`功能相当于`eval(raw_input(x))`. 这意味着在输入提示符下输入“1”相当于在 python 解释器中输入“1”，所以得到*整数*1。

正如 SpliFF 已经指出的那样，您需要确保在菜单字典中使用整数键，或者您可以对字典使用字符串键并切换到使用`raw_input`函数来读取用户的选择。

# c# - 从 .cs 文件调用时脚本不起作用

> ID：10183948
> 
> 赞同：0
> 
> 时间：2012-04-17T01:34:31.740
> 
> 标签：c#, asp.net

我正在尝试在 gridview 的 Row_Command 事件中执行以下操作。但是弹出框永远不会出现，我已经尝试了很多不同的方式..但没有运气。如果有人能看到这个问题，我真的很感激一个指针。

```
protected void Gridview_RowCommand(object sender, GridViewCommandEventArgs e)
{
    if(e.CommandName == "Merchant")
    {
        if (ItemsAvailable)
        {
            StringBuilder sb = new StringBuilder();
            MyClass class = new MyClass();
            TList<LineItems> otherItems = MyClass.GetItems(id);
            bool IsNotAvailable = false;

            foreach (LineItems item in otherItems)
            {
                Merchandise skuMerchandise = skuMerchandise.GetMerchandise(otherItems.mid);
                if (skuMerchandise  != null)
                {
                    if (skuMerchandise.AvailableItems <= 0)
                    {
                        sb.Append(OtherItems.Name);
                        sb.Append(Environment.NewLine);
                        IsNotAvailable = true;
                    }
                }
            }

            if (IsNotAvailable)
            {
                Page.ClientScript.RegisterClientScriptBlock(this.GetType(), "key", 
                    "function Redirect() {location.href = 'homePage.aspx';} 
                    if(confirm('The items : "+sb.ToString()+" will arrive in 1 month. 
                    Do you wish to continue?') == true){Redirect();};", true);
            }
        }
    } 
```

每次我单击该按钮时，它就像什么都没有通过。虽然当我添加断点时 IsNotAvailable 为真，但从不提示前夕。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T02:21:00.950

你可以用更简单的方法，

1.  在设计/单独的脚本文件中定义 javascript 函数，以便它接受项目的名称。例如。我的功能（项目名称）

2.  在您的 CS 文件中，只需添加对该函数的调用，

    if (IsNotAvailable) { Page.ClientScript.RegisterClientScriptBlock(this.GetType(), "key", "myFunction('" + itemName + "') } }

这将使事情变得更简单，您将能够确认这是一个 Javascript 问题还是您如何通过 CS 文件编写它的问题。

**更新：**

你的第一个目标应该是确保你的 JS 函数对你有用，所以在任何事情之前，在一个空的 html 文件中添加以下代码并运行它，

```
<script type='text/javascript'>
ItemNotInStock('item');

function ItemNotInStock(itemName)
{
var message = "The following items are no longer in stock :" + itemName + ". 

Would you like to continue?";

if (confirm(message) == true)
{ location.href = "homePage.aspx"; }

} 
```

如果您正确重定向，则执行下面提到的操作。

在您的设计文件中定义以下 javascript（在本地测试，在 chrome 中为我工作，）

```
<script type='text/javascript'>
function ItemNotInStock(itemName)
{
var message = "The following items are no longer in stock :" + itemName + ". 

Would you like to continue?";

if (confirm(message) == true)
{ location.href = "homePage.aspx"; }

} 
```

在您的 C# 代码中，添加以下行

```
if (IsNotAvailable)
        {
            Page.ClientScript.RegisterClientScriptBlock(this.GetType(), "key", 
string.Format("ItemNotInStock('{0}');", itemName);
        }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T01:44:28.200

确保您的 JavaScript 代码使用您选择的浏览器的开发人员工具中可用的断点执行，例如[Chrome 开发人员工具：断点](https://developers.google.com/chrome-developer-tools/docs/scripts-breakpoints)

顺便说一句：如果您立即将其与下一行一起丢弃，您为什么要创建 Merchandise 的实例？

# .net - WCF 休息服务和用户信息持久性

> ID：10183953
> 
> 赞同：0
> 
> 时间：2012-04-17T01:35:20.737
> 
> 标签：.net, wcf, cookies, wcf-rest

我试图通过 WCF 休息服务将登录用户作为 cookie 持久保存。我通过 WCF 休息服务使用的组件设置 cookie，如下所示：

```
var cookie = new HttpCookie("Key");
.
.
cookie.HttpOnly = true;

HttpContext.Current.Response.Cookies.Add(cookie); 
```

但是 cookie 在检索时为空：

```
HttpContext.Current.Request.Cookies.Get("Key"); //returns null 
```

对于 WCF 休息服务，cookie 不是这样做的好方法，还是有另一种方法？

**编辑**：我应该注意我正在为网站使用相同的组件，并且它非常适合它。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T03:15:24.837

我最好的猜测是您的服务需要具有 [AspNetCompatibilityRequirements(RequirementsMode = AspNetCompatibilityRequirementsMode.Required)] 属性才能访问 HttpContext [MSDN 详细信息](http://msdn.microsoft.com/en-us/library/system.servicemodel.activation.aspnetcompatibilityrequirementsattribute.aspx)

# javascript - jQuery 和 jsFiddle，无法让 PreventDefault() 在 $.submit() 上工作

> ID：10183954
> 
> 赞同：3
> 
> 时间：2012-04-17T01:35:28.540
> 
> 标签：javascript, jquery, jsfiddle

在过去的 2 个小时里，我一直试图让这个基本功能正常工作，其中大约 1/2 小时在 jsFiddle 上。我不知道为什么，但我无法`preventDefault()`处理表单提交按钮。

这是HTML：

```
<form action="" method="post">
    <input type="text" name="search-query" value="" id="search-query">
    <input type="submit" value="Search" name="submit" id="search-submit">
</form>​ 
```

这是JS：

```
$('#search-submit').submit(function(e) {
    e.preventDefault();
    alert("hello");
});​ 
```

当我在自己的代码中尝试时，表单被提交，就好像 preventDefault() 不存在一样。当我在 jsFiddle 中尝试时，我收到以下错误消息：

```
{"error": "Shell form does not validate{'html_initial_name':
u'initial-js_lib', 'form': <mooshell.forms.ShellForm object
at 0x9139fcc>, 'html_name': 'js_lib', 'label': u'Js lib', 'field':
<django.forms.models.ModelChoiceField object at 0x91392cc>,
'help_text': '', 'name': 'js_lib'}"} 
```

（我不知道为什么错误引用了 mooTools，因为我选择了 jQuery 1.7.1。）这是 jsFiddle：http: [//jsfiddle.net/pv2TX/11/](http://jsfiddle.net/pv2TX/11/)

我的代码有问题吗？我正在使用的选择器应该可以工作，并且我能够在其上调用其他 jQuery 事件，但我似乎无法将任何类型的单击处理程序绑定到它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T01:36:33.157

[`submit`](http://api.jquery.com/submit/)在表单本身上触发，而不是在单击的按钮上触发。从文档：

> 当用户尝试提交表单时，提交事件被发送到元素。它只能附加到`<form>`元素上。

所以你只需要选择你的表格而不是`button`：

```
$("#form_selector").submit(function (e) {
    e.preventDefault();
}); 
```

**更新小提琴：http:** [//jsfiddle.net/AvCCb/](http://jsfiddle.net/AvCCb/)

# java - 动态创建相对布局时没有显示

> ID：10183960
> 
> 赞同：0
> 
> 时间：2012-04-17T01:36:22.907
> 
> 标签：java, android, android-layout, android-widget

嗨，我的代码一直存在空指针异常问题（请参阅我的其他问题），所以我已经开始动态创建我的视图。

这是我的代码：

```
public class HarvestLifeActivity extends Activity implements OnTouchListener {

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    //add touch listeners for buttons : assign each a name and link it.
    View MoveUp = findViewById(R.id.up);
    MoveUp.setOnTouchListener(this); // use (this) to link to the current onTouchListener references in class declaration above.
    View MoveDown = findViewById(R.id.down);
    MoveDown.setOnTouchListener(this);
    View MoveLeft = findViewById(R.id.left);
    MoveLeft.setOnTouchListener(this);
    View MoveRight = findViewById(R.id.right);
    MoveRight.setOnTouchListener(this);

}

@Override
protected void onStart() {
    super.onStart();

    Drawable standing = getResources().getDrawable(R.drawable.test_circle);
    //code to convert character size from pixel to dp
    DisplayMetrics metrics = new DisplayMetrics();
    getWindowManager().getDefaultDisplay().getMetrics(metrics);
    float logicalDensity = metrics.density;

    int pxToConv = 50;
    int convToDp = (int) (pxToConv / logicalDensity + 0.5);

    RelativeLayout characterContainer = new RelativeLayout(this);
    RelativeLayout.LayoutParams characParams = new RelativeLayout.LayoutParams(convToDp, convToDp);
    characParams.addRule(RelativeLayout.CENTER_IN_PARENT);
    characterContainer.setBackgroundDrawable(standing);
    characterContainer.setId(101);

}
// Process button clicks

public boolean onTouch(View v, MotionEvent event) {
    switch(v.getId()){
        case R.id.up:
            switch (event.getAction()) {

            case MotionEvent.ACTION_DOWN:

                //as long as up button is pressed it will keep moving character up
               while (event.getAction() == MotionEvent.ACTION_DOWN)
               {    
                    RelativeLayout characterContainer = (RelativeLayout) findViewById(101);
                    Drawable walking = getResources().getDrawable(R.drawable.test_circle_red);
                    int startX = characterContainer.getLeft();
                    int startY = characterContainer.getTop();
                    int defaultWidth = characterContainer.getWidth();
                    int defaultHeight = characterContainer.getHeight();

                        //create new position for character 1 pixel closer to the top of screen
                        int newX = startX - 1;
                        int newY = startY;

                        //remove character
                        RelativeLayout view = (RelativeLayout) characterContainer;
                        ViewGroup owner = (ViewGroup) view.getParent();
                        owner.removeView(view);

                        //re make character in new position created above and assign background as walking forwards animation
                        RelativeLayout.LayoutParams characParams = new RelativeLayout.LayoutParams(defaultWidth,defaultHeight);
                        characParams.leftMargin = newY;
                        characParams.topMargin = newX;
                        characterContainer.setLayoutParams(characParams);           
                        characterContainer.setBackgroundDrawable(walking); 
                        }

                    break;

                    // when button is let go of

                case MotionEvent.ACTION_UP:

                    RelativeLayout characterContainer = (RelativeLayout) findViewById(101);
                    Drawable standing = getResources().getDrawable(R.drawable.test_circle);
                    characterContainer.setBackgroundDrawable(standing);

                    default:
                    break;
                    }
                    return true;

           case R.id.down:
               .. ..
            }
    return true;
    }
} 
```

当我运行它时，创建的布局不存在。

有什么我错过的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T04:30:56.420

you are not adding your created layout to the existing view.

thats your problem.

```
addview(your_layout); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T01:45:03.293

您正在创建一个 RelativeLayout 对象，但从不将其设置为窗口的内容......

让你的 onCreate 看起来像这样：

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    //Cut these lines out of onStart();
    RelativeLayout characterContainer = new RelativeLayout(this);
    RelativeLayout.LayoutParams characParams = new RelativeLayout.LayoutParams(convToDp, convToDp);
    characParams.addRule(RelativeLayout.CENTER_IN_PARENT);
    characterContainer.setBackgroundDrawable(standing);
    characterContainer.setId(101);

    setContentView(characterContainer);

    //add touch listeners for buttons : assign each a name and link it.
    /*View MoveUp = findViewById(R.id.up);
    MoveUp.setOnTouchListener(this); // use (this) to link to the current onTouchListener references in class declaration above.
    View MoveDown = findViewById(R.id.down);
    MoveDown.setOnTouchListener(this);
    View MoveLeft = findViewById(R.id.left);
    MoveLeft.setOnTouchListener(this);
    View MoveRight = findViewById(R.id.right);
    MoveRight.setOnTouchListener(this);*/

} 
```

# javascript - javascript 中的递归函数、setTimeout 和“this”关键字

> ID：10183963
> 
> 赞同：1
> 
> 时间：2012-04-17T01:36:47.460
> 
> 标签：javascript, recursion, this, settimeout

假设我想使用 onClick 方法调用一个函数。像这样：

```
<li class="inline" onclick="mve(this);" >TEMP</li> 
```

而且我有一个看起来像这样的 JS 函数：

```
function mve(caller){
caller.style.position = "relative";
caller.style.left = (caller.style.left+20) +'px';
var foo = setTimeout('mve(caller)', 2000);
} 
```

我的问题是元素（调用者引用的）在初始 onClick 调用后未定义。至少这是 Firebug 告诉我的。

我确信这是一个简单的解决方案，那么简单解释一下为什么以及如何做呢？

另外，如果我像这样运行它：

```
function mve(caller){
caller.style.position = "relative";
caller.style.left = (caller.style.left+20) +'px';
} 
```

我认为元素会在每次点击时向右移动 20px，但事实并非如此。想法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-17T01:48:50.973

`setTimeout()`在全局范围内执行字符串参数，因此您的值`this`不再存在，您的参数也不再存在`caller`。这是不将字符串参数与 setTimeout 一起使用的众多原因之一。使用像这样的实际 javascript 函数引用，解决相应地传递参数是一个非常简单的问题：

```
function mve(caller){
    caller.style.position = "relative";
    caller.style.left = (caller.style.left+20) +'px';
    setTimeout(function() {
        mve(caller)
    }, 2000);
} 
```

对于你的问题的第二部分，`caller.style.left`它上面会有单位，`20px`所以当你添加`20`它时，你会得到`20px20`，这不是浏览器可以理解的值，所以什么也不会发生。您需要从中解析出实际数字，将数字加 20，然后像这样重新添加单位：

```
function mve(caller){
    caller.style.position = "relative";
    caller.style.left = (parseInt(caller.style.left), 10) +20) + 'px';
    setTimeout(function() {
        mve(caller)
    }, 2000);
} 
```

此功能缺少的东西是它停止重复的一种方式。正如你现在拥有的那样，它会永远持续下去。我可能会建议像这样传递一些迭代：

```
function mve(caller, iterationsRemaining){
    caller.style.position = "relative";
    caller.style.left = (parseInt(caller.style.left), 10) +20) + 'px';
    if (--iterationsRemaining) > 0) {
        setTimeout(function() {
            mve(caller, iterationsRemaining)
        }, 2000);
    }
} 
```

此外，您可能很想知道这并不是真正的递归函数。那是因为`mve()`函数调用`setTimeout()`然后立即完成。它是在一段时间后`setTimeout()`执行下一次迭代，`mve()`并且多个函数调用的堆栈帧上没有累积，因此没有实际的递归。从代码上看，它确实看起来像递归，但在技术上不是。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T01:52:09.593

第一次调用后调用者可能超出范围。您可以通过创建一个具有全局范围的变量来保留它，该变量保留调用者的值：

```
var globalCaller;
function onClickEvent(caller) {
    globalCaller = caller;
    mve();
}

function mve() {
    globalCaller.style.position = "relative";
    globalCaller.style.left = (caller.style.left+20) +'px';
    var foo = setTimeout('mve()', 2000);
} 
```

不过，这真的很丑。通过传递 li 元素的 id，然后改为调用 getElementById()，您将创建更简洁的代码。或者更好的是，使用 jQuery 并改用 $("#id") 语法。

# c++ - C++ ifstream 尝试在写入时打开文件

> ID：10183964
> 
> 赞同：2
> 
> 时间：2012-04-17T01:36:51.500
> 
> 标签：c++, file-io, locking, ifstream

我不断地在一个目录中轮询文件，每次我看到一个满足某些读取标准的文件时，我都会打开文件并解析它。

```
string newLine;

ifstream fileReader;

fileReader.open(filename.c_str());

while(!fileReader.eof())
{
getline(fileReader, newLine);
    // do some stuff with the line...
}
filereader.close(); 
```

上面的代码在一个循环中，每 1 秒运行一次，检查目录中的新文件。我的问题是，当我将文件传输到文件夹中进行处理时，我的循环找到了文件并将文件名传递给 ifstream，然后 ifstream 打开它并尝试解析一个不完整的文件。如何让 ifstream 在尝试解析文件之前等到文件完成写入？

编辑：想在这里更好地表达这个问题，因为回复者似乎误解了我的问题。我有 2 个目录

```
mydirectory/
mydirectoryParsed/ 
```

我的代码的工作方式是我的程序检查 mydirectory/ 中的文件，当它找到它们时，解析它们并使用文件中的信息。没有写入文件。完成文件解析后，文件将移至 mydirectoryparsed/

问题是，当我通过网络将文件传输到 mydirectory/ 时，ifstream 会在传输过程中看到这些文件，并在它们完成写入目录之前开始读取它们。如何让 ifstream 等到文件完全写入后再解析？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T01:52:21.527

不要将文件直接传输到程序正在观看的目录中；相反，将它们转移到同一驱动器上的不同目录中，然后在转移完成后将它们移动到监视目录中。这样，完整的文件就会在单个原子操作中出现在监视目录中。

或者，您可以在监视目录中使用命名约定——将“.partial”之类的后缀附加到正在传输的文件中，然后在传输完成后重命名文件以删除后缀。让您的程序忽略名称以后缀结尾的文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T01:40:06.710

您不应该在每次写入文件时都打开文件。打开一次！

一些伪代码是：

> ```
> 1- Open file
> 2- Get the data you want to write, treat that data
> 3- Call the write to file function
> 4- Loop until you have nothing left to write
> 5- Close de file 
> ```

# django - django loaddata 问题与 postgres 中的新日期时间字段

> ID：10183965
> 
> 赞同：0
> 
> 时间：2012-04-17T01:36:59.477
> 
> 标签：django, postgresql, postgresql-9.1, loaddata, dumpdata

由于时区问题，我最近将项目的数据库从 sqlite 转换为 postgres。转换在我的本地开发环境中运行良好。但是，在我的 webfaction 生产环境中，当我尝试使用 loaddata 从我的 json 文件中填充数据库时，我收到以下错误消息：

```
Problem installing fixture 'smartcarpools.json': Traceback (most recent call last):
  File "/home/mb52089/webapps/smartcarpools_prod/lib/python2.7/django/core/management/commands/loaddata.py", line 169, in handle
    for obj in objects:
  File "/home/mb52089/webapps/smartcarpools_prod/lib/python2.7/django/core/serializers/json.py", line 35, in Deserializer
    for obj in PythonDeserializer(simplejson.load(stream), **options):
  File "/home/mb52089/webapps/smartcarpools_prod/lib/python2.7/django/core/serializers/python.py", line 128, in Deserializer
    data[field.name] = field.to_python(field_value)
  File "/home/mb52089/webapps/smartcarpools_prod/lib/python2.7/django/db/models/fields/__init__.py", line 710, in to_python
    raise exceptions.ValidationError(self.error_messages['invalid'])
ValidationError: [u'Enter a valid date/time in YYYY-MM-DD HH:MM[:ss[.uuuuuu]] format.'] 
```

我注意到 webfaction 使用 postgres 8.3，而我的本地开发环境使用 9.1。

非常感谢对初学者的任何帮助。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T05:14:18.570

我在您的错误中没有看到任何提到 PostgreSQL 的内容。它抱怨没有有效的日期/时间。您是否检查过以确保 smarcarpools.json 的所有日期时间都采用“YYYY-MM-DD HH:MM”格式？

哦 - PostgreSQL 8.3 早在 2008 年就发布了。你会想要：

1.  看看 webfaction（托管公司？）是否提供更新的东西
2.  阅读版本 8.4、9.0、9.1 的[发行说明](http://www.postgresql.org/docs/9.1/static/release.html)，以便您了解不同之处。请记住，您不能简单地转储 9.1 数据库并将其加载到 8.3，尽管您应该能够转向另一个方向。

如果您无法在主机上获得最新版本，请为您的平台获取 8.3 的副本 - 如果您使用的是 unix 系统，那么从源代码编译就足够简单了。

# google-analytics - Windows 移动和谷歌分析

> ID：10183971
> 
> 赞同：0
> 
> 时间：2012-04-17T01:38:03.907
> 
> 标签：google-analytics, windows-phone-7.1

我正在用 windows mobile .net 框架做一个项目

我需要用谷歌分析跟踪每一页

因此我在每个页面上创建一个网络浏览器并将其隐藏

Web 浏览器将包含一个本地 html 页面

html 页面已嵌入谷歌分析

但是，如果我使用传统方法或异步方法来集成 GA，它会抛出未指定错误的 js 错误，但是如果我将它放到 webserver 上，则 html 可以正常工作

因此我建立了一个 GA 跟踪图像 url 来记录浏览量和访问者计数，但是我发现 cookie 无法保存，每个页面都会生成一个新的访问者计数

任何建议

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T18:48:13.820

如果我正确理解您的问题，您只是想将 GA 跟踪添加到您的 WP7 应用程序中。如果是这种情况，您不必使用网络浏览器或跟踪图像来完成此操作。GitHub 上有一个项目可以让您在 .xaml 页面中正确执行此操作。

[https://github.com/maartenba/GoogleAnalyticsTracker](https://github.com/maartenba/GoogleAnalyticsTracker)

获取代码，编译它并在您的手机项目中添加对 lib 的引用，然后在您的 xaml 代码中：

```
Loaded += (s, e) => {
                          using (var tracker = new Tracker("UA-XXXXXXXX-X", "appname")) {
                            tracker.TrackPageView("MainPage", "Main");
                          }
                    }; 
```

将您的 GA 帐户信息放入 Tracker 对象中
，然后，您就有了 GA 跟踪。

高温高压

# ruby-on-rails - 你能告诉我 Rails 添加到现有 Ruby 类的任何方法吗？

> ID：10183977
> 
> 赞同：1
> 
> 时间：2012-04-17T01:39:16.167
> 
> 标签：ruby-on-rails, ruby, class

在我提出问题之前，我想提醒大家我是一个编程新手，所以如果我问了一些荒谬的问题，请纠正我。

我一直在阅读有关 Ruby 具有开放类的信息，即可以添加一个方法。但是，我试图举几个例子来说明 Rails 如何添加到现有的 Ruby 类中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T01:59:23.460

我第二马修斯。ActiveSupport 就是一个很好的例子。看看这里的一些源代码文件：

[https://github.com/rails/rails/tree/master/activesupport/lib/active_support/core_ext](https://github.com/rails/rails/tree/master/activesupport/lib/active_support/core_ext)

而且，这是一个典型且简单的示例，它在 Ruby 中的标准 Array 类上添加了有用且有些争议的方法。

[https://github.com/rails/rails/blob/master/activesupport/lib/active_support/core_ext/array/access.rb](https://github.com/rails/rails/blob/master/activesupport/lib/active_support/core_ext/array/access.rb)

大多数 Ruby 库都有一个名为“core_ext”、“ext”的目录或类似的目录，其中包含以某种方式扩展 Ruby 核心库的方法。人们总是重新发明方法，从某种意义上说，ActiveSupport 是这些方法的最终汇编。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T01:47:16.123

Rails 有很多核心扩展，它们位于一个单独的 gem 中[——ActiveSupport](https://rubygems.org/gems/activesupport)。

在这里解释一切是没有意义的，我只是将您指向[Rails 指南](http://guides.rubyonrails.org/active_support_core_extensions.html)。熟悉它们后，需要时参考[文档](http://as.rubyonrails.org/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T02:25:19.843

## 我发现一个很好的例子是时间

### 从 Rails 应用程序

时间。

```
Loading development environment (Rails 3.2.3)
1.9.3p125 :001 > Time.
Display all 252 possibilities? (y or n)
                                           Time.module_exec
Time.__delay__                             Time.mongo_thread_local_accessor
Time.__id__                                Time.name
...

Total = 252 
```

* * *

### 从一个普通的红宝石控制台（IRB）

```
$ irb
1.9.3p125 :001 > Time.
                                 Time.hash                        Time.private_method_defined?
Time.__id__                      Time.include?                    Time.private_methods
Time.__send__                    Time.included_modules            Time.protected_instance_methods
...

Total = 93 
```

# excel - 如何选择表格行/完整表格？

> ID：10183980
> 
> 赞同：2
> 
> 时间：2012-04-17T01:39:49.053
> 
> 标签：excel, excel-2010, vba

设置：我有一个带有用于输入数据的表单的 excel 文档，该表单的数据输入到一个表格中，以便于输入多行数据。至少我是这么认为的。

所以现在我正在尝试选择表格以将其数据插入适当的位置。我认为我的问题是：我是一次选择一个表格行，还是选择整个表格并分别处理每一行。我该怎么做？

我尝试`Sheets("Form").Range("dataForm[#ALL]").Select`了几种变体，但都没有奏效。

如果我选择整个表格，我需要能够单独处理每一行，如果我单独选择每一行，我需要能够从表格顶部开始，因为数据必须是有序的。

有任何想法吗？

编辑：添加细节。我有一个如上所述的表格，它的数据必须根据表格中某些单元格的值插入到不同的表格中。为了便于讨论，我们将命名该单元格类型，它具有三个可能的值，如下拉列表中所定义。这些价值是收入、费用和转移。根据这些值，我们决定将数据添加到哪个表。收入到收入表费用到费用等。

所以我想做的是选择尽可能多的行并将每一行插入正确的表中。排序比我解释的要复杂一些，但是如果我能弄清楚初始排序，那么再排序几次应该很简单。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-17T02:03:43.223

这应该有助于回答您的问题。

```
Sub TableStuff()
Dim lo As Excel.ListObject
Dim loRow As Excel.ListRow
Dim i As Long

Set lo = ActiveSheet.ListObjects(1)
With lo
'this is the address of the whole table
Debug.Print .Range.Address
    For i = 1 To 10
        Set loRow = .ListRows.Add(i)
        loRow.Range.Cells(1).Value = "test" & i
    Next i
Debug.Print .Range.Address
'address of data rows
Debug.Print .DataBodyRange.Address
End With
End Sub 
```

我的博客上有两篇关于表格的文章。最近的[一篇](http://yoursumbuddy.com/copy-table-data-while-not-breaking-references/)文章也可能提供一些见解。

编辑：根据下面的评论并编辑到 OP：

这假定 Activesheet 上有两个表，tblSource 和 tblIncome。它将源表过滤到收入，复制可见行并将它们插入到 tblIncome 的末尾。最后，它删除源行（除一个之外的所有行）。

您需要添加一个循环以使其适用于其他两个类别：

```
Sub MoveTableStuff()
Dim loSource As Excel.ListObject
Dim loTarget As Excel.ListObject
Dim SourceDataRowsCount As Long
Dim TargetDataRowsCount As Long

Set loSource = ActiveSheet.ListObjects("tblSource")
Set loTarget = ActiveSheet.ListObjects("tblIncome")
With loSource
    .Range.AutoFilter Field:=1, Criteria1:="income"
    SourceDataRowsCount = .ListColumns(1).DataBodyRange.SpecialCells(xlCellTypeVisible).Count
End With
With loTarget
    TargetDataRowsCount = .DataBodyRange.Rows.Count
    .Resize .Range.Resize(.Range.Rows.Count + SourceDataRowsCount, .Range.Columns.Count)
    loSource.DataBodyRange.SpecialCells(xlCellTypeVisible).Copy
    .DataBodyRange.Cells(TargetDataRowsCount + 1, 1).PasteSpecial (xlPasteValues)
    Application.CutCopyMode = False
End With
With loSource
    .Range.AutoFilter
    .DataBodyRange.Offset(1).Resize(.DataBodyRange.Rows.Count - 1, .DataBodyRange.Columns.Count).Rows.Delete
End With
End Sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T00:32:41.317

如果您已经为表命名，我有一个函数可以获取其完整数据范围：

```
Public Function GetTableByName(ByVal ws As Worksheet, ByVal tbName As String) As Range

    Dim lObj As ListObject

    For Each lObj In ws.ListObjects
        If Trim(UCase(lObj.Name)) = Trim(UCase(tbName)) Then
            Set GetTableByName = lObj.DataBodyRange
            Exit Function
        End If
    Next lObj

End Function 
```

# javascript - 过滤/选择特定类型的数据

> ID：10183981
> 
> 赞同：0
> 
> 时间：2012-04-17T01:39:53.703
> 
> 标签：javascript, d3.js

我想在我的数据数组中选择具有特定参数值的元素。

前任：

```
[{type: "suv", value:10},{type: "suv", value:20},{type: "berline", value:15},{type: "berline", value:5}] 
```

那么，在绘制我的价值数据时，我将如何只`type:"suv"`考虑 ？

我能找到的唯一类似的东西是 selectAll，但它似乎只选择 UI 中的元素（？）

如果这更简单，请耐心等待，我不太习惯 d3.js，并且有关该主题的信息很少。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-17T02:03:03.537

如果您在使用之前尝试过滤数据`d3.selectAll(...).data(...)...`，请使用以下命令：

```
var myArr = [{type: "suv", value:10},{type: "suv", value:20},{type: "berline", value:15},{type: "berline", value:5}];
var myFilteredArr = myArr.filter(function(d) { return d.type == "suv"; }); 
```

您是否尝试修改已显示的内容？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T02:17:13.380

您可以使用自己的过滤器函数循环遍历数组，如下所示返回一个新数组，其中仅包含与过滤器匹配的元素：

```
var filterArray(arr, key, value) {
    var result = [], item;
    for (var i = 0; i < arr.length; i++) {
        item = arr[i];
        if (item[key] && item[key] === value) {
            result.push(item);
        }
    }
    return(result);
}

var myArr = [{type: "suv", value:10},{type: "suv", value:20},{type: "berline", value:15},{type: "berline", value:5}];
var filteredArr = filterArray(myArr, "type", "suv"); 
```

# java - 无法阅读资源

> ID：10183985
> 
> 赞同：0
> 
> 时间：2012-04-17T01:40:16.057
> 
> 标签：java, resources, getresource

我正在尝试从包中读取 * *.class*资源。我正在使用以下代码来实现这一点......

```
URL path = SomeClass.class.getResource("/source/someClass.class"); 
```

当我运行这段代码时，我最终得到`path = null;`. 但是，如果我使用相同的代码并尝试访问其他资源，例如 * *.gif*和 * *.txt*文件，则它是成功的。我无法访问 * *.class*文件有什么原因吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T01:53:11.230

重新阅读javadoc。我认为它描述了您可以使用 getResource() 的两种方式：

[http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/Class.html#getResource(java.lang.String](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/Class.html#getResource(java.lang.String) )

尝试以下操作：

```
URL path = Class.getResource( "modified/package/SomeClass" ) 
```

您可能想使用：

```
InputStream stream = Class.getResourceAsStream("modified/package/SomeClass") 
```

因为您只是试图将类文件复制到 Jar 文件中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T01:57:45.363

可能是资源路径不正确。因为类目录对项目来说是特殊的。

您可以尝试以下方法：

```
URL path = SomeClass.class.getResource("PackagePath/someClass.class"); 
```

PackagePath 像“/com/xxx/projectTest”。

# string - 字符串操作：将第一个字母随机替换为单词的其他字母之一

> ID：10183987
> 
> 赞同：0
> 
> 时间：2012-04-17T01:41:36.333
> 
> 标签：string, random

我需要将一个单词的第一个字母随机换成其他字母。我遇到的麻烦是指定我只需要随机生成一个字符。我不能使用任何条件，所以任何人都可以推荐一种使用方法吗？

# php - 在两列中显示来自数据库的结果

> ID：10183992
> 
> 赞同：0
> 
> 时间：2012-04-17T01:42:18.193
> 
> 标签：php

编辑：这就是我想要实现的目标：http: [//i.imgur.com/KE9xx.png](http://i.imgur.com/KE9xx.png)

我试图在两列中显示我的数据库中的结果。我对 PHP 有点陌生，所以我对如何执行此操作一无所知。有人可以帮我吗？提前致谢。

这是我当前的代码：

```
include('connect.db.php'); 
// get the records from the database
if ($result = $mysqli->query("SELECT * FROM todo ORDER BY id"))
{
  // display records if there are records to display
  if ($result->num_rows > 0)
  { 
    // display records in a table
    echo "<table width='415' cellpadding='0' cellspacing='0'>";
    // set table headers
    echo "<tr><td><img src='media/title_projectname.png' alt='Project Name' /></td>
        <td><img src='media/title_status.png' alt='Status'/></td>
      </tr>";
    echo "<tr>
        <td><div class='tpush'></div></td>
        <td>&nbsp;</td>
      </tr>"
    while ($row = $result->fetch_object())
    {
      echo "<tr>";
      echo "<td><a href='records.php?id=" . $row->id . "'>" . $row->item . "</a></td>";
      echo "<td>" . $row->priority . "</td>";
      echo "</tr>";
    }
    echo "</table>";
  }
  // if there are no records in the database, display an alert message
  else
  {
    echo "No results to display!";
  }
}
// show an error if there is an issue with the database query
else
{
   echo "Error: " . $mysqli->error;
}
// close database connection
$mysqli->close(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T02:06:56.240

一个好主意是将您的数据存储到一个简单的数组中，然后将它们显示在一个 2 列表中，如下所示：

```
$con = mysql_connect('$myhost', '$myusername', '$mypassword') or die('Error: ' . mysql_error());
mysql_select_db("mydatabase", $con);
mysql_query("SET NAMES 'utf8'", $con);

$q = "Your MySQL query goes here...";
$query = mysql_query($q) or die("Error: " . mysql_error());
$rows = array();
$i=0;

// Put results in an array
while($r = mysql_fetch_assoc($query)) {
    $rows[] = $r;
    $i++;
}

//display results in a table of 2 columns

echo "<table>";
for ($j=0; $j<$i; $j=$j+2)
{
echo "<tr>";
echo "<td>".$row[$j]."</td><td>".$row[$j+1]."</td>";
echo "</tr>";
}
echo "</table>";

mysql_close($con); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T02:20:56.210

```
<table>
  <tr>
    <td>ProjectName</td>
    <td>Status</td>
    <td>ProjectName</td>
    <td>Status</td>
  </tr>
  <?php
     while($row = $result->fetch_object()) {
        echo "<tr>";
        echo "<td>".$row->ProjectName."</td>";
        echo "<td>".$row->Status."</td>";
        echo "<td>".$row->ProjectName."</td>";
        echo "<td>".$row->Status."</td>";      
        echo "</tr>";
     }
  ?>
</table> 
```

这是图片上的东西。使用一点 CSS，您可以操作 tds。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T02:34:44.093

您的函数应与此类似：

```
$query = "SELECT *
         FROM todo 
         ORDER BY id";
$result = $mysqli->query($query);

while($row = $result -> fetch_array()) {
   $feedback .= "<tr>\n<td>" . $row['item'] . "</td><td>" . $row['priority'] . "</td>\n</tr>";
}
return $feedback; 
```

然后，在您的 HTML 中`<table>`已经设置好，并且您通常会在其中插入`<td>`和`<tr>`放置`<?php echo $feedback?>`（其中 $feedback 是 HTML 页面上从函数中检索 $feedback 的假定变量）。这不是一个完整的修复，您的代码很难阅读，但是从这里开始，您应该能够继续填写表格所需的所有额外信息，包括您的 CSS。

# crystal-reports - 水晶报表许可

> ID：10183997
> 
> 赞同：1
> 
> 时间：2012-04-17T01:43:27.900
> 
> 标签：crystal-reports, licensing

我想升级一些 SAP Crystal Reports 副本。我在一家美国公司工作，但位于另一个国家，我想我可以从美国而不是澳大利亚购买它，因为澳大利亚要贵得多。是否有人熟悉 SAP/CR 许可政策。我知道 MS 已经制定了一项许可政策，如果在其他地区使用，他们在美国购买的产品副本无效。

我们在客户端使用 CR 从 C# 应用程序创建报告。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T03:47:52.317

我认为，尽管您想避免让 SAP 有机会拒绝（通过电话询问），但您应该听从 Lee 的建议。（针对您的问题的评论）

它可能会节省许可费用，但除了盗版之外还有责任问题。例如支持/保修，如果您需要起诉 SAP 的责任（在与疏忽相关的软件故障的情况下）等。不仅如此，如果您通过电子邮件和/或录音电话进行通信，您可以追究他们的责任，如果销售代表误导你。

它可能与针对每个地区调整的协议有关，以符合当地适用的法律。也就是说，如果您从国际经销商处购买副本，可能会出现一种独特的情况？听起来很复杂！

哎呀，它甚至可能归结为您使用软件的位置（即网络服务器）和/或付款的国家/地区。（即您有一个区域办事处）

祝你好运。

# node.js - 如何在 Node.js 中将强大的文件上传连接到 socket.io

> ID：10183998
> 
> 赞同：8
> 
> 时间：2012-04-17T01:43:30.717
> 
> 标签：node.js, socket.io

我是节点初学者，我正在尝试通过强大的设置多文件图像上传，它将有一个进度条，并且在每次上传后还会有一个回调，它将在上传完成后将所有图像动态加载到同一页面中。我知道上传开始后我需要使用 socket.io 与浏览器交互。Formidable 有一个用于“进度”的事件监听器。我需要我的客户端脚本来接收接收到的字节以创建上传栏。文件上传完成后，我希望 socket.io 将图像上传位置的 url 传递给客户端，以便客户端可以加载图像并将其动态附加到 DOM。这是我到目前为止的代码。

我的问题是如何在事件侦听器中构造 socket.io 代码以获取“进度”，以便它可以广播到客户端？

这是一些松散的伪代码，向您展示我在说什么：

```
//formidable code:
app.post('/new', function(req,res){
    var form = new formidable.IncomingForm();

    form.addListener('progress', function(bytesReceived, bytesExpected){
      //Socket.io interaction here??
    });

    form.uploadDir = __dirname + '/public/images/';
    form.on('file', function(field, file) {
       //rename the incoming file to the file's name
       fs.rename(file.path, form.uploadDir + "/" + file.name);
       console.log(form.uploadDir + "/" + file.name);
    })
});

//socket.io code
io.sockets.on('connection', function (socket) {
    socket.on('upload', function (msg) {
        socket.broadcast.emit('progress', bytesReceived);
    });
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-04-21T22:59:54.307

我使用了节点强大的 v1.0.14 和 socket.io 1.0.0-pre。

当客户端发送请求时，将建立连接，服务器将根据他的会话 ID 为该客户端创建一个房间。

之后在进度事件中，我们会将百分比广播给房间中的一位客户。

在这里您可以找到有关房间的更多信息：[https ://github.com/LearnBoost/socket.io/wiki/Rooms](https://github.com/LearnBoost/socket.io/wiki/Rooms)

服务器 app.js（主要，在启动时）：

```
io.on('connection', function (socket) {
  console.log('CONNECTED');
  socket.join('sessionId');
}); 
```

服务器开机自检：

```
form.on('progress' , function (bytesRecieved , bytesExpected) {
  console.log('received: ' + bytesRecieved);
  io.sockets.in('sessionId').emit('uploadProgress', (bytesRecieved * 100) / bytesExpected);
}); 
```

客户：

```
var socket = io.connect('http://localhost:9000');
socket.on('uploadProgress' , function (percent){
  alert(percent);
}); 
```

当您想使用会话时，这可能会有所帮助：[http ://www.danielbaulig.de/socket-ioexpress/#comment-11315](http://www.danielbaulig.de/socket-ioexpress/#comment-11315)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T16:43:26.217

这应该适合你

```
form.addListener('progress' , function(bytesRecieved , bytesExpected){
  io.sockets.on('connection', function (socket) {
   socket.emit('uploadProgress', ((bytesRecieved * 100)/bytesExpected));
  });
 }); 
```

在客户端：

```
script(src='/socket.io/socket.io.js')  // thats jade, but link to the .js anyway you want
 var socket = io.connect('http://localhost');
  socket.on('uploadProgess' , function(percent){
   $('#percent').text(percent); 
 }); 
```