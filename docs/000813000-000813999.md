# StackOverflow 问答 000813000-000813999

# powershell - PostBuild 中的 PowerShell 脚本

> ID：813003
> 
> 赞同：17
> 
> 时间：2009-05-01T20:01:15.920
> 
> 标签：powershell, cmd

# 持续集成

我一直在编写一个 PowerShell 脚本来简化我们的开发过程。我计划将它作为构建后事件运行，但我遇到了一些麻烦。

在 PowerShell 提示符下，以下内容非常有效：

```
PS C:\> ./example.ps1 
```

但是，当尝试`cmd.exe`按如下方式运行时：

```
C:\> powershell -command "&\"C:\path to script\example.ps1\"" 
```

脚本执行，但我从 PowerShell 得到一轮错误，主要包括来自`resolve-path`函数的路径解析错误：

> 解决路径：找不到路径'C:\Documents and Settings\bdunbar\My Documents\Visual Studio 2008\Projects\CgmFamilyComm\FamilyComm\iirf\cms\isapirewrite4.dl l'，因为它不存在。在 C:\Documents and Settings\bdunbar\My Documents\Visual Studio 2008\Projects\C gmFamilyComm\scripts\cms.ps1:4 char:27 + $iirfpath = (resolve-path <<<< ../iirf/cms /isapirewrite4.dll).path,
> 
> 解决路径：找不到路径'C:\Documents and Settings\bdunbar\My Documents\Visual Studio 2008\Projects\CgmFamilyComm\FamilyComm\familycomm'，因为它不存在。在 C:\Documents and Settings\bdunbar\My Documents\Visual Studio 2008\Projects\C gmFamilyComm\scripts\cms.ps1:5 char:27 + $vdirpath = (resolve-path <<<< ../familycomm)。小路

有没有办法解决这个问题？`resolve-path`在 下运行会不会是一个问题`cmd.exe`？

# [更新]

我已经能够改变一些事情来解决正在发生的错误，但我仍然会收到从 powershell 命令提示符处完全正常工作的错误。我不知道有什么区别。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-05-01T22:50:14.810

我过去做过这项工作（如果有兴趣，请参阅[http://sharepointpdficon.codeplex.com/SourceControl/changeset/view/13092#300544 ）：](http://sharepointpdficon.codeplex.com/SourceControl/changeset/view/13092#300544)

> C:\WINDOWS\system32\windowspowershell\v1.0\powershell.exe -NoLogo -NonInteractive -Command .'$(ProjectDir)Deployment\PostBuildScript.ps1' -ProjectDir:'$(ProjectDir)' -ConfigurationName:'$(ConfigurationName )' -TargetDir:'$(TargetDir)' -TargetFileName:'$(TargetFileName)' -TargetName:'$(TargetName)

然后将这些参数放在构建后脚本的第一行（如果您认为可以使用它们）：

`param($ProjectDir, $ConfigurationName, $TargetDir, $TargetFileName)`

另外我应该指出，我目前没有使用它。我确实喜欢将它用作快速暂存器来重新加载测试数据以运行集成测试。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-02T23:44:15.437

看起来您的问题是如何解决相对路径。相对路径是基于当前位置（存储在 中`$pwd`）而不是基于脚本的位置来解析的。因此，如果您从 启动脚本`C:\`，它肯定不会工作。

我建议您根据参数计算路径（如 Peter Seale 节目），或从以下位置获取脚本的实际位置：

```
$MyInvocation.MyCommand.Path 
```

# perl - 通过 CGI 和 Perl 发送邮件有什么区别？

> ID：813008
> 
> 赞同：2
> 
> 时间：2009-05-01T20:01:56.090
> 
> 标签：perl, sendmail

我在 perl 中使用 sendmail 并注意到（在头撞墙之后）当脚本在命令行运行时，它需要您在电子邮件和收件人的电子邮件地址之后省略 \n(s)为了正确格式化邮件，但是当通过 CGI 运行时，如果那些 \n(s) 不存在，它会返回一个错误，指出收件人的电子邮件格式不正确。

有人遇到过这种情况么？两人在做什么不同？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T20:18:28.780

我敢打赌，您是从命令行的提示中获取数据，而不是[像](http://perldoc.perl.org/functions/chomp.html)这样咀嚼它们：

```
my $send_to = <>; 
```

这意味着 $send_to 已经有一个“\n”。为了使它们都以相同的方式工作，请选择变量：

```
my $send_to = <>;
chomp($send_to); 
```

要不就

```
chomp(my $send_to = <>); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T20:15:23.497

数据从何而来？硬编码在脚本中，还是来自网络表单？

顺便说一句，如果您从网络表单中获取收件人的电子邮件地址，您的表单*将*被垃圾邮件发送者使用。这是 100% 的保证。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T21:44:27.573

术语“CGI”很宽泛，如果你的意思是你的 perl 脚本作为 CGI 运行而不是你的 perlscript 在命令行运行，我会关注脚本的路径及其一般继承环境。特别是如果您以不同的用户 ID 运行它。如果网络服务器在 chroot 中，等等。

```
use Data::Dumper;
warn(Dumper(\%ENV)); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-05T01:03:18.990

所以我猜你有这样的东西可以通过命令行运行它：

```
my $your_email = "you@foo.bar";
my $recipient_email = "them@foo.bar"; 
```

当“通过 CGI 运行”时：

```
my $your_email = "you@foo.bar\n";
my $recipient_email = "them@foo.bar\n"; 
```

所以我要问你的问题是你如何使用上述变量调用 sendmail，以及当你说“通过 CGI 运行”与通过命令行运行时你的意思是什么？您是否只是添加 CGI 代码并仍然通过命令行或在 Web 浏览器中访问其 URL 来运行？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-05T06:15:32.750

在您的一些评论中，您提到您正在使用 -l 选项（perl -l foo.cgi）从命令行运行脚本。

-l 选项启用自动行尾处理，并且由于您的问题是行尾，我建议您尝试不使用 -l。

# php - 在 PHP 中使用 Fusion Chart 并在 Smarty 模板引擎中进行渲染

> ID：813009
> 
> 赞同：1
> 
> 时间：2009-05-01T20:02:31.190
> 
> 标签：php, web-applications, charts, smarty

我的问题无法在 .tpl 文件中呈现图表。以下代码是取自Fusion chart document check的示例，供[参考](http://www.fusioncharts.com/free/docs/Contents/PHP_BasicExample.html)

```
<?php
   include("../Includes/FusionCharts.php");

   //Create an XML data document in a string variable
   $strXML  = "";
   $strXML .= "<graph caption='Monthly Unit Sales' xAxisName='Month' yAxisName='Units'
   decimalPrecision='0' formatNumberScale='0'>";
   $strXML .= "<set name='Jan' value='462' color='AFD8F8' />";
   $strXML .= "<set name='Feb' value='857' color='F6BD0F' />";
   $strXML .= "<set name='Mar' value='671' color='8BBA00' />";
   $strXML .= "<set name='Apr' value='494' color='FF8E46' />";
   $strXML .= "<set name='May' value='761' color='008E8E' />";
   $strXML .= "<set name='Jun' value='960' color='D64646' />";
   $strXML .= "<set name='Jul' value='629' color='8E468E' />";
   $strXML .= "<set name='Aug' value='622' color='588526' />";
   $strXML .= "<set name='Sep' value='376' color='B3AA00' />";
   $strXML .= "<set name='Oct' value='494' color='008ED6' />";
   $strXML .= "<set name='Nov' value='761' color='9D080D' />";
   $strXML .= "<set name='Dec' value='960' color='A186BE' />";
   $strXML .= "</graph>";

   //Create the chart - Column 3D Chart with data from strXML variable using dataXML method
   echo renderChartHTML("../../FusionCharts/FCF_Column3D.swf", "", $strXML, "myNext", 600, 300);
?> 
```

如果我在正常的 .php 中渲染，它可以工作，但是如何将 renderChartHTML 值传递给 Smarty tpl，以便它以这样的方式显示。`<div>{$chartdata}</div>`如果有任何示例在 smarty tpl 中显示 Fusion 图表，那就太好了。

到目前为止，我能够获得图形，例如将 $strXML 分配给 smarty 变量并将值直接传递给嵌入参数。有人建议这样做的更好方法吗？

在 PHP 中：

```
$smarty->assign('strXML', $strXML); 
```

在 .tpl 中：

```
<embed src="FCF_MSLine.swf" flashVars="&dataXML={$strXML}&chartWidth=900&chartHeight=600" quality="high" width="900" height="600" name="testgraph" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" /> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-02T15:12:12.720

```
$output = renderChartHTML("../../FusionCharts/FCF_Column3D.swf", "", $strXML, "myNext", 600, 300);
$smarty->assign('chartdata', $output); 
```

# java - 编程语言：在 Java 中定义回调的最优雅的方式是什么？

> ID：813013
> 
> 赞同：4
> 
> 时间：2009-05-01T20:03:51.483
> 
> 标签：java, callback

在“代码完成”一书中，作者谈到了**用**一种语言编程（而不是用一种语言编程）。他的意思是，你不应该受到所选编程语言的限制。

回调是一个经常使用的功能。我很感兴趣：将回调编程到 java 语言中的最优雅的方法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-01T20:14:03.533

Java 对各种情况使用各种回调。自从最古老的 AWT 监听器时代以来，Java 一直都是关于回调的。

Java 回调有两种基本的“风格”。首先是实现一个接口方法：

```
public class MyThing implements StateChangeListener {

   //this method is declared in StateChangeListener
   public void stateChanged() {
      System.out.println("Callback called!");
   }

   public MyThing() {
      //Here we declare ourselves as a listener, which will eventually
      //lead to the stateChanged method being called.
      SomeLibraryICareAbout.addListener(this);
   }
} 
```

Java 回调的第二种风格是匿名内部类：

```
public class MyThing {

   public MyThing() {
      //Here we declare ourselves as a listener, which will eventually
      //lead to the stateChanged method being called.
      SomeLibraryICareAbout.addListener( new StateChangeListener() {
          //this method is declared in StateChangeListener
          public void stateChanged() {
              System.out.println("Callback called!");
          }
      });
   }
} 
```

还有其他方法，包括使用反射、使用单独的事件处理类和适配器模式。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-01T20:10:01.297

我见过的解决 Java 中缺少函数指针/委托的最常见方法是使用函子。

基本上，使用单个方法定义接口并将其实例用作回调：

```
public interface Callback<T,V>{
  public T invoke(V context);
} 
```

它比 C/C++ 或 C# 等价物要冗长得多，但它确实有效。标准库中这种模式的一个例子是 Comparator 接口。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-01T20:09:03.187

不幸的是，在 Java 中，函数不是一流的对象。你能做的最好的就是使用一个接口：

```
public interface MyCallback
{
    public void theCallback(int arg);
}

public class Sample
{
    public static void takesACallback(MyCallback callback)
    {
        ...
        callback.theCallback(arg);
    }
}

public class Sample2
{
    public static void main(String[] args)
    {
        Sample.takesACallback(new MyCallback()
        {
            void theCallback(int arg)
            {
                // do a little dance
            }
        });
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-01T20:17:16.630

看看这篇文章：

[http://www.onjava.com/pub/a/onjava/2003/05/21/delegates.html](http://www.onjava.com/pub/a/onjava/2003/05/21/delegates.html)

回调本质上是一个特例 od Delegates（因为 C# 有它们），文章给出了一个类似 C# 委托的实现，在 java 中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-01T20:14:07.853

一个非常常见的回调构造是 Swing 中的事件处理程序，其中 ActionListener 可能是最容易掌握的。

看看[http://java.sun.com/docs/books/tutorial/uiswing/events/actionlistener.html](http://java.sun.com/docs/books/tutorial/uiswing/events/actionlistener.html)

您经常提供实现适当接口的匿名类的实例，类似于

```
listener = new ActionListener() {
  public void actionPerformed(ActionEvent e) {
     // do stuff...
  }
}; 
```

然后将侦听器传递给适当的 Swing 方法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-02T06:27:24.917

我个人觉得 Java 迫切需要某种形式的闭包支持。在此期间，我在 Java 中实现了一个基于反射的通用方法回调。它[张贴在我的网站上](http://www.softwaremonkey.org/Code/Callback)。

这种方法的好处是它的通用性。目的是能够编写类似于文件系统树遍历的 API，而不必每次都定义接口，而是使用 API 在代码中指定一个方法来执行工作。

例如，遍历文件系统树来处理每个文件：

**进程目录树 API**

```
/**
 * Process a directory using callbacks.  To interrupt, the callback must throw an (unchecked) exception.
 * Subdirectories are processed only if the selector is null or selects the directories, and are done
 * after the files in any given directory.  When the callback is invoked for a directory, the file
 * argument is null;
 * <p>
 * The callback signature is:
 * <pre>    void callback(File dir, File ent);</pre>
 * <p>
 * @return          The number of files processed.
 */
static public int processDirectory(File dir, Callback cbk, FileSelector sel) {
    return _processDirectory(dir,new Callback.WithParms(cbk,2),sel);
    }

static private int _processDirectory(File dir, Callback.WithParms cbk, FileSelector sel) {
    int                                 cnt=0;

    if(!dir.isDirectory()) {
        if(sel==null || sel.accept(dir)) { cbk.invoke(dir.getParent(),dir); cnt++; }
        }
    else {
        cbk.invoke(dir,(Object[])null);

        File[] lst=(sel==null ? dir.listFiles() : dir.listFiles(sel));
        if(lst!=null) {
            for(int xa=0; xa<lst.length; xa++) {
                File ent=lst[xa];
                if(!ent.isDirectory()) {
                    cbk.invoke(dir,ent);
                    lst[xa]=null;
                    cnt++;
                    }
                }
            for(int xa=0; xa<lst.length; xa++) {
                File ent=lst[xa];
                if(ent!=null) { cnt+=_processDirectory(ent,cbk,sel); }
                }
            }
        }
    return cnt;
    } 
```

**使用进程目录 API**

通过上面的方法编写，我现在可以非常轻松地处理任何操作的目录树；扫描、计数、列出等。只需稍作更改即可在文件/树删除等降序操作之前和之后调用目录上的回调（需要一个附加参数来指示调用的前/后性质）。

```
static private final Method             COUNT =Callback.getMethod(Xxx.class,"callback_count",true,File.class,File.class);

...

IoUtil.processDirectory(root,new Callback(this,COUNT),selector);

...

private void callback_count(File dir, File fil) {
    if(fil!=null) {                                                             // file is null for processing a directory
        fileTotal++;
        if(fil.length()>fileSizeLimit) {
            throw new Abort("Failed","File size exceeds maximum of "+TextUtil.formatNumber(fileSizeLimit)+" bytes: "+fil);
            }
        }
    progress("Counting",dir,fileTotal);
    } 
```

# content-management-system - ClearCase：交付时的电子邮件通知

> ID：813016
> 
> 赞同：2
> 
> 时间：2009-05-01T20:04:36.863
> 
> 标签：content-management-system, clearcase

在我的新公司，CMS 是 ClearCase。我以前使用过 Perforce，它有一个很好的内置通知机制，可以让团队及时了解项目中更改的文件。我正在尝试在 ClearCase 中使用等价的东西。我想知道以前是否有人实现过这一点。

基本上，有三个要求：

*   有办法订阅项目。一个人只收到关于它订阅的项目的通知。
*   当有人交付活动时，受影响项目的所有订阅者都会收到有关该活动的电子邮件通知。
*   该电子邮件包含受此活动影响的文件列表。每个修改后的文件都有一个链接，该链接执行一个差异，显示此活动在此文件中的更改。

那么是否有人知道模块/扩展或任何其他现有方式来放置它，还是我必须使用触发器和 perl 脚本手动完成所有这些？

谢谢，

马丁

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-29T15:59:55.900

我们在这里也想要同样的东西，所以我们使用了一个名为 ucm_complete_delivery.pl 的触发器，它可以在[CM Crossroads](http://www.cmcrossroads.com/cgi-bin/cmwiki/view/CM/ClearCaseUnifiedChangeManagementTriggers)上找到。

您需要将此触发器应用于您的 PVOB（因为它是 UCM 触发器）。

应用它后，您需要在 UCM 组件上定义以下自定义属性：

```
auto_baseline_email user_1@mydomain.com,user_2@mydomain.com,etc... 
```

手动维护邮件列表有点痛苦（或者您需要使用群组邮件地址），但总比没有好。:)

干杯，

托马斯

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T20:36:57.940

我不确定它是否已经存在，我确信它没有随 UCM 产品本身提供。
可能是像 CMCrossroad 这样更专业的论坛有更多信息，但[你已经在那里提出了问题](http://www.cmcrossroads.com/component/option,com%5Ffireboard/Itemid,593/func,view/id,95709/catid,31/)；）

无论如何，实现此类通知的最简单方法是在流上创建一个遵循新基线的流程。
每个基线都由活动组成，列出这些活动很简单。
每个基线都可以轻松地与其之前的基线进行比较，列出文件版本并构建适当的差异会很简单。

至于关注项目的用户，我建议将项目流之一的视图列表作为“订阅机制”：任何对该项目（其中一个流）有视图的用户都可能感兴趣。

一般的实现原理是通过**操作后触发器**，如“[十个最佳触发器](http://www.ibm.com/developerworks/rational/library/4311.html#t6)”一文中所述。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T21:18:24.690

AFAIK，几乎所有 CC 操作都可以有触发器（在 Perl、IIRC 中）您需要将电子邮件触发器添加到传递操作。很久很久以前，我看到了一个简单的例子。但是您必须注意保留订阅列表并通过电子邮件发送给适当的人。

# c# - 在 COM Called Wrapper 中使用 .NET Generic List ToArray 会导致访问冲突，我是否遗漏了什么？

> ID：813018
> 
> 赞同：3
> 
> 时间：2009-05-01T20:05:28.547
> 
> 标签：c#, .net, com, vb6, interop

尝试将数组传递回 COM 调用方时遇到问题。

基本上，我有一个类的泛型列表，我想返回给 COM 调用者，你不能在 COM 中使用泛型，所以它必须是强类型的。我想只要在 List 上返回一个 .ToArray() 就可以满足我的需要。

当我在 VB6 中使用它时，它运行良好。在调试器中。当我编译应用程序并将其作为直接可执行文件运行时，它会因内存访问冲突而崩溃。我很困惑。我无法捕获 VB 或 .NET 组件中的任何错误，所以我猜测 COM 翻译中出现了一些错误。

它在 getList() 中的“return a”失败

应用程序事件日志包含此错误：

错误应用程序 project1.exe，版本 1.0.0.0，标记 49fb60d8，错误模块 msvbvm60.dll，版本 6.0.98.2，标记 4802a186，调试？0，故障地址0x00106154。

这是VB6代码供参考，很简单。

```
Private Sub Form_Load()
  Dim c1 As IClass1
  Dim c2

  Set c1 = New Class1

  For Each c2 In c1.getList
    Debug.Print c2.Value
  Next

End Sub 
```

和 .NET 代码：

```
using System;
using System.Collections.Generic;
using System.Text;
using System.Runtime.InteropServices;

namespace TestCOM
{

    public interface IClass1
    {
        List<IClass2> MyList { get; }

        IClass2[] getList();
    }

    public class Class1 : IClass1
    {
        public List<IClass2> MyList { get; private set; }

        public Class1()
        {
            this.MyList = new List<IClass2>();
            this.MyList.Add(new Class2());
            this.MyList.Add(new Class2());
        }

        public IClass2[] getList()
        {
            try
            {
                System.IO.File.WriteAllText(@"C:\COMLog1.txt", "Hi.");
                IClass2[] a = new IClass2[this.MyList.Count];
                System.IO.File.WriteAllText(@"C:\COMLog1.txt", "Bye.");
                for (int i = 0; i < this.MyList.Count; i++)
                {
                    a[i] = this.MyList[i];
                }
                System.IO.File.WriteAllText(@"C:\COMLog1.txt", "Sup.");

//The logging appears on disk all the way to here, so the failure appears to be in the interop layer.

                return a;
            }
            catch (Exception e)
            {
                System.IO.File.WriteAllText(@"C:\COMLog.txt", string.Format("Error:\n{0}", e.Message));
            }
            return null;
        }
    }

    public interface IClass2
    {
        int Value { get; }
    }
    public class Class2: IClass2
    {
        public int Value { get; private set; }

        public Class2()
        {
            Random r = new Random();
            this.Value = r.Next();
        }
    }
} 
```

**问题源于 VB 端的后期绑定。使用早期绑定数组解决了这个问题，这是测试应用程序的最终 VB 代码：**

```
Private Sub Form_Load()
  Dim c1 As IClass1
  Dim c2() As IClass2
  Dim x

  Set c1 = New Class1

  c2 = c1.getList

  For Each x In c2
    Debug.Print x.Value
  Next

End Sub 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-02T03:01:25.487

看来问题可能与晚期和早期绑定有关。如果您将 c2 声明为一种类型，它应该可以解决此错误。这是另一个解决类似问题的站点。

[http://weblogs.asp.net/psteele/archive/2007/02/06/com-interop-does-not-like-uninitialized-arrays.aspx](http://weblogs.asp.net/psteele/archive/2007/02/06/com-interop-does-not-like-uninitialized-arrays.aspx)

至于无法捕获错误，看起来通用列表的 .ToArray 函数能够破坏数据。这是反射器的一些代码：

```
//You can see that the function calls Array.Copy
Public Function ToArray() As T()
    Dim destinationArray As T() = New T(Me._size  - 1) {}
    Array.Copy(Me._items, 0, destinationArray, 0, Me._size)
    Return destinationArray
End Function

//You can see from the ReliabilityContract that this method is set to
//Consistency.MayCorruptInstance and Cer.MayFail
<ReliabilityContract(Consistency.MayCorruptInstance, Cer.MayFail)> _
Public Shared Sub Copy(ByVal sourceArray As Array, _
    ByVal sourceIndex As Integer, ByVal destinationArray As Array, _
    ByVal destinationIndex As Integer, ByVal length As Integer)
        Array.Copy(sourceArray, sourceIndex, destinationArray, _
        destinationIndex, length, False)
End Sub 
```

此外，这里有一些文档可能有助于解释为什么您无法正确捕获错误。基本上，整个 AppDomain 可能会损坏，或者可能存在 ThreadAbort 或 StackOverflow 或其他导致所有处理中止的严重错误。第二个链接讨论如何解决这些类型的问题。

*   [http://msdn.microsoft.com/en-us/library/bax7szd1.aspx](http://msdn.microsoft.com/en-us/library/bax7szd1.aspx)
*   [http://msdn.microsoft.com/en-us/magazine/cc163716.aspx](http://msdn.microsoft.com/en-us/magazine/cc163716.aspx)

# backup - Windows 2008 服务器备份

> ID：813019
> 
> 赞同：0
> 
> 时间：2009-05-01T20:05:55.533
> 
> 标签：backup, windows-server-2008

如果我只想在 Windows 2008 Server 上备份我的数据目录，我有哪些选择。在我看来，操作系统内置的备份软件只能备份整个硬盘。

我是复制文件的唯一选择吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-01T20:46:26.433

Ntbackup 是以前版本的 Windows Server 和基于 NT 的 Windows 客户端操作系统中包含的备份程序，不再提供或支持，但您仍有一些选择。

1.  使用 Windows Server Backup 备份完整的硬盘分区。您需要将系统配置为将数据存储在与引导分区不同的分区上，以免备份操作系统。（注意：您必须备份到不同磁盘上的分区或网络共享。）
2.  使用 Robocopy。这是一个替代 xcopy 的命令行工具。它有许多选项，可让您通过文件复制进行备份，并根据您想要实现的备份作业类型设置存档位。
3.  购买第三方备份工具。Microsoft Data Protection Manager 和 Symantec BackupExec 是两个具有企业功能（且按企业定价）的选项。

# iphone - UITableView - how to make search bar scroll with table

> ID：813020
> 
> 赞同：1
> 
> 时间：2009-05-01T20:05:56.843
> 
> 标签：iphone, cocoa-touch

How can I make the search bar to scroll together with the table view? When I scroll my table view I want my search bar to go with it and disappear. I want to have done something similar to contacts app on the iPhone.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-01T20:11:02.527

您可以将搜索栏放在[tableView 的标题行](http://developer.apple.com/iphone/library/documentation/uikit/reference/UITableView_Class/Reference/Reference.html#//apple_ref/doc/uid/TP40006943-CH3-SW32)中。这将使它成为 tableView 的一部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T20:11:38.500

在表格视图中的所有其他部分上方或之前设置一个空的表格部分。将此部分的标题设置为您的搜索栏视图。

# c# - 使用 System.IO.Delete 从目录中删除某些文件？

> ID：813030
> 
> 赞同：3
> 
> 时间：2009-05-01T20:07:17.823
> 
> 标签：c#, asp.net, vb.net, image, directory

我在一个名为 Pics 的文件夹中有 2 张图像.....Image1.jpg 和 Image2.jpg。

我必须在我的提交按钮中放置什么代码才能删除位于此处“~/Pics/Image1.jpg”的 Image1.jpg

任何帮助都会很棒！！！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-01T20:11:35.567

您需要使用[System.IO.File.Delete](http://msdn.microsoft.com/en-us/library/system.io.file.delete.aspx)而不是 System.IO.Delete

```
string path = "~/Pics/Image1.jpg";
System.IO.File.Delete(Server.MapPath(path)) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-01T20:13:33.533

语法是：

```
System.IO.File.Delete(Server.MapPath("~/Pics/Image1.jpg")); 
```

但是，您需要确保运行您的 Web 应用程序的用户对您正在删除的文件具有删除（更改）权限。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-06-13T12:05:32.767

试试这个：

```
String FileName = "Image1.jpg";
System.IO.File.Delete(Server.MapPath(("~/Pics/") + FileName)); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-01T20:12:05.643

我会尝试：

```
String FilePath;
FilePath = Server.MapPath("~/Pics/Image1.jpg");
File.Delete(FilePath); 
```

# visualization - 符号化对象及其实例变量的值的最佳图表类型是什么？

> ID：813037
> 
> 赞同：1
> 
> 时间：2009-05-01T20:09:21.547
> 
> 标签：visualization, diagram, uml

我想用几个不同的对象、它们的关系和它们的实例变量的值来可视化一个情况。知道哪种图表类型最适合吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-01T20:12:23.850

对象图。

它就像一个类图，除了属性框有值。

此外，对象之间的线是“链接”而不是“关联”。它们是实际的链接（FK、对象引用等）而不是链接的类。

# jquery - 点击时jquery突出显示链接

> ID：813046
> 
> 赞同：2
> 
> 时间：2009-05-01T20:10:45.163
> 
> 标签：jquery, highlight

单击链接时如何使用jquery突出显示链接？

例如，当我点击链接 class1_1 时，我想让这个链接变成红色（或其他颜色）。

这里的javascript代码：

```
<script type="text/javascript">
 $(function(){
  $("#menu li").each(function(){
     $(this).click(function(event){
       var ul=$(this).children("ul")
       var span = $(this).children("span")
       if(ul.html()!=null)
       {
          if(ul.css("display")=="none")
          {
            ul.css("display","block");
            span.addClass("up")
          }else
          {
            ul.css("display","none")
            span.removeClass("up")
          }
           event.stopPropagation();
       }else
       {
         event.stopPropagation();
       }
     });
  });
  return false;
 });
</script> 
```

这里的html代码：

```
<ul id="menu">

<li class="title"><span>class1 </span>
<ul>
  <li><a href="">class1_1</a></li>
   <li><a href="">class1_2</a></li>
 </ul>
 </li>
<li class="title"><span>class2</span>
   <ul>
  <li><span>class2_1</span>
   <ul>
    <li><a href="">class2_1_1</a></li>
    <li><a href="">class2_1_1</a></li>
  </ul>
  </li>
 </ul>
</li>
</ul> 
```

也许我无法清楚地解释我的问题，我的意思是最后一个点击链接是否成功

颜色为红色，另一个链接设置为默认颜色

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-01T20:28:24.917

可以使用 CSS，不需要 jQuery：

强调：

```
a:active {
    background-color: #FF0000;
} 
```

更改链接颜色：

```
a:active {
    color: #FF0000;
} 
```

编辑：回复您的评论...如果您的链接没有将浏览器定向到另一个页面，您可以使用[Mike Robinson 的答案](https://stackoverflow.com/questions/813046/jquery-highlight-the-link-when-clicked/813083#813083)来完成相同的效果，而无需离开页面，也无需将颜色更改回默认的 onblur。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-01T20:17:50.717

认为应该这样做，尽管我现在手头没有 jquery。假设 'up' 是一个让你的链接变红的类：

```
$("ul#menu a").click(function(){
 $(this).addClass('up');
}); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-01T20:50:38.610

**这应该有效：**

Javascript：

```
$(function(){
    $('.class1').click(function() {
        $(this).toggleClass('active1');
    });
}); 
```

CSS：

```
a.class1 { color: red; }
a.active1 { color: blue; } 
```

HTML：

```
<a href="#" class="class1">some text</a> 
```

最好使用 toggleClass（2 合 1）而不是 addClass/removeClass。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-01T20:19:32.473

我会推荐[http://plugins.jquery.com/project/color](http://plugins.jquery.com/project/color) jquery.color 插件。它将允许您为各种 html 元素设置颜色动画。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-09T10:52:54.103

```
<script type = "text/javascript" >
$(function() {
    $("#menu li").each(function() {
        $(this).click(function(event) {

            $("#menu li").removeClass("high");
            $(this).addClass("high");

            var ul = $(this).children("ul")
            var span = $(this).children("span")
            if (ul.html() != null) {
                if (ul.css("display") == "none") {
                    ul.css("display", "block");
                    span.addClass("up")
                } else {
                    ul.css("display", "none") span.removeClass("up")
                }
                event.stopPropagation();
            } else {
                event.stopPropagation();
            }
        });
    });
    return false;
});
</script>

<style>
.high{color:red}
</style> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-06-30T16:04:25.637

Javascript：

```
$('.link').click(function() {
    if (!$(this).hasClass('hi')) {
        // If this link is not already highlighted, highlight it and make
        // sure other links of class .link are not highlighted.
        $('.hi').removeClass('hi');
        $(this).addClass('hi');
    }
}); 
```

CSS：

```
a.hi { color: red; } 
```

html:

```
<a href="#" class="link">my text</a>
<a href="#" class="link">that text</a>
<a href="#" class="link">this text</a> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-01T20:33:18.667

您可以使用 CSS 伪类**active**来实现。它为激活的元素添加了特殊样式。

例如，您可以这样做：

```
a: active { color: red; } 
```

注意，a:active 必须在 CSS 定义中的 a:hover 之后才能生效！！

# java - 组合和聚合有什么区别？

> ID：813048
> 
> 赞同：4
> 
> 时间：2009-05-01T20:11:14.273
> 
> 标签：java, ooad

组合和聚合有什么区别？谁能给我这个OOAD的样本？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-05-01T20:21:06.543

考虑一个学生、学生的大脑和学生就读的学校。

大脑*是*学生的一部分。如果学生被摧毁，大脑也会被摧毁。这是**作文**。

学生*有一*所学校。学生在学校的毁灭中幸存下来，反之亦然。这是**聚合**。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-01T20:13:54.017

[在这里找到](http://www.jguru.com/faq/view.jsp?EID=51520)

“聚合和组合都是特殊的关联。聚合用于表示所有权或整体/部分关系，组合用于表示更强大的所有权形式。通过组合，我们得到部分与整体的一致寿命。复合对象对其部分在创建和销毁方面的处置负有全部责任。

此外，聚合端的重数不得超过一；即，它是非共享的。一个对象一次只能是一个组合的一部分。如果复合体被破坏，它必须要么破坏它的所有部分，要么将它们的责任交给其他对象。一个复合对象可以在设计时知道没有其他对象会破坏它的部分。

组合可用于对按值聚合进行建模，这在语义上等价于属性。事实上，组合最初在早期的 UML 草案中被称为按值聚合，而“正常”聚合被认为是按引用聚合。定义略有变化，但总体思路仍然适用。聚合和组合之间的区别更多的是一种设计概念，在分析过程中通常不相关。”约翰摩尔

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T20:13:15.687

您的问题的相关答案在这里： http: [//ootips.org/uml-hasa.html](http://ootips.org/uml-hasa.html)

简而言之：组合和聚合都是由*部分*和*整体*组成的非循环 has-a 关系。不同之处在于，在组合中，*整体*负责创建（和删除）它的*部分*。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-01T20:13:35.733

[http://en.wikipedia.org/wiki/Object-oriented_programming](http://en.wikipedia.org/wiki/Object-oriented_programming)
[http://en.wikipedia.org/wiki/Object_composition](http://en.wikipedia.org/wiki/Object_composition)
[http://en.wikipedia.org/wiki/Object_composition#Aggregation](http://en.wikipedia.org/wiki/Object_composition#Aggregation)

# css - 在我的 DotNetNuke 皮肤上需要我的 CSS 帮助

> ID：813051
> 
> 赞同：1
> 
> 时间：2009-05-01T20:11:36.410
> 
> 标签：css, internet-explorer, firefox, dotnetnuke, skin

我为 DotNetNuke 5.x 创建了一个皮肤，并尝试尽可能多地使用 css 进行布局。我的问题是 IE 和 FF/Chrome/Safari 之间的一致性。在大多数网站上我都能克服这个问题，但在这个皮肤中，我尝试了我能想到的一切，并花了很多时间试图让两者的外观保持一致。当我修好一个时，另一个会坏掉。谁能帮我解决这个问题？请看一下 IE 和 FF 中的皮肤，看看有什么区别：

[http://bluebookbasement.coultertechnologies.com](http://bluebookbasement.coultertechnologies.com)

BlueBookBasement_full.ascx

```
 <%@ Control language="vb" CodeBehind="~/admin/Skins/skin.vb" AutoEventWireup="false" Explicit="True" Inherits="DotNetNuke.UI.Skins.Skin" %>
<%@ Register TagPrefix="dnn" TagName="LANGUAGE" Src="~/Admin/Skins/Language.ascx" %>
<%@ Register TagPrefix="dnn" TagName="LOGO" Src="~/Admin/Skins/Logo.ascx" %>
<%@ Register TagPrefix="dnn" TagName="SEARCH" Src="~/Admin/Skins/Search.ascx" %>
<%@ Register TagPrefix="dnn" TagName="NAV" Src="~/Admin/Skins/Nav.ascx" %>
<%@ Register TagPrefix="dnn" TagName="TEXT" Src="~/Admin/Skins/Text.ascx" %>
<%@ Register TagPrefix="dnn" TagName="BREADCRUMB" Src="~/Admin/Skins/BreadCrumb.ascx" %>
<%@ Register TagPrefix="dnn" TagName="USER" Src="~/Admin/Skins/User.ascx" %>
<%@ Register TagPrefix="dnn" TagName="LOGIN" Src="~/Admin/Skins/Login.ascx" %>
<%@ Register TagPrefix="dnn" TagName="LINKS" Src="~/Admin/Skins/Links.ascx" %>
<%@ Register TagPrefix="dnn" TagName="PRIVACY" Src="~/Admin/Skins/Privacy.ascx" %>
<%@ Register TagPrefix="dnn" TagName="TERMS" Src="~/Admin/Skins/Terms.ascx" %>
<%@ Register TagPrefix="dnn" TagName="COPYRIGHT" Src="~/Admin/Skins/Copyright.ascx" %>
<%@ Register TagPrefix="dnn" TagName="STYLES" Src="~/Admin/Skins/Styles.ascx" %>

<div id="ControlPanel" runat="server" />
<div id="mainbody">
    <div id="container">
        <div id="top_banner">
            <div style="float:left; "><dnn:LOGO runat="server" id="dnnLOGO"  /></div>
            <div id="top_banner_right">  </div>
        </div>
        <div id="content">
            <div id="content_top_left">
                <div id="content_top_right">
                    <div id="top_nav">
                        <div id="nav_left">
                            <div id="nav_right">
                                <div id="nav_main">
                                    <dnn:NAV 
                                        runat="server" 
                                        id="dnnNAV"  
                                        ProviderName="DNNMenuNavigationProvider" 
                                        IndicateChildren="false" 
                                        ControlOrientation="Horizontal" 
                                        CSSNodeRoot="main_dnnmenu_rootitem" 
                                        CSSNodeHoverRoot="main_dnnmenu_rootitem_hover" 
                                        CSSNodeSelectedRoot="main_dnnmenu_rootitem_selected" 
                                        CSSBreadCrumbRoot="main_dnnmenu_rootitem_selected" 
                                        CSSContainerSub="main_dnnmenu_submenu" 
                                        CSSNodeHoverSub="main_dnnmenu_itemhover" 
                                        CSSNodeSelectedSub="main_dnnmenu_itemselected" 
                                        CSSContainerRoot="main_dnnmenu_container" 
                                        CSSControl="main_dnnmenu_bar" 
                                        CSSBreak="main_dnnmenu_break" />
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="middle_left">
                <div id="middle_right">
                    <div id="indent_left">
                        <div id="indent_right">

                                <div id="breadcrumbs">
                                    <dnn:TEXT runat="server" id="dnnTEXT"  CssClass="breadcrumb_text" Text="You are here >" ResourceKey="Breadcrumb" />&nbsp;
                                    <dnn:BREADCRUMB runat="server" id="dnnBREADCRUMB"  CssClass="Breadcrumb" RootLevel="0" Separator="&nbsp;>&nbsp;" />
                                </div>
                                <div id="BannerPane" class="BannerPane" runat="server"></div>
                                <div id="TopPane" class="TopPane" runat="server"></div>
                                <table border="0" cellpadding="0" cellspacing="0" width="100%" >
                                    <tr>
                                        <td class="leftpane" id="LeftPane" runat="server" valign="top"></td>
                                        <td class="contentpane" id="ContentPane" runat="server" valign="top"></td>
                                        <td class="rightpane" id="RightPane" runat="server" valign="top"></td>
                                    </tr>
                                    <tr>
                                        <td colspan="3">
                                            <table border="0" cellpadding="0" cellspacing="0" width="100%" >
                                                <tr>
                                                    <td class="mid3" id="Mid1Pane" runat="server" valign="top"></td>
                                                    <td class="mid3" id="Mid2Pane" runat="server" valign="top"></td>
                                                    <td class="mid3" id="Mid3Pane" runat="server" valign="top"></td>
                                                </tr>
                                            </table>
                                        </td>

                                    </tr>
                                    <tr>
                                        <td class="leftcontentpane" id="LeftContentPane" runat="server" valign="top" colspan="2"></td>
                                        <td class="rightpane" id="RightSidePane" runat="server" valign="top"></td>

                                    </tr>
                                    <tr>
                                        <td class="leftpane" id="LeftSidePane" runat="server" valign="top"></td>
                                        <td class="rightcontentpane" id="RightContentPane" runat="server" valign="top" colspan="2"></td>

                                    </tr>
                                </table>
                                <div id="BottomPane" class="BottomPane" runat="server"></div>
                                <div class="clear"></div>

                        </div>
                    </div>
                </div>
            </div>            
            <div id="content_bottom">
                <div id="content_bottom_left">
                    <div id="content_bottom_right">
                        <div id="content_bottom_middle">
                            <div id="prefooter">
                                <div class="leftSide">
                                    <dnn:links runat="server" id="dnnLINKS" CssClass="links" Level="Root" Separator="&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;" />
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div id="footer">
            <div id="footer_left">
                <div id="footer_right">
                    <dnn:COPYRIGHT runat="server" id="dnnCOPYRIGHT" CssClass="footertxt" />&nbsp;|&nbsp;    
                    <dnn:TERMS runat="server" id="dnnTERMS" CssClass="footertxt" />&nbsp;|&nbsp;
                    <dnn:PRIVACY runat="server" id="dnnPRIVACY" CssClass="footertxt" />&nbsp;|&nbsp;
                    <dnn:USER runat="server" id="dnnUSER" CssClass="footertxt" />&nbsp;|&nbsp;
                    <dnn:LOGIN runat="server" id="dnnLOGIN" CssClass="footertxt" />
                </div>
            </div>
        </div>
    </div>
</div> 
```

皮肤.css

```
BODY 
{
    background-color:#214081;
    height:100%; 
    margin:0px; 
    padding:0px; 
}
#mainbody
{
    background-image:url(images/home_2_01.jpg);
    background-repeat:repeat-x;
    background-position:top;

    margin-top: 0px;
    margin-right: 0px;
    margin-bottom: 0px;
    margin-left: 0px;
    text-align: center;
}
#container
{
    width:979px;
    padding: 0;
    text-align:center;
    margin: 0 auto;
}
a
{
    font-family:Verdana, Arial, Helvetica, sans-serif;
    font-size:12px;
    font-weight:normal;
    font-style:normal;
    text-decoration:none;
    color:#000000;
}
.clear
{
    clear:both;
}
#top_banner
{
    /*background-image:url(images/top_banner.gif);
    background-repeat:no-repeat;
    background-position:top;
    width:979px;*/
    height:145px;
}
#top_banner_right
{
    float:right;
    color:#FFFFFF;
    font-size:20px;
    line-height:25px;
    padding-top:70px;
}
#content
{
    background:#fff url(images/home_2_05.jpg) repeat-x top;
    /*background-color:#fff;*/
    min-height:414px;
    padding:0px;
    margin:0px;
}
#content_top_left
{
    background-image:url(images/home_2_04.jpg);
    background-repeat:no-repeat;
    background-position: left top;
    height: 65px;
    padding:0px; margin:0px;

}
#content_top_right
{
    background-image:url(images/home_2_06.jpg);
    background-repeat:no-repeat;
    background-position: right top;
    height: 65px;
    padding:10px 10px 0px 10px; margin:0px;
    /*width:100%;*/

}
#content_bottom
{
    background:url(images/home_2_27.jpg) repeat-x bottom;
    height: 63px;
    padding:0px; 
    margin:0px;
}
#content_bottom_left
{
    background:url(images/home_2_26.jpg) no-repeat bottom left ;
    height: 63px;
    padding:0px; 
    margin:0px;

}
#content_bottom_right
{
    background:url(images/home_2_30.jpg) no-repeat bottom right;
    height: 63px;
    padding:0px; 
    margin:0px;

}
#content_bottom_middle
{
    background:url(images/home_2_28.jpg) no-repeat bottom center;
    height: 63px;
    padding: 0px 0px 0px 0px; 
    margin:0px;

}
#content_all
{
    /*padding: 16px;*/
}
#middle_left
{
    background-image:url(images/home_2_21.jpg);
    background-repeat:repeat-y;
    background-position: left;
    padding: 0px;
    margin:0px;
}
#middle_right
{
    background-image:url(images/home_2_22.png);
    background-repeat:repeat-y;
    background-position: right;
    padding:0px;
    margin:0px;
}
#indent_left
{
    background:url(images/home_2_13.jpg) no-repeat top left;
    padding: 0px; margin:0px;

}
#indent_right
{

    background:url(images/home_2_15.jpg) no-repeat right top;
    padding: 0px 16px 0px 16px; margin:0px 0px 0px 0px;
    overflow: auto;
    /*width: 979px;*/
}

#top_nav
{
    background-image: url(images/home_2_10.jpg);
    background-repeat: repeat-x;
    background-position: top;
    /*width:943px;*/
    height:63px;

}
#nav_left
{
    /*width: 18px;*/
    height: 63px;
    background-image: url(images/home_2_08.jpg);
    background-repeat: no-repeat;
    background-position: top left;
    padding: 0px;
    margin: 0px;
    /*float: left;*/
}
#nav_right
{
    /*width: 21px;*/
    height: 63px;
    background-image: url(images/home_2_12.jpg);
    background-repeat: no-repeat;
    background-position: top right;
    padding: 0px;
    margin: 0px;
    /*float: right;*/
}
#nav_main
{

    padding-top: 10px;
    height: 63px;

}
#video_sub
{
    background-color:#7C7C7C;
    padding:5px;
    color:#FFFFFF;
    text-align:center;
}

/*.main_tab
{
    background-image:url(images/tab_bg.gif);
    background-repeat:no-repeat;
    background-position:top;
    width:648px;
    height:16px;
    padding:15px;
    color:#FFFFFF;
    font-size:14px;
    font-weight:bold;
    text-transform:uppercase;
}*/

#prefooter
{
    margin: 0px;
    text-align: left;
    padding: 10px;
}
#footer
{

    background-image:url(images/home_2_38.jpg);
    background-repeat:repeat-x;
    background-position:top;

    height:95px;
    margin-top: 20px;
    text-align: left;

}
#footer_left
{
    background-image:url(images/home_2_36.jpg);
    background-repeat:no-repeat;
    background-position:left top;
    height: 95px;
}
#footer_right
{
    background-image:url(images/home_2_40.jpg);
    background-repeat:no-repeat;
    background-position:right top;
    height: 95px;
    padding: 36px;
    color: blue;
    /*width: 1036px;*/
}
.footertxt
{
    /*color: #fff;*/
}
td.footertxt {
    font-family: verdana, arial, helvetica;
    color: #FFF;
    font-size:10px;
    font-weight: normal;

}
a.footertxt:link, a.footertxt:visited {
    font-family: verdana, arial, helvetica;
    color: #FFF;
    font-size:10px;
    font-weight: normal;
    text-decoration: none;
}
a.footertxt:hover, a.footertxt:active {
    font-family: verdana, arial, helvetica;
    color: #FFF;
    font-size:10px;
    text-decoration: underline;
    font-weight: normal;
}

.controlpanel {
    width: 100%;
    background-color: #fff;
}

.rightpane {

    width:27%;
    /*margin-right:16px;*/
    /*padding-top:10px;*/
    padding: 0px 0px 0px 10px;
    margin:0px;
}
.leftpane {

    width:27%;
    /*margin-right:16px;*/
    /*padding-top:10px;*/
    padding: 0px 10px 0px 0px;
    margin:0px;
}
.contentpane, .TopPane, .BottomPane, .BannerPane {

    /*width:668px;*/

}
.TopPane, .BottomPane, .BannerPane
{

}
.mid3
{
    width:33%;
    padding: 0px;
    margin: 0px;
}

#breadcrumbs
{
    text-align: left;
    margin-left: 16px;
}

/* begin of menu*/

/*--------- dnn menu style ----------*/
/* main menu td */
.main_dnnmenu_bar 
{
    cursor:pointer;
    font-size: 11px; 
    background-color:transparent;
    width:970px;
}

/*  Main Menu Normal  */
.main_dnnmenu_rootitem  
{   
    color: #fff;
    font-size: 13px; 
    font-weight:bold;   
    text-align:center; 
    padding:12px 12px 12px 12px;
    text-transform:uppercase; margin-right:1px;
    white-space:nowrap;
    float:left;
}

/*  Main menu hover  */
.main_dnnmenu_rootitem_hover
{  
    color:#214081;
    font-size: 13px; 
    font-weight:bold;
    text-align:center;
    padding:12px 12px 12px 12px;
    /*background:url(../images/menu_hover.gif) repeat-x top left;*/
    text-transform:uppercase; margin-right:1px;
    white-space:nowrap;
    float:left;
}

/*  Main menu selected  */
.main_dnnmenu_rootitem_selected 
{
    color:#ffffff;
    font-weight:bold;
    text-align:center;
    font-size: 13px;
    padding:12px 12px 12px 12px;
    /*background:url(../images/menu_active.gif) repeat-x top left;*/
    text-transform:uppercase; margin-right:1px;
    white-space:nowrap;
    float:left;
}

/*  SUB Menu Normal */
.main_dnnmenu_submenu 
{
    /*border:1px solid #C0D6E5;*/
    margin-top: 0px;
    margin-left: 3px;
    background-color: #081E43;  
    z-index: 1000; 
    cursor: pointer; 
    cursor: hand; 
    border-top: #FFFFFF 1px solid;
    border-right: #FFFFFF 1px solid;
    border-left: #FFFFFF 1px solid;
    border-bottom: #FFFFFF 1px solid;
    filter: Alpha(Opacity=75, FinishOpacity=100, Style=1);
    opacity: 0.75;
}

.main_dnnmenu_submenu td
{
    /*background-color:#F8FAFF;*/
    z-index: 1000;
    font-size: 11px; 
    font-weight:bold;
    text-align:left;
    color:#fff;
    line-height:2em;
    padding: 0px 5px;
    margin:0px;
}

/*  SUB Menu hover & selected */
.main_dnnmenu_itemhover td   
{  
    background: #CE0D0D url(../images/submenu_hover.gif) repeat-x top left;
    color:#ffffff;
}
.main_dnnmenu_itemselected td{
    background: #CE0D0D url(../images/submenu_active.gif) repeat-x top left;
    color:#ffffff;
}

.main_dnnmenu_break
{
    height: 2px;
    background-color: #D5E0FF;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T21:46:41.920

好，我知道了。答案是让它在 FF 中看起来正确，然后在主机设置下的 DNN 中将您的皮肤回退设置为 xhtml 1.0 strict 而不是 html 4。这将解决问题。

感谢您的帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T21:10:04.990

如果没有更详细的信息，很难给出有用的建议。您是否尝试过安装[IE Developer Toolbar](http://www.microsoft.com/downloads/details.aspx?familyid=E59C3964-672D-4511-BB3E-2D5E1DB91038&displaylang=en)和[Firebug](http://getfirebug.com/)，以便您可以直接检查每个不一致之处并确定确切的差异是什么？我发现这些工具可以很容易地识别一致性问题，以便您可以发布比“此页面在 IE 和 Firefox 中看起来不一样”更具体的问题。（虽然我感觉到你的痛苦......解决这些问题可能非常困难：S）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-04T14:03:44.020

[@coultertech](https://stackoverflow.com/questions/813051/need-help-with-my-css-on-my-dotnetnuke-skin/813438#813438)，
将皮肤后备文档类型设置为 XHTML 可能是一个不错的选择（由于遗留原因，它仅默认为 HTML）。但是，doctype 信息确实属于皮肤本身（您可能有一个设计为在 HTML 中工作的皮肤，而另一个设计为在 XHTML 中工作）。要指定皮肤的 doctype，请参阅 Cathal 的博客文章[using Skin-level DocType's](http://www.dotnetnuke.com/Community/Blogs/tabid/825/EntryId/2130/The-Fallback-Skin-Doctype-and-skinning.aspx) .

# sql-server - SQL Server 除外

> ID：813057
> 
> 赞同：1
> 
> 时间：2009-05-01T20:12:46.967
> 
> 标签：sql-server, sql-server-2005, except

这就是我所处的情况。我有一张包含人们信息的表格。其中一些是从另一个系统导入的，而一些是手动导入的。我想做的是将所有人都拉进来，但是如果有手动输入的记录和导入的记录，我只想选择导入的记录（因为它可能是最新的）。

这是我到目前为止所拥有的，但它似乎不起作用（它只返回手动输入的记录）：

```
SELECT --fields go here
FROM
        (
                SELECT PERSON_UID, instype
                FROM AdmitsInterfaceTable
                WHERE instype='M' --Manually entered people
            EXCEPT
                SELECT PERSON_UID, instype
                FROM AdmitsInterfaceTable
                WHERE instype='I' --Imported people
        ) P,
        AdmitsInterfaceTable A
     WHERE 
        P.PERSON_UID=A.PERSON_UID
        AND P.instype=A.instype 
```

我觉得这不起作用，因为内部查询也拉入了 instype 列，但我想不出更好的方法来做到这一点。有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T20:17:01.747

```
 SELECT PERSON_UID, instype
    FROM AdmitsInterfaceTable a
    WHERE instype='I' --get all imported people            
 union -- plus all manuals who are not also imported
 SELECT PERSON_UID, instype
    FROM AdmitsInterfaceTable a
    WHERE instype='M' --Imported people
    and not exists (  -- without imported matches
     select * from FROM AdmitsInterfaceTable b
     WHERE instype='I' and b.person_uid = a.person_uid); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T20:26:34.033

你可以试试：

```
SELECT CASE WHEN b.person_UID is null THEN a.person_UID ELSE person_UID END, 
CASE WHEN b.person_UID is null THEN a.instype   ELSE instype   END
--and so forth through all the columns you want
FROM
(SELECT PERSON_UID, instype  -- add list of additional fields you need here
from AdmitsInterfaceTable  WHERE instype='M' ) A
LEFT JOIN
(SELECT PERSON_UID, instype  -- add list of additional fields you need here
from AdmitsInterfaceTable  WHERE instype='I' ) B on A.PERSON_UID = B.PERSON_UID 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T20:27:07.387

```
SELECT --fields go here
FROM AdmitsInterfaceTable A
 WHERE 
    P.PERSON_UID=A.PERSON_UID
    AND P.instype=A.instype
AND instype='M' --Manually entered people
AND person_uid not in (
SELECT PERSON_UID FROM AdmitsInterfaceTable
WHERE instype='I' --Imported people
) 
```

# c# - Windows RegKey - 默认浏览器应用程序路径

> ID：813058
> 
> 赞同：7
> 
> 时间：2009-05-01T20:13:03.457
> 
> 标签：c#, .net, windows, registry

您可以从哪个 RegKey 获取默认浏览器应用程序的路径？

从 C#/.NET 获取它的最佳方式是什么？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-01T20:22:08.693

这是您想要的密钥：

> HKEY_LOCAL_MACHINE\SOFTWARE\Classes\http\shell\open\command

如果需要，这里是 C# 的快速[注册表教程。](http://www.codeproject.com/KB/system/modifyregistry.aspx)

**编辑**：

对于每个用户的设置，请使用此键：

> HKEY_CLASSES_ROOT\http\shell\open\command

（HKCR有机器设置和用户设置，用户优先）。

**请注意，这可能不适用于 Vista**。有关更多信息，[请参见此处](http://newoldthing.wordpress.com/2007/03/23/how-does-your-browsers-know-that-its-not-the-default-browser/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-09T04:20:27.263

对于 Windows 7 默认浏览器路径保存在以下注册表项中

```
 HKEY_CURRENT_USER\Software\Microsoft\Windows\Shell\ Associations\UrlAssociations\http 
```

通过使用 c# 你可以得到它如下 -

```
RegistryKey regkey = Registry.CurrentUser.OpenSubKey("SOFTWARE\\Microsoft\\Windows\\shell\\Associations\\UrlAssociations\\http\\UserChoice", false);

string browser = regkey.GetValue("Progid").ToString(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-02-03T05:37:46.737

我刚刚为此做了一个函数：

```
 public void launchBrowser(string url)
    {
        string browserName = "iexplore.exe";
        using (RegistryKey userChoiceKey = Registry.CurrentUser.OpenSubKey(@"Software\Microsoft\Windows\Shell\Associations\UrlAssociations\http\UserChoice"))
        {
            if (userChoiceKey != null)
            {
                object progIdValue = userChoiceKey.GetValue("Progid");
                if (progIdValue != null)
                {
                    if(progIdValue.ToString().ToLower().Contains("chrome"))
                        browserName = "chrome.exe";
                    else if(progIdValue.ToString().ToLower().Contains("firefox"))
                        browserName = "firefox.exe";
                    else if (progIdValue.ToString().ToLower().Contains("safari"))
                        browserName = "safari.exe";
                    else if (progIdValue.ToString().ToLower().Contains("opera"))
                        browserName = "opera.exe";
                }
            }
        }

        Process.Start(new ProcessStartInfo(browserName, url));
    } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-14T20:34:03.043

根据您的回答，我编写了这个示例代码，应该可以满足您的需求（未经测试）

```
public static string GetDefaultBrowserPath()
    {
        string defaultBrowserPath = null;
        RegistryKey regkey;

        // Check if we are on Vista or Higher
        OperatingSystem OS = Environment.OSVersion;
        if ((OS.Platform == PlatformID.Win32NT) && (OS.Version.Major >= 6))
        {
            regkey = Registry.CurrentUser.OpenSubKey("SOFTWARE\\Microsoft\\Windows\\shell\\Associations\\UrlAssociations\\http\\UserChoice", false);
            if (regkey != null)
            {
                defaultBrowserPath = regkey.GetValue("Progid").ToString();
            }
            else
            {
                regkey = Registry.LocalMachine.OpenSubKey("SOFTWARE\\Classes\\IE.HTTP\\shell\\open\\command", false);
                defaultBrowserPath = regkey.GetValue("").ToString();
            }
        }
        else
        {
            regkey = Registry.ClassesRoot.OpenSubKey("http\\shell\\open\\command", false);
            defaultBrowserPath = regkey.GetValue("").ToString();
        }

        return defaultBrowserPath;
    } 
```

# ios - UITableView - 更改部分标题颜色

> ID：813068
> 
> 赞同：346
> 
> 时间：2009-05-01T20:14:36.090
> 
> 标签：ios, uitableview, cocoa-touch

如何更改 UITableView 中部分标题的颜色？

**编辑**：[DJ-S 提供的答案](https://stackoverflow.com/a/19173639/814730)应考虑用于 iOS 6 及更高版本。接受的答案已过时。

* * *

## 回答 #1

> 赞同：771
> 
> 时间：2013-10-04T05:06:44.703

这是一个老问题，但我认为答案需要更新。

此方法不涉及定义和创建您自己的自定义视图。在 iOS 6 及更高版本中，您可以通过定义

```
-(void)tableView:(UITableView *)tableView 
    willDisplayHeaderView:(UIView *)view 
    forSection:(NSInteger)section 
```

部分委托方法

例如：

```
- (void)tableView:(UITableView *)tableView willDisplayHeaderView:(UIView *)view forSection:(NSInteger)section
{
    // Background color
    view.tintColor = [UIColor blackColor];

    // Text Color
    UITableViewHeaderFooterView *header = (UITableViewHeaderFooterView *)view;
    [header.textLabel setTextColor:[UIColor whiteColor]];

    // Another way to set the background color
    // Note: does not preserve gradient effect of original header
    // header.contentView.backgroundColor = [UIColor blackColor];
} 
```

取自我在这里的帖子： [https ://happyteamlabs.com/blog/ios-how-to-customize-table-view-header-and-footer-colors/](https://happyteamlabs.com/blog/ios-how-to-customize-table-view-header-and-footer-colors/)

**斯威夫特 3 / 4**

```
func tableView(_ tableView: UITableView, willDisplayHeaderView view: UIView, forSection section: Int){
    view.tintColor = UIColor.red
    let header = view as! UITableViewHeaderFooterView
    header.textLabel?.textColor = UIColor.white
} 
```

* * *

## 回答 #2

> 赞同：398
> 
> 时间：2009-05-01T20:23:05.897

希望协议中的这种方法`UITableViewDelegate`可以帮助您入门：

**目标-C：**

```
- (UIView *) tableView:(UITableView *)tableView viewForHeaderInSection:(NSInteger)section 
{
  UIView *headerView = [[[UIView alloc] initWithFrame:CGRectMake(0, 0, tableView.bounds.size.width, 30)] autorelease];
  if (section == integerRepresentingYourSectionOfInterest)
     [headerView setBackgroundColor:[UIColor redColor]];
  else 
     [headerView setBackgroundColor:[UIColor clearColor]];
  return headerView;
} 
```

**迅速：**

```
func tableView(_ tableView: UITableView!, viewForHeaderInSection section: Int) -> UIView!
{
  let headerView = UIView(frame: CGRect(x: 0, y: 0, width: tableView.bounds.size.width, height: 30))
  if (section == integerRepresentingYourSectionOfInterest) {
    headerView.backgroundColor = UIColor.redColor()
  } else {
    headerView.backgroundColor = UIColor.clearColor()
  }
  return headerView
} 
```

*2017 年更新：*

**斯威夫特 3：**

```
func tableView(_ tableView: UITableView, viewForHeaderInSection section: Int) -> UIView?
    {
        let headerView = UIView(frame: CGRect(x: 0, y: 0, width: tableView.bounds.size.width, height: 30))
        if (section == integerRepresentingYourSectionOfInterest) {
            headerView.backgroundColor = UIColor.red
        } else {
            headerView.backgroundColor = UIColor.clear
        }
        return headerView
    } 
```

换成你想要的`[UIColor redColor]`。`UIColor`您可能还希望调整`headerView`.

* * *

## 回答 #3

> 赞同：98
> 
> 时间：2010-01-18T01:48:10.597

这是更改文本颜色的方法。

```
UILabel *label = [[[UILabel alloc] initWithFrame:CGRectMake(10, 3, tableView.bounds.size.width - 10, 18)] autorelease];
label.text = @"Section Header Text Here";
label.textColor = [UIColor colorWithRed:1.0 green:1.0 blue:1.0 alpha:0.75];
label.backgroundColor = [UIColor clearColor];
[headerView addSubview:label]; 
```

* * *

## 回答 #4

> 赞同：58
> 
> 时间：2013-08-01T19:04:43.910

如果您想要具有自定义颜色的标题，您可以这样做。自 iOS 6.0 以来，此解决方案运行良好。

**目标 C：**

```
[[UITableViewHeaderFooterView appearance] setTintColor:[UIColor redColor]]; 
```

**迅速：**

```
UITableViewHeaderFooterView.appearance().tintColor = .white 
```

* * *

## 回答 #5

> 赞同：34
> 
> 时间：2015-06-20T08:03:29.543

以下解决方案适用于**iOS 8+ 的 Swift 1.2**

```
override func tableView(tableView: UITableView, willDisplayHeaderView view: UIView, forSection section: Int) {

    // This changes the header background
    view.tintColor = UIColor.blueColor()

    // Gets the header view as a UITableViewHeaderFooterView and changes the text colour
    var headerView: UITableViewHeaderFooterView = view as! UITableViewHeaderFooterView
    headerView.textLabel.textColor = UIColor.redColor()

} 
```

* * *

## 回答 #6

> 赞同：25
> 
> 时间：2013-03-01T21:17:00.117

在 UITableViewHeaderFooterView 上设置背景颜色已被弃用。请`contentView.backgroundColor`改用。

* * *

## 回答 #7

> 赞同：22
> 
> 时间：2016-02-03T11:17:13.427

您可以在大约 2 秒内在 main.storyboard 上完成。

1.  选择表视图
2.  转到属性检查器
3.  项目清单
4.  向下滚动到查看副标题
5.  换背景”

[![看看这里](https://i.stack.imgur.com/Q808i.png)](https://i.stack.imgur.com/Q808i.png)

* * *

## 回答 #8

> 赞同：20
> 
> 时间：2012-01-16T17:47:17.060

不要忘记从委托中添加这段代码，否则在某些情况下，您的视图将被截断或出现在表格后面，相对于您的视图/标签的高度。

```
- (CGFloat)tableView:(UITableView *)tableView heightForHeaderInSection:(NSInteger)section
{
    return 30;
} 
```

* * *

## 回答 #9

> 赞同：18
> 
> 时间：2013-10-03T02:54:31.507

如果您不想创建自定义视图，也可以像这样更改颜色（需要 iOS 6）：

```
-(void) tableView:(UITableView *)tableView willDisplayHeaderView:(UIView *)view forSection:(NSInteger)section {
    if ([view isKindOfClass: [UITableViewHeaderFooterView class]]) {
        UITableViewHeaderFooterView* castView = (UITableViewHeaderFooterView*) view;
        UIView* content = castView.contentView;
        UIColor* color = [UIColor colorWithWhite:0.85 alpha:1.]; // substitute your color here
        content.backgroundColor = color;
    }
} 
```

* * *

## 回答 #10

> 赞同：13
> 
> 时间：2014-02-15T23:18:37.310

设置section区域的背景和文字颜色：（感谢`William Jockusch`和`Dj S`）

```
- (void)tableView:(UITableView *)tableView willDisplayHeaderView:(UIView *)view forSection:(NSInteger)section
{
    if ([view isKindOfClass: [UITableViewHeaderFooterView class]]) {
        UITableViewHeaderFooterView* castView = (UITableViewHeaderFooterView*) view;
        castView.contentView.backgroundColor = [UIColor grayColor];
        [castView.textLabel setTextColor:[UIColor grayColor]];
    }
} 
```

* * *

## 回答 #11

> 赞同：13
> 
> 时间：2018-05-29T10:47:36.033

**斯威夫特 4**

要更改 UITableView 部分的标题视图的**背景颜色**、**文本标签颜色**和**字体**，只需像这样覆盖`willDisplayHeaderView`您的表格视图：

```
override func tableView(_ tableView: UITableView, willDisplayHeaderView view: UIView, forSection section: Int) {
        let header = view as! UITableViewHeaderFooterView
        header.backgroundView?.backgroundColor = .white
        header.textLabel?.textColor = .black
        header.textLabel?.font = UIFont(name: "Helvetica-Bold", size: 14)
} 
```

这对我来说非常有效；希望它也能帮助你！

* * *

## 回答 #12

> 赞同：11
> 
> 时间：2020-04-30T00:57:56.190

对于迅捷5 +

在`willDisplayHeaderView`方法

```
func tableView(_ tableView: UITableView, willDisplayHeaderView view: UIView, forSection section: Int) {

     //For Header Background Color
     view.tintColor = .black

    // For Header Text Color
    let header = view as! UITableViewHeaderFooterView
    header.textLabel?.textColor = .white
} 
```

我希望这可以帮助你 ：]

* * *

## 回答 #13

> 赞同：10
> 
> 时间：2011-12-14T09:02:16.120

以下是在标题视图中添加图像的方法：

```
- (UIView *) tableView:(UITableView *)tableView viewForHeaderInSection:(NSInteger)section 
{
    UIView *headerView = [[[UIView alloc] initWithFrame:CGRectMake(0, 0, tableView.bounds.size.width, 30)] autorelease];
    UIImageView *headerImage = [[[UIImageView alloc] initWithImage:[UIImage imageNamed:@"top-gery-bar.png"]] autorelease];

    headerImage.frame = CGRectMake(0, 0, tableView.bounds.size.width, 30);

    [headerView addSubview:headerImage];

    return headerView;
} 
```

* * *

## 回答 #14

> 赞同：9
> 
> 时间：2014-08-22T11:00:24.320

对于 iOS8 (Beta) 和 Swift 选择你想要的 RGB 颜色并试试这个：

```
override func tableView(tableView: UITableView!, viewForHeaderInSection section: Int) -> UIView! {
    var header :UITableViewHeaderFooterView = UITableViewHeaderFooterView()

    header.contentView.backgroundColor = UIColor(red: 254.0/255.0, green: 190.0/255.0, blue: 127.0/255.0, alpha: 1)
    return header 
```

}

（“覆盖”在那里，因为我在我的项目中使用 UITableViewController 而不是普通的 UIViewController，但更改部分标题颜色不是强制性的）

您的标题文本仍将可见。请注意，您将需要调整节标题高度。

祝你好运。

* * *

## 回答 #15

> 赞同：6
> 
> 时间：2016-07-28T17:55:18.883

**斯威夫特 2**

我能够通过添加模糊效果成功更改部分背景颜色（这真的很酷）。要轻松更改部分的背景颜色：

1.  首先转到 Storyboard 并选择 Table View
2.  转到属性检查器
3.  项目清单
4.  向下滚动查看
5.  换背景”

然后为了模糊效果，添加代码：

```
override func tableView(tableView: UITableView, willDisplayHeaderView view: UIView, forSection section: Int) {

    // This is the blur effect

    let blurEffect = UIBlurEffect(style: .Light)
    let blurEffectView = UIVisualEffectView(effect: blurEffect)

    // Gets the header view as a UITableViewHeaderFooterView and changes the text colour and adds above blur effect
    let headerView: UITableViewHeaderFooterView = view as! UITableViewHeaderFooterView
    headerView.textLabel!.textColor = UIColor.darkGrayColor()
    headerView.textLabel!.font = UIFont(name: "HelveticaNeue-Light", size: 13)
    headerView.tintColor = .groupTableViewBackgroundColor()
    headerView.backgroundView = blurEffectView

} 
```

* * *

## 回答 #16

> 赞同：6
> 
> 时间：2019-01-14T00:07:41.043

Swift 4 让它变得非常简单。只需将其添加到您的班级并根据需要设置颜色。

```
override func tableView(_ tableView: UITableView, willDisplayHeaderView view: UIView, forSection section: Int) {
        view.backgroundColor = UIColor(red: 0.094, green: 0.239, blue: 0.424, alpha: 1.0)
    } 
```

或者如果是简单的颜色

```
override func tableView(_ tableView: UITableView, willDisplayHeaderView view: UIView, forSection section: Int) {
        view.backgroundColor = UIColor.white
    } 
```

**为 Swift 5 更新**

```
override func tableView(_ tableView: UITableView, willDisplayHeaderView view: UIView, forSection section: Int) {
        view.tintColor = UIColor(red: 0.094, green: 0.239, blue: 0.424, alpha: 1.0)
    } 
```

或者如果是简单的颜色

```
override func tableView(_ tableView: UITableView, willDisplayHeaderView view: UIView, forSection section: Int) {
        view.tintColor = UIColor.white
    } 
```

* * *

## 回答 #17

> 赞同：5
> 
> 时间：2015-10-02T07:45:58.007

我知道它的答案，以防万一，在 Swift 中使用以下

```
 override func tableView(tableView: UITableView, viewForHeaderInSection section: Int) -> UIView? {
        let tableViewWidth = self.tableView.bounds

        let headerView = UIView(frame: CGRectMake(0, 0, tableViewWidth.size.width, self.tableView.sectionHeaderHeight))
        headerView.backgroundColor = UIColor.greenColor()

        return headerView
    } 
```

* * *

## 回答 #18

> 赞同：5
> 
> 时间：2021-02-13T13:40:11.540

对我来说，在浪费了 2 个小时之后，以上都不起作用，这是解决方案。在我的情况下，它是自定义视图，但由于某种原因，我无法从情节提要和视图的 awakeFromNib 更改它。

```
override func tableView(_ tableView: UITableView, willDisplayHeaderView view: UIView, forSection section: Int) {
        let header = view as! UITableViewHeaderFooterView
        header.contentView.backgroundColor = .white
    } 
```

* * *

## 回答 #19

> 赞同：4
> 
> 时间：2016-09-02T12:10:55.723

**iOS 8+**

```
func tableView(tableView: UITableView, willDisplayHeaderView view: UIView, forSection section: Int) {
        tableView.tableHeaderView?.backgroundColor = UIColor.blue()
} 
```

* * *

## 回答 #20

> 赞同：4
> 
> 时间：2016-11-03T16:41:07.380

基于@Dj S 的回答，使用 Swift 3。这在 iOS 10 上效果很好。

```
func tableView(_ tableView: UITableView, willDisplayHeaderView view: UIView, forSection section: Int) {
    // Background color
    view.tintColor = UIColor.black

    // Text Color
    let headerView = view as! UITableViewHeaderFooterView
    headerView.textLabel?.textColor = UIColor.white
} 
```

* * *

## 回答 #21

> 赞同：3
> 
> 时间：2014-01-24T01:40:38.910

我在 iOS 7.x 中有一个使用静态表格视图单元格的项目。willDisplayHeaderView 不会触发。但是，这种方法可以正常工作：

```
- (UIView *)tableView:(UITableView *)tableView viewForHeaderInSection:(NSInteger)section
{
    NSLog(@"%s", __FUNCTION__);
    CGRect headerFrame = CGRectMake(x, y, w, h);    
    UIView *headerView = [[UIView alloc] initWithFrame:headerFrame];  
    headerView.backgroundColor = [UIColor blackColor]; 
```

* * *

## 回答 #22

> 赞同：3
> 
> 时间：2014-02-06T09:28:45.877

```
 -(void) tableView:(UITableView *)tableView willDisplayHeaderView:(UIView *)view
  forSection:(NSInteger)section
  {
        if ([view isKindOfClass: [UITableViewHeaderFooterView class]])
        {
             UITableViewHeaderFooterView *castView = (UITableViewHeaderFooterView *) view;
             UIView *content = castView.contentView;
             UIColor *color = [UIColor whiteColor]; // substitute your color here
             content.backgroundColor = color;
             [castView.textLabel setTextColor:[UIColor blackColor]];
        }
 } 
```

* * *

## 回答 #23

> 赞同：3
> 
> 时间：2015-02-03T09:39:27.037

我认为这段代码还不错。

```
func tableView(tableView: UITableView, viewForHeaderInSection section: Int) -> UIView? {
    let headerView = tableView.dequeueReusableHeaderFooterViewWithIdentifier(MyHeaderView.reuseIdentifier) as MyHeaderView
    let backgroundView = UIView()
    backgroundView.backgroundColor = UIColor.whiteColor()
    headerView.backgroundView = backgroundView
    headerView.textLabel.text = "hello"
    return headerView
} 
```

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2014-02-15T21:59:13.823

在 iOS 7.0.4 中，我使用自己的 XIB 创建了一个自定义标头。在此之前没有提到任何内容。它必须是 UITableViewHeaderFooterView 的子类才能使用，`dequeueReusableHeaderFooterViewWithIdentifier:`而且似乎该类对于背景颜色非常顽固。所以最后我添加了一个名为 customBackgroudView 的 UIView（你可以使用代码或 IB 来完成），然后设置它的 backgroundColor 属性。在 layoutSubviews 中：我将该视图的框架设置为边界。**它适用于 iOS 7 并且不会出现故障。**

```
// in MyTableHeaderView.xib drop an UIView at top of the first child of the owner
// first child becomes contentView

// in MyTableHeaderView.h
@property (nonatomic, weak) IBOutlet UIView * customBackgroundView;

// in MyTableHeaderView.m
-(void)layoutSubviews;
{
    [super layoutSubviews];

    self.customBackgroundView.frame = self.bounds;
}
// if you don't have XIB / use IB, put in the initializer:
-(id)initWithReuseIdentifier:(NSString *)reuseIdentifier
{
    ...
    UIView * customBackgroundView = [[UIView alloc] init];
    [self.contentView addSubview:customBackgroundView];
    _customBackgroundView = customBackgroundView;
    ...
}

// in MyTableViewController.m
-(UIView *)tableView:(UITableView *)tableView viewForHeaderInSection:(NSInteger)section
{
    MyTableHeaderView * header = [self.tableView
                                          dequeueReusableHeaderFooterViewWithIdentifier:@"MyTableHeaderView"];
    header.customBackgroundView.backgroundColor = [UIColor redColor];
    return header;
} 
```

* * *

## 回答 #25

> 赞同：2
> 
> 时间：2016-04-13T07:18:00.237

只需更改标题视图的图层颜色

```
- (UIView *) tableView:(UITableView *)tableView viewForHeaderInSection:(NSInteger)section
{
  UIView *headerView = [[[UIView alloc] initWithFrame:CGRectMake(0, 0, tableView.bounds.size.width, 30)] autorelease];
 headerView.layer.backgroundColor = [UIColor clearColor].CGColor
}

```

* * *

## 回答 #26

> 赞同：2
> 
> 时间：2016-07-28T21:30:14.410

如果有人需要 swift，请保留标题：

```
override func tableView(tableView: UITableView, viewForHeaderInSection section: Int) -> UIView? {
    let view = UIView(frame: CGRect(x: 0,y: 0,width: self.tableView.frame.width, height: 30))
    view.backgroundColor = UIColor.redColor()
    let label = UILabel(frame: CGRect(x: 15,y: 5,width: 200,height: 25))
    label.text = self.tableView(tableView, titleForHeaderInSection: section)
    view.addSubview(label)
    return view
} 
```

* * *

## 回答 #27

> 赞同：2
> 
> 时间：2017-10-04T09:10:35.367

我通过控制台日志从 Xcode 收到消息

> [TableView] 在 UITableViewHeaderFooterView 上设置背景颜色已被弃用。请改为将具有所需背景颜色的自定义 UIView 设置为 backgroundView 属性。

然后我只是创建一个新的 UIView 并将其作为 HeaderView 的背景。这不是一个好的解决方案，但正如 Xcode 所说的那样容易。

* * *

## 回答 #28

> 赞同：2
> 
> 时间：2017-11-09T09:23:53.277

就我而言，它是这样工作的：

```
let headerIdentifier = "HeaderIdentifier"
let header = self.tableView.dequeueReusableHeaderFooterView(withIdentifier: headerIdentifier)
header.contentView.backgroundColor = UIColor.white 
```

* * *

## 回答 #29

> 赞同：2
> 
> 时间：2018-12-11T11:00:40.203

只需设置背景视图的背景颜色：

```
func tableView(_ tableView: UITableView, willDisplayHeaderView view: UIView, forSection section: Int){         
  let tableHeader = view as! UITableViewHeaderFooterView        
  tableHeader.backgroundView?.backgroundColor = UIColor.white     
} 
```

* * *

## 回答 #30

> 赞同：2
> 
> 时间：2021-01-26T06:09:40.500

如果您使用的是自定义标题视图：

```
class YourCustomHeaderFooterView: UITableViewHeaderFooterView { 

override func awakeFromNib() {
    super.awakeFromNib()
    self.contentView.backgroundColor = .white //Or any color you want
} 
```

}

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2016-02-17T21:23:54.777

使用 RubyMotion / RedPotion，将其粘贴到您的 TableScreen 中：

```
 def tableView(_, willDisplayHeaderView: view, forSection: section)
    view.textLabel.textColor = rmq.color.your_text_color
    view.contentView.backgroundColor = rmq.color.your_background_color
  end 
```

奇迹般有效！

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2018-01-16T12:46:21.593

虽然`func tableView(_ tableView: UITableView, willDisplayHeaderView view: UIView, forSection section: Int)`也可以，但您可以在不实现另一个委托方法的情况下实现这一点。在您的`func tableView(_ tableView: UITableView, viewForHeaderInSection section: Int) -> UIView?`方法中，您可以使用`view.contentView.backgroundColor = UIColor.white`哪个`view.backgroundView?.backgroundColor = UIColor.white`不起作用。（我知道这`backgroundView`是可选的，但即使它在那里，如果不实施，这也不会发生`willDisplayHeaderView`

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2018-01-26T19:08:03.193

使用 UIAppearance 您可以为应用程序中的所有标头更改它，如下所示：

UITableViewHeaderFooterView.appearance().backgroundColor = theme.subViewBackgroundColor

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2020-11-08T17:22:14.707

iOS 13> 迅捷 5

`func tableView(_ tableView: UITableView, willDisplayHeaderView view: UIView, forSection section: Int) {view.tintColor = UIColor.red }`

# java - java - 如何在没有窗口框架的Java中显示形状或图形？

> ID：813072
> 
> 赞同：1
> 
> 时间：2009-05-01T20:14:55.950
> 
> 标签：java, graphics

我很难尝试制作一个只有一个形状（例如矩形）作为主窗口的 Java 程序。我不希望形状位于“操作系统窗口”内（带有关闭和最小化按钮等）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-01T20:19:00.027

我不知道你是否可以在 Java 中直接在屏幕上绘图（我倾向于认为你不能）。但是您可以创建一个[`JDialog`](http://java.sun.com/javase/6/docs/api/javax/swing/JDialog.html)（不会出现在任务栏中）并调用[`setUndecorated(true)`](http://java.sun.com/javase/6/docs/api/java/awt/Dialog.html#setUndecorated(boolean))它（以摆脱标题栏）。然后你可以用它做任何你想做的自定义绘画。

**编辑：** [kts](https://stackoverflow.com/users/71859/kts)指出，[`JWindow`](http://java.sun.com/javase/6/docs/api/javax/swing/JWindow.html)为此目的会更好。来自 Javadocs：

> 它没有标题栏、窗口管理按钮或其他与 a 相关的装饰`JFrame`，但它仍然是用户桌面的“一等公民”，并且可以存在于桌面上的任何位置。

甚至还有一个[无参数的构造函数](http://java.sun.com/javase/6/docs/api/javax/swing/JWindow.html#JWindow())，所以你不必担心传入`null`所有者！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-01T20:29:23.700

对于更奇特的形状：[半透明和异形窗户](http://java.sun.com/developer/technicalArticles/GUI/translucent_shaped_windows/)。仅适用于 6u10 及更高版本。

# iphone - iPhone app 以公司名义提交

> ID：813080
> 
> 赞同：4
> 
> 时间：2009-05-01T20:17:11.590
> 
> 标签：iphone, itunes, itunes-store

我和我的团队已与一家公司签订合同，以开发我们的第一个 iPhone 应用程序。

我想知道如何最好地处理这种承包商关系。99美元的SDK/Dev连接账户是否需要建立在承包商名下，这样申请通过时就不是我们公司的名字，而是他们的公司名？

本质上，以承包商的名义提交申请是最佳实践，还是在您申请时可以选择定义这个？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-03T07:20:19.193

你得到一个帐户，他们得到一个帐户。帐户有两个功能。访问开发工具并访问发布应用程序的公司的业务界面。

你注册一次。每个客户都出于最重要的原因注册自己的帐户。那就是银行信息告诉钱去哪里的地方。:)。以及合同和销售数据等。

它的最佳工作方式是让您在通配符开发人员和分发（临时）代码签名密钥（您的帐户）下进行开发。您使用相同的密钥为多个客户签名。最后，您使用特定的 AppStore 密钥（每个客户的帐户）进行签名和发布。

这将允许您进行控制开发、测试和 beta 分发。开发完成后，您将使用他们的密钥签名的发布版本压缩起来，然后他们通过 iTunes Connect 将其上传到他们的帐户下。

奖励部分：这个配置很容易在 XCode 中设置（一旦你克服了 24 小时的绞杀，了解了 xcode 和分发证书的工作原理）。

转到项目->编辑项目设置->配置。从“发布”配置中复制两个新配置。一个叫“Ad Hoc”，另一个叫“AppStore”。如下设置您的签名证书，iPhone Developer for Debug/Release，iPhone Distribution (Ad Hoc) for Ad Hoc，他们的 iPhone Distribution (AppStore) 为“AppStore”。直到最后忘记你甚至有一个客户端，然后切换到 AppStore 分发、构建、压缩、发送电子邮件，然后完成。

在实践中，它比这更复杂，因为您需要在您的机器上设置多个证书/配置文件/密钥，但是一旦完成，它基本上就是这样运行的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T20:48:42.373

我将创建开发帐户并将其发布在拥有应用程序和源代码的公司下，无论谁在开发它。

# windows - 我可以向 Windows 上的应用程序发送 ctrl-C (SIGINT) 吗？

> ID：813086
> 
> 赞同：101
> 
> 时间：2009-05-01T20:18:50.697
> 
> 标签：windows, signals, sigint

我（过去）编写过跨平台（Windows/Unix）应用程序，当从命令行启动时，以相同的方式处理用户键入`Ctrl`的`C`组合（即干净地终止应用程序）。

在 Windows 上是否可以从另一个（不相关的）进程向进程发送`Ctrl`- `C`/SIGINT/equivalent 请求它干净地终止（给它一个整理资源等的机会）？

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2013-03-07T20:27:09.903

我围绕这个主题做了一些研究，结果证明它比我预期的更受欢迎。KindDragon 的回答是关键点之一。

我就该主题写了一篇[较长的博客文章](http://stanislavs.org/?p=387)并创建了一个工作演示程序，该程序演示了使用这种类型的系统以几种不错的方式关闭命令行应用程序。那篇文章还列出了我在研究中使用的外部链接。

简而言之，这些演示程序执行以下操作：

*   *使用.Net*启动带有可见窗口的程序，使用隐藏`pinvoke`，运行 6 秒，使用 显示，使用*.Net*`pinvoke`停止。
**   *使用.Net*启动没有窗口的程序，运行 6 秒，通过附加控制台并发出停止`ConsoleCtrlEvent`*

 ***编辑：**来自*@KindDragon*的修改后的解决方案，适用于现在对代码感兴趣的人。如果您打算在停止第一个程序后启动其他程序，则应重新启用`CTRL`+`C`处理，否则下一个进程将继承父进程的禁用状态，并且不会响应`CTRL`+ `C`。

```
[DllImport("kernel32.dll", SetLastError = true)]
static extern bool AttachConsole(uint dwProcessId);

[DllImport("kernel32.dll", SetLastError = true, ExactSpelling = true)]
static extern bool FreeConsole();

[DllImport("kernel32.dll")]
static extern bool SetConsoleCtrlHandler(ConsoleCtrlDelegate HandlerRoutine, bool Add);

delegate bool ConsoleCtrlDelegate(CtrlTypes CtrlType);

// Enumerated type for the control messages sent to the handler routine
enum CtrlTypes : uint
{
    CTRL_C_EVENT = 0,
    CTRL_BREAK_EVENT,
    CTRL_CLOSE_EVENT,
    CTRL_LOGOFF_EVENT = 5,
    CTRL_SHUTDOWN_EVENT
}

[DllImport("kernel32.dll")]
[return: MarshalAs(UnmanagedType.Bool)]
private static extern bool GenerateConsoleCtrlEvent(CtrlTypes dwCtrlEvent, uint dwProcessGroupId);

public void StopProgram(Process proc)
{
    //This does not require the console window to be visible.
    if (AttachConsole((uint)proc.Id))
    {
    // Disable Ctrl-C handling for our program
    SetConsoleCtrlHandler(null, true); 
    GenerateConsoleCtrlEvent(CtrlTypes.CTRL_C_EVENT, 0);

    //Moved this command up on suggestion from Timothy Jannace (see comments below)
    FreeConsole();

    // Must wait here. If we don't and re-enable Ctrl-C
    // handling below too fast, we might terminate ourselves.
    proc.WaitForExit(2000);

    //Re-enable Ctrl-C handling or any subsequently started
    //programs will inherit the disabled state.
    SetConsoleCtrlHandler(null, false); 
    }
} 
```

此外，如果或发送的信号失败，请计划应急解决方案`AttachConsole()`，例如睡眠，然后：

```
if (!proc.HasExited)
{
    try
    {
    proc.Kill();
    }
    catch (InvalidOperationException e){}
} 
```

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2009-07-24T17:46:46.993

我最接近解决方案的是[SendSignal](http://web.archive.org/web/20170909040729/http://www.latenighthacking.com/projects/2003/sendSignal/) 3rd 方应用程序。作者列出了源代码和可执行文件。我已经验证它可以在 64 位 Windows 下工作（作为 32 位程序运行，杀死另一个 32 位程序），但我还没有弄清楚如何将代码嵌入到 Windows 程序中（32 位或 64 位）。

这个怎么运作：

> 在调试器中进行大量挖掘之后，我发现实际执行与 ctrl-break 等信号相关的行为的入口点是 kernel32!CtrlRoutine。该函数与 ThreadProc 具有相同的原型，因此可以直接与 CreateRemoteThread 一起使用，而无需注入代码。但是，这不是导出的符号！它在不同版本的 Windows 上位于不同的地址（甚至有不同的名称）。该怎么办？
> 
> 这是我最终想出的解决方案。我为我的应用程序安装了一个控制台 ctrl 处理程序，然后为我的应用程序生成一个 ctrl-break 信号。当我的处理程序被调用时，我回头查看堆栈顶部以找出传递给 kernel32!BaseThreadStart 的参数。我抓住第一个参数，这是线程想要的起始地址，也就是 kernel32!CtrlRoutine 的地址。然后我从我的处理程序返回，表明我已经处理了信号并且我的应用程序不应该被终止。回到主线程，我等到 kernel32!CtrlRoutine 的地址被检索到。一旦我得到它，我在目标进程中创建一个带有发现的起始地址的远程线程。这会导致评估目标进程中的 ctrl 处理程序，就像按下 ctrl-break 一样！
> 
> 好处是只有目标进程受到影响，任何进程（甚至是窗口进程）都可以成为目标。一个缺点是我的小应用程序不能在批处理文件中使用，因为它会在发送 ctrl-break 事件以发现 kernel32!CtrlRoutine 的地址时杀死它。

（`start`如果在批处理文件中运行它，则在它之前。）

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2010-03-15T07:58:27.510

我想我在这个问题上有点晚了，但无论如何我都会为遇到同样问题的人写一些东西。这与我对[这个](https://stackoverflow.com/questions/1453520/run-arbitrary-subprocesses-on-windows-and-still-terminate-cleanly)问题的回答相同。

我的问题是我希望我的应用程序是一个 GUI 应用程序，但执行的进程应该在后台运行，而不附加任何交互式控制台窗口。我认为当父进程是控制台进程时，这个解决方案也应该起作用。不过，您可能必须删除“CREATE_NO_WINDOW”标志。

我设法使用带有包装应用程序的[GenerateConsoleCtrlEvent () 解决了这个问题。](https://msdn.microsoft.com/en-us/library/windows/desktop/ms683155%28v=vs.85%29.aspx?f=255&MSPPError=-2147217396)棘手的部分只是文档并不清楚如何使用它以及它的陷阱。

我的解决方案基于[此处](http://social.msdn.microsoft.com/Forums/en-US/windowsgeneraldevelopmentissues/thread/dc9586ab-1ee8-41aa-a775-cf4828ac1239)描述的内容。但这也并没有真正解释所有细节并且出现错误，因此这里是有关如何使其工作的详细信息。

创建一个新的帮助应用程序“Helper.exe”。此应用程序将位于您的应用程序（父）和您希望能够关闭的子进程之间。它还将创建实际的子进程。您必须有这个“中间人”进程，否则 GenerateConsoleCtrlEvent() 将失败。

使用某种 IPC 机制从父进程与助手进程通信，助手应该关闭子进程。当助手收到此事件时，它会调用“GenerateConsoleCtrlEvent(CTRL_BREAK, 0)”，它会关闭自身和子进程。我自己为此使用了一个事件对象，当父进程想要​​取消子进程时，它完成了它。

要创建您的 Helper.exe，请使用 CREATE_NO_WINDOW 和 CREATE_NEW_PROCESS_GROUP 创建它。并且在创建子进程时创建它没有标志（0），这意味着它将从其父进程派生控制台。不这样做将导致它忽略该事件。

每个步骤都像这样完成是非常重要的。我一直在尝试各种不同的组合，但这种组合是唯一有效的组合。您不能发送 CTRL_C 事件。它将返回成功，但会被进程忽略。CTRL_BREAK 是唯一有效的。并不重要，因为他们最终都会调用 ExitProcess() 。

您也不能使用子进程 id 的进程分组 id 直接调用 GenerateConsoleCtrlEvent() 以允许帮助程序进程继续存在。这也会失败。

我花了一整天的时间试图让这个工作。该解决方案对我有用，但如果有人要添加其他内容，请执行。我在网上找到了很多有类似问题但没有明确解决问题的人。GenerateConsoleCtrlEvent() 的工作原理也有点奇怪，所以如果有人知道更多细节，请分享。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2012-10-15T15:43:56.013

如果您为另一个进程调用它会以某种方式`GenerateConsoleCtrlEvent()`返回错误，但您可以附加到另一个控制台应用程序并将事件发送到所有子进程。

```
void SendControlC(int pid)
{
    AttachConsole(pid); // attach to process console
    SetConsoleCtrlHandler(NULL, TRUE); // disable Control+C handling for our app
    GenerateConsoleCtrlEvent(CTRL_C_EVENT, 0); // generate Control+C event
} 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-05-01T20:23:46.410

编辑：

对于 GUI 应用程序，在 Windows 开发中处理此问题的“正常”方式是向进程的主窗口发送 WM_CLOSE 消息。

对于控制台应用程序，您需要使用[SetConsoleCtrlHandler](http://msdn.microsoft.com/en-us/library/ms686016(VS.85).aspx)添加一个`CTRL_C_EVENT`.

如果应用程序不遵守这一点，您可以调用[TerminateProcess](http://msdn.microsoft.com/en-us/library/ms686714(VS.85).aspx)。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2017-01-04T10:04:58.287

这是我在 C++ 应用程序中使用的代码。

**积极点：**

*   从控制台应用程序工作
*   从 Windows 服务工作
*   无需延迟
*   不关闭当前应用

**缺点：**

*   主控制台丢失并创建了一个新控制台（请参阅[FreeConsole](https://msdn.microsoft.com/fr-fr/library/windows/desktop/ms683150(v=vs.85).aspx)）
*   控制台切换会产生奇怪的结果......

* * *

```
// Inspired from http://stackoverflow.com/a/15281070/1529139
// and http://stackoverflow.com/q/40059902/1529139
bool signalCtrl(DWORD dwProcessId, DWORD dwCtrlEvent)
{
    bool success = false;
    DWORD thisConsoleId = GetCurrentProcessId();
    // Leave current console if it exists
    // (otherwise AttachConsole will return ERROR_ACCESS_DENIED)
    bool consoleDetached = (FreeConsole() != FALSE);

    if (AttachConsole(dwProcessId) != FALSE)
    {
        // Add a fake Ctrl-C handler for avoid instant kill is this console
        // WARNING: do not revert it or current program will be also killed
        SetConsoleCtrlHandler(nullptr, true);
        success = (GenerateConsoleCtrlEvent(dwCtrlEvent, 0) != FALSE);
        FreeConsole();
    }

    if (consoleDetached)
    {
        // Create a new console if previous was deleted by OS
        if (AttachConsole(thisConsoleId) == FALSE)
        {
            int errorCode = GetLastError();
            if (errorCode == 31) // 31=ERROR_GEN_FAILURE
            {
                AllocConsole();
            }
        }
    }
    return success;
} 
```

用法示例：

```
DWORD dwProcessId = ...;
if (signalCtrl(dwProcessId, CTRL_C_EVENT))
{
    cout << "Signal sent" << endl;
} 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2017-04-25T10:26:43.850

```
 void SendSIGINT( HANDLE hProcess )
        {
            DWORD pid = GetProcessId(hProcess);
            FreeConsole();
            if (AttachConsole(pid))
            {
                // Disable Ctrl-C handling for our program
                SetConsoleCtrlHandler(NULL, true);

                GenerateConsoleCtrlEvent(CTRL_C_EVENT, 0); // SIGINT

                //Re-enable Ctrl-C handling or any subsequently started
                //programs will inherit the disabled state.
                SetConsoleCtrlHandler(NULL, false);

                WaitForSingleObject(hProcess, 10000);
            }
        } 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2020-11-20T13:10:23.313

感谢[jimhark 的回答](https://stackoverflow.com/a/39521291/5194303)和其他答案，我在 PowerShell 中找到了一种方法：

```
$ProcessID = 1234
$MemberDefinition = '
    [DllImport("kernel32.dll")]public static extern bool FreeConsole();
    [DllImport("kernel32.dll")]public static extern bool AttachConsole(uint p);
    [DllImport("kernel32.dll")]public static extern bool GenerateConsoleCtrlEvent(uint e, uint p);
    public static void SendCtrlC(uint p) {
        FreeConsole();
        if (AttachConsole(p)) {
            GenerateConsoleCtrlEvent(0, p);
            FreeConsole();
        }
        AttachConsole(uint.MaxValue);
    }'
Add-Type -Name 'dummyName' -Namespace 'dummyNamespace' -MemberDefinition $MemberDefinition
[dummyNamespace.dummyName]::SendCtrlC($ProcessID) 
```

使事情奏效的是将其发送[`GenerateConsoleCtrlEvent`](https://docs.microsoft.com/en-us/windows/console/generateconsolectrlevent)到所需的进程组，而不是将其发送到**共享调用进程控制台的所有进程，**然后[`AttachConsole`](https://docs.microsoft.com/en-us/windows/console/attachconsole)返回到**当前进程的父进程的控制台**。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2015-03-26T12:11:10.077

应该说得很清楚，因为目前还不是。 **SendSignal 有一个修改和编译的版本来发送 Ctrl-C**（默认情况下它只发送 Ctrl+Break）。以下是一些二进制文件：

> (2014-3-7)：我用 Ctrl-C 构建了 32 位和 64 位版本，它被称为 SendSignalCtrlC.exe，您可以在以下位置下载它：[https ://dl.dropboxusercontent.com/u/49065779/ sendsignalctrlc/x86/SendSignalCtrlC.exe](https://dl.dropboxusercontent.com/u/49065779/sendsignalctrlc/x86/SendSignalCtrlC.exe) [https://dl.dropboxusercontent.com/u/49065779/sendsignalctrlc/x86_64/SendSignalCtrlC.exe](https://dl.dropboxusercontent.com/u/49065779/sendsignalctrlc/x86_64/SendSignalCtrlC.exe) -- Juraj Michalak

我还镜像了这些文件以防万一：
32 位版本：[https](https://www.dropbox.com/s/r96jxglhkm4sjz2/SendSignalCtrlC.exe?dl=0)
://www.dropbox.com/s/r96jxglhkm4sjz2/SendSignalCtrlC.exe?dl=0 64 位版本：[https ://www.dropbox.com /s/hhe0io7mcgcle1c/SendSignalCtrlC64.exe?dl=0](https://www.dropbox.com/s/hhe0io7mcgcle1c/SendSignalCtrlC64.exe?dl=0)

免责声明：我没有构建这些文件。未对编译的原始文件进行任何修改。唯一测试的平台是 64 位 Windows 7。建议改编[http://www.latenighthacking.com/projects/2003/sendSignal/](http://www.latenighthacking.com/projects/2003/sendSignal/)上的可用源并自己编译。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2017-03-16T16:30:36.937

在 Java 中，将 JNA 与 Kernel32.dll 库一起使用，类似于 C++ 解决方案。将 CtrlCSender 主方法作为 Process 运行，它只是获取进程的控制台以将 Ctrl+C 事件发送到并生成事件。由于它在没有控制台的情况下单独运行，因此不需要禁用并再次启用 Ctrl+C 事件。

**CtrlCSender.java** - 基于[Nemo1024](https://stackoverflow.com/a/15281070/3372187)和[KindDragon 的](https://stackoverflow.com/a/12899190/3372187)答案。

给定一个已知的进程 ID，这个无控制台应用程序将附加目标进程的控制台并在其上生成一个 CTRL+C 事件。

```
import com.sun.jna.platform.win32.Kernel32;    

public class CtrlCSender {

    public static void main(String args[]) {
        int processId = Integer.parseInt(args[0]);
        Kernel32.INSTANCE.AttachConsole(processId);
        Kernel32.INSTANCE.GenerateConsoleCtrlEvent(Kernel32.CTRL_C_EVENT, 0);
    }
} 
```

**主应用程序**- 将 CtrlCSender 作为单独的无控制台进程运行

```
ProcessBuilder pb = new ProcessBuilder();
pb.command("javaw", "-cp", System.getProperty("java.class.path", "."), CtrlCSender.class.getName(), processId);
pb.redirectErrorStream();
pb.redirectOutput(ProcessBuilder.Redirect.INHERIT);
pb.redirectError(ProcessBuilder.Redirect.INHERIT);
Process ctrlCProcess = pb.start();
ctrlCProcess.waitFor(); 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2019-04-02T03:26:12.090

是的。该[`windows-kill`](https://web.archive.org/web/20200910171034/https://github.com/alirdn/windows-kill)项目完全符合您的要求：

```
windows-kill -SIGINT 1234 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2020-10-14T16:14:17.607

如果您的命令行中有可用的 python 3.x ，我[从这里找到的解决方案非常简单。](https://stackoverflow.com/questions/7085604/sending-c-to-python-subprocess-objects-on-windows)首先，保存一个包含以下内容的文件 (ctrl_c.py)：

```
import ctypes
import sys

kernel = ctypes.windll.kernel32

pid = int(sys.argv[1])
kernel.FreeConsole()
kernel.AttachConsole(pid)
kernel.SetConsoleCtrlHandler(None, 1)
kernel.GenerateConsoleCtrlEvent(0, 0)
sys.exit(0) 
```

然后调用：

```
python ctrl_c.py 12345 
```

如果这不起作用，我建议尝试 windows-kill 项目：[https ://github.com/alirdn/windows-kill](https://github.com/alirdn/windows-kill)

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2014-02-11T11:01:48.350

我发现这一切都太复杂了，并使用[SendKeys](http://www.codeproject.com/Articles/6819/SendKeys-in-C)将`CTRL`-`C`击键发送到命令行窗口（即 cmd.exe 窗口）作为一种解决方法。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2015-01-22T20:45:54.500

我的一个朋友提出了一种完全不同的解决问题的方法，它对我有用。使用如下所示的 vbscript。它启动并应用程序，让它运行 7 秒，然后使用**ctrl+c**关闭它。

**'VBScript 示例**

```
Set WshShell = WScript.CreateObject("WScript.Shell")

WshShell.Run "notepad.exe"

WshShell.AppActivate "notepad"

WScript.Sleep 7000

WshShell.SendKeys "^C" 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2020-06-03T02:19:31.963

```
// Send [CTRL-C] to interrupt a batch file running in a Command Prompt window, even if the Command Prompt window is not visible,
// without bringing the Command Prompt window into focus.
// [CTRL-C] will have an effect on the batch file, but not on the Command Prompt  window itself -- in other words,
// [CTRL-C] will not have the same visible effect on a Command Prompt window that isn't running a batch file at the moment
// as bringing a Command Prompt window that isn't running a batch file into focus and pressing [CTRL-C] on the keyboard.
ulong ulProcessId = 0UL;
// hwC = Find Command Prompt window HWND
GetWindowThreadProcessId (hwC, (LPDWORD) &ulProcessId);
AttachConsole ((DWORD) ulProcessId);
SetConsoleCtrlHandler (NULL, TRUE);
GenerateConsoleCtrlEvent (CTRL_C_EVENT, 0UL);
SetConsoleCtrlHandler (NULL, FALSE);
FreeConsole (); 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2020-10-02T05:42:37.540

SIGINT 可以使用[windows-kill](https://github.com/alirdn/windows-kill/releases)发送到程序，通过语法`windows-kill -SIGINT PID`，`PID`可以通过微软的[pslist](https://download.sysinternals.com/files/PSTools.zip)获得。

关于捕获 SIGINT，如果您的程序使用 Python，那么您可以像在[此解决方案](https://stackoverflow.com/a/31464349/941531)中那样实现 SIGINT 处理/捕获。

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2017-02-03T10:41:28.237

基于进程ID，我们可以向进程发送信号以强制或优雅终止或任何其他信号。

列出所有进程：

```
C:\>tasklist 
```

要杀死进程：

```
C:\>Taskkill /IM firefox.exe /F
or
C:\>Taskkill /PID 26356 /F 
```

细节：

[http://tweaks.com/windows/39559/kill-processes-from-command-prompt/](http://tweaks.com/windows/39559/kill-processes-from-command-prompt/)

# asp.net - TextBox 导致 ASP.NET 中的按钮回发

> ID：813095
> 
> 赞同：5
> 
> 时间：2009-05-01T20:20:39.087
> 
> 标签：asp.net, .net-2.0, postback

ASP.NET 2.0，在 FF3 和 IE7 中测试。

当我从文本框中点击“输入”按钮时，页面中第一个 ImageButton 的相应“OnClick”事件被触发。如果我删除该图像按钮，它会触发页面上的下一个 ImageButton OnClick 事件。

在 FireBug 控制台中，如果我使用 JavaScript 提交表单，则不会发生这种情况。但无论出于何种原因，从文本框中按回车都会触发不相关的 ImageButton 事件。

我发现[这个问题](https://stackoverflow.com/questions/712407/textbox-on-gridview-causing-a-button-click-event-to-fire)有一个类似的问题，但是该解决方案的建议答案不起作用，因为 ImageButtons 上没有“UseSubmitBehavior”属性。

我不明白为什么会触发此事件。如果我查看 Request.Form，我可以看到 __EVENTTARGET 是空的，它实际上发布了整个表单内容（我的所有文本框），还包括 imageButton.x 和 imageButton.y 键/值对。

为什么是这样？我想我可以使用 javascript 从这些文本框中检测到“输入”按键，但我过去的经验是，这种行为在浏览器之间是高度可变的。有什么建议么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-02T00:47:27.973

这是一个更优雅的解决方案

`<asp:TextBox ID="TextBox1" runat="server" onkeydown = "return (event.keyCode!=13);" > </asp:TextBox>`

[在这里](http://www.aspsnippets.com/post/2009/05/21/Disable-Enter-key-in-TextBox-to-avoid-postback-in-ASPNet.aspx)阅读整篇文章

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-01T20:24:09.017

您可以尝试在 asp 面板或表单中设置默认按钮。这将让您控制当用户按下回车键时会发生什么。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-11T17:38:32.643

我的项目也有同样的问题。

之所以会出现此问题，是因为 ASP.NET*始终*假定从`IButton`接口（Button 和 ImageButton）继承的第一个元素是页面的默认按钮。

Hipoteticaly，如果您使用 LinkBut​​ton 而不是 Button 或 ImageButton，则此问题已解决。

[您可以在 MSDN 上](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.panel.defaultbutton%28v=vs.80%29.aspx)找到更多信息。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-01T20:36:04.773

您可以禁止按下 Enter 键，因此用户必须单击您的 ImageButtons。只需将此 javascript 块粘贴到您的页面上：

```
<script type="text/javascript">
function stopRKey(evt) { 
  var evt = (evt) ? evt : ((event) ? event : null); 
  var node = (evt.target) ? evt.target : ((evt.srcElement) ? evt.srcElement : null); 
  if ((evt.keyCode == 13) && (node.type=="text"))  {return false;} 
}
document.onkeypress = stopRKey;
</script> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-01-10T19:28:32.573

最近，我一直在使用 Web 服务和更少的回发在客户端上做更多的事情。通过将我的控件移到表单元素之外（或完全消除它），问题就消失了。它默认插入到 aspx 页面上，但直到最近我才意识到我不需要它来完成我所做的大部分工作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-01T20:28:05.700

它是在非文本区域中按下回车按钮以回发表单的默认行为。您必须在 javascript 方法中处理它才能停止回发。

您只需要检查 window.event.keyCode 属性以查看其是否等于 13。如果是，请将其重置为 0。

```
function KeyPress()
  {
     if (window.event.keyCode == 13)
        {
           window.event.keyCode = 0;
        }
  } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-01T20:30:54.553

> 我想我可以使用 javascript 从这些文本框中检测到“输入”按键

这就是我为解决这种行为所做的，它在 IE7 和 FF3 中效果很好。只是有点不自然。

这是一个通用示例：

```
 function TextBox1_KeyDown(sender, e)
    {
    var key;
        if(window.event)
            key = window.event.keyCode; //IE
        else
            key = e.which; //firefox
        if(key == 13 && $("#TextBox1").val() != "")
        {
            WebForm_DoPostBackWithOptions(new WebForm_PostBackOptions("TextBox1", "", true, "", "", false, true));
        }
        return (key != 13);
    } 
```

我使用了 WebForm_DoPostBackWithOptions 因为我需要验证器来触发。否则，您可能需要使用 __DoPostBack。

以下是“原型”：

```
function __doPostBack(eventTarget, eventArgument)

function WebForm_PostBackOptions(eventTarget, eventArgument, validation, validationGroup, actionUrl, trackFocus, clientSubmit)
{
    this.eventTarget = eventTarget;
    this.eventArgument = eventArgument;
    this.validation = validation;
    this.validationGroup = validationGroup;
    this.actionUrl = actionUrl;
    this.trackFocus = trackFocus;
    this.clientSubmit = clientSubmit;
}

function WebForm_DoPostBackWithOptions(options) 
```

希望能帮助到你。

PS：我在这里使用了 JQuery，但 $get 是一样的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-10-13T17:14:19.550

这是我找到的一个优雅的解决方案，以防其他人遇到此问题（以防所有其他解决方案对您不起作用，因为它们对我不起作用）：

```
<asp:UpdatePanel runat="server">
<ContentTemplate>
    <asp:Panel runat="server" DefaultButton="doNothingButton">
        <ul id="shopping-list-ul">
        </ul>
        <asp:Button CssClass="invisible" runat="server" ID="doNothingButton" OnClientClick="return false;" />
    </asp:Panel>
</ContentTemplate> 
```

文本框本身位于 ul 内（由 javascript 生成）。
按下回车会触发“doNothingButton”，它会在客户端返回false，根本没有回发！

# java - 是否有用于在 Java 中读取、操作和编写 ASN.1 的免费包？

> ID：813101
> 
> 赞同：9
> 
> 时间：2009-05-01T20:22:21.297
> 
> 标签：java, packages, asn.1

是否有用于在 Java 中读取、操作和编写 ASN.1 的免费包？

一定是：

1.  自由
2.  轻的
3.  自包含（没有外部依赖，例如 Apache commons）
4.  Java 5（不是 Java 6），Java 4 是首选。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-14T01:02:20.093

以下项目看起来很有希望：

[http://www.chaosinmotion.com/wiki/index.php?title=ASN.1_Library](http://www.chaosinmotion.com/wiki/index.php?title=ASN.1_Library)

它是根据自由 BSD 风格的许可证提供的。

它很小，有 41 个类，编译为 55KiB。

它编译干净，不依赖于 Java 3。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-01T20:30:23.993

免费的[BouncyCastle](http://www.bouncycastle.org/docs/docs1.4/org/bouncycastle/asn1/package-summary.html)库提供低级 ASN.1 解析。您无需安装 BC 作为提供程序即可使用 ASN.1 功能。它有 1.4 及更高版本的不同版本。它没有外部依赖。由于默认捆绑包包含所有 BC 提供程序类，因此如果您想要更紧凑的内容，您可能需要重新打包它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-18T18:24:43.130

您可以使用[jASN1](http://www.openmuc.org/index.php?id=20)。它在 LGPL 下获得许可，应该可以满足您的所有需求。它也非常有效。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-30T12:16:27.907

我需要能够解析 krypt 中任何类型的 ASN.1 数据。虽然 krypt 是一个 Ruby 项目，但您可能想看看[JRuby 扩展](https://github.com/emboss/krypt-core-java)- 处理 ASN.1 解析/编码的代码完全用 Java 编写，并且足够模块化以便于提取。

我还制作了一个[纯 Java 版本](https://github.com/emboss/asn1pull-java)，但它缺少前者的一些高级功能。但既然它很简洁，也许这是一个让你开始的好机会。

两者都没有任何额外的依赖，并且只使用标准的 JDK 功能。

# c# - 将 PDF v1.3 上传到数据库

> ID：813104
> 
> 赞同：1
> 
> 时间：2009-05-01T20:23:14.867
> 
> 标签：c#, asp.net, pdf, mime-types

我有一些 C# 代码会将图像和文件上传到数据库中。目前我认为它适用于所有符合 mimetypes 列表的文档。但是它在某些pdf上失败了。

我已将问题缩小到一些 pdf 是 1.3 格式而一些是 1.4 格式的事实。1.4 可以正常工作并正确上传，但是 1.3 不会上传，也不会生成任何运行时错误，只是无法添加。

当前上传pdf的一些代码是

```
Checks for valid MIME Type
...

byte[] fileData = new byte[uploadFile.ContentLength];
uploadFile.InputStream.Read(fileData, 0, uploadFile.ContentLength);

...
Continues on to Uploads to db. 
```

对于 pdf，它正在寻找“application/pdf”作为 mime 类型。我认为 1.3 格式的 pdf 没有另一种类型，但也许我错了。

以前有没有其他人遇到过这个问题以及如何纠正它的任何建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T20:39:10.727

问题*可能*是您从输入流中读取的方式。

每当你处理流时，你应该反复阅读，注意每次迭代的返回值。所以你的原始代码应该是：

```
byte[] fileData = new byte[uploadFile.ContentLength];
int totalRead = 0;
while (totalRead < fileData.Length)
{
    int read = uploadFile.InputStream.Read(fileData, totalRead,
                                           fileData.Length - totalRead);
    if (read == 0)
    {
        throw new IOException("Input data was truncated");
    }
    totalRead += read;
} 
```

但是，这可能不是问题。我希望这会导致数据被截断，而不是完全没有数据。当您说“只是无法添加”时，您能更具体吗？你投入了多少日志？实际将数据插入数据库的代码在哪里？对于失败的情况，您的日志会显示什么 mime 类型？

在我看来，额外的日志记录可能会在这里产生*巨大*的影响......目前要么你不知道哪里出了问题，要么你只是没有告诉我们。日志记录应该很清楚。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-02T17:44:14.803

我同意 Jon Skeet 对这个问题的回答。不同之处可能是因为 Adob​​e 在 PDF 1.4 中添加了一些新的压缩技术，因此您的 1.4 PDF 可能比 1.3 PDF 小得多。因此，循环读取的需要可能只体现在 v1.3 PDF 中。（但这只是一个猜测）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-02T18:36:24.880

也许它不是pdf的版本。Adobe 不是在 1.4 中引入了线性化 pdf 吗？

使用“快速网络视图”pdf 可以立即获得数据，并且在使用标准 pdf 完成上传之前，数据不可用。如果您尝试在传输完成之前写入数据库，它可能适用于线性化的 pdf 而不是标准的。

不管怎样，Jon Skeet 是对的。记录或正确放置断点会告诉你。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-21T21:44:14.290

看来这只是一个愚蠢的错误。该文件具有 .PDF 扩展名，与其他具有 .pdf 的文件不同。愚蠢的帽子抓住了我。一些额外的调试语句起到了作用。

# python - 我想制作一个录制 MP3 的临时应答电话

> ID：813114
> 
> 赞同：2
> 
> 时间：2009-05-01T20:25:56.547
> 
> 标签：python, voip

一个艺术项目将鼓励用户拨打电话并在自动化服务上留下语音邮件。这些语音邮件将被收集并编辑成一个半小时的广播节目。

我想制作一个**临时**系统（尽可能少的编程），它将：

*   请允许我建立一个公共电话号码（最好在英国）
*   允许公众拨打电话并接收预先录制的简短信息
*   哔哔声后给自己留言。
*   在项目结束时，我希望能够下载录制的音频并将其转换为可以使用免费音频编辑器进行编辑的格式。

如果这意味着我可以少做编程工作，我不介意付费使用服务。此外，它必须是可靠的，因为一旦录制，就不可能重新录制音频剪辑。设置完成后，整个过程最多将运行 2 周。

我是一个 Python 程序员，对 VOIP 有一些基本的了解，但是我不希望设置像 Asterisk 这样的大型复杂系统，因为一旦项目结束，我不打算再次使用该系统。无论我做什么，都必须非常简单和一次性。我还可以访问 Linux 和 FreeBSD 系统（没有 Windows，抱歉）。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-01T20:33:23.207

我用twilio，很简单，很好玩。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-01T20:36:25.833

Skype 有一个[语音邮件](http://skype.com/allfeatures/voicemail/)功能，这听起来很完美，我想你也需要一个SkypeIn[号码](http://skype.com/allfeatures/onlinenumber/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-01T20:29:20.907

您可能需要查看[星号](http://www.asterisk.org/)。我认为这不会比使用现有系统更容易。

也许您可以在星号社区中找到某人来帮助建立这样的系统。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-02T00:09:32.110

看看 Sipgate.co.uk，他们提供免费的英国拨入号码和免费的来电。对你来说不是那么相关，但他们也有一个 python api。

他们是 SIP 提供商，有很多库（例如[http://trac.pjsip.org/repos/wiki/Python_SIP_Tutorial](http://trac.pjsip.org/repos/wiki/Python_SIP_Tutorial)）用于 python 中的 sip - 所以你可以设置一个 python 应用程序来登录你的 sipgate 帐户，拿起和来电并将声音转储到 wav/mp3 中。

# c# - 如何从 C# 以编程方式调用“文档格式”？

> ID：813119
> 
> 赞同：6
> 
> 时间：2009-05-01T20:26:58.557
> 
> 标签：c#, visual-studio, add-in

我正在编写一个简单的 VS 插件，并希望在代码中以编程方式调用“文档格式”选项（在“编辑”下）。谷歌今天对我不太友好......

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-01T20:56:46.690

```
Command cmd = _applicationObject.Commands.Item("Edit.FormatDocument", -1);
object dummy = null;
_applicationObject.Commands.Raise(cmd.Guid, cmd.ID, ref dummy, ref dummy); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-01T21:07:48.037

如果您有对文档（Window 类型）的引用，并且您有对 _DTE 对象的引用，则可以这样调用它：

```
myDocument.Activate();
myDTE.ExecuteCommand("Edit.FormatDocument", string.Empty); 
```

大多数情况下，您可以从传递给加载项的参数中获取对 _DTE 对象的引用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T20:38:02.740

您需要使用标准命令编辑器，通过[VSStd2KCmdId.FORMATDOCUMENT](http://msdn.microsoft.com/en-us/library/microsoft.visualstudio.vsconstants.vsstd2kcmdid(VS.80).aspx)命令枚举调用。

# objective-c - Objective-c：如何将 int 转换为 NSString

> ID：813121
> 
> 赞同：3
> 
> 时间：2009-05-01T20:27:53.093
> 
> 标签：objective-c

我正在使用以下代码来获取字符串中第一个字母的字母数字：

```
toupper([ my_string characterAtIndex: 0 ] ) - 'A' 
```

我需要做一个逆向任务 - 将字母的字母数字转换为 NSString。

最好的方法是什么？

先感谢您。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-01T20:31:13.180

使用[`stringWithFormat:`](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSString_Class/Reference/NSString.html#//apple_ref/occ/clm/NSString/stringWithFormat:)：

```
// 0 ==> @"A", 25 ==> @"Z"
NSString *str = [NSString stringWithFormat:@"%c", theCharIndex + 'A']; 
```

编辑以包括字符串标识符@

# sql - 需要 SQL 查询帮助，将存储过程列表参数与各个列匹配

> ID：813124
> 
> 赞同：1
> 
> 时间：2009-05-01T20:28:14.293
> 
> 标签：sql, tsql, stored-procedures

我有一个存储过程..

```
Proc:
spMyStoredProcedure 
```

接受一个参数：

```
@List varchar(255) 
```

@List 将是一个逗号分隔的值列表，即.. @List = '1,2,3'
*（清晰.. 单个值 1 表示 col1 = true 的所有记录）*

我有一个包含这些列的表：**ID** int、**col1**位、**col2**位、**col3**位、**col4**位。

```
ID | col1 | col2 | col3 | col4
------------------------------
12 |   0  |   1  |   0  |  0
13 |   1  |   0  |   0  |  0
14 |   0  |   0  |   1  |  0
15 |   0  |   0  |   0  |  1 
```

我希望我的结果只包含列表中这些行的 ID。即12、13、14。

我的第一个想法是遍历列表并进行选择。IE。对于第一个值为 1 的值，我在 col1 中获取所有具有 1（真）的记录（导致记录 12）。然后移动到第二个值为 2 并在 col2 中获取所有记录为 1（真）（导致记录 14）等等。我想知道是否有更有效/更好/更清洁的方法来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T20:38:22.630

我认为这可以解决问题：

```
declare @sql as nvarchar(max)

set @sql = 'select * from table where col' + 
           replace(@list, ',', '=1 or col') + '=1'
sp_executesql @sql 
```

这是假设列表不是用户生成的，而是代码生成的，所以我没有防范 SQL 注入攻击。像这样的列表通常不是用户生成的，所以这就是我这样假设的原因。

这是你要找的吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T21:19:43.250

我们使用解析逗号列表并返回表值的 UDF：

```
CREATE FUNCTION [dbo].[ListToTable] (
  @list VARCHAR(MAX),
  @separator VARCHAR(MAX) = ','
)
RETURNS @table TABLE (Value VARCHAR(MAX))
AS BEGIN
   DECLARE @position INT, @previous INT
   SET @list = @list + @separator
   SET @previous = 1
   SET @position = CHARINDEX(@separator, @list)
   WHILE @position > 0 BEGIN
      IF @position - @previous > 0
         INSERT INTO @table VALUES (LTRIM(RTRIM(SUBSTRING(@list, @previous, @position - @previous))))
      IF @position >= LEN(@list) BREAK
      SET @previous = @position + 1
      SET @position = CHARINDEX(@separator, @list, @previous)
   END
   RETURN
END 
```

然后您可以执行以下操作：

```
SELECT *
FROM MyTable m
JOIN dbo.ListToTable(@List) l
  ON m.ID = l.Value 
```

上面的函数还需要一个可选的分隔符，如下所示：

```
SELECT *
FROM MyTable m
JOIN dbo.ListToTable('1:2:3', ':') l
  ON m.ID = l.Value 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T20:54:13.437

** 错误答案，请查看 Eric 的答案以获得更好的回复！

幸运的是，您的列表似乎与 IN 格式匹配：

```
 select * from yourtable where id in (1,2,3,4) 
```

因此，您可以轻松构建动态查询：

```
declare @query varchar(4000)
set @query = 'select * from yourtable where id in (' +
    @list + ')'
 exec sp_executesql @query 
```

请记住，您的客户必须确保 @list 参数是注入干净的。您可以在存储过程中验证它不包含任何单引号。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-01T20:54:29.130

如果您使用的是 Sql Server 2005，您应该能够使用 PIVOT 函数来转置您的数据。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-01T20:55:33.230

考虑以下情况，使用动态 SQL。这可能不是最好的方法，但这是我能想到的不对您的表发出多个选择语句的唯一方法。这假设您已经清理了值列表并且您首先完成了错误检查......

```
CREATE TABLE #tmp
(
    ID INT,
    col1 BIT,
    col2 BIT,
    col3 BIT,
    col4 BIT
)
INSERT INTO #tmp (ID, col1, col2, col3, col4) VALUES (12,0,1,0,0)
INSERT INTO #tmp (ID, col1, col2, col3, col4) VALUES (13,1,0,0,0)
INSERT INTO #tmp (ID, col1, col2, col3, col4) VALUES (14,0,0,1,0)
INSERT INTO #tmp (ID, col1, col2, col3, col4) VALUES (15,0,0,0,1)

DECLARE @List VARCHAR(255)
SELECT @List = '1,2,3'

-- create dynamic sql statement
DECLARE @sql VARCHAR(MAX)
SET @sql = 'SELECT ID FROM #tmp WHERE '

-- append where statement
IF CHARINDEX('1',@List) > 0 BEGIN
    SET @sql = @sql + 'col1 = 1 OR '
END
IF CHARINDEX('2',@List) > 0 BEGIN
    SET @sql = @sql + 'col2 = 1 OR '
END
IF CHARINDEX('3',@List) > 0 BEGIN
    SET @sql = @sql + 'col3 = 1 OR '
END
IF CHARINDEX('4',@List) > 0 BEGIN
    SET @sql = @sql + 'col4 = 1 OR '
END

-- remove the trailing 'OR' and execute
SET @sql = SUBSTRING(@sql,0,LEN(@sql)-2)
EXEC (@sql) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-01T21:02:11.200

通常我使用计算列来存储位列的总数。假设您无法定义计算列，我们可以使用类似的方法

```
SELECT ID FROM SampleTable WHERE (col1*1 + col2*2 + col3*4 + col4*8) IN (1, 2, 3) 
```

由于 1,2,3 都连接在一个变量中，因此我通常使用[http://www.sqlteam.com/article/using-a-csv-with-an-in-sub中定义的用户定义函数-选择](http://www.sqlteam.com/article/using-a-csv-with-an-in-sub-select)。

所以，它会是这样的

```
SELECT ID FROM SampleTable WHERE (col1*1 + col2*2 + col3*4 + col4*8) IN dbo.CSVToInt(@List) 
```

# oracle - 最大值分区名称

> ID：813130
> 
> 赞同：0
> 
> 时间：2009-05-01T20:30:20.153
> 
> 标签：oracle, database-partitioning

在 Oracle 10g 中，我正在创建一个范围分区表。每个分区将是一年。我的问题是 MaxValue 分区的名称是什么？我打算将我的分区称为 P2001、P2002、P2003 ... P2009。欢迎提出建议，我考虑过 P9999、PCurrent、PThisYear、PFuture、PEmpty、PMaxValue 和 PCreateAnotherPartition。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-03T15:56:42.667

我喜欢 P9999 的想法，因为它保持相同的长度。此外，无论您是按 partition_name 还是 partition_id 排序，您都会得到相同的顺序。

有些人更喜欢添加一个前缀来指示表名（长度是一个问题）。假设您的表称为 TABLE1，那么您的分区可以称为 TABLE1_2008、TABLE1_2009、TABLE1_9999 等，因为它使名称对于整个架构是唯一的。

但这只是一个偏好问题。在 Oracle 11g 中，您可以有间隔分区，然后由数据库选择分区的名称，而这些分区不会很漂亮。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T20:59:58.743

我们用过`FY2002_PART, FY2003_PART`，等等。

确实，唯一明显的建议是将它命名为对您和您的团队（以及未来的维护者）有意义的东西......它全部在使用中！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-04T03:48:08.277

我叫我的 P_DEFAULT

# python - Python有属性吗？

> ID：813135
> 
> 赞同：3
> 
> 时间：2009-05-01T20:32:08.107
> 
> 标签：python

所以像：

```
vector3.Length 
```

这实际上是一个计算向量长度的函数调用，而不是变量。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-01T20:34:36.713

使用新型类，您可以使用`property()`： http: [//www.python.org/download/releases/2.2.3/descrintro/#property](http://www.python.org/download/releases/2.2.3/descrintro/#property)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-01T20:34:09.990

是：[http ://docs.python.org/library/functions.html#property](http://docs.python.org/library/functions.html#property)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-01T20:33:38.633

如果您的变量*vector3*是一个点到原点的 3 维有向距离，并且您需要它的长度，请使用类似：

```
import math
vector3 = [5, 6, -7]
print math.sqrt(vector3[0]**2 + vector3[1]**2 + vector3[2]**2) 
```

如果您需要适用于任意数量维度的解决方案，请执行以下操作：

```
import math
vector3 = [5, 6, -7]
print math.sqrt(sum(c ** 2 for c in vector3)) 
```

您可以使用如下属性定义自己的矢量类`Length`：

```
import math
class Vector3(object):
  def __init__(self, x, y, z):
    self.x = x
    self.y = y
    self.z = z
  @property
  def Length(self):
    return math.sqrt(self.x ** 2 + self.y ** 2 + self.z ** 2)
vector3 = Vector3(5, 6, -7)
print vector3.Length 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-01T20:43:33.587

在 property() 装饰器出现之前，习惯用法是使用无参数方法来计算属性。这个习惯用法仍然经常优先使用装饰器，尽管这可能是为了在新样式类之前开始的库中保持一致性。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-03T11:40:58.117

[您可以覆盖一些特殊方法来更改属性的访问方式，请参阅此处](http://docs.python.org/reference/datamodel.html#customizing-attribute-access)或 [此处](http://docs.python.org/reference/datamodel.html#more-attribute-access-for-new-style-classes)的 python 文档

然而，这两者都会减慢对您的类的任何属性访问，因此通常使用属性可能是最好的。

# xul - 如何更改（从 JavaScript）XUL 窗口的标题？

> ID：813145
> 
> 赞同：2
> 
> 时间：2009-05-01T20:35:19.317
> 
> 标签：xul, xulrunner

在 xulrunner 应用程序中，我似乎无法从 JavaScript 设置标题。我试过用这两种方式设置：

```
<?xml version="1.0"?>
<?xml-stylesheet href="chrome://global/skin/" type="text/css"?>
<window id="mywindow" xmlns="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul" onload="go();">

    <!-- your code here -->
<script type="application/x-javascript">
<![CDATA[
    function go(){
        document.getElementById("mywindow").title="blar";
        document.getElementById("mywindow").setAttribute("title","blar");
    }
]]>
</script>
</window> 
```

DOM Inspector 显示 title 属性*确实*得到了更新，但它*没有*显示在屏幕上。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-07-06T09:40:28.977

```
[CDATA[
function entry_onLoad()
{
   document.title = "MyTitle"
}

addEventListener("load", entry_onLoad, false)

]]> 
```

这有效

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T20:57:26.720

页面加载后似乎无法更改窗口。如果有办法，我很想知道它..但这确实有效：

```
<?xml version="1.0"?>
<?xml-stylesheet href="chrome://global/skin/" type="text/css"?>
<window id="mywindow" xmlns="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul" >
    <script type="application/x-javascript">
<![CDATA[
    function go(){
        document.getElementById("mywindow").title="blar";
    }
    go();
]]>
</script>
</window> 
```

# python - Ruby 字符串翻译

> ID：813147
> 
> 赞同：2
> 
> 时间：2009-05-01T20:35:38.723
> 
> 标签：python, ruby, string

我想在我的编码字符串中找到每个元素的后继。例如 K->M A->C 等。

```
string.each_char do |ch| 
    dummy_string<< ch.succ.succ
end 
```

然而，这种方法转换 y->aa。

Ruby 中有没有类似于 Python 中的 maketrans() 的方法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-01T20:43:54.083

您似乎正在寻找[String#tr](http://ruby-doc.org/core/classes/String.html#M000845)。像这样使用：`some_string.tr('a-zA-Z', 'c-zabC-ZAB')`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T20:45:37.530

```
def successor(s)
    s.tr('a-zA-Z','c-zabC-ZAB')
end

successor("Chris Doggett") #"Ejtku Fqiigvv" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T20:44:28.640

我不知道有一个副手，但我认为 Ruby 方式可能涉及将块传递给正则表达式函数。这是一个只适用于大写字母的笨蛋：

```
"ABCYZ".gsub(/\w/) { |a| a=="Z" ? "A" : a.succ }
=> "BCDZA" 
```

编辑：嗯，没关系，听香蒜酱，他听起来很聪明。

# java - Sun 的 Thread.join 方法是否因为使用 Thread 对象同步而损坏？

> ID：813157
> 
> 赞同：1
> 
> 时间：2009-05-01T20:37:30.713
> 
> 标签：java, multithreading, join, timeout

通过运行测试程序和查看源代码，可以清楚地看出 Sun 实现的该方法并不是简单地将时间让给指定线程，而是实际上首先尝试获取线程对象的监视器。具体来说，该方法被实现为“同步的”。

请注意，wait 和 notify 方法也需要监视器，但与 join 不同，调用者有责任在进行调用之前获取监视器，并且文档中明确说明了这一点。Javadocs 中没有记录 join 依赖于监视器的事实，尽管进行推断可能是很自然的。

文档是否足够清晰？

此外，如果线程由于某种原因无法获得监视器，它将挂起，可能永远挂起。在等待监视器时，线程是不可中断的，并且不会按照文档中的描述抛出 InterruptedException。另一方面，不清楚为什么一个线程不能获得监视器，除非是在编程错误的情况下。

担心显示器争用是否合理？

最后，让超时的操作依赖于获取监视器似乎是不合适的，除非可以保证获取监视器的任务本身会超时。

依赖于 join() 的监视器是一个合理的实现吗？甚至有可能以其他方式实现它吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-01T20:42:35.680

`Thread.join`调用`wait`，释放监视器。由于这意味着“加入”线程也不会阻止任何其他线程调用 join，我怀疑这回答了您的大多数其他查询。它不会阻止另一个调用者在线程的监视器上同步（哦，公共监视器的乐趣），但这意味着常见情况可以正常工作。

只是为了证明您的第一点是错误的，这里有一个示例，它创建了 10 个线程，每个线程在主线程上等待 5 秒。（请忽略可怕的异常吞咽和滥用`Date`。它仅用于研究线程行为。）

```
import java.util.*;

public class Test
{
    public static void main(String[] args) throws Exception
    {
        for (int i=0; i < 10; i++)
        {
            new Thread(new ThreadJoiner(Thread.currentThread(), i))
                     .start();
        }
        try
        {
            Thread.sleep(10000);
        }
        catch (InterruptedException e) {}
    }

    private static class ThreadJoiner implements Runnable
    {
        private final Thread threadToJoin;
        int id;

        public ThreadJoiner(Thread threadToJoin, int id)
        {
            this.threadToJoin = threadToJoin;
            this.id = id;
        }

        public void run()
        {
            try
            {
                System.out.println("Thread " + id +
                                   " waiting at " + new Date());
                threadToJoin.join(5000);
                System.out.println("Thread " + id +
                                   " finished waiting at " + new Date());
            }
            catch (InterruptedException e) {}
        }
    }
} 
```

如果你运行它，你会看到所有线程几乎同时开始和结束它们的等待。如果您的担忧是有根据的，您就不会像您那样“交错”结束。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-01T21:22:46.130

> 很明显，Sun 实现的该方法并不简单地将时间让给指定线程，实际上它首先尝试获取线程对象的监视器。

它不会屈服于加入的线程，它只是假设线程将在某个时候运行完成而等待。在线程上使用 join() 并不比任何其他准备运行的线程更有可能运行。

> 1.  如果 N 个线程都尝试加入同一个线程，并且它们都指定了相同的超时 T，那么其中一个线程最终将等待至少 N*T 毫秒。换句话说，每个线程都必须“等待轮到它”来执行它的等待。单独的线程串行而不是并行执行连接是否合理？

线程被设计为同时工作。如果他们都在等待，他们会同时这样做。一个等待的线程不会让另一个线程等待更长的时间。

> .2\. 进入具有非零超时的连接的线程可能永远不会返回。

除非您打算这样做，否则不会。

> 这是因为无法保证监视器永远可用。

您建议的情况只有在线程获得线程锁定然后永远持有它而无需等待时才会发生。这是一个编程错误。恕我直言，您永远不应该直接获得线程对象的锁。

> 如果线程在阻塞 I/O 操作之前获得了自己的监视器，并且该操作挂起，那么任何尝试加入该线程的线程也将挂起。

Java 不能保护您免受您自己的 JVM 中的恶意代码的侵害。

> 具有明确超时的操作无限期挂起是否合理？

如果它被无限期锁定，是的。

> .3\. 为了编写使用该方法的正确程序，调用者必须事先知道目标线程或其他线程是否可以持有监视器。

永远不要锁定线程对象，你没有理由需要这样做，你也不会有这个问题。如果您想开始研究可能使其他开发人员或您自己感到困惑的各种方式，那么 Threads 不是您开始 IMHO 的地方。

> 例如，假设线程 1 正在执行某种处理工作，然后线程 2 以 0 的超时时间加入线程 1，然后线程 3 尝试以 10 毫秒的超时时间加入线程 1，会发生什么情况。0 超时连接意味着线程 2 将一直等到线程 1 退出。但是线程 3 不能开始等待，直到线程 2 释放监视器，

线程 2 在调用 wait 后立即释放监视器。它不能同时等待和持有显示器。

> 因此，线程 3 的 10 毫秒等待有效地被默默地转换为无限期等待，这不是调用者的意图。

不。见以前的评论。

> 不要求调用者知道实现的细节是否违反了封装原则？

它会。

> .4\. 如果线程因为无法获取监视器而被阻塞，则它是不可中断的，并且不会按照文档中的描述抛出 InterruptedException。因此，一个线程不仅可能等待比预期更长的时间，甚至无限期地等待，它可能变得完全没有响应，导致整个程序挂起。可中断操作变得无响应是否合理？

是的。但这是一种非常罕见的情况。如果你使用写的代码，你所指的情况最多只会存在几毫秒。

> 总的来说，让超时的操作依赖于获取监视器似乎是不合适的，除非可以保证获取监视器的任务本身会超时。线程连接是否损坏？

您可以使用更新的 Java 5 并发库执行您的建议。

但是，我建议您不要假设超时保证是毫秒级的。此方法使用的 currentTimeMillis() 在 Windows XP 上仅精确到大约 16 毫秒，等待/睡眠通常比在 Linux 上的小超时时间长 2 毫秒。

恕我直言，如果您需要超过 40 毫秒的精度，您可能会遇到困难，但是如果您解决此问题，您会发现这不一定是问题。

# c# - 如何在不使用 SqlDataSource、ObjectDataSource 等的情况下删除 gridview 和底层数据源中的一行

> ID：813168
> 
> 赞同：1
> 
> 时间：2009-05-01T20:40:25.433
> 
> 标签：c#, asp.net, gridview

我有一个 GridView，我通过调用一个方法来填充它以返回一个包含两列的数据表。返回数据表后，我将其绑定到 gridview 并显示它。

我没有使用 SqlDataSource 或 ObjectDataSource，那么从 gridview 和数据库中的基础数据中删除一行的正确方法是什么。我只需要从一个称为投资组合的表中删除。它有 3 列，ID，即唯一键、PortfolioID 和 PortfolioName。数据表返回 PortfolioName 和 Portfolio 中的项目数。我在想我可以在 Row_Deleting 事件中执行此操作，我会执行以下操作：

```
DELETE * FROM Portfolio WHERE PortfolioID = @PortfolioID 
```

我在正确的轨道上，我将如何做到这一点？我可以将 PortfolioID 绑定到 GridView DataKey 属性（执行此操作的正确语法是什么？）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T21:43:56.967

我假设您在按下按钮时删除了一行。如果是这样，我通常会这样做：

```
<asp:GridView ID="myGrid" runat="server" DataKeyNames='PortfolioID' OnRowCommand="dgStudent_RowCommand">
    <Columns>
        <asp:ButtonField ButtonType="Button" CommandName="Delete" Text="Delete"></asp:ButtonField>
    </Columns>
</asp:GridView> 
```

然后在您的代码隐藏中：

```
protected void myGrid_RowCommand(object sender, GridViewCommandEventArgs e)
{
    // create and open DB connection
    int PortfolioID = (int)myGrid.DataKeys[Convert.ToInt32(e.CommandArgument)].Value;
    DeleteRow(PortfolioID); // your implementation
    myGrid.DataBind(); 
} 
```

`DeleteRow`是您对行删除的实现（可能是您上面的 SQL）。myGrid 是您的网格。`PortfolioID`是主键。这也假定网格中唯一的按钮是删除按钮。如果您有多个按钮，则需要检查`e.CommandName=="Delete"`以确保获得删除按钮。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T20:49:34.680

我可能会比那里更进一步抽象 DB 调用。我可能会在行更改完成后处理这些行。对于后处理，您可以检查行状态以确定如何处理行中的数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T22:21:56.423

据我了解，您想从数据库表中归档的数据网格视图中删除一行。这意味着您要从某个数据库中删除和表记录。最好的方法是在某处放置一个文本框并为您的 datagridview 创建一个事件（在行选择事件上）。这样，当您选择要删除的行时，该行的 id 将被发送到文本框（这将被编码）。获得要删除的行的 ID 后，只需再添加一个按钮即可删除数据库中的记录并再次绑定 datagridview。

```
private void dataGridView1_CellContentClick(object sender, DataGridViewCellEventArgs e)
    {

        this.txt_portfolioId.Text=dataGridView1.CurrentRow.Cells["portfolioID"].Value.ToString();

    }

private void btn_Delete(object sender, EventArgs e)
    {

        //You need to connect to database(regular database connection this connection string and sqlcommand and add this sqlquerry: 
```

从您的表中删除 * 其中投资组合 ID = '"+Convert.ToInt32(this.portfolioId.Text)+"';
}

# asp.net - 计算评论/帖子的数量

> ID：813169
> 
> 赞同：3
> 
> 时间：2009-05-01T20:40:31.923
> 
> 标签：asp.net, sql

我正在使用 ASP.net 和 SQL 数据库。我有一个类似博客的系统，其中针对帖子发表了许多评论，我想在帖子旁边显示这些评论的数量。为了获得这个数字，我可以将它保存在帖子记录中，并在添加或删除评论时添加/子跟踪，或者我可以使用 SQL 来计算每次用户点击页面时使用查询的评论数。后者似乎是一个坏主意，因为它会更严重地打击我的 SQL 数据库，但是将数字与记录保持一致感觉它可能容易出错。在这种情况下，您认为最佳编码实践是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-01T20:43:54.303

始终从规范化数据库开始（您的第二个选项）。仅当出于性能原因绝对需要时才进行非规范化。以非规范化的方式设计它（正如您所猜测的那样容易出错）是过早的优化。使用适当的索引应该可以很好地即时计算数字。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-01T20:42:36.850

我认为SQL语句应该没问题。另一个是你已经拥有的数据的重复。计数查询应该很快。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-01T20:43:56.707

不要过早优化。仅在需要时才在优化中使用简单的解决方案和页面错误。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-01T20:44:09.233

每次您需要信息时，我都会查询数据库。如果您发现性能不足，我稍后会重新审视它（稍后优化）。对于大多数博客类型应用程序将获得的流量，这应该足够了。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-01T20:46:45.390

也许将计数作为主线程查询的一部分返回，以限制来自网络服务器的实际数据库的命中数。但我总是会查询实际计数，而不是尝试将其保存在字段中，因为这是现实，数据最终会不同步。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-07-15T17:24:47.967

为了提高性能，您可以在主表中保留一个标志以指示该项目是否有任何评论，但仅将其用作关于是否执行附加查询以在以后计算和检索评论的“提示”。

想象一个照片库，它返回 50 张照片以供旋转浏览。每张照片都可以有自己的评论。

初始页面加载将返回照片列表以及指示照片是否有评论的标志。

当显示照片时，如果评论标志设置为 True，您的应用程序将发出 ajax 请求来计算并获取该照片的评论。

如果 50 张照片中只有 3 张有评论，那么您只是为自己节省了 47 个额外的请求！

这确实使数据非规范化，但在有限的水平上。创建提示确实有助于提高非常繁忙的站点的性能。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-01T20:44:29.310

根据您的数据模型的外观...不要将总帖子数添加到主线程记录中，这很容易出错，您应该在需要时根据线程 ID 计算评论数，恕我直言

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-01T20:45:23.677

如果您担心针对数据库发生的查询数量，那么缓存页面并在添加/删除评论时更新该缓存将是一个不错的选择，与 SQL 计数查询一起使用。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-02T07:58:36.257

我通常对这类事情使用索引视图。这允许您对数据进行非规范化以便快速检索，但它没有办法不同步。人们也不会感到困惑，认为视图是数据的主人。我主要使用 SS2K5 的标准 sku，所以我必须指定 (noexpand) 提示以使其实际使用视图上的索引（企业会自动执行此操作）。所以对于标准 sku，我总是创建一个每个人都会点击的包装视图，所以我知道提示总是到位。

在网页上编码，所以希望没有语法错误；）

```
create view postCount__
as
select
    threadId
    ,postCount=count_big(*)
from thread
group by threadId
go
create unique clustered index postCount__xpk_threadid on postCount__(threadId)
go
create view postCount
as
select
    threadId
    ,postCount=cast(postCount as int)
from postCount__ with (noexpand)
go 
```

所以我在实际的索引视图上使用了一个命名法，让大家知道不要直接查询它。相反，他们寻找执行 noexpand 提示的关联包装视图。使用索引视图会迫使您执行 count_big，因此我经常在包装视图中将其转换为 int，以便能够使用 32 位 int 懒惰地保持我们的 asp.net 代码。省略演员表会更好，但这对我没有任何重大影响。

编辑 - 我可以告诉你，论坛软件总是将帖子计数非规范化到线程表。如果您有一个活跃的论坛，它会杀死数据库以不断计算每个页面视图上的帖子计数。我喜欢 mssql 具有索引视图，因此您可以以声明方式定义非规范化，而不是自己维护它。

# xml - 解决位置问题 C#中的元素

> ID：813198
> 
> 赞同：0
> 
> 时间：2009-05-01T20:48:07.600
> 
> 标签：xml, validation, import, schema, document

我正在使用 XML 模式文档来验证传入的数据文档，但是该模式在运行时编译期间似乎失败了，因为它引用了外部模式的一部分的复杂类型。外部模式`<xs:import>`在文档顶部的元素中指定。我曾认为这可能是访问问题，所以我将外部文档的副本移动到 localhost 文件夹。`<xs:import>`我得到了同样的错误，所以现在我想知道使用该元素是否可能存在某种问题。

架构文档片段如下所示：

```
<xs:schema targetNamespace="http://www.smpte-ra.org/schemas/429-7/2006/CPL" xmlns:cpl="http://www.smpte-ra.org/schemas/429-7/2006/CPL" xmlns:ds="http://www.w3.org/2000/09/xmldsig#" xmlns:xs="http://www.w3.org/2001/XMLSchema" elementFormDefault="qualified" attributeFormDefault="unqualified">
...  
<xs:import namespace="http://www.w3.org/2000/09/xmldsig#" schemaLocation="http://localhost/TMSWebServices/XMLSchema/xmldsig-core-schema.xsd"/>
...
<xs:element name="Signer" type="ds:KeyInfoType" minOccurs="0"/>
...
</xs:schema> 
```

我试图运行它的代码非常简单（从[http://dotnetslackers.com/Community/blogs/haissam/archive/2008/11/06/validate-xml-against-xsd-xml-schema -使用-c.aspx](http://dotnetslackers.com/Community/blogs/haissam/archive/2008/11/06/validate-xml-against-xsd-xml-schema-using-c.aspx)）

```
string XSDFILEPATH = @"http://localhost/TMSWebServices/XMLSchema/CPL.xsd";
string XMLFILEPATH = @"C:\foo\bar\files\TestCPLs\CPL_930f5e92-be03-440c-a2ff-a13f3f16e1d6.xml";

System.Xml.XmlReaderSettings settings = new System.Xml.XmlReaderSettings();
settings.Schemas.Add(null, XSDFILEPATH);
settings.ValidationType = System.Xml.ValidationType.Schema;

System.Xml.XmlDocument document = new System.Xml.XmlDocument();
document.Load(XMLFILEPATH);

System.Xml.XmlReader rdr = System.Xml.XmlReader.Create(new StringReader(document.InnerXml), settings);
while (rdr.Read()) 
{ 

} 
```

一切顺利，直到在 while 循环之前实例化 XMLReader 对象的行。然后它失败并出现类型未声明的错误。它试图查找的类型 KeyInfoType 是在 import 元素的文档之一中定义的。我已确保命名空间对齐。我想知道命名空间定义中的 # 符号是否引起了问题，但删除它们没有任何效果，它只是改变了错误的样子（即“Type ' [http://www.w3.org/2000/09/xmldsig :KeyInfoType](http://www.w3.org/2000/09/xmldsig:KeyInfoType) ' 未声明。”与“Type ' [http://www.w3.org/2000/09/xmldsig#:KeyInfoType](http://www.w3.org/2000/09/xmldsig#:KeyInfoType) ' 未声明。”）

我怀疑`<xs:import>`我缺少的元素的处理有些问题。任何建议都非常受欢迎。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-08T17:42:21.770

好吧，这有点令人费解。我尝试了几种不同的方法，包括添加该行：

```
settings.ValidationFlags |= System.Xml.Schema.XmlSchemaValidationFlags.ProcessSchemaLocation; 
```

我不断收到同样的错误：

```
Type 'http://www.w3.org/2000/09/xmldsig#:KeyInfoType' is not declared. 
```

该命名空间指定的文档是：

```
http://localhost/TMSWebServices/XMLSchema/xmldsig-core-schema.xsd 
```

可以从我所在的位置访问该文档，并且可以在第 152 行找到（看似）有问题的 KeyInfoType 类型。

只是为了好玩，我检查了正在验证的文档，发现在这种类型的架构中定义的元素不在文档中。架构将其定义为可选（minOccurs="0"），所以这不是问题。

当该文档导入外部模式文档时，就好像框架编译 schmea 文档的能力有些奇怪。有没有人见过这种行为？谷歌在这个问题上并没有被证明是富有成效的，尽管它确实给了我很多尝试的建议。谢谢！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T20:56:28.593

我认为您只需要添加一行代码即可使其工作：

```
settings.ValidationFlags =  
      System.Xml.Schema.XmlSchemaValidationFlags.ProcessSchemaLocation; 
```

马克

# java - Can I set the classloader policy for WebSphere in the ibm-web-bnd.xmi file?

> ID：813202
> 
> 赞同：12
> 
> 时间：2009-05-01T20:48:53.167
> 
> 标签：java, websphere, classloader

I have a JEE application that runs on WAS 6\. It needs to have the class loader order setting to "Classes loaded with application class loader first", and the WAR class loader policy option set to "Single class loader for application".

Is it possible to specify these options inside the EAR file, whether in the ibm-web-bnd.xmi file or some other file, so the admin doesn't need to change these setting manually?

Since the app is deployed via an automated script, and the guy who is in charge of deployment is off site, and also for some other political reasons, this would greatly help!

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-04T17:32:02.227

Thanks to @Matthew Murdoch's answer, I was able to come up with a solution. Here it is, in case it helps someone else.

I created a deployment.xml like this:

```
<?xml version="1.0" encoding="UTF-8"?>
<appdeployment:Deployment xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:appdeployment="http://www.ibm.com/websphere/appserver/schemas/5.0/appdeployment.xmi" xmi:id="Deployment_1241112964096">
  <deployedObject xmi:type="appdeployment:ApplicationDeployment" xmi:id="ApplicationDeployment_1241112964096" startingWeight="1" warClassLoaderPolicy="SINGLE">
    <classloader xmi:id="Classloader_1241112964096" mode="PARENT_LAST"/>
    <modules xmi:type="appdeployment:WebModuleDeployment" xmi:id="WebModuleDeployment_1241112964096" startingWeight="10000" uri="AGS.war">
      <classloader xmi:id="Classloader_1241112964097"/>
    </modules>
  </deployedObject>
</appdeployment:Deployment> 
```

Make sure to change the name of your WAR file(s) to match (mine is called AGS.war).

I also changed the numbers in the `xmi:id` attributes, to be sure they are unique, though I'm not sure it it really matters that they be unique across applications.

Then, I put the deployment.xml file in the root of my EAR file, via ANT:

```
 <ear destfile="${artifactsDir}/${earName}.ear" appxml="${projectName}_EAR/application.xml">
        <fileset dir="${artifactsDir}" includes="${warName}.war"/>
        <fileset dir="${projectName}_EAR/" includes="deployment.xml"/>
    </ear> 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-01T21:13:27.663

**Edit (2):** The [WebSphere Application Server Toolkit (AST)](http://publib.boulder.ibm.com/infocenter/wasinfo/v6r1/index.jsp?topic=/com.ibm.websphere.express.doc/info/exp/ae/tins_ast_roadmap.html) is a tool you can use to enhance an EAR file with this information (see for example the 'Configure an Enhanced EAR' section in [this document](http://media.techtarget.com/digitalguide/images/Misc/wapp.pdf)).

**Edit (1):** [This post](http://www.ibm.com/developerworks/forums/thread.jspa?threadID=201067) suggests that the 'Classes loaded with application class loader first' (the PARENT_LAST setting) can be set in the deployment.xml file within the EAR.

If you have control over the automated deployment scripts this can be done. Below is some wsadmin jython code for setting the web module class loader order to 'Classes loaded with application class loader first' (interestingly the setting is called PARENT_LAST which is what it was labelled in previous versions of the admin console...).

wsadmin example (jython):

```
def getWebModule(config, applicationName):
    webModules = config.list('WebModuleDeployment').
         split(system.getProperty('line.separator'))
    for webModule in webModules:
        if (webModule.find(applicationName) != -1):
            return webModule
    return None

applicationName = "<Your application name here>"

webModule = getWebModule(AdminConfig, applicationName)
if (webModule != None):
    AdminConfig.modify(webModule, "[[classloaderMode PARENT_LAST]]")
    AdminConfig.save()
else:
    print "Error: Cannot find web module for application: " + applicationName 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T15:31:41.980

Check out this link. There are different ways to set class loader policy using Jython based on your server version - [http://pic.dhe.ibm.com/infocenter/wasinfo/v7r0/index.jsp?topic=%2Fcom.ibm.websphere.express.doc%2Finfo%2Fexp%2Fae%2Frxml_7libapp4.html](http://pic.dhe.ibm.com/infocenter/wasinfo/v7r0/index.jsp?topic=%2Fcom.ibm.websphere.express.doc%2Finfo%2Fexp%2Fae%2Frxml_7libapp4.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-10-02T17:51:01.907

Similar to the answer from pkaeding, I discovered as follows, not specific to a particular .war by name, but useful when applying to whatever is the default .war in the .ear file. (.ear files with one .war file in them have only that .war, so naming the .war isn't necessary in the entry.) This approach may be good for situations where you may need to re-name of the .war project later for some reason, and so you wouldn't need to worry about updating the `deployment.xml` file. I found the `deployment.xml` file buried inside a cell reference directory trail; dunno if it's fine as shown when the file is placed at directory level `META-INF` and no deeper.

In my particular case, I found `deployment.xml` in my .ear project at:

*<project_root>*\META-INF\ibmconfig\cells\defaultCell\applications\defaultApp\deployments\defaultApp\

The content of the file looks a lot like:

```
<appdeployment:Deployment xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI"
     xmlns:appdeployment="http://www.ibm.com/websphere/appserver/schemas/5.0/appdeployment.xmi" xmi:id="Deployment_1262775196208">
  <deployedObject xmi:type="appdeployment:ApplicationDeployment"
    xmi:id="ApplicationDeployment_1262775196208" startingWeight="10">
      <classloader xmi:id="Classloader_1262775196208" mode="PARENT_LAST" />
  </deployedObject>
</appdeployment:Deployment> 
```

The line:

```
<classloader xmi:id="Classloader_1262775196208" mode="PARENT_LAST" /> 
```

originally read:

```
<classloader xmi:id="Classloader_1262775196208" mode="PARENT_FIRST" /> 
```

Note no reference to any .war is being made. As pkaeding mentioned, you shouldn't expect the various id numbers to be the same for you.

# ccr - 在 64 位 Windows 上设置 MS Robotics Studio

> ID：813204
> 
> 赞同：1
> 
> 时间：2009-05-01T20:49:26.910
> 
> 标签：ccr, robotics-studio, dss

在 64 位 Windows Vista 上设置 Microsoft Robotics Studio 2.0 的最佳方法是什么？显然，除了默认安装之外，还需要做一些事情才能使其正常运行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T06:29:26.050

根据 MRDS 要求，Windows 7 是运行 MRDS 的最佳操作系统。如果您使用 Vista，则很可能会发现很难运行 RDS。[在这里](http://www.microsoft.com/robotics/#GetStartedStep1)和[这里](http://www.intorobotics.com/lets-start-with-microsoft-robotics-developer-studio-installation-and-components/)阅读更多

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-10-11T18:45:56.330

Microsoft 已发布 Microsoft Robotics Developer Studio 2008 R3，其中包括开箱即用的 64 位支持，无需特殊安装。它还支持 Visual Studio 2010。

# .net - 在 .NET 中提交表单

> ID：813207
> 
> 赞同：1
> 
> 时间：2009-05-01T20:49:58.750
> 
> 标签：.net, javascript, jquery

我有一个带有提交按钮的 .NET 页面。我正在使用客户端验证来验证表单元素。

```
var register = $('#<%= Register.ClientId %>');
register.click(function(){
    validation.init();
    return false;
}); 
```

现在，顶部的 return false 会阻止表单在单击时提交到服务器。在任何其他语言中，一旦我进行了验证，我就会调用**表单提交方法**，并且它会起作用。不知何故，这似乎不适用于.NET。我不确定这是否是因为表单标签本身包裹了整个页面内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T20:52:54.127

你应该使用 ASP.NET CustomValidator 来做这个钩子，这将被连接到 form.submit 上自动运行。

过时的旧 VB 教程，但您可以了解它的要点：[http ://www.4guysfromrolla.com/articles/073102-1.aspx](http://www.4guysfromrolla.com/articles/073102-1.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T21:11:57.887

`form.submit()`与 ASP.NET 一起工作正常 - 你还有其他问题。发布更多代码，我们将看看它是什么......

```
<script runat="server">
    protected override void OnLoad(EventArgs e) {
        base.OnLoad(e);
        if (IsPostBack) {
            ClientScript.RegisterStartupScript(this.GetType(), "alert", "alert('PostBack!');", true);
        }      
    }
</script>

<body>
    <script type="text/javascript">
        function OnClick() {
            window.setTimeout(function() { form1.submit(); }, 5000);
            return false;
        }
    </script>
    <form id="form1" runat="server">
        <input type="submit" onclick="return OnClick();" />      
    </form>
</body> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T21:17:24.240

我一直在做这种事情。特别是如果我有一些复杂的验证，我不想搞砸验证器控件。document.forms[0].submit();

这对我来说每次都有效。这不适合你吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-01T21:05:07.903

不要总是返回 false，而是执行验证，然后根据结果返回 true 或 false。

# javascript - 我真的需要单身人士吗？

> ID：813215
> 
> 赞同：2
> 
> 时间：2009-05-01T20:50:52.507
> 
> 标签：javascript, design-patterns, singleton, firefox-addon

我正在开发一个 Firefox 扩展，我希望让多个窗口与相同的信息保持同步。工具栏根据窗口打开的时间定期查询远程服务器的信息。因为 Firefox 窗口都是独立的独立环境，每个都有自己的工具栏运行单独的代码，我想我会在这里使用单例。确实不需要多个请求，每个窗口都可以有一个请求，但问题是没有全局主范围在多个窗口上下文中支配它，只有窗口上下文。我想我会创建一个工厂类来检查其中一个窗口是否已经运行了我的通知类的实例，如果是，则使用相同的实例来获取更新。

这似乎是对单身人士的合法使用，但我一直在阅读他们如何成为邪恶的野兽。这可以用吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-01T20:56:33.850

单例本身并没有本质上的错误。问题在于如何（ab）使用它：它本质上是一种拥有全局变量的奇特方式。单例只是让您拥有一个自包含大部分数据的间接级别。但有时，这种模式是解决某些问题的唯一方法。在这种情况下，它完全没问题。但是，如果您能想到另一种可能只使用更多代码/内存/性能影响来完成的方法，那么如果可以的话，我会采用这种方法。否则，使用单例真的没有什么问题，只要你知道你正在进入什么。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-01T20:57:34.317

单身人士本身并不邪恶。这是他们的滥用......（您通常可以使用 DI 容器来让您的实例“单调”，这使得这种模式不太推荐）。

我在你描述的领域没有任何经验。然而，单身在我看来是合理的选择。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-01T21:05:31.803

问题在于，就 JavaScript 而言，每个 Firefox 窗口都是一个完全独立的进程。

所以是的，它会起作用，但前提是你有条件地创建单例。如果它只是在全局范围内无条件地创建（在我的情况下，作为我的顶级扩展对象的成员），它将在所有窗口中。

您将遇到的另一个问题是 windows 需要一段时间来启动和运行 JavaScript，而且您没有任何类似同步的东西。完全有可能窗口 1 检查窗口 2 是否创建了单例，看到它没有，窗口 2 检查窗口 1，看到它没有，然后都创建自己的单例。

我根据经验说话：我编写了一个 Firefox 扩展程序，它的功能非常类似于您想要做的事情：只有一个窗口应该检查远程服务器（当任何窗口关闭时都需要通知所有其他窗口）。

（在我的系统中，启动时的每个窗口都会查询所有其他窗口以找到“主”窗口。）

解决这个问题的更简洁的方法是创建一个服务，就像浏览器向 javascript 公开的服务一样；但这需要用 C 而不是 javascript 编码，并且使得跨平台安装扩展更加痛苦。

# c++ - 如何在 C++ 中使用 libbz2 压缩目录

> ID：813223
> 
> 赞同：10
> 
> 时间：2009-05-01T20:52:36.543
> 
> 标签：c++, compression, tar, bzip2

我需要创建一个目录的 tarball，然后在 C++ 中使用 bz2 对其进行压缩。有没有关于使用 libtar 和 libbz2 的不错的教程？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-01T22:33:35.397

好的，我为您准备了一个简单的示例。没有错误检查和各种任意决定，但它有效。libbzip2 有相当[好的网络文档](http://sourceware.org/bzip2/1.0.5/bzip2-manual-1.0.5.html)。libtar，不多，但包中有手册页，一个示例和一个文档化的头文件。可以使用以下内容构建`g++ C++TarBz2.cpp -ltar -lbz2 -o C++TarBz2.exe`：

```
#include <sys/types.h>
#include <sys/stat.h>
#include <fcntl.h>
#include <stdlib.h>
#include <libtar.h>
#include <bzlib.h>
#include <unistd.h>

int main()
{
    TAR *pTar;
    char tarFilename[] = "file.tar";
    char srcDir[] = "dirToZip/";
    char extractTo[] = ".";

    tar_open(&pTar, tarFilename, NULL, O_WRONLY | O_CREAT, 0644, TAR_GNU);
    tar_append_tree(pTar, srcDir, extractTo);

    close(tar_fd(pTar));

    int tarFD = open(tarFilename, O_RDONLY);

    char tbz2Filename[] =  "file.tar.bz2";
    FILE *tbz2File = fopen(tbz2Filename, "wb");
    int bzError;
    const int BLOCK_MULTIPLIER = 7;
    BZFILE *pBz = BZ2_bzWriteOpen(&bzError, tbz2File, BLOCK_MULTIPLIER, 0, 0);

    const int BUF_SIZE = 10000;
    char* buf = new char[BUF_SIZE];
    ssize_t bytesRead;
    while((bytesRead = read(tarFD, buf, BUF_SIZE)) > 0) {
        BZ2_bzWrite(&bzError, pBz, buf, bytesRead);
    }        
    BZ2_bzWriteClose(&bzError, pBz, 0, NULL, NULL);
    close(tarFD);
    remove(tarFilename);

    delete[] buf;

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T22:06:45.447

假设这不仅仅是一个“我该怎么做”的问题，那么显而易见的方法是 fork/exec GNU tar 为你做这件事。最简单的方法是使用*system(3)*库例程：

```
 system("/path/to/gtar cfj tarballname.tar.bz2 dirname"); 
```

据此，libtar [disty](https://lists.feep.net:8080/pipermail/libtar/2003-July/000156.html)中有示例程序。

Bzip 的文档包括关于[使用 libbz2 进行编程](http://www.bzip.org/1.0.5/bzip2-manual-1.0.5.html#libprog)的部分。

# sql - TSQL 日期时间 ISO 8601

> ID：813238
> 
> 赞同：71
> 
> 时间：2009-05-01T20:55:33.887
> 
> 标签：sql, sql-server, tsql, datetime

我得到了一个需要`ISO 8601`日期格式的规范，有没有人知道转换代码或获取这两个示例的方法：

```
ISO 8601 Extended Date 2000-01-14T13:42Z 
ISO 8601 Basic Date 20090123T105321Z 
```

* * *

## 回答 #1

> 赞同：107
> 
> 时间：2009-05-01T21:00:47.010

在 SQL Server 中处理日期时，ISO-8601 格式可能是最好的方法，因为无论您的语言和文化设置如何，它都能正常工作。

为了将数据插入到 SQL Server 表中，您不需要任何转换代码或任何东西 - 只需将日期指定为文字字符串

```
INSERT INTO MyTable(DateColumn) VALUES('20090430 12:34:56.790') 
```

你就完成了。

如果您需要在 SELECT 上将日期列转换为 ISO-8601 格式，您可以使用转换代码 126 或 127（带有时区信息）来实现 ISO 格式。

```
SELECT CONVERT(VARCHAR(33), DateColumn, 126) FROM MyTable 
```

应该给你：

```
2009-04-30T12:34:56.790 
```

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-05-01T21:21:01.593

这

```
SELECT CONVERT(NVARCHAR(30), GETDATE(), 126) 
```

会产生这个

```
2009-05-01T14:18:12.430 
```

可以在[MSDN](http://msdn.microsoft.com/en-us/library/ms187928(SQL.90).aspx)上找到有关此的更多详细信息。

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2016-02-18T21:42:14.933

如果您只需要以 ISO8601 格式（包括尾随 Z）输出日期，并且您至少在 SQL Server 2012 上，那么您可以使用`FORMAT`：

```
SELECT FORMAT(GetUtcDate(),'yyyy-MM-ddTHH:mm:ssZ') 
```

这会给你类似的东西：

```
2016-02-18T21:34:14Z 
```

正如@Pxtl 在评论中指出的那样，FORMAT 可能会影响性能，与它带来的任何灵活性相比，必须考虑成本。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-04-16T00:17:33.350

天哪，不！如果您在 SQL Server 中存储格式化的日期，您将面临一个痛苦的世界。始终存储您的日期和时间以及 SQL Server“日期/时间”数据类型之一（DATETIME、DATE、TIME、DATETIME2 等）。让前端代码解析显示方法，并且仅在您构建临时表以从中构建文件时存储格式化的日期。如果您绝对必须从 SQL Server 显示 ISO 日期/时间格式，请仅在显示时执行。我怎么强调都不为过……不要在 SQL Server 中存储格式化的日期/时间。

{编辑}。造成这种情况的原因有很多，但最明显的是，即使使用良好的 ISO 格式（可排序），所有未来的日期计算和搜索（例如，搜索给定月份中的所有行）至少需要一个隐式转换（这需要额外的时间），如果存储的格式化日期不是您当前需要的格式，您需要先将其转换为日期，然后再转换为您想要的格式。

前端代码也是如此。如果您存储格式化的日期（即文本），它需要相同的旋转来显示由 windows 或应用程序定义的本地日期格式。

我的建议是始终将日期/时间存储为 DATETIME 或其他时间数据类型，并且仅在显示时间格式化日期。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-03-21T13:40:48.127

在谈到 ISO 日期时，从技术上讲，您有两种选择。

通常，如果您仅针对**Date**值进行专门过滤，或者希望以中性方式保留日期。Microsoft 建议使用`ymd`or的语言中性格式`y-m-d`。这两种都是有效的 ISO 格式。

> 请注意，“2007-02-12”形式仅对数据类型 DATE、DATETIME2 和 DATETIMEOFFSET 被视为与语言无关。

因此，您最安全的选择是基于**始终** `ymd`网络格式进行持久化/过滤。

编码：

```
select convert(char(10), getdate(), 126) -- ISO YYYY-MM-DD
select convert(char(8), getdate(), 112) -- ISO YYYYMMDD (safest) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-07-01T09:51:17.890

对于日期时间和日期时间 2 的 ISO 8601 格式，以下是 SQL Server 的建议。它不支持日期时间（yyyyMMddThhmmss）的基本 ISO 8601 格式。

### 约会时间

> YYYY-MM-DDThh:mm:ss[.mmm]
> 
> YYYYMMDD[hh:mm:ss[.mmm]]
> 
> 例子：
> 
> 1.  2004-05-23T14:25:10
>     
>     
> 2.  2004-05-23T14:25:10.487

### 日期时间2

> YYYY-MM-DDThh:mm:ss[.nnnnnn]
> 
> YYYY-MM-DDThh:mm:ss[.nnnnnnn] 示例：
> 
> 1.  2004-05-23T14:25:10
>     
>     
> 2.  2004-05-23T14:25:10.8849926

您可以使用 126 选项转换它们

```
--Datetime

DECLARE @table Table(ExtendedDate DATETIME, BasicDate Datetime)

DECLARE @ExtendedDate VARCHAR(30) = '2020-07-01T08:39:17' , @BasicDate VARCHAR(30) = '2009-01-23T10:53:21.000'

INSERT INTO @table(ExtendedDate, BasicDate)
SELECT convert(datetime,@ExtendedDate,126) ,convert(datetime,@BasicDate,126)

SELECT * FROM @table
go

-- Datetime2

DECLARE @table Table(ExtendedDate DATETIME2, BasicDate Datetime2)

DECLARE @ExtendedDate VARCHAR(30) = '2000-01-14T13:42:00.0000000' , @BasicDate VARCHAR(30) = '2009-01-23T10:53:21.0000000'

INSERT INTO @table(ExtendedDate, BasicDate)
SELECT convert(datetime2,@ExtendedDate,126) ,convert(datetime2,@BasicDate,126)

SELECT * FROM @table
go 
```

**约会时间**

```
+-------------------------+-------------------------+
|      ExtendedDate       |        BasicDate        |
+-------------------------+-------------------------+
| 2020-07-01 08:39:17.000 | 2009-01-23 10:53:21.000 |
+-------------------------+-------------------------+ 
```

**日期时间2**

```
 +-----------------------------+-----------------------------+
|        ExtendedDate         |          BasicDate          |
+-----------------------------+-----------------------------+
| 2000-01-14 13:42:00.0000000 | 2009-01-23 10:53:21.0000000 |
+-----------------------------+-----------------------------+ 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-11-13T10:05:18.540

这是一个非常古老的问题，但是自从我在搜索时来到这里，值得提出我的答案。

```
SELECT DATEPART(ISO_WEEK,'2020-11-13') AS ISO_8601_WeekNr 
```

# sql - 单个属性上的 NHibernate 更新会更新 sql 中的所有属性

> ID：813240
> 
> 赞同：13
> 
> 时间：2009-05-01T20:55:59.610
> 
> 标签：sql, nhibernate, sql-update

我正在 NHibernate 中对单个属性执行标准更新。然而，在事务提交时，sql 更新似乎设置了我在表上映射的所有字段，即使它们没有改变。这肯定不是 Nhibernate 中的正常行为吗？难道我做错了什么？谢谢

```
using (var session = sessionFactory.OpenSession())
           {
               using (var transaction = session.BeginTransaction())
               {
                   var singleMeeting = session.Load<Meeting>(10193);
                   singleMeeting.Subject = "This is a test 2";

                   transaction.Commit();
               }
           } 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-01T21:09:30.887

这是正常行为。您可以尝试添加`dynamic-update="true"`到您的类定义以覆盖此行为。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-01T21:03:16.613

好。是的，这是 NHibernate 的正常行为。您可以为您的属性使用生成的属性来更改行为。[Ayende 博客](http://ayende.com/Blog/archive/2009/04/07/nhibernate-mapping-ltpropertygt.aspx)上的详细信息。

为什么这个默认值是因为动态你没有缓存你的查询计划。而且通常您不介意通过应用程序服务器和数据库之间的高速网络连接发送更多字节。除非您在此设置非常合适的地方保存长字符串。

# sql-server - SQL Server 备份的动态文件名？

> ID：813248
> 
> 赞同：3
> 
> 时间：2009-05-01T20:56:47.347
> 
> 标签：sql-server, tsql, backup, variables, filenames

如何在 T-SQL 备份脚本中使用的文件名（动态文件名）中插入日期？使用 SQL 企业管理器创建和计划备份作业，我想编辑创建的 T-SQL 以将备份数据库的文件名更改为 dbname_date.bak（即 northwind_5-1-2009.bak）。下次运行备份时，它将是northwinds_new_date.bak。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-01T21:22:26.940

基本上，您要做的是声明一个字符串变量，将其设置为名称，然后将日期附加到变量的末尾。然后只需使用备份名称所在的变量

```
declare @backupname nvarchar(100)
set @backupname = 'northwind_' + getdate() + '.bak' 
```

类似的东西应该工作。您可能必须将 getdate() 放在 nvarchar 上。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-01T21:03:25.833

这是你真正想知道的——不要重新发明轮子。这是一个很棒的脚本，可以自动执行您所描述的备份：

[https://ola.hallengren.com/](https://ola.hallengren.com/)

# resize - SWT 画布位置

> ID：813253
> 
> 赞同：1
> 
> 时间：2009-05-01T20:57:57.607
> 
> 标签：resize, canvas, swt

我正在使用最新的稳定版本的 SWT。

我有一个包含 ToolBar、ScrolledComposite 和 Canvas 的 Shell。Canvas 被设置为 ScrolledComposite 的内容（例如 scrolledComposite.setContent(canvas)）。画布以永远不变的特定尺寸创建（例如，400 x 400）。而 ScrolledComposite 不断增长或缩小以填充可用的父 shell 的客户区域。

我有一个附加到父 Shell 的调整大小侦听器，它尝试执行以下操作：a）如上所述增长 ScrolledComposite 和 b）在 ScrolledComposite 中水平和垂直居中画布（参见下面的示例代码）。

这与在 Mac OS X 上的工作方式完全相同，但是在 Windows 上会触发 resize 事件并正确计算新位置，但最终 Canvas 会恢复为 0,0。另一个小信息是，如果您不断调整窗口大小，您会看到画布闪烁，并且看起来好像是在正确的位置短暂绘制。

```
_shell.addListener (SWT.Resize, new Listener () {
    public void handleEvent (Event e)
    {
        int toolBarOffset = _toolBar.getSize().y;

        Rectangle clientArea = _shell.getClientArea();

        _scrollComposite.setBounds(0, toolBarOffset, clientArea.width, clientArea.height - toolBarOffset);

        Point canvasSize = _canvas.getSize();

        int canvasX = Math.max(0, (clientArea.width / 2) - (canvasSize.x / 2));
        int canvasY = Math.max(0, ((clientArea.height - toolBarOffset) / 2) - (canvasSize.y / 2));

        _canvas.setLocation(canvasX, canvasY);
    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-25T22:18:47.980

不确定您是否已经弄清楚了，但问题是 ScrolledComposite 在调整大小时总是将内容设置为 0/0。我不确定为什么您的方法适用于 OS X，而且我没有测试我的示例，因为我这里没有 Mac。

解决方案是使用填充组合，它始终至少与 ScrolledComposite 的客户区一样大。在那个填充物中，您可以正确地将 Canvas 居中。

我做了一个小例子，作为额外的好处，如果 SC 的客户区域小于画布，它也会使画布居中（因为我首先认为这是你的问题 :)）

你可能需要做一些小的调整，我猜 OS X 上的代码有一些小故障......

```
package test;

import org.eclipse.swt.SWT;
import org.eclipse.swt.custom.ScrolledComposite;
import org.eclipse.swt.events.ControlAdapter;
import org.eclipse.swt.events.ControlEvent;
import org.eclipse.swt.events.PaintEvent;
import org.eclipse.swt.events.PaintListener;
import org.eclipse.swt.graphics.Point;
import org.eclipse.swt.graphics.Rectangle;
import org.eclipse.swt.layout.FillLayout;
import org.eclipse.swt.widgets.Canvas;
import org.eclipse.swt.widgets.Composite;

import org.eclipse.swt.widgets.Display;
import org.eclipse.swt.widgets.Shell;

public class Test {

    public static void main(final String[] args) {
        final Display display = new Display();
        final Shell shell = new Shell(display);

        shell.setLayout( new FillLayout() );

        final ScrolledComposite sComp = new ScrolledComposite( shell, SWT.H_SCROLL | SWT.V_SCROLL );
        final Composite fillComp = new Composite( sComp, SWT.NONE );

        sComp.setLayout( new FillLayout() );

        final Canvas c = new Canvas( fillComp, SWT.DOUBLE_BUFFERED );
        c.addPaintListener( new PaintListener() {
            public void paintControl(PaintEvent e) {
                Point p = c.getSize();
                e.gc.setBackground( display.getSystemColor( SWT.COLOR_RED ));
                e.gc.fillRectangle( 0, 0, p.x, p.y );

                e.gc.setBackground( display.getSystemColor( SWT.COLOR_BLUE ));
                e.gc.fillRectangle( p.x / 2 - 10, p.y / 2 - 10, 20, 20 );
            }
        });

        c.setSize( 400, 400 );
        sComp.setContent( fillComp );

        sComp.addControlListener( new ControlAdapter() {
            @Override
            public void controlResized(ControlEvent e) {
                Rectangle clientArea = sComp.getClientArea();

                Point cSize = c.getSize();
                int fillX = Math.max( clientArea.width, cSize.x );
                int fillY = Math.max( clientArea.height, cSize.y );
                fillComp.setSize( fillX, fillY );

                int cX = ( clientArea.width - cSize.x ) / 2;
                int cY = ( clientArea.height - cSize.y ) / 2;

                sComp.setOrigin( -cX, -cY );

                int locX = Math.max( cX, 0 );
                int locY = Math.max( cY, 0 );
                c.setLocation( locX, locY );
            }
        });

        shell.open();
        shell.pack();
        while (!shell.isDisposed()) {
            if (!display.readAndDispatch()) {
                display.sleep();
            }
        }   
    }
} 
```

# asp.net - 将描述文本添加到我的单选按钮列表中的每个单选按钮

> ID：813254
> 
> 赞同：0
> 
> 时间：2009-05-01T20:58:39.090
> 
> 标签：asp.net, radiobuttonlist

尝试在单选按钮列表中向单选按钮添加一些描述性文本。

由于某种原因，该列太窄了，以至于单选按钮向下延伸很长。

有没有办法可以格式化这个看起来不错？

我应该将文本添加到 radiobutton.text 还是其他地方？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-01T21:35:41.260

你试过设置`RepeatLayout="Flow"`吗？

# linq-to-sql - 已编译的查询和“参数不能是序列”

> ID：813256
> 
> 赞同：7
> 
> 时间：2009-05-01T20:59:05.233
> 
> 标签：linq-to-sql, contains, linq.compiledquery

我认为编译后的查询将执行与 DataContext 相同的查询翻译。然而，当我尝试使用带有 .Contains 方法调用的查询时，我遇到了运行时错误。我哪里出错了？

```
//private member which holds a compiled query.
Func<DataAccess.DataClasses1DataContext, List<int>, List<DataAccess.TestRecord>>
  compiledFiftyRecordQuery = System.Data.Linq.CompiledQuery.Compile
  <DataAccess.DataClasses1DataContext, List<int>, List<DataAccess.TestRecord>>
  ((dc, ids) => dc.TestRecords.Where(tr => ids.Contains(tr.ID)).ToList());

//this method calls the compiled query.
public void FiftyRecordCompiledQueryByID()
{
  List<int> IDs = GetRandomInts(50);

  //System.NotSupportedException
  //{"Parameters cannot be sequences."}

  List<DataAccess.TestRecord> results = compiledFiftyRecordQuery
    (myContext, IDs);         
} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-02T00:32:27.030

[这篇文章](http://social.msdn.microsoft.com/forums/en-US/linqtosql/thread/08ccbb12-da4f-421a-8912-8fa95ebbead0/)有你的答案：

> 无法预编译带有列表参数的查询，因为查询的翻译取决于列表中的项目数。

# sql - SQL删除循环

> ID：813257
> 
> 赞同：2
> 
> 时间：2009-05-01T20:59:19.867
> 
> 标签：sql, loops, count

我有一张房屋清单。我想每个城市最多保留 10 个列表。（大多数城市的房源少于 10 个）。

当我执行此查询时：

```
 select city, count(city) as cityCount from tREaltyTrac group by city 
```

SQL 返回：

```
Acampo  1
Acton   1
Adelanto    20
Agua Dulce  1
Aguanga 1
Akron   19
Albany  12
Albion  3
Alexandria  14
Algonac 1
Alhambra    5 
```

因此，必须将 Adelanto、Akron、Albany 和 Alexandria 减少到只有 10 个按最近日期时间字段“creation”（按创建顺序排序）排序的列表。

任何人都可以想出一个程序来减少所描述的列表吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-01T21:39:45.480

**DON'T LOOP!**

I prefer marking th rows with a status, but this will do as you want and delete them...

try this (sql server)

set up table

```
create table tREaltyTrac (city varchar(20),creation datetime)
insert into tREaltyTrac values ('Acampo'      ,getdate()) --1
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Acton'       ,getdate()) --1
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Adelanto'    ,getdate()) --20
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Adelanto'    ,getdate()) --20
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Adelanto'    ,getdate()) --20
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Adelanto'    ,getdate()) --20
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Adelanto'    ,getdate()) --20
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Adelanto'    ,getdate()) --20
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Adelanto'    ,getdate()) --20
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Adelanto'    ,getdate()) --20
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Adelanto'    ,getdate()) --20
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Adelanto'    ,getdate()) --20
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Adelanto'    ,getdate()) --20
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Adelanto'    ,getdate()) --20
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Adelanto'    ,getdate()) --20
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Adelanto'    ,getdate()) --20
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Adelanto'    ,getdate()) --20
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Adelanto'    ,getdate()) --20
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Adelanto'    ,getdate()) --20
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Adelanto'    ,getdate()) --20
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Adelanto'    ,getdate()) --20
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Adelanto'    ,getdate()) --20
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Agua Dulce'  ,getdate()) --1
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Aguanga'     ,getdate()) --1
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Akron'       ,getdate()) --19
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Akron'       ,getdate()) --19
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Akron'       ,getdate()) --19
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Akron'       ,getdate()) --19
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Akron'       ,getdate()) --19
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Akron'       ,getdate()) --19
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Akron'       ,getdate()) --19
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Akron'       ,getdate()) --19
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Akron'       ,getdate()) --19
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Akron'       ,getdate()) --19
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Akron'       ,getdate()) --19
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Akron'       ,getdate()) --19
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Akron'       ,getdate()) --19
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Akron'       ,getdate()) --19
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Akron'       ,getdate()) --19
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Akron'       ,getdate()) --19
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Akron'       ,getdate()) --19
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Akron'       ,getdate()) --19
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Akron'       ,getdate()) --19
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Albany'      ,getdate()) --12
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Albany'      ,getdate()) --12
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Albany'      ,getdate()) --12
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Albany'      ,getdate()) --12
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Albany'      ,getdate()) --12
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Albany'      ,getdate()) --12
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Albany'      ,getdate()) --12
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Albany'      ,getdate()) --12
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Albany'      ,getdate()) --12
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Albany'      ,getdate()) --12
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Albany'      ,getdate()) --12
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Albany'      ,getdate()) --12
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Albion'      ,getdate()) --3
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Albion'      ,getdate()) --3
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Albion'      ,getdate()) --3
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Alexandria'  ,getdate()) --14
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Alexandria'  ,getdate()) --14
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Alexandria'  ,getdate()) --14
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Alexandria'  ,getdate()) --14
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Alexandria'  ,getdate()) --14
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Alexandria'  ,getdate()) --14
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Alexandria'  ,getdate()) --14
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Alexandria'  ,getdate()) --14
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Alexandria'  ,getdate()) --14
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Alexandria'  ,getdate()) --14
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Alexandria'  ,getdate()) --14
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Alexandria'  ,getdate()) --14
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Alexandria'  ,getdate()) --14
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Alexandria'  ,getdate()) --14
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Algonac'     ,getdate()) --1
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Alhambra'    ,getdate()) --5
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Alhambra'    ,getdate()) --5
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Alhambra'    ,getdate()) --5
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Alhambra'    ,getdate()) --5
waitfor delay '00:00:01'
insert into tREaltyTrac values ('Alhambra'    ,getdate()) --5 
```

display table values

```
select city,count(*) from tREaltyTrac group by city
select * from tREaltyTrac 
```

delete the rows you don't want

```
delete from tREaltyTrac
    from tREaltyTrac
        inner join (select
                        city,creation, row_number() over(partition by city order by city) AS RankValue
                        from tREaltyTrac
                   ) dt on tREaltyTrac.city=dt.city AND tREaltyTrac.creation=dt.creation
    where dt. RankValue>10 
```

show the rows you have left

```
select * from tREaltyTrac
select city,count(*) from tREaltyTrac group by city 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T21:19:33.623

Something like this should take care of it for you, but deleting records automatically isn't a great idea. You'd be better off using an active flag.

```
DECLARE @CityName VARCHAR(30)
DECLARE CitiesOver10 CURSOR FOR select city from tREaltyTrac group by city having count(city)>10 

OPEN CitiesOver10
FETCH NEXT FROM CitiesOver10 INTO @CityName

WHILE @@FETCH_STATUS = 0
    BEGIN
        DELETE FROM 
            dbo.tREaltyTrac 
        WHERE 
            ID NOT IN (SELECT TOP 10 ID FROM dbo.tREaltyTrac WHERE city = @CityName ORDER BY Creation DESC)
            AND City = @CityName

        FETCH NEXT FROM CitiesOver10 INTO @CityName
    END

CLOSE CitiesOver10
DEALLOCATE CitiesOver10 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T21:12:21.443

您不应该从数据库中删除记录。这不是 100% 完美的，我敢肯定有更好的方法来做到这一点，但你去吧。

```
declare @cities (CityName nvarchar(50), ID int identity(1,1))
declare @returns (CityName nvarchar(50), Blah nvarchar(50))
declare @cityname nvarchar(50)
declare @count int
declare @i int

insert into @cities (CityName)
select distinct CityName
from tblCities

select @count = count(*) from @cities
set @i=1

while (@i<=@count)
begin

    select @cityname = CityName from @cities where ID=@i

    select top 10 *
    from tblCities
    where CityName=@cityname
    order by Creation desc

    set @i=@i+1
end 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-01T21:13:52.640

我现在没有时间写出实际的代码，但是像这样的东西怎么样......（假设是 PHP）

1.  订购您的初始查询 - 添加**创建 DESC**
2.  循环遍历结果，获取第 10 个结果的创建日期
3.  Run another query that deletes everything less than the creation value for the 10th result? - i.e. **DELETE WHERE Creation < $creationDateOfTenthResult**

Hope that makes sense...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-01T21:14:54.290

I would select the top ten, throw them in a temp table, delete the original and populate it with the temp table.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-01T21:33:47.537

Depends on your version of sql. Something similar to this might work

SELECT r.City, b.* FROM tREaltyTrac r join tREaltyTrac b on b.Id in ( select top 10 Id from tREaltyTrac where Id = r.Id order by Id Desc ) group by r.City

# perl - 我应该如何处理不应再在 Perl 中使用的对象？

> ID：813266
> 
> 赞同：4
> 
> 时间：2009-05-01T21:01:03.217
> 
> 标签：perl, oop, design-decisions

我正在编写一个链接到外部资源的类。其中一种方法是删除外部资源的删除方法。不应对该对象进行进一步的方法调用。如果设置了标志，我正在考虑设置一个标志并在所有方法中消亡，但有没有更好、更简单的方法？可能涉及到 DESTROY 的东西？

到目前为止，我真的很喜欢 Axeman 的建议，但是使用 AUTOLOAD 因为我懒得重新创建所有方法：

```
#!/usr/bin/perl

use strict;
use warnings;

my $er = ExternalResource->new;

$er->meth1;
$er->meth2;

$er->delete;

$er->meth1;
$er->meth2;

$er->undelete;

$er->meth1;
$er->meth2;

$er->delete;

$er->meth1;
$er->meth2;
$er->meth3;

package ExternalResource;

use strict;
use warnings;

sub new {
    my $class = shift;
    return bless {}, $class;
}

sub meth1 {
    my $self = shift;
    print "in meth1\n";
}

sub meth2 {
    my $self = shift;
    print "in meth2\n";
}

sub delete {
    my $self = shift;
    $self->{orig_class} = ref $self;
    return bless $self, "ExternalResource::Dead";
}

package ExternalResource::Dead;

use strict;
use Carp;

our $AUTOLOAD;
BEGIN {
our %methods = map { $_ => 1 } qw/meth1 meth2 delete new/;
}
our %methods;

sub undelete {
    my $self = shift;
    #do whatever needs to be done to undelete resource
    return bless $self, $self->{orig_class};
}

sub AUTOLOAD {
    my $meth = (split /::/, $AUTOLOAD)[-1];
    croak "$meth is not a method for this object"
        unless $methods{$meth};
    carp "can't call $meth on object because it has been deleted";
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-01T21:10:25.707

简单地考虑处于无效状态的对象是否存在问题。如果用户坚持下去，那不是*他们的*问题吗？

以下是一些注意事项：

*   您是否已经决定是否值得死去？

*   很有可能，如果您有一个足够封装的函数，您真的不希望用户解析您的代码。为此，您可能不想使用我所说的 Go-ahead-and-let-it-fail 模式。`'Can't call method "do_your_stuff" on an undefined value'`可能不适用于封装目的。除非你告诉他们“嘿，你删除了对象！

以下是一些建议：

*   您可以将对象重新*分配*到一个唯一的工作是指示无效状态的类中。它具有相同的基本形式，但表中的所有符号都指向一个仅表示“抱歉不能这样做，我已被关闭（你关闭我，记得吗？）”的子项。

*   你可以`$_[0]`在删除中取消定义。*然后他们*`'Can't call method "read_from_thing" on an undefined value'`从代码中的一行得到一个不错的结果——前提是他们没有经过精心的装饰或委托过程。但是正如混乱所指出的那样，这并不能清除多个参考（正如我通过下面的示例代码改编的那样）。

 ** * *

一些概念证明的东西：

```
use feature 'say';

package A;

sub speak { say 'Meow!'; }

sub done { undef $_[0]; }

package B;

sub new { return bless {}, shift; }

sub speak { say 'Ruff!' }

sub done { bless shift, 'A'; }

package main;

my $a = B->new();
my $b = $a;

$a->speak(); # Ruff!
$b->speak(); # Ruff!
$a->done();
$a->speak(); # Meow!
$b->speak(); # Meow! <- $b made the switch
$a->done();
$b->speak(); # Meow!
$a->speak(); # Can't call method "speak" on an undefined value at - line 28 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-01T21:13:31.067

理想情况下，它应该超出范围。如果由于某种原因无法界定适当的范围，并且您担心引用意外地保持资源活动，则可能会考虑弱引用（Scalar::Util 至少在 5.10 中是核心）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-01T21:14:50.657

您可以让用户只获得对象的[弱](http://search.cpan.org/~lukka/WeakRef-0.01/WeakRef.pm)引用，而将单个强引用保存在模块中。然后当资源被销毁时，删除强引用和噗，不再有对象。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-03T18:20:58.670

继我在这里的第一个答案中的评论之后，使用[Moose](http://moose.perl.org)修改对象行为的“一种方法” 。

```
{
    package ExternalResource;
    use Moose;
    with 'DefaultState';
    no Moose;
}

{
    package DefaultState;
    use Moose::Role;

    sub meth1 {
        my $self = shift;
        print "in meth1\n";
    }

    sub meth2 {
        my $self = shift;
        print "in meth2\n";
    }

    no Moose::Role;
}

{
    package DeletedState;
    use Moose::Role;

    sub meth1 { print "meth1 no longer available!\n" }
    sub meth2 { print "meth2 no longer available!\n" }

    no Moose::Role;
}

my $er = ExternalResource->new;
$er->meth1;     # => "in meth1"
$er->meth2;     # => "in meth2"

DeletedState->meta->apply( $er );
my $er2 = ExternalResource->new;
$er2->meth1;    # => "in meth1"  (role not applied to $er2 object)
$er->meth1;     # => "meth1 no longer available!"
$er->meth2;     # => "meth2 no longer available!"

DefaultState->meta->apply( $er );
$er2->meth1;    # => "in meth1"
$er->meth1;     # => "in meth1"
$er->meth2;     # => "in meth2" 
```

还有其他方法可以实现您在 Moose 中所追求的目标。但是我确实喜欢这种[角色](http://search.cpan.org/dist/Moose/lib/Moose/Cookbook/Roles/Recipe3.pod)方法。

当然值得深思。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-03T11:15:18.833

使用[Moose ，您可以使用其](http://moose.perl.org)[MOP](http://search.cpan.org/dist/Class-MOP/)基础来更改类：

```
package ExternalResource;
use Moose;
use Carp;

sub meth1 {
    my $self = shift;
    print "in meth1\n";
}

sub meth2 {
    my $self = shift;
    print "in meth2\n";
}

sub delete {
    my $self = shift;
    my %copy;   # keeps copy of original subref
    my @methods = grep { $_ ne 'meta' } $self->meta->get_method_list;

    for my $meth (@methods) {
        $copy{ $meth } = \&$meth;
        $self->meta->remove_method( $meth );
        $self->meta->add_method( $meth => sub {
            carp "can't call $meth on object because it has been deleted";
            return 0;
        });
    }

    $self->meta->add_method( undelete => sub {
        my $self = shift;
        for my $meth (@methods) {
            $self->meta->remove_method( $meth );
            $self->meta->add_method( $meth => $copy{ $meth } );
        }
        $self->meta->remove_method( 'undelete' );
    });
} 
```

现在 ExternalResource 的所有当前和新实例都将反映当前状态。

# php - 如何在 mysql 数据库中存储特殊字符（'、"、& 等），以便它们可以被搜索？

> ID：813267
> 
> 赞同：3
> 
> 时间：2009-05-01T21:01:05.993
> 
> 标签：php, mysql

我在存储引号、双引号和 & 号等特殊字符时遇到了一个小问题。我通过 mysql_real_escape_string() 放置每个 POST 请求，当我添加一个字符串时，`"That '70s Show"`它就像存储`"That &#x27;70s Show"`在 mysql DB 中一样。当我回显它时，它工作正常......但是当我尝试运行 % $string % search for`"That '70s Show"`时，它不会找到记录。我禁用了magic_quotes。

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-01T21:12:59.007

看起来问题在于，您不仅在运行通过 存储在数据库中的传入数据`mysql_real_escape_string()`，而且还运行`htmlentities()`着一个亲戚。是这样吗？如果是这样，请退出。:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T21:11:56.670

***引用自 Mysql 参考文档***

有几种方法可以在字符串中包含引号字符：

*   用“'”引用的字符串中的“'”可以写成“''”。

*   用“"”引用的字符串中的“"”可以写成“""”。

*   在引号字符前加上转义字符 (“\”)。

*   用“"”引用的字符串中的“'”不需要特殊处理，也不需要加倍或转义。同样，用“'”引用的字符串中的“"”不需要特殊处理。

以下 SELECT 语句演示了引用和转义的工作方式：

```
mysql> SELECT 'hello', '"hello"', '""hello""', 'hel''lo', '\'hello';
+-------+---------+-----------+--------+--------+
| hello | "hello" | ""hello"" | hel'lo | 'hello |
+-------+---------+-----------+--------+--------+ 
```

参考：[http ://dev.mysql.com/doc/refman/5.0/en/string-syntax.html](http://dev.mysql.com/doc/refman/5.0/en/string-syntax.html)

# sql - 如何在 SQL Server 中存储十进制值？

> ID：813287
> 
> 赞同：292
> 
> 时间：2009-05-01T21:06:13.017
> 
> 标签：sql, sql-server, types, decimal

我试图找出 SQL Server 中列的十进制数据类型。我需要能够存储 15.5、26.9、24.7、9.8 等值

我分配`decimal(18, 0)`给列数据类型，但这不允许我存储这些值。

这样做的正确方法是什么？

* * *

## 回答 #1

> 赞同：530
> 
> 时间：2009-05-01T21:09:19.017

`DECIMAL(18,0)`将允许小数点后为 0 位。

使用类似的东西`DECIMAL(18,4)`应该就可以了！

**总共有 18 位数字**，其中小数点后有 4 位（小数点前有 14 位）。

* * *

## 回答 #2

> 赞同：142
> 
> 时间：2009-05-01T21:17:00.557

你应该使用如下：

```
DECIMAL(m,a) 
```

`m`是你的小数可以有的总位数。

`a`是小数点后可以有的最大位数。

[http://www.tsqltutorials.com/datatypes.php](http://www.tsqltutorials.com/datatypes.php)有所有数据类型的描述。

* * *

## 回答 #3

> 赞同：44
> 
> 时间：2009-05-01T22:04:48.273

的设置`Decimal`是它的精度和比例或在普通语言中，一个数字可以有多少位以及小数点右侧需要多少位。

因此，如果您放入`PI`a `Decimal(18,0)`，它将被记录为`3`?

如果你放入`PI`a`Decimal(18,2)`它会被记录为`3.14`？

如果放入`PI`被`Decimal(18,10)`记录为`3.1415926535`.

* * *

## 回答 #4

> 赞同：39
> 
> 时间：2015-06-16T03:28:11.497

大多数时候，我使用十进制（9,2），它在 sql 十进制类型中占用最少的存储空间（5 个字节）。

* * *

精度 => 存储字节

*   1 - 9 => 5
*   10-19 => 9
*   20-28 => 13
*   29-38 => 17

* * *

它可以存储从 0 到 9 999 999.99（前 7 位 + 小数点后 2 位 = 总共 9 位），对于大多数值来说足够大。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2018-03-23T02:48:13.320

你可以试试这个

```
decimal(18,1) 
```

数字的长度应为 18 位。小数点后的数字长度应仅为 1，不能超过 1。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2013-02-17T13:34:35.187

在 MySQL DB`decimal(4,2)`中，只允许输入总共 4 位数字。正如您在 中看到的`decimal(4,2)`，这意味着您总共可以输入 4 位数字，其中两位数字用于保留小数点后。

因此，如果您在 MySQL 数据库中输入 100.0，则会显示类似“Out of Range Value for column”之类的错误。

因此，您只能在此范围内输入：从 00.00 到 99.99。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-05-01T21:27:24.637

其他答案都是对的。假设您的示例反映了您想要的所有可能性`DECIMAL(3, 1)`。或者，`DECIMAL(14, 1)`将允许总共 14 位数字。你的工作就是考虑什么是足够的。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-11-22T10:28:24.020

```
request.input("name", sql.Decimal, 155.33)              // decimal(18, 0)
request.input("name", sql.Decimal(10), 155.33)          // decimal(10, 0)
request.input("name", sql.Decimal(10, 2), 155.33)       // decimal(10, 2) 
```

# c# - 可靠性和 WCF

> ID：813288
> 
> 赞同：0
> 
> 时间：2009-05-01T21:06:45.747
> 
> 标签：c#, wcf

所以这是场景......我有一个共享点内容类型，它调用 wcf 服务来更新另一个数据库中的数据。问题来了，如果调用超时怎么办？这个过程发生在结帐期间，虽然我在等待调用完成时可能会遇到 SP 端的故障，但服务端可能会成功。关于构建解决方案的更好方法的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T21:19:04.687

您是否考虑过使用 wsDualHttpBinding 并在处理完成后让服务执行回调？您可以使用 AJAX 调用 WCF 服务，该服务将在后台异步执行调用。然后当服务完成时，它可以回调双重绑定并让 SP 应用程序知道它已经完成。

# php - 在 cakephp 中，如何查找相关字段的条件？

> ID：813294
> 
> 赞同：1
> 
> 时间：2009-05-01T21:08:51.327
> 
> 标签：php, cakephp

我有一个模型（Listings），它拥有并属于几个不同的模型，我想找到所有这个模型，它的相关模型（Openhouses）有一个条件。“拥有和属于”在模型文件中设置。Listings有很多Openhouses，Openhouses属于Listings。（并且列表有很多我想要数据的其他模型。）

我一直在努力。

```
$this->Listing->find('all', 
array('conditions' => 
array('Openhouse.date >' => $openhouse_start->format('Y-m-d H:i:s'),
'Openhouse.date <' => $openhouse_end->format('Y-m-d H:i:s'))
)); 
```

但无济于事。

```
Error: 1054: Unknown column 'Openhouse.date' in 'where clause 
```

我知道我可以在 Openhouse 模型上搜索并获取相关的列表，但是数据以不同的格式返回，我需要将递归方式向上转换以从我的其他模型中获取数据。（我最终得到了重复的开放式数据！）。如果需要，我可以发布更多代码示例。

我的问题基本上是我是否只需要查询 openhouse 模型并使用它，还是我在相关模型上设置条件的语法不正确？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-02T01:32:55.187

如果您有很多链接模型，递归到 2 的设置可能会带来比您想要的更多的数据。

如果这是真的，那么可以替代 mavarro 所说的，您也可以尝试使用[Containable 行为](http://book.cakephp.org/2.0/en/core-libraries/behaviors/containable.html)：

```
$this->Listing->find
(
    'all', 
    array
    (
        'conditions' => array
        (
            'Openhouse.date >' => $openhouse_start->format('Y-m-d H:i:s'),
            'Openhouse.date <' => $openhouse_end->format('Y-m-d H:i:s')
        ),
        'contain' => array('Openhouse')
    )
); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-02T11:24:32.703

试试这个：

```
$this->List->find('all', array(
    'contain' => array(
        'Openhouse.conditions' => array(
            'Openhouse.date >' => $openhouse_start->format('Y-m-d H:i:s'),
            'Openhouse.date <' => $openhouse_end->format('Y-m-d H:i:s'))
        )
    )
) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-02T00:25:16.050

尝试 `$this->Listing->recursive = 2;` 在调用之前添加一个以查找所有内容。这*应该*在调用之前链接表格，让您可以从 Listing 模型访问 Openhouse 模型。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-01-19T08:30:55.223

```
$this->List->find('all', array(
    'contain' => array(
        'conditions' => array(
            'Openhouse.date >' => $openhouse_start->format('Y-m-d H:i:s'),
            'Openhouse.date <' => $openhouse_end->format('Y-m-d H:i:s')
                             ),
        'order' => array('Openhouse.date DESC')
                      )
                             )
) 
```

# sql-server-2005 - 如何在 SQL Server 2005 中将日期时间字段转换为格式化字符串？

> ID：813300
> 
> 赞同：1
> 
> 时间：2009-05-01T21:09:59.640
> 
> 标签：sql-server-2005

我想从`datetime`SQL Server 2005 中的类型中选择格式化的日期字符串。

格式为“yyyy/mm/dd hh:mm:ss”。

仅使用查询的最佳方法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-01T21:11:41.070

查看 CONVERT 语句。

```
SELECT CONVERT(VARCHAR(20), getdate(), 120) 
```

最接近你想要的。（注意不同的分隔符（- 而不是 / ））

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-01T21:19:18.710

```
 select convert(varchar, datetime_field, 120) from tablename; 
```

*几乎*会做你想做的事。

`120`是转换“样式”，[请参阅此处了解更多信息。](http://technet.microsoft.com/en-us/library/ms174450.aspx)

# logging - 您会推荐什么 .NET 检测框架，为什么？

> ID：813323
> 
> 赞同：1
> 
> 时间：2009-05-01T21:14:12.890
> 
> 标签：logging, log4net, instrumentation

我只有[log4net](http://logging.apache.org/log4net/)的经验，但这并不意味着海里没有更好的鱼。我没有时间去钓鱼，但我有 60 秒的时间发布到 SO。

那么每个人都使用过什么以及他们的经验呢？

*   **我理解这是主观的，但请提供您**有意见的具体原因（例如 Acme Logging 在该配置中运行良好，或者它不支持我们需要的远程监控等）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T21:20:35.277

我建议看看[ELMAH](http://www.hanselman.com/blog/ELMAHErrorLoggingModulesAndHandlersForASPNETAndMVCToo.aspx)

**编辑：**我忘记了我的意见：所以使用它:)

# string - VB6 字符串比较是否不区分大小写？

> ID：813335
> 
> 赞同：6
> 
> 时间：2009-05-01T21:15:43.587
> 
> 标签：string, vb6

如果 strValue = 'Hello' 那么 (strValue <> 'HELLO') 的值是多少？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-01T21:18:24.127

这取决于您如何使用[Option Compare](https://msdn.microsoft.com/en-us/library/aa266181(v=vs.60).aspx)语句。它可以以任何一种方式工作。

```
Option Compare Text 'Case insensitive'
Option Compare Binary 'Case sensitive (default)' 
```

这是一个[VB6 字符串教程](http://www.vbexplorer.com/VBExplorer/Focus/strings_tutorial_2.asp)。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-01T21:17:46.080

不，它是区分大小写的（默认情况下，至少虽然你会想要检查 - 如果 Option Compare 设置为 Binary 或未设置，那么它区分大小写，如果它设置为文本，那么它不区分大小写）。

如果您希望它不区分大小写，则 Lcase() 双方。

我更喜欢这个而不是更改/设置选项比较的原因是，查看代码的人不必去寻找比较设置的选项来了解它的行为方式但它几乎肯定会更慢（除非你'重复调用它），有些人可能会认为它不是特别整洁。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-02-15T14:44:49.840

文档相当[清楚](http://msdn.microsoft.com/en-us/library/aa212267.aspx)

> 如果您`Option Compare Text`在模块的声明部分 [文件顶部] 中使用，则字符串比较不区分大小写。
> 如果使用`Option Compare Binary`，则比较区分大小写。
> 如果使用`Option Compare Database`[*仅在Access VBA中有效*]，则比较方法由当前数据库设置。

# php - http://localhost/ 在 Windows 7 上不起作用。有什么问题？

> ID：813347
> 
> 赞同：24
> 
> 时间：2009-05-01T21:18:44.687
> 
> 标签：php, netbeans, windows-7, localhost, wamp

我在 Windows 7（测试版）上打开[http://localhost/时遇到了一个大问题。](http://localhost/)我安装了这个操作系统，一切都很顺利；当我安装 Wamp 时，我看到 localhost 根本不起作用。我只看到这个错误：

> ### 连接失败
> 
> Firefox 无法在 localhost 上建立与服务器的连接。

在 Mozilla 和资源管理器中。

我删除了 Wamp，几周后（即从今天开始的两周）我在 Windows 7 上安装了 NetBeans。我创建了一个测试 PHP 脚本，当我调试它时，我再次遇到同样的错误。我尝试使用 ip 127 访问它....但仍然相同。问题是什么？
当我安装 NetBeans 时，我将它安装在端口 8080 中。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-05-01T21:47:03.090

如果安装在 8080 端口，则需要在 8080 端口访问：

[http://localhost:8080](http://localhost:8080)或[http://127.0.0.1:8080](http://127.0.0.1:8080)

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-12-03T10:41:33.183

要修复端口 80 问题，请执行以下操作：

从 cmd 以管理员身份：

1.  `sc config http start= demand`（你需要在等号之后而不是之前有一个空格）
2.  重启
3.  以管理员身份运行命令 ( `netsh http show servicestate`) 以检查端口 80 是否正在使用中

运行此命令后，您可以禁用 http.sys，如下所示：

1.  `net stop http`（停止进程）
2.  `Sc config http start= disabled`（如果您想永远禁用该服务）

这个对我有用。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-05-01T21:45:51.330

编辑您的`C:\Windows\System32\drivers\etc\hosts`文件

确保有一个如下所示的条目：

```
127.0.0.1   localhost 
```

如果有类似的条目

```
::  localhost 
```

注释掉它看起来像这样

```
\#:: localhost 
```

这应该可以解决您的问题，我过去遇到过这个问题。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-06-05T18:00:12.573

对我来说，是Skype导致了问题。一旦我停止Skype，一切正常。我在 Windows 7 x64 上运行 1.7.1 xampp（mysql 和 apache）。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-06-17T13:03:45.563

听起来您在任何地方都没有运行 Web 服务器。

您是否尝试过启用 IIS 并首先使用它来显示基本的 html 文件？

***程序和功能 -> 打开/关闭 Windows 功能 -> Internet 信息服务***

然后，将您的 html 文件放在 C:\inetpub\wwwroot\index.html 并浏览到[http://localhost](http://localhost)。

一旦这工作，尝试让 WAMP/php 工作。小心端口冲突。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-01T21:41:31.340

我最初的想法是您在 hosts 文件中缺少一个条目。然而，像“127.0.0.1 localhost”之类的东西，你提到你遇到了 404 错误。这意味着网络服务器正在连接到您的客户端/浏览器并响应对特定网页的请求。

我对 Windows 7 不够熟悉，但是，我很确定它默认不包含网络服务器。此外，除非您使用 netbeans 实际编写代码、构建和运行网络服务器应用程序，否则您不会获得所需的响应。

归根结底……您的问题将是以下问题之一：

1）您正在提供静态文档，并且网络服务器未配置为从适当的 DOCROOT 提供文件。这包括用户目录中的 PUBLIC 文件夹。（基本的 apache 安装包括一个基本的主页）

2）你有一个动态的网络服务器应用程序，控制器正在查看应用程序路径，以决定要显示什么页面或执行什么功能。（请参阅 MVC - 控制器）。基本上实现不完整。

3) 另一个配置错误：您的网站实际上可能定义了一个虚拟域。（不是 localhost），因此当您在 URL 中查找 localhost 时，服务器可能未配置为提供默认页面。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-06-21T04:10:57.833

取消注释主机文件中的以下行对我有用，

```
#127.0.0.1 localhost 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-01T21:34:10.830

~~那么你得到一个 404，所以 web 服务器正在运行，它只是找不到文件。~~

检查 http.conf 文件。如果它指向正确的根目录？

如果您使用不同的端口，请检查 http.conf 以查看 Apache 是否正在侦听正确的端口，或者 Apache 是否正在将该端口上的流量重定向到另一个根目录。

也许发布您的 http.conf 文件可能会有所帮助？

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-17T02:26:34.293

如果您仍然遇到此问题，请尝试以下操作：

1.  编辑您的主机文件（使用提升的权限）
2.  取消注释“#127.0.0.1 localhost”行（即删除#）
3.  按原样保存文件。没有分机的主机

在 Win7 中，MS 已决定使用该消息注释 localhost 行，该消息说它是在 dns 中处理的。我仍然不清楚他们在做什么，除了他们可能告诉人们使用 dns 进行 localhost 解析而不是 hosts 文件。无论如何，这样可能更安全。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-07-04T18:07:41.447

是的，这对我来说也是一种痛苦。

所以我所做的就是找到“Start Wampserver”，只需点击开始按钮并输入它。

然后右键单击它，选择属性。我将它设置为在功能选项卡上的 XP servive pack 3 中运行。我还选中了“以管理员身份运行此程序”框。

然后我右键单击系统托盘上的 WAMPSERVER，然后重新启动所有服务。这对我来说很完美，希望这对你也有帮助。

抢

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-07-04T18:28:13.940

有其他程序正在运行吗？微信等...？一些绑定到端口 8080 然后您的网络服务器将无法启动并导致 404 ，尝试将其绑定到其默认值应为的不同端口 80

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2010-01-14T16:18:20.717

我收到 404 无法连接错误，然后我将 wampmanager.exe 设置为以 Xp Sp3 运行，它似乎工作正常，这可以通过

* * *

1.  右键单击它
2.  特性
3.  单击标有“兼容性”的标签
4.  勾选框只是在“兼容模式”下
5.  选择 Windows XP (Service Pack 3)
6.  单击应用然后确定

* * *

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2010-08-24T08:46:49.513

Skype 也干扰了我。我更改了 Skype 设置（在 Skype 中转到工具 > 选项 > 高级 > 连接并取消选中“使用端口 80 和 443 作为传入连接的替代选项”）保存然后关闭 Skype。我有 Win 7 HomePremium 64 位，安装 Xampp 并且 MySQL 运行良好，但无论我启动 Apache 多少次（控制台显示“Apache 已启动”），我仍然收到“firefox 无法建立连接”错误浏览器。保存 Skype 更改后，Apache 显示绿色的“正在运行”，现在一切正常，谢谢

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2010-12-27T22:28:29.060

对我来说，这最终在端口 80 上起到了作用：

*   您必须通过注册表手动禁用 http.sys 服务：

    1.  启动注册编辑：
    2.  转到：HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\HTTP
    3.  添加新的 DWORD（32 位）值
    4.  将其命名为“NoRun”，不包括引号
    5.  双击新属性
    6.  在数值数据字段中输入“1”，不包括引号，然后单击确定
    7.  重新启动您的计算机

您现在应该发现 Apache 将在端口 80 上启动！

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-05-01T22:52:26.663

你试过iis吗？转到控制面板-> 程序和功能-> 打开或关闭 Windows 功能（侧栏）。尝试安装或重新安装 Internet 信息服务。我有一个带有 iis、.net 和 php 的 Windows 7，它工作得很好......

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-08-08T07:16:59.117

假设在 localhost（到 127.0.0.1）上进行查找没有问题，您需要确保您的服务器正在侦听 127.0.0.1。

netstat 可以在 Windows 和 UNIX 中运行。您可能需要 " `netstat -a`" 来显示侦听器。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2010-01-10T11:14:29.440

你要安装服务，去wamp->Apache->Service->Install service，然后会弹出一个命令提示符窗口，然后回车，几秒钟后去相同的路径Services->点击开始/恢复服务，你准备好了

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2010-12-01T08:34:25.680

`wwwroot`尝试在文件夹 web.config 文件中添加以下标签。这些标签应添加为配置标签的子标签，如下所示。

```
-configuration-
--system.webServer--
---validation validateIntegratedModeConfiguration="false" ---
--/system.webServer--
-/configuration- 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2011-08-10T00:34:47.747

我遇到了完全相同的问题，解决方案就是有人已经说过：

在任务栏中，单击 WAMP 图标。

转到 Apache--> 服务--> 安装服务

然后通过单击并选择 Apache-->Service-->Start/Resume Service 返回

这将允许 localhost 函数工作（请记住，我已经更改了位于 c:\windows\system32\drivers\etc 下的主机文件以从 127.0.0.1 行中删除 #）

如果您仍需要编辑该文件，则需要右键单击它并选择“属性”。然后转到安全选项卡，然后单击高级按钮。然后您需要选择用户，单击编辑并选择“完全控制”。这将使您能够对其进行编辑。

话虽如此，您还需要按照相同的过程安装 MySQL 服务。

MySQL-->服务-->安装服务

然后通过再次右键单击并选择 MySQL-->Service-->Start/Resume Service 返回。

这应该可以在 Windows 7 中解决所有问题！

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2011-08-25T12:57:59.207

在安装 Wamp 之前，进入控制面板 => 管理工具 => IIS 管理器并关闭 IIS 服务器。安装 wamp，一切正常。当 IIS 开启时，它也使用端口 80。您可以通过大量更改 wamp 的端口和权限，但我发现这是让 wamp 成功运行的最快和最简单的方法。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2011-08-29T06:40:09.930

看到上面的解决方案都很好。但是每当你得到这个404 eroor，首先看到这个。我相信问题会得到解决......

只需单击右下角任务栏中的 wamp 服务器符号即可转到 httpd.conf 文件`Apache->httpd.conf`-...或`c:\\wampt\\bin\\apache\\apache2.2.1\\conf\\httpd.conf`在第 46 行近似，您会发现“Listen 80”...只需确保在 Listen 之后写为“80”即可。 .如果不是，则将其更改为80 ...您的问题将得到解决...

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2013-04-18T17:13:46.497

也许 Skype 或其他应用程序正在使用端口 80。您可以签入

> 工具->设置->高级->连接

# .net - 确定停用表单时的激活位置

> ID：813356
> 
> 赞同：4
> 
> 时间：2009-05-01T21:20:09.600
> 
> 标签：.net, winforms, focus, lost-focus

有谁知道在停用表单时确定哪个窗口将获得焦点的方法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-01T23:36:27.850

我找到了答案。不要订阅激活和停用事件，而是在 WndProc 中处理[WM_ACTIVATE](http://msdn.microsoft.com/en-us/library/ms646274(VS.85).aspx)消息（用于激活和停用）。由于它报告正在激活的窗口句柄，我可以将该句柄与我的表单句柄进行比较，并确定焦点是否正在更改为其中任何一个。

```
const int WM_ACTIVATE = 0x0006;
const int WA_INACTIVE = 0;
const int WA_ACTIVE = 1;  
const int WA_CLICKACTIVE = 2;  

protected override void WndProc(ref Message m)  
{  
    if (m.Msg == WM_ACTIVATE)  
    {  
         // When m.WParam is WA_INACTIVE, the window is being deactivated and
         // m.LParam is the handle of the window that will be activated.

         // When m.WParam is WA_ACTIVE or WA_CLICKACTIVE, the window is being 
         // activated and m.LParam is the handle of the window that has been 
         // deactivated.
    }  

    base.WndProc(ref m);  
} 
```

**编辑：**此方法可以在它适用的窗口之外使用（例如在弹出窗口之外）。

您可以使用 NativeWindow 根据其句柄附加到任何窗口并查看其消息循环。请参见下面的代码示例：

```
public class Popup : Form
{
    const int WM_ACTIVATE = 0x0006;
    const int WA_INACTIVE = 0;
    private ParentWindowIntercept parentWindowIntercept;

    public Popup(IntPtr hWndParent)
    {
        this.parentWindowIntercept = new ParentWindowIntercept(hWndParent);
    }

    private class ParentWindowIntercept : NativeWindow
    {
        public ParentWindowIntercept(IntPtr hWnd)
        {
            this.AssignHandle(hWnd);
        }

        protected override void WndProc(ref Message m)
        {
            if (m.Msg == WM_ACTIVATE)
            {
                if ((int)m.WParam == WA_INACTIVE)
                {
                    IntPtr windowFocusGoingTo = m.LParam;
                    // Compare handles here
                }
            }

            base.WndProc(ref m);
        } 
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T21:25:56.853

您应该能够使用`Form.ActiveForm`静态属性确定活动表单。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-01T14:13:13.607

在实现自动完成弹出窗口（类似于 VS 中的 Intellisense 窗口）时，我遇到了同样的问题。

该`WndProc`方法的问题在于，必须将代码添加到发生弹出窗口的任何表单中。

另一种方法是使用计时器并在短暂的间隔后检查 Form.ActiveControl。这样，代码可以更好地封装**在编辑器控件或弹出表单**中。

```
Form _txPopup;

// Subscribe whenever convenient
public void IntializeControlWithPopup(Form _hostForm)
{
    _hostForm.Deactivate + OnHostFormDeactivate;
}

Timer _deactivateTimer;
Form _hostForm;
void OnHostFormDeactivate(object sender, EventArgs e)
{
    if (_deactivateTimer == null) 
    {
        _mainForm = sender as Form;
        _deactivateTimer = new Timer();
        _deactivateTimer.Interval = 10;
        _deactivateTimer.Tick += DeactivateTimerTick;
    }
    _deactivateTimer.Start();
}

void  DeactivateTimerTick(object sender, EventArgs e)
{
    _deactivateTimer.Stop();
    Form activeForm = Form.ActiveForm;
    if (_txPopup != null && 
        activeForm != _txPopup && 
        activeForm != _mainForm) 
    { 
        _txPopup.Hide(); 
    }
} 
```

# visual-studio-2008 - 将 MSTest 与 MFC 一起使用

> ID：813358
> 
> 赞同：2
> 
> 时间：2009-05-01T21:20:26.133
> 
> 标签：visual-studio-2008, unit-testing, mstest

有没有人使用 MSTest 来测试 MFC 代码？

我创建了一个托管 C++ 测试项目，并且可以在其中编写单元测试，但是一旦我`#include <afxwin.h>`遇到问题。代码将编译，当它开始运行测试时，UI 挂起并且不会加载任何符号。您也无法调试测试。如果我删除`#include`，那么测试将成功运行。有任何想法吗？

它使用带有多线程调试 (/mtd) 的 /clr 进行编译，并通过共享 dll 使用 MFC。如果我选择静态链接到 MFC，那么编译器 (VSVC9.0) 会告诉我 /clr 和 /mtd 不兼容。

另外，您认为在测试中添加 DependencyInput 会解决这个问题吗？我尝试添加一些 MFC dll 作为依赖项输入，但没有帮助。我可能做错了。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-10-17T13:44:07.350

在工作中，我们使用visual studio 2010，成功创建了一个托管的c++测试项目来测试mfc代码。

我们开始使用向导创建一个 c++ 测试项目。然后，在单元测试项目的配置属性中，更改以下内容：

*   常规->使用 MFC = 更改为“在共享 DLL 中使用 MFC”
*   General->Common language runtime support = 改为“Common language support (/clr)
*   （仅在调试配置中）链接器->输出->忽略特定默认库 = 添加 MSVCRT

在 stdafx.h 中：我有以下内容

```
// Modify the following defines if you have to target a platform prior to the ones specified below.
// Refer to MSDN for the latest info on corresponding values for different platforms.
#ifndef WINVER              // Allow use of features specific to Windows XP or later.
#define WINVER 0x0501       // Change this to the appropriate value to target other versions of Windows.
#endif

#ifndef _WIN32_WINNT        // Allow use of features specific to Windows XP or later.                   
#define _WIN32_WINNT 0x0501 // Change this to the appropriate value to target other versions of Windows.
#endif                      

#ifndef _WIN32_IE           // Allow use of features specific to IE 6.0 or later.
#define _WIN32_IE 0x0600    // Change this to the appropriate value to target other versions of IE.
#endif

#include <afxwin.h>         // MFC core and standard components
#include <afxext.h>         // MFC extensions

#ifndef _AFX_NO_OLE_SUPPORT
#include <afxole.h>         // MFC OLE classes
#include <afxodlgs.h>       // MFC OLE dialog classes
#include <afxdisp.h>        // MFC Automation classes
#endif // _AFX_NO_OLE_SUPPORT

#ifndef _AFX_NO_DB_SUPPORT
#include <afxdb.h>          // MFC ODBC database classes
#endif // _AFX_NO_DB_SUPPORT

#include <afxdtctl.h>       // MFC support for Internet Explorer 4 Common Controls
#ifndef _AFX_NO_AFXCMN_SUPPORT
#include <afxcmn.h>         // MFC support for Windows Common Controls
#endif // _AFX_NO_AFXCMN_SUPPORT 
```

一切都像魅力一样！请让我知道这对你有没有用

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T23:25:36.160

在命令行中是否相同？

没有这样做。但是可以创建一个静态窗口吗？使用进程资源管理器检查 msest 进程。

# .net - Outlook 别名和 System.Net.Mail

> ID：813362
> 
> 赞同：0
> 
> 时间：2009-05-01T21:20:49.363
> 
> 标签：.net, outlook, outlook-2007

是否可以使用 System.Net.Mail 将用户 Outlook 别名解析为有效的 SMTP 电子邮件地址？

我知道它可以通过 Outlook 自动化来完成，但我尽量不使用它，因为 Outlook 2007 具有需要用户交互的垃圾邮件过滤器保护。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-02T00:17:17.473

如果您在 Active Directory 环境中，则可以将 System.DirectoryServices 与正确设计的 AD/LDAP 查询一起使用。我不确定您认为“Outlook 别名”是什么，所以我无法告诉您确切的查询应该是什么。

# algorithm - 求解非图（Picross）

> ID：813366
> 
> 赞同：26
> 
> 时间：2009-05-01T21:22:03.713
> 
> 标签：algorithm, puzzle

现在是星期五下午，让我们来解决一个有趣的拼图/算法问题。

我最喜欢的任天堂 DS 游戏之一是[Picross DS](http://en.wikipedia.org/wiki/Picross_Ds)。游戏非常简单，它涉及解决称为[Nonograms](http://en.wikipedia.org/wiki/Nonogram)的谜题。您可以在这里尝试一个简单的在线 Picross 克隆：[TylerK 的 Picross](http://www.thetimmys.com/flash/picross/)。

非图是一个网格，为网格的每一行和每一列定义了数字序列。这些数字定义了该行/列的“填充”方块块，但未定义块两侧的未填充区域。例如，如果您有一行如下所示：

[![](https://i.stack.imgur.com/opRVG.jpg)](https://i.stack.imgur.com/opRVG.jpg)
[（来源：[steam-punk.net](http://steam-punk.net/images/picross1.jpg)）]

该行的可能解决方案包括：

[![](https://i.stack.imgur.com/6XRZ5.jpg)](https://i.stack.imgur.com/6XRZ5.jpg)
[（来源：[steam-punk.net](http://steam-punk.net/images/picross2.jpg)）][（来源：][[steam-punk.net](http://steam-punk.net/images/picross3.jpg)][）]
[![](https://i.stack.imgur.com/SKy23.jpg)](https://i.stack.imgur.com/SKy23.jpg)

等等

“4 5”只是告诉您，在该行的某处，有 4 个连续块填充，然后是 5 个连续块填充。这些将是唯一填充的块，它们之前/之后的空间量是没有定义的。

当所有行和列都满足其定义且没有任何矛盾时，拼图就完成了。

概念上非常简单的游戏，但手动解决其中一些可能需要相当长的时间。Picross DS 的谜题逐渐增大到 25x20 的网格，这通常需要我大约半小时才能解决。

然而，我总是想到，编写一个程序来解决这将是一个非常简单的游戏。我从来没有接触过它，但也许这里的一些人会喜欢这个挑战。如果发布了相当数量的解决方案，我将在一个大谜题上对它们进行基准测试，类似于[Paolo Bergantino 在这里用他的 Boggle question 所做的](https://stackoverflow.com/questions/746082/how-to-find-list-of-possible-words-from-a-letter-matrix-boggle-solver)。[Nonogram Wikipedia 页面](http://en.wikipedia.org/wiki/Nonogram#Solution_techniques)上有很多关于破解谜题的方法的信息，如果你想参考的话。

这是来自 TylerK 的 Picross 的 Puzzle #1 的易于解析的定义，因此您可以为程序提供一些内容。第 1 行是拼图尺寸（可能不需要），第 2 行是行定义，第 3 行是列定义。这只是想到的第一件事，所以如果有人能想到更好的输入格式，请随时评论或编辑这篇文章以包含它。

```
15 15
15,4 5,2 4,1 3,2,2,2 4 3,2 6 2,2 1 6 2,2 1 1 4 2,1 1,1 3 2 1,2 2 1 2 1,3 3 2 1,9
4 4,3 1 2 3,2 1 2 2,2 1 1,1 4 2,1 3,1 8,1 3 1 1,1 4 2 1,1 4,2 4 3,3 3 3,4 1,10 3,10 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2010-10-08T15:21:28.243

是的，问题是 NP 完全的，但这仅意味着随着拼图规模的增长，您（几乎）陷入了指数级增长的运行时间。但在现实生活中，拼图大小不会增长。几乎没有人会费心制作大于 100x100 且绝大多数小于 50x50 的拼图。构建一个能够在几分之一秒内解决书籍和杂志中 95% 的谜题的求解器实际上并不是特别具有挑战性。一个相当直接的深度优先搜索系统可以做到这一点。

不太明显的是，有一小部分谜题非常讨厌，并且会导致大多数简单求解器的运行时间爆炸。其中大部分是设计糟糕的谜题，人类也很难或不可能解决，但有些特别聪明的谜题，经验丰富的人类解决者可以轻松解决，使用比大多数人工智能程序可以管理的更深入的洞察力。

我自己编写了一个求解器，可以非常快速地解决大多数难题，并且我[对许多其他求解器进行了调查，](http://webpbn.com/survey/)并通过基准结果比较了它们的性能。我还讨论了一类有趣的难题（多米诺难题），它展示了一些对聪明人不难的难题如何证明对大多数程序来说非常困难。我的求解器和多米诺拼图的链接将在调查中找到。

我认为仍有很大的改进空间，并会鼓励有新想法的人尝试一下。但值得注意的是，明显的事情已经做了，再做也没多大用处。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-01T23:04:18.350

确定 Nonogram 解是否存在/是否唯一是 NP-hard。见[http://en.wikipedia.org/wiki/Nonogram#cite_note-0](http://en.wikipedia.org/wiki/Nonogram#cite_note-0)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-02T01:11:32.193

如果您尝试从“最受限制”的行或列中获取信息，它可能会大大减少您的搜索，而不是尝试放置“第一”行，这可能有几个强制值。一个快速的指示是将行/列中的所有值相加并添加 #_of_values - 1，然后查找具有最大此类值的行/列（或此值与行或列数之间的最小差异，如果行和列不同）。因此，如果您有一个 25x25 的拼图，并且其中一行是“5 1 1 6 1 1 3”，则该行的值为 24，这意味着它非常受限制 - 除了一个空白方块之外的所有相对位置在该行中是已知的，并且最后一个空白方块可以位于 8 个不同的相对位置中的任何一个。所以对于每一组实心方块，只有两种可能：额外的空白方块在该组的左侧，或者额外的空白方块在该组的右侧。因此，例如，该组 6 中的五个填充方块是已知的。

一旦您从一个方向获得了一些强制值，就会进一步限制与已知信息相交的另一个方向的任何组。因此，最好的方法可能是随着更多信息的了解，在列和行之间来回工作，这几乎是您需要手动解决它的方式。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-02T08:58:56.453

真正的问题是，是否有人能想出比人类更快地解决上述难题的算法？这对于相对简单的谜题（例如参考谜题）来说很容易，但如果谜题变大，这里的大多数算法都会很快变慢。这是我试图解决的难题。问题是，例如，我相信第 4 行有 2220075 种可能的组合。如果 Charlie 的算法暂时接受了第 3 行的错误行，它将遍历第 4 行的所有这些组合。更不用说算法在第 35 行因为它在第 2 行犯的错误而自相矛盾的情况。

我的算法与约翰的相似。它无法在我的 64 位桌面上以 x86 模式运行。当我将它切换到 64 位模式并让它运行一夜之间时，我的电脑在早上完全无法使用。该过程保留了 8 Gigs 的内存（桌面上的 8 Gigs 物理内存），并且由于疯狂的交换，计算机不会响应。它甚至没有解决所有可能的行。更不用说它甚至没有触及可能的列组合。

```
List<List<int>> rows =
                new List<List<int>>()
                {
                    new List<int> { 8,29,4 },
                    new List<int> { 6,4,25,4,3 },
                    new List<int> { 5,3,2,3,9,4,2,1,3 },
                    new List<int> { 4,2,2,2,2,1,2,2 },
                    new List<int> { 4,1,1,9,10,2,2,1 },
                    new List<int> { 3,2,6,5,5,1,1 },
                    new List<int> { 3,1,5,5,1,1 },
                    new List<int> { 3,1,4,4,1,1 },
                    new List<int> { 3,1,4,4,1,1 },
                    new List<int> { 3,1,3,3,1,1 },
                    new List<int> { 3,1,3,6,2 },
                    new List<int> { 3,1,2,3,2,4,2 },
                    new List<int> { 4,3,1,8,7,1,2,3 },
                    new List<int> { 4,2,1,12,11,1,2,4 },
                    new List<int> { 5,1,2,7,2,2,6,1,1,4 },
                    new List<int> { 4,1,1,1,6,2,2,6,1,2,1,3 },
                    new List<int> { 4,1,1,2,4,3,4,3,1,1,1,1,3 },
                    new List<int> { 4,1,1,2,1,4,1,2,3,2,1,2,2 },
                    new List<int> { 3,1,1,1,2,5,6,1,1,1,3,2 },
                    new List<int> { 3,2,1,1,2,1,5,4,4,2,1,2,1,2 },
                    new List<int> { 3,2,2,1,1,4,2,2,3,1,1,2,1,1,2 },
                    new List<int> { 3,1,3,2,1,1,4,1,5,3,2,1,3,1,2 },
                    new List<int> { 3,1,2,1,2,1,3,7,4,1,4,2,2 },
                    new List<int> { 2,1,4,1,1,1,2,6,2,2,2,3,2,1 },
                    new List<int> { 2,2,4,1,2,1,2,5,2,1,1,3,2,1 },
                    new List<int> { 2,2,1,4,1,1,3,3,2,1,4,4,1 },
                    new List<int> { 2,3,3,2,1,3,3,7,4,1 },
                    new List<int> { 2,3,2,4,5,8,1,2,1 },
                    new List<int> { 1,1,3,11,6,7,1,3,1 },
                    new List<int> { 1,1,2,2,13,10,2,3,2 },
                    new List<int> { 1,2,3,1,6,1,1,7,1,5,2 },
                    new List<int> { 1,1,3,2,6,1,1,1,1,4,1,4,2 },
                    new List<int> { 1,1,6,7,2,4,2,5,6,1 },
                    new List<int> { 1,1,2,3,1,4,2,2,11,2,1 },
                    new List<int> { 1,1,1,1,2,1,5,10,1,1,1 },
                    new List<int> { 1,1,1,1,4,7,4,10,1,1,1 },
                    new List<int> { 1,2,1,1,28,1,1,3 },
                    new List<int> { 1,2,1,2,27,2,1,3 },
                    new List<int> { 1,1,1,1,26,1,1,1,1 },
                    new List<int> { 2,3,1,28,2,1,2,1 }
                };
            List<List<int>> cols =
                new List<List<int>>()
                {
                    new List<int> { 40 },
                    new List<int> { 28,1 },
                    new List<int> { 23,8 },
                    new List<int> { 5,6,7,4 },
                    new List<int> { 3,6,1,9,3,1 },
                    new List<int> { 2,3,2,5,4,2,2 },
                    new List<int> { 1,2,4,1,2,5,2 },
                    new List<int> { 1,1,4,9,2,3,2 },
                    new List<int> { 2,4,2,6,1,4,3 },
                    new List<int> { 1,4,1,3,4,1,6 },
                    new List<int> { 1,4,3,2,3,5,5 },
                    new List<int> { 2,4,1,2,3,4,1,3 },
                    new List<int> { 1,2,3,4,2,2,4,4,1 },
                    new List<int> { 1,1,2,3,2,1,4,2,4 },
                    new List<int> { 2,3,5,3,3,5,4 },
                    new List<int> { 3,1,6,1,2,5,5 },
                    new List<int> { 3,2,6,2,15 },
                    new List<int> { 3,1,8,2,13 },
                    new List<int> { 2,2,4,5,15 },
                    new List<int> { 2,2,2,2,22 },
                    new List<int> { 2,1,1,1,12,6 },
                    new List<int> { 2,1,10,4,5 },
                    new List<int> { 3,1,3,1,2,4 },
                    new List<int> { 3,1,1,4,3,1,4 },
                    new List<int> { 3,2,2,3,2,2,5 },
                    new List<int> { 3,1,1,5,1,1,5 },
                    new List<int> { 3,1,1,5,1,1,5 },
                    new List<int> { 3,1,1,5,1,1,5 },
                    new List<int> { 3,2,5,2,1,1,4 },
                    new List<int> { 3,1,1,3,2,2,4 },
                    new List<int> { 3,1,6,4,5 },
                    new List<int> { 2,2,12,2,6 },
                    new List<int> { 2,2,1,1,22 },
                    new List<int> { 2,1,2,2,5,15 },
                    new List<int> { 3,1,4,3,2,14 },
                    new List<int> { 3,1,7,2,1,13 },
                    new List<int> { 3,2,6,1,1,6,8 },
                    new List<int> { 3,2,5,2,2,4,7 },
                    new List<int> { 2,1,2,4,1,1,1,4,1,4,2 },
                    new List<int> { 1,1,4,4,3,1,4,5,1 },
                    new List<int> { 1,1,5,1,1,2,1,2,2,3,2 },
                    new List<int> { 1,5,2,2,1,5,5,3 },
                    new List<int> { 1,6,2,1,4,2,6,1 },
                    new List<int> { 1,6,2,6,5,2 },
                    new List<int> { 1,5,3,1,9,2 },
                    new List<int> { 2,2,4,2,6,3 },
                    new List<int> { 1,2,2,2,9,2,1 },
                    new List<int> { 3,5,5,8,4 },
                    new List<int> { 4,13,9 },
                    new List<int> { 27,2 }
                }; 
```

*版权归 Tampere Guild of Information Technology / Kaisapais / 一家芬兰啤酒厂所有。*

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-01T22:27:26.427

这似乎是带有回溯的深度优先搜索的一个非常明显的例子，就像“n 个皇后”问题一样。可爱的部分是除了放置行/列之外，您还可以移动块。

好的，这是一个大纲。

1.  从一个空板开始，放置第一行

2.  现在，使用该板，放置第二行，对照列约束检查它。如果通过，则针对该状态递归地尝试下一行；如果没有通过，则尝试该行的下一个可能位置。

3.  如果在任何时候你用完了满足约束的行的可能放置，那么这个谜题就没有解决方案。否则，当您的行数用完时，您就解决了问题。

这些行可以被视为二进制数很方便，因此对可能性有自然的排序。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-01T22:04:19.943

我现在没有足够的时间来充实解决方案，但这就是我要解决的方法。

“function1”在给定顶部或侧面数字的约束条件下确定行或列的可能组合，以及已填充的正方形和已清空的正方形。

“function2”从 function1 获取输出，并在逻辑上将所有结果放在一起 - 可以填充带有 1 的点。

“function3”从 function1 获取输出，并在逻辑上或所有结果一起 - 可以清空带有零的点。

继续将 function2 和 function3 应用于所有行和列，直到没有更多的框被清空或填充。如果谜题解决了，那么你就完成了。

如果这个谜题没有解决，那么取一个可能性最少的行或列，并应用第一个可能性。然后将 function2 和 function3 应用到新板上。如果它导致矛盾（行或列的可能性为 0），则取消应用该可能性并尝试不同的可能性。像这样继续递归，直到找到解决方案。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-07-26T18:24:47.513

几个月前，我在 C++ 上编写了一个非图求解器。它只是寻找阴影和空白单元格的所有允许位置。在每个解决方案步骤中，它都会查看每个位置是否正常。因此，这里是 Chad Birch 的时序非图的结果：http: [//i.stack.imgur.com/aW95s.png](http://i.stack.imgur.com/aW95s.png)。

我也为 Mikko Rantanen 的 nongram 尝试了我的求解器：http: [//i.stack.imgur.com/o1J6I.png](http://i.stack.imgur.com/o1J6I.png)。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-07-02T22:37:32.890

[Steven Simpson](http://www.comp.lancs.ac.uk/~ss/nonogram/)编写了一个非图求解器，可在不同版本中免费使用，包括 JavaScript 脚本。他在该网站上讨论了算法的细节（例如[这里](http://www.comp.lancs.ac.uk/~ss/nonogram/theory)- 基本上，他使用了一系列在速度与完整性之间进行权衡的线解算器，再加上通过猜测所有线解算器何时到达死胡同来分而治之。他也有链接其他方法，它们覆盖的范围比我们这里更多。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-01-04T11:32:29.390

让我指出经典非图谜题的 2 个有趣的转折点：

*   当拼图不仅仅列出占用单元格的长度时。这个公共挑战提前限制了一些细胞被占用： [http ://www.gchq.gov.uk/press_and_media/news_and_features/Pages/Directors-Christmas-puzzle-2015.aspx](http://www.gchq.gov.uk/press_and_media/news_and_features/Pages/Directors-Christmas-puzzle-2015.aspx)

*   当 nonogram 不仅包含空/已占用的单元格，而是使用不同颜色的补丁来占用单元格时。例如见[http://onlinenonograms.com](http://onlinenonograms.com)；通过手动解决这些问题，我觉得这些实际上比常规非图更容易解决。

算法设计者面临的一个特殊挑战是彩色非图从同时考虑水平/垂直约束中受益匪浅。通常的逐行求解器在这里明显处于劣势。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-04-21T17:40:58.043

这是我发现的：

**所有 NP Complete 问题都有相同的感觉。** 解决剩下的 80% 的案例总是很容易的。例如，纳克分解成一条线。可以编写一个例程`solve_one_line(old_state, line_definition, new_state)`来更新关于单行的已知信息，然后继续迭代行和列。然后它在少数情况下失败了，所以你写了一些东西来解决这些情况中的 80%。然后你添加随机数并解决你曾经找到的每一个案例，但有可能构建一个最优的坏案例。

其他遵循这种模式的游戏还有*MineSweeper*和*Soduku*。

**并行思考很难**。例如，您可能会发现，`solve_one_line`如果在一行上运行，上面的例程不会影响另一行，如果在列上运行，则不会影响另一列。

现在你得到：

```
 all_until_completion(rows):
      solve_one_line(...)
  all_until_completion(cols):
      solve_one_line(...) 
```

这使您可以运行 20 个内核（在 20x20 上），而无需数据锁定或任何东西。然后你考虑在显卡上运行，每个单元都有一个处理器。然后你会注意到已经过去了多少时间。

有一次我在看现代计算机科学教科书时觉得自己老了，其中*O(n)*表示法被*O(n, p)*表示法取代，因为没有人愿意为单个处理器评估算法。*8 个皇后解决方案*是一种出色的快速递归算法，具有快速失败、高效的内存使用，并且仅在一个处理器上运行。

**问题是玩的好借口**。磨出更多相同的东西会很无聊。查看您可能需要更多经验的技术列表：行为驱动测试；依赖注入；纯函数式编程；神经网络；遗传算法；快速、马虎和失控；GPGPU；光学字符识别；以实例为导向的学习；众包；等等。选择一个并尝试以某种方式使用它来解决问题。有时目标不是解决问题，而是在未知的领域徘徊。

**贡献一些东西。*** 这可以像一篇文章一样简单。更好的可能是数百纳克的存储库，以便其他人可以玩。 *[让我知道是否存在存储库，否则我会创建一个]。* 一旦你有一些你觉得很整洁的东西，就开始贡献。注意克林贡语： *也许今天**是**死的好日子；我说我们发货。*

因此，为 NP 问题编写奇异的并行解决方案并分享它们。祝你有美好的一天！

# javascript - 将 JSON 对象转换为嵌套表单字段？

> ID：813370
> 
> 赞同：2
> 
> 时间：2009-05-01T21:22:39.047
> 
> 标签：javascript, jquery, json

任何人都知道将 JSON 对象转换为嵌套表单字段的好方法。

例如：考虑一个 JSON 对象：

```
{'a':{'b':{'c':'1200'}}}, 'z':'foo', 'bar':{'baz':'1', 'id':2}} 
```

我应该得到：

```
{'a[b][c]':'1200', 'z':'foo', 'bar[baz]':'1', 'bar[id]':2}; 
```

有任何想法吗？

我目前正在使用 jquery，感觉像这样的东西已经存在，如果没有，我可以简单地用一个疯狂的算法自己动手，但我宁愿使用有良好记录的东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-01T23:14:30.167

所以，我不知道你为什么要做你说你想做的事，我希望你能把我们都填满，但是这段代码应该足够接近你可以调整它（这是基于[**一些我用来查找 JavaScript 对象图差异的代码**](https://stackoverflow.com/questions/264430/how-can-i-get-a-list-of-the-differences-between-two-javascript-object-graphs)）：

```
function doStrangeThing(obj) {
   var propertyChanges = [];
    var objectGraphPath = [];
    (function(obj, refObj) {
        if ( obj.constructor == Object || (obj.constructor != Number &&
             obj.constructor != String && obj.constructor != Date && obj.constructor != Boolean &&
             obj.constructor != RegExp && obj.constructor != Function)) {
            for (var property in obj) {
                objectGraphPath.push((objectGraphPath.length > 0) ? "[" + property + "]" : property);
                if (obj[property].constructor != Function) {
                    if (!refObj[property]) refObj[property] = {};
                    arguments.callee(obj[property], refObj[property]);
                }
                objectGraphPath.pop();
            }
        } else if (obj.constructor != Function) {
            if (obj != refObj) {
                propertyChanges.push("\"" + objectGraphPath.join("") + "\":\"" + obj.toString() + "\"");
            }
        }
    })(obj, {});
    return "{" + propertyChanges.join(",") + "}";
} 
```

这是我为测试它所做的：

```
doStrangeThing({'a':{'b':{'c':'1200'}}, 'z':'foo', 'bar':{'baz':'1', 'id':2}}); 
```

这导致了这个值：

```
{"a[b][c]":"1200","z":"foo","bar[baz]":"1","bar[id]":"2"} 
```

希望在某种程度上对您有用...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-02T08:57:03.900

```
obj = {'a':{'b':{'c':'1200'}}}, 'z':'foo', 'bar':{'baz':'1', 'id':2}} 
```

内部等价于

```
{['a']['b']['c']:'1200', ['z']:'foo', ['bar']['baz']:'1', ['bar']['id']:2} 
```

请注意，这不再是 JSON 对象。

您已经可以通过这种方式引用第一个对象属性：

```
var z = obj['a']['b']['c']   // 1200 
```

是否足以满足您的需求？您真的想将属性名称转换为变量吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-02T11:12:00.677

我实际上会推荐一个函数，它接受一个嵌套的 JSON 对象并将其转换为 HTTP POST 字符串。jQuery 将接受它的所有需要​​ HTTP 参数的参数。

我已经在几个生产应用程序中编写并使用了以下功能（使用风险自负）：

```
$.httpSerialize = function(items, parentName) {
    var serializedItems = [], serialize = arguments.callee, encodeItem =     function(key, value) {
        if (value === null || typeof value == 'undefined') return value;
        if (value.constructor == Array) {return serialize(value, key);}
        return (value.constructor == Object)
            ? serialize(value, key)
            : (value === true || value === false)
                ? key+"="+new Number(value)
                : key+"="+encodeURIComponent(value);
    };

    if (items.constructor == Array) {
        parentName = parentName || 'item';
        for (var i = 0; i < items.length; i++) {
            var key = parentName+'['+i+']', value = items[i];
            serializedItems.push(encodeItem(key, value));
        }
    } else {
        parentName = parentName || '';
        for (var key in items) {
            var value = items[key];
            if (parentName) {
                serializedItems.push(encodeItem(parentName+'['+encodeURIComponent(key)+']', value));
            } else {
                serializedItems.push(encodeItem(encodeURIComponent(key), value));
            }
        }
    }
    return serializedItems.join("&");
}; 
```

# solr - 多语言 Solr 搜索索引

> ID：813374
> 
> 赞同：1
> 
> 时间：2009-05-01T21:22:51.573
> 
> 标签：solr

我正在建立一个 Solr 搜索引擎，它将索引多种语言。我创建了一个自定义 UpdateProcessorFactory 来确定输入文本的哪些部分是哪种语言，然后我将文档的这些部分复制到特定于语言的字段中。例如，使用此文本：

“你好世界，你好世界，你好世界。”

它将“Hello World”复制到 en-text 字段中，将“Bonjour le Monde”复制到 fr-text 字段中，并将“Hallo Welt”复制到 de-text 字段中。每个字段都有适当的语言分析器来标记和词干单词。

最后，我希望有一个框供用户输入可以搜索所有语言的搜索词。搜索词不需要翻译，但应该适当地词干。实现这一目标的最佳方法是什么？我也非常关心搜索的性能。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-02T01:26:20.177

最好的方法是使用[DisMaxRequestHandler](http://wiki.apache.org/solr/DisMaxRequestHandler)。它将针对适当的语言（如 schema.xml 中定义）适当地分析每个字段。

因此，如果您的查询看起来像 /solr/select?qt=dismax&qf=en-text%20fr-text%20de-text&q=hello%world Solr 会做正确的事情。

（假设您在 solrconfig.xml 的 requestHandler 块中将 dismax 配置为 solr.DisMaxRequestHandler）

大多数分析速度很快。您的性能界限主要取决于您的索引大小、总术语数等。请务必根据 wiki 上的 solr 性能指南调整所有内容。我目前正在运行一个 60GB 的索引，并继续在不那么花哨的硬件上获得低于 100 毫秒范围内的搜索。

# visual-studio - 如何导出和导入 Visual Studio 宏？

> ID：813380
> 
> 赞同：6
> 
> 时间：2009-05-01T21:25:07.527
> 
> 标签：visual-studio

我想导出我定义的一些宏，并能够将它们导入另一个全新安装的 Visual Studio，并使用我定义的相同模块/命名结构。

我有一些执行我的宏的菜单命令自定义 - 所以要在另一个安装的 Visual Studio 中工作，它需要可用的相同宏。

我想避免手动创建宏并复制/粘贴我的宏代码的手动步骤。

这可能吗？似乎“宏”不是通过菜单*Tools* -> *Import and Export Settings*导入/导出的可用选项。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-01T21:32:55.900

工具->宏->宏 IDE...（或 Alt+F11）

导出：展开宏，直到找到要导出的模块，右键单击它，选择导出模块名称...，选择一个文件，然后保存。

导入：选择“MyMacros”或任何其他，右键单击它，然后选择 Add->Add Existing Item... 选择刚刚创建的文件，然后添加。

# javascript - 如何在 JavaScript 中使用参数值数组而不是将它们列出来构造对象？

> ID：813383
> 
> 赞同：11
> 
> 时间：2009-05-01T21:25:51.287
> 
> 标签：javascript, oop, firefox-addon, new-operator, apply

这可能吗？我正在创建一个基本工厂函数来驱动不同类型的工厂（但有一些相似之处），并且我希望能够将参数作为数组传递给基本工厂，然后它可能会创建一个新对象的实例来填充参数通过数组的相关类的构造函数。

在 JavaScript 中，可以通过 apply 方法使用数组来调用具有多个参数的函数：

```
namespace.myFunc = function(arg1, arg2) { //do something; }
var result = namespace.myFunc("arg1","arg2");
//this is the same as above:
var r = [ "arg1","arg2" ];
var result = myFunc.apply(namespace, r); 
```

似乎无论如何都没有使用 apply 创建对象的实例，是吗？

类似的东西（这不起作用）：

```
var instance = new MyClass.apply(namespace, r); 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-01T21:35:01.543

试试这个：

```
var instance = {};
MyClass.apply( instance, r); 
```

关键字“new”所做的只是将一个新对象传递给构造函数，然后该对象成为构造函数中的 this 变量。

根据构造函数的编写方式，您可能必须这样做：

```
var instance = {};
var returned = MyClass.apply( instance, args);
if( returned != null) {
    instance = returned;
} 
```

更新：评论说如果有原型，这不起作用。试试这个。

```
function newApply(class, args) {
    function F() {
        return class.apply(this, args);
    }
    F.prototype = class.prototype;
    return new F();
}

newApply( MyClass, args); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-10-19T16:37:43.103

注意

*   ```
    new myClass() 
    ```

    没有任何参数可能会失败，因为构造函数可能依赖于参数的存在。

*   ```
    myClass.apply(something, args) 
    ```

    在许多情况下会失败，尤其是在 Date 或 Number 等本地类上调用时。

我知道“eval 是邪恶的”，但在这种情况下，您可能想尝试以下方法：

```
function newApply(Cls, args) {
    var argsWrapper = [];
    for (var i = 0; i < args.length; i++) {
        argsWrapper.push('args[' + i + ']');
    }
    eval('var inst = new Cls(' + argsWrapper.join(',') + ');' );
    return inst;
} 
```

就那么简单。

（它的工作原理与[此博客文章](http://webreflection.blogspot.com/2007/05/joking-with-javascript-constructors.html)`Instance.New`中的相同）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-02T01:58:31.940

Hacks are hacks are hacks，但也许这个比其他一些更优雅，因为调用语法与你想要的相似，你根本不需要修改原始类：

```
Function.prototype.build = function(parameterArray) {
    var functionNameResults = (/function (.{1,})\(/).exec(this.toString());
    var constructorName = (functionNameResults && functionNameResults.length > 1) ? functionNameResults[1] : "";
    var builtObject = null;
    if(constructorName != "") {
       var parameterNameValues = {}, parameterNames = [];
       for(var i = 0; i < parameterArray.length; i++) {
         var parameterName = ("p_" + i);
         parameterNameValues[parameterName] = parameterArray[i];
         parameterNames.push(("parameterNameValues." + parameterName));
       }
       builtObject = (new Function("parameterNameValues", "return new " + constructorName + "(" + parameterNames.join(",") + ");"))(parameterNameValues);
    }
    return builtObject;
}; 
```

现在您可以执行以下任一操作来构建对象：

```
var instance1 = MyClass.build(["arg1","arg2"]);
var instance2 = new MyClass("arg1","arg2"); 
```

当然，有些人可能不喜欢修改 Function 对象的原型，因此您可以这样做并将其用作函数：

```
function build(constructorFunction, parameterArray) {
    var functionNameResults = (/function (.{1,})\(/).exec(constructorFunction.toString());
    var constructorName = (functionNameResults && functionNameResults.length > 1) ? functionNameResults[1] : "";
    var builtObject = null;
    if(constructorName != "") {
       var parameterNameValues = {}, parameterNames = [];
       for(var i = 0; i < parameterArray.length; i++) {
         var parameterName = ("p_" + i);
         parameterNameValues[parameterName] = parameterArray[i];
         parameterNames.push(("parameterNameValues." + parameterName));
       }
       builtObject = (new Function("parameterNameValues", "return new " + constructorName + "(" + parameterNames.join(",") + ");"))(parameterNameValues);
    }
    return builtObject;
}; 
```

然后你会这样称呼它：

```
var instance1 = build(MyClass, ["arg1","arg2"]); 
```

所以，我希望这些对某人有用 - 它们允许您不理会原始构造函数，并在一行简单的代码中获得您所追求的（与当前选择的解决方案/解决方法所需的两行不同。

欢迎和赞赏反馈。

* * *

更新：要注意的另一件事 - 尝试使用这些不同的方法创建相同类型的实例，然后检查它们的构造函数属性是否相同 - 如果您需要检查类型目的。下面的代码最好地说明了我的意思：

```
function Person(firstName, lastName) {
   this.FirstName = firstName;
   this.LastName = lastName;
}

var p1 = new Person("John", "Doe");
var p2 = Person.build(["Sara", "Lee"]);

var areSameType = (p1.constructor == p2.constructor); 
```

尝试使用其他一些技巧，看看会发生什么。理想情况下，您希望它们是同一类型。

* * *

警告：如评论中所述，这不适用于那些使用匿名函数语法创建的构造函数，即

```
MyNamespace.SomeClass = function() { /*...*/ }; 
```

*除非*你像这样创建它们：

```
MyNamespace.SomeClass = function SomeClass() { /*...*/ }; 
```

我上面提供的解决方案可能对您有用，也可能对您没有用，您需要准确了解您正在做什么才能为您的特定需求找到最佳解决方案，并且您需要了解我的解决方案正在发生的事情“工作。” 如果您不了解我的解决方案是如何工作的，请花时间弄清楚。

* * *

替代解决方案：没有一个可以忽略其他选项，这是您可以给这只猫剥皮的其他方法之一（与上述方法类似的警告），这个更深奥一点：

```
function partial(func/*, 0..n args */) {
   var args = Array.prototype.slice.call(arguments, 1);
   return function() {
      var allArguments = args.concat(Array.prototype.slice.call(arguments));
      return func.apply(this, allArguments);
   };
}

Function.prototype.build = function(args) {
   var constructor = this;
   for(var i = 0; i < args.length; i++) {
      constructor = partial(constructor, args[i]);
   }
   constructor.prototype = this.prototype;
   var builtObject = new constructor();
   builtObject.constructor = this;
   return builtObject;
}; 
```

享受！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-01T21:41:28.097

解决方法呢？

```
function MyClass(arg1, arg2) {

    this.init = function(arg1, arg2){
        //if(arg1 and arg2 not null) do stuff with args
    }

    init(arg1, arg2);
} 
```

那么你可以如何：

```
var obj = new MyClass();
obj.apply(obj, args); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-01T21:55:06.333

一种可能性是使构造函数像普通函数调用一样工作。

```
function MyClass(arg1, arg2) {
    if (!(this instanceof MyClass)) {
        return new MyClass(arg1, arg2);
    }

    // normal constructor here
} 
```

如果您作为普通函数调用（包括/只要参数不是 a ） ，则`if`语句上的条件将为真。`MyClass``call``apply``this``MyClass object`

现在所有这些都是等价的：

```
new MyClass(arg1, arg2);
MyClass(arg1, arg2);
MyClass.call(null, arg1, arg2);
MyClass.apply(null, [arg1, arg2]); 
```

# linux - 从零开始强化 BSD

> ID：813385
> 
> 赞同：1
> 
> 时间：2009-05-01T21:27:02.267
> 
> 标签：linux, operating-system, kernel, freebsd, bsd

我知道[Hardened Linux from Scratch](http://www.linuxfromscratch.org/hlfs/)项目，该项目为您提供了完全从源代码构建您自己的定制和强化 Linux 系统的分步说明。我想知道BSD中的等价物是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-01T22:14:01.670

正如 Richard 所说，OpenBSD 绝对值得一试，对于防火墙和网关专用的一切，它是我的第一选择。对于其他服务，我倾向于坚持使用 FreeBSD，尽管没有明显的原因，这只是个人喜好。

但我想指出，如果您想要更安全地托管服务，那么使用[Jails](http://www.freebsd.org/doc/en_US.ISO8859-1/books/handbook/jails.html)可以更好地完成“从头开始”的概念。实质上，您在完整的 FreeBSD 安装上创建了一个受限的 FreeBSD 环境。在那个有限的环境中，您只复制/链接服务需要运行的那些二进制文件和文件。

因为托管服务无法访问任何其他文件/二进制文件，所以这些东西中的所有潜在安全漏洞都不会被利用。如果您的应用程序偶然被“扎根”，它不会超出监狱的界限。

将其视为类固醇沙盒，性能损失可忽略不计。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-01T21:29:08.330

OpenBSD 在“默认情况下”从安装中得到强化。只有管​​理员打开它...逐个组件。

[更新] 虽然我还没有阅读加固 linux 的文档……但可能适用一些相同的事情……例如，它们都使用 OpenSSH，因此策略是相同的。因此，如果有模块重叠，同样适用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-03T05:51:54.837

你并没有真正从头开始做 bsd。所有主要项目都在单一源代码库中提供了一个完整的系统，因此您无需从这里获取内核，从那里获取 binutils 和编译器，从其他地方获取 c 库和标准实用程序，从另一个地方获取 X。

与一般的 Linux 发行版相比，它们通常更容易获得所有源代码并重建整个系统，但这并不是真正定制任何东西。

您可以尝试做一些疯狂的事情，例如尝试让 OpenBSD 用户空间在带有 FreeBSD 端口的 NetBSD 内核上运行，但您只能靠自己，而且它肯定不会被“强化”。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-06-26T19:41:54.617

HardenedBSD 是 FreeBSD 项目的一个分支，旨在实现 PIE、RELRO、SAFESTACK、CFIHARDEN。有些目标在那里，有些则是极端的在制品。我不认为它是“准备好生产”，但可以用作桌面（也取决于生产环境要求）。

回购：[https ://github.com/HardenedBSD](https://github.com/HardenedBSD)

包括“make buildworld/buildkernel”在内的所有内容都与 FreeBSD 上的相同，并且手册很好地解释了这一点。即使来自 linux-land，您也需要阅读一些内容。构建自己的端口本身就是一个完整的主题。

重新入狱，这个说法并不完全正确。虽然肯定会添加一个重要的安全层，但 Unix 系统（关于 Linux 的 IDK）[在此处引用]“缺乏内核漏洞缓解措施。如果攻击者获得了对监狱的访问权，那么转向其他监狱或通过内核提升权限并不是太多工作开发。” 不要误会我，我几乎把所有的服务都放在监狱里。

至于“默认硬化”评论：这一切都在 sysctl 设置中，可以在每个 *BSD 风格上进行调整，但如果系统管理员不花时间阅读文档，那么安全措施几乎毫无用处。

如果你有兴趣，你的功课：[https ://www.freebsd.org/doc/handbook/](https://www.freebsd.org/doc/handbook/)

# wpf - 如何在 WPF 中捕获 Ctrl + Tab 和 Ctrl + Shift + Tab？

> ID：813389
> 
> 赞同：67
> 
> 时间：2009-05-01T21:28:59.407
> 
> 标签：wpf, tabs, key-bindings, ctrl

将捕获 WPF 应用程序的 + 和 ++ 的一些示例`Ctrl`代码`Tab`是`Ctrl`什么？`Shift``Tab`

我们已经创建了`KeyDown`事件，还尝试使用输入手势添加命令绑定，但我们从未能够捕获这两个快捷方式。

* * *

## 回答 #1

> 赞同：96
> 
> 时间：2009-05-01T21:40:09.677

你有什么 KeyDown 处理程序？下面的代码对我有用。给我带来麻烦的是：`Alt`+ `Tab`，但您没有要求：D

```
public Window1()
{
   InitializeComponent();
   AddHandler(Keyboard.KeyDownEvent, (KeyEventHandler)HandleKeyDownEvent);
}

private void HandleKeyDownEvent(object sender, KeyEventArgs e)
{
   if (e.Key == Key.Tab && (Keyboard.Modifiers & (ModifierKeys.Control | ModifierKeys.Shift)) == (ModifierKeys.Control | ModifierKeys.Shift))
   {
      MessageBox.Show("CTRL + SHIFT + TAB trapped");
   }

   if (e.Key == Key.Tab && (Keyboard.Modifiers & ModifierKeys.Control) == ModifierKeys.Control)
   {
      MessageBox.Show("CTRL + TAB trapped");
   }
} 
```

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2010-05-25T23:20:09.067

古斯塔沃的回答正是我想要的。我们想要验证输入键，但仍然允许粘贴：

```
protected override void OnPreviewKeyDown(KeyEventArgs e)
{
   if ((e.Key == Key.V || e.Key == Key.X || e.Key == Key.C) && Keyboard.IsKeyDown(Key.LeftCtrl))
      return;
} 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-04T16:35:52.080

You have to use **`KeyUp`** event, not `KeyDown`...

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2016-11-18T12:40:25.337

**Szymon Rozga**答案的工作版本（抱歉，我无法发表评论）。我们不看 Alt，但它的会计可以简单地添加，**如果**

```
 public View()
  {
     InitializeComponent();
     AddHandler(Keyboard.PreviewKeyDownEvent, (KeyEventHandler)controlKeyDownEvent);
  }

  private void controlKeyDownEvent(object sender, KeyEventArgs e)
  {
     if (e.Key == Key.Tab && Keyboard.Modifiers.HasFlag(ModifierKeys.Control))
     {
        if (Keyboard.Modifiers.HasFlag(ModifierKeys.Shift))
           MessageBox.Show("CTRL + SHIFT + TAB trapped");
        else
           MessageBox.Show("CTRL + TAB trapped");
     }
  } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-05-17T09:59:10.367

嗨，您可以在 keydown 事件中使用它

```
 private void OnButtonKeyDown(object sender, KeyEventArgs e)
    {
        if(Keyboard.IsKeyDown(Key.LeftCtrl) && Keyboard.IsKeyDown(Key.Tab) && Keyboard.IsKeyDown(Key.LeftShift))
        {
           //
           // TODO: somthing here
           //
        }
    } 
```

# sql-server - 为什么合并复制在设置表的 LOCK_ESCALATION 时会失败？

> ID：813403
> 
> 赞同：3
> 
> 时间：2009-05-01T21:35:04.353
> 
> 标签：sql-server, sql-server-2008, replication

我们遇到了合并复制的问题。我们的发布者运行 SQL Server 2008，而我们的两个订阅者运行 2005。我们的发布者正在尝试向我们的订阅者发送`ALTER TABLE Foo SET (LOCK_ESCALATION)`命令。我想我记得读过这个命令是 SQL Server 2008 中的新命令，如果是这样，那么该命令在我们的 2005 服务器上会失败是有道理的。但是，我们的合并复制设置为与 2005 兼容。

> 架构脚本 'if object_id(N'[dbo].[Users]') is not null exec('ALTER TABLE [dbo].[Users] SET (LOCK_ESCALATION = TABLE) ')' 无法传播给订阅者。

关于为什么我们的出版商会尝试这样做的任何想法？

**编辑：**我们 2008 服务器的兼容级别设置为“Sql Server 2005 (90)”

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-01T21:45:42.720

它是 sql 2008 中的一项新功能，因此在 2005 年不受支持。根据您的设置的复杂程度，您可能需要考虑让您的数据库在兼容性 90 (sql 2005) 下运行，以确保您不会将 sql 2008 功能添加到您的数据库中。自从模式数据复制出现以来，它就一直存在着很大的问题，所以总是有点沉默寡言。我总是试图让它变得愚蠢并只管理数据 - 必须支持具有 32 个订阅者的合并系统和合并复制，并且当我们推动模式更改时不断遇到大模式问题。

也就是说，如果它按记录工作，它不应该试图推动你的锁更改。检查订阅是否标记为 sql 2005 兼容。他们可能没有像他们为数据类型所做的那样创建 2008 年到 2005 年的设置的自动映射（例如）

不久前，一位 SQL 开发人员[在博客](http://blogs.technet.com/josebda/archive/2009/03/19/sql-server-2008-locking.aspx)上发表了关于新锁定类型的文章

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-02-26T17:02:02.940

发生这种情况是因为该指令与 sql server 2005 不兼容，而且当我在正在复制的表中进行架构更改时，显然会将此指令放入架构更改中。

有两种方法：删除并重新创建订阅，不适用于生产服务器。第二种方法是转到数据库中的**sysmergeschemachange**表并删除具有以下内容的行：

> 架构脚本 'if object_id(N'[dbo].[Users]') is not null exec('ALTER TABLE [dbo].[Users] SET (LOCK_ESCALATION = TABLE) ')' 无法传播给订阅者。

我希望这有帮助。

# redhat - Red Hat Enterprise 5 显示模式检测问题

> ID：813408
> 
> 赞同：0
> 
> 时间：2009-05-01T21:36:26.750
> 
> 标签：redhat

我在我的 HP 550 笔记本电脑上安装了 Red Hat，但显示分辨率不适合我笔记本电脑的显示器。我的显示器在 Windows 7 上运行良好，它是 1280 x 800，一旦我进入 RedHat，我看到的屏幕就像一个盒子，不适合我笔记本电脑的整个显示器，我使用 root 密码登录并尝试更改 X 显示设置但是只有一个设置——1024x700——我不能改变它。

导致这种情况的问题可能是什么？

亲切的问候，
——A.Xheladini

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-02T00:34:40.520

你真的应该尝试一个 Linux 论坛来解决这个问题，但[这里有一个页面可以帮助你](http://forums.whirlpool.net.au/forum-replies-archive.cfm/777575.html)

# visual-studio - 为什么 VS 2008 sp1 在 Win7 RC 上安装 abort？

> ID：813413
> 
> 赞同：17
> 
> 时间：2009-05-01T21:39:19.210
> 
> 标签：visual-studio, visual-studio-2008, windows-7

在 Windows 7 RC 中安装 Visual Studio 2008 sp1 时遇到以下错误怎么办？

```
Operation Aborted 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T00:43:55.987

在 Windows 7 RC 7100 上安装 Visual Studio 2008 SP1 时，以管理员身份运行：

```
reg delete HKLM\SOFTWARE\Microsoft\SQMClient\Windows\DisabledSessions /va /f 
```

之后 Visual Studio 2008 SP1 将正确安装。

**我从原始问题中复制了这个，只是为了使它成为一个正确的问题/答案......标记为社区维基**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T00:59:06.293

在将 sp1 安装到 Visual Studio 08 之前[下载并安装此更新](http://www.microsoft.com/downloads/details.aspx?FamilyID=d8eb4921-891a-4b5e-973f-0b96e6ccf376&DisplayLang=en)

# django - 表单初始化后Django设置字段值

> ID：813418
> 
> 赞同：132
> 
> 时间：2009-05-01T21:39:47.447
> 
> 标签：django

我试图在表单初始化后将该字段设置为某个值。

例如，我有以下课程。

```
class CustomForm(forms.Form):
    Email = forms.EmailField(min_length=1, max_length=200) 
```

在视图中，我希望能够做这样的事情：

```
form = CustomForm()
form["Email"] = GetEmailString()

return HttpResponse(t.render(c)) 
```

* * *

## 回答 #1

> 赞同：158
> 
> 时间：2009-05-01T21:58:13.907

由于您没有传递 POST 数据，因此我假设您尝试做的是设置一个将在表单中显示的初始值。你这样做的方式是使用`initial`关键字。

```
form = CustomForm(initial={'Email': GetEmailString()}) 
```

有关更多说明，请参阅[Django 表单文档](http://docs.djangoproject.com/en/dev/ref/forms/api/#dynamic-initial-values)。

如果您在提交表单后尝试更改值，则可以使用以下内容：

```
if form.is_valid():
    form.cleaned_data['Email'] = GetEmailString() 
```

查看上面引用的文档以了解更多关于使用的信息`cleaned_data`

* * *

## 回答 #2

> 赞同：100
> 
> 时间：2012-05-24T22:59:08.633

如果您已经初始化了表单，则可以使用该字段的初始属性。例如，

```
form = CustomForm()
form.fields["Email"].initial = GetEmailString() 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2015-08-25T11:14:16.627

`__init__`如果您出于某种原因想在表单的方法中执行此操作，则可以操作`initial`dict：

```
class MyForm(forms.Form):
    my_field = forms.CharField(max_length=255)

    def __init__(self, *args, **kwargs):
        super(MyForm, self).__init__(*args, **kwargs)
        self.initial['my_field'] = 'Initial value' 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2013-11-26T21:16:57.087

如果您将数据添加到收集的表单数据集的*副本*中，那么像 Nigel Cohen 之类的东西会起作用：

```
form = FormType(request.POST)
if request.method == "POST":
    formcopy = form(request.POST.copy())
    formcopy.data['Email'] = GetEmailString() 
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2019-01-24T10:57:52.700

如果您已经像这样初始化表单

```
form = CustomForm() 
```

那么截至**2019 年 1 月**的正确方法是使用`.initial`替换数据。这将替换`intial`与表单一起使用的字典中的数据。如果您使用某些实例进行初始化，它也可以工作，例如 `form = CustomForm(instance=instance)`

要替换表单中的数据，您需要

```
form.initial['Email'] = GetEmailString() 
```

概括这将是，

```
form.initial['field_name'] = new_value 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2016-09-22T12:37:22.910

只需更改您的 Form.data 字段：

```
class ChooseProjectForm(forms.Form):
    project = forms.ModelChoiceField(queryset=project_qs)
    my_projects = forms.BooleanField()

    def __init__(self, *args, **kwargs):
        super(ChooseProjectForm, self).__init__(*args, **kwargs)
        self.data = self.data.copy()  # IMPORTANT, self.data is immutable
        # any condition:
        if self.data.get('my_projects'):
            my_projects = self.fields['project'].queryset.filter(my=True)
            self.fields['project'].queryset = my_projects
            self.fields['project'].initial = my_projects.first().pk
            self.fields['project'].empty_label = None  # disable "-----"
            self.data.update(project=my_projects.first().pk)  # Update Form data
            self.fields['project'].widget = forms.HiddenInput()  # Hide if you want 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-11-01T10:59:27.830

再加入另一种方式：这也有效，带有更现代的符号。它只是解决了 a 是不可变的事实`QueryDict`。

```
>>> the_form.data = {**f.data.dict(), 'some_field': 47}
>>> the_form['some_field'].as_widget()
'<input type="hidden" name="some_field" value="47"
        class="field-some_field" id="id_some_field">' 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-05-20T14:31:09.847

在小部件中使用“值”属性。例子：

```
username = forms.CharField(
    required=False,
    widget=forms.TextInput(attrs={'readonly': True, 'value': 'CONSTANT_VALUE'}),
) 
```

* * *

## 回答 #9

> 赞同：-11
> 
> 时间：2011-04-04T15:43:01.823

另一种方法是，如果您已经初始化了一个表单（有或没有数据），并且您需要在显示之前添加更多数据：

```
form = Form(request.POST.form)
form.data['Email'] = GetEmailString() 
```

# css - 您如何解决 IE 不支持 :after 的问题？

> ID：813419
> 
> 赞同：2
> 
> 时间：2009-05-01T21:39:47.600
> 
> 标签：css, internet-explorer, css-selectors

我有一堆清单

```
<ul>
  <li class="first">Item 1</li>
  <li>Item 2</li>
  <li class="last">Item 3</li>
</ul> 
```

风格与

```
li:after {
  content: ' / ';
}
li.last:after {
  content: '';
} 
```

这一定是个老生常谈的问题。我想我可以弄乱 html 并放入`<li>`包含该字符的中介，或者如果 IE 是加载浏览器，我可以挂上一个 javascript 将它们放在那里，但这不会抓住没有 javascript 的人。伊诺。我倾向于使 html 混乱，但我想听听是否对此有一些意见。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-02T13:53:34.000

**Internet Explorer** (IE)**不支持 :after 选择器**，**我们必须使用一些技巧来代替**，例如这个：

```
li { scrollbar-face-color: expression(!this.isInserted==true ? this.isInserted=(this.innerHTML = '' + this.innerHTML + 'xkcd150') : ''); } 
```

“xkcd150” - 这个将在每个`<li>`.

它是一个表达式，通常用于替换和修复一些 IE 错误。

所以，**完整的代码**是：

```
li { scrollbar-face-color: expression(!this.isInserted==true ? this.isInserted=(this.innerHTML = '' + this.innerHTML + ' / ') : ''); }

li.last {
scrollbar-face-color: expression(!this.isInserted==true ? this.isInserted=(this.innerHTML = '' + this.innerHTML + '') : ''); } 
```

第一行添加“/”，第二行用于不添加任何内容。

**所有代码都必须添加到您的 css 文件中。**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-01T21:43:44.067

这是一个你不会喜欢的想法。8-) 将您的 / 符号作为背景图像放入`<li>`s 的右侧填充中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-01T21:50:38.807

1.  使用[IE7.js](http://dean.edwards.name/IE7/) hack 添加伪元素支持。
2.  使用条件注释添加到标记以模拟该效果或删除一些现有样式以使其在没有分隔符的情况下更易于阅读 - 例如，让列表项堆叠在条件注释的样式表中
3.  通过重新排列样式允许 IE6 优雅地降级，这样就不会发生这种情况，即使它在其他浏览器中看起来不同。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-01T21:43:13.910

我只是在生成列表 HTML 时使用服务器端语言来完成。我想这会被认为是“混乱的 HTML”。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-02T08:06:51.493

我使用 javascript 和条件注释。即使用jQuery。

```
 <!--[if IE 6]>
   <script type='text/javascript'>
     $(document).ready( function() {
      $('li').not('li.last').after('/');
     });
   </script>
 <![endif]--> 
```

使用单独的 JS 文件当然更好。
这也有一个缺点，你必须把所有的东西都写两次，因为你把它放在 CSS 中用于好的浏览器，然后再放在 javascript 中用于 IE6。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-02T16:53:19.887

尝试使用类似 jQuery 的东西。

`$(函数(){

$('li').not(':last-child').append('\'');

});`

它不会弄乱html。此外，要使其仅适用于 IE，请尝试使用 jquery 兼容性。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-03-25T22:40:42.300

如果您的内容不打算在运行时更改，您可以使用以下内容：

```
.icon-glass {
  *zoom: expression( this.runtimeStyle['zoom'] = '1', this.innerHTML = '&#xf000;');
} 
```

如果您的内容打算在运行时更改，您可以执行以下操作：

```
.icon-glass {
  *top:expression(0, this.innerHTML = '&#xf000;');
} 
```

不幸的是，这非常慢。虽然它可能在 IE6 中工作，但会显着降低性能，但如果页面上有太多图标，IE7 可能会崩溃。所以我不会推荐第二种技术，除非你只使用很少的图标并且你可以承受性能下降。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-05-01T21:57:10.697

如果 IE 支持 last-child 你就不需要 class="last" :P。

IE 支持已经并将继续是垃圾。IE 8 已经做出了巨大的改进， :after 和 :before 正如你所期望的那样工作，IE 7 也支持它们。只针对这两个，特别是因为微软正在通过 Windows 更新推出 IE 8。

# asp-classic - Asp Classic 包含一次

> ID：813426
> 
> 赞同：16
> 
> 时间：2009-05-01T21:42:18.750
> 
> 标签：asp-classic, include

ASP Classic 是否具有与 PHP 的“包含一次”功能等效的功能？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2010-05-26T20:45:59.207

我知道这是一个老话题，但我想我会加两分钱，以防有人感兴趣。

我写了一个函数，它完全符合你的要求：无论调用多少次，都将给定的文件完全包含在一个文件中。

```
class ImportFunction
    private libraries_
    private fso_

    private sub CLASS_INITIALIZE
        set libraries_ = Server.createObject("Scripting.Dictionary")
        set fso_ = Server.createObject("Scripting.FileSystemObject")
    end sub

    public default property get func (path)
        if not libraries_.exists(path) then

            on error resume next
            with fso_.openTextFile(path)
                executeGlobal .readAll
                if Err.number <> 0 then 
                    Response.write "Error importing library "
                    Response.write path & "<br>"
                    Response.write Err.source & ": " & Err.description
                end if
            end with
            on error goto 0

            libraries_.add path, null
        end if
    end property
end class
dim import: set import = new ImportFunction 
```

笔记：

*   这使用了一个用默认属性模拟的仿函数。如果这让您感到困扰，它很容易重构。
*   字典必须通过所有包含持久化，而持久化 fso 只是避免重建它。如果您不喜欢在导入完成后保留它们的想法，您可以修改类以获得如下语法：

    ```
    with new Importer
        .import "foo"
        .import "bar/baz"
    end with 
    ```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-01T21:51:31.987

不，对不起。你必须管理包括你自己。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-12-18T17:55:26.363

感谢 Thom Smith 提供的一段代码。

下面是基于您的版本来处理 UTF8 源文件（以及谁管理打开和关闭 ASP 标签）。

```
Dim IncludeOnce
Class IncludeOnceClass

    Private libraries_
    Private adostream_

    Private Sub CLASS_INITIALIZE
        Set libraries_ = Server.createObject("Scripting.Dictionary")
        Set adostream_ = CreateObject("ADODB.Stream")
        adostream_.CharSet = "utf-8"
        adostream_.Open
    End Sub

    Public Default Property Get includeFile (path)
        Dim lpath : lpath=LCase(path)
        if Not libraries_.exists(lpath) then
            Dim code
            libraries_.add LCase(lpath), "stuff"
            On Error Resume Next
            adostream_.LoadFromFile(lpath)
            code = Replace(Replace(adostream_.ReadText(),"<"&"%",""),"%"&">","")
            executeGlobal code
            If Err.number <> 0 Then 
                Response.write "Error importing library "
                Response.write lpath & "<br>"
                Response.write Err.source & ": " & Err.description
                Response.write "<pre><tt>" & replace(code,"<","&lt;") & "</tt></pre>"
                Response.End
            End if
            On Error Goto 0
        End If
    End Property

End Class

Set IncludeOnce = new IncludeOnceClass 
```

如您所见，我不会关闭流以处理进一步的包含。

**更新：**由于路径不区分大小写，因此此版本在将它们作为键添加到字典之前将它们转换为小写。它们还在代码评估**之前**添加，以防止在包含循环（递归）的情况下重复评估：

给定 A.asp 和 B.asp ：

```
' A.asp
IncludeOnce Server.MapPath("/some/path/B.asp")

' B.asp
IncludeOnce Server.MapPath("/some/path/A.asp") 
```

由于`A`在代码包含时根本还没有评估，如果它还没有在字典中注册，`B`第二个将发生重复评估，这是我们不想要的。`IncludeOnce`此更新修复了该问题。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-03T08:52:21.783

这是我在继承旧版 ASP 应用程序后第一次遇到的问题之一。我目前的解决方案是将所有通用库文件包含在一个名为“app-init.asp”的文件中。然后，此文件将包含在所有页面中，并为您提供连接应用程序范围功能和构建基础的单一入口点。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-01T21:52:52.017

您可以做的最好的事情是使用 SSI 来包含文件：

[http://en.wikipedia.org/wiki/Server_Side_Includes](http://en.wikipedia.org/wiki/Server_Side_Includes)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-07-30T15:04:53.807

作为使用 ExecuteGlobal 的答案的警告；我认为 ExecuteGlobal 会造成不稳定，因为 VBScript 不能很好地收集或管理内存。它可能会引发“灾难性故障”或“ASP 0240 脚本引擎异常”错误，因为您正在重新定义未正确处理的对象。

因此，要使用它，您还需要创建包含，具有析构函数的类和包含应该创建该类的实例，将对象名称保存在字典中，并且 ImportFunction 析构函数应该销毁字典中的所有对象。

包含也不应该以 ASP 标记 <% %> 为前缀，而使用#include，则需要。

您还应该注意 ExecuteGlobal 将所有 X = Y 视为赋值而不是比较，因此：-

isMatch = (X = Y) ' 可能会产生虚假结果。

示例包括： -

```
Class aClass

    Public Sub doSomething()
        ...
    End Sub

End Class

Dim instance
Set instance = new aClass 
```

我创建了一个与上面类似的示例，但使用了将包含传递给 Sub 或属性分配的第二种样式

它还做了什么，是尝试通过销毁字典中的所有对象，在它自己的析构函数中进行垃圾收集。它还剥离了您包装的库的 asp 标签。

```
<% 
Class Libraries

private m_LoadedLibraries
private m_FileSystem

Private Property Get LoadedLibraries
    If Not isInstantiated( m_LoadedLibraries ) Then
        Set m_LoadedLibraries = Server.CreateObject("Scripting.Dictionary")
    End If
    Set LoadedLibraries = m_LoadedLibraries
End Property

Private Property Get FileSystem
    If Not isInstantiated( m_FileSystem ) Then
        Set m_FileSystem = Server.CreateObject("Scripting.FileSystemObject")
    End If
    Set FileSystem = m_FileSystem
End Property

Private Property Get IncludePath
    IncludePath = "c:\include\"
End Property

Private Property Get LibrarySuffix
    LibrarySuffix = ".inc.asp"
End Property

Private Sub Class_Terminate()

    destroyObjects

    Set m_LoadedLibraries   = Nothing
    Set m_FileSystem        = Nothing

End Sub

Private Sub destroyObjects()
    Dim objectName
    For Each objectName in LoadedLibraries.Items
        If Eval("IsObject(" & objectName & ")") Then
            Execute "Set " & objectName & " = Nothing"
        End If
    Next
End Sub

Public Sub Include(ByVal libraryName, ByVal objectName)

    libraryName = LCase( libraryName )
    Dim library, filePath, script

    If Not LoadedLibraries.Exists( libraryName ) Then
        filePath = IncludePath + libraryName + LibrarySuffix 
        Set library = FileSystem.OpenTextFile( filePath  )
        script = library.ReadAll
        script = stripAspTags( script )
        ExecuteGlobal script
        library.Close
        LoadedLibraries.add libraryName, objectName
    End If

End Sub

Private Function stripAspTags(ByVal script)
    Dim buffer, location, startTag, stopTag, tagLength 

    startTag    = Chr(60) + "%"
    stopTag     = "%" + Chr(62)
    script      = CStr( script )
    tagLength   = Len(startTag)
    location = InStr(1, script, startTag, 1 )

    If location > 0 Then
        buffer = cleanString( Left( script, location + tagLength - 1  ) )
         ' Only strip off if it's the first part of the script
        If Len( buffer ) = Len(startTag) Then
            script = Mid( script, location + tagLength )
        End If
    End If

    location = InStrRev(script, stopTag, -1, 1 )
    If location > 0 Then
        buffer = cleanString( Mid( script, location ) )
         ' Only strip off if it's the last part of the script
        If Len( buffer ) = Len(stopTag) Then
            script = Left( script, location - 1 )
        End If
    End If
    stripAspTags = script
End Function

Private Function cleanString(ByVal target)
    Dim objRegExp

    Set objRegExp           = New Regexp

    objRegExp.IgnoreCase    = True
    objRegExp.Global        = True
    objRegExp.Pattern       = "[\x00-\x1f]+"
    cleanString             = objRegExp.Replace( target, "")

    Set objRegExp = Nothing
End Function

Private Function isInstantiated(ByVal target)
    isInstantiated = ( IsNull( target) Or IsEmpty( target ) Or Not IsObject( target) )
End Function    

End Class

Dim RequireOnce
Set RequireOnce = new Libraries
%> 
```

用法： -

```
With RequireOnce 
    .Include "aClass",        "instance"
    .Include "Database",      "DataAccess"
    .Include "Constants",     "Constant"
    .Include "LoginCheck",    "Login"
End With 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-12-10T17:24:57.163

这就是将文件包含到 Asp Classic 中的方式。

包含这个它看起来会变灰，但它会包含该文件。

# mysql - 删除 mysql 数据库中超过 3 个月的行的作业

> ID：813434
> 
> 赞同：19
> 
> 时间：2009-05-01T21:45:08.900
> 
> 标签：mysql, database

我们使用 mysql 服务器作为集中式日志记录系统，我希望有一份工作可以定期删除\清理超过 3 个月的表条目。做这个的最好方式是什么？

提前致谢。

-欣灵

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2009-05-01T21:52:07.727

您是否将项目的创建日期存储在字段中？

如果是这样，

```
DELETE FROM myTable WHERE dateEntered < DATE_SUB(NOW(), INTERVAL 3 MONTH); 
```

应该管用...

您可以在计划的任务/cron 作业中运行它...

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-01T22:04:25.187

MySQL 5.1 支持[事件](http://dev.mysql.com/tech-resources/articles/mysql-events.html)。我自己并没有真正使用过它们，所以我不会为它们担保。但是，如果您只想定期运行 DELETE 语句，我认为它会运行得很好。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-01T21:54:00.093

一种简单的方法是安排一个每晚运行的作业，该作业调用一个存储过程来删除所有超过三个月的行。根据您的操作系统，这应该很容易做到。每晚执行一次，删除的数据量不会像一个月左右执行一次那样多。

我过去也曾在我的 SP 中有代码插入数据以删除当时不需要的数据，所以基本上每次插入一行时，在插入后立即运行一个“清理”过程，它做了一点的维护。这不是我的第一选择，但如果插入数量很少，并且可以快速完成删除（您不想让用户慢下来），它是可行的。这样做的好处是数据*总是*干净的（即所有数据总是 <= 3 个月大），但不确定这在您的应用程序中是否重要。

除了删除它们之外，您还应该考虑将行归档到另一个表中，如果有*可能*有一天您可能希望这些数据用于其他目的。我*总是*这样做，当某个甚至不知道您正在保存数据的经理突然迫切需要它时，您会感到多么英雄的样子，您会感到惊讶……而您可以为他们提供服务.

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-01T21:50:17.013

解释你的问题，“我有不依赖于客户端的代码，我想在数据库上多次运行，我不需要查看输出”，那么答案是“编写一个存储过程，并且定期从任何客户那里调用它”。

# php - 类名中的文件路径约定怎么样？

> ID：813441
> 
> 赞同：2
> 
> 时间：2009-05-01T21:47:21.780
> 
> 标签：php, naming-conventions

你们*（尤其是 PHP）*人如何看待与项目目录相关的类名反映文件路径的类的命名约定？例如：

```
# /project/Session/Abstract.php
# /project/Session/Database.php

class Session_Database extends Session_Abstract ... 
```

我相信你明白了。我也确信一些优点是显而易见的..但是你认为 - 为了获得易于导航的漂亮目录结构而延长类名是否值得？

这也允许在 PHP 中使用单行 __autoload( $class ) 定义： str_replace( '_', '/', $class );

我想有些人会认为这样的约定是愚蠢的。我个人喜欢它，但我还没有看到其他人使用它，我不太确定它在实践中是否能很好地工作。

缺点之一可能是删除 include/require 调用后，所有类都依赖（粘合在一起）自动加载功能，有些人可能会争辩说，这不符合他们对松散耦合的理解。

到目前为止，我所知道的关于这种方法的唯一参考是[http://softwareengineering.vazexqi.com/files/pattern.html](http://softwareengineering.vazexqi.com/files/pattern.html)

那么，你对这个有意见吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-01T21:54:23.823

那你还没看。[PEAR](http://pear.php.net/manual/en/standards.naming.php)使用这种方法。[Zend 框架](http://framework.zend.com/)也是如此。这是 PHP 世界中相当成熟的标准。我不知道我什么时候第一次遇到它，但我个人使用它并喜欢它好几年了，既作为我自己框架的一部分，也作为 ZF 等公开可用框架的一部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-02T02:16:10.807

我唯一不喜欢的是，当我需要移动代码时，我最终会重新处理很多名称。然而，Emil 已经指出这对于课程来说几乎是标准的，但我想添加[PHP Userland Naming Rules](http://us2.php.net/manual/en/userlandnaming.rules.php)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-02T12:35:09.510

我也使用该约定。

它不仅有助于拥有漂亮的文件结构，还有助于解决命名空间问题。该命名约定有助于为类添加前缀以避免重复的类名。

当 PHP 5.3 出来并最终有了命名空间时，我仍然会使用这个约定。我唯一不同的是缩短我的类名，将我的前缀转换为适当的命名空间，并在我的自动加载器中进行调整。

# .net - Winforms 中的 Linq-ToEntities 数据源分配挂起

> ID：813442
> 
> 赞同：0
> 
> 时间：2009-05-01T21:47:23.043
> 
> 标签：.net, sql-server, linq, linq-to-entities, data-binding

我在 WinForms 中有一个非常典型的 linq-to-entities 数据绑定：

```
myGrid.DataSource = myEntities.entity 
```

当它到达那行代码时，它只是挂起。类似的分配一个不同的实体在代码的其他地方工作正常。该数据库在所有实体中包含不超过 50 行数据（这是一个新项目），因此它不会等待数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T21:59:39.177

取决于它是 asp.net 还是 windows 窗体...如果它是您尝试数据绑定的 asp.net 客户端，我建议在将结果分配给任何数据源之前将结果发送到列表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T22:31:34.293

有趣的是，我可能已经找到了解决方案。我有一个实体，我们将其称为 C，它将实体 A 和 B 链接在一起作为连接表。我决定 A 和 B 可以直接链接。显然，这弄乱了内部 Linq 逻辑并绑定到 A 或 B 然后挂起。当我删除 C 时，与 A 和 B 的绑定开始工作。

# vba - 旧版 VBA 解决方案在 Office 2007 中不起作用

> ID：813447
> 
> 赞同：1
> 
> 时间：2009-05-01T21:50:04.533
> 
> 标签：vba, ms-office, add-in, powerpoint

伙计们，

一个基于 VBA 的现有系统安装在具有 Office 2007 的机器上并且它不起作用，我面临的问题是：

1.  PowerPoint 加载项 (.PPA) 不再能够在快捷菜单中创建自定义按钮，Office 2007 是否更改了命令栏名称？

2.  MSI（用 Wix 编写）没有像在 Office 2003 中那样将文件安装在 XLStart 文件夹中，Office 2007 是否为 XLStart 或其他机制使用了新名称？

非常感谢有关如何解决上述问题的任何建议

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-06T15:16:12.723

对于问题一，我认为您将无法修改加载项以配合功能区。

对于问题二，我怀疑启动位置是硬编码的。如果是这种情况，请尝试写入 Excel.Application.StartupPath（如果您从 PowerPoint 执行此操作，则需要设置对 Excel 的引用。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-01T22:14:21.513

您是否确保您使用的是受信任的位置或经过认证的项目？

[http://office.microsoft.com/en-us/help/HA100319991033.aspx](http://office.microsoft.com/en-us/help/HA100319991033.aspx)

[http://support.microsoft.com/kb/206637](http://support.microsoft.com/kb/206637)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-07-04T04:12:03.207

关于第 1 点：

> 我们知道您的目的是让您使用自定义操作来自定义右键菜单，以在应用程序中导航并执行各种任务，但是，右键菜单创建和功能不是 Power Point 2007 中的功能。目前没有以前具有自定义右键菜单功能的 Power Point 解决方案的升级路径。所有以前使用此功能的 Power Point 解决方案都需要在其解决方案中实施功能区以推动用户选择。

[http://blogs.msdn.com/acoat/archive/2008/05/16/unable-to-customise-context-menus-in-powerpoint-2007.aspx](http://blogs.msdn.com/acoat/archive/2008/05/16/unable-to-customise-context-menus-in-powerpoint-2007.aspx)

# .net - 在 Spring.config 中，我可以定义字符串类型的对象吗？

> ID：813452
> 
> 赞同：1
> 
> 时间：2009-05-01T21:51:06.623
> 
> 标签：.net, spring, spring.net

我可以做这样的事情：

```
 <object id="mydb" type="string">
    <value>"blah"</value> <-- note that <value> tag does not really exist
  </object> 
```

这样我以后可以像这样使用它：

```
 <object id="Someobject" type="Sometype">
    <property name="ConnectionString" ref="mydb"/>
  </object> 
```

编辑：这是我正在寻找的 SpringFramework.NET 解决方案。看起来 PropertyPlaceholderConfigurer 也存在那里。谢谢大家。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T23:23:34.637

使用 Spring 的内置[PropertyPlaceholdConfigurer](http://static.springframework.org/spring/docs/2.5.x/api/org/springframework/beans/factory/config/PropertyPlaceholderConfigurer.html)：

```
<bean id="PropertyPlaceholderConfigurer" class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
   <property name="systemPropertiesModeName" value="SYSTEM_PROPERTIES_MODE_OVERRIDE"/>
   <property name="location" value="classpath*:/application.properties"/>
</bean>

 <bean id="Someobject" class="somepackage.Sometype">
   <property name="connectionString" value="${mydb}"/>
 </bean> 
```

设置`SYSTEM_PROPERTIES_MODE_OVERRIDE`允许通过命令行覆盖属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T22:12:17.057

使用占位符，例如**${magic}**并在属性文件中定义键/值以及后处理器。谷歌*春季后处理器占位符*...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T22:08:59.590

我看不出你的方式有什么好处。这一切仍然只是配置。

有时人们将数据库连接字符串外部化为 .properties 文件并以这种方式获取它们。我认为这比你的提议更有意义。

# linq - 在 LINQ to Entities 中实例化上下文

> ID：813457
> 
> 赞同：27
> 
> 时间：2009-05-01T21:52:56.167
> 
> 标签：linq, entity-framework, linq-to-entities, entity

我见过程序员在代码中创建实体上下文时采用的两种不同方式。

第一个是这样的，你可以在 MSDN 代码示例中找到它：

```
public void DoSomething() {
     using (TaxableEducationEntities context = new TaxableEducationEntities()) {
          // business logic and whatever else
     }
} 
```

第二个是将上下文创建为封装业务逻辑的某个类中的私有属性。所以你会有类似的东西：

```
public class Education_LINQ {

        private TaxableEducationEntities context = new TaxableEducationEntities();

        public void DoSomething() {
            var result = from a in context.luAction
                         select a;

            // business logic and whatever else
        }
} 
```

哪种方式更有效？

假设您有两种方法，一种称为 DoSomething1()，另一种称为 DoSomething2()，并且这两种方法都包含 using 语句来打开上下文并对其执行任何操作。如果您要一个接一个地调用一个方法，是否会产生任何多余的开销，因为本质上这两种方法都会创建上下文，然后在完成后将其清除？与仅在实例化类对象时创建一个私有属性相反，然后在对象超出范围时依次清理？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-05-01T23:23:21.860

每次创建一个新的 ObjectContext 确实涉及“一些”开销。本质上，所涉及的开销是将元数据从全局缓存复制到与特定 ObjectContext 关联的元数据中。

这种开销相对较小，因此通常不值得担心，尤其是当您考虑到使用模式固有的额外安全性时。

对我来说，您选择哪个选项取决于以下事项：

1.  您的包装类可能存在多长时间？如果它存在很长时间，ObjectContext 可能会增长以容纳许多随着时间的推移而减速的实体。所以每次一个新的 ObjectContext 可能是个好主意。
2.  对包装类上的方法的调用是否同步？ObjectContext 类本身不是线程安全的，因此如果您使用第二种模式，如果您希望多个线程调用它，则需要确保您的包装类/存储库是线程安全的。
3.  这些方法本质上是无关的吗？如果是这样，如果它们在方法之间共享一个上下文，您可能会得到意想不到的副作用。

一般来说，我的建议是，如果方法是无状态的，即为每个方法触发并忘记一个新的上下文可能是一个好主意。

但是，如果您有一个相对较短的有状态形式或其他东西，那么共享上下文可能是一个更好的主意。

更新：我花时间整理了[一个更完整的答案](https://docs.microsoft.com/en-us/archive/blogs/alexj/tip-18-how-to-decide-on-a-lifetime-for-your-objectcontext)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T21:56:35.953

如果这就是您的意思，第二个选项实际上不会自行清理。我更喜欢每次都使用 ObjectContext 版本，因为我不必在之后处理它。不确定我的问题是否正确……今天编程时间太多。

```
public class UserManagerRepository : IUserManagerRepository, IDisposable
{
    private readonly Entities _context = new Entities();
    private bool _disposed;

    public User Create(User user, int countryId)
    {
        user.Country = GetCountry(countryId);
        _context.AddToUser(user);
        _context.SaveChanges();
        return user;
    }
} 
```

然后要使用这个存储库，我会执行以下操作：

```
using(var repository = new UserManagerRepository())
{
    repository.Create(user);
} 
```

# c# - 多变量方法的实例与静态方法

> ID：813475
> 
> 赞同：0
> 
> 时间：2009-05-01T21:58:14.203
> 
> 标签：c#, .net

如果您有一个`Point3`类并且有一个名为 的方法`Distance`，那么您是否应该像这样将其设为静态：

```
Point3.Distance ( p1, p2 ); 
```

或实例方法，如：

```
this.Distance ( p ); 
```

我意识到使用静态方法会阻碍继承和覆盖，对吧？

哪个更好，为什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-01T22:06:15.527

我更喜欢静态版本。（这就是我们在 SlimDX 中全面所做的，除了一些“特殊”操作。）原因是距离在概念上是一个处理两个点的函数，并且有一个结果。您没有在 p1 上运行“距离”操作，以 p2 作为值。

简而言之，我更喜欢实例方法在概念上是绑定到特定实例的操作。对一些人来说，这两种方式都行。例如，SlimDX 包括 Vector3 Normalize 函数的静态和非静态版本，因为这两种构造都非常方便。实例修改它的对象，静态的返回一个新的。

[编辑]另一个答案提到了一个“DistanceTo”函数，它是一个实例函数。虽然这不一定不合理，但这是一个让我感到不安的设计方向。问题是正交性。一旦你添加了更多这些重载——一些静态的、一些实例，也许是 MathHelper 类中的一些，谁知道呢——你最终会得到越来越多的方法来做同样的事情。这对于库复杂性、测试复杂性、bug 表面积等来说是个坏消息。我们选择在 SlimDX 中的一些地方进行，但这只是在许多类中的少数几个地方（并且每一个都经过团队审查）。它可以在一定程度上帮助库的可用性，但是很容易以错误的方式结束。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T22:08:37.110

我更喜欢静态版本，但根据您使用它或期望使用它的方式，我会考虑包含一个`DistanceTo`调用静态方法的实例方法。有时像这样的实例方法可以使代码更简洁和可读。

像这样的静态方法的一大卖点是，即使它们的一个或两个操作数是 ，它们也可以返回结果`null`。如果您只有一个实例方法，则需要`null`在调用该方法之前对其进行测试。 `Object.Equals`/`ReferenceEquals`是一个典型的例子。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-25T05:39:46.217

*“哪一个更好？”* 是一个很大程度上取决于具体情况的问题。在某些情况下，您可能需要静态方法，在其他情况下可能需要实例方法，有时两者都需要。与其试图提供一个绝对的法令，这里是我关于如何做出这个决定的一些想法。

## 清晰度注意事项

当使用对象的实例不方便时，可以使用静态方法。例如，.NET 字符串类具有可以连接多个字符串的 String.Concat( )。

很明显有： 有： `String.Concat( "A", "B" );` 很尴尬： `"A".Concat( "B" );`

有时，为操作提供名称比将其编码为构造函数重载更清楚。Int.Parse() 就是一个很好的例子。Int 可以有一个接受字符串的构造函数，但不清楚其意图是什么。静态 Parse() 方法增加了清晰度。

## 可维护性注意事项

有时您别无选择，只能将函数实现为静态实用程序方法。向类添加新方法可能是不可能的——您可能没有源代码，您可能希望避免测试影响等。

即使您可以添加实例方法，通过在实用程序类中实现不常用或特殊用途的方法来整理类也可能很有用。但是，只有当您可以*仅*使用您要扩展的类型的公共接口来实现实用程序类时，您才应该这样做。在 C# 3.5 中，您可以使用扩展方法来创建实用方法是类的实例方法的假象。

## 多态性注意事项

如果一个函数很可能在派生类型中被覆盖，则应将其设为实例成员并使用 virtual 关键字对其进行标记。未标记为虚拟的实例方法并不比静态方法更具可扩展性。

## 最佳实践注意事项

静态函数应该（通常）没有副作用。换句话说，他们不应该修改任何一个参数的状态。具有副作用的函数最好作为对象的实例方法来实现。

在 OOP 中有[单一责任原则](http://en.wikipedia.org/wiki/Single_responsibility_principle)(SRP)，它基本上表明“每个类都应该只有一个改变的理由”。如果向特定类添加实例方法会违反 SRP，请考虑将该逻辑从类中分离出来。

## 可用性注意事项

有时代码（尤其是框架级代码）的设计目标是可用性。*在这种情况下，提供*函数的实例和静态版本可能很有用。但是，在这种情况下，强烈建议将实例版本实现为对静态版本的调用。这种方法允许类的消费者决定哪个是有意义的。这种方法的一个例子是`string.Compare()`and`string.CompareTo()`方法——前者是静态的，而后者是实例方法。这允许字符串类符合特定的接口 (IComparable)，同时还提供了很好的语法：`string.Compare( "A", "a" )`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-01T22:19:04.417

我更喜欢实例方法。我想能够说

```
myPoint.distanceTo(another); 
```

这听起来可能很傻，但事实上我为另一个元素“那个”准备了一个简洁、令人难忘的名字，这是我倾向于这种偏好的部分原因：

```
double distanceTo(Point that) {
    double dx = this.x - that.x;
    double dy = this.y - that.y;
    return Math.sqrt(dx^2 + dy^2);
} 
```

（请原谅我的 Java；我确信 C# 并没有太大的不同）。“this”和“that”可以很好地协同工作，我认为让代码比“a”和“b”更容易理解。此外，如果它是一个实例方法，那么从我的其他实例方法中，我可以使用 distanceTo() 而不`this`显式传递。

# jquery - jQuery选择器，其中文本=某个值

> ID：813477
> 
> 赞同：22
> 
> 时间：2009-05-01T21:58:47.540
> 
> 标签：jquery, jquery-selectors

我有一个对象（在本例中是来自 js-kit 的评级对象），如果评级值为“未评级”，我想使其不可见。我无法获得正确的 jQuery 选择器来执行此操作。

即使下面的代码看起来应该可以工作，但它没有。

```
$(".js-rating-labelText:contains('unrated')").css("visibility", "hidden"); 
```

`.js-rating-labelText`是在文本上设置的类。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-06-12T17:07:11.440

您可以创建自己的选择器方法

例如，如果您希望能够执行以下操作：

```
$('.js-rating-label:hasText(unrated)'); 
```

您可以`hasText`按如下方式定义方法

```
$.expr[':']['hasText'] = function(node, index, props){
  return node.innerText.contains(props[3]);
} 
```

`props[3]`包含 ':hasText' 之后括号内的文本。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-05-01T23:22:14.983

> 是否有另一种方法可以根据文本内容选择元素？

试试这个：

```
$('.js-rating-labelText').filter(function(){
  return (/unrated/i).test($(this).text())
}).css('visibility', 'hidden'); 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-01T23:12:39.937

也许问题在于`:contains('Unrated')`功能的一部分。将文本更改为任何随机值都会产生相同的结果：

```
$("#ratingDiv:contains('somerandomtext')").hide(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-03-05T21:57:03.240

@tgmdbm 的出色答案略有不同。唯一的区别是它只选择具有与`hasText()`参数完全匹配的单个子文本节点的节点。而`.innerText`返回所有后代文本节点的串联。

```
 if( ! $.expr[':']['hasText'] ) {
     $.expr[':']['hasText'] = function( node, index, props ) {
       var retVal = false;
       // Verify single text child node with matching text
       if( node.nodeType == 1 && node.childNodes.length == 1 ) {
         var childNode = node.childNodes[0];
         retVal = childNode.nodeType == 3 && childNode.nodeValue === props[3];
       }
       return retVal;
     };
  } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-01T22:29:35.093

确保您的代码在 js-kit 函数填充文本*之后*运行，而不是在它之前运行。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-01T22:50:06.183

您也可以考虑使用 hide() / show() 方法。

```
$(".js-rating-labelText:contains('unrated')").hide() 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-01T23:33:49.217

根据您提供的 HTML，我看不出您正在测试的“未分级”文本来自何处。

但是，如果这是该div 中的**全部**文本，则直接对其进行测试。

```
if ($('.js-rating-labelText').text() == 'unrated'){
  $(this).hide();
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-11-09T14:25:41.460

解释该主题的最佳方法是提供示例和参考链接：-

**示例：-** 以下 jQuery 选择器语法从一组已选择（匹配）的 HTML 元素中选择第一个或第 n 个元素。

```
$("selector:contains(searchText)") 
```

**html:-**

```
<table>
<tr><td>John Smith</td><td>Marketing</td></tr>
<tr><td>Jane Smith</td><td>Sales</td></tr>
<tr><td>Mike Jordon</td><td>Technology</td></tr>
<tr><td>Mary Jones</td><td>Customer Support</td></tr>
</table>
Search: <input id="txtSearch" type="text">
<input id="btnTestIt" type="button" value="Test It">
<input id="btnReset" type="reset" value="Reset"> 
```

**jQuery：-**

```
$(document).ready( function(){
    $("#btnTestIt").click( function(){
        var searchText = $("#txtSearch").val();
        $("td:contains('" + searchText + "')").css("background-color", "yellow");
    });
    $("#btnReset").click( function(){
        $("td").css("background-color", "white");
    });
}); 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-05-01T22:36:50.867

以下是来自 javascript 函数的一些 html：

```
<div class="js-kit-rating" id="ratingDiv" style="width: 86px; visibility: hidden;" jk$initialized="true" path="/business/blogger-com" permalink="/businessblogger-com" freeze="yes" starcolor="Golden">
  <table class="js-ratings-tableWrapper" border="0" cellSpacing="0" cellPadding="0">
    <tbody>
      <tr>
        <td>
          <div class="js-ratingWrapper" style="width: 80px;">
          <div style="float: left; cssfloat: left;">
              <div style="width: 80px; height: 15px;">
<div class=" js-kit-objIcon" style="width: 16px; float: left; height: 15px; cssfloat: left;" imageURL="//js-kit.com/images/stars/golden.png">
  <img style="display: none;" src="//js-kit.com/images/stars/golden.png" complete="complete"/>
<div class=" js-kit-objIcon" style="width: 16px; float: left; height: 15px; cssfloat: left;" imageURL="//js-kit.com/images/stars/golden.png"/>
<div class=" js-kit-objIcon" style="width: 16px; float: left; height: 15px; cssfloat: left;" imageURL="//js-kit.com/images/stars/golden.png"/>
<div class=" js-kit-objIcon" style="width: 16px; float: left; height: 15px; cssfloat: left;" imageURL="//js-kit.com/images/stars/gray.png">
  <img style="display: none;" src="//js-kit.com/images/stars/gray.png" complete="complete"/>
<div class=" js-kit-objIcon" style="width: 16px; float: left; height: 15px; cssfloat: left;" imageURL="//js-kit.com/images/stars/gray.png"/>
<div class=" js-rating-labelText"> 
```

# php - 如何使用 curl 将 JSON 发布到 PHP

> ID：813487
> 
> 赞同：108
> 
> 时间：2009-05-01T22:03:20.103
> 
> 标签：php, rest, post

我可能离基地很远，但我整个下午都在尝试在这个 PHP 框架教程中运行[curl post 命令。](http://www.recessframework.org/page/restful-php-framework)我不明白的是 PHP 应该如何解释我的 POST，它总是作为一个空数组出现。

```
curl -i -X POST -d '{"screencast":{"subject":"tools"}}'  \
      http://localhost:3570/index.php/trainingServer/screencast.json 
```

（那里的斜线只是为了让我看起来不像个白痴，但我使用 PHP 5.2 从 Windows 执行此操作，也在 Linux 服务器上尝试过，与 Linux curl 版本相同）

我必须缺少一些东西，因为它看起来很简单，只是帖子的解释不正确，如果是的话，一切都会很好。

这是我回来的：

```
HTTP/1.1 409 冲突
日期：格林威治标准时间 2009 年 5 月 1 日星期五 22:03:00
服务器：Apache/2.2.8 (Win32) PHP/5.2.6
X-Powered-By: PHP/5.2.6
传输编码：分块
内容类型：文本/html；字符集=iso-8859-1

{"screencast":{"id":null,"subject":null,"body":null,
         "dataUrl":null,"dataMedium":null,"createdOn":null,"author":null}}

```

* * *

## 回答 #1

> 赞同：120
> 
> 时间：2009-12-03T00:36:42.077

通常，该参数`-d`被解释为格式编码。你需要的`-H`参数：

```
curl -v -H "Content-Type: application/json" -X POST -d '{"screencast":{"subject":"tools"}}' \
http://localhost:3570/index.php/trainingServer/screencast.json 
```

* * *

## 回答 #2

> 赞同：107
> 
> 时间：2009-05-01T22:10:50.757

Jordans 分析为什么没有填充 $_POST 数组是正确的。但是，您可以使用

```
$data = file_get_contents("php://input"); 
```

只需检索 http 正文并自己处理即可。请参阅[PHP 输入/输出流](http://se2.php.net/wrappers.php)。

从协议的角度来看，这实际上更正确，因为无论如何您并没有真正处理 http 多部分表单数据。此外，在发布请求时使用 application/json 作为内容类型。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2009-05-01T22:10:01.647

我相信您得到的是一个空数组，因为 PHP 期望发布的数据采用 Querystring 格式（key=value&key1=value1）。

尝试将您的 curl 请求更改为：

```
curl -i -X POST -d 'json={"screencast":{"subject":"tools"}}'  \
      http://localhost:3570/index.php/trainingServer/screencast.json 
```

看看是否有帮助。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2012-12-27T01:15:44.777

您需要设置一些额外的标志，以便 curl 将数据作为 JSON 发送。

### 命令

```
$ curl -H "Content-Type: application/json" \
       -X POST \
       -d '{"JSON": "HERE"}' \
       http://localhost:3000/api/url 
```

### 旗帜

*   `-H`: 自定义标头，下一个参数应为标头
*   `-X`: 自定义 HTTP 动词，下一个参数应该是动词
*   `-d`: 将下一个参数作为 HTTP POST 请求中的数据发送

### 资源

*   [cURL 手册页](http://curl.haxx.se/docs/manpage.html)
*   [卷曲示例](http://curl.haxx.se/docs/manual.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-08-16T11:26:08.020

你应该像这样转义引号：

```
curl -i -X POST -d '{\"screencast\":{\"subject\":\"tools\"}}'  \
  http://localhost:3570/index.php/trainingServer/screencast.json 
```

# asp.net - 关于 ASP.net (web form) 架构的问题

> ID：813488
> 
> 赞同：1
> 
> 时间：2009-05-01T22:03:24.270
> 
> 标签：asp.net

我目前正在开发一个 ASP.net 项目，它将（虚拟目录）插入到“父”ASP.net 项目中，就像一个模块一样。由于我的项目有自己的 Global.asax、web.config、错误处理...等。会不会干扰别人写的父项目？如果我没记错的话，ASP.net 将每个虚拟目录视为独立的，因此它不应该干扰父目录，但应用程序的流程不会让人感到奇怪，而且由于整个应用程序将由不同的人完成，不是吗？如果每个程序员的编写方式不同或使用不同的语言，这种方法会导致维护噩梦。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T22:11:39.850

如果您将其设计为完全独立的模块，我看不出有任何问题。

如果您不小心从父网站（如 .css、.js 甚至母版页）引用某些文件，您可能会遇到一些路径问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T22:48:02.257

您将遇到的唯一问题是，如果您想共享会话，您将无法做到。除此之外，你应该没问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-01T22:58:22.467

您的网站会很好。小心配置继承。子站点继承父 web.config 设置。

如果它是一个有点奇怪的应用程序，但如果它们都是不同的应用程序，那么将它们放在一个站点中是完全可以接受的。尽管将它们分成自己的子域会更受欢迎：

app1.domain.com app2.domain.com

如果您需要扩展应用程序，您可以轻松地将每个应用程序放在自己的服务器上。

虽然 .net 有能力用多种语言编写，但除了 c# 或 vb 之外，真的很少见。所以我不会担心太多。学习不同的语言对您有好处，并且确实有助于成为更好的编码员。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-01T22:08:58.450

不必要！对某种版本控制和每周代码审查的需求以及在需要时开发人员之间的密切沟通就足够了。我想这取决于开发人员的经验。

# jquery - 悬停时的jQuery动画边框颜色？

> ID：813493
> 
> 赞同：17
> 
> 时间：2009-05-01T22:05:52.093
> 
> 标签：jquery

使用[颜色插件](http://plugins.jquery.com/project/color)在悬停时为背景颜色设置动画。

```
$(function() {
    $('.listing-2 li a').mouseover(function() {
        $(this).animate({
            backgroundColor: "#0e7796"
        }, 'fast');
    });
    $('.listing-2 li a').mouseout(function() {
        $(this).animate({
            backgroundColor: "#d6f2c5"
        }, 'fast');
    });
}); 
```

我怎样才能对边框颜色做同样的事情？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-05-01T22:11:10.850

在谷歌找到

```
 $('.listing-2 li a').mouseover(function() {
    $(this).animate({ borderTopColor: "#0e7796" }, 'fast');
});
$('.listing-2 li a').mouseout(function() {
    $(this).animate({ borderTopColor: "#fff" }, 'fast');
}); 
```

它必须是“borderTopColor”（或左、右、下）而不是“borderColor”。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2010-07-19T20:46:54.457

要为整个边框的颜色设置动画，请使用：

```
$(this).animate({ borderTopColor: '#59b4de', borderLeftColor: '#59b4de', borderRightColor: '#59b4de', borderBottomColor: '#59b4de' }, 'fast'); 
```

显然，您需要全部指定它们。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-02-13T02:55:43.420

这也有效。

```
$("div.item").hover(function() {
    $(this).stop().animate({"border-color": "#999999"}, "slow");
},
function() {
    $(this).stop().animate({"border-color": "#BFBFBF"}, "slow");
}); 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-02-27T08:09:09.037

我有一个类似的问题。我显然没有将 jQuery-UI 文件附加到我的文档中。一旦我附上它。一切都与“C. Spencer Beggs”的答案完美结合。

```
<script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.10.1/jquery-ui.min.js"></script> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-05-28T07:41:05.197

jQuery animate 只接受数值。请参阅 [文档]：[http ://api.jquery.com/animate/](http://api.jquery.com/animate/)

您可以使用 jQuery.Color 插件或使用扩展 animate 并允许您在 animate 中使用非数字值的 jQuery UI。

享受

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-02-17T22:57:27.987

作为 jQuery 解决方案的替代方案，您也可以使用 CSS 过渡为边框颜色设置动画。由于您正在为`background-color`with制作动画`fast`，因此您需要使用`200ms`过渡。

**你的案例**

```
.listing-2 li {
    border:1px solid #d6f2c5;
    transition: border 200ms ease-in-out;
}

.listing-2 li a:hover {
    border:1px solid #0e7796;
} 
```

**通用示例**

```
body {
  display: flex;
  justify-content: center;
}
.container {
  width: 50px;
  height: 50px;
  border: 1px solid #d6f2c5;
  transition: border 200ms ease-in-out;
}
.container:hover {
  border: 1px solid #0e7796;
}
```

```
<div class="container"></div>
```

* * *

## 回答 #7

> 赞同：-5
> 
> 时间：2010-09-28T16:57:04.423

你可以试试这个：

```
$(this).animate({border: "3px solid #FFF55B"}, 100); 
```

# mysql - mysql order by select - 可能吗？

> ID：813495
> 
> 赞同：5
> 
> 时间：2009-05-01T22:06:17.570
> 
> 标签：mysql, sql-order-by

这是我的表设置：

```
mysql> describe a;
+-------+------------+------+-----+---------+----------------+
| Field | Type       | Null | Key | Default | Extra          |
+-------+------------+------+-----+---------+----------------+
| id    | int(11)    | NO   | PRI | NULL    | auto_increment | 
| x     | int(11)    | YES  |     | NULL    |                | 
| y     | varchar(1) | YES  |     | NULL    |                | 
+-------+------------+------+-----+---------+----------------+
3 rows in set (0.01 sec)

mysql> describe b;
+-------+------------+------+-----+---------+----------------+
| Field | Type       | Null | Key | Default | Extra          |
+-------+------------+------+-----+---------+----------------+
| id    | int(11)    | NO   | PRI | NULL    | auto_increment | 
| a     | int(11)    | NO   |     | NULL    |                | 
| z     | varchar(1) | YES  |     | NULL    |                | 
+-------+------------+------+-----+---------+----------------+
3 rows in set (0.01 sec)

mysql> select * from a;
+----+------+------+
| id | x    | y    |
+----+------+------+
|  1 |    1 | a    | 
|  2 |    2 | b    | 
|  3 |    3 | c    | 
|  4 |    4 | d    | 
+----+------+------+
4 rows in set (0.01 sec)

mysql> select * from b;
+----+---+------+
| id | a | z    |
+----+---+------+
|  1 | 3 | q    | 
|  2 | 2 | a    | 
|  3 | 1 | u    | 
|  4 | 4 | x    | 
+----+---+------+
4 rows in set (0.01 sec) 
```

这是我想要做的：

```
mysql> select a.* from a, b where a.id = b.a order by b.z;
+----+------+------+
| id | x    | y    |
+----+------+------+
|  2 |    2 | b    | 
|  3 |    3 | c    | 
|  1 |    1 | a    | 
|  4 |    4 | d    | 
+----+------+------+
4 rows in set (0.00 sec) 
```

但是，我想使用类似“SELECT * FROM a ORDER BY (SELECT a FROM b ORDER BY z)”的语法。

这可能吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-02-08T19:55:07.800

只要子查询恰好返回 1 个结果，就可以按子查询排序，这意味着您需要连接子查询中的表。

我只是在我的应用程序的查询构建器中设置了这个，这样的东西应该适合你：

```
SELECT a.*
FROM a,b
WHERE a.id = b.a
ORDER BY (
   SELECT z
   FROM b
   WHERE a.id = b.a
) ASC 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-01T22:32:57.787

```
SELECT * FROM a ORDER BY (SELECT a FROM b ORDER BY z) 
```

不，这不会让你得到你想要的。首先，子查询返回多行，因此它不能用作`ORDER BY`外部查询的表达式。这是你得到的错误：

```
ERROR 1242 (21000): Subquery returns more than 1 row 
```

`a`此外，考虑到这种查询形式，子查询中的行和行的顺序之间没有相关性。换句话说，即使您已经对子查询中的值进行了排序，也不会使外部查询的行以匹配的顺序排序。

如果您试图确保每行结果集中只有一行 if `a`（即使 中有多个匹配的行`b`），那么您可能想要这样：

```
SELECT DISTINCT a.* 
FROM a JOIN b ON (a.id = b.a)
ORDER BY b.z; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-01T22:12:14.200

我真的不认为你描述它的方式是可能的，我认为你需要加入表格。

看看这个：[http ://www.w3schools.com/Sql/sql_join_inner.asp](http://www.w3schools.com/Sql/sql_join_inner.asp)

# svn - 在 svn 中，我可以还原更改并将其搁置以备后用吗？

> ID：813497
> 
> 赞同：9
> 
> 时间：2009-05-01T22:06:43.760
> 
> 标签：svn, merge, patch, shelve

我在我的 svn 存储库中提交了一些更改。假设 HEAD 位于 r750，我想在不丢失 r746-r750 的情况下恢复 r745。这可能吗？

而且，我可以以某种方式保存 r745 并稍后重新应用它（作为新修订版）吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-01T22:08:59.373

假设你得到一个干净的向后合并，你可以这样做......

```
svn merge -r 745:744 <source> 
```

然后，当您想重新应用它时，可以将其转发合并：

```
svn merge --ignore-ancestry -r 744:745 <source> 
```

有关更多信息，请查看“[合并的常见用例](http://svnbook.red-bean.com/en/1.0/ch04s04.html)”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-01T22:13:31.513

是的，这绝对是可能的。

当您恢复更改时，它仍会在存储库中创建新修订。所以你会做这样的事情：

**1)**查看当前副本 r750。

**2)**使用 . 在工作副本上指定恢复`svn merge -r`。您的工作副本将合并旧版本。

**3)**将工作副本签入为 r751。

现在您将在历史记录中进行两次修订。新的 (r751) 不包括 r745，因为您已将其回滚。但是如果您想重新应用它，r745 仍然会存在。您可以简单地签出 r745 的副本，将其合并到您的工作副本中，然后将其重新签入（例如 r752）。

# c# - 从网站打印信封？

> ID：813520
> 
> 赞同：1
> 
> 时间：2009-05-01T22:12:40.360
> 
> 标签：c#

我想使用 c# 从网页打印标准尺寸的信封。有谁知道如何做这样的事情？我会从系统中加载数据以获取地址并传递它。我只需要这样做的基本步骤。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-06T15:02:08.123

我确实最终选择了PDF。我们使用[PDFSharp](http://www.pdfsharp.net)，它是一个免费的 .NET PDF 创建工具。我使用此处的功能动态创建 PDF，然后在页面上我只是将此页面加载为新窗口。这是我最终为任何想做类似事情的人创建的方法。

```
protected void DisplayPDFEnvelope()
    {
        try
        {
            PdfDocument document = new PdfDocument();
            PdfPage pdfpage = new PdfPage();

            XUnit pdfWidth = new XUnit(4.125, XGraphicsUnit.Inch);
            XUnit pdfHeight = new XUnit(9.5, XGraphicsUnit.Inch);
            pdfpage.Height = pdfHeight;
            pdfpage.Width = pdfWidth;

            pdfpage.Orientation = PageOrientation.Landscape;

            XPdfFontOptions options = new XPdfFontOptions(PdfFontEncoding.Unicode, PdfFontEmbedding.Always);

            document.AddPage(pdfpage);

            // Create a font
            XFont font = new XFont("ARIAL", 1, XFontStyle.Regular, options);

            // Get an XGraphics object for drawing beneath the existing content
            XGraphics gfx = XGraphics.FromPdfPage(pdfpage, XGraphicsPdfPageOptions.Append);

            // This method just returns a formatted address from the DB using \n to
            // do line breaks, i.e. 'Test Person\nAddress Line1\City, State Zip'
            string address = GetAddress();

            // Get the size (in point) of the text
            XSize size = gfx.MeasureString(address, font);

            // Create a graphical path
            XGraphicsPath path = new XGraphicsPath();

            path.AddString(address, font.FontFamily, XFontStyle.Regular, 10,
              new XPoint(345, 160), XStringFormats.Default);

            // Create a dimmed pen and brush
            XPen pen = new XPen(XColor.FromGrayScale(0), 0); // XColor.FromArgb(50, 75, 0, 130), 3);
            XBrush brush = new XSolidBrush();   // XColor.FromArgb(50, 106, 90, 205));

            // Stroke the outline of the path
            gfx.DrawPath(pen, brush, path);

            MemoryStream stream = new MemoryStream();
            document.Save(stream, false);

            Page.Response.Clear();
            Page.Response.ContentType = "application/pdf";
            Page.Response.AppendHeader("Content-Length", stream.Length.ToString());
            Page.Response.AppendHeader("Content-Type", "application/pdf");
            Page.Response.AppendHeader("Content-Disposition", "inline;filename=envelope.pdf");
            Page.Response.BinaryWrite(stream.ToArray());
            Page.Response.Flush();
            stream.Close();
            HttpContext.Current.ApplicationInstance.CompleteRequest();
        }
        catch (Exception ex)
        {
            throw ex;
        }
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T22:49:17.013

从理论上讲，您可以使用 css [http://www.w3.org/TR/css-print/](http://www.w3.org/TR/css-print/)来做到这一点。根据您必须支持的浏览器数量，它可能会带来很大的痛苦，因为它们的工作方式略有不同。

您可能会在页面大小和方向方面遇到一些问题，因为您的用户可能会使用许多不同的打印机。从 flash、pdf 或 silverlight 3 打印可能是最简单的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T22:45:35.773

您必须使用 activex 来执行此操作。

这可能有助于 [http://www.sharewareconnection.com/print-preview-activex-control.htm](http://www.sharewareconnection.com/print-preview-activex-control.htm)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-14T01:14:19.650

[您可以从此站点](http://www.angryox.com/web-envelopes/)打印信封。

它添加了条形码和所有内容。从网络打印。

# javascript - 将以下 jQuery 代码翻译成 YUI 2.x 代码

> ID：813523
> 
> 赞同：1
> 
> 时间：2009-05-01T22:13:44.167
> 
> 标签：javascript, jquery, dom, frameworks, yui

**免责声明：**我完全没有使用 YUI 的经验。

* * *

我想知道以下几行 jQuery 代码在用 YUI 编写时会是什么样子。此外，由于 YUI 使用分层依赖系统，`.js`需要包含哪些文件才能使代码正常工作？

**1\. 给定`ID`一个 HTML 元素，在元素上应用多个样式规则。**

```
$('#foo').css({ color: 'yellow', background: 'black' }); 
```

**2\. 链接：给定一个 HTML 元素的 ID，对其应用样式规则，为其添加一个类`bar`，并将其内容设置为“！”。**

```
$('#foo').css('color', 'red').addClass('bar').html('!'); 
```

**3\. 追加一个`LI`元素到`#menu`.**

```
$('#menu').append('<li>An extra item</li>'); 
```

**`LI`4\. 基本事件绑定：当一个元素被点击时显示一个警报。**

```
$('li').click(function() {
 alert('Clickety-click!');
}); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-01T22:31:51.877

免责声明：我不是 YUI 专家，可能有更好的方法来做这些事情。

此外，jQuery 擅长做你已经提出的事情。YUI 是为它的小部件构建的，所以你可能会发现它的核心功能不如 jQuery 的全面（即，它不会用函数调用代替你想要做的 DOM 的一切）。我觉得有人使用 YUI 2.x 因为他们想要小部件（我经常使用他们的菜单）。

#1：你需要包括这个：

```
<script type="text/javascript" src="http://yui.yahooapis.com/2.7.0/build/yahoo/yahoo-min.js"></script>
<script type="text/javascript" src="http://yui.yahooapis.com/2.7.0/build/dom/dom-min.js"></script> 
```

代码将是：

```
var el = YAHOO.util.Dom.get('foo');
YAHOO.util.Dom.setStyle(el, 'color', 'yellow');
YAHOO.util.Dom.setStyle(el, 'background', 'black'); 
```

或者...

```
YAHOO.util.Dom.setStyle('foo', 'color', 'yellow');
YAHOO.util.Dom.setStyle('foo', 'background', 'black'); 
```

#2：YUI 2.x 中没有链接，所以你的解决方案不会几乎相同：

```
var el = YAHOO.util.Dom.get('foo');
YAHOO.util.Dom.setStyle(el, 'color', 'red');
YAHOO.util.Dom.addClass(el, 'bar');
// Not sure how to set contents with YUI...  would just use:
el.innerHTML = "!"; 
```

反正我不关心链接，我认为这段代码更具可读性。（对不起社论。）

#3：同样，除了使用 innerHTML 之外，不知道如何直接设置 html ......我认为它只是：

```
var el = YAHOO.util.Dom.get('menu');
el.innerHTML += '<li>An extra item</li>'; 
```

#4：您必须为此解决方案包含不同的类：

```
<script type="text/javascript" src="http://yui.yahooapis.com/2.7.0/build/yahoo/yahoo-min.js" ></script>
<script type="text/javascript" src="http://yui.yahooapis.com/2.7.0/build/event/event-min.js" ></script> 
```

这是代码：

```
var lis = document.getElementsByTagName("li");
YAHOO.util.Event.addListener(lis, 'click', function() {
        alert('Clickety-click!');
    }); 
```

再次抱歉，这些可能不是倒数第二个 YUI 解决方案。此外，如果您担心“YAHOO.util.longname.method”的持续使用，您可以轻松地创建自己的局部变量。YUI 在他们的库中一直这样做：

```
(function() {
    var Event = YAHOO.util.Event;

    // Insert all your code here...
})(); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-01T22:55:40.150

[正如您从 Daniel 的回答中看到的那样，在 YUI 2 中编写代码非常冗长。在即将到来的 YUI 3](http://developer.yahoo.com/yui/3/)中已经完成了这方面的很多工作。以下是您的代码在 YUI 3 中的编写方式：

```
YUI().use('node', function(Y) {
    // #1
    Y.get('#foo').setStyles({ color: 'yellow', background: 'black' });

    // #2
    Y.get('#foo').setStyle('color', 'red').addClass('bar').set('innerHTML', '!');

    // #3
    Y.get('#menu').appendChild(Y.Node.create('<li>An extra item</li>'));

    // #4
    Y.all('li').on('click', function() {
        alert('Clickety-click!');
    });
} 
```

# c# - C#：自定义数组排序

> ID：813528
> 
> 赞同：1
> 
> 时间：2009-05-01T22:15:38.780
> 
> 标签：c#, arrays, sorting

我想在给定自定义映射的情况下对目录中的字符串数组进行排序（它实际上是根据行业对股票名称进行排序）。我不确定使用什么数据结构来表示映射，以及如何编写自定义排序方法。

例如，假设我有以下字符串数组：

```
string[] fileNames = "bac.csv", "c.csv", "cvx.csv", "java.csv", "msft.csv", "xom.csv"; 
```

这是映射：

```
{"bac", "c"} => 0
{"msft", "java"} => 1
{"xom", "cvx"} => 2 
```

我希望 string[] customSort(string[] fileNames) 返回以下内容：

```
"bac.csv", "c.csv", "java.csv", "msft.csv", "xom.csv", "cvx.csv" 
```

您将使用什么数据结构来表示映射，以及编写排序方法的优雅方式是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-01T22:20:29.627

Array.Sort 允许您指定一个键数组，因此您可以执行类似...

```
int[] keys = new int[fileNames.Length];

Dictionary<string, int> mapping = new Dictionary<string, int>(StringComparer.CurrentCultureIngoreCase);

// set up our mappings like so
mapping.Add("bac", 0);
mapping.Add("c", 0);
mapping.Add("msft", 1);
mapping.Add("java", 1);
mapping.Add("xom", 2);
mapping.Add("cvx", 2);
// etc

for(int i=0; i < keys.Length; i++)
{
    string token = System.IO.Path. GetFileNameWithoutExtension(fileNames[i]);

    int mappingKey;

    if(!mapping.TryGetValue(token, out mappingKey)) mappingKey = int.MaxValue;

    keys[i] = mappingKey; 
}

Array.Sort<int, string>(keys, fileNames); 
```

只需修改语句以从给定变量`keys[i] = -1;`的映射中获取正确的值。`token`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T22:17:50.927

嗯...似乎如果您的映射采用可用格式，您可以编写一个自定义[IComparer](http://msdn.microsoft.com/en-us/library/system.collections.icomparer(VS.85).aspx)实现并将其交给[Array.Sort](http://msdn.microsoft.com/en-us/library/system.array.sort(VS.85).aspx)。也许我在你的问题中遗漏了一些重要的细节？

# objective-c - Objective-C 的文档生成器？

> ID：813529
> 
> 赞同：49
> 
> 时间：2009-05-01T22:15:52.460
> 
> 标签：objective-c, documentation

是否有普遍接受的 Objective-C 文档生成器（类似于 RDoc for Ruby）？我见过 Doxygen 和 ObjcDoc，我想知道哪个是最广泛使用的。

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2009-05-02T00:19:45.547

[Doxygen](http://www.doxygen.nl)可能是使用最广泛的选择。因为它不仅仅适用于 ObjC（doxygen 支持许多其他语言），所以开发很活跃，社区也很强大。[相比之下， HeaderDoc](http://developer.apple.com/opensource/tools/headerdoc.html)（现在是一个开源项目）似乎基本停滞不前。HeaderDoc 只产生 HTML 输出，而 doxygen 也产生 PDF、LaTeX 和除 HTML 之外的许多其他输出形式。甚至 Apple 似乎也推荐使用 doxygen，通过[本](http://developer.apple.com/library/ios/#featuredarticles/DoxygenXcode/_index.html)指南从 Xcode 构建过程中自动生成与 Xcode 的帮助查看器兼容的文档集。

值得注意的是，doxygen 可以读取 HeaderDoc 样式的注释，因此您可以使用 HeaderDoc 样式编写文档，然后再决定是使用 doxygen 还是 HeaderDoc 生成最终输出。

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2011-06-26T22:18:39.750

查看[appledoc](https://github.com/tomaz/appledoc)。它基于[Doxygen](http://www.doxygen.org/)。您可以看到它吃自己的狗粮，因为它为[appledoc 源代码生成了](https://github.com/tomaz/appledoc)[appledoc 参考文档](http://www.gentlebytes.com/home/appledocapp/appledoc-documentation-comments/)。例如，与[Class Reference](http://www.gentlebytes.com/content/appledoc/exampledocv2/latest/Classes/GBComment.html)进行比较。[`GBComment.h`](https://github.com/tomaz/appledoc/blob/master/Model/GBComment.h)[`GBComment`](http://www.gentlebytes.com/content/appledoc/exampledocv2/latest/Classes/GBComment.html)

*   [appledoc：如何写评论](http://www.gentlebytes.com/home/appledocapp/appledoc-documentation-comments/)
*   [命令行设置的appledoc示例](http://www.gentlebytes.com/home/appledocapp/appledoc-documentation-settings/)

此外，请查看[Xcode 的文档集指南](http://developer.apple.com/library/mac/#documentation/DeveloperTools/Conceptual/Documentation_Sets/000-Introduction/introduction.html#//apple_ref/doc/uid/TP40005266-CH1-SW1)，了解有关如何创建适用于 Xcode 的文档的全面说明。这些是 appledoc 自动执行的指令。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-01T22:21:07.300

Doxygen 的应用非常广泛。我似乎也将它用作每周一次的 SO 答案。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2014-07-25T00:13:37.507

一个新工具是[Jazzy](https://github.com/realm/jazzy) by Realm，它以新的 Xcode 6 样式生成文档，并支持生成 Swift 文档（以及 Objective-C）。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-01T22:35:23.240

除了 doxygen，苹果还有一个工具，它是开发工具自带的。它生成您在诸如 SystenConfiguration 框架之类的东西上看到的文档类型。该工具名为 HeaderDoc，文档可在[HeaderDoc 用户指南](http://developer.apple.com/documentation/DeveloperTools/Conceptual/HeaderDoc/intro/intro.html)中找到。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-04-05T03:14:48.497

也许你应该试试[Realm](https://realm.io/)的[jazzy](https://github.com/realm/jazzy)。这是一个开源项目。支持 Objective-C 和 Swift。`jazzy`

“输出与 WWDC 2014 后 Apple 官方参考文档的外观和感觉相匹配。” 您可以从它提供的[示例文档中判断。](https://realm.io/docs/swift/latest/api/)

# asp.net - 从 *any* URL 的 aspx 页面打开新窗口

> ID：813531
> 
> 赞同：2
> 
> 时间：2009-05-01T22:17:37.510
> 
> 标签：asp.net, javascript, html, iis

是否有任何方法可以将 IIS 或 Web 应用程序配置为在单击超链接时自动打开一个新窗口？我的问题并不像听起来那么微不足道，让我解释一下...我知道您可以使用 JavaScript 或`target="_blank"`在锚标记中，但我并不总是知道何时可能会在页面上列出锚标记...

原因是它是一个用户论坛，想想堆栈溢出；）用户可能输入一个 URL（允许）并且它不一定是已知的，或者它是在很久以前输入的并且无法判断。

我很确定答案是否定的，我只需要在保存帖子/条目时分析 URL，然后将其转换为执行此操作。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-01T22:24:03.203

```
<html>
<head>
<base target='_blank'>  <!-- Here's the interesting bit -->
</head>
<body>
<p><a href='http://google.com'>New window!</a></p>
</body>
</html> 
```

当然，这确实会完成**所有**链接 - 如果您希望链接成为规则的例外，并在当前窗口中打开，请执行以下操作：

```
<p><a href='http://google.com' target='_self'>Not new window!</a></p> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-01T22:25:07.773

IIS 与它没有任何关系 - 没有编写一个可以重写所有链接的过滤器。我建议使用 JQuery，它应该很简单：

```
$(function() {
    $('A').attr('target', '_blank');
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-01T22:24:23.673

您可以创建一个捕获 ReleaseRequestState 事件的 HTTP 模块。然后您将过滤器附加到您的 HttpResponse。过滤器可以搜索`<a>`标签并将其添加`target='_blank'`到那些还没有标签的标签中。

# design-patterns - DRY 与“更喜欢包含而不是继承”

> ID：813534
> 
> 赞同：14
> 
> 时间：2009-05-01T22:18:57.647
> 
> 标签：design-patterns, oop

OO 设计的一般规则是，您应该使用继承建模 is-a 关系，使用包含/聚合和转发/委托建模 has-a 关系。GoF 的警告进一步缩小了这一范围，即您通常应该支持遏制而不是继承，这可能表明，如果您可以在特定情况下为任何一个提出强有力的理由，那么遏制通常应该由于维护而得到认可继承有时会导致问题。

我理解这种想法背后的原因，我不一定不同意。但是，当我看到一个包含许多方法的类时，每个方法都只是转发到某个实例变量，我看到了一种代码重复形式。在我看来，代码重复是最终的代码异味。仅仅因为两个类之间的关系不是严格意义上的 is-a 就重新实现一个庞大的方法协议似乎有点矫枉过正。它是添加到系统中的额外的、不必要的代码，现在需要像系统的任何其他部分一样测试和记录代码——如果您只是继承这些代码，您可能不必编写这些代码。

坚持这种包容胜过继承原则的成本是否超过了它的收益？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-01T22:27:22.527

几乎任何东西的成本都可能超过其收益。严格而快速，NO EXCEPTIONS 规则总是会让你在开发中遇到麻烦。通常，使用反射（如果您的语言/运行时支持它）来访问不打算对您的代码可见的变量是一个坏主意。这是一个不好的做法吗？与一切一样，

```
it depends. 
```

组合有时会比直接继承更灵活或更易于维护吗？当然。这就是它存在的原因。同样，继承可以比纯组合架构更灵活或更易于维护。然后你有接口或（取决于语言）多重继承。

这些概念都不是坏的，人们应该意识到，有时我们自己缺乏理解或对变革的抵制会导致我们制定武断的规则，将某事定义为“坏”而没有任何真正的理由这样做。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-01T23:13:27.003

你必须为手头的问题选择正确的解决方案。有时继承胜于包容，有时则不然。你必须使用你的判断力，当你不知道该走哪条路时，写一点代码，看看它有多糟糕。有时编写一些代码可以帮助您做出不那么明显的决定。

与往常一样：正确答案取决于很多因素，以至于您无法制定硬性规定。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-01T22:25:50.097

是的，你所看到的是来自宇宙不同角落的设计范式的可怕碰撞：GoF 的聚合/组合利用与“得墨忒耳法则”的碰撞。

我有记录认为，在聚合和组合使用的背景下，[得墨忒耳法则是一种反模式](https://stackoverflow.com/questions/406760/whats-your-most-controversial-programming-opinion/803784#803784)。

与此相反，我相信像这样的结构`person->brain->performThought()`是绝对正确和恰当的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-01T22:27:50.183

我同意你的分析，并且在这些情况下支持继承。在我看来，这有点像盲目地实现愚蠢的访问器以提供封装的天真努力。我认为这里的教训是，根本没有任何通用的规则总是适用的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-07T05:08:39.023

虽然我同意所有说“它取决于”的人的观点——而且它在一定程度上也依赖于语言——但我很惊讶没有人提到（用 Allen Holub 的名言）“[扩展是邪恶的](http://www.javaworld.com/javaworld/jw-08-2003/jw-0801-toolbox.html)”。当我第一次阅读那篇文章时，我不得不承认我有点被推迟了，但他是对的：不管是什么语言，**is-a 关系是最紧密的耦合形式**. 高继承链是一种独特的反模式。因此，虽然说您应该始终避免继承是不对的，但应该谨慎使用它（对于类——建议使用接口继承）。我的面向对象新手倾向于将所有内容建模为继承链，是的，它确实减少了代码重复，但代价是紧密耦合，这意味着不可避免的维护问题。

他的文章更好地解释了为什么继承是紧耦合的，但基本思想是 is-a 要求每个子类（以及孙子等）都依赖于祖先类的*实现*。“接口编程”是一种众所周知的降低复杂性和协助敏捷开发的策略。你不能真正编程到父类的接口，因为实例*就是*那个类。

另一方面，使用聚合/组合会强制进行良好的封装，从而使系统的刚性大大降低。将该可重用代码分组到一个实用程序类中，并通过 has-a 关系链接到它，您的客户端类现在正在使用根据合同提供的服务。您现在可以根据自己的喜好重构实用程序类；只要您符合接口，您的客户端类就可以很高兴地不知道更改，并且（重要的是）不必重新编译它。

我不建议将其作为一种宗教，只是一种最佳实践。当然，它们应该在需要时被打破，但通常有充分的理由认为“最好”在那个术语中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-01T22:35:54.610

这可能无法回答您的问题，但是关于 Java 及其 Stack 的一些事情一直困扰着我。堆栈，就我的知识范围而言，应该是一个非常简单（或者可能是最简单）的容器数据结构，具有三个基本的公共操作：pop、push 和 peek。为什么要在 Stack insertAt、removeAt 等中。什么样的功能？（在 Java 中，Stack 继承自 Vector）。

有人可能会说，好吧，至少您不必记录这些方法，但是为什么要使用一开始就不应该存在的方法呢？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-01T23:17:26.977

在某种程度上，这是一个语言支持的问题。例如，在 Ruby 中，我们可以实现一个在内部使用数组的简单堆栈，如下所示：

```
class Stack
  extend Forwardable
  def_delegators :@internal_array, :<<, :push, :pop
  def initialize() @internal_array = [] end
end 
```

我们在这里所做的只是声明我们想要使用其他类功能的哪个子集。真的没有太多的重复。哎呀，如果我们真的想重用其他类的所有功能，我们甚至可以在不实际重复任何内容的情况下指定它：

```
class ArrayClone
  extend Forwardable
  def_delegators(:@internal_array, 
                  *(Array.instance_methods - Object.instance_methods))
  def initialize() @internal_array = [] end
end 
```

显然（我希望），这不是我通常会编写的代码，但我认为它表明它可以完成。在没有简单元编程的语言中，通常保持 DRY 可能会有些困难。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-07T05:42:52.810

您可以考虑在抽象基类中实现“装饰器”代码（默认情况下）将所有方法调用转发到包含的对象。然后，子类化抽象装饰器并根据需要覆盖/添加方法。

```
abstract class AbstractFooDecorator implements Foo {
    protected Foo foo;

    public void bar() {
        foo.bar();
    }
}

class MyFoo extends AbstractFooDecorator {
    public void bar() {
        super.bar();
        baz();
    }
} 
```

如果您有许多包装特定类型的类，这至少消除了“转发”代码的重复。

至于指南是否有用，我认为应该强调“喜欢”这个词。显然，在某些情况下使用继承非常有意义。以下是[*不应*](http://java.sun.com/security/seccodeguide.html)[使用](http://java.sun.com/security/seccodeguide.html)[继承的示例](http://java.sun.com/security/seccodeguide.html)*：*

 *> Hashtable 类在 JDK 1.2 中得到了增强，包括一个新方法 entrySet，它支持从 Hashtable 中删除条目。Provider 类未更新以覆盖此新方法。这种疏忽允许攻击者绕过在 Provider.remove 中强制执行的 SecurityManager 检查，并通过简单地调用 Hashtable.entrySet 方法来删​​除 Provider 映射。

该示例强调了继承关系中的类仍然需要测试，这与只需要维护/测试“封装”式代码的暗示相反——维护从另一个继承的类的成本可能并不便宜正如它第一次出现的那样。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-05-01T22:57:32.297

到目前为止，GoF 是旧文本.. 取决于您所查看的 OO 环境（即使那样，很明显您也可以在对 OO 不友好的部分中遇到它，例如 C-with-classes）。

对于运行时环境，你几乎别无选择，单继承。任何试图规避其限制的解决方法就是这样，无论它看起来多么复杂或“酷”。

你会再次看到这无处不在，包括 C++（最有能力的），它与 C 回调接口（广泛到足以引起任何人的注意）。然而，C++ 为您提供了带有模板功能的混合和基于策略的设计，因此它有时可以帮助进行硬工程。

虽然包含可以为您提供间接的好处，但继承可以为您提供易于访问的组合。选择你的毒药.. 聚合端口更好，但看起来总是违反 DRY，而继承可以导致更容易重用不同的潜在维护问题。

真正的问题是，计算机语言或建模工具应该给你一个选项，它应该独立于选择做什么，从而减少人为错误的可能性；但是没有多少人在让计算机为他们编写程序之前建模+周围没有好的工具（Osla 当然不是）或者他们的环境正在推动像反射、IoC 之类的愚蠢的东西......这是非常流行的并且在本身就说明了很多。

曾经有一个古老的 COM 技术被世界上最好的 Doom 玩家之一称为 Universal Delegator，但它不是现在任何人都会采用的那种开发。它确实需要接口（而不是真正的接口） -一般情况下的硬要求）。这个想法很简单，它早于中断处理。只有类似的方法才能为您提供两全其美的方法，并且它们在 JavaScript 和函数式编程等脚本片段中有些明显（尽管可读性或执行性要差得多）。

# activerecord - 为什么activerecord乐观锁定每行只工作一次？

> ID：813535
> 
> 赞同：5
> 
> 时间：2009-05-01T22:19:03.747
> 
> 标签：activerecord, locking, optimistic-locking, optimistic

不知何故，我总是在星期五得到这些。

我之前的问题是关于同样的问题，但我现在可以缩小范围：

我整天都在玩这个，试图理解它。我有一个带有 lock_version 列的表，指定如下：

```
add_column :jobs, :lock_version, :integer, :default=>0 
```

我做这样的事情：

```
foo = job.create!
first = Job.find(foo.id)
second = Job.find(foo.id) 
```

然后我验证第一个和第二个引用同一个对象 - 它们的 ID 相同，并且我使用 mysql 命令行工具在数据库中看到该行。

```
first.some_attribute_field = 'first'
second.some_attribute_field = 'second'
first.save
second.save 
```

到目前为止没有问题。我正确地得到了一个 ActiveRecord::StaleObjectError 异常。 **但是**：

```
first = Job.find(foo.id)
second = Job.find(foo.id)
first.some_attribute_field = 'first'
second.some_attribute_field = 'second'
first.save
second.save 
```

……什么也没有发生。事实证明，我唯一一次得到正确（抛出异常）行为是当 first 和 second 的 lock_version 为 0 时。但是，在第一次保存之后，它不再是 0。这到底是怎么回事？

我正在使用 ruby​​ 1.8.6 和活动记录 2.2.2

谢谢...

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-07T13:11:02.033

当您第二次调用 first.save 时， some_attribute_field 的值已经等于“first”，activerecord 知道这一点，因此它不会在数据库中更新到 lock_version 不会增加。第二次保存有效，因为数据库从未随着“第一次”而改变。

尝试将第二个测试中的值更改为“第一个”以外的值，使其与数据库中的值不同。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-04T17:20:25.953

我不是 Ruby 人，但乐观锁定对我来说很熟悉，所以我会尽力帮助您调试它。

我认为第二次保存实际上更新了数据库。如果两个对象都有不同的 lock_version 并且 lock_version 在 UPDATE 中使用，那根本不可能（UPDATE 将更新零行）。所以，我们只有两种选择：

*   lock_version 未在 UPDATE 语句中使用或使用不正确
*   两个对象都以某种方式获得了相同的 lock_version

（*实际上，还有第三种选择：两个 save() 都在他们自己的事务中，但我觉得你有 AUTOCOMMIT=true*）

你能让实际的 SQL 语句可见吗？更新语句应类似于

```
... WHERE JOB_ID=123 AND LOCK_VERSION=8 
```

当您手头有实际的查询时，就会更容易理解正在发生的事情。

PS还有一个：在另一个主题的示例中，您有这个对象：

```
#<Job id: 323, lock: 8, worker_host: "second"> 
```

如果与加载时间相比属性未更改，则容器可能会忽略 save() 调用。我不知道 ActiveRecord 是否有这种优化。但是如果是这样，那么第二个 save() 将被忽略，并且乐观锁定没有机会启动。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-10T14:10:11.820

正如弗拉基米尔所说，您的测试/示例代码有点缺陷。在第二次保存期间，First 不会存储在数据库中！() 因为没有属性更改。请参见以下示例：

```
foo = Account.create!

first = Account.find(foo.id)
first.cash = 100
first.save!

first = Account.find(foo.id)
first.cash = 100

puts "First lock before " + first.lock_version.to_s
first.save!
puts "First lock after " + first.lock_version.to_s 
```

这会产生：

```
% script/runner another_tester.rb                               
First lock before 1
First lock after 1 
```

在 2.3.2 版本的 rails 中使用您的示例在保存秒时（两次都！）

# ruby - 如何使用鞋子中的进度条？

> ID：813542
> 
> 赞同：1
> 
> 时间：2009-05-01T22:23:11.460
> 
> 标签：ruby, progress-bar, shoes

好的，所以我不太确定鞋子中的很多东西，但是到目前为止，我的反复试验方法让我在这方面失败了。

我有一个类进行某种需要一段时间的计算，我想抛出一个进度条供用户在它完成时查看。如果通过一个块，我的计算密集型方法会产生其完成百分比：

```
class MathyStuff

  def initialize()
  end

  ## Some expensive, time consuming method which yields it's percent complete
  def expensiveMethod(&block)
    0.upto(100) do |i|
      0.upto(100000) do |j|
        k = j;
      end

      yield i.to_f/100;
    end
  end

end 
```

以下是我想*在*鞋子中说的话：

```
require 'MathyStuff.rb'

Shoes.app do

  @myMathyStuff = MathyStuff.new();

  button("Do expensive mathy thing...") do
    window() do
      @progress = progress();
      @myMathyStuff.expensiveMethod() {|percent| @progress.fraction = percent;}
    end
  end

end 
```

但这似乎不起作用。我尝试过使用/不使用窗口调用，我尝试过各种方式的 animate()，我什至尝试调用 Thread.new 并将它传递给窗口块，让它们通过 Shoes.APPS()[0].get 交谈/setPercent 方法；似乎没有什么能正常工作。

也许我没有按照预期的方式使用进度条。再说一遍，进度条还有什么用途？;-)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-02T18:57:32.380

首先，在 Shoes 的两个窗口之间共享数据是一件非常痛苦的事情。我不推荐它。相反，隐藏第一个窗口的内容并在其位置显示进度条。

其次，我们将扩展 MathyStuff 以将其从处理块转换为提供百分比属性，因此我们可以从动画线程访问它：

```
class MathyStuff
  attr_accessor :percent

  def expensiveMethodWrapper
    @percent = 0.0
    expensiveMethod {|x| @percent = x}
  end
end

Shoes.app do

  @myMathyStuff = MathyStuff.new();
  @window_slot = stack do
    button("Do expensive mathy thing...") do
      @window_slot.toggle
      @progress_slot = flow do
        @progress = progress :width => 1.0
      end
    end
    Thread.new do
        @myMathyStuff.expensiveMethodWrapper
    end
    @animate = animate do
      @progress.fraction = @myMathyStuff.percent
      if @myMathyStuff.percent == 1.0
        @progress_slot.remove
        @window_slot.toggle
        @animate.stop
      end
    end
  end
end 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-02T19:22:04.973

据我了解，进度条之类的内容需要在输入百分比值后重新绘制到屏幕上，这就是您在这种情况下使用动画的目的。

如果您只想做您在问题中所说的，那么这种方法 - 虽然不是很灵活 - 确实适用于您的示例。但是因为它将进度逻辑与实际方法分开，所以您只能在运行这些方法之前和之后更改百分比值。所以，既然你只是运行了 100 次迭代，那么你可以通过这种方式有效地完成它。

```
class Mathy
  def foo
    100000.times do |bar|
      foo = bar
    end
  end
end

Shoes.app do
  @mathy = Mathy.new
  button("Run") do
    @p = progress
    animate do |percent|
      break if percent > 100
      @mathy.foo
      @p.fraction = percent.to_f / 100
    end
  end
end 
```

如果您的方法不仅仅是重复相同的迭代，那么是的，您希望在方法中经常产生它的进度。然后，为了在该方法运行时从该方法返回该进度，您可以按照 Pesto 的建议将它放在一个单独的线程中，然后轮询它以获取动画块中的进度。使用 attr_accessor 返回百分比也是一个好主意。希望有帮助。

# c# - 就地更改值而不是创建新实例

> ID：813543
> 
> 赞同：2
> 
> 时间：2009-05-01T22:23:34.593
> 
> 标签：c#, .net, performance

基本上我已经检查了 xna 和一些 slimdx (Promit :))，它们有很多结构。几乎所有看起来像这样的方法：

```
public static Vector3 operator + ( Vector3 a, Vector3 b ) 
```

在哪里做类似的事情：

```
Vector3 c = new Vector3 ( ... ) 
```

我想知道这样做是否有意义：

```
a.X += b.X
...

return a 
```

显然#1 看起来更明智/合理，但#2 并没有创建更快的新 Vector3。

我认为它既快速又清晰，甚至不如#1 更清晰。

哪一个更好？#2有问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T22:41:01.540

2 的唯一问题是，由于 Vector3 是一种值类型（有充分的理由，请参阅[Rico Mariani 的博客](http://blogs.msdn.com/ricom/archive/2006/08/31/performance-quiz-11-ten-questions-on-value-based-programming.aspx)了解详细信息），当它们是集合的一部分或用作属性成员时，您无法就地编辑。

例如，有一个 List<Vector3> 成员是很常见的，但如果你这样做：

```
myList[150].X += ...; 
```

它失败了，因为索引器返回一个新结构（值类型语义）。将值类型视为不可变通常更安全，这需要您的第一个语法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T22:31:29.863

我真的怀疑您是否会非常担心需要执行此操作的性能。做#1。

“过早的优化是万恶之源。” ——唐纳德·克努斯

# wpf - 如何使用 wpf (powerboots) 显示 Twitter 状态（伪 html）

> ID：813544
> 
> 赞同：2
> 
> 时间：2009-05-01T22:23:57.387
> 
> 标签：wpf, powershell, twitter

我有这样的文字：'IIS7 上的 Rails [http://is.gd/vWPn](http://is.gd/vWPn) '（这是 shanselman 的推文）。我想以某种方式使用 wpf 显示它。我应该如何预处理文本以及使用什么控件？

当前的解决方案是我创建 2 个控件：标签和超链接并将它们添加到 TextBlock 中。在 powerboots 中它看起来像这样：

```
boots { border -borderthickness 10 -cornerradius 10 -borderbrush orange `
  { textblock { `
     label 'Rails on IIS7' -backgr green; hyperlink 'http://is.gd/vWPn' -backg 'red' } `
} } -width 400 
```

然而它看起来很奇怪——超链接被移动了，我不知道为什么。[替代文字 http://img12.imageshack.us/img12/1363/powerbootshl.jpg](http://img12.imageshack.us/img12/1363/powerbootshl.jpg)

还有一个问题 - 可以使用 Label 来显示文本吗？我问是因为标签似乎无法包装它的内容。我应该使用 TextBlock 还是完全其他的东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-02T03:48:22.583

老实说，我对 PowerBoots 一无所知。然而：

我认为就文本预处理而言，您走在正确的轨道上。您将需要解析*推文*中的文本并弄清楚什么是`@`参考，什么是 a`hyperlink`等。

有了这些知识，您就可以开始填充您的 TextBlock，正如我认为您已经尝试在您提供的代码中所做的那样。但是，您认为 a`Label`不是正确的选择是正确的。实际上，您想要的 Element 称为 a `Run`。A`Run`只不过是一段文本，因此是这个术语。最终，对于您的简单示例，代码如下所示：

```
boots { border -borderthickness 10 -cornerradius 10 -borderbrush orange `
{ textblock { `
    run 'Rails on IIS7' -backgr green; hyperlink 'http://is.gd/vWPn' -backg 'red' } `
} } -width 400 
```

假设我正确掌握了 PowerBoots 的语法。

# java - 高可用性和灾难恢复软件 AntiPatterns

> ID：813556
> 
> 赞同：3
> 
> 时间：2009-05-01T22:27:57.737
> 
> 标签：java, design-patterns, anti-patterns, high-availability, disaster-recovery

如果您必须在涉及高可用性和灾难恢复时审核 Java 应用程序的最差做法，您可能会寻找硬编码的 IP 地址和绑定句柄的次优缓存。还应该考虑什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-01T23:15:47.463

缺少动作/状态记录。

Java 应用程序应该能够从崩溃时的位置恢复。
这意味着应该有一种机制能够记录已经完成的事情（以免在下一次运行时重新做所有事情）。

*这也意味着这样的 Java 程序应该总是在相同*的一组动作之后达到相同的状态。（做某事两次会导致相同的结果，已经做过的动作不应该再做，而只是跳过）

该记录可以采用多种形式（文件、数据库、存储库中的元数据等），但重点是：愿意尽快恢复的 Java 应用程序应该知道它已经完成了什么。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-01T22:30:46.433

缺乏监控设施。迟早，所有应用程序都会失败。发生这种情况时，您会想在其他人之前了解它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-01T22:33:07.597

缺乏日志记录。如果您找不到杀死您的应用程序的原因，那么很难修复它。当您遇到具有难以重现的情况的非常间歇性故障时，这尤其令人讨厌。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-01T23:38:33.213

由于已经提到了适当的监控，我想补充一下，制定一个应急计划。它可以很简单：如果发生这种情况，那么我们就这样做，如果发生其他事情，那么我们就这样做。然后，当问题发生时，您只需遵循（先前测试过的）计划，而不是让每个人都惊慌失措并迅速做出决定。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-07-12T19:09:39.397

在我看来，您所问的问题有几个关键方面。我不认为它是特定于语言的，并且您以 java 应用程序为例，所以我希望您不介意我不专门谈论 Java。

*故障转移/HA*：这是您识别 SPoF（单点故障）的地方。示例包括您提到的硬编码地址，以及以不可复制方式（例如本地磁盘）存储数据的应用程序。其他项目可能是缓存 DNS 查找“太长”，没有重新建立断开的连接，查找特定的硬件信息（例如 MAC 地址、CPUID、加密狗、分区标签、MB 或驱动器序列号等）。我已经将所有这些问题视为导致 BCP/DR 正常工作的不必要变通办法的问题。

*数据完整性*：数据如何存储？它是否使用自定义格式/结构？如果是这样，是否有“转储和恢复”机制？该服务是否需要停止为客户端提供服务，或者是否会降低其服务以进行备份？它是否将数据异步写入设备，如果是这样，它多久“刷新”到磁盘（有时这取决于应用程序，其他则不是）？文件锁定、内存到持久存储时间框架和功能也是其中的一部分。

从本质上看是什么导致你不得不解决。然后看看它是如何发生的，您可能会开始开发两个重要的知识：用于改进 BCP/DR 的模式，以及如您所提到的导致问题的 AntiPatterns。在可行的情况下尽早将这些类型的问题注入开发过程将帮助您的开发人员推导出您正在寻找的模式和反模式。通常只是提出问题就可以避免问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-02T08:19:13.087

最好的办法是安排一些停机时间并进行测试。这样做你会发现更多的问题。一旦你把所有的东西都记录在案，让其他人在没有你帮助的情况下完成它。;)

# apache-flex - Flex：HBox 中的容器滚动条

> ID：813558
> 
> 赞同：0
> 
> 时间：2009-05-01T22:28:42.460
> 
> 标签：apache-flex, scrollbar, scroll, hbox

我的 flex 应用程序中有一个 HBox。问题是，当 HBox 内的东西太多时，应用程序底部会出现滚动条。我怎样才能让它出现在 HBox 中，所以滚动条只滚动 HBox 内的东西而不是整个应用程序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-02T12:25:08.970

尝试在 HBox 周围创建一个画布。如果把Canvas的宽度声明为100%，应该就是舞台的宽度，当里面的HBox变宽时，应该会出现一个滚动条。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T22:40:54.677

```
<Application 
xmlns="http://www.adobe.com/2006/mxml" 
horizontalScrollPolicy="off">
    <HBox width="100%">
    ... 
```

我相信这应该有效。

# c# - 使用 C# ，LINQ 如何一次又一次地在标记之间挑选项目？

> ID：813560
> 
> 赞同：5
> 
> 时间：2009-05-01T22:28:57.763
> 
> 标签：c#, linq

假设我有一个字符串数组：

```
string[] strArray = {"aa", "bb", "xx", "cc", "xx", "dd", "ee", "ff", "xx","xx","gg","xx"}; 
```

如何使用 LINQ 将“xx”标记之间的字符串提取为组？

通过将它们写入控制台来说：

```
cc
dd,ee,ff
gg 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-01T22:38:23.403

纯功能解决方案（无突变）：

```
string[] strArray = { "aa", "bb", "xx", "cc", "xx", "dd", 
                      "ee", "ff", "xx", "xx", "gg", "xx" };

var result = 
 strArray.Aggregate((IEnumerable<IEnumerable<string>>)new IEnumerable<string>[0],
   (a, s) => s == "xx" ? a.Concat(new[] { new string[0] })
      : a.Any() ? a.Except(new[] { a.Last() })
                   .Concat(new[] { a.Last().Concat(new[] { s }) }) : a)
         .Where(l => l.Any());

// Test
foreach (var i in result)
  Console.WriteLine(String.Join(",", i.ToArray())); 
```

如果要过滤掉最后一个标记之后的结果：

```
string[] strArray = { "aa", "bb", "xx", "cc", "xx", "dd", 
                      "ee", "ff", "xx", "xx", "gg", "xx"};

var result = 
  strArray.Aggregate(
    new { C = (IEnumerable<string>)null, 
          L = (IEnumerable<IEnumerable<string>>)new IEnumerable<string>[0] },
    (a, s) => s == "xx" ? a.C == null
        ? new { C = new string[0].AsEnumerable(), a.L }
        : new { C = new string[0].AsEnumerable(), L = a.L.Concat(new[] { a.C }) } 
        : a.C == null ? a : new { C = a.C.Concat(new[] { s }), a.L }).L
          .Where(l => l.Any());

// Test
foreach (var i in result)
  Console.WriteLine(String.Join(",", i.ToArray())); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-02T00:24:42.760

更好的方法可能是编写一个通用的`IEnumerable<T>`拆分扩展方法，然后选择您想要的结果的哪些部分。

```
public static class IEnumerableExtensions
{
  public static IEnumerable<IEnumerable<TSource>> Split<TSource>(
                     this IEnumerable<TSource> source, TSource splitter)
  {
    if (source == null)
      throw new ArgumentNullException("source");
    if (splitter == null)
      throw new ArgumentNullException("splitter");

    return source.SplitImpl(splitter);
  }

  private static IEnumerable<IEnumerable<TSource>> SplitImpl<TSource>(
                     this IEnumerable<TSource> source, TSource splitter)
  {
    var list = new List<TSource>();

    foreach (TSource item in source)
    {
      if (!splitter.Equals(item))
      {
        list.Add(item);
      }
      else if (list.Count > 0)
      {
        yield return list.ToList();
        list.Clear();
      }
    }
  }
} 
```

像这样使用它

```
static void Main(string[] args)
{
  string[] strArray = { "aa", "bb", "xx", "cc", "xx", "dd",
                        "ee", "ff", "xx", "xx", "gg", "xx" };

  var result = strArray.Split("xx");
  foreach (var group in result.Skip(1).Take(3))
  {
    Console.WriteLine(String.Join(",", group.ToArray()));
 }

  Console.ReadKey(true);
} 
```

你得到想要的输出

```
cc
dd,ee,ff
gg 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-07-27T15:17:01.807

添加以下扩展方法：

```
public static class SplitExtensions {
    public static IEnumerable<IEnumerable<T>> SplitBy<T>(this IEnumerable<T> src, T separator) {
        var group = new List<T>();
        foreach (var elem in src){
            if (Equals(elem, separator)){
                yield return group;
                group = new List<T>();
            } else{
                group.Add(elem);
            }
        }
        yield return group;
    }
} 
```

这是它的用法：

```
string[] strArray = { "aa", "bb", "xx", "cc", "xx", "dd", "ee", "ff", "xx", "xx", "gg", "xx" };
var groups = from g in strArray.SplitBy("xx")
             where g.Any()
             select g; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-01T22:55:59.353

您可以使用每次遇到“xx”字符串时增加的组计数器为项目分配组编号。然后过滤掉“xx”字符串，按组号分组，过滤掉空组：

```
int group = 0;
var lines =
   strArray
   .Select(s => new { Group = (s == "xx" ? ++group : group), Value = s })
   .Where(n => n.Value != "xx")
   .GroupBy(n => n.Group)
   .Where(g => g.Count() > 0);

foreach (var line in lines) {
   Console.WriteLine(string.Join(",", line.Select(s => s.Value).ToArray()));
} 
```

编辑：
此解决方案还将删除第一个标记之前和最后一个标记之后的项目：

```
int group = 0;
var lines =
   strArray
   .Select(s => new { Group = s == "xx" ? group++ : group, Value = s })
   .GroupBy(n => n.Group)
   .Skip(1)
   .Where(g => g.Last().Value == "xx" && g.Count() > 1);

foreach (var line in lines) {
   Console.WriteLine(string.Join(",", line.Take(line.Count() - 1).Select(s => s.Value).ToArray()));
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-01T22:46:01.560

分区列表/数组并不是 LINQ 特别适合的。如果你想让它与 LINQ 兼容（即完全惰性序列），我建议你编写自己的扩展方法，该方法返回`IEnumerable<IEnumerable<T>>`使用迭代器（关键字）。`yield`如果您不关心惰性求值，那么最简单的方法可能就是编写一个方法，该方法通过遍历数组并最终返回一个锯齿状数组 ( `string[][]>`) 来生成一个列表。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-05-01T22:39:54.837

您只能选择不是“xx”的那些，但如果每次找到一个时都需要换行，那么您必须使用（for/for each）而不是查询。

提取“xx”的查询将是

```
from s from array
where s != "xx"
select s 
```

# python - 在 Python 程序中嵌入 Python shell

> ID：813571
> 
> 赞同：11
> 
> 时间：2009-05-01T22:31:41.517
> 
> 标签：python, shell

我正在用 Python 做一个科学实验室，用户可以在其中创建、修改和分析各种对象。我想在程序中放置一个 Python shell，以便用户可以通过 shell 操作对象。（注意：他还可以通过通常的 GUI 操作对象。）

说明这一点的模型：http: [//cool-rr.com/physicsthing/physicsthing_mockup_thumb.gif](http://cool-rr.com/physicsthing/physicsthing_mockup_thumb.gif)

我怎么能做出这样的事情？

我考虑过 using `eval`，但我知道`eval`不能处理`import`，例如。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-01T22:38:19.847

您正在寻找[代码 - 解释器基类](http://docs.python.org/library/code.html)，尤其是 code.interact()。

[来自 effbot](http://effbot.org/librarybook/code.htm)的一些示例。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-02T12:48:42.923

根据您的 GUI 框架，它可能已经完成：

*   对于 wxpython，查找“PyCrust”——它很容易嵌入到您的应用程序中
*   对于 PyQt，[pyqtshell](http://code.google.com/p/pyqtshell/) （**更新 29.04.2011：**这些天称为`spyder`）

以下是我将 PyCrust 嵌入到应用程序中的操作：

```
import wx.py.crust
...
...
# then call

crustFrame = wx.py.crust.CrustFrame(parent = self)
crustFrame.Show() 
```

这里`self`指的是我的主框架（源自`wx.Frame`）。这将创建一个在您的应用程序中运行的 PyCrust 窗口，并允许您检查存储在主框架中的所有内容（因为`self`.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-01T23:47:40.943

FWIW，我相信 Enthought 已经编写了类似的东西，用于他们基于 Python（和基于 NumPy）的可视化套件。两年前我看过一个演示，他们确实让您可以直接通过 GUI 或 Python 解释器操作对象。

此外，要添加到第一个答案，您可能必须继承 code.InteractiveConsole 以覆盖 self.read() 和 self.write()，以便它们与 GUI 交互。而且您还必须将 sys.stdout 和 sys.stderr 重定向到一些可写入的类，该类写入同一个控制台。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-01T22:37:13.390

Python`eval()`函数只处理表达式。您可能需要考虑使用该[`exec`](http://docs.python.org/reference/simple_stmts.html#grammar-token-exec_stmt)语句，它可以运行任意 Python 代码。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-19T12:24:07.233

我使用 pdb.set_trace() 作为外壳。它还具有一些调试功能:)

# scheme - 当省略“else”时，Scheme 的“cond”子句会发生什么？

> ID：813587
> 
> 赞同：10
> 
> 时间：2009-05-01T22:37:06.433
> 
> 标签：scheme, racket

我正在学习Scheme。我最近花了（太多！）时间试图找到程序中的错误，然后才意识到我在 cond 子句中错过了“else”词。但是在这种情况下的行为似乎有点奇怪。只用一个简单的程序（如下）试验条件，“whatever”会在 else 子句中按预期显示，但也会显示，但没有“else”，会显示周围的双引号和未解释的新行字面上打印。谁能向我解释发生了什么？TIA。

```
 (define (foo x)
    (cond ((eq? x 0) (display "zero\n"))
          (display "whatever\n")))

   (define (bar x)
    (cond ((eq? x 0 ) (display "zero\n"))
          (else (display "whatever\n"))))

In the repl window:
Welcome to DrScheme, version 4.1.5 [3m].
Language: Pretty Big; memory limit: 128 megabytes.
> (foo 0)
zero
> (bar 0)
zero
> (foo 2)
"whatever\n"
> (bar 2)
whatever
> 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-05-01T22:52:11.203

“else”只是“true”的同义词。读取 cond 的方法是一系列测试，其中第一个为真的测试会导致对该表单进行评估。

```
(cond  ( (test) (do this) )
       ( (test) (do this) ) ) 
```

这是你的第一个

```
 (cond ((eq? x 0) (display "zero\n"))
        (display "whatever\n"))) 
```

cond 看着`(eq? x 0)`并确定这是错误的。下一个子句是`(display "whatever\n")`。它看起来`display`，因为`display`不是`nil`，所以它是真的。然后它评估 string `"whatever\n"`，它只是评估自己。所以 cond 的值是 then `"whatever\n"`。

现在，这是你的第二个：

```
(cond ((eq? x 0 ) (display "zero\n"))
       (else (display "whatever\n")))) 
```

在这里，第一个测试是假的，它继续到第二个测试，它是`else`并且评估为真。（如果你想一想，这就是“else”在正常的 if-then-else 中的含义：“对于所有以前的测试都不为真的情况下为真。”）

现在，它后面的形式是`(display "whatever\n")`。这是一个将字符串参数发送到控制台并且不返回任何内容的函数，因为这是 display 发生的事情。在另一种方案中，它可能会返回其字符串值并打印它，在这种情况下您会看到

```
whatever
"whatever\n" 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-01T22:43:02.893

在`foo`函数中，`cond`语句评估`display`为要测试的条件。因为确实有一个叫做 的符号`display`，它的计算结果为真，所以`"whatever\n"`然后计算 的结果`(foo 2)`。

# excel - 如何在 Excel 中获得评论的加权平均值？

> ID：813591
> 
> 赞同：1
> 
> 时间：2009-05-01T22:37:49.973
> 
> 标签：excel, math, statistics, analytics

所以这是我的挑战。我有一个如下所示的电子表格：

```
prod_id | pack  | value | durable | feat | ease | grade  | # of ratings
1         75      85      99        90     90     88       1
2         90      95      81        86     87     88       9
3         87      86      80        85     82     84       37
4         92      80      68        67     45     70       5
5         93      81      94        93     90     90       4
6         93      70      60        60     70     70       1 
```

每个产品都有单独的等级标准（包装 - 易用性）、总体平均等级和产品收到的评级数量。

我拥有的整个数据集将 68% 的产品置于 80-89 级范围内。我需要重新计算评分以考虑产品的评分数量，因此远低于平均评分总数的产品排名较低（并获得较低的评分）。基本上，等级为 84 和 100 的产品的排名应该高于等级为 95 且只有 5 个等级的产品。

我希望这是有道理的，提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T22:54:12.150

没有计算器我无法准确判断，但它看起来像

```
Grade = AVG(pack, value, durable, feat, ease) 
```

如果是这种情况，那么您只需定义“远低于总平均评分数”。我将权衡与平均值的标准差 - 这可能是也可能不是一个体面的算法（我不是统计学家）。但是，这意味着任何评分恰好是平均值 = 1，并且您从那里得到 +/-。

```
WeightedGrade = Grade * ABS((Rating - AVG(H:H)) / STDEV(H:H)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T22:55:20.900

您需要的是一种有意义的加权算法。您可以选择任何对您有意义的东西，但首先要根据您的要求尝试将原始等级乘以权重因子。计算作为评分数除以总评分数的比率给出的答案：

```
prod id raw grade   # ratings   weight          weighted grade
1         88          1           0.01754386      1.543859649 
2         88          9           0.157894737     13.89473684
3         84          37          0.649122807     54.52631579
4         70          5           0.087719298     6.140350877
5         90          4           0.070175439     6.315789474
6         70          1           0.01754386      1.228070175
                       57 
```

不确定这是否对您的问题有意义，但它确实满足您的要求。也许您可以将加权成绩标准化，因此 prod id # 3 为 100，然后再按比例缩放其余部分。

查看[“集体智能”](https://rads.stackoverflow.com/amzn/click/com/0596529325)以了解其他一些想法。

# jquery - jQuery UI 选项卡后退按钮历史记录

> ID：813601
> 
> 赞同：33
> 
> 时间：2009-05-01T22:41:02.633
> 
> 标签：jquery, user-interface, tabs, history, back

有没有人能够让 jQuery UI Tabs 3（最新版本）使用后退按钮？

我的意思是，如果用户点击后退按钮，他们应该转到页面上先前访问的选项卡，而不是其他页面。

历史插件听起来好像可以工作，但我似乎无法让它与 ajax 加载的选项卡一起工作。

如果有人设法完成这项工作，将不胜感激，谢谢！

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2010-07-25T20:40:56.940

我也遇到了这个。在这里使用 jquery 地址插件真的很容易[http://www.asual.com/jquery/address/](http://www.asual.com/jquery/address/)

选项卡的演示似乎有点过于复杂。我只是这样做了：

```
$('document').ready(function() {
    // For forward and back
    $.address.change(function(event){
      $("#tabs").tabs( "select" , window.location.hash )
    })

    // when the tab is selected update the url with the hash
    $("#tabs").bind("tabsselect", function(event, ui) { 
      window.location.hash = ui.tab.hash;
    })
}); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-01T22:50:51.830

我建议看一下： [http](http://www.asual.com/jquery/address/) ://www.asual.com/jquery/address/它允许您进行深度链接以及 AJAX 调用。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-02-26T04:39:14.253

更新：我发布的解决方案没有解决我描述的问题^^如果我记得我解决它时会再次发布。Update2：我现在已经“解决”了这个问题（见下文）。

问题有点老了，但是如果有人像我一样偶然发现了这个问题，那么 Justin Hamade 对上述解决方案的快速更改可能会对某些人有所帮助。

如果您使用 Jquery Address 的 externalChange 事件而不仅仅是“更改”，它会阻止发送多余的请求（在我的情况下导致 javascript 控制台中的错误）。这是因为如果有人单击一个选项卡，地址会自行更改（感谢 jquery ui），这个更改会触发 $.address.change 一次，即使 jquery-ui 已经这样做了，它也会选择一个选项卡......至少我认为这就是发生了什么。

此外，我不喜欢创建像“#ui-tab-2”、“#ui-tab-3”等哈希值的选项卡，所以我使用以下代码使 url 使用锚元素的名称作为哈希值（即“www.example.com#cool_stuff”而不是“www.example.com#ui-tab-2”）：

```
$(function() {
  $( "#tabs" ).tabs({
    cache: false,
  });

  // For forward and back
  $.address.externalChange(function(event){
    var name = window.location.hash != "" ? window.location.hash.split("#")[2] : ""
    $("#tabs").tabs( "select" , $("#tabs a[name="+ name + "]").attr('href') )
  });
  // when the tab is selected update the url with the hash
  $("#tabs").bind("tabsselect", function(event, ui) { 
    $.address.hash(ui.tab.name);
  });

}); 
```

但是，A）我是 jquery 的新手，不确定这是否有效/安全/“正确的方法”，并且 B）只有在您可以确定锚点的“名称”属性时才确保使用它没有任何不是 URI 安全的字符（即空格）。

Update2：我现在已经“解决”了 Update1 中的问题，但它有一条非常难看的线：

```
var name = window.location.hash != "" ? window.location.hash.split("#")[2] : "" 
```

因为显然 $.address.hash(val) 函数在第一个哈希之后添加了一个“/#”，但是如果我们不使用 $.address.hash(val) 则触发 externalChange（由 window.location.hash =val)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-01T22:59:47.800

看来，后退按钮支持当前未内置到 jQuery UI 选项卡中：http: [//jqueryui.com/demos/tabs/#Back_button_and_bookmarking](http://jqueryui.com/demos/tabs/#Back_button_and_bookmarking)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-09-27T09:16:00.893

我正在使用这个插件：[http ://flowplayer.org/tools/demos/tabs/ajax-history.htm](http://flowplayer.org/tools/demos/tabs/ajax-history.htm)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-01T23:19:34.133

jQuery [History/Remote](http://stilbuero.de/jquery/history/index.html)插件就是这样做的。选项卡和历史/远程插件的创建者是同一个人，并让他们在[这里](http://www.stilbuero.de/jquery/tabs/)一起工作。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-02-14T14:47:46.603

您可以参考打开选项卡的按钮的链接，并将其写入历史记录。之后添加“EventListener”，我们在它的帮助下跟踪“window.location.hash”的变化，并且在任何变化时我们人为地按下带有这样一个链接的按钮。因此，在后退按钮的帮助下历史中的转换将起作用。

```
$(".btn").click(
        function () {
            window.location = this.href;
        });
    window.addEventListener('hashchange', function () {
        var x = `[href="${window.location.hash}"]`;
        $(x)[0].click();
    });
```

# .net - 在 .NET 2008 (C#) 应用程序中添加对 Apache Tomcat 的 Web 服务引用失败

> ID：813605
> 
> 赞同：0
> 
> 时间：2009-05-01T22:43:21.520
> 
> 标签：.net, web-services, apache, tomcat

我一直在尝试添加对位于 Apache Tomcat Web 服务器上的 Web 服务的 Web 引用，但我总是收到“HTTP 状态 503：服务不可用”。有人告诉我，问题在于 Tomcat 在请求 wsdl 时不允许 2 个 HTTP 参数。

我试图检索 wsdl 的 URL 如下所示：

[http://208.35.164.35:1234/abc/soap/postman/xmlservice?com.TestCorp.abc.key=TEST_KEY](http://208.35.164.35:1234/abc/soap/postman/xmlservice?com.TestCorp.abc.key=TEST_KEY)

结果是无论我做什么，我都无法使用“添加服务引用”对话框添加 Web 服务引用。是不是Tomcat在请求wsdl的时候不能带额外的参数？有谁知道解决这个问题的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-12T18:01:55.223

感谢杰里米的回复。

他是对的，不是 Tomcat 生成了 wsdl——在这种情况下，生成它的是 JAX-WS。但是，考虑到此 Tomcat 服务器的配置方式，尽管我必须添加一个 http 标头才能访问 wsdl，因为当您尝试发现 wsdl 时，Tomcat 不会在查询字符串中采用 2 个参数。另外，我必须在我的 app.config 文件中设置 useDefaultWebProxy="false"。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-02T03:16:07.060

这不是一个真正的答案，但也许它会帮助你在谷歌上搜索。生成wsdl的不是tomcat，而是安装在tomcat上实现soap的一些webapp。它很可能是 Apache Axis。

通常您从 Axis 获取 wsdls，其 url 格式为[http://server/path/webservice?wsdl](http://server/path/webservice?wsdl)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T22:02:37.450

一旦我添加了 http 标头，一切正常。如果您有兴趣，我使用以下链接来帮助我：

[http://msmvps.com/blogs/paulomorgado/archive/2007/04/27/wcf-building-an-http-user-agent-message-inspector.aspx](http://msmvps.com/blogs/paulomorgado/archive/2007/04/27/wcf-building-an-http-user-agent-message-inspector.aspx)

# iphone - Objective-C 2.0 与 CLR 在内存管理方面的差异

> ID：813616
> 
> 赞同：1
> 
> 时间：2009-05-01T22:48:06.487
> 
> 标签：iphone, cocoa-touch, memory-management, clr

我一直在学习在可可触控平台上开发应用程序。我已经走了很长一段路，但我无法理解的是内存管理。

我想我会采取比较的方式，而不是试图从头开始。我找不到 CLR (.net) 和 Objective-C 2.0 之间的区别，所以我想知道堆栈溢出社区是否可以帮助我解决这个问题。

Objective-C 2.0 和 CLR 在内存管理方面的关键/重要区别是什么？关于 Objective-C 2.0，我正在 iPhone OS 上开发，不鼓励使用自动发布功能。

我想我正在寻找两者的比较...由于我来自 .NET 背景，我可能需要了解有关 Objective-C 2.0 内存管理的哪些事情？

谢谢你们！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T22:53:55.160

在 iPhone 上是手动的。如果您分配或保留内存，则必须释放它。

在 .NET CLR 中，大多数情况下您并不关心内存是怎样的或对象如何处理它。

对于 iPhone，您需要平衡每个对象分配、初始化或保留与释放。由于 iPhone 使用简单的引用计数机制，一旦计数降至 0，对象就会被清除。

我需要习惯的一件事是您可以拥有一个自动执行保留的属性，因此如果您创建一个对象然后将其分配给该属性，它将有 2 个计数。更好的方法是将对象创建为将临时变量分配给属性，然后释放临时变量以将计数减至 1。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-02T06:20:19.207

CLR 在虚拟机中运行；所有对象的释放都由垃圾收集系统处理。通常，在 Objective-C 中，内存必须通过旧的 C 风格 malloc/free 或通过保留/释放的引用计数系统手动管理。如果您来自标准的“C”背景，该技术似乎不会太陌生。

使用引用计数，系统会计算特定对象被使用了多少次——这基本上就是上面提到的“保留”。当使用一个对象完成某事时，该对象会手动发送一个“释放”消息，该消息将对象的保留计数减 1。当计数达到 0 时，系统会自动释放该对象。与 CLR/.NET 相比，这看起来非常麻烦，但该机制提供了更好的性能和更多的控制。

如果您在 Macintosh 上使用 Objective-C 2.0 进行编码，那么您很幸运，因为可以通过 XCode 中的选项启用垃圾收集。这将更接近 CLR 提供的内容。如果你在 iPhone 上开发，垃圾收集在内存和 CPU 方面的成本太高，所以它不是一个选择。内存必须手动管理。

幸运的是，有一个中间选项通常用于向对象发送和“自动释放”消息。这种机制，包括在 Macintosh 和 iPhone 中，基本上将分配的对象池化到一个全局字典中（它实际上称为自动释放池）。当应用程序存在或池被耗尽时，对象将被释放。然而，并不是所有的东西都进入自动释放池，你也不想把所有的东西都放在那里。我推荐从 Apple 网站上对 Objective-C 2.0 Programming Language 进行枯燥但重要的阅读，其中包含更详细的内容。

[http://developer.apple.com/documentation/Cocoa/Conceptual/ObjectiveC/Introduction/introObjectiveC.html](http://developer.apple.com/documentation/Cocoa/Conceptual/ObjectiveC/Introduction/introObjectiveC.html)

祝你好运，有耐心。Objective-C 并不是像 .Net（它已经超过 25 年）这样的新手，但它有一些令人难以置信的特性，.Net 才刚刚开始整合。

# javascript - 使用 OpenLayers 在地图区域上创建框控件

> ID：813618
> 
> 赞同：1
> 
> 时间：2009-05-01T22:48:36.080
> 
> 标签：javascript, map, openlayers

我正在使用[OpenLayers](http://openlayers.org/)为我的程序创建一个感兴趣的框。我正在使用这段代码：

```
var control = new OpenLayers.Control();
OpenLayers.Util.extend(control, {
    draw: function () {
        this.box = new OpenLayers.Handler.Box( control,
            {"done": this.notice},
            {keyMask: OpenLayers.Handler.MOD_SHIFT});
        this.box.activate();
    },
    notice: function (bounds) {
        areaSelected(bounds);
    }
});
map.addControl(control); 
```

捕获“Shift Create a Box”[控件](http://dev.openlayers.org/releases/OpenLayers-2.7/doc/apidocs/files/OpenLayers/Control-js.html)并使用选定的区域作为我感兴趣的区域。然而，这些值以像素的形式返回。但我想要**Longitude 和 Latitude**，而不是像素。鼠标位置[控件](http://dev.openlayers.org/docs/files/OpenLayers/Control/MousePosition-js.html)确实显示了正确的经纬度。我真的不在乎如何创建框，我只想要一种简单的方法让用户选择地图的一个区域，我需要获取该区域的纬度和经度。（框，圈，无所谓）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-23T15:27:21.350

回复很晚，但我以后会帮助别人！

通过执行以下操作，我设法从像素中获取十进制度：

```
var point1 = new OpenLayers.Pixel(bounds.left, bounds.bottom);
var point2 = new OpenLayers.Pixel(bounds.right, bounds.top);

var ll1 = map.getLonLatFromPixel(point1);
var ll2 = map.getLonLatFromPixel(point2); 
```

把它放在你的通知功能中，你将在 ll1 和 ll2 中拥有纬度/经度对！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-23T16:44:13.170

退房： http: [//garmin.na1400.info/routeable.php](http://garmin.na1400.info/routable.php)

它有一个复选框来设置“启用瓷砖选择”。

现在，当您在地图上拖动一个框时，它将选择底层对象。

您可以重复使用源代码。所有的魔法都在： http: [//garmin.na1400.info/routeable.js](http://garmin.na1400.info/routable.js)

# macos - 如何从 MacOS X 扩展坞启动脚本？

> ID：813625
> 
> 赞同：10
> 
> 时间：2009-05-01T22:51:10.550
> 
> 标签：macos

我知道我可以将应用程序固定到扩展坞并从那里启动它们。但是，有没有办法将程序固定到不是 MacOS 意义上的“应用程序”的扩展坞，例如 bash 脚本？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-01T23:00:45.363

您可以将任何文件拖到 Dock 的右侧栏（垃圾箱和文件夹所在的位置），然后通过单击它来执行它。

要执行 shell 脚本，您可以将其保存为 .command 文件，操作系统会选择它。

另一种选择是为您的脚本创建一个 Applescript 应用程序，并像使用任何应用程序一样使用它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-01T23:35:35.047

将其重命名为 something.command，然后在其 Get Info 窗口中，选择 Open With > Terminal.app。然后，当您双击它时，它将启动终端并运行脚本。您可以将其拖到停靠栏中。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-01T23:26:53.490

脚本编辑器可以创建基于 AppleScript 的应用程序。将以下代码粘贴到脚本中并将其保存为应用程序：

```
do shell script "~/someScript.sh" 
```

`~/someScript.sh`您的 shell 脚本的路径在哪里。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-02T05:29:39.530

还有一些工具可以从 shell 脚本、perl、python 等创建应用程序。我知道有 DropScript 和 Platypus。它们的优点是您可以将文件拖放到它们上。

# web-services - 您将如何开发和部署一个简单的 Web 服务？

> ID：813626
> 
> 赞同：2
> 
> 时间：2009-05-01T22:51:14.433
> 
> 标签：web-services, deployment, rest, soap

我正在寻找有关设计简单 Web 服务的任何见解/方向。我很想听听一些关于如何快速入门的想法，以及要避免哪些陷阱。为简化起见，以下是我要完成的基础知识：

*   服务应提供简单的数据库查询和多值响应。
*   服务应该提供一个简单的多值数据库插入。

假设使用开源工具，我应该如何从服务器端开始？给定一个 MySQL 数据库和 HTTP Web 服务器 (Apache)，那么需要一些简单的逻辑来连接到数据库。

1.  是否有任何一种语言最适合这一点？（Java、C、Perl、Python、Ruby、PHP）我更喜欢 Python，但是否存在性能问题？
2.  使用应用程序服务器是否值得，还是只是矫枉过正？(Tomcat, Axis, Django, ...)
3.  还有哪些其他框架需要考虑（CherryPy、TurboGears、RoR，...）
4.  使用 SOAP/REST 和/或 WSDL 有什么好处吗？
5.  如何防止垃圾邮件发送者执行虚假插入。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T23:04:02.657

看看[来自 Caucho 的 Hessian](http://hessian.caucho.com/)。这是一个非常棒的轻量级协议。在我自己发现它之后，我几乎要为那些浪费在 SOAP、WSDL 之类的东西上的痛苦日子而哭泣。服务可以是由 Spring 连接并通过 Web 服务器公开的非常简单的 POJO（如果您使用的是 Java）。从那时起，让服务变得从未如此简单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T22:56:09.757

您和您的团队最熟悉哪些语言/工具？您可以使用任意数量的语言创建 Web 服务，但如果您已经精通其中一种语言，为什么不选择它呢？

有些语言在某些任务上比其他语言更好，所以这取决于你的目标。如果您正在寻找学习新语言的任务，请选择一个。如果您需要在短时间内部署某些东西，那么您已经知道的东西应该更快，即使它不是该任务的“最佳”语言。通常没有适用于任何应用程序的“最佳”工具，只有您如何使用它们并做出值得使用的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T22:58:25.260

我个人可能会使用自托管的 WCF 服务。取决于你打算用它做什么。也许是一个 asp.net 托管的 WCF 服务。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-02T00:17:14.260

我遇到的信息：

**应用程序服务器**
我认为标准的[应用程序服务器](http://en.wikipedia.org/wiki/Application_server)对于这项任务可能不是必需的。维基百科有一个[应用服务器的比较](http://en.wikipedia.org/wiki/Comparison_of_application_servers)。

**Web 应用程序框架** [Web 应用程序框架](http://en.wikipedia.org/wiki/Web_application_framework)
可用于提供 Web 服务所需的数据库访问和其他功能。维基百科对各种语言[的知名框架进行了比较。](http://en.wikipedia.org/wiki/Comparison_of_web_application_frameworks)

还有一个特定[的 Web 服务框架列表](http://en.wikipedia.org/wiki/List_of_web_service_frameworks)。这些实现了一些 WS 协议，但我认为对于简单的 Web 服务来说太重了。

# c++ - 导致分段错误的奇怪整数值

> ID：813639
> 
> 赞同：0
> 
> 时间：2009-05-01T22:57:34.857
> 
> 标签：c++, integer, segmentation-fault

我有一个函数 find_nodes() 里面有一个循环：

```
for (htmlNodePtr current_node=root_node
    ; current_node!=NULL
    ; current_node=current_node->next) 
{
    if (xmlHasProp(current_node,(xmlChar *)"href")) {
        if (xmlHasProp(current_node,(xmlChar *)attribute)) {
            if (strcmp(value,
                (char *)xmlGetProp(current_node,(xmlChar *)attribute))==0) {
                    found_nodes[numb_found]=current_node;
                    numb_found++;
            }
        }
    }

    find_nodes(found_nodes,numb_found,
               current_node->children,mode,attribute,value);

} 
```

我在这个作业中遇到了分段错误：

```
found_nodes[numb_found]=current_node; 
```

我检查了 numb_found 值，几次迭代都可以，之后它而不是几个+1，它等于 -1207604106

是什么原因造成的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-01T23:01:16.733

您以某种方式超出了数组边界并查看随机数据。

好的，看看这个，我们没有足够的信息，但我观察到这似乎是对 DOM 树的递归搜索。您`numb_found`作为参数传递，因此当您在递归调用中分配给它时，该值不会在上面更新。最终你会遇到麻烦。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-02T15:17:13.473

在您声明但未初始化的 get_urls 函数中

```
char **url_list; 
```

然后你使用它

```
if (tree_is_true(l_list)) {
    url_list[numb_found]=(char *)xmlGetProp(matching_nodes[j],(xmlChar *)"href");
    numb_found++;
} 
```

-1207604106 是 0xB8056C76 - 非常适合指针；-)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-01T23:11:14.247

你踩到了内存。编译你的代码`-g`并使用它运行它，它[`valgrind`](http://valgrind.org)会`valgrind`告诉你错误的确切位置。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-01T23:09:16.590

从给定的代码中猜测，要么你有一些事情正在踩踏堆栈，要么 numb_found 变得非常大并且溢出。输入一些真实代码（如上述所有代码的类型信息），我们将能够告诉您更多信息。

我怀疑 found_nodes 是本地堆栈上的一个固定大小的数组，并且您也过度运行它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-01T23:10:03.000

也许我误解了您的代码，但是由于您正在传递`numb_found`而不是`&numb_found`，因此每次从递归返回时，您都将重写找到的节点，这对我来说似乎是一个错误。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-01T23:19:32.463

这是整个功能：

```
void find_nodes(htmlNodePtr *found_nodes, int &numb_found, htmlNodePtr root_node, SearchMode mode, const char *attribute, const char *value) {

    htmlNodePtr tmp_ptr;

    switch (mode) {

        case S_HREF:
            for (htmlNodePtr current_node=root_node; current_node!=NULL; current_node=current_node->next) {
                if (xmlHasProp(current_node,(xmlChar *)"href")) {
                    if (xmlHasProp(current_node,(xmlChar *)attribute)) {
                        if (strcmp(value,(char *)xmlGetProp(current_node,(xmlChar *)attribute))==0) {
                            found_nodes[numb_found]=current_node;
                            numb_found++;
                        }
                    }
                }

                find_nodes(found_nodes,numb_found,current_node->children,mode,attribute,value);

            }
            break;
        case S_KEYWORD:
            for (htmlNodePtr current_node=root_node; current_node!=NULL; current_node=current_node->next) {
                if (xmlHasProp(current_node,(xmlChar *)"href")) {
                    if (strcmp(value,(char *)xmlNodeGetContent(current_node))==0) {
                        found_nodes[numb_found]=current_node;
                        numb_found++;
                    }
                }

                find_nodes(found_nodes,numb_found,current_node->children,mode,attribute,value);
            }
            break;
        case S_TAG:
            for (htmlNodePtr current_node=root_node; current_node!=NULL; current_node=current_node->next) {
                if (xmlHasProp(current_node,(xmlChar *)attribute)) {
                    if (strcmp(value,(char *)xmlGetProp(current_node,(xmlChar *)attribute))==0) {
                        tmp_ptr=inner_href_seek(current_node);
                        if (tmp_ptr==NULL) {
                            find_nodes(found_nodes,numb_found,current_node->children,mode,attribute,value);
                            continue;
                        }
                        else {
                            found_nodes[numb_found]=tmp_ptr;
                            numb_found++;
                        }
                    }
                }

                find_nodes(found_nodes,numb_found,current_node->children,mode,attribute,value);
            }
            break;
    }
} 
```

该阵列是固定的，但它比需要的要大得多。我是否以正确的方式传递了 numb_found ？

=== 编辑 ===

```
char** get_urls(string url, ParseTreeNode *tree_root, int &numb_found) {

    numb_found=0;
    char **url_list;
    htmlDocPtr doc;
    htmlNodePtr root_node;
    string site_content;

    if (get_page(url,site_content)<0) {
        url_list=NULL;
        return url_list;
    }

    // get a DOM
    doc=htmlReadMemory(site_content.data(),site_content.size(),url.data(),NULL,0);

    // and the root
    root_node=xmlDocGetRootElement(doc);

    if (tree_root==NULL) {
        url_list=NULL;
        return url_list;
    }

    LeafList *l_list;
    l_list= new LeafList();

    l_list->numb_leafs=0;

    get_leaf_list(l_list,tree_root);

    htmlNodePtr matching_nodes[256];
    int numb_matching_nodes;

    htmlNodePtr tmp_nodes[64];
    int numb_tmp;

    SearchMode tmp_rule;

    for (int i=0;i<l_list->numb_leafs;i++) {
        if (l_list->leaf_buff[i]->data->rule!=TAG) continue;
        else {
            numb_matching_nodes=0;
            find_nodes(matching_nodes,numb_matching_nodes,root_node,S_TAG,l_list->leaf_buff[i]->data->attribute.data(),l_list->leaf_buff[i]->data->value.data());

            if (numb_matching_nodes==0) continue;
            else l_list->leaf_buff[i]->state=true;

            for (int j=0;j<numb_matching_nodes;j++) {
                for (int k=0;k<l_list->numb_leafs;k++) {
                    if (k==i) continue;
                    else {
                        switch(l_list->leaf_buff[k]->data->rule) {
                            case HREF:
                                tmp_rule=S_HREF;
                                break;
                            case TAG:
                                tmp_rule=S_TAG;
                                break;
                            case KEYWORD:
                                tmp_rule=S_KEYWORD;
                                break;
                        }

                        find_nodes(tmp_nodes,numb_tmp,matching_nodes[j],tmp_rule,l_list->leaf_buff[k]->data->attribute.data(),l_list->leaf_buff[i]->data->value.data());

                        if (numb_tmp>0) l_list->leaf_buff[k]->state=true;
                        else l_list->leaf_buff[k]->state=false;
                    }
                }

                if (tree_is_true(l_list)) {
                    url_list[numb_found]=(char *)xmlGetProp(matching_nodes[j],(xmlChar *)"href");
                    numb_found++;
                }
            }
        }
    }

    for (int i=0;i<l_list->numb_leafs;i++) {
        if (l_list->leaf_buff[i]->data->rule!=HREF) continue;
        else {
            numb_matching_nodes=0;
            find_nodes(matching_nodes,numb_matching_nodes,root_node,S_HREF,l_list->leaf_buff[i]->data->attribute.data(),l_list->leaf_buff[i]->data->value.data());

            if (numb_matching_nodes==0) continue;
            else l_list->leaf_buff[i]->state=true;

            for (int j=0;j<numb_matching_nodes;j++) {
                for (int k=0;k<l_list->numb_leafs;k++) {
                    if ((k==i)||(l_list->leaf_buff[k]->data->rule==TAG)) continue;
                    else {
                        switch(l_list->leaf_buff[k]->data->rule) {
                            case HREF:
                                tmp_rule=S_HREF;
                                break;
                            case KEYWORD:
                                tmp_rule=S_KEYWORD;
                                break;
                        }

                        find_nodes(tmp_nodes,numb_tmp,matching_nodes[j],tmp_rule,l_list->leaf_buff[k]->data->attribute.data(),l_list->leaf_buff[i]->data->value.data());

                        if (numb_tmp>0) l_list->leaf_buff[k]->state=true;
                        else l_list->leaf_buff[k]->state=false;
                    }
                }

                if (tree_is_true(l_list)) {
                    url_list[numb_found]=(char *)xmlGetProp(matching_nodes[j],(xmlChar *)"href");
                    numb_found++;
                }
            }
        }
    }

    for (int i=0;i<l_list->numb_leafs;i++) {
        if (l_list->leaf_buff[i]->data->rule!=KEYWORD) continue;
        else {
            numb_matching_nodes=0;
            find_nodes(matching_nodes,numb_matching_nodes,root_node,S_KEYWORD,l_list->leaf_buff[i]->data->attribute.data(),l_list->leaf_buff[i]->data->value.data());

            if (numb_matching_nodes==0) continue;
            else {
                for (int i=0;i<numb_matching_nodes;i++) {
                    url_list[numb_found]=(char *)xmlGetProp(matching_nodes[i],(xmlChar *)"href");
                    numb_found++;
                }
            }
        }
    }

    return url_list;
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-01T23:36:53.763

我注意到无效值 (-1207604106)`numb_found`是 0xB8056C76，这有点像指针值。这**可以**通过超出数组来解释，尽管您说它没有被超出......

我建议您验证该数组确实“比需要的大得多”。`cerr`在将节点添加到数组的行上添加跟踪（使用）；至少，让痕迹打印出`numb_found`每次通过的值。崩溃前您获得的最大值是多少？这实际上与数组大小相比如何？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-01T23:42:24.560

这就是 valgrind 返回的内容

```
==7464==
==7464== Use of uninitialised value of size 4
==7464==    at 0x80494EF: find_nodes(_xmlNode**, int&, _xmlNode*, SearchMode, char const*, char const*) (search_engine.cpp:90)
==7464==    by 0x8049CF2: get_urls(std::string, ParseTreeNode*, int&) (search_engine.cpp:237)
==7464==    by 0x804907B: main (tester.cpp:39)
==7464==
==7464== Invalid write of size 4
==7464==    at 0x80494EF: find_nodes(_xmlNode**, int&, _xmlNode*, SearchMode, char const*, char const*) (search_engine.cpp:90)
==7464==    by 0x8049CF2: get_urls(std::string, ParseTreeNode*, int&) (search_engine.cpp:237)
==7464==    by 0x804907B: main (tester.cpp:39)
==7464==  Address 0xcef11ec0 is not stack'd, malloc'd or (recently) free'd
==7464==
==7464== Process terminating with default action of signal 11 (SIGSEGV)
==7464==  Access not within mapped region at address 0xCEF11EC0
==7464==    at 0x80494EF: find_nodes(_xmlNode**, int&, _xmlNode*, SearchMode, char const*, char const*) (search_engine.cpp:90)
==7464==    by 0x8049CF2: get_urls(std::string, ParseTreeNode*, int&) (search_engine.cpp:237)
==7464==    by 0x804907B: main (tester.cpp:39)
==7464==
==7464== ERROR SUMMARY: 3 errors from 3 contexts (suppressed: 18 from 2)
==7464== malloc/free: in use at exit: 73,605 bytes in 3,081 blocks.
==7464== malloc/free: 3,666 allocs, 585 frees, 172,154 bytes allocated.
==7464== For counts of detected errors, rerun with: -v
==7464== searching for pointers to 3,081 not-freed blocks.
==7464== checked 329,952 bytes.
==7464==
==7464== LEAK SUMMARY:
==7464==    definitely lost: 186 bytes in 30 blocks.
==7464==      possibly lost: 8,324 bytes in 6 blocks.
==7464==    still reachable: 65,095 bytes in 3,045 blocks.
==7464==         suppressed: 0 bytes in 0 blocks.
==7464== Rerun with --leak-check=full to see details of leaked memory. 
```

我得到的最大值是 24，数组有 1024 个元素

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-02T01:12:32.503

说真的，你不应该问我们这个问题。您可以更快地执行以下任一操作：

*   通过调试器运行它，单步执行代码并`numb_found`在每条指令之后保持监视；或者
*   在没有调试器的情况下，`numb_found`在每个语句之后放置一个 printf/cout （具有唯一的 ID: `printf("A:%d\n,numb_found);`）。

这将是查看问题原因的最快方法。

无论如何，您的最新答案/评论表明您正在传递一个未初始化的值，`find_nodes()`并且考虑到它们中的大多数都是指针，这也会导致您写入无效内存。

我无法从 valgrind 输出中分辨出*哪个*参数未初始化，因此在函数顶部放置一个 printf/cout 以打印出所有指针（*而不是*指针的内容）。这应该允许您查看哪个参数是错误的或已损坏。

# javascript - 将 PNG 或 JPEG 用于 OpenLayers 的地图（缩放/缩放问题）

> ID：813644
> 
> 赞同：7
> 
> 时间：2009-05-01T22:59:12.667
> 
> 标签：javascript, map, openlayers

我正在使用图像通过 OpenLayers 显示我的地图。我的 JS 代码如下所示：

```
map = new OpenLayers.Map('map');

var options = {numZoomLevels: 7,
                isBaseLayer: true,
                };

var globe = new OpenLayers.Layer.Image(
    'Globe ESA',
    'http://upload.wikimedia.org/wikipedia/commons/0/07/World_map_blank_black_lines_4500px.gif',
    new OpenLayers.Bounds(-180, -90, 180, 90),
    new OpenLayers.Size(4500, 2234),
    options);

map.addLayers(globe);

markers = new OpenLayers.Layer.Markers("markers");
map.addLayer(markers);

map.addControl(new OpenLayers.Control.LayerSwitcher());
map.zoomToMaxExtent();
map.addControl(new OpenLayers.Control.MousePosition()); 
```

我的 CSS 是：

```
#map {
    width: 640px;
    height: 480px;
    border: 1px solid black;
} 
```

但我无法让 OpenLayers 缩小大图像。它始终以全分辨率显示，我无法缩小以显示整个地球。请帮忙。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-01T23:50:14.557

您需要设置图像在完全缩小时应显示的大小。

```
var globe = new OpenLayers.Layer.Image(
    'Globe ESA',
    'http://upload.wikimedia.org/wikipedia/commonS/0/07/World_map_blank_black_lines_4500px.gif',
    new OpenLayers.Bounds(-180, -90, 180, 90),
    new OpenLayers.Size(1125,558),
    options); 
```

我将尺寸更改为原始尺寸的四分之一。如果你想让它更小，你可以把它变小。

# .net - CLR 实际上是如何将我们的抽象映射到内存中的？

> ID：813651
> 
> 赞同：2
> 
> 时间：2009-05-01T23:01:22.163
> 
> 标签：.net

我真正感兴趣的一件事是我在 .NET 圈子中没有看到太多关于或讨论的内容，那就是运行时如何获取我们的抽象并通过 CLR 实现它们。虽然有几本书讨论了其中一些问题（例如，Richter's *CLR via C#*或 Simon Robinson 非常悲惨地忽略了*Advanced .NET Programming*，如果你还没有读过，我强烈推荐它，即使它已经绝版了）那里是谜题的重要部分，我能找到的任何东西都没有。

至少对我来说，将我们在编程中所做的抽象映射到位和字节的数组中，这确实是一项了不起的成就，这些位和字节不仅是我们抽象的忠实表示，而且还可以以产生新的、创造性的抽象的方式进行操作他们自己。我正在寻找资源来帮助我了解这是如何发生的。

作为我正在寻找的更多了解的示例：我们开发人员将类和实例视为一个谨慎的整体。你有一个类，你有实例。我们可能会理解，运行时设置实例的方式是通过保存实例数据的引用，以便相同类型的两个对象不共享数据（duh），但我怀疑很多开发人员是否理解CLR 没有任何一个存放类信息的地方——它实际上只有方法信息和实例信息，然后在“类型”的标题下将两者联系起来。我知道 CLR 对类的实现与我想象的完全不同。

有没有人找到涵盖这类东西的好资源？它们不需要明确地是 .NET，尽管我对特定于 .NET 的最感兴趣。我并不真正精通类型理论/实现领域，但我猜想.NET CLR 在处理将抽象映射到位的方法中相当典型，因此任何涵盖此内容的书籍/网站都会受到赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T23:07:07.797

还有什么比官方规范本身更好的信息来源呢？

[标准 ECMA-335 - 公共语言基础设施 (CLI)](http://www.ecma-international.org/publications/standards/Ecma-335.htm)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T23:09:36.153

目前正在阅读“更有效的 C#”一书，Bill Wagner 写了一些关于泛型及其如何影响性能的有趣内容。他没有详细说明，但我真的很喜欢他对编译器和 CLR 如何处理各种约束等的解释。

到目前为止的好书！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T23:12:42.557

如果您了解 C，那么我所知道的最好的例子就是一些将 OOP 黑客化为 C 的文章。它真正展示了 vtables、casting 等如何在幕后工作。

从 CLR 的角度来看，唯一显着的增强（尽管我确信还会添加其他增强）是垃圾收集、边界检查和类型安全——它们都比内存相关的运行时间更多。

一个快速的谷歌让[Essential.NET](http://books.google.com/books?id=Kl1DVZ8wTqcC&pg=PA78&lpg=PA78&dq=CLR+object+header&source=bl&ots=5a2MBzZKNO&sig=0yGO_FJpwveZSNAbixuXNIOXljg&hl=en&ei=TYH7SaTMDovWM8WKpFw&sa=X&oi=book_result&ct=result&resnum=2#PPA79,M1)看起来对这些东西非常有趣（并且由 Don Box 和 Chris Sells 编写，它一定会很详细） - 但我只浏览了 2 页。

# language-agnostic - 一种语言可以在其他方面变得完整但不完整吗？

> ID：813657
> 
> 赞同：10
> 
> 时间：2009-05-01T23:07:18.250
> 
> 标签：language-agnostic, compiler-construction, programming-languages, language-theory, turing-complete

例如，在编写操作系统时，是否有某些事情无法用图灵完备的语言来完成？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-01T23:13:05.193

不，或者至少如果你发现一个会反驳[Church Turing Thesis](http://en.wikipedia.org/wiki/Church%E2%80%93Turing_thesis)的论文。

然而，有些语言是图灵完备的，但编写某些程序是一件非常痛苦的事情，例如，FORTRAN 中的字符串处理、COBOL 中的数值编程、sed 中的整数运算，几乎所有东西都在 x86 汇编程序中。

然后当然还有[brainfuck](http://www.muppetlabs.com/~breadbox/bf/)。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-01T23:12:47.160

是的，您可以使用一种不允许您直接操作硬件的语言。例如，很难使用 Bourne shell 编写操作系统。但这些限制比你想象的要少。操作系统已经用标准 ML、Scheme 甚至[Haskell](http://programatica.cs.pdx.edu/House/)编写！

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-05-01T23:13:05.053

图灵完备是完整性的最一般的正式定义。某些应用程序需要一些语言特性，但这些特性不符合正式定义。

例如，图形功能、生成后台进程的能力、保持状态的能力以及连接到网络的能力都是有用的功能，但与语言的图灵完备性无关。因此，Google App Engine 上的 Python 或在沙箱中运行的 Java 小程序仍然是图灵完备的。

您会注意到，在许多情况下，这些类型的功能是由库而不是核心语言提供的。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-05-01T23:15:06.407

如果您说的是语用学，那么当然...您可以想象一种无法读取或写入文件的编程语言（例如，一种可以在整数上计算任何函数的语言，仅此而已）... **仅仅因为一种语言可以'不操作我的烤面包机并不意味着它不是图灵完备的，但它确实意味着它不能做一些事情**，所以我不确定这种区别有多“重要”或有用。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-05-02T11:35:51.383

根据上下文，“用一种语言完成某事”对不同的人意味着不同的事情。图灵就是其中之一，他非常准确地定义了“完整”的含义。

如果一种语言（或理论机器）是图灵完备的，那么就没有它不能进行的图灵计算。这并不意味着该语言是无所不能的，只是它擅长求和。有许多“事情”不是图灵计算，因此图灵完备的计算机可能无法做到。

“成为一个操作系统”不是图灵计算。要成为一个操作系统，你需要做的不仅仅是计算。您还需要操作硬件。

给定一门图灵完备的语言，以及一组用于完成所需的所有硬件操作的操作，包括合适的输入和时间概念，您就可以编写一个操作系统。或者我应该说，可以编写操作系统。你个人是否能做到这取决于语言的易用性，以及图灵定义忽略的物理限制，例如生成的程序是否真的适合并在你希望它运行的设备的内存中执行，并在现实时间运行。

尽管忽略实际限制 - 是的，您可以使用任何图灵完备语言编写操作系统，前提是该语言还具有足够的操作来驱动硬件。“库调用”，如果您希望采用实用的 CS 方法将语言与库区分开来。图灵没有做出这样的区分，因为他的计算模型无论如何都没有“调用”的概念。您还需要解决引导程序问题 - 您的硬件必须直接运行您正在编写的语言，或者您需要将编译器编译成硬件可以运行的语言，或者您需要使用一种语言编写的解释器硬件运行。同样，图灵忽略了这一切，因为他的计算模型使用抽象硬件，而编写操作系统完全是关于硬件的。

在英语（而不是 CompSciSpeak）中，通常会说一种语言“缺乏某些特征”，因此与具有这些特征的另一种语言相比，可以说它是“不完整的”。有人可能会反驳说可以在 C 中实现闭包。例如，可以编写一个作为 Lisp 解释器的 C 程序，并将 Lisp 程序作为字符串嵌入其中。瞧，C 中的闭包。但是，如果他们说“我希望 C 有闭包”，这并不是大多数人所要求的。如果您认为每种语言都需要闭包，那么 C 是不完整的。如果您认为每种语言都需要结构化编程，那么 ARM 汇编程序是不完整的。如果您认为应该可以为对象动态添加方法，那么 C++ 是不完整的，即使完全可以使用 "

图灵认为语言不需要任何这些便利：它们不影响可以执行的计算，只影响编写某些程序的难易程度。图灵完备性的概念与程序的外观或组织方式无关，*仅*与输出的内容有关。所以这些语言是图灵完备的，但是从程序员的角度来看，有些事情是那些语言无法完成的。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-02T00:05:21.090

语言可以或不能做诸如子例程、递归、自定义数据类型、循环、定义类、转到等之类的事情。这样的语言特性集使其完整或不完整。例如，如果您没有循环、goto 和子例程，则语言是不完整的 - 您无法执行任何循环操作。语言完整性是一个非常理论和科学的东西。例如，即使您的语言不允许递归调用函数，但允许函数指针，它也被证明 - 您可以模拟递归，即使用 y-combinator。

像处理文件和硬件这样的东西通常不是语言的一部分。要完成任何编程任务，您需要的不仅仅是语言。您需要程序工作的环境。在 x86 作为语言中，您有带有单个参数的指令“int”，但是当您执行“int 21h”时，由操作系统来执行某些操作。

语言只需要某种方式与环境沟通并完成 - 然后由环境来处理它。在 x86 asm "mov ax,bx" 中写入是有效的，但执行此操作取决于您的 CPU。

以其他方式不完整 - 简单，只需定义您自己的完整性版本。即，我讨厌在没有基于类的 OOP 的情况下工作，所以让我们定义如果语言没有支持基于类的 OOP 的语言特性，它就不是 Feldman 完备的。好吧，C 和 Javascript 不是 F 完备的。你仍然可以用这些语言做任何事情，甚至在某种程度上模拟基于类的 OOP。

关于操作系统 - 您仍然需要运行指令的处理器和将语言转换为 CPU 指令的编译器。我可以想象编译器将任何东西翻译成机器代码。就像，以下是有效的 JS 代码

```
for(var i=0;i<10;i++){
 mov("ax",i);
 int(0x21);
} 
```

并且将其编译成机器代码应该不难。

在现代世界中，您不仅选择语言，还选择平台、标准和非标准库、文献、社区、支持等。所有这些都会影响您做某件事的能力，它们加起来可能是也可能不是完成你的任务。但是如果我不能将c++代码编译成java小程序，并不代表它是c++语言的不完整。只是没有编译器将 c++ 代码转换为可以由 JVM 加载的东西。

如果您愿意，您可以设计一种具有语言功能的语言，例如“OpenFile、PingNetworkHost、DownloadMpeg4FileOverHttpsAndPlayBackwards”。但是如果语言没有它们，它们仍然可以通过其他语言特性和环境支持来实现，因此没有这些特性并不会使语言不完整。如果你的语言像 C 但没有 goto 运算符、循环运算符（for、while、do while）和函数，那么你不能编写循环程序，没有环境和库可以帮助你。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-02T12:02:24.453

答案是最肯定的。图灵完备性仅意味着图灵完备语言可用于计算任何可计算函数。一方面，它没有说明计算的复杂性。

您通常可以期望任何多项式时间算法都可以用任何其他图灵完备语言表示为多项式时间算法，但仅此而已。如果您唯一关注的是图灵完整性，那么任何实时要求（软或硬）都不会出现。

另一个重要的事情是语言的表达能力，这在很大程度上是一种主观属性，但是您可以理解，用任何机器代码编写程序都比使用 Java 更难。

至于操作系统，硬件接口是必须的，但任何语言都可以安装这样的实用程序。

[编辑] 我可能要补充的另一件事是，由于我们有限计算机的性质，没有任何编程语言的实际实现是图灵完备的。虽然 Church-Turing 论文以及相关的开创性发现（如停机问题）为我们理解计算奠定了基础，但它们很少遇到实际计算的世界。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-02T11:51:26.027

不完整的可用性:)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-02T12:21:04.347

当谈论语言时，通常假设语言在一些非常简单的机器上运行。因此，任何从文件读取或访问网络的概念通常不会考虑到语言的能力。

可计算性理论中经常使用不同类别的语言（每种语言都有几乎无穷无尽的修改）

1.  有限自动机。这是最简单的机器类别，它们可以识别最小的语言类别，这恰好是正则表达式可以识别的*确切*语言，即。字符串是否以两个 'a' 开头并以 d 结尾。它们不能用于识别字符串是否包含一组平衡的括号 fx。
2.  下推自动机。这本质上是具有堆栈的有限自动机的扩展。与有限状态机不同，它们可用于判断特定字符串是否包含一组平衡的括号。下推自动机可以识别的语言*正是*可以使用上下文无关语法描述的集合，它们通常用于解析源代码。
3.  图灵机。这些是这里同类机器中功能最强大的，但这并不意味着它们可以用来回答所有问题。他们无法回答这个字符串是否描述了将永远运行的图灵机的问题？事实上，任何图灵机都无法说明任何图灵机的重要属性（赖斯定理）。

所以是的，图灵机有局限性，有些机器可以做图灵机不能做的事情，但它们（很可能）只在理论上存在，在实践中更新。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-11-05T01:41:37.227

我认为除了图灵（或正则表达式，或下推自动机）之外的完整性定义与*语言*无关。但这种完整性仅适用于数字或符号计算设施。

在我看来，您提到的东西更像是运行时和环境的功能，而不是语言。有一个重要的区别，完整性的正式概念通常只适用于语言本身。

# apache - 计算 Apache 服务的对 /foo/ 的请求数的最简单方法是什么？

> ID：813662
> 
> 赞同：2
> 
> 时间：2009-05-01T23:10:51.610
> 
> 标签：apache, grep, log-analysis, hit-count

我正在寻找追溯分析日志并计算 /foo/* 请求的数量，这些请求具有我们正在推动的新功能的基线基准。一个简单的命令行脚本就可以了——还有一个额外的好处是能够指定一个日期范围。

一些使用 grep，也许？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T23:15:23.923

```
egrep -c '\] "[A-Z]+ /foo/' access_log 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T23:29:57.307

添加“能够指定日期范围”条件使其变得更加困难。最容易编写 Python 或 Ruby 程序。否则，使用 date(1) with`-f`来设置解析格式，`-j`告诉它​​不要管该死的时钟，并`-r`让它打印秒，因为 epoch 会让你到达那里。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-02T00:39:29.400

```
fgrep " /foo/" access_log | wc -l 
```

每天获得大致格式化的访问：

```
fgrep " /foo/" access_log | cut -d'[' -f2 | cut -d: -f1 | uniq -c 
```

# svn - 从 SVN 迁移到 ...？

> ID：813663
> 
> 赞同：4
> 
> 时间：2009-05-01T23:10:59.753
> 
> 标签：svn, git, version-control, mercurial, dvcs

我目前在一个团队工作，我们正在“使用”一个颠覆存储库。我说“使用”，因为实际上，每个人都只是通过 samba 共享直接在服务器上编辑文件，而我们的架构师每隔一段时间就会从该服务器提交我们的更改，然后将其推送到服务器。

所以基本上我们错过了能够从不同用户那里获得有意义的提交消息，并且能够尽可能频繁地提交。

我一直在尝试激发对分布式系统的兴趣，以及我们拥有的工作流程似乎可以用 git 之类的东西很好地设置（我们在本地机器上提交，然后将变更集推送给他以供审查）但是我觉得我对 git 的经验不够。我的大部分 DVCS 经验都与 mercurial 相关。

每个人几乎都在使用 tortoisesvn 在 Windows 环境中工作，这就是他们习惯于与系统交互的方式，但他们偶尔会使用 PuTTY 在其中一台 linux 服务器上工作，并且知道如何进行命令行提交。

解决方法是什么，我已经看到一些在 SVN 和一些 DVCS 之间创建网关的工作，有没有人有在这样的环境中设置和工作的经验？

从 SVN 到 DVCS 的全面迁移怎么样？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-02T01:43:50.463

如果你的团队不能很好地理解如何使用颠覆，我不知道你将如何让他们理解 git。尤其是因为他们的心态是“让所有人都在同一个工作副本中工作”，他们将很难掌握分布式版本控制系统。

以我的经验，要使用 svn-git，你必须知道如何使用 git 并且你必须知道如何使用 svn。我建议教他们正确使用 svn。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-01T23:15:36.450

您是否有理由不想只保留您的 SVN 存储库，并以 SVN 的预期使用方式使用它？

为什么不让每个人都签入和合并、使用分支等？如果您有存储库设置，为什么要切换？

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-01T23:17:12.920

您所描述的问题似乎主要与提交代码的适当程序和协议有关。获得不同的产品不会改变人们的工作方式。你需要先教育他们。向他们展示如何将事情做得更好。

另一方面，我不明白你如何使用 tortoiceCVS 与 SVN 交互。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-02T05:15:53.527

对我来说，版本控制系统的选择听起来不是问题。你需要做的是让架构师相信他需要提出一些合理的政策来使用修订控制系统。

您当前的 svn 系统就足够了；如果您需要保持主干清洁，让用户创建分支。架构师可以根据需要合并它们。

现在，您*可以*移动 OA DVCS，并且有充分的理由这样做。但是，如果团队不习惯使用客户端/服务器 rcs，那么这可能具有挑战性。您*可以*在本地使用 git 或 hg ，但这些是从根本上破坏 rcs 使用的解决方法。我的建议是让每个人都先使用 svn。

在 samba 共享上编辑文件？严重地？！

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-01T23:43:33.357

[git-svn](http://git-scm.com)*绝对*是你最好的选择。您将能够使用 git 的所有本地版本控制和更改审查功能，但最终可以将“最终”签入推送到您现有的 svn 存储库。

这具有*令人敬畏*的副作用，可以让您的团队一次用 git 弄湿他们的脚（既因为您可以在购买前尝试，又因为您仍然可以使用任何现有的部署/维护流程）已经使用 SVN 开发）。

还有一个很好[的 svn 用户 git 语法速成课程](http://git-scm.com/course/svn.html)，您可以使用它来让您的团队加快速度。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-02T05:27:47.337

您的问题不是 SVN 本身，而是没有正确使用它。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-02T01:33:40.503

hg 也非常擅长使用 subversion - 请参阅[https://www.mercurial-scm.org/wiki/WorkingWithSubversion](https://www.mercurial-scm.org/wiki/WorkingWithSubversion)。Python 核心开发团队刚刚决定从 Subversion 切换到 Mercurial（经过长时间的讨论和考虑 git 和 bazaar 的时间）；在一个不相关的开发中，code.google.com 的开源项目免费托管服务在其长期支持 svn 的基础上增加了 hg 支持。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-04T16:39:24.570

正如 Steve Yegge 所说：**TOOOOOLS**

正如其他人所说，如果你不能让他们使用 svn，他们就不会使用分布式 vcs。

他们使用 IDE 吗？如果是这样，请为 IDE 找到易于使用 svn 的插件。因此，他们可以右键单击 IDE 中的文件或文件夹并签入。如果您使在本地副本上使用源代码控制比直接访问中央文件更容易，您可能会有机会。然后你可以使用 TortoiseSVN 来完成更复杂的任务。

一些流行 IDE 的 SVN 插件链接可帮助您入门：

*   Visual Studio - [AnkhSVN](http://ankhsvn.open.collab.net/)和[VisualSVN](http://www.visualsvn.com/visualsvn/)
*   Eclipse -[颠覆性](http://www.eclipse.org/subversive/)和[Subclipse](http://subclipse.tigris.org/)
*   Netbeans -[颠覆](http://subversion.netbeans.org/)

这[是](http://subversion.tigris.org/links.html#ide-plugins)来自 subversion 网站的 IDE 插件列表。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-01T23:24:31.017

git 和 bazaar 都对 svn 有很好的支持。事实上 git-svn 在过去几个月里已经成熟了很多。

试试 git，因为 DVCS 真的很好，而且不像你说的那么难。

# java - 有没有办法同时运行 Bamboo 测试？

> ID：813665
> 
> 赞同：3
> 
> 时间：2009-05-01T23:12:17.597
> 
> 标签：java, junit, selenium, bamboo

目前，我有两个 selenium-junit 测试配置为几乎同时在竹子上运行。一个测试在 MachineA（安装了硒等）上运行，另一个在 MachineB（安装了硒等）上运行。启动时，bamboo 在机器 A 上构建一个，并在机器 B 上排队。我的问题是为什么竹子不能处理多线程？或者有没有办法解决这个问题

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-03-16T07:44:53.993

I haven't used Bamboo v3, but it looks like you should be able to do it from that version onwards, as it supports a comprehensive "pipeline build system".

From what I read [here](http://confluence.atlassian.com/display/BAMBOO/Working+with+Projects,+Stages,+Plans+and+Jobs), you would define your two Selenium tests as Jobs that are to be executed in the same Stage. As long as you have sufficient agents available, it should execute them in parallel.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-03-29T22:07:32.117

正如 Millhouse 建议的那样，您应该使用 Bamboo 3 并将您的 selenium-junit 测试配置为计划的同一阶段中的作业。给定阶段的作业在有足够可用代理的情况下并行执行。

# java - Java：将数组数组转换为集合集合，反之亦然

> ID：813678
> 
> 赞同：0
> 
> 时间：2009-05-01T23:17:02.610
> 
> 标签：java, arrays, data-structures, collections

请提出一些优雅的方法来将
**数组数组**转换为**集合的集合**，反之亦然。

我想Java API中没有方便的方法，对吧？

```
public static <T> T[][] nestedCollectionsToNestedArrays(
    Collection<? extends Collection<T>> source){

  // ... ?
}

public static <T> Collection<Collection<T>> nestedArraysToNestedCollections(
    T[][] source){

  // ... ?
} 
```

**附加问题：****原始类型**
的嵌套数组有什么用？

 ****由于禁止创建泛型数组**，我是否必须为每种原始类型声明方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-02T00:23:23.013

对于集合 -> 数组数组：（它只返回一个 Object[][]，因为“T”的类型信息不存在。如果您希望数组是，您必须手动传入 T 的类正确的类型，它会更复杂）

```
public static Object[][] nestedListsToNestedArrays(
    Collection<? extends Collection<?>> source){
  Object[][] result = new Object[source.size()][];
  int i = 0;
  for (Collection<?> subCollection : source) {
    result[i++] = subCollection.toArray();
  }
  return result;
} 
```

> 附加问题：原始类型的嵌套数组有什么用？我是否必须为每种原始类型声明方法，

是的，您可以为每个原始类型声明方法，或者使用反射并牺牲类型安全。原因是每个原始数组类型都是不相关的，所有原始数组类型都没有超类型，除了 Object。

> 因为禁止创建通用数组？

不，但这就是另一个问题的原因：为什么 Collection of Collections -> 返回 T[][] 的数组数组很难在上面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T23:24:07.100

下面是array->Collection的方法：

```
public static <T> Collection<Collection<T>>
        nestedArraysToNestedCollections(T[][] source) {
    Collection<Collection<T>> ret = new ArrayList<Collection<T>>();
    for (int i = 0; i < source.length; i++) {
        // could be ret.add(new ArrayList<T>(Arrays.asList(source[i]));
        Collection<T> list = new ArrayList<T>(source[i].length);
        for (int j = 0; j < source[i].length; j++) {
            list.add(source[i][j]);
        }
    }
    return ret;
} 
```

另一个方向要棘手得多。

# delphi - 如何在 TPanel 上绘图

> ID：813693
> 
> 赞同：6
> 
> 时间：2009-05-01T23:25:18.767
> 
> 标签：delphi, canvas, components, tpanel

我需要在 TPanel 上绘制，理想情况下是直接绘制，这样我就没有其他组件在它上面妨碍 mousevent 事件捕获（我想在它上面画一点“大小抓地力​​”）。我该怎么做呢？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-02T05:15:05.540

要真正做到正确，您可能应该编写一个后代类。覆盖`Paint`绘制尺寸控制夹点的方法，并覆盖`MouseDown`、`MouseUp`和`MouseMove`方法以向控件添加调整大小功能。

我认为这是一个比尝试`TPanel`在应用程序代码中使用 a 更好的解决方案，原因如下：

1.  该`Canvas`属性在 中受保护`TPanel`，因此您无法从类外访问它。你可以通过类型转换来解决这个问题，但这是作弊。
2.  “可调整大小”听起来更像是面板的一项功能，而不是应用程序的一项功能，因此请将其放在面板控件的代码中，而不是应用程序的主代码中。

这里有一些东西可以帮助你开始：

```
type
  TSizablePanel = class(TPanel)
  private
    FDragOrigin: TPoint;
    FSizeRect: TRect;
  protected
    procedure Paint; override;
    procedure MouseDown(Button: TMouseButton; Shift: TShiftState;
      X, Y: Integer); override;
    procedure MouseMove(Shift: TShiftState; X, Y: Integer); override;
    procedure MouseUp(Button: TMouseButton; Shift: TShiftState;
      X, Y: Integer); override;
  end;

procedure TSizeablePanel.Paint;
begin
  inherited;
  // Draw a sizing grip on the Canvas property
  // There's a size-grip glyph in the Marlett font,
  // so try the Canvas.TextOut method in combination
  // with the Canvas.Font property.
end;

procedure TSizeablePanel.MouseDown;
begin
  if (Button = mbLeft) and (Shift = []) 
      and PtInRect(FSizeRect, Point(X, Y)) then begin
    FDragOrigin := Point(X, Y);
    // Need to capture mouse events even if the mouse
    // leaves the control. See also: ReleaseCapture.
    SetCapture(Handle);
  end else inherited;
end; 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-02T01:51:11.820

[这是Raize Components](http://www.raize.com/DevTools/RzComps)可以让您的生活更轻松的众多方式之一。我只是进入 Delphi，放在 TRzPanel 上，然后输入：

> RzPanel1.Canvas.Rectangle...

我确信还有其他解决方案——但我不必用 Raize 来寻找它们。

（只是一个满意的客户大约 10 年......）

编辑：鉴于您的目标，以及您已经拥有 Raize Components 的声明，我还应该指出 TRzSizePanel 处理面板的大小调整和 OnCanResize 等有用事件（以确定您是否要允许调整到特定的新宽度或高度） .

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-02T00:25:47.140

最简单的方法是在面板上放置一个 TImage 。但是，如果您真的不想这样做，请在代码编辑器中键入 TCanvas，按 F1，然后愉快地了解它在后台是如何工作的。（别说我没警告你……）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-02T03:42:51.643

如何为在运行时调整大小的控件添加大小句柄：http: [//delphi.about.com/library/weekly/aa110105a.htm](http://delphi.about.com/library/weekly/aa110105a.htm)

TAdvPanel： [http ://www.tmssoftware.com/site/advpanel.asp](http://www.tmssoftware.com/site/advpanel.asp)

# c# - 如何使用 C# 在 Windows Vista 中设置注册表值？

> ID：813694
> 
> 赞同：0
> 
> 时间：2009-05-01T23:25:19.390
> 
> 标签：c#, windows-vista, registry, key, unauthorized

```
try
{
    RegistryKey rkApp = Registry.CurrentUser.OpenSubKey(
         "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run", true);

    if (rkApp.GetValue("AdobeBitmapViewer") == null)
    {
        rkApp.SetValue("AdobeBitmapViewer", Application.ExecutablePath.ToString());
    }
    rkApp.Close();
}
catch (Exception) { } 
```

此代码在 Windows XP 中有效，但在 Windows Vista 中我得到一个 UnauthorizedException。有没有办法绕过Vista中的UAC来设置注册表项？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T23:26:37.283

我看到[页面](http://www.daniweb.com/forums/thread120922.html#)说使用 CreateKey 而不是 OpenKey - 这有什么不同吗？

您可能需要以提升的权限运行。这可能会[有所](http://www.ookii.org/post/vista_manifests_and_net.aspx)帮助。

请参阅此处以获取查看权限的[另一个示例。](http://msdn.microsoft.com/en-us/library/microsoft.win32.registrykey.setaccesscontrol.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-02T02:18:02.613

这不应该是 UAC 问题。有问题的密钥在 HKCU 中，通常不受 UAC 保护。UAC 通常会删除您对 HKLM 等密钥的访问权限。

可能是 Vista 上的一个程序通过管理员权限创建了该密钥，并禁止您在正常情况下写入该密钥。您可以尝试传递 false （表示只读）并查看是否允许您打开它吗？如果是这样，您应该查看密钥的实际权限并查看它们是什么。

# linux - 什么是让 D-Bus 之类的东西在多台 Linux 机器上工作的好方法，可能是通过防火墙？

> ID：813700
> 
> 赞同：5
> 
> 时间：2009-05-01T23:27:16.000
> 
> 标签：linux, events, dbus, publish-subscribe

D [-Bus 规范](http://www.freedesktop.org/wiki/Software/dbus)说

> D-Bus 是.. 应用程序相互通信的一种简单方式... 目前通信应用程序在一台计算机上...

我想要像 D-Bus 这样的东西，但可以跨多台 Linux 机器工作，并且可能涉及防火墙。例如，如果我的邮件服务器决定它收到一条重要消息，我希望它向总线上发布一个事件，我家中的计算机可以看到并可能通过启动一个`linpopup`窗口来响应。

我感兴趣的事件相对较少，所以低性能的技术是可以的。但我不希望重新发明任何轮子。我还希望尽可能多地用 shell 脚本或其他高级语言编写，而尽可能少地用 C 语言编写（但如果需要的话，我愿意调用 C API）。

我解释 D-Bus 官方网页的方式，他们说[让 D-Bus 与多台计算机通信会很好，但它不起作用](http://www.freedesktop.org/wiki/Software/DBusRemote)。

**编辑**：D-Bus 对我的吸引力在于*发布和订阅*的模型：

*   观察有趣事件的机器将该事件发布到“系统”。

*   对特定事件感到好奇的机器只订阅这些事件。当事件发生时，“系统”会让机器知道。

在 D-Bus 中，“系统”是一台机器。我想要多台机器类似的东西。这排除了直接解决方案，如机器之间的 TCP 或 SMTP 通信。但我很高兴拥有一个接收所有发布和订阅请求的中央服务器。我开始认为自己构建比理解[高级消息队列协议 (AMQCP)](http://en.wikipedia.org/wiki/Advanced_Message_Queuing_Protocol)更容易，这对于我这样的人来说太高级了。

性能不是问题。简单绝对是一个对象。

再一次：我应该看什么软件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-02T06:59:30.470

您应该搜索消息传递解决方案，但这些解决方案取决于您打算使用哪种语言。Java 有这个功能已经有一段时间了，称为 JMS（Java 消息服务）。然而，存在其他实现。

*   [ZeroMQ](http://www.zeromq.org)具有以下 API 绑定：C、C++、Python、.NET/Mono 等
*   [OpenAMQ](http://www.openamq.org)具有以下 API 绑定：Python、Java、Ruby 和 C

我没有使用不同框架的经验，所以我不能告诉你使用什么，但你可以试一试。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-02T06:35:14.523

管理应用程序之间的消息和通信的“新事物”显然是 Rabbit。

是 AMQP 的一种实现，它建立了消息传递、路由和安全...

检查这个：

[http://www.rabbitmq.com](http://www.rabbitmq.com)

[http://en.wikipedia.org/wiki/Advanced_Message_Queuing_Protocol](http://en.wikipedia.org/wiki/Advanced_Message_Queuing_Protocol)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-01-20T07:35:44.970

由于我的研究将我引向了这个古老的问题，并且从那以后发生了很多事情，我想补充一下。

您想看看 MQTT，它是物联网的标准。这是自 2016 年以来的 ISO 和 OASIS 标准。http: [//mqtt.org/](http://mqtt.org/)

它使用起来非常简单，并且设计为轻量级。原理是发布/订阅。

一个非常好的实现是 Mosquitto [https://mosquitto.org/](https://mosquitto.org/)，它位于 Eclipse 的保护伞下。在[https://eclipse.org/paho/](https://eclipse.org/paho/)的 Eclipse Paho 项目中有客户端库。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-30T21:59:29.497

基于 TCP/IP 的消息队列 (MQ)/面向消息的中间件 (MOM) 解决方案应该可以满足您的需求。大多数成熟的产品为各种语言提供本地语言绑定。我对 ActiveMQ 很满意，它有一个 CLI 界面，可能足以完成简单的脚本任务。

可以在这里找到一些背景知识： [http ://en.wikipedia.org/wiki/Message-orientation_middleware](http://en.wikipedia.org/wiki/Message-oriented_middleware)

祝你好运，

香农

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-01T23:29:25.433

也许我没有抓住重点（完全有可能！），但为什么不只使用 SMTP 并发送电子邮件消息呢？还是 TCP 数据包，并且在另一端有监听程序？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-02T00:31:49.467

我知道没有像这样的现成解决方案。

我的建议是您编写脚本，使用 curl 或 wget 将 HTTP POST 请求发送到一个非常简单的 Web 应用程序，其中包含您的信息。另一台机器每隔一段时间轮询同一个网络并获取信息。

[Comet](http://alex.dojotoolkit.org/2006/03/comet-low-latency-data-for-the-browser/)可以改善民意调查，但可能需要更多的努力。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-05-07T18:25:50.697

您应该考虑在机器之间桥接 D-Bus 消息。编写一个消息桥应用程序来接收 D-Bus 消息，过滤它们并将某些消息发送到 AMQP 主题交换。这可以使用 RabbitMQ 作为 MQ 代理轻松完成，值得花时间学习 AMQP 模型。RabbitMQ 站点充满了文档、教程、博客和常见问题解答。

AMQP 的一个典型用途是有一个消息生产者进程，然后是一个消息消费者进程，它可以在不同的机器上。生产者只需连接到代理，然后将消息发布到带有路由键标签的主题交换中。Exchange 是 Broker 上的一个进程，用于将消息路由到 Queues。消息消费者也连接到代理，但它可能不是同一个代理。然后消费者声明要使用的队列名称。并使用绑定键将该队列名称绑定到命名的 Exchange。绑定键是一种模式，它与进入交换的任何路由键匹配。在最简单的情况下，路由键和绑定键是相同的，但是当绑定包含通配符模式时会更有趣。

如果你真的不想学习 AMQP，那么使用 0MQ 来桥接机器。0MQ 更简单，基本上允许您拥有具有多个端点的套接字。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-03T14:00:51.837

如果您有兴趣尝试较低层的协议，您可以尝试 SOAP。它不如二进制协议高效，您必须自己进行更高级别的排队，但它可以通过网络代理和 SMTP 服务器运行。我之前尝试过一个不错的 PERL 实现。

欲了解更多信息：

[http://www.w3schools.com/soap/default.asp](http://www.w3schools.com/soap/default.asp)

# javascript - 正则表达式新手需要帮助

> ID：813707
> 
> 赞同：-1
> 
> 时间：2009-05-01T23:31:00.907
> 
> 标签：javascript, regex

我需要一个带有一个按钮和窗口的表单用于输入

这将通过正则表达式检查数组。

并且会找到字母+数字的完全匹配。示例 wxyz [一些空间 btw] 0960000

或数字和字母的混合 [一些空格 btw] + 数字 01xg [一些空格 btw] 0960000

该数组目前有四个对象。

一旦找到我需要一个功能，当找到匹配时将打开一个新页面或窗口。

谢谢你的帮助。

迈克尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T23:42:30.287

要回答 Javascript 部分，这里有一种通过数组“grep”查找匹配元素的方法：

```
var matches = [];
var re = /whatever/;

foo.forEach(
  function(el) {
    if( re.exec(el) )
      matches.push(el);
  }
); 
```

* * *

尝试回答正则表达式部分：我不知道“完全匹配”对您意味着什么，并且我假设“一些空格”仅属于其他术语之间，并且我假设字母表示英文字母从 'a' 到 'z' 大小写，数字应为 0-9（否则可能匹配其他语言字符）。

第一个模式是 /[a-zA-Z0-9]+\s*0960000/。如果至少有一个空格，而不是零个或多个空格字符，则将“\s*”更改为“\s+”。如果不希望匹配制表符（和一些较少使用的空格字符），请将“\s”更改为“”。

对于第二种模式，我不知道“数字 01xg”是什么意思，但如果它表示数字后跟该字符串，那么该模式将是 /[a-zA-Z0-9]+\s*[0-9 ]+\s*01xg\s*0960000/. 与上述相同的警告适用。

此外，这将匹配部分字符串。如果字符串完全匹配（如果字符串中除了匹配的内容之外必须存在任何内容），则在模式的开头添加“^”以将其锚定到字符串的开头，并在末尾添加“$”将其锚定到字符串的末尾。例如，/[a-zA-Z0-9]+\s*0960000/ 匹配“foo_bar 5 0960000”，但 /^[a-zA-Z0-9]+\s*0960000$/ 不匹配。

有关 Javascript 中的正则表达式的更多信息，请查看[developer.mozilla.org 关于 RegExp 对象的文章](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/RegExp)（该链接将您带到 JS 版本 1.5 参考，它应该适用于所有支持 JS 的浏览器）。

*（编辑添加）*：为了匹配任何一种情况，因为它们有重叠的部分，您可以使用以下模式：/[a-zA-Z0-9]+(?:\s*[0-9]+\s* 01xg)?\s*0960000/. 问号表示匹配不同的部分 - 在非匹配组 (?:foo) 中 - 一次或零次。(?:foo)? 和 (?:foo|) 在这种情况下做同样的事情，但我不确定是否存在性能差异；我建议使用对您最有意义的一种，以便您稍后阅读。

# php - 如何修复 Zend Server for windows 中的 ZF 工具？

> ID：813709
> 
> 赞同：0
> 
> 时间：2009-05-01T23:31:31.390
> 
> 标签：php, zend-framework, code-generation, zend-server-ce

我刚刚下载了[Zend Server Community Edition](http://www.zend.com/community/zend-server-ce) for windows，发现它没有包含教程中包含的 ZF 实用程序。我下载并解压了[Zend Framework](http://www.zend.com/en/community/framework)（1.7.8 版，因为 1.8 版无法正确下载）。这包括用于生成基本项目文件的 zf.bat 实用程序。不幸的是，它们似乎都不包含该工具运行所需的 CodeGenerator 包。我收到的错误是：

> H:\zend>zf
> 
> 警告：require_once(Zend/CodeGenerator/Php/File.php)：打开流失败：D:\Simon\code\zend\ZendServer\share\ZendFramework\in cubator\library\Zend\Tool 中没有这样的文件或目录\Project\Context\Zf\ControllerFile.php 第 4 行
> 
> 致命错误：require_once(): 无法打开所需的 'Zend/CodeGenerator/Php/File.php' (include_path='D:\Simon\code\zend\ZendServer\share\ZendFramework\incubato r\library;D:\Simon \code\zend\ZendServer\share\ZendFramework\library;.;D:\Simon\code\zend\ZendServer\share\ZendFramework\library') 在 D:\Simon\code\zend\ZendServer\share\ZendFramework \incubator\library\Zend\Tool\Project\Context\Zf\Controller File.php 在第 4 行

我一直在四处寻找，发现了一些[讨论](https://devzone.zend.com/article/3811-Using-Zend_Tool-to-start-up-your-ZF-Project)。其他一些人也有同样的问题，并通过使用以下命令检查最新的 svn 来修复它：

```
cd $PATH_TO_ZF/ZendFramework-1.7.7
cp -r incubator/library/Zend/Tool/ library/Zend/
cp -r incubator/library/Zend/Reflection/ library/Zend/
cd library/Zend/Tool
mkdir CodeGenerator
cd CodeGenerator
svn co http://framework.zend.com/svn/framework/standard/incubator/library/Zend/CodeGenerator .
cd ..
find . | grep -v .svn | xargs perl -pi -e "s|Zend/CodeGenerator|Zend/Tool/CodeGenerator|g"
find . | grep -v .svn | xargs perl -pi -e "s|Zend_CodeGenerator|Zend_Tool_CodeGenerator|g" 
```

不幸的是，最新的 svn 也没有 CodeGenerator。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T23:37:28.817

在我写了这个问题并提交之后，我发现了一个潜在的解决方法。Zend 服务器的 msi 安装程序运行完毕后，从 cmd 提示符发出以下命令：

```
cd <wherever you installed the server>\ZendServer\share
rd /S /Q ZendFramework
mkdir ZendFramework
cd ZendFramework
svn co http://framework.zend.com/svn/framework/standard/trunk/ . 
```

然后，确保

```
<wherever you installed the server>\ZendServer\share\ZendFramework\bin 
```

在您的 PATH 环境变量中。zf 命令现在似乎可以工作了。

# java - Java 1.6 - 确定符号链接

> ID：813710
> 
> 赞同：44
> 
> 时间：2009-05-01T23:31:36.817
> 
> 标签：java, java-6

在 DirectoryWalker 类中，我想知道 File 实例是否实际上是指向目录的符号链接（假设 walker 在 UNIX 系统上行走）。鉴于，我已经知道该实例是一个目录，以下是确定符号链接的可靠条件吗？

```
File file;
// ...      
if (file.getAbsolutePath().equals(file.getCanonicalPath())) {
    // real directory ---> do normal stuff      
}
else {
    // possible symbolic link ---> do link stuff
} 
```

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2009-05-01T23:41:45.640

Apache Commons 中使用的技术使用父目录的规范路径，而不是文件本身。我认为您不能保证不匹配是由符号链接引起的，但这很好地表明该文件需要特殊处理。

这是[Apache 代码](https://github.com/apache/commons-io/blob/master/src/main/java/org/apache/commons/io/FileUtils.java)（受其[许可](http://www.apache.org/licenses/LICENSE-2.0)），为紧凑而修改。

```
public static boolean isSymlink(File file) throws IOException {
  if (file == null)
    throw new NullPointerException("File must not be null");
  File canon;
  if (file.getParent() == null) {
    canon = file;
  } else {
    File canonDir = file.getParentFile().getCanonicalFile();
    canon = new File(canonDir, file.getName());
  }
  return !canon.getCanonicalFile().equals(canon.getAbsoluteFile());
} 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-05-01T23:36:20.770

Java 1.6 不提供对文件系统的这种低级访问。看起来应该包含在 Java 1.7 中的[NIO 2将支持符号链接。](http://jcp.org/en/jsr/detail?id=203)[提供了新 API 的草稿](http://openjdk.java.net/projects/nio/javadoc/index.html)。[那里提到了](http://openjdk.java.net/projects/nio/javadoc/java/nio/file/package-summary.html#links)符号链接，可以[创建](http://openjdk.java.net/projects/nio/javadoc/java/nio/file/Path.html#createSymbolicLink(java.nio.file.Path,%20java.nio.file.attribute.FileAttribute...))和[关注](http://openjdk.java.net/projects/nio/javadoc/java/nio/file/Path.html#readSymbolicLink())它们。我不确定应该使用哪种方法来确定文件是否是符号链接。有[一个讨论 NIO 2 的邮件列表](http://groups.google.com/group/jsr203-interest)——也许他们会知道。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2011-10-11T17:06:59.383

此外，请注意`file.isFile()`两者`file.isDirectory()`都基于解析的文件返回结果，因此两者都返回`false`时`file`指的是目标不存在的符号链接。

（我知道这本身并不是一个有用的答案，但它让我绊倒了几次，所以我想我应该分享）

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-01T23:39:48.360

看起来[`getCanonicalPath()`](http://java.sun.com/javase/6/docs/api/java/io/File.html#getCanonicalPath())可以做其他可能使其与绝对路径不同的事情。

> 如果需要，此方法首先将此路径名转换为绝对形式，就像调用 getAbsolutePath() 方法一样，然后以系统相关的方式将其映射到其唯一形式。这通常涉及删除冗余名称，例如“。” 和路径名中的“..”，解析符号链接（在 UNIX 平台上），并将驱动器号转换为标准大小写（在 Microsoft Windows 平台上）。

但它可能适用于绝大多数用例；你的旅费可能会改变。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-01-27T22:15:33.830

如果您已经在编写专门为 *nix 编写的代码，那么您可以从 Java 执行一个 shell 命令，如下所示：

```
Process p = Runtime.getRuntime().exec(new String[]{"test", "-h", yourFileName});
p.waitFor();
if (p.exitValue() == 0) 
   System.out.println("This file is a symbolic link");
else
   System.out.println("This file is not a symbolic link"); 
```

这是 *nix 特有的，但它至少可以工作。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-03-13T17:01:56.163

很抱歉回复这么老的帖子，但我前段时间一直在寻找适用于 Windows 系统的解决方案，而之前的一些答案对我来说并不奏效。如果您不关心跨平台兼容性并且只需要针对 Windows 的解决方案，那么以下技术对我的目的很有效。

```
File f = new File("whatever file or folder");
if (f instanceof ShellFolder) {
  ShellFolder sf = (ShellFolder)f;
  if (sf.isLink()) {
    // Your code when it's a link
  }
} 
```

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2011-04-18T10:58:17.177

我想我会分享一些我在处理这个问题时的好运气。我使用的是 JDK 1.6.0_23，所以我无法从 NIO2 中受益。我仅在 Windows 7 /x64 上构建和运行，因此里程在其他环境中可能会有所不同。不幸的是，这里的其他解决方案在避免尝试遍历联结时引起的 NullPointerExceptions 对我不起作用（可能是因为 junction != symlink ....）。虽然我不受 JDK 版本的限制，但我决定在这个问题上再坚持一段时间。

我有这段代码，如果在符号链接上使用或遇到“系统卷信息”目录时会导致 NullPointerException。（注意，traverseItem.f() 返回一个 java.io.File 类型的对象）

```
if (traverseItem.f().isDirectory) {
    for (File item : traverseItem.f().listFiles()) { 
```

因此，它应该是一个目录，但在其上调用 listFiles() 会导致 NPE。该怎么办？我发现了 list() 方法，想知道它是否会表现出相同的行为。我发现如下：

对描述空文件夹的 File 调用 list() 会返回一个长度为零的 String[] 数组。但是，在描述一个结点的文件上调用 list()，否则该结点会从 listFiles() 崩溃返回 null

通过在调用 listFiles() 之前添加以下测试，我能够避免 NullPointerExceptions

```
 String[] contents = traverseItem.f().list();
    if (contents != null) {  //Non-traversible if null, possibly junction or ??? 
```

仍然需要详尽地测试连接、符号链接、硬链接的所有情况，我敢提它，快捷方式，但这可能会有所帮助。

# java-me - 使用 JSR-135 MMAPI 实现自定义编解码器

> ID：813712
> 
> 赞同：2
> 
> 时间：2009-05-01T23:33:02.167
> 
> 标签：java-me, codec, mmapi

是否可以使用[JSR135](http://java.sun.com/javame/reference/apis/jsr135/)实现自定义编解码器并播放媒体文件？实际上，我有兴趣在 J2ME 中播放自定义媒体文件。我认为 JSR135 是一个很好的起点，但我愿意接受其他建议。谢谢。

**更新** 我没有尝试过，但我相信，如果我使用 JSR75 打开文件，我会得到一个 InputStream。我可以使用自定义 InputStream 将自定义编解码器转换为 MMAPI 可以理解并且可以播放的已知编解码器。但是，如果我可以不使用 JSR75 以及随之而来的许多安全警告，那就更好了。

# linux - Git 从部分存储库中提取？

> ID：813722
> 
> 赞同：0
> 
> 时间：2009-05-01T23:37:18.410
> 
> 标签：linux, git

我正在尝试为我的一个项目在 git 中合并同一文件的不同版本。git 让我这样做的唯一方法是分支 repo，修改文件，然后将分支拉入我的 master。唯一的问题是，我的项目包含 100 个文件，而我只需要这个。有没有办法从只包含这个文件的分支中提取？每次我尝试这样做时，它都会删除所有其他文件。还有其他方法可以完成手头的基本任务吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-02T00:38:07.453

> 唯一的问题是，我的项目包含 100 个文件，而我只需要这个。

这应该不是问题。来吧

1.  用 100 个文件克隆整个分支。
2.  修改感兴趣的单个文件。
3.  提交新分支（包含 100 个文件，其中只有一个已更改）。
4.  将新分支拉入旧分支，途中合并。

这听起来很可怕，但 git 非常有效地完成了这类事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-03T05:05:34.650

我不确定你想要完成什么，但看起来你的恐惧是基于这样一种想法，即如果你对所有文件进行分支，你最终会在你的存储库中得到许多不需要的文件副本。这不是真的，因为 git 在内部非常高效。所以，不用担心分支，git 会处理剩下的事情。

# php - PHP 验证 youtube 脚本

> ID：813731
> 
> 赞同：1
> 
> 时间：2009-05-01T23:42:12.347
> 
> 标签：php, scripting, youtube, match, pcre

我有一个网站，允许用户复制和粘贴 youtube 提供的嵌入视频脚本并将其上传到数据库。我希望能够检查此脚本是否是有效的 youtube 脚本，而不仅仅是某人输入的随机文本。我相信这可以通过 preg match 来完成。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-02T00:27:21.630

你可以使用：

```
preg_match('/^<object (?<width_height>width="[[:digit:]]+" height="[[:digit:]]+")><param name="movie" value=(?<url>"http:\/\/www.youtube.com\/v\/[^&]+&hl=[[:alpha:]]{2}&fs=1")><\/param><param name="allowFullScreen" value="true"><\/param><param name="(?<asa>allowscriptaccess)" value="always"><\/param><embed src=(?P=url) type="application\/x-shockwave-flash" (?P=asa)="always" allowfullscreen="true" (?P=width_height)><\/embed><\/object>$/', $yt); 
```

但最好让他们输入一个 URL（这更容易验证和解析），然后自己生成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-12-23T03:49:42.387

要匹配 URL：

```
$pattern = '/.*youtube.*(v=|\/v\/)([^&\/]*).*/i';
preg_match($pattern, $video, $matches)
$videoId = $matches[2]; 
```

然后，您可以使用`$videoId`包装成您想要的任何 YouTube URL 格式。

# php - 如何在php中创建复杂的容器

> ID：813735
> 
> 赞同：0
> 
> 时间：2009-05-01T23:46:32.493
> 
> 标签：php, templates

我正在创建一个容器类型，它对可以包含的内容有很多可能的变化：

*   标题栏
*   搜索栏
*   表单栏
*   标签栏
*   自定义栏
*   信息栏
*   动作/状态栏
*   内容区

其中，只有内容区域是必需的。有一些子类型可以共享公共条形集，但它们也可以以任意组合混合和匹配。此外，每个条形类型的左侧或右侧都可以有内容。

我一直在创建具有以下属性的 Panel 类：

*   info_left
*   info_right
*   search_left
*   搜索权
*   等等

然后做这种逻辑：

```
// snip from __toString()
if ($this->info_left || $this->info_right) {
    $result .= $this->add_bar('info', $this->info_left, $this->info_right);
}
if ($this->search_left || $this->search_right) {
    $result .= $this->add_bar('search', $this->search_left, $this->search_right);
}
// end snip

private function add_bar($type, $left, $right) {
$result = <<< HERE
    <div class="$type">
        <div class="left">$left</div>
        <div class="right">$right</div>
    </div>
HERE;
} 
```

并实例化一个面板：

```
$p = new Panel("my panel");
$p->info_left = "my left content";
$p->search_right = "my right search content";
echo $p; 
```

到目前为止，我一直远离使用模板引擎，因为逻辑看起来很复杂，以至于我几乎宁愿将其保留在课堂上。（该类的业务逻辑很少，但有很多表示逻辑。）也许有更好的方法......？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2009-05-01T23:55:36.963

听起来你正在重新创建 div。我认为如果你定义一种 div 的格式，然后创建不同的 css 样式来为每组 div 设置不同的样式会更好。

所以它会是这样的：

```
<div class="title">
    <div class="left">my left content</div>
    <div class="right search">my right search content</div>
</div> 
```

我会保留 css 规则的复杂逻辑，然后为您拥有的每种类型制作一个单独的模板。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-05-02T00:25:49.667

您应该考虑使用装饰器模式。[Wikipedia 上作为示例给出的场景似乎与您提出的问题完全相同。](http://en.wikipedia.org/wiki/Decorator_pattern#Motivation)

# c - 分析 u-Boot/内核启动序列

> ID：813737
> 
> 赞同：5
> 
> 时间：2009-05-01T23:47:42.303
> 
> 标签：c, profiling, linux-kernel

我正在分析电源 PC 板的启动过程，分析启动顺序的最简单方法是什么？

我的第一个想法是修改 u-boot/kernel 代码添加 printf/printk（使用实时设备作为参考）并在控制台上打印它们。但是，仅在控制台上打印它们可能会影响时间。

有什么想法吗？

问候，罗伯特。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-29T10:30:05.187

有一个很棒的实用程序，称为[bootchart](http://www.bootchart.org/)，它可以为您提供引导过程的图形表示，并告诉您每个任务何时开始以及完成需要多长时间。

看看这个。

[![替代文字](https://i.stack.imgur.com/HxijK.png)](https://i.stack.imgur.com/HxijK.png)
[（来源：[bootchart.org](http://www.bootchart.org/images/bootchart.debian.mcrae.1.png)）]

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-01T23:51:39.390

每个人都知道分析 u-boot 的最佳方式是使用声纳。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T15:45:40.990

如果您认为打印可能会影响性能（我不这么认为，除非您打印的速度低于 10kbytes/s），然后将该数据存储在内存中并稍后打印。

# .net - 即使在激活时也保持窗口处于非活动状态

> ID：813745
> 
> 赞同：2
> 
> 时间：2009-05-01T23:52:35.830
> 
> 标签：.net, winforms, appearance

有没有办法让窗口保持不活动状态，即使它包含焦点？我有两种形式（A 和 B）。用户与 A 交互后，我将焦点转移回 B。焦点转移的结果（用户单击 A，然后焦点转移回 B）是表单 A 从活动状态闪烁到非活动状态。这看起来很难看（尤其是在 A 暂时得到更大阴影的 Vista 上）。我怎样才能让 A 保持不活动状态，这样就不会发生这种闪烁？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-02T21:04:34.883

终于，我找到了答案！

**警告： *不要滥用这个答案的技巧。***这样做会使您的用户感到困惑，并且通常会损害计算体验。下面描述的技术在某些情况下可能非常有用（例如实现类似 IntelliSense 的行为），但*请*谨慎使用它。

WM_NCACTIVATE消息被发送到窗口以将其非客户区（即边框和标题栏）的状态更改为非活动或活动[。](http://msdn.microsoft.com/en-us/library/ms632633(VS.85).aspx)消息的 wParam 指示状态是非活动的还是活动的。如果 wParam 为真（值为 1），则窗口看起来是活动的。如果 wParam 为 false（值为 0），则窗口将看起来不活动。要强制窗口保持非活动或活动状态，请通过将 wParam 设置为相应的值（0 或 1）来覆盖 wParam，然后一切就绪！

```
private const int WM_NCACTIVATE = 0x0086;

protected override void WndProc(ref Message m)
{
    if (m.Msg == WM_NCACTIVATE)
    {
        // Use this to make it always look inactive:
        m.WParam = (IntPtr)0;

        // Alternately, use this to make it always look active:
        m.WParam = (IntPtr)1;
    }

    base.WndProc(ref m);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-02T03:25:39.190

您正在谈论更改 gui 模型的默认行为。我不建议这样做。如果用户在 A 上做某事，那么回到 B 不应该 A 消失吗？为什么会“闪烁”？当焦点发生变化时，它应该是一个单一的开关。

从您的描述中无法判断焦点切换，例如：

A->B
B->A->用户点击->B
B->A

?

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-02T07:27:32.727

不确定这是否有帮助，但 Winforms 支持拥有表单的概念。例如，即使浮动工具栏位于顶层窗口之外，即使顶层窗口处于活动状态（反之亦然），它们仍保持活动状态。同样，您希望用户能够与您的表单 A 进行交互，而无需停用表单 B。

要实现这一点，听起来您需要`b.AddOwnedForm(a)`在 show 之前调用`a`。

# html - 下载 HTML 页面 + 所有组件的最佳工具/库

> ID：813746
> 
> 赞同：3
> 
> 时间：2009-05-01T23:55:05.733
> 
> 标签：html, linux

我正在寻找一个命令行工具或一个库（最好在 Perl 中）来下载 HTML 页面及其所有组件：外部 CSS、外部 JavaScript、图像、flash 或其他对象等。

我还没有找到一个工具来做到这一点。我可以下载 HTML 页面，然后解析 HTML 以找到所有外部链接。但是，如果现有工具可以这样做，我宁愿不要重新发明轮子。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-02T00:02:12.610

[WGet 可以满足](http://www.gnu.org/software/wget/)您的需求，尽管我不知道它如何与 CSS 一起工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-02T06:21:07.397

wget 将很容易工作，但 ajax/xul/etc 和类似的问题它不会处理并且有充分的理由。

# perl - 如何在 Perl 中预先分配字符串？

> ID：813752
> 
> 赞同：13
> 
> 时间：2009-05-01T23:57:39.453
> 
> 标签：perl, string

我有一个处理大量数据的 Perl 脚本。由于重复使用点（连接）运算符，有一堆字符串变量开始很小但会变得很长。以这种方式增长字符串会导致重复重新分配吗？如果是，有没有办法预先分配一个字符串？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-02T04:29:45.977

是的，Perl 增长字符串会导致重复的重新分配。Perl 为字符串分配了一点额外空间，但只有几个字节。您可以使用 Devel::Peek 看到这一点。这种重新分配非常快，并且通常不会实际复制内存。相信您的内存管理器，这就是您使用 Perl 而不是 C 编程的原因。首先对其进行基准测试！

`$#array = $num_entries`您可以使用和散列预分配数组，`keys %hash = $num_keys`但`length $string = $strlen`不起作用。[这是我在 Perlmonks 上发现](http://www.perlmonks.org/?node_id=630424)的一个聪明的把戏。

```
my $str = "";
vec($str, $length, 8)=0;
$str = ""; 
```

或者，如果您想进入 XS，您可以调用`SvGROW()`.

Chaos 建议使用数组然后将它们全部连接在一起将使用两倍以上的内存。数组的内存。为数组中的每个元素分配的每个标量的内存。每个标量元素中保存的字符串的内存。加入时副本的内存。如果它导致代码更简单，那就去做吧，但不要认为你在节省任何内存。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-02T00:00:43.083

更容易处理的替代建议：将字符串[推入](https://metacpan.org/pod/perlfunc#push-ARRAY-LIST)数组并在完成后[加入它。](https://metacpan.org/pod/perlfunc#join-EXPR-LIST)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-02T02:01:14.493

Perl 的字符串是可变的，因此附加到字符串不会*导致*字符串重复惩罚。

你可以尝试所有你想找到“更快”的方法，但这闻起来很不利于过早的优化。

举个例子，我开设了一个课程来抽象化繁重的工作。它工作得很好，但是，尽管它的所有愚蠢的技巧，它真的很慢。

结果如下：

```
 Rate  magic normal
magic  1.72/s     --   -93%
normal 23.9/s  1289%     -- 
```

是的，没错，Perl 比我认为值得尊敬的实现快 1200%。

分析您的代码并找出真正的问题是什么，不要尝试优化甚至不是已知问题的东西。

```
#!/usr/bin/perl

use strict;
use warnings;

{

    package MagicString;
    use Moose;

    has _buffer => (
        isa => 'Str',
        is  => 'rw',
    );
    has _buffer_size => (
        isa     => 'Int',
        is      => 'rw',
        default => 0,
    );
    has step_size => (
        isa     => 'Int',
        is      => 'rw',
        default => 32768,
    );
    has _tail_pos => (
        isa     => 'Int',
        is      => 'rw',
        default => 0,
    );

    sub BUILD {
        my $self = shift;
        $self->_buffer( chr(0) x $self->step_size );
    }

    sub value {
        my $self = shift;
        return substr( $self->{buffer}, 0, $self->{_tail_pos} );
    }

    sub append {
        my $self  = shift;
        my $value = shift;
        my $L     = length($value);
        if ( ( $self->{_tail_pos} + $L ) > $self->{_buffer_size } ){
            $self->{buffer} .= (chr(0) x $self->{step_size} );
            $self->{_buffer_size} += $self->{step_size};
        }
        substr( $self->{buffer}, $self->{_tail_pos}, $L, $value );
        $self->{_tail_pos} += $L;
    }
    __PACKAGE__->meta->make_immutable;
}

use Benchmark qw( :all :hireswallclock );

cmpthese( -10 , {
        magic => sub{
            my $x = MagicString->new();
            for ( 1 .. 200001 ){
                $x->append( "hello");
            }
            my $y = $x->value();
        },
        normal =>sub{
            my $x = '';
            for ( 1 .. 200001 ){
                $x .= 'hello';
            }
            my $y = $x;
        }
    });
#use Data::Dumper;
#print Dumper( length( $x->value() )); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-05T18:07:28.467

I don't know specifically how Perl strings are implemented but a pretty good guess is that it's [constant amortized time](https://stackoverflow.com/questions/200384/constant-amortized-time/249695#249695). This means that even if you do find a way to pre-allocate your string chances are that the combined time it will save for all the script's users will be less than the time you spent asking [this question](https://stackoverflow.com/questions/813752 "to say nothing of the time I spent answering it") on Stack Overflow.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-02T06:24:02.707

我会采用数组/加入方式：

```
push(@array, $crunched_bit) 
```

然后`$str = join('', @array)`，如果仅此而已，可以在以后访问所有元素以进行调试。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-05-02T00:04:48.237

是的，您知道会增长的预扩展字符串是个好主意。

您可以使用“x”运算符来执行此操作。例如，要预分配 1000 个空间：

$s = " " x 1000:

# php - 从 PHP 到 Objective-C

> ID：813755
> 
> 赞同：10
> 
> 时间：2009-05-02T00:00:26.593
> 
> 标签：php, objective-c, cocoa, transition

作为一个非常有经验的 PHP 开发人员，并且对 C 有一定的了解（用我父亲的 16 个 NEC 微控制器编写了一个分布式计算实验），我想转向 Objective-C 和 Cocoa，最终的目标是集成 Mac / iPhone 应用程序与我的一些 PHP 项目。

通过 Arron Hiilegass 的“Cocoa Programming For Mac OS X”一书，我有点沮丧。我能够处理这些示例，但他没有确切解释**为什么**他以这种方式使用一个类（例如 NSNumber 而不是 int 或 double ）。

我正在寻找一本好书/书籍来首先学习 Objective-C。我的问题是，什么是一本好书？我正在看“Objective-C 2.0 中的编程”，它看起来相当不错。我会从那里去哪里？我想我应该重新开始我的可可书。

此外，互联网上是否有任何资源可以帮助从 PHP 过渡到 Objective-C？我知道 PHP 是一种松散类型的脚本语言，所以它有其不同之处。有些事情对 Obj-C 和 Cocoa 没有意义，为什么我不能将整数放入 NSMutableArray？

无论如何。谢谢您的帮助！（我才 14 岁，所以如果我在 Q 中犯了任何错误，请放过我。）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-02T00:07:00.227

我自己刚刚完成了“Objective-C 2.0 编程”，它非常好。我会推荐它，特别是如果您从未使用过 C（或者如果您像我一样忘记了它）。

但是，Apple 确实拥有出色的文档。如果你不介意在线阅读，我会从他们[的 Cocoa 入门](http://developer.apple.com/referencelibrary/GettingStarted/GS_Cocoa/index.html#//apple_ref/doc/uid/TP30001088)页面开始。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-02T01:04:04.740

*我能够处理这些示例，但他没有确切解释为什么他以这种方式使用一个类（例如 NSNumber 而不是 int 或 double ）......*

*有些事情对 Obj-C 和 Cocoa 没有意义，为什么我不能将整数放入 NSMutableArray？*

[`NSNumber`](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/nsnumber_Class/Reference/Reference.html#//apple_ref/doc/uid/20000178-3041)`int`是一种比or等​​原始类型更有用的类型`double`，因为它经常与您在 Cocoa 中编程时遇到的其他对象结合使用。

例如，为了将数字作为值打包成可调整大小的数组（如`NSMutableArray`）或关联数组（ 的实例[`NSDictionary`](http://developer.apple.com/DOCUMENTATION/Cocoa/Reference/Foundation/Classes/NSDictionary_Class/Reference/Reference.html#//apple_ref/doc/uid/20000140-9552)），您需要将数字原语（`int`、`double`等）转换为可[序列化](http://developer.apple.com/documentation/Cocoa/Conceptual/Archiving/Archiving.html)的或可归档的对象——一个`NSNumber`。

基元不能序列化，不像`NSNumber`, 因为基元不在Apple 努力为您提供的基本“核心基础”类型（ `NSNumber`、`NSArray`、等）中。`NSString`

此外，通过使用，`NSNumber`您还可以免费获得许多额外的便利方法：您可以快速将数字转换为字符串，例如，只需键入`[myNumber stringValue]`.

或者，如果您将您`NSNumber`视为某物的价格（“$1.23”），您可以应用 an[`NSNumberFormatter`](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSNumberFormatter_Class/Reference/Reference.html#//apple_ref/doc/uid/20000202-9197)以确保对数字的操作给出的结果具有您期望的格式（例如，如果您添加两个价格值，你会期望得到一个货币价值作为回报）。

这并不是说您不能或不应该使用`int`or`double`变量。但在许多情况下，您会发现`NSNumber`一个更好的选择，因为您可以编写更少的代码并“免费”获得很多功能。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-03T18:11:13.013

根据我的经验，我发现 Internet 文档对学习 Obj-C 和 CocoaTouch 很有帮助。我的进步是这样的：

1) 在 iTunes 上观看 Apple Dev 视频（它们是免费的）。

2) 阅读[入门](http://developer.apple.com/iphone/prerelease/library/referencelibrary/GettingStarted/GS_iPhoneGeneral/index.html)，[iPhone 应用程序编程指南](http://developer.apple.com/iphone/prerelease/library/documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/ApplicationEnvironment/ApplicationEnvironment.html#//apple_ref/doc/uid/TP40007072-CH7-SW1)。

3) 在 Obj-C 中读取[OOP](http://developer.apple.com/iphone/prerelease/library/documentation/Cocoa/Conceptual/OOP_ObjC/Introduction/Introduction.html)。

4) 阅读更多：[Cocoa Fundamentals](http://developer.apple.com/iphone/prerelease/library/documentation/Cocoa/Conceptual/CocoaFundamentals/Introduction/Introduction.html)、[Objective-C Primer](http://developer.apple.com/iphone/prerelease/library/documentation/Cocoa/Reference/ObjCRuntimeRef/Reference/reference.html)、[Cocoa Practices](http://developer.apple.com/iphone/prerelease/library/documentation/Cocoa/Conceptual/CodingGuidelines/CodingGuidelines.html)。

5）做一些简单的教程。

IMO：您需要的所有信息都在 Apple Dev:iPhone 网站上。省钱，不要买书。如果您不理解“为什么”在其中一个指南或教程中做了某事，请立即将其与 Google 的其他来源进行交叉引用。

您必须记住，这里的*学习曲线***非常大。**这是给我的，我在大学里每天都在学习这样的东西。所以，坚持下去，以聪明的方式阅读（略读你知道的东西）。我在自己身上看到的是，如果我了解 iPhone 的工作原理并了解数据流，那么为它编程主要是语法问题。

PHP 与 Objective-C 非常不同。此外，在互联网环境中用 PHP 解决编程问题的方式与在 iPhone 环境中用 Obj-C 解决编程问题的方式非常不同。正因为如此，你想从一个新的角度来使用 iPhone，并且作为一个学生/学习者。花点时间专注于面向对象的编程和最佳实践。这将在未来几年祝福你。

-水牛

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-02T00:40:13.703

另外，回答您的问题：

Objective-C 是一种面向对象的语言，作为 C 的扩展而构建。

因此，它提供原始类型（如 int 和 double）和对象。

NSNumber 是一个 Objective-C 类，它表示一个数字加上对该数字的一些操作（方法）。使用 NSNumber 优于数字原始类型的优点是它可以以面向对象的方式使用（您可以向它发送消息，您可以使用“协议”扩展它的功能，您可以从它继承，您可以通过它在一个需要一个对象等的方法中）。

至于 NSMutableArray，这是一个提供类数组功能的类。它旨在与 Objective-C 对象类型一起工作（它是 NSObject 类型对象和从它们继承的对象的容器），这就是它不能包含整数的原因。但是，它可以包含一个 NSInteger，它是一个表示整数的 Objective-C 类。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-10-10T15:21:17.687

我个人会尝试首先从[http://developer.apple.com/library/mac/navigation/](http://developer.apple.com/library/mac/navigation/)上的苹果参考资料中学习 Objective-C，然后从那里继续学习可可。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-02T08:26:55.033

我也遇到过类似的情况（PHP 转向 Objective-C），我发现最好的过程是跳入一个项目。我也阅读了 Hillegass 的书，这是一个好的开始，但了解一门语言的唯一方法就是带着明确的目标勉强过关。

这很痛苦，但它有效。咖啡、API 和面巾纸。

编辑：我刚读了你帖子的最后一部分，看到你 14 岁。也许用可乐换咖啡:)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-03-03T15:32:25.140

如果你来自任何地方，我最喜欢的 Objective-C 教程是斯坦福大学关于 iOS 编程的 iTunesU 课程。教授真的从其他书籍和在线教程中看待事物。

# architecture - 创建干净、优雅的代码的技巧

> ID：813758
> 
> 赞同：4
> 
> 时间：2009-05-02T00:02:40.380
> 
> 标签：architecture

编写干净、优雅的代码让我觉得编码是一种乐趣。我一直在寻找更多的方法来做到这一点。以下是我的一些策略/战术：

*   将大代码块保存在较小的例程/方法/类中

*   确保每个例程都有一个退出点。在循环顶部带有逻辑的退出循环，而不是带有中断或某种类型的“退出循环”关键字。

*   避免全局变量

*   如果您只是对代码执行了复制/粘贴，那么是时候创建一个例程/类/库了。

...最近我一直在玩弄一个：

*   尝试用不同的方法签名（多态性）替换 if/branching/select 案例在 YouTube 上的 Clean Code Talks

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-02T00:12:25.300

[Robert C. Martin 的清洁代码](https://rads.stackoverflow.com/amzn/click/com/0132350882)

[![替代文字](https://i.stack.imgur.com/vBdYo.jpg)](https://i.stack.imgur.com/vBdYo.jpg)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-02T00:36:10.157

如果你还没有读过 Code Complete，我强烈建议你停止阅读 Stack Overflow 几天（或者不管你花多长时间），转而阅读。

[替代文字 http://ecx.images-amazon.com/images/I/51seLiYuURL._BO2,204,203,200_PIsitb-sticker-arrow-click,TopRight,35,-76_AA240_SH20_OU01_.jpg](http://ecx.images-amazon.com/images/I/51seLiYuURL._BO2,204,203,200_PIsitb-sticker-arrow-click,TopRight,35,-76_AA240_SH20_OU01_.jpg)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-02T00:08:36.900

“一个，两个，很多”。

在这个星球某个偏远的角度，一个偏远的野生种群用他的语言没有超过两个字。两个之后，有一个“多”字。我以前的老板宣扬这句话是为了减少例行程序中的争论数量。我倾向于同意他的观点。

“不要重复自己（干）”

如果你在两个地方说同样的话，那么你就有问题了，你应该重构。这两个（或更多）地方迟早会不同步。

“保持简单，愚蠢（KISS）”

不要过度设计。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-02T00:47:39.070

不要拖延。曾经。当您想到改进一段代码的方法时，请立即去做，无论它可能有多难，或者可能需要多长时间。始终寻找潜在的改进，永远不要采取简单的方法。

现在，这不是开发代码的最有效或最有利可图的方式，这就是为什么专业代码库很少是美丽的例子。但这不是你的问题。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-02T01:11:44.643

在 Comp Sci 中，我听到了一些一直困扰着我的东西：

“在编程中只有 3 个数字：0、1 和无穷大。”

当然，现实情况迫使我们使用其他数字。但我总觉得如果我使用这三个以外的数字，我的代码会变得不那么优雅。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-02T00:05:52.803

是的，这些都很好。

我认为最好的方法是假设第一个版本不是最终版本。计划重写和重构。查看较小的块，并思考如何更优雅地完成它们。

另外，阅读代码，尤其是已知的好代码。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-02T00:31:45.923

> - 将大代码块保存在较小的例程/方法/类中

我喜欢做的是首先创建一个主要功能，这样我就不必从一开始就创建大量迷你功能，这会妨碍我的思路，然后再将其重构为更小的功能。重构很棒。

> 确保每个例程都有一个退出点。在循环顶部带有逻辑的退出循环，而不是带有中断或某种类型的“退出循环”关键字。

这不一定更清洁。它只会更容易证明函数的正确性。请参阅[函数是否应该只有一个 return 语句？](https://stackoverflow.com/questions/36707/should-a-function-have-only-one-return-statement)更多细节。

> 避免全局变量

有时全局变量是可以的。很多时候，人们使用单例只是为了避免使用“全局”，这实际上是伪装的全局，具有更多开销。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-02-13T03:49:21.717

虽然可能不完全是您正在寻找的答案类型，但我想说基于组件的设计倾向于通过优雅的架构来提供优雅的代码。考虑如何隔离代码会将结构和顺序应用于原本混乱的过程（有时）。代码优雅既可以在实施之前提前考虑（最好是彻底的），也可以通过重构和简化来寻求初始集成。如果您使用基于组件的模型，那么重构应用程序的组成部分将变得更易于管理 - 只要输入和输出在美化/简化过程中保持不变。对我来说，专注于整体应用程序结构已成为优雅代码的关键。它'

底线是代码是一个可延展且不断变化的过程。优雅只是在不同的时间点如此，因为有些东西可以开始优雅，经过几次迭代后就变成了杂物。在那之后，它再次被重构为优雅等等，这就是为什么通过健全的架构支持该想法将使您的代码更容易保持优雅，而不会破坏不相关的项目。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-02T01:03:23.040

通常，干净的代码与短函数或更好的缩进相关联。所以不要掉进那个陷阱。花大量时间设计课程。有一些很好的原则，例如[SOLID 原则](http://www.codetoglory.com/?p=40)，可以让您设计和构建有意义的良好课程。然后是选择适当的设计模式来模拟类的行为。当然，永远记住要遵循保持简单的原则。最后，确保架构中的复杂功能有足够的代码覆盖率。遵循所有这些可以帮助您编写干净的代码。这是我推荐给我的朋友和同事[的好书清单。](http://www.codetoglory.com/?p=64)

# c# - WinForms - 困惑 - 如何动态处理某些控件 - 正确

> ID：813762
> 
> 赞同：0
> 
> 时间：2009-05-02T00:06:12.303
> 
> 标签：c#, .net, winforms

我有一个 System.Windows.Form 类（我的主类）。有一个 RootMenu 对象。这是我自己的自定义对象。我正在尝试遍历 RootMenu 对象，并在每次通过时将 ToolStripMenuItem 添加到 ContextMenuStrip（我将其命名为 ContextMenu）。RootMenu 对象包含一个列表。链接有名称和网址（都是字符串）。

当表单加载我的“工厂”类时，我加载了一个 RootMenu 对象，然后我将其传递给 ProcessMenu 方法。

代码摘录在这里：

```
 private void ProcessMenu(RootMenu rm)
    {
        foreach (var lnk in rm.Links)
        {
            var tsmi = new ToolStripMenuItem(lnk.Name, null, new EventHandler(Navigate));
            tsmi.ToolTipText = lnk.Url;
            ContextMenu.Items.Add(tsmi);
        }
    }
    private void Navigate(object sender, EventArgs e)
    {
        var tsmi = (ToolStripMenuItem) sender;
        System.Diagnostics.Process.Start(tsmi.ToolTipText);
    } 
```

你知道我必须如何将 lnk.Url 存储在 ToolTipText 中吗？在 VB6 时代，所有控件都有“标签”属性。您曾经能够将额外的东西塞入您以后需要的控件中。我不想为此使用工具提示，但我的替代方案是什么？使用名称作为键将所有网址存储在哈希/字典中？我可能并不总是有唯一的名字，所以我想避免这条路线。在 .NET 中处理这个问题的正确方法是什么？也许我错过了一些我从未接触过的基本概念。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-02T00:19:13.473

`ToolStripMenuItem`有一个`Tag`属性：

```
tsmi.Tag = lnk.Url; 
```

事实上，相当多的 Windows 窗体控件都有它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-02T00:34:10.990

只需继承旧类并`Tag`在其中粘贴一个属性：

```
public class myToolStripMenuItem : ToolStripMenuItem
{
    public object myTag { get; set; }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-02T04:07:30.320

创建您自己的继承自 ToolStripMenuItem 的对象并添加任何自定义属性...。

```
 private void ProcessMenu(RootMenu rm)
    {
        foreach (var lnk in rm.Links)
        {
            var tsmi = new UrlToolStripMenuItem(lnk.Name, null, new EventHandler(Navigate))
            {
                Url = lnk.Url,
            };
            ContextMenu.Items.Add(tsmi);
        }
    }
    private void Navigate(object sender, EventArgs e)
    {
        var tsmi = (UrlToolStripMenuItem)sender;
        System.Diagnostics.Process.Start(tsmi.Url);
    }

    public class UrlToolStripMenuItem : ToolStripMenuItem
    {
        public UrlToolStripMenuItem(string text, Image image, EventHandler onClick) : base(text, image, onClick)
        {
        }

        public string Url { get; set; }
    } 
```

# c# - EventHandler 如何知道仅在定义类时才允许 = 运算符？

> ID：813763
> 
> 赞同：1
> 
> 时间：2009-05-02T00:06:46.093
> 
> 标签：c#, event-handling

我从一个问题开始，在输入问题时，找到了答案，但我认为这可能有助于 A) 获得确认和 B) 帮助他人，而不是删除。

如果我有一个事件，并且应用程序中的多个位置添加了侦听器，那么一次删除所有侦听器的最佳方法是什么？例如，我可以...

```
myPage.OnPageOpened += OpenPage; 
```

后来在我的代码中......

```
myPage.OnPageOpened -= OpenPage; 
```

但是，如果我有未知的第 3 方订阅者并且我想按下一个神奇的重置按钮来清除所有内容并从头开始，该怎么办？

您可以在 EventHandler 的任何地方使用 += 和 -= 运算符，因为运算符重载是公共的。= 重载运算符是私有的，它只能在定义类中调用。

所以在定义类中，我可以使用它来清除我的 EventHandler。

```
OnPageOpened = null; 
```

为了公开该功能，我可以...

```
public void ClearPageOpenedEvents() {
   OnPageOpened = null;
} 
```

那是对的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-02T00:25:42.913

是的，你是对的。这样做的原因是编译器在幕后创建了一个`private` `delegate`对象，如下所示：

```
private EventHandler pageOpened;

public EventHandler PageOpened
{
    add { pageOpened += value; }
    remove { pageOpened -= value; }
} 
```

在您的班级中，您有对私有`delegate`实例的引用，这就是您可以完成作业的原因。如果这是您需要的功能，您肯定想公开一种清除目标的方法；你不想暴露它`delegate`本身。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-02T00:13:25.890

这就是这样做的方法，但是类之外的东西如何知道该类应该删除其所有事件侦听器？如果有人扩展/使用您的代码并期待该事件持续发生怎么办？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-02T02:15:35.550

您可以在事件上使用赋值运算符，因为这是添加和删除事件的工作方式。使用 Reflector 对 C# 中事件是如何完成的有很多启发。

给定简单的类

```
public class MyClass
{
  public event EventHandler MyEvent;
} 
```

编译时产生以下代码

```
public class MyClass
{
  private EventHandler MyEvent;

  public event EventHandler MyEvent;
} 
```

因此，当您引用时，`MyEvent`您指的是私有委托变量`MyEvent`。`+=`and运算符是“特殊的`-=`”（因为它们不是运算符）并被更改为调用为事件创建的`add`and`remove`方法（它们本身使用赋值运算符）。

```
[MethodImpl(MethodImplOptions.Synchronized)]
public void add_MyEvent(EventHandler value)
{
  this.MyEvent = (EventHandler) Delegate.Combine(this.MyEvent, value);
}

[MethodImpl(MethodImplOptions.Synchronized)]
public void remove_MyEvent(EventHandler value)
{
    this.MyEvent = (EventHandler) Delegate.Remove(this.MyEvent, value);
} 
```

# ruby-on-rails - 无法访问与 has_one 相关的模型

> ID：813765
> 
> 赞同：0
> 
> 时间：2009-05-02T00:06:50.150
> 
> 标签：ruby-on-rails, ruby, activerecord, relational-database, has-one

我有两个模型：`Show`和`Venue`. 表演有一个场地，每个场地都属于表演。此条件在两个模型文件中都使用`has_one`&`belongs_to`语句正确定义。但是，我无法通过`show.venue`. 考虑以下代码，其中 s 是一个`Show`实例：

```
logger.info("*********************")
logger.info("#{s.inspect}")
logger.info("#{Venue.find(s.venue_id)}") # Works
logger.info("#{s.venue}") # Causes a MySQL Error
logger.info("*********************") 
```

我觉得导致 MySQL 错误的行应该可以工作。这是错误：

```
ActiveRecord::StatementInvalid (Mysql::Error: Unknown column 'venues.show_id' in 'where clause': SELECT * FROM `venues` WHERE (`venues`.show_id = 95)  LIMIT 1) 
```

我不知道它为什么试图访问`venues.show_id`. 有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-02T00:26:38.777

你有外键反转。在ActiveRecord 的约定中，带有belongs_to 的类应该映射到带有外键的数据库表。请参阅[ActiveRecord API](http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html)：“belongs_to 关联始终用于具有外键的模型中。” 这是有道理的，如果您考虑 belongs_to 与 has_one 和 has_many 交互的方式（因为您显然不能将外键放在 has_many 模型中）。

# vim - 如何在 Vim 中写入连续的命名文件？

> ID：813768
> 
> 赞同：3
> 
> 时间：2009-05-02T00:07:39.353
> 
> 标签：vim

我需要这个几次，直到现在我才想到，也许 Vim 可以为我做这件事。我经常保存编号很多且名称无关紧要的文件（无论如何它们都是临时的）。

我有一个充满文件的目录：file001.txt、file002.txt ...（它们并没有真正命名为“filexxx.txt” - 但为了讨论......）。我经常保存一个新的，并将其命名为例如 file434.txt。现在因为这是我经常做的事情，我想跳过命名检查部分。

有没有办法可以制作 vim 脚本来检查目录中的最后一个 filexxx.txt，并将当前缓冲区保存为 filexxx+1。我应该如何去写这样的东西？有没有人做过这样的事情？

所有建议表示赞赏。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-02T03:06:55.007

将以下内容放入`~/.vim/plugin/nextunused.vim`

```
" 下一个未使用的.vim

" 查找与给定模式匹配的下一个未使用的文件名
" 从 0 开始计数。该模式由 printf() 使用，因此请使用 %d
" 一个整数，%03d 表示一个用长度为 3 的零填充的整数。
功能！获取下一个未使用（模式）
  让我 = 0
  而文件可读（printf（a：pattern，i））
    让我 += 1
  结束时
  返回 printf(a:pattern,i)
结束功能

" 编辑与给定模式匹配的下一个未使用的文件名
命令！-nargs=1 EditNextUnused :execute ':e' 。GetNextUnused('<args>')
" 将当前缓冲区写入与给定模式匹配的下一个未使用的文件名
命令！-nargs=1 WriteNextUnused :execute ':w' 。GetNextUnused('<args>')

" 要使用，请尝试
" :EditNextUnused temp%d.txt
"
“ 或者
"
" :WriteNextUnused path/to/file%03d.extension
"

```

因此，如果您在一个已经使用`temp0000.txt`through的目录中并且您这样做了，它会将当前缓冲区写入.`temp0100.txt``:WriteNextUnused temp%04d.txt``temp0101.txt`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-02T04:46:54.877

一个你可以使用的脚本怎么样？这是一个快速的 python 脚本，应该可以完成你需要的。将脚本另存为“highest.py”到路径中的某个位置。从 VIM，进入命令模式并输入

:!python最高.py“文件*.txt”

它返回当前目录中编号最高的文件，或没有文件匹配的消息。它处理前导 0，并且可以推广到需要更复杂的模式。

```
#!/usr/bin/python
#
# Finds the highest numbered file in a directory that matches a given pattern
# Patterns are specified with a *, where the * will be where the number will occur.
#

import os
import re
import sys

highest = "";
highestGroup = -1;

if (len(sys.argv) != 2):
        print "Usage: python high.py \"pattern*.txt\""
        exit()

pattern = sys.argv[1].replace('*', '(\d*)')

exp = re.compile(pattern)

dirList=os.listdir(".")

for fname in dirList:
        matched = re.match(exp, fname)
        if matched:
                if ((highest == "") or (int(matched.group(1)) > highestGroup)):
                        highest = fname
                        highestGroup = int(matched.group(1))

if (highest == ""):
        print "No files match the pattern: ", pattern
else:
        print highest 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-02T01:25:19.370

您可以使用许多强大的语言（取决于您的 vim 的编译方式）为 vim 编写脚本，例如 perl、python、ruby。如果您可以使用为其中一种语言使用适当的解释器编译的 vim，这可能是您编写所需脚本的最简单方法。

# sql - 数据库自增列

> ID：813770
> 
> 赞同：2
> 
> 时间：2009-05-02T00:08:37.667
> 
> 标签：sql

是否可以创建一个具有 1 列（但不是主键列）自动递增的数据库？这样当我向数据库插入值时，我不需要自己填写值，DB 会为我填写该列的值（并在每次我执行新插入时递增）？

谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-02T00:12:52.927

是的，当然有可能。只需将此列设置为唯一键（不是主键），并且必须使用特殊属性声明它：SQL Server 为“IDENTITY”，MySQL 为“AUTO_INCREMENT”（参见下面的示例）。另一列可以是主键。

在 MySQL 数据库中，表可以这样声明：

```
CREATE TABLE `mytable` (
  `Name` VARCHAR(50) NOT NULL,
  `My_autoincrement_column` INTEGER(11) NOT NULL AUTO_INCREMENT,
  PRIMARY KEY (`Name`),
  UNIQUE KEY `My_autoincrement_column` (`My_autoincrement_column`)
);
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-02T00:22:46.413

是的，你可以这样做。这是使用**IDENTITY的****SQL Server**示例：

 **```
CREATE TABLE MyTable (
  PrimaryKey varchar(10) PRIMARY KEY,
  IdentityColumn int IDENTITY(1,1) NOT NULL,
  DefaultColumn CHAR(1) NOT NULL DEFAULT ('N')
)

INSERT INTO MyTable (PrimaryKey) VALUES ('A')
INSERT INTO MyTable (PrimaryKey) VALUES ('B')
INSERT INTO MyTable (PrimaryKey, DefaultColumn) VALUES ('C', 'Y')
INSERT INTO MyTable (PrimaryKey, DefaultColumn) VALUES ('D', 'Y')
INSERT INTO MyTable (PrimaryKey, DefaultColumn) VALUES ('E', DEFAULT)

--INSERT INTO MyTable (PrimaryKey, DefaultColumn) VALUES ('F', NULL) -- ERROR
--> Cannot insert the value NULL into column 'DefaultColumn', table 'tempdb.dbo.MyTable'; column does not allow nulls. INSERT fails.

SELECT * FROM MyTable 
```

这是一个使用 SQL Server 使用*函数来滚动您自己的递增列*的示例。这不是容错的方式，也不是我会这样做的方式。（我会使用标识功能。）但是，很高兴知道**您可以使用函数来返回默认值。**

```
DROP TABLE MyTable
GO
DROP FUNCTION get_default_for_mytable
GO

CREATE FUNCTION get_default_for_mytable
()
RETURNS INT
AS
BEGIN
    -- Declare the return variable here
    DECLARE @ResultVar int

    -- Add the T-SQL statements to compute the return value here
    SET @ResultVar = COALESCE((SELECT MAX(HomeBrewedIdentityColumn) FROM MyTable),0) + 1

    -- Return the result of the function
    RETURN @ResultVar

END
GO

CREATE TABLE MyTable (
  PrimaryKey varchar(10) PRIMARY KEY,
  IdentityColumn int IDENTITY(1,1) NOT NULL,
  DefaultColumn CHAR(1) NOT NULL DEFAULT ('N'),
  HomeBrewedIdentityColumn int NOT NULL DEFAULT(dbo.get_default_for_mytable())
)
GO

INSERT INTO MyTable (PrimaryKey) VALUES ('A')
INSERT INTO MyTable (PrimaryKey) VALUES ('B')
INSERT INTO MyTable (PrimaryKey, DefaultColumn) VALUES ('C', 'Y')
INSERT INTO MyTable (PrimaryKey, DefaultColumn) VALUES ('D', 'Y')
INSERT INTO MyTable (PrimaryKey, DefaultColumn) VALUES ('E', DEFAULT)

--INSERT INTO MyTable (PrimaryKey, DefaultColumn) VALUES ('F', NULL) -- ERRROR
--> Cannot insert the value NULL into column 'DefaultColumn', table 'tempdb.dbo.MyTable'; column does not allow nulls. INSERT fails.

SELECT * FROM MyTable 
```

**结果**

```
PrimaryKey IdentityColumn DefaultColumn HomeBrewedIdentityColumn
---------- -------------- ------------- ------------------------
A          1              N             1
B          2              N             2
C          3              Y             3
D          4              Y             4
E          5              N             5 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-02T00:24:26.910

我认为每个表只能有 1 个标识自动增量列，这些列不必是主键，但这意味着您必须自己插入主键。

如果您已经有一个自动递增的主键，那么我会尽可能尝试使用它。

如果您试图获取一个行 ID 以进行查询，那么我会考虑创建一个包含行 ID 的视图（不是 SQL 2000 或更低版本）。

您能否添加您的主键是什么以及您打算将自动增量列用于什么，它可能有助于提出解决方案

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-02T00:12:03.523

在 sql server 上，这称为[标识](http://www.sqlteam.com/article/understanding-identity-columns&ei=yo_7ScqiFJiwtAPfzLD1AQ&sa=X&oi=spellmeleon_result&resnum=1&ct=result&usg=AFQjCNHFQqFSLx7NCX2xFwV56X3fDL6tmA)列

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-02T00:44:02.447

Oracle 和 DB2 有序列，但我认为您正在寻找身份，所有主要的 dbms（mysql、sql server、db2、oracle）都支持它。

# perl - 如何在 Perl 中正确重新定义“打开”？

> ID：813779
> 
> 赞同：3
> 
> 时间：2009-05-02T00:12:57.623
> 
> 标签：perl, built-in, redefine

前段时间，我问了一个问题：[如何重新定义 Perl 的内置函数？](https://stackoverflow.com/questions/651124/how-do-i-redefine-built-in-perl-functions)

答案对我很有帮助。我有一个包覆盖 Perl 的“打开”功能，使我能够记录文件访问。

现在我遇到了一个破坏原始代码功能的案例。

```
use strict;
use warnings;
use Data::Dumper;

sub myopen (*;@) {
  my $p;
  my $retval = CORE::open($p, $_[1]);
  {
    no strict;
    *{"main::$_[0]"} = $p;
  }
  return $retval;
}

BEGIN {
  *CORE::GLOBAL::open = *myopen;
};

my @a = (1, 2, 3);

open(CHECK, ">dump") or print "UNABLE TO OPEN DUMPER FILE: $!\n";
print CHECK "test\n";
print CHECK Data::Dumper->Dump(\@a);
close CHECK 
```

现在我收到这条消息：

```
Can't locate object method "CHECK" via package "Data::Dumper" 
```

我如何解决它？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-02T01:25:57.370

**尝试使用 "CHECK" 以外的名称**。

“CHECK”是一个在编译时调用的特殊函数，你真的不应该使用它。

```
$ open CHECK , '<', 'foo.txt'; 
Took 0.00224494934082031 seconds.

Runtime error: Undefined subroutine &Devel::REPL::Plugin::Packages::DefaultScratchpad::CHECK called at (eval 329) line 5.

$ open CHECKS , '<', 'foo.txt'; 
Took 0.00155806541442871 seconds.

$ 
```

*   [更多关于“检查”](http://perldoc.perl.org/perlmod.html#BEGIN%2c-UNITCHECK%2c-CHECK%2c-INIT-and-END)

**为什么会出现这个特定错误？**

```
perl -MO=Deparse -e 'print CHECK Data::Dumper 1';
print 'Data::Dumper'->CHECK(1); 
```

此外，您正在使用**全局文件句柄**，这是有问题的。

使用这个符号：

```
open my $fh, '<' , $foo ; 
print <$fh>;
close $fh; 
```

这些是额外的好处，因为它们在超出范围时会自动关闭。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-02T16:44:01.923

这将起作用并且不会产生错误...

```
 print {*CHECK} Data::Dumper->Dump(\@a); 
```

这可以防止它被混淆具有[“间接对象语法”](http://perldoc.perl.org/perlobj.html#Indirect-Object-Syntax)

但是，我确实建议不要[在 Perl 中使用 CHECK 和其他特殊命名的代码块，](http://perldoc.perl.org/perlmod.html#BEGIN%2c-UNITCHECK%2c-CHECK%2c-INIT-and-END)而对文件句柄使用词法变量是首选方法。[PBP](http://www.perlfoundation.org/perl5/index.cgi?perl_best_practices)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-02T00:29:11.250

相比：

```
> perl -MData::Dumper -e'local*_=*STDOUT;print _ Data::Dumper->Dump([2]);'
Can't locate object method "_" via package "Data::Dumper" at -e line 1. 
```

至

```
> perl -MData::Dumper -e'local*_=*STDOUT;print _ ( Data::Dumper->Dump([2]) );'
$VAR1 = 2; 
```

我使用了与“STDOUT”不同的名称，因为它似乎只在间接对象不是内置句柄时才会出错。

# c# - C# 合同实现和异常

> ID：813780
> 
> 赞同：0
> 
> 时间：2009-05-02T00:13:04.097
> 
> 标签：c#, exception, business-logic

我有一个 BO 方法，它必须执行两个操作才能履行其合同。

1.  在数据库中插入一条记录
2.  发送包含记录元数据的电子邮件通知

两者都是通过调用负责完成操作的各个 DAO 方法来处理的。

我不会在我的 DAO 中捕获异常，我会在 BO 中处理和发布它们。第一次调用是对 DAO 进行插入，并且可以抛出 NullReferenceException 或其中一个 sql 异常。email 方法使用 SmtpClient.Send 可以引发大量异常。

是否可以通过属性强制调用电子邮件功能的子方法仅返回一种类型的异常，即自定义异常？

为了说明这一点：

```
public void AddSupportTicket(SupportTicketDTO ticket)
{
    try
    {
        supportTicketDAO.Insert(ticket);
        email.SendNotification(ticket);
    }
    catch (ExceptionA exc) { ... } // both of the methods can throw exceptions that
    catch (ExceptionB exc) { ... } // can overlap.  I just care about returning       
    catch (ExceptionC exc) { ... } // a custom EmailException or DataException
} 
```

我可以将每个子方法调用包装在它自己的 try catch 中并抛出我想要的自定义异常，但这只是另一个级别的 try catch 被 AddSupportTicket 中的另一个 try catch 捕获，然后在 UI 中重定向到一个智能错误，所以这对我来说听起来不太好。

我应该如何有效地抛出正确的自定义异常？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-02T00:20:09.883

是的，很有可能。查看企业库[异常处理块](http://msdn.microsoft.com/en-us/library/dd203116.aspx)。很多很棒的东西，关于从层和层之间引发、包装、记录异常以及设置策略，以便您可以根据需要在配置中处理它。结合日志应用程序块，它是一个强大的组合。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-02T00:24:16.753

如果您使用 WCF，您可以指定可以从给定函数引发的异常类型，因此在您的服务接口中，您将拥有类似

```
[OperationContract]
[FaultContract(typeof(MemberAlreadyExistsException))]
void MemberInsert(Member mu); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-02T00:17:37.970

不知道一个属性，但你可以不只是这样做：

```
try{
...
} catch(Exception ex) {

  throw new MyException("Some biz msg", ex);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-02T00:21:05.560

C# 不提供像 Java`throws`关键字这样的功能，如果这就是您所指的。您可以通过 XML 文档标准记录您的代码抛出的各种异常，但没有办法通过合同强制执行此操作。

您最好的选择是在应用程序的各个级别进行适当的文档和智能异常处理，就像听起来那样 glib。

# php - 调试 PHP

> ID：813783
> 
> 赞同：3
> 
> 时间：2009-05-02T00:15:00.910
> 
> 标签：php, debugging, xdebug

一段时间以来，我一直在使用 xdebug 调试和理解 php 项目中的代码，并且有时会遇到不清楚 PHP 内部发生了什么的情况。

是否可以设置 xdebug 或 gdb 以便我可以追踪到实际的 php 内置函数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-02T00:48:07.040

如果您使用的是 macosx、solaris 或最近的 freebsd 系统，您可以向它扔一点 dtrace。它可以为那些太多“PHP 正在做什么？”的人派上用场。时刻。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-02T00:19:19.543

我对此表示怀疑，xdebug 旨在跟踪您的 PHP 代码，而不是内部。假定内部是无错误的（显然有时并非如此，但这超出了 xdebug 的范围）。

如果您想知道内置函数的作用，您可以随时查看 PHP 源代码，但这有时很麻烦。当我想知道他们会做什么时，PHP 手册文档总是能很好地为我服务。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-02T09:38:55.343

您可以使用 gdb 跟踪 C 级代码，前提是您已使用调试符号编译了 php。看看这里开始：

[http://derickrethans.nl/phps_segmentation_faults_gdbfu.php](http://derickrethans.nl/phps_segmentation_faults_gdbfu.php)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-03T11:58:14.377

测试 Zend 引擎输出的一种方法是查看操作码，您可以使用**[Derick Rethan 的 VLD](http://derickrethans.nl/vld.php)（Vulcan Logic Dissasembler）**，它似乎也在[PECL](http://pecl.php.net/package/vld)上。*注意：*仅适用于 *nix 系统（有关要求，请参见站点）。

调试这些操作码的一些示例可以在[Sara Golemon 的博客](http://blog.libssh2.org/index.php?/categories/1-PHP)中找到，如[了解操作码](http://blog.libssh2.org/index.php?/archives/92-Understanding-Opcodes.html)和[一段字符串有多长？](http://blog.libssh2.org/index.php?/archives/28-How-long-is-a-piece-of-string.html).

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-11-30T12:33:22.673

还有一个很棒的 Google Chrome 扩展[PHP 控制台](https://chrome.google.com/webstore/detail/php-console/nfhmhhlpfleoednkpnnnkolmclajemef)，带有[php 库](https://github.com/barbushin/php-console/#php-console-server-library) ，它允许：

*   在 Chrome JavaScript 控制台和通知弹出窗口中查看错误和异常。
*   转储任何类型变量。
*   远程执行 PHP 代码。
*   通过密码保护访问。
*   按请求对控制台日志进行分组。
*   跳转到错误文件：文本编辑器中的行。
*   将错误/调试数据复制到剪贴板（供测试人员使用）。

推荐给大家！

# apache - TIME_WAIT 连接过多

> ID：813790
> 
> 赞同：2
> 
> 时间：2009-05-02T00:19:21.960
> 
> 标签：apache, tcp, time-wait

我们有一个使用 Apache mod 代理的相当繁忙的网站（每天 100 万页浏览量），在 TIME_WAIT 状态下，连接数（>1,000）不断超载。连接到端口 3306（mysql），但 mysql 只显示几个连接（显示进程列表）并且执行良好。我们已经尝试改变一堆东西（保持活力开/关），但似乎没有任何帮助。所有其他系统资源都在合理范围内。

我四处搜索，这似乎表明更改了 tcp_time_wait_interval。但这似乎有点激烈。我以前在繁忙的网站上工作过，但从未遇到过这个问题。

有什么建议么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-02T01:01:01.160

每个 time_wait 连接都是一个已经关闭的连接。

您可能正在连接到 mysql，发出查询，然后断开连接。对页面上的每个查询重复此操作。考虑使用连接池工具，或者至少是一个保持数据库连接的全局变量。如果您使用全局，则必须在页面末尾关闭连接。希望你有一些共同的地方，你可以把它，比如一个页脚包含。

作为奖励，您应该获得更快的页面加载。MySQL 可以快速连接，但不必重新连接甚至更快。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-09-24T07:21:05.147

如果您的客户端应用程序使用 JDBC，您可能会遇到这个错误： [http](http://bugs.mysql.com/bug.php?id=56979) ://bugs.mysql.com/bug.php?id=56979 我相信 php 也有同样的问题，干杯，Gilles。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-02T00:23:58.907

我们有一个类似的问题，我们的 web 服务器都冻结了，因为我们的 php 正在连接到一个 mysql 服务器，该服务器被设置为对传入连接进行反向主机查找。

当事情变慢时，它工作得很好，但在负载下，响应时间突然飙升，所有的 apache 服务器都卡在了 time_wait 中。

我们解决问题的方法是使用 xdebug 在高负载下的脚本上创建分析数据，然后查看它。mysql_connect 调用占用了 80-90% 的执行时间。

# asp.net - ScrewTurn wiki 和自定义 asp.net 会员提供商

> ID：813793
> 
> 赞同：1
> 
> 时间：2009-05-02T00:20:15.563
> 
> 标签：asp.net, asp.net-membership, wiki, screwturn

我正在考虑实施[Screwturn Wiki](http://www.screwturn.eu/)来记录网站的管理区域。我想使用现有的自定义 asp.net 会员提供程序，以便无缝访问 wiki。所以它看起来像这样：

*   `http://www.example.com/admin`- 现有行政区域
*   `http://www.example.com/admin/wiki`- 维基

有一个名为[HTTPUserProvider Plugin](http://stcez06.kiwipad.com/Default.aspx?Page=HTTPUserProviderPlugin&AspxAutoDetectCookieSupport=1)的插件，它允许您通过 Web 请求在另一个 Web 服务器上进行身份验证，但这似乎是一种 hack。

有人有这种情况的经验吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-09-14T13:09:02.380

凯尔特克斯，

也许对你来说有点晚了，但现在有一个 STW3 的 ASP.NET 成员资格提供程序： [http ://www.screwturn.eu/Customize.ASP-NET-Membership-Proxy-User-Provider.ashx](http://www.screwturn.eu/Customize.ASP-NET-Membership-Proxy-User-Provider.ashx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-30T22:16:18.657

他们现在有一个：

[http://www.screwturn.eu/Customize.UsersPluginsV2.ashx#ASPNet_Membership_User_Provider_33](http://www.screwturn.eu/Customize.UsersPluginsV2.ashx#ASPNet_Membership_User_Provider_33)

# apache-flex - 手动添加拖放支持

> ID：813794
> 
> 赞同：0
> 
> 时间：2009-05-02T00:20:32.957
> 
> 标签：apache-flex, drag-and-drop

我有一个容器，其中包含我需要从一个容器拖到另一个容器的图像。Flex 语言参考没有指定任何有用的东西，我也没有找到如何做到这一点的教程。如何手动添加对图像等元素的拖放支持？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-02T00:57:15.240

你看过 Flex 的拖放管理器吗？

[http://www.adobe.com/devnet/flex/quickstart/adding_drag_and_drop/](http://www.adobe.com/devnet/flex/quickstart/adding_drag_and_drop/)

# asp.net - 我可以在没有控件声明的页面上放置 ASP.NET 用户控件吗？

> ID：813810
> 
> 赞同：1
> 
> 时间：2009-05-02T00:26:57.653
> 
> 标签：asp.net, user-controls, controls, web-config, declaration

我想将用户控件放在页面上而不在页面顶部注册标签。例如：

```
<p>some text</p>
<myname:mycontrol runat="server" /> 
```

这可能吗？我听说标签声明可以在 web.config 中完成……这是真的吗？

如果是这样，知道哪个 .NET 框架版本支持这个吗？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-02T00:31:22.900

在 .net 2.0 web.config 中：

```
<pages>
    <controls>
    <add tagPrefix="MYPREFIX" namespace=="MyNamespace.Stuff" assembly="MyAssembly" /> 
```

更彻底的讨论[http://weblogs.asp.net/scottgu/archive/2006/11/26/tip-trick-how-to-register-user-controls-and-custom-controls-in-web-config。 aspx](http://weblogs.asp.net/scottgu/archive/2006/11/26/tip-trick-how-to-register-user-controls-and-custom-controls-in-web-config.aspx)

# asp.net-mvc - 如何指定将为 Mvc 控制器创建 Mvc 视图的位置？

> ID：813813
> 
> 赞同：0
> 
> 时间：2009-05-02T00:27:43.750
> 
> 标签：asp.net-mvc, visual-studio-2008, views, location, controllers

> **重要更新**
> 自 MVC 2.0 Preview 1 发布以来，此功能已作为实际框架本身的一部分以区域的形式实现。[Phil Haack 的博客上提供了](http://haacked.com/archive/2009/10/01/asp.net-mvc-preview-2-released.aspx)更多详细信息

我有一个名为 ListManagerController 的控制器。此控制器包含一个名为 Index() 的 ActionResult 方法。当我在 Visual Studio 中右键单击索引并选择添加视图时，新视图将在 /Views/ListManager/Index 中创建。

但是，我希望在 /Views/ **Manage** /ListManager/ 中创建索引视图和所有后续视图。我将如何做到这一点？

**编辑**：有人指出，这个问题与[此处](https://stackoverflow.com/questions/799838/asp-net-mvc-how-to-specify-which-folder-the-view-pages-reside-in/)发布的问题重复。看来我的搜索技巧最初让我失望了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-02T00:34:03.470

视图的位置与您正在使用的 ViewFactory 相关联。AFAIK Web 表单视图引擎不支持区域 [在您的示例中管理]。

[Spark](http://sparkviewengine.com/)支持这一点并且非常干净，您还可以混合和匹配 Web 表单和 Spark 视图，因此您不必重新创建所有视图。

**更新：**看起来 Phil Haack 有[一篇](http://haacked.com/archive/2008/11/04/areas-in-aspnetmvc.aspx)关于如何实现这一目标的博客文章。他的代码是针对 RC 的，但我认为应该可以针对 ASP.NET MVC RTM 进行编译。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-02T14:56:51.260

我知道您已经接受了答案，但这是我在[Phil Haack 的帖子](http://haacked.com/archive/2008/11/04/areas-in-aspnetmvc.aspx)的帮助下尝试相同想法时得出的结论。

首先，您需要拥有自己的 ViewEngine 来查找 View 文件夹下的文件夹。像这样：（你会注意到它看起来很像 Phil Haack 的区号）

```
public class TestViewEngine : WebFormViewEngine
{
    public TestViewEngine()
        : base()
    {
        MasterLocationFormats = new[] {
            "~/Views/{1}/{0}.master",
            "~/Views/Shared/{0}.master"
        };

        ViewLocationFormats = new[] {
            "~/{0}.aspx",
            "~/{0}.ascx",
            "~/Views/{1}/{0}.aspx",
            "~/Views/{1}/{0}.ascx",
            "~/Views/Shared/{0}.aspx",
            "~/Views/Shared/{0}.ascx"
        };

        PartialViewLocationFormats = ViewLocationFormats;
    }
    public override ViewEngineResult FindView(ControllerContext controllerContext, string viewName, string masterName, bool useCache)
    {
        ViewEngineResult rootResult = null;

        //if the route data has a root value defined when mapping routes in global.asax
        if (controllerContext.RouteData.Values.ContainsKey("root")) {
            //then try to find the view in the folder name defined in that route
            string rootViewName = FormatViewName(controllerContext, viewName);
            rootResult = base.FindView(controllerContext, rootViewName, masterName, useCache);
            if (rootResult != null && rootResult.View != null) {
                return rootResult;
            }
            //same if it's a shared view
            string sharedRootViewName = FormatSharedViewName(controllerContext, viewName);
            rootResult = base.FindView(controllerContext, sharedRootViewName, masterName, useCache);
            if (rootResult != null && rootResult.View != null) {
                return rootResult;
            }
        }
        //if not let the base handle it
        return base.FindView(controllerContext, viewName, masterName, useCache);
    }

    private static string FormatViewName(ControllerContext controllerContext, string viewName) {
        string controllerName = controllerContext.RouteData.GetRequiredString("controller");

        string root = controllerContext.RouteData.Values["root"].ToString();
        return "Views/" + root + "/" + controllerName + "/" + viewName;
    }

    private static string FormatSharedViewName(ControllerContext controllerContext, string viewName) {
        string root = controllerContext.RouteData.Values["root"].ToString();
        return "Views/" + root + "/Shared/" + viewName;
    }
} 
```

然后在您`Global.asax`用您的自定义 ViewEngine 替换默认 ViewEngine 时，在`Application_Start`：

```
ViewEngines.Engines.Clear();
ViewEngines.Engines.Add(new TestViewEngine()); 
```

现在，当您在中定义路由时`Global.asax`，您需要设置一个`root`值，指示要在 View 文件夹下查找的文件夹，如下所示：

```
routes.MapRoute(
    "ListManager",
    "ListManager/{action}/{id}",
    new { controller = "ListManager", action = "Index", id = "", root = "Manage" }
 ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-02T05:18:53.067

这个问题非常重复[这个问题](https://stackoverflow.com/questions/799838/asp-net-mvc-how-to-specify-which-folder-the-view-pages-reside-in/809676#809676)

所以我会在这里引用我对此的回答。

> 我想出了一个不同的解决方案，它不需要我滚动自己的视图引擎。
> 
> 基本上，我想让 MVC 尽可能保持“约定”驱动，但我仍然想在 ~/Views/Admin 文件夹下组织我的所有“管理员”视图。
> 
> 例子：
> 
> *   ~/视图/管理员/用户/
> *   〜/视图/管理/新闻/
> *   ~/视图/管理员/博客/
> 
> 我的解决方案是为我的特定管理控制器创建一个新的基类，并“强制”该控制器的视图路径。
> 
> 我在这里有一篇博文和示例代码：[Organize your views in ASP.Net MVC](http://www.clanmonroe.com/Blog/archive/2009/04/30/organize-your-views-in-asp.net-mvc.aspx)

# git - 如何使 git merge 处理对我的工作树的未提交更改？

> ID：813822
> 
> 赞同：56
> 
> 时间：2009-05-02T00:33:38.603
> 
> 标签：git, git-merge, git-stash

我和一位同事目前都在 master 分支上工作。我的工作树中有一些我不想提交的代码（调试语句等）。现在，如果他对其中一些相同的文件进行更改，我将无法合并它们：

```
$ git merge origin/master
Updating 1b8c5c6..eb44c23
error: Entry 'blah.java' not uptodate. Cannot merge. 
```

来自颠覆背景，我习惯于在我从存储库中提取更改时自动合并我的工作树，如果有冲突，我会手动解决它们。

我发现在 git 中执行此操作的最快方法是：

```
$ git stash
$ git merge origin/master
$ git stash pop 
```

本质上，删除我未提交的更改，进行合并，然后重新应用更改。如何告诉合并自动将我的工作树与我试图引入的更改合并？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-05-02T01:45:08.777

忘记你从颠覆中学到的一切。

在引入外部更改之前始终提交。

想象一下，你有一棵大部分工作的树——也许并不完美，但你正在取得一些进展。然后你去做一个合并，你引入的代码只是造成了严重破坏（本身就是错误的，太多的冲突需要处理，等等......）。如果您可以撤消它，那不是很好吗？

如果你承诺，你可以。如果你不这样做，你只会受苦。

记住：你提交的不一定是*你*推动的，但你不提交的很容易丢失。

只需做安全和简单的事情，尽早提交并经常提交。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-05-02T00:35:41.063

据我所知，你能做的最好的就是你已经拥有的`git stash`。我也觉得奇怪的是 merge 只想处理干净的树。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2019-03-19T01:50:59.780

*   如果本地工作未提交
    *   而且您引入了远程分支中不存在的全新文件：
    *   或者受本地工作影响的文件与受您需要从远程提取的更改影响的文件有零重叠：
        *   你很幸运：`git pull`会“正常工作”
    *   除此以外：
        *   如果您的本地更改与您正在提取的更改没有重叠：
            *   git stash 将起作用：
                *   `git stash save`
                *   `git pull`
                *   `git stash pop`
        *   如果您的本地更改与您正在提取的更改有一些重叠：
            *   git stash 需要手动解决冲突：
                *   `git stash save`
                *   `git pull`
                *   `git stash pop`
                *   解决合并冲突
                *   `git reset`
                *   `git stash drop`
*   如果提交本地工作
    *   并且受本地工作影响的文件与受本地工作影响的文件有零重叠
        *   你很幸运：`git pull`会“正常工作”
        *   但是：`git pull --rebase`由于历史更清晰，将“工作得更好”
        *   没有合并提交；您的更改将在上游更改后提交
    *   除此以外：
        *   git pull 需要手动解决冲突：
            *   `git pull`
            *   解决合并冲突
            *   `git add FILE`对于每个冲突的文件
            *   `git commit`
        *   `git pull --rebase`由于历史更清晰，仍然可以“工作得更好”
            *   但是，解决合并冲突可能要困难得多

详细解释请看：[https ://happygitwithr.com/pull-tricky.html](https://happygitwithr.com/pull-tricky.html)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-01-22T14:05:03.883

您无法告诉`git merge`合并对本地存储库有更改的文件的更改。这可以防止您在合并失败时丢失您的更改。

使用 CVS 和 SVN 合并方法，如果您在更新之前没有手动复制文件并且在合并时将它们打乱，您必须手动重新编辑才能恢复到良好状态。

如果您在进行合并之前提交您的更改或存储它们，那么一切都是可逆的。如果合并不顺利，您可以尝试几种方法来解决问题，然后选择效果最好的一种。

如果您确实提交了实验性或调试更改，您可能会`git rebase`在您通过的提交之后移动它们，`git merge`以便更容易摆脱它们或避免将它们意外推送到存储库。

请注意，`git rebase`在您已推送到共享存储库的分支上使用将使从该存储库中提取的每个人都感到悲痛。

我更喜欢`git stash`在这些情况下使用它，但我只在合并更改我已编辑但未提交的文件时使用它。

# c# - 如何从 ListView 控件中的所有项目中移除焦点？

> ID：813826
> 
> 赞同：3
> 
> 时间：2009-05-02T00:35:19.177
> 
> 标签：c#, winforms, listview

在`ListView`控件中，焦点`Item`位于该控件内的某些内容上 - 也就是说，控件维护其自己的内部概念，即焦点所在的内容，可以使用`FocusedItem`属性进行检索。

我不希望有*任何*项目被关注。换句话说，我希望`FocusedItem`属性设置为`null`. 知道我如何做到这一点吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-02T01:33:40.737

扩展 Vanuan 的答案：

```
if (listView1.FocusedItem != null)
{
    listView1.FocusedItem.Focused = false;
} 
```

有些东西告诉我您还想取消选择该项目。所以，你可能也想这样做：

```
if (listView1.SelectedItems.Count != 0)
{
    listView1.SelectedItems[0].Selected = false;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-02T01:14:57.130

我认为是这样

```
listView1.FocusedItem.Focused=false; 
```

确保 listView1.FocusedItem 不为空。

（感谢**brianpeiris**扩展）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-11-01T04:09:30.233

当新项目添加到列表视图控件时，它会在项目周围绘制虚线框。在某些情况下，您不想要这种视觉提示。只需突出显示选定的项目就足够了。这是在将新项目添加到列表视图控件时防止出现虚线框的一种方法。

```
ListViewItem item = new ListViewItem();
myListView.Items.Add(item);
myListView.SelectedItems.Clear();
myListView.FocusedItem = null;
myListView.Refresh(); 
```

更新：
我的解决方案不能解决问题。我希望有一种简单的方法可以“取消聚焦”控件，但是在谷歌搜索了几个小时后，我找不到任何东西。我也在寻找一种方法来防止那些虚线出现。当我单击按钮添加列表视图项目时，没有问题。只有当我在按下按钮（接收输入焦点）后按 Enter 时才会出现这种情况。

# cruisecontrol.net - CruiseControl.Net 和 NAnt 构建问题

> ID：813831
> 
> 赞同：1
> 
> 时间：2009-05-02T00:38:31.947
> 
> 标签：cruisecontrol.net, nant

我是第一次配置 CruiseControl.net 服务器。我的团队已经使用 NAnt 构建脚本，所以我们只是将服务器指向脚本并让 NAnt 完成所有工作。

如您所见，这非常简单：

```
<project name="ChannelIP">
    <tasks>
        <nant>
            <executable>C:\Program Files\nant-0.86-beta1\bin\nant.exe</executable>
            <baseDirectory>D:\mypath</baseDirectory>
            <buildFile>D:\mypath\myNAnt.build</buildFile>
            <targetList>
                <target>build</target>
            </targetList>
        </nant>
    </tasks>
</project> 
```

问题是当我在 CC 下运行它时，我收到以下错误：

> 函数调用失败。表达式：${framework::get-framework-directory('net-3.5')}/msbuild.exe
> 
> ```
>  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ 
> ```
> 
> 未安装 Microsoft .NET Framework 3.5 (net-3.5)，或未正确配置。你调用的对象是空的。

事实上，我确实使用 ${framework::get-framework-directory('net-3.5')} 变量来获取 msbuild.exe 的路径；但是，此代码以前从未失败过。我什至可以使用运行 CC 的用户帐户 RDP 进入服务器并直接运行 NAnt 构建文件，它工作得很好。

为什么这个原本很好的文件在 CC 运行时失败了。

注意 -CC 在我通常运行构建脚本的同一台机器上运行

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-02T01:58:13.160

CC 服务可能未在具有适当权限的帐户下运行。您是否尝试过使用命令行（将以登录用户身份运行）运行 CC 以查看是否有同样的问题？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-03T05:49:11.677

这听起来像是一个 NAnt 问题，它和 .NET 3.5 存在一些问题。您使用的是哪个版本的 NAnt？

另外，您是否看过[Using 0.86 beta 1 for .NET 3.5](http://www.nabble.com/Using-0.86-beta-1-for-.NET-3.5-td15966138.html)？这家伙有 NAnt 抛出的相同错误消息。建议的解决方案是使用最新的夜间版本。

# sql-server - 如何获得动态的最高行数？

> ID：813835
> 
> 赞同：0
> 
> 时间：2009-05-02T00:40:02.550
> 
> 标签：sql-server, linq-to-sql

我想获得表的顶部 #nr_of_rows - (int)(#nr_of_rows / 10 - 1)。所以就像如果你有 63 行，它将返回 3 行，90 行将返回 10，85 将返回 5，等等。当然这可以在两个查询中完成，只是想知道是否可以在一个查询中完成。

如果你们知道直接的 sql 查询，那就太好了，但理想情况下，我想要一个 linq to sql 的答案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-02T01:00:22.097

```
SELECT TOP 10 PERCENT * FROM Table 
```

或者

```
DECLARE @pct AS INT
SELECT @pct = (COUNT(*) / 10 )-1 FROM Table

SELECT TOP (@pct) * FROM Table 
```

或者

```
DECLARE @pct AS INT
SELECT @pct = (COUNT(*) / 10 )-1 FROM Table

SET ROWCOUNT @pct

SELECT * FROM Table 
```

我在 Linq to Sql 上很弱，但我认为你不能避免 2 次查找，因为你仍然需要子查询来获取计数（*），生成的 sql 仍然会有子查询这个类似的帖子似乎验证[了 TOP PERCENT 的 LINQ 版本](https://stackoverflow.com/questions/470339/linq-version-of-top-percent)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-02T01:00:15.060

我不明白您的公式如何映射到示例。90 - (int)(90 / 10 - 1) 是 82。但基本概念是：

select * from foo limit (select count( *) - (select (count(* ) / 10 - 1)));

只是希望你有一个像样的查询优化器。

# google-app-engine - 如何删除 Google Application Engine 中未使用的索引？

> ID：813839
> 
> 赞同：59
> 
> 时间：2009-05-02T00:45:11.430
> 
> 标签：google-app-engine, indexing

我[不小心](http://adventuresinthecloud.blogspot.com/2009/05/building-app-engine-google-query-terror.html)在我的 GAE 应用程序中添加了一个新过滤器。索引的状态现在是“服务” - 但是我根本不需要该索引，我想删除。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：95
> 
> 时间：2009-05-02T01:02:34.447

它记录[在这里](https://cloud.google.com/appengine/docs/standard/python/config/indexconfig)。希望有帮助。

> **删除未使用的索引**
> 
> 当您从 index.yaml 更改或删除索引时，原始索引不会自动从 App Engine 中删除。这使您有机会在构建新索引时让旧版本的应用程序继续运行，或者如果发现新版本存在问题，则可以立即恢复到旧版本。
> 
> 当您确定不再需要旧索引时，可以使用以下命令从 App Engine 中删除它们：
> 
> ```
> appcfg.py vacuum_indexes myapp/ 
> ```
> 
> 此命令删除本地版本 index.yaml 中未提及的应用程序的所有索引。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2011-07-27T17:39:43.030

对于 GAE / Java，文档包括[以下信息](http://code.google.com/appengine/docs/java/tools/uploadinganapp.html#Deleting_Unused_Indexes)：

> **删除未使用的索引**
> 
> ...
> 
> 当您确定不再需要旧索引时，可以使用 Vacuum_indexes 操作从 App Engine 中删除它们：
> 
> ```
> ./appengine-java-sdk/bin/appcfg.sh vacuum_indexes myapp/war 
> ```
> 
> 此命令会删除本地版本的 datastore-indexes.xml 和 generated/datastore-indexes-auto.xml 中未提及的应用程序的所有索引。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-10-08T14:02:28.970

在**Windows Google AppEngine Java**中，我们必须使用**appcfg.cmd**命令**删除**已部署应用程序的未使用索引。

**句法 ：**

> appengine-java-sdk-path\bin\appcfg.cmd vacuum_indexes project-root-path\poject-name\war\

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2019-02-01T16:17:06.103

截至2019年2月，现在是：

```
gcloud datastore indexes cleanup index.yaml 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2010-12-16T06:27:33.070

对于 gae-java，正如 JochenJung 所提到的，“vacuum_indexes”工具可以工作，但您必须通过以下方式模拟 python 项目：

请注意，真空工具似乎仅在指向 *.appspot.com 时才有效，而不是本地开发人员。环境。

*   为您的应用创建 app.yaml 并将其放在您的 /myapp/ 根目录中，至少：

```
 application: myproj
    version: 4
    runtime: python
    api_version: 1 
```

其中“version”是您的应用程序版本，“myproj”是您项目的 GAE 名称。

*   创建一个 index.yaml 并将其放在同一个根目录中。事实证明，该工具将为您删除的每个索引提供是/否确认，而不是费力地将您要保留的索引的索引信息放入该文件，因此仅指示 ALL 更简单应该删除索引，并使用确认来保留您想要保留的索引。

```
 indexes:

# AUTOGENERATED 
```

然后运行如上图所示的命令，

```
 /appcfg.py vacuum_indexes /path/to/myproj/ 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2015-08-06T19:12:19.550

如果您使用的是**maven** `mvn appengine:vacuum_indexes`。不需要`mvn appengine:update`，该命令更新远程服务器。

[完整的](https://cloud.google.com/appengine/docs/java/tools/maven)Maven 命令列表。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2015-07-12T19:35:56.863

在使用 Java 的 Windows 上，此命令对我有用：

```
appcfg.cmd vacuum_indexes C:\Users\Name\AndroidStudioProjects\Project\backend\src\main\webapp\ 
```

**注意：**确保文件夹`datastore-indexes.xml`中有一个`webapp`（这些索引将被保留）。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2018-03-19T18:31:04.073

使用当前版本的 gcloud，您可以简单地执行以下操作：

```
gcloud datastore cleanup-indexes index.yaml 
```

这比调用 appcfg.cmd [...] 更直观。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2019-06-06T10:02:52.973

`gcloud datastore cleanup-indexes /path/to/file/index.yaml`

此命令**不再起作用**。

`gcloud datastore indexes cleanup /path/to/index.yaml`

这是**新命令**。

你应该在`google cloud console`. 通常您可以`index.yaml`使用`file upload`. `google cloud console`你的文件直接被调用，`_admin`你可以`cd`去那里打电话，

`gcloud datastore indexes cleanup index.yaml`

### 提示

如果您`datastore`在**java 项目**中使用，则可以`datastore-indexes.xml`使用`index.yaml`. `index.yaml`如果您不知道在哪里查找，您可能很难找到该文件。

`index.yaml`您可以通过查看`deploy console`IDE来简单地找到文件的路径。

# wpf - 如何在 WPF 中创建 FileUpload 控件？

> ID：813850
> 
> 赞同：2
> 
> 时间：2009-05-02T00:51:15.240
> 
> 标签：wpf, file-upload

如何在 WPF 中创建 Fileupload 控件？

我想上传 jpg 图像文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-02T01:06:58.587

这取决于您要上传到什么。您很可能希望构建某种服务类来负责将文件复制到新位置。

然后在您的 XAML 中，您必须创建一个`TextBox`和一个`Button`来显示一个对话框。

虽然，您在 XAML 中的设计选项大大增加，因此您不会被锁定在 TextBox - Browse 按钮​​中。用更多细节更新您的问题，我可以尝试详细说明。

# windows-mobile - Windows CE 注册表设置 - 永不关机

> ID：813856
> 
> 赞同：2
> 
> 时间：2009-05-02T00:55:17.117
> 
> 标签：windows-mobile, registry

我有一个独特的工业应用程序，我不希望 Windows CE 设备断电（断电会切断无线连接，导致重新建立​​到服务器的链接会出现很长的延迟）。问题：硬重置会删除设备的“永不关闭”设置，使其进入睡眠状态。避免硬重置不是一种选择，因为设备有时需要它们。

控制它的*注册表项*是什么？这个想法是，使用注册表文件，设备将在启动时将密钥合并到系统中，从而无需手动设置。

* * *

为了节省时间，答案在下面的评论中，所以我在此处重新粘贴以供参考：

* * *

注册表项是：[HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Power\Timeouts] "BattSuspendTimeout" = dword:00000000

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-03-01T12:51:54.243

试试这个代码：

```
REGEDIT4

[HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Power\Timeouts]
 "BattSuspendTimeout"=dword:0 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-02T01:00:16.917

设备是什么？

使用运行 CE 的 Symbol 品牌扫描仪，您必须使用来自 symbol 的特殊程序（免费提供），该程序基本上拍摄设备快照 - 然后根据需要设置设置并拍摄另一个快照 - 然后编写代码在冷启动的情况下为您重置所有注册表设置。

有了关于设备的更多信息，我可能会提供更多帮助。

# sql - IDENT_CURRENT 出错 - 列名无效

> ID：813869
> 
> 赞同：1
> 
> 时间：2009-05-02T01:01:17.647
> 
> 标签：sql, sql-server, stored-procedures

我正在尝试更新表中最后插入的列。我尝试创建这个存储过程：

```
CREATE PROCEDURE [dbo].[msp_AssociateEvent]
(
    @EventId int
)

AS

UPDATE tblFoodMenus set
EventID = @EventId

Where FoodMenuID = IDENT_CURRENT(tblFoodMenus) 
```

但它给了我这个错误：

> 无效的列名 tblFoodMenus

我正确使用 IDENT_CURRENT 吗？

PS FoodMenuID 是自动递增的 tblFoodMenus 的主键

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-02T01:03:18.050

表名需要用引号引起来

```
Where FoodMenuID = IDENT_CURRENT('tblFoodMenus') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-02T07:41:26.640

Mark Brackett 对金钱的评论是正确的 - ident_current 无法安全地让您生成您感兴趣的特定身份。几乎总是您希望在执行插入的代码中使用[scope_identity()](http://msdn.microsoft.com/en-us/library/ms190315.aspx)，然后将其传递到任何地方是需要的。

# html - CSS 与 DRY

> ID：813875
> 
> 赞同：1
> 
> 时间：2009-05-02T01:04:08.047
> 
> 标签：html, css, dry

您正在创建一个 HTML 布局。让我们假设您不需要多个样式表的好处，HTML 大小的小幅增加不是问题，并且您有一个只会使用一次的样式。我经常支持在这里使用内联样式，因为我认为重复您的 CSS 类名称或 ID 是您当前不需要并且可能永远不会使用的抽象的成本。

这些天的标准原则是始终使用语义标记和 CSS 样式创建 HTML 布局，所以我在这里遗漏了什么吗？请让我知道你的想法。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-02T01:09:10.080

即使您只使用一种特定样式，将其与您的其他样式保持一致而不是将其内联仍然有好处。首先，关注点分离可以提高可维护性。如果您知道您将只进行样式更改，则可以在一个地方查找任何更改。另一个好处是不必输入类名的自我记录。通过给该样式命名，即使它只使用过一次，它也会使下面的语义代码更具声明性——您可以读到这个随机的不仅是`p`一个段落，它也是一个`intro`段落。

当然，这是假设您*永远不会*再使用该特定样式。如果*可能*的话，还有更多理由将其分解为命名样式。内联样式并不邪恶，但它们在某种程度上是一种入门药物。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-02T01:19:06.187

理想情况下，您的 CSS 应该是“面向对象的”（至少，与 CSS 一样的 OO）。当您定义可在其他地方使用的属性时，您应该从设置公共属性的类“继承”并创建新类。

看看[OOCSS 项目](http://wiki.github.com/stubbornella/oocss)，它试图支持这些原则（或重新引入它们）。

[引用](https://stackoverflow.com/questions/627261/object-oriented-css-should-it-matter/627323#627323) Welbog[的话](https://stackoverflow.com/users/52443/welbog)：

> ...在我看来，“OOCSS”只是不是随意编写的 CSS。就像你可以用 OO 语言编写非面向对象的设计一样，你很容易弄乱创建 CSS 的基本理念。OOCSS 似乎在说，“伙计们，我们不要再搞砸了。”

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-02T01:12:10.057

将 HTML 和 CSS 分开的一个优点是您可以在不更改任何 HTML 的情况下重新设计网页外观。

史蒂夫

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-02T01:07:05.137

在某些情况下，我通常会忽略为单个元素的简单样式更改创建新类。当您这样做时，通常很清楚，您需要将该特定样式应用于以后的其他内容的可能性几乎为零。对我来说最常见的情况是当我需要一些东西来让特定的填充/边距出现在正确的位置但它不是一个足够重要的元素来拥有自己的 ID。

这可能不是一个流行的观点，但在那些情况下，我不认为内联样式是邪恶的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-02T17:27:30.850

就个人而言，我发现我有一两个元素，我会放入一个内联样式，回去看看我需要的不仅仅是那个元素，所以我会把它改成一个类或者忘记它而不是能够改变它。

您还可以尝试放置某个 div / page 类，并在样式表中为其编写后代样式而不是内联元素。

此外，如果您决定添加 javascript，您将不会有一个标记良好的类，您需要更改它。

通常这对于动态生成的网站来说不是什么大问题，但是当您过度使用大量内联标签时，它可能会成为一个大问题。如果人们希望禁用样式以实现可访问性等，它也会使他们更难——你通常可以通过使用一个类来克服这个问题。

比如说，使用`<b style="color:red">bold</b>`body.products div b {color:red} 代替。

我个人是选择器的粉丝，不会使用太多的类。它们更具可重用性，您可以使用样式表在一个地方编辑整个站点。

但这是矫枉过正`<p style="font-weight:bold;font-size:1.2em; text-index:20px;">Indented Bold Paragraph</p>`所以它这个`<p class="indent bold larger">text</p> instead you can do`

`or ``<p><b></b></p>`.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-02T17:47:35.420

“愚蠢的一致性是小人的妖精”

那么，在这种情况下，哪个是愚蠢的一致性？:) 为什么 DRY 优先于标记和样式的分离？

你能确定你的 CSS 规则只会被使用一次吗？更重要的是，你怎么能确定它将来不需要改变，你怎么能确定你会是需要做出改变的人？你确定你甚至需要添加一个类或 id 来定位这个独特的元素吗？

我想我很难看到如何添加

```
<input type="submit" style="border: 1px solid red;"/> 
```

是不是比 12 个左右的字符更“优越”

```
<input type="submit" class="b-red">

.b-red {border: 1px solid red;} 
```

或可能等效的字符数

```
input {border:1px solid red;} 
```

当然，在某些情况下，每个经验法则都可以而且应该被违反。问题是，您从遵循 DRY 中获得的收益超过了遵循标记/样式二分法的重要性吗？

# ruby-on-rails - Apache 意外关闭

> ID：813876
> 
> 赞同：2
> 
> 时间：2009-05-02T01:05:58.557
> 
> 标签：ruby-on-rails, apache, apache2, shutdown, spam-prevention

我有一个在 Apache 后面运行的杂种服务器。它工作正常；但是，有时 Apache 服务器似乎会自行关闭。我不确定是否存在配置问题或是否是攻击。这是 Apache 错误日志：

```
[Thu Apr 30 02:15:07 2009] [notice] 收到 SIGHUP。尝试重新启动
[Thu Apr 30 02:15:07 2009] [警告] NameVirtualHost *:0 没有 VirtualHosts
[Thu Apr 30 02:15:07 2009] [notice] Apache/2.2.3 (Debian) PHP/5.2.0-8+etch13 已配置 -- 恢复正常操作
[2009 年 4 月 30 日星期四 02:17:13] [错误] [客户端 61.139.105.163] 文件不存在：/var/www/fastenv
[2009 年 4 月 30 日星期四 02:24:06] [错误] [客户端 61.139.105.163] 文件不存在：/var/www/fastenv
[2009 年 4 月 30 日星期四 10:49:18] [警告] pid 文件 /var/run/apache2.pid 被覆盖 - 以前 Apache 运行的不干净关闭？
[Thu Apr 30 10:49:18 2009] [notice] Apache/2.2.3 (Debian) PHP/5.2.0-8+etch13 已配置 -- 恢复正常操作
[2009 年 4 月 30 日星期四 12:53:08] [通知] SIGHUP 已收到。尝试重新启动
[Thu Apr 30 12:53:08 2009] [warn] NameVirtualHost *:0 has no VirtualHosts
[Thu Apr 30 12:53:08 2009] [notice] Apache/2.2.3 (Debian) PHP/5.2.0-8+etch13 已配置 -- 恢复正常操作
[2009 年 4 月 30 日星期四 12:59:15] [通知] SIGHUP 已收到。尝试重新启动
[Thu Apr 30 12:59:15 2009] [warn] NameVirtualHost *:0 has no VirtualHosts
[Thu Apr 30 12:59:15 2009] [notice] Apache/2.2.3 (Debian) PHP/5.2.0-8+etch13 已配置 -- 恢复正常操作
[2009 年 4 月 30 日星期四 13:58:49] [通知] SIGHUP 已收到。尝试重新启动
[Thu Apr 30 13:58:49 2009] [warn] NameVirtualHost *:0 has no VirtualHosts
[Thu Apr 30 13:58:49 2009] [notice] Apache/2.2.3 (Debian) PHP/5.2.0-8+etch13 已配置 -- 恢复正常操作
[2009 年 5 月 1 日星期五 10:59:07] [警告] pid 文件 /var/run/apache2.pid 被覆盖 - 以前 Apache 运行的不干净关闭？
[Fri May 01 10:59:07 2009] [notice] Apache/2.2.3 (Debian) PHP/5.2.0-8+etch13 已配置——恢复正常操作
[2009 年 5 月 1 日星期五 17:51:15] [警告] pid 文件 /var/run/apache2.pid 被覆盖 - 以前 Apache 运行的不干净关闭？
[Fri May 01 17:51:15 2009] [notice] Apache/2.2.3 (Debian) PHP/5.2.0-8+etch13 已配置 -- 恢复正常操作

```

不太确定 /var/www/fastenv 是什么，但我认为我的应用程序中没有任何东西可以调用它。此外，网站仍处于 Beta 模式，用户很少，我认为没有 61.139.105.163 IP 地址，但他们可能拥有它。

有任何想法吗？如果你能给我提示在哪里看或如何解决这个问题，那就太好了

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-02T01:16:50.217

不确定这是否完全与编程相关，但无论如何......在我看来，这些都不是严重的错误。访问`/var/www/fastenv`只是意味着 IP 地址为 61.139.105.163 的计算机发送了一个请求`http://www.example.com/fastenv`或类似的请求（这取决于您如何配置虚拟主机）；我会查看访问日志以获取更多信息，以查看来自该 IP 地址的其他请求。这可能没什么好担心的。

关于这一行`NameVirtualHost *:0`意味着在你的配置文件的某个地方你有一个不正确的`NameVirtualHost`指令，可能没有参数。您可能应该查找并删除它，但如果服务器运行正常，这没什么大不了的。

您的服务器终止（实际上是重新启动）的原因似乎是 SIGHUP - 也就是说，系统上的某些东西正在向 Apache 发送一个信号，告诉它重新启动。我认为，如果你跑步，基本上会发生同样的事情`apache2 restart`。在不知道是什么发出信号的情况下，我无话可说。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-06T15:04:26.773

我有来自同一个 IP 的完全相同的日志。查找它显示它属于中国政府。它似乎是使用服务器端包含的扫描，以尽可能多地了解您的服务器。我封了IP。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-15T22:26:10.677

61.139.105.163 以做各种黑客类型的事情而闻名，只需谷歌 IP 地址。您应该明确禁止此 IP 地址。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-05-22T06:40:19.613

点击 Apache Config --> Apache(httpd.conf)

搜索*#Listen 12.34.56.78:80*并将其替换为*#Listen 12.34.56.78:8081*。

搜索*Listen 80*并将其替换为*Listen 8081*。

现在您可以启动 Apache，并可以使用以下 URL 运行它：`localhost:8081/xampp/`

# python - 有没有办法检查函数输出是否分配给 Python 中的变量？

> ID：813882
> 
> 赞同：2
> 
> 时间：2009-05-02T01:08:18.800
> 
> 标签：python, functional-programming, bytecode

在 Python 中，我想编写一个函数，如果它自己调用它会将其结果漂亮地打印到控制台（主要用于交互使用或用于调试）。就这个问题而言，假设它检查某物的状态。如果我只是打电话

```
check_status() 
```

我想看到类似的东西：

```
Pretty printer status check 0.02v
NOTE: This is so totally not written for giant robots
=================================
System operational: ... ok
Time to ion canon charge is 9m 21s
Booster rocket in AFTERBURNER state
Range check is optimal
Rocket fuel is 10h 19m 40s to depletion
Beer served is type WICKSE LAGER, chill optimal
Suggested catchphrase is 01_FIGHTING_SPIRIT_GOGOGO
Virtual ... on 
```

但是，如果我在变量赋值的上下文中调用它，我也希望它将输出作为列表传递：

```
not_robot_stat = check_status()
print not_robot_stat
>>> {'cond_op': 1, 't_canoncharge': 1342, 'stage_booster': 5, 'range_est_sigma': 0.023, 'fuel_est': 32557154, 'beer_type': 31007, 'beer_temp': 2, 'catchphrase_suggestion': 1023, 'virtual_on': 'hell yes'} 
```

那么......有没有办法在一个函数中动态地知道它的输出是否被分配？我希望能够在不使用参数传递或为此编写另一个专用函数的情况下做到这一点。我已经用谷歌搜索了一段时间，从我所能知道的一点点看来，我不得不求助于使用字节码。这真的有必要吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-02T01:35:18.753

**新解决方案**

这是一个新的解决方案，通过检查自己的字节码来检测函数的结果何时用于分配。没有编写字节码，它甚至应该与 Python 的未来版本兼容，因为它使用 opcode 模块进行定义。

```
import inspect, dis, opcode

def check_status():

    try:
        frame = inspect.currentframe().f_back
        next_opcode = opcode.opname[ord(frame.f_code.co_code[frame.f_lasti+3])]
        if next_opcode == "POP_TOP": 
            # or next_opcode == "RETURN_VALUE":
            # include the above line in the if statement if you consider "return check_status()" to be assignment
            print "I was not assigned"
            print "Pretty printer status check 0.02v"
            print "NOTE: This is so totally not written for giant robots"
            return
    finally:
        del frame    

    # do normal routine

    info = {'cond_op': 1, 't_canoncharge': 1342, 'stage_booster': 5}

    return info

# no assignment    
def test1():
    check_status()

# assignment
def test2():
    a = check_status()

# could be assignment (check above for options)
def test3():
    return check_status()

# assignment
def test4():
    a = []
    a.append(check_status())
    return a 
```

**解决方案 1**

这是在 python -i 或 PDB 下调试时检测何时调用函数的旧解决方案。

```
import inspect

def check_status():
    frame = inspect.currentframe()
    try:
        if frame.f_back.f_code.co_name == "<module>" and frame.f_back.f_code.co_filename == "<stdin>":
            print "Pretty printer status check 0.02v"
            print "NOTE: This is so totally not written for giant robots"
    finally:
        del frame

    # do regular stuff   
    return {'cond_op': 1, 't_canoncharge': 1342, 'stage_booster': 5}

def test():
    check_status()

>>> check_status()
Pretty printer status check 0.02v
NOTE: This is so totally not written for giant robots
{'cond_op': 1, 't_canoncharge': 1342, 'stage_booster': 5}

>>> a=check_status()
Pretty printer status check 0.02v
NOTE: This is so totally not written for giant robots

>>> a
{'cond_op': 1, 't_canoncharge': 1342, 'stage_booster': 5}

test()
>>> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-02T01:32:18.353

> 但是，我也希望它将输出作为列表传递

您的意思是“将输出作为字典返回”-小心;-)

您可以做的一件事是使用 Python 解释器自动将任何表达式的结果转换为字符串的能力。为此，请创建一个自定义子类`dict`，当被要求将其自身转换为字符串时，执行您想要的任何漂亮格式。例如，

```
class PrettyDict(dict):
    def __str__(self):
        return '''Pretty printer status check 0.02v
NOTE: This is so totally not written for giant robots
=================================
System operational: ... %s
Time to ion canon charge is %dm %ds
Booster rocket in %s state
 (other stuff)
''' % (self.conf_op and 'ok' or 'OMGPANIC!!!',
       self.t_canoncharge / 60, self.t_canoncharge % 60, 
       BOOSTER_STATES[self.booster_charge],
       ... ) 
```

当然，您可能会想出一种更漂亮的方法来编写代码，但基本思想是该`__str__`方法创建表示对象状态的漂亮打印字符串并返回它。然后，如果你`PrettyDict`从你的`check_status()`函数中返回一个，当你输入

```
>>> check_status() 
```

你会看到

```
漂亮的打印机状态检查 0.02v
注意：这完全不是为巨型机器人编写的
==================================
系统运行：...好的
离子炮充电时间为 9m 21s
助推器火箭处于 AFTERBURNER 状态
范围检查是最佳的
火箭燃料消耗 10h 19m 40s
供应的啤酒是 WICKSE LAGER 类型，最适合冷藏
建议的标语是 01_FIGHTING_SPIRIT_GOGOGO
虚拟...开启
```

唯一的问题是

```
>>> not_robot_stat = check_status()
>>> print not_robot_stat 
```

会给你同样的东西，因为同样的字符串转换是`print`函数的一部分。但是对于在某些实际应用程序中使用它，我怀疑这是否重要。如果您真的想将返回值视为纯字典，您可以这样做

```
>>> print repr(not_robot_stat) 
```

相反，它应该向您展示

```
{'cond_op'：1，'t_canoncharge'：1342，'stage_booster'：5，'range_est_sigma'：0.023，'fuel_est'：32557154，'beer_type'：31007，'beer_temp'：2，'catchphrase_suggestion'：1023，' virtual_on': '该死的'}
```

关键是，正如其他海报所说，Python 中的函数无法知道如何处理它的返回值（*编辑*：好吧，也许会有一些奇怪的字节码黑客方式，但不要'不要那样做） - 但你可以在重要的情况下解决它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-02T01:42:49.217

这没有用例。Python 将所有交互式结果分配给一个名为`_`.

您可以交互地执行以下操作。效果很好。没什么好笑的。

```
>>> check_status()
{'cond_op': 1, 't_canoncharge': 1342, 'stage_booster': 5, 'range_est_sigma': 0.023, 'fuel_est': 32557154, 'beer_type': 31007, 'beer_temp': 2, 'catchphrase_suggestion': 1023, 'virtual_on': 'hell yes'}

>>> pprint.pprint( _ )
{'beer_temp': 2,
 'beer_type': 31007,
 'catchphrase_suggestion': 1023,
 'cond_op': 1,
 'fuel_est': 32557154,
 'range_est_sigma': 0.023,
 'stage_booster': 5,
 't_canoncharge': 1342,
 'virtual_on': 'hell yes'} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-02T01:15:11.857

函数无法知道它的返回值是如何被使用的。

好吧，正如您所提到的，令人震惊的字节码黑客可能能够做到这一点，但它会非常复杂并且可能很脆弱。走更简单的显式路线。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-02T05:01:11.957

即使有办法做到这一点，这也是一个坏主意。想象一下，尝试根据调用它的上下文来调试行为不同的东西。现在试着想象从现在开始还有六个月的时间，它被埋在某个系统的一部分中，这个系统太大而无法一次全部留在你的脑海中。

把事情简单化。显式优于隐式。只需制作一个漂亮的打印函数（或使用 pprint 模块）并在结果上调用它。在交互式 Pythn 会话中，您可以使用 _ 来获取最后一个表达式的值。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-02T01:16:21.480

没有办法做到这一点，至少用正常的语法过程是没有办法的，因为函数调用和赋值是完全独立的操作，彼此之间没有感知。

我能看到的最简单的解决方法是将标志作为 arg 传递给您的`check_status`函数，并相应地处理它。

```
def check_status(return_dict=False) :
    if return_dict :
        # Return stuff here.
    # Pretty Print stuff here. 
```

进而...

```
check_status() # Pretty print
not_robot_stat = check_status(True) # Get the dict. 
```

编辑：我认为你会比你分配的更频繁地打印。如果不是这种情况，请交换默认值和您传入的值。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-02T01:18:41.367

做你想做的事情的唯一方法确实是“使用字节码”——没有其他方法可以恢复该信息。当然，更好的方法是提供两个单独的函数：一个获取状态为 dict，另一个调用第一个函数并对其进行格式化。

或者（但不是一个优秀的架构）你可以有一个函数，它接受一个可选参数以这两种完全不同的方式表现——这不是很好，因为一个函数应该有一个函数，即基本上做一件事，而不是两个不同的比如这些。

# rsync - 无法在我的服务器和我的 Mac 之间进行 rsync

> ID：813883
> 
> 赞同：4
> 
> 时间：2009-05-02T01:08:47.317
> 
> 标签：rsync

我有一台服务器，用于存储来自 Mac A 和 Mac B 的数据。

我使用 rsync 在我的 Mac 之间保持文件更新。

我运行以下代码失败

```
#!/bin/zsh

#    to copy files from my server to my folder
rsync -Pav $Masi:~/private/ ~/Dropbox/Courses/math/

#    to  copy files from my folder to my server
rsync -Pav ~/Dropbox/Courses/math $Masi:~/private/ 
```

我收到以下错误消息

```
ssh: connect to host  port 22: Connection refused
rsync: connection unexpectedly closed (0 bytes received so far) [receiver]
rsync error: unexplained error (code 255) at io.c(600) [receiver=3.0.5]
ssh: connect to host  port 22: Connection refused
rsync: connection unexpectedly closed (0 bytes received so far) [sender]
rsync error: unexplained error (code 255) at io.c(600) [sender=3.0.5] 
```

我有 ssh 密钥，所以连接应该可以工作，因为我可以毫无问题地使用 scp。

**如何在我的服务器和我的一台 Mac 之间使用 rsync？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-02T03:25:17.177

我曾经做过很多这样的事情。刚试了一下，提几点建议。

1.  拼出你的整个 user@host 模式
2.  首先运行 ssh 连接 sans the rsync，您可能需要先批准您的指纹
3.  您似乎没有传递标志来保护扩展属性，这可能会在 OS X 上产生损坏的文件。如果您不需要资源分叉，您可以，但大多数时候您确实需要它们。

我的测试用例：

```
$ rsync -Pav ~/Desktop/ me@remote.example.com:~/rsyc-test 
```

在这种情况下， ~/Desktop 中的所有文件都被复制到远程主机，在我的主目录中。由于目录'rsyc-test'不存在，它是为我制作的。我的桌面上有一个 .app，它成功了，令人惊讶的是，它可以工作。甚至一些 .webloc 文件也成功了，并且似乎可以工作，尽管我不相信它。

我强烈建议添加 -E 标志

> ```
>  -E, --extended-attributes
>          Apple specific option  to  copy  extended  attributes,  resource
>          forks,  and  ACLs.   Requires at least Mac OS X 10.4 or suitably
>          patched rsync. 
> ```

我进行了一项新测试，将 Interarchy 书签移到了我的桌面上，我知道如果它们被复制而没有资源分叉，它们就会中断。在没有 -E 的情况下运行与使用 -E 运行，xfered 数据有 152 个字节的差异。远程机器上的第一个文件不起作用，第二个传输的文件起作用。

在您的示例中，我不禁注意到您的路径之一是 ~/Dropbox，所以这可能都无关紧要，因为应用程序 DropBox 目前根本不支持资源分叉，尽管我听说将来有计划。

您也没有发送 --delete 标志，如果您的最终目标是数据的镜像，那么您将没有得到它，如果您的最终目标是不断增长的备份，保留源上的所有内容，缺少的 --delete 很好。

其他注意事项：
您可以排除那些愚蠢的 .DS_Store 文件 --exclude '.DS_Store'

您还可以将 rsync 设置为真正的镜像，这样您就不需要运行其他命令，有关详细信息，请参阅手册页。

我将笔记本电脑的桌面推到远程机器的最终工作命令：

```
$ rsync -PEav --delete --exclude '.DS_Store' ~/Desktop/ me@remote.example.com:~/rsycn-test 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-02T02:25:49.177

检查“$Masi”。那是您要访问的主机名吗？

尝试以下命令对其进行调试：

```
rsync -e 'ssh -v' -Pav $Masi:~/private/ ~/Dropbox/Courses/math/ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-12-02T20:34:00.813

当远程（例如防火墙）存在连接问题时，通常会发生*连接被拒绝。*

在您的情况下，问题是`$Masi`变量为空。如果它不是可变的，请使用`Masi`.

根据此错误：

> SSH：`connect to host port 22: Connection refused`

^(`host`注意上面单词后面的双空格。)

*连接到主机*消息没有说明是哪个主机，因此您正在尝试连接到空主机。所以这听起来像是主机名的错字。

# c - 在 GCC 中实现通用原子加载或存储的更好方法？

> ID：813887
> 
> 赞同：10
> 
> 时间：2009-05-02T01:11:05.300
> 
> 标签：c, gcc, atomic

我知道 GCC 的内置原子操作： http: [//gcc.gnu.org/onlinedocs/gcc-4.3.2/gcc/Atomic-Builtins.html](http://gcc.gnu.org/onlinedocs/gcc-4.3.2/gcc/Atomic-Builtins.html)

但是这个列表不包括非常简单的操作，比如加载和存储。我可以使用内联汇编在有限的架构上实现这些（实际上对于许多像 x86 这样的人来说，它们基本上只是普通的 mov），但在一般情况下，没有比这样的更好的方法了：

```
// returns the value at ptr
void *atomic_load_ptr(void **ptr)
{
    return __sync_fetch_and_add(ptr, 0);
}

// returns old value int ptr after setting it to newval
void *atomic_store_ptr(void **ptr, void *newval)
{
    void *oldval = atomic_load_ptr(ptr)
    void *oldval2;
    do {
        oldval2 = oldval;
    } while ((oldval = __sync_val_compare_and_swap(ptr, oldval, newval)) != oldval2);
    return oldval;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T09:07:20.020

您可以使用 test_and_set 实现低级互斥锁。加载函数是一个很好的 imo，但是你存储函数应该使用 test_and_set 而不是

```
while ((oldval = __sync_val_compare_and_swap(ptr, oldval, newval)) != oldval2); 
```

以防止错误。

# c++ - 处理具有不同字符集的库的头文件中的 TCHAR

> ID：813898
> 
> 赞同：3
> 
> 时间：2009-05-02T01:15:03.433
> 
> 标签：c++, libraries, tchar

我有一个使用两个第三方库的项目，这两个库都在其头文件中使用了 TCHAR。不幸的是，一个库被编译为多字节（称为库 a），而另一个库被编译为 Unicode（称为库 b）。

现在我理解它的方式是 TCHAR 被预编译器替换为 wchar 或 char 取决于构建选项。因此，当编译库 a 时，任何采用 TCHAR 类型参数的方法都被设置为期望 char 类型的参数，而库 b 中的方法被设置为期望 wchar 类型的参数。

不幸的是，我的消费应用程序也必须选择一个字符集。如果我选择 Unicode，那么我为库 a 包含的头文件告诉我该方法需要一个 wchar，因为当我在头中编译 TCHAR 时，它们被解释为 wchar。这包括在结构内部定义的 TCHARS。我已经在实践中确认了这种行为，当我分配并传递一个 TCHAR 缓冲区时，我得到了垃圾，因为它用多字节数据填充了我的 wchar 缓冲区。

我的问题是：有没有一种干净的方法可以在同一个应用程序中使用这两个库？我在使用这些库的方式上可能做错了吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-02T03:04:40.223

假设您没有在这些库中的任何一个中使用太多类/函数，我将完全包装其中一个库。假设您决定在您的应用程序中使用 mbc 并包装库 b（unicode），则可以使用您的包装器头文件`wchar_t`而不是`TCHAR`这样 #define 不会影响您的界面。在您的包装器的 cpp 文件中，您 #include 库 b 的标头，您 #define`TCHAR`以匹配库 b。不应允许除您的包装器之外的任何代码查看库 b。

如果您在这两个库中使用多个类/函数，那么维护包装器代码将很快成为其自身的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-02T04:29:54.137

正如[成业](https://stackoverflow.com/questions/813898/handling-tchars-in-header-files-for-libraries-with-different-character-sets/814034#814034)建议的那样，最好将差异包装在您自己的 API 中。这使您的源代码独立于它。

The wrapping API then has to convert characters from your encoding to the library's. On windows, I you have functions called [WideCharToMultiByte](http://msdn.microsoft.com/en-us/library/aa450778.aspx) and the like.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-02T01:28:43.777

我认为您最好的选择是选择库 a 或库 b（我们将在此示例中使用库 a）来执行此操作。然后，当您包含库 b 头文件时，请确保 #define/#undef 无论库 b 是用什么编译的。然后，您必须确保在库 a 和库 b 使用相同数据时进行转换。

如果您能以相同的方式编译它们，那将是最好的。否则会很乱。

# devtools - 如何通过浏览器操作网页（重新排列一些 HTML 控件）？

> ID：813900
> 
> 赞同：-1
> 
> 时间：2009-05-02T01:15:17.117
> 
> 标签：devtools

我希望能够打开我的网站并使用某种 firefox 插件通过拖放重新排列网站上的一些 Html，并能够使用修改后的源。我曾经使用过一个css插件，但现在不记得了。有没有很酷的工具或插件可用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-02T01:18:34.563

它不是拖放，但[Firebug](https://addons.mozilla.org/en-US/firefox/addon/1843)可以让您修改 Firefox 中的任何网页。不过，您必须直接编辑 HTML/CSS 源代码；完成后，您应该能够复制并粘贴到文本编辑器中。

# asp.net - 将 cookie 过期设置为 DateTime.Max（9999 年 12 月 31 日）时出现问题？

> ID：813904
> 
> 赞同：6
> 
> 时间：2009-05-02T01:16:51.027
> 
> 标签：asp.net, cookies

我们支持删除 cookie 并将过期时间设置为 DateTime.MaxValue 的遗留代码：

```
HttpCookie cookie = new HttpCookie(cookieName, value);
cookie.Expires = DateTime.MaxValue; 
```

似乎在某些浏览器（我们没有记录）上，这个 cookie 会立即过期——或者甚至可能不会被丢弃。根据 MSDN，DateTime.MaxValue 是 9999 年 12 月 31 日。将 cookie 过期设置为该日期是否存在与浏览器相关的问题？

正确的答案是更改到期日期，但此时我们无法更改生产代码。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-02T01:38:46.420

如果我不得不随机猜测它为什么不起作用，我会说它与[Unix epoch time](http://en.wikipedia.org/wiki/Unix_time)有关。在 2038 年 1 月 19 日凌晨 3:14:07 GMT 之后，该值在技术上将溢出（在 32 位机器上） - 因此之后的下一秒将被解释为 1970 年 1 月 1 日凌晨 0:00:01 GMT。

您提供的未来时间可能实际上已转换为过去时间。

同样，这是一个完整的猜测，希望当 VWD Express 2008 下载到我的家用计算机上时，我可以很快对其进行测试。

### 编辑：

搜索这个问题，我发现了一个类似的错误：

[http://framework.zend.com/issues/browse/ZF-5690](http://framework.zend.com/issues/browse/ZF-5690)

# ms-access - 使用 Microsoft Access 数据库创建 ASP.NET 网站时出错

> ID：813905
> 
> 赞同：0
> 
> 时间：2009-05-02T01:17:15.177
> 
> 标签：ms-access

我正在使用 Microsoft Access 数据库创建一个简单的 C# CMS 系统

这是我在 web.config 文件中的连接字符串

```
<add name="VirtualCMSConnectionString" connectionString="Provider=Microsoft.Jet.OLEDB.4.0; Data Source=|DataDirectory|ASPNetDB.mdb" providerName="System.Data.OleDB"/> 
```

我使用了此处的“访问提供程序”模块：[http ://blog.krisvandermast.com/UsingAccessInsteadOfSQLServerForYourASPNETApplicationServices.aspx](http://blog.krisvandermast.com/UsingAccessInsteadOfSQLServerForYourASPNETApplicationServices.aspx)

我遇到的问题是，当我尝试使用数据集设计创建数据集时，当我尝试为表适配器选择连接字符串时收到错误消息。

> **无法打开与数据库的连接**
> 
> **“无法获取名为‘System.Data.OleDb’的数据提供者的提供者工厂**
> 
> **检查连接并重试**

谁能帮我解决这个问题。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-02T01:31:55.000

您是否已下载 .vsi、解压缩、构建 SampleAccessProviders.dll 并将其添加到您的项目中？

> 现在我们已经创建了程序集，是时候实际使用它了。打开您的 Visual Studio 或 Visual Web Developer Express 并创建一个新网站。在项目中，您创建一个名为 bin 的新子文件夹。创建后右键单击它并从出现的上下文菜单中选择添加现有项目...。导航到构建程序集所在的位置。将其添加到网站项目的 bin 文件夹中。之后对访问数据库 (ASPNetDB.mdb) 文件重复相同的操作，但这次将其放在专用文件夹 App_Data 中，该文件夹是预定义的 ASP.NET 2.0 子文件夹之一。

# ruby-on-rails - 在 Ruby 中以 Word 文档格式以编程方式输出文件的最佳方法是什么？

> ID：813912
> 
> 赞同：4
> 
> 时间：2009-05-02T01:21:53.620
> 
> 标签：ruby-on-rails, ruby, api, ms-word

我需要根据应用程序中的一些文本内容，从基于 Ruby 的 Web 应用程序（Rails/Sinatra）输出 Word 文档格式的文件。Ruby 中是否有用于创建和构建 Word 文档的库支持？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-02T01:26:58.180

查看[WordML](http://msdn.microsoft.com/en-us/library/aa212812(office.11).aspx)，这是 Word 文件的 XML 格式。

约翰杜兰特的博客有一个有用的[WordML 和常见问题资源列表](http://blogs.msdn.com/johnrdurant/archive/2004/05/12/130500.aspx)

[演练：Word 2007 XML 格式](http://msdn.microsoft.com/en-us/library/bb266220.aspx)

创建 XSLT 转换的有用工具：Office 2003 工具：[WordprocessingML 转换推理工具](http://www.microsoft.com/downloads/details.aspx?familyid=2cb5b04e-61d9-4f16-9b18-223ec626080e&displaylang=en)

这些 SO 帖子也可能很有趣：

*   [使用 VBA 创建 Word 或 XML 文档](https://stackoverflow.com/questions/588585/creating-word-or-xml-document-with-vba)
*   [使用 ASP.Net 使用模板和 XPath 生成 WordML 报告](https://stackoverflow.com/questions/409020/generating-wordml-reports-using-templates-and-xpath-using-asp-net)
*   [将 XHTML 转换为 Word ML](https://stackoverflow.com/questions/299235/convert-xhtml-to-word-ml)
*   [XML to WordML using XSLT 1.0 - 用 wordML 格式化标签替换 xml 内容中的 html 标签](https://stackoverflow.com/questions/234215/xml-to-wordml-using-xslt-1-0-replace-html-tags-within-xml-content-with-wordml-f)
*   [如何将转换 docx 或 wordml xml 文件转换为 xsl-fo？](https://stackoverflow.com/questions/380139/how-can-i-convert-convert-docx-or-wordml-xml-files-to-xsl-fo)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-02T02:02:42.227

您没有指定“Word 文档”的确切含义。它是 Word 2003 样式的 doc 文件吗？它是 Word 2007 docx 文件吗？它只是 Word 可以打开而不支持样式的东西吗？

如果后者是你想要的，你可以使用 RTF，它比 doc 格式更容易一些。有一个名为[Ruby RTF](http://ruby-rtf.rubyforge.org/)的库应该可以满足您的需求，尽管老实说我自己从未使用过它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-22T21:11:50.893

生成 Word 2003 文档是否更容易：对于不需要 XML 等博士学位的基本 Word 2003 .doc 文件格式是否更容易理解？

# c - strspn( ) 的实现

> ID：813914
> 
> 赞同：3
> 
> 时间：2009-05-02T01:24:50.633
> 
> 标签：c

库函数的定义`strspn`是：

```
size_t strspn(const char *str, const char *chars)

/* Return number of leading characters at the beginning of the string `str`
   which are all members of string `chars`. */ 
```

例如，如果`str`is`"fecxdy"`和`chars`is`"abcdef"`那么函数将返回`3`，因为`f`，`e`并且`c`都出现在某处`chars`，给出 3 个前导字符`str`，并且`x`是第一个字符`str`不是 的成员`chars`。

有人可以帮我用`strspn`C 编写一个实现吗？我可以从实现中调用的唯一库函数是`strlen`？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-02T01:30:16.237

基本思想是遍历字符串，一次一个字符，并测试它是否在字符集中。如果不是，请停止并返回答案。在伪代码中，它看起来像：

```
count = 0
for each character c in str
    if c is not in chars
        break
    count++
return count 
```

该`if c is not in chars`测试可以通过遍历所有字符`chars`并测试是否`c`匹配任何字符来实现。请注意，这不是最快的实现，因为它涉及逐步`chars`遍历`str`. 更快的实现将使用查找表来测试`c is not in chars`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-01-13T15:46:44.223

我在复习旧考试时发现了这个问题。不允许您使用索引或任何标准功能。这是我的解决方案尝试：

```
#include <stdio.h>    
size_t myStrspn(const char *str1, const char *str2){
  size_t i,j;
  i=0;

  while(*(str1+i)){
    j=0;
    while(*(str2+j)){
      if(*(str1+i) == *(str2+j)){
        break; //Found a match.
      }
      j++;
    }
    if(!*(str2+j)){
      return i; //No match found.
    }
    i++;
  }
  return i;
}

void main(){
  char s[] = "7803 Elm St.";
  int n = 0;
  n = myStrspn(s,"1234567890");
  printf("The number length is %d. \n",n);
} 
```

这是考试的解决方案：

```
#include<stdio.h>
size_t strspn(const char* cs, const char* ct) {
  size_t n;
  const char* p;
  for(n=0; *cs; cs++, n++) {
    for(p=ct; *p && *p != *cs; p++)
      ;
    if (!*p)
      break;
  }
  return n;
} 
```

For 循环使它更加紧凑。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-21T21:29:37.010

我认为这应该很快

```
size_t strspn(const unsigned char *str, const unsigned char *chars){
    unsigned char ta[32]={0};
    size_t i;
    for(i=0;chars[i];++i)
        ta[chars[i]>>3]|=0x1<<(chars[i]%8);
    for(i=0;((ta[str[i]>>3]>>(str[i]%8))&0x1);++i);
    return i;
} 
```

感谢其他人的健全性检查。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-01-26T18:04:20.007

```
int my_strspn(const char *str1,const char *str2){
int i,k,counter=0;
for(i=0;str1[i]!='\0';i++){
 if(counter != i) break;
 for(k=0;str2[k]!='\0';k++){
  if(str1[i]==str2[k])
   counter++;
 }
}
 return counter;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-06-17T14:21:15.307

为所有可能的 ASCII 字符创建一个查找表（穷人的集合），然后在`str`. 这是最坏的情况`O(max(N,M))`，其中`N`是 中的字符数，`str`是`M`中的字符数`chars`。

```
#include <string.h>

size_t strspn(const char *str, const char *chars) {
  int i;
  char ch[256] = {0};

  for (i = 0; i < strlen(chars); i++) {
    ch[chars[i]] = 1;
  }

  for (i = 0; i < strlen(str); i++) {
    if (ch[str[i]] == 0) {
      break;
    }
  }

  return i;
} 
```

这也可以`strlen`在根本不使用的情况下解决，假设两个字符串都以零结尾。这种解决方案的缺点是查找表需要 256 字节的内存。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-08-09T17:48:03.767

A naive implementation of `strspn()` would iterate on the first string, as long as it finds the corresponding character in the second string:

```
#include <string.h>
size_t strspn(const char *str, const char *chars) {
    size_t i = 0;
    while (str[i] && strchr(chars, str[i]))
        i++;
    return i;
} 
```

Given that you are not allowed to call `strchr()`, here is a naive native implementation:

```
size_t strspn(const char *str, const char *chars) {
    size_t i, j;
    for (i = 0; str[i] != '\0'; i++) {
        for (j = 0; chars[j] != str[i]; j++) {
            if (chars[j] == '\0')
                return i; // char not found, return index so far
        }
    }
    return i;  // complete string matches, return length
} 
```

Scanning the second string repeatedly can be costly. Here is an alternative that combines different methods depending on the length of `chars`, assuming 8-bit bytes:

```
size_t strspn(const char *str, const char *chars) {
    size_t i = 0;
    char c = chars[0];

    if (c != '\0') {  // if second string is empty, return 0
        if (chars[1] == '\0') {
            // second string has single char, use a simple loop
            while (str[i] == c)
                i++;
        } else {
            // second string has more characters, construct a bitmap
            unsigned char x, bits[256 / 8] = { 0 };
            for (i = 0; (x = chars[i]) != '\0'; i++)
                bits[x >> 3] |= 1 << (x & 7);
            // iterate while characters are found in the bitmap
            for (i = 0; (x = str[i]), (bits[x >> 3] & (1 << (x & 7))); i++)
                continue;
        }
    }
    return i;
} 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-05-02T01:41:55.710

在过去的几年里没有接触过 C 编译器。从我的头顶来看，这样的事情应该可以工作：

```
int spn = 0;
while(*str++ != '\0')
{
  char *hay = chars;
  bool match = false;
  while(*hay++ != '\0')
  {
     if(*hay == *str)
     {
       match = true;
       break;
     }
  }

  if(match)
     spn++;
  else
     return spn;
}
return spn; 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2015-07-05T13:16:49.990

好吧，为我的操作系统实现一个标准库，这是我的解决方案（C++）。

```
KCSTDLIB_API_FUNC(size_t DECL_CALL strspn(const char * str1, const char * str2))
{
size_t count = 0;
auto isin = [&](char c)
{
    for (size_t x = 0; str2[x]; x++)
    {
        if (c == str2[x])
            return true;
    };
    return false;
};
for (; isin(str1[count]); count++);
return count;
} 
```

# compiler-construction - 静态类型的 Lua

> ID：813926
> 
> 赞同：19
> 
> 时间：2009-05-02T01:30:24.130
> 
> 标签：compiler-construction, lua, static-typing

我正在寻找在编译时进行类型检查的 Lua 前端编译器，但输出标准 Lua 5.1 字节码（只有运行时类型）。我想要的是相当数量的静态编译时语法分析和可选类型，以便比运行时更快地检测到微不足道的错误。生成的字节码必须与使用标准 LoadString() 编译的现有 Lua 字节码很好地配合使用。

需要明确的是——任何差异只会发生在字节编译时。在运行时，字节码不会知道在编译阶段发生了任何不同/不寻常的事情。

我的想法听起来很像 ActionScript；我什至不介意输出 Lua 字节码的 ActionScript 编译器！

有没有人听说过这样的努力？我已经看到一些关于使用 MetaLua 来执行此操作的参考资料，但老实说，我还不够聪明，无法对他们的文档做出正面评价

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-02T02:37:41.490

大约在 2005 年夏天左右，我与一位[非常聪明的本科生](http://www.innaz.org)一起研究了为 Lua 进行一些编译时类型推断的问题，这可能由注释辅助。事实证明，这个问题非常困难！（我的学生写了一篇简短的技术说明，但它并不是真正用于一般流通的。）

如果我想解决你提出的问题，它*允许重要的静态类型检查*以及*与标准字节码编译的 Lua 代码互操作*的双重约束，我会**从头开始设计一种新语言**来满足这两个约束。这将是大量的工作，但比尝试将类型系统改造为 Lua 容易得多。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-02T06:18:41.130

请参阅[此 Metalua 博客文章](http://metalua.blogspot.com/2007/04/type-checking-reloaded.html)。

```
-{ extension "types" }

function sum (x :: list(number)) :: number
  local acc :: number = 0
  for i=1, #x do acc=acc+x[i] end
  return acc
end 
```

不过，这看起来像是一个运行时解决方案。

无论如何，请随时在[Metalua 邮件列表](http://lists.luaforge.net/mailman/listinfo/metalua-list)中提出您的问题。如果你想扩展 Lua 语法，Metalua 是第一个要看的工具。

PS 请[永远不要把 Lua 写成全大写](http://www.lua.org/about.html#name)！

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2015-10-26T17:42:55.930

这个问题已有六年历史了......但这是一个新的答案：[http ://terralang.org/](http://terralang.org/)

> 与 C 一样，Terra 是一种简单的、静态类型的、带有手动内存管理的编译语言。但与 C 不同的是，它从一开始就被设计为与 Lua 互操作。Terra 函数是使用 terra 关键字创建的一流 Lua 值。需要时，它们会被 JIT 编译为机器代码。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-02T01:36:04.867

哪有这回事。可以扩展 MetaLua 来做到这一点，但没有人这样做，而且 AFAIK，没有计划这样做。Lua 是一种动态语言，如果您想要一种静态类型的语言，请使用它。

您实际上要寻找的是 Java 或 C# 之类的东西。在这种情况下，您可以使用[Lua.NET 之](http://www.lua.inf.puc-rio.br/luanet/)类的项目将现有的 Lua 代码与 C# 集成。还有用于 Java的[Kahlua 。](http://code.google.com/p/kahlua/)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2014-07-03T23:57:15.863

PUC-Rio 刚刚在 Dyla'14 上发表了一篇新论文“Typed Lua: An Optional Type System for Lua”。[http://dl.acm.org/citation.cfm?id=2617553](http://dl.acm.org/citation.cfm?id=2617553)

它是关于“Typed Lua 的初始设计，Lua 脚本语言的可选类型扩展”。还在进行中，类型系统还是比较简单的。没有提供类型推断/类型检查工具。

关于基于 metalua 的类型系统，Tidal Lock：来自 Fabien 的 Lua 的可选静态类型检查和推理。[http://lua-users.org/lists/lua-l/2013-02/msg00403.html](http://lua-users.org/lists/lua-l/2013-02/msg00403.html)。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2016-12-03T20:58:11.290

还有拉维 [https://github.com/dibyendumajumdar/ravi](https://github.com/dibyendumajumdar/ravi)

Ravi 编程语言是 Lua 5.3 的衍生版本，具有有限的可选静态类型和基于 LLVM 和 libgccjit 的 JIT 编译器

我真的很喜欢在 Terra 中编程（见上文）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-09-09T02:19:27.720

我推荐[EmmyLua](https://github.com/EmmyLua)。

这是一个支持打字文档的 Intellij/VSCode 插件。我发现整体记录方法非常友好。也感谢它的 IDE 支持，EmmyLua 也支持提示。

这是 EmmyLua 文档的一个小片段：

```
--- @alias recipe_prototype any
--- @alias recipe_name string
--- @alias ingredient_name string

--- @class Coordinate
--- @field x number
--- @field y number

--- @class Entity
--- @field entity_number number unique identifier of entity
--- @field name string entity name
--- @field position Coordinate
--- @field direction any defines.direction.east/south/west/north

--- @class BlueprintSection
--- @field entities Entity[]
--- @field inlets number[] index of inlets in entities list
--- @field outlets number[] index of outlets in entities list

--- @type BlueprintSection
BlueprintSection = {}

--- @return BlueprintSection
function BlueprintSection.new()
    --- ...
end

--- @param other BlueprintSection
--- @param xoff number optional, x-offset of the other section, default to width of self
--- @param yoff number optional, y-offset of the other section, default to 0
--- @return BlueprintSection new self
function BlueprintSection:concat(other, xoff, yoff)
   -- ...
end 
```

有关更多文档参考，请查看[https://emmylua.github.io](https://emmylua.github.io)

# netbeans - Netbeans 的 Zenburn

> ID：813928
> 
> 赞同：11
> 
> 时间：2009-05-02T01:31:19.713
> 
> 标签：netbeans, themes

Netbeans 有 Zenburn 主题吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-06T04:35:54.917

您可以尝试Netbeans 的[Aloha 颜色主题](http://blog.huikau.com/2008/04/28/aloha-color-theme-for-netbeans-61/)。它类似于 Zenburn。

更新：对于 NetBeans 6.9 - [zenburn 配色方案](http://forums.netbeans.org/topic29869.html)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-06T04:39:55.187

我已经为它手动设置了一个，就像我对一堆其他编辑器/IDE 所做的那样。然后最终我放弃了，开始使用 gvim 做所有事情。现在事情容易多了。

说真的，当我尝试为 Netbeans 做这件事时，似乎有一些限制，你可以在颜色/语法高亮中改变什么。虽然我不记得具体的例子，但有一些事情我不能完全正确，这曾经让我很困扰。

如果您想要颜色参考，我的 wiki 上有一个，因为当我以前在随机编辑器中设置 Zenburn 时，请随意使用它：[http ://wiki.steam-punk.net/zenburn](http://wiki.steam-punk.net/zenburn)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-02T01:48:04.197

哦，我多么希望有，但是可以手动更改颜色。

首选项 > 字体和颜色 > 语法

# javascript - 随机化数组中的元素？

> ID：813935
> 
> 赞同：8
> 
> 时间：2009-05-02T01:34:22.263
> 
> 标签：javascript, algorithm, arrays, shuffle

我为我的一位艺术家朋友创建了一个网站，她希望布局保持不变，但她也希望将她制作的新画作混合到当前布局中。所以我在主画廊页面上有 12 个缩略图（thumb1 - thumb12）和 18 个图像（img1 - img18）要放置

我想到的方法是创建一个包含所有图像的数组，将其随机化，然后简单地刮掉前 12 个图像并将它们加载到拇指槽中。另一种方法是从数组中随机选择 12 个图像。在第一种情况下，我找不到随机化数组元素的方法。在后一种情况下，我无法思考如何防止图像多次加载，除了使用第二个数组，这似乎非常低效和可怕。

顺便说一句，我正在用 Javascript 完成所有这些工作。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-02T01:41:55.583

我前一阵子写了这篇文章，它恰好适合你正在寻找的东西。我相信 ojblass 指的是 Fisher-Yates 洗牌：

```
Array.prototype.shuffle = function() {
   var i = this.length;
   while (--i) {
      var j = Math.floor(Math.random() * (i + 1))
      var temp = this[i];
      this[i] = this[j];
      this[j] = temp;
   }

   return this; // for convenience, in case we want a reference to the array
}; 
```

请注意，修改 Array.prototype 可能被认为是错误的形式。您可能希望将其实现为将数组作为参数的独立方法。无论如何，要完成它：

```
var randomSubset = originalArray.shuffle().slice(0,13); 
```

或者，如果您不想实际修改原始文件：

```
var randomSubset = originalArray.slice(0).shuffle().slice(0,13); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-02T01:36:14.490

您应该实现[Fisher-Yates shuffle](http://en.wikipedia.org/wiki/Fisher-Yates_shuffle)（也称为 Knuth shuffle）。

看看[这里](https://stackoverflow.com/questions/790083/does-qsort-demand-consistent-comparisons-or-can-i-use-it-for-shuffling/790097#790097)提供的很好的答案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-02T01:38:16.747

你的第一种方法会奏效。只需洗牌 18 个元素并取前 12 个元素。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-02-28T11:55:19.747

我最近自己也遇到了这个问题。这里的帖子有帮助：[http](http://waseemsakka.com/2012/02/14/javascript-dropping-the-last-parts-of-an-array-and-randomizing-the-order-of-an-array/) ://waseemsakka.com/2012/02/14/javascript-dropping-the-last-parts-of-an-array-and-randomizing-the-order-of-an-array/ 。

基本上，从随机化你的数组开始：

```
thumbs.sort(function(a, b) {
     return Math.random() - 0.5;
}) 
```

这将随机化 18 个元素的顺序。然后只保留前 12 个元素，您只需删除最后 6 个：

```
thumbs.length = 12; 
```

# system-testing - 测试 Web 应用程序的外观

> ID：813937
> 
> 赞同：0
> 
> 时间：2009-05-02T01:35:04.820
> 
> 标签：system-testing

### 复制：

> *   [测试网站的跨浏览器/多版本支持](https://stackoverflow.com/questions/462848/testing-a-website-for-cross-browser-multiple-version-support)
>     
>     
> *   [你如何测试可视化组件](https://stackoverflow.com/questions/351975/how-do-you-test-visual-components)

* * *

我最近与一位同事讨论了我们在工作中用于系统测试 Web 应用程序的工具。然后同事提出了我们是否测试了应用程序的外观的问题。

有没有其他人这样做，如果是这样，如何测试它以确保物品不会被移出原位或物品的尺寸是否正确等？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-02T01:37:51.163

如果您想检查您的网站在许多不同浏览器中的外观，请查看[Browsershots](http://browsershots.org/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-02T02:29:36.517

当我到达那里时，我的一个客户已经与[Litmus建立了合作关系，并且该项目的工作轻而易举。](http://litmusapp.com/)很滑。

不过，我希望能够像这样推出自己的系统。太糟糕了，他们不卖实际的软件——只卖服务。

# c - 此代码段有什么问题

> ID：813941
> 
> 赞同：1
> 
> 时间：2009-05-02T01:36:57.110
> 
> 标签：c, debugging, memory-management, compiler-errors

伙计们，这里是 的一个实现`memset()`，但是我被告知代码中存在一个逻辑错误。你能帮我找到吗。

我觉得应该将目标字符串的双指针传递给这个函数，这就像传递指针变量的地址而不是指针本身一样。

在 MS VC++ IDE 中执行代码时出现“访问冲突”。

“C”库函数 memset 的定义是

```
void *memset(char *s, char c, size_t n) 

Copy c to the first n characters of s. Return s.

void *memset(char *s, char c, size_t n)
{
  size_t i;
  for (i = 0; i < n; i++, s++)
  {
    *s = c;
  }
  return s;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-02T01:45:20.210

这有几个问题。

```
void *memset(char *s, char c, size_t n)
{
  size_t i;
  for (i = 0; i < n; i++, s++)  /* incrementing s means you cannot return */
  {                             /* the original value */
    *s = c;                     /* consider using s[i] = c after not incr. s*/
  }
  return s;                     /* this should probably be a cast back to void */
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-02T01:43:49.463

您不应该更改返回的指针。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-02T01:43:59.310

检查函数的返回值。它返回什么？有什么文件可以返回？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-02T01:46:01.143

我有一种感觉，你的 size_t n 可能会减少一个。

s 也指向字符串的末尾，而不是函数末尾的原始 s。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-02T01:50:33.457

您修改 s 的值，然后将其返回。这意味着您将返回一个指向memset 区域*末尾*的指针，而不是开头（这可能是您想要的）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-02T03:17:34.700

您声明您遇到了“访问冲突”。这表明您正在使用“s”的非空值调用函数，但是，“s”未正确初始化

```
// bad - s will have some arbitrary value as allocated on the stack (all bets are off)
char *s;
memset(s,0,100);

// good
char s[100];
memset(s,0,100);

// bad - the memset will generate an access violation on byte 101
char s[100];
memset(s,0,101);

// good
char *s = malloc(100);
memset(s,0,100); 
```

** 一个与访问冲突无关的注释...以您的方式返回 's' 与 string.h 中的传统 memset() 行为不同。在那个库中，返回值应该是“s”的值作为输入。在您的代码中，您将返回一个指向最后一个字节之后的字节的指针，这会产生访问冲突。例如：

```
// good
char *s = malloc(100);
char *d = memset(s,0,100);
printf("%s\n",d);  // generates an access violation 
```

在 memset() 文档中，d 和 s 应该具有相同的值。在您的代码中， d = s[101];

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-02T01:53:35.463

嗯...试试这个：

```
void *memset (char* s, char c, size_t n){
  char* begin = s;
  char* end = begin + n;
  whilw (begin != end) *begin++ = c;
  return s;
} 
```

# apache - 您可以将 mod_proxy 配置为反向代理缓存吗？

> ID：813942
> 
> 赞同：0
> 
> 时间：2009-05-02T01:36:57.797
> 
> 标签：apache, caching, reverse-proxy

我可以将 mod_proxy 配置为正向代理缓存，也可以将其配置为反向代理。有没有办法将其配置为反向代理缓存？我还没有运气。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-02T18:11:27.827

使用 mod_proxy，Apache 可以充当正向代理或反向代理。除非您也专门启用 mod_cache，否则它不能用作缓存。启用 mod_cache 后，它也应该透明地处理代理内容的缓存。该模块被标记为**实验性**的。

有关更多详细信息，请参阅[mod_cache 文档页面](http://httpd.apache.org/docs/2.0/mod/mod_cache.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-02T18:30:58.030

您*可以*按照您的要求做（例如，参见 Roshan 的回答），但我也建议您查看专用的反向 HTTP 代理：[Varnish](http://varnish.projects.linpro.no/)。

Varnish 非常高效，比 Apache 高得多。

# python - 如果我想在 Apache 中使用 pylons 应用程序，我应该使用 mod_wsgi 还是 proxy 来粘贴？

> ID：813943
> 
> 赞同：4
> 
> 时间：2009-05-02T01:37:39.340
> 
> 标签：python, apache2, pylons, mod-wsgi

还是我应该使用完全不同的服务器？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-02T02:26:56.460

带有 mod_wsgi 的 Nginx 需要使用非阻塞异步框架和设置，并且不太可能与 Pylons 一起工作。

我通常使用 PasteScript#cherrypy WSGI 服务器的代理路由到一个独立的 Pylons 进程（因为它的性能比 Paste#http 更高，但如果你有泄漏它不会回收线程......）。

如果您打算使用 Apache 及其服务器（这样*您*就可以编译和运行 Apache mod_wsgi），我建议您使用该设置来减少维护以有效利用多个内核。使用代理设置，您必须将 mod_proxy_balancer 与多个粘贴过程一起使用，以有效利用多个内核/cpus。

如果您要部署到其他人的 Apache（共享主机），mod_proxy 通常是更简单的解决方案，因为它在 Apache 2.2 及更高版本中的库存。

就个人而言，我通常使用 nginx + 代理部署到多个粘贴进程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-03T15:47:43.983

我现在也多次使用 mod_fastcgi + flup 取得了巨大的成功。有一些方法可以设置它，但不幸的是，它可能仍需要您进行一些调整才能使一切正常：

[http://wiki.pylonshq.com/display/pylonscookbook/Production+Deployment+Using+Apache,+FastCGI+and+mod_rewrite](http://wiki.pylonshq.com/display/pylonscookbook/Production+Deployment+Using+Apache,+FastCGI+and+mod_rewrite)

# c - 为什么不是所有代码编译位置都独立？

> ID：813980
> 
> 赞同：93
> 
> 时间：2009-05-02T01:59:27.603
> 
> 标签：c, compilation

在 gcc 中编译共享库时，-fPIC 选项将代码编译为与位置无关。是否有任何理由（性能或其他）为什么您不会独立编译所有代码位置？

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2009-05-02T02:05:42.237

它增加了一个间接性。使用与位置无关的代码，您必须加载函数的地址，然后跳转到它。通常函数的地址已经存在于指令流中。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-05-02T02:03:47.357

是的，有性能原因。一些访问实际上是在另一层间接下获得内存中的绝对位置。

还有存储全局变量偏移量的 GOT（全局偏移量表）。对我来说，这看起来就像一个 IAT 修正表，它被维基百科和其他一些来源归类为位置相关。

[http://en.wikipedia.org/wiki/Position_independent_code](http://en.wikipedia.org/wiki/Position_independent_code)

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2009-05-02T06:18:56.683

除了接受的答案。严重损害 PIC 代码性能的一件事是 x86 上缺少“IP 相对寻址”。使用“IP 相对寻址”，您可以从当前指令指针中请求 X 字节的数据。这将使 PIC 代码更简单。

跳转和调用通常是相对于 EIP 的，所以这些并不真正构成问题。但是，访问数据需要一些额外的技巧。有时，寄存器将被临时保留为代码所需数据的“基指针”。例如，一种常见的技术是滥用调用在 x86 上的工作方式：

```
call label_1
.dd 0xdeadbeef
.dd 0xfeedf00d
.dd 0x11223344
label_1:
pop ebp            ; now ebp holds the address of the first dataword
                   ; this works because the call pushes the **next**
                   ; instructions address
                   ; real code follows
mov eax, [ebp + 4] ; for example i'm accessing the '0xfeedf00d' in a PIC way 
```

这种技术和其他技术为数据访问增加了一层间接性。例如，gcc 编译器使用的 GOT（全局偏移表）。

x86-64 添加了“RIP 相对”模式，这让事情变得简单**多**了。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-02T08:57:09.610

因为实现完全与位置无关的代码会向代码生成器添加一个约束，这可能会阻止使用更快的操作，或者添加额外的步骤来保留该约束。

这可能是在没有虚拟内存系统的情况下获得多处理的一个可接受的折衷方案，您相信进程不会侵入彼此的内存，并且可能需要在任何基址加载特定应用程序。

在许多现代系统中，性能权衡是不同的，并且重定位加载器通常比优化器可以自由支配的最佳性能便宜（它在第一次加载代码时花费任何时间）。此外，虚拟地址空间的可用性首先隐藏了位置独立性的大部分动机。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-12-08T03:34:16.500

`position-independent code`在大多数架构上都有性能开销，因为它需要一个额外的寄存器。

因此，这是出于性能目的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-02T02:20:15.587

此外，大多数现代处理器（大多数现代操作系统使用）中的虚拟内存硬件意味着大量代码（所有用户空间应用程序，除非对 mmap 等的古怪使用）不需要与位置无关。每个程序都有自己的地址空间，它认为从零开始。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-10-11T01:30:14.050

Nowadays operating system and compiler by default make all the code as position independent code. Try compiling without the -fPIC flag, the code will compile fine but you will just get a warning.OS's like windows use a technique called as memory mapping to achieve this.

# php - PHP：带有链接表的 MYSQL COUNT 查询

> ID：813994
> 
> 赞同：1
> 
> 时间：2009-05-02T02:15:21.060
> 
> 标签：php, mysql

我正在寻找一种更清洁的方法来做到这一点。我的代码有效，但我知道它可以更好。我有三个表：一个包含类别组列表，一个包含链接到类别组的类别列表，以及一个包含链接到类别的新闻故事列表。

我需要遍历类别组的所有名称，然后是类别组中的类别名称，以及每个类别中的新闻报道数量。

我有三个表：CategoryGroups、Categories、News。

我有一组查询。第一个查询 CategoryGroups 表中的所有行：

```
$result = mysql_query( '
SELECT cat_group_id, cat_group_name FROM CategoryGroups 
' ); 
```

第二个查询位于第一个查询的循环结果中，并查找具有新闻项并链接到特定类别组的所有类别：

```
<?php
while( $row = mysql_fetch_assoc( $result ) ){
    $id = $row['cat_group_id'];     
    $name = $row['cat_group_name'];

echo "<h3>$name</h3>";

    $sql =  mysql_query("
            SELECT  category_id, title FROM `Categories`  
            WHERE cat_group_id = $id 
            AND category_id IN 
            (SELECT news.category_id FROM news)
            "); 
    while( $row = mysql_fetch_assoc($sql) ) {
    $title = $row['title'];
    $catid = $row['category_id'];
    $numbers =  mysql_query("
                SELECT * FROM news 
                WHERE category_id =$catid"
                );
    $nums = mysql_num_rows($numbers);
    echo "$title ($nums)<br/>\n";
}
?> 
```

考虑到效率，我想将其限制为一两个查询。我知道这是可以做到的，但是我的尝试并没有成功。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-02T02:24:22.893

为什么不加入表格？

```
SELECT cat_group_name, title, count(newsid)
FROM CatagoryGroups
INNER JOIN Categories ON cat_group_id
INNER JOIN News ON category_id
GROUP BY cat_group_name, title 
```

看起来应该很接近，如果表 news 有一个 newsid 列（它必须有一些主键，对吧？好吧，算一算；-)。有了明显的索引，JOIN 应该非常快，并且您的 PHP 代码可以执行您可能需要的任何输出格式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-02T02:25:53.717

我建议你需要一本关于 SQL 的书，比如《[SQL Queries for Mere Mortals](https://rads.stackoverflow.com/amzn/click/com/0201433362)》。

```
$sql = mysql_query("
        SELECT  cg.cat_group_name, c.title, COUNT(n.category_id) AS NumNews
        FROM `CategoryGroups` cg 
        JOIN `Categories` c USING (cat_group_id)
        JOIN `News` n USING (category_id)
        GROUP BY cg.cat_group_name, c.title"); 
```

然后循环结果并在`<h3>`每次`cat_group_name`与前一行不同时输出一个新的。*******