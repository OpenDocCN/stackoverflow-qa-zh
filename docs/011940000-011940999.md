# StackOverflow 问答 11940000-11940999

# ruby-on-rails-3 - Rails 3：如何从复选框中获取输入

> ID：11940000
> 
> 赞同：0
> 
> 时间：2012-08-13T18:17:37.070
> 
> 标签：ruby-on-rails-3, checkbox

我对 ruby​​ on rails 很陌生……我的问题是从复选框中获取输出。如果复选框是`false`，我想显示每场音乐会，但我总是得到 else 条件......如何获得`@concerts = Concert.find(:all, :order => "day")`标准输出，如果 check_box 被选中，得到 else 条件？

```
#index.html.erb
check_box('dm', false, options = {}, checked_value = "1", unchecked_value = "0")

# controller.rb
def index
  if params[:dm] == '0'
    @concerts = Concert.find(:all, :order => "day")
  else
    @concerts = Concert.find(:all, :order => "day", :conditions => {:bool => false})
end 
```

# 开发日志

在 2012-08-14 13:21:39 +0200 开始 GET "/" for 127.0.0.1 由 ConcertsController#index 处理为 HTML [1m[36mConcert Load (0.0ms)[0m [1mSELECT `concerts`.* FROM `concerts`WHERE `concerts`. `bool`= 0 ORDER BY day[0m [1m[35mConcert Load (15.6ms)[0m SELECT `concerts`.* FROM `concerts`ORDER BY lineup [1m[36mConcert Load (0.0ms)[0m [1mSELECT DISTINCT day FROM `concerts`ORDER BY day[0m [1m[35mConcert加载 (0.0ms)[0m SELECT DISTINCT club_id FROM `concerts` ... 在布局/应用程序中渲染的 Concerts/index.html.erb (78.0ms) 在 94ms 内完成 200 OK (查看次数: 78.0ms | ActiveRecord: 15.6ms)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T18:35:57.150

尝试这个

```
def index
  if params[:dm] == '0'
    @concerts = Concert.find(:all, :order => "day")
  else
    @concerts = Concert.find(:all, :order => "day", :conditions => {:bool => false})
end 
```

控制器接收的复选框值是字符串形式的 0 或 1。此外，它应该是`params[:dm]`.

# android - Android 应用程序在命令行上使用 Ant 而不是 TeamCity CI 服务器构建

> ID：11940001
> 
> 赞同：0
> 
> 时间：2012-08-13T18:17:39.940
> 
> 标签：android, ant, teamcity

因此，我们的 Android 应用程序从命令行本地构建没有问题，但将其检入 SVN 并将 Team City 指向它，我收到以下错误：

```
[10:47:29][apkbuilder] com.android.sdklib.build.ApkCreationException: 
java.io.FileNotFoundException: 
C:\TeamCity\buildAgent\work\e7d847312af872ea\bin\classes.dex does not exist
[10:47:29][package-helper] The following error occurred while executing this line:
C:\Program Files (x86)\Android\android-sdk\tools\ant\build.xml:295:
com.android.sdklib.build.ApkCreationException: java.io.FileNotFoundException:
C:\TeamCity\buildAgent\work\e7d847312af872ea\bin\classes.dex does not exist
[10:47:29][do-only-if-not-library] 
The following error occurred while executing this line:
C:\Program Files (x86)\Android\android-sdk\tools\ant\build.xml:930: The following error 
occurred while executing this line:
C:\Program Files (x86)\Android\android-sdk\tools\ant\build.xml:295:    
com.android.sdklib.build.ApkCreationException: java.io.FileNotFoundException:    
C:\TeamCity\buildAgent\work\e7d847312af872ea\bin\classes.dex does not exist 
```

这对我来说是新的，但我的理解是 .dex 文件包含所有类。为什么它不在 bin 文件夹中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T18:11:03.567

有点愚蠢，我必须在构建日志中展开树以显示 javac 步骤无法运行，因为运行 TC Build Agent 进程的用户对 JDK 目录没有文件权限。

# hadoop - Hadoop 性能基准

> ID：11940002
> 
> 赞同：0
> 
> 时间：2012-08-13T18:17:40.943
> 
> 标签：hadoop, hdfs

我想知道收集与某个 Hadoop 集群配置有关的数据的“标准”方法是什么，这意味着，获得关于某个集群配置运行速度有多快的具体证据，例如吞吐量、带宽以及**我应该考虑的其他任何内容**。我目前正在查看并试图了解 TestDFSIO，但我不禁认为这并没有完全分析 Hadoop 性能（我在某处读到它不考虑某些开销）。

如果有帮助，我当前的 hadoop 集群设置是 2 台服务器，上面有 KVM，一台有 2 个 VM，另一个有 1 个 VM。我想将此配置的性能与更简单的 hadoop 配置（不带 KVM 或 VM）进行比较。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T19:48:34.157

还有其他基准，特别是 TeraSort，它将衡量您的集群改组性能，但我不会说它们提供的信息量太大。恕我直言，分析 hadoop 集群有点像分析 JVM - 如果没有具体的应用程序就没有多大意义。
. 我想说的是，应该根据您要在其上运行的某些 MR 作业来评估 hadoop 集群的性能。一些作业将受 IO 限制，其余的系统性能将不相关。有些会在 Map Stage 中受 CPU 限制，其余的并不重要，等等。

# objective-c - 如何知道哪个 UIView 或 UIViewController 接收到 UITouch 事件或手势？

> ID：11940003
> 
> 赞同：0
> 
> 时间：2012-08-13T18:17:40.347
> 
> 标签：objective-c, cocoa-touch

出于调试目的，有没有办法知道哪个视图接收/处理 UITouch 或手势？我正在寻找一种通用方法，而不必将 NSLog 放入所有 UIView 或 UIViewController 类中。

我想要一种全局通用的方法来通过输出其视图标签来找出哪个视图接收到触摸或手势。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T18:26:04.747

实际上，它是具有焦点的视图。从那里按钮将调用一个函数，该函数基于触摸事件发生时连接到的 IBOutlet 触发（假设您使用的是 Interface Builder）。任何 IBAction 都将接受“发送者”，并且此发送者对象将允许您确定实际导致事件触发的控件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T18:45:04.500

您可以覆盖 UIWindow 的`sendEvent:`.

# javascript - websocket服务器，存储数据

> ID：11940004
> 
> 赞同：4
> 
> 时间：2012-08-13T18:17:41.890
> 
> 标签：javascript, html, node.js, websocket, socket.io

假设我做了一个 websocket 服务器聊天（node.js + socket.io）。我将如何存储聊天消息，以便当“新”用户加入聊天时，他将看到旧的聊天消息，而不仅仅是在聊天时发送的消息。

数据是否应该存储在服务器的变量中？就像是：

```
var io = require('socket.io').listen(80);

var saveData = { };

io.sockets.on('connection', function (socket) {
  socket.emit('news', { hello: 'world' });
  socket.on('my other event', function (data) {
    console.log(data);
  });
}); 
```

对于更复杂的应用程序（例如游戏）来说，这是否是一个可行的解决方案？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T19:47:19.257

看看 redis ( [redis.io](http://redis.io) )，一个内存数据库（磁盘持久化）。非常快，并且您的数据将在服务器重新启动后保留。它也与 node.js 配合得非常好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-13T18:28:56.357

如果你真的需要为新用户存储聊天记录，我建议将它们存储在 RDBMS 或 NoSQL 存储中。如果您选择 NoSQL，则其中一个选项是[Apache CouchDB™</a>（使用 JSON 作为文档的数据库，使用 JavaScript 进行 MapReduce 查询，使用常规 HTTP 作为 API）。这是关于它的免费在线](http://couchdb.apache.org/)[书籍](http://guide.couchdb.org/)。

# asp-classic - VS 2012 会支持经典的 asp 吗？

> ID：11940006
> 
> 赞同：1
> 
> 时间：2012-08-13T18:17:45.327
> 
> 标签：asp-classic, visual-studio-2012

我有一个经典的 asp 应用程序，我一直在使用 Visual Studio 2010 开发它，它是迄今为止最好的 Visual Studio 版本。Visual Studio 2012 会继续支持经典 asp 吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-14T13:25:17.013

我正在使用 Visual Studio 2012 RC 进行 ASP Classic 开发，它仍然受支持。

# ios - 如何仅在几个部分以编程方式更改 UIImage 的色调？

> ID：11940008
> 
> 赞同：1
> 
> 时间：2012-08-13T18:17:50.873
> 
> 标签：ios, iphone, ipad, colors

如何仅在几个部分以编程方式更改 UIImage 的色调？我已经关注了这个链接

[如何以编程方式更改 UIImage 的色调？](https://stackoverflow.com/questions/11555071/how-to-programmatically-change-the-hue-of-uiimage)

![在此处输入图像描述](../Images/e44897a5d975ea4d852f1c23de49f147.png)

并在我的应用程序中使用了相同的代码。它工作正常，但完整的图像色调正在改变。根据我的要求，我只想更改上面快照中的树颜色。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T18:23:08.393

这是使用掩蔽的更一般问题的特定情况。我假设您有某种方法可以知道“树”部分中有哪些像素，哪些不是。（如果不是，那是另一个问题/问题）。

如果是这样，首先将原件绘制到结果上下文中，然后创建一个遮罩（参见此处：http: [//mobiledevelopertips.com/cocoa/how-to-mask-an-image.html](http://mobiledevelopertips.com/cocoa/how-to-mask-an-image.html)），并绘制更改后的色调版本带有表示树的掩码处于活动状态。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T20:06:41.550

我建议您特别查看 CoreImage API 和 CIColorCube 或 CIColorMap 过滤器。现在如何定义颜色立方体或颜色贴图才是真正的魔力所在。你需要改变树的色调（棕色等），尽管这显然会改变所有的棕色，而不仅仅是你的树。

# opengl - 减小缓冲区对象大小

> ID：11940017
> 
> 赞同：0
> 
> 时间：2012-08-13T18:18:33.843
> 
> 标签：opengl, opengl-3

我现在拥有的

```
#define QUAD_VERT_COUNT 4

#define QUAD_POS_COMP 3

typedef struct quad_pos
{
 GLfloat x, y, z;
}quad_pos;

#define SIZE_QUAD_POS = sizeof(quad_pos) * QUAD_VERT_COUNT

static QUAD_BUFFER = 0;

void init_quad_buffer()
{
 quad_pos* pos_data = malloc(SIZE_QUAD_POS);

 pos_data[0].x = -1.0f;
 pos_data[0].y = -1.0f;
 pos_data[0].z = 0.0f;

 pos_data[1].x = 1.0f;
 pos_data[1].y = -1.0f;
 pos_data[1].z = 0.0f;

 pos_data[2].x = -1.0f;
 pos_data[2].y = 1.0f;
 pos_data[2].z = 0.0f;

 pos_data[3].x = 1.0f;
 pos_data[3].y = 1.0f;
 pos_data[3].z = 0.0f;

 QUAD_BUFFER = create_buffer(GL_ARRAY_BUFFER, GL_STATIC_DRAW, pos_data, SIZE_QUAD_POS);
 free(pos_data);
}

void get_quad_buffer
{
  return QUAD_BUFFER;
} 
```

和绘图（部分）

```
glBindBuffer(GL_ARRAY_BUFFER, get_quad_buffer());
glEnableVertexAttribArray(ss->attrib[0]);//attrib[o] is vertex pos
glVertexAttribPointer(ss->attrib[0], QUAD_POS_COMP, GL_FLOAT, GL_FALSE, 0, 0);
glDrawArrays(GL_TRIANGLE_STRIP, 0, QUAD_VERT_COUNT); 
```

使用矩阵和着色器实现缩放、平移和旋转，所以是的，这个缓冲区永远不会因每个精灵而改变。

但是为什么我们只需要为 -1.0、1.0 使用 GL_float 呢？GL_Byte 就足够了。

```
 typedef struct quad_pos
 {
 GLbyte x, y, z;
 }quad_pos;

void init_quad_buffer()
{
 quad_pos* pos_data = malloc(SIZE_QUAD_POS);

 pos_data[0].x = -1;
 pos_data[0].y = -1;
 pos_data[0].z = 0;
 ....
} 
```

绘图

```
 ...
  glVertexAttribPointer(ss->attrib[0], QUAD_POS_COMP, GL_BYTE, GL_FALSE, 0, 0);
  glDrawArrays(GL_TRIANGLE_STRIP, 0, QUAD_VERT_COUNT); 
```

**问题 1：**我需要将 normalize 设置为 GL_TRUE 吗？
**问题 2：** GLclampf 和 GLfloat 都是 4 字节浮点数，但是颜色值是从 0.0 到 1.0，所以如果我也将它们放入 GLbyte（val/256，所以 1.0 为 255，0.5 为 128，0 为 0）我需要 GL_TRUE在 glVertexAttribPointer 中标准化？
**问题 3：**我真的需要在顶点数据/其他数据中进行填充吗？添加虚构的 pos_data.g，只是为了 sizeof(pos_data) = 16 == 对 gpu 好？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T23:25:29.600

通常，您始终可以使用半浮点（16 位浮点）扩展来节省内存。

您的实现看起来会导致一些绘制调用开销。规范化（即时！）将导致额外的开销。为了绘制这个常量四边形的多个实例，我建议使用以下方法来加快速度：

*   **几何着色器**的实现；让它为你生成、变换和发射四边形的 4 个顶点。
*   ****使用包含每个四边形实例的变换矩阵的纹理缓冲区对象**(TBO)使用变换缓冲区进行**实例化绘图**（将使用内置的统一“gl_InstanceID”访问每个矩阵列）。
    或：
    通过**顶点属性数组**提供矩阵（可能更快）。这两种方法可以在相同的缓冲区数据布局上实现（只是一个矩阵数组）**

 *** * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T22:02:05.507

> 但是为什么我们只需要为 -1.0、1.0 使用 GL_float 呢？GL_Byte 就足够了。

请注意，这通常不是真的，在大多数情况下，您需要一个浮点数来精确。如果你只有这么少的值和这么简单的几何图形，那么可能性非常高，甚至根本没有理由首先对其进行优化`glByte`。您可能根本没有顶点，那么为什么要在它们上节省存储空间呢？这听起来像是过早优化的一个很好的例子（我知道，这是一个过度使用的术语）。

现在，对于您的实际问题：

1.  不，如果您想要相同的功能，则不是，如果 normalize 为假，`-1`则将转换为`-1.0f`，如果为真，它将更像`-0.0078125f`（或`-1/128.0f`）。所以如果你想保持相同的比例，你不希望它标准化。
2.  您从哪里得到 GLclampf 和 GLfloat 是 8 字节浮点数的想法？它们通常是 4 字节浮点数。如果您想通过顶点属性传递 RGB 颜色，是的，您应该将它们归一化，因为 OpenGL 期望颜色分量在 range 范围内`[0.0f,1.0f]`。但是再说一遍：为什么不简单地将它们作为浮点数传递呢？你觉得有什么收获？在简单的游戏中，您可能没有足够的颜色来注意到差异，而在非简单的游戏中，您更有可能使用纹理。
3.  对此我不确定。我知道旧 GPU 确实如此（我的意思是差不多 10 年前），但我不知道最近有任何声称这实际上会改善某些东西。在任何情况下，最著名的对齐方式是将一个顶点的所有顶点属性一起支撑为 32 字节（的倍数），这适用于 ATI 卡。对于一些更棘手的事情/扩展，字节对齐可能是必要的，但我认为你现在不需要担心它。**

# android - 我的定位服务不工作

> ID：11940021
> 
> 赞同：0
> 
> 时间：2012-08-13T18:18:39.820
> 
> 标签：android, service, gps, location

我的应用程序的工作原理如下：

*   我对每个活动都有一个位置监听器
*   我的位置监听器（包含位置监听器）在位置发生变化时发送广播
*   所有活动都有广播接收器，允许他们在地图上设置位置

它必须像那样工作，但即使我的服务也没有启动。我写这个应用程序已经筋疲力尽了，所以我把我的代码放在这里，也许我忽略了一些简单的问题。我需要有关该主题的帮助：

全球定位系统服务：

```
// package and imports

public class GeoService extends Service {
    LocationListener GPSLocationListener, NetworkLocationListener;
    LocationManager locationManager;
    private IBinder mBinder;

    @Override
    public void onCreate() {
        locationManager = (LocationManager) getSystemService(Context.LOCATION_SERVICE);
    }

    @Override
    public int onStartCommand(Intent intent, int flags, int startId) {
        getPosition();
        return Service.START_REDELIVER_INTENT;
    }

    @Override
    public IBinder onBind(Intent intent) {
        getPosition();
        if (mBinder == null) mBinder = new GeoBinder();
        return mBinder;
    }

    private void getPosition() {
        GPSLocationListener = new LocationListener() {

            public void onLocationChanged(Location location) {
                sendPosition(location);
            }

            public void onProviderDisabled(String provider) {
                Toast.makeText(getApplicationContext(), provider + " is now disabled. Turn it on to find better GPS position.", Toast.LENGTH_SHORT).show();
            }

            public void onProviderEnabled(String provider) {
                Toast.makeText(getApplicationContext(), provider.toUpperCase() + " is now enabled. Waiting for better position..", Toast.LENGTH_SHORT).show();
            }

            public void onStatusChanged(String provider, int status, Bundle extras) {
                switch (status) {
                    case 0:
                    case 1:
                        locationManager.requestLocationUpdates(LocationManager.NETWORK_PROVIDER, 0, 0, NetworkLocationListener);
                        break;
                    case 2:
                        locationManager.removeUpdates(NetworkLocationListener);
                        break;
                }
            }
        };

        NetworkLocationListener = new LocationListener() {
            public void onLocationChanged(Location location) {
                sendPosition(location);
            }

            public void onProviderDisabled(String provider) {}

            public void onProviderEnabled(String provider) {}

            public void onStatusChanged(String provider, int status, Bundle extras) {}

        };

        locationManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 0, 0, GPSLocationListener);
        locationManager.requestLocationUpdates(LocationManager.NETWORK_PROVIDER, 0, 0, NetworkLocationListener);

        if (!locationManager.isProviderEnabled(LocationManager.GPS_PROVIDER) && !locationManager.isProviderEnabled(LocationManager.NETWORK_PROVIDER)) alert();
    }

    private void alert() {
        AlertDialog.Builder builder = new AlertDialog.Builder(getApplicationContext());
        builder.setMessage("Internet connection and GPS are not avaiable!.").setCancelable(false).setTitle("No location provider!").setIcon(android.R.drawable.ic_dialog_alert).setPositiveButton("Change settings", new DialogInterface.OnClickListener() {

            public void onClick(DialogInterface dialog, int which) {
                dialog.dismiss();
                startActivity(new Intent(getApplicationContext(), SettingsActivity.class));
            }
        }).create().show();
    }

    void sendPosition(Location location) {
        Intent gpsPosition = new Intent();
        gpsPosition.putExtra("location", location);
        gpsPosition.setAction(Context.LOCATION_SERVICE);
        sendBroadcast(gpsPosition);
    }

    public GeoPoint getGeoPoint(final Location loc) {
        int lat = (int) (loc.getLatitude() * 1e6);
        int lon = (int) (loc.getLongitude() * 1e6);
        return new GeoPoint(lat, lon);
    }

    public GeoPoint getLastLocation() {
        GeoPoint lastKnownPoint;

        Location lastKnownLocation = locationManager.getLastKnownLocation(LocationManager.GPS_PROVIDER);
        if (lastKnownLocation == null) lastKnownLocation = locationManager.getLastKnownLocation(LocationManager.NETWORK_PROVIDER);

        if (lastKnownLocation != null) lastKnownPoint = getGeoPoint(lastKnownLocation);
        else lastKnownPoint = new GeoPoint((int) (51.110582 * 1E6), (int) (17.031509 * 1E6));
        return lastKnownPoint;
    }

    @Override
    public void onDestroy() {
        locationManager.removeUpdates(GPSLocationListener);
        locationManager.removeUpdates(NetworkLocationListener);
    }

    public class GeoBinder extends Binder {
        public GeoService getService() {
            return GeoService.this;
        }
    }
} 
```

活动之一：（我尝试启动或绑定服务，但似乎没有任何方法有效）。

```
// package and imports

public class ShareLocationActivity extends MapActivity {
    private final int PICK_CONTACT = 123;

    MapView.LayoutParams mapMarkerParams;
    MapController mapController;
    Location lastLocation;
    ImageView mapMarker;
    GeoPoint current;
    MapView map;

    private ServiceConnection mConnection;
    GeoService mService;
    boolean mBound = false;

    BroadcastReceiver locationReceiver = new BroadcastReceiver() {
        @Override
        public void onReceive(Context context, Intent intent) {
            setPosition((Location) intent.getParcelableExtra("location"));
        }
    };

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_share_location);

        mConnection = new ServiceConnection() {
            public void onServiceConnected(ComponentName name, IBinder service) {
                GeoBinder binder = (GeoBinder) service;
                mService = binder.getService();
                mBound = true;

                mapController = map.getController();
                mapController.setCenter(mService.getLastLocation());
                mapController.setZoom(17);
            }

            public void onServiceDisconnected(ComponentName name) {
                mBound = false;
            }
        };

        Intent intent = new Intent(this, GeoService.class);
        startService(intent);
        bindService(intent, mConnection, Context.BIND_AUTO_CREATE);

        map = (MapView) findViewById(R.id.shareMapView);
        map.setBuiltInZoomControls(true);
        map.setSaveEnabled(true);

        mapMarker = new ImageView(getApplicationContext());
        mapMarker.setImageResource(android.R.drawable.presence_online);

        Button share = (Button) findViewById(R.id.shareActivityButton);
        share.setOnClickListener(new OnClickListener() {
            public void onClick(View v) {
                Intent contacts_intent = new Intent(Intent.ACTION_PICK, ContactsContract.Contacts.CONTENT_URI);
                startActivityForResult(contacts_intent, PICK_CONTACT);
            }
        });

        IntentFilter filter = new IntentFilter();
        filter.addAction(Context.ACTIVITY_SERVICE);
        registerReceiver(locationReceiver, filter);
    }

    @Override
    public void onActivityResult(int reqCode, int resultCode, Intent data) {
        super.onActivityResult(reqCode, resultCode, data);

        switch (reqCode) {
            case (PICK_CONTACT):
                if (resultCode == Activity.RESULT_OK) {
                    if (current != null) sendSms(data);
                    else Toast.makeText(getApplicationContext(), "No GPS data yet..", Toast.LENGTH_SHORT).show();
                }
                break;
        }
    }

    @Override
    protected void onResume() {
        super.onResume();
        if (!mBound) {
            Intent intent = new Intent(this, GeoService.class);
            bindService(intent, mConnection, Context.BIND_AUTO_CREATE);
        }
    };

    @Override
    protected void onPause() {
        map.removeAllViews();
        if (mBound) {
            unbindService(mConnection);
            mBound = false;
        }
        super.onPause();
    }

    @Override
    protected void onDestroy() {
        super.onDestroy();
        map.removeAllViews();
    }

    void setPosition(Location location) {

        map.removeAllViews();

        current = mService.getGeoPoint(location);
        mapMarkerParams = new MapView.LayoutParams(android.view.ViewGroup.LayoutParams.WRAP_CONTENT, android.view.ViewGroup.LayoutParams.WRAP_CONTENT, current, MapView.LayoutParams.TOP_LEFT);
        map.addView(mapMarker, mapMarkerParams);
        mapController.setCenter(current);
    }

    @Override
    protected boolean isRouteDisplayed() {
        return false;
    }
} 
```

并且可以肯定清单：

```
 <?xml version="1.0" encoding="utf-8"?>
    <manifest xmlns:android="http://schemas.android.com/apk/res/android"
        package="gps.counter"
        android:versionCode="1"
        android:versionName="1.0" >

        <uses-feature android:name="android.hardware.location" />
        <uses-feature android:name="android.hardware.location.gps" />

        <uses-sdk
            android:minSdkVersion="10"
            android:targetSdkVersion="15" />

        <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
        <uses-permission android:name="android.permission.CHANGE_NETWORK_STATE" />
        <uses-permission android:name="android.permission.ACCESS_WIFI_STATE" />
        <uses-permission android:name="android.permission.CHANGE_WIFI_STATE" />
        <uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />
        <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />
        <uses-permission android:name="android.permission.ACCESS_MOCK_LOCATION" />
        <uses-permission android:name="android.permission.ACCESS_LOCATION_EXTRA_COMMANDS" />
        <uses-permission android:name="android.permission.CONTROL_LOCATION_UPDATES" />
        <uses-permission android:name="android.permission.INTERNET" />
        <uses-permission android:name="android.permission.READ_CONTACTS" />
        <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
        <uses-permission android:name="android.permission.WRITE_SETTINGS" />
        <uses-permission android:name="android.permission.WRITE_SECURE_SETTINGS" />

        <application
            android:icon="@drawable/ico"
            android:label="@string/app_name"
            android:theme="@android:style/Theme.NoTitleBar" >
            <uses-library android:name="com.google.android.maps" />

            <activity android:name=".MainActivity" >
                <intent-filter>
                    <action android:name="android.intent.action.MAIN" />

                    <category android:name="android.intent.category.LAUNCHER" />
                </intent-filter>
            </activity>
            <activity android:name=".SaveLocationActivity" />
            <activity android:name=".ShareLocationActivity" />
            <activity android:name=".RecordTrackActivity" />
            <activity android:name=".SettingsActivity" />

            <service
                android:name=".GeoService"
                android:enabled="true" />
        </application>

    </manifest> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T10:23:33.107

解决方案是将使用它的服务和活动保留在一个包中。这是小问题，但对某人来说可能是大问题。

# c# - 从 C# 构建命令行

> ID：11940023
> 
> 赞同：0
> 
> 时间：2012-08-13T18:18:42.143
> 
> 标签：c#

我想制作一个 C# 应用程序，使用 cmd.exe 自动构建 .cs 文件。我了解到像“%windir%\Microsoft.NET\FrameWork\v3.5\csc.exe /target:exe +.cs file's location”这样的行会构建文件，当然手动也可以正常工作。我还没有设法从 C# 代码中构建任何代码。

有人可以帮忙解决这个问题吗？还是有另一种方法可以做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T19:54:16.803

总有`Proces.Start(Environment.ExpandEnvironmentVariables(String.Format(@"%windir%\Microsoft.NET\FrameWork\v3.5\csc.exe /target:exe {0}", filepath)));`

# mysql - mysqldump 返回未知变量 sql 模式错误

> ID：11940027
> 
> 赞同：4
> 
> 时间：2012-08-13T18:18:47.333
> 
> 标签：mysql, mysqldump

当我像这样运行 mysqldump 时出现此错误：

```
$ mysqldump -u my_user -pXXX -h 127.0.0.1 --databases my_db > db_backup.sql
mysqldump: unknown variable 'sql-mode=STRICT_ALL_TABLES' 
```

有谁知道会发生什么？

当我尝试启动 MySQL 客户端时，我也得到了同样的结果。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-13T18:31:22.103

原来我的 my.cnf 文件的客户端设置部分中有“sql-mode=STRICT_ALL_TABLES”。我把它移到服务器部分，看起来一切都很好。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-13T18:23:14.203

这是您的 .my.conf 文件中的错误行，或者可能是您的系统 .ini 文件之一。

# qt - 如何退出 qt 控制台应用程序？QApplication::quit() 插槽是否有工作标准？

> ID：11940028
> 
> 赞同：1
> 
> 时间：2012-08-13T18:18:54.813
> 
> 标签：qt, console-application, quit

我有一个奇怪的 qt 问题：我的应用程序在某些配置中没有退出。

这个想法是有一个程序，它可以作为带有 GUI 的程序（通过`myWindow`）或作为纯控制台应用程序（通过控制`myConsole`，它在其线程中运行自己的循环以记录键盘输入）启动。无论哪种方式退出都是通过调用`myObject`slot来完成的`quitMyObject`，它反过来清理一些对象并发出`signalQuitapplication`连接到`QApplication`( `app`)`quit`槽的信号。

不幸的是，应用程序仅在启用窗口并在控制台中输入退出命令时退出（尽管 总是调用`slotQuitMyObject` of ）。`myObject`所以我想知道 Qt 有什么标准才能真正退出主事件循环并退出程序。

代码如下所示：

```
int main(int argc, char *argv[])

{

    bool enableWindow = false;
    QApplication app(argc, argv, enableWindow);
    MyUiAbstract* myConsole = new ConsoleUi(); // ConsoleUi inherits from MyUiAbstract, which inherits from QThread
    MyWindow* myWindow = NULL; // MyWindow inherits from QMainWindow
    if(enableWindow)
    {
        myWindow = new MyWindow();
        myWindow->show();
    }

     MyObject* myObject = new MyObject(myConsole, myWindow, ...); 

     QObject::connect(myObject, SIGNAL(signalQuitQApplication()), &app, SLOT(quit()), Qt::QueuedConnection);

     QObject::connect(myConsole, SIGNAL(signalQuitMyObject()), myObject, SLOT(slotQuitMyObject()), Qt::QueuedConnection);
     QObject::connect(myWindow, SIGNAL(signalQuitMyObject()), myObject, SLOT(slotQuitMyObject()), Qt::QueuedConnection);
     QObject::connect(myWindow, SIGNAL(signalQuitConsoleUI()), myConsole, SLOT(slotQuitMyUi()), Qt::QueuedConnection);

     return app.exec();
} 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-08-13T18:47:54.393

尝试在您的 MyConsole 类中使用该代码：

```
#include <QApplication>
...
qApp->quit(); 
```

您还需要在退出之前关闭所有事件循环和线程。

# java - 将宏图转换为 gwt

> ID：11940033
> 
> 赞同：1
> 
> 时间：2012-08-13T18:19:41.873
> 
> 标签：java, excel, gwt, vba

我有一个 excel 宏，它获取日志信息并根据这些信息创建一个图。

我想知道是否有一种方法可以将此宏转换为 GWT。或者这埃文可能吗？

我知道这没什么好做的，但我只是想获得一些想法，看看是否可以做到。如果不能在 GWT 中完成，那么常规 java 呢？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T02:48:20.453

将您的数据传输到 Google 文档电子表格中。比用它来绘制图表。然后您可以使用 Google API 将图表调用到您的浏览器上。一旦您感到满意，您将围绕调用编写一个 div 包装器，以将手动创建的图表嵌入到 GWT 面板中。

我无法立即回忆起如何围绕 Google API（或生成的 jquery）图表编写 GWT 包装器。您可以谷歌/搜索 Blessed Geek Google Map GWT 包装器。

这就产生了疑问，之后，您可以编写一个例程以编程方式将数据插入电子表格。

但第二个问题是 - 你能以编程方式触发谷歌电子表格上的情节吗？我最后一次以编程方式处理谷歌电子表格是在两年前。一定有很多变化。否则，您应该从 google docs API 中提取数据作为绘图点并将其输入 Google Chart API。

我相信，Google API 正在从提供 GWT 库转向仅提供 javascript 库——因为简单的事实是您可以简单地围绕它们编写 GWT 包装器，这就是 javascript 图表库供应商正在做的事情。

OTOH，您可以使用以下 javascript 图表库之一：HighCharts、ZingChart 等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T19:37:49.370

是的，您可能可以在 GWT 中执行此操作。

# c# - 转换失败

> ID：11940034
> 
> 赞同：0
> 
> 时间：2012-08-13T18:19:41.707
> 
> 标签：c#, sql-server-2005

我目前有一个在 c# 中运行的更新语句和前端来编辑我的 sql server 数据库中的一些值。但我收到转换失败错误。我似乎无法找到来源。

错误信息

```
Conversion failed when converting the nvarchar value 'UPDATE T_ROLLUP_SYSTEM_EXCEPT
            SET DEPT_ID = ' to data type int.
14 
```

Sql

```
ALTER PROCEDURE [dbo].[USP_UPDATE_SYS_MAPPING]
-- Add the parameters for the stored procedure here
@SYSTEM VARCHAR(50),
@UNIT VARCHAR(50),
@MEDCTRLEVEL VARCHAR(50),
@MEDCTR VARCHAR(50),
@FACID VARCHAR(50),
@ENTN VARCHAR(50),
@DEPT_ID INT,
@ROLLUP_TYPE_ID INT
AS
BEGIN
-- SET NOCOUNT ON added to prevent extra result sets from
-- interfering with SELECT statements.
SET NOCOUNT ON;
DECLARE @SQL VARCHAR(MAX);
DECLARE @MEDCTRID INT;

SELECT @MEDCTRID = MED_CTR_ID FROM T_ROLLUP_MED_CTR WHERE MED_CTR = @MEDCTR
PRINT (@MEDCTRID);

-- Insert statements for procedure here
SET @SQL = N'UPDATE T_ROLLUP_SYSTEM_EXCEPT
            SET DEPT_ID = 
                '''+@DEPT_ID'''                 , ROLLUP_TYPE_ID = '''+@ROLLUP_TYPE_ID+'''
                , UPDATE_DT = GETDATE()
            WHERE SYSTEM = '''+@SYSTEM+'''
                AND ENTN = '''+@ENTN+'''
                AND MED_CTR_ID = '+CONVERT(VARCHAR,@MEDCTRID)+'
                AND MED_CTR_LEVEL = '''+@MEDCTRLEVEL+'''
                AND FAC_ID = '''+@FACID+'''
                AND UNIT = '''+@UNIT+''''
PRINT (@SQL);
EXEC (@SQL); 
```

HTML

```
 string[] mdctrvalue = medctr.Text.Split('[', ']');
            string[] mpvalue = mpSearch.Text.Split('(', ')');

            string sys = acctsys.ToString();
            string unit = txtunit.ToString();
            string mdctrlvl = mdctrvalue[1].ToString();
            string mdctr = mdctrvalue[0].ToString();
            string facid = fac.ToString();
            string entn = txtentn.ToString();
            string dept_id = dept.SelectedValue.ToString();
            string rollup_type_id = rolluptype.SelectedValue.ToString();

            SqlConnection myconn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["Rollup2ConnectionString"].ConnectionString);
            SqlCommand cmd = new SqlCommand();
            cmd.Connection = myconn;
            cmd.CommandType = CommandType.StoredProcedure;
            cmd.CommandText = "USP_UPDATE_SYS_MAPPING";
            cmd.Parameters.Add("@SYSTEM", SqlDbType.VarChar).Value = acctsys.ToString();
            cmd.Parameters.Add("@UNIT", SqlDbType.VarChar).Value = unit.ToString();
            cmd.Parameters.Add("@MEDCTRLEVEL", SqlDbType.VarChar).Value = mdctrlvl.ToString();
            cmd.Parameters.Add("@MEDCTR", SqlDbType.VarChar).Value = mdctr.ToString();
            cmd.Parameters.Add("@FACID", SqlDbType.VarChar).Value = facid.ToString();
            cmd.Parameters.Add("@ENTN", SqlDbType.VarChar).Value = entn.ToString();
            cmd.Parameters.Add("@DEPT_ID", SqlDbType.Int).Value = dept_id.ToString();
            cmd.Parameters.Add("@ROLLUP_TYPE_ID", SqlDbType.Int).Value = rollup_type_id.ToString();

            myconn.Open();
            int retVal = cmd.ExecuteNonQuery(); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-13T18:22:37.553

也许改变：

```
+@ROLLUP_TYPE_ID+ 
```

到：

```
+ CONVERT(VARCHAR(12), @ROLLUP_TYPE_ID) + 
```

您应该[始终为您的 varchar 列/变量指定一个长度](https://sqlblog.org/2009/10/09/bad-habits-to-kick-declaring-varchar-without-length)...

也就是说，您可以重新编写存储过程以完全不使用动态 SQL - 为什么要使用它？

```
ALTER PROCEDURE [dbo].[USP_UPDATE_SYS_MAPPING]
  @SYSTEM         VARCHAR(50),
  @UNIT           VARCHAR(50),
  @MEDCTRLEVEL    VARCHAR(50),
  @MEDCTR         VARCHAR(50),
  @FACID          VARCHAR(50),
  @ENTN           VARCHAR(50),
  @DEPT_ID        INT,
  @ROLLUP_TYPE_ID INT
AS
BEGIN
  SET NOCOUNT ON;

  DECLARE @MEDCTRID INT;

  SELECT @MEDCTRID = MED_CTR_ID FROM dbo.T_ROLLUP_MED_CTR 
    WHERE MED_CTR = @MEDCTR;

  PRINT (@MEDCTRID);

  UPDATE dbo.T_ROLLUP_SYSTEM_EXCEPT
    SET DEPT_ID = CASE 
      WHEN @DEPT_ID > 1 THEN @DEPT_ID 
      WHEN @DEPT_ID = 1 THEN NULL 
      ELSE REG_DEPT_ID1 END 
     , ROLLUP_TYPE_ID = @ROLLUP_TYPE_ID
     , UPDATE_DT = GETDATE()
    WHERE SYSTEM = @SYSTEM
    AND ENTN = @ENTN
    AND MED_CTR_ID = @MEDCTRID
    AND MED_CTR_LEVEL = @MEDCTRLEVEL
    AND FAC_ID = @FACID
    AND UNIT = @UNIT;
END
GO 
```

如果由于某种原因你还没有共享它需要动态 SQL，你最好还是使用参数化尽可能多的参数`sp_executesql`而不是`EXEC()`.

# python - 如何在表单中验证电子邮件地址的域？

> ID：11940038
> 
> 赞同：9
> 
> 时间：2012-08-13T18:19:53.933
> 
> 标签：python, django, django-forms, validation, django-validation

给定一个电子邮件地址（例如：goelv@example.com），我如何验证域（“example.com”）是否包含在给定的域列表中。如果域（“example.com”）不在指定的列表中，表单应该会引发某种错误。

到目前为止，这就是我在 forms.py 中所拥有的

```
class UserCreationFormExtended(UserCreationForm):
    email = forms.EmailField(required=True)

    class Meta:
        model = User
        fields = ("username", "email", "password1", "password2",)

    def clean_email(self):
        data = self.cleaned_data['email']
        domain = data.split('@')[1]
        domain_list = ["gmail.com", "yahoo.com", "hotmail.com",]
        if domain not in domain_list:
            raise forms.ValidationError["Please enter an Email Address with a valid domain"]
        return data

    def save(self, commit=True):
        user = super(UserCreationFormExtended, self).save(commit=False)
        user.email = self.cleaned_data["email"]
        if commit:
            user.save()
        return user 
```

使用此代码，我收到错误“'type' object has no attribute ' **getitem** '”，它可以追溯到我的代码中的“raise forms.ValidationError[...]”行。

谁能看到我做错了什么？谢谢您的帮助！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-13T18:22:41.083

您需要在您的行中使用`()`而不是，如下所示：`[]``raise`

```
raise forms.ValidationError("Please enter a valid Penn Email Address") 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-13T18:23:09.407

我觉得线...

```
raise forms.ValidationError["Please enter an Email Address with a valid domain"] 
```

应该

```
raise forms.ValidationError("Please enter an Email Address with a valid domain") 
```

# ruby - 如何使用 basecamp API 返回与公司关联的所有电子邮件地址的列表

> ID：11940039
> 
> 赞同：0
> 
> 时间：2012-08-13T18:19:54.090
> 
> 标签：ruby, activeresource, basecamp

我已经设法让它几乎可以工作，但我认为我遇到了一些严重的困惑。所有示例似乎都涵盖了根据 id 查找单个记录。

我以为我可以传递一个参数来过滤单个属性

[https://xxxx.basecamphq.com/companies.xml?name=xxxx](https://xxxx.basecamphq.com/companies.xml?name=xxxx)

Basecamp::Company.find(:all, :params => { :name => xxx })

```
require 'rubygems'
require 'English'
require 'trollop'
require 'basecamp'
require 'ap'

opts = Trollop::options do
    version "1.0"
    banner <<-EOS
    #{File.basename($0)}
    Description: Dump the users from a company stored in basecampe via the api.

    Usage:
           #{File.basename($0)} [options]
    where [options] are:
    EOS
    opt :company , "Company to export" , :default => "XXXX"
    opt :token_file, "File to read token from " , :default => "~/.basecamp/token"
end

basecamp_token = IO.read(File.expand_path(opts[:token_file])).chomp

Basecamp.establish_connection!('xxxx.basecamphq.com', basecamp_token , 'X' , true)

#Work out company id from company name
company = Basecamp::Company.find(:all).select { |c| c.attributes["name"] == opts[:company] }
company_id = company[0].instance_variable_get("@attributes")["id"]

people = Basecamp::Person.find(:all, :params => {:company_id => company_id })
#ap people

#todo work out how to iterate over all people
puts people[0].instance_variable_get("@attributes")["email_address"] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T10:13:47.703

结果：first 会根据我的需要返回一家公司，但是我不认为该方法合乎逻辑，因为我不想要第一个条目，我想要任何与我的参数匹配的条目..

```
#Work out company id from company name
company = Basecamp::Company.find(:first, :params => {:name => opts[:company] })
people = Basecamp::Person.find(:all, :params => {:company_id => company.id })

people.each do | person |
    puts person.email_address
end 
```

# rally - 使用 Rally Cardboard UI 显示前任/后继层次结构

> ID：11940040
> 
> 赞同：1
> 
> 时间：2012-08-13T18:19:55.353
> 
> 标签：rally

我目前正在尝试编写一个 Rally 应用程序，该应用程序将显示所选用户故事的前任/继任者层次结构。为了说明，用户将从选择器 UI 元素中选择一个用户故事。然后，将生成一个三列 Cardboard UI 元素——最左边的列将包含所有选定的用户故事的前身（以卡片形式），中间的列将包含选定的用户故事的卡片，最右边的列将包含所有所选用户故事的继任者（卡片形式）。从那里，可以删除前任和继任者卡（表示它们不会成为所选用户故事的前任或继任者），并且可以添加新的前任/继任者卡（表示它们将成为所选用户故事的新前任/继任者）用户故事）。

但是，我的问题是这样的：Cardboard UI 旨在为一个特定属性显示一组不同的值，但“前任”和“继任者”不属于这一类。我有没有一种可能的方法来显示用户故事，然后获取它的前任和继任者并填充董事会的其余部分？我意识到这将需要对原始电路板进行大量修改。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T21:13:37.173

我找到了破解它的方法，以便您可以进行显示。不确定它是否值得以及您想为添加/删除做什么，但这可能有助于您走上正确的道路。

总之，问题在于纸板/列类被设计为使用单值字段*，并且*创建的每一列都会根据列配置对 Rally 进行单独的查询。您需要覆盖 rallycardboard 和 rallycolumn。我会给出完整的 html，你可以在下面粘贴，但让我们一次打一个。

如果不出意外，这可能是一个很好的例子，说明如何获取集会类的源代码并制作一些东西来覆盖它们。

**数据：**

现有的纸板被赋予一个记录类型和字段，并为该字段的每个有效值创建一个列。它通过向 Rally 查询故事和属性定义来获取此信息。但是我们想以稍微不同的方式使用我们的数据，所以我们必须创建一个不同的数据存储并将其输入。所以我们想使用 wsapidatastore 继续获取我们要求的记录（在这个例子中，我有个故事叫US37，有前有后继）。在某种程度上，这就像在 Excel 中做一个交叉表。我们希望创建一个包含所有故事的数据集，并在我称之为“_column”的新字段中定义它们的关系，而不是拥有一条与其他记录相关的记录 (37)。像这样：

```
Ext.create('Rally.data.WsapiDataStore', {
            model: "hierarchicalrequirement",
            autoLoad: true,
            fetch: ['Name','Predecessors','Successors','FormattedID','ObjectID','_ref'],
            filters: [ {
                property: 'FormattedID', operator: 'contains', value: '37'
            } ] /* get the record US37 */,
            listeners: { 
                load: function(store,data,success) {
                    if ( data.length === 1 ) {
                        var base_story = data[0].data;
                        var modified_records = [];

                        base_story._column = "base";
                        modified_records.push( base_story );

                        Ext.Array.each( base_story.Predecessors, function( story ) {
                            story._column = "predecessor";
                            modified_records.push( story );
                        } );

                        Ext.Array.each( base_story.Successors, function(story) {
                            story._column = "successor";
                            modified_records.push( story );
                        } ); 
```

我们将数据推送到一个对象数组中，每个对象都有一个新字段来定义它应该进入哪一列。但这还不够，因为我们需要将数据放入存储中。商店需要一个模型——我们必须以卡片渲染器知道如何访问数据的方式定义字段。似乎没有一种简单的方法可以将字段定义添加到现有的拉力模型中，所以应该这样做（拉力模型具有唯一的字段信息和一个名为 getField() 的方法，因此我们必须添加：

```
 Ext.define('CardModel', { 
                            extend: 'Ext.data.Model',
                            fields: [
                                { name: '_ref', type: 'string' },
                                { name: 'ObjectID', type: 'number'},
                                { name: 'Name', type: 'string', attributeDefinition: { AttributeType: 'STRING'} },
                                { name: 'FormattedID', type: 'string'},
                                { name: '_column', type: 'string' },
                                { name: 'ScheduleState', type: 'string' } ] ,
                            getField: function(name) {
                                if ( this.data[name] ) { 
                                    var return_field = null;
                                    Ext.Array.each( this.store.model.getFields(), function(field) {
                                        if ( field.name === name ) {
                                            return_field = field;
                                        }
                                    } );

                                    return return_field;
                                } else {
                                    return null;
                                }
                            } 
                        });

                        var cardStore = Ext.create('Ext.data.Store',{
                            model: 'CardModel',
                            data: modified_records
                        }); 
```

现在，我们将创建一个纸板，但不是集会纸板，而是从我们将在下面定义的类（'DependencyCardboard'）中制作一个。此外，我们将传递一个新的列定义，我们还将在下面定义（'dependencycolumn'）。

```
 var cardboard = Ext.create('DependencyCardboard', {
                            attribute: '_column',
                            store: cardStore, /* special to our new cardboard type */
                            height: 500,
                            columns: [{
                                xtype: 'dependencycolumn',
                                displayValue: 'predecessor',
                                value: 'predecessor',
                                store: cardStore
                            }, 
                            {
                                xtype: 'dependencycolumn',
                                displayValue: 'base',
                                value: 'base',
                                store: cardStore
                            },
                            {
                                xtype: 'dependencycolumn',
                                displayValue: 'successor',
                                value: 'successor',
                                store: cardStore
                            }]
                        }); 
```

**纸板：**

大多数情况下，现有的 Rally 纸板可以满足我们的需求，因为所有查询都在列本身中完成。但是我们仍然必须重写它，因为有一个函数给我们带来了问题：_retrieveModels。该函数通常采用记录类型（例如，用户故事），并在此基础上创建基于 Rally 定义的数据模型。但是，我们没有直接使用 UserStory 记录；我们必须定义自己的模型，以便添加“_columns”字段。因此，我们创建了一个新定义（我们在上面的“DependencyCardboard”创建语句中使用它）。

（请记住，我们只需单击标题即可查看 API 中所有 Rally 对象的源代码，因此我们可以将以下方法与基类中的方法进行比较。）

我们可以保留 Rally 纸板所做的所有事情，并且只通过这样做覆盖一个方法：

```
Ext.define( 'DependencyCardboard', {
    extend: 'Rally.ui.cardboard.CardBoard',
    alias: 'widget.dependencycardboard',
    constructor: function(config) {
        this.mergeConfig(config);
        this.callParent([this.config]);
    },
    initComponent: function() {
        this.callParent(arguments);
    },
    _retrieveModels: function(success) {
        if ( this.store ) {
            this.models = [ this.store.getProxy().getModel() ];
            success.apply( this, arguments );
        }
    }

}); 
```

**柱子：**

每一列通常都会转到 Rally 并说“给我所有具有与列名称相同的字段的故事”。但是我们将 store 传递给 cardboard，所以我们需要覆盖 _queryForData。此外，当我们这样做时，关于定义列高会发生一些事情（我不知道为什么！）所以我不得不在 getColumnHeightFromCards() 方法中添加一个小问题。

```
_queryForData: function() {
        var allRecords = [];

        var records = this.store.queryBy( function( record ) {
            if ( record.data._column === this.getValue() ) { allRecords.push( record ); }
        }, this);

        this.createAndAddCards( allRecords );
    },
    getColumnHeightFromCards: function() {
        var contentMinHeight = 500,
            bottomPadding = 30,
            cards = this.query(this.cardConfig.xtype),
            height = bottomPadding;

        for(var i = 0, l = cards.length; i < l; ++i) {
            if ( cards[i].el ) {
                 height += cards[i].getHeight();
            } else {
                height += 100;
            }

        }

        height = Math.max(height, contentMinHeight);
        height += this.down('#columnHeader').getHeight();

        return height;
    } 
```

**结束**

因此，如果您将所有这些部分加在一起，您会得到一个长 html 文件，我们可以将其推送到面板中（并且您可以继续研究如何覆盖拖动结果并为第一个项目添加选择器面板。 （并且你可以更好地抽象成它自己的类））。

**完整的东西：**

```
<!DOCTYPE html>
<html>
<head>
    <title>cardboard</title>

    <script type="text/javascript" src="/apps/2.0p3/sdk.js"></script>

    <script type="text/javascript">
        Rally.onReady(function() {
            /*global console, Ext */

            Ext.define( 'DependencyColumn', {
                extend: 'Rally.ui.cardboard.Column',
                alias: 'widget.dependencycolumn',
                constructor: function(config) {
                    this.mergeConfig(config);
                    this.callParent([this.config]);
                },
                initComponent: function() {
                    this.callParent(arguments);
                },
                _queryForData: function() {
                    var allRecords = [];

                    var records = this.store.queryBy( function( record ) {
                        if ( record.data._column === this.getValue() ) { allRecords.push( record ); }
                    }, this);

                    this.createAndAddCards( allRecords );
                },
                getColumnHeightFromCards: function() {
                    var contentMinHeight = 500,
                        bottomPadding = 30,
                        cards = this.query(this.cardConfig.xtype),
                        height = bottomPadding;

                    for(var i = 0, l = cards.length; i < l; ++i) {
                        if ( cards[i].el ) {
                             height += cards[i].getHeight();
                        } else {
                            height += 100;
                        }

                    }

                    height = Math.max(height, contentMinHeight);
                    height += this.down('#columnHeader').getHeight();

                    return height;
                } 

            });
            /*global console, Ext */

            Ext.define( 'DependencyCardboard', {
                extend: 'Rally.ui.cardboard.CardBoard',
                alias: 'widget.dependencycardboard',
                constructor: function(config) {
                    this.mergeConfig(config);
                    this.callParent([this.config]);
                },
                initComponent: function() {
                    this.callParent(arguments);
                },
                _retrieveModels: function(success) {
                    if ( this.store ) {
                        this.models = [ this.store.getProxy().getModel() ];
                        success.apply( this, arguments );
                    }
                }

            });
            /*global console, Ext */
            Ext.define('CustomApp', {
                extend: 'Rally.app.App',
                componentCls: 'app',
                items: [ { xtype: 'container', itemId: 'outer_box' }],
                launch: function() {
                    Ext.create('Rally.data.WsapiDataStore', {
                        model: "hierarchicalrequirement",
                        autoLoad: true,
                        fetch: ['Name','Predecessors','Successors','FormattedID','ObjectID','_ref'],
                        filters: [ {
                            property: 'FormattedID', operator: 'contains', value: '37'
                        } ],
                        listeners: { 
                            load: function(store,data,success) {
                                if ( data.length === 1 ) {
                                    var base_story = data[0].data;
                                    var modified_records = [];

                                    base_story._column = "base";
                                    modified_records.push( base_story );

                                    Ext.Array.each( base_story.Predecessors, function( story ) {
                                        story._column = "predecessor";
                                        modified_records.push( story );
                                    } );

                                    Ext.Array.each( base_story.Successors, function(story) {
                                        story._column = "successor";
                                        modified_records.push( story );
                                    } );

                                    Ext.define('CardModel', { 
                                        extend: 'Ext.data.Model',
                                        fields: [
                                            { name: '_ref', type: 'string' },
                                            { name: 'ObjectID', type: 'number'},
                                            { name: 'Name', type: 'string', attributeDefinition: { AttributeType: 'STRING'} },
                                            { name: 'FormattedID', type: 'string'},
                                            { name: '_column', type: 'string' },
                                            { name: 'ScheduleState', type: 'string' } ] ,
                                        getField: function(name) {
                                            if ( this.data[name] ) { 
                                                var return_field = null;
                                                Ext.Array.each( this.store.model.getFields(), function(field) {
                                                    if ( field.name === name ) {
                                                        return_field = field;
                                                    }
                                                } );

                                                return return_field;
                                            } else {
                                                return null;
                                            }
                                        } 
                                    });

                                    var cardStore = Ext.create('Ext.data.Store',{
                                        model: 'CardModel',
                                        data: modified_records
                                    });

                                    var cardboard = Ext.create('DependencyCardboard', {
                                        attribute: '_column',
                                        store: cardStore,
                                        height: 500,
                                        columns: [{
                                            xtype: 'dependencycolumn',
                                            displayValue: 'predecessor',
                                            value: 'predecessor',
                                            store: cardStore
                                        }, 
                                        {
                                            xtype: 'dependencycolumn',
                                            displayValue: 'base',
                                            value: 'base',
                                            store: cardStore
                                        },
                                        {
                                            xtype: 'dependencycolumn',
                                            displayValue: 'successor',
                                            value: 'successor',
                                            store: cardStore
                                        }]
                                    });

                                    this.down('#outer_box').add( cardboard );
                                }
                            },
                            scope: this
                        }
                    });
                }
            });

            Rally.launchApp('CustomApp', {
                name: 'cardboard'
            });
        });
    </script>

    <style type="text/css">
        .app {
             /* Add app styles here */
        }
    </style>
</head>
<body></body>
</html> 
```

# php - 使用 PHP 按日期对多维 XML 进行排序

> ID：11940042
> 
> 赞同：0
> 
> 时间：2012-08-13T18:20:01.967
> 
> 标签：php, xml, sorting, simplexml

我找不到这个问题的完全相同的副本，因为我的节点是数字键。

我需要按日期对这个 xml 进行排序 - 最新的优先：

```
[article] => Array
    (
        [0] => SimpleXMLElement Object
            (
                [value] => some value
                [date] => 2012-08-13 18:54:09
            )

        [1] => SimpleXMLElement Object
            (
                [id] => some more value
                [date] => 2012-08-09 10:24:06
            )

        [2] => SimpleXMLElement Object
            (
                [id] => another value
                [date] => 2012-08-11 20:45:44
            )
     ) 
```

我怎样才能最好地做到这一点 - 可能不将 XML 转换为 PHP 数组然后对其进行排序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T18:16:35.960

从您的示例中，看起来您已经有一个对象数组，所以`usort`可以正常工作。

回调看起来像这样：

```
function compare_node_dates($a, $b)
{
    return
        strtotime((string)$b->date)
        -
        strtotime((string)$a->date);
} 
```

但是，如果您的最外层变量实际上不是一个数组，那么如果不创建一个数组、对其进行排序并使用它来构造全新的 XML，我就无法意识到这样做。

# c# - ASMX Web Service 接收大量数据

> ID：11940044
> 
> 赞同：1
> 
> 时间：2012-08-13T18:20:10.800
> 
> 标签：c#, web-services, ssl, asmx

我正在研究通过 asmx Web 服务将大量数据上传到服务器的解决方案。我已经在这样的客户端上实现了传输代码：

```
service.ReceiveCompleted += MethodComplete;

public void Transfer(string data)
{
    service.ReceiveAsynk(data);
}

private void MethodComplete(object sender, ReceiveCompletedEventArgs e)
{
    service.DoWork(e.Result);
} 
```

传输方法参数字符串使用 deflate 流压缩服务使用证书并通过 SSL/TLS 工作，但是当我开始上传数据时，我随机收到：“无法连接到远程服务器”或“请求被中止：无法创建 SSL/TLS安全通道。” 此外，只有在压缩字符串超过 200Kb 时才会出现错误“无法创建 SSL/TLS 安全通道”。”有什么建议吗？

# windows - Windows 字体渲染

> ID：11940048
> 
> 赞同：0
> 
> 时间：2012-08-13T18:20:17.957
> 
> 标签：windows, fonts, rendering

我正在编写一个应用程序，它将数据流作为输入（来自[Redmon ）发送到打印机。](http://pages.cs.wisc.edu/~ghost/redmon/index.htm)数据流具有呈现为单色位图的文本，打印机将使用该位图将其打印在纸上。我计划解析这个数据流并理解发送到打印机的文本。我的应用程序会解析来自任何 Windows 应用程序的数据并发送到打印机。

我解析数据流的方式是匹配像素信息（逐字节），如果完全匹配，那么我可以唯一地识别一个字符。为此，我假设所有 Windows 应用程序都使用相同的 Windows 渲染器以像素为单位渲染字体。因此，如果这些应用程序（包括基于 java 的应用程序）使用相同的字体和字体大小来打印它们的文本，我总是会从任何应用程序中为特定字符获取相同的字节序列。这是一个正确的假设还是 Windows 是否为应用程序提供了各种选项来渲染文本以​​进行打印？

还有一个库可以用来使用单色位图数据进行字符识别吗？

注意：我使用的打印机是 ESC/POS 兼容的打印机。这些打印机的打印机驱动程序将要打印的数据作为单色位图发送。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T19:41:03.243

我对 ESC/POS 打印机不熟悉，但如果你能保证驱动程序总是将文本呈现为单色位图，那么相同字体和大小的字符相同的机会非常高，但它们不是 100%。首先，您还需要考虑旋转、缩放和剪切。您需要考虑整个转换矩阵，而不仅仅是字体大小。

我能想到的至少还有两个其他故障点：1）用透明胶片覆盖的文本和 2）如果机器安装了具有相同名称的备用字体。例如，可以从许多来源获得像 Helvetica 这样的常见字体，并且它们之间的字符不会相同。第三种可能的故障是应用程序忽略了打印机是单色的并且以彩色或灰度打印的事实。将彩色或灰度转换为单色会为不同的颜色生成不同的位图。

至于 OCR 软件，[Wikipedia](http://en.wikipedia.org/wiki/Comparison_of_optical_character_recognition_software)上有一张很好的 OCR SDK 对比图。

# objective-c - 由于 UI 设计，在导航栏和搜索栏之间创建空间

> ID：11940050
> 
> 赞同：0
> 
> 时间：2012-08-13T18:20:25.213
> 
> 标签：objective-c, ios, xcode

我有一个应用程序，其中导航栏是根据 Apple HIG 实现的，所以 44px 高。在其下方是一个搜索栏，它位于导航栏的正下方。

设计我的应用程序的人现在已经为导航栏创建了一个 64 像素高的自定义图像。我已经剪切了图像，以便导航栏图像的实际高度为 44 像素。并将图像的其余部分添加到 tableView 背景图像中。除了现在我的 searchBar 正在滚动浏览我的 navigationBar IMAGE 之外，一切都已实现并正常工作。所以从技术上讲，它不在导航栏中，而是从 UI 设计的角度来看。

我似乎不知道如何确保导航栏（20px）正下方的空间未被使用。对用户来说，它应该看起来好像导航栏大了 20 像素。

希望有人可以指导我正确的方向，谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T18:33:06.510

我想你有你的搜索栏嵌套在一个`UITableView`权利？您可以将视图控制器更改为子类`UIViewController`而不是 a `UITableViewController`，然后您将能够手动将表格视图添加到控制器的视图中，并以任何您想要的方式调整其大小。

（不要忘记让您的控制器实现数据源和委托协议并将其与您的表格视图挂钩。）

# android - 从 Play 商店安装应用程序时，Android BroadcastReceiver 无法正常工作

> ID：11940052
> 
> 赞同：3
> 
> 时间：2012-08-13T18:20:31.833
> 
> 标签：android, android-intent, google-play, broadcast

我有一项通过 Intent.ACTION_BATTERY_CHANGED 获取电池更新的服务：

```
batteryFilter = new IntentFilter(Intent.ACTION_BATTERY_CHANGED);
batteryReceiver = new BatteryReceiver(); 
```

和接收器：

```
public void onReceive(Context context, Intent intent) {

    String action = intent.getAction();
    if(action.equals(Intent.ACTION_POWER_CONNECTED)) {
        onBattery = false;
        Log.w("battery","on power");
    }
    else if(action.equals(Intent.ACTION_POWER_DISCONNECTED)) {
        Log.w("battery","on battery");
        onBattery = true;
    }
} 
```

通过 USB 调试安装应用程序时，这完全符合预期。在我将其发布到 Play 商店并从那里进行全新安装后，它不起作用。其他接收器也无法在应用程序中工作。该应用程序的其余部分似乎工作正常，只是没有广播接收器工作。什么可能导致这种情况发生？

这是 android 2.2，它是对已经在商店中的应用程序的更新，接收器在更新之前也可以正常工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T18:31:08.203

如果您在 Android 3.1+ 上运行，并且您没有手动运行其中一个组件（例如，从启动器启动一个活动），那么您的 manifest-registered`BroadcastReceiver`将不会工作。

# objective-c - NSUserDefaults IOS 无处不在？

> ID：11940054
> 
> 赞同：1
> 
> 时间：2012-08-13T18:20:40.163
> 
> 标签：objective-c, ios, singleton, nsuserdefaults

我想知道 NSUserDefaults 对象是否是共享的，并且可以从应用程序委托以及我的几个视图控制器中访问。基本上我需要从应用程序委托来回传递数据到视图控制器。我不想使用单例。我想知道 NSUserDefauflts 对象是否是一种方法。

如果这是可能的，我将如何初始化对象以使其成为可能？

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-13T18:25:06.223

如果只使用`[NSUserDefaults standardUserDefaults]`，每次都会返回相同的实例。然后不同的类可以使用它来存储跨会话持久的数据。

如果您只是尝试在应用程序的各个部分之间传递数据，而不是存储它，那么用户默认值不是这样做的适当方式。您应该在您的类上公开方法或属性，这些方法或属性将您需要传递的数据作为输入。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-13T18:25:25.380

嗯，它是，但这并不是它的设计目的。正常的设计模式是“手动”在视图控制器之间来回传递对象。您希望您的视图控制器尽可能独立于应用程序的其余部分——可重用。把它们绑起来`NSUserDefaults`不是一个好方法！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-13T18:35:04.783

您不应该在您的应用委托中进行任何处理。理想情况下，您应该初始化您的窗口、根视图控制器（如果不是通过情节提要执行此操作）和模型，仅此而已。所有处理都应该在其他地方完成（主要是在与模型类对话的视图控制器中）。

使您的根模型类成为单例，以便您的所有视图控制器都可以通过您选择的接口与其通信。

制作单例并不难：

```
@interface MyModel: NSObject

+ (MyModel *)sharedModel;

@end 
```

和实施：

```
@implementation MyModel

+ (MyModel *)sharedModel
{
    static MyModel* modelSingleton = nil;
    static dispatch_once_t once;
    dispatch_once(&once, ^{
        modelSingleton = [[MyModel alloc] init];
    });

    return modelSingleton;
}

@end 
```

然后你只需使用：

```
[MyModel sharedModel] 
```

访问它。

# ruby-on-rails - 在 TC 服务器上部署 Rails 应用程序

> ID：11940055
> 
> 赞同：1
> 
> 时间：2012-08-13T18:20:40.563
> 
> 标签：ruby-on-rails, tomcat, tcserver

好的，这是我的问题。

我在 TC 服务器上部署了一个 rails 应用程序。我有一个 .WAR 文件，服务器能够呈现通过 WEB-INF 读取的数据。

我有这样的看法

```
 <%=  f.label :username%>
  <%=  f.text_field :password%> 
```

现在视图仅在 f.label 被注释掉并且 html 标签如

用户名

改为写。

该错误表明当我使用 f.label 或实际上只是 <%= label :something %> 时堆栈级别太深。

如果我缺少任何宝石或需要专门为 TC 服务器做一些事情，请告诉我

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T18:24:52.967

我认为你需要试试这个：

```
 <%= f.label  :username %>
  <%= f.text_field :password %> 
```

代替

```
 <%=  f.label: username%>
  <%=  f.text_field: password%> 
```

# php - 选择和更新 mysql 相同的查询

> ID：11940062
> 
> 赞同：0
> 
> 时间：2012-08-13T18:20:59.283
> 
> 标签：php, mysql

我正在运行查询以从一个表中选择一组 id，以便我可以使用结果数据集中的数据更新另一个表。

```
//db query result
$query = "SELECT image_id FROM jos_jxgallery_images ORDER BY jos_jxgallery_images.image_id DESC LIMIT 25";
 $query_execute = mysql_query($query);
mysql_close($db_config);

 while ($items = mysql_fetch_array($query_execute)) {
 echo $items['image_id']; 
 echo '<br/>';
} 
```

我认为我需要在 while 循环中执行此操作，我只是有 echo 以查看 items 变量中的内容。这行得通。我认为要做的事情是在 while 循环中。我想用我的另一个表的实际更新 SET 查询替换“回声”。就像是...

```
while ($items = mysql_fetch_array($query_execute)) {
$q = "UPDATE jx_gallery_images_ratings SET image_id ='".$items.""; 
mysql_query($q); 
```

但是新表没有数据。有没有更好的方法来写这个......甚至可以作为一个查询或其他东西？任何帮助表示赞赏。

编辑：我应该解释得更好一点。该表是空的，我可以继续使用从一个表到另一个表的插入来获取 id。然而，在那之后......在某种程度上它有点像一个“临时”表。但不是真的。无论我在我的第一个表的 SELECT 查询中创建的 image_id 的顺序是什么（除了 image_id 之外，还有其他行可以排序，例如“hits”）......所以第二个表需要用相同的顺序更新image_id 的。可能会通过 cron 作业多次运行这几个小片段。所以，是的，我正在尝试使用第一个表的 SELECT 查询的顺序来更新第二个表，然后再次将 id 放在我的第二个表中......根据第一个 SELECT 查询的顺序。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-13T18:26:00.250

如果表是空的，你应该做一个插入。您可以像这样在单个查询中执行此操作：

```
INSERT INTO jx_gallery_images_ratings (image_id)
SELECT image_id FROM jos_jxgallery_images ORDER BY jos_jxgallery_images.image_id DESC LIMIT 25 
```

请注意，您可能并不真正需要 ORDER BY，您可以通过删除 LIMIT 一次对所有图像执行此操作

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-13T18:30:34.490

就像是：

```
UPDATE tbl_updateme SET row_to_update = (SELECT row_you_need from tbl_target WHERE tbl_updateme.comparison_row = tbl_target.comparison_row) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T18:39:19.913

```
INSERT INTO jx_gallery_images_ratings (image_id) (SELECT image_id FROM jos_jxgallery_images ORDER BY jos_jxgallery_images.image_id DESC LIMIT 25) 
```

或者

简单的方法是创建触发器，在使用动态 SQL 选择后更新表

# django - Django 中是否有类似 request.LANGUAGE_CODE 的语言环境文化？

> ID：11940063
> 
> 赞同：2
> 
> 时间：2012-08-13T18:21:16.293
> 
> 标签：django

`request.LANGUAGE_CODE`告诉我用户选择了什么语言。例如`en`英语或`de`德语。

但是我如何获得文化代码？比如`GB`英式英语和`us`美式英语？

非常感谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T19:44:16.983

有`request.META['HTTP_ACCEPT_LANGUAGE']`。但是，这是由客户端（通常是 Web 浏览器）设置的，因此在某些情况下可能无法正确设置或设置*。*唯一万无一失的方法是要求用户选择他们喜欢的语言，然后使用该设置。但是，如果站点使用正确的语言并不重要，并且您希望它在没有干预的情况下为用户“正常工作”，那么使用 HTTP_ACCEPT_LANGUAGE 标头就可以了。您甚至可以将这两种方法结合起来，以便用户可以在他们更喜欢与检测到的语言不同的语言时进行切换。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T19:16:10.147

Django i18n 上下文处理器（“django.core.context_processors.i18n”）将您的 LANGUAGES 设置添加到您的上下文中。这让您可以执行以下操作：

```
<form action="{% url 'set_language' %}" method="post">
{% csrf_token %}
<input name="next" type="hidden" value="{{ redirect_to }}" />
<select name="language">
{% get_language_info_list for LANGUAGES as languages %}
{% for language in languages %}
<option value="{{ language.code }}">{{ language.name_local }} ({{ language.code }})</option>
{% endfor %}
</select>
<input type="submit" value="Go" />
</form> 
```

[https://docs.djangoproject.com/en/dev/topics/i18n/translation/#django.conf.urls.i18n.set_language](https://docs.djangoproject.com/en/dev/topics/i18n/translation/#django.conf.urls.i18n.set_language)

添加方言也是有效的，例如看看这个帖子：

[Django：如何为应用程序添加中文支持](https://stackoverflow.com/questions/7728977/django-how-to-add-chinese-support-to-the-application)

# wpf - Radcombobox 清除不在项目列表中的文本

> ID：11940075
> 
> 赞同：5
> 
> 时间：2012-08-13T18:21:43.853
> 
> 标签：wpf, telerik, radcombobox

我有一个telerik `radcombobox`，如下所示：

```
<telerik:RadComboBox x:Name="cbCustomerName"
                                 Grid.Row="1"
                                 Grid.Column="1"
                                 Grid.ColumnSpan="3"
                                 Margin="0 0 0 10"
                                 DisplayMemberPath="FullName"
                                 IsEditable="True"
                                 IsFilteringEnabled="True"
                                 ItemsSource="{Binding Customers}"
                                 OpenDropDownOnFocus="True"
                                 SelectedValuePath="CustomerId"
                                 SelectionChanged="cbCustomerName_SelectionChanged"
                                 Text="{Binding CurrentCustomer.FullName,
                                                UpdateSourceTrigger=LostFocus}" /> 
```

当我在文本框中键入不在其项目列表中的内容然后转到其他控件时，它会清除其中的文本，这是我不想要的。

我检查了所有属性，但在失去焦点后找不到任何东西可以保留它。

如果有人知道这一点，请提供帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-14T21:22:03.077

我知道这个问题很老，但我想我会发布一个解决方案，以防其他人有这个问题。如果将“IsTextSearchEnabled”属性设置为“False”，则它允许自定义文本，并且在 RadComboBox 失去焦点时不会清除它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T18:24:32.917

您是否尝试过使用该`AllowCustomText`属性为真？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T21:15:20.260

尝试添加`TextSearchMode="Contains"`. `IsFilteringEnabled="True"`如果您不需要过滤结果，请尝试删除。
我不是 100% 确定，但是如果您尝试过滤它并且它没有找到任何东西，它可能会清除您的文本。

# javascript - 在文本编辑中编辑时随机出现†

> ID：11940077
> 
> 赞同：0
> 
> 时间：2012-08-13T18:21:47.303
> 
> 标签：javascript, textedit

我是 Mac 的新手，正在文本编辑中编辑我的 .js。我不知道这是什么时候发生的，但是...4

†

出现在我的文字中。我什至不知道如何制作那个符号......我只是将它从文本编辑复制粘贴到 SO。

1.  这是什么？

2.  它从哪里来的？

我在文本编辑中没有做任何奇怪的事情……只是打字和一些复制粘贴。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T18:27:10.040

该字符是[匕首符号](http://en.wikipedia.org/wiki/Dagger_%28typography%29)，通常用于表示不可打印的字符，例如空格、制表符、换行符等。我不确定它在您的特定文本编辑器中的含义。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T18:24:45.043

你能按 alt/option T 吗？

Mac 键盘上的 Alt/option 除了通常用作元键外，还用于键入特殊字符。[您可以使用键盘查看器](http://www.tech-recipes.com/rx/2896/mac_os_x_use_the_keyboard_viewer_to_identify_special_character_keystrokes/)调色板更轻松地查看其效果。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-13T18:24:59.757

我相信这是一个换页字符（`\f`在 c 中）。一些编辑器可能会使用`\n\f`（换行、换页）换行。您的编辑可能只期待`\n`.

# javascript - 使用 .val() 从电话号码中取出文字

> ID：11940079
> 
> 赞同：1
> 
> 时间：2012-08-13T18:21:57.087
> 
> 标签：javascript, jquery, input

我正在尝试删除电话号码 (999) 999-9999 中的文字，使其成为另一个隐藏输入值中的 9999999999。

这可以使用 .val() 函数来完成，还是只能向隐藏输入添加更多值？

电话 1= (999) 999-9999

电话应该有这个值= 9999999999

```
 $('#phone1').bind('keypress blur', function() {

    $('#phone').val($('#phone1').val() + ' ' );
    }); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-13T18:23:39.593

1.  获得价值
2.  运行[字符串替换](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/replace)
3.  设定值

简单字符串的基本思想

```
var str = "(999) 999-9999 ";
var newStr = str.replace(/\D/g,"");
console.log(newStr); 
```

现在写你所做的最好的方法是

```
$('#phone1').on('blur', function() {  //jQuery 1.7.2+ use on, not bind
    var txtBox = $(this);
    txtBox.val( txtBox.val().replace(/\D/g,"") );
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T18:26:20.583

```
$('#phone1').on('keypress blur', function() {
    $('#phone').val(this.value.replace(/[^\d]/g, "") + ' ' );
}); 
```

[小提琴](http://jsfiddle.net/yYNFY/2/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-13T18:26:55.800

您需要`replace` *^([[MDN]](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/replace))*方法。这将为您完成大部分工作：

```
$('#phone').val($('#phone1').val().replace(/\D/g, '')); 
```

第一个参数可以是子字符串或正则表达式。在示例中，我将正则表达式用于“不是数字”。

# visual-c++ - 更新后在 CListCtrl 中滚动会产生问题

> ID：11940081
> 
> 赞同：1
> 
> 时间：2012-08-13T18:22:06.140
> 
> 标签：visual-c++, mfc

我正在使用 a`CListCtrl`并且在某些条件下，我需要更新`CListCtrl`

但是，在更新发生后，滚动`CListCtrl`, 成为一个问题。通过显示同一行、多次等，UI 完全被破坏了，

我正在使用更新列表控件`SetItemText()`。你以前有没有遇到过同样的情况，我该如何解决？

注意：我尝试覆盖`OnVScroll`并调用基类的`VScroll`. 这似乎也没有帮助。

更新后，我也刷新了列表控件，使用

```
CListCtrl::RedrawWindow(NULL,NULL,RDW_FRAME | RDW_INVALIDATE | RDW_ERASE | RDW_UPDATENOW); 
```

# node.js - 拒绝将 sqlite3 安装为自身的依赖项

> ID：11940086
> 
> 赞同：21
> 
> 时间：2012-08-13T18:22:25.430
> 
> 标签：node.js, sqlite, npm

我有最新版本的 node.js，没有任何问题。我正在尝试为 node.js 使用 sqlite 模块。

对于 developmentseed 的 node-sqlite3，我按照以下说明进行操作：

```
git clone git://github.com/developmentseed/node-sqlite3.git
cd node-sqlite3
./configure
make 
```

我安装了 npm： curl -k [https://npmjs.org/install.sh](https://npmjs.org/install.sh) | 须藤

并使用 npm 安装 node-gyp： sudo npm install -g node-gyp

在 node-sqlite3 configure-d 和 make-d 好之后，我尝试用 npm 安装，我得到了这个：

```
npm install sqlite3
npm WARN install Refusing to install sqlite3 as a dependency of itself 
```

当我研究这个错误时，我发现了这个问题：[npm install sqlite3 error](https://stackoverflow.com/questions/10439862/npm-install-sqlite3-error)所以我尝试了：

```
 node-waf clean || true; node-waf configure build 
```

但收到此错误：

```
/usr/local/bin/../lib/node/wafadmin/Utils.py:136: DeprecationWarning: the md5 module is deprecated; use hashlib instead
from md5 import md5
Waf: Please run waf from a directory containing a file named "wscript" or run distclean
/usr/local/bin/../lib/node/wafadmin/Utils.py:136: DeprecationWarning: the md5 module is deprecated; use hashlib instead
from md5 import md5
arg[0] directory does not contain a wscript file 
```

当我尝试构建 orlandov/node-sqlite 时，我从 git 得到它，然后尝试：

```
node-waf configure build 
```

但我收到此错误：

```
/usr/local/bin/../lib/node/wafadmin/Utils.py:136: DeprecationWarning: the md5 module is
deprecated; use hashlib instead
from md5 import md5
Checking for program g++ or c++          : /usr/bin/g++
Checking for program cpp                 : /usr/bin/cpp
Checking for program ar                  : /nnmc/cvsbin/ar
Checking for program ranlib              : /usr/bin/ranlib
Checking for g++                         : ok
Checking for program gcc or cc           : cc
Checking for gcc                         : ok
Checking for node path                   : not found
Checking for node prefix                 : ok /usr/local
'configure' finished successfully (0.070s)
Waf: Entering directory `/U1/dorothyy/project_node/node-sqlite/build'
/U1/dorothyy/project_node/node-sqlite/deps/mpool-2.1.0
make: Nothing to be done for `all'.
Waf: Leaving directory `/U1/dorothyy/project_node/node-sqlite/build'
Traceback (most recent call last):
File "/usr/local/bin/node-waf", line 16, in <module>
Scripting.prepare(t, os.getcwd(), VERSION, wafdir)
File "/usr/local/bin/../lib/node/wafadmin/Scripting.py", line 145, in prepare
prepare_impl(t, cwd, ver, wafdir)
File "/usr/local/bin/../lib/node/wafadmin/Scripting.py", line 135, in prepare_impl
main()
File "/usr/local/bin/../lib/node/wafadmin/Scripting.py", line 188, in main
fun(ctx)
File "/usr/local/bin/../lib/node/wafadmin/Scripting.py", line 386, in build
return build_impl(bld)
File "/usr/local/bin/../lib/node/wafadmin/Scripting.py", line 405, in build_impl
bld.compile()
File "/usr/local/bin/../lib/node/wafadmin/Build.py", line 255, in compile
self.flush()
File "/usr/local/bin/../lib/node/wafadmin/Build.py", line 717, in flush
tg.post()
File "/usr/local/bin/../lib/node/wafadmin/TaskGen.py", line 219, in post
self.apply()
File "/usr/local/bin/../lib/node/wafadmin/TaskGen.py", line 206, in apply
v()
File "/usr/local/bin/../lib/node/wafadmin/TaskGen.py", line 464, in apply_core
node = find_resource(filename)
File "/usr/local/bin/../lib/node/wafadmin/Node.py", line 183, in find_resource
st = Utils.h_file(path)
AttributeError: 'module' object has no attribute 'h_file' 
```

我不能使用 grumdrig/node-sqlite，因为它不支持异步访问。

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2014-08-25T09:54:37.643

当我的应用程序与我正在 (npm) 安装的软件包之一同名时，我收到此错误。我只是在做一些练习，没想到我需要一个独特的项目名称......

只需将`name`您`package.json`的内容更改为其他内容，它应该可以工作。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-08-13T20:14:59.243

你不需要执行

```
npm install sqlite3 
```

在 node-sqlite3 文件夹中。通过执行此命令，您尝试将 sqlite3 安装为 sqlite3 的依赖项（您已经拥有它）。

sqlite3有两种安装方式：

**第一的：**

在您的项目文件夹中执行

```
npm install sqlite3 
```

你不需要在它之前克隆 git 项目。不需要手动配置和制作。只需在要使用 sqlite3 模块的项目文件夹中执行此命令。在 npm 完成后，您应该会在项目文件夹中看到文件夹 node_modules/sqlite3。现在你可以通过 require 在你的项目中使用它：

```
var sqlite3 = require('sqlite3'); 
```

**第二：**

仅当 npm install 失败时才使用这种方式。（超自然现象）。

1.  转到您的项目文件夹。
2.  如果不存在，则创建文件夹 node_modules。
3.  执行：

    ```
    git clone git://github.com/developmentseed/node-sqlite3.git
    cd node-sqlite3
    ./configure
    make 
    ```

4.  行。现在 sqlite3 可以使用一半了。我们需要安装依赖项。执行：

    ```
    npm install 
    ```

    **注意：** npm install 不带其他参数。此命令使用您的 sqlite3 文件夹中的 package.json 来安装依赖项。

在 npm 完成后，您可以在项目中使用 sqlite3 模块。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-09-03T11:14:41.817

只需离开您要安装的模块的目录，然后再次尝试安装即可。这对我有用。所以：

```
cd ..
npm install sqlite3 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-10-07T16:55:30.510

**检查您的项目文件夹名称是否与您尝试安装的模块相同**，

如果您尝试在项目文件夹名称 express 中安装 express，您将收到此错误。

重命名您的项目文件夹，与 npm 模块名称相比，您的项目文件夹名称应该是唯一的

还要更改 package.json 文件条目

```
 "name": "xxxxx",
  "version": "1.0.0", 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-05-16T05:43:49.327

当您的软件包名称与您要安装的软件包相同时，会发生此错误。
去`package.json` 检查名称属性初始化

```
{
name:"xxxx",
...
} 
```

可能会有所帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-10-26T14:02:44.513

我猜在 package.json 文件中，项目的名称是 sqlite3。因此，当您尝试安装它时，由于提到的某些原因，它会拒绝它成为依赖项。所以尝试更改 package.json 中的项目名称并尝试一下。如需进一步参考结帐：[http ://thisdavej.com/node-newbie-error-npm-refusing-to-install-package-as-a-dependency-of-itself/](http://thisdavej.com/node-newbie-error-npm-refusing-to-install-package-as-a-dependency-of-itself/)

# java - jsf复合内标签

> ID：11940091
> 
> 赞同：0
> 
> 时间：2012-08-13T18:23:01.000
> 
> 标签：java, jsf, tags, composite

我正在尝试编写一个 jsf 复合标签，它有很多选项和内部选项。类似于数据表的东西。假设你想实现一个没有它的内部标签的 dataTable ，比如 column 它将充满选项并且可能无法使用。现在我的问题是复合标签可以有一些内部标签吗？如果是，我们如何使用它们，如果不是，如何实现 dataTable 标记？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T00:09:55.993

您可以通过以下方式传递孩子：

所以，举一个像你描述的最小的例子：

```
<cc:implementation>

    <h:dataTable
        value="#{someBean.listObject}"
        var="row"/>

        <cc:insertChildren/>

    </h:dataTable>

</cc:implementation> 
```

复合组件标签“insertChildren”在渲染时将子组件从调用 facelet 传递到组件中。这可能符合您的目的。请记住，如果您传递在运行时定义的“孩子”，您可能会遇到问题，因为 CC 提前呈现。我遇到了需要定义某些内容的 CC 的问题，但它通过 ui:param 传递到调用 facelet，该参数在 CC 构建之后的阶段进行处理。买者自负！

# objective-c - 将数据从 Viewcontroller 传递到 Label

> ID：11940093
> 
> 赞同：2
> 
> 时间：2012-08-13T18:23:01.623
> 
> 标签：objective-c, ios, xcode, segue

> **可能的重复：**
> [在视图控制器之间传递数据](https://stackoverflow.com/questions/5210535/passing-data-between-view-controllers)

iOS开发新手在这里..

我的主 ViewController 上有一堆按钮，我想要发生的是当用户单击其中一个按钮时，我希望它将它们带到具有标签的单独视图，并且我希望该标签中的文本根据他们按下的按钮进行更改。

所以基本上我希望能够将数据从主 ViewController 上的按钮传递到第二个视图中的标签。

这可能有点令人困惑，我很抱歉，但任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T18:35:06.543

如果可能的话，我建议你使用故事板。然后，您可以 ctrl 从每个按钮拖动到您拖出到情节提要上的新视图控制器。这将设置一个 segue，您可以使用方法 prepareforseguie 来传递您需要在新视图控制器中使用的数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T18:33:17.400

假设您的带有按钮的视图控制器位于导航控制器中 - 大概在根...

你要做的是，为你的每个按钮添加一个目标，在代码中这可以用你的方法`addTarget:action:forControlEvents:`来完成`UIButton`

例如：

```
[myBtn addTarget:self action:@selector(tappedButton:) forControlEvents:UIControlEventTouchUpInside]; 
```

方法 tappedButton 将与被点击的按钮一起发送消息：

```
- (void)tappedButton:(UIButton*)sender{
    // exploit the button
} 
```

在此方法中，您可以获得按钮的标题 -`myBtn.titleLabel.text`

然后，您可以创建一个新的视图控制器（让我们保持简单，假设您有自己的`UIViewController`子类`MySimpleViewController`.

在此类中，您有一个`cameFrom`属性，您可以在该属性上设置按钮的标题，在`viewDidLoad`中`MySimpleViewController`，您将获得 的属性值`cameFrom`，这可能是方法实现。

```
- (void)tappedButton:(UIButton*)sender{
    MySimpleViewController *detail = [[MySimpleViewController alloc] init];
    detail.cameFrom = sender.titleLabel.text;

    [self.navigationController pushViewController:detail 
                                         animated:YES];
    [detail release];
} 
```

所以在你的`MySimpleViewController's` `viewDidLoad`，你创建一个`UILabel`，给文本属性的值`self.cameFrom`并将其添加到视图中`addSubview:`

# html - 从第二列开始一个表格单元格

> ID：11940111
> 
> 赞同：0
> 
> 时间：2012-08-13T18:23:53.793
> 
> 标签：html

我可以有一个几行的表，其中第二行从第二列开始吗？像这样的东西：

```
+-----------+----------------+
|           |                |
|           |                |
+-----------+----------------+
            |                |
            |                |
+-----------+----------------+
|           |                |
|           |                |
+-----------+----------------+ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T18:26:28.040

你不能。但是您可以通过使用右边框和背景颜色使其看起来像这样。

工作示例：http: [//jsfiddle.net/gkuQD/](http://jsfiddle.net/gkuQD/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T18:28:39.403

你可以有：

```
<tr><td>Content1</td><td>Content2</td>
<td>&nbsp;</td><td>Content3</td>
<td>Content4</td><td>Content5</td></tr> 
```

这可能是您正在寻找的。

# jquery - 带有 AJAX 工具提示的 qTip2 不起作用

> ID：11940112
> 
> 赞同：-1
> 
> 时间：2012-08-13T18:23:54.930
> 
> 标签：jquery, qtip2

我突然在使用 qTip2 和 AJAX 时遇到了问题。该网站在几天前之前运行良好，但现在工具提示无法正常工作。

这是我正在处理的草稿页面：http: [//trenthergenrader.com/calypsis/experimental/frame2.html](http://trenthergenrader.com/calypsis/experimental/frame2.html)

页面被分成两个大小不等的框架。左边的故事有链接到作品的 wiki 中的人物、地点和事物。当您单击链接时，工具提示应该会触发并显示 wiki 项目的迷你描述和缩略图，以及指向完整 wiki 条目的链接。用户可以关闭工具提示并继续阅读，或者单击链接并离开叙述框架页面并转到 wiki。但是，现在发生的情况是链接直接指向 wiki 条目，没有工具提示。

这是带有使用工具提示的页面的框架页面：http: [//trenthergenrader.com/calypsis/experimental/Untitled-2.html](http://trenthergenrader.com/calypsis/experimental/Untitled-2.html)

我很可能没有看到一些愚蠢的编码错误，因为我真的不知道我在用 jquery 做什么。有更多经验/知识的人可以帮帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T18:41:09.040

只是猜测，您是否尝试过使用早期版本的 jQuery。不久前我有一个关于这个插件的问题，即使用旧版本的 jQ 已修复，但遗憾的是，我不记得所有细节。

# windows-phone-7 - Windows Phone 7 - 必应地图

> ID：11940113
> 
> 赞同：0
> 
> 时间：2012-08-13T18:23:55.353
> 
> 标签：windows-phone-7, bing

我有一个带有一个按钮的主页，该按钮将我的应用程序引导到另一个页面。当我单击按钮时，定向页面应该已经转到 Bing 地图上我想要的地址。但我只看到世界地图。这是第二页的代码：

```
 public BingMapPage()
    {
        InitializeComponent();

        BingMap.Mode = new RoadMode();

        BingMapsTask bmt = new BingMapsTask();

        bmt.SearchTerm = "Paris";
        bmt.Show(); 
    } 
```

上面的代码只显示世界地图。但是，如果我在主页的构造函数中编写相同的代码，它会按预期工作。此外，我尝试在第二页中创建一个方法，如下所示：

```
public void StartSearch()
    {
        BingMapsTask bmt = new BingMapsTask();

        bmt.SearchTerm = "Paris";
        bmt.Show();        
    } 
```

然后在主页面中创建了我的第二个页面的实例并调用了这个方法。它再次起作用了。

我的问题是有没有办法得到这些代码

```
bmt.SearchTerm = "Paris";
        bmt.Show(); 
```

在 Windows Phone 7 应用程序的主页之外工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T13:00:09.417

您不能将 设置`Searchterm`为巴黎。`Searchterms`是通用术语，如商店、企业、医院等。您可以尝试另一种方法。创建一个 webBrowser 控件并运行以下代码行：

`webBrowser.Navigate(new Uri("maps:<your address>"));`

这将打开 WP7 手机上指向`<your address>`. 我希望这就是你要找的。

# visual-studio - 如何在导入前计算 MSBuild 属性

> ID：11940117
> 
> 赞同：0
> 
> 时间：2012-08-13T18:24:11.763
> 
> 标签：visual-studio, msbuild

考虑这两个[MSBuild](http://en.wikipedia.org/wiki/Msbuild)文件。首先`build-script.xml`：

```
<?xml version="1.0" encoding="utf-8"?>
<!-- build-script.xml -->
<Project
    ToolsVersion="4.0"
    DefaultTargets="Build"
    xmlns="http://schemas.microsoft.com/developer/msbuild/2003">

    <PropertyGroup>
        <OutputName>OutputName</OutputName>
    </PropertyGroup>

    <Import Project="build-script-to-import.xml"/>
</Project> 
```

然后`build-script-to-import.xml`：

```
<?xml version="1.0" encoding="utf-8"?>
<!-- build-script-to-import.xml -->
<Project
    ToolsVersion="4.0"
    DefaultTargets="Build"
    xmlns="http://schemas.microsoft.com/developer/msbuild/2003">

    <PropertyGroup>
        <OutputPath>Path\$(OutputName)</OutputPath>
    </PropertyGroup>

    <Target Name="Build">
        <Message Text="$(OutputPath)" />
    </Target>
</Project> 
```

这两个文件代表一个*非常*简化的 C# 项目文件 ( `build-script.xml`)，它引用了一个公共目标文件 ( `build-script-to-import.xml`)。这意味着它不是更改`build-script-to-import.xml`文件的选项。问题是`OutputName`计算出来的，我需要在导入`build-script-to-import.xml`文件之前将它设置为这个计算值。你知道我怎么能做到这一点吗？

* * *

注意 1：计算的值实际上是一个程序集版本，我可以使用[`GetAssemblyIdentity`MSBuild 任务](http://msdn.microsoft.com/en-us/library/ms164296)从程序集文件中获取它。我看到的问题是在导入发生之前我可能不会调用目标。我想在MSBuild 任务`OutputName`的帮助下设置属性的值。`GetAssemblyIdentity`

注意 2：构建将由 Visual Studio 触发，因此我可能不会使用批处理文件并将属性作为命令行参数发送到 MSBuild。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T22:50:21.203

如果导入项目中的相应目标允许**修改`DependsOnTargets`**

```
<Target Name="Build" DependsOnTargets="@(BuildDependsOn)" /> 
```

您可以修改项目并添加您的目标，这将准备所需的属性。

如果不可能，您可以**编写包装器**来自己调用底层目标/目标（Build/Rebuild/Clean）（无需导入`build-script-to-import.xml`）：

**构建脚本.xml**

```
 <Target Name="Build" DependsOn="PrepareProperties">
      <MSBuild Projects="build-script-to-import.xml"  
               Targets="Build"            
               Properties="OutputName=$(OutputName);$(OtherProperties)"/>
 </Target> 
```

**建议**

取决于您对动态更改的要求，`OutputName`可能会有更简单的解决方案。只是不要这样做。编写您自己的自定义构建步骤以从固定输出目录复制到您的目的地，这是相当简单的，这是使用您的规则计算的。

例如，当我有一个名为**latest**的具有固定路径的目录和每个产品版本的目录时，我更喜欢练习。每个人都可以从该文件夹中获取最新版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T19:09:20.403

在“构建”目标中移动 $(OutputPath) 的声明。使用“计算”​​属性的唯一方法是让它们在目标内部进行评估。全局声明的“静态”属性将始终在任何目标运行之前进行评估，并且您可能需要运行一个目标来计算 $(OutputName) 的值。只需确保您的名称计算目标在“构建”目标之前运行。

# cakephp - 使用 cakephp google oauth 插件时出现致命错误

> ID：11940119
> 
> 赞同：0
> 
> 时间：2012-08-13T18:24:19.493
> 
> 标签：cakephp, oauth

致命错误：在第 43 行的 /var/www/cakephp/app/config/bootstrap.php 中找不到类“CakePlugin”

类 cakeplugin 存在于 /var/www/cakephp/lib/Cake/Core

在执行以下步骤后，我正在尝试将 google oauth 插件用于 cakephp 应用程序：

[https://github.com/uzyn/opauth-google/blob/master/README.md](https://github.com/uzyn/opauth-google/blob/master/README.md)

但是当我运行我的应用程序时，我得到了上面提到的致命错误，

我需要更改链接或复制插件文件吗？还是我的方法有问题？

# r - 堆积条形图

> ID：11940122
> 
> 赞同：1
> 
> 时间：2012-08-13T18:24:34.773
> 
> 标签：r, ggplot2

我从另一个类似的问题中获取了以下示例代码并尝试复制它。

```
x <- structure(list(variable = c("a", "b", "c"), f = c(0.98, 0.66, 0.34), m = c(0.75760989010989, 0.24890977443609, 0.175125)), .Names = c("variable","f", "m"), row.names = c(NA, 3L), class = "data.frame")

> x
  variable    f         m
1        a 0.98 0.7576099
2        b 0.66 0.2489098
3        c 0.34 0.1751250 
```

当示例运行以下代码时：

```
ggplot(x, aes(variable, f,label=variable)) + 
  geom_bar() + geom_bar(aes(variable, m), fill="purple") 
```

以下堆积条形字符显示...

![在此处输入图像描述](../Images/3073b1abaf2c5527ad40af94ad2ef5ba.png)

* * *

轮到我了！以下是数据的数据框

```
> data
               asset.std           asset.dstd symbols
IEF  0.00470368279997122  0.00477691934631662     IEF
SPY   0.0119358320227236   0.0130162006829043     SPY
GSG   0.0137798134700255   0.0147096635302501     GSG
VNQ    0.016058588692544   0.0169327904112519     VNQ
TLT   0.0108803682930942   0.0109165197621356     TLT
SHY 0.000635574928974698 0.000676146828833939     SHY 
```

我运行以下代码

```
ggplot(data, aes(symbols, asset.std, label=symbols))+
  geom_bar() +   geom_bar(aes(symbols, asset.dstd),fill="blue") 
```

而我得到了这个……嗯？ ![在此处输入图像描述](../Images/daaea914b2521656e70dda77a3b118ce.png)

我在我的 ggplot2 代码中遗漏了什么吗？任何事情都会有所帮助

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-13T19:48:30.077

几点。首先，我认为你`data`的不是你想的那样；`asset.std`和/或`asset.dstd`看起来它们是因素而不是数字。如果您查看`str(data)`，您可能会发现这些变量是因子。如果我将数据读入并绘制出来，我会得到不同的结果。

```
data <- read.table(text=
"               asset.std           asset.dstd symbols
IEF  0.00470368279997122  0.00477691934631662     IEF
SPY   0.0119358320227236   0.0130162006829043     SPY
GSG   0.0137798134700255   0.0147096635302501     GSG
VNQ    0.016058588692544   0.0169327904112519     VNQ
TLT   0.0108803682930942   0.0109165197621356     TLT
SHY 0.000635574928974698 0.000676146828833939     SHY", header=TRUE)

ggplot(data, aes(symbols, asset.std, label=symbols))+
  geom_bar() +   geom_bar(aes(symbols, asset.dstd),fill="blue") 
```

![在此处输入图像描述](../Images/1a7783dbb38e5f4169230c01f20b7414.png)

使用`dput`（如您引用的示例中）的输出可以消除该问题。

```
data <-
structure(list(asset.std = c(0.00470368279997122, 0.0119358320227236, 
0.0137798134700255, 0.016058588692544, 0.0108803682930942, 0.000635574928974698
), asset.dstd = c(0.00477691934631662, 0.0130162006829043, 0.0147096635302501, 
0.0169327904112519, 0.0109165197621356, 0.000676146828833939), 
    symbols = structure(c(2L, 4L, 1L, 6L, 5L, 3L), .Label = c("GSG", 
    "IEF", "SHY", "SPY", "TLT", "VNQ"), class = "factor")), .Names = c("asset.std", 
"asset.dstd", "symbols"), class = "data.frame", row.names = c("IEF", 
"SPY", "GSG", "VNQ", "TLT", "SHY")) 
```

其次，正如@mrdwab 所说，这不是堆积条形图。这只是在彼此顶部绘制的两组条。第一个绘制的集合较小，因此被第二个集合完全隐藏。使条形部分透明使这一点变得明显。

```
ggplot(data, aes(symbols, asset.std, label=symbols))+
  geom_bar(alpha=0.25) + 
  geom_bar(aes(symbols, asset.dstd),fill="blue", alpha=0.25) 
```

![](../Images/5b31cafe3af62a8da43de329b7f5810f.png)

如果您真的想要堆叠条形图，请融化数据然后绘制它。

```
library("reshape2")
ggplot(melt(data, id.vars="symbols"),
       aes(symbols, value, fill=variable)) +
  geom_bar() 
```

![在此处输入图像描述](../Images/4acacc804abdd5adff1fff9e6ead5a37.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-13T19:45:09.123

看着你的对象`data`：

```
DF[1] - DF[2]
#         asset.std
# IEF -7.323655e-05
# SPY -1.080369e-03
# GSG -9.298501e-04
# VNQ -8.742017e-04
# TLT -3.615147e-05
# SHY -4.057190e-05 
```

在所有情况下，`asset.std`小于`asset.dstd`; 因此，如果您`asset.std`首先绘制，当您在其上绘制第二列时，您将完全掩盖第一个情节！

要复制您提供的示例，请先绘制`asset.dstd`：

```
ggplot(DF, aes(symbols, asset.dstd, label=symbols)) + 
  geom_bar(fill="red") + 
  geom_bar(aes(symbols, asset.std), fill="blue", position="stack") 
```

但是请注意，这*并不是*一个常用术语意义上的堆积条形图。

# mysql - 防止数据库中的重复表条目

> ID：11940133
> 
> 赞同：0
> 
> 时间：2012-08-13T18:25:19.453
> 
> 标签：mysql, database, duplicates, create-table

我正在尝试为每家公司及其信息的记录创建新表。为此，我使用了简单的 Create 查询。有什么办法可以防止重复表吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T18:29:15.550

在我知道的每个数据库中，都不允许重复的表名。在某些情况下，还有第三个元素，模式，但我假设一切都在同一个模式中。

换句话说，尝试创建副本会导致错误。试试看。

顺便说一句，您应该始终使用您正在使用的数据库标记您的问题。

# php - 如何使用 php 从远程 url 获取 cookie 列表

> ID：11940134
> 
> 赞同：-1
> 
> 时间：2012-08-13T18:25:18.917
> 
> 标签：php, cookies, curl

有谁知道我如何使用 php 获取外部 URL 的 cookie 列表？

我认为这可以用 cURL 来完成？

例如，当我使用 cookiejar 或 get_headers 时，我只看到一个 cookie（PHPSESSID）。但是当您打开 chrome 控制台 (F12) 并转到 cookie 存储时，您会看到一个更大的列表。还有例如谷歌分析cookies。我希望能够显示该 cookie 列表。第三方饼干也是如此..

有什么方法可以检索这些 cookie 吗？也许将它们临时存储或其他？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T18:30:37.607

如果我说得对，并且您的意思是获取页面在访问时设置的 cookie `cURL`，
您可以使用( [curl_setopt](http://www.php.net/manual/en/function.curl-setopt.php)`CURLOPT_COOKIEJAR` )的选项`cURL`来自动管理 cookie ： `cURL`

```
$ch = curl_init($url);  
curl_setopt($ch, CURLOPT_HEADER, 1); 
curl_setopt($ch, CURLOPT_COOKIEJAR, "cookie.txt");
curl_setopt($ch, CURLOPT_COOKIEFILE, "cookie.txt");
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);

$cont = curl_exec ($ch);  
curl_close ($ch); 
```

或搜索响应标题`Set-Cookie:`行：
[如何将 php curl 中的 cookie 获取到变量中](https://stackoverflow.com/questions/895786/how-to-get-the-cookies-from-a-php-curl-into-a-variable)

# r - 带有调优和交叉验证的随机森林优化

> ID：11940141
> 
> 赞同：3
> 
> 时间：2012-08-13T18:25:36.910
> 
> 标签：r, machine-learning, data-mining, random-forest

我正在处理一个大型数据集，因此希望删除无关变量并调整每个分支的最佳 m 变量。在 R 中，有两种方法，rfcv 和 tuneRF，可以帮助完成这两个任务。我正在尝试将它们组合起来以优化参数。

rfcv 的工作原理大致如下：

```
create random forest and extract each variable's importance;
while (nvar > 1) {
    remove the k (or k%) least important variables;
    run random forest with remaining variables, reporting cverror and predictions
} 
```

目前，我已将 rfcv 重新编码为如下工作：

```
create random forest and extract each variable's importance;
while (nvar > 1) {
    remove the k (or k%) least important variables;
    tune for the best m for reduced variable set;
    run random forest with remaining variables, reporting cverror and predictions;
} 
```

当然，这会将运行时间增加一个数量级。我的问题是这是多么必要（使用玩具数据集很难得到一个想法），以及是否可以预期任何其他方式在更短的时间内大致同样有效。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-13T23:49:18.580

与往常一样，答案是取决于数据。一方面，如果没有任何不相关的特征，那么您可以完全跳过特征消除。随机森林实现中的树构建过程已经尝试选择预测特征，这为您提供了一些针对无关特征的保护。

Leo Breiman 发表了一次演讲，他将 1000 个不相关的特征引入到一些医学预测任务中，而这些任务只有少数来自输入域的真实特征。当他使用一个变量重要性过滤器消除 90% 的特征时，随机森林的下一次迭代没有选择任何不相关的特征作为其树中的预测变量。

# excel - 另一个工作表中的 VLookup 范围动态

> ID：11940142
> 
> 赞同：0
> 
> 时间：2012-08-13T18:25:37.190
> 
> 标签：excel, excel-formula, vba

我正在尝试使用一个允许我从以前的工作表中导入范围的函数。我不确定我当前的宏是否允许这样做。我可以手动调用上一个工作表，但不能使用我拥有的功能。

这是我手动输入工作表名称时可以正常工作的功能：

```
=IFERROR(VLOOKUP(D3,Aug9Daily!$D$3:$F$50,3, FALSE),"") 
```

这是我尝试使用的功能：

```
=IFERROR(VLOOKUP(D3,NextSheetName()$D$3:$F$50,3, FALSE),"") 
```

这是我用于 NextSheetName 宏的 VBA：

```
Function NextSheetName(Optional WS As Worksheet = Nothing) As String
    Application.Volatile True
    Dim S As String
    Dim Q As String
    If IsObject(Application.Caller) = True Then
        Set WS = Application.Caller.Worksheet
        If WS.Index = WS.Parent.Sheets.Count Then
            With Application.Caller.Worksheet.Parent.Worksheets
                Set WS = .Item(1)
            End With
        Else 
            Set WS = WS.Next
        End If
        If InStr(1, WS.Name, " ", vbBinaryCompare) > 0 Then
            Q = "'"
        Else
            Q = vbNullString
        End If
    Else
        If WS Is Nothing Then
           Set WS = ActiveSheet
        End If
        If WS.Index = WS.Parent.Worksheets.Count Then
            With WS.Parent.Worksheets
               Set WS = .Item(1)
            End With
        Else
            Set WS = WS.Next
        End If
        Q = vbNullString
    End If
    NextSheetName = Q & WS.Name & Q
End Function 
```

我究竟做错了什么？有没有更好的方法从另一个工作表中动态选择一个范围？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T18:30:05.397

试试这个，看看它是否适合你修复你的函数的输出：

```
NextSheetName =  Q & WS.Name & Q & "!" 
```

然后你需要在一个间接函数中连接输出，如下所示：

```
=IFERROR(VLOOKUP(D3,INDIRECT(NextSheetName() & "$D$3:$F$50"),3, FALSE),"") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-22T21:23:07.103

我发现这个小 UDF 很方便：

```
Function sheet_offset(rng As Range, i As Integer) As Range
    Application.Volatile 'necessary since value can change even when values of parameters do not
    Set sheet_offset = rng.Worksheet.Parent.Worksheets.Item(rng.Worksheet.Index + i).Range(rng.Address)
End Function 
```

将 rng 偏移 i 个工作表 - 例如，i=0 表示同一工作表，i=-1 表示上一个工作表，而 i=1 表示下一个工作表。

在您的示例中，您将使用：

```
IFERROR(VLOOKUP(D3,sheet_offset($D$3:$F$50,1),3, FALSE),"") 
```

这将偏移范围以引用下一个工作表。

请注意，要相对于当前工作表（如您的工作表）进行引用，您不会指定工作表。要进行绝对引用，只需在引用中指定一个工作表（例如 'Sheet1'!$D$3:$F$50），它就会成为您的原点（当 i=0 时引用的工作表）

# java - 无法使用 update() 调用 onDraw(Canvas canvas)

> ID：11940149
> 
> 赞同：0
> 
> 时间：2012-08-13T18:26:13.493
> 
> 标签：java, android, android-canvas, ondraw, invalidation

我目前正在开发 android 并遇到了一个非常严重的问题：

```
@Override
protected void onDraw(Canvas canvas) {
    super.onDraw(canvas);
    Log.i("GAME", "onDraw Called");
    for(int i = 0; i < totalEggNumbers -1; i++) {
        if (egg[i].isKilled = false)
        canvas.drawBitmap(image[egg[i].getEggNum()], egg[i].getX(), egg[i].getY() + 100, paint);
        Log.i("GAME", "Something Drawn");
    }
}

// called by thread
public void update() {
        //Chance to make egg
    Log.i("GAME", "Updated Game");
    eggMaker.randomEgg(difficulty);
    postInvalidate();
} 
```

永远不会被调用，`onDraw`并且在我终止应用程序后我无法在 logcat 中找到日志，但是当它运行时，我可以看到一个“onDraw Called”出现并偶尔消失。

我真的很绝望......我正在使用android view btw。有什么方法可以调用该`onDraw`方法吗？我试过`invalidate();`了，没有机会，请修改我的代码:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T18:52:26.553

尝试将您的图像作为 BitMap 对象，然后再将其传递给 drawBitMap 方法

```
Bitmap bmp = BitmapFactory.decodeResource(
        getResources(), image[egg[i].getEggNum()); 
```

# algorithm - 布尔回归或类似算法

> ID：11940152
> 
> 赞同：1
> 
> 时间：2012-08-13T18:26:21.997
> 
> 标签：algorithm, boolean, artificial-intelligence, linear-regression

我正在寻找一组值，然后基于该组返回一个布尔值。类似于线性回归，但只返回一个布尔值。我正在寻找一个布尔回归模型还是完全不同的东西？我对它进行了一些搜索，但没有找到太多。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T18:31:22.650

你想要的是[分类](http://en.wikipedia.org/wiki/Classification_in_machine_learning)，它给定输入从一组固定的值中返回一个值（无论是 100 个值还是只有 2 个值，如布尔分类的情况）。`Regression`如果要预测实值输出，则使用。

# forms - Disable Firefox autocomplete?

> ID：11940160
> 
> 赞同：0
> 
> 时间：2012-08-13T18:26:48.540
> 
> 标签：forms, firefox

For a reason I cannot determine, the password field is being populated when the form is submitted. This only happens in Firefox.

This is my form.

```
<form action="index.php/admin/settings/account" autocomplete="off" method="post">
  <section>
    <label for="email">Email</label>
    <input type="text" name="email" value="test@test.com" autocomplete="off" />                     
  </section>
  <section>
    <label for="password">Password</label>
    <input type="password" name="password" value="******" autocomplete="off" />                     
  </section>
  <section>
    <label for="confirm_password">Confirm Password</label>
    <input type="password" name="confirm_password" value="******"  />                       
  </section>
  <section>
    <input type="submit" name="save" value="Save"  />
  </section>
</form>
<script>
    console.log($('input[name="password"]').val());
    $('form').submit(function(e) {
        e.preventDefault();
        console.log($('input[name="password"]').val());
    });
</script> 
```

As you can see. I have set the `autocomplete="off"` on both the form and the relevant fields. If I save the form without making changes. Autocomplete doesn't fire.

If I change the email address to an email with a saved password the password is changed when the form is submitted.

This is what I get in the console.

Firefox.

```
******
123123 
```

Chrome

```
******
****** 
```

Has anyone come across this before? How do I stop this?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T18:31:03.157

Is there a reason you're not setting autocomplete="off" in the confirm password section? It seems to be the only section that you're not explicitly disabling that property.

# java - ArrayList 和 Concurrent HashMap 并发修改异常

> ID：11940163
> 
> 赞同：0
> 
> 时间：2012-08-13T18:26:58.453
> 
> 标签：java

以下是我存储数据的数据结构和更新数据的方法。

```
ConcurrentHashMap<String, MyOrder> myOrder = new ConcurrentHashMap<String, MyOrder>();

public void updateOrder(MyData DR) {
      MyOrder Orderlist = myOrder.get(DR.keyID);
      Orderlist.getCanceled().add(DR);
      if (Orderlist.getCanceled().size() == 10) {
          Orderlist.getCanceled().remove(0);
      }

      /* remove order when cancelled */
      Iterator<MyData> itr = Orderlist.getNewOrder().iterator();
      MyData drm = null;
      while (itr.hasNext()) {
          drm = itr.next();
          if (drm.ClOrdID.equalsIgnoreCase(DR.ClOrdID)) {
              Orderlist.getNewOrder().remove(drm); 
              getTable().get(drm.InsKey).getCompOrder().remove(drm);
              break;
          }
      }
} 
```

我有以下方法，每秒通过轮询访问，以显示通过上述并发哈希映射检索的网页中的一些数据，该哈希映射也会不时更新数据，并在订单被删除时更新。

```
/* accessed for data display every second */
public List<MyOrder> getMyDataList(String keyID) {
    List<MyOrder> orderList = new ArrayList<MyOrder>();
    try {
        if (myOrder.containsKey(keyID)) {
            orderList.add(myOrder.get(keyID));
        }
    } catch (Exception e) {
        e.printStackTrace();
    }
    return orderList;
} 
```

我的问题是当方法同时执行一段时间时，它会给出以下并发修改异常，我该如何克服这个问题？申请这个的最佳解决方案是什么？异常指向上述方法“getMyDataList”

```
Faces Servlet]] Servlet.service() for servlet Faces Servlet threw exception: java.util.ConcurrentModificationException
at java.util.AbstractList$Itr.checkForComodification(Unknown Source) [:1.6.0_22]
at java.util.AbstractList$Itr.next(Unknown Source) [:1.6.0_22]
at com.google.gson.DefaultTypeAdapters$CollectionTypeAdapter.serialize(DefaultTypeAdapters.java:637) [:]
at com.google.gson.DefaultTypeAdapters$CollectionTypeAdapter.serialize(DefaultTypeAdapters.java:624) [:]
at com.google.gson.JsonSerializationVisitor.findAndInvokeCustomSerializer(JsonSerializationVisitor.java:184) [:]
at com.google.gson.JsonSerializationVisitor.visitFieldUsingCustomHandler(JsonSerializationVisitor.java:204) [:]
at com.google.gson.ReflectingFieldNavigator.visitFieldsReflectively(ReflectingFieldNavigator.java:63) [:]
at com.google.gson.ObjectNavigator.accept(ObjectNavigator.java:120) [:]
at com.google.gson.JsonSerializationContextDefault.serialize(JsonSerializationContextDefault.java:62) [:]
at com.google.gson.JsonSerializationContextDefault.serialize(JsonSerializationContextDefault.java:53) [:]
at com.google.gson.DefaultTypeAdapters$CollectionTypeAdapter.serialize(DefaultTypeAdapters.java:643) [:]
at com.google.gson.DefaultTypeAdapters$CollectionTypeAdapter.serialize(DefaultTypeAdapters.java:624) [:]
at com.google.gson.JsonSerializationVisitor.findAndInvokeCustomSerializer(JsonSerializationVisitor.java:184) [:]
at com.google.gson.JsonSerializationVisitor.visitUsingCustomHandler(JsonSerializationVisitor.java:160) [:]
at com.google.gson.ObjectNavigator.accept(ObjectNavigator.java:101) [:]
at com.google.gson.JsonSerializationContextDefault.serialize(JsonSerializationContextDefault.java:62) [:]
at com.google.gson.JsonSerializationContextDefault.serialize(JsonSerializationContextDefault.java:53) [:]
at com.google.gson.Gson.toJsonTree(Gson.java:220) [:]
at com.google.gson.Gson.toJson(Gson.java:260) [:]
at com.google.gson.Gson.toJson(Gson.java:240) [:]
at com.company.jsf.order.MyBean.myOrdersData(MyBean.java:488) [:]
at sun.reflect.GeneratedMethodAccessor342.invoke(Unknown Source) [:1.6.0_22]
at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source) [:1.6.0_22]
at java.lang.reflect.Method.invoke(Unknown Source) [:1.6.0_22]
at org.apache.el.parser.AstValue.invoke(AstValue.java:196) [:6.0.0.Final]
at org.apache.el.MethodExpressionImpl.invoke(MethodExpressionImpl.java:276) [:6.0.0.Final]
at com.sun.faces.facelets.el.TagMethodExpression.invoke(TagMethodExpression.java:102) [:2.0.3-FCS]
at com.sun.faces.facelets.tag.jsf.core.DeclarativeSystemEventListener.processEvent(EventHandler.java:124) [:2.0.3-FCS]
at javax.faces.component.UIComponent$ComponentSystemEventListenerAdapter.processEvent(UIComponent.java:2378) [:2.0.3-FCS]
at javax.faces.event.SystemEvent.processListener(SystemEvent.java:102) [:2.0.3-FCS]
at com.sun.faces.application.ApplicationImpl.processListeners(ApplicationImpl.java:2040) [:2.0.3-FCS]
at com.sun.faces.application.ApplicationImpl.invokeComponentListenersFor(ApplicationImpl.java:1988) [:2.0.3-FCS]
at com.sun.faces.application.ApplicationImpl.publishEvent(ApplicationImpl.java:284) [:2.0.3-FCS]
at com.sun.faces.application.ApplicationImpl.publishEvent(ApplicationImpl.java:242) [:2.0.3-FCS]
at com.sun.faces.lifecycle.RenderResponsePhase.execute(RenderResponsePhase.java:104) [:2.0.3-FCS]
at com.sun.faces.lifecycle.Phase.doPhase(Phase.java:97) [:2.0.3-FCS]
at com.sun.faces.lifecycle.LifecycleImpl.render(LifecycleImpl.java:135) [:2.0.3-FCS]
at javax.faces.webapp.FacesServlet.service(FacesServlet.java:309) [:2.0.3-FCS]
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:324) [:6.0.0.Final]
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:242) [:6.0.0.Final]
at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:343) [:]
at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:109) [:]
at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:83) [:]
at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:355) [:]
at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:97) [:]
at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:355) [:]
at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:100) [:]
at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:355) [:]
at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:78) [:]
at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:355) [:]
at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:54) [:]
at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:355) [:]
at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:35) [:]
at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:355) [:]
at org.springframework.security.web.authentication.www.BasicAuthenticationFilter.doFilter(BasicAuthenticationFilter.java:177) [:]
at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:355) [:]
at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:187) [:]
at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:355) [:]
at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:105) [:]
at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:355) [:]
at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:79) [:]
at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:355) [:]
at org.springframework.security.web.session.ConcurrentSessionFilter.doFilter(ConcurrentSessionFilter.java:109) [:]
at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:355) [:]
at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:149) [:]
at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:237) [:3.0.0.RELEASE]
at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:167) [:3.0.0.RELEASE]
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:274) [:6.0.0.Final]
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:242) [:6.0.0.Final]
at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:275) [:6.0.0.Final]
at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191) [:6.0.0.Final]
at org.jboss.web.tomcat.security.SecurityAssociationValve.invoke(SecurityAssociationValve.java:181) [:6.0.0.Final]
at org.jboss.modcluster.catalina.CatalinaContext$RequestListenerValve.event(CatalinaContext.java:285) [:1.1.0.Final]
at org.jboss.modcluster.catalina.CatalinaContext$RequestListenerValve.invoke(CatalinaContext.java:261) [:1.1.0.Final]
at org.jboss.web.tomcat.security.JaccContextValve.invoke(JaccContextValve.java:88) [:6.0.0.Final]
at org.jboss.web.tomcat.security.SecurityContextEstablishmentValve.invoke(SecurityContextEstablishmentValve.java:100) [:6.0.0.Final]
at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127) [:6.0.0.Final]
at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102) [:6.0.0.Final]
at org.jboss.web.tomcat.service.jca.CachedConnectionValve.invoke(CachedConnectionValve.java:158) [:6.0.0.Final]
at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109) [:6.0.0.Final]
at org.jboss.web.tomcat.service.request.ActiveRequestResponseCacheValve.invoke(ActiveRequestResponseCacheValve.java:53) [:6.0.0.Final]
at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:362) [:6.0.0.Final]
at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:877) [:6.0.0.Final]
at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:654) [:6.0.0.Final]
at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:951) [:6.0.0.Final]
at java.lang.Thread.run(Unknown Source) [:1.6.0_22] 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-13T18:28:29.420

迭代时不要在 list 上调用 remove，这可能会导致并发修改异常。

```
Orderlist.getNewOrder().remove(drm); 
```

在迭代器上调用 remove。

```
itr.remove() 
```

# java - 将 JVM 嵌入到微控制器中

> ID：11940169
> 
> 赞同：3
> 
> 时间：2012-08-13T18:27:19.123
> 
> 标签：java, jvm, embedded, microcontroller

我是嵌入式世界的新手。可能是我错了。但我想要一个相关的解决方案。

我只想将java环境嵌入到MCU中，以便于开发应用程序。MCU 供应商提供了用于 lcd、sensor、spi、button、UART、DIO 等的 C 库。我可以将 java 嵌入其中吗？我的意思是，我想在那些设备驱动程序上使用 MCU 上的 java。

我可以使用或制作这样的东西吗？

我见过简单的[Real-Time-Java](http://www.rtjcom.com)，它非常小。

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-14T09:41:40.987

看看**[NanoVM](http://www.harbaum.org/till/nanovm/index.shtml)**和**[Bajos](http://code.google.com/p/bajos/)**。

# android - 如何实现自定义自动完成文本视图android

> ID：11940170
> 
> 赞同：0
> 
> 时间：2012-08-13T18:27:20.700
> 
> 标签：android, autocomplete, textview

我想实现自动完成文本视图，但有自己的规则和限制

例如，如果我输入：“allo”并且适配器有：“akkgg”、“gggallop”、“aaaa”，结果将是“gggallop”

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T18:38:54.187

您可以查看 Apidemos AutoComplete4 示例。它有一个自定义过滤。您将不得不使用适配器的 runQueryOnBackgroundThread 并更改其行为

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T18:38:59.087

看看这篇文章：[http](http://techdroid.kbeanie.com/2010/04/custom-autocomplete-for-android.html) ://techdroid.kbeanie.com/2010/04/custom-autocomplete-for-android.html 希望有帮助！

# svn - TortoiseSVN 应用补丁错误

> ID：11940172
> 
> 赞同：16
> 
> 时间：2012-08-13T18:27:29.000
> 
> 标签：svn, version-control, tortoisesvn, patch

我正在尝试应用补丁，但我收到一条空白错误消息（其中没有文本或任何内容）。我有最新版本的 TortoiseSVN。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-20T13:57:17.100

我有同样的问题，如果你从修订版创建了补丁，使用“将更改显示为统一差异”，检查你的补丁文件中的路径，这个是正确的：

文件夹/文件名.cs

但是这个（使用绝对路径）会导致问题：

c:/文件夹/文件名.cs

只需将绝对路径转换为相对路径。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-06-27T20:30:18.893

[Having a look here](http://tortoisesvn.tigris.org/ds/viewMessage.do?dsForumId=757&dsMessageId=3005335), seems to be 3 possible root causes to this empty error svn patch issue:

> *   the patch file is empty (or is invalid so the patch data appears to be empty)
>     
>     
> *   the patch is not applied to the correct directory (auto-dir-search works on trunk now)
>     
>     
> *   the patch file uses absolute paths instead of relative ones (trunk already strips such paths automatically)

first is probably not yours, most probably you ought to use relative path instead of absolute one

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-02-18T21:05:58.027

我一直收到这个消息。这通常是因为我在 Windows 资源管理器中单击鼠标右键以访问 tortoise 日志。当您在此上下文中使用“将差异显示为统一差异”时，生成的补丁将包含相对于您的计算机的绝对位置，例如“c:\source\”。如果您尝试将此补丁应用到另一个目录，则会失败。

解决方案是使用 Tortoise 的存储库浏览器，然后使用此上下文中的“显示日志”菜单。生成的补丁将具有相对位置，您将能够在匹配相对路径的任何位置应用这些补丁。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-06-11T10:29:06.810

我也遇到了这个问题，并通过更改补丁文件中的路径来修复它。就我而言，我只需要修补一个文件。出现问题是因为在我的情况下，我从审查委员会创建了补丁文件，该文件创建了具有完整链接路径的文件。INDEX /home/pushpendra/...something/file.c (revision some_rev)

所以我将这一行替换为：

INDEX file.c (revision some_rev) 然后右击这个文件然后应用补丁。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-07-22T17:17:34.317

如果创建补丁的版本和应用补丁的版本不同，则无法应用补丁。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-08-28T05:14:49.913

我遇到过同样的问题。

问题是：

*   **我检查了**：一些/疯狂/路径
*   **该补丁适用于**：this/is/some/crazy/path

不知何故，乌龟无法应用补丁，所以我在更高的级别上检查了它，它起作用了。

# javascript - 将参数传递给 Raphael customAttributes 方法

> ID：11940175
> 
> 赞同：0
> 
> 时间：2012-08-13T18:27:35.060
> 
> 标签：javascript, raphael

我[在 Raphaeljs 创建 customAttributes](http://raphaeljs.com/reference.html#Paper.customAttributes)。我正在尝试将其他参数传递给 animate 方法——这些参数不应随着每次调用而增加。

目前，我正在使用 Element.data() 方法，但这很容易出现一些严重的问题，因为它本质上是全局的，并且无法同时对多个动画进行排队（幅度总是代表排队的最后一个动画）。

我显然无法在这个角落思考。

[这是我现在正在做的事情](http://jsfiddle.net/katowulf/PP669/3/)：

```
var paper = new Raphael(document.getElementById('paper'), 500, 500);

// draw a line for reference
paper.path('M100,100 l300,0').attr({stroke: 'black', 'stroke-width': 1, opacity: .5});

/**
 * move a graphic, but with some swagger
 *
 * @param {number} step the raphael increment
 * @param {int}    magnitude a fixed number representing the amount of swagger to apply
 */
paper.customAttributes.swagger = function(step) {
    var mag = this.data('magnitude');
    var x = 0;
    var y = mag*Math.sin(step);
    return { transform: 't' + x + ',' + y };
}

var rect = paper.rect(100,100, 50,50).attr({
    fill: 'red',
    swagger: [0,0]  // initialize swagger so we avoid the nasty NaN issue
}) 
.data('magnitude', 100); // declare our additional argument, other ways to do this?

rect.animate({
    swagger: [10]
}, 1000); 
```

​</p>

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T22:44:57.473

你为什么不也接受`customAttributes`这个？

只需创建自定义属性

```
paper.customAttributes.magnitude = function() {}; // that's enough 
```

然后在您的其他自定义属性中使用它

```
this.attr('magnitude'); 
```

[](http://jsfiddle.net/PP669/5/)**这是一个使用多个动画[**的小提琴**](http://jsfiddle.net/PP669/5/)`.customAttributes`而不是`.data`**

# jquery - 用 .animate() 替换这个 jquery .css() 函数

> ID：11940176
> 
> 赞同：1
> 
> 时间：2012-08-13T18:27:39.593
> 
> 标签：jquery, jquery-animate

我有这个代码。

```
jQuery("#box").bind('mousemove', function(e){
       jQuery(".mousetail").css('background-position-x', (e.pageX - this.offsetTop - 437)+'px');
}); 
```

这使mousetail跟随光标。但是当我把鼠标放在盒子上（远离鼠尾）时，鼠尾会立即出现在那个位置。我希望它通过动画到达那里。此外， background-position-x 似乎在 Firefox 中不起作用。有人可以告诉我`background-position:0px *based on co-ord*`在代码中使用的正确方法（我不知道正确的语法）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T18:31:37.140

语法非常相似，它接受一个`CSS`参数，然后是一个持续时间参数，然后是一个回调（动画完成时执行什么）

```
jQuery(".mousetail").animate({
  'background-position-x' : (e.pageX - this.offsetTop - 437)+'px' //Use Colon instead of comma
  }, 300, //This number sets the duration of the animation
  function() {alert('animation complete!');} //Callback function
); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T18:31:24.380

你试过这个吗？

```
jQuery("#box").bind('mousemove', function(e){
   jQuery(".mousetail").animate({'background-position-x': (e.pageX - this.offsetTop - 437)+'px'});
}); 
```

# peoplesoft - 使用 Peoplesoft 查询从 PeopleSoft 中的表中选择最近的日期（Max() 不起作用）

> ID：11940179
> 
> 赞同：1
> 
> 时间：2012-08-13T18:27:56.893
> 
> 标签：peoplesoft, peoplesoft-query

我正在使用 Peoplesoft 查询管理器在 people soft 中构建查询。

我正在尝试从日期列中提取最近的日期。我尝试使用 max() 作为表达式，但是，查询不提取任何记录。我已经与另一位同事核实过，他们从未能够使用 max() 提取记录。

有没有其他方法或解决方法来提取最新记录？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T13:50:08.077

So I figured out why no results were returned when using Max in a subquery. It was more from a lack of understanding PeopleSoft and SQL since I am relatively new to it. When I was setting the date column in the subquery as max for the aggregate to be used as criteria to compare to the date column in the main query I didn't make any criteria in the subquery. This meant that the subquery would go through all dates for all employees except for the employee that I was specifying in a prompt and returning a value that didn't match any of the dates for the employee in the main query and returning no one. This was fixed by setting a criteria in the subquery that the employee ID that had to be searched in the subquery matched the one that was typed into the prompt in the main query

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T05:03:35.373

使用生效日期来获取最近的日期，最大值在 PeopleSoft 中可能无法正常工作。查询应有效日期

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-21T05:59:37.567

在使用 PSQuery 时使用生效日期进行此类搜索。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-01-17T05:44:10.173

PS Query has built in filters for EFFDT tables. When you add a criteria on the EFFDT field, there are some additional drop down choices on the "condition type" field like 'Eff Date <' and 'Eff Date <=', etc. Usually, when you create a query for an Effective dated table, PS Query will automatically add the subquery based on the 'Eff Date <=' condition type.

# javascript - 谷歌分析跟踪

> ID：11940182
> 
> 赞同：0
> 
> 时间：2012-08-13T18:28:07.200
> 
> 标签：javascript, google-analytics, browser-history

我想从浏览器栏中删除谷歌分析 URL 跟踪代码，这样当用户复制/粘贴 URL 以共享时，他们不会随身携带所有跟踪数据，这既无用又能够歪曲数据在路上。

所以我使用 history.js 运行 replaceState 基本上在短暂的暂停后从 URL 中删除跟踪数据。

```
<script type="text/javascript">
setTimeout(function() {
    if( window.location.search.indexOf( "utm_campaign" ) >= 1 ) {
        window.history.replaceState( null, document.title, window.location.pathname);
    }
}, 1000 );
</script> 
```

有没有人看到这种方法有任何可能的并发症或问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-08-27T01:38:59.537

您可能遇到的唯一问题是，在您的超时代码运行时，Google Analytics（分析）可能尚未完全加载。

借助 Google Analytics 跟踪器，有一个 API 可以让函数在 GA 数据发送到 Google 后排队。

你可以这样做：

```
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-XXXXX-X']);
_gaq.push(['_trackPageview']);
_gaq.push(function() {
  var newPath = location.pathname + location.search.replace(/[?&]utm_[^?&]+/g, "").replace(/^&/, "?") + location.hash;
  if (history.replaceState) history.replaceState(null, '', newPath);
});

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})(); 
```

注意第 4 行，其中一个函数被推送到 _gaq 对象。

此函数将在 GA 请求发送后直接替换 URL。

# javascript - javascript画布弹出窗口

> ID：11940184
> 
> 赞同：0
> 
> 时间：2012-08-13T18:28:17.993
> 
> 标签：javascript, html, css

我有个疑问。如何移动上面的弹出窗口查找atm位置。我通过更改 html 结构进行了尝试，但它不起作用。

[这是一个例子](http://jsfiddle.net/rajkumart08/s6hBG/18/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T20:29:46.303

你不需要使用 Javascript，CSS 就可以了。您需要创建一个单独的 div，您可以通过单击“搜索 ATM”链接来显示和隐藏它。下面是使用 CSS 显示和隐藏 div 的详细方法：

[http://www.devinrolsen.com/css-hide-and-display-content/](http://www.devinrolsen.com/css-hide-and-display-content/)

# macos - 准备 .dmg 文件时，有没有办法合并冗余文件？

> ID：11940188
> 
> 赞同：1
> 
> 时间：2012-08-13T18:28:39.967
> 
> 标签：macos, dmg, hardlink

我的公司提供了一个包含几个基于 Qt 的 MacOS/X GUI 应用程序的软件包；该软件包以 .dmg 文件的形式提供，“安装”包括双击 .dmg 图标，然后将一个或多个应用程序图标拖到他想要保留它们的位置（例如，拖到他自己的 Applications 文件夹）。

这很好用，但是 .dmg 文件相当大（例如 40+MB），如果可能的话，我想减小它的大小，以减少下载它所需的时间。我注意到的一件事是，包中的应用程序都有大量共同的大文件（Qt 库、图形资源文件等），目前我们在 blah.xml 中包含每个文件的单独副本。每个包含的应用程序的 app/Contents 文件夹——大概这就是 .dmg 文件如此之大的原因。

所以我的问题是，有没有办法修改 .dmg 使其不需要包含这些文件的多个副本，因此不是那么大？理想情况下，我希望这样做不需要用户运行特殊的安装程序，并且如果用户将它们移动到不同的（或意外的）文件夹或删除它们中的任何一个，也不会导致任何应用程序中断。

这似乎是硬链接的理想应用程序 - 即准备 .dmg 文件的输入，以便一个应用程序包含实际文件，而其他应用程序包含到这些文件的硬链接，以便在用户之后从 .dmg 文件中解压应用程序，文件在逻辑上保持相互独立（特别是如果用户移动或删除应用程序 A，应用程序 B 不会停止工作）。但是 AFAICT MacOS/X 不支持未命名为 Time Machine 的应用程序的硬链接 [编辑：到目录]。:^(

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T04:39:40.183

（回答我自己的问题感觉有点不道德，但既然我找到了解决方案，我还是会这样做，而不是让问题悬而未决）

解决方案是在运行 hdiutil 创建 .dmg 文件之前，将重复文件替换为第一次遇到的文件的硬链接。我使用我为此目的编写的一个简单的 C++ 程序来做到这一点（只是因为我很固执），但也有许多免费软件程序，例如[freedup](http://en.wikipedia.org/wiki/Freedup)可以为你做这件事。我没有尝试过，但我想它们都可以正常工作。

# django - django 表单名称标签

> ID：11940189
> 
> 赞同：2
> 
> 时间：2012-08-13T18:28:48.420
> 
> 标签：django

我正在创建一个表单，该表单使用我的 django 应用程序中的 forms.py 文件动态创建表单。

这是我的代码..

表格.py

```
class TestCriteriaForm(forms.Form):

    testname = forms.CharField()
    serviceoffering = forms.ModelChoiceField(queryset=ServiceOffering.objects.all()) 
    templatename = forms.CharField(help_text="Enter the template name" )
    zone = forms.CharField() 
```

模板代码

```
<form action="/testplatform/" method="post">{% csrf_token %}
{{ form.as_p }}
<input type="submit" value="Submit" />
</form> 
```

我的问题是字段名称的格式不符合我的喜好。我希望看到“测试名称”或“服务产品”而不是 testname

如何在不定义比模板中更多的 html 代码的情况下做到这一点？

非常感谢 - 奥利

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T18:32:57.293

使用该`label`选项。

下次看看文档。

# c - 当声明不在函数开头时，VS2010可以编译吗？

> ID：11940190
> 
> 赞同：1
> 
> 时间：2012-08-13T18:28:49.450
> 
> 标签：c, visual-studio-2010

新手问题。

我正在尝试让[libcork](https://github.com/redjack/libcork)与 VS2010 一起编译。

在 CI 猜测中，您通常必须在函数的开头声明变量，如下所示：

```
void
cork_hash_table_clear(struct cork_hash_table *table)
{

    DEBUG("(clear) Removing all entries");

    size_t  i;  // <--- fails to compile unless moved before DEBUG.
    ... 
```

但是 libcork 充满了定义/声明，因为它们在代码中使用。我想知道是否有允许这样做的 VS 编译器选项？如果这个问题不是新问题，我很抱歉，但我得到的只是一个语法错误，而且我没有任何有用的术语可用于搜索 VS 文档。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T18:32:52.503

[在1999 年版本的标准 (C99)](http://en.wikipedia.org/wiki/C99)中，函数内的混合声明和语句被引入到 C 中；不幸的是，VS 决定不再遵循 1990 版本之后的标准。

您可以将代码编译为 C++，尽管这很可能会以有趣的方式破坏，因为 C 不是 C++ 的严格子集。如果代码与 C++ 不兼容，Herb Sutter[建议使用 Intel CC 或 gcc。](http://herbsutter.com/2012/05/03/reader-qa-what-about-vc-and-c99/)

问题[Visual Studio 是否支持新的 C/C++ 标准？](https://stackoverflow.com/questions/146381/visual-studio-support-for-new-c-c-standards)有一些有趣的内容，尽管它也涵盖了 C++（VS 在跟上步伐方面要好得多）。

# c++ - 在 GCC 上构建的函数多定义链接器错误 - Makefile 问题

> ID：11940191
> 
> 赞同：2
> 
> 时间：2012-08-13T18:28:53.913
> 
> 标签：c++, gcc, makefile, definition

所以我正在尝试使用 Makefile 来构建一个项目，而且我一般来说对 makefile 来说相对较新。链接大量函数时出现多个定义错误，我很确定这是由于我的 makefile 造成的。我不能发布大部分项目，因为它非常大，但是生成文件在下面，有什么明显错误的地方吗？

我在头文件中声明了一些函数 + 定义，并将它们的定义移动到 cpp 中从链接器错误中删除了这些函数 - 但我不能为所有这些函数执行此操作（编辑：被多重定义的其余函数不是在标头中，它们作为标准位于 cpp/cc 文件中，说“我不能为所有人都这样做”暗示它们都是那样的，抱歉），因为很大一部分是我无法编辑的代码库。代码中不应该有任何错误，因为它在没有我添加的单独项目中构建良好（没有一个会导致链接器错误），所以我认为它一定是我的 makefile，但我不知道我做错了什么. 有任何想法吗？

```
 # Compiler
    CXX = g++

    # Linker settings
    LDFLAGS = -lGL -lGLU -lXext -lX11        

    # Executable name
    EXEC = SplotchPreviewer

    # Optimizations for compilation
    OPTIMIZE = -std=c++98 -pedantic -Wno-long-long -Wfatal-errors -Wextra -Wall -Wstrict-aliasing=2 -Wundef -Wshadow -Wwrite-strings -Wredundant-decls -Woverloaded-virtual -Wcast-qual -Wcast-align -Wpointer-arith -O2 -g

    # Pre-processor settings
    CPPFLAGS = $(OPTIMIZE) -I. -Icxxsupport -Ic_utils

    # Default Splotch objects
    OBJS_SPLOTCH_DEFAULT =  cxxsupport/error_handling.o reader/mesh_reader.o cxxsupport/mpi_support.o cxxsupport/paramfile.o \
                    cxxsupport/string_utils.o cxxsupport/announce.o reader/gadget_reader.o reader/millenium_reader.o \
                    reader/bin_reader.o reader/tipsy_reader.o splotch/splotchutils.o splotch/scenemaker.o \
                    cxxsupport/walltimer.o c_utils/walltime_c.o booster/mesh_creator.o booster/randomizer.o \
                    booster/p_selector.o booster/m_rotation.o cxxsupport/paramfile.o cxxsupport/error_handling.o \
                     c_utils/walltime_c.o cxxsupport/string_utils.o cxxsupport/announce.o \
                    cxxsupport/walltimer.o

    # Default Previewer objects
    OBJS_PREVIEWER_DEFAULT = main.o previewer/Previewer.o previewer/libs/core/Parameter.o previewer/libs/core/ParticleSimulation.o \
                     previewer/libs/core/WindowManager.o previewer/libs/core/Camera.o previewer/libs/core/ParticleData.o \
                     previewer/libs/core/MathLib.o previewer/libs/core/FileLib.o previewer/libs/events/OnQuitApplicationEvent.o \
                     previewer/libs/events/OnKeyReleaseEvent.o previewer/libs/events/OnKeyPressEvent.o previewer/libs/events/OnExposedEvent.o \
                     previewer/libs/events/OnButtonReleaseEvent.o previewer/libs/events/OnButtonPressEvent.o previewer/libs/core/Texture.o \
                     previewer/libs/animation/AnimationSimulation.o

    #temp force render method
    RENDER_METHOD = FFSDL
    # Current build specific objects
    ifeq ($(RENDER_METHOD),FFSDL)

    OBJS_BUILD_SPECIFIC = previewer/libs/renderers/FF_DrawList.o     previewer/libs/materials/FF_ParticleMaterial.o

    endif

    # All objects for this build
    OBJS = $(OBJS_SPLOTCH_DEFAULT) $(OBJS_PREVIEWER_DEFAULT) $(OBJS_BUILD_SPECIFIC)

    # Rules (note: object files automatically removed when building)

    .SUFFIXES: .o .cc .cxx .cpp

    .cpp.o:
        $(CXX) -c $(CPPFLAGS) -o "$@" "$<"  

    .cc.o:
        $(CXX) -c $(CPPFLAGS) -o "$@" "$<"

    .cxx.o:
        $(CXX) -c $(CPPFLAGS) -o "$@" "$<"

    $(EXEC): $(OBJS)
        $(CXX) $(OBJS) $(LDFLAGS) -o $(EXEC)
        rm $(OBJS)

    clean:
        rm -f $(OBJS)
        rm -f $(EXEC) 
```

我已经删掉了一两个不必要的东西，因此其中的一两个部分没有多大意义（例如，为什么只有一种方法可用的渲染方法选项）我对我是否正确编写了规则有点模糊，并且图这可以解释我的问题吗？虽然它看起来与其他似乎可以工作的 makefile 相同，但我不确定问题是什么。有人知道吗？如有必要，我可以提供更多信息吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-13T18:34:11.380

> 我在头文件中声明+定义了一些函数，并将它们的定义移动到cpp中从链接器错误中删除了这些函数

听起来它们不是内联的，在这种情况下，链接程序时只允许一个定义。

添加`inline`到标题中的任何函数定义以解决问题。这放宽了“一个定义规则”以允许在多个翻译单元中定义这些函数，只要所有定义都相同。

**更新：**另外，您对`OBJS_SPLOTCH_DEFAULT`包含重复项的定义；`cxxsupport/paramfile.o`重复了，可能还有其他的。您需要删除重复项。我建议按字母顺序保留这样的长列表，以便更容易搜索和发现重复项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T18:39:03.237

问题不在生成文件中。它在这里：

> 我在头文件中声明了一些函数 + 定义，并将它们的定义移动到 cpp 中从链接器错误中删除了这些函数 - 但我不能对所有这些函数都这样做，因为很大一部分是我无法编辑的代码库。

问题在于，当您在多个源文件中包含该标头时，您会获得多个函数定义的副本，这就是链接器所抱怨的。因此，您有三个选择：不使用该代码（说真的：总的来说，这是一种可怕的编码习惯）；不要在多个源文件中使用该标头；或按照@Mike 的建议添加内联。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-13T18:42:25.850

如果您在文件中定义和声明了一个函数`.h`，那么您将获得多重定义的符号，除非您可以通过编译选项或使用`inline`.

如果您不能重写这些`.h`文件以将例程声明为`inline`，那么一个丑陋的解决方案是创建一个`.h`简单地重新声明所有这些例程的并行（声明，记住，而不是定义）。你所有的代码`#includes`这个并行`.h`文件。

您创建一个`.c`/`.cpp`文件，其中包含来自共享代码库`#includes`的文件。`.h`

您将生成的单一`.o`公开来自共享代码库的实现链接到您的代码库。

这很丑陋，而且是一种黑客行为，我肯定会使用@Mike 的答案而不是这个答案。

# java - SpringMVC 使用注解和 xml 配置

> ID：11940194
> 
> 赞同：1
> 
> 时间：2012-08-13T18:28:57.767
> 
> 标签：java, xml, spring, model-view-controller, annotations

我对 Spring MVC 很陌生。我正在创建一个应用程序，并且我想使用 xml 配置（因为它对我来说更容易理解和学习），但是我想使用注释配置有一些好处。

我有一个在 xml 配置中运行良好的应用程序，所以我只想将我的 MVC 控制器转换为注释，并仍然维护我的其余 xml 配置。基本上我想要的是使用 @Controller 注释，因为 SimpleFormController 已被弃用。我在这个论坛上关注了以前的主题，但我收到了**HTTP 404 错误**。有人可以在这里帮助我或告诉我我做错了什么吗？

**控制器**

```
import java.util.HashMap;
import java.util.Map;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import org.apache.log4j.Logger;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.servlet.ModelAndView;
import org.springframework.web.bind.annotation.RequestMethod;

import com.crimetrack.service.CountryManager;

@Controller
@RequestMapping(value="/hello.htm", method = RequestMethod.GET)
public class CountryListController{

    private final Logger logger = Logger.getLogger(getClass());
    private CountryManager countryManager;

    public ModelAndView handleRequest(HttpServletRequest request,
            HttpServletResponse response) throws Exception {

        logger.debug("In Http method for CountryListController");

        Map<String, Object> myModel = new HashMap<String, Object>();
        myModel.put("countryList", this.countryManager.getCountries());

        return new ModelAndView("hello", "model", myModel);
    }

    public void setCountryManager(CountryManager countrymanager){

        this.countryManager = countrymanager;
    }

} 
```

**应用程序上下文.xml**

```
 <?xml version="1.0" encoding="UTF-8"?>

<beans xmlns="http://www.springframework.org/schema/beans"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xmlns:aop="http://www.springframework.org/schema/aop"
         xmlns:tx="http://www.springframework.org/schema/tx"
         xsi:schemaLocation="http://www.springframework.org/schema/beans 
           http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
           http://www.springframework.org/schema/aop 
           http://www.springframework.org/schema/aop/spring-aop-3.0.xsd
           http://www.springframework.org/schema/tx 
           http://www.springframework.org/schema/tx/spring-tx-3.0.xsd">

    <bean id="countryManager" class="com.crimetrack.service.CountryManager">
        <property name="countryDao" ref="countryDao"/>
    </bean>

    <bean id="countryDao" class="com.crimetrack.jdbc.JdbcCountryDAO">
        <property name="dataSource" ref="dataSource"/>
    </bean>

    <bean id="authenticationManager" class="com.crimetrack.service.AuthenticationManager">
        <property name="loginDao" ref="loginDao" />
    </bean>

    <bean id="loginDao" class="com.crimetrack.jdbc.JdbcLoginDAO">
        <property name="dataSource" ref="dataSource" />
    </bean>

    <bean id="dataSource" class="org.apache.commons.dbcp.BasicDataSource" destroy-method="close">
            <property name="driverClassName" value="${jdbc.driverClassName}"/>
            <property name="url" value="${jdbc.url}"/>
            <property name="username" value="${jdbc.username}"/>
            <property name="password" value="${jdbc.password}"/>
    </bean>

    <bean id="propertyConfigurer" 
          class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
        <property name="locations">
            <list>
                <value>classpath:jdbc.properties</value>
            </list>
        </property>
    </bean>

    <bean id="transactionManager" 
          class="org.springframework.jdbc.datasource.DataSourceTransactionManager">
        <property name="dataSource" ref="dataSource"/>
    </bean>      

  </beans> 
```

**应用程序-servlet.xml**

```
 <?xml version="1.0" encoding="UTF-8"?>

<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:context="http://www.springframework.org/schema/context"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
                           http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
                           http://www.springframework.org/schema/context
                           http://www.springframework.org/schema/context/spring-context-3.0.xsd
                           http://www.springframework.org/schema/beans/spring-context-3.0.xsd">

    <context:annotation-config/>   

    <context:component-scan base-package="com.crimetrack.web"/>  

    <bean class="org.springframework.web.servlet.mvc.annotation.DefaultAnnotationHandlerMapping"/> 

    <bean class="org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter"/>   

    <bean class="org.springframework.web.servlet.mvc.SimpleControllerHandlerAdapter"/> 

     <bean id="messageSource" class="org.springframework.context.support.ResourceBundleMessageSource">
            <property name="basename" value="messages"/>
     </bean>

      <bean name="/login.htm" class="com.crimetrack.web.AuthenticationController">
        <property name="authenticationManager" ref="authenticationManager"/>
        <property name="login" ref="login"/>

     </bean>

     <bean name="authenticationManager" class="com.crimetrack.service.AuthenticationManager" />

     <bean name="login" class="com.crimetrack.business.Login" />

      <bean id="viewResolver" class="org.springframework.web.servlet.view.InternalResourceViewResolver">
        <property name="viewClass" value="org.springframework.web.servlet.view.JstlView"></property>
        <property name="prefix" value="/WEB-INF/jsp/"></property>
        <property name="suffix" value=".jsp"></property>        
      </bean>

  <!--  <bean name="/login.htm" class="org.springframework.web.servlet.mvc.ParameterizableViewController"> <property name="viewName" value="login"/>    </bean> -->  

</beans> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T19:33:20.720

尝试移动此注释：

```
@RequestMapping(value="/hello.htm", method = RequestMethod.GET) 
```

到您的 handleRequest() 方法。Spring 需要知道收到请求后要调用的具体方法。对类进行注解可以让您将一组方法分组到一个具有公共前缀的类中，但我相信您仍然需要对每个处理请求的方法进行注解。

# javascript - 选择了默认单选按钮，但下拉菜单未正确显示

> ID：11940195
> 
> 赞同：-3
> 
> 时间：2012-08-13T18:29:09.353
> 
> 标签：javascript, html, forms

我有一个网站，上面有我在其他非常相似的网站上使用过的信用卡支付表格。我遇到的问题是，当页面加载时，会自动选择信用卡支付选项，并且通常会显示信用卡的下拉列表。但是，在此站点上，直到第二次单击显示为已选中的单选按钮时才会显示该列表。如果有人有任何关于可能导致这种情况的信息，我将非常感激！如果您将任何内容添加到购物车并查看购物车页面，则可以在`www.seed-city.com`( [NSFW ) 看到问题。](http://en.wikipedia.org/wiki/Not_safe_for_work "工作不安全")感谢您的时间。

你可以在这里看到问题：

http://www.seed-city.com/index.php?option=com_virtuemart&page=shop.cart&add_id[]=270&qadd_270=10

我的代码是：

```
<div class="yagendoo_vm_checkout_credit_input">
        <table>
            <tr>
                <td nowrap width="10%" align="left"><?php echo $VM_LANG->_('VM_CREDIT_CARD_TYPE'); ?>:</td>
                <td>          
                    <script language="Javascript" type="text/javascript"><!--
                        writeDynaList( 'class="inputbox" name="creditcard_code" size="1"',
                        orders, originalPos, originalPos, originalOrder );
                        //-->
                    </script>
                    <?php 
                        $db_cc->reset();
                        $payment_class = $db_cc->f("payment_class");
                        $require_cvv_code = "YES";
                        if(file_exists(CLASSPATH."payment/$payment_class.php") && file_exists(CLASSPATH."payment/$payment_class.cfg.php")):
                            require_once(CLASSPATH."payment/$payment_class.php");
                            require_once(CLASSPATH."payment/$payment_class.cfg.php");
                            $_PAYMENT = new $payment_class();
                            if( defined( $_PAYMENT->payment_code.'_CHECK_CARD_CODE')):?>
                                <?php $require_cvv_code = strtoupper( constant($_PAYMENT->payment_code.'_CHECK_CARD_CODE'));?>
                            <?php endif;
                    endif;?>
                </td>
            </tr>
            <tr valign="top">
                <td nowrap width="10%" align="left">
                    <label for="order_payment_name">
                        <?php echo $VM_LANG->_('PHPSHOP_CHECKOUT_CONF_PAYINFO_NAMECARD') ?>:
                    </label>
                </td>
                <td>
                    <input type="text" class="inputbox" id="order_payment_name" name="order_payment_name" value="<?php if(!empty($_SESSION['ccdata']['order_payment_name'])) echo $_SESSION['ccdata']['order_payment_name'] ?>" autocomplete="off" />
                </td>
            </tr>
            <tr valign="top">
                <td nowrap width="10%" align="left">
                    <label for="order_payment_number"><?php echo $VM_LANG->_('PHPSHOP_CHECKOUT_CONF_PAYINFO_CCNUM') ?>:</label>
                </td>
                <td>
                    <input type="text" class="inputbox" id="order_payment_number" name="order_payment_number" value="<?php if(!empty($_SESSION['ccdata']['order_payment_number'])) echo $_SESSION['ccdata']['order_payment_number'] ?>" autocomplete="off" /> 
```

更多代码：

```
 foreach( $cards as $code => $name ) {

            $script .= "orders[".$i++."] = new Array( '".addslashes($db_cc->f("payment_method_name"))."','$code','$name' );\n";

        }

        }

        $script .= "function changeCreditCardList() { \n";

        $script .= "var selected_payment = null;

  for (var i=0; i<document.adminForm.payment_method_id.length; i++)

     if (document.adminForm.payment_method_id[i].checked)

        selected_payment = document.adminForm.payment_method_id[i].id;\n";

        $script .="changeDynaList('creditcard_code',orders,selected_payment, originalPos, originalOrder);\n";

        $script .="}\n";

        $script .="//-->\n";

        $script .="</script>\n";

        $script .= '<noscript>'.ps_html::selectList('creditcard_code', key($cards), $cards ).'</noscript>';

        return $script;

    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T18:50:03.847

您有一个没有项目的选择：

```
<select class="inputbox" name="creditcard_code" size="1"> </select> 
```

这些项目是通过上面的脚本加载的

```
/*<![CDATA[*/var originalOrder = '1';
var originalPos = 'payment_method_id_3';
var orders = new Array();   // array in the format [key,value,text]
orders[0] = new Array( 'payment_method_id_3','VISA','Visa' );
orders[1] = new Array( 'payment_method_id_3','MC','MasterCard' );
orders[2] = new Array( 'payment_method_id_3','jcb','JCB' );
orders[3] = new Array( 'payment_method_id_3','australian_bc','Australian Bankcard' );
orders[4] = new Array( 'payment_method_id_3','SWITCH','Maestro' );
function changeCreditCardList() { 
var selected_payment = null;
      for (var i=0; i<document.adminForm.payment_method_id.length; i++)
         if (document.adminForm.payment_method_id[i].checked)
            selected_payment = document.adminForm.payment_method_id[i].id;
op_changeDynaList('creditcard_code',orders,selected_payment, originalPos, originalOrder);
}/*]]>*/ 
```

我假设该`op_changeDynaList`函数应该`select`与数组一起加载。看来这`changeCreditCardList`可能是`onchange`处理程序。

同样，这应该是问题所在。但是，我没有看到第一次实际加载列表的位置。您可能需要`changeCreditCardList`在页面加载后手动调用其中一个函数（如 ），而不是等待第一个事件被触发。

# php - 在 CodeIgniter 中使用部分

> ID：11940201
> 
> 赞同：0
> 
> 时间：2012-08-13T18:30:04.443
> 
> 标签：php, asp.net-mvc-3, codeigniter, partial-views, template-engine

我在工作中使用 ASP.NET MVC3，而在家中使用 PHP。我想在 CodeIgniter 中使用 MVC3 的 Sections 功能，它有这样的功能吗？

ASP.NET MVC3 中的示例（未测试）：

```
<!-- A view, that serves the content -->
@section Head{
    <script src="myscript.js"></script>
}
<p>This is my main content - 
I require myscript.js to be included on my page, 
so I specify a head section, which the header of my page will render</p>

<!-- ANOTHER view, that serves the content -->
@section Head{
    <script src="otherscript.js"></script>
    <link rel="stylesheet" type="text/css" href="somestyle.css" />
}
<p>Some OTHER view, with OTHER dependencies!</p>

<!-- Header File, where I include CSS and JS! -->
<head>
<script src="jquery.js"></script>

@Html.Section("Head")

</head> 
```

重点是，例如，在特定视图中，我希望包含一个脚本文件，因此我将 添加`<script>`到该部分，并且该部分呈现在标题中（在不同的视图中）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T18:40:29.290

似乎[@Section 只是](http://weblogs.asp.net/scottgu/archive/2010/12/30/asp-net-mvc-3-layouts-and-sections-with-razor.aspx)部分模板概念的一些语法糖，或者您可以在视图中包含的子视图。

在 CodeIgnier 中，这只是加载主视图时在控制器中加载的另一个视图，并自定义要包含的主视图的 HTML。要在 CodeIgniter 中加载多个视图，请参见[此处](http://codeigniter.com/user_guide/general/views.html)。

当然，这只是如果您想自己接线，[如此处所示](https://stackoverflow.com/questions/3675135/codeigniter-best-way-to-structure-partial-views)。更好的方法是使用模板库。CodeIgniter有[许多模板库可用](http://www.google.co.uk/#sclient=psy&hl=en&safe=off&q=template+library+codeigniter&aq=f&aqi=g5&aql=&oq=&gs_rfai=&pbx=1&fp=1&bav=on.2,or.r_gc.r_pw.r_qf.&cad=b)。[有些人要求进行比较](https://stackoverflow.com/questions/3957000/what-codeigniter-template-library-is-best)，Phil Sturgeon 似乎很受欢迎（并且可以做你想做的事）。

# android - 自定义标题栏 - Android 崩溃

> ID：11940205
> 
> 赞同：1
> 
> 时间：2012-08-13T18:30:29.090
> 
> 标签：android, crash, titlebar

我正在尝试为我的应用程序创建一个自定义标题栏。问题是，如果我进行这些更改，它会在启动时崩溃：

```
 this.requestWindowFeature(Window.FEATURE_CUSTOM_TITLE);
    setContentView(R.layout.main);
    this.getWindow().setFeatureInt(Window.FEATURE_CUSTOM_TITLE, R.layout.titlebar); 
```

问题可能是什么？我搜索了论坛和网络，但找不到答案。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T18:31:24.253

设置标题栏后尝试调用**setContentView(...)**

```
this.requestWindowFeature(Window.FEATURE_CUSTOM_TITLE);    
this.getWindow().setFeatureInt(Window.FEATURE_CUSTOM_TITLE, R.layout.titlebar);
setContentView(R.layout.main); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T19:30:10.110

这对我有用。在我看来，您的 XML 文件中有错误

```
 /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

     requestWindowFeature(Window.FEATURE_CUSTOM_TITLE);

    setContentView(R.layout.main);      

    getWindow().setFeatureInt(Window.FEATURE_CUSTOM_TITLE, 
                              R.layout.window_main_title);
 } 
```

XML layout.window_main_title ：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="horizontal"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="#323331">

    <ImageView
        android:id="@+id/header"
        android:src="@drawable/ic_launcher_32"
        android:paddingLeft="5dp"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="center_vertical"/>

    <TextView
                android:id="@+id/textHeader"
                android:textSize="15dp"  
                android:textColor="#FEFEFE"
                android:text="@string/app_name"
                android:paddingLeft="5dp"
                android:layout_gravity="center_vertical"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"></TextView> 

</LinearLayout> 
```

# c++ - 如何在不相关的类之间传递 C++ 回调？

> ID：11940209
> 
> 赞同：6
> 
> 时间：2012-08-13T18:30:46.203
> 
> 标签：c++, visual-studio-2010, function-pointers

在一个非增强项目中，我有一个类使用基于某个用户操作（按下/释放按钮）的计时器。我想要这个类是通用的，所以它需要回调用户定义的操作。

```
// TimerClass.h
typedef void (*timerCallback)(void);
...
Class TimerClass : public CButton {
public:
    void setCallbackShortTime(timerCallback clickFn) { shortCallback = clickFn;} ;
    void setCallbackLongTime(timerCallback clickFn) { longCallback = clickFn;} ;
private:
    timerCallback shortCallback, longCallback;
}

// CMyDlg.h
class CMyDlg : public CDialog
{
public:
    void openLiveViewWindow();
    void openAdminPanelWindow();
    TimerClass _buttonSettings;
}

// CMyDlg.cpp
...
_buttonSettings.setCallbackShortTime(&openLiveViewWindow);
... 
```

现在，从另一个类（DialogClass）我可以使用 TimerClass，但我不能将函数指针传递给回调函数。这些函数不是静态的。编译器最终抱怨：

```
error C2276: '&' : illegal operation on bound member function expression 
```

对此的一些研究指出`std::function()`，`std::bind()`但我不熟悉这些，并希望得到一些关于如何解决这个问题的指示。

**解决方案**：对于任何感兴趣的人，这里是最终解决方案的砖块

```
// TimedButton.h
#include <functional>
// define timer callback prototype
typedef std::function<void()> timerCallback;
...
class TimedButton : public CButton
{
public:
    TimedButton();
    ...
    void setCallbackShortTime(timerCallback clickFn) { _shortCallback = clickFn;} ;
    void setCallbackLongTime(timerCallback clickFn) { _longCallback = clickFn;} ;
private:
    timerCallback _shortCallback;
    timerCallback _longCallback;
}

// TimedButton.cpp
...
(_longCallback)();  // call long duration fn
...
(_shortCallback)();     // call short duration fn

// in MyDlg.cpp
#include <functional>
...
_buttonSettings.setCallbackShortTime(std::bind(&CMyDlg::openLiveViewWindow, this));
_buttonSettings.setCallbackLongTime(std::bind(&CMyDlg::openAdminPanelWindow, this)); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T18:54:41.620

执行此操作的老式方法是让您的回调函数接受一个附加`void*`参数，为此您传递一个指向您希望调用该函数的对象的指针。然后，您为回调使用静态成员函数，并让它将指针转换为正确的对象并调用您的真正回调。

```
typedef void (*timerCallback)(void*);
...
void setCallbackShortTime(timerCallback clickFn, void* object) { shortCallback = clickFn; shortCallbackObject = object;} ;
void setCallbackLongTime(timerCallback clickFn, void* object) { longCallback = clickFn; longCallbackObject = object;} ;
...

static void openLiveViewWindowCallback(void* object) { ((CMyDlg*)object)->openLiveViewWindow(); }
void openLiveViewWindow(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-13T18:45:58.337

`std::function`是一个多态函数对象，它可以用特定的签名包装任何类型的可调用对象。在您的情况下，您希望它不带参数并且不返回任何值，因此您可以定义：

```
typedef std::function<void()> timerCallback; 
```

`std::bind`允许您通过将参数绑定到参数来使可调用对象适应不同签名之一。在您的情况下，您希望通过将成员函数绑定到特定对象来对其进行调用来调整它：

```
_buttonSettings.setCallbackShortTime(std::bind(&CMyDlg::openLiveViewWindow, this)); 
```

请注意，这些是在 2011 年推出的，因此较旧的编译器将不支持它们。在这种情况下，您可以使用非常相似的 Boost 或 TR1 库，或者创建自己的可调用类，其中包含指向成员函数的指针和指向要调用它的对象的指针/引用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-13T18:47:59.857

您不能将指针传递给类的方法，只能传递普通函数。我建议深入`std::function()`研究，因为您使用的是支持它们的 VS2010。有一个很好的（而且很长的）教程来描述它们以及更多[here](http://www.dreamincode.net/forums/topic/264061-c11-fun-with-functions/)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-14T04:17:32.880

您可以创建一个充当函数指针的多态模板类。

```
class TFunctorBase
{
public:
    TFunctorBase(void) {}
    virtual ~TFunctorBase(void) {}
    virtual void operator()(void) = 0;
};

// derived template class
template <class TClass> class TFunctor : public TFunctorBase
{
private:
    void (TClass::*fpt)();   // pointer to member function
    TClass* pt2Object;                  // pointer to object

public:
    TFunctor(TClass* _pt2Object, void(TClass::*_fpt)())
    { pt2Object = _pt2Object; fpt = _fpt;};

    virtual void operator()(void)
    { (*pt2Object.*fpt)();};              // execute member function
}; 
```

初始化仿函数对象：

```
TFunctor<MyClass> obj(&myInstance, &MyClass::myMemberFunction); 
```

并使用它：

```
(*obj)(); 
//(*obj)(42); for operator()(int) 
```

这是一个例子：

```
class ClassA
{
public:
   void function1(int a, string b);
};

ClassA objA;
TFunctor<ClassA> functor(&objA,&ClassA::function);
(*functor)(42, "pumpkin"); //assuming you added virtual void operator()(int, string) to TFunctorBase 
```

这是关于函子的一个很好的资源以及我上面描述的实现。 [http://www.newty.de/fpt/functor.html#chapter4](http://www.newty.de/fpt/functor.html#chapter4)

# javascript - 为什么这个 javascript 警报会触发两次？

> ID：11940213
> 
> 赞同：0
> 
> 时间：2012-08-13T18:31:17.627
> 
> 标签：javascript, html, onclick, alert, innerhtml

```
<script type="text/javascript">
function ChangeStyle()
{
    document.getElementById("p1").innerHTML = 
        "<a href='javascript:void()' onclick=\"window.location.href='http://google.com'\">The New Link</a>";
}
</script>
<a id="p1" href="javascript:void()" onclick="ChangeStyle();alert('hello');">The Link</a> 
```

这是完整的代码。由于某种原因，警报会触发两次。我想不通。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-13T18:33:41.557

通过设置`innerHTML`链接的 ，您将在第一个链接中创建另一个链接。

当您单击此内部链接时，单击事件会冒泡并触发外部单击处理程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T18:34:40.867

您可能打算将链接包装到另一个元素中：

```
<span id="p1">
 <a href="javascript:void()" onclick="ChangeStyle();alert('hello');">The Link</a>
</span> 
```

现在您可以按照您可能想要的方式替换`p1`使用的内容：`innerHTML`

```
<script type="text/javascript">
function ChangeStyle()
{
  document.getElementById("p1").innerHTML = "<a [...]>The New Link</a>";
}
</script> 
```

否则，您将在链接中创建一个链接

# php - 用文本替换空的表单域

> ID：11940223
> 
> 赞同：3
> 
> 时间：2012-08-13T18:31:48.747
> 
> 标签：php, arrays, forms

我有一个用户填写的表格，其内容被发送到 dompdf 进行处理。如果用户选择**不**填写某个字段，我希望在整个表单中的任何空字段的结果 pdf 上通过“未输入”来反映这一点。

我正在尝试通过执行以下操作来更新字段，然后再将它们发送到 dompdf 进行处理：

```
<?php

foreach ($_POST as $key => $value)
    {
        if(empty($value))
            {
                $_POST[$key] = "Not entered";
            }
    }
?> 
```

但它不起作用。它只是传递空的 $value(s)。

所以我的问题是：我如何遍历 $_POST 数组，如果 $value 为空，则将 $key=>$value 对的 $value 替换为“未输入”？

感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T17:53:56.693

似乎与：

```
foreach ($_POST as $key => $val) {
    if (empty($val)) {
    $post -> $key = "not entered";
    }
    } 
```

这是一个 HTML 表单，它在提交时发布到自身。（我可能应该指出这一点......）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T12:05:02.693

您可以使用 php 函数来实现这一点`array_map`，如下所示，

```
$array = $_POST;
$array = array_map(function($val) { return isset($val) ?$val:'Not entered'; }, $array); 
```

但是这样做会使未来的程序员混淆它的来源。因此，将其分配给某个变量并将其发送到您想要的任何地方。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T18:33:43.210

Isset() 检查变量的值是否包括（ False 、 0 或空字符串），但不包括 NULL。如果 var 存在，则返回 TRUE；否则为假。

另一方面，empty() 函数检查变量是否具有空值、空字符串、0、NULL 或 False。如果 var 具有非空且非零值，则返回 FALSE。

```
<?php

    foreach ($_POST as $key => $value)
        {
            if(!isset($value))
                {
                    $_POST[$key] = "Not entered";
                }
        }
    ?> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-13T18:35:37.577

尝试

```
<?php

foreach($_POST as &$value){
  if (empty($value)) $value = "Not entered";
}

?> 
```

在中添加`&`to允许您修改内联值 [http://php.net/manual/en/control-structures.foreach.php](http://php.net/manual/en/control-structures.foreach.php)`$value``foreach`

但是，如果您使用 HTML 表单（表单标签/输入元素），那么表单将仅提交填充元素的数据

您可能想在 PHP 中查看 javascript 解决方案或类似的东西

```
<?php

if (empty($_POST['name'])) $_POST['name'] = "Not entered";

?> 
```

请注意，密钥必须手动提供，因为它们实际上不是请求的一部分

如果您有大量不应为空的键，请尝试类似

```
<?php

$notempty = Array('name', 'address', 'email');
foreach($notempty as $v){
  if(empty($_POST[$v])) $_POST[$v] = 'Not entered';
}

?> 
```

这样，如果姓名、地址或电子邮件中的任何一个为空，它们将被填写为“未输入”

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-13T18:36:45.340

未提交空元素，这就是您在 PHP 代码中看不到任何内容的原因。

一种替代方法是在表单提交时使用 Javascript 注入这些值。您可以执行以下操作：

```
<form onsubmit="return yourjsfunction();" /> 
```

JS 函数可以收集所有未输入任何值的输入元素，并将其值设置为“未输入”。然后它会调用`form.submit();`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-13T18:36:53.253

空字段不会在 POST 中提交。

执行`vardump($_POST)`以查看提交了哪些字段。因此，您可以使用[`isset`](http://php.net/manual/en/function.isset.php). 如果没有设置变量，那么你可以用它做任何你想做的事情。

```
if(!isset($_POST['foo'])) {
    // the field foo was empty
} 
```

# ajax - 使用 JQuery AJAX 使用 IIS 托管的 WCF

> ID：11940225
> 
> 赞同：1
> 
> 时间：2012-08-13T18:32:25.283
> 
> 标签：ajax, jquery, wcf-client

调用此 AJAX 方法时，我不断收到“错误：未定义”消息。

```
$.ajax({
            type: "GET",
            async: false,
            url: "localhost/ServiceHost/Security.svc/GetAllUserErrors",
            data: "{ }",
            dataType: "json",
            contentType: "application/json; charset=utf-8",
            dataFilter: function (data) { return data; },
            success: function (data) {
                for (var i = 0; i < data.d.length; i++) {
                    if (i % 2 == 0) rows += "<tr><td><input  type=\"checkbox\"/></td>";
                    else rows += "<tr class=\"alternate-row\"><td><input  type=\"checkbox\"/></td>";
                    rows += "<td>" + data.d.SyncTimeStamp.toString() + "</td>";
                    rows += "<td>" + data.d.Name.toString() + "</td>";
                    rows += "<td>" + data.d.Login.toString() + "</td>";
                    rows += "<td>" + data.d.NotificationText.toString() + "</td>";
                    rows += "<td class=\"options-width\"><a href=\"\" title=\"Edit\" class=\"icon-2 info-tooltip\"></a></td></tr>";
                }
            },
            error: function (XMLHttpRequest, textStatus, errorThrown) {
                alert(textStatus + ":" + errorThrown);
            }
        }); 
```

我知道 WCF 正在运行，但我不知道为什么会出现此错误。有什么帮助吗？

我确定问题出在“url”部分的某个地方。此行的正确语法是什么？

```
 <services>
      <service name="Security.WCFServiceLibrary.Security">
        <endpoint address="" binding="wsDualHttpBinding" bindingConfiguration=""
          contract="Security.WCFServiceLibrary.ISecurity" />
      </service>
    </services> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T18:44:25.423

除了您的 SJAJ 架构（...）？

我会说您的“localhost”不是您的html页面旁边的文件夹，而是绝对路径？`http://localhost/`

然后，当定义数据时，您还需要将其解析为适当的 Javascript 对象，因为您的 JSON 只是一个“符号”。

```
var jsonData = jQuery.parseJSON(data); 
```

然后就可以把 jsonData 当作一个真正的 js 对象了。祝你好运！

# c# - 如何将货币输出添加到 jQuery 函数

> ID：11940226
> 
> 赞同：0
> 
> 时间：2012-08-13T18:32:24.910
> 
> 标签：c#, jquery, currency

我需要将货币输出添加到 jQuery 函数中。因此，像 1577334.668 这样的数字将打印为 $1,577,335。我认为我应该在控制器中执行此操作，但我的老板今天告诉我我应该在 jQuery 视图中执行此任务，我只是不知道该怎么做。我在下面包含了 jQuery 代码，并在我需要打印货币金额的变量旁边添加了注释。该变量称为`SC[i]`。任何意见或建议将不胜感激！谢谢你的帮助！

```
 //Spend Category function for monthly
        pa_click = function (pa_label) {
            PA_ID = pa_label.getAttribute('pa_id');

            var pa_details = document.getElementById('pa-details-' + PA_ID);

            jQuery.getJSON('@Url.Action("getAjaxSCs")', { PA: pa_label.title }, function (SCS) {
                pa_details.innerHTML = "";
                jQuery.each(SCS, function (index, SC) {
                    months_html = '';

                    for (var i = 0; i < 12; i++) {

                        months_html +=
                                            '<div id="SC-' + index + '-' + months[i] + '" class="month-wrapper tree border-white">' +
                                            SC[i] + // This is the variable I need to replace with code to add currency to the amount  
                                            '</div>';
                    }

                    pa_details.innerHTML +=

                            '<div id ="Spend-Category-' + index + '" class="sc-wrapper tree border">' +
                                '<div id ="sc-title-' + index + '" class="sc-title">' +
                                    '<div class = "sc-label" title = "' + index + '" SC_id="' + index + '" onclick = "sc_click(this)">' + index + '</div>' +
                                    months_html +
                                '</div>' +
                                '<div id="sc-details-' + index + '" class = "pa-details" style = "display:none">' + index + '</div>' +
                            '</div>';
                })
            });
            jQuery('#pa-details-' + PA_ID).show('slide', { direction: 'up' }, 'fast');

        }; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T18:47:26.103

这个 jQuery 插件会帮助你：[格式化货币](http://code.google.com/p/jquery-formatcurrency/)

向该行添加一个类（例如货币）

```
months_html +='<div id="SC-' + index + '-' + months[i] + '" class="month-wrapper tree border-white currency">' +
SC[i] + // This is the variable I need to replace with code to add currency to the amount  
'</div>'; 
```

然后`$(".currency").formatCurrency();`就会成功。

该页面还有一些可以帮助您入门的演示

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T18:50:07.943

另一个 C# 人员可能更容易使用的插件是[Globalize](https://github.com/jquery/globalize)。[自述文件](https://github.com/jquery/globalize/blob/master/README.md)中提供了示例和说明。

样本：

```
Globalize.format( 1234.567, "n" ); // "1,234.57" 
```

# c - 错误：需要左值作为赋值的左操作数

> ID：11940232
> 
> 赞同：0
> 
> 时间：2012-08-13T18:32:45.907
> 
> 标签：c, compiler-errors, fftw

我有一个旧的 c 程序示例，它使用 fftw 来求解微分方程。

编译时出错的程序的两行是：

```
creal(comp[i2+n_y*i1]) = c_zero + 1/15;
cimag(comp[i2+n_y*i1]) = 0.0; 
```

这里，comp 是一个复变量，creal，cimag 是它的实部和虚部。它试图在某个点（i2，i1）分配值。

这给出了错误

```
 **error: lvalue required as left operand of assignment** 
```

我之前也遇到过这个问题，解决方法是替换`creal`为`__creal__`或其他东西，尽管我不记得了。谁能告诉我如何摆脱错误？任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T12:36:41.890

为了给一个复数赋值，我做了以下工作

```
__real__(comp[i1+n*i2]) = ...
__imag__(comp[i1+n*i2]) = .... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T18:35:05.467

`creal`是一个函数，它返回一个值，你不能给一个值赋值。

例如，假设对它`creal`进行评估`0.0`就像您尝试这样做：

```
0.0 = c_zero + 1/15; 
```

`creal`是一个 C 标准函数：

```
#include <complex.h>
double creal(double complex z); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T18:37:48.450

如果你是对的，这可以实现：

```
int * pointer_generator()
{
  return (int *)malloc(8);
 }

int main()
{
  *( pointer_generator() )=123234;
  return 0;
  } 
```

这行得通。VC++ 2010。但它指向哪里？谁知道？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-13T18:46:21.730

因为你的新复杂值的虚部应该是`0`你可以做的

```
comp[i2+n_y*i1]= c_zero + 1/15; 
```

复杂对象是 C 中的一等公民，可以直接分配给。

如果您想添加另一个虚构部分

```
comp[i2+n_y*i1]= c_zero + 1/15 + 78 * I; 
```

你必须包括`complex.h`才能`I`工作。

**编辑：**假设这`c_zero`只是一个`0`复杂的类型，可能正确的写作就是

```
comp[i2+n_y*i1]= 1.0/15 + 78 * I; 
```

# php - 如何访问带有减号的对象属性？

> ID：11940244
> 
> 赞同：13
> 
> 时间：2012-08-13T18:33:15.390
> 
> 标签：php, object

我有一个对象（在 PHP 中），但我无法打印内容。在调试模式下是这样的：

```
stdClass Object
(
    [pre-selection] => 1
) 
```

但由于减号，我无法打印“预选”。

```
echo $object->pre-selection; //doens't work. 
```

我怎样才能打印出来？谢谢。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-08-13T18:34:21.587

你可以试试

```
$object->{'pre-selection'}; 
```

[http://php.net/manual/en/language.types.string.php#language.types.string.parsing.complex](http://php.net/manual/en/language.types.string.php#language.types.string.parsing.complex)

另见示例 2[`json_decode()`](http://php.net/manual/en/function.json-decode.php)

> Example #2 访问无效的对象属性
> 
> 访问对象中包含 PHP 命名约定不允许的字符（例如连字符）的元素可以通过将元素名称封装在大括号和撇号中来完成。
> 
> ```
> <?php
> 
> $json = '{"foo-bar": 12345}';
> 
> $obj = json_decode($json);
> print $obj->{'foo-bar'}; // 12345
> 
> ?> 
> ```

### 更新（感谢salathe）：

> **也可以使用花括号**来明确界定属性名称。在访问包含数组的属性中的值、属性名称由多个部分组成或**属性名称包含其他无效字符时，它们最有用**

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-08-13T18:37:19.087

有多种方法，问题是 PHP 标记器会阻塞`-`代码中的符号，但是您可以编写它以便解析器不会抱怨：

```
echo $object->{'pre-selection'}; 
```

或者

```
$property = 'pre-selection'
echo $object->$property; 
```

或者

```
$array = (array) $object;   
echo $array['pre-selection']; 
```

在这些情况下，PHP 解析器不会在原始代码中存在无法解析的问题的地方运行。

* * *

想知道这是在哪里记录的。例如在[SimpleXML 文档](http://de.php.net/manual/en/simplexml.examples-basic.php#example-5116)中：

> 访问 XML 文档中包含 PHP 命名约定不允许的字符（例如连字符）的元素，可以通过将元素名称封装在大括号和撇号中来完成。
> 
> ***Example #3 获取 <line>***
> 
> ```
> <?php
> include 'example.php';
> 
> $movies = new SimpleXMLElement($xmlstr);
> 
> echo $movies->movie->{'great-lines'}->line;
> ?> 
> ```
> 
> 上面的示例将输出：
> 
> ```
> PHP solves all my web problems 
> ```

# android - Android中是否有表格的编辑模式 - 如iOS -

> ID：11940246
> 
> 赞同：0
> 
> 时间：2012-08-13T18:33:31.757
> 
> 标签：android, android-layout

我想知道 Android 是否有类似[iOS 中提供](http://developer.apple.com/library/ios/#documentation/userexperience/conceptual/tableview_iphone/ManageInsertDeleteRow/ManageInsertDeleteRow.html)的表格的“编辑模式” ，它允许您标记表格中的每一行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T19:03:03.570

我查看了 iOS 如何为其表格视图提供添加/删除按钮，并且使用自定义/复合小部件在 Android 中实现相同的 UI 功能非常简单。

对于动态表格布局，我建议使用由[ListAdapter](http://developer.android.com/reference/android/widget/ListAdapter.html)（用于列表或网格/表格）或[ExpandableListAdapter](http://developer.android.com/reference/android/widget/ExpandableListAdapter.html)（用于树/可折叠列表）支持的视图。您可以创建自定义小部件或布局，将一对添加/删除按钮与您选择的视图相结合。然后让按钮的操作连接到适配器上的添加/删除项目功能。

这种方法使您有机会确认和/或验证对视图和基础数据的更改，并且您可以将小部件重用于视图/适配器/数据源的不同组合。

我一般会避免尝试使用 TableLayout/TableRow 结构进行数据显示，因为它们更适合静态实体，并且您正在寻找能够自动适应用户更改的东西。

编辑：这里是构建复合小部件和[使用 ListViews & ListAdapters](http://www.vogella.com/articles/AndroidListView/article.html)的链接。

Android 文档网站：http: [//developer.android.com/guide/topics/ui/custom-components.html#compound](http://developer.android.com/guide/topics/ui/custom-components.html#compound)

简短的博文：[http ://www.workreloaded.com/2011/02/composite-component/](http://www.workreloaded.com/2011/02/composite-component/)

在此处搜索：[https ://stackoverflow.com/search?q=android+compound+component&submit=search](https://stackoverflow.com/search?q=android+compound+component&submit=search)

# c# - 在 C# 中，从列表 那实际上充满了孩子，我如何访问这些孩子的具体构造函数？

> ID：11940250
> 
> 赞同：1
> 
> 时间：2012-08-13T18:33:50.307
> 
> 标签：c#, types, constructor

首先，我有这样的事情：

```
class Parent
{

    int x;

    public Parent(int _x)
    {
        x = _x
    }
}

class Child1: Parent
{
    int y;

    public Child1(int _y):base(_y)
    {
        y=_y;
    }
}

class Child2: Parent
{
    int z;

    public Child2(int _z):base(_z)
    {
        z=_z;
    }
} 
```

一个简单的父子层次结构。然后，我有一个实际上充满了 Child1 和 Child2 的列表。我想为列表中的每个对象制作副本，并且我想首先制作一个将作为副本的新项目。

但是，如果我这样做：

```
foreach(Parent p in list)
dictionaryOfCopies.Add(p, new Parent(p.x)); 
```

那么字典将充满Parent's，而不是Children1和Children2。有没有办法在不知道对象的特定类型的情况下调用被键入为其父类型的对象的构造函数？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-13T18:36:38.713

一种方法是在对象上实现[`ICloneable`接口](http://msdn.microsoft.com/en-us/library/system.icloneable%28v=vs.110%29.aspx#Y0)，并让每个实例克隆自己。

```
class Parent : ICloneable
{
    int x;    
    public Parent(int _x)
    {
        x = _x
    }

    public virtual object Clone()
    {
        return new Parent(x);
    }
}

class Child1 : Parent
{
    int y;

    public Child1(int _y) : base(_y)
    {
        y = _y;
    }

    public override object Clone()
    {
        return new Child1(y);
    }
}

class Child2 : Parent
{
    int z;

    public Child2(int _z) : base(_z)
    {
        z = _z;
    }

    public override object Clone()
    {
        return new Child2(z);
    }
} 
```

然后，你会像这样使用它：

```
foreach(Parent p in list)
{
    dictionaryOfCopies.Add(p, p.Clone() as Parent);
} 
```

* * *

作为魔鬼的拥护者，我看到的对`ICloneable`接口的批评之一是它不是类型安全的。如果这让您感到厌烦，您仍然可以采用相同的想法，但实现您自己的`Clone`返回方法版本，`Parent`而不是`object`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T18:37:40.520

您可以向父类添加一个克隆方法，该方法在每个子类中被覆盖。这将允许你打电话

```
dictionaryOfCopies.Add(p, p.Clone()); 
```

# c# - 一个 ASP.Net ImageButton 在 Chrome 中不工作（但另一个是......并且都在 IE 9 中工作）

> ID：11940251
> 
> 赞同：6
> 
> 时间：2012-08-13T18:33:53.033
> 
> 标签：c#, asp.net, google-chrome, imagebutton

我的一个图像按钮在 Chrome 中不起作用，但另一个按钮是（它们都在 IE 9 中起作用）：

**不工作**

```
<asp:ImageButton ID="lblCustomer" 
    ImageUrl="~/images/Customer.jpg" 
    runat="server" 
    onmouseover="this.src='images/Customer.jpg';" 
    onmouseout="this.src='images/Customer.jpg';" 
    AlternateText="Customer" 
    CausesValidation="false" 
    OnClick="ibtnCustomer_Click" 
    ToolTip="Customer" /> 
```

**在职的：**

```
<asp:ImageButton ID="ibtnUnRegisteredVendor" 
    ImageUrl="images/VendorButton.jpg" 
    runat="server" 
    onmouseover="this.src='images/VendorButtonHover.jpg';" 
    onmouseout="this.src='images/VendorButton.jpg';" 
    AlternateText="Vendor" 
    CausesValidation="false" 
    OnClick="btnUnRegisteredProvider_Click" 
    ToolTip="" /> 
```

客户按钮在 Chrome 中不可点击。
知道为什么客户按钮在 Chrome 中不起作用吗？

**更新：**

来自 Chrome 的渲染 HTML 是：

```
<div id="Customer" style="width: 100%; left: 5px;">
    <input type="image" name="Master$cphMainContent$lblCustomer" id="cphMainContent_lblCustomer" title="Customer" onmouseover="this.src=&#39;images/Customer.jpg&#39;;" onmouseout="this.src=&#39;images/Customer.jpg&#39;;" src="images/Customer.jpg" alt="Customer" />
</div>

<div id="VendorsButton">
  <input type="image" name="Master$cphMainContent$ibtnVendor" id="cphMainContent_ibtnVendor" title="Vendor log in, registration or access without registration" onmouseover="this.src=&#39;images/VendorsButtonHover.jpg&#39;;" onmouseout="this.src=&#39;images/VendorsButton.jpg&#39;;" src="images/VendorsButton.jpg" alt="Vendors" />
<div id="VendorFeaturesContainer"> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T18:36:24.283

可能是因为你对它们都有不同的路径。尝试将第一个更改`ImageUrl`为`"images/Customer.jpg"`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T22:17:11.620

如果前面的建议不起作用，则可能是虚拟目录中的 ~/ 快捷方式有问题

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-06-27T13:25:17.573

当控件 (asp:ImageButton) 是 ASPX 母版页的“内容占位符”的一部分时，IE11 与 Chrome 对 ../ 和 ~/ 的解释不同。

IE 将按预期响应前缀 ~/ 来表示 Web 应用程序的根目录。IE 正在查找从根目录向下一层的图像目录 (ImageUrl="~/images/Customer.jpg")。

在 Chrome 中，当您的图像位于与“内容 ASPX 文件”相同级别的目录中时，如果使用 ../ 前缀，插入母版页的文件将按预期响应。Chrome 将 ~/ 解释为与“内容 ASPX 文件”位于同一目录中。也就是说，Chrome 正在寻找您的图像目录作为包含“内容 ASPX 文件”的目录的子目录。

据我所知，asp:ImageButton 不适用于 javascript 函数。一种解决方法是拥有两个图像目录（IE 需要它，Chrome 需要它）和适当的 jpg、png、gif 等文件。

# ruby - 在哪里放置在多个控制器之间共享的 before_filter

> ID：11940253
> 
> 赞同：12
> 
> 时间：2012-08-13T18:33:59.650
> 
> 标签：ruby, ruby-on-rails-3, module, before-filter

我有多个控制器都使用相同的 before_filter。为了保持干燥，这种方法应该放在哪里，以便所有控制器都可以使用它？一个模块似乎不是正确的地方，虽然我不知道为什么。我不能把它放在基类中，因为控制器已经有不同的超类。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-08-14T13:47:25.043

如何将你的 before_filter 和方法放在一个模块中，并将它包含在每个控制器中。我会把这个文件放在 lib 文件夹中。

```
module MyFunctions

  def self.included(base)
    base.before_filter :my_before_filter
  end

  def my_before_filter
    Rails.logger.info "********** YEA I WAS CALLED ***************"
  end
end 
```

然后在您的控制器中，您所要做的就是

```
class MyController < ActionController::Base
  include MyFunctions
end 
```

最后，我会确保 lib 是自动加载的。打开 config/application.rb 并将以下内容添加到您的应用程序的类中。

```
config.autoload_paths += %W(#{config.root}/lib) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-13T18:39:56.853

可以做这样的事情。

```
Class CommonController < ApplicationController
  # before_filter goes here
end

Class MyController < CommonController
end

class MyOtherController < CommonController
end 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-13T18:42:32.567

将`before_filter`放在控制器的共享超类中。如果您必须在继承链上走这么远，这最终成为`ApplicationController`，并且您被迫将其`before_filter`应用于某些不应该应用于的控制器，您应该`skip_before_filter`在这些特定的控制器中使用：

```
class ApplicationController < ActionController::Base
  before_filter :require_user
end

# Login controller shouldn't require a user
class LoginController < ApplicationController
  skip_before_filter :require_user
end

# Posts requires a user
class PostsController < ApplicationController

end

# Comments requires a user
class CommentsController < ApplicationController

end 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-13T18:38:06.873

如果它是所有控制器通用的，你可以把它放在应用程序控制器中。如果没有，您可以创建一个新控制器并将其设为所有控制器的超类并将代码放入其中。

# asp.net-mvc-4 - 如何在 jsRender 等客户端编程中使用服务器端数据注释

> ID：11940254
> 
> 赞同：2
> 
> 时间：2012-08-13T18:34:04.333
> 
> 标签：asp.net-mvc-4, data-annotations, asp.net-web-api, jsrender

在我们在 MVC4 中使用 WebAPI 之前以及在 jsRender 变为 beta 之前，我们使用服务器端编程生成表单。也就是在视图模型上添加Data Annotations，然后生成一个有很多`@Html.EditorFor`and的表单`@Html.LabelFor`。（如果你是一名 MVC 程序员，你就会明白我的意思。）然后 jQuery 验证将帮助我们在客户端进行数据验证，而 DataAnnotation 属性通过检查`Model.IsValid`. 一切都很好。

现在我们有了`WebAPI`. 大多数示例是使用Javascript调用Ajax来`WebAPI`在服务器和客户端之间传输表单数据（主要是json）的动作。jsRender（或其他类型的模板库）用于呈现数据。

我喜欢进行 Ajax 调用以避免不必要的整页呈现的想法。但主要困难在于，由于表单是作为模板准备的，它绑定到客户端的数据，因此无法将 DataAnnotation 等服务器端技术与 jQuery-validation 结合起来。而且我们无法使用`@Html.EditorFor`. 看来我们失去了许多以前在 MVC3 中所拥有的巨大好处。

那么，各位专家如何处理呢？您是否完全抛弃了服务器端技术，只在模板中写出所有内容供客户端使用？

如果我们只能在客户端做所有事情，我们如何利用 jQuery 验证？我们是否`data-val-xxx`手动添加这些标签？

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T18:46:04.940

对 ASP.NET MVC 采用 AJAX 方法**并不**排除使用 ASP.NET 验证功能。但是，您必须编写自己的服务器端和客户端架构来处理这些场景。基本上，您希望您的 Web API 能够为任何方法抛出验证消息。此外，您希望您的客户端 JavaScript 能够随时处理这些消息。

在我目前正在开发的 ASP.NET MVC + Knockout 应用程序中，我正在这样做。它涉及：

*   **服务器端**. `ActionFilterAttribute`将模型验证错误转换为 JSON的自定义
*   **客户端**. 一些 JavaScript 技巧来解释验证错误。

在我对服务器进行的每次 REST 调用中，我都会检查返回时的 HTTP 状态代码。`200`表示成功，应用程序正常进行。`400`表示 Bad Request，表示返回了一条或多条验证消息。

在 a 的情况下`400`，响应的主体包含一个带有所有验证消息的 JSON 数组。这些消息是简单的元组，由输入元素的名称和错误消息组成。

我添加了一个新`data-val-server`属性，该属性总是使其设置的输入元素无效。我从服务器获得的数据告诉我放置属性的元素。该属性的值是也来自服务器的错误消息。之后，我只需启动客户端验证，它将解析表单、使表单无效并查看适当的消息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T16:09:23.243

@Martin Devlers 有人在这里做过：[http ://sixgun.wordpress.com/2012/03/28/asp-net-web-api-validation-with-data-annotations/](http://sixgun.wordpress.com/2012/03/28/asp-net-web-api-validation-with-data-annotations/)

# sap-gui - 为 SAP GUI v7.2 创建快捷方式

> ID：11940255
> 
> 赞同：1
> 
> 时间：2012-08-13T18:34:06.453
> 
> 标签：sap-gui

如何为 SAP GUI v7.2 创建快捷方式？我读过它需要创建一个快捷方式文件，它需要以`*.ini`某种方式格式化。我找不到如何格式化它或它需要保存在哪里。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T18:34:06.453

要在 7.2 版中为 SAP GUI 创建快捷方式，您需要创建一个名为“sapshortcut.ini”的文件并将该文件放在 c:\WINDOWS 目录中。SAP GUI 将从该文件中提取信息并显示您编写它们的快捷方式。文件中需要遵循某种格式才能使一切正常工作。您可以使用 notepad++ 创建此文件。

```
[Label]
Key1="10) --- Production ---"
Key2="11) Your Environment Name"
Key3="12) PD1"

[Command]
Key1=-desc="---------------------" -type="-------------" -tit"10) --- Production ---"
Key2=-desc="Environment Description" -sid="Environment ID" -clt="Client Number" -gui="url to gui" -u="username" -l="language" -tit="11) Environment" -wd="Directory Path" -guisize="maximized"
Key3=-desc="Prod 1" -sid="PD1" -clt="100" -gui="Your GUI URL" -u="User123" -l="EN" -tit="12) PD1" -wd="C:\Documents and Settings\User123\SapWorkDir" -guisize="maximized" 
```

注意：默认情况下，GUI 将根据“-tit”条目进行组织，因此我将数字放在条目的前面来组织我的快捷方式。另请注意，Key1 是一个假的快捷方式，它只是为了组织而存在，因此它下面的所有快捷方式都是生产环境的一部分。

# spring - Spring PermGen 空间问题

> ID：11940267
> 
> 赞同：6
> 
> 时间：2012-08-13T18:34:48.357
> 
> 标签：spring, memory, weblogic

我一直有一个非常严重的生产问题，我希望有人能帮忙。

我使用的是 Spring 3.1.0，它的功能给我留下了深刻的印象。

在开发过程中，一切都很好。不幸的是，在部署到生产环境时，我们遇到了一些问题。

我们正在获取 PermGen 空间内存不足错误。

在我们的开发/测试盒上，我们有以下设置： -Xms2048m -Xmx2048m -XX:PermSize=512m -XX:MaxPermSize=1024m（请注意，我们*不确定*这些设置是否正确）

在我们的生产机器上，我们有以下设置： -Xms3056m -Xmx3056m -XX:PermSize=128m -XX:MaxPermSize=512m（再次请注意，我们*不确定*这些设置是否正确）

诚然，生产环境完全不同，因为它运行着更多的应用程序。

根据我在[这里](https://forums.oracle.com/forums/thread.jspa?messageID=5209737)阅读的内容，我们应该将 max 和 min 设置为相同的值，并将 maxpermsize 设置为其中任何一个的 1/4。

我在许多地方（包括[这里](https://stackoverflow.com/questions/1124131/what-can-be-done-with-permgen-out-of-space-exception-in-tomcat-spring-hibernat)）读到，由于泄漏可能无法避免重新启动服务器。有人知道这是否属实吗？

另外，有人知道 Spring 框架通常需要多少内存吗？部署应用程序后，我发现使用的内存量增加了大约 345 MB。我知道在应用程序启动时需要实例化许多类，但这似乎很多。我有什么设置不正确吗？我们目前只使用 Spring JDBC。有没有办法将框架限制在这些类中？

我们的代码库相当大，我知道[JAXB 会导致严重的问题](https://stackoverflow.com/a/5573750/487812)。

我已经看到了使用的建议

```
-XX:+CMSClassUnloadingEnabled -XX:+CMSPermGenSweepingEnabled 
```

[这里](https://stackoverflow.com/questions/5509378/permgen-space-issue-with-glassfish-hibernate)和[这里](https://stackoverflow.com/questions/4827544/java-lang-outofmemoryerror-permgen-space)。使用这些论点是否有任何可能的负面影响？

所以，总结一下：

1.  我们的设置是否正确，如果不正确，它们应该是什么？

2.  使用 Spring 框架是否不可避免地会不时重启服务器？

3.  Spring 应该占用多少内存？有没有办法限制使用的类？

4.  使用是否有任何可能的副作用`-XX:+CMSClassUnloadingEnabled -XX:+CMSPermGenSweepingEnabled`？

任何和所有的帮助将不胜感激。提前致谢。

堆栈跟踪如下（还有更多，但我无法全部发布）：

```
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter': Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Could not instantiate bean class [org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter]: Constructor threw exception; nested exception is java.lang.OutOfMemoryError: PermGen space
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateBean(AbstractAutowireCapableBeanFactory.java:997)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:943)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:485)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:286)
    at org.springframework.web.servlet.DispatcherServlet.createDefaultStrategy(DispatcherServlet.java:788)
    at org.springframework.web.servlet.DispatcherServlet.getDefaultStrategies(DispatcherServlet.java:757)
    at org.springframework.web.servlet.DispatcherServlet.initHandlerAdapters(DispatcherServlet.java:565)
    at org.springframework.web.servlet.DispatcherServlet.initStrategies(DispatcherServlet.java:422)
    at org.springframework.web.servlet.DispatcherServlet.onRefresh(DispatcherServlet.java:410)
    at org.springframework.web.servlet.FrameworkServlet.onApplicationEvent(FrameworkServlet.java:752)
    at org.springframework.web.servlet.FrameworkServlet$ContextRefreshListener.onApplicationEvent(FrameworkServlet.java:989)
    at org.springframework.web.servlet.FrameworkServlet$ContextRefreshListener.onApplicationEvent(FrameworkServlet.java:1)
    at org.springframework.context.event.GenericApplicationListenerAdapter.onApplicationEvent(GenericApplicationListenerAdapter.java:51)
    at org.springframework.context.event.SourceFilteringListener.onApplicationEventInternal(SourceFilteringListener.java:97)
    at org.springframework.context.event.SourceFilteringListener.onApplicationEvent(SourceFilteringListener.java:68)
    at org.springframework.context.event.SimpleApplicationEventMulticaster.multicastEvent(SimpleApplicationEventMulticaster.java:97)
    at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:324)
    at org.springframework.context.support.AbstractApplicationContext.finishRefresh(AbstractApplicationContext.java:929)
    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:467)
    at org.springframework.web.servlet.FrameworkServlet.configureAndRefreshWebApplicationContext(FrameworkServlet.java:631)
    at org.springframework.web.servlet.FrameworkServlet.createWebApplicationContext(FrameworkServlet.java:588)
    at org.springframework.web.servlet.FrameworkServlet.createWebApplicationContext(FrameworkServlet.java:645)
    at org.springframework.web.servlet.FrameworkServlet.initWebApplicationContext(FrameworkServlet.java:508)
    at org.springframework.web.servlet.FrameworkServlet.initServletBean(FrameworkServlet.java:449)
    at org.springframework.web.servlet.HttpServletBean.init(HttpServletBean.java:133)
    at javax.servlet.GenericServlet.init(GenericServlet.java:241)
    at weblogic.servlet.internal.StubSecurityHelper$ServletInitAction.run(StubSecurityHelper.java:283)
    at weblogic.security.acl.internal.AuthenticatedSubject.doAs(AuthenticatedSubject.java:321)
    at weblogic.security.service.SecurityManager.runAs(SecurityManager.java:121)
    at weblogic.servlet.internal.StubSecurityHelper.createServlet(StubSecurityHelper.java:64)
    at weblogic.servlet.internal.StubLifecycleHelper.createOneInstance(StubLifecycleHelper.java:58)
    at weblogic.servlet.internal.StubLifecycleHelper.<init>(StubLifecycleHelper.java:48)
    at weblogic.servlet.internal.ServletStubImpl.prepareServlet(ServletStubImpl.java:539)
    at weblogic.servlet.internal.WebAppServletContext.preloadServlet(WebAppServletContext.java:1976)
    at weblogic.servlet.internal.WebAppServletContext.loadServletsOnStartup(WebAppServletContext.java:1950)
    at weblogic.servlet.internal.WebAppServletContext.preloadResources(WebAppServletContext.java:1869)
    at weblogic.servlet.internal.WebAppServletContext.start(WebAppServletContext.java:3126)
    at weblogic.servlet.internal.WebAppModule.startContexts(WebAppModule.java:1512)
    at weblogic.servlet.internal.WebAppModule.start(WebAppModule.java:486)
    at weblogic.application.internal.flow.ModuleStateDriver$3.next(ModuleStateDriver.java:425)
    at weblogic.application.utils.StateMachineDriver.nextState(StateMachineDriver.java:41)
    at weblogic.application.internal.flow.ModuleStateDriver.start(ModuleStateDriver.java:119)
    at weblogic.application.internal.flow.ScopedModuleDriver.start(ScopedModuleDriver.java:200)
    at weblogic.application.internal.flow.ModuleListenerInvoker.start(ModuleListenerInvoker.java:247)
    at weblogic.application.internal.flow.ModuleStateDriver$3.next(ModuleStateDriver.java:425)
    at weblogic.application.utils.StateMachineDriver.nextState(StateMachineDriver.java:41)
    at weblogic.application.internal.flow.ModuleStateDriver.start(ModuleStateDriver.java:119)
    at weblogic.application.internal.flow.StartModulesFlow.activate(StartModulesFlow.java:27)
    at weblogic.application.internal.BaseDeployment$2.next(BaseDeployment.java:1267)
    at weblogic.application.utils.StateMachineDriver.nextState(StateMachineDriver.java:41)
    at weblogic.application.internal.BaseDeployment.activate(BaseDeployment.java:409)
    at weblogic.application.internal.EarDeployment.activate(EarDeployment.java:58)
    at weblogic.application.internal.DeploymentStateChecker.activate(DeploymentStateChecker.java:161)
    at weblogic.deploy.internal.targetserver.AppContainerInvoker.activate(AppContainerInvoker.java:79)
    at weblogic.deploy.internal.targetserver.operations.AbstractOperation.activate(AbstractOperation.java:569)
    at weblogic.deploy.internal.targetserver.operations.ActivateOperation.activateDeployment(ActivateOperation.java:150)
    at weblogic.deploy.internal.targetserver.operations.ActivateOperation.doCommit(ActivateOperation.java:116)
    at weblogic.deploy.internal.targetserver.operations.StartOperation.doCommit(StartOperation.java:143)
    at weblogic.deploy.internal.targetserver.operations.AbstractOperation.commit(AbstractOperation.java:323)
    at weblogic.deploy.internal.targetserver.DeploymentManager.handleDeploymentCommit(DeploymentManager.java:844)
    at weblogic.deploy.internal.targetserver.DeploymentManager.activateDeploymentList(DeploymentManager.java:1253)
    at weblogic.deploy.internal.targetserver.DeploymentManager.handleCommit(DeploymentManager.java:440) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-05-30T00:00:16.617

为了查看 permGen VM，您可以查看`MemoryPool`JConsole 中的 MBean。此外，您可以添加以下 JVM 参数（如果您还没有）

```
-XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=/opt/msp/log 
```

用于堆转储收集。

```
-XX:+PrintGC -XX:+PrintGCDetails -XX:+PrintGCTimeStamps -Xloggc:/opt/msp/log/gc.log` 
```

获取 GC 相关信息。

这将有助于理解垃圾收集模式，并可能指导您提出更好的限制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T18:46:26.237

很难说有多少内存最适合生产环境。-Xms 不必相等（或与 -Xmx 一样高）。您可以将其设置为较低的值，但增加 -XX:PermSize 的值。此外，要得出最佳值，您应该尝试进行基准测试以查看最佳结果。

# android - 更新启动活动的意图

> ID：11940268
> 
> 赞同：3
> 
> 时间：2012-08-13T18:34:56.963
> 
> 标签：android, android-intent

我有一个意图启动一个活动，该活动显示`alert dialog`新消息何时来自`GCM (Google Cloud Messenger)`。对话框显示未读消息的数量，但如果在显示一条新消息之后出现新消息并且您尚未查看前一条消息，则对话框应更新未读计数以反映新消息/未读消息的数量。

但是，如果带有对话框的活动处于活动状态，则意图不会更新对话框，那么由于无法在对话框上调用解除，我该如何更新它？

有新消息时的意图

```
if((incMsgs + dlMsgs) > 0 && !mMsgType.equals("Reg")){
                edit.putBoolean(Preferences.NEW_ALERT, true).commit();
                priorityMsgs = true;
                Intent i = new Intent(this,NotificationDialog.class);
                i.putExtra("incidents", incMsgs);
                i.putExtra("dlMessages", dlMsgs);
                i.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
                startActivity(i);
            } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-13T18:42:29.600

您将不得不覆盖活动的[OnNewIntent](http://developer.android.com/reference/android/app/Activity.html#onNewIntent%28android.content.Intent%29)。在此更新中，UI 元素。为此，您的活动启动模式需要为 singleTop

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-02-20T00:06:15.697

我已经通过在我的意图中添加这个来解决我的问题：

```
intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK | Intent.FLAG_ACTIVITY_CLEAR_TOP); 
```

也许这也可以帮助你。

# vb.net - 如何仅显示查询结果的第一行

> ID：11940269
> 
> 赞同：0
> 
> 时间：2012-08-13T18:34:56.573
> 
> 标签：vb.net

在下面的代码中，我只想在第一行显示来自数据库的数据。如何显示数据？

```
Dim sql As String
sql = "SELECT * FROM category "
Dim adp As New OleDbDataAdapter(sql, conn)
Dim dataset As New DataSet
adp.Fill(dataset, "Table")
For Each dbrow As DataRow In dataset.Tables("Table").Rows
    'subcate.Items.Add(dbrow.Item("sub_cate"))
    DataGridView1.CurrentRow.Cells(0).Value = dbrow.Item("code")
Next 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T19:02:32.090

与从数据库中检索整个列表然后只显示第一行相比，让数据库完成工作并只返回第一行更有效，特别是在`categories`表有大量记录的情况下。实际的 SQL 语法可能会因您使用的数据库而异，但您可以尝试以下操作：

```
Dim sql as string = "SELECT TOP 1 * FROM category" 
```

此外，如果您将数据显示为只读，请考虑使用`OleDbCommand`对象而不是对象，因为创建对象的开销更大。`OleDbDataAdapter``DataAdapter`

# android - 从 OSX 使用 ANT 构建 Android 应用程序会导致 NullPointerException

> ID：11940271
> 
> 赞同：1
> 
> 时间：2012-08-13T18:35:03.767
> 
> 标签：android, macos, ant, build, jenkins

我运行以下命令（它是一个 lib 项目..但我也在常规项目中得到它）：

```
android 更新 lib-project -t "android-16" -p whatever_my_project_is
ant clean debug -v -d -f "${WORKSPACE}/whatever_my_project_is/build.xml"

```

它开始像往常一样构建项目中的各种类，但是在 R.java 期间发生了这个空指针异常

```
/Users/Shared/Jenkins/Home/jobs/Androidyaddayadda 1/workspace/whatever_my_project_is/yadda/yadda/R.java
    [javac] 编译器 (1.6.0_33) 发生异常。在检查 Bug Parade 是否有重复项后，请在 Java 开发人员连接 (http://java.sun.com/webapps/bugreport) 提交错误。在报告中包含您的程序和以下诊断。谢谢你。
    [javac] java.lang.NullPointerException
    [javac] 在 com.sun.tools.javac.comp.Check.checkCompatibleConcretes(Check.java:1213)
    [javac] 在 com.sun.tools.javac.comp.Check.checkCompatibleSupertypes(Check.java:1565)
    [javac] 在 com.sun.tools.javac.comp.Attr.attribClassBody(Attr.java:2674)
    [javac] 在 com.sun.tools.javac.comp.Attr.attribClass(Attr.java:2628)
    [javac] 在 com.sun.tools.javac.comp.Attr.attribClass(Attr.java:2584)
    [javac] 在 com.sun.tools.javac.comp.Attr.attribClass(Attr.java:2564)
    [javac] 在 com.sun.tools.javac.main.JavaCompiler.attribute(JavaCompiler.java:1045)
    [javac] 在 com.sun.tools.javac.main.JavaCompiler.compile2(JavaCompiler.java:768)
    [javac] 在 com.sun.tools.javac.main.JavaCompiler.compile(JavaCompiler.java:730)
    [javac] 在 com.sun.tools.javac.main.Main.compile(Main.java:353)
    [javac] 在 com.sun.tools.javac.main.Main.compile(Main.java:279)
    [javac] 在 com.sun.tools.javac.main.Main.compile(Main.java:270)
    [javac] 在 com.sun.tools.javac.Main.compile(Main.java:69)
    [javac] 在 sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    [javac] 在 sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    [javac] 在 sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    [javac] 在 java.lang.reflect.Method.invoke(Method.java:597)
    [javac] 在 org.apache.tools.ant.taskdefs.compilers.Javac13.execute(Javac13.java:56)
    [javac] 在 org.apache.tools.ant.taskdefs.Javac.compile(Javac.java:1134)
    [javac] 在 org.apache.tools.ant.taskdefs.Javac.execute(Javac.java:912)
    [javac] 在 org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:291)
    [javac] 在 sun.reflect.GeneratedMethodAccessor4.invoke（未知来源）
    [javac] 在 sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    [javac] 在 java.lang.reflect.Method.invoke(Method.java:597)
    [javac] 在 org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:106)
    [javac] 在 org.apache.tools.ant.Task.perform(Task.java:348)
    [javac] 在 org.apache.tools.ant.taskdefs.Sequential.execute(Sequential.java:68)
    [javac] 在 com.android.ant.IfElseTask.execute(IfElseTask.java:120)
    [javac] 在 org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:291)
    [javac] 在 sun.reflect.GeneratedMethodAccessor4.invoke（未知来源）
    [javac] 在 sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    [javac] 在 java.lang.reflect.Method.invoke(Method.java:597)
    [javac] 在 org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:106)
    [javac] 在 org.apache.tools.ant.Task.perform(Task.java:348)
    [javac] 在 org.apache.tools.ant.taskdefs.Sequential.execute(Sequential.java:68)
    [javac] 在 org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:291)
    [javac] 在 sun.reflect.GeneratedMethodAccessor4.invoke（未知来源）
    [javac] 在 sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    [javac] 在 java.lang.reflect.Method.invoke(Method.java:597)
    [javac] 在 org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:106)
    [javac] 在 org.apache.tools.ant.Task.perform(Task.java:348)
    [javac] 在 org.apache.tools.ant.taskdefs.MacroInstance.execute(MacroInstance.java:398)
    [javac] 在 org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:291)
    [javac] 在 sun.reflect.GeneratedMethodAccessor4.invoke（未知来源）
    [javac] 在 sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    [javac] 在 java.lang.reflect.Method.invoke(Method.java:597)
    [javac] 在 org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:106)
    [javac] 在 org.apache.tools.ant.Task.perform(Task.java:348)
    [javac] 在 org.apache.tools.ant.Target.execute(Target.java:390)
    [javac] 在 org.apache.tools.ant.Target.performTasks(Target.java:411)
    [javac] 在 org.apache.tools.ant.Project.executeSortedTargets(Project.java:1399)
    [javac] 在 org.apache.tools.ant.Project.executeTarget(Project.java:1368)
    [javac] 在 org.apache.tools.ant.helper.DefaultExecutor.executeTargets(DefaultExecutor.java:41)
    [javac] 在 org.apache.tools.ant.Project.executeTargets(Project.java:1251)
    [javac] 在 org.apache.tools.ant.Main.runBuild(Main.java:809)
    [javac] 在 org.apache.tools.ant.Main.startAnt(Main.java:217)
    [javac] 在 org.apache.tools.ant.launch.Launcher.run(Launcher.java:280)
    [javac] 在 org.apache.tools.ant.launch.Launcher.main(Launcher.java:109)

```

有谁知道在 OSX 上通过 Ant 构建 Android 的解决方法？我正在使用 Jenkins .. 但该命令通过 bash 为我做同样的事情。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T06:47:39.247

[这似乎是java中的一个错误](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=6292765)

根据 Bug 报告，这应该在 Java 1.7 中修复，而不是在 1.6 或 1.5 中。

# java - 子类可以强制调用父类方法成为编译器错误吗？

> ID：11940278
> 
> 赞同：1
> 
> 时间：2012-08-13T18:35:28.857
> 
> 标签：java

我正在尝试制作自己的异常，该异常**需要**在构造时给出一个字符串，以便可以在捕获时间将字符串传递给用户。目前，在我的代码中，我为我的类的零参数构造函数抛出了 IllegalArgumentException。我真正想要的是能够为我的子类调用零参数构造函数使其成为编译器错误，而不是例如为 Exception 调用零参数构造函数。

那可能吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-13T18:39:32.000

是的，不提供默认构造函数，那么就不能调用它。（假设你有另一个构造函数）

# php - 将 DATE 插入 MySQL 数据库 - 错误

> ID：11940279
> 
> 赞同：0
> 
> 时间：2012-08-13T18:35:35.733
> 
> 标签：php, mysql, sql

当我尝试字符串替换日期并将其保存在`mySQL`数据库中时出现错误。原因是`DATE`字段的格式。我在下面添加了我的`PHP`代码和`mySQL`错误消息。

```
$nowDate = str_replace('/', '-', $_POST['datenow']); 

echo $nowDate; 
```

输出 > `08-15-2012`，我正在将此记录插入数据库，但`MySQL`数据库需要格式`yyyy-mm-dd`( `2012-08-15`) 否则我会收到错误

```
Unable1 to run query:Incorrect date value: '08-15-2012' for column 'now_date' at row 1 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-13T18:37:37.027

正如错误所指出的，日期的格式需要是`yyyy-mm-dd`.

[`date()`](http://php.net/date)您可以在使用and插入之前对其进行格式化[`strtotime()`](http://php.net/strtotime)：

```
$nowDate = date('Y-m-d', strtotime($_POST['datenow'])); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-13T18:40:55.947

尝试这个

```
$nowDate = date('Y-m-d',strtotime($_POST['datenow'])); 
```

或者更好的是，如果你只是想添加当前日期，让 MySQL 像这样为你做。这消除了清理输入数据的需要。

```
INSERT INTO table SET date_field = NOW(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T18:38:32.783

所以有什么问题？您已经说过您知道 MySQL 需要某种格式，但想要使用不受支持的格式。如果你坚持使用你的“坏”格式，那么[`STR_TO_DATE()`](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_str-to-date)在你的插入查询中调查使用，或者将你的 PHP 字符串转换为有效的 MySQL 日期格式。

# java - 从 A 到 B 平滑移动

> ID：11940282
> 
> 赞同：1
> 
> 时间：2012-08-13T18:35:43.173
> 
> 标签：java, android, algorithm, math

我有一个 android 游戏，我必须不时将相机（可见屏幕部分）从 A 点移动到 B 点。

显然我可以这样做：

```
camera.setCenter(B.getX(), B.getY(); 
```

但它看起来不太好，它只是立即跳转，而我想要实现的是从 A 到 B 的平滑移动。我可以访问 onUpdate 方法，它是循环更新某些游戏对象（所以我可以在某些毫秒内执行某些事情）

我真的不知道如何创建这样的算法，以允许两点之间的平滑移动（分类我不知道如何计算我应该添加什么值到

```
camera.setCenter(camera.getX() + xValue, camera.getY() + yValue) 
```

因为必须计算这些值取决于这两个点之间的距离。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-13T18:40:24.157

如果您的游戏以每秒 60 帧的速度更新，并且您希望转换需要两秒钟，那么它应该需要 120 帧才能到达那里。

因此，它应该在任何给定更新中移动的量是`total/120`.

您可以将其抽象为一个方法，该方法对移动进行排队，计算 FPS 和每次更新的移动量，并调用`.setCenter`其当前位置和更新量。这通常称为[插值](http://en.wikipedia.org/wiki/Interpolation)。要确定你需要移动多远，它的绝对值不超过`current - destination`（哪个在另一个前面并不重要，所以我们只取绝对值忽略符号。从技术上讲，[距离是一个标量，而位置是向量](http://www.physicsclassroom.com/class/1dkin/u1l1b.cfm)）。

因此，总结为半代码（我不知道这些功能的实际合同）：

```
//given these variables already have value
double fps, currentX, destinationX, currentY, destinationY, animationLength; //animation length in seconds
...
double xValue = Math.abs(currentX - destinationX);
double yValue = Math.abs(currentY - destinationY);
...
//on each update:
double amountToMoveX = xValue / (animationLength * fps);
double amountToMoveY = yValue / (animationLength * fps);
camera.setCenter(camera.getX() + amountToMoveX, camera.getY() + amountToMoveY) 
```

然后，您只需要跟踪何时停止，就可以开始了。

我不知道您是否正在使用已经具备执行此功能的引擎。但就纯粹的算法而言，这似乎是要走的路。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T18:41:36.777

请参阅[此问题的讨论](https://stackoverflow.com/questions/6456414/velocity-calculation-algorithm)

从答案：

> 长度=平方根((bx - ax)^2+(by - ay)^2)
> 
> 速度X = (bx - ax) / 长度 * 速度
> 
> 速度Y = (by - ay) / 长度 * 速度

其中xValue 是velocityX 和Y 类似

# python - django URLValidator 产生虚假错误

> ID：11940288
> 
> 赞同：9
> 
> 时间：2012-08-13T18:36:11.207
> 
> 标签：python, django, url-validation

我`URLValidator`在表单中以下列方式使用 Django：

```
def clean_url(self):
    validate = URLValidator(verify_exists=True)
    url = self.cleaned_data.get('url')

    try:
        logger.info(url)
        validate(url)
    except ValidationError, e:
        logger.info(e)
        raise forms.ValidationError("That website does not exist. Please try again.")

    return self.cleaned_data.get('url') 
```

它似乎适用于某些 url，但对于某些有效的，它会失败。我可以通过[http://www.amazon.com/](http://www.amazon.com/)检查它是否失败（这显然是不正确的）。它通过[http://www.cisco.com/](http://www.cisco.com/)传递。虚假错误有什么原因吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-13T18:56:10.937

查看[源代码`URLValidator`](https://github.com/django/django/blob/stable/1.4.x/django/core/validators.py#L94)；如果您指定`check_exists`，它会`HEAD`向 URL 发出请求以检查它是否有效：

```
req = urllib2.Request(url, None, headers)
req.get_method = lambda: 'HEAD'
...
opener.open(req, timeout=10) 
```

尝试`HEAD`自己向亚马逊提出请求，您会看到问题：

```
carl@chaffinch:~$ HEAD http://www.amazon.com
405 MethodNotAllowed
Date: Mon, 13 Aug 2012 18:50:56 GMT
Server: Server
Vary: Accept-Encoding,User-Agent
Allow: POST, GET
... 
```

`URLValidator`除了猴子补丁或以其他方式扩展以使用`GET`或`POST`请求之外，我看不到解决此问题的方法；在这样做之前，您应该仔细考虑是否要使用`check_exists`（没有它，这个问题应该消失）。正如`core/validators.py`它自己所说，

> “该`URLField` `verify_exists`论点存在棘手的安全和性能问题。因此，它已被弃用。”

你会发现 Django 的开发版本确实已经完全抛弃了这个特性。

# arcgis - 在 ios 的 arcgis 中手绘地图

> ID：11940290
> 
> 赞同：0
> 
> 时间：2012-08-13T18:36:18.743
> 
> 标签：arcgis

我正在使用 arcgis 为 ios 制作一个应用程序，该应用程序允许用户通过拖动手指在地图上自由绘制（红线）。我曾尝试使用 arcgis 提供的草图层示例来实现这一点，但没有运气。我也尝试使用 opengl，但我的绘图并没有停留在它绘制的位置。简而言之，我试图做的是在地图上徒手绘制，当我平移和缩放地图时，绘图会停留在绘制它的地图上的坐标处，并根据缩放进行拉伸和收缩。

使用 opengl 视图，我能够绘制。我的问题是我需要让图纸保持在地质坐标上。这是我的绘图代码。目前我正在获取屏幕上x和y的触摸坐标，需要将其更改为地图上的经度和纬度，然后将其转换为屏幕上的x和y。我不知道该怎么做。

```
 // Drawings a line onscreen based on where the user touches
    - (void) renderLineFromPoint:(CGPoint)start toPoint:(CGPoint)end
    {
         static GLfloat*     vertexBuffer = NULL;
         static NSUInteger   vertexMax = 64;
         NSUInteger vertexCount = 0, count, i;
         [EAGLContext setCurrentContext:context];
         glBindFramebufferOES(GL_FRAMEBUFFER_OES, viewFramebuffer);

    // Convert locations from Points to Pixels
         CGFloat scale = self.contentScaleFactor;
         start.x *= scale;
         start.y *= scale;
         end.x *= scale;
         end.y *= scale;

    // Allocate vertex array buffer
         if(vertexBuffer == NULL)
         vertexBuffer = malloc(vertexMax * 2 * sizeof(GLfloat));

    // Add points to the buffer so there are drawing points every X pixels
         count = MAX(ceilf(sqrtf((end.x - start.x) * (end.x - start.x) + (end.y -start.y) * (end.y - start.y)) / kBrushPixelStep), 1);
         for(i = 0; i < count; ++i) 
         {
              if(vertexCount == vertexMax) 
              {
                   vertexMax = 2 * vertexMax;
                   vertexBuffer = realloc(vertexBuffer, vertexMax * 2 * sizeof GLfloat));
              }
              vertexBuffer[2 * vertexCount + 0] = start.x + (end.x - start.x) * ((GLfloat)i / (GLfloat)count);
              vertexBuffer[2 * vertexCount + 1] = start.y + (end.y - start.y) * ((GLfloat)i / (GLfloat)count);
              vertexCount += 1;
         }

    // Render the vertex array
         glVertexPointer(2, GL_FLOAT, 0, vertexBuffer);
         glDrawArrays(GL_POINTS, 0, vertexCount);

    // Display the buffer
         glBindRenderbufferOES(GL_RENDERBUFFER_OES, viewRenderbuffer);
         [context presentRenderbuffer:GL_RENDERBUFFER_OES];
    }

// Reads previously recorded points and draws them onscreen. This is the 
Shake Me message that appears when the application launches.
- (void) playback:(NSMutableArray*)recordedPaths
{
    NSData* data = [recordedPaths objectAtIndex:0];
    CGPoint* point = (CGPoint*)[data bytes];
    NSUInteger count = [data length] / sizeof(CGPoint), i;
    // Render the current path
    for(i = 0; i < count - 1; ++i, ++point)
        [self renderLineFromPoint:*point toPoint:*(point + 1)];
    // Render the next path after a short delay 
    [recordedPaths removeObjectAtIndex:0];
    if([recordedPaths count])
        [self performSelector:@selector(playback:) withObject:recordedPaths 
    afterDelay:0.01];
}

// Handles the start of a touchPaintingView.m 12-08-07 9:34 AM
- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event
{
     CGRect bounds = [self bounds];
     UITouch*    touch = [[event touchesForView:self] anyObject];
     firstTouch = YES;
     // Convert touch point from UIView referential to OpenGL one (upside-down flip)
     location = [touch locationInView:self];
     location.y = bounds.size.height - location.y;
}

// Handles the continuation of a touch.
- (void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event
{  

     CGRect bounds = [self bounds];
     UITouch* touch = [[event touchesForView:self] anyObject];

     // Convert touch point from UIView referential to OpenGL one (upside-down flip)
     if (firstTouch) 
     {
         firstTouch = NO;
         previousLocation = [touch previousLocationInView:self];
         previousLocation.y = bounds.size.height - previousLocation.y;
     }
     else 
     {
         location = [touch locationInView:self];
         location.y = bounds.size.height - location.y;
         previousLocation = [touch previousLocationInView:self];
         previousLocation.y = bounds.size.height - previousLocation.y;
     }

     // Render the stroke
     [self renderLineFromPoint:previousLocation toPoint:location];
}

// Handles the end of a touch event when the touch is a tap.
- (void)touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event
{
     CGRect bounds = [self bounds];
     UITouch*    touch = [[event touchesForView:self] anyObject];
     if (firstTouch) 
     {
          firstTouch = NO;
          previousLocation = [touch previousLocationInView:self];
          previousLocation.y = bounds.size.height - previousLocation.y;
          [self renderLineFromPoint:previousLocation toPoint:location];
     }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-17T05:12:15.480

为了这

“目前我正在获取屏幕上 x 和 y 的触摸坐标，需要将其更改为地图上的经度和纬度，然后将其转换为屏幕上的 x 和 y。我不知道该怎么做。”

我建议将触摸笔画的所有坐标保存在一个数组中，然后将这些坐标添加到 AGSPolyline。方法如下

1.  为数组中的每个坐标创建 CGPoint。
2.  使用 [self.mapview toMapPoint:CGPoint] 将 CGPoint 转换为 AGSPoint
3.  使用 addpointtopath 方法将点添加到 agspolyline

# razor - 在标签上显示 jquery 验证消息以在 MVC 剃须刀中输入

> ID：11940292
> 
> 赞同：0
> 
> 时间：2012-08-13T18:36:24.170
> 
> 标签：razor, validation, jquery-validate

我正在尝试对 MVC razor 进行 jquery 验证并正常工作。我以前在 MVC2 中做过这个，但我需要弄清楚如何使用 LabelFor(DateOfBirth => Model.DateOfBirth) 来让它工作......

由于某种原因，该消息永远不会在标签中弹出。我看过调试器，我也不在那里

```
<tr><td>
      @Html.LabelFor(DateOfBirth => Model.DateOfBirth)
      </td>
      <td>
      @Html.TextBoxFor(DateOfBirth => Model.DateOfBirth, new { @Value = Model.DateOfBirth })
</td></tr> 
```

那将是包含我的 DateOfBirth 行元素的表行...

```
rules:{
       DateOfBirth: {
            required: true
       }
},
messages: {
            HospitalFinNumber: 'Please Enter a valid Hospital Fin number',
            DateOfBirth: 'Please enter a valid Date Of Birth',
            AdmitDate: 'Please select an Admit Date',
            Comment: 'Why dont you stop attempting to put in more than 4000 characters?  Thanks...'
} 
```

我的 DateOfBirth 消息没有显示在标签中……我错过了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T18:57:55.480

您使用 HTML 帮助程序和属性的方式似乎一切都很好。要检查的两件事：

-确保您正在导入 jquery.validate 库

- 确保在您的模型中，您的属性**DateOfBirth**使用 [ **Required** ] 属性进行修饰，并设置**ErrorMessage**属性，如下所示：

```
 [Required(ErrorMessage="Field Required")]
    public Datetime DateOfBirth { get; set; } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T18:59:36.070

您的 lambda 格式不正确。

```
@Html.LabelFor(DateOfBirth => Model.DateOfBirth) 
```

应该

```
<tr><td>
  @Html.LabelFor(m => m.DateOfBirth)
  </td>
  <td>
  @Html.TextBoxFor(m=> m.DateOfBirth, new { @Value = Model.DateOfBirth })
</td></tr> 
```

# apache - 致命错误：安装 x-sendfile mac os x 山狮服务器时找不到“apr.h”文件

> ID：11940296
> 
> 赞同：8
> 
> 时间：2012-08-13T18:36:36.920
> 
> 标签：apache, fatal-error, osx-mountain-lion, apr, x-sendfile

当我将我的 Lion 服务器升级到 Mountain Lion 时，它似乎从 apache 中删除了我的 mod_xsendfile。

我按照[该](http://elivz.com/blog/single/mod_xsendfile/)网站的说明进行操作，但遇到“没有这样的文件或目录”错误。在谷歌的帮助下，我发现[这个](https://apple.stackexchange.com/questions/58186/how-to-compile-mod-wsgi-on-mountain-lion-by-fixing-apxserror-command-failed-w)页面给了我解决方案：“sudo ln -s /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/ /Applications/Xcode.app/Contents/Developer/工具链/OSX10.8.xctoolchain"

看起来不错，但是当我尝试运行“sudo apxs -cia mod_xsendfile.c”时，我收到“致命错误：找不到'apr.h'文件”错误。

有任何想法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-11-18T07:58:17.647

您需要重新安装 Xcode 命令行工具：

```
xcode-select --install 
```

然后，您可能需要再次接受 Xcode 许可协议：

```
sudo xcodebuild -license 
```

一旦你完成了这些（以及你的工具链的符号链接），你应该很高兴。

# core-data - Core Data – 我什么时候需要调用 save？

> ID：11940300
> 
> 赞同：1
> 
> 时间：2012-08-13T18:36:52.053
> 
> 标签：core-data, save

场景是这样的。我正在对`NSManagedObject`. 例如设置日期`self.date = [NSDate now]`

然后我像这样在另一个类中调用辅助方法`[Utilities doFooWithObject:self];`

我需要在设置日期和调用辅助方法之间调用 save 吗？我的辅助方法是否能够在不调用 save 之间访问这个最近设置的日期？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T18:39:57.103

如果您在同一托管对象上下文中使用对象，则新值将立即可用。

在您的情况下，您只是直接传递对象，因此它将位于相同的托管对象上下文中。所以你不需要`save:`在那个时候打电话。

# selenium - 获取远程 webdriver 时禁用浏览器上的 JavaScript

> ID：11940302
> 
> 赞同：0
> 
> 时间：2012-08-13T18:36:55.123
> 
> 标签：selenium, grid, webdriver

在 selenium 网格中获取远程 WebDriver 时，如何在 IE、chrome 以及 iPhone 和 android 上禁用 JavaScript。我知道如何在 Firefox 上执行此操作，但在所有其他浏览器上似乎有所不同？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T23:42:11.070

每个浏览器都有自己的禁用 JavaScript 的机制。例如，在 IE 中，这是通过 Internet 选项对话框中的设置来处理的。WebDriver 无法为 IE 设置这些设置。此外，您会发现 WebDriver 在禁用 JavaScript 的情况下几乎没有什么功能。WebDriver 已经严重依赖于所谓的[自动化原子](http://code.google.com/p/selenium/wiki/AutomationAtoms)，它们被实现为 JavaScript 函数以在浏览器中执行。

# java - 是否有一种简单的解决方案可以将列和可编辑行动态添加到 Java 中的表模型中？

> ID：11940305
> 
> 赞同：3
> 
> 时间：2012-08-13T18:37:09.917
> 
> 标签：java, swing, jtable

我已经搜索了几个小时，但找不到任何简洁干净的解决方案来动态地将列/元素添加到 Java 中的表模型中。也许我是一个糟糕的研究员，我不知道。这让我很沮丧，我已经阅读了两本不同的书，但在这个主题上一无所获。我已经掠夺了 Google 的海量数据库，但没有发现任何用处。我已经找到了一些添加行的“解决方案”，但它们似乎并不那么好。我希望能够动态插入行和列。我已经投入了 5 杯茶和大部分的精神稳定性来寻找这个解决方案，但没有取得任何胜利。

我在想这样的事情：

```
rageTableModel.addColumn("No need to be upset anymore!");
rageTableModel.addRow("No need to be upset anymore!"); 
```

也许有一些越来越简单的解决方案可以解决我的挣扎，但是我似乎无法靠自己找到它。我对 Java 很陌生（2-3 个月的经验），所以我的知识在这个主题上并没有那么远。任何帮助，将不胜感激。

编辑：我看到到处都在使用这个“addColumn”方法，我试图在我的 AbstractTableModel 对象上使用它；没有胜利。我在文档页面上没有看到任何提及此方法的内容。[http://docs.oracle.com/javase/7/docs/api/javax/swing/table/AbstractTableModel.html](http://docs.oracle.com/javase/7/docs/api/javax/swing/table/AbstractTableModel.html)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T18:51:29.660

以下代码对我来说很好。如果您已经实现了自己的表模型，可能是它没有正确触发通知。

```
import java.awt.BorderLayout;

import javax.swing.JFrame;
import javax.swing.JScrollPane;
import javax.swing.JTable;
import javax.swing.table.DefaultTableModel;

public class TableTest {

    public static void main(String[] args) throws InterruptedException {
        JFrame f = new JFrame();

        DefaultTableModel m = new DefaultTableModel();
        JTable t = new JTable(m);

        f.add(new JScrollPane(t), BorderLayout.CENTER);
        f.setVisible(true);
        f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        f.pack();
        m.addColumn("A");
        m.addRow(new String[]{"A1"});

        Thread.sleep(1000);

        m.addColumn("B");
        m.addRow(new String[]{"A2", "B2"});     
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T19:13:55.713

我不知道您要做什么，但是，我认为设置桌子的模型总是更好。只有当您正在编写电子表格或类似的东西时，您才能编写按钮或上下文菜单来添加新列或行。我的意思是，您应该定义标题并调用方法`defaultTableModel.setColumnIdentifiers(Object[] newIdentifiers)`。Shure，newIdentifiers 对象数组是一个 String 数组。这样做您只需添加数据行以便向用户显示数据。

希望能帮助到你！

# javascript - Rails：使用 Ajax 渲染部分后，使用 JS 操作该部分

> ID：11940317
> 
> 赞同：0
> 
> 时间：2012-08-13T18:38:02.347
> 
> 标签：javascript, ruby-on-rails, ajax

在我的应用程序上，用户单击一个按钮，通过 ajax 显示一个文本字段。

我想在它出现后专注于该文本字段。

`$("#my-textfield").focus()`在我的 js.erb 文件中不起作用，但在控制台中可以正常工作。我也试过了`setTimeout`，没有用。

当我这样做时，`document.getElementById('my-textfield').focus();`我得到“无法专注于空值”。

通过ajax加载部分后，我是否需要以某种方式“重新加载”DOM？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T18:57:14.793

您可以`DOMNodeInserted`使用 .on() 监听事件。它尚未得到广泛支持，而且我从未使用过它，但它看起来可能适用于您正在尝试做的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T19:10:38.143

我还没有真正做到这一点，但你可以试试

```
$function() {
  $("#my-textfield").load(function() {
    $(this).focus();
  });
}); 
```

以确保它首先加载。

# sql - 在 Microsoft Visual Basic 6.0 中填充组合框

> ID：11940319
> 
> 赞同：3
> 
> 时间：2012-08-13T18:38:14.200
> 
> 标签：sql, sql-server-2008, vb6

我在 Microsoft Visual Basic 6.0 中有一个组合框。我必须将项目添加到组合框中。这些项目存储在 SQL 数据库中 Column1 中的一个表中。我不确定如何让这些项目在运行时显示在组合框中，以便用户可以选择不同的选项。

注意：该表只有一列。

这是我到目前为止编写的代码：

```
'Public Function GetProvincialRidingRst() As ADODB.Recordset
'
'    Dim rst As ADODB.Recordset
'    Dim strSQL As String
'
'    strSQL = "Select * from ProvincialRidings"
'
'    Set rst = New ADODB.Recordset
'    rst.ActiveConnection = cn
'    rst.Open strSQL, , adOpenKeyset, adLockBatchOptimistic
'
'    Set GetProvincialRidingsRst = rst
'
'End Function 
```

我不知道如何从这里处理。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-13T21:03:25.307

一旦你有了一个记录集，你只需遍历记录并将它们添加到 ComboBox 中。这样的事情应该这样做：

```
Combo1.Clear
With myRS
    Do While Not .EOF
        Combo1.AddItem ![myColumn]
        .MoveNext
    Loop
    .Close
End With 
```

显然，您需要用表`myColumn`中的*实际*列名替换。

# linux - CFengine 将车身“控制”重新定义为“普通”是一个失信

> ID：11940321
> 
> 赞同：0
> 
> 时间：2012-08-13T18:38:28.137
> 
> 标签：linux, cfengine

我已经安装了 cfengine 3 企业版进行测试。然而，当我去运行一个测试承诺时，我得到一个错误回复说

将身体“控制”重新定义为“普通”是一个失信

下面是代码，有什么想法吗？

```
body common control
{
bundlesequence =>{ "edit_motd"};
}
bundle agent edit_motd
 {
vars: 
 "motd" string => "/etc/motd";
 files: 
 "$(motd)"
create => "true",
edit_line => addmessage;
reports: 
 cfengine::
 "Hello world!";
}
 bundle edit_line addmessage
{
insert_lines:
"This system is managed by CFEngine 3";
 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T22:54:15.917

只需在公共控件中添加[host_licenses_paid就可以了：](http://cfengine.com/manuals/cf3-Reference#host_005flicenses_005fpaid-in-common)

```
 body common control
    {
    bundlesequence =>{ "edit_motd"};
    host_licenses_paid => "25";
    } 
```

但是，错误消息与我安装时得到的消息有点不同。你能检查以上是否有效吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-16T06:50:11.800

您能否显示您用于运行此代码的命令以及您获得的完整输出？

我认为最可能的原因是 awsiv 提到的：您正在从其他已经包含“body common control”的文件中包含此文件，因此出现错误消息。

# video - 为什么 GPU 可以更快地转换视频？算法？

> ID：11940326
> 
> 赞同：-1
> 
> 时间：2012-08-13T18:38:46.077
> 
> 标签：video, cpu, gpu, cpu-architecture, video-conversion

我想知道为什么像 Badaboom 这样的程序在大多数显卡上转换视频的速度要比在 CPU 上运行的每个程序快得多。我想知道区别在于芯片布局还是 CPU/GPU 周围的组件（缓存，...）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T18:43:01.160

GPU 专为并行处理而构建。通用 CPU 永远无法赶上。另一方面，由于 GPU 如此专注于并行操作，因此它们适用于非常糟糕的通用 CPU。

该视频很好地直观地展示了差异：[http ://www.youtube.com/watch?v=nqdLrACBrOI](http://www.youtube.com/watch?v=nqdLrACBrOI)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-03T22:22:57.960

GPU 和 CPU 就像将汽车引擎与变速箱进行比较，它们的用途不同。GPU 仅处理整个系统的图形部分，而 CPU 主要用于其他一切，但也可以执行图形处理。

系统缓存、内存、驱动器速度、GPU 类型、CPU 类型（速度；内存缓存；总线速度等）也会对整个系统产生影响。

# flash-cs5 - adobe flash 正在复制项目而不是移动它们

> ID：11940330
> 
> 赞同：0
> 
> 时间：2012-08-13T18:39:15.483
> 
> 标签：flash-cs5

我的朋友已经使用 abobe flash 有一段时间了，并且通常说当他单击并拖动屏幕上的对象时，它会移动它。然而最近，它一直在复制他选择的项目。他正在运行 Mountain Lion，并且已经重新启动了很多次，以及检查卡住的键。有没有其他人遇到过这个问题，如果有，你解决了吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T12:57:53.293

好的！问题已解决，原来这是 Air Display 程序的问题 - 不确定这是否是 Mountain Lion 独有的 - 但一旦我卸载 Air Display，一切都恢复正常！

# sendgrid - sendgrid 取消订阅格式

> ID：11940333
> 
> 赞同：6
> 
> 时间：2012-08-13T18:39:23.530
> 
> 标签：sendgrid

我时间紧迫，继承了一个 sendgrid 实现。有一个取消订阅选项看起来像这样：

```
click="" here="">.</> 
```

我如何 1) 删除取消订阅选项？2) 将链接格式化为某种特殊的东西？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-13T19:08:25.953

在不知道您的帐户配置细节的情况下，我猜您可能在您的帐户中启用了“订阅跟踪”应用程序。您的选择是 (a) 使用 WYSIWYG 编辑器将其更改为更好的东西或 (b) 禁用该应用程序并使用您自己的链接进行订阅跟踪。

如果您登录 SendGrid 并导航到页面顶部的[“应用程序”选项卡，您将看到您拥有的应用程序列表。](http://sendgrid.com/app)它应该看起来像这样：

![SendGrid 应用程序仪表板](../Images/5359b5335c2832a2f2df29087047108d.png)

您正在寻找的是[“订阅跟踪”应用程序](http://sendgrid.com/app/appSettings/type/subscriptiontrack/id/5)。如果您单击应用程序标题旁边的“设置”，您将被带到一个屏幕，您可以在其中编辑链接和行为。您也可以单击“禁用”将其完全关闭并实施您自己的。

如果您仍有问题，您可以随时向[我们的支持团队](http://support.sendgrid.com/)开票。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-13T18:46:56.917

在您帐户的 SendGrid 控制面板中，您可以更改选项以定义是否显示取消订阅。这是全局设置更改。

或者，当您创建消息时（取决于您创建消息的方式），您可以定义是否显示取消订阅链接。例如，如果您使用的是 SendGrid C# 库，则此选项可用。如果您通过标准 SMTP 库（如 .Net 的 MailMessage 类）创建消息，则它不可用。这是每条消息的设置更改。

除了 CSS 格式之外，没有默认方法可以更改取消订阅链接的 AFAIK 显示方式。

# .net - 在 Windows 服务中使用 TPL 处理多线程（概念）

> ID：11940335
> 
> 赞同：0
> 
> 时间：2012-08-13T18:39:34.627
> 
> 标签：.net, vb.net, multithreading, task-parallel-library

我有一个 vb.net 服务，它需要一些线程来分别处理每个函数调用并避免时间消耗。

我有 2 个函数需要实现线程：

在问我的问题之前，这是我的两个功能：

1- LaunchTasks() ：如果任务启动良好，它会计算该任务的“NextRunDate”，否则会跳过它。

```
'Dim oThread As Threading.Thread
For Each oRow As DataRow In oDatatable.Rows
    Dim oCLASSE_Task As New CLASSE_Task
    If oCLASSE_Task.Load(oRow.Item("Mytask")) Then

        'oThread = New Threading.Thread(AddressOf oTask.launchSteps)
        'oThread.Priority = Threading.ThreadPriority.Normal
        'oThread.Start()

        Dim oThread = System.Threading.Tasks.Task(Of Boolean).Factory.StartNew(Function() oCLASSE_Task.launchSteps())

    End If
Next
' Need to wait until all threads finish 
```

2- 计算运行日期（）

```
'It's called for each object in CLASSE_Task

'Dim oThread As Threading.Thread
For Each oRow As DataRow In oDatatable.Rows
    Dim oCLASSE_Task As New CLASSE_Task
    If oCLASSE_Task.Load(oRow.Item("Mytask")) Then

        Dim oThreadTask = System.Threading.Tasks.Task(Of Boolean).Factory.StartNew(Function() oCLASSE_Task.calculateNextRunDate())

        'oThread = New Threading.Thread(AddressOf oTask.calculateNextRunDate)
        'oThread.Priority = Threading.ThreadPriority.Normal
        'oThread.Start()

    End If
Next
' Need to wait until all threads finish 
```

我总是先调用 LaunchTask()，然后再调用 calculateRunDates()（如果我在数据库中获得新记录）。

在启动calculateRunDates() 之前，我必须等待函数LaunchTask() 中的所有线程完成。

*   如何使用 TPL（我以前从未使用过）来做到这一点，比如 thread.join()？

*   在这种情况下我应该使用线程还是 TPL？

*   如何在服务中使用 TPL 处理异常（类似[的东西](https://stackoverflow.com/questions/7770291/problems-with-windows-service-blockingcollection-and-multithreading-tpl)）？

注意：我使用 SyncLock 在我的 CLASSE_Task 中锁定。

没有足够的例子使用 vb.net，主要是 C#。

希望我足够清楚。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T19:03:50.543

首先，回答您的问题：

> 如何使用 TPL（我以前从未使用过）来做到这一点，比如 thread.join()？

你应该使用[`task.Wait()`](http://msdn.microsoft.com/en-us/library/dd235635)它。如果你想等待几个`Task`s，你可以使用[`Task.WaitAll()`](http://msdn.microsoft.com/en-us/library/dd270695.aspx).

> 在这种情况下我应该使用线程还是 TPL？

您应该使用 TPL。它更易于使用且更高效。

> 如何在服务中使用 TPL 处理异常？

如果 a 中的代码`Task`抛出异常，然后你`Wait()`在那个`Task`（或`WaitAll()`多个`Task`s 上），它将抛出`AggregateException`包含抛出的异常。如果您不致电`Wait()`，则可以使用`ContinueWith()`，正如您链接到的问题所暗示的那样。

* * *

但是对于您的代码，我认为更好的选择是使用[`Parallel.ForEach()`](http://msdn.microsoft.com/en-us/library/system.threading.tasks.parallel.foreach.aspx)：它将负责`Task`为您创建 s，它会更有效地完成它（它`Task`在迭代之间共享 s）并且您不必处理等待，因为当它返回时，所有迭代都完成了：

```
Parallel.ForEach(oDatatable.Rows.Cast(Of DataRow)(),
                 Sub(oRow)
                     Dim oCLASSE_Task As New CLASSE_Task
                     If oCLASSE_Task.Load(oRow.Item("Mytask")) Then
                         oCLASSE_Task.launchSteps()
                     End If
                 End Sub) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T19:01:43.027

要等待多个任务完成，您可以使用 Task.WaitAll(...) 方法。请参阅[此](http://msdn.microsoft.com/en-us/library/dd270695.aspx)示例。本文还展示了如何处理任务引发的异常。在 Task.WaitAll() 周围放置 try/catch 并检查捕获的 AggregateException 以获取任务抛出的单个异常。

但是，看起来您的代码将受益于使用 Parallel.ForEach API，这将提供更智能的循环分区。简单地为每一行创建一个单独的任务可能会使线程池过载。

# c# - asp:DropDownList 服务器调用没有回发

> ID：11940338
> 
> 赞同：0
> 
> 时间：2012-08-13T18:39:52.347
> 
> 标签：c#, asp.net, .net, vb.net

我刚开始使用visual basic

[我的代码 1](http://content.screencast.com/users/minagabriel/folders/Jing/media/38b37b85-64ad-46f8-9a8b-621d22a1b1f7/2012-08-13_1456.png) [代码 2](http://content.screencast.com/users/minagabriel/folders/Jing/media/ff08a594-2b48-4365-86f7-1beb1502c826/2012-08-13_1458.png)的一些照片

我有一个`asp:DropDownList`回复`AutoPostBack="true"`的内容是根据选择填充另一个下拉列表。

下面是处理第一个下拉列表选择的代码：

```
 Public Sub checklistDropMenuChange(sender As Object, e As System.EventArgs) Handles checklistDropMenu.SelectedIndexChanged

    If (checklistDropMenu.SelectedValue = -1) Then
        taskDropMenu.Items.Clear()
        taskDropMenu.Enabled = False
        ScriptManager.RegisterStartupScript(Page, Page.GetType(), "KeepAddChecklistPopup", "showPopup('addChecklisTaskopup', 'add new Task');", True)
    Else
        taskDropMenu.Enabled = True
        taskList.SelectParameters("lngChecklist").DefaultValue = checklistDropMenu.SelectedValue
        taskDropMenu.Enabled = True
        ScriptManager.RegisterStartupScript(Page, Page.GetType(), "KeepAddChecklistPopup", "showPopup('addChecklisTaskopup', 'add new Task');", True)
    End If
End Sub 
```

表单位于弹出 div 中，当我进行任何选择时，页面会返回清空页面中除两个之外的所有数据`DropDownLists`。

请注意`AutoPostBack="true"`，`false`如果我在第一个下拉列表中选择任何 thisng，它不会做任何事情？

**问题**如何根据第一个下拉选择填充第二个下拉列表并保留我的所有数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T04:53:08.037

试试这个，你可能会有一些乐趣：asp.net/ajaxLibrary/AjaxControlToolkitSampleSite/

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T18:50:38.037

这将需要回发或 AJAX。如果您对全屏刷新没问题，那么这将是一个相当容易解决的问题。

根据您的报告，听起来您可能正在事件处理程序中设置默认数据，而不是检查这是否是初始帖子。您可以发布您的 Page_Load 事件处理程序吗？

建议更新代码：

```
Public Sub checklistDropMenuChange(sender As Object, e As System.EventArgs) Handles checklistDropMenu.SelectedIndexChanged

    If (checklistDropMenu.SelectedValue = -1) Then
        taskDropMenu.Items.Clear()
        taskDropMenu.Enabled = False
    Else
        taskDropMenu.Enabled = True
        taskDropMenu.Items.Clear()
        taskList.SelectParameters("lngChecklist").DefaultValue = checklistDropMenu.SelectedValue
        taskDropMenu.DataBind()
    End If

    ScriptManager.RegisterStartupScript(Page, Page.GetType(), "KeepAddChecklistPopup", "showPopup('addChecklisTaskopup', 'add new Task');", True)
End Sub 
```

我假设 taskList 是某种 ObjectDataSource ？

# objective-c - 以编程方式查找 LAN 上另一台计算机的 IP 地址

> ID：11940341
> 
> 赞同：0
> 
> 时间：2012-08-13T18:39:56.873
> 
> 标签：objective-c, ip-address, lan

给定主机名，我想以编程方式获取 LAN 上计算机的 IP 地址。

我从命令行知道我可以通过 ping <主机名> 来执行此操作，但是我如何在 Objective-c 中以编程方式执行此操作？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T21:23:53.240

好的，只要您尝试访问的计算机的主机名在 DNS 服务器中注册了其名称，gethostbyname() 在尝试查找给定主机名的 IP 地址时始终有效。上面的所有评论和答案都很有用。

# php - php 文件名到特定字符

> ID：11940345
> 
> 赞同：0
> 
> 时间：2012-08-13T18:40:30.880
> 
> 标签：php, wordpress

您好我正在尝试让 php 返回文件名并将字符串作为 rel 标记的一部分返回，该标记将由 javascript 插件使用。

我需要添加一些 php 脚本以将文件名字符串返回到第二个连字符：到目前为止我有

```
<?php 
$filename = basename ( get_attached_file( get_post_thumbnail_id() ) ); 
?>
<?php echo pathinfo($filename, PATHINFO_FILENAME); ?> 
```

它返回

`tulip-367-011`文件名是`tulip-367-011.jpg`我如何让它返回`tulip-367`

嗨我试过

```
<?php 
$filename = basename ( get_attached_file( get_post_thumbnail_id() ) ); 
?>
<?php echo $file_parts = explode('-', basename($filename)); 
array_pop($file_parts); // Remove the last segment 
$split_name = implode('-', $file_parts); 
?> 
```

它返回了 Array - 不是万岁！那真的会让我发笑，我已经为此困扰了一周。再次感谢您的帮助，我会继续努力。我还不是一个很好的程序员，所以请随意嘲笑我的愚蠢。作为一个

我试过了

```
$file_parts = explode('-', basename($filename)); 
array_pop($file_parts); // Remove the last segment 
$split_name = implode('-', $file_parts); 
```

它还说Array。再次感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T18:42:08.193

只需使用[`basename`](http://php.net/basename)而不是`fileinfo`.

例子：

```
$file_without_extension = basename($filename) 
```

**编辑**

抱歉，我误读了原始问题，假设文件名是一致的，要删除最后一段，请执行以下操作：

```
$file_parts = explode('-', basename($filename));
array_pop($file_parts); // Remove the last segment
$split_name = implode('-', $file_parts; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T18:52:45.310

```
$fileParts = pathinfo(get_attached_file( get_post_thumbnail_id()));
$nameParts = explode('-', $fileParts['basename']);
if (count($nameParts) > 1) {
    $myName = $nameParts[0]+'-'+$nameParts[1];
} else {
    $myName = $nameParts[0];
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-14T13:07:10.200

这修复了它：

```
<?php 
$filename = basename ( get_attached_file( get_post_thumbnail_id() ) ); 
$file_parts = explode('-', basename($filename)); 
array_pop($file_parts); // Remove the last segment 
$split_name = implode('-', $file_parts); 
echo $split_name;
?>

<a itemprop="image" href="<?php echo wp_get_attachment_url( get_post_thumbnail_id() ); ?>" class="Magic360" rel="filename:<?php echo $split_name?>-{col}.jpg; magnify:true; magnify-filename:<?php echo get_post_meta($post->ID, 'magnified_image_filename', true); ?>-{col}.jpg"><img src="<?php echo get_post_meta($post->ID, 'magnified_image', true); ?>" 
```

# jquery - Jquery Tools Touch 水平只禁用垂直触摸

> ID：11940351
> 
> 赞同：5
> 
> 时间：2012-08-13T18:41:28.930
> 
> 标签：jquery, scroll, touch, gesture, swipe

我有 jquery 工具滚动器...我喜欢它只为 swipeLeft swipeRight 实现触摸选项。

当我使用 touch: true 时，它​​也会在向上/向下滑动时旋转..

我在这里按照说明进行操作：

> [jQuery Tools Scrollable on touch 禁用垂直滚动](https://stackoverflow.com/questions/9836802/jquery-tools-scrollable-on-touch-disable-vertical-scroll)

和这里：

> [http://awardwinningfjords.com/2010/09/22/handling-touch-events-in-jquery-tools-scrollable.html](http://awardwinningfjords.com/2010/09/22/handling-touch-events-in-jquery-tools-scrollable.html)

但似乎没有一个工作..有什么想法吗？我的小提琴/演示如下供参考

> 小提琴：http: [//jsfiddle.net/mmp2m/7/](http://jsfiddle.net/mmp2m/7/)
> 
> 演示：http: [//jsfiddle.net/mmp2m/7/show](http://jsfiddle.net/mmp2m/7/show)

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-13T19:44:42.403

如果您使用的唯一控件是**Scrollable**，那么您可以从[此处](https://raw.github.com/jquerytools/jquerytools/master/src/scrollable/scrollable.js)编辑它的源代码以修复该行为或根据您认为合适的方式对其进行调整。

我修改了您发布的[小提琴，以在代码部分中包含](http://jsfiddle.net/mmp2m/16/)**Scrollable**控件的`JavaScript`代码。

`// added`在控件代码中添加的行是以下代码段末尾带有注释的行：

```
 // touch event
    if (conf.touch) {
        var touch = {};

        itemWrap[0].ontouchstart = function(e) {
            var t = e.touches[0];
            touch.x = t.clientX;
            touch.y = t.clientY;
        };

        itemWrap[0].ontouchmove = function(e) {

            // only deal with one finger
            if (e.touches.length == 1 && !itemWrap.is(":animated")) {            
                var t = e.touches[0],
                     deltaX = touch.x - t.clientX,
                     deltaY = touch.y - t.clientY,
                     absX = Math.abs(deltaX),                              // added
                     absY = Math.abs(deltaY);                              // added

                // Only consider the event when the delta in the
                // desired axis is greater than the one in the other.
                if(vertical && absY > absX || !vertical && absX > absY)    // added
                    self[vertical && deltaY > 0 || !vertical && deltaX > 0 ? 'next' : 'prev']();

                e.preventDefault();
            }
        };
    } 
```

我已经在 Android 中使用本机和 Opera 浏览器进行了尝试，并且似乎可以按预期工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-10T02:27:04.307

我在同一问题上苦苦挣扎了一段时间，直到找到以下解决方法-

初始化-

```
var $scroller1 = $('#outer-container1').kinetic({'y':false}); 
```

这可以防止容器上的垂直滚动，但不会将垂直滚动交给浏览器滚动条。

然后转到jquery kinetic 源代码并注释掉`e.preventDefault()`所有鼠标和滚动动作事件。

这个黑客对我有用。 [https://github.com/davetayls/jquery.kinetic/issues/33](https://github.com/davetayls/jquery.kinetic/issues/33)

# ruby-on-rails - Rails 3.2.3 和 json 中的 Flash 消息

> ID：11940352
> 
> 赞同：3
> 
> 时间：2012-08-13T18:41:31.873
> 
> 标签：ruby-on-rails, ajax, json, ruby-on-rails-3.2

控制器中有一个动作。它只能**通过 ajax 以 json 格式**调用。

```
def update
    @article = Article.find_by_id params[:id]
    respond_to do |format|
      if @article.update_attributes(params[:article])
        flash[:message] = "good"       
      else
        flash[:error] = @article.errors.full_messages.join(", ")
      end
          format.json { render :json => flash}
  end

end 
```

页面的一部分

```
<% unless flash[:error].blank? %>
   <%= flash[:error] %>
<% end %>

<% unless flash[:message].blank? %>
  <%= flash[:notice] %>
<% end %>
<!-- page content goes --> 
```

当然，页面包含调用方法的`button_to`with 。`:remote=>true``update`

最重要的是，它在更新后什么都没有显示。JSON 对象肯定会返回，我可以在 fireBug 中看到它。

问题是，我是否正确使用闪光灯？以及如何使用它在页面上显示消息？请不要忘记ajax。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-14T10:34:51.090

为什么你的 respond_to 块中有 if/else 语句？

```
def update
  @article = Article.find_by_id params[:id]
  if @article.update_attributes(params[:article])
    flash[:notice] = "Good"
  else
    flash.now[:notice] = "Bad"
    render "edit"
  end
  respond_to do |format|
    format.html {redirect_to @article}
    format.js
  end
end 
```

然后创建**update.js.erb**

```
$("#notice").text("<%= escape_javascript(flash[:notice]) %>")
$("#notice").show() 
```

上面的代码可能不是 100% 正确的。

对于闪存，我会有类似的东西：

```
<div id="notice">
  <% flash.each do |key, value| %>
    <%= content_tag(:div, value, :class => "flash #{key}") %>
  <% end %>
</div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-14T02:54:20.740

此帖子包含您需要的所有代码。它拯救了我的隐藏：

[https://gist.github.com/linjunpop/3410235](https://gist.github.com/linjunpop/3410235)

这是它的一个分支，做了一些小的修改：

[https://gist.github.com/timothythehuman/5506787](https://gist.github.com/timothythehuman/5506787)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-13T19:59:12.510

我认为您必须绑定`ajax:success`回调，该回调将通过替换消息或将消息放置到 dom 来显示 Flash 消息。

# google-apps-script - 谷歌脚本 API。使单元格背景透明

> ID：11940358
> 
> 赞同：3
> 
> 时间：2012-08-13T18:42:10.047
> 
> 标签：google-apps-script

我有一个带有表格的 Google 文档。比如说，表格单元格是黑白的。目标：使用 Google Scripts API 去除单元格背景（使所有单元格背景透明）。

有没有办法这样做？我以各种方式尝试了 Cell.setBackgroundColor(color)（通过使用“none”、“null”、“transparent”、“”等作为输入），但这不起作用。

将所有单元格设为白色不是可接受的解决方法。

谢谢，亚历克斯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-14T05:53:56.120

嗯。刚刚尝试了以下代码。它按预期工作 - 将“D10：E20”范围的彩色背景更改为白色，单元格 A1 和 A2 包含文本

*   `#980000`
*   `none`

即范围背景是“无”而不是白色。功能是

```
function myFunction() {
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
  var range = sheet.getRange('D10:E20');
  sheet.getRange('A1').setValue(range.getBackgroundColor());
  range.setBackground('none');
  sheet.getRange('A2').setValue(range.getBackgroundColor());
} 
```

**编辑00**：对不起，我误解了你。为了解决我的错误，我创建了一个文本文档和一个小脚本（见下文）。在文档中，我创建了一个新表，并且在没有任何进一步修改的情况下启动了脚本。结果是

*   cell[0, 0] 包含`Background is null`文本，代码在该行中引发`We're sorry, a server error occurred. Please wait a bit and try again. (line 14)`异常。**错了**。`cell00.setBackgroundColor(bg00);`

 **在文档编辑器中，我通过对话框将单元格 [0, 0] 背景更改`Table->Table properties`为黄色。结果是

*   单元格 [0, 0] 文本是`#ffff00`. 没有错误。**正确**。

我将单元格背景更改为`None`. 结果是

*   cell[0, 0] 包含`Background is empty`文本，代码在该行中引发`Invalid color value. (line 14)`异常。**错了**。`cell00.setBackgroundColor(bg00);`

 **我的观点是标记为**错误**的点是一个错误。您必须向[问题跟踪器](http://code.google.com/p/google-apps-script-issues/issues/list)提交问题。当然，您可以使用我的代码和此文本来描述问题。

```
function testDoc() {
  var doc = DocumentApp.openById('the-text-document-id');
  var cell00 = doc.getTables()[0].getCell(0, 0);
  var bg00 = cell00.getBackgroundColor();
  if (bg00 == null) {
    cell00.setText('Background is null');
  }
  else if (bg00 == '') {
    cell00.setText('Background is empty');
  }
  else {
    cell00.setText(bg00);
  }
  cell00.setBackgroundColor(bg00);
} 
```****

# html - HTML字符编码影响输入提交的编码？

> ID：11940359
> 
> 赞同：0
> 
> 时间：2012-08-13T18:42:15.153
> 
> 标签：html, forms, input, character-encoding

html 页面的字符编码是否会影响通过输入字段提交的字符的字符编码（即用户输入的内容/提交的内容），还是仅影响页面显示的编码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T18:56:01.263

是的。浏览器在包含表单的页面的编码中对表单数据进行编码。

# android - 为什么下一条指令会立即执行？

> ID：11940360
> 
> 赞同：0
> 
> 时间：2012-08-13T18:42:14.967
> 
> 标签：android, android-edittext

我是Android新手，遇到问题，请看以下代码：

```
new AlertDialog.Builder(this)
  .setTitle("Save File")
  .setMessage("Do you want to save to a file ?")
  .setPositiveButton("Yes", new DialogInterface.OnClickListener() {
      public void onClick(DialogInterface dialog, int whichButton) {
          // Ask user for a file name to save the text in the text editor.
          PreSaveFile();

          // Clear text editor. 
          // This is executed immediately and it does not wait until PreSaveFile() ends.
          CleanEditor(et);
        }
    })
.setNegativeButton("No", new DialogInterface.OnClickListener() {
    public void onClick(DialogInterface dialog, int whichButton) {
        CleanEditor(et);
    }
}) 
```

问题是第二个调用 ,`CleanEditor(et)`不会等到`PreSaveFile()`结束，所以当我选择一个文件名来保存我在文本编辑器中的内容时，`CleanEditor(et)`删除了文本编辑器，所以什么都不能保存。

我希望我足够清楚。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T18:51:34.870

如果 PreSaveFile 显示输入文件名的对话框，它不会等待对话框关闭并继续执行，因此 PreSaveFile 完成并执行 CleanEditor。

您必须在创建的 PreSaveFile() 对话框中添加一个侦听器，并在该侦听器中调用 CleanEditor(et);

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T13:58:10.177

首先，我将发布您的 PreSaveFile() 函数，使其更具可读性：

```
private void PreSaveFile() { 
    EditText et = (EditText)findViewById(R.id.editText1); 
    if (et.length() == 0) { 
        Toast.makeText(getBaseContext(), "Editor is empty!", Toast.LENGTH_SHORT).show(); 
    } 
    if (textFile.length() == 0) { 
        Intent i = new Intent(MainActivity.this, FileChooser.class); 
        Bundle myData = new Bundle(); 
        myData.putString("textFile", ""); 
        i.putExtras(myData); 
        startActivityForResult(i, 1); 
    } else { 
        SaveFile(); 
    } 
} 
```

我想在这里说明两点：

1）您是否检查过以确保您的代码遵循您假设的执行路径？特别是，您是否检查过 testFile.length() 确实为 0，以便代码进入 if() 而不是 else()？

2）**更重要**的是， startActivityForResult 启动活动以**异步执行，如**[this question](https://stackoverflow.com/questions/4982812/startactivityforresult-in-oncreate-getting-skipped "这个问题") 的答案所示。**获取结果后**要执行的任何代码都应放在`onActivityResult()`回调中，请参阅[此问题](https://stackoverflow.com/questions/6351555/synchronous-startactivityforresult-waiting-for-activity-to-complete "这个问题")的答案。

希望这可以帮助！

# html - 我可以使用css显示选择框的值吗？

> ID：11940366
> 
> 赞同：1
> 
> 时间：2012-08-13T18:31:11.530
> 
> 标签：html, css, tags

一位同事刚刚问我是否知道一种方法来显示选择框选项标签的值，而不是显示打开和关闭选项标签之间的文本，而无需使用 javascript。我还没有找到一种方法来实现这一点。有没有办法做到这一点？

示例代码如下：

```
<select name="ctl00$ctl00$ContentMain$contentbody$ddlCFDA"     id="ContentMain_contentbody_ddlCFDA" class="wide">
<option value=""> --- Select CFDA --- </option>
<option value="93.003">93.003    Disaster Relief</option>
<option value="93.101">93.101    PPW</option>
<option value="93.102">93.102    RWC</option>
<option value="93.104">93.104    Comp Comm Mntl Hlth Serv (Sed)</option>
<option value="93.109">93.109    Link</option>
<option value="93.119">93.119    Technical Asst Ctr Evaluation</option>
<option value="93.120">93.120    MH Serv For Cuban Entrants</option>
<option value="93.122">93.122    RRCD</option>
<option value="93.125">93.125    MH Planning &amp; Demonstration</option>
<option value="93.128">93.128    MH Statistics Improvement Prog</option>
<option value="93.131">93.131    ATTC</option>
<option value="93.132">93.132    Managed Care (MC)</option>
<option selected="selected" value="93.138">93.138    P&amp;A For Individuals With Mental Illness</option>
<option value="93.144">93.144    High-Risk Youth Population</option>
<option value="93.148">93.148    Demonstration Prog Homeless</option>
<option value="93.150">93.150    PATH</option>
<option value="93.169">93.169    </option>
<option value="93.170">93.170    CYAP</option>
<option value="93.171">93.171    Block Grant</option>
<option value="93.174">93.174    Conference Grants</option>
<option value="93.175">93.175    Wrap Around</option>
<option value="93.179">93.179    SP-SD</option>
<option value="93.194">93.194    Community Partnership Grant</option>
<option value="93.195">93.195    </option>
<option value="93.196">93.196    Target Cities (TC)</option>
<option value="93.216">93.216    HIV/AIDS Demonstration Prog</option>
<option value="93.218">93.218    Subst Abuse Treatment Conference Grants</option>
<option value="93.229">93.229    </option>
<option value="93.230">93.230    KDA</option>
<option value="93.238">93.238    </option>
<option value="93.239">93.239    Policy Research and Evaluation Grants (ASPE)</option>
<option value="93.242">93.242    </option>
<option value="93.243">93.243    Programs of Regional and National Significance</option>
<option value="93.244">93.244    MH Clinical Or Serv Related Tr</option>
<option value="93.274">93.274    Clinical Training Grant/FD</option>
<option value="93.275">93.275    Access to Recovery Grants</option>
<option value="93.276">93.276    ONDCP Drug Free Communities</option>
<option value="93.901">93.901    Communications Coop Agreements</option>
<option value="93.902">93.902    Critical Population (CP)</option>
<option value="93.903">93.903    Criminal Justice (CJN)</option>
<option value="93.911">93.911    Campus</option>
<option value="93.937">93.937    </option>
<option value="93.949">93.949    HIV/AIDS</option>
<option value="93.950">93.950    Capacity Expansion (CP)</option>
<option value="93.958">93.958    CMHS Block Grant</option>
<option value="93.959">93.959    SAPT Block Grant</option>
<option value="93.982">93.982    Disaster Assistance &amp; Emerg</option>
<option value="93.992">93.992    Block Grant</option>

</select> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T20:29:07.443

实际上，它不能在 CSS 中完成（如果可能的话，很难理解为什么*应该*在 CSS 中完成）。

在理论上，您原则上可以使用生成的内容在元素内容之后*添加内容，例如*

```
option:after { content: attr(value); } 
```

但在流行的浏览器中，Firefox 似乎是唯一支持为`option`元素生成内容的浏览器。

从理论上讲，您可以通过对生成的内容机制使用建议的扩展来*替换内容：*

```
option { content: attr(value); } 
```

但是这个扩展一般（用于真实元素，而`content`不仅仅是伪元素）似乎只被 Opera 支持，并且它不支持它（或根本不支持生成的内容）元素。`:before``:after``option`

# php - 如何在 PHP 中将 ucwords() 添加到 HTML 表单值？

> ID：11940373
> 
> 赞同：0
> 
> 时间：2012-08-13T18:43:10.503
> 
> 标签：php, html, forms

我的网站上有一个基本的联系表格，我正在尝试将 PHP 的 PHP ucwords() 函数添加到用户 first_name 和 last_name 字段的表单中，以便他们正确地大写第一个字母。我如何将它添加到实际的 HTML 表单中？

编辑：我希望这些更改仅在用户提交表单后应用。我并不真正关心用户如何输入它。我只需要有人实际向我展示一个示例。

就像我如何将 PHP ucwords() 代码添加到这个简单的表单中一样？

```
<!DOCTYPE html>
<html>
<body>

<form action="www.mysite.com" method="post">
First name: <input type="text" name="first_name" value="" /><br />
Last name: <input type="text" name="last_name" value="" /><br />
<input type="submit" value="Submit" />
</form>

</body>
</html> 
```

我假设我做了类似的事情，`value='<php echo ucwords() ?>'`但我不知道怎么做？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T22:17:03.660

**当用户提交表单时，您可以通过 PHP 的 $_POST 变量 [because method="post"] 访问提交的信息，实际上您必须指定需要进一步处理提交信息的实际页面**

```
<?php
// for example action="signup_process.php" and method="post" 
// and input fields submitted are "first_name", "last_name" 
// then u can access information like this on page "signup_process.php"

// ucwords() is used to capitalize the first letter 
// of each submit input field information

$first_name = ucwords($_POST["first_name"]);
$last_name = ucwords($_POST["last_name"]);
?> 
```

**[PHP 教程](http://phptutors.wordpress.com/)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T18:45:58.657

假设启用了短标签：

```
$firstName = 'Text to go into the form';
<input type="text" name="first_name" value="<?=ucwords($firstName)?>" /> 
```

否则如你所说

```
<input type="text" name="first_name" value="<?php echo ucwords($firstName); ?>" /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T18:47:41.033

假设您想在不刷新页面的情况下执行此操作，则需要使用 Javascript。最简单的方法是将 onkeyup 事件添加到输入字段并模拟 PHP 的 ucwords 函数，这看起来像......

```
function ucwords(str) {
    return (str + '').replace(/^([a-z])|\s+([a-z])/g, function ($1) {
        return $1.toUpperCase();
    });
} 
```

编辑：响应您的编辑，如果您想获得他们发送的应用 ucwords 的值，您需要做的就是`$newVal = ucwords($_POST['fieldName']);`

# html - 如何通过 watir-webdriver 的文本定位另一个元素的孙子元素？

> ID：11940374
> 
> 赞同：0
> 
> 时间：2012-08-13T18:43:15.693
> 
> 标签：html, html-lists, watir-webdriver

我有一些这样的 HTML：

```
<ul id="directory">
    <li><a id="first" href="/first">first</a></li>
    <li><a id="second" href="/second">second</a></li></ul> 
```

我想根据其文本和与 id 为“目录”的 ul 的关系来定位 id 为“second”的链接，然后使用 watir-webdriver 单击它。

似乎应该简单地说：

```
browser.ul(:id => 'directory').li.a(:text => 'second') 
```

但这不存在。

经过研究，我想也许我应该这样做：

```
browser.ul(:id => 'directory').lis.a(:text => 'second') 
```

但`LICollection`甚至没有`a`方法。我想也许我应该做点什么，`each`但我不知道会是什么。

有没有一种好方法可以识别这个元素，而无需使用 CSS 或 XPath 选择器，使用以下标准：

1.  它是一个锚。
2.  它有文字“第二”。
3.  它是 li 元素的子元素，它是 ul 元素的子元素，其 ID 为“目录”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T19:33:40.647

你可以做：

```
browser.ul(:id => 'directory').a(:text => 'second') 
```

在 Watir-Webdriver 中，您无需指定 li 元素即可访问链接。同样，假设一个合理的 HTML 页面，ul 元素中的任何链接都将在 li 元素中（即，我相信 ul 元素的唯一允许的直接子元素是 li 元素）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-07T11:37:00.893

browser.ul(:id => '目录').a(:id => 'second')

让我知道上述声明是否有效。

# javascript - 完全从浏览器中删除 DOM 元素，而不仅仅是在 console.debug 中

> ID：11940377
> 
> 赞同：0
> 
> 时间：2012-08-13T18:43:37.777
> 
> 标签：javascript, jquery, dom, dom-manipulation, removechild

我需要删除或修改 OpenLayers 库创建的元素。如果我删除它，如果按 id 显示，我将无法在 console.debug 中看到它，但它们仍然存在于浏览器中。

```
console.debug($("#OpenLayers_Geometry_Point_85")); 
```

完美，我可以在控制台中看到输出。当我将鼠标悬停在它上面时，浏览器中的元素会突出显示。

```
$("#OpenLayers_Geometry_Point_85").remove(); 
```

尝试删除元素，它的行为基本上与以下方式相同：

```
var img = document.getElementById("OpenLayers_Geometry_Point_85");
img.parentNode.removeChild(img);
console.debug($("#OpenLayers_Geometry_Point_85")); 
```

现在console.debug中的第二个输出不一样了，它是空的，所以已经被删除了。但是，在浏览器中我仍然可以看到它。将鼠标悬停在第一个输出上不再突出显示任何内容。检查元素时，它会显示已删除的代码！或者它还在吗？

请注意，我已经检查了重复项。我在文档完全加载后执行操作。该元素是 SVG 类型的，但这不应该是重要的吗？

**问题：如何从浏览器中完全删除元素？**

# visual-studio - Windows 8 / Windows Server 2012 不支持尝试的 VSJitDebugger 操作

> ID：11940378
> 
> 赞同：8
> 
> 时间：2012-08-13T18:43:39.687
> 
> 标签：visual-studio, windbg

我们有在特定条件下添加 Debugger.Launch() 和 Debugger.Break() 的代码，并且此功能似乎在 Windows 8 / Windows Server 2012 中不起作用

在以前的 Windows 版本中，这工作得很好，启动一个显示 Visual Studio 调试对话框的窗口。

这是 Windows8/Windows Server 2012 中的一个新的突破性变化吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-18T00:07:40.533

microsoft connect 有一个未解决的票证，其中包含此问题的临时解决方法。

[即时调试，不支持尝试操作](https://web.archive.org/web/20131129114408/http://connect.microsoft.com:80/VisualStudio/feedback/details/770786/just-in-time-debugging-operation-attempted-is-not-supported)

从下面的评论：

> 只需`HKCR\AppID\{E62A7A31-6025-408E-87F6-81AEB0DC9347}\AppIDFlag`从更改`0x28`为`0x8`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-13T20:46:23.927

这确实是 Windows 8 中的一个变化。我还没有找到任何公共文档（尽管 Win8 尚未交付给客户）。但是，我会要求相关团队中的某个人酌情在 MSDN 上提供此信息。

这是从 Windows Vista 开始的 Session 0 隔离工作的一部分。

要返回 Win7/2008R2 设置，您需要执行以下操作：

对于注册表项`HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Windows`，将“ **NoInteractiveServices** ”值设置为*0*，（在 Windows 8 中）默认为 1。这允许您手动启动有助于在会话中为您提供可视对话框的服务，“*交互式服务检测*”（**ui0 检测**）。如果不设置此键，ui0detect 服务将无法启动，并出现“不支持功能”等错误。

```
net start ui0detect 
```

当然，您可以选择使该服务随 Windows 自动启动，并始终启动到能够调试会话 0 进程。

# extjs - 树形面板拖放默认行为

> ID：11940379
> 
> 赞同：1
> 
> 时间：2012-08-13T18:43:42.230
> 
> 标签：extjs, drag-and-drop, tree, extjs4, treepanel

我有两个树面板，我想在它们之间拖放。我知道有一个插件可以解决这个问题，但是我希望它以某种方式运行。在我的树形面板中，我展示了树的根节点，然后是它的所有子节点。默认的 DD 允许用户在树上的不同级别删除项目（即根的兄弟，根的孩子），我希望所有项目都是根的孩子以保持一致性。我怎样才能做到这一点，以便将任何拖入树形面板的项目关联为根的子项而不是根的兄弟项。原因：对于不了解此功能如何工作的用户，任一方向的一毫米可以将项目从兄弟变为子项，反之亦然。

另外，我想要它，所以我只能拖走那些孩子，并且根不能移动，如果可能的话。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T09:49:37.867

是的，有可能。您可以在目标 Tree 面板的树视图上监听 'beforedrop' 事件并实现您想要的。像这样 的东西[http://jsfiddle.net/EYtnk/1/](http://jsfiddle.net/EYtnk/1/) .. beforedrop 事件的参数之一是被拖动的节点。您可以检查它是否是源树的根节点，然后“返回 false；”

PS：在示例中，我只是为两棵树使用了相同的存储......所以节点被添加到两边。

# vba - Word中如何知道右键下的单词

> ID：11940381
> 
> 赞同：2
> 
> 时间：2012-08-13T18:44:02.130
> 
> 标签：vba, ms-word

我`VBA`为此`Word`在右键单击的上下文菜单中添加了一个按钮，该按钮启动了我的应用程序（有效）。

我需要单击的单词将其作为参数传递。我看到我不能使用`Selection`，因为右键单击没有选择单词，它给了我光标后面的字母。

根据我所阅读的内容，我可能会查看光标的位置，然后查看单词开始和结束的两侧。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T19:27:03.177

这似乎有效

```
Selection.Words(1).Text 
```

**编辑**

更健壮地解释句子的结尾。

```
Sub FindWord()

    Dim rWord As Range

    If Selection.Words(1).Text = vbCr Then 'end of sentence
        'get last word of sentence
        Set rWord = Selection.Words(1).Previous(wdWord)
    Else
        'get selected word
        Set rWord = Selection.Words(1)
    End If

    'There has to be a better way than this
    If rWord.Text = "." Or rWord.Text = "?" Then
        Set rWord = rWord.Previous(wdWord)
    End If

    Debug.Print rWord.Text

End Sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T19:28:43.003

这是检查光标下单词的最简单方法。

```
Sub Sample()
    Dim pos As Long

    '~~> if the cursor is at the end of the word
    Selection.MoveEnd Unit:=wdCharacter, Count:=1

    Do While Len(Trim(Selection.Text)) = 0
        '~~> Move one character behind so that the cursor is
        '~~> at the begining or in the middle
        Selection.MoveEnd Unit:=wdCharacter, Count:=-1
    Loop

    '~~> Expand to get the word
    Selection.Expand Unit:=wdWord

    '~~> Display the word
    Debug.Print Selection.Text
End Sub 
```

# android - 从edittext中提取数据并与字符序列进行比较

> ID：11940382
> 
> 赞同：0
> 
> 时间：2012-08-13T18:44:02.660
> 
> 标签：android, android-edittext

我正在尝试从 EditText 中拉出一条线并与图钉进行比较。如果是正确的密码，则显示授权，否则显示错误密码。我不能让 1234 等于 1234 - 它总是说 Pin Invalid。

```
Context context = this;
final Dialog dialog = new Dialog(context);
dialog.setContentView(R.layout.custom_dialog);
dialog.setTitle("Pin Entry");

final EditText pinEntry = (EditText) dialog.findViewById(R.id.pinAuth);

Button dialogButton = (Button) dialog.findViewById(R.id.dialogButton);

dialogButton.setOnClickListener(new OnClickListener() 
{
@Override
public void onClick(View v) 
{
    CharSequence alertText;
    int duration = Toast.LENGTH_SHORT;

    CharSequence pint = pinEntry.getText();

    if(pint != "1234")
    {
        alertText = "Pin invalid.\nPlease try again.";
        Toast toast = Toast.makeText(context, alertText, duration);
        toast.show();
        updateList();
    }

    else if(pint == "1234")
    {
        alertText = "Pin authorized";
        Toast toast = Toast.makeText(context, alertText, duration);
        toast.show();
    }   
dialog.dismiss();
}
});
dialog.show();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T18:48:44.183

**改变**

```
if(pint != "1234")
    {
        alertText = "Pin invalid.\nPlease try again.";
        Toast toast = Toast.makeText(context, alertText, duration);
        toast.show();
        updateList();
    }

    else if(pint == "1234")
    {
        alertText = "Pin authorized";
        Toast toast = Toast.makeText(context, alertText, duration);
        toast.show();
    } 
```

**到**

```
if(!(pint.equals("1234")))
    {
        alertText = "Pin invalid.\nPlease try again.";
        Toast toast = Toast.makeText(context, alertText, duration);
        toast.show();
        updateList();
    }

    else if(pint.equals("1234"))
    {
        alertText = "Pin authorized";
        Toast toast = Toast.makeText(context, alertText, duration);
        toast.show();
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T18:46:05.620

尝试使用

> `pint.equals("1234")`

代替

> 品脱 == “1234”

您不能将 != 和 == 用于字符串。这些检查引用而不是字符串的实际内容

# mysql - AddWithValue 不是 MySql.Data.MySqlClient.MySqlParameter VB.net 的成员

> ID：11940383
> 
> 赞同：0
> 
> 时间：2012-08-13T18:44:12.177
> 
> 标签：mysql, vb.net

我的代码会有什么问题？我有一个错误 AddWithValue is not member of MySql.Data.MySqlClient.MySqlParameter

这是我的代码：

```
 Dim bn As String = ""
    Dim bottles As Integer = 0

    Dim SQLStatement As String = "UPDATE patient SET number_of_bottles = @bottles WHERE bednumber = @bednumber"

    Using cnn As New MySqlConnection("Server=localhost; database=patientinfo;user id=root;password=")
        Dim cmdn As New MySqlCommand(SQLStatement, cnn)
        cmdn.Parameters.AddWithValue("bottles", bottles)
        cmdn.Parameters.AddWithValue("bednumber", bn)
        cnn.Open()
        cmd.ExecuteNonQuery()

    End Using 
```

我是 VB.net 和 MySql 的新手。任何帮助，将不胜感激。谢谢 ！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T19:52:51.033

如果您使用的提供程序不支持“AddWithValue”（有些不支持），您可以使用扩展方法制作自己的。这是一个带有一些重载（扩展 IDbCommand）的“AddWithValue”扩展方法的示例。

```
 ''' <summary>
    ''' Adds a parameter into the IDbCommand and sets it's name, value and type.
    ''' </summary>
    ''' <param name="cmd"></param>
    ''' <param name="paramName"></param>
    ''' <param name="paramValue"></param>
    ''' <param name="dbType"></param>
    ''' <remarks></remarks>
    <Extension()> _
    Public Sub AddWithValue(ByVal cmd As IDbCommand, ByVal paramName As String, ByVal paramValue As Object, ByVal dbType As DbType)
        Dim param As DbParameter = cmd.CreateParameter
        param.ParameterName = paramName
        param.DbType = dbType
        param.Value = paramValue
        cmd.Parameters.Add(param)
    End Sub

    ''' <summary>
    ''' Adds a parameter into the IDbCommand and name and value.
    ''' </summary>
    ''' <param name="cmd"></param>
    ''' <param name="paramName"></param>
    ''' <param name="paramValue"></param>
    ''' <remarks></remarks>
    <Extension()> _
    Public Sub AddWithValue(ByVal cmd As IDbCommand, ByVal paramName As String, ByVal paramValue As Object)
        Dim param As DbParameter = cmd.CreateParameter
        param.ParameterName = paramName
        param.Value = paramValue
        cmd.Parameters.Add(param)
    End Sub

    ''' <summary>
    ''' Adds a parameter into the IDbCommand and sets it's name, value and type.
    ''' </summary>
    ''' <param name="cmd"></param>
    ''' <param name="paramName"></param>
    ''' <param name="paramValue"></param>
    ''' <param name="dbType"></param>
    ''' <remarks></remarks>
    <Extension()> _
    Public Sub AddWithValue(ByVal cmd As IDbCommand, ByVal paramName As String, ByVal paramValue As Object, ByVal dbType As DbType, ByVal size As Integer)
        Dim param As DbParameter = cmd.CreateParameter
        param.ParameterName = paramName
        param.DbType = dbType
        param.Value = paramValue
        param.Size = size
        cmd.Parameters.Add(param)
    End Sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T18:52:56.803

您必须使用您在参数中使用的名称（`@`缺少符号）：

```
cmdn.Parameters.AddWithValue("@bottles", bottles)
cmdn.Parameters.AddWithValue("@bednumber", bn) 
```

# facebook - 喜欢按钮在几篇文章中不起作用

> ID：11940384
> 
> 赞同：0
> 
> 时间：2012-08-13T18:44:22.767
> 
> 标签：facebook, facebook-like

facebook 之类的插件（用作 iframe）仍然不适用于我工作的网站。

我知道上周发生的问题，但我什至没有调试器为 URL 工作。

例子：

[简单的文章](http://extra.globo.com/famosos/zilu-assume-pela-primeira-vez-que-esta-separada-de-zeze-di-camargo-vida-continua-5767649.html)

在下图中，您可以看到 fb:like 按钮应该出现的位置。

![fb喜欢按钮位置](../Images/93e7634ee374cc393791c04795d2e0a7.png)

上面在 facebook URL 调试器（[链接](https://developers.facebook.com/tools/debug/og/object?q=http://extra.globo.com/famosos/zilu-assume-pela-primeira-vez-que-esta-separada-de-zeze-di-camargo-vida-continua-5767649.html)）上的文章的相同 URL 显示没有关于打开图形标记的响应 - 在我看来，所有元标记都可以：

```
<meta property="og:url" content="http://extra.globo.com/famosos/zilu-assume-pela-primeira-vez-que-esta-separada-de-zeze-di-camargo-vida-continua-5767649.html"/>
<meta property="og:title" content="Zilu assume pela primeira vez que está separada de Zezé Di Camargo: ‘A vida continua’" />
<meta property="og:locale" content="pt_BR">
<meta property="og:type" content="article" />
<meta property="og:image" content="http://extra.globo.com/incoming/5767648-1c6-157/w107h60-PROP/zilu-zeze-dicamargo.jpg"/>
<meta property="og:site_name" content="Extra Online" />
<meta property="fb:app_id" content="205680889447721"/>
<meta property="fb:admins" content="100000043813964" /> 
```

实际上，有一个非封闭的元标记**og_type**但这不是真正的问题（[w3schools 的元-](http://www.w3schools.com/tags/tag_meta.asp) **HTML 和 XHTML 之间的差异**部分和页面文档类型是 HTML）。

有可能不是在网站上而是在 facebook 上出现问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T19:47:23.880

*   我会尝试将 Like 按钮 iFrame 放在 之外`<div id="fb-root">`，它不属于那里。`<div id="fb-root">`如果需要包装它，请将其放在下方并使用带有另一个 id 的 div。
*   对于调试工具问题，我会尝试将我的 og 元数据放在后面的任何其他数据之上，`<meta http-equiv="content-type" content="text/html; charset=utf-8">`这样在 Facebook 机器人抓取它需要的信息之前就不会发生任何奇怪的事情。

# wordpress - 如何在论坛帖子上方显示 bbpress Super Sticky 或 Sticky 帖子？

> ID：11940386
> 
> 赞同：0
> 
> 时间：2012-08-13T18:44:27.823
> 
> 标签：wordpress, bbpress

我希望能够在论坛帖子上方显示 Super Sticky 或 Sticky 帖子。换句话说。我将在页面上发布帖子，并且超级/粘性帖子将在那里。但是，在帖子列表的上方，我也希望在那里有超级/粘性帖子。有点像“特色讨论”类型的部分。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T22:40:55.133

所以我最终这样做是为了解决我的问题。我在包含主题的表格上方添加了一个 div，然后按如下方式创建了一些 jquery：

```
var rows = $('table.bbp-topics').find('tr.super-sticky');

        rows.each(function(index) {
            var headhref = $('a.bbp-topic-permalink', this).attr('href');
            var headline = $('a.bbp-topic-permalink', this).html();
            var excerpt = $('.excerpt', this).text();
            var author = $('a.bbp-author-name', this).html();
            var photo = $('a.bbp-author-avatar > img', this).attr('src');
            var replies = $('.bbp-topic-voice-count', this).text();
            var followers = $('.bbp-topic-reply-count', this).text();
            var freshness = $('.bbp-topic-freshness > a', this).html();
            var meta = $('p.bbp-topic-meta', this).text();

            var newrow = '<div class="featured-row"><div class="topic-meta">' +
                '<img class="author-photo" src ="' + photo + '">' +
                '<div class="author">' + author +'</div> ' +
                '<div class="topic-title"><a href="' + headhref + '">' + headline + '<a/></div>' +
                '<div class="excerpt">' + excerpt + '</div></div>' +
                '<div class="replies"><h3>Replies</h3><hr/><p>' + replies + '</p></div> ' +
                '<div class="followers"><h3>Followers</h3><hr/><p>' + followers + '</p></div> ' +
                '<div class="freshness"><h3>Updated</h3><hr/><p>' + freshness + '</p></div> ' +
                ' </div>';

            console.log(newrow);

            $('#supersticky').fadeIn().append(newrow)

        }) 
```

希望这对其他人有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-11-12T19:32:40.173

这是一个更简单的答案，[来自这个 bbpress.org 线程](https://bbpress.org/forums/topic/custom-query-to-display-sticky-posts-only/)

`$query = new WP_Query(array('post__in' => bbp_get_super_stickies());`

# php - 在文本区域提交多个数字以插入 SQL Server 表

> ID：11940389
> 
> 赞同：0
> 
> 时间：2012-08-13T18:44:51.433
> 
> 标签：php, sql-server

我正在尝试执行以下操作，但找不到这样做的方法。

我使用 HTML 和 PHP。

我有一个这样的列表/格式的数字列表：

```
4443457
2554566
2347821
8978576 
```

我希望能够在写入时从上面的列表中准确复制这些数字，并将它们粘贴到文本框或文本区域字段中。

然后在按下 SUBMIT 后，这些数字将通过 php 单独放入查询/查询中，例如：

```
insert into table (column1, column2) values  ('test', '4443457')
insert into table (column1, column2) values  ('test', '2554566')
insert into table (column1, column2) values  ('test', '2347821')
insert into table (column1, column2) values  ('test', '8978576') 
```

一站式提交

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T18:51:51.373

```
foreach(explode("\n", $_POST['numbers']) as $value) {

    // insert $value
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T18:49:40.910

要获取数字：

```
$numbers = explode("\n", $_GET['textarea']); 
```

要插入一个查询（它更快）：

```
INSERT INTO table (column1, column2) VALUES (14864, "a"), (64866, "b"), (564168, "c) 
```

# javascript - 将带有数据的数组传递给 Google 图表工具

> ID：11940392
> 
> 赞同：0
> 
> 时间：2012-08-13T18:45:06.083
> 
> 标签：javascript, ruby, ruby-on-rails-3, google-visualization

我正在尝试使用 Google 图表工具绘制图表。

```
 google.load("visualization", "1", {packages:["corechart"]});
  google.setOnLoadCallback(drawChart);
  function drawChart() {
    var data = new google.visualization.DataTable();
    data.addColumn('number', 'Month');
    data.addColumn('number', 'Money');
    data.addRows([
        [<%= @months %>, <%= @money %>] 
        ]);

    var options = {
      title: 'Title'
    };

    var chart = new google.visualization.LineChart(document.getElementById('chart_div_2'));
    chart.draw(data, options);
  } 
```

@months 和 @money 是数组。不幸的是，可能我不能以这种方式传递一个数组，因为图表没有显示出来。处理这种情况的正确方法是什么？

**更新**

好的，我在 for 循环中使用了 Gon 和 setCell 函数，它可以工作

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T19:57:32.370

使用 json。该`respond_to`块可用于此。返回包含数据值数组的 json 哈希。

```
def months_monies
  respond_to |format|
    format.json {render :json => @post}
    # The post is a Ruby hash that gets converted into json string
    format.html #months_monies.html.erb
  end
end 
```

考虑一个`@post`变量是的例子，比如说`{:a => {"January" => 1000}, :b => {"April" => 1222}}`

这可以通过 AJAX 调用从 javascript 块访问`http://localhost:3000/months_monies.json`

使用 jQuery 的示例：

```
$.get("http://localhost:3000/controller/months_monies.json",function(post){
  post.a.January # => 1000
  post.b.April   # => 1222
}); 
```

如果`@post`变量是一个数组（在您的情况下很可能是这种情况），则该方法几乎相似。说`@post = [{'january' => 1000}, {'february' => 1111}]`

然后您将使用`post[0].january`and`post[1].february`来获取`$.get`块中的值。

希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T07:32:10.330

在我的 SO 问题中，我展示了一个将 ruby​​ 数组传递给 Google 图表 api 的工作示例。（我的问题与在 Ruby 中指定缺失/空系列值有关，这似乎不会影响您的问题。）

[在rails应用程序中使用google chart api-使用arrayToDataTable时如何在系列中指定一个空（缺失）值](https://stackoverflow.com/questions/12890401/using-google-chart-api-in-rails-app-how-specify-a-null-missing-value-in-a-se)

# node.js - 如何在 node.js 中设置视图（模板）目录和静态文件的路径

> ID：11940395
> 
> 赞同：3
> 
> 时间：2012-08-13T18:45:11.357
> 
> 标签：node.js, express

我已经创建了**layout.jade**、**navigation.jade**和**index.jade**，我想将它们粘合在一起。

在**server.js**中，我该怎么做

1.  设置视图（模板）目录的路径，以及
2.  设置静态文件的路径。

是否需要`node_module`放在包含**server.js**的文件夹中？

下面是**server.js**的代码：

```
//create an app server
var express = require("express");
var server = express.createServer();

//set path to the views (template) directory
app.set('views', D:\#Programming\node.js\trial box\views);

//set path to static files
//how is the path to static files set?
app.use(express.static(__dirname + '/../public'));

//handle GET requests on /
app.get('/', function(req, res){
    res.render('index.jade', {title: 'web project'});
});

//listen on localhost:3000
app.listen(3000); 
```

先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-17T18:55:19.270

这个问题有点老了，但我还是会留下答案。您需要将您的 app.use(... 语句放在 app.configure() 的回调函数中，就像这样..

```
app.configure(function(){
  app.use(express.static(__dirname + '/../public'));
}); 
```

* * *

## 回答 #2

> 赞同：-4
> 
> 时间：2012-08-13T18:46:47.617

您应该使用`express`bin 工具来引导一个您将获得所有设置的项目。要安装它：

```
sudo npm install express -g 
```

# postgresql - 转义 hstore 包含 JDBC Prepared 语句中的运算符

> ID：11940401
> 
> 赞同：9
> 
> 时间：2012-08-13T18:45:51.503
> 
> 标签：postgresql, jdbc, hstore

我将 PostgreSQL 9.1.4 与 hstore 和[PostgreSQL JDBC](http://jdbc.postgresql.org/)驱动程序 (9.1-901.jdbc4) 一起使用。

我正在尝试在 PreparedStatement 中使用包含运算符 ( `?`, `?&`, )，但是该字符被解析为变量占位符。可以转义此字符以在查询中发送正确的运算符吗？`?|``?`

一个例子：

```
PreparedStatement stmt = conn.prepareStatement("SELECT a, b FROM table1 WHERE c ? 'foo' AND d = ?");
stmt.setInt(1, dValue);
stmt.executeQuery(); 
```

在这种形式下，以下示例将引发异常：

```
org.postgresql.util.PSQLException: No value specified for parameter 2. 
```

**更新：**

在调查了 pgjdbc 驱动程序中的查询解析器之后，[这个片段](https://github.com/pgjdbc/pgjdbc/blob/master/org/postgresql/core/v3/QueryExecutorImpl.java#L164)似乎表明无法转义该`?`字符。剩下的问题是：

*   JDBC 规范中是否有任何内容允许`?`转义 a 并且是参数占位符以外的任何内容？
*   除了使用将变量手动插入查询字符串的普通语句之外，还有什么更好的解决方法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-14T18:20:48.903

实际上，看起来 java SQL 解析器不兼容 hstore。

但由于语法`c ? 'foo'`等同于`exist(c, 'foo')`，因此您可以轻松解决此问题。查看以下页面以了解hstore的*详细运算符是什么。*

[Postgres hstore 文档](http://www.postgresql.org/docs/9.1/static/hstore.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-09-01T17:56:52.053

There is a discussion about this issue on pgsql-hackers mailing list: [http://grokbase.com/t/postgresql/pgsql-hackers/1325c6ys9n/alias-hstores-to-so-that-it-works-with-jdbc](http://grokbase.com/t/postgresql/pgsql-hackers/1325c6ys9n/alias-hstores-to-so-that-it-works-with-jdbc)

For now I like most this workaround which also supports indexes:

```
CREATE FUNCTION exist_inline (hstore, text) RETURNS bool AS $$ SELECT $1 ? $2; $$ LANGUAGE sql; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T00:06:23.890

如果您想使用 PreparedStatement 添加多个键值对，则可以执行以下操作：

```
PreparedStatement ps = c.prepareStatement(
                     "insert into xyz(id, data) values(?, hstore(?, ?))");

ps.setLong(1, 23456L);
ps.setArray(2, c.createArrayOf("text", new String[]{"name", "city"}));
ps.setArray(3, c.createArrayOf("text", new String[]{"Duke", "Valley"})); 
```

这将插入：`23456, 'name=>Duke, city=>Valley'`

# php - 使用 ajax 调用锚标记单击事件上的 webservice，并在 url 中更改参数

> ID：11940402
> 
> 赞同：0
> 
> 时间：2012-08-13T18:45:53.703
> 
> 标签：php, ajax, anchor

```
<?php

                     $dest=explode(",",$destination);
                     $city= $dest[0];
                     $state= $dest[1];
                     $country= $dest[2];
                    // initiate curl and set options
                    $ch = curl_init();
                    $ver = 'v3/';
                    $method = 'list/';
                    $otherElementsStr = 'cid=55505&minorRev=5&customerUserAgent=Mozilla/4.0&customerIpAddress=172.16.82.13&locale=en_US&currencyCode=USD';
                    $apiKey = 'myapikey';  
                    $secret = 'mysecretkey';  
                    $timestamp = gmdate('U'); // 1200603038
                    //echo $timestamp;   
                    $sig = md5($apiKey . $secret . $timestamp);
                    $service = 'http://api.ean.com/ean-services/rs/hotel/';
                    $filter='&city='.$city.'&stateProvinceCode='.$state.'&countryCode='.$country.'&supplierCacheTolerance=MED_ENHANCED&arrivalDate='.$CheckInDate.'&departureDate='.$CheckOutDate;
                    $url =$service.$ver. $method ."?apiKey=".$apiKey."&sig=".$sig.$otherElementsStr.$filter ;
                    //echo $url;
                    $ch = curl_init();
                    curl_setopt($ch,CURLOPT_URL,$url);
                    curl_setopt($ch,CURLOPT_RETURNTRANSFER,1);
                    curl_setopt($ch,CURLOPT_CONNECTTIMEOUT, 4);
                    $json = curl_exec($ch);
                    if(!$json) {
                        echo curl_error($ch);
                    }
                    curl_close($ch);

                    //print_r(json_decode($json));

                    $array = json_decode($json, true);

                    $hotels = $array['HotelListResponse']['HotelList']['HotelSummary'];
                    $result='';
                    foreach ($hotels as $hotel) {
                        $result .= '<div class="hotel-listing-inner">
                                        <div class="list-hotel-1">
                                            <a href="#"><img src="http://images.travelnow.com/'. $hotel['thumbNailUrl'] . '" alt="" border="0" /></a>
                                            <span><a href="#">more photos</a></span>
                                        </div>
                                    <div class="list-hotel-right">
                                        <div class="charge-btn">
                                            <a href="#"><strong>'. number_format((float)$hotel['lowRate'], 2, '.', '') . '</strong>
                                                Per Night</a>
                                        </div>
                                        <div class="select-btn"><a href="#">select hotel</a></div>

                                    </div>    
                                        <div class="listing-content">
                                            <h2><a href="#">' . $hotel['name'] . '</a></h2>
                                            <div class="star-rating">
                                            <span class="stars">'. $hotel['hotelRating'] .'</span>

                                            </div>
                                            <h3>3.5</h3>
                                            <div class="rating-img"><img src="images/guest-reviews-2-5.png" alt="" border="0" />from 197 guest reviews</div>
                                        </div>
                                         <div class="city-name">
                                            <p>' . $hotel['address1'] . ',' . $hotel['postalCode'] . '</p>
                                            <p>' . $hotel['city'] . ','. $hotel['countryCode'] . '</p>
                                            <p><a href="#">Show on Map or Get Directions</a></p>
                                        </div>  
                                        <div class="hotel-locat">
                                        <span>
                                         ' . html_entity_decode($hotel['shortDescription'] ). '
                                         </span>
                                         <a href="#">more</a>
                                        </div>  
                                    </div>';
                    }

                    echo $result;

            ?> 
```

这基本上是一个 EAN API 调用。现在我在同一页面上有一个**按价格排序**的锚标记 ，当用户单击该链接时，需要再次调用此 Web 服务，但过滤器参数不同。将对这个字符串进行一些更改。

```
$filter='&city='.$city.'&stateProvinceCode='.$state.'&countryCode='.$country.'&supplierCacheTolerance=MED_ENHANCED&arrivalDate='.$CheckInDate.'&departureDate='.$CheckOutDate; 
```

**所以我的问题是，当单击锚按钮时，如何通过更改 Web 服务的 URL 再次调用 php 代码。**

# vba - 在 VBA 中使用 Vlookup

> ID：11940403
> 
> 赞同：0
> 
> 时间：2012-08-13T18:45:54.140
> 
> 标签：vba, excel

我为单元格和工作表添加了循环，但出现语法错误。

```
Sub check() 
Dim ws As Worksheet 
Dim i As Long 
For Each ws In Worksheets 

For i = 5 To 10

ws.Range("F" & i).Formula = _
 "=VLookup((CONCATENATE(C1,"" "",C5)),'C:\Documents[TestData.xlsx]Sheet1'!$A$2:$G$28,7, FALSE)"
Sheets("Sheet1").Range("F5").Value = Sheets("Sheet1").Range("F5").Value

Next
End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T18:49:25.067

这是你正在尝试的吗？

```
Sub check()
    Sheets("Sheet1").Range("F5").Formula = _
    "=VLookup((CONCATENATE(C1,"" "",C5)),'C:\Documents[TestData.xlsx]Sheet1'!$A$2:$G$28,7, FALSE)"
    Sheets("Sheet1").Range("F5").Value = Sheets("Sheet1").Range("F5").Value
End Sub 
```

**跟进**

要将其放入循环中，您必须将行存储在变量中然后使用它。例如

`Range("F5")`也可以写成`Range("F" & "5")`

所以现在你所要做的就是继续`5`循环替换。请参阅下面的示例

```
Sub check()
    Dim i As Long

    '~~> From Row 5 to row 10
    '~~> Chnage as applicable
    For i = 5 To 10
        Sheets("Sheet1").Range("F" & i).Formula = _
        "=VLookup((CONCATENATE(C1,"" "",C" & i & _
        ")),'C:\Documents[TestData.xlsx]Sheet1'!$A$2:$G$28,7, FALSE)"

        Sheets("Sheet1").Range("F" & i).Value = Sheets("Sheet1").Range("F" & i).Value
    Next i
End Sub 
```

# php - PHP 在服务器上启动 PowerPoint

> ID：11940404
> 
> 赞同：0
> 
> 时间：2012-08-13T18:45:56.967
> 
> 标签：php, xampp, powerpoint

```
echo "C:/DATA/SLIDES/" . date("l") . ".pps";
$openPowerPoint = "POWERPNT.EXE /S C:\\DATA\\SLIDES\\" . date("l") . ".pps";
system($openPowerPoint); 
```

浏览器似乎正在等待，服务器上没有任何反应。难道我做错了什么？

该文件名为 Monday.pps

更新 -

我可以运行这段代码

```
$runCommand = "C:\\WINDOWS\\system32\\shutdown.exe /r /t 5 /c \"The system is being updated\"";
$WshShell = new COM("WScript.Shell");
$output = $WshShell->Exec($runCommand)->StdOut->ReadAll;
echo "<p>$output</p>"; 
```

请在启动 powerpoint 方面提供任何帮助，我们将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T19:01:42.353

系统仅适用于可执行文件。在 Windows 系统上，`.pps`默认情况下不可执行。

尝试单独使用[`start`命令](http://ss64.com/nt/start.html)或与[`cmd`命令](http://ss64.com/nt/cmd.html)结合使用，以允许跨越一个新的 shell 并使 PHP 能够继续。

# url - URL：在目标查询中包含参数

> ID：11940414
> 
> 赞同：1
> 
> 时间：2012-08-13T18:46:22.787
> 
> 标签：url, drupal

我进行了很多搜索以尝试解决此问题，但我不太确定要搜索什么。我真的没有找到任何东西。

本质上，我正在开发一个用户可以注册活动的网站。但是，如果用户没有登录，我需要将他们重定向到注册屏幕。这是我能够毫不费力地完成的。但是，我需要重定向回他们尝试注册的事件。

我真正的问题是我需要返回的页面的 URL 包含一个参数，我不确定如何让注册页面在重定向回来时考虑该参数。

* * *

当前，当匿名用户尝试访问

```
http://[...].com/drupal/?q=civicrm/event/register&id=6 
```

我让它把你重定向到

```
http://[...].com/drupal/?q=user/register&destination=civicrm/event/register&id=6 
```

但是，一旦提交表单，“&id=6”就不会作为目标参数的一部分，这意味着你只是去。

```
http://[...].com/drupal/?q=civicrm/event/register 
```

这不是一个有效的页面。

**有没有办法让目标参数包含“&id=6”？**

一时兴起我也试过。

```
[...]destination='civicrm/event/register&id=6'
[...]destination="civicrm/event/register&id=6"
[...]destination=civicrm/event/register#id=6 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-14T02:58:08.177

您需要对目的地的值进行 url 编码。试试这个：

```
[..]destination=civicrm/event/register%3Fid%3D6 
```

%3F 是问号 (?) 的十六进制代码，%3D 是等于 (=) 的代码。

# python - Pandas：分离分组和索引

> ID：11940420
> 
> 赞同：3
> 
> 时间：2012-08-13T18:47:16.597
> 
> 标签：python, pandas

我有一个`DataFrame`财务数据：

```
 open    high     low   close     volume
date                                                 
2012-02-13  0.3476  0.3592  0.3449  0.3530  105990679
2012-02-14  0.3470  0.3528  0.3409  0.3429  131799968
2012-02-15  0.3453  0.3513  0.3365  0.3393  119421442
2012-02-16  0.3358  0.3438  0.3271  0.3438  123189697
2012-02-17  0.3488  0.3588  0.3464  0.3546  167932148
2012-02-20  0.3590  0.3682  0.3577  0.3634  127657258
2012-02-21  0.3630  0.3675  0.3524  0.3575  137016196 
```

我目前将其分组为：

```
agg = {'open': lambda s: s[0],
       'high': lambda s: s.max(),
       'low': lambda s: s.min(),
       'close': lambda s: s[-1],
       'volume': lambda s: s.sum()} 
```

通过

```
df.groupby(lambda d: d.isocalendar()[:2]).agg(agg) 
```

除了我的数据现在由`(year, week)`. 我希望数据按组中最早成员的日期进行索引。我目前的 hack 大致如下：

```
agg['date'] = lambda s: s[0]
df2 = df.copy()
df2['date'] = df2.index
df2.groupby(lambda d: d.isocalendar()[:2]).agg(agg).set_index('date') 
```

这似乎可行，但是我想知道是否有一种方法可以分离分组和索引，以便组键不会自动成为帧索引。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T10:19:09.680

据我所知，您正在寻找的分隔不存在，但是......假设索引已排序（这也是您的*hack*所必需的），对 groupby 函数稍作更改即可满足您的需求。

```
In [194]: cache = {}

In [195]: df.groupby(lambda d: cache.setdefault(d.isocalendar()[:2], d)).agg(agg)
Out[195]:
             close    high     low    open     volume
2012-02-13  0.3546  0.3592  0.3271  0.3476  648333934
2012-02-20  0.3575  0.3682  0.3524  0.3590  264673454 
```

# wpf - XAML Resx 本地化未按预期工作

> ID：11940423
> 
> 赞同：3
> 
> 时间：2012-08-13T18:47:47.460
> 
> 标签：wpf, xaml, localization, resources, resx

我正在尝试使用 resx 文件来本地化我在 XAML 文件中使用的一些字符串。我查看了网络上的其他文档，他们似乎都推荐了一个两部分的过程：

1.  将 clr-namespace 添加到您的窗口，如下所示：
    `xmlns:props="clr-namespace:PJConfiguration.Properties"`

2.  使用该命名空间来本地化您的字符串，如下所示：
    `Content="{x:Static props:Resources.SharedSettings}"`

我已经这样做了，并且还确保我的资源类是公共的，但是在第 2 步中我仍然从 XAML 中收到以下错误：

> 找不到类型“资源”。

有谁知道还有什么可能导致这个问题？提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-21T20:32:01.100

为了使资源对 XAML 可见，您必须确保资源的代码生成模式设置为公共。在 VS 中，您可以在资源设计器窗口顶部附近的 ComboBox 中找到该设置。

有关在 XAML 中使用 .Net 资源的更多信息，您可能需要参考以下博客文章：[http ://wpfglue.wordpress.com/category/localization/](http://wpfglue.wordpress.com/category/localization/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-22T00:26:10.607

检查您的 .resx 文件是否是 Application 程序集的 Properties 目录中的默认 Resources.resx 文件。如果是这样，则 XAML 没有理由无法从本地程序集下的正确命名空间中找到公共类 Resources。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-13T19:02:10.440

[尝试按照此答案](https://stackoverflow.com/a/8240774/122005)中的建议在步骤 2 中指定程序集名称。

# c# - 检查多个文件中的（.csv 或 .dat）文件扩展名，如果未向用户发送警报

> ID：11940427
> 
> 赞同：0
> 
> 时间：2012-08-13T18:47:59.723
> 
> 标签：c#, ssis

我是SSIS的新手，

每 30 分钟我将在源目录中收到一个文件或多个文件

我需要遍历这些文件并检查它是否具有`.csv`或`.dat`扩展名：

*   如果不是：向用户发送警报。
*   如果是：执行包

**编辑：我试过了；**

```
Main()
{ 
    try
    {
        string[] filenames;
        filenames = Directory.GetFiles(@"C:Input_Data\");
        string FileExtension = Path.GetExtension("filenames");
        if (FileExtension == ".DAT" && FileExtension == ".csv") 
            Dts.Variables["FileExist"].Value = 1;
    }
    catch 
    { 
        Dts.Variables["FileExist"].Value = 0; 
    }

    Dts.TaskResult = (int)ScriptResults.Success;
} 
```

但即使文件存在`.dat`扩展名，它也会返回 0 并发送警报。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T19:31:48.007

也许你的意思是写...

```
if (FileExtension == ".DAT" || FileExtension == ".csv") 
```

否则它永远不会评估为真。

此外，您可能想要某种循环，您当前的结构正试图一次访问所有文件（甚至没有这样做）

```
filenames = Directory.GetFiles(@"C:\Input_Data\");
foreach(string filename in filenames)
{
    string FileExtension = Path.GetExtension(filename);
    if (FileExtension == ".DAT" || FileExtension == ".csv") 
        Dts.Variables["FileExist"].Value = 1;
} 
```

编辑：

根据我认为您所说的，您希望 FileExist 仅在仅包含 DAT 和 CSV 类型且不包含其他类型时才等于 1，在这种情况下，您希望稍微反转逻辑。

```
filenames = Directory.GetFiles(@"C:\Input_Data\");
Dts.Variables["FileExist"].Value = 1;
foreach(string filename in filenames)
{
    string FileExtension = Path.GetExtension(filename);
    if (FileExtension != ".DAT" && FileExtension != ".csv") 
        Dts.Variables["FileExist"].Value = 0;
} 
```

# php - Doctrine2 代理 getId 魔术方法？

> ID：11940429
> 
> 赞同：0
> 
> 时间：2012-08-13T18:48:23.017
> 
> 标签：php, doctrine-orm

Doctrine2*似乎*为它的 Proxy 对象添加了延迟加载的魔力。这使我的结果不正确，我无法弄清楚是什么原因造成的。

这是我的班级模型：

类“RedProduct”继承自抽象类“Product”，它实现了接口“BaseProduct”

抽象类 Product 持有主键：

```
abstract class Product implements BaseProduct {
   /** @Id @Column (type="integer", name="ID") @GeneratedValue */
    protected $id;

    public function getId() {    
        return $this->id;        
    }                            
} 
```

我希望 RedProduct 在返回之前在 id 前面加上字母“R”。

```
class RedProduct extends Product {
    public function getId() {
       return 'R' . $this->id;
    }
} 
```

但在代理类中，getId() 方法（并且只有 getId() 方法）已修改为：

```
public function getId()
{
    if ($this->__isInitialized__ === false) {
        return $this->_identifier["id"];
    }
    $this->__load();
    return parent::getId();
} 
```

## 这意味着我的对象在未初始化时不会返回正确的 id！

### “getId”是 Doctrine2 的保留方法还是魔术方法？当我在基类和继承类中创建其他方法时，它对代理没有这种影响。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-08-15T15:57:07.010

如果您检查代理上的 getId() 方法，您会看到它有这一行：

```
return parent::getId(); 
```

这意味着它将调用模型类 (RedProduct) 上定义的 getId() 函数，因为所有代理都扩展了相应的模型。问题出在其他地方。

我不确定你想通过修改模型返回的 id 来实现什么，但是 Doctrine 在持久化实体时不会调用你的 getter，它使用反射，所以如果问题是你的 id 在数据库中不正确，这个可能是原因。

# html - 如何将多尺寸盒子放在没有空格的容器中？

> ID：11940430
> 
> 赞同：1
> 
> 时间：2012-08-13T18:48:23.153
> 
> 标签：html, css

有谁知道如何在大容器中放置多个具有多个大小的 div（框）以仅在容器底部留出空白空间？

这是我想要的表示：

![在此处输入图像描述](../Images/ee4d2107040598fcee15f3c65479ccfe.png)

这是我所拥有的：

![在此处输入图像描述](../Images/8a37ce17709662517ef0014a69a7cfa8.png)

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T19:02:28.500

听起来您正在尝试将多个不同尺寸的容器装入一个已知尺寸的容器中，以获得最佳的适合度。如果您愿意使用 jQuery，JQuery masonry 非常适合，尽管不能保证它会在底部留下所有空白区域。

此处的文档：http: [//masonry.desandro.com/](http://masonry.desandro.com/)

演示在这里： http: [//masonry.desandro.com/demos/basic-single-column.html](http://masonry.desandro.com/demos/basic-single-column.html)

您可以将 gutterWidth 设置为 0 以消除列之间的所有空间。[http://masonry.desandro.com/docs/options.html](http://masonry.desandro.com/docs/options.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T18:55:55.230

如果没有更多信息（您当前的代码、图表、示例网站），我不确定您在这里要问什么。如果您只是想为容器添加底部间距，请尝试将 CSS 与`padding-bottom`?

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-13T19:02:36.317

你的意思是像[http://jsfiddle.net/ZFdHz/](http://jsfiddle.net/ZFdHz/)这样的想法吗？

# sql - 如何在 SQL 中优化笛卡尔积查询

> ID：11940432
> 
> 赞同：1
> 
> 时间：2012-08-13T18:48:29.153
> 
> 标签：sql, query-optimization, cartesian-product

我在 SQL 中的多个表上查询笛卡尔积。

如果我查询

```
SELECT * FROM TABLE1, TABLE2, ... , TABLE n   WHERE .... 
```

它可能很快。

让我说，它只提供 1-3 次点击。

现在，如果我查询更多表，

```
SELECT * FROM TABLE1, TABLE2, ... , TABLE n, TABLE n+1, ..., TABLE m   WHERE .... 
```

它慢慢地分解。

为什么？sql 是否从最后一个表开始遍历所有组合？

我的优化问题：

我应该选择 TABLE 1 作为最能缩小和过滤搜索范围的表，还是最后一个 TABLE m？

或者还有什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T18:55:36.023

您的标题说明了一切 - 笛卡尔积。除非您在各个表之间指定连接条件，否则数据库服务器将尝试生成所有可能的**记录**组合。当您添加表时，它会快速增长，例如 5 个表，10 = 10^5，100,000 条记录。

您需要使用正确的连接技术（左、右、内）连接子句来缩小记录集的范围。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T18:58:16.260

在 3 张桌子上加入几张桌子也很慢。解决方案可以是选择的一些乘法

类似的东西：

```
SELECT * FROM TABLE1, 
  (SELECT * FROM TABLE2, 
     (SELECT * FROM TABLE3, 
        (..)
      WHERE ..) 
   WHERE .. )
WHERE
 ... 
```

# symfony - 如何将图像添加到 Symfony2 表单中选择列表的每个选项中？

> ID：11940435
> 
> 赞同：1
> 
> 时间：2012-08-13T18:48:56.010
> 
> 标签：symfony, twig, symfony-forms

我正在使用 Symfony 2 表单创建一个扩展的选择列表，使用单选按钮选择是否以匿名用户身份发布博客（显示用户名）。

BlogType.php 文件中的表单字段类型定义如下所示（我从控制器传递选项及其值，但它应该与我的问题无关）：

```
$builder->add('is_anonymous', 'choice', array(
    'choices'   => $options['is_anonymous'],
    'required'  => true,
    'multiple'  => false,
    'expanded'  => true,
)); 
```

我尝试通过在模板树枝文件中执行以下操作来[应用 Symfony2 Cookbook 中的“如何自定义单个字段”部分：](http://symfony.com/doc/master/cookbook/form/form_customization.html#how-to-customize-an-individual-field)

```
<div class="post_as">
    {{ form_label(form.is_anonymous, 'Post as:') }}
    {{ form_errors(form.is_anonymous) }}

    {% form_theme form _self %}
    {% block _factor_is_anonymous_0_label %}
        <img src="/images/anonymous-32.png"/>
        {{ block ('form_label') }}
    {% endblock %}
    {% block _factor_is_anonymous_1_label %}
        <img src="/images/user-32.png"/>
        {{ block ('form_label') }}
    {% endblock %}

    {{ form_widget(form.is_anonymous) }}
</div> 
```

但是，上述结果导致两个图像都显示在选择列表之前，并且每个图像都显示在其相应的单选按钮旁边，如生成的 html 所示：

```
<div class="post_as">
    <label class="required">Post as:</label>
    <img src="/images/anonymous-32.png"/>
    <img src="/images/user-32.png"/>
    <div id="factor_is_anonymous">
        <input type="radio" id="factor_is_anonymous_0" name="factor[is_anonymous]" required="required" value="true" />
        <img src="/images/anonymous-32.png"/>
        <label for="factor_is_anonymous_0" class="required">Anonymous Collaborator</label>
        <input type="radio" id="factor_is_anonymous_1" name="factor[is_anonymous]" required="required" value="false" />
        <img src="/images/user-32.png"/>
        <label for="factor_is_anonymous_1" class="required">User Name</label>
    </div>
</div> 
```

如何摆脱显示两次的图像？我认为这与整体选择“行”的渲染以及两个选择中的每一个的渲染中显示的图像有关。我尝试了各种组合来显示整体标签而不是，但我无法解决问题......有人可以帮忙吗？谢谢...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T21:35:25.657

您需要将表单块的定义移到任何其他块**之外**。即，将这些行移到任何其他块之外，最好是在文件的开头或结尾

```
{% block _factor_is_anonymous_0_label %}
    <img src="/images/anonymous-32.png"/>
    {{ block ('form_label') }}
{% endblock %}
{% block _factor_is_anonymous_1_label %}
    <img src="/images/user-32.png"/>
    {{ block ('form_label') }}
{% endblock %} 
```

# java - 如何使用休眠将文本区域输入存储到数据库中？

> ID：11940436
> 
> 赞同：0
> 
> 时间：2012-08-13T18:49:06.603
> 
> 标签：java, database, hibernate, textarea

我在一个名为 information.jsp 的 jsp 文件中创建了一个 textarea，当用户单击提交时，我试图让它将来自它的输入存储到数据库中。我制作了 information.hbm.xml 文件，如下所示：

**信息.jsp：**

```
<textarea id = "desc" rows="5" cols="115" onkeypress="textCounter(this,20);"><c:out value="${informationView.storedDescription}"/></textarea> 
```

**信息.hbm.xml**

```
<hibernate-mapping>
  <class name="Information" table="INFO_USER">
      <id name="id" type="long" column="INFO_ID">
  <generator class="native">
    <param name="sequence">ID_SEQ</param>
  </generator>
</id>

  <property name="description" column="DESC"/>

</class>
</hibernate-mapping> 
```

然后，我创建了一个`Information`带有 getter 和 setter 的类，用于描述存储和检索数据库中的信息。我只是不知道如何从提交事件的文本区域中将输入输入到描述中......

从我一直在阅读的内容来看，我认为`InformationAction`当有人点击提交但又不确定时，我必须做一个实际保存它。我是 Hibernate 的新手，并且在将输入保存到数据库并检索它以在有人重新打开页面时自动加载到 textarea 的过程中出错的地方有点迷失。

我只是不知道如何将输入从 textarea 传递到数据库。任何帮助都会很棒，因为我已经为此工作了很长时间并且无法弄清楚。如果您需要更多信息，请告诉我，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T02:46:28.253

是的，您将需要`InformationAction`或`InformationContoller`取决于您要使用的 Web 框架。您的操作或控制器需要具有`description`映射到文本区域值的属性。如果你使用像 Struts2 或 Spring MVC 这样的 web 框架，这很容易实现。

现在进入休眠部分。您的操作需要具有`Session`可以读取和写入数据库值的休眠对象。然后，您可以使用从前端获得的构造`Information`对象，然后在会话中调用方法。`description``saveOrUpdate()`

代码将是这样的

```
public class InformationAction {
    //Maps to text area value. Needs getter and setter
    private String description;

    //Inject session from hibernate configuration
    private Session session;

    public void someMethod() {
     Information information = new Information();
     information.setDescription(description);
     session.saveOrUpdate(information);
   }
} 
```

这将在您的信息表中保存一行。

# regex - 正则表达式匹配字符串但排除子字符串的实例

> ID：11940439
> 
> 赞同：0
> 
> 时间：2012-08-13T18:49:37.950
> 
> 标签：regex, string, substring

例如..

示例文本：`<tag>AandBandCandD</tag>`

我需要匹配发生在“和”的任何实例之间`tag>`并排除其中的所有内容，因此结果是：`</tag`

> “A B C D”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T18:53:34.017

我将分两步执行此操作：

*   首先提取标签的内容。
*   `and`接下来用空字符串替换所有出现的。

正则表达式不是任一步骤的正确工具：

*   第一步可以使用 HTML 解析器更好地实现。
*   第二步不需要正则表达式的复杂性。一个简单的字符串替换就可以了。

* * *

**更新**

如果您被迫使用*单个*正则表达式，那么这可能是不可能的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T19:16:38.083

无论如何，这是您可以尝试的。

```
(?<=<tag>)(?:((?!and).)+(?:and)?)*(?=</tag>) 
```

为便于阅读而分解：

```
(?<=
  <tag>
)
(?:
  (
    (?!
      and
    )
    .
  )+
  (?:and)?
)*
(?=
  </tag>
) 
```

我很确定这会产生与`and`s 之间的文本相等的匹配数。但是在不知道确切的正则表达式语言的情况下，有很多事情可以通过稍微不同来打破这一点。

# wolfram-mathematica - Mathematica 中的 Plotlegend 不适用于函数表

> ID：11940444
> 
> 赞同：1
> 
> 时间：2012-08-13T18:49:51.113
> 
> 标签：wolfram-mathematica, plot

我正在尝试使用 Mathematica v8 中的 PlotLegend 绘制带有图例的函数列表。作为一个简单的测试，说明我正在尝试做什么。

```
<<PlotLegends`
test = Table[f[x], {f, {Sin, Cos, Tan, Log, Exp}}]
Plot[test, {x, 0, 1}, PlotRange -> Full, Axes -> {True, False}, 
PlotStyle -> Thick, AxesOrigin -> {0, 0}, 
PlotLegend -> {"Sin", "Cos", "Tan", "Log", "Exp"}, 
LegendPosition -> {0, -0.5}, LegendShadow -> None] 
```

作为输出给出

```
{Sin[x], Cos[x], Tan[x], Log[x], E^x} 
```

![不正确的图例](../Images/e07ec74e67f7c3b04fc0ad637a964c45.png)

但是，如果我明确地将表格放在 Plot 命令中，我会得到正确的图例。

```
Plot[{Sin[x], Cos[x], Tan[x], Log[x], Exp[x]}, {x, 0, 1}, 
PlotRange -> Full, Axes -> {True, False}, PlotStyle -> Thick, 
AxesOrigin -> {0, 0}, 
PlotLegend -> {"Sin", "Cos", "Tan", "Log", "Exp"}, 
LegendPosition -> {0, -0.5}, LegendShadow -> None] 
```

![正确的图例](../Images/7e7f3eb65d0b8b6fbb1897237ed435c8.png)

对于我的实际应用程序，我将一个函数列表放在一个 Do 循环中，因此后一个 Plot 命令并不理想。

任何建议将不胜感激。

干杯，迈克

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-13T19:06:41.900

替换`Plot[test, ...]`为`Plot[Evaluate@test, ...]`。

问题是 Plot 采用未评估的第一个参数，并且仅在计算点时对其进行评估。因此，当它确定标签时，它只看到一个参数`test`，而不是列表，因此它只输出一个标签。`Evaluate@test`告诉 Mathematica`test`在将它传递给之前进行评估，`Plot`即使`Plot`被定义为不评估参数. 这样，Plot 会看到您存储的列表`test`并知道生成多个标签。

# c++ - 如何将 ASN1 NumericString 类型设置为 SubjectDN OID？

> ID：11940448
> 
> 赞同：3
> 
> 时间：2012-08-13T18:50:03.810
> 
> 标签：c++, encoding, cryptography, cryptoapi

`2.5.4.3=Name Surname, 1.2.300.38.22=12345678`我有一个工作程序，它使用 MS Crypto API从指定的 SubjectDN 字符串（例如：）生成 CSR 。我使用函数：[CertStrToName()](http://msdn.microsoft.com/en-us/library/windows/desktop/aa377160%28v=vs.85%29.aspx)对其进行编码，一切正常，除了一件事：所有 OID 值都是用 ASN1 type 创建的`PrintableString`。

有什么方法可以使 OID 1.2.300.38.22 类型为 1.2.300.38.22 `NumericString`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T12:20:08.000

所以，我找到了两种方法来解决这个问题： 1\. 以编程方式，使用函数[CryptEncodeObject()](http://msdn.microsoft.com/en-us/library/windows/desktop/aa382364%28v=vs.85%29.aspx) 2\. 我的密码提供程序支持一些特定的 oid，所以我可以将 CertStrToName 与它们一起使用，而无需接触代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-15T06:44:10.183

Microsoft 的 CertStrToName() 方法不符合 RFC 4514。它不将#-encodings 视为AttributeValue-encodings，而是将它们视为要在OctetStrings 中编码的值。这意味着并非所有专有名称都可以从 CertStrToName 方法生成 - 特别是您的名称无法生成。

~~可分辨名称的字符串表示来自[RFC 4514：可分辨名称的字符串表示](https://www.rfc-editor.org/rfc/rfc4514)。~~

在这里您可以看到，如果属性类型是点分十进制形式，您实际上应该将属性值编码为 a`#`后跟 ASN.1 AttributeValue 的十六进制 BER 编码。IE：

2.5.4.3=姓氏，1.2.300.38.22=#12083132333435363738

您还可以阅读[CertStrToName()](http://msdn.microsoft.com/en-us/library/windows/desktop/aa377160)的文档：

> 以数字符号 (#) 开头的值被视为 ASCII 十六进制并转换为 CERT_RDN_OCTET_STRING。嵌入的空白被忽略。例如，1.2.3 = # AB CD 01 与 1.2.3=#ABCD01 相同。

# java - 如何在Tomcat中更改根目录

> ID：11940453
> 
> 赞同：4
> 
> 时间：2012-08-13T18:50:20.837
> 
> 标签：java, tomcat, servlets, containers, web.xml

我的 webapps 目录中有一个名为 linkpointe 的 Web 应用程序。我想创建这个应用程序的两个实例，以便我可以运行不同的版本。但是，如果我将两个应用程序放在不同的目录中，它就不起作用 - 即

```
http://localhost:8080/firstApp/linkpointe
http://localhost:8080/secondApp/linkpointe 
```

此外，如果我将名称更改为例如 linkpointe1 和 linkpointe2 之类的名称，它仍然无法正常工作。

根需要完全是链接点才能使应用程序正常工作 - 即下面

```
//this works
http://localhost:8080/linkpointe 
```

如何让应用程序的两个实例在我的 Tomcat 容器上运行？有人可以告诉我如何修改应用程序的默认根目录并可能添加更多内容，例如 linkpointe1 和 linkpointe2 吗？感谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T01:21:27.867

Tomcat 的`appBase`目录并不意味着其中包含不是 webapps 的子目录，所以你不能只是这样做

```
mkdir webapps/fitstApp
cp linkpoint.war webapps/firstApp/linkpoint.war
mkdir webapps/secondApp
cp linkpointe.war webapps/secondApp 
```

相反，您需要有两个单独的部署。如果您需要一个必须命名为“linkpointe”的 webapp 的两个版本，那么您将需要有两个单独的虚拟主机（即两个单独的`<Host>`元素）。

幸运的是，每个虚拟主机都有自己的 appBase，因此您可以将 linkpointe.war 复制到这两者中，您应该已经准备好了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T19:26:06.053

创建两个war文件怎么样？（linkpointe1.war 和linkpointe2.war） 将war 文件复制到您的webapps 目录并让tomcat 部署。

你应该在你的 webapps 目录下得到目录，例如

```
webapps/linkpointe1
webapps/linkpointe2 
```

然后您的网址将是

```
http://localhost:8080/linkpointe1
http://localhost:8080/linkpointe2 
```

如果由于应用程序内的依赖性而需要完全是链接点，那么两个虚拟主机应该像@christopher 在他的回答中所说的那样工作。

# c++ - 如何通过以太网插座从相机捕获视频

> ID：11940459
> 
> 赞同：0
> 
> 时间：2012-08-13T18:50:53.753
> 
> 标签：c++, qt

我需要从插入我的 PC 以太网插座的实时摄像头捕捉视频。我首先使用 Phonon 从系统中的文件中捕获视频。它工作正常。然后，我创建了一个套接字来读取视频。在这里，我不知道如何获取缓冲数据并将其设置为我的声子视频的源！如果有人能帮我解决这个问题，我会很感激。

这是阅读视频的代码：

```
void PlayVideo::rollOn()
   {
   media = new Phonon::MediaObject(movieLabel);
   media->setCurrentSource(Phonon::MediaSource(QString("/home/saman/4.7/phonon_test/sample.mp4")));
   videoPlayer = new Phonon::VideoPlayer(Phonon::VideoCategory, movieLabel);
   videoPlayer->setFixedSize(QSize(400, 300));
   videoPlayer->show();
   connect(videoPlayer, SIGNAL(finished()), videoPlayer, SLOT(deleteLater()));
   videoPlayer->play(media->currentSource());
   } 
```

这就是我在代码中添加套接字的方式：

```
 void PlayVideo::rollOn()
   {
   udpSocketin = new QUdpSocket(this);
   udpSocketin->bind(localPort);
   connect(udpSocketin, SIGNAL(readyRead()),this, SLOT(readDatagrams()));
   QDataStream out(&datagramout, QIODevice::WriteOnly);
   out.setVersion (QDataStream::Qt_4_7);
   timer2 = new QTimer(this);
   connect(timer2, SIGNAL(timeout()), this, SLOT(playbuff()));
   media = new Phonon::MediaObject(movieLabel);
   media->setCurrentSource(Phonon::MediaSource(QString("/home/saman/4.7/phonon_test/sample.mp4")));

   //media->setCurrentSource (Phonon::MediaSource());
   videoPlayer = new Phonon::VideoPlayer(Phonon::VideoCategory, movieLabel);     
   videoPlayer->setFixedSize(QSize(400, 300));     
   videoPlayer->show();     
   connect(videoPlayer, SIGNAL(finished()), videoPlayer, SLOT(deleteLater()));     
   videoPlayer->play(media->currentSource());
   }    
   void PlayVideo::readDatagrams()
   {
   if(udpSocketin->hasPendingDatagrams ())
   {
   datagramin.resize (udpSocketin->pendingDatagramSize ());
   qint64 receiveBytes = udpSocketin->readDatagram (datagramin.data (), datagramin.size ));
   if(receivedBytes <= 0)
   {
   qDebug("receivedBytes <= 0");
   } 
```

} }

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T07:41:55.403

您可以将数据放入 中`QBuffer`，它是 的子类`QIODevice`。然后，有一个接受`QIODevice`.

# c++ - 通过变量值访问结构属性

> ID：11940464
> 
> 赞同：7
> 
> 时间：2012-08-13T18:51:29.433
> 
> 标签：c++, struct, getter-setter

我的班级中有一个结构“margin”，有4个属性。与其编写四种不同的 getter/setter 方法，我想我可以用更好的方式来做到这一点：

```
class myClass {
    private:
        struct margin {
            int bottom;
            int left;
            int right;
            int top;
        }
    public:
        struct getMargin();
        void setMargin(string which, int value);
}; 
```

但是我怎样才能在函数中设置与字符串“which”对应的结构的属性`setMargin()`呢？例如，如果我调用`myClass::setMargin("left", 3)`，我该如何将“margin.left”设置为“3”？最好在保持 struct [POD](https://stackoverflow.com/questions/146452/what-are-pod-types-in-c)的同时？这个我真的想不通...

顺便说一句，这真的比编写许多 getter/setter 方法更好吗？

谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-13T18:55:09.420

首先，你的想法很糟糕...... :)

请注意，您甚至没有`margin`会员（在下面添加）

`enum`如果您不想为每个属性设置设置器/获取器，我会为此使用：

```
class myClass {
    private:
        struct margin {
            int bottom;
            int left;
            int right;
            int top;
        } m;  // <--- note member variable
    public:
        enum Side
        {
           bottom, left, rigth, top
        };
        struct getMargin();
        void setMargin(Side which, int value);
}; 
```

并在里面有一个`switch`声明`setMargin`。

```
void myClass::setMargin(Side which, int value)
{
    switch (which)
    {
        case bottom:
           m.bottom = value;
           break;
    //....
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-13T19:05:32.807

```
class myClass {
private:
    int margin[4];
public:
    enum Side
    {
       bottom, left, rigth, top
    };
    void setMargin(Side which, int value);
};

void myClass::setMargin(Side which, int value)
{
    margin[which]=value;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-13T19:23:14.743

Luchian 或 Gir 的建议都是我的偏好。但是，如果您确实~~需要~~通过字符串进行查找，最好使用关联容器来执行此操作。

```
class MyClass {
    std::map<std::string, int> m_;
public:
    bool setMargin(std::string which, int value) {
        std::map<std::string, int>::iterator i = m_.find(which);
        if (i == m_.end()) return false;
        i->second = value;
        return true;
    }
}; 
```

仅当您有一个允许用户按名称定义自己的边距的动态界面时，这才有用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-13T18:57:20.437

您可以使用**“相对指针”**，它指向从结构地址到指向特殊元素的距离。例如：

```
SetMargin(FIRST,5); 
```

其中 FIRST 来自枚举值并且为 0。

```
SetMargin(SECOND,100); 
```

SECOND 是 4，因为 int 在我的系统中是 4 个字节

执行：

```
void SetMargin(enum margin_elements,int a)
{
    int *relative=struct_pointer+(int*)margin_elements;
    *relative_pointer=a;
     return;
 } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-13T18:58:27.867

如果您可以公开保证金，则可以摆脱 get,set 方法：

```
class myClass {
    public:
        struct Margin {
            int bottom;
            int left;
            int right;
            int top;
        };
        Margin margin;
};

myClass mc;

mc.margin.bottom = mc.margin.left; 
```

# tsql - T-SQL 查询，连接两个表，但只返回表 1 中第二个表中 1 行的数据

> ID：11940466
> 
> 赞同：2
> 
> 时间：2012-08-13T18:51:39.767
> 
> 标签：tsql, sql-server-2008-r2

好的，很难在一个主题行中描述我需​​要从 SQL 中得到什么。我希望这个话题不会让太多人失望……

我有两张表，一张有船舶 ID、跟踪号和运费。

```
Declare @ship as table
(
    shipID varChar(25),
    TrkID VarChar(50),
    shp_Cost money
)

Insert into @ship Values('1000000058','075637240645964',13.1900)
Insert into @ship Values('1000000077','075637240646671',10.3300)
Insert into @ship Values('1000000078','075637240646695',12.8300)
Insert into @ship Values('1000000079','075637240646725',11.2100) 
```

这具有 1:Many 关系，其中这是一个单次装运，但其中可能包含许多行项目。第二个表有订单项，出于演示原因，它看起来像这样......

```
Declare @ship_2 as table
(
    shipID VarChar(25),
    trkID VarChar(50),
    Item_SKU VarChar(50),
    Ship_Quantity int
)

Insert into @ship_2 Values('1000000058','075637240645964','P025.3',25)
Insert into @ship_2 Values('1000000058','075637240645964','P100.1',25)
Insert into @ship_2 Values('1000000058','075637240645964','P21.1',25)
Insert into @ship_2 Values('1000000058','075637240645964','P024',25)
Insert into @ship_2 Values('1000000058','075637240645964','A-P927',25)
Insert into @ship_2 Values('1000000058','075637240645964','PBC',500)
Insert into @ship_2 Values('1000000077','075637240646671','P213.99',25)
Insert into @ship_2 Values('1000000077','075637240646671','P029',25)
Insert into @ship_2 Values('1000000077','075637240646671','P-05.3',25)
Insert into @ship_2 Values('1000000078','075637240646695','P0006.1',25)
Insert into @ship_2 Values('1000000078','075637240646695','P01.67-US',25)
Insert into @ship_2 Values('1000000078','075637240646695','P09.1',25)
Insert into @ship_2 Values('1000000078','075637240646695','P022.1',25)
Insert into @ship_2 Values('1000000078','075637240646695','P08.3',25)
Insert into @ship_2 Values('1000000079','075637240646725','P02',25)
Insert into @ship_2 Values('1000000079','075637240646725','P0006.1',25)
Insert into @ship_2 Values('1000000079','075637240646725','P1.4',25) 
```

所以我需要一种方法来连接这两个表并提供运输详细信息以将运输成本包含在一个结果集中。除非您认为只有一个行项目应承担运输成本，否则这并不是真正的问题。如果有 6 个行项目，我只需要返回第一个行项目的运费和其余 5 行的 0。

我目前完全不知道如何做到这一点。它将全部存储在存储过程中，我可以根据需要创建临时表或声明表。

任何人都对我需要寻找什么有建议。

感谢您提供的任何帮助我们的指导。

蒂姆

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T18:59:36.070

为什么不为此使用 CTE：

```
;with cte as
(
    select s.shipID, 
        s.TrkID, 
        s.shp_Cost, 
        s2.Item_SKU, 
        s2.Ship_Quantity, 
        ROW_NUMBER() over(PARTITION by s.shipid order by s.shipid) rn
    from @ship s
    inner join @ship_2 s2
        on s.shipID = s2.shipID
)
select shipID, 
    TrkID, 
    case when rn = 1 then shp_Cost else 0 end shp_cost,
    Item_SKU,
    Ship_Quantity
from cte 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/c8296/1)

# java - 如何将多个参数从视图传递到控制器的方法

> ID：11940470
> 
> 赞同：1
> 
> 时间：2012-08-13T18:52:17.927
> 
> 标签：java, jsp, spring-mvc

你能告诉我如何以最方便的方式将视图中的几个参数传递给控制器​​的函数吗？

JSP 视图：

```
<h2>${topic.getName()}</h2>
<h3>${topic.getText()}</h2>

<form:form method="post" commandName="newComment">
    <fieldset>
        <div class="editor-label">
            <td><form:label path="text">Input comment</form:label></td>
        </div>

        <div class="textarea">
            <form:textarea path="text" />
        </div>

        <p>
            <input type="submit" value="Comment" />
        </p>
    </fieldset>
</form:form> 
```

如您所见，我们有**topic**和**newComent**属性，它们代表主题和评论实体。
这是一个控制器：

```
@RequestMapping(value = "/addComment/{topicId}", method = RequestMethod.POST)
public String saveComment(@ModelAttribute("newComment")Comment comment, BindingResult result, Model model){

    validate(comment, result);
    if (result.hasErrors() )
        {
            return "//";
        }
        return "redirect:details/";
    }
} 
```

**评论**实体被识别得很好，但我也需要一个主题对象（或它的 ID）的实例。可以在视图中访问主题对象的实例，并且主题 ID 是响应的一部分。你能给我一个想法，我该如何处理这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T18:58:52.963

如果你有，你能得到主题模型`topicId`吗？它在你的路上。您可以通过`@PathVariable`在方法参数中添加注释来获取它。

```
public String saveComment(@PathVariable String topicId, @ModelAttribute("newComment")Comment comment, BindingResult result, Model model){ 
```

# ios - ios - 通过情节提要的 UITabBar 图像

> ID：11940471
> 
> 赞同：0
> 
> 时间：2012-08-13T18:52:23.177
> 
> 标签：ios, ios5, uitabbarcontroller, uitabbar

我有一张我已经通过代码使用我的应用程序的图像：

```
UIImage *image = [[UIImage alloc] initWithContentsOfFile:[[NSBundle mainBundle] pathForResource:@"building" ofType:@"png"]];
self.view.backgroundColor = [UIColor colorWithPatternImage:image]; 
```

我想在 UITabBar 中重用该图像。UITabBar 图像的属性检查器上有一个图像字段，当我在其中添加图像名称（building 或 building.png）时，图像不会呈现，但会呈现图像轮廓。

有谁知道为什么会发生这种情况以及如何让实际图像渲染？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T19:13:07.007

我猜你在这里使用了一个相当小的图像作为形成颜色的图案。对于 UITabBar，您需要具有适当大小的图像。UITabBar 和其他许多人一样知道修改 UI 元素的外观方法。在文档中查找 UIAppearance 以获取更多信息。就您的问题而言，请查看 UITabBarItem 下的 setFinishedSelectedImage:withFinishedUnselectedImage。

# php - Google Auth 1.0 未经授权访问 gmail

> ID：11940475
> 
> 赞同：0
> 
> 时间：2012-08-13T18:52:32.953
> 
> 标签：php, oauth, gmail, google-apps

我为我的域创建了谷歌应用程序，它也有一些电子邮件地址，所以我要去那里访问收件箱电子邮件计数 uisng 身份验证令牌和消费者秘密。

问题是我成功获得了 oauth_token_secret 和 oauth_token 和 oauth_callback_confirmed

```
oauth_token={OAUTH_TOKEN}&oauth_token_secret={OAUTH_TOKEN_SECRET}&oauth_callback_confirmed=true 
```

但是当我尝试使用上述令牌访问 gmail 时，它会出现错误

```
Warning: file_get_contents(https://mail.google.com/mail/feed/atom/?oauth_token={OAUTH_TOKEN}&oauth_token_secret={OAUTH_TOKEN_SECRET}&oauth_callback_confirmed=true&max-results=100)
[function.file-get-contents]: failed to open stream: HTTP request failed!
HTTP/1.0 401 Unauthorized in /hermes/bosoraweb022/b1554/ipg.webxtreamsnet/freelancer/auth2.php on line 85 
```

这是我的代码

```
<?php

$consumer = 'www.artbymargaret.co.uk';
$secret = '{CLIENT_SECRET}';
$callback = '';
$sign_method = 'HMAC-SHA1';
$version = '1.0';
$scope = 'https://mail.google.com/mail/feed/atom';

function urlencodeRFC3986($string)
{
   return str_replace('%7E', '~', rawurlencode($string));
}

$mt = microtime();
$rand = mt_rand();
$nonce = md5($mt.$rand);
$time = time();

$url = 'https://www.google.com/accounts/OAuthGetRequestToken';
$path = '/accounts/OAuthGetRequestToken';

$post = array(
    'oauth_callback' => urlencodeRFC3986($callback),
    'oauth_consumer_key' => $consumer,
    'oauth_nonce' => $nonce,
    'oauth_signature_method' => $sign_method,
    'oauth_timestamp' => $time,
    'oauth_version' => $version,
    'scope' => urlencodeRFC3986($scope)
);

$post_string = '';
foreach($post as $key => $value)
{
    $post_string .= $key.'='.($value).'&';
}
$post_string = rtrim($post_string, '&');

$key_parts = array($secret);

$key_parts = urlencodeRFC3986($secret);
//$key = implode('&', $key_parts);
$key = $key_parts.'&';
$base_string = 'GET&'.urlencodeRFC3986($url).'&'.urlencodeRFC3986($post_string);
$signature = base64_encode(hash_hmac('sha1', $base_string, $key, true));

$post = array(
    'oauth_version' => $version,
    'oauth_nonce' => $nonce,
    'oauth_timestamp' => $time,
    'oauth_consumer_key' => $consumer,
    'oauth_callback' => $callback,
    'oauth_signature_method' => $sign_method,
    'oauth_signature' => $signature
);        

$header_string = '';
foreach($post as $key => $value)
{
    $header_string .= $key.'="'.urlencodeRFC3986($value).'", ';
}

$header_string = trim($header_string);
$header_string = rtrim($header_string, ',');

$header[] = 'GET '.$path.'?scope='.urlencodeRFC3986($scope).' HTTP/1.1';
$header[] = 'Host: www.google.com';
$header[] = 'Accept: */*';
//$header[] = 'Content-Type: application/x-www-form-urlencoded';
$header[] = 'Authorization: OAuth '.$header_string;

$ch = curl_init();
curl_setopt($ch, CURLOPT_HTTPHEADER, $header);
curl_setopt($ch, CURLOPT_URL, $url.'?scope='.$scope);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_FOLLOWLOCATION, true);
$result = curl_exec($ch);
curl_close($ch);
echo $result;

 $xmlresponse= file_get_contents("https://mail.google.com/mail/feed/atom/?".$result."&mail=jane@funtastic.uk.com&max-results=100");
    print_r($out);

//die(); 
```

任何人都知道硬件使用 auth 1x 版本和 php 访问 gmail 收件箱提要，或者我的客户端有任何错误

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T23:01:51.110

您向 API 端点发出的实际请求仅使用`file_get_contents`和查询参数。使用 OAuth 1.0，您需要正确签署此请求，并传入 Authorization 标头。您可能希望使用上面使用的相同 curl 代码来执行此操作。

OAuth 1.0 对最终用户授予的授权有 3 个步骤：

1.  应用服务器对 OAuth 请求令牌发出服务器到服务器请求。
2.  应用服务器将用户重定向到端点以授权该令牌。他们批准请求，并被重定向回应用服务器。
3.  然后，应用服务器将授权的请求令牌交换为访问令牌。

完成这些步骤后，访问令牌将用于对 API 提供者的 OAuth 请求进行签名。签名很关键——访问令牌不像 OAuth 2.0 中那样用作“承载令牌”。

有关标准 OAuth 1.0 机制的更多信息： [https ://developers.google.com/accounts/docs/OAuth_ref#SigningOAuth](https://developers.google.com/accounts/docs/OAuth_ref#SigningOAuth)

如果您只是尝试在没有任何最终用户批准的情况下发出服务器到服务器的请求，您可以对您控制的 Google Apps 域执行此操作。这不需要请求令牌、访问令牌等——只需要您的消费者密钥+秘密。以下是有关用于发出 API 请求的 2-legged OAuth 1.0 机制的更多信息： [https ://developers.google.com/accounts/docs/OAuth#AccessFeed](https://developers.google.com/accounts/docs/OAuth#AccessFeed)

绝对同意升级到 OAuth 2.0 :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T19:09:49.317

根据[Google OAuth 1.0 for Apps](https://developers.google.com/accounts/docs/OAuth#tokensGADomains)的文档，您是否使用该`hd`参数？

此外，OAuth 1.0 自 2012 年 4 月起已弃用。

# sql-server - 尝试从 Select 创建表 - Sql Server 2008 抛出错误

> ID：11940477
> 
> 赞同：2
> 
> 时间：2012-08-13T18:52:39.813
> 
> 标签：sql-server, sql-server-2008, create-table

您好我正在尝试使用内部选择语句创建一个表...

例如：

```
CREATE TABLE JmxMonSer AS (SELECT * FROM services WHERE monitoring_enabled = 1); 
```

但不断收到错误：

> *关键字“AS”附近的语法不正确，严重性 15*

请指教

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-13T18:55:42.203

我几乎可以肯定 SQL Server 没有`CREATE TABLE AS (SELECT...`语法，但您可以使用`SELECT INTO`：

```
SELECT * 
INTO JmxMonSer
FROM services 
WHERE monitoring_enabled=1 
```

检查[MSDN 文档](http://msdn.microsoft.com/en-us/library/aa258255%28v=sql.80%29.aspx)`CREATE TABLE`以了解该语句的正确用法。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-08-13T18:54:52.623

怎么样：

```
SELECT * into JmxMonSer FROM services WHERE monitoring_enabled=1 
```

如果表已经存在（并且列类型和排序排列），您可以使用：

```
INSERT INTO JmxMonSer SELECT * FROM services WHERE monitoring_enabled=1 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-06-16T09:21:45.313

以下语法用于使用子查询而不是使用静态表名......因为有时所需的结果集来自不同的查询......

```
SELECT * 
INTO JmxMonSer
From (SELECT * FROM services WHERE monitoring_enabled = 1) as X 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-08-13T00:17:17.763

尝试使用`SELECT INTO`：

```
SELECT *
INTO newtable [IN externaldb]
FROM table1; 
```

来源：http : [//www.w3schools.com/sql/sql_select_into.asp](http://www.w3schools.com/sql/sql_select_into.asp)

# magento - 自定义/更好的 magento 产品登陆页面

> ID：11940482
> 
> 赞同：0
> 
> 时间：2012-08-13T18:52:58.820
> 
> 标签：magento

我尝试并搜索了一些 Stackoverflow 问题和答案，但仍然无法找到我的答案。我希望这很简单，但不是我会尝试任何一种方式。是否有扩展或者我可以在 magento 中设置与此类似的产品登录页面？它们看起来非常漂亮，并且想在我的 magento 网站上做类似的事情。

此处示例：http: [//gearx.com/snow-sports](http://gearx.com/snow-sports)

任何帮助或指导都会很棒！

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T15:35:59.677

这正是我一直在寻找的：http: [//www.demacmedia.com/ecommerce/mini-tutorial-how-to-add-a-category-landing-page/](http://www.demacmedia.com/ecommerce/mini-tutorial-how-to-add-a-category-landing-page/)

现在我只是想真正让它发挥作用。

# objective-c - 为什么 rangeOfString 不再适用于 if 语句仅适用于 5.1 模拟器

> ID：11940484
> 
> 赞同：0
> 
> 时间：2012-08-13T18:53:04.470
> 
> 标签：objective-c, ios, if-statement

为什么这在 5.1 模拟器中不起作用，但在 4.2 4.3 5.0 中起作用？

OSXLion 10.7.4 XCode 4.3.3

```
 if ([email.text rangeOfString:@"@"].location == NSNotFound) {

    UIAlertView *alert =[[UIAlertView alloc] initWithTitle:@"Email" message:@"Please provide email address" delegate:nil cancelButtonTitle:@"Cool" otherButtonTitles:nil];
    [alert show];

}
else {
    work...work...work... 
```

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T20:39:29.403

如果您已确认电子邮件地址不包含 ，`@`那么听起来模拟器可能正在运行您的代码的旧版本。我建议清理您的项目并[重置](http://developer.apple.com/library/ios/#DOCUMENTATION/Xcode/Conceptual/ios_development_workflow/25-Using_iOS_Simulator/ios_simulator_application.html)模拟器的内容和设置。要重置模拟器，虽然它是最前面打开的应用程序，请选择*iOS Simulator* **>** *Reset Content and Settings*。

# javascript - html span id 作为 javascript 函数参数

> ID：11940485
> 
> 赞同：0
> 
> 时间：2012-08-13T18:53:14.067
> 
> 标签：javascript, html, formatting, arguments, zclip

我正在尝试创建到剪贴板 IE javascript 函数的副本，但我的代码不起作用。我应该如何格式化我的参数并传递参数？

```
/*invisible storage*/
<textarea id="storageBox" STYLE="display:none;">
</textarea>

<p id="abc">I WANT TO COPY THIS TEXT</p>

<button onClick="Copy(abc);">Copy</button><br />

<script type="text/javascript">
function Copy(txt) {
storageBox.innerText = txt.innerText;
Copied = storageBox.createTextRange();
Copied.execCommand("RemoveFormat");
Copied.execCommand("Copy");
}
</script> 
```

任何可以使用 zclip 编写此内容或向我展示类似示例的人的主要业力！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T18:57:46.553

以下更改应该会有所帮助：

```
... onclick="Copy('abc');"...

storageBox.value = document.getElementById(txt).innerText 
```

我认为。您并没有具体说明什么不起作用，甚至出于什么原因试图劫持剪贴板（如果用户在那里有重要的东西怎么办？）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T18:58:12.967

首先，您需要将参数作为字符串传递：

```
<button onClick="Copy('abc');">Copy</button><br /> 
```

在您的函数中，您需要根据此 ID（作为字符串）从 DOM 中获取元素：

```
function Copy(txt) {
   storageBox.innerText = document.getElementById(txt).innerText;
   ... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T19:25:19.813

尽管我评论您的脚本运行良好，但`HTML`. 如果设置`display: none`，`execCommand()`则无法复制内容。所以你需要这样做：

```
<textarea id="storageBox" style="width: 0px; height: 0px; border: 0px;"></textarea> 
```

# python - 我可以在不阻塞执行主线程的情况下以编程方式启动 WSGI 应用程序服务器吗？

> ID：11940492
> 
> 赞同：4
> 
> 时间：2012-08-13T18:53:54.233
> 
> 标签：python, testing, wsgi

我正在用 python 编写一个 Web 应用程序，并使用带有[splinter的](http://splinter.readthedocs.org/en/0.0.3/)[生菜](http://packages.python.org/lettuce/tutorial/simple.html)来为其编写验收测试。

为此，我需要一个 wsgi 服务器在后台启动我的应用程序，以便该应用程序可用于我的测试套件。为此，我一直在另一个线程中启动一个女服务员服务器实例，以使浏览器连接到：

```
def setUp():
    base = os.path.dirname(__file__) + "/../../.."
    world.app = loadapp('config:test.ini', relative_to=base)
    world.server_thread = thread.start_new_thread(serve_app,  (world.app,))

def serve_app(app):
    serve(app, host='0.0.0.0', port=7654) 
```

这工作得很好 - 我的测试套件可以使用正在运行的应用程序实例来设置固定装置/模拟等，并且服务器可供我的测试连接到。但是，当测试完成时，我无法向服务器发送信号以彻底关闭自身。因此，无论如何，我是否可以以某种方式向`KeyboardInterrupt`我生成的服务器线程发送一个（这将被女服务员捕获并提示它干净地关闭），或者如果失败，是否存在一个暴露非阻塞的现有 wsgi 服务器实现`start()`和`stop()`我可以用来代替服务员的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T02:47:17.907

您不一定需要 WSGI 服务器来对 WSGI 应用程序进行单元测试，[例如](http://flask.pocoo.org/docs/testing/).

对于您的验收测试，您可以在单独的进程中启动服务器并在完成后发送 SIGINT。

如果您想坚持当前的设置；您可以在主线程中运行服务器，在后台线程中运行测试。然后你可以[将 KeyboardInterrupt 从 subthreads 发送到主线程](http://docs.python.org/library/thread.html#thread.interrupt_main)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T10:21:11.600

问题只是进程不会关闭吗？

自从我使用 Python 进行 Web 开发已经有一段时间了，所以我对这些库没有经验，但是如果关闭是问题，那么使用守护线程似乎是一个很好的场景。

这里提到：http: [//docs.python.org/library/threading.html](http://docs.python.org/library/threading.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-14T11:08:20.687

将运行 WSGI 服务器的线程标记为守护线程。这样，当您退出主线程时，它不会等待服务器正在运行的线程完成，而只会退出应用程序。

# javascript - JavaScript 使用随机数组

> ID：11940495
> 
> 赞同：3
> 
> 时间：2012-08-13T18:54:30.577
> 
> 标签：javascript, html

我一直在玩随机数组排列，想知道是否有办法从数组中只提取一次单词。所以每次你点击 changeWorld 按钮时，它都会从数组列表中随机抽取，直到所有单词只使用一次？

学习 JavaScript，所以我不需要任何人给我写代码，只是想朝着正确的方向前进并知道它是否可行。我找不到任何可以解决这个概念的东西。

```
<body>

<button id="change-world-btn">Change World</button>

Hello <span class="world-name">World!</span><br />

<script type="text/javascript">

var worlds = new Array ("Pluto", "Mars", "Saturn", "Jupiter", "Uranus");

function newWorld() {
    return worlds[Math.floor(Math.random() * worlds.length)];
}

elements = document.getElementsByTagName('span');

document.getElementById('change-world-btn').onclick = function() {
    world = newWorld();
    for(var i = 0, el; el = elements[i++];) {
        if(el.className == 'world-name') {
            el.innerHTML = world;
        }
    }
};
</script>       
</body> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-13T19:02:10.027

从数组中删除您使用过的单词：

```
function newWorld() {
  var index = Math.floor(Math.random() * worlds.length);
  var world = worlds[index];
  worlds.splice(index, 1);
  return world;
} 
```

您可能还想先检查数组是否为空。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-13T19:00:37.243

这听起来像是堆栈或队列的工作。您可以获取数组，随机播放以获得“随机性”，将数组中的每个元素推送到堆栈或队列中，然后每次用户单击您的按钮时弹出一个元素。编辑：这是一个堆栈的小例子。

```
var stack=new Array();
stack.push("A");
stack.push("B");
stack.push("C");
alert(stack.pop());
alert(stack.pop());
alert(stack.pop()); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-13T19:25:59.550

这很好用，当数组用完时有一个返回短语。

感谢所有的帮助。

```
<button id="change-world-btn">Change World</button>

Hello <span class="world-name">World!</span><br />

<script type="text/javascript">
   var worlds = new Array ("Pluto", "Mars", "Saturn", "Jupiter", "Uranus");

function newWorld() { 
var index = Math.floor(Math.random() * worlds.length); 
var world = worlds[index]; 
worlds.splice(index, 1); 
return world; 
} 

elements = document.getElementsByTagName('span');

document.getElementById('change-world-btn').onclick = function() {
    world = newWorld();
    if(worlds==""){ world="no more worlds"}
    for(var i = 0, el; el = elements[i++];) {
        if(el.className == 'world-name') {
            el.innerHTML = world;
        }
    }
};
    </script>       

</body> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-13T19:03:41.417

您可以使用以下命令从数组中删除单词[`splice`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/splice)：

```
function newWorld() {
    var i = Math.floor(Math.random() * worlds.length)
    return worlds.splice(i , 1)[0];
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-13T19:05:39.497

试试`splice`数组的方法。

演示在[http://jsfiddle.net/WKEC2/1/](http://jsfiddle.net/WKEC2/1/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-13T19:11:30.080

像 document.getElementById('change-world-btn').onclick 这样的东西不存在。你做了一些类似的事情并且在你的javascript中是这样的：

```
function getNewName(){
document.getElementById('yourelementid').innerHtml = newWorld();
} 
```

如果您想对所有元素进行此操作，请尝试以下操作：

```
document.getElementById('change-world-btn').onclick = function() {
world = newWorld();
for(var i = 0, i < elements.lenght; el = elements[i++];) {
    if(el.className == 'world-name') {
        el.innerHTML = world;
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-08-13T19:26:32.340

或者，您可以对数组进行随机排序，然后简单地循环遍历它：

```
// Math.random() returns a number between 0-1
// Math.round() rounds the number to either 0 or 1
// Subtracting 0.5 results in either +.5 or -.5
function randomSort(){
    return (Math.round(Math.random())-0.5);
}

var elements = document.getElementsByTagName('span');  
var worlds = new Array ("Pluto", "Mars", "Saturn", "Jupiter", "Uranus");

// sort the array
worlds.sort(randomSort);

document.getElementById('change-world-btn').onclick = function() {
    world = worlds.shift();
    //worlds.push(world); - add this line if you want to cycle the array indefinitely
    if(!world) { // check to make sure world exists
        alert('No more worlds!');
    } else {
        for(var i = 0, el; el = elements[i++];) {
            if(el.className == 'world-name') {
                el.innerHTML = world;
            }
        }
    }
}; 
```

[**jsFiddle 演示**](http://jsfiddle.net/HfzkU/)

# jquery - Jquery：在 Internet Explorer 7 中克隆和修改后选择字段无响应

> ID：11940496
> 
> 赞同：0
> 
> 时间：2012-08-13T18:54:30.937
> 
> 标签：jquery, html, internet-explorer-7

由于我已经在这里找到了几个问题的答案，我确信有人已经回答了以下问题。

我已经通过 Ajax 编写了一个选择框的更新程序。在 Internet Explorer 8+、Opera 和 Firefox 中一切正常。但是当我在开发工具 (F12) 中选择 Internet Explorer 7 或 Quirks 时，它无法正常工作。我连续有 3 个选择字段；选择第一个后填充最后两个。这行得通。

现在的问题：完整的行被克隆并随后添加，以便允许多项选择。对于第一行，它可以工作，但之后就不行了。

如果要更新第二个和第三个选择，它只会更新第一个 OPTION 条目，并且选择字段似乎有一个错误，因为它没有下拉.....我已经检查了有问题的 Pulldowns 是否具有正确的 HTML 内容我得到的 HTML 内容`jquery $().html()`正是函数更新选择字段后我想要的内容。

```
<div id="diagrammpreview" style="height:500px;width:500px;"></div>
<div id="d1">
<div id="diagramm1">
<select size="1" class="overviewtables" name="overviewtables"><option value="error">Bitte auswaehlen</option></select>
<select size="1" class="axis" name="axis1"><option value="error">Zuerst Tabelle auswaehlen</option></select>
<select size="1" class="axis" name="axis2"><option value="error">Zuerst Tabelle auswaehlen</option></select>
<input type="button" id="preview1" class="preview" name="preview1" value="Preview">
</div> 
```

这是被克隆的部分：

```
$('#adddiagramm').click(function(){$('#d1').children().last().after($('#diagramm1').clone())

function fillpulldown(val,text,j_pulldown,a)
{
 var newcontent="<option value=\"error\">"+"Bitte auswaehlen"+"</option>";
 for(i=0;i<=(val.length-1);i++)
 {

 if(val[i]=="timestamp"){}
     else
     {
        newcontent=newcontent+ "<option value=\""+val[i]+"\">"+text[i]+"</option>";
     }
 }
    alert(newcontent);
 j_pulldown.html(newcontent);
 alert(j_pulldown.parent().html());
 alert(j.pulldown.html());
} 
```

此功能填充下拉菜单。它有效，但 IE7 似乎无法`j_pulldown.html(newcontent)`正确解析该部分。问题仅在于克隆的内容。

# stress-testing - 使用wireshark数据包捕获模拟负载（不是HTTP）

> ID：11940500
> 
> 赞同：0
> 
> 时间：2012-08-13T18:54:59.100
> 
> 标签：stress-testing, traffic-simulation

我们的生产环境压力很大，以至于一些连接请求被丢弃。我们已将连接积压推至 100，但仍发现连接断开的一些问题（100 远远超过了我们认为由于配置而可能发生的情况）。

我想做的是获得一个大型的wireshark捕获，然后设置一台或多台可以播放该捕获的机器，以便我们可以在非生产环境中复制这种情况。现在我们似乎根本无法重现这个问题，我在想如果我们可以在我们的实验室中使用多台机器来测试真实的生产数据，我们也许能够“重放”数据包捕获。

问题是现在我没有时间编写播放工具，所以我希望有人知道已经有一个工具可以处理播放以及必须处理的数据包的点点滴滴更改为处理该问题（端口号等....）

Wireshark 不是必需的，只是想到的第一个工具，因为它们在机器连接的交换机中拥有它。

任何人都知道任何可以从数据包捕获中模拟网络流量的东西吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T13:20:44.603

你没有提到什么样的连接/流量，所以我现在假设 HTTP。

使用数据包捕获工具解决此问题的优点是您不需要了解流量模式，因为它会完全复制记录的传入网络流量。缺点是它将完全复制传入的网络流量:(您已经意识到其中一些东西可能需要不同的事实 - 但弄清楚数据包层的内容并进行更改，将会非常困难（取决于您需要建模的流量类型）。工作负载越复杂，复制它就越困难。如果它是一个半复杂的网络应用程序，您将面临一个艰巨的挑战。您需要的是负载测试工具。

如果负载主要是 Web 流量 (HTTP)，那么您有很多选择。我将提供我们的[Load Tester LITE](http://www.webperformance.com/load-testing/free-load-tester-lite.html)产品，它是免费的，可以为相对简单的工作负载生成大量负载（尽管名称如此）。

# javascript - 如何在three.js中制作礼品丝带

> ID：11940501
> 
> 赞同：0
> 
> 时间：2012-08-13T18:54:58.663
> 
> 标签：javascript, three.js

我想在three.js中为礼品盒（普通立方体几何）制作一条丝带，例如：

[http://1.bp.blogspot.com/_a1luqIHQT68/SVQ3aeo5SKI/AAAAAAAAAAk/SzCYXD9Df1Y/s400/Geschenk-neu.jpg](http://1.bp.blogspot.com/_a1luqIHQT68/SVQ3aeo5SKI/AAAAAAAAAAk/SzCYXD9Df1Y/s400/Geschenk-neu.jpg)

有没有一种方法可以做到这一点，是否可以只用一根丝带制作它，还是我需要多个丝带，加起来就是这么大？

谢谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T19:29:35.053

如果它只是为了展示并且您不需要以编程方式使用它，我建议从文件中加载预制的 blender/json 模型。

源码示例：[http ://stemkoski.github.com/Three.js/Model.html](http://stemkoski.github.com/Three.js/Model.html)

这里有一些免费模型： http: [//archive3d.net/?tag =present](http://archive3d.net/?tag=present)

# mysql - MySql - 重复键插入

> ID：11940506
> 
> 赞同：8
> 
> 时间：2012-08-13T18:55:33.147
> 
> 标签：mysql, sql, insert, on-duplicate-key

我知道存在`INSERT IGNORE`和`INSERT ... ON DUPLICATE KEY UPDATE`。但是，当有重复键时，我想`INSERT`对一个临时表做一个记录，以记录被违反的唯一键，以便我可以将其输出给用户。

有什么办法可以做`ON DUPLICATE INSERT`吗？如果有帮助，我正在尝试进行批量插入。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-13T19:07:55.930

使用`ON DUPLICATE KEY UPDATE`，您不能插入到另一个表中 - 也没有可用的替代函数。

您可以通过两种自定义/替代方法来完成此操作：

1.  使用[`stored procedure`](http://dev.mysql.com/doc/refman/5.0/en/stored-routines.html)该问题的已接受答案中概述的：[MySQL ON DUPLICATE KEY insert into an audit or log table](https://stackoverflow.com/questions/3884344/mysql-on-duplicate-key-insert-into-an-audit-or-log-table)

2.  创建一个[`trigger`](http://dev.mysql.com/doc//refman/5.0/en/create-trigger.html)将每个`INSERT`表记录到另一个表中并查询充满“日志”的表以查找任何重复项。

与此类似的东西应该可以工作：

```
CREATE TABLE insert_logs (
    id int not null
);

delimiter |
CREATE TRIGGER insert_logs_trigger BEFORE INSERT ON your_table
    FOR EACH ROW BEGIN
        INSERT INTO insert_logs SET id = NEW.id;
    END;
| 
```

要获取表中重复项的列表，您可以：

```
SELECT id FROM insert_logs HAVING COUNT(id) > 1 GROUP BY id; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-02-08T00:20:17.893

也许这可能会有所帮助：

```
$time = time();
$countme = 1;
while ($countme > 0) {
    $stmt = $mysqli->prepare("INSERT INTO loads (dte,filecode,id,acct,nmbr) VALUES (?,?,?,?,?) ON DUPLICATE KEY UPDATE dte = dte");
    $stmt->bind_param("sssss", $time, $filecode, $id, $acct, $number);
    $stmt->execute();
    $countme++;
    if ($stmt->affected_rows === 1) {
        $countme = 0; // all is good
    } else {
        $time = $time + 1;
    }
    if ($countme === 4) {
        exit;
    }
} 
```

# php - Javascript onclick html字段值无需编辑.js文件

> ID：11940507
> 
> 赞同：0
> 
> 时间：2012-08-13T18:55:34.200
> 
> 标签：php, javascript, html, css

```
<input type="text" 
       name='username'  
       onblur="if(this.value=='')this.value='Username';" 
       onfocus="if(this.value=='Username')this.value='';"
       value="Username" 
       class="register"/> 
```

这是我正在使用的代码，但是我的代码设置方式我希望在用户输入他们的信息之前在字段中可以查看文本，但是现在设置表单的方式是

```
value="<?php echo $db_first_name; ?>" 
```

但我正在使用的代码需要

```
value="Username" 
```

在用户单击之前在字段中显示用户名并输入他们自己的信息。

我试过

```
value="Username<?php echo $db_first_name; ?>" 
```

但显然这不起作用。有任何想法吗？

查看表单功能的链接：http: [//odconnect.com/beta/registration2.php](http://odconnect.com/beta/registration2.php)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-13T18:59:51.207

试试这个`placeholder`属性（从 HTML5 开始有效）：

```
<input type="text" name="username" id="username" placeholder="Username" value="<?= $db_first_name; ?>" /> 
```

或者（换句话说，如果您想支持其浏览器不支持 HTML5 的用户），您可以测试该用户是否已经输入了用户名。如果是`null`或空字符串，则将值设置为“用户名”，否则，将值设置为 的值`$db_first_name`。然后更改 onBlur 事件以检查字段值的长度，如果长度为零，则显示“用户名”。最后，更改 onFocus 事件以侦听鼠标单击 - 当用户将焦点放在字段上时，将值设置为空字符串。

```
<input type="text" name="username" id="username" value="<?= $db_first_name == "" ? "Username" : $db_first_name ?>" onBlur="checkUsernameBlur(this, 'Username');" onFocus="checkUsernameFocus(this, 'Username');" />

<script type="text/javascript" language="javascript>
    function checkUsernameBlur(inputObj, label) {
        var strLen = inputObj.value.length;
        if (strLen == 0) {
            inputObj.value = label;
        }
    }

    function checkUsernameFocus(inputObj, label) {
        var value = inputObj.value;
        if (value == label) {
            inputObj.value = "";
        }
    }
</script> 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-13T19:13:58.837

要在较低的 html 版本中工作，不仅要在 html5 中将所有三个位置的用户名文本更改**为**想要的单词或 php 变量

```
<input type="text"  name='username'  name='username' onblur="if(this.value=='')this.value='<?php echo $db_first_name; ?>';" onfocus="if(this.value=='<?php echo $db_first_name; ?>')this.value='';" value="<?php echo $db_first_name; ?>" class="register"/> 
```

# regex - Perl 正则表达式与 grep 获取子字符串

> ID：11940509
> 
> 赞同：0
> 
> 时间：2012-08-13T18:55:39.553
> 
> 标签：regex, perl, grep

```
4:46:31.232 AM  INFO    2012-08-13 04:46:31,232 [81-Spl/[1406]/[]]  - Adj Quantity Exceeds Paramaters. CFE 370 880N EMP NF 201209 -100 ADJOI 
```

我需要从 Adj 到 ADJOI 得到任何东西。“调整数量超过参数。” 是恒定的。后面的事情总是变的。

我知道如何使用 awk 做到这一点`awk '{ idx=index($0,"Adj"); print substr($0,idx); }'`

Perl 正则表达式会很好。但不确定如何使用带有 -P 选项的 grep 执行此操作

我尝试了以下方法，但它不起作用`grep -Po "'\KAdj.*?(?=')"`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T19:03:29.253

可能是我不明白问题，但`grep -oP 'Adj.*'`给了我完全相同的结果`awk '{ idx=index($0,"Adj"); print substr($0,idx); }'`

# mysql - MySQL Group by UserID 只显示最后一篇文章？

> ID：11940511
> 
> 赞同：0
> 
> 时间：2012-08-13T18:55:41.970
> 
> 标签：mysql

我正在尝试显示每个用户的最新帖子列表。但是，如果我按 ID 分组，我会得到第一个帖子而不是最后一个帖子。如何按 UID 分组并仅显示最大的行`Date`？

这就是我现在正在尝试的：

```
SELECT * FROM Posts GROUP BY `UID` ORDER BY `Date` DESC 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T19:00:09.317

因为您想要`Date`每个用户最大，您可以使用 MySQL 的`MAX()`：

```
SELECT MAX(`Date`), * FROM Posts GROUP BY `UID` 
```

您也可以在`HAVING`子句中指定它：

```
SELECT * 
FROM Posts
GROUP BY `UID`
HAVING `Date` = MAX(`Date`)
ORDER BY `Date` DESC 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T18:59:06.647

您可以使用连接来执行此操作，以获取最大日期，然后仅选择这些记录：

```
select p.*
from posts p join
     (select uid, max(date) as maxdate
      from posts p
      group by uid
     ) pmax
     on p.uid = pmax.uid and
        p.date = pmax.maxdate 
```

# jaxb - docx4j 报告未更改的表数据的差异

> ID：11940513
> 
> 赞同：1
> 
> 时间：2012-08-13T18:55:47.770
> 
> 标签：jaxb, docx4j

我创建了一个带有 2x2 表格的 *.docx 文件，每个单元格都包含= 行号和= 列号`Cell x-y`的文本。`x``y`

当我通过一个简单的转换过程传递这个文档时，docx4j 的`Differencer.diff()`方法报告没有差异（即没有`w:ins`或`w:del`标记）。

尽管 .docx 在`<w:tc> -> <w:p>`标签内将原始文档的文本像这样分解，但这是可以预料到的并且处理得非常干净：

```
<w:r>
  <w:t>单元格</w:t>
</w:r>
<w:r>
  <w:t xml:space="preserve"> 1-1</w:t>
</w:r>

```

这在转换后的文档中：

```
<w:r>
  <w:t xml:space="preserve">单元格 1-1</w:t>
</w:r>

```

但是，如果我在文档中的表格上方添加文本“表格标题”，则原始文档的内容（Word 的处理，我对此无能为力）单元格合并为一个`<w:r>`：

```
<w:r>
  <w:t>1-1 单元格</w:t>
</w:r>

```

转换后的文档的唯一区别`xml:space="preserve"`是插入：

```
<w:r>
  <w:t xml:space="preserve">单元格 1-1</w:t>
</w:r>

```

*但是*，docx4j 的`Differencer.diff()`方法现在报告每个单元格的内容已插入，并在生成的 diff 文档中显示以下内容作为每个单元格的`w:tc`内容`w:p`：

```
<w:ins xmlns:xalan="http://xml.apache.org/xalan" xmlns:pkg="http://schemas.microsoft.com/office/2006/xmlPackage" w:date="2009-03 -11T17:57:00Z" w:author="someone" w:id="1">
  <w:r>
    <w:t xml:space="preserve">单元格 1-1</w:t>
  </w:r>
</w:ins>

```

并将每个单元格的内容显示为已删除，紧跟在结束`<w:tbl>`标记之后：

```
    <!--处理简单的删除 w:p-->
    <w:p xmlns:xalan="http://xml.apache.org/xalan" xmlns:pkg="http://schemas.microsoft.com/office/2006/xmlPackage">
        <w:del w:date="2009-03-11T17:57:00Z" w:author="someone" w:id="5">
            <w:r>
                <w:delText>单元格 1-1
            </w:r>
        </w:del>
    </w:p>

```

我知道 Differencer 能够忽略`xml:space="preserve"`属性，因为它会在表格之前插入文本，所以我怀疑这是原因。

这些表格场景是否超出了预期的用例`Differencer`？是使用/调用错误吗？漏洞？

任何指导表示赞赏。

# parsing - 使用 xpath shell 解析 xml

> ID：11940514
> 
> 赞同：0
> 
> 时间：2012-08-13T18:55:51.533
> 
> 标签：parsing, xpath, awk

首先，我对 shell、Java、Python、Perl 和任何其他基于 Linux 的脚本语言非常陌生。我需要做一些我认为看起来相对简单但无法正常工作的事情。我使用过 awk 和 xpath（就像 awk 输出更好，但似乎不太容易使用）。
首先，我将向您展示我需要解析的 .xml 输出：

> 块引用

```
<CLIOutput>
   <Data>
     <Row>
     <Name>PROD3_A2_LUN10</Name>
     <Type>VMFS</Type>
     <Accessible>Yes</Accessible>
     <Hosts>esx01s112</Hosts>
   </Row>
   <Row>
     <Name>PRIVATE_VDI_SDLC3_A2_LUN174</Name>
     <Type>VMFS</Type>
     <Accessible>Yes</Accessible>
     <Hosts>esx02s104</Hosts>
   </Row>
   <Row>
     <Name>datastore1</Name>
     <Type>VMFS</Type>
     <Accessible>Yes</Accessible>
     <Hosts>esx01s100</Hosts>
   </Row>
 </data>
</CLIOutput> 
```

理想情况下，我希望不仅能够报告“名称、类型、可访问性和主机”的 XML 属性，而且还能够在其中报告以仅发送我想要的输出，即想要报告所有“名称”以“P”开头。迄今为止，我的代码尝试是：

```
* awk '$1~"^(" s ")$"{print $2}' RS=\< FS=\> s="Name" sdlcproxy1diff.xml -- shows me all "Name" items.| 
* xpath datastore.xml '/CLIOutput/Data/Row/*[self::Name]/text()' datastore.xml 2>/dev/null -- shows all "Name" items, but output is horrible. 
```

提前致谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T19:58:41.717

您可能想研究一个名为“xmlstarlet”的免费应用程序。谷歌为它。它非常强大，尽管语法可能有点难以掌握。除了它可以做的许多事情之外，它还能够从 XML 树中提取字段，并将它们打印在一行上，以便您可以在标准的 linux shellscript 中对它们进行 sed/awk/grep。

一个例子：

```
xmlstarlet sel -t -m /CLIOutput/data/Row -n -v "concat(Name,',',Type,',',Accessible,',',Hosts)" 
```

这将为您提供 XML 的 CSV 转换输出。在那个阶段，您可以使用管道和“egrep”来查找名称以 P 开头的任何行：

```
grep -E '^P' 
```

希望有帮助。

# performance - Postgres 性能问题

> ID：11940515
> 
> 赞同：12
> 
> 时间：2012-08-13T18:55:54.123
> 
> 标签：performance, postgresql

我们正在运行 Postgres 9.1.3，我们最近开始在我们的一台服务器上遇到主要的性能问题。

我们的查询在一段时间内运行良好，但截至 8 月 1 日，它们的速度急剧下降。看起来大多数有问题的查询都是 Select 查询（带有 count(*) 的查询特别糟糕），但总的来说，数据库运行得很慢。

我们在服务器上运行了[这个](http://wiki.postgresql.org/wiki/Server_Configuration)查询，这些是我们对默认配置文件所做的更改（注意：服务器在这些更改之前运行良好，因此它们可能并不重要）：

```
 name            |                                                current_setting
---------------------------+---------------------------------------------------------------------------------------------------------------
version                   | PostgreSQL 9.1.2 on x86_64-unknown-linux-gnu, compiled by  gcc (GCC) 4.1.2 20080704 (Red Hat 4.1.2-51), 64-bit
autovacuum                | off
bgwriter_delay            | 20ms
checkpoint_segments       | 6
checkpoint_warning        | 0
client_encoding           | UTF8
default_statistics_target | 1000
effective_cache_size      | 4778MB
effective_io_concurrency  | 2
fsync                     | off
full_page_writes          | off
lc_collate                | en_US.UTF-8
lc_ctype                  | en_US.UTF-8
listen_addresses          | *
maintenance_work_mem      | 1GB
max_connections           | 100
max_stack_depth           | 2MB
port                      | 5432
random_page_cost          | 2
server_encoding           | UTF8
shared_buffers            | 1792MB
synchronous_commit        | off
temp_buffers              | 16MB
TimeZone                  | US/Eastern
wal_buffers               | 16MB
wal_level                 | minimal
wal_writer_delay          | 10ms
work_mem                  | 16MB
(28 rows)

Time: 210.231 ms 
```

通常，当出现此类问题时，人们建议的第一件事是吸尘，我们已经尝试过了。我们对大部分数据库进行了真空分析，但没有帮助。

我们`Explain`在一些查询中使用并注意到 Postgres 使用顺序扫描，即使表有索引。

我们关闭了顺序扫描以强制查询计划器使用索引，但这也无济于事。

然后我们尝试了[这个](http://wiki.postgresql.org/wiki/Show_database_bloat)查询，看看我们是否有很多未使用的磁盘空间，Postgres 正在通过这些空间来找到它正在寻找的东西。不幸的是，虽然我们的一些表确实有点大，但它似乎不足以降低整体系统性能。

我们认为减速可能与 I/O 有关，但我们无法弄清楚具体情况。Postgres 只是愚蠢吗？如果是，那是什么？虚拟机有问题，还是物理硬件本身有问题？

对于我们可以尝试或检查的事情，你们还有其他建议吗？

编辑：

我很抱歉没有早点更新这个。我被其他事情缠住了。

在这台特定的机器上，通过对虚拟机的设置进行小的修改，我们的性能得到了极大的提高。

有一个处理 IO 缓存的设置。它最初设置为 ON。我们认为不断缓存内容会减慢速度，我们是对的。我们把它关掉了，事情有了很大的改善。

有趣的是，我们大多数其他服务器已经关闭了此设置。

还有其他问题，我相信我们会采纳您的很多建议，所以，非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-15T02:08:12.373

你最大的问题是这一行：

```
自动真空 | 离开

```

打开它不会立即解决问题，但它应该可以防止事情进一步恶化。几乎没有什么情况下关闭它是个好主意。主要的例外是大批量加载，然后是显式的 VACUUM FREEZE ANALYZE，之后应该重新打开 autovacuum。关闭 autovacuum 后，您将看到性能下降，就像您一样。一旦数据库变得如此糟糕，它需要比 autovacuum 能够提供的更积极的维护来恢复。

```
checkpoint_segments | 6

```

增加这将有助于数据修改，但不会对提高`SELECT`语句的速度起到太大作用。

```
同步 | 离开
full_page_writes | 离开

```

这些设置告诉 PostgreSQL 以牺牲持久性为代价来加快写入速度。如果您的硬件或操作系统（或虚拟机）崩溃或突然终止，您的数据库将损坏，您最好的选择是从上次已知的良好备份中恢复。（当然，由于硬件随时可能发生故障，如果您担心丢失数据，那么您有一个很好的备份策略。）

```
维护工作内存 | 1GB

```

这对于 8GB 虚拟机来说太高了。在对该连接进行大量维护之前，您始终可以在单个连接上提升它。

```
wal_writer_delay | 10ms

```

即使是经验丰富的专家也很难将其调整为比默认设置更好的性能。几乎总是最好不要管它。

此时最好的选择是使用 pg_dumpall 将数据库集群转储到其他介质，从新的 initdb 开始，然后恢复。作为数据库超级用户，运行`VACUUM FREEZE ANALYZE`（`FREEZE`通常不建议使用，除非在这样的批量加载之后），然后在打开 autovacuum 的情况下运行。

我强烈建议您获取 Greg Smith 的“PostgreSQL 9.0 High Performance”一书，并仔细阅读。（完全公开，我是这本书的技术审稿人之一，但没有从销售中获得任何收入。）他建议的第一件事是在安装 PostgreSQL 之前获得 RAM 和磁盘速度的基准数据——即方式你知道你在处理什么。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-08-13T21:27:45.533

很难确定，但我认为您对 I/O 问题持怀疑态度是正确的。可能发生的情况是，随着表变大或连接数增加，缓存命中率开始下降。这增加了 I/O 需求并减慢了一切。同时，更多的查询到达，使问题变得更糟。这种情况对您来说很复杂，因为虚拟磁盘的行为不一定与物理磁盘相同。

首先，您需要测量 VM 上的实际活动（可能通过 vmstat 或 iostat）。其次，在真实硬件上做同样的事情。最后，在两者上运行一些标准的磁盘带宽工具（特别是随机读/写混合）。现在您将能够说出您有多少可用的 I/O 正在被使用。

至于查询计划，没有架构细节和解释分析输出没有人可以说。

您会发现 postgresql.org 邮件列表很有用，即使只是用于存档。此外，下面链接的书非常好。

[http://www.packtpub.com/postgresql-90-high-performance/book](http://www.packtpub.com/postgresql-90-high-performance/book)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-13T19:13:01.873

> （带有 count(*) 的查询特别糟糕），

你应该看看[窗口函数](http://www.postgresql.org/docs/9.1/static/tutorial-window.html)

否则，如果没有看到您的相关架构和查询，我们就不知道。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-18T10:46:18.923

我也会打开自动吸尘器。您可以设置一些变量来控制真空干扰的程度。使用您拥有的 RAM 量，您应该将共享缓冲区设置在 2048MB - 3276MB 之间。如果您的系统似乎没有使用很多额外的 RAM，而您在其他地方不需要，那么您可能应该将其设置为更接近高端。此外，您可能希望使用 sysctl 查看您的最大段大小。您的 maintenance_work_mem 确实很高，但是如果您主要进行维护，那么我想它并没有我最初想的那么糟糕。

# vb.net - 向一个页面发送 POST 请求但重定向到另一个页面

> ID：11940520
> 
> 赞同：0
> 
> 时间：2012-08-13T18:56:09.460
> 
> 标签：vb.net, asp.net-mvc-3, sms-gateway

真的很难在我的控制器中实现这个。从本质上讲，我有一个控制器，而不是在它完成时将用户传递到如下 URL：

```
 <HttpPost()>
    Function Create(job As Job) As ActionResult
        If ModelState.IsValid Then
            db.Jobs.Add(job)
            db.SaveChanges()
            Dim url As String = "/RequestedService/AddService/" + job.JobId.ToString()
            Return Redirect(url)
        End If

        Return View(job)
    End Function 
```

但是，我正在尝试实现每次调用此控制器时发送 SMS 的功能，并且可以使用如下 URL（由没有用户名或密码组成）： [http://go.bulksms.com:1557/send? username=fred&message=hello](http://go.bulksms.com:1557/send?username=fred&message=hello) 这需要通过 HTTP post 请求访问。我知道我可以在上面的“返回重定向”中返回此 URL，但我希望两者都发生（重定向和此链接上发送 SMS 的帖子），理想情况下，我希望用户像现在一样被重定向到页面但是要在后台发送的短信。我将如何实现这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T19:11:33.620

尝试这个。在两个注释行之间添加了新代码。您也可以参考此[网址](http://msdn.microsoft.com/en-us/library/debx8sh9.aspx)了解详细信息，如果是 POST，您可能需要传递一些表单数据，所有内容都在上面的链接中进行了描述。：

```
<HttpPost()>
    Function Create(job As Job) As ActionResult
        If ModelState.IsValid Then
            db.Jobs.Add(job)
            db.SaveChanges()
            'Sending SMS here: (start)
            Dim request as WebRequest = WebRequest.Create("http://go.bulksms.com:1557/send?username=fred&message=hello")
            request.Method = "POST"
            Dim response As WebResponse = request.GetResponse()

            'end
            Dim url As String = "/RequestedService/AddService/" + job.JobId.ToString()
            Return Redirect(url)
        End If

        Return View(job)
    End Function 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T19:00:59.513

重定向始终是一个`GET`请求

要发布到不同的 URL，您需要使用`HttpWebRequest`类从代码中调用它。

# java - 如何关闭自托管的 Apache CXF Web 服务？

> ID：11940523
> 
> 赞同：1
> 
> 时间：2012-08-13T18:56:22.137
> 
> 标签：java, cxf

我有一个控制台应用程序，可以用以下代码简要描述：

```
public static void main(String[] args) throws InterruptedException {
    JAXRSServerFactoryBean sfb = new JAXRSServerFactoryBean();
    sfb.setResourceClasses(DummyService.class);
    sfb.setResourceProvider(DummyService.class, new SingletonResourceProvider(new DummyServiceImpl()));
    sfb.setProvider(new JacksonJaxbJsonProvider());
    sfb.setAddress("http://0.0.0.0:9000/");
    BindingFactoryManager manager = sfb.getBus().getExtension(BindingFactoryManager.class);
    JAXRSBindingFactory bindingFactory = new JAXRSBindingFactory();
    bindingFactory.setBus(sfb.getBus());
    manager.registerBindingFactory(JAXRSBindingFactory.JAXRS_BINDING_ID, bindingFactory);
    Server server = sfb.create();       
    server.stop(); // here
} 
```

我从 Eclipse 运行这个程序，我希望它立即完成，因为我`server.stop()`最终是正确的。这行代码是由应用程序执行的，所以我必须手动关闭它。这是 CXF 打印到控制台的日志：

```
Aug 13, 2012 10:51:10 PM org.apache.cxf.endpoint.ServerImpl initDestination
INFO: Setting the server's publish address to be http://0.0.0.0:9000/
2012-08-13 22:51:10.598:INFO:oejs.Server:jetty-7.5.3.v20111011
2012-08-13 22:51:10.646:INFO:oejs.AbstractConnector:Started SelectChannelConnector@0.0.0.0:9000 STARTING
2012-08-13 22:51:10.662:INFO:oejsh.ContextHandler:started o.e.j.s.h.ContextHandler{,null}
2012-08-13 22:51:10.663:INFO:oejsh.ContextHandler:stopped o.e.j.s.h.ContextHandler{,null} 
```

在对应用程序的调用`server.stop()`仍在运行后，但服务器没有响应任何请求，所以感觉我需要关闭其他东西。

什么是阻止它的正确方法？

**更新**

```
server.stop();
server.destroy(); 
```

也不行。

**更新**

```
<dependency>
  <groupId>org.apache.cxf</groupId>
  <artifactId>cxf-bundle-jaxrs</artifactId>
  <version>2.6.1</version>
</dependency> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-13T19:29:41.187

固定与

```
server.stop();
server.destroy();
sfb.getBus().shutdown(true) 
```

感觉像肮脏的黑客。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T19:00:59.187

从javadoc（http://cxf.apache.org/javadoc/latest/org/apache/cxf/jaxrs/JAXRSServerFactoryBean.html）：

> [..]这将为您启动一个服务器并将其注册到 ServerManager。请注意，您应该在完成后显式关闭创建的服务器：

```
myServer.close();
myServer.destroy(); 
```

# c++ - 检查数组中的相似元素并转移到新数组

> ID：11940526
> 
> 赞同：1
> 
> 时间：2012-08-13T18:56:49.007
> 
> 标签：c++, visual-c++

我有一个任务，我必须创建 3 个数组。前两个数组有相似的元素，第三个是空的。

```
const int arraySize = 4;
array k[arraySize] = {1, 2 ,3, 7}
array j[arraySize] = { 1, 2, 8, 9}
array u;

int *ptr1 = arrayk;
    int *ptr2 = arrayj; 
```

如何比较前两个中的元素，然后将这些重复项复制到第三个空数组（数组`u`）？

我在想这样的事情：

```
for(int i = 0; i < arraySize; ++1) {
    for(int k = 0; k < arraySize; ++k) {
        if(&ptr1[i] == &ptr2[k]) {
            //copy elements that are duplicates to array u
          }
      }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T19:00:49.640

如果你可以使用 STL，我推荐[`set_intersection`](http://www.cplusplus.com/reference/algorithm/set_intersection/). 这是此链接中使用的示例：

```
#include <iostream>
#include <algorithm>
#include <vector>
using namespace std;

int main () {
  int first[] = {5,10,15,20,25};
  int second[] = {50,40,30,20,10};
  vector<int> v(10);                           // 0  0  0  0  0  0  0  0  0  0
  vector<int>::iterator it;

  sort (first,first+5);     //  5 10 15 20 25
  sort (second,second+5);   // 10 20 30 40 50

  it=set_intersection (first, first+5, second, second+5, v.begin());
                                               // 10 20 0  0  0  0  0  0  0  0

  cout << "intersection has " << int(it - v.begin()) << " elements.\n";

  return 0;
} 
```

如果您不能使用 STL，请考虑此代码（也来自链接）。

> 该函数模板的行为等价于：
> 
> ```
> template <class InputIterator1, class InputIterator2, class OutputIterator>
>   OutputIterator set_intersection ( InputIterator1 first1, InputIterator1 last1,
>                                     InputIterator2 first2, InputIterator2 last2,
>                                     OutputIterator result )
> {
>   while (first1!=last1 && first2!=last2)
>   {
>     if (*first1<*first2) ++first1;
>     else if (*first2<*first1) ++first2;
>     else { *result++ = *first1++; first2++; }
>   }
>   return result;
> } 
> ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T19:07:38.963

由于它看起来像家庭作业，我假设您想自己完成，而不是使用库来实现这一点。在这种情况下，您的代码很好，您只需要保留一个整数变量即可将下一个可用位置存储在 u 数组中。

```
const int arraySize = 4; 
int next = 0; 
array k[arraySize] = {1, 2 ,3, 7};
array j[arraySize] = { 1, 2, 8, 9};
array u[arraySize]; // Because it at most be a copy of array k or j

for(int i = 0; i < arraySize; ++i) {
    for(int k = 0; k < arraySize; ++k) {
        if(arrayk[i] == arrayj[k]) {
            u[next++] = arrayk[i];
        }
    }
} 
```

这样，当您找到重复项时，您将其分配给 u 上的下一个可用位置，然后将 next 的值增加一。

这是指针版本，尽管我强烈建议在这种情况下避免使用它们，并且仅在需要时使用它们。

```
const int arraySize = 4; 
int next = 0; 
array k[arraySize] = {1, 2 ,3, 7};
array j[arraySize] = { 1, 2, 8, 9};
array u[arraySize]; // Because it at most be a copy of array k or j

int *ptr1 = arrayk;
int *ptr2 = arrayj;

for(int i = 0; i < arraySize; ++i) {
    for(int k = 0; k < arraySize; ++k) {
        if(*(ptr1 + i)  == *(ptr2 + k) {
            u[next++] = *(ptr1 + i);
        }
    }
} 
```

# objective-c - 将动态持续时间打印到 NSString 的好方法

> ID：11940527
> 
> 赞同：0
> 
> 时间：2012-08-13T18:56:58.703
> 
> 标签：objective-c, ios, cocoa-touch, duration, nstimeinterval

> **可能重复：**
> [Objective-C 中的模糊日期算法](https://stackoverflow.com/questions/1052951/fuzzy-date-algorithm-in-objective-c)
> [如何在 iPhone 上将 NSTimeInterval 分解为年、月、日、小时、分钟和秒？](https://stackoverflow.com/questions/1237778/how-do-i-break-down-an-nstimeinterval-into-year-months-days-hours-minutes-an)

我有兴趣根据 NSTimeInterval 的大小（没有固定格式）打印“1 小时”或“2 分 10 秒”等媒体项目的播放持续时间。不幸的是，Cocoa Touch 没有提供任何类。

在浪费时间重新发明轮子之前，我想问一下是否有人可以推荐我一个实现。我确信这是经常使用的东西，但我在网络上找不到任何提供这种功能的库/片段。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T21:04:00.347

你可以这样做：

```
- (NSString*)timeIntervalStringforDouble:(double)timeInterval {
NSString *intervalString=@"";
NSInteger hours = (int)floor(timeInterval/3600.0);
double remainder = timeInterval-(hours*3600);
NSInteger minutes = (int)floor(remainder/60.0);
NSInteger seconds = (int)round(remainder-(minutes*60));
NSString *temporalSegment = @"hour";
if (hours) {
    if (hours>1) temporalSegment = @"hours";
    intervalString = [intervalString stringByAppendingFormat:@"%d %@ ",hours,temporalSegment];
}
if (minutes || hours) {
    temporalSegment = (minutes==1)? @"minute":@"minutes";
    intervalString = [intervalString stringByAppendingFormat:@"%d %@ ",minutes,temporalSegment];
}
if (seconds || minutes) {
    temporalSegment = (seconds==1)?@"second":@"seconds";
    intervalString = [intervalString stringByAppendingFormat:@"%d %@",seconds, temporalSegment];
}
return intervalString; 
} 
```

标点符号和格式以适应口味。

# javascript - Javascript验证表单不重定向页面

> ID：11940528
> 
> 赞同：0
> 
> 时间：2012-08-13T18:57:02.167
> 
> 标签：javascript

我用javascript编写了一个用于验证表单的ASP页面，然后让它重定向（form.action）到另一个页面，但它只是重新加载页面。这是我的代码：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- InstanceBegin template="/Templates/nirsaplate_forms.dwt" codeOutsideHTMLIsLocked="false" -->
<head>
<!-- InstanceBeginEditable name="Title/Keywords" -->
<title>TED CEU/PIC Tracking System</title>
<meta name="keywords">
<script type="text/javascript">
var typesAndCovered={};
typesAndCovered['CEU']=['Philosphy & Theory','Programming','Management Techniques','Business Procedures','Facility Management, Planning & Design','Research & Evaluation','Legal Liability & Risk Management','Personal & Professional Qualities'];
typesAndCovered['PIC']=['Leadership, governance and service','Education, training, scholarship and research'];

function ChangeTypeList()
{
var typeList=document.getElementById("Atype");
var coveredList=document.getElementById("typecovered");
var selType=typeList.options[typeList.selectedIndex].value;
while (coveredList.options.length)
  {
  coveredList.remove(0);
  }
var types=typesAndCovered[selType];
if (types)
  {
  for (var i=0;i<types.length;i++)
    {
    var Atype=new Option(types[i],i);
    coveredList.options.add(Atype);
    }
  }
}
</script>
<script type="text/javascript">
<!--

function validateForm(form) {

        if (form.Atype.value == "") {
            alert("You must specify activity to track: CEU or PIC?");
            form.Atype.focus();
            return false;
        }
        if (form.DateEvent.value == "") {
            alert("You must specify a date for this event.");
            form.DateEvent.focus();
            return false;
        }
        if (form.NameEvent.value == "") {
            alert("You must specify a name for this event.");
            form.NameEvent.focus();
            return false;
        }
        if (form.NameSession.value == "") {
            alert("You must specify a session name.");
            form.NameSession.focus();
            return false;
        }
        if (form.UnitsEarned.value == "") {
            alert("You must specify how many units you earned.");
            form.UnitsEarned.focus();
            return false;
        }
        if (form.CEUPICType.value == "") {
            alert("You must specify a CEU/PIC type.");
            form.CEUPICType.focus();
            return false;
        }
        if (form.TEDEvent.value == "") {
            alert("You must specify if this was a TED event or not.");
            form.TEDEvent.focus();
            return false;
        }
        if (form.TypeCovered.value == "") {
            alert("You must specify CEU Core Competency or PIC Category.");
            form.TypeCovered.focus();
            return false;
        }

form.action = "display.asp";
form.submit();

    return true;
}

//-->
</script>
<!-- InstanceEndEditable -->
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
</head>
<body onload="ChangeTypeList();">
<table width="100%" border="0" cellspacing="0" cellpadding="0">
  <tr align="center" valign="middle" bgcolor="#000033">
    <td>&nbsp;</td>
    <td align="left" width="150"><a class="tedhome" href="http://www.ted.org">&nbsp;&nbsp;TED Home</a></td>
    <td id="tedtop" width="450" height="20">&nbsp;</td>
    <td width="150"></td>
    <td>&nbsp;</td>
  </tr>
</table>
<table width="750" border="0" cellspacing="0" cellpadding="0" align="center" bgcolor="#ffffff">
  <tr valign="top" bgcolor="#003399" height="60">
    <td rowspan="2" colspan="2" height="80"><img src="images/ted_head_1.jpg" alt="TED" height="80" width="500" border="0"></td>
    <td height="60"><img src="images/ted_head_2.jpg" alt="" height="60" width="250" border="0"></td>
  </tr>
  <tr valign="top" bgcolor="#003399" height="20">
    <td id="toplinks" align="right" valign="middle" height="20"><p></p></td>
  </tr>
  <tr bgcolor="#e3e3e3">
    <td colspan="3" align="center" height="20"><div id="tagline">&nbsp;</div></td>
  </tr>
<!-- Begin mainNav -->
  <tr bgcolor="#003399">
    <td colspan="3" height="20">&nbsp;</td>
  </tr>
<!-- End mainNav -->
</table>
<table width="750" border="0" cellspacing="0" cellpadding="0" align="center" bgcolor="#ffffff">
  <tr align="left" valign="top">
    <td>
      <table width="750" border="0" cellspacing="0" cellpadding="0" align="center" bgcolor="#ffffff">
        <tr valign="top">
          <td><!-- InstanceBeginEditable name="Content" -->
          <div id="Content"><h1>TED CEU/PIC Tracking System</h1>
          <p><font color="#cc0000">* Required field</font></p>
          <form name="form" Method="post" onSubmit="return validateForm(form)">
            <table width="650" border="0" cellspacing="1" cellpadding="3" align="center" bgcolor="gray">
              <tr valign="top">
                <td colspan="2" bgcolor="#FFCC66"><h4>CEU/PIC Details:</h4></td>
              </tr>
              <tr valign="top">
                <td bgcolor="#e3e3e3"><p><strong><font color="#cc0000">*</font> Activity to Track:</strong></p></td>
                <td bgcolor="#FFFFFF"><p><select name="Atype" id="Atype" onchange="ChangeTypeList();">
                <option value="">-- Activity Type --</option>
                <option value="CEU">CEU</option>
                <option value="PIC">PIC</option></select></p></td>
              </tr>
              <tr valign="top">
                <td bgcolor="#e3e3e3"><p><strong><font color="#cc0000">* </font>Date:</strong></p></td>
                <td bgcolor="#FFFFFF"><input name="DateEvent" type="text" class="ctrl" id="DateEvent" size="10" maxlength="10"></td>
              </tr>
              <tr valign="top">
                <td bgcolor="#e3e3e3"><p><strong><font color="#cc0000">*</font> Name of Event:</strong></p></td>
                <td bgcolor="#FFFFFF"><input name="NameEvent" type="text" id="NameEvent" size="50" maxlength="255"></td>
              </tr>
              <tr valign="top">
                <td bgcolor="#e3e3e3"><p><strong><font color="#cc0000">*</font> Name of Educational Session:</strong></p></td>
                <td bgcolor="#FFFFFF"><input name="NameSession" type="text" id="NameSession" size="50" maxlength="255"></td>
              </tr>
              <tr valign="top">
                <td bgcolor="#e3e3e3"><p><strong><font color="#cc0000">*</font> CEUs/PICs Earned:</strong></p></td>
                <td bgcolor="#FFFFFF"><input name="UnitsEarned" type="text" class="ctrl" id="UnitsEarned" size="50" maxlength="255"></td>
              </tr>
              <tr valign="top">
                <td bgcolor="#e3e3e3"><p><strong><font color="#cc0000">*</font> CEU/PIC Type:</strong></p></td>
                <td bgcolor="#FFFFFF"><input name="CEUPICType" type="text" id="CEUPICType" size="25" maxlength="255"></td>
              </tr>
              <tr valign="top">
                <td bgcolor="#e3e3e3"><p><strong><font color="#cc0000">*</font> TED Event:</strong></p></td>
                <td bgcolor="#FFFFFF"><p><select name="TEDEvent" id="TEDEvent"><option value="Yes" selected>Yes</option><option value="No">No</option></select></p></td>
              </tr>
              <tr valign="top">
                <td bgcolor="#e3e3e3"><p><strong><font color="#cc0000">*</font> CEU/PIC Core Competency/Category Covered:</strong></p></td>
                <td bgcolor="#FFFFFF"><p><select id="typecovered"></select></p></td>
              </tr>
              <tr valign="top">
                <td colspan="2" align="center" bgcolor="#FFCC66"><p><br><b>Submit your CEU/PIC tracking.</b></p><p align="center">&nbsp;</p></td>
              </tr>
              <tr valign="top">
                <td colspan="2" align="center" bgcolor="#FFFFFF"><p><input type="submit" value="Submit Data" name="submit" ><input type="reset" name="reset" value="Reset"></p></td>
              </tr>
            </table>
          </form>
          </div>
<!-- InstanceEndEditable -->
          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
</body>
<!-- InstanceEnd -->
</html> 
```

任何帮助都会非常有帮助。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T19:11:12.577

我的猜测是您正在进入一个无限循环，并且它会导致“堆栈溢出”错误；）

尝试删除`form.submit();`之后`for.action = ...`

```
form.action = "display.asp";
// form.submit(); // this is what triggers validateForm again and again... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T19:11:34.447

你用了表格。**函数 validateForm(form)**中的**TypeCovered**，但实际的 id 是**typecovered**的（都是小写），这会导致异常，从而导致函数失败

# c++ - 如何将整个 Visual c++ 项目加载到 Enterprise Architect 中进行逆向工程？

> ID：11940530
> 
> 赞同：0
> 
> 时间：2012-08-13T18:57:08.127
> 
> 标签：c++, visual-c++, enterprise-architect

有没有办法为 EA 加载 DSW 文件，然后加载整个 Visual C++ 项目？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T19:41:01.540

AFAIK，您只能将 C++ 代码从源代码（头文件）逆向工程到 EA。

还有一个 VS AddIn 可用：[Visual Studio 的 MDG 集成](http://visualstudiogallery.msdn.microsoft.com/34896732-9677-4886-A0C1-CE530DBA65AA/)，但需要额外付费。

绕过“意大利面条混乱布线”的最佳方法是手动为您感兴趣的课程绘制图表。您可以从您选择的类的（图表）上下文菜单中使用“添加相关元素”命令，这可能会有所帮助。

不要期望在没有进一步文档的情况下仅从类图开始针对复杂的遗留库 API 进行编程，但是类图可以帮助您鸟瞰 API 结构。

# php - 使用 Facebook 注册表单注册 WordPress 用户

> ID：11940534
> 
> 赞同：0
> 
> 时间：2012-08-13T18:57:32.297
> 
> 标签：php, facebook, wordpress, connect

对于我的网站，我可以添加位于此处的 Facebook 注册表单： [https](https://developers.facebook.com/docs/plugins/registration/) ://developers.facebook.com/docs/plugins/registration/ （检查第一个表单代码）

现在我被困在：

_redirect url 将处理signed_request 的URI。它必须以您的站点 URL_ 为前缀

在他们同意注册后，我希望将用户添加为 WordPress 用户，这样我就可以限制对我的 WordPress 网站中某些页面的访问。

关于如何做到这一点的任何建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T20:25:39.607

看看这个：

[http://wordpress.org/extend/plugins/wp-facebook-connect/](http://wordpress.org/extend/plugins/wp-facebook-connect/)

这个插件通过 Facebook 创建一个新的 wordpress 用户。

您还可以查看这个相关的 SO 问题来了解一下：

[wordpress 从 facebook 登录插件创建用户](https://stackoverflow.com/questions/8289129/wordpress-create-user-from-facebook-login-plugin)

# c - 函数参数的这个 IN 部分是什么？

> ID：11940535
> 
> 赞同：2
> 
> 时间：2012-08-13T18:57:33.467
> 
> 标签：c

我正在尝试在 Windows 驱动程序上做一些工作，但我无法理解示例源代码的一部分。在我的 C 经验中，我以前从未见过这种情况，而且我在上面找不到任何东西。无论如何，我想知道参数变量的“IN”部分是什么？下面是一个函数头的例子。它也可能是其他一些东西，例如“OUT”、“INOUT”、“INOPT”，甚至更多（找不到其他东西）。

```
VOID
PLxReadRequestComplete(
    IN WDFDMATRANSACTION  DmaTransaction,
    IN NTSTATUS           Status
    ) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-13T19:06:55.320

这些只是描述参数预期用途的简单标记（来自 Windows DDK 的早期阶段）。

在正常构建中，宏被定义为空，但是可以想象它们被定义为特定于实现的关键字，允许编译器（使用 SAL 或其他静态代码分析工具）对参数/参数的正确使用进行更深入的分析。我不认为它们用于 SAL，因为它们根本不够“丰富”来描述 SAL 喜欢考虑的所有属性。所以我认为它们主要是为了向程序员传达意图。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-13T18:59:22.157

这不是标准的 C。很可能，`IN`已使用 a 定义为具有其他值`#define`- 即*宏*。在您的`*.h`文件中搜索`#define IN`、`#define OUT`等，看看您是否能找到什么。

# wpf - WPF MVVM 中字符串列表的 ObservableCollection

> ID：11940536
> 
> 赞同：1
> 
> 时间：2012-08-13T18:57:35.863
> 
> 标签：wpf, list, observablecollection

我在 ObservableCollection 中有一个字符串列表，我想将它绑定到数据网格、列表框或允许我在列表中的项目上添加双击事件的东西。如果你不知道，我是 WPF 的新手！！！

代码：

```
 private ObservableCollection<string> _searchResults;
    public ObservableCollection<string> SearchResults
    {
        get { return _searchResults; }
        set
        {
            _searchResults = value;
            OnPropertyChanged("SearchResults");
        }
    }

<Grid>
    <DataGrid AutoGenerateColumns="False"
              Name="MyGrid"
              Height="400"
              Width="400"
              ItemsSource="{Binding SearchResults}"
              SelectedItem="{Binding MySelectedItemProperty, UpdateSourceTrigger=PropertyChanged}"/>

</Grid> 
```

作为旁注，我也在使用 Caliburn.Micro

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T19:12:39.457

在你的视图中，你会为你的 Datagrid 做这样的事情：

```
<DataGrid AutoGenerateColumns="False" Name="MyGrid" 
  ItemsSource="{Binding MyListofStrings}"
  SelectedItem="{Binding MySelectedItemProperty, UpdateSourceTrigger=PropertyChanged}"
              CommandHelper:MouseDoubleClick.Command="{Binding MyEditCommand}"> 
```

然后在您的视图模型中：

```
 private ObservableCollection<MyStrings> _MyListofStrings;
        public ObservableCollection<MyStrings> MyListofStrings
        {
            get { return _MyListofStrings; }
            set
            {
                  _MyListofStrings = value;
                OnPropertyChanged("MyListofStrings");       //Used for 2 way binding.
            }
        } 
```

然后使用您的数据类型填充“MyListofStrings”。

# c# - Umbraco - 在 C# 中查找根节点

> ID：11940537
> 
> 赞同：14
> 
> 时间：2012-08-13T18:57:42.000
> 
> 标签：c#, umbraco

我正在开发一个后端模块，所以`Node.GetCurrent()`不是一个选项。我需要找到一种方法来调用类似的东西`Node currentNode = new Node(parentNodeId);`并获取站点的根节点。我在 XSLT 中看到过示例，但在 C# 中没有。有谁知道我怎么能做到这一点？

即使只是获取根节点的 ID 以便我可以调用`new Node()`也会很棒。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-13T19:07:16.180

根节点始终可用：

```
var rootNode = new Node(-1); 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2014-09-11T00:34:27.170

Umbraco 7 的更新（也可以在早期版本中使用）

```
@{
    var siteroot = CurrentPage.AncestorOrSelf(1);
} 
```

有关更多信息，请查看文档 -> [http://our.umbraco.org/Documentation/Reference/Querying/DynamicNode/Collections](http://our.umbraco.org/Documentation/Reference/Querying/DynamicNode/Collections)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-12-06T14:20:54.053

Umbraco 6+ 更新

```
public static IPublishedContent GetRootNode()
{
    var umbracoHelper = new UmbracoHelper(UmbracoContext.Current);
    var rootNode = umbracoHelper.TypedContentSingleAtXPath("//root"));

    return rootNode;
} 
```

这仅采用文档类型别名并使用当前 Umbraco 上下文将根节点查找为 IPublishedContent。UmbracoHelper 也为您提供了很多选择。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2015-01-30T12:13:17.250

Umbraco 7：

```
Umbraco.TypedContentAtRoot(); 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-08-14T21:28:46.463

布伦南是正确的，

```
var rootNode = new DynamicNode(-1); 
```

也可以！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-10-23T21:42:37.040

我经常用这个。我喜欢它是相对的，因此如果您有多个根节点，您可以在没有 foreach 循环的情况下同时定位这两个节点。

```
IPublishedContent topNode = Model.Content.AncestorOrSelf(1); 
```

# vba - 运行 3 个条件并提供价值的宏

> ID：11940540
> 
> 赞同：0
> 
> 时间：2012-08-13T18:57:52.017
> 
> 标签：vba, excel

这是我第一次使用 VBA for Excel（我通常编写 Java 和 C++ 代码），我希望得到一些开始的技巧。

我想为一个大型数据集编写一个宏，该宏将通过以下条件列表来提供美元结果：

1.  从 A 列收集单位大小（可能的值 0-8）
2.  从 B 列确定是单身还是家庭单位（单身- 1，家庭- 0）
3.  从 C 列收集实用程序代码（被评估产品类型的代码）

根据此信息，将在行中放置一个新值，该值通过考虑单位大小、单位类型和相关产品来确定公用事业成本。我曾考虑`Select Case`在循环中使用嵌套或嵌套条件，但总的来说我很迷茫。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T19:43:00.610

感谢您的回复，它们有助于理解 VBA for Excel。我只是把可能的值放在一个表中，然后在 Index 函数中使用 Match 函数来挑选正确的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T20:57:50.663

似乎工作表公式可以解决问题，但如果不知道计算是什么就很难说。下面是一个用户定义函数 (UDF)，您可以将其放入标准模块中。您可以从以下单元格中调用它：

```
=computecosts(A2,B2,C2) 
```

显然，代码会根据数据的布局方式和计算方式而改变。

```
Public Function ComputeCosts(rSize As Range, rFamily As Range, rCode As Range) As Double

    Dim lSizeFactor As Long
    Dim lFamilyFactor As Long
    Dim dCodeFactor As Double
    Dim rFound As Range

    Const lFAMILY As Long = 0

    'Size factor is a function of 0-8, namely adding 1
    lSizeFactor = rSize.Value + 1

    'Family factor is computed in code
    If rFamily.Value = lFAMILY Then
        lFamilyFactor = 3
    Else
        lFamilyFactor = 2
    End If

    'Code factor is looked up in a different sheet
    Set rFound = Worksheets("Sheet2").Columns(1).Cells.Find(rCode.Value, , xlValues, xlWhole)
    If Not rFound Is Nothing Then
        dCodeFactor = rFound.Offset(0, 1).Value
    End If

    'do the math
    ComputeCosts = lSizeFactor * lFamilyFactor * dCodeFactor

End Function 
```

# mysql - 我可以从 MySQL 数据库备份中恢复一张表吗？

> ID：11940544
> 
> 赞同：2
> 
> 时间：2012-08-13T18:58:05.980
> 
> 标签：mysql

我不小心清空了一张桌子。我有备份，但是备份的是整个数据库，大约10GB。我怎样才能从备份中恢复一张表？可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T20:22:39.460

来自[http://blog.tsheets.com/2008/tips-tricks/mysql-restoring-a-single-table-from-a-huge-mysqldump-file.html](http://blog.tsheets.com/2008/tips-tricks/mysql-restoring-a-single-table-from-a-huge-mysqldump-file.html)

`$ awk '/Table structure for table .test1./,/Table structure for table .test2./{print}' mydumpfile.sql > /tmp/extracted_table.sql`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T19:25:35.580

您只需要从备份 SQL 中提取一个表。

您可以使用 sed 执行此操作，例如

```
sed -n -e '/CREATE TABLE `mytable`/,/CREATE TABLE/p' backup.sql > mytable.sql 
```

（只要它不是转储中的最后一个表（我认为），它就可以工作。输出文件将包含一个额外的行，一个部分 CREATE TABLE 语句。）

# linq - 使用过滤器将 Linq 语句添加到 Web API 获取，我正在尝试添加 $select

> ID：11940546
> 
> 赞同：1
> 
> 时间：2012-08-13T18:58:13.480
> 
> 标签：linq, asp.net-web-api, odata

我试图将一些 linq 语句应用于我的所有 Get Web api 命令。我想我可以使用`ActionFilterAttribute`.

我基本上是在 web api 中添加 $select 支持，因为它目前不受支持。我不确定从哪里得到`IQueryable`结果。我相信我在执行 sql 之前需要它，但在 Get 函数返回`IQueryable`结果之后。任何帮助都会很棒。我正在尝试与[这篇文章](http://forums.asp.net/t/1785490.aspx/3/10)类似的东西，但他的想法将行不通，因为`HttpResponseMessage response = actionExecutedContext.Result;`不再在 RC 中。

谢谢尼克

* * *

## 解决方案

```
 public override void OnActionExecuted(System.Web.Http.Filters.HttpActionExecutedContext actionExecutedContext)
    {
        HttpRequestMessage request = actionExecutedContext.Request;
        HttpResponseMessage response = actionExecutedContext.Response;

        IQueryable obj;

        if (response != null && response.TryGetContentValue(out obj) && request.RequestUri.ParseQueryString()["$select"] != null)
        {

            System.Collections.Specialized.NameValueCollection QueryItems = request.RequestUri.ParseQueryString();
            string select = QueryItems["$select"];

            if (!string.IsNullOrWhiteSpace(select))
            {
                obj = obj.Select(string.Format("new ({0})", select));

            }

            //
            //this should be generic not hard coded for Json
            //
            string json = JsonConvert.SerializeObject(obj, Newtonsoft.Json.Formatting.Indented);

            actionExecutedContext.Response = actionExecutedContext.Request.CreateResponse();
            actionExecutedContext.Response.Content = new StringContent(json);
            actionExecutedContext.Response.Content.Headers.Clear();
            actionExecutedContext.Response.Content.Headers.Add("Content-Type", "application/json");
            actionExecutedContext.Response.StatusCode = System.Net.HttpStatusCode.OK;

        }

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T12:35:35.050

请参阅上面的原始帖子。我将解决方案添加到底部。

# objective-c - 视图控制器不会被推送

> ID：11940548
> 
> 赞同：0
> 
> 时间：2012-08-13T18:58:16.253
> 
> 标签：objective-c, ios, xcode, cocoa-touch

我似乎无法推动这个视图控制器，我一定做错了什么。代码

```
- (void)viewDidLoad
{
[super viewDidLoad];
// Do any additional setup after loading the view from its nib.
button = [UIButton buttonWithType:UIButtonTypeCustom];
[button addTarget:self action:@selector(pushToStart) forControlEvents:UIControlEventTouchUpInside];
}

- (void)pushToStart
{
ViewController *view = [[ViewController alloc]init];

[[self navigationController] pushViewController:view animated:YES];

} 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T19:14:57.243

以编程方式创建 UINavigationController，或者使用 Interface Builder 来创建 - 网上有 100 多个关于如何做到这一点的教程。例如[这里](http://youtu.be/EK498fPy0cc)

# jquery - Flexslider 2 垂直缩略图导航

> ID：11940549
> 
> 赞同：3
> 
> 时间：2012-08-13T18:58:19.843
> 
> 标签：jquery, slideshow, carousel, flexslider

我正在使用 Flexslider 2 开发一个站点。我试图让缩略图导航垂直工作，而不是其默认的水平导航。

目前的问题是它有效，但我发现垂直导航工作中有很多错误。

有没有人试过这个？

任何帮助将非常感激。

干杯，马克

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-07T15:00:31.700

你可以通过一些 CSS rejigging 来做到这一点。不确定是否要一直响应此响应，但对于大尺寸，这可能是一个不错的起点。您还需要在 .flexslider 上放置一个 clearfix。

```
.flex-viewport {width:80.5% !important;float:left;}
.flex-control-thumbs {width:19% !important;float:right;margin:0 !important;}
.flex-control-thumbs li {width:auto !important;} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-09T18:22:24.357

截至 2013 年 1 月 9 日，这似乎在 Flexslider 中并没有真正起作用，但是我已经让它在大多数情况下工作。似乎它被设计为一次只能在滑块中包含 1 个项目（对于我们中的许多人来说，这并没有完全削减它）；maxItem 和 minItem 还不适用于垂直滑块。

第一步当然是确保在参数中将方向设置为垂直：

```
direction: "vertical", 
```

现在， .flex-viewport 将自动将其高度设置为您的`<li>`元素设置的任何高度...但是您可以使用以下方式强制它：

```
.flex-viewport { height: 650px !important;} 
```

只需将其设置为所需的任何大小，以容纳您需要在轮播中显示的任意数量的幻灯片。然后根据需要设计其余部分。但是，是的，仍然存在错误......我已经看到了这些推荐但不能保证：

*   [http://caroufredsel.dev7studios.com/](http://caroufredsel.dev7studios.com/)
*   jquery.vticker.1.4

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-07-20T17:37:12.570

您实际上可以先将方向设置为垂直，如下所示：

```
direction: "vertical", 
```

并且在#carousel li 上强制没有浮动（并添加一点边距底部以分隔缩略图）：

```
#carousel li {
    float: none!important;
    margin-bottom: 10px;
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-11-27T08:50:22.230

解决方案是旋转当前的水平导航。
只需将此样式添加到导航`<ul>`（默认“.flex-direction-nav”）

```
.flex-direction-nav{
    /*ROTATION*/
    -webkit-transform: rotate(90deg);
    -moz-transform: rotate(90deg);
    filter: progid:DXImageTransform.Microsoft.BasicImage(rotation=3);
    -o-transform: rotate(90deg);

    /*POSITIONING*/
    display: inline-block;
    vertical-align: text-top;
    text-indent: 0px;
    width: 51%;
    margin-top: -24%;
} 
```

反转滑动方向将“90”更改为“-90”。
不确定所有浏览器

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-11-27T14:47:28.483

我提出了一个 PR，它可以通过某种方式解决这些错误。它没有经过全面测试，但它可能是一个很好的起点。[https://github.com/woothemes/FlexSlider/pull/1235](https://github.com/woothemes/FlexSlider/pull/1235)

您必须`itemWidth`正确指定选项。

# c# - 在c#中从文件中读取组织数据的方法是什么？

> ID：11940550
> 
> 赞同：0
> 
> 时间：2012-08-13T18:58:22.913
> 
> 标签：c#, wpf, file, c#-4.0, console-application

C# 中有一些很酷的类、技巧和捷径。我知道这一点，但我使用 C# 的工作不足以让他们记住它们。

一个很酷的技巧是这个。如果您从文件中读取数据，该数据以类似的逐行结构排列，其中每行排列在由制表符隔开的列中，则可以将数据读入 C# 中的一种类，然后您可以解析出一个通过简单地执行“for each”命令来获取数据列。有谁知道这是如何做到的？

基本上，我所说的就是这个。我了解如何逐行读取文件：

```
int counter = 0;
string line;
System.IO.StreamReader file =
   new System.IO.StreamReader(filename);

while ((line = file.ReadLine()) != null)
{
    Console.WriteLine(line);
    counter++;
}

file.Close(); 
```

`Console.WriteLine(line);`现在，如果输入文件中的行列由 /t（制表符）分隔，我将如何替换将自动将数据组织到类成员中的代码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T19:02:04.727

你可以打电话给`line.Split('\t')`这会给你`string[]`数组。然后，您可以将每个元素解析为正确的数据类型。

```
MyData LineToMyData(string line)
{
    try
    {
        string[] arr = line.Split('\t');

        return new MyData()
        {
            Time = DateTime.Parse(arr[0]),
            Name = arr[1],
            Age = Int32.Parse(arr[2])
        };
    }
    catch (Exception ex)
    {
        throw new ArgumentException("line", ex);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T19:33:22.253

好吧，我认为您需要一堂课：

```
public class Stuff
{
    public string field1 {get; set;}
    public string field2 {get; set;}
    public string fieldn {get; set;}
    public Stuff()
    {
        field1 = "";
        field2 = "";
        fieldn = "";
    }
} 
```

然后在 While-->read 之前创建一个新类的列表。在 while-->read 中，创建你的类，并使用上面提到的 split 填充数据。

```
List<Stuff> lotsaStuff = new List<Stuff>();        
while ((line = file.ReadLine()) != null)         
{         
    string[] fields = line.Split('\t');
    Stuff newStuff = new Stuff();
    newStuff.field1 = fields[0].ToString();
    newStuff.field2 = fields[1].ToString();;
    newStuff.fieldn = fields[2].ToString();;
    lotsaStuff.Add(newStuff);         
} 
```

文件关闭后，您可以使用您的列表：

```
foreach (Stuff mystuff in lotsaStuff)
{
    if (mystuff.field2 == "useME")
    {
        //do something here...
    }
} 
```

您将希望将数据类型（为简单起见，我使用所有字符串）与您的数据相匹配，无论是在类中，还是在您从读取的行中填充类时。

# .net - DownloadDataAsync 后如何关闭网络客户端

> ID：11940555
> 
> 赞同：-1
> 
> 时间：2012-08-13T18:58:36.317
> 
> 标签：.net, c++-cli, webclient

我们有一种情况，我们使用`WebClient`该类从服务器下载一些数据。我们可以控制客户端和服务器部分。目前，每次用户执行操作时，都会生成一个 webclient 并用于连接到服务器。然后客户端在后台下载一些数据并对其进行一些处理。当用户导致这种情况重复发生时，就会出现问题......在服务器端（不是基于.net！）我们看到连接在我们的超时期限后超时，并且不会将拆卸发送到服务器。这让我想到了我的问题......

是否有适当的方法来发出信号或强制拆除 webclient 类使用的 HTTP 连接？

代码：pMPTF 是一个回调类，用于将 .net 事件带入非托管世界。

```
void Callback(System::Object^ sender, System::Net::DownloadDataCompletedEventArgs^ e)
{
   WebClient^ w = (WebClient^)sender;
   w->Dispose();
   if( e->Error == nullptr && pMPTF != NULL )
      pMPTF->ParseResponse(e->Result);
   else
      pMPTF->ParseResponse( nullptr );
} 
```

给出：

> 错误 C2039：“Dispose”：不是“System::Net::WebClient”的成员

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T19:40:45.100

至此操作完成。如果使用`delete`该对象将被处置。我建议阅读有关如何在托管 C++ 中处理对象：msdn.microsoft.com/en-us/library/ms177197.aspx

如果要手动关闭响应，可以在返回的对象上调用`GetWebResponse`和调用。`Close``WebResponse`

# c# - 如何使用淘汰赛保存单个记录

> ID：11940556
> 
> 赞同：0
> 
> 时间：2012-08-13T18:58:40.140
> 
> 标签：c#, javascript, asp.net-mvc-3, knockout.js

我有一个使用敲除设置的基本表，但我想知道是否有任何方法可以编辑/保存单个记录，而不是每次进行更改时都必须保存整个视图模型？这是我的代码...

```
<tbody data-bind="foreach: movies">
    <tr> 
        <td data-bind="text: title"></td>
        <td data-bind="text: releaseDate"></td>
        <td data-bind="text: genre"></td>
        <td data-bind="text: price"></td>
        <td><input type="button" value="Edit" id="edit"/></td>
    </tr>
    <tr class="editable"> <!-- hide this initially, only show when edit button is   clicked -->
        <td><input id="titleInput" data-bind="value: title" /></td>
        <td><input id="releaseDateInput" data-bind="value: releaseDate" /></td>
        <td><input id="genreInput" data-bind="value: genre" /></td>
        <td><input id="priceInput" data-bind="value: price" /></td>
    </tr>
 <!-- save button/form or something here containing ONLY this record -->

</tbody>
</table>

<script type="text/javascript">

function Film(data) {
    this.title = ko.observable(data.Title);
    this.releaseDate = ko.observable(data.ReleaseDate);
    this.genre = ko.observable(data.Genre);
    this.price = ko.observable(data.Price);
}

function MovieListViewModel() {
    var self = this;
    self.movies = ko.observableArray([]);
    self.title = ko.observable();
    self.releaseDate = ko.observable();
    self.genre = ko.observable();
    self.price = ko.observable();

    $.getJSON("/Movies/GetAllMovies", function (allMovies) {
        var mappedMovies = $.map(allMovies, function (movie) { return new Film(movie)    });
        self.movies(mappedMovies);
    });
}

ko.applyBindings(new MovieListViewModel()); 
```

有什么想法吗？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T19:11:54.243

实际上，通过**[绑定上下文](http://knockoutjs.com/documentation/binding-context.html)**的魔力，这很容易！

1.  **第一步**。将以下元素放置在 foreach 模板中的任何位置。

    ```
    <button data-bind="click: $root.saveMovie">Save</button> 
    ```

2.  **第二步**。将`saveMovie`方法添加到您的 viewModel

    ```
    self.saveMovie = function(movie) {
        $.ajax({
            type: "POST",
            url: "/someurl",
            dataType: "json",
            contentType: "application/json",
            data: ko.toJSON(movie),
            success: function(result) {
                //...
            }
        });
    } 
    ```

该`movie`变量将包含您的 foreach 循环的项目！为什么？因为在 Knockout 中，我们有一个惊人的特性，称为绑定上下文：

> 绑定上下文是一个对象，其中包含您可以从绑定中引用的数据。在应用绑定时，Knockout 会自动创建和管理绑定上下文的层次结构。层次结构的根级别是指您提供给 ko.applyBindings(viewModel) 的 viewModel 参数。然后，每次您使用控制流绑定（例如 with 或 foreach）时，都会创建一个引用嵌套视图模型数据的子绑定上下文。

[http://knockoutjs.com/documentation/binding-context.html](http://knockoutjs.com/documentation/binding-context.html)

# java - 使用取消按钮转义 JOptionPane InputDialog 循环

> ID：11940560
> 
> 赞同：0
> 
> 时间：2012-08-13T18:58:56.290
> 
> 标签：java, sql, arrays, arraylist, joptionpane

如果用户单击取消，我将如何为循环添加退出方式。如果有人愿意，有一段注释掉的代码，它在代码的游客输入按钮部分中被引用，但它不起作用。谢谢

```
 /////////Convert
     public static int[] convertIntegers(java.util.List<Integer> elemIntegers)
{
    int[] elements = new int[elemIntegers.size()];
    for (int i=0; i < elements.length; i++)
    {
        elements[i] = elemIntegers.get(i).intValue();
    }
    return elements;
} 
```

完整的源代码在这里： http: [//pastebin.com/r4tEeatu](http://pastebin.com/r4tEeatu)

具体部分是

```
insertTableF.addActionListener(new ActionListener() {
        public void actionPerformed(ActionEvent e) {
            int wayPoint1 = 0;
            int wayPoint2 = 0;
            int PassTime = 0;
            Statement statementR;

            if (loggedIn == 1) {

                while (passedR == 0) {
                    try {
                        if (wayPoint1 == 0) {
                            sTagR = JOptionPane.showInputDialog("Please enter the Rhino Tag number:");
                            iTagR = Integer.parseInt(sTagR);
                            wayPoint1 = 1;
                        }
                        if (wayPoint2 == 0) {
                            sGPSX = JOptionPane.showInputDialog("Please enter the horizontal GPS Grid Numbers(eg.3123):");
                            iGPS = Integer.parseInt(sGPSX);

                            wayPoint2 = 1;
                        }

                        sGPSY = JOptionPane.showInputDialog("Please enter the vertical GPS Grid Letters(eg.XXYY:");
                        while (PassTime == 0) {
                            sTime = JOptionPane.showInputDialog("Please enter the Last date you saw the Rhino(YYYY-MM-DD):");
                            //      if (!sTime.equals("") || sTime !=null){
                            if (isValidDate(sTime)) {
                                PassTime = 1;
                            } else {
                                JOptionPane.showMessageDialog(null, "Please use the date format YYYY-MM-DD.");
                            }
                            //      } else {
                            //              JOptionPane.showMessageDialog(null, "Please use the date format YYYY-MM-DD.");
                            //      }
                        }
                        sLocation = JOptionPane.showInputDialog("Please enter the Last place you saw the Rhino:");

                        passedR = 1;
                    } catch (NumberFormatException nfe) {
                        passedR = 0;
                        JOptionPane.showMessageDialog(null, "Please use numbers for the Rhino Tag field.");
                    }
                }
                if (passedR == 1) {
                    ComboGPS = iGPS + " " + sGPSY;
                    try {
                        Connection insertTable = DriverManager.getConnection("jdbc:odbc:Driver={MicroSoft Access Driver (*.mdb)};DBQ=C:/Users/Jethro/Desktop/IT Project Files/dbRhino.mdb", "", "");
                        String sql = "insert into TblRhinoLoc values ( '" + iTagR + "', '" + ComboGPS + "', '" + sTime + "', '" + sLocation + "')";

                        try {
                            statementR = insertTable.createStatement();
                            statementR.executeUpdate(sql);

                            JOptionPane.showMessageDialog(null, "Data entered successfully!");
                            wayPoint1 = 0;
                            wayPoint2 = 0;
                        } catch (Exception err) {
                            System.out.println(err);
                            JOptionPane.showMessageDialog(null, err);
                        }
                        UpdateJTableRanger();
                    } catch (SQLException er) {
                        System.out.println("Error: " + er);
                    }

                } else {

                }
            } else {
                JOptionPane.showMessageDialog(null, "Please make sure you are logged in before editing sensitive data.");
            }
        }
    }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T19:11:30.260

您究竟想跳出哪个循环？

我假设您想`while (passedR == 0)`在用户取消其中一个`JoptionPane.showInputDialog`选项时退出循环。

```
while (passedR == 0) {
...
            sTagR = JOptionPane.showInputDialog(...);
            if (sTagR == null) {
                 // User canceled.
                 break;
            } else {
               ...
            }
} 
```

# xcode - Xcode 4.4.1：git 不再显示修改

> ID：11940564
> 
> 赞同：1
> 
> 时间：2012-08-13T18:59:17.860
> 
> 标签：xcode, git

突然，不幸的是，我无法确定发生的时刻 Xcode 已经停止显示 git 信息，也无法从 Xcode 内部通过 git 提交/恢复/等。如果我检查组织者的存储库，我的项目仍然与它的最后一次提交一起列出。

使用命令行：git status，我看到了所有未暂存的更改，正如我所期望的那样。

因此，该项目仍处于 git 控制之下，但不知何故与 Xcode 分离。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T06:01:09.810

我可以通过在 Xcode 中转到 Organizer、选择我的项目并删除派生数据来解决此问题。执行此操作后，您可能需要退出 Xcode 并重新打开您的项目，以让 Xcode 重建项目索引。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T11:05:34.320

安装命令行工具对我有用

# asp.net - Asp.net MVC 3 条件模型验证

> ID：11940566
> 
> 赞同：1
> 
> 时间：2012-08-13T18:59:19.920
> 
> 标签：asp.net, asp.net-mvc, validation, razor

我有一个父类和一个子类，父类有 1 个子类类型的成员。两个类都继承 IValidatableObject 并验证它们自己的属性，因为我希望子类可重用。

```
public class Parent : IValidateable
{
    Public ChildClass Child {get; set;}
    Public bool ValidateChild {get; set;}

     public IEnumerable<ValidationResult> Validate(ValidationContext validationContext)
    {
    }
}

public class Child : IValidatable
{
    Public string Name {get; set;}

   public IEnumerable<ValidationResult> Validate(ValidationContext validationContext)
    {
      //This shouldn't fire if parent.ValidateChild is false
    }
} 
```

问题是父类的子类属性应该只验证 ValiddateChild 属性是否为真

当 ValidateChild 为 false 时，如何防止子对象验证？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-08-13T19:05:16.100

一种方法是进行自定义验证，或者您可以检查一些像[这样](http://foolproof.codeplex.com/)的外部框架，看看这是否有帮助。

# ruby - 通过脚本设置带有 rvm 的 EC2 服务器

> ID：11940571
> 
> 赞同：2
> 
> 时间：2012-08-13T18:59:39.987
> 
> 标签：ruby, rvm, capistrano, rvm-capistrano

我正在寻找一种方法来安装 rvm，安装特定的 ruby​​ 版本（使用 rvm）并将这个安装的 ruby​​ 版本设置为默认值。在我可以安装 rvm 之前，我必须安装 gcc 和其他一些非常基本的软件包。到目前为止我已经尝试过：

1) 使用 net/ssh

*   我必须模拟一个伪 tty 才能 sudo 一些命令，到目前为止，我不知道如何从不成功的完整命令中区分成功的完整命令完成。
*   安装 rvm 后，我偶然发现了使用 rvm 的问题（“rvm 不是函数”，错误消息，导致无法设置默认的 ruby​​ 版本）。

2) 使用 capistrano

*   在 ssh 输出中插入了换行符，例如每次都会在新行中打印一个进度条，取得一些进展。这是我可以忍受的。

*   rmv 也有同样的问题，我可以安装 rvm，但我无法设置默认值：`rvm --default use 1.9.2`例如。没有错误消息，但是当我稍后登录时，没有设置默认值并`ruby -v`显示旧系统 ruby​​。

3) 使用 capistrano 和 rvm-capistrano

*   现在我遇到了问题，我在安装 rvm 之前尝试执行的那个任务失败了，因为似乎有一些魔法可以摆弄 shell 默认值：

> ```
>  * executing "sudo -p 'sudo password: ' yum install --assumeyes git gcc-c++ autoconf automake make patch zlib-devel libtool bzip2-devel"
>    servers: ["ec2-54-247-142-214.eu-west-1.compute.amazonaws.com"]
>    [ec2-54-247-142-214.eu-west-1.compute.amazonaws.com] executing command
> ** [out :: ec2-54-247-142-214.eu-west-1.compute.amazonaws.com] bash: /home/ec2-user/.rvm/bin/rvm-shell: No such file or directory
>     command finished in 2094ms
> failed: "rvm_path=$HOME/.rvm/ $HOME/.rvm/bin/rvm-shell 'default' -c 'sudo -p '\\''sudo password: '\\'' yum install --assumeyes git gcc-c++ autoconf automake make patch zlib-devel libtool bzip2-devel'" on ec2-54-247-142-214.eu-west-1.compute.amazonaws.com
> rake aborted! 
> ```

这里我发出安装 rvm/ruby 的命令：

```
run 'curl -L https://get.rvm.io | bash -s stable'
run 'rvm install ruby-1.9.2-p320'
run 'echo "[[ -s \"\$HOME/.rvm/scripts/rvm\" ]] && source \"\$HOME/.rvm/scripts/rvm\"" >> .bashrc'
run 'rvm --default use ruby-1.9.2-p320'
run 'which ruby && ruby -v' 
```

这里是作为响应发出的错误消息`rvm --default use 1.9.2`

```
RVM is not a function, selecting rubies with 'rvm use ...' will not work.
You need to change your terminal settings to allow shell login.
Please visit https://rvm.io/workflow/screen/ for example. 
```

4.1) 使用 capistrano 和 rvm-capistrano 并稍微修改一下

更新：在 RVM 聊天中 mpapis 的帮助下，我现在能够提出这个可行的解决方案：require "rvm/capistrano"

```
role :server, ENV[ 'base_image_setup_server' ] if ENV[ 'base_image_setup_server' ]

default_run_options[:pty] = true
default_run_options[:shell] = :bash

set :rvm_ruby_string, 'ruby-1.9.2-p320'
set :rvm_type, :user

def rvm_bin
    '$HOME/.rvm/bin/rvm'
end

namespace :images do

    task :install_basics do
        run "#{sudo} yum install --assumeyes git gcc-c++ autoconf automake make patch zlib-devel libtool bzip2-devel"
        run "#{sudo} yum update --assumeyes"
    end

    task :install_ruby do
        rvm.install_rvm
        rvm.install_ruby
        run "#{rvm_bin} alias create default #{rvm_ruby_string}"
        run 'echo "source ~/.rvm/environments/default" >> $HOME/.bashrc'
        run 'which ruby && ruby -v'
    end

    ... 

    desc 'build the base-image'
    task :base_image do 
        install_basics
        install_ruby
        install_boost
        install_rake_and_rack
        install_sioux
        test_sioux
    end 
```

主要区别在于，RVM*不是*作为函数使用，而是直接使用程序。

亲切的问候，托斯滕

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T21:27:18.923

检查 RVM 站点以获取 Capistrano 集成[https://rvm.io/integration/capistrano](https://rvm.io/integration/capistrano)

有安装 RVM 和 Ruby 的任务：

```
after 'deploy:setup', 'ubuntu:install'
after 'deploy:setup', 'rvm:install_rvm' # do it only with deploy setup
before 'deploy', 'rvm:install_ruby'     # do it on every deploy
namespace :ubuntu do
  desc "setup ubuntu system"
  task :install do
    run "apt-get install -y make ...", :shell => "sh"
    ...
  end
end 
```

你运行标准：

```
cap deploy:setup
cap deploy:cold 
```

此外，您可能想查看我的示例 Rails 应用程序以获取简单且有效的部署脚本：[https](https://github.com/mpapis/ad) ://github.com/mpapis/ad和我的博客文章： http: [//niczsoft.com/2012/03/使用 capistrano-rvm 和更多的快速部署/](http://niczsoft.com/2012/03/fast-deployment-using-capistrano-rvm-and-more/)

# salesforce - 使用 Apex 数据加载器将个人客户上传到 Salesforce 时遇到问题

> ID：11940572
> 
> 赞同：0
> 
> 时间：2012-08-13T18:59:42.483
> 
> 标签：salesforce

我正在尝试使用[此处](http://wiki.developerforce.com/page/Data_Loader)`PersonAccounts`提供的 Apex Data Loader 版本 25.0.1 将 ~15k 导入 Salesforce 。

我已经调用了 Salesforce 并`PersonAccounts`在我的`Organizaion`. 我已使用我的管理员凭据成功登录并导出了一个`RecordType`显示以下信息的 csv：

```
ID                  | NAME              | DEVELOPERNAME
01280000000Lsy4AAC  | Person Account    | PersonAccount
01280000000LsxzAAC  | Business Account  | Business_Account 
```

我创建了一个包含以下列的新 csv：

```
RECORDTYPEID
LASTNAME
FIRSTNAME
DESCRIPTION
PERSONMAILINGSTREET
PERSONMAILINGCITY
PERSONMAILINGSTATE
PERSONMAILINGPOSTALCODE
PERSONMAILINGCOUNTRY
PERSONHOMEPHONE
PERSONEMAIL 
```

并为列`01280000000Lsy4AAC`中的所有记录指定`RECORDTYPEID`。

当我尝试插入我的 csv 时，所有行都出现相同的错误：

```
Record Type ID: id value not valid for the users profile: 01280000000Lsy4AAC 
```

我究竟做错了什么？如何`PersonAccounts`使用 Apex 数据加载器上传？

**更新：**我已经尝试过[这里](http://salesforcevision.blogspot.com/2011/07/importing-person-accounts-into.html)`RecordTypeID`推荐的从 Web 界面的查询字符串中获取的方法（它在`RecordTypeID`没有“ACC”后缀的情况下为您提供相同的结果，但我仍然得到完全相同的错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-14T14:25:04.677

我必须在我的系统管理员配置文件中启用个人帐户

设置 -> 管理用户 -> 配置文件 -> 系统管理员，然后是对象设置，然后是帐户，并确保分配了人员记录类型。

[https://sites.secure.force.com/success/questionDetail?qid=a1X30000000duV6EAI](https://sites.secure.force.com/success/questionDetail?qid=a1X30000000duV6EAI)

# r - R将数据帧转换为输入文件-提高性能

> ID：11940573
> 
> 赞同：1
> 
> 时间：2012-08-13T18:59:44.633
> 
> 标签：r, loops, hash

我正在尝试将数据框从 R 转换为文本文件。

数据集约为 1500 x 700，循环遍历数据帧需要一段时间，我想知道是否有任何方法可以加快该过程。

我的数据框是这样的：

```
>train2
score   x1    x2    x3     x4     x5 ...  x700
  0     0      1     1      1     0        0
  1     0      1     0      0     0        0
  0     1      0     1      1     1        0
  3     0      1     1      1     0        0
  1     0      1     0      1     0        0
  2     1      1     1      1     0        1
  0     0      1     1      0     0        0
 ...    .      .     .      .     .        . 
```

在创建的文件中，我只包含非零的单元格。

所以第 1-3 行的输出将是：

```
0 | x2:1 x3:1 x4:1
1 | x2:1
0 | x1:1 x3:1 x4:1 
```

我当前的代码运行如下：

```
pt1 <- paste(train2$score," | ",sep="")
  collect1 <- c()
  for(j in 1:nrow(train2)){
    word1 <- pt1[j]
    for(i in 10:ncol(train2)){
      if(train2[j,i] !=0){
        word1 <- paste(word1,colnames(train2)[i],":",train2[j,i], " ", sep="")                        
      }      
    }  
    collect1 <- c(collect1, word1)
    if(j %% 100 == 0){
      print(j);flush.console()    
      gc()
    }    
  } 
```

每次运行大约需要 3-4 分钟。有什么明显的提高性能的吗？

编辑：循环完成后，生成的数据框`collect1`用于创建文本文件，使用：

```
 write(collect1, file="outPut1.txt") 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-13T20:11:56.213

尝试按如下方式对操作进行矢量化（我将“分数”放在一个单独的变量中，并将其从“train3”中删除，这样我就不必在匿名函数中对数据框进行子集化）：

```
score  <- train2$score
train3 <- train2[, -1]
cols   <- colnames(train3)
res <- apply(train3, 1, function(x) {
  idx  <- x != 0
  nms  <- cols[idx]
  vals <- x[idx]
  paste(nms, vals, sep=":", collapse=" ")
})

out <- paste(score, "|", as.vector(res))
print(out) 
```

# string - matlab中垂直矩阵中的字符串连接

> ID：11940586
> 
> 赞同：3
> 
> 时间：2012-08-13T19:00:21.450
> 
> 标签：string, matlab

我有一个垂直矩阵

```
names = {
11
22
33
44
55
} 
```

我想将相同的字符串连接到所有喜欢的人

```
names = {
11nere
22nere
33nere
44nere
55nere
} 
```

我怎么能在matlab中做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T19:07:47.343

这一个班轮应该做到这一点

```
names = cellfun(@(x)[num2str(x), 'nere'], names, 'uniformoutput', false); 
```

我假设`names`单元格数组包含数字条目而不是开头的字符串 - 否则它更简单，

```
names = cellfun(@(x)[x, 'nere'], names, 'uniformoutput', false); 
```

# javascript - Javascript 相当于 visual foxpro gomonth()

> ID：11940588
> 
> 赞同：0
> 
> 时间：2012-08-13T19:00:26.290
> 
> 标签：javascript, visual-foxpro

我的任务是为一个用 Visual Foxpro 编写的遗留应用程序编写一个 Web 门户。我必须验证怀孕到期日。规则是从当前日期起不能超过 9 个月。我已经试图争辩说这太模糊了，需要几天或几周的时间，但有人告诉我我必须模仿遗留软件。

以下是 VSP 中的代码正在执行的操作：

```
maxValueForDueDate = GOMONTH(DATE() , 9) 
```

根据[MSDN](http://msdn.microsoft.com/en-us/library/kfhds4cz%28v=vs.80%29.aspx) `GOMONTH()`处理边缘情况如下：

```
SET CENTURY ON
STORE GOMONTH({^1998-02-16}, 5) TO gdDeadLine

CLEAR
? gdDeadLine  && Displays 07/16/1998
? GOMONTH({^1998-12-31}, 2)  && Displays 02/28/1999
? GOMONTH({^1998-12-31}, -2)  && Displays 10/31/1998 
```

正如您所见，将 2 个月添加到 12 月 31 日不会导致 3 月 2 日，不幸的是，这正是以下 javascript 所做的：

```
var dDate = new Date('1998-12-31');
dDate.setMonth(dDate.getMonth() + 2);
alert(dDate.toDateString()); // results in - Tue Mar 02 1999 
```

有没有人有他们为这种情况编写的方便的 javascript 函数？我已经用谷歌搜索了，但没有找到我需要的东西。我的第三方使用受限于 JQuery。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T19:16:42.513

添加2 个“整月”（即 30 天 x 24 小时）中的*毫秒数（或秒数、小时数或天数）。*这个想法是改变整个日期，而*不仅仅是*单个 [月] 组件。[例如](http://jsfiddle.net/Xf538/1/)：

```
var a = new Date('1998-12-31')
var ms_in_month = 30 * (24 * 60 * 60) * 1000
var b_ticks = (+a) + 2 * ms_in_month
var b = new Date(b_ticks)
alert(b) // Sun Feb 28 1999 16:00:00 GMT-0800 (Pacific Standard Time) 
```

将`(+a)`Date 强制为一个数字，该数字导致自纪元以来*的毫秒数。*（这也可以写成[a.milliseconds](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date)）。然后[`new Date(millis_since_epoch)`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date)做相反的事情并从纪元偏移量创建一个日期。

**免责声明：**我不确定*确切的*规则[`GOMONTH`](http://msdn.microsoft.com/en-us/library/kfhds4cz%28v=vs.80%29.aspx)是什么，它可能使用“一个月中的 30.5 天启发式”（365/12 = 30.41）或其他变体。我*怀疑*它没有考虑月份持续时间（文档确实指出“-1 [月] 意味着 -31*天*”）或闰年..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T19:04:08.467

你可以看看开源的javascript日期库[Datejs](http://code.google.com/p/datejs/)

如果您无法添加此文件，您至少可以查看代码以了解如何处理边缘情况。

# r - R中的lapply和data.frame

> ID：11940590
> 
> 赞同：1
> 
> 时间：2012-08-13T19:00:32.433
> 
> 标签：r, histogram

我正在尝试使用 R 来根据需要接受尽可能多的用户输入文件，并获取这些文件并为每个文件制作一个直方图，该直方图存储在第 14 列中的值。我已经做到了这一点：

```
library("tcltk")
library("grid")
File.names<-(tk_choose.files(default="", caption="Choose your files", multi=TRUE, filters=NULL, index=1))
Num.Files<-NROW(File.names)
test<-sapply(1:Num.Files,function(x){readLines(File.names[x])})
data<-read.table(header=TRUE,text=test[1])
names(data)[14]<-'column14'
dat <- list(file1 = data.frame("column14"),
            file2 = data.frame("column14"),
            file3 = data.frame("column14"),
            file4 = data.frame("column14"))
#Where the error comes up
tmp <- lapply(dat, `[[`, 2)
lapply(tmp, function(x) {hist(x, probability=TRUE, main=paste("Histogram of Coverage")); invisible()})
layout(1) 
```

我的代码挂断了，虽然在声明`tmp <- lapply(dat,`[[`, 2)` 出现的错误是两件事之一。如果该行如上所示，则错误是：

```
Error in .subset2(x, i, exact = exact) : subscript out of bounds
Calls: lapply -> FUN -> [[.data.frame -> <Anonymous> 
```

我做了一些研究，发现它可能是由双 [[]] 引起的，所以我将其更改为`tmp <- lapply(dat,`[`, 2)`以查看它是否有任何好处（正如许多教程所说的那样），但这只是导致了这个错误：

```
Error in `[.data.frame`(X[[1L]], ...) : undefined columns selected
Calls: lapply -> FUN -> [.data.frame 
```

输入文件都将遵循以下模式：

```
Targ  cov  av_cov  87A_cvg  87Ag  87Agr  87Agr  87A_gra  87A%_1   87A%_3   87A%_5   87A%_10  87A%_20  87A%_30 87A%_40   87A%_50 87A%_75 87A%_100
1:028 400   0.42    400 0.42    1   1   2   41.8    0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
1:296 400   0.42    400 0.42    1   1   2   41.8    0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 
```

这是个常见的问题吗？谁能给我解释一下？我对R不太熟悉，但我希望继续学习。谢谢编辑：为了重现性，如果我运行：

```
head(test)
head(data)
x <- list(mtcars, mtcars, mtcars);lapply(x, head)
head(dat) 
```

这是结果：

```
 > head(test)
     [,1]                                                                                                                                               
[1,] "Targ  cov  av_cov  87A_cvg  87Ag  87Agr  87Agr  87A_gra  87A%_1   87A%_3   87A%_5   87A%_10  87A%_20  87A%_30 87A%_40\t87A%_50\t87A%_75\t87A%_100"
[2,] "1:028 400\t0.42\t400\t0.42\t1\t1\t2\t41.8\t0.0\t0.0\t0.0\t0.0\t0.0\t0.0\t0.0\t0.0\t0.0"                                                           
[3,] "1:296 400\t0.42\t400\t0.42\t1\t1\t2\t41.8\t0.0\t0.0\t0.0\t0.0\t0.0\t0.0\t0.0\t0.0\t0.0"                                                           
[4,] "1:453 1646\t8.11\t1646\t8.11\t7\t8\t13\t100.0\t100.0\t87.2\t32.0\t0.0\t0.0\t0.0\t0.0\t0.0\t0.0"                                                   
[5,] "1:427 1646\t8.11\t1646\t8.11\t7\t8\t13\t100.0\t100.0\t87.2\t32.0\t0.0\t0.0\t0.0\t0.0\t0.0\t0.0"                                                   
[6,] "1:736 5105\t29.68\t5105\t29.68\t14\t29\t48\t100.0\t100.0\t100.0\t86.0\t65.7\t49.4\t35.5\t16.9\t0.0\t0.0"                                          
> head(data)
 [1] Targ      cov       av_cov    X87A_cvg  X87Ag     X87Agr    X87Agr.1 
 [8] X87A_gra  X87A._1   X87A._3   X87A._5   X87A._10  X87A._20  X87A._30 
[15] X87A._40  X87A._50  X87A._75  X87A._100
<0 rows> (or 0-length row.names)
> x <- list(mtcars, mtcars, mtcars);lapply(x, head)
[[1]]
                   mpg cyl disp  hp drat    wt  qsec vs am gear carb
Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1
Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1
Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2
Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1

[[2]]
                   mpg cyl disp  hp drat    wt  qsec vs am gear carb
Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1
Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1
Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2
Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1

[[3]]
                   mpg cyl disp  hp drat    wt  qsec vs am gear carb
Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1
Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1
Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2
Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1

> head(dat)
$file1
  X.column14.
1    column14

$file2
  X.column14.
1    column14

$file3
  X.column14.
1    column14

$file4
  X.column14.
1    column14

> tmp <- lapply(dat, `[`, 2)
Error in `[.data.frame`(X[[1L]], ...) : undefined columns selected
Calls: lapply -> FUN -> [.data.frame
Execution halted 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T21:49:27.700

你想在这里做什么？

```
tmp <- lapply(dat, `[[`, 2) 
```

lapply 函数等价于

```
list(file1=dat[[1]][[2]],
     file2=dat[[2]][[2]],
     file3=dat[[3]][[2]],
     file4=dat[[4]][[2]]) 
```

这行不通。您正在尝试从只有 1 列的数据框中提取第 2 列。

将 dat 重新定义为这样，它将起作用。

```
dat <- list(file1 = data.frame("column14","iforgotcolumn2"),
            file2 = data.frame("column14","iforgotcolumn2"),
            file3 = data.frame("column14","iforgotcolumn2"),
            file4 = data.frame("column14","iforgotcolumn2")) 
```

# database - 在 Amazon VM 上上传 Postgres 数据库

> ID：11940594
> 
> 赞同：2
> 
> 时间：2012-08-13T19:00:45.680
> 
> 标签：database, postgresql, upload, amazon-ec2, virtual-machine

由于可用的存储空间和内存很少，我得到了一个我无法用我的电脑处理的数据库。

给我这个数据库的人给了我以下详细信息：

> 压缩文件大约15GB，未压缩大约85-90GB。恢复后将占用相似数量的空间，因此请确保您恢复它的机器至少有 220GB 的可用空间以确保安全。理想情况下，使用至少 8GB RAM 的机器——尽管即使是我们普通的 16GB RAM 服务器也可能难以处理推文表上的大型查询。
> 
> 您需要 PostgreSQL 8.4 或更高版本，并且您需要创建一个数据库以使用 UTF8 编码恢复（从命令行创建时使用 -E UTF8）。如果这是一个全新的 PostgreSQL 安装，我强烈建议您调整默认的 postgresql.conf 设置 - 使用 pgtune 实用程序（搜索 GitHub）为您的硬件获取一些合理的默认设置。默认值非常保守，如果不更改它们，您将看到糟糕的查询性能。

当我告诉他我的电脑有点糟糕时，他建议我使用**Amazon EC2 实例**。

**我的两个问题是：**

1.  如何将数据库上传到 Amazon VM？
2.  之后我该如何使用它？

如您所见，我对云服务和数据库一无所知。任何相关的教程将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T00:08:20.640

如果您不熟悉云托管，而不是直接使用 EC2，请考虑使用[EnterpriseDB 的云选项](https://aws.amazon.com/solution-providers/isv/enterprisedb)。[详情在这里](http://www.enterprisedb.com/cloud-database/pricing-amazon)。

如果您想直接使用 EC2，请注册并创建一个实例。

选择您喜欢的 Linux 发行版映像。我假设您将在 EC2 上使用 Linux；如果您想使用 Windows，那是因为您可能已经知道如何使用。让新的 VM 配置并启动，然后根据 Amazon 上针对 EC2 和该特定 VM 映像的文档通过 SSH 连接到它。根据其文档为该 VM 映像执行任何推荐的设置。

完成该实例的推荐设置后，您可以安装 PostgreSQL：

*   对于 Ubuntu，`apt-get install postgresql`
*   对于 Fedora，`yum install postgresql`
*   对于 CentOS，请使用[PGDG yum 存储库](http://wiki.postgresql.org/wiki/RPM_Installation)，*而不是*提供的过时版本的 PostgreSQL。

您现在可以作为默认`postgres`超级用户连接到 Pg：

```
sudo -u postgres psql 
```

并且能够像在任何其他计算机上一样使用 PostgreSQL。您可能希望为自己设置一个用户 ID 和一个新数据库以恢复到：

```
echo "CREATE USER $USER;" | sudo -u postgres psql
echo "CREATE DATABASE thedatabase WITH OWNER $USER" | sudo -u postgres psql 
```

当然，将“数据库”更改为您想要调用您的数据库的任何内容。

将转储恢复到新数据库的确切过程取决于转储格式。

对于`pg_dump -Fc`或 PgAdmin-III 自定义格式转储：

```
sudo -u postgres pg_restore --dbname thedatabase thebackupfile 
```

有关. [_](http://www.postgresql.org/docs/9.1/static/app-pgrestore.html) _`pg_restore`

对于纯 SQL 格式的转储，您需要通过解压缩程序将转储流式传输到 psql。由于您没有提及转储文件名或格式，因此很难知道该怎么做。我假设它是经过 gzip 压缩的（“.gz”文件扩展名），在这种情况下，您会执行以下操作：

```
gzip -d thedumpfile.gz | sudo -u postgres psql thedatabase 
```

如果其文件扩展名为“.bz2” ，则更`gzip`改为`bzip2`. 如果它是`.zip`您想要的`unzip`，然后`psql`使用`sudo -u postgres psql -f thedumpfilename`.

恢复后，您可以使用`psql thedatabase`.

# facebook - Facebook oAuth 身份验证安全性

> ID：11940595
> 
> 赞同：0
> 
> 时间：2012-08-13T19:00:46.410
> 
> 标签：facebook, facebook-graph-api

使用 JavaScript SDK 并发出登录请求，一旦我收到来自 Facebook 的请求响应，指出用户已“连接”，我可以确定此请求没有被劫持吗？

Facebook 提供了用于验证响应的应用程序密码，但在验证示例中，从未请求应用程序密码。

我正在寻找更多使用 JavaScript SDK 或 C# SDK 来安全地验证 facebook 用户的示例。

如果我不正确理解应用程序密码或 oAuth，请随时提出建议并解释为什么不需要应用程序密码，但从我读过的文档来看，这听起来很有必要。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T19:15:04.640

应用程序机密仅在*服务器端*使用，以确保响应是真实的。它不能在客户端使用（即：在 JavaScript 中），因为这需要将应用程序机密本身存储在您的 JavaScript 代码中，这将完全违背机密的目的（即，它将不再是机密）。

所以，是的，你的 JavaScript 请求可以被劫持，但这并不重要。只要您将您的密钥用于服务器端请求（例如，更新 MySQL 数据库）就可以了。

# php - get_meta_tags 和波斯语短语

> ID：11940597
> 
> 赞同：1
> 
> 时间：2012-08-13T19:00:54.897
> 
> 标签：php

我用过这个功能，

```
 $code = get_meta_tags('http://www.narenji.ir/'); 
```

我见过这个

```
 'Ù…Ú©Ø§Ù†ÛŒ Ø¨Ø±Ø§ÛŒ Ø¢Ø´Ù†Ø§ÛŒÛŒ Ø¨Ø§ Ø§Ø¨Ø²Ø§Ø±Ù‡Ø§ Ùˆ Ø§Ø®Ø¨Ø§Ø± Ø¯Ø§Øº Ø¯Ù†ÛŒØ§ÛŒ ÙÙ†Ø§ÙˆØ±ÛŒ' 
```

我该如何解决这个问题？我可以在不使用 JSON 的情况下修复它吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T19:11:43.720

您必须在这里缺少一些链接，您的代码才有效：

*   [例子](http://codepad.viper-7.com/1iMNak)

关键是您*保留*UTF-8 编码以便支持波斯语。否则，您将需要一些其他支持波斯语的编码（我还不知道）和一个能够重新编码的库。

您想为波斯语输出使用哪种编码？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T19:14:14.230

如果您从浏览器执行脚本，请确保发送 UTF-8 作为内容编码。在回显任何内容*之前*添加`Content-Type`标题。

 *```
header('Content-Type:text/html; charset=utf-8'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T19:12:11.083

`utf8_decode()`专为从 UTF-8 转换为 ISO-8859-1 (latin1) 而构建。波斯字符不在 Latin1 中，那你为什么觉得这里有必要？

工作示例：[http ://codepad.viper-7.com/tEjZAz](http://codepad.viper-7.com/tEjZAz)*

# actionscript-3 - 在 Flex、Air、AS3 中对窗口应用效果

> ID：11940603
> 
> 赞同：0
> 
> 时间：2012-08-13T19:01:10.200
> 
> 标签：actionscript-3, apache-flex, air, window, effect

我正在寻找使用动画弹出窗口**影响。**

 **问题是效果应用于弹出窗口的内容，而不是弹出窗口本身（包括标题栏、最小化、最大化按钮等）

看看这里的结果..

![动画的结果](../Images/ad2617433e9bb008c2d96ba5923e8521.png)

我的代码非常简单且合乎逻辑，如果可以为窗口设置动画，应该可以工作。

```
<?xml version="1.0" encoding="utf-8"?>
<s:WindowedApplication xmlns:fx="http://ns.adobe.com/mxml/2009" 
    xmlns:s="library://ns.adobe.com/flex/spark" 
    xmlns:mx="library://ns.adobe.com/flex/mx">

    <fx:Script>
        <![CDATA[
            import comps.MyWin;

            [Bindable]
            private var _win:MyWin;

            protected function openPopup():void
            {
                _win = new MyWin();
                _win.width = 300;
                _win.height = 300;
                _win.open();    
            }

            protected function animatepopup():void
            {
                MyEffect.play();
            }

        ]]>
    </fx:Script>

    <fx:Declarations>
        <s:Move id="MyEffect" xFrom="{_win.x}" xTo="{_win.x + 150}" target="{_win}"/>
    </fx:Declarations>

    <s:layout>
        <s:VerticalLayout/>
    </s:layout>

    <s:Button label="Open" click="openPopup()"/>

    <s:Button label="Animate" click="animatepopup()"/>

</s:WindowedApplication> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T19:05:32.033

我认为您需要定位对象的[`NativeWindow`](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/display/NativeWindow.html)实例才能移动对象并调整其大小。

因此，替换`_win.myProperty`为`_win.stage.nativeWindow.myProperty`：

```
<s:Move id="MyEffect" xFrom="{_win.stage.nativeWindow.x}" xTo="{_win.stage.nativeWindow.x + 150}" target="{_win.stage.nativeWindow}"/> 
```

然后，动画将影响`NativeWindow`而不是窗口的内部。**

# r - 在 data.table 中选择列的子集

> ID：11940605
> 
> 赞同：32
> 
> 时间：2012-08-13T19:01:16.097
> 
> 标签：r, data.table

我想打印数据表的所有列，`dt`除了其中一个被命名`V3`但不想按数字而是按名称引用它。这是我拥有的代码：

```
 dt = data.table(matrix(sample(c(0,1),5,rep=T),50,10))
  dt[,-3,with=FALSE]   #  Is this the only way to not print column "V3"? 
```

使用这种`data frame`方式，可以通过代码做到这一点：

```
 df = data.frame(matrix(sample(c(0,1),5,rep=T),50,10))
  df[,!(colnames(df)%in% c("X3"))] 
```

所以，我的问题是：是否有另一种方法可以不打印数据表中的一列而无需按数字引用它？我想找到类似于我上面使用的数据框语法但使用数据表的东西。

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2012-08-13T19:09:20.830

使用与 a 非常相似的语法`data.frame`，但添加参数`with=FALSE`：

```
dt[, setdiff(colnames(dt),"V9"), with=FALSE]
    V1 V2 V3 V4 V5 V6 V7 V8 V10
 1:  1  1  1  1  1  1  1  1   1
 2:  0  0  0  0  0  0  0  0   0
 3:  1  1  1  1  1  1  1  1   1
 4:  0  0  0  0  0  0  0  0   0
 5:  0  0  0  0  0  0  0  0   0
 6:  1  1  1  1  1  1  1  1   1 
```

* * *

的使用在参数`with=FALSE`的文档中得到了很好的解释：`j``?data.table`

*j：单个列名、单个列名`list()`表达式、列名表达式、计算结果为 list 的表达式或函数调用（也包括列表`data.frame`和`data.table`列表），或`with=FALSE`与 j in 相同的（何时）`[.data.frame`。*

* * *

从*v1.10.2*开始，也可以按如下方式执行此操作：

```
keep <- setdiff(names(dt), "V9")
dt[, ..keep] 
```

前缀符号`..`将在调用范围（即全局环境）中查找，其值被视为列名或数字（[source](https://github.com/Rdatatable/data.table/blob/master/NEWS.md#new-features-1)）。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-08-13T19:30:30.627

使用更现代的方法编辑 2019-09-27

您可以`patterns`按照上述方法执行此操作；或者，`!`如果已经有名称向量，您可以这样做：

```
dt[ , !'V3']
# or
drop_cols = 'V3'
dt[ , !..drop_cols] 
```

`..`意思是“向上一层”

* * *

旧版本使用`with=FALSE`(`data.table`正在稳步远离这个论点)

这是一种`grep`用于转换为数字并允许负列索引的方法：

```
dt[, -grep("^V3$", names(dt)), with=FALSE] 
```

您确实说过要排除“ V3”，对吗？

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2016-02-11T22:25:23.260

也许它只在最新版本的 data.table 中（我使用的是 1.9.6），但你可以这样做：

```
dt[, -'V3'] 
```

对于几列：

```
dt[, -c('V3', 'V9')] 
```

请注意，变量名称周围的引号是必要的。此外，如果您的列名存储在变量中，例如`cols`，您需要执行`dt[, -cols, with=FALSE]`.

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2019-01-17T07:23:00.907

从 1.12.0 版本开始，还可以在名称上使用正则表达式来选择列：

```
iris_DT <- as.data.table(iris)

iris_DT[, .SD, .SDcols = patterns(".e.al")] 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2021-12-04T17:10:34.127

总结这个问题的答案，并使其
a）否定友好（这样您也可以通过否定选择列），
b）管道友好（以便您可以在具有 %>% 运算符的管道中使用) 和
c) 以便您可以同时使用列号和列名进行选择，这些是可用选项：

```
library(data.table);

select1 <- function (dt, range)  dt[, range, with=F]
select2 <- function (dt, range)  dt[, ..range]
select3 <- function (dt, range)  dt[, .SD, .SDcols=range] 

dt <- ggplot2::diamonds

range <- 1:3 # or 
range <- dt %>% names %>% .[1:3]

dt %>% select1(range);
dt %>% select2(range); 
dt %>% select3(range); 

dt %>% select1(-range);
dt %>% select2(-range); 
dt %>% select3(-range); # DOES NOT WORK

Also we note that this
dt %>% .[, ..(names(dt)[1:3])] # DOES NOT WORK 
```

因此，选择多个列的最佳（最通用和快速）方法`data.table`如下：

```
# columns are selected using column numbers:
range <- 1:3
dt %>% select1(range); 
dt %>% .[, range, with=F]

# The same works if columns are selected using column names:
range <- names(dt) [1:3]
dt %>% select1(range); 
dt %>% .[, range, with=F] 
```

PS。如果不是选择多个列，而是希望通过引用有效地从 data.table 中删除多个列（即，而不是复制整个 data.table），那么您可以使用 data.table 的`:=`运算符。但我不知道如何对一行中的多个列执行此操作

# grails - 将项目复制到 Windows 后找不到控制器方法

> ID：11940606
> 
> 赞同：0
> 
> 时间：2012-08-13T19:01:34.183
> 
> 标签：grails

我正在使用 Mac 开发网站。但我得到了相同的项目和相同的结构，并将其全部复制到我的 Windows PC 上。完成所有配置后，我尝试执行该项目。

一切正常，但找不到一个控制器。该控制器渲染存储在数据库中的图片并将其提供给 img html 标签以将其渲染回来。

即使我尝试直接从 URL 执行，此控制器和所涉及的方法也可以在 Mac 上执行，但是在这台其他计算机中找不到它，并且输出是 HTTP 404 错误页面。

控制器代码：

```
class PhotoController {

    /**
     * Renderiza a foto em destaque de um evento
     */
    def renderMainImage() {
        if (params.id) {
            def photo = Photo.findByEventAndMain(Event.findById(params.id), true)

            if (photo?.resource) {
                response.setContentLength(photo.resource.length)
                response.outputStream.write(photo.resource)
            } else {
                //TODO renderizar com uma imagem padrão
                return null
            }

        }
    }

} 
```

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T09:05:19.727

您能否更具体地说明您如何“找不到”它？就像你的意思是在文件系统上还是在你的 IDE 的资源管理器中？另外请告诉您使用的是什么IDE。

# jquery - 为什么我的切换不能正确转换

> ID：11940611
> 
> 赞同：0
> 
> 时间：2012-08-13T19:02:09.247
> 
> 标签：jquery, toggle, effect

一切都在这里“工作”，但我的动画没有正确显示。我希望切换按钮在导航消失时向上移动，但“慢”不起作用。

查询：

```
//Close and open
$(document).ready(function(){
$(".open, .close").click(function(){
    $(".navigation").slideToggle("slow");
    $(".open").toggle();
    $(".close").toggle();
    $(".navigation").css("display","inline");
    $(".collapse").toggleClass("collapse-closed","slow");
  });
}); 
```

CSS

```
.open{
    display:block;
    margin: 12px auto 0px;
    padding:0px;
    width: 0; 
    height: 0; 
    border-left: 13px solid transparent;
    border-right: 13px solid transparent;
    border-top: 13px solid #9b9b9b;
    transition: all 0.3s;
    -moz-transition: all 0.3s; /* Firefox 4 */
    -webkit-transition: all 0.3s; /* Safari and Chrome */
    -o-transition: all 0.3s; /* Opera */
    cursor: pointer;
}
.open:hover{
    border-top: 13px solid #A70400;
    }
.close{
    display:none;
    margin: 10px auto 0px;
    padding:0px;
    width: 0; 
    height: 0; 
    border-left: 13px solid transparent;
    border-right: 13px solid transparent;
    border-bottom: 13px solid #9b9b9b;
    transition: all 0.3s;
    -moz-transition: all 0.3s; /* Firefox 4 */
    -webkit-transition: all 0.3s; /* Safari and Chrome */
    -o-transition: all 0.3s; /* Opera */
    cursor: pointer;
}
.close:hover{
    border-bottom: 13px solid #A70400;
}
.collapse {
    background-color: #f6f6f6;
    border-radius: 4px;
    border: 1px solid #919191;
    -moz-box-shadow: 0 2px 4px #bdbdbd;
    -webkit-box-shadow: 0 2px 4px #bdbdbd;
    box-shadow: 0 2px 4px #bdbdbd;
    z-index:8;
    width: 46px;
    height: 36px;
    margin-bottom: -40px;
    right: 20px;
    position: fixed;
    top: 24px;
}
.collapse-closed {
    top: -8px;
}

.navigation {
    border-bottom: 1px solid #919191;
    -moz-box-shadow: 0 2px 4px #bdbdbd;
    -webkit-box-shadow: 0 2px 4px #bdbdbd;
    box-shadow: 0 2px 4px #bdbdbd;
    position: fixed;
    z-index: 7;
    background-color: #f6f6f6;
    width: 100%;
    margin: 0 auto;
    line-height: 0em;
    padding-top: 10px;
    padding-bottom: 10px;
}

.navigation ul {
    text-align: center;
    line-height: 0;
    margin: 10px 0;
}

.navigation ul li {
    display: inline;
    border-top-style: none;
    padding-top: 5px;
    padding-bottom: 5px;
    transition: all 0.5s;
    -moz-transition: all 0.5s; /* Firefox 4 */
    -webkit-transition: all 0.5s; /* Safari and Chrome */
    -o-transition: all 0.5s; /* Opera */
    border-bottom: 4px solid rgba(167, 4, 0, 0);
    margin-right: 8px;
    margin-left: 8px;
}

.navigation ul li:hover,
.navigation ul li:active {
    display: inline;
    border-bottom: 4px solid #A70400;
}

.navigation li a {
    text-decoration: none;
} 
```

HTML

```
<div class="navigation">
        <ul>
            <li><a href="#ems">About Me</a></li>
            <li><a href="#ems">Writing Samples</a></li>
            <li><a href="#ems">Musings</a></li>
            <li><a href="#ems">Books</a></li>
        </ul>

    </div>
    <div class="collapse">
        <div class="open"></div>
        <div class="close"></div>
    </div> 
```

我是否以某种方式阻止了过渡速度？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T19:15:39.100

将 jQuery UI 添加到您的页面，它将允许您对类更改进行动画处理（对于 jQuery 1.8，使用[UI 1.8.22 ）。](http://ajax.aspnetcdn.com/ajax/jquery.ui/1.8.22/jquery-ui.min.js)您的代码将与 UI 扩展一起正常工作。

[**小提琴**](http://jsfiddle.net/ult_combo/3AJUB/1/)

如果没有 UI，您将无法为类更改设置动画。[`animate()`](http://api.jquery.com/animate/)您可以通过传递属性来替换这些类更改`top`，如下所示：

```
$(".collapse").animate({top: ($('.collapse').css('top') === '-8px') ? 24 : -8}, 'slow'); 
```

[**小提琴**](http://jsfiddle.net/ult_combo/3AJUB/3/)

# scala - Scala 和 SLF4J:: 传递多个参数

> ID：11940614
> 
> 赞同：7
> 
> 时间：2012-08-13T19:02:18.503
> 
> 标签：scala, slf4j, variadic-functions

具有以下代码： log.info("parameters {} and {}", param1, param2) 编译并与 Scala 中的 SLF4J 配合良好

但是，如果我想传递更多参数，我需要使用 Array：

```
log.info("parameters {} and {} and {}", Array(param1, param2,param3)) 
```

它只是用 array.toString 替换第一个参数，其余参数未绑定。

以下代码

```
log.info("parameters {} and {} and {}", Array(param1, param2,param3) : _*) 
```

不编译，因为：

```
error: overloaded method value info with alternatives:
(org.slf4j.Marker,java.lang.String)Unit <and>
(java.lang.String,java.lang.Throwable)Unit <and>
(java.lang.String,Array[java.lang.Object])Unit <and>
(java.lang.String,Any)Unit
cannot be applied to (java.lang.String, Any)
log.info("parameters {} and {} and {}", Array(param1, param2,param3) : _*) 
```

我在这里想念什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T14:39:41.427

我想这一切都取决于推断的类型。采用数组的 log.info 方法需要一个 Array[AnyRef]。所以作为演员的替代品，你可以做

```
log.info("parameters {} and {} and {}", Array[AnyRef](1, 2, "a"): _*) 
```

但这不起作用，因为 Int -> AnyRef 之间的隐式转换存在限制。对于那些，你需要一个类型归属：

```
log.info("parameters {} and {} and {}", 
   Array[AnyRef](1: Integer, 2: Integer, "a"): _*) 
```

有关详细信息，请参阅此问题：[隐式转换的结果类型必须比 AnyRef 更具体](https://stackoverflow.com/questions/26546299/result-type-of-an-implicit-conversion-must-be-more-specific-than-anyref)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-13T21:04:04.560

您应该为 slf4j 使用 scala 包装器，例如[grizzled](http://software.clapper.org/grizzled-slf4j/)

如果你没有绑定到 slf4j，你应该看看[Logula](https://github.com/codahale/logula)。我最近一直在玩它，我喜欢它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-18T17:34:07.660

如果你使用字符串插值呢？像这样：

```
log.info(f"parameters ${param1} and ${param2} and ${param3}") 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-08-13T21:15:51.443

Try this:

```
Array(...).asInstanceOf[Array[Object]] 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2014-03-25T19:54:20.757

这是我的做法。

LOGGER.info("encode: {}, code: {}, length: {}", Array(messageWrapper, methodCode, bytes.length).asInstanceOf[Array[AnyRef]])

干杯

# mysql - 将 tomcat 和 mysql 从一个 Amazon EBS 卷复制到另一个

> ID：11940621
> 
> 赞同：1
> 
> 时间：2012-08-13T19:02:37.503
> 
> 标签：mysql, tomcat, amazon-ec2, amazon-web-services, amazon-ebs

我启动了一个使用 Amazon Linux 和 Amazon-EBS 作为根卷的 Amazon EC2。我还在这个 EBS 卷上启动了 tomcat7 和 mysql 5.5。

后来我决定从 Amazon Linux 改为 Ubuntu。为此，我需要使用新的 EBS 根卷启动另一个 Amazon EC2 实例。现在我想将旧 EBS 卷中的 tomcat7 和 mysql 复制到新卷中。我在 mysql 中有不想丢失的表和数据以及在 tomcat 上运行的应用程序。怎么办？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T19:20:32.713

一些想法和建议。

首先，如果您要在数据库上承受任何类型的重大负载，那么在 EBS 支持的卷上运行它可能不是一个好主意，因为 EBS 支持的存储相对于机器的本地/临时存储 (/mnt) 非常慢）。现在显然你不希望数据库数据在临时存储上，所以如果你想在 EC2 上运行 MySQL，你真的无能为力。因此，如果您的基础架构要求允许，我的建议是为您的数据库使用 RDS 实例。

其次，如果这是一个生产应用程序，那么在进行此转换时，您无疑会有一些停机时间。问题是您是否需要绝对减少停机时间。如果是这样，那么您需要了解数据库的大小。转储/加载需要很长时间吗？如果没有，您可能只是让您的新实例启动并运行，并在数据库的旧副本上进行测试，然后在切换时转储并加载当前数据库。

如果它是一个大型数据库，那么也许您可以打开 MySQL 二进制日志记录。然后在已知的二进制日志位置转储数据库。然后在您的新实例上安装此转储。然后，当准备好切换时，您可以在新实例上重放二进制日志以使其处于最新状态。同样，您可以将新实例上的数据库设置为副本，直到切换，此时您将其设为主实例。

如果您不想弄乱二进制日志记录，您甚至可以考虑只使用 rsync 来同步物理数据库文件，但如果您不熟悉处理实际的物理数据库文件，这可能是一个有问题的方法。

就您的应用程序而言，假设它只是一个文件集合，那么迁移应该要简单得多。我不会复制 Tomcat7 安装本身，而只是在 Ubuntu 上安装 Tomcat，然后调整配置以匹配当前。

就切换本身而言，这应该非常简单，并且方法会有所不同，具体取决于您是为服务器使用弹性 IP 还是在负载均衡器后面，

# objective-c - iOS 音乐应用的音频框架

> ID：11940624
> 
> 赞同：2
> 
> 时间：2012-08-13T19:02:54.123
> 
> 标签：objective-c, ios, frameworks, core-audio

所以我正在构建一个小应用程序，它有一个键盘和一些触发音频样本的其他按钮。

对于这个应用程序，有几个预先录制的音轨（鼓、人声、吉他）可以静音/取消静音......我让这部分与 AVAudioPlayer 一起工作正常

但是，正如你们大多数人所知，AVAudioPlayer 有点慢，并且如果它被指定为触发击鼓或合成器的小音频样本，则会有一些延迟。所以我实现了 SystemSoundServices 来播放短声音样本。就按下按钮和播放声音之间的延迟而言，它工作正常，但我有一个小问题。说采样时，重复按两次，您会听到轻微的爆裂声，这是意料之中的，因为当第二次按下按钮时，它会切断第一个采样的播放。

我想通过基本上检测是否正在播放样本来解决这个问题，如果是，则将音量设置为0，停止播放，然后再次播放样本。但遗憾的是 systemsoundservices 没有内置此功能。 AVAudioPlayer 有，但速度太慢。我知道有 CoreAudio、AudioQueue、Open AL，但是对于我需要做的事情来说，这些似乎都太复杂了。我不需要做任何类型的音频处理。

有没有人对不需要编写 100 行代码来播放短音频剪辑的音频框架有任何建议？一切似乎都在告诉我要花数周时间学习 CoreAudio/AudioQueue/OpenAL，而这似乎是在浪费我正在做的事情的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T19:12:34.510

您可以使用`AUSampler`采样器。当然，它比 SystemSounds 更复杂。这`AUSampler`是系统提供的 AudioUnit。所以你需要做一些程序化的 AU 配置，但困难的事情是遥不可及的。

您可以使用`AudioFile`and`ExtAudioFile`来读取和创建音频文件。对于 AUSampler，它知道如何加载样本（以可用格式的子集），因此您甚至不需要编写文件 i/o 部分。

对于更复杂的音频，您可能需要自己处理音频流。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T19:13:56.900

你没有提到你的音轨是否被压缩，但如果它们很短，你可以尝试使用 .wav 或其他未压缩的格式。AVAudioPlayer 不必花时间开始解压缩它们。它仍然有一个短暂的延迟，但它没有 MP3 长。

除此之外，我认为屈从并学习较低级别的框架之一将是您需要做的。

如果您喜欢，这里是 OpenAL 的简单介绍：http: [//benbritten.com/2008/11/06/openal-sound-on-the-iphone/](http://benbritten.com/2008/11/06/openal-sound-on-the-iphone/)

**编辑：**另外-您在`prepareToPlay`调用之前使用方法调用`play`，对吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-29T01:53:43.587

我的解决方案如下。我创建了三个具有相同 URL 的 Avaudio 播放器。当我要开始播放声音时，我使用属性 isPlaying 来确定播放哪个 Avaudio。声音使用方法 performSelector:WithObject:AfterDelay 淡出。当声音逐渐消失时，用户可以再次弹奏键盘和第二个 Avaudio，依此类推。

您需要的 Avaudio 数量取决于您淡出声音的速度以及您希望用户能够播放的速度。

# javascript - 从 htm 中设置 js 函数的变量

> ID：11940628
> 
> 赞同：0
> 
> 时间：2012-08-13T19:03:31.963
> 
> 标签：javascript, html

我正在创建一个简单的函数，当用户即将关闭网页时会发出警告。我使用的 window.onbeforeonload 函数是 javascript。我正在做的是，由于邪恶的 window.onbeforeonload 函数，我将一个变量设置为 false。

```
function funky() {
var submitFormOkay = false;
window.onbeforeunload = function () {
    if (submitFormOkay == false) {
        return "You are about to leave this order form. You will lose any information...";
    }
}
} 
```

在我的 html 中，这就是我正在做的

```
<input type="submit" id="submit_button" onclick="submitFormOkay = true;"> 
```

然而，我的问题是我需要一种方法来触发函数 funky()。我知道我可以使用 onclick 但如果我这样做会设置 submitFormOkay 的值。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T19:05:02.850

为什么不`submitFormOkay`给函数做一个参数`funky`，然后用给定的参数调用它呢？

```
<input type="submit" id="submit_button" onclick="funky(true);"> 
```

在 JS 文件中：

```
function funky(submitFormOkay) {
     window.onbeforeunload = function () {
        if (submitFormOkay == false) {
           return "You are about to leave this order form. You will lose any information...";
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T19:16:42.937

在不更改您的 HTML 的情况下，我会这样做：

```
window.onbeforeunload = (function(w) {
    w.submitFormOkay = false;
    return function() {
        if (!w.submitFormOkay) {
            return "You are about to leave this order form. You will lose any information...";
        }
    };
})(window); 
```

ngmiceli 解决方案的一个问题是，`window.onbeforeunload`在用户可以离开页面之前，永远不会定义回调。

# uml - 客户端/服务器通信图

> ID：11940629
> 
> 赞同：0
> 
> 时间：2012-08-13T19:03:32.983
> 
> 标签：uml, client-server, diagram

我正在编写一个客户端/服务器应用程序。现在我想做一些关于通信的基本图，但我不知道我应该选择哪种 UML 图。它应该是非常基本的，无需过多详细说明，只有基本程序。

我想到的唯一图表是序列图，但我认为它不适合此目的。

我忘记了图表吗？或者没有适合这个的UML图？你会建议我使用什么样的图表？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T19:33:58.957

使用序列图有什么问题？

```
..................................................
..+------------+......+------------+..............
..|  *:Client  |......|  *:Server  |..............
..+------+-----+......+------+-----+..............
.........|...................|....................
.......+-+-+...............+-+-+..................
.......|   |.doSomething().|   |..................
.......|   +==============>+   +==+..............
.......|   |...............|   |..|...............
.......|   |...<<return>>..|   |..|...............
.......|   +<--------------+   +<=+...............
.......|   |...............|   |..................
.......+-+-+...............+-+-+..................
.........|...................|....................
.........X...................X....................
.................................................. 
```

在我看来，使用这些图表是可以的。

干杯。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-14T09:00:15.540

好吧，这在一定程度上取决于您要记录的内容：

*   如果是消息顺序，序列图确实是要走的路
*   如果重点是谁与谁交换消息（可能还有他们在通信中的角色），请使用[通信图](http://en.wikipedia.org/wiki/Communication_diagram "通讯图")
*   如果你想描述客户端和服务器之间可以交换哪些消息（即消息API），使用[组件图](http://en.wikipedia.org/wiki/Component_diagram "组件图")来描述一般的客户端/服务器接口和类图来充实接口的消息细节。

# javascript - 在表格和报告中表示 CSV 文件数据的工具

> ID：11940630
> 
> 赞同：0
> 
> 时间：2012-08-13T19:03:33.850
> 
> 标签：javascript, php, csv, report

*   我有一个 CSV 文件，其中包含所有用户与我的网络应用程序交互的数据。
*   我想用表格（统计）和统计数据来表示这些数据。
*   任何人都可以建议我使用工具或 API 来实现这一目标吗？
*   一个独立的工具或 PHP/JS 库对我有用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T19:11:26.373

对于您的网格（表格）

*   [http://www.datatables.net/index](http://www.datatables.net/index)
*   列表：[https ://stackoverflow.com/questions/159025/jquery-grid-recommendations](https://stackoverflow.com/questions/159025/jquery-grid-recommendations)

对于您的图表：

*   [http://www.jqplot.com/](http://www.jqplot.com/)

对于统计数据：

*   使用简单的数学运算，例如 var1+var2/100
*   或更详细：[https ://github.com/jstat/jstat](https://github.com/jstat/jstat)

对于 CSV 数据存储：

*   使用 PHP [http://php.net/manual/de/function.fgetcsv.php](http://php.net/manual/de/function.fgetcsv.php)
*   或者使用 javascript 来解析它：[Javascript code to parse CSV data](https://stackoverflow.com/questions/1293147/javascript-code-to-parse-csv-data)

# ruby-on-rails - Rails：从 Active Record 会话存储迁移到 Redis 存储

> ID：11940633
> 
> 赞同：4
> 
> 时间：2012-08-13T19:03:49.777
> 
> 标签：ruby-on-rails, session, redis

我有一个大型应用程序，有数千个活动会话。我想使用[这个](https://github.com/jodosha/redis-store/tree/master/redis-rails)迁移到 Redis 会话存储。理想情况下，我希望我当前的会话保持活跃。

有没有人有迁移活动会话的经验。我假设我编写了迁移或 rake 任务（我认为迁移，因此我可以删除旧表作为其中的一部分），并且我只想将所有当前详细信息写入 redis。

```
old_sessions = ActiveRecord::Base.connection.select_all("select * from sessions")
old_sessions.each { |session| $redis.set(????? ????) } 
```

但我担心数据完整性。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-13T23:50:10.373

好吧，经过一天的修改，这就是我想出的：

```
class MoveActiveRecordSesionsIntoRedis < ActiveRecord::Migration
  def up
    #get all the sessions from the last month
    old_sessions = ActiveRecord::Base.connection.select_all("select * from sessions where updated_at > '#{Time.now - 1.month}'")

    old_sessions.each do |session|

      #convert the base64 data back into the object
      data = ActiveRecord::SessionStore::Session.unmarshal(session["data"])

      #load each session into Redis, dumping the object appropriately      
      $redis.setex session["session_id"], 
                   1.month.to_i, 
                   Marshal.dump(data).to_s.force_encoding(Encoding::BINARY)
    end

    #drop the old session table (So long unecessary 3Gigs!)
    drop_table :sessions
  end

  def down
    raise ActiveRecord::IrreversibleMigration, "Session face-plant!"
  end
end 
```

我把这个放在这里作为参考。或者，如果您发现它有问题，我会全神贯注。

# objective-c - 无效的上下文 0x0

> ID：11940635
> 
> 赞同：0
> 
> 时间：2012-08-13T19:04:05.527
> 
> 标签：objective-c, cgcontext

我在`-drawRect`视图中有这个方法：

```
CGContextRef context = UIGraphicsGetCurrentContext();
CGContextSetLineWidth(context, 1.0);
for (int i=0; i<[points count]; i++) {
    GraphPoint* point = [points objectAtIndex:i];
    [point.color setFill];
    [[UIColor blackColor] setStroke];
    CGContextBeginPath(context);
    CGContextAddArc(context, point.x+point.size/2, point.y+point.size/2, point.size, 0, 2*M_PI, 0);
    CGContextFillPath(context);
    CGContextStrokePath(context);
    UIGraphicsPopContext();
} 
```

当`[points count]`等于 1 时，一切正常，但是，当它增加时，会抛出此错误：

`Error>: CGContextSetStrokeColorWithColor: invalid context 0x0.`

我认为循环有问题 - 它设置了上下文的颜色两次甚至更多次。不知道如何避免。每个点都必须有自己的颜色，我不能在循环之前设置上下文的填充颜色。

请帮忙！也许有人曾经遇到过这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T19:18:48.380

您误解了 UIGraphicsPopContext 的作用。我假设您正在尝试清除在上下文中设置的当前路径。你想要`CGContextSaveGState`和`CGContextRestoreGState`。

尝试这个：

```
CGContextRef context = UIGraphicsGetCurrentContext();
CGContextSetLineWidth(context, 1.0);
for (int i=0; i<[points count]; i++) {
    CGContextSaveGState(context);
    {
        GraphPoint* point = [points objectAtIndex:i];
        [point.color setFill];
        [[UIColor blackColor] setStroke];
        CGContextBeginPath(context);
        CGContextAddArc(context, point.x+point.size/2, point.y+point.size/2, point.size, 0, 2*M_PI, 0);
        CGContextFillPath(context);
        CGContextStrokePath(context);
    }
    CGContextRestoreGState(context);
} 
```

注意我通常在使用基于堆栈的操作（推送和弹出）时创建一个新范围（带有额外的`{`and `}`），以便轻松检查它们是否平衡。当然，这是可选的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T19:11:37.637

您在每个循环上弹出上下文，但您不推送它。所以你的上下文堆栈上的上下文用完了。

删除 UIGraphicsPopContext 调用，看看它是否修复它。

# android - 如何将数据从广播接收器发送到android中的活动

> ID：11940637
> 
> 赞同：3
> 
> 时间：2012-08-13T19:04:10.837
> 
> 标签：android, broadcastreceiver

这就是我想要做的。我创建了一个广播接收器类，它通过 callrecieve 活动检测来电。现在，一旦有电话，我想找到它的当前时间并通过另一个活动显示它。我已经为此使用了意图。但是我仍然没有得到所需的时间值，当我接到电话时会显示出来。我已经发布了我正在使用的所有代码。任何帮助都会很棒

这是广播接收器活动，它检查电话状态是否有来电，并负责广播意图

```
package com.mohit;

import android.app.Activity;
import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;
import android.os.Bundle;
import android.telephony.TelephonyManager;
import android.util.Log;

public class callreceive extends Activity {
public class receive extends BroadcastReceiver {

    long start_time,end_time,dif_sec;
    int flag=0;

  @Override
  public void onReceive(Context context, Intent intent) {
    Bundle extras = intent.getExtras();
    if (extras != null) {
      String state = extras.getString(TelephonyManager.EXTRA_STATE);

      Log.w("DEBUG", state);
      if ((state.equals(TelephonyManager.EXTRA_STATE_IDLE))&&flag==0) 
      {
        flag=1;
        start_time=System.currentTimeMillis();
        Intent intent1 = new Intent();//(callreceive.this,TestActivity.class);
        intent1.setAction(Intent.ACTION_SEND);
        intent1.putExtra("start_time",start_time);
        startActivity(intent1);

        }
    }
  }
}
} 
```

现在我想在执行循环后立即将 start_time 的值发送到活动。下面是接收活动-Test Activity的代码。

```
package com.mohit;

import com.mohit.R;
import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.widget.TextView;

public class TestActivity extends Activity {

    TextView output1,output2;
    long start_time,end_time;
    int flag=0;
    long dif_sec=0;

      @Override
        public void onCreate(Bundle savedInstanceState) {
             super.onCreate(savedInstanceState);
             setContentView(R.layout.main);
             output1=(TextView)findViewById(R.id.textView1);

             Intent extras = getIntent();
              if (extras!=null)
              {

                  if (flag==0)
                  {
                      flag=1;
                 dif_sec=extras.getLongExtra("start_time",0);
                  }
              }
              output1.setText(String.valueOf(dif_sec));

              }

} 
```

这是android清单文件

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.mohit"
android:versionCode="1"
android:versionName="1.0" >

<uses-sdk android:minSdkVersion="7" />
<uses-permission android:name="android.permission.READ_CONTACTS" />
<uses-permission android:name="android.permission.READ_PHONE_STATE"/>

    <application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name" >
    <activity android:name="TestActivity" >
        <intent-filter>
                <action android:name="android.intent.action.MAIN" />
        <category android:name="android.intent.category.LAUNCHER" />

            </intent-filter>
    </activity>

     <activity android:name="callreceive" >
    <receiver android:name="receive" >
        <intent-filter>
    <action android:name="android.intent.action.SEND" />
    <action android:name="android.intent.action.PHONE_STATE"></action>
    <category android:name="android.intent.category.DEFAULT" />
        </intent-filter>
    </receiver>
    </activity>

 </application>

</manifest> 
```

我无法通过测试活动打印 start_time 的值。我错过了什么还是有什么问题？请帮助谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-13T19:50:17.097

创建名为 NewActivity 的新 Activity。并这样做：

```
public class callreceiver extends BroadcastReceiver {

    long start_time;
    int flag=0;

    @Override
     public void onReceive(Context context, Intent intent) {
     Bundle extras = intent.getExtras();
     if (extras != null) {
     String state = extras.getString(TelephonyManager.EXTRA_STATE);

     Log.w("DEBUG", state);
     if ((state.equals(TelephonyManager.EXTRA_STATE_RINGING))&&flag==0) 
     {
     flag=1;
     start_time=System.currentTimeMillis();
     Intent intent = new Intent(context,NewActivity.class);
     intent.putExtra("start_time",start_time)
     startActivity(intent);
     }
     } 
```

现在，创建一个获得附加功能的新类：

```
public class ILoveUrielFrankelActivity extends Activity {
    private TextView mTextView;

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
         Bundle extras = getIntent().getExtras();
         long displayTime = extras.getLong("start_time");
         TextView mTextView = (TextView)findViewById(R.id.uriel);
         mTextView.setText(displayTime);
  } 
```

在 res/layout/main.xml 里面

```
 <?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >
    <TextView android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:id="@+id/uriel"/>

</LinearLayout> 
```

# php - 如何在php中获得实时美元/印度卢比汇率？

> ID：11940638
> 
> 赞同：3
> 
> 时间：2012-08-13T19:04:14.473
> 
> 标签：php, mysql

嗨，我需要获取实时美元/印度卢比汇率，并且需要将其分配给我的 sql 表中的一个字段。我没有为此找到网络服务。谁能告诉我如何将实时美元兑印度卢比汇率嵌入到我的 php 脚本中？我需要做以下事情

```
$usdinr = some_service_to_retrieve_the_value( USD to INR); 
```

如果有人能告诉我该怎么做，我将不胜感激？

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-13T19:09:23.247

从这个线程：

[在 C# 中动态获取美元到 INR 的汇率？](https://stackoverflow.com/questions/9311495/get-usd-to-inr-exchange-rate-dynamically-in-c)

看起来你可以提出请求

[http://www.webservicex.net/CurrencyConvertor.asmx/ConversionRate?FromCurrency=USD&ToCurrency=INR](http://www.webservicex.net/CurrencyConvertor.asmx/ConversionRate?FromCurrency=USD&ToCurrency=INR)

编辑：

```
<?php 
$url  = "http://www.webservicex.net/CurrencyConvertor.asmx/ConversionRate?FromCurrency=USD&ToCurrency=INR"; 

$xml = simplexml_load_file($url); 

print "<pre>"; 
var_dump($xml); 
print "</pre>"; 
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T19:09:50.610

谷歌搜索可以解决问题，这是我发现的

[货币转换器](http://www.webservicex.net/ws/wsdetails.aspx?wsid=10)

它使用 SOAP 协议，您可以将其与您的 php 集成

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T19:12:26.093

您可以使用`curl`和谷歌货币转换器

```
<?php

$usdinr = USD2INR("500");

function USD2INR($val) {
$amount = $val;

 $url = 'http://www.google.com/ig/calculator?hl=en&q=' . $amount . 'USD=?INR';
 $ch = curl_init();
 $timeout = 0;
 curl_setopt ($ch, CURLOPT_URL, $url);
 curl_setopt ($ch, CURLOPT_RETURNTRANSFER, 1);
 curl_setopt($ch,  CURLOPT_USERAGENT , "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT  6.1)");
 curl_setopt ($ch, CURLOPT_CONNECTTIMEOUT, $timeout);
 $rawdata = curl_exec($ch);
 curl_close($ch);
 $data = explode('"', $rawdata);
 $data = explode(' ', $data['3']);
 $var = $data['0'];
 return round($var,3);
 }

?> 
```

**编辑**：您可以使用任何免费提供的货币转换器 API 或答案中列出的那些。我只是用谷歌的例子

# android - 将 JSON 数据用于 android listview 部分标题

> ID：11940641
> 
> 赞同：1
> 
> 时间：2012-08-13T19:04:17.050
> 
> 标签：android, mysql, json, listview

我想知道是否有人可以帮助我弄清楚尝试将 JSON 结果中的日期用作节标题时没有得到什么？我正在使用来自[http://jsharkey.org/blog/2008/08/18/separating-lists-with-headers-in-android-09/的以下列表适配器代码](http://jsharkey.org/blog/2008/08/18/separating-lists-with-headers-in-android-09/)

```
package com.example.androidhive;

import java.util.LinkedHashMap;
import java.util.Map;
import android.content.Context;
import android.view.View;
import android.view.ViewGroup;
import android.widget.Adapter;
import android.widget.ArrayAdapter;
import android.widget.BaseAdapter;

public class SeparatedListAdapter extends BaseAdapter {

public final Map<String, Adapter> sections = new LinkedHashMap<String, Adapter>();
public final ArrayAdapter<String> headers;
public final static int TYPE_SECTION_HEADER = 0;

public SeparatedListAdapter(Context context) {
    headers = new ArrayAdapter<String>(context, R.layout.list_header);
}

public void addSection(String section, Adapter adapter) {
    this.headers.add(section);
    this.sections.put(section, adapter);
}

public Object getItem(int position) {
    for (Object section : this.sections.keySet()) {
        Adapter adapter = sections.get(section);
        int size = adapter.getCount() + 1;

        // check if position inside this section
        if (position == 0)
            return section;
        if (position < size)
            return adapter.getItem(position - 1);

        // otherwise jump into next section
        position -= size;
    }
    return null;
}

public int getCount() {
    // total together all sections, plus one for each section header
    int total = 0;
    for (Adapter adapter : this.sections.values())
        total += adapter.getCount() + 1;
    return total;
}

@Override
public int getViewTypeCount() {
    // assume that headers count as one, then total all sections
    int total = 1;
    for (Adapter adapter : this.sections.values())
        total += adapter.getViewTypeCount();
    return total;
}

@Override
public int getItemViewType(int position) {
    int type = 1;
    for (Object section : this.sections.keySet()) {
        Adapter adapter = sections.get(section);
        int size = adapter.getCount() + 1;

        // check if position inside this section
        if (position == 0)
            return TYPE_SECTION_HEADER;
        if (position < size)
            return type + adapter.getItemViewType(position - 1);

        // otherwise jump into next section
        position -= size;
        type += adapter.getViewTypeCount();
    }
    return -1;
}

public boolean areAllItemsSelectable() {
    return false;
}

@Override
public boolean isEnabled(int position) {
    return (getItemViewType(position) != TYPE_SECTION_HEADER);
}

public View getView(int position, View convertView, ViewGroup parent) {
    int sectionnum = 0;
    for (Object section : this.sections.keySet()) {
        Adapter adapter = sections.get(section);
        int size = adapter.getCount() + 1;

        // check if position inside this section
        if (position == 0)
            return headers.getView(sectionnum, convertView, parent);
        if (position < size)
            return adapter.getView(position - 1, convertView, parent);

        // otherwise jump into next section
        position -= size;
        sectionnum++;
    }
    return null;
}

public long getItemId(int position) {
    return position;
}
} 
```

连同此处的 PHP/MySQL/Sample 代码：[http ://www.androidhive.info/2012/05/how-to-connect-android-with-php-mysql/](http://www.androidhive.info/2012/05/how-to-connect-android-with-php-mysql/)

通过使用以下方法，我设法使分段列表在某种程度上起作用：

```
@Override
protected void onPostExecute(String file_url) {
    // dismiss the dialog after getting all products
    pDialog.dismiss();
    // updating UI from Background Thread
    runOnUiThread(new Runnable() {
        public void run() {
        /**
        * Updating parsed JSON data into ListView
        * */
    SeparatedListAdapter listadapter = new SeparatedListAdapter(
                activity);
        String date = null;
        try {
            JSONObject c = products.getJSONObject(1);
            date = c.getString(TAG_DATE);
        } catch (JSONException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

        listadapter.addSection(date, new SimpleAdapter(activity,
                productsList, R.layout.list_item, new String[] {
                TAG_PID, TAG_NAME, TAG_DATE }, new int[] {
                R.id.pid, R.id.name, R.id.date }));
        listadapter.addSection("Security Test", new SimpleAdapter(
            activity, productsList, R.layout.list_item,
            new String[] { TAG_PID, TAG_NAME, TAG_DATE },
            new int[] { R.id.pid, R.id.name, R.id.date }));

                // updating listview
                setListAdapter(listadapter);
            }
        });

    } 
```

然而，这会导致这样的事情：

![在此处输入图像描述](../Images/9a11c458f9ca23569b106384d120529a.png)

有没有办法从 JSON 查询中解析日期，然后在“for”块中使用它，以便每个部分都是日期（特别是月份），然后只显示每个部分中每个月的值？我正在使用以下内容来获取月份名称，但这无助于过滤列表：

```
SeparatedListAdapter listadapter = new SeparatedListAdapter(
                    activity);
            java.util.Date datestr = null;
            String month_name = null;

            try {

                JSONObject c = products.getJSONObject(1);

                SimpleDateFormat inputFormatter = new SimpleDateFormat(
                                "yyyy-MM-dd HH:mm:ss"); 
                SimpleDateFormat outputFormatter = new SimpleDateFormat(
                                "MMMM");

                try {
                    datestr = inputFormatter.parse(c
                            .getString(TAG_DATE));
                } catch (ParseException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }

                month_name = outputFormatter.format(datestr); 
```

# codeigniter - 我可以在没有终端的情况下使用 Angular JS 吗？

> ID：11940643
> 
> 赞同：2
> 
> 时间：2012-08-13T19:04:22.803
> 
> 标签：codeigniter, terminal, angularjs

在终端、git 等中做任何事情都会增加我尝试使用 CodeIgniter 快速开发应用程序的学习曲线。我意识到需要一个 Javascript 框架并想使用 AngularJS - 终端有什么办法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T20:57:34.940

您需要做的就是下载 AngularJS 源文件（.js 文件）并进行编码。我也是新手，对它印象深刻。但是在我看来，它是为与 CodeIgniter 不同的东西而设计的。

Angular JS 基本上将您的 MVC 从后端移动到前端，我有限的经验告诉我，它适用于比 CodeIgniter 更简单的应用程序。当然，你的 MVC 后端仍然可以有一些逻辑，但想法是 Angular 成为应用程序，而你主要使用后端来存储数据。

可能有一种方法可以通过在 CodeIgniter MVC 的上层结构中制作有限范围的 Angular 页面来将两者混合在一起，但我还没有弄清楚这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T23:19:20.840

AngularJS 当然可以与 Code Igniter 一起工作，而且你也不需要使用终端。

您可能想要使用 Code Igniter 编写一个 AngularJS 可以与之通信的 RESTful API。查看这篇文章，了解带有 CI 的 RESTful 服务：http: [//net.tutsplus.com/tutorials/php/working-with-restful-services-in-codeigniter-2/](http://net.tutsplus.com/tutorials/php/working-with-restful-services-in-codeigniter-2/) （有点旧，但基本概念是相同的)

然后，使用 AngularJS，您可以`$http`向使用 CI 编写的 API 发出请求：http: [//docs.angularjs.org/api/ng.$http](http://docs.angularjs.org/api/ng.%24http)

# html - 在悬停其他元素时更改身体背景图像/渐变

> ID：11940645
> 
> 赞同：0
> 
> 时间：2012-08-13T19:04:28.530
> 
> 标签：html, css

我试图在悬停在 div （id="above"）上时更改身体的背景图像/渐变，我按照他们在另一篇文章中所做的方式（http://stackoverflow.com/questions/1462360/css -hover-one-element-effect-for-multiple-elements) 但它似乎不起作用

css

```
body {
    background: -webkit-gradient(radial, ...);
}

.about:hover body{
    background: -webkit-gradient(radial, ...); // new gradient
} 
```

html

```
<body>
    <div class="about">
        <h1 id="title">About</h1>
        <div>
            <p id="about">stuff</p>
        </div>
    </div>
</body> 
```

这没有效果，我什至尝试通过在悬停时将标题样式更改为斜体来测试这是否有效，仍然没有用

```
.about:hover h1.title {
    font-weight: italic;
} 
```

是我使用它的方式不对还是有其他问题，任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T19:22:34.530

如果你想用 CSS（没有 javascript）来做，你可以用`z-index`：

在此处查看示例：http: [//jsfiddle.net/nCyJ4/](http://jsfiddle.net/nCyJ4/)

或者，在您的情况下， http: [//jsfiddle.net/nCyJ4/1/](http://jsfiddle.net/nCyJ4/1/)：

HTML：

```
<div class="initial background" id="bg0"></div>
<div class="about bgwrapper">
    <h1 id="title">About</h1>
    <div>
        <p id="about">stuff</p>
    </div>
    <div id="bg1" class="background"></div>
</div> 
```

CSS：

```
.background{
    position:fixed;
    top:0;left:0;
    width:100%;height:100%;
    display:none;
    z-index:-1;
}
.bgwrapper:hover>.background,.initial.background{
    display:block;
}
.initial.background:hover{
    display:block!important;
}
.background:hover{
    display:none!important;
}
#bg0{
    background: -moz-linear-gradient(left, #FF0000 0%, #FF9900 10%, #FFFF00 16.666%, #CCFF00 20%, #32FF00 30%, #00FF00 33.333%, #00FF65 40%, #00FFFF 50%, #00FFFF 50%, #0065FF 60%, #0000FF 66.666%, #3300FF 70%, #CB00FF 80%, #FF00FF 83.333%, #FF0098 90%, #FF0004 100%);

}

#bg1{
    background: -moz-linear-gradient(left center, #FF0000, #000000) repeat scroll 0 0 transparent
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T19:18:41.033

由于`body`不是 的后代`div.about`，因此不能这样定位。你可以使用一点 JavaScript 来实现你需要的效果。

**CSS**

```
body {
    background: -webkit-gradient(radial, ...);
}

body.hover {
    background: -webkit-gradient(radial, ...); // new gradient
} 
```

**JavaScript**

```
document.getElementsByClassName('about')[0].onmouseover = function () {
    document.getElementsByTagName('body')[0].className += ' hover';
}
document.getElementsByClassName('about')[0].onmouseout = function () {
    var n = document.getElementsByTagName('body')[0];
    n.className = n.className.replace('hover', '');
} 
```

# cocoa - NSKeyedArchiver：区分同一类的不同实例

> ID：11940646
> 
> 赞同：2
> 
> 时间：2012-08-13T19:04:42.680
> 
> 标签：cocoa, osx-lion, resume, nsarchiving

我正在我的 OS X 应用程序中实现对 Lion 的“恢复”功能的支持。

我有一个 NSViewController 的自定义子类，在其中我实现了方法 encodeRestorableStateWithCoder: 为：

```
@implementation MyClass (Restoration)
    -(void)encodeRestorableStateWithCoder:(NSCoder*)coder {
       [coder encodeObject:_dataMember forKey:@"object_key"]; // I get the warning below when this line is executed for the second time
    }
    - (void)restoreStateWithCoder:(NSCoder *)coder {
       _dataMember = [coder decodeObjectForKey:@"object_key"];
    }
@end 
```

但是，由于我有多个 MyClass 实例，不同的值被保存到同一个键（“object_key”）中，我从 Cocoa 收到以下警告：

> NSKeyedArchiver 警告：替换键“object_key”的现有值；类层次结构中的编码键可能重复

克服这个问题的最佳实践是什么？

**编辑：**我在[这里](http://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/Archiving/Articles/archives.html#//apple_ref/doc/uid/20000946-133744)发现每个实例都自动拥有自己的命名空间以避免冲突，所以问题可能在于我手动调用 encodeRestorableStateWithCoder 到具有相同 NSCoder 对象的不同实例而不告诉它这些是不同的实例。但是，我仍然无法弄清楚如何正确地做到这一点。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T05:38:38.583

为了克服这个问题，可以创建一个新的 NSMutableData，其中每个都由一个**单独**的（新的）NSKeyArchiver 编写，并将它们全部存储在一个数组中，该数组存储在原始 NSCoder 对象中。

这是一个对子项的可恢复状态进行编码的示例。给定此代码，解码部分可以直接进行。

```
- (void)encodeRestorableStateWithCoder:(NSCoder *)coder
{
    [super encodeRestorableStateWithCoder:coder];

    // Encode subitems states:
    NSArray* subitems = self.items;
    NSMutableArray* states = [NSMutableArray arrayWithCapacity: subitems.count];
    for (SubItemClass* item in subitems)
    {
        NSMutableData* state = [NSMutableData data];
        NSKeyedArchiver *archiver = [[NSKeyedArchiver alloc] initForWritingWithMutableData:state];
        [item encodeRestorableStateWithCoder:archiver];
        [archiver finishEncoding];
        [states addObject:state];
    }
    [coder encodeObject:states forKey:@"subitems"];
} 
```

# php - 数组元素内的大字符串有问题吗？

> ID：11940654
> 
> 赞同：1
> 
> 时间：2012-08-13T18:58:23.780
> 
> 标签：php, arrays

我需要知道是否可以将 html 页面存储在数组元素中？它有一些性能问题吗？这个页面不会那么大，但它可以有点大。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T19:04:50.617

是的，假设您指的是网页的 HTML 而不是任何对象（即图像、视频），您可以将整个网页存储在数组元素中。除非它是一个非常大的网页，否则您应该不会有任何问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T19:08:01.337

假设它不超过`ini_get('memory_limit')`.

# performance - VB6程序在新计算机上编译在其他计算机上速度非常慢

> ID：11940661
> 
> 赞同：0
> 
> 时间：2012-08-13T19:05:53.370
> 
> 标签：performance, visual-studio, compatibility

我有一个奇怪的问题正在杀死我们。我有一个用 VB6 编写的广泛使用的应用程序。

一切正常。本周我决定在我们进行编译的计算机上碰碰运气。我尽量不碰运气，所以我有一个带有 DDR3 和 Gigabyte 主板的 AMD X2 270（我虽然最好不要使用更大的硬件和 W7，这样 Visual Studio 6 会更容易安装......）

我安装了 Windows XP SP3，因为那台计算机的主要目的是执行 vb6 应用程序维护，此外还有诸如电子邮件检查、网上冲浪和使用其他工具进行网络编程等常见任务。

问题是：在这台新计算机中生成的可执行文件速度非常慢！！！我的旧电脑（奔腾 4，也有 XP）创建了运行良好的可执行文件。两者都有 Visual Studio 6 SP 5。它们在编译它的计算机上工作得很好，但是一旦我将 exe 文件移动到已经拥有该应用程序的计算机上，它几乎无法使用。

有人有什么想法吗？？？？我们在这里有点困惑，更不用说担心了。（“旧”机器最近出现了故障迹象，例如重新启动）

更多信息：该应用程序与 sql server 2000 对话，使用 flexgrid 和 Crystal Reports 8.5

在此先感谢，丹尼尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T21:35:54.973

不管它值多少钱，我在我的 XP 计算机上安装了一堆旧的旧东西，包括 MSVS 6/Pro。另外，不管它值多少钱，我想不出*任何*理由让*同一个*MSVS6 编译器在不同的机器上生成*不同*的 .exe。

建议：

1) 如果有机会，请发回“好”.exe 与“坏”.exe 的命令行“目录”。文件大小是否匹配？

2) 请在“好”PC 上的“好”.exe 上运行“depends”（您可能知道的 MSVS6 工具之一），而不是在“坏”.exe 上运行“坏”.exe。两个 .exe 是否使用相同的 .dll，来自相同的位置，具有相同的版本？

3) 你的 VBRUN.dll 怎么样？例如：

```
 Directory of C:\WINDOWS\system32
03/31/2003  05:00 AM         1,355,776 msvbvm50.dll
04/13/2008  05:12 PM         1,384,479 msvbvm60.dll 
```

4) 如果将“好”.exe 从“好”计算机复制到坏计算机会发生什么？“好”的 .exe 是否突然表现得“坏”？

5) 你在任务管理器中看到了什么。%CPU 中的“好”PC 和“坏”PC 有什么区别？内存/分页？I/O 读/写？

先感谢您

# android - 使用 AndroidProguardScala 和 Ant 构建 Android 项目

> ID：11940663
> 
> 赞同：3
> 
> 时间：2012-08-13T19:06:09.980
> 
> 标签：android, scala, ant, build

我正在按照[Eclipse、Android、Scala 的说明在 Scala 中为 Android 开发变得容易，但仍然无法正常工作](https://stackoverflow.com/questions/9924015/eclipse-android-scala-made-easy-but-still-does-not-work/11084146#11084146)。一切都在我的开发机器上运行良好，在 Eclipse 中构建。

但是现在我需要在 Eclipse 之外用 Ant 构建项目，我迷路了。

我还是想用这个方法，不想用SBT。所以我假设我应该对插件进行“无头构建”......有什么提示吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T13:16:51.987

你真的应该尝试使用 SBT。[github](https://github.com/jberkel/android-plugin/)上有一个很棒的sbt插件，有一个很好的入门教程。此外，SBT 的[wiki](https://github.com/harrah/xsbt/wiki/)有一些关于如何超越基本 sbt 的非常好的信息。

sbt-android 插件有一个非常好的功能，它可以将类型资源添加到您的 android 构建中，因此您可以执行以下操作：

```
var button:Button = activity.findView(TR.myButtonInTheLayout) 
```

类型安全的布局管理......这是一个非常方便的功能。

Sbt-android 还支持使用标准的 scala 目录布局或标准的 android 目录布局，无论你喜欢什么。

# c# - WebAPI 仅部分解码 URL 编码字符串

> ID：11940665
> 
> 赞同：2
> 
> 时间：2012-08-13T19:06:17.220
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-4, asp.net-web-api

所以我在 ASP.NET 上使用 WebAPI 编写一个 REST 应用程序。我遇到了一个问题。

在 PHP 上，我使用 urlencode 函数导致

原始的 base64 编码字符串是

`kA+1n8i00qcJPNgPUXq8YqerScbQOw5Hvb3/WubyGTc=`

在通过 urlencode 运行 PHP 后，我得到：- `kA%2B1n8i00qcJPNgPUXq8YqerScbQOw5Hvb3%2FWubyGTc%3D`

在这个调试之后，我检查了提琴手，确实它通过正确的 URLEncoded 字符串发送......

现在，当它到达 ASP.NET MVC WebAPI 时，我得到：-

`kA+1n8i00qcJPNgPUXq8YqerScbQOw5Hvb3/WubyGTc%3`

因此，看起来 WebAPI 或 MVC 正在尝试自己进行一些前行 url 解码，但是它有两个问题：-

*   它只是部分解码字符串，所以 + 和 / 符号得到正确转换，但 = 没有
*   它似乎正在从 %3D 中截断 D ，导致 %3 不是有效的 URL 字符。

有没有人遇到过这个问题？要复制它，只需创建一个 Web 应用程序

```
public TokenAPI Get(Guid caller, Guid id, string ip, string signature, Guid eventID)
{
} 
```

并传入值

`/api/GenerateToken?id=d9a2057c-c228-40d4-a9a9-5d7a4da4984b&caller=e1af32bb-ac84-4f45-b4d6-67f7543ffab2&ip=127.0.0.1&eventID=f6d71c3d-ef00-41e1-8dec-a3a77bdf7484&signature=kA%2B1n8i00qcJPNgPUXq8YqerScbQOw5Hvb3%2FWubyGTc%3D`

然后检查签名参数，你会发现它只有部分 URLDecoded 自己......

任何指针将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T05:57:36.947

我无法使用 ASP.NET MVC 4 RC 重现这一点。

脚步：

1.  创建一个新的空 ASP.NET MVC 4 应用程序
2.  添加 API 控制器：

    ```
    public class ValuesController : ApiController
    {
        public string Get(Guid caller, Guid id, string ip, string signature, Guid eventID)
        {
            return signature;
        }
    } 
    ```

3.  导航`/api/values?id=d9a2057c-c228-40d4-a9a9-5d7a4da4984b&caller=e1af32bb-ac84-4f45-b4d6-67f7543ffab2&ip=127.0.0.1&eventID=f6d71c3d-ef00-41e1-8dec-a3a77bdf7484&signature=kA%2B1n8i00qcJPNgPUXq8YqerScbQOw5Hvb3%2FWubyGTc%3D`

4.  结果：

    ```
    <string xmlns="http://schemas.microsoft.com/2003/10/Serialization/">kA+1n8i00qcJPNgPUXq8YqerScbQOw5Hvb3/WubyGTc=</string> 
    ```

该`signature`参数已正确 url 解码。

# ios - 是否可以在不隐藏键盘的情况下使 UITextView 处于非活动状态（可编辑 = 否）？

> ID：11940668
> 
> 赞同：0
> 
> 时间：2012-08-13T19:06:45.690
> 
> 标签：ios, facebook, user-interface, uitextview, uitextviewdelegate

*我在UIViewController*的子类中使用*UITextView* ，我将其命名为*FacebookPostViewController*。因此文本视图的目的是允许用户查看准备好的帖子的内容，可能对其进行更改，然后决定是否应该将来自文本视图的文本发布到 Facebook。

 **我已将 UITextView 的*returnKeyType*属性设置为*UIReturnKeySend*，因为我想用它来实际发布到 Facebook。可以通过导航栏中的后退按钮取消。

所以*FacebookPostViewController*是 UITextView 的委托，在*textView:shouldChangeTextInRange:replacementText:*委托方法中，我检查换行符插入，然后调用我的*sendTextToFacebook*方法：

```
- (void)sendTextToFacebook;
{
    // prepare sending
    NSMutableDictionary* sendParameters = [NSMutableDictionary dictionaryWithObjectsAndKeys:self.textView.text, @"message", nil];

    // request sending to own feed
    [[FacebookController sharedFacebookController].facebook requestWithGraphPath:@"me/feed" andParams:sendParameters andHttpMethod:@"POST" andDelegate:self];
} 
```

如您所见，我将*self*指定为*FBRequestDelegate*，因此我也实现了

```
- (void)request:(FBRequest *)request didFailWithError:(NSError *)error;
- (void)request:(FBRequest *)request didLoad:(id)result; 
```

如果发布成功与否，我会在哪里给用户反馈。

但是，我认为 Facebook 服务器回复需要一些时间，所以我想让整个 UI 处于非活动状态，直到调用两个委托方法之一。因此，我实现了以下方法：

```
- (void)disableUserInterface;
{
    self.textView.editable    = NO;
    self.loginButton.enabled  = NO;
    self.logoutButton.enabled = NO;
    [self.navigationItem setHidesBackButton:YES animated:YES];

    [self.spinner startAnimating];
    self.spinner.hidden = NO;
} 
```

我的问题是调用*self.textView.editable = NO*会隐藏键盘，这看起来很愚蠢。如果我删除该行，键盘不会消失，但用户可以在将文本发送到 Facebook 时更改 textView 内容。但是，由于发布已经启动。这些更改实际上不会出现在 Facebook 中。

我以为我可以简单地实现另一个 UITextViewDelegate 方法：

```
- (BOOL)textViewShouldEndEditing:(UITextView *)textView
{
    return NO;
} 
```

UI 结果正是我想要的。但是，当我弹出*FacebookPostViewController*然后将另一个视图推送到*UINavigationController*时，这将导致 EXC_BAD_ACCESS 崩溃。那么错误是

```
*** -[UITextView isKindOfClass:]: message sent to deallocated instance 0x20c650 
```

那么，有没有人知道如何解决我的问题以使 UITextView 不可编辑，但防止键盘消失？！？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T12:01:35.650

好的，感谢上面[David H](https://stackoverflow.com/users/96716/david-h)的评论，我找到了解决方案。但这里有最重要的见解：

1.  当我从*UINavigationController*弹出我的*FacebookPostViewController*时，系统会自动要求*UITextView*辞去第一响应者的职务。

***   你**永远不**应该让*textViewShouldEndEditing:*总是返回 NO，因为这总是会阻止键盘隐藏，这将导致上面描述的崩溃，一旦*UITextView*被释放。** 

 **解决方案是仅在我们仍在等待 Facebook 服务器的响应时才防止键盘消失。这是我添加的几行代码，它们正是这样做的：

```
@interface FacebookPostViewController ()
// ...
@property (nonatomic, assign, getter = isWaitingForFBResponse) BOOL waitingForFBResponse;
// ...
@end

@implementation FacebookPostViewController
// ...
@synthesize waitingForFBResponse = _waitingForFBResponse;

- (id)init;
{
    self = [super init];
    if (self) {
        // set default values
        self.waitingForFBResponse = NO;

        // ...
    }

    return self;
}

#pragma mark -
#pragma mark UITextViewDelegate methods
- (BOOL)textViewShouldEndEditing:(UITextView *)textView
{
    if ([self isWaitingForFBResponse]) {
        return NO;
    } else {
        return YES;
    }
}

- (BOOL)textView:(UITextView *)textView shouldChangeTextInRange:(NSRange)range replacementText:(NSString *)text {
    // Did user press 'return' (Send) key?
    if([text isEqualToString:@"\n"]) {
        // enter waiting state
        self.waitingForFBResponse = YES;

        // disable the user interface
        [self disableUserInterface];

        FacebookController *fbController = [FacebookController sharedFacebookController];
        if ([fbController.facebook isSessionValid] == YES) {
            // Post to Facebook!
            [self sendTextToFacebook];
        } else {
            // we need to login first
            [self loginToFacebook];

            // remember that user wants to post to Facebook
            self.sendTextAfterFBLogin = YES;
        }

        // Don't allow textView to insert a LF into the text property
        return NO;
    }

    // allow all other edits
    return YES;
}

#pragma mark -
#pragma mark FBRequestDelegate methods
- (void)request:(FBRequest *)request didFailWithError:(NSError *)error;
{
    // request failed, so display error status overlay.
    [[FeedbackController sharedFeedbackController] displayStatusOverlayWithString:NSLocalizedString(@"StatusMessage_Failure", nil)];

    // leave waiting state
    self.waitingForFBResponse = NO;

    // enable UI again
    [self enableUserInterface];
}

- (void)request:(FBRequest *)request didLoad:(id)result;
{
    // request succeeded, give user appropriate feedback.
    [[FeedbackController sharedFeedbackController] displayStatusOverlayWithString:NSLocalizedString(@"StatusMessage_Sent", nil)];

    // leave waiting state
    self.waitingForFBResponse = NO;

    // pop the view, as the user accomplished his goal.
    [self.navigationController popViewControllerAnimated:YES];
}

@end 
```****

# maven-3 - 在多模块项目中使用配置文件

> ID：11940670
> 
> 赞同：0
> 
> 时间：2012-08-13T19:06:52.727
> 
> 标签：maven-3, maven-profiles

我有一个多模块 Maven 项目。项目布局描述如下：

```
PARENT
  |-CHILD1
  |-CHILD2 
```

父项目具有 pom 包装类型，`CHILD1`并将`CHILD2`项目声明为模块。项目还`PARENT`声明了配置文件`dev`，该配置文件声明了一些属性。CHILD1 项目具有 jar 包装类型，并`dev`通过添加一些依赖项（`commons-collections`例如依赖项）来“覆盖”父配置文件。CHILD2 项目具有战争包装类型，并依赖于 CHILD1 项目。`dev`此外，CHILD2通过添加另一个依赖项（`commons-io`例如，依赖项，我的意思是与项目 CHILD1 中的那个不相关的依赖项）来“覆盖”父配置文件。然后，当我运行`mvn clean install -Pdev`maven 时，不会将`commons-collections.jar`（在 CHILD1 项目中声明的依赖项）`WEB-INF/lib`放入 CHILD2 项目，但 commons-io.jar 就在那里。

所以，问题是：如果目标项目在该配置文件中声明了另一组依赖项，为什么 maven 不从在目标项目的依赖项目中声明的配置文件中放置依赖项？

实际上，我有更多的项目和更多的依赖项，这些依赖项在不同的配置文件中有所不同。我想在该项目 pom.xml 中声明项目特定的依赖项（假设在项目中声明配置文件将“覆盖”父配置文件声明）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T12:06:38.887

我假设您希望能够在开发时进行本地测试，针对暂存环境测试您的更改并最终部署到生产环境。

您需要记住的关键是，当工件被部署到本地/远程存储库时，活动配置文件不是部署内容的一部分，因此当您通过配置文件添加依赖项时，事情变得非常危险，因为您没有了解 webapp 是在 DEV 配置文件激活还是 PROD 配置文件激活的情况下构建的方法，然后当构建的工件部署到生产中时，您可能会被彻底搞砸。

因此，不足之处在于您确保您的工件独立于部署环境。

这意味着，例如，您将从以下位置获取配置：

*   类路径中的文件
*   系统属性
*   jndi 条目

因此，例如，如果部署到 Tomcat，您可以将 configuration.properties 放入`$CATALINA_HOME/lib`

您的 webapp 在启动时将用于`getClass().getResource('/configuration.properties')`解析属性文件，如果文件丢失，则无法启动（快速失败）

您可以通过将 configuration.properties 的测试版本放入`src/test/resources`.

`<scope>provided</scope>`您对应用程序的样式依赖项使用相同的原则。换句话说，容器与提供的契约签订的依赖关系应该由容器提供。因此，您也可以使用 Maven 为自己构建 tomcat/jetty 的生产版本，并将所需的依赖项添加到该程序集中。这就像生产版本使用 MySQL 数据库一样，因此您需要将 mysql-jdbc 驱动程序添加到`$CATALINA_HOME/lib`. 使用组装插件执行此操作相对容易，因为您实际上只是重新打包一个包含一些位而排除其他位的 zip。

在本地测试时，您将需要使用辅助插件的`run`目标，例如`jetty:run`和`tomcat:run`. 这里的解决方案是通过配置文件提供这些插件依赖项并没有错，*因为您不会影响工件的依赖项，*而只会影响插件的类路径。

例如

```
<project>
  <!-- ... some stuff .. -->
  <profiles>
     <profile>
       <id>DEV</id>
       <build>
         <plugins>
           <plugin>
             <groupId>org.mortbay.jetty</groupId>
             <artifactId>jetty-maven-plugin</artifactId>
             <dependencies>
               <dependency>
                 <groupId>commons-dbcp</groupId>
                 <artifactId>commons-dbcp</artifactId>
                 <version>1.4</version>
               </dependency>
               <dependency>
                 <groupId>mysql</groupId>
                 <artifactId>mysql-connector-java</artifactId>
                 <version>5.1.18</version>
               </dependency>
             </dependencies>
           </plugin>
         </plugins>
       </build>
     </profile>
   </profiles>
 </project> 
```

您还可以配置系统属性或类路径添加以引入所需的配置文件。

所有这一切的最终结果是工件保持环境独立，您可以轻松地针对各种环境进行测试

希望这能回答你的问题（即使横向）

# ruby - 如何更轻松地运行此脚本

> ID：11940672
> 
> 赞同：2
> 
> 时间：2012-08-13T19:06:55.410
> 
> 标签：ruby, macos, unix, directory

我有一个我编写的 Ruby 脚本，它根据文件扩展名对杂乱的目录中的一些文件进行排序。使用 GUI 对其进行排序会非常困难，而且我更容易将文件放在最顶层的目录中并让排序器完成工作。

问题是，我对 unix 脚本编写有点菜鸟。我想要做的是能够从我计算机上的任何地方运行该排序器脚本，而无需

```
cd Desktop/Whatever/Foo
ruby sorterscript.rb 
```

只需在命令行中编写`sortfolders`并运行程序即可。

我已经多次测试了这个脚本，它运行良好，我只是想要更方便一点。

**奖励**：如果可能，并且不太难，如果我可以让程序运行，例如，每小时自动运行，那就更好了。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-13T19:46:17.807

就您的第一个问题而言，您需要做几件事：

1.  在脚本中添加[shebang 行](https://en.wikipedia.org/wiki/Shebang_%28Unix%29#Examples)（使其成为脚本的第一行）：

    `#!/usr/bin/ruby`（或者不管 Ruby 解释器的可执行文件的路径是什么，我忘记了它的确切位置）

2.  通过 Finder 的“获取信息”上下文菜单或命令行使脚本可执行，例如：

    `chmod 755 my_script.rb`

3.  将脚本的目录位置添加到 OS X 的 launchd.conf 文件的 PATH 环境变量中，如此[处](https://stackoverflow.com/a/588442/1437878)所述。您需要添加这一行：

    `setenv PATH /path/to/my/script:$PATH`（替换脚本的真实路径）

就您的奖金问题而言，您可以使用 cron 来设置重复性工作。我从来没有真正这样做过，但这是[Apple 的 cron 手册页](https://developer.apple.com/library/mac/#documentation/Darwin/Reference/Manpages/man5/crontab.5.html)，可以帮助您入门。

# node.js - Express 3 会话总是落后一个请求

> ID：11940677
> 
> 赞同：0
> 
> 时间：2012-08-13T19:07:18.327
> 
> 标签：node.js, session, express

我正在使用 express 3 中的新消息系统，并在处理和验证表单时发现了这个问题。提交无效表单时，提交失败，但不显示错误消息。再次提交时，会显示上次请求的错误消息。我尝试使用本地会话和 Redis 会话，它总是一样的。这是默认的快递项目：

应用程序.js

```
var express = require('express')
  , routes = require('./routes')
  , http = require('http')
  , path = require('path');

var app = express();

app.response.message = function(type, msg){
  // reference `req.session` via the `this.req` reference
  var sess = this.req.session;
  // simply add the msg to an array for later
  sess.messages = sess.messages || [];
  sess.messages.push({type: type, msg: msg});
  return this;
};

app.configure(function(){
  app.set('port', process.env.PORT || 3000);
  app.set('views', __dirname + '/views');
  app.set('view engine', 'ejs');
  app.use(express.favicon());
  app.use(express.logger('dev'));
  app.use(express.bodyParser());
  app.use(express.methodOverride());
  app.use(express.cookieParser('your secret here'));
  app.use(express.session());
  app.use(express.static(path.join(__dirname, 'public')));
  app.use(function(req, res, next) {
    console.log('req.session', req.session.messages);
    var msgs = req.session.messages || [];
    res.locals({
      messages: msgs,
      hasMessages: !! msgs.length
    });
    req.session.messages = [];
    next();
  });
});

app.configure('development', function(){
  app.use(express.errorHandler());
});
app.get('*', function(req, res, next) {
  res.message('hello', req.url);
  next();
});
app.get('/', function(req, res) {
  res.render('index', { title: 'Express' });
});
app.get('/hello', function(req, res) {
  res.render('index', { title: 'Express' });
});
app.get('/world', function(req, res) {
  res.render('index', { title: 'Express' });
});
http.createServer(app).listen(app.get('port'), function(){
  console.log("Express server listening on port " + app.get('port'));
}); 
```

索引主体添加：

```
<% if (hasMessages) { %>
  <ul id="messages">
    <% messages.forEach(function(msg){ %>
      <li class="<%= msg.type %>"><%= msg.msg %></li>
    <% }) %>
  </ul>
<% } %> 
```

1.  / 没有消息
2.  /你好显示'/'
3.  /world 显示“/你好”
4.  重新加载显示“/世界”

这里有什么问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-13T20:20:58.810

如果您不想推迟它们，则根本不需要使用会话，这就是在这种情况下的重点是推迟下一次渲染的消息。当中间件填充“消息”和“hasMessages”时，它实际上没有任何内容，除非之前的请求填充了它们。这通常用于延迟消息，例如“成功更新用户”

# jmeter - Jmeter参数化

> ID：11940678
> 
> 赞同：1
> 
> 时间：2012-08-13T19:07:19.543
> 
> 标签：jmeter, text-files

我对 Jmeter 很陌生。我需要有关 jmeter 输入数据文件的帮助。
这是我的情况。
我的测试数据文件结构是这样的：

```
Test Case Name = XXXXXX11
RequestData =  AAAAAAAAAA11
Expected Result = BBBBBBBBB11
Test Case Name = XXXXXX22
RequestData =  AAAAAAAAAA22
Expected Result = BBBBBBBBB22
and so on .... 
```

现在，我必须发送 http 请求并使用 Jmeter（Maven 和持续集成）验证预期。

如何解析给定文件并验证预期结果？

我尝试了以下方法：

*   __StringFromFile - 但我不知道如何查找具有请求数据或预期结果的行；
*   userParameter - 但不确定如何在运行时传递值。

你们中的任何人都可以帮助我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T19:30:56.303

每个文件是否有单个测试用例（即文件中“测试用例名称”、...等的单一外观）？

如果是这样，那么您可以尝试使用来自[Jmeter 插件](http://code.google.com/p/jmeter-plugins/)项目的[CSV 文件](http://code.google.com/p/jmeter-plugins/wiki/VariablesFromCSV)插件中的自定义变量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T21:12:27.077

我的建议是将您的文件转换为 csv（使用您喜欢的任何分隔符）。第一行成为您的标题，每一行成为您想要传入或验证的数据。例如：

```
Test Case Name|Request Data|Expected Result
XXXXXX11|AAAAAAAAAA11|BBBBBBBBB11
XXXXXX22|AAAAAAAAAA22|BBBBBBBBB22 
```

您可以使用 CSV 数据集配置将此数据加载到您的测试计划中。完成后，如果将线程组设置为永远循环，您将能够遍历每一行数据。然后，您在测试用例中需要做的就是从 csv 文件中引用您的变量，如下所示 `${Test Case Name}`：

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-17T18:33:55.177

Thank you so much guys! I just wrote a bean shell script to parse the CSV file and stored all the request & response in the array and then created a for each loop around my http sampler. That met my requirement.

```
 Thread Group
      Beanshell preprocessr (To parse my CSV and to store it in an array)
      For each loop (loops thru the array)
        http sample
        response assertion
        Results 
```

# jquery - 获取选择选项标签的文本并将其填充到隐藏的输入字段中

> ID：11940680
> 
> 赞同：0
> 
> 时间：2012-08-13T19:07:25.970
> 
> 标签：jquery, select, label

我想获取选择选项标签的文本并将其填充到隐藏的输入字段中。

我可以获得该值，但我想知道在选择或更改选项时如何填充隐藏字段。我实际上是一个 jquery 新手，所以我真的不知道与选择选项相关的事件。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-13T19:20:37.803

小提琴：http: [//jsfiddle.net/m5A9U/](http://jsfiddle.net/m5A9U/)

代码

假设您的 HTML 是

```
<select id="select">
<option value="1">One</option>
<option value="2">Two</option>
<option value="3">Three</option>    
</select>

<input type='hidden' id='hidden' value=''/> 
```

jquery代码将是

```
$("#select").change(function () {
    $("#hidden").val($(this).val());
    //alert($(this).val()) 
}) 
```

**编辑**要获取所选选项的标签，请尝试 `$("#hidden").val($(this).find('option:selected').text());`

更新示例：http: [//jsfiddle.net/m5A9U/1/](http://jsfiddle.net/m5A9U/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T19:19:53.670

我刚刚创建了这个简单的[jsFiddle](http://jsfiddle.net/W2TtV/5/)。关注评论以获得更好的理解。有一个使用纯 JavaScript 的解决方案和另一个使用 jQuery 的解决方案。

- 编辑 -

即使它不是您原始问题的一部分，在这里[jsFiddle 2](http://jsfiddle.net/W2TtV/6/)也是您可以获得“标签”而不是值的方式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T19:12:36.213

我们需要查看一些 HTML 才能准确了解您的标签设置方式，但这里有一个基本示例：

```
$("#sel1").change(function () {
    $("#myInput").val(($("label[for=" + $(this).attr("id") + "]").text()));
});​ 
```

小提琴：http: [//jsfiddle.net/johnkoer/Lh8Eg/6/](http://jsfiddle.net/johnkoer/Lh8Eg/6/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-27T07:55:24.230

获取选择元素的选项标签。我们可以试试这个：

```
<select id="id_select">
    <option value="myval_1">Text 1</option>    
    <option value="myval_2">Text 2</option>
    <option value="myval_3">Text 3</option>
</select> 
```

然后编写脚本：

`$('#id_select option[value="'+ $('#id_select').val() +'"]').text();`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-03-02T20:42:20.500

如果您有一个要根据选择输入中的文本转换为人类可读文本的值列表：

HTML

```
<div id="current_values"></div>

<select id="id_select">
<option value="1">First Option</option>
<option value="2">Second Option</option>
<option value="3">Third Option</option>
</select> 
```

JavaScript

```
var values = [1,3];

for(var i = values.length; i >=0; i--){
     $("#current_Values").append($('#id_select option[value="'+ values[i] +'"]').text()+"<br>");
} 
```

# symfony1 - symfony 来自同一个 id 表的两个 id 字段

> ID：11940682
> 
> 赞同：0
> 
> 时间：2012-08-13T19:07:36.257
> 
> 标签：symfony1, doctrine, symfony-1.4, sfguard

我正在为一个项目使用 symfony，但在构建模式时遇到了问题。在架构中，我有一个可以由他自己或管理员创建的表用户，并且用户 ID 存储在 sfGuardUser 中...如何在 schema.yml 中建立它们之间的关系？

我有这个领域：

表X

```
sf_guard_user_id: {type: integer}
sf_guard_user_id_cs: {type: integer} 
```

第一个 id 是他在创建时获得的，第二个是管理员的 id（如果它是由一个人创建的）。所以基本上，我将在 tableX 中使用来自 sfGuardUser 的 id 字段两次，但我无法在 schema.yml 中建立这两个关系。有谁知道怎么处理关系？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T20:40:04.753

很简单。例如：

```
CoolTable:
  actAs:
     Timestampable: ~
  columns:
    sf_guard_user_id:    { type: integer() }
    sf_guard_user_id_cs: { type: integer() }
  relations:
    User:    { local: sf_guard_user_id, foreign: id, class: sfGuardUser }
    UserCs:  { local: sf_guard_user_id_cs, foreign: id, class: sfGuardUser } 
```

要点，即您指定关系的**类别**。

# javascript - 在 Javascript 函数中嵌入 Javascript 函数

> ID：11940690
> 
> 赞同：0
> 
> 时间：2012-08-13T19:07:55.237
> 
> 标签：javascript, function

我需要一个函数来确定：（1）如果两个输入有值，则抛出错误。(2) 如果两个输入都没有值，则抛出错误。(3) 如果输入 B 或输入 D 有值，则确定然后使用哪个计算函数。两个计算函数都可以工作，当被称为

```
onClick="Calculate(this.form.input_A.value, this.form.input_B.value, this.form.input_C.value, this.form)"
onClick="Calculate2(this.form.input_A.value, this.form.input_C.value, this.form.input_D.value, this.form)" 
```

但是当我用来调用下面的函数时：

```
onclick="compute();" 
```

错误有效，但我没有正确调用计算函数，我确信它很明显，但我看不到它。答案不再显示，就像添加错误函数之前一样。

```
<SCRIPT LANGUAGE="JavaScript">

function compute() {
  var B = document.getElementById("input_B").value;
  var D = document.getElementById("input_D").value;

  if (B != "" && D != "") {
    alert("You may only enter Assessment or Annual Property Taxes.");
  } else if (B != "") {
    Calculate(B);
  } else if (D != "") {
    Calculate2(D);
  } else {
    alert("You must enter a value into either Assessment or Annual Property Taxes.");
  }
}

function Calculate(Atext, Btext, Ctext, form) {
  var A = parseFloat(Atext);
  var B = parseFloat(Btext);
  var C = parseFloat(Ctext);
  form.Answer.value = ((B - A) * C) / 1000;
}

function Calculate2(Atext, Ctext, Dtext, form) {
  var A = parseFloat(Atext);
  var C = parseFloat(Ctext);
  var D = parseFloat(Dtext);
  form.Answer.value = D - ((A * C) / 1000);
}

function ClearForm(form) {
  form.input_A.value = "";
  form.input_B.value = "";
  form.input_C.value = "";
  form.input_D.value = "";
  form.Answer.value = "";
}

</SCRIPT> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T19:24:35.910

您缺少参数并且没有正确调用函数。尝试以下...

```
function compute() {   
    var B = document.getElementById("input_B").value;   
    var D = document.getElementById("input_D").value;    
    var A = document.getElementById("input_A").value;   
    var C = document.getElementById("input_C").value; 

    if (B != "" && D != "") {     
        alert("You may only enter Assessment or Annual Property Taxes.");   
    } else if (B != "") {     
        Calculate(A, B, C, this.forms[0]);   
    } else if (D != "") {     
        Calculate2(A, C, D, this.forms[0]);   } 
    else {     
        alert("You must enter a value into either Assessment or Annual Property Taxes.");   
    } 
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T19:33:14.097

如果您的`compute()`函数调用`Calculate()`并且`Calculate2()`只发送一个参数，您将需要创建只需要一个参数的新函数。

```
function CalculateB(Btext) {
  var B = parseFloat(Btext);
  var form = document.getElementById("docForm");
  form.Answer.value = B / 1000;
}

function CalculateD(Dtext) {
  var D = parseFloat(Dtext);
  var form = document.getElementById("docForm");
  form.Answer.value = D - (1 / 1000);
} 
```

# python - Django 上的实时图表

> ID：11940695
> 
> 赞同：2
> 
> 时间：2012-08-13T19:08:31.360
> 
> 标签：python, django, django-views, data-visualization

我有一个表示远程机器网络流量的实时数据源。我想获取这些数据并将其可视化在我使用 Django 的 web 应用程序中的实时图中，实现这一目标的最简单和快速的方法是什么。

到目前为止我尝试了什么：使用 matplotlib 生成散点图并更新 webapp 上的 .png 图像

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-13T19:23:26.023

使用[RRDTool](http://oss.oetiker.ch/rrdtool/)：

> RRDtool 是用于时间序列数据的开源行业标准、高性能数据记录和图形系统。RRDtool 可以轻松集成到 shell 脚本、perl、python、ruby、lua 或 tcl 应用程序中。

一些示例，包括 RRDTool 的基于 Web 的系统监控应用程序：

*   [http://oss.oetiker.ch/rrdtool/gallery/index.en.html](http://oss.oetiker.ch/rrdtool/gallery/index.en.html)
*   [http://snm.sourceforge.net/](http://snm.sourceforge.net/)
*   [http://munin-monitoring.org/](http://munin-monitoring.org/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-13T20:20:40.120

一个不错的选择（我从第一手经验中知道）是使用带有 Flot js 库的 Ajax 更新方法来绘制实时更新图。+1 用于简单性、可扩展选项、插件和 MIT 许可证。

在这里看一个例子[http://people.iola.dk/olau/flot/examples/ajax.html](http://people.iola.dk/olau/flot/examples/ajax.html)

干杯!

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-13T19:16:22.360

过去，当我不得不在浏览器中绘制数据时，我使用过[jqPlot](http://www.jqplot.com/)。您可以设置 javascript 以定期轮询 django 应用程序上的 url，该应用程序返回 JSON 编码数据以进行绘图。

# mysql - 列出每个玩家的前 5 名得分的平均值

> ID：11940698
> 
> 赞同：1
> 
> 时间：2012-08-13T19:08:48.043
> 
> 标签：mysql, greatest-n-per-group, correlated-subquery

在阅读了其他几个类似问题的答案后，我仍然无法实现以下目标：

有一个球员分数列表，我想得到每个球员的前*n*分（分数表只有球员 id 和一个值）。最终目的是用`AVG()`函数聚合分数。

另请注意，*n*界限只是一个限制；一个玩家的分数可能少于*n 个*，在这种情况下，应该计算所有分数。

一旦计算出结果，加入玩家表将允许将每个玩家 id 扩展为可打印的信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T20:12:34.757

在 MySQL 中，您需要 vars 来满足您的要求：

```
select
    idplayer, Score
from
(
    select
        idplayer, T.Score,
        @r := IF(@g=idplayer,@r+1,1) RowNum,
        @g := idplayer
    from (select @g:=null) initvars
    CROSS JOIN 
    (
        SELECT s.Score, 
               s.idplayer
        FROM scores s
        ORDER BY idplayer, s.score DESC
    ) T
) U
WHERE RowNum <= 3 
```

[在 sqlfiddle 测试它](http://sqlfiddle.com/#!2/06278/5/0)：

```
create table scores( idplayer int, score int);
insert into scores values 
   (1,5),     (1,7),      (1,18),      (1,27),      (2,6); 
```

结果：

```
| IDPLAYER | SCORE |
--------------------
|        1 |    27 |
|        1 |    18 |
|        1 |     7 |
|        2 |     6 | 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T20:18:35.270

从这里开始：

```
drop table if exists scores;
create table scores (playerid integer, score integer);
insert into scores values 
(1,1),(1,2),(1,3),(1,4),(1,5),(1,6),(1,7),
(2,1),(2,2),(2,3),(2,4);

select p1.playerid, p1.score
from scores p1, scores p2
where p1.playerid = p2.playerid
and 
p1.score >=
ifnull((select score 
 from scores 
 where playerid=p1.playerid 
 order by score desc limit 4,1
),0)
group by p1.playerid,p1.score; 
```

这将为您提供所需的最高分列表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T19:26:13.223

我不是 100% 确定这将在 mysql 中工作。但是，以下将这个想法捕获为相关子查询：

```
select p.*,
       (select sum(score)
        from (select score
              from scores s
              where s.playerid = p.playerid
              order by score desc
              limit 5
             ) s2
       ) as summax5
from players p 
```

# c# - 将选定的值添加到字符串

> ID：11940700
> 
> 赞同：1
> 
> 时间：2012-08-13T19:08:49.213
> 
> 标签：c#, asp.net, loops, foreach

考虑这段代码：

```
foreach (ListItem item in lstViolations.Items)
{
    if (item.Selected)
    {
        messageBody += item.Value + Environment.NewLine;
    }
} 
```

我正在尝试遍历`ListItem`. `lstViolations`但是，只添加了第一个选定的值`messageBody`，我不知道为什么会这样。

此外，添加`messageBody += "test"`仅打印第一个列表项，后跟`test`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T19:11:11.070

试试这个：如果它是一个 ListView，那么：

```
foreach(ListViewItem Item in lstViolations.SelectedItems)
       messageBody+= Item.Text + Environment.NewLine; 
```

如果它是一个列表框，那么：

```
foreach(string Item in lstViolations.SelectedItems)
       messageBody+= Item + Environment.NewLine; 
```

这将仅遍历选定的项目。

**编辑：**没有看标签。这不适用于 ASP.NET！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T19:18:19.910

甚至更清洁，更容易。

```
messageBody = string.Join(Environment.NewLine, lstViolations.SelectedItems); 
```

# oracle - ORA-01461 带有 MERGE INTO 语句和 clob 列

> ID：11940701
> 
> 赞同：0
> 
> 时间：2012-08-13T19:08:55.547
> 
> 标签：oracle, jdbc, clob, ora-01461

查询：

```
MERGE INTO app_role_data x USING (select ? name, ? xml FROM dual) d ON (x.app_name = d.name) WHEN MATCHED THEN UPDATE SET x.xml_blob = d.xml WHEN NOT MATCHED THEN INSERT(app_name, xml_blob) VALUES(d.name, d.xml) 
```

桌子：

```
create table app_role_data(app_name varchar2(64), xml_blob clob); 
```

结果：当存在一行时，我们得到 ORA-01461。

期望的目标：这是对该表中一行有效的“创建或替换”操作。如果表中存在“名称”，则应更新 xml 列，否则插入新行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T20:03:04.680

我认为这可以通过使用 Spring 框架文档 11.7.2 中记录的 Spring JDBC LOB 设置功能来解决。

但是，这也不起作用......但将成为另一个问题的主题。

# c# - C# 调用 MASM 程序集 DLL

> ID：11940705
> 
> 赞同：1
> 
> 时间：2012-08-13T19:09:17.617
> 
> 标签：c#, interop, masm

为了学习，我试图从 C# 调用一个汇编函数。我在一个非常枯燥的项目中工作，尽我所能简单地做每一件事。这是我的程序集（主要是从[codeproject](http://www.codeproject.com/Articles/42835/Introduction-In-DLLs-Creation-Using-MASM)剪切和粘贴）：

```
.386
.model flat, stdcall
option casemap :none

include \masm32\include\masm32rt.inc

.code
LibMain proc instance:dword,reason:dword,unused:dword 
     mov     eax,1
     ret
LibMain     endp
PrintMess proc
     print "Test"
     exit
PrintMess endp
End LibMain 
```

注意：程序集构建得很好。没有错误，唯一的警告是 masm32rt.inc 有另一`.model`行被汇编器忽略，这个警告很好。[我已经使用这些说明](http://www.deconflations.com/2011/masm-assembly-in-visual-studio-2010/)设置了我的环境。

对于我更熟悉的一种语言 C#，我尝试了两种主要方法：反射和添加 DLL 作为参考。两者都给我一个错误，说需要一个程序集清单。在这里我输了。

我的 C# 很简单：

```
Assembly mylib = Assembly.LoadFile(@"C:\mypath\MyLib.dll"); 
```

我`The module was expected to contain an assembly manifest. (Exception from HRESULT: 0x80131018)`在那条线上得到了一个错误。我对装配清单一无所知。任何有关如何创建和嵌入的方向都将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T19:33:19.747

“组装”一词可能意味着两件事。当您使用 MASM 时，汇编意味着“机器代码”。当您使用 .NET 时，程序集意味着“托管代码的容器”。

Assembly.LoadXxx() 只能加载使用 .NET 工具创建的 .NET 程序集。它不能加载包含纯机器代码的 DLL。您需要使用带有 [DllImport] 属性的 pinvoke 来调用 DLL 中的函数。

您还最好检查您的 DLL 是否确实导出了函数。在 Visual Studio 命令提示符处，对 DLL 运行 dumpbin.exe /exports 以查看导出的名称。您可能看不到“PrintMess”，您需要将 .def 文件传递​​给链接器以告诉它需要导出哪些函数。

# java - JDOM 2 和 xpath

> ID：11940708
> 
> 赞同：5
> 
> 时间：2012-08-13T19:09:35.807
> 
> 标签：java, spring-ws, jdom, jdom-2

以下是摘自 Spring-ws 手册的以下代码：

```
public class HolidayEndpoint {

  private static final String NAMESPACE_URI = "http://mycompany.com/hr/schemas";

  private XPath startDateExpression;

  private XPath endDateExpression;

  private XPath nameExpression;

  private HumanResourceService humanResourceService;

  @Autowired
  public HolidayEndpoint(HumanResourceService humanResourceService)                      (2)
      throws JDOMException {
    this.humanResourceService = humanResourceService;

    Namespace namespace = Namespace.getNamespace("hr", NAMESPACE_URI);

    startDateExpression = XPath.newInstance("//hr:StartDate");
    startDateExpression.addNamespace(namespace);

    endDateExpression = XPath.newInstance("//hr:EndDate");
    endDateExpression.addNamespace(namespace);

    nameExpression = XPath.newInstance("concat(//hr:FirstName,' ',//hr:LastName)");
    nameExpression.addNamespace(namespace);
  } 
```

我的问题是这似乎正在使用 JDOM 1.0，我想使用 JDOM 2.0。

如何将此代码从 JDOM 1.0 转换为 JDOM 2.0？为什么 spring 没有更新他们的示例代码？

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-13T19:38:29.217

JDOM2 还是比较新的......但是，JDOM 1.x 中的 XPath 工厂特别坏......而且 JDOM 2.x 有一个新的 api。旧 API 的存在是为了向后兼容/迁移。看看这个文档这里有一些推理，以及[JDOM 2.x 中的新 API](https://github.com/hunterhacker/jdom/wiki/JDOM2-Feature-XPath-Upgrade "2.x 中的 XPath")。

在您的情况下，您可能希望将代码替换为：

```
XPathExpression<Element> startDateExpression = 
    XPathFactory.instance().compile("//hr:StartDate", Filters.element(), null, namespace);

List<Element> startdates = startDateExpression.evaluate(mydocument); 
```

罗尔夫

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-11T18:07:38.440

为了使用上面来自 Rolf 的代码解析值，遍历列表或从列表中获取第一个元素，假设只有一个元素。

```
List<Element> startdates = startDateExpression.evaluate(mydocument);

    for (Element e: startdates){
        logger.debug("value= " + e.getValue());
    } 
```

或者

```
List<Element> startdates = startDateExpression.evaluate(mydocument);
logger.debug("value " + startdates.get(0).getValue(); 
```

# php - 在php中获取多维数组值

> ID：11940709
> 
> 赞同：0
> 
> 时间：2012-08-13T19:09:36.937
> 
> 标签：php, arrays, multidimensional-array, foreach, associative-array

我在php中有一个像这样的多维数组

```
$shop = array( 
               array("name","point","number"),
               array('Ranjit', 1.25 , 15),
               array('Pitabas', 0.75 , 25),
               array('Khela', 1.15 , 7) 
             ); 
```

现在我必须显示这样的输出

```
name-> ranjit
Point-> 1.25
number->15
name->Pitabas
Point->0.75
number->25
name->Khela
Point->1.15
number->7 
```

我正在尝试 for 循环，但我可以在嵌套的 forloop 中得到结果。请帮助我得到答案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T19:16:24.497

我的解决方案：

```
$headings = array_shift($shop);

foreach ($shop as $item) {
  foreach ($item as $key => $value) {
    echo $headings[$key], '=>', $value;
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T19:13:50.207

您知道第一行将是标题，因此将它们分开存储：

```
$titles = $shop[0]; 
```

那会给你

```
$titles = array('name', 'point', 'number'); 
```

然后遍历你的数组：

```
foreach ($shop as $index => $row) {
    if ($index == 0) 
        continue;

    foreach($row as $column => $item) {
        echo $titles[$column] . " -&gt; " . $item . "<br />";
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T19:14:58.833

这是一个简单的循环：观察我们跳过了外部数组的第一个元素，它被认为包含标题：

```
for ($i = 1; $i != count($shop); ++$i)
{
    print $shop[0][0] . ": ". $shop[$i][0] . "\n";
    print $shop[0][1] . ": ". $shop[$i][1] . "\n";
    print $shop[0][2] . ": ". $shop[$i][2] . "\n";
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-13T19:15:03.580

这应该给出所需的输出：

```
for($x = 1, $lim = sizeof($shop); $x < $lim; $x++)
{
    echo $shop[0][0]."->".$shop[$x][0]."<br>";
    echo $shop[0][1]."->".$shop[$x][1]."<br>";
    echo $shop[0][2]."->".$shop[$x][2]."<br>";
} 
```

# html - 如何正确设置表单样式？

> ID：11940711
> 
> 赞同：1
> 
> 时间：2012-08-13T19:09:47.600
> 
> 标签：html, css

我真的不擅长 CSS，我想知道如何正确地设置表单的样式，以便将每个文本输入和标签放在一行中。像这样 ：

```
<label for="input1">...</label>
<input type="text" id="input1"/>
<label for="input2">...</label>
<input type="text" id="input2"/>
<label for="input3">...</label>
<input type="text" id="input3"/>
<label for="input3">...</label>
<input type="text" id="input3"/> 
```

它将显示在网页中，例如：

```
(label)(input)
(label)(input)
(label)(input)
(label)(input) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-13T19:12:27.513

```
<label>foo</label>
<input type="text"/>
<label>foo</label>
<input type="text"/>​

<style>
input, label { float:left  }
label { clear:left; }
</style> 
```

​</p>

[http://jsfiddle.net/RpRS5/](http://jsfiddle.net/RpRS5/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-13T19:26:43.340

我推荐[A List Apart](http://www.alistapart.com/articles/prettyaccessibleforms/)关于 Prettier Accessible Forms 的本教程。您还可以使用带有一些自定义样式的定义列表，例如，

```
<dl><dt><label></label></dt>
  <dd><input></dd></dl> 
```

和类似的东西：

```
dl dt {
    float: left;
    width: 8em;
} 
```

**编辑：**总结 A List Apart 文章，他们建议您将表单字段放在有序列表中`ol`。标签显示为`inline-block`水平显示在其关联字段旁边。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-13T19:15:16.040

将您的输入放在标签元素中，然后您可以简单地`display: block`使用它们或浮动它们，我更喜欢显示，但它很容易更改。

`<label>Hello <input type="radio" name="what" value="Hello" /></label>`

[http://jsfiddle.net/Bpxfp/](http://jsfiddle.net/Bpxfp/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-13T19:12:06.327

将它们放在一个列表中，或者放在一个类似列表的结构中（也就是说，将每个“行”包装在一个 div 中）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-13T19:29:01.803

[http://jsfiddle.net/ud7YE/1/](http://jsfiddle.net/ud7YE/1/)

您可以通过改变包装器的宽度来控制标签和输入之间的空间。只需将标签的高度和输入的上边距设置为相同的值但为负

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-13T20:11:08.023

我在 div 或列表中找到封闭标签并输入或选择标签。并且标签和选择标签应该是类型`inline-block`

```
<div>
    <label>Name: </label><input type="text" />
</div>

<div>
    <label>Place: </label><input type="text" />
</div> 
```

CSS：

```
label {
    display: inline-block;
}
input {
    display: inline-block;
    padding: 2px;
}
div {
    display: block;
    margin: 2px 0;
} 
```

这会很顺利。

# sublimetext2 - 从 Sublime Text 2 键绑定运行控制台脚本

> ID：11940714
> 
> 赞同：1
> 
> 时间：2012-08-13T19:09:51.443
> 
> 标签：sublimetext2

我想运行单行控制台脚本来切换 Sublime Text 2 中的 spell_check

```
view.settings().set('spell_check', True) 
```

或者

```
view.settings().set('spell_check', False) 
```

通过这样的事情：

```
{ "keys": ["ctrl+alt+s"], "command": "SOMETHING SIMILAR TO WHAT I HAVE ABOVE?" }, 
```

如何将此命令输入到我的键绑定文件中以及如何使其切换？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T19:17:12.347

根据[http://www.sublimetext.com/docs/2/settings.html](http://www.sublimetext.com/docs/2/settings.html) 看起来您应该能够执行以下操作：

```
{
    "keys": ["ctrl+alt+s"],
    "command": "toggle_setting",
    "args":
    {
        "setting": "spell_check"
    }
} 
```

# json - Google plus 时刻 api 添加目标中只有 url 的活动未显示在历史记录选项卡中

> ID：11940717
> 
> 赞同：1
> 
> 时间：2012-08-13T19:10:17.683
> 
> 标签：json, google-plus

我创建了一个活动 json，如下所示并发布到 google plus moment api

var activity = { "type": "http://schemas.google.com/AddActivity", "target": { "url": "http://www.qontext.com" }};

POST 成功，但该时刻未显示历史记录。身份验证得到处理。示例网址工作正常。有人可以帮忙吗。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-15T10:34:45.287

只要提供的目标网址不返回包含所需元数据 (http://schema.org/Thing) 的 (html) 内容，您插入的元素就不会显示在 Google+ 历史记录中（无论响应是否为HTTP 200 与否）。

在请求正文中提供您的元数据（作为“结果”JSON）也不起作用。因此，您必须确保目标 url 将返回包含您要发布的数据的 HTML。

例如，这可以通过一个简单的 PHP 脚本来完成，如下所示：

```
<?php
    $name   = $_GET["name"];
    $desc   = $_GET["desc"];
echo('
    <!DOCTYPE html>
    <html>
      <head>
        <title>emacberry DATA</title>
      </head>
      <body itemscope itemtype="http://schema.org/Thing">
        <section>Name: <div itemprop="name">'.$name.'</div></section>
        <section>Description: <div itemprop="description">'.$desc.'</div></section>
        <section>
          Thumbnail: <img itemprop="image" src="YOUR_LOGO_HERE"/>
        </section>
      </body>
    </html> 
    ');
?> 
```

那么就发帖吧

```
{
    "type":"http://schemas.google.com/AddActivity",
    "target":{
        "url":"http://YOUR_SERVER/YOUR_SCRIPT.PHP?name=A_NAME&desc=A_DESC"
    }
} 
```

通过这样做，您的活动将被添加到 Google+ 历史记录中 - 当然，这意味着与您的服务器的交互 - 这也可以为您带来一些好处。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T19:35:15.760

没有足够的信息可以确定，但我会调查以下内容：

1) 确保在对时刻 API 的调用中有 debug=true。如：

`path: '/plus/v1moments/people/me/moments/vault?debug=true'`

然后确保您正在查看返回的内容以查看是否有任何错误。

2) 确保您在目标页面中有 schema.org 标记。虽然他们通常擅长从页面中获取*某些*内容，但可能只是页面太复杂或太大，以至于他们无法从整个页面中获取有用的信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-15T14:29:35.200

我试着提交你的时刻：

```
{
  "type":"http://schemas.google.com/AddActivity",
  "target":{
      "url":"http://www.qontext.com"
  }
} 
```

到演示应用程序：

[http://plus-history-examples.appspot.com/client-side-flow/index.html](http://plus-history-examples.appspot.com/client-side-flow/index.html)

返回的响应是：

```
{
  "error": {
    "errors": [
      {
        "domain": "global",
        "reason": "badRequest",
        "message": "Unable to fetch metadata."
      }
    ],
    "code": 400,
    "message": "Unable to fetch metadata."
  }
} 
```

[所以我怀疑问题是http://www.qontext.com](http://www.qontext.com)缺少元数据

# tomcat - 将 grails war 文件部署到 Tomcat 服务器

> ID：11940719
> 
> 赞同：1
> 
> 时间：2012-08-13T19:10:24.357
> 
> 标签：tomcat, grails, groovy

我编写了一个`Grails`应用程序，一切正常，然后我生成了`myapp.war`要部署在`Tomcat 6.0`VM 中运行的服务器中的文件。我生成了`.war`文件

```
grails war 
```

然后我将文件移动到`/tomcat/webapp`我的服务器上的位置，并将其扩展到目录`myapp`中。但是，当我尝试访问该应用程序时，我得到：

```
Message:    
FAIL - Application at context path /myapp could not be started 
```

我不熟悉将`.war`文件部署到 Tomcat 服务器。`SpringSource`我正在我的IDE中测试我的应用程序，因为`localhost:8080/myapp`一切正常，但是，当我尝试将其部署到时，`<my-server>:8080/myapp`我收到了该错误消息。有这种情况吗？有人可以帮我解决这个错误吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-14T07:14:36.860

检查 Tomcat 中的日志文件。仔细检查每一行以检查致命错误。可能是日志文件中的一行导致 Tomcat 拒绝启动应用程序。

我有几个案例，其中日志文件中的一个小的“无辜”行是根本原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-17T19:08:24.817

仅供参考，被引用的日志文件位于 %TOMCAT_HOME%/logs 下。

另一种选择是使用 Tomcat 管理器。这是一个关于如何开始的好链接。[https://tomcat.apache.org/tomcat-7.0-doc/manager-howto.html](https://tomcat.apache.org/tomcat-7.0-doc/manager-howto.html)

无论哪种方式，当您单击部署按钮（附图片）时，如果您的战争部署发生了严重问题，它会给您一个错误。它当然不如 catalina 日志或 stdio 日志那么详细，但它可能更容易排除故障，更不用说您不必手动继续传输文件。

[![在此处输入图像描述](../Images/64e152acc36663ac04db6ccc3fc4f08f.png)](https://i.stack.imgur.com/F9NHA.png)

# postgresql - 从 PL/pgSQL 函数返回嵌套的复合类型

> ID：11940720
> 
> 赞同：7
> 
> 时间：2012-08-13T19:10:24.860
> 
> 标签：postgresql, plpgsql, postgresql-9.1

我正在尝试将这种格式的嵌套数据从 PostgreSQL 返回到 PHP 关联数组中。

```
[
  'person_id': 1,
  'name': 'My Name',
  'roles': [
      [ 'role_id': 1, 'role_name': 'Name' ],
      [ 'role_id': 2, 'role_name': 'Another role name' ]
  ]
] 
```

似乎可以使用[复合类型](http://www.postgresql.org/docs/9.1/static/rowtypes.html)。[这个答案](https://stackoverflow.com/a/8108475/173630)描述了如何从函数返回复合类型，但它不处理复合类型的数组。我在使用数组时遇到了一些问题。

这是我的表格和类型：

```
CREATE TEMP TABLE people (person_id integer, name text);
INSERT INTO "people" ("person_id", "name") VALUES
    (1, 'name!');

CREATE TEMP TABLE roles (role_id integer, person_id integer, role_name text);
INSERT INTO "roles" ("role_id", "person_id", "role_name") VALUES
    (1, 1,  'role name!'),
    (2, 1,  'another role');

CREATE TYPE role AS (
    "role_name" text
);

CREATE TYPE person AS (
    "person_id" int,
    "name" text,
    "roles" role[]
); 
```

我的`get_people()`函数解析良好，但存在运行时错误。现在我收到错误：`array value must start with "{" or dimension information`

```
CREATE OR REPLACE FUNCTION get_people()
    RETURNS person[] AS $$
DECLARE myroles role[];
DECLARE myperson people%ROWTYPE;
DECLARE result person[];
BEGIN
    FOR myperson IN
        SELECT *
        FROM "people"
    LOOP
        SELECT "role_name" INTO myroles
        FROM "roles"
        WHERE "person_id" = myperson.person_id;

        result := array_append(
            result,
            (myperson.person_id, myperson.name, myroles::role[])::person
        );
    END LOOP;

    RETURN result;
END; $$ LANGUAGE plpgsql; 
```

***更新***以回答 Erwin Brandstetter 在回答末尾的问题：
是的，我可以返回一个复合类型的 SETOF。我发现 SET 比数组更容易处理，因为 SELECT 查询返回 SET。我宁愿返回嵌套数组的原因是因为我认为将嵌套数据表示为一组行有点尴尬。这是一个例子：

```
 person_id | person_name | role_name | role_id
-----------+-------------+-----------+-----------
         1 | Dilby       | Some role |    1978
         1 | Dilby       | Role 2    |       2
         2 | Dobie       | NULL      |    NULL 
```

在此示例中，人员 1 有 2 个角色，而人员 2 没有。我正在为我的另一个 PL/pgSQL 函数使用这样的结构。我编写了一个脆弱的 PHP 函数，可以将这样的记录集转换为嵌套数组。

这种表示工作正常，但我担心向这个结构添加更多的嵌套字段。如果每个人也有一组工作怎么办？状态？等我的转换功能将不得不变得更加复杂。数据的表示也会很复杂。如果一个人有*n 个*角色、*m*个工作和*o*个状态，则该人填充`max(n, m, o)`行，其中`person_id`,`person_name`，以及它们在额外行中无用地复制的任何其他数据。我一点也不担心性能，但我想以最简单的方式做到这一点。当然..也许这是最简单的方法！

我希望这有助于说明为什么我宁愿直接处理 PostgreSQL 中的嵌套数组。当然，我很想听听您的任何建议。

对于使用 PHP 处理 PostgreSQL 复合类型的任何人，我发现这个库对于在 PHP 中解析 PostgreSQL 的 array_agg() 输出非常有用：[https](https://github.com/nehxby/db_type) ://github.com/nehxby/db_type 。此外，这个项目看起来很有趣：[https ://github.com/chanmix51/Pomm](https://github.com/chanmix51/Pomm)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-13T21:40:02.657

考虑使用 PostgreSQL 9.1.4 测试的这个（改进和修复的）测试用例：

```
CREATE SCHEMA x;
SET search_path = x, pg_temp;

CREATE TABLE people (person_id integer primary key, name text);
INSERT INTO people (person_id, name) VALUES
 (1, 'name1')
,(2, 'name2');

CREATE TABLE roles (role_id integer, person_id integer, role_name text);
INSERT INTO roles (role_id, person_id, role_name) VALUES
 (1, 1, 'role name!')
,(2, 1, 'another role')
,(3, 2, 'role name2!')
,(4, 2, 'another role2');

CREATE TYPE role AS (
  role_id   int
 ,role_name text
);

CREATE TYPE person AS (
  person_id int
 ,name text
 ,roles role[]
); 
```

功能：

```
CREATE OR REPLACE FUNCTION get_people()
    RETURNS person[]  LANGUAGE sql AS
$func$
SELECT ARRAY (
   SELECT (p.person_id, p.name
          ,array_agg((r.role_id, r.role_name)::role))::person
   FROM    people p
   JOIN    roles r USING (person_id)
   GROUP   BY p.person_id
   ORDER   BY p.person_id
   )
$func$; 
```

称呼：

```
SELECT get_people(); 
```

清理：

```
DROP SCHEMA x CASCADE; 
```

核心特点是：

*   一个非常简化的函数，它只包装一个普通的 SQL 查询。
*   您的主要错误是您`role_name text`从 table 中获取`roles`并将其视为不是的类型`role`。

我会让代码自己说话。要解释的太多了，我现在没有更多的时间了。

这是非常高级的东西，我不确定你真的需要返回这个嵌套类型。也许有更简单的方法，比如非嵌套复杂类型的 SET？

# jquery - 设计我的导航栏

> ID：11940721
> 
> 赞同：1
> 
> 时间：2012-08-13T19:10:30.093
> 
> 标签：jquery, html, navigation

我创建了这个栏，单击时会打开幻灯片。但是，我只希望它在单击 + 时打开。我有 + 超链接，但我不知道如何使滑块只响应 + 并使侧边栏恢复正常（现在它在内容 div 下方移动。请帮助。

```
 <!DOCTYPE HTML>

<html>
    <head>
        <title>Title</title>
        <link rel="stylesheet" href="style.css">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js">   </script>
    </head>

    <body>

    <div id="wrapper">
        <div id="nav">
        <div id="menu-expand">
        <a href="#" class="closed"><span>+</span></a>
        </div>
        </div>
            <div id="content"></div>
    </div>

    <!-- Scripts -->

<script>
    $(function() {
    $('#nav').click(function() {
        var leftMargin = ($(this).css('margin-left') === '0px') ? '-150px' : '0px';
        $(this).animate({ 'margin-left' : leftMargin }, 500);
    });
});

</script>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T19:13:24.620

点击事件在 DOM 中“冒泡”，在每个父元素上触发，*除非*您使用`ev.stopPropagation()`：

```
$('#nav').click(function(ev) {
    ev.stopPropagation();
    var leftMargin = ($(this).css('margin-left') === '0px') ? '-150px' : '0px';
    $(this).animate({ 'margin-left' : leftMargin }, 500);
}); 
```

# javascript - 全局定义函数中的 noSuchMethod

> ID：11940723
> 
> 赞同：1
> 
> 时间：2012-08-13T19:10:38.760
> 
> 标签：javascript

我知道，`__noSuchMethod__`但我不确定如何为这样调用的函数获取此信息。

```
someThing(); 
```

例如，我知道我可以做到这一点

```
var global = Function('return this')();
global.__noSuchMethod__ = function(id, args) {
  console.log('No Such Method');
}
global.notDefined(); 
```

但它不适用于这个

```
var global = Function('return this')();
global.__noSuchMethod__ = function(id, args) {
  console.log('No Such Method');
}
notDefined(); 
```

很明显，我仍然需要学习一些 Javascript 基础知识。

我想要完成的是捕获在对象外部调用的函数。如果这是有道理的。如果我的术语有点偏离，我深表歉意。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T19:19:08.053

这是 Firefox 中的一个已知错误（我假设这是您正在测试的内容）

[https://bugzilla.mozilla.org/show_bug.cgi?id=466239](https://bugzilla.mozilla.org/show_bug.cgi?id=466239)

# python - 使 django 模板对象可迭代

> ID：11940724
> 
> 赞同：0
> 
> 时间：2012-08-13T19:10:46.943
> 
> 标签：python, django, django-templates

我有一本具有许多特征的字典：

```
sort_options = SortedDict([
    ("importance" , ("Importance" , "warning-sign" , "importance")),
    ("effort" , ("Effort" , "wrench" , "effort")),
    ("time_estimate" , ("Time Estimate" , "time" , "time_estimate")),
]) 
```

我还有一个操作列表作为查询结果。每个动作都有这些属性；在我的模板中，我可以调用 {{ action.effort }} 或 {{ action.time_estimate }} 并获得结果。

我正在遍历我的 sort_options 以填充 twitter 引导图标：

```
{% for key, icon in sort_options.items %}
    <i class="icon-{{ icon.1 }}"></i>
{% endfor %} 
```

但我也想显示每个属性的动作值。本质上，类似：

```
{% for key, icon in sort_options.items %}
    <i class="icon-{{ icon.1 }}"></i>
    {{ action.key }}
{% endfor %} 
```

关键将解析为“重要性”或“努力”。我知道这行不通。所以我试图利用[这个问题](https://stackoverflow.com/questions/35948/django-templates-and-variable-attributes)中提出的解决方案。

该解决方案提出了一个模板过滤器：

```
def hash(h,key):
    if key in h:
        return h[key]
    else:
        return None
register.filter(hash)

{{ user|hash:item }} 
```

问题使用了一个看起来像这样的字典：

```
{'item1': 3, 'name': 'username', 'item2': 4} 
```

我尝试了以下方法：

```
{% for key, icon in sort_options.items %}
    <i class="icon-{{ icon.1 }}"></i>
    {{ action|hash:key }}
{% endfor %} 
```

但出现错误：

```
Caught TypeError while rendering: argument of type 'Action' is not iterable 
```

我相信这是因为模板过滤器只获取对象的一个​​属性（可能是名称），而不是整个字典：

```
[<Action: Action_one>, <Action: Task_two>...] 
```

有没有办法强制模板将完整对象传递给模板标签？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T20:09:15.380

我想我终于明白了。你想要相当于

```
getattr(action, key) 
```

在您的模板中。[这个答案](https://stackoverflow.com/a/1112236/399367)描述了`getattribute`你需要这样做的模板标签。

# algorithm - 比较大 O 表示法

> ID：11940730
> 
> 赞同：2
> 
> 时间：2012-08-13T19:11:12.877
> 
> 标签：algorithm, big-o, asymptotic-complexity

在 n 元素数组中排序处理需要；
在 X 算法中：10 ^(-8) n ²秒，
在 Y 算法中 10 ^(-6) n log [2] n 秒，
在 Z 算法中 10 ^(-5)秒。

我的问题是如何比较它们。例如对于 y 根据 x 工作得更快，我应该选择哪个元素的数量？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-13T19:21:53.763

比较 Big-Oh 符号时，忽略所有常量：

N^2 比 N*log(N) 具有更高的增长率，后者仍然比 O(1) [常数] 增长得更快。

N 的幂决定了增长率。

例子：

```
O(n^3 + 2n + 10) > O(200n^2 + 1000n + 5000) 
```

忽略常量（对于纯粹的大哦比较应该如此），这减少为：

```
O(n^3 + n) > O(n^2 + n) 
```

忽略低阶项的进一步减少产生：

```
O(n^3) > O(n^2) 
```

因为 N 的幂`3 > 2`。

Big-Oh 遵循这样的层次结构：

```
O(1) < O(log[n]) < O(n) < O(n*log[n]) < O(n^x) < O(x^n) < O(n!) 
```

（其中 x 是任何大于 1 的量，即使是最小的位。）

您可以通过一些我不会在此处发布但应该在 Wikipedia 中查找的规则来比较任何其他表达式。我列出`O(n*log[n])`是因为它在排序算法中相当常见；有关具有不同底数或不同幂的对数的详细信息，请查看参考来源（我提到过维基百科吗？）

试一试 wiki 文章：[http ://en.wikipedia.org/wiki/Big_O_notation](http://en.wikipedia.org/wiki/Big_O_notation)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T17:48:31.053

我提出了这个不同的解决方案，因为还没有一个公认的答案。

如果您想查看`n`一种算法的性能比另一种更好，您应该将算法时间设置为彼此相等并求解`n`.

例如：

```
X = Z  
10^-8 n^2 = 10^-5  
n^2 = 10^3  
n = sqrt(10^3)
let c = sqrt(10^3) 
```

所以比较`X`and的时候`Z`，选择`X`if `n`is less than `c`, `Z`if `n`is greater than `c`。这可以在其他两对之间重复。

# php - PHP 格式化字符串类似于 MySQL 数组结果

> ID：11940731
> 
> 赞同：0
> 
> 时间：2012-08-13T19:11:14.150
> 
> 标签：php, string, html-table, format

下面是我的名为 $output 的字符串，它来自 fsockopen 和 fread。唯一可以改变的是 fread 但在此之前没有别的。

```
14336.0 K9IA 13-Aug-2012 1750Z washington, dc (throb) 
14336.0 K9IA 13-Aug-2012 1750Z fond du lac, wi (ssb) 
14336.0 K9IA 13-Aug-2012 1752Z calumet, wi (ssb) 
14336.0 K9IA 13-Aug-2012 1752Z carsen city, nv (ssb) 
14336.0 K9IA 13-Aug-2012 1753Z carson city, nv (ssb) 
14336.0 K9IA 13-Aug-2012 1754Z dane, wi (ssb) 
14336.0 K9IA 13-Aug-2012 1759Z dane, wi (cw) 
14336.0 KA2TED 13-Aug-2012 1759Z Carson City,NV(SSB) 
14336.0 K9IA 13-Aug-2012 1800Z dane, wi (psk) 
14336.0 K9IA 13-Aug-2012 1801Z bristol, va (psk) 
14336.0 K9IA 13-Aug-2012 1815Z caeson city, nv (rtty) 
14336.0 K9IA 13-Aug-2012 1816Z carson city, nv (rtty) 
```

然后我获取字符串 $output 并执行以下操作：

```
$output = str_replace("\n", "<br>", $output); 
```

这会在右括号 ) 之后插入换行符并形成 12 行。到目前为止完美。

我需要做的是立即获取 $output 并能够在格式良好的表格中显示它。

我的意思是......

每个都是一个字段，就像在数组中一样......我想使用与 MySql 数据相同的格式，如下所示：

```
 while($row = mysqli_fetch_array($result))
    echo $row['Freq'];
    echo "</td><td>";
    echo $row['Call'];
    echo "</td><td>";
    echo $row['Date'];
    echo "</td><td>"; 
    echo $row['Time'];
    echo "</td><td>";
    echo $row['CTYState'];
    echo "</td><td>";
    echo $row['Mode'];
    echo "</td><td>"; 
```

每个分开的原因是我需要使用给定字段执行其他功能，例如链接等。我已经搜索、尝试、沮丧并且知道一定有办法。我在 VB 和 PHP 中一遍又一遍地使用 MySQL 或 odbc_connect 完成此操作，但从未使用字符串。

更新....

我使用 Ed Manot 发布的方法，因为我可以将这些字段用于链接、不同颜色等......

但..........

它并不能很好地工作。我只能看到前 2 个字段。我可以看到的字段只有字段 1 和字段 3。使用您的原始代码，我只能看到 1 14336.0 而没有别的。有任何想法吗？

```
echo "<table border='1'>";
echo"<tr><th>FieldA</th><th>FiledB</th><th>FiledC</th><th>FieldD</th><th>FieldE</th>    <th>FiledF</th><th>FiledG</th></tr>\n";
//split the output into lines based on the line break character
$lines = explode("\n", $output);
foreach($lines as $line) {
//split the line into fields based on the space character
 $fields = explode(" ", $line);
 echo "<td>" .$fields[0]. "</td>";
 echo "<td>" .$fields[1]. "</td>";
 echo "<td>" .$fields[2]. "</td>";
 echo "<td>" .$fields[3]. "</td>";
 echo "<td>" .$fields[4]. "</td>";
 echo "<td>" .$fields[5]. "</td>";
 echo "<td>" .$fields[6]. "</td>";
 echo "<td>" .$fields[7]. "</td>";

}
echo '</table>'; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T19:19:52.560

您需要将数据拆分为数组：

```
//split the output into lines based on the line break character
$lines = explode("\n", $output);
foreach($lines as $line) {
  //split the line into fields based on the space character
  $fields = explode(" ", $line);
  echo "<td>" . $fields[0] . "</td>";
  echo "<td>" . $fields[1] . "</td>";
  echo "<td>" . $fields[2] . "</td>";
  // etc...
} 
```

[http://php.net/manual/en/function.explode.php](http://php.net/manual/en/function.explode.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T19:27:29.633

不要替换回车符（如果真的有的话？）并做一些（肮脏的）比如：

```
$lines = explode("\n", $output);
echo '<table>';
foreach($lines as $line) {
    echo '<tr>';
    $parts = explode(" ", $line);
    echo '<td>'.implode("</td><td>", $parts).'</td>'; 
    echo '</tr>';
}
echo '</table>'; 
```

:D

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T15:07:03.060

我解决了这个问题。而不是空格，胡萝卜 ^ 被使用。它们显示为空格，但不是。使用正则表达式将 ^ 替换为“”。现在工作。

# grammar - 通过生产规则向 LALR(1) 语法添加错误检查以处理所有输入

> ID：11940733
> 
> 赞同：2
> 
> 时间：2012-08-13T19:11:19.507
> 
> 标签：grammar, yacc, lex, lalr

我有一个表示表达式的语法。为简单起见，假设它是：

```
S -> E
E -> T + E | T
T -> P * T | P
P -> a | (E) 
```

, `a`, `+`,`*`和是我的字母表中的字母`(`。`)`

上述规则可以使用正确的运算顺序和关联性生成包含括号、乘法和加法的有效算术表达式。

我的目标是接受每个字符串，其中包含 0 个或更多字母。这是我的限制：

*   语法必须“接受”所有包含 0 个或多个字母的字符串。
*   可以通过算法引入新终端并将其插入到输入中。（我发现`EOF`，出于某种原因，在检测到超出其他有效表达式的额外标记时，显式提供终端会有所帮助。）
*   可能会引入新的生产规则。新规则将是错误标志（即，如果使用 1 解析字符串，那么尽管字符串被接受，但在语义上被认为是错误）。
*   可以修改产生规则以便插入新引入的终端。
*   语法应该是 LALR(1)，至少可以由 Lex/Yacc 类工具处理（如果我记得悬空的 else 问题需要非 LALR(1)，尽管与 Lex/Yacc 兼容）。

此外，我希望额外的规则对应于不同类型的错误（缺少二进制操作的参数、缺少括号 - 左或右 - 超出其他可接受的表达式的额外标记等）。我这么说是因为可能有一些简单的方法可以回答我的问题以“接受”所有输入，否则这些输入对错误报告无益。

我发现这些规则很有用，尽管我不知道它们是否违反了我的约束：

```
P -> @      [error]
P -> (E     [error]
S -> E $    [instead of S -> E]
S -> E X $  [error]
X -> X Y    [error]
X -> Y      [error]
Y -> a      [error]
Y -> (      [error]
Y -> )      [error]
Y -> *      [error]
Y -> +      [error] 
```

where`$`是显式`EOF`标记，`@`是空字符串。

* * *

如果我的问题不清楚：如何在我的约束范围内修改我的语法以实现接受所有输入的目标，最好是规则与错误类型的良好对应？我的规则是否符合我的目标？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-04-21T16:06:09.513

这个问题已经存在了一段时间，涵盖了该主题的初学者经常访问的主题。人们经常会发现，那些在本科阶段上过编译器课程的人都知道，这是那些没有简单或单一答案的问题之一。您可能已经注意到您有[两个关于同一主题的问题](https://stackoverflow.com/questions/11870125/error-recovery-in-an-lalr1-grammar)，但都没有得到回答。[其他人发布](https://stackoverflow.com/questions/21806955/can-parser-error-recovery-be-guided-automatically-by-the-grammar)的另一个问题是通过指向解释为什么这很难的文献来回答的。

这是一个存在 50 多年的问题。如果随着时间的推移检查文献，从早期的会议论文、课程教科书、博士论文和（今天）`SO`，我们可以看到经常提到这是*一个错误的问题*这一事实！（或者更确切地说是解决问题的错误方法）。

只是从多年来的课程文本中抽取样本（从我的书架上随机选择）：

Gries, D. (1970) 错误恢复和纠正 - 文献简介，*编译器构造，高级课程*，由 Bauer, FL & Eickel, J., Springer Verlag, pp.627-638 编辑。
Gries, D. (1971)*数字计算机的编译器构建*，Wiley，pp.320-326。
Aho, AV, Ullman, JD (1977)*编译器设计原理*，Addison Wesley，pp.397-405。
Bornat, R. (1979)*理解和编写编译器*，Macmillan，pp.251-252。
Hanson, D. (1995) *A retargetable **C** compiler: Design and Implementation* , Addison-Wesley, pp.140-146。
Grune, D., Bal, HE, Jacobs, CJH & Langendoen, KG (2000)*现代编译器设计*，Wiley，第 175-184 页。
Aho, AV, Lam, MS, Sethi, R., Ullman, JD (2007)*编译器：原理、技术和工具*，Pearson, Addison-Wesley，pp.283-296。

所有这些（超过 40 年的跨度）都同意您的问题是关于错误地使用错误的工具或朝着错误的方向前进。我想我想说“你不能从这里到那里”。你应该从别的地方开始。

如果你想要更深层次的东西，有一个完整的博士论文：

[Charles, P. (1991) *A Practical method for Constructing Efficient LALR(k) Parser with Automatic Error Recovery*，纽约大学](http://jikes.sourceforge.net/documents/thesis.pdf)

希望将来再次访问此问题的人可以找到答案的占位符。

* * *

我从对您的其他问题的评论中注意到您正在使用源自 CPPG 的 MPPG。不是每个人都会使用这些工具，所以我提供了一些指向这些工具的链接：

[Managed Babel Systems Essentials](https://msdn.microsoft.com/en-us/library/bb165963%28v=vs.80%29.aspx)
[Garden Points Parser Generator](https://gppg.codeplex.com/)
[Irony .NET 编译器构建工具包](http://www.codeproject.com/Articles/22650/Irony-NET-Compiler-Construction-Kit)
[编写您的第一个 Visual Studio 语言服务](http://www.codeproject.com/Articles/33250/Writing-Your-First-Visual-Studio-Language-Service)

# javascript - MongoDB node-mongodb-native map/reduce

> ID：11940736
> 
> 赞同：0
> 
> 时间：2012-08-13T19:11:27.803
> 
> 标签：javascript, node.js, mongodb, database

我有一个使用 node-mongodb-native 的 map/reduce 方法。我试图只返回“product_id”上的不同记录。这是我到目前为止所拥有的：

```
 var map = function() {
            emit("_id", {"_id" : this._id, 
                         "product_id" : this.product_id,
                         "name" : this.name 
                         });
        }

        var reduce = function(key, values) {

            var items  = [];
            var exists;

            values.forEach(function(value) {

                if(items.length > 0) {

                    items.forEach(function(item_val, key) {
                        if(item_val.product_id == value.product_id) {
                            exists = true;
                        }
                    });

                    if(!exists) {
                        items.push(value);
                    }

                    exists = false;

                } else {

                    items.push(value);
                }
            }); 

            return {"items" : items};
        }

        this.collection.mapReduce(map, reduce, {out : {inline: 1}, limit: 4}, function(err, results) {
            if (err) {
                console.log(err);
            } else {
                console.log(results[0].value.items);
            }
        }); 
```

我的逻辑似乎不起作用。它仍然会添加 product_id 相同的重复记录。

任何帮助都会很棒-谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T20:39:44.100

事实上，你试图做的一个例子：

```
var map = function() {
    emit(this.product_id, {"_id" : this._id, "name" : this.name });
}

var finailise = function(key, value){
    return value[0]; // This might need tweaking, ain't done MRs in a while :/
} 
```

但是请注意，有两种不同的类型：

*   首先找到
*   最后发现

没有标准的区分方法，每个数据库都有自己的方法，它甚至在 SQL 数据库中都不是标准的，所以你要知道你想要区分的方式。上面的第一个发现是不同的。您可以进行最后一次查找，例如：

```
var finailise = function(key, value){
    return value[value.length-1]; 
} 
```

或类似的东西，无论如何应该让你开始。

希望能帮助到你，

# jquery - 如何让所有行在 h:dataTable 中显示 datepicker

> ID：11940739
> 
> 赞同：0
> 
> 时间：2012-08-13T19:11:32.140
> 
> 标签：jquery, jsp, jsf

我使用了这个例子： [Integrating jquery datepicker into jsf](https://stackoverflow.com/questions/8226840/integrating-jquery-datepicker-into-jsf)。

dataTable 的第一行带有日历图标，但其余行没有。该表是动态的，并且基于从支持 bean 中的查询中选择的行。

这是我所拥有的：

```
<!doctype html public "-//W3C//DTD HTML 4.0 Transitional//EN">

<%@ taglib uri="http://java.sun.com/jsf/html" prefix="h" %>
<%@ taglib uri="http://java.sun.com/jsf/core" prefix="f" %>

<f:view>
<custom:html>
 <custom:head>
 <meta http-equiv="Content-type" content="text/html; charset=utf-8">
    <!-- jQuery -->
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.22/jquery-ui.min.js"></script>
    <!-- required plugins -->
    <script type="text/javascript" src="../scripts/date.js"></script>
    <!-- jquery.datePicker.js -->
    <script type="text/javascript" src="../scripts/jquery.datePicker.js"></script>  
    <!-- datePicker required styles -->
    <link rel="stylesheet" type="text/css" media="screen" href="../styles/datePicker.css">
    <!-- page specific styles -->
    <link rel="stylesheet" type="text/css" media="screen" href="../styles/ewrwsdatepicker.css">

    <!-- page specific scripts -->
    <script type="text/javascript" charset="utf-8">
    $(document).ready(function() {
    // Shared properties for all datepickers with class="date-pick"
        $('.date-pick').datePicker({clickInput:true,startDate:'01/01/1996'});
        });
    </script>

</custom:head>
<custom:body>
<h:form id="adminSubmittedReportScreen">

<div id="content">
<div class="container"> 

<h:outputText value="&lt;br/&gt;" escape="false" />            
<h:outputText value="&lt;br/&gt;" escape="false" />            
<h:outputText value="&lt;br/&gt;" escape="false" />
<h:outputText style="font-family: Verdana; font-size:14px; font-weight:bold;" value="Some Data"/>
<h:dataTable id="adminDatafor" border="0"           
    styleClass="weeklyStatus"
    value="#{viewAdminSubmittedReport.performerWorkList}"
    rowClasses="#{viewAdminSubmittedReport.rowColor}"
    var="performerWorkList"> 
    <h:column>
        <f:facet name="header"><h:outputText value="Customer"/></f:facet>
        <h:outputText title="Customer" style="width: 100px;" value="#{performerWorkList.customer}"/>
    </h:column>
    <h:column>
        <f:facet name="header"><h:outputText value="Location"/></f:facet>
        <h:outputText style="width: 65px;" title="Location" value="#{performerWorkList.location}"/>
    </h:column>
    <h:column>
        <f:facet name="header"><h:outputText value="Actual Start Date" escape="false"/></f:facet>
        <h:inputText id="startDate" title="Actual Start Date" styleClass="date-pick" style="width: 75px;#{performerWorkList.init_actualStartDateHL}" value="#{performerWorkList.actualStartDateToActivity}" valueChangeListener="#{listController.filterFieldChanged}"><f:convertDateTime type="date" pattern="MM-dd-yyyy"/>
        </h:inputText>
    </h:column>
</h:dataTable>

</body>
</html>

</div>
</div>

</h:form>
</custom:body>
</custom:html>
</f:view> 
```

如何获取剩余行的工作日期？

谢谢！

# c# - RichTextBox 语法高亮

> ID：11940744
> 
> 赞同：4
> 
> 时间：2012-08-13T19:11:39.087
> 
> 标签：c#, richtextbox

我正在使用[此代码](http://www.codeproject.com/Articles/10675/Enabling-syntax-highlighting-in-a-RichTextBox)。它用于在`RichTextBox`. 我正在专门研究函数`ProcessLine()`and `OnTextChanged()`，我已经对其进行了如下修改：

```
protected override void OnTextChanged(EventArgs e)
{
    // Calculate stuff here.
    m_nContentLength = this.TextLength;

    int nCurrentSelectionStart = SelectionStart;
    int nCurrentSelectionLength = SelectionLength;

    m_bPaint = false;

    // Find the start of the current line.
    m_nLineStart = nCurrentSelectionStart;
    while ((m_nLineStart > 0) && (Text[m_nLineStart - 1] != '\n'))
        m_nLineStart--;
    // Find the end of the current line.
    m_nLineEnd = nCurrentSelectionStart;
    while ((m_nLineEnd < Text.Length) && (Text[m_nLineEnd] != '\n'))
        m_nLineEnd++;
    // Calculate the length of the line.
    m_nLineLength = m_nLineEnd - m_nLineStart;
    // Get the current line.
    m_strLine = Text.Substring(m_nLineStart, m_nLineLength);

    // Process this line.
    ProcessLine();

    m_bPaint = true;
}

// Process a line.
private void ProcessLine()
{
    // Save the position and make the whole line black
    int nPosition = SelectionStart;
    SelectionStart = m_nLineStart;
    SelectionLength = m_nLineLength;
    SelectionColor = Color.Black;

    /*// Process the keywords
    ProcessRegex(m_strKeywords, Settings.KeywordColor);
    // Process numbers
    if(Settings.EnableIntegers)
        ProcessRegex("\\b(?:[0-9]*\\.)?[0-9]+\\b", Settings.IntegerColor);
    // Process strings
    if(Settings.EnableStrings)
        ProcessRegex("\"[^\"\\\\\\r\\n]*(?:\\\\.[^\"\\\\\\r\\n]*)*\"", Settings.StringColor);
    // Process comments
    if(Settings.EnableComments && !string.IsNullOrEmpty(Settings.Comment))
        ProcessRegex(Settings.Comment + ".*$", Settings.CommentColor);*/

    SelectionStart = nPosition;
    SelectionLength = 0;
    SelectionColor = Color.Red;

    m_nCurSelection = nPosition;
} 
```

*   我的第一个问题是，当我进入`ProcessLine()`in 时`OnTextChanged()`，我是否总是在末尾有一个换行符`m_strLine`？最小值会`m_strLine`是“\n”还是最大的“any#ofchars+\n”？

*   就这样我有这个权利，`SelectionStart`我的插入符号位置是否`SelectionLength`为零，如果`SelectionLength`大于零，我的插入符号在`SelectStart+SelectionLength`？

*   我正在尝试修改此代码以为许多不同的语法表达式着色，并且我计划为每一行一次遍历一个字符。粘贴或加载超过 20k 行的文件时，这怎么可能公平？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-13T19:50:02.470

我现在只能建议您使用一些稳定、功能更强大且不易出错的东西，例如 Scintilla for .NET 和 Color Code。这些控件是免费和开源的。试试看：

[ScintillaNET](http://scintillanet.codeplex.com/)
[ColorCode - .NET 的语法高亮/着色](http://colorcode.codeplex.com/)

RichTextBox 在处理大文本时效率极低。即使你得到了一些不错的突出显示，性能问题也会很快开始出现。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T19:59:54.427

这将非常糟糕地扩展。如果您的目标只是一个正常运行的应用程序，您应该按照 DelegateX 的建议去做；如果你想学习如何做，首先要找出减少完成工作量的方法。为此，这里有一些**一般性的指示：**

仅突出显示窗口内的文本将是一个没有任何视觉副作用的巨大改进 - 它可能也可以将文本分成块（按函数、方法、类等）并仅突出显示可见块，甚至遮挡部分，以避免偏移起始位置影响高光的问题。如果您不这样做，您将遇到这样的情况，即第一行渲染的行位于**if**或括号块的中间，因此您会得到一个不平衡的语法树。

您仍然无法使用 RichTextBox 控件处理 20k 行，但几千行应该很快。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-11-15T17:23:41.483

面对同样的问题并且未能找到“5 分钟准备就绪”的解决方案，我开发了自己的 RichTextBox 扩展来突出显示 XML。

由于时间压力，我开发得很快，没有时间修改它——所以请随时改进它。

只需复制并粘贴扩展代码以与您的 RichTextBox 一起使用或复制整个应用程序代码，包括同步和异步使用

***扩展方法***

```
// Use for asynchronous highlight
public delegate void VoidActionOnRichTextBox(RichTextBox richTextBox);

// Extension Class
public static class RichTextBoxExtensions
{
    public static void HighlightXml(this RichTextBox richTextBox)
    {
        new StandardHighlight().HighlightXml(richTextBox);
    }
    public async static void HighlightXmlAsync(this RichTextBox richTextBox)
    {
        var helper = new StandardHighlight();
        var win = new MainWindow();
        await Task.Factory.StartNew(() =>
        {
            richTextBox.Dispatcher.BeginInvoke(new VoidActionOnRichTextBox(helper.HighlightXml), richTextBox);
        });
    }        
}

// You can extent it with more highlight methods
public class StandardHighlight
{        
    public void HighlightXml(RichTextBox richTextBox)
    {
        // Collect Text-Box Information
        var textRange = new TextRange(richTextBox.Document.ContentStart, richTextBox.Document.ContentEnd).Text;
        XDocument xDocument;
        try
        {
            xDocument = XDocument.Parse(textRange);
        }
        catch
        {
            return;
        }
        var documentLines = xDocument.ToString().Split(new[] { Environment.NewLine }, StringSplitOptions.None);

        // Get the Longest Line Length
        int? maxVal = null;
        for (int i = 0; i < documentLines.Length; i++)
        {
            int thisNum = documentLines[i].Length;
            if (!maxVal.HasValue || thisNum > maxVal.Value) { maxVal = thisNum; }
        }

        // Set Text-Box Width & Clear the Current Content
        if (maxVal != null) richTextBox.Document.PageWidth = (double)maxVal * 5.5;
        richTextBox.Document.Blocks.Clear();

        #region *** Process Lines ***
        foreach (var documentLine in documentLines)
        {
            // Parse XML Node Components
            var indentSpace = Regex.Match(documentLine, @"\s+").Value;
            var xmlTags = Regex.Matches(documentLine, @"(<[^/].+?)(?=[\s])|(<[^/].+?>)|(</.+?>)");
            if (documentLine.Contains("<!--")) xmlTags = Regex.Matches(documentLine, @"(<[^/].+?>)"); // Parse comments
            var nodeAttributes = Regex.Matches(documentLine, @"(?<=\s)(.+?)(?=\s)");

            // Process XML Node
            var nodeAttributesCollection = new List<Run>();
            if (nodeAttributes.Count > 0)
            {
                for (int i = 0; i < nodeAttributes.Count; i++)
                {
                    if (!(nodeAttributes[i].Value.Length < 2) && !(documentLine.Contains("<!--")))
                    {
                        var attributeName = $"{Regex.Match(nodeAttributes[i].Value, @"(.+?=)").Value}";
                        if (i == 0) attributeName = $" {Regex.Match(nodeAttributes[i].Value, @"(.+?=)").Value}";
                        var attributeValue = $"{Regex.Match(nodeAttributes[i].Value, @"(?<=(.+?=))"".+?""").Value} ";

                        if (i == nodeAttributes.Count - 1) attributeValue = attributeValue.Trim();
                        nodeAttributesCollection.Add(new Run { Foreground = new SolidColorBrush(Colors.Green), Text = $"{attributeName}" });
                        nodeAttributesCollection.Add(new Run { Foreground = new SolidColorBrush(Colors.Brown), Text = $"{attributeValue}" });
                    }
                }
            }

            // Initialize IndentSpace
            Run run = null;
            if (indentSpace.Length > 1) run = new Run { Text = indentSpace };

            // Initialize Open Tag
            var tagText = xmlTags[0].Value.Substring(1, xmlTags[0].Value.Length - 2);
            var tagTextBrush = new SolidColorBrush(Colors.Blue);
            var tagBorderBruh = new SolidColorBrush(Colors.Red);
            if (tagText.StartsWith("!--"))
            {
                tagTextBrush = new SolidColorBrush(Colors.DarkSlateGray);
                tagBorderBruh = new SolidColorBrush(Colors.DarkSlateGray);
            }
            var openTag = new Run
            {
                Foreground = tagTextBrush,
                Text = tagText
            };

            // Initialize Content Tag
            var content = new Run
            {
                Foreground = new SolidColorBrush(Colors.Black),
            };

            // Initialize Paragraph
            var paragraph = new Paragraph();
            paragraph.Margin = new Thickness(0);
            if (run != null) paragraph.Inlines.Add(run); // Add indent space if exist

            // Process Open Tag
            paragraph.Inlines.Add(new Run { Foreground = tagBorderBruh, Text = "<" });
            paragraph.Inlines.Add(openTag);

            // Process Open Tag Attributes
            if (nodeAttributesCollection.Count > 0)
            {
                nodeAttributesCollection.ForEach(attribute => { paragraph.Inlines.Add(attribute); });
                nodeAttributesCollection.Clear();
            }
            paragraph.Inlines.Add(new Run { Foreground = tagBorderBruh, Text = ">" });

            // Process Closing Tag
            if (xmlTags.Count > 1)
            {
                Run closingTag = new Run();
                content.Text = documentLine.Replace(xmlTags[0].Value, "").Replace(xmlTags[1].Value, "").Trim();
                closingTag = new Run
                {
                    Foreground = new SolidColorBrush(Colors.Blue),
                    Text = xmlTags[1].Value.Substring(1, xmlTags[1].Value.Length - 2)
                };
                paragraph.Inlines.Add(content);

                paragraph.Inlines.Add(new Run { Foreground = new SolidColorBrush(Colors.Red), Text = "<" });
                paragraph.Inlines.Add(closingTag);
                paragraph.Inlines.Add(new Run { Foreground = new SolidColorBrush(Colors.Red), Text = ">" });
            }
            richTextBox.Document.Blocks.Add(paragraph);
        }
        #endregion
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-12-01T09:50:21.957

固定版本 - 处理 JSON 作为内部文本和更好的元素提取

```
 public static void HighlightXml(this RichTextBox richTextBox)
        {
            // Collect Text-Box Information
            var textRange = new TextRange(richTextBox.Document.ContentStart, richTextBox.Document.ContentEnd).Text;
            XmlDocument xmlDocument = new XmlDocument();
            try
            {
                xmlDocument.LoadXml(textRange.Trim());
            }
            catch
            {
                return;
            }
            var documentLines = xmlDocument.OuterXml.Split(new[] { Environment.NewLine }, StringSplitOptions.None);

            // Get the Longest Line Length
            int? maxVal = null;
            for (int i = 0; i < documentLines.Length; i++)
            {
                int thisNum = documentLines[i].Length;
                if (!maxVal.HasValue || thisNum > maxVal.Value) { maxVal = thisNum; }
            }

            // Set Text-Box Width & Clear the Current Content
            if (maxVal != null) richTextBox.Document.PageWidth = (double)maxVal * 10;
            richTextBox.Document.Blocks.Clear();

            #region *** Process Lines ***
            foreach (var documentLine in documentLines)
            {
                // Parse XML Node Components
                var indentSpace = Regex.Match(documentLine, @"\s+").Value;
                var xmlTags = Regex.Matches(documentLine, @"(?<=<)[^>\s+]*");
                if (documentLine.Contains("<!--")) xmlTags = Regex.Matches(documentLine, @"(<[^/].+?>)");
                var nodeAttributes = Regex.Matches(documentLine, @"(?<=\s)[^><:\s]*=*(?=[>,\s])");

                // Process XML Node
                var nodeAttributesCollection = new List<Run>();
                if (nodeAttributes.Count > 0)
                {
                    for (int i = 0; i < nodeAttributes.Count; i++)
                    {
                        if (!(nodeAttributes[i].Value.Length < 2) && !(documentLine.Contains("<!--")))
                        {
                            var attributeName = $"{Regex.Match(nodeAttributes[i].Value, @"(.+?=)").Value}";
                            if (i == 0) attributeName = $" {Regex.Match(nodeAttributes[i].Value, @"(.+?=)").Value}";
                            var attributeValue = $"{Regex.Match(nodeAttributes[i].Value, @"(?<=(.+?=))"".+?""").Value} ";

                            if (i == nodeAttributes.Count - 1) attributeValue = attributeValue.Trim();
                            nodeAttributesCollection.Add(new Run { Foreground = new SolidColorBrush(Colors.Green), Text = $"{attributeName}" });
                            nodeAttributesCollection.Add(new Run { Foreground = new SolidColorBrush(Colors.Brown), Text = $"{attributeValue}" });
                        }
                    }
                }

                // Initialize IndentSpace
                Run run = null;
                if (indentSpace.Length > 1) run = new Run { Text = indentSpace };

                // Initialize Open Tag
                var tagText = xmlTags[0].Value;//.Substring(1, xmlTags[0].Value.Length - 2);
                var tagTextBrush = new SolidColorBrush(Colors.Blue);
                var tagBorderBruh = new SolidColorBrush(Colors.Red);
                if (tagText.StartsWith("!--"))
                {
                    tagTextBrush = new SolidColorBrush(Colors.DarkSlateGray);
                    tagBorderBruh = new SolidColorBrush(Colors.DarkSlateGray);
                }
                var openTag = new Run
                {
                    Foreground = tagTextBrush,
                    Text = tagText
                };

                // Initialize Content Tag
                var content = new Run
                {
                    Foreground = new SolidColorBrush(Colors.Black),
                };

                // Initialize Paragraph
                var paragraph = new Paragraph();
                paragraph.Margin = new Thickness(0);
                if (run != null) paragraph.Inlines.Add(run); // Add indent space if exist

                // Process Open Tag
                paragraph.Inlines.Add(new Run { Foreground = tagBorderBruh, Text = "<" });
                paragraph.Inlines.Add(openTag);

                // Process Open Tag Attributes
                if (nodeAttributesCollection.Count > 0)
                {
                    nodeAttributesCollection.ForEach(attribute => { paragraph.Inlines.Add(attribute); });
                    nodeAttributesCollection.Clear();
                }
                paragraph.Inlines.Add(new Run { Foreground = tagBorderBruh, Text = ">" });

                // Process Closing Tag
                if (xmlTags.Count > 1)
                {
                    Run closingTag = new Run();
                    content.Text = documentLine.Replace($"<{xmlTags[0].Value}>", "").Replace($"<{xmlTags[1].Value}>", "").Trim();
                    closingTag = new Run
                    {
                        Foreground = new SolidColorBrush(Colors.Blue),
                        Text = xmlTags[1].Value.Substring(1, xmlTags[1].Value.Length - 1)
                    };
                    paragraph.Inlines.Add(content);

                    paragraph.Inlines.Add(new Run { Foreground = new SolidColorBrush(Colors.Red), Text = "<" });
                    paragraph.Inlines.Add(closingTag);
                    paragraph.Inlines.Add(new Run { Foreground = new SolidColorBrush(Colors.Red), Text = ">" });
                }
                richTextBox.Document.Blocks.Add(paragraph);
            }
            #endregion
        } 
```

# c++ - C ++类中的公共结构

> ID：11940748
> 
> 赞同：0
> 
> 时间：2012-08-13T19:11:50.290
> 
> 标签：c++, struct, inner-classes

我试图在 C++ 类中定义一个公共结构，但不知道如何让它编译。在我的标题中，我有以下内容：

```
class AtomUtility
{
    public:
        struct BoundingBox;
        void doWork(struct AtomUtility::BoundingBox bounds);
}; 
```

在源代码中：

```
#include"AtomUtility.h"
struct AtomUtility::BoundingBox
{
    double xMin, xMax;
};
int main()
{
    AtomUtility::BoundingBox *myBox = new AtomUtility::BoundingBox;
    myBox->xMin = 0;
    myBox->xMax = 10;
    AtomUtility *myUtility = new AtomUtility;
    myUtility->doWork(*myBox);
    delete myUtility;
}
void AtomUtility::doWork(struct AtomUtilty::BoundingBox bounds)
{
    //do things...
} 
```

当我尝试编译它时，我收到一个错误：“类“AtomUtility”没有名为“BoundingBox”的标记成员。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T19:15:45.197

您在定义之后错过了分号，`AtomUtility::BoundingBox`并且您的编译器变得混乱并且诊断不佳。

您还试图将 a 传递`AtomUtility::BoundingBox*`给期望 a 的函数`AtomUtility::BoundingBox`

如果您的编译器诊断结果不佳，那么在不同的编译器上尝试您的代码通常很有用。有几个可以在线获得，例如[Comeau](http://comeaucomputing.com/tryitout/)、 [Clang](http://llvm.org/demo/)或可编译的 pastebin，例如[http://codepad.org](http://codepad.org)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T19:17:29.397

引用[https://stackoverflow.com/a/6368118/1483826](https://stackoverflow.com/a/6368118/1483826)：

> 您只能声明指向后面的类（...）的指针或引用。您不能拥有更高级别的对象。

要解决此问题，您需要在将其用作字段的类之前声明该结构。

# php - 在php中从远程服务器获取文件的最可靠方法是什么

> ID：11940751
> 
> 赞同：0
> 
> 时间：2012-08-13T19:11:58.367
> 
> 标签：php, file

我正在编写一个将安装在用户服务器上的 PHP 脚本。我想从我的远程服务器中提取一个文件（一个 zip 文件）并将其写入运行脚本的本地服务器。

我可以很好地使用 file_get_contents 并使用 Snoopy。

但是，问题是我的脚本将分发给许多拥有各种服务器的人。它们的范围从免费赠品网络空间到他们自己的专用机架，介于两者之间:) 我不能确定是否会启用正确的选项以使 file_get_contents 起作用，我知道，如果禁用某些选项，则不太可能用户将能够启用它们。

所以，我在想，几乎，我唯一能保证的是他们将拥有 PHP 4 + 什么是拉取远程文件的最佳方式 - IE：哪种方式最有可能在如此大的范围内工作网络服务器：

1.  文件获取内容
2.  史努比（使用 fetch）
3.  fsockopen

任何想法或意见将不胜感激:)

# clojure - 我应该如何建立一个列表并在 clojure 中返回它？

> ID：11940756
> 
> 赞同：5
> 
> 时间：2012-08-13T19:12:11.377
> 
> 标签：clojure, functional-programming, porting

我还在学习这种外星人的功能范式......

我将如何在 Clojure 中以一种功能性的方式编写以下代码？假设这个缺失的部分是在别处定义的，并且行为如评论中所述。这是我熟悉的Python。

```
usernames = []
# just the usernames of all the connections I want to open.
cancelfunctions = {}
# this global contains anonymous functions to cancel connections, keyed by username

def cancelAll():
    for cancel in cancelfunctions.values():
        cancel()

def reopenAll():
    cancelfunctions = {}
    for name in usernames:
        # should return a function to close the connection and put it in the dict.
        cancelfunctions[name] = openConnection() 
```

我真正需要知道的是如何建立一个新的回调字典，就像在reopenAll函数中一样，但是我在这里包含了更多的上下文，因为我可能会犯某种功能范式暴行，你会最可能想要修复整个程序。:)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-13T19:48:33.547

在 Clojure 中构建数据结构通常涉及`reduce`，它将一系列输入提供给累积最终返回值的函数。这里有两种编写函数的方法，该函数构造用户名到返回值的映射（即字典）`open-connection`。

```
;; Using reduce directly
(defn reopen-all [usernames]
  (reduce
   (fn [m name] (assoc m name (open-connection)))
   {} usernames))

;; Using into, which uses reduce under the hood
(defn reopen-all [usernames]
  (into {} (for [name usernames]
             [name (open-connection)]))) 
```

请注意，这两个函数返回一个值并且不会像 Python 代码那样改变全局状态。全局状态本身并不坏，但将值生成与状态操作分开是件好事。对于状态，您可能需要一个`atom`：

```
(def usernames [...])
(def cancel-fns (atom nil))

(defn init []
  (reset! cancel-fns (reopen-all usernames))) 
```

`cancel-all`为了完整起见，这里是：

```
(defn cancel-all []
  (doseq [cancel-fn (vals @canel-fns)]
    (cancel-fn))) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-13T20:04:19.697

这是python中的一种功能方法：

```
def reopen(usernames):
    return dict((name, openConnection()) for name in usernames) 
```

在尝试使用主要的函数式语言之前，您可能会发现在 python 中“翻译”为函数式样式更容易。

# vbscript - 需要查看是否所有关键更新都安装在 VBScript 中的 Windows 服务器上

> ID：11940760
> 
> 赞同：0
> 
> 时间：2012-08-13T19:12:31.410
> 
> 标签：vbscript, windows-update

我有一个要求，我需要检查远程服务器以查看是否安装了所有关键更新，然后返回 PASS 或 FAIL。

WMI 有没有办法让我用 VBScript 做到这一点？

编辑：

我确实找到了这个 [带有 vbscript 的 Windows 更新检查，](https://stackoverflow.com/questions/3179914/windows-update-check-with-vbscript)但它只适用于本地机器而不是远程机器。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T03:30:01.727

这个与 Rob Dunn 的 UpdateHF_v2.6a.vbs 的链接适用于所有版本的 Windows。它是用 VBS 制作的，可以使用 WMI，并且可以在本地和远程主机上工作。我已经使用 2.5a 多年了。没有变更日志，尽管 Rob 正在更新脚本以响应反馈。

[http://community.spiceworks.com/scripts/show/82-windows-update-agent-force-script-email-results-version-2-6](http://community.spiceworks.com/scripts/show/82-windows-update-agent-force-script-email-results-version-2-6)

如果您需要“包装器”使用计算机列表批量执行此操作并使用 psexec 运行它，请告诉我。:)

# search - 在 solr 中准确搜索字段的值

> ID：11940761
> 
> 赞同：1
> 
> 时间：2012-08-13T19:12:32.403
> 
> 标签：search, solr, exact-match

我有表“类”。这个类有一个字段：“numStudents”。我索引了 numStudents 字段。

例如，现在我想搜索所有有 numStudents = 10 的类。我怎样才能做到这一点？

请给我最简单的方法，修改 solrconfig.xml 或 schema.xml 对我有好处。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T02:51:39.593

您可能想要过滤掉所有有 10 名学生的班级，而不对文档进行实际评分。
您可以使用过滤器查询 fq=numStudents:10 过滤掉课程。
[FilterQuery](http://wiki.apache.org/solr/CommonQueryParameters#fq)能够利用[FilterCache](http://wiki.apache.org/solr/SolrCaching#filterCache)，与您的查询相比，这将是一个巨大的性能提升。

# php - 排列来自 MySQL 查询的数组结果

> ID：11940765
> 
> 赞同：0
> 
> 时间：2012-08-13T19:12:51.333
> 
> 标签：php, mysql, arrays, multidimensional-array

我正在根据数据库中的库存制作小册子生成器。由于纸上手册的外观，项目显示的顺序将与 mysql_fetch_array 的工作方式不匹配。每个用户选择的类别在 2X2 网格中包含四个项目。

```
Category 1 ---------Category 2
[1]  [2]   ---------[5]   [6]
[3]  [4]   ---------[7]   [8]
Category 3 ---------Category 4
[9]  [10]   ---------[13]   [14]
[11]  [12]  ---------[15]   [16] 
```

我已经创建了一个基本表作为此模式中项目的占位符。这是我检索项目的查询。

```
$query = "SELECT t1.*, image_path FROM flyer_item AS t1
LEFT JOIN product_images AS t2 ON t1.product_id = t2.product_id WHERE id_page = '".$id_page."'";
echo $query."<br>";

$result = mysql_query($query);
echo '<h3 class = "splitter">Items</h3>';
//-create while loop and loop through result set
//Due to the unique item arrangement patter, we fill
//an array with the fetched array results.
$iArray = array();
while($row=mysql_fetch_array($result))
{
    $iArray[] = $row;
    $square = $row['square'];
    $item_name = $row['item_name'];
    $sales_info = $row['sales_info'];
    $link = $row['image_path'];
    $sku_item_number = $row['sku_item_number'];
    if (empty($link))
    {
        $link = '../imagen/no_imagen.gif';        
    }

} 
```

一页最多可以容纳 24 个项目，所有项目都遵循上述模式，以确保项目属于各自的类别。我正在考虑创建另一个名为 Categories 的数据库表来存储它的四个项目，但是有没有办法可以使用第二个数组 iArray 来存储指示项目应该去哪里的数字？

实际的表格看起来像这样，以匹配原始文档。

```
<table width="100%" border="1" bordercolordark="#000000" bordercolorlight="#000000">
  <tr>
    <td>&nbsp;</td>
    <td colspan="2" align="center"><?php echo $category1; ?></td>
    <td>&nbsp;</td>
    <td colspan="2" align="center"><?php echo $category2; ?></td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td>Item 1</td>
    <td>Item 2</td>
    <td>&nbsp;</td>
    <td>Item 5</td>
    <td>Item 6</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td>Item 3</td>
    <td>Item 4</td>
    <td>&nbsp;</td>
    <td>Item 7</td>
    <td>Item 8</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
   <td>&nbsp;</td>
    <td colspan="2" align="center"><?php echo $category3; ?></td>
    <td>&nbsp;</td>
    <td colspan="2" align="center"><?php echo $category4; ?></td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td>Item 9</td>
    <td>Item 10</td>
    <td>&nbsp;</td>
    <td>Item 13</td>
    <td>Item 14</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td>Item 11</td>
    <td>Item 12</td>
    <td>&nbsp;</td>
    <td>Item 15</td>
    <td>Item 16</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td colspan="2" align="center"><?php echo $category5; ?></td>
    <td>&nbsp;</td>
    <td colspan="2" align="center"><?php echo $category6; ?></td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td>Item 17</td>
    <td>Item 18</td>
    <td>&nbsp;</td>
    <td>Item 21</td>
    <td>Item 22</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td>Item 19</td>
    <td>Item 20</td>
    <td>&nbsp;</td>
    <td>Item 23</td>
    <td>Item 24</td>
    <td>&nbsp;</td>
  </tr>

</table> 
```

# sql - 更新重复行然后删除除一个之外的所有行

> ID：11940766
> 
> 赞同：2
> 
> 时间：2012-08-13T19:12:52.300
> 
> 标签：sql, count, duplicate-removal

我正在使用 SQL Server 2005 尝试查找某个项目的所有重复项并更改数量，使其等于重复项的数量。然后我计划删除除一个之外的所有重复行。

这是我到目前为止所拥有的：

```
UPDATE Table
SET Quantity = COUNT(Item)
WHERE COUNT(Item) > 1

SELECT * FROM Item 
```

有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T19:28:57.090

这是做你想做的事的一种方法。

```
with toupdate as (
     select item, count(*) as cnt
     from t
     group by item
    )
update t
    set quantity = cnt
    from toupdate
    where t.item = toupdate.item 
```

CTE 计算每个项目的价值。然后 update 子句进行更新。

# xss - XSS 跨站脚本 - Jsp标签

> ID：11940770
> 
> 赞同：3
> 
> 时间：2012-08-13T19:13:15.650
> 
> 标签：xss, cross-site

我的 JSP 中的以下代码导致输入标记上的跨站点脚本漏洞。

```
<form name="acctFrm" method="post" action="<%=contextPath%>/form/acctSummary?rpt_nm=FIMM_ACCT_SUMM_RPT">
<table>
 <tr>
  <td>Account Id:</td>
  <td>
   <input class="tbl1" type="text" id="acctId" name="acctId" size="20" maxlength="10" value="<%=rptBean.getAcctId()%>"/>
   <a href="javascript:doAcctSubmit()"><img class="tbl1" src="<%=contextPath%>/img/Submit.gif" border="0" /></a>
  </td>
 </tr>
</table>
</form> 
```

在渗透测试期间，他们能够通过在标签的 value 属性中注入警报脚本来向用户发出一些随机消息，如下所示

```
<input class="tbl1" type="text" id="acctId" name="acctId" size="20" maxlength="10" value="1"><script>alert(12345)</script>" /> 
```

这里有什么问题，解决方法是什么。

我正在阅读一些关于 XSS 的在线参考资料，但我仍然不能 100% 确定可能是什么问题。

任何帮助将不胜感激。

谢谢，迪娜

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-14T18:06:45.347

我使用了以下解决方案，

value 属性中的 scriplet 是问题，我用 jstl 标签替换了它，我在某处读到 jstl 标签具有内置转义机制以避免 xss 问题。

```
<input class="tbl1" type="text" id="acctId" name="acctId" size="20" maxlength="10" value="<c:out value=${rptBean.acctId}"/>"/> 
```

这对我的问题很有用。

谢谢

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-13T19:33:56.960

似乎渗透测试人员能够操纵他们的会话，以便 rptBean.getAcctId() 返回任意字符串。如果他们可以注入引号和右括号，他们可以“强制关闭”`input`标签并插入他们自己的`script`标签。

看起来渗透测试人员得到了返回字符串的方法`1"><script>alert(12345)</script>`。

这表明您在写入页面时需要对数据进行转义。我建议看一下关于[在 jsp 中转义 HTML](https://stackoverflow.com/questions/475839/how-can-i-escape-special-html-characters-in-jsp)的答案。

另外，请记住，代码不必“完美”格式化，浏览器也可以“正确”呈现它。以下是一些关于攻击者如何尝试规避 XSS 过滤器的链接：

*   [http://blog.whitehatsec.com/tag/filter-evasion/](http://blog.whitehatsec.com/tag/filter-evasion/)
*   [http://ha.ckers.org/xss.html](http://ha.ckers.org/xss.html)

始终将用户数据视为“危险的”，并在页面上呈现它时要小心。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-07-20T05:51:09.723

似乎在值属性中使用`jstl`标签`<c:out value="">`会导致`jstl` `<form options>`标签错误，

更多信息 [JSP/Servlet Web 应用程序中的 XSS 预防](https://stackoverflow.com/questions/2658922/xss-prevention-in-jsp-servlet-web-application)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-02T20:10:43.447

如果`getAcctId()`返回的数据来自数据库，您可以在发送给客户端之前进行过滤。例如检查是数据应该是一个数字。

# iphone - NSSortDesctiptor 按 plist 编号排序时出错

> ID：11940771
> 
> 赞同：1
> 
> 时间：2012-08-13T19:13:15.717
> 
> 标签：iphone, objective-c, ios

我正在使用 a`NSSortDescriptor`对我的 tableView 进行排序，但这条线很麻烦：

```
if (buttonIndex == 0) {
    sortDesc = [[NSSortDescriptor alloc] initWithKey:@"Rate" ascending:NO];
} 
```

"Rate" 是 plist（带字典的数组）中的数字字符串。

如果字典未分级，则默认值为“0”，如果已分级，则值为“1”、“2”、“3”、“4”、“5”或“6”。为什么我不能按这些值排序，怎么做？

> 'NSInvalidArgumentException'，原因：'-[__NSCFNumber 长度]：无法识别的选择器发送到实例 0x6c382c0'

编辑：

问题是我用字符串而不是数字对字典进行评分：

```
[mutDict setValue:@"0" forKey:@"Rate"]; 
```

如何为 Rate 设置数字而不是字符串？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T19:26:45.517

> 如何为 Rate 设置数字而不是字符串？

您可以使用`NSNumber`而不是字符串文字：

```
[mutDict setValue:[NSNumber numberWithInt:0] forKey:@"Rate"];
//          The actual rate goes here ----^ 
```

`NSNumber`include `numberWithLong`、`numberWithDouble`和的其他类方法`NumberWithFloat`。

# asp.net-mvc - 从 href 调用 javascript 时遇到问题

> ID：11940773
> 
> 赞同：1
> 
> 时间：2012-08-13T19:13:41.703
> 
> 标签：asp.net-mvc

我在让我的链接函数执行 javascript 时遇到了一些麻烦。

关联：

```
<a class="glossyBtn" id="saveButton">Save</a> 
```

脚本：

```
<script type="text/javascript">
$(function (){
    $('form').submit(function () {
        $('#saveButton').attr('disabled', 'disabled');
    });
});
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T19:15:38.067

`$('form').submit()`当您提交表单时触发（通常使用`<button type="submit">`）。您的按钮不是提交类型。

`onclick`您可以将以下内容添加到您的`<a>`元素中来实现它：`onclick="$('form').sumbit();"`或者将以下内容添加到您的 JS 代码中

```
$('#saveButton').click(function{
   $('#saveButton').attr('disabled', 'disabled');
   $('form').submit();
}) 
```

# java - 函数间插值

> ID：11940775
> 
> 赞同：0
> 
> 时间：2012-08-13T19:13:55.123
> 
> 标签：java, math, interpolation

> **可能重复：**
> [对一个（或两个）数组进行插值](https://stackoverflow.com/questions/1221944/interpolation-over-an-array-or-two)

我有一组包含 2D 函数点的 CSV 文件……换句话说，我有四个 CSV 文件，每个文件都是在不同 y 值下评估函数 f(x, y) 的结果。我需要在这些数据之间进行插值，以便可以为某个 x 和 y 计算任意 f。CSV 文件具有不同的长度和 x 值。有谁知道用于此任务的 Java 库或算法？线性插值可以，样条插值也可以。

谢谢，
塔克托

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T19:16:37.803

最简单的功能是找到最近的点并使用线性插值。例如，选择三个最近点中的两个并对其进行插值。

或者您可以根据距离进行加权平均。或者您可以选择一个接近点，然后在最近点的“另一侧”找到点以改进插值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T19:55:16.307

好的，首先我假设“CSV”位无关紧要，假设您已将它们读入内存并将它们合并在一起（它们是同一函数的值，对吧？）。现在，您有一组`f(x,y)`不同对的值，`(x,y)`并希望在它们之间进行插值。到目前为止还好吗？

如果您坚持线性插值，仍然存在要考虑多少点的问题，这取决于测量中的噪声水平。在最简单的情况下，我们将只使用三个最近的点来识别它们所在的平面，并使用它来找到相关点的值。除了向量加法、减法、叉积和点积之外，此选项既不需要库也不需要算法。

更复杂的解决方案通常需要某种拟合，例如（加权）[最小二乘法](http://en.wikipedia.org/wiki/Least_squares)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-14T01:57:15.937

[拉格朗日插值](http://en.wikipedia.org/wiki/Lagrange_polynomial)将简单而准确。

# nosql - 哪个 NoSql 用于传感器数据和报告？

> ID：11940780
> 
> 赞同：1
> 
> 时间：2012-08-13T19:14:09.020
> 
> 标签：nosql, key-value-store, nosql-aggregation

我在决定坚持哪种 NoSql 架构时遇到问题。我们的业务用例是我们有大量来自资产的遥测数据。我们需要定期报告。我们有一个正在开发中的传统网络应用程序。我们将前端应用程序设计为从基于 Rest 的服务中使用，因此迁移到 NoSQL 实现并不是什么大问题。我们有各种报告要求，我们的大部分报告都基于一些基本查询。迁移到 NoSql Db 时让我担心的是，如何在 SQL Server 完成大部分繁重工作的情况下创建那些简单易用的查询？对于我没有进行大量键值查找的业务案例，noSQL 实现是一个不错的选择吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T20:45:53.183

MongoDB 可能是您想要的解决方案，具体取决于您的特定[用例](http://www.mongodb.org/display/DOCS/Use+Cases)和要求。他们有一个很好的[SQL 到 Mongo 的映射图表](http://www.mongodb.org/display/DOCS/SQL+to+Mongo+Mapping+Chart)，有助于弥合基于 SQL 和 NoSQL 的解决方案之间的差距。听起来 Mongo 可能是您正在寻找的东西。它适用于需要定期更新的近实时分析的情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-05-17T02:46:55.887

在线服务：meeiot.org 上有一个键值沙发数据库 我每 30 秒共享一次 来自 2 个不同位置的 2 个水处理单元水箱，由运行 Linux 的 UDOO 控制。它们有 PWM/GPIO 和 8 个 Bmp080 TH 传感器以及一些模拟热敏电阻。总共超过30个数据点。我用 2 个键（输入/输出）@meeIOT 和一个简单的 cron bash 来观察它们并控制它们，它充当整个系统的用户输入

# php - 根据案例提供多个 Google Analytics 代码

> ID：11940783
> 
> 赞同：0
> 
> 时间：2012-08-13T19:14:24.903
> 
> 标签：php, wordpress, google-analytics, case

我希望根据正在查看网站的域使用不同的 Google Analytics 代码。

我读到以下代码适用于我的场景（在 Drupal 环境中）：

```
<?php
// Override Google Analytics Web Property ID per hostname. 
// Hostnames need to be lower-case!
switch ($_SERVER['HTTP_HOST']) {
  case 'www.example.com':
  case 'www.example.net':
  case 'forum.example.net':
    $conf['googleanalytics_account'] = 'UA-123456-2';
    break;

  case 'www.example.org':
    $conf['googleanalytics_account'] = 'UA-123456-3';
    break;

  default:
    $conf['googleanalytics_account'] = 'UA-123456-1';
}
?> 
```

我正在使用 Wordpress。这段代码对我有用吗？如果是这样，我不完全理解...这是说所有未列出的站点都将使用默认 GA 代码（底部），www.example.org 将使用中间 GA 代码，以及所有其他人将使用顶级 GA 代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T20:34:43.523

您不应该在网站级别设置过滤。简而言之，您应该使用您的 GA 代码来声明您想要带入您的 GA 帐户的所有子域和域。然后，在您的 GA 帐户中，您可以设置多个带有过滤选项的配置文件。

[http://services.google.com/analytics/breeze/en/v5/domains_subdomainsv22_ad1/](http://services.google.com/analytics/breeze/en/v5/domains_subdomainsv22_ad1/) （如果您想要简单的图形概览，请向右跳至幻灯片 12）

这样做： 1.) 设置您的网站 GA 代码以包含您要跟踪的所有域。2.) 在 GA > Admin Menu > Create New Profile 中选择帐户 3.) 单击过滤器选项卡 > 选择预定义过滤器 > 仅包括 > 来自域的流量 > (子域/域) 4.) 保存

现在为您要添加的每个子域/域执行此操作。这通常是最好的做法。

# uitableview - 静态单元与动态原型

> ID：11940785
> 
> 赞同：2
> 
> 时间：2012-08-13T19:14:40.563
> 
> 标签：uitableview

只要任何人都可以阅读 Apple 文档，作为 ios 开发人员，我们就应该注意内存泄漏和分配。在开发 iPhone 应用程序时，我想到了一个问题。您将如何以及为什么决定使用静态单元而不是动态原型。

您发现两种方式的优缺点是什么。有没有办法让静态单元格出列？你会怎么做，假设你在一个表格视图中有 6/7 个单元格具有相对静态的数据。例如设置电视。

期待您的评论以相应地进行谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T19:50:57.477

使用静态单元格时，您将“出列单元格”和其他数据绑定推迟到基本 UITableViewController 类。使用静态单元格时，您应该删除 TVC 中的所有 tableview 和 tableviewdatasource 委托方法实现。可以手动出列并向*具有*静态单元格的表添加行，但我从未尝试过；如果您知道这将是必要的，那么您最好采用动态单元路线。

当您想要旋转对象以使每个属性都是表中的一行时，静态单元格很方便。对于这些情况，您的数据不容易表示为值数组。在这种情况下，电视中的行数是提前知道的，并且每个单元格的模板是静态的 - 就像您在问题中提到的设置 TVC 一样。当您绑定的类也支持它并走动态单元格路由时，仍然可以使用 KVO 等将您的数据呈现为字典，但使用静态单元格开发可能更简单/更快。

# java - Apache Log4j 2.0-alpha1 中的错误？

> ID：11940788
> 
> 赞同：0
> 
> 时间：2012-08-13T19:14:54.980
> 
> 标签：java, exception, log4j, pom.xml

我正在使用 Windows 7 (x32)、Jre7、IntellijIDEA 12。

我的`pom.xml`片段：

```
 <dependency>
        <groupId>org.apache.logging.log4j</groupId>
        <artifactId>log4j-api</artifactId>
        <version>2.0-alpha1</version>
    </dependency>

    <dependency>
        <groupId>org.apache.logging.log4j</groupId>
        <artifactId>log4j-core</artifactId>
        <version>2.0-alpha1</version>
    </dependency> 
```

还有我的琐碎`Java`课：

```
// Imports omitted

public class Controller
{
    private static Logger logger = LogManager.getLogger(Controller.class.getName());

    public static void main( String[] args )
    {
        logger.error("Entering application.");
    }
} 
```

我遇到了一个例外：

```
Exception in thread "main" java.lang.VerifyError: class org.apache.logging.log4j.core.impl.ThrowableProxy overrides final method addSuppressed.(Ljava/lang/Throwable;)V
    at java.lang.ClassLoader.defineClass1(Native Method)
    at java.lang.ClassLoader.defineClass(ClassLoader.java:791)
    at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:142)
    at java.net.URLClassLoader.defineClass(URLClassLoader.java:449)
    at java.net.URLClassLoader.access$100(URLClassLoader.java:71)
    at java.net.URLClassLoader$1.run(URLClassLoader.java:361)
    at java.net.URLClassLoader$1.run(URLClassLoader.java:355)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:354)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:423)
    at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:308)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:356)
    at org.apache.logging.log4j.core.config.LoggerConfig.createEvent(LoggerConfig.java:334)
    at org.apache.logging.log4j.core.config.LoggerConfig.log(LoggerConfig.java:262)
    at org.apache.logging.log4j.core.Logger.log(Logger.java:115)
    at org.apache.logging.log4j.spi.AbstractLogger.error(AbstractLogger.java:965)
    at org.ruchevits.codeigniter.bootstrap.Controller.main(Controller.java:20)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at com.intellij.rt.execution.application.AppMain.main(AppMain.java:120) 
```

这是虫子还是我的曲线手？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T20:17:22.337

我找到了答案。

那是[错误](https://issues.apache.org/jira/browse/LOG4J2-64)，它将在`2.0-alpha2`版本中修复。

[https://issues.apache.org/jira/browse/LOG4J2-64](https://issues.apache.org/jira/browse/LOG4J2-64)

# linq - 林克。如何在 Linq（sql 语法）查询中使用 AsEnumerable？EF4.1

> ID：11940790
> 
> 赞同：2
> 
> 时间：2012-08-13T19:14:55.843
> 
> 标签：linq, lambda, entity-framework-4.1, asenumerable

请参阅下面的两个功能相同的查询，sql 和 lambda 版本：

```
from a in Lines.AsEnumerable()
where a.LineId == SomeGuid
select a 
```

-

```
Lines.AsEnumerable()
.Where(a => a.LineId == SomeGuid)
.Select(a => a) 
```

两个查询都将被翻译成没有 WHERE 语句的 SQL，比如

```
SELECT * FROM Line 
```

在 lambda 中，我可以方便地将 AsEnumerable 放在 Where 子句之后，生成的 SQL 将包含 WHERE 子句。所以，lambda 查询就像：

```
Lines
.Where(a => a.LineId == SomeGuid)
.AsEnumerable()
.Select(a => a) 
```

结果 SQL 是 SELECT * FROM Line WHERE LineId = @param

**问题：** 如何使用 Linq SQL 语法做到这一点？换句话说，我希望生成的 SQL 语句具有 WHERE 子句。我想避免从表 Line 中提取所有记录。我试图将 AsEnumerable 放在查询中的不同位置，但未能使其工作。

**编辑：**
在简单的语句中将 AsEnumerable 放在最后会起作用，但是如果您使用投影，则 EF 会抱怨（NotSupported Exception: Complex type can't beConstructed ...）所以，

```
 (from a in Lines
    where a.LineId == SomeGuid
    select new Line
    {
        LineId = a.LineId
    }).AsEnumerable() 
```

不会工作

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-13T19:17:45.883

您只需这样做：

```
var query (from a in context.Lines
           where a.LineId == SomeGuid
           select a).AsEnumerable(); 
```

但在大多数情况下，这不是必需的。它使您的查询可枚举，但不执行您的查询。只有在迭代时才会执行查询。

顺便提一句。`.Select(a => a)`在您的示例中不需要，因为它会自动发生。

编辑：

Linq-to-entities 禁止投影到映射类型，所以正如我提到的，评论你必须首先投影到匿名类型，调用`AsEnumerable`并投影到真正的映射类型。

```
var query =  (from a in Lines
              where a.LineId == SomeGuid
              select new {
                  LineId = a.LineId
              }).AsEnumerable()
              .Select(a => new Line { LineId = a.LineId }); 
```

在这种情况下，您甚至不需要匿名类型，因为您可以`a.LineId`直接选择。

# literals - NSSet 和 NSOrderedSet 的 Objective-C 文字？

> ID：11940797
> 
> 赞同：48
> 
> 时间：2012-08-13T19:15:16.400
> 
> 标签：literals, nsset, nsorderedset

NSSet 和 NSOrderedSet 操作可以用新的 Objective-C 集合字面量执行什么（如果有）？

对于 NSArray、NSDictionary 和 NSNumber，请参见[此处](https://stackoverflow.com/questions/9347722/apple-llvm-4-0-new-features-on-xcode-4-4-literals)。

FWIW，[这个 Big Nerd Ranch Post](http://weblog.bignerdranch.com/398-objective-c-literals-part-1/)说索引语法应该适用于 NSOrderedSet。但在我的测试中它没有。而且我还没有找到有关创建有序集的任何信息。

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2012-12-06T05:30:00.140

NSSet 没有 Objective-C 文字语法。使用索引下标来访问 NSSet 元素实际上没有意义，尽管基于键的下标可能。通过包装或子类化，您*可以*添加自己的。

*（更正）：最初我认为 NSOrderedSet也不*支持，但事实证明支持使用索引下标，但似乎没有一种方法可以使用文字语法初始化 NSOrderedSet。但是，您可以使用 initWithArray: 并传递一个文字数组：

```
NSMutableOrderedSet* oset = [[NSMutableOrderedSet alloc] initWithArray: 
    @[@"a", @"b", @"c", @"d", @42]];

oset[2] = @3;
NSLog(@"OrderedSet: %@", oset); 
```

输出：

```
OrderedSet: {(
    a,
    b,
    3,
    d,
    42
)} 
```

根据Mike Ash 的[这篇优秀文章](http://www.mikeash.com/pyblog/friday-qa-2012-06-22-objective-c-literals.html)，您可以将用于支持索引下标的方法添加到您自己的对象中。

```
- (id)objectAtIndexedSubscript:(NSUInteger)index;
- (void)setObject: (id)obj atIndexedSubscript: (NSUInteger)index; 
```

以及基于对象的键控的类似方法：

```
- (id)objectForKeyedSubscript: (id)key;
- (void)setObject: (id)obj forKeyedSubscript: (id)key; 
```

因此，您可以围绕 NSSet 实现一个包装器（或做更多工作，将其子类化）并提供基于键的检索。凉爽的！

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2013-03-02T10:00:39.770

如果是 NSSet，试试这个怎么样：

```
#define $(...)  [NSSet setWithObjects:__VA_ARGS__, nil] 
```

并像这样使用它：

```
NSSet *addresses = $(addr1,addr2,addr3,addr4); 
```

;-)

# vim - 映射 在 vimrc 中导致奇怪的箭头行为

> ID：11940801
> 
> 赞同：20
> 
> 时间：2012-08-13T19:15:31.483
> 
> 标签：vim

我是一个快乐的 VIM 用户，尽管我承认我离流利还很远。我发现了这个不错的帖子： [Vim clear last search highlighting](https://stackoverflow.com/questions/657447/vim-clear-last-search-highlighting)，我想如果我不必每次搜索时都敲掉随机字符序列，我会成为一个更好的人。现在，我也在使用这里的 vimrc 配置：

[http://amix.dk/vim/vimrc.html](http://amix.dk/vim/vimrc.html)

我遇到的问题是，当我将行添加`nnoremap <esc> :noh<return><esc>`到它时（我放它的地方似乎没有什么区别）当我在命令模式下使用箭头时，我会出现尴尬的行为，即从 A 到 D 的字母出现在换行，我切换到插入模式。

必须有一些映射冲突，但对于我的生活，我无法弄清楚它在哪里。

**编辑：**从答案中可以看出 Ultimate vimrc 部分不相关，`nnoremap`即使它是唯一的 vimrc 条目，所提到的命令也会导致箭头行为改变。将标题更改为内容更丰富的标题。

PS。我知道我不应该使用箭头，希望有一天我能到达那里。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-08-13T20:17:59.467

映射

```
nnoremap <esc> :noh<return><esc> 
```

将与所谓的“灰色键”冲突，我相信它应该仅在 GVim 中使用，或者由不使用箭头等特殊键的人在终端 Vim 中使用。

据我所知（和猜测）Vim 是如何处理键的，我想说这是不可能的。要让 Vim 识别特殊键，它的所有组件都应该排成一行，所以当你按下`Arrow Left`Vim 时，会得到以下代码序列：

`<esc>` `[` `D`

但是在您的映射`Arrow Left`变为：

`:` `n` `o` `h` `l` `<cr>` `<esc>`

`[` `D`

Vim 看到两个单独的序列并将其视为`<esc>`一次`Escape`按键，因此接下来的两个`Left Arrow`按键代码失去了它们的特殊含义。

因此，我建议您映射`:noh`到其他一些键序列（例如，映射到以 开头的键序列`<leader>`，请参阅`:help mapleader`；我不建议您使用 F 键，使用它们与使用箭头键一样糟糕）。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2013-12-08T20:22:13.357

原因已经解释得很好，但没有提到解决方案。但是有一个直的。

如果你明确告诉 Vim 有从`<esc>[`

```
:nnoremap <silent><esc> :noh<CR>
:nnoremap <esc>[ <esc>[ 
```

与按下single 时相比，`<esc>`Vim 将等待一秒（或不同的时间，请参阅`:h 'timeoutlen'`）或下一个键（`<esc>`例如秒），然后才将其替换为`:noh<CR>`.

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2013-04-16T02:22:48.270

此解决方案保留到 的`ESC`映射`:nohlsearch`。

对此[答案的评论解释**了为什么**会发生这种情况](https://stackoverflow.com/a/15015109/640517)，告诉我们根本原因是 vim 的 TermResponse 行为。这可以通过将映射包装在 TermResponse 事件的自动命令中来补偿。

**这样可以确保在**设置术语响应之前不会发生绑定，这可以防止也像vim`Esc`一样发送字符串。`]>1;3201;0c`

将 vimrc 中的行更改为：

```
augroup no_highlight
    autocmd TermResponse * nnoremap <esc> :noh<return><esc>
augroup END 
```

augroup 命令不是绝对必要的，但是当您在不退出 vim 的情况下重新加载 vimrc 时，它们会阻止多个映射。

**编辑：** 如果您还使用 Gvim 或 Macvim 等图形 vim，则不会触发 TermResponse 事件。假设您使用单个 vimrc，您将需要一些额外的代码，例如

```
if has('gui_running')
  nnoremap <silent> <esc> :nohlsearch<return><esc>
else
  " code from above
  augroup no_highlight
    autocmd TermResponse * nnoremap <esc> :noh<return><esc>
  augroup END

end 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-08-13T20:13:45.037

问题是当您按下箭头终端时会发出类似`<Esc>OA`. 支持终端的 Vim 部分似乎使用与您使用的相同的映射机制来完成这项工作：虽然`nmap <Esc>OA`不会告诉您任何内容，但`call feedkeys("\eOA")`会向上移动一行`call feedkeys("\eOA", 'n')`并将字母 A 添加到当前行之外。由于您的映射不可映射，因此您禁止 vim 将其`<Esc>`用作键的一部分。问题是您在这里需要可重新映射的映射，但只有在以 开头`{lhs}`但`<Esc>:noh<CR>OA`不起作用时才可以在不递归的情况下进行可重新映射的映射。我认为下面的代码会（它使用`<expr>`并具有副作用的功能使其`<Esc>`成为实际的第一个字符`{rhs}`并且仍然启动`:noh`），但实际上它没有：

```
function s:NoHlSearch()
    nohlsearch
    return "\e"
endfunction
nmap <expr> <Esc> <SID>NoHlSearch() 
```

. 我不知道如何解决具有非递归可重映射映射的问题，该映射包括`{lhs}`但不是在开始时。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-13T19:23:01.527

我运气不错

```
if $TERM =~ 'xterm'
  set noek
endif
nnoremap <silent> <esc> <esc>:noh<cr> 
```

缺点是功能键不能在插入模式下使用。

```
:h ek 
```

# c - ANSI C - 使用动态数组创建的嵌套 BER TLV 元素的重新分配

> ID：11940808
> 
> 赞同：0
> 
> 时间：2012-08-13T19:15:53.030
> 
> 标签：c, asn.1

为了构建嵌套的 TLV 元素（例如，6F1A840E315041592E5359532E4444463031A5088801025F2D02656E），我使用以下数据结构：

```
typedef struct Element
{
    int16_t nTag; // Tells you if pValue points to a primitive value or constructed one 
    uint16_t nLength;
    void *pValue; // Could be either unsigned char* or TlvElement*
} TlvElement; 
```

如何实现正确释放嵌套 TLV 元素使用的内存的函数？

```
// Let's build TLV data: 6F04A5020000
TlvElement *pTlvElement = (TlvElement*)malloc(sizeof(TlvElement));
pTlvElement->nTag = 0x6F;
pTlvElement->nLength = 4;
pTlvElement->pValue = malloc(sizeof(TlvElement)); // pValue points to another TLV element

TlvElement *pTlvElementChild = (TlvElement*)pTlvElement->pValue;
pTlvElementChild->nTag = 0xA5;
pTlvElementChild->nLength = 2;
pTlvElementChild->pValue = malloc(2 * sizeof(unsigned char)); // pValue points to a byte array
memset(pTlvElementChild->pValue, 0, 2);

Deallocate(pTlvElement);

//free(pTlvElementChild->pValue);
//free(pTlvElement->pValue);
//free(pTlvElement); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T19:25:12.827

您只需按照您在注释行中给出的顺序释放它：

```
free((TlvElement *)(pTlvElement->pValue)->pValue);
free(pTlvElement->pValue);
free(pTlvElement); 
```

该函数`free(void *)`采用 a `void *`，因此编译器不会抱怨。您需要的唯一转换是访问`pValue`子元素的字段。

提醒一句：除非`tag`已经标记了这一点，否则您可能会考虑在该元素确实包含子元素的某处添加 keep。

假设`->nTag`field 的值可以用于此，您可以递归地释放子元素：

```
void Deallocate(TlvElement *e)
{
  if (e->nTag == 0x6f)
    Deallocate((TlvElement *)e->pValue);
  else
    free(e->pValue)
  free(e);
} 
```

不过，您可能需要对无休止的递归采取预防措施。

# asp.net-mvc - Asp mvc 3 noobie：为什么代码优先方法不在 sql server 上构建我的数据库？

> ID：11940809
> 
> 赞同：4
> 
> 时间：2012-08-13T19:16:00.033
> 
> 标签：asp.net-mvc, asp.net-mvc-3

我是一个做过一些教程的 ASP MVC 3 noobie。现在我正在尝试建立一个网站。microsoft 网站上的所有教程都强调代码优先方法：您使用代码定义模型，然后创建数据上下文，然后实体框架根据您的代码创建/管理数据库。

我设置了一个Employees 类和一个继承自DbContext 的DataBaseContext 类。我向 Web.config 连接字符串添加了一个连接字符串，该连接字符串成功地将 DataBaseContext 链接**到 SQL 服务器上已经存在的空数据库。** *编辑=这就是问题所在。请看下面我的回答*

但是当我尝试运行通过脚手架创建的员工控制器时，我收到了这个错误

```
Invalid object name 'dbo.Employees'. 
Description: An unhandled exception occurred during the execution of...
Exception Details: System.Data.SqlClient.SqlException: Invalid object name 'dbo.Employees'. 
```

我关注了这篇文章[SqlException (0x80131904): Invalid object name 'dbo.Categories'](https://stackoverflow.com/questions/5374482/sqlexception-0x80131904-invalid-object-name-dbo-categories)并意识到如果我在数据库上创建一个员工表，这个异常就会消失（我得到一个新的，说列名无效）。

但我认为 MVC 3 的全部意义在于该框架将根据代码为您创建数据库。

也许我需要 Global.asax Application_start() 中的一行代码来创建数据库？这是我的 application_start 方法：

```
Sub Application_Start()
    AreaRegistration.RegisterAllAreas()
    RegisterGlobalFilters(GlobalFilters.Filters)
    RegisterRoutes(RouteTable.Routes)
End Sub 
```

这是员工的代码：

```
Public Class Employee

    Property EmployeeID As Integer
    Property First As String
    Property Last As String
    Property StartDate As DateTime
    Property VacationHours As Integer
    Property DateOfBirth As DateTime 'in case two employees have the same name

End Class 
```

这是数据库上下文的代码：

```
Imports System.Data.Entity

Public Class DatabaseContext
    Inherits DbContext

    Public Property Employee As DbSet(Of Employee)
    Public Property AnnualLeave As DbSet(Of AnnualLeave)

End Class 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T21:09:46.803

默认情况下，EF 使用`DropCreateDatabaseIfModelChanges<TContext>`数据库初始化程序。根据[MSDN](http://msdn.microsoft.com/en-us/library/gg679604%28v=vs.103%29)：

> `IDatabaseInitializer<TContext>`仅当模型自创建数据库后发生更改时，其实现才会删除、重新创建和可选地使用数据重新播种数据库。这是通过在创建时将存储模型的散列写入数据库，然后将该散列与从当前模型生成的散列进行比较来实现的。

由于数据库是手动创建的，EF 找不到哈希并决定不执行任何进一步的初始化逻辑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T19:20:31.497

您可能想查看[这篇文章](https://stackoverflow.com/questions/5374482/sqlexception-0x80131904-invalid-object-name-dbo-categories)，同样的问题已经成功回答。或者它可以是[这个](https://stackoverflow.com/questions/6015458/problem-with-sqlexception-0x80131904-invalid-object-name-dbo-tablename)（也成功解决）你的问题的答案很可能是两者之一。

希望对你有帮助

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-14T07:25:27.963

您为连接字符串指定的名称是否与数据库上下文的名称匹配？

例如：

**语境**

```
var myDbContext = new MyDbContext(); 
```

**连接字符串**

```
<connectionStrings> 
    <add name="MyDbContext" connectionString="YOUR.CONNECTION.STRING" providerName="System.Data.SqlServer" /> 
</connectionStrings> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-14T18:59:17.760

试试看我写的这篇关于 DbContext with MVC 的文章是否适合你：[Code-First](http://www.nerdlythings.com/Post/Custom-MVC-Blog-Part-2---Entity-Framework-Code-First?id=7)

要让它发挥作用，要做的事情并不多，但是有一些事情很容易被遗漏，这会导致一堆头痛。

希望这可以帮助

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-16T19:32:49.257

我已经在 SQL 服务器上创建了一个具有该名称的数据库。一旦我删除了现有的数据库，代码优先框架就会为我创建表，就像它应该做的那样。似乎如果数据库已经存在，框架不会为您设置表。它想从头开始创建整个数据库。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-28T22:40:11.497

你用的是`AdventureWorks Database`？

它有自己的模式分配给员工表。`HumanResources.Employees`而不是默认的`dbo.Employees`.

即使我已经确定了问题，但我不知道使用模式配置的数据库的解决`HumanResources`方案。

有人知道吗？

# jquery - 带有 execCommand 调用的 jquery 颜色选择器

> ID：11940812
> 
> 赞同：2
> 
> 时间：2012-08-13T19:16:11.207
> 
> 标签：jquery, color-picker, execcommand

选择颜色后尝试调用 execCommand：

```
$('#picker').colorPicker(
    {           
      defaultColor:0, // index of the default color
      columns:13,     // number of columns 
      click:function(c){
             document.execCommand('ForeColor',false, c);    
      }
}); 
```

但什么也没发生。如果我用 $('#output').html(c) 替换 execCommand，我会看到调用成功。

示例：http: [//jsfiddle.net/YQQXV/12/](http://jsfiddle.net/YQQXV/12/)

[ColorPicker 插件页面](http://www.syronex.com/software/jquery-color-picker)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T19:55:32.400

我和你玩了一点小提琴，从[这里](https://stackoverflow.com/questions/1817441/javascript-document-execcommand-cross-browser)合并了一个答案。

你的小提琴的一个更有效的例子是[here](http://jsfiddle.net/YQQXV/11/)。

在我看来，好像您忘记了`designMode`设置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T19:48:41.150

根据[MS Docs](http://msdn.microsoft.com/en-us/library/ms536419%28v=vs.85%29.aspx)，您需要将命令 ID 作为第一个参数传递给 execCommand。你的前景色指向哪里？

```
$('#output').html(c) 
```

使用 ID 输出直接更改 div 的内部 HTML，这就是它起作用的原因。

# azure - Azure 云服务计费用例

> ID：11940813
> 
> 赞同：0
> 
> 时间：2012-08-13T19:16:19.550
> 
> 标签：azure, billing, azure-worker-roles, azure-web-roles, azure-virtual-machine

我希望能够在 MS 站点或 StackOverflow 上的某处找到 Azure 计费“用例”。

也许我是偏执狂，但在我告诉客户将他的应用程序迁移到 Azure 需要花费 XXX.00 美元之前，我想确定一下。

我在他办公室的服务器上运行了一个 MVC 站点。这是一个使用 SQL-Server 的基于数据的应用程序。数据密集，但只有大约 20-30 个用户。走向“云”的目的不是可扩展性，而是可靠性。

假设我需要一个具有 2 个中型 VM（2 个以便我们具有故障转移能力）和一个 1GB SQL 数据库的云服务。假设价值 2 美元的带宽（15 GB）可能就足够了。地理冗余存储：除了数据库之外的所有东西都由代码组成。资源很少，总共不到 20 兆。

所以，我的问题是：通过运行 Web 和 Worker，我是否使用了两个实例？一个用于 Web，一个用于 Worker？如果是这样，我可以仅在 Web 角色中运行该应用程序吗？我不运行单独的服务。如果我确实为同一个站点运行了 Web 和 Worker 角色，那会是一个额外的实例（4 个实例而不是 2 个）吗？

那么，通过运行 Web 和/或 Worker 角色，我是否还会招致虚拟机实例？如果不是，如果我偶尔 RDP 进入 Web/Worker 实例，情况会改变吗？

感谢您对此的任何见解。另外，有人知道有这样的计费“用例”的 MS 网站吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T19:22:22.733

您需要为您激活的每个角色付费，因此网络角色和辅助角色将是分开的。至于将工人和网络结合在一起，不确定如何以编程方式

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T19:24:13.620

好的，让我们一一来看。

通过运行 Web 角色和 Worker 角色，同时满足每个角色至少 2 个实例的 SLA 标准，您实际上是在创建 4 个可计费实例（2 个 Web 角色实例和 2 个 Worker 角色实例）

如果适合您的目的并节省工作人员实例，您绝对可以在 Web 角色中运行服务。在这种情况下，您只有 2 个可计费实例。

不，VM 角色是完全不同的角色类型，您不是通过运行 Web/Workers 来运行 VM 角色。无论角色类型如何，您始终可以安全地 RDP 进入实例（但是，一旦您投入生产，这种行为的价值就值得怀疑了）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T19:26:35.493

根据您的描述，我不确定您为什么想要 Worker 角色。工作角色非常适合处理事务、处理等，但我不确定您是否需要。例如，工作角色可以处理提交的订单、调整图像大小等。基本上任何您想从用户界面中抽象出来的过程。

由于您提到您需要故障转移功能，因此您可能应该至少使用您选择的任何角色中的两个。例如，您将需要 MVC 网站的 Web 角色。您需要两个大小任意大小的实例，才能获得[Microsoft 的](http://www.windowsazure.com/en-us/support/legal/sla/)99.5% 的云服务 SLA 正​​常运行时间保证。

如果您决定需要一个 Worker 角色，您还需要两个实例。

不需要每个角色类型至少使用两个实例，但肯定建议用于生产应用程序，并且是 SLA 覆盖范围所必需的。

# asp.net - mysql if else for asp.net gridview

> ID：11940816
> 
> 赞同：0
> 
> 时间：2012-08-13T19:16:26.947
> 
> 标签：asp.net, mysql, gridview

我试图找出一种方法来做到这一点：

```
If (blah = 0 then 'Yes' else if blah = 1 then 'no' else 'maybe') 
```

在mysql中。我正在尝试这样做，因为我通过以下方式将所有数据插入到 gridview 中：

```
 Dim strSQL As String
    strSQL = "SELECT id, billing_first_name, billing_last_name, billing_email, billing_address, billing_city, billing_state, billing_zip, " & _
                "total, price_mode, process_status, 1 as num_of_items " & _
             "FROM orders " & _
             "ORDER BY created_on DESC, processed_on DESC LIMIT 0, 20;"

    Dim dtReader As MySqlDataReader
    objCmd = New MySqlCommand(strSQL, objConn)
    dtReader = objCmd.ExecuteReader()

    grdView.DataSource = dtReader
    grdView.DataBind() 
```

如果我可以在上面的 vb.net 代码中的某个地方而不是在数据库中执行 if/then/else，那也很好。我更习惯于使用普通查询代码这样做。

我目前只能使用 if 和 then else 来执行此操作，而不是 if、elseif 和 then else。

```
SELECT IF(process_status = 1, 'SUCCEEDED', 'blah') as message, id,... 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T19:19:52.217

在 SQL 中，这样做是这样的：

```
select 
      case blah when 1 then 'yes' 
                when 0 then 'no' 
      else 'maybe' end as blah ,
      columnb  ,
      columnc
from table 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T19:34:33.247

CASE 表达式的更简洁的替代方法是在表达式中嵌套两个 IF 函数，例如

```
SELECT If(blah=0,'Yes',IF(blah=1,'no','maybe')) AS blah 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-13T19:27:47.817

```
SELECT field1,field2,field3,
CASE field3
WHEN 0
THEN 'YES'
WHEN 1
THEN 'NO'
ELSE
'MAYBE'
END AS blah
FROM table 
```

# php - 如何使用 Facebook 提供的数据使用 Graph 链接统计

> ID：11940821
> 
> 赞同：0
> 
> 时间：2012-08-13T19:16:37.713
> 
> 标签：php, facebook, json, facebook-graph-api

搜索了很长时间后，我得到了这个链接来获取详细信息`link`

```
https://graph.facebook.com/fql?q=SELECT url, normalized_url, share_count, like_count, comment_count, total_count, commentsbox_count, comments_fbid, click_count FROM link_stat WHERE url='http://www.facebook.com/nokia' 
```

现在这是我得到的输出：-

```
{
   "data": [
      {
         "url": "http://www.facebook.com/nokia",
         "normalized_url": "http://www.facebook.com/nokia",
         "share_count": 1240,
         "like_count": 8622386,
         "comment_count": 287,
         "total_count": 8623913,
         "commentsbox_count": 2,
         "comments_fbid": 404897301238,
         "click_count": 10
      }
   ]
} 
```

经过进一步搜索，我无法从我可以理解如何使用其值的地方找到任何有价值的东西。

我向你解释如何。我有一个页面，其中有 10 个不同的链接，现在我想在那里显示总喜欢、评论和分享。我到达这里，但现在无法进一步移动。

我如何在该特定页面上使用 facebook 提供的数据？

# validation - ASP.NET Web API 是否支持 IValidatableObject？

> ID：11940827
> 
> 赞同：5
> 
> 时间：2012-08-13T19:17:27.773
> 
> 标签：validation, asp.net-web-api, data-annotations, ivalidatableobject

我有一个实现 IValidatableObject 的视图模型，并且还有几个验证属性。当我尝试在我的 ApiController 上调用操作时，只执行属性验证。ASP.NET Web API 不支持 IValidatableObject 吗？对于无法由单个属性表示的复杂验证，有什么替代方法？

**编辑：**在某个地方，我一定是捏造了一些东西。验证神秘地开始按预期工作。看起来默认情况下肯定支持 IValidatableObject 。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-03-06T16:06:05.100

使用 Web API 2.1 (Microsoft.AspNet.WebApi nuget 5.1.x)，如果任何验证属性无效，我就会遇到不调用 IValidatableObject 的 Validate 方法。因此，在调用该类的 Validate 方法之前，所有已应用到您的类的属性的验证属性必须首先作为有效属性传递。

例如，如果您有一个带有 的属性`RequiredAttribute`并且您没有在该字段中输入值，那么您的 IValidatableObject 的 Validate 方法的实现将不会被调用。虽然从技术上讲不是错误，但我希望每次验证时都会调用 Validate 方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-18T10:29:23.523

尚未在 webapi 上尝试过 IValidatableObject，但根据文档应支持它，DataAnnotations (DataAnnotationsModelValidatorProvider) 的验证提供程序也提供 IValidatableObject 验证。见这里： http: [//msdn.microsoft.com/en-us/library/system.web.http.validation.providers(v=vs.108)](http://msdn.microsoft.com/en-us/library/system.web.http.validation.providers%28v=vs.108%29)

无论如何，您也可以使用可用于装饰类的对象级 ValidationAttribute...它不像 IValidatableObject 那样简单，但应该可以工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-30T21:52:12.873

截至目前，支持 IValidatableObject。

# java - 在 Java 中提取 zip 存档中的文件时出错

> ID：11940830
> 
> 赞同：0
> 
> 时间：2012-08-13T19:17:32.393
> 
> 标签：java, zip

我正在使用此代码从 zip 存档中提取文件（省略所有 catch 语句和其他初始化语句）：

```
zipInputStream = new ZipInputStream(new FileInputStream(file));
zipFile = new ZipFile(file);
for (Enumeration<?> em = zipFile.entries(); em.hasMoreElements();) {
    String extractedFileName = em.nextElement().toString();
    ZipEntry outerZipEntry = zipInputStream.getNextEntry();
    if (outerZipEntry.getName().contains(searchString)) {
        extractedFile = new File(outputDir + outerZipEntry.getName());
        out = new FileOutputStream(outputDir + extractedFileName);
        byte[] buf = new byte[1024];
        int len;
        while ((len = zipInputStream.read(buf)) > 0) {
            out.write(buf, 0, len);
        }
        break;
     } 
} 
```

提取文件时，此代码可以正常工作，例如 /archive.zip/file_i_need.txt。

但是，当我尝试从 /archive.zip/folder1/file_i_need.txt 中提取文件时，当我尝试使用 readLine() 读取文件时出现异常 java.lang.NullPointerException：

```
String line = null ;
BufferedReader input = new BufferedReader(newFileReader(extractedFile)) ;
while( (line = input.readLine() ) != null ) {
    ...
} 
```

我在这两种情况下都对其进行了测试，当文件位于文件夹中时，此代码似乎不起作用，因为提取的文件名是 'folder/file_i_need.txt' 而只是 'file_i_need.txt'。

你有什么建议可以推荐吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T20:14:01.787

我认为您的问题是您无法在线打开 FileOutputStream `out = new FileOutputStream(outputDir + extractedFileName);`。您无法打开流，因为例如 if和 outputDir`extractedFileName`是`folder1/file_i_need.txt`，`C:/OutputDir`那么您正试图在`C:/OutputDirfolder1/file_i_need.txt`. 这样的目录不存在并且 out 变为空。我在评论中提到的帖子确实具有解压缩操作，然后您可以看到对 zip 文件中目录条目的特殊处理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T20:19:31.883

```
extractedFile = new File(outputDir + outerZipEntry.getName()); 
```

问题是您没有考虑到条目名称可能包含您没有创建的路径元素，您只需尝试写入文件即可。为什么这不会产生错误，我不确定。

你是在 Windows 上写这些文件吗？这将`folder1/file_i_need.txt`在文件系统上创建一个文件，这可能在某种程度上是无效的：P

尝试从`ZipEntry`

```
String name = outerZipEntry.getName();
name = name.substring(name.lastIndexOf("/") + 1); 
```

显然，首先检查名称实际上是否包含“/”；）

**更新**

当我在做的时候，这看起来不对

```
extractedFile = new File(outputDir + outerZipEntry.getName());
out = new FileOutputStream(outputDir + extractedFileName); 
```

基本上你的说法`outputDir + outerZipEntry.getName() + (outputDir + outerZipEntry.getName())`

**更新**

我在 Windows 上对此进行了测试，`FileNotFoundException`当我尝试将文件写入不存在的路径时，我得到了

我还在我的 Mac 上对其进行了测试，我得到了一个`FileNotFoundException`

我不知道您的错误处理在做什么，但它做错了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T19:28:50.443

您正在以两种不同的方式迭代 zip 条目：

迭代 1：

```
for (Enumeration<?> em = zipFile.entries(); em.hasMoreElements();) { 
```

迭代 2：

```
ZipEntry outerZipEntry = zipInputStream.getNextEntry(); 
```

只做其中之一。使用`ZipFile`API 或`ZipInputStream`API。我强烈怀疑这就是它的`NullPointerException`来源。

# c - 找不到 pidgin (Linux Mint) 的源包

> ID：11940834
> 
> 赞同：2
> 
> 时间：2012-08-13T19:18:00.843
> 
> 标签：c, plugins, linux-mint, pidgin

我想开始在[Linux Mint](http://en.wikipedia.org/wiki/Linux_Mint) 13 下开发 Pidgin 插件。

我已经阅读[了官方教程](http://developer.pidgin.im/wiki/CHowTo/BasicPluginHowto)，一开始说我应该使用以下命令安装 pidgin 的开发依赖项： `apt-get build-dep pidgin`

但它最终会出现以下错误消息：

> E: 找不到 pidgin 的源码包

我必须添加一个特殊的存储库吗？或者我怎样才能让 Linux Mint 找到这个包？

这是sources.list的转储：

```
deb http://packages.linuxmint.com/ maya main upstream import
deb http://archive.ubuntu.com/ubuntu/ precise main restricted universe multiverse
deb http://archive.ubuntu.com/ubuntu/ precise-updates main restricted universe multiverse
deb http://security.ubuntu.com/ubuntu/ precise-security main restricted universe multiverse
deb http://archive.canonical.com/ubuntu/ precise partner
deb http://packages.medibuntu.org/ precise free non-free

# deb http://archive.getdeb.net/ubuntu precise-getdeb apps
# deb http://archive.getdeb.net/ubuntu precise-getdeb games 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-13T20:50:19.867

编辑`/etc/apt/sources.list`并添加`deb-src`：

```
deb http://packages.linuxmint.com/ maya main upstream import
deb-src http://packages.linuxmint.com/ maya main upstream import

deb http://archive.ubuntu.com/ubuntu/ precise main restricted universe multiverse
deb-src http://archive.ubuntu.com/ubuntu/ precise main restricted universe multiverse

deb http://archive.ubuntu.com/ubuntu/ precise-updates main restricted universe multiverse
deb-src http://archive.ubuntu.com/ubuntu/ precise-updates main restricted universe multiverse

deb http://security.ubuntu.com/ubuntu/ precise-security main restricted universe multiverse
deb-src http://security.ubuntu.com/ubuntu/ precise-security main restricted universe multiverse

deb http://archive.canonical.com/ubuntu/ precise partner
deb http://packages.medibuntu.org/ precise free non-free 
```

并尝试：

```
apt-get update
apt-get build-dep pidgin 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T20:29:25.417

快速搜索显示和`http://packages.linuxmint.com/search.php`都存在 Pidgin 存储库，分别是 Linux Mint 6 和 8。Mint 默认安装的存储库可能不包含指向这些特定存储库的链接。`felicia``helena`

如果您对 Pidgin 的开发感兴趣，我建议您直接[从这里](http://www.pidgin.im/download/source/)下载文件。这可能会帮助您不是从 Mint 的角度，而是从发行独立性的角度来理解开发过程。

# php - 是否有工具或简单的 PHP 或 Jquery 解决方案可以将所有 id 和类导出到空白 css 表中？

> ID：11940836
> 
> 赞同：3
> 
> 时间：2012-08-13T19:18:28.990
> 
> 标签：php, jquery, html, css, export

我发誓我在一年前遇到过这样的工具，但我找不到它。我已经搜索和搜索，尤其是在堆栈上，但似乎没有什么是正确的。

这样做的原因是为现有网站创建备用样式表，而不必清空现有样式表等。感谢您的帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-13T19:46:42.400

## 底漆

> ...通过拉出所有类和 id 并将它们放入起始样式表中来为您的 CSS 打底。粘贴您的 HTML 以开始使用。

[http://primercss.com](http://primercss.com)

## 熊 CSS

> ...对于网页设计师来说是一个方便的小工具。它会生成一个 CSS 模板，其中包含您的标记中定义的所有 HTML 元素、类和 ID。

[http://bearcss.com/](http://bearcss.com/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T21:12:24.787

如果您不害怕编程解决方案，那么使用 jQuery 编写自己的“解析器”非常容易：

```
$("*[id*=]").each( function() {
    if(this.id !== "") {
        console.log("."+this.id+" {");
        console.log("");
        console.log("} ");
        console.log("");
    }
}); 
```

顺便说一句，它也可以很容易地变成一个书签工具，比如[这个](http://benalman.com/code/test/jquery-run-code-bookmarklet/)：

```
javascript:(function(e,a,g,h,f,c,b,d){if(!(f=e.jQuery)||g>f.fn.jquery||h(f)){c=a.createElement("script");c.type="text/javascript";c.src="http://ajax.googleapis.com/ajax/libs/jquery/"+g+"/jquery.min.js";c.onload=c.onreadystatechange=function(){if(!b&&(!(d=this.readyState)||d=="loaded"||d=="complete")){h((f=e.jQuery).noConflict(1),b=1);f(c).remove()}};a.documentElement.childNodes[0].appendChild(c)}})(window,document,"1.3.2",function($,L){$("*[id*=]").each( function() {if(this.id !== "") {console.log("."+this.id+" {");console.log("");console.log("} ");console.log("");}});}); 
```

否则，我会建议像 yckart 建议的那样尝试使用[这个 CSS 生成器](http://lab.xms.pl/css-generator/)或使用[CSS 。](http://bearcss.com/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T20:18:41.930

试试[http://spruce.flint.umich.edu/~jalarie/jaa_kcd2.htm上的](http://spruce.flint.umich.edu/~jalarie/jaa_kcd2.htm)**CSS**按钮

# javascript - 当用户单击浏览器的后退按钮时清除文本字段/文本框

> ID：11940837
> 
> 赞同：0
> 
> 时间：2012-08-13T19:18:34.153
> 
> 标签：javascript, jquery, html, firefox, google-chrome

我有一系列用户可以填写的文本字段和文本框，然后单击发送。如果他点击后退按钮，我希望这些字段为空。目前，当用户单击返回时，这些字段将填充提交之前输入的数据。

是否有适用于（几乎）所有浏览器的解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T19:23:00.033

在页面加载时，遍历所有输入并将其值设置为空字符串。不过，真的，有充分的理由对您的用户这样做吗？为了方便起见，这更像是浏览器功能，而不是网站功能。

```
$('input[type=text]').each(function(input){
    input.value="";
}); 
```

# .net - 我可以将旧 URL 上的 WCF Web 服务调用重新映射到新 URL 吗？

> ID：11940839
> 
> 赞同：1
> 
> 时间：2012-08-13T19:18:41.767
> 
> 标签：.net, wcf, web-services

我有大量托管在 WCF 中的旧版 Web 服务，这些服务曾经托管在一个通用的基本 URL 上。例如，假设我们有两个服务“Add”和“Subtract”托管在 的公共基础 URL 上`http://localhost/math/`，剩下的就是`http://localhost/math/Add/`和`http://localhost/math/Subtract/`。

此后，Web 服务已被重新改造，但为了向后兼容，我们保留了旧服务。这些现在托管在不同的通用基本 URL 上`http://localhost/Product/LegacyWebservices/`

我正在寻找一种方法来将任何内容从 重定向`http://localhost/math/*`到`http://localhost/Product/LegacyWebservices/*`.

我开始查看 .NET 4.0 中的 WCF RoutingService，但没有看到基于 URL 进行通配符映射的方法；看起来我需要为每个服务单独的客户端端点和单独的过滤器条目。这是可行的，但是当基本上我需要做的就是重新映射 URL 时，这似乎是一个很大的开销。

我正在使用自托管。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T17:16:37.433

您可以使用 localhost 作为服务的基地址，并将具有相同接口的端点添加到 localhost 之后的不同路径。

这是我认为最快的方法...

# jquery - 使用 keyup 事件按 Tab 键时，表单字段不突出显示（选择）

> ID：11940841
> 
> 赞同：0
> 
> 时间：2012-08-13T19:18:49.847
> 
> 标签：jquery, keyup

我正在使用这个简单的函数对某些数据执行正则表达式过滤器。我的函数 ,`digits`只是对输入执行正则表达式并过滤掉除数字以外的任何数据。我不认为这是问题所在。

```
$(document).ready(function() {
  var numberFields = "#adjusted,#historical,#projected";
   $(numberFields).keyup(function() {
      $(this).digits();
  });
}); 
```

我有在keyup上运行的功能。问题是当用户按下 tab 键移动到下一个字段时，下一个表单字段会失去焦点。我假设它是由 keyup 事件引起的。我怎样才能解决这个问题？我正在使用 jQuery 1.7.2。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T20:31:05.343

我最终这样做了：

```
$(numberFields).keypress(function(e) {
   //if tab key is pressed, move to next form field.
   if(e.keycode == 9) {
      $(this).next().focus();
      $(this).next().select();
   } else {
      //filter data with digits function
      $(this).keyup(function() {
         $(this).digits();
      });
   }
}); 
```

在 IE 8 中运行良好。

# macos - 是否可以创建一个由多个假设情景结果组成的表格？

> ID：11940843
> 
> 赞同：0
> 
> 时间：2012-08-13T19:18:53.220
> 
> 标签：macos, excel-formula, spreadsheet, excel-2008

我将逐步描述我的目标，因为我认为这可能是解释它的最简单方法。这就是我想要做的：

1）创建一个模板，上面有各种计算。在此模板上，1 个特定单元格留空。计算将根据此单元格中的内容而改变（我将其称为特殊单元格）。

2) 这些计算背后有一个重要的最终数字。我想要做的是创建一个包含每个可能的最终数字的列表，并在相邻的单元格中列出给出这个最终数字的特殊单元格的值。

问题是 Excel for Mac 2008 不使用宏或 VBA。在我的 Windows 版本的 Excel 中，这只是一个简单的功能。但是在 Excel for Mac 2008 上，我完全不确定如何解决这个问题。我能想到的唯一解决方案是为特殊单元格的每个可能值创建一张表，并专门针对特殊单元格的该值进行所有计算。然后我可以将每个最终数字/特殊单元格链接到一个主页，以便所有信息都放在一起。但是，特殊单元格可以获取大约 400 个值，我真的不想创建 400 个不同的工作表。有人知道我该怎么做吗？

另外，作为一个注释，以防这更容易可视化我的意思，我基本上是在尝试运行多个假设场景并从每个场景中收集一个特定的数字。

这是所涉及的过程的示例。我应该在这里提一下，实际上有 2 个不同的特殊单元，我在原始描述中写了 1，因为我假设这个想法与 2 相同：

1) 主模板工作表位于工作表 A

2）商店名称有10个插槽

3）每个商店都有一个费率，通过应用查找特殊单元格 1 和数组表在工作表 B 上的位置的 vlookup 找到该费率

4）每个store也有一个索引号（简称index）

5）每个store都有一个计算是index * special cell 2（简称calc1）

6）每家店都有另外一个计算，就是rate * num1（简称calc2）

7）每个store都有另一个索引号（简称index2）

8) index2的一些值必须乘以calc2，其余的保持不变（简称calc3）

9) 必须进行求和，将所有 calc2 值相加得到 sum1

10) 必须进行求和，将所有 calc3 值相加得到 sum2

11) 最终数字为 sum1 + sum2

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T19:25:17.490

听起来您可以创建 400 行，其中每一行都是假设场景。然后在每一行旁边，您可以获取输入和输出，并相应地绘制图表。

**更新**

到目前为止，根据您的描述，我已经创建了附带的工作簿，其中包含一些公式，让您朝着正确的方向前进： [https ://dl.dropbox.com/u/19599049/120813_2c.xlsx](https://dl.dropbox.com/u/19599049/120813_2c.xlsx)

它根据 2 个输入计算 10 个商店的 sum1 和 sum2。请注意，我为最终输出中的哪些单元格着色。黄色 = 原始 sum1/sum2 蓝色 = sum1/sum2 的数组公式版本 绿色 = 两者都使用的数据。

我这样做是为了指出，虽然这个示例工作簿似乎遵循了您的所有 11 条规则。由于某种原因，输入 2 似乎没有包含在我的模型版本的最终输出中。

无论哪种方式，这都应该成为您入门的良好基础。如果您继续包含更多详细信息，我可以对其进行修改。

# ios - 在 UIWebView 中使用 @font-face 从内存而不是磁盘访问字体

> ID：11940844
> 
> 赞同：1
> 
> 时间：2012-08-13T19:18:57.787
> 
> 标签：ios, security, encryption, uiwebview, fonts

我们开发了一个数字图书应用程序，它使用 UIWebView 在 HMTL5 中呈现页面。我们希望在每本书中包含字体。为了遵守字体许可协议，我们希望将字体加密到内存而不是磁盘。然后我们想从内存中访问 UIWebView 中的字体。这将提供非常可接受的安全级别。有谁知道如何让 UIWebView 从内存而不是磁盘访问字体？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T22:37:03.923

```
NSData *inData = /* your decrypted font-file data */;
CFErrorRef error;
CGDataProviderRef provider = CGDataProviderCreateWithCFData((CFDataRef)inData);
CGFontRef font = CGFontCreateWithDataProvider(provider);
if (! CTFontManagerRegisterGraphicsFont(font, &error)) {
    CFStringRef errorDescription = CFErrorCopyDescription(error)
    NSLog(@"Failed to load font: %@", errorDescription);
    CFRelease(errorDescription);
}
CFRelease(font);
CFRelease(provider); 
```

通过[马可](http://www.marco.org/2012/12/21/ios-dynamic-font-loading)

# javascript - div标签外面的href标签？

> ID：11940846
> 
> 赞同：1
> 
> 时间：2012-08-13T19:18:59.223
> 
> 标签：javascript, html, css, xhtml, tags

我知道 div 标签是大多数标签的容器，例如 href 标签……也就是说，我有一个有效的文档，并且仅当 a href 标签围绕两个 div 标签时才起作用。

如果我调整 div 和 href 使其符合 w3c，它会扭曲网站。我可以调整我的 .js 和 .css 以使其工作，但我想找到一个替代解决方案。我可以将 a href 标签保留在现在的位置吗？

感谢您的任何帮助或建议。

链接在这里： http: [//momentum.freeiz.com/](http://momentum.freeiz.com/)

代码在这里：

```
<a href="hapo.htm" >        
  <div class="boxgrid_slideright">
    <div id="slideshow">
      <img class= "cover" src="images/home/ hapo/0.jpg" width="161" height="107" alt="hapo credit union"/>
      <img class= "cover" src="images/home/ hapo/1.jpg" width="161" height="107" alt="hapo credit union"/>
      <img class= "cover" src="images/home/ hapo/2.jpg" width="161" height="107" alt="hapo credit union"/>
      <img class= "cover" src="images/home/ hapo/3.jpg" width="161" height="107" alt="hapo credit union"/>
      <img class= "cover" src="images/home/ hapo/4.jpg" width="161" height="107" alt="hapo credit union"/>
    </div><!--slideshow--> 
  </div><!--boxgrid-->
</a> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T19:24:48.303

您应该使用 css 设置内联元素的样式，使其表现得像块元素：

CSS：

```
a.whatever, .boxgrid_slideright, .slideshow {
  display: block;
} 
```

HTML：

```
<a class="whatever" href="hapo.htm" >        
  <span class="boxgrid_slideright">
    <span id="slideshow">
      <img class= "cover" src="images/home/ hapo/0.jpg" width="161" height="107" alt="hapo credit union"/>
      <img class= "cover" src="images/home/ hapo/1.jpg" width="161" height="107" alt="hapo credit union"/>
      <img class= "cover" src="images/home/ hapo/2.jpg" width="161" height="107" alt="hapo credit union"/>
      <img class= "cover" src="images/home/ hapo/3.jpg" width="161" height="107" alt="hapo credit union"/>
      <img class= "cover" src="images/home/ hapo/4.jpg" width="161" height="107" alt="hapo credit union"/>
    </span><!--slideshow--> 
  </span><!--boxgrid-->
</a> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T19:29:21.300

XHTML 2 将允许在任何元素上使用“href”属性，允许块级锚点，并在某些情况下消除相同锚点的重复或在其他情况下消除不必要的附加标签。这真的很有意义，因为“a”标签只是一个跨度，但唯一一个具有附加能力的跨度链接到其他地方。“a”其实并没有什么特殊的语义含义，页面上的所有链接都可以通过查找带有“href”的标签来解析。在 HTML 5 开发的早期，人们讨论了“随处引用”方法，我很兴奋认为它将成为 HTML 5 的一部分。当时，这对我来说是关于 HTML 5 最有趣的事情. 但是“任何地方的href”意味着所有以前的浏览器根本无法看到链接（除了出于某种原因放在“a”标签中的那些），所以这个想法被废弃了。相反，HTML 5 的创建者利用了当前浏览器已经具备的违反规范的能力：块级锚点。至少回到 IE 6 的浏览器会很高兴地将放置在“a”标签中的“流内容”变成链接。[通过](http://tobymackenzie.wordpress.com/2010/09/13/html5-href-anywhere-attempt/)- 托比麦肯齐

[http://davidwalsh.name/html5-elements-links](http://davidwalsh.name/html5-elements-links)

[http://html5doctor.com/block-level-links-in-html-5/](http://html5doctor.com/block-level-links-in-html-5/)

# python - python 客户端应用程序模型与 Json API 的通信

> ID：11940851
> 
> 赞同：0
> 
> 时间：2012-08-13T19:19:22.827
> 
> 标签：python, json, extjs, model, storage

对不起，我奇怪的英语的建议。我必须用 python 开发一个客户端应用程序，它与使用 JSON 协议进行数据交换的 php 服务器通信。有许多允许实现 MVC 模式的 python 框架，特别是用于数据处理的结构化模型，但所有这些模型结构都直接与 SQL 语言中的数据库对话。我的目的是使用单个服务器，将带有 JSON api 的数据发送到所有类型的设备或平台。因此，在我的 python 应用程序中，我将编写一个同步模型存储，它直接与我的 Json 服务器以及 ExtJs 4 应用程序对话，使用允许轻松实现我的请求的框架或库。有谁知道任何允许这样做的工具？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T19:38:09.980

如果我正确理解了您的问题，那么您正在寻找在应用程序服务器客户端之间放置的代理解决方案。它可能不是 100% 合适，但我建议查看Ext JS 中内置的[Ext.Direct远程处理；](http://www.sencha.com/products/extjs/extdirect)如果您不必发布和维护您的 API，RPC 应该可以正常工作。至于代理，看看[RPC::ExtDirect::Client](https://metacpan.org/module/RPC%3a%3aExtDirect%3a%3aClient)。它是 Perl 中的 Ext.Direct 客户端实现；我开发它主要是为了测试目的，但它也可能用于代理。

附带说明一下，我不确定您究竟为什么要实现这样的架构。这听起来过于复杂，没有什么好的目的。

# iphone - NSMutableArray 的搜索索引

> ID：11940857
> 
> 赞同：1
> 
> 时间：2012-08-13T19:19:55.293
> 
> 标签：iphone, objective-c, ios, nsindexset

我需要从 中搜索字符串的索引`NSMutableArray`。我已经实现了完美的代码，但我需要比这提高搜索速度。

我使用了以下代码：

```
NSIndexSet *indexes = [mArrayTableData indexesOfObjectsPassingTest:^BOOL(id obj, NSUInteger idx, BOOL *stop){
    NSString *s = (NSString*)obj;
    NSRange range = [s rangeOfString: txtField.text options:NSCaseInsensitiveSearch];
    if(range.location == 0)//
        return range.location != NSNotFound;
    return NO;
}];

NSLog(@"indexes.firstIndex =%d",indexes.firstIndex); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T19:25:52.560

有一种方法`indexOfObject`

```
NSString *yourString=@"Your string";
NSMutableArray *arrayOfStrings = [NSMutableArray arrayWithObjects: @"Another strings", @"Your string", @"My String", nil];

NSInteger index=[arrayOfStrings indexOfObject:yourString];
if(NSNotFound == index) {
    NSLog(@"Not Found");
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-13T19:40:56.873

如果您只想要一个索引（或者如果有多个索引，则只需要第一个），您可以使用您发布的方法的单数版本。您也不需要 if 子句：

```
NSInteger index = [mArrayTableData indexOfObjectPassingTest:^BOOL(NSString *obj, NSUInteger idx, BOOL *stop){
        return [obj.lowercaseString isEqualToString:txtField.text.lowercaseString];
    }]; 
```

如果要查找以搜索字符串开头的字符串，只需将 isEqualToString: 替换为 hasPrefix:。对于大型搜索集，这似乎比您发布的方法快两倍。

# javascript - 如何在除超链接/输入按钮之外 的所有内容上触发 Jquery 模糊

> ID：11940862
> 
> 赞同：0
> 
> 时间：2012-08-13T19:20:32.923
> 
> 标签：javascript, jquery

我在让 jquery 操作以理想方式运行时遇到了一个小问题。目前，一切都在一个特定领域的模糊中正常工作，这被称为“person_email”。问题是，如果最终用户这样做，并决定单击超链接，例如在 jquery 从模糊触发的页面的其余部分上单击，用户会简要地看到这个，然后继续到相应的链接。

理想情况下，只有在未单击超链接时才会触发模糊。

```
var $email = $("#person_email");
var $hint = $("#hint_edit");

$email.on('blur',function() {
  $hint.hide; // Hide the hint
  $(this).mailcheck({
    suggested: function(element, suggestion) {
        // First error - Fill in/show entire hint element
        var suggestion = "Did you mean: <span class='suggestion'>" +
                         "<span class='address'>" + "</span>" +
                         "<a href='#' class='domain'>" + suggestion.address +
                         "@" + suggestion.domain + "</a></span>?";

        $hint.html(suggestion).fadeIn(150);
    }
  });
});

 $hint.on('click', '.domain', function() {
  // On click, fill in the field with the suggestion and remove the hint
  $email.val($(".suggestion").text());
  $hint.fadeOut(200, function() {
    $(this).empty();
  });
  return false;
 });
}) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T19:31:26.480

我假设你想[离开](http://api.jquery.com/off/)

```
$("a").on("click",function() {
  $email.off();
}); 
```

# php - 如何从每个条目 ID 获取结果计数 - PHP/SQL？

> ID：11940866
> 
> 赞同：0
> 
> 时间：2012-08-13T19:20:52.993
> 
> 标签：php, sql, count

这是我正在尝试的一个小样本..因为它很难在这里编码我已经上传了一张图片..

[http://i46.tinypic.com/5bxn5u.png](http://i46.tinypic.com/5bxn5u.png)

只想显示每个房间的预订总数..谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T19:26:20.877

您需要将表格连接在一起并`COUNT()`与 a一起使用`GROUP BY`：

```
SELECT
    a.id, a.name, COUNT(*) AS num_reservations
FROM
    availables a
    LEFT JOIN reservations r
        ON r.available_id = a.id
GROUP BY
    a.id 
```

这应该为您提供每个房间的列表以及每个房间的预订总数。

要将其放入现有查询中，您可以使用以下内容：

```
$coordinator = (isset($_GET['uidse']) && is_numeric($_GET['uidse'])) ? (int)$_GET['uidse'] : 0;
$result = mysql_query("SELECT *, COUNT(*) AS num_reservations FROM availables LEFT JOIN reservations ON availables.id=reservations.available_id WHERE coordinator='" . $coordinator . "' GROUP BY availables.id"); 
```

我放置`$coordinator`在 MySQL 查询之外并添加了非常基本的验证/清理，以使您免于将来遇到 SQL 注入问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T19:26:24.510

```
SELECT availables.name, COUNT(*) FROM availables
LEFT JOIN reservations ON reservations.available_id = availables.id
GROUP BY reservations.available_id 
```

# performance - 指数线性增长 - 性能下降

> ID：11940867
> 
> 赞同：4
> 
> 时间：2012-08-13T19:20:58.570
> 
> 标签：performance, indexing, solr, lucene

我们有 4 个分片，每个分片都有 14GB 索引每个分片有一个主分片和 3 个从属分片（每个分片都有 32GB 内存）

我们预计指数规模将在不久的将来增长一倍或三倍。所以我们考虑将我们的索引合并为 28GB 索引，这样每个分片就有 28GB 的​​索引，并将每个从属服务器上的 RAM 增加到 48GB。

我们在本地进行了更改，并通过向每个具有 14GB 和 28GB 索引的服务器发送相同的 10K 实际查询来测试服务器，我们发现

1.  对于具有 14GB 索引（48GB RAM）的服务器：搜索时间为 480 毫秒，索引命中数：3.8G

2.  对于具有 28GB 索引（48GB RAM）的服务器：搜索时间为 900 毫秒，索引命中数：7.2G

所以我们看到，在 RAM 中拥有整个索引并不能帮助维持搜索时间方面的性能。当索引大小翻倍时，搜索时间线性增加一倍。

我们原本考虑只保留 4 个分片配置，但看起来现在我们必须为每个分片添加另一个分片或另一个从属。

有没有其他方法可以配置我们的服务器，以便即使索引大小增加一倍或三倍，性能也不会受到影响？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-12T23:49:19.963

我不想说这取决于，但它...取决于。

每个索引的总大小为 14GB，这对 SOLR 基本上没有什么意义。要真正了解性能，索引术语的独特性是什么？一次又一次地包含一个单词“cat”的 14GB 数据索引将非常快。

您还确认您需要以下功能，禁用它们可以大大提高性能：

## 架构

### 存储字段

您需要存储字段吗？删除它可以大大提高性能（您可以安全地拥有一个没有任何存储字段的整个索引，并完全依赖 solr 中的 facets、pivot 和其他功能来驱动 UX）。

### 省略规范

在某些情况下，您可以将此标志设置为 false 以总体上减少内存并提高性能。

### 省略TermFreqAndPositions

可以关闭，一般会减少内存并提高性能。

## 系统

### 优化核心/索引（段数）

在处理较大的索引大小时，索引优化很重要。确保每个核心都经过优化，并且当您查看核心时，它会显示段数 = 1。我发现，当您增加索引大小时，这会发挥更重要的作用（这会影响操作系统级别的文件缓存和事实读取一个大文件比读取多个小文件更容易）是的，确实有 1.71 亿多个文档。

### 术语索引间隔/频率

如果您有一个或多个字段包含非常独特的值（例如 GUID/UUID 或通常的唯一 ID），则可能需要配置术语索引间隔（默认为 256）。通常，TIF 越低，您需要的内存越多，TIF 越高，您需要的内存越少，但您可能拥有的磁盘寻道次数越多。

### 分配过多的 Ram

Solr 最好在 OS 级别磁盘缓存和分面时使用的 RAM 之间进行良好分割，您会惊讶地发现，您实际上可以通过调整其他参数来获得更好的性能，从而降低所需的 ram 使用率并释放磁盘资源。

# c# - Silverlight 中的 URI 相对资源

> ID：11940871
> 
> 赞同：2
> 
> 时间：2012-08-13T19:21:17.877
> 
> 标签：c#, file, silverlight, uri, relative-path

我的 Silverlight 项目中有一个文件，位于一个文件夹中。

我的项目叫做 Display

解决方案资源管理器结构：

```
/Resources
    cube.obj 
```

我的代码是：

```
Uri u = new Uri(@"Display;component/Resources/cube.obj", UriKind.Relative);
Stream stream = Application.GetResourceStream(u).Stream;
StreamReader reader = new StreamReader(stream); 
```

如果相关，cube.obj 将构建操作设置为 Content。

我收到了 JavaScript 中出现的 NullReferenceException，在确定问题时没有给我太多帮助。

有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T19:46:16.513

将文件的构建操作设置为“资源”，而不是“内容”。

`NullReferenceException`来自`Application.GetResourceStream(u).Stream`. _ `GetResourceStream`返回`null`是因为文件不可用，因为它是错误的构建操作。访问`Stream`空引用然后触发异常。

编辑：还要确保你的 Uri "Display;" 部分是包含 obj 文件的程序集的正确名称。

只是为了澄清。`Content`当您希望将文件与各种程序集一起放置在 XAP 文件中时使用。然后，您可以访问没有前缀“显示；组件”路径的文件。（注意：在我脑海中，我不认为我已经以这种方式加载了“内容”资源，`Application.GetResourceStream`所以我不确定它是否会起作用，但我怀疑它会起作用）。我还怀疑如果您在不同的路径/项目中具有相同的文件名，这可能会导致问题。如果您想与多个项目/程序集共享相同的资源/文件，此方法特别有用。

使用`Resource`将保持文件嵌入*在*程序集 DLL 中。有了这个，您需要指定要查看的程序集（因此有“显示；组件”前缀）。但是，如果您要打包预编译的程序集以在 Silverlight 项目中使用或希望以不同方式管理文件，则这是必要的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T19:29:53.580

您可以尝试在您的项目上启用 Silverlight 调试，这样您就可以单步执行 SL 代码，转到您的项目属性，然后在 Debug 上一直向下并启用 Silverlight 调试器，然后运行您的项目和您的 SL断点将被击中。

# wordpress - SCRIPT5009：“谷歌”未定义

> ID：11940872
> 
> 赞同：1
> 
> 时间：2012-08-13T19:21:18.960
> 
> 标签：wordpress, undefined

这是我第一次使用 wordpress，我使用的是 3.4.1 版本。由于我使用[http://www.google.com/cse/](http://www.google.com/cse/)，我的网站[http://www.unicos.cc](http://www.unicos.cc)停止在 IE 上工作。它开始加载和加载，但是如果您查看脚本，则会收到此错误：

```
<script defer onreadystatechange='google.loader.domReady()' src=//:></script>

SCRIPT5009: 'google' is undefined 
www.unicos.cc, line 1 character 1 
```

我在 header.php 上使用这个脚本：

```
<script>
  (function() {
    var cx = '000262504839720845383:sqkphv1egay';
    var gcse = document.createElement('script'); gcse.type = 'text/javascript'; gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(gcse, s);
  })();
</script> 
```

这段代码在我的 page-buscar.php （页面搜索）上调用该函数：

```
<gcse:search></gcse:search> 
```

你可以看看网站。我的代码在那里，等待您的帮助。我也是。

谢谢你的耐心！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T19:58:01.833

您的网站在 IE 中仍然是空白的。

也许您应该将自定义搜索引擎切换到 V1：

[http://www.google.com/cse/](http://www.google.com/cse/) >> 获取代码 >> “切换到搜索元素 V1 代码”

[http://productforums.google.com/forum/#!topic/customsearch/ZIwVtE2i73E](http://productforums.google.com/forum/#!topic/customsearch/ZIwVtE2i73E)

# shell - “../some/script.sh”具体是什么意思？

> ID：11940874
> 
> 赞同：1
> 
> 时间：2012-08-13T19:21:26.113
> 
> 标签：shell

有两个选项可以运行 shell 脚本：

$ ./some/script.sh

$ . ./some/script.sh

据我了解，第一个基于脚本的给定 shebang 行启动了一个新的 shell 环境。而第二个在同一个 shell 环境中执行语句。

还有更多的区别吗？

我在哪里可以找到关于第二个的更多文档？

是`.`真正的命令吗？我找不到它的联机帮助页。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-13T19:24:46.460

> 还有更多的区别吗？

问题的要点是**在同一进程中**`.`逐行执行脚本的使用。否则分叉一个新进程。并且单独的进程无法更改父进程，例如它无法更改当前目录等环境变量。

 **> 我在哪里可以找到关于第二个的更多文档？

```
[cnicutar@fresh ~]$ help source
source: source filename [arguments]
... 
```

> 是 。真正的命令

```
[cnicutar@fresh ~]$ type .
. is a shell builtin 
```

如果它不明显，`.`并且`source`是相同的*。

* * *

正如 rush 评论`source`的那样，POSIX 未指定，因此您可能应该`.`在旨在可移植的代码中使用。[点](http://pubs.opengroup.org/onlinepubs/9699919799/utilities/V3_chap02.html#tag_18_18_01)在第 2 章中指定。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T19:25:34.003

`.`是用于读取文件并执行文件中命令的 Bourne Shell 命令，您的分析基本正确。bash 和其他 shell 添加`source`为`.`.

请参阅[bash builtins](http://www.gnu.org/software/bash/manual/html_node/Bash-Builtins.html#source)手册，并参阅[Bourne sh builtins](http://www.gnu.org/software/bash/manual/html_node/Bourne-Shell-Builtins.html#Bourne-Shell-Builtins)`.`手册的顶部。

> 从当前 shell 上下文中的文件名参数读取并执行命令。如果文件名不包含斜杠，则使用 PATH 变量查找文件名。当 Bash 不处于 posix 模式时，如果在 $PATH 中找不到文件名，则搜索当前目录。如果提供了任何参数，它们将在执行 filename 时成为位置参数。否则位置参数不变。返回状态是最后执行的命令的退出状态，如果没有执行任何命令，则返回零。如果未找到文件名或无法读取文件名，则返回状态为非零。这个内置函数相当于 source。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T19:22:42.557

它用于获取环境。例如.profile。**

# asp.net - 有条件地填充 GridView

> ID：11940875
> 
> 赞同：0
> 
> 时间：2012-08-13T19:21:35.917
> 
> 标签：asp.net

我有一个 asp:GridView 绑定到一个 asp:SqlDataSource，它在用户单击 UI 中的按钮后被填充。

为了安全起见，除非某些业务逻辑检查首先成功，否则我不希望填充 GridView。

实现此目的的正确方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T19:26:17.390

正确的方法是在 Code Behind 上进行。不要在标记中设置 DataSource，只需`Datasource`在执行业务逻辑后分配 on 代码并验证它是否应该填充网格：

```
protected void button_click(object sender, EventArgs e)
{

    if(validateBusinessRules())
    {
        gridview1.DataSource=SqlDataSource2;
        gridview1.DataBind();
    }
} 
```

# php - .htaccess 以允许 .html

> ID：11940876
> 
> 赞同：3
> 
> 时间：2012-08-13T19:21:38.223
> 
> 标签：php, html, .htaccess, directory

所以我让它将.html重写为.php，但是当我需要它时它不会加载.html文件。有没有办法让它忽略书店目录？我以为我已经在里面了，但它不起作用。

```
/public_html/.htaccess
Options +FollowSymlinks
DirectoryIndex index.php index.html index.htm
RewriteEngine on
RewriteCond %{REQUEST_URI} "/bookstore/"
RewriteRule ^(.+)\.html$ http://virtualbookworm.com/$1.php [L]
ErrorDocument 404 /error.php

../bookstore/.htaccess
Options +FollowSymlinks
DirectoryIndex index.php index.html index.htm
Options +Indexes
ErrorDocument 404 /error.php 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T19:32:28.957

要忽略书店目录，您需要`!`在表达式前面加上：

```
RewriteCond %{REQUEST_URI} !/bookstore/ 
```

或者，您可以在目录中的 htaccess 文件中打开重写引擎，`bookstore`并且文档根目录中的规则将被取代：

```
../bookstore/.htaccess
Options +FollowSymlinks
DirectoryIndex index.php index.html index.htm
Options +Indexes
ErrorDocument 404 /error.php
RewriteEngine On 
```

此外，`http://virtualbookworm.com`在规则的目标中包含 将导致浏览器被重定向（使用 302 响应）并且它会更改地址栏中的 URL。如果这不是您想要的，只需将其删除：

```
RewriteRule ^(.+)\.html$ /$1.php [L] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T19:24:38.740

尝试

```
RewriteCond %{REQUEST_URI} "/bookstore/"
RewriteCond %{REQUEST_FILENAME} !-f 
RewriteRule ^(.+)\.html$ http://virtualbookworm.com/$1.php [L] 
```

`RewriteCond %{REQUEST_FILENAME} !-f`应该过滤掉请求，以便仅在“请求的”文件不存在时应用规则。

# sql - 如何从 SQL 中的另一个表中获取计数？第2部分

> ID：11940877
> 
> 赞同：-1
> 
> 时间：2012-08-13T19:21:43.290
> 
> 标签：sql, count, inner-join, outer-join

好吧，我已经在这篇文章中回答了我的问题...

[如何从 SQL 中的另一个表中获取计数？](https://stackoverflow.com/questions/11939989/how-to-get-a-count-from-another-table-in-sql)

不过，现在我还有一个问题……

最后我使用了这个查询

```
SELECT 
  Mensajes.IdMensaje, 
  Mensajes.IdCliente, 
  Mensajes.CorreoCliente, 
  Mensajes.CorreosAdicionales, 
  Mensajes.Tema, 
  Mensajes.Mensaje, 
  Mensajes.Fecha, 
  Mensajes.Hora, 
  COUNT(Archivos.IdArchivo) AS Archivos 
FROM Mensajes 
LEFT OUTER JOIN Archivos ON Mensajes.IdMensaje = Archivos.IdMensaje 
GROUP BY 
  Mensajes.IdMensaje, 
  Mensajes.IdCliente, 
  Mensajes.CorreoCliente, 
  Mensajes.CorreosAdicionales, 
  Mensajes.Tema, 
  Mensajes.Mensaje, 
  Mensajes.Fecha, 
  Mensajes.Hora 
ORDER BY Mensajes.Fecha DESC, Mensajes.Hora DESC 
```

在上一篇文章中我提到有一个名为 Clientes 的表，现在我想将它添加到上一个查询中（在选择上）

```
(Clientes.ApellidoPaterno + ' ' + 
 Clientes.ApellidoMaterno + ' ' + 
 Clientes.Nombre) AS Cliente 
```

我尝试过使用 INNER、RIGHT OUTER 和 LEFT OUTER JOIN，但这些都不起作用......

我想显示珍贵查询显示的所有数据，但我想添加另一列显示客户的全名......

Clientes 在 Clientes.IdCliente = Mensajes.IdCliente 上有一个与 Mensajes 的 FK...

希望你能帮助我谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T19:26:09.443

这应该这样做：

```
SELECT  M.IdMensaje, M.IdCliente, M.CorreoCliente, M.CorreosAdicionales, 
        M.Tema, M.Mensaje, M.Fecha, M.Hora, 
        COALESCE(C.ApellidoPaterno,'') + ' ' + COALESCE(C.ApellidoMaterno,'') + ' ' + COALESCE(C.Nombre,'') Cliente,
        COUNT(A.IdArchivo) AS Archivos
FROM Mensajes M
LEFT JOIN Archivos A
    ON M.IdMensaje = A.IdMensaje 
LEFT JOIN Clientes C
    ON C.IdCliente = N.IdCliente
GROUP BY M.IdMensaje, M.IdCliente, M.CorreoCliente, M.CorreosAdicionales, 
         M.Tema, M.Mensaje, M.Fecha, M.Hora, 
         COALESCE(C.ApellidoPaterno,'') + ' ' + COALESCE(C.ApellidoMaterno,'') + ' ' + COALESCE(C.Nombre,'')
ORDER BY M.Fecha DESC, M.Hora DESC 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T19:26:38.217

您只需要将 a 添加`JOIN`到表中，然后将字段添加到`GROUP BY`：

```
SELECT 
  Mensajes.IdMensaje, 
  Mensajes.IdCliente, 
  Mensajes.CorreoCliente, 
  Mensajes.CorreosAdicionales, 
  Mensajes.Tema, 
  Mensajes.Mensaje, 
  Mensajes.Fecha, 
  Mensajes.Hora, 
  COUNT(Archivos.IdArchivo) AS Archivos,
  c.Cliente
FROM Mensajes 
LEFT OUTER JOIN Archivos 
    ON Mensajes.IdMensaje = Archivos.IdMensaje 
LEFT JOIN 
(
    SELECT IdCliente, (ApellidoPaterno + ' ' + ApellidoMaterno + ' ' + Nombre) Cliente
    FROM Clientes
) c
    on Mensajes.IdCliente = Clientes.IdCliente
GROUP BY 
  Mensajes.IdMensaje, 
  Mensajes.IdCliente, 
  Mensajes.CorreoCliente, 
  Mensajes.CorreosAdicionales, 
  Mensajes.Tema, 
  Mensajes.Mensaje, 
  Mensajes.Fecha, 
  Mensajes.Hora,
  c.Cliente
ORDER BY Mensajes.Fecha DESC, Mensajes.Hora DESC 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T19:27:16.827

你的意思是这样的：

```
SELECT
 Clientes.ApellidoPaterno + ' ' + Clientes.ApellidoMaterno + ' ' + Clientes.NombreCliente,
 Mensajes.*
FROM (
SELECT 
  Mensajes.IdMensaje, 
  Mensajes.IdCliente, 
  Mensajes.CorreoCliente, 
  Mensajes.CorreosAdicionales, 
  Mensajes.Tema, 
  Mensajes.Mensaje, 
  Mensajes.Fecha, 
  Mensajes.Hora, 
  COUNT(Archivos.IdArchivo) AS Archivos 
FROM Mensajes 
LEFT OUTER JOIN Archivos ON Mensajes.IdMensaje = Archivos.IdMensaje 
GROUP BY 
  Mensajes.IdMensaje, 
  Mensajes.IdCliente, 
  Mensajes.CorreoCliente, 
  Mensajes.CorreosAdicionales, 
  Mensajes.Tema, 
  Mensajes.Mensaje, 
  Mensajes.Fecha, 
  Mensajes.Hora 
) AS Mensajes
LEFT JOIN
  Clientes
ON
  Clientes.IdCliente = Mensajes.IdCliente
ORDER BY Mensajes.Fecha DESC, Mensajes.Hora DESC 
```

注意可能的拼写错误。

我将问题中的查询用作子查询 LEFT JOINED（以确保子查询中的所有记录都将在 JOIN 之后保留）与`Clientes`表。

# ruby - Ruby RegEx 用于搜索和替换

> ID：11940878
> 
> 赞同：1
> 
> 时间：2012-08-13T19:21:46.103
> 
> 标签：ruby, regex

我有一个包含 SQL 转储行的文件。它的日期格式为`yyyy-mm-dd`（例如。`2012-08-13`）

我想用标记替换所有这些日期，以便将来我可以使用所有以当时日期为中心的行来填充数据库。

例如

*   `2012-08-13`我想更改为存储为类似`$$MAINDATE$$`
*   `2012-08-14`我想成为`$$MAINDATE+1$$`

这样，它们都相对于单个日期存储，并且数据在新创建日期前后都有意义。

然后我想迭代文件并将它们全部替换为基于当时参数的新日期。并根据 +1 或 +100 调整日期，或者在最后几天。

我认为匹配文本是`/\d{4}-\d{2}-\d{2}/`

但是如何替换与占用并替换旧文本的新术语匹配的文本？

更新：

我用它把标记改回日期。我怀疑它很漂亮，但它的工作原理

```
#iterate each line and look for the marker
while (line = infile.gets)
 str = line
#replace marker with data modified by the modifier
rules = Hash[str.scan(/(\$\$MAINDATE(\+|\-)\d{1,5}\$\$)/).uniq.collect do |e| 
    modifyValue = e[0].split(e[1])[1].gsub("$","").to_i
    if e[1] == "-" then
        modifyValue = modifyValue * -1 
    end
    [e[0], (today + modifyValue).to_s] 
end    ]
  rules.each do |key, value|
    str.gsub!(key, value)
  end
#write new line to array
finishedText.push str
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T20:12:16.553

像这样的东西：

```
require 'date'
def munge_dates list, base_date = Date.today
  date_regexp = /\d{4}-\d{2}-\d{2}/
  list.map do |line|
    days_difference = "%+d" % (Date.parse(line[date_regexp]) - base_date)
    line.sub date_regexp,"$$MAINDATE#{days_difference}$$"
  end
end 
```

如果您不想在其中添加 $$MAINDATE+0$$，则需要​​添加一些条件逻辑。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T20:18:55.487

```
require "date"

def format_log(str, marker, refdate)
  rules = Hash[str.scan(/\d{4}-\d{2}-\d{2}/m).uniq.collect{|e| [e, (Date.parse(e)-refdate).to_i]}]
  rules.each do |key, value|
    replacement =  "%s%s" % [value >= 0 ? "+" : "", value]
    str.gsub!(key, marker % replacement )
  end
  str
end

p format_log("2012-08-13\n2012-08-14\n2012-08-12", "$$MAINDATE%s$$", Date.today) 
```

将输出

```
"$$MAINDATE+0$$\n$$MAINDATE+1$$\n$$MAINDATE-1$$" 
```

# python - Python中动态大小的多维数组

> ID：11940879
> 
> 赞同：13
> 
> 时间：2012-08-13T19:21:47.657
> 
> 标签：python, multidimensional-array

对 python 来说非常新，所以试图将我的头包裹在多维数组上。我阅读了现有的帖子，其中大多数都处理给定维度的多维数组。就我而言，我没有可能的总行数的维度。正在处理一个文件，它是 CSV，有 7 列，但每一行，取决于满足或不符合标准，因此被起草到一个数组中。基本上每行有 7 列，但行数无法预测。该行被视为列表。

我的目标是创建符合条件的行的多维数组，然后能够访问数组中的值。我怎样才能做到这一点？

本质上，我如何处理创建 2D 列表：

```
list_2d = [[foo for i in range(m)] for j in range(n)] 
```

上面创建了一个 mxn 大小的列表，但在我的情况下，我只知道 n (columns) 而不是 m(rows)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-13T19:30:46.067

在列表中嵌套列表，您无需预先定义列表的长度即可使用它，您可以附加到它上面。想要另一个维度只需将另一个列表附加到最里面的列表。

```
[[[a1, a2, a3]  , [b1, b2, b3] , [c1, c2, c3]],
[[d1, d2, d3]  , [e1, e2, e3] , [f1, f2, f3]]] 
```

要轻松使用它们，只需查看[嵌套列表理解](http://docs.python.org/tutorial/datastructures.html#nested-list-comprehensions)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-13T19:32:02.463

在 python 中，不需要在正手上声明列表大小。

将行读取到文件的示例可能是这样的：

```
file_name = "/path/to/file"
list = []

with open(file_name) as file:
  file.readline
  if criteria:
    list.append(line) 
```

对于多维列表。在函数中创建内部列表并将其返回到附加行。像这样：

```
def returns_list(line):
  multi_dim_list = []
  #do stuff
  return multi_dim_list 
```

将第一个代码中的最后一行与

```
list.append(returns_list(line)) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-01-10T21:58:31.010

我发现这是为了创建一个简单的 2D 数组列表，它有 8 个元素宽并且在另一个维度上是动态的

```
list2d=[[] for i in xrange(8)] 
```

然后您可以将任意数量的变量分配给 8 宽数组

```
list2d[0]=[1,2,3,4,5,6,7,8,9,10,11]
list2d[1]=[12,13,14,15,16,17,18,19] 
```

等等.....

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2020-05-04T04:47:20.273

试试下面

```
#beg 

a=[[]]

r=int(input("how many rows "))
c=int(input("how many cols "))

for i in range(r-1):
    a.append([])

for i in range(r):
    print("Enter elements for row ",i+1)
    for j in range(c):
        num=int(input("Enter element "))
        a[i].append(num)

for i in range(len(a)):
     print()
     for j in range(len(a[i])):
         print(a[i][j],end="  ") 
```

# 结尾

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-04-21T06:24:45.807

你甚至可以试试这个它对我有用

`s = [[] for y in range(n)]`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-13T19:44:51.827

如果你保证'n'列，那么你可以在内存中转置。

```
from collections import defaultdict
import csv

cols = defaultdict(list)

with open('somefile.csv') as csvin:
    for row in csv.reader(csvin):
        for colno, col in enumerate(row):
            cols[colno].append(col) 
```

仍然不是 100% 确定这是你的问题......

# python - 从文本文件创建excel图表

> ID：11940888
> 
> 赞同：6
> 
> 时间：2012-08-13T19:22:46.353
> 
> 标签：python, excel

我正在运行一个模拟，它将一些结果保存在一个文件中，我从中获取我需要的数据并将其保存在

> 结果.dat

像这样：

```
SAN.statisticsCollector.Network Response Time
Min: 0.210169
Max: 8781.55
average: 346.966666667 
```

我使用 python 完成所有这些，使用 xlwt 很容易将 result.dat 转换为 excel 文件。问题是无法使用 xlwt 创建图表。我遇到了 Jpype，但是在我的 ubuntu 12.04 机器上安装很头疼。我可能只是懒惰，但仍然 - 有没有其他方法，不一定与 python 相关，将 result.dat 转换为带有图表的 excel 文件？

谢谢

ps 我要创建的文件是电子表格，而不是微软的 Excel！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-01-27T13:39:06.923

现在有一种新的可能性： http: [//pythonhosted.org/openpyxl/charts.html](http://pythonhosted.org/openpyxl/charts.html) 和[http://xlsxwriter.readthedocs.org/chart.html](http://xlsxwriter.readthedocs.org/chart.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T21:04:38.763

主要问题是目前没有实现 MS Excel 图表创建的 Python 库，显然，由于缺乏良好的图表格式文档（正如[python-excel.org 人员](http://python-excel.org)所说）及其巨大的复杂性，它们不会出现。

不过还有另外两个选择：

1.  另一种选择是使用 3-rd 方工具（如您提到的 JPype）将它们与 Python 脚本相结合。据我所知，除了 Java smartXML 之外，没有能够创建 excel 图表的库（或者当然，有用于 .NET 的库，例如[ExpertXLS](http://www.html-to-pdf.net/excel-library.aspx)），我不确定它是否会在 Mono + IronPython 上运行，尽管你可以尝试。
2.  第三个选项是 Win32 COM API，例如在[这个 SO post](https://stackoverflow.com/questions/6339115/python-extra-excel-chart-series-with-win32com)中描述的，由于您的工作操作系统，这对您来说不是一个选项。

# c++ - 具有多个对象回调的游戏循环 - 第二个对象没有任何反应

> ID：11940890
> 
> 赞同：1
> 
> 时间：2012-08-13T19:22:52.687
> 
> 标签：c++, pointers, callback, postmessage, game-loop

我有两个类，都继承自同一个基类。这是一个游戏循环，根据你所处的“状态”，它应该在 CALLBACK 方法中发送一个指向活动对象的指针——但它没有。它只发送第二个对象的指针。

如果我首先通过 PostMessage() 设置 ObjectA，然后设置 ObjectB，然后 ObjectB 不起作用，则它不会获得指向该对象的指针。

如果我设置相反，ObjectB 有效，而 ObjectA 无效。

这是循环的一般布局：（我错过了什么？）

游戏循环：

```
PostMessage( hwnd, WM_USER, 0, (LPARAM)&ObjectA );
PostMessage( hwnd, WM_USER, 0, (LPARAM)&ObjectB );

while(running)
{
    while( PeekMessage( &msg, 0, 0, 0, PM_REMOVE ) )
    {
        /* ... */
    }

    if (STATE == StateA)
    Update(&ObjectA);

    if (STATE == StateB)
    Update(&ObjectB);
} 
```

在回调方法中：

```
static ObjectA* objA;
static ObjectB* objB;

if (objA || objB)
{
    // Do stuff to objA or objB
}
else
    switch(msg)
    {
        case WM_USER:

        if (STATE == StateA)
            objA = (ObjectA*) lparam;

        if (STATE == StateB)
            objB = (ObjectB*) lparam;
        break;

        // default and WM_CLOSE
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T07:16:14.153

```
while( PeekMessage( &msg, 0, 0, 0, PM_REMOVE ) )
{
    /* ... */
} 
```

经过审查，您的代码很可能会执行以下操作：

1.  遍历所有消息，一一丢弃
2.  在“处理”完所有消息后，使用最后一条消息的参数调用 Update，这些参数（我假设）在“/* ... */”块中读取。

你能试试这个变化吗？

```
while(running)
{
    while( PeekMessage( &msg, 0, 0, 0, PM_REMOVE ) )
    {
        /* ... */

        if (STATE == StateA)
        Update(&ObjectA);

        if (STATE == StateB)
        Update(&ObjectB); // Note the "Update" callbacks moved to inner loop
    }
} 
```

# c# - 使用 NHibernate.Criterion.Restriction 时未找到命名空间

> ID：11940892
> 
> 赞同：0
> 
> 时间：2012-08-13T19:22:56.243
> 
> 标签：c#, fluent-nhibernate

我在 ASP.NET MVC3 项目中使用 Fluent NHibernate。我正在编写一个自定义会员提供程序并设置了一个 FNHRoleProvider 类。其中一部分包含以下 try catch 块：

```
private Entities.Roles GetRole(string rolename)
{
    Entities.Roles role = null;
    using (ISession session = SessionFactory.OpenSession())
    {
        using (ITransaction transaction = session.BeginTransaction())
        {
            try
            {
                role = session.CreateCriteria(typeof(Entities.Roles))
                    .Add(NHibernate.Criterion.Restrictions.Eq("RoleName", rolename))
                    .Add(NHibernate.Criterion.Restrictions.Eq("ApplicationName", this.ApplicationName))
                    .UniqueResult<Entities.Roles>();

                //just to lazy init the collection, otherwise get the error 
                //NHibernate.LazyInitializationException: failed to lazily initialize a collection, no session or session was closed
                IList<Entities.Users> us =  role.UsersInRole; 
            }
            catch (Exception e)
            {
                if (WriteExceptionsToEventLog)
                    WriteToEventLog(e, "GetRole");
                else
                    throw e;
            }
        }
    }
    return role;
} 
```

我收到一条错误消息，指出当前命名空间中不存在 Criterion，尽管我已将 NHibernate.Criterion 添加到我的 using 语句中。我还可以在对象浏览器中查看命名空间的这一部分。

如何解决构建错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T08:38:01.360

我怀疑您也将命名空间命名为 NHibernate，因此最好`NHibernate.Criterion.`先删除`Restrictions`

# javascript - tablesorter 列显示/隐藏功能

> ID：11940895
> 
> 赞同：1
> 
> 时间：2012-08-13T19:23:02.360
> 
> 标签：javascript, jquery, tablesorter

我想知道具有像 FlexiGrid 这样的列显示/隐藏功能的 tablesorter 是否如下图所示：

![在此处输入图像描述](../Images/6e05b84e16ae6cfde72257b8fc3c4442.png)

用户可以选择他们想要查看的列。

是否有插件或任何解决方法？

谢谢。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-08-13T20:04:46.983

可以把表想象成一个数据数组。如果你检查每`tr`一个`tbody`

您可以按索引选择其列。自从我做了这样的事情已经有一段时间了，但是基础就像一个数组，索引从 0 开始，所以你可以在每个语句中向下行。我想不出一个很好的例子，但是在我需要做类似的情况下，我没有办法找到对每一列的每一行做一个 each

col3 row1 索引 = 2 col3 row2 索引 = 5 col3 row3 索引 = 8

如果这对你有意义。我希望我当时能提供更好的服务。

如果您遍历该行并且`.hide()`等于该公式的那些，您应该能够根据刻度显示/隐藏那些。

# c# - 不匹配的列表类型

> ID：11940898
> 
> 赞同：2
> 
> 时间：2012-08-13T19:23:06.900
> 
> 标签：c#, list, generics, overriding

我有一个基类，它有一个返回自身列表的抽象方法。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace ConsoleApplication1
{
    public abstract class baseclass
    {
        public abstract List<baseclass> somemethod();        
    }
} 
```

还有一个后代试图通过返回一个 * *it* *self 的列表来覆盖基类的方法。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace ConsoleApplication1
{
    class childclass : baseclass
    {
        public override List<childclass> somemethod()
        {
            List<childclass> result = new List<childclass>();
            result.Add(new childclass("test"));
            return result;
        }

        public childclass(string desc)
        {
            Description = desc;
        }

        public string Description;
    }
} 
```

但我得到这个错误：

```
Error   1   'ConsoleApplication1.childclass.somemethod()':
return type must be 'System.Collections.Generic.List<ConsoleApplication1.baseclass>'
to match overridden member 'ConsoleApplication1.baseclass.somemethod()' 
C:\Users\josephst\AppData\Local\Temporary Projects\ConsoleApplication1childclass.cs 
0   42  ConsoleApplication1 
```

让基类返回自身列表的最佳方法是什么，覆盖基类执行相同操作的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T19:27:41.630

重写方法时，重写方法的签名必须与被重写方法的签名*完全*匹配。您可以使用泛型实现您想要的：

```
public abstract class BaseClass<T>
{
    public abstract List<T> SomeMethod();
}

public class ChildClass : BaseClass<ChildClass>
{
    public override List<ChildClass> SomeMethod() { ... }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-13T19:40:25.303

通用是很好的解决方案，但不要使用`public abstract List<baseclass> somemethod();`它是不好的做法

您应该使用[非虚拟接口模式](http://en.csharp-online.net/CSharp_Canonical_Forms%E2%80%94NVI_Pattern)

```
public abstract class BaseClass<T>
{
    protected abstract List<T> DoSomeMethod();

    public List<T> SomeMethod()
    {
        return DoSomeMethod();
    }
}

public class ChildClass : BaseClass<ChildClass>
{
    protected override List<ChildClass> DoSomeMethod(){ ... }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-13T19:29:58.917

错误消息是不言自明的。要覆盖该方法，您需要返回一个`List<baseclass>`.

```
public override List<baseclass> somemethod()
{
    List<childclass> result = new List<childclass>();
    result.Add(new childclass("test"));
    return result;
} 
```

# javascript - 无法使用 parseFromString 更改 JS 中变量的值

> ID：11940900
> 
> 赞同：0
> 
> 时间：2012-08-13T19:23:15.370
> 
> 标签：javascript, google-chrome, variables, google-chrome-extension, domparser

我在 Chrome 扩展程序的开头有这行：

```
var macroXML = parser.parseFromString(localStorage["myMacro"], "text/xml").getElementsByTagName("section"); 
```

做了一些更改后，我尝试更新 macroXML，但没有任何反应。

```
alert(macroXML[1]);
macroXML[1] = 'RAWR';
alert(macroXML[1]); 
```

没有错误，什么都没有。它输出完全相同的东西。

可能有人知道为什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T07:10:37.753

您正在处理一个动态节点列表。如果文档发生更改，它将更改，例如从列表中删除第二个元素，您可以执行以下操作：

```
macroXML[1].parentNode.removeChild(macroXML[1]); 
```

或者你用不同的节点替换它：

```
var newNode = macroXML[1].ownerDocument.createElement("section");
macroXML[1].parentNode.replaceChild(newNode, macroXML[1]); 
```

但是您不能像使用数组那样使用该列表 - 因为您需要一个实际的数组。您可以像这样复制列表：

```
var macroArray = Array.prototype.slice.apply(macroXML);
macroArray[1] = 'RAWR'; 
```

这将按预期工作。

# mysql - MySQL 调优和性能通过 Query_Cache

> ID：11940903
> 
> 赞同：0
> 
> 时间：2012-08-13T19:23:30.487
> 
> 标签：mysql, performance

我在我的服务器上使用 CMS (WordPress) 时遇到性能缓慢的问题。

我跑了`SHOW STATUS LIKE 'Qcache%';`

结果：

```
Variable_name               Value
Qcache_free_blocks          0
Qcache_free_memory          0
Qcache_hits                 0
Qcache_inserts              0
Qcache_lowmem_prunes        0
Qcache_not_cached           0
Qcache_queries_in_cache     0
Qcache_total_blocks         0 
```

我认为零值不好。有谁知道这些值是否可以？如果不是，您对我如何提高我的网站相对于 MySQL 的性能有什么建议吗？

谢谢。

**修正**

在运行上面的命令之前，我运行了`SHOW VARIABLES LIKE 'have_query_cache';`.

结果：

```
Variable_name       Value
have_query_cache    YES 
```

**修正案#2**

然后我跑了`SHOW VARIABLES LIKE 'query_cache%';`

结果：

```
Variable_name                   Value
query_cache_limit               1048576
query_cache_min_res_unit        4096
query_cache_size                0
query_cache_type                ON
query_cache_wlock_invalidate    OFF 
```

**修正案#3**

然后我跑了`SHOW VARIABLES LIKE 'log_slow_queries';`

结果：

```
Variable_name       Value
log_slow_queries    OFF 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T19:31:43.593

这些值表明查询缓存未激活。见[http://dev.mysql.com/doc/refman/5.1/en/query-cache-configuration.html](http://dev.mysql.com/doc/refman/5.1/en/query-cache-configuration.html)

# iphone - 启动图像上的自定义应用背景 [ios 4 & 5]

> ID：11940904
> 
> 赞同：0
> 
> 时间：2012-08-13T19:23:31.470
> 
> 标签：iphone, objective-c, ios, ipad, hig

我的 iOS 应用程序具有更改背景图像的选项，有 3 种不同的背景图案可用，用户可以选择其中任何一种。

问题是启动图像，读取 iOS HIG 它应该是类似于应用程序的 GUI（第一个“窗口”）的图像。是否可以根据用户偏好（选择的背景图案）加载不同的图像？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T19:29:03.237

您无法在应用启动期间（或在应用执行期间的任何时间）更改启动图像。处理此问题的方法（意识到您可能违反了 HIG）是在 之后直接呈现您自己的图像`applicationDidFinishLaunchingWithOptions`，并将启动图像保留为中间图像或空白。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T19:29:50.093

这样做是不可能的 - 您只能拥有一个 default.png，并且您不能在应用程序启动之前以编程方式对其进行更改。我建议简单地创建一个不同于应用背景的启动画面。请注意，iOS HIG 是*指南*而非要求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T19:27:21.800

这不可能。编译时需要设置 Default.png。

# wpf - XAML“条件”绑定

> ID：11940905
> 
> 赞同：4
> 
> 时间：2012-08-13T19:23:32.930
> 
> 标签：wpf, xaml, binding, conditional

我有一个附加到 TextBlock 样式的 DataTrigger，定义如下：

```
<DataTrigger Binding="{Binding Path=Link, Converter={StaticResource HasContentConverter}}" Value="True">
    <Setter Property="TextDecorations" Value="Underline" />
    <Setter Property="Cursor" Value="Hand" />
</DataTrigger> 
```

我遇到的问题是我有多个对象最终使用这种样式，其中一些包含“链接”属性，而另一些则不包含。每当系统遇到不存在的对象时，它就会在输出窗口中打印此错误：

> BindingExpression 路径错误：在“对象”“DataRowView”（HashCode=53681904）上找不到“Link”属性。绑定表达式：路径=链接；DataItem='DataRowView' (HashCode=53681904); 目标元素是'TextBlock'（名称=''）；目标属性是“NoTarget”（类型“对象”）

这是预期的行为，但是我想知道是否有办法告诉 XAML 中的处理器仅在“链接”属性存在时才应用（即在尝试绑定之前检查该属性，或者其他一些不存在的方法打印错误）。这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T19:48:10.943

开箱即用和直接都是不可能的。

不是开箱即用：您可以编写自己的 BindingExtension，其行为如下：如果道具存在则绑定，否则忽略。你也可以，khem，关闭报告绑定错误，但当然这通常是不想要的。

不直接：您可以创建某种类型的附加属性，然后设置此类属性而不是设置绑定。您的属性设置器将附加到 datacontext-changes 并在对象和可视组件飞来飞去时检查它们并设置绑定与否。

不直接#2：您可以尝试“分层”样式和触发器。如您所知，触发器有一个条件。将您的样式分为两部分：第一部分是不需要“保护”的通用样式，第二部分包含依赖于具有“Blargh”属性的功能。将第一个样式设置为默认/正常。现在创建一个名为“DefinesBlargh”或“HasBlarghDefines”的只读附加属性，用于检查目标对象的数据上下文是否确实具有此类属性。现在向第一个样式添加一个触发器，该触发器检测样式控件是否具有“HasBlarghDefined”等于“true”，并且在触发器的操作中......

...这就是问题所在。在那里做什么？您不能再次将样式替换为样式的第二部分，因为它可能会删除触发器并进而停用逻辑（这将是一次性的）。或者，它可能会由于尝试在一次更新扫描中更改两次样式而简单地崩溃。我实际上不知道会发生什么，但我感觉到“气味”。此外，更改为第二部分只会删除第一部分设置的常见内容。

因此，如果它实际上会运行并替换样式，则必须确保保留原始触发逻辑和第一个样式的其余部分，我建议使用“样式继承”，即基于样式属性：[http](http://wpftutorial.net/StyleInheritance.html) ://wpftutorial.net/StyleInheritance.html即不要创建两个单独的部分，而是用所有常见的东西制作一个“基础部分”，以及一个**基于**第一个和添加了不安全的额外内容。现在动态地重新替换为专门的对应物更合理一些。

或者，如果你对布局有一些控制，你可以变得聪明：为什么将两种样式应用于同一个组件？在控件的某个外部边界上设置一般样式并将额外的触发器放置在那里，并让触发器将小的不安全的第二个样式应用于控件。

如果您确实必须针对样式的两个部分都针对一个控件并且不能使用“基于”或者如果它根本不起作用等，您可以做另一个聪明的技巧：使用`MultiStyle`允许您定义合并的样式二/三/+其他样式合二为一，然后构建触发器层次结构如下：

```
multitrigger
   condition: HasBlarghDefined = TRUE
   condition: your own data condition
   setter: set style = multistyle of "generalpart" and "usnafepart"
multitrigger
   condition: HasBlarghDefined = FALSE
   condition: your own data condition
   setter: set style = just a generalpart 
```

恕我直言，那必须工作。

编辑：忘记过去的关键链接：[MultiStyle](https://stackoverflow.com/a/7502874/717732)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T15:37:55.047

所以我对此的最终解决方案是拥有一个实现相关样式的基本 DataGrid 类，减去“链接”特定数据触发器。然后我有一个从我的基类派生的新 DataGrid 类，其中包含专门创建数据触发器的代码：

```
Binding binding = new Binding("Link");
binding.Converter = new MDTCommon.Converters.HasContentConverter();
DataTrigger trigger = new DataTrigger();
trigger.Binding = binding;
trigger.Value = true;
Setter setter1 = new Setter(TextBlock.TextDecorationsProperty, TextDecorations.Underline);
Setter setter2 = new Setter(TextBlock.CursorProperty, Cursors.Hand);
trigger.Setters.Add(setter1);
trigger.Setters.Add(setter2);
Style style = FindResource("DefaultStyleInQuestion") as Style;
style.Triggers.Add(trigger); 
```

我之所以能够使用此方法，是因为具有“Link”属性的绑定对象仅在我的派生 DataGrid 类中使用。

# asp.net-mvc - ASP.NET MVC - 部分视图设计模式？

> ID：11940909
> 
> 赞同：1
> 
> 时间：2012-08-13T19:23:48.910
> 
> 标签：asp.net-mvc, asp.net-mvc-3, design-patterns

我们有一个项目，我们创建了 2 个单独的区域供站点管理员使用，具体取决于经过身份验证的用户所属的角色。这两个区域之间存在一些重叠的功能，但还不足以我们将它们组合成一个区域。因此，我们为 UI 所做的是创建一些局部视图，这些局部视图包含在两个区域内的相似视图中，但是我在决定将局部视图物理放置的位置时遇到了麻烦。

将它放在 ~/Views/Shared 中是没有意义的，因为没有一个根级视图使用这个特定的局部视图。将文件放在 ~/Areas/[Area]/Views/Shared 中也没有意义，因为这两个区域都没有直接“拥有”这个局部视图。

在这种情况下，您认为最佳实践位置是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T19:34:24.487

我认为 ~/Views/Shared 在这里不是最好的解决方案，尽管这些部分视图实际上是在两个*Areas之间***共享**的，正如我所假设的那样，它们是单独的控制器。

 *但是，您可以使用

```
Html.Partial(pathToView, model) 
```

包含局部视图的功能，可以将其放置在您想要的任何位置。即使是您提到的示例：

```
Html.Partial("~/Areas/[Area]/Views/Shared/PartialViewFile.cshtml", model) 
```

或者：

```
Html.Partial("~/Areas/Shared/Views/PartialViewFile.cshtml", model) 
```

这个解决方案对我来说似乎更相关，因为所有区域都共享视图，并且它们不属于特定区域。*

# ios - iOS：使用 CFStreamCreatePairWithSocketToHost 的套接字网络基础

> ID：11940911
> 
> 赞同：6
> 
> 时间：2012-08-13T19:24:09.830
> 
> 标签：ios, sockets, network-programming

### 用例

我正在使用套接字来发送和接收数据，并试图在发送多*组*数据（即不仅仅是 1 个*请求*）`CFStreamCreatePairWithSocketToHost()`时将我的头脑围绕在如何完成这一点上。

 **### 问题

目前我可以发送数据并接收响应（即 1 次往返）。但是，在我发送流中的所有数据后，`outputStream`流被关闭（即接收`NSStreamEventEndEncountered`）。

### 问题

那么问题来了，当我想发送多个数据请求时会发生什么？

*   每次我有一个新的数据对象要发送时，我是否设置一个新的套接字？
*   我是否必须*重置* `outputStream`并发送更多数据。

### 代码

大部分代码来自[Cocoa Streams 文档](https://developer.apple.com/library/archive/documentation/Cocoa/Conceptual/Streams/Streams.html)：

```
- (void)viewDidLoad {
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.

    _data = [[NSMutableData alloc] init];
    [self initNetworkCommunication];

    [self sendString:@"Hello World!"];
}

- (void)initNetworkCommunication {
    CFReadStreamRef readStream;
    CFWriteStreamRef writeStream;

    CFStreamCreatePairWithSocketToHost(NULL, (CFStringRef)@"123.456.0.0", 1234, &readStream, &writeStream);

    inputStream = (NSInputStream *)readStream; // ivar
    [inputStream setDelegate:self];
    [inputStream scheduleInRunLoop:[NSRunLoop currentRunLoop] forMode:NSDefaultRunLoopMode];
    [inputStream open];

    outputStream = (NSOutputStream *)writeStream; // ivar
    [outputStream setDelegate:self];
    [outputStream scheduleInRunLoop:[NSRunLoop currentRunLoop] forMode:NSDefaultRunLoopMode];
    [outputStream open];
}

- (void)sendString:(NSString *)string {
    NSData *data = [[NSData alloc] initWithData:[string dataUsingEncoding:NSASCIIStringEncoding]];
    [_data appendData:data];
    [data release];
}

- (void)stream:(NSStream *)theStream handleEvent:(NSStreamEvent)streamEvent {
    NSLog(@"stream event %u", streamEvent);

    switch (streamEvent) {
        case NSStreamEventOpenCompleted:
            NSLog(@"Stream opened");
            break;
        case NSStreamEventHasSpaceAvailable: {
            uint8_t *readBytes = (uint8_t *)[_data mutableBytes];
            readBytes += byteIndex; // ivar
            int data_len = [_data length];
            unsigned int len = ((data_len - byteIndex >= 1024) ? 1024 : (data_len - byteIndex));
            uint8_t buf[len];
            (void)memcpy(buf, readBytes, len);
            len = [(NSOutputStream *)theStream write:(const uint8_t *)buf maxLength:len];
            NSLog(@"Sending buffer of len: %d", len);
            byteIndex += len;
            break;
        }
        case NSStreamEventHasBytesAvailable:
            if (theStream == inputStream) {
                uint8_t buffer[1024];
                int len;

                while ([inputStream hasBytesAvailable]) {
                    len = [inputStream read:buffer maxLength:sizeof(buffer)];
                    if (len > 0) {
                        NSString *output = [[NSString alloc] initWithBytes:buffer length:len encoding:NSASCIIStringEncoding];

                        if (nil != output) {
                            NSLog(@"server said: %@", output);
                        }
                    }
                }

                [self sendString:@"Another Test"];
            }
            break;
        case NSStreamEventErrorOccurred:
            NSLog(@"Can not connect to the host!");
            break;
        case NSStreamEventEndEncountered:
            NSLog(@"Closing stream...");
            [theStream close];
            [theStream removeFromRunLoop:[NSRunLoop currentRunLoop] forMode:NSDefaultRunLoopMode];
            [theStream release];
            theStream = nil;
            break;
        default:
            NSLog(@"Unknown event");
    }
} 
```

### 回复：

```
2012-08-15 08:16:30.896 Sockets[34836:f803] Opened input stream.
2012-08-15 08:16:30.898 Sockets[34836:f803] Opened output stream.
2012-08-15 08:16:30.899 Sockets[34836:f803] Sending buffer of len: 12
2012-08-15 08:16:30.900 Sockets[34836:f803] Sending buffer of len: 0
2012-08-15 08:16:30.901 Sockets[34836:f803] Closing output stream.
2012-08-15 08:16:30.939 Sockets[34836:f803] server said: Hello World! 
```

请注意，在我发送数据后`outputStream`流会*关闭。*我尝试重新启动`outputStream`之前`[self sendString:@"Another Test"];`。我也试过**idz**的回答。

根据文档，我相信*len: 0 的发送缓冲区*是我的问题。

> 如果委托接收到 NSStreamEventHasSpaceAvailable 事件并且没有向流中写入任何内容，则它不会从运行循环接收更多可用空间事件，直到 NSOutputStream 对象接收到更多字节。发生这种情况时，会为空间可用事件重新启动运行循环。

但是，文档没有说明到达流末尾时关闭流的任何内容。所以我很困惑……</p>

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-08-21T21:23:06.090

套接字是连接两个程序的双向流，可能在两台不同的计算机上。它只是将您在一端写入的数据传输到另一端读取。它在数据中不强制执行任何结构，并且对请求或响应一无所知。

API将`CFStreamCreatePairWithSocketToHost`单个连接拆分为两个独立的流——一个可以读取，一个可以写入。这是一个很好的接触，底层的套接字 API 只使用一个文件描述符来读取和写入，这可能会让人很困惑。

连接保持打开状态，直到一侧关闭套接字。也有可能只在一个方向上关闭插座。也可以只在一个方向上关闭连接。如果远程关闭它的读取流，您的写入流将被关闭，反之亦然。

> 每次我有一个新的数据对象要发送时，我是否设置一个新的套接字？

你应该避免这样做。建立新连接需要一些时间，而且连接全速需要更多时间。所以你应该尽可能地重用相同的连接。

> 我是否必须重置 outputStream 并发送更多数据。

不，这不是必需的，只需发送更多数据即可。

> 根据文档，我相信 len: 0 的发送缓冲区是我的问题。

什么都不写（即长度为 0 的缓冲区）应该不是问题。文档没有说明会发生什么。所以我今天写了我的测试程序，看看会发生什么，什么都不期待。事实证明，写入长度为 0 的缓冲区会关闭输出流。所以这真的是你的问题。我将在[Apple Bug Reporter](https://bugreport.apple.com)上提交有关该文档问题的错误，您也应该这样做。

您引用的文档部分是关于不同的。如果您在收到可用空间通知后不写，则在您写完之前不会收到另一个通知。这很有用，因为系统不会浪费 CPU 周期来一遍又一遍地告诉你的代码，如果你没有什么可写的，你可以写一些东西。**

# python - 如何覆盖python字典值？

> ID：11940913
> 
> 赞同：2
> 
> 时间：2012-08-13T19:24:12.560
> 
> 标签：python, dictionary, overwrite

我的字典的简化：

```
my_dict = {
    'DOC': [
        [('k', 'v'), ('k1', 'v1'), ('k2', 'v2'), ('k3', 'v3'), ('k4', 'v4')],
        [('k5', 'v5'), ('k', 'v'), ('k1', 'v1'), ('k6', 'v6')]
    ],
    'DIC': [
        [('k7', 'v7'), ('k3', 'v3'), ('k8', 'v8')],
        [('k5', 'v5'), ('k3', 'v3'), ('k1', 'v1'), ('k2', 'v2')],
        [('k4', 'v4'), ('k9', 'v9')]
    ],
    'INFRA': [
        [('k5', 'v5'), ('k3', 'v3'), ('k1', 'v1'), ('k2', 'v2')],
        [('k', 'v'), ('k1', 'v1'), ('k2', 'v2'), ('k3', 'v3'), ('k4', 'v4')]
    ]
} 
```

覆盖我的字典值：

```
for k, v in my_dict.items():
     my_dict[k] = map(lambda x: dict(x), my_dict[k]) 
```

返回...

```
my_dict 
{'DIC': [{'k3': 'v3', 'k7': 'v7', 'k8': 'v8'},
         {'k1': 'v1', 'k2': 'v2', 'k3': 'v3', 'k5': 'v5'},
         {'k4': 'v4', 'k9': 'v9'}],
 'DOC': [{'k': 'v', 'k1': 'v1', 'k2': 'v2', 'k3': 'v3', 'k4': 'v4'},
         {'k': 'v', 'k1': 'v1', 'k5': 'v5', 'k6': 'v6'}],
 'INFRA': [{'k1': 'v1', 'k2': 'v2', 'k3': 'v3', 'k5': 'v5'},
           {'k': 'v', 'k1': 'v1', 'k2': 'v2', 'k3': 'v3', 'k4': 'v4'}]} 
```

当我按照相同的逻辑运行我的真实代码时，我得到了错误：

> ValueError：字典更新序列元素 #0 的长度为 6；2 是必需的

我试图创建另一个字典来接收`map()`但发生了同样的错误。有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-13T19:32:59.950

真实测试用例中的输入不符合您期望的结构。特别是，至少有一个元素是长度为 6 的序列，而不是所有的元组。例如，错误的输入可能如下所示：

```
{'DOC': [
    [('123456')],               # A string is a sequence, too
    [('123' '456')]             # Note the lack of a comma
    [('1','2','3','4','5','6')] # A tuple, but with 6 elements
    [['1','2','3','4','5','6']] # A list
]} 
```

要解决此问题，请检查您的输入，例如：

```
for k, v in my_dict.items():
    for l in v:
        for subl in v:
            for tup in subl:
                if not len(tup) == 2:
                    raise ValueError('In %r: value is not a tuple(2), but %r'
                                     % (k, tup)) 
```

哦，顺便说一句，在设计数据结构时，遵循[Python 之禅](http://www.python.org/dev/peps/pep-0020/)通常是个好主意，其中包括：

> 平面优于嵌套。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T19:35:30.063

`dict`构造函数需要一个包含 2 项子序列（列表或元组）的序列。至少一个子序列包含两个以上的项目。

也许您缺少逗号（请参阅最后一项）：

```
>>> dict([('1', 'red'),('2', 'blue'),('3' 'purple')]) # missing comma in last item
Traceback (most recent call last):
  File "<pyshell#166>", line 1, in <module>
    dict([('1', 'red'),('2', 'blue'),('3' 'purple')]) 
ValueError: dictionary update sequence element #2 has length 7; 2 is required 
```

或者可能是单个项目而不是元组（再次，请参阅最后一项）

```
>>> dict([('1', 'red'),('2', 'blue'),('purple')]) # last "tuple" has one item
Traceback (most recent call last):
  File "<pyshell#167>", line 1, in <module>
    dict([('1', 'red'),('2', 'blue'),('purple')])
ValueError: dictionary update sequence element #2 has length 6; 2 is required 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T19:43:16.437

问题在于，在您的“真实代码”中，其中一个列表的第一个元素具有两个以上的元素 (6)。`dict`恰好需要两个来将它们解释为`key, value`.

这是一个生成您描述的错误的示例：

```
my_dict = {
    'DOC': [
        [('k', 'v', 'extra1', 'extra2', 'extra3', 'extra4'), ('k1', 'v1'), ('k2', 'v2'), ('k3', 'v3'), ('k4', 'v4')],
        [('k5', 'v5'), ('k', 'v'), ('k1', 'v1'), ('k6', 'v6')]
    ],
    'DIC': [
        [('k7', 'v7'), ('k3', 'v3'), ('k8', 'v8')],
        [('k5', 'v5'), ('k3', 'v3'), ('k1', 'v1'), ('k2', 'v2')],
        [('k4', 'v4'), ('k9', 'v9')]
    ],
    'INFRA': [
        [('k5', 'v5'), ('k3', 'v3'), ('k1', 'v1'), ('k2', 'v2')],
        [('k', 'v'), ('k1', 'v1'), ('k2', 'v2'), ('k3', 'v3'), ('k4', 'v4')]
    ]
} 
```

这是一个简单的方法来插入打印语句以查看问题元素：

```
for k, v in my_dict.items():

    # Print out the first element of each list,
    # because one of them has six elements when it should only have two.
    for l in my_dict[k]:
        print l[0]

    my_dict[k] = map(lambda x: dict(x), my_dict[k]) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-14T00:41:48.663

我认为您问题中的代码和数据没有问题。假设“真实”代码没有明显不同，您可以执行以下操作来找出导致错误发生的格式错误的数据：

```
def test(x):
    print x
    return dict(x)

for k, v in my_dict.items():
#     my_dict[k] = map(lambda x: dict(x), my_dict[k])
     my_dict[k] = map(test, my_dict[k]) 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-08-13T19:37:50.217

这个比你的更简单的代码怎么样：

```
temp_dict = {}
for k in my_dict():
    temp_dict[k] = {}
    for t in my_dict[k]:
        temp_dict[k][t[0]] = t[1]
my_dict = temp_dec
del temp_dec 
```

# mocking - 替代扩展 ArgumentMatcher 以验证 mockito 的参数

> ID：11940914
> 
> 赞同：1
> 
> 时间：2012-08-13T19:24:19.283
> 
> 标签：mocking, mockito, argument-matcher

我想知道除了使用扩展 ArgumentMatcher 的类之外，是否还有更优雅的方法来验证参数？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-13T21:55:44.367

您是否正在寻找`ArgumentCaptor`这样做的方法？请参阅[http://docs.mockito.googlecode.com/hg/latest/org/mockito/Mockito.html#captors](http://docs.mockito.googlecode.com/hg/latest/org/mockito/Mockito.html#captors)。这使您可以对传递给模拟方法的值执行任何您喜欢的检查。它通常比设置`ArgumentMatcher`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T21:09:51.917

我不知道您所说的“更优雅”是什么意思，但是实现自定义 ArgumentMatcher 的另一种方法是使用将`Mockito.argThat`Hamcrest[匹配](http://code.google.com/p/hamcrest/)器作为参数的匹配器。Hamcrest 库本身和第三方都有许多可用的 Hamcrest 匹配器，这样可以避免您编写自己的自定义参数匹配器，但如果您需要的匹配器还没有，您可以编写自定义 Hamcrest matcher 而不是 Mockito ArgumentMatcher。这是否更优雅在旁观者的眼中。

[可以在Mockito's Matcher vs Hamcrest Matcher 的](https://stackoverflow.com/questions/8348046/mockitos-matcher-vs-hamcrest-matcher)[这个答案](https://stackoverflow.com/a/8351055/316745)中看到它的使用示例。

# c++ - C++、对象模型和多态性：运行时检查

> ID：11940916
> 
> 赞同：3
> 
> 时间：2012-08-13T19:24:23.200
> 
> 标签：c++, runtime, polymorphism, type-conversion

让我们有以下课程

```
class Animal
{
  public: 
    virtual short getFeet() = 0;
    virtual void setFeet(short feet) = 0;
}; 
```

和 2 个派生类：

```
class Bird : public Animal
{
    short flying_speed; 
  public:
    virtual short getFeet() { return 2; }  // always 2 feet
    virtual void setFeet(short feet_) { };
    virtual short getFlyingSpeed() { return flying_speed; }
};

class Mammal : public Animal 
{
    short feet; // whale: 0 feet, human: 2 feet, others: 4 feet
  public:
    virtual short getFeet() { return feets; }
    virtual void setFeet(short feet_) { feet = feet_ };
}; 
```

**A）关于对象模型的问题：**

让我们专注于财产的脚。如何处理属性 feet 和方法 getFeet() 和 setFeet()。

属于同一类的一些动物的足量不同，因此它们使用属性足和方法`getFeet()`并且`setFeet()`是常见的。

有些动物有相同数量的脚，所以它们不使用自己的属性`feet`。该方法`getFeet()`返回一个常量，该方法`setFeet()`不做任何事情。

这个模型是正确的还是推荐与可变脚相关的任何更改（有很多动物没有脚）？

**B）关于多态性的问题**

一类具有某些特定特征；例如飞翔的鸟。所以问他们以什么速度飞行是有道理的，看方法`getFlyingSpeed()`。

我们想使用多态性并创建一个指向 a 的指针`Bird`：

```
int main(int argc, _TCHAR* argv[])
{
    Animal *a = new Bird();
    std:: cout << a->getFlyingSpeed() << '\t'; // error!
} 
```

我想，编译器不会在编译期间检查正确的分配，但只有两种类型的运行时检查。但我错了，因为...

> *错误 C2039: `getFlyingSpeed`: 不是`Animal`*

有什么办法，如何使用并非所有类都通用的属性和多态性？还是只能强制运行时类型 chcek ？

也许这个模型不正确。如何重新设计它？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T19:39:57.717

您的呼叫动物应仅提供所有动物（或您想在您的应用程序中使用的动物）共有的功能。对于并非所有动物共有的其他特征，可以使用多重继承来实现子类型动物的所需行为。所以一个子类型可能是 FlyingAnimals。

```
class FlyingAnimal
{
  public: 
    virtual short getFlyingSpeed() = 0;
    virtual ~FlyingAnimal(){}

};

class Bird : public Animal, public FlyingAnimal
{
    short flying_speed; 
  public:
    virtual short getFeet() { return 2; }  // always 2 feet
    virtual void setFeet(short feet_) { };
    virtual short getFlyingSpeed() { return flying_speed; }
}; 
```

您还可以为有脚的动物定义一个子类等。

或者，您可以像这样构建它，而不是多重继承：

```
class FlyingAnimal: public Animal
{
  public: 
    virtual short getFlyingSpeed() = 0;
    virtual ~FlyingAnimal(){}

};

class Bird : public FlyingAnimal
{
    short flying_speed; 
  public:
    virtual short getFeet() { return 2; }  // always 2 feet
    virtual void setFeet(short feet_) { };
    virtual short getFlyingSpeed() { return flying_speed; }
}; 
```

但是，在您的主要方法中，您需要定义您怀疑的动物类型。

```
int main(int argc, _TCHAR* argv[])
{
    FlyingAnimal *a = new Bird();
    std:: cout << a->getFlyingSpeed() << '\t'; // not an error anymore!
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-13T19:43:56.687

```
Animal *a = new Bird(); 
```

分配是正确的；`Bird`派生自`Animal`，因此 a`Bird*`可以存储在 a 中`Animal*`。但是指针的类型是指向`a`的指针`Animal`，而不是指向的指针`Bird`，所以只能调用为 定义的成员函数`Animal`。这就是为什么编译器反对

```
a->getFlyingSpeed() 
```

`getFlyingSpeed`不是 的成员函数`Animal`。另一方面，调用

```
a->getFeet() 
```

没关系，因为`getFeet`是 的成员函数`Animal`。它将调用中`getFeet`定义的版本`Bird`，因为它是指向`Bird`的对象的类型。`a`

简而言之，C++ 是静态类型的；也就是说，类型是在编译时确定的，这就是为什么你只能`Animal`在`a`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-13T19:44:42.163

**一个）**

公开曝光`setFeet()`看起来很奇怪（好吧，可以说这是业余外科医生沙箱），但我建议重新设计对象层次结构，如下所示：

```
class Animal
{
public:
    virtual short getFeet() const = 0;
}

class SurgeonDelight : public Animal
{
    short feetNumber;
public:
    short getFeet() const {return feetNumber;}
    virtual void setFeet(short feet) {feetNumber = feet;}
} 
```

然后，您从 继承所有具有恒定英尺数的动物，从 继承所有其他`Animal`动物`SurgeonDelight`。我们`setFeet`对其后代进行虚拟化，以便能够实现改变英尺数的一些副作用。`SurgeonDelight`隐藏实际数据成员以强制执行“更改的单一理由”。

**二）**

您可以使用 RTTI 和`dynamic_cast`，但基本上您应该构建`Bird`为`Bird`

有人告诉我“你的设计很糟糕，如果你必须做 dynamic_cast”。我倾向于同意。我编码超过 5 年，一次没有使用`dynamic_cast`（因为我们不支持它）。如果您的动物园中有更多具有飞行速度的动物（例如`Turtle`），您应该在您的层次结构中注入额外的泛化层。

我在少数库中看到的另一个不太好的方法是保留“扩展”API：

```
virtual void* extension(int functionId, int param) = 0; 
```

是的，很丑，但可以让你到达那里

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-13T19:50:55.450

这是一个丰富的话题。考虑这个残酷的解决方案：

```
struct FlyingSpeed {
  bool meaningful;
  short speed;
  static const FlyingSpeed nofly; 
};

const FlyingSpeed FlyingSpeed::nofly = { false, 0 }; 
```

如果 fly_speed 方法返回一个 FlyingSpeed 类型的对象而不是一个短的。Animal 的每个实例都可以通过返回 FlyingSpeed 对象来响应 getFlyingSpeed 方法。鸟类、蝙蝠、蜜蜂会有有意义的 FlyingSpeed。蠕虫、狼、海象将具有无意义的 FlyingSpeed。袋鼠可能有飞行速度，也可能没有，这取决于你对跳跃的看法。蜘蛛在 balooning 时会有一个有意义的 FlyingSpeed，而[一旦](http://en.wikipedia.org/wiki/Ballooning_%28spider%29)它们结网，就会有一个无意义的 FlyingSpeed。

类对象*nofly*是一种方便，因此陆生、树栖和水生动物可以具有简洁的构造函数。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-13T19:45:40.633

这里有一些问题。

**首先**，在实例`feet`的生命周期内甚至可以更改属性是没有意义的。`Animal`即使人类有 2 英尺，他们也不能突然长出三分之一或 77 英尺。此外，对于同一动物类型的所有实例，它可能应该是相同的。所以`feet`应该每个类都固定，而不是每个实例都可以设置。

尝试这个：

```
class Animal
{
  private:
    short _feet;
  protected:
    Animal(short feet) : _feet(feet) { }
  public:
    short getFeet() { return _feet; }  // and call it 'getNumberOfFeet`; see below.
                                       // note: no longer virtual!
};

class Whale : public Animal
{
  public:
    Whale() : Animal(0) { }
};

class Mammal : public Animal { … };

class Ape : public Mammal
{
  public:
    Ape() : Animal(2) { }
}; 
```

（抱歉，如果有一些错误。我的 C++ 技能这些天有点生疏。）

另请注意，我将所有猿类的英尺数设置为 4。这是因为如果您`Human`从`Ape`（假设我们都相信进化论......）派生出一个类，并且`Ape`有 4 英尺，这是否有意义通过说人类只有2个来反驳这一点？您的类型层次结构中会出现问题，因为`Human`s 显然不是正确`Ape`的 s。

顺便说一句，如果您的财产被称为`numberOfFeet`，而不是`feet`。使用`feet`，您会期望得到 a`std::vector<Foot>`或类似的东西。毕竟，当有人对你说*“把你的脚给我”*时，你会把腿放在他们的腿上什么的，但你不会说*“两个！”* ... 你会？

* * *

**其次**，对于您的代码示例：

```
int main(int argc, _TCHAR* argv[])
{
    Animal *a = new Bird();
    std:: cout << a->getFlyingSpeed() << '\t'; // error!
} 
```

两种可能：

*   你总是知道`a`指的是一个`Bird`. 那你为什么要声明变量`a`as`Animal*`而不是 as`Bird*`呢？

*   `a`可能指也可能不指`Bird`. 那你为什么打电话`a->getFlyingSpeed()`？如果`a`不是`Bird`实例会发生什么？

一种可能的解决方案：

```
class Animal
{
  public:
    void explainYourself() = 0;
};

class Bird : public Animal
{
    …
  public:
    void explainYourself()
    {
        std::cout << "I am flying at " << getFlyingSpeed() << " mph." << std::endl;
    } 
```

};

```
class Mammal : public Animal
{
    …
  public:
    void explainYourself()
    {
        std::cout << "Hello, I have " << getFeet() << " feet." << std::endl;
    }
};

int main(…)
{
    Animal *a = new Bird();
    a->explainYourself();
    return 0;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-13T19:44:46.607

A）我想所有动物一旦被创造出来就不能改变英尺的数量，除非你真的想允许这样做。因此，最好`feet`在 Animal 的构造函数中定义并移除关联的 setter。然后 Animal 的子类可以毫无问题地调用基本构造函数。我认为为有脚的动物开设一堂课是不值得的，因为表明动物根本没有脚通常是有意义的。

B) 建议最合适的是：为飞行动物创建一个接口类（使用纯虚拟方法）。调用它`FlyingAnimal`，您可以使用`FlyingAnimal*`指针来调用您的方法。如果您想知道动物是否可以在运行时飞行，`bool canFly()`可以使用一种方法，从而使动态演员表安全。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2012-08-13T19:42:46.143

您可以在运行时检查它是哪种类型`dynamic_cast`：

```
void tryFlying(Animal *a) {
    Bird *b = dynamic_cast<Bird *>(a);
    if (b) {
        std::cout << "uninitialized speed junk " << b->getFlyingSpeed() << std::endl;
    } else {
        std::cout << "can't fly" << std::endl;
    }
}

int main() {
    Animal *a, *b;
    a = new Bird;
    b = new Mammal;
    tryFlying(a);
    tryFlying(b);
    return 0;
} 
```

输出：

```
 uninitialized speed junk -27757
 can't fly 
```

带有免费的内存泄漏（需要虚拟析构函数）。

# asp.net - 在下一页添加上一个查询字符串参数

> ID：11940921
> 
> 赞同：0
> 
> 时间：2012-08-13T19:24:37.630
> 
> 标签：asp.net, c#-4.0

我不知道查询字符串中的前一页参数，我想在下一页发送。

我正在这样做但不工作：

```
<a href="w4_wchange_states_2.aspx?St=AL" + '<% HttpContext.Current.Request.RawUrl; %>' id="A_AL">Alabama</a> 
```

有 40 个标签重定向到同一页面。

请帮助我如何做到这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T19:25:54.230

用于*完整*`HttpContext.Current.Request.Url.ToString()`的网址。

 *或者，只是查询字符串段：

```
<a href="w4_wchange_states_2.aspx?St=AL&<% 
    Request.Url.Query.Substring(1, Request.Url.Query.Length - 1);
    %>" id="A_AL">Alabama</a> 
```*

# terminal - 与会话分离后查看远程服务器的先前终端输出。

> ID：11940927
> 
> 赞同：0
> 
> 时间：2012-08-13T19:24:51.853
> 
> 标签：terminal, desktop, byobu

所以我目前正在连接到远程服务器并完成一项需要一段时间的工作。要监视它，我必须查看程序输出的终端输出日志。但是当我分离它并回到服务器时，我只看到最新的输出页面。我如何才能看到分离后的所有输出？我正在使用 byobu 来分离 btw。

先感谢您。

-橡木

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T19:37:17.047

我不知道byobu，但只要它保持终端打开以使程序继续运行，您就可以做普通的命令行魔术。启动程序并将其输出重定向到文件。然后您可以观看该文件：

```
program-doing-much > /tmp/some-file.log 
```

您可以使用在后台运行该命令`&`，也可以简单地打开一个新的“虚拟终端”并在`tail -f /tmp/some-file.log`那里发出。

您也可以使用`tee`，以便您可以继续观察程序运行，并在需要时稍后阅读完整的日志文件。

```
program-doing-much | tee /tmp/some-file.log 
```

请记住，您只是在重定向`stdout`. 如果程序提供有关 的信息`stderr`，您也必须重定向它。

# java - 想要创建一个联系人活动

> ID：11940933
> 
> 赞同：-1
> 
> 时间：2012-08-13T19:25:33.043
> 
> 标签：java, android, android-layout

我想创建一个新的活动来从用户的手机中获取所有联系人（只有那些有电话号码的人）。我会为此使用 ContactsContract。但是，要显示结果，我应该使用什么 UI 组件来显示 android 手机中的所有联系人？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T19:30:15.010

您想使用带有光标适配器和光标加载器的 ListView 来绑定您的结果。

[http://developer.android.com/guide/components/loaders.html](http://developer.android.com/guide/components/loaders.html)

# python - Django：中间件制作更多条目

> ID：11940936
> 
> 赞同：0
> 
> 时间：2012-08-13T19:25:39.470
> 
> 标签：python, django, middleware

```
class Middleware:

    def process_request(self, request):
        #ipreq(self)
        ip = request.META['HTTP_X_FORWARDED_FOR']
        make_entry(ip)

    def make_entry(self, ip):
        p = Logging_protocol.objects.create(proto = ip)

        p.save() 
```

这是我的中间件类中的代码。问题是它在登录和注销时在表中输入了两个条目。我想在用户登录时记录一次IP。当页面从特定 IP 加载时，它也会进入

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T17:34:24.443

请注意，中间件对每个请求都进行操作。因此，您应该记录每个请求的代码，而不仅仅是登录/注销。

您可能希望查看事件框架以仅响应登录和注销。

此外，您可能应该使用新型类。

# c# - 面向.net3.5框架的Dapper中没有where子句的select语句

> ID：11940939
> 
> 赞同：3
> 
> 时间：2012-08-13T19:25:52.897
> 
> 标签：c#, dapper

我在我的项目中使用 Dapper micro-ORM，我想从表中选择所有记录。下面是我的代码。

```
 var result = connection.Query<Department>("Select * From Department"); 
```

我收到以下错误

```
No Overload for method 'Query' takes 1 argument 
```

我的项目的目标框架是 .net 3.5。如果我只是将项目的目标框架更改为 .net 4.0，然后重新安装 dapper（使用 nuget）一切正常。

我不想使用 where 子句（即查询方法没有附加参数）。有没有办法使用针对 .net 3.5 框架的 dapper 运行此查询？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T19:36:06.147

在当前代码中，您*必须*`param`在 NET35 构建中传递一个参数。这可以`null`。尝试：

```
var result = connection.Query<Department>("select * from Department", null); 
```

# r - 如何杀死R中的绘图过程？

> ID：11940953
> 
> 赞同：14
> 
> 时间：2012-08-13T19:26:37.770
> 
> 标签：r

有时我在 R 会话中的设备中有非常重的情节。例如，当我更改设备指向的窗口大小时，它的重绘速度会非常缓慢。键入`Ctrl`+`C`似乎不会终止绘图任务。

有没有办法在绘制时“取消”或杀死 R 中的情节？

编辑：我使用的是 Linux，只是来自终端（通常是 gnome-terminal）的普通 R shell。无论我使用什么系统，我想每个系统都可能有很多答案，或者是一个综合答案，它显示了如何在任何系统上执行此操作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T18:15:09.300

包叉中有一个kill函数 [http://cran.r-project.org/web/packages/fork/index.html](http://cran.r-project.org/web/packages/fork/index.html)

现在，由于 R 不会产生单独的 gnuplot 进程或您可以杀死的 smth，我认为您将能够向实际的 R 进程发送 SIGINT 以停止计算。因此 INT 在 unices 上通常为 2，并且您想将 kill -2 发送到 R 进程的 PID。

这样做的坏方法是通过

`system('pkill -2 R')`

:) 干杯

# enterprise-architect - 有没有一种简单的方法来安排 Enterprise Architect 中的意大利面条混乱布线？

> ID：11940955
> 
> 赞同：3
> 
> 时间：2012-08-13T19:26:42.467
> 
> 标签：enterprise-architect

我有一个很大的遗留项目。

我加载了整个项目：`Project->Source Code Engineering->Import Source Directory:(c++) & (path)`

有没有一种简单的方法可以在 Enterprise Architect 中安排箭头的意大利面条混乱布线......或仅手动。

* * *

我发现以下内容可以显着清理...但仍然有点混乱

```
 - View->Show Grid
 - View->Snap to Grid->Smart Placement
 - Diagram->Layout Diagram 
 - Diagram->Zoom->Fit to Window 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T23:42:17.447

The first thing to consider is that a diagram is not "the model" but a **view** of the model. Only create diagrams that communicate specific aspects of the model that are important to you.

The "spaghetti mess wiring" diagram that shows every class in your system can only communicate one thing: that your model is complex. As such, you don't need to tidy up the wiring; I'm sure the diagram communicates the complexity fine as it is ;)

If you want **useful** diagrams though, I would suggest identifying the most important classes in your model, create a diagram for each, drop the class onto the diagram and right-click->Add->Related Elements (I think that's what the command is called). You will end up with more diagrams, but they will be focused on what is important.

# php - htmlspecialchars里面的所有标记

> ID：11940959
> 
> 赞同：0
> 
> 时间：2012-08-13T19:27:03.840
> 
> 标签：php, htmlspecialchars

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T19:29:36.927

Sanitize it on the way in. Then you only have ONE chance to screw it up and get your site hacked, instead of having to get it right everywhere you use the data.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T19:31:22.373

I think you probably want to parse the HTML with [DOM](http://php.net/manual/en/book.dom.php), then find all instances where there's code between `<pre>` and `<code>` tags.

Then you can take that text and do a `str_replace()` on it.

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-13T19:30:42.247

```
$data = 'one<pre><code>two</code></pre>three';
$code = preg_match('~^(.*)<pre><code>(.*)</code></pre>(.*)$~', $data, $matches);
var_dump($matches); 
```

# objective-c - 新手询问从 NSMutableArray 读取 NSMutableArray 并将其保存到文档文件

> ID：11940966
> 
> 赞同：1
> 
> 时间：2012-08-13T19:27:27.293
> 
> 标签：objective-c, ios, cocoa-touch

在 上`viewDidLoad`，我的应用程序填充 NSMutableArray `arrayOfHaiku`，它是一个`NSDictionary`项目数组，如下所示：

```
 NSError *error;
 NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES); //1
 NSString *documentsDirectory = [paths objectAtIndex:0];
 NSString *path = [documentsDirectory stringByAppendingPathComponent:@"haiku.plist"];
 NSFileManager *fileManager = [NSFileManager defaultManager];
 if (![fileManager fileExistsAtPath: path])
 {
 NSString *bundle = [[NSBundle mainBundle] pathForResource:@"haiku" ofType:@"plist"];
 [fileManager copyItemAtPath:bundle toPath: path error:&error];
 }
 self.arrayOfHaiku = [[NSMutableArray alloc] initWithContentsOfFile: path]; 
```

在使用应用程序时，用户将项目添加到`self.arrayOfHaiku`. 截至目前，我在以下代码中包含以下代码`viewDidUnload`：

```
NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES); //1
NSString *documentsDirectory = [paths objectAtIndex:0];
NSString *path = [documentsDirectory stringByAppendingPathComponent:@"haiku.plist"];
NSFileManager *fileManager = [NSFileManager defaultManager];
if ([fileManager fileExistsAtPath: path])
{
    [self.arrayOfHaiku writeToFile:path atomically:YES];
} 
```

以下是我的问题：

1.  我的代码a) 是简单地用新的扩展数组（这是我想要做的）`viewDidUnload`覆盖存储在 Documents 文件夹中的数组（即在 中访问的数组）的文档，还是 b) 追加`viewDidLoad`新的、扩展的数组到已经存储在 Documents 文件夹中的数组，这样我最终得到的数组的长度是一堆重复的两倍多？

2.  如果答案是“b)”，我需要改变什么来做“a)”？

3.  `viewDidUnload`每次用户将项目添加到 self.arrayOfHaiku 时，是否更好 a) 以我正在执行的方式执行它，或者 b) 扩展文档文件夹中的数组？

4.  如果答案是“b)”，我需要改变什么来做“b)”？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T19:47:43.470

1.  如果文件存在，它将被覆盖，否则将被创建（选项 a）。

2.  这完全取决于记录的数量。如果你有一个巨大的数字，那么每次重写它们可能会很昂贵。否则，您必须寻找另一种解决方案。老实说，我不建议使用`viewDidUnload`，因为它在某些情况下可能不会触发，例如，如果应用程序是后台的。

3.  不幸的是，没有现成的功能可以“更新”带有字典对象的 plist，例如`writeToFile:`. 您可以使用 NSFileHandler 的`fileHandleForUpdatingAtPath:`功能，但是您必须手动更改 plist 文件（我认为这不是一个简单的过程）。

我个人会建议使用[Core Data](http://developer.apple.com/library/ios/#documentation/cocoa/Conceptual/CoreData/cdProgrammingGuide.html)，除非您的数据结构非常简单并且“选项 a”不会是一个昂贵的过程。

希望这可以帮助。

# python - 在 healpy.mollview() 中更改颜色条标签的字体大小

> ID：11940971
> 
> 赞同：1
> 
> 时间：2012-08-13T19:27:44.167
> 
> 标签：python, matplotlib, healpy

我正在使用 healpy 的`mollview()`函数（[http://healpy.github.com/healpy/generated/healpy.visufunc.mollview.html](http://healpy.github.com/healpy/generated/healpy.visufunc.mollview.html)）来绘制地图。我可以为颜色栏指定标题和标签，但我看不到如何更改字体大小。抱歉，如果这不是发布此问题的正确位置...我在 healpy 的项目页面上找不到任何地方可以询问它。我也不能将这个问题标记为“healpy”，因为我没有足够的声誉，而且以前没有人问过关于 healpy 的问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2016-08-05T20:22:58.450

另一个迟到的回应：

不幸的是，这`rcParams`对问题不起作用`units`，因为这是函数中的一个`text`对象`hp.visufunc.mollview`。

```
import healpy as hp
import numpy as np
import matplotlib

fontsize = 20

d = np.arange(12*16**2)
hp.mollview(d, title='Hello', unit=r'T', notext=False, coord=['G','C'])

matplotlib.rcParams.update({'font.size':fontsize})
matplotlib.pyplot.show() 
```

[![不完整](../Images/9a5c76823bd08c7dc2aea1d015d89f1e.png)](https://i.stack.imgur.com/cY5ZU.png)

如您所见，单位和坐标系对应的文本对象不受影响，因为它们只是具有单独的文本处理系统。可以通过使用`gcf()`函数来改变对象，即

```
import healpy as hp
import numpy as np
import matplotlib

fontsize = 20

d = np.arange(12*16**2)
hp.mollview(d, title='Hello', unit=r'T', notext=False, coord=['G','C'])

matplotlib.rcParams.update({'font.size':fontsize})
matplotlib.pyplot.show()

f = matplotlib.pyplot.gcf().get_children()
HpxAx = f[1]
CbAx = f[2]

coord_text_obj = HpxAx.get_children()[0]
coord_text_obj.set_fontsize(fontsize)

unit_text_obj = CbAx.get_children()[1]
unit_text_obj.set_fontsize(fontsize)

matplotlib.pyplot.show() 
```

[![完全的](../Images/13779fdb979a02bf42f161d4b9a08c0d.png)](https://i.stack.imgur.com/Tej2K.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2021-07-23T10:29:59.153

（由于我的声誉低，我无法评论 Warpig 的评论）

截至 2021 年 7 月，我`IndexError: list index out of range`在拨打电话时也收到了`HpxAx = f[1]`、`healphy=1.11.0`和`matplotlib==3.0.0`。我的解决方法是先创建图形，然后更新它：

```
import numpy as np
import matplotlib.pyplot as plt
from matplotlib import cm
import healpy as hp

matplotlib.rcParams.update({'font.size': 18}) # fontsize for colorbar's values
fontsize = 22
cm.magma.set_under("w") # set background to white

# create figure
d = np.arange(12*16**2)
hp.mollview(d, title='Hello', unit=r'T', notext=False, coord=['G','C'], cmap=cm.magma)

f = plt.gcf() # accessing the current figure...
CbAx = f.get_children()[2] # ... then the colorbar's elements
coord_text_obj = CbAx.get_children()[1] # [1] corresponds to the particular label of the
                                        # colorbar, i.e. "Field value" in this case
coord_text_obj.set_fontsize(fontsize)
plt.show() 
```

请注意，在这种情况下，我只对将颜色条的标签字体大小增加到 22 并将颜色条的极端值增加到 18 感兴趣；“赤道”标签不受影响。如果要保存图，记得在`plt.show()`.

[图片链接由于信誉低](https://i.stack.imgur.com/XnvK3.jpg)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-27T18:34:00.677

对不起，迟到的答案，但如果有人从谷歌找到这个有用：

您可以更改绘图更新中所有文本的字体大小`rcParams`：

```
import matplotlib
matplotlib.rcParams.update({'font.size': 22}) 
```

# wpf - 为什么这个 ColorAnimation 没有启动？

> ID：11940974
> 
> 赞同：2
> 
> 时间：2012-08-13T19:27:58.440
> 
> 标签：wpf, controltemplate, togglebutton, visualstatemanager, coloranimation

我试图让 ColorAnimation 根据控件的状态发生。我为 ToggleButton 创建了一个 ControlTemplate，它看起来像这样：

```
<ControlTemplate TargetType="ToggleButton">
    <Border>
    <Grid>
        <VisualStateManager.VisualStateGroup>
             <VisualStateGroup x:Name="CommonStates">
                  <VisualState x:Name="MouseOver">
                      <Storyboard>
                           <ColorAnimation Storyboard.TargetName="ColorChangeRect" 
                               Storyboard.TargetProperty="(Rectangle.Fill).(SolidColorBrush.Color)"
                               To="Blue" Duration="0:0:3" />
                      </Storyboard>
                  </VisualState>
             </VisualStateGroup>
        </VisualStateManager.VisualStateGroup>
        <Rectangle x:Name=ColorChangeRect" Fill="Red" />
        <ContentPresenter Content="{TemplateBinding Content}" />
    </Grid>
    </Border>
</ControlTemplate> 
```

不幸的是，什么都没有发生。我不确定我在这里缺少什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T19:36:27.863

将`VisualStateManager.VisualStateGroups`附加属性放在模板的根元素上，即`Border`代码中。这就是从那里`VisualStateManager`获取状态的地方。

# java - 使用 Flexjson 将 JSON 列表反序列化为对象列表

> ID：11940975
> 
> 赞同：3
> 
> 时间：2012-08-13T19:28:03.917
> 
> 标签：java, json, serialization, flexjson

我正在尝试反序列化以下 json：

```
{ "books": [ {"id":"1","name":"book 1"}, {"id":"2","name":"book 2"} ] } 
```

进入列表。它以前使用过这个json：

```
[ {"id":"1","name":"book 1"}, {"id":"2","name":"book 2"} ] } 
```

使用此代码：

```
List<Book> items = new JSONDeserializer<ArrayList<Book>>()
.use("values", Book.class).deserialize(json, ArrayList.class); 
```

但是现在看了多个例子我很茫然，是否可以直接反序列化成列表？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-29T20:46:02.810

从@vikke 获取样本，我成功地应用了 long 列表的反序列化。

```
List<Long> idsLong = new JSONDeserializer<List<Long>>().use("values", Long.class).deserialize("[123,456,789]"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T19:09:00.210

好的，我想我找到了一个可以接受的解决方案，虽然我不知道它有多优化

```
List<Book> items = new JSONDeserializer<Map<String,List<Book>>>().
use("values.values", Book.class).deserialize(json, Map.class).get("books"); 
```

将产生书籍列表。如果有人可能有更“合适”的解决方案，请随时发表评论。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-11-13T00:01:15.067

flexjson 1.9.2 下

List list = new JSONDeserializer>().use(null, ArrayList.class).use("values", Long.class).deserialize( episodeIds ); System.out.println( 列表 );

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2012-08-13T19:46:17.527

尝试这个。它和我一起工作。

```
JavaScriptSerializer jss = new JavaScriptSerializer();

List<Book> lstBook = jss.Deserialize<List<Book>>("your string"); 
```

# git - 如何跨 Git 存储库中的所有分支更新文件

> ID：11940977
> 
> 赞同：7
> 
> 时间：2012-08-13T19:28:41.060
> 
> 标签：git, git-branch

如果一个存储库有许多分支：如何简单地更新所有分支的文件。

在这种情况下，它是一个类似 bashrc 的文件，它指定了一些环境变量。我过去更新了主分支版本，然后重新建立了每个分支的基础。这有一种 n+1 的开销，我想避免。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-14T06:09:11.343

要扩展[fork0](https://stackoverflow.com/users/410126/fork0)的[评论](https://stackoverflow.com/questions/11940977/how-to-update-a-file-across-all-branches-in-a-git-repository#comment15906759_11940977)，您需要结合：

*   “[如何使用 bash 脚本遍历所有 git 分支](https://stackoverflow.com/a/3847586/6309)”
*   “[`git checkout`来自另一个分支的特定文件](http://nicolasgallagher.com/git-checkout-specific-files-from-another-branch/)”（`git checkout <branch_name> -- <paths>`来自[`git checkout`手册页](http://git-scm.com/docs/git-checkout)）

IE：

```
#!/bin/bash
branches=()
eval "$(git for-each-ref --shell --format='branches+=(%(refname))' refs/heads/)"
for branch in "${branches[@]}"; do
  if [[ "${branch}" != "master" ]]; then
    git checkout ${branch}
    git checkout master -- yourFile        
  fi
done 
```

（这适合您的情况，因为它总是从`master`分支中签出文件。）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2017-07-13T08:15:41.457

我认为，这有点晚了，但下面的脚本会帮助你。

```
#!/bin/bash

if [ $# != 1 ]; then
    echo "usage: $0 <filename>"
    exit;
fi

branches=`git for-each-ref --format='%(refname:short)' refs/heads/\*`
curr_branch=`git rev-parse --abbrev-ref HEAD`
# echo "curr_branch:"$curr_branch

filename=$1
file_in_repo=`git ls-files ${filename}`

if [ ! "$file_in_repo" ]; then
    echo "file not added in current branch"
    exit
fi

for branch in ${branches[@]}; do
    if [[ ${branch} != ${curr_branch} ]]; then
        git checkout "${branch}"
        git checkout "${curr_branch}" -- "$filename"
        git commit -am "Added $filename in $branch from $curr_branch"
        echo ""
    fi
done
git checkout "${curr_branch}" 
```

# sql - 多列中的不同值

> ID：11940986
> 
> 赞同：4
> 
> 时间：2012-08-13T19:29:08.273
> 
> 标签：sql, distinct, sap-ase

我正在尝试为表中的多个列获取不同的值。

例如，如果我的表有 COL1、COL2、COL3 作为列，并且我正在运行类似的查询

```
SELECT DISTINCT COL1, COL2, COL3 FROM TABLEx 
```

但会发生什么取决于其中一列中的数据，我在另外两列中得到重复值。如果 COL1 有 40 个唯一值，COL2 只有 10 个唯一值，COL3 有 5 个唯一值。我得到 40 行数据，其中 COL1 是唯一的，COL2/COL3 具有重复值。如何获取每列的 DISTINCT 值并将重复值替换为空值。我这样做只是为了在网页中为我的下拉列表获取不同的值。我总是可以对每个字段执行单独的查询，但我认为它不是很有效。我如何处理这个问题有什么帮助吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-13T19:32:18.803

> 我总是可以对每个字段执行单独的查询

是的！做这个！

> 但我认为它不是很有效。

应该没问题吧。您可以通过向每列添加单独的索引来提高性能。如果您仍然担心它会变慢，请测量它以确定。如果事实证明这确实是一个问题，那么您可能需要考虑使用缓存。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T19:39:42.460

不完全确定这是您正在寻找的内容，而且它只会比单独的查询更高效：

```
select distinct a, null, null
  from MyTable
 union
select distinct null, b, null
  from MyTable
 union 
select distinct null, null, c
  from MyTable 
```

注意：这当然不是编写 sql 查询的*正确*方法，但确实为该问题提供了可能的解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-17T14:27:49.717

我使用了单个查询，但仅在获得结果集后才使用 Set 来存储唯一值。这样我就不会用多个查询加载数据库。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-13T19:40:14.443

如果您的 Sybase 版本恰好包含 row_nubmer()，您可以使用 union all 执行此操作：

```
select seqnum, max(col1) as col1, max(col2) as col2, max(col3) as col3
from ((select row_number() over (order by col1) as seqnum
              col1, NULL as col2, NULL as col3
       from (select distinct col1
             from t
            ) t
      ) union all
      (select row_number() over (order by col2) as seqnum
              NULL as col1, col2, NULL as col3
       from (select distinct col2
             from t
            ) t
      ) union all
      (select row_number() over (order by col3) as seqnum
              NULL as col1, NULL as col2, col3
       from (select distinct col1
             from t
            ) t
      )
     ) t
group by seqnum
order by seqnum 
```

这会为每个值添加一个序列号，然后使用 group by 组合它们。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-07-04T13:21:41.110

```
SELECT DISTINCT c1, c2 FROM t 
```

也可以使用

```
SELECT c1, c2 FROM t GROUP BY c1, c2 
```

它对我有用。

# c++ - 使用从 sqlite 选择语句中获取的向量时的 C++ Logic_error

> ID：11940999
> 
> 赞同：0
> 
> 时间：2012-08-13T19:29:41.200
> 
> 标签：c++, sqlite

我尝试运行我的 C++ 代码并尝试调试过去 1 小时。我一直在检查，但不确定我做错了什么？

如果我输入了错误的用户/密码，则代码不会有问题，但如果我正确输入了 logincheck=actionvalue，它将抛出如下所示的错误。

这是我的数据库选择语句的外观：

```
root@ubuntu:/home/baoky/version1.2/Assignment 2# sqlite3 abeserver.db
SQLite version 3.7.9 2011-11-01 00:52:41
Enter ".help" for instructions
Enter SQL statements terminated with a ";"
sqlite> select * from abe_account;
admin|Peter John|admin|password

if (logincheck==actionvalue) 
```

我的代码.cpp

```
#include <iostream>
#include <stdlib.h>
#include <stdio.h>
#include <signal.h>
#include <sys/types.h>
#include <sys/socket.h>
#include <sys/un.h>
#include <vector>
#include <string>
#include <fstream>
#include <sqlite3.h>

#define DEFAULT_PROTOCOL 0
#ifndef AF_LOCAL
#define AF_LOCAL AF_UNIX
#endif
#ifndef PF_LOCAL
#define PF_LOCAL PF_UNIX
#endif 

//g++ -o test test.cpp -lsqlite3 (sample compile with sqlite3)

using namespace std;
/* THIS IS SERVER CODE */
/* I WILL USE A TEMP FILE account.txt for basic login auth check */

int readLine (int fd, char* str)
 {
   int n;
   do /* Read characters until NULL or end-of-input */
     {
     // ssize_t read (int fd, void *buf, size_t count);
     // if successful, read will:
     // a) stores data read into 'buf', and
     // b) returns the no. of bytes read
     // read returns zero if it reaches end-of-input
       n = read (fd, str, 1); /* Read one character */
     }
   while (n > 0 && *str++ != 0);
   return (n > 0); /* Return false if end-of-input */
 }

string readClient (int fd)
 {
   char str[2000];

   while (readLine (fd, str)) /* Read lines until end-of-input */
     return(string)str; /* return as string */
 }

std::vector<std::string> split(std::string const& str, std::string const& delimiters = "#") {
  std::vector<std::string> tokens;

  // Skip delimiters at beginning.
  string::size_type lastPos = str.find_first_not_of(delimiters, 0);
  // Find first "non-delimiter".
  string::size_type pos = str.find_first_of(delimiters, lastPos);

  while (string::npos != pos || string::npos != lastPos) {
    // Found a token, add it to the vector.
    tokens.push_back(str.substr(lastPos, pos - lastPos));
    // Skip delimiters.  Note the "not_of"
    lastPos = str.find_first_not_of(delimiters, pos);
    // Find next "non-delimiter"
    pos = str.find_first_of(delimiters, lastPos);
  }
  return tokens;
}

std::vector<std::string> split(std::string const& str, char const delimiter) {
  return split(str,std::string(1,delimiter));
}

int main()
{

int serverFd;
int clientFd;
int serverLen;
int clientLen;
int counter;

string action;
string actionvalue;

string receiveClient;
string sendClient;
string department;

string sline;
string logincheck;
ifstream myfile;

struct sockaddr* serverSockAddrPtr;
struct sockaddr* clientSockAddrPtr;
struct sockaddr_un serverAddress;
struct sockaddr_un clientAddress;

//for handle zombie
//to ignore SIGCHLD(death of child signal).The zombies will not be seen.
signal(SIGCHLD, SIG_IGN);
//zombies(defunct processes ps command in Linux will show defunct entries)

cout << "" << endl;
cout << "Running server program 'ABEServer' ...... " << endl;
cout << "" << endl;

// SOCKET CREATION PART - SERVER
serverFd = socket (AF_LOCAL, SOCK_STREAM, DEFAULT_PROTOCOL);

/* Set domain type */
serverAddress.sun_family = AF_LOCAL; 

/* Set name */ 
strcpy (serverAddress.sun_path, "ABEServer"); 

/* GET SIZE OF Server Addres */
serverLen = sizeof serverAddress;
/* GET SIZE OF Client Addres */
clientLen = sizeof clientAddress;

/* Get Server Sock Address Pointer*/
serverSockAddrPtr = (struct sockaddr *) &serverAddress; 
/* Get Client Sock Address Pointer*/
clientSockAddrPtr = (struct sockaddr *) &clientAddress; 

/* Create file */
unlink("ABEServer");
bind (serverFd, serverSockAddrPtr , serverLen);

/* listen for connection */
listen (serverFd,5);

cout << "Server started";
cout << "" << endl;
// SOCKET CREATION END - SERVER

while (1) /* Loop forever */
{
/* Accept a client connection */
clientFd = accept (serverFd, clientSockAddrPtr, (socklen_t*) &clientLen);

if (fork () == 0) /* Create child to send client */
{

    while(1)
    {
        sendClient = "";
        //read client input
        receiveClient = readClient(clientFd);
        vector<string> x = split(receiveClient, '#');

action = x[0];
actionvalue = x[1];

if(action=="auth")
{

logincheck = "";
counter = 0;
department = "";

//default sendClient value
sendClient = "fail login#Invalid username/password.";
    sqlite3 *db;
    sqlite3_stmt * stmt;
    std::vector< std::vector < std:: string > > result;
    for( int i = 0; i < 4; i++ )
    result.push_back(std::vector< std::string >());

    if (sqlite3_open("abeserver.db", &db) == SQLITE_OK)
    {
    sqlite3_prepare( db, "SELECT * from abe_account;", -1, &stmt, NULL );//preparing the statement
    sqlite3_step( stmt );//executing the statement

    while( sqlite3_column_text( stmt, 0 ) )
        {
    for( int i = 0; i < 4; i++ )
    result[i].push_back( std::string( (char *)sqlite3_column_text( stmt, i ) ) );
    sqlite3_step( stmt );
    counter++;
        }
    //close connection to db and finalize sql statement
                    sqlite3_finalize(stmt);
                    sqlite3_close(db);
        //username:password // using first record to check
                for ( int i = 0; i < counter; i ++)
                {
                //result[column][row]
                logincheck = result[0][i] + ":" + result[3][i];
                department = result[2][i];
                }

                if (logincheck==actionvalue)
                {
                //send back in format of login done, login message, department level
                sendClient = "login done#Successfully Login";
                break;
                }
    result.clear();
}
}//end if auth

    write (clientFd, sendClient.c_str(), strlen (sendClient.c_str()) + 1);
    }//end while      

}//end if fork 

        else
        {
        close (clientFd); /* Close the client descriptor */
        }//end else

}//end while outer

return 0;
} 
```

错误信息：

```
Username > admin
Password > password
terminate called after throwing an instance of 'std::logic_error'
  what():  basic_string::_S_construct null not valid
Segmentation fault (core dumped) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T21:31:50.557

It appears that the following line is likely the culprit.

```
result[i].push_back( std::string( (char *)sqlite3_column_text( stmt, i ) ) ); 
```

Since the value returned by `sqlite3_column_text` can be NULL it must be checked before passing it to the constructor of std::string. Change it to something like the following.

```
pointer_value = (char *)sqlite3_column_text( stmt, i );
if(pointer_Value != NULL)
{
    result[i].push_back( std::string( pointer_value ) );
} 
```