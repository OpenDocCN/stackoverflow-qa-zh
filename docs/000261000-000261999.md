# StackOverflow 问答 000261000-000261999

# asp-classic - 在不同的端口号上访问 SQL（经典的 ASP 连接字符串）

> ID：261004
> 
> 赞同：2
> 
> 时间：2008-11-04T05:45:27.560
> 
> 标签：asp-classic, connection-string

我有一个连接到本地 sql server 2000 实例的旧经典 ASP 站点。我们正在将数据库移动到一个新盒子，并且端口对于 sql 来说是非标准的（我无法控制）。.NET 连接字符串通过在服务器名称/IP 后面添加 ,1999 来处理端口号。经典的 ASP 连接字符串不使用相同的语法。我检查了 connectionstrings.com 并找不到一个有效的。

当前连接字符串（设置为 Global.asa 中的应用程序变量）：

```
Driver={SQL Server};Server=xxx.xxx.xxx.xxx;Database=dbname;Uid=dbuser;Pwd=dbpassword 
```

我已经安装了 SQL Native Client，但也无法正常工作（仍在处理这个问题）

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-06T19:26:52.177

解决方案是从 MS 安装 SQL Native Driver，然后将连接字符串更新为以下内容：

```
Driver={SQL Native Client};Server=xxx.xxx.xxx.xxx,port;Database=dbname;Uid=dbuser;Pwd=dbpassword 
```

由于后来解决的防火墙问题，我最初无法使其与 SQL Native Client 一起使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-04T05:59:45.287

我认为我们需要更多信息。你用什么连接数据库？ODBC？OLE 数据库？您是否通过 ODBC DSN 连接？是 ASP 代码中的连接字符串，还是通过 VB 或 COM DLL 访问数据？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-04T06:33:12.193

```
cst = "Provider=SQLOLEDB;" & _  
        "Data Source=<x.x.x.x>,<port number>;" & _  
        "Initial Catalog=<dbname>;" & _  
        "Network=DBMSSOCN;" & _  
        "User Id=<uid>;" & _  
        "Password=<pwd>"  

    set conn = CreateObject("ADODB.Connection")  
    conn.open cst 
```

[更多信息](http://sqlserver2000.databases.aspfaq.com/how-do-i-connect-to-sql-server-on-a-port-other-than-1433.html)

# unix - Unix 问题：自动识别本地安装库的路径

> ID：261013
> 
> 赞同：2
> 
> 时间：2008-11-04T05:50:44.603
> 
> 标签：unix, shared-libraries

我在 Fedora Linux 机器上工作。

我在我的主目录下本地安装了大量的二进制文件和库。

我想设置我的系统，以便在那里安装软件的功能与（对我而言）相同，就好像 root 用户安装它时没有前缀一样。

我可以通过将该目录添加到我的 PATH 变量中来运行安装在 ~/local/bin 中的二进制文件，但是如何链接到 ~/local/lib 和 ~/local/lib64 中的库呢？

是否有类似于 LD_LIBRARY_PATH 变量但在编译而不是运行时找到库的东西？我不想担心通过 L~/local/lib 或通过 ./configure 脚本中的标志将路径显式传递给编译器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-04T07:35:16.827

有两种方法可以让库在运行时工作：

1.  如果库仅供您使用，并且它不是多用户系统，请使用`$LD_LIBRARY_PATH`环境变量

2.  如果您是系统上唯一的用户，您可以将目录添加`/etc/ld.so.conf`到`/etc/ld.so.conf.d`. 之后运行`ldconfig`重建系统的共享库缓存

在编译时事情还不是很清楚。GNU 链接器支持`-rpath`参数和`$LD_RUN_PATH`环境变量来指定库路径。但是，在每种情况下，结果路径最终都会硬编码在二进制文件中，因此如果您随后想要移动文件，则必须重新编译它们。

我相信使用`./configure`样式脚本构建的程序应该能够找到您的任何库`$LD_RUN_PATH`，但无法对其进行测试。

在任何一种情况下，运行`./configure --prefix=${HOME}/local`都应该允许`configure`解析包含目录和库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-04T06:13:44.087

将`LIBRARY_PATH`环境变量设置为`$HOME/local/lib:$HOME/local/lib64`. 您还可以设置环境变量`C_INCLUDE_PATH`并`CPLUS_INCLUDE_PATH`在`$HOME/local/include`. 这些是 GCC 用来查找库和包含文件的环境变量，因此它们可能不适用于其他编译器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-04T07:22:24.293

除了设置 LD_LIBRARY_PATH，您还可以查看 /etc/ld.so.conf（适用于所有用户，甚至是 root）。如果使用 /etc/ld.so.conf，还要考虑系统的安全性；如果人们从您的目录运行该库，他们相信您不会惹恼他们。

# java - 我在哪里可以看到 Sun JDK 的源代码？

> ID：261015
> 
> 赞同：68
> 
> 时间：2008-11-04T05:52:44.583
> 
> 标签：java, linked-list

我想看看Java是如何实现LinkedList的。我应该去哪里看源代码？

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2008-11-04T06:01:31.583

[从http://java.sun.com/javase/downloads/index.jsp](http://java.sun.com/javase/downloads/index.jsp)安装 Java SE 开发工具包。

`src.zip`安装后，您应该会在 JDK 安装目录的顶部找到一个名为的存档。Java源代码在那里。

该文件是`java/util/LinkedList.java`.

*更新：*您可能还想访问在线[OpenJDK 源代码库](http://hg.openjdk.java.net/)。请参阅下面的[答案](https://stackoverflow.com/a/5308086/513397)。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2008-11-04T06:32:38.340

您在[docjar](http://www.docjar.com)中有源代码：

**[LinkedList.java](http://www.docjar.com/html/api/java/util/LinkedList.java.html)**（来自[openjdk-7](http://www.docjar.com/projects/openjdk-7-java.html)）

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2011-03-15T06:06:46.610

源代码托管在[hg.openjdk.java.net 上](http://hg.openjdk.java.net)。您可以在 下找到特定 JDK 版本的库源`src/share/classes`。例如，java.util.LinkedList 的 JDK 8 源代码位于：

[hg.openjdk.java.net/jdk8u/jdk8u/jdk/file/tip/src/share/classes/java/util/LinkedList.java](http://hg.openjdk.java.net/jdk8u/jdk8u/jdk/file/tip/src/share/classes/java/util/LinkedList.java)

您可以按照[此处](https://stackoverflow.com/a/410780/513397)的说明来探索源代码。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2016-06-29T08:53:02.480

[grepcode.com](http://www.grepcode.com)拥有几乎所有开源项目的源代码。它还提供了常见的 IDE 功能，如查找用法、派生类型等。

在这里您可以找到 LinkedList 源： http: [//grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/8u40-b25/java/util/LinkedList.java/](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/8u40-b25/java/util/LinkedList.java/)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-04T08:44:20.057

如前所述，如果您在安装过程中选择了 src.zip 文件，那么您已经随 Sun JDK 一起安装了它。此外，如果您使用 eclipse 并将 JDK 添加到您的 JRE 列表中，它会自动将源附加到 jar 中，如果您尝试使用 ++（打开类型）打开一个类`Ctrl`，`Shift`您`T`键入 LinkedList，它会显示给您类的代码。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-06-01T21:09:22.190

如果您有 JDK，则可以在 src.zip 文件中找到源代码。

如果你有一个 IDE，你可以在你想查看定义的类/方法上加上`ctrl`+或类似的东西。`click`

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-11-04T06:00:35.067

这里：

[http://hg.openjdk.java.net/](http://hg.openjdk.java.net/)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2018-07-28T06:51:53.397

zGrepCode 有一个 Java 开源代码的在线目录。以下是可用的 Sun Java 类：[https ://zgrepcode.com/java/openjdk/10.0.2/java.base/sun/](https://zgrepcode.com/java/openjdk/10.0.2/java.base/sun/)

这是[LinkedList](https://zgrepcode.com/java/openjdk/10.0.2/java.base/java/util/linkedlist.java)的实现代码。希望能帮助到你。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-04T06:01:46.513

我会说从[OpenJDK 存储库](http://hg.openjdk.java.net/)开始，但我没有看到 LinkedList 对象的任何内容。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-07-23T06:00:17.353

查看 java 源代码的最佳方式是安装 Intelli-J 社区版。创建一个新的 Java 项目并在您的项目中创建一个新类。在类里面如果想看LinkedList的源码，新建一个LinkedList对象，如下：

```
public class LinkedListWatch{
   public static void main(String[] args){
    LinkedList linkedList = new LinkedList();

  }
} 
```

现在上课`ctrl + mouse left click`，`LinkedList`会带你去LinkedList源码。你可以探索很多东西，它可能非常有用。

[![在此处输入图像描述](https://i.stack.imgur.com/xUxtj.png)](https://i.stack.imgur.com/xUxtj.png) [![在此处输入图像描述](https://i.stack.imgur.com/XWTkd.png)](https://i.stack.imgur.com/XWTkd.png)

您也可以查看 Stack 类的实现；非常有帮助。

享受搜索 java 开源代码的乐趣。

# macos - 通过替换为 NOP 来修补 CALLL 在用户空间中有效，但在内核空间中无效

> ID：261021
> 
> 赞同：2
> 
> 时间：2008-11-04T05:55:06.997
> 
> 标签：macos, assembly, x86, stack, patch

我有一个要修补的设备驱动程序。此设备驱动程序调用 IOLog，我想摆脱日志记录。

如果我用设备驱动程序 (kext) 中的（相应数量的）NOP 替换 CALLL 到 IOLog，内核会崩溃，看起来像一个破碎的堆栈（“Backtrace 终止 - 无效帧指针 0”）。

然而，相同的技术在用户空间中工作得很好（例如，在 OS X 二进制文件中 NOPping NSLogs）。

我在这里想念什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-04T07:18:18.060

您没有解释您是进行冷补丁（磁盘上的驱动程序）还是热补丁（内存中的驱动程序）。对于内存中的修补，可能存在各种问题，例如修补时正在执行的驱动程序、具有缓存部分代码的 CPU 等。请参阅 Intel 手册中有关自修改代码的部分。

对于磁盘上的修补，可能是您有目标地址的重定位记录。所以当驱动加载时，动态模块加载器会在代码中修复IOLog的地址，替换为真实地址。这将覆盖您的 nop 指令。

# javascript - 使用 Javascript 的幻灯片放映

> ID：261024
> 
> 赞同：1
> 
> 时间：2008-11-04T05:59:05.070
> 
> 标签：javascript, image, slideshow, href

我有一个使用 javascript 的幻灯片放映，其中图像显示来自另一台服务器（远程服务器）。我必须显示来自另一台服务器的图像，问题是当我设置“Img”html标签的“src”属性时，它将我的服务器本地主机路径附加为“http:\mysitehost.com\myremoresite.com\image1.jpg”我的图像路径是“http:\myremotesite.com\image1.jpg”。谁能告诉我如何从图像路径中删除我的网站网址“mysitehost.com”。下面是我的javascript。

```
<script language="javascript" type="text/javascript">
var width = 283;
var height = 183;
var imgAr1 = new Array();
var rImg1 = new Array();
imgAr1[0] ='<%=url1%>'; // images comes from database with full imagepath like "http:remotesite.com\image.jpg"
imgAr1[1] = '<%= url1%>';
imgAr1[2] = '<%= url2%>';
imgAr1[3] = '<%= url3%>';
imgAr1[4] = '<%= url4%>';
imgAr1[5] = '<%= url5%>'; </script>

//to run slideshow

<script language="javascript" type="text/javascript">

//for(var j = 0; j < imgAr1.length; j++)
//{
//      rImg1[j] = new Image();
//        rImg1[j].src =  imgAr1[j];
//        alert(rImg1[j].src);
//}

document.onload = setting();

var slide;
function setting()
{
    slide = document.getElementById('pic');
    slide.setAttribute("src", imgAr1[0] );
    slide.setAttribute("width",width);
    slide.setAttribute("height",height);
    setTimeout("", 5000);
    slideshow();
}

//Image or picture slide show using java script
//slideshow function
var picture = 0;
function slideshow(){
    if(picture < imgAr1.length-1){
        picture=picture+1;
//      slide.src =  imgAr1[picture];
        slide.setAttribute("src", imgAr1[picture]);
        //alert(slide.src);
        setTimeout("slideshow()", 5000);
    }
    else
        {
            picture = -1;
            setTimeout("slideshow()", 5000);
        }
    }
</script>

//ASPX code
<div>
<img id="pic" border="0"  style="z-index: 100" alt="Property Photo" title="Property Photo"/>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-04T06:05:01.033

在 .src 属性中使用绝对路径时，应该没有问题。

确保格式化以 **http://**myremotesite.com/image.jpg 开头的图像 URL。

# .net - 您是否认为我们作为开发人员担心语言/工具而不是手头的问题？

> ID：261028
> 
> 赞同：0
> 
> 时间：2008-11-04T06:00:18.983
> 
> 标签：.net, api

我现在是一名 .NET 开发人员，来自[Foxpro](http://en.wikipedia.org/wiki/Visual_FoxPro) /VB6/COM 背景。

随着时间的推移，我认为我们已经变得过于担心语言/工具来完成这项工作。如果您看看 .NET 领域的开发人员会使用什么，就会发现这个列表一直在增长。

更重要的是，工具本身非常复杂，以至于您可以自己找到解决方案的日子已经一去不复返了。
我们所有人都有我们亲爱的朋友谷歌（把你最喜欢的搜索引擎放在这里）来拯救。

我们如何/何时可以期望提高抽象性，这样我们就不必过多担心工具数量的复杂性，而是专注于手头的问题？（看看 .NET 开发人员会使用的工具数量。是的，Stack Overflow 上有关于它的问题）。

我们当中有多少人可以真正解决某些问题而无需查找？我并不是说仰视是不好的。但前一段时间并非如此。

感谢您的想法。对此没有正确/错误的答案。我在这里鼓励聪明人的观点。

如果您认为这个问题有缺陷 - 请删除它:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-04T06:27:37.773

我认为这是一个很好的问题，但可能对过去有一种玫瑰色的看法。API 无法按照预期的方式工作等问题一直存在。互联网确实让找到遇到同样问题的其他人变得*更加*容易，但我认为找到比以前自己解决问题。

我*同意*，为了跟上步伐，您必须学习越来越多的技术。再一次，在某种程度上，“它曾经如此”，但在过去的几年里，在我看来，它已经成为一个更加严重的问题。例如，我不相信很多人有时间对所有内容甚至*主要内容都有“合理到良好”的理解。*.NET 外围 API（我指的是核心之外的 API：ASP.NET、WinForms、WPF、WCF、WF、ASP.NET MVC、LINQ to SQL、Entity Framework 等）。您要么必须专业化，要么以“及时”的方式学习，几乎总是使用不熟悉的 API。早在 .NET 1 和 2 的日子里，几乎没有足够的 API 可以很好地掌握所有内容。（我个人没有这方面的知识——我的 WinForms 和 ASP.NET 知识非常少——但其他人似乎有。）

说了这么多，即使可以，我也不会真的想把精灵放回瓶子里——像 LINQ 和 WPF 这样的东西太好了，不必过分担心它们需要多长时间来学习。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-04T06:49:08.667

新想法 -> 新工具 -> 新想法

CS的进化就是这么简单。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-04T07:31:15.257

项目需要人们专注于不同的领域，以分担知识负担。就像你有一个架构师一样，他在工具和框架方面比普通开发人员更有经验和专业。架构师可以提出解决方案的工具。然后你有程序员在架构师的帮助下创建大部分应用程序。

如果我作为一个孤独的开发人员在一个项目中，我可能不会从架构师那里得到太多帮助，我必须自己找出很多东西。但是如果我有架构师来帮助我，我可以专注于编写实际的应用程序功能。

如果我们称自己为开发人员并尝试学习一切可能是因为我们希望在生活中取得成功，那么我们仍然必须明白，不是每个人都应该成为架构师。我们也需要很多程序员。还需要分析师、设计师、首席开发人员和管理员。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-04T08:27:41.587

有时我会花更多的时间来解决框架中的问题，而我本可以编写自己的类，该类在比解决框架问题所用的时间更短的时间内完成完全相同的事情。

但我仍然认为框架是需要的，你无法自己学习和创建所有这些技术。把它比作翻新你的厨房，200 年前你会自己做这一切，100 年前你会打电话给木匠，今天你会打电话给木匠、水管工、电工，甚至可能是设计师。没有人能自己知道如何正确地完成所有这些事情。

# javascript - Eclipse 3.4 Ganymede Javascript 验证问题

> ID：261045
> 
> 赞同：12
> 
> 时间：2008-11-04T06:11:23.937
> 
> 标签：javascript, eclipse, validation, eclipse-3.4, ganymede

我刚刚第二次升级到 Eclipse 3.4，我认为它现在很好。第一次（就在它发布的时候）太麻烦了，我无法忍受（主要是 PDT 2.0 插件）；但现在似乎一切都解决了。

我的问题是 Javascript 验证器。如果我在项目的一个 JS 文件中定义了一个类，然后尝试在另一个文件中使用它，它会告诉我类型未定义。这真的很烦人，因为我的一些脚本到处都是红色的波浪线。

另一个问题是这段代码：

```
var m_dialogFrame = document.getElementById(m_dialogId); 
```

制作一个黄色的曲线，上面写着“类型不匹配：无法从 Element 转换为 ___m_dialogBody5”我可以通过添加来修复它

```
 /**
     * @type Element
     */ 
```

在它之前，但那也将是混乱的。

此外，两者：

```
new XMLHttpRequest(); 
```

和

```
new ActiveXObject("Microsoft.XMLHTTP"); 
```

得到红色花体字说“x 不能被解析为一个类型”

最后一个问题是：

如果（m_options.width！=“自动”）

获得红色波浪线，因为：“操作符 != 未定义参数类型 Number, String”

我该如何解决这些问题，或者只是废弃整个 Javascript 验证工具？顺便说一句：如果我能让它工作，它看起来棒极了。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-08-10T18:06:36.703

看起来这个问题是由于 Eclipse 的默认浏览器没有所需的库。

尝试以下步骤来添加所需的库：项目 -> 属性 -> JavaScript -> JavaScript 库 -> 库（选项卡） -> 添加运行时库 -> 选择“Internet Explorer 库”

这应该可以解决问题。它对我有用。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-04T12:40:34.807

不幸的是，您可能只需要放弃 JavaScript 验证。

以我的经验，与 Eclipse 3.4 捆绑在一起的 JavaScript 工具很难......好吧，完全*理解*JavaScript，因此会产生虚假的警告和错误。

例如，使用 an`Object`作为穷人的命名空间的常见做法会导致它完全丢失。这是尝试理解[此 JavaScript 文件时](http://code.google.com/p/js-forms/source/browse/trunk/time.js)[造成的混乱的屏幕截图](http://www.jonathanbuchanan.plus.com/images/eclipsejs.png)- 请注意无用的大纲视图和虚假（和不正确）的警告和错误（包括似乎不理解而不是返回）。`String.split``Array`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-02-02T20:53:58.283

这是非常痛苦的。为我解决问题的一种方法是从构建中排除所有 js 文件。属性-> javascript-> 库-> 源选项卡并排除所有给您带来问题的文件....这很可惜，因为我想要一些自动完成功能.... : (但需要完成项目才能工作....如果有人有解决方案，将不胜感激:)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-24T15:48:27.770

显然，要完全禁用验证，您还应该在 JavaScript -> 编辑器下禁用“键入时报告问题”。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-01T19:01:28.797

经过数小时的环顾，我发现了如何明确删除 JS 验证。

这意味着编辑您的 .project 文件，因此请先备份它以防万一。

*   关闭日食
*   打开你的 .project 文件
*   查找以下行：<nature>org.eclipse.wst.jsdt.core.jsNature</nature>
*   删除它
*   保存文件并启动 Eclipse

到处都不再有红色或黄色的花言巧语了……但不再有 js 验证。

如果有人知道如何在不编辑 .project 文件的情况下正确执行此操作，请分享。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-12-02T20:36:41.490

我发现旧的验证错误会一直存在于问题视图中并在文件中突出显示，直到您告诉它再次验证，所以在保存您的 JSP 验证首选项后，右键单击一个项目以验证其中的所有内容；这将使错误消失。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-02-07T22:59:45.827

user85835 的回答对我有所帮助，但我还需要遵循这两个额外的步骤。

首先，为了实际删除警告和错误并避免立即重新创建它们，请执行以下操作：

1.  在“清理...”窗口中完成清理后禁用自动立即重建。
2.  清洁项目

然后关闭 Eclipse 并按照 user85835 的描述删除 <nature>org.eclipse.wst.jsdt.core.jsNature</nature>。

但在重新启动 Eclipse 之前，还要执行此第二步。

1.  在您的 .project 文件中查找包含 <name>org.eclipse.wst.jsdt.core.javascriptValidator</name> 的 <buildCommand> XML 块。
2.  如果你发现这个也删除这个块。

然后保存您的 .project 文件并再次启动 Eclipse

根据需要恢复干净和重建设置。

这对我有用。

# optimization - Tomcat Web 服务器的最佳设置是什么？

> ID：261046
> 
> 赞同：2
> 
> 时间：2008-11-04T06:11:52.297
> 
> 标签：optimization, configuration, tomcat

我正在维护一个目前有大约 800 个并发用户的网站。商业计划书说这个数字将在一年内增加 10 倍。

这是我目前的配置：

```
<Connector port="8080" address="${jboss.bind.address}"
  maxThreads="500" maxHttpHeaderSize="8192"
  emptySessionPath="true" protocol="HTTP/1.1"
  enableLookups="false" redirectPort="8443" acceptCount="100"
  connectionTimeout="20000" disableUploadTimeout="true" />

<Connector port="8443" address="${jboss.bind.address}"
  protocol="HTTP/1.1" SSLEnabled="true"
  maxThreads="500" minSpareThreads="5" maxSpareThreads="25"
    scheme="https" secure="true" clientAuth="false"
    keystoreFile="${jboss.server.home.dir}/conf/ks.p12"
    keystoreType="PKCS12" connectionTimeout="20000"
    keystorePass="pass" sslProtocol="TLS" acceptCount="100" /> 
```

平均使用的线程数约为 400（对于每个 http/https）。但是峰值确实使用了 500 个线程。我想当我有 10 倍用户时我会遇到麻烦 :-)

*   我该如何调整这个？
*   我应该禁用http保持活动吗？如何配置保持活动超时？
*   什么值适合acceptCount / maxThreads？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-04T13:24:50.753

我认为将 tomcat 放在 Apache Http 服务器中是更健壮和更快的方法。[以下是取自http://wiki.apache.org/tomcat/FAQ/Connectors](http://wiki.apache.org/tomcat/FAQ/Connectors)的优缺点

为什么要将 Apache 与 Tomcat 集成？（或不）

将 Tomcat 与 Apache 集成的原因有很多。也不应该这样做是有原因的。不用说，每个人都会不同意这里的意见。有了 Tomcat 5 和 6 的性能，性能原因就变得更难证明了。因此，这里是在集成与不集成时要讨论的问题。

*   聚类。通过使用 Apache 作为前端，您可以让 Apache 充当您的内容到多个 Tomcat 实例的前门。如果您的一个 Tomcat 发生故障，Apache 会忽略它，您的系统管理员可以彻夜难眠。如果您使用硬件负载平衡器和 Tomcat 的集群功能，则可以忽略这一点。
*   集群/安全。您还可以使用 Apache 作为不同 Tomcat 的前门，用于不同的 URL 命名空间（/app1/、/app2/、/app3/ 或虚拟主机）。然后每个 Tomcat 都可以在受保护的区域中，从安全的角度来看，您只需要担心 Apache 服务器。从本质上讲，Apache 变成了一个智能代理服务器。
*   安全。这个话题可以左右任何一种方式。Java 有安全管理器，而 Apache 在安全方面有更大的思想份额和更多的技巧。我不会更详细地讨论这个，但让谷歌成为你的朋友。根据您的情况，一个可能比另一个更好。但也请记住，如果您使用 Tomcat 运行 Apache - 您需要保护两个系统，而不是一个。
*   附加组件。添加 CGI、perl、PHP 对 Apache 来说非常自然。对于Tomcat来说，它的速度更慢，更像是一个杂物。Apache还有数百个模块可以随意插入。Tomcat可以有这个能力，但是代码还没有写出来。
*   装饰师！在 Tomcat 前面使用 Apache，您可以执行 Tomcat 不支持或没有即时代码支持的任意数量的装饰器。例如，可以为 Tomcat 编写 mod_headers、mod_rewrite 和 mod_alias，但既然 Apache 做得这么好，为什么还要重新发明轮子呢？
*   **速度。Apache 在提供静态内容方面比 Tomcat 更快。但除非你有一个高流量的网站，否则这一点是没有用的。但在某些场景下，tomcat 可以比 apache 更快。因此，对您的网站进行基准测试。**
*   套接字处理/系统稳定性。Apache 对错误条件的套接字处理比 Tomcat 更好。主要原因是 Tomcat 必须通过需要跨平台的 JVM 执行其所有套接字处理。问题是套接字优化是特定于平台的考验。大多数情况下，java 代码都很好，但是当您还受到连接断开、无效数据包、来自无效 IP 的无效请求的轰炸时，Apache 在删除这些错误条件方面比基于 JVM 的程序做得更好。(YMMV)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-26T15:21:07.753

嘿，你应该看看

[http://tomcat.apache.org/tomcat-7.0-doc/jasper-howto.html#生产配置](http://tomcat.apache.org/tomcat-7.0-doc/jasper-howto.html#Production%20Configuration)

您可以设置一些与jsp编译相关的配置，它应该会使系统更快。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-04T16:34:34.100

我还会考虑调整底层 JVM，而不仅仅是 tomcat——查看[这个问题](https://stackoverflow.com/questions/202502/)以获得一些好的技巧，特别是关于垃圾收集和内存分配的技巧。根据我的经验，JVM 调优比 Tomcat 的内部调优要有效得多。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-04T06:57:27.290

您可以使用[JMeter](http://jakarta.apache.org/jmeter/)进行调整。我认为很大程度上取决于您的特定硬件设置。扩展站点的一种可能方法是添加机器。查看[Velocity Conference](http://en.oreilly.com/velocity2008/public/content/home) 和[High Scalability 网站](http://highscalability.com/)。

# css - 我在哪里可以获得一个好的免费 css 编辑器？

> ID：261047
> 
> 赞同：0
> 
> 时间：2008-11-04T06:12:26.523
> 
> 标签：css, django

我正在使用 Django 开发我的 Web 应用程序，似乎 CSS 是我可以格式化我的页面以使其看起来和感觉良好的唯一方法。我在哪里可以获得免费且优秀的 CSS 编辑器？

注意：在 Django 中还有另一种格式化表单的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-04T06:16:22.973

Eclipse的酷东西......

[http://aptana.com/studio](http://aptana.com/studio)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-04T07:01:59.530

这不是关于编辑，而是 CSS 调试的终极工具：

[Firebug](https://addons.mozilla.org/de/firefox/addon/1843)火狐插件

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-04T08:22:25.530

[TopStyle Lite](http://www.newsgator.com/individuals/topstyle/default.aspx)是一个不错的编辑器。它没有完整的 IDE 和调试器功能，但它有一些特点：

*   轻量级，加载速度快，就像一个文本编辑器
*   可预选的 CSS 支持级别，以查看旧版浏览器中的 CSS 支持
*   具有“IntelliSense”风格的关键字补全
*   您还可以在“检查器”窗格中单击样式规则，此外还有一个“css 选择器”-向导
*   可以从调色板中选择颜色

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-04T08:38:34.950

Lifehacker 新鲜出炉：[CSS 工具箱是网页设计师的杀手级文本编辑器](http://lifehacker.com/5073005/css-toolbox-is-a-killer-text-editor-for-web-designers)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-04T06:51:42.873

还有其他格式化表单的方法，但 CSS 是最好的方法。我会第二次推荐 Aptana，根据 Lifehacker [CSS Toolbox](http://lifehacker.com/5073005/css-toolbox-is-a-killer-text-editor-for-web-designers)的说法也相当不错。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-04T07:22:20.360

[我真的是Komodo Edit](http://www.activestate.com/Products/komodo_ide/komodo_edit.mhtml)的超级粉丝。

它是免费的，支持语法高亮并支持代码智能。这是我找到的最好的编辑器。

如果您需要加速处理大量代码，这肯定会挽救您的生命。

我非常喜欢它，我购买了完整的 IDE。

另外，它在每个平台上都可用。

# asp.net - 必填字段验证器未触发

> ID：261050
> 
> 赞同：10
> 
> 时间：2008-11-04T06:14:38.050
> 
> 标签：asp.net

我在使用具有 TextBox 和 RequiredFieldValidator 的标准 ASP.NET 页面时遇到问题。重现的步骤非常简单：

1.  在页面上放置一个文本框
2.  在页面上放置一个RequiredFieldValidator
3.  将 RequiredFieldValidator 指向 TextBox
4.  运行应用程序
5.  远离 TextBox 的标签，RequiredFieldValidator 不显示
6.  输入文本，然后删除文本，然后选项卡离开，RequiredFieldValidator 确实显示

在回发后，RequiredFieldValidator 在这两种情况下都可以正常工作，但是似乎客户端代码在输入文本框（然后删除）之前不会触发。

有没有人可以解决这个问题而无需自己破解 JavaScript？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-04T06:49:59.210

这种行为是否有可能是为了在用户输入之前抑制验证控件的出现而设计的？

一般来说，只要单击一个将 CausesValidation 设置为 true 的控件（如提交按钮），就会调用 Validate()。

在任何情况下，一个可怜的人都可以解决，您*可以*从 Load 事件处理程序调用页面 Validate() 函数。这将使事情更清楚地标记他们需要输入内容的快乐用户。例如

```
protected void Page_Load(object sender, EventArgs e)
{
    Validate();
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-04T10:28:32.950

对我之前的回答的跟进：

验证发生在 onchange 事件中，而不是 onblur 中。onchange 当焦点丢失并且控制值改变时触发。

为了在 onblur 事件中触发验证，我在 Page_Load() 中添加了以下代码：

```
ScriptManager.RegisterStartupScript(this, GetType(), "js" + myTextBox.ClientID,
  "ValidatorHookupEvent(document.getElementById(\"" + myTextBox.ClientID + 
  "\"), \"onblur\", \"ValidatorOnChange(event);\");", true); 
```

在 ASP.Net 2 中工作。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-04T09:11:06.367

您可能会在此处创建可用性问题。如果您在模糊上验证必填字段，用户将收到很多“必填字段”错误，因为他正在通过这些字段进行切换。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-04T06:36:55.600

您是否将 EnableClientScript 属性/属性设置为 true？你有文本框的默认值吗？如果是这样，您需要将 InitialValue 属性设置为该默认值

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-04T07:02:03.693

一个表单可以包含多个验证组。AFAIK 验证仅通过回发触发，激活相应验证器组的验证器。只有在回发之后，验证器才会添加其客户端 Javascript 验证代码。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-04T07:08:41.887

这就是验证器的工作方式，除非有验证输入或回发，否则它们不会触发。如果您希望它发生，您必须自己进行验证。

我不知道您需要的确切代码，但它与处理 onblur 和覆盖评估函数有关：

```
function blurred(sender) {
    var validator = sender.Validators[0]
    validator.evaluationfunction(validator);
} 
```

并在文本框中：

```
<asp:TextBox runat="server" ID="txt" onBlur="blurred(this)"></asp:TextBox> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-04-15T22:02:24.657

我遇到过同样的问题。发现您需要向脚本管理器添加一些框架脚本引用。确保您的脚本管理器中至少有这些带有“脚本”标签的脚本引用。

```
 <asp:ScriptManager ID="ScriptManager1" runat="server" ValidateRequestMode="Enabled" >
        <Scripts>
        <%--Framework Scripts--%>
        <%--<asp:ScriptReference Name="MsAjaxBundle"  />--%>
        <asp:ScriptReference Name="jquery" />
        <asp:ScriptReference Name="jquery.ui.combined" />
        <asp:ScriptReference Name="WebForms.js"  Path="~/Scripts/WebForms/WebForms.js" />
        <asp:ScriptReference Name="WebUIValidation.js"  Path="~/Scripts/WebForms/WebUIValidation.js" />
        <asp:ScriptReference Name="WebFormsBundle" />
        <%--Site Scripts--%>

    </Scripts>
    </asp:ScriptManager> 
```

当您创建 webforms 应用程序时，您也可以在 .Net 创建的默认母版页中找到这些内容。

# c# - 如何在单独的控制台中查看跟踪

> ID：261054
> 
> 赞同：2
> 
> 时间：2008-11-04T06:16:49.527
> 
> 标签：c#, debugging, trace

在 C# 中是否可以在单独的控制台中查看跟踪。例如，我有一个基于窗口的应用程序，其中有跟踪语句将当前执行的方法名称写入控制台。当我运行这个应用程序时，它应该会自动打开一个控制台并启动跟踪。这可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-04T06:19:59.550

如果您将窗口应用程序的项目类型设置为控制台，则在您运行它时会打开一个控制台窗口。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-04T07:51:53.423

您可以通过 P/Invoke 调用 Win32 AllocConsole API 创建控制台窗口。

[http://pinvoke.net/default.aspx/kernel32/AllocConsole.html](http://pinvoke.net/default.aspx/kernel32/AllocConsole.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-04T07:03:46.013

**我认为您正在寻找[TraceListener](http://msdn.microsoft.com/en-us/library/system.diagnostics.tracelistener.aspx)类。（[另一个链接](http://www.codeguru.com/columns/vb/article.php/c5611)）**

在 .NET 中，您使用 TraceListener 来侦听您自己的跟踪消息。然后您可以将它们打印在带有文本框或控制台窗口的表单中。

如果我没记错的话，也可以通过 app.config 配置监听器。这样您就可以调试已部署的应用程序。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-04T11:49:47.763

我推荐 Sysinternals 的 dbgview.exe。它允许您捕获跟踪输出并将其保存到文件（以及其他功能）。

您可以从[http://live.sysinternals.com获得它](http://live.sysinternals.com)

# linux - 自定义谷歌地图应用程序，其中地标在地图上每隔一段时间指定给它的位置移动 - 可能吗？

> ID：261057
> 
> 赞同：0
> 
> 时间：2008-11-04T06:18:21.707
> 
> 标签：linux, google-maps

我想知道我是否可以创建一个自定义的谷歌地图应用程序，在该应用程序上，随着纬度的变化，地标会相应地在地图上不断移动。如果是...我应该为这样的网络应用程序使用什么技术？这可以用 .NET 完成吗....如果可能的话，我将不得不在 RHEL5 操作系统上使用这个 webapp。

其次，我想知道谷歌地图数据是否免费提供？比如我是否可以下载不同缩放级别的特定区域的地图数据，然后制作自定义谷歌地图 webapp 来访问地图数据而不是来自谷歌数据中心，但从本地下载的数据？这可能吗？

谢谢。

**编辑1：**

好的，我从 code.google.com 获得了一些代码并测试了其中的一些......它真的很好......现在我想要两件事...... 1）一些地图 api 事件处理程序，我可以用来更新标记在a）特定时间间隔的位置，b）每当我的应用程序从其他来源获得一些输入以更改标记位置时..（这很可能是Linux上的一个exe，它将向Web应用程序提供输入）

2）我想ajaxise这一切，所以没有页面刷新..

有人可以给我我将要听的 api 的事件处理程序吗？...我真的搜索了 api 参考，但找不到可以完成我工作的：（

还有一些关于我应该如何处理所有东西的输入？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-04T06:55:15.160

1.  是的，只要 google maps api 允许您以任何方式修改地标位置。但是，谷歌地图上的实时数据使用有一些限制，所以请查看服务条款。

2.  Google Maps API 在浏览器中作为 javascript 代码工作，因此您必须编写自己的 javascript 函数才能从服务器获取新的坐标并移动/修改地标。您还可以学习 GWT 库，它允许您用“几乎是 java”语言编写代码并将其编译为 Javascript，或者使用 Adob​​e Flash，还有一个 flash API。

3.  该站点本身可以​​用您想要的任何语言进行编程，包括 .net（尽管可能很难使用 linux 为 .net 站点提供服务）。

4.  服务器后端可以用你想要的任何技术进行编程，只需在服务器端和浏览器端设置通用数据格式（JSON格式可能适合）。

5.  服务条款可在此处找到：[http](http://code.google.com/apis/maps/terms.html) ://code.google.com/apis/maps/terms.html 如果您使用免费的谷歌地图服务，您将无法下载任何地图或限制站点访问。

# perl - 如何在不使用子窗口的情况下调用另一个 Tk 窗口？

> ID：261058
> 
> 赞同：2
> 
> 时间：2008-11-04T06:18:49.490
> 
> 标签：perl, perltk

我正在制作 GUI（登录窗口）。当密码正确时，登录窗口必须调用其他窗口。PerlTk 中有没有办法调用另一个窗口而不是使用子窗口？

```
use strict;

use Tk;

my $mw = MainWindow->new;
$mw->geometry("300x150");
$mw->configure(-background=>'gray',-foreground=>'red');
$mw->title("PLEASE LOGIN");

my $main_frame=$mw->Frame(
    -background=>"gray",-relief=>"ridge",)->pack(-side=>'top',-fill=>'x');
my $left_frame=$main_frame->Frame(
    -background=>"gray")->pack(-side=>'left',-fill=>'x');
my $bottom_frame1=$mw->Frame(
    -background=>"gray")->pack(-side=>'bottom',-fill=>'x');
my $right_frame1=$mw->Frame(
    -background=>"gray")->pack(-side=>'left',-fill=>'x');

my $button=$bottom_frame1->Button(-text=>"OK",-command=>\&push_button);
$button->pack(-side=>'left');
my $cancel=$bottom_frame1->Button(-text=>"CANCEL",-command=>sub{$mw->destroy});
$cancel->pack(-side=>'right');
my $entry2=$mw->Entry(-width=>20,-relief=>"ridge")->place(-x=>100,-y=>75);

sub push_button{
   ...
   }

my $mw=MainWindow->new;
$mw->geometry("900x690"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-15T22:17:00.057

您只是想要单独的 MainWindows 吗？构建每个 MainWindow 后，您就可以构建各种小部件来引用正确的变量。这是一个简短的程序，在一个 MainWindow 中有一个按钮，在另一个 MainWindow 中有一个按钮按下计数器：

```
#!/usr/local/bin/perl

使用 Tk；

# 另一个窗口作为自己的MainWindow
# 显示按钮的次数
# 在另一个窗口被按下
我的 $other_window = MainWindow->new;
$other_window->title("其他窗口");
我的 $other_frame = $other_window->Frame->pack(
    -fill => '两者'
    );

我的 $other_label = $other_frame->标签(
    -text => '按下 0 次',
    )->包装(
        -side => '顶部',
        -填充=>'x'，
    );

# 登录窗口作为自己的MainWindow
我的 $login_window = MainWindow->new;
$login_window->title("登录窗口");
我的 $login_frame = $login_window->Frame->pack(
    -fill => '两者'
    );

我的 $login_label = $login_frame->标签（
    -text => '按下按钮',
    )->包装(
        -side => '顶部',
        -填充=>'x'，
    );

我的 $pressed = 0;
我的 $login_button = $login_frame->Button(
    -text => '按钮',
    -command => sub { # 引用 $other_label
        $按下++；
        $other_label->configure(-text => "按下 $pressed 次");
        },
    )->包装(
        -side => '顶部',
        -fill => '两者'，
    );

主循环；

```

# bit-manipulation - 在 Web 开发过程中何时使用位运算符？

> ID：261062
> 
> 赞同：42
> 
> 时间：2008-11-04T06:21:45.460
> 
> 标签：bit-manipulation

虽然我掌握了位运算符的概念，但我不能说我在 Web 开发过程中遇到了许多不得不求助于位运算符的用例。

*   您使用按位运算符吗？
*   你为什么使用它们？
*   有哪些示例用例？

请记住，此问题专门用于在 Web 语言中使用位运算符。

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2008-11-04T08:16:36.210

我将在这里更加明确，因为我认为按位掩码是一个很棒的工具，应该在任何开发人员带中。我将尝试扩展上面的答案。首先，一个使用整数来维护状态标志的例子（常见用法）：

```
// These are my masks
private static final int MASK_DID_HOMEWORK  = 0x0001;
private static final int MASK_ATE_DINNER    = 0x0002;
private static final int MASK_SLEPT_WELL    = 0x0004; 

// This is my current state
private int m_nCurState; 
```

为了***设置***我的状态，我使用按位 OR 运算符：

```
// Set state for'ate dinner' and 'slept well' to 'on'
m_nCurState = m_nCurState | (MASK_ATE_DINNER | MASK_SLEPT_WELL); 
```

请注意我如何“或”我当前的状态与我想要“打开”的状态。谁知道我现在的状态是什么，我不想把它吹走。

要***取消设置***我的状态，我将按位 AND 运算符与补码运算符一起使用：

```
// Turn off the 'ate dinner' flag
m_nCurState = (m_nCurState & ~MASK_ATE_DINNER); 
```

要***检查***我当前的状态，我使用 AND 运算符：

```
// Check if I did my homework
if (0 != (m_nCurState & MASK_DID_HOMEWORK)) {
    // yep
} else { 
    // nope...
} 
```

为什么我觉得这很有趣？假设我正在设计一个设置我的状态的界面。我可以编写一个接受三个布尔值的方法：

```
void setState( boolean bDidHomework, boolean bAteDinner, boolean bSleptWell); 
```

或者，我可以使用一个数字来表示所有三种状态并传递一个值：

```
void setState( int nStateBits); 
```

如果您选择第二种模式，当您决定添加另一个状态时会非常高兴——您不必破坏界面的现有实现。

我的两分钱。谢谢。

* * *

## 回答 #2

> 赞同：53
> 
> 时间：2008-11-04T06:31:27.670

我对位运算符的主要用途可能与任何地方相关——代表一组标志。例如，您可能在数据库中有一个整数，表示用户的一组安全权限，而在您的 Web 应用程序中，您必须在继续之前检查这些权限。

那些往往只需要`&`和`|`- 例如

```
if ((permissions & Permission.CreateUser) != 0)
{
    ...
} 
```

或者

```
Permission requiredPermission = Permission.CreateUser
                                | Permission.ChangePassword; 
```

*根据我的经验，位移*运算符在“商业”应用程序中的用处不大。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-11-04T13:42:03.823

对于 Java 程序员，异或位运算符 (^) 提供了一种有用的方法来编写两个布尔值之间的异或测试。例子：

```
boolean isFoo = ...
boolean isBar = ...

if (isFoo ^ isBar) {
    // Either isFoo is true or isBar is true, but not both. 
```

注意：这里没有实际的位操作，但它是使用 xor 位运算符（在 Web 层或其他任何地方）的有用方法。

（这可能适用于 C#，因为它与 Java 非常相似。但不确定。）

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-11-04T06:47:00.153

除了标志之外，没有太多理由在脚本语言中使用位操作。但是，一旦您深入研究堆栈的较低级别，位操作就变得越来越重要。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2013-11-14T02:30:56.940

这个问题已经回答了，但我想分享我的经验`&`。

不久前，当我进行 ASP.NET C# 练习时，我曾使用`&`过验证注册表单，在该练习中，短路`&&`不会轻易达到预期的效果。

我想要做的是突出显示表单中的所有无效字段并在每个无效字段旁边显示错误消息标签，并取消突出显示所有有效字段并从中删除错误消息。

我使用的代码是这样的：

```
protected void btnSubmitClicked(...) {
  username = txtUsername.Text;
  email = txtEmail.Text;
  pass = txtPassword.Text;
  if (isUsernameValid(username) & isEmailValid(email) & isPasswordValid(pass)) {
    // form is valid
  } else {
    // form is invalid
  }
  ...
}

private bool isPasswordValid(string password) {
  bool valid = true;
  string msg = "";
  if (password.length < MIN_PASSWORD_SIZE) {
    valid = false;
    msg = "Password must be at least " + MIN_PASSWORD_SIZE + " long.";
  }

  highlightField(txtPassword, lblPassword, valid, msg);
  return valid;
}

private void highlightField(WebControl field, Label label, string valid, string msg) {
  if (isValid) {
    // de-highlight
    field.BorderColor = VALID_FIELD_COLOR;
  } else {
    // highlight the text field and focus on it
    field.BorderColor = INVALID_FIELD_COLOR;
    field.Focus();
  }

  label.Text = msg;
}

// and other similar functions for username and email 
```

如果我使用`&&`而不是`&`，方法中的 if 语句`btnSubmitClicked`将仅突出显示第一个无效字段，之后的所有其他无效字段将不会突出显示，并且其错误消息不会显示，因为短路`&&`后会停止检查条件遇到错误。

可能有更好的方法来实现相同的目标，但我`&`当时发现很有用。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-04T06:35:05.247

通常，您不需要关心位级别的操作。您可以考虑字节、整数、双精度和其他更高级别的数据类型。但是有时您希望能够达到单个位的水平。

位运算符最常见的使用案例之一是[标志](http://www.shawnolson.net/a/601/setting-bits-and-flags-in-php.html)（php 示例）。[位运算符](http://www.php.net/language.operators.bitwise)也用于二进制文件 IO 操作。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-04T06:32:40.710

我经常使用它们，但从不在我可以避免它们的地方使用。我最常使用它们的是以下两种情况。

1.  在不通过安全连接的情况下使用 JavaScript 加密来自客户端的表单数据，它比发送纯文本要好得多。
2.  动态生成的来自 PHP 的流式文件结构（通常是一些二进制文件类型）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-04T06:43:23.887

在题外话方面，在高级语言中，尤其是在解析语言（如 PHP）中，按位运算比普通算术要慢很多^([需要引用] 。)因此，虽然从性能的角度来看 Jon 的权限检查可能没问题，但它在 Web 域中并不是很“原生”。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-17T20:09:14.987

我唯一一次在授权访问之外使用它们是我为解析器所做的一个项目，该解析器将颜色 ID 分配给整数

IE

```
$color_red= 1;
$color_blue = 2;
$color_yellow = 8;

$color_purple = 3;
$color_orange = 9;
$color_green  = 10; 
```

然后我得到了一个财产

```
$can_collect_200_dollars = 10; 
```

然后使用按位比较给定的颜色与属性

```
if($given_color & $can_collect_200_dollars)
{
    $yay_i_got_200_dollars = true;
}else{
    $bummer_i_am_going_to_jail = true;
} 
```

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2009-11-11T16:56:08.823

我认为如果使用得当，按位运算符非常强大。

假设您有一个“在线商店”。而且您的某些商品属于不止一个类别。

要么你必须创建一个多对多关系。或者您可以为您的类别提供一个额外的二进制 ID，然后在您的产品中存储类别 ID 的按位组合

我想在几行中我无法详细解释。对不起

# sql - SQL 转换

> ID：261064
> 
> 赞同：0
> 
> 时间：2008-11-04T06:22:43.617
> 
> 标签：sql, oracle, sybase

我想将项目从 sybase 移植到 oracle。我需要移植表脚本（大约 30 个）和元数据表（100 行 2/3 表）中的一些数据。这项工作的最佳工具是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-04T08:36:13.863

对于这么小的体积，您最好编写脚本而不是使用任何工具。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T08:20:22.957

谢谢大家...我手动进行了转换，但马特·鲍尔是对的。Oracle SQl developer 是一个很好的工具。我后来想通了。我安装了 1.5.1 版。

但诀窍是更新扩展。默认情况下，它仅附带 Access SQL to Oracle。以下是步骤。

1.  转到工具>首选项>Web浏览器和代理设置您的代理
2.  转到工具>首选项>扩展单击检查更新您应该在安装后获得 Sybase 驱动程序和翻译器（需要 oracle 网站 ID 和密码）重新启动
3.  转到迁移>翻译临时编辑器应该有 sybase TSql 下拉。复制粘贴您的脚本并享受...

插入脚本，您必须自己添加 Bla_Sequence.nextval。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-04T12:14:40.973

您确实有 sybase 中表的脚本，对吗？正如 Dheer 所说，通过手动编辑进行转换应该是可行的。

你指的是什么元数据？是您生成的元数据还是 sybase 由于您的 DDL 脚本而生成的元数据？

如果它是您生成的元数据，您可以像迁移任何其他数据一样迁移它。

如果它是系统生成的元数据，最好不要迁移它，而是让你的使用适应 Oracle 的元数据，存储在通常称为 Oracle 数据字典的系统表中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-04T13:06:58.183

我相信oracle sqldeveloper会做到这一点。

请参阅[http://www.oracle.com/technology/tech/migration/workbench/index_sqldev_omwb.html](http://www.oracle.com/technology/tech/migration/workbench/index_sqldev_omwb.html)

# database - oracle 数据库发生变更时的通知

> ID：261068
> 
> 赞同：2
> 
> 时间：2008-11-04T06:27:50.143
> 
> 标签：database, oracle, alter-table

我们有一个很多人都必须访问的数据库。我正在寻找一种方法，使我们能够在此数据库上发生“更改”时获得通知，以便其他方可以知道它。请指教。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-04T07:33:23.320

您可以创建触发器来捕获许多数据库事件...

[http://www.psoug.org/reference/ddl_trigger.html](http://www.psoug.org/reference/ddl_trigger.html)

...包括架构上的 ALTER 之前/之后。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-04T07:19:22.847

许多人不应该对生产数据库拥有 ALTER 权限 - 很少有人应该对生产数据库拥有 ALTER 权限。实际上，您可能也不应该让很多人有权在测试数据库中进行更改。

您可以考虑审计是否是正确的解决方案 - 在某些 DBMS 中，这将是检测更改的一种方式，但警报会更难（除了“grepping the audit log”主题的一些变化）。Oracle中可能还有其他方式。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-04T22:25:30.867

关于你上面的评论：

> 它是开发数据库，​​所以我们需要很多人来访问它。– whizmaven（8 小时前）

@Jonathan Leffler 是正确的：很多人可能可以访问它，但是拥有 DDL 权限（CREATE、DROP、ALTER 等）的人应该非常有限。

更好的解决方案是在本地完成任何此类更改（在本地托管的数据库上，或作为共享测试数据库上的不同用户帐户）。只有在验证更改后，才应将它们推广到完全共享的环境中。并且应该以更正式的方式处理推出/变更控制过程。

至少，在推出时，应使用电子邮件通知更改和这些更改的后果（需要新的测试、更新等）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-05T05:48:15.603

似乎110g考虑在内：

[http://sysdba.wordpress.com/2007/10/16/ddd-logging-in-the-alert-log-in-11g/](http://sysdba.wordpress.com/2007/10/16/ddd-logging-in-the-alert-log-in-11g/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-04T22:16:18.810

改变什么？

ALTER SESSION 可能是一个非常常见的命令（尤其是 ALTER SESSION SET NLS_DATE_FORMAT 或 CURRENT_SCHEMA）。

更常见的是，您可能想要跟踪 ALTER schema_object，可能是 ALTER SYSTEM 和 ALTER DATABASE

# java - 可调整大小的 Java 组件

> ID：261080
> 
> 赞同：1
> 
> 时间：2008-11-04T06:35:43.857
> 
> 标签：java, resize, components

我想要一个 Java 组件，它在组件的右下角有一个调整大小的图标，这样当我拖动该图标时，组件会自动调整大小。

通过调整图标大小，我的意思是：

![在 Google Talk 中调整图标大小](https://lh5.ggpht.com/_7dfPdX2BP6o/SQ_sPvvHpTI/AAAAAAAAAKU/vRWKb_pLVvc/s144/resize%20icon.jpg)

上图包含 Google Talk Messenger 主窗口中的调整大小图标。是否有任何提供此功能的 Java 组件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-04T07:05:30.380

您将在本文中了解如何添加一个看起来像您所指的调整大小图标的图标。

![像素推送](https://i.stack.imgur.com/uyYo4.gif) [像素推送](http://today.java.net/pub/a/today/2005/06/07/pixelpushing.html)

![Google Talk 样式表](https://i.stack.imgur.com/shuJJ.gif)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-04T07:06:32.623

JStatusBar ?

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-04T18:43:44.500

嗯，把图像放在那里并不难......调整大小是。你会想要使用（一旦你有某种按钮）这样的代码：

```
private void buttonMousePressed(java.awt.event.MouseEvent evt) {
        sx = evt.getX();
        sy = evt.getY();
}

private void buttonMouseDragged(java.awt.event.MouseEvent evt) {
        if(!evt.isMetaDown()){
                Point p = getLocation();

                locX = p.x + evt.getX()-sx;
                locY = p.y + evt.getY()-sy;
                setLocation(locX, locY);
        }
} 
```

...除了您想要使用 setBounds 或 setSize 之类的东西而不是 Setlocation...而且您必须稍微修改代码。我有的是拖着它，但原理是一样的。

# javascript - 有没有办法确定浏览器窗口已关闭？

> ID：261083
> 
> 赞同：3
> 
> 时间：2008-11-04T06:37:05.913
> 
> 标签：javascript, dom-events

如何识别浏览器的关闭按钮被点击了？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-04T06:59:44.823

在[JavaScript Event Reference](http://www.w3schools.com/jsref/jsref_events.asp)中，最接近的匹配似乎是 OnUnload 事件。但是，这也会使导航远离页面（因此，如果用户实际单击链接，您不希望函数运行。）

不能保证服务器会收到浏览器窗口关闭的消息。例如，涉及创建小弹出窗口的旧方法将被大多数现代浏览器阻止。使用 AJAX 可能有效，但浏览器窗口可能会在尝试连接之前关闭。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-04T06:58:47.320

这会：

```
$(window).unload( function () { alert("Bye now!"); } ); 
```

帮你 ？

虽然它在 jQuery 中。

不过，您应该检查[Demoli 提供的链接](https://stackoverflow.com/questions/181189/to-detect-if-the-user-is-closing-the-ie-browser-apart-from-onunload-event-as-it)，它包含有关此特定方法（及其缺点）的更多信息。

编辑：添加链接。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-04T06:55:03.553

浏览器没有关闭事件，因此您无法真正判断用户何时关闭浏览器，[此线程中有一些潜在的解决方法](https://stackoverflow.com/questions/181189/to-detect-if-the-user-is-closing-the-ie-browser-apart-from-onunload-event-as-it)

如果您让我们知道您要达到的目标，则可能有另一种方法

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-04T16:07:24.140

你应该使用`onbeforeunload`，而不是`onunload`。IE 7（可能还有其他浏览器）在触发事件时并不是 100% 可靠的`unload`，但它似乎总是触发`beforeunload`事件。

例如：

```
window.onbeforeunload=function(){} 
```

或者，如果您使用的是prototype.js：

```
Event.observe(window, 'beforeunload', function(){}); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-04T20:06:55.763

这是一个黑客，但它似乎对我有用。它也可能是特定于 IE 的。我为仅 IE 环境编写代码。

```
<body onunload="if(self.screenTop>9000){unloadFunction();}"> 
```

编辑添加我的 unloadFunction 会打开一个弹出窗口，该窗口会终止用户的会话。您无法在本身关闭的页面上执行任何操作。因为已经关门了！;)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-04T07:51:35.280

您可以设置一个 ajax 调用，每隔几秒到几分钟定期轮询您的服务器（取决于您想要的时间精度）并跟踪服务器端的最后一次命中时间。不完全准确（例如，网络问题可能导致误报），但根据您的要求可能是一种选择。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-04T07:00:12.433

当用户离开页面（卸载？）时通常会触发一个事件 - 这可能是特定于浏览器的。

还有一个属性，window.closed，它是在其关联的窗口关闭后在窗口对象上设置的。这通常在您引用弹出窗口时使用。

我不确定 unload 事件是否会在设置“关闭”属性之前或之后触发 - 您必须进行试验。

您可能无法区分关闭的窗口和已转到另一个站点的浏览器。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-04T17:57:14.417

我同意northsouthwhat，但请注意，onbeforeunload 可能并非在您可能想要使用它的所有浏览器中都受支持。

# c# - 泛型类的泛型父级

> ID：261086
> 
> 赞同：6
> 
> 时间：2008-11-04T06:38:28.750
> 
> 标签：c#, generics

我为此使用了一个虚构的例子。说，我有一个像这样的 Widget 类：

```
abstract class Widget
{
Widget parent;
} 
```

现在，我的其他类将派生自这个 Widget 类，但假设我想在定义派生类型时在类中放置一些约束，以便只有特定“类型”的小部件可以成为特定类型 Widget 的父级。

例如，我从 Widget 类派生了另外两个小部件，WidgetParent 和 WidgetChild。在定义子类的时候，我想把父类的类型定义为WidgetParent，这样就不用每次使用都需要对父类进行类型转换。

确切地说，我想做的是：

```
// This does not works!
class Widget<PType>: where PType: Widget
{
    PType parent;
}

class WidgetParent<Widget>
{
    public void Slap();
}

class WidgetChild<WidgetParent>
{
} 
```

这样当我想访问 WidgetChild 的父级时，而不是这样使用它：

```
WidgetParent wp = wc.parent as WidgetParent;
if(wp != null)
{
    wp.Slap();
}
else throw FakeParentException(); 
```

我想以这种方式使用它（如果我可以使用泛型）：

```
wc.parent.Slap(); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-04T07:23:28.987

您应该能够通过仍然拥有非泛型类`Widget`并`Widget<T>`从中派生来使用您拥有的代码：

```
public abstract class Widget
{
}

public abstract class Widget<T> : Widget where T : Widget
{
} 
```

然后，您需要弄清楚什么属于泛型类，什么属于非泛型......根据经验，这可能是一个棘手的平衡行为。期望来回相当多！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-04T08:20:01.697

使用接口：

```
interface IContainerWidget { }

class Widget
{
    private IContainerWidget Container;
}

class ContainerWidget : Widget, IContainerWidget
{
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-04T06:54:55.173

我认为没有一种语言机制可以让你这样做。

但是，您可能希望使用**[工厂模式](http://en.wikipedia.org/wiki/Factory_method_pattern)将类的构造与类本身分开**。

说，做一个 WidgetFactory 类

```
class WidgetFactory
{
    Widget CreateWidget()
    {
        return new Widget();
    }
} 
```

对于儿童课程，您也可以制作他们的工厂。比如说，一个 WidgetParentFactory 或 WidgetChildFactory 或者你可以创建一个通用工厂：

```
class WidgetFactory<T> where T : Widget
{
    T CreateWidget()
    {
        return new T();
    }
} 
```

然后通过 CreateWidget() 方法，您可以控制类实例化，从而无法创建无效的子类型。

```
class WidgetFactory<T> where T : Widget
{
    T CreateWidget()
    {
        if (/*check the type T inheritance here*/)
            return new T();
        else
            throw new Exception("Invalid inheritance");
    }
} 
```

这应该为您解决问题。

ps 你愿意详细说明你*为什么*要这样做吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-04T07:36:48.290

您似乎混淆了类型参数和继承。这应该有效：

```
class Widget<PType> where PType :new()
{
    public  PType parent = new PType();
}

class ParentType {}

class WidgetParent : Widget<ParentType> 
{    
    public void Slap() {Console.WriteLine("Slap"); }
}

class WidgetChild : Widget<WidgetParent>
{
}
public static void RunSnippet()
{
    WidgetChild wc = new WidgetChild();
    wc.parent.Slap();
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-06T19:16:53.787

这是我组织这个的尝试。

```
public interface IWidget
{
    void Behave();
    IWidget Parent { get; }
}

public class AWidget : IWidget
{
    IWidget IWidget.Parent { get { return this.Parent; } }
    void IWidget.Behave() { this.Slap(); }

    public BWidget Parent { get; set; }
    public void Slap() { Console.WriteLine("AWidget is slapped!"); }
}

public class BWidget : IWidget
{
    IWidget IWidget.Parent { get { return this.Parent; } }
    void IWidget.Behave() { this.Pay(); }

    public AWidget Parent { get; set; }
    public void Pay() { Console.WriteLine("BWidget is paid!"); }
}

public class WidgetTester
{
    public void AWidgetTestThroughIWidget()
    {
        IWidget myWidget = new AWidget() { Parent = new BWidget() };
        myWidget.Behave();
        myWidget.Parent.Behave();
    }
    public void AWidgetTest()
    {
        AWidget myWidget = new AWidget() { Parent = new BWidget() };
        myWidget.Slap();
        myWidget.Parent.Pay();
    }

    public void BWidgetTestThroughIWidget()
    {
        IWidget myOtherWidget = new BWidget() { Parent = new AWidget() };
        myOtherWidget.Behave();
        myOtherWidget.Parent.Behave();
    }

    public void BWidgetTest()
    {
        BWidget myOtherWidget = new BWidget() { Parent = new AWidget() };
        myOtherWidget.Pay();
        myOtherWidget.Parent.Slap();
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-09T14:55:06.910

我有一个类似的问题并对其进行了调整以适应这个（希望如此）

**主要代码**

```
public class Parent<T>
    where T : Child<T>
{
    public Parent() { }

    public T Get()
    {
        return Activator.CreateInstance(typeof(T), new object[] { this }) as T;
    }
}

public class Child<T>
    where T : Child<T>
{
    Parent<T> _parent;

    public Parent<T> Parent { get { return _parent; } }

    public Child(Parent<T> parent)
    {
        _parent = parent;
    }
}

public class ItemCollection : Parent<Item>
{

}

public class Item : Child<Item>
{
    public Item(Parent<Item> parent)
        : base(parent)
    {
    }
} 
```

**例子 ：**

```
ItemCollection col = new ItemCollection();
Item item = col.Get();
item.Parent.Slap(); 
```

# c# - 控制 CPU 利用率

> ID：261089
> 
> 赞同：4
> 
> 时间：2008-11-04T06:39:51.820
> 
> 标签：c#, windows

在运行时如何控制 CPU 利用率？

轮询 CPU 负载并插入睡眠？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-04T07:05:51.753

我会推荐操作系统功能。在 Windows 上有性能计数器和 WinAPI 函数。

这是使用[BCL 团队博客中的](http://blogs.msdn.com/bclteam/archive/2006/06/06/619284.aspx)**性能计数器**的示例：

```
foreach (Process proc in Process.GetProcesses()) {
    using (PerformanceCounter pcProcess = new PerformanceCounter("Process", "% Processor Time", proc.ProcessName)) {
        pcProcess.NextValue();
        System.Threading.Thread.Sleep(1000);
        Console.WriteLine("Process:{0} CPU% {1}", proc.ProcessName, pcProcess.NextValue());   
    }
} 
```

此代码与[CodeProject](http://www.codeproject.com/KB/cs/perfgrid.aspx)**中的 WMI**相同：

```
public string GetCPU()
{
    decimal PercentProcessorTime=0;
    mObject_CPU.Get();

    ulong  u_newCPU   = 
      (ulong)mObject_CPU.Properties["PercentProcessorTime"].Value;
    ulong u_newNano   = 
      (ulong)mObject_CPU.Properties["TimeStamp_Sys100NS"].Value;
    decimal d_newCPU  = Convert.ToDecimal(u_newCPU);
    decimal d_newNano = Convert.ToDecimal(u_newNano);
    decimal d_oldCPU  = Convert.ToDecimal(u_oldCPU);
    decimal d_oldNano = Convert.ToDecimal(u_oldNano);

    // Thanks to MSDN for giving me this formula !

    PercentProcessorTime = 
      (1 - ((d_newCPU-d_oldCPU)/(d_newNano - d_oldNano)))*100m;

    // Save the values for the next run

    u_oldCPU          = u_newCPU;
    u_oldNano         = u_newNano;

    return PercentProcessorTime.ToString("N",nfi);;
} 
```

因此，如果处理器利用率很高，您可以查询这些操作系统提供商（或其他操作系统提供商）并让您的线程休眠。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-04T07:30:20.627

最简单的方法是修改主循环以等待输入（经典的事件驱动模型）或定期休眠一小段时间。

如果让应用程序进入睡眠状态，我只会使用非常短的超时时间，在 10-100 毫秒范围内的某个地方，因为任何更多的用户输入都会被延迟，并且任何更少的时间都会在切换应用程序时涉及更多的操作系统级开销。

# language-agnostic - GPRS通讯单片机

> ID：261092
> 
> 赞同：2
> 
> 时间：2008-11-04T06:43:50.203
> 
> 标签：language-agnostic, mobile, embedded, hardware

[GPRS](http://en.wikipedia.org/wiki/General_Packet_Radio_Service)通信所需的全部[AT指令是什么？](http://en.wikipedia.org/wiki/Hayes_command_set)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-04T10:40:47.917

正如亚当所说，特定的 AT 命令集取决于您的调制解调器。西门子 GSM 调制解调器支持似乎相当常见的子集 - 有一个手册位于：

[http://www.automation.siemens.com/siplus/ftp/techndoku/TC65_atc_v02000.pdf](http://www.automation.siemens.com/siplus/ftp/techndoku/TC65_atc_v02000.pdf)

其中详细记录了所有支持的 GSM 命令。

（如果链接断开，请谷歌“TC65 AT 命令”）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-04T07:22:28.443

一个更具体的答案，如果您使用的是 MultiTech Multimodem GPRS（或类似的）和 Tmobile 的互联网服务（通常与笔记本电脑一起使用的较高层之一）。以“M”开头的大写名称是我使用的调制解调器控制状态机中的状态名称。我收集的数据是简单的 GPS 字符串，它们由我的服务器上的 PHP 脚本存储以显示在这里：[http](http://www.ubasics.com/wmr/) ://www.ubasics.com/wmr/ 。一个非常基本的跟踪/遥测应用程序。

重置调制解调器：

```
MRESET:
ATZ 
```

连接到提供商的网络：

```
MPROVIDERINIT:
at+cgdcont=1,"IP","internet3.voicestream.com",,0,0

MIPINIT:
at+wopen=1

MPPPINIT:
at#pppmode=1

MCHECKPIN:
at+cpin?

MGSMREGISTER:
at+creg=1 
```

连接到提供商的 GPRS 网络：

```
MGPRSREGISTER:
at+cgreg=1

MGPRSATTACH:
at+cgatt=1

MGPRSMODE:
at#gprsmode=1 
```

连接到提供商的互联网 PPP 服务器：

```
MSERVERINIT:
AT#APNSERV="internet3.voicestream.com"

MUSERNAME:
AT#APNUN=""

MPASSWORD:
AT#APNPW=""

MSIGNAL:
AT+CSQ

MSTARTPPP:
at#connectionstart 
```

将调制解调器的内部堆栈附加到 HTTP 端口：

```
MTCPSERVER:
AT#TCPSERV="www.ubasics.com"

MTCPPORT:
AT#TCPPORT=80

MOPENSOCKET:
at#otcp 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T13:25:55.160

我正在使用 SIM340 GSM 调制解调器和兼容 Ramtron 8051 的微控制器。按照我自己的顺序使用该配置连接到远程服务器：

ATE0 // echo off，可选，更容易解析 SIM340 回复；如果您使用的是终端程序，您不想停用回声。

AT+CNMI=0,0,0,0,0 //收到新短信时不发消息；再次，如果我不必检查不需要的回复，我的生活会更轻松。

AT+CMGF=1 //短信格式：文本

AT+CIPFLP=0 // 不固定本地端口（根据 SIM 应用说明，这可以更快地重新连接到服务器）

AT+CIPMODE=1 // 透明 TCP 模式：写入 GSM 模块的所有内容都通过 TCP 连接发送

AT+CIPCSGP=1,"gprs.personal.com","gprs","adgj" //APN设置（APN，用户名，密码）

AT+CGDCONT=1,"IP","gprs.personal.com" //连接类型

AT+CIPCCFG=3,2,256,1

AT+CIPSTART="TCP","xxx.xxx.xxx.xxx","82" // 连接 ip 地址为 xxx.xxx.xxx.xxx 的服务器，端口为 82

发出最后一条命令后，如果连接尝试成功，GSM 模块将回复“CONNECT OK”。从那一刻起，发送到 GSM UART 的每个字节都将发送到服务器。要返回命令模式，您可以发送字符串“+++”（三个加号），它们之间没有延迟，并且在至少 0.5 秒之前或之后没有字节。

如果与服务器的连接由于某种原因断开，您可以使用以下方法重新连接：

AT+CIPSHUT //关闭 TCP 连接

AT+CIPSTART="TCP","xxx.xxx.xxx.xxx","82" //重新发出启动TCP连接的命令

此致。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-04T07:01:21.700

这在很大程度上取决于：

*   调制解调器
*   您计划使用多少调制解调器堆栈
*   您使用的运营商

如果您在计算机上使用它，并且您有调制解调器配置文件（特定于调制解调器）和运营商配置或设置，那么您可以拦截串行命令并找出答案。

否则，请尝试访问调制解调器制造商的网站并查找调制解调器的 AT 命令指南。

获得调制解调器命令后，设置连接需要几个步骤，包括启动 GSM 连接，然后与服务器建立 GPRS 会话，然后与运营商的 ISP 设备建立 PPP 会话。您将需要来自运营商的几条信息，AT 命令集将引导您找到这些信息。

您的调制解调器也可能有一个内置的 TCP/IP 堆栈，在这种情况下，您也有 AT 命令来启动 PPP 会话，然后是与 Internet 服务器的 TCP 连接。

如果您发布调制解调器/运营商/目标/等，您可能会获得更具体的帮助。

-亚当

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-12T17:48:11.107

大部分手机专用的AT指令都在[27.007](http://www.3gpp.org/ftp/Specs/html-info/27007.htm)中标准化和规定（短信相关指令在[27.005](http://www.3gpp.org/ftp/Specs/html-info/27005.htm)中）。对于索尼爱立信手机，有一份[开发人员指南 - AT 命令 (5.50 MB)](http://developer.sonyericsson.com/getDocument.do?docId=65054)可用。

请注意，GPRS AT 命令绝非易事。如果您的手机配置正确并且您希望它使用第一个定义的互联网帐户启动 IP 连接，您可以运行

```
ATD*98*1# 
```

或者

```
ATD*99***1# 
```

开始 PPP 协商（请参阅索尼爱立信文档中的“ATD 扩展 – 请求 GPRS 服务”）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-10-30T11:58:54.117

Virtenio 使用 SIMCOM GPRS 调制解调器，如果您对这种调制解调器有疑问，可以问我。我已经为 Virtenio 的[GPRS 网关](https://www.virtenio.com/en/portfolio-items/preongate-gprs/)开发了驱动程序，并且我在这方面有所了解。

基本上，您至少需要以下命令进行 GPRS 连接：

```
AT+CGATT
AT+CSTT
AT+CIICR
AT+CIFSR
AT+CIPSTART
AT+CIPSEND
AT+CIPRXGET
AT+CIPCLOSE 
```

您还必须首先配置调制解调器以使其正常工作，例如配置数据模式（文本或非文本）和其他一些东西。

希望这对您有所帮助。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2022-02-16T05:35:22.983

SIM900A 的 AT 命令

**参数（AT+GSLP）：**

time： 休眠时间，以毫秒为单位

例子 ：`AT+GSLP=1500`

**参数（AT+CWMODE）：**

mode：一个整数，指定操作模式为 1、2 或 3。

1 = 站模式（客户端）

2 = AP 模式（主机）

3 = AP + Station 模式

例子 ：`AT+CWMODE=1`

**参数（AT+CIPMUX）：**

mode：一个整数，指定操作模式，0或1

0 = 单连接

1 = 多个连接

例子 ：`AT+CIPMUX=0`

**参数（AT+CIPMODE）：**

mode：一个整数，指定操作模式，0或1

0 = 正常模式

1 = 未涂漆传输模式

例子 ：`AT+CIPMODE=0`

**参数（AT+CIPSTART）：**

类型：字符串、“TCP”或“UDP”</p>

addr：字符串，远程IP

port：字符串，远程端口

例子 ：`AT+CIPSTART = “TCP”,”182.65.89.118”, 8000`

**参数（AT+CIPSEND）：**

length：数据长度，最大2048字节

例子 ：`AT+CIPSEND = 47`

*原汁原味的传输模式*

换行返回“>” 执行命令后。进入unvarnished传输，每包间隔20ms，每包最大2048字节。当接收到包含“+++”的单个数据包时，返回命令模式。

**参数（AT+CIPCLOSE）：**

关闭 TCP 或 UDP 连接。对于单连接模式。

例子 ：`AT+CIPCLOSE`

# javascript - 将图标包含在可点击文本的目标区域中的最佳方法是什么？

> ID：261098
> 
> 赞同：1
> 
> 时间：2008-11-04T06:49:42.940
> 
> 标签：javascript, javascript-events

我目前正在使用以下 javascript 创建扩展菜单：

[http://demo.raibledesigns.com/struts-menu/scripts/menuExpandable.js.src](http://demo.raibledesigns.com/struts-menu/scripts/menuExpandable.js.src)

目前，只有超链接文本是可点击的。让文本旁边的图标响应点击的最佳方式是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-04T07:28:36.650

图标应该是：

*   锚标记内的内联元素
*   锚标记的背景图像

您可以在 CSS 和/或标记中完成所有这些工作，让 javascript 保持美观和简单。

第三种选择是将图标元素绑定到超链接的事件处理程序方法，但最终结果不太理想，并且需要最多的工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-04T20:46:12.953

HTML

```
<a id="icon" href="blah">blah</a> 
```

CSS

```
#icon {
    background: transparent url(img.gif) no-repeat right center;
    padding-right: 10px;
} 
```

# java - 当我的 Java 应用程序退出/崩溃时，如何摆脱 Java 子进程？

> ID：261125
> 
> 赞同：15
> 
> 时间：2008-11-04T07:07:13.013
> 
> 标签：java, runtime, subprocess, shutdown, process-management

我在 Java 中启动一个子进程，如下所示：

```
final String[] cmd = {"<childProcessName>"};
Process process = Runtime.getRuntime().exec(cmd); 
```

它现在在后台运行。一切都很好。

如果我的程序现在崩溃（它*仍在*开发中:-)），子进程似乎仍然存在。当父 Java 进程终止时，如何使其自动结束？

如果有帮助，我正在使用 Mac OS X 10.5

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-04T07:17:41.917

我自己已经解决了。我添加了一个关机钩子，如下：

```
final String[] cmd = {"<childProcessName>"};
final Process process = Runtime.getRuntime().exec(cmd);
Runnable runnable = new Runnable() {
    public void run() {
        process.destroy();
    }
};
Runtime.getRuntime().addShutdownHook(new Thread(runnable)); 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-11-04T07:34:33.020

正如你所说，[addShutdownHook](https://web.archive.org/web/20080310051714/http://www.onjava.com/pub/a/onjava/2003/03/26/shutdownhook.html?page=2)是要走的路。

但：

*   如果程序终止，并不能真正保证您的关闭挂钩会被执行。有人可能会杀死 Java 进程，在这种情况下，您的关闭挂钩将不会被执行。（如this [SO question](https://stackoverflow.com/questions/191215/how-to-stop-java-process-gracefully)中所述）

*   一些标准库有自己的钩子，可能会在你之前运行。

*   谨防死锁。

另一种可能性是[将您的 java 程序包装在 service](http://wrapper.tanukisoftware.org/doc/english/index.html)中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-07-04T05:44:22.257

添加关闭钩子不是杀死子进程的可靠方法。这是因为当从任务管理器执行强制终止时，可能不一定会执行 Shutdown 挂钩。

一种方法是子进程可以定期监视其父进程的 PID。这样，当父进程退出时，子进程可以自行退出。

# visual-studio-2008 - 哪个 unittest 框架集成到 Visual Studio 2008 中

> ID：261126
> 
> 赞同：2
> 
> 时间：2008-11-04T07:08:22.603
> 
> 标签：visual-studio-2008, unit-testing

Visual Studio 2008 具有以前仅在 Team Suite 版本中可用的内置单元测试。这是基于什么单元测试框架？MbUint、MStest、xUnit 还是完全不同的东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-04T07:19:44.250

这是MS测试。你会期望它是别的什么吗？这有点像 MS 决定使用 NAnt 而不是 MS Build ;)

另一方面，我似乎记得 ASP.NET MVC 具有 MS Test、NUnit 和 MbUnit 的单元测试选项。我自己没有使用过，所以这些信息完全基于截图。

就我个人而言，我认为 MS 可以在 2005 年缝制单元测试框架市场，如果他们给 MS 测试更多的润色（如红/绿条！）并将其包含在 Express 版本中。它现在在 Pro 中可用的事实是一个好的开始，但仍然有“单元测试不适合业余爱好者”的消息，我觉得这有点烦人 :(

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-04T07:15:14.493

MSTest 包含在 VS2008 中，就像 Dev 一样。美东时间。和测试版。在 VS2005 中。

# vb6 - 如何在 Windows XP 中模拟慢速打印机？

> ID：261136
> 
> 赞同：3
> 
> 时间：2008-11-04T07:18:36.343
> 
> 标签：vb6, printing, windows-xp

要在 Visual Basic 项目中测试打印，我需要模拟 SLOW 打印机，我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-04T07:23:08.910

传真调制解调器非常慢，您应该可以在某处找到打印到传真的驱动程序。但由于 Windows 假脱机打印作业，您的应用程序不会注意到打印机设备很慢。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-04T07:33:28.560

没有比真实的东西更好的模拟了。我可以推荐几个我有个人经验的模型，这将有助于您的模拟。

# unit-testing - NUnit vs. MbUnit vs. MSTest vs. xUnit.net

> ID：261139
> 
> 赞同：401
> 
> 时间：2008-11-04T07:20:06.123
> 
> 标签：unit-testing, nunit, mstest, mbunit, xunit.net

有很多针对 .NET 的单元测试框架。我发现了这个小功能比较：http: [//xunit.github.io/docs/comparisons.html](https://xunit.net/docs/comparisons)

现在我要为我们选择最好的一个。但是怎么做？有关系吗？哪一个最有未来的证明并且背后有不错的动力？我应该关心这些功能吗？虽然 xUnit 似乎是最现代的并且是专门为 .NET 设计的，但 NUnit 似乎再次被广泛接受。MSTest 再次已集成到 Visual Studio ...

* * *

## 回答 #1

> 赞同：208
> 
> 时间：2009-06-05T20:18:35.037

我知道这是一个旧线程，但我想我会为[xUnit.NET](http://xunit.github.io/)投票。虽然提到的大多数其他测试框架都几乎相同，但 xUnit.NET 采用了一种非常独特、现代和灵活的单元测试方法。它改变了术语，因此您不再定义 TestFixtures 和测试...您指定有关代码的事实和理论，这从 TDD/BDD 的角度更好地与测试的概念相结合。

xUnit.NET 也非常可扩展。它的 FactAttribute 和 TraitAttribute 属性类不是密封的，并且提供了可覆盖的基本方法，使您可以对这些属性装饰的方法应该如何执行进行大量控制。虽然默认形式的 xUnit.NET 允许您编写类似于 NUnit 测试夹具及其测试方法的测试类，但您根本不局限于这种形式的单元测试。您可以自由扩展框架以支持 BDD 样式的关注/上下文/观察规范，如此[处](http://iridescence.no/post/Extending-xUnit-with-a-Custom-ObservationAttribute-for-BDD-Style-Testing.aspx)所述。

xUnit.NET 还通过其 Theory 属性和相应的数据属性直接支持开箱即用的拟合样式测试。拟合输入数据可以从 excel、数据库，甚至是 Word 文档等自定义数据源（通过扩展基本数据属性）加载。这允许您利用单个测试平台进行单元测试和集成测试，这可以极大地减少产品依赖性和所需的培训。

其他测试方法也可以用 xUnit.NET 实现……可能性是无限的。结合另一个非常具有前瞻性的模拟框架[Moq](https://github.com/Moq/moq4)，两者创建了一个非常灵活、可扩展和强大的平台来实现自动化测试。

* * *

## 回答 #2

> 赞同：136
> 
> 时间：2008-11-04T07:29:33.233

NUnit 可能是最受第 3 方工具支持的。它的存在时间也比其他三个要长。

我个人不太关心单元测试框架，模拟库更重要的是恕我直言（并且锁定你更多）。只需选择一个并坚持下去。

* * *

## 回答 #3

> 赞同：109
> 
> 时间：2008-11-04T09:25:37.243

我不会选择 MSTest。尽管它可能是微软背后框架的最未来证明，但它并不是最灵活的解决方案。没有一些黑客攻击，它不会独立运行。因此，在不安装 Visual Studio 的情况下在 TFS 以外的构建服务器上运行它是很困难的。Visual Studio 测试运行器实际上比 Testdriven.Net + 任何其他框架都慢。而且因为这个框架的版本与 Visual Studio 的版本相关联，所以更新较少，如果您必须使用较旧的 VS，那么您将与较旧的 MSTest 相关联。

我认为您使用哪些其他框架并不重要。从一个切换到另一个真的很容易。

我个人根据同事的喜好使用 XUnit.Net 或 NUnit。NUnit 是最标准的。XUnit.Net 是最精简的框架。

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2012-09-26T22:58:27.447

考虑用另一个测试框架补充而不是替换 MSTest。您可以保持 Visual Studio MSTest 集成，同时获得功能更全面的测试框架的好处。

例如，我将 xUnit 与 MSTest 一起使用。添加对 xUnit.dll 程序集的引用，然后执行类似的操作。令人惊讶的是，它只是有效！

```
using Microsoft.VisualStudio.TestTools.UnitTesting;
using Assert = Xunit.Assert;  // <-- Aliasing the Xunit namespace is key

namespace TestSample
{
    [TestClass]
    public class XunitTestIntegrationSample
    {
        [TestMethod]
        public void TrueTest()
        {
            Assert.True(true);  // <-- this is the Xunit.Assert class
        }

        [TestMethod]
        public void FalseTest()
        {
            Assert.False(true);
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2009-06-05T20:27:35.550

Nunit 不适用于 C++ 中的混合模式项目，所以我不得不放弃它

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2008-12-29T18:46:54.797

在小规模/个人规模上这不是什么大事，但它可以在更大范围内迅速成为更大的交易。我的雇主是一家大型 Microsoft 商店，但出于多种原因不会/不能购买 Team System/TFS。我们目前使用 Subversion + Orcas + MBUnit + TestDriven.NET 并且效果很好，但是获得 TD.NET 是一个巨大的麻烦。MBUnit + TestDriven.NET 的版本敏感性也是一个大麻烦，并且有一个额外的商业事物（TD.NET）供法律审查和采购来处理和管理，这并非易事。我的公司和许多公司一样，对 MSDN 订阅模式很满意，而且它只是不习惯为数百名开发人员处理一次性采购。换句话说，完全集成的 MS 产品虽然并不总是最好的，但在我看来是一个重要的增值。

我认为我们将继续我们目前的步骤，因为它有效并且我们已经在组织上克服了困难，但我确实希望 MS 在这个领域有一个引人注目的产品，这样我们就可以整合和简化我们的开发堆栈。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2008-11-04T07:33:33.957

这没什么大不了的，在它们之间切换很容易。集成 MSTest 也没什么大不了的，只需获取 testdriven.net。

就像前人说的选择一个模拟框架，我目前最喜欢的是 Moq。

# c# - 如何在postsharp中创建一个方面检查类中所有方法的空引用

> ID：261151
> 
> 赞同：0
> 
> 时间：2008-11-04T07:26:56.170
> 
> 标签：c#, .net, postsharp

如何在 postsharp 中创建一个方面检查类中所有方法的空引用。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace test
{
    [MethodParameterNullCheck]
    internal class Class
    {
        public Class()
        {

        }

        public void MethodA(int i, ClassA a, ClassB b)
        {
              //Some business logic
        }
    }
} 
```

然后，方面 [MethodParameterNullCheck] 应展开为以下代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace test
{
    [MethodParameterNullCheck]
    internal class Class
    {
        public Class()
        {

        }

        public void MethodA(int i, ClassA a, ClassB b)
        {
            if (a == null) throw new ArgumentNullException("Class->MethodA: Argument a of ClassA is not allowed to be null.");
            if (b == null) throw new ArgumentNullException("Class->MethodA: Argument b of ClassB is not allowed to be null.");
            // Some Business Logic
        }
    }
} 
```

如果您能给我一个示例实现，让我开始使用 postsharp 进行 AOP，我将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-04T07:58:56.933

另一种方法是扩展方法：

```
public static void ThrowIfNull<T>(this T obj, string parameterName) where T : class
{
    if(obj == null) throw new ArgumentNullException(parameterName);
} 
```

然后调用：

```
foo.ThrowIfNull("foo");
bar.ThrowIfNull("bar"); 
```

这`T : class`使我们不小心装箱等。

重新 AOP；[Jon Skeet在这里](http://msmvps.com/blogs/jon_skeet/archive/2008/03/27/postsharp-and-iterator-blocks-a-beautiful-combination.aspx)有一个类似的示例- 但涵盖了一个方法/参数。

这是复制的方面；请注意，此方面一次仅涵盖 1 个参数，并且是特定于方法的，但总的来说，我认为这是完全合理的……但是，您可能可以更改它。

```
using System;
using System.Reflection;
using PostSharp.Laos;

namespace IteratorBlocks
{
    [Serializable]
    class NullArgumentAspect : OnMethodBoundaryAspect
    {
        string name;
        int position;

        public NullArgumentAspect(string name)
        {
            this.name = name;
        }

        public override void CompileTimeInitialize(MethodBase method)
        {
            base.CompileTimeInitialize(method);
            ParameterInfo[] parameters = method.GetParameters();
            for (int index = 0; index < parameters.Length; index++)
            {
                if (parameters[index].Name == name)
                {
                    position = index;
                    return;
                }
            }
            throw new ArgumentException("No parameter with name " + name);
        }

        public override void OnEntry(MethodExecutionEventArgs eventArgs)
        {
            if (eventArgs.GetArguments()[position] == null)
            {
                throw new ArgumentNullException(name);
            }
        }
    }
} 
```

# c++ - 寻找为 C++ 代码着色的脚本

> ID：261152
> 
> 赞同：2
> 
> 时间：2008-11-04T07:26:58.247
> 
> 标签：c++, visual-studio

有谁知道与默认 MSVC IDE 一样为 C++ 代码着色的脚本？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-04T07:34:47.887

如果它是用于网络的，我可以推荐你[prettify](http://code.google.com/p/google-code-prettify/)，它是 StackOverflow 用于代码着色的脚本，它真的很容易让它工作......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-04T07:29:51.297

[SyntaxHighlighter](http://code.google.com/p/syntaxhighlighter/)是您正在寻找的那种东西吗？还有[GeSHi](http://qbnz.com/highlighter/)，最近更新了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-04T23:53:55.180

试试开源项目[Highlight](http://www.andre-simon.de/)。

它本身不是脚本——但它是可编写脚本的。好处是它解析代码并且样式表很容易自定义颜色、粗体和斜体等......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-05T00:21:27.853

浏览器内的[http://tohtml.com/](http://tohtml.com/)语法提示器非常好，具体取决于您在做什么。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-05T00:28:32.317

Notepad++ 非常好，我在 Windows 系统上使用 C++ 时使用它。

下面是 sourceforge 页面的标题：Notepad++ 是一个通用的源代码编辑器（无论如何它都会尝试）和用 win32 API 用 c++ 编写的记事本替换。Notepad++ 的目标是提供具有完全可定制的 GUI 的纤巧高效的二进制文件。

[http://sourceforge.net/projects/notepad-plus/](http://sourceforge.net/projects/notepad-plus/)

# c# - 如何为 asp.net 制作 numericupdown 控件？

> ID：261164
> 
> 赞同：2
> 
> 时间：2008-11-04T07:32:34.600
> 
> 标签：c#, asp.net, visual-studio

有人知道如何为 asp 制作一个 numericupdown 控件吗？有一个可以制作winforms，但我不知道是否有一个可以制作webforms。有没有插件或我可以使用的东西？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-04T07:42:41.320

你可以使用 AJAX.NET，有一个[numericupdown 控件](http://www.asp.net/AJAX/AjaxControlToolkit/Samples/NumericUpDown/NumericUpDown.aspx)。

检查[http://ajax.asp.net/](http://ajax.asp.net/)

# asp.net - 成员资格例外的全球化没有发生……怎么办？

> ID：261173
> 
> 赞同：2
> 
> 时间：2008-11-04T07:36:00.177
> 
> 标签：asp.net, asp.net-membership, globalization, .net-3.5, language-packs

我正在使用 SqlMembershipProvider 来执行我的 ASP.NET 网站的用户管理。特别是，该网站需要多语言（全球化！）。

当我使用 Membership.CreateUser 创建用户时，很高兴我得到了重复电子邮件、重复用户名等的例外情况。但我想要的是通过将其本地化到当前线程文化中来重新使用该异常文本。

我很肯定我正在正确设置当前线程 UI 文化等，因为所有其他全球化功能都可以正常工作。

我的印象是所有 .NET Framework 异常文本都是全球化的。他们不是吗？？？

特别是，我正在测试法语。[我想我已经按照此处](http://blogs.msdn.com/astebner/archive/2008/01/21/7191582.aspx)的说明成功安装了法语 .NET 3.5 SP1 语言包（但不确定 - 有没有办法检查！？）。

是不是只有 System.Web.Security.Membership 异常没有本地化？还是我缺少环境配置步骤？

任何帮助都会很棒。

安德鲁。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-10-29T14:52:09.153

异常消息未本地化。

您必须使用错误代码自行本地化它们：

```
Public Shared Function ErrorCodeToString( _
                    ByVal createStatus As MembershipCreateStatus) As String
    Select Case createStatus
        Case MembershipCreateStatus.DuplicateUserName
            Return Resources.Resource.Account_DuplicateUserName

        Case MembershipCreateStatus.DuplicateEmail
            Return Resources.Resource.Account_DuplicateEmail

        ... 
```

有关状态代码的完整列表，请参阅[此 MSDN 链接](http://msdn.microsoft.com/en-us/library/system.web.security.membershipcreatestatus.aspx)。

# .net - 使用“朋友”声明进行单元测试。馊主意？

> ID：261177
> 
> 赞同：17
> 
> 时间：2008-11-04T07:38:50.437
> 
> 标签：.net, unit-testing, language-agnostic, friend, internalsvisibleto

[*当然，问题不限于特定的“朋友”实现，尽管如果相关，请随时指出实现细节*]

阅读未回答的问题，我偶然发现了这个[`InternalsVisibleTo`](http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.internalsvisibletoattribute.aspx)属性：

> 指定通常仅在当前程序集中可见的类型对另一个程序集可见。

[MSDN](http://msdn.microsoft.com/en-us/library/)上的[C# Programming Guide](http://msdn.microsoft.com/en-us/library/67ef8sbd.aspx)有一节[Friend Assemblies](http://msdn.microsoft.com/en-us/library/0tke9fxk.aspx)描述了如何使用属性来允许对另一个程序集使用方法和类型。`internal`

我想知道使用它来创建一个“隐藏”接口来检测库以供单元测试程序集使用是否是一个好主意。它似乎在两个方向上都大大增加了耦合（在生产程序集中测试代码，在测试代码中对生产程序集的深入了解），但另一方面，它可能有助于创建细粒度的测试，而不会弄乱公共接口。

你在测试时使用友元声明是什么体验？是你的银弹，还是它开始了死亡行军？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-11-04T08:06:02.393

我已经广泛使用了这种技术——这意味着我的单元测试可以测试代码库中普通消费者看不到的方面。

虽然使用`[InternalsVisibleTo]`确实增加了耦合，但我相信（轻微的）增加是非常值得的。

我的单元测试已经与被测代码紧密耦合——尽管我尝试编写测试来确保特定的结果，而不是特定的实现，通过访问普通消费者不可见的东西，我确实在某种程度上限制了实现。

换一种方式，耦合是最小的——在`[InternalsVisibleTo]`代码程序集中具有属性，并将某些东西标记为**内部**而不是**私有**（或**受保护的内部**而不是**受保护**的）。

（请注意，我在这里忽略了使用单元测试引发的任何设计更改，这是另一个完整的讨论。）

该`[InternalsVisibleTo]`属性需要强命名您的程序集。如果您还没有这样做，您可能会发现这有点繁琐，因为强命名程序集可能只依赖于其他强命名程序集，这最终可能导致您需要更改多个程序集。

获得正确的属性可能有点繁琐，因为它需要包含测试程序集的公钥。IDesign 有一个有用的[Friend Assembly 工具](http://www.idesign.net/idesign/DesktopDefault.aspx?tabindex=5&tabid=11#Essentials)，可以在剪贴板上创建属性，准备粘贴。受到推崇的。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-11-04T07:41:32.570

这是我个人申请过的唯一用途`InternalsVisibleTo`——而且确实非常非常方便。

我不认为单元测试是黑盒测试——它们在某种程度上已经与实现耦合。能够测试内部类型和方法可以更紧密地关注（更小的单元）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-06T21:06:22.350

我认为使用`InternalsVisibleToAttribute`启用单元测试是完全合理的。我在“单元测试”中的“单元”是一个类，其中包括`internal`类，所以我想测试它们。 [不过，我不想对`private`方法](https://stackoverflow.com/questions/34571/whats-the-best-way-of-unit-testing-private-methods#52054)进行单元测试。

我不认为为测试创建一个特殊的私有接口是一个好主意。单元测试的价值之一是它使您有机会从该类的使用者的角度考虑该类的接口；提供后门会带走这种好处。

然而，我的偏好是将我的单元测试与我的生产代码放在同一个程序集中。它通常不会影响我的客户，但它确实为我简化了事情，所以我这样做了。当我这样做时，它会让`InternalsVisibleTo`问题消失。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-06T21:14:32.303

事实上，单元测试是我能够让自己使用for 的*唯一*`InternalsVisibleToAttribute`用途。有了这个，您可以将大部分“私有”方法实现为内部方法，而不是将它们暴露给单元测试框架，以便对类内部不变量进行更具侵入性的测试。

我在这项技术上取得了巨大的成功。如果没有别的，它可以通过让您在无法访问的情况下调用私有方法来帮助您实现神话般的 100% 代码覆盖率目标。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-09-21T19:26:16.127

我认为当您在将旧版 C++ 代码与较新的 C# 代码结合在一起时使用单独的程序集时，会出现另一个合法的用例。

我们采用了 C++ 程序集，将它们转换为 C++/CLI，然后在 C# 中实现更新的代码。当我们这样做时，我们仍然会为 C# 中不真正公开的类/方法使用“内部”，然后将它们作为友元程序集提供给遗留代码。

# php - 可以将 MySQL 连接转换为 PDO 连接吗？

> ID：261186
> 
> 赞同：2
> 
> 时间：2008-11-04T07:46:41.933
> 
> 标签：php, mysql, pdo

我在一个应用程序上工作，它只有一种方法来获得一个有效的数据库连接：一个返回 MySQL 连接资源的函数。

我有什么方法可以将该 MySQL 连接转换为 PDO MySQL 连接？

我无法以任何其他方式访问 MySQL 服务器，没有用户名、密码，什么都没有。我也看不到/获取包含函数的文件。稍后我可能会，但我仍然想知道这是否可能。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-04T08:20:20.977

不——那是不可能的。PDO 和 ext/mysql 是访问 MySQL 服务器的两个完全不同的组件。

如果没有用户名、密码、主机（可以通过使用`string mysql_get_host_info ([ resource $link_identifier ] )`和数据库名称检索（可以通过查看服务器上的数据库列表检索`resource mysql_list_dbs ([ resource $link_identifier ] )`），您将无法使用给定之外的任何其他方法连接到服务器一、不可能从给定的 ext/mysql 资源中读取用户名和/或密码。

# ruby-on-rails - rails partials中的条件格式

> ID：261190
> 
> 赞同：7
> 
> 时间：2008-11-04T07:48:19.123
> 
> 标签：ruby-on-rails, ruby, renderpartial

我正在渲染一个轨道部分，我想在渲染部分时交替背景颜色。我知道这不是很清楚，所以这里是我想要做的一个例子：

第一行灰色背景 第二行黄色背景 第三行灰色背景第四行黄色背景

*   对不起stackoverflow接缝以防止显示背景颜色，但我认为这让我的想法很清楚

这是我正在使用的视图代码

```
<table>
  <%= render :partial => 'row' :collection => @rows %>
</table> 
```

_row.html.erb 部分看起来像这样

```
<tr bgcolor="#AAAAAA">
  <td><%= row.name %></td>
</tr> 
```

问题是我不知道如何更改每隔一行的背景颜色。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-11-04T07:55:57.377

您可以使用 Cycle 助手。像这样的东西：

```
<tr class="<%= cycle("even", "odd") %>">
  <td><%= row.name %></td>
</tr> 
```

或者在您的情况下使用 bgcolor 代替，尽管我建议使用 css 类。

您可以循环通过两个以上的值：cycle('first', 'second', 'third', 'and_more')。

还有： reset_cycle('cycle_name') 这确保在每次迭代中，您都将从循环列表的第一个值重新开始。

查看 Rails[文档](http://apidock.com/rails/ActionView/Helpers/TextHelper/cycle)以获取更多示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T19:27:13.417

另一个想法，您可以使用javascript根据（TD的总数％2）更改元素的样式。

这样，您所有的视觉内容都包含在 html/css/javascript 层中。再说一次，如果禁用了 javascript，此技术将不起作用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-05T19:16:07.240

循环有一个“陷阱”：如果你应该附加到字符串，循环就会中断。例如，

```
cycle('odd', 'even') << " some other classes" 
```

将打破循环。但是，颠倒顺序或构造字符串可以正常工作：

```
"some other classes " << cycle('odd', 'even')
"#{cycle('odd', 'even')} some other classes" 
```

我还没有（还）深入研究源代码，看看为什么会这样。另外，我正在使用 Rails 3.2.x

# delphi - D2009 中 TStringStream.ReadString 的行为变化？

> ID：261201
> 
> 赞同：8
> 
> 时间：2008-11-04T07:52:26.057
> 
> 标签：delphi

我今天注意到，在 D2009（更新 1）中，TStringStream.ReadString 不再像 D2007 之前那样移动 Stream 中的位置。
因此，在 MyStringStream.ReadString(10) 上循环将始终读取流的第一个 10 个字符，而不是继续移动并将所有流 10 个字符乘以 10 个字符。我检查了文档，它仍然说 ReadString 应该移动位置...
任何人都可以确认它是否是 D2009 代码中的错误，或者是否有设计更改（以及为什么）并且文档已过时？
谢谢...

更新：[QC #68582中报告的问题](http://qc.codegear.com/wc/qcmain.aspx?d=68582)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-04T08:06:17.387

绝对是一个错误和丑陋的兼容性破坏。如果您检查 Classes.pas，您将看到 ReadString 的 Unicode 和非 Unicode 版本。非 Unicode 版本会增加 FPosition，而 Unicode 则不会。原始 D2009 和 Update 1 的行为相同。

请在[QC](http://qc.codegear.com)中报告。

# asp.net - 基于表单的安全和上传 asp.net 网站

> ID：261202
> 
> 赞同：0
> 
> 时间：2008-11-04T07:53:26.850
> 
> 标签：asp.net, security

我写了一个小网站来学习vb.net和asp.net，对它很满意，所以租了一些空间并上传了它，它是使用asp.net express edition 2008和sql server express编写的... . 我上传了它，我发现它是用 .NET 3.5 编写的，我的主机只处理 2.01 ......我已经整理了大部分内容，并将我的 web.config 文件修剪为基础，但是我的基于表单的身份验证不起作用

```
<compilation debug="true" strict="false" explicit="true">
        </compilation>
        <authentication mode="Forms" />
    <customErrors mode="Off"/>
  </system.web> 
```

而且一直报sql server不支持远程访问……不知道接下来该怎么办，我不用自己写安全例程吧？我有一个 sql server 后端

谢谢你的时间

克里斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-04T07:58:47.683

如果问题是您无法访问您的 SQL Server，可能是因为您使用的是受信任的连接？

如果网站在 ISP 网络上而您的 SQL Server 在另一个网络上，则它可能无法正常工作。

然后您需要做的是查看您的连接字符串以更改它，以便您在连接字符串中传递用户名/密码。注意：这在安全性方面并不是最佳的，但它是访问另一个域中的远程 SQL Server 的一种方式。

/乔金

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-04T11:32:03.337

您是否使用 SqlMembershipProvider 将用户存储在数据库中？检查配置文件的部分并确保 connectionStringName 是指连接字符串的名称。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-04T22:25:32.723

为您的帮助干杯，将我的 web.config 更改为

```
<?xml version="1.0"?>
<configuration>
    <appSettings/>
  <connectionStrings>
    <add name="DatebaseConnectionString" connectionString="ohh wouldn't you like to know" />
  </connectionStrings>
    <system.web>
        <roleManager enabled="true" />
  <compilation debug="true" strict="false" explicit="true">
        </compilation>
    <pages>
      <namespaces>
        <clear/>
        <add namespace="System"/>
        <add namespace="System.Collections"/>
        <add namespace="System.Collections.Generic"/>
        <add namespace="System.Collections.Specialized"/>
        <add namespace="System.Configuration"/>
        <add namespace="System.Text"/>
        <add namespace="System.Text.RegularExpressions"/>
        <add namespace="System.Web"/>
        <add namespace="System.Web.Caching"/>
        <add namespace="System.Web.SessionState"/>
        <add namespace="System.Web.Security"/>
        <add namespace="System.Web.Profile"/>
        <add namespace="System.Web.UI"/>
        <add namespace="System.Web.UI.WebControls"/>
        <add namespace="System.Web.UI.WebControls.WebParts"/>
        <add namespace="System.Web.UI.HtmlControls"/>
      </namespaces>
    </pages>
        <authentication mode="Forms" />
    <membership defaultProvider="SqlProvider">
       <providers>
          <add connectionStringName="DatebaseConnectionString" applicationName="pedalpedalpuffpuff.com"
             enablePasswordRetrieval="false" enablePasswordReset="true"
             requiresQuestionAndAnswer="true" requiresUniqueEmail="true"
             passwordFormat="Hashed" maxInvalidPasswordAttempts="5" passwordAttemptWindow="10"
             name="SqlProvider" type="System.Web.Security.SqlMembershipProvider" />
       </providers>
    </membership>
    <customErrors mode="Off"/>
  </system.web>
</configuration> 
```

一切正常

# c++ - 我可以使用 CArchive 在 MFC 中序列化 STL 的映射吗？

> ID：261215
> 
> 赞同：6
> 
> 时间：2008-11-04T08:05:04.300
> 
> 标签：c++, mfc, stl, map, serialization

我需要将映射的内容（键是 int 的 ID，值是自定义结构的）写入文件，然后从文件中加载它。我可以在 MFC 中使用 CArchive 执行此操作吗？

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-04T09:12:05.537

在 MFC 中，我相信最简单的方法是先序列化地图的大小，然后简单地遍历所有元素。

您没有指定是否使用`std::map`或 MFC 的`CMap`，但基于的版本`std::map`可能如下所示：

```
void MyClass::Serialize(CArchive& archive)
{
  CObject::Serialize(archive);
  if (archive.IsStoring()) {
    archive << m_map.size(); // save element count
    std::map<int, MapData>::const_iterator iter = m_map.begin(), 
                                           iterEnd = m_map.end();
    for (; iter != iterEnd; iter++) {
      archive << iter->first << iter->second;
    }
  }
  else {
    m_map.clear();
    size_t mapSize = 0;
    archive >> mapSize; // read element count
    for (size_t i = 0; i < mapSize; ++i) {
      int key;
      MapData value;
      archive >> key;
      archive >> value;
      m_map[key] = value;
    }
  }
} 
```

如果在读取存档时发生错误，则其中一个流操作应引发异常，然后由更高级别的框架捕获。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-04T08:24:00.127

我对 MFC 了解不多，但是使用[Boost.Serialization可以轻松解决您的问题](http://www.boost.org/doc/libs/1_35_0/libs/serialization/doc/index.html)

```
struct MapData {
     int m_int;
     std::string m_str;

  private: 
    friend class boost::serialization::access; 

    template<class Archive> 
    void serialize(Archive &ar, const unsigned int version) 
    { 
        ar & m_int; 
        ar & m_str; 
    } 
};

std::map< int, MapData > theData;

template<class Archive>
void serialize(Archive & ar, std::map< int, MapData > & data, const unsigned int version)
{
    ar & data;
} 
```

稍后您是否想要进行真正的归档：

```
std::ofstream ofs("filename"); 
boost::archive::binary_oarchive oa(ofs); 
oa << theData; 
```

而已。

（免责声明：只是在此框中键入的代码，根本没有经过测试，错字是故意的；）

# javascript - Javascript 中的类变量

> ID：261219
> 
> 赞同：17
> 
> 时间：2008-11-04T08:07:10.007
> 
> 标签：javascript, oop, inheritance

我在尝试让类变量在 javascript 中工作时遇到了一些麻烦。

我以为我理解原型继承模型，但显然不是。我假设既然原型将在对象之间共享，那么它们的变量也会如此。

这就是为什么这段代码让我感到困惑。

实现类变量的正确方法是什么？

```
function classA() {};

classA.prototype.shared = 0;

a = new classA;

//print both values to make sure that they are the same
classA.prototype.shared;
a.shared;

//increment class variable
classA.prototype.shared++;

//Verify that they are each 1 (Works)
classA.prototype.shared;
a.shared;

//now increment the other reference
a.shared++;

//Verify that they are each 2 (Doesn't Work)
classA.prototype.shared;
a.shared; 
```

更新：所以似乎每个人都在确认通过增加实例的变量我们不会影响原型的事实。这很好，这是我在示例中记录的内容，但这似乎不是语言设计中的错误吗？为什么这种行为是可取的？我觉得奇怪的是，当实例的 var 未定义时，我们通过隐藏链接到原型中获取 var 的值，但我们将其复制到实例对象中。

我也明白这不是 java/c++/ruby/python，它是一种不同的语言。我只是好奇为什么这种行为可能是好的。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-04T11:24:10.543

**静态（类级别）变量可以这样完成**：

```
function classA(){
    //initialize
}

classA.prototype.method1 = function(){
    //accessible from anywhere
    classA.static_var = 1;
    //accessible only from THIS object
    this.instance_var = 2;
}

classA.static_var = 1;  //This is the same variable that is accessed in method1() 
```

**由于 javascript 处理原型的方式，**您的输出看起来很奇怪。调用任何方法/检索实例化对象的变量**首先检查实例，然后检查原型**。IE

```
var a = new classA();
classA.prototype.stat = 1;

// checks a.stat which is undefined, then checks classA.prototype.stat which has a value
alert(a.stat); // (a.stat = undefined, a.prototype.stat = 1)

// after this a.stat will not check the prototype because it is defined in the object.
a.stat = 5;  // (a.stat = 5, a.prototype.stat = 1)

// this is essentially a.stat = a.stat + 1;
a.stat++; // (a.stat = 6, a.prototype.stat = 1) 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-04T13:49:54.353

```
I assumed that since prototypes will be shared between objects then so will their variables. 
```

他们是，但这是：

```
a.shared++ 
```

没有做你认为它正在做的事情。实际上（大约）是以下的糖语法：

```
(a.shared= a.shared+1)-1 
```

（-1 是返回预增量值，而不是您实际上正在使用重新运行值，但仍然。）

所以这实际上是对 a.shared 进行分配。当您分配给一个实例成员时，您总是写给该实例自己的成员，*而不是*触及其任何原型的任何成员。这和说的一样：

```
classA.prototype.shared= 1;
a.shared= 2; 
```

所以你的新 a.shared 隐藏了prototype.shared 而不改变它。classA 的其他实例将继续显示原型的值 1。如果您删除 a.shared，您将再次能够看到隐藏在其后面的原型变量。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-04T09:42:35.773

如果你想要一个类变量，比如Java中的静态变量，那么你可以在父类中声明一个变量，但是你不应该将它作为子对象的变量来访问。[This article](http://www.unix.com.ua/orelly/web/jscript/ch07_05.html)有一个很好的例子，类Circle具有变量`Circle.PI = 3.14`，而Circle的所有实例都以`Circle.PI`（而不是`c.PI`）访问它。

所以我的回答是，如果你想有一个类变量`shared`，`classA`那么你应该声明这个变量 shared in `classA`，然后你应该使用`classA.shared`而不是`a.shared`. 改变`a.shared`永远不会导致`classA.shared`改变。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-04T08:26:56.237

您只需将成员放在“类”上，在 JavaScript 中它是构造对象的函数：

```
function ClassA(x) { this.x = x; }
ClassA.shared = "";
ClassA.prototype.foo = function() {
    return ClassA.shared + this.x;
}

var inst1 = new ClassA("world");
var inst2 = new ClassA("mars");

ClassA.shared = "Hello ";
console.log(inst1.foo());
console.log(inst2.foo());
ClassA.shared = "Good bye ";
console.log(inst1.foo());
console.log(inst2.foo()); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-04T11:57:57.170

通过实例增加`shared`属性使其成为该实例的属性，这就是您看到这种行为的原因。

完成此操作后，您将永远不会通过实例访问该属性的原型，而是访问它自己的属性。

```
>>> function ConstructorA() {};
>>> ConstructorA.prototype.shared = 0;
>>> var a = new ConstructorA();
>>> ConstructorA.prototype.shared++;
>>> a.shared
1
>>> a.hasOwnProperty("shared")
false
>>> a.shared++;
>>> a.hasOwnProperty("shared")
true 
```

这就是为什么正确的解决方案是使用`ConstructorA.shared`，正如迄今为止许多答案中所建议的那样，并且始终通过构造函数而不是实例来访问它。

考虑到 JavaScript 中没有类之类的东西可能会有所帮助。使用运算符创建的“实例”`new`只是由特定构造函数创建并具有特定原型链的对象。这就是为什么`a.shared`不能访问`ConstructorA.shared`- 属性访问涉及查看有问题的对象以获取命名属性，如果失败，则遍历其原型链以查找属性，但创建对象的构造函数不是一部分的原型链。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-04T08:26:24.040

如果您实例化该类 ( `a = new classA`)，则修改该实例`a`不会更改基类本身。的实例`classA`将从 继承所有内容`classA.prototype`，但这并不向后适用，更改`a`不会更改`classA`。
如果您有两个类似的实例`a1 = new classA`，`a2 = new classA`那么您可以对两者进行更改，`a1`而`a2`不会影响另一个。`classA.prototype`另一方面，更改将在他们两个中可见。实例
变量将具有默认值，直到它被赋予一个新值。默认值为 的值。`shared``a``classA.prototype.shared`

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-08-09T17:02:52.410

这是因为原型不是类定义。原型变量不是静态变量。想想原型这个词。它不是用于构建对象的模型——它是要复制的示例对象。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-04T12:45:33.533

您定义的不是类变量，而是实例变量的默认值。

类变量应该直接在类中定义，即直接在构造函数中。

```
function ClassA()
{
    ClassA.countInstances = (ClassA.countInstances || 0) + 1;
}
var a1 = new ClassA();
alert(ClassA.countInstances);
var a2 = new ClassA();
alert(ClassA.countInstances); 
```

当您在原型中声明一个变量时，该变量将被所有实例作为实例变量继承（就像方法一样），如果您在实例中更改它（就像方法一样），它将被覆盖。

# css - 如何在 Django 中使用 CSS？

> ID：261223
> 
> 赞同：113
> 
> 时间：2008-11-04T08:12:44.143
> 
> 标签：css, django, django-forms

我正在使用 Django 创建我的应用程序，并且想知道如何让 Django 使用我的 CSS 文件？我需要做哪些设置才能让 Django 看到 css 文件？

注意：在本地机器上

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2009-03-05T23:19:40.193

如果您使用开发服务器，请按照[django 项目的操作指南管理静态文件](http://docs.djangoproject.com/en/dev/howto/static-files/)来设置您的 URL，然后在模板中引用您的媒体文件——例如，图像文件夹中的图像`/site_media/images/foo.gif`。

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2008-11-05T01:59:38.907

更一般地说，您是在询问如何从 Django 提供静态文件。如果你在 Apache 下运行，你应该阅读[http://docs.djangoproject.com/en/dev/howto/deployment/modpython/](http://docs.djangoproject.com/en/dev/howto/deployment/modpython/)

如果您正在运行开发服务器（例如，在您的笔记本电脑上），请阅读[http://docs.djangoproject.com/en/dev/howto/static-files/](http://docs.djangoproject.com/en/dev/howto/static-files/)

请注意关于 Django 开发服务器的**大而厚的免责声明：**

*   使用此服务器效率低下且不安全。
*   不要在生产环境中使用它。
*   仅将其用于开发。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2012-10-03T10:14:59.160

这也给我带来了一段时间的问题（404 未找到错误）。对我来说缺少的一点是编辑`STATICFILES_DIRS`settings.py 中的元组给我这个：

```
STATICFILES_DIRS = (
    # Put strings here, like "/home/html/static" or "C:/www/django/static".
    # Always use forward slashes, even on Windows.
    # Don't forget to use absolute paths, not relative paths.
    os.path.join(os.path.dirname(__file__),'media').replace('\\','/'),
) 
```

然后，这在我的 django 项目顶层名为“media”的文件夹中提取了我的 CSS 文件。

我也有：

```
MEDIA_ROOT = ''
MEDIA_URL = ''
STATIC_ROOT = ''
STATIC_URL = '/media/' 
```

（确保你有`/`上面的领先`STATIC_URL`）

当然，如上所述，您需要从 html 文件中正确包含 CSS 文件。我有：

```
<link href="{{ STATIC_URL }}css/ea_base.css" rel="stylesheet" type="text/css" media="screen" /> 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2008-11-04T08:32:35.883

> 我需要做哪些设置才能让 Django 看到 css 文件？

没有任何。

确保您的模板包含 CSS 文件（与标准 HTML 一样）并将 CSS 文件放在媒体服务器上。

澄清一下：对于 Django，强烈建议您从不同的服务器实例提供所有媒体（不是动态 html 的所有内容）。你如何实现这完全取决于你，但大多数人创建一个子域。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2010-12-02T08:12:47.747

官方 django 文档对我没有帮助。希望博文“ [Django：如何提供静态文件](http://twigstechtips.blogspot.com/2009/08/django-how-to-serve-media-files-css.html)”对你们中的一些人有所帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-11-24T13:29:36.390

将 css 与 django 一起使用的最简单方法是将其作为静态文件添加到模板中。

但它有点像 ajax，我没有找到任何说明如何以标准方式包含它的东西。

如果你想优化它的大小，有一个用于 django 的[css-compressor模块。](http://github.com/dziegler/django-css)

# java - 用户态自动装箱？

> ID：261230
> 
> 赞同：5
> 
> 时间：2008-11-04T08:17:37.177
> 
> 标签：java, autoboxing

是否可以为您自己的类实现自动装箱？

为了说明我的例子，这就是我可能想要写的：

```
Foo foo = "lolcat"; 
```

这就是 Java 会做的事情（根据我自己的定义，在某个地方，不知何故），在引擎盖下：

```
Foo foo = new Foo();
foo.setLolcat("lolcat"); 
```

那么，这是可能的，还是只是 JVM 功能？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-04T08:21:18.153

不，java 不支持运算符重载（[http://en.wikipedia.org/wiki/Operator_overloading](http://en.wikipedia.org/wiki/Operator_overloading)）。

自动装箱是一种编译器功能，不适用于您自己的类。

原因在这里解释：http: [//www.cafeaulait.org/javafaq.html#xtocid1902938](http://www.cafeaulait.org/javafaq.html#xtocid1902938)

# algorithm - 帮我写一个边界值的二分搜索（提取子列表）

> ID：261234
> 
> 赞同：1
> 
> 时间：2008-11-04T08:21:21.303
> 
> 标签：algorithm, language-agnostic, search, binary

假设我有很多值的数组（C++ 语法，抱歉）：

```
vector<double> x(100000); 
```

这个数组是这样排序的`x[n] > x[n-1]`。

我想要一个函数来检索 [a, b] 范围内所有值的数组（包括在内）。一些界面如：

```
void subarray(const double a, const double b, vector<double> &sub) {
    ...
} 
```

当此函数完成时，`sub`将包含`n`范围 [a, b] 内的值。

当然，线性搜索很容易：

```
void subarray(const double a, const double b, vector<double> &sub) {
    for (size_t i = 0; i < data.size(); i++) {
        if (a <= data[i] && data[i] <= b) {
            sub.push_back(data[i]);
        }
    }
} 
```

但是，因为`data`是排序的，所以我应该能够使用二分搜索更快地做到这一点。谁想试一试？允许任何语言！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-04T08:30:59.613

您要问的是关于确切的范围属性和类型的问题。但是，您可以调整以下 C++ 代码以满足您的需要。基本直觉是使用 lower_bound 和 upper_bound 来查找数组中描绘您要查找的范围的位置。

```
void subarray(const double a, const double b, vector <double> &sub, vector <int> pn) {
    vector <int>::const_iterator begin, end;
    begin = lower_bound(pn.begin(), pn.end(), a);
    end = upper_bound(pn.begin(), pn.end(), b);
    sub.insert(sub.begin(), begin, end);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-04T08:28:46.827

您似乎已经知道可以使用二进制搜索来查找范围，并且很容易找到它们的实现。

其他一切都只是简单的数组操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-04T08:32:21.577

简单的解决方案：

*   使用二分查找找到最低的 a 和最高的 b
*   分配一个新数组
*   复制值

如前所述，代码是微不足道的。

# entity-framework - Entity Framework 2.0 是否有计划的发布日期？

> ID：261235
> 
> 赞同：4
> 
> 时间：2008-11-04T08:22:01.177
> 
> 标签：entity-framework

我目前正在为今年春天计划的项目寻找不同的 ORM 解决方案。Entity Framework 是我正在仔细研究的产品之一，但 EF 2.0 会更有趣。

是否有任何迹象表明 Entity Framework 2.0 版计划何时发布？使用 .Net 4.0？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-05T13:26:04.650

Entity Framework v2 将成为 .NET 4.0 的一部分。[您可以在http://blogs.msdn.com/efdesign](http://blogs.msdn.com/efdesign)上查看有关 v2 的信息，还有[来自 PDC 的视频](http://channel9.msdn.com/pdc2008/TL20/)

VS2010 和 .NET 4.0 的第一个 CTP 已经可用 - 但我认为它还没有包含新的 EF 功能（将检查）[下载 CTP](http://www.microsoft.com/downloads/details.aspx?FamilyId=922B4655-93D0-4476-BDA4-94CF5F8D4814&displaylang=en)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-04T09:51:01.387

AFAIK 尚未正式宣布。我看到的最好的提示是[here](http://blogs.msdn.com/adonet/archive/2008/10/29/update-on-linq-to-sql-and-linq-to-entities-roadmap.aspx)，所以它可能与.NET 4.0 一起出现。我敢打赌他们会在那之前发布一个CTP。

# powershell - 使用 Powershell 创建 IIS 6.0 应用程序池

> ID：261237
> 
> 赞同：6
> 
> 时间：2008-11-04T08:22:34.467
> 
> 标签：powershell, iis-6

如何使用 PowerShell 脚本在 IIS 6.0 上创建应用程序池？

这是我到目前为止想出的......

```
$appPool = [wmiclass] "root\MicrosoftIISv2:IIsApplicationPool" 
```

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-05T05:35:20.733

想我可能会分享我想出的脚本。感谢 Steven 和 leon。

```
# Settings
$newApplication = "MaxSys.Services"
$poolUserName = "BRISBANE\svcMaxSysTest"
$poolPassword = "ThisisforT3sting"

$newVDirName = "W3SVC/1/ROOT/" + $newApplication
$newVDirPath = "C:\" + $newApplication
$newPoolName = $newApplication + "Pool"

#Switch the Website to .NET 2.0
C:\windows\Microsoft.NET\Framework\v2.0.50727\aspnet_regiis.exe -sn W3SVC/

# Create Application Pool
$appPoolSettings = [wmiclass] "root\MicrosoftIISv2:IISApplicationPoolSetting"
$newPool = $appPoolSettings.CreateInstance()
$newPool.Name = "W3SVC/AppPools/" + $newPoolName
$newPool.PeriodicRestartTime = 0
$newPool.IdleTimeout = 0
$newPool.MaxProcesses = 2
$newPool.WAMUsername = $poolUserName
$newPool.WAMUserPass = $poolPassword
$newPool.AppPoolIdentityType = 3
$newPool.Put()
# Do it again if it fails as there is a bug with Powershell/WMI
if (!$?) 
{
    $newPool.Put() 
}

# Create the virtual directory
mkdir $newVDirPath

$virtualDirSettings = [wmiclass] "root\MicrosoftIISv2:IIsWebVirtualDirSetting"
$newVDir = $virtualDirSettings.CreateInstance()
$newVDir.Name = $newVDirName
$newVDir.Path = $newVDirPath
$newVDir.EnableDefaultDoc = $False
$newVDir.Put()
# Do it a few times if it fails as there is a bug with Powershell/WMI
if (!$?) 
{
    $newVDir.Put() 
}

# Create the application on the virtual directory
$vdir = Get-WmiObject -namespace "root\MicrosoftIISv2" -class "IISWebVirtualDir" -filter "Name = '$newVDirName'"
$vdir.AppCreate3(2, $newPoolName)

# Updated the Friendly Name of the application
$newVDir.AppFriendlyName = $newApplication
$newVDir.Put() 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-04T23:16:04.180

这不是最明显的过程，但这对我有用..

```
$AppPoolSettings = [wmiclass]'root\MicrosoftIISv2:IISApplicationPoolSetting'
$NewPool = $AppPoolSettings.CreateInstance()
$NewPool.Name = 'W3SVC/AppPools/MyAppPool'
$Result = $NewPool.Put() 
```

调用 Put() 可能会出错，但第二次（或第三次）调用它应该可以正常工作。这是由于 PowerShell V1 和 WMI 的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-01T03:29:07.587

一切都很好！我修改了代码，以便在初始错误之后显式调用 $newPool.Put() 命令。谢谢你的帮助！

# java - 如何以编程方式在 Excel 中插入符号“无限”？

> ID：261246
> 
> 赞同：2
> 
> 时间：2008-11-04T08:28:58.887
> 
> 标签：java, excel

如何以编程方式在 Excel 工作表中创建“无限”符号？

最好来自 Java ......但也欢迎其他提示。

谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-04T08:36:04.177

“无穷大符号”字符位于 unicode 的代码点 0x221E 中。执行此操作的 VBA 代码是这样的：

```
ActiveSheet.Range("A1").Value = ChrW(&h221E) 
```

希望这可以帮助。

# svn - 让 SVN 的外部定义万无一失？

> ID：261254
> 
> 赞同：3
> 
> 时间：2008-11-04T08:34:00.513
> 
> 标签：svn, version-control

我有一组应用程序，它们都依赖于跨平台库（内部开发），并且所有内容都存储在 subversion 中。现在，这个库是每个应用程序的一部分，因此它的副本必须在每个应用程序的工作目录中。

为了能够返回到应用程序的任何版本并拥有正确版本的库，一种选择是在项目中保留库的副本，但这是维护的噩梦。

更优雅的似乎是使用颠覆的[外部定义](http://svnbook.red-bean.com/en/1.5/svn.advanced.externals.html)功能。但是，似乎有必要使用明确的修订号来确保 100% 确保分配了正确的修订（例如，如果指定了没有修订号的主干或标签或分支，那么您似乎不能 100%确定你是否会得到与一年前完全相同的版本，因为人们总是可以在主干/分支/标签之上提交）。

现在，这个库正在不断开发中，因为它基本上是我们多平台应用程序的核心。因此，维护 svn:external 道具中的修订需要不断更新。开发人员通常会更改他们的本地副本（错误修复、新功能）然后提交它。我现在担心，如果我使用修订进行设置，将更难追踪此提交的确切位置（例如，开发人员可能会忘记 dep 在分支上；同样在提交时，它将被提交到顶部主干/分支，可能会跳过其他开发人员的其他提交）。

基本上，即使使用外部定义，开发人员仍然需要保持一定数量的约束和控制来处理这个问题（例如，参见[SO 上的这个例子](https://stackoverflow.com/questions/245337/how-can-i-branch-in-svn-and-have-it-branch-my-svnexternal-folders-as-well)）。理想情况下，他们应该足够聪明地这样做，但是（根据我自己的判断）忘记这些小细节是很常见的，以后可能会引起很多麻烦。

所以，我正在寻找的是一个真正万无一失的解决方案（如果有的话），让这个库与多个项目保持同步，这样我就可以及时回到过去，并且总能得到正确的版本，而无需必须时刻保持警惕。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-04T11:02:12.680

你的问题的问题在于你的图书馆不是图书馆，至少不是严格意义上的表达。

您的“库”最好被描述为一个项目，该项目恰好由处理依赖该核心的不同应用程序的团队共享。

在这种情况下，最大的问题不是您可能选择使用的颠覆技术，而是您组织团队以在该核心组件上实现有用协作的方式。

可能出现的问题至少有两种。首先，由于不同的应用程序可能需要来自您的核心的不同行为，如果它们不能很好地协调，来自一个团队的完全有效的提交将破坏其他团队（持续集成在这里应该有所帮助）。

但第二个问题即使团队间沟通良好也很难解决，它与发布管理有关。

如果依赖于该内核的应用程序在不同的时间点发布，您将很难获得一个稳定的内核，该内核足以发布一个应用程序，同时又不停止其余应用程序的开发。

我的建议是，请专人负责核心库。在每个项目中使用它的一个分支，并让应用程序开发人员在那里提交，同时确保他们与每个人讨论更改，特别是 lib 的监督者。

最后，让这个库主管负责协调将不同团队所做的更改合并到库的主干中，从而生成稳定的、经过测试的版本，这些版本将被您的应用程序的稳定版本使用。在每次发布核心之后，将下一代分支生成到其余项目中。

与仅仅定义一个外部并让每个人都在那里提交相比，这听起来像是很多工作。但实际上，隐藏您必须付出一些努力来保持核心库的连贯性这一事实是没有意义的。如果你不提前做，它会在以后追捕你。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-04T09:48:09.613

可能有帮助的是限制对标签文件夹的写入/提交访问，而不是在 svn:externals 中使用标签而不是修订号。（即使用[svnperms](http://svn.collab.net/repos/svn/trunk/tools/hook-scripts/svnperms.py)）

所以用户不能不小心提交到错误的地方，而必须有意识地选择更改所属的分支/主干。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-04T09:48:41.440

使用 svn:externals 很好（**带有修订版**），但听起来好像您需要使用构建服务器（例如[Hudson](http://hudson.dev.java.net/)），它会在签入时自动构建。这将直接检测开发人员何时进行本地更改而忘记更新外部因素。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-04T10:01:51.787

您可以使用[供应商分支](http://svnbook.red-bean.com/en/1.5/svn-book.html#svn.advanced.vendorbr)。

# windows - 在不需要它的应用程序中“驱动器中没有磁盘”

> ID：261265
> 
> 赞同：4
> 
> 时间：2008-11-04T08:40:27.223
> 
> 标签：windows

我们的应用程序是用 C++ 编写的，并在 Windows XP 上使用。在某些只有 C: 驱动器的客户端机器上，应用程序启动时会弹出错误：

*驱动器中没有磁盘。请将磁盘插入驱动器“D”*

如果他们点击“继续”或插入一张 CD（甚至是一张空的！）并按“重试”，一切正常。

[有人建议](http://liquidrescale.wikidot.com/forum/t-25337)这可能与在驱动器 D: 上编译有关（我们的构建机器使用驱动器 D: 进行编译）。有没有人遇到过这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-04T10:25:28.010

找出试图访问 D 驱动器的内容并修复它肯定是一个好主意。但是，如果需要，可以通过使用 SEM_FAILCRITICALERRORS 标志调用[SetErrorMode来抑制这种行为。](http://msdn.microsoft.com/en-us/library/ms680621(VS.85).aspx)它甚至可以帮助您识别问题，因为错误将直接发送到应用程序，而不是通过系统对话框进行处理。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-04T08:54:22.860

尝试在 C: 上编译它，看看错误是否仍然存在。您可以使用[www.syinternals.com中的](http://www.syinternals.com)*Process Monitor*来查看程序试图访问的文件/目录。希望这可以帮助！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-06-12T12:54:36.787

这可能是旧消息，但我刚刚在尝试运行 Delphi 2010 时收到了同样的错误。事实证明，当我拔下正在充电的手机时，错误消失了。

由于我一直在这台计算机上为手机充电，我想知道为什么会突然发生这种情况。这次不同的是，当我重新启动计算机以安装一些更新时，我的手机已插入。

拔下手机后（重新启动后），错误消失了，我将手机重新插上充电，没有发生任何事故。

希望这可以帮助某人。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-04T09:25:32.017

尝试通过[Dependency Walker](http://www.dependencywalker.com/)运行程序，并查看二进制文件的依赖项中是否有对 D: 的引用。这可能会提示您哪个库（如果有）有问题。或者它可能什么也没给你，但它是免费的，而且做起来很快，所以我推荐它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-04T09:05:42.993

哦，是的，我们曾经遇到过这样的错误……不幸的是，我不能告诉你修复方法是什么，但它是完全愚蠢的，我记得这么多。我仍然可以在我们的 CDebugStackWalk 类中找到注释，所以它可能与堆栈展开有关......某处，不知何故......

# c++ - 比较 std::list 中的两个连续元素

> ID：261271
> 
> 赞同：7
> 
> 时间：2008-11-04T08:44:41.833
> 
> 标签：c++, list, iterator, compare

我想在遍历列表时比较 std::list 中的两个连续元素。当我的迭代器位于元素 i 时，访问元素 i+1 的正确方法是什么？谢谢科比

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-04T10:11:56.557

STL 提供了相邻查找() 算法，可用于查找两个连续相等的元素。还有一个带有自定义谓词的版本。

这些是原型：

```
template <class ForwardIterator>
   ForwardIterator adjacent_find ( ForwardIterator first, ForwardIterator last );

template <class ForwardIterator, class BinaryPredicate>
   ForwardIterator adjacent_find ( ForwardIterator first, ForwardIterator last,
                                   BinaryPredicate pred ); 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-11-04T08:48:13.013

为了这个目的， Boost 有一个称为[`next`](http://www.boost.org/libs/utility/utility.htm)（及其逆`prior`）的实用程序。

```
*itr == *next(itr) 
```

编辑：但是，如果我们回头看看森林，*真正的*问题是，为什么要自定义编写你的[`adjacent_find`](http://en.cppreference.com/w/cpp/algorithm/adjacent_find)函数？（我建议接受 Nicola Bonelli 的回答。）这是 STL 的一部分，如果您的代码不使用 Boost，则不需要使用 Boost（感谢评论者指出这一点）。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-11-04T08:57:56.737

最简单的方法是保存两个迭代器（因为无论如何你都必须停在倒数第二个）。

```
std::list<int>::const_iterator second = list.begin(),
                               end = list.end();

if ( second != end ) // Treat empty list
    for(std::list<int>::const_iterator first = second++; // Post-increment 
        second != end; 
        ++first, ++second)
    {
        //...
    } 
```

请注意，当循环开始时，它是用 的[后增量](http://cplus.about.com/od/glossar1/g/postincdefn.htm)`first`初始化的，而第二个是。`second``first``list.begin()``list.begin()+1`

[Chris Jester-Young 指出](https://stackoverflow.com/questions/261271/compare-two-consecutive-elements-in-stdlist#261277)boost has`next`和`prior`functions，虽然我不熟悉这些函数（因为我的罪过），但实现它们是微不足道的（特别是考虑到它`list`有双向迭代器）。

```
template <class Iterator>
Iterator next(Iterator i) // Call by value, original is not changed
{ 
    return ++i;
}
// Implementing prior is left as an exercise to the reader ;o) 
```

我的感觉是，使用`next`并不能解决这个问题，也不能同时维护两个迭代器，因为你必须记住确保每次使用`next(i)`都不相等。`end()`

* * *

**编辑：**

*   [由于Luc Touraille](https://stackoverflow.com/users/20984)的评论，修复了列表为空的错误。
*   添加参考`next`以及为什么我认为它不适合这个用例。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-04T12:32:59.500

List 是一个可逆容器，所以它的迭代器是双向迭代器，它是 Forward Iterator 的一个模型，我很确定这意味着你可以做到这一点（或者类似的东西，如果你对突破一个循环等）：

```
if (!l.empty()) {
    for (list<T>::const_iterator i = l.begin();;) {
        const T &a = *i;
        ++i;
        if (i == l.end()) break;
        do_comparison(a, *i);
    }
} 
```

你不能用输入迭代器来做到这一点，因为只要你有一个迭代器，这些值就“存在”。但是您可以使用前向迭代器。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-11-20T18:31:55.893

```
for (list<int>::iterator it = test.begin(); it!=test.end(); it++) {
        cout<<*it<<":\t";
        list<int>::iterator copy = it;
        for( list<int>::iterator it2 =  ++copy; it2!=test.end();it2++){
            cout<<*it2<<"\t";
        }
        cout<<endl;
    } 
```

# visual-studio-2010 - 如何在没有 Visual Studio 的情况下使用 MSTest？

> ID：261290
> 
> 赞同：52
> 
> 时间：2008-11-04T09:00:47.463
> 
> 标签：visual-studio-2010, visual-studio, unit-testing, mstest

MSTest 是否具有类似于 nUnit 的独立 GUI，可让我在没有 Visual Studio 的情况下使用它并运行测试？MSTest 的官方网站是什么，我可以在哪里了解有关如何使用它的更多信息？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2011-10-12T21:37:52.197

无需安装 Visual Studio 即可使用 MSTest。您将需要[安装 Visual Studio Test Agent](https://docs.microsoft.com/en-us/visualstudio/test/lab-management/install-configure-test-agents)，它可从 Microsoft 免费下载。

我认为从许可的角度来看，这种方法比手动将 MSTest.exe 及其依赖项复制到构建服务器上要好。

请参阅此博客以供参考：http: [//blogs.msdn.com/b/anutthara/archive/2009/12/16/running-tests-in-mstest-without-installing-the-vs-ide.aspx](http://blogs.msdn.com/b/anutthara/archive/2009/12/16/running-tests-in-mstest-without-installing-the-vs-ide.aspx)

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2008-11-04T09:17:17.617

它没有 GUI（除了 Visual Studio），但有一个命令行工具：[MSTest.exe](http://msdn.microsoft.com/en-us/library/ms182489.aspx)

这是有关[运行 MSTest 测试](http://msdn.microsoft.com/en-us/library/ms182469.aspx)的官方文档。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-04-23T01:18:00.927

您可以使用 mstest.exe 执行此操作，但诀窍在于无需安装 Visual Studio 即可使其工作。这涉及复制多个文件和注册表项。我在[这里](http://mindinthewater.blogspot.com/2008/11/executing-visual-studio-unit-tests.html)写了博客。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-10-13T01:00:18.667

使用[Gallio](http://www.gallio.org/)作为您的测试运行器......然后，当您最终放弃 MsTest 并转向真正的测试框架时，它就不会那么戏剧化了。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2018-12-27T15:01:26.087

使用**Microsoft.TestPlatform的****VSTest.console.exe**部分

 **所需步骤：

1.  [从https://www.nuget.org/packages/Microsoft.TestPlatform/](https://www.nuget.org/packages/Microsoft.TestPlatform/)下载测试平台
2.  解压
3.  In the unzipped folder, copy the *\tools\net451\Common7\IDE\Extensions\TestPlatform* folder to the machine that has no Visual Studio installed
4.  From cmd.exe run **VSTest.console.exe MyTest.dll**

More details here:[https://docs.microsoft.com/en-us/visualstudio/test/vstest-console-options?view=vs-2017#general-command-line-options](https://docs.microsoft.com/en-us/visualstudio/test/vstest-console-options?view=vs-2017#general-command-line-options)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-11-04T22:26:21.477

您也可以从 codeplex 使用这个工具：http: [//testrunner.codeplex.com](http://testrunner.codeplex.com) ...

# c++ - WinSNMP v1 陷阱

> ID：261294
> 
> 赞同：2
> 
> 时间：2008-11-04T09:05:13.430
> 
> 标签：c++, snmp, oid, snmp-trap, winsnmp

我在 C++ 中使用 WinSNMP 来发送 snmp 陷阱。为了向后兼容，我需要发送 v1 snmp 陷阱。WinSNMP 与 v2 陷阱一起使用，但能够在发送陷阱时将这些 v2 陷阱转换为 v1。我用`SnmpSetTranslateMode(SNMPAPI_UNTRANSLATED_V1)`它来做到这一点。我还在绑定列表的开头添加了 sysUpTime oid (1.3.6.1.2.1.1.3.0)、snmpTrapOID (1.3.6.1.6.3.1.1.4.1.0) 和 enterpriseOID (1.3.6.1.6.3\. 1.1.4.3.0) 在绑定列表的末尾，以便可以发送 v1 陷阱。

除了两个（可能相关的）事情之外，一切都很好。

陷阱中的 `agent-addr`字段始终为 0.0.0.0（我尝试将 snmpTrapAddress oid(1.3.6.1.6.3.18.1.3.0) 添加到绑定列表，但没有奏效）。我希望此字段包含源的 IP 地址。

`HSNMP_ENTITY`第二个问题是，尽管我在with `SnmpStrToEntity`and中指定了一个 IP 地址和一个端口，`SnmpSetPort`并且我`HSNMP_ENTITY`在`SnmpSendMsg`函数中使用了它，但陷阱仍然从另一个端口（在动态端口范围内的某个位置）发送。

这里有没有人知道如何解决这个问题，或者谁能告诉我这是否可能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-08T04:36:40.103

几个想法：

*   `agent-addr`可以由下层设置为网络适配器的IP地址。是否可以选择将一个特定的适配器与 SNMP 相关联？

*   为什么需要设置trap的源端口？SNMP 只要求将陷阱发送到 UDP 端口 162；除非您的特定应用程序有其他要求，否则源无关紧要。（有关 SNMP 详细信息，请参阅 RFC 1067。）

# batch-file - 批处理在 for /f 命令上过早关闭

> ID：261296
> 
> 赞同：7
> 
> 时间：2008-11-04T09:08:11.287
> 
> 标签：batch-file

我有一个带有以下行的批处理文件（在 Windows XP 中，已激活命令扩展名）：

```
for /f %%s in ('type version.txt') do set VERSION=%%s 
```

在某些计算机上，它工作得很好（如[this SO question](https://stackoverflow.com/questions/130116/dos-batch-commands-to-read-first-line-from-text-file)所示），但在其他计算机上**它会杀死cmd**（控制台窗口刚刚关闭）

为什么 ？

* * *

注意：计算机似乎具有类似的配置：XpSP2，用户具有管理权限，在 HKEY_CURRENT_USER\Software\Microsoft\Command Processor 中没有定义“命令处理器”...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-04T09:09:21.520

我得到了第一个经验性答案：

```
for /f %%s in (version.txt) do ... 
```

在每台计算机上都可以正常工作。

它似乎`for /f`适用于文件名，而不适用于任何 dos 命令，如“类型文件名”。

但是，这不适用于我所有客户的计算机（在某些情况下，“类型文件名”工作正常）

如果您想要 15（简单？）点 ;-)，您可以回答这个问题：
**为什么 'for /f' 有时除了文件名之外不能使用其他任何东西。为什么它只是关闭 DOS 会话？**

* * *

编辑：3 年后（！），[barlop](https://stackoverflow.com/users/385907/barlop)遇到了类似的情况，在问题“[`for /f`立即关闭 cmd 提示符？](https://stackoverflow.com/questions/7236499/for-f-closes-cmd-prompt-immediately) ”中有详细说明。他的结论是：

> `COMSPEC`做`SET`+时确实列出了`ENTER`。
> 所以，我打开了环境变量窗口，发现`COMSPEC`没有在用户或系统变量下列出。我将它添加到系统变量中，启动了命令提示符，它似乎工作正常。

[Andriy M](https://stackoverflow.com/users/297408/andriy-m)在回答 barlop 的问题时提到了[ss64 论坛上的这个帖子](http://ss64.org/viewtopic.php?id=504)，其中包含详细信息。

> 为了重新加载窗口，需要设置 " `for`" 循环中的脱壳以完成 ' `dir`'（或您要求完成的任何命令） 。`ComSpec``cmd`

```
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Environment\ComSpec=
%SystemRoot%\system32\cmd.exe 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-07T01:46:49.740

关于命令扩展，有可能使用 /E:OFF 调用 CMD.EXE，以便禁用命令扩展（即使在注册表中启用）。

如果在脚本中使用命令扩展 shell 选项，强烈建议您在脚本开头执行以下技巧。

[-- 从http://www.ss64.com/nt/setlocal.html](http://www.ss64.com/nt/setlocal.html "http://www.ss64.com/nt/setlocal.html")粘贴的信息

> 如果给定一个参数，SETLOCAL 将设置一个 ERRORLEVEL。如果给出两个有效参数之一，则它将为零，否则为零。
> 
> 您可以在批处理文件中使用它来确定命令扩展是否可用，使用以下技术：

```
VERIFY errors 2>nul
SETLOCAL ENABLEEXTENSIONS
IF ERRORLEVEL 1 echo Unable to enable extensions 
```

> 这是因为“验证错误”将 ERRORLEVEL 设置为 1，然后如果扩展不可用（例如，如果脚本在 command.com 下运行），SETLOCAL 将无法重置 ERRORLEVEL 值
> 
> 如果命令扩展被永久禁用，则 SETLOCAL ENABLEEXTENSIONS 将不会恢复它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-04T14:20:03.187

是否该文件没有扩展名，因此 cmd 将其视为不存在的目录？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-04T14:30:22.620

如果禁用命令扩展，则 for 命令的 (set) 参数必须是文件。

如果启用了命令扩展，则 for 命令的 (set) 参数可以是文件、字符串或命令。

在“类型文件名”设置失败的客户端计算机上禁用命令扩展。

有关启用或禁用命令扩展的信息，请键入“cmd /?”

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-04T17:26:02.263

等等...可能是文件名周围有撇号吗？MS是说文件名集有双引号，而文字字符串有撇号。

```
for /F ["usebackqParsingKeywords"] {%% | %}variable in ("filenameset") do command [CommandLineOptions]

for /F ["usebackqParsingKeywords"] {%% | %}variable in ('LiteralString') do command [CommandLineOptions]

for /F ["usebackqParsingKeywords"] {%% | %}variable in (`command`) do command [CommandLineOptions] 
```

当然，除非你这样做。

> *您可以在立即字符串上使用 for /F 解析逻辑，方法是将括号之间的文件名集括在单引号中（即“文件名集”）。Filenameset 被视为来自文件的单行输入，然后对其进行解析。*

# visual-studio - 如何从 VSTO Word Doc 项目中引用未签名的程序集？

> ID：261301
> 
> 赞同：1
> 
> 时间：2008-11-04T09:10:11.407
> 
> 标签：visual-studio, vsto, word-2007

我在 VS2008 中创建了一个新项目。项目类型

```
Visual C# > Office > 2007 > Word 2007 Document 
```

添加了一些代码.. 让 Word 通过一些自定义的箍跳了几下.. 一切都很好。现在我需要引用另一个**未签名**`CopyLocal as false`的程序集 ( ) 。所以我添加了项目参考。现在项目不会建立抱怨

 **> 错误 MSB3188：程序集“X.dll”必须经过强签名才能标记为先决条件。

[错误代码页面简洁](http://msdn.microsoft.com/en-us/library/ms228132(vs.80).aspx)（现在已经习惯了）从那以后一直在谷歌搜索和阅读帖子......没有运气。

我该如何解决这个问题？或者是所有引用（对于 VSTO？）必须是强命名/签名的隐藏诫命。
我不能签名`X.dll`并完成它，因为它是我无法控制的二进制文件，它还取决于另一组未签名的 dll .. 无法引发链式签名反应。

**更新：通过转动****CopyLocal=True**解决了构建问题。但这意味着将引用的 X.DLL 及其所有依赖项转储到 bin\debug 文件夹中......呃！尝试从那里创建一个名为`bin\debug\refExecs`并引用 X.dll的子文件夹`CopyLocal=false`。错误信息又回来了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-25T13:37:38.047

解决此问题的另一种方法应该是在运行时动态加载程序集。

谷歌搜索解决方案带来了以下[帖子](http://www.tech-archive.net/Archive/VisualStudio/microsoft.public.vstudio.general/2006-05/msg00056.html)，也许这有帮助吗？

# language-agnostic - C中的可重入函数和递归函数有什么区别？

> ID：261311
> 
> 赞同：21
> 
> 时间：2008-11-04T09:17:44.153
> 
> 标签：language-agnostic, reentrancy

在 CI 中知道递归函数，但我听说过重入函数。

那是什么？他们之间有什么区别？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-11-04T09:30:40.413

当您了解该术语的含义时，更容易记住。

术语“重入”意味着在函数已经执行时“**重新进入”它是安全的，通常是在并发环境中。**

换句话说，当两个任务可以同时执行该功能而互不干扰时，该功能就是可重入的。当一个任务的执行对另一个任务的影响产生影响时，一个函数是不可重入的。这通常是使用全局状态或数据时的情况。仅使用局部变量和参数的函数通常是可重入的。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-11-04T09:20:16.630

如果一个函数支持多个执行线程同时“通过”它，那么它就是可重入的。这可能是由于实际的多线程，我在下面使用这种情况，或者由于其他海报指出的其他事情。多线程是第一个想到的，也许也是最容易理解的，所以我专注于那个案例。

这意味着该函数不能使用静态“全局”数据，因为该数据将由两个（或更多）线程并行访问，通常会严重中断。可重入函数通常有一个明确的参数来保存任何特定于调用的状态，而不是静态存储它。

`strtok()`是 C 标准库中众所周知的*不可*重入函数的经典案例。

[编辑]：评论中有很多见解、澄清和更正，所以也请阅读！谢谢你们的帮助，伙计们。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-11-04T09:29:44.380

unwind*最初*所说的大部分是正确的——除了它不限于多线程（此外，用锁保护全局数据使其线程安全——但*不一定*是可重入的）。[编辑]他现在已经修复了他的帖子以解决这个问题:-)

作为递归的结果，一个函数也可以在同一个线程上重新进入——直接或间接地（即，函数a调用函数b，函数c调用函数a，函数c调用函数a）。

当然，如果您在多个线程可能调用它的基础上防止重入，那么您也适用于递归情况。然而，反过来就不是这样了。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2008-11-04T10:33:05.657

当在先前的调用返回之前调用函数时，会发生函数的“重新进入”。发生这种情况的主要原因有三个：递归（函数调用自身）、多线程和中断。递归通常更容易，因为很明显该函数将被重新输入。多线程和中断更棘手，因为重入将是异步的。如其他答案所述，在大多数情况下，该函数不应修改全局数据（读取全局数据是可以的，如果作为关键部分保护，一些写作之王是可以的）。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-24T16:57:36.210

就这个：

*   一个可重入函数可以由多个线程同时调用，前提是函数的每次调用都引用唯一的数据。

*   当每个调用引用共享数据时，多个线程可以同时调用线程安全函数。所有对共享数据的访问都是序列化的。

无耻地从 Qt 手册中窃取。但这是一个简短的定义。基本上，不可重入函数也不是`recursion-safe`.

现在，什么是`recursive`函数？这是一种函数的定义。递归函数是根据自身定义的。他们减少输入，打电话给自己，直到可以找出一个基本案例而无需再次打电话给自己。

所以我们有两件事。

*   递归函数是一种定义。
*   可重入函数是保证多个线程可以调用它们的函数，前提是每次访问唯一数据时。

现在，上面的多线程工具仅用于同时激活函数的多个目的。但是，如果您有一个递归函数，那么您*也*可以同时多次激活该函数。因此，大多数递归函数也必须是可重入的。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-06-05T11:16:32.040

可重入函数是保证在多线程环境下可以正常工作的函数。意味着当函数被一个线程访问时，另一个线程可以调用它......意味着每个线程都有单独的执行堆栈和处理......所以函数不应包含任何可能损害或干扰执行的静态或共享变量......

可以由线程调用的平均函数，同时从另一个线程安全地运行......并且正确......希望我回答正确......

当然，rem 可重入函数与递归函数不同.... 完全不同的概念.... 可重入函数是保证在多线程环境下可以正常工作的函数。意味着当函数被一个线程访问时，另一个线程可以调用它......意味着每个线程都有单独的执行堆栈和处理......所以函数不应包含任何可能损害或干扰执行的静态或共享变量......

意味着它不应该包含任何静态或共享变量....

可以由线程调用的平均函数，同时从另一个线程安全地运行......并且正确......希望我回答正确......

当然，rem 可重入函数与递归函数不同......完全不同的概念......

阅读更多：[http](http://wiki.answers.com/Q/What_is_a_reentrant_function#ixzz1wut38jLF) ://wiki.answers.com/Q/What_is_a_reentrant_function#ixzz1wut38jLF 维基：[http ://en.wikipedia.org/wiki/Reentrancy_%28computing%29](http://en.wikipedia.org/wiki/Reentrancy_%28computing%29)

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2010-12-03T04:36:39.883

所有可重入代码都是递归，但并非所有递归都是可重入的。递归的示例是任何直接或间接调用自身的函数。可重入的示例是中断处理程序例程。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2012-01-27T19:12:57.287

所有递归代码都是可重入的……但并非所有可重入代码都是递归的。

# ms-access - MS-Access 报告在执行时显示设计视图

> ID：261316
> 
> 赞同：1
> 
> 时间：2008-11-04T09:21:30.603
> 
> 标签：ms-access, report, designview

我在 MS Access 报告中创建了一个报告，并编写了一些 VBA 代码来检索数据并以 MS-Word 格式显示报告。但是在运行时生成报告时，报告首先显示或闪烁报告设计视图几秒钟，然后生成报告。

我想找到一种解决方案来避免在生成报告时闪烁设计视图。在这个 MS-Access 或 VBA 编码中是否可能。??

我正在发布我用来从访问表单代码调用访问报告的行。

DoCmd.OpenReport rst![参数], acPreview

这将生成报告，但设计屏幕在执行时会闪烁几秒钟。

并且访问报告中没有写任何 VBA 代码。

实际运行是，我已经准备好临时访问表中的数据并从表中生成报告。

这里的问题是，在预览模式下启动报表时，报表的设计屏幕显示了几秒钟。从用户的角度来看，这看起来很糟糕。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-04T10:43:26.213

您似乎正在设计视图中打开报告以更改某些属性。可能可以避免这种情况，但您需要发布打开报告的代码才能确定。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-04T17:20:48.733

您如何将报告导出到 MS-Word？代码是什么？

您是否尝试过使用简单的报告（带有表格数据源）而不是使用 VBA 代码来做同样的事情？也许 VBA 需要很长时间才能运行，以至于它在设计模式下保持报表打开的时间足够长以至于可以感知。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-07T04:24:32.560

如果您尝试此代码会发生什么：

```
 Dim strReport As Report        
  strReport = rst!Argument
  If SysCmd(acSysCmdGetObjectState, acReport, strReport) Then
     DoCmd.Close acReport, strReport
  End If
  DoCmd.OpenReport strReport, acPreview 
```

该代码所做的是检查报表是否已在任何视图中打开，如果是则关闭它，然后打开它。这可确保您不在隐藏窗口的设计视图中。

并且该代码还避免了可能与将值从记录集传递到 OpenReport 命令相关联的任何可能的 ByRef 引用问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-15T17:02:36.783

当我从 VB6 应用程序调用 MS Access Report 时，我也会发生同样的事情。在我的情况下发生这种情况的原因是因为我有一个设置为在启动时出现的表单。如果您没有选择启动表单，它不应该变得可见，因此不会闪烁。

让我知道这是否有帮助。

麦克风

# api - 什么是学习 OpenOffice.org 脚本 API 的（单一）最佳在线资源

> ID：261318
> 
> 赞同：8
> 
> 时间：2008-11-04T09:22:56.857
> 
> 标签：api, scripting, openoffice.org, uno

我正在使用 OpenOffice.org 来满足我不那么频繁的 Office 套件需求，而且大多数时候它足以替代它的商业替代品。

但它的不足之处在于脚本 API。我还没有找到能够理解 API 的文档，让我可以专注于手头的任务，而不是徘徊如何在打开的文档中选择一段文本。

那么 - 是否有一个很好的文档可以让像我这样的程序员，他们并不完全生活和呼吸 UNO 对象模型，快速开始并在几页或更少的时间内解释如何在 OO.o API 中找到我需要的东西

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-12T07:23:39.307

如果您专门讨论处理文本文档，OO.org Dev Guide 的那部分确实是要走的路：

[http://wiki.services.openoffice.org/wiki/Documentation/DevGuide/Text/Working_with_Text_Documents](http://wiki.services.openoffice.org/wiki/Documentation/DevGuide/Text/Working_with_Text_Documents)

请注意，文档导航在右侧，而且有点小。电子表格也有类似的入口点：

[http://wiki.services.openoffice.org/wiki/Documentation/DevGuide/Spreadsheets/Working_With_Spreadsheet_Documents](http://wiki.services.openoffice.org/wiki/Documentation/DevGuide/Spreadsheets/Working_With_Spreadsheet_Documents)

对于绘图文件：

[http://wiki.services.openoffice.org/wiki/Documentation/DevGuide/Drawings/Working_with_Drawing_Documents](http://wiki.services.openoffice.org/wiki/Documentation/DevGuide/Drawings/Working_with_Drawing_Documents)

我认为这是您正在寻找的一般“备忘单”参考，我认为没有更好的来源。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-04T09:26:32.670

我将从[OpenOffice.org 开发人员指南开始](http://wiki.services.openoffice.org/wiki/Documentation/DevGuide/OpenOffice.org_Developers_Guide)

# c++ - 将 auto_ptr 与 new char[n] 一起使用是否错误

> ID：261336
> 
> 赞同：14
> 
> 时间：2008-11-04T09:31:06.857
> 
> 标签：c++, stl, memory-leaks, auto-ptr

如果我使用声明一个临时自动删除的字符缓冲区

```
std::auto_ptr<char> buffer(new char[n]); 
```

然后缓冲区超出范围时会自动删除。我会假设缓冲区是使用 delete 删除的。

但是缓冲区是使用 new[] 创建的，因此严格来说应该使用 delete[] 删除缓冲区。

这种不匹配可能导致内存泄漏的可能性有多大？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-11-04T09:40:45.683

在使用 new[] 分配的指针上调用 delete 的行为是[undefined](https://isocpp.org/wiki/faq/freestore-mgmt#delete-array)。正如您所假设的，当智能指针超出范围时， auto_ptr[确实会调用 delete 。](http://www.gotw.ca/conv/001.htm)您需要担心的不仅仅是内存泄漏——崩溃和其他奇怪的行为也是可能的。

如果你不需要转移指针的所有权，Boost 的[scoped_array](http://www.boost.org/doc/libs/1_37_0/libs/smart_ptr/scoped_array.htm)类可能就是你要找的。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-11-04T18:12:11.190

我会使用 char 的向量作为缓冲区。

```
std::vector<char>    buffer(size);

read(input,&buffer[0],size); 
```

基本上，如果不需要，您甚至都不想调用 new 。
向量提供了一个运行时大小的缓冲区，您可以像使用数组（缓冲区）一样使用它。

最好的部分是向量会自行清理，并且标准保证向量中的所有元素都将在连续存储中。完美的缓冲。

或更正式的保证是：

```
(&buffer[0]) + size == (&buffer[size]) 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-11-04T09:41:09.193

这会产生未定义的行为（可能比内存泄漏更糟糕，例如堆损坏）尝试使用[boost 的 scoped_array 或 shared_array](http://www.boost.org/doc/libs/1_37_0/libs/smart_ptr/smart_ptr.htm)代替。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-11-04T09:42:30.033

对使用 new[] 分配的数据调用 delete 是未定义的。这意味着编译器可以生成可以做任何事情的代码。但是在这种情况下，它可能会起作用，因为不需要破坏数组中的单个字符，只需破坏数组本身。

由于这种行为是未定义的，我强烈建议使用`std::vector<char>`or`boost::scoped_array<char> / boost::shared_array<char>`代替。`std::auto_ptr<>`在这种情况下，所有这些都是完全可行和优越的选择。如果您使用`std::vector`，您还可以根据需要动态增加缓冲区。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-11-04T18:20:17.477

有充分的理由不使用 std::string 吗？std::vector，正如其他人所建议的那样？你做的是错的，但是不知道你在做什么，推荐别的东西是很困难的。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-11-10T20:20:09.603

是的，这是错误的。用一个简单的包装器包装。

```
typedef< typename T_ >
struct auto_vec{
  T_* t_;
  auto_vec( T_* t ): t_( t ) {}
  ~auto_vec() { delete[] t_; }
  T_* get() const { return t_; }
  T_* operator->() const { return get(); }
  T_& operator*() const { return *get(); }
  /* you should also define operator=, reset and release, if you plan to use them */
}

auto_vec<char> buffer( new char[n] ); 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-07-17T00:33:39.107

自从提出这个问题以来已经过去了几年。

但是我通过搜索点击了这个页面，所以我想我不妨注意一下： **std::unique_ptr**是 auto_ptr 的 C++11 替代品，可以处理使用 new[] 创建的对象的删除。

> std::unique_ptr 有两个版本： 1) 管理单个对象的生命周期（例如用 new 分配）**2) 管理动态分配的对象数组的生命周期（例如用 new[] 分配）**

[cppreference unique_ptr](http://en.cppreference.com/w/cpp/memory/unique_ptr)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-04T18:52:46.600

对于一个非常简单的解决方案来说，这似乎非常复杂。你使用有什么问题

```
 char *c=new char[n] 
```

在这里，然后删除它？或者，如果您需要更动态的解决方案，

```
vector<char> c 
```

奥卡姆剃刀，伙计。:-)

# php - 通过 PHP 插入 HTML 的最佳方法是什么？

> ID：261338
> 
> 赞同：29
> 
> 时间：2008-11-04T09:31:17.463
> 
> 标签：php, html, template-engine

从“最佳实践”的角度来看，您认为使用 PHP 插入 HTML 的最佳方式是什么。目前我使用以下方法之一（主要是后者），但我很想知道您认为哪种方法最好。

```
<?php
  if($a){
?>
[SOME MARKUP]
<?php
  }
  else{
?>
[SOME OTHER MARKUP]
<?php
  }
?> 
```

反对：

```
<?php
  unset($out);
  if($a) $out = '[SOME MARKUP]';
  else $out = '[OTHER MARKUP]';
  print $out;
?> 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-11-04T11:11:33.783

如果你打算那样做，你想把你的逻辑和设计分开，真的。

但是您不需要使用 Smarty 来执行此操作。

优先级是关于心态。我看到人们在 Smarty 中做令人震惊的事情，最终变成人们**在**Smarty 中开发网站，然后一些明亮的火花将决定他们需要在 Smarty 中编写模板引擎（永远不要低估愚蠢想法的潜力）。

如果您将代码分成两部分并强迫自己遵守标准，那么您将获得更好的性能。

页面逻辑.php

```
<?php 

  $pageData = (object)(array());  // Handy trick I learnt. 

  /* Logic Goes here */

 $pageData->foo = SomeValue; 

 ob_start(); 
 require("layout.php"); 
 ob_end_flush(); 
```

布局.php

```
 <html>
   <!-- etc -->
   <?php for ( $i = 1; $i < 10; $i++ ){ ?>
    <?php echo $pageData->foo[$i]; ?>
   <?php } ?>
   <!-- etc -->
</html> 
```

PHP 是作为模板引擎编写的，因此在评估是否需要深入研究 Smarty 之前，您至少应该*尝试将其用于其设计任务。*

* * *

此外，如果您决定使用模板引擎，请尝试使用**默认**转义 HTML 的引擎，然后您“选择退出”而不是“选择加入”。你会为自己省去很多 XSS 的麻烦。Smarty 在这方面比较薄弱，正因为如此，里面写了很多内容朴素的模板。

```
{if $cond}
    {$dangerous_value}
{else}
    {$equally_dangerous_value}
{/if} 
```

通常是 Smarty 模板的运行方式。问题是 $dangerous_value 可以是任意 HTML，这只会导致**更**糟糕的编码实践，到处都是无法追踪的意大利面条代码。

您考虑的任何模板语言**都应**满足此问题。例如：

```
{$code_gets_escaped} 
{{$code_gets_escaped_as_a_uri}}
{{{$dangerous_bare_code}}} 
```

通过这种方式，您的潜在利用途径在模板中很容易辨别，而利用途径是**默认**行为。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-11-04T11:40:02.493

-1 代表典型的歇斯底里“改用 [我最喜欢的模板系统]！” 帖子。每个 PHP 帖子，即使原生 PHP 答案是单行的，也总是退化成这样，就像每个单行 JavaScript 问题最终都充满了“改用 [我最喜欢的框架]！”。太丢脸了。

说真的，我们*知道*分离业务逻辑和表示关注点。你可以在任何模板系统中这样做——或者*不这样做——无论是 PHP、Smarty 还是完全不同的东西。*没有经过大量思考的模板系统可以神奇地分离您的关注点。

（事实上​​，限制性太强的模板系统最终可能会导致您不得不编写纯粹呈现的辅助代码，从而使您的业务逻辑因呈现问题而变得混乱。这不是胜利！）

要回答所提出的问题，第一个示例还可以，但由于缩进不好，很难阅读。请参阅 monzee 的示例以获得更易读的方式；您可以使用 : 表示法或 {}，无论您喜欢哪一种，但重要的是保持您的 HTML 和 PHP 作为一个单一的、“格式良好”的缩进层次结构。

最后一个请求：记住 htmlspecialchars()。每次纯文本需要进入网页时，都*必须*使用这个，否则就是XSS。我知道这个问题与此没有直接关系，但是每次我们发布包含 < ?php echo($title) ?> 的示例代码或没有转义的等效框架时，我们都在鼓励继续安全灾难区域大多数 PHP 应用程序已经成为。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-11-04T09:34:32.857

最重要的考虑是保持逻辑与表示分离 - 更少的耦合将使未来对两者的更改更加直接。

您甚至可能要考虑使用某种模板系统，例如[smarty](http://www.smarty.net/)。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-04T09:58:24.867

对于这样一个非常简单的情况，使用 PHP 作为模板就可以了。但是，如果您超越了简单的逻辑（您很可能会这样做），那么使用模板引擎是一个好主意。

在默认使用 PHP 视图脚本的 Zend Framework 中，推荐的方法是这样的：

```
<?php if ($a) : ?>
    [MARKUP HERE]
<?php else : ?>
    [SOME MORE MARKUP]
<?php endif ?> 
```

与使用大括号相比，更详细的语法使得一目了然地匹配条件块要容易得多。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-04T09:37:28.887

两者都不。使用[智能](http://www.smarty.net/)。通过将内部逻辑与显示逻辑分开，您将构建更易于维护的代码。（不要走 PHPLib 的旧模板系统尝试完全分离 PHP 和 HTML 的路径——它需要显示逻辑与您的核心业务逻辑混合在一起，并且非常混乱。）如果您绝对必须在 PHP 代码中生成 HTML 片段，使用第二种方法，但将变量传递给 Smarty。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-04T09:48:06.730

最好使用模板引擎将逻辑（PHP 代码）与演示文稿（HTML）完全分开。

将 PHP 插入 HTML 既快速又容易，但很快就会变得混乱，并且很难维护。这是一种*非常*快速且*非常*肮脏的方法......

至于 PHP 中可用的所有模板引擎中哪个更好，请参阅以下问题，例如：

*   [PHP 模板 - 使用 PHP](https://stackoverflow.com/questions/163834/php-templates-with-php)
*   [安全的 PHP 模板引擎](https://stackoverflow.com/questions/210507/safe-php-template-engines)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-04T09:57:57.007

如果模板引擎看起来很麻烦，您可以制作自己的穷人模板引擎。这个例子肯定需要改进，并不适合所有任务，但可能适合较小的站点。只是给你一个想法：

模板.inc：

```
<html><head><title>%title%</title></head><body>
%mainbody%
Bla bla bla <a href="%linkurl%">%linkname%</a>.
</body></html> 
```

索引.php：

```
<?php
$title = getTitle();
$mainbody = getMainBody();
$linkurl = getLinkUrl();
$linkname = getLinkName();
$search = array("/%title%/", "/%mainbody%/", "/%linkurl%/", "/%linkname%/");
$replace = array($title, $mainbody, $linkurl, $linkname);
$template = file_get_contents("template.inc");
print preg_replace($search, $replace, $template);
?> 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-04T10:05:47.550

如果您不使用框架或使用没有自己的模板系统的框架，Smarty 是可以的。

否则大多数 PHP 框架和年轻一代的 CMS 都有自己的模板系统。

一般来说，模板系统的想法是让文件几乎只包含 HTML（视图/模板文件）和只包含数据或业务逻辑的文件（模型或控制器文件）。

模板文件可能看起来像这样（来自 SilverStripe 的示例）：

```
<?xml version="1.0" encoding="UTF-8"?>
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
    <head>
        <% base_tag %>
        $MetaTags
        <link rel="stylesheet" type="text/css" href="tutorial/css/layout.css" />
    </head>
    <body>
        <div id="Main">
            <ul id="Menu1">
                <% control Menu(1) %>
                <li class="$LinkingMode">
                    <a href="$Link" title="Go to the &quot;{$Title}&quot; page">$MenuTitle</a>
                </li>
                <% end_control %>
            </ul>
            <div id="Header">
                <h1>$Title</h1>
            </div>
            <div id="ContentContainer">
                $Layout
            </div>
            <div id="Footer">
                <span>Some Text</span>
            </div>
        </div>
     </body>
</html> 
```

您可以看到，在将页面发送到客户端之前，将插入数据的地方只插入了一些非 HTML 代码片段。

然后，您的代码可以（简化）看起来像：

```
<?php
  unset($out);
  if($a) $out = '[SOME CONTENT TO INSERT INTO THE TEMPLATE]';
  else $out = '[SOME ALTERNATIVE CONTENT]';
  templateInsert($out);
?> 
```

关于它的好处：您的 HTML 可以被视为这样并可以这样进行更改，您的设计人员可以理解它，并且不必查看您的代码试图将来自不同地方的点点滴滴拼凑在一起，而没有任何机会看看她在做什么。另一方面，您可以对逻辑进行更改，而不必担心它在页面上的外观。您很可能还会犯更少的错误，因为您的代码将是紧凑的，因此是可读的。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-12-02T00:56:44.353

当我第一次开始使用 PHP 时，我希望我知道：让你的繁重程序代码尽可能远离你的 HTML 输出。这样，它们都保持在大的、相当连续的、可读的块中。

我发现这样做的最好方法是首先制作一个静态 HTML 文件*，*可能包含一些假数据，这样我就可以四处寻找并正确设计，然后编写 PHP 代码来获取输出的动态部分并将它们粘合起来两者一起（你如何做这部分取决于你 - 你可以像其他人建议的那样与 Smarty 一起做）。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-02T18:18:45.900

如果您*必须*这样做，请使用花括号。不要用 PHP 回显 HTML。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-11-04T10:13:59.203

不要使用 smarty - PHP 本身就是一个模板系统。考虑使用以下语法：

```
<?php if($a):?>
[SOME MARKUP]
<?php else: ?>
[SOME OTHER MARKUP]
<? endif; ?> 
```

# asp.net-mvc - 获取完整的请求 url，包括控制器中的参数

> ID：261345
> 
> 赞同：38
> 
> 时间：2008-11-04T09:38:43.520
> 
> 标签：asp.net-mvc, url

如何在我的控制器中获取完整的请求 URL（包括查询字符串）？是连接我的 URL 和表单参数的问题，还是有更好的方法。

我检查了[这个](https://stackoverflow.com/questions/40680/how-do-i-get-the-full-url-of-the-page-i-am-on-in-c)问题，但它似乎不适用于 MVC。

如我错了请纠正我。

一些更详细的信息：

我对 my 的调用`SearchController.AdvancedSearch()`来自一个包含大约 15 个可选参数的表单。由于参数的数量和不可能（我认为）以干净的方式传递可选参数，我选择了一个在控制器中处理的包罗万象的字符串。

现在我希望我的控制器将其调用存储在面包屑组件中，以便在单击面包屑时可以获取完全相同的结果（包括所有但不是更多的参数）。为此，我需要整个 request.URL，*包括 querystring*。

在`Request.RawURL`等中，`request.URL`不包括此查询字符串。事实上，目前我做了一个简单的功能。

```
String.Format("{0}/{1}", request.Url, request.form) 
```

这给了我一些奇怪的结果（如提交按钮值等），但它有效。如果有关于如何减少丑陋黑客的建议，请告诉。

我知道在哪里可以找到当前请求，但我似乎无法在任何地方找到原始 URL。他们都被剥夺了查询字符串，我也需要那一点。

我的控制器更新了`BreadCrumb`组件中的 URL 集合。因此它需要请求 URL。你建议我如何处理这个问题？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2011-07-02T15:20:24.130

您可以使用[`Request.Url.PathAndQuery`](https://msdn.microsoft.com/en-us/library/system.uri.pathandquery(v=vs.110).aspx).

MVC5：使用**Request.RequestUri.PathAndQuery**

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2008-11-04T13:03:33.933

```
HttpContext.Current.Request.RawUrl
HttpContext.Current.Request.QueryString 
```

至于你的第二个问题。而不是跟踪您的用户已访问的 url、查询字符串信息等。跟踪调用的控制器和操作。这将完全消除对 Request 对象的需求。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-11-09T11:16:59.917

```
Request.RawUrl 
```

使用此属性是返回所有 url。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-04T10:11:17.010

您可以使用以下方法获取当前请求对象：

```
HttpContext.Current.Request 
```

但是，我要问——为什么要请求 URL？通过这样做，您使您的控制器依赖于 Request 对象，这将使您的单元测试更难编写。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-04T23:25:29.030

在控制器内，您可以访问`Request.RawUrl`.

# java - 如何从 JAX-WS Web 服务中访问 ServletContext？

> ID：261348
> 
> 赞同：41
> 
> 时间：2008-11-04T09:39:03.673
> 
> 标签：java, web-services, jax-ws

我想通过将对象存储为 servlet 上下文属性来在我的 servlet 和我的 web 服务 (JAX-WS) 之间共享一个对象。但是如何从 Web 服务中检索 servlet 上下文？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2008-11-04T09:39:38.947

servlet 上下文由 JAX-WS 通过消息上下文提供，可以使用 Web 服务上下文进行检索。插入以下成员将导致 JAX-WS 将对 Web 服务上下文的引用注入到您的 Web 服务中：

```
import javax.annotation.Resource;
import javax.servlet.ServletContext;
import javax.xml.ws.WebServiceContext;
import javax.xml.ws.handler.MessageContext;

...

@Resource
private WebServiceContext context; 
```

然后，您可以使用以下命令访问 servlet 上下文：

```
ServletContext servletContext =
    (ServletContext) context.getMessageContext().get(MessageContext.SERVLET_CONTEXT); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-03-03T15:45:58.577

如果你使用 Maven 添加这个依赖！！！

```
 <dependency>
            <groupId>javax.servlet</groupId>
            <artifactId>servlet-api</artifactId>
            <version>2.4</version>
            <scope>provided</scope>
        </dependency> 
```

所以我解决了 get ServletContext [INFO 的避免冲突错误：](https://rishisoftwareblog.wordpress.com/2013/02/06/using-a-servlet-config-file-with-a-cxf-jax-rs-web-service/)

在课堂方法中我使用

```
@WebService(endpointInterface = "choice.HelloWorld")
public class HelloWorldImpl implements HelloWorld {
    @Resource
    private WebServiceContext context;
    public String sayHi(String text) {
        HttpServletRequest request =(HttpServletRequest) context.getMessageContext().get(MessageContext.SERVLET_REQUEST);
        System.out.println(request.getContextPath()); 
```

# vb.net - MDI 父菜单和子菜单

> ID：261350
> 
> 赞同：0
> 
> 时间：2008-11-04T09:39:50.787
> 
> 标签：vb.net, winforms, menu-items

我在开发 MDI 应用程序的 Winforms Development 上使用 VB.Net。

在我的父表单中，我有一个菜单条。在我的子表单中，我还为每个表单附加了一个菜单条，它在访问时会调用一组不同的命令。那么是否有可能在 MDI 表单中，当前活动的子表单是在父表单中显示的菜单？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-05T03:38:10.937

这很简单。只需将 MenuStrip 添加到父级，但将其留空。对菜单合并的内置支持确保活动子菜单出现在空的父条中。

# internet-explorer - 浏览器后退按钮恢复空字段

> ID：261351
> 
> 赞同：7
> 
> 时间：2008-11-04T09:40:29.147
> 
> 标签：internet-explorer, back-button

我有一个网页`x.php`（在我网站的密码保护区域），它有一个表单和一个按钮，该按钮使用该`POST`方法发送表单数据并打开`x.php#abc`。这工作得很好。

但是，如果用户决定在 Internet Explorer 7 中导航回来，则原始字段中的所有字段都将`x.php`被清除，并且必须重新输入所有内容。我无法在会话中保存发布的信息，我试图了解如何让 IE7 以我想要的方式运行。

我在网上搜索并找到了建议 HTTP 标头应包含显式缓存信息的答案。目前，我已经尝试过：

```
session_name("FOO");
session_start();
header("Pragma: public");
header("Expires: Fri, 7 Nov 2008 23:00:00 GMT");
header("Cache-Control: public, max-age=3600, must-revalidate");
header("Last-Modified: Thu, 30 Oct 2008 17:00:00 GMT"); 
```

及其变体。没有成功。[使用WireShark 之](http://www.wireshark.org/)类的工具查看返回的标头表明 Apache 确实尊重我的标头。

所以我的问题是：我做错了什么？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-11-04T11:16:26.677

IE*将*在单击后退按钮时自动保留表单内容，只要：

*   您没有使用 no-cache pragma 或类似的方法破坏缓存
*   有问题的表单字段不是由脚本动态创建的

您似乎手头有缓存，所以我猜后者可能适用。（正如 mkoeller 所说，如果页面在最后几次后点击中，Firefox 通过保持页面本身的活动时间比它在屏幕上的时间更长来避免这个问题。但是这是可选的，Firefox 将恢复到与 IE 和其他相同的行为浏览器之前浏览了几页并且旧页面已过期。）

如果您从脚本 onload 创建自己的表单字段，则浏览器无法知道新输入控件与旧实例“相同”，因此它无法使用先前提交的值填充它. 在这种情况下，如果您希望它与后退按钮一起玩得很好，您必须开始在客户端上存储数据。

然后您必须使用某种状态键控，以便每组数据都与页面的一个实例绑定，否则通过同一表单的多个实例或同时在表单上打开两个浏览器选项卡会严重混淆你的脚本。

然后*，*如果它们是大型表单，您将开始收集大量数据，如果您使用的客户端存储机制是 cookie，您可能会开始丢失数据，并发送大量不必要的状态废话每个 HTTP 请求。其他客户端存储机制可用，但它们是特定于浏览器的。

简而言之：很好地完成动态生成的表单是一种巨大的痛苦，如果可以的话，最好避免这样做。在页面上有一个隐藏的表单，脚本使其可见，因此允许浏览器执行他们的字段记忆魔法而不是给你任务，通常要容易得多。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-04T14:30:56.550

在尝试进一步缩小问题范围时，我找到了问题的原因。我使用的是由 Apache 重写的 URL（即，我总是访问`http://foo.com/page`由 Apache 映射到的我的页面`http://foo.com/page.htm`）。只要我指定正确的 HTTP 标头（ , 等），使用真实的 URL 就可以解决问题并使IE7满意*。*`Cache-Control``Expires`

这是我在 PHP 代码中所做的输出标头的操作，这似乎使所有浏览器都对缓存感到满意：

```
function emitConditionalGet($timestamp)
{
    // See also http://www.mnot.net/cache_docs/
    // and code sample http://simonwillison.net/2003/Apr/23/conditionalGet/

    $gmdate_exp    = gmdate('D, d M Y H:i:s', time() + 1) . ' GMT';
    $last_modified = gmdate('D, d M Y H:i:s', $timestamp) . ' GMT';
    $etag          = '"'.md5($last_modified).'"';

    // If the client provided any of the if-modified-since or if-none-match
    // infos, take them into account:

    $if_modified_since = isset($_SERVER['HTTP_IF_MODIFIED_SINCE'])
                       ? stripslashes($_SERVER['HTTP_IF_MODIFIED_SINCE']) : false;
    $if_none_match     = isset($_SERVER['HTTP_IF_NONE_MATCH'])
                       ? stripslashes($_SERVER['HTTP_IF_NONE_MATCH'])     : false;

    if (!$if_modified_since && !$if_none_match)
    {
        return;  // the client does not cache anything
    }

    if ($if_none_match && $if_none_match != $etag)
    {
        return;  // ETag mismatch: the page changed!
    }
    if ($if_modified_since && $if_modified_since != $last_modified)
    {
        return;  // if-modified-since mismatch: the page changed!
    }

    // Nothing changed since last time client visited this page.

    header("HTTP/1.0 304 Not Modified");
    header("Last-Modified: $last_modified");
    header("ETag: $etag");
    header("Cache-Control: private, max-age=1, must-revalidate");
    header("Expires: $gmdate_exp");
    header("Pragma: private, cache");
    header("Content-Type: text/html; charset=utf-8");
    exit;
}

function emitDefaultHeaders($timestamp)
{
    $gmdate_exp    = gmdate('D, d M Y H:i:s', time() + 1) . ' GMT';
    $last_modified = gmdate('D, d M Y H:i:s', $timestamp) . ' GMT';
    $etag          = '"'.md5($last_modified).'"';

    header("Last-Modified: $last_modified");
    header("ETag: $etag");
    header("Cache-Control: private, max-age=1, must-revalidate");
    header("Expires: $gmdate_exp");
    header("Pragma: private, cache");
    header("Content-Type: text/html; charset=utf-8");
}

function getTimestamp()
{
    // Find out when this page's contents last changed; in a static system,
    // this would be the file time of the backing HTML/PHP page. Add your
    // own logic here:
    return filemtime($SCRIPT_FILENAME);
}

// ...

$timestamp = getTimestamp();
emitConditionalGet($timestamp);
emitDefaultHeaders($timestamp); //previously, this variable was mistyped as "$timestaml" 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-04T10:06:28.737

Firefox 会进行这种缓存。据我了解您的问题，您希望 IE7 的行为方式与 Firefox 相同。我认为这是不可能的。

Firefox 和 IE7 在解释后退按钮的方式上有所不同。

Firefox 将显示上一页的 DOM 树，因为它在页面离开之前最后一次显示。也就是说，所有表单数据仍将包含在表单的输入字段中。`onload`但是您在点击后退按钮时不会看到事件。

IE7 将根据它从服务器接收到的响应再次呈现页面。因此表单是空的（除非服务器最初发送了默认值），但您会看到一个`onload`事件。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-04T10:45:18.673

我四处寻找，这是一个相当困难的问题。这也是动态修改内容的一大痛点。您访问该页面，javascript 用您的指令对其进行扩充，您转到下一页，然后返回，javascript 已经忘记了。并且没有办法简单地更新页面服务器端，因为页面超出了缓存。

所以我设计了一个后退按钮缓存断路器。

它的邪恶和对网络不利，但它使页面能够按照人们期望的方式运行，而不是神奇地到处扭曲。

```
<script type="text/javascript">//<!-- <![CDATA[
(function(){
    if( document.location.hash === "" )
    {
        document.location.hash="_";
    }
    else
    {
      var l = document.location;
      var myurl = ( l.protocol + "//" + l.hostname + l.pathname + l.search); 
      document.location = myurl;
    }
})();
//]]> --></script> 
```

这会产生一点魔力，因为它会检测您/当前/查看的页面是否是从缓存中加载的。

如果您是第一次来，它会检测到“无哈希”，并将“ `#_`”添加到页面 url。如果您第一次在那里（即：不是页面的直接链接），页面上已经有 #_，所以它会删除它并在删除它的过程中触发页面重新加载。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-04T12:12:08.373

您可以在字段中使用 autocomplete="off"。这样，浏览器不会缓存这些值，因此当用户单击后退按钮时，这些值不会填充到表单中。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2019-07-10T22:15:30.463

这是一个旧帖子，此后发生了很大变化。尽管如此，我的一种形式遇到了这个问题（但 Chrome 出现了问题。）如果返回它会清除所有信息。我完全巧合地找到了解决方法，需要在这里分享它，只是因为它太奇怪了。可能这不是发布此内容的最佳位置，但我们开始吧。

这就是我所拥有的（精简版并且无法正常工作。）

```
<table>
    <form>
    <tr>
        <td><input type="number" value="0"></td>
    </tr>
    </form>
</table> 
```

这修复了它（现在可以工作了。）将标签移到标签`<form>`之外。`<table>``<tr>`

```
<form>
<table>
    <tr>
        <td><input type="number" value="0"></td>
    </tr>
</table>
</form> 
```

# c++ - COM, VARIANT 包含 BSTR。谁分配？

> ID：261357
> 
> 赞同：9
> 
> 时间：2008-11-04T09:42:41.780
> 
> 标签：c++, windows, com, variant, bstr

好的，所以我真的想不出一个恰当的标题来总结这一点。

IPrintPipelinePropertyBag 接口具有 AddProperty 方法，该方法非常恰当地“将属性添加到属性包”。

[http://msdn.microsoft.com/en-us/library/aa506384.aspx](http://msdn.microsoft.com/en-us/library/aa506384.aspx "IPrintPipelinePropertyBag::AddProperty")

> AddProperty( [in, string] const wchar_t *pszName, [in] const VARIANT *pVar );

我们使用以下代码将字符串添加到属性包中。

```
CComVariant varProperty = CComBSTR(someString);
pPrintPropertyBag->AddProperty(L"SOME_PROPERTY", &varFilename); 
```

但是，很明显，所创建的 CComBSTR 和 CComVariant 会在一段时间后超出范围。我不确定 PropertyBag 是否处理字符串并制作自己的副本。因为我们可以在 VARIANT 中存储各种东西，所以不应该这样。

假设未处理字符串，我的问题是，在 COM 中执行此操作的模式是什么？我应该如何传递一个包含已分配字符串的 VARIANT，即使调用 AddProperty 的线程先死亡，也使该字符串可用于其他线程，并正确取消分配字符串？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-11-04T09:48:18.007

在大多数情况下，当您使用字符串或 VARIANT 调用 COM 函数时，唯一需要保证的是这些对象在整个调用过程中都可用。调用之后，对象本身负责制作数据的副本。例如，VARIANT 很可能会使用 VariantCopy 函数来复制字符串、复制 COM 对象（增加引用计数）。您唯一应该担心的是当您在 VARIANT 中传递实际接口时：在这种情况下，接口应该被正确地引用计数，并且 QueryInterface、AddRef 和 Release 都应该相应地实现。并且永远不要在引用计数达到 0 之前释放该对象；）

编辑：哦，如果您想了解有关 COM 编程的更多信息，请务必通过“Don Box”获得“Essential COM”。Don Box 是*COM*大师，那本书几乎可以教给你任何你想知道的关于 COM 的知识等等；）

# html - 如何在 IE 中动态更新 HTML“选择”框

> ID：261362
> 
> 赞同：1
> 
> 时间：2008-11-04T09:47:44.780
> 
> 标签：html, internet-explorer, html-select

我有一个 HTML“选择”元素，我正在使用如下代码动态更新它：

```
var selector = document.getElementById('selectorId');    
for (var i = 0; i < data.length; ++i)
{
  var opt = document.createElement('option');
  opt.value = data[i].id;
  opt.text = data[i].name;
  selector.appendChild(opt);
} 
```

在 Firefox 中运行良好，但 IE7 不会调整列表框的大小以适应新数据。如果列表框最初是空的（在我的情况下），您几乎看不到我添加的任何选项。有一个更好的方法吗？或者一种修补它以在 IE 中工作的方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-04T10:09:18.120

设置`innerHTML`选项对象的属性，而不是它们的`text`.

```
var selector = document.getElementById('selectorId');    
for (var i = 0; i < data.length; ++i)
{
  var opt       = document.createElement('option');
  opt.value     = data[i].id;
  opt.innerHTML = data[i].name;
  selector.appendChild(opt);
} 
```

在 IE6 上工作，刚刚测试过。不会在FF3上中断，所以我想就是这样。

*（我选择“innerHTML”是因为它可以跨浏览器使用。要设置文字文本，您必须在 IE 上使用“innerText”，在 FF 上使用“textContent”，您可能还必须在其他地方进行测试。只要有“name”属性中没有特殊字符（&、<、>），“innerHTML”就足够了。）*

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-04T10:33:58.290

您不需要为此操作 DOM。试试这个

```
var selector = document.getElementById('selectorId');  
for (var i = 0; i < data.length; ++i) {
    selector.options[selector.options.length] = new Option(data[i].name, data[i].id);
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-02-10T20:24:06.643

添加选项元素后，强制`select.style.width`到`auto`，即使它已经是`auto`。

如果这不起作用，请清除`select.style.width`然后`""`再次`select.style.width`恢复`auto`。

这使得 Internet Explorer 重新计算`select`元素的最佳宽度。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-04T11:19:50.147

明确设置选择框的宽度，例如使用。CSS 'width' 样式，而不是让浏览器从其内容中猜测宽度。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-11-04T09:59:49.263

您可以尝试从生成的 html 代码中替换整个 select 元素，或者作为 hack 从 DOM 中删除元素并读取它。

# vb.net - 如何使用“排序依据”对 LINQ-to-SQL 中继承类型的属性进行排序？

> ID：261366
> 
> 赞同：0
> 
> 时间：2008-11-04T09:48:31.580
> 
> 标签：vb.net, linq, linq-to-sql, inheritance

在我当前的 LINQ-to-SQL 项目中，我有一个相当标准的继承情况。我有一个名为“Party”的基类和继承自它的名为“Individual”和“Organisation”的类。

我想要实现的目标似乎（并且可能）相当简单。我想返回按公司名称排序的“组织”列表。问题是公司名称（“CoName”）字段是“组织”类的成员，而不是“党”类。

我当前的未排序查询是...

```
oClients = (From P In ERM.Parties Where TypeOf (P) Is Organisation) 
```

我想做的是这个...

```
oClients = (From P In ERM.Parties Where TypeOf (P) Is Organisation Order By CoName) 
```

...但当然这不起作用，因为“CoName”属性不是“Party”类的成员。

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-04T09:50:43.540

使用`OfType<>()`运算符：

```
ERM.Parties.OfType<Organisation>().OrderBy(p => p.CoName) 
```

# javascript - 在不使用 id 或 name 的情况下查找 a 中的 s 的数量

> ID：261368
> 
> 赞同：0
> 
> 时间：2008-11-04T09:49:34.137
> 
> 标签：javascript

你如何计算`<td>`特定元素的数量`<tr>`？

我没有指定 id 或 name 直接访问，我们必须使用这个`document.getElementsByTagName`概念。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-04T09:57:48.037

您可以使用以下内容：

```
var rowIndex = 0; // rowindex, in this case the first row of your table
var table = document.getElementById('mytable'); // table to perform search on
var row = table.getElementsByTagName('tr')[rowIndex];
var cells = row.getElementsByTagName('td');
var cellCount = cells.length;
alert(cellCount); // will return the number of cells in the row 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-04T10:02:54.857

document.getElementsByTagName 返回一个元素数组，因此您应该能够执行以下操作：

```
var totals = new Array();

var tbl = document.getElementById('yourTableId');
var rows = tbl.getElementsByTagName('tr');
for (var i = 0; i < rows.length; i++) {
    totals.push(rows[i].getElementsByTagName('td').length;
}

...

// total cells in row 1
totals[0];
// in row 2
totals[1];
// etc. 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-04T17:50:27.690

bobince 有正确的答案。我试图给他一些爱，但我是 0 代表的新手。

tr.cells.length 是获得所需内容的最快方法。

现在，假设您已经有了对 tr 的引用。如果您不这样做，则在某些时候您必须参考该表。在 DOM 中，table 元素有一个称为 rows 的数组（实际上是一个 HTMLCollection）。

```
table.rows[r].cells[c] 
```

将为您提供任何单元格的地址，其中 r = 行的索引，c = 该行中单元格的索引。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-04T09:59:55.050

就像是

```
var tot = 0;
var trs = document.getElementsByTagName("tr");
for (i = 0; i < trs.length; i++) {
    tds = trs[i].getElementsByTagName("td");
    tot += tds.length;
} 
```

最后，`tot`保存 tr 元素的所有 td 元素“儿子”的总数。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-04T10:03:53.687

```
var trs = document.getElementsByTagName('tr');
for(var i=0;i<trs.length;i++){
  alert("Number of tds in row '+(i+1)+' is ' + tr[i].getElementsByTagName('td').length);
} 
```

将提醒页面上每个 <tr> 中的 <td> 数量。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-04T10:30:50.513

如果使用[jQuery](http://www.jquery.com)库，应该就这么简单。

```
$("table tr:eq(0) > td").length 
```

你可以像 CSS3 一样使用任何东西作为选择器

```
$("#mytableid tr").eq(0).children("td").length 
```

将是另一种方法。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-04T11:04:25.000

```
tr.cells.length 
```

是一种更简单的拼写方式。

# c# - 使用c#枚举Excel工作簿中单元格的有效方法

> ID：261374
> 
> 赞同：2
> 
> 时间：2008-11-04T09:52:43.880
> 
> 标签：c#, excel, automation

枚举工作簿中每个工作表中每个单元格的最有效方法是什么？

下面的方法似乎适用于具有约 130,000 个单元格的工作簿。在我的机器上，打开文件大约需要 26 秒，枚举单元格大约需要 5 秒。但是，我不是 Excel 专家，我想在更广泛的社区中验证此代码片段。

```
DateTime timer = DateTime.Now;
Microsoft.Office.Interop.Excel.Application excelApplication = new Microsoft.Office.Interop.Excel.Application();
try
{
    exampleFile = new FileInfo(Path.Combine(System.Environment.CurrentDirectory, "Large.xlsx"));
    excelApplication.Workbooks.Open(exampleFile.FullName, false, false, missing, missing, missing, true, missing, missing, true, missing, missing, missing, missing, missing);
    Console.WriteLine(string.Format("Took {0} seconds to open file", (DateTime.Now - timer).Seconds.ToString()));

    timer = DateTime.Now;
    foreach(Workbook workbook in excelApplication.Workbooks)
    {
            foreach(Worksheet sheet in workbook.Sheets)
            {
            int i = 0, iRowMax, iColMax;
            string data = String.Empty;

            Object[,] rangeData = (System.Object[,]) sheet.UsedRange.Cells.get_Value(missing);

            if (rangeData != null)
            {
                iRowMax = rangeData.GetUpperBound(0);                       
                iColMax = rangeData.GetUpperBound(1);                                                       

                for (int iRow = 1; iRow < iRowMax; iRow++)
                {
                        for(int iCol = 1; iCol < iColMax; iCol++)
                    {
                        data = rangeData[iRow, iCol] != null ? rangeData[iRow, iCol].ToString() : string.Empty;
                        if (i % 100 == 0)
                        {
                            Console.WriteLine(String.Format("Processed {0} cells.", i));
                        }

                        i++;
                    }                                                                                                   
                }   
            }
        }

        workbook.Close(false, missing, missing);
    }

    Console.WriteLine(string.Format("Took {0} seconds to parse file", (DateTime.Now - timer).Seconds.ToString()));              
    }
    finally
    {
        excelApplication.Workbooks.Close();             
        excelApplication.Quit();                  
    } 
```

**编辑**：

值得说明的是，我想使用 PIA 和互操作来访问直接使用 Excel 文件的 API 未公开的 Excel 工作簿的属性。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-04T10:11:51.300

当您逐个单元格地做事时，Excel PIA Interop 真的很慢。

您应该选择要提取的范围，就像您对属性所做的那样，然后通过调用（或仅通过读取or属性，我不记得是哪一个）`Worksheet.UsedRange`一步读取整个范围的值它。`get_Value()``Value``Value2`

这将产生一个`object[,]`，即一个二维数组，它可以很容易地枚举并且可以快速读取。

**编辑**：我刚刚阅读了您的实际代码，并意识到它实际上符合我的建议。为在回答之前没有正确阅读问题而感到羞耻。在这种情况下，你不能让它更快。Excel PIA 互操作速度很慢。如果您需要更快的解决方案，您将不得不将 jExcelApi 从 Java 迁移到 C#（这不是一件非常困难的事情）或使用一些商业组件。我建议不惜一切代价避免使用 OLEDB 接口，以保持理智。

不相关但有用的提示：您应该使用 ?? 操作员。它真的很方便。代替

```
data = rangeData[iRow, iCol] != null ? rangeData[iRow, iCol].ToString() : string.Empty; 
```

你可以写

```
data = Convert.ToString(rangeData[iRow, iCol]) ?? string.Empty; 
```

在这种情况下，甚至 String.Empty 都不是必需的，因为[Convert.ToString(object)](http://msdn.microsoft.com/en-us/library/astxcyeh.aspx)无论如何都会 转换`null`为空字符串。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-04T10:57:50.707

[有一个名为Koogra](http://sourceforge.net/projects/koogra/)的 Excel 读取器和写入器的开源实现。它允许您读取 excel 文件并使用纯托管代码对其进行修改。这可能比您现在使用的代码快得多。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-04T10:37:56.660

我认为，这是最有效的方法，如何使用 PIA。使用“foreach”代替“for”可能会快一点，但不会发生巨大变化。

如果效率是您的主要目标，您应该直接使用 excel 文件 - 无需 excel 应用程序。

# mysql - 简单的 MySQL INSERT 错误

> ID：261375
> 
> 赞同：3
> 
> 时间：2008-11-04T09:52:49.590
> 
> 标签：mysql

毫无疑问，我在这里遗漏了一些非常简单的东西，但我看不到这个查询的问题，它产生了以下错误：

```
SQL query:

INSERT INTO ads(
    ad_id, author, ad_date, category, title,
    description, condition, price, fullname,
    telephone, email, status, photo, photothumb
)
VALUES (
    NULL , 'justal', '1225790938', 'Windsurf Boards',
    'test', 'test', 'Excellent', '12', 'test',
    'test', 'test', '', '', ''
);

MySQL said: Documentation
#1064 - You have an error in your SQL syntax; check
the manual that corresponds to your MySQL server version
for the right syntax to use near ''ad_id', 'author',
'ad_date', 'category', 'title', 'description',
'condition', '' at line 1 
```

有一双新眼睛的人能发现问题吗？

谢谢，艾尔。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-04T09:56:32.033

您不应该在列名中使用反引号而不是单引号吗？

```
INSERT INTO ads( `ad_id`, `author`, `ad_date`, `category`, `title`, `description`, `condition`, `price`, `fullname`, `telephone`, `email`, `status`, `photo`, `photothumb` )
VALUES (
NULL , 'justal', '1225790938', 'Windsurf Boards', 'test', 'test', 'Excellent', '12', 'test', 'test', 'test', '', '', ''
); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-04T10:19:54.760

可能是 CONDITION 是 mysql 关键字，并且不允许作为列名。

[http://dev.mysql.com/doc/refman/5.1/en/declare-conditions.html](http://dev.mysql.com/doc/refman/5.1/en/declare-conditions.html)

您绝对不需要 ' 或 `

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-04T09:56:52.827

单引号用于字符串文字。在 MySQL 中，默认情况下，双引号也用于字符串文字，尽管这与标准 SQL 不兼容，您应该在代码中坚持使用单引号。

对于列名，您通常根本不会引用它们。如果你需要 - 而你不需要 - 然后用反引号 (`) 引用它们，或者将其设置为严格的 ANSI 兼容模式 (ANSI_QUOTES) 并使用双引号。

# c++ - 使用 VC++ 2008 编译引用 STLport-5.1.4 的应用程序时出现 LNK2001 错误

> ID：261377
> 
> 赞同：2
> 
> 时间：2008-11-04T09:53:07.500
> 
> 标签：c++, visual-studio-2008, visual-c++, linker, stlport

我提前为这篇长文道歉......

当我们在 VS 菜单 > 工具 > 选项 > VC++ 目录 > 包含和库文件的目录下列出 STLPort 包含和库目录时，我曾经能够构建我们的 VC++ 解决方案（我们在 VS 2008 上）。但是，我们希望过渡到完全依赖 .vcproj 和 .sln 文件的构建过程。与必须在每台开发 PC 上单独配置的 VS 选项不同，这些可以检查到源代码控制中。我们通过将包含目录添加到每个项目的属性页 > 配置属性 > C/C++ > 常规 > 附加包含目录和库目录到链接器 > 常规 > 附加库目录来处理大多数库的转换。

不幸的是，这种方法不适用于 STLPort。我们在链接期间收到 LNK2019 和 LNK2001 错误：

```
Error   1   error LNK2019: unresolved external symbol "public: virtual bool __thiscall MyClass::myFunction(class stlp_std::basic_istream<char,class stlp_std::char_traits<char> > &,class MyOtherClass &,class stlp_std::basic_string<char,class stlp_std::char_traits<char>,class stlp_std::allocator<char> > &)const " (?myFunction@MyClass@@UBE_NAAV?$basic_istream@DV?$char_traits@D@stlp_std@@@stlp_std@@AAVSbprobScenarioData@@AAV?$basic_string@DV?$char_traits@D@stlp_std@@V?$allocator@D@2@@3@@Z) referenced in function _main MyLibrary.obj   

Error   5   error LNK2001: unresolved external symbol "public: static void __cdecl MyClass::myFunction(class stlp_std::basic_string<char,class stlp_std::char_traits<char>,class stlp_std::allocator<char> > const &,class stlp_std::basic_string<char,class stlp_std::char_traits<char>,class stlp_std::allocator<char> > const &,class stlp_std::basic_string<char,class stlp_std::char_traits<char>,class stlp_std::allocator<char> > const &,class stlp_std::basic_string<char,class stlp_std::char_traits<char>,class stlp_std::allocator<char> > const &,long,enum MyClass::MessageType,int,class stlp_std::basic_string<char,class stlp_std::char_traits<char>,class stlp_std::allocator<char> > const &)" (?myFunction@MyClass@@SAXABV?$basic_string@DV?$char_traits@D@stlp_std@@V?$allocator@D@2@@stlp_std@@000JW4MessageType@1@H0@Z)  MyLibrary.lib 
```

这发生在将可执行项目链接到作为库项目的依赖项时。奇怪的是，在链接库项目本身时不会发生这种情况。有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-26T19:23:23.457

正如其他答案中提到的，这是一个链接器错误，可能是库和应用程序使用不同选项编译的结果。已经有一些解决方案可以跟踪这个问题（目前其中一个作为选择的答案）。这些解决方案***将***起作用。但是，有一些工具可以**让您的搜索变得更加容易**。

对于初学者，了解修饰名称会有所帮助。在所有这些垃圾中，你会认出一些东西：**你的函数名**、**命名空间**、你正在使用的一些**类类型。**它们周围的所有这些字符对编译器都意味着什么，但你不需要编译器告诉你它们是什么。

> ## 输入 undname.exe：
> 
> * * *
> 
> *undname.exe <装饰名称>*
> 
> *   是一个简单的命令行程序，位于 VS bin 目录中。
> *   将装饰名称作为它的第一个参数。
> *   输出符号的人类可读格式。

有了这些知识，您现在可以继续为错误创建的符号找到合理的候选者。

首先，您可以按照其他地方的建议在十六进制编辑器中编辑您的库。但是，有一种更简单的方法可以找到符号。

> ## 输入dumpbin.exe：
> 
> * * *
> 
> *dumpbin.exe <开关> <库名称>*
> 
> *   是一个简单的命令行程序，位于 VS bin 目录中。
> *   需要一组开关和一个库来应用它们。
> *   从图书馆输出信息

您对问题感兴趣的开关是*/linkermember*。还有许多其他开关可以为您提供非常有趣的信息，但这个会列出库中的所有符号。

在这一点上，一点命令行知识会很好地为您服务。*grep*之类的工具确实可以缩短您的工作周期，但您可以通过重定向到文件并使用记事本等来解决问题。

由于我没有您的代码或库，我将从 TinyXML 设计一个示例。

假设您的错误消息是这样的：

```
Error   1       error LNK2019: unresolved external symbol "public: unsigned char __cdecl TiXmlComment::Accept(bool,class TiXmlVisitor *) " (?Accept@TiXmlComment@@ZBE_NPAVTiXmlVisitor@@@Z) referenced in function _main     MyLibrary.obj 
```

确定这是 TinyXML 中的一个函数后，我可以开始寻找不匹配的符号。我将从转储库的链接器成员开始。（注意这个开关是单数的，当我从记忆中输入它时，这总是让我明白！）

```
 >dumpbin /linkermember tinyxml.lib
Microsoft (R) COFF/PE Dumper Version 8.00.50727.762
Copyright (C) Microsoft Corporation.  All rights reserved.

Dump of file tinyxml.lib

File Type: LIBRARY

Archive member name at 8: /
4992E7BC time/date Wed Feb 11 08:59:08 2009
         uid
         gid
       0 mode
    B402 size
correct header end

    859 public symbols

    16292 ??$_Allocate@D@std@@YAPADIPAD@Z
    16292 ??$_Char_traits_cat@U?$char_traits@D@std@@@std@@YA?AU_Secure_char_traits_tag@0@XZ
    16292 ??$copy_s@U?$char_traits@D@std@@@_Traits_helper@std@@YAPADPADIPBDI@Z
    16292 ??$copy_s@U?$char_traits@D@std@@@_Traits_helper@std@@YAPADPADIPBDIU_Secure_char_traits_tag@1@@Z
    16292 ??$move_s@U?$char_traits@D@std@@@_Traits_helper@std@@YAPADPADIPBDI@Z
    16292 ??$move_s@U?$char_traits@D@std@@@_Traits_helper@std@@YAPADPADIPBDIU_Secure_char_traits_tag@1@@Z
    16292 ??$use_facet@V?$ctype@D@std@@@std@@YAABV?$ctype@D@0@ABVlocale@0@@Z
    16292 ??0?$_String_val@DV?$allocator@D@std@@@std@@IAE@V?$allocator@D@1@@Z
    16292 ??0?$_String_val@DV?$allocator@D@std@@@std@@QAE@ABV01@@Z 
```

这显然是太多的阅读，但我们不必，我们知道我们在寻找什么，所以我们只是寻找它。

```
 >dumpbin /linkermember tinyxml.lib | grep Accept
    529AE ?Accept@TiXmlComment@@UBE_NPAVTiXmlVisitor@@@Z
    529AE ?Accept@TiXmlDeclaration@@UBE_NPAVTiXmlVisitor@@@Z
    529AE ?Accept@TiXmlDocument@@UBE_NPAVTiXmlVisitor@@@Z
    529AE ?Accept@TiXmlElement@@UBE_NPAVTiXmlVisitor@@@Z
    529AE ?Accept@TiXmlText@@UBE_NPAVTiXmlVisitor@@@Z
    529AE ?Accept@TiXmlUnknown@@UBE_NPAVTiXmlVisitor@@@Z
        3 ?Accept@TiXmlComment@@UBE_NPAVTiXmlVisitor@@@Z
        3 ?Accept@TiXmlDeclaration@@UBE_NPAVTiXmlVisitor@@@Z
        3 ?Accept@TiXmlDocument@@UBE_NPAVTiXmlVisitor@@@Z
        3 ?Accept@TiXmlElement@@UBE_NPAVTiXmlVisitor@@@Z
        3 ?Accept@TiXmlText@@UBE_NPAVTiXmlVisitor@@@Z
        3 ?Accept@TiXmlUnknown@@UBE_NPAVTiXmlVisitor@@@Z 
```

这更容易阅读。查看我们的错误，我们正在寻找 TiXmlComment 的 Accept 函数。如果我们有很多匹配项（例如查看 stl 中的 size 函数！），我们可以为该名称另外 grep 输出，但在这种情况下，我们可以从列表中选择它。这是我们转向 undname 的地方：

```
 >undname ?Accept@TiXmlComment@@UBE_NPAVTiXmlVisitor@@@Z
Microsoft (R) C++ Name Undecorator
Copyright (C) Microsoft Corporation. All rights reserved.

Undecoration of :- "?Accept@TiXmlComment@@UBE_NPAVTiXmlVisitor@@@Z"
is :- "public: virtual bool __thiscall TiXmlComment::Accept(class TiXmlVisitor *)const " 
```

因此，在此示例中，我们的应用程序正在寻找一个返回**unsigned char**的函数，但库中有一个返回**bool**的函数。

这是一个人为的示例，但它说明了用于跟踪您的问题的技术。您可能正在寻找根据您的选项设置不同的 typedef 类型。

我遇到的问题是**time_t**。在我使用的一些库中，**time_t**使用 32 位类型作为其内部表示的一部分。这个库是用旧的编译器生成的，这是默认的。在 VS 2005 中，**time_t**默认使用 64 位类型。我必须添加预处理器定义**_USE_32BIT_TIME_T**才能编译。正如我所描述的那样，我准确地追踪了这个问题。

我希望这可以帮助某人解决这个问题！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-30T01:35:59.387

[Raymond Chen 最近在The Old New Thing](http://blogs.msdn.com/oldnewthing/archive/2008/12/29/9255240.aspx)上谈到了这一点——这些问题的一个原因是库是使用一组开关编译的，但您的应用程序使用的是不同的一组开关。你要做的是：

获取链接器正在寻找的确切符号。这将是一个可怕的错位名称。使用十六进制编辑器（IIRC，Visual Studio 将执行此操作）查看您链接到的 .lib 文件。找到几乎是链接器正在寻找的东西的符号，但不完全是。鉴于符号的差异，尝试找出哪些命令行开关会有所帮助。祝你好运——对于不习惯这类问题的人来说，解决方案可能需要几天时间才能弄清楚（！）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-15T21:00:21.900

这些链接错误表明*您的*应用程序中的某些类没有使用 STLPort 编译或已从构建中省略。他们并不建议您不链接 STLport。

我的猜测是：

*   MyClass 的构建设置以某种方式覆盖了包含路径的项目范围设置，因此 MyClass 是使用默认的 C++ STL 实现而不是 STLport 构建的。这应该很容易检查 - 对目标文件运行 dumpbin 并检查其中的函数是否引用了 stlp_* 命名空间中的标准库。如果不是，则编译器可能没有选择正确的包含路径。我还想看看 IDE 调用编译器的命令行。这些也可以通过 C/C++ 配置属性查看。
*   正如其他海报也提到的那样，MyClass 有可能没有被构建，但这应该很容易检查。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-21T15:37:24.437

您必须配置 STL 端口才能使用本机 IOStreams 实现。

还有你使用 STLPort 的任何具体原因吗？除非您尝试制作跨平台应用程序，否则建议使用默认的 STL 实现 - 即使在大多数情况下，它也不是真正需要的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-04T13:50:24.477

这是一个链接错误。它与您的包含路径无关。

您要么忘记将 MyClass.cpp 添加到项目中，要么忘记定义这两个函数。

“链接”库项目时未发生错误的原因是库项目未链接。它们只是一堆 OBJ，由 LIB 程序组合成一个库文件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-06T04:08:10.283

将库名称添加到要链接的其他库列表中。抱歉，我没有在最新版本的 VS 面前确切知道它的去向。

# installation - 阻止功能升级

> ID：261378
> 
> 赞同：0
> 
> 时间：2008-11-04T09:53:44.940
> 
> 标签：installation, installshield

我有一个自动创建 InstallShield 安装程序（InstallScript，而不是 MSI）的工具，而我目前的主要问题是，在升级安装时，我需要一种方法来防止功能被**升级**。在安装过程中，我想检查安装在目标系统上的 exe 文件的版本，并且据此，我希望能够从正在升级的文件集中排除特定功能。

我试图通过调用`FeatureSelectItem(feature, FALSE)`功能的`OnInstalling`事件处理程序来实现这一点，但这会导致整个功能被**卸载**，这不是我想要的。我只想从升级中排除该功能。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-19T18:01:11.360

如果安装的某些部分是独立版本控制/维护的，您可能需要为它们创建单独的安装。然后，您可以使用 InstallScript 作为引导程序，根据您的条件分别升级每个安装。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-06T20:38:00.500

根据 Acresso 的支持团队，这是不可能的。

# apache-flex - 如何在 Flex 3 中的图形上放置图像（例如 PNG）？

> ID：261386
> 
> 赞同：1
> 
> 时间：2008-11-04T09:58:29.470
> 
> 标签：apache-flex, actionscript-3

我是 Flex 的新手，我正在尝试编写一个简单的应用程序。我有一个带有图像的文件，我想在图形上显示这个图像。我该怎么做呢？我尝试 [Embed]-ding 并将其作为子组件添加到拥有 Graphics' 的组件中，但我收到“类型强制失败：无法转换 ... 到 mx.core.IUIComponent”错误。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-04T12:42:45.643

在我的脑海中，我能想到两件事可能会对你有所帮助（取决于你想要实现的目标）：

如果您只想显示您嵌入的图像，您可以将[Image](http://livedocs.adobe.com/flex/3/langref/mx/controls/Image.html)组件添加到舞台并将其值设置`source`为您要嵌入的图形资产 ( `Class`)：

```
[Bindable]
[Embed(source="assets/image.png")]
private var MyGfx:Class;

myImage.source = MyGfx; 
```

如果您真的想在对象上*绘制*位图`Graphics`，可以使用[beginBitmapFill()](http://livedocs.adobe.com/flex/3/langref/flash/display/Graphics.html#beginBitmapFill())方法：

```
[Bindable]
[Embed(source="assets/image.png")]
private var MyGfx:Class;

var myBitmap:BitmapData = new MyGfx().bitmapData;
myGraphics.beginBitmapFill(myBitmap);
myGraphics.endFill(); 
```

您可能会发现 Adob​​e 网站上的[Flex 快速入门](http://www.adobe.com/devnet/flex/quickstart/)文章很有用，尤其是[“嵌入资源”](http://www.adobe.com/devnet/flex/quickstart/embedding_assets/)部分。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2011-03-04T11:12:12.460

接受的答案是不完整的，因为如果不调用`drawRect()`任何内容，将不会被绘制。我已经以这种方式实现了它并且它有效。请注意，我添加了一个矩阵平移，否则图像必须在 0,0 处绘制，否则将被错误地裁剪。

```
[Embed(source='assets/land-field.png')] 
private var ImgField:Class; 
private var field:BitmapData = new ImgField().bitmapData;

public static function drawImage(g:Graphics, image:BitmapData, x:int, y:int):void {
  var mtx:Matrix = new Matrix();
  mtx.translate(x, y);
  g.beginBitmapFill(image, mtx, false, false);
  g.drawRect(x, y, image.width, image.height);
  g.endFill();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-04T14:08:59.387

您还可以将常规 AS3 显示对象添加到 Flex 组件，方法是将其添加到 rawChildren 集合 (myComponent.rawChildren.addChild(myPNG))，但这有点小技巧。

如果您尝试通过 myDisplayObject.graphics 执行此操作，请发布一些示例源。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-05T02:06:23.680

由于您是初学者，因此这里有一个简单的方法。

在您的应用程序中，切换到设计视图。

将图像组件从组件面板拖到主应用程序画布上。

在画布上调整图像大小并保持选中状态。在右侧的属性面板中，单击“源”字段上的文件夹按钮。

选择您的图像。如果您将图像放在项目的文件夹中，它将包含在您的构建文件夹中。

然后看一下源码视图。您将看到反映您所做工作的 MXML 代码。您也可以手动更改它。source="blah.png" 部分也可以指向一个远程 URL。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-08-18T22:06:11.223

好的，还有另一种方法，您可以按照 [http://livedocs.adobe.com/flex/3/langref/flash/display/Graphics.html#includeExamplesSummary](http://livedocs.adobe.com/flex/3/langref/flash/display/Graphics.html#includeExamplesSummary) 并使用 beginBitmapFill () 方法查看示例非常有用！

# methods - 在方法名称中使用“get”的最佳做法是什么？

> ID：261387
> 
> 赞同：8
> 
> 时间：2008-11-04T09:58:54.663
> 
> 标签：methods, getter, names

我注意到在 Java（包括 C#）的许多地方，许多“getter”方法都以“get”为前缀，而许多其他方法则没有。我从未注意到 Sun 似乎遵循的任何模式。在 getter 方法名称中使用“get”的一些准则或规则是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-04T10:37:53.447

它归结为语义。是的，C# 具有“属性”，它为您提供了一个 get/set 'method' 存根......但是 .NET Framework 中以“Get”开头的函数（......“方法”......）应该是线索开发人员意识到某些操作仅出于获得某些结果的目的而发生。

你可能会觉得这很奇怪，然后说“为什么不直接使用返回类型来提示人们呢？”，答案很简单。考虑以下方法：

```
public Person CreatePerson(string firstName, string lastName) {...} 
```

仅通过该方法的名称，您可能会想到将涉及数据库活动，然后将返回一个新创建的“人”。

但是，这个呢：

```
public Person GetPerson(string firstName, string lastName) {...} 
```

仅凭*该*方法的名称，您就可以假设正在从数据库中 100% “安全”地检索人员。

您永远不会多次调用“CreatePerson”......但您*应该*始终安全地调用“GetPerson”。（它不应该影响应用程序的“状态”）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-13T01:35:25.900

我个人喜欢以下规则：

*   `get`只要值可以通过相应的`set`方法直接修改，就使用前缀
*   `get`在值无法直接设置为属性的情况下删除前缀（即没有等效的 setXXX 方法）

第二种情况的基本原理是，如果该值不是真正的用户可设置的“属性”，那么它不应该需要一对 get/set 方法。一个暗示是，如果遵循此约定并且您看到 getXXX 方法，那么您也可以假设存在 setXXX 方法。

例子：

*   `String.length()`- 由于字符串是不可变的，因此长度是只读值
*   `ArrayList.size()`- 添加或删除元素时大小会发生变化，但不能直接设置

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-04T10:01:55.343

Java中的“get”和“set”前缀对最初用作表示java bean的约定。后来，它变成了一种封装约定，因为 Java 与 C# 不同，没有适当的属性。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-04T10:49:08.337

**Java**中的最佳实践是对属性使用 get 和 set 前缀。

框架、标签库等将寻找带有这些前缀的方法并将它们用作属性。

所以，如果你有一个像这样的java类......

```
public class User{
    private String name;
    public String getName(){ return name;}
    public void setName(String name){ this.name = name; }
} 
```

.. 使用 struts-tags（或任何其他基于 ognl 的标签库），您将使用 .name 访问 name 属性`user.name`。

Spring 框架也在 xml 配置文件中使用此约定。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-04T10:10:05.373

Java（还）不支持属性。Getter 和 setter 是解决这个问题的障碍。其他语言 - 包括 C# - 支持属性，您应该使用这些来代替。这也不仅仅是一个“最佳实践”：C# 中的序列化将依赖于属性，而不是 getter 和 setter，因此如果您需要序列化类，将来不使用属性可能会导致各种问题。

属性的优点是它们使代码更具可读性。就像是

```
obj.setX(10); 
```

在 Java 中，变成

```
obj.X = 10; 
```

然而在幕后，X 是一种方法，而不是一个变量，因此可以执行脏输入检查等。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-04T10:19:40.207

过去，API 经常暴露只读属性而不带`get`前缀：当然是这样的[`String.length()`](http://java.sun.com/javase/6/docs/api/java/lang/String.html#length())，甚至更新[`Buffer.capacity()`](http://java.sun.com/javase/6/docs/api/java/nio/Buffer.html#capacity())的也是合理的例子。

这样做的好处是涉及的绒毛较少。缺点是任何试图根据约定自动确定属性的东西都不会发现它们。就我个人而言，我*倾向于*在包含前缀方面犯错。

当然，在 C# 中，这几乎是无关紧要的，因为无论如何都有“真实”的属性 :)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-11T15:07:01.060

这取决于。它通常是冗余信息，即使在没有属性的语言中也是如此。

在 C++ 中，通常提供 Attr() 函数的两个重载，而不是 getAttr()/setAttr() 对： void Attr(Foo f); // 设置器 Foo Attr(); // 吸气剂

在 Java 中，通常的做法是为 get/set 添加前缀。我不得不说最好的做法是使用你的语言的标准。在 Java 中，人们希望看到 get/set 前缀，因此省略它们可能会使人们感到困惑，即使它们并不是绝对必要的。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-18T13:58:19.150

只是一个简短的附录：另一个约定是布尔字段的 getter 以“is”而不是“get”为前缀，例如`bool isEnabled() { return enabled; }`

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-04T10:23:46.220

Objective C 2.0 也使用属性，使用相同的点语法。

在此之前，它对 getter 和 setter 使用了稍微不同的命名方案（当然，它仍然可以与属性一起使用，或者用于普通的旧属性）。

```
value = [obj attr];

[obj setAttr:value];

[obj getAttr:&value]; 
```

也就是说，get 以不同的方式使用。它不返回值，而是将结果存储在传入的变量中。

典型的 getter 与属性同名，setter 是以 set 为前缀的属性（根据 Java 的约定）。KVO（Key-Value Observation）系统使用这些约定，因此应遵守。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-08-30T14:33:20.740

13 年后，我相信这个问题值得重新审视。当然，随着时间的推移，有很多 stackoverflow 问答（甚至这里有一些很好的答案）、文章和博客文章都得出了相同的结论，但我认为，最后，我们从 Brian Goetz 本人那里得到了一个相当直截了当的答案：

> “JavaBeans 命名约定* 有点不幸，”他继续说道。“对于通用开发来说，这是一个糟糕的惯例。这是在可视化编辑器中命名可视化组件的一个相当有针对性的约定，您可以在其中将按钮和标签以及类似的东西拖放到画布上，并且您可以编辑关于前景色和字体以及什么的属性表有你，可以通过反思发现。”</p>
> 
> Goetz 解释说，命名约定是构建这些 UI 组件的好方法——事实证明，这并不是一个关键的 Java 用例。“然而，不知何故，我们继续使用该命名约定，尽管它与大多数业务域对象的匹配度很差。”</p>

– [https://blogs.oracle.com/javamagazine/java-architects-loom-panama-valhalla#anchor_4](https://blogs.oracle.com/javamagazine/java-architects-loom-panama-valhalla#anchor_4)

`*` – 基本上，有问题的`getX`/`setX`约定

# svn - TFS2005 中是否有 SVN:externals 等效项？

> ID：261392
> 
> 赞同：4
> 
> 时间：2008-11-04T10:00:29.467
> 
> 标签：svn, version-control, visual-studio-2005, tfs

有人知道 TFS2005 中是否有等效的 SVN:externals 属性吗？

**SVN 外部属性的定义**

有时构建一个由许多不同的结帐组成的工作副本很有用。例如，您可能希望不同的子目录来自存储库中的不同位置，或者可能完全来自不同的存储库。您当然可以手动设置这样的场景来创建您想要实现的那种嵌套工作副本结构。但是，如果此布局对使用您的存储库的每个人都很重要，那么每个其他用户都需要执行与您所做的相同的检出操作。

Subversion 提供对外部定义的支持。外部定义是本地目录到版本化资源的 URL（可能是特定修订版）的映射。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-04T12:35:16.300

TFS 2005 中没有等效的功能。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-23T00:36:21.743

正如杰夫所说，这在 2005 年是不可能的，对于 2008 年和 2010 年的当前测试版也是如此

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-23T10:28:36.183

[TFS2008 电动工具](http://msdn.microsoft.com/en-us/teamsystem/bb980963.aspx)中的工作区模板功能是否提供您所追求的功能？

来自[Brian Harry 的博客](http://blogs.msdn.com/bharry/archive/2008/10/01/preview-of-the-next-tfs-power-tools-release.aspx)：

> Create Workspace 可以解决以下问题。有人新加入您的团队并想开始处理源代码。他们需要在他们的机器上得到这一切，但他们不确定他们需要的所有资源或布局方式。作为团队定义的一部分，您可以为您的团队定义工作区模板。

希望有帮助，

马丁。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-23T14:00:33.240

No - there is no equivalent functionality inherent in TFS - which in my mind is its premier limitation. However, the feature that Martin mentioned, Workspace Templating, implemented in the Oct '08 release of TFS Power Tools does look like it would accomplish something similar - unfortunately it did not exist when we migrated to TFS, which caused us a lot of pain. Let us know if it works for you.

# sql - 在 SQL Server 中使用动态名称访问另一个数据库

> ID：261405
> 
> 赞同：4
> 
> 时间：2008-11-04T10:07:11.480
> 
> 标签：sql, sql-server, sql-server-2005

SQL Server 2005 中有两个数据库：一个名为“A”，另一个名为“A_2”。“A”是用户输入的变量名，第二个数据库的“_2”前缀始终是已知的。（因此数据库可以是“MyDB”和“MyDB_2”等）

如何在不知道实际名称且不使用“exec”语句的情况下从存储过程中访问其他数据库？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-04T10:48:44.563

您可以尝试使用新的 SQL Server 2005 功能，称为同义词。

您需要[CREATE SYNONYM](http://msdn.microsoft.com/en-us/library/ms177544.aspx)，然后使用同义词编译并保存存储过程。这将使您有可能在以后“即时”更改同义词。显然，仍然需要将 CREATE SYNONYM 代码作为动态 SQL 运行。

要运行 CREATE SYNONYM，用户必须被授予相应的权限，或者具有 ALTER SCHEMA 权限。在你走这条路之前，一定要阅读更多关于同义词的信息，有一些附加条件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-04T10:23:03.070

我不认为这是可能的。

该名称是一个变量，您不能将变量用作数据库名称。

因此，唯一的方法是将整个命令放入一个字符串并执行它，这是您希望避免的。

整件事的目的是什么？如果您在逻辑上命名数据库，但在某处存储您的逻辑和用户输入的名称之间的链接，会发生什么？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-21T16:43:02.477

我所做的是为我想要访问的每个表创建一个视图（大概架构是相同的），然后我的后续代码只是引用了这些视图。例如

```
if object_id('view_Table1') is not null
    drop view view_Table1

dim @cmd nvarchar(max)

set @cmd = 'create view view_Table1 as select * from ' + @DbName + '.dbo.Table1'

exec sp_executesql @cmd

select WhateverColumn from view_Table1 
```

# java - 在 Hibernate 中映射多级继承

> ID：261407
> 
> 赞同：7
> 
> 时间：2008-11-04T10:07:51.870
> 
> 标签：java, hibernate, inheritance, orm

目前我有这样的结构：

```
A
|
+--B
|
+--C 
```

它使用连接表映射到每个子类一个表。由于历史原因，我也使用了鉴别器，因此目前的情况如[Hibernate 手册第 9.1.3 节所述](http://www.hibernate.org/hib_docs/v3/reference/en-US/html/inheritance.html#inheritance-tablepersubclass-discriminator)。

**问题：**如何扩展这样的结构的映射：

```
A
|
+--B
|  |
|  D
|
+--C 
```

我可以`<subclass>`在`<subclass>`休眠映射中吗？我需要什么`<key>`？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-04T17:41:52.233

***未经测试***，但根据您发布的链接，如果您使用的是 hibernate3

```
<hibernate-mapping>
  <class name="A" table="A">
    <id name="id" type="long" column="a_id">
      <generator class="native"/>
    </id>
    <discriminator column="discriminator_col" type="string"/>
    <property name="" type=""/>
    <!-- ... -->
  </class>
  <subclass name="B" extends="A" discriminator-value="B">
    <!-- ... -->
  </subclass>
  <subclass name="D" extends="B" discriminator-value="D">
    <!-- ... -->
  </subclass>
  <subclass name="C" extends="A" discriminator-value="C">
    <!-- ... -->
  </subclass>
</hibernate-mapping> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-12-13T12:04:22.190

使用 Annotations 可以做到以下几点：

```
@Entity
@Inheritance(strategy = InheritanceType.JOINED)
@DiscriminatorColumn(name="LoanType",discriminatorType="String")
@Table(name = "A")
public class A implements Serializable{
}

@Entity
@Table(name= "B")
@PrimaryKeyJoinColumn(name = "B_ID", referencedColumnName ="A_ID")
public class B extends A{
}

@Entity
@Table(name= "C")
@PrimaryKeyJoinColumn(name = "C_ID", referencedColumnName = "B_ID")
public class C extends B{} 
```

# java - 我需要用 Java+OpenGL 构建哪些 Ubuntu/Debian 软件包？

> ID：261408
> 
> 赞同：4
> 
> 时间：2008-11-04T10:08:37.653
> 
> 标签：java, opengl, ubuntu, clojure, jogl

我想使用 JOGL（用于 Clojure，而不是 Java）。JDK 和 OpenGL 绑定的替代方案似乎有很多组合，我不想使用散弹枪方法并堵塞我的机器安装太多杂物。请帮助我开始！

*   我需要安装哪些 Ubuntu/Debian 软件包？（例如以 开头`sun-java6-jdk`）
*   似乎没有 JOGL 包，那么安装它的最佳方法是什么？我应该从 CVS HEAD 构建，还是使用预构建的 jar 文件？

我将使用 Emacs 作为我的 IDE，所以我不需要安装 Eclipse 或任何东西，我只需要能够使用 ant 或其他东西进行构建。

请随时修改您的答案（基于其他人的答案）以提供全面的操作方法。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-06T20:19:57.107

从 Ubuntu 8.10 (intrepid) 开始，JOGL 已经被打包 ( [**libjogl-java**](http://packages.ubuntu.com/intrepid/libjogl-java) )。最好选择的 JDK 应该是**openjdk-6-jdk**，因为它在 main 中（=由 Ubuntu 的核心团队支持），因为它非常强大，并且无论如何都源自 Sun 的专有 JDK6。

无畏，只是运行

```
sudo apt-get install -y ant openjdk-6-jdk libjogl-java 
```

应该让你开始。在旧版本上，您必须省略 libjogl-java，手动安装所有[依赖](http://packages.ubuntu.com/intrepid/libjogl-java)项（所有有红色圆圈的）并构建 JOGL（下载、解包、ant）。

# c - 在 ARM C 调用约定中要保存哪些寄存器？

> ID：261419
> 
> 赞同：61
> 
> 时间：2008-11-04T10:16:46.967
> 
> 标签：c, assembly, arm, calling-convention, function-call

自从我上次编写 arm assembler 以来已经有一段时间了，我对细节有点生疏了。如果我从 arm 调用 C 函数，我只需要担心保存 r0-r3 和 lr，对吗？

如果 C 函数使用任何其他寄存器，它是否负责将这些寄存器保存在堆栈上并恢复它们？换句话说，编译器会为 C 函数生成代码来执行此操作。

例如，如果我在汇编函数中使用 r10，我不必将其值压入堆栈或内存，并在 C 调用后弹出/恢复它，对吗？

这适用于 arm-eabi-gcc 4.3.0。

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2008-11-04T10:46:02.167

这取决于您正在编译的平台的[ABI](http://en.wikipedia.org/wiki/Application_binary_interface)。在 Linux 上，有两个 ARM ABI；旧的和新的。AFAIK，新的（EABI）实际上是ARM的AAPCS。完整的 EABI 定义目前[位于 ARM 的信息中心](http://infocenter.arm.com/help/topic/com.arm.doc.subset.swdev.abi/index.html)。

来自[AAPCS，§5.1.1](http://infocenter.arm.com/help/topic/com.arm.doc.ihi0042f/IHI0042F_aapcs.pdf)：

*   **r0-r3**是参数和暂存寄存器；**r0-r1**也是结果寄存器
*   **r4-r8**是被调用者保存寄存器
*   **r9**可能是被调用者保存寄存器，也可能不是（在 AAPCS 的某些变体中，它是一个特殊寄存器）
*   **r10-r11**是被调用者保存寄存器
*   **r12-r15**是特殊寄存器

被调用者必须保存被调用者保存寄存器（与调用者保存寄存器相反，调用者保存寄存器）；因此，*如果*这是您正在使用的 ABI，您不必在调用另一个函数之前保存 r10（另一个函数负责保存它）。

**编辑：**您使用的编译器没有区别；特别是 gcc 可以为几个不同的 ABI 配置，甚至可以在命令行上进行更改。查看它生成的序言/尾声代码并不是那么有用，因为它是为每个函数量身定制的，*并且*编译器可以使用其他方式来保存寄存器（例如，将其保存在函数中间）。

* * *

术语：“callee-save”是“non-volatile”或“call-preserved”的同义词：[什么是被调用者和调用者保存的寄存器？](https://stackoverflow.com/questions/9268586/what-are-callee-and-caller-saved-registers/56178078#56178078)
在进行函数调用时，您可以假设 r4-r11（可能除了 r9）中的值在（调用保留）之后仍然存在，但对于 r0-r3（调用破坏/易失性）则不然。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2011-03-29T04:44:50.660

## 32 位 ARM 调用约定由[AAPCS指定](http://infocenter.arm.com/help/topic/com.arm.doc.ihi0042f/IHI0042F_aapcs.pdf)

从[AAPCS](http://infocenter.arm.com/help/topic/com.arm.doc.ihi0042f/IHI0042F_aapcs.pdf) §5.1.1 核心寄存器：

*   **r0-r3**是参数和暂存寄存器；**r0-r1**也是结果寄存器
*   **r4-r8**是被调用者保存寄存器
*   **r9**可能是被调用者保存寄存器，也可能不是（在 AAPCS 的某些变体中，它是一个特殊寄存器）
*   **r10-r11**是被调用者保存寄存器
*   **r12-r15**是特殊寄存器

从 AAPCS，§5.1.2.1 VFP 寄存器使用约定：

*   **s16–s31 (d8–d15, q4–q7)**必须保留
*   **s0–s15 (d0–d7, q0–q3)**和**d16–d31 (q8–q15)**不需要保留

原帖：
[arm-to-c-calling-convention-neon-registers-to-save](https://stackoverflow.com/questions/5288390/arm-to-c-calling-convention-neon-registers-to-save/5288449)

## 64 位 ARM 调用约定由[AAPCS64指定](https://github.com/ARM-software/software-standards/blob/master/abi/aapcs64/aapcs64.rst)

[通用寄存器](https://github.com/ARM-software/software-standards/blob/master/abi/aapcs64/aapcs64.rst#general-purpose-registers)部分指定需要保留哪些寄存器。

*   **r0** - **r7**是参数/结果寄存器
*   **r9** - **r15**是临时寄存器
*   **r19** - **r28**是被调用者保存的寄存器。
*   所有其他（**r8**，**r16** - **r18**，**r29**，**r30**，**SP**）具有特殊含义，有些可能被视为临时寄存器。

[SIMD 和浮点寄存器](https://github.com/ARM-software/software-standards/blob/master/abi/aapcs64/aapcs64.rst#simd-and-floating-point-registers)指定了 Neon 和浮点寄存器。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2015-04-13T10:23:23.507

**对于 64 位 ARM，A64**（来自 ARM 64 位架构的过程调用标准）

A64 指令集有 31 个 64 位通用（整数）寄存器；这些标记为**r0-r30**。在 64 位上下文中，这些寄存器通常使用名称**x0-x30**来引用；在 32 位上下文中，寄存器是使用**w0-w30**指定的。此外，堆栈指针寄存器**SP**可以与有限数量的指令一起使用。

*   **SP**堆栈指针
*   **r30** LR 链接寄存器
*   **r29** FP 帧指针
*   **r19…r28**被调用者保存的寄存器
*   **r18**平台注册（如果需要）；否则为临时寄存器。
*   **r17** IP1 第二个intra-procedure-call临时寄存器（可以被调用单板和PLT代码使用）；在其他时候可以用作临时寄存器。
*   **r16** IP0 第一个intra-procedure-call临时寄存器（可以被调用胶合和PLT代码使用）；在其他时候可以用作临时寄存器。
*   **r9…r15**临时寄存器
*   **r8**间接结果位置寄存器
*   **r0…r7**参数/结果寄存器

前八个寄存器**r0-r7**用于将参数值传递给子例程并从函数返回结果值。它们也可用于在例程中保存中间值（但通常仅在子例程调用之间）。

寄存器**r16 (IP0)**和**r17 (IP1)**可以被链接器用作例程和它调用的任何子例程之间的临时寄存器。它们也可以在例程中用于保存子例程调用之间的中间值。

寄存器**r18**的作用是特定于平台的。如果平台 ABI 需要一个专用的通用寄存器来承载过程间状态（例如，线程上下文），那么它应该为此目的使用该寄存器。如果平台 ABI 没有这样的要求，那么它应该使用 r18 作为额外的临时寄存器。平台 ABI 规范必须记录此寄存器的使用。

**SIMD**

ARM 64 位架构还有另外 32 个寄存器**v0-v31**，可供 SIMD 和浮点运算使用。寄存器的准确名称会随着访问的大小而改变。

**注意：**与 AArch32 不同，在 AArch64 中，SIMD 和浮点寄存器的 128 位和 64 位视图不会在更窄的视图中与多个寄存器重叠，**因此 q1、d1 和 s1 都指寄存器中的相同条目银行。**

前八个寄存器**v0-v7**用于将参数值传递给子例程并从函数返回结果值。它们也可用于在例程中保存中间值（但通常仅在子例程调用之间）。

寄存器**v8-v15**必须由被调用者跨子例程调用保留；剩余的寄存器（**v0-v7, v16-v31**）不需要保留（或应该由调用者保留）。此外，只需要保留存储在**v8-v15**中的每个值的低 64 位；调用者有责任保留更大的值。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2013-08-13T17:45:12.897

CesarB 和 Pavel 的回答提供了 AAPCS 的引述，但未解决的问题仍然存在。被调用者是否保存 r9？r12呢？r14呢？此外，答案非常笼统，并没有按照要求专门针对 arm-eabi 工具链。这是一种实用的方法来找出哪些寄存器是被调用者保存的，哪些不是。

下面的 C 代码包含一个内联汇编块，它声称修改寄存器 r0-r12 和 r14。编译器将生成代码以保存 ABI 所需的寄存器。

```
void foo() {
  asm volatile ( "nop" : : : "r0", "r1", "r2", "r3", "r4", "r5", "r6", "r7", "r8", "r9", "r10", "r11", "r12", "r14");
} 
```

使用命令行`arm-eabi-gcc-4.7 -O2 -S -o - foo.c` 并为您的平台添加开关（`-mcpu=arm7tdmi`例如）。该命令将在 STDOUT 上打印生成的汇编代码。它可能看起来像这样：

```
foo:
    stmfd   sp!, {r4, r5, r6, r7, r8, r9, sl, fp, lr}
    nop
    ldmfd   sp!, {r4, r5, r6, r7, r8, r9, sl, fp, lr}
    bx  lr 
```

请注意，编译器生成的代码会保存并恢复 r4-r11。编译器不保存 r0-r3、r12。它恢复 r14（别名 lr）纯属偶然，因为我从经验中知道退出代码也可能将保存的 lr 加载到 r0 中，然后执行“bx r0”而不是“bx lr”。通过添加`-mcpu=arm7tdmi -mno-thumb-interwork`或使用，`-mcpu=cortex-m4 -mthumb`我们获得稍微不同的汇编代码，如下所示：

```
foo:
    stmfd   sp!, {r4, r5, r6, r7, r8, r9, sl, fp, lr}
    nop
    ldmfd   sp!, {r4, r5, r6, r7, r8, r9, sl, fp, pc} 
```

同样，r4-r11 被保存和恢复。但是 r14（别名 lr）没有恢复。

总结一下：

*   r0-r3*不是*被调用者保存的
*   r4-r11 被调用者保存
*   r12（别名 ip）*不是*被调用者保存的
*   r13（别名 sp）是被调用者保存的
*   r14（别名 lr）*不是*被调用者保存的
*   r15（别名 pc）是程序计数器，在函数调用之前设置为 lr 的值

这至少适用于 arm-eabi-gcc 的默认值。有一些命令行开关（特别是 -mabi 开关）可能会影响结果。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-07-13T14:46:20.630

至少在 Cortex M3 架构上，函数调用和中断也存在差异。

如果发生中断，它将自动将 R0-R3、R12、LR、PC 压入堆栈，并在从 IRQ 返回时自动 POP。如果您在 IRQ 例程中使用其他寄存器，则必须手动将它们推送/弹出到堆栈中。

我不认为这种自动 PUSH 和 POP 是为函数调用（跳转指令）而制作的。如果约定说 R0-R3 只能用作参数、结果或暂存寄存器，则无需在函数调用之前存储它们，因为在函数返回之后不应再使用任何值。但是与在中断中一样，如果您在函数中使用它们，则必须存储所有其他 CPU 寄存器。

# iis - 通过脚本启动特定的 iis 6.0 网站

> ID：261420
> 
> 赞同：1
> 
> 时间：2008-11-04T10:17:03.723
> 
> 标签：iis, iis-6

我用谷歌搜索，找不到明确的答案。

我只是想通过一个将在启动时运行的脚本来启动我的一些 iis 6.0 网站。

有人对此有任何提示吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-04T10:44:09.313

好吧，我已经用谷歌搜索了，[这就是我发现](http://windowsitpro.com/article/articleid/22971/iis-scripting-solutions.html)的。片段：

```
cd \inetpub\adminscripts    
Cscript.exe adsutil.vbs START_SERVER W3SVC/1 
```

# visual-studio - VisualStudio：如何将 obj 文件夹保存在其他位置

> ID：261422
> 
> 赞同：57
> 
> 时间：2008-11-04T10:17:48.587
> 
> 标签：visual-studio, build-process

有谁知道在构建解决方案时如何告诉 VS(2008) 在哪里保存 obj 文件夹？我们让它将 bin 文件夹保存到另一个路径，以使源文件文件夹保持较小（即可通过电子邮件发送），但找不到任何方法告诉它对 obj 执行相同操作...

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2008-11-04T10:25:49.743

使用`BaseIntermediateOutputPath`项目文件（ 、 等）中的属性`.csproj`，`.vbproj`如[http://msdn.microsoft.com/en-us/library/bb629394.aspx](http://msdn.microsoft.com/en-us/library/bb629394.aspx)中所述。您必须使用文本编辑器手动编辑 XML 文档，然后在 Visual Studio 中重新加载它。它可能仍会创建`obj`文件夹（这是一个已知的错误），但会将其留空并将实际`obj`文件放在您指定的文件夹中。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2010-09-10T18:15:06.487

1.  您将其添加到 <OutputPath> 标记下的项目文件中：

    ```
    <IntermediateOutputPath>..\Whatever\obj\</IntermediateOutputPath> 
    ```

2.  VS 仍会创建 obj 文件夹，因此每次构建后都必须将其删除。这可以通过将以下脚本放入 VS 的后期构建部分来完成：

    ```
    rd "$(ProjectDir)obj" /S /Q 
    ```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-04T10:33:08.963

你使用版本控制吗？如果你这样做，还有一个替代方案：

您可以从版本控制中[排除](http://svnbook.red-bean.com/en/1.5/svn.advanced.props.special.ignore.html)bin/ 和 obj/ 并签出您的项目而不是通过电子邮件发送。如果您使用[Subversion](http://subversion.tigris.org/)，您还可以[导出](http://svnbook.red-bean.com/en/1.5/svn.ref.svn.c.export.html)您的项目并通过电子邮件发送导出和压缩的文件夹。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-04T10:21:58.860

它是项目设置的“*属性”>“常规*”下的“*输出目录”。*

 ****编辑***：本地 C++ 项目（我正在使用）和基于 CLR 的项目（可能是 OP 所指的）的项目设置之间似乎存在差异。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2021-01-14T21:18:29.277

在 Visual Studio 2013 中，这是在项目“配置属性/常规/中间目录”中指定的。

[![在此处输入图像描述](https://i.stack.imgur.com/Tb2F5.png)](https://i.stack.imgur.com/Tb2F5.png)

# asp.net - ASP.net 中的事件处理

> ID：261423
> 
> 赞同：1
> 
> 时间：2008-11-04T10:18:39.773
> 
> 标签：asp.net

我们如何在asp.net中处理按键事件

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-04T10:30:29.857

大概你的意思是从网站本身。ASP.NET 不支持此功能，您需要[使用 javascript 捕获按键，](http://docs.jquery.com/Events/keypress)然后通过[ajax](http://ferry.ferryandtheria.com/?p=3)或[轻量级回调](http://www.developer.com/net/asp/article.php/3485991)将其发送到 ASP.NET 。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-04T10:30:33.540

您必须在 Javascript 中处理这个客户端，然后要么回发页面，要么调用 Ajax 方法来做某事。

例如，以下代码覆盖了一个文本框，因此`Enter`不会提交它：

```
<asp:TextBox 
    runat="server" 
    onKeyPress="if (event.keyCode == 13) return false;" /> 
```

这是一个非常简单的调用 - 如果您打算做更复杂的事情，请查看 JQuery 等专用 Javascript 库。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-04T10:31:24.160

您可以使用 javascript 在客户端处理它：

```
myTextBox.Attributes["OnKeyPress"] = "javascript function call;"; 
```

您可以使用 OnKeyUp 以获得更好的浏览器兼容性和处理能力。

您还可以在服务器端处理类似的事情：

```
<asp:TextBox runat="server" ID="ole" ontextchanged="ole_TextChanged" AutoPostBack="true"></asp:TextBox>

protected void ole_TextChanged(object sender, EventArgs e)
{
    // Do stuff
} 
```

然而，这只在你离开现场时才会触发，无论如何我不会推荐它，因为它每次都使用回发。

无论如何，解决方案是使用 javascript。它可以是简单的 javascript 或 AJAX。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-04T10:29:37.143

这取决于你的情况。在大多数情况下，您必须在 javascript 中处理按键事件，并以某种方式将该事件传播到服务器端。考虑修改您的问题以包含更多背景。

# java - 阻止 JTree 选择更改发生的最佳方法是什么？

> ID：261424
> 
> 赞同：4
> 
> 时间：2008-11-04T10:19:09.320
> 
> 标签：java, swing, design-patterns, error-handling

I have a dialog where each entry in a JTree has its corresponding options in a different panel, which is updated when the selection changes. 如果其中一个条目的选项设置为无效状态，当用户尝试更改为树中的不同条目时，我希望出现一个错误对话框并且选择不更改。

我尝试在 JTree 上使用 valueChangeListener 执行此操作，但目前如果出现错误，则必须让 valueChanged 方法对旧选择调用“setSelectionRow”。为了避免 StackOverflow，我在执行此操作之前将布尔值“isError”设置为 true，以便忽略新的 valueChanged 事件。不知何故，我有直觉认为这不是最好的解决方案。;-)

我该怎么做呢？对于这种情况，有没有好的设计模式？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-22T01:19:31.003

我没有找到更好的方法，但这种方法对我来说很好。我知道在 Delphi 中这是一个非常方便的事件：“在更改选择之前”您可以很容易地停止更改选择。

这是我的防止无限递归问题的java代码

```
 navTree.addTreeSelectionListener(new TreeSelectionListener() {

        boolean treeSelectionListenerEnabled = true;

        public void valueChanged(TreeSelectionEvent e) {
            if (treeSelectionListenerEnabled) {
                if (ok to change selection...) {
                    ...
                } else {
                    TreePath treePath = e.getOldLeadSelectionPath();
                    treeSelectionListenerEnabled = false;
                    try {
                        // prevent from leaving the last visited node
                        navTree.setSelectionPath(treePath);
                    } finally {
                        treeSelectionListenerEnabled = true;
                    }
                }
            }
        }
    }); 
```

永远记得删除您添加的所有侦听器，以防止内存泄漏。

这是另一种方法：

```
private class VetoableTreeSelectionModel extends DefaultTreeSelectionModel {
    public void setSelectionPath(TreePath path){
        if (allow selection change?) {
            super.setSelectionPath(path);
        }
    }
}
{
    navTree.setSelectionModel(new VetoableTreeSelectionModel());
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-04T10:42:55.603

不确定这是最佳实践，但也许您可以在要验证的组件上放置一个 FocusListener ...在调用事件时调用您的验证，然后如果您不希望移动焦点，则使用该事件因为验证失败？

后期编辑：

至少对于 java 8（我没有检查早期版本），这个解决方案不起作用，因为 FocusEvent 似乎不是一个低级事件。因此不能食用。请参阅方法 AWTEvent.consume()

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-07-01T11:14:45.463

这是我的解决方案。

在 JTree 子类中：

```
protected void processMouseEvent(MouseEvent e) {
        TreePath selPath = getPathForLocation(e.getX(), e.getY());
        try {
            fireVetoableChange(LEAD_SELECTION_PATH_PROPERTY, getLeadSelectionPath(), selPath);
        }
        catch (PropertyVetoException ex) {
            // OK, we do not want change to happen
            return;
        }

        super.processMouseEvent(e);
} 
```

然后在树中使用类：

```
VetoableChangeListener vcl = new VetoableChangeListener() {

        public void vetoableChange(PropertyChangeEvent evt) throws PropertyVetoException {
            if ( evt.getPropertyName().equals(JTree.LEAD_SELECTION_PATH_PROPERTY) ) {
                try {
                    <some code logic that has to be satisfied>
                } catch (InvalidInputException e) {
                    throw new PropertyVetoException("", evt);
                }

            }
        }
    };
    tree.addVetoableChangeListener(vcl); 
```

该机制在尽可能早的地方开始。鼠标动作被截获，将要选择的路径通告给 VetoableChangeListeners。在具体的 VCL 中，检查更改属性，如果是前导选择，则检查否决逻辑。如果需要否决，VCL 会抛出 PropertyVetoException，否则鼠标事件处理将照常进行并进行选择。简而言之，这使得潜在客户选择属性成为受*约束*的属性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-05T16:49:38.593

设置一个实现适当语义的 TreeSelectionModel。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-04T17:28:43.117

下面是一个实现 TreeSelectionModel 的示例，它包装了另一个 TreeSelectionModel 但允许选择被否决：

```
public class VetoableTreeSelectionModel implements TreeSelectionModel
{
   private final ListenerList<VetoableTreeSelectionListener> m_vetoableTreeSelectionListeners = new ListenerList<VetoableTreeSelectionListener>();

   private final DefaultTreeSelectionModel m_treeSelectionModel = new DefaultTreeSelectionModel();

   /**
    * {@inheritDoc}
    */
   public void addTreeSelectionListener(final TreeSelectionListener listener)
   {
      m_treeSelectionModel.addTreeSelectionListener(listener);
   }

   /**
    * {@inheritDoc}
    */
   public void removeTreeSelectionListener(final TreeSelectionListener listener)
   {
      m_treeSelectionModel.removeTreeSelectionListener(listener);
   }

   /**
    * Add a vetoable tree selection listener
    *
    * @param listener the listener
    */
   public void addVetoableTreeSelectionListener(final VetoableTreeSelectionListener listener)
   {
      m_vetoableTreeSelectionListeners.addListener(listener);
   }

   /**
    * Remove a vetoable tree selection listener
    *
    * @param listener the listener
    */
   public void removeVetoableTreeSelectionListener(final VetoableTreeSelectionListener listener)
   {
      m_vetoableTreeSelectionListeners.removeListener(listener);
   }

   /**
    * {@inheritDoc}
    */
   public void addPropertyChangeListener(final PropertyChangeListener listener)
   {
      m_treeSelectionModel.addPropertyChangeListener(listener);
   }

   /**
    * {@inheritDoc}
    */
   public void removePropertyChangeListener(final PropertyChangeListener listener)
   {
      m_treeSelectionModel.removePropertyChangeListener(listener);
   }

   /**
    * {@inheritDoc}
    */
   public void addSelectionPath(final TreePath path)
   {
      try
      {
         m_vetoableTreeSelectionListeners.fireVetoableEvent(new VetoableAction<VetoableTreeSelectionListener>() {
            public void fireEvent(final VetoableTreeSelectionListener listener) throws EventVetoedException
            {
               listener.aboutToAddSelectionPath(path);
            }});

         m_treeSelectionModel.addSelectionPath(path);
      }
      catch (final EventVetoedException e)
      {
         return;
      }
   }

   /**
    * {@inheritDoc}
    */
   public void addSelectionPaths(final TreePath[] paths)
   {
      try
      {
         m_vetoableTreeSelectionListeners.fireVetoableEvent(new VetoableAction<VetoableTreeSelectionListener>() {
            public void fireEvent(final VetoableTreeSelectionListener listener) throws EventVetoedException
            {
               listener.aboutToAddSelectionPaths(paths);
            }});

         m_treeSelectionModel.addSelectionPaths(paths);
      }
      catch (final EventVetoedException e)
      {
         return;
      }
   }

   /**
    * {@inheritDoc}
    */
   public void clearSelection()
   {
      try
      {
         m_vetoableTreeSelectionListeners.fireVetoableEvent(new VetoableAction<VetoableTreeSelectionListener>() {
            public void fireEvent(final VetoableTreeSelectionListener listener) throws EventVetoedException
            {
               listener.aboutToClearSelection();
            }});

         m_treeSelectionModel.clearSelection();
      }
      catch (final EventVetoedException e)
      {
         return;
      }
   }

   /**
    * {@inheritDoc}
    */
   public TreePath getLeadSelectionPath()
   {
      return m_treeSelectionModel.getLeadSelectionPath();
   }

   /**
    * {@inheritDoc}
    */
   public int getLeadSelectionRow()
   {
      return m_treeSelectionModel.getLeadSelectionRow();
   }

   /**
    * {@inheritDoc}
    */
   public int getMaxSelectionRow()
   {
      return m_treeSelectionModel.getMaxSelectionRow();
   }

   /**
    * {@inheritDoc}
    */
   public int getMinSelectionRow()
   {
      return m_treeSelectionModel.getMinSelectionRow();
   }

   /**
    * {@inheritDoc}
    */
   public RowMapper getRowMapper()
   {
      return m_treeSelectionModel.getRowMapper();
   }

   /**
    * {@inheritDoc}
    */
   public int getSelectionCount()
   {
      return m_treeSelectionModel.getSelectionCount();
   }

   public int getSelectionMode()
   {
      return m_treeSelectionModel.getSelectionMode();
   }

   /**
    * {@inheritDoc}
    */
   public TreePath getSelectionPath()
   {
      return m_treeSelectionModel.getSelectionPath();
   }

   /**
    * {@inheritDoc}
    */
   public TreePath[] getSelectionPaths()
   {
      return m_treeSelectionModel.getSelectionPaths();
   }

   /**
    * {@inheritDoc}
    */
   public int[] getSelectionRows()
   {
      return m_treeSelectionModel.getSelectionRows();
   }

   /**
    * {@inheritDoc}
    */
   public boolean isPathSelected(final TreePath path)
   {
      return m_treeSelectionModel.isPathSelected(path);
   }

   /**
    * {@inheritDoc}
    */
   public boolean isRowSelected(final int row)
   {
      return m_treeSelectionModel.isRowSelected(row);
   }

   /**
    * {@inheritDoc}
    */
   public boolean isSelectionEmpty()
   {
      return m_treeSelectionModel.isSelectionEmpty();
   }

   /**
    * {@inheritDoc}
    */
   public void removeSelectionPath(final TreePath path)
   {
      try
      {
         m_vetoableTreeSelectionListeners.fireVetoableEvent(new VetoableAction<VetoableTreeSelectionListener>() {
            public void fireEvent(final VetoableTreeSelectionListener listener) throws EventVetoedException
            {
               listener.aboutRemoveSelectionPath(path);
            }});

         m_treeSelectionModel.removeSelectionPath(path);
      }
      catch (final EventVetoedException e)
      {
         return;
      }
   }

   /**
    * {@inheritDoc}
    */
   public void removeSelectionPaths(final TreePath[] paths)
   {
      try
      {
         m_vetoableTreeSelectionListeners.fireVetoableEvent(new VetoableAction<VetoableTreeSelectionListener>() {
            public void fireEvent(final VetoableTreeSelectionListener listener) throws EventVetoedException
            {
               listener.aboutRemoveSelectionPaths(paths);
            }});

         m_treeSelectionModel.removeSelectionPaths(paths);
      }
      catch (final EventVetoedException e)
      {
         return;
      }
   }

   /**
    * {@inheritDoc}
    */
   public void resetRowSelection()
   {
      try
      {
         m_vetoableTreeSelectionListeners.fireVetoableEvent(new VetoableAction<VetoableTreeSelectionListener>() {
            public void fireEvent(final VetoableTreeSelectionListener listener) throws EventVetoedException
            {
               listener.aboutToResetRowSelection();
            }});

         m_treeSelectionModel.resetRowSelection();
      }
      catch (final EventVetoedException e)
      {
         return;
      }
   }

   /**
    * {@inheritDoc}
    */
   public void setRowMapper(final RowMapper newMapper)
   {
      m_treeSelectionModel.setRowMapper(newMapper);
   }

   /**
    * {@inheritDoc}
    */
   public void setSelectionMode(final int mode)
   {
      try
      {
         m_vetoableTreeSelectionListeners.fireVetoableEvent(new VetoableAction<VetoableTreeSelectionListener>() {
            public void fireEvent(final VetoableTreeSelectionListener listener) throws EventVetoedException
            {
               listener.aboutToSetSelectionMode(mode);
            }});

         m_treeSelectionModel.setSelectionMode(mode);
      }
      catch (final EventVetoedException e)
      {
         return;
      }
   }

   /**
    * {@inheritDoc}
    */
   public void setSelectionPath(final TreePath path)
   {
      try
      {
         m_vetoableTreeSelectionListeners.fireVetoableEvent(new VetoableAction<VetoableTreeSelectionListener>() {
            public void fireEvent(final VetoableTreeSelectionListener listener) throws EventVetoedException
            {
               listener.aboutToSetSelectionPath(path);
            }});

         m_treeSelectionModel.setSelectionPath(path);
      }
      catch (final EventVetoedException e)
      {
         return;
      }
   }

   /**
    * {@inheritDoc}
    */
   public void setSelectionPaths(final TreePath[] paths)
   {
      try
      {
         m_vetoableTreeSelectionListeners.fireVetoableEvent(new VetoableAction<VetoableTreeSelectionListener>() {
            public void fireEvent(final VetoableTreeSelectionListener listener) throws EventVetoedException
            {
               listener.aboutToSetSelectionPaths(paths);
            }});

         m_treeSelectionModel.setSelectionPaths(paths);
      }
      catch (final EventVetoedException e)
      {
         return;
      }
   }

   /**
    * {@inheritDoc}
    */
   @Override
   public String toString()
   {
      return m_treeSelectionModel.toString();
   } 
```

}

这是听者的声音：

```
public interface VetoableTreeSelectionListener
{
   /**
    * About to add a path to the selection
    *
    * @param path the path to add
    *
    * @throws EventVetoedException
    */
   void aboutToAddSelectionPath(TreePath path) throws EventVetoedException;

   /**
    * About to add paths to the selection
    *
    * @param paths the paths to add
    *
    * @throws EventVetoedException
    */
   void aboutToAddSelectionPaths(TreePath[] paths) throws EventVetoedException;

   /**
    * About to clear selection
    *
    * @throws EventVetoedException
    */
   void aboutToClearSelection() throws EventVetoedException;

   /**
    * About to remove a selection path
    *
    * @param path the path
    *
    * @throws EventVetoedException
    */
   void aboutRemoveSelectionPath(TreePath path) throws EventVetoedException;

   /**
    * About to remove multiple selection paths
    *
    * @param paths the paths
    *
    * @throws EventVetoedException
    */
   void aboutRemoveSelectionPaths(TreePath[] paths) throws EventVetoedException;

   /**
    * About to reset the row selection
    *
    * @throws EventVetoedException
    */
   void aboutToResetRowSelection() throws EventVetoedException;

   /**
    * About to set the selection mode
    *
    * @param mode the selection mode
    *
    * @throws EventVetoedException
    */
   void aboutToSetSelectionMode(int mode) throws EventVetoedException;

   /**
    * About to set the selection path
    *
    * @param path the path
    *
    * @throws EventVetoedException
    */
   void aboutToSetSelectionPath(TreePath path) throws EventVetoedException;

   /**
    * About to set the selection paths
    *
    * @param paths the paths
    *
    * @throws EventVetoedException
    */
   void aboutToSetSelectionPaths(TreePath[] paths) throws EventVetoedException;
} 
```

您可以使用自己的 ListenerList 实现，但您明白了……

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-01-07T15:08:48.007

为了防止选择，我只是继承了 DefaultTreeSelectionModel 并覆盖了所有方法来检查我不想被选中的对象（下面我的示例中的“DisplayRepoOwner”实例）。如果对象可以被选中，我调用 super 方法；否则我没有。我将 JTree 的选择模型设置为该子类的一个实例。

```
public class MainTreeSelectionModel extends DefaultTreeSelectionModel {
public void addSelectionPath(TreePath path) {
    if (path.getLastPathComponent() instanceof DisplayRepoOwner) {
        return;
    }
    super.addSelectionPath(path);
}
public void addSelectionPaths(TreePath[] paths) {
    for (TreePath tp : paths) {
        if (tp.getLastPathComponent() instanceof DisplayRepoOwner) {
            return;
        }
    }
    super.addSelectionPaths(paths);
}
public void setSelectionPath(TreePath path) {
    if (path.getLastPathComponent() instanceof DisplayRepoOwner) {
        return;
    }
    super.setSelectionPath(path);
}
public void setSelectionPaths(TreePath[] paths) {
    for (TreePath tp : paths) {
        if (tp.getLastPathComponent() instanceof DisplayRepoOwner) {
            return;
        }
    }
    super.setSelectionPaths(paths);
} 
```

}

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2010-09-10T23:14:52.287

在调查同一问题的解决方案时偶然发现了这个线程。首先，让我告诉你一些不起作用的事情。我试图用树注册 MouseListeners 和所有这些。问题是 TreeUI 的鼠标侦听器在我的 JTree 之前就开始处理事件，这意味着设置标志或类似的东西为时已晚。除此之外，这个解决方案产生了一些丑陋的代码，我通常会避免它。

所以现在是实际的解决方案！
在使用几个 Thread.dumpStack() 调用来获取堆栈转储后，我找到了我想要覆盖的方法。我扩展了 BasicTreeUI 并覆盖了“受保护的 void selectPathForEvent（TreePath 路径，MouseEvent 事件）”。

这将使您能够在选择实际发生之前访问导致选择的鼠标事件。然后，您可以使用 event.consume() 所需的任何逻辑，如果要停止选择则返回，执行所需的任何选择或通过调用 super.selectPathForEvent(path, event); 将其传递给默认处理；

只需记住设置您在 JTree 中创建的 UI。这个错误浪费了我生命中的几分钟；-)

# java - Java 应用程序的入口点：main()、init() 还是 run()？

> ID：261428
> 
> 赞同：42
> 
> 时间：2008-11-04T10:21:44.603
> 
> 标签：java, jvm

到目前为止，我一直在使用`public void run() {}`方法在 Java 中执行我的代码。何时/为什么要使用`main()`或`init()`代替`run()`？

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2008-11-04T10:36:58.440

这是一个特殊的问题，因为它不应该是一个选择问题。

当您启动 JVM 时，您指定一个要运行的类，它是`main()`您的程序启动的此类的 。

，`init()`我假设您的意思是 JApplet 方法。当在浏览器中启动小程序`init()`时，指定小程序的方法作为第一业务顺序执行。

，`run()`我假设你的意思是 Runnable 的方法。这是新线程启动时调用的方法。

*   main：程序开始
*   init：小程序启动
*   运行：线程启动

如果 Eclipse 正在运行您的`run()`方法，即使您没有`main()`，那么它正在做一些特殊和非标准的事情，但并非不可行。也许您应该发布一个您一直以这种方式运行的示例类。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2008-11-04T11:38:02.373

该`main`方法是 Java 应用程序的入口点。

具体来说，当 Java 虚拟机被告知通过指定其类（通过使用`java`应用程序启动器）来运行应用程序时，它将查找`main`具有`public static void main(String[])`.

从 Sun 的[`java`命令页面](http://java.sun.com/j2se/1.5.0/docs/tooldocs/windows/java.html)：

> **java**工具启动 Java 应用程序。它通过启动 Java 运行时环境、加载指定的类并调用该类的**main**方法来做到这一点。
> 
> 该方法必须声明为 public 和 static，它不能返回任何值，并且它必须接受一个`String`数组作为参数。方法声明必须如下所示：
> 
> ```
> public static void main(String args[]) 
> ```

有关如何执行 Java 应用程序的其他资源，请参阅以下资源：

1.  [第 12 章：](http://java.sun.com/docs/books/jls/third_edition/html/execution.html) Java 语言规范的执行，[第三版](http://java.sun.com/docs/books/jls/third_edition/html/j3TOC.html)。
2.  [第 5 章： Java 虚拟机规范](http://java.sun.com/docs/books/jvms/second_edition/html/VMSpecTOC.doc.html)的[链接、加载和初始化](http://java.sun.com/docs/books/jvms/second_edition/html/ConstantPool.doc.html)，第二版。
3.  深入了解[Java 教程](http://java.sun.com/docs/books/tutorial/index.html)[中的“Hello World”应用程序](http://java.sun.com/docs/books/tutorial/getStarted/application/index.html)。

* * *

该方法是实现接口的新方法或类`run`的入口点。Java虚拟机在命令启动时不会调用它。[`Thread`](http://java.sun.com/javase/6/docs/api/java/lang/Thread.html)[`Runnable`](http://java.sun.com/javase/6/docs/api/java/lang/Runnable.html)`java`

由于 a `Thread`or`Runnable`本身不能由 Java 虚拟机直接运行，所以必须由`Thread.start()`方法调用。这可以通过实例化 a`Thread`并在应用程序的方法中调用其`start`方法来完成`main`：

```
public class MyRunnable implements Runnable
{
    public void run()
    {
        System.out.println("Hello World!");
    }

    public static void main(String[] args)
    {
        new Thread(new MyRunnable()).start();
    }
} 
```

`Thread`有关如何启动子类或实现类的更多信息和示例`Runnable`，请参阅Java 教程中的[定义和启动线程](http://java.sun.com/docs/books/tutorial/essential/concurrency/runthread.html)。

* * *

该`init`方法是[Applet](http://java.sun.com/javase/6/docs/api/java/applet/Applet.html)或[JApplet](http://java.sun.com/javase/6/docs/api/javax/swing/JApplet.html)中调用的第一个方法。

当一个小程序被浏览器的Java插件或小程序查看器加载时，它会首先调用该`Applet.init`方法。使用小程序所需的任何初始化都应在此处执行。`init`方法完成后，调用该方法`start`。

有关何时`init`调用小程序的方法的更多信息，请阅读Java 教程中的小程序[生命周期中的小程序生命周期。](https://java.sun.com/docs/books/tutorial/deployment/applet/lifeCycle.html)

另请参阅：[如何](http://java.sun.com/docs/books/tutorial/uiswing/components/applet.html)通过 Java 教程制作小程序。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-04T10:27:38.427

Java有一个特殊的静态方法：

```
public static void main(String[] args) { ... } 
```

当使用 java 命令行启动类时在类中执行：

```
$ java Class 
```

如果存在，将在“Class”类中执行所述方法。

```
public void run() { ... } 
```

是 Runnable 接口需要的，或者是在创建新线程时从 Thread 类继承的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-04T10:23:59.963

该`main()`方法是 Java 应用程序的入口点。`run()`通常用于新线程或任务。

你在哪里写过`run()`方法，你在写什么样的应用程序（例如 Swing、AWT、控制台等）以及你的开发环境是什么？

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2012-03-06T11:35:45.923

作为初学者，我导入 acm 包，在这个包中，run() 开始执行线程，init() 初始化 Java Applet。

# scripting - 使用VB代码检测是否安装了adobe reader

> ID：261430
> 
> 赞同：3
> 
> 时间：2008-11-04T10:22:36.817
> 
> 标签：scripting, vb6, adobe-reader

我想检测是否使用 VB6 安装了 adobe reader。另外，如果检测到它没有安装，最好的解决方案是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-07T16:20:35.950

访问“HKEY_LOCAL_MACHINE\SOFTWARE\Adobe\Acrobat Reader”并枚举其子项。通过它，您可以获得此计算机上安装的“Adobe Reader”（以前称为“Acrobat Reader”）的版本号。

您还可以查看[http://pdftohtml.sourceforge.net/](http://pdftohtml.sourceforge.net/) 如果找不到能够解析 pdf 文件的应用程序，您也可以将其转换为 html 并使用网络浏览器访问它，这在大多数情况下都可用操作系统。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-13T23:45:41.723

有一些粗略的方法（检查程序文件目录中的文件），但我建议您声明完整的注册表函数（不是从 vb 获取设置），如[http://www.windowsdevcenter.com/pub/a/windows/2004 /06/15/VB_Registry_Keys.html](http://www.windowsdevcenter.com/pub/a/windows/2004/06/15/VB_Registry_Keys.html)并获取

*HKEY_CLASSES_ROOT\.pdf*

如果那里有，那么可以阅读 pdf 的东西就在那里（这就是你想要的，对吧？）。

作为奖励，*HKEY_CLASSES_ROOT\.pdf\OpenWithList*有一个打开 .pdf 文件的注册应用程序列表（哇）......该列表上的键名是您可以使用*shell("start "+ OpenAppName)从 vb 调用的程序*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-16T14:05:37.730

我会检查

```
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\ 
```

浏览该列表将为您提供所有已安装的程序。寻找特定于应用程序的注册表项通常会起作用，但有时在卸载应用程序时会留下它们。

类根非常适合显示是否安装了任何 PDF 阅读器。

此外，如果您只想使用默认应用程序来处理 PDF，您可以使用以下方法。（这是在 VBScript 中，但在 VB6 上应该是一样的）

```
File = <PDF FILE HERE>
Set WshShell = CreateObject("WScript.Shell")
WshShell.Run Chr(34) & File & Chr(34) 
```

* * *

对评论的回应

在 vb6 中有几种访问注册表的方法，[RegRead](http://msdn.microsoft.com/en-us/library/x05fawxd(VS.85).aspx)就是其中之一。 [WMI](http://msdn.microsoft.com/en-us/library/aa394600(VS.85).aspx)是另一种方式。我会使用 WMI，因为您可以轻松地枚举子键。

读取 HKEY_CLASSES_ROOT 并没有什么问题，但是如果您只是要启动默认的 pdf 处理程序，为什么不使用上面的 WshShell.Run 命令运行它呢？你用更少的步骤完成同样的事情。

# c - 如何在 C 中找到 unsigned char* 的长度

> ID：261431
> 
> 赞同：7
> 
> 时间：2008-11-04T10:22:39.530
> 
> 标签：c, char

我有一个变量

```
unsigned char* data = MyFunction(); 
```

如何找到数据的长度？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-04T10:28:44.323

您必须将数据的长度从`MyFunction`. 此外，请确保您知道谁分配了内存以及谁必须释放它。为此有多种模式。我经常看到：

```
int MyFunction(unsigned char* data, size_t* datalen) 
```

然后，您分配数据并传入 datalen。结果（int）应该指示您的缓冲区（数据）是否足够长......

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-04T10:24:00.340

假设它是一个`string`

```
length = strlen( char* ); 
```

但它似乎不是......所以没有办法*让*函数返回长度。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-01-07T11:26:27.260

没有办法找到 (`unsigned char *)`如果它不是空终止的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-04T10:54:40.870

现在这真的不是那么难。你得到了一个指向字符串第一个字符的指针。您需要增加此指针，直到您到达具有空值的字符。然后，您从原始指针中减去最终指针，瞧，您就有了字符串长度。

```
int strlen(unsigned char *string_start)
{
   /* Initialize a unsigned char pointer here  */
   /* A loop that starts at string_start and
    * is increment by one until it's value is zero,
    *e.g. while(*s!=0) or just simply while(*s) */
   /* Return the difference of the incremented pointer and the original pointer */
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-04T10:50:41.597

如前所述，strlen 仅适用于以 NULL 结尾的字符串，因此第一个 0（'\0' 字符）将标记字符串的结尾。你最好做这样的事情：

```
unsigned int size;
unsigned char* data = MyFunction(&size); 
```

或者

```
unsigned char* data;
unsigned int size = MyFunction(data); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-04T22:28:22.170

最初的问题并没有说返回的数据是以空字符结尾的字符串。如果没有，就无法知道数据有多大。如果是字符串，请使用 strlen 或自己编写。不使用 strlen 的唯一原因是如果这是一个家庭作业问题，所以我不会为你详细说明。

* * *

## 回答 #7

> 赞同：-5
> 
> 时间：2008-11-04T13:23:07.590

```
#include <stdio.h>
#include <limits.h>  
int lengthOfU(unsigned char * str)
{
    int i = 0;

    while(*(str++)){
        i++;
        if(i == INT_MAX)
            return -1;
    }

    return i;
} 
```

高温高压

# java - Swing Matisse GUI - 无法将定制 bean 添加到“其他组件”

> ID：261434
> 
> 赞同：1
> 
> 时间：2008-11-04T10:23:31.587
> 
> 标签：java, user-interface, data-binding, javabeans, matisse

我制作了一个带有属性（getter/setter）的自定义 ValueObject 类，我需要这个类来绑定表单上元素的数据。所以我想把它拖到马蒂斯编辑器上的“其他组件”上，这样我就可以绑定它了——什么也没发生……有类似的经历吗？NetBeans 6.5 和 MyEclipse 7.0M2 都发生了同样的问题

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-04T12:16:10.627

将组件添加到控制面板的常用方法是通过调色板管理器：右键单击调色板（例如“其他组件”区域）并选择调色板管理器，然后从适当的位置添加它（您当前的项目通过声音的。）

您的项目需要干净地编译才能执行此操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-04T12:48:05.213

是的，我已经总结了，你可以只添加编译的类，它甚至成功一次，但现在我编译了常规类（实现一个接口），它不会掉进去。我把它放在自定义调色板区域作为小部件，然后从那里进入表单。

谢谢，将尝试找到一些解决方法..希望很快...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-26T13:55:46.823

找到答案：当 JRE 为 1.6 时，MyEclipse 遇到 matisse 表单问题。在 JRE 1.5 中一切正常。他们说它将在 MyEclipse 7.1 中修复

# sql - 在不使用存储过程的情况下在 SQL Server 2005 上插入/更新

> ID：261449
> 
> 赞同：2
> 
> 时间：2008-11-04T10:28:11.110
> 
> 标签：sql, sql-server-2005, insert-update

我正在尝试执行经典的插入/更新方案，我需要更新数据库中的现有行，或者如果它们不存在则插入它们。

我[在这个主题上找到了一个先前的问题](https://stackoverflow.com/questions/13540/insert-update-stored-proc-on-sql-server)，但它处理的是我没有使用的存储过程。我只想使用普通的 SQL SELECT、INSERT 和 UPDATE 语句，除非有更好的可用（SQL Server 2005 中没有 MERGE 语句）。

我想我的总体想法是这样的：

```
If the row is found
  update
else
  insert 
```

至于检查一行是否存在，在调用 UPDATE 或 INSERT 之前执行 SELECT 语句的成本是多少？还是只尝试更新，检查受影响的行数，然后在受影响的行为 0 时执行 INSERT 是否更好？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-04T10:33:20.833

最有效的方法是执行`UPDATE`，然后执行`INSERT`if`@@rowcount`为零，[如上一个答案中所述](https://stackoverflow.com/questions/108403/solutions-for-insert-or-update-on-sql-server#108416)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-04T12:19:52.040

（首先 - 如果没有充分的理由，我不会尝试避免存储过程。在大多数情况下，这会带来很好的好处。）

**你可以这样做：**

*   创建一个（临时）表
*   填写你的行
*   运行识别现有行的 INTERSECT
*   用他们更新你的桌子
*   运行一个识别新行的 EXCEPT
*   使用这些元素运行插入
*   删除/清除您的（临时）表

如果您要插入/更新大量行，这可能会运行得更快。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-04T12:38:44.093

完全理解您的帖子的标题是“SQL Server 2005”，但只是想抛出一些值得期待的东西，如果/当您升级到 SQL 2008 时。微软添加了一个新的 MERGE 语句，这将使您能够编写一个 DML 语句更新和插入。它太酷了。我还没有比较性能和 I/O，但是在您的工具箱中拥有另一个工具真是太好了。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-11-04T12:28:26.030

如果您总是要：
* 计算行数
* 根据结果插入/更新

为什么不改为：
* 删除行
* 插入行

相同的结果，更整洁。
据我所知，当您更新一行时 - SQLServer 无论如何都会执行删除/插入（它存在的地方）

# mysql - 在字段名称周围使用反引号

> ID：261455
> 
> 赞同：180
> 
> 时间：2008-11-04T10:30:20.077
> 
> 标签：mysql, backticks

在阅读了一些关于这里的一些 SQL 问题的答案和评论之后，还听说我的一个朋友在一个有禁止它们的政策的地方工作，我想知道在 MySQL 中的字段名称周围使用反引号是否有什么问题.

那是：

```
SELECT `id`, `name`, `anotherfield` ...
-- vs --
SELECT id, name, anotherfield ... 
```

* * *

## 回答 #1

> 赞同：157
> 
> 时间：2008-11-04T10:36:21.373

使用反引号允许您使用替代字符。在查询写作中这不是一个问题，但如果有人假设你可以只使用反引号，我会假设它可以让你摆脱荒谬的事情，比如

```
SELECT `id`, `my name`, `another field` , `field,with,comma` 
```

这当然会生成名称错误的表。

如果您只是简明扼要，我认为它没有问题，您会注意到如果您这样运行查询

```
EXPLAIN EXTENDED Select foo,bar,baz 
```

返回的生成警告将具有反引号**和**完全限定的表名。因此，如果您正在使用查询生成功能和查询的自动重写，反引号将使解析代码的任何内容变得不那么混乱。

但是，我认为，与其规定是否可以使用反引号，不如说他们应该有一个名称标准。它解决了更多“真正的”问题。

* * *

## 回答 #2

> 赞同：58
> 
> 时间：2008-11-04T10:36:03.793

反引号的唯一问题是它们不符合 ANSI-SQL，例如它们不能在 SQL Server 中工作。

如果有可能必须将 SQL 移植到另一个数据库，请使用双引号。

* * *

## 回答 #3

> 赞同：46
> 
> 时间：2008-11-04T10:34:30.753

对我来说，在处理字段名称时始终使用它们很有意义。

*   首先，一旦你养成了习惯，点击反引号键并没有什么坏处。
*   其次，对我来说，它可以更容易地查看查询中的字段到底是什么，以及关键字或方法是什么。
*   最后，它允许您在设计表格时使用您希望的任何字段名称。有时将字段命名为“键”、“顺序”或“值”很有意义……所有这些在引用它们时都需要反引号。

* * *

## 回答 #4

> 赞同：28
> 
> 时间：2008-11-04T10:37:31.933

反引号不是标准 ANSI SQL 的一部分。从[mysql手册](http://dev.mysql.com/doc/refman/5.0/en/identifiers.html)：

> 如果启用了 ANSI_QUOTES SQL 模式，也允许在双引号内引用标识符

因此，如果您使用反引号，然后决定离开 MySQL，您就会遇到问题（尽管您可能还会遇到更大的问题）

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2008-11-04T10:40:28.667

如果您继续使用 MYSQL，则没有任何问题，除了查询的视觉模糊性。但它们确实允许使用保留关键字或嵌入空格作为表名和列名。这是大多数数据库引擎的禁忌，并且会阻止以后的任何迁移。

为了便于阅读，很多人使用大写的 SQL 关键字，例如。

```
SELECT some_fied, some_other_field FROM whatever WHERE id IS NULL; 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2012-10-07T14:32:59.663

如果你问我，应该总是使用反引号。但是有一些原因可能会导致团队不愿意使用它们。

好处：

*   使用它们，没有保留字或禁止字符。
*   在某些情况下，您会收到更具描述性的错误消息。
*   如果您避免了您不在乎的不良做法，但是...实际上，有时它们是避免 SQL 注入的一种不错的方法。

缺点：

*   它们不是标准的，通常不可移植。但是，只要您不使用反引号作为标识符的一部分（这是我能想象到的最糟糕的做法），您就可以通过自动删除反引号来移植您的查询。
*   如果您的某些查询来自 Access，他们可能会用 " 引用表名（也许您不能盲目地删除所有 " ）。但是，允许混合使用反引号和双引号。
*   一些愚蠢的软件或功能会过滤您的查询，并且存在反引号问题。但是，它们是 ASCII 的一部分，因此这意味着您的软件/功能非常糟糕。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2010-08-30T20:39:31.010

在您的代码库中搜索反引号中的内容要容易得多。假设您有一个名为`event`. `grep -r "event" *`可能会返回数百个结果。`grep -r "\`event\`" *`将返回任何可能引用您的数据库的内容。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-11-04T10:33:29.773

好吧，据我所知，使用反引号的全部目的是让您可以使用与保留关键字一致的名称。因此，如果名称没有与保留关键字冲突，我看不出有任何理由使用反引号。但是，这也不是禁止它们的理由。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2017-08-23T11:42:18.627

关于反引号的简单事情**``**用于表示标识符，如 database_name，table_name 等，单引号**''**，双引号**""**用于字符串文字，而 "" 用于按原样打印值，'' 打印值变量保持或在另一种情况下，打印他的文字。

```
i.e 1.-> use `model`;   
    here `model` is database name not conflict with reserve keyword 'model'
2- $age = 27;
insert into `tbl_people`(`name`,`age`,`address`) values ('Ashoka','$age',"Delhi");

here i used both quote for all type of requirement. If anything not clear let me know.. 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-04-09T07:19:21.453

如果您使用某些字段名称作为默认 mysql 或 mssql 值，例如“status”，则必须使用反引号（“select `status`from table_name”或“select id from table_name where `status`=1”）。因为mysql返回错误或查询不起作用。

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2019-01-24T17:17:48.073

SQL 中反引号 (`) 的主要用途是在您将在接下来的子句中再次调用它们的情况下使用它们。建议每隔一段时间使用双引号（“”）。

例如

```
SELECT CONCAT(Name, ' in ', city, ', ', statecode) AS `Publisher and Location`,
    COUNT(ISBN) AS "# Books",
    MAX(LENGTH(title)) AS "Longest Title",
    MIN(LENGTH(title)) AS "Shortest Title"
FROM Publisher JOIN Book
ON Publisher.PublisherID = Book.PublisherID WHERE INSTR(name, 'read')>0
GROUP BY `Publisher and Location`
HAVING COUNT(ISBN) > 1; 
```

在上面的语句中，您是否看到如何`Publisher and Location`在`GROUP BY`子句中再次使用 is。

而不是使用

> 按名称、城市、州代码分组

我刚用

> 通过...分组`Publisher and Location`

只有当这种情况出现时，使用反引号才有用。建议在所有其他时间使用双引号。

# .net - 负载均衡器后面的 WCF - 如何设置

> ID：261463
> 
> 赞同：4
> 
> 时间：2008-11-04T10:32:29.947
> 
> 标签：.net, wcf, wcf-binding

我们有几个使用负载均衡器的 Web 服务器。机器在端口 81 上运行 IIS6。在外部，站点可使用端口 80 访问。机器的外部名称和名称不同。

我们得到

```
System.ServiceModel.EndpointNotFoundException: The message with To '<url>' cannot be processed at the receiver, due to an AddressFilter mismatch at the EndpointDispatcher. Check that the sender and receiver's EndpointAddresses agree. 
```

web.config 的相关部分是：

```
 <endpoint binding="ws2007HttpBinding" bindingConfiguration="MyServiceBinding"
    contract="MyService.IMyService" listenUriMode="Explicit" /> 
```

我们尝试添加listenUri，但这并没有解决我们的问题。

有任何想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-27T11:03:03.433

```
[ServiceBehavior(AddressFilterMode=AddressFilterMode.Any)] 
```

将此属性放在服务上可以解决问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-04T10:46:17.640

具体的负载均衡器是什么？使用 F5 BIG-IP 我们让它工作起来相当容易，但是我们在 nlb 上使用相同的端口和（相对）uri 作为单个机器（因此，如果我们选择，我们可以将单个机器与农场相同）。显然，每台机器都有不同的名称，但此设置还允许您通过欺骗主机来测试单个服务器 - 例如，通过编辑您的 HOSTS 文件以将 [您的场名称] 指向 [测试服务器 IP]。

我们最大的痛苦是 SSL。使用 TransportWithMessageCredential 安全性，WCF 拒绝入站 http 连接 - 因此我们必须设置 nlb 以在 nlb 和服务器节点之间重新加密 - 但不是大问题。

我们遇到的唯一其他问题是在 IIS 中托管 WCF，并且 WCF 无法通过 http（但通过 https）正确识别预期的站点（尽管 IIS 很好）。为了解决这个问题，我编写了一个自定义工厂，它完全忽略了 http（只在 https 上收听）——无论如何，它与 TransportWithMessageCredential 要求紧密相关，所以我对此并不感到困扰。

我想知道您是否会通过在标准端口上托管而不是作为不同的站点（IP/host-header/etc）来获得更多乐趣。

# ruby-on-rails - 从 Ruby on Rails 执行系统任务的最佳方式是什么？

> ID：261490
> 
> 赞同：5
> 
> 时间：2008-11-04T10:43:51.810
> 
> 标签：ruby-on-rails, ruby, setuid

我正在构建一个小型系统管理 Web 应用程序（想想 Web-Min，但在 RoR 中），我需要能够从我的 Ruby 代码中访问系统参数。例如，我想允许用户更改服务器的主机名、时区或网络配置。

我目前的想法是拥有一个单独的 setuid 脚本（Perl、Ruby、??），以便我可以从我的 RoR 代码中调用它并执行操作。这很麻烦，也不是很优雅。我是 Ruby 新手，想知道是否有更好的方法来完成这类事情。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-04T10:55:26.017

您可以使用[BackgrounDRb](http://backgroundrb.rubyforge.org/)。它的目的是从 Rails 应用程序中卸载任务，并且您可以在不同的用户下运行服务器。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-04T13:43:06.707

有一系列涵盖后台任务的[RailsCasts剧集。](http://railscasts.com)

最适合您的问题的可能是["Rake in Background"](http://railscasts.com/episodes/127-rake-in-background)，这可能是一个很好的起点？顾名思义，它涵盖了从 Ruby on Rails 触发 rake 任务。

更改系统设置最明显的解决方案是让守护进程以 root 身份运行，它接受一些（非常有限且经过严格清理的）输入，例如新主机名或服务器的新 IP 地址。另一个剧集[“Starling and Workling”](http://railscasts.com/episodes/128-starling-and-workling)和[“Custom Daemon”](http://railscasts.com/episodes/129-custom-daemon)也可能对此有所帮助。

更清洁的解决方案是使用`sudo`. 我能想到两种（类似的）方法来做到这一点：

允许 sudo对将运行 rake 任务的用户访问某些命令（如`hostname`, ）。`ifconfig`这可能会带来很大的安全问题。我最喜欢的例子是允许 sudo 访问 vim，这似乎是无害的，直到你运行`sudo vim`，然后`!bash`突然你通过文本编辑器拥有对机器的完全 root 访问权限。

另一种方式（更容易安全地执行） - 有一个执行所需任务（例如更改主机名）的 rake 任务（或几个单独的脚本）。说，`/usr/bin/myapp_systemtasks`由 拥有`root:root`，然后允许 sudo 访问该脚本。确保您非常小心地清理脚本接受的输入（以防止诸如外壳转义之类的事情）。

所以，有办法做到这一点，但归根结底，您正在为系统级配置创建一个 Web 界面，这很难安全地完成。无论您决定做什么，请确保它经过良好测试（由您和其他人）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-05T15:52:02.093

我用[Starling](http://github.com/defunkt/starling/tree/master)做过类似的任务，它实际上只是一个排队服务器。它非常易于使用，您可以轻松地在不同的用户下运行工作线程。

Starling 的一个优点是它会记录队列，因此如果出现问题，它可以重新创建队列。

```
require 'starling'
starling = Starling.new('127.0.0.1:22122')
starling.set('my_queue', 12345) 
```

然后您的工作人员可以简单地将任何任务出列：

```
require 'starling'
loop do
  starling.get('my_queue') # this will block until something gets added to the queue
  # do stuff
end 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-04T12:18:42.527

一个人建议使用类似的东西`result = %x[uptime]`并将我指向这篇[非常有用的博客文章](http://blog.jayfields.com/2006/06/ruby-kernel-system-exec-and-x.html)。我认为这可以通过结合使用 sudo 调用并在 sudoers 中具有适当权限的某种包装脚本来实现。

# c++ - 如何使用自动工具构建 Python C 扩展模块

> ID：261500
> 
> 赞同：7
> 
> 时间：2008-11-04T10:46:43.927
> 
> 标签：c++, python, c, autotools

大多数可用于构建 Python 扩展模块的文档都使用 distutils，但我想通过使用适当的 python autoconf & automake 宏来实现这一点。

我想知道是否有一个开源项目可以做到这一点。我发现的大多数最终都依赖于 setup.py 文件。使用这种方法是可行的，但不幸的是，每当我对模块源文件进行修改时，最终都会重建整个源代码树。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-04T20:22:22.087

假设您有一个项目，其目录名为`src`，那么让我们按照以下步骤使用 autotools 构建和打包一个 python 扩展：

## 创建 Makefile.am 文件

首先，您需要在项目的根目录中创建一个 Makefile.am，基本上（但不限于）列出也应该处理的子目录。你最终会得到这样的东西：

```
SUBDIRS = src 
```

第二个，在`src`目录中将包含实际编译你的 python 扩展的指令。它看起来像这样：

```
myextdir = $(pkgpythondir)
myext_PYTHON = file1.py file2.py

pyexec_LTLIBRARIES = _myext.la

_myext_la_SOURCES = myext.cpp
_myext_la_CPPFLAGS = $(PYTHON_CFLAGS)
_myext_la_LDFLAGS = -module -avoid-version -export-symbols-regex initmyext
_myext_la_LIBADD = $(top_builddir)/lib/libhollow.la

EXTRA_DIST = myext.h 
```

## 编写configure.ac

该文件必须在项目的根目录中创建，并且必须列出您的项目需要构建的所有库、程序或任何类型的工具，例如编译器、链接器、库等。

像我这样的懒人通常不会从头开始创建它，我更喜欢使用该`autoscan`工具，它会查找您正在使用的东西并生成一个`configure.scan`可以用作您的真实基础的文件`configure.ac`。

要通知`automake`您将需要 python 的东西，您可以将其添加到您的`configure.ac`：

```
dnl python checks (you can change the required python version bellow)
AM_PATH_PYTHON(2.7.0)
PY_PREFIX=`$PYTHON -c 'import sys ; print sys.prefix'`
PYTHON_LIBS="-lpython$PYTHON_VERSION"
PYTHON_CFLAGS="-I$PY_PREFIX/include/python$PYTHON_VERSION"
AC_SUBST([PYTHON_LIBS])
AC_SUBST([PYTHON_CFLAGS]) 
```

## 包起来

基本上，`automake`有一个知道如何处理 python 东西的内置扩展，你只需要将它添加到你的`configure.ac`文件中，然后在你的`Makefile.am`.

PyGtk 绝对是一个很棒的例子，但它非常大，所以也许你会想要检查另一个项目，比如[Guake](http://github.com/Guake/Guake)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-04T13:10:44.060

所有 PyGTK 扩展都使用自动工具，所以如果 PyGTK 方面没有为你杀死整个事情，那么可能值得看看[PyGTK 源代码](http://svn.gnome.org/viewvc/pygtk/trunk/)。另外，[这是我写的一个更简单的。](http://bazaar.launchpad.net/~poppler-python/poppler-python/trunk/files)

# sql - 如何在 DB2 (8.x) 中查找所有打开/活动的连接

> ID：261512
> 
> 赞同：12
> 
> 时间：2008-11-04T10:53:30.980
> 
> 标签：sql, db2

我目前正在使用带有 FixPak 10 的 Db2 Enterprise Server V 8.2

我想用一个实例检索所有打开的活动连接的列表。

在 Oracle 中有一个名为“Top Session”的实用程序可以完成类似的任务。DB2 中是否有任何等价物？

在此先感谢， 卡马尔

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-24T15:29:46.417

要从列表应用程序中获取更多详细信息：

```
db2 list applications for database {dbName} show detail 
```

对于具有大量活动连接的应用程序，将结果通过管道传递`grep`给仅查找当前正在执行或锁定的线程很有用。

```
db2 list applications for database {dbName} show detail | grep -i "executing" 
```

和

```
db2 list applications for database {dbName} show detail | grep -i "lock" 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-05T16:40:52.667

中电：

```
db2 list applications 
```

询问：

```
SELECT * FROM SYSIBM.APPLICATIONS
SELECT * FROM SYSIBM.SESSION 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-04T11:28:37.307

您寻求的命令是：

```
LIST APPLICATIONS 
```

在 DB2 Command Center 中，有一个工具可以列出应用程序并以人性化的格式显示它们。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2020-06-29T16:34:33.190

也许您正在搜索以下查询。

```
SELECT
    AUTHID,
    APPL_NAME,
    CLIENT_NNAME,
    AGENT_ID,
    APPL_ID,
    APPL_STATUS
FROM
    SYSIBMADM.APPLICATIONS 
```

# windows - 用于从文件名中删除特殊字符的批处理文件脚本 (Windows)

> ID：261515
> 
> 赞同：10
> 
> 时间：2008-11-04T10:54:46.470
> 
> 标签：windows, batch-file, filenames, gnupg, file-rename

我有大量文件，其中一些文件名中包含特殊字符（例如ä、ö、% 等）。我想要一个脚本文件来遍历这些文件并重命名它们以删除特殊字符。我真的不介意它的作用，但它可以用下划线替换它们，例如

Störung%20.doc 将重命名为 St_rung_20.doc

按优先顺序：

1.  一个 Windows 批处理文件
2.  使用 cscript (vbs) 运行的 Windows 脚本文件
3.  可以从命令行运行的第三方软件（即不需要用户交互）
4.  另一个语言脚本文件，我必须为此安装一个额外的脚本引擎

背景：我正在尝试在 Windows 上使用 GnuPG 加密这些文件，但它似乎无法使用 --encrypt-files 选项处理文件名中的特殊字符。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-04T11:13:47.523

在将文件名提供给 gnupg 之前，您是否尝试过将 cmd.exe 设置为另一个代码页？`chcp 65001`事先将 cmd.exe 设置为 Unicode，然后重试。

如果失败，下面的 VBScript 会这样做：

```
Option Explicit

Dim fso: Set fso = CreateObject("Scripting.FileSystemObject")
Dim invalidChars: Set invalidChars = New RegExp

' put all characters that you want to strip inside the brackets
invalidChars.Pattern =  "[äöüß&%]"
invalidChars.IgnoreCase = True
invalidChars.Global = True

If WScript.Arguments.Unnamed.Count = 0 Then
  WScript.Echo "Please give folder name as argument 1."
  WScript.Quit 1
End If

Recurse fso.GetFolder(WScript.Arguments.Unnamed(0))

Sub Recurse(f)
  Dim item

  For Each item In f.SubFolders
    Recurse item
    Sanitize item
  Next
  For Each item In f.Files
    Sanitize item
  Next
End Sub

Sub Sanitize(folderOrFile)
  Dim newName: newName = invalidChars.Replace(folderOrFile.Name, "_")
  If folderOrFile.Name = newName Then Exit Sub
  WScript.Echo folderOrFile.Name, " -> ", newName
  folderOrFile.Name = newName 
End Sub 
```

像这样称呼它：

```
cscript replace.vbs "c:\path\to\my\files" 
```

您还可以在 Windows 资源管理器中将文件夹拖放到该文件夹​​上。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-04T11:14:02.860

来自[http://www.robvanderwoude.com/bht.html](http://www.robvanderwoude.com/bht.html)：

使用 NT 的 SET 字符串替换来替换或删除字符串中任意位置的字符：

```
SET STRING=[ABCDEFG]
SET STRING=%STRING:[=%
SET STRING=%STRING:]=%
ECHO String: %STRING%

will display 
String: ABCDEFG

SET STRING=[ABCDEFG]
SET STRING=%STRING:[=(%
SET STRING=%STRING:]=)%
ECHO String: %STRING%

will display 
String: (ABCDEFG)

SET STRING=[ABCDEFG]
SET STRING=%STRING:~1,7%
ECHO String: %STRING%

will display 
String: ABCDEFG 
```

如果您使用此尝试，则必须分别处理要替换的每个字符（例如 Ä,Ö,Ü,ä,ö,ü,ß，还有 á,à,é,è...）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-06T14:14:01.310

感谢 Tomalak，他实际上为我指明了正确的方向。以为我会在这里发布以确保完整性。

问题似乎是 GPG 使用的代码页是固定的（拉丁语 I）独立于控制台中配置的代码页。但是一旦他指出了这一点，我就想出了如何解决这个问题。

诀窍是在生成文件列表之前更改代码页。这实际上会使文件列表在控制台中查看时看起来不正确。但是，当传递给 GPG 时，它工作正常。GPG 接受文件并用正确的文件名吐出加密的文件。

批处理文件如下所示：

```
chcp 1252
dir /b /s /a-d MyFolder >filelist.txt
gpg -r test@test.com --encrypt-files <filelist.txt 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-03-11T21:38:39.300

以下 'RenameFilesWithAccentedAndDiacriticalLatinChars.pl' PERL 脚本使用重音和变音拉丁字符重命名文件：

*   这个 PERL 脚本从参数中给定的文件夹开始，或者从当前文件夹开始。
*   它递归地搜索字符属于 CP 1250、CP 1252、CP 1254 和 CP 1257（主要是重音拉丁字符）或带有变音符号的拉丁字符的 80 - FF 的文件。
*   它通过仅从拉丁字符中删除重音符号和变音符号来计算新文件名（例如，Été --> Ete）。
*   它显示所有建议的重命名和可能的冲突，并要求用户全局批准。
*   如果用户已批准，它将重命名所有没有冲突的文件。

选项“--batch”避免了交互式问题。小心使用。

选项 '--' 避免将下一个参数解释为选项。

**特别警告**：

*   这个脚本最初是用 UTF-8 编码的，应该保持不变。
*   这个脚本可能会重命名很多文件。
*   理论上，文件名都仅使用 UTF-8 编码。但是可能会发现某些文件名还包含一些具有传统编码的字符。
*   作者已经在一致性检查、稳健性、冲突检测和使用适当的编码方面付出了努力。因此，此脚本只能通过从拉丁字符中删除重音符号和变音符号来重命名文件。
*   但该脚本仅在有限数量的操作系统（Windows、Mac OS X、Linux）和有限数量的终端编码（CP 850、ISO-8859-1、UTF-8）下进行了测试。
*   所以，在奇怪的情况下，这个脚本可以用随机名称重命名许多文件。
*   因此，此脚本应谨慎使用，并极其谨慎地修改（注意内部字符串、输入、输出和命令的编码）

```
#!/usr/bin/perl -w
#=============================================================================
#
#  Copyright 2010  Etienne URBAH
#
#  This program is free software; you can redistribute it and/or modify
#  it under the terms of the GNU General Public License as published by
#  the Free Software Foundation; either version 2 of the License, or
#  (at your option) any later version.
#
#  This program is distributed in the hope that it will be useful,
#  but WITHOUT ANY WARRANTY; without even the implied warranty of
#  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#  GNU General Public License for more details at
#  http://www.gnu.org/licenses/gpl.html
#
#  For usage and SPECIAL WARNING, see the 'Help' section below.
#
#=============================================================================
use 5.008_000;    #  For correct Unicode support
use warnings;
use strict;
use Encode;

$| = 1;           #  Autoflush STDOUT

#-----------------------------------------------------------------------------
#  Function ucRemoveEolUnderscoreDash :
#  Set Uppercase, remove End of line, Underscores and Dashes
#-----------------------------------------------------------------------------
sub ucRemoveEolUnderscoreDash
{
  local $_ = uc($_[0]);
  chomp;
  tr/_\-//d;
  $_;
}

#-----------------------------------------------------------------------------
#  Constants
#-----------------------------------------------------------------------------
my $Encoding_Western  = 'ISO-8859-1';
my $Encoding_Central  = 'ISO-8859-2';
my $Encoding_Baltic   = 'ISO-8859-4';
my $Encoding_Turkish  = 'ISO-8859-9';
my $Encoding_W_Euro   = 'ISO-8859-15';
my $Code_Page_OldWest =   850;
my $Code_Page_Central =  1250;
my $Code_Page_Western =  1252;
my $Code_Page_Turkish =  1254;
my $Code_Page_Baltic  =  1257;
my $Code_Page_UTF8    = 65001;

my $HighBitSetChars   = pack('C*', 0x80..0xFF);

my %SuperEncodings    =
  ( &ucRemoveEolUnderscoreDash($Encoding_Western), 'cp'.$Code_Page_Western,
    &ucRemoveEolUnderscoreDash($Encoding_Central), 'cp'.$Code_Page_Central,
    &ucRemoveEolUnderscoreDash($Encoding_Baltic),  'cp'.$Code_Page_Baltic,
    &ucRemoveEolUnderscoreDash($Encoding_Turkish), 'cp'.$Code_Page_Turkish,
    &ucRemoveEolUnderscoreDash($Encoding_W_Euro),  'cp'.$Code_Page_Western,
    &ucRemoveEolUnderscoreDash('cp'.$Code_Page_OldWest),
                                                   'cp'.$Code_Page_Western );

my %EncodingNames     = ( 'cp'.$Code_Page_Central, 'Central European',
                          'cp'.$Code_Page_Western, 'Western European',
                          'cp'.$Code_Page_Turkish, '    Turkish     ',
                          'cp'.$Code_Page_Baltic,  '     Baltic     ' );

my %NonAccenChars     = ( 
                          #--------------------------------#
'cp'.$Code_Page_Central,  #   Central European (cp1250)    #
                          #--------------------------------#
                          #€_‚_„…†‡_‰Š‹ŚŤŽŹ_‘’“”•–—_™š›śťžź#
                          'E_,_,.++_%S_STZZ_````.--_Ts_stzz'.

                          # ˇ˘Ł¤Ą¦§¨©Ş«¬­®Ż°±˛ł´µ¶·¸ąş»Ľ˝ľż#
                          '_``LoAlS`CS_--RZ`+,l`uP.,as_L~lz'.

                          #ŔÁÂĂÄĹĆÇČÉĘËĚÍÎĎĐŃŇÓÔŐÖ×ŘŮÚŰÜÝŢß#
                          'RAAAALCCCEEEEIIDDNNOOOOxRUUUUYTS'.

                          #ŕáâăäĺćçčéęëěíîďđńňóôőö÷řůúűüýţ˙#
                          'raaaalccceeeeiiddnnoooo%ruuuuyt`',

                          #--------------------------------#
'cp'.$Code_Page_Western,  #   Western European  (cp1252)   #
                          #--------------------------------#
                          #€_‚ƒ„…†‡ˆ‰Š‹Œ_Ž__‘’“”•–—˜™š›œ_žŸ#
                          'E_,f,.++^%S_O_Z__````.--~Ts_o_zY'.

                          # ¡¢£¤¥¦§¨©ª«¬­®¯°±²³´µ¶·¸¹º»¼½¾¿#
                          '_!cLoYlS`Ca_--R-`+23`uP.,10_qh3_'.

                          #ÀÁÂÃÄÅÆÇÈÉÊËÌÍÎÏÐÑÒÓÔÕÖ×ØÙÚÛÜÝÞß#
                          'AAAAAAACEEEEIIIIDNOOOOOxOUUUUYTS'.

                          #àáâãäåæçèéêëìíîïðñòóôõö÷øùúûüýþÿ#
                          'aaaaaaaceeeeiiiidnooooo%ouuuuyty',

                          #--------------------------------#
'cp'.$Code_Page_Turkish,  #       Turkish  (cp1254)        #
                          #--------------------------------#
                          #€_‚ƒ„…†‡ˆ‰Š‹Œ____‘’“”•–—˜™š›œ__Ÿ#
                          'E_,f,.++^%S_O____````.--~Ts_o__Y'.

                          # ¡¢£¤¥¦§¨©ª«¬­®¯°±²³´µ¶·¸¹º»¼½¾¿#
                          '_!cLoYlS`Ca_--R-`+23`uP.,10_qh3_'.

                          #ÀÁÂÃÄÅÆÇÈÉÊËÌÍÎÏĞÑÒÓÔÕÖ×ØÙÚÛÜİŞß#
                          'AAAAAAACEEEEIIIIGNOOOOOxOUUUUISS'.

                          #àáâãäåæçèéêëìíîïğñòóôõö÷øùúûüışÿ#
                          'aaaaaaaceeeeiiiignooooo%ouuuuisy',

                          #--------------------------------#
'cp'.$Code_Page_Baltic,   #       Baltic   (cp1257)        #
                          #--------------------------------#
                          #€_‚_„…†‡_‰_‹_¨ˇ¸_‘’“”•–—_™_›_¯˛_#
                          'E_,_,.++_%___``,_````.--_T___-,_'.

                          # �¢£¤�¦§Ø©Ŗ«¬­®Æ°±²³´µ¶·ø¹ŗ»¼½¾æ#
                          '__cLo_lSOCR_--RA`+23`uP.o1r_qh3a'.

                          #ĄĮĀĆÄÅĘĒČÉŹĖĢĶĪĻŠŃŅÓŌÕÖ×ŲŁŚŪÜŻŽß#
                          'AIACAAEECEZEGKILSNNOOOOxULSUUZZS'.

                          #ąįāćäåęēčéźėģķīļšńņóōõö÷ųłśūüżž˙#
                          'aiacaaeecezegkilsnnoooo%ulsuuzz`' );

my %AccentedChars;
my $AccentedChars     = '';
my $NonAccenChars     = '';
for ( $Code_Page_Central, $Code_Page_Western,
      $Code_Page_Turkish, $Code_Page_Baltic )
    {
      $AccentedChars{'cp'.$_}  = decode('cp'.$_, $HighBitSetChars);
      $AccentedChars          .= $AccentedChars{'cp'.$_};
      $NonAccenChars          .= $NonAccenChars{'cp'.$_};
    }
#print "\n", length($NonAccenChars), '  ', $NonAccenChars,"\n";
#print "\n", length($AccentedChars), '  ', $AccentedChars,"\n";

my $QuotedMetaNonAccenChars = quotemeta($NonAccenChars);

my $DiacriticalChars  = '';
for  ( 0x0300..0x036F, 0x1DC0..0x1DFF )
     { $DiacriticalChars .= chr($_) }

#-----------------------------------------------------------------------------
#  Parse options and parameters
#-----------------------------------------------------------------------------
my $b_Help        = 0;
my $b_Interactive = 1;
my $b_UTF8        = 0;
my $b_Parameter   = 0;
my $Folder;

for  ( @ARGV )
{
  if    ( lc($_) eq '--' )
        { $b_Parameter = 1 }
  elsif ( (not $b_Parameter) and (lc($_) eq '--batch') )
        { $b_Interactive = 0 }
  elsif ( (not $b_Parameter) and (lc($_) eq '--utf8') )
        { $b_UTF8 = 1 }
  elsif ( $b_Parameter or (substr($_, 0, 1) ne '-') )
        {
          if  ( defined($Folder) )
              { die "$0 accepts only 1 parameter\n" }
          else
              { $Folder = $_ }
        }
  else
        { $b_Help = 1 }
}

#-----------------------------------------------------------------------------
#  Help
#-----------------------------------------------------------------------------
if  ( $b_Help )
    {
      die << "END_OF_HELP"

$0  [--help]  [--batch]  [--]  [folder]

This script renames files with accented and diacritical Latin characters :

-  This PERL script starts from the folder given in parameter, or else from
   the current folder.
-  It recursively searches for files with characters belonging to 80 - FF of
   CP 1250, CP 1252, CP 1254 and CP 1257 (mostly accented Latin characters)
   or Latin characters having diacritical marks.
-  It calculates new file names by removing the accents and diacritical marks
   only from Latin characters  (For example,  Été --> Ete).
-  It displays all proposed renaming and perhaps conflicts, and asks the user
   for global approval.
-  If the user has approved, it renames all files having no conflict.

Option '--batch' avoids interactive questions.  Use with care.

Option '--'      avoids the next parameter to be interpreted as option.

SPECIAL WARNING :
-  This script was originally encoded in UTF-8, and should stay so.
-  This script may rename a lot of files.
-  Files names are theoretically all encoded only with UTF-8\.  But some file
   names may be found to contain also some characters having legacy encoding.
-  The author has applied efforts for consistency checks, robustness, conflict
   detection and use of appropriate encoding.
   So this script should only rename files by removing accents and diacritical
   marks from Latin characters.
-  But this script has been tested only under a limited number of OS
   (Windows, Mac OS X, Linux) and a limited number of terminal encodings
   (CP 850, ISO-8859-1, UTF-8).
-  So, under weird circumstances, this script could rename many files with
   random names.
-  Therefore, this script should be used with care, and modified with extreme
   care (beware encoding of internal strings, inputs, outputs and commands)
END_OF_HELP
    }

#-----------------------------------------------------------------------------
#  If requested, change current folder
#-----------------------------------------------------------------------------
if  ( defined($Folder) )
    { chdir($Folder)  or  die  "Can NOT set '$Folder' as current folder\n" }

#-----------------------------------------------------------------------------
#  Following instruction is MANDATORY.
#  The return value should be non-zero, but on some systems it is zero.
#-----------------------------------------------------------------------------
utf8::decode($AccentedChars);
#  or  die "$0: '\$AccentedChars' should be UTF-8 but is NOT.\n";

#-----------------------------------------------------------------------------
#  Check consistency on 'tr'
#-----------------------------------------------------------------------------
$_ = $AccentedChars;
eval "tr/$AccentedChars/$QuotedMetaNonAccenChars/";
if  ( $@ )  { warn $@ }
if  ( $@ or ($_ ne $NonAccenChars) )
    { die "$0: Consistency check on 'tr' FAILED :\n\n",
          "Translated Accented Chars :  ", length($_), ' :  ', $_, "\n\n",
          "       Non Accented Chars :  ", length($NonAccenChars), ' :  ',
          $NonAccenChars, "\n" }

#-----------------------------------------------------------------------------
#  Constants depending on the OS
#-----------------------------------------------------------------------------
my $b_Windows = ( defined($ENV{'OS'}) and ($ENV{'OS'} eq 'Windows_NT') );

my ($Q, $sep, $sep2, $HOME, $Find, @List, $cwd, @Move);

if  ( $b_Windows )
    {
      $Q    = '"';
      $sep  = '\\';
      $sep2 = '\\\\';
      $HOME = $ENV{'USERPROFILE'};
      $Find = 'dir /b /s';
      @List = ( ( (`ver 2>&1` =~ m/version\s+([0-9]+)/i) and ($1 >= 6) ) ?
                ('icacls') :
                ( 'cacls') );
      $cwd  = `cd`;  chomp $cwd;  $cwd = quotemeta($cwd);
      @Move = ('move');
    }
else
    {
      $Q    = "'";
      $sep  = '/';
      $sep2 = '/';
      $HOME = $ENV{'HOME'};
      $Find = 'find .';
      @List = ('ls', '-d', '--');
      @Move = ('mv', '--');
      if  ( -w '/bin' )  { die "$0: For safety reasons, ",
                               "usage is BLOCKED to administrators.\n"}
    }

my $Encoding;
my $ucEncoding;
my $InputPipe = '-|';                                # Used as global variable

#-----------------------------------------------------------------------------
#  Under Windows, associate input and output encodings to code pages :
#  -  Get the original code page,
#  -  If it is not UTF-8, try to set it to UTF-8,
#  -  Define the input encoding as the one associated to the ACTIVE code page,
#  -  If STDOUT is the console, encode output for the ORIGINAL code page.
#-----------------------------------------------------------------------------
my $Code_Page_Original;
my $Code_Page_Active;

if  ( $b_Windows )
    {
      #-----------------------------------------------------------------------
      #  Get the original code page
      #-----------------------------------------------------------------------
      $_ = `chcp`;
      m/([0-9]+)$/  or  die "Non numeric Windows code page :  ", $_;
      $Code_Page_Original = $1;
      print 'Windows Original Code Page = ', $Code_Page_Original,
            ( $Code_Page_Original == $Code_Page_UTF8 ?
              ' = UTF-8, display is perhaps correct with a true type font.' :
              '' ), "\n\n";
      $Code_Page_Active = $Code_Page_Original ;

      #-----------------------------------------------------------------------
      #  The input encoding must be the same as the ACTIVE code page
      #-----------------------------------------------------------------------
      $Encoding = ( $Code_Page_Active == $Code_Page_UTF8 ?
                    'utf8' :
                    'cp'.$Code_Page_Active ) ;
      $InputPipe .= ":encoding($Encoding)";
      print "InputPipe = '$InputPipe'\n\n";

      #-----------------------------------------------------------------------
      #  If STDOUT is the console, output encoding must be the same as the
      #  ORIGINAL code page
      #-----------------------------------------------------------------------
      if  ( $Code_Page_Original != $Code_Page_UTF8 )
          {
            no  warnings  'unopened';
            @_ = stat(STDOUT);
            use warnings;
            if  ( scalar(@_) and ($_[0] == 1) )
                { binmode(STDOUT, ":encoding(cp$Code_Page_Original)") }
            else
                { binmode(STDOUT, ":encoding($Encoding)") }
          }
    }

#-----------------------------------------------------------------------------
#  Under *nix, if the 'LANG' environment variable contains an encoding,
#  verify that this encoding is supported by the OS and by PERL.
#-----------------------------------------------------------------------------
elsif ( defined($ENV{'LANG'}) and ($ENV{'LANG'} =~ m/\.([^\@]+)$/i) )
      {
        $Encoding = $1;

        my $Kernel = `uname -s`;
        chomp $Kernel;
        my $ucEncoding = &ucRemoveEolUnderscoreDash($Encoding);
        if  ( (lc($Kernel) ne 'darwin') and not grep {$_ eq $ucEncoding}
                       ( map { ($_, &ucRemoveEolUnderscoreDash($_)) }
                         `locale -m` ) )
            { die "Encoding = '$Encoding' or '$ucEncoding'  NOT supported ".
                  "by the OS\n" }

        my $ucLocale = &ucRemoveEolUnderscoreDash($ENV{'LANG'});
        if  ( not grep {$_ eq $ucLocale}
                       ( map { ($_, &ucRemoveEolUnderscoreDash($_)) }
                         `locale -a` ) )
            { die "Locale = '$ENV{LANG}' or '$ucLocale'  NOT supported ".
                  "by the OS\n" }

        if  ( not defined(Encode::find_encoding($Encoding)) )
            { die "Encoding = '$Encoding' or '$ucEncoding'  NOT supported ".
                  "by PERL\n" }

        print "Encoding = '$Encoding'  is supported by the OS and PERL\n\n";
        binmode(STDOUT, ":encoding($Encoding)");
      }

#-----------------------------------------------------------------------------
#  Check consistency between parameter of 'echo' and output of 'echo'
#-----------------------------------------------------------------------------
undef $_;
if  ( defined($Encoding)  )
    {
      $ucEncoding = &ucRemoveEolUnderscoreDash($Encoding);
      if    ( defined($SuperEncodings{$ucEncoding}) )
            { $_ = substr($AccentedChars{$SuperEncodings{$ucEncoding}},
                          0x20, 0x60) }
      elsif ( defined($AccentedChars{$Encoding}) )
            { $_ = $AccentedChars{$Encoding} }
      elsif ( $Encoding =~ m/^utf-?8$/i )
            { $_ = $AccentedChars }
    }
if  ( not defined($_) )                # Chosen chars are same in 4 code pages
    { $_ = decode('cp'.$Code_Page_Central,
                  pack('C*', 0xC9, 0xD3, 0xD7, 0xDC,                    # ÉÓ×Ü
                             0xE9, 0xF3, 0xF7, 0xFC)) }                 # éó÷ü
#print  $_, "  (Parameter)\n\n";
#system 'echo', $_;
utf8::decode($_);
#print  "\n", $_, "  (Parameter after utf8::decode)\n\n";
my @EchoCommand = ( $b_Windows ?
                    "echo $_" :
                    ('echo', $_) );
#system @EchoCommand;

open(ECHO, $InputPipe, @EchoCommand)  or  die 'echo $_: ', $!;
my $Output = join('', <ECHO>);
close(ECHO);
chomp $Output;
#print "\n", $Output, "  (Output of 'echo')\n";
utf8::decode($Output);
#print "\n", $Output, "  (Output of 'echo' after utf8::decode)\n\n";

if  ( $Output ne $_ )
    {
      warn "$0: Consistency check between parameter ",
                         "of 'echo' and output of 'echo' FAILED :\n\n",
           "Parameter of 'echo' :  ", length($_), ' :  ', $_, "\n\n",
           "   Output of 'echo' :  ", length($Output), ' :  ', $Output, "\n";
      exit 1;
    }

#-----------------------------------------------------------------------------
#  Print the translation table
#-----------------------------------------------------------------------------
if  ( defined($Encoding) )
{
  undef $_;
  $ucEncoding = &ucRemoveEolUnderscoreDash($Encoding);
  if    ( defined($SuperEncodings{$ucEncoding}) )
        {
          $_ = $SuperEncodings{$ucEncoding};
          print "--------- $EncodingNames{$_} ---------\n",
                '    ', substr($AccentedChars{$_}, 0x20, 0x20), "\n",
                '--> ', substr($NonAccenChars{$_}, 0x20, 0x20), "\n\n",
                '    ', substr($AccentedChars{$_}, 0x40, 0x20), "\n",
                '--> ', substr($NonAccenChars{$_}, 0x40, 0x20), "\n\n",
                '    ', substr($AccentedChars{$_}, 0x60, 0x20), "\n",
                '--> ', substr($NonAccenChars{$_}, 0x60, 0x20), "\n\n" }
  else
  {
    for ( 'cp'.$Code_Page_Central, 'cp'.$Code_Page_Western,
          'cp'.$Code_Page_Turkish, 'cp'.$Code_Page_Baltic )
    {
      if  ( ('cp'.$Encoding eq $_) or ($Encoding =~ m/^utf-?8$/i) )
          { print "--------- $EncodingNames{$_} ---------\n",
                  '    ', substr($AccentedChars{$_},    0, 0x20), "\n",
                  '--> ', substr($NonAccenChars{$_},    0, 0x20), "\n\n",
                  '    ', substr($AccentedChars{$_}, 0x20, 0x20), "\n",
                  '--> ', substr($NonAccenChars{$_}, 0x20, 0x20), "\n\n",
                  '    ', substr($AccentedChars{$_}, 0x40, 0x20), "\n",
                  '--> ', substr($NonAccenChars{$_}, 0x40, 0x20), "\n\n",
                  '    ', substr($AccentedChars{$_}, 0x60, 0x20), "\n",
                  '--> ', substr($NonAccenChars{$_}, 0x60, 0x20), "\n\n" }
    }
  }
}

#-----------------------------------------------------------------------------
#  Completely optional :
#  Inside the Unison file, find the accented file names to ignore
#-----------------------------------------------------------------------------
my $UnisonFile = $HOME.$sep.'.unison'.$sep.'common.unison';
my @Ignores;

if  ( open(UnisonFile, '<', $UnisonFile) )
    {
      print "\nUnison File '", $UnisonFile, "'\n";
      while  ( <UnisonFile> )
      {
        if  ( m/^\s*ignore\s*=\s*Name\s*(.+)/ )
            {
              $_ = $1 ;
              if  ( m/[$AccentedChars]/ )
                  { push(@Ignores, $_) }
            }
      }
      close(UnisonFile);
    }
print map("  Ignore: ".$_."\n", @Ignores);

#-----------------------------------------------------------------------------
#  Function OutputAndErrorFromCommand :
#
#  Execute the command given as array in parameter, and return STDOUT + STDERR
#
#  Reads global variable $InputPipe
#-----------------------------------------------------------------------------
sub OutputAndErrorFromCommand
{
  local $_;
  my @Command = @_;             # Protects content of @_ from any modification
  #---------------------------------------------------------------------------
  #  Under Windows, fork fails, so :
  #  -  Enclose into double quotes parameters containing blanks or simple
  #     quotes,
  #  -  Use piped open with redirection of STDERR.
  #---------------------------------------------------------------------------
  if  ( defined($ENV{'OS'}) and ($ENV{'OS'} eq 'Windows_NT') )
      {
        for  ( @Command )
             { s/^((-|.*(\s|')).*)$/$Q$1$Q/ }
        my $Command = join('  ', @Command);
        #print "\n", $Command;
        open(COMMAND, $InputPipe, "$Command  2>&1")  or  die '$Command: ', $!;
      }
  #---------------------------------------------------------------------------
  #  Under Unix, quoting is too difficult, but fork succeeds
  #---------------------------------------------------------------------------
  else
      {
        my $pid = open(COMMAND, $InputPipe);
        defined($pid) or die "Can't fork: $!";
        if  ( $pid == 0 )                           #  Child process
            {
              open STDERR, '>&=STDOUT';
              exec @Command;                        #  Returns only on failure
              die "Can't @Command";
            }
      }
  $_ = join('', <COMMAND>);                         #  Child's STDOUT + STDERR
  close COMMAND;
  chomp;
  utf8::decode($_);
  $_;
}

#-----------------------------------------------------------------------------
#  Find recursively all files inside the current folder.
#  Verify accessibility of files with accented names.
#  Calculate non-accented file names from accented file names.
#  Build the list of duplicates.
#-----------------------------------------------------------------------------
my %Olds;                                # $Olds{$New} = [ $Old1, $Old2, ... ]
my $Old;
my $Dir;
my $Command;
my $ErrorMessage;
my $New;
my %News;

print "\n\nFiles with accented name and the corresponding non-accented name ",
      ":\n";

open(FIND, $InputPipe, $Find)  or  die $Find, ': ', $!;

FILE:
while  ( <FIND> )
{
  chomp;
  #---------------------------------------------------------------------------
  #  If the file path contains UTF-8, following instruction is MANDATORY.
  #  If the file path does NOT contain UTF-8, it should NOT hurt.
  #---------------------------------------------------------------------------
  utf8::decode($_);

  if  ( $b_Windows )
      { s/^$cwd$sep2// }
  else
      { s/^\.$sep2// }

  #---------------------------------------------------------------------------
  #  From now on :  $_ = Dir/OldFilename
  #---------------------------------------------------------------------------
  push(@{$Olds{$_}}, $_);

  if  ( m/([^$sep2]+)$/ and
        ($1 =~ m/[$AccentedChars]|([\ -\~][$DiacriticalChars])/) )
      {
        if  ( $b_Windows and m/$Q/ )
            {
              print "\n    $Q$_$Q\n***  contains quotes.\n";
              next;
            }
        for  my $Ignore  ( @Ignores )
        {
          if  ( m/$Ignore$/ )
              { next FILE }
        }
        $Old = $_ ;
        m/^(.*$sep2)?([^$sep2]+)$/;
        $Dir = ( defined($1) ? $1 : '');
        $_   = $2;

        #---------------------------------------------------------------------
        #  From now on :  $Old = Dir/OldFilename
        #                 $_   = OldFilename
        #---------------------------------------------------------------------
        print "\n    $Q$Old$Q\n";
        $ErrorMessage = &OutputAndErrorFromCommand(@List, $Old);
        if  ( $? != 0 )
            { print "*** $ErrorMessage\n" }
        else
            {
              #---------------------------------------------------------------
              #  Change accented Latin chars to non-accented chars.
              #  Remove all diacritical marks after Latin chars.
              #---------------------------------------------------------------
              eval "tr/$AccentedChars/$QuotedMetaNonAccenChars/";
              s/([\ -\~])[$DiacriticalChars]+/$1/g;
              #---------------------------------------------------------------
              #  From now on :  $Old = Dir/OldFilename
              #                 $_   = NewFilename
              #---------------------------------------------------------------
              if  ( $@ )
                  { warn $@ }
              else
                  {
                    $New = $Dir.$_;
                    if  ( $b_Windows or (not utf8::is_utf8($Dir)) )    # Weird
                        { utf8::decode($New) }                 # but necessary
                    $News{$Old} = $New;
                    push(@{$Olds{$New}}, $Old);
                  }
              print "--> $Q$Dir$_$Q\n";
            }
      }
}

close(FIND);

#-----------------------------------------------------------------------------
#  Print list of duplicate non-accented file names
#-----------------------------------------------------------------------------
my $b_NoDuplicate = 1;

for  my $New  ( sort keys %Olds )
{
  if  ( scalar(@{$Olds{$New}}) > 1 )
      {
        if  ( $b_NoDuplicate )
            {
              print "\n\nFollowing files would have same non-accented name ",
                    ":\n";
              $b_NoDuplicate = 0;
            }
        print "\n", map('    '.$_."\n", @{$Olds{$New}}), '--> ', $New, "\n";
        for  ( @{$Olds{$New}} )
             { delete $News{$_} };
      }
}

#-----------------------------------------------------------------------------
#  If there are NO file to rename, then exit
#-----------------------------------------------------------------------------
my $Number = scalar(keys %News);

print "\n\n";
if  ( $Number < 1 )
    {
      print "There are NO file to rename\n";
      exit;
    }

#-----------------------------------------------------------------------------
#  Ask the user for global approval of renaming
#-----------------------------------------------------------------------------
if  ( $b_Interactive )
    {
      print "In order to really rename the ", $Number,
            " files which can safely be renamed, type 'rename' :  ";
      $_ = <STDIN>;
      sleep 1;                       # Gives time to PERL to handle interrupts
      if  ( not m/^rename$/i )
          { exit 1 }
    }
else
    { print $Number, " files will be renamed\n\n" }

#-----------------------------------------------------------------------------
#  Rename accented file names sorted descending by name size
#-----------------------------------------------------------------------------
$Number  = 0;
my $Move = join('  ', @Move);

for  ( sort {length($b) <=> length($a)} keys %News )
{
  $ErrorMessage = &OutputAndErrorFromCommand(@Move, $_, $News{$_});
  if  ( $? == 0 )
      { $Number++ }
  else
      { print "\n$Move  $Q$_$Q\n", (' ' x length($Move)),
        "  $Q$News{$_}$Q\n", ('*' x length($Move)), "  $ErrorMessage\n" }
}
print "\n$Number files have been successfully renamed\n";

__END__ 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-03-18T13:10:48.053

我正在使用这批重命名文件夹，到目前为止似乎工作正常......在我的情况下，代码页是 1252，你的可能会有所不同。

```
mode con codepage select=1252
@echo off
Setlocal enabledelayedexpansion
::folder only (/D option)
for /R /D %%d in (*) do (

set an=%%~nd
set bn=!an:.=_!
set cn=!bn:-=_!
set dn=!cn: =_!
set en=!dn:Á=A!
set fn=!en:É=E!
set gn=!fn:Í=I!
set hn=!gn:Ó=O!
set in=!hn:Ú=U!
set jn=!in:Ü=U!
set kn=!jn:á=a!
set ln=!kn:é=e!
set mn=!ln:í=i!
set nn=!mn:ó=o!
set on=!nn:ú=u!
set pn=!on:ü=u!
set qn=!pn:Ñ=N!
set zn=!on:ñ=n!

set ax=%%~xd
set bx=!ax:.=_!
set cx=!bx:-=_!
set dx=!cx: =_!
set bx=!ax:.=_!
set cx=!bx:-=_!
set dx=!cx: =_!
set ex=!dx:Á=A!
set fx=!ex:É=E!
set gx=!fx:Í=I!
set hx=!gx:Ó=O!
set ix=!hx:Ú=U!
set jx=!ix:Ü=U!
set kx=!jx:á=a!
set lx=!kx:é=e!
set mx=!lx:í=i!
set nx=!mx:ó=o!
set ox=!nx:ú=u!
set px=!ox:ü=u!
set qx=!px:Ñ=N!
set zx=!ox:ñ=n!

if [!an!]==[] (set zn=)
if [!ax!]==[] (set zx=)

set newname=!zn!!zx!

if /i not [%%~nd%%~xd]==[!newname!] rename "%%d" !newname!

)

endlocal

pause 
```

# c++ - 在 Visual Studio 2005 中重用目标文件

> ID：261518
> 
> 赞同：2
> 
> 时间：2008-11-04T10:55:18.293
> 
> 标签：c++, visual-studio-2005, visual-c++-2005

情况如下：

我有一个带有两个项目的 VS2005 解决方案：MyDll (DLL)、MyDllUnitTest (console EXE)。

在 MyDll 中，我有一个名为 MyClass 的类，它位于 DLL 内部，不应导出。我想在 MyDllUnitTest 中对其进行测试，所以我添加了一个名为 MyClassTest 的测试套件类，我在其中创建了 MyClass 的实例并对其进行测试。

我的问题：如何将通过构建 MyDll 创建的 MyClass 的目标文件链接到 MyDllUnitTest EXE？我不想在 MyDllUnitTest 中构建 MyClass，也不想导出该类。

我尝试对两个项目使用相同的*中间目录*（因此目标文件位于同一目录中）并使用 VS2005 的引用功能（右键单击项目 --> 引用 --> 添加新引用...），但它没有t 工作 - 我仍然收到链接错误（LNK2001）。

**编辑：**我不想在两个项目中拥有相同的源文件 - 考虑到我有很多 MyClass/MyClassTest，这意味着我必须将每个 MyClass 复制到不同的项目中。我知道可以在两个项目中使用相同的目标文件，我以前见过它，但忘记了如何。

**编辑：**我决定将文件放在两个项目中，所以它们被编译了两次。事实证明，“参考”功能自动工作 - 但仅适用于静态库项目。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-04T11:28:50.847

我不明白你为什么不想在你的 dll 项目中构建它。只要两个项目都使用相同的源文件，它们就会生成相同的目标文件（假设编译器选项的设置方式相同）。

如果您想在不导出类本身的情况下测试 dll（我认为这是因为在 dll 中导出类通常不是一个好主意），请考虑从 dll 中导出“工厂”函数。它将具有如下签名：

```
extern "C" MyClass *CreateMyClass(); 
```

这个函数将创建一个 MyClass 对象并返回一个指向它的指针。然后，您的单元测试可以对返回的类对象做任何需要的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-04T22:19:28.663

这是实现您尝试做的事情的另一种方法，但我相信它会满足您的要求...

在包含要测试的类的程序集上使用 InternalsVisibleToAttribute 属性。然后，如果您引用此程序集，您将能够测试该类，即使对于其他程序集这些类型是“不可见的”。魔法！

这是要使用的属性的 MSDN 参考...

[http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.internalsvisibletoattribute.aspx](http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.internalsvisibletoattribute.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-06T15:47:47.807

我在这里所做的是在测试项目中制作一个额外的“过滤器”“对象文件”，以及“头文件”和“源文件”，并将所有必要的 .obj 文件放在那里（如果他们已经顺便说一句，已经生成了）。这似乎在这里工作正常。我们在这里也使用它进行单元测试，并且在某些地方，在将相同的源文件用于两个不同的 DLL 时不必编译两次。

我们这样做的一个原因是我们使用 CMake 来生成我们的项目文件，因此不能使用所有内部 Visual Studio 的“魔法”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-04T12:21:25.453

我认为您还需要将 .obj 文件显式添加到项目链接器设置中的其他依赖项列表中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-12-17T01:36:08.167

您还可以尝试使用生成包含所有对象的 .lib 的命令。

就像来自的答案一样：[Visual C++ link generated objs from referenced project](https://stackoverflow.com/questions/8541727/visual-c-link-generated-objs-from-referenced-project/)

# linux - 在 Emacs 中匹配括号的命令是什么？

> ID：261522
> 
> 赞同：45
> 
> 时间：2008-11-04T10:59:24.480
> 
> 标签：linux, emacs, pattern-matching, editor, gnu

Emacs 中匹配括号的命令是什么（相当于`%`Vim 中的命令）？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2008-11-04T11:10:20.370

请参阅[5.27 如何显示与我正在查看的括号匹配的括号中的](http://www.gnu.org/software/emacs/manual/html_mono/efaq.html#Matching-parentheses)`show-paren-mode`描述？

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2008-11-04T12:22:54.310

`C-M-f`, 或`M-x forward-sexp`, 前进到右大括号，或下一组大括号中的左大括号。`C-M-b`, 或`M-x backward-sexp`, 后退到左大括号或下一组大括号中的右大括号。这些命令适用于圆括号、方括号、花括号、尖括号等，并且可以自定义以识别其他分隔符。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2011-05-16T08:11:27.383

只是为了完成最后的回应。我`C-M-n`用于前向匹配和`C-M-u`后向匹配。`C-M`映射到Windows 键盘上的`Esc`+ 。`Ctrl`

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-09T06:20:41.280

还有一个`show-paren-mode`。对于导航，我认为它更好`C-M-n`，并且`C-M-n`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-07-14T07:30:15.320

[https://github.com/redguardtoo/evil-matchit](https://github.com/redguardtoo/evil-matchit)

在开发 evil-matchit 之前，我阅读了 vim matchit 代码。evil-matchit 现在提供的比原来的 vim matchit 更多。

此外，您可以轻松扩展 evil-matchit 以支持您自己的 ~/.emacs 中的任何新语言。

# visual-studio - Visual Studio 的源代码控制集成如何与 Perforce 一起使用？

> ID：261525
> 
> 赞同：72
> 
> 时间：2008-11-04T11:01:50.793
> 
> 标签：visual-studio, version-control, perforce

我们正在使用 Perforce 和 Visual Studio。每当我们创建一个分支时，除非我们使用“从源代码管理打开”，否则某些项目不会绑定到源代码管理，但其他项目无论如何都可以工作。根据我的调查，我知道其中涉及的一些事情：

在我们的 .csproj 文件中，有以下设置：

*   <Scc项目名称>
*   <SccLocalPath>
*   <SccAuxPath>
*   <SccProvider>

有时它们都设置为“SAK”，有时则不是。如果这些说“SAK”，似乎事情更有可能奏效。

在我们的 .sln 文件中，有许多项目的设置：

*   SccLocalPath#
*   SccProjectFilePathRelativizedFromConnection#
*   SccProjectUniqueName#

（# 是标识每个项目的数字。） SccLocalPath 是相对于解决方案文件的路径。通常是“.”，有时是项目所在的文件夹，有时是“..”或“..\..”，指向上面的文件夹似乎不好解决方案文件夹。*相对化的是从*该文件夹到项目文件的路径。如果 SccLocalPath 指向项目的文件夹，它将完全丢失。如果 SccLocalPath 中包含“..”，则此路径可能包含分支之间不同的文件夹名称，我认为这会导致问题。

因此，要最终了解我想知道的细节：

*   当您执行“更改源代码管理”并绑定项目时会发生什么？Visual Studio 如何决定在项目和解决方案文件中放入什么？
*   当您执行“从源代码管理打开”时会发生什么？
*   SccLocalPath 和 SccProjectFilePathRelativizedFromConnection 所指的“连接”文件夹是什么？Visual Studio/Perforce 如何选择它？
*   即使创建解决方案的新分支，是否有一些推荐的方法可以使源代码控制绑定继续工作？

* * *

*2012 年 6 月添加：* 我不再使用 Perforce，所以我不能保证，但请看下面[KCD 的答案](https://stackoverflow.com/a/11148342/2283)。显然有[一个新的 P4 VS 插件](http://forums.perforce.com/index.php?/topic/1585-new-perforce-plugin-for-visual-studio-20121-beta-available-now/)正在开发中。希望它应该清除所有这些混乱！

* * *

## 回答 #1

> 赞同：103
> 
> 时间：2009-02-09T19:34:24.743

# 介绍

我不同意 Visual Studio 中的 Perforce 集成“糟糕”的说法。相反，我将其定义为“开箱即用的体验不是最佳的”:-)。以下部分讨论了我对项目/解决方案设置的集成和建议的理解。

如果您对源代码控制集成如何工作的细节不感兴趣，您可以跳到此答案的末尾，我在此总结了 Weeble 问题的答案。

*免责声明*：以下部分只是基于我的经验经验的有根据的猜测，但是我多年来在许多项目中使用了该技术（每个项目都有多个实验/主干/维护/发布分支​​，有时甚至是多个解决方案文件，没有问题）。缺点是您必须*手动*更新项目文件 - 但 2 分钟的投资在项目的整个生命周期中很好地摊销了，恕我直言 :-)。

# 解决方案与项目

Visual Studio 在初始解决方案加载期间使用来自解决方案文件和每个项目文件的源代码控制绑定信息。然后将此绑定信息存储在**name.suo**文件中（假设我们使用**name.sln**作为解决方案） - 请注意，**suo**文件标有**隐藏**标志，因此它们在文件资源管理器中不可见（除非您覆盖“隐藏文件和文件夹”选项）。

如果出现任何问题，重新绑定到源代码控制提供程序的最简单方法是删除相应的**suo**文件并重新打开解决方案。创建 suo 文件后，对 <Scc*> ​​元素的更改无效。

如果在初始解决方案打开期间，解决方案文件中存储的绑定信息与项目文件中存储的信息之间存在差异，Visual Studio 将尝试修复此问题（有时它甚至会提示您选择是解决方案中的信息还是项目中的信息应用作解决差异的“主”）：

![替代文字](https://i.stack.imgur.com/AUf7n.png)

为什么 Visual Studio 违反 DRY（不要重复自己）原则？我不知道。我认为这是有历史原因的，并且与称为 Visual Source Safe 的噩梦的需求紧密相关 :-)。

# 如何“正确”设置？

在向 Perforce 添加新的或现有的解决方案/项目时，我**总是**从创建一个空白解决方案开始（请参阅“源代码控制空白解决方案”部分）。然后我一个接一个地将项目添加到这个空白解决方案中。根据添加的项目是否已经存在（参见“源代码控制现有（未绑定）项目”和“源代码控制现有（绑定）项目”部分）或我需要创建一个新项目（参见“源代码控制新项目”部分）。

# 源代码控制空白解决方案

要向源代码管理添加新的空白解决方案，请执行以下操作：

1.  启动Visual Studio，“新建”->“项目...”->“其他项目类型”->“空白解决方案”；填写解决方案名称和位置，“确定”按钮
2.  “文件”->“源代码管理”->“将解决方案添加到源代码管理...”
3.  在连接对话框中输入适当的 P4 服务器端口、客户端和用户（请注意，所选客户端的视图必须包含您在步骤 1 中选择的位置）
4.  “查看”->“待签入”->“签入”-> 在提交对话框中而不是点击“提交”按钮，使用“取消”。
    **原因**：“签入”操作将创建一个新文件“name.vssscc”，然后将“name.sln”和“name.vssscc”都添加到 Perforce 的默认更改列表中；通过取消提交对话框，我们将保持“添加”操作挂起，并且能够在提交到 P4 之前编辑文件
5.  关闭 Visual Studio
6.  在您喜欢的编辑器中打开 name.sln 文件（记事本，如果您真的很绝望:-)）并添加两个新行（**SccProjectName0**和**SccProvider0**） - 空白解决方案文件现在应该有一个源代码控制部分，如下所示：

    ```
    GlobalSection(SourceCodeControl) = preSolution
        SccNumberOfProjects = 1
        SccLocalPath0 = .
        SccProjectName0 = Tutorial
        SccProvider0 = MSSCCI:Perforce\u0020SCM
    EndGlobalSection 
    ```

    值应选择如下：

    *   **SccProjectName0**：将在“更改源代码管理”对话框中显示为“服务器绑定”的任意字符串。此名称用于确定哪些项目/解决方案文件可以共享相同的源代码控制连接。我建议不要为此名称使用空格，因为解决方案和项目文件中空格的转义规则不同。
    *   **SccProvider0**：硬编码值“MSSCCI:Perforce\u0020SCM”。
7.  使用您选择的 Perforce 客户端（p4.exe、P4Win、P4V）提交两个待处理文件

您现在可以测试绑定：

1.  确保 Visual Studio 已关闭
2.  删除除name.sln以外的**所有*文件（尤其是name.suo）
3.  打开 Visual Studio 并使用它打开 name.sln
4.  应该会出现一个连接对话框，使用适当的端口/客户端/用户，然后单击确定
5.  解决方案资源管理器现在应该显示带有挂锁覆盖图标的解决方案节点： ![源头控制空白溶液](https://i.stack.imgur.com/KmfTd.png)
6.  您现在可以使用“文件”->“源代码管理”->“更改源代码管理...”来验证解决方案的源代码管理状态： ![空白溶液源头控制状态](https://i.stack.imgur.com/DLvQY.png) 注意：“服务器绑定”列显示了我们为“SccProjectName0”选择的值.

# 源代码控制新项目

如果您正在创建一个全新的项目并希望立即开始在 Perforce 仓库中跟踪它，请按照以下步骤操作：

1.  在 Visual Studio 中打开源代码控制解决方案
2.  “文件” -> “添加” -> “新建项目...” - 选择您要添加的项目类型、名称和位置（位置应该是存储解决方案文件的目录的子目录）
3.  “文件”->“全部保存”（这会将所有内存更改提交到解决方案文件和新创建的项目文件到磁盘）
4.  使用您选择的编辑器手动编辑您刚刚创建的项目文件（来吧，记事本再次？;-)）。将以下属性元素添加到 PropertyGroup（任何属性组）中：

    ```
    <PropertyGroup>
        ...
        <SccProjectName>Tutorial</SccProjectName>
        <SccLocalPath>..\..</SccLocalPath>
        <SccProvider>MSSCCI:Perforce SCM</SccProvider>
        ...
    </PropertyGroup> 
    ```

    值应选择如下：

    *   **SccProjectName** - 这是在“更改源代码管理”对话框中显示为“服务器绑定”的值；应该与您在空白解决方案中用于 SccProjectName0 的值相同；如果不相同，解决方案和此项目将无法共享相同的源代码控制提供程序连接
    *   **SccLocalPath** - 参考目录的相对路径（在“更改源代码管理”对话框中显示为“本地绑定”）；因为我建议使用解决方案目录作为参考目录，这实际上是从包含项目文件的目录到包含解决方案文件的目录的相对路径（我的示例是将项目存储在“（solutionDir）/Source/ProjectName/projectName.csproj”中，因此相对路径是“向上两层”）
    *   **SccProvider** - 硬编码值“MSSCCI:Perforce SCM”；这用于确定 SCC* 绑定值对哪些 SCCAPI 提供程序有效
5.  切换回 Visual Studio；它应该自动检测到项目文件已在外部更新并提供重新加载它（如果没有，请手动卸载并重新加载项目）

6.  “查看”->“待签到”
7.  “签入”-> 我建议右键单击 (solutionName).vssscc 文件并选择“如果未更改则还原”（即使 Visual Studio 打开它进行编辑，它也保持不变）；提供描述并提交更改

要验证新添加的项目是否正确绑定，您可以按照以下步骤操作：

1.  确保 Visual Studio 已关闭
2.  删除 (solutionName).suo 文件以及 MSSCCPRJ.SCC（在解决方案目录中）
3.  打开 Visual Studio 并使用它打开 (solutionName).sln
4.  应该会出现一个连接对话框，使用适当的端口/客户端/用户，然后单击确定
5.  解决方案资源管理器现在应该显示带有挂锁覆盖图标的项目节点： ![源代码控制项目](https://i.stack.imgur.com/vyRH4.png)
6.  您现在可以使用“文件”->“源代码管理”->“更改源代码管理...”来验证解决方案的源代码管理状态： ![源代码控制项目的现状](https://i.stack.imgur.com/3V33X.png)

    关于此状态屏幕截图需要注意的一点是，当我选择解决方案行时，所有剩余的行也都被“选中”（蓝色突出显示）。这是因为所有这些条目都具有相同的“服务器绑定”+“本地绑定”，因此共享相同的源控制提供程序 (P4) 连接。

    另请注意，两个项目的“相对路径”有两个级别，并且相对于相同的“本地绑定” - 解决方案文件所在的目录。

# 源代码控制现有（未绑定）项目

如果您有尚未在任何其他 Perforce 解决方案中使用的现有项目，请按照以下步骤将它们添加到 Perforce（即导入以前没有源代码控制的项目（互联网下载等）或使用不同的源代码控制提供者（Visual Source Safe 等）。

1.  将项目复制到适当的位置
2.  清理现有的源代码控制绑定（如果有）：
    *   删除现有的项目文件绑定，即所有以“Scc”开头的属性
    *   删除与项目文件相同目录下的文件（projectName）.vspscc（如果有）
3.  在 Visual Studio 中打开源代码控制解决方案
4.  “文件” -> “添加” -> “现有项目...” - 浏览到项目（您在步骤 1 中创建的副本）
5.  “文件”->“全部保存”（这会将所有内存中的更改提交到解决方案文件）
6.  遵循“源代码控制新项目”中的步骤 4-7（即，您现在将“Scc*”属性元素添加到**PropertyGroup**中）

验证步骤与“源代码控制新项目”部分中的完全相同。

# 源代码控制现有（绑定）项目

如果您的项目已经使用此处讨论的技术绑定到 Perforce，并且您想在不同的解决方案中使用它们（新分支、重用项目的替代解决方案等），请使用以下步骤：

1.  将项目集成到所需位置
2.  在 Visual Studio 中打开源代码控制解决方案
3.  “文件” -> “添加” -> “现有项目...” - 通过集成浏览到在步骤 1 中创建的项目
4.  “查看”->“待签入”->“签入”-添加描述并提交

# 概括

*   源代码管理绑定信息存储在解决方案和项目中，必须同步（如果不同步，Visual Studio 将尝试修复任何差异）
*   我总是将项目文件视为绑定信息的主要来源，将解决方案文件视为一次性文件，可以通过首先对空白解决方案进行源代码控制然后添加所需项目来轻松重新创建这些文件
*   解决方案文件应始终具有有效**的 SccProvider0**和**SccProjectName0**值（必须使用新版本的 P4SCC 插件手动添加）
*   项目文件应始终具有有效**的 SccProjectName**（最好与**SccProjectName0**相同）、**SccLocalPath**和**SccProvider**值（也必须手动编辑，因为 P4SCC 默认值不好）

我还包括对您原始问题的回答：

> 当您执行“更改源代码管理”并绑定项目时会发生什么？Visual Studio 如何决定在项目和解决方案文件中放入什么？

这会更新您正在重新绑定的项目文件中的“Scc*”元素；然后解决方案文件也会更新，以便与项目文件绑定同步

> 当您执行“从源代码管理打开”时会发生什么？

允许您选择要打开的解决方案。之后，解决方案中包含的所有项目都会自动同步到 head。我发现这个功能在 Perforce 世界中不是很有用，无论如何你都必须创建一个客户端，而且你很有可能是从 P4V/P4Win/P4 同步这个客户端，而不是依赖于 Visual Studio。这在没有视图概念的 Visual Source Safe 世界中非常有用，并且您正在定义存储库在签出时间的位置。

> SccLocalPath 和 SccProjectFilePathRelativizedFromConnection 所指的“连接”文件夹是什么？Visual Studio/Perforce 如何选择它？

这是 Visual Studio 的簿记。它是根据每个项目文件中的绑定确定的（我猜理论上如果项目文件由于某种原因丢失了绑定信息，它可以从解决方案信息中重建......）

> 即使创建解决方案的新分支，是否有一些推荐的方法可以使源代码控制绑定继续工作？

我希望上面的部分能让您了解一种对我来说非常有效的方法:-)。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2010-03-19T23:44:38.093

Milan 的帖子经过精心研究和精心编写，但其篇幅无疑表明 P4SCC 模型已被破坏。在项目和解决方案文件中存储源代码控制绑定信息是荒谬的。（通过 sccprojectname）强制一个项目是一个解决方案的一部分同样荒谬。

此外，P4SCC 在大型解决方案中具有巨大的性能成本，因为它在启动时从每个文件的源代码控制中检索信息，并在整个开发会话期间在内存中维护该状态。它以无信息的 .vsscc 和 vssscc 文件的形式创建额外的文件，以支持 (AFAICT) Perforce 不使用的某些 SCC 功能。

理想的 Perforce 集成如下所示：

*   如果我创建新的解决方案、项目或项目项，请运行“p4 add”。
*   如果我更改文件，请运行“p4 编辑”。
*   一些工具栏/上下文菜单集成，用于修订历史、修订图、延时/责备和“在 P4 gui 中显示”。
*   （很高兴）如果我重命名仓库中存在的文件，请运行“p4 集成”和“p4 删除”。如果我重命名为添加打开的文件，请运行“p4 revert”和“p4 add”。
*   就这样

我们已经完全摆脱了 P4SCC 及其奇异的要求和负担。相反，我们使用[NiftyPerforce](http://code.google.com/p/niftyplugins/)。有一些错误，但我们发现解决这些错误要比解决 Perforce<->VSSCC 模型中的设计缺陷更令人沮丧。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-06-21T23:38:10.893

只是为了保持最新——P4VS 插件大约在 2012 年被重写

> 现在，您可以直接在 IDE 中自然地执行与 Perforce 的所有日常交互，例如签入代码和查看文件历史记录。
> 
> 如果您是一位需要更多功能的高级用户，P4VS 不会让您失望。P4VS 与 Perforce Streams 完全兼容，并且可以从 IDE 访问 Stream Graph，以及 Time-lapse View 和 Revision Graph。如果你负责分支管理，你也可以从 P4VS 合并。
> 
> 而且，如果您远程工作或想做一些私有分支，可以通过 P4VS 配置 P4Sandbox。

*   [perforce.com 上的 P4VS 页面](http://www.perforce.com/product/components/visual-studio-plug-in)
*   关于如何使用它的[网络研讨会](http://www.perforce.com/documentation/multimedia-library/webinar/best-tools-2012-increase-productivity-visual-studio-perforce)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2011-07-06T07:16:15.510

使用 P4CONFIG 环境变量可以简化在 Visual Studio 中使用 Perforce。

基本上你进入 Visual Studio，工具 -> 选项 -> 源代码管理 -> 插件设置，高级按钮。这将打开一个特定于 SCC 集成的 Perforce 配置对话框。切换到“连接”选项卡，并选中标题为“绑定与您的 Perforce 环境设置匹配的工作区”的单选按钮。这将告诉 perforce 更喜欢使用 P4CONFIG 环境变量来确定您所处的环境。相同的对话框存在于 P4V 中的 Edit -> Preferences 下，但仅影响 p4v 的行为。

如何设置 P4CONFIG 环境变量在某种程度上取决于您。我喜欢让它们在任何地方都被命名，所以我设置了一个系统范围的环境变量 P4CONFIG 来查找名为 p4config.cfg 的文件。该文件只是一个 ini 样式文件，您可以在其中分配其他变量，例如 P4USER、P4CLIENT、P4HOST 等。Perforce 将在当前目录和所有父目录中搜索该文件，直到遇到一个。基本上你把这个文件放在你的clientspec映射到你硬盘上的最根目录中，不要管它。

这种方法极大地减少了 Visual Studio 中 SCC 配置为了运行而需要的“正确性”数量。（SAK 绑定工作正常等）

如果在第一次从 perforce 同步您的代码或同步到一个完全干净的目录结构之后，并得到一个对话框，抱怨 perforce 想要暂时脱机工作或删除绑定，那么您仍然需要进行一些编辑。主要是 .sln 文件本身需要修改，以便它知道 sln 有自己的 SCC 绑定。这是通过确保将以下字段放置在 .sln 文件中的 SccNumberOfProjects 之后完成的。

```
SccProjectName0 = Perforce\u0020Project
SccProvider0 = MSSCCI:Perforce\u0020SCM 
```

如果您使用的是 P4CONFIG 方法，则所有单个项目都可以使用默认的“SAK 绑定”正常工作。修复这个问题应该允许 Perforce 完美地从干净的同步中工作，并且还消除了每个项目目录中 MSSCCPRJ.SCC 的生成。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-11-26T22:35:53.280

如果使用 Visual Studio P4 插件集成，对重命名文件或将其移动到新文件夹目录的支持非常*糟糕和痛苦。*不存在提醒 P4 重命名文件或文件已被移动的内置功能。

问题是重命名文件不仅需要更新关联的 VS 项目文件，而且如果您想维护正确的修订历史记录，还需要通知 Perforce 更改。

目前，如果使用 VS 集成，我看不到在单个操作中完成这两项操作的方法。相反，您必须：

1.  从 Perforce 客户端中重命名/移动文件
2.  删除VS中项目文件中的旧文件名引用
3.  在 VS 的项目文件中添加新的文件名引用
4.  提交您的更改

如果您使用持续集成构建过程并在最后一步之前的任何时间提交更改，则可以保证构建损坏。

该问题显着放大了需要重命名或移动的更多文件。这无论如何都不是一个顺利的过程。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2011-03-03T17:42:24.397

在尝试了 Milan Gardian 的内容丰富的答案之后，我想我可以提供一个更简单的解决方案来让它运行良好。

正如 Weeble 所提到的，当其他一切都正确设置时，SAK 值可以正常工作，并且它们通常是默认值（但我认为这取决于它是哪种项目类型）。如果它们没有出现在您的项目中，只需粘贴到此属性组中。

```
<PropertyGroup>
    <SccProjectName>SAK</SccProjectName>
    <SccProvider>SAK</SccProvider>
    <SccAuxPath>SAK</SccAuxPath>
    <SccLocalPath>SAK</SccLocalPath>
</PropertyGroup> 
```

将这两行添加到 SourceCodeControl GlobalSection 中的 *.sln。只要项目文件具有 SAK 值，它们就应该从解决方案继承名称。

```
SccProjectName0 = Perforce\u0020Project
SccProvider0 = MSSCCI:Perforce\u0020SCM 
```

不需要签入 *.vsscc、*.vspscc 或 *.SCC 文件（尽管它们将在打开解决方案时生成）。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-11-07T04:16:27.600

很差。我知道这不是您正在寻找的问题的答案（将来，也许您可​​以缩小焦点？），但是与 Visual Studio 的源代码控制集成很糟糕。原因是他们都必须使用微软糟糕的 SCC 界面。这是可悲的！他们将源代码控制信息放在项目文件中！他们为什么要那样做？

只需放弃 Visual Studio 集成并使用 Perforce 客户端。没有那么多额外的工作。您不能每天花 30 秒切换到 Perforce 客户端并从那里签入/签出文件吗？

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-06T12:52:39.023

我可以回答最后一个。

为了使源代码控制绑定即使在您创建新分支时也能正常工作，请遵循严格的层次结构：

```
/Solution
  /library1
  /library2
  /product1
  /product2
  /subsolution
    /sublibrary1
    /subproduct1 
```

每个文件必须恰好位于一个 .vcproj 中。您可以在同一目录中拥有多个 .vcproj，但如果它们共享文件，则共享文件必须进入它们自己的 .vcproj。

如果您对此坚持不懈，那么所有 Scc 内容都将是相对路径，因此新分支将起作用（因为它仅更改最顶层的目录）。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2013-06-11T17:20:26.173

这不是 Perforce 问题，而是 Visual Studio 问题。修改源文件以允许 Visual Studio 了解正在使用的 SCM 工具的荒谬要求是愚蠢的。

简单的答案是“停止使用 Visual Studio 源代码控制集成”。这简直糟透了。即使使用 TFS，它也很糟糕。

如果您希望能够从 Visual Studio 中签出，只需创建一个自定义工具。只需使用适当的 VS 变量简单地调用“p4 edit”即可。想要还原文件？同样的想法...调用 p4 revert 并使用适当的变量。完毕。

使用 p4v 来管理您的源代码控制需求（提交、历史记录、差异等）。Visual Studio 就像一个源代码编辑器。它作为一个单片机接口很糟糕。

# web-applications - 将图像存储在 Web 服务器上。多少本？什么尺寸？

> ID：261528
> 
> 赞同：2
> 
> 时间：2008-11-04T11:02:16.517
> 
> 标签：web-applications

我的网络应用程序允许用户上传他们计划销售的商品的图片。我试图在让买家了解商品状况的足够大和足够详细的图像与足够小的图像之间找到一个很好的折衷方案，这样他们就不会大大降低网站的速度。

此外，我还需要缩略图来快速查看多个项目。

当用户上传他们的文件时，我应该在我的服务器上存储原始副本和调整大小的版本吗？如果是这样，我应该对这些文件大小施加一个普遍接受的限制，以便在质量和图像大小之间取得良好的平衡？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-04T11:06:19.690

小图像仍然可以使用 - 如果您想阻止这种情况，我会选择小+水印。至少这是大多数库存照片网站正在做的事情。

我还建议查看 Amazon s3 以存储大量图像。应该真的可以帮助您减轻服务器负载。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-04T11:09:09.793

在讨论大小限制的细节之前，先计算一下您将拥有多少张图片、平均大小是多少以及实际存储成本是多少。

你会发现你花在担心它上的时间是不值得的。存储成本如此之低，您的时间可能最好花在其他事情上。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-04T11:41:57.497

要回答您的具体问题，如果他们正在上传您正在调整大小的版本并且您不需要原始版本然后丢弃它。您甚至可以考虑确保他们上传的图片不大于您的“全尺寸”图片要求，以节省一些处理时间。

您要执行的限制将取决于各种因素，包括您可用的存储空间和带宽、支持的文件格式、待售商品数量和流量的预测、页面设计、浏览器功能您的大部分用户群...等。没有“普遍接受”的限制。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-04T12:11:39.310

不要对用户施加任何限制。无论如何，用户可能没有关于如何减小尺寸的工具或知识。如果需要，您可以随时在服务器上调整大小。

我创建了几个具有图片库的网站，我们通常存储三个文件。

1.  原始（例如，如果预览大小对于所有情况都足够大，则不需要这样做）

2.  缩略图（大小取决于设计。通常在 120x80 左右）

3.  预览（大小取决于设计。通常在 640x480 左右）

在您的情况下，您可能应该存储原件。无论您选择什么尺寸，请确保它们与您在客户端显示的尺寸相同。浏览器不擅长调整大小...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-04T23:59:50.067

我会从另一个方向解决这个问题。我不会在上传时生成您需要的不同文件大小并以这种方式存储它们，而是执行以下操作：

*   将图像大小调整为您将在网站上使用的最大尺寸，注意 DPI 和 W&H。调整大小后，请记住[锐化图像](http://maettig.com/?page=PHP/imagesharpen)。
*   仅根据请求生成较小的图像，但使用缓存确保仅在缓存不存在时才生成较小的图像
*   一旦存储空间成为一个选项，启动一项任务，该任务将核对在 x 天内未访问的文件，根据每次运行要恢复的数据大小确定 x。一旦 x 开始变得异常小，您就会知道是时候增加存储容量了。

# asp.net - 无法将更改上传到 ASP.NET - 发布功能不会上传更改

> ID：261531
> 
> 赞同：0
> 
> 时间：2008-11-04T11:03:35.797
> 
> 标签：asp.net, deployment

我开发了一个 asp.net 应用程序，在 Visual Studio 2008 中使用发布工具时，我的更改不会上传到服务器（即新的 css 文件）。我在 asp.net 上创建了一个线程，并被告知要清除我的文档/应用程序数据中的本地设置文件夹，但是因为我在工作的联网电脑上，所以我没有这个文件夹。还有其他方法可以解决这个问题吗？

另外，我尝试复制（出于绝望尝试了任何方法），但这不起作用，因为该站点现在已预编译。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-04T12:39:22.157

你总是可以使用 FTP。我个人从不使用“发布”，我使用[Beyond Compare](http://www.scootersoftware.com/)来满足我所有的发布需求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-04T16:12:27.593

请尝试以下操作以排除权限错误：

1.  使用 unc 路径导航到服务器虚拟目录
2.  在发布的 web.config 中编辑 List 项键值对并检查是否能够保存更改
3.  如果成功，请尝试手动删除所有文件，然后发布更改。
4.  如果仍然无法发布到本地文件夹，则从本地文件夹复制到远程服务器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-04T16:26:56.753

像 Jeff Sheldon 一样，我在开发环境中使用 Beyond Compare 推送到我的开发服务器。不过，当我准备好推送到生产环境时，我会发布到我工作站上的另一个目录并使用 Beyond Compare 将编译后的站点推送到生产环境。

发布应该复制您的解决方案看到的所有内容。如果您在 Visual Studio 之外的目录结构中添加了一些内容，并且未在解决方案中刷新该目录，则它可能不会发布。

# php - PHP SimpleXML、CodeIgniter 和 Apache 与 Suhosin

> ID：261534
> 
> 赞同：2
> 
> 时间：2008-11-04T11:05:02.783
> 
> 标签：php, xml, apache, simplexml, suhosin

我有一个使用 CodeIgniter 框架用 PHP5 编写的应用程序。我让它在 Windows（使用 Xampp）和 Ubuntu（使用标准 Apache、PHP、MySQL 堆栈）上运行。

我有一个表单，它接受 XML，解析它（使用 simpleXML）并将结果发布到数据库中。

在 Windows 上 - 没问题，按预期工作。

在 Linux 上 - 大问题。它出错了。

我已经仔细检查了 XML，这很好。

我删除了大量的XML，似乎还可以。

我认为这与从表单发布的 XML 字符串的大小有关，但不确定。同样，在 Windows 上没问题 - 在 Linux 上，它会出错。

表格中发布的数据大小约为 160k（是的，这是很多文本，但它是自动化的 - 最终将达到 200k 左右）。

错误如下。

非常感谢任何帮助。

> 致命错误：在 /var/www/ci/system/application/controllers/system.php:49 中未捕获的异常“异常”和消息“字符串无法解析为 XML” 堆栈跟踪：#0 /var/www/ci/ system/application/controllers/system.php(49): SimpleXMLElement->__construct('') #1 [内部函数]: System->add_system() #2 /var/www/ci/system/codeigniter/CodeIgniter.php (233): call_user_func_array(Array, Array) #3 /var/www/ci/index.php(115): require_once('/var/www/ci/sys...') #4 {main} 抛出 /第 49 行的 var/www/ci/system/application/controllers/system.php

第 49 行如下所示：

`$xml = new SimpleXMLElement($this->input->post('form_systemXML'));`

编辑 - 固定

发现问题。Suhosin 安装在 Ubuntu 上。在文件 /etc/php5/apache2/conf.d/suhosin.ini 中，我启用了该行`suhosin.post.max_value_length = 65000`并将值更改为 195000。重新启动 Apache，一切正常。谢谢各位指点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-04T12:13:05.390

您似乎正在运行[Suhosin](http://www.hardened-php.net/suhosin/) PHP 扩展。请查看配置文档：[http](http://www.hardened-php.net/suhosin/configuration.html) ://www.hardened-php.net/suhosin/configuration.html 。

相关选项似乎是（我从未使用过 Suhosin 扩展）： suhosin.post.max_value_length[和](http://www.hardened-php.net/suhosin/configuration.html#suhosin.post.max_value_length)/或[suhosin.request.max_value_length](http://www.hardened-php.net/suhosin/configuration.html#suhosin.request.max_value_length)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-04T11:28:06.590

请检查您在 Linux 机器上的 PHP 配置，并将其与您的 Windows 设置进行比较。特别是以下设置：

*   内存限制
*   post_max_size
*   magic_quotes_gpc
*   最大输入时间

也许您可以转储发布到脚本的数据

```
print_r($_POST); 
```

查看真正进入服务器的数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-04T11:24:58.857

您可能已经尝试过这种方法，但是您检查了行尾吗？\r\n (DOS) 而不是 \n (UNIX)？可能是simpleXML使用的正则表达式可能会在不同的平台上被它们混淆......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-04T12:01:19.143

更新 - 在系统日志中找到了这个

11 月 4 日 21:53:32 ubu804 suhosin[7944]：警报 - 超出了配置的请求变量值长度限制 - 删除了变量“form_systemXML”（攻击者“127.0.0.1”，文件“/var/www/ci/index.php”）

我现在正在查看 apache 配置。

# asp.net - 获取 IIS 条目的元数据库路径（安装已停止，因为指定的路径不是有效的 Web 应用程序）

> ID：261535
> 
> 赞同：3
> 
> 时间：2008-11-04T11:05:31.613
> 
> 标签：asp.net, iis, metabase, aspnet-regiis.exe

我绝不是系统管理员，所以如果我错了，请纠正我。

我想运行 aspnet_regiis.exe -s。这需要我网站的元数据库路径。

如何找到此元数据库路径？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-13T05:38:24.750

只需运行 aspnet_regiis.exe -lk 即可查看已注册应用程序的列表、它们的元数据库路径以及为此应用程序安装的 .NET 框架版本。

此外，您可以使用以下几个链接来查找元数据库路径：

*   [http://msdn.microsoft.com/en-us/library/ms524682.aspx](http://msdn.microsoft.com/en-us/library/ms524682.aspx)
*   [http://www.windowsdevcenter.com/pub/a/windows/2005/10/25/hacking-iis6-with-metabase-explorer.html](http://www.windowsdevcenter.com/pub/a/windows/2005/10/25/hacking-iis6-with-metabase-explorer.html)
*   [http://www.codersource.net/csharp_iis_metabase.html](http://www.codersource.net/csharp_iis_metabase.html)

高温下，

大学教师

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-26T23:08:16.000

对于高于 Vista 的 Windows 版本，请使用“列表站点”命令尝试[appcmd](http://www.iis.net/learn/get-started/getting-started-with-iis/getting-started-with-appcmdexe)：

> %WindowsDirectory%\system32\inetsrv\appcmd 列表站点

这应该为您提供系统上所有站点的站点名称和 ID。

元数据库路径的形式为

> `/W3SVC/<site id>/Root`

加上站点ID。

# http - HTTP 状态 504

> ID：261536
> 
> 赞同：76
> 
> 时间：2008-11-04T11:05:48.663
> 
> 标签：http

当我的 win32 (c#) 应用程序调用 Web 服务时，我收到以下错误。

```
The request failed with HTTP status 504: Gateway timeout server response timeout. 
```

我理解“我认为”这是因为上游请求没有及时得到响应。

但我的问题是这个？如何更改我的 win32 应用程序中的**app.config**设置以留出更多时间来处理其数据。我假设我需要在我的应用程序设置上进行这些更改，因为托管 ws 的 Web 服务和 IIS 设置时间较长。

期待回复，并在此先感谢您。

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2011-12-13T19:08:22.710

你不能。问题不在于您的应用程序不耐烦并且超时；问题是中间代理不耐烦并且超时。“服务器在充当网关或代理时，没有收到来自 URI 指定的上游服务器的及时响应。” ( [http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.5.5](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.5.5) ) 这很可能表明源服务器存在某种问题，因此它没有快速响应转发的请求。

可能的解决方案，其中没有一个可能让您满意：

*   增加代理的超时值（如果它在您的控制之下）
*   向另一台服务器发出请求（如果有另一台服务器具有相同的数据）
*   以不同的方式提出您的请求（如果可能），以便您一次请求较少的数据
*   一旦服务器没有问题再试一次

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2008-11-04T11:19:16.763

CheckUpDown[对 504 错误有一个很好的解释](http://www.checkupdown.com/status/E504.html)：

> 服务器（不一定是 Web 服务器）充当网关或代理来满足客户端（例如您的 Web 浏览器或我们的 CheckUpDown 机器人）访问所请求的 URL 的请求。此服务器没有从它访问以处理您的 HTTP 请求的上游服务器收到及时响应。
> 
> 这通常意味着上游服务器已关闭（对网关/代理没有响应），而不是上游服务器和网关/代理不同意交换数据的协议。
> 
> 此问题完全是由于后端计算机之间的 IP 通信速度较慢，可能包括 Web 服务器。只有在托管 Web 服务器的站点上设置网络的人员才能解决此问题。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-05-18T09:23:56.020

假设访问一个代理服务器A（例如nginx），服务器A将请求转发到另一个服务器B（例如tomcat）。

如果这个过程持续很长时间（超过代理服务器读取超时设置），A仍然没有得到B的完整响应。它发生了。

对于 nginx，你可以配置 proxy_read_timeout(in location) 属性来解决他的问题。但这通常不是一个好主意，如果你设置的值太高。这可能会隐藏真正的错误。你最好改进设计以真正解决这个问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-01-28T20:26:20.317

如果您使用 ASP.Net 5（现在称为 ASP.Net Core v1），请确保在您托管的每个站点的 project.json “命令”部分中，Kestrel 代理侦听端口在站点之间有所不同，否则一个站点将工作，但其他将返回 504 网关超时。

```
 "commands": {
    "web": "Microsoft.AspNet.Server.Kestrel --server.urls http://localhost:5090"
  }, 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-04-27T16:30:52.050

关于这个错误，我观察到的一件事是，它只出现在来自服务器的第一个响应中，如果是 http，它应该是握手响应。一旦立即响应从服务器发送到网关，如果在主响应花费时间之后它不会给出错误。这里的关键是服务器对请求的第一个响应应该很快。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-04-23T21:23:53.030

我遇到了另一个问题，给了我一个 504。它很遥远，但我会在这里为谷歌和后代写下来......

我有一个客户端调用托管在另一个域（Active Directory）中的 IIS 托管 Web 服务。客户端域与托管 Web 服务的域之间没有完全信任。这两个域之间的选择性信任的众多挑战之一是 Kerberos 在从一个域调用到另一个域时不起作用。

就我而言，我试图调用另一个域中的服务，在该域中我发现 SPN 已注册。像这样：http/myurl.test.local（只是一个例子）

这会强制调用使用 Kerberos 而不是让它回退到 NTLM，这给了我从调用服务器返回的 405。

删除 spn 并允许调用回退到 NTLM 后，它工作正常。

正如我所说的......这不是你可能会遇到的事情，因为大多数组织不会冒险在两个域之间建立如此选择性的信任......但它给出了 504 并导致我一些（更多）白发.

# c# - WCF 是否抑制第一次机会异常？

> ID：261539
> 
> 赞同：2
> 
> 时间：2008-11-04T11:08:27.347
> 
> 标签：c#, linq, wcf, exception

我有一个 WCF 服务，它使用 LinqToSql DataContext 从数据库中获取一些信息。操作的返回类型是 IEnumerable `<DomainObject`>，我有一个辅助方法，可以将表派生的 LINQ 对象转换为 WCF 数据协定，如下所示：

```
[OperationContract]
public IEnumerable<DomainObjectDTO> RetrieveDomainObjects()
{
    var context = CreateDataContext();
    return from domainObject in context.DomainObjects
           select ConvertDomainObject(domainObject);
}

private DomainObjectDTO ConvertDomainObject(DomainObject obj)
{
    // etc...
} 
```

如果我将无效的连接字符串传递给 DataContext，此代码会表现出奇怪的行为。由于无法找到正确的数据库，推测上面的代码在枚举 IEnumerable `<DomainObjectDTO`> 时抛出了 SqlException。但是，当我在调试器中运行此代码时，我在服务器端根本看不到第一次机会异常！我在 Exceptions 选项卡中告诉调试器中断所有抛出的 CLR 异常，但它根本没有。我也没有在输出窗口中看到特征性的“第一次机会异常”消息。

在客户端，我收到一个带有错误消息的 CommunicationException，类似于“套接字连接意外终止”。没有任何内部异常提供有关问题根本原因的任何提示。

我能解决这个问题的唯一方法是重写 LINQ 代码，以便在 OperationContract 方法内部评估查询表达式。顺便说一句，如果存在权限问题，或者如果我将 DataContext 包装在 using 语句中，我会得到相同的结果，因此这不仅仅与 SqlExceptions 隔离。

忽略将返回类型设置为 IEnumerable `<T`> 并且仅在序列化程序深处的某处枚举查询的不可取之处，WCF 是否会抑制或以某种方式防止在这种情况下引发异常？如果是这样，为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-01-25T22:10:35.420

> 在这种情况下，WCF 是否会抑制或以某种方式防止引发异常？如果是这样，为什么？

我对 WCF 了解不多，但对我来说听起来不太可能。

首次机会异常的特殊之处在于它直接进入调试器，并且调试器有机会在实际引发异常*之前*看到它- 因此有“第一次机会”一词 - 调试器有“第一次机会”来处理例外。怎么可能绕过它？它必须是某种方式来阻止完全引发异常。（CLR 中是否有可以做到这一点的安全性或可靠性功能？）。

我可以提出的最佳替代解释是，在您期望抛出 SqlException 之前出现问题。我还会尝试查看非托管异常，而不仅仅是托管异常，以防例如尝试使用托管 IEnumerable 的非托管序列化代码出现问题或某些 CLR 错误...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-04T11:31:47.877

至少在我的经验中，WCF 似乎确实可以在异常情况下发挥一些作用。我真的不确定它对异常有什么作用，但我发现如果 FaultContract 属性用于指定合同可能抛出的异常，它至少会向客户端提供更多关于错误原因的信息发生了。

我们还将捕获任何异常并将它们作为 FaultExceptions 重新抛出，例如：

```
try
{
    DoSomething();
}
catch ( Exception ex )
{ 
   throw new FaultException<CustomException>( new CustomException( ex ), ex.Message );
} 
```

在故障合同中指定了自定义异常。这似乎为客户提供了有关异常的更多信息。因此，我怀疑如果您将 SQLException 添加为 FaultContract 的一部分，那么它将被发送到客户端。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-04T16:21:07.450

尝试将以下内容放入您的客户端和服务的 App.config 中：

```
<system.diagnostics>
<sources>
    <source name="System.ServiceModel" switchValue="Verbose,ActivityTracing"
        propagateActivity="true">
        <listeners>
            <add type="System.Diagnostics.DefaultTraceListener" name="Default">
                <filter type="" />
            </add>
            <add name="NewListener">
                <filter type="" />
            </add>
        </listeners>
    </source>
</sources>
<sharedListeners>
    <add initializeData="C:\App_tracelog.svclog"
        type="System.Diagnostics.XmlWriterTraceListener, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"
        name="NewListener" traceOutputOptions="LogicalOperationStack, DateTime, Timestamp, ProcessId, ThreadId, Callstack">
        <filter type="" />
    </add>
</sharedListeners> 
```

然后在 Windows SDK 附带的服务跟踪查看器中加载两个生成的日志文件。您将能够看到以这种方式抛出的实际异常。

链接：http: [//msdn.microsoft.com/en-us/library/aa751795.aspx](http://msdn.microsoft.com/en-us/library/aa751795.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-04T11:14:31.657

您是否配置了“ [IncludeExceptionDetailInFaults](http://msdn.microsoft.com/en-us/library/system.servicemodel.description.servicedebugbehavior.includeexceptiondetailinfaults.aspx) ”设置？（出于安全目的，它默认为“假”）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-04T11:15:07.070

WCF 是一种奇特的野兽，它稍微超出了常规 IIS 的范围。可能是标准调试出现故障。但是，您可以尝试[启用调试异常](http://msdn.microsoft.com/en-us/library/system.servicemodel.description.servicedebugbehavior.includeexceptiondetailinfaults.aspx)，和/或实现（和配置）您自己的[`IErrorHandler`](http://msdn.microsoft.com/en-us/library/system.servicemodel.dispatcher.ierrorhandler.aspx)以记录问题。

另一种选择：这里的混合中是否可能有一个迭代器块（`yield return`）？在迭代枚举器之前，不会对迭代器块中的*任何内容进行评估，这可能会导致一些看起来很奇怪的问题，这些问题应该早先验证过。*在上述情况下，这不是问题（否`yield return`），但值得关注。

例如，以下是*非常*不同的：

```
var context = CreateDataContext();
var query = from domainObject in context.DomainObjects
       select ConvertDomainObject(domainObject);
foreach(var item in query) { yield return item; } 
```

# ruby-on-rails - 如何在包含的模块中删除验证集？

> ID：261543
> 
> 赞同：2
> 
> 时间：2008-11-04T11:09:34.943
> 
> 标签：ruby-on-rails, validation, activerecord

有没有办法删除在 Rails 插件（或包含的模块）中设置的验证？假设我有一些包含模块的模型：

```
class User < ActiveRecord::Base
  include SomeModuleWithValidations
  # How to cancel validates_presence_of :something here?
end

module SomeModuleWithValidations
  def self.included(base)
    base.class_eval do
      validates_presence_of :something
    end
  end  
end 
```

到目前为止，我唯一的想法是做类似的事情：

```
validates_presence_of :something, :if => Proc.new{1==2} 
```

我认为这会起作用，但它并不是特别漂亮。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-04T12:23:17.010

您可以在类中重载 validates_precense_of。就像是：

```
def self.validates_presence_of(*args)
  return if args.first == :foo
 super
end 
```

或者如果你有 validates_presence_of :foo 你可以这样做：

```
def foo
  self[:foo] || ""
end 
```

但是，这些解决方案都不是很好。在模块中取消注释或将其重新定义为仅在该模块中无操作很可能会更容易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-08T10:52:06.457

请参阅[http://casperfabricius.com/site/2008/12/06/removing-rails-validations-with-metaprogramming/](http://casperfabricius.com/site/2008/12/06/removing-rails-validations-with-metaprogramming/)

# javascript - 即使客户端验证失败，Asp:RadioButtonList 仍会回发到服务器？

> ID：261547
> 
> 赞同：1
> 
> 时间：2008-11-04T11:10:37.653
> 
> 标签：javascript, asp.net, input, dom-events

这个查询与我昨天问的[这个有关。](https://stackoverflow.com/questions/259850/javascript-multiple-client-side-validations-on-same-event)我的 asp.net 页面上有一个单选按钮列表，定义如下：

```
<asp:RadioButtonList ID="rdlSortBy" runat="server" RepeatDirection="Horizontal" RepeatLayout="Flow" AutoPostBack="True" >
       <asp:ListItem Selected="True">Name</asp:ListItem>
        <asp:ListItem>Staff No</asp:ListItem>
</asp:RadioButtonList> 
```

在客户端，正在执行以下验证：

```
rdlSortBy.Attributes("onclick") = "javascript:return prepareSave() && prepareSearch();" 
```

问题是 Javascript 验证按预期运行。显示一条消息，我希望保留在页面上，直到用户保存更改，而不是返回页面，实际上我正在丢失未保存的更改。

可能出了什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-07T10:30:09.293

我解决了这个问题，问题是我将 RadioButtonList 的“onclick”附加到了单个单选按钮上。

这是修复：

```
rdlSortBy.Items(0).Attributes("onclick") = "javascript:return isDirtied() && prepareSearch();"
    rdlSortBy.Items(1).Attributes("onclick") = "javascript:return isDirtied() && prepareSearch();" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-04T11:55:40.763

正在运行您用于“验证”的`OnClick`代码，然后运行将控件本身注入的表单的代码正在运行。

您需要拦截该 PostBack 进程并在它发布表单客户端之前停止它。最好的方法是使用一个`CustomValidator`特别是“ClientValidationFunction”属性。这将允许您的 JavaScript 发出信号，表明不应由于验证错误而发生回发。

# c++ - 在不同配置之间共享 .obj 文件

> ID：261548
> 
> 赞同：0
> 
> 时间：2008-11-04T11:11:16.467
> 
> 标签：c++, visual-studio

我的目标是将测试集成到我的开发环境中（作为构建后步骤）。我不想干扰调试和发布中生成的 DLL，所以我计划为项目创建新配置。但我不想编译我拥有的每个源文件两次——一次用于 DLL，一次用于测试单元——我想共享生成的目标文件。我怎样才能做到这一点？

我正在使用 Visual Studio 2005 在 c++ 中进行开发。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-06T21:43:38.110

将 obj 编译到一个新的 lib 项目中，该项目在 dll 和您的测试项目之间共享。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-04T11:13:27.213

编译器的每个配置都有一个“中间”目录。如果其中的 .obj 文件比它编译的源文件更新，它不会重新生成它们。

# asp.net - 如何使用asp.net将值插入Excel工作表中的单元格

> ID：261554
> 
> 赞同：-1
> 
> 时间：2008-11-04T11:14:29.863
> 
> 标签：asp.net, excel

如何在 Asp.net 的 Excel 工作表中的特定单元格中插入数据

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-04T12:32:51.390

我知道的两种主要方式：

1.  使用第三方工具，我使用[Aspose](http://www.aspose.com/)
2.  更改页面的内容类型（仅用于输出）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-04T11:28:32.423

我认为您需要提供更多信息..

在我的脑海中，你可以通过多种不同的方式来解决这个问题：

*1)* MS Office 自动化 - 使用 javascript，您可以打开 Excel，打开“正确”文档，然后在单元格中插入特定数据。

**这种方法的问题**

您需要确保您的站点在 IE 中的受信任站点列表中才能执行办公自动化。除非您正在编写 Intranet 应用程序，否则这可能是不可能的。

我以前只在 IE 中使用过自动化，它可能在 Firefox 中不起作用。

它依赖于用户安装了 Excel 并将正确的文件下载到他们的计算机并可用。

*2）*滚动您自己的 Excel 文档 - 如果您的用户版本的 Excel 支持 xml 工作表，这可能是最简单的，打开 excel 表服务器端，然后使用 XPath 查询之类的东西在工作表中查找相关单元格并插入您的数据。作为 HTTP 响应的一部分，将工作表流式传输给用户。

**这种方法的问题**

电子表格将始终来自服务器副本，除非您提供某种机制让用户首先上传他们的电子表格。但是，这有很多与之相关的问题。

*3)*购买 Excel 电子表格生成器应用程序 - 有许多程序已经将创建“真实”（即 .xls）电子表格的过程封装成易于使用的 .dll 库。

**这种方法的问题**

$$$ 参与。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-04T11:21:43.047

工作表是否已经存在？如果是这样，您可以使用开源组件[Koogra和来自](http://sourceforge.net/projects/koogra/)[Infragistics](http://infragistics.com/)的商业组件（还有其他组件）打开工作表，并在代码中对其进行修改。另一种方法是使用 excel 自动化打开工作表，但不建议在 Web 项目中这样做。

顺便一提。[你不是第一个问这个问题的人。](https://stackoverflow.com/questions/tagged/excel)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-04T13:08:58.743

除非您网站的每个用户都有自己的工作表，否则这是一个非常糟糕的主意。网站本质上是并行的，Excel 根本不做任何事情来支持并发访问。

# git - 我需要阅读什么来了解 git 的工作原理？

> ID：261557
> 
> 赞同：101
> 
> 时间：2008-11-04T11:16:22.447
> 
> 标签：git

我想从建筑师的角度了解 git 的工作方式。文件如何存储、版本如何保存以及更改如何发生（分支、合并等）？

我不是在寻找如何使用它的信息。（我已经找到了很多带有教程的页面。）但是我没有找到任何“幕后”细节，这会让我明白。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2008-11-04T13:21:38.920

[http://eagain.net/articles/git-for-computer-scientists/](http://eagain.net/articles/git-for-computer-scientists/)

[http://www.loria.fr/~molli/pmwiki/uploads/Main/gitmanual.pdf](http://www.loria.fr/~molli/pmwiki/uploads/Main/gitmanual.pdf) 第 7 章

[自下而上的 Git](http://ftp.newartisans.com/pub/git.from.bottom.up.pdf "自下而上的 Git")

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-11-04T18:40:50.257

对我来说，以下三个资源非常非常有用，按以下顺序排列：

1.  [The Thing About Git](http://tomayko.com/writings/the-thing-about-git)解释了为什么我什至应该关心

2.  [Git Magic](http://www-cs-students.stanford.edu/~blynn/gitmagic/)解释了如何开始

3.  [Git The Basics](http://www.jukie.net/~bart/slides/intro-to-git/intro-to-git.pdf) [pdf] 以图形和详细的方式解释了当我添加、删除、合并等时会发生什么。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-04T19:03:03.363

[Git Internals](http://peepcode.com/products/git-internals-pdf)电子书已经被提及。我要指出的是，它的作者 Scott Chacon[在 RailsConf 2008 上](http://blip.tv/scott-chacon/git-talk-4113729)做了一个关于 git 的精彩演讲，内容与本书大致相同。

说 Scott 现在维护[http://git-scm.com/](http://git-scm.com/)，其中包括[Git 社区书](http://book.git-scm.com/)，这更像是一个使用教程而不是技术描述，但在介绍性中确实包括了对 git 数据模型的一个很好的概念概述章和最后一章中的详细说明。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-04T13:59:17.127

来自 PeepCode 的名为[Git Internals](http://peepcode.com/products/git-internals-pdf)的价值 9 100 多页的 PDF 书籍非常棒。它写得很好，使用了很棒、清晰的视觉效果，而且读起来也很快。我尽可能多地吸收免费的在线资料，但这本书让我脱颖而出。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2010-08-05T18:51:54.813

要了解 git 的工作原理，您需要阅读[**Pro Git**书籍，完全免费在线提供](http://progit.org/book/)。

[由GitHub](http://github.com/)背后的人之一 Scott Chacon 撰写。

我在亚马逊的评论中写下了[我对这本书的看法](http://www.amazon.com/review/R1BD5210WKXVA3/ref=cm_cr_pr_cmt?ie=UTF8&ASIN=1430218339)。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2011-01-18T09:36:44.413

假设我们生活在一个前 git 时代。并且您想编写一个比现有 vcs 更快更好的版本控制系统。你所需要的只是一个好主意。在那个时候，下面的文章会很有帮助。

[http://tom.preston-werner.com/2009/05/19/the-git-parable.html](http://tom.preston-werner.com/2009/05/19/the-git-parable.html)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-11-04T13:35:58.827

我发现这些页面很有用：

*   [gitcore 教程](http://www.kernel.org/pub/software/scm/git/docs/gitcore-tutorial.html)
*   [用户手册中的 git 概念](http://www.kernel.org/pub/software/scm/git/docs/user-manual.html#git-concepts)
*   [git仓库布局](http://www.kernel.org/pub/software/scm/git/docs/gitrepository-layout.html)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-11-04T13:17:06.137

有一个很好的 Google 技术讲座： [Linus Torvalds on git](http://www.youtube.com/watch?v=4XpnKHJAok8)

好吧，这不是什么值得阅读的东西，但它确实涵盖了一些 Git 内部结构和设计理念。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-11-04T12:53:00.023

当我用谷歌搜索“git架构”时，我发现了这个网站：http: [//speirs.org/2007/07/19/a-subversion-user-looks-at-git](http://speirs.org/2007/07/19/a-subversion-user-looks-at-git)

Git 有一个邮件列表：“majordomo@vger.kernel.org&body=subscribe%20git”（[http://git.or.cz/#community](http://git.or.cz/#community)）

这篇维基百科文章可能会有所帮助：[http://en.wikipedia.org/wiki/Git_(software)](http://en.wikipedia.org/wiki/Git_(software))

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-11-04T13:56:43.153

有一天，我真的坐下来阅读了整本[Git 用户手册](http://www.kernel.org/pub/software/scm/git/docs/user-manual.html)。结果证明这是一个好主意——该手册非常有帮助，解释了很多，并且非常清晰并提供了有用的示例。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-11-04T13:25:19.100

[Randal Schwartz 的这次演讲](http://www.youtube.com/watch?v=8dhZ9BXQgc4)给了我一个很好的概述。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-11-04T11:33:45.143

git 源代码。:-)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-11-04T15:16:17.050

在 git 源代码的[Documentation/technical](http://repo.or.cz/w/git.git?a=tree;f=Documentation/technical;hb=HEAD)目录中有一些有趣的文档。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-11-04T13:05:52.057

[维基百科](http://en.wikipedia.org/wiki/Git_(software)#Implementation)可能会让您入门。

我确实记得遇到过一些描述一些内部架构的文档，所以我知道它们就在那里。我只是不记得他们在哪里...

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-11-04T13:07:35.470

我发现[Git 用户手册](http://www.kernel.org/pub/software/scm/git/docs/user-manual.html)非常有启发性。

# c++ - MFC 工具栏图标的颜色深度更高？

> ID：261559
> 
> 赞同：10
> 
> 时间：2008-11-04T11:16:28.470
> 
> 标签：c++, mfc, icons, toolbars

我想知道如何在 MFC 中制作一个使用 24 位或 256 色位图而不是可怕的 16 色位图的工具栏。

谁能指出我一些简单代码的方向？

谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-04T11:31:50.873

发生这种情况的原因是 MFC CToolbar 类在内部使用了一个初始化为仅使用 16 色的图像列表。解决方案是创建我们自己的图像列表并告诉工具栏使用它。我知道这适用于 256 色，但我还没有用更高的位深度测试它：

首先，从资源中加载 256 色位图：

```
HBITMAP hBitmap = (HBITMAP) ::LoadImage(AfxGetInstanceHandle(),
    MAKEINTRESOURCE(IDR_MAINFRAME), IMAGE_BITMAP,
    0,0, LR_CREATEDIBSECTION | LR_LOADMAP3DCOLORS);
CBitmap bm;
bm.Attach(hBitmap); 
```

接下来，创建一个 256 色图像列表并将我们的位图添加到其中：

```
CImageList m_imagelist.Create(20, 20, ILC_COLOR8, 4, 4);
m_imagelist.Add(&bm, (CBitmap*) NULL); 
```

最后，我们需要告诉工具栏使用新的图像列表：

```
m_toolbar.GetToolBarCtrl().SetImageList(&m_imagelist); 
```

VS2008中的新MFC版本也可能解决了这个问题，因为我知道许多UI元素已经更新。我还没有真正尝试过使用它，所以我不能确定。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-28T22:32:20.303

该解决方案完美无瑕，您只需要稍微修复它：

```
CImageList m_imagelist;
m_imagelist.Create(20, 20, ILC_COLOR8, 4, 4); 
m_imagelist.Add(&bm, (CBitmap*) NULL); 
```

# c - 带消息传递的 IPC

> ID：261560
> 
> 赞同：3
> 
> 时间：2008-11-04T11:18:04.427
> 
> 标签：c, operating-system

我正在寻找关于我可以在我自制的 AVR32 板操作系统中实现的可能 IPC 机制的建议。

我目前的选择是实现 Tanenbaum 所著书籍中描述的按摩传递机制。

这是一个不错的选择吗？有没有更简单的方法来实现 IPC？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-04T18:27:42.670

我的建议是在做出任何决定之前查看 QNX RTOS (www.qnx.com) 支持的消息传递原语。我花了几年时间在那个环境中编写了一个复杂的多进程系统，它是我遇到过的最好的基于消息的 O/SI。

突然想到的一些具体点（现在已经有一段时间了）：

1.  内核在进程内存空间之间复制的消息数据，以便一个进程中的错误不会影响另一个进程。
2.  能够发送和阻止回复。
3.  能够将消息放入队列并立即继续。
4.  能够无限期地发送消息块直到接收者响应；接收者可能同时接收和处理其他消息——这比你最初想象的更有价值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-04T18:30:09.483

也许[ZeroMQ](http://www.zeromq.org/)项目可以成为您的替代方案？

# c# - 在 C# 中使用 SendMessage 或 PostMessage 进行控件到主机应用程序的通信？

> ID：261561
> 
> 赞同：0
> 
> 时间：2008-11-04T11:18:31.680
> 
> 标签：c#, winapi

找到了这篇文章，并且在 stackoverflow.com 上也提出了类似的问题

[http://www.codeproject.com/KB/miscctrl/AppControl.aspx](http://www.codeproject.com/KB/miscctrl/AppControl.aspx)

我想出了一种在控件与其托管的 exe 之间进行通信的方法是使用下面的链接

[http://boycook.wordpress.com/2008/07/29/c-win32-messaging-with-sendmessage-and-wm_copydata/](http://boycook.wordpress.com/2008/07/29/c-win32-messaging-with-sendmessage-and-wm_copydata/)

但是，SendMessage 总是返回 0。而且我的所有消息都不是 recvd？我怎样才能让它工作。我什至尝试过 PostMessage 但无济于事。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-04T12:41:29.967

虽然 SendMessage/PostMessage 对于将消息从一个应用程序发送到另一个应用程序非常方便，但您最好使用事件在同一个应用程序内进行通信。

# c++ - 函数参数：复制还是指针？

> ID：261567
> 
> 赞同：9
> 
> 时间：2008-11-04T11:23:05.150
> 
> 标签：c++, function, parameters, copy, pointers

我是 C++ 的新手，有一些问题，这就是其中之一。

当您使用接受一个或多个参数的函数时，是否有任何理由，您知道在函数调用之前将始终存储在变量中的参数传递变量的副本，而不是指向变量的指针?

我说的是性能。在我看来，传递整个结构的副本比仅传递一个指针（4 个字节）需要更多的资源。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-04T11:34:16.267

有几种方法可以使传递副本比传递指针更便宜。

1.  对象等于或小于指针。直接访问一个值总是比取消引用一个指针要快。
2.  该结构足够小，可以由编译器放入堆栈。在这种情况下，对结构中的值的访问是通过索引寻址模式而不是间接的索引寻址模式完成的。前者通常更快。

想要传递副本而不是引用还有其他原因，即您的函数将对结构进行更改，这些更改不会反映给调用者。虽然这通常是一种不好的做法，但使参数按值传递将确保调用者的视图不会被错误地更改。

现在对于您可能不想听到的部分答案：它通常不会产生太大的影响！使用对程序语义最有意义的参数传递方法。如果您稍后发现某个特定领域存在性能瓶颈，那么请专注于提高那里的性能。不要过度优化！

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-11-04T11:35:32.347

通过指针（或引用）传递对象和传递同一对象的副本具有不同的语义。如果希望对对象所做的更改反映在函数调用之外，则需要引用语义，否则需要值语义。

通常，值语义可以通过按值传递值或通过 const 引用来表示

```
void value_semantics(my_obj obj);
void value_semantics(const my_obj& obj); 
```

然而， const 引用方式也有一些缺点，它阻止了编译器由于[别名问题](http://publib.boulder.ibm.com/infocenter/comphelp/v8v101/index.jsp?topic=/com.ibm.xlf101a.doc/xlfopg/aliasing.htm)而可能进行的一些优化，对于具有琐碎构造函数的对象，额外的间接级别（引用被实现为指针）可能超过避免的好处副本。

为了获得引用语义，您可以选择通过引用传递或通过指针传递，因为其他人已经说过引用比 C++ 中的指针更自然（您不必使用 operator 的地址`&`），并且指针的唯一真正优势是如果要启用 NULL 值。

经验法则是，对于非平凡的类，您应该通过 const 引用传递，否则按值传递。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-04T11:25:35.580

指针为错误打开，因为它允许被调用者更改对象。指针可以为 0，这往往会导致崩溃，这需要在所有地方测试 0 指针，这可能很烦人。在可能的情况下使用 C++ 引用`const`-declared 可以避免这两个问题。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-04T11:31:48.533

避免使用指针。如果是 IN 参数，请使用常量引用，否则仅引用 IN OUT 参数

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-04T11:31:00.890

主要问题不在于性能，而在于语义，以及您的函数是否会修改结构中的数据。

如果您的函数修改了结构，那么传递一个指针将使调用者看到结构中更改的数据。在这种情况下，传递一个副本可能是错误的，因为您的函数将修改一个副本，然后（可能）丢弃该副本。当然，您的函数可能会修改数据，但您不希望修改，在这种情况下，副本是正确的做法，以保护原始值不被更改。

如果您的函数不修改结构，则没有理由复制值，因为它们只会被读取。

如果您对将指针传递给结构的概念不满意，您应该进行一些练习，因为这是在 C 和 C++ 中处理结构的典型方式。

就性能而言，复制结构需要更多的工作，但在方案中它相当小。首先要注意代码的语义。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-04T11:25:11.323

引用更常见，如果它们不会更改，则为 const 引用。

# jquery - jQuery 控制具有相同类的单个 DIV（兄弟姐妹？）

> ID：261572
> 
> 赞同：1
> 
> 时间：2008-11-04T11:25:59.153
> 
> 标签：jquery, siblings

我正在为我的网站构建一个常见问题解答模块，我希望能够控制页面上的单个元素，即使它们都具有相同的类。我相信这属于我还不熟悉的兄弟姐妹。

基本上我希望用户能够单击问题 div，然后当他们单击它时，答案 div 与问题 div 设置显示在同一 div 中（如果这有意义！）。任何帮助将不胜感激。

```
<div class="set">
  <div class="question">What is the airspeed velocity of an unladen swallow?</div>
  <div class="answer">Although a definitive answer would of course require further measurements, published species-wide averages of wing length and body mass, initial Strouhal estimates based on those averages and cross-species comparisons, the Lund wind tunnel study of birds flying at a range of speeds, and revised Strouhal numbers based on that study all lead me to estimate that the average cruising airspeed velocity of an unladen European Swallow is roughly 11 meters per second, or 24 miles an hour. </div>
</div>

<div class="set">
  <div class="question">What is the airspeed velocity of an unladen swallow?</div>
  <div class="answer">Although a definitive answer would of course require further measurements, published species-wide averages of wing length and body mass, initial Strouhal estimates based on those averages and cross-species comparisons, the Lund wind tunnel study of birds flying at a range of speeds, and revised Strouhal numbers based on that study all lead me to estimate that the average cruising airspeed velocity of an unladen European Swallow is roughly 11 meters per second, or 24 miles an hour. </div>
</div>

<div class="set">
  <div class="question">What is the airspeed velocity of an unladen swallow?</div>
  <div class="answer">Although a definitive answer would of course require further measurements, published species-wide averages of wing length and body mass, initial Strouhal estimates based on those averages and cross-species comparisons, the Lund wind tunnel study of birds flying at a range of speeds, and revised Strouhal numbers based on that study all lead me to estimate that the average cruising airspeed velocity of an unladen European Swallow is roughly 11 meters per second, or 24 miles an hour. </div>
</div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-04T11:35:13.783

如果我正确理解您的问题，您应该首先将所有答案设置为隐藏在 css 中：.answer {display:none;}

然后您可以使用 jquery 显示点击问题的正确答案：

```
$(document).ready ( function () {
    $('.question').click(function() {
        $(this).next('.answer').show();
    });
}); 
```

编辑：您也可以使用 .toggle() 而不是 .show() 来显示/隐藏。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-04T11:35:27.807

您可能应该查看这个[问题](https://stackoverflow.com/questions/233936/jquery-swapping-elements)，其中做了类似的事情。

基本上，您首先需要为您的元素设置 ID，以便您可以识别集合类中的单个元素。

然后，您可以添加一个单击事件处理程序，该处理程序将设置所选项目并显示适当的答案。

[您可以在此处的文档](http://docs.jquery.com/Traversing/siblings)中查看获取兄弟姐妹的语法。

# algorithm - 在有向图中检测循环的最佳算法

> ID：261573
> 
> 赞同：429
> 
> 时间：2008-11-04T11:26:38.230
> 
> 标签：algorithm, graph-theory, directed-graph

是否有一种有效的算法来检测有向图中的循环？

我有一个有向图，表示需要执行的作业计划，作业是节点，依赖项是边。我需要在该图中检测导致循环依赖的循环错误情况。

* * *

## 回答 #1

> 赞同：205
> 
> 时间：2008-11-04T11:35:04.593

[Tarjan 的强连通分量算法](http://en.wikipedia.org/wiki/Tarjan%E2%80%99s_strongly_connected_components_algorithm)具有`O(|E| + |V|)`时间复杂度。

有关其他算法，请参阅Wikipedia 上的[强连接组件](http://en.wikipedia.org/wiki/Strongly_connected_components)。

* * *

## 回答 #2

> 赞同：81
> 
> 时间：2008-11-04T11:50:46.980

鉴于这是一个作业时间表，我怀疑在某些时候您会将它们*分类*为建议的执行顺序。

如果是这种情况，那么[*拓扑排序*](http://en.wikipedia.org/wiki/Topological_sorting)实现无论如何都可以检测循环。UNIX`tsort`当然可以。我认为因此在 tsorting 的同时检测周期可能比在单独的步骤中更有效。

所以问题可能变成“我如何最有效地进行排序”，而不是“我如何最有效地检测循环”。答案可能是“使用图书馆”，但没有以下维基百科文章：

> [http://en.wikipedia.org/wiki/Topological_sorting](http://en.wikipedia.org/wiki/Topological_sorting)

有一种算法的伪代码，以及来自 Tarjan 的另一种算法的简要描述。两者都有`O(|V| + |E|)`时间复杂度。

* * *

## 回答 #3

> 赞同：54
> 
> 时间：2019-01-01T13:02:03.033

根据[Cormen 等人的引理 22.11，*算法简介*](https://books.google.com/books?id=i-bUBQAAQBAJ&lpg=PP1&dq=cormen%20introduction%20to%20algorithms&pg=PP1#v=onepage&q=cormen%20introduction%20to%20algorithms&f=false)(CLRS)：

> 有向图 G 是非循环的当且仅当 G 的深度优先搜索不产生后边。

这已经在几个答案中提到过；这里我还将提供一个基于 CLRS 第 22 章的代码示例。示例图如下所示。

[![在此处输入图像描述](https://i.stack.imgur.com/RrsDe.png)](https://i.stack.imgur.com/RrsDe.png)

CLRS 的深度优先搜索伪代码如下：

[![在此处输入图像描述](https://i.stack.imgur.com/MIlwU.png)](https://i.stack.imgur.com/MIlwU.png)

在 CLRS 图 22.4 的示例中，该图由两棵 DFS 树组成：一棵由节点*u*、*v*、*x*和*y*组成，另一棵由节点*w*和*z*组成。每棵树都包含一个后边：一个从*x*到*v*，另一个从*z*到*z*（自循环）。

`DFS-VISIT`关键实现是，当在函数中迭代 的邻居`v`时`u`遇到带有`GRAY`颜色的节点时遇到后边。

以下 Python 代码是对 CLRS 伪代码的改编，并`if`添加了一个检测循环的子句：

```
import collections

class Graph(object):
    def __init__(self, edges):
        self.edges = edges
        self.adj = Graph._build_adjacency_list(edges)

    @staticmethod
    def _build_adjacency_list(edges):
        adj = collections.defaultdict(list)
        for edge in edges:
            adj[edge[0]].append(edge[1])
        return adj

def dfs(G):
    discovered = set()
    finished = set()

    for u in G.adj:
        if u not in discovered and u not in finished:
            discovered, finished = dfs_visit(G, u, discovered, finished)

def dfs_visit(G, u, discovered, finished):
    discovered.add(u)

    for v in G.adj[u]:
        # Detect cycles
        if v in discovered:
            print(f"Cycle detected: found a back edge from {u} to {v}.")

        # Recurse into DFS tree
        if v not in finished:
            dfs_visit(G, v, discovered, finished)

    discovered.remove(u)
    finished.add(u)

    return discovered, finished

if __name__ == "__main__":
    G = Graph([
        ('u', 'v'),
        ('u', 'x'),
        ('v', 'y'),
        ('w', 'y'),
        ('w', 'z'),
        ('x', 'v'),
        ('y', 'x'),
        ('z', 'z')])

    dfs(G) 
```

请注意，在此示例中，`time`未捕获 CLRS 的伪代码，因为我们只对检测周期感兴趣。还有一些样板代码用于从边列表构建图的邻接表表示。

执行此脚本时，它会打印以下输出：

```
Cycle detected: found a back edge from x to v.
Cycle detected: found a back edge from z to z. 
```

这些正是 CLRS 图 22.4 示例中的后边缘。

* * *

## 回答 #4

> 赞同：35
> 
> 时间：2009-04-21T01:14:14.680

最简单的方法是对*图进行深度优先遍历（DFT）*。

如果图有`n`顶点，这是一种`O(n)`时间复杂度算法。由于您可能必须从每个顶点开始进行 DFT，因此总复杂度变为`O(n^2)`.

您必须维护一个*包含当前深度优先遍历中所有顶点的堆栈*，其第一个元素是根节点。如果你在 DFT 期间遇到一个已经在堆栈中的元素，那么你就有了一个循环。

* * *

## 回答 #5

> 赞同：32
> 
> 时间：2016-05-26T08:16:56.627

在我看来，在有向图中检测循环最容易理解的算法是图形着色算法。

基本上，图着色算法以 DFS 方式遍历图（深度优先搜索，这意味着它在探索另一条路径之前完全探索一条路径）。当它找到一个后边时，它将图形标记为包含一个循环。

有关图形着色算法的深入解释，请阅读本文：[http ://www.geeksforgeeks.org/detect-cycle-direct-graph-using-colors/](http://www.geeksforgeeks.org/detect-cycle-direct-graph-using-colors/)

另外，我在 JavaScript [https://github.com/dexcodeinc/graph_algorithm.js/blob/master/graph_algorithm.js中提供了图形着色的实现](https://github.com/dexcodeinc/graph_algorithm.js/blob/master/graph_algorithm.js)

* * *

## 回答 #6

> 赞同：29
> 
> 时间：2010-12-30T20:02:16.603

*从 DFS 开始：当且仅当在 DFS 期间发现后沿*时才存在循环。这是白路径定理的结果。

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2008-11-04T12:15:46.370

如果您无法向节点添加“已访问”属性，请使用集合（或映射）并将所有已访问节点添加到集合中，除非它们已经在集合中。使用唯一键或对象的地址作为“键”。

这也为您提供了有关循环依赖项的“根”节点的信息，当用户必须解决问题时，这些信息将派上用场。

另一种解决方案是尝试找到下一个要执行的依赖项。为此，您必须有一些堆栈，您可以记住您现在在哪里以及接下来需要做什么。在执行之前检查依赖项是否已经在此堆栈上。如果是，你已经找到了一个循环。

虽然这似乎具有 O(N*M) 的复杂性，但您必须记住，堆栈的深度非常有限（因此 N 很小），并且 M 会随着您可以检查为“已执行”的每个依赖项而变小加上您可以在找到叶子时停止搜索（因此您**不必**检查每个节点 -> M 也会很小）。

在 MetaMake 中，我将图表创建为列表列表，然后在执行它们时删除每个节点，这自然会减少搜索量。我实际上从来不需要运行独立检查，这一切都是在正常执行期间自动发生的。

如果您需要“仅测试”模式，只需添加一个“空运行”标志即可禁用实际作业的执行。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2013-04-13T03:30:12.347

没有一种算法可以在多项式时间内找到有向图中的所有循环。假设有向图有 n 个节点，每对节点之间都有连接，这意味着你有一个完整的图。因此，这 n 个节点的任何非空子集都表示一个循环，并且有 2^n-1 个这样的子集。所以不存在多项式时间算法。因此，假设您有一个高效（非愚蠢）算法，可以告诉您图中有向循环的数量，您可以首先找到强连通分量，然后将您的算法应用于这些连通分量。因为循环只存在于组件内而不存在于它们之间。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2013-01-24T01:49:29.213

我已经在 sml（命令式编程）中实现了这个问题。这是大纲。查找入度或出度为 0 的所有节点。这样的节点不能成为循环的一部分（所以删除它们）。接下来从这些节点中删除所有传入或传出边。递归地将此过程应用于结果图。如果最后您没有留下任何节点或边，则该图没有任何环，否则它有。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2013-02-16T12:05:38.397

[https://mathoverflow.net/questions/16393/finding-a-cycle-of-fixed-length](https://mathoverflow.net/questions/16393/finding-a-cycle-of-fixed-length)我最喜欢这个解决方案，特别适合 4 长度:)

物理向导也说你必须做 O(V^2)。我相信我们只需要 O(V)/O(V+E)。如果图是连接的，那么 DFS 将访问所有节点。如果该图具有连接的子图，那么每次我们在该子图的顶点上运行 DFS 时，我们都会找到连接的顶点，并且不必在下一次运行 DFS 时考虑这些。因此，为每个顶点运行的可能性是不正确的。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-11-04T13:35:57.050

我这样做的方法是进行拓扑排序，计算访问的顶点数。如果该数字小于 DAG 中的顶点总数，则您有一个循环。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-05-12T07:16:29.210

如果 DFS 找到指向已经访问过的顶点的边，则那里有一个循环。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2017-04-12T05:48:45.427

正如你所说，你有一套工作，它需要按一定的顺序执行。`Topological sort`给定您安排作业所需的顺序（或者如果是 a ，则用于依赖性问题`direct acyclic graph`）。运行`dfs`并维护一个列表，并开始在列表的开头添加节点，如果遇到已经访问过的节点。然后你在给定的图中找到了一个循环。

* * *

## 回答 #14

> 赞同：-12
> 
> 时间：2010-10-28T10:33:15.100

如果一个图满足这个性质

```
|e| > |v| - 1 
```

那么该图至少包含一个循环。

# vba - 在 VBA 中计算 const 时溢出

> ID：261580
> 
> 赞同：10
> 
> 时间：2008-11-04T11:28:55.513
> 
> 标签：vba, constants, overflow

此声明导致 VBA 中的溢出：

```
Const OVERFLOWS As Long = 10 * 60 * 60 
```

而直接设置值很好：

```
Const COMPILES_OK As Long = 36000 
```

您如何说服 VBA 将文字整数视为 long？

谢谢

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-11-04T11:48:54.100

将`long`后缀添加`&`到至少一个数字：

```
Const OVERFLOWS As Long = 10& * 60 * 60 
```

请注意，使用`CLNG`函数将值转换为`long`不起作用，因为 VBA 不允许将函数的返回值分配给常量。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-04T12:02:20.203

[http://support.microsoft.com/kb/191713](http://support.microsoft.com/kb/191713)是对 VBA / VB4-6 中可用的类型声明字符的一个很好的总结。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-04T12:12:59.057

对于那些觉得 & 符号有点深奥的人，另一种方法是使用 CLNG 函数将数字转换为 long

```
Const OVERFLOWS As Long = CLNG(10) * 60 * 60 
```

然后你可以对 Single 常量做类似的事情

```
Const OVERFLOWS As Single = CSNG(10) * 60 * 60 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-04T11:52:32.687

类型字符也可以附加到文字： Const OVERFLOWS As Long = (10& * 60 * 60) （实际上一个就足够了，因为 VBA 引擎评估表达式的方式）。

# c#-2.0 - 如何获取将在嵌套数据列表中选择的单选按钮列表的值，以便稍后使用 c#asp.net 2 在多插入中使用它

> ID：261586
> 
> 赞同：4
> 
> 时间：2008-11-04T11:31:32.887
> 
> 标签：c#-2.0, datalist

如何获取`radiobuttonlist`将在嵌套数据列表中选择的值，以便稍后在多插入中使用它。我想获取控件的所有值，`radiobuttonlist`以便在我的代码中的多插入语句中使用它们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-16T14:15:04.747

$("#<%=rbl.ClientID%> 输入：已检查").val()

# c# - 我应该用 C/C++ 重写我的 DSP 例程还是我擅长 C# 不安全指针？

> ID：261591
> 
> 赞同：4
> 
> 时间：2008-11-04T11:32:26.050
> 
> 标签：c#, c++, performance, memory, unsafe-pointers

我目前正在编写一个 C# 应用程序，该应用程序执行大量数字信号处理，其中涉及许多小型微调内存 xfer 操作。我使用不安全指针编写了这些例程，它们的性能似乎比我最初想象的要好得多。但是，我希望应用程序尽可能快。

我会从用 C 或 C++ 重写这些例程中获得任何性能优势，还是应该坚持使用不安全的指针？我想知道与 C/C++ 相比，不安全指针在性能方面带来了什么。

编辑：我在这些例程中没有做任何特别的事情，只是普通的 DSP 东西：缓存友好的数据从一个数组传输到另一个数组，其中有很多乘法、加法、位移等。我希望 C/C++ 例程看起来与 C# 对应的例程几乎相同（如果不相同）。

编辑：非常感谢大家所有聪明的答案。我了解到，除非进行某种 SSE 优化，否则仅通过直接移植不会显着提高性能。假设所有现代 C/C++ 编译器都可以利用它，我期待着尝试一下。如果有人对结果感兴趣，请告诉我，我会在某处发布。（虽然可能需要一段时间）。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-29T20:55:42.467

实际上，我几乎完全按照您的要求做了，只是在图像处理领域。我从 C# 不安全指针开始，然后转到 C++/CLI，现在我用 C++ 编写所有代码。事实上，从那里我从 C++ 中的指针更改为 SSE 处理器指令，所以我一直走下去。还没有达到汇编程序，虽然我不知道是否需要，但我在 CodeProject 上看到一篇文章显示 SSE 可以与内联汇编程序一样快，如果你想要我可以找到它。

在我进行的过程中发生的事情是，我的算法从使用不安全指针的 C# 中的每秒 1.5-2 帧左右变为现在的每秒 40 帧。C# 和 C++/CLI 肯定比 C++ 慢，即使使用指针，我也无法使用这些语言达到每秒 10 帧以上。切换到 C++ 后，我立即获得了每秒 15-20 帧的速度。一些更聪明的改变和 SSE 让我达到了每秒 40 帧。所以，是的，如果你想要我的经验中的速度，那么值得一试。有明显的性能提升。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-04T13:03:52.310

优化 DSP 代码的另一种方法是使其缓存友好。如果您有很多过滤器要应用于您的信号，您应该将所有过滤器应用于每个点，即您的最内层循环应该在过滤器上而不是在数据上，例如：

```
for each n do t´[n] = h(g(f(t[n]))) 
```

这样，您将减少缓存的垃圾，并且很可能会获得良好的速度提升。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-04T11:56:55.173

我认为你应该用 C++（托管或非托管）或 C# 编写你的 DSP 例程，使用可靠的设计，但不要从一开始就尝试优化所有内容，然后你应该分析你的代码并找到瓶颈并尝试优化那些离开。

试图从一开始就生成“最佳”代码会分散你编写工作代码的注意力。请记住，80% 的优化只会影响 20% 的代码，因为在很多情况下，只有 10% 的代码会占用 90% 的 CPU 时间。（YMMV，因为它取决于应用程序的类型）

当我试图优化我们在图形工具包中对 alpha 混合的使用时，我首先尝试以“裸机”方式使用 SIMD：内联汇编程序。很快我发现使用 SIMD 内在函数比纯汇编更好，因为编译器能够通过重新排列各个操作码并最大限度地利用 CPU 中的不同处理单元来进一步优化具有内在函数的可读 C++。

不要低估编译器的威力！

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-29T19:58:35.217

> 我会从用 C/C++ 重写这些例程中获得任何性能优势，还是应该坚持使用不安全的指针？

从理论上讲，这无关紧要——一个完美的编译器会将代码（无论是 C 还是 C++）优化为最好的汇编程序。

然而，在实践中，C 几乎总是更快，特别是对于指针类型算法 - 它尽可能接近机器代码而无需在汇编中编码。

C++ 在性能方面并没有带来任何好处——它被构建为 C 的面向对象版本，为程序员提供了更多的功能和易用性。虽然对于某些事情它会表现得更好，因为给定的应用程序将从面向对象的角度受益，但它并不是要表现得更好 - 它是为了提供另一个抽象级别，以便编写复杂的应用程序更容易。

所以，不，您可能不会看到通过切换到 C++ 来提高性能。

然而，对你来说，发现它可能比避免花时间更重要——我认为将它移植并分析它是一项值得的活动。很有可能，如果您的处理器具有某些 C++ 或 Java 使用指令，并且编译器知道它们，它可能能够利用 C 中不可用的功能。不太可能，但可能。

然而，众所周知，DSP 处理器是复杂的野兽，越接近汇编，就可以获得更好的性能（即，您的代码越是手动调整）。C 比 C++ 更接近汇编。

-亚当

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-29T20:41:55.020

首先让我回答关于“安全”与“不安全”的问题：您在帖子中说“我希望应用程序尽可能快”，这意味着您不想混淆“安全”或“托管”指针（甚至不提垃圾收集）。

关于您选择的语言：C/C++ 让您可以更轻松地处理底层数据，而不会产生与如今每个人都在使用的精美容器相关的任何开销。是的，被容器拥抱是件*好事*，这些容器可以防止你发生段错误......但是与容器相关的更高级别的抽象会*破坏*你的性能。

在我的工作中，我们的代码必须快速运行。一个例子是我们在工作中的多相重采样器，它使用指针和屏蔽操作以及定点 DSP 过滤......如果没有对内存和位操作的低级控制，这些聪明的技巧都不可能真正实现 ==> 所以我说坚持C/C++。

如果你真的想变得聪明，用低级 C 编写所有的 DSP 代码。然后将它与更安全的容器/托管指针混合在一起......当它达到速度时，你需要取下训练轮......它们会减慢你倒太多了。

（仅供参考，关于取下训练轮：您需要额外离线测试您的 C DSP 代码，以确保它们的指针使用良好...... o/w 它会出现段错误。）

编辑：ps“seg faulting”对所有 PC/x86 开发人员来说都是一种奢侈品。当您编写嵌入式代码时……段错误仅意味着您的处理器将进入 wuides 并且只能通过电源循环来恢复；）。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-29T20:51:14.050

为了了解如何获得性能提升，最好了解可能导致瓶颈的代码部分。

由于您谈论的是*小*内存传输，我假设所有数据都适合 CPU 的缓存。在这种情况下，你能获得的唯一好处就是知道如何使用 CPU 的内在函数。通常，最熟悉 CPU 内在函数的编译器是 C 编译器。所以在这里，我认为你可以通过移植来提高性能。

另一个瓶颈将出现在 CPU 和内存之间的路径上 - 由于应用程序中的大量内存传输导致缓存未命中。最大的收获将在于最大限度地减少缓存未命中，这取决于您使用的平台以及数据的布局（它是本地的还是通过内存分散的？）。

但是由于您已经在使用不安全的指针，因此您可以自己控制该位，所以我的猜测是：在这方面，您不会从移植到 C（或 C++）中受益匪浅。

结论：您可能希望将应用程序的一小部分移植到 C 中。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-02T04:49:41.760

看到您已经在编写不安全的代码，我认为将其转换为 C dll 并从 C# 中调用它们会相对容易。在确定程序中最慢的部分后执行此操作，然后用 C 替换它们。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-02T05:35:53.570

你的问题主要是哲学问题。答案是这样的：在你分析之前不要优化。

你问你是否会有所改善。好的，您将获得 N% 的改进。如果这足够了（就像您需要在某些嵌入式系统上在 20 毫秒内执行 200 次的代码），那您就可以了。但如果还不够怎么办？

您必须先进行测量，然后确定代码的某些部分是否可以用相同的语言重写但速度更快。也许您可以重新设计数据结构以避免不必要的计算。也许你可以跳过一些内存重新分配。当可以用线性复杂度完成时，也许可以用二次复杂度完成某些事情。在你测量它之前你不会看到它。这通常比用另一种语言重写所有内容浪费的时间要少得多。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-02T20:26:36.813

C# 不支持 SSE（但是，有一个用于 SSE 操作的单声道项目）。因此，带有 SSE 的 C/C++ 肯定会更快。

但是，您必须小心托管到本机和本机到托管的转换，因为它们非常昂贵。尽可能长时间地呆在任何一个世界。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-03T00:58:59.320

您真的希望应用程序尽可能快还是足够快？这告诉你下一步应该做什么。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-02-03T01:11:56.923

如果您坚持使用您的手卷，而不在汇编程序或类似程序中进行手动优化，那么 C# 应该没问题。不幸的是，这种问题只能通过实验来真正回答。您已经在非托管指针空间中，所以我的直觉是直接移植到 C++ 不会在速度上看到显着差异。

[不过，我应该说，我最近遇到了类似的问题，在尝试了英特尔集成性能基元](http://www.intel.com/cd/software/products/asmo-na/eng/302910.htm)库后，我们最终放弃了手卷。我们在那里看到的性能改进令人印象深刻。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-02-04T03:28:25.540

Mono 2.2 现在有了[SIMD](http://www.mono-project.com/Release_Notes_Mono_2.2#SIMD_support_in_Mono)支持，您可以拥有两全其美的托管代码和原始速度。

您可能还想看看[在 c# 中使用 SSE 是否可能？](https://stackoverflow.com/questions/415375)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-11-04T11:45:43.870

我建议如果您的 DSP 代码中有任何算法**需要**优化，那么您真的应该用汇编语言编写它们，而不是 C 或 C++。

一般来说，使用现代处理器和硬件，没有多少场景需要或保证优化所涉及的工作。您是否确实发现了任何性能问题？如果没有，那么最好坚持你所拥有的。在大多数简单算术的情况下，不安全的 C# 不太可能比 C/C++ 慢得多。

你考虑过 C++/CLI 吗？那时你可以两全其美。如果需要，它甚至允许您使用内联汇编程序。

# c# - 更细粒度的 SQL 异常？

> ID：261594
> 
> 赞同：3
> 
> 时间：2008-11-04T11:35:04.330
> 
> 标签：c#, sql, sqlexception

在 C# 中，有没有办法通过 SQL 异常获得更精细的粒度？

我知道很多事情可能会出错，但我想以不同的方式处理某些情况，并且解析错误消息似乎不是很优雅。

还有错误消息是由框架创建的还是特定于数据库的？

例如，如果我在 INSERT 上有主键违规，则错误消息将始终为：

违反主键约束“PK_tblProduct”。无法在对象“dbo.tblProduct”中插入重复键。

或者是特定于 SQLServer 的。

**更新**

我看起来像是在寻找错误号，知道在哪里可以获得各种错误号吗？

我能用快速谷歌做的最好的事情是：18456：登录失败 18488：密码过期

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-04T11:43:01.567

如果您正在捕获 a [`SqlException`](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlexception.aspx)，您应该可以访问[`.Number`](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlexception.number.aspx)，它会为您提供 SQL 错误号；这可能是您最好的方法...（您也可以从`InfoMessage`事件中获得相同的结果，也可以用于非致命错误）。

当然，这不会区分表 - 您可能会争辩说，如果您需要这种粒度级别，您应该首先检查（在可序列化的隔离级别，理想情况下使用 UPDLOCK），如果有冲突的数据会引发您自己的错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-04T12:07:58.210

[您可以在此处](http://vista.intersystems.com/csp/docbook/DocBook.UI.Page.cls?KEY=RSQL_sqlerrors)找到错误代码

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-04T12:21:57.853

SQLException 的 .Number 成员似乎是我所追求的，这是迄今为止我设法找到的数字：

*   17：SQL Server 不存在或访问被拒绝。
*   4060：无效的数据库
*   18456：登录失败
*   547：外键违规
*   1205：死锁受害者
*   2627、2601：唯一索引/持续违规

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-04T11:43:37.340

在 SQL Server 中，您可以使用各种错误函数，这些函数返回有关从 sys.messages 遇到的错误的各种信息

[您可以从BOL](http://msdn.microsoft.com/en-us/library/ms179495(SQL.90).aspx)检索更多信息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-04T11:55:05.037

要回答您问题的最后一部分：错误消息的细节将取决于数据库。有一些标准的 SQL 错误代码，但实际文本将从 DBMS 更改为 DBMS。即使是否返回 SQL 标准错误代码也取决于 DBMS。

# javascript - 为什么我可以在 JavaScript 中定义函数之前使用它？

> ID：261599
> 
> 赞同：190
> 
> 时间：2008-11-04T11:35:41.177
> 
> 标签：javascript, function

即使在不同的浏览器中，此代码也始终有效：

```
function fooCheck() {
  alert(internalFoo()); // We are using internalFoo() here...

  return internalFoo(); // And here, even though it has not been defined...

  function internalFoo() { return true; } //...until here!
}

fooCheck(); 
```

不过，我找不到一个关于为什么它应该起作用的单一参考。我首先在 John Resig 的演示文稿中看到了这一点，但只是提到了这一点。那里或任何地方都没有任何解释。

有人可以启发我吗？

* * *

## 回答 #1

> 赞同：238
> 
> 时间：2008-11-04T12:13:30.430

该`function`声明很神奇，并导致其标识符在其代码块*中的任何内容被执行之前被绑定。

这与带有`function`表达式的赋值不同，后者以正常的自上而下的顺序进行评估。

如果您将示例更改为：

```
var internalFoo = function() { return true; }; 
```

它会停止工作。

函数声明在语法上与函数表达式完全不同，尽管它们看起来几乎相同并且在某些情况下可能会模棱两可。

这在[ECMAScript 标准](https://www.ecma-international.org/publications/standards/Ecma-262.htm)第**10.1.3**节中有记录。不幸的是，即使按照标准，ECMA-262 也不是一个可读性很强的文档！

*：包含函数、块、模块或脚本。

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2017-02-16T06:32:57.260

它被称为 HOISTING - 在定义之前调用（调用）一个函数。

我想写的两种不同类型的函数是：

表达式函数和声明函数

1.  表达式函数：

    函数表达式可以存储在变量中，因此它们不需要函数名称。它们也将被命名为匿名函数（没有名称的函数）。

    要调用（调用）这些函数，它们总是需要一个***变量名***。如果在定义之前调用这种函数将不起作用，这意味着此处不会发生提升。我们必须始终先定义表达式函数，然后再调用它。

    ```
    let lastName = function (family) {
     console.log("My last name is " + family);
    };
    let x = lastName("Lopez"); 
    ```

    这就是您可以在 ECMAScript 6 中编写它的方式：

    ```
    lastName = (family) => console.log("My last name is " + family);

    x = lastName("Lopez"); 
    ```

2.  声明函数：

    使用以下语法声明的函数不会立即执行。它们被“保存以供以后使用”并且将在稍后被调用（调用）时执行。如果您在定义了 is 的位置之前或之后调用它，这种类型的函数就会起作用。如果在定义之前调用声明函数，则提升工作正常。

    ```
    function Name(name) {
      console.log("My cat's name is " + name);
    }
    Name("Chloe"); 
    ```

    吊装示例：

    ```
    Name("Chloe");
    function Name(name) {
       console.log("My cat's name is " + name);
    } 
    ```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2008-11-04T11:58:23.563

浏览器从头到尾读取您的 HTML，并在读取并解析为可执行块（变量声明、函数定义等）时执行它。但在任何时候都只能使用在此之前脚本中定义的内容。

这与处理（编译）所有源代码的其他编程上下文不同，可能会将其与解析引用所需的任何库链接在一起，并构造一个可执行模块，然后开始执行。

您的代码可以引用进一步定义的命名对象（变量、其他函数等），但在所有部分都可用之前，您不能执行引用代码。

随着您对 JavaScript 的熟悉，您将清楚地意识到您需要以正确的顺序编写内容。

修订：要确认接受的答案（上图），请使用 Firebug 单步执行网页的脚本部分。你会看到它从一个函数跳到另一个函数，在它实际执行任何代码之前只访问第一行。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-04T11:47:21.840

某些语言要求必须在使用前定义标识符。这样做的一个原因是编译器对源代码使用单次传递。

但是，如果有多次通过（或某些检查被推迟），你可以完全没有这个要求。在这种情况下，可能首先读取（和解释）代码，然后设置链接。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-04T11:41:50.867

我只使用了一点 JavaScript。我不确定这是否会有所帮助，但它看起来与您正在谈论的内容非常相似，并且可能会提供一些见解：

[http://www.dustindiaz.com/javascript-function-declaration-ambiguity/](http://www.dustindiaz.com/javascript-function-declaration-ambiguity/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-04T11:52:31.783

函数“internalFoo”的主体在解析时需要去某个地方，因此当 JS 解释器读取（也称为解析）代码时，会创建函数的数据结构并分配名称。

只是稍后，然后代码运行，JavaScript实际上试图找出“internalFoo”是否存在以及它是什么以及它是否可以被调用等。

* * *

## 回答 #7

> 赞同：-4
> 
> 时间：2008-11-04T17:38:23.690

出于同样的原因，以下内容将始终放在`foo`全局命名空间中：

```
if (test condition) {
    var foo;
} 
```

# vb.net - 隐藏表单的任务栏按钮而不使用 WS_EX_TOOLWIN

> ID：261601
> 
> 赞同：5
> 
> 时间：2008-11-04T11:37:35.510
> 
> 标签：vb.net, delphi, button, taskbar

我需要从任务栏中隐藏一个 Windows 窗体，但我不能使用`WS_EX_TOOLWINDOW`，因为我需要窗体标题栏上的系统菜单和最小/最大按钮。

如果我在运行时将表单切换到工具窗口，则会填充表单皮肤。通过在网上搜索，我看到 VB 有一个 ShowInTaskbar 属性，我想知道这是否可以满足我的要求，以及它是否可以在 Delphi 2006 中实现。此外，这个项目是一个 COM 服务器，没有 MainForm 等。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-04T13:56:58.427

感谢 Stu 让我这么快就得到了答案。在我的情况下，我必须手动将拥有表单的句柄添加到 CreateParams 中，但在其他/正常情况下可能不需要。

```
procedure TfrmWord2Site.CreateParams(var Params:TCreateParams);
begin
  inherited CreateParams(Params);
  Params.WndParent := <your owner form>.Handle;
  Params.ExStyle := Params.ExStyle and not WS_EX_APPWINDOW;
end; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-04T11:55:51.637

[这里](http://www.vbaccelerator.com/home/VB/Code/Libraries/Windows/Forcing_a_Window_to_Show_in_the_TaskBar/article.asp)有一个关于这个确切问题的有趣讨论（从 VB6 的角度来看）。

从您的问题的角度来看，最相关的一点是：

> “创建窗口时，任务栏会检查窗口的扩展样式，以查看是否打开了 WS_EX_APPWINDOW (&H40000) 或 WS_EX_TOOLWINDOW (&H80) 样式。如果打开了 WS_EX_APPWINDOW，则任务栏会显示窗口的按钮，如果WS_EX_ TOOLWINDOW 开启，任务栏不显示窗口的按钮。一个窗口不应该有这两种扩展样式。如果窗口没有这两种样式，任务栏决定创建一个按钮，如果窗口是无主的，如果窗口是拥有的，则不会创建按钮。"
> 
> 顺便说一句，您可以使用带有 GW_OWNER 标志的 GetWindow API 函数来确定窗口是否拥有。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-04T11:50:12.927

感谢[http://www.scalabium.com/faq/dct0096.htm](http://www.scalabium.com/faq/dct0096.htm)。

```
procedure TForm1.FormCreate(Sender: TObject);
begin
  ShowWindow(Application.Handle, SW_HIDE);
  SetWindowLong(Application.Handle, GWL_EXSTYLE,
    GetWindowLong(Application.Handle, GWL_EXSTYLE) or WS_EX_TOOLWINDOW);
  ShowWindow(Application.Handle, SW_SHOW);
end; 
```

我对其进行了测试，它与 Delphi2006 一起工作。并且窗口菜单和最小/最大按钮仍然可见。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-02-15T10:46:13.050

在 Delphi XE (2010) 这完美地工作：你应该编辑主窗体，

```
program prog;  

uses
Forms,
Unit1 in 'Unit1.pas' {Form1};

begin
Application.Initialize;

// this value is set to "true", but you shoud set it "false"
Application.MainFormOnTaskbar := false;

Application.CreateForm(TForm1, Form1);
Application.Run;
end. 
```

（在“建模视图”窗口中搜索此主表单）

在此之后，转到 unit1.pas，您的主要表单单元和 form1 的“OnShow”事件执行：

```
procedure TForm1.FormShow(Sender: TObject);

begin

ShowWindow(Application.Handle, SW_HIDE);

end; 
```

这会有所帮助，我有同样的问题，搜索了整个网络但没有解决

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-14T12:19:41.007

通过 BordersStyle bsDialog/bsToolWindow 解决了我在这方面的问题（但后来我不需要最小/最大...）。但我想知道你为什么要结合这些属性。它不会让“普通”用户感到困惑吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-05-29T08:13:43.320

我正在寻找一段将文本框集成到 Windows 任务栏的代码。

我计划创建一个我无法将其集成到任务栏的工具栏。

谢谢你的帮助pj

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-03-05T18:10:43.620

在 C# 中执行此操作的一种方法是：

```
ShowWindow(_window, SWHide);

int style = GetWindowLong(_window, GWL_EXSTYLE);
style |= WS_EX_TOOLWINDOW;
SetWindowLong(_window, GWL_EXSTYLE, style);

ShowWindow(_window, SWShow); 
```

# java - Java 绑定与手动定义类

> ID：261603
> 
> 赞同：5
> 
> 时间：2008-11-04T11:39:33.667
> 
> 标签：java, xml, binding

我有一个 XML 模式，我需要为其创建 Java 类。这不是一个特别大的模式，我会说它会产生大约 20 个类。我试图权衡是否使用自动绑定程序（如 JAXB 或 JiBX 中提供的程序）或是否手动编写我自己的类并使用 XStream 之类的东西进行编组/解组。

与使用绑定程序相比，编写自己的类有哪些优点/缺点。

另外，我使用一个绑定程序，我是否永远与它绑定。例如，如果我使用 JAXB 的绑定编译器来创建类，我是否必须使用 JAXB 进行所有编组/解组？

ps 我看过以下关于 XML 绑定/序列化的问题，这些问题很有用，但没有完全回答我的问题： [xml-serialization-in-java](https://stackoverflow.com/questions/35785/xml-serialization-in-java)和[java-xml-binding](https://stackoverflow.com/questions/205749/java-xml-binding)

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-11-04T12:15:47.540

我认为您的问题没有明确的答案。但我可以给你一些来之不易的建议。这里有一些要考虑的事情：

1.  编写编组和解组代码非常耗时，尤其是第一次。

2.  您将不得不花费大量时间来学习 DOM 库（Xerces 或其等效项）的细微差别。

3.  有很多重复，所以你最终会被迫编写一些帮助类。

4.  您将需要大量的单元测试来确保您已经覆盖了可选元素和属性领域的所有基础。

查看该列表很容易说“这就是 JAXB 为我所做的”。多年来一直这样做，我想说 JAXB 为您节省了大量时间和精力，尤其是 Java 5/6 中 JAXB 的最新迭代。

但是，如果您使用 JAXB，那么我们已经学到了一个教训，我想传递给我们：

*** 不要让 JAXB 生成的类泄漏到您的应用程序中。

正如您在问题中所说，这将您的整个应用程序与 JAXB 做事的方式联系起来。如果必须更换 JAXB（将来您可能会这样做的原因有很多），那么您将面临一项具有挑战性和痛苦的任务（相信我，我们已经做到了，我们将永远不会参与其中再次定位）。

现在我们总是将 JAXB 生成的类隐藏在外观或工厂后面，从 JAXB 类映射到我们自己的具有所需行为的域 POJO。我们将 JAXB 视为 JDBC；JAXB 只是另一个数据源，另一种从我们的域 POJO 获取数据的方式。域 POJO 是秘诀，我们控制它们的编码方式和使用方式。JAXB 只是一个编组和解组的工具。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-04T12:38:12.207

我不想就这个问题开始一场漫长而无休止的冬青战争，但根据我的经验——如果你可以使用为你生成所有代码的工具并且不需要可靠的 JAR。将生成的代码会很丑陋，但它会一直工作，直到您清楚地看到需要手工编写手写代码。在大多数情况下，您不需要这样做。很抱歉，我无法立即推荐使用什么工具。

# winapi - Windows 上的原生 GTK#？

> ID：261611
> 
> 赞同：1
> 
> 时间：2008-11-04T11:46:41.577
> 
> 标签：winapi, gtk, gtk#

如何在不使用 cygwin 的情况下为 Windows 编译最新版本的 GTK#？

任何和所有的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T23:49:27.373

这可能是从 Novell 找到最新的官方 Gtk# 版本的最佳位置：http: [//ftp.novell.com/pub/mono/gtk-sharp/](http://ftp.novell.com/pub/mono/gtk-sharp/)

Mike Kestner 关于这个版本的博客文章以及为什么它比以前的更好：http: [//mkestner.blogspot.com/2009/04/gtk-for-net.html](http://mkestner.blogspot.com/2009/04/gtk-for-net.html)

我试过了，它在 XP 和 Vista 中运行良好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-04T17:50:25.600

好吧，如果您必须拥有更新的版本，Medsphere 会提供[更新的版本](http://medsphere.org/projects/gtksharp/wiki)和[构建说明](http://medsphere.org/projects/gtksharp/wiki/CompilingGtkSharpOnCygwin)，这里有[大量信息](http://www.mail-archive.com/gtk-sharp-list@lists.ximian.com/msg03432.html)。

听起来有些人已经构建了 2.12

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-04T13:24:01.007

你真的需要编译它吗？[Novell 有一个您可以使用的安装程序。](http://forge.novell.com/modules/xfmod/project/?gtks-inst4win)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-04T11:49:17.280

为什么需要 Cygwin 来编译 C# 代码？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-03-04T15:53:57.227

[https://github.com/gtkSharp/GtkSharp/](https://github.com/gtkSharp/GtkSharp/)这个仓库在windows上工作，你只需要添加GtkSharp.Dependencies nuget包，它兼容.net 5.0、3.1和4.5或更高版本

此外，他们正计划支持 gtk4，如您在此处所见

# windows - ColdFusion 服务器监控 - 不工作

> ID：261614
> 
> 赞同：2
> 
> 时间：2008-11-04T11:48:37.127
> 
> 标签：windows, coldfusion, monitoring

我正在尝试在运行 ColdFusion 8（版本 8,0,0,176276）的 Windows Server 2003（Web 版）机器上启动 ColdFusion Server Monitor。它以独立配置运行。

弹出窗口以[http://www.mydomain.com/CFIDE/administrator/monitor/launch-monitor.cfm](http://www.mydomain.com/CFIDE/administrator/monitor/launch-monitor.cfm)启动。但是，我得到一个 Flash 对话框，然后显示错误信息“ColdFusion 服务器不可用”。该对话框还有一个地方可以填写服务器详细信息（例如端口号和用户名/密码）。所有这些信息似乎都是有序的，并且错误消息再次与它有关，认为 ColdFusion 没有运行。显然CF服务器是可用的，但是服务器监视器可能看不到它。

有趣的是，在我们运行 Windows Web Server 2008 和相同版本 CF 的其他一些机器上，启动 CF 服务器监视器没有问题。

显然我在这里遗漏了一些东西。有没有人遇到过这个问题。非常感谢任何和所有回复！

* * *

谢谢伊恩 - 非常感谢您的回复。

我通常可以去特定机器的子域启动启动 CF admin 并运行监控，例如：

[http://server1.mydomain.com/CFIDE/administrator/](http://server1.mydomain.com/CFIDE/administrator/)

在这里，我输入我常用的 CF 管理员密码。然后，当我单击“启动服务器监视器”按钮时，它应该会弹出一个新窗口。我希望它使用与其他可以工作的服务器相同的凭据，但它似乎不起作用。我是否需要使用终端服务器登录服务器并尝试此操作？这就是你的建议吗？

但让我认为这可能不是凭据的一件事是，我在 Flash 对话中收到“ColdFusion 服务器不可用”消息。这表明可能还有另一个问题。

有谁知道我可以查看服务器监控的日志文件吗？我需要了解为什么我会收到此消息！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-10T09:42:22.293

** 进一步编辑 **

Adobe 在 [http://www.adobe.com/go/kb407866上创建了一个新的技术说明来解决此问题](http://www.adobe.com/go/kb407866)

** 原帖 **

我在 Adob​​e 论坛上发布了同样的问题，而伟大的 Coldfusion 社区坚定的 Charlie Arehart 发布了一个解决方案 :)

本质上，问题在于 IIS 配置，但 Charlie 提到了一些需要注意的陷阱。

这是[Adob​​e 论坛帖子](http://www.adobe.com/cfusion/webforums/forum/messageview.cfm?catid=143&threadid=1404093&forumid=1)。

这是[查理的解决方案](http://carehart.org/blog/client/index.cfm/2008/11/7/cf911_cf8mon_cf_unavailable)。

我希望这对遇到此问题的其他人有所帮助。

** 编辑 **

另一个效果很好的解决方案，特别是如果上述解决方案破坏了您的自定义 404 错误页面，则只需在您的 Web 根目录下创建 flex2gateway（大小写重要）目录。无需重新启动 IIS 或 CF。创建此目录也不会干扰工作服务器，因此可以将其添加到您的存储库中而不会产生不良影响。

谢谢， 夏兰

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-05T05:52:42.243

我遇到了这个问题，您需要从安装 CF 服务器应用程序的配置文件中启动快捷方式。要么，要么您的凭据有错字，请与正在使用的凭据进行比较，或尝试 domain\user 或 .\user

希望有帮助

# html - 通过 CSS 替换不可用的图像？

> ID：261622
> 
> 赞同：21
> 
> 时间：2008-11-04T11:51:24.810
> 
> 标签：html, css, image

是否可以通过 CSS 或使用其他技术替换标准损坏的图像？我所有的图像都是相同的大小，并且我有透明度。

我试图用 div 的背景包装所有图像：

```
<div class="no_broken">
  <img src="http://www.web.com/found.gif"/>
</div>

<div class="no_broken">
  <img src="http://www.web.com/notfound.gif"/>
</div> 
```

CSS：

```
div.no_broken { 
  background-image: url(standard.gif); 
}

div.no_broken, div.no_broken img { 
  width: 32px; 
  height: 32px; 
  display: block; 
} 
```

但是，如果 IMG 是透明的，这将显示两个图像。

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2008-11-04T12:02:15.773

这在没有 CSS 的情况下有效：

```
<img src="some.jpg" onerror="this.src='alternative.jpg';"> 
```

它似乎在禁用 Javascript 时也能正常工作。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2018-10-24T11:56:37.320

是的，您可以使用伪选择器的技巧用 CSS 替换图像。

基本上，`::before`并且`::after`仅在图像无法加载时适用。您可以使用绝对定位将 CSS 伪元素放置在损坏的图像占位符上：

```
img {
    position: relative;
    width: 200px;
    height: 200px;
    display: inline-block;
    vertical-align: text-bottom;
}

    img::before {
        content: 'fall back';
        position: absolute;
        top: 0;
        left: 0;
        bottom: 0;
        right: 0;
        line-height: 200px;
        background-color: #fd0;
        color: currentColor;
        text-align: center;
        border-radius: 2px;
        display: block;
        width: 200px;
        height: 200px;
        overflow: hidden;
    }
```

```
<img src="not-found">
<img src="https://via.placeholder.com/200">
```

此代码段完全不使用 JS，但仅适用于较新的浏览器。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-04-08T19:06:09.923

如果您想在组合中添加一些 javascript，这应该与 jQuery 一起工作以检测图像错误并将某种错误状态 CSS 类添加到损坏的图像。

```
$(document).ready(function () {
    $('.no_broken img').error(function () {
        $(this).addClass('broken');
    });
}); 
```

然后在你的CSS中你可以有类似的东西

```
div.no_broken, div.no_broken img { 
  width: 32px; 
  height: 32px; 
  display: block; 
}

div.no_broken img.broken {
    background-image: url(standard.gif);
    content:"";
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-06-24T13:15:56.637

以为我**会将 kmoser**的评论打包成答案。清除 onerror 处理程序是一个好主意，因为循环是可能的。

Javascript

```
function epic(c) {
    c.onerror='';
    c.src='alternative.jpg';
}; 
```

HTML

```
<img src='some.jpg' onerror='epic(this)'> 
```

[我们现在在twiends 上将](http://twiends.com)这个史诗般的功能放到我们所有的图像标签中，因为我们会拉入大量社交资料图像，这些图像都将在未来的某个时间过期。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-04T11:59:01.817

我不知道您使用的是什么技术，但在 ASP.net 中有一种叫做控制适配器的东西。

我已经使用它来捕获所有图像的 PreRender 并在 imageurl 不完整时替换 imageurl。

我不知道这是否与您的情况有关，并且当有路径但路径上没有图像时肯定不会起作用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-04T11:56:25.753

据我所知，没有 CSS 属性可以控制损坏图像的显示。也许有特定于浏览器的属性？您可能不得不求助于 Javascript 来迭代页面上的图像，并在它们损坏时替换它们的 src。

# java - Ehcache 和 Java

> ID：261625
> 
> 赞同：1
> 
> 时间：2008-11-04T11:52:21.597
> 
> 标签：java, ehcache

我正在使用 ehCache 来存储大量数据。该缓存每秒访问大约 3 次，并且必须保持最新。我有一个运行的线程，它每分钟将缓存所需的所有数据从数据库中检索到不同的缓存中（也有不同的缓存管理器）。我想要做的是将新缓存中的数据内容复制到缓存中，该缓存每秒以快速、可靠和同步的方式被访问。（例如调用replace方法传入现有缓存和新缓存并快速安全地更新新缓存）

在ehCache中有什么办法可以做到这一点吗？

任何帮助是极大的赞赏。

谢谢达米安

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-04T12:42:37.703

听起来您正在寻找一个复杂的解决方案来解决 ehcache 开箱即用的问题。

您只需要一个缓存管理器。将其配置为每分钟刷新一次。如果需要，通过创建一个每分钟刷新一次缓存的线程来执行此操作。

当您尝试从缓存中检索某些内容并且它不存在时，再次加载数据。如果要确保填充缓存块的进度，请将此缓存检索位放在同步方法或块中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-04T13:21:29.747

+1[史蒂夫麦克劳德](https://stackoverflow.com/users/2959/steve-mcleod)。

请参见[SelfPopulatingCache](http://ehcache.sourceforge.net/documentation/cache_decorators.html)

我相信这会做*你*想要的，而且很快。

如果您仍然想维护两个缓存，这*仍然*是要走的路。只需让`CacheFactory`实例从您自己维护的缓存中返回缓存值。

# c# - 如何从 C# 中的 C++ exe 获取文件版本信息？

> ID：261629
> 
> 赞同：3
> 
> 时间：2008-11-04T11:54:25.977
> 
> 标签：c#, c++, assemblies, version, fileinfo

我需要从 C# 程序中最初用 C++ 编写的 exe 文件中获取文件版本信息。

使用 Assembly.LoadFile(fullpath).GetName().Version 会导致 BadImageFormatException。

任何人都可以帮忙吗？

干杯，

担

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-04T12:02:26.210

添加一个`using System.Diagnostics`，然后：

```
 FileVersionInfo info = FileVersionInfo.GetVersionInfo(path); 
```

然后看看 的各种性质`info`：

```
 Console.WriteLine(info.CompanyName);
    Console.WriteLine(info.ProductName);
    Console.WriteLine(info.LegalCopyright);
    Console.WriteLine(info.ProductVersion); 
```

ETC

# python - 如何保护 Python 代码不被用户阅读？

> ID：261638
> 
> 赞同：717
> 
> 时间：2008-11-04T11:57:27.653
> 
> 标签：python, licensing, obfuscation, copy-protection

我正在用 Python 开发一个软件，该软件将分发给我雇主的客户。我的雇主想通过有时间限制的许可证文件来限制软件的使用。

如果我们分发`.py`文件甚至`.pyc`文件，那么（反编译和）删除检查许可证文件的代码将很容易。

另一方面是我的雇主不希望我们的客户阅读代码，担心代码可能被盗或至少是“新颖的想法”。

有没有好的方法来处理这个问题？

* * *

## 回答 #1

> 赞同：487
> 
> 时间：2008-11-04T12:29:24.000

“有什么好办法处理这个问题吗？” 不会。没有任何东西可以防止逆向工程。甚至 DVD 机器上的固件也被逆向工程并暴露了[AACS 加密密钥。](http://en.wikipedia.org/wiki/AACS_encryption_key_controversy)尽管 DMCA 将其定为刑事犯罪。

由于没有任何技术方法可以阻止您的客户阅读您的代码，因此您必须使用普通的商业方法。

1.  许可证。合同。条款和条件。即使人们可以阅读代码，这仍然有效。请注意，您的某些基于 Python 的组件可能要求您在销售使用这些组件的软件之前支付费用。此外，一些开源许可证禁止您隐藏该组件的来源或来源。

2.  提供重要价值。如果你的东西非常好——价格难以拒绝——就没有动力浪费时间和金钱对任何东西进行逆向工程。逆向工程很昂贵。让你的产品稍微便宜一点。

3.  提供升级和增强功能，使任何逆向工程都成为一个坏主意。当下一个版本破坏他们的逆向工程时，就没有意义了。这可能会走极端，但您应该提供新功能，使下一个版本比逆向工程更有价值。

4.  以极具吸引力的价格提供定制服务，以至于他们宁愿付钱给您来构建和支持增强功能。

5.  使用过期的许可证密钥。这很残忍，会给你带来坏名声，但它肯定会让你的软件停止工作。

6.  将其作为 Web 服务提供。SaaS 不涉及向客户下载。

* * *

## 回答 #2

> 赞同：408
> 
> 时间：2008-11-04T12:00:34.417

Python 作为一种字节码编译的解释语言，很难锁定。即使您使用[py2exe](http://py2exe.org)之类的 exe 打包程序，可执行文件的布局也是众所周知的，并且 Python 字节码也很容易理解。

通常在这种情况下，您必须做出权衡。保护代码到底有多重要？那里有真正的秘密（例如银行转账对称加密的密钥），还是你只是偏执？选择可以让您最快开发出最佳产品的语言，并对您的新颖想法的价值保持现实。

如果您决定确实需要安全地执行许可证检查，请将其编写为一个小的 C 扩展，以便许可证检查代码可以非常困难（但并非不可能！）进行逆向工程，并将大部分代码留在 Python 中.

* * *

## 回答 #3

> 赞同：318
> 
> 时间：2008-11-04T13:03:06.257

# Python 不是你需要的工具

你必须使用正确的工具来做正确的事，而 Python 的设计初衷不是为了混淆。恰恰相反；在 Python 中，一切都是开放的或易于显示或修改的，因为这是该语言的哲学。

如果您想要一些无法看穿的东西，请寻找其他工具。这不是一件坏事，重要的是存在用于不同用途的几种不同工具。

# 混淆真的很难

即使是编译好的程序也可以进行逆向工程，所以不要认为你可以完全保护任何代码。您可以分析混淆的PHP，破解flash加密密钥等。新版本的Windows每次都被破解。

# 有法律要求是一个好方法

您无法阻止某人滥用您的代码，但您可以轻松发现是否有人这样做。因此，这只是一个偶然的法律问题。

# 代码保护被高估了

如今，商业模式倾向于销售服务而不是产品。您不能复制服务、盗版或窃取服务。也许是时候考虑顺其自然了……

* * *

## 回答 #4

> 赞同：164
> 
> 时间：2011-09-08T11:14:04.450

## 编译python并分发二进制文件！

**明智的想法：**

使用[Cython](http://cython.org/)、[Nuitka](http://nuitka.net/)、[Shed Skin](https://github.com/shedskin)或类似的东西将 python 编译为 C 代码，然后将您的应用程序作为 python 二进制库 (pyd) 分发。

这样一来，就不会留下任何 Python（字节）代码，而且我认为您已经完成了任何人（即您的雇主）可以从常规代码中获得的任何合理数量的模糊处理。（.NET 或 Java 没有这种情况安全，因为该字节码没有被混淆，并且可以相对容易地被反编译成合理的源代码。）

Cython 越来越兼容 CPython，所以我认为它应该可以工作。（我实际上是在为我们的产品考虑这个。我们已经在构建一些第三方库作为 pyd/dlls，所以将我们自己的 python 代码作为二进制文件发布对我们来说并不是一个太大的步骤。）

有关如何做到这一点的教程，请参阅[这篇博文（不是我写的）。](https://web.archive.org/web/20170602015512/http://blog.biicode.com/bii-internals-compiling-your-python-application-with-cython/)（谢谢@hithwen）

**疯狂的想法：**

您可能会让 Cython 为每个模块单独存储 C 文件，然后将它们全部连接起来并使用大量内联构建它们。这样一来，您的 Python 模块就非常单一，难以使用常用工具进行处理。

**超越疯狂：**

如果您可以静态链接到（并优化）python 运行时和所有库（dll），您可能能够构建单个可执行文件。这样，肯定很难拦截到/来自 python 和您使用的任何框架库的调用。但是，如果您使用的是 LGPL 代码，则无法做到这一点。

* * *

## 回答 #5

> 赞同：61
> 
> 时间：2008-11-06T07:41:59.463

我了解您希望您的客户使用 python 的强大功能，但不想公开源代码。

以下是我的建议：

(a) 将代码的关键部分编写为 C 或 C++ 库，然后使用[SIP](http://www.riverbankcomputing.co.uk/software/sip/intro)或[swig](http://www.swig.org/)将 C/C++ API 公开给 Python 命名空间。

(b) 使用[cython](http://cython.org/)代替 Python

(c) 在 (a) 和 (b) 中，应该可以将库作为具有 Python 接口的许可二进制文件分发。

* * *

## 回答 #6

> 赞同：44
> 
> 时间：2015-05-08T10:21:58.150

你看过[pyminifier](https://liftoff.github.io/pyminifier/)吗？它会缩小、混淆和压缩 Python 代码。对于随意的逆向工程来说，示例代码看起来很讨厌。

```
$ pyminifier --nonlatin --replacement-length=50 /tmp/tumult.py
#!/usr/bin/env python3
ﺭ异ﭞﰣﺁں뻛嬭ﱌꝪﴹ뙫퉊ﳦﲣפּܟﺶﶨࠔﶻ䉊ﰸﭳᣲמּ=ImportError
ﺭ异ﭞﰣﺁں뻛嬭ﱌꝪﴹ뙫퉊ﳦﲣפּܟﺶﶨࠔﶻ䉊ﰸﭳᣲ燱=print
ﺭ异ﭞﰣﺁں뻛嬭ﱌꝪﴹ뙫퉊ﳦﲣפּܟﺶﶨࠔﶻ䉊ﰸﭳᣲ=False
ﺭ异ﭞﰣﺁں뻛嬭ﱌꝪﴹ뙫퉊ﳦﲣפּܟﺶﶨࠔﶻ䉊ﰸﭳᣲ澨=object
try:
 import demiurgic
except ﺭ异ﭞﰣﺁں뻛嬭ﱌꝪﴹ뙫퉊ﳦﲣפּܟﺶﶨࠔﶻ䉊ﰸﭳᣲמּ:
 ﺭ异ﭞﰣﺁں뻛嬭ﱌꝪﴹ뙫퉊ﳦﲣפּܟﺶﶨࠔﶻ䉊ﰸﭳᣲ燱("Warning: You're not demiurgic. Actually, I think that's normal.")
try:
 import mystificate
except ﺭ异ﭞﰣﺁں뻛嬭ﱌꝪﴹ뙫퉊ﳦﲣפּܟﺶﶨࠔﶻ䉊ﰸﭳᣲמּ:
 ﺭ异ﭞﰣﺁں뻛嬭ﱌꝪﴹ뙫퉊ﳦﲣפּܟﺶﶨࠔﶻ䉊ﰸﭳᣲ燱("Warning: Dark voodoo may be unreliable.")
ﺭ异ﭞﰣﺁں뻛嬭ﱌꝪﴹ뙫퉊ﳦﲣפּܟﺶﶨࠔﶻ䉊ﰸﭳᣲﺬ=ﺭ异ﭞﰣﺁں뻛嬭ﱌꝪﴹ뙫퉊ﳦﲣפּܟﺶﶨࠔﶻ䉊ﰸﭳᣲ
class ﺭ异ﭞﰣﺁں뻛嬭ﱌꝪﴹ뙫퉊ﳦﲣפּܟﺶﶨࠔﶻ䉊ﰸﭳᣲ(ﺭ异ﭞﰣﺁں뻛嬭ﱌꝪﴹ뙫퉊ﳦﲣפּܟﺶﶨࠔﶻ䉊ﰸﭳᣲ澨):
 def __init__(self,*args,**kwargs):
  pass
 def ﺭ异ﭞﰣﺁں뻛嬭ﱌꝪﴹ뙫퉊ﳦﲣפּܟﺶﶨࠔﶻ䉊ﰸﭳᣲ클(self,dactyl):
  ﺭ异ﭞﰣﺁں뻛嬭ﱌꝪﴹ뙫퉊ﳦﲣפּܟﺶﶨࠔﶻ䉊ﰸﭳᣲ퐐=demiurgic.palpitation(dactyl)
  ﺭ异ﭞﰣﺁں뻛嬭ﱌꝪﴹ뙫퉊ﳦﲣפּܟﺶﶨࠔﶻ䉊ﰸﭳᣲ=mystificate.dark_voodoo(ﺭ异ﭞﰣﺁں뻛嬭ﱌꝪﴹ뙫퉊ﳦﲣפּܟﺶﶨࠔﶻ䉊ﰸﭳᣲ퐐)
  return ﺭ异ﭞﰣﺁں뻛嬭ﱌꝪﴹ뙫퉊ﳦﲣפּܟﺶﶨࠔﶻ䉊ﰸﭳᣲ
 def ﺭ异ﭞﰣﺁں뻛嬭ﱌꝪﴹ뙫퉊ﳦﲣפּܟﺶﶨࠔﶻ䉊ﰸﭳᣲ(self,whatever):
  ﺭ异ﭞﰣﺁں뻛嬭ﱌꝪﴹ뙫퉊ﳦﲣפּܟﺶﶨࠔﶻ䉊ﰸﭳᣲ燱(whatever)
if __name__=="__main__":
 ﺭ异ﭞﰣﺁں뻛嬭ﱌꝪﴹ뙫퉊ﳦﲣפּܟﺶﶨࠔﶻ䉊ﰸﭳᣲ燱("Forming...")
 ﺭ异ﭞﰣﺁں뻛嬭ﱌꝪﴹ뙫퉊ﳦﲣפּܟﺶﶨࠔﶻ䉊ﰸﭳᣲﺃ=ﺭ异ﭞﰣﺁں뻛嬭ﱌꝪﴹ뙫퉊ﳦﲣפּܟﺶﶨࠔﶻ䉊ﰸﭳᣲ("epicaricacy","perseverate")
 ﺭ异ﭞﰣﺁں뻛嬭ﱌꝪﴹ뙫퉊ﳦﲣפּܟﺶﶨࠔﶻ䉊ﰸﭳᣲﺃ.ﺭ异ﭞﰣﺁں뻛嬭ﱌꝪﴹ뙫퉊ﳦﲣפּܟﺶﶨࠔﶻ䉊ﰸﭳᣲ("Codswallop")
# Created by pyminifier (https://github.com/liftoff/pyminifier) 
```

* * *

## 回答 #7

> 赞同：34
> 
> 时间：2008-11-04T12:27:52.927

您的雇主是否知道他可以“窃取”其他人从您的代码中获得的任何想法？我的意思是，如果他们可以阅读您的作品，那么您也可以阅读他们的作品。也许看看你如何从这种情况中受益会比担心你会损失多少来获得更好的投资回报。

[编辑] 回答尼克的评论：

一无所获，一无所失。客户拥有他想要的东西（并且因为他自己做了改变而为此付出了代价）。由于他没有发布更改，就好像其他所有人都没有发生一样。

现在如果客户出售软件，他们必须更改版权声明（这是非法的，所以你可以起诉并且会赢 -> 简单案例）。

如果他们不更改版权声明，第 2 级客户会注意到该软件来自您的原创，并想知道发生了什么。他们很有可能会与您联系，因此您将了解您作品的转售情况。

同样，我们有两种情况：原始客户只卖了几份。这意味着他们无论如何都没有赚到多少钱，所以为什么要麻烦。或者他们大量出售。这意味着您有更好的机会了解他们的所作所为并采取相应措施。

但最终，大多数公司都试图遵守法律（一旦声誉受损，做生意就更难了）。所以他们不会窃取你的工作，而是与你一起改进它。因此，如果您包含源代码（带有保护您免于简单转售的许可证），他们很可能会简单地退回他们所做的更改，因为这将确保更改在下一个版本中并且他们不必维护它. 这是双赢的：你得到了改变，如果他们真的非常需要，他们可以自己做出改变，即使你不愿意将它包含在官方版本中。

* * *

## 回答 #8

> 赞同：28
> 
> 时间：2017-09-01T06:01:13.300

使用[赛通](http://cython.org/)。它将您的模块编译为高性能的 C 文件，然后可以将其编译为本机二进制库。与 .pyc 字节码相比，这基本上是不可逆的！

我写了一篇关于如何为 Python 项目设置 Cython 的详细文章，请查看：

**[使用 Cython 保护 Python 源](https://medium.com/@xpl/protecting-python-sources-using-cython-dcd940bb188e)**

* * *

## 回答 #9

> 赞同：24
> 
> 时间：2008-11-04T18:53:11.980

不要依赖混淆。正如您正确得出的结论，它提供的保护非常有限。更新：这是一个[论文链接，](https://www.usenix.org/system/files/conference/woot13/woot13-kholia.pdf)该链接在 Dropbox 中对经过混淆的 python 代码进行了逆向工程。方法 - 操作码重新映射是一个很好的障碍，但显然它可以被击败。

相反，正如许多海报提到的那样：

*   不值得花时间进行逆向工程（你的软件太好了，付费是有意义的）
*   让他们签署合同并在可行的情况下进行许可证审核。

或者，正如出色的 Python IDE WingIDE 所做**的那样：放弃代码**。没错，放弃代码，让人们回来进行升级和支持。

* * *

## 回答 #10

> 赞同：20
> 
> 时间：2009-02-16T21:09:33.657

运送 .pyc 文件有其问题——它们与创建它们的 python 版本以外的任何其他 python 版本不兼容，这意味着您必须知道在产品将运行的系统上运行的是哪个 python 版本。这是一个非常有限的因素。

* * *

## 回答 #11

> 赞同：18
> 
> 时间：2008-11-04T12:29:48.430

在某些情况下，可以将软件的（全部，或至少一个关键部分）移动到您的组织托管的 Web 服务中。

这样，可以在您自己的服务器机房安全地执行许可证检查。

* * *

## 回答 #12

> 赞同：16
> 
> 时间：2008-11-05T06:10:26.823

虽然没有完美的解决方案，但可以做到以下几点：

1.  将一些关键的启动代码移动到本机库中。
2.  在本机库中强制执行许可证检查。

如果要删除对本机代码的调用，则程序无论如何都不会启动。如果它没有被删除，那么许可证将被强制执行。

尽管这不是跨平台或纯 Python 解决方案，但它会起作用。

* * *

## 回答 #13

> 赞同：13
> 
> 时间：2012-07-03T17:07:27.193

我认为还有另一种方法可以保护您的 Python 代码；混淆方法的一部分。我相信有一个像 Mount and Blade 这样的游戏或者改变并重新编译了他们自己的 python 解释器（我认为是开源的原始解释器）并且只是将 OP 代码表中的 OP 代码更改为与标准 python OP 不同代码。

因此，python 源代码未修改，但 *.pyc 文件的文件扩展名不同，并且操作码与公共 python.exe 解释器不匹配。如果您检查了游戏数据文件，所有数据都是 Python 源格式。

可以用各种恶作剧来惹恼不成熟的黑客。阻止一群没有经验的黑客很容易。这是您不太可能击败的专业黑客。但我想，大多数公司不会让专业黑客长期留在员工中（可能是因为事情被黑客入侵了）。但是不成熟的黑客无处不在（读作好奇的 IT 人员）。

例如，您可以在修改后的解释器中允许它检查源代码中的某些注释或文档字符串。对于这样的代码行，您可以有特殊的 OP 代码。例如：

OP 234 用于源代码行“# Copyright I write this”，或者将该行编译为相当于“if False:”的操作码，如果缺少“# Copyright”。基本上由于某些晦涩的原因禁用了整个代码块。

重新编译修改后的解释器可能可行的一个用例是，您没有编写应用程序，应用程序很大，但您需要付费保护它，例如当您是金融应用程序的专用服务器管理员时。

我发现让源代码或操作码对眼球开放，但对网络流量使用 SSL 有点矛盾。SSL 也不是 100% 安全的。但它被用来阻止大多数人的眼睛阅读它。一点预防措施是明智的。

此外，如果有足够多的人认为 Python 源代码和操作码太显眼，那么很可能有人最终会为其开发至少一个简单的保护工具。因此，更多人问“如何保护 Python 应用程序”只会促进这种发展。

* * *

## 回答 #14

> 赞同：13
> 
> 时间：2018-03-17T00:43:32.910

我很惊讶在任何答案中都没有看到[pyconcrete 。](https://github.com/Falldog/pyconcrete)也许是因为它比问题更新？

这可能正是您所需要的（编辑）。

它不是混淆代码，而是在加载时对其进行加密和解密。

从[pypi 页面](https://pypi.python.org/pypi/pyconcrete/0.11.3)：

> 保护python脚本工作流程
> 
> *   你的脚本.py`import pyconcrete`
> *   pyconcrete 将挂钩导入模块
> *   当您的脚本执行 import 时`MODULE`，pyconcrete import hook 将首先尝试查找`MODULE.pye`，然后`MODULE.pye`通过解密`_pyconcrete.pyd`并执行解密数据（作为 .pyc 内容）
> *   在（如 DLL 或 SO）中加密和解密密钥记录，`_pyconcrete.pyd` 密钥将隐藏在二进制代码中，无法直接在 HEX 视图中看到

* * *

## 回答 #15

> 赞同：12
> 
> 时间：2008-11-04T20:27:05.130

保护代码的唯一可靠方法是在您控制的服务器上运行它，并为您的客户端提供与该服务器接口的客户端。

* * *

## 回答 #16

> 赞同：10
> 
> 时间：2008-11-04T12:53:25.280

根据客户是谁，一个简单的保护机制，结合一个合理的许可协议将比任何复杂的许可/加密/混淆系统更有效*。*

最好的解决方案是将代码作为服务出售，例如通过托管服务或提供支持——尽管这并不总是可行的。

将代码作为`.pyc`文件发送可以防止你的保护被几个`#`s 挫败，但它几乎不是有效的反盗版保护（好像有这样的技术），归根结底，它不应该实现任何体面的许可协议与公司将。

专注于使您的代码尽可能好用-拥有满意的客户将使您的公司比防止一些理论上的盗版赚更多的钱..

* * *

## 回答 #17

> 赞同：8
> 
> 时间：2009-05-05T21:53:15.273

使您的代码更难窃取的另一种尝试是使用 jython 然后使用[java obfuscator](http://proguard.sourceforge.net/)。

这应该可以很好地工作，因为 jythonc 将 python 代码转换为 java，然后将 java 编译为字节码。所以你混淆了类，反编译后真的很难理解发生了什么，更不用说恢复实际代码了。

jython 的唯一问题是您不能使用用 c 编写的 python 模块。

* * *

## 回答 #18

> 赞同：6
> 
> 时间：2008-11-04T12:20:21.837

你应该看看 getdropbox.com 上的人是如何为他们的客户端软件做的，包括 Linux。破解非常棘手，需要一些非常有创意的拆卸才能通过保护机制。

* * *

## 回答 #19

> 赞同：6
> 
> 时间：2008-11-04T12:59:04.707

通过散列和签署重要文件并使用公钥方法检查它，使用标准加密方案签署您的代码怎么样？

通过这种方式，您可以为每个客户颁发带有公钥的许可证文件。

另外，您可以使用像[这样](http://www.lysator.liu.se/~astrand/projects/pyobfuscate/)的 python 混淆器（只是用谷歌搜索）。

* * *

## 回答 #20

> 赞同：6
> 
> 时间：2008-11-04T18:45:18.487

你可以用 Python 做的最好的事情就是模糊事物。

*   删除所有文档字符串
*   仅分发 .pyc 编译文件。
*   冻结它
*   隐藏类/模块中的常量，以便 help(config) 不会显示所有内容

您可以通过加密其中的一部分并即时解密并将其传递给 eval() 来添加一些额外的模糊性。但无论你做什么，有人可以打破它。

这些都不会阻止一个坚定的攻击者反汇编字节码或在帮助、目录等的帮助下挖掘你的 api。

* * *

## 回答 #21

> 赞同：5
> 
> 时间：2010-06-07T05:07:06.243

拥有时间限制许可证并在本地安装的程序中检查它的想法是行不通的。即使有完美的混淆，也可以删除许可证检查。但是，如果您检查远程系统上的许可证并在封闭的远程系统上运行程序的重要部分，您将能够保护您的 IP。

防止竞争对手将源代码用作自己的源代码或编写相同代码的灵感版本，一种保护方法是在您的程序逻辑中添加签名（一些秘密能够证明代码是从您那里窃取的）并混淆python源代码，所以很难阅读和使用。

良好的混淆为您的代码添加了与将其编译为可执行文件（并剥离二进制文件）基本相同的保护。弄清楚混淆的复杂代码是如何工作的可能比实际编写自己的实现更难。

这无助于防止您的程序遭到黑客攻击。即使使用混淆代码许可证的东西也会被破解，并且程序可能会被修改为具有稍微不同的行为（就像将代码编译为二进制文件无助于保护本机程序一样）。

除了符号混淆之外，解构代码可能是个好主意，如果调用图指向许多不同的地方，即使实际上这些不同的地方最终做同样的事情，这会使一切变得更加混乱。

混淆代码中的逻辑签名（例如，您可以创建程序逻辑使用的值表，但也用作签名），可用于确定代码来自您。如果有人决定将您的混淆代码模块用作他们自己产品的一部分（即使在对其进行重新混淆以使其看起来不同之后），您可以证明，该代码与您的秘密签名一起被盗。

* * *

## 回答 #22

> 赞同：4
> 
> 时间：2008-11-04T12:28:38.370

我已经为我自己的项目研究过一般的软件保护，一般的理念是完全保护是不可能的。您唯一希望实现的是将保护添加到一个级别，使您的客户绕过比购买另一个许可证要花费更多的成本。

话虽如此，我只是在检查谷歌的 python 混淆，并没有发现很多东西。在 .Net 解决方案中，混淆将是在 Windows 平台上解决您的问题的第一种方法，但我不确定是否有人在 Linux 上提供与 Mono 一起使用的解决方案。

接下来就是用编译语言编写代码，或者如果你真的想一路走下去，那就用汇编语言。剥离出来的可执行文件比解释语言更难反编译。

这一切都归结为权衡。一方面，您可以轻松地使用 python 进行软件开发，其中也很难隐藏秘密。另一方面，您有用汇编程序编写的软件，这更难编写，但更容易隐藏秘密。

你的老板必须在支持他要求的连续体中选择一个点。然后他必须给你工具和时间，这样你就可以建造他想要的东西。但是我敢打赌，他会反对实际开发成本与潜在的金钱损失。

* * *

## 回答 #23

> 赞同：4
> 
> 时间：2018-07-30T03:03:16.137

长话短说：

1.  加密您的源代码
2.  编写你自己的 python 模块加载器来在导入时解密你的代码
3.  用 C/C++ 实现模块加载器
4.  您可以为模块加载器添加更多功能，例如反调试器、许可证控制、硬件指纹绑定等。

有关更多详细信息，请查看此[答案](https://stackoverflow.com/a/51586299/989634)。

如果您对该主题感兴趣，这个项目将帮助您 - [pyprotect](https://github.com/ga0/pyprotect)。

* * *

## 回答 #24

> 赞同：3
> 
> 时间：2013-05-22T14:53:50.723

可以将 py2exe 字节码放在 C 启动器的加密资源中，以便在内存中加载和执行它。[这里](http://evilzone.org/hacking-and-security/encrypting-programs-how-does-that-work/10/?wap2)和[这里](http://bubblews.com/news/430170-crypter-small-guide)的一些想法。

有些人还想到了[一种自我修改程序](http://cosic.esat.kuleuven.be/publications/article-1529.pdf)，以使逆向工程变得昂贵。

您还可以找到[防止调试器](http://resources.infosecinstitute.com/anti-debugging/)、使反汇编器失败、设置[错误的调试器断点](http://bases-hacking.org/protection-executables.html)以及使用校验和保护代码的教程。搜索 ["crypted code" execute "in memory"] 获取更多链接。

但正如其他人已经说过的，如果你的代码值得，逆向工程师最终会成功。

* * *

## 回答 #25

> 赞同：2
> 
> 时间：2017-12-14T00:35:38.130

使用与c/c++的二进制文件相同的方法来保护二进制文件，即对可执行文件或库二进制文件中的每个函数体进行混淆，在每个函数入口的开头插入一条指令“跳转”，跳转到特殊函数以恢复混淆后的代码。字节码是 Python 脚本的二进制代码，所以

*   首先将python脚本编译为代码对象
*   然后迭代每个代码对象，将每个代码对象的 co_code 混淆如下

```
    0 JUMP_ABSOLUTE n = 3 + len（字节码）

    3
    ...
    ...这里是混淆的字节码
    ...

    n 加载全球？(__pyarmor__)
    n+3 调用函数 0
    n+6 POP_TOP
    n+7 跳转绝对值 0

```

*   将混淆的代码对象保存为 .pyc 或 .pyo 文件

当那些代码对象第一次被调用时，那些被混淆的文件（.pyc 或 .pyo）可以被普通的 python 解释器使用

*   第一个op是JUMP_ABSOLUTE，它会跳转到offset n

*   在偏移 n 处，指令是调用 PyCFunction。该函数将恢复偏移量 3 和 n 之间的混淆字节码，并将原始字节码放在偏移量 0 处。混淆码可以通过以下代码获得

    ```
        char *obfucated_bytecode;
        py_ssize_t len;
        PyFrameObject* 帧 = PyEval_GetFrame();
        PyCodeObject *f_code = frame->f_code;
        PyObject *co_code = f_code->co_code;      
        PyBytes_AsStringAndSize(co_code, &obfucated_bytecode, &len)

    ```

*   此函数返回后，最后一条指令是跳转到偏移量 0。现在执行真正的字节码。

有一个工具[Pyarmor](https://github.com/dashingsoft/pyarmor)可以通过这种方式混淆 python 脚本。

* * *

## 回答 #26

> 赞同：2
> 
> 时间：2019-01-29T12:47:36.563

如果我们专注于软件许可，我建议看一下我在[这里](https://stackoverflow.com/a/52019368/1275924)写的另一个 Stack Overflow 答案，以获得有关如何构建许可证密钥验证系统的一些灵感。

[GitHub 上](https://github.com/Cryptolens/cryptolens-python)有一个开源库，可以帮助您进行许可证验证。

您可以安装它`pip install licensing`，然后添加以下代码：

```
pubKey = "<RSAKeyValue><Modulus>sGbvxwdlDbqFXOMlVUnAF5ew0t0WpPW7rFpI5jHQOFkht/326dvh7t74RYeMpjy357NljouhpTLA3a6idnn4j6c3jmPWBkjZndGsPL4Bqm+fwE48nKpGPjkj4q/yzT4tHXBTyvaBjA8bVoCTnu+LiC4XEaLZRThGzIn5KQXKCigg6tQRy0GXE13XYFVz/x1mjFbT9/7dS8p85n8BuwlY5JvuBIQkKhuCNFfrUxBWyu87CFnXWjIupCD2VO/GbxaCvzrRjLZjAngLCMtZbYBALksqGPgTUN7ZM24XbPWyLtKPaXF2i4XRR9u6eTj5BfnLbKAU5PIVfjIS+vNYYogteQ==</Modulus><Exponent>AQAB</Exponent></RSAKeyValue>"

res = Key.activate(token="WyIyNTU1IiwiRjdZZTB4RmtuTVcrQlNqcSszbmFMMHB3aWFJTlBsWW1Mbm9raVFyRyJd",\
                   rsa_pub_key=pubKey,\
                   product_id=3349, key="ICVLD-VVSZR-ZTICT-YKGXL", machine_code=Helpers.GetMachineCode())

if res[0] == None not Helpers.IsOnRightMachine(res[0]):
    print("An error occured: {0}".format(res[1]))
else:
    print("Success") 
```

[您可以在此处](https://github.com/Cryptolens/cryptolens-python)阅读有关 RSA 公钥等配置方式的更多信息。

* * *

## 回答 #27

> 赞同：2
> 
> 时间：2019-12-17T06:40:30.903

关于隐藏python源代码有一个全面的答案，可以在[这里](https://wiki.python.org/moin/Asking%20for%20Help/How%20do%20you%20protect%20Python%20source%20code%3F)找到。

讨论的可能技术有：*-* *使用**[编译后](https://wiki.python.org/moin/PyInstaller)* *的*
*字节码 （`python -m compileall`* 

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2012-03-03T15:13:13.993

使用 cxfreeze ( py2exe for linux ) 将完成这项工作。

[http://cx-freeze.sourceforge.net/](http://cx-freeze.sourceforge.net/)

它在 ubuntu 存储库中可用

# c++ - 在代码中管理大量文本（并且还支持翻译）的最佳方法是什么？

> ID：261648
> 
> 赞同：3
> 
> 时间：2008-11-04T12:01:52.950
> 
> 标签：c++, documentation, internationalization

我正在开发一个应用程序，它有很多文本和不同的模块，可以包含或不包含在每个构建中。

对于每个保存的项目，我们会自动生成一份包含所有详细信息的报告（即，该项目中使用的算法的描述等）。目前我们将所有文本作为字符串嵌入到源代码中，我们还通过 po 和 mo 文件支持不同的语言。

该系统的优点是动态生成文档和报告文件非常容易。不好的一点是源代码中有很多文本很难看，格式（即使用html）不舒服，文本编辑很困难，拼写检查不方便，翻译也很糟糕。

所以，最后一个问题是：你是宁愿在代码中嵌入文档还是为不同的语言编写外部文档文件（例如 html）并在运行时解析它们？显然是软件的核心文本，我们这样的消息框无论如何都会留在代码中。

如果重要的话，我正在使用 wxWidgets 使用 C++。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-04T12:11:08.093

我认为所有可能在不同版本的代码之间发生变化的文本都应该保存在单独的属性文件中。您可以构建一种机制，将消息 id 映射到属性文件中的正确字符串，例如将英语和西班牙语属性文件中的映射 id 15 分别映射到“search”或“busca”。因此，属性文件可能是带有 id-message 对的 XML 或 CSV。运行程序时，您将属性文件作为参数提供给它。启动时，它首先将属性字符串加载到地图中，然后您将使用 property[15] 而不是字符串“search”。当然，您可以使用文本标签而不是数字 id。我还会考虑自动从属性文件生成文档，也许使用 CSS。这使得编辑和翻译消息变得更加容易。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-04T12:19:46.063

如果我有很多文本要显示，我通常将其存储在应用程序外部的 XML 中，并根据需要进行读取。我认为这也适用于文档。您可以简单地拥有一个单独的样式表来从中生成文档。本地化您的应用程序将成为单独维护备用翻译的问题——可以在内部作为 XML 文件中的单独节点完成，也可以通过为每种语言维护不同的 XML 文件在组织上完成。

虽然这种方法会导致您的程序需要更多时间来启动，但我认为客户最终会获胜，因为：

1.  您的程序文本更清晰（更易于维护）
2.  您不必被迫修改代码来更改文本
3.  您可以轻松支持更多翻译，让更多人使用您的产品。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-04T12:27:54.580

其他答案触及了重点，所以我将指出这一点：

如果您正在做简单的一对一配对，例如：

```
#textId  "the actual text" 
```

然后 XML 是多余的。解析速度会更慢，并且在磁盘上会更大。像 CSV 甚至非常简单的自定义格式之类的东西可能是最好的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-04T13:20:06.303

根据使用不同语言的个人经验，我发现每个国家/地区的特殊文本文件是最佳解决方案。您必须注意不同语言中相同概念的长度差异。您还可以在安装软件之前打印文本文件并将其提供给翻译器。每个文本或文本的一部分都有一个数字作为键，可以根据需要使用，一起移动等。您还可以提供特殊字段来将可变数据插入到文本中，如果您只使用一个子程序来显示或打印文本，其中这是必需的。我自己以这种方式在世界各地以 7 种不同的语言安装了相同的软件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-04T22:25:00.837

我只是使用一个简单的制表符分隔的文本文件。它可以很容易地加载到 Excel 中并进行编辑。它也可以是任何格式，如 iso-8859-1、utf-8 或 utf-16 等。第一列用于 ID，然后每个后续列用于一种语言。

然后，我通过预处理器运行文本文件，该预处理器在 text.h 文件中生成枚举列表，您可以为文本生成二进制文件，或生成 cpp 文件并将其直接包含到二进制文件中。您还可以在此时更改编码以匹配您在程序中需要的内容。

好处是：

如果缺少字符串，则会出现编译错误。

添加新字符串时，您不必担心忘记为所有语言添加它。

缺点是：

编辑文本文件后必须重新编译。

由于大多数差异工具只能逐行工作，因此合并许多用户所做的更改更加困难。

# python - 将元组列表转换为字典

> ID：261655
> 
> 赞同：40
> 
> 时间：2008-11-04T12:03:34.520
> 
> 标签：python, list, dictionary, tuples, iteration

我有一个这样的元组列表：

```
[
('a', 1),
('a', 2),
('a', 3),
('b', 1),
('b', 2),
('c', 1),
] 
```

我想通过第一项来遍历这个键控，所以，例如，我可以打印这样的东西：

```
a 1 2 3
b 1 2
c 1 
```

如果不保留一个项目来跟踪第一个项目是否与我在元组周围循环的相同，我将如何去做呢？这感觉相当混乱（另外我必须从列表开始排序）......

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2008-11-04T12:07:21.253

```
l = [
('a', 1),
('a', 2),
('a', 3),
('b', 1),
('b', 2),
('c', 1),
]

d = {}
for x, y in l:
    d.setdefault(x, []).append(y)
print d 
```

产生：

```
{'a': [1, 2, 3], 'c': [1], 'b': [1, 2]} 
```

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2008-11-04T12:11:52.087

稍微简单一点...

```
from collections import defaultdict

fq = defaultdict(list)
for n, v in myList:
    fq[n].append(v)

print(fq) # defaultdict(<type 'list'>, {'a': [1, 2, 3], 'c': [1], 'b': [1, 2]}) 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-11-04T12:42:32.493

使用 groupby 的解决方案

```
 >>> from itertools import groupby
    >>> l = [('a',1), ('a', 2),('a', 3),('b', 1),('b', 2),('c', 1),]
    >>> [(label, [v for l,v in value]) for (label, value) in groupby(l, lambda x:x[0])]
    [('a', [1, 2, 3]), ('b', [1, 2]), ('c', [1])] 
```

groupby(l, lambda x:x[0]) 给你一个包含 ['a', [('a', 1), ...], c, [('c', 1)], 的迭代器。 ..]

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-04T17:06:28.187

我只会做基本的

```
答案 = {}
对于 list_of_tuples 中的键、值：
  如果键入答案：
    答案[key].append(value)
  别的：
    答案[键] = [值]

```

如果它这么短，为什么要使用任何复杂的东西。当然，如果您不介意使用 setdefault 也没关系。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-11-07T23:11:33.383

### 打印按第一项分组的元组列表

这个答案基于[@gommen one](https://stackoverflow.com/questions/261655/converting-a-list-of-tuples-into-a-dict-in-python/261766#261766)。

```
#!/usr/bin/env python

from itertools import groupby
from operator  import itemgetter

L = [
('a', 1),
('a', 2),
('a', 3),
('b', 1),
('b', 2),
('c', 1),
]

key = itemgetter(0)
L.sort(key=key) #NOTE: use `L.sort()` if you'd like second items to be sorted too
for k, group in groupby(L, key=key):
    print k, ' '.join(str(item[1]) for item in group) 
```

输出：

```
a 1 2 3
b 1 2
c 1 
```

# c# - 如何为 TreeView 中的某些但不是所有节点设置图像？

> ID：261660
> 
> 赞同：22
> 
> 时间：2008-11-04T12:04:45.267
> 
> 标签：c#, .net, winforms, treeview

我有一个带有 的`TreeView`windows 窗体控件`ImageList`，我希望一些节点显示图像，但其他节点没有图像。

我*不*想要图像应该存在的空白区域。如果没有 ImageList，我*不想要一个看起来像 TreeView 将绘制的线条的图像。*我如何让它为某些项目而不是其他项目绘制图像，而不需要像这样笨拙的黑客？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-06-17T20:55:48.977

您需要将`ImageIndex`和设置`SelectedImageIndex`为一个高于`ImageList`. 例如，如果您创建此节点并将其添加到您的`TreeView`：

```
TreeNode node1 = new TreeNode(string.Empty, 12, 12); // imageList1.Count = 5 
```

你会在`TreeNode`你的`TreeView`. 我改变了我的背景颜色，`TreeView`它仍然是不可见的。

（我用谷歌搜索了一段时间，最终在这里找到了答案：[http](http://www.tech-archive.net/Archive/DotNet/microsoft.public.dotnet.framework.windowsforms/2006-09/msg00322.html) ://www.tech-archive.net/Archive/DotNet/microsoft.public.dotnet.framework.windowsforms/2006-09/msg00322.html ）

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-12-16T16:49:59.477

我选择做的是为那些`TreeView`不应该有图像的节点使用点图像。

![带有图像点的 TreeNode](https://i.stack.imgur.com/5UT6j.png)

我将此图像添加为列表中的最后一个图像，如果该项目不应该有图像，我将其设置为`ImageList.Images.Count-1`

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2015-07-20T01:55:29.527

我发现在 TreeView 上使用 StateImageList 而不是 ImageList 只会在 TreeNode 上的 StateImageIndex 等于或大于 0 时显示图像

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-11-04T16:36:21.053

我试过一次，我认为这是不可能的。

如果您尝试同时设置`ImageKey`和`ImageIndex`“未设置”值，则控件默认`ImageIndex`为 0。以下代码：

```
treeView.ImageKey = "Value";
Debug.WriteLine(treeView.ImageIndex);
treeView.ImageKey = null;
Debug.WriteLine(treeView.ImageIndex);
treeView.ImageIndex = -1;
Debug.WriteLine(treeView.ImageIndex); 
```

产生输出：

```
-1
0
0 
```

这种方式告诉您，控件开发人员希望确保始终存在默认图像。恐怕这只会给你留下黑客选项。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-02-03T02:47:08.560

**这将在图像应该出现的位置绘制`TreeNode`文本，摆脱空白。**

您需要将`TreeView`'`DrawMode`属性设置为`OwnerDrawText`. 您可以`DrawMode`在属性面板中找到该属性。

接下来，当您添加一个节点时，将其设置为`ImageIndex`大于`SelectedImageIndex`您的值的`yourImageListName.Images.Count`值。这样就不会绘制任何图像，但仍然会有你不想要的空白。

现在摆脱空白。为 treeviews`DrawNode`事件添加句柄。这可以通过转到树视图属性面板并单击面板中看起来像一个闪电的图标来完成，然后滚动直到看到文本`DrawNode`，然后双击它。

现在您只需将其复制并粘贴到创建的方法中

```
if (e.Node.ImageIndex >= e.Node.TreeView.ImageList.Images.Count) // if there is no image
{
    int imagewidths = e.Node.TreeView.ImageList.ImageSize.Width;
    int textheight = TextRenderer.MeasureText(e.Node.Text, e.Node.NodeFont).Height;
    int x = e.Node.Bounds.Left - 3 - imagewidths / 2;
    int y = (e.Bounds.Top + e.Bounds.Bottom) / 2+1;

    Point point = new Point(x - imagewidths/2, y - textheight/2); // the new location for the text to be drawn

    TextRenderer.DrawText(e.Graphics, e.Node.Text, e.Node.NodeFont, point, e.Node.ForeColor);
}
else // drawn at the default location
    TextRenderer.DrawText(e.Graphics, e.Node.Text, e.Node.TreeView.Font, e.Bounds, e.Node.ForeColor); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-07-09T19:43:06.977

嘿兄弟，我找到了方法。将第一张图片设置为空图片，像这样...

```
TreeView treeView = new TreeView();
treeView.ImageList.Images.Add(new Bitmap(1,1)); 
```

因此，索引 0 是一个空图像。我希望这有帮助

# c# - 我们可以在 c# 中定义枚举的隐式转换吗？

> ID：261663
> 
> 赞同：141
> 
> 时间：2008-11-04T12:06:25.123
> 
> 标签：c#, enums, implicit-conversion, implicit

是否可以在 c# 中定义枚举的隐式转换？

可以做到这一点的东西？

```
public enum MyEnum
{
    one = 1, two = 2
}

MyEnum number = MyEnum.one;
long i = number; 
```

如果不是，为什么不呢？

* * *

## 回答 #1

> 赞同：131
> 
> 时间：2010-06-01T11:31:17.080

有一个解决方案。考虑以下：

```
public sealed class AccountStatus
{
    public static readonly AccountStatus Open = new AccountStatus(1);
    public static readonly AccountStatus Closed = new AccountStatus(2);

    public static readonly SortedList<byte, AccountStatus> Values = new SortedList<byte, AccountStatus>();
    private readonly byte Value;

    private AccountStatus(byte value)
    {
        this.Value = value;
        Values.Add(value, this);
    }

    public static implicit operator AccountStatus(byte value)
    {
        return Values[value];
    }

    public static implicit operator byte(AccountStatus value)
    {
        return value.Value;
    }
} 
```

以上提供了隐式转换：

```
 AccountStatus openedAccount = 1;            // Works
        byte openedValue = AccountStatus.Open;      // Works 
```

这比声明一个普通的枚举要多得多（尽管你可以将上面的一些重构为一个通用的通用基类）。通过让基类实现 IComparable 和 IEquatable，以及添加方法来返回 DescriptionAttributes 的值、声明的名称等，您可以走得更远。

我编写了一个基类 (RichEnum<>) 来处理大部分繁琐的工作，这将上面的枚举声明简化为：

```
public sealed class AccountStatus : RichEnum<byte, AccountStatus>
{
    public static readonly AccountStatus Open = new AccountStatus(1);
    public static readonly AccountStatus Closed = new AccountStatus(2);

    private AccountStatus(byte value) : base (value)
    {
    }

    public static implicit operator AccountStatus(byte value)
    {
        return Convert(value);
    }
} 
```

下面列出了基类 (RichEnum)。

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Diagnostics;
using System.Linq;
using System.Reflection;
using System.Resources;

namespace Ethica
{
    using Reflection;
    using Text;

    [DebuggerDisplay("{Value} ({Name})")]
    public abstract class RichEnum<TValue, TDerived>
                : IEquatable<TDerived>,
                  IComparable<TDerived>,
                  IComparable, IComparer<TDerived>
        where TValue : struct , IComparable<TValue>, IEquatable<TValue>
        where TDerived : RichEnum<TValue, TDerived>
    {
        #region Backing Fields

        /// <summary>
        /// The value of the enum item
        /// </summary>
        public readonly TValue Value;

        /// <summary>
        /// The public field name, determined from reflection
        /// </summary>
        private string _name;

        /// <summary>
        /// The DescriptionAttribute, if any, linked to the declaring field
        /// </summary>
        private DescriptionAttribute _descriptionAttribute;

        /// <summary>
        /// Reverse lookup to convert values back to local instances
        /// </summary>
        private static SortedList<TValue, TDerived> _values;

        private static bool _isInitialized;

        #endregion

        #region Constructors

        protected RichEnum(TValue value)
        {
            if (_values == null)
                _values = new SortedList<TValue, TDerived>();
            this.Value = value;
            _values.Add(value, (TDerived)this);
        }

        #endregion

        #region Properties

        public string Name
        {
            get
            {
                CheckInitialized();
                return _name;
            }
        }

        public string Description
        {
            get
            {
                CheckInitialized();

                if (_descriptionAttribute != null)
                    return _descriptionAttribute.Description;

                return _name;
            }
        }

        #endregion

        #region Initialization

        private static void CheckInitialized()
        {
            if (!_isInitialized)
            {
                ResourceManager _resources = new ResourceManager(typeof(TDerived).Name, typeof(TDerived).Assembly);

                var fields = typeof(TDerived)
                                .GetFields(BindingFlags.Static | BindingFlags.GetField | BindingFlags.Public)
                                .Where(t => t.FieldType == typeof(TDerived));

                foreach (var field in fields)
                {

                    TDerived instance = (TDerived)field.GetValue(null);
                    instance._name = field.Name;
                    instance._descriptionAttribute = field.GetAttribute<DescriptionAttribute>();

                    var displayName = field.Name.ToPhrase();
                }
                _isInitialized = true;
            }
        }

        #endregion

        #region Conversion and Equality

        public static TDerived Convert(TValue value)
        {
            return _values[value];
        }

        public static bool TryConvert(TValue value, out TDerived result)
        {
            return _values.TryGetValue(value, out result);
        }

        public static implicit operator TValue(RichEnum<TValue, TDerived> value)
        {
            return value.Value;
        }

        public static implicit operator RichEnum<TValue, TDerived>(TValue value)
        {
            return _values[value];
        }

        public static implicit operator TDerived(RichEnum<TValue, TDerived> value)
        {
            return value;
        }

        public override string ToString()
        {
            return _name;
        }

        #endregion

        #region IEquatable<TDerived> Members

        public override bool Equals(object obj)
        {
            if (obj != null)
            {
                if (obj is TValue)
                    return Value.Equals((TValue)obj);

                if (obj is TDerived)
                    return Value.Equals(((TDerived)obj).Value);
            }
            return false;
        }

        bool IEquatable<TDerived>.Equals(TDerived other)
        {
            return Value.Equals(other.Value);
        }

        public override int GetHashCode()
        {
            return Value.GetHashCode();
        }

        #endregion

        #region IComparable Members

        int IComparable<TDerived>.CompareTo(TDerived other)
        {
            return Value.CompareTo(other.Value);
        }

        int IComparable.CompareTo(object obj)
        {
            if (obj != null)
            {
                if (obj is TValue)
                    return Value.CompareTo((TValue)obj);

                if (obj is TDerived)
                    return Value.CompareTo(((TDerived)obj).Value);
            }
            return -1;
        }

        int IComparer<TDerived>.Compare(TDerived x, TDerived y)
        {
            return (x == null) ? -1 :
                   (y == null) ? 1 :
                    x.Value.CompareTo(y.Value);
        }

        #endregion

        public static IEnumerable<TDerived> Values
        {
            get
            {
                return _values.Values;
            }
        }

        public static TDerived Parse(string name)
        {
            foreach (TDerived value in _values.Values)
                if (0 == string.Compare(value.Name, name, true) || 0 == string.Compare(value.DisplayName, name, true))
                    return value;

            return null;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2008-11-04T12:21:52.800

您不能进行隐式转换（零除外），也不能编写自己的实例方法 - 但是，您可能可以编写自己的扩展方法：

```
public enum MyEnum { A, B, C }
public static class MyEnumExt
{
    public static int Value(this MyEnum foo) { return (int)foo; }
    static void Main()
    {
        MyEnum val = MyEnum.A;
        int i = val.Value();
    }
} 
```

不过，这并没有给你很多东西（与仅仅做一个明确的演员相比）。

我看到人们想要这样做的主要时间之一是`[Flags]`通过泛型进行操作 - 即一种`bool IsFlagSet<T>(T value, T flag);`方法。不幸的是，C# 3.0 不支持泛型上的运算符，但您可以使用[类似这样的东西](http://www.pobox.com/~skeet/csharp/miscutil/usage/genericoperators.html)来解决这个问题，这使得运算符完全可用于泛型。

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2012-10-15T18:27:49.337

```
struct PseudoEnum
{
    public const int 
              INPT = 0,
              CTXT = 1,
              OUTP = 2;
};

// ...

var arr = new String[3];

arr[PseudoEnum.CTXT] = "can";
arr[PseudoEnum.INPT] = "use";
arr[PseudoEnum.CTXT] = "as";
arr[PseudoEnum.CTXT] = "array";
arr[PseudoEnum.OUTP] = "index"; 
```

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2011-03-29T23:31:14.370

我改编了 Mark 出色的 RichEnum 通用基类。

定影

1.  由于他的库中缺少位而导致的一些编译问题（特别是：资源相关的显示名称没有完全删除；它们现在是）
2.  初始化并不完美：如果你做的第一件事是从基类访问静态 .Values 属性，你会得到一个 NPE。通过强制基类以*奇怪的方式递归*（[CRTP](http://en.wikipedia.org/wiki/Curiously_recurring_template_pattern)）来解决这个问题，在 CheckInitialized 期间及时强制 TDerived 的静态构造
3.  最后将 CheckInitialized 逻辑移动到静态构造函数中（以避免每次检查的惩罚，多线程初始化的竞争条件；也许这是我的项目符号 1 解决的不可能。？）

感谢 Mark 出色的想法 + 实施，这是给大家的：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Diagnostics;
using System.Linq;
using System.Reflection;
using System.Resources;

namespace NMatrix
{

    [DebuggerDisplay("{Value} ({Name})")]
    public abstract class RichEnum<TValue, TDerived>
                : IEquatable<TDerived>,
                  IComparable<TDerived>,
                  IComparable, IComparer<TDerived>
        where TValue : struct, IComparable<TValue>, IEquatable<TValue>
        where TDerived : RichEnum<TValue, TDerived>
    {
        #region Backing Fields

        /// <summary>
        /// The value of the enum item
        /// </summary>
        public readonly TValue Value;

        /// <summary>
        /// The public field name, determined from reflection
        /// </summary>
        private string _name;

        /// <summary>
        /// The DescriptionAttribute, if any, linked to the declaring field
        /// </summary>
        private DescriptionAttribute _descriptionAttribute;

        /// <summary>
        /// Reverse lookup to convert values back to local instances
        /// </summary>
        private static readonly SortedList<TValue, TDerived> _values = new SortedList<TValue, TDerived>();

        #endregion

        #region Constructors

        protected RichEnum(TValue value)
        {
            this.Value = value;
            _values.Add(value, (TDerived)this);
        }

        #endregion

        #region Properties

        public string Name
        {
            get
            {
                return _name;
            }
        }

        public string Description
        {
            get
            {
                if (_descriptionAttribute != null)
                    return _descriptionAttribute.Description;

                return _name;
            }
        }

        #endregion

        #region Initialization

        static RichEnum()
        {
            var fields = typeof(TDerived)
                .GetFields(BindingFlags.Static | BindingFlags.GetField | BindingFlags.Public)
                .Where(t => t.FieldType == typeof(TDerived));

            foreach (var field in fields)
            {
                /*var dummy =*/ field.GetValue(null); // forces static initializer to run for TDerived

                TDerived instance = (TDerived)field.GetValue(null);
                instance._name = field.Name;
                                    instance._descriptionAttribute = field.GetCustomAttributes(true).OfType<DescriptionAttribute>().FirstOrDefault();
            }
        }

        #endregion

        #region Conversion and Equality

        public static TDerived Convert(TValue value)
        {
            return _values[value];
        }

        public static bool TryConvert(TValue value, out TDerived result)
        {
            return _values.TryGetValue(value, out result);
        }

        public static implicit operator TValue(RichEnum<TValue, TDerived> value)
        {
            return value.Value;
        }

        public static implicit operator RichEnum<TValue, TDerived>(TValue value)
        {
            return _values[value];
        }

        public static implicit operator TDerived(RichEnum<TValue, TDerived> value)
        {
            return value;
        }

        public override string ToString()
        {
            return _name;
        }

        #endregion

        #region IEquatable<TDerived> Members

        public override bool Equals(object obj)
        {
            if (obj != null)
            {
                if (obj is TValue)
                    return Value.Equals((TValue)obj);

                if (obj is TDerived)
                    return Value.Equals(((TDerived)obj).Value);
            }
            return false;
        }

        bool IEquatable<TDerived>.Equals(TDerived other)
        {
            return Value.Equals(other.Value);
        }

        public override int GetHashCode()
        {
            return Value.GetHashCode();
        }

        #endregion

        #region IComparable Members

        int IComparable<TDerived>.CompareTo(TDerived other)
        {
            return Value.CompareTo(other.Value);
        }

        int IComparable.CompareTo(object obj)
        {
            if (obj != null)
            {
                if (obj is TValue)
                    return Value.CompareTo((TValue)obj);

                if (obj is TDerived)
                    return Value.CompareTo(((TDerived)obj).Value);
            }
            return -1;
        }

        int IComparer<TDerived>.Compare(TDerived x, TDerived y)
        {
            return (x == null) ? -1 :
                   (y == null) ? 1 :
                    x.Value.CompareTo(y.Value);
        }

        #endregion

        public static IEnumerable<TDerived> Values
        {
            get
            {
                return _values.Values;
            }
        }

        public static TDerived Parse(string name)
        {
            foreach (TDerived value in Values)
                if (0 == string.Compare(value.Name, name, true))
                    return value;

            return null;
        }
    }
} 
```

我在单声道上运行的使用示例：

```
using System.ComponentModel;
using System;

namespace NMatrix
{    
    public sealed class MyEnum : RichEnum<int, MyEnum>
    {
        [Description("aap")]  public static readonly MyEnum my_aap   = new MyEnum(63000);
        [Description("noot")] public static readonly MyEnum my_noot  = new MyEnum(63001);
        [Description("mies")] public static readonly MyEnum my_mies  = new MyEnum(63002);

        private MyEnum(int value) : base (value) { } 
        public static implicit operator MyEnum(int value) { return Convert(value); }
    }

    public static class Program
    {
        public static void Main(string[] args)
        {
            foreach (var enumvalue in MyEnum.Values)
                Console.WriteLine("MyEnum {0}: {1} ({2})", (int) enumvalue, enumvalue, enumvalue.Description);
        }
    }
} 
```

产生输出

```
[mono] ~/custom/demo @ gmcs test.cs richenum.cs && ./test.exe 
MyEnum 63000: my_aap (aap)
MyEnum 63001: my_noot (noot)
MyEnum 63002: my_mies (mies) 
```

注意：单声道 2.6.7 需要额外的显式转换，而使用单声道 2.8.2 时不需要......

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-11-04T12:16:54.743

您不能在枚举类型上声明隐式转换，因为它们不能定义方法。C#[隐式](http://msdn.microsoft.com/en-us/library/z5z9kes2(VS.80).aspx)关键字编译为以“op_”开头的方法，在这种情况下不起作用。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-11-04T12:18:20.093

你可能可以，但不是枚举（你不能向它添加方法）。您可以向自己的类添加隐式转换，以允许将枚举转换为它，

```
public class MyClass {

    public static implicit operator MyClass ( MyEnum input ) {
        //...
    }
}

MyClass m = MyEnum.One; 
```

问题是为什么？

一般来说，.Net 避免（你也应该）避免任何可能丢失数据的隐式转换。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-11-04T12:11:44.333

如果将枚举的基数定义为 long，则可以执行显式转换。我不知道您是否可以使用隐式转换，因为枚举不能在其上定义方法。

```
public enum MyEnum : long
{
    one = 1,
    two = 2,
}

MyEnum number = MyEnum.one;
long i = (long)number; 
```

另外，请注意，未初始化的枚举将默认为 0 值或第一项 - 因此在上述情况下，最好也定义`zero = 0`。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2018-08-23T04:27:17.237

因此，枚举对我来说基本上没用，OP。

我最终一直在做与图片相关的事情：

[简单的解决方案](https://i.stack.imgur.com/CTOcU.png)

经典的示例问题是用于检测按键的 VirtualKey 集。

```
enum VKeys : ushort
{
a = 1,
b = 2,
c = 3
}
// the goal is to index the array using predefined constants
int[] array = new int[500];
var x = array[VKeys.VK_LSHIFT]; 
```

这里的问题是你不能用枚举索引数组，因为它不能隐式地将枚举转换为 ushort（即使我们甚至将枚举基于 ushort）

在这个特定的上下文中，枚举被以下数据结构淘汰了。. . .

```
public static class VKeys
{
public const ushort
a = 1,
b = 2, 
c = 3;
} 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2016-08-25T09:13:07.777

我从这里[https://codereview.stackexchange.com/questions/7566/enum-vs-int-wrapper-struct](https://codereview.stackexchange.com/questions/7566/enum-vs-int-wrapper-struct)找到了更简单的解决方案，我从该链接粘贴了下面的代码，以防它在将来不起作用。

```
struct Day
{
    readonly int day;

    public static readonly Day Monday = 0;
    public static readonly Day Tuesday = 1;
    public static readonly Day Wednesday = 2;
    public static readonly Day Thursday = 3;
    public static readonly Day Friday = 4;
    public static readonly Day Saturday = 5;
    public static readonly Day Sunday = 6;

    private Day(int day)
    {
        this.day = day;
    }

    public static implicit operator int(Day value)
    {
        return value.day;
    }

    public static implicit operator Day(int value)
    {
        return new Day(value);
    }
} 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2020-01-29T14:09:24.367

我创建了这个实用程序来帮助我将**Enum**转换为**PrimitiveEnum**并将**PrimitiveEnum**转换为`byte, sbyte, short, ushort, int, uint, long, or ulong`.

因此，这在技术上将任何枚举转换为其任何原始值。

```
public enum MyEnum
{
    one = 1, two = 2
}

PrimitiveEnum number = MyEnum.one;
long i = number; 
```

[请参阅https://github.com/McKabue/McKabue.Extentions.Utility/blob/master/src/McKabue.Extentions.Utility/Enums/PrimitiveEnum.cs](https://github.com/McKabue/McKabue.Extentions.Utility/blob/master/src/McKabue.Extentions.Utility/Enums/PrimitiveEnum.cs)的提交

```
using System;

namespace McKabue.Extentions.Utility.Enums
{
    /// <summary>
    /// <see href="https://stackoverflow.com/q/261663/3563013">
    /// Can we define implicit conversions of enums in c#?
    /// </see>
    /// </summary>
    public struct PrimitiveEnum
    {
        private Enum _enum;

        public PrimitiveEnum(Enum _enum)
        {
            this._enum = _enum;
        }

        public Enum Enum => _enum;

        public static implicit operator PrimitiveEnum(Enum _enum)
        {
            return new PrimitiveEnum(_enum);
        }

        public static implicit operator Enum(PrimitiveEnum primitiveEnum)
        {
            return primitiveEnum.Enum;
        }

        public static implicit operator byte(PrimitiveEnum primitiveEnum)
        {
            return Convert.ToByte(primitiveEnum.Enum);
        }

        public static implicit operator sbyte(PrimitiveEnum primitiveEnum)
        {
            return Convert.ToSByte(primitiveEnum.Enum);
        }

        public static implicit operator short(PrimitiveEnum primitiveEnum)
        {
            return Convert.ToInt16(primitiveEnum.Enum);
        }

        public static implicit operator ushort(PrimitiveEnum primitiveEnum)
        {
            return Convert.ToUInt16(primitiveEnum.Enum);
        }

        public static implicit operator int(PrimitiveEnum primitiveEnum)
        {
            return Convert.ToInt32(primitiveEnum.Enum);
        }

        public static implicit operator uint(PrimitiveEnum primitiveEnum)
        {
            return Convert.ToUInt32(primitiveEnum.Enum);
        }

        public static implicit operator long(PrimitiveEnum primitiveEnum)
        {
            return Convert.ToInt64(primitiveEnum.Enum);
        }

        public static implicit operator ulong(PrimitiveEnum primitiveEnum)
        {
            return Convert.ToUInt64(primitiveEnum.Enum);
        }
    }
} 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2015-05-22T11:47:11.203

在 MS .net（非 Mono）上运行代码时，我已经解决了[sehe 的答案问题。](https://stackoverflow.com/a/5480173/684096)对我来说，这个问题特别发生在 .net 4.5.1 上，但其他版本似乎也受到了影响。

## 问题

通过反射访问 a `public static TDervied MyEnumValue`（通过`FieldInfo.GetValue(null)`不*初始化*所述字段。

## 解决方法

`TDerived`而不是在静态初始化器上为实例分配名称，而是`RichEnum<TValue, TDerived>`在第一次访问时懒惰地完成`TDerived.Name`. 编码：

```
public abstract class RichEnum<TValue, TDerived> : EquatableBase<TDerived>
    where TValue : struct, IComparable<TValue>, IEquatable<TValue>
    where TDerived : RichEnum<TValue, TDerived>
{
    // Enforcing that the field Name (´SomeEnum.SomeEnumValue´) is the same as its 
    // instances ´SomeEnum.Name´ is done by the static initializer of this class.
    // Explanation of initialization sequence:
    // 1\. the static initializer of ´RichEnum<TValue, TDerived>´ reflects TDervied and 
    //    creates a list of all ´public static TDervied´ fields:
    //   ´EnumInstanceToNameMapping´
    // 2\. the static initializer of ´TDerive´d assigns values to these fields
    // 3\. The user is now able to access the values of a field.
    //    Upon first access of ´TDervied.Name´ we search the list 
    //    ´EnumInstanceToNameMapping´ (created at step 1) for the field that holds
    //    ´this´ instance of ´TDerived´.
    //    We then get the Name for ´this´ from the FieldInfo
    private static readonly IReadOnlyCollection<EnumInstanceReflectionInfo> 
                            EnumInstanceToNameMapping = 
        typeof(TDerived)
            .GetFields(BindingFlags.Static | BindingFlags.GetField | BindingFlags.Public)
            .Where(t => t.FieldType == typeof(TDerived))
            .Select(fieldInfo => new EnumInstanceReflectionInfo(fieldInfo))
            .ToList();

    private static readonly SortedList<TValue, TDerived> Values =
        new SortedList<TValue, TDerived>();

    public readonly TValue Value;

    private readonly Lazy<string> _name;

    protected RichEnum(TValue value)
    {
        Value = value;

        // SortedList doesn't allow duplicates so we don't need to do
        // duplicate checking ourselves
        Values.Add(value, (TDerived)this);

        _name = new Lazy<string>(
                    () => EnumInstanceToNameMapping
                         .First(x => ReferenceEquals(this, x.Instance))
                         .Name);
    }

    public string Name
    {
        get { return _name.Value; }
    }

    public static implicit operator TValue(RichEnum<TValue, TDerived> richEnum)
    {
        return richEnum.Value;
    }

    public static TDerived Convert(TValue value)
    {
        return Values[value];
    }

    protected override bool Equals(TDerived other)
    {
        return Value.Equals(other.Value);
    }

    protected override int ComputeHashCode()
    {
        return Value.GetHashCode();
    }

    private class EnumInstanceReflectionInfo
    {
        private readonly FieldInfo _field;
        private readonly Lazy<TDerived> _instance;

        public EnumInstanceReflectionInfo(FieldInfo field)
        {
            _field = field;
            _instance = new Lazy<TDerived>(() => (TDerived)field.GetValue(null));
        }

        public TDerived Instance
        {
            get { return _instance.Value; }
        }

        public string Name { get { return _field.Name; } }
    }
} 
```

这 - 在我的情况下 - 基于`EquatableBase<T>`：

```
public abstract class EquatableBase<T>
    where T : class 
{
    public override bool Equals(object obj)
    {
        if (this == obj)
        {
            return true;
        }

        T other = obj as T;
        if (other == null)
        {
            return false;
        }

        return Equals(other);
    }

    protected abstract bool Equals(T other);

    public override int GetHashCode()
    {
        unchecked
        {
            return ComputeHashCode();
        }
    }

    protected abstract int ComputeHashCode();
} 
```

## 笔记

上面的代码没有包含[Mark](https://stackoverflow.com/users/64084/mark)原始答案的所有功能！

## 谢谢

感谢[Mark](https://stackoverflow.com/users/64084/mark)提供了他的`RichEnum`实现，感谢[sehe](https://stackoverflow.com/users/85371/sehe)提供了一些改进！

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-11-06T08:49:33.190

@BatteryBackupUnit 嘿，这听起来像是一个很酷的解决方案，但你能在这里解释一下这部分吗？

由于我使用 .NET 4.7.2 得到了一个“InvalidCastException”，可悲的是：/

```
 _name = new Lazy<string>(
                () => EnumInstanceToNameMapping
                     .First(x => ReferenceEquals(this, x.Instance))
                     .Name); 
```

我不知道为什么，我创建了 RichEnum 的派生类型并初始化为您在示例中所做的一切，但我得到了这个 annyoingg 异常..

会很高兴对此有所帮助，因为我非常喜欢这种方法。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-09-13T19:39:03.447

这是基于[adminSoftDK 的答案](https://stackoverflow.com/a/39141171/8058709)的不同风格。

```
/// <summary>
/// Based on https://datatracker.ietf.org/doc/html/rfc4346#appendix-A.1
/// </summary>
[DebuggerDisplay("{_value}")]
public struct HandshakeContentType
{
    #region Types
    public const byte ChangeCipher = 0x14;
    public const byte Alert = 0x15;
    public const byte Handshake = 0x16;
    public const byte ApplicationData = 0x17;
    #endregion

    byte _value;
    private HandshakeContentType(byte value)
    {
        _value = value;

        switch (_value)
        {
            case ChangeCipher:
            case Alert:
            case Handshake:
            case ApplicationData:
                break;

            default:
                throw new InvalidOperationException($"An invalid handshake content type (${value}) was provided.");
        }
    }

    #region Methods
    public static implicit operator byte(HandshakeContentType type) => type._value;
    public static implicit operator HandshakeContentType(byte b) => new HandshakeContentType(b);
    #endregion
} 
```

这使您可以将其`struct`与`switch`我认为非常棒的语句一起使用。

* * *

## 回答 #14

> 赞同：-2
> 
> 时间：2008-11-04T12:19:31.353

为枚举类型引入隐式转换会破坏类型安全，所以我不建议这样做。你为什么想这么做？我见过的唯一用例是当您想将枚举值放入具有预定义布局的结构中时。但即便如此，您也可以在结构中使用 enum 类型，然后告诉 Marshaller 他应该如何处理它。

# java - 如何将 EJB3 注释转换为 ejb-jar.xml 文件配置？

> ID：261668
> 
> 赞同：2
> 
> 时间：2008-11-04T12:08:24.073
> 
> 标签：java, jakarta-ee, ejb-3.0

我正在寻找一种可以从带注释的 EJB3 类创建 ejb-jar.xml 配置文件的工具。类似于 XDoclet 的东西，但用于注释，而不是注释中的标签。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-07T12:35:39.943

我不知道这样的工具是否存在，但 Java 确实提供了一套很好的工具来构建您自己的程序来处理带注释的类。[注释处理工具](http://java.sun.com/j2se/1.5.0/docs/guide/apt/GettingStarted.html)(APT)使处理注释变得容易。我怀疑您使用了 EJB3 注释的一小部分，因此您不需要支持整个规范。您甚至可以编写一个快速处理器来发现您使用的所有注释并报告它们，以便您有一个需要处理的注释的清晰列表。

Ant 也作为一个[apt](http://ant.apache.org/manual/Tasks/apt.html)任务，它可以使进程更容易运行。

如果您最终接受了这个，即使您的实现不完整（即它没有涵盖所有可能的 EJB3 注释/选项），也可能值得将代码发布到[Google Code](http://code.google.com/projecthosting/)之类的地方，以便其他人可以受益，并且可能扩展工具以支持更广泛的选项。

# javascript - 如何为 jsUnit-ant-script 指定相对路径？

> ID：261679
> 
> 赞同：4
> 
> 时间：2008-11-04T12:12:46.187
> 
> 标签：javascript, unit-testing, ant, build-automation, jsunit

[JsUnit](https://github.com/pivotal/jsunit)提供了一个带有目标“standalone_test”的 ant 脚本。该目标使用属性 url 来识别执行测试的 HTML 站点。这些站点已签入，因此每个人都应该能够在签出后执行此测试。这可行，但 url-proprty 必须设置为绝对路径，例如`file:///home/user/projects/my-project/path/in/project/jsunit/testRunner.html`. 这避免了自动启动，每个人也都指定了一个命令，其中包含在他的盒子上构建的路径。是否可以改为传递相对路径/url，以便这些测试的执行可以自动化？这将有助于在我们的持续集成系统中设置这些测试。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-12T08:55:03.790

您可以使用[内置的 Ant](http://ant.apache.org/manual/using.html#built-in-props)[属性](http://ant.apache.org/manual/using.html#built-in-props)`url`构造属性值。[`basedir`](http://ant.apache.org/manual/using.html#built-in-props)

例如，如果您的构建脚本位于您的目录中并从您的`/home/user/projects/my-projects`目录运行，您可以将您的`url`属性设置为：

```
<property
    id="url"
    name="url"
    value="file://${basedir}/path/in/project/jsunit/testRunner.html"/> 
```

# multithreading - 术语“线程安全”是什么意思？

> ID：261683
> 
> 赞同：424
> 
> 时间：2008-11-04T12:14:05.203
> 
> 标签：multithreading, language-agnostic, programming-languages, concurrency

这是否意味着两个线程不能同时更改底层数据？或者这是否意味着当多个线程正在执行该代码段时，给定的代码段将以可预测的结果运行？

* * *

## 回答 #1

> 赞同：97
> 
> 时间：2008-11-04T12:17:28.503

线程安全代码是即使许多线程同时执行它也能工作的代码。

[http://mindprod.com/jgloss/threadsafe.html](http://mindprod.com/jgloss/threadsafe.html)

* * *

## 回答 #2

> 赞同：64
> 
> 时间：2008-11-04T16:59:08.840

一个更具信息性的问题是什么使代码不是线程安全的 - 答案是有四个条件必须为真......想象一下下面的代码（它是机器语言翻译）

```
totalRequests = totalRequests + 1
MOV EAX, [totalRequests]   // load memory for tot Requests into register
INC EAX                    // update register
MOV [totalRequests], EAX   // store updated value back to memory 
```

1.  第一个条件是可以从多个线程访问的内存位置。通常，这些位置是全局/静态变量，或者是可从全局/静态变量访问的堆内存。每个线程都为函数/方法范围的局部变量获取它自己的堆栈帧，因此这些局部函数/方法变量 otoh（位于堆栈上）只能从拥有该堆栈的一个线程访问。
2.  第二个条件是存在与这些共享内存位置相关联的属性（通常称为*不变量*），该属性必须为真或有效，程序才能正常运行。在上面的示例中，属性是“<em>totalRequests 必须准确地表示任何线程执行增量语句的任何部分的总次数”。通常，此不变属性需要在更新发生之前保持为真（在这种情况下，totalRequests 必须保持准确的计数）才能使更新正确。
3.  第三个条件是不变量属性在实际更新的某些部分不成立。（它在处理的某些部分暂时无效或错误）。在这种特殊情况下，从获取 totalRequests 到存储更新值的时间，totalRequests不满足*不*变量。
4.  竞争发生必须发生的第四个也是最后一个条件（因此代码***不是***“线程安全的”）是另一个线程必须能够在不变量被破坏*时*访问共享内存，从而导致不一致或不正确的行为。

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2008-11-04T14:32:11.663

我喜欢 Brian Goetz 的 Java Concurrency in Practice 中的定义，因为它的全面性

“如果一个类在从多个线程访问时行为正确，则该类是线程安全的，无论运行时环境对这些线程执行的调度或交错如何，并且调用代码部分没有额外的同步或其他协调。 "

* * *

## 回答 #4

> 赞同：33
> 
> 时间：2008-11-04T12:30:25.933

正如其他人指出的那样，线程安全意味着如果一段代码同时被多个线程使用，则它可以正常工作。

值得注意的是，这有时会以计算机时间和更复杂的编码为代价，因此并不总是可取的。如果一个类只能在一个线程上安全地使用，那么这样做可能会更好。

例如，Java 有两个几乎等价的类，`StringBuffer`而`StringBuilder`. 不同之处在于它是线程安全的，因此多个线程可以同时使用`StringBuffer`a 的单个实例。不是线程安全的，并且被设计为当 String 仅由一个线程构建时的那些情况（绝大多数）的更高性能替代品。`StringBuffer``StringBuilder`

* * *

## 回答 #5

> 赞同：32
> 
> 时间：2008-11-04T13:46:37.137

一种更容易理解的方法是使代码不是线程安全的。有两个主要问题会使线程应用程序具有不需要的行为。

*   在不锁定的情况下访问共享变量
    此变量可以在执行函数时被另一个线程修改。您想通过锁定机制来防止它，以确保您的函数的行为。一般的经验法则是尽可能缩短锁定时间。

*   由共享变量相互依赖引起的死锁
    如果你有两个共享变量 A 和 B。在一个函数中，你先锁定 A，然后再锁定 B。在另一个函数中，你开始锁定 B，一段时间后，你锁定 A。这是一个潜在的死锁，其中第一个函数将等待 B 被解锁，而第二个函数将等待 A 被解锁。此问题可能不会在您的开发环境中发生，并且只会不时发生。为避免这种情况，所有锁必须始终保持相同的顺序。

* * *

## 回答 #6

> 赞同：23
> 
> 时间：2008-11-04T12:17:29.017

线程安全代码按规定工作，即使不同线程同时输入。这通常意味着，应该不间断地运行的内部数据结构或操作同时受到不同修改的保护。

* * *

## 回答 #7

> 赞同：15
> 
> 时间：2019-10-26T19:28:14.617

至少在 C++ 中，我认为*线程安全*有点用词不当，因为它留下了很多名字。为了线程安全，代码通常必须**主动**处理它。这通常不是一种被动的品质。

对于线程安全的类，它必须具有增加开销的“额外”功能。这些特性是类实现的一部分，一般来说，对接口是隐藏的。也就是说，不同的线程可以访问任何类的成员，而不必担心与不同线程的并发访问发生冲突，并且可以以非常懒惰的方式这样做，使用一些普通的老式常规人类编码风格，而不必做所有已经卷入被调用代码内部的疯狂同步工作。

这就是为什么有些人更喜欢使用*内部同步*这个术语。

## 术语集

我遇到的这些想法主要有三组术语。第一个也是历史上更受欢迎（但最差）的是：

1.  *线程安全*
2.  不是*线程安全的*

第二个（更好的）是：

1.  *螺纹证明*
2.  *线程兼容*
3.  *线程敌对*

第三个是（甚至更好）一个是：

1.  *内部同步*
2.  *外部同步*
3.  *不可同步*

## 类比

*线程安全*~*线程证明*~*内部同步*

*内部同步*（又名*线程安全*或*线程证明*）系统的一个示例是餐厅，主人在门口迎接您，并禁止您自己排队。主人是餐厅处理多个顾客的机制的一部分，并且可以使用一些相当棘手的技巧来优化等待顾客的座位，比如考虑他们的聚会规模，或者他们看起来有多少时间，甚至通过电话进行预订。餐厅是内部同步的，因为当您与之互动时，所有这些都包含在“幕后”。你，客户，不要做任何事情。房东会为你做这一切。

*不是线程安全的*（但很好）~*线程兼容*~*外部同步*~*自由线程*

假设你去银行。有一条线，即银行柜员的竞争。因为你不是野蛮人，所以你认识到在争夺资源时最好的办法就是像文明人一样排队。没有人在技术上让你这样做。我们希望你有必要的社交编程来自己做这件事。从这个意义上说，银行大厅是*外部同步的。*

我们应该说它是线程不安全的吗？*如果您使用线程安全*、*线程不安全的*双极术语集，这就是含义。这不是一组很好的术语。更好的术语是*外部同步，*银行大厅对被多个客户访问并不怀有敌意，但它也不做同步他们的工作。客户自己这样做。

这也称为“free threaded”，其中“free”与“free from lice”一样——或者在这种情况下是锁。好吧，更准确地说，是同步原语。这并不意味着代码可以在没有这些原语的情况下在多个线程上运行。这只是意味着它没有随它们一起安装，它取决于你，代码的用户，你自己安装它们，但你认为合适。安装您自己的同步原语可能很困难，并且需要仔细考虑代码，但也可以通过允许您自定义程序在当今超线程 CPU 上的执行方式来实现最快的程序。

*不是线程安全*的（而且不好）~*线程敌对*~不可*同步*

一个*线程敌对*系统的日常类比示例是一个混蛋，一辆跑车拒绝使用他们的闪光灯并随意改变车道。他们的驾驶风格是*线程敌对*或*不可同步的*，因为您无法与他们协调，这可能导致争用同一车道，没有解决方案，因此当两辆车试图占据同一空间时发生事故，没有任何协议防止这种情况。这种模式也可以更广泛地被认为是*反社会的，*尽管它不是特定于线程，而是更普遍地适用于编程的许多领域。

## 为什么*线程安全*/*非线程安全*是一个不好的术语集

*第一个也是最古老的术语集未能在线程敌意*和*线程兼容性*之间做出更精细的区分。线程兼容性比所谓的线程安全更被动，但这并不意味着被调用的代码对于并发线程使用是不安全的。这只是意味着它对允许这样做的同步是被动的，将其推迟到调用代码中，而不是将其作为其内部实现的一部分提供。*在大多数情况下，线程兼容*是默认编写代码的方式，但遗憾的是，这也经常被错误地认为是*线程不安全*的，好像它本质上是反安全的，这对程序员来说是一个主要的困惑点。

注意：许多软件手册实际上使用术语“线程安全”来指代“线程兼容”，这给已经一团糟的内容增添了更多混乱！出于这个原因，我不惜一切代价避免使用术语“线程安全”和“线程不安全”，因为一些消息来源会称其为“线程安全”，而另一些则称其为“线程不安全”，因为他们不能同意关于您是否必须满足一些额外的安全标准（预安装的同步原语），或者只是不敌对才能被认为是“安全的”。因此，请避免使用这些术语并改用更智能的术语，以避免与其他工程师发生危险的错误沟通。

## 提醒我们的目标

本质上，我们的目标是颠覆混乱。

我们通过创建我们可以依赖的半确定性系统来做到这一点。确定性是昂贵的，主要是由于失去并行性、流水线和重新排序的机会成本。我们试图最大限度地减少我们需要的确定性，以保持低成本，同时避免做出会进一步削弱我们能够承受的微不足道的确定性的决策。因此，半前缀。我们只希望代码状态的某些小部分是确定性的，而底层的计算机制不必完全如此。线程的同步是关于增加多线程系统中的顺序并减少混乱，因为拥有多个线程自然会导致大量的非确定性，必须以某种方式抑制这种不确定性。

总而言之，一些代码体可以在三个主要程度的努力上投入“杂耍刀”——即在多线程的上下文中正确工作。

最高程度（*线程证明*等）意味着即使您从多个线程中草率地调用它，系统也会以可预测的方式运行。它自己完成了实现这一目标所需的工作，因此您不必这样做。它为您（编写调用代码的程序员）提供了这个漂亮的界面，这样您就可以假装生活在一个没有同步原语的世界中。因为它已经在内部包含了它们。它也很昂贵，速度很慢，而且由于它正在执行同步而需要多长时间来完成任务，这也有点不可预测，这必须始终大于您特定程序所需的数量，因为它不知道*您的*代码会做。非常适合使用各种脚本语言进行科学或其他事情的临时编码人员，但他们自己并没有编写高效的接近金属的代码。他们不需要杂耍刀。

第二级（*线程兼容*等）意味着系统表现得足够好，调用代码可以及时可靠地检测到不可预测性，以便在运行时使用自己安装的同步原语正确处理它。DIY同步。BYOSP = 自带同步原语。至少你知道你调用的代码会很好地适应它们。这适用于更接近金属的专业程序员。

第三级（*线程敌对*等）意味着系统表现得不够好，无法与其他任何人一起玩，并且只能单线程运行而不会引起混乱。本质上，这是经典的 90 年代早期和更早的代码。它的编程缺乏对如何从多个线程调用或使用它的高度意识，以至于即使您尝试自己添加这些同步原语，它也无法正常工作，因为它做出了老式的假设，即这些日子似乎反社会和不专业。

但是，某些代码只有在称为单线程时才真正有意义，因此仍会故意以这种方式调用。对于已经具有高效流水线和内存访问序列的软件尤其如此，并且没有受益于多线程的主要目的：隐藏内存访问延迟。访问非高速缓存内存比大多数其他指令慢得多。因此，每当应用程序等待一些内存访问时，它应该同时切换到另一个任务线程以保持处理器工作。当然，这些天来，这可能意味着切换到另一个协程/光纤/等。在同一个线程中，如果可用，因为它们比线程上下文切换更有效。但是一旦暂时用尽了那些，它'

但有时，您的所有内存访问都被很好地打包和排序，而您最不想做的就是切换到另一个线程，因为您已经将代码流水线化以尽可能有效地处理这个问题。然后线程受伤无济于事。这是一个例子，但还有其他例子。

总的来说，我认为在编写要调用的代码时尽可能使用*线程兼容*是有意义的，特别是如果没有真正的理由不这样做，而且它只需要您在编写代码时的意识。

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2008-11-04T12:31:51.767

不要将线程安全与确定性混淆。线程安全代码也可以是非确定性的。鉴于调试线程代码问题的难度，这可能是正常情况。:-)

线程安全只是确保当一个线程正在修改或读取共享数据时，没有其他线程可以以更改数据的方式访问它。如果您的代码依赖于特定的执行顺序以确保正确性，那么您需要除了线程安全所需的其他同步机制来确保这一点。

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2008-11-04T12:35:14.083

简单地说 - 如果许多线程同时执行此代码，代码将运行良好。

* * *

## 回答 #10

> 赞同：9
> 
> 时间：2013-02-07T10:57:14.097

从本质上讲，在多线程环境中，很多事情都可能出错（指令重新排序、部分构造的对象、由于 CPU 级别的缓存，相同的变量在不同的线程中具有不同的值等）。

[我喜欢Java Concurrency in Practice](http://www.javaconcurrencyinpractice.com/)给出的定义：

> 如果一个[代码部分]在从多个线程访问时行为正确，则它是线程安全的，而不管运行时环境对这些线程执行的调度或交错，并且没有额外的同步或其他协调调用代码。

*正确*的意思是程序的行为符合其规范。

**人为的例子**

想象一下，您实现了一个计数器。您可以说它在以下情况下表现正确：

*   `counter.next()`从不返回之前已经返回的值（为简单起见，我们假设没有溢出等）
*   从 0 到当前值的所有值都已在某个阶段返回（没有跳过任何值）

线程安全计数器将根据这些规则运行，无论有多少线程同时访问它（这通常不是简单实现的情况）。

[注意：[程序员的交叉帖子](https://softwareengineering.stackexchange.com/a/179457/47845)]

* * *

## 回答 #11

> 赞同：9
> 
> 时间：2008-11-04T12:59:36.733

是和不是。

线程安全不仅仅是确保您的共享数据一次只能由一个线程访问。您必须确保对共享数据的顺序访问，同时避免[竞争条件](http://en.wikipedia.org/wiki/Race_condition)、[死锁](http://en.wikipedia.org/wiki/Deadlock)、[活锁](http://en.wikipedia.org/wiki/Livelock#Livelock)和[资源匮乏](http://en.wikipedia.org/wiki/Resource_starvation)。

多线程运行时的不可预测结果*不是*线程安全代码的必需条件，但它通常是副产品。例如，您可以设置一个[生产者-消费者](http://en.wikipedia.org/wiki/Producer-consumer_problem)方案，其中包含一个共享队列、一个生产者线程和几个消费者线程，并且数据流可能是完全可预测的。如果您开始介绍更多的消费者，您会看到更多随机的结果。

* * *

## 回答 #12

> 赞同：7
> 
> 时间：2019-05-10T09:07:03.547

让我们通过例子来回答这个问题：

```
class NonThreadSafe {

    private int count = 0;

    public boolean countTo10() {
        count = count + 1;
        return (count == 10);
    } 
```

该`countTo10`方法将计数器加一，然后如果计数达到 10，则返回 true。它应该只返回 true 一次。

只要只有一个线程在运行代码，这将起作用。如果两个线程同时运行代码，可能会出现各种问题。

例如，如果 count 从 9 开始，一个线程可以将 1 加到 count （使 10），但随后第二个线程可以进入该方法并在第一个线程有机会执行与 10 的比较之前再次加 1（使 11） . 然后两个线程都做比较，发现count都是11，都没有返回true。

所以这段代码不是线程安全的。

本质上，所有的多线程问题都是由这类问题的某种变体引起的。

解决方案是确保加法和比较不能分开（例如，通过某种同步代码将两条语句包围起来）或设计一种不需要两次操作的解决方案。这样的代码将是线程安全的。

* * *

## 回答 #13

> 赞同：6
> 
> 时间：2016-05-20T17:42:20.883

我想在其他好的答案之上添加更多信息。

***线程安全意味着多个线程可以在同一个对象中写入/读取数据而不会出现内存不一致错误。在高度多线程的程序中，线程安全的程序不会对共享数据造成副作用***。

查看此 SE 问题以了解更多详细信息：

[线程安全是什么意思？](https://stackoverflow.com/questions/2033879/what-does-threadsafe-mean/37346570#37346570)

***线程安全程序保证内存一致性***。

来自高级并发 API 的oracle 文档[页面：](https://docs.oracle.com/javase/7/docs/api/java/util/concurrent/package-summary.html)

**内存一致性属性：**

Java™ 语言规范的第 17 章定义了内存操作（例如共享变量的读取和写入）的发生前关系。*只有当写操作发生在读操作之前，一个线程写的结果才能保证对另一个线程的读可见*。

`synchronized`and`volatile`结构以及`Thread.start()`and`Thread.join()`方法可以形成*先发生的*关系。

所有类`java.util.concurrent`及其子包中的方法都将这些保证扩展到*更高级别的同步。*尤其是：

1.  在将对象放入任何并发集合之前的线程中的操作发生在另一个线程中从集合中访问或删除该元素之后的操作。
2.  线程中的操作在提交`Runnable`到`Executor`发生之前执行之前。对于提交给`ExecutorService`.
3.  在通过另一个线程`Future`检索结果之后，异步计算所采取的操作由发生前的操作表示。`Future.get()`
4.  在“释放”*同步器*方法之前的操作，例如`Lock.unlock, Semaphore.release, and CountDownLatch.countDown`在成功“获取”方法之后的操作之前发生的操作，例如`Lock.lock, Semaphore.acquire, Condition.await, and CountDownLatch.await`在另一个线程中的相同同步器对象上。
5.  对于通过 成功交换对象的每对线程，每个线程中的 之前`Exchanger`的动作`exchange()`发生在另一个线程中对应的 exchange() 之后的动作之前。
6.  调用之前的动作`CyclicBarrier.await`和`Phaser.awaitAdvance`（及其变体）由屏障动作执行的动作发生之前，以及屏障动作执行的动作发生在从其他线程中的相应等待成功返回之后的动作。

* * *

## 回答 #14

> 赞同：5
> 
> 时间：2008-11-04T12:41:38.127

要完成其他答案：

仅当您的方法中的代码执行以下两种操作之一时，同步才令人担忧：

1.  与一些不是线程安全的外部资源一起使用。
2.  读取或更改持久对象或类字段

这意味着在您的方法中定义的变量始终是线程安全的。对方法的每次调用都有自己的这些变量版本。如果该方法被另一个线程调用，或者被同一个线程调用，或者即使该方法调用自身（递归），这些变量的值也不会共享。

线程调度不保证是**[循环的](http://en.wikipedia.org/wiki/Round_robin)**。一个任务可能以相同优先级的线程为代价完全占用 CPU。你可以使用 Thread.yield() 有良心。您可以使用（在 java 中）Thread.setPriority(Thread.NORM_PRIORITY-1) 来降低线程的优先级

另外要注意：

*   迭代这些“线程安全”结构的应用程序的大量运行时成本（其他人已经提到过）。
*   Thread.sleep(5000) 应该休眠 5 秒。但是，如果有人更改系统时间，您可能会睡很长时间或根本没有时间。操作系统以绝对形式记录唤醒时间，而不是相对形式。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2008-11-04T12:36:15.500

是的，是的。这意味着数据不会被多个线程同时修改。但是，您的程序可能会按预期工作，并且看起来是线程安全的，即使它根本不是。

请注意，结果的不可预测性是“竞争条件”的结果，这可能导致数据以不同于预期的顺序被修改。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2020-05-22T15:19:44.420

与其将*代码*或*类*视为线程安全与否，我认为将*动作*视为线程安全更有帮助。如果两个动作在从任意线程上下文运行时按照指定的方式运行，则它们是线程安全的。在许多情况下，类将支持线程安全方式的某些操作组合，而其他则不支持。

例如，许多集合（如数组列表和哈希集）将保证，如果它们最初仅由一个线程访问，并且在引用对任何其他线程可见后它们永远不会被修改，则它们可以通过任何组合以任意方式读取线程无干扰。

更有趣的是，一些哈希集集合，例如 .NET 中的原始非泛型集合，可以保证只要没有项目被删除，并且只要一个线程向它们写入，任何试图读取集合的行为就像访问一个集合，其中更新可能会延迟并以任意顺序发生，但否则会正常运行。如果线程#1 添加X，然后添加Y，线程#2 查找并看到Y，然后是X，线程#2 可能会看到Y 存在但X 不存在；这种行为是否是“线程安全的”取决于线程#2 是否准备好处理这种可能性。

最后一点，一些类——尤其是阻塞通信库——可能有一个“close”或“Dispose”方法，相对于所有其他方法是线程安全的，但没有其他方法是线程安全的彼此。如果线程执行阻塞读取请求并且程序的用户单击“取消”，则尝试执行读取的线程将无法发出关闭请求。然而，关闭/释放请求可能会异步设置一个标志，这将导致读取请求尽快被取消。一旦在任何线程上执行关闭，该对象将变得无用，并且所有未来操作的尝试都会立即失败，

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2013-12-15T09:19:52.143

用最简单的话来说：P 如果在一个代码块上执行多个线程是安全的，那么它就是线程安全的*

*适用条件

其他答案（例如1）提到了条件。如果您在其上执行一个线程或多个线程等，结果应该是相同的。

# c# - 继承期间的表达式推断

> ID：261709
> 
> 赞同：1
> 
> 时间：2008-11-04T12:21:55.373
> 
> 标签：c#, compiler-errors, expression-trees, type-inference

我有以下代码：

```
using System;
using System.Linq;
using System.Linq.Expressions;

public class Program
{
    public static void Main()
    {
        Descendant d = new Descendant();
        d.TestMethod();
    }
}

public class Base
{
    protected void FigureItOut<TClass, TMember>(Expression<Func<TClass, TMember>> expr)
    {

    }
}

public class Descendant : Base
{
    public void TestMethod()
    {
        FigureItOut(c => c.Name);
    }

    public String Name { get; set; }
} 
```

我收到此编译器错误消息：

```
The type arguments for method
'Base.FigureItOut<TClass,TMember> 
(System.Linq.Expressions.Expression<System.Func<TClass,TMember>>)'
cannot be inferred from the usage. Try specifying the type arguments explicitly. 
```

如果我将对 FigureItOut 的调用更改为：

```
FigureItOut((Descendant c) => c.Name); 
```

然后它工作。有没有办法通过更改基类来编译第一个示例？

我知道如果我将整个 Base 类设为通用，如下所示：

```
public class Base<TDescendant>
{
    protected void FigureItOut<TMember>(Expression<Func<TDescendant, TMember>> expr)
    {

    }
}

public class Descendant : Base<Descendant>
{
    public void TestMethod()
    {
        FigureItOut(c => c.Name);
    }

    public String Name { get; set; }
} 
```

然后它可以工作，但我宁愿不这样做，任何其他可以使用的黑客，也许在方法级别（即以某种方式更改 FigureItOut）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-04T12:36:33.800

调用实际 ( `protected internal`) 实现的扩展方法怎么样？唯一的缺点是您必须添加`this.`.

这是有效的，因为`source`参数 (via `this`) 推断出`TClass`.

```
public class Base
{
    protected internal void FigureItOut<TClass, TMember>(Expression<Func<TClass, TMember>> expr)
    {
        Debug.WriteLine("Got to actual method");
    }
}

public static class BaseExt
{
    public static void FigureItOut<TClass, TMember>(this TClass source, Expression<Func<TClass, TMember>> expr)
        where TClass : Base
    { // call the actual method
        Debug.WriteLine("Got to extension method");
        source.FigureItOut(expr);
    }
}
public class Descendant : Base
{
    public void TestMethod()
    {
        this.FigureItOut(c => c.Name);
    }

    public String Name { get; set; }
} 
```

* * *

作为替代方案（如果这`internal`很痛苦），请考虑将其设为静态，并使用主要用于类型推断的实例参数：

```
protected static void FigureItOut<TClass, TMember>(TClass source, Expression<Func<TClass, TMember>> expr)
{

}

public void TestMethod()
{
    FigureItOut(this, c => c.Name);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-04T12:37:02.643

除非它带有参数，否则无法推断。除非它分配返回值，否则无法推断。

# sql - Performance of multi-column MySQL indexes when using only one column in a query

> ID：261717
> 
> 赞同：7
> 
> 时间：2008-11-04T12:26:18.423
> 
> 标签：sql, mysql, indexing

I have a query on my database as such:

```
SELECT * FROM expenses WHERE user_id = ? AND dated_on = ? 
```

I have added an index to the table on both the `user_id` and `dated_on` columns. When I inspect the indexes using `SHOW INDEXES FROM expenses`, there are two lines -- one with a `seq_in_index` value of 1, the other with a `seq_in_index` value of 2.

My question is, if I then submit a query which uses only one of the two WHERE clauses, e.g.:

```
SELECT * FROM expenses WHERE user_id = ? 
```

Is there any benefit to creating another index which solely indexes the `user_id` column, or will the `user_id`/`dated_on` index described above be used just as efficiently?

Finally, how about if use the query:

```
SELECT * FROM expenses WHERE dated_on = ? 
```

How does the `seq_in_index` value of 2 affect index use and performance in this situation?

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-04T12:40:52.573

MySQL can use [any left portion of an index](http://dev.mysql.com/doc/refman/5.0/en/mysql-indexes.html).

In your example `SELECT * FROM expenses WHERE user_id = ?` will use the index but `SELECT * FROM expenses WHERE dated_on = ?` won't.

For a 3-column index A, B, C, `WHERE A = ? AND B = ?` will use an index over A and B, but `WHERE A = ? AND C = ?` will only use an index on A

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-04T12:29:15.577

If your index on user_id and dated_on is really in that order (user_id first), then it will be used for a user_id query also. You can check by using EXPLAIN to see the actual strategy for the query.

# database-design - 布尔表达式的数据模型

> ID：261721
> 
> 赞同：18
> 
> 时间：2008-11-04T12:28:20.383
> 
> 标签：database-design, datamodel, boolean-expression

您知道一种在数据库中组织布尔表达式同时允许表达式无限嵌套的方法吗？

例子：

```
a = 1 AND (b = 1 OR b = 2) 
```

整个表达式不应存储为 varchar 以保持数据完整性。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-04T12:39:40.347

选项 1 是使用嵌套表（具有 id / parent_id 结构的树），就像 Gamecat 建议的那样。这样做的成本相对较高，并且需要重复发出 SQL 查询来构建等效的单个嵌套表达式。

选项 2 是使用序列化对象并将其存储到 varchar 列中。例如，JSON 将是一个不错的选择。它对空格不敏感，可以用大量语言创建和解析，并且保持数据完整性。

一旦您将表达式字符串解析为内存中的树对象，您就可以对其进行序列化并存储它。如果不需要在数据库级别操作表达式，我想我会走那条路。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-04T12:36:19.150

表达式是树状结构。因此，您需要一种在表格中呈现树的方法。

例如，您可以使用以下字段：

*   ID
*   TypeExpression (and, or etc...)
*   第一个孩子ID
*   第二个孩子ID

在这种情况下，您有以下类型：

1.  AND，Children 指向其他表达式。
2.  OR，Children 指向其他表达式。
3.  相等，Children 指向其他表达式。
4.  字面量，FirstChild 指向字面量表中的一个条目。
5.  VariableLookup，FirstChild 指向变量表中的一个条目。

但我认为有更好的方式来组织表达。我曾经做过一个简单的表达式求值器，它接受一个字符串并产生一个数字结果。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-04T12:43:14.567

这种类型的表达式最通常表示为树（层次结构），众所周知，在 SQL 中查询很烦人。

我们将假设`a`和`b`目前是数字，并且文字（'1'，'2'）与变量区分开来。

```
Table Nodes
id
type (Variable|Literal)
name (nullable for literal)
value

Table Operators
id
name (=, AND, OR, NOT)
leftNodeId
rightNodeId 
```

这种结构非常灵活，但查询它以检索复杂的表达式将是“有趣的”（读作“具有挑战性的”）。

并且您仍然必须解析结构以开始并在重建后评估表达式。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-04-30T12:18:14.983

我会将表达式以波兰语形式存储在 varchar/text 列中。波兰语形式的表达式（操作数在操作数之前，没有括号）更容易用递归函数（当然也可以是堆栈）解析。

a = 1 与（b = 1 或 b = 2）

以波兰语形式显示如下：

与 = a 1 或 = b 1 = b 2

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-04T14:12:50.423

对布尔函数建模的传统方法是使用[二元决策图](http://en.wikipedia.org/wiki/Binary_decision_diagram)，尤其是降阶二元决策图。您可能会找到为您的 DBMS 提供良好支持的扩展。

更新：或者，如果您不需要查询布尔逻辑，您可以使用 BDD 库并将 BDD 序列化为`BLOB`或等效。它优于使用`varchar`字段，因为 BDD 库将确保数据有效。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-04T12:41:49.297

这将很难以关系方式表示，因为就其性质而言，它既是分层的又是多态的（树的叶子可以是变量或常量）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-11-13T11:03:00.103

好的答案，但如果表达式组中有超过 2 个表达式怎么办？

```
a = 1 AND (b = 1 OR b = 2 OR b = 3) 
```

我建议：

```
-------------------
|    Condition    |
-------------------
| - id            |
| - value1        |
| - value2        |
| - operation     |
-------------------
    |(1)
    |        --------------
    |       |              |
    |       |(*)           |
-------------------        |
| ConditionGroup  |        |
-------------------        |
| - id            |--------
| - groupType     |
| - condition     |
| - subConditionGroups
------------------- 
```

*   `value1`,`value2`并`operation`为最终比较建模，例如 ' `b = 3`' （在我的情况下`value1 = 'b'`,`value2 = '3'`和`operation = 'EQUALS'`）
*   `groupeType`可以是' `AND`'或' `OR`'
*   a可以有s`ConditionGroup`的子列表**或**final但**不能同时有**。`ConditionGroup`**`Condition`**
*****   现在您的开始表达式是 a `ConditionGroup`，递归地挖掘它`subConditionGroups`直到找到最终条件，然后返回值并应用正确的`condition`。****

 ****其实这就是我要尝试的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-05T09:33:52.920

Adding to @Gamechat answer

I think it should be like this

ID

TypeExpression (and, or etc...)

FirstChildID --This can be a leaf node or a pointer to another row in same table

SecondChildID --This can be a leaf node or a pointer to another row in same table

isFirstChildLeaf

isSecondChildLeaf

# windows - 如何将目录结构导入 SVN，保持文件和文件夹修改日期相同？

> ID：261731
> 
> 赞同：3
> 
> 时间：2008-11-04T12:32:44.323
> 
> 标签：windows, svn, timestamp, beyondcompare

我有一个大型源代码树（> 2 GB，WINCE 构建树），我想开始使用 Subversion 进行管理。到目前为止，“版本控制”已通过保留树的多个副本并使用 Beyond Compare 来查找差异来进行管理。

我看到使用 Subversion 的最后一个大绊脚石是它将文件时间戳修改为提交时间。这使得 Beyond Compare 比较更加耗时，因为您必须进行二进制比较才能发现更改。

我查看了 subversion 源代码树的[元数据版本控制](http://svn.haxx.se/users/archive-2006-03/0949.shtml)分支，但我不想尝试将 2006 年的代码合并到当前的 svn 源代码中。

谢谢，

戴夫

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-04T13:10:14.387

有一个 svn config 选项可以控制时间戳在存储库中的存储方式：

```
use-commit-times 
```

> 通常，您的工作副本文件具有反映它们最后一次被任何进程触及的时间戳，无论是您自己的编辑器还是某些 svn 子命令。这对于开发软件的人来说通常很方便，因为构建系统通常将时间戳视为决定哪些文件需要重新编译的一种方式。
> 
> 然而，在其他情况下，有时工作副本文件最好有时间戳，以反映它们在存储库中的最后一次更改。svn export 命令总是将这些“最后提交时间戳”放在它生成的树上。通过将此配置变量设置为 yes，svn checkout、svn update、svn switch 和 svn revert 命令还将在它们接触的文件上设置最后提交时间戳。

请参阅[运行时配置区域](http://svnbook.red-bean.com/en/1.1/svn-book.html#svn-ch-7-sect-1)和 [配置选项](http://svnbook.red-bean.com/en/1.1/svn-book.html#svn-ch-7-sect-1.3.2)

顺便说一句，超越比较**岩石！** 我使用所有提到的，svn diff，TortoiseMerge 和 BC2。BC2是最完整的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-04T12:39:55.837

Subversion 会比无法比较更快地进行比较..

如果您使用 tortoiseSVN，您甚至可以使用超越比较作为外部 Diff 工具。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-04T12:49:36.753

经过快速检查：如果您从工作副本提交文件，它会保留它的时间戳（最后修改时间）。即使在更新之后（无需对该文件进行进一步的远程更改），该文件也会保留上次修改的时间戳。测试是在带有 Subversion 1.4.6 版的 Linux 上进行的。

如果您更新了一个远程更改的文件，它将获得一个新的时间戳。

因此，您保留上次修改的时间戳。

此外：为什么要使用“超越比较”进行差异。您将不再需要保留不同的目录来反映不同的版本。并且颠覆有它自己的差异功能，可以为修订组合准备差异。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-21T15:23:29.623

Whether "use-commit-times" needs to be set to yes on every client m/c config file OR is there any option to centralize this on Subversion installation directory?.

# c# - 用于检查连接的 SQL 语句？

> ID：261735
> 
> 赞同：8
> 
> 时间：2008-11-04T12:35:09.590
> 
> 标签：c#, sql

我正在寻找一个虚拟 SQL 语句，它可以通过 C# SQL 连接来检查连接性。

基本上我需要向数据库发送一个请求，我不在乎它返回什么我只希望它在数据库仍然存在时成功，如果数据库不存在则抛出异常。

我正在测试的场景是与数据库的连接丢失，其中 SQLConnections State 属性似乎仍然是“打开”但没有连接。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-04T12:43:15.860

你可以这样做：

```
Select 1 
```

好的，发送一个空字符串或空格怎么样。这些是 Sql Server 的有效命令。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-04T12:39:05.527

大多数 SQL 数据库都有一个用于此目的的“表”。

在 DB2 中，它是：

```
select * from sysibm.sysdummy1 
```

而甲骨文有，从记忆中，

```
select * from dual 
```

这将取决于后端的数据库。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-04T12:52:53.813

连接丢失可能随时发生。

如果建议的 SELECT 语句执行良好，但在（成功）执行它们后连接立即中断怎么办？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-04T15:28:46.557

最简单的方法是执行一个什么都不做的选择。

```
SELECT N'Test' 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-04T12:43:38.200

如果由于数据库不可用而无法打开新连接，您应该会收到错误消息。

在我看来，您一直在保持连接打开（这通常是一个坏主意 - 应该在执行批处理之前打开一个新连接）。是这样吗？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-04T13:15:45.610

选择获取日期（）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-04T17:23:47.543

最好为您执行的每个 sql 语句捕获实现的未连接异常，而不是使用虚拟语句来测试连接性。我见过一些系统，其中超过 10% 的数据库 CPU 时间用于响应这些虚拟查询。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-04T17:38:01.337

示例 Delphi 代码，我相信它很容易适应：

```
function IsConnValid(var Conn: TADOConnection; DBType: TDBType): boolean;
var
  qry : TADOQuery;
begin
  //gimme a connection, and i'll create a query, try to retrieve dummy data.
  //if retrieval works, return TRUE. otherwise, return FALSE.
  qry := TADOQuery.Create(nil);
  try
    qry.Connection := Conn;

    case DBType of
      //syntax for a dummy query varies by vendor.
      dbOracle    : qry.Sql.Add('SELECT 1 FROM DUAL');
      dbSqlServer : qry.Sql.Add('SELECT 1');
    end;  //case

    try
      qry.Open;
      //try to open the query.
      //if we lost the connection, we'll probably get an exception.
      Result := not(qry.Eof);  //a working connection will NOT have EOF.
      qry.Close;
    except on e : exception do
      //if exception when we try to open the qry, then connection went bye-bye.
      Result := False;
    end;  //try-except
  finally
    qry.Free;
  end;  //try-finally
end; 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-06T15:02:27.887

找出与数据库的连接是否仍然存在的一种方法是尝试对连接执行一些操作。如果连接已断开，ConnectionState 属性仍保持为“打开”，但是当您尝试对其进行操作时，您将获得异常。例如：

```
SqlConnection sqlConn;
    private bool dbConnectionExists() {
        try
        {
            sqlConn.ChangeDatabase("MyDBname");
            return true;
        }
        catch
        {
            return false;
        }
    }

    private void button1_Click(object sender, EventArgs e)
    {
        if (dbConnectionExists())
        {
            // Connection ok so do something            
        }
    } 
```

一旦执行此类操作并失败，connectionState 属性将更改为“已关闭”，因此您可以根据需要检查状态。

希望有帮助。

# tfs - 如何访问已离职员工的 TFS 工作区以查看/签入某些更改？

> ID：261738
> 
> 赞同：10
> 
> 时间：2008-11-04T12:35:46.780
> 
> 标签：tfs, workspace

我的一位同事已经辞职并被迫离开公司，然后才将他的所有代码签入 TFS。我可以访问物理文件。有没有办法让我访问他的工作区并签入一些仍未签入的更改？从 tfs 我可以看到他签出了哪些文件，但除非非常手动，否则无法看到确切的更改。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-01-16T10:52:36.453

在 TFS 2010 中，有一个名为“公共工作区”的新功能。这允许多人在计算机上**共享相同的工作区文件夹，但使用他们****自己的**登录身份验证到 TFS 。

TFS 管理员可以通过运行如下命令将工作区更改为“公共工作区”：

```
tf workspace /collection:http://yourserver:8080/tfs/yourCollection WorkspaceName;domain\CurrentWorkspaceOwner /permission:Public 
```

*（此命令可以在任何计算机上运行，​​它不需要与您尝试更改的工作区在同一台计算机上运行）*

如果只有一个其他用户需要使用该工作区，也许更简单的方法是更改​​该工作区的所有者。这可以由 TFS 管理员使用以下命令完成：

```
tf workspace /collection:http://yourserver:8080/tfs/yourCollection WorkspaceName;domain\CurrentWorkspaceOwner /newowner:domain\NewWorkspaceOwner 
```

完成上述任一操作后，您可以以新所有者身份登录该计算机，并像使用自己的工作区一样使用工作区。

[您可以在此博客文章TFS2010：公共工作区](http://blogs.msdn.com/b/granth/archive/2009/11/08/tfs2010-public-workspaces.aspx)中阅读有关此功能的更多信息。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-03-30T14:30:41.040

**1）**从他的机器复制文件。

**2)**从行政上撤消他的结帐。

**3)**检查您机器上的文件。

**4）**用他的文件覆盖你的文件。

**5）**您的机器状态现在应该大致等于他的；做尽可能多的比较。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-04T13:10:32.280

让您的系统管理员将用户密码重置为已知值，以该计算机上的用户身份登录，瞧，您就是用户...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-04T13:05:12.680

这可能是一种快速而肮脏的方式：

*   搁置或签入您自己的工作。
*   将您同事的相关文件复制到您自己的工作区
*   将文件与 TFS 中的最新文件进行比较

//huusom

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-11T14:48:24.100

您可以使用一些差异工具，例如超越比较来可视化实际差异。

要管理其他人的工作区甚至签出文件，很难击败[Team Sidekicks](http://www.attrice.info/cm/tfs/)，它是免费的，并为此和许多其他常规 TFS 工作提供了出色的界面。

# c# - 从 cs 文件中获取方法的内容

> ID：261741
> 
> 赞同：5
> 
> 时间：2008-11-04T12:36:24.003
> 
> 标签：c#, regex, methods

我需要将 cs 文件中每个方法的内容转换为字符串。我正在寻找的是当您输入一个 cs 文件时，将返回一个字典，其中方法名称作为键，方法体作为值。

我尝试了正则表达式和反射但没有成功，有人可以帮忙吗？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-04T13:18:48.457

我不知道它是否对您有用，但 Visual Studio 插件包含一个 EnvDTE 对象，它使您可以完全访问 VB 和 C# 语言解析器。请参阅[使用代码模型发现代码](http://msdn.microsoft.com/en-us/library/ms228763(VS.80).aspx)

几年前我偶然接触过它，我不知道它使用起来有多难，也不知道它有多有效，但它看起来确实会给你你需要的东西。

> **代码模型允许自动化客户端避免为 Visual Studio 语言实现解析器，**以便发现项目中的高级定义，例如类、接口、结构、方法、属性等。

如果您完整阅读这篇文章，它会告诉您如何从文件中提取全文以获取函数

希望这可以帮助 ：）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-04T12:49:09.233

**假设文件是​​有效的**（即编译），您可以从将整个文件读入字符串开始。

我从您的问题中得知您只对方法名称感兴趣，而不对类名感兴趣。*然后，您需要一个正则表达式，它为您提供public|protected|private*的所有实例、可选关键字 virtual/override 等、 *MethodName*、*(*、可选参数*)*。如果有编码约定会有所帮助，因此您可以**假设**所有方法定义总是在一行中，而不是分布在多行中。

一旦你有了它，只需计算 { 和 } 即可获得函数体。

最后一个建议：**提防假设**。他们有咬你屁股的坏习惯。

**编辑：**哎呀，忘了评论！如果方法主体的注释中有括号，则计数可能会出错。因此，您需要从源代码中删除所有评论作为您的第一步。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-04T12:53:34.780

通常，您要解决的问题是以与编译器相同的方式解析 C# 代码，然后保存函数的内容而不是生成代码。因此，作为解决方案的背景，您应该查看 c# 语法以及如何解析它们。

根据 StingyJack 的说法，一个简单的方法是创建一个仅标识函数定义的正则表达式。然后你可以假设中间的一切都是一个函数体。然而，这种假设不会处理一个文件中的多个类，甚至是类末尾的尾随 }。要处理这样的事情，您必须设计 ac# 编译器，因为处理完整的 c# 语法是唯一能够正确识别 c# 认为是函数的东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-04T12:39:07.960

找到函数头后，计算大括号的数量，直到找到函数的结尾。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-04T12:47:07.943

定制的解析器将是最好的选择。正如 Blair 在对 StingyJack 的评论中所说，使用正则表达式解析代码非常困难。我尝试过一次，虽然可以将平衡大括号与 NET 匹配，但转义注释和字符串要复杂得多。

解析器应该使事情变得更简单。请参阅[antlr](http://www.antlr.org/)以获得良好的生成器。

至于反射，我相信你可以尝试编译代码（只要你有所有必要的依赖项），然后访问它的内容，就像反射器一样。但我会选择解析器。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-04T14:23:19.967

NRefactory 是完成这项工作的工具。看看这里： http: [//laputa.sharpdevelop.net/content/binary/NRefactory.wmv](http://laputa.sharpdevelop.net/content/binary/NRefactory.wmv)

# database-design - 具有动态变化维度的事实的良好（== 快速）存储策略？

> ID：261743
> 
> 赞同：1
> 
> 时间：2008-11-04T12:36:49.557
> 
> 标签：database-design

我需要在数据库中存储大量计量数据。**记录由标识数据源的 id、时间戳和值组成。稍后通过 id 及其时间戳检索记录。**

根据我以前的经验（我正在开发一个在过去五年中一直在生产使用的应用程序的继任者），磁盘 i/o 是数据检索的相关性能瓶颈。（另请参阅[我的另一个问题](https://stackoverflow.com/questions/26021/how-is-data-compression-more-effective-than-indexing-for-search-performance)）。

因为我从不寻找单行，但总是寻找（可能很大）与一系列 id 和时间戳匹配的行组，一个非常明显的优化似乎是**存储更大的压缩数据块，这些数据**由更小的索引访问（例如，按天数）并由应用程序**即时解压缩和过滤。**

我正在寻找的是**决定将数据的哪一部分放入一个块中的最佳策略**。在一个完美的世界中，每个用户请求都将通过检索一大块数据并使用其中的大部分或全部来实现。所以我想最小化我必须为每个请求加载的块数量，并且我想最小化每个块的多余数据。

我将在下面发布一个包含我迄今为止的想法的答案，并将其设为社区财产，以便您对其进行扩展。当然，如果您有不同的方法，请发布您自己的方法。

*ETA：[S. Lott](https://stackoverflow.com/users/10661/slott)在下面发布了[这个答案](https://stackoverflow.com/questions/261743/dynamic-data-storage-strategy#261881)，即使我不能直接使用它也有助于讨论（见我的评论）。这里的重点是，我的“事实”的“维度”受到（并且应该）受最终用户的影响，并随着时间的推移而变化。这是该应用程序的核心功能，实际上也是我首先提出这个问题的原因。*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-04T13:24:06.480

“与一系列 id 和时间戳匹配的行组”

你有两个维度：来源和时间。我确信数据源有很多属性。时间，我知道，有很多属性（年、月、日、小时、星期几、一年中的星期、季度、财政期间等）

虽然您的事实“只有”一个 ID 和一个时间戳，但它们可能对数据源维度和时间维度具有 FK。

被视为星型模式，定位“与一系列 id 匹配的行组”的查询可能——更准确地说——是具有公共数据源属性的一组行。它不是一个随机的 ID 集群，而是由您的维度的一些常见属性定义的 ID 集群。

一旦定义了数据源维度的这些属性，您的“分块”策略应该会更加明显。

此外，您可能会发现某些数据库产品的位图索引功能可以将您的事实简单地存储在一个普通的旧表中，而完全不会影响块设计。

如果位图索引仍然不够快，那么也许您必须将数据源属性非规范化为维度和事实，然后根据该维度属性对事实表进行分区。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-04T12:43:17.950

选项 3：

找到一个可以完成这项工作的聪明的数据库功能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-04T12:55:37.927

对于选项 1 和 3，您需要非常清楚您最频繁的查询将是什么。使用 80/20 规则，不要试图让**所有**查询都在同一级别执行。

选项 2 听起来很有趣，但簿记可能会有点麻烦。

选项 3 有一些承诺，因为它可以解决性能问题，而对应用程序几乎没有更改。我建议研究两件事：

1.  表分区。Oracle 和 MS Sql Server（以及其他，我敢肯定）支持按某个值（在本例中为日期/时间戳）对表中的数据进行物理分组。您可以将分区配置为驻留在不同的物理设备上，以跨硬件分散负载，从而减少延迟。
2.  使用包含的列进行索引。这对我来说总是有反直觉的，但是通过将要检索的列添加到索引中，可以执行整个查询而不会碰到实际的表。

这两个选项的缺点是必须更新索引的突变操作（插入/删除）。

您可能想尝试 1 和 3 的组合（它们在很多方面都很相似）与 #2 的风格。跟踪有关最常查询哪些时间段的统计信息（选项 2），并定期重新访问 1 或 3 中的策略，直到核心查询的性能可以接受。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-04T12:41:20.093

选项1：

对将要经常加载的内容做出一个很好的猜测，并将其放在一个而不是太大的块中。示例：每天吃一大块

优点：

*   很容易，数据查找可以通过简单的计算来完成（请求时间范围内涉及哪些天？），而不是保留去哪里的索引。
*   归档结构易于理解，无需工具

缺点：

*   不是最好的表现
*   不适应应用程序用户不断变化的行为

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-04T12:42:47.797

选项 2：

制定一个聪明的“重新平衡策略”，跟踪加载在一起的数据，并尝试将经常加载在一起的东西放在一起。这可能包括将行的副本保存在多个块中。

优点：

*   几乎可以任意聪明
*   可以在性能方面变得非常有效
*   允许不断发展的策略

缺点：

*   几乎可以任意开发、测试和调试
*   在自我优化开始之前，可能会表现不佳
*   多个记录副本可能会导致存储膨胀
*   不知何故，我觉得这应该由数据库来完成

# jquery - 从jquery调用rails函数？

> ID：261752
> 
> 赞同：1
> 
> 时间：2008-11-04T12:39:26.680
> 
> 标签：jquery, ruby-on-rails

是否可以从 jQuery 中调用 rails 函数或访问 rails 对象？我想做类似的事情：

```
jQuery(document).ready(function($) {
$('#mydiv').html("<%= @object.name %>");
}); 
```

或者

```
jQuery(document).ready(function($) {
$('#mydiv').html("<%= render :partial => "contacts" %>");
}); 
```

目前，我将所有 jQuery 内容保存在我的 application.js 中，它包含在我的布局中。哦，是的....而且我没有使用 Rails Edge。

问候，

塞巴斯蒂安

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-04T13:36:54.427

如果你想这样做，你必须在控制器中有一个方法来呈现你需要的东西。另一种方法是使用视图块，例如在布局视图的末尾

```
<script type="text/javascript">
<%= yield :footerjs %>
</script>
```

并在视图中执行以下操作：

```
<% content_for :footerjs do %>
jQuery(document).ready(function($) {
$('#mydiv').html('<%= escape_javascript(render :partial => "contacts") %>');
});
<% end %>
```

您需要确保要渲染的部分不会包含可能导致 javascript 错误的字符（例如在字符串结尾之前完成引号等）。此外，一些浏览器不喜欢多行字符串，所以你也必须摆弄它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-04T14:12:33.560

@changelog：非常感谢您的回答。

该行下方描述的问题已通过将 括`<%= yield :myjs %>`在适当的 javascript 标记中解决，如下所示：

```
<script type="text/javascript">
<%= yield :myjs %>
</script> 
```

再次感谢！！

* * *

我试图按照你说的方式实现它，但我遇到了一些困难：

我将以下 content_for 块放在 show.html.erb 的顶部：

```
<% content_for :myjs do %>
jQuery(document).ready(function($) { alert('hello'); });
<% end %> 
```

在我的 layout.html 中，我包含了所有的 javascript 如下（这里 applications.js 实现了一些通用的 jQuery 函数）：

```
<head>
...
<%= javascript_include_tag 'jquery', 'application' %>
<%= javascript_tag "var AUTH_TOKEN = #{form_authenticity_token.inspect};" if protect_against_forgery? %>
<% yield :myjs %>
</head>
<body>
... 
```

问题是当我调用它时，我的 javascript 没有显示在页面的源代码中。也不会调用警报功能。当我`<%= yield :myjs %>`改为（使用 =）时，javascript 呈现在我的正文块的开头，而不是头部，但是当我打开页面时仍然没有调用警报函数。

# java - 如何本地化 jcolorchooser

> ID：261777
> 
> 赞同：1
> 
> 时间：2008-11-04T12:44:30.600
> 
> 标签：java

作为大学项目的一部分，我们正在本地化我们的应用程序。

是否可以本地化摇摆组件，例如 JOptionPane，如果可以，如何本地化？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-04T13:00:49.397

一般来说，您可以使用[ResourceBundle](http://java.sun.com/j2se/1.5.0/docs/api/java/util/ResourceBundle.html)进行本地化（在选择字符串和消息的选项窗格中）。然后您可以将这些本地化字符串等用于 JOptionPane。例如：

```
String[] choises = new String[];
choises[0] = bundle.getString("yes");
choises[1] = bundle.getString("no");
choises[2] = bundle.getString("cancel");

String message = bundle.getString("messageText")

JOptionPane optionPane = new JOptionPane(message, JOptionPane.WARNING_MESSAGE,
        JOptionPane.YES_NO_CANCEL_OPTION, null, choises); 
```

有关资源包的更多详细信息，请查看[Java 国际化：使用 ResourceBundles 进行本地化](http://java.sun.com/developer/technicalArticles/Intl/ResourceBundles/)。

# objective-c - NSDateFormatter 不会使用语言环境设置解析日期？

> ID：261780
> 
> 赞同：0
> 
> 时间：2008-11-04T12:46:21.503
> 
> 标签：objective-c, cocoa, macos, internationalization, date

我正在尝试使用用户的日期首选项解析日期

```
[NSDateFormatter setDefaultFormatterBehavior:NSDateFormatterBehavior10_4];
NSDateFormatter *dateFormatter = [[[NSDateFormatter alloc] init] autorelease];
[dateFormatter setDateStyle:NSDateFormatterShortStyle];
NSDate *date = [ dateFormatter dateFromString:@"7/4/2008" ];
NSLog(@"string from date %@: %@ for locale %@", date, [dateFormatter stringFromDate:date], [[dateFormatter locale] localeIdentifier]); 
```

当我将我的地区（在国际系统首选项中）设置为美国时，它会打印：

```
2008-08-14 20:20:31.117 Date Difference17226:10b string from date 2008-07-04 00:00:00 -0400: 7/4/08 for locale en_US 
```

当我的地区是英国时，它会打印：

```
2008-08-14 20:19:23.441 Date Difference17199:10b string from date 2008-04-07 00:00:00 -0400: 07/04/2008 for locale en_GB 
```

看起来 NSDateFormatter 对区域的变化不敏感。但是请注意，日期的原始打印会随着区域正确切换。

我该怎么做才能让 NSDateFormatter 尊重区域设置？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-04T19:14:19.207

> 看起来 NSDateFormatter 对区域的变化不敏感。

不，它在两个方向上都使用语言环境。

您可以通过查看日期的描述（格式`%@`中的第一个`NSLog`）来了解格式化程序如何解释日期。
地区为美国，格式化程序将日期解释为**2008-07-04（7 月 4 日）**。
区域为 GB，格式化程序将日期解释为**2008-04-07 (April 7)**。

然后，您要求同一地区的同一格式化程序显示该日期。
使用美国格式的 7 月 4 日是 07/04/2008 (MM/DD/YYYY)。
使用 GB 格式的 4 月 7 日是 07/04/2008 (DD/MM/YYYY)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-04T18:55:53.317

这看起来是正确的。在第一个输出示例中，格式化的日期字符串是 7/4/200。第二个是 07/04/2008。

你期待什么不同？

如果您没有更改英国首选日期格式的格式首选项，我相信它默认为 MM/DD/YYYY，月份和日期小于 10 的前导零。

# sql - 如何从 x 等于多个值的地方进行选择？

> ID：261783
> 
> 赞同：73
> 
> 时间：2008-11-04T12:47:51.670
> 
> 标签：sql, mysql

我在调试一些代码，遇到了如下SQL查询（简化版）：

```
SELECT ads.*, location.county 
FROM ads
LEFT JOIN location ON location.county = ads.county_id
WHERE ads.published = 1 
AND ads.type = 13
AND ads.county_id = 2
OR ads.county_id = 5
OR ads.county_id = 7
OR ads.county_id = 9 
```

我从查询中得到了非常奇怪的结果，我认为这是因为第一个 OR 否定了在它之前找到的 AND 运算符。

这会为所有类型的广告返回结果，而不仅仅是类型 13。

每次调用查询时，可能需要查找不同数量的县实体。

任何有关正确方法的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：148
> 
> 时间：2008-11-04T12:49:18.127

在“OR”周围加上括号：

```
SELECT ads.*, location.county 
FROM ads
LEFT JOIN location ON location.county = ads.county_id
WHERE ads.published = 1 
AND ads.type = 13
AND
(
    ads.county_id = 2
    OR ads.county_id = 5
    OR ads.county_id = 7
    OR ads.county_id = 9
) 
```

或者更好的是，使用 IN：

```
SELECT ads.*, location.county 
FROM ads
LEFT JOIN location ON location.county = ads.county_id
WHERE ads.published = 1 
AND ads.type = 13
AND ads.county_id IN (2, 5, 7, 9) 
```

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2008-11-04T12:50:43.163

您可以尝试在 OR 表达式周围使用括号来确保正确解释您的查询，或者更简洁地使用 IN：

```
SELECT ads.*, location.county 
FROM ads
LEFT JOIN location ON location.county = ads.county_id
WHERE ads.published = 1 
AND ads.type = 13
AND ads.county_id IN (2,5,7,9) 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2008-11-04T12:51:59.260

使用 IN 更简单：

```
SELECT ads.*, location.county 
  FROM ads
  LEFT JOIN location ON location.county = ads.county_id
  WHERE ads.published = 1 
        AND ads.type = 13
        AND ads.county_id IN (2,5,7,9) 
```

# c# - 使用 .NET 生成 kerberos 票证

> ID：261785
> 
> 赞同：2
> 
> 时间：2008-11-04T12:48:14.290
> 
> 标签：c#, .net, authentication, kerberos

我想使用 .NET 生成一个 Kerberos 票证，并通过网页上的登录表单提供身份验证凭据（这将在 sql db 中对用户进行身份验证），然后使用此票证将用户身份验证为跨几个其他人的单点登录网络应用程序。

这可能吗？我已经查看了 WSE，它似乎假设您在使用它进行身份验证之前已经有一个授予的 kerberos 票证可以使用。

我们有一个 MIT kerberos 服务器来签发票证。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-20T16:14:42.620

事实证明，您无法使用 Web 应用程序生成 kerberos 票证，因为这需要您的 Web 服务器获得对客户端本地文件系统的访问权才能颁发令牌。

您只能通过客户端上运行的应用程序（或登录到 Windows 域）简单地从客户端请求现有令牌，该客户端已从 krb 服务器发出令牌。

我们最终使用 Web 服务编写了自定义令牌服务

# deployment - ClickOnce - 覆盖内容文件

> ID：261789
> 
> 赞同：0
> 
> 时间：2008-11-04T12:49:22.557
> 
> 标签：deployment, assemblies, clickonce, overwrite

我有一个使用 ClickOnce 部署的解决方案。

它由一个应用程序、几个引用的程序集和一个 SQL Server Compact 数据库组成。

还有一个程序集不被主应用程序引用，而只是在运行时加载。该程序集需要与应用程序一起部署在与应用程序二进制文件相同的目录中。

我设置 Visual Studio 以在编译后将“插件”程序集复制到 UI 项目的 \bin\debug（或 \bin\release）目录。

然后我将该文件添加到 UI 项目中，而不是作为参考，而只是作为文件。我将构建操作设置为“内容”，这样它就会显示在 UI 项目的“属性/发布”对话框中。

当我第一次发布应用程序时，它就像一个魅力。但是后来我更新了插件程序集，甚至给了它一个不同的版本号并再次发布，结果发现程序集没有更新，但是第一个上传的仍然在使用。（即使在没有事先安装的干净计算机上）。

我进行了一些挖掘，发现程序集（LibComposites.dll）被复制到clickonce应用程序存储其二进制文件的目录作为它们存储数据文件的目录。

在这两种情况下，第一个发布的版本。

总而言之，我有一个引用一些程序集的应用程序：

> Control.exe 引用 --> LibLLC.dll、LibDataLayer.dll、LibLLCExtenders.dll
> 在运行时加载 --> LibComposites.dll（也引用 LibLLC.dll）

我需要将新版本的 LibComposites.dll 部署到与每个发布的应用程序相同的目录中。

为什么该程序集的第一个发布版本仍在使用

如何强制 LibComposites.dll 被每次发布覆盖？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-04T12:56:56.177

好吧，我有同样的问题。这是我解决它的方法（可能不是理想的，但它有效。

1）如果您的 dll 或文件在解决方案中，我会将其取下并重新添加。2）进入项目的属性并选择发布和应用程序文件。您需要将文件放在那里并再次选择“包含”（不是自动...）。

比您可以使用新的发布。我不知道如果我不这样做它为什么不起作用但是每次发布，我必须执行这些步骤才能获得最新版本......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-04T12:57:20.340

让我说得对：您正在使用 Visual Studio 的发布功能来创建和部署 ClickOnce 包？

祝你好运。

[使用 Mage 构建自己的 ClickOnce 包](http://msdn.microsoft.com/en-us/library/xc3tc5xx.aspx)可能会更好。

我开始走 Visual Studio 路线，很快发现这是一条通往痛苦的道路。了解如何使用 Mage，然后查看一些 MSBuild 选项以“自动化”这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-08-10T21:57:11.957

我遇到过同样的问题。问题是我在应用程序的根目录中有dll，它们在项目中。

解决方案很简单，只需从项目中排除 dll 文件，此问题就会消失。

# java - 更改 java 版本

> ID：261793
> 
> 赞同：7
> 
> 时间：2008-11-04T12:51:35.970
> 
> 标签：java, jvm, version, compatibility, versions

我有一个在 java 1.3 上运行的服务器 - 客户端应用程序；我想逐步更改为 java 1.6，这意味着最初的几个客户端，而不是其余的客户端，最后是服务器......我想知道你能否指导我解决一些可能出现的常见问题以及我应该注意什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-04T13:02:11.843

Sun 试图保持高水平的向后兼容性，因此您可以简单地安装新的 JVM 并使用它重新启动您的应用程序。

描述 Java 1.6 与早期版本的向后不兼容性的文档在[这里](http://java.sun.com/javase/6/webnotes/compatibility.html)。该文档也链接了[Java 1.5](http://java.sun.com/j2se/1.5.0/compatibility.html)和[Java 1.4](http://java.sun.com/javase/compatibility_j2se1.4.html)的兼容性文档。您可能想阅读本文档以了解可能的陷阱。

Java 1.5 和[Java 1.6](https://jdk.dev.java.net/verifier.html)引入了新的类文件格式。JVM 也会运行旧的类文件，但是重新编译你的代码——尤其是 JDK 1.6——将帮助新的 JVM 利用一些变化来使你的应用程序更快。所以你可能会考虑重新编译。

此外，还引入了一些新的关键字，即 assert（在 1.4 中）和 enum（在 1.5 中）（正如 Yuval 已经提到的）。如果您使用这些词作为标识符，重新编译将失败，但旧的类文件将起作用。您可以提供`-source`到 javac 的开关以使其编译：' `javac -source 1.3`' 将编译没有*assert*和*enum*作为关键字的代码。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-04T12:55:54.197

在我的脑海中，寻找名称`enum`以及`assert`字段和局部变量......这些词已成为java 1.4和5中的关键字。java 6编译器如果看到它们会将它们标记为编译错误。

尤瓦尔=8-)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-04T13:48:08.587

Sun 保留了随 Java 的每个新版本引入的不兼容问题的列表。

*   [Java SE 6 发行说明：兼容性](http://java.sun.com/javase/6/webnotes/compatibility.html)
*   [J2SE 5.0 中的不兼容性（自 1.4.2 起）](http://java.sun.com/j2se/1.5.0/compatibility.html)
*   [Java 2 Platform，Standard Edition 版本 1.4.2 与先前版本的兼容性](http://java.sun.com/j2se/1.4.2/compatibility.html)

1.4.2 的最后一个文档包含指向 JDK 1.0 的兼容性说明的链接。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-18T11:18:35.523

一般来说，Sun 的 JVM 的向后兼容性非常好，但并不完美。我已经看到三个非常大的应用程序从 1.3 迁移到 1.5，并且只遇到了少量问题，其中最大的一个是一个 Swing 掩码进入了一个无限的事件处理循环并在 1.4 下冻结了应用程序

服务器部分不太可能引起问题，但在 Swing 中发生了相当大的内部变化，尤其是在 1.3 和 1.4 之间——例如，焦点子系统被完全重写。

该应用程序仍有可能毫无问题地运行，但您绝对应该进行广泛的测试。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-04T13:20:40.717

当我在我工作的一个小程序上从 1.4.2 迁移到 1.5 时，很多事情都崩溃了：屏幕刷新变得很不稳定，元素移动等等。

Sun 的 JRE 并不保持对*所有内容*的向后兼容性。有时，当项目被弃用时，它们会在很短的一段时间后完全消失。

我们用“普通”Java 编写了所有东西，也使用了 Sun 的库。

我还看到了几个用纯 Java 编写的应用程序，它们在同一版本的 JRE 中的一个或两个平台上运行良好，但在使用该版本的其他平台上却失败了（我使用的产品现在在 Windows 上运行良好，在 Mac OS X 上运行良好，在 Linux 上不错，但在 Solaris 上失败 - 都使用相同的 JRE）。

移动版本不是一个简单的步骤，除非应用程序真的很小。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-04T13:48:54.123

我的经验是兼容性很高。我只发现了一个无法在当前版本上运行的应用程序。无论出于何种原因（没有源代码，所以我没有深入研究它），一个应用程序不会在 1.4.2 以外的任何东西上运行。我曾经处理过的所有其他事情（其中一些相当大）都达到了 1.6 就好了。无需修改。

当然是YMMV，所以你必须尝试一下，看看......

# c# - 如何在安装项目中使用 IlMerge？

> ID：261801
> 
> 赞同：3
> 
> 时间：2008-11-04T12:54:52.420
> 
> 标签：c#, installation, ilmerge

我使用 IlMerge 将我项目的所有 dll 合并到一个 exe 中。我使用了一个在主 csproj 的“导入”中引用的目标文件。

目标中的 ExecCommand 是：

```
 <Exec Command="&quot;$(ProgramFiles)\Microsoft\Ilmerge\Ilmerge.exe&quot; /out:@(MainAssembly) &quot;@(IntermediateAssembly)&quot; @(IlmergeAssemblies->'&quot;%(FullPath)&quot;', ' ')" /> 
```

这行得通。

但是后来我有一个安装项目，当它构建时，它会忽略“导入”并且它不会合并 dll。如何在安装项目中使用目标文件？

我曾尝试在主项目的构建后事件（在项目的属性中）中为 Ilmerge 编写相同的代码，但它给了我错误代码 1。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-05T20:59:00.320

我建议您查看[MSBuild 社区任务中的 ILMerge 任务](http://msbuildtasks.tigris.org/)。ILMerge 任务的文档包含在[下载](http://msbuildtasks.tigris.org/servlets/ProjectDocumentList)中。它将消除您现在所做的指定确切命令行参数的复杂性。

在您的特定问题上，除了错误代码 1 之外，您是否收到任何其他错误消息？发表评论，我会尽我所能编辑我的回复。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-07T12:45:47.090

我的解决方案是这样的：我将 Ilmerge 目标文件的导入放在 csproj 中，它是这样的：

```
<Project 
 DefaultTargets="Build" 
 xmlns="http://schemas.microsoft.com/developer/msbuild/2003">

 <Import Project="$(MSBuildBinPath)\Microsoft.CSharp.targets" />

 <Target Name="AfterBuild">
   <CreateItem Include="@(ReferencePath)" Condition="'%(CopyLocal)'=='true'">
       <Output TaskParameter="Include" ItemName="IlmergeAssemblies"/>
   </CreateItem>

   <Message Text="MERGING: @(IlmergeAssemblies->'%(Filename)')" Importance="High" /> 

  <Exec Command="&quot;$(ProgramFiles)\Microsoft\Ilmerge\Ilmerge.exe&quot; /out:@(MainAssembly) &quot;@(IntermediateAssembly)&quot; @(IlmergeAssemblies->'&quot;%(FullPath)&quot;', ' ') /log:ILMerge.log" /> 

 </Target>

 <Target Name="_CopyFilesMarkedCopyLocal"/>

</Project> 
```

然后在安装项目中，我不将我的 exe 作为主要输出包含在内，而是将其包含为一个文件，以及它的本地化资源和内容。

This works I think, but it is a pity that i couldn't execute the postbuild event of my application (the ilmerge process) before packing it into the setup exe.

# iis - 是否可以将所有流量转发到一个 IP 地址？

> ID：261807
> 
> 赞同：2
> 
> 时间：2008-11-04T12:58:01.870
> 
> 标签：iis, networking, routing, windows-server-2003

我们有一个旧的和垂死的专用服务器。我们希望在新的数据中心有一个新的。我们有一堆使用当前服务器的站点，并且无法控制它们的所有 DNS。有没有一种简单的方法可以在不更新 DNS 记录的情况下将所有流量从 xx.xx.xx.xx 重定向到 zz.zz.zz.zz？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-04T13:42:13.213

从`IIS`标签来看，我假设您正在更换网络服务器。如果是这种情况，请查看 HTTP 重定向。一个例子在这里： http: [//www.somacon.com/p145.php](http://www.somacon.com/p145.php)

这具有“告诉”您的客户您的页面已永久移动的优势。

如果您不使用 HTTP，Corey 的`iptables`解决方案是合适的。它可以静默转发数据：

```
iptables -t nat -I PREROUTING -p tcp -d $OLD_DEST_IP --dport $DEST_PORT -j DNAT --to $NEW_IP 
```

转换：在`nat`（网络地址转换）表中，在链中插入一条规则，将`PREROUTING`TCP 流量操作到旧地址：端口和 DNAT（更改目标）到新地址的相同端口。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-04T13:13:57.827

在旧的和垂死的服务器上运行软件，将流量转发到新的服务器。也就是说，通过“iptables”之类的软件，把它变成防火墙。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-04T13:16:10.303

另一个快速的途径是：

*   将数据迁移到新服务器
*   停止旧服务器
*   将新服务器的IP地址更改为旧服务器
*   重新开始

整个服务不应该离线超过几分钟

**但是，编辑**更新 DNS 肯定会更快；我想你控制着这个服务器的权威条目？将生存时间更改为一个低得离谱的数字（比如一个小时），更新条目，让它“自然”滚动

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-04T13:34:56.210

如果您要控制旧 IP 地址，您可以使用 404 处理程序将页面重定向到新服务器，这很丑陋，但应该可以......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-04T16:06:33.797

哇。在很短的时间内有很多答案。这个年轻的社区令人难以置信。

是的，我们正在更换网络服务器，并可能更换托管服务提供商（因此无法用新 IP 上的新服务器替换当前服务器）。

我们为许多可以使用自己的域名的客户托管自定义 Web 应用程序。虽然我们将指示他们更新他们的 DNS 记录，但无法保证他们何时（或是否）会更新，因此我们需要一个临时解决方案，直到我们可以确保他们会这样做。

有谁知道使用类似 IPTABLES 的性能损失，注意到 2 个服务器将在物理上不同的位置？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-11-07T20:56:52.873

我解决这个问题的方法是使用一个名为 ddproxy 的程序并将所有流量转发到端口 80 到另一个 IP

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-11-04T13:14:31.913

最简洁的答案是不。您是否认为如果可以将所有流量从 重定向 `208.69.34.231`到`87.248.113.14`，那么现在就不会完成了吗？

您可以使用一些软件工具通过`xx.xx.xx.xx`to `zz.zz.zz.zz`（隧道或桥接）在某些端口上中继流量，但是

1.  您仍然需要在`xx.xx.xx.xx`
2.  数据必须传输`client->xx.xx.xx.xx.->zz.zz.zz.zz`或`zz.zz.zz.zz->xx.xx.xx.xx->client`，因此如果 xx 和 zz 之间的链接很慢，或者 xx 处的设备很慢，则数据可能会很慢。

# c# - 可以为接口引用定义 == 的行为吗？

> ID：261809
> 
> 赞同：3
> 
> 时间：2008-11-04T12:59:24.970
> 
> 标签：c#, interface, equals, equals-operator

如果接口继承了 IEquatable，则实现类可以定义 Equals 方法的行为。是否可以定义 == 操作的行为？

```
public interface IFoo : IEquatable  
{}  

public class Foo : IFoo  
{  
    // IEquatable.Equals  
    public bool Equals(IFoo other)  
    {  
        // Compare by value here...
    }  
} 
```

通过比较它们的值来检查两个 IFoo 引用是否相等：

```
IFoo X = new Foo();  
IFoo Y = new Foo();

if (X.Equals(Y))  
{  
     // Do something  
} 
```

是否可以`if (X == Y)`在 Foo 上使用 Equals 方法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-04T13:01:12.237

不 - 您不能在接口中指定运算符（主要是因为运算符是静态的）。编译器完全根据静态类型（即不涉及多态性）确定要调用的 == 的哪个重载，并且接口无法指定代码来表示“返回调用 X.Equals(Y) 的结果”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-04T13:10:38.647

不，因为接口不能包含操作符函数。一种解决方案是使 IFoo 成为抽象类而不是接口：

```
abstract class IFoo : IEquatable<IFoo> 
{
    public static bool operator ==(IFoo i1, IFoo i2) { return i1.Equals(i2); }
    public static bool operator !=(IFoo i1, IFoo i2) { return !i1.Equals(i2); }
    public abstract bool Equals(IFoo other);
}

class Foo : IFoo
{
    public override bool Equals(IFoo other)
    {
        // Compare
    }
} 
```

当然，这会让你失去接口提供的灵活性。

# sql - 如何修复 DTS 包编辑器试图读取或写入受保护的内存？

> ID：261811
> 
> 赞同：1
> 
> 时间：2008-11-04T12:59:49.307
> 
> 标签：sql, windows-vista, ssis

我正在尝试将一些 DTS 包从 SQL Server 2000 迁移到 2008 以查看涉及的痛苦程度。我的本地计算机上安装了标准版 SQL Server 2008。

[我按照建议从msdn](http://support.microsoft.com/kb/905417)下载了 Microsoft SQL Server 2000 DTS Designer Components 和 Microsoft SQL Server 2005 Backward Compatibility Components ，并按照[此处](http://msdn.microsoft.com/en-us/library/ms143755.aspx)的建议复制了所需的 dll 。

我将一个 DTS 包转换为 .dtsx 文件，并看到转换任务已转换为嵌入在 SSIS 包中的迷你 DTS 包。

问题是，当我尝试编辑它们时，如果有帮助，我会根据详细信息在 DTS.CDTSLegacyDesignerClass.ShowDesigner() 处收到“尝试读取或写入受保护的内存...”错误。

“Load DTS200 Package Internally”按钮也是灰色的。

我正在使用 Windows Vista Professional - 我怀疑这可能是我陷入困境的原因！

如果有人遇到过这个问题并解决了，请帮忙！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-05T11:51:52.267

An update to this... the problem was definitely because of my Vista machine, though I dont know what exactly. Security permissions issue of some sort.

I followed the same steps on my XP machine and it has worked perfectly - I can open the packages and make changes inside them.

# sql - SQL Server 中自增主键的上限

> ID：261815
> 
> 赞同：36
> 
> 时间：2008-11-04T13:02:51.047
> 
> 标签：sql, sql-server, auto-increment

SQL Server 中自动增量主键的上限是多少？当 SQL Server 自动增量主键达到其上限时会发生什么？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2008-11-04T13:20:53.867

Joel 的回答是正确的，它是您使用的任何数据类型的上限。

这是其中两个的示例：

*   整数：2^31-1 (2,147,483,647)
*   大整数：2^63-1 (9,223,372,036,854,775,807)

我实际上已经达到了我工作的极限。实际错误是：

```
    消息 8115，第 16 级，状态 1，第 1 行
    将 IDENTITY 转换为数据类型 int 的算术溢出错误。
    发生算术溢出。

```

我可以想到一些解决方法。数字 1 可能非常困难且不太可能，数字 2 很容易，但可能会导致代码库出现问题。

1.  如果标识列对您无关紧要（它不是外键等），那么您可以重新设置数据库并重置标识列。
2.  将您的身份列更改为更大的数字。因此，例如，如果您溢出了一个 int，请将您的标识列更改为一个大 int。祝你好运：）

可能还有其他修复，但没有灵丹妙药。我只是希望这不会发生在作为一堆关系中心的表格中，因为如果发生这种情况，您将遭受很多痛苦。这不是一个很难解决的问题，只是一个乏味而漫长的问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-04T13:04:40.420

这取决于数据类型。如果您使用 bigint，则不太可能溢出。即使是普通的 int 也会给你几十亿行。我从来没有溢出，所以我不能告诉你如果你这样做会发生什么。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-24T21:06:33.320

我会告诉你会发生什么......我的数据停止插入到那个特定的表中。数据库仍然有效，但我发现数据丢失且不一致。经过一番研究，我找到了错误表，然后运行了手动插入。错误与上述相同。

不得不将列更改为 BIGINT。在稍慢的服务器上的 26GB 数据库上，大约需要 30 分钟。在数据库的存档版本（150GB 左右）上花费了相当长的时间。

幸运的是，这张桌子没有太多的关系，所以痛苦很轻微。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-21T21:02:18.900

DBCC CHECKIDENT (SomeTable, RESEED, 1)

这会将表“SomeTable”上的标识重置为 1

不确定这是否是最好的方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-04T13:11:09.097

数据类型说明：

```
BIGINT    Integer data from -2^63 through 2^63 - 1

INT       Integer data from -2^31 through 2^31 - 1

SMALLINT  Integer data from -2^15 through 2^15 - 1

TINYINT   Integer data from 0     through 255 
```

当您达到上限时，自动增量会达到下限。

# asp.net - ASP.NET Ajax 框架

> ID：261825
> 
> 赞同：0
> 
> 时间：2008-11-04T13:06:19.963
> 
> 标签：asp.net, ajax

除了使用 UpdatePanel & Friends 或 ASP.NET AjaxControlToolkit 之外，还有 ASP.NET AJAX 框架吗？

目前我正在使用普通的 ICallbackEventHandler 调用，但由于需要完成大量序列化，它会变得相当复杂。

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-04T13:22:56.593

[下面](http://ajaxpatterns.org/DotNet_Ajax_Frameworks)是与 ASP.NET 一起使用的不同 AJAX 框架的列表。

我们还将[原型](http://www.prototypejs.org/)用于较小的任务。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-04T13:29:19.683

经过反复试验，我发现（对我而言）在 ASP.NET Web 表单应用程序中处理 Ajax 的最佳方式。

*   用于所有 AJAX 调用的 ASP.NET AJAX 脚本服务。返回复杂类型的 JSON
*   用于 GUI 和效果的 jQuery。

效果很好，我完全控制了输出。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-04T13:15:54.580

[Telerik](http://www.telerik.com)有一个很好的 AJAX 控件库。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-04T13:22:52.067

新的 ASP.NET MVC 框架（测试版）？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-04T14:33:04.050

Infragistics 很受欢迎，但当您实际必须调试问题时会变得不稳定。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-20T08:43:23.820

有*大量*用于 ASP.NET 的 Ajax 框架。他们之中有一些是; [Anthem.NET](http://anthem-dot-net.sourceforge.net/)、[Ra-Ajax](http://ra-ajax.org)（我的项目）、[Gaia Ajax](http://gaiaware.net)、[AjaxPro.NET](http://www.ajaxpro.info/)以及可能还有数百个其他的。我个人最喜欢的（无耻的插件）显然是 Ra-Ajax，因为这就是我正在使用的。（创始人）

查看[Ajax Calendar Starter-Kit](http://ra-ajax.org/samples/Viewport-Calendar-Starter-Kit.aspx)以了解其功能...

# c++ - 构建相同 C/C++ 应用程序变体的最佳方法是什么

> ID：261829
> 
> 赞同：6
> 
> 时间：2008-11-04T13:08:29.587
> 
> 标签：c++, c-preprocessor, configuration-management, software-product-lines

我有三个密切相关的应用程序，它们是从相同的源代码构建的——比如说 APP_A、APP_B 和 APP_C。APP_C 是 APP_B 的超集，而 APP_B 又是 APP_A 的超集。

到目前为止，我一直在使用预处理器定义来指定正在构建的应用程序，它的工作原理是这样的。

```
// File: app_defines.h
#define APP_A 0
#define APP_B 1
#define APP_C 2 
```

然后我的 IDE 构建选项指定（例如）

```
#define APPLICATION APP_B 
```

...在源代码中，我会有类似的东西

```
#include "app_defines.h"

#if APPLICATION >= APP_B
// extra features for APPB and APP_C
#endif 
```

但是，今天早上我开枪打死了自己，只是从一个文件中省略了 #include "app_defines.h" 行，这浪费了很多时间。一切编译正常，但应用程序在启动时与 AV 一起崩溃。

我想知道处理这个问题的更好方法是什么。以前，这通常是我认为可以使用#define 的少数几次之一（无论如何，在 C++ 中），但我仍然搞砸了，编译器没有保护我。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-04T14:20:49.767

您不必总是在共享公共代码库的应用程序中强制继承关系。真的。

有一个古老的 UNIX 技巧，您可以根据 argv[0]（即应用程序名称）来定制应用程序的行为。如果我没记错的话（我看过它已经 20 年了），rsh 和 rlogin 是/是同一个命令。您只需根据 argv[0] 的值进行运行时配置。

如果您想坚持构建配置，这是通常使用的模式。您的构建系统/makefile 在命令上定义了一个符号，例如 APP_CONFIG 是一个非零值，那么您就有一个带有配置螺母和螺栓的通用包含文件。

```
#define APP_A 1
#define APP_B 2

#ifndef APP_CONFIG
#error "APP_CONFIG needs to be set
#endif

#if APP_CONFIG == APP_A
#define APP_CONFIG_DEFINED
// other defines
#endif

#if APP_CONFIG == APP_B
#define APP_CONFIG_DEFINED
// other defines
#endif

#ifndef APP_CONFIG_DEFINED
#error "Undefined configuration"
#endif 
```

此模式强制配置是命令行定义的并且是有效的。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-04T13:27:51.043

您正在尝试做的似乎与“产品线”非常相似。Carnigie Melon 大学在此模式上有一个很好的页面：[http ://www.sei.cmu.edu/productlines/](http://www.sei.cmu.edu/productlines/)

这基本上是一种构建具有不同功能的软件的不同版本的方法。如果您想像 Quicken Home/Pro/Business 之类的东西，那么您就走上了正轨。

虽然这可能不是您所尝试的，但这些技术应该会有所帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-04T22:19:11.893

在我看来，您可能会考虑将代码模块化为单独编译的元素，从公共模块的选择和特定于变体的顶级（主）模块中构建变体。

然后控制哪些部分进入构建，哪些头文件用于编译顶层，哪些 .obj 文件包含在链接器阶段。

一开始你可能会觉得这有点困难。从长远来看，您应该有一个更可靠和可验证的构建和维护过程。您还应该能够进行更好的测试，而不必担心所有 #if 变化。

我希望您的应用程序还不是非常大，并且解开其功能的模块化不必处理一大堆泥巴。

在某些时候，您可能需要运行时检查以验证构建使用的组件是否与您想要的应用程序配置一致，但这可以稍后解决。您还可以实现一些编译时一致性检查，但您将通过头文件和进入特定组合的从属模块的入口点签名获得大部分检查。

无论您是使用 C++ 类还是在 C/C++ 公共语言级别上进行操作，这都是相同的游戏。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-04T13:50:44.633

做这样的事情：

```
 CommonApp   +-----   AppExtender                        + = containment
                      ^    ^    ^
                      |    |    |                       ^ = ineritance
                    AppA  AppB  AppC                    | 
```

将您的通用代码放在 CommonApp 类中，并在战略位置调用接口“AppExtender”。例如，AppExtender 接口将具有 afterStartup、afterConfigurationRead、beforeExit、getWindowTitle 等函数...

然后在每个应用程序的 main 中，创建正确的扩展程序并将其传递给 CommonApp：

```
 --- main_a.cpp

    CommonApp application;
    AppA appA;
    application.setExtender(&appA);
    application.run();

    --- main_a.cpp

    CommonApp application;
    AppB appB;
    application.setExtender(&appB);
    application.run(); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-04T22:05:31.357

> 但是，今天早上我开枪打死了自己，只是从一个文件中省略了 #include "app_defines.h" 行，这浪费了很多时间。一切编译正常，但应用程序在启动时与 AV 一起崩溃。

这个问题有一个简单的解决方法，打开警告，这样如果 APP_B 没有定义，那么你的项目就不能编译（或者至少产生足够的警告，让你知道有问题）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-04T13:27:41.637

问题是使用带有未定义名称的#if 指令就好像它被定义为0。这可以通过始终先执行#ifdef 来避免，但这既麻烦又容易出错。

稍微好一点的方法是使用命名空间和命名空间别名。

例如

```
namespace AppA {
     // application A specific
}

namespace AppB {
    // application B specific
} 
```

并使用你 app_defines.h 来做命名空间别名

```
#if compiler_option_for_appA
     namespace Application = AppA;
#elif compiler_option_for_appB
     namespace Application = AppB;
#endif 
```

或者，如果组合更复杂，命名空间嵌套

```
namespace Application
{
  #if compiler_option_for_appA
     using namespace AppA;
  #elif compiler_option_for_appB
     using namespace AppB;
  #endif
} 
```

或以上任意组合。

优点是，当您忘记标头时，您会从编译器 iso 中得到未知的命名空间错误，因为 APPLICATION 默认为 0。

话虽如此，我也遇到过类似的情况，我选择将所有内容重构为许多库，其中绝大多数是共享代码，并让版本控制系统处理依赖定义等的不同应用程序 iso 中的内容. 在代码中。

在我看来，它的效果要好一些，但我知道这恰好是特定于应用程序的，YMMV。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-04T13:12:08.550

如果您使用 C++，您的 A、B 和 C 应用程序不应该继承自一个共同的祖先吗？那将是解决问题的OO方式。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-30T15:20:48.910

查看[Alexandrescu 的 Modern C++ Design](http://books.google.com/books?id=aJ1av7UFBPwC&dq=alexandrescu+modern+c%2B%2B+design&printsec=frontcover&source=bn&hl=en&ei=hL_5SbblKJK0Ndf4lcQE&sa=X&oi=book_result&ct=result&resnum=4)。他介绍了使用模板的基于策略的开发。基本上，这种方法是策略模式的扩展，不同之处在于所有选择都是在编译时做出的。我认为 Alexandrescu 的方法类似于使用 PIMPL 习语，但使用模板实现。

您将使用公共头文件中的预处理标志来选择要编译的实现，并将其类型定义为代码库中其他地方的所有模板实例化中使用的类型。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-30T15:04:40.570

To address the specific technical problem of not knowing when a preprocessor define is defined or not, there is a simple but effective trick.

Instead of -

```
#define APP_A 0
#define APP_B 1
#define APP_C 2 
```

Use -

```
#define APP_A() 0
#define APP_B() 1
#define APP_C() 2 
```

And in the place that queries for the version use -

```
#if APPLICATION >= APP_B()
// extra features for APPB and APP_C
#endif 
```

(potentially do something with APPLICATION as well in the same spirit).

Trying to use an undefined preprocessor **function** would produce a warning or an error by most compilers (whereas an undefined preprocessor **define** simply evaluates to 0 silently). If the header isn't included, you would immediately notice - especially if you "treat warnings as errors".

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-04T13:40:27.307

您可能希望了解支持产品线开发并以结构化方式促进显式变体管理的工具。

其中一个工具是来自[纯系统](http://www.pure-systems.com/)的 pure::variants，它能够通过特征模型进行可变性管理，并跟踪在源代码中实现特征的各个位置。

您可以从特征模型中选择特定的特征子集，检查特征之间的约束，并创建产品线的具体变体，即创建一组特定的源代码文件和定义。

# asp.net - Webforms和jQuery，如何匹配ID？

> ID：261845
> 
> 赞同：13
> 
> 时间：2008-11-04T13:13:47.937
> 
> 标签：asp.net, jquery, web-controls

我想将 jQuery 与 asp.net webfoms 一起使用。我是否需要一个特殊的工具包以便 .net 控件吐出友好的控件 ID？

原因是，我不想编写引用我的 html ID 的 javascript，例如 control_123_asdfcontrol_234。

这在 3.5 版中是否已解决？（我记得读过你必须获得一些使 ID 友好的特殊 dll）。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-12-05T00:15:39.630

我发现的最简单的方法就是匹配大多数控件的损坏 ID 的末尾。知道的例外是单选按钮列表和复选框列表 - 你必须对它们有点棘手。

但是如果你的 .aspx 页面中有这个：

```
<asp:TextBox ID="txtExample" runat="server" /> 
```

然后您的 jQuery 可以轻松找到该控件，即使它被母版页渲染破坏，如下所示：

```
$("[id$=txtExample]") 
```

运算符匹配字符串的`$=`结尾，名称 mangling 总是在前面。完成此操作后，您可以像这样获得实际损坏的 ID：

```
$("[id$=txtExample]").attr("id") 
```

然后无论如何解析你认为合适的。

编辑：这是一种简单的方法，但它可能比仅仅给每个控件一个与其旧 ID 相同的类更多地影响性能。

请参阅 Jeff 在另一个 jQuery 优化问题上发布链接的这篇文章：

**[jQuery：选择器的性能分析](http://www.componenthouse.com/article-19)**

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-11-04T13:17:13.297

您可以使用`myControlId = "<%= myControl.ClientID %>";` 输出用于在 Javascript 中引用它的（非友好）ID。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-04T13:38:16.360

有很多方法可以使用 jQuery 选择元素。您可以仔细选择标签/类名。
在 ASP.NET 4.0 之前，我不知道有什么办法可以弄乱 id 本身。当然，您总是可以尝试[ASP.NET MVC 框架。](http://www.asp.net/mvc)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-04T13:39:19.273

虽然我还没有听说过你所说的那种新的“特殊 dll”，但一种简单的方法是使用

```
var myControlId; 
```

在您单独的 js 文件中，然后将客户端 ID 分配给 aspx/ascx 中的该 var。

我也讨厌服务器 ID：s... ASP.NET MVC 是解决所有让我讨厌 asp.net 网络表单（Viewstate...等）的事情的解决方案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-04T14:38:05.113

您还可以覆盖扩展类中控件的 UniqueName 和/或 ClientID 属性并返回实际 ID。

```
MyTextBox : Web.UI.TextBox
{
    // This modifies the generated 'name' attribute
    override UniqueID { get { return ID; } }

    // This modifies the generated 'id' attribute
    override ClientID { get{ return ID; } }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-04T14:12:48.427

您可以将唯一属性附加到您的控件（我不确定您是否可以在不扩展基本 Web 控件的情况下执行此操作；快速搜索[仅显示 this](http://www.codeproject.com/KB/webforms/customhtmlattributes.aspx)），然后使用“元素 [属性：值]”选择器。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-09-04T07:38:58.873

试试`$get('myId')`。我认为这是在非 HTML 文档中选择元素的方法。

# windows - Oracle Express Edition - 无法远程连接（以及其他）

> ID：261867
> 
> 赞同：7
> 
> 时间：2008-11-04T13:20:43.413
> 
> 标签：windows, oracle-xe

我无法远程连接到 Oracle XE 安装（通过 TOAD/SQL Developer）。这是交易。

我设置了一个新服务器（Windows 2003）。目标是制作一个预装了多个应用程序的新映像，Oracle XE 就是其中之一。安装 Oracle 没有问题，本地连接，远程连接并可以访问 Web 界面 - 在[http://127.0.0.1:8081/apex](http://127.0.0.1:8081/apex)找到的那个（注意：我在运行时手动更改了 Web 界面的端口8080 上的 Tomcat 开发环境）。

所以，一切都很顺利，我创建了图像，擦拭机器并将新创建的图像放在那里。除 Oracle 外，一切正常。经过一番挖掘，我更新了 tnsnames.ora 文件，添加了环境变量 ORACLE_HOME 和 ORACLE_SID，这样我就可以本地连接了。 **我仍然无法远程连接并且完全无法访问 Web 界面。我在谷歌上呆了 2 天，我完全没有想法。请帮忙！**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-04T22:11:00.707

ManuelF 与通过 Web 前端的访问有关，但与通过 Web 前端的本地访问无关。

您没有说明如何处理主机名/地址，或者您如何在本地连接。如果您正在这样做， `SQLPLUS / AS SYSDBA`那么您将直接附加。如果您正在这样做，`SQLPLUS user/pass@XE`那么您将通过侦听器进行附加。如果前者有效而后者无效，请查找名为 listener.ora 的文件并检查其中的主机名。如果仍有问题，请尝试

```
sqlplus user/pass@127.0.0.1:1521/XE 
```

如果可行，那么问题出在 tnsnames.ora 上。

在远程访问中，如果您的映像安装在“box a”上，并且您想从“box b”访问，您可以从“box b”ping 'box a'。然后尝试，在 box_b

```
sqlplus user/pass@box_a:1521/XE 
```

这假设您在 box_b 上有一个带有 sql*plus 的 Oracle 客户端。如果可行，您需要查看 box_b 上的 tnsnames.ora 文件。如果您在 box_b 上没有 Oracle 客户端，Oracle 的 SQL Developer 可以通过 JDBC 瘦驱动程序（不需要任何 Oracle 客户端）进行连接，为此您需要指定主机、侦听器端口（通常为 1521 ) 和 sid (速成版的 XE)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-04T21:26:12.700

Did you check if you have open port 1521 on firewall?

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-04T21:31:42.720

From the Web Interface, you have to login as a DBA [I think], and there is an option in the administration section where you have to activate "Enable connections from outside".

EDIT: Full Path : WebInterface -> Administration -> [drop down menu] Manage HTTP Access -> Available from local server and remote clients.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-10-21T16:26:55.313

只需以 sysdba 或系统用户身份登录 sqlplus，然后执行以下命令：

```
execute dbms_xdb.setListenerLocalAccess(l_access => FALSE); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-10-31T18:44:34.860

我发现远程连接无法连接到我的 Ubuntu 机器，因为我错误地配置了`/etc/hosts`文件。这台机器在 中设置了静态 IP `/etc/interfaces`，但 hosts 中的条目有错误的 IP 地址：

```
127.0.0.1       localhost
127.0.1.1       fqdn.domain.com        myhost
sta.tic.ip.address        fqdn.domain.com        myhost 
```

最后一行的 IP 错误。

结果，running`lnsrctl status`没有列出XE服务。更正主机文件后，我重新启动了 oracle-xe 服务，远程连接开始工作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-12-11T15:20:42.213

我对使用防火墙运行的 Windows 8.1 有类似的问题。我已经安装了 Oracle XE 11g 并安装了 Oracle Application express 5.0.2。一切都在本地主机/机器上按预期工作。唯一的问题是无法从 LAN 内的远程机器登录到 oracle application express。

经过一番研究，通过将 TNSLSNR 可执行文件添加到 Windows 防火墙设置解决了这个问题，如下所示。

系统和安全 --> Windows 防火墙 --> 允许的应用

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-03-15T13:03:43.283

确保在您的机器中启用了远程连接。在本地计算机上[`http://localhost:8080/apex/`](http://127.0.0.1:8080/apex)以 SYSTEM 用户身份连接，然后转到*管理*并从右侧面板中选择*管理 HTTP 访问*，然后在以下窗口中选择

> 可从本地服务器和远程客户端使用

所以按应用更改。

在我的机器中，我必须重新启动才能获得结果。

# c# - C# HttpRequest 和不同的编码

> ID：261873
> 
> 赞同：3
> 
> 时间：2008-11-04T13:22:06.360
> 
> 标签：c#, asp.net, httprequest

这是我的问题。我在 ASP.NET / C# 中有一个网站，它通过 GET/POST 接收一些数据

这是“用户填写”的数据，但不是通过网页，它是一个与我的服务器联系的软件。

问题是，该软件正在发送以 ISO-8859-1 编码的数据（因此 Café 将作为 Caf%e9 发送），而我的 SW/DB 的其余部分是 Unicode

数据也被完全破坏，无法恢复已发送的内容：/

处理这个问题的最佳方法是什么？

我尝试设置 Request.ContentEncoding （阅读前），但无济于事。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-07-26T07:56:51.397

这里唯一可行的是将以下代码添加到 web.config：

```
<configuration>
  <system.web>
    <globalization requestEncoding="iso-8859-1"/>
  </system.web>
</configuration> 
```

然后使用

```
Request["varName"] 
```

不要使用`HttpUtility.UrlDecode`or `HttpUtility.UrlEncode`，这两个仅适用于原始查询字符串。Request[] 已经为您完成了解码。

感谢 JamesP 自己发布这个想法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-04T14:31:58.730

%e9 只是 é 但 UrlEncoded。Server.UrlDecode 您的请求字符串。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-05T09:11:03.543

看着

[如何：为 ASP.NET 网页全球化选择编码](http://msdn.microsoft.com/en-us/library/39d1w2xf.aspx)

短的：

在 web.config 中写入

```
<configuration>
  <system.web>
    <globalization
      fileEncoding="utf-8"
      requestEncoding="utf-8"
      responseEncoding="utf-8"
      culture="en-US"
      uiCulture="de-DE"
    />
  </system.web>
</configuration> 
```

删除 aspx 标头中的编码条目。

如果 utf-8 不正确，请尝试 utf-16

我希望这有帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-10T12:36:51.817

问题的原始作者在这里。

对我有帮助的是 Georg 关于设置 Web.config 变量的建议，我把

requestEncoding="iso-8859-1"

现在一切正常，谢谢！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-06T08:15:45.727

如果我理解正确，您就是从 HTTP 请求中提取这些信息。我将假设它是编码中的 HTTP 请求正文。

您可以使用 System.Text.Encoding.GetEncoding(...) 检索 ISO-8859-1 的 Encoding 对象。然后在该编码对象上调用 GetDecoder()，并使用它来解释请求正文。理想情况下，您会根据请求中的标头值确定从 Encoding.GetEncoding(...) 加载的编码类型，因此支持具有不同配置的服务器。

# java - 分组 javadoc 方法

> ID：261876
> 
> 赞同：10
> 
> 时间：2008-11-04T13:22:58.527
> 
> 标签：java, javadoc

我想为我的班级分组 javadoc 中的方法。例如：

```
管理方法：
   废话1
   废话2
存取方法：
   foo1
   foo2

```

你知道我可以在javadoc中实现这个吗？是否有任何 doclet 可用于执行此操作？

谢谢，卡鲁姆

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-04T13:58:26.240

您可能需要创建一个[自定义 doclet](http://java.sun.com/j2se/1.4.2/docs/tooldocs/windows/javadoc.html#doclets)以根据您的特定需求生成 HTML。

# java - 如何通过 BlueCoat 代理连接 Java 应用程序？

> ID：261883
> 
> 赞同：1
> 
> 时间：2008-11-04T13:24:55.433
> 
> 标签：java, proxy

我正在尝试通过 BlueCoat 代理连接 Java 应用程序，我得到的 HTTP 状态为 407，并显示“缺少凭据”的消息...

有没有人有一些 Java 代码来通过这种代理读取 HTML 页面，使用集成的安全性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-04T13:44:16.987

我认为内置的 Java http 连接类不支持代理。改用 Apache HttpClient：[http](http://hc.apache.org/httpclient-3.x) ://hc.apache.org/httpclient-3.x 。

# java - 如何从 Java 应用程序禁用 SQL Server jdbc 驱动程序日志记录？

> ID：261886
> 
> 赞同：0
> 
> 时间：2008-11-04T13:25:38.070
> 
> 标签：java, sql-server, logging, jdbc

当我将应用程序日志级别更改为 FINE 时，SQL Server 日志也​​会使用它，因此，我会收到很多不必要的日志消息。如何关闭 SQL Server 日志消息？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-04T13:30:33.567

在启动 jdbc 连接之前，更改属性的 de 值：

```
Logger logger = Logger.getLogger("com.microsoft.sqlserver.jdbc");
logger.setLevel(Level.OFF); 
```

我最终使用了警告

其他状态为：严重、警告、信息、配置、精细、精细、最佳、关闭和所有

更多信息请访问：http: [//msdn.microsoft.com/en-us/library/ms378517 (SQL.90).aspx](http://msdn.microsoft.com/en-us/library/ms378517(SQL.90).aspx)

# java - Foosball result prediction

> ID：261888
> 
> 赞同：5
> 
> 时间：2008-11-04T13:26:32.780
> 
> 标签：java, mysql, prediction

In our office, we regularly enjoy some rounds of foosball / table football after work. I have put together a small java program that generates random 2vs2 lineups from the available players and stores the match results in a database afterwards.

The current prediction of the outcome uses a simple average of all previous match results from the 4 involved players. This gives a very rough estimation, but I'd like to replace it with something more sophisticated, taking into account things like:

*   players may be good playing as attacker but bad as defender (or vice versa)
*   players do well against a specific opponent / bad against others
*   some teams work well together, others don't
*   skills change over time

What would be the best algorithm to predict the game outcome as accurately as possible?

Someone suggested using a neural network for this, which sounds quite interesting... but I do not have enough knowledge on the topic to say if that could work, and I also suspect it might take too many games to be reasonably trained.

EDIT:
Had to take a longer break from this due to some project deadlines. To make the question more specific:

Given the following mysql table containing all matches played so far:

```
table match_result

match_id      int pk
match_start   datetime
duration      int (match length in seconds)
blue_defense  int fk to table player
blue_attack   int fk to table player
red_defense   int fk to table player
red_attack    int fk to table player
score_blue    int
score_red     int 
```

How would you write a function predictResult(blueDef, blueAtk, redDef, redAtk) {...}
to estimate the outcome as closely as possible, executing any sql, doing calculations or using external libraries?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2010-03-24T02:45:05.720

Use the TrueSkill algorithm, it is very good at this. I've implemented it for foosball and chess and it works very well. Coworkers have told me that it's almost *too* good at this.

For complete details on how it works as well as a link to my implementation, see my "[Computing Your Skill](http://www.moserware.com/2010/03/computing-your-skill.html)" blog post.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-04T13:30:59.977

Why use a neuralnet? Use statistics, probably the correlation between each player would be good measure.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-04T13:34:05.323

Just to start let's gather some information: For a given player we need:

1.  the position they played
2.  the final score

A good attacker will rack up points. A good defender will prevents points from being scored.

The real info will be from a good attacker playing against a good defender.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-07T21:53:29.010

Try applying Naive Bayes classifier.

> Bayesian learning is a probabilistic approach which is based on an assumption that the quantities of interest are governed by probability distributions and that optimal decisions can be made by reasoning about these probabilities together with observed data. [Mitchell, T. (1997), Machine Learning]

The same exact distribution of the players may result in different match results. If your data has a pattern in it, a pattern based on your variables, Naive Bayes classifier may produce good results.

The algorithm is not very complex. I think, one with some knowledge in probability, can understand & apply it.

In intrusion detection systems, it is being used for determining network anomalies, by looking at various network parameters. Bayesian approach may be very successful in particular types of data and produce high TP & low FP rates. But it may also result in high FP rates, depending on your data. Your data will determine the best approach.

You can use Weka ([http://www.cs.waikato.ac.nz/~ml/weka/](http://www.cs.waikato.ac.nz/~ml/weka/)), a data mining software library, and try different algorithms. It contains the Naive Bayes classifier. Just try and see.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-28T07:17:04.933

One option would be to try and guess the point spread as [some sort of linear model](http://en.wikipedia.org/wiki/Linear_regression). If you have more games than players you, can do a least squares fit of points per player by building a games matrix (+1 for player on one team, -1 for the other, 0 for spectator) for all the games and a result vector for the spreads.

# svn - Excel VBA SVN 客户端/集成

> ID：261902
> 
> 赞同：20
> 
> 时间：2008-11-04T13:31:03.860
> 
> 标签：svn, excel, version-control, vba, diff

任何人都可以推荐一个 SVN 客户端，以便在带有 VBA 的 Excel 中使用（仅限代码模块）。理想情况下，我还希望 SVN 在提交更改之前忽略大小写，以避免在存储库中过度流失（VBA 有一个令人讨厌的习惯，即在整个项目中更改变量的大小写）。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2010-08-01T10:09:27.213

[http://www.codeproject.com/KB/office/SourceTools.aspx](http://www.codeproject.com/KB/office/SourceTools.aspx) 可能会做你想做的事

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-04T13:57:55.697

[TortoiseSVN](http://tortoisesvn.net/)与 Windows 文件资源管理器完美集成，并允许集成外部差异工具（如[Beyond Compare](http://www.scootersoftware.com/) .

[Beyond Compare](http://www.scootersoftware.com/)有一个用于 Visual Basic 代码的特定插件，它似乎忽略了“不重要文本”的大小写，这意味着任何*不在*引号中的内容。

但是，我认为这不会解决 SVN 流失问题。我不相信 SVN 使用外部 diff 程序来确定文件在提交之前是否已更改，并且我不知道有任何方法可以覆盖此行为。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-08-26T13:15:40.930

看看以下应用程序。

[http://officesvn.codeplex.com/](http://officesvn.codeplex.com/)

[http://code.google.com/p/msofficesvn/](http://code.google.com/p/msofficesvn/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-06-30T22:43:30.923

哇，我对 Excel VBA SVN 的搜索让我找到了一个 9 岁的线程。所以我想我会更新。

上面的 msofficesvn（移至 sourceforge/github）是我找到的最好的 svn 选项，但 2 年内没有更新，它只管理整个文档。OP 和我自己正在寻找对单个 bas 文件的控制。

我最近开始使用[Rubberduck](https://github.com/rubberduck-vba/Rubberduck)，它是一个 Excel VBA git 接口，用于管理到您的 git 存储库的复杂导出/导入。它目前受支持，虽然有点棘手，但可以工作。

我的组织不仅强制使用 Windows，它对 git 有点抵抗力，而且还在使用 SVN，但我认为没有 Excel VBA SVN 工具，所以会悄悄地坚持​​使用 Rubberduck。我希望这对其他人有帮助。

更新：由于我在 Excel VBA 上花费了更多时间，我意识到您并不绝对需要 Rubberduck。你可以只用 git for Windows 就可以了。但是，您需要自己仔细管理导出/删除/导入。这可能更可取，因为我发现如果您在非常基本的添加和提交功能之外使用 Rubberduck 做任何事情，那么您的模块会发生非常不愉快的事情。尝试签出一个新分支会让你回到最初的提交并覆盖你的所有模块。首先关闭 Excel，执行 git 操作，然后重新打开 Excel 并在 Rubberduck 中重新打开您的存储库。

如果您确实想管理自己但需要菜单和表单，可以[使用 TortiseGIT](https://tortoisegit.org/)和[TortiseSVN](https://tortoisesvn.net/)集成到 Windows 资源管理器中。

# regex - 使用 lighttpd mod_evhost (www.domain.com / domain.com / sub.domain.com) 的正则表达式匹配域

> ID：261904
> 
> 赞同：3
> 
> 时间：2008-11-04T13:32:05.217
> 
> 标签：regex, webserver, lighttpd

我正在一个小型虚拟专用服务器上使用[lighttpd 。](http://en.wikipedia.org/wiki/Lighttpd)我指向服务器的两个域。我在 Ubuntu 8.10 上使用最新版本的 lighttpd 和 mod_evhost。

1.  我正在尝试设置一个规则，这样如果有人请求**domain.com** 或**www.domain.com**他们会从*/webroot/domain.com/www/获得服务*

2.  同样，如果有人请求**sub.domain.com**，他们会从*/webroot/domain.com/sub/获得服务*

3.  如果人们请求**fake.domain.com**（其中*/webroot/domain.com/fake/*不存在），我希望他们从*/webroot/domain.com/www/提供服务*

*第三个要求不是那么重要，我可以处理请求从/webroot/server.com/www/*的服务器文档根目录提供的不存在子域的人，即使他们请求**fake.domain.com**

我在下面包含了我的 lighttpd.conf 文件的相关部分：

```
server.document-root = "/webroot/server.com/www/"

// regex to match sub.domain.com
$HTTP["host"] =~ "\b[a-zA-Z]\w*\.\b[a-zA-Z]\w*\.\b[a-zA-Z]\w*" {
    evhost.path-pattern = "/webroot/%0/%3/"    
}

// regex to match domain.com    
$HTTP["host"] =~ "\b[a-zA-Z]\w*\.\b[a-zA-Z]\w*" {
    evhost.path-pattern = "/webroot/%0/www/"    
} 
```

那么我哪里错了？目前，所有对***** .domain.com和**domain.com**的请求都来自*/webroot/domain.com/www/*

我很感激你们可以提供的任何帮助，如果我遗漏了任何相关的内容，请告诉我！

干杯，罗伯

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-04T13:51:42.650

你的正则表达式似乎有点过头了。

这是我会使用的：

```
// regex to match sub.domain.com
$HTTP["host"] =~ "^[^.]+\.[^.]+\.[^.]+$" {
    evhost.path-pattern = "/webroot/%0/%3/"    
}

// regex to match domain.com    
$HTTP["host"] =~ "^[^.]+\.[^.]+$" {
    evhost.path-pattern = "/webroot/%0/www/"    
} 
```

在哪里：

```
[^.]+ matches anything but a dot, 1..n times 
```

要仅匹配回退到“www”的有效子域，您可以使用以下命令：

```
// default: route everything to "www"
$HTTP["host"] =~ "([^.]+\.)?domain\.com$" {
    evhost.path-pattern = "/webroot/%0/www/"
}

// specific regex overwrites "path-pattern" for valid sub-domains only
$HTTP["host"] =~ "^(valid1|valid2|sub)\.domain\.com$" {
    evhost.path-pattern = "/webroot/%0/%3/"    
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-04T13:47:03.627

对于您的第一个，匹配**domain.com**和**www.domain.com** : `^\b([wW]{3}\.)?[\w\d]*\.com\b$`，对于第二个，我不确定正则表达式是否可以确定是否存在子域/页面，因为它用于识别感兴趣的文本字符串。希望这会对您有所帮助。

# sql-server - 如何以最低权限从 MS SQL 服务器读取数据库和表元数据

> ID：261908
> 
> 赞同：2
> 
> 时间：2008-11-04T13:34:15.400
> 
> 标签：sql-server, metadata

我想提出在尽可能多的 SQL Server 版本上返回 Microsoft SQL Server 实例中的数据库和表的最小查询集。

我不确定我是否应该半回答我自己的问题，但这是我认为 2000 年和 2005 年需要的内容。理想情况下，我会更进一步，但我无法访问旧版本：

# 权限

2005：具有查看任何定义权限的用户

2000：在所有要检索的数据库上具有公共角色的用户

# 数据库

```
sp_databases 
```

或者

```
SELECT * FROM sysdatabases 
```

都适用于 SQL Server 2000 和 2005

# 表

### 2005年

```
SELECT name FROM <database>.sys.tables 
```

或者

```
SELECT table_name FROM <database>.information_schema.tables WHERE table_type = 'BASE TABLE' 
```

### 2000

```
SELECT name from <database>.dbo.sysobjects WHERE xtype = 'U' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-04T13:45:58.950

我相信 INFORMATION_SCHEMA 视图可以帮助你。

[http://msdn.microsoft.com/en-us/library/ms186778.aspx](http://msdn.microsoft.com/en-us/library/ms186778.aspx)

# php - 使用 Jquery 的翻转效果

> ID：261910
> 
> 赞同：0
> 
> 时间：2008-11-04T13:35:22.417
> 
> 标签：php, javascript, jquery, html

你能帮我用jquery制作一个翻转效果吗，我想做的是当有人将鼠标悬停在任何菜单项上时，文本向下滑动并消失，图片从上向下滑动到中心（例如，你可以看到这个效果在这里[熊猫](http://www.iviewcom.com/panda)，你可以看到图片从顶部滑下来，但文字没有滑下来，这不是想要的）。

我知道使用 flash 可以轻松完成，但我不希望我的菜单在 flash 中，因为那将是一个不好的做法。

你能告诉我我需要在我的菜单 HTML 中更改什么以及我应该使用哪些 jquery 函数。

**非常感谢你的帮助**

PS这是我的菜单HTML，你可以在这里看到我的菜单

```
<ul class="nav">

<li class="active first"><a href="#" class="home">Home</a></li>
<li><a href="#" class="news">News</a></li>
<li><a href="#" class="offers">Special offers</a></li>
<li><a href="#" class="private">Private label</a></li>
<li><a href="#" class="locations">Locations</a></li>
<li><a href="#" class="about">About us</a></li>
<li><a href="#" class="jobs">Jobs</a></li>
<li><a href="#" class="contact">Contact us</a></li>
<li><a href="#" class="mm">Multimedia</a></li>

</ul> 
```

菜单：

![替代文字](https://i.stack.imgur.com/8ANuL.jpg)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-04T15:50:43.003

我不会为你做，而是提供一些开始寻找的地方。

这是一个可以轻松修改为使用“翻转”而不是“点击”的示例： http: [//css-tricks.com/examples/MenuFader/](http://css-tricks.com/examples/MenuFader/)

有关如何将上述示例组合在一起的详细信息（教程）： [http ://css-tricks.com/learning-jquery-fading-menu-replacing-content/](http://css-tricks.com/learning-jquery-fading-menu-replacing-content/)

我通过在 Google 上搜索“jquery 效果示例”找到了本教程： [http](http://www.google.com/search?hl=en&q=jquery+effects+examples&btnG=Google+Search&aq=f&oq=) ://www.google.com/search?hl=en&q=jquery+effects+examples&btnG=Google+Search&aq=f&oq=并单击第一个和第二个链接。

祝你的 Jquery 项目好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-14T18:46:16.397

首先，你真的很想给你独立的锚标签ID，因为它会让你更容易完成你想要的。

查看 slideDown() 和 slideToggle() 函数，它基本上需要您设置隐藏的 div，然后在 mouseover 事件上，您将滑动切换文本和隐藏的图像 div，而在 mouseout 上则相反。

祝你好运，使用 jQuery 很有趣。玩它，看看你能炸毁什么！

# c# - Linq to Sql 实体关联（非整数主键）

> ID：261918
> 
> 赞同：1
> 
> 时间：2008-11-04T13:39:42.660
> 
> 标签：c#, linq-to-sql

我一直在玩 Linq to Sql，但是在定义实体之间的关联时遇到了一个问题。

我有 2 个表，1 个是包含客户交易的表，另一个是包含交易类型的查找表。例如，交易可以是“CASH”类型，查找表中的值将具有主键“CASH”和描述“现金支付”。

当我运行我的测试程序时，如果我将事务和查找表中的主键更改为整数，程序会出现“无法将类型为 'System.Int32' 的对象转换为类型 'System.String'”的错误按预期工作。

我可能错过了一些基本的东西，但我不确定是什么。任何帮助表示赞赏。

这是我用来映射表的代码：

```
[Table(Name = "customer")]
public class Customer
{
    [Column(IsPrimaryKey = true, Name = "customer_id")]
    public int CustomerID { get; set; }

    private EntitySet<Transaction> _Transactions;

    [Association(Storage = "_Transactions", OtherKey="CustomerID")]
    public EntitySet<Transaction> Transactions
    {
        get { return this._Transactions; }
        set { this._Transactions.Assign(value); }
    }

    public Customer()
    {
        this._Transactions = new EntitySet<Transaction>();
    }
}

[Table(Name = "custtran")]
public class Transaction
{
    [Column(Name = "compno", DbType="smallint")]
    public int CompanyNumber { get; set; }

    [Column(IsPrimaryKey = true, Name = "tran_no")]
    public int TranNo { get; set; }

    [Column(Name = "customer_id")]
    public int CustomerID { get; set; }

    [Column(Name = "tran_type", DbType="char(4)")]
    public string TranType { get; set; }

    private EntityRef<Customer> _Customer;

    [Association(Storage = "_Customer", ThisKey = "CustomerID")]
    public Customer Customer
    {
        get { return this._Customer.Entity; }
        set { this._Customer.Entity = value; }
    }

    private EntitySet<TransactionType> _TransactionTypes;
    [Association(Name="Custtran_TranType", Storage = "_TransactionTypes", IsForeignKey=true,  OtherKey = "TranType")]
    public EntitySet<TransactionType> TransactionTypes
    {
        get { return this._TransactionTypes; }
        set { this._TransactionTypes.Assign(value); }
    }

    public Transaction()
    {
       this._Customer = default(EntityRef<Customer>);
       this._TransactionTypes = new EntitySet<TransactionType>();
    }
}

[Table(Name = "tran_type")]
public class TransactionType
{
    [Column(Name = "compno", DbType = "smallint")]
    public int CompanyNumber { get; set; }

    [Column(IsPrimaryKey = true, Name = "tran_type", DbType="char(4)")]
    public string TranType { get; set; }

    [Column(Name = "description", DbType="Varchar(50)")]
    public string Description { get; set; }

    private EntityRef<Transaction> _Transaction;
    [Association(Name="Custtran_TranType", Storage = "_Transaction", ThisKey = "TranType")]
    public Transaction Transaction
    {
        get { return this._Transaction.Entity; }
        set { this._Transaction.Entity = value; }
    }

    public TransactionType()
    {
        this._Transaction = default(EntityRef<Transaction>);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-04T13:43:20.013

忽略我，我已经回答了我自己的问题。

```
private EntitySet<TransactionType> _TransactionTypes;
    [Association(Name="Custtran_TranType", Storage = "_TransactionTypes", IsForeignKey=true, ThisKey="TranType", OtherKey = "TranType")]
    public EntitySet<TransactionType> TransactionTypes
    {
        get { return this._TransactionTypes; }
        set { this._TransactionTypes.Assign(value); }
    } 
```

将 ThisKey 添加到关联中，现在可以正常工作。

# c# - ASP.NET 从会话中删除项目？

> ID：261920
> 
> 赞同：56
> 
> 时间：2008-11-04T13:40:45.137
> 
> 标签：c#, asp.net, .net, session, session-variables

首选哪种方法？

```
Session.Remove("foo");

Session["foo"] = null; 
```

有区别吗？

* * *

## 回答 #1

> 赞同：123
> 
> 时间：2008-11-04T15:12:08.197

> 有区别吗？

有。 `Session.Remove(key)`从字典中删除条目（键和值），同时`Session[key] = null`将值（恰好为空）分配给键。在前一次调用之后，密钥将不会出现在`Session#Keys`集合中。但是在后者之后，仍然可以在密钥集合中找到密钥。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2010-11-09T11:55:53.657

我知道这是旧线程，但绝对坚持`Session["key"] = null`- 它更快！我已经做了一些测试（在 InProc 会话状态上），删除了 1000 个行中的项目（经过的时间总共是 1000 个项目，所以如果你想要一个项目的平均时间，只需将它除以 1000）：

删除 1000 个现有项目：

```
Session[key] = null; - 0.82380000000000009 ms
Session.Remove(key); - 59.960100000000004 ms 
```

删除 1000 个不存在的项目：

```
Session[key] = null; - 1.5368000000000002 ms
Session.Remove(key); - 0.6621 ms 
```

删除 500 个现有项目和 500 个不现有项目：

```
Session[key] = null; - 1.0432000000000001 ms
Session.Remove(key); - 33.9502 ms 
```

这是第一次测试的一段代码：

```
Session.Clear();

for (int i = 0; i < 1000; i++)
    Session[i.ToString()] = new object();

Stopwatch sw1 = Stopwatch.StartNew();
for (int i = 0; i < 1000; i++)
    Session[i.ToString()] = null;
sw1.Stop();

Session.Clear();

for (int i = 0; i < 1000; i++)
    Session[i.ToString()] = new object();

Stopwatch sw2 = Stopwatch.StartNew();
for (int i = 0; i < 1000; i++)
    Session.Remove(i.ToString());
sw2.Stop(); 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-11-04T14:07:47.173

它具有相同的效果。我个人认为该`Session.Remove`方法确实更好地表达了程序员的意图。

这里有一些 MSDN 上文档的链接：

*   [HttpSessionState 类](http://msdn.microsoft.com/en-us/library/system.web.sessionstate.httpsessionstate.aspx)
*   [HttpSessionState.Item 属性（字符串）](http://msdn.microsoft.com/en-us/library/8dhkksh8.aspx)

*“HttpSessionState.Item 属性：

属性值类型：System.Object

具有指定名称的会话状态值，如果该项不存在，则为空引用（在 Visual Basic 中为无）。”*

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2008-11-04T13:48:12.953

我会选择删除，但不能老实说是否有区别。猜测可能仍然为该空值保留一个空键，但不确定。删除会让我毫无疑问，如果这就是你想要做的，它在代码中也能**更好地阅读。**

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-11-04T15:17:35.050

最大的区别是你如何从会话中阅读。

```
if(Session.ContainsKey["foo"]) { return Session["foo"]; } 
```

或者

```
if(Session["foo"] != null) { return Session["foo"]; } 
```

如果使用第一种方法，将值设置为null将不起作用，您应该使用remove。

如果使用第二种方法，则可以将值设置为 null。

# java - 使用带注释的 Hibernate 配置 Compass

> ID：261922
> 
> 赞同：2
> 
> 时间：2008-11-04T13:41:08.273
> 
> 标签：java, hibernate, spring, lucene, compass-lucene

我正在将 Hibernate 用于基于 Java 的 Web 应用程序，并希望通过 Compass 添加全文搜索。Compass 应该支持这一点，但未能提供任何有用的入门指南。

我可以弄清楚我必须用@Searchable 和各种@SearchableXXX 变体注释我的实体，并通过HibernateHelper.getCompass(sessionFactory) 在我的服务代码中访问Compass。

我最终得到一个 HibernateException 说“未配置指南针事件侦听器，请检查参考文档和应用程序的 hibernate.cfg.xml”。

参考[文档](http://www.compass-project.org/docs/2.1.0/reference/html/gps-embeddedhibernate.html)再次提示和 hibernate.cfg.xml，而我用 Spring 的 AnnotationSessionFactoryBean 配置 Hibernate。对于这种情况，文档中提到：“如果使用 Hibernate Annotations 或 Hibernate EntityManager (JPA)，只需将 Compass jar 文件放到类路径中即可启用它（确保类路径中没有 Hibernate Search，因为它使用相同的事件类名称）。” 这对我不起作用。

我缺少什么想法或入门的好资源？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-02-01T14:08:39.340

我想知道你为什么选择 Compass 去休眠。我们查看了 Compass 和 Hibernate-Search，我们选择了后者，因为它具有出色的集成性。

您可以使用与使用 HQL 或 Critera 执行 SQL 数据库完全相同的方式查询测试索引。

如果您使用的是 iBatis 或 JDBC，那么 Compass 当然会更合适。Hibernate 搜索更适合 JTA。

是我还是 Compass 明显缺乏活动？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-14T21:47:06.923

审查的最佳资源是检查随指南针分发提供的宠物诊所示例（带有依赖项）。如果默认情况下未配置侦听器，则您必须设置 EventListener。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-08T22:56:51.363

Compass 有两种模式与 Hibernate 集成。嵌入式模式基本上意味着您需要将 Compass jar 放入应用程序（并且可能需要配置事件侦听器，具体取决于 Hibernate 版本），然后您至少需要在配置 Compass 的 Hibernate cfg 文件中进行属性配置索引位置。这是一个[链接链接以获取更多信息](http://www.compass-project.org/docs/2.1.1/reference/html/gps-hibernate.html)。

另一个选项是通过创建 CompassGps 和 Hibernate 设备（使用 Hibernate SessionFactory 初始化）来配置 Compass 以在外部与 Hibernate 集成。Hibernate 设备会自动向 Hibernate 注册相关的监听器。更多信息可以在[这里找到链接](http://www.compass-project.org/docs/2.1.1/reference/html/gps-hibernate.html)。

# sql - 如何根据行优先级将此 Oracle 结果集压缩为值，忽略空值？

> ID：261924
> 
> 赞同：1
> 
> 时间：2008-11-04T13:41:48.397
> 
> 标签：sql, database, oracle, analytic-functions

我将尽可能简化问题：

我有一个 oracle 表：

```
row_priority, col1, col2, col3
0, .1, 100, {null}
12, {null}, {null}, 3
24, .2, {null}, {null} 
```

期望的结果：

```
col1, col2, col3
.2, 100, 3 
```

因此，根据行的优先级，如果给定，它会覆盖先前的行值。

我正在尝试使用表格上的分析函数来制定解决方案，但它只是没有表现......

我尝试：

```
select last_value(col1 ignore nulls) over () col1,
       last_value(col2 ignore nulls) over () col2,
       last_value(col3 ignore nulls) over () col3
from (select * from THE_TABLE order by row_priority)
where rownum = 1 
```

或相反：

```
select first_value(col1 ignore nulls) over () col1,
       first_value(col2 ignore nulls) over () col2,
       first_value(col3 ignore nulls) over () col3
from (select * from THE_TABLE order by row_priority desc)
where rownum = 1 
```

而且似乎都没有忽略空值。有什么提示吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-04T14:14:22.387

您需要将 rownum = 1 放在分析查询之外

```
SELECT  *
FROM    (   select          last_value(col1 ignore nulls) over () col1,
                            last_value(col2 ignore nulls) over () col2,
                            last_value(col3 ignore nulls) over () col3
            from (select * from THE_TABLE ORDER BY ROW_PRIORITY)
        )
WHERE   ROWNUM = 1 
```

这导致（使用上面的值）：

```
COL1   COL2    COL3
------ ------- ----
0.2    100     3 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2008-11-04T13:47:14.483

COALESCE 功能在这里可能对您有所帮助。也许像...

```
select first_value(coalesce(col1,0) ignore nulls) over () col1,
       first_value(coalesce(col2,0) ignore nulls) over () col2,
       first_value(coalesce(col3,0) ignore nulls) over () col3
from THE_TABLE 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-11-04T18:20:54.277

替代：

```
SELECT
  MAX(col1) KEEP (DENSE_RANK LAST ORDER BY row_priority),
  MAX(col2) KEEP (DENSE_RANK LAST ORDER BY row_priority),
  MAX(col3) KEEP (DENSE_RANK LAST ORDER BY row_priority)
FROM the_table 
```

其性能可能与解析版本不同；是好是坏取决于你的数据和环境。

# apache - 强制 Apache HTTPD 以 32 位运行

> ID：261927
> 
> 赞同：2
> 
> 时间：2008-11-04T13:42:26.537
> 
> 标签：apache, macos, osx-leopard

通过从二进制文件中剥离 32 位架构（连同 ppc 部分），我一直在 64 位模式下运行 Apache HTTPD。我这样做是为了使它更兼容 python 和 mysql。

但是我有另一台机器需要它以 32 位模式运行（它仍然具有所有四个原始架构）。是否可以确保它以 32 位模式运行，并且针对它编译的任何内容都使用所述模式。

我的选择是否仅限于剥离它，或者是否有我不知道的启动选项。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-04T19:51:38.010

您可以使用该[`arch(1)`](http://developer.apple.com/documentation/Darwin/Reference/ManPages/man1/arch.1.html)命令来更改所使用的架构。这将首先尝试 Intel 32 位，然后是 PPC 32 位：

```
% arch -i386 -ppc /usr/sbin/httpd 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-07T15:41:01.543

此方法将制作 Apache 二进制文件的副本，并确保 apachectl（以及正常的操作系统配置）将正确启动 32 位版本：

首先，创建 32 位版本的 httpd：

```
sudo lipo -thin i386 /usr/sbin/httpd -output /usr/sbin/httpd.i386 
```

其次，编辑系统配置，使其使用新版本而不是默认版本。将“/usr/sbin/httpd”更改为“/usr/sbin/httpd.i386”：

```
sudo vi /System/Library/LaunchDaemons/org.apache.httpd.plist 
```

最后，重启 Apache：

```
sudo apachectl restart 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-07T01:21:47.280

请注意，这样做会阻止 apache 加载任何 64 位共享模块 - 例如，如果您使用的是 EntropyPHP，这可能是一个问题。

# actionscript-3 - 为什么要使用 MXML？

> ID：261938
> 
> 赞同：5
> 
> 时间：2008-11-04T13:46:17.717
> 
> 标签：actionscript-3, apache-flex, actionscript, mxml

如果可以在[MXML](http://en.wikipedia.org/wiki/MXML)中完成的所有事情也可以在 ActionScript 中完成，并且很多事情在 ActionScript 中更容易完成（循环、条件等），为什么还要花时间学习 MXML？

我在这一点上的最佳理由是 MXML 的结构很好地匹配 UI 组件的视觉层次结构，并且减少了初始化 UI 的代码行数。另一方面，现实世界的 UI 通常是动态的，实现为简单的静态结构，然后根据运行时条件动态填充（在这种情况下，UI 更新无论如何都在 ActionScript 中）。还可以通过创建一些辅助方法来减少 ActionScript 所需的[SLOC 。](http://en.wikipedia.org/wiki/Source_lines_of_code)

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-06T22:49:49.657

It depends on your application's needs, but I generally break my design into visual chunks and use custom MXML components to lay out the main areas and components of my application (data panels, dialog boxes, etc) using mxml based custom components. Then I'll augment that with custom actionscript components where I need more visual flexibilty than the built in layout components provide. MXML is handy because it makes it extremely easy to get components on the stage and set their various properties and style settings.

Take this example of two identical login panels:

In MXML:

```
<mx:Panel xmlns:mx="http://www.adobe.com/2006/mxml" layout="absolute" width="290" height="148" title="Login">
    <mx:Label text="User name:" width="80" textAlign="right" y="8" x="8"/>
    <mx:Label text="Password:" width="80" textAlign="right" y="38" x="8"/>
    <mx:TextInput id="txtUsername" maxChars="20" y="8" x="90"/>
    <mx:TextInput id="txtPassword" displayAsPassword="true" y="38" x="90" maxChars="20"/>
    <mx:Button x="185" y="68" label="Login" id="btnLogin" click="doLogin()"/>
</mx:Panel> 
```

And in actionscript:

```
package
{
    import flash.events.MouseEvent;

    import mx.containers.Panel;
    import mx.controls.Button;
    import mx.controls.Label;
    import mx.controls.TextInput;

    public class MyLoginPanel extends Panel
    {

        private var _unLabel:Label;
        private var _passLabel:Label;
        private var _txtUsername:TextInput;
        private var _txtPassword:TextInput;
        private var _btnLogin:Button;

        public function MyLoginPanel()
        {
        }

        override protected function createChildren():void
        {
            super.createChildren();

            this.width = 290;
            this.height = 148;
            this.title = "Login";
            this.layout = "absolute";

            _unLabel = new Label();
            _unLabel.text = "User Name:";
            _unLabel.width = 80;
            _unLabel.setStyle("textAlign", "right");
            _unLabel.move(8, 8);
            this.addChild(_unLabel);

            _passLabel = new Label();
            _passLabel.text = "Password:";
            _passLabel.width = 80;
            _passLabel.setStyle("textAlign", "right");
            _passLabel.move(8, 38);
            this.addChild(_passLabel);

            _txtUsername = new TextInput();
            _txtUsername.move(90, 8);
            this.addChild(_txtUsername);

            _txtPassword = new TextInput();
            _txtPassword.move(90, 38);
            _txtPassword.displayAsPassword = true;
            this.addChild(_txtPassword);

            _btnLogin = new Button();
            _btnLogin.label = "Login";
            _btnLogin.move(185, 68);
            _btnLogin.addEventListener(MouseEvent.CLICK, doLogin);
            this.addChild(_btnLogin);
        }       
    }
} 
```

Seven lines of code vs 62\. That's a pretty simple example, but hopefully you can see how you might benefit by laying out many portions of your application in MXML, whether you're using the design mode in Flex Builder or not.

One thing I do recommend however is keep actionscript out of your mxml files as much as possible. Treat MXML as your view and separate any heavy functionality into other classes. You can then provide public properties in those classes that the controls in your MXML components can bind to. MXML is a layout language and in my experience it pays in the end to use it where it makes sense and drop into actionscript whenever heavier lifting is required.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-04T13:55:14.890

使用 mxml 和可视化设计器设计 UI 元素比使用代码更容易，而且在我看来更不容易出错。

即使 UI 是动态变化的，这通常也意味着交换预定义的 UI 元素。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-04T13:58:44.150

如果您使用 FlexBuilder，那么 MXML 对于布局应用程序很有用，因为 FlexBuilder 可以在设计视图中读取/写入 MXML。此外，通过 MXML 实现状态要容易得多。

如果您不使用具有设计视图的工具（例如 FlexBuilder），那么它的用处可能会降低。请记住，尽管 Flex4 将引入新的 Thermo 东西，其中包括使用 MXML 符号创建矢量图形的能力，并将允许使用 MXML 来为 Flex 组件设置皮肤。到时候它很可能会自成一体。如果您已经了解了 MXML，那么您将在这一点上获得优势。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-05T02:42:01.317

您是说您将使用 Flex 框架，但正在选择是使用 MXML 还是在 AS 中动态工作？如果是这样，那么 MXML 的主要优点是与设计界面的集成。如果访问 WYSIWYG 界面对您没有价值，那么您可能会发现 MXML 和纯 AS 之间几乎没有区别。

如果您问的是使用 MXML 还是使用 FLA 文件，那么这是一个非常不同的问题 - 它相当于“我为什么要使用 Flex 框架？”

# c++ - (C++) 游戏服务器，(Flash) 客户端

> ID：261958
> 
> 赞同：2
> 
> 时间：2008-11-04T13:53:03.130
> 
> 标签：c++, flash, client-server

我有兴趣将我的第一个使用 Flash 作为客户端的在线游戏放在一起，并用 C++ 编写一个保留实际游戏状态的后端应用程序。

在使用 SDL、SFML、Allegro 等之前，我用 C++ 完成了很多游戏，但从未使用过网络库。我只是对一些有用的方向感兴趣，哪些库最适合实际服务器没有任何图形显示（或不需要但可以有）的游戏服务器。老实说，我认为答案是*任意*的，一旦我掌握了套接字的窍门，来回发送数据就会变得轻而易举……但首先问起来是无济于事的。

我在 flash 或 as3 方面的经验很少，但喜欢能够通过浏览器访问游戏的想法 - 学习 flash 显然是一个我必须克服的难题，但我的主要兴趣再次是关于库的任何提示，或资源，或适合通过套接字或任何最有效的方法发送/接收数据的教程。

我已经阅读了 TCP/UDP 之间的争论，所以我不想在这里发动这样的战争；请提供一般有用的建议 - 我只是在寻找一些简单的东西来让我启动和运行:-p

作为旁注，我选择 C++ 的原因是因为玩家实际上是具有微型虚拟机的机器人，并且一切都将在服务器上运行，因此随着玩家数量的增加，将需要模拟每个虚拟机：-p

更新：

游戏世界旨在实现实时，但玩家的交互并非必须如此。游戏的基础是您编写小机器人，这些机器人在一个持久的世界中进行交互，并且每天/每周都有目标和挑战来获得积分。

我在想缓冲显示数据是可能的，因为玩家不需要实时视觉，因为他们无法直接控制他们的机器人。服务器将为每个连接缓冲 10 秒左右的数据，然后一次性将其发送出去 - 这样，当数据在客户端播放时，服务器正忙于缓冲更多数据。

玩家与服务器的一般交互将是上传新代码和获取统计数据，还可能有其他一次性命令来移动机器人或将其重置到起始位置。任何远程控制都是通过通信通道完成的，因此会被缓冲区延迟。这很容易解释为持久世界位于火星（行星）之类的某个地方，并且信号需要一段时间来来回回。

我正计划建立一个“实验室”，您可以在其中设置机器人并在客户端上实时测试它们，这与实际的游戏世界无关，因此不需要任何网络 - 尽管我不喜欢用两种语言编写虚拟机:(

我对 C++ 非常熟悉，并且已经有了一些持久化世界的工作原型——在网络方面我只是一个完全的新手，所以我认为最好先获得建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-04T13:58:18.160

虽然它主要是为 C 编写的，但它仍然适用于 C++：
[Beej 网络编程指南。](http://beej.us/guide/bgnet/)
它涵盖了所有基础知识，并有一节介绍了 Win32 所需的更改 :)
我似乎还记得 Flash 需要终止空字节每个数据包，所以而不是 send(socket,szData,strlen(szData),0); 使用发送（套接字，szData，strlen（szData）+1,0）；发送一个字符串:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-04T14:14:37.173

使用 boost::asio 进行网络编程

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-08-25T16:23:46.357

使用 Flash 的 Socket 或 XMLSocket 类时，请确保您的服务器上有一个安全策略文件。否则，您将无法打开套接字。查看这个[SO question](https://stackoverflow.com/questions/1204061/flash-client-xmlsocket-not-connecting-to-server/1204326#1204326)了解更多信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-05T15:22:12.123

我不确定您的游戏是否需要实时通信，或者是否向服务器发出请求以加载、保存和执行游戏就足够了。

如果是你最好使用某种“中间件”层来处理网络部分。Flash 很乐意制作 xml 文档并通过 HTTP 将它们发送到服务器，然后处理收到的 XML 响应。它有很多内置的东西，可以很容易地处理所有这些事情。

也许您可以在 c# 或 php 或 java 中使用服务器，具体取决于您的平台，该服务器在网络服务器中运行并处理请求和响应并将请求传递给您的 c++ 服务器，该服务器可以通过消息队列或数据库或本地在服务器上独立运行联系。

在闪存和服务器端以这种方式处理网络和通信问题可能更容易，因为即使使用库，C++ 也不是最容易进行网络的语言。

我不知道这是否符合您对游戏或平台的要求，我只是将其作为建议提出

# c++ - 如何迭代枚举？

> ID：261963
> 
> 赞同：379
> 
> 时间：2008-11-04T13:55:29.943
> 
> 标签：c++, enums

我刚刚注意到您不能在 ++ 或 += 等枚举上使用标准数学运算符

那么遍历 C++ 枚举中所有值的最佳方法是什么？

* * *

## 回答 #1

> 赞同：309
> 
> 时间：2008-11-04T14:10:51.643

典型的方式如下：

```
enum Foo {
  One,
  Two,
  Three,
  Last
};

for ( int fooInt = One; fooInt != Last; fooInt++ )
{
   Foo foo = static_cast<Foo>(fooInt);
   // ...
} 
```

请注意，枚举`Last`意味着被迭代跳过。利用这个“假”`Last`枚举，您不必在每次想要添加新枚举时将 for 循环中的终止条件更新为最后一个“真实”枚举。如果您想稍后添加更多枚举，只需在 Last 之前添加它们。此示例中的循环仍然有效。

当然，如果指定了枚举值，这将失效：

```
enum Foo {
  One = 1,
  Two = 9,
  Three = 4,
  Last
}; 
```

这说明枚举并不是真的要迭代。处理枚举的典型方法是在 switch 语句中使用它。

```
switch ( foo )
{
    case One:
        // ..
        break;
    case Two:  // intentional fall-through
    case Three:
        // ..
        break;
    case Four:
        // ..
        break;
     default:
        assert( ! "Invalid Foo enum value" );
        break;
} 
```

如果您真的想枚举，请将枚举值填充到向量中并对其进行迭代。这也将正确处理指定的枚举值。

* * *

## 回答 #2

> 赞同：72
> 
> 时间：2014-11-13T14:07:29.427

```
#include <iostream>
#include <algorithm>

namespace MyEnum
{
  enum Type
  {
    a = 100,
    b = 220,
    c = -1
  };

  static const Type All[] = { a, b, c };
}

void fun( const MyEnum::Type e )
{
  std::cout << e << std::endl;
}

int main()
{
  // all
  for ( const auto e : MyEnum::All )
    fun( e );

  // some
  for ( const auto e : { MyEnum::a, MyEnum::b } )
    fun( e );

  // all
  std::for_each( std::begin( MyEnum::All ), std::end( MyEnum::All ), fun );

  return 0;
} 
```

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2015-08-05T15:13:41.457

使用 c++11，实际上有一个替代方案：编写一个简单的模板化自定义迭代器。

假设您的枚举是

```
enum class foo {
  one,
  two,
  three
}; 
```

这个通用代码将非常有效地解决问题 - 放置在通用标头中，它将为您可能需要迭代的任何枚举提供服务：

```
#include <type_traits>
template < typename C, C beginVal, C endVal>
class Iterator {
  typedef typename std::underlying_type<C>::type val_t;
  int val;
public:
  Iterator(const C & f) : val(static_cast<val_t>(f)) {}
  Iterator() : val(static_cast<val_t>(beginVal)) {}
  Iterator operator++() {
    ++val;
    return *this;
  }
  C operator*() { return static_cast<C>(val); }
  Iterator begin() { return *this; } //default ctor is good
  Iterator end() {
      static const Iterator endIter=++Iterator(endVal); // cache it
      return endIter;
  }
  bool operator!=(const Iterator& i) { return val != i.val; }
}; 
```

你需要专攻它

```
typedef Iterator<foo, foo::one, foo::three> fooIterator; 
```

然后您可以使用 range-for 进行迭代

```
for (foo i : fooIterator() ) { //notice the parentheses!
   do_stuff(i);
} 
```

您的枚举中没有空白的假设仍然是正确的；没有假设存储枚举值实际需要的位数（感谢 std::underlying_type）

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2014-07-27T15:56:21.857

这些解决方案太复杂了，我喜欢这样：

```
enum NodePosition { Primary = 0, Secondary = 1, Tertiary = 2, Quaternary = 3};

const NodePosition NodePositionVector[] = { Primary, Secondary, Tertiary, Quaternary };

for (NodePosition pos : NodePositionVector) {
...
} 
```

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2008-11-04T14:20:35.900

如果您的枚举以 0 开头并且增量始终为 1。

```
enum enumType 
{ 
    A = 0,
    B,
    C,
    enumTypeEnd
};

for(int i=0; i<enumTypeEnd; i++)
{
   enumType eCurrent = (enumType) i;            
} 
```

如果不是，我猜唯一的原因是创建类似

```
vector<enumType> vEnums; 
```

添加项目，并使用普通迭代器....

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2017-01-18T11:54:09.263

我经常这样做

```
 enum EMyEnum
    {
        E_First,
        E_Orange = E_First,
        E_Green,
        E_White,
        E_Blue,
        E_Last
    }

    for (EMyEnum i = E_First; i < E_Last; i = EMyEnum(i + 1))
    {} 
```

或者如果不是连续的，但有规律的步骤（例如位标志）

```
 enum EAnimalCaps
    {
        E_None    = 0,
        E_First   = 0x1,
        E_CanFly  = E_First,
        E_CanWalk = 0x2
        E_CanSwim = 0x4,
        E_Last
    }

    class MyAnimal
    {
       EAnimalCaps m_Caps;
    }

    class Frog
    {
        Frog() : 
            m_Caps(EAnimalCaps(E_CanWalk | E_CanSwim))
        {}
    }

    for (EAnimalCaps= E_First; i < E_Last; i = EAnimalCaps(i << 1))
    {} 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2008-11-04T14:10:23.283

你不能用枚举。也许枚举不是最适合您的情况。

一个常见的约定是将最后一个枚举值命名为 MAX，并使用它来控制使用 int 的循环。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2013-06-13T01:15:40.163

其他答案中未涵盖的内容=如果您使用的是强类型 C++11 枚举，则不能在它们上使用`++`或`+ int`。在这种情况下，需要一些更混乱的解决方案：

```
enum class myenumtype {
  MYENUM_FIRST,
  MYENUM_OTHER,
  MYENUM_LAST
}

for(myenumtype myenum = myenumtype::MYENUM_FIRST;
    myenum != myenumtype::MYENUM_LAST;
    myenum = static_cast<myenumtype>(static_cast<int>(myenum) + 1)) {

  do_whatever(myenum)

} 
```

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2019-07-14T00:17:02.550

假设枚举按顺序编号很容易出错。此外，您可能只想迭代选定的枚举数。如果该子集很小，则显式循环它可能是一个优雅的选择：

```
enum Item { Man, Wolf, Goat, Cabbage }; // or enum class

for (auto item : {Wolf, Goat, Cabbage}) { // or Item::Wolf, ...
    // ...
} 
```

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2019-05-27T21:17:07.970

```
enum class A {
    a0=0, a3=3, a4=4
};
constexpr std::array<A, 3> ALL_A {A::a0, A::a3, A::a4}; // constexpr is important here

for(A a: ALL_A) {
  if(a==A::a0 || a==A::a4) std::cout << static_cast<int>(a);
} 
```

A`constexpr std::array`甚至可以迭代非顺序枚举，而无需编译器实例化数组。这取决于编译器的优化启发式方法以及您是否采用数组的地址。

在我的实验中，我发现如果有 2 个非连续值或相当多的连续值（我测试了最多 6 个） ， `g++`9.1 with将优化上述数组。`-O3`但只有在您有`if`声明时才会这样做。（我尝试了一个语句，它比较了一个大于顺序数组中所有元素的整数值，尽管没有排除任何元素，但它内联了迭代，但是当我省略 if 语句时，这些值被放入内存中。）它还内联了 5 [one case| 中非顺序枚举的值] [https://godbolt.org/z/XuGtoc]](https://godbolt.org/z/XuGtoc])。我怀疑这种奇怪的行为是由于深度启发式与缓存和分支预测有关。

这是[godbolt 上一个简单测试迭代](https://godbolt.org/z/vaD3py)的链接，它演示了数组并不总是被实例化。

这种技术的代价是两次写入枚举元素并保持两个列表同步。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2011-12-09T22:04:07.217

您可以尝试定义以下宏：

```
#define for_range(_type, _param, _A1, _B1) for (bool _ok = true; _ok;)\
for (_type _start = _A1, _finish = _B1; _ok;)\
    for (int _step = 2*(((int)_finish)>(int)_start)-1;_ok;)\
         for (_type _param = _start; _ok ; \
 (_param != _finish ? \
           _param = static_cast<_type>(((int)_param)+_step) : _ok = false)) 
```

现在你可以使用它了：

```
enum Count { zero, one, two, three }; 

    for_range (Count, c, zero, three)
    {
        cout << "forward: " << c << endl;
    } 
```

它可用于通过无符号、整数、枚举和字符来向后和向前迭代：

```
for_range (unsigned, i, 10,0)
{
    cout << "backwards i: " << i << endl;
}

for_range (char, c, 'z','a')
{
    cout << c << endl;
} 
```

尽管它的定义很尴尬，但它的优化非常好。我查看了 VC++ 中的反汇编程序。该代码非常有效。三个for语句不要被推迟：编译器在优化后只会产生一个循环！您甚至可以定义封闭循环：

```
unsigned p[4][5];

for_range (Count, i, zero,three)
    for_range(unsigned int, j, 4, 0)
    {   
        p[i][j] = static_cast<unsigned>(i)+j;
    } 
```

您显然不能遍历有间隙的枚举类型。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2008-11-04T17:35:39.203

您还可以为枚举类型重载递增/递减运算符。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2018-11-08T19:00:28.137

这是另一种仅适用于连续枚举的解决方案。它给出了预期的迭代，除了增量中的丑陋，这是它所属的地方，因为这在 C++ 中被破坏了。

```
enum Bar {
    One = 1,
    Two,
    Three,
    End_Bar // Marker for end of enum; 
};

for (Bar foo = One; foo < End_Bar; foo = Bar(foo + 1))
{
    // ...
} 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2016-05-30T07:32:46.487

如果你不喜欢用最终的 COUNT 项污染你的枚举（因为也许如果你也在开关中使用枚举，那么编译器会警告你缺少 case COUNT:)，你可以这样做：

```
enum Colour {Red, Green, Blue};
const Colour LastColour = Blue;

Colour co(0);
while (true) {
  // do stuff with co
  // ...
  if (co == LastColour) break;
  co = Colour(co+1);
} 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2021-05-23T11:33:10.573

评论中已经讨论了 std::initializer_list (C++11)。我提到了迭代枚举的示例。

或 std::initializer_list 和更简单的语法：

```
enum E {
    E1 = 4,
    E2 = 8,
    // ..
    En
};

constexpr std::initializer_list<E> all_E = {E1, E2, /*..*/ En}; 
```

**进而**

```
for (auto e : all_E) {
    // Do job with e
} 
```

参考[链接](https://riptutorial.com/cplusplus/example/13085/iteration-over-an-enum#:%7E:text=C%2B%2B%20Iteration%20over%20an%20enum&text=There%20is%20no%20built%2Din%20to%20iterate%20over%20enumeration.)

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2016-02-13T23:35:07.137

对于 MS 编译器：

```
#define inc_enum(i) ((decltype(i)) ((int)i + 1))

enum enumtype { one, two, three, count};
for(enumtype i = one; i < count; i = inc_enum(i))
{ 
    dostuff(i); 
} 
```

注意：这比简单的模板化自定义迭代器答案要少得多。

您可以通过使用`typeof`而不是使用 GCC 来使其与 GCC 一起工作`decltype`，但我目前没有方便的编译器来确保它可以编译。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2019-11-21T20:39:13.363

在 Bjarne Stroustrup 的 C++ 编程语言书中，您可以读到他提议`operator++`为您的特定`enum`. `enum`是用户定义的类型，语言中存在针对这些特定情况的重载运算符。

您将能够编写以下代码：

```
#include <iostream>
enum class Colors{red, green, blue};
Colors& operator++(Colors &c, int)
{
     switch(c)
     {
           case Colors::red:
               return c=Colors::green;
           case Colors::green:
               return c=Colors::blue;
           case Colors::blue:
               return c=Colors::red; // managing overflow
           default:
               throw std::exception(); // or do anything else to manage the error...
     }
}

int main()
{
    Colors c = Colors::red;
    // casting in int just for convenience of output. 
    std::cout << (int)c++ << std::endl;
    std::cout << (int)c++ << std::endl;
    std::cout << (int)c++ << std::endl;
    std::cout << (int)c++ << std::endl;
    std::cout << (int)c++ << std::endl;
    return 0;
} 
```

测试代码：[http ://cpp.sh/357gb](http://cpp.sh/357gb)

请注意我正在使用`enum class`. 代码`enum`也可以正常工作。但我更喜欢`enum class`它们，因为它们是强类型的，可以防止我们在编译时出错。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2016-07-31T13:58:29.893

如果您知道枚举值是连续的，例如 Qt:Key 枚举，您可以：

```
Qt::Key shortcut_key = Qt::Key_0;
for (int idx = 0; etc...) {
    ....
    if (shortcut_key <= Qt::Key_9) {
        fileMenu->addAction("abc", this, SLOT(onNewTab()),
                            QKeySequence(Qt::CTRL + shortcut_key));
        shortcut_key = (Qt::Key) (shortcut_key + 1);
    }
} 
```

它按预期工作。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2019-07-17T04:37:30.190

```
typedef enum{
    first = 2,
    second = 6,
    third = 17
}MyEnum;

static const int enumItems[] = {
    first,
    second,
    third
}

static const int EnumLength = sizeof(enumItems) / sizeof(int);

for(int i = 0; i < EnumLength; i++){
    //Do something with enumItems[i]
} 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2020-07-20T17:40:09.723

扩展@Eponymous 的答案：很好，但不提供通用语法。这是我想出的：

```
// Common/EnumTools.h
#pragma once

#include <array>

namespace Common {

// Here we forward-declare metafunction for mapping enums to their values.
// Since C++<23 doesn't have reflection, you have to populate it yourself :-(
// Usage: After declaring enum class E, add this overload in the namespace of E:
// inline constexpr auto allValuesArray(const E&, Commob::EnumAllValuesTag) { return std::array{E::foo, E::bar}; }
// Then `AllValues<NS::E>` will call `allValuesArray(NS::E{}, EnumAllValuesTag)` which will resolve
// by ADL.
// Just be sure to keep it sync'd with your enum!

// Here's what you want to use in, e.g., loops: "for (auto val : Common::AllValues<MyEnum>) {"

struct EnumAllValuesTag {}; // So your allValuesArray function is clearly associated with this header.

template <typename Enum>
static inline constexpr auto AllValues = allValuesArray(Enum{}, EnumAllValuesTag{});
// ^ Just "constexpr auto" or "constexpr std::array<Enum, allValuesArray(Enum{}, EnumAllValuesTag{}).size()>" didn't work on all compilers I'm using, but this did.

} // namespace Common 
```

然后在您的命名空间中：

```
#include "Common/EnumTools.h"

namespace MyNamespace {

enum class MyEnum {
    foo,
    bar = 4,
    baz = 42,
};

// Making this not have to be in the `Common` namespace took some thinking,
// but is a critical feature since otherwise there's no hope in keeping it sync'd with the enum.
inline constexpr auto allValuesArray(const MyEnum&, Common::EnumAllValuesTag) {
    return std::array{ MyEnum::foo, MyEnum::bar, MyEnum::baz };
}

} // namespace MyNamespace 
```

然后在任何需要使用它的地方：

```
for (const auto& e : Common::AllValues<MyNamespace::MyEnum>) { ... } 
```

所以即使你已经 typedef 了：

```
namespace YourNS {
using E = MyNamespace::MyEnum;
} // namespace YourNS

for (const auto& e : Common::AllValues<YourNS::E>) { ... } 
```

除了查看此页面的每个人都想要的实际语言功能之外，我想不出比这更好的了。

未来的工作：

1.  您应该能够添加一个`constexpr`函数（以及一个元函数）来过滤`Common::AllValues<E>`，以便`Common::AllDistinctValues<E>`为具有重复数值（如`enum { foo = 0, bar = 0 };`.
2.  我敢打赌，有一种方法可以使用编译器的`switch`-covers-all- -values`enum`来编写`allValuesArray`，这样如果枚举添加了一个值，它就会出错。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2020-09-30T23:51:59.670

优点：枚举可以按您喜欢的任何顺序具有您喜欢的任何值，并且迭代它们仍然很容易。名称和值在第一个#define 中定义一次。

缺点：如果你在工作中使用它，你需要一个完整的段落来向你的同事解释它。而且，必须声明内存以给循环提供一些可以迭代的内容很烦人，但我不知道有一种解决方法不会将您限制在具有相邻值的枚举（如果枚举总是具有相邻值，则无论如何，枚举可能不会给你买那么多东西。）

```
//create a, b, c, d as 0, 5, 6, 7
#define LIST x(a) x(b,=5) x(c) x(d)
#define x(n, ...) n __VA_ARGS__,
enum MyEnum {LIST}; //define the enum
#undef x //needed
#define x(n,...) n ,
MyEnum myWalkableEnum[] {LIST}; //define an iterable list of enum values
#undef x //neatness

int main()
{
  std::cout << d;
  for (auto z : myWalkableEnum)
    std::cout << z;
}
//outputs 70567 
```

用未定义的宏包装器声明一个列表，然后在各种情况下以不同的方式定义包装器的技巧，除此之外还有很多应用。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2021-10-29T20:03:45.287

这里有一些非常易读和易于理解的方法，适用于*弱类型*C 和 C++ 正则`enum`s，*以及* *强类型*C++ `enum class`es。

我建议用`-Wall -Wextra -Werror`. `switch`这为您提供了额外的安全性，如果您在编译器*抛出编译时错误*的情况下忘记覆盖任何枚举值！这迫使您保持枚举定义和切换案例同步，这是您的代码的额外安全措施。只要您：

1.  涵盖您案例中的*所有*枚举值，并且`switch`
2.  没有`default`开关盒。
3.  `-Wall -Wextra -Werror`用旗帜建造。

我建议您遵循所有这 3 点，因为这是一种很好的做法并且可以创建更好的代码。

## 1\. 对于标准的*弱类型*C 或 C++ `enum`：

**C 定义（这也是有效的 C++）：**

```
typedef enum my_error_type_e 
{
    MY_ERROR_TYPE_SOMETHING_1 = 0,
    MY_ERROR_TYPE_SOMETHING_2,
    MY_ERROR_TYPE_SOMETHING_3,
    MY_ERROR_TYPE_SOMETHING_4,
    MY_ERROR_TYPE_SOMETHING_5,
    /// Not a valid value; this is the number of members in this enum
    MY_ERROR_TYPE_count,
    // helpers for iterating over the enum
    MY_ERROR_TYPE_begin = 0,
    MY_ERROR_TYPE_end = MY_ERROR_TYPE_count,
} my_error_type_t; 
```

**C++ 定义：**

```
enum my_error_type_t 
{
    MY_ERROR_TYPE_SOMETHING_1 = 0,
    MY_ERROR_TYPE_SOMETHING_2,
    MY_ERROR_TYPE_SOMETHING_3,
    MY_ERROR_TYPE_SOMETHING_4,
    MY_ERROR_TYPE_SOMETHING_5,
    /// Not a valid value; this is the number of members in this enum
    MY_ERROR_TYPE_count,
    // helpers for iterating over the enum
    MY_ERROR_TYPE_begin = 0,
    MY_ERROR_TYPE_end = MY_ERROR_TYPE_count,
}; 
```

***在这个弱类型*枚举上的C 或 C++ 迭代：**

*注意：不允许*通过做增加枚举——甚至在 C 风格的枚举上也不行，所以我们必须这样`my_error_type++`做：但是请注意，这*是*允许的，因为这个弱枚举会自动隐式转换为here 以使此添加成为可能，而无需手动将其转换为 int ，如下所示：*`my_error_type = (my_error_type_t)(my_error_type + 1)``my_error_type + 1` *`int``my_error_type = (my_error_type_t)((int)my_error_type + 1)`**

 **```
for (my_error_type_t my_error_type = MY_ERROR_TYPE_begin; 
        my_error_type < MY_ERROR_TYPE_end;
        my_error_type = (my_error_type_t)(my_error_type + 1)) 
{
    switch (my_error_type) 
    {
        case MY_ERROR_TYPE_SOMETHING_1:
            break;
        case MY_ERROR_TYPE_SOMETHING_2:
            break;
        case MY_ERROR_TYPE_SOMETHING_3:
            break;
        case MY_ERROR_TYPE_SOMETHING_4:
            break;
        case MY_ERROR_TYPE_SOMETHING_5:
            break;
        case MY_ERROR_TYPE_count:
            // This case will never be reached.
            break;
    }
} 
```

## 2\. 对于*作用域*的*强类型*C++ `enum class`：

**C++ 定义：**

```
enum class my_error_type_t
{
    SOMETHING_1 = 0,
    SOMETHING_2,
    SOMETHING_3,
    SOMETHING_4,
    SOMETHING_5,
    /// Not a valid value; this is the number of members in this enum
    count,
    // helpers for iterating over the enum
    begin = 0,
    end = count,
}; 
```

***在这个强类型*枚举上的C++ 迭代：**

请注意强制增加变量所需的额外强制转换`(size_t)`（或者也可以接受）！我也选择在这里使用 C++ 风格的演员表，但是如上所述的 C 风格演员表也可以。`(int)``enum class``static_cast<my_error_type_t>``(my_error_type_t)`

```
for (my_error_type_t my_error_type = my_error_type_t::begin; 
        my_error_type < my_error_type_t::end;
        my_error_type = static_cast<my_error_type_t>((size_t)my_error_type + 1)) 
{
    switch (my_error_type) 
    {
        case my_error_type_t::SOMETHING_1:
            break;
        case my_error_type_t::SOMETHING_2:
            break;
        case my_error_type_t::SOMETHING_3:
            break;
        case my_error_type_t::SOMETHING_4:
            break;
        case my_error_type_t::SOMETHING_5:
            break;
        case my_error_type_t::count:
            // This case will never be reached.
            break;
    }
} 
```

还要注意范围。在 C++*强类型中* `enum class`，我曾经`my_error_type_t::`访问每个作用域`enum class`成员。但是，在 C 风格的*弱类型*正则`enum`中，可以实现非常相似的作用域，正如我所演示的，只需在每个`enum`成员名称前加上`MY_ERROR_TYPE_`. 因此，C++*强类型* `enum class`添加作用域这一事实并没有真正增加太多价值——这实际上只是个人偏好。*C++强类型* 具有额外的类型安全性这一事实`enum class`也有利有弊。在某些情况下它可能会对您有所帮助，但它肯定会使增加枚举并对其进行迭代变得很痛苦，老实说，这意味着它正在完成它的工作。通过使其*更难*为了像整数一样增加作用域`enum class`变量，C++*强类型* *完全按照它的设计目的*`enum class`进行。您是否*想要*这种行为取决于您。就个人而言，我经常*不*希望这种行为，因此即使在 C++ 中，我也更喜欢使用 C 风格的枚举并不少见。

 ***## 也可以看看：

1.  [我的回答][有没有办法在 c++11 中按索引初始化向量？](https://stackoverflow.com/a/70889843/4561887)
2.  [我的问答][在 C++ 中迭代枚举类的常用方法是什么？](https://stackoverflow.com/questions/69762598/what-are-commonly-used-ways-to-iterate-over-an-enum-class-in-c/69762682#69762682)
3.  我对C++ 中`enum class`es（*强类型*枚举）和常规`enum`s（*弱类型*枚举）之间的一些差异的回答：[如何自动将强类型枚举转换为 int？](https://stackoverflow.com/questions/8357240/how-to-automatically-convert-strongly-typed-enum-into-int/65014885#65014885)
4.  [`-Wall -Wextra -Werror`](https://github.com/ElectricRCAircraftGuy/eRCaGuy_hello_world#additional-c-and-c-build-notes-ex-wgcc-or-clang-compilers)来自我的[eRCaGuy_hello_world 存储库的关于](https://github.com/ElectricRCAircraftGuy/eRCaGuy_hello_world)[和其他构建选项](https://github.com/ElectricRCAircraftGuy/eRCaGuy_hello_world#additional-c-and-c-build-notes-ex-wgcc-or-clang-compilers)[的一些个人笔记](https://github.com/ElectricRCAircraftGuy/eRCaGuy_hello_world#additional-c-and-c-build-notes-ex-wgcc-or-clang-compilers)。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2021-12-22T13:22:24.963

使用 lambda，我发现这是循环枚举的最佳（现代）方式。这极大地提高了抽象性。甚至可以使其成为模板，因此它适用于任何枚举。此代码既不会给您带来 clang(-tidy) 的问题。

```
#include <functional>

/// @brief Loop over all enum values where the last enum value is the invalid one
void forEachAction(std::function<void(Enum)> &&doThis) {
    for (int value = 0; value = static_cast<int>(Enum::LastValue); ++value ) {
        doThis(static_cast<Enum>(value ));
    }
}

...

forEachAction([this](Enum value) {
    ...  // what you want to execute for every enum
}); 
```

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2021-12-27T07:38:15.560

将变量转换为 an`int&`可以让您在保持类型可读的同时递增。

```
#include <iostream>

enum MyEnum
{
    ONE,
    TWO,
    THREE,
    FOUR,
};

int main()
{
    for (MyEnum v = MyEnum::ONE; v <= MyEnum::FOUR; ++(int&)v)
    {
        std::cout<<v<<std::endl;
    }

    return 0;
} 
```

```
0
1
2
3 
```

* * *

## 回答 #25

> 赞同：-1
> 
> 时间：2021-01-21T19:30:02.677

大多数解决方案都基于 (MIN, MAX) 范围内的循环，但忽略了枚举中可能存在漏洞的事实。

我的建议是：

```
 for (int i = MYTYPE_MIN; i <= MYTYPE_MAX; i++) {
            if (MYTYPE_IsValid(i)) {
                MYTYPE value = (MYTYPE)i;
                // DoStuff(value)
            }   
        } 
```

* * *

## 回答 #26

> 赞同：-2
> 
> 时间：2008-11-04T14:12:42.343

C++ 没有自省功能，因此您无法在运行时确定这种事情。

* * *

## 回答 #27

> 赞同：-3
> 
> 时间：2018-03-15T09:51:07.407

只需创建一个整数数组并遍历该数组，但将最后一个元素设为 -1 并将其用于退出条件。

如果枚举是：

```
enum MyEnumType{Hay=12,Grass=42,Beer=39}; 
```

然后创建数组：

```
int Array[] = {Hay,Grass,Beer,-1};

for (int h = 0; Array[h] != -1; h++){
  doStuff( (MyEnumType) Array[h] );
} 
```

这不会破坏表示中的整数，只要 -1 检查当然不与其中一个元素发生冲突。

# java - Tomcat - 多个 webapps 文件夹

> ID：261974
> 
> 赞同：5
> 
> 时间：2008-11-04T13:58:29.843
> 
> 标签：java, deployment, tomcat

是否可以有多个文件夹，我可以在其中放置要部署的应用程序？

这些是如何定义的？

是否可以将一个文件夹限制为“domain.com”的应用程序而不是其他域。

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-04T14:18:14.797

看看`conf/server.xml`：

```
 <Host name="localhost" debug="0" appBase="webapps"
   unpackWARs="true" autoDeploy="true"
   xmlValidation="false" xmlNamespaceAware="false"> 
```

您可以在元素中嵌套`<Host>`元素，`<Engine>`并有不同的元素对应于不同的虚拟主机、不同`appBase`的 's 等。

[这是关于`<Host`> 元素的文档。](http://tomcat.apache.org/tomcat-5.5-doc/config/host.html)

# javascript - 在 Internet Explorer 中打开弹出窗口的奇怪行为

> ID：261978
> 
> 赞同：1
> 
> 时间：2008-11-04T14:06:38.393
> 
> 标签：javascript, internet-explorer, popup, microsoft-dynamics

我有以下 JavaScript 代码可以在 Internet Explorer 中弹出一个窗口。该代码是从 Microsoft CRM 模式对话框中的页面执行的。（RequestID 是一个在测试系统中始终相同的字符串 - 目前它包含“abcdefg” - 没有引号）。

```
var cancelUrl = "CancelRequest.aspx?RequestID=" + RequestID;
alert("About to open a window.\n\n" + cancelUrl);
window.open(cancelUrl);
alert("Window opened"); 
```

我希望看到一条消息，告诉我我即将打开一个窗口。然后，我希望看到一个打开的窗口，并收到有关该窗口已打开的另一条消息。我真的不在乎最后两个事件的顺序；警报在那里，所以我知道代码已被执行。

我有两台电脑和一台虚拟电脑。全部运行IE7。在 Windows 2003 VPC 上，消息和弹窗每次都会出现。

在 Vista PC 和 WinXP PC 上，消息会出现，但弹出窗口只是间歇性地出现。（我认为这可能也是 Vista PC 上的情况）。

这三个在 IE 中具有相同的设置。所有人都禁用了 IE 弹出窗口阻止程序，并且没有安装其他弹出窗口阻止程序。

任何人都可以对此有所了解吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-07T17:00:47.840

啊，我想我明白了......在描述中错过了它......

您正**试图从****IE**中**的模态对话框**打开一个非模态窗口。

 **这个 AFAIK，不应该工作。

尝试打开另一个模式窗口。

实际上，您是在说...

在窗口 A 上，打开模态窗口 B，现在打开非模态窗口 C，这实际上是无效的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-04T14:15:38.110

这段代码很简单。使用调试器，看看发生了什么。

使用 FireFox 或 Chrome 检查该站点，他们有 JS 调试器。

**编辑：**

添加 try/catch 块`window.open()`，看看那里是否有异常。

**编辑2：**

我现在看到您将字符作为 RequestId 发送。您应该检查该 URL 是否可以处理这种值。由于名称是`RequestId`我会说应该只有数字参数的可能性很大。如果这是正确的，那么当您尝试打开窗口时可能会发生服务器端崩溃，然后什么也没有发生。设置 try/catch 块和测试的更多理由。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-04T16:43:02.727

您可能想尝试适用于 IE 的 Firebug lite。

[http://getfirebug.com/lite.html](http://getfirebug.com/lite.html)

其他人提到的 try/catch 也是一个好主意。我认为。

此外，弹出窗口是否有可能尝试使用已经打开但已最小化的窗口。所以它似乎没有工作，但它真的只是重新加载最小化的窗口？

# javascript - 在 Javascript 中摆脱困境

> ID：261985
> 
> 赞同：1
> 
> 时间：2008-11-04T14:10:50.350
> 
> 标签：javascript, eval, escaping

我有以下

```
var id='123';

newDiv.innerHTML = "<a href=\"#\" onclick=\" TestFunction('"+id+"', false);\"></a>"; 
```

`<a href="#" onclick="return Testfunction('123',false);"></a>`在我的 HTML 中呈现。

我遇到的问题是我希望调用 TestFunction 方法，并在我的函数 StepTwo(string, boolean) 中用作字符串参数，理想情况下，它最终会出现在实时 HTML 中，如图所示......

```
<a href="#" onclick="StepTwo("TestFunction('123',false)",true)"></a> 
```

注意这里的 TestFunction 是一个字符串（它在 StepTwo 中使用 eval 执行）。

我试图将我的 JS 格式化为：

```
newDiv.innerHTML = "<a href=\"#\" onclick=\"StepTwo(\"TestFunction('"+id+"', false);\",true)\"></a>"; 
```

但是，虽然这在我的 IDE 中似乎是正确的，但在呈现的 HTML 中，它的乱码令人难以置信。

如果有人能指出我正确的方向，将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-04T14:20:59.923

互联网上最大的资本失败之一是通过将字符串粘合在一起在 javascript 中创建 html。

```
var mya = document.createElement("a");
mya.href="#"; 
mya.onclick = function(){ 
    StepTwo(function(){ 
        TestFunction('123', false ); 
    }, true );   
};
newDiv.innerHTML = ""; 
newDiv.appendChild(mya); 
```

这消除了对任何花哨的转义东西的需要。

（我可能应该以不同的方式执行“onclick”，但这应该可行，我正在努力不只是使用 jQuery 代码来做所有事情）

下面是我在 jQuery 中的做法：

```
jQuery(function($){ 

  var container = $("#container"); 
  var link = document.createElement("a"); /* faster than  $("<a></a>"); */
  $(link).attr("href", "Something ( or # )" ); 
  $(link).click( function(){ 
       var doStepTwo = function()
       { 
            TestFunction('123', true ); 
       };
       StepTwo( doStepTwo, false );  /* StepTwo -> doStepTwo -> TestFunction() */
  });
  container.append(link); 
}); 
```

### 在Javascript中将字符串粘合在一起没有很好的借口

它所做的只是增加了将 html 解析回 dom 结构的开销，并**增加了基于****XSS**的损坏 HTML 的潜力。即使是*心爱的谷歌*在他们的一些广告脚本中也犯了这个错误，并且在我见过的许多情况下都导致了*史诗般的失败*（他们不想知道）

**我不明白 Javascript**是唯一的借口，这**不是**一个好借口。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-04T14:15:01.527

您应该使用`&quot;`not`"`或`\"`在带有双引号的 HTML 字符串中使用。

`NewDiv.innerHTML = "<a href=\"#\" onclick=\"StepTwo(&quot;TestFunction('"+id+"', false);&quot;,true)\"></a>";`

可能有更好的方法来做到这一点 - 任何时候你发现自己在使用`eval()`你应该退后一步寻找不同的解决方案。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-04T14:15:15.317

尝试使用 " 代替 \”

newDiv.innerHTML = "<a href="#"...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-04T15:11:16.700

您声称 eval 在这里是正确的做法。我不确定。

您是否考虑过这种方法：

```
<a href="#" onclick="StepTwo(TestFunction,['123',false],true)"></a> 
```

在你的 StepTwo 函数中

```
function StepTwo(func,args,flag){
    //do what ever you do with the flag
    //instead of eval use the function.apply to call the function.
    func.apply(args);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-04T14:15:16.503

您可以使用 DOM 方法创建 a 元素并附加到 click 事件。

一个 Javascript 框架（如无处不在的 jQuery）将使这变得容易得多。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-04T14:16:08.107

1.  您需要交替使用“和”。

2.  由于 Javascript 的灵活输入，您可能不需要 123 左右的引号。在不带引号的情况下传递它，但将其视为 TestFunction 中的字符串。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-04T14:16:26.267

您最大的问题是使用 eval，它会导致许多潜在问题，因此找到替代解决方案几乎总是更好。

你的直接问题是你真正拥有的是

```
<a href="#" onclick="StepTwo("></a> 
```

作为`"`onclick 属性开始后的下一个，将其关闭。使用“ 正如其他人所建议的那样。并且不要使用评估。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-04T14:24:46.017

最好的方法是用 . 创建元素`document.createElement`，但如果你不愿意，我想你可以做`<a href="#" onclick="StepTwo('TestFunction(\'123\',false)',true)"></a>`或使用`&quot;`.

在您的代码中：

```
newDiv.innerHTML = "<a href=\"#\" onclick=\"StepTwo('TestFunction(\'"+id+"\', false);\',true)\"></a>"; 
```

如果不起作用，请尝试将“ `\'`”更改为“ `\\'`”。

请记住，" 字符用于打开和关闭 HTML 标记上的属性。如果在属性值中使用它，浏览器会将其理解为关闭字符。

示例： `<input type="text" value="foo"bar">`将最终成为`<input type="text" value="foo">`.

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-04T14:29:28.097

嘿伙计们，感谢所有的答案。我发现 quot; 似乎效果最好。

一旦我获得更多声望，我会给你们一些投票！

关于 eval()，您在问题中看到的是正在开发的应用程序的一个非常小的快照。我理解 eval 的困境，但是，这是百万分之一的情况之一，它是当前情况的正确选择。

如果您能看到这些函数的作用（为 stackoverflow 赋予了非常通用的名称），将会更好地理解。

再次感谢！

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-04T15:24:59.047

```
<a href="#" onclick="StepTwo('TestFunction(\'123\', false)', true)">...</a> 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-07-10T00:18:36.077

我知道这已经很老了，但是如果有人在使用 eval 时遇到转义字符串的问题（而且你绝对必须使用 eval），我有办法避免问题。

```
var html = '<a href="#\" onclick=" TestFunction(\''+id+'\', false);"></a>';
eval('(function(div, html){div.innerHTML = html;})')(newDiv, html); 
```

那么，这里发生了什么？

1.  `eval`创建一个包含两个参数的函数，`div`并`html`返回它。
2.  该函数立即使用 eval 函数右侧的参数运行。这基本上就像一个IIFE。

在这种情况下

```
var myNewMethod = eval('(function(div, html){div.innerHTML = html;})'); 
```

基本上是一样的：

```
var myNewMethod = function(div, html){div.innerHTML = html;} 
```

然后我们就这样做了：

```
myNewMethod(newDiv, html); //where html had the string containing markup 
```

我建议不要使用 eval。如果无法避免，或者如果您控制所有输入并且没有注入风险，那么这将在字符串转义成为问题的情况下有所帮助。

我也倾向于使用`Function`，但它不再安全。这是我使用的片段：

```
 var feval = function(code) {
    return (new Function(code))();
} 
```

# jquery - 使用 jQuery 修改 HTML 表格的结构

> ID：261998
> 
> 赞同：3
> 
> 时间：2008-11-04T14:14:52.853
> 
> 标签：jquery, html, jsf

我有一个元素列表（以下示例中的*X*）显示在 HTML 表的行或列中。

从 HTML 代码的角度来看，我有（水平显示）：

```
<table id="myTable">
  <tr>
    <td>A</td>
    <td>B</td>
    <td>C</td>
    ...
  </tr>
</table> 
```

或（垂直显示）：

```
<table id="myTable">
  <tr>
    <td>A</td>
  </tr>
  <tr>
    <td>B</td>
  </tr>
  <tr>
    <td>C</td>
  </tr>
  ...
</table> 
```

此 HTML 代码由 JSF 组件（称为`<h:selectManyCheckboxes/>`）生成，因此，我无法控制此 HTML 代码。

但是，我想在 2 列中显示我的元素列表。换句话说，我的表格的 HTML 代码将是这样的：

```
<table id="myTable">
  <tr>
    <td>A</td>
    <td>B</td>
  </tr>
  <tr>
    <td>C</td>
    <td>D</td>
  </tr>
  ...
</table> 
```

我怎样才能使用 jQuery 做到这一点？

在此先感谢您的帮助。

ps：如果你需要知道，X实际上是一个输入和一个标签，即：

```
<td><input .../><label .../></td> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-04T15:11:53.220

有趣的练习。这可以满足您的要求，但它可能不是您想要的。但它会告诉你如何做到这一点。你可以

将其调整到您期望的工作方式。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" >
<head>
    <title>Example of restructuring tables</title>
    <script src="Scripts/jquery-1.2.6.commented.js"></script>
</head>
<!--<body><table id="Table1">
  <tr>
    <td>1</td>
    <td>2</td>
    <td>3</td>
    <td>4</td>
  </tr>
</table>-->
<table id="myTable">
  <tr>
    <td>1</td>
  </tr>
  <tr>
    <td>2</td>
  </tr>
  <tr>
    <td>3</td>
  </tr>
  <tr>
    <td>4</td>
  </tr>
</table>
<script type="text/javascript">
    $(document).ready(function() {
        debugger;
        var tds = $("#myTable tr td"); // gets all td elements in the table with id myTable
        var col1 = $("<tr></tr>"); // holds our first row's columns
        var col2 = $("<tr></tr>"); // holds our second row's columns
        var halfway = Math.ceil(tds.length / 2);
        // add the first half of our td's to the first row, the second half to the second
        for (var i = 0; i < tds.length; i++) {
            if (i < halfway)
                col1.append(tds[i]);
            else
                col2.append(tds[i]);
        }
        // clear out the clutter from the table
        $("#myTable").children().remove();
        // add our two rows
        $("#myTable").append(col1);
        $("#myTable").append(col2);
    });
</script>
</body>
</html> 
```

* * *

看，您希望它如何最终将所有内容放在两行中的示例，但您的问题是“两列”。我做了两行只是因为它更容易。您只需要修改 for 循环，使其更符合这条线

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-04T17:34:40.187

鉴于您提供的其他信息，我认为这就是您想要的。它遍历表格，将单元格从每隔一行移动到前一行...

```
var idx = 1;
var row, next;
while((row = $('#myTable tr:nth-child(' + idx++ + ')')).length) {
    if((next = $('#myTable tr:nth-child(' + idx + ')')).length) {
        row.append(next.find('td'));
        next.remove();
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-04T14:37:19.453

假设您从每一行中的一个单元格开始，并且每个单元格都有一个标签和一个输入，那么我认为您想要这样的东西：

```
$('#myTable tr').each(function() {
    $('<td/>').append( 
      $(this).find('td input') 
    ).appendTo(this);
  }); 
```****************