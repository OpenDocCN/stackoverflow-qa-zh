# StackOverflow 问答 11686000-11686999

# mysql - SQL (MySQL) 为报告生成连续日期/月份

> ID：11686003
> 
> 赞同：1
> 
> 时间：2012-07-27T10:29:14.233
> 
> 标签：mysql, sql, date, group-by

我正在执行迁移任务，将 Java 应用程序从 Oracle Datastore 迁移到 MySql 5。

你可以想象一些查询需要重写。一切顺利，直到我来到报告模块。希望大家能给我一些提示。

很快我就有了一张桌子：（说桌子名称“Foo”）

```
+-------------+-------------+
|             |             |
| d (datetime)| v (number)  |
+-------------+-------------+
| 2000-01-01  |     3       |
| 2000-01-11  |     2       |
| 2002-07-01  |     1       |
+-------------+-------------+ 
```

到目前为止我做了什么：

当用户给出 startdate、enddate 作为参数时，我按天和按月生成总和报告：

例如开始日期 2000-01-01，结束日期：2003-01-01

```
+-------------+-------------+
| day         | Sum         |
+-------------+-------------+
| 2000-01-01  |     3       |
| 2000-01-11  |     2       |
| 2002-07-01  |     1       |
+-------------+-------------+

+-------------+-------------+
| Month       | Sum         |
+-------------+-------------+
| 2000-01     |     5       |
| 2002-07     |     1       |
+-------------+-------------+ 
```

但要求是，如果日期不在表中，无论如何都要列出日/月，总和 = 0。喜欢：

```
+-------------+-------------+
| Month       | Sum         |
+-------------+-------------+
| 2000-01     |     5       |
| 2000-02     |     0       |
| 2000-03     |     0       |
| 2000-04     |     0       |
| 2000-05     |     0       |
|  ...        |    ...      |
| 2002-07     |     1       |
|  ...        |     0       |
+-------------+-------------+ 
```

这是通过 Oracle 实现的，但我被 Mysql 卡住了。anyboy 可以给出一些提示，更好地使用示例代码，如何用 mySql 实现它？

谢谢你。

# objective-c - UIButton 没有调用目标方法

> ID：11686004
> 
> 赞同：1
> 
> 时间：2012-07-27T10:29:15.393
> 
> 标签：objective-c, uibutton

我有以下代码：

```
UIImage *registerImg = [UIImage imageNamed:@"register_button_normal"];
CGFloat registerOffsetX = (view.frame.size.width - registerImg.size.width) / 2;

UIButton *registerBtnTwo = [[UIButton alloc] init];
registerBtnTwo.frame = CGRectMake(registerOffsetX, 111, registerImg.size.width, registerImg.size.height);

[registerBtnTwo setBackgroundImage:registerImg forState:UIControlStateNormal];
[registerBtnTwo addTarget:self action:@selector(submitRegister) forControlEvents:UIControlEventTouchUpInside];
[registerPanel addSubview:registerBtnTwo];
[registerBtnTwo release]; 
```

我`- (void)submitRegister;`在类标题中作为实例方法；

问题是没有触发事件，因为我的 submitRegister 实现中有 NSLog

我试过的：

```
1\. UIButton *registerBtnTwo = [UIButton buttonWithType:UIButtonTypeCustom];

2\. UIButton *registerBtnTwo = [[UIButton alloc] initWithFrame:frame]; 
```

编辑 1：我将当前视图控制器添加到我的 navigationController 中的是谁？

```
if ( row == kLoginRegisterIndex ) {
    login = [[LoginRegisterVC alloc] init];
    [self.navigationController pushViewController:login animated:YES];
} 
```

编辑2：

```
UIView *registerPanel = [[UIView alloc] initWithFrame:frame];
registerPanel.backgroundColor = [UIColor colorWithPatternImage:image]; 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T11:15:01.233

尝试改变

```
[registerBtnTwo addTarget:self action:@selector(submitRegister) forControlEvents:UIControlEventTouchUpInside]; 
```

到

```
[registerBtnTwo addTarget:self action:@selector(submitRegister:) forControlEvents:UIControlEventTouchUpInside]; 
```

方法签名是`submitRegister:`（不是`submitRegister`）。您不需要在标头中声明该方法。

如果这无助于检查主机视图的框架。当按钮在框架之外时，它可以显示，但不接受触摸。

我不明白您在编辑中要问什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T08:48:17.053

问题是父视图是 UIImageView ，默认情况下 userInteractionEnabled = NO;

# objective-c - 使用搜索栏搜索表格视图时出现 NCFString 错误

> ID：11686005
> 
> 赞同：0
> 
> 时间：2012-07-27T10:29:16.097
> 
> 标签：objective-c, xcode

我有一个从 json 字符串解析的表格视图。一切都很好。如果我在我的搜索栏中输入一个字符，我得到这个错误`'-[__NSCFString countByEnumeratingWithState:objects:count:]: unrecognized selector sent to instance 0x1d52ac50'`下面是代码。如果下面的变量名数据是 NSMutableArray。你们能帮帮我吗。

```
- (BOOL)searchDisplayController:(UISearchDisplayController *)controllershouldReloadTableForSearchString:(NSString *)searchString
    {
[searchData removeAllObjects];

NSArray *group;
for(group in nameData)
{
    NSLog(@"wat am i doing here:%@",group);
    NSMutableArray *newGroup = [[NSMutableArray alloc] init];
    NSString *element;

    for(element in group)
    {
        NSRange range = [element rangeOfString:searchString options:NSCaseInsensitiveSearch];

        if (range.length > 0) {
            [newGroup addObject:element];
        }
    }

    if ([newGroup count] > 0) {
        [searchData addObject:newGroup];
    }

}

return YES;
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T10:59:29.620

请查看此代码

```
 - (BOOL)searchDisplayController:(UISearchDisplayController *)controller shouldReloadTableForSearchString:(NSString *)searchString
{
    NSMutableArray *array=[[NSMutableArray alloc]init];
    NSDictionary *naming= [self.friendsDictionary objectForKey:@"data"];
    NSLog(@"ggg %@",[self.friendsDictionary objectForKey:@"data"]);
    for(int i =0 ; i< [[self.friendsDictionary objectForKey:@"data"] count]; i++){
        [array addObject:[[[self.friendsDictionary objectForKey:@"data"] objectAtIndex:i] objectForKey:@"name"]];
    }
    NSLog(@"Array %@", array);

    if(self.searchDisplayController.searchBar.text.length>0) 
    {
        NSString *strSearchText = self.searchDisplayController.searchBar.text;
        NSMutableArray *group = [[NSMutableArray alloc]init];
        for (int i=0; i<array.count; i++) {

            NSString *strData = [array objectAtIndex:i]; 
              NSLog(@"string Data:%@",strData);
            NSRange rng = [strData rangeOfString:strSearchText options:NSCaseInsensitiveSearch];
            if(rng.location != NSNotFound)
            {
                if(rng.location== 0)//that is we are checking only the start of the names.
                {
                    [group addObject:strData]; 
                }
            }
        }
        if ([group count] > 0) 
        {
    searchData = [[NSMutableArray alloc] init];
            [searchData addObjectsFromArray:group];
            NSLog(@"Sear %@", searchData);

        }
    } 
    return YES;
  } 
```

# java - “请求”如何表示 JSP 中的 HttpServletRequest 实例？

> ID：11686006
> 
> 赞同：0
> 
> 时间：2012-07-27T10:29:21.303
> 
> 标签：java, jsp

我们经常在 scriptlet 中执行以下操作：

```
<%
   request.getCookies();
%> 
```

谁能告诉我，`request`这里是什么？我知道它代表`HttpServletRequest`但我没有宣布它。我只是不明白这一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-27T10:33:19.187

`request`是JSP代码转化为Servlet类并编译后，在servlet容器生成的代码中为你声明和初始化的类型变量`HttpServletRequest`，也称为JSP中的**[隐式对象之一。](http://www.tutorialspoint.com/jsp/jsp_implicit_objects.htm)**

请注意，多年来在 JSP 中使用 scriptlet 是不好的做法。您应该学习 JSP EL、JSTL，并选择允许将 Java 代码分离为纯标记生成代码的 MVC 框架。

# twitter-bootstrap - 字体真棒，输入类型“提交”

> ID：11686007
> 
> 赞同：224
> 
> 时间：2012-07-27T10:29:23.347
> 
> 标签：twitter-bootstrap, twitter-bootstrap-rails, font-awesome

font-awesome 中似乎没有输入类型“提交”的类。是否可以使用 font-awesome 中的某些类进行按钮输入？我在我的应用程序中为所有按钮（实际上与 twitter-bootstrap 中的“btn”类链接）添加了图标，但无法在“输入类型提交”上添加图标。

或者，如何使用此代码：

```
input#image-button{
    background: #ccc url('icon.png') no-repeat top left;
    padding-left: 16px;
    height: 16px;
} 
```

html:

```
<input type="submit" id="image-button">Text</input> 
```

（我取自[HTML：How to make a submit button with text + image in it？](https://stackoverflow.com/questions/1621891/html-how-to-make-a-submit-button-with-text-image-in-it)）字体真棒？

* * *

## 回答 #1

> 赞同：378
> 
> 时间：2012-08-28T02:48:45.560

使用按钮类型=“提交”而不是输入

```
<button type="submit" class="btn btn-success">
    <i class="fa fa-arrow-circle-right fa-lg"></i> Next
</button> 
```

用于 Font Awesome 3.2.0 使用

```
<button type="submit" class="btn btn-success">
    <i class="icon-circle-arrow-right icon-large"></i> Next
</button> 
```

* * *

## 回答 #2

> 赞同：98
> 
> 时间：2012-07-28T17:39:49.520

# HTML

由于`<input>`元素只显示 value 属性的值，我们只需要操作它：

```
<input type="submit" class="btn fa-input" value="&#xf043; Input"> 
```

我在`&#xf043;`这里使用实体，它对应于 U+F043，Font Awesome 的“色调”符号。

# CSS

然后我们必须对其进行样式设置以使用字体：

```
.fa-input {
  font-family: FontAwesome, 'Helvetica Neue', Helvetica, Arial, sans-serif;
} 
```

这将为我们提供 Font Awesome 中的色调符号和适当字体中的其他文本。

但是，此控件不是像素完美的，因此您可能必须自己调整它。

* * *

## 回答 #3

> 赞同：59
> 
> 时间：2014-08-29T04:34:15.760

您可以使用字体真棒 utf 备忘单

```
<input type="submit" class="btn btn-success" value="&#xf011; Login"/> 
```

这是备忘单的链接 [http://fortawesome.github.io/Font-Awesome/cheatsheet/](http://fortawesome.github.io/Font-Awesome/cheatsheet/)

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2014-03-18T11:32:07.637

`:before`好吧，从技术上讲，不可能让`:after`伪元素对元素`input`起作用

来自[W3C](http://www.w3.org/TR/CSS2/generate.html#before-after-content)：

> ### 12.1 :before 和 :after 伪元素
> 
> 作者使用 :before 和 :after 伪元素指定生成内容的样式和位置。正如它们的名字所示，:before 和 :after 伪元素指定了元素文档树内容之前和之后的内容位置。'content' 属性与这些伪元素一起指定插入的内容。

* * *

所以我有一个项目，我有标签形式的提交按钮，`input`由于某种原因，其他开发人员限制我使用`<button>`标签而不是通常的输入提交按钮，所以我想出了另一个解决方案，将按钮包装在一个`span`集合中到`position: relative;`然后使用`:after`伪绝对定位图标。

> 注意：演示小提琴使用 FontAwesome 3.2.1 的内容代码，因此您可能需要相应地更改`content`属性的值。

**HTML**

```
<span><input type="submit" value="Send" class="btn btn-default" /></span> 
```

**CSS**

```
input[type="submit"] {
    margin: 10px;
    padding-right: 30px;
}

span {
    position: relative;
}

span:after {
    font-family: FontAwesome;
    content: "\f004"; /* Value may need to be changed in newer version of font awesome*/
    font-size: 13px;
    position: absolute;
    right: 20px;
    top: 1px;
    pointer-events: none;
} 
```

`[**Demo**](http://jsfiddle.net/GrBJF/)`

现在这里的一切都是不言自明的，关于一个属性，即`pointer-events: none;`，我使用了它，因为在将鼠标悬停在`:after`伪生成的内容上时，您的按钮不会点击，所以使用 的值`none`将强制点击动作通过该内容.

来自[Mozilla 开发者网络](https://developer.mozilla.org/en-US/docs/Web/CSS/pointer-events)：

> 除了指示该元素不是鼠标事件的目标之外，值 none 还指示鼠标事件“通过”该元素并以该元素“下方”的任何内容为目标。

将心形字体/图标悬停`~~[**Demo**](http://jsfiddle.net/GrBJF/1/)~~`，看看如果你不使用会发生什么`pointer-events: none;`

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2016-02-04T12:14:45.553

您可以使用按钮类`btn-link`和`btn-xs`type `submit`，这将制作一个内部带有图标的小不可见按钮。例子：

```
<button class="btn btn-link btn-xs" type="submit" name="action" value="delete">
    <i class="fa fa-times text-danger"></i>
</button> 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2013-09-15T02:03:07.030

也可以这样

```
<button type="submit" class="icon-search icon-large"></button> 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-10-26T02:33:08.833

通过多次提交，当您需要选择提交的值时，这可以很容易地完成。只需在表单中创建一个隐藏字段并根据单击的按钮更改其值。例如，在表格中，假设您有：

```
<input type="hidden" id="Clicked" name="Clicked" value="" />
<button type="submit" class="btn btn-success ClickCheck" id="Create"> <i class="fa fa-file-pdf-o"> Create Bill</i></button>
<button type="submit" class="btn btn-success ClickCheck" id="Reset"> <i class="fa fa-times"> Reset</i></button>
<button type="submit" class="btn btn-success ClickCheck" id="StoreData"> <i class="fa fa-archive"> Save</i></button> 
```

使用 jQuery：

```
<script type="text/javascript">
    $(document).ready(function()
    {
        $('.ClickCheck').click(function()
        {
            var ButtonID = $(this).attr('id');
            $('#Clicked').val(ButtonID);
        });
    });
</script> 
```

然后您可以检索在“Clicked”帖子变量中单击的按钮的值

# django - Django：在模板中测试 url 正则表达式

> ID：11686010
> 
> 赞同：2
> 
> 时间：2012-07-27T10:29:34.083
> 
> 标签：django, django-templates

我有一个用于不同 url 的相同模板（在这种情况下：`/create/`和`/edit/[PK of an item]`，在 url.py 中命名为“create”和“edit”）。

我想在我的模板中显示不同的东西，这取决于我是在 /edit/ 还是 /create/ 上。

我怎样才能检查这个？ `{% if '/create' in request.path %}`有效，但我想使用一个 url 标签（或等效的，不要让它“硬编码”）。我想做的看起来像（在伪代码中 - 这不起作用）`{% if request.path in url create %} XXX {% endif %}`。

我应该在views.py中进行所有必要的测试，在上下文中发送一个关于它的变量，在模板中测试这个变量吗？就我而言，简单的 url 测试似乎有点重......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-27T10:40:26.787

您可以设置一个[带有 as](https://docs.djangoproject.com/en/1.9/ref/templates/builtins/#url)值的 url。

```
{% url 'some-url-name' arg arg2 as the_url %}

{% if the_url in request.path %} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-27T10:37:39.083

如果有显着差异（不同的形式等），我会说去制作两个视图 - 完全消除模板中的 url 逻辑，也不需要真正的“测试” - 不必检查 request.path/pass url /ETC。

**网址**

```
urlpatterns = patterns('',
    (r'^create/$', create),
    (r'^edit$', edit),
) 
```

**意见**

```
def create(request):
    text = "Create something"
    return render_to_response('same-template.html', {'text': text}, context_instance=RequestContext(request)

def edit(request):
    text = "Edit something"
    return render_to_response('same-template.html', {'text': text}, context_instance=RequestContext(request) 
```

**模板**

```
{% text %} 
```

也可以通过这种方式轻松地通过列表传递多个更改：

**意见**

```
def create(request):
    data = []
    data['text'] = "Create something"
    data['form'] = CreateForm()
    return render_to_response('same-template.html', {'data': data}, context_instance=RequestContext(request)

def edit(request):
    data = []
    data['text'] = "Edit something"
    data['form'] = EditForm()
    return render_to_response('same-template.html', {'data': data}, context_instance=RequestContext(request) 
```

**模板**

```
{% data.text %}
{% data.form %} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-27T10:33:38.530

您可以在视图中执行此操作，或者编写模板标记。

查看 django 片段，这个看起来不错：[http ://djangosnippets.org/snippets/1531/](http://djangosnippets.org/snippets/1531/)

# asp.net-mvc - asp.net razor中是否有类似Eval()的函数？

> ID：11686013
> 
> 赞同：3
> 
> 时间：2012-07-27T10:29:49.523
> 
> 标签：asp.net-mvc, razor, runtime, eval

有没有一种方法可以让我在 Razor 视图中做这样的事情：

```
<h1>Normal razor code</h2>
@Html.Action("NormalRazorCode")

@Eval(" @Html.Action(\"RuntimeEval\") ") 
```

基本上是运行时的 text-to-razor 编译器（例如，它不会像 RazorEngine 那样创建一个全新的视图）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T19:36:50.530

我认为您可以假设视图在编译时存在，并在运行时创建实际文件，这样 ViewEngine 将按照默认方式工作

基本上你可以创建一个`Html.Eval`助手来创建 .cshtml 文件并在使用`Html.Action`或渲染它之后`Html.Partial`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-09-25T20:04:33.723

我想做类似的事情；我将模型数据（在我的控制之下）存储在数据库中，如果我能够在那些包含在页面中时可以“扩展”的字符串中包含 HTML 助手，它将简化我的生活。

主要动机是允许我重用现有的局部视图。

没有`eval`函数，但您可以轻松编写一个扩展方法，该方法将评估您预先选择允许的方法。就我而言，我想评估对`@Html.Partial()`. 这里的示例非常简单 - 它专门针对`@Html.Partial("somePartialView")`调用并将其替换为实际的部分：

```
 public static IHtmlString ExpandHtmlString(
        this HtmlHelper htmlHelper,
        String html)
    {
        if (String.IsNullOrEmpty(html))
            return new HtmlString(html);

        const String IDENTIFY_PARTIAL = @"@Html.Partial\(""([a-zA-Z0-9\-_]*)""\)";

        var partialFinder = new Regex(IDENTIFY_PARTIAL);
        var matches = partialFinder.Matches(html);

        foreach (Match m in matches) {
            var matchedStr = m.Value;
            var viewName = m.Groups[1].Value;
            var partial = htmlHelper.Partial(viewName);

            html = html.Replace(matchedStr, partial.ToHtmlString());
        }

        return new HtmlString(html);
    } 
```

你从你的 Razor 页面调用它：

```
@Html.ExpandHtmlString((String)Model.SomeStringField) 
```

您可以轻松地对此进行扩展，以评估您事先决定接受的一组方法或运算符。

# html - 如何将对象发送到 Scala 视图中

> ID：11686014
> 
> 赞同：1
> 
> 时间：2012-07-27T10:29:52.430
> 
> 标签：html, object, playframework-2.0

如何将对象发送到 Scala 视图中

我已经编写了这些文件，当我尝试构建它们时，我收到了这个错误，这在底部进行了描述

应用程序/视图/时间线/index.scala.html

```
@(token: models.Token)

<!DOCTYPE html>
<html>
  <head>
  </head>
  <body>
    Hello Mr @{token.name}
  </body>
</html> 
```

应用程序/控制器/TimeLine.java

```
public class TimeLine extends Controller {
    public static Result index() {

        Token token = new Token();
        token.name("NInjaaa");

        return ok(views.html.timeline.index.render(token)); //I dont know how to send it...

    }
} 
```

应用程序/模型/Token.java

```
package models;

import play.db.ebean.Model;

public class Token extends Model{

    /**
     * 
     */
    private static final long serialVersionUID = 5629541435986605754L;
    public String name;

} 
```

编译时收到此错误消息

```
[error] /Users/fbranchetti/Dropbox/webproject/timeline/app/controllers/TimeLine.java:17: cannot find symbol
[error] symbol  : method name(java.lang.String)
[error] location: class models.Token
[error]             token.name("NInjaaa");
[error]                  ^
[error] /Users/fbranchetti/Dropbox/webproject/timeline/app/controllers/TimeLine.java:18: render() in views.html.timeline.index cannot be applied to (models.Token)
[error]             return ok(views.html.timeline.index.render(token));
[error]                                                ^
[error] 2 errors
[error] {file:/Users/fbranchetti/Dropbox/webproject/timeline/}TimeLine/compile:compile: javac returned nonzero exit code 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T12:06:10.930

也许你的问题是错误的，但你的`Token`模型应该完全放在文件中

`/app/models/Token.java`

那么它将默认对所有视图可用。在其他情况下，您需要指定类的完整路径，包括包。

```
@(token: some.non.standard.package.Token) 
```

**编辑后：**

您不需要为模型的公共字段编写/使用 getter 和 setter。另外，您需要将 a`token`作为参数传递给视图，该视图只是一个 Scala 函数

```
public static Result index() {
    Token token = new Token();
    token.name = "Ninja";
    return ok(views.html.timeline.index.render(token));
} 
```

# html - 如何禁用CKeditor删除标签

> ID：11686019
> 
> 赞同：3
> 
> 时间：2012-07-27T10:30:07.003
> 
> 标签：html, tags, ckeditor

如何禁用CKeditor删除标签，`<div>`因为它认为不需要但我需要它？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2015-04-15T14:32:23.793

假设您已经像这样定义了您的编辑器：

```
var editor = CKEDITOR.replace( 'editor1' ); 
```

然后添加此配置：

```
editor.config.allowedContent = true; 
```

**或者**

，`config.js`只需添加这个

```
config.allowedContent = true; 
```

# java - 如何使用 JSP/Servlet 将动态表单表映射到模型？

> ID：11686021
> 
> 赞同：2
> 
> 时间：2012-07-27T10:30:12.177
> 
> 标签：java, jsp, servlets, mapping

主要问题是需要使用jsp和servlet。在下表中，可以动态添加和删除行。每行都是一个用户任务。如何仅使用 JSP 和 Servlet 将这些任务表映射到任务列表？（列表）

![表格示例](../Images/1c6570d1b2a42e6df43f22deeb56edc4.png)

# c# - C# 数据库 Form1 = Datagridview, Form2 = Details View UPDATE/EDIT 方法

> ID：11686022
> 
> 赞同：0
> 
> 时间：2012-07-27T10:30:30.683
> 
> 标签：c#, database, sql-server-2008, datagridview, detailsview

在我的 form1 中，我在 datagridview 中有我的 tblContacts，用户可以单击下一个/上一个按钮来浏览数据库。form1 也有一个更新按钮，该按钮通向 form 2，它是来自 form1 的同一数据集的详细信息视图。有人可以告诉我如何使 form2 自动加载 form1 datagridview 已选择的特定联系人的联系方式。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T11:01:36.820

首先：例如，在您的 form2 类中，创建包含来自数据网格的信息的构造函数；

```
public string variable1 {get;set;}
public int variable2 {get;set;}
// as long as they're public, it doesnt matter what you call them, or there type
//(just make sure that you're using the right type, for datagrid's, string is 
//usually fine but you can always convert) 
```

其次：当您创建表单的新实例时，您可以将变量分配给“传递”到您的新表单，就像这样

```
 Form2 form2 = new Form2();
 form2.variable1 = dataSource[rowIndex]["columnName"]
 form2.variable2 = dataSource[rowIndex2]["columnName2"] 
```

要获取选定的行索引，请执行；

```
dataTable.SelectedRows[0].Index; 
```

而不是 [rowIndex]

从这里开始，在您的 form2 中，您可以使用这些值对它们做任何您想做的事情

# windows-installer - 取消隐藏非管理员用户的所有用户和每个用户的单选按钮

> ID：11686026
> 
> 赞同：1
> 
> 时间：2012-07-27T10:30:44.693
> 
> 标签：windows-installer, installshield-2011

我在 Installshield 2011 中创建了一个安装程序。安装类型对话框询问安装应该是 PER USER 还是 ALL USERS 安装。当我以非管理员身份登录时，我只能在 PER USER 模式下安装，如果可以的话。我想要的是，当我以非管理员用户身份运行安装时，它应该将每个用户安装单选按钮显示为选中，并将所有用户单选按钮显示为禁用。但是，这取决于设置为 true 的预定义常量 DISABLE_ALLUSERBTN，因此所有用户和每个用户单选按钮都是隐藏的。（不可见）我希望它们可见，默认选择每个用户选项和所有用户单选按钮禁用。我怎样才能做到这一点？

# java - Java 在列表末尾添加

> ID：11686029
> 
> 赞同：1
> 
> 时间：2012-07-27T10:30:47.317
> 
> 标签：java, arrays

我有一堂书课。我想在列表末尾添加一个元素

```
public class Book {
private String title;
private String authorName;
private double price;

/**
 * @param title
 * @param authorName
 * @param price
 */
public Book(String title, String authorName, double price) {
    setTitle(title);
    setAuthorName(authorName);
    setPrice(price);
}

public String getTitle() {
    return title;
}

public void setTitle(String title) {
    this.title = title;
}

public String getAuthorName() {
    return authorName;
}

public void setAuthorName(String authorName) {
    this.authorName = authorName;
}

public double getPrice() {
    return price;
}

public void setPrice(double price) {
    this.price = Math.abs(price);
} 
```

}

和一个 Booklist 类，它有一个方法 append 将书籍添加到列表中，但我无法弄清楚如何将值输入到列表中

```
public class BookList {

/**
 * books will be stored in an array of strings
 */

private Book[] books;
// *** TODO *** you will need to add more private members variables

public BookList(int N) {
    // TODO Auto-generated method stub  
}

public void append(Book book) throws BookListFull {
    // TODO Auto-generated method stub 
} 
```

}

我想在列表末尾添加元素请帮我怎么做谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T11:08:30.787

**1.**我会鼓励你使用Java 的**Collection 框架**而不是 Arrays。

**2.** Collection 会给你很大的**灵活性和方法，所以你可以用更有表现力的方式处理你的数据。**

`List<Book> list = new ArrayList<Book>;`

**例如：**

```
 List<Book> list = new ArrayList<Book>;

     list.add(new Books(title, authorName, price)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T10:34:26.637

```
public class BookList {
  List<Book> bookList= new ArrayList<Book>();

  ...
  ...
  public void append(Book book) throws BookListFull {
    bookList.add(book); 
  }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-27T10:36:19.623

使用 a`List<Book>`而不是 Book 数组。列表会在需要时自动增长。有关更多信息，请参阅[集合教程](http://docs.oracle.com/javase/tutorial/collections/)。

另外，修复代码中的注释：

```
/**
 * books will be stored in an array of strings <-- of strings?
 */
private Book[] books; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-27T10:45:48.783

如果您因某种原因无法更改 Book[] 书籍的类型（似乎您在构造函数中指定了最大尺寸）：

```
 public void append(Book book) throws BookListFull {

    for (int i = 0; i < this.books.length; i++) {
        if (null == this.books[i]) {
            this.books[i] = book;
            return;
        }
    }
    throw new BookListFull();

} 
```

也许您应该尝试将您的异常名称修改为 BookListFullException 或其他东西 - 只需我的 2 美分。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-27T10:34:58.477

如果您不能使用 a `List<Book>`，则必须将现有数组复制到一个新数组中，该数组具有`books.length +1`：

```
public void append(Book book) throws BookListFull {
    Book[] newArray = new Book[books.length + 1];
    for(int i = 0; i < books.length; i++){
        newArray[i] = books[i];
    }
    newArray[books.length] = book;
    books = newArray;
} 
```

或者更容易，使用及其`List`方法。[`add()`](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/List.html#add%28java.lang.Object%29)[`remove()`](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/List.html#remove%28java.lang.Object%29)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-27T10:36:34.553

尝试这个：

```
public void append(Book book) {
    Book[] buf = this.books;
    this.books = new Book[this.books.length + 1];
    for(int i = 0; i < buf.length; i++)
        this.books[i] = buf[i];
    this.books[buf.length + 1] = book;
} 
```

# java - Window xp上Java代码编译冲突

> ID：11686031
> 
> 赞同：0
> 
> 时间：2012-07-27T10:31:00.693
> 
> 标签：java, noclassdeffounderror

我试图在 Java 上进入石器时代，并决定在不使用 IDE 的情况下运行程序。很快，我发现自己正在查看一个需要我导入外部 jar 文件的程序。我确实遇到了一些问题，但多亏了我忠实的伙伴（Stackoverflow.com），我克服了所有问题，Wham！执行了我的程序。

现在，突然间，这个问题打动了我的大脑。相同的代码也会在 windows xp 上运行吗（我真的不知道为什么会发生这种情况）。因此，通过信任我曾经的伙伴，我开始了旅程。以下是我所做工作的概述：

1.  VMware --->> XP ---->> JDK 最新下载 -->> 运行设置 --->>

    设置 Path = C/Programs/1.7/bin 和 CLASSPATH = "C:\Program Files (x86)\Java\jdk1.7.0\jre\lib\ext" （都设置为环境变量）-->>复制粘贴将外部 jar 文件放入 CLASSPATH 目录 -->> cmd -->> javac Myclass.java -->> 编译并在与我的 Java 文件相同的位置创建 .class 文件 --->> java Myclass -->>无法找到或加载主类 --->> java -cp 。Myclass -->> NoclassdefFoundError 。

现在让我感到困惑的是，我在 Windows 7 中使用相同的代码（相同的导入、jar 和所有内容）做了同样的事情，它确实进行了复制并给了输出，那么为什么它在 XP 中表现得像个混蛋？请帮忙。

代码很简单：

```
 import com.gesmallworld.core.acp.AcptAcp; 
```

公共类 AcpE1 扩展 AcptAcp {

```
public static void main(String[] args) 
 {

        System.out.println("Hello World");
 } 
```

}

PS：我尝试通过删除“extends AcptAcp”来编译代码，发现它会导致 xp 上的无错误输出。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T11:33:02.767

我不明白你为什么混淆。在 Windows XP 或 Windows 7 中，每个 java 程序都可以轻松运行，结果都是一样的。建议你学习 Java Packages 和 CLASSPATH 行为。阅读[本文](http://www3.ntu.edu.sg/home/ehchua/programming/java/J9c_PackageClasspath.html)并在完成阅读本文后，您将解决您的问题。

# variables - 在变量中使用 >nul

> ID：11686038
> 
> 赞同：1
> 
> 时间：2012-07-27T10:31:27.300
> 
> 标签：variables, batch-file, command, set, nul

有谁知道`>nul`在变量中设置时如何停止被忽略，或者这是不可能的？我有一种感觉，这是只有在所有变量都被扩展或其他东西之后才会起作用的事情之一，但问一下也无妨。

例子：

```
@echo off

:: Won't work
SET pause_5=ping localhost /n 6 >nul
%pause_5%

:: Will work
SET pause_5=ping localhost /n 6
%pause_5% >nul

exit 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T10:35:09.287

在参数周围加上引号：

```
set "pause_5=ping localhost /n 6 >nul" 
```

另一种选择是转义将由 shell 解释的字符：

```
set pause_5=ping localhost /n 6 ^>nul 
```

但通常引用方法要容易得多。

您编写的方式本质上是说“设置`pause_5`为`ping localhost /n 6`并忽略`set`命令的输出。”。

# javascript - 从 javascript 变量创建一个数组

> ID：11686043
> 
> 赞同：0
> 
> 时间：2012-07-27T10:31:58.633
> 
> 标签：javascript, arrays

您好，我想将一些值推送到数组中，但是当我提醒该数组时，它会显示 [object,object],[object,object],[object,object],[object,object]

有谁知道问题是什么？

这是代码：

```
 $(document).ready(function() {
    $(":button").click(function(event){
     var value = $('#box').val();
    if (value==""){
        return false;
        }
       else{$.getJSON("http://search.twitter.com/search.json?callback=?&q=value",
        function(data){
            var array=[];
            $.each(data.results, function(i, item){
                var user=item.from_user;
                var created_at=item.created_at
                array.push({date:'created_at',username:'user'});
            });alert(array);
            });
        }
      });}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T10:34:22.000

没有问题。

当您警告一个对象（`{date:'created_at',username:'user'}`将创建）时，它将被字符串化为`"[object object]"`. （您可以通过覆盖`toString`对象的功能来更改它）。

该数组确实包含对象。

（好的，从技术上讲存在问题，但您描述的症状与它无关，您放入对象的值是字符串文字而不是变量，您不应该引用它们）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T10:42:25.430

首先，我在您的代码中发现了一个小错误。当您创建要推入数组的对象时，您不使用值，而是使用固定字符串（以 upticks 为单位）。您应该将该行更改为此版本：

```
array.push({date:created_at, username:user}); 
```

如果您尝试可视化内部状态（调试信息），那么 using`alert()`只会提供较差的视觉表示。而不是`alert()`你可以使用`console.log()`。

此语句在控制台中创建输出。不是每个浏览器都支持它。Internet Explorer 具有开发人员工具。您只需按 F12 即可激活它们。但据我所知，IE 的输出非常有限。Firefox 可以使用 Firebug 插件（一个非常强大的工具！）进行扩展。

当您`console.log(array)`在代码中调用时，Firebug 中的输出会显示如下内容

```
[Object { date=..., username = ... }, Object { date = ..., username = ...}] 
```

由于`console.log()`并非所有浏览器都支持，因此您应该在将源发布到生产环境之前删除这些调用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-27T10:43:00.543

您正在使用字符串而不是变量来创建对象：

```
array.push({date:'created_at',username:'user'}); 
```

应该：

```
array.push({date:created_at,username:user}); 
```

或者

```
array.push({date:item.created_at, username:item.from_user}); 
```

创建对象后，使用`console.log`而不是`alert`进行调试。`Object.toString()`由警报调用的默认实现返回`[object Object]`您所看到的。

# javascript - 如何在Javascript中增加方括号内的数字

> ID：11686045
> 
> 赞同：1
> 
> 时间：2012-07-27T10:32:00.647
> 
> 标签：javascript, regex

我有一个长字符串，我需要增加其中的每个数字，而将其余文本保持原样。

我正在使用这个功能

```
newHtml = newHtml.replace(/\d+/, function (val) { return parseInt(val) + 1; }); 
```

这适用于自由文本中的数字，但当数字被方括号括起来时会失败。例子：

```
<input id="Form[0]_Phone" name="Form[0].Phone" type="text" value=""> 
```

需要成为

```
<input id="Form[1]_Phone" name="Form[1].Phone" type="text" value=""> 
```

我用[这个例子](https://stackoverflow.com/questions/423107/use-regexp-to-match-a-parenthetical-number-then-increment-it)来尝试和帮助，我尝试了一些变化，但我的正则表达式技能让我失望了。

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T10:37:11.610

您需要使用“全局”标志，然后它应该替换所有出现。

IE

`newHtml = newHtml.replace(/\d+/g, function (val) { return parseInt(val) + 1; });`

看到它在这里工作：http: [//jsfiddle.net/4S7CE/](http://jsfiddle.net/4S7CE/)

如果没有“g”，它将仅替换匹配的第一个实例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-27T10:38:27.290

您的模式中没有任何内容导致所描述的行为 - 方括号中的数字也应该受到影响。一个明显的问题是您只影响找到的第一个数字，而不是全部 -`g`在模式的正斜杠后添加全局标志。

为我工作 - 看到这个小提琴：http: [//jsfiddle.net/ypUmg/](http://jsfiddle.net/ypUmg/)

# php - PHP - UTF-8 转中文 ANSI (GB2312?) - 导出 CSV 文件

> ID：11686046
> 
> 赞同：1
> 
> 时间：2012-07-27T10:32:02.003
> 
> 标签：php, encoding, csv, utf-8, gb2312

经过几个小时的研究（几次......），我发布了这个。我还没有找到任何答案。

我的目标是使用 PHP 编写一个 CSV 文件。这个文件必须有中文ANSI编码（我想简体中文是GB2312，在notepad++中我只看到ANSI编码）。必须导入到另一个工具。

**[重要的提示]**

我们目前正在使用 notepad++ 和一台默认语言为中文的 PC 转换文件。过程是：

*   从网络应用程序获取 UTF8 CSV
*   在中国电脑上用 Excel 2003 保存为 csv
*   在notepad++中打开，编码已经是ANSI，删除一个前导“？” 在文件的开头。

我进行了测试：将我的 .csv 文件更改为 .php 并用以下代码替换它以保持相同的编码：

```
<?php echo mb_detect_encoding("test"); ?> 
```

这将打印：“ASCII”。

然后我不确定CSV的输出应该是什么：GB2312？，ASCII？，ANSI？。我什至不清楚它们之间的区别。

我还读到，使用 Excel 2007 保存为 CSV 格式的文件在中国 PC 上适用于该工具。

**[/重要的提示]**

目前，我无法做到正确！当我打开我在记事本++中得到的文件时，它仍然显示编码为 UTF-8 编码。很明显，因为汉字看起来不错，它们应该看起来“破碎”:-)。

我正在使用以下标头条件：

```
header("Content-type: text/csv; charset=GB2312");
header("Content-Disposition: attachment; filename=$filename.csv");
header("Content-Transfer-Encoding: binary"); 
header("Cache-Control: must-revalidate, post-check=0, pre-check=0");
header("Pragma: no-cache");
header("Expires: 0"); 
```

**[附加信息]**

我的文件编码方式是（我把它抽象化以保持简单）

```
//header, hard coded in Chinese
$csv = "东西，东西，东西\n"; //example "stuff,stuff,stuff"
[...]
//write line by line, status is also hard coded (行)
$csv .= $DB_data_1.",".$DB_data_2.",行\n"; //行=OK 
```

**[/附加信息]**

我还在打印之前使用 iconv 将我的 CSV 字符串转换为 GB2312（也尝试了 mb_convert_encoding）

```
setlocale(LC_ALL,'zh_CN');
$csv = iconv("UTF-8","GB2312",$csv);
echo($csv); 
```

我的 .php 文件是用 UTF-8 编码编写的（不是没有 BOM 的 UTF-8）

基本上，**我总是得到 UTF-8 文件作为输出**，我需要 ANSI。看起来有这么多参数/属性，我不明白。您的帮助将不胜感激！

谢谢！

大卫

**[附加信息]**

例如，在我的标题列上将有以下编码更改：

*   PHP源代码中（UTF-8文件，英文电脑）：商品序号（意思是：SKU，商品代码）
*   在最终的 CSV 文件（ANSI 文件，英文计算机）中：ÉÌÆ·ÐòºÅ
*   在最终的 CSV 文件（ANSI 文件，中文电脑）中：商品序号

**[/附加信息]**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T10:40:06.680

> 字符串 mb_convert_encoding ( 字符串 $str , 字符串 $to_encoding [, 混合 $from_encoding ] )

注意第二个参数是编码。所以应该是

```
$csv = mb_convert_encoding($csv, "GB2312", "UTF-8"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T10:40:24.850

您发送的 HTTP 标头仅向客户端指定您要回复的字符集 - 它不会为您转换内容。因此，如果您指定`charset=GB2312`，但发送 utf8，那么您只是在撒谎。在任何情况下，charset 属性在这里没有任何意义，因为内容无论如何都是以二进制形式传输的。

您需要做的是在发送内容之前对其进行转换。Iconv 或 mbstring 是合适的工具。首先确保您知道您的数据来自什么字符集。大概它是从某个地方（如数据库）加载的。所以考虑到你有点迷茫，很有可能它不是你想象的那样。例如，它很可能是 iso-8859-1 而不是 utf-8。

一旦您确定它确实是 utf-8，请使用您已经尝试过的 iconv：

```
$csv = iconv('UTF-8', 'GB2312', $csv); 
```

假设这`$csv`是一个字符串，包含 csv 文件。

# iphone - 将 NSString 添加到 NSMutableArray 会替换之前的 NSString

> ID：11686052
> 
> 赞同：1
> 
> 时间：2012-07-27T10:32:09.757
> 
> 标签：iphone, objective-c, ios, xcode, nsmutablearray

我基本上是在尝试使用此代码向我的 NSMutableArray 添加一个新字符串`ViewWillAppear`

```
 NSUserDefaults *favBooksDefaults = [NSUserDefaults standardUserDefaults];
    self.favBook = [favBooksDefaults stringForKey:@"favBook"];
    self.favBookList = [[NSMutableArray alloc]init];
    [self.favBookList addObject:favBook]; 
```

当然，当我这样做时，我想保留 Array 中存在的所有先前字符串。因为当我为 NSUserDefaults 添加一个新字符串然后添加到数组时，它只是替换了旧字符串。

为什么会这样？如何保存所有对象？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T10:39:17.347

当您分配并初始化一个新的 NSMutableArray 对象时，您将拥有一个没有值的空数组。它不能替代它，因为那里没有什么可以替代的。它只是将 NSSString 添加为第一个值。这当然会在每次分配/初始化 NSMutableArray 的新实例时发生。

解决方案：使 NSMutableArray 成为视图控制器的实例变量。分配/初始化一次（例如在 viewDidLoad 中）。每次`viewWillAppear`被调用时，您都可以添加值而无需重新初始化新的 NSMutableArray。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T11:00:06.637

```
NSMutableArray *newArray = [[NSMutableArray alloc] initWithArray:oldArray];
[newArray replaceObjectAtIndex:oldObjectIndex withObject:newObject] // if you want to replace oldObject with newObject;
[newArray addObject:newObject] // if you want to add object to the array; 
```

如果我做对了，您想用新对象替换旧对象吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-27T11:01:11.827

```
NSUserDefaults *favBooksDefaults = [NSUserDefaults standardUserDefaults];
self.favBook = [favBooksDefaults stringForKey:@"favBook"];
if ([self.favBookList indexOfObject:self.favBook] != NSNotFound) {
    [self.favBookList addObject:favBook];
} 
```

您还应该在`viewDidLoad`方法中初始化您的 favBookList：

```
self.favBookList = [NSMutableArray array]; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-27T16:02:36.230

Br.先生的回答是正确的：

在您的头文件中将 favBookList 声明为一个属性并包含一个添加书籍的方法：

```
@interface yourViewController : UIViewController {
NSMutableArray *favBookList;
}

-(void)addBook;

@property (nonatomic, retain) NSMutableArray *favBookList; 
```

在您的 viewDidLoad 方法中，初始化 favBookList。不要忘记@synthesize！

```
-(void)viewDidLoad {
self.favBookList = [[NSMutableArray alloc] init];
[super viewDidLoad];
} 
```

现在，您可以随时从您的用户默认设置中添加一本书。

```
-(void)addBook{
self.favBook = [[NSUserDefaults standardUserDefaults] stringForKey:@"favBook"];
[favBookList addObject:favBook]; 
} 
```

# haskell - 在实例声明中推断类

> ID：11686054
> 
> 赞同：1
> 
> 时间：2012-07-27T10:32:12.213
> 
> 标签：haskell

出于教学原因，我正在实现类似于 Parsec 的功能。Motive 是在不使用 Monad 魔法的情况下定义 Functor、Applicative 和 Alternative 实例。Functor 和 Applicative 的实例很好。然而，`<|>`在 Alternative 中定义是磨损我的头发。

```
newtype Parser t = Parser (String -> [(t, String)])

parse (Parser p) s = p s

instance Functor ....
instance Applicative ....

empty1 = Parser $ \s -> []

orp :: Parser t -> Parser t -> Parser t
-- orp :: (Eq t) => Parser t -> Parser t -> Parser t  -- this works too
p1 `orp` p2 = Parser $ \s -> let p1out = parse p1 s
                                 e     = parse empty1 s
                             in
                              if p1out == e
                              then parse p2 s
                              else p1out     

{- 
instance Alternative Parser where
  empty = Parser $ \s -> []

  (<|>) = orp -- fails to compile
-}
```

ghc 抱怨它无法`Eq`从上下文中推断出来，即使我添加`Eq`了 orp` 的签名。显然，我不能在实例声明中添加签名以使其表现良好。单态限制没有帮助；也许我不是很了解。

我错过了什么？我应该探索存在类型吗？还是我犯了一个根本性的错误？或者这是不可能的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-27T10:36:09.077

而不是使用 与空列表进行比较`(==)`，您应该进行模式匹配

```
orp :: Parser t -> Parser t -> Parser t
orp p1 p2 = Parser $ \s ->
    case parse p1 s of
      [] -> parse p2 s
      xs -> xs 
```

在没有类型类约束的情况下实现相同的行为，因此可用于实例声明。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-27T19:02:02.037

Daniel Fischer 提出了一个具体的解决方案；我想建议一个抽象的修复。在此过程中，我们将公开您在这里做出的设计决策，您甚至可能没有意识到自己做出了（我会证明您的决定不正确）。

众所周知[，](http://hackage.haskell.org/packages/archive/TypeCompose/0.9.1/doc/html/Control-Compose.html#t%3a%3a.)应用函子组成；许多其他类型的函子配对组成的不太为人所知（尽管肯定不是我发明的）。特别是，替代函子与任一侧的函子组合以产生新的替代函子。下面，我将使用 Haskell 语法来解释我的意思。我将编写*无效*的Haskell——因为我将使用`type`而不是`newtype`到处使用以避免混乱——但稍后我们将使用无效的 Haskell 来导出有效的 Haskell。

```
type (f :. g) a = f (g a) -- like in TypeCompose

-- (1)
instance (Applicative f, Alternative g) => Alternative (f :. g) where
    empty = pure empty
    x <|> y = liftA2 (<|>) x y

-- (2)
instance Alternative f => Alternative (f :. g) where
    empty = empty
    x <|> y = x <|> y 
```

（这些实例重叠得非常非常多。）

从语义上讲，我们现在可以将您的类型视为类型组合的链：

```
-- (3)
type Parser = (String ->) :. [] :. (String,) 
```

...在这里我们观察到这`(String ->)`是`Applicative`(4)`[]`的一个实例并且是`Alternative`(5) 的一个实例。这意味着我们应该能够`Alternative`通过将语义定义`Parser`与上面的实例耦合来从 this 中“读取”一个实例。

```
empty :: Parser t
= -- (3)
empty :: (String ->) :. [] :. (String,)
= -- (1)
pure (empty :: [] :. (String,)) :: (String ->) :. ([] :. (String,))
= -- (4)
const (empty :: [] :. (String,)) :: (String ->) :. ([] :. (String,))
= -- (2) to use []'s empty rather than [] :. (String,)'s empty
const (empty :: [] :. (String,)) :: (String ->) :. ([] :. (String,))
= -- (5)
const [] :: (String ->) :. ([] :. (String,))

p <|> q :: Parser t -> Parser t -> Parser t
= -- (3)
p <|> q :: ... -> ... -> ((String ->) :. [] :. (String,))
= -- (1)
liftA2 (<|>) p q
= -- (4)
\s -> p s <|> q s
= -- (2) to use []'s <|> rather than [] :. (String,)'s <|>
\s -> p s <|> q s
= -- (5)
\s -> p s ++ q s 
```

所以，从语义上讲，我们知道我们现在想要`empty`和`<|>`如何表现`Parser`s，剩下的唯一技巧就是添加所有适当的 newtype 构造函数和解构函数。

```
instance Alternative Parser where
    empty = Parser (const [])
    Parser p <|> Parser q = Parser (\s -> p s ++ q s) 
```

或者，如果我们感到兴奋，我们可以用更重载的语法编写同样的东西：

```
instance Alternative Parser where
    empty = Parser (pure empty)
    Parser p <|> Parser q = Parser (liftA2 (<|>) p q) 
```

请注意，这个实现`(<|>)`实际上总是从`q`!返回所有结果。在您的定义中，`q`只有在`p`失败时才能返回其解析；这尤其意味着成功解析的列表将是左偏的。上面的语义驱动实现没有这样的偏见：即使 a 的左侧`(<|>)`解析，右侧也将被允许讲述它的胜利。而且我认为这很自然：这意味着使用此接口构建的解析器将返回*所有*成功的解析。

实际上有什么区别？那么上面的语义定义*更健壮*，你提出的定义*更有效*。让我们先看看“更健壮”是什么意思。

考虑一个总是只使用一个字符的解析器（它返回的内容对于本次讨论并不重要）：

```
oneChar = Parser (\s -> case s of
    c:cs -> [((),cs)]
    _    -> []) 
```

...以及一个始终成功且不消耗任何字符的解析器：

```
epsilon = Parser (\s -> [((),s)]) -- you might recognize this as "pure ()" 
```

现在，如果我们像这样编写一个一两个字符的解析器会发生什么？

```
oneOrTwo = (oneChar <|> epsilon) <* oneChar 
```

考虑使用`oneOrTwo`来解析`"a"`. 根据您对 的定义`(<|>)`，第一部分 ,`oneChar <|> epsilon`尝试使用`oneChar`来解析一点，它成功了，因此永远不会运行`epsilon`，我们得到一个解析列表，如`[((),"")]`. 但是现在第二部分失败了：没有一个字符可以解析了。根据我对 的定义`(<|>)`，第一部分改为尝试两个解析，它同时运行`oneChar`和`epsilon`，我们得到一个解析列表，如`[((),""),((),"a")]`. 现在第二部分在该列表的第一个元素上失败，但在第二个元素上成功，并且整体解析成功。

另一方面，由于两个原因，您的定义可能更有效：首先，它可以更快地丢弃输入的早期部分（导致与垃圾收集更好的交互），其次，它可以修剪大部分回溯搜索空间（导致更少的搜索周期）。

这种权衡是众所周知的。例如，[Parsec通过](http://hackage.haskell.org/package/parsec)[try](http://hackage.haskell.org/packages/archive/parsec/latest/doc/html/Text-Parsec-Prim.html#v%3atry)组合器提供了你的交替类型（如果它曾经消耗任何输入，它会提交它的第一个参数）和我的类型（它会回溯） 。

# stored-procedures - VS 2012中是否有一种直观的方式来修改和保存存储过程

> ID：11686056
> 
> 赞同：5
> 
> 时间：2012-07-27T10:32:13.000
> 
> 标签：stored-procedures, visual-studio-2012

我可以在 VS 2012 中确定打开现有存储过程进行修改和保存更改的唯一方法如下：

1）手动删除初始单词`CREATE`并`ALTER`在其位置重新键入（每次）。

2) 从“SQL”菜单，然后是“Transact-SQL Editor”子菜单，选择`Execute`.

鉴于 VS2012 处于候选版本中，我确信在这些方面不会有根本性的变化。

而且，我理解从纯粹的角度来看，这是执行查询以更改服务器上的过程。但是从可用性的角度来看，工具栏上不再有一个简单的`Save`按钮了吗？在一天的过程中，这是对时间和精神集中的非无关紧要的浪费。我可以忍受`Ctrl`++ `Shift`，`E`但每次手动编辑都是荒谬的`CREATE`。`ALTER`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-29T00:20:21.180

我认为您正在尝试将对存储过程的更改应用于您的数据库？

您可以尝试以下操作： 转到查看 SQL Server 对象资源管理器。右键单击 SQL Server 节点并添加您的服务器。打开数据库并确定您需要编辑的过程。双击该过程，这将打开对象的 CREATE 脚本。将 CREATE 留在那里并简单地修改它并单击“更新”按钮。然后选择生成脚本或更新数据库，具体取决于您是要立即应用更改还是将脚本生成到查询窗口并自行应用脚本。

如果要生成 ALTER，可以使用服务器资源管理器（与 SQL Server 对象资源管理器不同，后者也在查看菜单中）。将您的数据库添加到数据连接。找到您的程序，右键单击并选择打开。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T22:13:29.907

我相当确定您可以将该过程添加到源代码管理、进行更改、签入并发布到您的数据库。我从来没有做过，但在这个视频中谈到了：

[在 TechEd 2012 上的 SSDT 演讲](http://video.ch9.ms/teched/2012/na/DBI311.wmv)

# plone - 在 plone 4.1.4 上使用 Products.ResourceRegistries 2.1.2

> ID：11686065
> 
> 赞同：0
> 
> 时间：2012-07-27T10:33:01.317
> 
> 标签：plone

我想在我的 plone 4.1.4 上使用 plone.app.jquery 1.7.2，但它不起作用，因为 plone 4.1.4 使用旧版本的 Products.ResouceRegistries，它不启用“捆绑”选项。

所以我认为我必须将 Products.ResouceRegistries 更新到 2.1.2。我已经修改了versions.cfg 并运行了buildout，但没有任何效果（没有下载新版本）。

我怎样才能更新版本？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T15:53:19.343

为什么不直接升级到 Plone 4.2？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-30T09:06:52.837

问题是构建中有一个 kgv 将 Products.ResouceRegistries 固定到 2.0.6 ： [http ://good-py.appspot.com/release/dexterity/1.2.1?plone=4.1.4](http://good-py.appspot.com/release/dexterity/1.2.1?plone=4.1.4)

删除 ?plone=4.1.4 并将 Products.ResouceRegistries 固定到 2.1.2 使其工作。

# java - 性能问题 - JSF 中 AjaxStateHolder 中的 LRUMap()？

> ID：11686069
> 
> 赞同：0
> 
> 时间：2012-07-27T10:33:20.177
> 
> 标签：java, performance, jsf-1.2, ajax4jsf

我在我们的应用程序中使用 SUN JSF1.2 和 Richfaces 3.3.1。作为性能调整的一部分，在 web.xml 中添加了以下参数

```
<context-param>
   <param-name>com.sun.faces.numberOfViewsInSession</param-name>
   <param-value>2</param-value>
</context-param>
<context-param>
   <param-name>com.sun.faces.numberOfLogicalViews</param-name>
   <param-value>2</param-value>
</context-param> 
```

仍然当我检查会话对象时，我看到 org.ajax4jsf.application.AjaxStateHolder 消耗了几乎 85%（几乎 10 MB）的会话内存。即使我试图从会话中获取 AjaxStateHolder 对象，但无法删除所有缓存的会话。

我在网上搜索过，有人提到Richfaces存在问题。

无论如何要从 LRMap 中清除所有那些缓存的视图。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-30T22:11:55.297

[我遇到了类似于这里](https://issues.jboss.org/browse/RF-3878)所说的问题：

我需要对 IE9 进行一些自定义修改并向日历组件添加工具提示，所以我抓取了源并修改`protected static final int DEFAULT_NUMBER_OF_VIEWS = 16;`为等于 1 的值。

我使用 Maven 2 构建了项目。Maven 3 将无法工作。

更改所有声明该常量的地方为我解决了这个问题。

# javascript - html5拖拽的工作流程

> ID：11686070
> 
> 赞同：1
> 
> 时间：2012-07-27T10:33:22.580
> 
> 标签：javascript, html

我对使用拖放感到困惑。到目前为止，它可以拖放一个元素。但是，我想在完成放置后存储结构，所以我将放置的目标添加到放置后的父级中，我发现 ondragend 每次调用两次，ondrop 调用基于目标元素的数量. 如何实施？

```
function drop(){
  //this function is called base on the numbers of target element
  //drop third into first/second will be called once
  //drop second into first and then drop third into second will be called twice
}
function over(){
  //this function is called base on the numbers of total affected element
  //drop third into first/second will be called twice
  //drop second into first and then drop third into second will be called thrice
}
<div ondrop=drop ondragend=over id="first"></div>
<div ondrop=drop ondragend=over id="second"></div>
<div draggable=true id="third"></div> 
```

另外我在 drop 和 over 中都使用 return false 也无法解决问题

# java - Java 中深度内存结构的集群化选项

> ID：11686077
> 
> 赞同：2
> 
> 时间：2012-07-27T10:33:44.577
> 
> 标签：java, jakarta-ee, load-balancing

我们有一个相当复杂的 Java EE 应用程序（Java 后端 + GRails 前端通过 Spring HTTP Invoker 进行通信），其中包含大量可怕的遗留代码。目前它在 Jboss 中运行（稍后将迁移到 Tomcat）。

为了使其更可靠并提高性能，我们需要使其可集群化。

问题是应用程序目前有许多对需要复制的整个业务至关重要的深层内存结构（例如，在另一个 ConcurrentHashMap 内部的 ConcurrentHashMap 内部的 HashMap 内部的列表内部的域对象）。

正如我所说，有很多遗留代码，我们不能全部重做。

目前我正在使用 EHCache，但显然没有成功 - 缓存对象内部的更改不会被复制。

Terracotta DSO 看起来像是我们应该研究的东西，但它是最终的解决方案，我只是不想介绍这种激进的解决方案，而我们希望以更通用的方式解决它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T11:20:56.393

实际上，这是大多数兑现解决方案的典型问题 - 使用深度内存结构并且没有简单的方法来处理这个问题。

因此，例如让我们以企业网格 - **gigaspaces** - 这就是它的完成方式[http://www.gigaspaces.com/wiki/display/XAP8/Modeling+your+data](http://www.gigaspaces.com/wiki/display/XAP8/Modeling+your+data)

这真的是解释周围的事情：

什么时候应该嵌入对象？您已经知道嵌入相关对象不是一个好习惯。但即使有很好的嵌入相关对象的案例（有时以数据重复为代价），您仍然应该注意以下几点：

嵌入意味着没有直接访问：当一个实体嵌入到另一个实体中时，您不能直接对其应用 CRUD 操作。相反，您需要通过常规查询从空间中获取其根父实体，然后向下导航对象图，直到获得所需的实体。这不仅仅是方便的问题，它还具有性能影响：每当您想对嵌入式实体执行 CRUD 操作时，您首先读取整个图，然后（如果您还需要更新它）将整个对象图写回到空间。另一方面，使用 GigaSpaces 非嵌入式关系意味着您需要在代码中自己管理关系。选择嵌入关系的拇指规则 当实体仅对其包含对象的上下文有意义时嵌入。例如，在宠物诊所应用程序中 - 宠物只有在拥有所有者时才有意义。在这个特定的应用程序中，如果没有所有者，宠物本身是没有意义的。没有将宠物从所有者转移到所有者或在没有所有者的情况下将宠物接纳为兽医的业务场景。嵌入有时可能意味着复制您的数据。例如，如果您想引用 Pet 和 Vet 类中的某个访问，则需要有重复的访问条目。所以让我们来看看重复：重复意味着更喜欢可伸缩性而不是占用空间 - 重复的原因是为了避免集群范围的事务，并且在许多情况下，这是以可伸缩方式划分对象的唯一方法。复制意味着更高的内存消耗：虽然今天内存被认为是一种商品和低成本，复制要付出更大的代价——你可能有两个包含相同数据的空间对象。重复意味着更宽松的一致性。例如，当您向宠物和兽医添加访问时，您需要同时更新它们。您可以在一个（可能是分布式的）事务中执行此操作，也可以在两个单独的事务中执行此操作，这样可以更好地扩展但不太一致。这对于许多类型的应用程序（例如社交网络）来说可能就足够了，在这些应用程序中丢失帖子虽然不受欢迎，但不会造成重大损害。相比之下，这对于应考虑每项操作的金融应用程序来说是不可行的。您可以在一个（可能是分布式的）事务中执行此操作，也可以在两个单独的事务中执行此操作，这样可以更好地扩展但不太一致。这对于许多类型的应用程序（例如社交网络）来说可能就足够了，在这些应用程序中丢失帖子虽然不受欢迎，但不会造成重大损害。相比之下，这对于应考虑每项操作的金融应用程序来说是不可行的。您可以在一个（可能是分布式的）事务中执行此操作，也可以在两个单独的事务中执行此操作，这样可以更好地扩展但不太一致。这对于许多类型的应用程序（例如社交网络）来说可能就足够了，在这些应用程序中丢失帖子虽然不受欢迎，但不会造成重大损害。相比之下，这对于应考虑每项操作的金融应用程序来说是不可行的。

在**hazelcast 中**，您有一个与 gigaspaces 不同的数据亲和性概念[http://www.hazelcast.com/docs/1.9.4/manual/multi_html/ch03.html 。](http://www.hazelcast.com/docs/1.9.4/manual/multi_html/ch03.html)

我的意思是没有简单的解决方案，我想您无论如何都需要重新设计您的模型（无论这是否是连贯性、gigaspaces、ehcache、hazelcast 都无关紧要）。

# css - 溢出：隐藏的父 div 不扩展到浮动子级

> ID：11686083
> 
> 赞同：1
> 
> 时间：2012-07-27T10:34:03.587
> 
> 标签：css, drop-down-menu

我正在制作一个巨型下拉菜单并具有这种结构

```
<li>
    <div class="drop_div4">  
          <div class="child">  <----floated child
          <div class="child">  <----floated child
          <div class="child">  <----floated child 
```

问题是，根据访问权限，我将不得不隐藏任何子 div，所以我希望**drop_div4**能够自动扩展，但目前如果我删除它的宽度，那么所有子 div 都显示在另一个下方。

我尝试添加`overflow:hidden,float:left`到**drop_div4** div，但它不起作用

添加`min-width`并希望它会增长也无济于事。

添加`<div style="clear:both">`为最后一个 div 也无济于事

我已经设置了一个[jsfiddle](http://jsfiddle.net/pankajsingh5k/H6Tgu/)，在父div上删除了宽度，所有子div都显示在彼此下方。

要查看所有子 div 可见时的外观，请取消注释**.drop_div4**类中的 width:550px

请提供帮助，因为我不知道为什么会这样。

# magento - Magento 1.5.0.1 catalog_product_price 索引问题

> ID：11686084
> 
> 赞同：2
> 
> 时间：2012-07-27T10:34:08.593
> 
> 标签：magento, indexing

我正在使用带有 600,000 个产品的 Magento 1.5.0.1。索引是一个主要问题，尤其是 catalog_product_price 索引。

1/ 在索引过程即将结束时，运行查询 DELETE FROM catalog_product_index_price 。这会从我们的站点中删除所有项目，以便站点显示“没有与选择匹配的产品”。对于所有类别，主页，搜索结果。

2/ 从 catalog_product_index_price_idx 插入到 catalog_product_index_price 的过程需要 10 分钟，因此我们有一个 10 分钟的窗口，网站上没有产品。我绝对确定这是一个错误，没有人打算在一段时间内将所有产品编入索引 - 即使只有 10 秒，这也不适合电子商务网站

3/ 由于某种原因，DELETE FROM catalog_product_index_price 的过程有时会在表中留下一些产品，因此当从 catalog_product_index_price_idx 插入到 catalog_product_index_price 的过程运行时，索引器会因为重复条目而引发完整性约束问题。这将结束索引过程，并使站点没有任何产品。我们在凌晨运行索引，因此如果索引失败，有时我们有几个小时没有产品在现场。

有谁知道这些问题的解决方法或更新网站上不需要我们索引的价格的更好方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T16:14:37.487

首先，使用 600k 产品运行 Magento 做得很好，这是我听说过的最多的。

我认为解决这个问题的最好方法是覆盖索引过程，这样它就不会截断和重建价格索引，而是逐行替换。这可能会花费更长的时间，但会解决它有这个没有产品的窗口的问题。

您可以尝试的一件事是用 TRUNCATE TABLE 替换 DELETE FROM，这对于您的“表中仍有一些项目”问题可能更可靠。

最终，尽管我认为您将构建一个定制的优化索引器。

# c# - SqlDataReader 不返回所有行？

> ID：11686085
> 
> 赞同：-1
> 
> 时间：2012-07-27T10:34:12.190
> 
> 标签：c#, .net, sql-server

这是我的代码：

```
using (SqlCommand cmd = new SqlCommand("My_SQL_Command"))
{
    cmd.CommandType = CommandType.Text;
    conn.Open();
    cmd.Connection = conn;
    cmd.CommandTimeout = 60000;

    try
    {
        using (SqlDataReader rdr = cmd.ExecuteReader(CommandBehavior.CloseConnection))
        {
            while (rdr.Read())  // I put a breakpoint here to count the rows of rdr
            { 
```

我的 SQL 命令返回 482 行，这些行在 SQL GUI 中进行了验证。我运行完全相同的代码，`SqlDataReader`只返回 450 个 - 返回的行有限制吗？

我没有包含 SQL 语句，因为它只是一个`SELECT`没有`WHERE`子句的长语句。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-27T11:29:48.047

你确定你在同一个数据库/实例/服务器上运行它吗？

# javascript - 我想在 ajaxToolkit:AjaxFileUpload 开始上传时显示一条消息，有没有办法做到这一点

> ID：11686086
> 
> 赞同：4
> 
> 时间：2012-07-27T10:34:14.060
> 
> 标签：javascript, jquery, asp.net, ajaxcontroltoolkit

我想在 ajaxToolkit:AjaxFileUpload 开始上传时发一条消息，有没有办法做到这一点

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-27T13:44:52.743

默认情况下`AjaxFileUpload`没有这样的事件。但是由于 AjaxControlToolkit 是一个开源库，您可以自己添加它。从此页面下载最近的库源：[source codes](http://ajaxcontroltoolkit.codeplex.com/SourceControl/list/changesets)，找到 AjaxFileUpload 控制源（/Server/AjaxControlToolkit/AjaxFileUpload 文件夹）并将以下代码添加到 AjaxFileUpload.cs 文件中：

```
[DefaultValue("")]
[Category("Behavior")]
[ExtenderControlEvent]
[ClientPropertyName("uploadStarted")]
public string OnClientUploadStarted
{
    get
    {
        return (string)(ViewState["OnClientUploadStarted"] ?? string.Empty);
    }
    set
    {
        ViewState["OnClientUploadStarted"] = value;
    }
} 
```

之后，修改`AjaxFileUpload.pre.js`文件：

```
// insert this code right after the _raiseUploadComplete method
add_uploadStarted: function (handler) {
    this.get_events().addHandler("uploadStarted", handler);
},

remove_uploadStarted: function (handler) {
    this.get_events().removeHandler("uploadStarted", handler);
},

_raiseUploadStarted: function () {
    var eh = this.get_events().getHandler("uploadStarted");
    if (eh) {
        eh(this, Sys.EventArgs.Empty);
    }
},

// modify the _doUpload method
_doUpload: function () {

    if (!this._filesInQueue.length || this._filesInQueue.length < 1)
        return;

    this._raiseUploadStarted();

    this._currentQueueIndex = -1;
    if (!this._isFileApiSupports)
        this._createIframe();

    this._processNextFile();
} 
```

比构建解决方案并享受新功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-17T18:31:49.743

在 AjaxControlToolkit 的当前版本（2013 年 12 月发布版本 7.1213）中，此事件可用，无需任何源代码修改。

[http://ajaxcontroltoolkit.codeplex.com/SourceControl/latest#Server/AjaxControlToolkit/AjaxFileUpload/AjaxFileUpload.cs](http://ajaxcontroltoolkit.codeplex.com/SourceControl/latest#Server/AjaxControlToolkit/AjaxFileUpload/AjaxFileUpload.cs)

# android - Android 是否有类似于 iOS 的 Aspect Fill 概念？

> ID：11686096
> 
> 赞同：30
> 
> 时间：2012-07-27T10:34:56.333
> 
> 标签：android

Android 中是否有任何与 iPhone Aspect Fill 相关的概念。我想在 imageview 上的 android 图像中包含同样的概念。请给我这个概念的代码片段？

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2012-07-27T10:40:52.463

如果您想要一个在保持适当纵横比的同时放大和缩小的 ImageView，请将其添加到您的 XML 中：

```
android:adjustViewBounds="true"
android:scaleType="centerCrop" 
```

[看](https://stackoverflow.com/a/2524243/614807)这个。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2013-07-24T13:11:00.493

我尝试了 fitCenter 并没有用，我最终使用了

```
android:scaleType="centerCrop"
android:adjustViewBounds="true" 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-03-14T09:01:41.337

经测试！！！`adjustViewBounds`需要与`scaleType`centerCrop 一起为 false 以匹配`UIViewContentModeScaleAspectFill`iOS 的行为

```
android:adjustViewBounds="false"
android:scaleType="centerCrop" 
```

# batch-file - 在批处理中嵌套 for 循环。出现错误，但不确定原因

> ID：11686098
> 
> 赞同：2
> 
> 时间：2012-07-27T10:34:58.257
> 
> 标签：batch-file, for-loop, nested-loops

我的脚本从表单的“settings.txt”文件中调用信息

> property1=value11,value12,...,value1n
> property2=value21,value22,...,value2n
> 。
> .
> .
> 属性m=valuem1,valuem2,...,valuemn

为了将“n”个模式添加到数据库中，使用格式为“setup.txt”的文件

> 2
> 3
> .
> .
> .
> n+1

指定要添加的架构。遍历每个模式的“for”循环是

```
FOR /F %%T IN (setup.txt) DO ( 
    SET position=%%T        
    FOR /F "tokens=1,!position!, delims==," %%A IN (settings.txt) DO (
        IF "%%A"=="property1" (
            SET %%A="%%B"
        )
[The code then continues to go through capturing the rest of the variables, and
then executes the relevant SQL commands] 
```

我从中得到的错误信息是

> （此时出乎意料。

该脚本以前一次只使用一个模式（在我添加两个 for 循环之前），所以问题在于我如何设置 for 循环，或者与 for 循环和之前的代码有冲突。我添加到之前工作脚本中的只是两个 FOR 语句和 SET 语句。

我找了几个人看了，都没有找到问题所在。这里有什么想法吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T11:52:32.683

问题是线路

```
FOR /F "tokens=1,!position!, ... 
```

您不能在 FOR/f 选项中使用延迟扩展，因为 FOR 命令有它自己的解析器，它不能以这种方式扩展选项。

但是您可以将其移至函数并使用百分比扩展

```
FOR /F %%T IN (setup.txt) DO ( 
    call :myFunc %%T
)
:exit /b

:myFunc
FOR /F "tokens=1,%1, delims==," %%A IN (settings.txt) DO (
    IF "%%A"=="property1" (
        SET %%A="%%B"
    )
)
exit /b 
```

# php - 使用 JQuery Ajax 通过 HTTPS 发送时未收到 $_POST 变量

> ID：11686099
> 
> 赞同：2
> 
> 时间：2012-07-27T10:35:05.847
> 
> 标签：php, jquery, ajax, https

我正在开发一个应用程序，该应用程序需要填写使用 Jquery Ajax 生成并通过 https 连接发送的表单。

问题是当我通过正常的 http 连接测试应用程序时，应用程序运行良好，但是当我将其上传到服务器并通过 https 连接连接到它时，接收文件没有检测到 $_POST 变量。

这里有什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T10:37:18.417

这将是跨域发布，将被浏览器阻止。请[从 HTTP 页面通过 AJAX 查看此线程 HTTPS 请求](https://stackoverflow.com/questions/1012777/https-request-via-ajax-from-http-page)

# ruby-on-rails-3 - 在 Rails 3 中使用标题对记录进行分组

> ID：11686100
> 
> 赞同：3
> 
> 时间：2012-07-27T10:35:07.943
> 
> 标签：ruby-on-rails-3, model, group-by

我的 Rails 3 应用程序中有一个文章模型。文章模型有一个称为类别的列，它是使用新表单视图中的选择框设置的。（这是一个选择框，因为选项永远不会改变，而且只有四个）。

我拥有的索引视图代码如下：

```
<% @articles.category.each do |article| %>
 <%= article.category %>
 <% @articles.each do |article| %>
  <tr>
    <td><%= article.title %></td>
    <td><%= article.author %></td>
    <td><%= article.category %></td>    
    <td><%= link_to 'Show', article %></td>
    <td><%= link_to 'Destroy', article, confirm: 'Are you sure?', method: :delete %></td>
  </tr>
 <% end %>
<% end %> 
```

我在控制器中按类别分组：

```
@articles = Article.group(:category).order('title ASC') 
```

但是，这会导致指向以下行的异常`<% @articles.category.each do |article| %>`。

实现以下目标的最整洁（从我的视图代码中）方法是什么：

*   **第一类**
*   第1条
*   第二条
*   **第 2 类**
*   第五条
*   **第 3 类**
*   第八条

所以每篇文章都列在它的类别下。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-27T15:24:14.183

我建议您使用 group_by 方法（[文档](http://apidock.com/rails/Enumerable/group_by)）：

```
# in your controller
articles = Article.order('title ASC')
@grouped_articles = articles.group_by &:category

# in your view
<% @grouped_articles.each do |category, articles| %>
  <%= category %>
  <% articles.each do |a| %>
    <tr>
      <td><%= a.title %></td>
      <td><%= a.author %></td>   
      <td><%= link_to 'Show', a %></td>
      <td><%= link_to 'Destroy', a, confirm: 'Are you sure?', method: :delete %>       </td>
    </tr>
  <% end %>
<% end %> 
```

# xmpp - 创建聊天应用程序

> ID：11686103
> 
> 赞同：0
> 
> 时间：2012-07-27T10:35:08.803
> 
> 标签：xmpp, osgi, chat, bundle

我将使用 OSGI 开发一个聊天应用程序，因此对 3 个命题之间没有疑问：

使用现有的聊天服务器，但我
遇到了使用聊天包开发聊天服务器的频道安全问题

你能帮我做选择吗

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T14:27:15.827

如果您唯一关心的是安全性，请使用现有服务器。

通过 SASL、TLS 和 SSL 将安全性内置到 XMPP 协议中。

# c# - 具有从子类调用的基类的参数化构造函数的抽象类

> ID：11686104
> 
> 赞同：-3
> 
> 时间：2012-07-27T10:35:12.517
> 
> 标签：c#

因为我有一个抽象基类说 MyBase。它具有带有字符串值的参数化构造函数，它具有抽象方法调用。我也有一个孩子班说MyChild。它没有任何构造函数，只有一个具有公共方法，我想将基类的参数化构造函数调用到子类上。

请给我相应的解决方案...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T10:45:00.463

如果您没有在子类中指定构造函数，则将使用父类的构造函数。即您可以将您的 Child 类实例化为

```
Child child = new Child(initString); 
```

如果未定义上述子构造函数，则只会传播（调用）具有相同签名的父构造函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T10:37:52.593

我真的不知道你在这里问什么，所以我猜：

```
abstract class MyBase
{
    protected MyBase(string foo) { }
}

class Child : MyBase
{
    public Child(string foo)
        : base(foo) 
    { }
} 
```

如果它不是构造的一部分，您将无法“调用”它，`Child`因为您无法实例化抽象类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-27T10:44:42.960

没有任何背景很难帮助你，但我会尽力的。也许你可以做这样的事情：

```
 abstract class MyBase
    {
      protected string _foo;
      protected MyBase(string foo) 
      {
         _foo = foo;
      }
    }

    class Child : MyBase
    {
        public Child()
        :base(string.Empty)
        {}

       public string Foo 
       {
        get 
        {
           return _foo;
         }
         set
         { 
           _foo = value;
          }
    }
} 
```

因此，由于您无法实例化抽象类，您可以创建`var obj = new Child() {Foo = "string"};` 但只有当您`MyBase`持有该`foo`值时，您才能选择此变体。但是，如果您可以更改`Child`，最好添加一个构造函数，正如@Adam Houldsworth 建议的那样。

# asp.net - 减少 ASP.NET 中的冗余查询

> ID：11686114
> 
> 赞同：0
> 
> 时间：2012-07-27T10:36:07.710
> 
> 标签：asp.net, sql, vb.net

我有一个包含大量单独页面的 ASP.NET（vb.net 而不是 c#）网站。为了减少重复代码，我将站点的主模板作为母版页。

有一个特定的变量（我们称之为销售），它用于每个页面和母版页。

目前，我在每个页面中都有一个简单的 SQL 查询，并且在每次加载页面时运行的母版页中都有一个简单的 SQL 查询，以检查 Sale 的值是什么（1 或 0），并且取决于那个值不同部分的代码显示。

我的问题是，这似乎（对我来说）很多冗余/重复的 SQL 调用。

我可以将 Sale 的值写入会话变量，但由于种种原因，这并不实际，那么还有哪些其他选项可供我使用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T11:04:41.753

asp.net 提供了非常好的缓存机制。这将允许您缓存所需的任何对象。

这个话题比较广泛，所以我只给你几个提示：

[缓存应用程序数据](http://msdn.microsoft.com/en-us/library/6hbbsfk6%28v=vs.100%29.aspx)

[将项目添加到缓存](http://msdn.microsoft.com/en-us/library/18c1wd61.aspx)

由于您希望优化查询，请查看[SqlCacheDependency](http://msdn.microsoft.com/en-us/library/ms178604.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T10:48:54.913

如果每个实例的数据都相同，

在您的站点中维护一个公共静态对象并将您的数据保存在该静态变量中`Application_Start`的文件事件中`global.asax`，该静态对象也可以在每个页面和母版页上访问，

但要注意使用静态对象的缺点，更多信息请[点击此处](http://blog.aggregatedintelligence.com/2009/01/static-variables-and-their-implications.html)

# c# - 在多个组合框 selectedindexchanged hv 上启用按钮 - C#

> ID：11686123
> 
> 赞同：0
> 
> 时间：2012-07-27T10:36:34.053
> 
> 标签：c#

我有 8`comboboxes`个，如果用户更改任何一个`combobox`值，我必须启用一个按钮。我`SelectedIndexChanged`为每个组合框添加了事件。并尝试像这样检查。

```
if (
  cmbDInput_SelectedIndexChanged || cmbSwitch_SelectedIndexChanged ||
  cmbSatName_SelectedIndexChanged || cmbDRepeat_SelectedIndexChanged ||
  cmbSeq_SelectedIndexChanged
) 
```

但它会引发错误

> 运算符`||`不能应用于“方法组”和“方法组”类型的操作数

任何建议如何做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T10:39:07.337

您必须创建一个方法，例如 EnableButton

```
private void EnableButton()
{
   myButton.Enabled = true;
} 
```

然后在您选择的所有索引更改事件中调用此方法

```
private void cmbDInput_SelectedIndexChanged(.....)
{
   EnableButton();
} 
```

为您的所有选择索引更改事件执行此操作

或者您可以为所有下拉框设置 1 个事件

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T10:41:17.620

您正在使用方法名称，即`cmbDInput_SelectedIndexChanged`if 语句表达式`||`运算符中的事件应应用于布尔值。

```
if ((cmbDInput_SelectedIndexChanged) || cmbSwitch_SelectedIndexChanged || cmbSatName_SelectedIndexChanged || cmbDRepeat_SelectedIndexChanged || cmbSeq_SelectedIndexChanged) 
```

将会

```
if ((cmbDInput.SelectedIndex !- -1) || cmbSwitch.SelectedIndex != -1|| cmbSatName.SelectedIndex !- -1 || cmbDRepeat_.SelectedIndex != -1 || cmbSeq.SelectedIndex != -1) 
```

或者您可以获取事件的来源，即所选索引更改的组合如下

```
protected void cmbDInput_SelectedIndexChanged(object sender, System.EventArgs e)
{
    ComboBox ChangedCombox = sender as ComboBox;
} 
```

# azure - Azure：什么时候应该使用启动任务？

> ID：11686125
> 
> 赞同：1
> 
> 时间：2012-07-27T10:36:42.983
> 
> 标签：azure, startup

我了解启动任务用于设置您的系统。例如，如果您的代码是用 Python 编写的，您可以添加启动任务来安装 Python。但是这也不能在 ProgramEntryPoint 批处理脚本中完成吗？有什么不同？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-27T10:48:54.273

确实，如果您使用 ProgramEntryPoint，似乎没有理由使用启动任务。您确实可以在同一个批处理文件中包含所有逻辑。

使用 .NET WebRoles/WorkerRoles 时，启动任务会变得更加有用。在那里，您只能选择编写代码（您可以再次调用单个批处理文件调用其他批处理文件）和/或使用启动任务。

但是，如果您从维护的角度来看它，那么将启动任务用于与配置和安装实例有关的所有事情都会更加简洁。您在配置/安装和您的实际应用程序之间划清界限——您实际上可以将其视为关注点分离（这对于项目中的其他/新开发人员来说很容易理解）。

除此之外，您必须知道，当您使用任务时，您可以在不同的**上下文**（受限/提升）中执行任务，这从安全角度来看可能很重要。任务以不同的**类型**（简单、后台、前台）存在，可以在许多不同的场景中使用（例如，不断 ping 您的站点的后台应用程序）。如果您不使用任务，则可能需要自己处理所有这些。

这是一篇很好的博客文章，涵盖了启动任务的详细信息：[Using Startup Task in Windows Azure 详细总结](http://blogs.msdn.com/b/avkashchauhan/archive/2011/03/17/using-startup-task-in-windows-azure-detailed-summary.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-18T08:24:46.603

您可能无法从 ProgramEntryPoint 安装 Python，因为安装可能需要提升（“管理员”）权限。

角色（网络/工作人员）通常没有提升的特权（这可能是可能的，但出于明显的安全原因，这是一种不好的做法）。因此 ProgramEntryPoint 中的代码没有提升的特权。

另一方面，启动任务可以具有提升的特权。IMO，这可能是使用启动任务的最大（单一？）好处。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-29T01:18:04.833

桑德里诺的回答很好。简而言之 - 如果您希望在您的角色开始之前执行（或开始执行）一些代码，您将使用启动任务。如果这不是约束，您始终可以从 Role 的 OnStart 方法执行任何进程（包括批处理脚本）。我过去使用启动任务的一种情况是安装 NewRelic 监控代理。我希望在实际应用程序启动之前运行它来分析我的应用程序。

# iphone - 在 iphone 中使用 UIImagePickerControllerSourceTypeCamera 拍摄超过 6 张照片后应用程序崩溃

> ID：11686126
> 
> 赞同：1
> 
> 时间：2012-07-27T10:36:43.993
> 
> 标签：iphone, memory-leaks, uiimagepickercontroller, didreceivememorywarning

我在我的应用程序中使用相机，该应用程序在拍摄超过六张照片后崩溃并且崩溃日志是`Memory warning received`。我正在保存图像，

```
UIImage *image = [info objectForKey:@"UIImagePickerControllerOriginalImage"];
   // Save image
UIImageWriteToSavedPhotosAlbum(image, self, @selector(image:didFinishSavingWithError:contextInfo, nil);
[imagesArray addObject:image]; 
```

请帮帮我。

提前致谢..

# jsf-1.2 - 如何在渲染器中读取 bean 值

> ID：11686127
> 
> 赞同：0
> 
> 时间：2012-07-27T10:36:53.053
> 
> 标签：jsf-1.2, renderer

我正在为复选框和单选按钮编写一个自定义 jsf ，以便在没有元素`Renderer`的情况下呈现。`TABLE`我的问题是如果我有一个像下面这样的选择框

```
 <h:selectManyCheckbox id="vehicle" value="#{pageBean.vehicle}>
       <f:selectItems value="#{pageBean.vehiclesList} />
    </h:selectManyCheckbox> 
```

在`encodeBegin`方法中我如何阅读`vehiclesList`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T13:19:08.440

这是直截了当的。

```
Iterator<UIComponent> iterator = component.getFacetsAndChildren();

while (iterator.hasNext()) {
    UIComponent childComponent = iterator.next();
    List vehicles = childComponent.getValueExpression("value").getValue(context.getELContext);
    // Do whatever with vehicles.
} 
```

在这里，我假设主要组件只有一个子组件，即 SelectItems。

# jquery - 将 Twitter 引导程序与 osCommerce 集成

> ID：11686128
> 
> 赞同：1
> 
> 时间：2012-07-27T10:36:59.843
> 
> 标签：jquery, css, jquery-ui, twitter-bootstrap, oscommerce

我正在使用 osCommerce（要求）开发在线商店，需要将其与[Twitter Bootstrap](http://twitter.github.com/bootstrap/index.html)集成，特别是 bootstap.css/bootstap.responsive.css 和 jQuery 插件。

我已经尝试了一些，但一切都变得非常错误，到处都是样式等等。osCommerce 使用 jQuery UI，那么我怎么可能使用[Twitter 引导 CSS + jQuery？](https://stackoverflow.com/questions/7331425/twitter-bootstrap-css-jquery)

还是有另一种方式，所以所有元素，按钮都像引导程序一样主题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-04-30T04:35:21.640

目前正在努力在此处提供 Bootstrap 实现：

[https://github.com/gburton/osCommerce-2334-bootstrap](https://github.com/gburton/osCommerce-2334-bootstrap)

演示站点位于：

[http://template.me.uk/2334bs3/](http://template.me.uk/2334bs3/)

这里讨论开发的论坛主题：

[http://forums.oscommerce.com/topic/396152-bootstrap-3-in-2334-responsive-from-the-get-go/](http://forums.oscommerce.com/topic/396152-bootstrap-3-in-2334-responsive-from-the-get-go/)

有计划将这项工作整合到 2.3.3.x 路线图中的正式版本中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T11:30:57.920

如果您愿意或需要，您仍然可以使用 jQuery UI。

这是一个完整的 jQuery UI 主题，看起来像 Addy Osmani 的 Twitter Bootstrap
[https://github.com/addyosmani/jquery-ui-bootstrap/](https://github.com/addyosmani/jquery-ui-bootstrap/)

演示：[http ://addyosmani.github.com/jquery-ui-bootstrap/](http://addyosmani.github.com/jquery-ui-bootstrap/)

# google-cloud-messaging - GCM 问题（谷歌云消息）

> ID：11686133
> 
> 赞同：1
> 
> 时间：2012-07-27T10:37:19.097
> 
> 标签：google-cloud-messaging

我有几个关于 GCM（谷歌云消息传递）的问题。

第一个问题是：我无法启动程序。它似乎总是崩溃：

清单：

```
 <manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.gcmtutorial"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="8"
        android:targetSdkVersion="15" />

    <permission android:name="com.example.gcmtutorial.permission.C2D_MESSAGE" android:protectionLevel="signature" />
<uses-permission android:name="com.example.gcmtutorial.permission.C2D_MESSAGE" /> 
<uses-permission android:name="com.google.android.c2dm.permission.RECEIVE" />
<!-- GCM connects to Google Services. -->
<uses-permission android:name="android.permission.INTERNET" /> 
<!-- GCM requires a Google account. -->
<uses-permission android:name="android.permission.GET_ACCOUNTS" />
<!-- Keeps the processor from sleeping when a message is received. -->
<uses-permission android:name="android.permission.WAKE_LOCK" />

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >

          <receiver android:name="com.google.android.gcm.GCMBroadcastReceiver" android:permission="com.google.android.c2dm.permission.SEND" >
              <intent-filter>
                <action android:name="com.google.android.c2dm.intent.RECEIVE" />
                <action android:name="com.google.android.c2dm.intent.REGISTRATION" />
                <category android:name="com.example.gcmtutorial" />
              </intent-filter>
            </receiver>

        <service android:name=".GCMIntentService" />
        <activity
            android:name=".MainActivity"
            android:label="@string/title_activity_main" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>

    </application>

</manifest> 
```

代码是：

```
package com.example.gcmtutorial;

import android.os.Bundle;
import android.app.Activity;
import android.util.Log;
import android.view.Menu;

import com.google.android.gcm.GCMRegistrar;

public class MainActivity extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        GCMRegistrar.checkDevice(this);
        GCMRegistrar.checkManifest(this);

        final String regId = GCMRegistrar.getRegistrationId(this);
        if (regId.equals("")) {
          GCMRegistrar.register(this, "714669202278");
        } else {
          Log.v("Registered", "Already registered");
        }

        setContentView(R.layout.activity_main);
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }
} 
```

我收到的错误是

```
07-27 18:11:23.504: E/AndroidRuntime(11390): FATAL EXCEPTION: main
07-27 18:11:23.504: E/AndroidRuntime(11390): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example.gcmtutorial/com.example.gcmtutorial.MainActivity}: java.lang.SecurityException: Not allowed to start service Intent { act=com.google.android.c2dm.intent.REGISTER pkg=com.google.android.gsf (has extras) } without permission com.google.android.c2dm.permission.RECEIVE
07-27 18:11:23.504: E/AndroidRuntime(11390):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2205)
07-27 18:11:23.504: E/AndroidRuntime(11390):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2240)
07-27 18:11:23.504: E/AndroidRuntime(11390):    at android.app.ActivityThread.access$600(ActivityThread.java:139)
07-27 18:11:23.504: E/AndroidRuntime(11390):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1262)
07-27 18:11:23.504: E/AndroidRuntime(11390):    at android.os.Handler.dispatchMessage(Handler.java:99)
07-27 18:11:23.504: E/AndroidRuntime(11390):    at android.os.Looper.loop(Looper.java:156)
07-27 18:11:23.504: E/AndroidRuntime(11390):    at android.app.ActivityThread.main(ActivityThread.java:4987)
07-27 18:11:23.504: E/AndroidRuntime(11390):    at java.lang.reflect.Method.invokeNative(Native Method)
07-27 18:11:23.504: E/AndroidRuntime(11390):    at java.lang.reflect.Method.invoke(Method.java:511)
07-27 18:11:23.504: E/AndroidRuntime(11390):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
07-27 18:11:23.504: E/AndroidRuntime(11390):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
07-27 18:11:23.504: E/AndroidRuntime(11390):    at dalvik.system.NativeStart.main(Native Method)
07-27 18:11:23.504: E/AndroidRuntime(11390): Caused by: java.lang.SecurityException: Not allowed to start service Intent { act=com.google.android.c2dm.intent.REGISTER pkg=com.google.android.gsf (has extras) } without permission com.google.android.c2dm.permission.RECEIVE
07-27 18:11:23.504: E/AndroidRuntime(11390):    at android.app.ContextImpl.startService(ContextImpl.java:1356)
07-27 18:11:23.504: E/AndroidRuntime(11390):    at android.content.ContextWrapper.startService(ContextWrapper.java:359)
07-27 18:11:23.504: E/AndroidRuntime(11390):    at com.google.android.gcm.GCMRegistrar.internalRegister(GCMRegistrar.java:229)
07-27 18:11:23.504: E/AndroidRuntime(11390):    at com.google.android.gcm.GCMRegistrar.register(GCMRegistrar.java:217)
07-27 18:11:23.504: E/AndroidRuntime(11390):    at com.example.gcmtutorial.MainActivity.onCreate(MainActivity.java:24)
07-27 18:11:23.504: E/AndroidRuntime(11390):    at android.app.Activity.performCreate(Activity.java:4538)
07-27 18:11:23.504: E/AndroidRuntime(11390):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1071)
07-27 18:11:23.504: E/AndroidRuntime(11390):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2161)
07-27 18:11:23.504: E/AndroidRuntime(11390):    ... 11 more 
```

我已经谷歌了他们，但似乎没有解决方案。

我的第二个问题是：How can I write a php server using GCM I have to: [GCM sent with curl (php)](https://stackoverflow.com/questions/11396177/gcm-sending-with-curl-php) [GCM with PHP (Google Cloud Messaging)](https://stackoverflow.com/questions/11242743/gcm-with-php-google-cloud-messaging)

我不明白的是注册ID是什么意思

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T07:19:29.937

在清单中尝试使用 package.GCMIntentService

# java - 从 org.apache.camel.Exchange 获取 SOAPMessage

> ID：11686135
> 
> 赞同：0
> 
> 时间：2012-07-27T10:37:28.407
> 
> 标签：java, soap, cxf, apache-camel, apache-karaf

我需要从我在 spring bean 中收到的交换对象中获取 SOAP 消息。

我有一条骆驼路线，它从服务端点路由到我的 java bean。Spring 中声明的 Java Bean 和 Camel 路由如下所示：

```
<bean id="processor" class="com.groupgti.esb.camel.wrapper.gradireland.userregistration.UserRegistrationProcessor">

<camel:route id="route">
    <camel:from uri="cxf:bean:myListenerEndpoint?dataFormat=PAYLOAD&amp;synchronous=true" />
    <camel:bean ref="processor" />
    <camel:to uri="cxf:bean:myTargetEndpoint"/>
</camel:route> 
```

在我的 java bean 中，我收到了交换对象：

```
@Override
public SOAPMessage processMessage(Exchange exchange) {
    Object object = exchange.getIn().getHeaders().get("CamelCxfMessage");
    LOGGER.debug("Object: " + object);
    SOAPMessage message = null;

    if (object instanceof SOAPMessage) {
        message = (SOAPMessage) object;
        LOGGER.debug("Got message: " + message);
    }

    LOGGER.debug("Sending message...");
    return message;
} 
```

问题是我无法从交换中获取 SOAP 消息。我骆驼网站，[在这里](http://camel.apache.org/cxf-example.html)我发现我必须使用它来获取 SOAP 消息：

```
SOAPMessage soapMessage = (SOAPMessage) exchange.getIn().getBody(List.class).get(0); 
```

但他给了我`NullPointerException`一些深刻的交换。

我试图调试并查看对象树。我发现我可以收到这样的消息：

```
SOAPMessage soapMessage = (SOAPMessage) exchange.getIn().getHeaders().get("CamelCxfMessage"); 
```

但这给了我这个例外：

```
org.apache.camel.ExpectedBodyTypeException: Could not extract IN message body as type: interface javax.xml.transform.Source body is: null 
```

我被困在这里。也许有人知道问题出在哪里？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T14:22:08.803

PAYLOAD 模式不是很简单，也许你应该尝试 CXF 的 POJO 模式，并摆脱 SoapMessage。您必须使用 JAXB 注释声明 POJO，例如

```
@XmlAccessorType(XmlAccessType.FIELD)
public class Registration {

    private Long roomNumber;
    ...

} 
```

这将允许您直接在处理器中的注册类上工作（我认为这是您的最终目标）。

```
Registration registration = exchange.getIn().getBody(Registration.class); 
```

如果您坚持使用 PAYLOAD 模式，请注意您可以编写

```
SOAPMessage soapMessage = exchange.getIn().getHeader(CxfConstants.CAMEL_CXF_MESSAGE, SOAPMessage.class); 
```

# android - 如何使用其他模拟器设备控制我的 Google TV 模拟器

> ID：11686137
> 
> 赞同：1
> 
> 时间：2012-07-27T10:37:29.177
> 
> 标签：android

我在 ubuntu 12.0.4 LTS 中工作，我想用另一个模拟器作为遥控器来控制我的 Google TV 模拟器（由 android sdk 3.1 提供）。

我已经尝试在我的应用程序中将 android 库导入到 eclipse 和 androidLibrary.jar 中，但没有成功。

希望你能帮助我。

# android - 如何根据方向自动调整操作栏微调器中的字体大小？

> ID：11686138
> 
> 赞同：5
> 
> 时间：2012-07-27T10:37:33.047
> 
> 标签：android, android-layout

我想在操作栏中放置一个微调器，就像在 Gmail 应用中一样。所以我创建了以下布局。

```
 <?xml version="1.0" encoding="utf-8" ?> 
  <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android" 
 android:orientation="vertical"
 android:layout_width="match_parent"
 android:layout_height="match_parent">
  <TextView android:id="@+id/spinner_list_item_selected_header" 
android:layout_width="match_parent" 
android:layout_height="wrap_content" 
android:layout_gravity="center" 
android:textStyle="bold" 
android:gravity="center" 
android:text="Sales" /> 
      <TextView android:id="@+id/spinner_list_item_selected_text"  android:layout_width="match_parent"
android:layout_height="wrap_content" 
android:layout_gravity="center" 
android:textStyle="bold" 
android:gravity="center" 
android:text="" /> 
      </LinearLayout> 
```

然后使用以下代码将此微调器加载到标题栏：

```
getActionBar().setNavigationMode(ActionBar.NAVIGATION_MODE_LIST);
getActionBar().setListNavigationCallbacks(mSpinnerAdapter, mOnNavigationListener); 
```

它按预期工作，除了在横向模式下，文本不适合。在 Gmail 应用程序中，字体大小会减小。**有没有办法根据方向自动调整字体大小？**

![Gmail 肖像](../Images/c58cfe9ab40e836a413a0907ea4ec9c5.png)

![Gmail 风景](../Images/0c2699c29b3a16a07c49fe783ed4a89a.png)

![我的肖像](../Images/de6abed4db9248876150cb9eae23239c.png)

![我的风景](../Images/cb917244413317105564e1d966e7a8bf.png)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-27T11:03:30.460

//你需要在值文件夹中使用dimens.xml

```
<!-- Text size for action bar titles -->
    <dimen name="action_bar_title_text_size">18dp</dimen>
    <!-- Text size for action bar subtitles -->
    <dimen name="action_bar_subtitle_text_size">14dp</dimen>
    <!-- Top margin for action bar subtitles -->
    <dimen name="action_bar_subtitle_top_margin">-3dp</dimen>
    <!-- Bottom margin for action bar subtitles -->
    <dimen name="action_bar_subtitle_bottom_margin">5dip</dimen> 
```

再创建一个带有 values-land 的文件夹

在那个dimens.xml

```
 <!-- Text size for action bar titles -->
    <dimen name="action_bar_title_text_size">16dp</dimen>
    <!-- Text size for action bar subtitles -->
    <dimen name="action_bar_subtitle_text_size">12dp</dimen>
    <!-- Top margin for action bar subtitles -->
    <dimen name="action_bar_subtitle_top_margin">-2dp</dimen>
    <!-- Bottom margin for action bar subtitles -->
    <dimen name="action_bar_subtitle_bottom_margin">4dip</dimen> 
```

**参考：**去你的`/<android-sdk>/platforms/android-15/data/res`这里你可以找到这个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T10:46:22.573

他们最好的方法是在活动开始时知道设备的方向，并根据它使用布局。

如果纵向 setContentView(R.layout.layout_with_bigfont);

如果 lanscape setContentView(R.layout.layout_with_smallfont);

否则，您需要单独使用 setTextSize(xdp) 动态设置该视图（在本例中为 TextView）的字体，而不是针对不同方向使用 2 个不同的布局

# iphone - 如何读取 .docx 文件并在 UITextView 中显示其内容？

> ID：11686142
> 
> 赞同：0
> 
> 时间：2012-07-27T10:37:42.360
> 
> 标签：iphone, nsstring, nsfilemanager, docx, nsdocumentdirectory

我试过这个：

```
 BOOL success; 
  NSFileManager *fileManager = [NSFileManager defaultManager]; 
  NSError *error; 
  NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, 
                                     NSUserDomainMask, YES); 
  NSString *documentsDirectory = [paths objectAtIndex:0]; 

  NSString *writableDBPath = [documentsDirectory 
                              stringByAppendingPathComponent:@"FT1.docx"]; 
  success = [fileManager fileExistsAtPath:writableDBPath];
  NSLog(@"writableDBPath : %@", writableDBPath);

  NSString *str = [NSString stringWithContentsOfFile:writableDBPath 
                            encoding:NSUTF8StringEncoding error:&error];
  NSLog(@"My Data From File : %@",str); 
```

但`str`打印`(null)`。该文件存在于文档目录中。

那么，我该怎么做呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-07-18T08:18:10.827

您可以使用这个免费库来呈现 docx 文档。他们还提供用于本地编辑的 SDK，但它是付费的。看看：[http ://www.mswordsdk.com](http://www.mswordsdk.com)

```
-(void)presentWordViewController:(NSString *)path {
if (nil==self.wordViewController) {
    self.wordViewController=[[WordViewController alloc] initWithNibName:nil bundle:nil];
    UIBarButtonItem *fixedSpace=[[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemFixedSpace target:nil action:nil];
    fixedSpace.width=80;
    self.wordViewController.titleBar.items=[NSArray arrayWithObjects:[[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemDone target:self.wordViewController action:@selector(dismissWordViewController)] ,
                                            fixedSpace,
                                            [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemFlexibleSpace target:nil action:nil],
                                            self.wordViewController.pageInfoBarButtonItem,
                                            [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemFlexibleSpace target:nil action:nil],
                                            [[UIBarButtonItem alloc] initWithTitle:@"PDF" style:UIBarButtonItemStyleBordered target:self action:@selector(pdfQuickLook:)],
                                            nil];
}

if (nil==self.modalNavigationConroller) {
    self.modalNavigationConroller=[[UINavigationController alloc]initWithRootViewController:self.wordViewController];
    [self presentViewController:self.modalNavigationConroller animated:YES completion:nil];
} else {
    if (nil==self.modalNavigationConroller.presentingViewController) {
        [self presentViewController:self.wordViewController.navigationController animated:YES completion:nil];
    }
}
[self.wordViewController loadDocument:[WordViewControllerDocument documentWithURL:[NSURL fileURLWithPath:path] andTitle:nil]]; 
```

}

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T11:26:56.123

尝试这个 ：

```
- (void)viewDidLoad
{
 webView = [[UIWebView alloc] initWithFrame:CGRectMake(0, 0, 0, 0)];
    [webView setDelegate:self];
    NSURL *url = [NSURL fileURLWithPath:yourFilePath];
    NSURLRequest *request = [NSURLRequest requestWithURL:url];
    [webView loadRequest:request];
}
- (void)webViewDidFinishLoad:(UIWebView *)webView{
    NSString *document = [theWebView stringByEvaluatingJavaScriptFromString:@"document.documentElement.innerText"];
    NSLog(@"%@",document);
} 
```

# windows - 从任务计划的 Windows 批处理文件中杀死进程树

> ID：11686143
> 
> 赞同：2
> 
> 时间：2012-07-27T10:37:45.370
> 
> 标签：windows, process, scheduled-tasks, kill, taskkill

我创建了一个 Windows 任务，该任务在具有最高权限的管理员帐户上运行，每分钟运行一个批处理文件。

此批处理文件将执行 PHP 脚本来检索网页，然后检查是否没有返回页面或返回错误内容。

如果结果是否定的，那么批处理例程会使用 taskkill 杀死 httpd 进程及其子进程（我目前正在处理导致 Apache Http 进程也挂起的 PHP 挂起）。

当以管理员身份登录机器时执行时，整个过程完美运行。但是，当作为任务执行时（尽管具有管理员权限），该进程不会被杀死。没有事件或调试条目。

所以我的问题是为什么 task kill 无法杀死进程，我怎样才能获得更多信息以及存在哪些替代方案？

# ios5 - iOS手势识别与处理

> ID：11686151
> 
> 赞同：2
> 
> 时间：2012-07-27T10:38:13.357
> 
> 标签：ios5, uiscrollview, gesture

我在它下面有透明的 UIImageView 和 UIScrollView ，我希望 UIImageView 能够识别和处理左右滑动手势，并将滚动向上和向下传递给 UIScrollView 我该怎么做？

我将滑动手势添加到图像视图并处理它们，但我没有找到将滚动从 UIImage 传递到 UIScroll

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T11:08:51.620

您可以将滚动视图的[userInteractionEnabled](https://developer.apple.com/library/ios/documentation/UIKit/Reference/UIView_Class/UIView/UIView.html#//apple_ref/occ/instp/UIView/userInteractionEnabled)`NO`属性设置为并添加几个手势识别器来处理不同的事件（水平和垂直滚动）。

# javascript - Dojo：无法读取 AccordionContainer.js 上未定义的属性“h”？

> ID：11686153
> 
> 赞同：3
> 
> 时间：2012-07-27T10:38:13.653
> 
> 标签：javascript, dojo, accordion

当我在手风琴容器下动态创建两个手风琴容器时，我遇到了这样的错误。

当我创建任何这些单个手风琴容器而不是同时创建两个容器时，将不会发生该错误。

> 错误 ：
> 
> **无法读取 AccordionContainer.js 上未定义的属性“h”**

我通过将这些行添加到工具包文件 dojo-toolkit\dijit\layout\AccordionContainer.js 暂时解决了这个问题

```
Line 91: + if(this._contentBox) 
Line 92:    this._verticalSpace=_34.h-_35-_2f.h-_30.h-_32.h-_33.h-_2d._buttonWidget.getTitleHeight(); 
Line 93: + if(this._contentBox) 
Line 94:    this._containerContentBox={h:this._verticalSpace,w:this._contentBox.w-_2f.w-_30.w-_32.w- _33.w}; 
```

**Accordion Widget 创建代码结构是**

```
define("test/project", [ 
        "dojo/_base/declare", 
        "dijit/_Widget", 
        "dijit/layout/AccordionContainer"], 
    function(declare, _Widget, AccordionContainer) { 
        return declare([_Widget],{ 
                         postCreate: function() { 
                                var new_acc = new AccordionContainer({ 
                                        id: "new_acc", 
                                        title: "Approval ("+this.count+")" 
                                }); 

                               this.parentId.addChild(new_acc); 
                        } 
        });     
}); 
```

有什么想法可以解决这个问题吗？

提前致谢...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-01-19T07:24:49.070

我面临同样的问题，但我想通了。当您尝试在 aContainer.startup() 之后在手风琴中创建另一个孩子时；方法，它将生成相同的错误消息。启动方法启动手风琴，它将动态地将高度和宽度应用到该手风琴，如果您在创建手风琴后再次为其创建一个孩子，它将引发错误“无法读取 AccordionContainer.js 上未定义的属性 'h'”

```
 aContainer = new AccordionContainer({ style: "height: 300px" },acdic);
        aContainer.addChild(new ContentPane({
            title: "This is a content pane",
            content: "Hi!"
        }));

        aContainer.addChild(new ContentPane({
            title: "This is as well",
            content: "Hi how are you?",
            id: "pane1"
        }));
        aContainer.startup();            
        aContainer.addChild(new ContentPane({
            title: "This too",
            content: "Hello im fine.. thnx"
        })); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-21T23:17:33.540

此问题的一种解决方案是**首先**将子项添加到 AccordianContainer，**然后**将 AccordianContainer 添加到父项。

# android - 安卓服务，蓝牙

> ID：11686154
> 
> 赞同：1
> 
> 时间：2012-07-27T10:38:25.380
> 
> 标签：android, bluetooth

我有一些`service framework`关于安卓手机的问题。写这篇文章时，我确实在 `bluetoothserversocket`内部创建了一个`thread`. 该线程是从`Activity`. 但是当活动关闭时，套接字当然也会关闭。我的问题是，当应用程序重新启动时，android 系统为此选择了一个随机通道`bluetoothserversocket`。我想知道我是否可以创建一个服务来创建它`serversocket`并从`Activity`应用程序关闭时服务器套接字会关闭吗？我看过一些关于这个的例子，有一个`implemeted`方法叫做

```
 @Override
   public void onDestroy() {
      //code to execute when the service is shutting down
   } 
```

应用程序关闭时会调用此方法吗？换句话说，我需要一个在手机开机时一直运行的服务。

# sql - 删除唯一约束的过程

> ID：11686155
> 
> 赞同：1
> 
> 时间：2012-07-27T10:38:26.240
> 
> 标签：sql, sql-server-2008, unique-constraint, sql-drop

我正在尝试编写一个过程来更快地从任何表中删除唯一约束。

```
IF EXISTS
        (SELECT * 
        FROM dbo.sysobjects 
        WHERE id = object_id(N'[dba].[spu_drop_uq_index]'))
    DROP PROCEDURE [dba].[spu_drop_uq_index]
GO

CREATE PROCEDURE [dba].[spu_drop_uq_index] (@table varchar(1000), @index varchar(1000))
AS
BEGIN
    DECLARE @sql varchar(1000)
    SET @sql = 'ALTER TABLE ['+@table+'] DROP CONSTRAINT ['+@index+']'
    IF EXISTS (SELECT name FROM sysindexes WHERE name = @index)
        EXEC @sql
END    
GO

EXEC [dba].[spu_drop_uq_index] @table = 'aaa', @index = 'UQ_xxx'
GO 
```

但我收到一个错误：

```
The name 'ALTER TABLE [aaa] DROP CONSTRAINT [UQ_xxx]' is not a valid identifier. 
```

但是，如果我不是动态执行它，它会成功：

```
ALTER TABLE [aaa] DROP CONSTRAINT [UQ_xxx] 
```

我究竟做错了什么？：） 谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-27T10:39:37.273

采用

```
 exec sp_executesql @sql 
```

代替`EXEC`, 或将 the`@sql`放在括号中

```
 Exec (@sql) 
```

`sp_executesql`首选： http: [//msdn.microsoft.com/en-us/library/ms175170 (v=sql.105).aspx](http://msdn.microsoft.com/en-us/library/ms175170(v=sql.105).aspx)

> 要执行字符串，我们建议您使用 sp_executesql 存储过程而不是 EXECUTE 语句。因为这个存储过程支持参数替换，所以 sp_executesql 比 EXECUTE 更通用；并且因为 sp_executesql 生成的执行计划更有可能被 SQL Server 重用，所以 sp_executesql 比 EXECUTE 更有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T10:39:58.143

将 exec 字符串括在括号中：

```
EXEC  (@sql) 
```

执行动态字符串时，需要括号。执行存储过程时，它们不是。

# android - AudioRecord 无法初始化

> ID：11686160
> 
> 赞同：0
> 
> 时间：2012-07-27T10:38:46.540
> 
> 标签：android, voice-recording, android-audiorecord

我正在尝试使用录音机，但我收到非法参数异常，指出录音机未初始化。

我的代码就像[这里显示的一样](http://code.google.com/p/krvarma-android-samples/source/browse/trunk/AudioRecorder.2/src/com/varma/samples/audiorecorder/RecorderActivity.java)

```
private static final int RECORDER_SAMPLERATE = 44100;
private static final int RECORDER_CHANNELS = AudioFormat.CHANNEL_IN_STEREO;
private static final int RECORDER_AUDIO_ENCODING = AudioFormat.ENCODING_PCM_16BIT;

recorder = new AudioRecord(MediaRecorder.AudioSource.MIC,RECORDER_SAMPLERATE,  RECORDER_CHANNELS,RECORDER_AUDIO_ENCODING, bufferSize);                        
recorder.startRecording(); 
```

我看到了另一个似乎对某些人有用但对我 不起作用的[答案 AudioRecord 对象未初始化](https://stackoverflow.com/questions/4843739/audiorecord-object-not-initializing)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T11:24:50.007

试试这个：

```
private MediaRecorder mRecorder = null;
private void startRecording() {
        String fileSaveName = generateNameForAudioFile();
        mRecorder = new MediaRecorder();
        mRecorder.setAudioSource(MediaRecorder.AudioSource.MIC);
        mRecorder.setOutputFormat(MediaRecorder.OutputFormat.THREE_GPP);
        mRecorder.setOutputFile(fileSaveName);
        mRecorder.setAudioEncoder(MediaRecorder.AudioEncoder.DEFAULT);

        try {
            mRecorder.prepare();
        } catch (IOException e) {
            Log.e(LOG_TAG, "prepare() failed");
        }

        mRecorder.start();
    }

private void stopRecording() {
        startRecording.setEnabled(true);
        try {
            if (mRecorder != null) {
                mRecorder.stop();
                mRecorder.release();
                mRecorder = null;
            }
        } catch (Exception e) {
        }

    }

public String generateNameForAudioFile() {

        String audioName = GetrandFilename();
        mFileName = Environment.getExternalStorageDirectory().getPath() + "/"
                + audioName + "myaudio" + ".3gp";

        );
        return mFileName;
    }

@Override
    public void onPause() {
        super.onPause();

            try {
                if (mRecorder != null) {
                    mRecorder.stop();
                    mRecorder.release();
                    mRecorder = null;
                }
            } catch (Exception e) {
            }
              } 
```

让我知道这篇文章是否有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-28T10:13:59.737

我实际上是在做愚蠢的事情，我在应用程序标签内给予权限更正了它，它工作正常感谢大家的时间和支持

# objective-c - 如果 (tableView == self.searchDisplayController.searchResultsTableView ) 控制器不在条件内

> ID：11686162
> 
> 赞同：0
> 
> 时间：2012-07-27T10:38:51.483
> 
> 标签：objective-c, ios, xcode, uisearchbar, uisearchdisplaycontroller

在我的 iphone 应用程序中，我已经暗示**`UISearchDisplayController`**了，在**didSelectRowAtIndexPath**方法控制器内部搜索时没有进入条件

```
 if (tableView == self.searchDisplayController.searchResultsTableView ) 
```

我已经`UISearchDisplayController`在 XIB中添加了 并`UISearchDisplayDelegate,UISearchBarDelegate`在 xib 中添加了代表，谁能告诉我为什么控制器没有进入

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T12:12:08.247

`tableView`不等于`self.searchDisplayController.searchResultsTableView`

删除 if 语句或设置`tableView`等于`self.searchDisplayController.searchResultsTablevView`

如果您有多个表视图，您可能忘记将搜索结果表连接到适当的委托和数据源。

# java - 在 netbeans 运行时启用断言

> ID：11686166
> 
> 赞同：3
> 
> 时间：2012-07-27T10:38:53.497
> 
> 标签：java, netbeans, assertions

我尝试了一个[断言示例](http://www.roseindia.net/javatutorials/use-assertion-in-java.shtml)

它在命令提示符下工作正常。我使用以下命令运行代码。

`java -ea AssertionExample` 但是在 netBeans 中运行时没有显示异常示例描述了断言在运行时启用时将起作用所以我们添加`ea`.

我们如何在 netbeans 中启用断言？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-27T10:44:01.730

*   右键单击您的项目 > 属性 > 运行 > VM 选项
*   添加`-ea`在框中

# ms-word - Microsoft Word 2012 内容控件：对多个表格行进行分组

> ID：11686170
> 
> 赞同：0
> 
> 时间：2012-07-27T10:39:08.253
> 
> 标签：ms-word, openxml

我试图在 Word 表的多行周围添加富文本内容控件或组，以实现主从视图，在该视图中我可以有多个主行并在子行中显示详细信息。

有没有办法用 MS Word 将这些内容控件放在多行周围，或者我应该使用嵌套表（至少尝试这样做）。

在这个阶段，通过代码添加它们不是一种选择。

谢谢

编辑：显然您只能使用单行或整个表格，即使显然不应重复标题行！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-04T13:42:10.317

在 Microsoft Word 2013 中添加了一种新类型的控件，即重复部分内容控件。它完全符合您的要求。您可以在“增强内容控制”部分下阅读更多相关信息 @ [http://msdn.microsoft.com/en-us/library/office/ff838936(v=office.15 )。](http://msdn.microsoft.com/en-us/library/office/ff838936(v=office.15)

# c# - 打印共享点文档库中包含的文档

> ID：11686171
> 
> 赞同：1
> 
> 时间：2012-07-27T10:39:13.493
> 
> 标签：c#, javascript, sharepoint, customization, document-library

我需要一种从功能区打印库中选定文档的方法。据我了解，这必须通过脚本来完成。所以主要的困难似乎是所有事情都需要在客户端完成。另一个不那么微小的因素是它*是*一个通用的文档打印按钮，而不仅仅是用于 pdf 或办公文档。

有没有办法告诉操作系统/浏览器为每个选定的项目/文档启动其相应程序的打印选项/窗口？

此外，我希望这对文档库来说是通用的，所以我不能只将一个映射为远程磁盘。

想到的另一个*解决方案是将选定的文档传输到另一个文档库，由事件处理程序处理，该事件处理程序在将新项目添加到所述（隐藏的）文档库时运行必要的 C# 命令进行打印。*

想到的另一件事是基本上重申大多数打印驱动程序已经对“*打印到文件*”选项所做的事情，他们在其中创建预期材料的 pdf 文档，然后**只需**打印创建的 pdf。但是随后打印应用程序已经知道他们拥有的文件是正确/可接受的格式，并且只需将其转换为 pdf。

有什么方法可以使用操作系统打开/打印以使用正确的应用程序归档我的文档？

对脚本或 c# 部分的任何帮助都会很棒。谢谢你。

# ruby-on-rails - Rails3：在任何异常/崩溃时进入调试控制台

> ID：11686173
> 
> 赞同：2
> 
> 时间：2012-07-27T10:39:14.330
> 
> 标签：ruby-on-rails, ruby

如果应用程序有任何问题，是否可以自动进入 Ruby 调试器？

```
gem 'debugger', :git => 'https://github.com/cldwalker/debugger.git' 
```

目前我必须通过我的代码，并添加调试器语句，有时还要通过循环等来查找代码崩溃的位置。这是非常耗时且非常缓慢的故障排除。所以基本上我想要在应用程序回溯生成后立即调试控制台。

```
.. Exception Caught ..

app/admin/watchlists.rb:135:in `open'
app/admin/watchlists.rb:135:in `entries'
app/admin/watchlists.rb:135:in `block (4 levels) in <top (required)>' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-29T16:59:51.543

您可以使用[hijack](https://github.com/ileitch/hijack)获得一个 irb 会话。

# syntax - Erlang：为什么大于等于（=>）写成（>=）？

> ID：11686177
> 
> 赞同：3
> 
> 时间：2012-07-27T10:39:23.133
> 
> 标签：syntax, erlang, comparator

在 Erlang 中，`=>`用于比较两个变量会导致语法错误，您必须`>=`改用：

```
1> 10 => 5.
* 1: syntax error before: '>'
2> 10 >= 5.
true 
```

这是为什么？这同样适用于`<=`必须写为 的情况`=<`。这是因为 Erlang 总是使用这种语法，还是因为序列`=>`并`>=`在其他地方使用？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-27T13:58:58.037

只是为了确认其他人所说的：我们使用了与 Prolog 相同的比较运算符。我不能确定它为什么会这样，但一个原因可能是它离开`<=`并被`=>`用作“箭头”，这可能很有用。在 Prolog 中很容易定义新的操作符，所以即使它们不是用基本语言定义的，它们仍然非常有用：

```
:- op(Priority, Type, Operator). 
```

Erlang 中的`<=`运算符是一个二进制生成器，可用于列表/二进制推导。它的工作方式类似于`<-`二进制文件而不是列表。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-27T11:14:07.957

嗯，Erlang 的语法受到 Prolog 的影响，Prolog 使用相同的约定，所以这可能就是原因。

我不确定 Prolog 为什么使用`>=`and `=<`; `=>`并`<=`没有真正使用。我认为这是因为`=>`and`<=`是通常用于逻辑含义的运算符，因此使用它们进行比较确实很尴尬，尤其是在逻辑编程语言中。它也是更漂亮的恕我直言：b

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-27T10:46:04.243

这可能只是一个 Erlang 约定。我猜测的原因与我们如何发音这些符号有关：“大于或等于”、“小于或等于”。它实际上是 ASCII 中大于或等于/小于或等于符号的呈现，因此在某些时候有人决定标记应该是`<=`and `>=`，并且约定在大多数语言中都存在，但这是相当随意的。也许他们正试图为这些运算符的不对称性质创建某种表示。

还值得注意的是，许多语言`=>`用来表示某种箭头，例如将函数的主体与其参数分开，或者作为逻辑蕴涵。不确定是不是相反的。

编辑：Erlang 似乎`<=`在理解中使用，这就是为什么他们避免使用它作为比较运算符，而是选择了（稍微向后的）语法。

# jquery - PrimeFaces 中 JSF 组件的命名

> ID：11686179
> 
> 赞同：1
> 
> 时间：2012-07-27T10:39:29.390
> 
> 标签：jquery, primefaces

我有这个有效的代码，虽然我希望它会失败。接收焦点的组件是，`<p:inputText>`所以我希望它的名字是`custForm:panelGrid:name-id`（以反映`<p:inputText>`组件在`<p:panelGrid>`组件中的嵌入）。然而，唯一有效的命名是`custForm:name-id`. 似乎有一些 PrimeFaces 组件没有在限定名称中“插入”它们的**id 。**如果是这样，记录在哪里？

```
<h:form id="custForm" styleClass="jsfcrud_list_form">
<script type="text/javascript">
  function primeFacesId()
  {
        var original = 'custForm:name-id';
        var idToSetFocus = PrimeFaces.escapeClientId(original);
        $(idToSetFocus).focus();
  }
</script>
<script>
    jQuery(document).ready(function() {
        primeFacesId();
    });
</script>
<p:panelGrid columns="10" style="width: 98%;margin-left: 1%;margin-right: 1%;" id="panelGrid">
    <h:outputLabel for="name" value="Name:" />
    <p:inputText   id="name-id" value="#{customerLController.nameDBConstraint}" label="name" />
        (...) 
```

*[我在公司防火墙后面，由于“SO 需要来自另一个域的外部 JavaScript”，我将在几天内无法接受任何答案]*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T10:49:20.780

对于普通的 JSF，所有实现[NamingContainer](http://javaserverfaces.java.net/nonav/docs/2.1/javadocs/javax/faces/component/NamingContainer.html)接口的组件都将它们的 id 作为前缀添加到容器内的所有组件中。这是例如`h:form`或`h:dataTable`但不是`h:panelGrid`。您可以浏览[Mojarra 的 API 文档](http://javaserverfaces.java.net/nonav/docs/2.1/javadocs/index.html)以获取详细信息。

由于许多 Primefaces 组件都是从标准 JSF 组件派生的，我认为它们的行为是相似的。

更新：我在 3.2 版的 Primefaces 文档中发现了这一点：

> JSF h:form、datatable、composite组件是命名容器，另外tabView、accordionPanel、dataTable、dataGrid、dataList、carousel、galleria、ring、sheet和subTable是实现NamingContainer的PrimeFaces组件。

At least for `p:panelGrid` this is not true (and can be verified in the html source of the [PF showcase for the panelgrid](http://www.primefaces.org/showcase/ui/panelGrid.jsf)).

# powershell - 通过 Powershell 修改 .Net Applications .exe.config 文件设置值

> ID：11686181
> 
> 赞同：1
> 
> 时间：2012-07-27T10:39:36.510
> 
> 标签：powershell, app-config

我有一个 .Net 控制台应用程序，它有一个 App.Config / MyApplicationConsole.exe.config 文件。这个包含通过 VS 的属性管理器设置的设置，基本上看起来像这样：

```
<?xml version="1.0"?>
<configuration>
  <configSections>
    <sectionGroup name="applicationSettings" type="System.Configuration.ApplicationSettingsGroup, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
      <section name="My.Applications.Namespace.Properties.Settings" type="System.Configuration.ClientSettingsSection, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" requirePermission="false" />
    </sectionGroup>
  </configSections>
  <applicationSettings>
    <My.Applications.Namespace.Properties.Settings>
      <setting name="SettingsKeyABC" serializeAs="String">
        <value>SomeOtherValue</value>
      </setting>
      <setting name="SettingsKeyXYZ" serializeAs="String">
        <value>True</value>
      </setting>
    </Siemens.Med.CTE.PMP.Applications.JobExecutor.Properties.Settings>
  </applicationSettings>
  <system.diagnostics>
    <trace>
      <listeners>
        <add name="Gibraltar" type="Gibraltar.Agent.LogListener, Gibraltar.Agent" />
      </listeners>
    </trace>
  </system.diagnostics>
  <startup>
    <supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.0" />
  </startup>
</configuration> 
```

现在我想要/需要做的是修改“SettingsKeyXYZ”设置的（“True”）值，最好是通过powershell（作为我的同事设置）。有谁知道如何做到这一点？我发现的只是 Web.Configs 的示例，它们似乎与 VS 创建的示例略有不同。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T11:06:13.660

首先，xml 文本无效。第 10 行标记 (My.Applications.Namespace.Properties.Settings) 的结束标记在哪里。我更改了第 10 行以匹配结束标记。

加载文件（作为 xml），您必须将“My.Applications.Namespace.Properties.Settings”标签放在引号中，否则 powershell 将尝试将点之间的每个值解析为标签），将值更新为 False，然后保存文件。

```
[xml]$xml = Get-Content c:\App.Config
$xml.configuration.applicationSettings.'My.Applications.Namespace.Properties.Settings'.setting.value='False'
$xml.Save('c:\App.Config') 
```

# gnuplot - 使用不同颜色在 3d 中绘制块数据并在 Gnuplot 或 Octave 中平滑线条

> ID：11686182
> 
> 赞同：2
> 
> 时间：2012-07-27T10:39:39.093
> 
> 标签：gnuplot, octave

我正在尝试（使用 Gnuplot）从一个文件中绘制一些基本的 3d 数据，这非常像：

```
N     M    t1      t2       t3       t4
1000 1000 0.05268 0.04711 0.003947 0.003348
1000 2000 0.05743 0.04214 0.007577 0.006486
1000 3000 0.08465 0.04193 0.011329 0.009654

2000 1000 0.10726 0.08845 0.013593 0.012397
2000 2000 0.21065 0.10817 0.026525 0.024390
2000 3000 0.31528 0.16960 0.039772 0.036405

3000 1000 0.25415 0.14845 0.031082 0.026364
3000 2000 0.47345 0.25227 0.060887 0.051840
3000 3000 0.70612 0.36866 0.091311 0.077432 
```

这个想法是以某种方式绘制它，我可以看到每个 N 和 M 的 t1、t2、t3 和 t4。我知道，仅在一个图中绘制可能会有很多数据。首先，我从 t1 开始以这种方式绘制：

```
splot 'aux' u 1:2:3 w lp 
```

我得到类似的东西![在此处输入图像描述](../Images/1276ba81749af2aca51732627907b176.png)

我想对这些线条进行一些平滑处理并赋予它们不同的颜色。有什么办法可以为它做点什么吗？此外，以任何其他方式改进它的任何想法都会非常好。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-27T12:31:31.333

你是对的，这是很多数据。更改特定数据集的颜色非常简单：

```
splot "dataset" using 1:2:3 w lines linecolor rgb "green" 
```

请注意，您可以轻松地叠加多个图，如下所示：

```
splot "dataset" using 1:2:3 w lines lc rgb "green",\
      ""        using 1:2:4 w lines lc rgb "red" 
```

行尾的反斜杠是 gnuplot 的续行字符。请注意，它必须是*该行的最后一个字符*。我还使用了伪文件`""`，它只是 gnuplot 读取的最后一个文件的简写。最后，在第二个版本中，我使用`lc`了`linecolor`. gnuplot 解析器提供了很多速记，尽管我怀疑你在绘制`w lp`. （另外，请不要为你的地块选择红色和绿色。我认为 gnuplot 的最大缺陷之一是默认的前两种颜色是红色和绿色——20 人中有 1 人是红绿色盲）

平滑是另一回事（不幸的是）。 `plot`确实支持一个`smooth`选项

```
plot "dataset" using 1:2 smooth beizer with lines  #see help smooth for a list of options 
```

不幸的是，这个选项似乎不适用于`splot`. 此时，我将编写一个小型实用程序脚本，使用您最喜欢的平滑算法 ( `plot "<utility.script mydata" u 1:2:3 ...`) 以您最喜欢的语言对数据进行平滑处理。还有其他（仅 gnuplot）选项，但它们会很丑陋。顺便说一句，你有什么版本的 gnuplot？如果您认为仍然有必要，则 gnuplot 版本对于决定在 gnuplot 中进行平滑处理的最佳方式非常重要。

# django - 信号 m2m_changed 和 post_remove 错误

> ID：11686193
> 
> 赞同：6
> 
> 时间：2012-07-27T10:40:13.587
> 
> 标签：django, django-signals

我需要检测一个 post_remove 信号，所以我写了：

```
def handler1(sender, instance, action, reverse, model, pk_set, **kwargs):
if (action == 'post_remove'):
    test1()  # not declared but make a bug if it works, to detect :)

m2m_changed.connect(handler1, sender=Course.subscribed.through) 
```

如果我将 'post_remove' 更改为 'post_add' 就可以了。这是 django 关于 post_remove 的错误吗？

我使用该模型并在两个“订阅”值之间切换（因此添加一个，删除一个）

```
class Course(models.Model):
    name = models.CharField(max_length=30)
    subscribed = models.ManyToManyField(User, related_name='course_list', blank=True, null=True, limit_choices_to={'userprofile__status': 'student'}) 
```

我看到一个帖子有一个 django 的错误，也许它还没有被修复......（或者是我 ^^）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-27T11:34:24.973

据我了解，这不是错误，只是 Django 没有按照您期望的方式更新 m2m 关系。它不会删除要删除的关系然后添加新的关系。相反，它会清除所有 m2m 关系，然后再次添加它们。

有一个相关的问题[Django signal m2m_changed not trigger](https://stackoverflow.com/questions/6463863/django-signal-m2m-changed-not-triggered) which links to ticket [13087](https://code.djangoproject.com/ticket/13087)。

因此，您可以使用信号检查 `pre_clear`or`post_clear`操作`m2m_changed`，但由于这些操作不提供，因此它无法帮助您在保存之前找到相关条目，就像您在[其他问题](https://stackoverflow.com/questions/11678502/compare-field-before-and-after-save)`pk_set`中想要做的那样。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-16T12:28:16.943

感谢[Alasdairs的](https://stackoverflow.com/users/113962/alasdair) [评论](https://stackoverflow.com/questions/11686193/a-signal-m2m-changed-and-bug-with-post-remove#comment15495598_11686950)，我找到了解决方案并将其发布在这里 - 也许有人可以使用它。

**模型.py**

```
class Team(models.Model):
    name = models.CharField(max_length=100)
    members = models.ManyToManyField(User)

pre_save.connect(team_pre_save, sender=Team)
m2m_changed.connect(team_members_changed, sender=Team.members.through) 
```

**信号.py**

```
def team_pre_save(sender, instance, **kwargs):
    if instance.pk:
        instance._old_m2m = set(list(instance.members.values_list('pk', flat=True)))
    else:
        instance._old_m2m = set(list())

def team_members_changed(sender, instance, **kwargs):
    if kwargs['action'] == "post_clear":
        # remove all users from group
        group = Group.objects.get(name='some group')
        for member in instance._old_m2m:
            user = User.objects.get(pk=member)
            user.groups.remove(group)

    if kwargs['action'] == "post_add":
        added_members = list(kwargs['pk_set'].difference(instance._old_m2m))
        deleted_members = list(instance._old_m2m.difference(kwargs['pk_set']))

        if added_members or deleted_members:
            # we got a change - do something, for example add them to a group?
            group = Group.objects.get(name='some group')

            for member in added_members:
                user = User.objects.get(pk=member)
                user.groups.add(group)

            for member in deleted_members:
                user = User.objects.get(pk=member)
                user.groups.remove(group) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-09-05T13:30:48.723

经过长时间的搜索，我得出了一个结论首先我的问题：我有一些如何从我的模型中更新一个属性以在我的 m2m 为空时将其设置为 False，如果它至少有 1 个项目，则为 true，所以，真正的事情有效，但是当我尝试“pre_remove”或“post_remove”时永远不会被触发，所以在尝试了一些不同的例子后，我在这个“pre_clear”上看到了一些奇怪的东西，每次我改变我的m2m这总是有最后一个值，所以我设法从我的 m2m 中强制删除这些值，这样它会触发 pre_remove 和 post_remove，所以这对我有用，请参见下面的代码

所以现在我可以根据我的 m2m 自动设置 ativo True 或 False

```
class Servico(BaseMixin):
    descricao = models.CharField(max_length=50)

#This inheritance from User of django that has is_active boolean field
class UsuarioRM(Usuario):
    servicos = models.ManyToManyField(Servico,related_name='servicos_usuario', blank=True)

# SIGNALS
from django.db.models import signals
from django.db.models.signals import m2m_changed

def usuariorm_servicos_changed(sender, **kwargs):
    action = kwargs.pop('action', None)
    pk_set = kwargs.pop('pk_set', None)
    instance = kwargs.pop('instance', None)

    if action == "pre_clear":
        if instance.servicos.all():
        servicos = instance.servicos.all()
            for servico in servicos:
                instance.servicos.remove(servico)
            instance.save()
    else:
        instance.is_active = False
        instance.save() 
        if action == "post_add":
            if pk_set:
            instance.is_active = True 
        else:
            instance.is_active = False

        instance.save()

 m2m_changed.connect( usuariorm_servicos_changed, sender=UsuarioRM.servicos.through ) 
```

# java - 通过jni将jint数组从c返回到java

> ID：11686200
> 
> 赞同：9
> 
> 时间：2012-07-27T10:40:35.367
> 
> 标签：java, java-native-interface

我在java中创建了一个整数数组并通过jni将数组传递给cpp程序我的代码是：

```
import java.util.*;

class SendArray {
  //Native method declaration
  native int[] loadFile(int[] name);
  //Load the library
  static {
    System.loadLibrary("nativelib");
  }

  public static void main(String args[]) {
    int arr[] = {1,2,3,4,5,6,7,8,9,10};
    //Create class instance
    SendArray mappedFile=new SendArray();
    //Call native method to load SendArray.java
    int[] buf = mappedFile.loadFile(arr);
    //Print contents of SendArray.java
    for(int i=0;i<buf.length;i++) {
      System.out.print(buf[i]);
    }
  }
} 
```

在 cpp 程序中，我正在反转数组并将数组返回给 java programee 我的代码是::

```
#include <iostream>

using namespace std;

JNIEXPORT jintArray JNICALL Java_SendArray_loadFile
  (JNIEnv * env, jobject jobj, jintArray array) {
          cout<<"Orignal Array is:"<<endl; 
          int i;
          jboolean j;
          int ar[100];
          // for(i = 0; i < 10; i++){
          int * p= env->GetIntArrayElements(array, &j);
          //jint *array=env->GetIntArrayElements(one, 0);
          //ar[i] = array[i];
          //}

          for(i = 0 ; i < 10 ; i++){
            cout << p[i];
          }

          for(i = 10 ; i > 0 ; i--){
            ar[10-i] = p[i];
          }
          jintArray ret = env->NewIntArray(10);

          for(i = 0; i >10 ; i++){
            ret[i]=ar[i];
          }
          return ret;
} 
```

我刚开始的错误是：

```
error: no match for 'operator=' in '*(ret +((long unsigned int)((long unsigned int)i))) = ar[i]' 
```

我应该怎么做才能将数组返回给java程序？？？？请帮忙！！！！！

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-08-09T07:58:12.077

将您的本机代码更改为此：

```
JNIEXPORT jintArray JNICALL Java_SendArray_loadFile(JNIEnv *env, jobject obj, jintArray oldArray) {
    const jsize length = env->GetArrayLength(oldArray);
    jintArray newArray = env->NewIntArray(length);
    jint *oarr = env->GetIntArrayElements(oldArray, NULL);
    jint *narr = env->GetIntArrayElements(newArray, NULL);

    for (int o = 0, n = length - 1; o < length; o++, n--) {
        narr[n] = oarr[o];
    }

    env->ReleaseIntArrayElements(newArray, narr, NULL);
    env->ReleaseIntArrayElements(oldArray, oarr, NULL);

    return newArray;
} 
```

您的主要问题是您试图`ret`直接操纵对象，这是不可能的。您必须使用 JNI 函数来操作`jintArray`对象。

而且您还必须确保在完成对象后释放它们。

# wcf - 如果此帐户登录另一台计算机，如何向当前帐户显示通知

> ID：11686201
> 
> 赞同：1
> 
> 时间：2012-07-27T10:40:40.740
> 
> 标签：wcf

我有一个 Windows 应用程序，它通过 WCF 服务连接到服务器，数据库在服务器上。要使用此软件，您必须登录。因此，如果 UserA 的帐户被其他人登录（在另一台计算机上），我想向正在使用该软件的 UserA 显示通知。

请帮忙 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T11:13:24.823

使您对服务的登录服务操作返回一个标志，该标志指示该帐户是否正被另一个用户同时使用。

```
// Pseudocode
LogonResponse response = Service.Logon :> username, password;
if response.UserAccountIsAlreadyLoggedOn print "User logged on already!" 
```

为此，服务必须保持所有用户的登录状态，可能在数据库中。

您的登录服务操作需要查询操作调用者提供的用户帐户的登录状态。

```
// Pseudocode
public LogonResponse Logon (string username, string password)
{
    if database.IsThisAccountAlreadyLoggedOn :> username ? 
        return LogonResponse :> UserAccountIsAlreadyLoggedOn = true;
    otherwise
        return LogonResponse :> UserAccountIsAlreadyLoggedOn = false;
} 
```

这是我能想到的最简单的方法。

# apache - Apache Wicket - 使用 DefaultDataTable 实现 AbstractToolbar

> ID：11686202
> 
> 赞同：2
> 
> 时间：2012-07-27T10:40:42.450
> 
> 标签：apache, datatable, wicket, wicket-1.5

我正在尝试将 AbstractToolBar 添加到 DefaultDataTable。工具栏有一个单击按钮，应删除所选行。我的表有一个复选框列，用于选择行。

AbstractToolBar 实现看起来像这样 -

```
public class GridToolBar extends AbstractToolbar {

/**
 * 
 */
private static final long serialVersionUID = -2126515338632353253L;
Button btnDelete;
List<Contact> selected;

public GridToolBar(final DataTable<?> table) {
    super(table);
    // TODO Auto-generated constructor stub

    btnDelete = new Button("delete",new Model("Delete"));
    btnDelete.setOutputMarkupId(true);
    btnDelete.add(new AjaxEventBehavior("onclick") {

        private static final long serialVersionUID = 6720512493017210281L;

        @Override
        protected void onEvent(AjaxRequestTarget target) {
            System.out.println(selected);
            ((UserProvider)table.getDataProvider()).remove(selected);
            target.add(table);
        }
    });

    add(btnDelete); 

}

public void setSelected(List inList){
    selected = inList;
} 
```

}

工具栏已添加到表中，如下所示 -

```
GridToolBar tb = new GridToolBar(table);
tb.setOutputMarkupId(true);
table.addTopToolbar(tb); 
```

该代码工作正常，除了单击删除按钮外，它在表格下方添加了一个额外的删除按钮。在使用 firebug 检查时，两个按钮的 id 完全匹配。但是，在对表格进行排序时，额外的按钮会从视图中移除。

有人可以帮助我如何避免在每次点击时创建额外的按钮？为什么首先要创建它？任何帮助表示赞赏。

谢谢，索南

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T11:38:15.283

您将按钮直接添加到表中。这是不正确的，因为表格中不能有按钮。你需要一个`<td>`元素。您可以使用`WebMarkupContainer`. 另请参见例如的来源`NoRecordsToolbar`

# sencha-touch - ExtJS/Sencha Touch 2 - 如何获取具有多个类的元素/组件

> ID：11686206
> 
> 赞同：2
> 
> 时间：2012-07-27T10:40:58.067
> 
> 标签：sencha-touch, extjs, sencha-touch-2

我不确定我是否要疯了。我也在厨房水槽上测试过这个，所以不仅仅是我。

我试过了：

```
Ext.ComponentQuery.query('container[cls="blah"]');
Ext.ComponentQuery.query('container[cls~="blah"]'); 
```

但是在它有了第二个类之后，你似乎无法通过它拥有的类来获得一些东西。

我错过了什么或者这不可能吗？

如果你去[http://dev.sencha.com/deploy/touch/e.../#demo/buttons](http://dev.sencha.com/deploy/touch/e.../#demo/buttons)

```
Ext.ComponentQuery.query('button')[0];
// returns element
Ext.ComponentQuery.query('button')[0].addCls('meep');
Ext.ComponentQuery.query('button[cls="meep"')[0];
// returns element
Ext.ComponentQuery.query('button')[0].addCls('blah');
Ext.ComponentQuery.query('button[cls="meep"')[0];
// returns undefined
Ext.ComponentQuery.query('button[cls~="meep"')[0];
// returns undefined 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-28T13:39:44.680

由于我的期望以及文档如何使用他们的 DomQuery，我认为上述内容应该可以工作，但存在错误。

我通过创建一个新的 xtype 并在 ComponentQuery 中使用它来解决这个问题，如下所示：

```
Ext.define('App.view.Deposit', {
    extend: 'Ext.Container'
});

Ext.ComponentQuery('meep'); 
```

我想我正试图像在 jQuery 中那样做，添加一个类并使用它检索它，但是对于 Component 的东西它很混乱。

我认为这应该有效，但它没有（在 2.0.1.1、2.1.0b3 中测试）：

```
Ext.ComponentQuery.query('button[cls*="meep"')[0]; 
```

# visual-studio-2010 - CXX0017 找不到 dllimport 变量的错误符号

> ID：11686207
> 
> 赞同：1
> 
> 时间：2012-07-27T10:41:02.780
> 
> 标签：visual-studio-2010, dll, shared-memory

我有两个不同的 DLL，通过 dllimport/export 我可以在两个 dll 之间共享一些变量！我的代码运行，但是在调试时，当我将这些导入的变量添加到监视窗口时，它说： CXX0017error symbol "MyVariable" not found。其他未导入的变量很好。任何线索出了什么问题？我需要在 VISUAL STUDIO 中启用某些功能吗？或者在声明共享变量的情况下从 DLL 导入一些输出文件？谢谢

# linux - 检查环境变量是否已经设置

> ID：11686208
> 
> 赞同：47
> 
> 时间：2012-07-27T10:41:02.383
> 
> 标签：linux, shell, unix

我正在编写一个shell脚本，我必须检查是否设置了环境变量，如果没有设置，那么我必须设置它。有什么方法可以检查 shell 脚本，是否已经设置了环境变量？

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2012-07-27T11:31:51.043

有条件地分配变量（无论是否在环境中）的标准解决方案是：

```
: ${VAR=foo} 
```

只有当它未设置时，它才会将 VAR 设置为值“foo”。
如果 VAR 未设置或为空字符串，要将 VAR 设置为“foo”，请使用：

```
: ${VAR:=foo} 
```

要将 VAR 置于环境中，请执行以下操作：

```
export VAR 
```

你也可以做`export VAR=${VAR-foo}`or `export VAR=${VAR:=foo}`，但是一些旧的 shell 不支持在同一行中赋值和导出的语法。另外，[干燥](http://en.wikipedia.org/wiki/Don%27t_repeat_yourself)；在运算符的两侧使用名称`=`是不必要的重复。（导出变量的第二行违反了相同的原则，但感觉更好。）

请注意，通常很难确定变量是否在环境中。解析的输出`env`将不起作用。考虑：

```
export foo='
VAR=var-value'
env | grep VAR 
```

生成子shell和测试也不起作用：

```
sh -c 'echo $VAR' 
```

这将表明在子shell中设置了VAR，这将表明VAR在当前进程的环境中，但可能只是在子shell的初始化中设置了VAR。然而，在功能上，结果与 VAR 在环境中的结果相同。幸运的是，您通常并不关心 VAR 是否在环境中。如果你需要它，把它放在那里。如果你需要它，把它拿出来。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2012-07-27T10:48:46.363

```
[ -z "$VARIABLE" ] && VARIABLE="abc"

if env | grep -q ^VARIABLE=
then
  echo env variable is already exported
else
  echo env variable was not exported, but now it is
  export VARIABLE
fi 
```

我想强调这`[ -z $VARIABLE ]`还不够，因为你可以拥有`VARIABLE`但它没有被导出。这意味着它根本不是环境变量。

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2012-07-27T11:23:18.420

您想要做的是 bash 中的原生操作，这称为参数替换：

```
VARIABLE="${VARIABLE:=abc}" 
```

如果未设置 VARIABLE，则右侧将等于 abc。请注意，如果 VARIABLE 未设置或为空，则内部运算符`:=`可能会替换为which 测试。`:-`

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2012-07-27T10:42:35.457

```
if [ -z "$VARIABLE" ]; then
    VARIABLE=...
fi 
```

这将检查 $VARIABLE 的长度是否为零。

# vim - 插入模式下的 VIM 单一编译命令

> ID：11686210
> 
> 赞同：1
> 
> 时间：2012-07-27T10:41:11.400
> 
> 标签：vim, macvim

我[在 Vim - Tutorial (Part 1) - 6.2 Insert mode maps 中关注 Mapping keys ，](http://vim.wikia.com/wiki/Mapping_keys_in_Vim_-_Tutorial_%28Part_1%29#Insert_mode_maps)它说：

```
The <C-R>= command doesn't create a new undo point.
You can also call Vim functions using the <C-R>= command:

:inoremap <F2> <C-R>=MyVimFunc()<CR> 
```

我正在尝试使用它来调用`SingleCompile#Compile()`：

```
map! <F5> <C-R>=SingleCompile#Compile()<CR> 
```

它正在工作，但问题是当我回到插入模式时，`0`会插入一个字符作为副作用。

为什么会这样，我该如何避免？

**编辑：**

我正在使用它是`<C-R>`因为它不会创建撤消点，并且其目的是调用函数而不是像`<C-O>`这样输入命令。我不想创建撤消点。

**编辑：**

我已经根据 Ingo Karkat 提供的三元运算符技巧更新了 VIM wiki。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T11:07:37.860

函数的隐式返回值为`0`. 您需要修改`SingleCompile#Compile()`或编写一个返回空字符串的包装器：

```
function! SingleCompileWrapper()
    call SingleCompile#Compile()
    return ''
endfunction

map! <F5> <C-R>=SingleCompileWrapper()<CR> 
```

另一种巧妙的技巧是评估`?:`三元运算符内部的函数：

```
map! <F5> <C-R>=SingleCompile#Compile()?'':''<CR> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T10:49:48.207

'0' 是函数的返回值，在插入模式下调用时自然会插入到缓冲区中

使用 <CO> 而不是 <CR> 离开命令的插入模式

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-27T11:17:29.347

我不推荐这种方法，但是乡巴佬解决方案怎么样（只是删除`0`事后）：

```
map! <F5> <C-R>=SingleCompile#Compile()<CR><BS> 
```

说真的，对于那些`<C-R>`不能使用的情况，你必须离开插入模式，`:undojoin`可能会有所帮助。

# autohotkey - 单击 Windows orb（菜单按钮）时触发 AutoHotkey 脚本

> ID：11686214
> 
> 赞同：0
> 
> 时间：2012-07-27T10:41:30.937
> 
> 标签：autohotkey

我有一个 AutoHotkey 脚本，我想在单击 Windows 7 开始菜单球时运行它（左下角的按钮显示菜单）。

我以前一直在使用`MouseGetPos`来确定光标何时悬停在该区域上，但这会导致脚本被激活，即使在运行全屏应用程序时也是如此。是否有另一种方法可以用来检测何时单击开始菜单球？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T11:49:55.913

```
MouseGetPos,,, id, control
WinGetTitle, title, ahk_id %id%
WinGetClass, class, ahk_id %id%

if (title = "Start" || (class = "Shell_TrayWnd" && control = "")) {
    ;Do script
} 
```

`title = "Start"`覆盖了大部分球体，除了角落的几个像素。

`class = "Shell_TrayWnd"`指的是整个任务栏，但只有球体周围的几个像素没有控制值。

这应该涵盖通常单击会显示 Windows 菜单的整个区域。

# .htaccess - 使用 .htaccess 重定向包括查询字符串

> ID：11686220
> 
> 赞同：0
> 
> 时间：2012-07-27T10:42:06.383
> 
> 标签：.htaccess

我需要重定向这样的页面（查询字符串中的值可能会改变）

[http://www.domain.com/list.php?id=bla&variable2=product1-product2-product3](http://www.domain.com/list.php?id=bla&variable2=product1-product2-product3)

重定向到

[http://www.domain.com/list.html?id=bla&variable2=product1-product2-product3](http://www.domain.com/list.html?id=bla&variable2=product1-product2-product3)

我需要的只是将其更改为 .html，但在定制链接上其他所有内容都应保持不变。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T10:47:27.670

在 list.php 文件中进行重定向而不是使用 .htaccess 文件是一个坏主意吗？

怎么样：

```
header('Location: http://www.domain.com/list.html?'+$querystring); 
```

在`list.php`？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T15:14:21.530

把这个放在你的htaccess中，应该就够了。

```
RewriteRule ^([^.]+).html$ /$1.php [QSA,L] 
```

（顺便说一句，这样做是没有用的......）

# entity-framework - 与 ID 上的 .SingleOrDefault 相比，DbSet.Find 方法慢得离谱

> ID：11686225
> 
> 赞同：35
> 
> 时间：2012-07-27T10:42:35.433
> 
> 标签：entity-framework, ef-code-first, dbcontext, sql-server-ce-4, dbset

我有以下代码（数据库是 SQL Server Compact 4.0）：

```
Dim competitor=context.Competitors.Find(id) 
```

当我对此进行分析时，Find 方法需要 300 多毫秒才能从仅包含 60 条记录的表中检索竞争对手。

当我将代码更改为：

```
Dim competitor=context.Competitors.SingleOrDefault(function(c) c.ID=id) 
```

然后在 3 毫秒内找到竞争对手。

竞争者类：

```
Public Class Competitor
    Implements IEquatable(Of Competitor)

    Public Sub New()
        CompetitionSubscriptions = New List(Of CompetitionSubscription)
        OpponentMeetings = New List(Of Meeting)
        GUID = GUID.NewGuid
    End Sub

    Public Sub New(name As String)
        Me.New()
        Me.Name = name
    End Sub

    'ID'
    Public Property ID As Long
    Public Property GUID As Guid

    'NATIVE PROPERTIES'
    Public Property Name As String

    'NAVIGATION PROPERTIES'
    Public Overridable Property CompetitionSubscriptions As ICollection(Of CompetitionSubscription)
    Public Overridable Property OpponentMeetings As ICollection(Of Meeting)
End Class 
```

`CompetitionSubscriptions`我为和`OpponentMeetings`使用 fluent API定义了多对多关系。

类的 ID 属性`Competitor`是 Long ，由 Code First 转换为具有数据表中主键的 Identity 列（SQL Server Compact 4.0）

这里发生了什么？？

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2012-07-27T12:54:52.730

`Find`内部调用`DetectChanges`，`SingleOrDefault`（或通常任何查询）没有。`DetectChanges`是一项昂贵的操作，因此这就是速度较慢的原因`Find`（但如果实体已经加载到上下文中，它可能会变得更快，因为`Find`不会运行查询而只是返回加载的实体）。

如果您想`Find`用于很多实体 - 例如在循环中 - 您可以像这样禁用自动更改检测（不能在 VB 中编写它，所以一个 C# 示例）：

```
try
{
    context.Configuration.AutoDetectChangesEnabled = false;
    foreach (var id in someIdCollection)
    {
        var competitor = context.Competitors.Find(id);
        // ...
    }
}
finally
{
    context.Configuration.AutoDetectChangesEnabled = true;
} 
```

现在，`Find`不会`DetectChanges`在每次调用时都调用它，它应该尽可能快`SingleOrDefault`（如果实体已经附加到上下文，则速度更快）。

自动变更检测是一个复杂且有些神秘的主题。在这个由四部分组成的系列中可以找到非常详细的讨论：

（第 1 部分的链接，第 2、3 和 4 部分的链接在该文章的开头）

[http://blog.oneunicorn.com/2012/03/10/secrets-of-detectchanges-part-1-what-does-detectchanges-do/](http://blog.oneunicorn.com/2012/03/10/secrets-of-detectchanges-part-1-what-does-detectchanges-do/)

# https - 与 HttpClient 的相互身份验证

> ID：11686227
> 
> 赞同：1
> 
> 时间：2012-07-27T10:42:37.787
> 
> 标签：https, apache-httpclient-4.x

我要提出我的问题：

我的 Web 应用程序通过 https 向服务器提交表单，它需要客户端证书来设置通信。它工作正常，当我提交表单时，https 服务器要求我提供证书，我选择我的证书并且服务器响应我。但是现在，我想从带有 HttpClient 的 servlet 发布到 https 服务器，因为我想管理来自 https 服务器的响应，在这里我遇到了问题......

我使用 HttpClient 发送帖子的代码是：

```
DefaultHttpClient client = new DefaultHttpClient();

// in the truststore i have the https server certificates for establish connection
// from my client to https server       
FileInputStream instream = new FileInputStream(new File(TRUESTORE_PATH));       
KeyStore truststore  = KeyStore.getInstance(KeyStore.getDefaultType());
truststore.load(instream, KEY_TRUESTORE_PASS.toCharArray());

// in the keystore i have the client certificate but without private key because,
// in theory, i shouldn't know it   
FileInputStream otherinstream = new FileInputStream(new File(KEYSTORE_PATH));
KeyStore keystore = KeyStore.getInstance(KeyStore.getDefaultType());
keystore.load(otherinstream,KEY_STORE_PASS.toCharArray());

SSLSocketFactory socketFactory = new SocketFactory(keystore,KEY_STORE_PASS,truststore);
Scheme sch = new Scheme("https", 443, socketFactory);
client.getConnectionManager().getSchemeRegistry().register(sch);

HttpGet httpget = new HttpGet("https://remote_server_with_client_authentication");
HttpResponse response = client.execute(httpget); 
```

当我执行此代码时，例如在单元测试中，我有来自 https 服务器的响应，但它告诉我我**没有被授权**。我怀疑我无法通过 https 服务器进行身份验证，因为密钥库具有客户端证书但没有私钥，那么我没有被授权。

那么，有没有办法通过用户选择的客户端证书与 https 服务器建立通信？

谢谢！

# visual-studio-2008 - 递归函数栈溢出

> ID：11686232
> 
> 赞同：0
> 
> 时间：2012-07-27T10:43:20.750
> 
> 标签：visual-studio-2008, recursion, stack-overflow, backtracking

这个函数接受一个`wild`包含'*'和'?'的字符串 通配符，并用树数据库中的可能字符替换通配符`nodeT *w`。`out`保存一个临时字符串。每个候选者都被添加到引用的 bst 中。

```
void Lexicon::matchRegExpHelper(nodeT *w, string wild, Set<string> &matchSet, string out)
{   
    if (wild == "") matchSet.add(out);

    else {
        if (wild[0] != '*' || wild[0] != '?') { //this parses up to the wildcard, earlier versions used a position parameter and looped through the prefix chars recursively
            for (int j = 0; j < w->alpha.size(); j++)
                if (wild[0] == w->alpha[j].letter) matchRegExpHelper(w->alpha[j].next, wild.substr(1), matchSet, out+=wild[0]);
        } else {
            for (int i = 0; i < w->alpha.size(); i++) { 
                if (wild[0] == '?') matchRegExpHelper(w->alpha[i].next, wild.substr(1), matchSet, out+=w->alpha[i].letter);//follow path
                else { //logically, wild[0] == '*' must be true
                    if (ontLength == (wild.length() + out.length())) matchRegExpHelper(w->alpha[i].next, wild.substr(1), matchSet, out+=w->alpha[i].letter); //ontology is full, treat like a '?'
                    else matchRegExpHelper(w->alpha[i].next, wild.substr(1), matchSet, out+=(w->alpha[i].letter+'*')); //keep adding chars
                }
            }
        }
    }
} 
```

当到达第一个通配符时，函数重新开始——我尝试用 for 循环重写它，没有循环，并采用不同的“修剪”方法。我缺少一些基本的东西，并怀疑这是一个回溯问题。最终堆栈溢出。

问题：1）我在概念上缺少什么，2）我该如何修复这个功能？

没有 for 循环的版本 - 测试用例有点不同但相似，我必须对其进行测试才能再次找到它

```
else {
            if (wild[0] == '?'){
                matchRegExpHelper(w, wild, ++pos, matchSet, out);//return and check next path
                matchRegExpHelper(w->alpha[pos].next, wild.substr(1), 0, matchSet, out+=w->alpha[pos].letter);//follow path
            }
            if (wild[0] == '*'){
                matchRegExpHelper(w, wild, ++pos, matchSet, out);//return and check next path
                if (ontLength == (wild.length() + out.length()))matchRegExpHelper(w->alpha[pos].next, wild.substr(1), 0, matchSet, out+=w->alpha[pos].letter); //ontology is full, treat like a '?'
                else matchRegExpHelper(w->alpha[pos].next, wild.substr(1), 0, matchSet, out+=(w->alpha[pos].letter+'*')); //keep adding chars
            }
            if (wild[0] == w->alpha[pos].letter) matchRegExpHelper(w->alpha[pos].next, wild.substr(1), 0, matchSet, out+=wild[0]);  

            matchRegExpHelper(w, wild, ++pos, matchSet, out);//check next path
        }
        for (int i = 0; i < w->alpha.size(); i++) matchRegExpHelper(w->alpha[i].next, wild.substr(1), 0, matchSet, out+=wild[0]);//step over char 
```

最后的 for 循环试图修复溢出，我认为某些线程可能没有案例，但我希望这些线程被修剪，所以不知道该怎么做

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T11:05:05.807

此条件始终为真： (wild[0] != '*' || wild[0] != '?')

由于任何字符都不同于两者之一，也许您的意思是 (wild[0] != '*' && wild[0] != '?')

我希望这可以帮助你取得一些进步......

同样从概念上讲，我通常不在递归函数中使用“for”，尝试在不使用“for”的情况下重写它，可能会更清晰，也许效率不高，但一旦它起作用，你就可以开始微调算法了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T11:04:17.833

每个递归都应该有一个基本终止条件。

我有这样的感觉

```
 if (wild[0] != '*' || wild[0] != '?') 
```

是错误的（该测试总是正确的，因为一个字符不能同时是 a`'*'`和 a `'?'`），它应该是一个连词`&&`而不是一个析取词`||`

但正如我在评论中所说，你真的应该**学习如何使用[调试器](http://en.wikipedia.org/wiki/Debugger)**（即设置[断点](http://en.wikipedia.org/wiki/Breakpoint)、请求[回溯](http://en.wikipedia.org/wiki/Backtrace)、查询变量的值）。

除了这个特定的程序（或家庭作业）之外，熟悉调试是一项对你的一生都很有价值的技能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-27T19:18:03.563

这段代码存在三个问题：

@Basile_Starynkevitch 指出了使用调试器跟踪路径的重要性——在这种情况下，使用 VS2008，堆栈允许解析步骤并注意通过多个函数返回的路径。

@Picarus 正确记录了终止条件中的错误

这些解决方案导致发现：

解决方案，这个 void 函数需要两个`return;`，一个在终止条件之后终止，另一个在结束时捕获修剪的线程。从几个网站上看，似乎a `return;`in a void 函数是不寻常的，但这种情况下具有递归和多路径，它是必需的。

# javascript - 在 javascript 中使用浏览器对象访问 DOM

> ID：11686234
> 
> 赞同：0
> 
> 时间：2012-07-27T10:43:27.740
> 
> 标签：javascript, firefox, firefox-addon

我正在用 javascript 编写一个 firefox 扩展，从该脚本中我需要使用浏览器窗口对象访问 DOM 对象。我如何实现这一目标？

当我尝试`window.document.deafultView.innerHeight`扩展时，我遇到了一个异常。

我不知道如何使用插件中的 window 对象访问 DOM 对象。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T11:13:36.363

根据[http://semanticvoid.com/blog/2006/06/01/accessing-the-dom-from-within-the-firefox-extension/](http://semanticvoid.com/blog/2006/06/01/accessing-the-dom-from-within-the-firefox-extension/)您可以通过以下方式访问 DOM：

```
// Get the content of the currently displaying window
var win = window.content;

// Access the document within the window as follows
win.document.getElementById(‘xyz’); 
```

# scala - Scala新手：递归和stackoverflow错误

> ID：11686235
> 
> 赞同：12
> 
> 时间：2012-07-27T10:43:31.110
> 
> 标签：scala, recursion, stack-overflow

作为 Scala 新手，我正在阅读书籍、文档并尝试解决在[http://aperiodic.net/phil/scala/s-99/](http://aperiodic.net/phil/scala/s-99/)上发现的问题。似乎正确的 Scala 代码基于不可变值 (val) 和递归而不是循环和变量，以使并行性更安全并避免使用锁。

例如，练习 P22（[http://aperiodic.net/phil/scala/s-99/p22.scala](http://aperiodic.net/phil/scala/s-99/p22.scala)）的可能解决方案是：

```
// Recursive.
def rangeRecursive(start: Int, end: Int): List[Int] =
if (end < start) Nil
else start :: rangeRecursive(start + 1, end) 
```

当然，这段代码很紧凑，看起来很聪明，但是，当然，如果递归次数很高，您将面临 StackOverflow 错误（rangeRecusrsive(1,10000) 例如没有 JVM 调整）。如果您查看内置 List.range 的来源（https://github.com/scala/scala/blob/v2.9.2/src/library/scala/collection/immutable/List.scala#L1），您'会看到使用了循环和变量。

我的问题是如何管理促进 vals 和递归的 Scala 学习内容的影响，因为知道此类代码会因递归次数而中断？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-07-27T10:51:23.117

Scala 的好处是您可以轻松进入它。一开始，您可以编写循环，并随着您对语言的熟悉程度越来越高，使用递归做更多事情。您不能使用更“纯”的函数式语言（例如 Clojure 或 Haskell）来做到这一点。换句话说，您可以对不可变性和 感到满意`val`，然后继续进行递归。

当您确实从递归开始时，您应该查找尾调用递归。如果递归调用是函数中的最后一次调用，Scala 编译器会将其优化为字节码中的循环。这样，你就不会得到`StackOverflowError`s。此外，如果您将`@tailrec`注释添加到递归函数，如果您的函数不是尾调用递归，编译器会警告您。

例如，您问题中的函数不是尾调用递归。看起来调用`rangeRecursive`是函数中的最后一个，但是当这个调用返回时，它仍然必须附加`start`到调用的结果。因此，它不能是尾调用递归：当调用返回时，它仍然需要工作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-27T15:24:35.127

这是使该方法尾递归的示例。@tailrec 注释不是必需的，编译器将在没有它的情况下进行优化。但是拥有它会使编译器在无法进行优化时标记错误。

```
scala> def rangeRecursive(start: Int, end: Int): List[Int] = {
    |   @scala.annotation.tailrec
    |   def inner(accum : List[Int], start : Int) : List[Int] = {
    |       if (end < start) accum.reverse
    |       else inner(start :: accum, start + 1)
    |   }
    |   
    |   inner(Nil, start)
    | }
rangeRecursive: (start: Int,end: Int)List[Int]

scala> rangeRecursive(1,10000)
res1: List[Int] = List(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11,... 
```

它使用一种称为“累加器传递方式”的常用技术，在这种技术中，中间结果被累加并传递到递归的下一步。最底层的步骤负责返回累积的结果。在这种情况下，累加器恰好反向构建其结果，因此基本情况必须反转它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-27T10:53:40.667

如果你重写上面的代码，使它是尾递归的，编译器会将代码优化成一个while循环。`@tailrec`此外，当注释的方法不是尾递归时，您可以使用注释来获取错误。从而使您知道“什么时候做对了”。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-06-28T14:32:18.637

这是 James Iry 的答案的替代方案，具有相同的行为：

```
def rangeRecursive(start: Int, end: Int): List[Int] = {
  def inner(start : Int) : Stream[Int] = {
      if (end < start) Stream.empty
      else start #:: inner(start + 1)
  }

  inner(start).toList
}

scala> rangeRecursive(1,10000)
res1: List[Int] = List(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11,... 
```

这不会抛出 a `StackOverflowError`，因为`Stream.cons`-operator ( `#::`) 通过引用存储尾部。换句话说，Stream 元素在`stream.toList`被调用之前不会被计算。

在我看来，这比累加器模式更具可读性，因为它最类似于朴素的初始算法（只需用`::`和`#::`by`Nil`替换`Stream.empty`）。此外，不需要`accum.reverse`，这很容易被遗忘。

# java - 我正在尝试在 GWT 中使用 PieChart。错误：没有可用的源代码

> ID：11686238
> 
> 赞同：1
> 
> 时间：2012-07-27T10:43:40.090
> 
> 标签：java, gwt

在编译我的代码时，我遇到了这个问题：

```
No source code is available for type com.google.gwt.visualization.client.visualizations.corechart.PieChart; did you forget to inherit a required module?
 [ERROR] Line 30: No source code is available for type com.google.gwt.visualization.client.visualizations.corechart.PieChart.PieOptions; did you forget to inherit a required module?
 [ERROR] Line 38: No source code is available for type com.google.gwt.visualization.client.AbstractDataTable; did you forget to inherit a required module?
 [ERROR] Line 39: No source code is available for type com.google.gwt.visualization.client.DataTable; did you forget to inherit a required module?
 [ERROR] Line 40: No source code is available for type com.google.gwt.visualization.client.AbstractDataTable.ColumnType; did you forget to inherit a required module?
 [ERROR] An internal compiler exception occurred 
```

我正在使用 gwt 2.1 和可视化。我尝试在 *.gwt.xml 中添加一个条目，但没有帮助。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-27T11:00:15.327

你确定你添加了

```
<inherits name='com.google.gwt.visualization.Visualization'/> 
```

到您的 *.gwt.xml 文件？因为在我看来，这是一个问题的原因。

# algorithm - 多组最短路径算法

> ID：11686240
> 
> 赞同：4
> 
> 时间：2012-07-27T10:43:51.207
> 
> 标签：algorithm

这是一个面试问题（我在论坛上看到它，但无法找出最佳解决方案）。问题是从给定的一组数字中找到最短路径。

例如。

```
Set A - [2, 14, 34]
Set B - [9, 13]
Set C - [15, 22, 62, 78]
Set D - [16, 24, 54]
Set Z - [17, 38, 41] 
```

1）可以有任意数量的集合

2）集合内的数字永远不会重复。

3）数字的范围可以从任何开始到任何结束（它们不在0 - n之间，即它可以从1091开始到1890等）

4) 所有的集合都被排序。

在上面的示例中，路径将是：

```
B[13] -> A[14] -> C[15] -> D[16] -> Z[17] 
```

最短路径定义为MAX number (17) - MIN Number (13) = 4；

有任何想法吗 ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-27T12:30:06.887

制作一个对 [number, name_of_set] 的列表。解决。

对于给定的路径长度 D，扫描排序列表，保留 2 个指针。始终增加第一个指针，并在扩展大于 D 时增加第二个指针。扫描时，保持属于每个集合的指针之间的元素计数。如果每个集合中都有元素，宾果游戏，你找到一条最多不同的路径 D.

现在，对 D 进行二分搜索。

整体复杂度 O(N log N)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-29T06:59:50.753

堆（优先队列）可能会有所帮助。

1.  将所有数据归并排序到一个数组 N 中，同时保留原始集合 id，假设总共有 m 个集合；
2.  int 最短 = MAX(N) - MIN(N); // 即 N[N.length - 1] - N[0]
3.  初始化一个堆 h；
4.  用 i 循环遍历 N，如果 h 不包含与 N[i] 相同的集合中的元素，则将 N[i] 添加到堆中；如果 h 已经包含来自同一集合的元素，例如 h[k]，则将 h[k] 的键增加到 N[i]。如果 h.size() == m, shortest == N[i] - h[0] < shortest ? N[i] - h[0]：最短。

这是代码：

```
mergesort(all_sets[], H, S); // H holds all data, S holds corresponding setid.
Heap<key, setid> H = new Heap<key, setid>();
int shortest = N[N.length - 1] - n[0];
for(int i = 0; i < N.length; i++)
{
   int data = N[i];
   int setID = S[i];
   int hindex = H.elementFromSet(setID);
   if(hindex < 0)
    { // H does not have any element from set with setID;
       H.add(data, setID);
    } else {
       H.increase(data, hindex);
    }
    if(H.size() == m)
    {
       shortest = shortest > N[i] - H[0]? N[i] - H[0] : shortest;
    }
} 
```

也许我可以使用哈希表来跟踪集 id 到堆索引。

我相信的运行时间是**O(nlgm)**。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-27T13:07:25.120

[您可以应用与我在此问题](https://stackoverflow.com/a/11647600/1515832)中描述的算法基本相同的想法。

让我们寻找最终子集的中心。它必须最小化到每个集合的最大距离。像往常一样，点到集合的距离定义为点到集合元素之间的最小距离。

对于每个集合`i`，`fi`描述到集合的距离的函数是分段线性的。如果 a,b 是两个连续的数字，那么这些关系`fi(a) = 0, fi((a+b)/2) = (b-a)/2, fi(b) = 0`让我们可以`fi`在线性时间内建立对所有数字的描述。

但是我们也可以在线性时间内计算两个分段函数的最大值`fi`，`fj`通过考虑它们是线性的连续区间 [a,b]：结果是线性的，或者通过添加唯一的交点是分段线性的分区的功能。由于我们函数的斜率始终为 +1 或 -1，因此交点是半整数，因此可以用浮点（或定点）算术精确表示。

凸性论证表明，`g`所有的最大值最多`fi`只能有 的两倍多的点`fi`，因此我们不必担心最大值的点数会是集合数的指数。

所以我们只是：

1.  计算 的分段线性距离函数`fi`。`i = 1..p`
2.  通过重复计算最大值来计算所有的最大值`g`。`fi`
3.  的任何最小点的位置`g`都是所需的中心。
4.  对于每组，选择离中心最近的点。
5.  我们选择的点集的宽度恰好是`g`:-)

如果集合的数量是有界的，复杂性是 O( *N* )，如果集合的数量*p*是可变的，复杂性是 O( *N p )。*通过聪明地计算最大值（分而治之），我认为您甚至可以将其减少到 O( *N* log *p* )。

 **** * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-27T11:11:42.623

1.  取 A 组和 B 组。在这个集合中找到最短路径。这将是 14-13 。现在对其进行排序，使其变为 13-14。现在短集 short = {13,14}

2.  取短集 { 13, 14} 并设置 C {15,22,62,78}。现在开始节点是 13，结束节点是短集中的 14。从末端节点 14 开始，最短可达路径是 15。因此将 15 添加到短集。现在短集变为 {13, 14, 15}，对其进行排序使其保持 {13, 14, 15}

3.  现在取短集 {13,14,15} 和集 D { 16 , 24 , 54} 短集中的结束节点是 15。所以我们从那里开始。现在从 25 到集合 D 的最短路径是 16。所以将 16 添加到短集合中。现在短集变为 { 13,14,15,16}。解决 。它仍然是 {13,14,15,16}

3\. 我们可以对整个集合重复此操作以获得最终的短集合。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-28T14:23:22.110

这是问题的另一种表述。

问：从所有集合中找出包含一个元素的最小区间。

A：

1.  将所有元素放在一个桶中并对其进行排序。复杂度 O(N*K)
2.  我们将通过二分搜索找到最大的数字，使得每个集合中至少有一个元素高于这个数字。这将是 MIN。
3.  类似地，通过二分搜索找到最小的数字，使得每个集合中至少有一个元素小于这个数字。这将是 MAX。

作为优化，您可以将每个集合存储为一个区间，并在第 2 步和第 3 步中使用区间树进行查询。这样，查询复杂度从 O(K) 变为 O(log K)***

# php - phpseclib rsa 密钥生成指数相同

> ID：11686243
> 
> 赞同：0
> 
> 时间：2012-07-27T10:43:59.190
> 
> 标签：php, phpseclib

在 [http://phpseclib.sourceforge.net](http://phpseclib.sourceforge.net)中，指数生成是相同的..每次生成密钥时..这无法在 java(android) 端解密..

```
<RSAKeyValue>
  <Modulus>AKoYq6Q7UN7vOFmPr4fSq2NORXHBMKm8p7h4JnQU+quLRxvYll9cn8OBhIXq9SnCYkbzBVBkqN4ZyMM4vlSWy66wWdwLNYFDtEo1RJ6yZBExIaRVvX/eP6yRnpS1b7m7T2Uc2yPq1DnWzVI+sIGR51s1/ROnQZswkPJHh71PThln</Modulus>
  <Exponent>AQAB</Exponent>
  <P>AN4DDp+IhBca6QEjh4xlm3iexzLajXYrJid6vdWmh4T42nar5nem8Ax39o3ND9b1Zoj41F9zFQmuZ8/AgabreKU=</P>
  <Q>AMQi+R0G9m0K+AcqK3DFpv4RD9jGc0Tle98heNYT7EQvZuuiq4XjvRz0ybqN//bOafrKhsTpRS9DQ7eEpKLI4Bs=</Q>
  <DP>FklyR1uZ/wPJjj611cdBcztlPdqoxssQGnh85BzCj/u3WqBpE2vjvyyvyI5kX6zk7S0ljKtt2jny2+00VsBerQ==</DP>
  <DQ>AJGC1Mg5Oydo5NwD6BiROrPxGo2bpTbu/fhrT8ebHkTz2eplU9VQQSQzY1oZMVX8i1m5WUTLPz2yLJIBQVdXqhM=</DQ>
  <InverseQ>EaiK5KhKNp9SFXuLVwQalvzyHk0FhnNZcZnfuwnlCxb6wnKg117fEfy91eHNTt5PzYPpf+xzD1FnP7/qsIninQ==</InverseQ>
  <D>Fijko56+qGyN8M0RVyaRAXz++xTqHBLh3tx4VgMtrQ+WEgCjhoTwo23KMBAuJGSYnRmoBZM3lMfTKevIkAidPExvYCdm5dYq3XToLkkLv5L2pIIVOFMDG+KESnAFV7l2c+cnzRMW0+b6f8mR1CJzZuxVLL6Q02fvLi55/mbSYxE=</D>
</RSAKeyValue> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-01T17:31:36.573

AQAB 是 65537 的 base64 编码版本，这对于指数来说很常见。事实上，通常，公共指数是硬编码的。它的设计目的是小，以便加密速度快。私人指数通常要大得多，而且几乎可以是任何东西。

以下网址详细说明：

[http://en.wikipedia.org/wiki/65537_(number)#Applications](http://en.wikipedia.org/wiki/65537_(number)#Applications)

至于Android不接受密钥......我的猜测是它不支持这种格式。我不知道...也许尝试 phpseclib 的默认输出格式？IE。PEM 编码的 RSA 私钥？

# python - 在 Fedora 版本 8 上安装 bigquery 命令行

> ID：11686249
> 
> 赞同：0
> 
> 时间：2012-07-27T10:44:23.920
> 
> 标签：python, fedora, zlib, google-bigquery

我正在按照[安装步骤中的安装说明进行操作](https://developers.google.com/bigquery/docs/cli_tool#installation)

我最终遇到以下错误

```
#python setup.py install

Traceback (most recent call last):
  File "setup.py", line 18, in <module>
    use_setuptools()
  File "/mnt/ravi/BQTools/bigquery-2.0.6/ez_setup.py", line 76, in use_setuptools
    return do_download()       
  File "/mnt/ravi/BQTools/bigquery-2.0.6/ez_setup.py", line 72, in do_download
    import setuptools; setuptools.bootstrap_install_from = egg
zipimport.ZipImportError: can't decompress data; zlib not available 
```

我以为我必须安装 zlib 才能消除此错误，但这无济于事

```
#yum install zlib

Loaded plugins: fastestmirror
Loading mirror speeds from cached hostfile
 * updates-newkey: kdeforge.unl.edu
 * fedora: kdeforge.unl.edu
 * updates: kdeforge.unl.edu
updates-newkey                                          | 2.3 kB     00:00     
fedora                                                  | 2.1 kB     00:00     
updates                                                 | 2.6 kB     00:00     
s3tools                                                 | 1.7 kB     00:00     
Setting up Install Process
Parsing package install arguments
Package zlib-1.2.3-14.fc8.i386 already installed and latest version

Nothing to do 
```

搜索给出以下结果

```
#yum search zlib
Loaded plugins: fastestmirror
Loading mirror speeds from cached hostfile
 * updates-newkey: kdeforge.unl.edu
 * fedora: kdeforge.unl.edu
 * updates: kdeforge.unl.edu 
================================ Matched: zlib ================================
arm-gp2x-linux-zlib.noarch : Cross Compiled zlib Library targeted at arm-gp2x-
                           : linux
iptstate.i386 : A top-like display of IP Tables state table entries
jzlib.i386 : JZlib re-implementation of zlib in pure Java
jzlib-demo.i386 : Examples for jzlib
jzlib-javadoc.i386 : Javadoc for jzlib
minizip.i386 : Minizip manipulates files from a .zip archive
minizip-devel.i386 : Development files for the minizip library
ocaml-cryptokit.i386 : OCaml library of cryptographic and hash functions
perl-Archive-Tar.noarch : A module for Perl manipulation of .tar files
perl-Compress-Raw-Zlib.i386 : Low-Level Interface to the zlib compression
                            : library
perl-Compress-Zlib.noarch : A module providing Perl interfaces to the zlib
                          : compression library
perl-IO-Compress-Zlib.noarch : Perl interface to allow reading and writing of
                             : gzip and zip data
perl-IO-Zlib.noarch : Perl IO:: style interface to Compress::Zlib
perl-POE-Filter-Zlib.noarch : POE filter wrapped around Compress::Zlib
php-pecl-phar.i386 : Allows running of complete applications out of .phar files
rb_libtorrent-devel.i386 : Development files for rb_libtorrent
zlib.i386 : The zlib compression and decompression library
zlib-devel.i386 : Header files and libraries for Zlib development
zziplib.i386 : Lightweight library to easily extract data from zip files
zziplib-devel.i386 : Development files for the zziplib library
zziplib-utils.i386 : Utilities for the zziplib library 
```

我不确定 zlib 是否安装正确

```
# zlib
-bash: zlib: command not found 
```

请建议下一步

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T07:00:09.243

这里的问题是你机器上的 python 副本是在没有 zlib 支持的情况下构建的。幸运的是，需要 zlib 的唯一原因是安装 setuptools，在您的情况下，有一种更简单的方法可以做到这一点 - 只需尝试：

```
yum install python-setuptools 
```

然后您可以照常进行，或者（甚至更容易）只需键入`easy_install -U bigquery`安装 bq。

# php - 在 osCommerce 模板中显示购物车项目数和总计算价格

> ID：11686250
> 
> 赞同：0
> 
> 时间：2012-07-27T10:44:26.657
> 
> 标签：php, oscommerce

如何在 osCommerce 的 template_top.php 文件中显示购物车商品数量和总计算价格？

我的模板文件中有以下代码，并希望像购物车一样更新数字：

```
<span class="items">10 items</span>   |   <span>$500.00</span> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T16:20:47.917

要显示购物车中的商品总数，您需要调用以下命令：

```
$cart->count_contents() 
```

对于您购物车中物品的总成本，您需要：

```
$cart->show_total() 
```

`echo`根据需要在您希望它们显示的模板上的任何位置显示它们。

在您的情况下，如下所示（在此处分为两行以进行视觉显示）：

```
<span class="items"><?php echo $cart->count_contents() ?> items</span> | 
<span><?php echo $cart->show_total() ?></span> 
```

这两个都在购物车类中定义，位于：includes/classes/shopping_cart.php

# c# - Linq 到实体转换

> ID：11686251
> 
> 赞同：0
> 
> 时间：2012-07-27T10:44:30.760
> 
> 标签：c#, linq, frameworks, entity

我的 Linq to Entity 查询有问题。我试图返回这样的列表：

`List<InvoiceReportItem> cancelResults = (List<InvoiceReportItem>)(from cr in model.InvoiceReportItems //join l in model.tblLicences on cr.LicenceAuto equals l.LicenceAuto where cr.Report.Id == id select cr);`

但它给了我错误：

> 无法投射类型 >'System.Data.Objects.ObjectQuery `1[LicExpiryNotModel_EF41.Model.InvoiceReportItem]' to > type 'System.Collections.Generic.List`1[LicExpiryNotModel_EF41.Model.InvoiceReportItem]' 的对象。

有谁知道为什么会出现这个错误？快把我逼疯了！:(

提前感谢尼尔

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-27T10:47:29.670

使用[ToList](http://msdn.microsoft.com/en-us/library/bb342261.aspx) ()

```
List<InvoiceReportItem> cancelResults = 
 (from cr in model.InvoiceReportItems 
  join l in model.tblLicences on cr.LicenceAuto equals l.LicenceAuto where cr.Report.Id == id 
  select cr).ToList(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T10:48:51.310

您不能将 an`IQueryable`转换为 a `List`，而是使用 上的`.ToList()`方法`IQueryable`，如下所示：

```
List<InvoiceReportItem> cancelResults = (from cr in model.InvoiceReportItems).ToList(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-27T10:55:38.850

当您执行这样的查询时，LINQ 会延迟执行并返回 IQueryable。如果您愿意，这允许您在将来进一步查询（例如，添加额外的 where 子句）。无法将 IQueryable 泛型转换为列表。正如其他人所建议的那样，在代码上调用 ToList()

```
List<InvoiceReportItem> cancelResults = (List<InvoiceReportItem>)(from cr in model.InvoiceReportItems //join l in model.tblLicences on cr.LicenceAuto equals l.LicenceAuto where cr.Report.Id == id select cr).ToList(); 
```

# facebook - Facebook-iOS-SDK：如何更正构建框架并将其添加到项目中？

> ID：11686252
> 
> 赞同：3
> 
> 时间：2012-07-27T10:44:31.657
> 
> 标签：facebook, linker, facebook-ios-sdk

我为 iPad 开发了一个应用程序。

目前，我在**iPad-5.1 Simulator**上测试应用程序。

由于我的不快，申请失败了。

1）我使用**FacebookSDK 3.0**
2）将 FacebookSDK 编译**到**框架**FBiOSSDK**
3）将框架**FBiOSSDK**添加到项目中
4）查看**链接器**
的日志 5）架构 i386 的未定义符号：“_sqlite3_open_v2”和许多“_sqlite3_*”符号。

也许我在将 facebook-sdk 项目构建到框架时设置了错误的选项？

有人可以帮忙吗？

经过搜索，我找到了解决方案：

“添加到项目 libsqlite3.0.dylib”

但**链接器**说：“忽略文件/path/libsqlite3.dylib，文件中缺少所需的架构i386”

- 主要问题 -

一个小时后，我发现我以错误的方式链接框架。

脚本在本地目录中创建它（不在**System/Library/Frameworks**或**Library/Frameworks**中）。

添加后，`Framework Search Paths`更改为非默认值。

如何以正确的方式构建框架？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-27T15:36:38.283

所以，很长一段时间后，我做了这样的事情来使这个**FacebookSDK**工作：

1）首先，我删除**FacebookSDK 框架**的构建（**rm -rf**）并运行构建框架的脚本（**build_framework.sh**）

2）之后，我添加到项目（*项目*->*构建阶段*->*将二进制文件与库链接*）**FacebookSDK.framework**（从***本地***目录，使用按钮***添加其他***）和**libsqlite3.0dylib**和**libsqlite3.dylib**（只需在搜索中搜索-场地！）

0）或3）然后我做了这个：找到目录*〜/ Library/Developer/Xcode/DerivedData*并从中删除***所有***内容。（使用命令**rm -rf dir_name/***）

您可以从步骤 3) 开始，我也将其命名为步骤 0)。

在这里我提供一个脚本，它可以帮助你

```
#!/usr/bin/perl
my $pathToCacheDirectory = qq(~/Library/Developer/Xcode/DerivedData/);

sub TaskToDo{
    my ($refToArgv)=@_;
    die "can't work with too much parameters" unless(scalar(@$refToArgv)==1);
    my $what = shift @$refToArgv;
    my $time = 30; #wait 30 seconds in each iteration
    my $workRef = sub{
        print "i will delete: ";
        print qx(ls $pathToCacheDirectory);
    qx(rm -rf $pathToCacheDirectory);
    };
    #view help
    if ($what eq 'help'){
        print qx(perldoc -t $0);
    }
    #list directory 
    if ($what eq 'watch'){
    print qx(ls $pathToCacheDirectory);
    }
    #kill files instantly
    if ($what eq 'now'){
    print 'kill now'.qq(\n);
    $workRef->();
    print 'see result'.qq(\n);
    print qx(ls $pathToCacheDirectory);
    }
    #switch on watcher
    if ($what eq 'work'){
    for(;;){
        #in INF loop
        for my $s(0..4){
        #print "this is <<$_>>\n";
        print "time remaining: ".(5-$s)*$time." sec \n";
        sleep($time);
        }
        $workRef->();    
        sleep(10);
    }
    }
} 

TaskToDo(\@ARGV);

__END__

=head1 DESCRIPTION

This script clear directory with cache from Xcode

    -- 'help'  will show this log

    -- 'work'  will run script as observer and killer

    -- 'watch' will show info about directory with cache

    -- 'now'   will kill all instantly

    Example: perl scriptName.pl help

=cut 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-17T01:29:10.140

我找到的解决方案是转到 Target Info 并删除 XCode 创建的 Framework 搜索路径。然后一切都正确编译。

# jquery - jquery动画野生动物园错误

> ID：11686253
> 
> 赞同：1
> 
> 时间：2012-07-27T10:44:42.403
> 
> 标签：jquery, html, css, safari

我有一个功能，

```
 ('#p1').mouseover(function(){
                $('.c01').animate({'opacity':'.90'}, 300, 'linear');
                $('.c01').css('display', 'block');
            });

            $('#p1').mouseout(function(){
                $('.c01').animate({'opacity':'0'}, 300, 'linear');
                $('.c01').css('display', 'none');
            }); 
```

这在每个浏览器中都可以正常工作，除了 safari - 在这里它变得草率并且动画滞后。

有人知道解决此错误的解决方案吗？

谢谢你。

# android - 如何通过getview为多个imageViews setImageResource

> ID：11686255
> 
> 赞同：0
> 
> 时间：2012-07-27T10:44:42.310
> 
> 标签：android, android-layout, android-intent, android-emulator

这是我的自定义列表视图的行。如您所见，共有三个 imageView。我应该如何覆盖

`public View getView(int position, View convertView, ViewGroup parent)`

我的适配器类，这样，无论我的列表中有多少图像视图，我都可以设置 imageView.setImageResource。任何帮助深表感谢。

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
          android:layout_width="fill_parent"
          android:layout_height="fill_parent">
<RelativeLayout
        android:id="@+id/LinearLayout01"
        android:orientation="horizontal"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content">
<ImageView
        android:id="@+id/image"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_marginRight="10px" />
<ImageView
        android:id="@+id/image1"
        android:layout_toRightOf= "@+id/image"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginRight="10px" />

<ImageView
        android:id="@+id/image2"
        android:layout_toRightOf= "@+id/image1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginRight="10px" />
</RelativeLayout>
</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T10:56:52.263

在您的适配器内参加持有人课程

```
// View Holder for fast accessing List Row
private class ViewHolder {
    public ImageView image;
    public ImageView image1;
    public ImageView image2;
} 
```

和getView方法

```
@Override
        public View getView(int position, View convertView, ViewGroup parent) {
            final ViewHolder holder;
            if (convertView == null) {
                holder = new ViewHolder();
                convertView = inflater.inflate(R.layout.row_layout,null);
                holder.image = (ImageView)convertView.findViewById(R.id.image);
                holder.image1 = (ImageView)convertView.findViewById(R.id.image1);
                holder.image2 = (ImageView)convertView.findViewById(R.id.image2);
                convertView.setTag(holder);
            } else {
                holder = (ViewHolder) convertView.getTag();
            }

            // Setting Image Resource here
            holder.image.setImageResource(R.drawable.icon);
            holder.image1.setImageResource(R.drawable.icon);
            holder.image2.setImageResource(R.drawable.icon);

            // return the listview row
            return convertView;
        } 
```

在 ListView 行布局`why you take LinearLayout and then RelativeLayout inside it`中，只需**`take RelativeLayout as a root node.`**

# android - SoftKeyboard 关闭时呈现错误

> ID：11686256
> 
> 赞同：2
> 
> 时间：2012-07-27T10:44:43.333
> 
> 标签：android, keyboard, rendering, overlay

我有以下问题：我有一个带有主 Fragment 的 FrameLayout，它始终显示，以及一些覆盖“额外”的 Fragment 是否显示，具体取决于应用程序的状态。（此布局用于平板电脑）

现在，如果用户使用 EditText 启动一个对话框，这会导致 SoftKeyboard 出现。对话框和键盘（无论哪种类型的对话框，我都尝试过 AlertDialog 和 DialogFragment）覆盖其他片段。到目前为止，一切都很好。

但是当对话框结束并且键盘关闭时，我的整个应用程序在动画中被上下推了一下，然后在 ActionBar 和我的片段的底部边缘出现了几个渲染错误。

仅当键盘恰好覆盖了我的“额外”片段之一时才会发生这种情况。（如果它覆盖了两个片段，那么一切都很好）。

有人知道如何摆脱这个吗？配置 android:windowSoftInputMode 没有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T10:58:02.547

您可以使用片段调整键盘

```
getActivity().getWindow().setSoftInputMode(
                WindowManager.LayoutParams.SOFT_INPUT_ADJUST_PAN); 
```

# html - IE中的文字阴影

> ID：11686263
> 
> 赞同：1
> 
> 时间：2012-07-27T10:45:05.243
> 
> 标签：html, css

我发现了一篇关于在 IE 中创建文本阴影的 Stackoverflow 文章：[StackQuestion](http://www.workingwith.me.uk/articles/css/cross-browser-drop-shadows) 现在我尝试了所有的“过滤器”解决方案，在 IE9 中，文本呈现出可怕的效果（尽管阴影阴影显示，文本像素化严重......）。

有谁知道 IE 的正确文本阴影技术？即使它只是为IE9 ...

谢谢你

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-27T13:44:58.670

看看这个网站：[http ://css3pie.com/](http://css3pie.com/)

这是一个插件，可以让你在 IE6-9 中使用 CSS3

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T02:36:26.370

您*可以*在 Internet Explorer 中获得文本阴影效果，驯服 IE 的粗糙过滤器阴影效果，强制它们看起来不错并停止对文本进行像素化。使用 IE 色度过滤器：

*   设置与阴影颜色接近但不相同的背景颜色 - 例如黑色阴影，深灰色，白色发光，浅灰色
*   （在仅 IE 的类或条件注释内的样式表或样式规则中设置背景颜色，以免在其他所有浏览器中破坏您的设计！）
*   在您的 IE 过滤器 CSS 规则之前，将色度过滤器设置为与背景填充相同的颜色
*   它看起来（几乎）相当不错！

## [jsfiddle 示例](http://jsfiddle.net/Z2tYF/12/)（在 IE8、IE9 中加载）

...或者，如果您无法轻松访问 IE8/9，这里是 IE9 IE8 模式下那个小提琴的屏幕截图。请注意 IE 默认过滤器的可怕、伪影、像素化混乱与相当清晰、外观正常的 Chroma 过滤器等效物之间的区别。

![在此处输入图像描述](../Images/a284c7cb9dd6e4045a4e9589bf3ac9a8.png)

CSS 代码示例。注意你是如何得到一个 Chroma 过滤器，然后是另一个过滤器，都在一行上，用引号对一个`-ms-filter`- 以及 Chroma 颜色如何与背景颜色*精确*匹配，以及 Chroma 颜色如何赞美（但不匹配）主要效果颜色：

```
.chroma-glow {
    background-color: #dfdfdf;
    -ms-filter: "progid:DXImageTransform.Microsoft.Chroma(Color=#dfdfdf)progid:DXImageTransform.Microsoft.Glow(color=ffffff,strength=4)";
}
.chroma-shadow {
    background-color: #dfdfdf;
    -ms-filter: "progid:DXImageTransform.Microsoft.Chroma(Color=#dfdfdf)progid:DXImageTransform.Microsoft.Shadow(direction=135,strength=2,color=ffffff)";
} 
```

* * *

一些要求（艰难地学习......）

*   元素必须是`block`or `inline-block`，不能是`inline`。
*   过滤器无法应用于任何属于`position: relative;`或`position: absolute;`
    *   （如果直接应用于`position: absolute;`or `position: relative; 元素，它们会起作用）
*   如果您要动态添加过滤器，例如使用 jQuery like `$elem.css('filter','progid...');`，则似乎必须将背景颜色直接应用于具有过滤器的元素才能使色度起作用。几个提示：
    *   具有相同的效果颜色、应用的背景颜色和色度颜色
    *   由于您只需要在 IE 中使用此背景颜色，因此请使用特征检测或 IE 检测。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-27T13:56:49.960

```
#element {  
    filter: glow(color=black,strength=5);  
} 
```

# java - 比较 JPA 查询中的当前日期时间

> ID：11686264
> 
> 赞同：10
> 
> 时间：2012-07-27T10:45:16.863
> 
> 标签：java, jpa

我想将数据库中的日期与 JPA 查询中的当前日期时间进行比较：

captureLimitDate < currentDateTime

我的要求如下：

database.captureLimitDate：04/07/2012 19:03:00 currentDateTime：04/07/2012 20:03:00

我的 JPAQuery 是这样的：

```
SELECT o FROM Operation o"
+ " WHERE ( o.merchantId =:merchantId ) AND "
+ "(o.captureLimitDate < currentDateTime ) "; 
```

并且 Operation 类具有 captureLimitDate 作为 java.util.Date

```
 @Generated(value = "XA", comments = "0,_8BedAMXZEeGHf_Dj4YaPyg")
     private Date captureLimitDate; 
```

我想比较当前日期和时间。上述查询是否有效。??

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-07-27T10:54:40.643

CURRENT_TIMESTAMP 必须用于引用 JPQL 查询中的当前日期和时间：

```
select o from Operation o
where o.merchantId = :merchantId
and o.captureLimitDate < CURRENT_TIMESTAMP 
```

如果当前日期和时间实际上是来自用户输入的日期（因此不是当前日期和时间，那么您可以像对`merchantId`:

```
select o from Operation o
where o.merchantId = :merchantId
and o.captureLimitDate < :maxDateTime 
```

你设置参数使用

```
query.setParameter("maxDateTime", maxDateTime, TemporalType.TIMESTAMP); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2017-09-23T14:45:28.473

JPA 定义了特殊的 JPQL 表达式，这些表达式在执行查询时被评估为数据库服务器上的日期和时间：

`CURRENT_DATE`- 被评估为当前日期（一个`java.sql.Date`实例）。

`CURRENT_TIME`- 被评估为当前时间（一个`java.sql.Time`实例）。

`CURRENT_TIMESTAMP`- 被评估为当前时间戳，即日期和时间（一个`java.sql.Timestamp`实例）。

更多信息：[点击这里](http://www.objectdb.com/java/jpa/query/jpql/date)

# makefile - 避免使用 .a 创建 .so

> ID：11686265
> 
> 赞同：1
> 
> 时间：2012-07-27T10:45:24.180
> 
> 标签：makefile, android-ndk, java-native-interface

我已经创建了一个 android 应用程序，这里我的大部分代码都在 c 中，所以我使用 jni 创建了它。我必须创建`socket.so`文件，我必须在其中使用`libtest.so`.

在使用`libtest.so`in socket.so 时我得到了`error:undefined reference to function()`. 我的 function() 存在于`libtest.so`. 所以为了通过建议来实现这一点，我创建了我的 Android.mk，如下所示：

```
LOCAL_PATH := $(call my-dir)

include $(CLEAR_VARS)
LOCAL_MODULE := libtest
LOCAL_SRC_FILES := libtest.so
include $(PREBUILT_SHARED_LIBRARY)

include $(CLEAR_VARS)
LOCAL_MODULE := socket
LOCAL_SHARED_LIBRARIES += libtest
LOCAL_SRC_FILES := source/interface.c source/file.c
LOCAL_LDFLAGS += libtest.a  
LOCAL_C_INCLUDES := $(LOCAL_PATH)/../../libtest/jni/include
include $(BUILD_SHARED_LIBRARY) 
```

但它需要`libtest.so`&`libtest.a`文件都存在。好像我只使用`libtest.a`它工作得很好。

因为我的要求是创建 libtest.so 并将其包含在 socket.so 中，任何人都可以告诉我如何避免依赖 .a 文件来创建 .so 文件。

如果我要发表评论`LOCAL_LDFLAGS += libtest.a` ，那么我会得到`error:undefined reference to function()`

任何人请帮助我摆脱这个问题.......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T10:58:10.383

好像有点不干净。

共享库 (.so) 和存档 (.a) 都应该包含相同的代码，但实际上它们可能不会。您应该做的第一件事是检查 .so 是否真的包含所有符号。链接器可能已经优化了一些。使用该`nm`实用程序或`objdump`用于该目的。

您还可以发布 ndk-build 正在执行的命令的控制台转储吗？

您也可以尝试避免您正在做的事情，因为 NDK 并不是真的要生成相互依赖的共享库。这当然是可能的，但推荐的方法是将您的库填充到静态存档中，并将它们直接链接到生成的 JNI .so 中。

**编辑：**

`LOCAL_SRC_FILES := libtest.so`似乎错了。如果要与共享库*链接*，请将库传递给链接器而不是编译器：`LOCAL_LDFLAGS += libtest.so`或者，更好的是，`LOCAL_LDFLAGS += -L. -ltest`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T12:14:03.013

非常感谢@onitake。

这里有一个简单的错误是 libtest.so 不正确（由有错误的代码创建）。

然后当我创建了一个合适的 libtest.so 时，

笔记：

如果有人有正确的 .so 文件，但它仍然给出错误，那么可能存在一些链接错误。所以只需删除该行：

```
LOCAL_C_INCLUDES := $(LOCAL_PATH)/../../libtest/jni/include 
```

并放

```
LOCAL_EXPORT_C_INCLUDES:= $(LOCAL_PATH)/../../libtest/jni/include 
```

以上两个陈述都是相同的，但有时它是有效的。

# ios - iOS ES 2 从 RAM 渲染 OK，VBO 中的顶点 OK，但 BO 中的索引失败

> ID：11686268
> 
> 赞同：0
> 
> 时间：2012-07-27T10:45:45.913
> 
> 标签：ios, opengl-es-2.0, vbo

我正在扩展 Xcode opengles 模板，摆脱了虚拟 es1 的东西。现在我设法从 vertexArray 和 indexArray 的 RAM 渲染我的模型，然后我设法 gen-,bind-,dataBuffer vertexArray VBO 并将常规 RAM 指针更改为偏移指针。这一切都很好，但是将 indexAray 放入 BO 和 gen-、bind-、dataBuffer 并将 RAM 指针更改为偏移指针的下一阶段失败:(

有没有我没有注意到的常见陷阱，对我来说，任何能够制作 VBO 的人都应该能够制作 indexArray-buffer ...

以下代码在 setupGL 中完成

```
 glGenBuffers(1, &geometryPtr->vertexBuffer);
    glBindBuffer(GL_ARRAY_BUFFER, geometryPtr->vertexBuffer);
    glBufferData(GL_ARRAY_BUFFER, sizeof(geometryPtr->vertexNormalUV), geometryPtr->vertexNormalUV, GL_STATIC_DRAW);
    //
    glGenBuffers(1, &geometryPtr->vertexIndicesBuffer);
    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, geometryPtr->vertexIndicesBuffer);
    glBufferData(GL_ELEMENT_ARRAY_BUFFER, sizeof(geometryPtr->indices), geometryPtr->indices, GL_STATIC_DRAW); 
```

然后是render routine中的基本思想

```
 glBindBuffer(GL_ARRAY_BUFFER, geometryPtr->vertexBuffer);
    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, geometryPtr->vertexIndicesBuffer);
    glVertexAttribPointer(GLKVertexAttribPosition, 3, GL_FLOAT, GL_FALSE, 32, BUFFER_OFFSET(0));
    glEnableVertexAttribArray(GLKVertexAttribPosition);
    glVertexAttribPointer(GLKVertexAttribNormal, 3, GL_FLOAT, GL_FALSE, 32, BUFFER_OFFSET(12));
    glEnableVertexAttribArray(GLKVertexAttribNormal);
    glVertexAttribPointer(GLKVertexAttribTexCoord0, 2, GL_FLOAT, GL_TRUE, 32, BUFFER_OFFSET(24));
    glEnableVertexAttribArray(GLKVertexAttribTexCoord0);
    //
    glDrawElements(GL_TRIANGLES, trianglesCount*3, GL_UNSIGNED_SHORT, (void *)offset);
    glDrawElements(GL_TRIANGLE_STRIP, triangleStripOffsets[m], GL_UNSIGNED_SHORT, (void *)offset); 
```

请帮忙？:) 尼尔斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-28T17:13:36.507

我已经在评论中回答了这个问题，按照拉尔森先生的建议，我将提供一个（官方）答案来结束这个问题。

为了进一步逃避，我基本上假设 sizeof() 会让系统要求系统内存管理器询问大小，分配给指针发送......

尼尔斯

附言。谢谢拉森先生。

# python - 将多个时间序列数据组合到一个 2d numpy 数组

> ID：11686272
> 
> 赞同：3
> 
> 时间：2012-07-27T10:45:55.323
> 
> 标签：python, numpy, time-series, pandas

在一年的时间里，我有`timeseries`来自三个不同传感器的数据，传感器大约每 3 分钟产生一个数据点，传感器不同步，因此它们在相对于彼此的不同时间产生一个数据点输出。

该数据位于一个包含大约 50 万条记录的表中的 sqlite 数据库中。我打算使用 javascript 图表库 dygraph 显示这些数据，我已经`timeseries`通过按传感器名称执行 sql 查询并保存到 csv 来分别为每个传感器生成图表。我希望有一个图表来显示所有数据点，一条线代表每个传感器。

我创建了一个名为'minutes_array'的numpy 2d类型字符串数组，第一列作为unix时间戳，四舍五入到最接近的分钟，覆盖从传感器时间序列开始到结束的每一分钟，三个空列填充每个数据可用的 3 个传感器中的一个。

**分钟数组**

```
[['1316275620' '' '' '']
 ['1316275680' '' '' '']
 ['1316275740' '' '' '']
 ..., 
 ['1343206920' '' '' '']
 ['1343206980' '' '' '']
 ['1343207040' '' '' '']] 
```

然后传感器时间序列数据也被四舍五入到最接近的分钟，我使用 numpy.in1d 并从上面的“minutes_array”和“sensor_data”数组中获取时间戳，并为与该传感器相关的记录创建一个掩码。

**传感器数据**

```
[['1316275680' '215.2']
 ['1316275860' '227.0']
 ['1316276280' '212.2']
 ..., 
 ['1343206380' '187.7']
 ['1343206620' '189.4']
 ['1343206980' '192.9']]

 mask = np.in1d(minutes_array[:,0], sensor_data[:,0])

 [False  True False ..., False  True False] 
```

然后，我希望修改 minutes_array 中对于该掩码为 true 的记录，并将 sensor_data 值放入 minutes_array 中时间戳之后的第一列。从我的尝试来看，当应用掩码时，似乎不可能改变原始的“minutes_array”，有没有办法在 numpy 中实现这个结果，而不使用 for 循环和单独匹配时间戳？

## 解决了

根据@eumiro 下面的回答，我使用了[Pandas Docs 中的解决方案](http://pandas.sourceforge.net/dsintro.html#from-dict-of-series-or-dicts)和上面描述的 'sensor_data' numpy 数组

```
sensors = ['s1','s2','s3']    
sensor_results = {}
for sensor in sensors:
    sensor_data = get_array(db_cursor, sensor)
    sensor_results[sensor] = pd.Series(sensor_data[:,1], \
                                   index=sensor_data[:,0])
df = pd.DataFrame(buoy_results)
df.to_csv("output.csv") 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-27T10:47:55.103

半百万不是你用 python 字典无法管理的数字。

从数据库中读取所有传感器的数据，填充字典，然后构建一个 numpy 数组，或者更好的是，将其转换为[pandas.DataFrame](http://pandas.pydata.org/)：

```
import pandas as pd

inp1 = [(1316275620,   1), (1316275680,   2)]
inp2 = [(1316275620,  10), (1316275740,  20)]
inp3 = [(1316275680, 100), (1316275740, 200)]

inps = [('s1', inp1), ('s2', inp2), ('s3', inp3)]

data = {}
for name, inp in inps:
    d = data.setdefault(name, {})
    for timestamp, value in inp:
        d[timestamp] = value
df = pd.DataFrame.from_dict(data) 
```

`df`就是现在：

```
 s1  s2   s3
1316275620   1  10  NaN
1316275680   2 NaN  100
1316275740 NaN  20  200 
```

# iphone - GUI 动作慢

> ID：11686273
> 
> 赞同：0
> 
> 时间：2012-07-27T10:45:59.107
> 
> 标签：iphone, objective-c, ios, xcode

这是IOS中的一个普遍问题。我有一个视图，其中包含一些子视图（我已经使用`insertSubview:atIndex:`方法添加了这些视图）。如果我按方法删除这些子视图`removeFromSuperview`，我的主视图将显示出来，但在该视图中所有 GUI 操作都非常慢。例如：如果我单击主视图上的文本字段，键盘出现的速度很慢，而且下降的速度也很慢。我不知道我做错了什么。任何想法 ？

这是一个示例代码。self 是我的主要视图，我在其中添加了其他两个视图。

```
(void) begin_action {
                subview1 =[[test_subview1 alloc] init];
                [self.view insertSubview:[self. subview1.view] atIndex:0];

        subview2 =[[test_subview2 alloc] init];
                [self.view insertSubview:[self.subview2.view] atIndex:1];
    }

    end_of_action {
           [self. subview1.view removeFromSuperview];
           [self. subview2.view removeFromSuperview];

           self. subview1 = nil;
           self. subview2 = nil;
    } 
```

除此之外，我需要做两个删除视图吗？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T04:31:23.487

您是否在实际设备上检查过这个？另外，尝试重新启动模拟器——tipycalFlow

# html - 可扩展宽度 H2 带 BG

> ID：11686274
> 
> 赞同：0
> 
> 时间：2012-07-27T10:45:59.937
> 
> 标签：html, css

我正在尝试使用 3 个图像（左、重复和右）作为“语音气泡”标题的背景，但无法让中间重复以填充容器 div。

这是它的位置（带有“你好”的灰色气泡）[http://www.dev.inside-guides.co.uk/brentwood/pages/index.html](http://www.dev.inside-guides.co.uk/brentwood/pages/index.html)

这是CSS：

```
.right-nav .speech-left {float:left;background:url(/images/speech-left.png) no-repeat;width:55px;height:47px;}
.right-nav h2.speech-repeat {display:block;float:left;background:url(/images/speech-repeat.png) repeat-x;height:47px;}
.right-nav .speech-right  {float:left;background:url(/images/speech-right.png) no-repeat;width:10px;height:47px;} 
```

和html：

```
<div class="bg clearfix" style="width:100%;">
<div class="speech-left"></div>
<h2 class="speech-repeat">hello</h2>
<div class="speech-right"></div>
</div> 
```

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T10:49:37.830

您可能还需要浮动中间元素：

```
.right-nav h2.speech-repeat {
    background: url(/images/speech-repeat.png) repeat-x;
    height: 47px;
    float: left;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T11:42:39.000

我建议以不同的方式分割你的图像。它目前确实有效，但是由于您的左侧图像包括底部气泡上的粘性位，因此气泡的中间部分无法开始，直到左侧部分完全完成。

您可以使用边距来偏移中间部分，以使文本显示在左侧图像的顶部，但是我倾向于以九个补丁的工作方式进行操作。

![在此处输入图像描述](../Images/2df0e16170c913a4b1eb072c053f5e58.png)

使用这种结构显然会使用更多图像，但可以产生更好的结果，因为您可以最终调整垂直和水平大小以适应任意数量的文本。

也仅仅因为他们使用 9 段并不意味着你不能使用更多。在底部使用更多可以让你让粘性钻头保持相同的比例，而周围的底部部件会膨胀以填充它们需要的区域。

# javascript - 动态计算 if 函数

> ID：11686283
> 
> 赞同：1
> 
> 时间：2012-07-27T10:46:37.830
> 
> 标签：javascript, jquery

我在`compute`函数中有一些计算。

```
function compute() {
  var c = $('select#time_from_hour').val();
  var d = $('select#time_from_minute').val();
  var e = $('select#time_to_hour').val();
  var f = $('select#time_to_minute').val();
  var g = $('input#date_from').val();
  var h = $('input#date_to').val();
  var hour1 = g + ' ' + c + ':' + d;
  var hour2 = h + ' ' + e + ':' + f;

  hour1 = hour1.split("/");
  var hour1 = hour1[1] + "," + hour1[0] + "," + hour1[2];
  var timestamp = (new Date(hour1).getTime() / 1000) + 7200;
  $('#total_hour1').val(timestamp);

  hour2 = hour2.split("/");
  var hour2 = hour2[1] + "," + hour2[0] + "," + hour2[2];
  var timestamp = (new Date(hour2).getTime() / 1000) + 7200;
  $('#total_hour2').val(timestamp);

  var x = -$('input#total_hour1').val();
  var y = -$('input#total_hour2').val();
  var total_time = x - y;
  result = total_time / 86400;
  new_number = Math.ceil(result);

  if (isNaN(new_number)) {
    var new_number = 0;
  }
  $('#finish_day').val(new_number);

  if (parseInt($("#finish_day").val()) < 4) {
    $('#get_car, #return_car').not(this).children('#return_car option[value=' + this.value + ']').attr('selected', true).siblings().attr('disabled', true);
    $('#three_day').show(2000);
  } else {
    $('#get_car > option, #return_car > option').prop('disabled', false);
    $('#three_day').hide(2000, function() {
      $(this).remove();
    });
  }
}

$('select#time_from_hour').change(compute);
$('select#time_from_minute').change(compute);
$('select#time_to_hour').change(compute);
$('select#time_to_minute').change(compute);
$('select#return_car').change(compute);
$('select#get_car').change(compute);
$('input#finish_day').change(compute); 
```

`if`当输入字段中的数据发生更改时，我尝试强制脚本动态重新计算函数`#finish_day`。

```
if (parseInt($("#finish_day").val()) < 4) {
  $('#get_car, #return_car').not(this).children('#return_car option[value=' + this.value + ']').attr('selected', true).siblings().attr('disabled', true);
  $('#three_day').show(2000);
} else {
  $('#get_car > option, #return_car > option').prop('disabled', false);
  $('#three_day').hide(2000, function() {
    $(this).remove();
  });
} 
```

它仅在我更改数据时才更改`#get_car`

工作示例：http: [//jsfiddle.net/amarcinkowski/W7NHK/25/](http://jsfiddle.net/amarcinkowski/W7NHK/25/)

* * *

问题如下：

我有一个预订表格，我在其中使用日期选择器，其中有两个日期框：开始和结束，以及两个带有可用城市列表的选择表单字段。根据所选日期，脚本计算天数。

如果天数少于 4，则在所选城市列表之一（第二个 - City2）上更改活动城市的可用性并自动选择在第一个列表（City1）中选择的城市。因此，如果我们在第一个列表城市中选择 - 例如卡托维兹，并且第二个列表脚本中的天数小于 4，则会自动标记卡托维兹城市，其他城市将处于非活动状态（禁用）。

当天数大于 4 天时，问题就开始了。这两个列表都是完全活跃的，您可以选择任何城市，没有任何限制。如果您选择不同的城市然后更改日期，并且天数下降到 3（例如），整个脚本应重新计算值并在第二个窗口中设置，即在第一个窗口中选择的城市（City1 = City2）。不幸的是，这不会发生。此外，在第二个列表中，您可以选择任何城市——所有城市都处于活动状态。仅当您从第一个列表中选择城市时，整个脚本才会重新计算。

# php - PHP XML：根据节点值删除元素和所有子节点？

> ID：11686287
> 
> 赞同：0
> 
> 时间：2012-07-27T10:47:16.420
> 
> 标签：php, dom, removechild

**你好！**

我有一个问题，我试图根据一个子值删除元素（带子）：这是 XML 示例：

```
 <?xml version="1.0" encoding="UTF-8"?>
    <Businesses>
    <Business NAME="busin1">
    <CHILD ID="30"><title>child Title</title>
    <description>Child Description</description>
    <urlToSite>http://www.MySite.co.il</urlToSite>
    <endtime>20120720103000</endtime>
    <starttime>20120710191500</starttime>
    </CHILD> 
<CHILD>...</CHILD>
<CHILD>...</CHILD>
</Business>
    </Businesses> 
```

现在我需要删除其“结束时间”值比现在更旧的所有特定“儿童”元素（包括儿童）（或者只是“结束时间”等于特定值）

"endtime" 是一个日期，格式为：yyyymmddHHMMSS

这是我的第一次尝试（没有成功）：

```
 $doc = new DOMDocument; 
    $doc->load('MyXML.xml'); //The XML Above

    $thedocument = $doc->documentElement;

    //this gives you a list of the childs
    $list = $thedocument->getElementsByTagName('CHILD');

    //figure out which ones you want -- assign it to a variable (ie: $nodeToRemove )
    $nodeToRemove = null;
$time=date("YmdHis",time ());
    foreach ($list as $domElement){
 $attrValue = $domElement->childNodes->item('endtime')->nodeValue; //not Sure about this!!
      if ($attrValue > $time) {
        $nodeToRemove = $domElement;
      }
    }

    //Now remove it.
    if ($nodeToRemove != null)
    $thedocument->removeChild($nodeToRemove);
    echo $doc->saveXML(); 
```

**非常感谢！**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T11:00:43.067

使用 XPath 查询文档节点。试试这个：

```
$maxTime = date("YmdHis", time());

$doc = new DOMDocument();
$doc->load("MyXML.xml");

$xpath = new DOMXPath($doc);
$q = "/Businesses/Bisiness/CHILD/endtime[. > {$maxTime}]";
foreach ($xpath->query($q) as $node) {
    $businessNode = $node->parentNode;
    $businessesNode = $businessNode->parentNode;
    $businessesNode->removeChild($businessNode);
} 
```

[这是](http://msdn.microsoft.com/en-us/library/ms256086.aspx)一个带有 XPath 示例的好页面。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-28T18:09:11.713

**你好，我们又见面了！**

经过一整天的研究..终于我找到了问题..

首先感谢迈克尔的帮助。

这是最终的工作代码：

```
<?php

$doc = new DOMDocument; 
$doc->load('MyXML.xml');

$maxTime = date("YmdHis", time());

$xpath = new DOMXPath($doc);
$q = "/Businesses/Bisiness/CHILD/endtime[. < {$maxTime}]";
foreach ($xpath->query($q) as $node) {
    $businessNode = $node->parentNode;
    $businessesNode = $businessNode->parentNode;
    $businessesNode->removeChild($businessNode);
}

// inserting to variable ONLY
$last = $doc->saveXml();
// IMPORTANT!! - we have to rewrite to XML the Results back!!
file_put_contents('MyXML.xml', $last)
?> 
```

我没有在任何地方找到它，所以我希望这会对你有所帮助.. :)

# ruby-on-rails - Apache 对 POST 请求大小的限制

> ID：11686288
> 
> 赞同：14
> 
> 时间：2012-07-27T10:47:19.063
> 
> 标签：ruby-on-rails, ruby-on-rails-3, apache, post, passenger

`POST`apache中的请求大小有限制吗？这个限制的默认值是多少，有没有办法增加它？如果重要，`Rails`应用程序将在此服务器上使用乘客启动。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-07-27T11:08:13.570

Apache 中的限制是通过`LimitRequestBody`指令设置的，默认为`0`：

> 该指令指定请求正文中允许的从 0（表示无限）到 2147483647 (2GB) 的字节数。

查看 Apache 的[LimitRequestBody 指令](http://httpd.apache.org/docs/2.0/mod/core.html#limitrequestbody)的完整描述。

除此之外，`Rails`它本身可能会施加一个限制（虽然我从未在 Ruby 中编程过 b/c，但我无法判断）。

# silverlight-5.0 - Silverlight Toolkit 复杂柱形图和 StackedColumn 图表

> ID：11686289
> 
> 赞同：1
> 
> 时间：2012-07-27T10:47:22.423
> 
> 标签：silverlight-5.0, charts

可以做到吗？

我想要一个包含三个系列的标准柱形图，其中一个系列由两个组成，如下所示：

![堆叠列与同一图表上的普通列](../Images/d7af3fd87e9f9f2aeb8efb116a564911.png)

我试图实现它，但我最终得到了一些非常奇怪的东西。不过解释很有趣。

我几乎可以肯定答案是否定的，但如果有人知道我该怎么做，那就太好了！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T11:34:22.237

显而易见的答案是将标准 Silverlight StackedColumnSeries 与以下数据集一起使用：

```
 Bottom       Top

Red       ##           0

Orange    ##           ##

Green     ##           0 
```

这达到了预期的效果。

# java - 在 MVC 架构的控制器中打开休眠会话是个好主意吗？

> ID：11686293
> 
> 赞同：0
> 
> 时间：2012-07-27T10:47:42.870
> 
> 标签：java, hibernate, model-view-controller, spring-mvc

我有一个非常复杂的域实体。我想对所有关联进行延迟加载。所以场景是这样的：

1.获取我的业务逻辑的一个实例。

2.从业务中获取对象o。

3.要求o给我其他相关的对象。

4.准备视图。

为了在延迟加载其他对象时摆脱关闭会话的休眠异常，我想出了在控制器中打开和关闭整个会话的想法。这是个好主意吗？有没有更好的解决方案？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T17:44:25.907

会话视图是一种[不好的做法](https://stackoverflow.com/questions/1103363/why-is-hibernate-open-session-in-view-considered-a-bad-practice)。

以下是通常用于解决此问题的层的建议：

控制器

*   控制器只关心处理 Web 请求，将它们解释为您的服务将处理的对象，并将服务结果作为 Web 响应返回。我通常在每个控制器方法中只有一个事务服务方法调用，更愿意在单个事务中保留一个控制器操作的所有数据访问。

服务

*   服务层只关心从控制器接受数据，获取它需要的数据（从数据层）来执行它的操作，并返回有意义的结果。该服务应完全加载控制器所需的所有延迟加载实体。这里的服务方法是事务性的，不会有延迟加载问题，并且您可以从多个 DAO 组装结果。这样 DAO 就不需要[互相了解了](https://stackoverflow.com/questions/2285005/calling-one-dao-from-another-dao)。

数据访问

*   [数据访问层](https://stackoverflow.com/questions/6785184/generic-hibernate-dao)只关心持久性（CRUD），允许通过过滤、排序等访问数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T10:51:00.613

Spring 有一个`opensessioninviewfilter`和一个`opensessininviewinterceptor`应该为你处理这个功能的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-27T10:53:22.400

作为一种设计模式，openinig session 在视图中是非常糟糕的。我认为 SpringMVC 有一个设置可以为您打开会话并解决您的问题。

但是，如果您的应用程序比宠物店更复杂，我建议不要使用这种模式。我建议将数据检索和业务逻辑下移一层，并在控制器中只保留与 UI 相关的代码。Tethinking 关系并在它们上设置急切和懒惰的设置应该有效。在没有分析的情况下将所有内容设置为惰性并不是一个好主意。每个请求都会有数百个 SQL 调用。

我建议将 L2 缓存（例如 EHCache）插入 Hibernate。配置和使用非常简单。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-27T11:14:14.090

您确实可以做到，这是使用 Spring 和 Hibernate 时的常见模式。您可以通过将以下代码放入您的 web.xml 中轻松启用它

```
<filter>
    <filter-name>lazyLoadingFilter</filter-name>
    <filter-class>org.springframework.orm.hibernate3.support.OpenSessionInViewFilter</filter-class>
</filter>
<filter-mapping>
    <filter-name>lazyLoadingFilter</filter-name>
    <url-pattern>/mvc/*</url-pattern>
</filter-mapping> 
```

一旦你有了这个，在该调用中进行的每个休眠调用都将使用相同的会话：

```
@Autowired
protected SessionFactory sessionFactory;

protected Session getSession() {

    return SessionFactoryUtils.getSession(sessionFactory, true);
} 
```

但是，正如 Peter Gwiazda 所说，您可能希望也可能不希望这样做，具体取决于应用程序的规模和复杂性。听起来您的对象非常复杂，因此当您在 JSP 中遍历实体或任何不会导致出色性能的东西时，让您的视图本质上触发更多 SQL 语句。

通常，将对象转换为具有视图需要的 DTO 并限制从数据库取回的数据量通常是一种更好的模式。

# objective-c - 尝试使用 gdata api 显示电子表格失败 feedURL

> ID：11686296
> 
> 赞同：2
> 
> 时间：2012-07-27T10:47:56.583
> 
> 标签：objective-c, xcode, oauth-2.0, gdata-api

我正在开发一个使用 gdata-objective-c-client 和 oauth 2.0 与谷歌连接的应用程序。我想显示用户的电子表格。我正在查看[http://code.google.com/p/gdata-objectivec-client/source/browse/trunk/Examples/#Examples%2FDocsSample](http://code.google.com/p/gdata-objectivec-client/source/browse/trunk/Examples/#Examples%2FDocsSample)以查看如何使用 oauth 并且能够列出所有文档和电子表格，但我只想显示电子表格，所以我更改了服务，但出现错误并且没有显示任何内容。

这是我的代码：

```
@implementation ViewController

@synthesize accessToken;
@synthesize mDoclistFetchTicket;
@synthesize mWorksheetFeed;
@synthesize mSpreadsheetFeed;

static NSString *const kMyClientID = @"199740745364-22lugf8undgv0rc0ucbfpgsn3v90lfsd.apps.googleusercontent.com";
static NSString *const kMyClientSecret = @"dPFs5D66kLyQIgUNL6igKUoX";
static NSString *const kKeychainItemName = @"casa";

- (GDataServiceGoogleSpreadsheet *)spreadsheetService {

    static GDataServiceGoogleSpreadsheet* service = nil;

    if (!service) {
        service = [[GDataServiceGoogleSpreadsheet alloc] init];

        [service setShouldCacheResponseData:YES];
        [service setServiceShouldFollowNextLinks:YES];
    }

    return service;
}

- (void) mifetch {

    GDataServiceGoogleSpreadsheet *service = [self spreadsheetService];

    GDataServiceTicket *ticket;

    //HERE IS WHERE I GET THE ERROR
    NSURL *feedURL = [NSURL URLWithString: kGDataGoogleSpreadsheetsPrivateFullFeed];

    ticket = [service fetchFeedWithURL:feedURL
                          delegate:self
                 didFinishSelector:@selector(ticket:finishedWithFeed:error:)];

    mDoclistFetchTicket = ticket;

}

- (void) ticket: (GDataServiceTicket *) ticket
finishedWithFeed: (GDataFeedSpreadsheet *) feed
      error: (NSError *) error {

    mSpreadsheetFeed = feed;
}

- (void)authorize {

   NSString *scope = @"https://spreadsheets.google.com/feeds";

    GTMOAuth2ViewControllerTouch *windowController = [[GTMOAuth2ViewControllerTouch alloc] 
                                                  initWithScope:scope
                                              clientID:kMyClientID
                                        clientSecret:kMyClientSecret
                                    keychainItemName:kKeychainItemName
                                delegate:self
                            finishedSelector:@selector(viewController:finishedWithAuth:error:)];

    [[self navigationController] pushViewController:windowController animated:YES];
    }

- (IBAction)autenticarse 
{
    [self authorize];
}

- (IBAction)listar:(id)sender
{

    [self performSegueWithIdentifier:@"displaydocs" sender:sender];

}

- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{

    if ([[segue identifier] isEqualToString:@"displaydocs"])
    {

        VistaTableViewController *vistatableview = [segue destinationViewController];

        vistatableview.delegate = self;

        vistatableview.mSpreadsheetFeed2 = mSpreadsheetFeed;

    }

}

- (void)viewController:(GTMOAuth2ViewControllerTouch *)viewController
  finishedWithAuth:(GTMOAuth2Authentication *)auth
             error:(NSError *)error
{
        [[self docsService] setAuthorizer:auth];
        [self mifetch];

}

@end 
```

这就是 Xcode 所说的：

serviceBase: objectFetcher:GTMHTTPFetcher 0xe5c7580 (https://spreadsheets.google.com/feeds/spreadsheets/private/full) failedWithStatus:404 数据

起初，当我展示文档和电子表格时，我使用了这样的 GDataServiceGoogleDocs：

```
- (GDataServiceGoogleDocs *)docsService {

    static GDataServiceGoogleDocs* service = nil;

    if (!service) {
        service = [[GDataServiceGoogleDocs alloc] init];

        [service setShouldCacheResponseData:YES];
        [service setServiceShouldFollowNextLinks:YES];
        [service setIsServiceRetryEnabled:YES];
    }

    return service;

} 
```

并创建 de feedURL 我使用了这个：

```
NSURL *feedURL = [GDataServiceGoogleDocs docsFeedURL]; 
```

但是，我必须使用什么 feedURL 来显示电子表格？

谢谢！！

# python - 如何将 Selenium html 页面传递给 htmlXpathSelector

> ID：11686299
> 
> 赞同：3
> 
> 时间：2012-07-27T10:48:09.383
> 
> 标签：python, selenium, scrapy

我需要抓取一个使用 javascript 的页面。这就是我使用 Selenium 的原因。问题是硒无法获取所需的数据。

我想使用 htmlXmlSelector 来尝试获取数据。

如何将生成的 html selenium 传递给 htmlXmlSelector ？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-27T15:37:05.327

这是我的解决方案：只需从 selenium page_source 创建 htmlXpathSelector：

```
hxs = HtmlXPathSelector(text=sel.page_source) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T23:39:25.993

Selenium 手动响应：

```
from scrapy.spider import BaseSpider
from scrapy.http import TextResponse
from scrapy.selector import HtmlXPathSelector
import time
from selenium import selenium

class DemoSpider(BaseSpider):
    name="Demo"
    allowed_domains = ['http://www.example.com']
    start_urls = ["http://www.example.com/demo"]

    def __init__(self):
        BaseSpider.__init__(self)
        self.selenium = selenium("127.0.0.1", 4444, "*chrome", self.start_urls[0])
        self.selenium.start()

    def __del__(self):
       self.selenium.stop()

    def parse (self, response):
        sel = self.selenium
        sel.open(response.url)
        time.sleep(2.0) # wait for javascript execution

        #build the response object from Selenium
        body = sel.get_html_source()
        sel_response = TextResponse(url=response.url, body=body, encoding = 'utf-8')
        hxs = HtmlXPathSelector(sel_response)
        hxs.select("//table").extract() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-27T10:57:01.650

尝试`Response`手动创建：

```
from scrapy.http import TextResponse
from scrapy.selector import HtmlXPathSelector

body = '''<html></html>'''

response = TextResponse(url = '', body = body, encoding = 'utf-8')

hxs = HtmlXPathSelector(response)
hxs.select("/html") 
```

# actionscript-3 - AS3 addChild PARADOX。

> ID：11686301
> 
> 赞同：0
> 
> 时间：2012-07-27T10:48:28.627
> 
> 标签：actionscript-3, instance, addchild, paradox

好的，这是一个更多关于我认为的方法的问题。我对此很陌生，因此我认为方法错误。

我想制作一个“游戏”，每次点击时，舞台都会创建一个 addChild。在搜索了几个网站之后，以我有限的知识和来回尝试，我得出了这个结论：

```
mouse.addEventListener(MouseEvent.CLICK, CREATE);
function CREATE(e:Event):void {
    var square:MovieClip = new squarelink();
    addChild(square);
    square.x = mouseX;
    square.y = mouseY;
} 
```

现在我的问题是我想对其进行编码，给这个新的movieclip一些“事件”，但是因为我的movieclip直到我点击后才会出现在舞台上。其名称中的任何 addeventlistener 都会出现：访问可能未定义的属性。这导致我的 swf 失败。

因此，我尝试设置“var square:MovieClip = new squarelink();” 超出我的 CREATE 功能。这只是导致它仅在我单击时移动正方形，而不是创建新的一次。如何让我现在添加事件成为可能。

所以总结一下。我需要一种方法，允许我创建几个“孩子”，并让我添加一个事件，如果我再次点击它：删除它自己。

这没有告诉我舞台上还没有任何广场。

（这是对问题的解释，对拼写错误的任何评论，或者“你需要一个大 R 才能工作”是受欢迎的，但可能无法使用。我知道如何正确编写代码，我只是不知道写了哪些代码。）

我希望这个问题得到了很好的解释，我希望这里的人能提供帮助，因为距离我回到学校还有 1 个月的时间去问我的老师。:D

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T13:37:00.030

您应该为您的问题开发一个更复杂的、面向对象的解决方案。有一个主应用程序类来创建对象，并让这些创建的对象将“请删除我”事件发送给创建者对象。

但是，考虑到您在此处给出的这个简单示例，有一个简单的解决方案涉及停止从单击的对象到舞台的事件传播。

```
stage.addEventListener(MouseEvent.CLICK, createCircle);
function createCircle(event:MouseEvent):void
{
    var circle:Sprite = new Sprite();
    circle.graphics.beginFill(0x00FF00);
    circle.graphics.drawCircle(0, 0, 20);
    circle.x = stage.mouseX;
    circle.y = stage.mouseY;
    stage.addChild(circle);

    circle.addEventListener(MouseEvent.CLICK, removeCircle);
}

function removeCircle(event:MouseEvent):void
{
    stage.removeChild(event.currentTarget as DisplayObject);

    // magic!
    event.stopPropagation();
} 
```

*   [http://www.learningactionscript3.com/2007/11/19/stopping-event-propagation/](http://www.learningactionscript3.com/2007/11/19/stopping-event-propagation/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T11:07:09.117

上面的代码用于在舞台上创建一个movieclip 实例。要删除影片剪辑，您需要为该影片剪辑附加一个类。在该类中，添加一个必须删除包含的影片剪辑的事件侦听器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-27T12:15:08.897

addChild 悖论 ?? 无论如何，我所理解的是你需要：

*   在舞台点击时将影片剪辑添加到舞台上。
*   单击一次然后再次单击时删除影片剪辑。

如果是这种情况，请以此为例：

```
stop();

stage.addEventListener(MouseEvent.CLICK, createBox);

function createBox(e:MouseEvent) {

    if(e.target != stage) return;

    var square:MovieClip = new MovieClip();

    square.graphics.beginFill(0,1);
    square.graphics.drawRect(0,0,25,25);
    square.graphics.endFill();

    square.x = 100;
    square.y = 100; 
    square.name = "mc" + this.numChildren;

    square.addEventListener(MouseEvent.CLICK, function(e) {

        var sq:MovieClip = e.currentTarget;

        if(sq.name.charAt(0) == '_') removeChild(sq);

        else sq.name = "_" + sq.name;       
    });

    addChild(square);   
} 
```

# jquery - 如何使用 jquery 将类添加到表的最后一个 tr

> ID：11686302
> 
> 赞同：2
> 
> 时间：2012-07-27T10:48:27.580
> 
> 标签：jquery, css-selectors

代码必须与 ie 一起使用，所以 :last 不是一个选项

```
<table class="ms-main" cellpadding="0" cellspacing="0" border="0" width="100%" height="100%">
<tr>..</tr>
<tr>..</tr>
<tr>..</tr>
<tr class=add this value including class=>..</tr>
</table> 
```

先感谢您

编辑1：

如果源文件是这个怎么办？

```
<table class="ms-main" cellpadding="0" cellspacing="0" border="0" width="100%" height="100%">
<tr>..</tr>
<tr>..</tr>
<tr>..</tr>
<tr class=add this value including class=>**<table>more nested tables here</table>**</tr>
</table> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T10:50:05.020

`:last`确实在 IE 中工作。

jQuery 是手动实现的，它与浏览器支持的 css 选择器无关。

```
$('.ms-main tr:last').addClass('name-of-class'); 
```

[这是一篇](http://blog.bigbinary.com/2010/02/15/how-jquery-selects-elements-using-sizzle.html)关于 jQuery 实现嘶嘶声选择器和使用的好文章`querySelectorAll`

至于您的编辑，您可能希望用来`>`表示`tr`应该是直接子代，而不是更远的后代。

```
$('.ms-main > tr:last') 
```

不过，请`tbody`注意。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T10:58:29.320

```
<script>
   $("table tr:last").addClass("lastOne");
</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-27T10:52:45.550

`$('table tr').last().addClass('myClass');`

IE 6-8 不支持选择器`:last-child`，使用方法 last() 查找 DOM 中的最后一个元素

# object - 如何使用 SharePoint 客户端对象模型和 PowerShell 将文档上传到库？

> ID：11686305
> 
> 赞同：3
> 
> 时间：2012-07-27T10:48:32.697
> 
> 标签：object, powershell, model, client, powergui

我尝试将这些代码片段转换为 PowerShell：

```
ClientContext context = new ClientContext("http://spdevinwin");
   2:  
   3: Web web = context.Web;
   4:  
   5: FileCreationInformation newFile = new FileCreationInformation();
   6: newFile.Content = System.IO.File.ReadAllBytes(@"C:\Work\Files\17580_FAST2010_S05_Administration.pptx");
   7: newFile.Url = "17580_FAST2010_S05_Administration 4MB file uploaded via client OM.pptx";
   8:  
   9: List docs = web.Lists.GetByTitle("Documents");
  10: Microsoft.SharePoint.Client.File uploadFile = docs.RootFolder.Files.Add(newFile);
  11: context.Load(uploadFile);
  12: context.ExecuteQuery();
  13: Console.WriteLine("done"); 
```

和：

```
// FileInfo in System.IO namespace
var fileCreationInformation = new FileCreationInformation();

byte[] bytefile = System.IO.File.ReadAllBytes(“c:\\test\Test2.txt”);
fileCreationInformation.Content = bytefile;
fileCreationInformation.Overwrite = true;
fileCreationInformation.Url = “http://astro/MyLibrary/MyFolder/Test2.txt”;

// CurrentList is a client OM List object
CurrentList.RootFolder.Files.Add(fileCreationInformation);
Context.ExecuteQuery(); 
```

但是我在 Update() 和 Add($file) 方法上遇到错误

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-10T20:19:16.230

使用 PowerShell 将文件上传到 SharePoint 的公认方法是使用 SharePoint PowerShell Cmdlts，而不是使用客户端对象模型。您可以使用类似于以下代码的内容：

```
Add-PSSnapin Microsoft.SharePoint.Powershell -ErrorAction SilentlyContinue

$Library = "My Library"
$siteurl = "http://MyWebApp/sites/SiteName"
$FilePath = "C:\Test\test2.txt"

# Get Web site
$Web = Get-SPWeb $SiteUrl

# Get Library
$docLibrary = $web.Lists[$Library]
$folder = $docLibrary.RootFolder

# Get the file
$File = Get-ChildItem $FilePath

# Build the destination SharePoint path
$SPFilePath = ($folder.URL + "/" + $File.Name)

$spFile = $folder.Files.Add($SPFilePath, $File.OpenRead(), $true)  #Upload with overwrite = $true (SP file path, File stream, Overwrite?) 
```

对于可用于上传文件、覆盖、批准和签入的可重用功能，请使用我在此处创建的 cmdlet：http: [//pastebin.com/Tvb4LfZV](http://pastebin.com/Tvb4LfZV "添加 SPFileToLibrary")

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-22T04:59:30.683

如果您在服务器上运行，您将只能使用 SharePoint PowerShell cmdlet。他们不远程工作，尤其是对于 SharePoint Online。

您没有包含所有 PowerShell 代码，但我猜您在获取列表并将文件加载到服务器的每个步骤之后都没有调用 ClientContext.Load 和 ClientContext.ExecuteQuery。

[使用许多 PowerShell CSOM 方案的参考](http://www.hartsteve.com/2013/06/sharepoint-csom-powershell-examples/)

# python - Pyramid：为什么 NewRequest 订阅者每次请求都调用 3 次？

> ID：11686311
> 
> 赞同：0
> 
> 时间：2012-07-27T10:48:57.293
> 
> 标签：python, pyramid

这对我来说很有趣，我已经检查过了。如您`NewRequest`所见，每个请求调用订阅者 3 次（或启用 debug_toolbar 时调用 7 次...），而`BeforeRender`每个请求调用订阅者 1 次（启用 debug_toolbar 时调用 > 30 次）。

因此，如果我想通过事件将**mongodb**连接到我的项目`NewRequest`，每个请求将执行 3 次...

这是为什么？为什么服务器要对每个请求执行 3 次相同的工作？

提前致谢！！！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-27T13:54:03.777

Pyramid 每个请求不会`NewRequest`多次调用。发生这种情况的唯一原因是您不小心多次注册订阅者。人们认为它被多次调用的另一个常见原因是浏览器通常会跟随带有 favicon 请求的请求，但这仅占 2 次调用。您能否显示任何输出或更多地描述您的问题以使我相信订户确实被多次调用？

`BeforeRender`将被调用多次（每个模板渲染一次）。启用调试工具栏后，每个请求都会呈现很多东西，但即使这样，30 听起来更像是我期望的 3 倍。

一般来说，在订阅者中连接到您的数据库并不是一个好主意`NewRequest`，因为该订阅者也会被调用以获取静态资源（实际上是所有请求）。更好的模式是`request`通过`config.set_request_property`. 这将在您第一次在每个请求中使用数据库时连接，并且在您不使用时不会降低性能。

# objective-c - 将图像转换为灰度

> ID：11686312
> 
> 赞同：1
> 
> 时间：2012-07-27T10:49:08.110
> 
> 标签：objective-c, ios, cocoa-touch, uiview, uiimageview

在我的应用程序中，我有一个，在此之上`UIImageView`有一个清晰的背景颜色。`UIView``UIImageView`

我正在使用`UIBezierPath`在此 UIView 上进行免费手绘，以便用户`UIImage`在`UIImageView`.

我正在为`UIBezierPath`颜色添加透明度。

`UIImage`我的问题是，当我最初加载`UIImageView`如何制作`UIImage`灰度外观时，当用户在屏幕上移动手指时，原始颜色`UIImage`会显示给用户吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T11:28:42.817

正确的方法是使用 Core Image，并编写自己的 Core Image 过滤器来对彩色图像进行操作。通过在过滤器上设置一些属性，它会知道绘制一些颜色的部分，但将其他区域转换为灰度。

也就是说，这不是一个微不足道的工作项目。您也许可以一起破解其他东西，但它可能会生涩且不流畅。Core Image 过滤器的工作方式与 Core Animation 相同（在 GPU 附近），所以如果你采用这种方式，它会很好地工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T12:06:06.933

触摸时，调用此函数返回灰度图像。在触摸结束时，为 UIImageView 设置原始图像。

```
- (UIImage*)imageWithGrayScaleImage:(UIImage*)inputImg
{   
//Creating image rectangle
//CGRect imageRect = CGRectMake(0, 0, inputImg.size.width / (CGFloat)[inputImg scale], inputImg.size.height / (CGFloat)[inputImg scale]);
CGRect imageRect = CGRectMake(0, 0, inputImg.size.width, inputImg.size.height);

//Allocating memory for pixels
int width = imageRect.size.width;
int height = imageRect.size.height;

uint32_t *pixels = (uint32_t*)malloc(width * height * sizeof(uint32_t));

//Clearing the memory to preserve any transparency.(Alpha)
memset(pixels, 0, width * height * sizeof(uint32_t));

//Creating a context with RGBA pixels
CGColorSpaceRef colorSpace = CGColorSpaceCreateDeviceRGB();
CGContextRef context = CGBitmapContextCreate(pixels, width, height, 8, width * sizeof(uint32_t), colorSpace, kCGBitmapByteOrder32Little | kCGImageAlphaPremultipliedLast);

//Drawing the bitmap to the context which will fill the pixels memory
CGContextDrawImage(context, imageRect, [inputImg CGImage]);

//Indices as ARGB or RGBA
const int RED = 1;
const int GREEN = 2;
const int BLUE = 3;

for (int y = 0; y < height; y++)
{
    for (int x = 0; x < width; x++)
    {
        uint8_t* rgbaPixel = (uint8_t*)&pixels[y * width + x];

        //Calculating the grayScale value
        uint32_t grayPixel = 0.3 * rgbaPixel[RED] + 0.59 * rgbaPixel[GREEN] + 0.11 * rgbaPixel[BLUE];

        //Setting the pixel to gray
        rgbaPixel[RED] = grayPixel;
        rgbaPixel[GREEN] = grayPixel;
        rgbaPixel[BLUE] = grayPixel;
    }
}

//Creating new CGImage from the context with modified pixels
CGImageRef newCGImage = CGBitmapContextCreateImage(context);

//Releasing resources to free up memory
CGContextRelease(context);
CGColorSpaceRelease(colorSpace);
free(pixels);

//Creating UIImage for return value
//UIImage* newUIImage = [UIImage imageWithCGImage:newCGImage scale:(CGFloat)[inputImg scale] orientation:UIImageOrientationUp];
UIImage* newUIImage = [UIImage imageWithCGImage:newCGImage];

//Releasing the CGImage
CGImageRelease(newCGImage);

return newUIImage;
} 
```

# java - 仅部署 java 文件而不部署 WAR

> ID：11686317
> 
> 赞同：2
> 
> 时间：2012-07-27T10:49:22.430
> 
> 标签：java, eclipse, jsp, tomcat

我有一个基于 jsp 的 Web 应用程序。

源代码保存在`C:/MyApp/src`. 这里它包含控制器和其他`.java`文件。

通过eclipse构建应用程序后。我将文件复制到`.war`文件`Apache/WebApps`夹。Apache Tomcat 对其进行了扩展，并且 Web 应用程序运行良好。

从最近几天开始，我直接在`Apache/WebApps`文件夹中编辑了很多页面。现在我想编辑一个`.java`文件`C:/MyApp/src/..`

现在我想`.java`在我的中使用那个更新的文件，`Apache/WebApps`但不想通过 eclipse 重建整个代码。如果这样做，我在`Apache/WebApps`文件夹中所做的更改将丢失。

我该怎么办？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T11:02:31.473

你应该

1.  将部署文件夹 (Apache/WebApps) 中的所有修改合并回源文件夹 (C:/MyApp/src/)。确保您可以从源代码重建当前版本。
2.  开始使用某种[版本控制](http://en.wikipedia.org/wiki/Revision_control)工具，即使你只在本地机器上工作（我推荐[Git](http://git-scm.com/book/en/Getting-Started-Installing-Git#Installing-on-Windows)）
3.  开始使用[构建工具](https://stackoverflow.com/questions/7249871/what-is-a-build-tool)，而不是让 Eclipse 从源代码构建你的战争。我推荐[Maven](http://maven.apache.org/)或[Ivy](http://ant.apache.org/ivy/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-27T15:53:42.673

按照[@bpgergo](https://stackoverflow.com/users/176569/bpgergo)的建议进行更改，否则...

您可以使用 Eclipse 配置您的 tomcat 服务器，并从 eclipse 启动和停止服务器，然后您可以`add your project`在 eclipse 中配置服务器。

Eclipse 可以配置为将更改自动部署到服务器，因此无论何时更改 JSP 或 java 文件等任何内容，服务器都会自动接受更改，而无需部署 WAR 文件。

但是由于 java 更改不是可热部署的，所以每当您保存对 java 文件的更改时，eclipse 都会重新启动服务器。

如果您想在不重新启动服务器的情况下部署 java 更改，您也可以尝试使用**[JRebel](http://zeroturnaround.com/software/jrebel/eclipse-eval/)**（它可以免费使用 30 天 :-)）。

**现在我建议**（如果你不想走上面提到的方式。以下是一种非常粗暴的方法，以后应该避免）

1.  在eclipse中将文件编译`.java`成一个`.class`。
2.  关闭服务器
3.  将文件复制`.class`到服务器上的确切位置`WEB-INF/classes/..`
4.  重启服务器
5.  这将使您的 JSP 更改保持不变，也将反映`.java`更改

希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-27T11:14:24.333

安装插件

```
http://andrei.gmxhome.de/filesync/index.html 
```

并使用提取的战争文件。

# jquery - 1.7+ 中的 jQuery live() 与 on()

> ID：11686326
> 
> 赞同：3
> 
> 时间：2012-07-27T10:50:02.727
> 
> 标签：jquery, live

我知道从 jQuery 1.7 开始， .live() 方法已被弃用。所以这就是我想出的：

```
$(document.body).on('click', '#list', function() {
    console.log($(this));
}); 
```

这几乎可以解决问题，相当于：

```
$('#list').live('click', function(){
    console.log($(this));
}); 
```

它们都返回**#list** jQuery 对象，这正是我想要的。但是，问题是当我将 jQuery 对象作为第二个参数而不是字符串（这种情况经常发生）传递时，例如：

```
var list = $('#list');
$(document.body).on('click', list, function() {
    console.log($(this));
}); 
```

控制台返回**$(body)** jQuery 对象。在这一点上这是没有用的。;） 有任何想法吗？

编辑：这里的问题**不是**如何从示例 1 和 2 访问受影响的对象 $('#list')，而是如何在示例 3 中访问它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-27T11:06:40.350

您将在官方[文档](http://api.jquery.com/live/)中找到一个非常明确的答案：

> 不再推荐使用 .live() 方法，因为更高版本的 jQuery 提供了没有缺点的更好方法。特别是，使用 .live() 会出现以下问题：
> 
> *   jQuery 会在调用方法之前尝试检索选择器指定的元素`.live()`，这在大型文档上可能会很耗时。
> *   不支持链接方法。例如，*无效*`$("a").find(".offsite, .external").live( ... );` 且 无法按预期工作。
> **   由于所有`.live()`事件都附加在`document`元素上，因此事件在处理之前会采用最长和最慢的路径。*   调用[`event.stopPropagation()`](http://api.jquery.com/event.stopPropagation) 事件处理程序在停止附加在文档下方的事件处理程序方面是无效的；事件已经传播到 `document`。*   该`.live()`方法以令人惊讶的方式与其他事件方法交互，例如， `$(document).unbind("click")`删除所有通过调用`.live()`!*

 ** * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T11:25:16.543

将对象作为第二个参数传递给`on`.

从[文档](http://api.jquery.com/on/)：

`.on( events [, selector] [, data], handler(eventObject) )`

它要求选择器而不是 jQuery 对象，因此您需要使用：

```
$(document.body).on('click', '#list', function() {
    console.log($(this));
}); 
```*

# spring-mvc - jasperreport html 视图中的 nullpx

> ID：11686332
> 
> 赞同：3
> 
> 时间：2012-07-27T10:50:16.503
> 
> 标签：spring-mvc, jasper-reports

我的 Web 应用程序需要一个报告。为此，我在 iReport 中设计了一个 jrxml。我做了一个空白的 A4 模板。我已经编译了那个文件，然后把那个 jrxml 文件放到我的类路径中。但是，当我选择该 html 视图时，该页面中会显示一个“X”图像。在查看源代码中，该元素给出为

```
<td><img alt="" src="nullpx" style="width: 46px; height: 1px;"/></td> 
```

我的 jsxml 文件就像

```
<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="myreport" pageWidth="612" pageHeight="792" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="a086f896-d28c-413e-8acc-416ff16d190a">
    <property name="ireport.zoom" value="1.0"/>
    <property name="ireport.x" value="0"/>
    <property name="ireport.y" value="0"/>
    <field name="clientName" class="java.lang.String"/>
    <field name="currentBalance" class="java.lang.Float"/>
    <field name="creditLimit" class="java.lang.Float"/>
    <background>
        <band splitType="Stretch"/>
    </background>
    <title>
        <band height="79" splitType="Stretch"/>
    </title>
    <pageHeader>
        <band height="35" splitType="Stretch"/>
    </pageHeader>
    <columnHeader>
        <band height="33" splitType="Stretch">
            <staticText>
                <reportElement uuid="bc001d2d-32f7-4222-8155-79f0ebd97aa3" x="26" y="2" width="100" height="20"/>
                <textElement/>
                <text><![CDATA[clientName]]></text>
            </staticText>
            <staticText>
                <reportElement uuid="15f41fea-5cad-43b4-809b-7285fb9fea9f" x="201" y="2" width="100" height="20"/>
                <textElement/>
                <text><![CDATA[currentBalance]]></text>
            </staticText>
            <staticText>
                <reportElement uuid="16d187cb-beb0-4799-bdcf-5bfdb1583626" x="416" y="2" width="100" height="20"/>
                <textElement/>
                <text><![CDATA[creditLimit]]></text>
            </staticText>
        </band>
    </columnHeader>
    <detail>
        <band height="38" splitType="Stretch">
            <textField>
                <reportElement uuid="2cf8baa2-d1bc-46e2-a194-422d8d967f38" x="26" y="10" width="100" height="20"/>
                <textElement/>
                <textFieldExpression><![CDATA[$F{clientName}]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement uuid="6c560e8a-8020-453c-9f5c-84cf9a964391" x="201" y="10" width="100" height="20"/>
                <textElement/>
                <textFieldExpression><![CDATA[$F{currentBalance}]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement uuid="d8d431d9-8be9-46fb-bb43-3f4583c9c9e2" x="416" y="10" width="100" height="20"/>
                <textElement/>
                <textFieldExpression><![CDATA[$F{creditLimit}]]></textFieldExpression>
            </textField>
        </band>
    </detail>
    <columnFooter>
        <band height="45" splitType="Stretch"/>
    </columnFooter>
    <pageFooter>
        <band height="54" splitType="Stretch"/>
    </pageFooter>
    <summary>
        <band height="42" splitType="Stretch"/>
    </summary>
</jasperReport> 
```

无论如何，我可以在没有 htmlpage 中的任何图像的情况下使用 html。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-10-08T19:02:37.310

将 JRHtmlExporterParameter.IS_USING_IMAGES_TO_ALIGN 属性设置为“假”

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-02-05T07:34:46.570

将`exporterParameter`命名设置`net.sf.jasperreports.engine.export.JRHtmlExporterParameter.IS_USING_IMAGES_TO_ALIGN`为`false`：

例如：

```
<bean id="multiViewReport" class="org.springframework.web.servlet.view.jasperreports.JasperReportsMultiFormatView">
    <property name="url" value="classpath:someJasperReport.jrxml" />
    <!-- Set the ModelMap attribute "reportDataKey" to the JRDataSourceProvider -->
    <property name="reportDataKey" value="reportDSProvider" /> 
    <property name="exporterParameters">
         <map>
             <entry
                key="net.sf.jasperreports.engine.export.JRHtmlExporterParameter.IS_USING_IMAGES_TO_ALIGN">
                <value>false</value>
            </entry>
         </map>
     </property>
</bean> 
```

我的控制器方法如下所示：

```
@RequestMapping(value = "/report/{format}", method = RequestMethod.GET)
public String printWelcome(ModelMap model, @PathVariable(value = "format") String format) {
    JRDataSourceProvider jrDataSourceProvider = .....;
    model.addAttribute("format", format);
    model.addAttribute("reportDSProvider", jrDataSourceProvider);
    return "multiViewReport";
} 
```

这个控制器允许我通过将格式类型附加到基本 url 来生成不同的报告格式。

例如：http: [//yourhost.com :8080/springmvc-jasperreports/report/pdf](http://yourhost.com:8080/springmvc-jasperreports/report/pdf)

PS：我用 spring-webmvc 3.2.1.RELEASE 和 jasperreports 4.5.1 对此进行了测试。

# c# - 使用 C# .NET 在远程系统上计算

> ID：11686337
> 
> 赞同：0
> 
> 时间：2012-07-27T10:51:00.970
> 
> 标签：c#, cloud

我开始创建一个小型云平台，供以后学习和扩展到实际使用。我正在将 C# 与 WCF 一起使用。我的想法是拥有一个服务器和执行器系统。服务器将拥有用户提交给它的作业。执行器系统向服务器询问作业并执行作业并将结果更新到服务器。该作业是一个 C# 类对象，它具有`execute()`将由执行程序调用的方法。

我的问题是如何将对象及其方法（行为）移交给 Executor 以便 Executor 执行它。通过序列化对象，只会发送数据。我想知道像[Utilify](http://www.utilify.com)这样的云框架是如何实现的。尽管我更喜欢 WCF，但我对任何 C# 技术都可以在远程系统上执行这项工作持开放态度。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T14:04:19.087

我不推荐二进制序列化方法。我已经尝试过将二进制可执行代码发送到工作服务器的系统。这要么是不可能的，要么在很大程度上是不切实际的——（想象一下，如果你有很多代码要执行。每次你想执行它时通过网络发送所有代码是否可行？为什么不将代码存储在本地和只需通过网络发送变量）。

从内存中：我认为问题在于将程序集字节反序列化/解码为您可以调用的类`.execute()`。从理论上讲，您可以将其转换为调用`MyAction`并调用`.execute()`它的父类，但实际上这不起作用。

我同意 Bartlett 建议的替代方法。“工作服务器”应该存储一个版本`ActionsICanProcess.dll`，当被查询时，它可以告诉“作业分发服务器”它可以处理哪些命令。要使用新的作业定义更新“工作服务器”，您只需将新的“ActionsICanProcess.dll”传输到每个“工作服务器”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T12:16:02.443

如果您真的想这样做，您将不得不以某种方式将定义您的作业的程序集的二进制表示传输到执行程序，然后将其加载到 AppDomain 以运行您的代码。

```
var tempDomain = AppDomain.CreateDomain(someDomain);
tempDomain.Load(myTransmittedAssemblyBytes); 
```

请注意，您将创建一个充满安全漏洞的世界！确保您信任您正在加载的任何代码。

或者，为什么不让您的执行者宣传他们可以处理的工作类型，并且只向他们发送他们知道如何处理的数据。

# java - 使用 InputStream 通过网络寻找流式音频的有效方法

> ID：11686341
> 
> 赞同：6
> 
> 时间：2012-07-27T10:51:13.470
> 
> 标签：java, audio, inputstream

我正在使用[jlGui](http://www.javazoom.net/jlgui/jlgui.html)的 BasicPlayer 播放音频文件（它基于 Javasound）。该文件位于 Samba 共享中，我正在使用[Jcifs](http://jcifs.samba.org/)访问它。它给了我一个`InputStream`.

```
NtlmPasswordAuthentication auth = new NtlmPasswordAuthentication( ... );

SmbFile f = new SmbFile( ... );
SmbFileInputStream audioIn = new SmbFileInputStream(f);

int bufSize = 8096;//should I use f.length() here?
audioBIS = new BufferedInputStream(audioIn, bufSize);

audioBIS.mark(f.length());

    //call BasicPlayer
play(audioBIS); 
```

我需要能够将指针定位在文件中的任何位置，就像任何普通播放器一样。我能想到的唯一解决方案是`BufferedInputStream`每次需要重新定位指针时都使用标记/重置/跳过的组合。一旦我打开文件并获得 Stream，我就会调用该`mark()`方法，以便后续`reset()`将在开始时重新定位我。然后`skip()`我可以去我想去的地方。

```
audioBIS.reset();
audioBIS.skip(newBytePosition); 
```

我的问题是，只有当我指定一个足够大的缓冲区来包含整个文件时，skip() 调用才能按需要工作。

有没有更有效的方法来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T11:23:35.503

我和你现在走的完全一样。案例是我们有一个服务器（和一个 SMB 共享）保存数千个音频文件。这些文件需要在应用程序中可播放。

我从 jCifs 开始，并修改了 BasicPlayer 的源代码来处理 SmbFile，就像处理 File 一样。它工作得很好，但是当涉及到寻找/跳过时，它并没有真正让你大吃一惊。只要您与服务器的连接良好，就应该没问题。

我最终放弃了那个解决方案，而是在服务器上安装了 tomcat6，并部署了一个小而简单的 servlet，它允许在给定位置对文件发出请求。然后，客户端机器会将响应作为 InputStream 并将其传递给 BasicPlayer。它工作得更好，并且播放是即时的。该代码比此处粘贴的合理代码要多一些，但如果您有兴趣，我愿意与您分享。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-12T19:24:47.637

作为备选。您始终可以关闭流并重新创建它。似乎走得很快，如果需要，你会回到位置 0。

因此，请跟踪您所在的位置。只要你向前移动，保持流并用skip()跳转。一旦您需要再次返回，请关闭该流并创建一个新的并 skip() 到想要的位置。

除非应用程序一直在回跳，否则你应该没问题。

将其包装在一个新的漂亮的自定义流中，您将拥有一个支持来回传输的流。

# android - Android通过dns调用WebService时出错

> ID：11686346
> 
> 赞同：0
> 
> 时间：2012-07-27T10:51:48.983
> 
> 标签：android, web-services, dns

大家好，我搜索了大约两天的问题，但我没有找到任何可以解决的问题。

```
public class DiplomatikiActivity extends Activity {

private String METHOD_NAME = "authenticate"; // our webservice method name
 private String NAMESPACE = "http://dbsample"; // Here package name in webservice with reverse order.
private String SOAP_ACTION = NAMESPACE + METHOD_NAME; // NAMESPACE + method name
private final String URL="http://xxx.xx.xxx.xxxx:8080//axis2/services/dbservice?wsdl";

 @Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.login);
    un=(EditText)findViewById(R.id.et_un);
    pw=(EditText)findViewById(R.id.et_pw);
    ok=(Button)findViewById(R.id.btn_login);
    error=(TextView)findViewById(R.id.tv_error);

new Thread(authenticate).start();

    }
});

 }

Thread authenticate = new Thread() {

 public void run() {

 try {

final ConnectivityManager conMgr =  (ConnectivityManager)         getSystemService(Context.CONNECTIVITY_SERVICE);
 final NetworkInfo activeNetwork = conMgr.getActiveNetworkInfo();

 if (activeNetwork != null && activeNetwork.getState() == NetworkInfo.State.CONNECTED)  {
 try {

 SoapObject request = new SoapObject(NAMESPACE, METHOD_NAME);
 request.addProperty("name", un.getText().toString());
 request.addProperty("password", pw.getText().toString());

 SoapSerializationEnvelope envelope = new SoapSerializationEnvelope(
 SoapEnvelope.VER11);
 envelope.dotNet = true;
 envelope.setOutputSoapObject(request);
 HttpTransportSE androidHttpTransport = new HttpTransportSE(URL);    androidHttpTransport.call(SOAP_ACTION, envelope);
 Object result = envelope.getResponse();

.....

......

};

}; 
```

这是我的代码的一般模式。当 URL 采用这种形式时，私有最终字符串 URL="http://xxx.xx.xxx.xxx:8080//axis2/services/dbservice?wsdl"; 一切正常，webservice 运行，但是当我使用来自 no-ip 的 dns 并且 url 是 private static final String URL = "http://myname1985.zapto.org/axis2/services/dbservice?wsdl"; 它给了我一个错误。在这里我不得不说，当我在浏览器中运行 Web 服务时，上述两种形式都可以正常工作。第二种形式在我的 ip 中映射我的端口 (http://myname1985.zapto.org--->http://xxx.xx.xxx.xxx:8080)。

错误日志

```
07-27 13:45:51.460: W/System.err(599): org.xmlpull.v1.XmlPullParserException: expected: START_TAG     {http://schemas.xmlsoap.org/soap/envelope/}Envelope (position:START_TAG <    {http://schemas.xmlsoap.org/wsdl/}wsdl:definitions targetNamespace='http://dbsample'>@2:507 in     java.io.InputStreamReader@412b3f00) 
07-27 13:45:51.490: W/System.err(599):  at org.kxml2.io.KXmlParser.require(KXmlParser.java:2046)
07-27 13:45:51.490: W/System.err(599):  at org.ksoap2.SoapEnvelope.parse(SoapEnvelope.java:127)
07-27 13:45:51.530: W/System.err(599):  at org.ksoap2.transport.Transport.parseResponse    (Transport.java:63)
07-27 13:45:51.530: W/System.err(599):  at org.ksoap2.transport.HttpTransportSE.call    (HttpTransportSE.java:100)
07-27 13:45:51.550: W/System.err(599):  at com.woodripp3r.diplomatiki.DiplomatikiActivity$1.run    (DiplomatikiActivity.java:617)//points to androidHttpTransport.call(SOAP_ACTION, envelope);
07-27 13:45:51.550: W/System.err(599):  at java.lang.Thread.run(Thread.java:856)
07-27 13:45:51.570: W/System.err(599): android.view.ViewRootImpl$CalledFromWrongThreadException: Only the     original thread that created a view hierarchy can touch its views.
07-27 13:45:51.640: W/System.err(599):  at android.view.ViewRootImpl.checkThread    (ViewRootImpl.java:4039)
07-27 13:45:51.640: W/System.err(599):  at android.view.ViewRootImpl.invalidateChild    (ViewRootImpl.java:722)
07-27 13:45:51.640: W/System.err(599):  at android.view.ViewRootImpl.invalidateChildInParent    (ViewRootImpl.java:771)
07-27 13:45:51.701: W/System.err(599):  at android.view.ViewGroup.invalidateChild(ViewGroup.java:4005)
07-27 13:45:51.701: W/System.err(599):  at android.view.View.invalidate(View.java:8576)
07-27 13:45:51.710: W/System.err(599):  at android.view.View.invalidate(View.java:8527)
07-27 13:45:51.710: W/System.err(599):  at android.widget.TextView.checkForRelayout(TextView.java:6752)
07-27 13:45:51.710: W/System.err(599):  at android.widget.TextView.setText(TextView.java:3306)
07-27 13:45:51.710: W/System.err(599):  at android.widget.TextView.setText(TextView.java:3162)
07-27 13:45:51.730: W/System.err(599):  at android.widget.TextView.setText(TextView.java:3137)
07-27 13:45:51.730: W/System.err(599):  at com.woodripp3r.diplomatiki.DiplomatikiActivity$1.run    (DiplomatikiActivity.java:930)
07-27 13:45:51.770: W/System.err(599):  at java.lang.Thread.run(Thread.java:856) 
```

请大家帮助我，我不知道该怎么做才能解决我的问题

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T13:13:51.753

answear 在 no-ip 中是 tha 我使用端口重定向，现在我更改为 DNS Host(A) 并在我的 url 中添加：8080

私有静态最终字符串 URL = "http://myname1985.zapto.org:8080/axis2/services/dbservice?wsdl";

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T11:25:26.483

在 DiplomatikiActivity.java:930 您访问视图，但线程未在 UI 线程中运行，因此抛出异常，请阅读[本](http://developer.android.com/intl/ru/guide/components/processes-and-threads.html)指南

# javascript - Javascript - 将函数分配给变量不能按预期工作

> ID：11686348
> 
> 赞同：1
> 
> 时间：2012-07-27T10:51:53.873
> 
> 标签：javascript, jquery

当我尝试从函数返回对象并将其分配给 smalls 变量时，变量 smalls 为空，因为它的长度返回为 0。

```
var smalls = function(){
        var table = $("#box-table-a");
        return table.find("small");
    }, smallContent;
    for(var i = 0; i<smalls.length; i++){
        smallContent = smalls[i].innerHTML;
        smalls[i].parentElement.className += "relative";
        smalls[i].className += "form-absolute-right";
        smalls[i].innerHTML = "<span class='bubble'>" + smallContent + "<span>";
    } 
```

虽然这可行，但可变的小物具有所需的长度。

```
 var table = $("#box-table-a");
    var smalls = table.find("small");       //fetch the tr's with <small> tag
    var smallContent;
    for(var i = 0; i<smalls.length; i++){
        smallContent = smalls[i].innerHTML;
        smalls[i].parentElement.className += "relative";
        smalls[i].className += "form-absolute-right";
        smalls[i].innerHTML = "<span class='bubble'>" + smallContent + "<span>";
    } 
```

根据我对 Javascript 的了解，可以将函数分配给变量。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-27T10:56:20.790

你忘了在`smalls`这里执行

```
var smalls = function(){
        var table = $("#box-table-a");
        return table.find("small");
    }, smallContent;
    for(var i = 0; i<smalls.length; i++)
//                   ^smalls is a function pointer

var smalls = function(){
            var table = $("#box-table-a");
            return table.find("small");
        }(), smallContent;
//       ^execute the function
        for(var i = 0; i<smalls.length; i++)
//                       ^smalls is a nodeList 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-27T10:54:52.523

这是因为您必须实际执行该功能，而不仅仅是分配它。将您的函数分配更改为自动执行的匿名函数，这应该可以。

```
var smalls = (function(){
    var table = $("#box-table-a");
    return table.find("small");
})(), smallContent; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-27T11:12:43.433

正如其他人所提到的，您循环的是函数引用，而不是执行的结果`smalls`。

然而，当您使用 jQuery 时，您可以编写更短/更简单的代码：

```
var smalls = $("#box-table-a").find("small"); // this var really contains the elements
smalls.addClass("form-absolute-right").wrapInner("<span class='bubble' />");
smalls.parent().addClass("relative"); 
```

这有各种优点：

*   这些类被简单地添加到列表中，您不必担心空格。
*   wrapInner 确实保留了 DOM（以及所有侦听器等），而不是弄乱 html 字符串
*   parent() 遍历方法是唯一的集合，因此具有多个元素的元素`table-box`只会获得一个类
*   你根本不需要循环，jQuery 方法在集合中的每个项目上执行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-27T10:54:42.460

尝试

```
var smalls = function(){
    var table = $("#box-table-a");
    return table.find("small");
}, smallContent;
for(var i = 0; i<smalls().length; i++){
    smallContent = smalls()[i].innerHTML;
    smalls()[i].parentElement.className += "relative";
    smalls()[i].className += "form-absolute-right";
    smalls()[i].innerHTML = "<span class='bubble'>" + smallContent + "<span>";
} 
```

因为如果没有调用整个函数，就永远不会调用 return。

顺便提一句：

```
$('#box-table-a .small')
    .toggleClass('form-absolute-right',true)
    .wrap('<span class="bouble" />')
    .parent()
    .toggleClass('relative',tru); 
```

可能会更好。

# ios - 按下文本字段清除按钮时如何显示我的按钮？

> ID：11686353
> 
> 赞同：1
> 
> 时间：2012-07-27T10:52:09.997
> 
> 标签：ios, xcode, textfield

我像这样检查我的文本字段：

```
-(BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string
{
    if ([subtitleField.text length] == 0)
    {
        searchAddress.hidden = NO;
    }
    else 
    {
        searchAddress.hidden = YES;
    }

   return  YES;   
} 
```

但它只有在我通过清除键清除文本字段时才有效，如果我按下清除按钮，它就不起作用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-27T10:56:09.247

也实现该`[UITextFieldDelegate textFieldShouldClear:]`方法：

```
- (BOOL)textFieldShouldClear:(UITextField *)textField
{
    searchAddress.hidden = NO;
    return YES;
} 
```

# php - 为 TYPO3 搜索日历扩展（即将发生的事件、月视图、小部件）

> ID：11686355
> 
> 赞同：0
> 
> 时间：2012-07-27T10:52:12.087
> 
> 标签：php, events, calendar, widget, typo3

我正在寻找可以轻松嵌入网站（Typo3 / php）的日历。

要求：

*   月视图
*   小部件（小日历视图）
*   国际化
*   应该添加事件

单击日历时，日历应以详细视图显示即将发生的事件。我的问题是找到这样的日历扩展，它也定期更新/维护并且易于集成。我可以在使用时创建事件，`mbl_newsevent`但我需要月视图中的小部件。扩展喜欢`Extended Calendar`或`Calendar Base`不提供这样的小部件视图。它还应该支持不同的语言（英语、德语）。一天中的多个事件或相交（同一时间）的事件呢？

`mbl_newsevent`那么我唯一的选择是同时使用 PHP 日历或 jQuery 日历吗？你知道解决办法吗？

目前看来[PHP Calendar](http://keithdevens.com/software/php_calendar)`mbl_newsevent`是我实现这样一个项目的最佳机会。但它似乎只支持一天一个事件......

# android - 如何让方法在返回之前等待足够准确的位置？

> ID：11686356
> 
> 赞同：0
> 
> 时间：2012-07-27T10:52:18.820
> 
> 标签：android, android-service, android-location

我有一个 LocationHelper 类，我正在设计它来获取用户位置。在创建时，我会指定所需的准确度，以及位置的最新程度。如果它必须是新获得的位置，或者没有足够近的上一个位置，那么我想开始监听来自位置管理器的更新。我的问题是我希望在其中一种方法中发生这种情况，并且在找到足够准确的位置之前，该方法不会返回。在获得所需位置之前，如何阻止该方法返回？我只在后台服务中使用 LocationHelper 类，所以我不在乎它需要很长时间才能返回。我曾想过在返回之前放置一个 while 循环来检查位置是否为空（直到找到足够准确的位置），

如果我的解释不够清楚，代码如下（我的问题是底部的 getCurrentFix），谢谢。

```
package com.s0812532.AutoBagger;

import java.util.Date;

import android.content.Context;
import android.location.Location;
import android.location.LocationListener;
import android.location.LocationManager;
import android.os.Bundle;
import android.os.Handler;

/**
 * Class LocationHelper
 * Class for obtaining the user's location. Capable of obtaining the current
 * position, or the most recent fix available fix without getting a new one, in
 * order to conserve battery power. Will automatically decide whether to use
 * GPS/network based on required accuracy. Must not be called directly from the UI
 * thread or the app will become unresponsive.
 */
public class LocationHelper {

    //
    // Fields
    //

    /**
     * The maximum accuracy, in metres, for the location fix to be considered accurate enough.
     */
    private int accuracyRequired;
    /**
     * The maximum age, in seconds, for the location fix to be considered recent enough.
     */
    private int ageRequired;
    /**
     * The Location obtained by the constructor
     */
    private Location position;
    /**
     * An instance of the system location manager.
     */
    private LocationManager lm;
    /**
     * The context passed in, in order to be able to access system resources like GPS.
     */
    private Context mCtx;
    /**
     * The current time, set by the constructor.
     */
    private long time;
    /**
     * A scaling factor which is applied to the accuracy of any network
     * based location fix to compensate for the inaccuracy of its reporting.
     */
    private static final float NETWORK_ACCURACY_SCALE = 5;

    //
    // Constructors
    //

    /**
     * Constructor which will get a location fix (current or recent) which meets the
     * criteria provided so that it can be acted on.
     * @return
     * @param        age The maximum age, in seconds, for the location fix to be
     * considered recent enough.
     * @param        accuracy The maximum accuracy, in metres, for the location fix to
     * be considered accurate enough.
     */
    public   LocationHelper( Context ctx, int age, int accuracy )
    {
        mCtx = ctx;
        setAgeRequired(age);
        setAccuracyRequired(accuracy);
        //Get the time (in milliseconds since UNIX epoch)
        //TODO - need to test what happens when phone clock is wrong
        Date now = new Date();
        time = now.getTime();
        //TODO - handle when LocationManager returns as null
        lm = (LocationManager) mCtx.getSystemService(Context.LOCATION_SERVICE);
        //Finally, get a fix to satisfy conditions (if a new fix is required then
        //getCurrentFix() will detect this and call getCurrentFix() itself.
        position = getRecentFix();
    }

    //
    // Methods
    //

    //
    // Accessor methods
    //

    /**
     * Set the value of accuracyRequired
     * The maximum accuracy, in metres, for the location fix to be considered accurate
     * enough.
     * @param newVar the new value of accuracyRequired
     */
    private void setAccuracyRequired ( int acc ) {
        //TODO - Test that value is not negative
        accuracyRequired = acc;
    }

    private void setAgeRequired ( int age ) {
        //TODO - Test that the value is not negative
        ageRequired = age;
    }

    //
    // Other methods
    //

    /**
     * Returns the location fix obtained by the constructor.
     * @return       Location
     */
    public Location getLocation(  )
    {
        return position;
    }

    /**
     * Returns the distance between the user's location and a location provided as an
     * argument.
     * @return       float
     * @param        location
     */
    public float getDistance( Location location )
    {
        return position.distanceTo(location);
    }

    /**
     * Obtains the most recent fixes from the GPS and Network location managers, and
     * stores the more accurate of the two if it is accurate/recent enough, otherwise
     * it will call getCurrentFix in order to get an accurate enough fix.
     * @return       Location
     */
    private Location getRecentFix(  )
    {
        //TODO - need to check if location sources are enabled, and deal with it if they aren't

        Location GPSFix = lm.getLastKnownLocation("GPS");
        Location networkFix = lm.getLastKnownLocation("network");
        //Adjust the stated accuracy of the network location fix due to errors in reporting
        networkFix.setAccuracy(networkFix.getAccuracy()/NETWORK_ACCURACY_SCALE);

        if( (GPSFix.getAccuracy() <  accuracyRequired ) & ( time - GPSFix.getTime() < ageRequired ) )
        {
            //Last GPS fix is good enough, so return it.
            return GPSFix;
        }
        else if ( ( networkFix.getAccuracy() < accuracyRequired ) & ( time - networkFix.getTime() < ageRequired ) )
        {
            //Last network fix is good enough, so return it.
            return networkFix; 
        }
        else  {
            //none of the available fixes are good enough, so obtain a new one.
            return getCurrentFix();
        }
    }

    /**
     * Obtains either a GPS or Network based LocationManager, and gets a new fix, if
     * possible. GPS/Network is decided upon based accuracy required.
     * @return       Location
     */
    private Location getCurrentFix(  )
    {
        //TODO - need to put in some sort of timeout (perhaps getting status updates will do)

        LocationListener networkListener = new LocationListener() {
            public void onLocationChanged(Location loc) {
                //check to see if new position is accurate enough
                if (loc.getAccuracy() < accuracyRequired) {
                    position = loc;
                }
                else if (new Date().getTime() - time > 15000 ) { //if it has been looking for network location updates for 15 seconds or more
                    //Get updates from GPS instead
                    lm.requestLocationUpdates("gps", 0, 0, GPSListener);
                }
            }
            public void onProviderDisabled(String provider) {
                // TODO - network location is/has been disabled by user - do something like warn user it is a bad idea

            }
            public void onProviderEnabled(String provider) {
            }
            public void onStatusChanged(String provider, int status, Bundle extras) {
                // TODO Auto-generated method stub

            }
        };

        LocationListener GPSListener = new LocationListener() {
            public void onLocationChanged(Location loc) {
                // TODO - check to see if new position is accurate enough
                if (loc.getAccuracy() < accuracyRequired) {
                    position = loc;
                }
                else if (new Date().getTime() - time > 60000 ) { //if it has been looking for GPS location updates for 60 seconds or more
                    //TODO Report an error getting location
                }
            }
            public void onProviderDisabled(String provider) {
                // TODO - GPS is/has been turned off by user - do something like warn user it is a bad idea

            }
            public void onProviderEnabled(String provider) {
            }
            public void onStatusChanged(String provider, int status, Bundle extras) {
                // TODO Auto-generated method stub

            }
        };

        if(accuracyRequired < 200) {
            //First try network updates, then use GPS if sufficient accuracy not obtained in time
            lm.requestLocationUpdates("network", 0, 0, networkListener);
        }
        else {
            //GPS updates required for accuracy
            lm.requestLocationUpdates("gps", 0, 0, GPSListener);
        }

        while (position == null){
            //Do nothing, this is just to stop the method returning the position until it has been set
            try {
                wait(50);
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
        }
        return position;
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T12:58:45.107

位置侦听器回调是在主线程上进行的，因此您不能阻塞主线程（否则您的侦听器回调将永远不会发生）。如果您的服务与您的活动在同一进程中运行，那么这也是 UI 线程。为了完成这项工作，您需要确保您`LocationHelper`在单独的线程中运行。然后，您可以添加一个`while`循环，在检查新位置之间稍作休息。正如我之前所说，由于位置侦听器回调发生在主线程上，因此不会阻塞。

**当您说这是在后台服务**中运行时，您能否更具体一点。你到底是什么意思？

# jquery - 删除字符时jQuery自动完成不会停止加载数据

> ID：11686358
> 
> 赞同：1
> 
> 时间：2012-07-27T10:52:28.653
> 
> 标签：jquery, asp.net-mvc-3, autocomplete

我在 MVC3 中使用 jQuery 的自动完成和远程数据源。我在控制器中有这样的动作：

```
public ActionResult AutoCompleteSource(string term)
{
    var result = // load some values filtered by term
    return Json(result, JsonRequestBehavior.AllowGet);
} 
```

在cshtml中，我使用这样的自动完成功能：

```
var dataSource = '@Url.Action("AutoCompleteSource", "someControllerName");
$("#inputId").autocomplete(
    {
        minLength: 2,
        source: dataSource
    }); 
```

这有效，因此当用户在输入文本框中更改某些内容时，始终重新加载数据源。

当输入 2 个字符时，它会加载一些东西。在重新加载过程中，用户键入了第三个字符，因此它停止重新加载只有两个字符的动作并重新开始重新加载三个字符。

问题如下：当用户输入两个字符时，它会加载一些东西。在加载过程中，用户删除了一个字符，所以现在它实际上应该停止重新加载数据源，因为只有一个字符，自动完成应该停止工作。但它没有，它继续加载两个字符的术语并显示结果，即使用户删除了一个字符，所以实际上它应该什么都不显示。

您是否也遇到过这种行为，我该怎么办？

# javascript - 无法访问公共 JavaScript 对象 var

> ID：11686359
> 
> 赞同：-1
> 
> 时间：2012-07-27T10:52:41.173
> 
> 标签：javascript, oop

我有一堂课是这样开始的：

```
function event()
{
    this.event_id = null; 
```

然后这一切都被一个 init 函数填充。

在我脚本的另一部分，我无法访问这些变量。

如果我运行此代码：

```
 console.log(my_event);
    console.log(my_event.event_id); 
```

对于第一行，控制台为我提供了填充了 event_id 的事件对象的一个​​很好的表示，但对于第二行，它给了我 null。

这是怎么回事？变量应该是公共的吗？

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T11:25:58.403

当您`console.log`使用非标量值（例如对象）时，仅在您展开以在 chrome 开发人员工具控制台中查看对象属性时才检索其实际状态。< 100 个项目的短数组或类似数组将自动扩展，尽管在这种情况下通常也不会立即检索到状态（我的测试结果对此有所不同，也许我只是看到了一些东西）。

因此，如果您`null`从获取`console.log(my_event.event_id);`，则实际上是在`null`执行时`console.log`。结果`console.log(my_event);`取决于您在控制台中展开记录的对象的时间。如果您发出了修改`event_id`属性的 ajax 请求，并且在您在控制台中展开对象时请求已完成，它将显示更改的值。

此外，javascript 中的每个对象属性都是“公共的”。

# android - Android - 避免从图库中提取的图像的内存泄漏

> ID：11686361
> 
> 赞同：1
> 
> 时间：2012-07-27T10:52:42.390
> 
> 标签：android, android-layout, android-intent, android-emulator, android-widget

我需要让用户从他们的画廊中打开一个特定的相册，并让他们对图像做一些事情。

为了从相册中检索图像，我正在使用：
`Bitmap bitmap = MediaStore.Images.Media.getBitmap(contentResolver, uri).`

一切正常，除了如果相册包含许多图片，它最终会出现`OutOfMemoryException.`
现在，我知道如何根据[Android 指南](http://developer.android.com/training/displaying-bitmaps/index.html)缓解这个问题，但问题是我已经在检索原始位图`getBitmap()`

那么，是否有可能以字节数组格式或输入流格式检索图像，并在将其分配到内存之前将其缩小以避免内存泄漏？（以与 Android 指南建议相同的方式）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T10:59:43.993

您已经确定了一个非常好的解决方案。如果您想跳过`Bitmap`通过将图像拉入 a 的步骤`MediaStore`，请尝试使用[ImageView.setImageUri()](http://developer.android.com/reference/android/widget/ImageView.html#setImageURI%28android.net.Uri%29)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T11:46:33.517

因此，`Uri`在我手中有一张图像，我想检索它`InputStream`并缩小图像，然后再将其分配到内存中以避免`OutOfMemoryException`

**解决方案：**
要从 Uri 中检索 InputStream，您必须调用：

```
InputStream stream = getContentResolver().openInputStream(uri); 
```

然后按照 Android 关于[高效加载位图](http://developer.android.com/training/displaying-bitmaps/load-bitmap.html)的建议，您只需要调用`BitmapFactory.decodeStream()`，并将其`BitmapFactory.Options`作为参数传递。

**完整源代码：**

```
imageView = (ImageView) findViewById(R.id.imageView);

Uri uri = Uri.parse("android.resource://com.testcontentproviders/drawable/"+R.drawable.test_image_large);
Bitmap bitmap=null;
    try {
        InputStream stream = getContentResolver().openInputStream(uri);
        bitmap=decodeSampledBitmapFromStream(stream, 150, 100);
    } catch (FileNotFoundException e) {
        e.printStackTrace();
    }

imageView.setImageBitmap(bitmap); 
```

辅助方法：

```
public static Bitmap decodeSampledBitmapFromStream(InputStream stream,
            int reqWidth, int reqHeight) {

    // First decode with inJustDecodeBounds=true to check dimensions
    final BitmapFactory.Options options = new BitmapFactory.Options();
    options.inJustDecodeBounds = true;
    BitmapFactory.decodeStream(stream, null, options);

    // Calculate inSampleSize
    options.inSampleSize = calculateInSampleSize(options, reqWidth,
                reqHeight);

    // Decode bitmap with inSampleSize set
    options.inJustDecodeBounds = false;
    return BitmapFactory.decodeStream(stream, null, options);
}

public static int calculateInSampleSize(BitmapFactory.Options options,
            int reqWidth, int reqHeight) {
    // Raw height and width of image
    final int height = options.outHeight;
    final int width = options.outWidth;
    int inSampleSize = 1;

    if (height > reqHeight || width > reqWidth) {
        if (width > height) {
            inSampleSize = Math.round((float) height / (float) reqHeight);
        } else {
            inSampleSize = Math.round((float) width / (float) reqWidth);
        }
    }
    return inSampleSize;
} 
```

# android - 恢复出厂设置 Android x86

> ID：11686364
> 
> 赞同：4
> 
> 时间：2012-07-27T10:52:54.927
> 
> 标签：android, android-x86

我已经在 VirtualBox 中安装了 Android x86，但是如何执行恢复出厂设置？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-10-01T06:54:35.443

以调试模式启动。在第一个控制台输入`exit`命令。（现在将挂载数据分区）然后您将获得另一个结果更高的控制台。运行这个命令：

```
cd data
rm -R *
exit 
```

并且您已经擦除了包括内部存储在内的数据分区。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T11:25:56.950

如何将您的“设备”启动到恢复模式，您可以在其中擦除数据？我假设可以使用以下命令：

```
adb shell reboot recovery 
```

也看到[这个](https://stackoverflow.com/questions/10817721/wipe-data-factory-reset-through-adb)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-27T10:54:45.697

转到主屏幕，按菜单按钮，然后浏览：

**设置->隐私->恢复出厂设置**

# javascript - 在另一个页面中从 DIV 获取内容

> ID：11686365
> 
> 赞同：2
> 
> 时间：2012-07-27T10:53:08.413
> 
> 标签：javascript, html, button

好的......现在：我在一个页面上，我的书签上有这个按钮......

```
<a href='javascript:var n=document.getElementById("get_nuno").textContent;window.open("http://pgcc.datasource.pt/simples.php?vals="+encodeURIComponent(n), "mywindow", "location=1,status=1,scrollbars=1,  width=100,height=100");'
   onclick="return false;"
style="text-decoration:none"
> 
```

它从我当前的位置加载...

我想做的是这样的......

```
[anotherpage].getElementbyId('get_nuno').textcontent 
```

然后让代码相同..，

# android - 显示隐藏键盘在 android phonegap 中无法正常工作

> ID：11686368
> 
> 赞同：1
> 
> 时间：2012-07-27T10:53:28.577
> 
> 标签：android, cordova

我按照此链接通过使用 [Simon mac donald Defination][1] 使用键盘事件在该事件中，我在键盘隐藏时显示我的页脚并在键盘显示时隐藏我的页脚。当单击**字典**时，我的键盘**显示**但事件是去键盘**隐藏**功能（所以我的页脚显示）..我不知道为什么..

我附上了我的代码和设计。请解决这个问题

```
 <script type="text/javascript">
    $(document).ready(function () 
    {
        document.addEventListener("hidekeyboard", onHide, false);
        document.addEventListener("showkeyboard", onShow, false);

    });
    function onHide() 
    {
        $("#footer").show();
    }

    function onShow() 
    {
        $("#footer").hide();
    }
    </script>
<style type="text/css">

#footer {
    position:absolute;
    bottom:0; left:0;
    width:100%;
    height:7%;
    background-color:#00458D;
    padding:0;
    border-width:3px;
    padding-top:3%;
    padding-bottom:2%;
    padding-right:0px;
    padding-left:0px;
    background-color:#00458D;
}

#content {
    position:absolute; bottom:0;
    top:0;
    width:100%;
    overflow:auto;
}
</style>
  </head>
 <body >
    <div id="content">

        <input type="text" style="width=70%">
            <br/>
            <br/>

        <div id="footer" align="center">
            <table width=100%>
                <input type="image" src="../images/Home.PNG" style="width:23%" onClick="home()"/>
                <input type="image" src="../images/messages-menu.jpg" style="width:23%" onClick="inbox()"/>
                <input type="image" src="../images/settings-menu.jpg" style="width:23%" onClick="settings()"/>
                <input type="image" src="../images/close-menu.png" style="width:23%" onClick="callServiceFunction()"/>
            </table>
        </div>
    </div>
  </body>
</html> 
```

图片

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T12:04:38.430

移除该`.ready()`函数并在 deviceready 中添加监听器

```
<style type="text/css">

#footer {
    position:absolute;
    bottom:0; left:0;
    width:100%;
    height:7%;
    background-color:#00458D;
    padding:0;
    border-width:3px;
    padding-top:3%;
    padding-bottom:2%;
    padding-right:0px;
    padding-left:0px;
    background-color:#00458D;
}

#content {
    position:absolute; bottom:0;
    top:0;
    width:100%;
    overflow:auto;
}
</style>
<script type="text/javascript">
document.addEventListener("deviceready",onDeviceReady,false);

    function onDeviceReady () {
        document.addEventListener("hidekeyboard", onHide, false);
        document.addEventListener("showkeyboard", onShow, false);

    }
    function onHide() 
    {
        $("#footer").show();
    }

    function onShow() 
    {
        $("#footer").hide();
    }
    </script>

  </head>
 <body >
    <div id="content">

        <input type="text" style="width=70%">
            <br/>
            <br/>

        <div id="footer" align="center">
            <table width=100%>
                <input type="image" src="../images/Home.PNG" style="width:23%" onClick="home()"/>
                <input type="image" src="../images/messages-menu.jpg" style="width:23%" onClick="inbox()"/>
                <input type="image" src="../images/settings-menu.jpg" style="width:23%" onClick="settings()"/>
                <input type="image" src="../images/close-menu.png" style="width:23%" onClick="callServiceFunction()"/>
            </table>
        </div>
    </div>
  </body>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-19T05:25:23.680

在 OndeviceReady() 中试一下

```
 $(document).ready(function () 
 {
      document.addEventListener("deviceready", onDeviceReady, false);
 }
 function onDeviceReady()
 {

     document.addEventListener("hidekeyboard", onHide, false);
     document.addEventListener("showkeyboard", onShow, false);

 }
 function onHide() 
 {
       $("#footer").show();
 }
 function onShow() 
 {
       $("#footer").hide();
 } 
```

# facebook - Facebook 应用程序设置需要用户和朋友权限电子邮件，但第一次使用应用程序时不需要电子邮件访问权限

> ID：11686372
> 
> 赞同：0
> 
> 时间：2012-07-27T10:53:50.370
> 
> 标签：facebook, email

我已经设置了一个与我们的应用程序一起使用的 facebook 应用程序。我们需要用户的电子邮件地址，所以我在应用中心将其设置为电子邮件（用户和朋友权限）。然而，当我们的网络应用程序第一次指向 facebook 应用程序时，我们会看到所有常见的对话框，但没有说明电子邮件地址。最终结果是我无法访问用户的电子邮件地址。

希望任何人都可以帮助或指出我正确的方向

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T11:08:22.000

“当我们的网络应用程序第一次指向 facebook 应用程序时，我们会看到所有常见的对话框” - 您是说用户正在登陆您的网站，并且您正在使用 JS SDK 中的 FB.login() 方法还是将用户重定向到 oauth 对话框？

如果是这样，您需要在调用身份验证时指定用户需要的权限。

1.  将“范围”参数中所需的权限传递给 FB.login()：[https ://developers.facebook.com/docs/reference/javascript/FB.login/](https://developers.facebook.com/docs/reference/javascript/FB.login/)

2.  重定向到 oauth 对话框时，在范围参数中指定所需的权限：[https ://developers.facebook.com/docs/authentication/client-side/#no-jssdk](https://developers.facebook.com/docs/authentication/client-side/#no-jssdk)

您在 App Center 中提供的权限设置仅适用于从您的应用详细信息页面安装您的应用的用户。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T11:57:17.267

在用户权限中添加“电子邮件”..

使用此用户和朋友权限：[https ://developers.facebook.com/apps/APPID/auth](https://developers.facebook.com/apps/APPID/auth)

# jqgrid - 按单元格值突出显示 jqgrid 行

> ID：11686374
> 
> 赞同：2
> 
> 时间：2012-07-27T10:54:05.610
> 
> 标签：jqgrid, selection, highlight

我有一个 jqGrid 显示来自服务器的一些数据（php 查询，json 结果）。

是否可以在知道存储在列单元格中的值的情况下获取特定行的 rowid 并使用 setSelection 突出显示该行？

我试着用一个例子来更好地解释：我的应用程序的用户使用表单从下拉菜单中选择一个值。然后，如果此值在网格中，则包含它的行将突出显示（如果可能，网格会自行移动以在网格窗口的可见部分显示突出显示的行）

一些注意事项：网格分页器已配置，但所有行都在第一页中......所以分页不会成为问题

突出显示/选择一次只作用于一行，没有多选（目前）

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T11:30:47.560

我认为这个 JavaScript 函数将为您完成工作：

```
function check(){
    var data=$('#dropDown option:selected').val();

    var allRowsOnCurrentPage = $('#grid').jqGrid('getDataIDs');
    //suppose the column you want tho check in dropdown and in grid is "Name"

    for( var i=0;i<allRowsOnCurrentPage.length;i++){
       var Name=getCellValue(allRowsOnCurrentPage[i],'Name');
       if(Name===data){
            jQuery("#grid").setSelection(allRowsOnCurrentPage[i], true);
       }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T14:35:51.963

谢谢！我不得不编辑一些你的函数以使其工作......这里的工作代码：

```
function check() {

   var data=$('#dropDown option:selected').val();
   var allRowsOnCurrentPage = $('#grid').jqGrid('getDataIDs');
   for( var i=0;i<allRowsOnCurrentPage.length;i++){
       var Name = $('#grid').getCell(allRowsOnCurrentPage[i], 'Name');
       if(Name===data){
           jQuery("#cetacei_grid").setSelection(allRowsOnCurrentPage[i], true);
       }
} 
```

# python - 阅读后不关闭文件有什么缺点吗？

> ID：11686375
> 
> 赞同：4
> 
> 时间：2012-07-27T10:54:18.233
> 
> 标签：python

我经常在阅读后不关闭文件

```
for line in open(FileName):
    # do something 
```

我还在同一个程序中再次重新打开该文件。

```
for line in open(FileName):
    # do something else 
```

我的问题是这种方法是否有任何缺点？我看过声称该文件应该打开的帖子`with`

```
with open(FileName) as fp: 
```

但是这种方法有什么好处呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-27T11:03:26.600

在某些情况下，您可能会在没有遇到不利影响的情况下不关闭文件而侥幸逃脱。CPython（最流行的 Python 实现）将在使用 循环后立即关闭文件`for line in open("filename"):`，前提是不存在对该文件的进一步引用。在其他 Python 实现中，关闭文件可能会延迟，但最终会被关闭。

不过有几个问题：

1.  有时对文件的隐藏引用仍然存在。如果在函数中抛出异常，则与异常关联的回溯包含对函数执行框架的引用，因此所有局部变量继续存在——即使在 CPython 中，这可能会使文件打开的时间比预期的要长。

2.  打开许多文件时，您可能会用完文件描述符，因为您无法控制它们再次关闭的时间。

3.  Python 3.2 或更高版本将为每个未关闭的文件引发一个`ResourceWarning`（可以禁用此警告，但无论如何）。

总之，这根本不值得麻烦。始终使用`with`，忘记这些问题。无论如何，在编程时要记住足够的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T10:59:01.697

重新使用`with`：

*使用打开*/管理文件的主要优点`with`是，当您退出与. 如果遇到*异常*，文件也会关闭。*`with`*

 **不关闭文件是不整洁的编程。

请注意，特别是在您正在*写入*的文件的情况下，您可能无法在输出文件中获得您期望的所有数据，因为未关闭的文件可能没有刷新其所有缓冲区（这作为关闭文件的一部分自动发生)，导致只有部分输出文件。

因此，虽然您不必使用`with`它来打开文件，但它确实使管理它们变得更容易，并且还可以关闭您的文件，即您不必担心的一件事，这就是推荐的原因。**

# mysql - 如何在tinyint中存储大于200的值

> ID：11686379
> 
> 赞同：2
> 
> 时间：2012-07-27T10:54:30.987
> 
> 标签：mysql, sql

当我尝试在我的`tinyInt`数据类型列中存储 200 时，它会自动将其转换为 127。是否无法将它们存储在我的数据库中？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-27T10:56:38.830

`TINYINT`使用单个字节来保存值，这为您提供 -128 到 127 的有符号字段，以及 0 到 255 的无符号字段。所以是的，如果你使该字段无符号，那么你最多可以存储 255 个。

# css - 直接通过 id 而不是引用 css 类来设置元素样式的不良 css 做法？

> ID：11686380
> 
> 赞同：2
> 
> 时间：2012-07-27T10:54:37.593
> 
> 标签：css

使用元素的 id 设置元素的样式是不好的做法，还是应该设置引用适当 css 的每个元素的样式？

```
<div id="test">
</div> 
```

相对 ：

```
<div id="test" class="testClass">
</div> 
```

* * *

```
#test{
color:blue;
}

.testClass {
color:blue
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-27T10:59:59.077

这不是一个坏或好的做法。选择器的用途`id`不同于`class`.

如果您打算只为这一个元素设置样式而不在其他任何地方重复使用样式 -`id`您可以选择。如果你需要很多相似的`div`-s 来拥有相同的风格 - 使用`class`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-27T11:01:01.207

**id vs 类**

[**ID**](https://developer.mozilla.org/en/SVG/Attribute/class) `#`

> ID 在文档中必须是唯一的，通常用于使用 document.getElementById 检索元素。
> 
> 在某些文档（特别是 HTML、XUL 和 SVG）中，可以将元素的 id 指定为元素的属性，如下所示： .
> 
> 但是，如果没有在 DOCTYPE 中正确指定 id 属性的类型，就不能在自定义 XML 文档中使用此属性。
> 
> id 的其他常见用法包括在使用 CSS 设置文档样式时使用元素的 ID 作为选择器。
> 
> 请注意，ID 区分大小写，但您不应创建仅大小写不同的 ID（请参阅类和 id 名称中的区分大小写）。

[**班级**](https://developer.mozilla.org/en/SVG/Attribute/class) `.`

> 将一个类名或一组类名分配给一个元素。您可以为任意数量的元素分配相同的类名称或名称。如果您指定多个类名，它们必须用空格字符分隔。
> 
> 元素的类名有两个关键作用：
> 
> 作为样式表选择器，当作者想要将样式信息分配给一组元素时使用。供浏览器一般使用。该类可用于使用 CSS 设置 SVG 内容的样式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-27T10:56:30.493

ID 本质上与类相同，ID 稍快一些，但只能用于一个元素，而类可以用于多个元素。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-27T10:58:01.847

如果您希望多个元素具有蓝色，那么您需要使用一个类，否则一个 id 就可以了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-27T11:00:42.970

ID 是唯一的。您的页面上应该只有一个具有该 ID 的元素。在造型方面，我不认为这是不好的做法，但 ID 在特异性方面获胜。基本上，选择器越具体，当涉及到冲突样式时，它就会越优先，因此应用于 ID 的任何样式都会覆盖任何其他样式。

```
p has a specificity of 1 (1 HTML selector)
div p has a specificity of 2 (2 HTML selectors; 1+1)
.tree has a specificity of 10 (1 class selector)
div p.tree has a specificity of 12 (2 HTML selectors and a class selector; 1+1+10)
#baobab has a specificity of 100 (1 id selector)
body #content .alternative p has a specificity of 112 (HTML selector, id selector, class selector, HTML selector; 1+100+10+1) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-27T11:04:29.710

这不是一个坏习惯，但这取决于您的用途。

如果你为页面中的每个元素设置一些规则，很快就无法理解发生了什么，你的 css 变成了一个很长的文件。

定义一个类允许多个元素使用同一组规则，因此您应该设计您的页面以允许这样的行为。

通常，您应该混合策略，例如，您可以使用 id 为页面的一些“重要”元素设置样式，例如页眉、页脚、正文等，而其他部分或组件应对齐使用类。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-07-27T11:07:33.920

我不认为，如果您在样式上使用 ID 或 Class 会产生很大的不同。类选择器用于指定一组元素的样式。与 id 选择器不同，类选择器最常用于多个元素。

有关更多参考，您可以查看此链接

> [http://css-tricks.com/the-difference-between-id-and-class/](http://css-tricks.com/the-difference-between-id-and-class/)

在 JavaScript 中，ID 起着重要的作用。如果您使用 ID 搜索任何 DOM 元素，那么搜索会更快，因为 JavaScript Parser 返回相应页面上具有该 ID 的第一个元素的值。而如果你使用 Class 然后 JS 搜索整个页面并收集该类的所有元素。因为这个搜索变得有点慢。

# c# - C# - 如何验证日期时间（将“20120713”或“120713”改为“13.07.2012”）

> ID：11686382
> 
> 赞同：0
> 
> 时间：2012-07-27T10:54:40.990
> 
> 标签：c#, validation, datetime, date, formatting

我正在尝试从 EDI-Order （“20120713”/YYYYMMDD 或“120713”/YYMMDD 甚至其他没有点的日期，所以只是数字）解析一个日期时间到一个有效的日期，如 C# 中的“DD.MM.YYY”。

我不知道不同的 EDI 订单中有多少不同的日期格式，所以我正在寻找一个可以应用于所有这些的解决方案。

谢谢大家。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T11:00:43.693

您应该对使用 的重载感兴趣`ParseExact`，您可以将多种格式作为数组传递，它会尝试根据它们解析它。（如果您可以控制格式并打算在该过程中使用一种格式，那就太好了）

```
DateTime start = DateTime.ParseExact("20120713",
                    new[] { "yyyyMMdd", "yyMMdd" },
                    CultureInfo.InvariantCulture,
                    DateTimeStyles.None);
DateTime end = DateTime.ParseExact("120713",
                    new[] { "yyyyMMdd", "yyMMdd" },
                    CultureInfo.InvariantCulture,
                    DateTimeStyles.None); 
```

对于您的输出，您可以执行`start.ToString("dd.MM.yyyy")`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T11:00:35.657

这应该适用于多种格式

```
DateTime Result = new DateTime();
string[] dateFormats = new string[]{ "YYYYMMDD", "YYMMDD", /*other formats you might need*/ };

if (dateFormats.Any(format => DateTime.TryParseExact("yourDate", format, System.Globalization.CultureInfo.InvariantCulture, System.Globalization.DateTimeStyles.None, out Result)))
{ /* Result contains the parsed DateTime and you can use it*/ }
else 
{ /* DateTime couldn't be parsed for any format you specified */ } 
```

# c# - sitemapdatasource 不调用 OnDataBinding？

> ID：11686386
> 
> 赞同：1
> 
> 时间：2012-07-27T10:55:03.943
> 
> 标签：c#, asp.net, data-binding, sitemapprovider

我想过滤`web.sitemap`使用`OnDataBinding`事件的条目，但它不执行。我想要一些功能，它允许我验证用户的角色是否可以访问特定的功能。

我创建了带有函数列表和链接表的表来构建权限。我将允许管理员添加新角色并为他们提供一组允许的功能，而不是使用看起来不够灵活的 IsInRole 来满足我的需求。

所以，我添加了以下内容：

```
<asp:sitemapdatasource ID="SiteMapMenuSrc" runat="server" ShowStartingNode="false" OnDataBinding="MainMenu_DataBinding" SiteMapProvider="SiteMap1"></asp:sitemapdatasource> 
```

SiteMap 是 web.config 条目的位置：

```
<add name="SiteMap1" type="System.Web.XmlSiteMapProvider" siteMapFile="~/Web.sitemap"/> 
```

看来，那`MainMenu_DataBinding`不叫。我没有找到任何合适的解释。我的代码有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T11:06:35.093

那是因为`SiteMapDatasource`它只是一个**数据源控件**，它自己什么都不做

您实际上必须使用它，例如：

```
 <asp:Menu ID="Menu1" DataSourceID="SiteMapMenuSrc" runat="server" 
        Orientation="Horizontal" RenderingMode="Table" 
        StaticSubMenuIndent="16px">
        <StaticSelectedStyle Font-Bold="True" />
    </asp:Menu> 
```

# mysql - 使用学说按索引搜索

> ID：11686387
> 
> 赞同：0
> 
> 时间：2012-07-27T10:55:09.030
> 
> 标签：mysql, database, symfony, doctrine

我对数据库中的索引不太了解，所以我的问题可能很愚蠢，但是......我有个人参数（姓名，姓氏，组织，工作等），现在我正在`prePersist()`方法中创建索引字符串，比如这个：

```
$this->search_index = $this->name.' '.$this->surname.' '.$this->orgnaization; 
```

使用“”进一步搜索分解字符串，并使用`LIKE` search_index 比较每个部分。

但这看起来很疯狂。最佳做法是什么？ps我的示例代码：

```
$queryBuilder = $this->createQueryBuilder('s');
foreach(explode(" ", $query) as $key=>$part){
     $queryBuilder->orWhere('s.searchindex LIKE:name'.$key)
          ->setParameter('name'.$key, $part);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T11:19:36.097

如果我理解你是正确的，我想你正在寻找这样的东西：

```
$collection = Doctrine::getTable('User')->createQuery('u');
    ->where('column_name LIKE ?', $this->name)
    ->orWhere('column_surname LIKE ?', $this->surname)
    ->orWhere('column_organization LIKE ?', $this->organization)
    ->execute(); 
```

# jquery - 从 JSP 方法获取 json 数据到 JS

> ID：11686389
> 
> 赞同：0
> 
> 时间：2012-07-27T10:55:23.193
> 
> 标签：jquery, ajax, json, jsp

我有一个 JSP 文件，我在其中声明了一个返回 json 的方法。现在我想使用 ajax 在 js 文件中获取这个 json。但是当我使用ajax调用它返回整个jsp页面而不是json数据这里是我的jsp

```
<%-- 
    Document   : index
    Created on : Jul 26, 2012, 3:49:33 PM
    Author     : tagit
--%>
<%@page import="net.sf.json.JSONObject"%>
<%@page import="my.mychartData"%>
<%@page import="my.mychartInfo"%>
<%@page import="my.mychart"%>

<%@page contentType="text/html" pageEncoding="UTF-8"%>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">

<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
         <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
         <script type="text/javascript" language="javascript">
         </script>
    </head>
    <body>
 <%!
 Object showchart()
 {
 mychartInfo c1 =new mychartInfo();
 mychartInfo c2=new mychartInfo();
 mychartInfo c3=new mychartInfo();
 mychartInfo c4=new mychartInfo();
 mychartInfo c5=new mychartInfo();
 mychartInfo c6=new mychartInfo();
mychartData c7=new mychartData();

c1.setColor("pink");
c1.setDataDes("Gas data");
c1.setDataVal("20");
c1.setName("Gas");
c2.setColor("green");
c2.setDataDes("cash data");
c2.setDataVal("30");
c2.setName("Cash");
c3.setColor("blue");
c3.setDataDes("Resturent data");
c3.setDataVal("38");
c3.setName("Resturent");
c4.setColor("blue");
c4.setDataDes("boat data");
c4.setDataVal("60");
c4.setName("Boat");
c5.setColor("black");
c5.setDataDes("Movies data");
c5.setDataVal("40");
c5.setName("Movies");
c6.setColor("yello");
c6.setDataDes("Shopping data");
c6.setDataVal("50");
c6.setName("Shopping");
c7.setDonut("30");
c7.setFont("afdafafafafaf");
c7.setGradientPos("leftsdgd");
mychart chart1=new mychart();

Object obj =chart1.addChart(c1, c2, c3, c4, c5, c6, c7);
return obj ;
 }
%>

     <%
     out.println( showchart());
     %>
     %>
    </body>
</html> 
```

这是我的ajax函数

```
 $.ajax({
        type: "get"
       ,dataType: "json"
       , url: "http://localhost:8080/Webcharts/index.jsp;"
       ,success: function(json){
       alert("here"+json);

}
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T11:34:16.403

不要在 JSP 上编写任何 HTML 代码。设置内容类型。

您需要将对象序列化为 JSON。它不会自动完成。

恕我直言，最好使用 servlet。

# fonts - 位图字体 OCR 库

> ID：11686390
> 
> 赞同：3
> 
> 时间：2012-07-27T10:55:33.623
> 
> 标签：fonts, bitmap, ocr

我正在寻找一个简单的位图字体 OCR 库。我正在尝试识别位图中的文本，黑白（或两种颜色，但没有抗锯齿）。我一次只需要一种字体（我知道位图的哪一部分具有哪种字体）。它应该非常简单，并且不必容错，因为位图从未打印或扫描过——它只是屏幕抓取。它应该能够处理细微的差异，例如`l`and`1`或`O`and `0`。

这看起来很简单，我可能会自己写，但我认为以前应该做过这样的事情。是否有一个库（首选python或C（++））？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2020-04-04T13:36:02.397

我创建了一个这样做的项目：

[https://github.com/Cyber​​Shadow/monocre](https://github.com/CyberShadow/monocre)

它可用作命令行程序或库。

# optimization - 目标函数只能近似计算时的优化

> ID：11686393
> 
> 赞同：1
> 
> 时间：2012-07-27T10:55:40.283
> 
> 标签：optimization, graph-algorithm, mathematical-optimization, numerical-methods

我有一些图形算法，它们依赖于中等数量的参数（比如 2-6 个），但它们并不总是能成功找到他们想要的东西（他们想要“足够好”的解决方案来解决已知困难的问题，比如`mincut/maxflow`）。我还有一个非常大的图表系列，我想在上面使用算法。

我当前的目标是找到给定算法最常成功的参数值。不幸的是，我知道如何计算“成功”的唯一方法是从我的大家庭中获取图表并实际运行算法。这有两个问题：它的计算量很大，而且它只给出了我的真实目标函数的近似值，即算法成功的图的真实百分比。

第一个不是世界末日；Nelder-Mead 或类似的东西可以工作。该算法的变体是否适用于我的情况？我预计成功概率远非 0 或 1。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T13:25:48.500

（对不起，换了电脑，没有编辑能力 - 这是原始海报。在回应Shahbaz时，我犯了一个错误。我的意思是说最稀疏的剪辑，这是NP完整的。我正在处理的实际问题on 是，通常情况下，相当混乱。我真的只是想说没有干净的解决方案的希望，但最终却意外地说了相反的意思。

# javascript - 绘制后获取Html5画布上下文数据

> ID：11686395
> 
> 赞同：-1
> 
> 时间：2012-07-27T10:56:06.267
> 
> 标签：javascript, html, html5-canvas

我想在绘制到画布上之前获取上下文信息。我正在使用多个画布的公共变量来绘制图像。因此，在将图像绘制到画布之前。我想得到以前绘图的数据！

IE，

我想获得绘图的 x、y 坐标和宽度、高度！

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T15:03:12.027

这是做不到的。画完这些东西你是拿不到的！

# java - 连接字符串中的条件运算符

> ID：11686398
> 
> 赞同：14
> 
> 时间：2012-07-27T10:56:21.967
> 
> 标签：java

我想知道为什么下面的程序会抛出 NPE

```
public static void main(String[] args) {
    Integer testInteger = null;
    String test = "test" + testInteger == null ? "(null)" : testInteger.toString();
} 
```

而这

```
public static void main(String[] args) {
    Integer testInteger = null;
    String test = "test" + (testInteger == null ? "(null)" : testInteger.toString());
} 
```

没有。这当然是一个优先问题，我很好奇串联是如何在内部工作的。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-07-27T10:58:25.870

这是理解[运算符优先级](http://en.wikipedia.org/wiki/Order_of_operations)重要性的一个例子。

您需要括号，否则解释如下：

```
String test = ("test" + testInteger) == null ? "(null)" : testInteger.toString(); 
```

有关运算符及其优先级的列表，请参见[此处。](http://bmanolov.free.fr/javaoperators.php)另请注意该页面顶部的警告：

> 注意：即使存在混淆的可能性，也要使用显式括号。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-27T10:58:55.563

没有括号，它可以有效地做到这一点： `String test = ("test" + testInteger) == null ? "(null)" : testInteger.toString();` 这会导致 NPE。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-27T10:59:04.467

因为它被评估为`"test" + testInteger`（它是`"testnull"`，因此不是 null），这意味着您的`testInteger == null`测试将永远不会返回 true。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-10-16T06:22:18.643

我相信您需要添加括号。这是一个产生“ [http://localhost:8080/catalog/rest](http://localhost:8080/catalog/rest) ”的工作示例

```
public static String getServiceBaseURL(String protocol, int port, String hostUrl, String baseUrl) {
    return protocol + "://" + hostUrl + ((port == 80 || port == 443) ? "" : ":" + port) + baseUrl;
} 
```

# magento - 如何从 Magento 1.7.0 升级到 Magento 1.7.2？

> ID：11686408
> 
> 赞同：0
> 
> 时间：2012-07-27T10:57:25.717
> 
> 标签：magento

我必须将 Magento 1.7.0 中的 Magento 项目升级到 1.7.2。如何升级并保留所有数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T11:00:31.020

您可以使用 MagentoConnect Manager 将 Magento 升级到 1.7.2。Magento 升级的标准流程如下：

备份您的文件

```
tar -cvvzf your_site_directory.tar.gz your_site_directory/ 2>error.log 
```

备份您的数据库

```
mysqldump -u THIS_IS_YOUR_USERNAME_FOR_DB -h localhost 
    -pTHIS_IS_YOUR_USERNAME_FOR_DB my_database_name | 
    gzip -9 > my_database_name.sql.gz 
```

将这些文件复制到新位置

将数据库导入新创建的数据库：

a) 提取 my_database_name.sql.gz b)`mysql –verbose –user=THIS_IS_YOUR_USERNAME –password=THIS_IS_YOUR_PASSWORD newly_created_db < my_database_name.sql`

提取文件`tar -xvvzf your_site_directory.tar.gz`

编辑数据库表 core_config_data 并设置您站点的新安全/不安全 URL

从管理员禁用缓存。

删除位于此处的缓存和会话目录：

```
/var/cache
/var/session
rm /your_path_to/var/session -R
rm /your_path_to/var/cache -R 
```

执行位于 /downloader/pearlib 目录中的“clean” bash 脚本 a) 运行`chmod +x clean` 以能够执行此脚本 b) ./clean 以执行脚本

从您的 Magento 管理员转到 Magento 连接管理器

粘贴此扩展以升级 Magento：`magento-core/Mage_All_Latest`

有关更多信息，您可以访问： http: [//www.magentocommerce.com/wiki/1_-_installation_and_configuration/upgrading_magento#magento_upgrade_guide_for_1.3.x_1.4.x_1.5.x_1.6.x_and_1.7.x](http://www.magentocommerce.com/wiki/1_-_installation_and_configuration/upgrading_magento#magento_upgrade_guide_for_1.3.x_1.4.x_1.5.x_1.6.x_and_1.7.x)

# delphi - 如何在 Tspeedbutton 处于禁用状态时显示位图图像

> ID：11686409
> 
> 赞同：5
> 
> 时间：2012-07-27T10:57:27.093
> 
> 标签：delphi, delphi-7

我在选项卡更改过程中动态创建速度按钮，我想禁用速度按钮，当它被禁用时，它不显示加载的图像。当速度按钮处于禁用状态时如何在速度按钮上显示图像。我正在使用代码 SpeedButton,SpeedButton.Glyph.LoadFromFile(Path) AND USING SpeedButton.numGlyphs =1

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-30T22:15:47.497

Glyph 中使用的图像最多可以包含 4 个图像，一个用于 SpeedButton 的每个状态（向上、向下、禁用、选中）。

这些图像在用于 SpeedButton 的 Glyph 属性的单个位图文件中彼此相邻放置。使用 NumGlyphs 来指示在 Glyph 中使用了多少图像（例如，您可以仅使用 2 个或仅 3 个图像）。

阅读有关 SpeedButton Glyph 属性的文档。

# c++ - 为什么析构函数不修改返回的变量

> ID：11686410
> 
> 赞同：2
> 
> 时间：2012-07-27T10:57:30.107
> 
> 标签：c++

下面的代码使用了一个析构函数来修改`i`. 当析构函数运行时，`2`应该被存储到返回`i`时`thing()`我们观察到`-1`的。

```
#include <stdio.h>

class Destruct {
    int &i;
public:
    Destruct(int &_i) : i(_i) {}
    ~Destruct() {
        i = 2;
    }
};

int thing() {
    int i = -1;
    Destruct d(i);
    return i;
}

int main() {
    printf("i: %d\n", thing());
} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-27T11:00:00.643

```
int thing() {
    int i = -1;
    Destruct d(i);
    return i;
} 
```

函数返回时对象`d`被破坏，堆栈清理开始！在调用析构函数时，返回的值已经被复制到返回寄存器。

你想看到的，可以通过这样做看到：

```
int thing() {
    int i = -1;
    {
        Destruct d(i);  //put it inside braces!
    }
    return i;
} 
```

* * *

从您的评论中：

> 这就是它的工作原理，反汇编代码表明情况就是这样。我很好奇为什么。

逻辑很简单，可以这样证明：假设析构函数在`i`被复制到返回寄存器之前被调用，那么为什么选择性地销毁`d`而不是`i`还？毕竟两者都是局部变量。因此，如果`d`被破坏，那么在将其值复制到返回寄存器**之前**`i`也应该被破坏，**但这没有意义。**

 ****正如@Luc Touraille 所问（在评论中）：*“如果你的函数返回了`d`怎么办？你确定你想在传递给调用者**之前**`d`被破坏吗？”*

 *** * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-27T10:59:46.363

因为析构函数是在对语句中的 i 进行复制之后执行的`return i`。

如果您通过使 in 事物全局化并通过引用返回来更改程序，`i`您将看到您想要的。

```
#include <stdio.h>

int i = -1;
class Destruct {
    int &i;
public:
    Destruct(int &_i) : i(_i) {}
    ~Destruct() {
        i = 2;
    }
};

int& thing() {
    Destruct d(i);
    return i;
}

int main() {
    printf("i: %d\n", thing());
} 
```******

# jquery - '$("#foo")' 和 'jQuery("#foo")' 之间的区别

> ID：11686420
> 
> 赞同：2
> 
> 时间：2012-07-27T10:58:17.840
> 
> 标签：jquery

> **可能重复：**
> [jQuery 选择器 jQuery(“element”) 和 $(“element”) 有什么区别？](https://stackoverflow.com/questions/6608002/jquery-selecter-whats-difference-between-jqueryelement-and-element)

只是有点好奇。。

为什么有时我看到它写成`$("#SomeElementId")`有时又写成`jQuery("#SomeElementId")`？确切的区别是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-27T11:00:08.060

`$`是`jQuery`命名空间的别名。只是打字更快。当可能与也使用`$`.

jQuery 总是声明`jQuery`但只会声明`$`除非`jQuery.noConflict()`被调用。

无论哪种方式，一种常见的模式是`$`通过立即执行的函数在闭包中作为局部变量进行引用：

```
(function($) {
    //all your code here, which can reference $
})(jQuery); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-27T11:04:29.507

[在 iife 中理解 $ vs. jQuery 而不是 $](https://stackoverflow.com/questions/11403266/understanding-vs-jquery-in-iife-instead-of/11403349#11403349)

**请注意**，同样的问题多次被问到`:)`不同的措辞，但都意味着同样的事情，所以我认为这个问题很快就会结束。

许多 JavaScript 库使用 $ 作为函数或变量名，就像 jQuery 一样。在 jQuery 的例子中，$ 只是 jQuery 的别名，所以所有功能都可以在不使用 $ 的情况下使用。如果我们需要在 jQuery 旁边使用另一个 JavaScript 库，我们可以通过调用 $.noConflict() 将 $ 的控制权返回给另一个库：http: [//api.jquery.com/jQuery.noConflict/](http://api.jquery.com/jQuery.noConflict/)

在“无冲突”模式下，$ 快捷方式不可用，使用较长的 jQuery。例如：

```
$(document).ready(function(){
     $(#somefunction) ...
}); 
```

变成：

```
jQuery(document).ready(function(){
    jQuery(#somefunction) ...
}); 
```

为了使用 $ 的默认 jQuery 快捷方式，您可以在代码周围使用以下包装器：

```
jQuery(document).ready(function($) {
    // $() will work as an alias for jQuery() inside of this function
}); 
```

该包装器将导致您的代码在页面完成加载时执行，并且 $ 将用于调用 jQuery。如果出于某种原因，您希望您的代码立即执行（而不是等待 DOM 就绪事件），那么您可以使用此包装器方法：

```
(function($) {
    // $() will work as an alias for jQuery() inside of this function
})(jQuery); 
```

**好读：** [http ://codex.wordpress.org/Function_Reference/wp_enqueue_script#jQuery_noConflict_wrappers](http://codex.wordpress.org/Function_Reference/wp_enqueue_script#jQuery_noConflict_wrappers)

**进一步，如果你热衷：**

[jQuery 中的 $ 是什么意思？](https://stackoverflow.com/questions/7486661/what-does-mean-in-jquery)

这应该有助于解渴`:)`可能希望这会有所帮助！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-27T11:00:20.130

他们是一样的。默认情况下，jQuery 将自己绑定到两个全局名称：`jQuery`和`$`. 后者更短但更模糊，因为其他框架也是如此。

请参阅有关此的文档：http: [//api.jquery.com/jQuery.noConflict/](http://api.jquery.com/jQuery.noConflict/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-27T11:01:12.923

`$`是一个快捷方式`jquery`- 许多 javascript 库允许您使用`$`，因此如果您在代码中使用超过 1 个库，通常使用起来更安全`jquery`- 如果您只使用 jQuery，那么使用应该没有问题`$`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-27T11:01:20.037

没有，$只是一个别名，你也可以通过`jQuery.noConflict()`函数使用不同的别名

# mongodb - MongoDB / GridFS + Tomcat 的烦恼

> ID：11686422
> 
> 赞同：1
> 
> 时间：2012-07-27T10:58:27.483
> 
> 标签：mongodb, tomcat, gridfs

我在 Tomcat 7 上运行一个应用程序，在虚拟机上运行，​​仅用于一个目的：分发照片。

初始化应用程序时，它与 MongoDB 连接，如下所示：

```
//Create mongo reference
Mongo mongo = new Mongo(new MongoURI(url)); 
```

然后我将参考保存在内存中并像这样搜索照片：

```
//Update R/W Strategy
dbManager.setMongoReadWritePreferences(mongo, app);

//Use database dbname
DB db = mongo.getDB(dbname);

try {           
    db.requestStart();
    db.requestEnsureConnection();

    //Open gridFS connection
    GridFS fs = new GridFS(db, GlobalConfig.GRIDFS_COLLECTION_BUCKET_BLOBS);

    GridFSDBFile photos = fs.findOne(filename);
    log.debug("[+]"+photos);

    if (photos == null){
        throw new Exception("[PHOTO_NOT_FOUND]");
    } else {
        return photos.getInputStream();
    }

} finally {
    //Request is finished
    db.requestDone();
} 
```

它工作得很好。（*在 70GB 的照片集上，任何照片大约需要 35 毫秒*）

我最近开始遇到无法返回照片的问题，并且我的监控图上有奇怪的峰值：

![线程数](../Images/bc9d7473715ea97fdb4b3c28e54ee08c.png) ![每分钟请求数](../Images/58505c893a4e6aaf79a1090c64452332.png) ![与此同时](../Images/7dc0ea91d9419602a6bdbaac53ba0ad7.png) ![每分钟字节数](../Images/310e03d7837ff1983d24e9534065081e.png)

流量不是很高，但它一直在做奇怪的事情，随机发送空照片。

任何人都知道它可能是什么？

# asp.net-mvc-3 - MVC Visual Studio“循环依赖”

> ID：11686425
> 
> 赞同：0
> 
> 时间：2012-07-27T10:58:42.613
> 
> 标签：asp.net-mvc-3, visual-studio-2010, circular-dependency

目前我遇到了“循环依赖”的问题。我有错误，因为我必须将文件 .dll 添加到另一个项目，但我想添加的这个项目中已经存在引用。我不知道我该怎么办？

```
Error   1   SportsStore.WebUI.accessor: The reference to 'SportsStore.WebUI.dll' was not found in the list of this projects references  SportsStore.UnitTests 
```

![在此处输入图像描述](../Images/e1d7b5a0824ed29962efb93e70ae6885.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T11:18:43.160

通过查看您刚刚发布的屏幕截图，您似乎正在添加**SportsStore.WebUI**项目作为对 SportsStore.UnitTests 的引用，但**由于**循环依赖而失败。这是否意味着您的 WebUI 项目已经引用了 UnitTests 项目？如果是这样，那么您的设计就有问题，因为“真实”代码永远不应该引用测试项目。

现在，一般来说，如果你想解决循环依赖关系，你可以简单地将公共部分提取到一个单独的程序集中。它们不会引用彼此的项目，而是引用该公共程序集。

# wordpress - 获取分类值名称

> ID：11686426
> 
> 赞同：1
> 
> 时间：2012-07-27T10:58:42.363
> 
> 标签：wordpress

我有一个名为“作者”的自定义分类法的博客。在主页上，使用以下脚本显示所有“作者”值的列表（例如：Mark、Paul、John 等）：

```
$terms = get_terms("autors");
$count = count($terms);
if ( $count > 0 ){
echo '<ul>';
foreach ( $terms as $term ) {
echo '<li> <a href="/autors/' . $term->slug . '" title="' . sprintf(__('View all post filed under %s', 'my_localization_domain'), $term->name) . '">' . $term->name . '</a> </li>';
}
echo '</ul>';
} 
```

每个作者姓名都与他的网址永久链接，以显示该作者的帖子。例如：

*   [标记](http://www.test.com/autors/mark)
*   [卢克](http://www.test.com/autors/luke)
*   [约翰](http://www.test.com/autors/john)

当我点击它们时，我会被重定向到包含该作者帖子的存档页面。我不想要这个。我只是想得到作者的名字。所以：

*   如何防止显示存档页面？
*   我怎样才能得到作者的名字？例如：如果我在页面[http://www.test.com/autors/mark](http://www.test.com/autors/mark)上，我想得到 *$author_name = mark*;

你能帮我吗？谢谢

# github - 如何阻止 github 向现有拉取请求添加新提交

> ID：11686435
> 
> 赞同：25
> 
> 时间：2012-07-27T10:59:13.177
> 
> 标签：github

我已经创建了一个从我的主分支到上游的拉取请求，现在该分支上的每个新提交都会自动附加到这个拉取请求。

创建时拉取请求页面上有一个“更改提交”按钮，但在创建请求后它似乎消失了。我现在可以用其他方式吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2020-07-28T08:25:59.273

在 GitHub 中，Pull Request 表示将一个分支与另一个分支合并的请求。当任一分支更新时，拉取请求也会更新并重新评估合并。

因此，当您将新更改推送到链接有未完成的拉取请求的分支时，拉取请求将被更新以包含新更改。

要将您的拉取请求重置为以前的状态，您可以：

```
 git switch branch-you-want-to-fix
   git branch backup-of-later-changes
   git reset --hard hash-of-desired-changes
   git push --force 
```

此 rill 将使用您以后的更改创建一个新的本地分支，并将从 github 上的分支中删除这些更改。

拉取请求将被重新评估（其中一方已通过您的强制推送更新），您可以从您的`backup-of-later-changes`分支创建新的拉取请求。

只要新提交没有被推送到 pr-branch，它们就不会自动出现在其中，即使这些更改是基于原始 pr-branch 的顶部。

# wpf - 如何将触发器与 SourceName 和 DataTrigger 结合使用？

> ID：11686439
> 
> 赞同：4
> 
> 时间：2012-07-27T10:59:37.463
> 
> 标签：wpf, xaml, triggers, multidatatrigger

在我的 WPF 控件中，我有以下两个触发器：

```
<Trigger
  Property="Controls:TreeViewExItem.IsMouseOver"
  Value="True"
  SourceName="ElementGrid"> 
```

和

```
<DataTrigger
  Binding="{Binding
    RelativeSource={RelativeSource AncestorType={x:Type Controls:TreeViewEx}},
    Path=HoverHighlighting}"
  Value="False"> 
```

两者都为自己工作正常。但我需要这些的组合。我试过这个：

```
<MultiDataTrigger>
  <MultiDataTrigger.Conditions>
    <Condition
      Binding="{Binding
        RelativeSource={RelativeSource AncestorType={x:Type Controls:TreeViewEx}},
        Path=HoverHighlighting}"
      Value="True"/>
    <Condition
      Binding="{Binding
        (Controls:TreeViewExItem.IsMouseOver),
        Source=ElementGrid}"
      Value="True"/>
  </MultiDataTrigger.Conditions> 
```

但它什么也没做。我在输出窗口中收到此消息：

> System.Windows.Data 错误：17：无法从“”（类型“字符串”）获取“IsMouseOver”值（类型“布尔”）。绑定表达式：路径=（0）；DataItem='String' (HashCode=1047858601); 目标元素是'TreeViewExItem'（名称=''）；目标属性是'NoTarget'（类型'Object'） InvalidCastException：'System.InvalidCastException：在 Typ“System.Windows.DependencyObject”umgewandelt werden 中的 Das Objekt des Typs“System.String”kann nicht。

这并不能告诉我任何事情。它将如何运作？

**更新：**完整的项目代码现在可以在我的 GitHub 存储库中查看。我对 MultiDataTrigger 的猜测目前[位于](https://github.com/dg9ngf/TreeViewEx/blob/master/TreeViewEx/Themes/TreeViewExItem.xaml#L270).

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-28T13:20:40.167

我现在尝试了很多东西，但没有发现任何有用的东西。在有人证明我错之前，我必须假设 Triggers 和 DataTriggers 不能结合使用。

我的解决方案是不同的：我没有尝试从同一个触发器（需要不同的触发器类型）访问本地属性和父元素属性，而是将另一个 DependencyProperty 添加到我的子元素类并将其值绑定到父元素的属性。因此子元素不需要找到父元素的值——它总是拥有该值本身的当前副本。由于复制该值是在另一个地方完成的，它使触发器保持美观和小巧。:-)

所以这就是我添加的 XAML 代码的样子。这是子项样式的新设置器：

```
<!-- Pass on the TreeViewEx' HoverHighlighting value to each item
  because we couldn't access it otherwise in the triggers -->
<Setter
  Property="HoverHighlighting"
  Value="{Binding (Controls:TreeViewEx.HoverHighlighting),
    RelativeSource={RelativeSource
      AncestorType={x:Type Controls:TreeViewEx}}}" /> 
```

这是在所有其他触发器已经存在的触发器部分中：

```
<!-- Set the border and background when the mouse is located over
  the item and HoverHighlighting is active -->
<MultiTrigger>
  <MultiTrigger.Conditions>
    <Condition
      Property="Controls:TreeViewExItem.HoverHighlighting" Value="True"/>
    <Condition
      Property="Controls:TreeViewExItem.IsMouseOver" Value="True"
      SourceName="ElementGrid"/>
  </MultiTrigger.Conditions> 
```

一旦工作，依赖属性和数据绑定就很棒。但在那之前，它可能是可怕的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-02-09T19:20:34.543

我知道这是一个较旧的项目，但我想添加一些我今天发现的东西：即使你不能组合触发器和数据触发器，你也可以轻松地将触发器升级为引用自我的数据触发器，如下所示：

```
<MultiDataTrigger.Conditions>
    <Condition Binding="{Binding ElementName=TabsApp, Path=SelectedIndex}" value="0"/>
    <Condition Binding="{Binding RelativeSource={RelativeSource Self}, Path=IsEnabled}" Value="False"/>
</MultiDataTrigger.Conditions> 
```

这将使您能够将有关包含触发器的控件的条件与有关其他控件的条件结合起来，不需要依赖属性。

# python - 用于 iOS 的 Python 作为静态库

> ID：11686452
> 
> 赞同：4
> 
> 时间：2012-07-27T11:00:23.023
> 
> 标签：python, ios

是否有一个静态 Python 库可以与我的 XCode 项目链接以嵌入 Python 解释器？我在哪里可以找到它（预构建）？我知道有一些项目声称会生成这样一个静态库（如 kivy、embedded-python、ignifuga），但所有这些构建都因某种原因而失败（例如工具的版本冲突），我不想要花几天时间让这个工作。

# c++ - 如何使队列上的推送和弹出原子化，如何锁定这些操作？

> ID：11686456
> 
> 赞同：6
> 
> 时间：2012-07-27T11:00:40.317
> 
> 标签：c++, multithreading, boost, stl, queue

我正在使用队列在两个线程之间进行通信（一个只是生成自定义类的实例并将指针推送到队列，另一个从自定义类的队列指针中读取并进行一些计算）。如何使队列上的推送和弹出原子化，如何锁定这些操作？（我不能使用 C++11 标准）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-27T11:15:48.347

最可移植的非 C++11 锁定机制可能是来自[Boost.Thread库的](http://www.boost.org/doc/libs/1_50_0/doc/html/thread.html)[同步](http://www.boost.org/doc/libs/1_50_0/doc/html/thread/synchronization.html)类型。特别是[mutex](http://www.boost.org/doc/libs/1_50_0/doc/html/thread/synchronization.html#thread.synchronization.mutex_types.mutex)类为您提供了一个简单的可锁定对象，用于提供对资源的独占访问权限。例如：

```
#include <boost/thread/mutex.hpp>
#include <queue>

template <typename T>
class locking_queue {
public:
    void push(T const & value) {
        boost::mutex::scoped_lock lock(mutex);
        queue.push(value);
    }

    bool pop(T & value) {
        boost::mutex::scoped_lock lock(mutex);
        if (queue.empty()) {
            return false;
        } else {
            value = queue.front();
            queue.pop();
            return true;
        }
    }

private:
    std::queue<T> queue;
    boost::mutex mutex;
}; 
```

另一个优点是它与 C++11`std::mutex`类非常相似，如果您决定改用它，这将使转换变得非常简单。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-27T11:05:35.653

这是一个伪代码：

```
// Thread A
mutex.lock();
q.push();
mutex.unlock();

// Thread B
mutex.lock();
q.pop();
mutex.unlock(); 
```

如果你正在使用 boost，你可以试试它的[mutex](http://www.boost.org/doc/libs/1_39_0/doc/html/boost/signals2/mutex.html)类。

# javascript - Javascript 范围规则和 mongo map/reduce 函数

> ID：11686462
> 
> 赞同：4
> 
> 时间：2012-07-27T11:00:47.407
> 
> 标签：javascript, node.js, mongodb, closures, mongoose

我想制作一些在 mongo 中执行参数化 map/reduce 作业的 javascript 函数，但我对 JavaScript 的范围感到困惑。例如，下面的代码给了我`"gender"`变量的计数；即它会告诉我我有多少`"male"`和`"female"`记录：

```
// count categories
db.responses.mapReduce(
    function(){
        emit(this["gender"], {count: 1})
    }, function(state, values){
        var result = {count: 0};
        values.forEach(function(value) {
            result.count += value.count;
        });
        return result;
    }, {out: { inline : 1}}
); 
```

这工作得很好。在下一步中，我想创建一个对任意属性执行此操作的函数

```
function countCategories(item) { 
    function mapper(it){
        fn = function(){
            if(this[it]){
                emit(this[it], {count: 1});
            }
        };
        return fn;
    }(item); 
    var reducer = function(state, values){
        var result = {count: 0};
        values.forEach(function(value) {
            result.count += value.count;
        });
        return result;
    };
    var out = {out: { inline : 1}};
    var results = db.responses.mapReduce(
        mapper, 
        reducer, 
        out
    );
    return results;
}   

countCategories("gender") 
```

但是，当我尝试：

```
countCategories("gender")
{
    "results" : [ ],
    "timeMillis" : 48,
    "counts" : {
        "input" : 2462,
        "emit" : 0,
        "reduce" : 0,
        "output" : 0
    },
    "ok" : 1,
} 
```

发射函数从未被调用过。这里出了什么问题？我的猜测是`emit`mongo 提供的函数的范围，但我不太确定为什么它没有被调用，也没有抛出错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-27T11:58:50.370

根据我在[文档](http://www.mongodb.org/display/DOCS/MapReduce#MapReduce-Overview)中阅读的内容，数据库命令中使用的函数范围不是它们的默认 javascript 范围，但可以（并且必须，如果需要）手动设置。因此，它认为这应该有效：

```
var mapper = function(){
    if(item in this){
        emit(this[item], {count: 1});
    }
};
...
db.responses.mapReduce(
    mapper, 
    reducer, 
    {
       out: {"inline": 1},
       scope: {"item": item}
    }
); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T12:13:08.337

我认为你在mapper的声明中有问题：

你的代码：

```
function mapper(it){
    fn = function(){
        if(this[it]){
            emit(this[it], {count: 1});
        }
    };
    return fn;
}(item); 
```

由于 JavaScript 语法/提升/分号插入内容，等效于：

```
function mapper(it){
    fn = function(){
        if(this[it]){
            emit(this[it], {count: 1});
        }
    };
    return fn;
}

item; 
```

你的函数*语句*声明了一个你想立即执行的函数，但你没有。

就其本身而言，`item;`JavaScript 完全没问题。它没有做任何事情，但它是有效的。（喜欢`"use strict";`）

你想要的是一个函数*表达式*：

```
var mapper = (function (it){
    fn = function(){
        if(this[it]){
            emit(this[it], {count: 1});
        }
    };
    return fn;
})(item); 
```

这里的重要部分不是单独`function`在行首。函数表达式周围的`()`不是必需的，但它表示您立即执行该函数。如果您没有分配给变量，它们将是必需的；避免以`function`.

# ios - 应用重新启动过快时崩溃

> ID：11686470
> 
> 赞同：1
> 
> 时间：2012-07-27T11:01:13.223
> 
> 标签：ios

所以这是你可能见过的最模糊的问题。我不能提供太多细节，因为它对客户来说是一个敏感的应用程序。

本质上，我的应用程序无法在后台运行。当我按下关闭按钮关闭应用程序时，它会启动一个需要几秒钟的关闭序列。如果我过早地再次启动应用程序，应用程序中的所有内容都会按照您的预期正常启动，除了视图卡在 Default.png 图像上。此外，在短时间内应用程序崩溃并且日志显示应用程序关闭时间过长，因此 iOS 将其杀死（它认为它与以前的应用程序相同）。

有针对这个的解决方法吗？

如果您需要更多详细信息，请询问，我会尽我所能回答。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T12:44:02.847

这是我经常遇到的问题（假设我们有同样的问题）。从 Xcode 部署您的应用程序，然后点击“停止”按钮。然后您可以尝试启动和重新启动。我不确定是什么原因造成的，但是当您退出并租用仍在调试器中运行的应用程序时，Xcode 似乎不喜欢。

# c# - WebBrowser 在 BackgroundWorker 理解内的 STAThread 内导航

> ID：11686476
> 
> 赞同：0
> 
> 时间：2012-07-27T11:01:41.143
> 
> 标签：c#, winforms, browser, backgroundworker, sta

我正在努力寻找一个好的标题，因为我已经解决了我的问题。我只需要解释我是如何解决它的……因为我正在研究我今天刚刚发现的东西，现在对我来说可能还不清楚。

因此，为了恢复我的问题解决，这里是我解决问题的方式，以及我不明白的地方。

我正在设计一个爬入网站以检索一些数据的 WindowsForm 应用程序。我有几个不同的网站要爬入，每个网站都不同。我使用的基本方式是使用 WebRequest。然而，一个网站迫使我模拟点击，所以对于这个特定的网站，我使用 WebBrowser 控件来调用特定的 javascript 函数。

我决定从主线程中退出一些爬行工作，因为这非常耗时并且冻结了我的应用程序。

我以前这样做的方法是每个搜索方法的 BackgroundWorker（每个网站一个）。它适用于每个网站，除了带有 WebBrowser 的网站。我遇到了一个异常：“无法获取 'WebBrowser' 控件的窗口句柄。不支持无窗口 ActiveX 控件。”。

我在网上发现我无法使用 WebBrowser 控件，因为我不在构建 WebBrowser 的线程中。我决定在 BackgroundWorker 的 DoWork 方法中创建一个包含 WebBrowser 的 Form，而不是原来的 Form，并为此 WebBrowser 调用 Navigate() 方法。

它也没有工作，同样的例外。我找到了这个答案（http://stackoverflow.com/questions/4269800/webbrowser-control-in-a-new-thread）这对我有很大帮助（我改变了一点答案代码让它像这是面向问题的）

所以现在：

我单击一个按钮，它会创建一个 BackgroundWorker。在 BackgroundWorker 内部，调用了 launchSearch 方法。在这个 launchSearch 方法中，我创建了一个新线程，它正在完成我需要的所有工作（这个线程的创建方式与我上面链接的解决方案几乎相同），我将“hasActiveThread”布尔值设置为 true，而线程尚未完成工作。工作完成后，我得到结果并释放我的 BackgroundWorker。

困扰我的是，我真的不明白为什么在我的 BackgroundWorker“DoWork”方法中创建表单在尝试导航到 url 时无法正常工作。如果您至少可以帮助我理解为什么解决方案必须如此“复杂”，以及这背后的原因，我将非常感激！

Al_th

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T11:33:11.507

您的解决方案不起作用，因为 BackgroundWorked 运行的所有新线程都是在没有运行 Message Loop 的情况下启动的。任何用户交互操作都通过 Windows 消息机制进行。有关详细信息，请参阅 [http://en.wikipedia.org/wiki/Message_loop_in_Microsoft_Windows](http://en.wikipedia.org/wiki/Message_loop_in_Microsoft_Windows)和[http://msdn.microsoft.com/en-us/library/windows/desktop/ms644928%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms644928%28v=vs.85%29.aspx)。简单创建 Form 对象不会启动消息循环。为了运行它，您可以调用 Form.Show 或 Form.ShowDialog 方法，或 Application.Run(...) 方法。在工作示例中，消息循环是使用 Application.Run() 方法启动的。

# mqtt - MQTT 无法接收消息

> ID：11686478
> 
> 赞同：0
> 
> 时间：2012-07-27T11:01:58.920
> 
> 标签：mqtt

我对 MQTT 有疑问。

我对 Android MQTT 有疑问。

我遵循了这个（http://tokudu.com/2010/how-to-implement-push-notifications-for-android/）演示并且能够运行这个源代码。但是，我总是收到无法连接到服务器的消息。他的 MQTT 有问题还是我的连接有问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T08:12:48.573

我不知道你在哪里运行你的代理，但如果你的 MQTT 代理在你的开发机器上运行，你不能通过 localhost 或 127.0.0.1 连接它，因为在这种情况下“本地”实际上是你的手机或模拟器. 相反，您需要提供本地 IP 来连接此 MQTT 代理。（*ipconfig*用于 Windows，*ifconfig*用于 linux 命令行）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T17:37:44.937

您尝试连接的服务器的地址是什么？

我知道那篇文章已经相当老了，因为 Eclipse Paho 客户端已经出来了，MQTT wiki 上有一些很好的资源，关于在 Android 上也使用它[http://mqtt.org/wiki/doku.php/mqtt_on_the_android_platform](http://mqtt.org/wiki/doku.php/mqtt_on_the_android_platform)

# ruby-on-rails - 如何在 ruby -on-rails 中动态创建具有动态列名的表？

> ID：11686481
> 
> 赞同：0
> 
> 时间：2012-07-27T11:02:13.970
> 
> 标签：ruby-on-rails, activerecord

我需要做的是我希望能够创建一个包含动态列的表，从哈希中检索列名及其数据类型。

请以下面的代码片段为例：

```
COLUMNS =  { :column1 => 'integer',
                :column2 => 'string',
                :column3 => 'string',
                :column4 => 'date'
                } 
```

以静态方式，我可以这样做：

```
create_table :details do |t|
  t.integer column1
  t.string column2
  t.string column3
  t.date column4
  t.timestamps
end 
```

但是，你知道，这看起来有点硬编码，我对此并不满意。

我的想法是让它更像：

```
create_table :details do |t|

  COLUMNS.each_pair do |key,value|
    #to define each column and its data type
    t[value] key
  end

  t.timestamps  
end 
```

不幸的是，它似乎并没有按我想要的方式工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T11:26:42.787

`t.integer`正在调用一个方法`t`，而不是做一个数组索引，所以你有没有尝试过调用`t.__send__(value, key)`？

# php - 哪些语言、库和其他软件对 URL 参数中带有方括号的数组进行序列化？("?a[]=1&a[]=2")

> ID：11686482
> 
> 赞同：0
> 
> 时间：2012-07-27T11:02:23.877
> 
> 标签：php, jquery, query-string

我知道 jQuery > 1.4 并且因为早期版本的 PHP 在 URL 参数中序列化数组，如下所示：

```
#1: ?param[]=value1&param[]=value2  # (assuming the '[]' characters are URL-encoded) 
```

还有另一种方法可以做到这一点：

```
#2: ?param=value1&param=value2 
```

是否有任何其他语言、库等使用方法 #1 进行序列化？

是否有任何 RFC 提供有关哪种方法有效的详细信息？

在 URL 参数中序列化数组的其他方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T11:10:56.847

1.) 这种在 url 中包含方括号的表示法严格来说是无效的。它们应该被编码。然而，它“通常按预期工作”。

2.) 你提供的两种符号表达了不同的东西。第一个结果是一个名为 param 的数组，其中包含两个值。第二个只创建一个标量变量，第一个值丢失（覆盖）。虽然这实际上取决于请求 url 的服务器端评估。我只是解释了“典型的”脚本引擎行为。您当然也可以手动解析 url 并构造一个数组。

# fonts - Imagemagick font_stretch 或字母之间的间距？

> ID：11686485
> 
> 赞同：4
> 
> 时间：2012-07-27T11:02:32.957
> 
> 标签：fonts, imagemagick, spaces

我正在使用 ImageMagick 生成一些按钮。但是，我无法设置生成图像中字母之间的间距。我使用的命令：

```
convert -gravity center button_subscribeme.png -font /usr/share/fonts/truetype/msttcorefonts/Arial_Bold.ttf  -fill white -draw "text 0,0 'CLICK ME'"  -font_stretch 10  render/mailbox-submit.png 
```

抛出：

```
convert: unrecognized option `-font_stretch' @ error/convert.c/ConvertImageCommand/1561. 
```

所以我猜 font_strech 不是正确的选择。我怎样才能实现它？生成的文本太窄。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-27T16:12:56.240

`-font_stretch`没有我知道的ImageMagick 参数。但是，有`-stretch`.

但我不认为这`-stretch`真的适用于字体。无论如何，要找出可能的值类型，只需运行：

```
convert -list stretch 
```

并查看结果：

```
任何
浓缩的
展开
超浓缩
额外扩展
普通的
半浓缩
半膨胀
超浓缩
超扩展
```

## 使用`-kerning`！

最好使用`-kerning`命令行参数。它需要正值和负值：

```
convert \
  in.png \
 -gravity center \
 -font "/Library/Fonts/Arial Bold.ttf" \
 -kerning -0.5 \
 -fill white \
 -draw "text 0,0 'CLICK ME'" \
  out1.png 
```

或者

```
convert \
  in.png \
 -gravity center \
 -font "/Library/Fonts/Arial Bold.ttf" \
 -kerning 1.5 \
 -fill white \
 -draw "text 0,0 'CLICK ME'" \
  out2.png 
```

在 Mac 上的 ImageMagick 版本 6.7.8-3 2012-07-19 上为我工作：

![<code>-kerning -0.5</code>](../Images/8bef9445446d5cf746d5804b492bb799.png) ![<code>-kerning 1.5</code>](../Images/763c7e01ffde7a7c3b4a3be0f775152c.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T11:07:11.240

我认为它是`-stretch`并且采用枚举参数而不是数字。

检查此链接：[http ://www.imagemagick.org/script/command-line-options.php#stretch](http://www.imagemagick.org/script/command-line-options.php#stretch)

# c# - WFDB SWIG Wrappers 与 Visual Studio c# 项目的连接

> ID：11686488
> 
> 赞同：0
> 
> 时间：2012-07-27T11:02:55.623
> 
> 标签：c#, c#-4.0, wrapper, swig

我对包装器的主题相对较新，如果有人可以给我一些提示，我会很高兴，我如何启动将使用 wfdb 库（用 C 编写）的 Visual Studio (C#) 项目。我的目标是在 c# 应用程序中读取和呈现来自 physionet 数据库的信号。我已按照以下所有步骤操作： [在此处输入链接描述](http://www.physionet.org/physiotools/wfdb-windows-quick-start.shtml)

使用win xp和VS2010。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T22:26:21.017

看看这个项目

[http://wfdbcsharpwrapper.codeplex.com](http://wfdbcsharpwrapper.codeplex.com)

# objective-c - 如何在 IOS 中单独获取 alpha 通道？

> ID：11686489
> 
> 赞同：3
> 
> 时间：2012-07-27T11:02:57.387
> 
> 标签：objective-c, ios5, uiimage, pixel, uicolor

我有图像，我只需要生成 alpha 坐标的图像......我做了以下但它只产生红色图像我在代码中做错了......

在此先感谢.... myCode：

```
-(UIImage*)alphaAlone:(UIImage*)sourceImage
{
     CGImageRef img=sourceImage.CGImage;
    CFDataRef m_DataRef; 
    m_DataRef = CGDataProviderCopyData(CGImageGetDataProvider(img)); 
    UInt8 *dataMasked=(UInt8 *)CFDataGetBytePtr(m_DataRef);
    double length=CFDataGetLength(m_DataRef);

    NSLog(@"length::%f",length);

for(int index=0;index<length;index+=4)
    {

            dataMasked[index]  =dataMasked[index];
            dataMasked[index+1]  =0;
            dataMasked[index+2]  =0;
            dataMasked[index+3]  =0;
     }

 NSUInteger width =CGImageGetWidth(img);
    size_t height=CGImageGetHeight(img);
    size_t bitsPerComponent=CGImageGetBitsPerComponent(img);
    size_t bitsPerPixel=CGImageGetBitsPerPixel(img);
    size_t bytesPerRow=CGImageGetBytesPerRow(img);

    NSLog(@"the w:%u H:%lu",width,height);

    CGColorSpaceRef colorspace=CGImageGetColorSpace(img);
    CGBitmapInfo bitmapInfo=CGImageGetBitmapInfo(img);

    CFDataRef newData=CFDataCreate(NULL,dataMasked,length);
    CGDataProviderRef provider=CGDataProviderCreateWithCFData(newData);
    CGImageRef newImg=CGImageCreate(width,height,bitsPerComponent,bitsPerPixel,bytesPerRow,colorspace,bitmapInfo,provider,NULL,true,kCGRenderingIntentDefault);

    return [UIImage imageWithCGImage:newImg];
} 
```

![结果](../Images/fb60c32358cd309958d1a2d4aa221935.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T12:02:51.880

检查这是否有效。此函数返回您自动发布的 alpha 图像。

```
- (UIImage*)seperatAlphaFromImage:(UIImage*)pngImage writeToFile:(NSString*)path compressionQuality:(float)value0To1
{    
CGRect imageRect = CGRectMake(0, 0, pngImage.size.width, pngImage.size.height);

//Pixel Buffer
uint32_t* piPixels = (uint32_t*)malloc(imageRect.size.width * imageRect.size.height * sizeof(uint32_t));
if (piPixels == NULL)
{
    return nil;
}
memset(piPixels, 0, imageRect.size.width * imageRect.size.height * sizeof(uint32_t));

//Drawing image in the buffer
CGColorSpaceRef colorSpace = CGColorSpaceCreateDeviceRGB();
CGContextRef context = CGBitmapContextCreate(piPixels, imageRect.size.width, imageRect.size.height, 8, sizeof(uint32_t) * imageRect.size.width, colorSpace, kCGBitmapByteOrder32Little | kCGImageAlphaPremultipliedLast);

CGContextDrawImage(context, imageRect, pngImage.CGImage);

//Copying the alpha values to the red values of the image and setting the alpha to 1
for (uint32_t y = 0; y < imageRect.size.height; y++) 
{
    for (uint32_t x = 0; x < imageRect.size.width; x++)
    {
        uint8_t* rgbaValues = (uint8_t*)&piPixels[y * (uint32_t)imageRect.size.width + x];

        //alpha = 0, red = 1, green = 2, blue = 3.

        rgbaValues[0] = rgbaValues[0];
        rgbaValues[1] = rgbaValues[0];
        rgbaValues[2] = rgbaValues[0];
        rgbaValues[3] = rgbaValues[0];
    }
}

//Creating image whose red values will preserve the alpha values
CGImageRef newCGImage = CGBitmapContextCreateImage(context);
UIImage* newImage = [[[UIImage alloc] initWithCGImage:newCGImage]autorelease];
CGImageRelease(newCGImage);

return newImage;    
} 
```

# api - 如何防止 URL 超出 HTTP 限制？

> ID：11686490
> 
> 赞同：1
> 
> 时间：2012-07-27T11:02:59.383
> 
> 标签：api, http, url, rest, get

服务器上存在具有以下属性的汽车模型

```
  名称：字符串
  uid：字符串，最大长度 200 个字符
  颜色：字符串

```

我有一个 API 调用来获取所有汽车的列表，如下所示

```
/cars.json 
```

现在我需要修改它，并添加一个参数，该参数将采用逗号分隔的汽车 uid 列表，如下所示

```
/cars.json?car_uids=car1,car2,car3... 
```

我需要确保此 URL 不超过 HTTP 限制。请提出建议。

# r - R语言中的排序和分组

> ID：11686492
> 
> 赞同：3
> 
> 时间：2012-07-27T11:03:21.363
> 
> 标签：r, sorting, dataframe

我在文本文件中有这样的数据

```
fd50c4007b68a3737fe052d5a4f78ce8aa117f3d    SOEGIYH12A6D4FC0E3  1
fd50c4007b68a3737fe052d5a4f78ce8aa117f3d    SOFLJQZ12A6D4FADA6  1
fd50c4007b68a3737fe052d5a4f78ce8aa117f3d    SOHTKMO12AB01843B0  1
fd50c4007b68a3737fe052d5a4f78ce8aa117f3d    SODQZCY12A6D4F9D11  1
fd50c4007b68a3737fe052d5a4f78ce8aa117f3d    SOXLOQG12AF72A2D55  1
d7083f5e1d50c264277d624340edaaf3dc16095b    SOUVUHC12A67020E3B  1
d7083f5e1d50c264277d624340edaaf3dc16095b    SOUQERE12A58A75633  1
d7083f5e1d50c264277d624340edaaf3dc16095b    SOIPJAX12A8C141A2D  1
d7083f5e1d50c264277d624340edaaf3dc16095b    SOEFCDJ12AB0185FA0  2
d7083f5e1d50c264277d624340edaaf3dc16095b    SOATCSU12A8C13393A  2 
```

我能够成功地将其保存在一个变量中，但是：

1.  我需要根据第三个字段对这些数据进行排序。
2.  我需要根据第一个字段对数据进行排序，并根据相同的第一个字段对其进行分组，并希望对组中的第三个字段求和。

可以用R语言做吗？

输出应该是：

```
fd50c4007b68a3737fe052d5a4f78ce8aa117f3d 5
d7083f5e1d50c264277d624340edaaf3dc16095b 7 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-27T11:27:32.537

正如您（某种）在您的问题中陈述的那样，您有两个问题：

1.  计算以另一个变量为条件的变量的总和
2.  对数据进行排序

第一个问题可以使用`plyr`包解决：

```
##Some dummy data
library(plyr)
dd = data.frame(V1 = rep(c("A", "A", "B"), 4), V2 = rep(1:3,each=2 ))

##The function ddply takes in a data frame dd
##Splits the data frame by column V1
##Sums the column V2
dd1 = ddply(dd, "V1", summarise,  V2 = sum(V2)) 
```

第二个问题可以通过搜索“[如何对数据框进行排序](https://stackoverflow.com/q/1296646/203420)”来解决

```
dd1[with(dd1, order(V2)), ] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-28T00:51:16.630

Q1：按一列对数据框进行排序通常使用`order`. 您确实需要按顺序命名数据框，这对于新用户来说似乎是多余的。但数值索引具有高度的灵活性，各种构造的数值向量也能产生有用的结果，因此需要特定的向量对象。

```
> dat[ order(dat$V1), ]
                                         V1                 V2 V3
6  d7083f5e1d50c264277d624340edaaf3dc16095b SOUVUHC12A67020E3B  1
7  d7083f5e1d50c264277d624340edaaf3dc16095b SOUQERE12A58A75633  1
8  d7083f5e1d50c264277d624340edaaf3dc16095b SOIPJAX12A8C141A2D  1
9  d7083f5e1d50c264277d624340edaaf3dc16095b SOEFCDJ12AB0185FA0  2
10 d7083f5e1d50c264277d624340edaaf3dc16095b SOATCSU12A8C13393A  2
1  fd50c4007b68a3737fe052d5a4f78ce8aa117f3d SOEGIYH12A6D4FC0E3  1
2  fd50c4007b68a3737fe052d5a4f78ce8aa117f3d SOFLJQZ12A6D4FADA6  1
3  fd50c4007b68a3737fe052d5a4f78ce8aa117f3d SOHTKMO12AB01843B0  1
4  fd50c4007b68a3737fe052d5a4f78ce8aa117f3d SODQZCY12A6D4F9D11  1
5  fd50c4007b68a3737fe052d5a4f78ce8aa117f3d SOXLOQG12AF72A2D55  1 
```

Q2：要对类别中的向量求和并返回数据框，请使用`aggregate`：

```
> with(dat , aggregate(V3 ~ V1) )
                                        V1 V3
6 d7083f5e1d50c264277d624340edaaf3dc16095b  7
1 fd50c4007b68a3737fe052d5a4f78ce8aa117f3d  5 
```

如果需要订购：

```
> dat2 <- with(dat , aggregate(V3 ~ V1) )
> dat2[order(dat2$V1), ]
                                        V1 V3
6 d7083f5e1d50c264277d624340edaaf3dc16095b  7
1 fd50c4007b68a3737fe052d5a4f78ce8aa117f3d  5 
```

# android - 如何在查询函数中使用 LIKE 子句

> ID：11686497
> 
> 赞同：7
> 
> 时间：2012-07-27T11:03:46.313
> 
> 标签：android, sqlite

我正在制作一个应用程序，它根据发件人号码在收件箱中搜索邮件。这是我的代码：

```
public void onClick(View v)
{
    Toast.makeText(this, "search", Toast.LENGTH_LONG).show();
    final Uri SMS_INBOX = Uri.parse("content://sms/inbox");

    String[] colList = {"address", "body"};

    Cursor c = getContentResolver().query(SMS_INBOX, colList, null, null,"DATE desc");

    String yz= String.valueOf(c.getCount());
    Toast.makeText(this, yz, Toast.LENGTH_LONG).show();

    if(c.moveToFirst())
    {
        Toast.makeText(this, searchtxt.getText(), Toast.LENGTH_LONG).show();

        for(int i=0;i<c.getCount();i++)
        {
            String number=c.getString(c.getColumnIndexOrThrow("address")).toString();
            boolean match = number.toUpperCase().indexOf(searchtxt.getText().toString()) != -1; 

            if (match)
            {
                Toast.makeText(this, String.valueOf(i), Toast.LENGTH_LONG).show();
                String  body= c.getString(c.getColumnIndexOrThrow("body")).toString();
                tv.setText(tv.getText() + "\n" + body);
            }
            c.moveToNext();
        }
    }
    else
    {
        Toast.makeText(this, "Inside else", Toast.LENGTH_LONG).show();
    }

    c.close();
} 
```

上面的代码工作正常，但它检索收件箱中的所有消息。我希望它只检索与发件人号码匹配的那些消息。为此，我尝试使用 LIKE 子句进行查询，但它返回 0 条记录。使用 LIKE 子句的正确方法是什么。这是我尝试使用 LIKE 的代码

```
String[] colList = {"address", "body"};
String[] argList = {"'%"+searchtxt.getText().toString()+"%'"};
Cursor c = getContentResolver().query(SMS_INBOX, colList, "address LIKE ?", argList,"DATE desc");

String yz= String.valueOf(c.getCount());
Toast.makeText(this, yz, Toast.LENGTH_LONG).show(); 
```

请帮帮我……谢谢……

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-27T11:15:02.917

有两个小丑：“%”和“_”。

"%" 正在替换任何字符串（多个字符），

“_”正在替换一个（并且只有一个）字符。

例如 ：

```
LIKE 'B%' 
```

让您找到以“B”开头的所有内容。（如“蝙蝠侠”）；

```
LIKE '%B%' 
```

让你找到所有包含“B”的东西。（如“阿巴”）；

```
LIKE'_B%' 
```

让您找到包含一个字符的所有内容，然后是“B”。（如“ABERCROMBIE）”。

如果要检索包含“%”或“_”的字符串，可以使用转义字符：

```
LIKE '%#_B%' ESCAPE # 
```

让您找到包含一个“_”后跟一个“B”的任何字符串。（如“TEST_BATMAN”）。

我希望这有帮助。

Al_th

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-27T11:27:03.460

尝试以下**EDITED**：

```
String[] argList = {"'%%%%"+searchtxt.getText().toString()+"%%%%'"};//TRY  THIS
                      ^^^^                                  ^^^^  // TRY THIS

Uri smsUri = Uri.parse("content://sms/inbox");
Cursor c = getContentResolver().query(smsUri, colList, "address LIKE ?", argList, "DATE"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-01-03T00:06:45.927

我的代码中也有这个问题，我花了一段时间才找到正确的答案。对我有用的是@Arushi gupta 在他的回复中写的。

这是我的工作代码，经过调整，用户可以执行 EXACT 搜索查询或搜索包含查询中的单词的值（AND 运算符或 OR 运算符）。我的代码使用了 CursorLoader，但在此示例中与使用 ContentResolver 相同：

```
String selection = myDbContract.myDbEntry.getSelectionForGivenKeywordsAndOperator(requested_keyword, "OR"); //Can write "EXACT" / "AND" / "OR"
return new CursorLoader(this, myQueryUri, MY_TABLE_ELEMENTS, selection, null, null); 
```

这里是dB合约中的选择方法：

```
 public static String getSelectionForGivenKeywordsAndOperator(String keyword_list, String operator) {

            String returnSQLCommand = null;
            if(keyword_list.length()==0) return returnSQLCommand;

            switch (operator) {
                case "EXACT":
                    returnSQLCommand = COLUMN_KEYWORD + "='" + keyword_list + "'";
                    break;
                default: //operator is "AND" or "OR"
                    List<String> keywords = new ArrayList<>();
                    if (keyword_list.contains(" ")) keywords = Arrays.asList(keyword_list.split(" "));
                    else if (keyword_list.contains(",")) keywords = Arrays.asList(keyword_list.split(","));
                    else if (keyword_list.contains(";")) keywords = Arrays.asList(keyword_list.split(";"));
                    else if (keyword_list.contains(".")) keywords = Arrays.asList(keyword_list.split("."));
                    else keywords.add(keyword_list);

                    returnSQLCommand = "'%" + keywords.get(0) + "%'";
                    if (keywords.size()>=1) {
                        returnSQLCommand = COLUMN_KEYWORD + " LIKE '%" + keywords.get(0) + "%'";
                        for (int i = 1; i < keywords.size(); i++) {
                            returnSQLCommand = returnSQLCommand + " " + operator + " " + COLUMN_KEYWORD + " LIKE '%" + keywords.get(i) + "%'";
                        }
                    }
                    break;
            }
            return returnSQLCommand;
        } 
```

我已验证此代码按计划运行，欢迎您试用。

# sql - 如何找到与任何表字段匹配的当前时隙？

> ID：11686498
> 
> 赞同：2
> 
> 时间：2012-07-27T11:04:03.847
> 
> 标签：sql, sql-server, tsql, datetime

我在 DailyAvailability 表中有 34 个布尔字段

```
TimeSlot1, TimeSlot2, .....TimeSlot34 
```

对应34个时隙

```
07:00AM-07:30AM, 07:30AM-08:00AM, .... , 11:30PM-12:00PM 
```

如何获取与当前时间段匹配的记录，例如 3:30PM-4:00PM（需要从`GETDATE()`或 with构建它`DATEDIFF`）

问题是 TimeSlot1 是简单的布尔字段，没有实际映射到时间。

当前查询是

```
SELECT *
FROM DailyAvailability  
WHERE Present  = 1 
    AND AvailDate = LEFT(CONVERT(VARCHAR(20), GETDATE(),120),10) 
    AND ... // TimeSlotX = 1 
```

如何在 WHERE 部分实现最后一个 AND？

动态SQL？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T11:15:59.127

试试这个：

```
select  (((datepart(HOUR,getdate())-6)*2)-1)+
         case when datepart(MI,getdate())>30 then 1 
              else 0 end [timeSlot_number] 
```

此查询将给出当前时隙编号，从上午 7 点到 7:30 开始作为 TimeSlot 1

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T11:41:48.083

如果可能的话，我建议改变你的桌子设计。正如您所发现的，这种结构很难查询。这也是不灵活的。解决这个特定问题只会在以后导致更多问题。

# jquery - 单击按钮获取选择值并执行某些操作

> ID：11686499
> 
> 赞同：6
> 
> 时间：2012-07-27T11:04:06.997
> 
> 标签：jquery, html

```
 <div class="selCont">
        <h2>pick an option</h2>
        <select id="my-dropdown" name="my-dropdown">
            <option value="0">Please Select</option>
            <option value="1">West</option>
            <option value="2">Land</option>
            <option value="3">Easter</option>
            <option value="4">Springtime</option>
            <option value="5">Celtic</option>
            <option value="6">Spectacular/</option>
            <option value="7">Weekend</option>
            <option value="8">Dark</option>
            <option value="9">Treasures</option>
        </select>
        <button class="go-btn" type="submit">
        Go
        </button>
</div> 
```

所以基本上我希望用户能够选择一个选项，并在点击 go 按钮后，让脚本运行并查看下拉列表的值并使用该值将它们发送到相关页面。

我一直在尝试一些事情，但到目前为止它还没有很好地结合在一起。一如既往地感谢任何帮助。

**编辑**

[http://jsfiddle.net/TmfyC/](http://jsfiddle.net/TmfyC/) - 这是我最近在其中一条评论的帮助下尝试的。

****我为可能受益的人使用了什么****

```
$('.go-btn').click(function() {
    window.location = $('#my-dropdown').val();
}); 
```

这就是我最终要做的，然后我将该值分配为我的页面的 url。似乎工作就像一种享受。谢谢你们的帮助。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-27T11:10:47.243

2 件事： http: [//jsfiddle.net/xSyF2/1/](http://jsfiddle.net/xSyF2/1/) **或** [http://jsfiddle.net/xSyF2/](http://jsfiddle.net/xSyF2/)

**代码**

```
$('.go-btn').click(function() {
    var selected = $('#my-dropdown option:selected');
    alert(" If you want text ==>"  + selected.html()); 
});​ 
```

**或者**

```
$('.go-btn').click(function() {
    alert(" If you just want value ==>"  + $('#my-dropdown').val()); 
});​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T11:06:17.090

```
​$('.go-btn').click(function() {
    var selected = $('#my-dropdown option:selected');
    if (selected.length) {
        // Do something with your selection
        alert(selected.val());
    }
});​​​​​​​​​​​​​​​​​​ 
```

[工作 JSFiddle](http://jsfiddle.net/faceleg/TyLDT/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-27T11:08:22.983

这是一个示例，它将获取值并将浏览器重定向到其他页面，其中 id 选择在查询字符串中传递。

```
function doSomething()
{
    var seleciton = parseInt($("#my-dropdown").val());

    if(isNaN(selection) || selection <= 0) // Additional verification
    {
        alert("Please select valid option.");
        return;
    }

    window.location.href = 'http://somewhereelse.com/something?id=' + selection;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-27T11:13:12.730

这是一个使用普通javascript而不是jquery的方法的快速示例。

```
<script type="text/javascript">

    function goToProperPage() {
        var url;
        var location = document.getElementById("my-dropdown").selectedIndex;
        if (location == 1) {
            url = 'http://www.page.com/west';
        }
        else if (location == 2) {
            url = 'http://www.page.com/land';
        }
        window.location.href=url;
    }

</script>

<div class="selCont">
    <h2>pick an option</h2>
    <select id="my-dropdown" name="my-dropdown">
        <option value="0">Please Select</option>
        <option value="1">West</option>
        <option value="2">Land</option>
        <option value="3">Easter</option>
        <option value="4">Springtime</option>
        <option value="5">Celtic</option>
        <option value="6">Spectacular/</option>
        <option value="7">Weekend</option>
        <option value="8">Dark</option>
        <option value="9">Treasures</option>
    </select>
    <button class="go-btn" type="submit" onclick="javascript:goToProperPage();"> Go </button>
</div> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-27T11:09:48.040

我想这应该足够了。

```
$(".go-btn").on('click',function(){
             alert($("#my-dropdown").val());
}); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-27T11:10:37.820

```
$('.go-btn').click(function(){
if($('#my-dropdown').val() == 0 ){
 alert('Please select an option');
return false;

}  
// do what you want here
}); 
```

# css - Mozilla的CSS边界半径

> ID：11686503
> 
> 赞同：3
> 
> 时间：2012-07-27T11:04:25.110
> 
> 标签：css

在#topnav 的边界半径下方的给定页面上，不适用于mozilla，但适用于谷歌浏览器，我使用以下css代码：

[http://www.kbay.in](http://www.kbay.in)

```
#topnav { display:inline-block;float: right; text-align: right; background: #e4f4fe; 
    border:1px solid #e4f4fe;
    border-bottom-color: #e4f4fe;
    border-bottom-width: 4px;
    border-bottom-style: solid; 
    border-radius: 0px 0px 15px 15px; 
    -moz-border-radius-bottomleft: 15px; 
    -moz-border-radius-bottomright: 15px;
    -webkit-border-bottom-right-radius: 15px;
    -webkit-border-bottom-left-radius: 15px;
    margin-right: 90px; margin-top: 0px;
    width:265px;}5E9DC8 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-27T11:14:41.360

新的 Firefox 现在有无前缀版本的`border-radius`.

虽然旧版本是

```
-moz-border-radius-bottomleft: 15px; 
```

你现在必须采取

```
border-bottom-left-radius: 15px; 
```

对于新的 Firefox。这就是为什么您总是必须**最后**声明正式版本的原因（因此不会发生覆盖）。

```
-moz-border-radius-bottomleft: 15px; 
-moz-border-radius-bottomright: 15px;
-webkit-border-bottom-right-radius: 15px;
-webkit-border-bottom-left-radius: 15px;
/*last border-radius declaration has to be the standard one*/
border-radius: 0px 0px 15px 15px; 
```

尽管如此，它仍然应该工作。也许您还有其他一些规则可以覆盖这一规则？（[示例](http://jsfiddle.net/zbpER/)）另外，删除`5E9DC8`你的规则块后面。

顺便说一句，如果您只选择速记符号，那么您是安全的，因为它没有符号差异。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T12:07:58.103

是的，现在，在上一个浏览器版本中，旧前缀（-o、-moz、-webkit）被删除，只需对所有新浏览器（即，opera、chrome 和 firefox）使用“border-radius”，这是[W3C 规范](http://www.w3.org/TR/css3-background/#corners) 但是，对于“旧”浏览器，继续使用旧的 profixes，

现有一个特定网站用于生成 CSS 边界半径代码[就在这里](http://border-radius.com/)。

# c++ - 在全局范围内声明命名空间错误

> ID：11686508
> 
> 赞同：2
> 
> 时间：2012-07-27T11:04:35.170
> 
> 标签：c++, multiple-definition-error

我有 3 个文件 Test.h ， Test.cpp 和 main.cpp

**测试.h**

```
#ifndef Test_H
#define Test_H
 namespace v
{
    int g = 9;;
    }
class namespce
{
public:
    namespce(void);
public:
    ~namespce(void);
};
#endif 
```

**测试.cpp**

```
 #include "Test.h"

namespce::namespce(void)
{
}

namespce::~namespce(void)
{
} 
```

**主文件**

```
#include <iostream>
using namespace std;
#include "Test.h"
//#include "namespce.h"

int main ()
{

    return 0;

} 
```

在构建过程中，它给出了以下错误..

```
1>namespce.obj : error LNK2005: "int v::g" (?g@v@@3HA) already defined in main.obj
1>C:\Users\E543925\Documents\Visual Studio 2005\Projects\viku\Debug\viku.exe : fatal error LNK1169: one or more multiply defined symbols found 
```

请尽快帮助..

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-27T11:09:09.840

这是一个定义：

```
namespace v
{
    int g = 9;
} 
```

在每个文件`main.obj`中都重复`test.obj`了。包含保护仅防止单个翻译单元中的多个包含。`#include "Test.h"``.cpp``#ifndef Test_H`

改成：

```
namespace v
{
    extern int g; // This is now a declaration and extern tells the compiler
                  // that there is definition for g somewhere else.
} 
```

并将以下内容添加到`Test.cpp`：

```
namespace v
{
    int g = 9; // This is now the ONLY definition of 'g', in test.obj.
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-27T11:09:31.513

您只希望`g`每个人都可以访问一个实例吗？在标题中，使用

```
extern int g; // declaration 
```

在 Test.cpp 中，放

```
int v::g = 9; //definition 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-27T11:11:11.453

你有两个选择：

静止的：

```
namespace v
{
    static int g = 9; //different copy of g per translation unit
} 
```

外部：

```
namespace v
{
    extern int g; //share g between units
}

// add initialization to .cpp:
namespace v { int g = 9; } 
```

# python - 如何在 vte.Terminal 中启用透明度

> ID：11686510
> 
> 赞同：5
> 
> 时间：2012-07-27T11:04:53.363
> 
> 标签：python, gtk

我正在使用 vte.Terminal 在 python 中创建一个简单的终端。我想在终端背景中有一定程度的透明度，但 set_opacity 不起作用。但它适用于终结器和其他终端。

window.set_opacity 使整个窗口透明，但我不希望标题蝙蝠透明。这是代码。

```
#!/usr/bin/env python

import vte
import gtk
import pango
import os
import signal

window = gtk.Window(gtk.WINDOW_TOPLEVEL)
window.connect('destroy', lambda w: gtk.main_quit())
# initial window size
window.resize(640, 480)

terminal = vte.Terminal()
terminal.connect("child-exited", lambda w: gtk.main_quit())

# here you can set backscroll buffer
terminal.set_scrollback_lines(5000)
# encoding for console
terminal.set_encoding("UTF-8")
terminal.set_cursor_blinks(False)

# here you can set background image
#terminal.set_background_image_file("some/background/picture/here")

# transparency
terminal.set_opacity (45000)
# font for terminal
font = pango.FontDescription()
font.set_family("Ubuntu Mono")
# font size
font.set_size(11 * pango.SCALE)
font.set_weight(pango.WEIGHT_NORMAL)
font.set_stretch(pango.STRETCH_NORMAL)

terminal.set_font_full(font, True)

child_pid = terminal.fork_command()

scroll = gtk.ScrolledWindow()
scroll.set_policy(0,1)
scroll.add_with_viewport(terminal)

window.add(scroll)
window.show_all()

# This must be here! before gtk.main()
# here you can set columns count (first param)
terminal.set_size(500,0)

try:
    gtk.main()
except KeyboardInterrupt:
    pass 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-05-03T02:42:50.017

下面的代码片段解决了这个问题。

```
colormap = window.get_screen().get_rgba_colormap()
if colormap == None:
    colormap = window.get_screen().get_rgb_colormap()
gtk.widget_set_default_colormap(colormap) 
```

![这就是窗户的样子](../Images/401e1c7d12b1eeda50ae3c7a5c5ce604.png)

尽管我最终在程序中使用了 Vala，并且它有一个名为[set_visual](http://valadoc.org/#!api=gtk+-3.0/Gtk.Widget.set_visual)的简单函数。

希望这可以帮助

# php - preg_match_all 谷歌纬度和经度

> ID：11686512
> 
> 赞同：0
> 
> 时间：2012-07-27T11:04:58.483
> 
> 标签：php, regex, preg-match

我得到以下字符串：

```
a:3:{s:3:"lat";s:17:"49.21103723075132";s:3:"lng";s:18:"22.330280542373657";s:4:"zoom";s:2:"17";} 
```

我想从中得到：

```
49.21103723075132 
```

和

```
22.330280542373657 
```

怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T11:07:01.047

你不需要正则表达式。它是序列化的字符串。反序列化它：

```
$str = 'a:3:{s:3:"lat";s:17:"49.21103723075132";s:3:"lng";s:18:"22.330280542373657";s:4:"zoom";s:2:"17";}';
$deserialized = unserialize($str);
var_dump($deserialized); 
```

输出是：

```
array(3) {
  ["lat"]=>
  string(17) "49.21103723075132"
  ["lng"]=>
  string(18) "22.330280542373657"
  ["zoom"]=>
  string(2) "17"
} 
```

因此，您可以将其作为数组元素访问：`$deserialized['lat']`，`$deserialized['lng']`

# google-maps - 将融合表导出到文本文件

> ID：11686513
> 
> 赞同：0
> 
> 时间：2012-07-27T11:04:58.890
> 
> 标签：google-maps, google-fusion-tables

我在 Google 融合表中有大量数据。如何将其导出到文本文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T11:28:40.790

点击文件：下载。

这会将数据下载为 .csv（逗号分隔值）文件，该文件是文本（但也可以导入到大多数电子表格中）。

# python - Python RegExp 全局标志

> ID：11686516
> 
> 赞同：36
> 
> 时间：2012-07-27T11:05:06.047
> 
> 标签：python, regex, global, flags

python中是否有一个标志或一些特殊键可以多次使用模式。我曾经测试过[http://gskinner.com/RegExr/](http://gskinner.com/RegExr/)我的 RegExp，它在其中正常工作。但是当在正确的环境匹配中进行测试时，只返回*None*。

```
import re
pattern = r"(?P<date>--\d\d-\w+:\d\d)[ \t]+(?P<user>\w+)[ \t]+(?P<method>[\w ]+)[\" ]*    (?P<file>[\w\\:\.]+)@@(?P<version>[\w\\]+)[\" ]*(?P<labels>[\(\w, \.\)]+){0,1}[\s \"]*(?P<comment>[\w \.-]+){0,1}[\"]"
base = """
--02-21T11:22  user3   create version "W:\foo\bar\fooz.bat@@\main\1" (label1, label2,   label3, label22, label33, ...)

"merge in new bat-based fooz installer"

--02-21T11:22  user1   create version "W:\foo\bar\fooz.bat@@\main\0"

--02-21T11:22  user2   create branch "W:\foo\bar\fooz.bat@@\main\"

"merge in new bat-based fooz installer"

--02-13T11:22  user1   create version     "W:\foo\bar\fooz.bat@@\main\1"

  "Made to use new fooz.bat"

"""
r = re.match(pattern, base)
print(r) 
```

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2012-07-27T11:33:06.097

`re.match`尝试匹配字符串开头的模式。您正在寻找`re.search`，`re.findall`或`re.finditer`

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2020-01-18T20:11:13.513

每个 Python 正则表达式匹配函数都可用于不同的目的。

`re.match`总是从字符串的开头开始。

`re.search`从头开始遍历字符串，寻找第一个匹配项。当它找到匹配时它会停止。

`re.findall`返回所有搜索匹配的列表。

在上述所有情况下，如果正则表达式模式中有一个组，那么您返回的项目是完整匹配的元组，然后是每个组匹配，它们按照它们在正则表达式模式中出现的顺序排列。

# python - 比较python中的行元素

> ID：11686519
> 
> 赞同：1
> 
> 时间：2012-07-27T11:05:22.770
> 
> 标签：python, arrays, list, numpy, compare

我们有一个清单：

```
import numpy as np

A=[(2, 2, 0), (1, 5, 0), (6, 8, 0), (2, 2, 2) ]

ax=np.asarray([row[0] for row in A])
ay=np.asarray([row[1] for row in A])
az=np.asarray([row[2] for row in A])

print (ax,ay,az) 
```

我想将 ax 与 ay 进行比较，当我找到 ax==ay 的相等对时，如 (2, 2, 0) 和 (2, 2, 2) 我保留该对一次但添加 az 值。所以在我们的例子中，新的通缉名单 B 将是：

```
B=[(2, 2, 2), (1, 5, 0), (6, 8, 0)] 
```

如果有一些代码对非常大的列表也很有效，那就太好了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T11:07:54.717

字典（或 collections.Counter）比 numpy 数组检查当前项目更快。

因此，如果输出顺序不重要：

```
from collections import Counter
c = Counter()
A = [(2, 2, 0), (1, 5, 0), (6, 8, 0), (2, 2, 2) ]
for a in A:
    c[a[:2]] += a[2]
B = [list(k) + [v] for k,v in c.iteritems()] 
```

`B`就是现在：

```
[[1, 5, 0],  [6, 8, 0], [2, 2, 2]] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T12:22:06.287

**如果顺序不重要**

```
from collections import defaultdict

dd = defaultdict(int)
for x, y, z in A:
    dd[(x,y)] += z
res = [k + (v,) for k, v in dd.iteritems()]
# [(1, 5, 0), (6, 8, 0), (2, 2, 2)] 
```

**如果订单很重要**

```
from operator import itemgetter

d = {}
for idx, (x, y, z) in enumerate(A):
    pos, freq = d.get((x,y), (0,0))
    d[(x,y)] = min(pos, idx), freq + z

res = sorted((k + (v[1],) for k, v in d.iteritems()), key=itemgetter(1, 1))
# [(2, 2, 2), (1, 5, 0), (6, 8, 0)] 
```

# python - 使用 django 数据模型的 MySQL 信息不一致

> ID：11686520
> 
> 赞同：0
> 
> 时间：2012-07-27T11:05:26.527
> 
> 标签：python, mysql, django, multithreading

我一直在努力解决似乎是 Django/MySQL 之间的错误，但可能只是我自己对线程应用程序的细微差别等的误解。

首先，关于我的申请的一些信息。我有一个使用 Django 模型的用 python 编写的多线程应用程序。共有三种不同类型的线程通过使用队列在管道中提供信息。线程一从数据库中拉出一堆对象并将它们放入队列中。下一个线程（主要的主力）将项目从队列中取出并拉出一个 HTTP 请求并将其扔到第三个线程的队列中。第三个线程对 html 进行一些处理并更新一些数据库值。

这是奇怪的部分。我有一个名为“级别”的 mysql 列。第一个线程提取 level = 0 的行。解析 HTTP 响应后，最后一个线程应该更新数据库中 level = 1 的行以及从 HTTP 解析出的所有数据。全速运行时，脚本*说它*每分钟处理大约 1,000 个。但是 level = 1 的行数增加了大约 1/3。这是缓慢进行时问题的一些摘录。

[显示正确输出的程序输出图片](http://i.imgur.com/7WcXX.png)

重要的部分是写着“更新一级条目”的行。末尾的数字显示数据库中级别 1 的行数，后面是工作数据对象的当前“级别”状态。此输出是当它正常运行时。它是由这个代码块产生的：

```
# update our current record to reflect having run here
current.update = datetime.now()
# this prints out the "updating level one" text with debugging information
self.send_message(304, str(Scrape.objects.filter(level=1).count()) + ":" + str(current.level))
current.level = 1
current.save()
# and after saving the information to the db, prints it out again
self.send_message(304, str(Scrape.objects.filter(level=1).count()) + ":" + str(current.level))
self.send_message(308, str(current.asin)) # send out a consuming message 
```

但是，运行一段时间后，我将得到基本相同的输出，除了 level = 1 的对象数量不会增加。这对我来说完全没有意义。如果之前的值是 = 0，现在是 = 1，那么它应该增加 level = 1 条目的数量！

我不相信这仅仅是缓存，更可能是我犯的错误或我正在使用的组件的某种意外行为。来自更有经验的眼睛的任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T21:19:23.017

想通了。这是填充要解析的项目队列的线程中的一个疏忽。它采用了匹配 level = 0 的前 30 个元素，忽略了它们可能已经在队列中但尚未处理的事实。愚蠢的错误太晚了，我猜。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T13:17:21.337

我的直接猜测是交易问题。由于它们在不同的线程中运行，它们将有自己的事务，因此将受到事务隔离。即使进行更新的线程提交了它的事务并开始了一个新事务，输出计数的线程也不一定会看到该更新，直到它也开始一个新事务。

# php - $_SERVER['REQUEST_METHOD'] 默认为 'GET'

> ID：11686521
> 
> 赞同：4
> 
> 时间：2012-07-27T11:05:28.977
> 
> 标签：php, http-post, http-get

对此进行了一些挖掘，但是，没有运气找到信息

`GET`我正在尝试检查是否已提交表单以及是否已提交`POST`。所以基本上我使用：

```
if($_SERVER['REQUEST_METHOD'] == 'GET') 
```

或者

```
if($_SERVER['REQUEST_METHOD'] == 'POST') 
```

但是，我发现如果我不提交任何表单，直接进入页面——一个简单的 HTTP 请求，`REQUEST_METHOD`就是`GET`. 是什么赋予了？这是设计使然吗？如果是这样，那么我不能使用前面的语句来检查表单是否已通过 GET 提交。好像有点多余……

请有更多知识的人向我解释一下，将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-27T11:11:18.147

基本上大多数 HTTP 请求都是 GET 请求。

您可以使用`if($_POST)`它来检查它是否是 POST。（这是其中包含 POST 数据的数组。所有页面都已`$_GET`设置，因此`if($_GET)`无法判断它是否为 GET）

但是，`if(count($_GET)>0)`会告诉你是否有 $_GET 数据。

不过，您可以同时拥有 POST 和 GET 数据，方法是向其中包含 GET 数据的 URL 发送 POST 请求（即`http://example.unreal?GetData=4&OtherData=no`）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-27T11:11:27.210

只需通过浏览器访问一个页面或单击一个链接就是一个 GET 请求。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-01-20T00:52:05.773

我遇到了同样的问题并通过这个解决：当表单操作设置为时`iprofile?r=search`，请求方法始终是 GET 并且表单中的所有输入数据都丢失了。但是当我将操作设置为 时`iprofile/?r=search`，请求方法变为 POST。

也许您还可以检查您的操作 URL。

# postgresql - Mountain Lion Postgres 无法连接

> ID：11686526
> 
> 赞同：11
> 
> 时间：2012-07-27T11:05:39.773
> 
> 标签：postgresql, postgresql-9.1, osx-mountain-lion

在我更新到山狮后，我的 postgres 不起作用。它仍在运行，但我的应用程序无法再连接到它。

```
$ ps aux | grep postgres
postgres         204   0.0  0.0  2446960    836   ??  Ss    7:31AM   0:00.59 postgres: stats collector process    
postgres         203   0.0  0.1  2478732   2240   ??  Ss    7:31AM   0:00.41 postgres: autovacuum launcher process    
postgres         202   0.0  0.0  2478600    584   ??  Ss    7:31AM   0:00.34 postgres: wal writer process    
postgres         201   0.0  0.0  2478600    784   ??  Ss    7:31AM   0:00.48 postgres: writer process    
postgres          95   0.0  0.0  2446960    368   ??  Ss    7:31AM   0:00.11 postgres: logger process    
postgres          64   0.0  0.2  2478600   7972   ??  Ss    7:31AM   0:00.26 /Library/PostgreSQL/9.1/bin/postmaster -D/Library/PostgreSQL/9.1/data
anezio         10205   0.0  0.0  2432768    624 s000  R+    8:01AM   0:00.00 grep postgres 
```

我的应用程序返回此错误：

```
could not connect to server: No such file or directory
Is the server running locally and accepting
connections on Unix domain socket "/var/pgsql_socket/.s.PGSQL.5432"? 
```

我仍然可以使用命令 /Library/PostgreSQL/9.1/bin/psql -U postgres 连接到 psql

似乎有些东西没有指向正确的地方

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-27T13:39:27.233

我只是有同样的问题。就我个人而言，我刚刚从 Postgres 安装程序（在我的情况下为 postgresql-9.1.3-1-osx.dmg）重新安装，重新启动了我的 mac，一切都很好。ps 重新安装并没有破坏我的数据库:)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-02T23:52:52.840

检查`psql`您正在使用哪个。[我在使用 Heroku 的Postgres.app](http://postgresapp.com/)服务器时遇到了同样的问题，发现我使用的是`/usr/bin/psql`基于我的`$PATH`设置的 Apple 客户端。将您设置`$PATH`为使用 Postgres 库或使用已安装`psql`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-27T13:02:30.723

默认的 Unix 域套接字路径在 libpq 中硬编码。可能发生的情况是，在升级之前，您的应用程序使用了由 Postgres 一键式安装程序安装的 libpq 库，而在升级之后，该库的不同版本被拾取。

要解决这个问题，从程序员的角度来看，您可以指定套接字目录而不是依赖默认值。如果您还不知道正确的目录，请以超级用户（通常是 postgres）连接到任何数据库并在 SQL 中发出：

```
SHOW unix_socket_directory; 
```

然后使用在连接调用的主机字段中获得的路径更改或重新配置您的应用程序（例如在连接字符串中：）`host=/path/to/socket dbname=d user=u`。Libpq 会将其识别为 unix 套接字目录，因为它以斜杠开头，而不是主机名或 IP 地址。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-08-10T21:22:56.400

不知何故，我完全忘记了这个套接字文件会因为点而被隐藏。`ls -A /tmp/.s.PGSQL.5432`如果您正在检查套接字是否确实存在，请确保使用。

执行以下操作后，我的 postgres 应用程序开始再次接受来自 psql 的连接。我认为这与第 3 步有关。

1.  退出 postgres 应用程序。
2.  在终端类型`postgres -D ~/Library/Application\ Support/Postgres/var`中。如果您使用的是 postgres 应用程序，这是数据目录。如果您不使用 postgres 应用程序，则需要找出数据目录的真正含义。
3.  我收到来自 OS X 的提示，询问我是否要允许传入流量。我点击是。
4.  在不同的终端选项卡类型`psql`中。您应该成功连接。
5.  键入`\q`以退出 psql。
6.  回到运行 postgres 的选项卡上，键入`ctrl c`停止 postgres。
7.  启动 postgres 应用程序。psql 应该可以工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-06-26T00:43:09.590

我已经通过卸载并重新安装它解决了这个问题

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-07-03T14:00:49.000

问题是山狮有它自己的 psql 客户端 (/usr/bin/psql)，它显然试图通过在与安装程序不同的位置搜索本地套接字文件来连接 postgres。您可以更改您的 PATH 变量以首先包含您的 postgres bin 文件夹，或者将默认的 /usr/bin/psql 替换为您安装的那个。

# ruby-on-rails - 同一模型上的多对多和一对一关联

> ID：11686527
> 
> 赞同：0
> 
> 时间：2012-07-27T11:05:42.317
> 
> 标签：ruby-on-rails, activerecord, associations

我可以让它在 Rails 控制台中工作，只是可以弄清楚如何实现代码。

使用 HABTM 关联，​​一个用户可以在多个团队中，一个团队可以有多个用户。但是一个团队由一个用户拥有，一个用户只能拥有一个团队。

如何做到这一点，以便在创建团队（有效）时，我也可以关联一对一的关系？

我在使用 set_user_on_team 方法中的代码时遇到问题。它目前产生 2 个团队记录，第二个具有所有正确的关联，第一个只是将用户作为团队成员。

```
1.9.3p194 :005 > Team.all
Team Load (0.2ms)  SELECT "teams".* FROM "teams" 
=> [#<Team id: 1, name: "username", dept_no: nil, created_at: "2012-07-27 12:19:00", updated_at: "2012-07-27 12:19:00", user_id: nil>, #<Team id: 2, name: "username", dept_no: nil, created_at: "2012-07-27 12:19:00", updated_at: "2012-07-27 12:19:00", user_id: 1>] 
1.9.3p194 :006 > user.teams
Team Load (0.1ms)  SELECT "teams".* FROM "teams" INNER JOIN "teams_users" ON "teams"."id" = "teams_users"."team_id" WHERE "teams_users"."user_id" = 1
=> [#<Team id: 1, name: "username", dept_no: nil, created_at: "2012-07-27 12:19:00", updated_at: "2012-07-27 12:19:00", user_id: nil>, #<Team id: 2, name: "username", dept_no: nil, created_at: "2012-07-27 12:19:00", updated_at: "2012-07-27 12:19:00", user_id: 1>] 
1.9.3p194 :007 > user.team
=> #<Team id: 2, name: "username", dept_no: nil, created_at: "2012-07-27 12:19:00", updated_at: "2012-07-27 12:19:00", user_id: 1> 
```

1.9.3p194:008 >

我已经能够在 Rails 控制台中实现这一点，如下所示：

```
1.9.3p194 :001 > user = User.first
User Load (0.1ms)  SELECT "users".* FROM "users" LIMIT 1
=> #<User id: 1, email: "test@example.com", encrypted_password: "$2a$10$MiVSB4RuFL5ubagq7YLgA.NEk9AY.uHBz.i6pfebRJgC...", reset_password_token: nil, reset_password_sent_at: nil, remember_created_at: nil, sign_in_count: 1, current_sign_in_at: "2012-07-27 11:26:11", last_sign_in_at: "2012-07-27 11:26:11", current_sign_in_ip: "127.0.0.1", last_sign_in_ip: "127.0.0.1", created_at: "2012-07-27 11:26:11", updated_at: "2012-07-27 11:26:11"> 
1.9.3p194 :002 > user.teams
Team Load (0.1ms)  SELECT "teams".* FROM "teams" INNER JOIN "teams_users" ON "teams"."id" = "teams_users"."team_id" WHERE "teams_users"."user_id" = 1
=> [#<Team id: 1, name: "username", dept_no: nil, created_at: "2012-07-27 11:26:11", updated_at: "2012-07-27 11:26:11", user_id: nil>, #<Team id: 2, name: "username", dept_no: nil, created_at: "2012-07-27 11:26:11", updated_at: "2012-07-27 11:26:11", user_id: nil>] 
1.9.3p194 :003 > user.team
Team Load (0.2ms)  SELECT "teams".* FROM "teams" WHERE "teams"."user_id" = 1 LIMIT 1
=> nil 
1.9.3p194 :004 > team = User.first.teams.first
User Load (0.2ms)  SELECT "users".* FROM "users" LIMIT 1
Team Load (0.1ms)  SELECT "teams".* FROM "teams" INNER JOIN "teams_users" ON "teams"."id" = "teams_users"."team_id" WHERE "teams_users"."user_id" = 1 LIMIT 1
=> #<Team id: 1, name: "username", dept_no: nil, created_at: "2012-07-27 11:26:11", updated_at: "2012-07-27 11:26:11", user_id: nil> 
1.9.3p194 :005 > user.team = team
(0.1ms)  SAVEPOINT active_record_1
(0.4ms)  UPDATE "teams" SET "user_id" = 1, "updated_at" = '2012-07-27 11:27:41.948931' WHERE "teams"."id" = 1
(0.0ms)  RELEASE SAVEPOINT active_record_1
=> #<Team id: 1, name: "username", dept_no: nil, created_at: "2012-07-27 11:26:11", updated_at: "2012-07-27 11:27:41", user_id: 1> 
1.9.3p194 :006 > team.user
User Load (0.2ms)  SELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1
=> #<User id: 1, email: "test@example.com", encrypted_password: "$2a$10$MiVSB4RuFL5ubagq7YLgA.NEk9AY.uHBz.i6pfebRJgC...", reset_password_token: nil, reset_password_sent_at: nil, remember_created_at: nil, sign_in_count: 1, current_sign_in_at: "2012-07-27 11:26:11", last_sign_in_at: "2012-07-27 11:26:11", current_sign_in_ip: "127.0.0.1", last_sign_in_ip: "127.0.0.1", created_at: "2012-07-27 11:26:11", updated_at: "2012-07-27 11:26:11"> 
1.9.3p194 :007 > 
```

用户.rb

```
class User < ActiveRecord::Base

  has_and_belongs_to_many :teams
  has_one :team

  after_save :set_user_on_team

  private

    def set_user_on_team
      users_team = teams.create(:name => 'username' ) 
      self.team = users_team
   end
end 
```

我尝试了以下代码，它也产生了团队记录

```
def set_user_on_team
      self.team = teams.create(:name => 'username' ) 
end 
```

团队.rb

```
class Team < ActiveRecord::Base

  attr_accessible :name
  has_and_belongs_to_many :users
  belongs_to :user

end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T11:13:45.563

加入一个团队和拥有一个团队是两种不同的关系，所以给他们不同的名字，你会没事的：

```
class Team < ActiveRecord::Base
  has_and_belongs_to_many :users
  belongs_to :owner, :class_name => "User"
end

class User < ActiveRecord::Base
  has_and_belongs_to_many :teams
  has_one :owned_team, :class_name => "Team"
end 
```

# c# - 参数字典包含不可为空类型的参数“id”的空条目

> ID：11686528
> 
> 赞同：3
> 
> 时间：2012-07-27T11:05:43.053
> 
> 标签：c#, asp.net-mvc, routes, actionresult

我正在尝试通过`id`默认路由中的参数从我的数据库中检索数据：

```
routes.MapRoute(
            "Default", // Route name
            "{controller}/{action}/{id}", // URL with parameters
            new { controller = "Home", action = "Index", id = UrlParameter.Optional } // Parameter defaults
        ); 
```

在此 ActionResult 中，我尝试根据路由 id 参数呈现自定义用户控件，以便检索所请求页面的相关数据

```
public ActionResult InitPageNav(int id)
{
      PageModel page = PageNavHelper.GetPageByID(id);
      return PartialView("UserControls/_PageNavPartial", page);
} 
```

编辑*

```
public static MvcHtmlString CreateMenuItems(this HtmlHelper helper, string action, string text)
{
     var menuItem = new TagBuilder("li");
     var link = new TagBuilder("a");

     //Get current action from route data
     var currentAction = (string)helper.ViewContext.RouteData.Values["action"];
     link.Attributes.Add("href", string.Format("/Home/{0}", action));

     if (currentAction == action)
     {
         menuItem.AddCssClass("selected");
         link.Attributes.Remove("href");
         link.Attributes.Add("href", string.Format("/Home/{0}", currentAction.ToString()));
     }

     link.SetInnerText(text);
     menuItem.InnerHtml = link.ToString();

     return MvcHtmlString.Create(menuItem.ToString());
 } 
```

但我不断收到错误：

`The parameters dictionary contains a null entry for parameter 'id' of non-nullable type`

谁能发现我哪里出错了？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-27T11:18:06.413

要调用该操作，URL 中需要一个整数，如下所示：/Home/InitPageNav/1

要么，要么您更改操作方法以允许可为空的整数（但这没有意义，除非您有一个默认页面，如果没有给出 id 则可以检索？）。

如果您不想在 url 中使用页面 id，则需要其他内容来标识页面，例如标题？

```
routes.MapRoute(
            "Default", // Route name
            "{controller}/{action}/{title}", // URL with parameters
            new { controller = "Home", action = "Index", title = UrlParameter.Optional } // Parameter defaults
        ); 
```

和行动：

```
public ActionResult InitPageNav(String title)
{
      PageModel page = PageNavHelper.GetPageByTitle(title);
      return PartialView("UserControls/_PageNavPartial", page);
} 
```

只需确保处理 title 参数为空/null 的情况。通常，您应该使用 Mvc 框架中已经存在的帮助程序/扩展来构建您的 url。

```
@Html.ActionLink("Link text", "action", "controller", new { title = "whatever" }, null) 
```

或在您更高级的助手中，

```
public static MvcHtmlString CreateMenuItems(this UrlHelper url, string action, string text)
{
     var menuItem = new TagBuilder("li");
     var link = new TagBuilder("a");

     //Get current action from route data
     var currentAction = (string)helper.RequestContext.RouteData.Values["action"];
     link.Attributes.Add("href", url.Action(action, "home", new { title = "whatever" }));

     if (currentAction == action)
     {
         menuItem.AddCssClass("selected");
     }

     link.SetInnerText(text);
     menuItem.InnerHtml = link.ToString();

     return MvcHtmlString.Create(menuItem.ToString());
 } 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-27T11:21:01.167

如果 ASP .NET MVC 框架引发异常/错误，则此异常的原因是**HTTP 请求上没有传递 'id' 参数**。

尝试将操作方法​​签名重新定义为以下内容：

```
 public ActionResult InitPageNav(int? id) //id is now a nullable int type
    {
          if(!id.HasValue) //id parameter is set ?
          {
                //return some default partial view or something 
          }

          PageModel page = PageNavHelper.GetPageByID(id);
          return PartialView("UserControls/_PageNavPartial", page);
    } 
```

编辑：如果您认为将 id 参数类型更改为“字符串”更有用，那么您只需更改操作方法签名。

# c# - 如何从 C# 中的 SQL 查询结果填充类？

> ID：11686530
> 
> 赞同：13
> 
> 时间：2012-07-27T11:05:43.753
> 
> 标签：c#, sql-server, database, winforms, orm

我有这样的课：

```
public class Product
{
    public int ProductId { get; private set; }
    public int SupplierId { get; private set; }

    public string Name { get; private set; }
    public decimal Price { get; private set; }
    public int Stock { get; private set; }
    public int PendingStock { get; private set; }
} 
```

我可以像这样从我的数据库中获取这些详细信息：

```
SELECT product_id, supplier_id, name, price, total_stock, pending_stock 
FROM products
WHERE product_id = ? 
```

我不想手动运行`DataSet`或`DataTable`设置值。

我确信有一种方法可以使用某种绑定/映射机制来填充类，但我能找到的唯一东西是绑定到 winforms 组件或使用 XAML。

是否有某种属性可以应用于我的属性/类以使该类从查询行中自动填充？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-07-27T12:27:07.957

我决定提出另一个答案，它实际上是对 Alex 提供的答案的扩展（所以所有的功劳都归于他），但是为了 column-name-2-property-name 映射，它引入了属性。

首先需要自定义属性来保存列名：

```
[AttributeUsage(AttributeTargets.Property, Inherited = true)]
[Serializable]
public class MappingAttribute : Attribute
{
    public string ColumnName = null;
} 
```

该属性必须应用于要从数据库行填充的类的那些属性：

```
public class Product
{
    [Mapping(ColumnName = "product_id")]
    public int ProductId { get; private set; }

    [Mapping(ColumnName = "supplier_id")]
    public int SupplierId { get; private set; }

    [Mapping(ColumnName = "name")]
    public string Name { get; private set; }
    [Mapping(ColumnName = "price")]
    public decimal Price { get; private set; }
    [Mapping(ColumnName = "total_stock")]
    public int Stock { get; private set; }
    [Mapping(ColumnName = "pending_stock")]
    public int PendingStock { get; private set; }
} 
```

其余的都按照 Alex 的建议进行，只是该属性用于检索列名：

```
T MapToClass<T>(SqlDataReader reader) where T : class
{
        T returnedObject = Activator.CreateInstance<T>();
        PropertyInfo[] modelProperties = returnedObject.GetType().GetProperties();
        for (int i = 0; i < modelProperties.Length; i++)
        {
            MappingAttribute[] attributes = modelProperties[i].GetCustomAttributes<MappingAttribute>(true).ToArray();

            if (attributes.Length > 0 && attributes[0].ColumnName != null)
                modelProperties[i].SetValue(returnedObject, Convert.ChangeType(reader[attributes[0].ColumnName], modelProperties[i].PropertyType), null);
        }
        return returnedObject;
} 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-07-27T11:13:03.433

您需要自己映射属性或使用 ORM（对象关系映射器）。

Microsoft 提供[Entity Framework](http://msdn.microsoft.com/en-us/data/ef.aspx)，但[Dapper](https://github.com/SamSaffron/dapper-dot-net)需要较少的开销，并且根据您的要求可能是一个可行的选择。

在您的情况下，Dapper 代码如下所示：

```
var query = @"SELECT product_id, supplier_id, name, price, total_stock, pending_stock 
FROM products
WHERE product_id = @id";

var product = connection.Query<Product>(query, new { id = 23 }); 
```

为了完整起见，重要的是要指出我在这里谈论的是 Dapper，因为问题涉及将 SQL 结果映射到对象。EF 和 Linq to SQL 也会这样做，但它们也会做一些额外的事情，比如将 Linq 查询转换为 SQL 语句，这也可能很有用。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-07-27T11:30:43.597

如果您不想利用 ORM 框架（实体框架等），您可以手动完成：

```
T MapToClass<T>(SqlDataReader reader) where T : class
{
        T returnedObject = Activator.CreateInstance<T>();
        List<PropertyInfo> modelProperties = returnedObject.GetType().GetProperties().OrderBy(p => p.MetadataToken).ToList();
        for (int i = 0; i < modelProperties.Count; i++)
            modelProperties[i].SetValue(returnedObject, Convert.ChangeType(reader.GetValue(i), modelProperties[i].PropertyType), null);
        return returnedObject;
} 
```

你像这样使用它：

```
Product P = new Product(); // as per your example
using(SqlDataReader reader = ...)
{
while(reader.Read()) { P = MapToClass<Product(reader); /* then you use P */ }
} 
```

唯一需要注意的是查询中字段的顺序（它必须与您的类中定义的属性的顺序相匹配）。

您需要做的就是构建类，编写查询，然后它将处理“映射”。

**警告**我经常使用这种方法，从来没有遇到过任何问题，但**它不适用于部分类**。如果您使用部分模型，那么无论如何使用 ORM 框架会好得多。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-27T11:11:40.003

我会使用 Linq to SQL 并按如下方式执行：

```
public class Product
{
    public int ProductId { get; private set; }
    public int SupplierId { get; private set; }
    public string Name { get; private set; }
    public decimal Price { get; private set; }
    public int Stock { get; private set; }
    public int PendingStock { get; private set; }

    public Product(int id)
    {
        using(var db = new MainContext())
        {
            var q = (from c in product where c.ProductID = id select c).SingleOrDefault();
            if(q!=null)
                LoadByRec(q);           
        }
    }
    public Product(product rec)
    {
        LoadByRec(q);
    }
    public void LoadByRec(product rec)
    {
        ProductId = rec.product_id;
        SupplierID = rec.supplier_id;
        Name = rec.name;
        Price = rec.price;
        Stock = rec.total_stock;
        PendingStock = rec.pending_stock;
    }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-06-10T08:54:41.567

一种可能的解决方案：

在 SQL 查询中，您可以使用[“PATH Mode with FOR XML”](http://msdn.microsoft.com/en-us/library/bb510462.aspx)子句。

查询的结果将是一个 XML，您可以将其[直接反序列化为 C# 对象](https://stackoverflow.com/questions/9257746/deserialize-xml)。

它也适用于大型嵌套 SQL 查询。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-07-27T11:23:42.740

默认情况下，原始 .NET Framework 中没有此类功能。您可以使用实体框架，但如果它对您来说不是一个好的解决方案，那么另一种选择是反射机制。

1.  创建一些自定义属性类，该类可以为类的每个公共属性保存一个列名。

2.  从数据库中检索记录后，实例化一个`Product`类对象并枚举属性。对于具有您自定义属性的每个属性 - 用于`SetValue`根据`PropertyInfo`自定义属性中定义的列名称更改值。

考虑以下因素：

*   解决方案对于简单的任务来说是相当且开销的；仅当您有许多表和许多类时才有意义`Product`-并且希望编写一个代码来自动初始化所​​有这些
*   反射本身就是一种开销 - 所以从长远来看需要一些缓存

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-07-27T11:07:29.723

然后你应该使用实体框架或 Linq To SQL，如果你不想使用它，那么你需要自己映射/填充它

有关实体框架的更多信息 [http://msdn.microsoft.com/en-us/data/ef.aspx](http://msdn.microsoft.com/en-us/data/ef.aspx)

有关 Linq to SQL 的更多信息 [http://msdn.microsoft.com/en-us/library/bb386976.aspx](http://msdn.microsoft.com/en-us/library/bb386976.aspx)

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2016-07-29T12:31:39.483

```
select 'public ' + case DATA_TYPE  
when 'varchar' then 'string'
when 'nvarchar' then 'string'
when 'DateTime' then 'DateTime'
when 'bigint' then 'long' 
else DATA_TYPE end +' '+ COLUMN_NAME + ' {get; set;}' 
from INFORMATION_SCHEMA.COLUMNS  WHERE TABLE_NAME ='YOUR TABLE NAME'  ORDER BY ORDINAL_POSITION 
```

# gwt - 为什么在尝试升级 GWT 包时出现 java.lang.NoClassDefFoundError？

> ID：11686531
> 
> 赞同：1
> 
> 时间：2012-07-27T11:05:50.963
> 
> 标签：gwt

当我尝试将我的项目从 GWT-2.1.0 升级到 GWT-2.4.0 时，我遇到了以下异常，我对此毫无意义。

```
java.lang.NoClassDefFoundError:
com/google/gwt/user/server/rpc/SerializationPolicyProvider 
```

经过一番搜索，我发现这可能与 .jar 有关`gwt-servlet.jar`，但是这个 jar 正确地位于其中，`web-inf/lib`并且毕竟这个类`gwt-user`也在其中。

有没有人解决过类似的问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T20:54:45.967

它适用于我，包括使用 ant 的以下类路径：

```
<path id="compile.classpath">
    <fileset dir="${gwt.home}">
        <include name="**/gwt-user.jar" />
        <include name="**/gwt-dev.jar" />
        <include name="**/validation*.jar" />
    </fileset>
</path> 
```

# java - 如何更改 JTable 标题高度？

> ID：11686535
> 
> 赞同：16
> 
> 时间：2012-07-27T11:06:06.717
> 
> 标签：java, swing, jtable, jtableheader, preferredsize

标题解释了问题。我怎样才能轻松做到这一点？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-07-27T11:20:19.813

![在此处输入图像描述](../Images/535ed19e5b73ab495f9cd0643ecd6e88.png)

```
import java.awt.*;
import java.awt.event.*;
import java.util.List;
import java.util.Arrays;
import javax.swing.*;
import javax.swing.table.*;

public class TableHeaderHeightTest {
  private static int HEADER_HEIGHT = 32;
  private JTable makeTable() {
    JTable table = new JTable(new DefaultTableModel(2, 20));
    table.setAutoResizeMode(JTable.AUTO_RESIZE_OFF);
    return table;
  }
  public JComponent makeUI() {
    JPanel p = new JPanel(new GridLayout(2,1));

    JTable table1 = makeTable();
    //Bad: >>>>
    JTableHeader header = table1.getTableHeader();
    //Dimension d = header.getPreferredSize();
    //d.height = HEADER_HEIGHT;
    //header.setPreferredSize(d); //addColumn case test
    header.setPreferredSize(new Dimension(100, HEADER_HEIGHT));
    p.add(makeTitledPanel("Bad: JTableHeader#setPreferredSize(...)", new JScrollPane(table1)));
    //<<<<

    JTable table2 = makeTable();
    JScrollPane scroll = new JScrollPane(table2);
    scroll.setColumnHeader(new JViewport() {
      @Override public Dimension getPreferredSize() {
        Dimension d = super.getPreferredSize();
        d.height = HEADER_HEIGHT;
        return d;
      }
    });
//         //or
//         table2.setTableHeader(new JTableHeader(table2.getColumnModel()) {
//             @Override public Dimension getPreferredSize() {
//                 Dimension d = super.getPreferredSize();
//                 d.height = HEADER_HEIGHT;
//                 return d;
//             }
//         });
    p.add(makeTitledPanel("Override getPreferredSize()", scroll));

    final List<JTable> list = Arrays.asList(table1, table2);

    JPanel panel = new JPanel(new BorderLayout());
    panel.add(p);
    panel.add(new JButton(new AbstractAction("addColumn") {
      @Override public void actionPerformed(ActionEvent e) {
        for(JTable t: list) {
          t.getColumnModel().addColumn(new TableColumn());
          JTableHeader h = t.getTableHeader();
          Dimension d = h.getPreferredSize();
          System.out.println(d);
        }
      }
    }), BorderLayout.SOUTH);
    panel.setBorder(BorderFactory.createEmptyBorder(5,5,5,5));
    return panel;
  }
  private static JComponent makeTitledPanel(String title, JComponent c) {
    JPanel p = new JPanel(new BorderLayout());
    p.add(c);
    p.setBorder(BorderFactory.createTitledBorder(title));
    return p;
  }
  public static void main(String[] args) {
    EventQueue.invokeLater(new Runnable() {
      @Override public void run() {
        createAndShowGUI();
      }
    });
  }
  public static void createAndShowGUI() {
    JFrame f = new JFrame();
    f.setDefaultCloseOperation(WindowConstants.EXIT_ON_CLOSE);
    f.getContentPane().add(new TableHeaderHeightTest().makeUI());
    f.setSize(320, 320);
    f.setLocationRelativeTo(null);
    f.setVisible(true);
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-11-27T09:30:42.930

尝试这个.....

```
if jtable attached to scrollpane 
  then 
table.getTableHeader().setPreferredSize(
     new Dimension(scrollpane.getwidth(),height)
);

else
  table.getTableHeader().setPreferredSize(
     new Dimension(width,height)
); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-07-07T20:30:15.340

```
Font bigFont = new Font("sansserif", Font.PLAIN, 24); // or whatever
myTable.getTableHeader().setFont(bigFont); 
```

这是增加TableHeader 的preferredSize 的简单方法。它会增加标题的高度，但如果你的列名太长，那么它们可能不适合宽度。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-06-15T14:00:58.370

而不是覆盖 JViewport.getPreferredSize 就像在 aterai 答案中，您可以设置首选宽度。

```
JScrollPane scroll = new JScrollPane(table2);
scroll.getColumnHeader().setPreferredSize(new Dimension(0, HEADER_HEIGHT)); 
```

JScrollPane 忽略列标题宽度，因此您可以在此处安全地设置为零。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-05-30T23:34:15.580

尝试这个

```
JTableHeader th = table.getTableHeader();
th.setPreferredSize(new Dimension(100, 100)); 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-01-11T02:04:14.777

您还可以在设置首选标题尺寸时使用非常大的宽度，该尺寸会根据列模型中所需的宽度进行截断。

```
tableHeader.setPreferredSize(new Dimension(10000, HEADER_HEIGHT)); 
```

# android - Android：从 MSSQL 检索图像

> ID：11686537
> 
> 赞同：1
> 
> 时间：2012-07-27T11:06:13.287
> 
> 标签：android, sql-server, database, bitmap, bitmapfactory

我是 Android 新手，尝试从 MSSQL 获取图像并将其设置为背景。

```
 CallableStatement proc = null;                 
                 String temp2 ="{ call AndroidDB.dbo.getStocks("+ temp +")}";
                 proc = MainActivity.conn.prepareCall(temp2);
                 ResultSet rs = proc.executeQuery();
                 Bitmap bitmap= null;
                 byte[] blob =null;
                 for (int i = 0,j=0; rs.next(); i++ ) {
                    if(i%3==0){
                        layout_stocks_h.add(new LinearLayout(this));
                        (layout_stocks_h.get(j)).setOrientation(LinearLayout.HORIZONTAL);
                        LinearLayout.LayoutParams lp = new LinearLayout.LayoutParams(LinearLayout.LayoutParams.FILL_PARENT, LinearLayout.LayoutParams.WRAP_CONTENT); // Verbose!
                        lp.weight = 1.0f;
                        (layout_stocks_h.get(j)).setLayoutParams(lp);
                        layout_stocks_v.addView((layout_stocks_h.get(j)));
                        (layout_stocks_h.get(j)).setId(200+(j));
                        j++;                    
                }
                imagebutton_stocks.add(new ImageButton(this));

                blob = rs.getBytes("stokresim");
                ByteArrayInputStream imageStream = new ByteArrayInputStream(blob);
                bitmap = BitmapFactory.decodeStream(imageStream);
                imagebutton_stocks.get(i).setImageBitmap(bitmap);

                imagebutton_stocks.get(i).setLayoutParams(new LayoutParams(LayoutParams.WRAP_CONTENT,LayoutParams.WRAP_CONTENT));
                layout_stocks_h.get(j-1).addView(imagebutton_stocks.get(i));
                imagebutton_stocks.get(i).setId(250+i);
                imagebutton_stocks.get(i).setOnClickListener(this);
                noOfStocks = i; 
```

我也尝试过使用：

```
bitmap =  BitmapFactory.decodeByteArray(blob , 0, blob.length); 
```

但是，没有任何效果，我的程序正常工作并创建了正确数量的按钮但没有图像。

我将图像文件作为图像存储在 MSSQL 中并尝试了 varbinary(MAX)

提前致谢

# jquery - 如何创建带有确认警报框的struts jquery链接？

> ID：11686540
> 
> 赞同：0
> 
> 时间：2012-07-27T11:06:31.440
> 
> 标签：jquery, struts2, hyperlink, struts, alert

我想创建`<sj:a></sj:a>`点击后将显示第一个确认对话框的链接。

我试过了，`<sj:dialog>`但它不起作用。你能帮助我吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-07-27T16:36:58.247

```
sj:a 
    id="ajaxlink" 
    href="%{'#'}" 
    indicator="indicator" 
    onClickTopics="before" 
    button="true" 
    >
      click me
    </sj:a>

$.subscribe('before', function(event,data) {
   //do your condition check here
   if(condition){
       window.location="yourLocation";
   }
}); 
```

# objective-c - Apple LLVM 编译器 4.0 在打印 XML (NSLog) 时冻结 xcode 和应用程序

> ID：11686547
> 
> 赞同：2
> 
> 时间：2012-07-27T11:07:03.773
> 
> 标签：objective-c, xml, nslog, xcode4.4, llvm-4.0

我更新了 xcode 4.4（使用 Apple LLVM 编译器 4.0），从那时起，当我尝试在控制台中打印 XML 时，xcode 和应用程序（在模拟器中）会阻止用户交互......我需要等待 30 秒或更长时间才能完成（我可以'什么都不做）

我正在使用 AFNetworking 和 TBXML，但问题不在解析中，因为如果我删除解析，问题还会继续。

所以我尝试了 NSOperationQueue、NSBlockOperation、grand dispatch central ......什么也没有，仍然冻结。

是因为 XML 太大了？？？（...我需要打印 XML 来调试和测试东西）

**1º 请求和打印 XML**

```
- (void) doRequestPOST:(NSString*)URL params:(NSString*)params withSuccess:(void(^)(BOOL,id))successBlock{

(....)

AFHTTPRequestOperation *op = [sharedAPI HTTPRequestOperationWithRequest:request success:^(AFHTTPRequestOperation *operation, id responseObject) {

            NSString* xml = [[NSString alloc] initWithData:responseObject encoding:NSUTF8StringEncoding];

            //>>>>>PROBLEM HERE<<<<< if i remove next line (nslog) the problem does not occur
            NSLog(@"\n\nResponse \nURL :\n%@\nXML :\n%@\n \n",operation.request.URL,xml);
            [xml release];

            TBXML * tbxml = [TBXML newTBXMLWithXMLData:responseObject error:nil];
            [self saveCookiesFromHTTPHeaderFields:[operation response] withTBXML:tbxml.rootXMLElement];

            if (successBlock) {
                successBlock(TRUE,responseObject);
            }
} 
```

**2º 将请求请求并解析** 来自“successBlock(TRUE,responseObject);”的响应

```
[self doRequestPOST:stringURL params:nil withSuccess:^(BOOL success, id response) {

        if (success) {

            //will parse response

            [self.dictionaryCategoryContents setObject:[Parser parseVodContent:response] forKey:idCategory];
            if (responseBlock){
                responseBlock (YES,[dictionaryCategoryContents objectForKey:idCategory]);
            }

        }else {

            if (responseBlock){
                responseBlock (NO,response);
            }
        }
    }]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-01T03:13:22.283

我目前遇到同样的问题。每当我 NSLog 一个大字符串时，我只会看到 XCode 和模拟器挂起（沙滩球）。但如果我等待 2-3 分钟，该应用程序将继续运行。

XCode 4.4 似乎存在错误，其他开发人员报告了相同的行为： http: [//openradar.appspot.com/11972490](http://openradar.appspot.com/11972490)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-07T23:48:23.110

2012 年 8 月 7 日发布的 4.4.1 似乎修复了这个问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-27T11:16:21.703

如果您需要*记录*调试响应（或错误报告），那么我认为您应该将其写入`responseObject`缓存目录中的文件（或 iOS 下的任何等效文件夹，如果那是 O/S）。然后您可以访问此文件以查看响应是什么。唯一需要克服的问题是如何防止文件夹变得太大；可能会在应用程序启动时或定期删除所有先前写入的文件。

您可以使用该方法编写响应`[NSData writeToURL:atomically:]`，这会更快，因为它不需要先转换为字符串。

# javascript - Ant 任务：将 HTML 文件中使用的所有脚本复制到一个目录并压缩

> ID：11686551
> 
> 赞同：0
> 
> 时间：2012-07-27T11:07:25.263
> 
> 标签：javascript, ant, compression, copy, concat

我目前正在尝试创建一个应该执行以下操作的 ANT build.xml：

在 HTML 文件中查找所有出现的 <script src="foo.js"> 标记。获取该脚本文件的 src 属性并将相应的 js 文件复制到临时目录。然后将目录中的所有脚本连接起来，这样就会有一个大脚本。最后压缩脚本（使用 YUI 压缩器）。我在 ANT 构建方面没有太多经验，但这就是我到目前为止的方式：

```
<target name="concat">
    <copy todir="${output.dir}/js/temp">
        <fileset dir="${src.dir}">
            <include name="if.html"/>
        </fileset>
        <filterchain>
            <linecontainsregexp>
                <regexp pattern="script.*src=&quot;(.*?)&quot;" />
            </linecontainsregexp>
            <tokenfilter>
                <replaceregex pattern=".*&lt;script.*src=&quot;(.*?)&quot;&gt;.*" replace="\1" />
            </tokenfilter>

        </filterchain>      
    </copy>

    <concat destfile="${output.dir}/js/application.js">
        <fileset dir="${output.dir}/js/temp" includes="*.js" />
    </concat>
</target> 
```

到目前为止，buildscript 将从文件 if.html 中获取所有 javascripts 路径。我将在文件夹“${output.dir}/js/temp”中创建一个文件 if.html 并将所有路径放在那里。但这不是我想要的。我希望将所有脚本文件复制到“${output.dir}/js/temp”中，以便在下一步中连接它们。

谢谢你的帮助！

问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T12:06:43.247

所以最后我通过使用一个名为“ant-contrib”的 ANT 插件让它工作了。这增加了在 ANT 脚本中使用 for 循环的可能性。

```
 <loadfile property="file" srcfile="${output.dir}/js/temp/if.html"/>
  <for param="line" list="${file}" delimiter="${line.separator}">
          <sequential>       
            <concat destfile="${output.dir}/js/application.js" append="true">
                 <fileset dir="${src.dir}" includes="@{line}" />
            </concat>
            <echo message="Adding js ${src.dir}/@{line}"/>
          </sequential>
  </for> 
```

现在我可以遍历文件的行（每一行是一个 js 文件的路径）并将文件内容附加到主 application.js。

# jquery - 在 href 链接上使用数据描述

> ID：11686555
> 
> 赞同：0
> 
> 时间：2012-07-27T11:07:37.080
> 
> 标签：jquery, html, css

我想在 href 链接上使用数据描述，但描述不显示。有人知道如何使用它，请告诉我。这是演示链接[http://jsfiddle.net/KNa3A/](http://jsfiddle.net/KNa3A/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T11:09:49.633

您可以为此使用 :after 伪元素 - [http://jsfiddle.net/spacebeers/KNa3A/4/](http://jsfiddle.net/spacebeers/KNa3A/4/)

```
.your_class:after {
    content: attr(data-description);
    display: block;
    padding: 0 0 0 10px;
    color: red;
} 
```

将 :after 元素的内容设置为 attr(data-description) 就可以了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T11:10:06.427

除了标准 Mootools 库外，您没有 JavaScript 代码：http: [//jsfiddle.net/KNa3A/](http://jsfiddle.net/KNa3A/)

data-description 可以被一些 JavaScript 插件使用，但你需要初始化它。然后那个插件（可能是 jQuery 或 Mootools 插件）会得到那个描述并渲染好东西（弹出框、工具提示等）。这应该包含在该特定插件的教程/快速入门/自述文件中。

附言。其他人建议改用 title 属性。这是一个很好的方法，除非你想要一些花哨的东西。但是对于一些花哨的东西，你很可能需要 JS 插件。

# php - android多部分发布到php

> ID：11686559
> 
> 赞同：1
> 
> 时间：2012-07-27T11:07:52.150
> 
> 标签：php, android

我试图将文件从我的 android 设备上传到 php 服务器，但我收到“注意：未定义的索引：第 3 行的 upload_file.php 中的文件。有什么建议吗？

这是upload_file.php

```
<?php
if(isset($_POST))
{
  $allowedExts = array("jpg", "jpeg", "gif", "png");
  $extension = end(explode(".", $_FILES["file"]["name"]));
  echo $_FILES["file"]["type"] . ($_FILES["file"]["size"] < 2000000);
  if (((($_FILES["file"]["type"] == "image/gif")
    || ($_FILES["file"]["type"] == "image/jpeg")
    || ($_FILES["file"]["type"] == "image/pjpeg"))
    && ($_FILES["file"]["size"] < 2000000))
    && in_array($extension, $allowedExts))
  {
    if ($_FILES["file"]["error"] > 0)
    {
      echo "Return Code: " . $_FILES["file"]["error"] . "<br />";
    }
    else
    {
      echo "Upload: " . $_FILES["file"]["name"] . "<br />";
      echo "Type: " . $_FILES["file"]["type"] . "<br />";
      echo "Size: " . ($_FILES["file"]["size"] / 1024) . " Kb<br />";
      echo "Temp file: " . $_FILES["file"]["tmp_name"] . "<br />";
      if (file_exists("files/" . $_FILES["file"]["name"]))
      {
        echo $_FILES["file"]["name"] . " already exists. ";
      }
      else
      {
        move_uploaded_file($_FILES["file"]["tmp_name"],"files/" . $_FILES["file"]["name"]);
        echo "Stored in: " . "files/" . $_FILES["file"]["name"];
      }
    }
  }
  else
  {
    echo "Invalid file";
  }
}
else
{
  echo "nothing posted";
}
?> 
```

这是在我的 AndroidDevice 上执行的

```
/**
 * POSTphoto
 **/
private class POSTphoto
        extends AsyncTask<String,String,String>
{
    @Override
    /** doInBackground */
    protected String doInBackground( String... filename )
    {
        File file = new File( filename[0] );
        HttpPost request;
        MultipartEntity mpe = new MultipartEntity(
                HttpMultipartMode.BROWSER_COMPATIBLE );
        FileBody cbFile;
        try
        {
            cbFile = new FileBody( file , "image/jpeg" );
            mpe.addPart( "file" , cbFile );

            // Creating the request.
            String resource = APIcontroller.buildUrl( "" );
            request = new HttpPost( resource );
            request.addHeader( "Content-Type" , "multipart/form-data" );
            request.setEntity( mpe );
            return APIcontroller.execute( request );
        }
        catch ( Exception e )
        {
            e.printStackTrace();
            return "some error";
        }
    }// doInBackground

    @Override
    /** Shows the content of the result.
     * @param result is what the server returns in doInBackground.
     **/
    protected void onPostExecute( String result )
    {
        // CLose clients connection pool.
        APIcontroller.closeClient();
        if ( !result.equals( "" ) )
        { // Result not empty.
            Log.d( "result" , result );
            Toast.makeText( FilebrowserActivity.this , result ,
                    Toast.LENGTH_LONG ).show();
        }
        else
        { // Result empty.
            Toast.makeText( FilebrowserActivity.this , "FAILED" ,
                    Toast.LENGTH_LONG ).show();
        }
    } // onPostExecute
} // POSTphoto 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-07-27T11:11:02.670

我不是安卓专家，但我猜

```
File file = new File( filename[0] ); 
```

应该

```
File file = new File( 'file' ); 
```

因为您正在 php 脚本中访问像 $_FILES["file"] 这样的文件变量。请试一试。

# mysql - 匹配人的网站的数据库设计

> ID：11686566
> 
> 赞同：3
> 
> 时间：2012-07-27T11:08:27.773
> 
> 标签：mysql, database, database-design, web-applications, matching

我正在创建一个 Facebook 网络应用程序，其功能类似于约会网站，通过让用户提供有关他们自己的信息以及他们在匹配用户中的偏好信息。

我正在为此创建数据库并考虑以下设计：

*   **成员表：** 包含有关使用其 FB ID 作为主键的用户的信息。
*   **首选项表：** 包含有关用户想要的首选项的信息。

将有大约 20 个字段，用户可以在其中指定首选项，但所有字段都是可选的。我不确定构建“首选项”表的最佳方式，我目前有两个想法：

**解决方案 1：** 使用 facebook ID 的外键，并为每个可以匹配的字段创建一个新列。我可以看到的一个问题是，对于尚未指定值的字段，数据库中会有很多“空”值。

*   数据库中的“空”值是否占用空间或导致任何其他问题？

**解决方案 2：** 再次使用 facebook ID 的外键，但在接下来的两列中使用键值对方法 - 因此一列将包含用户偏好的 ID，而另一列将包含它的值。对于每个用户偏好，我都会有一个结构记录：“用户 ID”-“偏好 ID”-“价值”。

*   问题在于“value”列中的值类型将取决于“preference ID”列的内容

**我的问题：**

*   哪种方法更好？
*   这种网络应用程序有标准的模式解决方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T11:43:19.303

正如您所注意到的，无论哪种方式，您都在寻求妥协。您采用哪种方式取决于您的生产数据的真实情况。

稀疏表中的空值确实会占用一点空间，但不会占用太多空间——只要您的列使用可变长度数据。十个 null varchars 不是很长。十个空整数与十个非空整数一样长。

如果您在第二个解决方案中添加由“preference ID”键控的第三个表“PreferableThings”，那么从技术上讲，您所拥有的并不是大多数人都回避的键值对或 EAV。正如您所指出的，困难在于具有不同数据类型的首选项必须以通用编码形式（通常是 varchar）存储。这解决了稀疏表的问题，但它迫使您创建一些应用程序逻辑来从通用数据类型解码为正确的本机数据类型。您可以将执行此操作的规则存储在“PreferableThings”表中。

然而，第二种方法的另一个优点是您可以通过表格驱动添加新的偏好选项。使用解决方案 1，您将需要更改架构。

# uploadify - uploadify 工作，但不上传到文件夹

> ID：11686568
> 
> 赞同：0
> 
> 时间：2012-07-27T11:08:32.907
> 
> 标签：uploadify

我正在使用uploadify，尽管它可以正常工作，但它不会上传到文件夹中。我怎样才能让它复制？文件夹是 777。

如果需要，这是页面：

[http://www.dilyurdu.com/uploadify/](http://www.dilyurdu.com/uploadify/)

// 脚本

```
$(function() {

$("#file_upload_1").uploadify({
    height        : 30,
    swf           : 'uploadify.swf',
    uploader      : 'uploadify.php',
    width         : 120
});
}); 
```

//php

```
$targetFolder = '/uploads'; // Relative to the root

if (!empty($_FILES)) {
$tempFile = $_FILES['Filedata']['tmp_name'];
$targetPath = $_SERVER['DOCUMENT_ROOT'] . $targetFolder;
$targetFile = rtrim($targetPath,'/') . '/' . $_FILES['Filedata']['name'];

// Validate the file type
$fileTypes = array('jpg','jpeg','gif','png'); // File extensions
$fileParts = pathinfo($_FILES['Filedata']['name']);

if (in_array($fileParts['extension'],$fileTypes)) {
    move_uploaded_file($tempFile,$targetFile);
    echo '1';
} else {
    echo 'Invalid file type.';
}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T11:20:28.173

试试这个

```
<script type="text/javascript">
$(document).ready(function() {
 $(function() {
    $("#file_upload").uploadify({
            'uploader'       : '<?php echo base_url();?>flash/uploadify.swf',
            'script'         : '<?php echo base_url();?>scripts/uploadify.php',
            'folder'         : '/folder_name_where_you_want_to_upload/',
            'height'         : 30,
            'onError'        : function(event,queueID,fileObj,errorObj){
                    // alert(errorObj["type"]+" - "+errorObj["status"]+" - "+errorObj["text"]);
             },
            });
    });
});
</script> 
```

并且在uploadify.php 中回显$targetPath，这样你就可以追踪它被上传的路径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-10T18:19:24.983

我在这里尝试了所有其他建议，但没有一个对我有用。然后我意识到 Uploadify 的 3.2 版（可能还有以前的版本）需要时间戳和散列令牌才能完成上传。

首先，我必须将脚本从外部 JS 文件移动到我的 PHP 文件中，以便我可以从 PHP 中获取时间戳。（您也可以通过隐藏的输入值或其他方法来执行此操作，但这是最简单的方法。）然后我必须在 Uploadify 调用中添加[“formData”选项](http://www.uploadify.com/documentation/uploadify/formdata/)以及一些获取时间戳并将其散列的 PHP 代码一个独特的盐（您应该将其更改为随机字符串）：

```
<?php $timestamp = time();?>
<script>
$('#file_upload').uploadify({
    'swf'      : '/uploadify/uploadify.swf',
    'uploader' : '/uploadify/uploadify.php',
    'formData' : {
        'timestamp' : '<?php echo $timestamp;?>',
        'token'     : '<?php echo md5("unique_salt" . $timestamp);?>'
    }
});
</script> 
```

尽管在 3.2 版本中似乎需要此代码，但在[实现文档](http://www.uploadify.com/documentation/uploadify/implementing-uploadify/)中并未提及。我必须查看下载包中的 index.php 文件才能找到它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-13T12:23:04.220

我有同样的问题。在尝试了这篇文章中提到的所有内容以及有关该主题的其他帖子之后，我意识到我必须设置目标文件夹的绝对路径。所以，对我有用的是在uploadify.php中更改以下内容：

$targetFolder = '/var/www/vhosts/DOMAIN/httpdocs/uploads'

然后我把 DOCUMENT_ROOT FROM $targetPath 去掉，只留下 $targetFolder，如下： $targetPath = $targetFolder;

如上所述，我还在我的 JS 调用中添加了时间戳和令牌。

现在一切正常。希望这可以帮助某人:-)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-24T20:29:54.910

问题在于上传文件夹的路径我的路径：

$targetFolder = '../../upload/orginal'; // 相对于根

# image - 从 Sirona Galileos 设备获取图像

> ID：11686574
> 
> 赞同：1
> 
> 时间：2012-07-27T11:09:04.260
> 
> 标签：image, medical

我的任务是尝试获取由 Sirona Galileos 设备 [http://www.sirona.com/en/products/imaging-systems/galileos/](http://www.sirona.com/en/products/imaging-systems/galileos/)创建的图像，并将它们显示在移动设备上。移动设备部分不是问题，而是获取存储在此设备上的图像。

stackoverflow 上有没有人曾经开发过这样的东西？我真的有点超出我的深度，任何信息或评论将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T15:52:13.897

假设：

*   您要导出 dicom 数据集
*   您已经可以在手机上导入 dicom 数据集

解决方案： Sidexis -> 图片 -> 导出

# c# - UIImageView 不显示图像到其可以在服务器上可用的原始图像

> ID：11686581
> 
> 赞同：-2
> 
> 时间：2012-07-27T11:09:21.643
> 
> 标签：c#, ios, xamarin.ios

`UIImageView`不显示/显示原始图像作为服务器上可用的图像。更多参考[检查它](http://monotouch.2284126.n4.nabble.com/UIImageView-Not-Show-Image-to-its-Original-Image-that-can-available-on-Server-td4656196.html)

```
float scaleFactor = 0.0f;`
float scaleWidth = dstRectangle.Width; //width =748
float scaleHeight = dstRectangle.Height; // height = 759
if(!SizeF.Equals(srcRectangle ,dstRectangle))
{
float widthFactor =(float) dstRectangle.Width / srcRectangle.Width;   //srcRectHeight = 512
float heightFactor =(float) dstRectangle.Height / srcRectangle.Height;  //srcRectangle.Height = 314
if(widthFactor >heightFactor)
scaleFactor = widthFactor ;
else
scaleFactor = heightFactor;
scaleWidth = srcRectangle.Width * scaleFactor;
scaleHeight = srcRectangle.Height * scaleFactor;
if(widthFactor >heightFactor)
           {
thumbnailPoint.Y = (dstRectangle.Height - scaleHeight) * .5f;
}
else

if(widthFactor < heightFactor)
{
thumbnailPoint.X = (dstRectangle.Width - scaleWidth) *.5f;
}
}
UIGraphics.BeginImageContext(new SizeF(dstRectangle.Width , dstRectangle.Height));
RectangleF thumbnailRect = RectangleF.Empty;
thumbnailRect.Offset(thumbnailPoint);
thumbnailRect.Size.Width = scaleWidth;

thumbnailRect.Size.Height = scaleHeight;

CGImage  _bitmap = UIGraphics.GetImageFromCurrentImageContext().CGImage;
ImgVIew.Image = UIImage.FromImage(_bitmap);
UIGraphics.EndImageContext(); 
```

它给了我一个 UIImage 但不显示在 UIImageView 在 CGImage 我得到 ALphaInfo = PremultipledLast

```
BitsPerComponant = 8

BitsPerPixel =32

BytesPerRow = 3008

Height= 759

Width = 748 
```

这个值我进入 CGImage 但是这个 CGImage 我将它转换为 UIImage 但它仍然无法显示

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-28T15:09:38.733

你能做这样的事情吗：

```
 using (var url = NSUrl.FromString ("http://yoururl.com/yourpic.jpg"))
        {
            using (var data = NSData.FromUrl (url))
            {
                imageView.Image = UIImage.LoadFromData (data);
            }
        } 
```

听起来您只需要下载图像并将其设置为 a `UIImageView`，对吗？

看起来您正在为一些非常简单的事情编写大量代码。

注意：对网络错误使用 try-catch。

# c++ - 基于模板的Shell脚本生成命令

> ID：11686582
> 
> 赞同：0
> 
> 时间：2012-07-27T11:09:26.227
> 
> 标签：c++, bash, templates, shell, code-generation

**我想要达到的目标**

*   用户将提供一个可以远程执行的命令。命令（用于远程执行的协议）可以是 SSH/RSH ......等等。所以我希望它成为配置文件或模板文件的一部分（假设参数在协议中是固定的），如下例所示 -

template.cfg 文件（由用户配置）：

```
ssh $ip $commandList 
```

*   我将在另一个数据文件中生成一个值列表，其中包含 IP 地址和命令列表。像

    ```
    10.182.215.214|echo $UNAME
    10.251.142.142|echo $SHELLNAME 
    ```

*   我想要一个脚本调用它`driver.sh`，它在执行时会使用从模板到另一个执行脚本的命令生成实际的脚本/脚本 -`execute.sh`

**问题**

1.  如何根据模板/插件生成脚本（可以随意提供命令）？
2.  如果数据是在在线应用程序 (C/C++) 中生成的，除了正常的基于文件的操作（从 cfg 文件读取并更新`execute.sh`）之外，还有什么更好的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-04-07T06:50:06.373

1.

```
while IFS=\| read ip commandList
do  eval echo $(<template.cfg)
done <data >execute.sh 
```

您可能想要引用`data`文件中的变量扩展。

2\. 由于您希望用户提供的命令成为配置文件的一部分，我认为只能从 cfg 文件中读取；另一方面，您可以直接执行生成的命令，而不是将它们写入`execute.sh`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-09T22:09:32.747

这几乎看起来好像您正在尝试重新实现自动配置工具，例如`puppet`或`chef`。击败`ssh`循环。

Puppet 包含一个名为 的模块`facter`，用于报告/收集有关远程系统的各种数据。

所有这些工具都需要一些设置（公钥/私钥对、软件安装）。它们都具有内置日志记录的优势 - 有利于审计。

# c# - WinRT 中是否存在已取消拖放事件？

> ID：11686587
> 
> 赞同：3
> 
> 时间：2012-07-27T11:09:40.140
> 
> 标签：c#, drag-and-drop, windows-runtime

我正在寻找 Metro 中的 Drag/Drop 取消事件，这意味着如果用户将项目拖放到可放置区域之外。

我怎样才能做到这一点，或者有什么解决方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-12T20:03:46.457

我还没有找到这样的事件（对于 c#/XAML）！也许（希望）最终版本中会存在一个事件！

作为临时解决方法，我已注册到`Window.Current.CoreWindow.PointerReleased`-event。
然后在拖动开始时，我将布尔指示器设置为 true，如果拖动结束，`PointerReleased`-event 将被触发，我可以测试布尔指示器。

**解决方法**
在 Page（或任何元素）的构造函数中注册到 PointerReleased：

```
Window.Current.CoreWindow.PointerReleased+=CoreWindow_PointerReleased; 
```

事件处理程序可能看起来像这样：

```
void CoreWindow_PointerReleased(CoreWindow sender, PointerEventArgs args) {
     if (m_isDragging) {
           m_isDragging = false;
           // Here you know that a drag-operation came to a end
     }
} 
```

您可以设置的指标例如如下；

```
 private void Entries_DragStarting(object sender, DragItemsStartingEventArgs e){            
        m_isDragging = true;
        // ...
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-22T14:42:56.457

伙计，您可以在列表视图或拖动的项目上注册“指针捕获丢失”，而不是捕获在整个页面上释放的指针，我相信它至少触发的次数更少：D

```
 listView_PointerCaptureLost(object sender, PointerRoutedEventArgs e){
//do the logic you want;
} 
```

# xcode - 证书配置文件和 xcode4

> ID：11686592
> 
> 赞同：0
> 
> 时间：2012-07-27T11:09:50.737
> 
> 标签：xcode, app-store, xcode4.2

我在将我的应用程序上传到 appStore 时遇到了很多麻烦。

我创建配置文件，下载并添加到我的 xcode。

所以，我的项目我的计划处于存档模式。

我尝试构建并得到这个错误：

```
Code Sign error: No unexpired provisioning profiles found that contain any of the keychain's signing certificates 
```

我认为这是因为我以前的配置文件不正确，我将其删除但仍然出现此错误。

我该如何解决？

先感谢您

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T13:35:14.100

我解决了它，在项目属性-> 代码签名中我添加了配置文件并且它有效！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T13:39:32.517

您可以看到有关登录的信息单击左侧栏（项目检查器）上的项目，在中央面板中选择项目，选择 BuildSettings 选项卡，找到代码登录结束在每个项目上设置您的配置文件。

# javascript - 将垂直滚动转换为水平div位置jQuery

> ID：11686594
> 
> 赞同：0
> 
> 时间：2012-07-27T11:10:04.013
> 
> 标签：javascript, jquery, css

和这个斗争了一段时间。看起来很简单，但我似乎缺乏让它工作所需的逻辑。

我想将垂直的 .scrollTop 位置转换为代表文档中用户垂直位置的水平条。

我认为我的数学很糟糕；我准备好在火焰中被击落。

```
var pos = $("#content").scrollTop();
var convert = (pos / 1024);

$(document).scroll(function() {
    $(".place").animate({
        left: '+=' + pos
    }, slow);
});​ 
```

这是我到目前为止的位置[。](http://jsfiddle.net/broman/SzLNg/)'place' div 不想移动。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T11:39:04.193

首先将滚动位置转换为百分比

```
 var s = $(window).scrollTop(),
    d = $(document).height(),
    c = $(window).height();
  var percent =  scrollPercent = (s / (d-c)) 
```

然后通过使用 .placebar 宽度的百分比来获取您当前的位置

```
var newPos = percent*1024;

if(newPos > 984) { //check to stop limit
   newPos = 984;
}

$("#place").stop().animate({
    left: newPos +"px"
}); 
```

[小提琴](http://jsfiddle.net/SzLNg/19/)

# javascript - 从 Flash 菜单调用 javascript 在 chrome 上不起作用

> ID：11686596
> 
> 赞同：1
> 
> 时间：2012-07-27T11:10:17.563
> 
> 标签：javascript, flash, google-chrome

我有一个 Flash 菜单，我在其中调用一些 javascript 函数

```
 javascript:hideTopMenu(); 
```

此功能适用于 firefox 和 safari
但不适用于 IE 和 chrome
有什么建议吗？

# c# - 什么是好的 MVVM 资源？

> ID：11686597
> 
> 赞同：1
> 
> 时间：2012-07-27T11:10:23.913
> 
> 标签：c#, mvvm

我一直在寻找更多关于 MVVM 的信息，但我觉得我的源代码已经用完了（事实并非如此）。那么其他人有什么好的资源可以使用吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T11:12:52.577

我希望你没有通过 CodeProject，这里是列出所有 MVVM 相关文章和演示的链接。这肯定会帮助你。

[http://www.codeproject.com/search.aspx?q=mvvm&sbo=kw](http://www.codeproject.com/search.aspx?q=mvvm&sbo=kw)

# javascript - 如何在图像上添加标签。在jquery mobile中图像的四个角

> ID：11686599
> 
> 赞同：0
> 
> 时间：2012-07-27T11:10:29.250
> 
> 标签：javascript, css, jquery-mobile

我正在使用**jQuery 手机。**

我目前在页面中有一张图片。

我需要**在图像的 4 个角落放置 4 个标签**

**如何在图像的 4 个角落设置标签。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T11:22:10.357

HTML

```
<div class="imgContainer">
  <img src="imagepath" />
  <label class="label1">1</label>
  <label class="label2">2</label>
  <label class="label3">3</label>
  <label class="label4">4</label>
</div> 
```

CSS

```
.imgContainer{
  position: relative;
}
.label1, .label2, .label3, .label4{
  position: absolute;
  left: 0;
  top: 0;
}
.label2{
  right: 0;
  top: 0;
}
.label3{
  left: 0;
  bottom: 0;
}
.label4{
  right: 0;
  bottom: 0;
} 
```

# spring - 错误：此处不能使用类型 byte[]。（在请求工厂的代理类中）

> ID：11686605
> 
> 赞同：0
> 
> 时间：2012-07-27T11:10:45.277
> 
> 标签：spring, gwt, maven, requestfactory

**我有一个 maven + spring + gwt(2.4.0) 项目。当我运行 mvn gwt:run 时，出现以下错误：**

```
[ERROR] Failed to execute goal org.apache.maven.plugins:maven-compiler-plugin:2.5.1:compile (default-compile) on project star: Compilation failure: Compilation failure:
[ERROR] C:\Users\radu_chilom\Eclipse Workspaces\Spring3\star\src\main\java\com\base\star\shared\proxies\customer\CDocumentProxy.java:[19,8] error: The type byte[] cannot be used here
[ERROR] C:\Users\radu_chilom\Eclipse Workspaces\Spring3\star\src\main\java\com\base\star\shared\proxies\customer\CDocumentProxy.java:[21,25] error: The type byte[] cannot be used here
[ERROR] C:\Users\radu_chilom\Eclipse Workspaces\Spring3\star\src\main\java\com\base\star\shared\proxies\dealer\DealerTargetAgreementProxy.java:[35,36] error: The type byte[] cannot be used here
[ERROR] C:\Users\radu_chilom\Eclipse Workspaces\Spring3\star\src\main\java\com\base\star\shared\proxies\dealer\DealerTargetAgreementProxy.java:[40,15] error: The type byte[] cannot be used here
[ERROR] C:\Users\radu_chilom\Eclipse Workspaces\Spring3\star\src\main\java\com\base\star\shared\services\dealer\TreeNodeTargetAgreementRequest.java:[29,33] error: Could not find domain method similar to java.util.List<com.base.star.server.dto.dealer.FileTextDTO> getTreeNodeTargetAgreementsList(java.lang.Long) 
```

**我的 CDocumpentProxy.java 看起来像：**

```
@ProxyFor(value = com.base.star.server.domain.CDocument.class, locator=
com.base.star.server.locators.customer.CDocumentLocator.class)
public interface CDocumentProxy extends EntityProxy {

byte[] getDocument(); //line 19

void setDocument(byte[] document); //line 21 
```

如果我使用 STS 2.9.2 构建项目，则项目构建。所以我认为问题是对 maven-compiler-plugin 的错误配置。

在我的 .pom 文件中，我配置了 maven-compiler-plugin，如下所示：

```
<plugin>
  <groupId>org.apache.maven.plugins</groupId>
  <artifactId>maven-compiler-plugin</artifactId>
  <version>2.5.1</version>
  <configuration>
    <source>1.6</source>
    <target>1.6</target>
    <encoding>UTF-8</encoding>
  </configuration>
 </plugin> 
```

我不能使用 byte[] 作为请求工厂代理中方法的返回类型吗？我只是无法理解错误..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T11:31:41.850

您不能在请求工厂中使用数组：[https ://developers.google.com/web-toolkit/doc/latest/DevGuideRequestFactory#transportable](https://developers.google.com/web-toolkit/doc/latest/DevGuideRequestFactory#transportable)

话虽如此，对于`byte[]`等价物，我宁愿使用 a 而`String`不是 a `List<Byte>`，并且 GWT 模拟`String#getBytes`UTF-8 和 ISO-8859-1 字符集。

# php - 如何为这个 DIV 做 jQuery 选择

> ID：11686610
> 
> 赞同：0
> 
> 时间：2012-07-27T11:11:04.600
> 
> 标签：php, javascript

我有这个 div 标签：

```
<div id="target-share">
<a href="#" title="" id="to-chosen" class="default"><span class="to-admin">Admin</span></a>
<ul id="select-shareto">
<li data-val="0-1">
<a href="#" title="" class="selected"><span class="to-Finance">Finance</span></a>
</li>
<li data-val="1-1">
<a href="#" title=""><span class="to-admin-private">Admin Private</span></a>
</li>
<li data-val="1-0">
<a href="#" title=""><span class="to-ceo">CEO</span></a>
</li>
<li data-val="0-0">
<a href="#" title=""><span class="to-ceo-private">CEO Private</span></a>
</li>                                    
</ul>
<input id="shareto" type="text" value="0-1" name="shareto">
</div><!-- #target-share --> 
```

和这个 JavaScript ：

```
<script type="text/javascript">
$(document).ready(function($) {
        $('ul li').click(function() {
            $('input#shareto').val($(this).data('val'));
        });
    });
</script> 
```

当我单独将它与那个 div 一起使用时，JavaScript 实际上可以工作。但是当我把它放在我的完整代码上时，那个 JavaScript 不起作用。我认为这是因为我的代码中有多个 UL 和 LI 标签。

现在，问题是......如何应用该 Javascript 以便它仅适用于该 div，即使还有其他 UL 和 LI 标记。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-27T11:13:06.137

只需使用它而不是先定位 div 然后再定位它的内容

```
$('#target-share ul li') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T11:16:04.317

JavaScript（不仅仅是 Jquery）都是关于范围的：

`$('ul li').click(function() {`

导致它`click`绑定到 a 中的每`li`一个，`ul`因此您想要做的是将范围`click`缩小到页面的特定区域或页面中的一组元素。

要将其范围缩小到特定元素，最好的办法是使用这样的 id：

`$('#target-share ul li')`

但是要将其范围缩小到许多元素，最好使用如下类：

`$('.target-share ul li')`

编辑：

在这里也`on()`可能是一个很好的替代品，`click`但这取决于 HTML 的来源和使用方式，但我想我会让你知道这个功能，以防你还不知道它。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-27T11:13:42.157

选择那些`ul li`有你的`data-val`属性：

```
$(function($) {
    $('ul li[data-val]').click(function() {
        $('input#shareto').val($(this).data('val'));
    });
}); 
```

# model - Cakephp 将值保存到数据库中

> ID：11686617
> 
> 赞同：0
> 
> 时间：2012-07-27T11:11:35.467
> 
> 标签：model, cakephp-2.1

我有一个电影表和一个评级表。Ratings 表属于 Movies 和 Movies hasOne Rating。我想增加“vote_count”字段。代码如下。

```
public function set_ratings($movieId, $value){
    $this->Movie->id = $movieId;
    $rateMovie = $this->Movie->read();
    $oldNoOfVotes = $rateMovie['Rating']['number_of_votes'];
    debug($oldNoOfVotes);
    $newNoOfVotes = ++$oldNoOfVotes;
    $newVoteCount = $rateMovie['Rating']['vote_count'] + $value;
    $newAverageRating = $newVoteCount / $newNoOfVotes;
    debug($oldNoOfVotes);
    debug($newNoOfVotes);
    $this->request->data['Rating']['id'] = $rateMovie['Rating']['id'];
    $this->request->data['Rating']['number_of_votes'] = $newNoOfVotes;
    $this->request->data['Rating']['vote_count'] = $newVoteCount;
    $this->request->data['Rating']['average_rating'] = $newAverageRating;
    //$this->request->data['Rating']['id'] =  $rateMovie['Rating']['id'];
    debug($newNoOfVotes);
    $this->Movie->Rating->save($this->request->data);
    debug($newNoOfVotes);
} 
```

我面临的问题是，如果“vote_count”是15，当我增加它并调试它的值为16，但在数据库中它被保存为18。原因是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T11:35:25.157

您确定不调用该函数两次或更多次吗？或者数据库引擎可能会增加它（类似于 ON UPDATE 增加 SQL 语句）？

# macos - 如何使用 Mac OS X Finder 中的不同应用程序自动打开 FITS 图像和表格？

> ID：11686623
> 
> 赞同：0
> 
> 时间：2012-07-27T11:11:50.003
> 
> 标签：macos, file-browser, astronomy, fits

[FITS 文件](http://en.wikipedia.org/wiki/FITS)可以包含多个图像（或更一般的 n 维数组）和表格。当我在 Mac OS X Finder 中双击 FITS 文件时，有没有办法自动打开图像，例如使用[ds9](http://hea-www.harvard.edu/RD/ds9)应用程序和使用 TOPCAT 应用程序打开表格[？](http://www.star.bris.ac.uk/~mbt/topcat/)

我正在考虑类似[AstroSoft 的 FITS Explorer](https://sites.google.com/site/astrosoftint/home/fits-explorer)之类的东西，但它是免费的并且很好地集成到 Mac 中（即 Finder、Quicklook）。

如果不存在这样的东西，您在 FITS 文件中浏览和打开图像和表格的工作流程是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T14:32:19.930

我刚刚发现[QLfits](http://softtenebraslux.com/qlfits/)，它是一个 Mac OS X Finder QuickLook 插件，它显示一些 FITS 标题信息和图像，只需在 Finder 中选择一个 FITS 文件后点击 SPACE 即可。

同一个人写了[FITSImporter](http://softtenebraslux.com/fitsimporter/)：

> 一个 Spotlight 插件，允许您针对专用 FITS 标题关键字进行 Spotlight 查询。它还在 Finder (⌘-I) 的“获取信息”面板中提供了其他信息。

两者都是开源的（GPL 许可证），代码可在 github 上找到：[QLFITS](https://github.com/SoftTenebrasLux/QLFits)、[FITSImporter](https://github.com/SoftTenebrasLux/FITSImporter)。

虽然它们并不完美（例如，我没有看到在多扩展 FITS 文件中获取不同扩展的方法，尽管描述说有；而且你不能使用 QLFits 来浏览表格）并且开发似乎已经停止，但仍然值得一试！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-17T16:51:53.120

除了向您推荐 QLfits 之外，您还可以尝试使用任何脚本语言编写 AppleScript 应用程序或 Automator 操作，探索 FITS 文件，并将基于表格的 FITS 发送到 TOPCAT，将基于图像的 FITS 发送到 DS9，并制作该应用程序FITS 文件的默认值。

# iphone - 从 iPhone 上的音频流中获取 Hz 频率

> ID：11686625
> 
> 赞同：15
> 
> 时间：2012-07-27T11:12:04.843
> 
> 标签：iphone, ios, audio, core-audio, fft

从iOS上的音频流（音乐）获取Hz频率值的最佳方法是什么？苹果提供的最好和最简单的框架是什么？提前致谢。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-11-13T23:45:32.523

这是我使用 Accelerate Framework 在 iOS 中执行 FFT 的一些代码，这使得它非常快。

```
//keep all internal stuff inside this struct
    typedef struct FFTHelperRef {
        FFTSetup fftSetup; // Accelerate opaque type that contains setup information for a given FFT transform.
        COMPLEX_SPLIT complexA; // Accelerate type for complex number
        Float32 *outFFTData; // Your fft output data
        Float32 *invertedCheckData; // This thing is to verify correctness of output. Compare it with input.
    } FFTHelperRef; 
```

//first - 用这个函数初始化你的 FFTHelperRef。

```
FFTHelperRef * FFTHelperCreate(long numberOfSamples) {

    FFTHelperRef *helperRef = (FFTHelperRef*) malloc(sizeof(FFTHelperRef));
    vDSP_Length log2n = log2f(numberOfSamples);    
    helperRef->fftSetup = vDSP_create_fftsetup(log2n, FFT_RADIX2);
    int nOver2 = numberOfSamples/2;
    helperRef->complexA.realp = (Float32*) malloc(nOver2*sizeof(Float32) );
    helperRef->complexA.imagp = (Float32*) malloc(nOver2*sizeof(Float32) );

    helperRef->outFFTData = (Float32 *) malloc(nOver2*sizeof(Float32) );
    memset(helperRef->outFFTData, 0, nOver2*sizeof(Float32) );

    helperRef->invertedCheckData = (Float32*) malloc(numberOfSamples*sizeof(Float32) );

    return  helperRef;
} 
```

//在这里传递初始化的FFTHelperRef，数据和数据大小。返回大小为 numSamples/2 的 FFT 数据。

```
Float32 * computeFFT(FFTHelperRef *fftHelperRef, Float32 *timeDomainData, long numSamples) {
    vDSP_Length log2n = log2f(numSamples);
    Float32 mFFTNormFactor = 1.0/(2*numSamples);

    //Convert float array of reals samples to COMPLEX_SPLIT array A
    vDSP_ctoz((COMPLEX*)timeDomainData, 2, &(fftHelperRef->complexA), 1, numSamples/2);

    //Perform FFT using fftSetup and A
    //Results are returned in A
    vDSP_fft_zrip(fftHelperRef->fftSetup, &(fftHelperRef->complexA), 1, log2n, FFT_FORWARD);

    //scale fft 
    vDSP_vsmul(fftHelperRef->complexA.realp, 1, &mFFTNormFactor, fftHelperRef->complexA.realp, 1, numSamples/2);
    vDSP_vsmul(fftHelperRef->complexA.imagp, 1, &mFFTNormFactor, fftHelperRef->complexA.imagp, 1, numSamples/2);

    vDSP_zvmags(&(fftHelperRef->complexA), 1, fftHelperRef->outFFTData, 1, numSamples/2);

    //to check everything =============================
    vDSP_fft_zrip(fftHelperRef->fftSetup, &(fftHelperRef->complexA), 1, log2n, FFT_INVERSE);
    vDSP_ztoc( &(fftHelperRef->complexA), 1, (COMPLEX *) fftHelperRef->invertedCheckData , 2, numSamples/2);
    //=================================================    

    return fftHelperRef->outFFTData;
} 
```

像这样使用它：

1.  初始化它：**FFTHelperCreate(TimeDomainDataLenght);**

2.  传递 Float32 时域数据，返回时获取频域数据：**Float32 *fftData = computeFFT(fftHelper, buffer, frameSize);**

现在你有一个数组，其中索引=频率，值=幅度（平方幅度？）。根据[奈奎斯特定理](http://en.wikipedia.org/wiki/Nyquist_rate)，您在该阵列中的最大可能频率是采样率的一半。也就是说，如果您的采样率 = 44100，则可以编码的最大频率为 22050 Hz。

所以去找你的采样率的奈奎斯特最大频率：**const Float32 NyquistMaxFreq = SAMPLE_RATE/2.0;**

找到 Hz 很容易：**Float32 hz = ((Float32)someIndex / (Float32)fftDataSize) * NyquistMaxFreq;** (fftDataSize = frameSize/2.0)

这对我有用。如果我在 Audacity 中生成特定频率并播放它 - 此代码检测到正确的频率（最强的频率，您还需要在 fftData 中找到 max 来执行此操作）。

（大约 1-2% 仍然有一点不匹配。不知道为什么会发生这种情况。如果有人能解释我为什么 - 那将不胜感激。）

**编辑：**

发生这种不匹配是因为我用于 FFT 的片段太小。使用更大的时域数据块（16384 帧）解决了这个问题。这个问题解释了它： [无法在iphone上获得正确的频率值](https://stackoverflow.com/questions/9477535/unable-to-get-correct-frequency-value-on-iphone)

**编辑：** 这是示例项目：[https ://github.com/krafter/DetectingAudioFrequency](https://github.com/krafter/DetectingAudioFrequency)

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-07-27T21:35:21.140

像这样的问题在这里被问了很多。（我在[这里](https://stackoverflow.com/a/11569383/547291)回答了一个类似的问题）所以我写了一个小教程，其中包含您甚至可以在商业和闭源应用程序中使用的代码。这不一定是最好的方式，但它是许多人理解的方式。您将不得不根据“每个短音乐片段的赫兹平均值”的意思对其进行修改。例如，您是指基本音高还是频率质心。

正如另一个答案所建议的那样，您可能希望在加速框架中使用 Apple 的 FFT。

希望能帮助到你。

[http://blog.bjornroche.com/2012/07/frequency-detection-using-fft-aka-pitch.html](http://blog.bjornroche.com/2012/07/frequency-detection-using-fft-aka-pitch.html)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-07-27T16:37:38.823

Apple 不提供频率或音高估计的框架。但是，iOS Accelerate 框架确实包含 FFT 和自相关例程，可用作更复杂的频率和音高识别或估计算法的组件。

除了几乎零噪声中的单个长连续恒定频率纯正弦音调外，没有一种既简单又最好的方法，其中长窗 FFT 的插值幅度峰值可能是合适的。对于语音和音乐，这种简单的方法通常根本不起作用。但是对音高检测或估计方法的搜索会发现大量关于更合适算法的研究论文。

# windows-phone-7 - 重新启动 WP7 模拟器后检索数据库

> ID：11686626
> 
> 赞同：0
> 
> 时间：2012-07-27T11:12:08.230
> 
> 标签：windows-phone-7, isolatedstorage, windows-phone-7-emulator

每次我重新启动模拟器时，我都会丢失我创建的数据库。有什么办法可以保存它，以便我下次使用模拟器时可以使用它？我可以通过模拟器访问存储在我计算机中的数据库吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T11:54:31.777

对于您的第一个问题 - 不，但您*可以避免*在会话之间重新启动模拟器。这样，本地存储将保持不变。

对于您的第二个问题 - 不，至少不是作为模拟器内部数据库的替代品。但是，您可能可以编写一些自定义逻辑来让您的代码查询一些示例数据？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T14:36:26.360

[Windows Phone Power Tools](http://wptools.codeplex.com/)将允许您将数据库文件从模拟器复制到您的 PC，反之亦然。

# security - 复制安全性的任何替代方案

> ID：11686627
> 
> 赞同：0
> 
> 时间：2012-07-27T11:12:11.313
> 
> 标签：security, replication, sql-server-2012

我使用 sql server 2012 和事务复制。为了复制安全，我在订阅者、发布者上创建了一个用户，并将 db_owner 权限授予该用户。我还授予该用户分发数据库的 db_owner 权限。它还包括将此用户添加到 PAL（公开访问列表）。

但是根据此链接，授予 db_owner 权限将完全控制数据库，还包括删除数据库的权限。我们如何才能克服这个问题，是否有任何替代方案。

实现复制安全的任何其他方式。

请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-28T03:54:14.753

复制需要对所涉及的大多数数据库进行 db_owner 级别的访问。在这里查看我的文章系列：[http ://www.sqlservercentral.com/stairway/72401/](http://www.sqlservercentral.com/stairway/72401/)

简而言之，别无选择。使用具有强密码的单独帐户进行复制，不要在其他地方重复使用这些帐户，以尽量减少误用的可能性。

# css - css 宽度 100% 仅覆盖屏幕的大小（滚动后不覆盖行）

> ID：11686629
> 
> 赞同：2
> 
> 时间：2012-07-27T11:12:28.097
> 
> 标签：css, width

在我的 CSS 代码中，我设置了 background-image:url

```
height:100%; 
```

但结果，100%捕获的范围只是屏幕的大小。如果页面有滚动，所有需要滚动的页面行似乎都没有这些背景。

有什么建议么？

注意：我的元素大小动态变化。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T11:38:36.177

这是因为 100% 意味着 100% 的父元素。首先，确保您的文档实际上是 100% 的浏览器窗口。

```
html, body {
    width: 100%;
    height: auto !important;
    height: 100%; /* for older browsers */
    min-height: 100%;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T11:26:18.297

```
body
{
background-image:url('paper.gif');
background-repeat:repeat-y;
} 
```

# vb.net - 在 VB.NET 中拖放并获取文件路径

> ID：11686631
> 
> 赞同：18
> 
> 时间：2012-07-27T11:12:41.140
> 
> 标签：vb.net, winforms, drag-and-drop

我希望能够将文件/可执行文件/快捷方式拖到 Windows 窗体应用程序中，并让应用程序确定拖放文件的原始路径，然后将其作为字符串返回。

例如，将图像从桌面拖到应用程序和消息框上的图像的本地路径。

那可能吗？有人可以给我举个例子吗？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-07-27T11:30:06.040

这很容易。[`AllowDrop`](https://docs.microsoft.com/dotnet/api/system.windows.forms.control.allowdrop)只需通过将属性设置为`True`并处理[`DragEnter`](https://docs.microsoft.com/dotnet/api/system.windows.forms.control.dragenter)和[`DragDrop`](https://docs.microsoft.com/dotnet/api/system.windows.forms.control.dragdrop)事件来启用拖放。

在`DragEnter`事件处理程序中，您可以使用类检查数据是否属于您想要的[`DataFormats`](https://msdn.microsoft.com/dotnet/api/system.windows.forms.dataformats.aspx)类型。

在`DragDrop`事件处理程序中，使用接收实际数据的[`Data`](https://msdn.microsoft.com/dotnet/api/system.windows.forms.drageventargs.data)属性和方法[`DragEventArgs`](https://docs.microsoft.com/dotnet/api/system.windows.forms.drageventargs)[`GetData`](https://docs.microsoft.com/dotnet/api/system.windows.dataobject.getdata)

* * *

**例子：**

```
Private Sub Form1_Load(sender As System.Object, e As System.EventArgs) Handles MyBase.Load
    Me.AllowDrop = True
End Sub

Private Sub Form1_DragDrop(sender As System.Object, e As System.Windows.Forms.DragEventArgs) Handles Me.DragDrop
    Dim files() As String = e.Data.GetData(DataFormats.FileDrop)
    For Each path In files
        MsgBox(path)
    Next
End Sub

Private Sub Form1_DragEnter(sender As System.Object, e As System.Windows.Forms.DragEventArgs) Handles Me.DragEnter
    If e.Data.GetDataPresent(DataFormats.FileDrop) Then
        e.Effect = DragDropEffects.Copy
    End If
End Sub 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-04-28T08:05:54.087

这只是说明如果拖放不起作用，可能是因为您在管理员模式下运行 Visual Studio（我相信是 Windows 7 及更高版本）。

这也与当前在 Windows 安装中设置的[UAC级别有关。](http://en.wikipedia.org/wiki/User_Account_Control)

# javascript - 选择两个选项 - 点击 go - 重定向到 url

> ID：11686637
> 
> 赞同：-1
> 
> 时间：2012-07-27T11:13:11.033
> 
> 标签：javascript, select, options

我无法在需要在网站上实现的脚本上找到任何帮助。

1.  `SELECT ONE`
2.  访问者选择 a、b、c 或 d
3.  `SELECT TWO`，然后他们
4.  选择 1, 2, 3, 4, 5, 6 - 到 - 14
5.  `GO`

然后他们单击`go`将他们带到与他们的选择相对应的页面。

我应该补充一点，选项没有被链接，因为选择选项 1 不会改变选项 2 的选择。他们保持不变。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T14:03:16.950

如果要在服务器上处理表单输入，则必须使用 PHP 等服务器端语言。这是实现此目的的简单教程：[http ://www.tizag.com/phpT/forms.php/](http://www.tizag.com/phpT/forms.php/)

如果您想在客户端处理表单，请使用 JavaScript 收集表单中的选定值，然后对这些值执行某些操作。您不需要重定向到另一个页面，因为您可以将事件处理程序附加到表单提交按钮。

例如：

HTML 表单如下所示：

```
<form>
    <select name="firstSelect" id="firstSelect"> ...
      ...
    </select>
    <select name="secondSelect" id="secondSelect">
      ...
    </select>
    <input type="submit" name="submit" id="submit" value="Submit form" onclick="javascript: return processForm();" />
</form> 
```

检查表单的提交按钮：

```
<input type="submit" name="submit" value="Submit form" 
 onclick="javascript: return processForm();" /> 
```

该代码块将在用户单击提交按钮时触发 javasript 函数 processForm()。此外，它会阻止页面重定向。

处理函数如下所示：

```
<script>
   function processForm()
   {
       // fetch selected values from the form and do actions based on that
       var firstValue = $('form select#firstSelect').val();
       var secondValue = $('form select#secondSelect').val();

       // prevent form redirection 
       return false;
   }
</script> 
```

您可能执行的操作示例是在页面上隐藏/显示某些结果 div、显示表单处理的结果等。

# ruby-on-rails - 按太阳黑子中的关联字段排序

> ID：11686641
> 
> 赞同：0
> 
> 时间：2012-07-27T11:13:27.363
> 
> 标签：ruby-on-rails, ruby, solr, sunspot

在我的应用程序中，我使用 Sunspot 进行全文搜索。问题是我想按关联模型字段排序。就我而言：

```
class Movie < ActiveRecord::Base
  attr_accessible :description, :genre, :name
  has_many :premieres
end 
```

我的`Premier`模型有：

```
belongs_to :movie 
```

通过定义方法完成按电影名称搜索：

```
def movie_name
  movie.name
end 
```

但是当我尝试这样做时：

```
order_by :movie_name, :asc 
```

它说：

> 没有为名称为“movie_name”的 Premiere 配置字段

如何使这种排序可用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T18:25:09.623

你可以这样做

```
searchable auto_index: true do
  text :movie_name do
    if self.movie.present?
      self.movie.name
    end
  end
end 
```

那么你可以使用

```
order_by :movie_name, :asc 
```

# ios - UILabel 的逐字母动画？

> ID：11686642
> 
> 赞同：30
> 
> 时间：2012-07-27T11:13:33.527
> 
> 标签：ios, animation, uilabel

有没有办法让`UILabel`. 我希望它逐个字符地显示文本值。

帮我解决这个问题

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2012-07-27T12:12:29.770

**2018 年更新，Swift 4.1：**

```
extension UILabel {

    func animate(newText: String, characterDelay: TimeInterval) {

        DispatchQueue.main.async {

            self.text = ""

            for (index, character) in newText.enumerated() {
                DispatchQueue.main.asyncAfter(deadline: .now() + characterDelay * Double(index)) {
                    self.text?.append(character)
                }
            }
        }
    }

} 
```

调用它很简单并且线程安全：

```
myLabel.animate(newText: myLabel.text ?? "May the source be with you", characterDelay: 0.3) 
```

**@objC，2012：**

试试这个原型函数：

```
- (void)animateLabelShowText:(NSString*)newText characterDelay:(NSTimeInterval)delay
{    
    [self.myLabel setText:@""];

    for (int i=0; i<newText.length; i++)
    {
        dispatch_async(dispatch_get_main_queue(),
        ^{
            [self.myLabel setText:[NSString stringWithFormat:@"%@%C", self.myLabel.text, [newText characterAtIndex:i]]];
        });

        [NSThread sleepForTimeInterval:delay];
    }
} 
```

并以这种方式调用它：

```
dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_LOW, 0),
^{
    [self animateLabelShowText:@"Hello Vignesh Kumar!" characterDelay:0.5];
}); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2015-06-19T23:27:43.860

这是@Andrei G. 作为 Swift 扩展的答案：

```
extension UILabel {

    func setTextWithTypeAnimation(typedText: String, characterInterval: NSTimeInterval = 0.25) {
        text = ""
        dispatch_async(dispatch_get_global_queue(QOS_CLASS_USER_INTERACTIVE, 0)) {
            for character in typedText.characters {
                dispatch_async(dispatch_get_main_queue()) {
                    self.text = self.text! + String(character)
                }
                NSThread.sleepForTimeInterval(characterInterval)
            }
        }
    }

} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-02-20T18:29:14.280

这可能会更好。

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    NSString *string =@"Risa Kasumi & Yuma Asami";

    NSMutableDictionary *dict = [NSMutableDictionary dictionary];
    [dict setObject:string forKey:@"string"];
    [dict setObject:@0 forKey:@"currentCount"];
    NSTimer *timer = [NSTimer scheduledTimerWithTimeInterval:0.1 target:self selector:@selector(typingLabel:) userInfo:dict repeats:YES];
    [timer fire];

}

-(void)typingLabel:(NSTimer*)theTimer
{
    NSString *theString = [theTimer.userInfo objectForKey:@"string"];
    int currentCount = [[theTimer.userInfo objectForKey:@"currentCount"] intValue];
    currentCount ++;
    NSLog(@"%@", [theString substringToIndex:currentCount]);

    [theTimer.userInfo setObject:[NSNumber numberWithInt:currentCount] forKey:@"currentCount"];

     if (currentCount > theString.length-1) {
        [theTimer invalidate];
    }

    [self.label setText:[theString substringToIndex:currentCount]];
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-07-27T12:22:05.640

我写了一个demo，可以用，支持ios 3.2及以上

在你的 .m 文件中

```
- (void)displayLabelText
{

    i--;
    if(i<0)
    {
        [timer invalidate];
    }
    else
    {
        [label setText:[NSString stringWithFormat:@"%@",[text substringToIndex:(text.length-i-1)]]];
    }
}

- (void)viewDidLoad
{
    [super viewDidLoad];

    label = [[UILabel alloc] initWithFrame:CGRectMake(0, 0, 200, 60)];
    [label setBackgroundColor:[UIColor redColor]];
    text = @"12345678";
    [label setText:text];
    [self.view addSubview:label];
    i=label.text.length;
    timer = [NSTimer scheduledTimerWithTimeInterval:1 target:self selector:@selector(displayLabelText) userInfo:nil repeats:YES];
    [timer fire];    
} 
```

在你的 .h 文件中

```
@interface labeltextTestViewController : UIViewController {
    UILabel *label;
    NSTimer *timer;
    NSInteger i;
    NSString *text;
} 
```

使用演示，我认为您可以根据自己的情况进行一些更改，代码看起来非常非常难看，因为我要去吃晚饭，您可以对其进行专业化。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2016-11-29T10:52:35.987

Swift 3，仍然归功于 Andrei G. 的概念。

```
extension UILabel{

func setTextWithTypeAnimation(typedText: String, characterInterval: TimeInterval = 0.25) {
    text = ""
    DispatchQueue.global(qos: .userInteractive).async {

        for character in typedText.characters {
            DispatchQueue.main.async {
                self.text = self.text! + String(character)
            }
            Thread.sleep(forTimeInterval: characterInterval)
        }

    }
}

} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2016-02-21T22:28:15.587

我已经为这个用例编写了一个名为[CLTypingLabel](https://github.com/l800891/CLTypingLabel)的轻量级库，可以在 GitHub 上找到。

它高效、安全且不休眠任何线程。它还提供`pause`和`continue`接口。随时调用它，它不会中断。

安装 CocoaPods 后，在 Podfile 中添加如下内容以使用它：

```
pod 'CLTypingLabel' 
```

## 示例代码

将标签的类从 UILabel 更改为 CLTypingLabel； [![在此处输入图像描述](../Images/6ed542e727d349dd4bb34840d15429d3.png)](https://i.stack.imgur.com/FADaC.png)

```
@IBOutlet weak var myTypeWriterLabel: CLTypingLabel! 
```

在运行时，设置标签的文本会自动触发动画：

```
myTypeWriterLabel.text = "This is a demo of typing label animation..." 
```

您可以自定义每个字符之间的时间间隔：

```
myTypeWriterLabel.charInterval = 0.08 //optional, default is 0.1 
```

您可以随时暂停打字动画：

```
myTypeWriterLabel.pauseTyping() //this will pause the typing animation
myTypeWriterLabel.continueTyping() //this will continue paused typing animation 
```

还有一个带有[cocoapods的示例项目](https://cocoapods.org/pods/CLTypingLabel)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2019-12-24T04:26:35.940

**更新：2019 年，*斯威夫特 5***

有用！只需复制粘贴我的答案并查看您的结果

> `@IBOutlet weak var titleLabel: UILabel!`还要在 viewDidLoad() 之前创建一个

```
override func viewDidLoad() {
    super.viewDidLoad()

    titleLabel.text = ""
    let titleText = "⚡️Please Vote my answer"
    var charIndex = 0.0
    for letter in titleText {
        Timer.scheduledTimer(withTimeInterval: 0.1 * charIndex, repeats: false) { (timer) in
            self.titleLabel.text?.append(letter)
        }
         charIndex += 1
    }

   } 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2019-12-31T14:59:18.243

SwiftUI + 组合示例：

```
struct TypingText: View {
    typealias ConnectablePublisher = Publishers.Autoconnect<Timer.TimerPublisher>
    private let text: String
    private let timer: ConnectablePublisher
    private let alignment: Alignment

    @State private var visibleChars: Int = 0

    var body: some View {
        ZStack(alignment: self.alignment) {
            Text(self.text).hidden() // fixes the alignment in position
            Text(String(self.text.dropLast(text.count - visibleChars))).onReceive(timer) { _ in
                if self.visibleChars < self.text.count {
                    self.visibleChars += 1
                }
            }
        }
    }

    init(text: String) {
        self.init(text: text, typeInterval: 0.05, alignment: .leading)
    }

    init(text: String, typeInterval: TimeInterval, alignment: Alignment) {
        self.text = text
        self.alignment = alignment
        self.timer = Timer.TimerPublisher(interval: typeInterval, runLoop: .main, mode: .common).autoconnect()
    }
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-07-27T11:36:18.623

UILabel 中没有默认行为来执行此操作，您可以根据计时器一次添加每个字母

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2015-10-19T09:02:31.850

我根据第一个答案写了这个：

```
import Foundation

var stopAnimation = false

extension UILabel {

    func letterAnimation(newText: NSString?, completion: (finished : Bool) -> Void) {
        self.text = ""
        if !stopAnimation {
            dispatch_async(dispatch_queue_create("backroundQ", nil)) {
                if var text = newText {
                    text = (text as String) + " "

                    for(var i = 0; i < text.length;i++){
                        if stopAnimation {
                            break
                        }

                        dispatch_async(dispatch_get_main_queue()) {
                            let range = NSMakeRange(0,i)
                            self.text = text.substringWithRange(range)
                        }

                        NSThread.sleepForTimeInterval(0.05)
                    }
                    completion(finished: true)
                }
            }
            self.text = newText as? String
        }
    }
} 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2017-11-24T01:15:20.353

我知道答案为时已晚，但以防万一也有人在 UITextView 中寻找打字动画。我为 Swift 4 编写了一个小型库[Github](https://github.com/rimh/RimhTypingLetters)。您可以在动画完成时设置回调。

```
@IBOutlet weak var textview:TypingLetterUITextView!
textview.typeText(message, typingSpeedPerChar: 0.1, completeCallback:{
       // complete action after finished typing } 
```

另外，我有用于输入动画的 UILabel 扩展。

```
label.typeText(message, typingSpeedPerChar: 0.1, didResetContent = true, completeCallback:{
       // complete action after finished typing } 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-02-06T16:13:08.740

基于@Adam Waite 的回答。如果有人想将其与完成闭包一起使用。

```
 func setTextWithTypeAnimation(typedText: String, characterInterval: NSTimeInterval = 0.05, completion: () ->()) {
    text = ""
    dispatch_async(dispatch_get_global_queue(QOS_CLASS_USER_INTERACTIVE, 0)) {
        for character in typedText.characters {
            dispatch_async(dispatch_get_main_queue()) {
                self.text = self.text! + String(character)
            }
            NSThread.sleepForTimeInterval(characterInterval)
        }

        dispatch_async(dispatch_get_main_queue()) {
            completion()
        }
    }
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2016-04-14T16:25:14.090

修改@Adam Waite 的代码（干得好，顺便说一句）以逐字显示文本：

```
 func setTextWithWordTypeAnimation(typedText: String, characterInterval: NSTimeInterval = 0.25) {
    text = ""
    dispatch_async(dispatch_get_global_queue(QOS_CLASS_USER_INTERACTIVE, 0)) {
        let wordArray = typedText.componentsSeparatedByString(" ")
        for word in wordArray {
            dispatch_async(dispatch_get_main_queue()) {
                self.text = self.text! + word + " "
            }
            NSThread.sleepForTimeInterval(characterInterval)
        }
    } 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2016-07-19T13:08:03.153

对Andrei提供的答案进行了一点改进，而不是阻塞主线程。

```
- (void)animateLabelShowText:(NSString*)newText characterDelay:(NSTimeInterval)delay
{
  [super setText:@""];

  NSTimeInterval appliedDelay = delay;

  for (int i=0; i<newText.length; i++)
  {    
    dispatch_after(dispatch_time(DISPATCH_TIME_NOW, appliedDelay * NSEC_PER_SEC), dispatch_get_main_queue(), ^{
        [super setText:[NSString stringWithFormat:@"%@%c", self.text, [newText characterAtIndex:i]]];
    });

    appliedDelay += delay;

} 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2018-10-05T06:15:53.577

我写了一个小的开源库来做到这一点。我使用 NSAttributedString 构建它，这样标签在动画期间不会调整大小。它还支持打字声音和光标动画

在这里查看：

> [https://github.com/ansonyao/AYTypeWriter](https://github.com/ansonyao/AYTypeWriter)

# android - Android/SQLite：插入更新表列以保留标识符

> ID：11686645
> 
> 赞同：25
> 
> 时间：2012-07-27T11:13:42.327
> 
> 标签：android, sqlite, android-contentprovider, insert-update

目前，我正在使用以下语句在 Android 设备上的 SQLite 数据库中创建表。

```
CREATE TABLE IF NOT EXISTS 'locations' (
  '_id' INTEGER PRIMARY KEY AUTOINCREMENT, 'name' TEXT, 
  'latitude' REAL, 'longitude' REAL, 
  UNIQUE ( 'latitude',  'longitude' ) 
ON CONFLICT REPLACE ); 
```

最后的冲突子句导致在完成具有相同坐标的新插入时**删除行。**[SQLite 文档](http://www.sqlite.org/lang_conflict.html)包含有关冲突子句的更多信息。

相反，我想**保留**以前的行并只**更新**它们的列。在 Android/SQLite 环境中执行此操作的最有效方法是什么？

*   作为`CREATE TABLE`声明中的冲突条款。
*   作为`INSERT`触发器。
*   作为`ContentProvider#insert`方法中的条件子句。
*   ...任何更好的你可以考虑

我认为在数据库中处理此类冲突会更高效。此外，我发现很难重写该`ContentProvider#insert`方法以考虑*插入更新*方案。这是该`insert`方法的代码：

```
public Uri insert(Uri uri, ContentValues values) {
    final SQLiteDatabase db = mOpenHelper.getWritableDatabase();
    long id = db.insert(DatabaseProperties.TABLE_NAME, null, values);
    return ContentUris.withAppendedId(uri, id);
} 
```

当数据从后端到达时，我所做的就是按如下方式插入数据。

```
getContentResolver.insert(CustomContract.Locations.CONTENT_URI, contentValues); 
```

我在弄清楚如何在`ContentProvider#update`此处应用替代调用时遇到问题。此外，无论如何，这不是我最喜欢的解决方案。

* * *

**编辑：**

@CommonsWare：我尝试实施您的建议以使用`INSERT OR REPLACE`. 我想出了这段丑陋的代码。

```
private static long insertOrReplace(SQLiteDatabase db, ContentValues values, String tableName) {
    final String COMMA_SPACE = ", ";
    StringBuilder columnsBuilder = new StringBuilder();
    StringBuilder placeholdersBuilder = new StringBuilder();
    List<Object> pureValues = new ArrayList<Object>(values.size());
    Iterator<Entry<String, Object>> iterator = values.valueSet().iterator();
    while (iterator.hasNext()) {
        Entry<String, Object> pair = iterator.next();
        String column = pair.getKey();
        columnsBuilder.append(column).append(COMMA_SPACE);
        placeholdersBuilder.append("?").append(COMMA_SPACE);
        Object value = pair.getValue();
        pureValues.add(value);
    }
    final String columns = columnsBuilder.substring(0, columnsBuilder.length() - COMMA_SPACE.length());
    final String placeholders = placeholderBuilder.substring(0, placeholdersBuilder.length() - COMMA_SPACE.length());
    db.execSQL("INSERT OR REPLACE INTO " + tableName + "(" + columns + ") VALUES (" + placeholders + ")", pureValues.toArray());

    // The last insert id retrieved here is not safe. Some other inserts can happen inbetween.
    Cursor cursor = db.rawQuery("SELECT * from SQLITE_SEQUENCE;", null);
    long lastId = INVALID_LAST_ID;
    if (cursor != null && cursor.getCount() > 0 && cursor.moveToFirst()) {
        lastId = cursor.getLong(cursor.getColumnIndex("seq"));
    }
    cursor.close();
    return lastId;
} 
```

**但是，当我检查 SQLite 数据库时，仍会删除**相等的列并插入新的 ids 。我不明白为什么会发生这种情况，并认为原因是我的冲突条款。但[文档](http://sqlite.org/lang_conflict.html)说明相反。

> 在 INSERT 或 UPDATE 的 OR 子句中指定的算法将 **覆盖**在 CREATE TABLE 中指定的任何算法。如果任何地方都没有指定算法，则使用 ABORT 算法。

这种尝试的另一个缺点是您丢失了插入语句返回的 id 的值。为了弥补这一点，我终于找到了一个选项来要求`last_insert_rowid`. [正如dtmilano 和 swiz 的帖子中](https://stackoverflow.com/a/4018593/356895)所解释的那样。但是，我不确定这是否安全，因为中间可能会发生另一个插入。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-08-02T15:54:55.643

我可以理解这样一种观念，即在 SQL 中执行所有这些逻辑对性能来说是最好的，但在这种情况下，也许最简单（最少代码）的解决方案是最好的解决方案？为什么不先尝试更新，然后使用`insertWithOnConflict()`with`CONFLICT_IGNORE`进行插入（如有必要）并获取您需要的行 ID：

```
public Uri insert(Uri uri, ContentValues values) {
    final SQLiteDatabase db = mOpenHelper.getWritableDatabase();
    String selection = "latitude=? AND longitude=?"; 
    String[] selectionArgs = new String[] {values.getAsString("latitude"),
                values.getAsString("longitude")};

    //Do an update if the constraints match
    db.update(DatabaseProperties.TABLE_NAME, values, selection, null);

    //This will return the id of the newly inserted row if no conflict
    //It will also return the offending row without modifying it if in conflict
    long id = db.insertWithOnConflict(DatabaseProperties.TABLE_NAME, null, values, CONFLICT_IGNORE);        

    return ContentUris.withAppendedId(uri, id);
} 
```

一个更简单的解决方案是检查的返回值，`update()`并且仅在受影响的计数为零时才进行插入，但是在这种情况下，如果没有额外的选择，您将无法获得现有行的 id。这种形式的插入将始终返回给您正确的 id 以传回`Uri`，并且不会过多地修改数据库。

如果您想一次执行大量这些操作，您可以查看`bulkInsert()`提供程序上的方法，您可以在单个事务中运行多个插入。在这种情况下，由于您不需要返回`id`更新记录的，“更简单”的解决方案应该可以正常工作：

```
public int bulkInsert(Uri uri, ContentValues[] values) {
    final SQLiteDatabase db = mOpenHelper.getWritableDatabase();
    String selection = "latitude=? AND longitude=?";
    String[] selectionArgs = null;

    int rowsAdded = 0;
    long rowId;
    db.beginTransaction();
    try {
        for (ContentValues cv : values) {
            selectionArgs = new String[] {cv.getAsString("latitude"),
                cv.getAsString("longitude")};

            int affected = db.update(DatabaseProperties.TABLE_NAME, 
                cv, selection, selectionArgs);
            if (affected == 0) {
                rowId = db.insert(DatabaseProperties.TABLE_NAME, null, cv);
                if (rowId > 0) rowsAdded++;
            }
        }
        db.setTransactionSuccessful();
    } catch (SQLException ex) {
        Log.w(TAG, ex);
    } finally {
        db.endTransaction();
    }

    return rowsAdded;
} 
```

事实上，事务代码通过最小化数据库内存写入文件的次数来使事情变得更快，`bulkInsert()`只允许`ContentValues`通过一次调用提供者来传递多个。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-02T00:38:51.977

一种解决方案是使用视图上`locations`的 INSTEAD OF 触发器为表创建视图，然后插入到视图中。这就是它的样子：

看法：

```
CREATE VIEW locations_view AS SELECT * FROM locations; 
```

扳机：

```
CREATE TRIGGER update_location INSTEAD OF INSERT ON locations_view FOR EACH ROW 
  BEGIN 
    INSERT OR REPLACE INTO locations (_id, name, latitude, longitude) VALUES ( 
       COALESCE(NEW._id, 
         (SELECT _id FROM locations WHERE latitude = NEW.latitude AND longitude = NEW.longitude)),
       NEW.name, 
       NEW.latitude, 
       NEW.longitude
    );
  END; 
```

不是插入到`locations`表中，而是插入到`locations_view`视图中。触发器将`_id`通过使用子选择来提供正确的值。如果由于某种原因，插入已经包含一个`_id`，`COALESCE`则将保留它并覆盖表中现有的。

您可能想要检查子选择对性能的影响程度，并将其与您可以进行的其他可能更改进行比较，但它确实允许您将此逻辑排除在代码之外。

我尝试了一些其他解决方案，这些解决方案涉及基于 INSERT OR IGNORE 对表本身的触发器，但似乎 BEFORE 和 AFTER 触发器只有在它实际插入表时才会触发。

您可能会发现[此答案](https://stackoverflow.com/a/4330694/857618)很有帮助，这是触发器的基础。

编辑：由于忽略插入时 BEFORE 和 AFTER 触发器不会触发（然后可能已经更新），我们需要使用 INSTEAD OF 触发器重写插入。不幸的是，这些不适用于表格 - 我们必须创建一个视图才能使用它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-31T00:37:46.290

`INSERT OR REPLACE`就像`ON CONFLICT REPLACE`. 如果具有唯一列的行已经存在并且它会插入，它将删除该行。它永远不会更新。

我建议您坚持使用当前的解决方案，使用`ON CONFLICT`clausule 创建表，但是每次插入一行并且发生约束冲突时，您的新行都会有新`_id`的原始行将被删除。

或者您可以创建不带分句的表`ON CONFLICT`并使用`INSERT OR REPLACE`，您可以为此使用[insertWithOnConflict()](http://developer.android.com/reference/android/database/sqlite/SQLiteDatabase.html#insertWithOnConflict%28java.lang.String,%20java.lang.String,%20android.content.ContentValues,%20int%29)方法，但它从 API 级别 8 开始可用，需要更多编码并导致与带分句的表相同的解决方案`ON CONFLICT`。

如果您仍想保留原始行，则意味着您想保持不变`_id`，您将必须进行两次查询，第一个用于插入行，第二个用于在插入失败时更新行（反之亦然）。为了保持一致性，您必须在事务中执行查询。

```
 db.beginTransaction();
    try {
        long rowId = db.insert(table, null, values);
        if (rowId == -1) {
            // insertion failed
            String whereClause = "latitude=? AND longitude=?"; 
            String[] whereArgs = new String[] {values.getAsString("latitude"),
                    values.getAsString("longitude")};
            db.update(table, values, whereClause, whereArgs);
            // now you have to get rowId so you can return correct Uri from insert()
            // method of your content provider, so another db.query() is required
        }
        db.setTransactionSuccessful();
    } finally {
        db.endTransaction();
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-18T12:48:46.883

使用`insertWithOnConflict`并将最后一个参数 ( `conflictAlgorithm`) 设置为`CONFLICT_REPLACE`。

在以下链接中阅读更多信息：

[insertWithOnConflict 文档](http://developer.android.com/reference/android/database/sqlite/SQLiteDatabase.html#insertWithOnConflict%28java.lang.String,%20java.lang.String,%20android.content.ContentValues,%20int%29)

[CONFLICT_REPLACE 标志](http://developer.android.com/reference/android/database/sqlite/SQLiteDatabase.html#CONFLICT_REPLACE)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-05-25T22:47:12.807

对我来说，如果我没有“_id”，这些方法都不起作用

您应该首先调用更新，如果受影响的行为零，然后将其插入忽略：

```
 String selection = MessageDetailTable.SMS_ID+" =?";
 String[] selectionArgs =  new String[] { String.valueOf(md.getSmsId())};

 int affectedRows = db.update(MessageDetailTable.TABLE_NAME, values, selection,selectionArgs);

 if(affectedRows<=0) {
     long id = db.insertWithOnConflict(MessageDetailTable.TABLE_NAME, null, values, SQLiteDatabase.CONFLICT_IGNORE);
 } 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2012-08-03T18:29:39.330

使用**插入或替换**。

这是正确的做法。

# android - Android ImageButton 不起作用

> ID：11686647
> 
> 赞同：-2
> 
> 时间：2012-07-27T11:13:46.690
> 
> 标签：android, imagebutton

这是我的布局：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="@color/white" >

    <ImageButton
        android:id="@+id/one_button"
        android:layout_width="125dp"
        android:layout_height="125dp"
        android:layout_alignParentRight="true"
        android:layout_marginRight="20dp"
        android:layout_marginTop="20dp"
        android:background="@drawable/1"
        android:contentDescription="@string/by1" />

    <ImageButton
        android:id="@+id/two_button"
        android:layout_width="125dp"
        android:layout_height="125dp"
        android:layout_alignParentLeft="true"
        android:layout_alignParentTop="true"
        android:layout_marginLeft="20dp"
        android:layout_marginTop="20dp"
        android:background="@drawable/2"
        android:contentDescription="@string/by2" />

    <ImageButton
        android:id="@+id/three_button"
        android:layout_width="125dp"
        android:layout_height="125dp"
        android:layout_alignParentLeft="true"
        android:layout_marginLeft="20dp"
        android:layout_marginTop="185dp"
        android:background="@drawable/3"
        android:contentDescription="@string/by3" />

    <ImageButton
        android:id="@+id/four_button"
        android:layout_width="125dp"
        android:layout_height="125dp"
        android:layout_alignParentRight="true"
        android:layout_marginRight="20dp"
        android:layout_marginTop="185dp"
        android:background="@drawable/4"
        android:contentDescription="@string/by4" />

</RelativeLayout> 
```

这是我的代码：

```
@Override
public void onClick(View v) {
    // TODO Auto-generated method stub

    switch (v.getId()) {
        case R.id.one_button :
            startActivity(new Intent("android.intent.action.GROUP"));
            break;
        case R.id.two_button :
            startActivity(new Intent("android.intent.action.ATOZ"));
            break;
        case R.id.three_button :
            startActivity(new Intent("android.intent.action.ATOZ"));
            break;
        default :
            break;
    }

} 
```

现在，如果我按下`one_button`或`two_button`一切按预期工作，但如果我按下`three_button`没有任何反应。

我究竟做错了什么？

PS - 清单没问题，因为`two_button`启动了所需的活动。

谢谢，

收藏夹

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-27T11:14:58.157

按钮名称不能以数字开头

尝试将 更改`Button Ids`为 as`button_1`而不是`1_button`.

它会起作用的。

可能是您没有在第三个按钮上添加侦听器...

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-27T11:18:50.937

您是否在 3_button 上设置了 onClickListener。

```
ImageButton btn=(ImageButton)findViewById(R.id.3_button);
btn.setOnClickListener(this); 
```

# java - 我可以在 Java 中乘以 charAt 吗？

> ID：11686648
> 
> 赞同：0
> 
> 时间：2012-07-27T11:13:47.477
> 
> 标签：java, string, char

当我尝试将 charAt 相乘时，我收到了“大”数字：

```
String s = "25999993654";
System.out.println(s.charAt(0)+s.charAt(1)); 
```

结果：103

但是当我只想收到一个号码时，没关系。

在 JAVA 文档上：

```
the character at the specified index of this string. The first character is at index 0. 
```

所以我需要解释或解决方案（我认为我应该将 string 转换为 int ，但在我看来这是不必要的工作）

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-27T11:18:33.947

`char`是一个[整数类型](http://docs.oracle.com/javase/specs/jls/se7/html/jls-4.html#jls-4.2.1)。`s.charAt(0)`您的示例中的值是`char`数字 50（的字符代码`'2'`）的版本。`s.charAt(1)`是`(char)53`。当您`+`在它们上使用它们时，它们会转换为整数，最终得到 103（而不是 100）。

如果您尝试使用*数字* `2`，`5`是的，您必须解析它们。或者，如果您知道它们是标准 ASCII 样式的数字（字符代码 48 到 57，包括），您可以从中减去 48（因为 48 是 的字符代码`'0'`）。或者更好的是，正如 Peter Lawrey 在其他地方指出的那样， use[`Character.getNumericValue`](http://docs.oracle.com/javase/7/docs/api/java/lang/Character.html#getNumericValue%28char%29)可以处理更广泛的字符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T11:21:43.463

是的 - 您应该解析提取的数字或使用 ASCII 图表功能并减去 48：

```
public final class Test {
    public static void main(String[] a) {
        String s = "25999993654";
        System.out.println(intAt(s, 0) + intAt(s, 1));
    }

    public static int intAt(String s, int index) {
        return Integer.parseInt(""+s.charAt(index));
        //or
        //return (int) s.charAt(index) - 48;
    }
} 
```

# visual-studio-2010 - 如何在 Visual Studio 项目模板中获取项目位置？

> ID：11686655
> 
> 赞同：1
> 
> 时间：2012-07-27T11:14:14.743
> 
> 标签：visual-studio-2010, parameters, msbuild, project-template

我想创建一个自定义 Visual Studio 项目模板。我可以读取 Visual Studio 的 New-Project-Wizard 中指定的位置路径吗？

我的目标是导入具有自定义构建目标的文件。该文件位于与我的新项目相关的目录中。

我试过这样：

```
<Import Project="..\Deployment\custom.targets" /> 
```

但是当从我的模板创建一个新项目时，它将指向一个临时用户目录。

在 MSDN 上，我发现[这篇文章](http://msdn.microsoft.com/en-us/library/eehb4faa%28v=vs.100%29.aspx)表明没有包含位置路径的参数。我不敢相信...

有谁可以帮我离开这里吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-27T15:13:09.103

您可以在 ProjectFinishedGenerationg 事件中获取解决方案路径：

```
public void ProjectFinishedGenerating(Project project)
        {

            string solutionPath = System.IO.Path.GetDirectoryName(project.DTE.Solution.FullName);

        } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-30T08:27:54.937

由于在实例化项目时不需要自定义目标，因此我通过以下条件解决了这个问题：

```
<Import Project="..\Deployment\custom.targets" Condition="exists('..\Deployment\custom.targets')" /> 
```

# foursquare - 现在 api 已经推出。有没有办法获得签入的用户详细信息？

> ID：11686656
> 
> 赞同：2
> 
> 时间：2012-07-27T11:14:20.510
> 
> 标签：foursquare

我们在我们的应用程序中集成了 hereNow api，以显示特定场所的签到客户。现在由于 hereNow api 中的政策变化，我们没有得到任何结果。有没有办法在不作为商店经理的情况下获取场地的签到用户详细信息？

谢谢，湿婆

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T20:39:00.033

不可以。当前签到某个场所的用户的身份仅适用于代表朋友、其他签到该场所的人或该场所的经理提出请求的应用程序。

# java - 需要 .parse 函数的替代方案

> ID：11686662
> 
> 赞同：2
> 
> 时间：2012-07-27T11:14:36.930
> 
> 标签：java, parsing

我目前正在处理具有不同基数的数字。我正在使用函数 Long.parseLong 将数字从基本 int 转换为其十进制值：

Long.parseLong("A", 16) 将十六进制的 A 转换为其十进制值 10。然后我使用 Long.toString(10, 16) 将其转换回 A。

现在的问题是问题集中的一个条目是“AAAAAAAAAAAAAAAAAAAA”，当我使用 Long.parseLong(); 函数，它返回一个错误，因为转换的大小不能适合 Long。我尝试使用 Float，但恐怕没有以 int 为基数的 Float.parseFloat(String, int)。

有没有我可以使用的替代方案？BigInteger 也没有任何带有基数的解析函数。

任何帮助都感激不尽。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-27T11:22:24.850

`BigInteger`有[一个构造函数](http://docs.oracle.com/javase/6/docs/api/java/math/BigInteger.html#BigInteger%28java.lang.String,%20int%29)，它为您进行基数转换：

```
BigInteger num = new BigInteger("AAAAAAAAAAAAAAAAAAA", 16); 
```

如果你想转换回十六进制，你可以使用[`toString`](http://docs.oracle.com/javase/6/docs/api/java/math/BigInteger.html#toString(int))：

```
String hex = num.toString(16); 
```

# javascript - Web 客户端缓存

> ID：11686663
> 
> 赞同：1
> 
> 时间：2012-07-27T11:14:37.490
> 
> 标签：javascript, flash, caching, local-storage

我们正在构建基于网络的音频编辑器的概念模型。我们遇到的第一个问题是客户端缓存系统。在我看来，作为在客户端拥有巨大缓存的服务器端程序员是完美的主意，因为在许多情况下，除了多次加载相同数据外，它会占用服务器负载。此外，这种缓存可能是提供每个轨道操作（如过滤）的缓冲区的良好候选者。

我们的 flex 程序员说这是一个很大的麻烦，几乎在任何情况下都是不可能的。但我非常怀疑，因为我知道实际的 Google Chrome 浏览器版本可以简单地在 localStorage 中保持高达 2 Gb。此外，我发现[了这个](http://advanced.aviary.com/tools/audio-editor)在线曲目编辑器的例子，看起来它的缓存机制工作得很好。

是否可以使用 flash 和 js 在客户端缓存一些数据（大约 100-200mb）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T11:29:42.427

如果您使用的是 html5，那么您可以使用[html5 内置数据库在客户端存储大量数据。](http://www.tutorialspoint.com/html5/html5_web_sql.htm)

也参考这个[链接](http://www.aquim.com/web-article-237.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T11:26:47.203

您可以使用 SharedObject 来存储数据。

我很确定默认大小限制对于您的需求来说太低了，因此您的应用程序需要要求用户接受您的新限制： http:
[//www.macromedia.com/support/documentation/en/flashplayer/help/help06 .html](http://www.macromedia.com/support/documentation/en/flashplayer/help/help06.html)

SharedObject 比浏览器缓存更可靠，您可以从应用程序中控制它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-27T14:02:53.587

我们在编写视频编辑器时做了什么。好吧，实际上，在 Flash 中，您可以将文件保存到用户的机器上，但限制是它必须对用户透明（即用户启动操作，通过操作系统对话框并保存文件，因为他们通常会保存任何下载），类似地，您可以从用户的计算机加载文件，但限制是用户必须启动操作（例如通过使用指点设备单击或按键）。

这与不同的本地存储策略相比具有一定的优势，这些策略对用户来说大多是不透明的（人们通常不知道如何擦除更现代浏览器附带的 cookie、SharedObjects 或 Web 存储，但它们几乎能够保存和删除系统上的文件）。此外，所有其他不透明的本地存储可能具有一些限制，不太精明的用户可能不知道如何克服/可能无法克服一般情况——这些限制是大小、位置和所有权。

这对您的听众来说仍然会有些障碍，因为每次他们需要保存文件时，他们都必须通过操作系统的对话框，而不是执行 Ctrl+S / Cmd+S / Cx Cs... 但是考虑到所有其他选项，这个，IMO，给用户留下最多的选择/提供最好的体验。

另一个建议——原则上，你可以为你的应用程序提供一个基于浏览器的“增强”版本，用户可以将其安装为浏览器插件（如果这是他们经常使用的编辑器——为什么不呢？），在这种情况下，您将不会受到网络技术提供的笨拙选项的限制。基于 Chrome 和 Mozilla 的浏览器鼓励这种开发，但它不是标准化的。尽管如此，由于这两个浏览器几乎可以在任何操作系统上运行，这听起来并不特别像将您的用户锁定在某个平台上......

# mysql - 如何连接表以获得每一行源表的一行？

> ID：11686664
> 
> 赞同：1
> 
> 时间：2012-07-27T11:14:37.240
> 
> 标签：mysql, join, outer-join, cross-join, full-outer-join

我在两个表中有两种不同类型的实体，只有几个公共列我想加入并按其中一个公共列排序。在结果表中，每一行应该代表一个表中的一行或另一个表中的一行。例如，对于这样的表：

```
CREATE TABLE apple (
    apple_id INT NOT NULL AUTO_INCREMENT,
    acquired DATETIME NOT NULL,
    is_fresh TINYINT,
    PRIMARY KEY (apple_id)
);

'1', '2012-07-27 19:06:58', '1'
'2', '2012-07-28 18:05:43', '0'

CREATE TABLE orange (
    orange_id INT NOT NULL AUTO_INCREMENT,
    acquired DATETIME NOT NULL,
    is_yummy TINYINT,
    PRIMARY KEY (orange_id)
);

'1', '2012-06-12 10:03:31', '0'
'2', '2012-08-30 22:00:02', '1' 
```

我对加入他们的查询的想法是这样的：

```
SELECT
    IF(orange_id IS NULL, 'apple', 'orange') AS type,
    IF(orange_id IS NULL, apple.acquired, orange.acquired) AS acquired,
    is_fresh,
    is_yummy
FROM apple CROSS JOIN orange ON apple_id IS NULL OR orange_id IS NULL
ORDER BY acquired ASC

'orange', '2012-06-12 10:03:31', NULL, '0'
'apple', '2012-07-27 19:06:58', '1', NULL
'apple', '2012-07-28 18:05:43', '0', NULL
'orange', '2012-08-30 22:00:02', NULL, '1' 
```

我发现此查询存在一些问题：

1.  如果我了解它`CROSS JOIN`的工作原理，查询将非常慢，因为它会遍历所有可能的苹果-橙子组合，不是吗？有更快的方法吗？

2.  这些`IF(...)`功能看起来很难看。他们真的有必要吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T11:27:12.443

我不确定这是否可以解决您的问题。但是您可以使用联合进行类似的输出。相对而言，联合会比交叉连接更快。

# xml - Using XJC with XMLCatalog using relative paths

> ID：11686667
> 
> 赞同：0
> 
> 时间：2012-07-27T11:14:48.000
> 
> 标签：xml, xjc, xmlcatalog

I use XJC and now I want to use XMLCataloges which refers to other cataloges. The problem is that it should be able to use relative paths instead of absolute paths when referencing to other cataloges.

This catalog is placed in project1 and should refer to the catalog.xml file located in the project2.

```
<catalog xmlns="urn:oasis:names:tc:entity:xmlns:xml:catalog">

<public publicId="http://company.com/test"
    uri="src/main/resources/test.xsd" />

<nextCatalog catalog="../project2/catalog.xml" /></catalog> 
```

The XJC call looks like this:

```
<java fork="true" jar="${xjc-jar-file}">
    <!-- folder where the generated files should be saved -->
    <arg value="-d" />
    <arg value="${target-folder}"/>
        <arg value="-extension" />
    <!-- catalog file -->
    <arg value="-catalog" />
    <arg value="${catalog-file}" />
    <!-- current xsd file -->
    <arg value="@{xsd-file}" />
</java> 
```

Have I made a mistake in the catalog file, or is there any workaround for using such catalog with XJC?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T11:19:45.813

My web search for using relative paths was not successful.

Finally I ended up with writing an ant task which edit catalog files.

In detail the task edit the xml:base attributeof the catalog file and insert the absolute path to the catalog file. Then I save the catalog as e.g. catalog_temp.xml and get all nextCatalog nodes with XPath which will be edited recursive like the first one.

After executing XJC I execute my ant task again which deletes all edited (catalog_temp.xml) cataloges.

# c# - 打开具有特定块大小的文件句柄

> ID：11686675
> 
> 赞同：1
> 
> 时间：2012-07-27T11:15:26.327
> 
> 标签：c#, .net, windows

我正在尝试将一些数据写入磁带驱动器 - 我正在使用在这里找到的一个类：http: [//www.codeproject.com/Articles/15487/Magnetic-Tape-Data-Storage-Part-1-Tape-Drive- IO-Co](http://www.codeproject.com/Articles/15487/Magnetic-Tape-Data-Storage-Part-1-Tape-Drive-IO-Co)

我可以很好地使用“加载”方法加载磁带驱动器，尽管当我尝试写入磁带时出现以下错误：

> IO 操作将不起作用。文件很可能会变得太长或句柄未打开以支持同步 IO 操作。

我相信这个问题是由于文件句柄使用了不正确的块大小。我知道设备的块大小是：32768 - 虽然我怎样才能使用这个块大小打开文件句柄？

```
TapeOperator TapeOperatorObject = new TapeOperator();

// Load tape 1
TapeOperatorObject.Load(@"\\.\Tape1");

// Write to tape drive
Console.WriteLine("Writing");
FileStream inputFile = new FileStream("test.txt", FileMode.Open);
TapeOperatorObject.Write(0, ReadFully(inputFile));

   public static byte[] ReadFully(Stream input)
    {
        byte[] buffer = new byte[16 * 1024];
        using (MemoryStream ms = new MemoryStream())
        {
            int read;
            while ((read = input.Read(buffer, 0, buffer.Length)) > 0)
            {
                ms.Write(buffer, 0, read);
            }
            return ms.ToArray();
        }
    } 
```

我正在使用的类中的 Write 方法如下：

```
 /// <summary>
        /// Writes to the tape given stream starting from given postion
        /// </summary>
        /// <param name="startPos"></param>
        /// <param name="stream"></param>
        public void Write( long startPos, byte[] stream )
        {
            // Get number of blocks that will be nned to perform write
            uint numberOfBlocks = GetBlocksNumber( stream.Length );

            // Updates tape's current position
            SetTapePosition( startPos );

            byte[] arrayToWrite = new byte[ numberOfBlocks * BlockSize ];
            Array.Copy( stream, arrayToWrite, stream.Length );

            // Write data to the device
            m_stream.Write( stream, 0, stream.Length );
            m_stream.Flush();
        } 
```

谢谢

*   大卫

# java - 创建lucene索引的方法

> ID：11686677
> 
> 赞同：1
> 
> 时间：2012-07-27T11:15:27.957
> 
> 标签：java, search, lucene, indexing

我正在为新闻网站实现搜索功能。在那个网站上，用户提交包含标题和文本的新闻文章，目前这些文章是直接插入数据库的。听说在包含 long..long 文本的数据库中进行全文搜索效率不高。

所以我尝试使用 lucene 进行索引和搜索。我可以用它索引完整的数据库，也可以搜索内容。但我不确定我是否使用了最好的方法。

这是我的索引器类：

```
public class LuceneIndexer {
    public static void indexNews(Paste p ,IndexWriter indexWriter) throws IOException {

        Document doc = new Document();
        doc.add(new Field("id", p.getNewsId(), Field.Store.YES, Field.Index.NO));
        doc.add(new Field("title", p.getTitle(), Field.Store.YES, Field.Index.TOKENIZED));
        doc.add(new Field("text", p.getNewsRawText(), Field.Store.YES, Field.Index.UN_TOKENIZED));
        String fullSearchableText = p.getTitle() + " " + p.getNewsRawText();

        doc.add(new Field("content", fullSearchableText, Field.Store.NO, Field.Index.TOKENIZED));
        indexWriter.addDocument(doc);
    }

    public static void rebuildIndexes() {

        try {
            System.out.println("started indexing");
            IndexWriter w = getIndexWriter();
            ArrayList<News> n = new GetNewsInfo().getLastPosts(0);
            for (News news : n) {
                indexNews(news,w );
            }
             closeIndexWriter(w);
             System.out.println("indexing done");
        } catch (Exception e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

    }

    public static IndexWriter getIndexWriter() throws CorruptIndexException, LockObtainFailedException, IOException {

        IndexWriter indexWriter = new IndexWriter(GlobalData.LUCENE_INDEX_STOREAGE, new StandardAnalyzer(), true);
        return indexWriter;
    }

    public static void closeIndexWriter(IndexWriter w) throws CorruptIndexException, IOException {
        w.close();

    } 
```

上面的代码有效吗？

我认为我应该在用户提交文档时将其添加到索引中，而不是再次索引整个数据库。

*   每次提交文章时我都需要创建新的 IndexWriter 吗？
*   频繁地打开和关闭 IndexWriter 有效率吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T11:54:22.587

您是对的，您不需要将每个文档都读取到索引中，您只需添加新文档，其余的将保留在索引中。

但是你每次都需要创建一个新的 IndexWriter。如果您愿意，您可以使用服务或其他东西来保持 IndexWriter 活着，但打开和关闭不会花费太多时间。如果您确实重用了 IndexWriter，请确保在每次添加后使用 indexWriter.commit()。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T11:55:36.580

> 每次提交文章时我都需要创建新的 IndexWriter 吗？

不

> 频繁地打开和关闭 IndexWriter 有效率吗？

当然不！[您应该阅读此处](http://wiki.apache.org/lucene-java/ImproveIndexingSpeed)的索引指南。

# php - 优化我的项目的场景对象

> ID：11686686
> 
> 赞同：1
> 
> 时间：2012-07-27T11:16:17.427
> 
> 标签：php, mysql, optimization, query-optimization

我的 queryScenario.php 文件加载速度太慢，平均 28 秒。我该怎么做才能通过查询和循环来减少这种情况？我不知道如何处理它，因为我对优化 PHP 几乎一无所知。

谢谢。

这是我的 queryScenario.php 文件：

```
<?php
        include("database.php");
        include("dataModel.php");

        if(!isset($_SESSION))
            session_start();

        //$userId = 1; // This variable will be obtained from the session
        $userId = $_SESSION['userIdNumber'];
        //$selectedUserLandId = $_GET['id']; // This variable may be defined as a session variable
        $selectedUserLandId = $_SESSION['selectedUserLandId'];

        // load the related user based model tables (dynamic data)
        $landLiteral = dbGetUserLandByLandId($userId, $selectedUserLandId); 
        if (count($landLiteral)< 1){
            // TODO: Throw an exception here          
        }
        $landLiteralSelected = $landLiteral[0];
        $userLand = new Land();
        $userLand->id = $landLiteralSelected["id"];
        $userLand->name = $landLiteralSelected["name"];
        $userLand->desc = $landLiteralSelected["description"];
        $landmap = dbGetLandmapById($landLiteralSelected["id"]);
        $userLand->mapimage = $landmap[0]["mapimage"];
        $geopos = dbGetGeoposById($landLiteralSelected["geopos_id"]);
        $userLand->lat = $geopos[0]["lat"];
        $userLand->lng = $geopos[0]["lng"] ;
        $userLand->type = $landLiteralSelected["landenum_id"];
        $sectorsLiteral = dbGetSectorsByLandId($userLand->id);
        foreach ($sectorsLiteral as $sectorLiteral){
           $sector = new Sector();
            $sector->id = $sectorLiteral["id"];
            $sector->name = $sectorLiteral["name"];
            $sector->desc = $sectorLiteral["description"];
            $geoposSector = dbGetGeoposById($sectorLiteral["geopos_id"]);
            $sector->lat = $geoposSector[0]["lat"];
            $sector->lng = $geoposSector[0]["lng"] ;
            $userLand->sectionList[] = $sector;

            $devicesLiteral = dbGetDevicesBySectorId($sector->id);
            foreach ($devicesLiteral as $deviceLiteral){
                $device = new Device();
                $device->id = $deviceLiteral["id"];
                $device->sceneName = $deviceLiteral["scenename"];
                $device->sceneDesc = $deviceLiteral["scenedescription"];
                $mapinfoDevice = dbGetMapInfoById($deviceLiteral["mapitem_id"]);
                $device->mapInfo[] = $mapinfoDevice[0];
                $geoposDevice = dbGetGeoposById($deviceLiteral["geopos_id"]);
                $device->lat = $geoposDevice[0]["lat"];
                $device->lng = $geoposDevice[0]["lng"];
                $device->type = $deviceLiteral["deviceenum_id"];
                $device->serialNo = $deviceLiteral["serialNo"];
                $sector->deviceList[] = $device;

                // NOW THE MODULES
                $modulesLiteral = dbGetDeviceModulesByDeviceType($device->type);

                foreach($modulesLiteral as $moduleLiteralList){
                    foreach ($moduleLiteralList as $moduleLiteral){
                        $module = new Module();
                        $module->id = $moduleLiteral["id"];
                        $module->type = $moduleLiteral["moduleenum_id"];
                        $module->unit = $moduleLiteral["unit"];
                        $module->subid = dbGetSubIdOfModule($module->id);
                        $deviceStateLiteral=dbGetDeviceStates($device->id);

                        if (count($deviceStateLiteral) > 0){
                            $moduleState=new ModuleState();
                            $moduleState->pendingState=$deviceStateLiteral[0]["pending_state"];
                            $moduleState->desiredState=$deviceStateLiteral[0]["desired_state"];
                            $moduleState->currentState=$deviceStateLiteral[0]["current_state"];
                            $module->moduleState=$moduleState;
                        }
                        $moduleDataLiteral=dbGetLastDeviceModuleData($device->id,$module->id);
                        $moduleData=new ModuleData();
                        if (count($moduleDataLiteral) > 0){
                            $moduleData->data=$moduleDataLiteral[0]["value"]." ".$module->unit;
                            $moduleData->timeStamp=$moduleDataLiteral[0]["timestamp"];
                        }else{
                               $moduleData->data="Veri Yok";
                               $moduleData->timeStamp="Veri Yok";
                        }
                              $module->moduleData=$moduleData;

                        $device->moduleList[] = $module;

                        // NOW THE MODULE SPECS
                        // First, get the default specs
                        $specsLiteral = dbGetDefaultSpecsByModuleId($module->id);

                        foreach($specsLiteral as $specLiteral){
                            $spec = new Spec();
                            $spec->type = $specLiteral["specenum_id"];
                            $spec->editable = $specLiteral["editable"];
                            $spec->value = $specLiteral["default"];

                            // NOW LOOK FOR UPDATED SPEC FOR THIS DEVICE MODULE AND SPEC
                            $updatedSpecLiteral = dbGetUpdatedDeviceSpec($device->id, $module->id, $spec->type);

                            if ($updatedSpecLiteral){
                               $spec->value = $updatedSpecLiteral[0]["specvalue"];
                            }

                            $module->specList[] = $spec;
                        }
                    }           
                }
            }
        }
        if(!(isset($_GET["nonEcho"]) && $_GET["nonEcho"]=="yes"))
            echo json_encode($userLand);

?> 
```

这些是数据模型：

```
<?php
class Node {
    public $id;
}

class SpatialNode extends Node {
    public $lat = 0;
    public $lng = 0;
}

class Land extends SpatialNode{
    public $name;
    public $desc = "";
    public $type;
    public $sectionList = array();
    public $mapimage;
}

class Sector extends SpatialNode{
    public $name;
    public $desc = "";
    public $deviceList = array();
}

class Device extends SpatialNode{
    public $sceneName;
    public $sceneDesc;
    public $type;
    public $desc = "";
    public $serialNo;
    public $installationDate = "";
    public $moduleList = array();
    public $mapInfo = array();
}

class Module extends Node{
    public $type;
    public $unit = "";
    public $subid;
    public $specList = array();
    public $moduleData;
    public $moduleState;
}

class ModuleData{
    public $data;
    public $timeStamp;
}
class ModuleState{
    public $pendingState;
    public $desiredState;
    public $currentState;
}
class Spec{
    public $type;
    public $value;
    public $editable;
}

class DeviceStatus{
    public $name;
    public $address;
    public $pendingState;
    public $desiredState;
}

?> 
```

这些是查询：

```
<?php
//include("dataModel.php");

function dbConnect() {
    $dbhost = 'XXXXXXXX';
    $dbuser = 'XXXXX';
    $dbpass = 'XXXXXXXXX';

    $conn = mysql_connect($dbhost, $dbuser, $dbpass);
    if (!$conn) {
        die('Could not connect: ' . mysql_error());
    }
    mysql_select_db('XXXXXXXXX', $conn);
    mysql_query("SET NAMES UTF8");
    return $conn;
}

function executeSQL($sql) {
    $conn = dbConnect();

    $values = array();
    $retval = mysql_query($sql, $conn);

    if (!$retval) {
        die('Could not get data: ' . mysql_error());
    }

    while ($row = mysql_fetch_array($retval, MYSQL_ASSOC)) {
        array_push($values, $row);
    }

    return $values;
}

function executeSQLForPersist($sql){
    $conn = dbConnect();

    $retval = mysql_query($sql, $conn);

    return $retval;
}

function dbGetLandsByUserId($userId){
    $sql  = "SELECT * FROM land WHERE user_id=$userId or user_id=1 ";
    return executeSQL($sql);
}

function dbGetUserLandByLandId($userId, $landId){
    $sql = "SELECT * FROM land WHERE user_id=$userId AND id=$landId UNION SELECT * FROM land WHERE user_id=1 AND id=1";
    return executeSQL($sql);
}

function dbGetGeoposById($geoId){
    $sql  = "SELECT * FROM geoposition WHERE id=$geoId";
    return executeSQL($sql);
}
function dbGetLandmapById($id){
    $sql  = "SELECT * FROM landimages WHERE land_id=$id";
    return executeSQL($sql);
}
function dbGetMapInfoById($id) {
    $sql  = "SELECT * FROM mapitems WHERE id=$id";
    return executeSQL($sql);
}

function dbGetEnums(){
    $sql = "SELECT * FROM enums";
    return executeSQL($sql);
}

function dbGetSceneDevices(){
    $sql = "SELECT * FROM scenedevices";
    return executeSQL($sql);
}

function dbGetSectorsByLandId($landId){
    $sql = "SELECT * FROM sector WHERE land_id=$landId";
    return executeSQL($sql);
}

function dbGetDevicesBySectorId($sectorId){
    $sql = "SELECT * FROM scenedevices WHERE sector_id=$sectorId";
    return executeSQL($sql);
}

function dbGetDeviceModulesByDeviceType($deviceTypeId){
     $sql = "SELECT module_id FROM devicedef WHERE deviceenum_id=$deviceTypeId";
     $moduleIdsLiteral = executeSQL($sql);

     $modulesLiteralList = array();
     foreach ($moduleIdsLiteral as $moduleIdLiteral){
         $moduleId = $moduleIdLiteral["module_id"];
         $sqlModuleQuery = "SELECT * FROM module WHERE id=$moduleId";
         $modulesLiteralList[] = executeSQL($sqlModuleQuery);

     }
     return $modulesLiteralList;
}

function dbGetDefaultSpecsByModuleId($moduleId){
    $sql = "SELECT * FROM module_specs WHERE module_id=$moduleId";
    return executeSQL($sql);
}

function dbGetUpdatedDeviceSpec($deviceId, $moduleId, $specId){
    $sql = "SELECT * FROM deviceprefs WHERE scenedevice_id=$deviceId AND module_id=$moduleId AND specenum_id=$specId";
    return executeSQL($sql);
}

function dbGetProfileLandImageByLandId($landId){
    $sql = "SELECT * FROM landimages WHERE land_id=$landId AND profile=1";
    return executeSQL($sql);
}

function dbGetSubIdOfModule($moduleId){
    $sql = "SELECT * FROM devicedef WHERE module_id='$moduleId'";
    $idLiteral = executeSQL($sql);
    if(count($idLiteral) != 0) {
        return $idLiteral[0]["subid"];
    }
    else {
        return -1;
    }
}

function dbGetModuleIdByModuleEnumId($moduleEnumId){
    $sql = "SELECT * FROM module WHERE moduleenum_id=$moduleEnumId";
    $idLiteral = executeSQL($sql);
    if (count($idLiteral) == 1){
        return $idLiteral[0]['id'];
    }else{
        return -1;
    }
}

function dbGetAllDeviceModuleData($devId, $modId){
    $sql = "SELECT * FROM realtimedevicedata WHERE scenedevice_id=$devId AND module_id=$modId ORDER BY timestamp LIMIT 0, 500"; //TODO.
    return executeSQL($sql);
}
function dbGetLastDeviceModuleData($devId, $modId){
    $sql = "SELECT * FROM realtimedevicedata WHERE scenedevice_id=$devId AND module_id=$modId ORDER BY timestamp desc limit 1";
    return executeSQL($sql);   
}

function dbGetLastDayDeviceModuleData($devId, $modId){
    $sql = "SELECT * FROM realtimedevicedata WHERE scenedevice_id=$devId AND module_id=$modId AND timestamp>=SYSDATE()-INTERVAL 1 DAY ORDER BY timestamp";
    return executeSQL($sql);   
}

function dbGetIntervalDeviceModuleData($devId, $modId, $startDate, $endDate){
    $sql = "SELECT * FROM realtimedevicedata WHERE scenedevice_id=$devId AND module_id=$modId AND timestamp>='$startDate' AND timestamp<='$endDate' ORDER BY timestamp";
    return executeSQL($sql);   
}

function dbGetDeviceStates($devId) {
    $sql = "SELECT * FROM deviceprefs WHERE scenedevice_id=$devId";
    return executeSQL($sql);   
}

function dbGetAllDeviceStates($imei) {
    $sql  = "SELECT  scenedevices.scenename, scenedevices.serialNo, deviceprefs.pending_state, ".
            "deviceprefs.desired_state FROM  scenedevices, deviceprefs ". 
        "WHERE  scenedevices.parentId = '".$imei."' AND scenedevices.id = deviceprefs.scenedevice_id ";
    return executeSQL($sql);
}

?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T12:06:39.490

我对这个主题的一般想法是，您应该将代码分成两个主要部分：

1.  数据提取
2.  数据准备

在您当前的实现中，每个`foreach()`循环都有一个针对 DB 的查询。尝试这样做：

```
$sectorsLiteral = dbGetSectorsByLandId($userLand->id);
$sectorsLiteralIds = array();
foreach ($sectorsLiteral as $sectorLiteral) {
    $sectorsLiteralIds[] = $sectorLiteral["id"]
}

$devicesLiteral = dbGetDevicesBySectorId($sectorsLiteralIds); 
```

等等。

当然，您必须调整您的数据库“类”以接受参数数组。

然后，当您将在 3-5 个查询中获取所有数据时，您应该使用数组 - 在 foreaches 中再次使用 foreaches，但它们会运行得很快，因为您不必在每个循环周期内提取数据。

处理所有进一步准备的抽象方法如下所示

```
$response = array();
foreach($sectorsLiteral as $sectorLiteral) {
    foreach($devicesLiteral as $deviceLiteral) {
        if ($deviceLiteral['sectorId'] == $sectorLiteral['id']) {
            ...do what you need
        }
    }
} 
```

是的，代码变得更加复杂，但它的工作速度要快得多。

**编辑**：

您的代码的一项重要改进 - 您应该将您`$connection`的全局变量放在全局变量中，以避免每次发送查询时都打开新变量。

```
$conn = false;

function dbConnect() {
    ...
    global $conn;

    if (!$conn) {
        $conn = mysql_connect($dbhost, $dbuser, $dbpass);
    }
    ... 
```

}

唯一的事情-您将不得不找到另一种检查连接状态的方法:)

干杯；）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T12:21:12.280

我意识到我的代码运行缓慢的原因是 realtimedevicedata 表太大（大约 120MB 并且有 50K 记录），我尝试在选择没有记录之前订购此表。为避免这种情况，我将代码更改为从该表中获取前 500 条记录，然后对该表进行排序。这打破了链条。

感谢所有愿意提供帮助的人，并为时间松散感到抱歉。祝你有美好的一天。

SQL 更改：

老一：

```
$sql = "SELECT value, timestamp FROM realtimedevicedata WHERE scenedevice_id=$devId AND module_id=$modId ORDER BY timestamp desc limit 0,1"; 
```

新的一个：

```
$sql = "SELECT value, timestamp FROM (SELECT DISTINCT scenedevice_id, value, timestamp FROM realtimedevicedata AS K WHERE K.scenedevice_id=$devId AND K.module_id=$modId LIMIT 0,100) AS M ORDER BY M.timestamp desc Limit 0,1"; 
```

realtimedevicedata 的证明是一个坏女孩：

```
0.02 secs : SELECT * FROM land WHERE user_id=2 AND id=1 UNION SELECT * FROM land WHERE user_id=1 AND id=1
0.11 secs : SELECT mapimage FROM landimages WHERE land_id=1 LIMIT 0,1
0.00 secs : SELECT lat,lng FROM geoposition WHERE id=1 LIMIT 0,1
0.06 secs : SELECT id, name, description, geopos_id FROM sector WHERE land_id=1
0.00 secs : SELECT lat,lng FROM geoposition WHERE id=2 LIMIT 0,1
0.03 secs : SELECT id,scenename,scenedescription,mapitem_id,geopos_id,deviceenum_id,serialNo FROM scenedevices WHERE sector_id=1
0.00 secs : SELECT * FROM mapitems WHERE id=1
0.00 secs : SELECT lat,lng FROM geoposition WHERE id=47 LIMIT 0,1
0.00 secs : SELECT module_id FROM devicedef WHERE deviceenum_id=6
0.00 secs : SELECT id, moduleenum_id, unit FROM module WHERE id=11
0.00 secs : SELECT subid FROM devicedef WHERE module_id='11'
0.00 secs : SELECT pending_state, desired_state, current_state FROM deviceprefs WHERE scenedevice_id=1
0.15 secs : SELECT value, timestamp FROM realtimedevicedata WHERE scenedevice_id=1 AND module_id=11 ORDER BY timestamp desc limit 0,1
0.00 secs : SELECT `specenum_id`, `editable`, `default` FROM module_specs WHERE module_id=11
0.00 secs : SELECT * FROM mapitems WHERE id=3
0.00 secs : SELECT lat,lng FROM geoposition WHERE id=2 LIMIT 0,1
0.00 secs : SELECT module_id FROM devicedef WHERE deviceenum_id=4
0.00 secs : SELECT id, moduleenum_id, unit FROM module WHERE id=1
0.00 secs : SELECT id, moduleenum_id, unit FROM module WHERE id=2
0.00 secs : SELECT id, moduleenum_id, unit FROM module WHERE id=3
0.00 secs : SELECT id, moduleenum_id, unit FROM module WHERE id=10
0.00 secs : SELECT subid FROM devicedef WHERE module_id='1'
0.00 secs : SELECT pending_state, desired_state, current_state FROM deviceprefs WHERE scenedevice_id=2
9.41 secs : SELECT value, timestamp FROM realtimedevicedata WHERE scenedevice_id=2 AND module_id=1 ORDER BY timestamp desc limit 0,1
0.01 secs : SELECT `specenum_id`, `editable`, `default` FROM module_specs WHERE module_id=1
0.02 secs : SELECT specvalue FROM deviceprefs WHERE scenedevice_id=2 AND module_id=1 AND specenum_id=14
0.00 secs : SELECT specvalue FROM deviceprefs WHERE scenedevice_id=2 AND module_id=1 AND specenum_id=15
0.00 secs : SELECT specvalue FROM deviceprefs WHERE scenedevice_id=2 AND module_id=1 AND specenum_id=18
0.00 secs : SELECT subid FROM devicedef WHERE module_id='2'
0.00 secs : SELECT pending_state, desired_state, current_state FROM deviceprefs WHERE scenedevice_id=2
6.84 secs : SELECT value, timestamp FROM realtimedevicedata WHERE scenedevice_id=2 AND module_id=2 ORDER BY timestamp desc limit 0,1
0.00 secs : SELECT `specenum_id`, `editable`, `default` FROM module_specs WHERE module_id=2
0.01 secs : SELECT specvalue FROM deviceprefs WHERE scenedevice_id=2 AND module_id=2 AND specenum_id=14
0.00 secs : SELECT specvalue FROM deviceprefs WHERE scenedevice_id=2 AND module_id=2 AND specenum_id=15
0.00 secs : SELECT specvalue FROM deviceprefs WHERE scenedevice_id=2 AND module_id=2 AND specenum_id=18
0.02 secs : SELECT subid FROM devicedef WHERE module_id='3'
0.00 secs : SELECT pending_state, desired_state, current_state FROM deviceprefs WHERE scenedevice_id=2
4.44 secs : SELECT value, timestamp FROM realtimedevicedata WHERE scenedevice_id=2 AND module_id=3 ORDER BY timestamp desc limit 0,1
0.00 secs : SELECT `specenum_id`, `editable`, `default` FROM module_specs WHERE module_id=3
0.00 secs : SELECT specvalue FROM deviceprefs WHERE scenedevice_id=2 AND module_id=3 AND specenum_id=14
0.00 secs : SELECT specvalue FROM deviceprefs WHERE scenedevice_id=2 AND module_id=3 AND specenum_id=15
0.00 secs : SELECT specvalue FROM deviceprefs WHERE scenedevice_id=2 AND module_id=3 AND specenum_id=18
0.00 secs : SELECT subid FROM devicedef WHERE module_id='10'
0.00 secs : SELECT pending_state, desired_state, current_state FROM deviceprefs WHERE scenedevice_id=2
9.27 secs : SELECT value, timestamp FROM realtimedevicedata WHERE scenedevice_id=2 AND module_id=10 ORDER BY timestamp desc limit 0,1
0.00 secs : SELECT `specenum_id`, `editable`, `default` FROM module_specs WHERE module_id=10
0.01 secs : SELECT * FROM mapitems WHERE id=5
0.01 secs : SELECT lat,lng FROM geoposition WHERE id=44 LIMIT 0,1
0.02 secs : SELECT module_id FROM devicedef WHERE deviceenum_id=5
0.00 secs : SELECT id, moduleenum_id, unit FROM module WHERE id=4
0.00 secs : SELECT id, moduleenum_id, unit FROM module WHERE id=10
0.00 secs : SELECT subid FROM devicedef WHERE module_id='4'
0.02 secs : SELECT pending_state, desired_state, current_state FROM deviceprefs WHERE scenedevice_id=4
0.01 secs : SELECT value, timestamp FROM realtimedevicedata WHERE scenedevice_id=4 AND module_id=4 ORDER BY timestamp desc limit 0,1
0.00 secs : SELECT `specenum_id`, `editable`, `default` FROM module_specs WHERE module_id=4
0.00 secs : SELECT subid FROM devicedef WHERE module_id='10'
0.00 secs : SELECT pending_state, desired_state, current_state FROM deviceprefs WHERE scenedevice_id=4
0.00 secs : SELECT value, timestamp FROM realtimedevicedata WHERE scenedevice_id=4 AND module_id=10 ORDER BY timestamp desc limit 0,1
0.00 secs : SELECT `specenum_id`, `editable`, `default` FROM module_specs WHERE module_id=10
0.00 secs : SELECT * FROM mapitems WHERE id=6
0.00 secs : SELECT lat,lng FROM geoposition WHERE id=45 LIMIT 0,1
0.00 secs : SELECT module_id FROM devicedef WHERE deviceenum_id=31
0.00 secs : SELECT id, moduleenum_id, unit FROM module WHERE id=4
0.00 secs : SELECT subid FROM devicedef WHERE module_id='4'
0.00 secs : SELECT pending_state, desired_state, current_state FROM deviceprefs WHERE scenedevice_id=5
0.00 secs : SELECT value, timestamp FROM realtimedevicedata WHERE scenedevice_id=5 AND module_id=4 ORDER BY timestamp desc limit 0,1
0.00 secs : SELECT `specenum_id`, `editable`, `default` FROM module_specs WHERE module_id=4
0.00 secs : SELECT lat,lng FROM geoposition WHERE id=3 LIMIT 0,1
0.00 secs : SELECT id,scenename,scenedescription,mapitem_id,geopos_id,deviceenum_id,serialNo FROM scenedevices WHERE sector_id=2
0.00 secs : SELECT * FROM mapitems WHERE id=4
0.00 secs : SELECT lat,lng FROM geoposition WHERE id=3 LIMIT 0,1
0.00 secs : SELECT module_id FROM devicedef WHERE deviceenum_id=29
0.00 secs : SELECT id, moduleenum_id, unit FROM module WHERE id=1
0.00 secs : SELECT id, moduleenum_id, unit FROM module WHERE id=2
0.00 secs : SELECT id, moduleenum_id, unit FROM module WHERE id=9
0.00 secs : SELECT id, moduleenum_id, unit FROM module WHERE id=10
0.00 secs : SELECT subid FROM devicedef WHERE module_id='1'
0.00 secs : SELECT pending_state, desired_state, current_state FROM deviceprefs WHERE scenedevice_id=3
4.34 secs : SELECT value, timestamp FROM realtimedevicedata WHERE scenedevice_id=3 AND module_id=1 ORDER BY timestamp desc limit 0,1
0.01 secs : SELECT `specenum_id`, `editable`, `default` FROM module_specs WHERE module_id=1
0.03 secs : SELECT specvalue FROM deviceprefs WHERE scenedevice_id=3 AND module_id=1 AND specenum_id=14
0.00 secs : SELECT specvalue FROM deviceprefs WHERE scenedevice_id=3 AND module_id=1 AND specenum_id=15
0.00 secs : SELECT specvalue FROM deviceprefs WHERE scenedevice_id=3 AND module_id=1 AND specenum_id=18
0.00 secs : SELECT subid FROM devicedef WHERE module_id='2'
0.00 secs : SELECT pending_state, desired_state, current_state FROM deviceprefs WHERE scenedevice_id=3
11.86 secs : SELECT value, timestamp FROM realtimedevicedata WHERE scenedevice_id=3 AND module_id=2 ORDER BY timestamp desc limit 0,1
0.02 secs : SELECT `specenum_id`, `editable`, `default` FROM module_specs WHERE module_id=2
0.05 secs : SELECT specvalue FROM deviceprefs WHERE scenedevice_id=3 AND module_id=2 AND specenum_id=14
0.00 secs : SELECT specvalue FROM deviceprefs WHERE scenedevice_id=3 AND module_id=2 AND specenum_id=15
0.00 secs : SELECT specvalue FROM deviceprefs WHERE scenedevice_id=3 AND module_id=2 AND specenum_id=18
0.04 secs : SELECT subid FROM devicedef WHERE module_id='9'
0.00 secs : SELECT pending_state, desired_state, current_state FROM deviceprefs WHERE scenedevice_id=3
4.25 secs : SELECT value, timestamp FROM realtimedevicedata WHERE scenedevice_id=3 AND module_id=9 ORDER BY timestamp desc limit 0,1
0.00 secs : SELECT `specenum_id`, `editable`, `default` FROM module_specs WHERE module_id=9
0.00 secs : SELECT subid FROM devicedef WHERE module_id='10'
0.00 secs : SELECT pending_state, desired_state, current_state FROM deviceprefs WHERE scenedevice_id=3
2.71 secs : SELECT value, timestamp FROM realtimedevicedata WHERE scenedevice_id=3 AND module_id=10 ORDER BY timestamp desc limit 0,1
0.00 secs : SELECT `specenum_id`, `editable`, `default` FROM module_specs WHERE module_id=10
0.00 secs : SELECT * FROM mapitems WHERE id=7
0.05 secs : SELECT lat,lng FROM geoposition WHERE id=46 LIMIT 0,1
0.00 secs : SELECT module_id FROM devicedef WHERE deviceenum_id=5
0.01 secs : SELECT id, moduleenum_id, unit FROM module WHERE id=4
0.00 secs : SELECT id, moduleenum_id, unit FROM module WHERE id=10
0.00 secs : SELECT subid FROM devicedef WHERE module_id='4'
0.01 secs : SELECT pending_state, desired_state, current_state FROM deviceprefs WHERE scenedevice_id=6
0.00 secs : SELECT value, timestamp FROM realtimedevicedata WHERE scenedevice_id=6 AND module_id=4 ORDER BY timestamp desc limit 0,1
0.00 secs : SELECT `specenum_id`, `editable`, `default` FROM module_specs WHERE module_id=4
0.00 secs : SELECT subid FROM devicedef WHERE module_id='10'
0.00 secs : SELECT pending_state, desired_state, current_state FROM deviceprefs WHERE scenedevice_id=6
0.00 secs : SELECT value, timestamp FROM realtimedevicedata WHERE scenedevice_id=6 AND module_id=10 ORDER BY timestamp desc limit 0,1
0.00 secs : SELECT `specenum_id`, `editable`, `default` FROM module_specs WHERE module_id=10 
```

现在，她答应我做个好女孩：）

```
0.00 secs : SELECT * FROM land WHERE user_id=2 AND id=1 UNION SELECT * FROM land WHERE user_id=1 AND id=1
0.00 secs : SELECT mapimage FROM landimages WHERE land_id=1 LIMIT 0,1
0.00 secs : SELECT lat,lng FROM geoposition WHERE id=1 LIMIT 0,1
0.00 secs : SELECT id, name, description, geopos_id FROM sector WHERE land_id=1
0.00 secs : SELECT lat,lng FROM geoposition WHERE id=2 LIMIT 0,1
0.00 secs : SELECT id,scenename,scenedescription,mapitem_id,geopos_id,deviceenum_id,serialNo FROM scenedevices WHERE sector_id=1
0.00 secs : SELECT * FROM mapitems WHERE id=1
0.00 secs : SELECT lat,lng FROM geoposition WHERE id=47 LIMIT 0,1
0.00 secs : SELECT module_id FROM devicedef WHERE deviceenum_id=6
0.00 secs : SELECT id, moduleenum_id, unit FROM module WHERE id=11
0.00 secs : SELECT subid FROM devicedef WHERE module_id='11'
0.00 secs : SELECT pending_state, desired_state, current_state FROM deviceprefs WHERE scenedevice_id=1
0.00 secs : SELECT value, timestamp FROM (SELECT DISTINCT scenedevice_id, value, timestamp FROM realtimedevicedata AS K WHERE K.scenedevice_id=1 AND K.module_id=11 LIMIT 0,100) AS M ORDER BY M.timestamp desc Limit 0,1
0.00 secs : SELECT `specenum_id`, `editable`, `default` FROM module_specs WHERE module_id=11
0.00 secs : SELECT * FROM mapitems WHERE id=3
0.00 secs : SELECT lat,lng FROM geoposition WHERE id=2 LIMIT 0,1
0.00 secs : SELECT module_id FROM devicedef WHERE deviceenum_id=4
0.00 secs : SELECT id, moduleenum_id, unit FROM module WHERE id=1
0.00 secs : SELECT id, moduleenum_id, unit FROM module WHERE id=2
0.00 secs : SELECT id, moduleenum_id, unit FROM module WHERE id=3
0.00 secs : SELECT id, moduleenum_id, unit FROM module WHERE id=10
0.00 secs : SELECT subid FROM devicedef WHERE module_id='1'
0.00 secs : SELECT pending_state, desired_state, current_state FROM deviceprefs WHERE scenedevice_id=2
0.00 secs : SELECT value, timestamp FROM (SELECT DISTINCT scenedevice_id, value, timestamp FROM realtimedevicedata AS K WHERE K.scenedevice_id=2 AND K.module_id=1 LIMIT 0,100) AS M ORDER BY M.timestamp desc Limit 0,1
0.00 secs : SELECT `specenum_id`, `editable`, `default` FROM module_specs WHERE module_id=1
0.00 secs : SELECT specvalue FROM deviceprefs WHERE scenedevice_id=2 AND module_id=1 AND specenum_id=14
0.00 secs : SELECT specvalue FROM deviceprefs WHERE scenedevice_id=2 AND module_id=1 AND specenum_id=15
0.00 secs : SELECT specvalue FROM deviceprefs WHERE scenedevice_id=2 AND module_id=1 AND specenum_id=18
0.00 secs : SELECT subid FROM devicedef WHERE module_id='2'
0.00 secs : SELECT pending_state, desired_state, current_state FROM deviceprefs WHERE scenedevice_id=2
0.00 secs : SELECT value, timestamp FROM (SELECT DISTINCT scenedevice_id, value, timestamp FROM realtimedevicedata AS K WHERE K.scenedevice_id=2 AND K.module_id=2 LIMIT 0,100) AS M ORDER BY M.timestamp desc Limit 0,1
0.00 secs : SELECT `specenum_id`, `editable`, `default` FROM module_specs WHERE module_id=2
0.00 secs : SELECT specvalue FROM deviceprefs WHERE scenedevice_id=2 AND module_id=2 AND specenum_id=14
0.00 secs : SELECT specvalue FROM deviceprefs WHERE scenedevice_id=2 AND module_id=2 AND specenum_id=15
0.00 secs : SELECT specvalue FROM deviceprefs WHERE scenedevice_id=2 AND module_id=2 AND specenum_id=18
0.00 secs : SELECT subid FROM devicedef WHERE module_id='3'
0.00 secs : SELECT pending_state, desired_state, current_state FROM deviceprefs WHERE scenedevice_id=2
0.00 secs : SELECT value, timestamp FROM (SELECT DISTINCT scenedevice_id, value, timestamp FROM realtimedevicedata AS K WHERE K.scenedevice_id=2 AND K.module_id=3 LIMIT 0,100) AS M ORDER BY M.timestamp desc Limit 0,1
0.00 secs : SELECT `specenum_id`, `editable`, `default` FROM module_specs WHERE module_id=3
0.00 secs : SELECT specvalue FROM deviceprefs WHERE scenedevice_id=2 AND module_id=3 AND specenum_id=14
0.00 secs : SELECT specvalue FROM deviceprefs WHERE scenedevice_id=2 AND module_id=3 AND specenum_id=15
0.00 secs : SELECT specvalue FROM deviceprefs WHERE scenedevice_id=2 AND module_id=3 AND specenum_id=18
0.00 secs : SELECT subid FROM devicedef WHERE module_id='10'
0.00 secs : SELECT pending_state, desired_state, current_state FROM deviceprefs WHERE scenedevice_id=2
0.00 secs : SELECT value, timestamp FROM (SELECT DISTINCT scenedevice_id, value, timestamp FROM realtimedevicedata AS K WHERE K.scenedevice_id=2 AND K.module_id=10 LIMIT 0,100) AS M ORDER BY M.timestamp desc Limit 0,1
0.00 secs : SELECT `specenum_id`, `editable`, `default` FROM module_specs WHERE module_id=10
0.00 secs : SELECT * FROM mapitems WHERE id=5
0.00 secs : SELECT lat,lng FROM geoposition WHERE id=44 LIMIT 0,1
0.00 secs : SELECT module_id FROM devicedef WHERE deviceenum_id=5
0.00 secs : SELECT id, moduleenum_id, unit FROM module WHERE id=4
0.00 secs : SELECT id, moduleenum_id, unit FROM module WHERE id=10
0.00 secs : SELECT subid FROM devicedef WHERE module_id='4'
0.00 secs : SELECT pending_state, desired_state, current_state FROM deviceprefs WHERE scenedevice_id=4
0.00 secs : SELECT value, timestamp FROM (SELECT DISTINCT scenedevice_id, value, timestamp FROM realtimedevicedata AS K WHERE K.scenedevice_id=4 AND K.module_id=4 LIMIT 0,100) AS M ORDER BY M.timestamp desc Limit 0,1
0.00 secs : SELECT `specenum_id`, `editable`, `default` FROM module_specs WHERE module_id=4
0.00 secs : SELECT subid FROM devicedef WHERE module_id='10'
0.00 secs : SELECT pending_state, desired_state, current_state FROM deviceprefs WHERE scenedevice_id=4
0.00 secs : SELECT value, timestamp FROM (SELECT DISTINCT scenedevice_id, value, timestamp FROM realtimedevicedata AS K WHERE K.scenedevice_id=4 AND K.module_id=10 LIMIT 0,100) AS M ORDER BY M.timestamp desc Limit 0,1
0.00 secs : SELECT `specenum_id`, `editable`, `default` FROM module_specs WHERE module_id=10
0.00 secs : SELECT * FROM mapitems WHERE id=6
0.00 secs : SELECT lat,lng FROM geoposition WHERE id=45 LIMIT 0,1
0.00 secs : SELECT module_id FROM devicedef WHERE deviceenum_id=31
0.00 secs : SELECT id, moduleenum_id, unit FROM module WHERE id=4
0.00 secs : SELECT subid FROM devicedef WHERE module_id='4'
0.00 secs : SELECT pending_state, desired_state, current_state FROM deviceprefs WHERE scenedevice_id=5
0.00 secs : SELECT value, timestamp FROM (SELECT DISTINCT scenedevice_id, value, timestamp FROM realtimedevicedata AS K WHERE K.scenedevice_id=5 AND K.module_id=4 LIMIT 0,100) AS M ORDER BY M.timestamp desc Limit 0,1
0.00 secs : SELECT `specenum_id`, `editable`, `default` FROM module_specs WHERE module_id=4
0.00 secs : SELECT lat,lng FROM geoposition WHERE id=3 LIMIT 0,1
0.00 secs : SELECT id,scenename,scenedescription,mapitem_id,geopos_id,deviceenum_id,serialNo FROM scenedevices WHERE sector_id=2
0.00 secs : SELECT * FROM mapitems WHERE id=4
0.00 secs : SELECT lat,lng FROM geoposition WHERE id=3 LIMIT 0,1
0.00 secs : SELECT module_id FROM devicedef WHERE deviceenum_id=29
0.00 secs : SELECT id, moduleenum_id, unit FROM module WHERE id=1
0.00 secs : SELECT id, moduleenum_id, unit FROM module WHERE id=2
0.00 secs : SELECT id, moduleenum_id, unit FROM module WHERE id=9
0.00 secs : SELECT id, moduleenum_id, unit FROM module WHERE id=10
0.00 secs : SELECT subid FROM devicedef WHERE module_id='1'
0.00 secs : SELECT pending_state, desired_state, current_state FROM deviceprefs WHERE scenedevice_id=3
0.00 secs : SELECT value, timestamp FROM (SELECT DISTINCT scenedevice_id, value, timestamp FROM realtimedevicedata AS K WHERE K.scenedevice_id=3 AND K.module_id=1 LIMIT 0,100) AS M ORDER BY M.timestamp desc Limit 0,1
0.00 secs : SELECT `specenum_id`, `editable`, `default` FROM module_specs WHERE module_id=1
0.00 secs : SELECT specvalue FROM deviceprefs WHERE scenedevice_id=3 AND module_id=1 AND specenum_id=14
0.00 secs : SELECT specvalue FROM deviceprefs WHERE scenedevice_id=3 AND module_id=1 AND specenum_id=15
0.00 secs : SELECT specvalue FROM deviceprefs WHERE scenedevice_id=3 AND module_id=1 AND specenum_id=18
0.00 secs : SELECT subid FROM devicedef WHERE module_id='2'
0.00 secs : SELECT pending_state, desired_state, current_state FROM deviceprefs WHERE scenedevice_id=3
0.00 secs : SELECT value, timestamp FROM (SELECT DISTINCT scenedevice_id, value, timestamp FROM realtimedevicedata AS K WHERE K.scenedevice_id=3 AND K.module_id=2 LIMIT 0,100) AS M ORDER BY M.timestamp desc Limit 0,1
0.00 secs : SELECT `specenum_id`, `editable`, `default` FROM module_specs WHERE module_id=2
0.00 secs : SELECT specvalue FROM deviceprefs WHERE scenedevice_id=3 AND module_id=2 AND specenum_id=14
0.00 secs : SELECT specvalue FROM deviceprefs WHERE scenedevice_id=3 AND module_id=2 AND specenum_id=15
0.00 secs : SELECT specvalue FROM deviceprefs WHERE scenedevice_id=3 AND module_id=2 AND specenum_id=18
0.00 secs : SELECT subid FROM devicedef WHERE module_id='9'
0.00 secs : SELECT pending_state, desired_state, current_state FROM deviceprefs WHERE scenedevice_id=3
0.00 secs : SELECT value, timestamp FROM (SELECT DISTINCT scenedevice_id, value, timestamp FROM realtimedevicedata AS K WHERE K.scenedevice_id=3 AND K.module_id=9 LIMIT 0,100) AS M ORDER BY M.timestamp desc Limit 0,1
0.00 secs : SELECT `specenum_id`, `editable`, `default` FROM module_specs WHERE module_id=9
0.00 secs : SELECT subid FROM devicedef WHERE module_id='10'
0.00 secs : SELECT pending_state, desired_state, current_state FROM deviceprefs WHERE scenedevice_id=3
0.20 secs : SELECT value, timestamp FROM (SELECT DISTINCT scenedevice_id, value, timestamp FROM realtimedevicedata AS K WHERE K.scenedevice_id=3 AND K.module_id=10 LIMIT 0,100) AS M ORDER BY M.timestamp desc Limit 0,1
0.00 secs : SELECT `specenum_id`, `editable`, `default` FROM module_specs WHERE module_id=10
0.00 secs : SELECT * FROM mapitems WHERE id=7
0.00 secs : SELECT lat,lng FROM geoposition WHERE id=46 LIMIT 0,1
0.00 secs : SELECT module_id FROM devicedef WHERE deviceenum_id=5
0.00 secs : SELECT id, moduleenum_id, unit FROM module WHERE id=4
0.00 secs : SELECT id, moduleenum_id, unit FROM module WHERE id=10
0.00 secs : SELECT subid FROM devicedef WHERE module_id='4'
0.00 secs : SELECT pending_state, desired_state, current_state FROM deviceprefs WHERE scenedevice_id=6
0.00 secs : SELECT value, timestamp FROM (SELECT DISTINCT scenedevice_id, value, timestamp FROM realtimedevicedata AS K WHERE K.scenedevice_id=6 AND K.module_id=4 LIMIT 0,100) AS M ORDER BY M.timestamp desc Limit 0,1
0.00 secs : SELECT `specenum_id`, `editable`, `default` FROM module_specs WHERE module_id=4
0.00 secs : SELECT subid FROM devicedef WHERE module_id='10'
0.00 secs : SELECT pending_state, desired_state, current_state FROM deviceprefs WHERE scenedevice_id=6
0.00 secs : SELECT value, timestamp FROM (SELECT DISTINCT scenedevice_id, value, timestamp FROM realtimedevicedata AS K WHERE K.scenedevice_id=6 AND K.module_id=10 LIMIT 0,100) AS M ORDER BY M.timestamp desc Limit 0,1
0.00 secs : SELECT `specenum_id`, `editable`, `default` FROM module_specs WHERE module_id=10 
```

# joomla2.5 - Joomla：登录失败时不显示任何错误

> ID：11686688
> 
> 赞同：3
> 
> 时间：2012-07-27T11:16:30.610
> 
> 标签：joomla2.5

我在 Joomla 2.5 上使用登录 ID 和密码。当我输入错误的密码时，它会显示空白页。没有错误。请帮助可能的错误。我是 Joomla 的新手。当我开始时，我还从管理部分删除了一些模板样式和模块。如果这是原因，那我怎么能把它们拿回来？我已经尝试将模板文件夹复制并粘贴到项目中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-28T09:09:37.833

确保模板中的 index.php 包含以下内容：

```
<jdoc:include type="message"/> 
```

这是显示错误消息的地方。

另外，为什么要删除部分管理模板？

# php - 我什么时候应该在我的数据库中使用静态数组而不是新表？

> ID：11686689
> 
> 赞同：3
> 
> 时间：2012-07-27T11:16:35.413
> 
> 标签：php, acl, database-performance, static-array

我已经使用 2 个静态数组（用于角色和资源）实现了一个访问控制列表，但是我在数据库中添加了一个新表来获取权限。

为角色使用静态数组的想法是我们不会一直创建新角色，因此数据不会一直更改。我对资源也是这么想的，也是因为我认为资源是只有开发人员才应该处理的东西，因为它们与代码的关系比与数据的关系更大。您知道为什么要使用静态数组而不是数据库表吗？什么时候/为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T11:40:38.350

将值硬编码到代码中的问题在于，与数据库更改相比，代码更改要**昂贵得多**：

*   通常需要新建一个包来部署。该软件包需要进行回归测试，以验证没有引入任何错误。提示：即使您只更改了一行代码，回归测试也是必要的，以验证构建过程中没有出现任何问题（例如，未正确打包库导致模块失败）。

*   更新代码可能意味着停机，这也会增加风险，因为如果更新失败怎么办，总是存在这种[风险](http://www.theregister.co.uk/2012/06/26/rbs_natwest_ca_technologies_outsourcing/)

*   在企业环境中，批准数据库更新通常比更改代码要快得多。

所有这些都需要时间/精力/金钱。请注意，在我看来，在数据库中保存参考数据或静态数据并不意味着会影响性能，因为数据始终可以被缓存。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T11:20:15.943

您的静态数组是将数据“硬编码”到程序中的一个示例，如果您*永远*不想更改它，这很好。

根据我的经验，对于您的用例来说，这*永远不会*是真的，并且将您的数据硬编码到您的源中将导致您不断被要求更新那些您认为永远不会改变的东西。

Protip：对于项目经理和/或客户来说，没有什么是一成不变的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-27T11:22:09.950

我认为这归结为您认为数据库将来将如何使用。如果您将数据保留在数组中，然后想要创建另一个与该数据库交互的应用程序，您将开始必须在两个代码库中维护角色/资源数据。但是，如果您将角色/资源放入数据库，则数据库将是它们的唯一权限。

我建议将它们放入数据库中。您可以在启动时将表读入数组，您将获得相同的性能优势以及让其他应用程序能够获取此信息的灵活性。

此外，当/如果您开始编写用户管理系统时，通过加入表格来显示用户的角色/资源比取回角色/资源 ID 并且必须在你的数组。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-27T11:25:23.523

使用静态数组可以获得性能，考虑到你不需要一直访问数据库，但是安全比性能更重要，所以我建议你在数据库中做权限控制。

研究 RBAC。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-27T11:22:14.477

被认为是静态的事物应该被编码为静态的。也就是说，如果您*真的*认为它们是静态的。

但我建议使用类常量而不是静态数组值。

# c# - 在 ASP.NET Web API 中处理 ModelState 验证

> ID：11686690
> 
> 赞同：112
> 
> 时间：2012-07-27T11:16:42.950
> 
> 标签：c#, asp.net-web-api

我想知道如何使用 ASP.NET Web API 实现模型验证。我的模型是这样的：

```
public class Enquiry
{
    [Key]
    public int EnquiryId { get; set; }
    [Required]
    public DateTime EnquiryDate { get; set; }
    [Required]
    public string CustomerAccountNumber { get; set; }
    [Required]
    public string ContactName { get; set; }
} 
```

然后我的 API 控制器中有一个 Post 操作：

```
public void Post(Enquiry enquiry)
{
    enquiry.EnquiryDate = DateTime.Now;
    context.DaybookEnquiries.Add(enquiry);
    context.SaveChanges();
} 
```

如何添加`if(ModelState.IsValid)`并处理错误消息以传递给用户？

* * *

## 回答 #1

> 赞同：192
> 
> 时间：2012-07-30T15:18:37.137

为了关注点分离，我建议您使用操作过滤器进行模型验证，因此您无需太在意如何在您的 api 控制器中进行验证：

```
using System.Net;
using System.Net.Http;
using System.Web.Http.Controllers;
using System.Web.Http.Filters;

namespace System.Web.Http.Filters
{
    public class ValidationActionFilter : ActionFilterAttribute
    {
        public override void OnActionExecuting(HttpActionContext actionContext)
        {
            var modelState = actionContext.ModelState;

            if (!modelState.IsValid)
                actionContext.Response = actionContext.Request
                     .CreateErrorResponse(HttpStatusCode.BadRequest, modelState);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2014-05-16T14:56:27.077

也许不是你想要的，但也许有人知道：

如果您使用的是 .net Web Api 2，您可以执行以下操作：

```
if (!ModelState.IsValid)
     return BadRequest(); 
```

根据模型错误，您会得到以下结果：

```
{
   Message: "The request is invalid."
   ModelState: {
       model.PropertyA: [
            "The PropertyA field is required."
       ],
       model.PropertyB: [
             "The PropertyB field is required."
       ]
   }
} 
```

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2012-07-27T11:21:17.003

像这样，例如：

```
public HttpResponseMessage Post(Person person)
{
    if (ModelState.IsValid)
    {
        PersonDB.Add(person);
        return Request.CreateResponse(HttpStatusCode.Created, person);
    }
    else
    {
        // the code below should probably be refactored into a GetModelErrors
        // method on your BaseApiController or something like that

        var errors = new List<string>();
        foreach (var state in ModelState)
        {
            foreach (var error in state.Value.Errors)
            {
                errors.Add(error.ErrorMessage);
            }
        }
        return Request.CreateResponse(HttpStatusCode.Forbidden, errors);
    }
} 
```

这将返回这样的响应（假设为 JSON，但 XML 的基本原理相同）：

```
HTTP/1.1 400 Bad Request
Content-Type: application/json; charset=utf-8
(some headers removed here)

["A value is required.","The field First is required.","Some custom errorm essage."] 
```

您当然可以以任何您喜欢的方式构建错误对象/列表，例如添加字段名称、字段 ID 等。

即使它是一个“单向”的 Ajax 调用，例如一个新实体的 POST，您仍然应该向调用者返回一些东西——指示请求是否成功的东西。想象一个网站，您的用户将通过 AJAX POST 请求添加一些关于他们自己的信息。如果他们尝试输入的信息无效怎么办 - 他们如何知道他们的保存操作是否成功？

最好的方法是使用**Good Old HTTP Status Codes**之类`200 OK`的。这样，您的 JavaScript 就可以使用正确的回调（错误、成功等）正确处理故障。

这是关于此方法的更高级版本的一个很好的教程，使用 ActionFilter 和 jQuery：[http ://asp.net/web-api/videos/getting-started/custom-validation](http://asp.net/web-api/videos/getting-started/custom-validation)

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2014-07-31T03:18:19.407

您可以使用`System.ComponentModel.DataAnnotations`命名空间中的属性来设置验证规则。有关详细信息，请参阅[模型验证 - Mike Wasson 撰写](http://www.asp.net/web-api/overview/formats-and-model-binding/model-validation-in-aspnet-web-api)。

另请参阅视频[ASP.NET Web API，第 5 部分：自定义验证 - Jon Galloway](http://www.asp.net/web-api/videos/getting-started/custom-validation)

**其他参考**

1.  [使用 WebAPI 和 WebForms 在客户端走一走](http://blogs.telerik.com/aspnet-ajax/posts/12-04-26/take-a-walk-on-the-client-side-with-webapi-and-webforms.aspx)
2.  [ASP.NET Web API 如何将 HTTP 消息绑定到域模型，以及如何在 Web API 中使用媒体格式。](http://www.asp.net/web-api/overview/formats-and-model-binding)
3.  [Dominick Baier - 保护 ASP.NET Web API](http://vimeo.com/43603474)
4.  [将 AngularJS 验证与 ASP.NET Web API 验证挂钩](http://www.danielroot.info/2013/09/hooking-angularjs-validation-to-aspnet.html)
5.  [在 ASP.NET MVC 中使用 AngularJS 显示 ModelState 错误](http://techbrij.com/modelstate-errors-angularjs-asp-net-mvc)
6.  [如何将错误呈现给客户端？AngularJS/WebApi 模型状态](https://stackoverflow.com/questions/23086664/how-to-render-errors-to-client-angularjs-webapi-modelstate)
7.  [Web API 中的依赖注入验证](https://stackoverflow.com/questions/15092809/dependency-injected-validation-in-web-api?lq=1)

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2016-12-26T04:21:13.697

或者，如果您正在为您的应用程序寻找简单的错误集合。这是我的实现：

```
public override void OnActionExecuting(HttpActionContext actionContext)
    {
        var modelState = actionContext.ModelState;

        if (!modelState.IsValid) 
        {

            var errors = new List<string>();
            foreach (var state in modelState)
            {
                foreach (var error in state.Value.Errors)
                {
                    errors.Add(error.ErrorMessage);
                }
            }

            var response = new { errors = errors };

            actionContext.Response = actionContext.Request
                .CreateResponse(HttpStatusCode.BadRequest, response, JsonMediaTypeFormatter.DefaultMediaType);
        }
    } 
```

错误消息响应将如下所示：

> ```
> {
>   "errors": [
>     "Please enter a valid phone number (7+ more digits)",
>     "Please enter a valid e-mail address"
>   ]
> } 
> ```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2019-11-05T05:56:51.170

在 startup.cs 文件中添加以下代码

```
services.AddMvc().SetCompatibilityVersion(CompatibilityVersion.Version_2_2).ConfigureApiBehaviorOptions(options =>
            {
                options.InvalidModelStateResponseFactory = (context) =>
                {
                    var errors = context.ModelState.Values.SelectMany(x => x.Errors.Select(p => new ErrorModel()
                   {
                       ErrorCode = ((int)HttpStatusCode.BadRequest).ToString(CultureInfo.CurrentCulture),
                        ErrorMessage = p.ErrorMessage,
                        ServerErrorMessage = string.Empty
                    })).ToList();
                    var result = new BaseResponse
                    {
                        Error = errors,
                        ResponseCode = (int)HttpStatusCode.BadRequest,
                        ResponseMessage = ResponseMessageConstants.VALIDATIONFAIL,

                    };
                    return new BadRequestObjectResult(result);
                };
           }); 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2016-09-07T07:27:00.897

C＃

```
 public class ValidateModelAttribute : ActionFilterAttribute
    {
        public override void OnActionExecuting(HttpActionContext actionContext)
        {
            if (actionContext.ModelState.IsValid == false)
            {
                actionContext.Response = actionContext.Request.CreateErrorResponse(
                    HttpStatusCode.BadRequest, actionContext.ModelState);
            }
        }
    } 
```

...

```
 [ValidateModel]
    public HttpResponseMessage Post([FromBody]AnyModel model)
    { 
```

Javascript

```
$.ajax({
        type: "POST",
        url: "/api/xxxxx",
        async: 'false',
        contentType: "application/json; charset=utf-8",
        data: JSON.stringify(data),
        error: function (xhr, status, err) {
            if (xhr.status == 400) {
                DisplayModelStateErrors(xhr.responseJSON.ModelState);
            }
        },
....

function DisplayModelStateErrors(modelState) {
    var message = "";
    var propStrings = Object.keys(modelState);

    $.each(propStrings, function (i, propString) {
        var propErrors = modelState[propString];
        $.each(propErrors, function (j, propError) {
            message += propError;
        });
        message += "\n";
    });

    alert(message);
}; 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2016-02-17T05:58:25.353

**在这里你可以检查以一一显示模型状态错误**

```
 public HttpResponseMessage CertificateUpload(employeeModel emp)
    {
        if (!ModelState.IsValid)
        {
            string errordetails = "";
            var errors = new List<string>();
            foreach (var state in ModelState)
            {
                foreach (var error in state.Value.Errors)
                {
                    string p = error.ErrorMessage;
                    errordetails = errordetails + error.ErrorMessage;

                }
            }
            Dictionary<string, object> dict = new Dictionary<string, object>();

            dict.Add("error", errordetails);
            return Request.CreateResponse(HttpStatusCode.BadRequest, dict);

        }
        else
        {
      //do something
        }
        } 
```

}

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2015-10-11T23:54:40.037

我在实现[可接受的解决方案模式](https://stackoverflow.com/a/11724405/326608)时遇到问题，对于某些模型对象，我`ModelStateFilter`总是会返回`false`（随后返回 400） ：`actionContext.ModelState.IsValid`

```
public class ModelStateFilter : ActionFilterAttribute
{
    public override void OnActionExecuting(HttpActionContext actionContext)
    {
        if (!actionContext.ModelState.IsValid)
        {
            actionContext.Response = new HttpResponseMessage { StatusCode = HttpStatusCode.BadRequest};
        }
    }
} 
```

我只接受 JSON，所以我实现了一个自定义模型绑定器类：

```
public class AddressModelBinder : System.Web.Http.ModelBinding.IModelBinder
{
    public bool BindModel(HttpActionContext actionContext, System.Web.Http.ModelBinding.ModelBindingContext bindingContext)
    {
        var posted = actionContext.Request.Content.ReadAsStringAsync().Result;
        AddressDTO address = JsonConvert.DeserializeObject<AddressDTO>(posted);
        if (address != null)
        {
            // moar val here
            bindingContext.Model = address;
            return true;
        }
        return false;
    }
} 
```

我在我的模型之后直接注册

```
config.BindParameter(typeof(AddressDTO), new AddressModelBinder()); 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2014-07-11T17:47:51.890

您还可以抛出异常，如此处所述：http: [//blogs.msdn.com/b/youssefm/archive/2012/06/28/error-handling-in-asp-net-webapi.aspx](http://blogs.msdn.com/b/youssefm/archive/2012/06/28/error-handling-in-asp-net-webapi.aspx)

请注意，要执行该文章的建议，请记住包含 System.Net.Http

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2022-01-27T10:12:24.623

把它放在 startup.cs 文件中

```
 services.AddMvc().ConfigureApiBehaviorOptions(options =>
        {
            options.InvalidModelStateResponseFactory = (context) =>
            {
                var errors = context.ModelState.Values.SelectMany(x => x.Errors.Select(p =>p.ErrorMessage)).ToList();                    
                var result = new Response
                {
                    Succeeded = false,
                    ResponseMessage = string.Join(", ",errors)
                };
                return new BadRequestObjectResult(result);
            };
        }); 
```

# java - android适合图像以填充整个布局

> ID：11686692
> 
> 赞同：1
> 
> 时间：2012-07-27T11:17:19.893
> 
> 标签：java, android, eclipse

我有一个具有分辨率的图像，以便在我的测试设备上适合整个屏幕。在使用其他屏幕尺寸进行测试时，图像仅适合宽度或高度并留下空白空间，因为它始终按比例缩放。如果比例发生变化，我如何将图像设置为适合全屏？例如，如果我的设备屏幕为 3/4，则图像将在 3/4 显示器上正确缩放，与其分辨率无关。但是，对于 16/9 将不适合全屏。

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout
  xmlns:android="http://schemas.android.com/apk/res/android"
  android:layout_width="fill_parent"
  android:background="@color/blueish"
  android:layout_height="fill_parent">
    <ImageView 
        android:src="@drawable/splashandroid" 
        android:id="@+id/imageView1" 
        android:layout_width="fill_parent" 
        android:layout_height="wrap_content">
        </ImageView>

</LinearLayout> 
```

还尝试了 wrap_content 的图像布局宽度

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-27T11:20:51.447

在你的 ImageView 中添加这个，`android:scaleType="fitXY"`或者你可以在你的活动中使用它`imgview.setScaleType(ScaleType.FIT_XY);`

你可以试试这个，

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout
  xmlns:android="http://schemas.android.com/apk/res/android"
  android:layout_width="fill_parent"
  android:background="@color/blueish"
  android:layout_height="fill_parent">
    <ImageView 
        android:src="@drawable/splashandroid" 
        android:id="@+id/imageView1" 
        android:layout_width="fill_parent" 
        android:layout_height="fill_parent"
        android:scaleType="fitXY"/>

</LinearLayout> 
```

# c - 使用 xscreensaver 编写屏幕保护程序的提示和技巧？

> ID：11686699
> 
> 赞同：6
> 
> 时间：2012-07-27T11:17:50.973
> 
> 标签：c, linux, opengl, screensaver

几个月来我一直在做一些轻量级的 OpenGL 编程，现在我想使用 xscreensaver 库编写一个屏幕保护程序。

在问这个问题之前，我看到了[如何开发 linux 屏幕保护程序](https://stackoverflow.com/questions/1124817/how-to-develop-linux-screen-saver)，但我认为这个特定的问题不够具体。

**我已经做过的**——

1.  我下载了 xscreensaver 源代码并阅读了 README.hacking。我在源代码的 hacks 目录中玩弄 graynetic.c 的代码（jwz 建议用于理解自述文件中的 xscreensaver 的屏幕保护程序之一）。

2.  我读了这个网页 - [http://www.dis.uniroma1.it/~liberato/screensaver/simplesquares.html](http://www.dis.uniroma1.it/~liberato/screensaver/simplesquares.html)（来自链接问题的答案之一）。我下载了 simplesquares.c 代码并尝试运行它。

**我的问题是**-

1.  我不明白我应该如何编译和执行我对任何屏幕保护程序所做的任何更改。
2.  用 gcc 编译前面提到的 simplesquares.c 并运行可执行文件根本没有输出。难道我做错了什么？

**注意**：您必须在 gcc 命令中添加 -lX11 以便在编译 simplesquares.c 时链接 X11 库，否则它将返回未定义的引用错误。

**编辑**：

在编译屏幕保护程序 graynetic.c 时，它会返回一些错误，其中一些我已在此处复制：

```
greynetic.c:(.text+0x4f): undefined reference to `XGetWindowAttributes'
greynetic.c:(.text+0xa6): undefined reference to `get_boolean_resource'
greynetic.c:(.text+0xd9): undefined reference to `get_pixel_resource'
greynetic.c:(.text+0x112): undefined reference to `get_pixel_resource'
greynetic.c:(.text+0x13e): undefined reference to `get_integer_resource'
greynetic.c:(.text+0x185): undefined reference to `XCreateGC'
greynetic.c:(.text+0x1dd): undefined reference to `XCreatePixmapFromBitmapData' 
```

这可能是一个链接错误。

# android - Android：枚举游戏手柄上的按钮

> ID：11686703
> 
> 赞同：6
> 
> 时间：2012-07-27T11:18:10.420
> 
> 标签：android, input-devices, gamepad-api

我有一个可以连接游戏手柄的 Android 设备（它是一个完全标准的 XBox 360 控制器，但我还需要支持其他品种）。游戏手柄显示为带有一些模拟轴和一些按钮的 InputDevice。

我需要能够查询 Android 以找出游戏手柄支持的按钮。有谁知道如何做到这一点？

我知道系统有这些信息，因为如果我编写一个命令行应用程序，它`/dev/input/event...`使用 ioctl 打开和查询按钮`EVIOCGBIT`，我会从内核中得到一个很好的支持按钮列表。但我无法从 Android 应用程序执行此操作，因为我无权直接访问输入设备。

看起来应该可以获取 InputDevice 的 KeyCharacterMap 对象并进行查询；但看起来 Android 已将默认的 QWERTY 键盘键盘映射附加到游戏手柄，而不是构建一个与游戏手柄支持的实际匹配的键盘映射。这会很高兴地告诉我游戏手柄有一个 Q 键，它没有，它没有 BUTTON_X 键，它有，我正在接收按键事件。所以这没有帮助。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-30T09:18:13.253

我还没有想出办法，但我找到了一个可怕的解决方法。

如果你打电话`KeyCharacterMap.deviceHasKey(keycode)`，我可以询问Android系统上是否*有任何*输入设备支持指定的keycode。通过遍历可能出现在游戏手柄上的所有可能按钮（有用的是，它们都被称为`KeyEvent.KEYCODE_BUTTON_something`），我可以发现任何连接的游戏手柄必须至少支持*其中一些*按钮。

这不是一个很好的解决方案 --- 如果我同时连接了 XBox 360 控制器和 Wiimote，那么我无法弄清楚 XBox 控制器没有按钮 1 或 2，而 Wiimote 没有例如 X 或 Y。但至少这是一个开始。

如果有人有更好的想法，请提出一些...

# wix - 如何在不调用安装的情况下执行 MSI 中存在的自定义操作？

> ID：11686705
> 
> 赞同：2
> 
> 时间：2012-07-27T11:18:28.767
> 
> 标签：wix, windows-installer, custom-action

**鉴于：**

1.  Wix 3.0 用于创建 MSI。
2.  该产品由多个功能组成。
3.  每个功能都有几个子功能。这是一个标准的 MSI 功能树。
4.  每个功能或子功能都依赖于多个外部组件。例如 .NET 4、ASP.NET 等
5.  使用 Wix 3.0 SDK 以 C# 编写的自定义操作会处理这些依赖关系，并评估给定功能集是否存在组件。
6.  在安装时，如果缺少给定功能选择的依赖组件，安装将失败。

**实现：** 无需在给定机器上安装 MSI 即可执行先决条件检查，这已在 MSI 中作为安装期间的自定义操作完成。

**失败的尝试：**

**1）** 自定义操作具有这样的功能签名

```
[CustomAction]
public static ActionResult ProcessFeaturePrerequisite(Session session); 
```

为了获得会话对象，我使用了 Wix 3.0 SDK 中的以下 API

```
Session session = Installer.OpenPackage("Pathto\\Product.msi", true); // true doesn’t install it. Also tried with false, but didn’t work. 
```

当我用上面的会话调用上面的方法时，事情失败了。

```
session.Features["SomeFeature"].CurrentState; 
```

这会引发异常。

```
System.ArgumentException was unhandled by user code
  Message=Feature ID not registered. SomeFeature
  Source=Microsoft.Deployment.WindowsInstaller
  StackTrace:
       at Microsoft.Deployment.WindowsInstaller.FeatureInfo.get_CurrentState() 
```

同样在确定先决条件状态的关键 API 下，总是返回 false。

```
session.EvaluateCondition(prereq); 
```

**2)** 我知道一种命令行方式来指定上述 MSI 的功能并安装它。它是这样的

```
msiexec /i "Product.msi" ADDLOCAL=ALL REMOVE="Foo,Bar " 
```

我在 SDK 中找不到任何 API，它允许我传递额外的参数，这些参数在不开始安装的情况下返回会话对象。我的猜测是传递这样的参数将使 session.Features 更有效。

**问题：** 那么我如何实现上述目标？有没有

1.  Wix SDK 中的任何 API 允许我在不调用安装的情况下调用自定义操作？
2.  有什么方法可以在不安装的情况下从命令行为给定的 MSI 调用自定义操作？
3.  有什么方法可以让 Wix 将 MSI 更改为接受包含仅评估操作的自定义操作名称的命令字符串？
4.  有更好的方法来做同样的事情吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T13:28:03.797

我想您正在尝试使用错误的工具来解决问题。据我了解，您想从某个工具中检查安装先决条件，而不是从安装中检查。只要该功能作为 MSI 包中的自定义操作实现，您就希望利用该功能以避免重复代码。

在您的情况下，我会选择不同的方式：

1.  将实际检查先决条件的功能提取到单独的程序集中，例如`checkprereq.dll`
2.  重构您的自定义操作以引用`checkprereq.dll`. 请注意，您必须添加`checkprereq.dll`到您的`Binary`表以及`customaction.dll`. 您应该在此处划分责任：自定义操作部分与 MSI 内容一起使用-在您的情况下，它根据用户选择的功能组合定义要检查的先决条件-以及功能部分-实际先决条件验证，由`checkprereq.dll`
3.  `checkprereq.dll`当您需要检查不触发安装过程的先决条件时单独使用

您在此处概述的尝试证明了一个重要的错误假设：`session`安装时的对象与您仅出于只读目的打开 MSI 数据库获得的安装对象相同。这不是真的！`session`实际上，我怀疑在安装事务之外引用该对象是否有意义。顾名思义，它是一个安装会话，即在进程中可用 - 不是静态的。

当 MSI 包只是一个文件而不是正在运行的安装时，它应该被视为一个数据库。因此，当您打开它进行阅读而不是安装时，只能查询和使用MSI包中的静态信息。例如，我的意思是您可以查询该`Feature`表，但不要期望它包含仅在安装时有意义的信息，例如用户是否选择了要安装的功能。

希望这是有道理的，并向您展示正确的方向。

# google-maps - 谷歌地图：地图样式示例/库

> ID：11686712
> 
> 赞同：11
> 
> 时间：2012-07-27T11:18:47.487
> 
> 标签：google-maps, google-maps-api-3

有谁知道谷歌地图的公共地图样式库？我在这里找到了一些例子：http: [//maps-api-tt.appspot.com/apilite/styled/styled.html](http://maps-api-tt.appspot.com/apilite/styled/styled.html)

但也许有人知道更多带有样式地图示例的网站？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-27T11:22:28.403

我认为这些链接将对您有所帮助：

### [如何制作风格地图](https://developers.google.com/maps/documentation/javascript/styling)

> 样式化的地图允许您自定义标准 Google 基本地图的呈现方式，改变道路、公园和建筑区域等元素的视觉显示。

你有几个例子：

```
var styleArray = [
  {
    featureType: "all",
    stylers: [
      { saturation: -80 }
    ]
  },{
    featureType: "road.arterial",
    elementType: "geometry",
    stylers: [
      { hue: "#00ffee" },
      { saturation: 50 }
    ]
  },{
    featureType: "poi.business",
    elementType: "labels",
    stylers: [
      { visibility: "off" }
    ]
  }
]; 
```

## [一个伟大的编辑](https://mapstyle.withgoogle.com)

你有很多关于如何使用它的说明。

[![](../Images/b7a36fe3db2f71c4ed6136e1c461d28d.png)](https://i.stack.imgur.com/UUo2A.png)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-11-01T23:19:30.167

当我发现你可以用这种方式设置谷歌地图的样式时，我还搜索了一些列出了很棒的配色方案的存储库。我找不到，所以我继续创建了一个。在以下位置查看：

[http://snazzymaps.com](http://snazzymaps.com)

您可以浏览样式、复制 JSON 样式数组或下载完整示例。它很新，但我们已经有了相当多的样式，并且开始收到一些很棒的用户提交。

# javascript - 提示是否重新使用现有的弹出窗口或创建一个新的

> ID：11686718
> 
> 赞同：1
> 
> 时间：2012-07-27T11:19:03.633
> 
> 标签：javascript, browser

我应该以我对 javascript 几乎一无所知这一事实作为开头，除了像这种非常罕见的情况外，我并不打算过多地使用它。所以请原谅我没有尝试更多地了解它以尝试为自己解决这个问题。

**情况：**

我经常喜欢使用弹出式浏览器窗口。为此，我在浏览器中创建了一个书签，其中包含我从某处复制的一小段 Javascript——我不记得在哪里——并适应了我的屏幕：

```
javascript:%20var%20WindowPopup%20=%20window.open(window.location.href,'PopUp','left=1150,top=830,width=660,height=410,scrollbars=yes,location=no,status=no'); 
```

**问题：**

就目前情况而言，当存在现有弹出窗口并且我再次选择书签时，如果我在同一个站点，则会重新使用相同的弹出窗口，否则会创建一个新的弹出窗口。但是有很多时候我想覆盖这个默认行为。

**三个问题：**

1.  如何强制弹出窗口始终在新窗口中打开？

2.  如何强制弹出窗口始终重复使用现有窗口？

3.  结合前两个选项：是否可以检测是否存在弹出窗口并提示我是否要重新使用它或打开一个新窗口？

对你的帮助表示感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T12:29:55.503

小书签中的字符串“PopUp”是弹出窗口的名称。如果您使用相同的名称创建另一个弹出窗口，则将重复使用已打开的窗口。
如果您想避免这种行为，您必须每次都创建一个具有唯一名称的弹出窗口。

以下小书签代码将在弹出窗口的名称上附加一个时间戳，创建一个唯一的名称：

```
javascript:%20var%20WindowPopup%20=%20window.open(window.location.href,'PopUp'+Date.now(),'left=1150,top=830,width=660,height=410,scrollbars=yes,location=no,status=no'); 
```

除非您在一毫秒内打开多个弹出窗口，否则这应该可以工作。

# python - 是否有一个 numpy 内置函数来拒绝列表中的异常值

> ID：11686720
> 
> 赞同：126
> 
> 时间：2012-07-27T11:19:17.567
> 
> 标签：python, numpy

是否有一个 numpy 内置函数可以执行以下操作？也就是说，获取一个列表`d`并返回一个列表`filtered_d`，其中根据 中点的一些假设分布删除了任何外围元素`d`。

```
import numpy as np

def reject_outliers(data):
    m = 2
    u = np.mean(data)
    s = np.std(data)
    filtered = [e for e in data if (u - 2 * s < e < u + 2 * s)]
    return filtered

>>> d = [2,4,5,1,6,5,40]
>>> filtered_d = reject_outliers(d)
>>> print filtered_d
[2,4,5,1,6,5] 
```

我说“类似”是因为该函数可能允许不同的分布（泊松、高斯等）和这些分布中的不同异常值阈值（就像`m`我在这里使用的那样）。

* * *

## 回答 #1

> 赞同：211
> 
> 时间：2013-05-15T09:58:26.050

处理异常值时很重要的一点是，应该尝试使用尽可能稳健的估计量。分布的平均值会受到异常值的影响，但例如中位数会小得多。

基于eumiro的回答：

```
def reject_outliers(data, m = 2.):
    d = np.abs(data - np.median(data))
    mdev = np.median(d)
    s = d/mdev if mdev else 0.
    return data[s<m] 
```

在这里，我将平均值替换为更稳健的中位数，并将标准差替换为中位数到中位数的绝对距离。然后我用它们的（再次）中值缩放距离，以便`m`在合理的相对比例上。

请注意，要使`data[s<m]`语法正常工作，`data`必须是一个 numpy 数组。

* * *

## 回答 #2

> 赞同：138
> 
> 时间：2012-07-27T11:22:30.733

此方法与您的方法几乎相同，只是更多 numpyst（也仅适用于 numpy 数组）：

```
def reject_outliers(data, m=2):
    return data[abs(data - np.mean(data)) < m * np.std(data)] 
```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2017-07-30T11:10:24.607

当与中位数的距离中位数为 0 时，Benjamin Bannier 的答案会产生直通，因此我发现此修改后的版本对以下示例中给出的情况更有帮助。

```
def reject_outliers_2(data, m=2.):
    d = np.abs(data - np.median(data))
    mdev = np.median(d)
    s = d / (mdev if mdev else 1.)
    return data[s < m] 
```

例子：

```
data_points = np.array([10, 10, 10, 17, 10, 10])
print(reject_outliers(data_points))
print(reject_outliers_2(data_points)) 
```

给出：

```
[[10, 10, 10, 17, 10, 10]]  # 17 is not filtered
[10, 10, 10, 10, 10]  # 17 is filtered (it's distance, 7, is greater than m) 
```

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2016-09-10T10:05:48.787

Building on Benjamin's, using `pandas.Series`, and replacing [MAD with IQR](https://en.wikipedia.org/wiki/Robust_measures_of_scale#IQR_and_MAD):

```
def reject_outliers(sr, iq_range=0.5):
    pcnt = (1 - iq_range) / 2
    qlow, median, qhigh = sr.dropna().quantile([pcnt, 0.50, 1-pcnt])
    iqr = qhigh - qlow
    return sr[ (sr - median).abs() <= iqr] 
```

For instance, if you set `iq_range=0.6`, the percentiles of the interquartile-range would become: `0.20 <--> 0.80`, so *more* outliers will be included.

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2017-07-20T12:43:15.460

另一种方法是对标准偏差进行稳健估计（假设高斯统计）。查找在线计算器，我看到 90% 的百分位数对应于 1.2815σ，而 95% 对应于 1.645σ（[http://vassarstats.net/tabs.html?#z](http://vassarstats.net/tabs.html?#z)）

举个简单的例子：

```
import numpy as np

# Create some random numbers
x = np.random.normal(5, 2, 1000)

# Calculate the statistics
print("Mean= ", np.mean(x))
print("Median= ", np.median(x))
print("Max/Min=", x.max(), " ", x.min())
print("StdDev=", np.std(x))
print("90th Percentile", np.percentile(x, 90))

# Add a few large points
x[10] += 1000
x[20] += 2000
x[30] += 1500

# Recalculate the statistics
print()
print("Mean= ", np.mean(x))
print("Median= ", np.median(x))
print("Max/Min=", x.max(), " ", x.min())
print("StdDev=", np.std(x))
print("90th Percentile", np.percentile(x, 90))

# Measure the percentile intervals and then estimate Standard Deviation of the distribution, both from median to the 90th percentile and from the 10th to 90th percentile
p90 = np.percentile(x, 90)
p10 = np.percentile(x, 10)
p50 = np.median(x)
# p50 to p90 is 1.2815 sigma
rSig = (p90-p50)/1.2815
print("Robust Sigma=", rSig)

rSig = (p90-p10)/(2*1.2815)
print("Robust Sigma=", rSig) 
```

我得到的输出是：

```
Mean=  4.99760520022
Median=  4.95395274981
Max/Min= 11.1226494654   -2.15388472011
Sigma= 1.976629928
90th Percentile 7.52065379649

Mean=  9.64760520022
Median=  4.95667658782
Max/Min= 2205.43861943   -2.15388472011
Sigma= 88.6263902244
90th Percentile 7.60646688694

Robust Sigma= 2.06772555531
Robust Sigma= 1.99878292462 
```

接近预期值 2。

如果我们要删除高于/低于 5 个标准差的点（对于 1000 个点，我们期望 1 个值 > 3 个标准差）：

```
y = x[abs(x - p50) < rSig*5]

# Print the statistics again
print("Mean= ", np.mean(y))
print("Median= ", np.median(y))
print("Max/Min=", y.max(), " ", y.min())
print("StdDev=", np.std(y)) 
```

这使：

```
Mean=  4.99755359935
Median=  4.95213030447
Max/Min= 11.1226494654   -2.15388472011
StdDev= 1.97692712883 
```

我不知道哪种方法更有效/更强大

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2019-09-09T16:10:20.413

考虑到当您的标准偏差由于巨大的异常值而变得非常大时，上述所有方法都会失败。

（*与平均计算失败类似，应该计算中位数。虽然，平均值“更容易出现像 stdDv 这样的错误”。*）

您可以尝试迭代地应用您的算法或使用四分位数范围进行过滤：（这里的“因子”与 * sigma 范围相关，但仅当您的数据遵循高斯分布时）

```
import numpy as np

def sortoutOutliers(dataIn,factor):
    quant3, quant1 = np.percentile(dataIn, [75 ,25])
    iqr = quant3 - quant1
    iqrSigma = iqr/1.34896
    medData = np.median(dataIn)
    dataOut = [ x for x in dataIn if ( (x > medData - factor* iqrSigma) and (x < medData + factor* iqrSigma) ) ] 
    return(dataOut) 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2018-06-20T19:53:51.060

我想做类似的事情，除了将数字设置为 NaN 而不是从数据中删除它，因为如果你删除它，你会改变长度，这可能会弄乱绘图（即，如果你只是从表中的一列中删除异常值，但您需要它与其他列保持相同，以便您可以将它们相互绘制）。

为此，我使用了[numpy 的屏蔽函数](https://docs.scipy.org/doc/numpy/reference/maskedarray.generic.html)：

```
def reject_outliers(data, m=2):
    stdev = np.std(data)
    mean = np.mean(data)
    maskMin = mean - stdev * m
    maskMax = mean + stdev * m
    mask = np.ma.masked_outside(data, maskMin, maskMax)
    print('Masking values outside of {} and {}'.format(maskMin, maskMax))
    return mask 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2018-09-20T02:48:17.987

我想在这个答案中提供两种方法，基于“z score”的解决方案和基于“IQR”的解决方案。

此答案中提供的代码适用于单个暗淡`numpy`数组和多个`numpy`数组。

我们先导入一些模块。

```
import collections
import numpy as np
import scipy.stats as stat
from scipy.stats import iqr 
```

## 基于 z 分数的方法

此方法将测试数字是否超出三个标准偏差。根据此规则，如果值异常，则该方法将返回 true，否则返回 false。

```
def sd_outlier(x, axis = None, bar = 3, side = 'both'):
    assert side in ['gt', 'lt', 'both'], 'Side should be `gt`, `lt` or `both`.'

    d_z = stat.zscore(x, axis = axis)

    if side == 'gt':
        return d_z > bar
    elif side == 'lt':
        return d_z < -bar
    elif side == 'both':
        return np.abs(d_z) > bar 
```

## 基于IQR的方法

该方法将测试该值是否小于`q1 - 1.5 * iqr`或大于`q3 + 1.5 * iqr`，类似于 SPSS 的绘图方法。

```
def q1(x, axis = None):
    return np.percentile(x, 25, axis = axis)

def q3(x, axis = None):
    return np.percentile(x, 75, axis = axis)

def iqr_outlier(x, axis = None, bar = 1.5, side = 'both'):
    assert side in ['gt', 'lt', 'both'], 'Side should be `gt`, `lt` or `both`.'

    d_iqr = iqr(x, axis = axis)
    d_q1 = q1(x, axis = axis)
    d_q3 = q3(x, axis = axis)
    iqr_distance = np.multiply(d_iqr, bar)

    stat_shape = list(x.shape)

    if isinstance(axis, collections.Iterable):
        for single_axis in axis:
            stat_shape[single_axis] = 1
    else:
        stat_shape[axis] = 1

    if side in ['gt', 'both']:
        upper_range = d_q3 + iqr_distance
        upper_outlier = np.greater(x - upper_range.reshape(stat_shape), 0)
    if side in ['lt', 'both']:
        lower_range = d_q1 - iqr_distance
        lower_outlier = np.less(x - lower_range.reshape(stat_shape), 0)

    if side == 'gt':
        return upper_outlier
    if side == 'lt':
        return lower_outlier
    if side == 'both':
        return np.logical_or(upper_outlier, lower_outlier) 
```

最后，如果要过滤掉异常值，请使用`numpy`选择器。

祝你今天过得愉快。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2021-10-27T20:10:23.453

这么多答案，但我正在添加一个对作者甚至其他用户有用的新答案。

您可以使用**Hampel 过滤器**。但是您需要使用`Series`.

**Hampel 过滤器**返回**异常值索引**，然后您可以将它们从 中删除`Series`，然后将其转换回`List`。

要使用**Hampel 过滤器**，您可以使用以下命令轻松安装软件包`pip`：

```
pip install hampel 
```

用法：

```
# Imports
from hampel import hampel
import pandas as pd

list_d = [2, 4, 5, 1, 6, 5, 40]

# List to Series
time_series = pd.Series(list_d)

# Outlier detection with Hampel filter
# Returns the Outlier indices
outlier_indices = hampel(ts = time_series, window_size = 3)

# Drop Outliers indices from Series
filtered_d = time_series.drop(outlier_indices)

filtered_d.values.tolist()

print(f'filtered_d: {filtered_d.values.tolist()}') 
```

输出将是：

> filters_d: [2, 4, 5, 1, 6, 5]

其中，`ts`是一个熊猫`Series`对象，`window_size`是一个总窗口大小，将计算为`2 * window_size + 1`。

对于这个系列，我设置`window_size`了值`3`。

使用 Series 最酷的地方在于能够生成图形：

```
# Imports
import matplotlib.pyplot as plt

plt.style.use('seaborn-darkgrid')

# Plot Original Series
time_series.plot(style = 'k-')
plt.title('Original Series')
plt.show()

# Plot Cleaned Series
filtered_d.plot(style = 'k-')
plt.title('Cleaned Series (Without detected Outliers)')
plt.show() 
```

输出将是：

[![在此处输入图像描述](../Images/a68a094e33bae4683de358824eb26db3.png)](https://i.stack.imgur.com/EzRA0.png) [![在此处输入图像描述](../Images/fb1a7517ea3a4c6d8f1ab1cf30caa59f.png)](https://i.stack.imgur.com/PFklE.png)

要了解有关**Hampel 过滤器**的更多信息，我推荐以下阅读材料：

*   [Hampel 过滤器的 Python 实现](https://github.com/MichaelisTrofficus/hampel_filter)
*   [使用 Hampel 滤波器进行异常值检测](https://towardsdatascience.com/outlier-detection-with-hampel-filter-85ddf523c73d)
*   [使用 Hampel 过滤器清理您的时间序列数据](https://medium.com/wwblog/clean-up-your-time-series-data-with-a-hampel-filter-58b0bb3ebb04)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-06-30T06:31:41.473

对于一组**图像**（每个图像有 3 个维度），我想拒绝我使用的每个像素的异常值：

```
mean = np.mean(imgs, axis=0)
std = np.std(imgs, axis=0)
mask = np.greater(0.5 * std + 1, np.abs(imgs - mean))
masked = np.multiply(imgs, mask) 
```

然后可以计算平均值：

```
masked_mean = np.divide(np.sum(masked, axis=0), np.sum(mask, axis=0)) 
```

（我用它来做背景减法）

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-12-08T13:49:48.790

在这里，我找到异常值`x`并将它们替换为它们`win`周围的点 ( ) 窗口的中值（取自 Benjamin Bannier 答案中值偏差）

```
def outlier_smoother(x, m=3, win=3, plots=False):
    ''' finds outliers in x, points > m*mdev(x) [mdev:median deviation] 
    and replaces them with the median of win points around them '''
    x_corr = np.copy(x)
    d = np.abs(x - np.median(x))
    mdev = np.median(d)
    idxs_outliers = np.nonzero(d > m*mdev)[0]
    for i in idxs_outliers:
        if i-win < 0:
            x_corr[i] = np.median(np.append(x[0:i], x[i+1:i+win+1]))
        elif i+win+1 > len(x):
            x_corr[i] = np.median(np.append(x[i-win:i], x[i+1:len(x)]))
        else:
            x_corr[i] = np.median(np.append(x[i-win:i], x[i+1:i+win+1]))
    if plots:
        plt.figure('outlier_smoother', clear=True)
        plt.plot(x, label='orig.', lw=5)
        plt.plot(idxs_outliers, x[idxs_outliers], 'ro', label='outliers')                                                                                                                    
        plt.plot(x_corr, '-o', label='corrected')
        plt.legend()

    return x_corr 
```

[![在此处输入图像描述](../Images/6e2423cb71315cfd520e999627da96b5.png)](https://i.stack.imgur.com/Wom6j.png)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-10-29T13:57:06.940

我的解决方案删除了​​顶部和底部百分位数，保持等于边界的值：

```
def remove_percentile_outliers(data, percent_to_drop=0.001):
    low, high = data.quantile([percent_to_drop / 2, 1-percent_to_drop / 2])
    return data[(data >= low )&(data <= high)] 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-04-19T17:25:56.990

如果要获取异常值的索引位置，`idx_list`将返回它。

```
def reject_outliers(data, m = 2.):
        d = np.abs(data - np.median(data))
        mdev = np.median(d)
        s = d/mdev if mdev else 0.
        data_range = np.arange(len(data))
        idx_list = data_range[s>=m]
        return data[s<m], idx_list

data_points = np.array([8, 10, 35, 17, 73, 77])  
print(reject_outliers(data_points))

after rejection: [ 8 10 35 17], index positions of outliers: [4 5] 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-06-29T06:15:22.007

沿轴修剪 numpy 数组中的异常值，并用沿该轴的最小值或最大值替换它们，以更接近者为准。阈值是 z-score：

```
def np_z_trim(x, threshold=10, axis=0):
    """ Replace outliers in numpy ndarray along axis with min or max values
    within the threshold along this axis, whichever is closer."""
    mean = np.mean(x, axis=axis, keepdims=True)
    std = np.std(x, axis=axis, keepdims=True)
    masked = np.where(np.abs(x - mean) < threshold * std, x, np.nan)
    min = np.nanmin(masked, axis=axis, keepdims=True)
    max = np.nanmax(masked, axis=axis, keepdims=True)
    repl = np.where(np.abs(x - max) < np.abs(x - min), max, min)
    return np.where(np.isnan(masked), repl, masked) 
```

# php - 加载 php_xdebug 消息失败

> ID：11686721
> 
> 赞同：2
> 
> 时间：2012-07-27T11:19:35.503
> 
> 标签：php, xdebug, easyphp

当我从命令行（在 Windows 上）运行 php 时，我收到以下消息

> 加载失败 C:\Users\Nickey K\Documents\AMD APP\bin\x86_64;C:\Users\Nickey K\ Documents\AMD APP\bin\x86;C:\Program Files (x86)\AMD APP\bin\ x86_64;C:\Program Files (x86)\AMD APP\bin\x86;C:\Program Files\Common Files\Microsoft Shared\Windows s Live;C:\Program Files (x86)\Common Files\Microsoft Shared\ Windows Live;C:\Program Files (x86)\NVIDIA Corporation\PhysX\Common;C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem;C:\Windows\System32\WindowsPowerShell\ v1.0\;C:\Program Files (x86)\Calibre2\;C:\Program Files (x86)\QuickTime\QTSystem\;C:\Program Files (x86)\Windows Live\Shared;C:\Program文件 (x86)\ATI Technologies\ATI.ACE\Core-Static;C:\Program Files (x86)\EasyPHP-12.0\php\php544x120715104042;\php\php544x1 20715104042\php_xdebug-2.2.0-5.4-vc9.dll

x_debug 似乎根据 phpinfo 正确安装，我在 php.ini 中有以下行

```
zend_extension = "C:\Program Files (x86)\EasyPHP-12.0\php\php544x120715104042\php_xdebug-2.2.0-5.4-vc9.dll" 
```

我已将 dll 文件放在 ...\ext 目录的上方，并尝试了上述行的一些变体，但我无法摆脱此错误消息。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-05-26T03:35:24.577

如果您使用的是 window.js，让我们尝试使用 zend_extension_tc 而不是 zend_extension。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-30T08:13:27.747

EasyPHP 中的常规命令行 PHP 无法正常工作。问题是 EasyPHP 用`PATH`自己的变量替换了变量。这只是愚蠢的，它不使用不同的变量。

但是，经过一些实验，以下内容对我有用。我创建了一个批处理文件`php5.bat`并将其放入以便于`C:\Windows\Sytem32`访问，使用以下代码（`C:\Program Files (x86)\EasyPHP-12.1\php\php548x121030011600`我的 easyPHP php.exe 所在的位置在哪里）。

```
@echo off
REM Set the path for easy PHP and then start PHP.
set OLD_PATH=%PATH%
set PATH=C:\Program Files (x86)\EasyPHP-12.1
set PHP_DIR=C:\Program Files (x86)\EasyPHP-12.1\php\php548x121030011600
call "%PHP_DIR%\php.exe" -c "%PHP_DIR%\php.ini" %*
set PATH=%OLD_PATH%
@echo on 
```

然后调用批处理文件`php5 -v`将为您提供 php 版本。您可能需要将 Apache 文件夹中的一些 DLL 复制到 PHP 文件夹中，因为它会提示找不到 DLL。

# javascript - 在for循环javascript中添加数字

> ID：11686724
> 
> 赞同：10
> 
> 时间：2012-07-27T11:19:48.843
> 
> 标签：javascript

我需要使用 javascript 将 for 循环中的所有数字相加

```
var nums = ['100','300','400','60','40'];

for(var i=1; i < nums.length; i++){

        var num = nums[i] + nums[i];

        alert(num);
}​ 
```

有人可以帮助[http://jsfiddle.net/GYpd2/1/](http://jsfiddle.net/GYpd2/1/)

我要找的结果是 900

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-07-27T11:21:33.210

```
var nums = ['100','300','400','60','40'];
var sum = 0;

for(var i=0; i < nums.length; i++){

    sum += parseInt(nums[i]);

}

alert(sum); 
```

测试： http: [//jsfiddle.net/GYpd2/6/](http://jsfiddle.net/GYpd2/6/)（感谢user1503606）

如果`nums`仅包含数字，则不需要`parseInt()`.

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-07-27T11:26:26.170

ES5`Array.prototype.reduce`方法的主要示例。像：

```
var nums  = ['100','300','400','60','40'];

var total = nums.reduce(function(a,b) {
    return (+a)+(+b);
}); 
```

演示：http: [//jsfiddle.net/FwfmE/](http://jsfiddle.net/FwfmE/)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-07-27T11:23:25.720

```
var nums = ['100','300','400','60','40'], 
    num = 0;

for (var i = 0; i < nums.length; i++) {
    num += +nums[i];
}
alert(num);
​ 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-07-27T11:23:52.167

像这样做

```
var nums = ['100','300','400','60','40'];
var total = 0;    

for(var i=0; i < nums.length; i++){
    total = total + Number(nums[i]);
}
alert(total); 
```

1.  循环从 0 而不是 1 开始。

2.  `total`变量需要在循环之前声明，否则它不会保留之前的添加。

3.  使用 Number() 将字符串转换为数字。

4.  添加字符串意味着连接`'100'`+`'200'`将给出`'100200'`.

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-07-27T11:21:30.107

```
var num, nums = [100,300,400,60,40];

for ( var i=1; i < nums.length; i++ ) {
    num += nums[i];
}​

alert(num); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-07-27T11:50:23.960

如果你有一个[reduce 函数](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/Reduce)，你可以这样做：

```
var nums = ['100','300','400','60','40'],
    sum = nums.reduce(function(accum, val) {return accum + Number(val);}, 0);
alert(sum); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-07-27T11:21:50.153

Javascript 将您的数字视为字符串，并将它们连接在一起，而不是像您期望的那样添加它们。

用于`parseInt`在添加之前将它们转换为整数：

```
var nums = ['100','300','400','60', 40];
var num = 0;

for(var i=1; i < nums.length; i++){
       num += parseInt(nums[i], 10);
       alert(num);
}​ 
```

第二[个参数](http://ajaxian.com/archives/the-parseint-gotcha)告诉`parseInt`使用基数 10。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-07-27T11:27:37.093

这是[JSFiddle](http://jsfiddle.net/GYpd2/5/)

代码是：

```
var num=0, nums = ['100','300','400','60','40'];

for(var i=0; i < nums.length; i++){            
        num += parseInt(nums[i]);  
}
  alert(num); 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-07-27T12:02:30.213

```
var i, sum = 0, nums = ['100','300','400','60','40'];

for (i = 0; i < nums.length; i++) {
    sum += +nums[i];
}

alet(sum); 
```

您不应该`var`在循环中使用该语句。此外`parseInt`，其他答案中使用的函数将始终将数字转换为整数，因此它不适用于浮点数。为数字加上前缀`+`会将它们转换为数字。

如果您为浏览器开发，使用该`reduce`功能可能会导致旧浏览器出现问题 - 除非您找到它的 polyfill。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2015-11-02T17:30:31.677

```
var nums = ['100','300','400','60','40'];
var num = 0; 

for(var i=0; i < nums.length; i++){
    num = parseInt(num) + parseInt(nums[i]);
} 
```

我就是这样做的。它与其他人的代码非常相似，但编写方式不同。您确实需要在 for 循环中以 0 开始您的初始 i 值。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2015-11-02T17:44:01.327

这是一个使用 Number 原型扩展的示例，类似于 LINQ 的 sum 方法：

```
Array.prototype.sum = function () {
  var result = 0;
  this.forEach(function (o) { result += Number(o); });
  return result;
};

var sum = ['100','300','400','60','40'].sum(); 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2016-10-05T06:33:32.600

你可以做这样的事情..

```
var nums = ['100','300','400','60','40'];

nums.reduceRight(function(a,b){return Number(a)+Number(b);}) 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2021-07-02T21:05:14.077

```
var nums = ['100','300','400','60','40'];
let sum =0;
    for(let numbers of nums){
 sum+=parseInt(numbers);
     }
alert(sum); 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2020-09-16T06:30:24.547

你可以试试这个：

```
var arr = ['100','300','400','60','40'];
var total = 0; 
for(var i in arr){
  total += parseInt(arr[i]);
}

console.log(total); 
```

输出将是：900

或者如果 value 是 Fl​​oat，那么试试这个：

```
var arr = [100.00,300.50,400.75,60.00,40.00];
    var total = 0; 
    for(var i in arr){
      total += parseFloat(arr[i]);
    }

    console.log(total.toFixed(2)); 
```

输出将是：901.25

# c# - 添加对导致异常的实体的引用

> ID：11686727
> 
> 赞同：0
> 
> 时间：2012-07-27T11:19:59.870
> 
> 标签：c#, .net, entity-framework, domain-driven-design, ef-model-first

我有一个如下所示的模型（使用**模型优先**方法创建）。

一本书是一种销售物品。DigitalDisc 是一种销售商品。这工作正常，数据被正确插入到数据库中。

我正在添加一个名为“Purchase”的新实体。一次购买包含多个销售项目。一旦我添加了这个新关联并更新了数据库模式，我就会得到以下异常。

> 更新条目时出错。
> 
> "INSERT 语句与 FOREIGN KEY 约束 \"FK_PurchaseSellingItem\" 冲突。冲突发生在数据库 \"LibraryReservationSystem\"、表 \"dbo.Purchases\"、列 'PurchaseId' 中。\r\n语句已终止。 "}

如何克服这一点？

注意：我需要创建一本书（比如将书籍数据输入数据库）。这本书可能会或可能不会发生购买。创建书时，该书的外键列应为空。但是当该列更新时，它应该是 Purchase 表中存在的 ID 这可能吗？

![在此处输入图像描述](../Images/0157f77f9eb9fa0c285d069ab559b11c.png)

注意：当我尝试在模型中使字段“PurchasePurchaseId”为空时，我收到以下错误：

> 错误 1 ​​错误 113：多重性在关系“PurchaseSellingItem”中的角色“Purchase”中无效。因为从属角色中的所有属性都可以为空，所以主体角色的多重性必须为“0..1”。C:\Documents and Settings\U16990\My Documents\Visual Studio 2010\Projects\LijosEF\LijosEF\MyModelFirstTest.edmx 35 3 LijosEF

代码

```
class Program
{

    static string connectionStringVal;

    static void Main(string[] args)
    {

        SqlConnectionStringBuilder sqlBuilder = new SqlConnectionStringBuilder();
        sqlBuilder.DataSource = ".";
        sqlBuilder.InitialCatalog = "LibraryReservationSystem";
        sqlBuilder.IntegratedSecurity = true;

        // Initialize the EntityConnectionStringBuilder.
        EntityConnectionStringBuilder entityBuilder = new EntityConnectionStringBuilder();
        entityBuilder.Provider = "System.Data.SqlClient";
        entityBuilder.ProviderConnectionString = sqlBuilder.ToString();
        entityBuilder.Metadata = @"res://*/MyModelFirstTest.csdl|res://*/MyModelFirstTest.ssdl|res://*/MyModelFirstTest.msl";

        connectionStringVal = entityBuilder.ToString();

        AddBook();
        AddDisc();

    }

    private static void AddBook()
    {

        //string connectionstring = "Data Source=.;Initial Catalog=SalesDB;Integrated Security=True;Connect Timeout=30";
        using (var db = new MyModelFirstTestContainer(connectionStringVal))
        {
            Book book = new Book();
            book.AvailabilityStatus = "Available";
            book.Price = 150;
            book.Title = "Maths Easy";

            db.SellingItems.AddObject(book);
            db.SaveChanges();

        }

    }

    private static void AddDisc()
    {

        //string connectionstring = "Data Source=.;Initial Catalog=SalesDB;Integrated Security=True;Connect Timeout=30";
        using (var db = new MyModelFirstTestContainer(connectionStringVal))
        {
            DigitalDisc disc = new DigitalDisc();
            disc.AvailabilityStatus = "Available";
            disc.Price = 300;
            disc.Artist = "Turtle Violin";

            db.SellingItems.AddObject(disc);
            db.SaveChanges();

        }

    }

} 
```

参考：

1.  [数据库设计 - 文章、博客文章、照片、故事](https://stackoverflow.com/questions/4969133/database-design-problem)

2.  [我可以让实体框架（模型优先）生成复合键吗？](https://stackoverflow.com/questions/5261298/can-i-get-entity-framework-model-first-to-generate-composite-keys)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T11:38:43.210

您将您的关系配置为强制但您正在保存`SellingItem`而没有相关`Purchase`。我希望 EF 在将记录保存到数据库之前会抛出一些异常，但它没有，它很可能会尝试传递 FK 列的默认值，而你没有任何`Purchase`这样的`Id`.

顺便提一句。你不应该使用多对多关系，因为销售项目可以多次销售，而购买可以有多个销售项目？

# c# - 缓存可用于 WCF 和 ASP .NET 应用程序 (.NET 3.5)

> ID：11686728
> 
> 赞同：3
> 
> 时间：2012-07-27T11:20:00.343
> 
> 标签：c#, asp.net, .net, wcf, caching

我需要可以在 WCF 和 ASP .NET 应用程序中工作的缓存工具。我见过：

1.  `System.Web.Caching.Cache`这不能从 WCF 中使用（据我所知，只有当服务托管在 IIS 中时它才可用，但情况并非总是如此）

2.  `System.Runtime.Caching`它们都可以使用，但只能从 .NET 4 获得，但我们的 .NET 版本是 3.5。

有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-27T11:38:54.927

您绝对可以`System.Web.Caching.Cache`在 IIS 之外使用。只需添加一个引用就`System.Web`可以了 - 它绝对不是 IIS 的功能。

在 .NET 1.0 和 1.1 中存在问题，但在 2.0 及更高版本中显然没有 - 请参阅[此知识库文章](http://support.microsoft.com/kb/917411)。

但像 Davide Piras 一样，我也建议考虑 AppFabric 在两个应用程序之间共享缓存，如果这有用的话。我不确定您所说的“我的要求买不起 AppFabric 之类的东西”是什么意思——“负担得起”是指性能、内存还是什么？虽然 AppFabric 设计用于缓存服务器，但它并不需要专用硬件，但如果需要，您可以在与应用程序相同的机器上运行该服务。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-05T14:26:34.290

新解决方案使用 Windows Server AppFabric 缓存

[https://github.com/geersch/AppFabric](https://github.com/geersch/AppFabric)

[http://dotnet.dzone.com/articles/caching-wcf-services-part-2](http://dotnet.dzone.com/articles/caching-wcf-services-part-2)

[http://channel9.msdn.com/Events/TechEd/NorthAmerica/2012/AAP314](http://channel9.msdn.com/Events/TechEd/NorthAmerica/2012/AAP314)

***2.in .NET 1.0 和 1.1 [http://support.microsoft.com/kb/917411](http://support.microsoft.com/kb/917411)

# php - wordpress 类别缺少图像

> ID：11686732
> 
> 赞同：0
> 
> 时间：2012-07-27T11:20:23.617
> 
> 标签：php, html, wordpress

好的，所以我有一个 wordpress 网站。

例如 wordpress.com

在它上面我有一个叫做体育的页面，我把其中一些页面放在“夏天”页面下

所以网址现在是 www.wordpress.com/summer/sports

然而所有的图像都在 wordpress.com 所以页面下的所有页面都看不到这些图像，你所拥有的只是图像框架。

如果您创建目录summer 并将图像放入其中，它会这样当您访问www.wordpress.com/summer/sports 时，您将被带到一个只有一个图像的空白页面。

因此，在页面名称下创建目录实际上会与 wordpress 混淆并使该页面无法访问。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T13:10:14.543

我假设您使用了页面上图像的相对路径，因此当您移动它们时，他们不再知道图像相对于相对路径的位置。使用绝对路径可以解决这个问题（例如[http://wordpress.com/myimages/test.png](http://wordpress.com/myimages/test.png)），然后您可以将页面移动到任何地方，它们将始终拾取图像，或者您需要更改相对路径。

有关相对路径和绝对路径的说明，请参见此处：[http ://webdesign.about.com/od/beginningtutorials/a/aa040502a.htm](http://webdesign.about.com/od/beginningtutorials/a/aa040502a.htm)

# android - 为什么 TabView 和 MapView 不能一起工作？

> ID：11686737
> 
> 赞同：0
> 
> 时间：2012-07-27T11:20:52.757
> 
> 标签：android, android-mapview, android-tabhost, android-tabs

我有一个简单的 tabView，有 2 个选项卡。在第一个选项卡中，我显示了一些列表视图，在第二个选项卡中，我想显示地图。但是当我尝试是我的应用程序坏了。

有我的标签视图代码：

```
public class MainActivity extends TabActivity {
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        Resources res = getResources();

        TabHost tabHost = getTabHost();
        Intent i = getIntent();

        Intent intentList = new Intent().setClass(this, ListActivity.class);
        intentList.putExtra(StartActivity.SEARCH_KEY, i.getStringExtra(StartActivity.SEARCH_KEY));
        TabHost.TabSpec tabSpecList = tabHost.newTabSpec("List").setContent(intentList).setIndicator(res.getString(R.string.list_tab));

        Intent intentMap = new Intent().setClass(this, MapPlaceActivity.class);
        TabHost.TabSpec tabSpecMap = tabHost.newTabSpec("Map").setContent(intentMap).setIndicator(res.getString(R.string.map_tab));

        tabHost.addTab(tabSpecList);
        tabHost.addTab(tabSpecMap);
        tabHost.setCurrentTab(0);
    }

} 
```

当我运行应用程序时，我遇到了错误：

```
07-27 14:12:23.676: ERROR/dalvikvm(19527): Could not find class 'com.example.MapPlaceActivity', referenced from method com.example.MainActivity.onCreate
07-27 14:12:23.676: WARN/dalvikvm(19527): VFY: unable to resolve const-class 66 (Lcom/example/MapPlaceActivity;) in Lcom/example/MainActivity;
07-27 14:12:23.686: WARN/dalvikvm(19527): threadid=1: thread exiting with uncaught exception (group=0x4001d5a0)
07-27 14:12:23.686: ERROR/AndroidRuntime(19527): FATAL EXCEPTION: main
        java.lang.NoClassDefFoundError: com.example.MapPlaceActivity
        at com.example.MainActivity.onCreate(MainActivity.java:29)
        at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1072)
        at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1836)
        at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1893)
        at android.app.ActivityThread.access$1500(ActivityThread.java:135)
        at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1054)
        at android.os.Handler.dispatchMessage(Handler.java:99)
        at android.os.Looper.loop(Looper.java:150)
        at android.app.ActivityThread.main(ActivityThread.java:4385)
        at java.lang.reflect.Method.invokeNative(Native Method)
        at java.lang.reflect.Method.invoke(Method.java:507)
        at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:849)
        at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:607)
        at dalvik.system.NativeStart.main(Native Method) 
```

但我真的有 MapPlaceActivity，它有代码：

```
public class MapPlaceActivity extends MapActivity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.map);
        MapView mapView = (MapView) findViewById(R.id.mapview);
        mapView.setBuiltInZoomControls(true);
    }

    @Override
    protected boolean isRouteDisplayed() {
        return false;  //To change body of implemented methods use File | Settings | File Templates.
    }
} 
```

还有我的布局文件（map.xml）：

```
<?xml version="1.0" encoding="utf-8"?>
<com.google.android.maps.MapView
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:id="@+id/mapview"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:clickable="true"
        android:apiKey="Hiden key"
/> 
```

我的清单文件：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
          package="com.example"
          android:versionCode="1"
          android:versionName="1.0">
    <uses-sdk android:minSdkVersion="8"/>
    <uses-permission android:name="android.permission.INTERNET" />
    <uses-library android:name="com.google.android.maps"/>
    <application android:label="@string/app_name">

        <activity android:name=".StartActivity"
                  android:label="@string/app_name"
                  android:theme="@android:style/Theme.Light.NoTitleBar">
            <intent-filter>
                <action android:name="android.intent.action.MAIN"/>
                <category android:name="android.intent.category.LAUNCHER"/>
            </intent-filter>
        </activity>
        <activity android:name=".Pref"
                  android:label="@string/settings_label"
                  >
        </activity>
        <activity android:name=".MainActivity"
                  android:theme="@android:style/Theme.Light.NoTitleBar">
        </activity>
        <activity android:name=".MapPlaceActivity"
                  android:label="@string/map_tab"
                  android:theme="@android:style/Theme.Light.NoTitleBar">
        </activity>
        <activity android:name=".ListActivity"
            android:theme="@android:style/Theme.Light.NoTitleBar">
        </activity>

    </application>
</manifest> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T11:32:20.917

我想您需要在清单文件的应用程序标记内添加使用库行。

如果您愿意，也可以提供以下标签

```
<supports-screens
android:anyDensity="true"
android:resizeable="true"
android:largeScreens="true" /> 
```

# c# - 反序列化具有相同元素名称但不同属性的 Xml

> ID：11686740
> 
> 赞同：2
> 
> 时间：2012-07-27T11:20:59.937
> 
> 标签：c#, xml, xml-serialization

我有一些看起来像这样的 XML：

```
<Stat Type="first_name">[Value]</Stat>
<Stat Type="last_name">[Value]</Stat>
<Stat Type="known_name">[Value]</Stat> 
```

我想将它反序列化为一个对象。由于有一个名为“Stat”的元素名称，因此很难获得以下内容：

```
[XmlAttribute("first_name")]
public string FirstName{get;set;}

[XmlAttribute("last_name")]
public string LastName{get;set;}

[XmlAttribute("known_name")]
public string KnownName{get;set;} 
```

有没有办法将上面的 XML 放入一个对象中，例如：

```
public string FirstName{get;set;}
public string LastName{get;set;}
public string KnownName{get;set;} 
```

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-30T14:50:32.770

我设法通过使用扩展来解决这个问题。不理想。我得到统计列表：

```
[XmlElement("Stat")]
public List<Stat> Stats { get; set;} 
```

然后我有单独的属性，例如：

```
public string FirstName
{
   get { return Stats.GetStat("first_name"); }
} 
```

然后 Stats 属性上的 GetStat 扩展方法获取相关键。不幸的是，通过这种方式，它将遍历我想要获得的每个属性的列表。

```
public static string GetStat(this List<Stat> stats, string key)
{
  var val = stats.FirstOrDefault(item => item.Type == key);

  if (val != null)
    return val.Value ?? String.Empty;
  return String.Empty;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T12:00:35.533

如果您想使用序列化，我认为您将需要一个中间对象。所以，反序列化成这样的东西：

```
public class Stat
{
    [XmlAttribute("Type")]
    public string Type { get; set; }

    [XmlText]
    public string Value { get; set; }
} 
```

然后编写一些代码以展平为您想要的形状。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-27T11:55:17.333

您可能必须自己使用 XPath 或其他东西解析 XML。地雷有点生锈，但它类似于：

```
var stat = xmlDocument.DocumentElement.GetSingleNode("stat[@type='first_name']");
var value = stat.InnerText; 
```

# android - 在 AsyncTask 中填充 ViewFlipper

> ID：11686744
> 
> 赞同：1
> 
> 时间：2012-07-27T11:21:08.627
> 
> 标签：android, android-asynctask, viewflipper

我正在尝试使用 AsyncTask 将图像加载到我的 FlipView 中，但我不确定如何继续。我需要使用 AsyncTask，因为应用程序是强制关闭的，因为我有 20 张图像要从可绘制对象中加载。

```
private class asyncImage extends AsyncTask<Void, Void, Void>{
        int i;
        @Override
        protected Void doInBackground(Void... params) {
            for (i=0;i<imageID.length;i++){
                image = new ImageView(getBaseContext());
                image.setId(i);
                image.setImageResource(imageID[i]);
                image.setBackgroundDrawable(getResources().getDrawable(R.drawable.border));
                image.setScaleType(ImageView.ScaleType.FIT_XY);
                FlipV.addView(image);
            }
            return null;
        }

    protected void onPostExecute(Void result){

        image.setBackgroundDrawable(getResources().getDrawable(R.drawable.border));
        image.setScaleType(ImageView.ScaleType.FIT_XY);
        for(int x=0;x<imageID.length;x++){
            FlipV.addView(???); //How to add images into FlipView?
        }
    }

} 
```

我坚持将图像添加到 FlipView。有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T23:51:01.663

正如我在评论中提到的那样，我已经通过使用 imageview 数组而不是在 doInBackground 中加载图像并在 postExecute 中的 viewflipper 中添加图像视图来解决我的问题。我还添加了一个进度对话框来显示加载时间，而不是在我的应用程序中显示空白屏幕。感谢所有回复的人。

```
private class asyncImage extends AsyncTask<Void, Void, Void>{
        int i;
        @Override
        protected Void doInBackground(Void... params) {
            for (i=0;i<imageID.length;i++){
                image[i] = new ImageView(getBaseContext());
                image[i].setImageResource(imageID[i]);
                image[i].setBackgroundDrawable(getResources().getDrawable(R.drawable.border));
                image[i].setScaleType(ImageView.ScaleType.FIT_XY);
            }
            return null;
        }

        protected void onPostExecute(Void result){
            for (int x=0;x<imageID.length;x++){
            FlipV.addView(image[x]);
            }
            count = 1;
            progDialog.dismiss();
            txItem.setText(Integer.toString(count) + "/" + (imageID.length));
        }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T11:36:10.490

您不能将指令添加到影响事件/UI 线程的 doInBackground 方法。相反，您应该使用 publishProgress() 方法来通知事件线程，并在 onProgressUpdate() 中将视图添加到翻转视图。

# java - 如何刷新Android列表适配器，使其显示新添加的项目

> ID：11686745
> 
> 赞同：11
> 
> 时间：2012-07-27T11:21:08.843
> 
> 标签：java, android, android-arrayadapter

我正在做一个项目。它只是显示任务列表并向其中添加新任务。我有 3 节课。一个用于添加，一个用于查看，一个用于保存所有信息（或者我认为）。

我的列表中已经有 2 个任务，并且它们显示正确。

问题是，当我**添加**一个新任务时，它不会在视图中显示它们。我尝试了许多可能的解决方案：

*   只需将项目添加到列表

*   创建一个新列表，其中包含旧列表中的项目并重建适配器；

*   `notifyDataSetChanged();`与 add() 命令一起使用；

*   等等

这是我的代码，有点乱，但我希望你能弄清楚。

**AndroidListAdapterActivity 类：**

```
public class AndroidListAdapterActivity extends ListActivity {
    /** Called when the activity is first created. */
    Button b1;
    Lista o;
    ArrayAdapter aa;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    b1=(Button)findViewById(R.id.add);
    Log.w("POC", "PA OVO SE ZOVE SVAKI PUT");
    o=new Lista();
    o.lis.add("S1");
    o.lis.add("S2");
   aa = new ArrayAdapter<String>(this, android.R.layout.simple_spinner_item, o.lis);
    setListAdapter(aa);

    b1.setOnClickListener(new View.OnClickListener() {

        @Override
        public void onClick(View v) {
            Intent i = new Intent(AndroidListAdapterActivity.this, Dodavanje.class);
            startActivity(i);
        }
    });

}

@Override
public void onResume(){
    super.onResume();
    aa.notifyDataSetChanged();
    if(o.broj>=2){
        aa=new ArrayAdapter<String>(this,android.R.layout.simple_spinner_item, o.lis2);
        setListAdapter(aa);
        Log.w("myApp", "CALLED TOO");
    }
    String yt=String.valueOf(o.ses);
    Log.w("teras", yt);
    aa.notifyDataSetChanged();

    Log.w("myApp", "CaLLED!!!!!!!!!!!!!");
    String fx= String.valueOf(o.broj);
    Log.w("myAPPe", fx);

}

@Override
protected void onPause() {
    // TODO Auto-generated method stub
    super.onPause();
}    
  } 
```

**Dodavanje（添加）：**

```
public class Dodavanje extends Activity {

Button but;
Button but2;
EditText et;
Lista o;
AndroidListAdapterActivity www;
@Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    setContentView(R.layout.dodavanje);
    but= (Button)findViewById(R.id.bb);
    but2= (Button)findViewById(R.id.bc);
    et=(EditText)findViewById(R.id.tt); 
    www=new AndroidListAdapterActivity();

    o = new Lista();

    but.setOnClickListener(new View.OnClickListener() {

        @SuppressWarnings("unchecked")
        @Override
        public void onClick(View arg0) {

            String t1= et.getText().toString();
            //o.lis.add(t1);    
            o.lis2.addAll(o.lis);
            o.lis2.add(t1);
            o.lis.add(t1);
            o.ses=true;
            Log.w("IZVJESTAJ: ", String.valueOf(o.ses));
            o.broj++;
            String fx=String.valueOf(o.broj);
            Log.w("Izbacaj",fx);
            et.setText("");
        }
    });

    but2.setOnClickListener(new View.OnClickListener() {

        @Override
        public void onClick(View arg0) {

            finish();
        }
    });
}
  } 
```

**列表（列表）：**

```
public class Lista extends Application {

ArrayList<String> lis=new ArrayList<String>();
ArrayList<String> lis2=new ArrayList<String>();
int broj =1;
boolean ses= false; 
 } 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-27T11:26:18.420

每次数据更改时都必须使用。

```
aa.notifyDataSetChanged(); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-27T11:27:02.800

您可以使用 notifyDataSetChanged() 方法来更新您的列表视图。在您的情况下，您可以使用。

```
aa.notifyDataSetChanged(); 
```

请尝试这种方式....

```
public class MainActivity extends Activity {

ListView lView;
Button btnAdd;  

private ListView mainListView ;  
private ArrayAdapter<String> listAdapter ;  

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);          

    mainListView = (ListView) findViewById( R.id.listView1 ); 
    btnAdd = (Button)findViewById(R.id.button1);

    // Create and populate a List of alphabet names.  
    String[] alphabets = new String[] { "A", "B", "C", "D",  
                                      "E", "F", "G", "H"};    
    ArrayList<String> alphabetsList= new ArrayList<String>();  
    alphabetsList.addAll( Arrays.asList(alphabets) );  

    // Create ArrayAdapter using the for the list.  
    listAdapter = new ArrayAdapter<String>(this, android.R.layout.simple_list_item_1, alphabetsList);  

    // Set the ArrayAdapter as the ListView's adapter.  
    mainListView.setAdapter( listAdapter );      
    btnAdd.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View arg0) {
            // TODO Auto-generated method stub

// Here I am adding more alphabets in the list on the listener of add button.
            listAdapter.add( "I" );  
            listAdapter.add( "J" );  
            listAdapter.add( "K" );  
            listAdapter.add( "L" );  
            listAdapter.add( "M" );  
        }
    });       
   }
 } 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-06-19T21:23:02.897

迄今为止提出的解决方案有效，但取决于您设备的 Android 版本。例如，要使用 AddAll 方法，您必须将 android:minSdkVersion="10" 放入您的 android 设备中。

为了解决所有设备的这个问题，我在适配器中创建了自己的方法，并在继承自 ArrayAdapter 的 add 和 remove 方法中使用，该方法可以毫无问题地更新您的数据。

我的代码：使用我自己的数据类 RaceResult，您使用自己的数据模型。

结果GpRowAdapter.java

```
public class ResultGpRowAdapter extends ArrayAdapter<RaceResult> {

    Context context;
    int resource;
    List<RaceResult> data=null;

        public ResultGpRowAdapter(Context context, int resource, List<RaceResult> objects)           {
        super(context, resource, objects);

        this.context = context;
        this.resource = resource;
        this.data = objects;
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {

        ........
        }

        //my own method to populate data           
        public void myAddAll(List<RaceResult> items) {

        for (RaceResult item:items){
            super.add(item);
        }
    } 
```

结果Gp.java

```
public class ResultsGp extends Activity {

@Override
protected void onCreate(Bundle savedInstanceState) {

    ...........
    ...........
    ListView list = (ListView)findViewById(R.id.resultsGpList); 

    ResultGpRowAdapter adapter = new ResultGpRowAdapter(this,  R.layout.activity_result_gp_row, new ArrayList<RaceResult>()); //Empty data

   list.setAdapter(adapter);

   .... 
   ....
   ....
   //LOAD a ArrayList<RaceResult> with data

   ArrayList<RaceResult> data = new ArrayList<RaceResult>();
   data.add(new RaceResult(....));
   data.add(new RaceResult(....));
   .......

   adapter.myAddAll(data); //Your list will be udpdated!!! 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-06-27T02:02:37.203

`extends BaseAdapter`类，覆盖`notifyDataSetChanged();`方法。
请看下面的截图代码：

```
 @Override
    public void notifyDataSetChanged() {
        super.notifyDataSetChanged();
        list.addAll();//--insert object to list
    } 
```

`notifyDataSetChanged();`在方法中调用方法`Activity onResume()`，如下所示：

```
@Override
protected void onResume() {
   super.onResume();
   ((BaseAdapter)getListAdapter()).notifyDataSetChanged();
} 
```

# jquery - Internet Explorer 阻止了 Jquery 并破坏了我的网站

> ID：11686746
> 
> 赞同：3
> 
> 时间：2012-07-27T11:21:13.023
> 
> 标签：jquery, html, internet-explorer

有没有办法阻止 Internet Explorer 在每次我的网站加载时抛出安全消息（黄色条）。

例如，我目前正在开发一个微型站点，它使用 Jquery 在页面加载时自动打开一个灯箱。这在 Chrome、Firefox 等中运行良好。但是，在 IE 中，黄色条跳起来并给出以下消息：

“为了帮助保护您的安全，您的网络浏览器已限制此文件显示可以访问您计算机的活动内容。单击此处查看选项”

显然，这意味着灯箱不会出现，直到用户单击“允许阻止的内容”。灯箱显示在其他任何东西之前是很重要的，所以我真的很想绕过安全消息。有没有办法对我的网站进行编码，以免发生这种情况？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-27T11:25:54.020

我很确定只有当您在本地调用页面时才会发生这种情况，例如您的地址栏中有 C:\index.html；尝试将您的代码上传到您的服务器，看看是否可以解决问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T11:26:21.323

在本地开发过程中是否会出现警告？在大多数情况下，一旦将其部署到服务器上，它就会正常工作，不会出错。

# php - Codeigniter 升级 1.7 到 2 问题

> ID：11686753
> 
> 赞同：1
> 
> 时间：2012-07-27T11:21:45.973
> 
> 标签：php, codeigniter, upgrade

我想将我的应用程序从 CI 1.7.2 迁移到 2x。
2x 和 1.7x 的文件夹结构完全不同。
我需要的是升级我的应用程序而不做任何更改......？

谢谢你们...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T11:23:11.107

需要对您的代码进行更改。

请遵循以下指南：[http ://codeigniter.com/user_guide/installation/upgrade_200.html](http://codeigniter.com/user_guide/installation/upgrade_200.html)

# c# - 如何阅读 Word 文档中的页面 (C#)

> ID：11686761
> 
> 赞同：1
> 
> 时间：2012-07-27T11:22:16.033
> 
> 标签：c#, ms-word, interop

我们使用 PDF-Focus。我们希望将横向格式的 PDF 文档导出为 Word 文档。我们想将此文档导出到 Word。我们在 Word 中获取文档。一切看起来都很好。如果我们想打印这个新的 word 文档，这个文档的边距是纵向的。

我试图通过创建一个空的 Word 文档然后插入一个临时导出的 Word 文档来解决这个问题。然后我将方向更改为横向。我看到这个解决方案有效。该文档现在是横向的。

但是现在带有图形和其他图像的页面与带有表格的页面重叠。

所以我想我必须通过读取单独的页面然后循环插入来将临时文档插入到新创建的文档中。

我们应该使用哪个功能以编程方式解决这个问题？或者也许有更好的解决方案？你能帮助我吗？

卫斯理

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T11:34:31.763

以下代码适用于我并打开一个更改其页面方向的 word 文档。你在找这样的东西吗？

```
using System;
using Microsoft.Office.Interop.Word;

namespace PageSetup
{
    class TestPageOrientation
    {
        static void Main(string[] args)
        {
            var app = new Microsoft.Office.Interop.Word.Application();
            app.Visible = true;

            //Load Document
            Document document = app.Documents.Open(@"C:\Temp\myDocument.docx");

            document.PageSetup.Orientation = WdOrientation.wdOrientLandscape;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T13:23:43.067

```
using System;
using Microsoft.Office.Interop.Word;

namespace PageSetup
{
    class TestPageOrientation
    {
        static void Main(string[] args)
        {
            var app = new Microsoft.Office.Interop.Word.Application();
            app.Visible = true;

            //Load Document
            Document document = app.Documents.Open(@"C:\Temp\myDocument.docx");

            // I've added this rows below. ...And that works
            document.Sections.First.PageSetup.Orientation = WdOrientation.wdOrientLandscape;
            document.Sections.Last.PageSetup.Orientation = WdOrientation.wdOrientLandscape;
            document.PageSetup.Orientation = WdOrientation.wdOrientLandscape;

            // ... and this. But the LeftMargin I can leave it.
            document.PageSetup.LeftMargin = 1.00F;
            document.Save();
        }
    }
} 
```

我不知道它在 Word 库源中是如何工作的。但是我已经尝试过 WdOrientation.wdOrientPortrait 并且有一次让我感到惊讶。我在横向格式中看到了这个页面。

我认为我的文档部分有问题，因为文档（有很多表格、图形和图像）太大了。这只是在使用这种方法之后。

所以我的下一个问题是：**如何缩小这个 Word 文档的大小**？

我该怎么做才能限制这个word文档**中格式设置的数量？**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-10T09:27:46.243

问题是 PDFFocus 将 PDF 转换为 RTF 格式。而且如果**更改设置，文档的大小会快速增长**。

所以我解决了这个问题，首先将其保存为带有**RTF-extension**的 RTF-document 。然后我将此文档另存为 Word97-document 并带有**DOC-extension**。

对于这两种转换，我都有相同的文档名称。两者都带有 DOC 扩展名。 **另存为 Word97 文档不起作用。我认为这是 Word 2007 的错误。**

# ruby-on-rails - ruby on rails observe_form 帮助，如何排除表单字段

> ID：11686767
> 
> 赞同：0
> 
> 时间：2012-07-27T11:22:44.227
> 
> 标签：ruby-on-rails

我创建了一个带有文本字段和一些复选框的搜索表单。我需要从 observe_form 中排除文本字段。

= observe_form 'material_search_form', :url => list_filter_search_url, :frequency => 1, :update => {:success => 'results'}

有没有办法做到这一点

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T09:48:56.727

在执行控制器操作之前使用 Javascript 返回 false

# iphone - NSNotificationCenter 不会运行选择器方法

> ID：11686771
> 
> 赞同：0
> 
> 时间：2012-07-27T11:22:51.773
> 
> 标签：iphone, objective-c, ios, nsnotificationcenter

嗨，我有一个奇怪的问题，

在我的**MainViewController**类中，我会在按下按钮时发布通知

`[[NSNotificationCenter defaultCenter] postNotificationName:@"step" object:nil];`

在我自己的课堂上，我有一个观察员

```
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(step) name:@"step" object:nil]; 
```

运行“step”方法

```
- (void)step {
    NSLog(@"works");
} 
```

在另一个名为**Slide1ViewController**的类中，我也有一个观察者

```
- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        NSLog(@"works 2");

        [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(step) name:@"step" object:nil];
    }
    return self;
} 
```

并且 dealloc 方法将其删除

```
- (void)dealloc {
    [[NSNotificationCenter defaultCenter] removeObserver:self name:@"step" object:nil];
} 
```

在 MainViewController 中，该方法被调用，但在 Slide1ViewController 中永远不会。

Slide1ViewController 像这样初始化：

```
Slide1ViewController*test = [[Slide1ViewController alloc] initWithNibName:@"Slide1ViewController" bundle:nil];
test.view.frame = CGRectMake(1024*0, 0, 1024, 768);
[contentScrollView addSubview:test.view]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T11:46:27.600

您必须在发布通知之前注册您的两个观察者，因此您必须在发布通知之前在内存中初始化 Slide1viewcontroller。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T11:50:26.867

非常感谢@Phillip Mills，你说得对，我需要将它声明为 MainViewController 的 @property 现在它可以工作了！！！非常感谢这个问题让我发疯。

# javascript - 将 Css 添加到具有特定类但存在多个类名的元素

> ID：11686772
> 
> 赞同：2
> 
> 时间：2012-07-27T11:22:51.573
> 
> 标签：javascript, jquery, html

我正在尝试将 css 添加到作为[fullcalender一部分的表中的“td”中](http://arshaw.com/fullcalendar/)

日单元格添加了 fc-day0 到 fc-day41
td 元素的类，如下所示：

```
<td class="fc-mon fc-widget-content fc-day1"> 
```

我试过以下：

```
$("td").filter("fc-day1")
       .css("background", "red");

$("td").find("fc-day1")
       .css("background", "red");

$("td").find($('td[class*=".fc-day1"]'))
       .css("background", "red"); 
```

感谢您的帮助 =)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T11:24:07.190

要`TD`以类为目标，`fc-day1`只需执行以下操作：

```
$("td.fc-day1").css("background", "red"); 
```

[小提琴](http://jsfiddle.net/XdgSD/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T11:26:47.060

如果您想过滤掉您的 td 集合并找到所有拥有 fc-day1 类的人，则使用带有 css 选择器的过滤器：

```
$("td").filter(".fc-day1")
    .css("background", "red"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-27T11:27:25.577

你不需要jquery。

在文件 css 中：

```
<style>
table td .fc-day1{
  background:red;
}
</style> 
```

问候

# oop - 函数式编程中难以实现的问题

> ID：11686775
> 
> 赞同：0
> 
> 时间：2012-07-27T11:23:05.130
> 
> 标签：oop, functional-programming

哪些使用 OOP 容易解决的问题，使用 FP 难以实现或无效？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T12:19:08.027

对象层次结构在 FP 中往往很尴尬。相反，您只需使用更简单的代数数据类型。

# c - DRY如何与“关注点分离”和“一个功能，一个任务”相结合？

> ID：11686776
> 
> 赞同：1
> 
> 时间：2012-07-27T11:23:06.893
> 
> 标签：c, refactoring, dry, code-cleanup

> **可能重复：**
> [一个函数/过程/方法应该有多少行代码？](https://stackoverflow.com/questions/611304/how-many-lines-of-code-should-a-function-procedure-method-have)

Out 团队有一个结构不完善的 ansi-c 代码项目。我想使用一些 CC 技术来整理代码库。

至于 C 代码，我们有很多指针和很多 NULL 指针陷阱要捕捉。因此，有很多看起来相似的片段。就像是

```
if (pointer == NULL)
{
  function1();
  function2();
} 
```

到处都是。然后有很多函数将以相同的方式相互调用，只有一些变化，比如

```
function1();
function2a();
function3(); 
```

和

```
function1();
function2b();
function3(); 
```

到处都是。

我想将这些块提取为单个函数以减少 LOC 和复制粘贴。但这不仅会创建一个（有点）正交层，还会创建一些功能或多或少相同，除了一些细节。更糟糕的是，它会创建同时做很多事情的函数。

那么，什么是好的策略呢？更重要的是，高层的精益代码、低层的精益功能还是精益架构？哪个原则胜过另一个？关注点分离还是 DRY？

我想重构那个野兽，但不知道从哪里开始。

为了解释下面的示例并输入相同的名称。假设我们有

```
morningBath();
drinkCoffee();
if (checkMail())
{
  answerMail();
} 
```

并将其放入morningRoutine() 中。现在我们有

```
drinkTea();
morningBath();
if (checkMail())
{
  answerMail();
} 
```

并称之为 sundayMorningRoutine()。但是有重复的代码。或将 morningRoutine(day) 展开为

```
if (day == sunday){
  drinkTea();
  morningBath();
} else {
  morningBath();
  drinkCoffee();
}    
if (checkMail())
{
  answerMail();
} 
```

或许

```
if (day == sunday){
  drink(Tea);
  morningBath();
} else {
  morningBath();
  drink(Coffee);
}    
if (checkMail())
{
  answerMail();
} 
```

我想知道这是不是很好的风格……也许……谢谢你的提示！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T12:28:08.907

关于 C 代码，经常遇到`NULL`指针检查是完全正常的，尤其是在涉及函数参数时。就个人而言，我更喜欢让调用者解决这种情况，例如：

```
if (p == NULL) {
    /* maybe do some cleanup and then: */
    return errcode;
} 
```

公共函数，即作为 API 一部分的函数，应始终检查`NULL`指针。指定的功能`static`可能会在 IMO 放弃这些检查。最后，总是有`assert()`。编译器标志可以抑制这些检查`-NDEBUG`。我使用`assert()`in`static`函数而不是`if`-statements 和“公共”函数进行测试，这些测试表明调用者实际上并不理解整个 API，例如在链表库中：

```
void list_print(list **l)
{
    assert(l != NULL);    /* no valid list passed by reference can ever be NULL */

    if (*l == NULL)       /* but it can be empty */
        return;

    /* print list */
} 
```

至于您的第二个问题，我可以看到三个选项：

1）让一切保持原样 - 毕竟，它正在工作。

2）引入新功能：

```
int function_1_2a_3();
int function_1_2b_3(); 
```

3) 引入新的参数化函数：

```
int function_1_2_3(int type); 
```

就个人而言，我更喜欢后一种方法，但这实际上只是风格问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T12:39:59.913

我非常同意 Philip 所说的，但我想补充一点，Clean Code 的要点之一是让代码读起来像英语。如果遇到常见的函数序列，又不能给这个序列起个好听的名字，那么最好还是留下它。例如，如果您有

```
vacuumTheCarpet();
dustTheFurniture();
putThingsInTherePlace(); 
```

你可以用

```
cleanTheHouse(); 
```

但如果你有

```
getTheMail();
eatSomeIceCream();
writeALetter(); 
```

您可能最好将它们作为单独的功能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-27T13:39:41.077

对于错误检查，宏可以使您的代码更清晰：

```
#define CheckNullLogClean(ptr) if(ptr == NULL) { \
    status = ERR_NULL_PTR; \
    LogError(status); \
    goto cleanup; }

int func(int *input) {
    status = 0;
    CheckNullLogClean(input);
    Do_Things();
    cleanup:
    Release_Resources();
    return status;
} 
```

我曾经使用的代码库做了类似的事情。并且每个函数都被设置为`status`在一个名为`cleanup`. 如果每个函数调用都检查了它的返回值，我们的日志文件将包含带有文件名和行号的堆栈跟踪（是一个使用和宏`LogError`调用函数的宏）。我们可以在整个项目中使用相同的错误检查宏。`__FILE__``__LINE__`

哦，如果您的函数用于类似的目的，那么您迭代的函数指针数组可能是有意义的。

# linux - 在 32 位操作系统上运行 64 位 jvm

> ID：11686780
> 
> 赞同：0
> 
> 时间：2012-07-27T11:23:22.323
> 
> 标签：linux, tomcat, jvm, amazon

我们可以将 64 位 JVM 与 Tomcat64 位一起用于 32 位操作系统吗？操作系统是 Amazon Linux 机器 32 位。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-27T11:28:09.980

不，您不能在 32 位操作系统上运行 64 位应用程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T11:36:57.427

你错过了更多的描述：如果系统/操作系统是 32 位的，而软件都是 64 位的，那么你不能。因此 i686（32 位）和 x86_64（64 位）架构之间的区别。您应该查看有关该 Tomcat 软件的文档。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-27T13:00:14.990

不，你不能那样做。但是，您可以在 64 位操作系统上运行 32 位 JVM。

# c# - C# 网格视图无法正常工作

> ID：11686789
> 
> 赞同：0
> 
> 时间：2012-07-27T11:23:41.450
> 
> 标签：c#, database, gridview

我最近开始学习`C#`，我坚持使用`gridview`and `database`。

我有 a`textbox`和 a `button`，它将文本框中的文本**添加**`gridview`到我的. 但它没有按我的意愿工作。

**问题：**

我的文本框中的文本未显示。当我第二次单击该按钮时，我收到以下***错误“无法添加已经存在的实体”。***

如果我单击我自己的数组，则会生成一个新行，但它只显示每个数组的数字，例如“-1、-2、-3”。如果我尝试将数字更改为文本，程序会失败很长时间。

这是我用过的；gridview - 将它与我的数据库 LINQ 链接到 SQL 类基于服务的数据库

这是我的代码。尽量保持简单。

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;

namespace database_test2
{
    public partial class Form1 : Form
    {
        Database1DataSet db = new Database1DataSet();
        DataClasses1DataContext dblink = new DataClasses1DataContext();
        Table1 tabel = new Table1();

        public Form1()
        {

            InitializeComponent();

        }

        private void textBox2_TextChanged(object sender, EventArgs e)
        {

        }

        private void button1_Click(object sender, EventArgs e)
        {
            tabel.Materiale = Convert.ToString(textBox1.Text);
            dblink.Table1s.InsertOnSubmit(tabel);
            dblink.SubmitChanges();

        }

        private void database1DataSetBindingSource_CurrentChanged(object sender, EventArgs e)
        {

        }

        private void Form1_Load(object sender, EventArgs e)
        {
            // TODO: This line of code loads data into the 'database1DataSet.Table1' table. You can move, or remove it, as needed.
            this.table1TableAdapter.Fill(this.database1DataSet.Table1);

        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T11:34:38.383

启动 asp.net webforms 时最常见的问题是忘记调用`DataBind()`方法，经过一些更改、编辑等。此方法初始化数据以查看控件以呈现它。

# sql - QC 11 中缺陷报告“主题”字段的递归检索

> ID：11686794
> 
> 赞同：0
> 
> 时间：2012-07-27T11:24:03.780
> 
> 标签：sql, recursion, hp-quality-center

在 HP Quality Center 11.0 上：

对于一组缺陷，我需要递归读取“主题”分支中的标签。我可以说服务器是应用程序。不是 Oracle 的，因为 sys_connect_by_path “作弊”不起作用。相反，我坚持使用递归 SQL，由于缺乏脑力，我无法完成。

原理是：从表bg_bug中，获取一个item，递归列出all_lists.al_description中的entry集合，直到NULL。

有点：

检索 BUG 表中的所有项目 获取其父项并打印 all_lists.al_description 的链接内容 检查父项是否有父项，如果有，则获取该父项并打印 all_lists.al_description 的链接内容，将其与检索到的字符串连接为它的孩子重复直到孤儿。

我在另一个线程中发现了这个：

with t1 (parent, child) as (select * from all_lists t where t.al_father_id = '2') select * from t1

无法执行，因为它包含“无效语句”。我从该线程收集到在 Quality Center 中使用 SQL 时不允许使用“with”语句。

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T19:50:34.367

您需要使用 select 语句包装语句，以便

```
select * from 
(
with t1 (parent, child) as (select * from all_lists t where t.al_father_id = '2') select * from t1
) 
```

# wix - 如何使用自定义操作执行python脚本 在安装文件之前的 wix

> ID：11686796
> 
> 赞同：1
> 
> 时间：2012-07-27T11:24:07.517
> 
> 标签：wix, custom-action

我正在使用 python 脚本在 wix 项目中执行自定义操作。

二进制 Id="python_script" SourceFile="myscript.py"

自定义操作为：

> CustomAction Id="CA_python_script" BinaryKey="python_script" Execute="immediate" Impersonate="yes" Return="check" ExeCommand=""[COMMANDPROMPT]" /c "C:\Python26\python.exe myscript.py""

我也尝试过：

> CustomAction Id="CA_python_script" BinaryKey="python_script" Execute="immediate" Impersonate="yes" Return="check" ExeCommand=""[COMMANDPROMPT]" /c "C:\Python26\python.exe python_script""

失败并出现错误：

> MSI (s) (40:14) [15:18:47:204]: 注意: 1: 1721 2: CA_python_script 3: C:\Windows\Installer\MSI33F9.tmp 4: "C:\Windows\system32\cmd .exe" /c "C:\Python26\python.exe myscript.py" 错误 1721。此 Windows 安装程序包有问题。无法运行完成此安装所需的程序。请联系您的支持人员或软件包供应商。操作：CA_python_script，位置：C:\Windows\Installer\MSI33F9.tmp，命令："C:\Windows\system32\cmd.exe" /c "C:\Python26\python.exe myscript.py" MSI (s) (40:14) [15:18:51:782]：产品：我的软件 -- 错误 1721。此 Windows 安装程序包有问题。无法运行完成此安装所需的程序。请联系您的支持人员或软件包供应商。行动：backup_Registry_Cmd，位置：C：
> 
> 操作于 15:18:51 结束：backup_Registry_Cmd。返回值 3。

这有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-14T23:38:17.967

我知道我在线程中是一个相当晚的人，但我遇到了它并想我会为其他任何人回答。

根本问题是你不能依赖用户：

1.  安装了 Python
2.  安装了正确的 Python 版本
3.  python的位置（如果已安装）
4.  安装了正确的包/库

您也只能从 python 运行可执行文件。您可以做的最简单的事情是将您的 python 脚本编译*成*EXE。

使用[py2exe](http://www.py2exe.org/)、[pyInstaller](http://www.pyinstaller.org/)或 best [cx_Freeze](http://cx-freeze.sourceforge.net/)等工具，您可以将 python 脚本“编译”成 .EXE 文件，您可以在 WiX 项目中包含并运行该文件。

这样做的好处是，这些工具将确保您的 python 脚本针对正确的 python 二进制文件执行，并将带来您需要的所有依赖项并将它们嵌入到 .EXE 文件中。

警告语：这些解决方案不是铁板钉钉的，它们非常通用，但您可能会遇到问题，因此这可能不适用于您的目的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T14:52:20.663

二进制表中的自定义操作可以是 DLL 或 EXE。不支持提取文件并将其传递给另一个 .exe。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-15T10:47:53.377

出现此类问题的一个原因是您的命令中有一个空格。WiX 对空间不太友好。

不要无耻地宣传我写的关于在使用 WiX 时处理脚本语言的确切主题的文章，但这里是：[http ://www.optimalbpm.se/wiki/index.php/Wix_and_scripting_languages](http://www.optimalbpm.se/wiki/index.php/Wix_and_scripting_languages)

关于其他答案中提到的其他问题，满足此处提到的其他要求；我还写了一篇关于如何将 exe 安装程序从 pythonlibs 转换为 .msi 的指南：[http ://www.optimalbpm.se/wiki/index.php/Python_packages_from_exe_to_WiX_to_msi](http://www.optimalbpm.se/wiki/index.php/Python_packages_from_exe_to_WiX_to_msi)

这样做的原因是安装其他可卸载的 python 包（有些需要 Visual Studio 在 pip 中编译）。例如，如果没有二进制安装，lxml 将无法工作。

# css - 当方向是从右到左时，IE9 会为包含 IMG 的 DIV 提供不需要的填充

> ID：11686797
> 
> 赞同：1
> 
> 时间：2012-07-27T11:24:14.473
> 
> 标签：css, internet-explorer-9, css-float, right-to-left

我有一个 150px 宽度和 1px 边框的 div 元素，在另一个包装 div 内。它包含一个宽度相同的 IMG 项目，150 像素。包裹div的方向是从右到左（方向是rtl时会出现问题）

问题：当我在 IE9 中打开我的页面时，图像容器 div 有一个不需要的填充，并且图像从 div 的右侧掉出，超出了 div 的边界。取决于垂直滚动条的存在与否，问题会出现和出现。

```
<html>
    <head>
        <style>
            .wrap {
                width: 300px;
            margin: 0 auto;
                direction: rtl;
                padding: 0;
            }
            .img-container {
                width: 150px;
                height: 150px;
                border: 1px solid black;
                padding:0;
                margin:0;
                background: red; /*background to show the problem better*/
            }
            img {
                display: inline-block;
            }
        </style>
    </head>
    <div class="wrap">
        <div class="img-container";>
            <img  src="my-image.jpg" width="150px"/>
        </div>
    </div>
</html> 
```

这是问题的屏幕截图：

![IE9 中不需要的填充](../Images/6ac764d118f4bcc27c9ec53cc87b4299.png)

这是一个已知的错误？我该如何处理？

# javascript - PowerPoint文件结构

> ID：11686798
> 
> 赞同：6
> 
> 时间：2012-07-27T11:24:17.843
> 
> 标签：javascript, parsing, powerpoint

我正在尝试为 .ppt 文件构建一个 JavaScript 解析器。PPTX 没什么大不了的，因为它是一种“开放”格式，但我真的迷失了 .ppt 文件的文件结构，找不到任何有用的信息。

鉴于此，有没有人试过这个，或者至少可以指出我可以在哪里看到 .ppt 的“规范”，以便我可以构建解析器？

最好的问候， 塞尔索桑托斯

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-27T11:45:12.803

.ppt 是一种二进制文件格式。您可以在[此处阅读 1997-2007 规范](http://msdn.microsoft.com/en-us/library/office/cc313106%28v=office.12%29.aspx)

不要阻止您尝试，但您应该注意，对于 1 个开发人员来说，这可能最终成为一项艰巨/几乎不可能完成的任务，因为整个规范代表了 10 年内数千个编程小时。

Joel Spolsky 有一篇关于处理这些文件格式的[好文章。](http://www.joelonsoftware.com/items/2008/02/19.html)

为了完整起见，[这里是 pptx 文件格式的规范](http://download.microsoft.com/download/D/3/3/D334A189-E51B-47FF-B0E8-C0479AFB0E3C/%5BMS-PPTX%5D.pdf)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-11-01T23:16:35.610

你的梦想得到了回应……

有人构建了一个纯 JavaScript PPT 二进制文件解析器。[在 Git https://github.com/SheetJS/js-ppt](https://github.com/SheetJS/js-ppt)上查看

# ruby-on-rails - RubyGems 未更新或安装最新版本的 Rails 3.2.7

> ID：11686800
> 
> 赞同：5
> 
> 时间：2012-07-27T11:24:31.273
> 
> 标签：ruby-on-rails, rubygems, gem, ruby-on-rails-3.2

我尝试运行以下命令将我的 Rails 版本从 3.2.6 版更新到 3.2.7 版，但没有成功。

```
gem update rails
Updating installed gems
Nothing to update 
```

-

```
gem install rails
# Output
# 1 gem installed
# Installing ri documentation for rails-3.2.6...
# Installing RDoc documentation for rails-3.2.6... 
```

-

```
gem install rails -v 3.2.7
ERROR:  Could not find a valid gem 'rails' (= 3.2.7) in any repository
ERROR:  Possible alternatives: rails 
```

-

我已经尝试清除我的 Rubygem 缓存，我的源列表如下

```
*** CURRENT SOURCES ***

http://rubygems.org/
http://gems.github.com/ 
```

任何帮助深表感谢。

谢谢，WD

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-01T05:08:53.360

我现在已经解决了这个问题。

因为我已经拥有了最新版本的 Rubygems，所以我无法弄清楚为什么安装会获得以前版本的 Rails (3.2.6)。下面是我最终安装 Rails 3.2.7 的方法。

```
# Remove all sources (clear the cache    
gem sources -c

# Remove sources
gem sources -r http://rubygems.org/
gem sources -rhttp://gems.github.com/

# Add source
gem sources -a http://rubygems.org/

# Note: I changed the uri from HTTP to HTTPS

# Update source cache
gem sources -u 
```

现在，我安装了 Rails 3.2.7。

# php - 在 page.tpl.php 中渲染一个表单

> ID：11686801
> 
> 赞同：1
> 
> 时间：2012-07-27T11:24:33.243
> 
> 标签：php, drupal, drupal-7, drupal-fapi, drupal-forms

在我的 template.php 中，我创建了一个表单，然后在`hook_preprocess_page`函数中将它分配给一个变量，但是如何将它呈现出来`page.tpl.php`

```
$variables['myform'] = drupal_get_form('test_myform'); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-27T13:05:41.117

您可以尝试在您的`page.tpl.php`

```
print drupal_render($myform); 
```

希望这行得通……穆罕默德。

# php - 将数据库中的信息作为链接回显

> ID：11686805
> 
> 赞同：0
> 
> 时间：2012-07-27T11:25:13.787
> 
> 标签：php, mysql

是否可以将数据库中的信息作为链接回显，我尝试了下面的代码，但出现解析错误。有没有其他方法可以做到这一点。谢谢

```
<?php
session_start();
if(isset($_SESSION['email'])){

    $connect = mysql_connect("localhost","root","") or die("Couldn't connect!");
    mysql_select_db("test") or die("Couldn't find database");
    $email=$_SESSION['email'];
    $sql = mysql_query("SELECT *  FROM users WHERE email='$email'");
    $info = mysql_fetch_assoc($sql);

echo"<a href='home.php'> $info['firstname']</a>"
   }

      ?> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-27T11:26:09.523

缺少分号

```
echo "<a href='home.php'>". $info['firstname']."</a>"; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-27T11:27:47.323

```
echo "<a href='home.php'> {$info['firstname']}</a>"; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-27T11:44:35.007

$info = mysql_fetch_assoc($sql);

$fname = $info['firstname'];

?>

<a href='home.php'> < ?php echo $fname; ?> </a>

我发现这个更好很多免费的技巧

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-27T11:26:11.417

您缺少此行中的分号：

```
echo"<a href='home.php'> {$info['firstname']}</a>"; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-27T11:28:53.613

很确定该行应该是：

```
echo"<a href='home.php'> $info[firstname]</a>"; 
```

注意周围没有引号`firstname`。

# django - Django：如何过滤掉子元素

> ID：11686812
> 
> 赞同：0
> 
> 时间：2012-07-27T11:25:35.410
> 
> 标签：django, django-queryset

这是我的模型：

```
class Blog(models.Model):
    name = models.CharField(max_length=100)
    tagline = models.TextField()

    def __unicode__(self):
        return self.name

class Entry(models.Model):
    blog = models.ForeignKey(Blog)
    headline = models.CharField(max_length=255)
    body_text = models.TextField()
    published = models.BooleanField()

    def __unicode__(self):
        return self.headline 
```

有一个外部函数，我无权访问它基本上执行以下操作：

```
def printBlogs(blogs):
    for blog in blogs:
        print blog.name
        for entry in blog.entry_set.all():
            print " *",entry.headline,":", entry.published 
```

以下代码

```
from weblogs.models import Blog, Entry
r = Blog.objects.all()
printBlogs(r) 
```

生产

```
 Blog1
  * Article 1 : True
  * Article 2 : True
  * Article 3 : False
 Blog2
  * Article 1 : True
  * Article 2 : False
  * Article 3 : False 
```

获得以下结果的正确代码是什么（请记住，我无权访问 printBlogs）

```
 Blog1
  * Article 1 : True
  * Article 2 : True
 Blog2
  * Article 1 : True 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T14:37:27.533

最简单有效的方法是先过滤：

```
blog.entry_set.filter(published=True) 
```

或者，您可以简单地使用 if 语句：

```
if entry.published:
    print entry 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-01T04:52:00.127

改变`Blog.objects.all()`_`Blog.objects.filter(entry__published=True)`

这应该够了吧！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-27T12:08:48.930

`aobjs = [b.a for b in B.objects.exclude(state='Z')]`

或者

`aobj.b_set.exclude(state='Z')`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-27T11:30:01.640

```
for o in queryset:
    if not results.has_key(o.name):
       results[o.name] = list()
    if not (...check if Z):
       results[o.name].append(o)

for a in results:
    print a
    for b in results[a]:
        print b.state 
```

假设您有模型：

```
class Blog(models.Model):
    name = models.CharField(max_length=100)
    tagline = models.TextField()

    def __unicode__(self):
        return self.name

class Author(models.Model):
    name = models.CharField(max_length=50)
    email = models.EmailField()

    def __unicode__(self):
        return self.name

class Entry(models.Model):
    blog = models.ForeignKey(Blog)
    headline = models.CharField(max_length=255)
    body_text = models.TextField()
    pub_date = models.DateTimeField()
    mod_date = models.DateTimeField()
    authors = models.ManyToManyField(Author)
    n_comments = models.IntegerField()
    n_pingbacks = models.IntegerField()
    rating = models.IntegerField()

    def __unicode__(self):
        return self.headline 
```

并且您想排除所有名称为“test”的博客

您将运行代码：

Entry.objects.exclude( **blog** __name='test')

它会写查询：

```
SELECT ... FROM `entry` INNER JOIN `blog` ON (`entry`.`blog_id` = `blog`.`id`) WHERE NOT (`blog`.`name` = test ) 
```

# drop-down-menu - 下拉列表用户控件

> ID：11686813
> 
> 赞同：0
> 
> 时间：2012-07-27T11:25:46.970
> 
> 标签：drop-down-menu, user-controls

如何在 C# 中更改下拉列表选择的索引。我在用户控件中绑定下拉列表。

选定的值应将表单页面更改为页面。

我正在这样做但返回 -1

在 aspx 页面中，我发现 contorl tryint 更改已选择索引

DropDownList ddl = (DropDownList)ucSearchControl1.FindControl("ddlSearchType");

ddl.SelectedIndex = 2;

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T11:35:58.960

您可以将 selectedindex_changed 事件用于下拉列表。所以无论你选择什么项目，它都会触发这个事件，它会给你选择项目的索引。

# c++ - std::copy 的自定义插入器

> ID：11686815
> 
> 赞同：10
> 
> 时间：2012-07-27T11:25:51.663
> 
> 标签：c++, std

给定一个`std::vector`包含 MyClass 对象的 a。如何使用创建另一个仅包含 MyClass 一个成员的数据的向量`std::copy`？我想我必须实现一个自定义`back_inserter`，但到目前为止我无法弄清楚如何做到这一点。

```
struct MyClass {
   int a;
}

std::vector<MyClass> vec1;

// I could copy that to another vector of type MyClass using std::copy.
std::copy(vec1.begin(), vec1.end(); std::back_inserter(someOtherVec)

// However I want just the data of the member a, how can I do that using std::copy?
std::vector<int> vec2; 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-07-27T11:36:39.280

[为此使用`std::transform`](http://en.cppreference.com/w/cpp/algorithm/transform)。

```
std::transform(vec1.begin(), vec1.end(), std::back_inserter(vec2),
               [](const MyClass& cls) { return cls.a; }); 
```

（如果你不能使用 C++11，你可以自己创建一个函数对象：

```
struct AGetter { int operator()(const MyClass& cls) const { return cls.a; } };

std::transform(vec1.begin(), vec1.end(), std::back_inserter(vec2), AGetter()); 
```

或者`std::tr1::bind`如果您可以使用 TR1，请使用：

```
std::transform(vec1.begin(), vec1.end(), std::back_inserter(vec2),
               std::tr1::bind(&MyClass::a, std::tr1::placeholders::_1)); 
```

* * *

顺便说一句，正如@Nawaz 在下面评论的那样，`.reserve()`在复制过程中防止不必要的重新分配。

```
vec2.reserve(vec1.size());
std::transform(...); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-27T11:39:31.597

您想使用`std::transform`not`std::copy`并`std::bind`绑定到指向成员变量的指针：

```
#include <algorithm>
#include <iterator>
#include <vector>
#include <iostream>
#include <functional>

struct foo {
  int a;
};

int main() {
  const std::vector<foo> f = {{0},{1},{2}};
  std::vector<int> out;

  out.reserve(f.size());
  std::transform(f.begin(), f.end(), std::back_inserter(out), 
                 std::bind(&foo::a, std::placeholders::_1));

  // Print to prove it worked:
  std::copy(out.begin(), out.end(), std::ostream_iterator<int>(std::cout, "\n"));
} 
```

我的示例是 C++11，但是如果您跳过方便的向量初始化并改用`boost::bind`它，那么在没有 C++11 的情况下也可以正常工作。

# jquery - JQUERY UI - TABS & COOKIES - 如何让 cookie 保留新添加的选项卡

> ID：11686827
> 
> 赞同：0
> 
> 时间：2012-07-27T11:26:34.600
> 
> 标签：jquery, ajax, cookies, jquery-ui-tabs, jquery-tabs

我有一个带有手风琴和标签的 JSP。

在手风琴上选择的选项，启动创建并启动一个新选项卡 - 它也将 IFRAME 加载到选项卡中。这工作正常。我有一个始终显示的静态选项卡。我有 jquery cookie js 脚本。我在 jquery ui 网站上看到，cookie 代码适用于静态选项卡。但我需要它来为我新创建的标签工作。

当我的选项创建并启动一个新选项卡时，如果我刷新页面，它将被删除。我希望保留它，除非使用关闭该选项卡。

请帮忙！:)

这是我的 JS 代码。

```
$(function() {

    // Tabs
    $('#tabs').tabs();

    $( "#accordion" )
    .accordion({
        collapsible: true,
        header: "> div > h3"
    })
    .sortable({
        axis: "y",
        handle: "h3",
        stop: function( event, ui ) {
            // IE doesn't register the blur when sorting
            // so trigger focusout handlers to remove .ui-state-focus
            ui.item.children( "h3" ).triggerHandler( "focusout" );
        }
    });     

    // actual addTab function: adds new tab using the title input from the form above
    function addTab(href, page, id, p_id, ul_value) {

        var tab_title = "title: <b>" + ul_value + "</b> | " + p_id;
        var tab_title = tab_title || "Tab " + tab_counter;
        $tabs.tabs( "add", "#tabs-" + tab_counter, tab_title );
        tab_counter++;
        $('#'+id).html(page);
    }

    // Add a new iframe tab
    $('a.treeLink').click(function(e) { 
        e.preventDefault(); 
        var href = $(this).attr('href'); 
        var page = '<iframe src="'+href+'" width="100%" height="100%"></iframe>'; 
        var id = $(this).closest("div").attr("id"); 
        var ui_id = $(this).closest("ul").attr("id"); 
        var li_id = $(this).closest("li").attr("id");
        var ul_value = $(this).closest("ul").attr("value");
        addTab(href, page, ui_id, li_id, ul_value);  
    });     

    var $tab_title_input = $( "#tab_title"),
    $tab_content_input = $( "#tab_content" );
    tab_counter = 2;
    href = "http://localhost:8080/processRequest";

    // tabs init with a custom tab template and an "add" callback filling in the content
    var $tabs = $( "#tabs").tabs({
        cookie: {
            // store cookie for a day, without, it would be a session cookie
            expires: 1
        },
        tabTemplate: "<li><a href='#{href}'>#{label}</a> <span class='ui-icon ui-icon-close'>Remove Tab</span></li>",
        add: function( event, ui ) {
            var tab_content = "Content" || "Tab " + tab_counter + " content.";
            href = href;
            $tabs.tabs('select', '#' + ui.panel.id);
            $( ui.panel ).append( '<iframe frameborder="0" style="border:0px" src="'+href+'" width="100%" height="100%"></iframe>');
        }
    });

    // close icon: removing the tab on click
    // note: closable tabs gonna be an option in the future - see http://dev.jqueryui.com/ticket/3924
    $( "#tabs span.ui-icon-close" ).live( "click", function() {
        var index = $( "li", $tabs ).index( $( this ).parent() );
        if(index != 0){
            $tabs.tabs( "remove", index );
        }
    });
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T12:11:23.567

我解决了这个问题。

我执行了以下操作来做到这一点。我在上面的代码中将 cookie 设置在错误的位置。

我还添加了我需要的其他功能。

它必须是：

```
 // Tabs
    $('#tabs').tabs({
        cookie: {
            // store cookie for a day, without, it would be a session cookie
            expires: 1
        },
        collapsible: true
    }).find( ".ui-tabs-nav" ).sortable({ axis: "x" }); 
```

# c# - 如何在 8*8 DataMatrix 中编码超过 3 个字符？

> ID：11686832
> 
> 赞同：1
> 
> 时间：2012-07-27T11:26:58.310
> 
> 标签：c#, c, vb.net, encoding

我正在从事 Datamatrix 编码项目。我们遵循数据矩阵编码的 ISO200 标准，但使用 8*8 数据矩阵，我们只能对 3 个字母或 6 个数值进行编码。有什么方法可以在 8*8 Datamatrix 中编码更多数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-19T14:21:38.390

谷歌建议你指的是 ECC200，然后搜索显示更多点击。正如我所料，该标准包括额外的“冗余”信息位，以允许“在符号遭受 30% 损坏时重建整个编码数据字符串，假设矩阵仍然可以准确定位。数据矩阵的错误率低于扫描的 1000 万个字符中超过 1 个。” （引自[维基百科](http://en.wikipedia.org/wiki/Data_Matrix#Data_Matrix_ECC_200)）

如果您减少错误捕获的数量，您最多可以存储 256 个 ANSI 字符中的 8 个、128 个 ASCII 字符中的 9 个或 >16 位，如果您允许压缩则更好，但没有冗余以允许纠错。

尽管如此，您可能只是想找到另一个标准，将更多数据和更少的纠错放入 Datamatrix。

# ssh - 如何打开 TTY 以与 git-push 挂钩进行交互？

> ID：11686833
> 
> 赞同：5
> 
> 时间：2012-07-27T11:27:00.583
> 
> 标签：ssh, githooks, git-push, post-commit

我正在使用 git-deploy Ruby gem 将应用程序交付到登台服务器。使用 SSH 密钥执行部署。

在我的`after_push`脚本中，我想运行一个带有 的命令`sudo`，该命令随后会询问我的密码，因为 sudo 权限是有限的（没有密码就无法运行 sudo）。

实际上我的 sudo 命令失败了：

```
sudo: no tty present and no askpass program specified 
```

我尝试添加一个 askpass 程序并根据 git 手册指定它。

如何在脚本`git-push`中为交互式命令打开 TTY？`after_push`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T12:35:59.633

到目前为止，我所寻求的似乎是不可能的。没有可用的 tty，是我从阅读 Query 中收集到的关于在 git中[设置预接收钩子的](https://stackoverflow.com/questions/10385089/query-on-setting-up-a-pre-receive-hook-in-git)[内容吗？是否可以接受用户输入作为远程 git 后接收钩子的一部分？](https://stackoverflow.com/questions/7809547/is-it-possible-to-accept-user-input-as-part-of-a-remote-git-post-receive-hook)

关于如何在接收后执行受密码保护的 sudo 操作有什么更好的建议吗？

**更新**：在[如何从 commit-msg 挂钩中提示用户？](https://stackoverflow.com/questions/3417896/how-do-i-prompt-the-user-from-within-a-commit-msg-hook/3533735#3533735)

不可能做到我在这里尝试实现的目标。

# facebook - 使用 cron 阅读 Facebook 页面墙

> ID：11686836
> 
> 赞同：0
> 
> 时间：2012-07-27T11:27:10.727
> 
> 标签：facebook, facebook-graph-api

我试图将 facebook 页面墙集成到我的网站应用程序中。当用户使用他的 facebook 帐户登录并访问我的应用程序中的页面墙时，我这样做没有问题。我想要做的是使使用 cron 作业检索这些帖子成为可能，并在新帖子通过邮件发布时通知用户。当我尝试这样做时，我收到访问令牌错误。我对offline_access 权限有疑问，但它已被弃用，我找不到新的解决方案是什么。有可能吗？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T16:26:18.383

而不是`offline_access`，您需要获得一个长期存在的访问令牌。[Facebook 开发者网站](https://developers.facebook.com/roadmap/offline-access-removal/)上描述了流程和场景。请注意，您只能在有限的时间内阅读用户的墙，然后您必须要求用户再次登录。您还需要获得`read_stream`许可。

# symfony - 在 symfony2 运行时为服务设置方法调用

> ID：11686839
> 
> 赞同：0
> 
> 时间：2012-07-27T11:27:18.233
> 
> 标签：symfony

是否可以在运行时对 Symfony2 中的服务设置方法调用？

我想在运行时设置这样的东西：

```
calls:
            - [ setEventDispatcher, [ @event_dispatcher ] ] 
```

场景将是：
onKernel 事件上有一个侦听器，它将检查请求中是否设置了参数，然后将方法调用添加到容器中的服务。
所以延迟加载会被保留，我猜。

我看到构建器中有一个方法*setMethodCalls()*，所以也许我可以使用它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T14:35:19.330

我认为在您的捆绑包中，您应该从`Symfony\Component\DependencyInjection\Loader\YamlFileLoader`那里扩展并重写方法[`parseDefinition()`](https://github.com/symfony/symfony/blob/master/src/Symfony/Component/DependencyInjection/Loader/YamlFileLoader.php#L194)以获取不仅`calls`部分，而且还包含您想要使用的某些条件的自定义部分。

最后，您将拥有如下服务配置：

```
calls:
    always:
        - [ setEventDispatcher, [ @event_dispatcher ] ]
    on_condition:
        variable: "value" 
```

希望能帮助到你...

# html - 如何在没有表格的情况下在一行中显示浮动元素

> ID：11686840
> 
> 赞同：0
> 
> 时间：2012-07-27T11:27:18.450
> 
> 标签：html, css

我想在一行中显示浮动元素而不使用表格。当用户调整窗口大小时，元素会改变线，但我不想要。

我使用的 HTML 代码是：

```
<ul class='regul'>
<li>First name:</li>
<li>Last name:</li>
<li>Email:</li>
<li>Confirm email:</li>
<li>Password:</li>
<li>Confirm password:</li>
<li>Sex:</li>
<li>Date of birth:</li>
<li><input class='button' type='submit' name='action' value='Register' /></li>
</ul>
<ul class='regul'>
<li><input type='text' name='fname' id='fname' /></li>
<li><input type='text' name='lname' id='lname' /></li>
<li><input type='text' name='email' /></li>
<li><input type='text' name='cemail' /></li>
<li><input type='password' name='pass' /></li>
<li><input type='password' name='cpass' /></li>
<li><select name='sex'><option value='male'>Male</option><option value='female'>Female</option></select></li>
<li>
<input type='text' name='day' size='2' maxlength='2' />
<input type='text' name='month' size='2' maxlength='2' />
<input type='text' name='year' size='4' maxlength='4' />
</li>
</ul> 
```

我的网站是[http://greek.netii.net/](http://greek.netii.net/)。

我应该使用哪个 CSS 代码？

感谢您的时间！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T11:30:32.770

使用`float:left`, 然后将 a 添加`style='clear:both'`到某个元素

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T11:37:01.083

用这个，

```
<style>
.regul{
float:left;
list-style:none;
}
.regul li{
height:25px;
width:150px;
}
</style>
<div style="width:500px;clear:both;">
<ul class='regul'>
<li>First name:</li>
<li>Last name:</li>
<li>Email:</li>
<li>Confirm email:</li>
<li>Password:</li>
<li>Confirm password:</li>
<li>Sex:</li>
<li>Date of birth:</li>
<li><input class='button' type='submit' name='action' value='Register' /></li>
</ul>
<ul class='regul'>
<li><input type='text' name='fname' id='fname' /></li>
<li><input type='text' name='lname' id='lname' /></li>
<li><input type='text' name='email' /></li>
<li><input type='text' name='cemail' /></li>
<li><input type='password' name='pass' /></li>
<li><input type='password' name='cpass' /></li>
<li><select name='sex'><option value='male'>Male</option><option value='female'>Female</option></select></li>
<li>
<input type='text' name='day' size='2' maxlength='2' />
<input type='text' name='month' size='2' maxlength='2' />
<input type='text' name='year' size='4' maxlength='4' />
</li>
</ul>
</div> 
```

# binary - 码头（WebSocket）二进制帧聚合已禁用

> ID：11686841
> 
> 赞同：1
> 
> 时间：2012-07-27T11:27:20.697
> 
> 标签：binary, websocket, jetty, frame

我试图使用 Jetty WebSocket 进行二进制上传。我已经有一些客户端和服务器代码。如果我发送小的二进制大小，它工作正常，但如果我尝试发送一个长二进制 Jetty 发送错误消息：

> “禁用二进制帧聚合”
> 
> 警告：oejw.WebSocketConnectionRFC6455：帧被丢弃。SCEP@fdbc27{l(/0:0:0:0:0:0:0:1:51199)<->r(/0:0:0:0:0:0:0:1) 禁用二进制聚合:8081),d=true,open=true,ishut=false,oshut=false,rb=false,wb=false,w=true,i=1r}-{WebSocketServletConnectionRFC6455 p=WebSocketParserRFC6455@1264bf5 state=数据缓冲区= g =WebSocketGeneratorRFC6455@144d0c6 关闭=假缓冲区=-1}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T14:08:39.300

我有完全相同的问题。我所做的是`MaxBinaryMessageSize`使用类似`this.connection.setMaxBinaryMessageSize(163840000)`...默认值是 16384 来更改连接的属性。

所以我得出的结论是我拥有的二进制消息超过了 WebSocket 中定义的最大大小。因此，一种选择是修改 MaxBinaryMessageSize，另一种是使用实现`WebSocket.OnFrame`接口将消息拆分为多个帧。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T06:13:34.990

我通过实现`WebSocket.OnFrame`接口解决了这个问题。我希望这有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-03T09:34:36.610

实施`WebSocket.OnFrame`似乎也帮助了我。这很容易。在你的`onHandshake()`你只记得你的`connection`（或者你可以做到`onOpen()`）。您使用`WebSocket.FrameConnection`in`onFrame()`来处理您收到的数据。就这样 ：） 。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-04-07T04:40:56.457

将更大`bufferSize`的参数放入 init-params`WebSocketServlet`为我解决了这个问题。

# jsp - 在 Jsp 上显示所有带有名称和大小的图像

> ID：11686843
> 
> 赞同：0
> 
> 时间：2012-07-27T11:27:25.560
> 
> 标签：jsp, servlets, struts2

要求：我想在 jsp 页面上显示图像（图像名称，图像大小，图像）的详细信息。图像以对象类型 blob 存储在数据库中。数据库表的列是 imageName(varchar2),imageSize(number),image(blob)。Jsp“显示图像”中有一个按钮。单击此按钮时，我必须以表格格式显示数据库表中的所有图像，其中包含图像名称和图像大小。摘要：单击显示图像时，我必须显示所有具有图像名称的图像，这些图像存储在 db.xml 中。

技术：struts2,jsp,jdbc

我做了什么：我可以在 jsp 上看到图像，但无法显示图像名称和大小

BlobRetrieval.jsp

```
<%@page import="java.sql.Blob"%>
<%@page import="java.io.OutputStream"%>
<%@page import="java.sql.SQLException"%>
<%@page contentType="text/html" pageEncoding="UTF-8"%>
<%@ taglib prefix="s" uri="/struts-tags" %>
<!DOCTYPE html>
<html>
 <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>Esp Page</title>
    <script type="text/javascript">
        function showImage()
        {
            document.imgFrm.action="step1Image";
            document.imgFrm.submit();
        }
    </script>
</head>
<body>       
    <s:form name="imgFrm">
        <input type="button" name="b" value="ShowImage" onclick="showImage()"/>
    <% System.out.println("[BlobRetrieval.jsp] session value "+session.getAttribute("imageRetrieved")+" if null then dont show images");%>
        <%
        if(session.getAttribute("imageRetrieved")!=null)
         {
       %>
       <br></br>
       <table id="myDiv" name="myDiv" style="color: #0900C4; font: Helvetica 12pt;border: 1px solid black; height: auto;">
           <tr>
               <td>Image name</td>
               <td> <img src="DisplayBlob.jsp"> </img></td>
           </tr>
       </table>
        <%
        }
   else
   {
System.out.println("[BlobRetrieval.jsp]Session value is null");
   }
 %> 
     </s:form>
</body>
</html> 
```

DisplayBlob.jsp

```
<%@ page import="java.sql.*"%>

<%@ page import="java.io.*"%>

<% Blob image = null;

java.sql.Connection con = null;

byte[ ] imgData = null ;

java.sql.Statement stmt = null;

java.sql.ResultSet rs = null;

try {

  con = java.sql.DriverManager.getConnection("jdbc:oracle:thin:@ip:port:sid","schemaName", "password");

stmt = con.createStatement();

rs = stmt.executeQuery("SELECT fileobj,fileName,fileSize FROM DISPLAYBLOB");

if (rs.next()) {

image = rs.getBlob(1);

imgData = image.getBytes(1,(int)image.length());

} else {

out.println("Display Blob Example");

out.println("image not found for given id>");

return;

}

// display the image

response.setContentType("image/gif");

OutputStream o = response.getOutputStream();

o.write(imgData);

o.flush();

o.close();
} catch (Exception e) {

out.println("Unable To Display image");

out.println("Image Display Error=" + e.getMessage());

return;

} finally {

try {

rs.close();

stmt.close();

con.close();

} catch (SQLException e) {

e.printStackTrace();

}

}

%> 
```

struts.xml

```
<?xml version="1.0" encoding="UTF-8"?>
 <!DOCTYPE struts PUBLIC
"-//Apache Software Foundation//DTD Struts Configuration 2.0//EN"
"http://struts.apache.org/dtds/struts-2.0.dtd">
 <struts>
<constant name="struts.devMode" value="true" />
<package name="struts2" extends="struts-default" namespace="/">
    <action name="*Image" class="example.DisplayBlob" method="{1}">
        <result name="input">BlobRetrieval.jsp</result>
    </action>
</package>
<constant name="struts.action.excludePattern" value="/*.servlet"/>
 </struts> 
```

DisplayBlob.java

```
package example;
import com.opensymphony.xwork2.ActionContext;
import com.opensymphony.xwork2.ActionSupport;
import java.util.Map;
public class DisplayBlob extends ActionSupport {
public String step() throws Exception
{
    Map session = (Map)ActionContext.getContext().getSession();
    session.clear();
    System.out.print("[DisplayBlob] step ");
    return "input";
}
 public String step1() throws Exception
{
    Map session = (Map)ActionContext.getContext().getSession();
    System.out.print("[DisplayBlob] step1 ");
    session.put("imageRetrieved", "imageRetrieved");
    return "input";
}
} 
```

首先，我正在访问 url ip:port/contextRoot/stepImage 在访问此 url 时，我正在调用“DisplayBlob.java”的步骤，它将控制转发到 BlobRetrieval.jsp，然后单击“显示图像”按钮，我正在调用步骤 1 的函数'Displayblob.java' 再次将控制权转发给'BlobRetrieval.jsp'。由于此时在会话中设置了“imageRetrieved”值，因此控制在 if 循环中进行。在 if 循环中，我使用图像 src 标签显示图像，但无法显示其他字段“图像名称”和“图像大小”。如果数据库中存储了多个图像怎么办？那么我的代码应该是什么样子呢？我无法想象 imagename 应该如何来自 db？没有任何事件（用户干预），我将如何显示所有带有图像的 imageNames。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T11:46:32.700

我想在这里提到的几件事是，尽管您编写工作的方式将解决您的问题，但将来代码更改是维护将真的是一场噩梦。

关于您的问题，我建议您创建一个具有您需要在 UI 中显示的属性的 DTO/bean

```
public class ImageBean{
 private String imageName;
 private int imageSize
  // any other field you want to
  //there getter and setters

} 
```

我强烈建议您从 JSP 代码中移出数据库连接代码，并将其移到一个类中，该类说`ConnectionManager`应该负责创建/建立与数据库的连接。创建其他应该执行您的 SQL 查询的类，并将在 javalist 中为您提供结果

在您的操作类中调用该类，它将以列表形式返回存储在数据库中的所有图像的列表，您可以将该列表发送回 JSP，例如

```
public class ShowImageAction extends ActionSupport{

  private List<ImageBean> imageList;
  // getter setters for this

  public String showAllImages() throws Exception{
        imageList=ConnectionManager.getConnection.executeQuery("fetch all images from DB");    
  }
} 
```

在您的 JSP 中，当用户单击显示所有图像按钮时，您需要`showAllImages`调用`ShowImageAction`. 在 JSP 中使用迭代器来显示从数据库中获取的所有图像

```
 <s:iterator value="imageList" status="imgObject">
    <s:property value="imageName" />
    <s:property value="imageSize" />
</s:iterator> 
```

为了显示图像，您可以存储每个图像的唯一 ID，单击时可以将该 ID 传递给操作，并根据该 ID 获取图像。

为了显示图像，您可以使用 Struts2[流结果](http://struts.apache.org/2.3.1/docs/stream-result.html)类型，例如

```
 <result name="selectedImage" type="stream">
                <param name="contentType">image/jpg</param>
                <param name="inputName">imageStream</param>
                <param
name="contentDisposition">filename="image.jpg"</param>
                <param name="bufferSize">1024</param>
            </result> 
```

# actionscript-3 - 如何从actionscript中的另一个类访问一个类的构造函数？

> ID：11686844
> 
> 赞同：0
> 
> 时间：2012-07-27T11:27:28.430
> 
> 标签：actionscript-3, actionscript

我有两个课程，即`adminglobal.as`和`company.as`。

我需要`adminglobal.as`从`company.as`. 此外，在访问时，我也需要使用构造函数中存在的变量`company.as`。

基本上我需要的是`adminglobal.as`从 company.as 调用构造函数并使用构造函数中存在的变量`company.as`。怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T14:25:08.007

假设您`AdminGlobal`在一个名为的文件中有一个类，在一个文件中有`adminglobal.as`一个类。要在另一个类中访问一个类的构造函数，您只需将该类**公开**，然后导入该类，如果它们位于不同的包中。如果它们在同一个包中，那么您不需要隐式导入该类。`Company``company.as`

 **为了在另一个类中使用一个类的变量和方法，您只需要确保这些变量和方法也被标记为**公共**。我建议您看一下[Kirupa 的这篇关于 ActionScript3 中的类的教程](http://www.kirupa.com/developer/as3/classes_as3_pg1.htm)。

例如，如果您有`adminglobal.as`一个名为 的文件夹`admins`，则路线将是：`your_project_folder/src/admins/adminglobal.as`

和类的示例内容`AdminGlobal`：

```
package admins
{
  public class AdminGlobal
  {
    //accesible variable
    public var name:String;

    //constructor
    public function AdminGlobal()
    {
      //do init stuff here
      name= "anon";
    }

  }

} 
```

如果您在项目（默认包）的 src 文件夹中的文件 company.as 中有您的类 Company，则路线将是：`your_project_folder/src/company.as`

以及类的示例内容`Company`，访问类`AdminGlobal`：

```
package
{
  //import public class from another package
  import admins.AdminGlobal;

  public class Company
  {

    //constructor
    public function Company()
    {
      //call constructor of public class
      var ag:AdminGlobal = new AdminGlobal();

      //access public variables
      trace(ag.name);
    }

  }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-28T19:23:20.800

我相信你只是想错了，你可以为你的构造函数提供参数/参数，所以 AdminGlobal 可以声明为

```
public AdminGlobal(companyId:Number,companyName:String); 
```

然后在公司你可以打电话

```
new AdminGlobal(this.companyId,this.companyName); 
```

并在 AdminGlobal 的构造函数中对这些变量做任何你需要做的事情

甚至

```
AdminGlobal(company:Company); 
```

然后在公司做

```
new AdminGlobal(this); 
```

并且您可以从 AdminGlobal 处理公司的任何公共成员；

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-27T13:13:41.007

使用“public static var”来访问其他类的变量。

例如;

```
package com
{
    public class DataVO
    {
        public static var version:String = "1";
    }
} 
```**

# php - PHP：将 if/else 更改为一行条件失败。我想知道为什么

> ID：11686846
> 
> 赞同：1
> 
> 时间：2012-07-27T11:27:34.377
> 
> 标签：php, if-statement, conditional

我在 SQL 返回上有一个工作**if/else 。**如果它是空的，我会显示一个默认值。

```
<?php 
if($row['imagename']==='')
    {
        echo "placeholder.png";
    }
else 
    {
         echo htmlspecialchars($row['imagename'], ENT_QUOTES, 'UTF-8');
    } ?> 
```

我试图把它全部放在一条线上，即

```
<?php ($row['imagename']==='') ? echo "placeholder.png";:echo htmlspecialchars($row['imagename'], ENT_QUOTES, 'UTF-8'); ?> 
```

失败了。

有人可以澄清为什么它失败了吗？

蒂亚

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-27T11:28:50.240

删除分号并`echo`在开头添加。

```
<?php echo ($row['imagename']==='') ? "placeholder.png" : 
      htmlspecialchars($row['imagename'], ENT_QUOTES, 'UTF-8'); ?> 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-27T11:30:46.080

```
<?php echo ($row['imagename']==='') ? "placeholder.png" : htmlspecialchars($row['imagename'], ENT_QUOTES, 'UTF-8'); ?> 
```

您错误地使用了三元运算符

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-07-27T11:30:29.983

作为一种语言结构，`echo`不喜欢出现在`?:`表达式中。改为这样做：

```
echo true ? 'foo' : 'bar'; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-27T11:32:51.820

它失败了，因为它打算与表达式而不是语句一起使用。参考三​​元运算[符下的php比较运算符](http://php.net/manual/en/language.operators.comparison.php) 。

通过`;`在表达式的末尾加上 a，您就将它们变成了语句。

请参阅：[表达式和语句](http://www.vanguardsw.com/dphelp4/dph00238.htm)以了解两者之间的区别。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-04-19T03:04:22.820

print 和 echo 之间的一个区别是 print 有一个值，而 echo 没有。

构造：

```
$test ? planA : planB 
```

选择值 planA 或 planB 之一，即使您无意使用结果。由于 echo 没有价值，所以它不起作用：

```
$test ? echo 'plan A' : echo 'plan B'; // <-- not working 
```

如果您想使用这种简单的语法，只需将您的 echo 语句替换为 print 语句。

```
$test ? print 'plan A' : print 'plan B'; // <-- should work 
```

# javascript - 为样式表切换器存储 js cookie

> ID：11686849
> 
> 赞同：-1
> 
> 时间：2012-07-27T11:27:46.017
> 
> 标签：javascript, css, cookies

我在允许多种文本大小的网站上遇到一些问题。我有一个允许切换的脚本，一切都很好，但它没有将函数存储为 cookie，因此如果用户转到另一个页面，则文本大小为默认值。

我对javascript不是很精通，对cookie一无所知-想知道是否有人可以帮助我。

提前致谢。

这是我的脚本：

```
function loadjscssfile(filename, filetype) {
    if (filetype == "js") { //if filename is a external JavaScript file
        var fileref = document.createElement('script')
        fileref.setAttribute("type", "text/javascript")
        fileref.setAttribute("src", filename)
    } else if (filetype == "css") { //if filename is an external CSS file
        var fileref = document.createElement("link")
        fileref.setAttribute("rel", "stylesheet")
        fileref.setAttribute("type", "text/css")
        fileref.setAttribute("href", filename)
    }
    if (typeof fileref != "undefined") document.getElementsByTagName("head")[0].appendChild(fileref)
}

function removejscssfile(filename, filetype) {
    var targetelement = (filetype == "js") ? "script" : (filetype == "css") ? "link" : "none" //determine element type to create nodelist from
    var targetattr = (filetype == "js") ? "src" : (filetype == "css") ? "href" : "none" //determine corresponding attribute to test for
    var allsuspects = document.getElementsByTagName(targetelement)
    for (var i = allsuspects.length; i >= 0; i--) { //search backwards within nodelist for matching elements to remove
        if (allsuspects[i] && allsuspects[i].getAttribute(targetattr) != null && allsuspects[i].getAttribute(targetattr).indexOf(filename) != -1) allsuspects[i].parentNode.removeChild(allsuspects[i]) //remove element by calling parentNode.removeChild()
    }
} 
```

按钮代码：

```
<a onClick="removejscssfile('/css/med-font.css', '/css/lrg-font.css', 'css');" href="javascript:loadjscssfile('/css/sml-font.css','css')" id="sml">A</a>
<a onClick="removejscssfile('/css/sml-font.css', '/css/lrg-font.css', 'css');" href="javascript:loadjscssfile('/css/med-font.css','css')" id="med">A</a>
<a onClick="removejscssfile('/css/med-font.css', '/css/sml-font.css', 'css');" href="javascript:loadjscssfile('/css/lrg-font.css','css')" id="lrg">A</a> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T13:44:55.603

此页面保存最后选择的样式表的文件名并将其保存到 cookie。加载时，页面会检查 cookie 是否存在并相应地更改样式表。

内容包含在包装器中，因此在加载时样式发生更改时浏览器内容没有明显变化，并且 noscript 标记确保没有启用 javascript 的人仍然可以看到页面。

感谢 w3schools 的 cookie 代码以及 Sameera Thilakasiri 的 SO 回答：[使用 JQUERY 添加/删除 css 文件](https://stackoverflow.com/questions/8877056/adding-removing-css-files-using-jquery)（尽管我在这里坚持使用原生 js）

警告：未在所有浏览器中进行测试，并且脚本可能应该在页面完全加载后离开页面并启动。

希望这可以帮助！

```
<html>
<head>
    <link id="docStyleSheets" rel="stylesheet" href="default.css" type="text/css">
</head>
<body>
<noscript>
    <div id="divContentWrapper" style="display: none">
</noscript>
<ul id="ulCssChanges">
    <li><a href="#small" onclick="setFontSize('small.css');return false;")>Small</a></li>
    <li><a href="#medium" onclick="setFontSize('medium.css');return false;")>Medium</a></li>
    <li><a href="#large" onclick="setFontSize('large.css');return false;")>Large</a></li>
</ul>
<noscript>
    </div>
</noscript>

<script>
    var Cookies = {
        SetCookie: function (c_name, value, exdays) {
            var exdate = new Date();
            exdate.setDate(exdate.getDate() + exdays);
            var c_value = escape(value) + ((exdays == null) ? "" : "; expires=" + exdate.toUTCString());
            document.cookie = c_name + "=" + c_value;
        },

        GetCookie: function (c_name) {
            var i, x, y, ARRcookies = document.cookie.split(";");
            for (i = 0; i < ARRcookies.length; i++) {
                x = ARRcookies[i].substr(0, ARRcookies[i].indexOf("="));
                y = ARRcookies[i].substr(ARRcookies[i].indexOf("=") + 1);
                x = x.replace(/^\s+|\s+$/g, "");
                if (x == c_name) {
                    return unescape(y);
                }
            }
        }
    }

    if (Cookies.GetCookie("fontSize") != "") {
        setFontSize(Cookies.GetCookie("fontSize"));
        if (document.getElementById("divContentWrapper") != null) { document.getElementById("divContentWrapper").style.display = "block"; }
    }

    function setFontSize(styleSheetName) {
        document.getElementById("docStyleSheets").href = styleSheetName;
        Cookies.SetCookie("fontSize", styleSheetName, 60);
        return false;
    }    
</script> 
```

# zend-framework - 如何在 ZF2 的 ServiceManager 中注册 Zend\Log 实例

> ID：11686854
> 
> 赞同：7
> 
> 时间：2012-07-27T11:28:04.097
> 
> 标签：zend-framework, zend-framework2, zend-log

我想知道通过 ZF2 中的 ServiceManager 启动和重用记录器实例的最佳方法是什么。当然我可以做一个简单的方法在任何类中使用，比如：

```
public function getLogger () {
        $this->logger = new Logger();
        $this->logger->addWriter(new Writer\Stream('/log/cms_errors.log'));
        return $logger;
    } 
```

但我想知道在 global.php 中注册类似结构的最佳方法是什么。到目前为止我可以

将以下内容添加到 global.php

```
'Zend\Log'=>array(
        'timestampFormat' => 'Y-m-d',
        array(
            'writerName'   => 'Stream',
            'writerParams' => array(
                'stream'   => '/log/zend.log',
            ),
            'formatterName' => 'Simple',            
        ),
    ), 
```

如果我尝试通过以下方式调用它：

```
$this->getServiceLocator()->get('Zend\Log') 
```

我得到一个：

```
Zend\ServiceManager\ServiceManager::get was unable to fetch or create an instance for Zend\Log 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-10-14T20:11:19.560

将以下数据添加到 'global.php'

```
'service_manager' => array(
    'factories' => array(
        'Zend\Log' => function ($sm) {
            $log = new Zend\Log\Logger();
            $writer = new Zend\Log\Writer\Stream('./data/logs/logfile');
            $log->addWriter($writer);

            return $log;
        },
    ),
), 
```

然后你就可以打电话了

```
$this->getServiceLocator()->get('Zend\Log')->info('Something...'); 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-02-08T00:44:53.860

或者，更优雅的是，您可以设置一个日志侦听器并使您的记录器与您的应用程序分离。这`EventManager`是一个非常强大的组件，ZF2 现在基本上是一个事件驱动的框架。

在你的`module.php`你可以添加类似的东西：

```
// Setup the Zend Logger, pseudocode
$logger = new Logger;
$writer = new Writer;
$logger->addWriter($writer);

// Attach a logging listener for the log event on application level, working code
$events = StaticEventManager::getInstance();
$events->attach('*', 'log', function($event) use ($logger) {
    $target = get_class($event->getTarget());
    $message = $event->getParam('message', 'No message provided');
    $priority = (int) $event->getParam('priority', Logger::INFO);
    $message = sprintf('%s: %s', $target, $message);
    $logger->log($priority, $message);
}); 
```

然后从任何地方，例如从控制器，您可以执行以下操作：

```
$this->getEventManager()->trigger('log', $this, array(
                                                       'priority' => 7, 
                                                       'message' => 'some log message'
                                                      )); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-06-20T19:15:14.537

也许使用抽象记录器工厂而不是普通工厂进行配置

[http://framework.zend.com/manual/2.2/en/modules/zend.mvc.services.html#zend-log-loggerabstractservicefactory](http://framework.zend.com/manual/2.2/en/modules/zend.mvc.services.html#zend-log-loggerabstractservicefactory)

```
return array(
    'log' => array(
        'Log\App' => array(
            'writers' => array(
                array(
                    'name' => 'stream',
                    'priority' => 1000,
                    'options' => array(
                        'stream' => 'data/logs/app.log',
                    ),
                ),
            ),
        ),
    ),
); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-18T19:08:42.087

请使用绝对路径重试\

```
$writer = new \Zend\Log\Writer\Stream('log.log');
$logger = new \Zend\Log\Logger($writer); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-18T18:48:55.060

我在我的引导程序中创建了一个默认的数据库写入器对象并将其注册到 ServiceManager 中。

```
public function onBootstrap(MvcEvent $e)
{
    ...

    $serviceManager     = $e->getApplication()->getServiceManager();
    $dbAdapter          = $serviceManager->get('Zend\Db\Adapter\Adapter');

    $writer = new \Zend\Log\Writer\Db($dbAdapter, 'log_database_table');
    $logger = new \Zend\Log\Logger();
    $logger->addWriter($writer);

    // this is optional but nice to have
    \Zend\Log\Logger::registerErrorHandler($logger);

    $serviceManager->setService('Zend\Log', $logger);
} 
```

AbstractController 是“ServiceLocatorAwareInterface”的一个实例。所以我可以调用我的控制器

```
public function indexAction()
{
    ...

    $this->getServiceLocator()->get('Zend\Log')->info('this is a test log message');

    ...
} 
```

# c# - 启动程序文件加载错误

> ID：11686855
> 
> 赞同：0
> 
> 时间：2012-07-27T11:28:06.577
> 
> 标签：c#

我已经创建了一个程序，然后我将 programone 系统放入 Windows 中...使用这个想法：[http ://www.geekpedia.com/tutorial151_Run-the-application-at-Windows-startup.html](http://www.geekpedia.com/tutorial151_Run-the-application-at-Windows-startup.html)

但是，当程序启动时......我收到一条消息错误，当这个错误说：不可能加载文件：start.ini

所以，当系统启动程序时，程序被加载到C:\windows\system32，因为这个，我的程序的文件没有被加载......

要加载文件，我使用此命令获取文件目录：`Directory.GetCurrentDirectory() + "\\data\\start.ini"`

但是，在这种情况下，我如何加载这个文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T11:32:13.310

您可以将 start.ini 文件的路径保存到注册表中，并在启动时读取它。请参阅[MSDN](http://msdn.microsoft.com/en-us/library/microsoft.win32.registry%28v=vs.71%29.aspx)

ps 另一种方法是将指向您的应用程序的链接放入 Autorun 文件夹。

# javascript - Tumblr 分享按钮不起作用

> ID：11686857
> 
> 赞同：5
> 
> 时间：2012-07-27T11:28:11.363
> 
> 标签：javascript, html, url, web-applications, tumblr

我正在尝试向我的网上商店添加一个 tumblr 分享按钮，但我没有让 Tumblr 分享按钮（[请参阅此处](http://www.tumblr.com/docs/buttons)）工作。

*   我想分享一张用户自定义的产品图片，并设置产品页面的**点击**链接**。**
*   由于商店是基于 Knockout.js 构建的，并且产品配置器是动态加载的，因此 tumblr 提供的脚本“ [share.js](http://platform.tumblr.com/v1/share.js) ”不起作用。

所以我的分享按钮的 URL 如下所示：

```
var url = 'http://www.tumblr.com/share/photo';
url += '?source=' + encodeURIComponent('https://www.filltheblank.de/public/images/taschen/7_16.1-17.3-18.122-19.129-20.132_1.jpg');
url += '&caption=' + encodeURIComponent('little black dress bag');
url += '&click_thru=' + encodeURIComponent('https://www.filltheblank.de/konfigurator/#step:1|product:7_16.1-17.3-18.122-19.129-20.132'); 
```

或者如果你把它放在一起：

```
http://www.tumblr.com/share/photo?source=https%3A%2F%2Fwww.filltheblank.de%2Fpublic%2Fimages%2Ftaschen%2F7_16.1-17.3-18.122-19.129-20.132_1.jpg&caption=little%20black%20dress%20bag&click_thru=https%3A%2F%2Fwww.filltheblank.de%2Fkonfigurator%2F%23step%3A1%7Cproduct%3A7_16.1-17.3-18.122-19.129-20.132 
```

当您打开该链接时，共享者会显示得很好。但是，如果您单击“创建帖子”，该页面会将您重定向到您可以共享共享页面本身的页面......而不是发布任何内容！

我还尝试使用 tumblr 提供的另一个 URL 方案（但未记录）：

```
http://www.tumblr.com/share?v=3&u=[url]&t=[title]&s= 
```

这确实有效，但不支持包含图片或设置点击链接。结合这两种方法也行不通。

那么有人知道我能做些什么来让它工作吗？如果有人能回答我以下问题之一，我也将非常感激：

*   tumblr 提供的脚本“share.js”除了从我的普通链接中创建一个弹出链接之外，还有什么重要的作用吗？
*   我用javascript动态重写产品页面的URL会不会是个问题？

任何帮助将不胜感激，因为我被困在这里，我觉得我尝试了一切。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-17T16:22:41.277

您使用的图像路径（“源”的参数值）不是图像。它实际上是对 HTML 页面的 301（重定向）。您可以尝试使用具有适当内容类型的图像路径吗？

# objective-c - 如何使视图控制器可滚动？

> ID：11686860
> 
> 赞同：0
> 
> 时间：2012-07-27T11:28:27.903
> 
> 标签：objective-c, ios, uiscrollview, scrollview

我有一个视图控制器，我在它上面解析来自服务器的数据并在屏幕上显示一篇文章。现在文章可以有从 10 个字符到 10000 个字符的任意大小。所以我需要使整个视图控制器可滚动到用户，这样他就可以滚动浏览整篇文章。我怎样才能做到这一点？只能通过IB完成吗？在我的视图控制器上，我有图像和标签来显示文章数据。

或者也许更容易只制作我保持主要文章文本可滚动的标签而不是整个控制器？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T11:32:20.853

您必须通过自己的类扩展 UIScrollView 或者可以分配/初始化它。

```
scrollView = [[UIScrollView alloc] initWithFrame:CGRectMake(0, 0, self.view.frame.size.width, self.view.frame.size. height)];
scrollView.backgroundColor = [UIColor clearColor];
[scrollView addSubview:otherView];

scrollView.contentSize = scrollView.frame.size;

[self.view addSubview:scrollView]; 
```

之后，您必须将视图添加到 scrollView 并正确设置`contentSize`

# javascript - Backbone -> 无法调用未定义的方法“删除”

> ID：11686864
> 
> 赞同：2
> 
> 时间：2012-07-27T11:28:51.757
> 
> 标签：javascript, backbone.js

我的应用程序是使用主干构建的。尝试在模型上使用 destroy() 时遇到问题，这是我在 chrome 中得到的错误堆栈：

```
Uncaught TypeError: Cannot call method 'remove' of undefined backbone-min.js:34
f.extend.remove backbone-min.js:34
g.Events.trigger backbone-min.js:9
f.extend.destroy.d backbone-min.js:14
f.extend.destroy backbone-min.js:14
Backbone.Model.extend.remove ticketModel.js:21
Backbone.View.extend.deleteTicket ticketListView.js:44
b.each.b.forEach underscore-min.js:11
Backbone.View.extend.deleteTicketTickets ticketListView.js:49
f.event.dispatch jquery-1.7.2.min.js:3
f.event.add.h.handle.i 
```

知道这可能是什么吗？

导致错误的代码实际上只是：

```
model.destroy(); 
```

model 确实包含一个模型，`console.log(model)`因为它应该将对象记录到控制台。

这是模型定义：

```
define([
    'apiEndpoint'
    ],function(apiEndpoint) {
    var TicketModel = Backbone.Model.extend({
        url: apiEndpoint.url,

        isTicket : function(){
            return ( this.type === 'ticket') ? true : false;
        },

        isTask : function(){
            return ( this.type === 'task') ? true : false;
        },

        //Tells you if the view is selected for bulk actions
        defaults : {
            isSelected: false
        },

        remove : function(){
            this.destroy({success: function(){
                console.log('success');
            }});
        }

    });
    return TicketModel;
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T13:23:57.723

在你看来你为什么打电话`model.destroy();`？我认为您必须调用`model.remove();`，因为这是您要销毁的自定义方法。

看起来像在你的视图中你正在调用`model.destroy()`，`model.remove`但是因为你已经破坏了你的模型，现在你正试图调用未定义对象的删除方法。

# c++ - 屏幕坐标和设备坐标有什么区别？

> ID：11686869
> 
> 赞同：0
> 
> 时间：2012-07-27T11:29:19.613
> 
> 标签：c++, mfc, coordinates, cursor-position

我遇到过这段代码：

```
//handler for context menu element; to move an element

void CRTS_SketcherView::OnElementMove()      
{     
      CClientDC aDC(this);
OnPrepareDC(&aDC);                      //Set up the device context
GetCursorPos(&m_CursorPos);             //Get cursor position in screen coords
ScreenToClient(&m_CursorPos);            //convert to client coords
aDC.DPtoLP(&m_CursorPos);           //Convert to logical

      // ...code to initialize the moving of a shape on screen

} 
```

我知道光标的屏幕坐标是它在屏幕上的位置，而客户端坐标是窗口客户区域中的坐标，无论窗口的位置如何。但是什么是设备坐标？我唯一知道的是它们以像素为单位 - 但它们如何连接到逻辑（客户端）和屏幕坐标？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-07-27T11:48:27.607

屏幕坐标是设备坐标，它们只是描述同一事物的两种不同方式——你正在绘制的物理设备。

GDI 可用于诸如打印机输出之类的事情，但为此使用术语“屏幕坐标”有点令人困惑。从技术上讲，您也应该为屏幕使用“设备”绰号，但由于它是一种常用的设备，人们（和文档）给它起了自己的名字。

思考这一切的方法是实现有两个坐标系，一个是固定的（设备系统），一个是相对的（客户端系统）。

# java - 使用 SimpleFramework 动态转换为枚举

> ID：11686870
> 
> 赞同：1
> 
> 时间：2012-07-27T11:29:30.773
> 
> 标签：java, enums, simple-framework

我有一个 XML 字符串，其属性包含整数值：

```
<item status="2" /> 
```

还有`Simple Framework`一个描述这个的类`item`：

```
@Root
public static class Item {

    @Attribute(name="status")
    private int status;

    public int getStatus() {
        return status;
    }

} 
```

反序列化效果很好，但是我希望能够将`int`类型更改为定义的`enum`类型。

```
public enum Status {
    OK(0), PENDING(1), ERROR(2);

    BetStatus(int status) {
        this.status = status;
    }

    public int getStatus() {
        return status;
    }
} 
```

因此，快速修改：

```
@Root
public static class Item {

    @Attribute(name="status")
    private Status status;

    public Status getStatus() {
        return status;
    }

} 
```

但是现在我收到一个错误：

```
java.lang.IllegalArgumentException: 2 is not a constant in com.my.package.Status 
```

是否可以在反序列化期间以`int`这种方式进行转换？

我敢打赌我必须在我的`Status`课堂上添加一些神奇的方法。

**解决方案：**

根据`Reimeus`答案，我为属性留下`int`了类型，我只修改了类：`status``Item`

```
@Root
public static class Item {

    @Attribute(name="status")
    private int status;

    public Status getStatus() {
        return Status.getByOrdinal(status);
    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T11:40:40.130

也许通过遍历类型：

```
public enum Status {
    OK(0), PENDING(1), ERROR(2);

    private int status;

    Status(int status) {
        this.status = status;
    }

    public static Status getByOrdinal(int ordinal) {
        for (final Status element : EnumSet.allOf(Status.class)) {
            if (element.ordinal() == ordinal) {
                return element;
            }
        }

        throw new IllegalArgumentException("Unknown status type: " + ordinal);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T11:54:01.343

`getByOrdinal`将Reimeus 提供的方法与一个额外的 setter 结合起来，该方法`Item`需要一个 int。

```
public void setStatus(int status)
{
    this.status = Status.getByOrdinal(status);
} 
```

# c# - 将桌面应用程序转换为多用户桌面应用程序

> ID：11686871
> 
> 赞同：2
> 
> 时间：2012-07-27T11:29:32.410
> 
> 标签：c#, sql-server-express

我一直在使用只能在单台计算机上使用的 sql express 数据库开发桌面应用程序。现在的情况是我需要将应用程序扩展到多台计算机。为此，我需要 sql express 作为集中式数据库，整个应用程序应该访问数据库并使用它。现在我的问题是我不知道从哪里开始。我一直在盯着看，但找不到正确的答案。请帮我完成任务。任何类型的教程或链接都可能有用。

谢谢你先进

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-27T11:33:26.200

***最佳起点：***

**[如何配置 SQL Server 以允许远程连接 - Microsoft 支持文章](http://support.microsoft.com/kb/914277#method1)**

在配置完所有这些之后，只需在您的服务器上安装您`application`的所有内容。`terminals``database`

使用以下**连接字符串**：

```
"Data Source=Your_Server_Name\SQLEXPRESS; Initial Catalog=Your_Database_Name; integrated security=true" 
```

> 以下是您需要遵循的一些步骤：
> 
> **为 SQL Server 2005 Express 或 SQL Server 2005 Developer Edition 启用远程连接**
> 
> 您必须为要从远程计算机连接的每个 SQL Server 2005 实例启用远程连接。为此，请按照下列步骤操作：
> 
> 1.  单击开始，指向程序，指向 Microsoft SQL Server 2005，指向配置工具，然后单击 SQL Server 外围应用配置。
>     
>     
> 2.  在 SQL Server 2005 外围应用配置页面上，单击服务和连接的外围应用配置。
>     
>     
> 
> ![在此处输入图像描述](../Images/eb7283de078982a4f1c67ca5850bd6a2.png)
> 
> ![在此处输入图像描述](../Images/102116497141a2c603b6b409a2aa1467.png)
> 
> 3.  在服务和连接的外围应用配置页面上，展开数据库引擎，单击远程连接，单击本地和远程连接，单击为您的环境启用的适当协议，然后单击应用。
> 
> ![在此处输入图像描述](../Images/719c824918b0156e49aa79d3a880daf3.png)
> 
> ![在此处输入图像描述](../Images/5356d41dd2943d41f34f013e37f8e6ce.png)
> 
> **注意：**当您收到以下消息时单击确定：
> 
> 重新启动数据库引擎服务后，对连接设置的更改才会生效。
> 
> 4.  在服务和连接的外围应用配置页面上，展开数据库引擎，单击服务，单击停止，等待 MSSQLSERVER 服务停止，然后单击启动以重新启动 MSSQLSERVER 服务。
> 
> ![在此处输入图像描述](../Images/9eecaf66cdd3b0587d9ecfde81fee947.png)
> 
> ![在此处输入图像描述](../Images/4c889a543d80bb808dee8e621e40e904.png)
> 
> **启用 SQL Server 浏览器服务**
> 
> 向客户端计算机提供 SQL Server 连接信息。要启用 SQL Server Browser 服务，请执行以下步骤：
> 
> 5.  单击开始，指向程序，指向 Microsoft SQL Server 2005，指向配置工具，然后单击 SQL Server 外围应用配置。
>     
>     
> 6.  在 SQL Server 2005 外围应用配置页面上，单击服务和连接的外围应用配置。
>     
>     
> 7.  在“服务和连接的外围应用配置”页面上，单击 SQL Server Browser，单击“自动”作为“启动类型”，然后单击“应用”。
>     
>     
> 
> **注意：**当您单击自动选项时，SQL Server Browser 服务会在您每次启动 Microsoft Windows 时自动启动。
> 
> 8.  单击开始，然后单击确定。
> 
> ![在此处输入图像描述](../Images/59b257e14941f8ac849040a7e470e2a1.png)
> 
> **Windows 防火墙 - 关闭防火墙**
> 
> 9.  打开控制面板，单击 Windows 防火墙或单击开始，单击运行，键入 firewall.cpl，然后单击确定。打开后，转到例外选项卡。只需向下滚动并检查您是否可以看到 sqlservr.exe 已添加到列表中，并且其复选框已选中。
> 
> ![在此处输入图像描述](../Images/2cc32bea75c4f7b472d20a453f1d1a12.png)
> 
> ![在此处输入图像描述](../Images/efc9e195b207836c6e09d668faaf583f.png)
> 
> 10.  如果没有，请单击 Add Programs 按钮，然后单击 Browse 按钮​​并在 Program Files > Microsoft SQL Server > MSSQL.1 > MSSQL > BINN > sqlservr.exe 中找到 sqlservr.exe。路径可能不同，具体取决于 SQL Server 2005 安装。所以找到 sqlservr.exe 并将其添加到例外列表中。然后单击确定。
> 
> ![在此处输入图像描述](../Images/d1bacf2536fbb72629bac9471ce4ae2f.png)
> 
> 11.  SQLExpress 连接问题的第二种解决方法是在 SQL Server 配置管理器 > SQL Server 2005 网络配置 > SQLExpress 协议中启用 TCP/IP 协议。在右侧窗格中，右键单击您的 TCP/IP 协议并选择启用。您必须再次重新启动 SQLExpress 服务才能使此更改生效。
> 
> ![在此处输入图像描述](../Images/7488c4293885e85f8b09b55eaa4591c5.png)
> 
> ***重新启动服务，现在您可以将远程系统与服务器连接，并从 SQL Server Express 2005 访问数据。***

**参考资料**：

*   **[如何配置 SQL Server 2005 以允许远程连接](http://www.sqlserverclub.com/essentialguides/how-to-configure-sql-server-2005-to-allow-remote-connections.aspx)**
*   **[为 SQL Server Express 2005 配置远程连接](http://www.aspdotnetcodes.com/Enable_Remote_Connections_SQLServerExpress.aspx)**

# iphone - Xcode 4.3为按钮设置属性

> ID：11686878
> 
> 赞同：0
> 
> 时间：2012-07-27T11:29:57.903
> 
> 标签：iphone, objective-c, cocoa-touch, xcode4.3

可以从其他viewController隐藏或显示xcode中的按钮，场景就像这样我正在使用导航控制器我已经制作了隐藏按钮，我想让隐藏按钮在按下其他viewController的按钮时可见。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T11:50:02.387

当您将按钮推到另一个 Viewcontroller 上时。只需添加那里`ButtonName.Hidden=NO`。

# c# - 在 C# 中基于字符串标识符创建类对象

> ID：11686881
> 
> 赞同：2
> 
> 时间：2012-07-27T11:30:19.167
> 
> 标签：c#, .net, parsing, object, validating

我是编程新手，请多多包涵。我使用 c sharp，.net 4，VS 2010

我有一个`IHandler`用 method调用的接口类`IsValidate()`。我有一条消息，例如`AMOUNT 50 22.4`，`AMOUNT`标识符在哪里。所以消息的格式可以像`FLOW 12 33 23.1`，`FLOW`标识符在哪里。

现在，根据标识符，我有不同的类（我有大约 15-20 个这样的类，因为我必须验证不同的消息格式和序列）

1.  `AmountValidator`

2.  `FlowValidator`

在这些类中，我有`IsValidate()`方法的实现，因为这些实现`IHandler`类。

现在我的问题是，一旦我确定了我的消息的标识符，`AMOUNT`或者`FLOW`我想创建类的实例。

最好的方法是什么？（我不想在 if else 语句中创建 30 个实例）

感谢任何帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-27T11:35:32.567

你可以这样做：

```
IHandler handler = (IHandler)Activator.CreateInstance("assemblyname", "typename");
handler.IsValidate(); 
```

程序集名称可以在处理程序所在项目的属性页面上找到。

这里：![程序集名称](../Images/08b59578fdacf8e57b13c90e4c4b4800.png)

您还必须记住，所有内容都区分大小写，因此如果类实际上命名为 AmountValidator，则 typename 参数不能是 AMOUNTValidator。

**编辑**：工厂样品：

```
public static class HandlerFactory {
    private static Object factoryLock = new Object();
    private static List<IHandler> handlers = null;

    public static IHandler Gethandler(String type) {
        if (handlers == null) {
            lock (factoryLock) {
                if (handlers == null) {
                    IEnumerable<Type> types = typeof(HandlerFactory).Assembly.GetTypes().Where(t => t.GetInterfaces().Contains(typeof(IHandler)));
                    handlers = types.Select(t => (IHandler)Activator.CreateInstance(t));
                }
            }
        }
        return handlers.Where(h => h.Type == type);
    }
}

public interface IHandler {
    String Type { get; }
    Boolean IsValid(String data);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-27T13:20:44.763

假设验证器是无状态的，您应该在构造函数中列出验证器一次的工厂实现：

```
 public class HandlerFactory
{
    private Dictionary<string, IHandler> _handlers = new Dictionary<string,IHandler>();

    public HandlerFactory()
    {
        _handlers.Add("AMOUNT", new AmountValidator());
        _handlers.Add("FLOW", new FlowValidator());
    }

    public IHandler Create(string key)
    {
        IHandler result;
        _handlers.TryGetValue(key, out result);
        return result;
    }
} 
```

如果您希望我详细说明反射和 IoC，请告诉我。这会改变你初始化字典的方式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-27T12:09:54.813

如果您的所有`IHandler`类都包含在与您的应用程序相同的程序集中（不像插件那样动态加载），[工厂方法模式](http://en.wikipedia.org/wiki/Factory_method_pattern)可能是一个不错的选择。`IHandler`您可以使用此设计模式集中创建类。另一方面，如果`IHandler`类是在运行时加载的，则需要利用[.NET Reflection](http://msdn.microsoft.com/en-us/library/f7ykdhsy.aspx)。还有一些开源[IoC 容器](http://www.hanselman.com/blog/ListOfNETDependencyInjectionContainersIOC.aspx)可以帮助创建对象，但我想它们有点矫枉过正。

# php - PHP fsockopen() 错误贝宝的任何替代方法？

> ID：11686883
> 
> 赞同：0
> 
> 时间：2012-07-27T11:30:20.927
> 
> 标签：php, paypal

使用 fscockopen 功能的 IPN 通知确实很少失败。但这只是偶尔发生一次，我怀疑它在 php 配置中的问题。

请参阅以下代码，是否有解决方法而不是使用该 `PHP fsockopen()`函数？可能是卷曲？这可以在 CURL 中做到这一点吗？

```
 $fp = fsockopen ('ssl://www.paypal.com', 443, $errno, $errstr, 30 );
    if (!$fp) { 
        $this->error_out("PHP fsockopen() error: " . $errstr , "");
    } 
```

**任何替代解决方案或任何强大的错误检查建议？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-28T00:08:09.767

我发现[这](http://www.micahcarrick.com/04-19-2005/php-paypal-ipn-integration-class.html)很有效并且非常有用。它使用 curl，如果需要，我们也可以使用 fsock 方法。

非常干净的脚本，这使得理解事务的各个部分和编辑事物变得容易。

# iphone - 从 iOS 设备连续录制和发送/流式传输声音到服务器

> ID：11686884
> 
> 赞同：21
> 
> 时间：2012-07-27T11:30:22.503
> 
> 标签：iphone, ios, cocoa-touch, ipad, audio-recording

我正在开发一个 iOS 应用程序，该应用程序上有一个带有麦克风的按钮（以及其他功能）。当用户按下麦克风时，它会突出显示，应用程序现在应该开始从设备的麦克风录制声音并发送到服务器（专用于应用程序的服务器，由我认识的人开发，所以我可以影响它的设计）。

我正在寻找最简单但最坚固的方法来做到这一点，即我不需要开发复杂的流媒体解决方案或 VoIP 功能，除非它与其他任何事情一样简单。

主要问题是我们不知道用户将录制声音多长时间，但我们希望确保声音连续发送到服务器，我们不希望等到用户完成录制。如果数据以块的形式到达服务器是可以的，但是我们不希望错过用户可能正在记录的任何信息，因此一个块必须在前一个结束的地方继续，依此类推。

我们的第一个想法是创建例如 10 秒的声音片段“块”并将它们连续发送到服务器。有没有我错过的更好/更简单的流媒体解决方案？

我的问题是，在 iOS 上解决此任务的最简单但仍然可靠的方法是什么？

有没有办法从 AVAudioRecorder 正在运行的录音中提取声音块，而无需实际停止录音？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-07-27T11:41:05.443

实际上，拥有固定大小的块而不是固定时间可能更容易。然后你可以有两个缓冲区，一个是你当前用样本数据填充的。当活动缓冲区已满时，然后切换以填充另一个缓冲区，同时向发送者线程发送信号，该线程获取第一个缓冲区并将其发送到服务器。

您当然可以改用固定时间，但是您需要确保缓冲区足够大以保存所有样本，或者使用可以在需要时增加大小的动态缓冲区。但是，双缓冲和发送线程仍然可以相同。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-08-07T12:04:55.630

在本教程中查看[这个](http://www.techotopia.com/index.php/Recording_Audio_on_an_iPhone_with_AVAudioRecorder_%28iOS_4%29)
，录制的声音将保存在 soundFileURL，然后您只需使用该内容创建一个 nsdata，然后将其发送到您的服务器。
希望这有帮助。

编辑：
我刚刚创建了一个包含 3 个按钮的版本，REC、SEND 和 Stop：
REC：将开始录制到文件中。
SEND ：将记录在该文件中的内容保存在 NSData 中，并将其发送到服务器，然后重新开始记录。
和 STOP : 将停止录制。
这是代码：在您的 .h 文件中：

```
#import <UIKit/UIKit.h>
#import <AVFoundation/AVFoundation.h>

@interface ViewController : UIViewController <AVAudioRecorderDelegate>

@property (nonatomic, retain) AVAudioRecorder *audioRecorder;
@property (nonatomic, retain) IBOutlet UIButton *recordButton;
@property (nonatomic, retain) IBOutlet UIButton *stopButton;
@property (nonatomic, retain) IBOutlet UIButton *sendButton;

@property BOOL stoped;

- (IBAction)startRec:(id)sender;
- (IBAction)sendToServer:(id)sender;
- (IBAction)stop:(id)sender;
@end 
```

并在 .m 文件中：

```
#import "ViewController.h"

@implementation ViewController
@synthesize audioRecorder;
@synthesize recordButton,sendButton,stopButton;
@synthesize stoped;

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Release any cached data, images, etc that aren't in use.
}

#pragma mark - View lifecycle

- (void)viewDidLoad
{
    [super viewDidLoad];
// Do any additional setup after loading the view, typically from a nib.
sendButton.enabled = NO;
stopButton.enabled = NO;
stoped = YES;

NSArray *dirPaths;
NSString *docsDir;

dirPaths = NSSearchPathForDirectoriesInDomains(
                                               NSDocumentDirectory, NSUserDomainMask, YES);
docsDir = [dirPaths objectAtIndex:0];
NSString *soundFilePath = [docsDir
                           stringByAppendingPathComponent:@"tempsound.caf"];

NSURL *soundFileURL = [NSURL fileURLWithPath:soundFilePath];

NSDictionary *recordSettings = [NSDictionary 
                                dictionaryWithObjectsAndKeys:
                                [NSNumber numberWithInt:AVAudioQualityMin],
                                AVEncoderAudioQualityKey,
                                [NSNumber numberWithInt:16], 
                                AVEncoderBitRateKey,
                                [NSNumber numberWithInt: 2], 
                                AVNumberOfChannelsKey,
                                [NSNumber numberWithFloat:44100.0], 
                                AVSampleRateKey,
                                nil];

NSError *error = nil;

audioRecorder = [[AVAudioRecorder alloc]
                 initWithURL:soundFileURL
                 settings:recordSettings
                 error:&error];
audioRecorder.delegate = self;
if (error)
{
    NSLog(@"error: %@", [error localizedDescription]);

} else {
    [audioRecorder prepareToRecord];
}
}

- (void)viewDidUnload
{
    [super viewDidUnload];
    // Release any retained subviews of the main view.
    // e.g. self.myOutlet = nil;
}

- (void)viewWillAppear:(BOOL)animated
{
    [super viewWillAppear:animated];
}

- (void)viewDidAppear:(BOOL)animated
{
    [super viewDidAppear:animated];
}

- (void)viewWillDisappear:(BOOL)animated
{
    [super viewWillDisappear:animated];
}

- (void)viewDidDisappear:(BOOL)animated
{
    [super viewDidDisappear:animated];
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    // Return YES for supported orientations
    return (interfaceOrientation != UIInterfaceOrientationPortraitUpsideDown);
}

- (BOOL) sendAudioToServer :(NSData *)data {
    NSData *d = [NSData dataWithData:data];
    //now you'll just have to send that NSData to your server

    return YES;
}
-(void)audioRecorderDidFinishRecording:(AVAudioRecorder *)recorder successfully:(BOOL)flag
{
NSLog(@"stoped");
    if (!stoped) {
        NSData *data = [NSData dataWithContentsOfURL:recorder.url];
        [self sendAudioToServer:data];
        [recorder record];
NSLog(@"stoped sent and restarted");
    }
}
- (IBAction)startRec:(id)sender {
if (!audioRecorder.recording)
{
    sendButton.enabled = YES;
    stopButton.enabled = YES;
    [audioRecorder record];
}
}

- (IBAction)sendToServer:(id)sender {
stoped = NO;
[audioRecorder stop];
}

- (IBAction)stop:(id)sender {
stopButton.enabled = NO;
sendButton.enabled = NO;
recordButton.enabled = YES;

stoped = YES;
if (audioRecorder.recording)
{
    [audioRecorder stop];
}
}
@end 
```

祝你好运。

# c# - 如何使用 C# 在 LINQ 中使用包含

> ID：11686885
> 
> 赞同：2
> 
> 时间：2012-07-27T11:30:22.120
> 
> 标签：c#, linq

我有一些**HierarchyNodeEntity**值的集合和**Ancestors**的集合。现在我想通过使用**db.HierarchyNodeEntities的值从****theAncestors**获取值。

 **在这里，我使用**包含**来实现这一点。但它不起作用。我想在 SQL 中将此**包含**作为**Like运算符。**谁能告诉我如何在这个 LINQ 中使用 Like 。

提前致谢。

这是代码：

```
var q = from p in db.HierarchyNodeEntities                         
                      where theAncestors.Contains(p.HierarchyNodeEntity)
                      group p by p.PropertyKey
                         into prop
                         select
                             prop.OrderByDescending(p => p.LevelId).
                             FirstOrDefault();

     var list = q.ToList(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T11:35:58.900

苏里亚卡维塔，

它可能会也可能不会通过传入一个对象来进行比较，因为 sql 不会理解您所指的字段。您可能需要尝试以下方法：

**[编辑]**

```
theAncestors
    .Where(x => x.myproperty.Contains(p.HierarchyNodeEntity.anotherproperty)) 
```

这是我最初的建议（你也可以用`Contains`or`StartsWith`代替`EndsWith`）。Yopu 甚至可以使用直接相等检查，即：

```
theAncestors
    .Where(x => x.myproperty == p.HierarchyNodeEntity.anotherproperty) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T11:40:10.567

如果我猜对了，您需要`like '%abc%'`sql 表示法。您需要`string`先将值转换为类型，然后才使用包含。因为`IEnumberable.Contains`不同。

```
theAncestors.Count(x => x.ToString().Contains(p.ToString())) > 0 
```**

# qt - 在 MainWindow 中覆盖小部件的绘制事件

> ID：11686886
> 
> 赞同：0
> 
> 时间：2012-07-27T11:30:22.843
> 
> 标签：qt, events, paintevent

我有一个想要手动绘制的小部件容器。但是，它位于我的 GUI 的 MainWindow 类中。

有什么方法可以注册特定 QWidget 的绘制事件，所以我自己的函数将被调用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T11:33:52.817

寻找事件过滤器。它会帮助你

# javascript - jQuery Validation Plugin 停止表单提交，提交按钮不起作用

> ID：11686889
> 
> 赞同：6
> 
> 时间：2012-07-27T11:30:38.000
> 
> 标签：javascript, jquery

以下使用 jQuery 验证插件的脚本 - [http://docs.jquery.com/Plugins/Validation](http://docs.jquery.com/Plugins/Validation) - 阻止发送此处找到的表单：

[http://www.bestcastleintown.co.uk/book2.php](http://www.bestcastleintown.co.uk/book2.php)

请填写表格并观看验证消息消失然后尝试按发送，这似乎没有发送，我不明白为什么。

删除此脚本后，联系表单将正常运行并允许发送。因此，我认为这是造成问题的原因。任何帮助或建议将不胜感激。

```
<script type="text/javascript">
jQuery.validator.setDefaults({
    debug: true,
    success: "valid"
});;
</script>

  <script>
      $(document).ready(function() {
          $("#aform").validate({
              rules: {
                  postcode: {required: true,minlength: 6},
               phone: {required: true,number: true}

              }
          });
      });
  </script> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-27T11:35:46.197

您正在调试模式下运行验证器。[相关文件](http://docs.jquery.com/Plugins/Validation/validate#toptions)说（强调我的）：

> **调试**布尔默认值：`false`
> 
> 启用调试模式。如果`true`，*则不提交表单*，并且控制台上会显示某些错误（需要 Firebug 或 Firebug lite）。尝试在刚刚提交表单时启用，而不是验证停止提交。

删除该`debug: true`选项将解决您的问题。

# django - 仅从服务器本身（本地主机）限制对 Django 视图的访问

> ID：11686893
> 
> 赞同：4
> 
> 时间：2012-07-27T11:30:44.220
> 
> 标签：django, django-views

我想在 Django 中创建一个仅限本地主机的 API，并且我试图找到一种方法来限制仅从服务器本身（本地主机）访问视图？我试过使用：

*   'HTTP_HOST',
*   'HTTP_X_FORWARDED_FOR',
*   'REMOTE_ADDR',
*   'SERVER_ADDR'

但没有运气。

还有其他方法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-27T11:44:52.930

您可以将您的网络服务器（Apache、Nginx 等）配置为仅绑定到 localhost。

如果您想限制对所有视图的访问，这将很有效，但如果您想允许远程用户访问某些视图，那么您必须配置第二个 Django 项目。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-27T13:12:13.707

这个问题比仅仅检查一个变量要复杂一些。要识别客户端 IP 地址，您需要

```
request.META['REMOTE_ADDR'] -- The IP address of the client. 
```

然后将其与`request.get_host()`. 但是您可能会考虑到服务器可能在 0.0.0.0:80 启动，因此您可能需要执行以下操作：

```
import socket
socket.gethostbyaddr(request.META['REMOTE_ADDR']) 
```

并将其与让我们说

```
socket.gethostbyaddr("127.0.0.1") 
```

但是您需要使用这些标头和值处理许多极端情况。

一个更简单的方法可能是在您的应用程序前面有一个反向代理，它会发送一些 custom_header 之类的`X_SOURCE=internet`. 然后您可以设置来自互联网的流量通过代理，而本地流量（在您的本地网络中）直接进入网络服务器。因此，如果您只想从本地网络访问特定视图，只需检查此标头：

```
if 'X_SOURCE' in request.META:
    # request is coming from internet, and not local network....
else:
    # presumably we have a local request... 
```

但同样 - 这是“防火墙方法”，它将需要更多设置，并确保无法从外部访问应用程序，这不会通过反向代理..

# c++ - 如何模拟库调用？

> ID：11686897
> 
> 赞同：5
> 
> 时间：2012-07-27T11:30:48.813
> 
> 标签：c++, unit-testing, testing

cpp 新手（Java 人）。

我有具有方法 sendMail(txt) 的 3rd 方库。我不想测试图书馆。我想测试我自己的方法，所以为了做到这一点，我需要模拟库调用。

我自己的方法是这样的：

```
#include "mailsender.h"

int run(txt){
    analysis(txt);
    ...
    ...
    int status =  sendMail(txt);//sendMail is a 3rd party library call. i need to mock it.its not part of the unit test
    return status;
} 
```

在 Java 中，邮件发送器是接口，它被注入到我的类中，所以在测试的情况下我注入模拟。cpp模拟库调用的好习惯是什么？我可以将第 3 方库调用包装在一个类中并注入这个类，但我正在寻找更简单的东西和常见的做法（也许是 ifndf）。

我熟悉googlemock。googlemock 允许我模拟课程。我不知道如何在我的测试方法中模拟调用。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-27T12:20:01.587

所以我假设你有一个在库中实现的“全局”函数，你都包含一个头文件（以获取定义）和链接（以获取实现）。

你显然需要用你自己的替换库的实现——一个“什么都不做”的，所以你可以通过两种方式做到这一点：

*   您将 .dll（或 .so）替换为您自己的实现，该实现具有 3rd 方库公开的所有方法。一旦您编写了所有 3rd 方库函数的新版本，这很容易，但是将它们全部写出来可能会很痛苦。
*   您暂时删除该库，并替换您在实现这些功能的 .cpp 源文件中对该库所做的调用。因此，您将在 .cpp 文件中创建自己的 sendMail() 函数，并将其包含到程序中，而不是 mailsender.h 包含。

后者更容易，但您可能还必须修改您的程序以不与第 3 方库链接。这也可能需要更改#include，因为某些编译器（例如VC++）允许您在源代码中嵌入链接器指令。如果您这样做，那么您将无法阻止链接器包含第 3 方库。

另一种选择是修改您的代码以对 sendMail 调用使用不同的调用，例如您自己实现的 test__sendMail()。Wrap this 是一个宏，可以根据您的构建选项有条件地包含您的或真实的函数调用。

如果这是一个 c++ 库，那么您可能可以像以前那样使用模拟框架，但听起来它像是一个 C 库，它们只是提供了您在代码中直接使用的函数列表。您可以将库包装在您自己的类中并使用它，而不是直接调用第 3 方库函数。

[有一个 C 模拟框架列表。](https://stackoverflow.com/questions/65820/unit-testing-c-code)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-04-21T10:49:10.223

这是一个老问题，已经选择了答案，但也许以下贡献可以帮助其他人。

# 第一个解决方案

您仍然需要创建一个自定义库来重新定义函数，但您不需要更改 Makefile 以链接到您的“假库”，只需使用 LD_PRELOAD 和假库的路径，这将是第一个链接器会找到然后使用。

[例子](http://www.linuxjournal.com/article/7795)

# 第二种解决方案

[ld (GNU) 链接器](http://linux.die.net/man/1/ld)有一个**选项 --wrap**，它允许您**只用用户提供的另一个函数包装一个函数**。这样您就不必创建一个新的库/类来模拟行为

这是手册页中的示例

> --wrap=symbol 对符号使用包装函数。任何未定义的符号引用都将被解析为“__wrap_ symbol”。任何对“__real_ symbol”的未定义引用都将被解析为符号。
> 
> 这可用于为系统函数提供包装器。包装函数应称为“__wrap_ symbol”。如果它想调用系统函数，它应该调用“__real_symbol”。
> 
> 这是一个简单的例子：
> 
> ```
> void *
> __wrap_malloc (size_t c)
> {
>   printf ("malloc called with %zu\n", c);
>   return __real_malloc (c);
> } 
> ```
> 
> 如果您使用 --wrap malloc 将其他代码与此文件链接，则所有对“malloc”的调用将改为调用函数“__wrap_malloc”。在“__wrap_malloc”中对“__real_malloc”的调用将调用真正的“malloc”函数。
> 
> 您可能还希望提供“__real_malloc”函数，以便没有 --wrap 选项的链接会成功。如果这样做，则不应将“__real_malloc”的定义与“__wrap_malloc”放在同一个文件中；如果你这样做了，汇编器可能会在链接器有机会将它包装到“malloc”之前解决调用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-06-17T18:29:57.463

免责声明：我写了 ELFspy。

使用 ELFspy，以下代码将允许您通过将其替换为替代实现来伪造/模拟 sendMail 函数。

```
void yourSendMail(const char* txt) // ensure same signature as sendMail
{
  // your mocking code
}

int main(int argc, char** argv)
{
  spy::initialise(argc, argv);
  auto sendMail_hook = SPY(&sendMail); // grab a hook to sendMail
  // use hook to reroute all program calls to sendMail to yourSendMail
  auto sendMail_fake = spy::fake(sendMail_hook, &yourSendMail);
  // call run here..
} 
```

您的程序必须使用与位置无关的代码（使用共享库构建）进行编译才能实现这一点。

更多示例在这里： [https ://github.com/mollismerx/elfspy/wiki](https://github.com/mollismerx/elfspy/wiki)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-27T11:44:54.323

尽管没有`interface`关键字，但您可以在 C++ 中将抽象基类用于类似的事情。

如果您使用的库不带有这样的抽象，您可以将它包装在您自己的“接口”后面。如果您的代码将对象的构造与使用分开（例如通过 IoC），您可以使用它来注入假货或使用 Mocks：

[https://stackoverflow.com/questions/38493/are-there-any-good-c-mock-object-frameworks](https://stackoverflow.com/questions/38493/are-there-any-good-c-mock-object-frameworks)

# knockout.js - 如何在 knockout.js 中的第一个事件后显示一次服务器响应并清除？

> ID：11686901
> 
> 赞同：2
> 
> 时间：2012-07-27T11:31:00.237
> 
> 标签：knockout.js

在 ajax 发布后，我想显示“您的订单已收到：链接”。在用户第一次交互（viewModel 中的任何更改）后，我想清除消息。

我怎么能用 knockout.js 做到这一点

看法：

```
<div data-bind="text:serverResponse,visible:serverResponseActive"></div> 
```

也许是可写的计算 observables？如何？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-29T04:06:04.387

您可以尝试的一种方法是将`event`绑定添加到要从中清除服务器消息的任何客户端可交互元素。所以，像：

```
<input type="text" data-bind="event: { mouseover: clearResposne, click: clearResponse}" />

// viewmodel code (object literal style)
clearResponse: function() { this.serverResponseActive = false; }, 
```

大页面可能会有点凌乱，但对于一两件事，它会非常整洁和紧凑。

另一种方法是在收到服务器响应时设置超时，在 x 秒内清除标志。

```
// In the view model (constructed object style)
var self = this; // to un-confuse the closure function 'this'

// In the ajax response
setTimeout(function() { self.serverResponseActive = false }, 5000); 
```

在用户操作后将两者结合起来延迟。

编辑：第三种方法，受您的启发

> 在用户第一次交互（viewModel 中的任何更改）后，我想清除消息。

手动订阅 viewModel 中的所有其他 observable。如果你有一堆可观察的东西，可能会非常混乱。

```
myViewModel.personName.subscribe(function(newValue) {
    setTimeout(function() { self.serverResponseActive = false }, 5000);
}); 
```

如果您真的有一大堆 observable，请考虑为它们制作自定义绑定，其中包含订阅/超时。

# magento - Magento Multi Store 客户组合登录凭据

> ID：11686902
> 
> 赞同：6
> 
> 时间：2012-07-27T11:31:04.800
> 
> 标签：magento

我刚刚在我的 Magento 电子商务网站上添加了另一个网站，我希望我现有的客户 Bass 能够使用他们在原始网站上注册的相同用户名和密码登录到新网站。我还需要将将来注册的任何客户分配到这两个网站。

当我去编辑用户时，有一个下拉框来说明他们与哪个网站相关联，但该字段被禁用并且看起来不像多选下拉菜单。这向我表明 Magento 没有设置为在网站之间共享详细信息。

有谁知道这是否可能？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-27T12:02:37.523

在管理员中，在**System** > **Configuration** > **Customers** > **Customer Configuration** > **Account Sharing Options**下，您将能够在每个网站或全局共享帐户之间进行选择。

# javascript - Javascript倒计时和时区以及夏令时问题

> ID：11686903
> 
> 赞同：1
> 
> 时间：2012-07-27T11:31:21.430
> 
> 标签：javascript, jquery, countdown, script#, jquery-countdown

我们的团队在 JQuery 倒计时方面遇到了大问题，我们真的需要一些帮助。

最初，我们有一些执行此操作的 ScriptSharp 代码

```
JQueryCountdownOptions opts = new JQueryCountdownOptions();
opts.Layout = "<ul class=\"group\"> <li>{dn} <span>{dl}</span></li> <li>{hn} <span>{hl}</span></li> <li>{mn} <span>{ml}</span></li> <li>{sn} <span>{sl}</span></li> </ul>";
opts.Until = Number.ParseInt(timeLeft);

jQuery.Select("#countdownclock").Plugin<JQueryCountdown>().Countdown(opts);
jQuery.Select("#countdownclock").Show();
jQuery.Select("#bidBox").RemoveAttr("disabled"); 
```

我们注意到的是，这使用客户端的时钟进行倒计时。因此，如果客户决定提前 5 小时更改他的时间，那么倒计时将是 5 小时。

为了解决这个问题，我们引入了更多代码

在视图中：

```
 $(function () {

        var expires = new Date(@year, @month, @day, @hours, @minutes, @seconds);
        $('#clockDiv').countdown({ until: expires, timeZone: null, serverSync: serverTime, onTick: serverTime, tickInterval: 60 });

        function serverTime() {
            var time = null;
            $.ajax({ url: '/Auction/SyncServerTime',
                async: false, dataType: 'json',
                success: function (result) {
                    time = new Date(result.serverTime);
                }, error: function (http, message, exc) {
                    time = new Date();
                }
            });
            return time;
        }
}); 
```

在控制器中

```
public JsonResult SyncServerTime()
        {
            var result = new JsonResult
            {
                Data = new
                {
                    serverTime = DateTime.Now.ToString("MMM dd, yyyy HH:mm:ss zz")
                },
                JsonRequestBehavior = JsonRequestBehavior.AllowGet
            };
            return result;
        } 
```

此代码确保无论用户将时钟设置为什么，倒数计时器都会定期同步到服务器的时间。问题解决了。

唯一的问题是我们提出了其他问题。

问题在于，当用户处于不同的时区时，这些用户的倒计时会根据他们的时区所具有的时区偏移量而有所不同。我们已尝试更改各种参数，但仍然存在问题。更糟糕的是，如果我的时间跨度跨越了应用夏令时的日期，那么事情就会再次出错，无论是在同一时区还是在不同时区。我们已经尝试了不同的代码和参数，所以以上只是我所做的，与我尊敬的同事尝试的不同。我要问的是，肯定有人在某个地方有要求

1.  编写一个独立于客户端时间并基于服务器时间的倒计时。
2.  无论用户在哪个时区，都显示相同的剩余天数、小时数、分钟数、秒数
3.  显示由于 DST 而在此期间时间将更改的用户与由于 DST 而在此期间内时间不会更改的用户的剩余天数、小时、分钟、秒数相同
4.  显示用户的**实际**剩余天数、小时数、分钟数和秒数，该用户的时间将在此期间因 DST 而发生变化。

当然，我们不可能是唯一遇到过这个问题的人。不可能这么难。有谁知道解决方案？

谢谢，

萨钦

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-28T08:31:21.707

我个人没有处理过相同的场景，但是看到日期、时区问题等弹出会自动触发一些潜在问题的想法，这些问题源于使用本地日期对象而不是 UTC 日期对象。

IMO，如果所有计算、日期序列化仅在 UTC 空间中工作，并且最后当涉及到来自用户的日期时，根据场景将其转换为本地或适当的时区，事情就会变得更好。另一方面，用户输入本地或某个时区相关条目，并立即将其转换为 UTC 作为内部表示。这避免了应用程序的不同层/层之间的各种混淆。

它并不是您特定问题的真正解决方案，但也许需要考虑一些可能会导致问题的解决方案。

# excel - 在 excel 公式中反转域文本（拆分、反向数组、连接）

> ID：11686904
> 
> 赞同：2
> 
> 时间：2012-07-27T11:31:26.483
> 
> 标签：excel

假设我在 excel 中有一个带有域名的字段，我想颠倒子域、域和 tld 的顺序，以便进行排序。例如：

“my.sub.domain.example.org”变成“org.example.domain.sub.my”

你会如何在excel中做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-27T12:16:49.540

我不确定你将如何使用工作表函数来完成它，创建一个函数来为你做这件事要容易得多。

如果您打开 VBA 编辑器，插入一个新模块并粘贴以下函数，您可以在工作表上使用它。

```
Public Function Reverse(ByVal Expression As String, ByVal Delimiter As String) As String
Dim Data() As String
Dim Result As String
Dim Index As Integer

    Result = ""
    Data = Split(Expression, Delimiter)
    Index = UBound(Data)

    Result = Data(Index)

    Do
        Index = Index - 1
        Result = Result & Delimiter & Data(Index)
    Loop While Index > 0

    Reverse = Result

End Function 
```

例子

```
A1 ="my.example.site.tld"
A2 ="=Reverse(A1,".")"
A2=="tld.site.example.my" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T13:04:28.800

使用带有句点分隔符的列的文本。然后您可以使用 =concatenate(...) 或 &（串联操作数）按照您想要的顺序和格式将它们拼接在一起。

（但 NickSlash 发布的 VBA 答案很好，这是以防万一您想要非 VBA）

# javascript - 使用 html a 标签发送帖 子数据

> ID：11686905
> 
> 赞同：-1
> 
> 时间：2012-07-27T11:31:33.067
> 
> 标签：javascript, html, cakephp, postdata

我想使用 html 标签发送 POST 数据。我知道除非我编写脚本，否则无法做到这一点。但是我试过了，但无法让它工作。

```
<a class="test" onClick="assign()"><img src='<?php echo $accounts[$i]['Account']['image']; ?>' /> <?php echo $accounts[$i]['Account']['screen_name']; ?></a> 
```

我尝试使用这个：

```
function assign(){ 
            $.post("/Accounts/index", 
            { data: "test" 

            });
        } 
```

我也试过这个：

```
$(document).ready(function(){

            $(".test").click(function(){

                $.post("/accounts/index", 
                { data: "test"

                });
            });

        }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T11:47:04.077

尝试这个 ：

```
$(".test").click(function () {
    $.ajax({ url: 'http://.....your path...../accounts/index',
        data: {test:1},
        type: 'post',
        success: function(output) {
            //your code
                 }
            }); 
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T11:36:32.400

通过像这样返回 false 来防止锚点的默认点击操作可能会有所帮助：

```
<a class="test" onClick="assign(); return false;"> ... 
```

或者像这样：

```
...
$(".test").click(function(){
    ...
    return false;
}); 
```

# php - 按索引访问 POST 数据

> ID：11686906
> 
> 赞同：-1
> 
> 时间：2012-07-27T11:31:33.763
> 
> 标签：php, post, loops

有没有办法通过索引访问 POST 数据，而不是通过键访问它？我希望以下代码可以工作：

```
for($x = 0; $x < count($_POST); $x++)
    echo $x . ": " . $_POST[$x]; 
```

（是的，我知道循环中的计数不好，只是为了简单起见）

问题是显然我不能通过索引访问 $_POST 变量，它必须通过键访问。我不能使用键的原因是因为我将有可变的表单数据，所以在 POST 中可能或多或少，所以我需要能够循环通过可变数量的键，具有变量名称。

任何帮助表示赞赏！

编辑：澄清一下，我很困惑，因为我之前假设 PHP 数组的行为几乎像 C++ 枚举。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-27T11:33:53.953

> 有没有办法通过索引访问 POST 数据，而不是通过键访问它？

不，它没有数字索引。

> 我不能使用键的原因是因为我将有可变的表单数据，所以在 POST 中可能或多或少，所以我需要能够循环通过可变数量的键，具有变量名称。

您可以遍历关联数组。请参阅 的文档[`foreach`](http://uk.php.net/manual/en/control-structures.foreach.php)。

```
foreach (array_expression as $key => $value)
  statement 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T11:43:23.310

在技​​术上是可能的，虽然`foreach`是优越的：

```
$postVals = array_value($_POST);
$postCount = count($_POST);
for($x = 0; $x < $postCount; $x++)
    echo $x . ": " . $postVals[$x]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-27T11:33:14.333

使用 foreach() 代替，它也适用于数值数组。

```
foreach ($_POST as $key=>$val)
    echo sprintf("%s: %s\n", $key, $val); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-27T11:34:03.943

为什么不只使用[foreach](http://www.php.net/manual/en/control-structures.foreach.php)

```
foreach ($_POST as $key => $value) {
} 
```

?

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-27T11:34:30.547

```
foreach($_POST as $key=>$value) {
    echo $key. ":" .$value;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-27T11:34:39.983

索引和键是一回事。键或者是一个数字（例如`$_POST[0]`）或者它是一个字符串（例如`$_POST['foo']`）。不能两者兼而有之。您无法`$_POST['foo']`通过`$_POST[0]`.

# gnuplot - gnuplot 函数中数据类型的条件

> ID：11686920
> 
> 赞同：1
> 
> 时间：2012-07-27T11:32:35.317
> 
> 标签：gnuplot

我想定义一个函数，它根据 val 是字符串还是数值返回字符串 "NaN" 或 sprintf("%g",val) 。最初我试图测试是否定义了 val （使用 gnuplot “exists”函数），但似乎我无法将任何未定义的变量传递给函数（在评估函数之前发出错误）。因此：有没有办法在函数内部测试参数是字符串还是数字？

我搜索了一个函数 isstring ，我可以以某种方式使用它

```
myfunc(val)=(isstring(val)?"NaN":sprintf("%g",val)) 
```

目标是在未定义变量的情况下输出变量值而不冒错误的风险。但是，如果我想要一个用于许多变量的紧凑代码，我需要它作为一个函数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T13:15:23.497

Gnuplot 并不具备许多其他语言所具备的自省能力。事实上，它对待字符串和数字（​​至少是整数）非常相似：

```
print "1"+2  #prints 3
a=1
print "foo".a  #prints foo1 
```

我不确定这是如何在内部实现的。但是，您要开始工作非常棘手。

实际上，我认为您的第一次尝试（检查变量是否存在）更明智，因为在 gnuplot 中进行类型检查是不可能的*。您可以将变量名称作为字符串传递给函数，但问题是您似乎没有该值的句柄。一切似乎都丢失了——但是等等，gnuplot 有一个`eval`语句，当给定一个字符串时，它会评估它。这看起来很棒！不幸的是，它是一个语句，而不是一个函数（所以它不能在函数中使用——argv！）。我能想到的最佳解决方案是编写一个函数，该函数返回一个可以使用`eval`. 开始：

```
def exists_func(result,var)=sprintf("%s=exists('%s')?sprintf('%g',var):'NaN'",result,var,var) 
```

现在当你想使用它时，你只需在它前面加上`eval`

```
a=3
eval exists_func("my_true_result","a")
print my_true_result #3
eval exists_func("my_false_result","b")
print my_false_result #NaN 
```

这有点不合时宜。在大多数编程语言中，您可能想要执行以下操作：

```
my_true_result=exists_func(a) 
```

但是，唉，我不知道如何使该表格起作用。

当然，同样的事情总是与`eval`. 不要将此函数与不受信任的字符串一起使用。

[*我实际上不知道这是不可能的，但我一直无法让它工作]

**编辑**

针对您对上述问题的评论，我认为这样的功能会更直观一些：

```
def fmt(x)=(x==x)?sprintf("%g",x):"NaN" 
```

使用这个函数，你的“sentinal/default”值应该是`NaN`而不是`"undefined"`，但看起来这应该不会有太大的不同......（真的，如果你愿意而`"nan"`不是根本`"NaN"`不需要这个函数——`sprintf`就可以了。（请注意，这是有效的，因为根据 IEEE，`NaN`它不等于任何东西（甚至它本身））。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T12:18:57.133

这些天你用 gnuplot 帮了我很多。我想回馈你一些东西，因为我找到了一个检查变量是否为数字的解决方案。这有助于确定可以在其上使用哪些运算符（例如 == 用于数字，eq 用于字符串）。

解决方案不是很简单，但它确实有效。它将 gnuplot 的打印命令重定向到一个临时文件，将变量写入文件并使用(<> 是伪代码)`print myvar`评估文件的第一行。`system("perl -e '<isnumeric(line#1 in temp file)?>' ")`让我知道是否有改进的空间，让我听听您的建议！

示例： myvar 是一个浮点数。任何整数（1 或“1”）或字符串值（“*”）也可以！

```
myvar = -2.555  
 # create temporary file for checking if variables are numeric  
Int_tmpfle = "tmp_isnumeric_check"  
 # redirect print output into temp file (existing file is overwritten)  
set print Int_tmpfle    
 # save variable's value to file  
print myvar             
 # check if file is numeric with Perl's 'looks_like_number' function   
isnumeric = system("perl -e 'use Scalar::Util qw(looks_like_number); \  
open(FLE,".Int_tmpfle."); $line = < FLE >; \  
if (looks_like_number($line) > 0) {print qq(y)} ' ")  
 # reset print output to < STDOUT> (terminal)  
set print "-"           
 # make sure to use "," when printing string and numeric values  
if (isnumeric eq "y") {print myvar," is numeric."} else {print myvar," is not numeric."} 
```

# php - Symfony2.1 映射错误：class_parents()

> ID：11686922
> 
> 赞同：4
> 
> 时间：2012-07-27T11:32:43.957
> 
> 标签：php, orm, doctrine, symfony-2.1

我在尝试使用 Symfony2.1 项目中的 Doctrine2 从表（通过实体）获取数据时遇到问题。这是我收到错误的控制器：

```
/**
 * Country list
 */
public function countrylistAction()
{
    $em = $this->getDoctrine()->getManager();
    $countryList = $em->getRepository('ProjectBaseBundle:SYS_TCountry')
        ->findAll();

    $serializer = new Serializer(array(new GetSetMethodNormalizer()),
        array('json' => new JsonEncoder()));

    return new Response($serializer->serialize($countryList, 'json'));
} 
```

实体：

```
<?php

namespace Company\Project\BaseBundle\Entity;

use Doctrine\ORM\Mapping as ORM;
use Symfony\Component\Validator\Constraints as Assert;

/**
 * @ORM\Entity
 * @ORM\Table(name="SYS_TCountry")
 */
class SYS_TCountry
{
    /**
     * @ORM\Id
     * @ORM\Column(type="string", length=3, nullable=false)
     * @var string
     */
    protected $idcountry;

    /**
     * @ORM\Column(type="string", length=75, nullable=false)
     * @Assert\NotBlank()
     * @var string
     */
    protected $name;

    ....

    public function getIdcountry()              { return $this->idcountry; }
    public function getName()                   { return $this->name; }
    public function getA2()                     { return $this->a2; }
    public function getA3()                     { return $this->a3; }
    public function getIdstatus()               { return $this->idstatus; }
    public function setIdcountry($idcountry)    { $this->idcountry = $idcountry; }
    public function setName($name)              { $this->name = $name; }
    public function setA2($a2)                  { $this->a2 = $a2; }
    public function setA3($a3)                  { $this->a3 = $a3; }
    public function setIdstatus($idstatus)      { $this->idstatus = $idstatus; }

    public function __toString()                { return $this->idcountry; }

} 
```

配置.yml：

```
# Doctrine Configuration
doctrine:
    dbal:
        driver:   %database_driver%
        host:     %database_host%
        port:     %database_port%
        dbname:   %database_name%
        user:     %database_user%
        password: %database_password%
        charset:  UTF8

    orm:
        auto_generate_proxy_classes: %kernel.debug%
        auto_mapping: true 
```

这是错误：

```
Warning: class_parents(): 
Class Company\Project\BaseBundle\Entity\SYS_TCountry does not exist and could not be loaded in 
/var/www/project/src/vendor/doctrine/common/lib/Doctrine/Common/Persistence/Mapping/RuntimeReflectionService.php line 40 
```

这很奇怪，因为正如 Doctrine 在控制台中所说，映射已正确完成：我测试它执行*php app/console 学说：映射：信息*：

```
[OK]   Company\Project\BaseBundle\Entity\SYS_TCountry 
```

如果我在控制台中执行查询一切正常 - > app/console 学说：查询：sql 'SELECT * FROM SYS_TCountry'，返回结果。

我不知道使用**Symfony2.1**是否必须配置与 2.0 版本不同的东西，但似乎相同，因为映射是 Doctrine 责任。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-27T15:52:00.000

Symfony 遵循 PSR-0 文件名标准。除其他外，这意味着如果您在类名中使用下划线，则在决定您的类应该放在哪里时，它将用目录分隔符替换它，如下所示：

```
\namespace\package\Class_Name => /path/to/project/lib/vendor/namespace/package/Class/Name.php 
```

所以，如果你有一个名为 SYS_TCountry 的类，它会期望在

```
Company/Project/BaseBundle/Entity/SYS/TCountry.php 
```

代替

```
Company/Project/BaseBundle/Entity/SYS_TCountry.php 
```

我认为您最好的解决方案是将文件名和类名更改为 SYSTCountry。您不需要更改表名。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T15:38:39.443

您的类实体名称不符合[`PSR-0`](https://github.com/php-fig/fig-standards/blob/master/accepted/PSR-0.md)导致加载错误。如果您将实体重命名为`SYSTCountry`一切都会正常工作！

**编辑：**默认 Symfony2 和 Doctrine 自动加载器**是** `PSR-0`兼容的。

# rmi - 将 Glassfish 与 IIOP 结合使用时的完整协议层次结构是什么

> ID：11686925
> 
> 赞同：1
> 
> 时间：2012-07-27T11:32:52.070
> 
> 标签：rmi, corba, iiop, glassfish-2.x

设置是**Glassfish 2.1.1**和 Java 独立客户端。通过**IIOP**进行连接。我们的客户在网络上产生了大量的流量，我正试图找出这些流量的来源。

据我了解，协议层次结构应如下所示

```
Ethernet -> IP -> TCP -> GIOP -> CDR 
```

直到 GIOP，这是我在 Wireshark 中看到的，但 GIOP 消息的有效负载尚不清楚。

不幸的是，Wireshark 没有剖析 GIOP-Messages 的有效负载。我认为 GIOP 消息应该包含用 CORBA CDR 序列化的 Java 对象，因为那是 CORBA 序列化。（毕竟对于非 Java 客户端，我必须生成 IDL，所以 CDR 应该在任何地方使用）。

我在 Wireshark 中看到的是很多很多

```
XRMI:java.util.Collections\U0024SynchronizedCollection: 
```

接着是一个十六进制字符串和几个字节的二进制数据，然后是 XRMI:.....

从这里我想它是 RMI，我在 IIOP 上有 RMI，给了我

```
Ethernet -> IP -> TCP -> GIOP -> RMI -> Java Serialization 
```

但是，如果 GIOP 有效负载是 RMI，那么 CDR 适合哪里。

**如何解释 GIOP 消息的有效负载，在哪里可以找到 RMI over IIOP 的规范？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T22:04:32.223

如上所述，基于 IIOP 的 RMI 只是基于 GIOP 的 CDR。它不是一个不同的协议，它不使用 Java 序列化。它的全部目的是与 CORBA 兼容。

# facebook-c#-sdk - 需要帮助找出错误“代码无效或过期”

> ID：11686933
> 
> 赞同：0
> 
> 时间：2012-07-27T11:33:16.543
> 
> 标签：facebook-c#-sdk

我正在使用 SDK 中的 6.0.10.0 版 Facebook.dll。我们正在测试我们的应用程序，我的一个用户无法登录。用户在使用 Chrome 的 iMac 上。

我使用的是服务器端流程，根本不使用 Facebook Javascript SDK。

这是我用来从 Facebook 检索数据的服务器端代码片段...（此代码直接来自某处的示例，因此归功于该作者:-)）

```
var fbClient = new FacebookClient();
        var oauthResult = fbClient.ParseOAuthCallbackUrl(pRequestUri);

        string accessToken = null;
        DateTime expires = DateTime.Now;       

        // Exchange the code for an access token
        dynamic result = fbClient.Get("/oauth/access_token", new
        {
            client_id = ConfigurationManager.AppSettings["FacebookAppId"],
            redirect_uri = pRedirectUri.AbsoluteUri,
            client_secret = ConfigurationManager.AppSettings["FacebookAppSecret"],
            code = oauthResult.Code,
        });
        accessToken = result.access_token;
        expires = DateTime.UtcNow.AddSeconds(Convert.ToDouble(result.expires));

        // Get the user's profile information
        dynamic me = fbClient.Get("/me",
        new
        {
            fields = "first_name,last_name,email,name",
            access_token = accessToken
        });

        // Read the Facebook user values
        string sfacebookId = me.id;
        string firstName = me.first_name;
        string lastName = me.last_name;
        string email = me.email; 
```

这是我的日志中异常的详细信息。

```
(OAuthException - #100) Code was invalid or expired. 

This may be because the user logged out or may be due to a system error.

source="Facebook" detail="Facebook.FacebookOAuthException: (OAuthException - #100) Code  was invalid or expired. This may be because the user logged out or may be due to a system error.

Stack Trace:

at Facebook.FacebookClient.ProcessResponse(HttpHelper httpHelper, String responseString, Type resultType, Boolean containsEtag, IList`1 batchEtags)

at Facebook.FacebookClient.Api(HttpMethod httpMethod, String path, Object parameters, Type resultType)   

at Facebook.FacebookClient.Get(String path, Object parameters) 
```

从 Facebook 返回的查询字符串包含参数代码，并且它有一个值。

从堆栈跟踪中很容易看出，我的代码中的第一个 .Get() 方法调用最终调用了引发错误的 .ProcessResponse() 方法。

不幸的是，我搜索的所有地方都在谈论如何处理过期的访问令牌。

就我而言，我什至还没有检索到访问令牌，这是我的代码过期或无效。如何申请新代码？

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T02:20:03.530

我永远无法让服务器端流程为我的所有用户工作，所以我继续并切换到 FB Javascript SDK，它现在正在为我工​​作。

# java - 如何在挥杆中将鼠标指针更改为手指指针？

> ID：11686938
> 
> 赞同：22
> 
> 时间：2012-07-27T11:33:47.937
> 
> 标签：java, swing, mouseover, jlabel

在 html 中，当我们创建一个超链接并指向它时，它会自动变为手指指针。

所以我想知道我们能否在 java swings 中实现同样的效果。假设我有一个标签点击它会弹出一个新表单。但是我希望当用户指向标签时它应该变成手指指针，表明如果点击它会弹出一些东西。这样我们可以区分我猜想在表单上带有普通标签的那个标签:)。

但是如何做这样的事情呢？

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2012-07-27T11:38:02.837

您可以使用以下代码将 JLabel 的光标设置为[Cursor.HAND_CURSOR ：](http://download.oracle.com/javase/6/docs/api/java/awt/Cursor.html#HAND_CURSOR)

```
JLabel label = new JLabel("https://stackoverflow.com");
label.setCursor(Cursor.getPredefinedCursor(Cursor.HAND_CURSOR)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T11:47:27.497

如前所述，您希望`setCursor()`在 JLabel 上调用该方法并将其设置`Cursor.Hand_CURSOR`为更进一步，您还可以在文本下划线以使其成为类似于 HTML 的链接：)：

```
import java.awt.Color;
import java.awt.Cursor;
import java.awt.Desktop;
import java.awt.Graphics;
import java.awt.Insets;
import java.awt.event.MouseAdapter;
import java.awt.event.MouseEvent;
import java.net.URI;
import javax.swing.JLabel;

/**
 *
 * @author ludovicianul
 */
public class URLLabel extends JLabel {

    private String url;

    public URLLabel() {
        this("","");
    }

    public URLLabel(String label, String url) {
        super(label);

        this.url = url;
        setForeground(Color.BLUE.darker());
        setCursor(
                new Cursor(Cursor.HAND_CURSOR));
        addMouseListener(
                new URLOpenAdapter());
    }

    public void setURL(String url) {
        this.url = url;
    }

    //this is used to underline the text
    @Override
    protected void paintComponent(Graphics g) {
        super.paintComponent(g);

        g.setColor(Color.blue);

        Insets insets = getInsets();

        int left = insets.left;
        if (getIcon() != null) {
            left += getIcon().getIconWidth() + getIconTextGap();
        }

        g.drawLine(left, getHeight() - 1 - insets.bottom, (int) getPreferredSize().getWidth()
                - insets.right, getHeight() - 1 - insets.bottom);
    }

    private class URLOpenAdapter extends MouseAdapter {

        @Override
        public void mouseClicked(MouseEvent e) {
            if (Desktop.isDesktopSupported()) {
                try {
                    Desktop.getDesktop().browse(new URI(url));
                } catch (Throwable t) {
                    //
                }
            }
        }
    }
} 
```

**参考：**

*   [在 SWING 中创建 URL JLABEL](https://insidecoding.wordpress.com/2011/09/05/creating-a-url-jlabel-in-swing/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-03-09T08:21:37.000

转到按钮或标签的属性并向下滚动，您会找到一列光标，您可以将其更改为手形或任何您想要的

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-02-27T12:53:01.547

ButtonName.SetCursor(新光标(12)); 这个绝对有效！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-01-30T07:37:46.710

**Hossein Mobasher** 的回答很好，我的回答很晚，但我只是想补充一下，你也可以像下面这样使用它。

```
JLabel label = new JLabel("http://stackoverflow.com");
label.setCursor(Cursor.HAND); 
```

它也可以工作，我已经在 J​​ava 1.8 中尝试过

# c++ - 如何从 LLVM 中的 CallInst 获取函数名称？

> ID：11686951
> 
> 赞同：17
> 
> 时间：2012-07-27T11:34:28.857
> 
> 标签：c++, c, llvm, clang

我有一个类型的对象`CallInst`。如何获取被调用函数（又名被调用者）的名称。假设函数被直接调用（即，没有间接函数调用）。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-07-27T11:51:17.910

```
StringRef get_function_name(CallInst *call)
{
    Function *fun = call->getCalledFunction();
    if (fun) // thanks @Anton Korobeynikov
        return fun->getName(); // inherited from llvm::Value
    else
        return StringRef("indirect call");
} 
```

无论如何，这就是文档所暗示的：

*   [调用程序](http://llvm.org/docs/doxygen/html/classllvm_1_1CallInst.html)
    *   [CallInst::getCalledFunction](http://llvm.org/docs/doxygen/html/classllvm_1_1CallInst.html#a0bcd4131e1a1d92215f5385b4e16cd2e)
*   返回[函数](http://llvm.org/docs/doxygen/html/classllvm_1_1Function.html)
*   并返回继承图，直到你看到一个合理的候选者：
    *   [价值](http://llvm.org/docs/doxygen/html/classllvm_1_1Value.html)
    *   [值::getName](http://llvm.org/docs/doxygen/html/classllvm_1_1Value.html#ad452febc1ac0b394876e640ec03ffa38)

# c# - Mouse.OverrideCursor 和 this.Cursor 有什么区别

> ID：11686957
> 
> 赞同：10
> 
> 时间：2012-07-27T11:34:41.430
> 
> 标签：c#, wpf

使用和使用有什么区别

```
Mouse.OverrideCursor = Cursors.Wait 
```

和

```
this.Cursor = Cursors.Wait. 
```

哪一个是正确的？
当我使用`WPF`和`C#`.

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-07-27T11:45:49.597

主要区别在于[`Mouse.OverrideCursor`](http://msdn.microsoft.com/en-us/library/system.windows.input.mouse.overridecursor.aspx)将为整个应用程序设置鼠标光标，而[`this.Cursor`](http://msdn.microsoft.com/en-us/library/system.windows.frameworkelement.cursor.aspx)仅为特定应用程序设置鼠标光标`FrameworkElement`。

所以这将取决于你想做什么。

如果您想为整个应用程序使用显示等待光标`Mouse.OverrideCursor`，但如果您只想在应用程序的特定部分显示等待光标，请使用`this.Cursor`。

# android - 如何以编程方式管理 Gmail 假期回复设置？

> ID：11686959
> 
> 赞同：1
> 
> 时间：2012-07-27T11:34:54.023
> 
> 标签：android, cordova, gmail, google-apps

我正在为一家使用 Gmail 作为公司邮件的公司使用 Phonegap 开发 Gmail 客户端应用程序。

应用程序必须允许该域的用户访问假期响应者设置并进行更新。为此，我使用了[Google Apps Email Settings API](https://developers.google.com/google-apps/email-settings/#manage_vacation-responder_settings)，但没有成功。仅当我使用管理员凭据登录 API 时它才有效。在这种情况下，以下请求成功：

```
GET https://apps-apis.google.com/a/feeds/emailsettings/2.0/{domain name}/{username}/vacation 
```

如果我以非管理员用户身份登录并发出相同的请求，Google 会以错误 403“域无法使用 API”作为响应

是否有任何方法或任何 API 可以自行以编程方式管理非管理员用户的电子邮件设置，无需管理员？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-24T03:11:43.317

只有管​​理员帐户可以更改用户的电子邮件设置 API。用户不能直接使用电子邮件设置 API。我建议您的应用使用创建为具有超级管理员权限的服务帐户的用户帐户。

# html - 由于 CSS 定位导致的性能问题

> ID：11686964
> 
> 赞同：0
> 
> 时间：2012-07-27T11:35:27.553
> 
> 标签：html, css, performance

如果我在我的 HTML 应用程序中使用很多绝对和固定定位，它会导致性能下降吗？

有 HTML 专家吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-27T11:37:38.373

简单的回答，不。

更复杂的答案，不，至少不会慢得多。无论页面决定放置它们的位置还是您明确告诉它放置它们的位置，页面仍然会呈现相同数量的对象。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-27T12:03:36.593

不，不会的！:) 设置位置变量不会影响性能，因为它不会从外部加载任何东西，只是告诉必须放置对象的位置。在某些情况下，它是必须使用的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-14T05:15:15.010

不，它不会。只要保持 DOM 尽可能简单，不要让它太深。并使用最大级别为 3 个限定符的 CSS 选择器。越少越好。

# java - 我可以在 Java 中生成 charAt 吗？

> ID：11686984
> 
> 赞同：-8
> 
> 时间：2012-07-27T11:36:58.977
> 
> 标签：java, string, char

> **可能重复：**
> [我可以在 Java 中乘以 charAt 吗？](https://stackoverflow.com/questions/11686648/can-i-multiply-charat-in-java)

当我编译这个：

```
String s = "25999993654";
System.out.println(s.charAt(0)+s.charAt(1)); 
```

我收到了 100

JAVA文档：

```
the character at the specified index of this string. The first character is at index 0. 
```

我认为我必须将 string 编译为 int ，但我认为这是不必要的工作。任何解决方案或想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-27T11:38:13.350

您需要将其解析为 int

```
Integer.parseInt(String.valueOf(s.charAt(0))) + Integer.parseInt(String.valueOf(s.charAt(1))) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T11:41:12.627

它添加了字符的ascii值。

你可以通过减去 48 来获得 int 等价物。

```
System.out.println((s.charAt(0)-48)+(s.charAt(1)-48)); 
```

或制作一个将ascii转换为数字的函数

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-27T11:43:28.777

假设您希望结果为 2 + 5 = 7：

```
System.out.println(Character.digit(s.charAt(0), 10) + Character.digit(s.charAt(1), 10)); 
```

这是必要的，因为`charAt()`返回一个字符，它基本上是一个 Unicode ID 号。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-27T11:42:47.277

charAt() 的值不是整数而是 ascii 值

[ASCII表](http://www.google.be/imgres?um=1&hl=fr&client=firefox-a&sa=N&rls=org.mozilla%3afr%3aofficial&channel=fflb&biw=1280&bih=921&tbm=isch&tbnid=_mIC2A1Zjxd_9M%3a&imgrefurl=http://www.cdrummond.qc.ca/cegep/informat/Professeurs/Alain/files/ascii.htm&docid=2ZsI_Y12d04qXM&imgurl=http://www.cdrummond.qc.ca/cegep/informat/Professeurs/Alain/images/ASCII1.GIF&w=560&h=600&ei=kn4SULmABIah0QWi_YDACQ&zoom=1&iact=rc&dur=243&sig=101520634645354245171&page=1&tbnh=160&tbnw=149&start=0&ndsp=22&ved=1t:429,r:11,s:0,i:172&tx=44&ty=9)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-27T11:43:55.743

试试这个，

```
String s = "25999993654"; 
System.out.println(Character.getNumericValue(s.charAt(0)) 
         + Character.getNumericValue(s.charAt(1))); 
```

# c# - 如果用户从 ASP.NET MVC 4 中的 url 中删除“/”，如何将“/”附加到 URL

> ID：11686988
> 
> 赞同：1
> 
> 时间：2012-07-27T11:37:01.770
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-routing, url-routing

如果这是我的网址`http://localhost:55070/Server/1-Server`

该页面中的链接将变为

```
http://localhost:55070/Server/2-Instance_12 
```

如果我像这样更改 URL`http://localhost:55070/Server/1-Server/`

链接将是这样的。`http://localhost:55070/Server/1-Server/1-Instance_11`

我总是想要第二类型（http://localhost:55070/Server/1-Server/1-Instance_11/）。如果用户像这样输入 URL `http://localhost:55070/Server/1-Server`，可能会导致一些问题。

如果这是 URL `http://localhost:55070/Server/1-Server`，我如何将 / 附加到这个`http://localhost:55070/Server/1-Server/`. 所以下一个视图中的链接也附加到它上面。

用户可以删除“/”，然后我还需要添加“/”。

这是用于创建 URL 的 Razor。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T11:45:02.947

您可以调整此解决方案[ASP.NET MVC 中的小写 URL 以](https://stackoverflow.com/questions/696673/lower-case-urls-in-asp-net-mvc)在 url 不以 / 结尾时重定向用户

或者像这样把它放在一个 HttpModule 中：

```
public class UrlMessingModule : IHttpModule
{
    public void Init(HttpApplication context)
    {
        context.BeginRequest += Application_BeginRequest;
    }

    public void Dispose() { }

    protected void Application_BeginRequest(object sender, EventArgs e)
    {
        var application = (HttpApplication) sender;
        var request = application.Request;
        var response = application.Response;

        var url = request.Url.AbsolutePath;

        if (url.Length > 1 && !url.EndsWith("/"))
        {
            response.Clear();
            response.Status = "301 Moved Permanently";
            response.StatusCode = (int)HttpStatusCode.MovedPermanently;
            response.AddHeader("Location", url + "/");
            response.End();
        }

    }
} 
```

# macos - 如何在 Mac 上安装 BSD make（同时保留 GNU make）？

> ID：11686989
> 
> 赞同：7
> 
> 时间：2012-07-27T11:37:06.393
> 
> 标签：macos, makefile

关于我的 Mac，我有两个问题`make`：一个是关于安装第二种`make`风格的，第二个是关于如何管理这两种风格的。

1.  我需要`make`在我的 Mac 上安装 BSD，但我不想删除`make`Mac 上的标准 GNU；伯克利是一个特殊项目。尽管有大量用于安装 BSD 的资源，但我仍然无法弄清楚从何处获取以及如何安装该单个程序。做这个的最好方式是什么？

2.  我想我需要把它放进去，而由 Mac OS 开发者工具提供的`/usr/local/bin`GNU将留在它所在的位置。然后我可以管理使用别名调用哪个 make。我仍然是 *nix 新手；这是一个合理的策略还是有更好的方法？`make``/bin`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-27T12:31:34.750

## 安装 BSD make

如果您还没有`/usr/bin/bsdmake`（显然它曾经与 OS X/Xcode 一起提供，但现在没有了），请安装[Homebrew](https://brew.sh/)，然后：

```
brew install bsdmake 
```

## GNU 同居

为避免与 GNU make 冲突，Homebrew 会将 BSD make 安装为`bsdmake`. 在大多数情况下，使用`bsdmake all`. 有时你可能不得不告诉它你的 BSD make 被调用`bsdmake`而不是`make`.

## 移动

如果您出于某种原因决定摆脱 BSD make，Homebrew 将很乐意通过调用以下命令为您清理：

```
brew uninstall bsdmake 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T11:42:26.447

安装[macports](http://www.macports.org/)然后用它来安装[bsdmake](https://trac.macports.org/browser/trunk/dports/devel/bsdmake/Portfile)或[bmake](https://trac.macports.org/browser/trunk/dports/devel/bmake/Portfile)。它们将被安装到`/opt/local/bin`（您必须调整您的`$PATH`内部`~/.profile`以轻松访问它们）。

# android - Android Wi-fi AP 热点 - 无需互联网

> ID：11686992
> 
> 赞同：7
> 
> 时间：2012-07-27T11:37:19.803
> 
> 标签：android, wifi

SO上有很多关于在Android手机上设置AP（热点）的帖子。然而，在所有这些情况下，AP 都是通往外部互联网世界的管道。就我而言，我只想要一个在移动设置上作为 AP 运行的服务器应用程序。并让所有客户端 android 手机连接到它，发送数据并根据需要断开连接。假定没有互联网连接（即没有 gprs/3g 等）。

我的观察：如果我在连接到 GPRS 时设置了一个 wifi AP（通过设置 -> 网络共享和便携式热点），那么另一部 android 手机可以成功连接到这个 AP 并将数据发送到应用程序。但是，如果我禁用 GPRS，即使客户端显示它已连接到 AP，它似乎也无法发送任何数据。似乎外部互联网连接是 AP 模式工作的必要条件。

这种理解正确吗？还是我设置错了？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-12-22T16:50:38.857

我知道我迟到了（迟到了 3 年多：），但我正在寻找解决这个问题的方法，偶然发现了一个简单的解决方法。我正在使用带有 Android 5.0.1 的 Nexus 4，我可以轻松地配置我的手机以将其用作 Android Wi-fi AP 热点 - 无需互联网。只需转到`Settings / Data Usage` 并禁用“`Mobile data`移动”选项卡下的“”选项。然后像往常一样启用 WiFi 热点选项。

我试图让它工作，以便在我上下班时使用 VulnHub.com 的 VirtualBox 机器，该机器要求桥接连接（没有互联网，但使用我的笔记本电脑和手机，我能够做到： )

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T14:06:15.610

我有相同的用例，并且正在寻找与您相同的信息。我检查了一些仅支持 WiFi 的平板电脑甚至没有 HotSpot 设置。即使有它的设备，如果我取出 SIM 卡，我也无法启用 HotSpot（我收到一条消息，要求我先插入 SIM 卡）。

看起来我们的用例不受 Android 支持。相反，HotSpot 功能在设计时并未考虑到我们的用例。我的意思是，如果 Android 手机或平板电脑不提供外部连接，为什么最终用户要在 HotSpot 模式下使用它？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-27T19:22:19.600

我认为您在代码中使用了互联网 IP 而不是本地 IP 进行通信，不是吗？

# flash - 无法双击 Flash 中的视频

> ID：11686993
> 
> 赞同：0
> 
> 时间：2012-07-27T11:37:21.603
> 
> 标签：flash, video, flex4, mouseevent, double-click

我正在使用 Eclipse Helios 使用 MXML 文件构建闪存。我目前正在我的闪存中显示一个视频。我想要的是，当我双击视频时，必须发生一个事件，但不幸的是我无法获得在我的网页上双击视频的事件。这是我的 mxml 代码：

```
 <?xml version="1.0"?>
<!-- Publish Stream mxml -->
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" creationComplete="Initialize();" 
        layout="absolute" paddingLeft="0" paddingTop="0" paddingBottom="0"
        paddingRight="0" >

    <!-- Script for PublishStream -->
    <mx:UIComponent  id="uiComp" visible="true" doubleClickEnabled="true" mouseEnabled="true"/>

    <mx:Script source="test.as"></mx:Script>
</mx:Application> 
```

这是我的文件代码：

```
import mx.controls.Alert;
import flash.net.NetStream;
import flash.net.NetConnection;

private var _video           : Video;
private var _serverName      : String;
private var _connection      : NetConnection;
private var _stream          : NetStream;

public function Initialize():void
{
    _connection = new NetConnection();
    _connection.client = { onBWDone: function():void{ /*Alert.show('onBWDone', 'Alert Box', mx.controls.Alert.OK); */} };
    _connection.objectEncoding = flash.net.ObjectEncoding.AMF0;

    _connection.addEventListener(NetStatusEvent.NET_STATUS, netStatusHandler);
    _connection.connect("server");
    Alert.show("Initialise", 'Alert Box', mx.controls.Alert.OK);
}

//Status event handler
public function netStatusHandler(event:NetStatusEvent):void 
{  
    Alert.show("hanlder", 'Alert Box', mx.controls.Alert.OK);
    _stream = new NetStream(_connection);
    _video = new Video();
    _video.doubleClickEnabled = true;
    _video.addEventListener(MouseEvent.DOUBLE_CLICK, doubleClickHandler);
    _video.attachNetStream(_stream);
     _stream.play("FlickAnimation.flv");
     uiComp.addChild(_video);
}

private function doubleClickHandler(event:MouseEvent):void
{
   Alert.show("Double Clicked", 'Alert Box', mx.controls.Alert.OK);
} 
```

请告诉我为什么我没有双击视频，或者有没有其他方法可以解决这个问题。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T13:46:48.097

您的代码不应该从一开始就编译。视频不是交互式对象，并且没有名称为“doubleClickEnabled”的属性。即没有办法处理视频上的任何鼠标或手势事件（不仅是双击）。您要做的是在视频下方或上方放置一些交互式对象，以便它可以处理点击，或者将视频放入容器中，容器本身就是一个交互式对象。

# sql-server - ASP SQL Server 日期范围和日期时间字段

> ID：11686994
> 
> 赞同：1
> 
> 时间：2012-07-27T11:37:26.410
> 
> 标签：sql-server, asp-classic

我正在使用 Classic ASP 并具有以下 VB 脚本代码

```
From8to14 = date-14
To8to14 = date-8 
```

这设置了两个变量。

今天，这意味着

```
From8to14 = "13/07/2012"
To8to14 = "19/07/2012" 
```

然后，我对 SQL Server 进行了选择查询，并且我想查找 DateMatched 列介于（并包括）这两个日期之间的任何记录

当我声明它时，我在 SQL 中有两个条件；

```
"AND INTRAY.DateMatched >= '"& Year(From8to14) &"-"& Month(From8to14) &"-"& Day(From8to14) &"' " & _
"AND INTRAY.DateMatched <= '"& Year(To8to14) &"-"& Month(To8to14) &"-"& Day(To8to14) &"' " & _ 
```

现在，这不能正常工作，因为 DateMatched 列除了日期之外还包括一个时间，我认为服务器将这些日期解释为当天开始时的午夜？

因此，如果记录的 DateMatched 为“19/07/2012 17:41:22”，则不包含该记录。

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T12:11:18.430

改变

```
To8to14 = date-8 
```

到

```
To8to14 = date-7 
```

然后，您将从第-14 天的午夜到第-7 天的午夜，这将包括第-8 天的所有内容。

Or if you want to be really precise, leave To8to14 as it is, and change the end to

```
... Day(To8to14) &" 23:59:59' 
```

You could also use BETWEEN rather than >= and <=

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T12:16:16.040

Try this.

```
"AND INTRAY.DateMatched >= dateadd(day, datediff(day, 0, getdate())-14, 0)" & _
"AND INTRAY.DateMatched < dateadd(day, datediff(day, 0, getdate())-7, 0)" & _ 
```

# visual-studio-2010 - 如何从 DTE 对象（VS 2010）中获取选定关键字的语法高亮信息？

> ID：11686996
> 
> 赞同：4
> 
> 时间：2012-07-27T11:37:31.007
> 
> 标签：visual-studio-2010, envdte

是否可以获得用于在代码编辑器中突出显示所选符号/关键字的语法配色方案的信息？

我想获取所选关键字的**工具->选项->环境->字体和颜色下显示的信息。**