# StackOverflow 问答 000700000-000700999

# logging - 需要我的错误记录机制的评论评论

> ID：700011
> 
> 赞同：0
> 
> 时间：2009-03-31T04:39:24.910
> 
> 标签：logging, exception-handling

在生产/QA/Dev 的每一次休息中，找到异常的根源是非常关键且耗时的过程。

由于 Web 应用程序处于多用户环境和无状态\异步 (HTTP) 环境中，因此查看 Eventviewer / 日志文件和根本原因最终用户报告的问题确实是一项艰巨的工作；此外，它还取决于最终用户对问题进行详细解释的程度。

我想出了一种创造性的方式来记录异常。哪个使最终用户和开发团队的工作更容易？

我们将按照签名将异常记录到 XML 文件中，并且可以远程处理以查看或报告异常

Error logging类中Static方法的签名如下

*WriteLog（唯一编号、模块名称、优先级、层、字符串自定义消息、堆栈跟踪异常）；*

我知道有许多可重用的异常处理库，但我正在查看的是一个唯一编号，用于跟踪应该显示给最终用户的问题

回复用户：

如果期望处理和消耗异常，则开发人员应向最终用户显示有效的用户友好消息。如果向应用程序层（全局 .asax）抛出任何意外或异常，则响应将被清除，并且 HTML 中的自定义消息将被写回具有唯一 ID 的用户，如下所示

“发生了意外错误，已记录异常以采取进一步措施；请使用生成的#*唯一编号* 与支持团队沟通“</p>

参数详情：

唯一编号：这是为每个异常生成的唯一编号，ErrorLogging 类中的只读（获取）属性，每个异常都是唯一的，这将是*Hour+Minutes+Seconds+Milliseconds*的串联；最初我想使用 GUID，但最终用户很难记住 GUID 来报告问题。

公共字符串 strExceptionID {

```
 Get { 

      return  DateTime.Now.ToString(“HHmmssfff”);

          }    

     } 
```

模块名称：这将是一个带有模块名称的静态枚举变量 Ex：枚举 ModuleName {

```
 Module1, 

    Module2, 

    Module3  }; 
```

优先级：这将是一个带有 Priority 的静态枚举变量，开发人员必须决定优先级，例如它是日期验证失败还是整数格式使用“低”，或者如果它在业务层调用中出现意外则使用“2”。

我认为，如果与 SAP 或 Ariba 的接口失败，则应仅在 DAL 或业务逻辑层或类似的情况下使用 Priority High。例如：枚举优先级{

```
 High =1, 
      Medium =2, 
      Low =3, }; 
```

层 ：

这将是一个带有层 Ex 的静态枚举变量： enum Layer {

```
 Presentation, 
      Business, 
      DataAccess 
            }; 
```

字符串自定义消息：

这是可选参数，由开发人员提供信息来帮助解释原因或空字符串可以传递。

带有堆栈跟踪的异常：这将是 Exception 对象，该对象将在方法内部进一步处理。

在错误日志方法中完成的处理：

该方法还将获取登录的用户 ID 和时间戳并将其写入 XML 文件。

优点：

-> XML Logging 将使我们能够以任何方式处理使用它 -> 可以在浏览器中远程查看异常。-> 易于追踪和发现任何异常。-> 我们可以根据 Module, Priority , Time Stamp , UserID...等搜索、排序异常 -> 我们可以生成报告@ Module level , Layer wise , Priority , Time...</p>

缺点：对 XML 文件的依赖，如果它丢失了所有的异常将被折腾，我们可以通过两种方式克服这个问题；及时将 xml 写入数据库或将其写入事件查看器日志记录之上，因为我们将始终拥有备份。

根据审查意见，我将发布 XML Schema 和 ASPX 页面以查看和搜索错误。

请花时间审查并提供反馈。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-31T06:21:16.850

我对那些在没有真正了解平台开箱即用的功能的情况下重写跟踪 API 的人感到有点不耐烦。所以让我们看看你的 API 调用：

WriteLog（唯一编号、模块名称、优先级、层、字符串自定义消息、堆栈跟踪异常）；

唯一编号：实现添加此唯一编号的 TraceListener（查看 System.Diagnostics），不要让调用代码生成它。

模块名称：堆栈跟踪将提供这种详细信息 - 假设您知道什么代码在哪个模块中。事实上，从故障查找的角度来看，这可能并不重要。

优先级：System.Diagnostics API 提供以下严重级别。信息、警告和错误（以及调试）。现在优先级在旁观者眼中，从发展的角度来看 - 它要么是“嘿，这件事发生了，你可能想知道（信息）”，他“这看起来有点可疑，我们无论如何都可以继续（警告） ”和“哎呀，我坏了（错误）”。

层：这里的模块和错误之间的真正区别是什么？再一次，如果您正确使用 System.Diagnostics，则可以动态添加环境信息，例如发生这种情况的计算机。您不希望依赖开发人员始终如一地执行此操作。

自定义消息：是的 - 这是合理的。对于奖励积分，使其采用格式字符串（实际上 - Trace.TraceError/TraceWarning/TraceInformation 已经这样做了。所以就使用它。

例外：如果您使用 Trace.TraceError (et.al)，那么您可以使用格式字符串。并非每个错误都有异常，因此您不一定需要生成接受它们的 API，只要它们采用格式字符串 - 您可以这样做：

Trace.TraceError("用户提供了以下输入'{0}'。以下异常是：\r\n{1}", userInput, ex);

无论如何 - 我想我的意思是，如果你在 .NET 中编写它，就像它看起来一样 - 花半天时间浏览 System.Diagnostics 文档。您可能会否定编写 API 的需要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-31T05:12:17.967

我有两点意见：

1.  我不喜欢依赖时间戳作为唯一标识符。如果您确定您的网站不会被加载，那没关系，但在重压下，毫秒级的分辨率可能还不够。原因是毫秒计数器的粒度可能大于一。这意味着两个非常接近的调用可能会获得相同的时间戳。不太可能，但为什么要限制自己呢？

2.  向用户提供代码以及人类可读的消息是很好的，但您永远不应该期望用户与您联系并指出错误。如果您正在寻找有关错误的反馈，只需让记录器在发生错误时向您发送一封电子邮件（这意味着您将能够使用真正的唯一标识符，例如 GUID，而不是时间戳）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-31T05:15:13.327

对于 ExceptionID，您实际上可能最好使用 GUID。日期格式不会是唯一的，因为它每天都会滚动，而且，您可能会在同一毫秒内收到多个错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-31T05:23:18.253

强调之前评论者的观点：如果存在由竞争条件导致的故障，您**可能会在同一毫秒内获得多个异常。**

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-31T13:05:32.497

如果这是一个 ASP.NET 应用程序，那么您应该查看[ASP.NET Health Monitoring](http://msdn.microsoft.com/en-us/library/bb398933.aspx)。即使在默认情况下，它也会在事件日志中发出详细的跟踪信息。您可以将其配置为在 XML 文件中生成相同的输出，并添加您自己的跟踪。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-03T19:54:22.883

发送包含错误消息和错误号的电子邮件是一种更有效的方式，不能指望最终用户报告他们发现的每一个失败。但是电子邮件会失败。SAP 或 Ariba 很容易在某个时候发送电子邮件。

# project-management - 将生产力提高到每人/天 1 个错误修正

> ID：700013
> 
> 赞同：4
> 
> 时间：2009-03-31T04:42:39.957
> 
> 标签：project-management, bug-tracking, maintenance

我是一名高级软件工程师，几个月前我被要求帮助协调错误更正。项目经理（非技术人员）给了我一个目标，将生产力提高到每人/天 1 个错误修正。这是一个真正的挑战，我想知道其他开发人员/经理可能会采取哪些措施来提高错误纠正率。

在这种情况下起作用的一些因素：

*   团队地理分布（欧洲、亚洲、澳大利亚），每个区域有 10-20 名开发人员
*   大型代码库，我不太熟悉，因为我在公司只工作了 9 个月
*   只有最缺乏经验的开发人员被分配到错误更正，最有能力的开发人员正在致力于改进
*   我们遵循敏捷，所以我们使用源代码控制、持续集成、错误数据库，项目有新工作的时间表和规范，我们有测试人员并进行可用性测试
*   我们的代码依赖于许多内部和第三方组件/库
*   项目经理有一些旧的错误纠正指标，显示每人/天纠正 0.7 个错误。我担心的是，这是基于一组经验丰富的开发人员开发原型，纠正他们自己编写的代码中的错误。现在我正在协调一个不熟悉代码的开发人员团队，并且错误来自验证团队。

阅读前几个答案后的更多信息：

*   我试图反对使用错误纠正的生产力指标，但这种方法并没有走得太远
*   所有错误都按优先级排序 (1-5)，包括严重性 (1-5) 并标记有其他信息（例如，被另一个错误阻止、崩溃、不可重现等）
*   大多数错误在纠正时都会编写单元测试用例
*   如果可能，将特定代码区域中的错误分配给熟悉该区域的人员
*   按团队跟踪错误纠正率，并保留纠正历史记录
*   在日常站立会议中，我试图通过要求阻止问题并解决它们来让人们感动
*   所有新代码都是用单元测试编写的
*   是的，我一直在尽我最大的努力通过各种方式提高生产力指标——关闭旧的不相关的错误，创建和纠正错误，否则这些问题将在没有错误报告的情况下解决
*   我已经开发了直接访问 bug 数据库的 python 脚本，以自动化 bug 管理和报告创建的一些平凡方面

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-31T04:51:35.257

虽然错误纠正率在某些情况下是一个有效的指标，但在其他情况下它们可能会产生误导。有些错误显然比其他错误更难修复。

您可能想尝试的想法包括将错误分类到不同的类别。基于诸如修复难度、对客户的重要性或复杂性等指标进行排序。

在敏捷环境中，您主要专注于编写测试代码。想想他的一个bug的生命周期。您尝试做的第一件事就是复制它。如果您可以针对它编写一个测试用例，您就可以衡量您在修复错误方面的进展情况。这样做将提高错误纠正率。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-31T04:55:21.830

我认为一个好的起点是将错误修复过程系统化。如果您每天的 bug 少于 1，我假设您的代码库很大，并且这些 bug 很难找到/重现。我将从一些分析开始

1) 多长时间了解 bug

2) 找到/复制多长时间

3) 修复了哪些代码（这里有模式吗）

4）修复时，是否添加另一个单元测试

5) 你是否审查发生错误的个人和团队

几个星期这样做将为您提供未来方向的非常好的基础。这也是你的经理应该接受的一种专业方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-31T04:59:48.950

在修复错误的经验丰富的开发人员和创建增强功能的初级开发人员之间切换会很有帮助，但这在您的情况下听起来是不可能的。

尽量不要让人们陷入困境。如果有人遇到问题并且无处可去，请鼓励他们寻求帮助并走上正确的道路。

根据上面的海报，让经验丰富的开发人员编写测试用例以进行增强。（当然，这使得修复错误变得更加困难）

您总是可以故意添加错误并修复它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-31T05:03:28.817

您可以询问开发人员他们认为错误修复周期中最耗时的部分是什么，并思考如何使用这些信息。

他们正在做实际的工作，他们拥有关于瓶颈是什么的最多信息是合理的。

# python - 将数字格式化为字符串

> ID：700016
> 
> 赞同：4
> 
> 时间：2009-03-31T04:42:58.677
> 
> 标签：python, string, integer, format

如何将数字格式化为字符串，使其前面有多个空格？我希望较短的数字 5 在其前面有足够的空格，以便空格加上 5 的长度与 52500 相同。下面的过程有效，但是有内置的方法吗？

```
a = str(52500)
b = str(5)
lengthDiff = len(a) - len(b)
formatted = '%s/%s' % (' '*lengthDiff + b, a)
# formatted looks like:'     5/52500' 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-31T04:49:27.820

[格式运算符](http://docs.python.org/library/stdtypes.html#string-formatting)：

```
>>> "%10d" % 5
'         5'
>>> 
```

使用`*`规范，字段长度可以是一个参数：

```
>>> "%*d" % (10,5)
'         5'
>>> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-31T05:02:34.480

您可以只使用`%*d`格式化程序来提供宽度。`int(math.ceil(math.log(x, 10)))`会给你位数。修饰符使用`*`一个数字，该数字是一个整数，表示要间隔多少个空格。因此，通过执行`'%*d'`% (width, num)`，您可以指定宽度并呈现数字，而无需任何进一步的 python 字符串操作。

这是使用 math.log 确定“outof”数字长度的解决方案。

```
import math
num = 5
outof = 52500
formatted = '%*d/%d' % (int(math.ceil(math.log(outof, 10))), num, outof) 
```

另一种解决方案涉及将 outof 数字转换为字符串并使用 len()，如果您愿意，可以这样做：

```
num = 5
outof = 52500
formatted = '%*d/%d' % (len(str(outof)), num, outof) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-31T05:03:39.067

'%*s/%s' % (len(str(a)), b, a)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-31T04:49:56.523

请参阅[字符串格式化操作](http://docs.python.org/library/stdtypes.html#string-formatting-operations)：

```
s = '%5i' % (5,) 
```

您仍然必须通过包含最大长度来动态构建格式化字符串：

```
fmt = '%%%ii' % (len('52500'),)
s = fmt % (5,) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-31T04:45:57.097

不确定您到底在追求什么，但这看起来很接近：

```
>>> n = 50
>>> print "%5d" % n
   50 
```

如果您想更有活力，请使用以下内容`rjust`：

```
>>> big_number = 52500
>>> n = 50
>>> print ("%d" % n).rjust(len(str(52500)))
   50 
```

甚至：

```
>>> n = 50
>>> width = str(len(str(52500)))
>>> ('%' + width + 'd') % n
'   50' 
```

# javascript - 使用javascript滑动html部分的最佳方法是什么？

> ID：700019
> 
> 赞同：1
> 
> 时间：2009-03-31T04:44:16.960
> 
> 标签：javascript, django

我的 Html 模板中有一个隐藏部分（我正在使用 Django 模板），隐藏部分是一个登录表单，我希望当用户单击一些登录文本（链接）时，隐藏表单的 html 文本应该向下滑动以显示表单。

我觉得这可以用 Javascript 完成！

我正在使用 django，请逐步详细说明如何在我的项目中包含 javascript。

帮助

加思

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-31T07:09:42.430

继续 Travis 的回应；

```
<script type="text/javascript">
  $(document).ready(function() {
    $("#toggleForm").click(function () {
      $("#loginForm").slideToggle("slow");
    });
  });
  </script>
<div id='toggleForm'>Show Login</div>
<div id='loginForm'>
 Your form goes here!
<div> 
```

即 slideToggle() 是你的朋友。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-31T04:52:08.327

我不使用 Django，但我可以告诉你，[JQuery](http://jquery.com/)将完全按照你的意愿行事。您将需要包含 JQuery 库，然后使用 slideDown() 和 slideUp() 函数来显示您的表单。

这是您所追求的粗略示例。查看[JQuery 文档](http://docs.jquery.com/Effects/slideDown#speedcallback)以获取更多信息

```
<script>
    $("#toggleForm").click(function () {
      if ($("#loginForm").is(":hidden")) {
        $("#loginForm").slideDown("slow");
      } else {
        $("#loginForm").slideUp("slow");
      }
    });
</script>

<div id='toggleForm'>Show Login</div>
<div id='loginForm'>
 Your form goes here!
<div> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-31T04:52:14.863

如果您使用的是[jQuery](http://jquery.com)，这样的事情应该可以解决问题

```
$('.login-link').bind('click', function(e) { // bind event handler to click of login link

    $('#login-panel').slideDown(); // slide down the panel
    e.preventDefault(); // stop the link taking you to the js disabled login page

}); 
```

当然，这只是一个起点，因为理想情况下，您希望能够在每次连续单击时上下滑动它。

# visual-c++ - 将任何表单视频转换为 RGB24 媒体

> ID：700027
> 
> 赞同：0
> 
> 时间：2009-03-31T04:47:02.723
> 
> 标签：visual-c++, directshow

如何在 DirectShow + VC++ 中将 YUY2、YUV、RGB565 和更多视频子类型转换为 RGB24 子类型视频

你能理解我的问题吗？

我有一个上游过滤器，其输出为 YUY2 格式，但我需要将其转换为 RGB24 格式。

DirectShow 中是否有任何内置过滤器，或者我们必须通过我的代码对其进行转换。

我已经添加了 ColorSpaceConverter 但它没有与 Smart Tee 输入引脚连接。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-31T04:56:07.197

您的输入引脚应该只接受 RGB24 媒体类型，这样 DirectShow 将自动添加[颜色空间转换过滤器](http://msdn.microsoft.com/en-us/library/aa926076.aspx)并为您提供 RGB 格式的数据。

# java - Java 套接字编程

> ID：700040
> 
> 赞同：2
> 
> 时间：2009-03-31T04:53:22.757
> 
> 标签：java, sockets

## Java Socket 程序不适用于 WAN

我编写了一个 TCP IP 套接字程序，它在我的 LAN 中运行良好。我的一个朋友在班加罗尔，他运行服务器，我用我朋友 IP 的主机名运行客户端。在这种情况下，我的套接字程序不起作用。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-31T06:33:45.790

您说您的程序正在尝试连接到主机 192.168.1.107 端口 46216。

192 前缀指定它是 C 类地址并且是私有的。使您的程序连接到该节点将迫使它保留在本地网络上搜索该节点。您需要找到路由器的 IP 地址（您可以使用[http://whatismyip.org/](http://whatismyip.org/)来查找）。然后进入您的路由器设置并将端口 46216 转发到 192.168.1.107（您的节点），或者更好的是，您的 MAC 地址不会更改（如果您的路由器正在运行 DHCP）。

附带说明一下，硬编码 IP 地址并不好。只需使用文本字段即可避免在更改 IP 时重新分配客户端，因为您很可能拥有来自 ISP 的动态 IP。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-31T04:56:22.250

您运行服务器的朋友很可能位于防火墙或 NAT 后面。确保您使用的是外部 IP 地址，并在必要时使用端口将数据包转发到正确的 IP。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-04-16T15:14:28.163

您提供的 IP 地址似乎是本地地址，而不是公共 Internet 地址。如果您正在寻找 192.xxx，您将无法访问“互联网”，而是被限制在路由器后面。

WhatIsMyIP 是获取公共 IP 地址的好方法，这就是您应该在连接中使用的地址。此外，请务必转发您的程序将使用的所有端口，否则您的路由器可能会过滤流量并仍然会产生问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-31T06:26:00.740

您可以使用[STUNT](http://nutss.gforge.cis.cornell.edu/stunt.php)或其他[NAT Traversal](http://en.wikipedia.org/wiki/NAT_traversal)协议的实现。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-05-14T10:47:43.273

您部署的服务器程序上的计算机 IP 不在您的范围内。192.xxx ip 表示（C 类）它用于本地子网。您需要更改您的网络适配器的 IP 地址，以便您的路由器可以通过互联网路由它。

# iphone - 我应该如何在 iPhone 上做多个动画？

> ID：700042
> 
> 赞同：1
> 
> 时间：2009-03-31T04:54:02.597
> 
> 标签：iphone, core-animation, 2d, quartz-graphics, calayer

我想为一个游戏制作多个部分的动画，并且我想让这些部分朝不同的方向移动，这样我当前为整个视图制作动画的方法将不再有效。

我想知道一次为多个项目设置动画的最佳做法是什么。（注意我在 2d 中渲染，所以我目前对 3d 解决方案不感兴趣。）

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-31T13:23:51.593

一次为多个二维对象设置动画相对容易。有两种方法可以实现：动画 UIView 或动画 CALayers。在我的测试中，我发现在为两者设置动画时性能几乎没有差异（两者似乎都支持在 iPhone 上以 60 FPS 的速度同时移动约 50 个对象）。

为了协调一系列 UIView 的动画，您需要将视图几何的任何更改包装在开始/提交动画块中：

```
[UIView beginAnimations:nil context:NULL];
[UIView setAnimationDuration:ANIMATIONDURATIONINSECONDS];

view1.frame = CGRectMake(newX1, newY1, view1Width, view1Height); 
view2.frame = CGRectMake(newX2, newY2, view2Width, view2Height); 
// Add other views here

[UIView commitAnimations]; 
```

这将在 ANIMATIONDURATIONINSECONDS 秒的持续时间内将两个或多个视图的直线运动协调到它们的新位置。如果您希望视图彼此独立移动，请为每个视图创建单独的动画块。

为了更好地控制您的动画，或创建跨平台的 Mac / iPhone UI 代码，您可能希望使用 Core Animation CALayers。CALayers 默认动画，所以通过设置

```
layer.position = CGPointMake(newX, newY); 
```

您的图层将自动动画到新位置。请注意，默认情况下，图层的位置是相对于其中心的，您可以通过将其 anchorPoint 属性设置为 0,0 来将其更改为正常的原点位置。

您可以使用 CATransaction 来协调图层动画：

```
[CATransaction begin];
[CATransaction setValue:[NSNumber numberWithFloat:ANIMATIONDURATIONINSECONDS] forKey:kCATransactionAnimationDuration];      
layer1.position = CGPointMake(newX1, newY1);
layer2.position = CGPointMake(newX2, newY2);
[CATransaction commit]; 
```

对于更高级的动画，您可以创建 CABasicAnimations 和 CAKeyframeAnimations 并将它们应用到您的图层，以在具有特定时间和加速/减速的复杂路径上移动它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-31T06:17:21.913

你看过 Cocos2D-iphone 项目吗？

我发现它非常易于使用，并且无需您进行大量工作。

[Cocos2D iPhone](http://code.google.com/p/cocos2d-iphone/)

它还做了很多动画，您可以创建可以捆绑在一起的动画序列。

# configuration - MSTest 同时执行我的所有测试会中断测试 - 该怎么办

> ID：700043
> 
> 赞同：24
> 
> 时间：2009-03-31T04:54:49.977
> 
> 标签：configuration, mstest

好吧，这很烦人。

MSTest 同时执行我的所有测试，这导致其中一些测试失败。不，这不是因为我的测试很脆弱并且容易受到构建顺序的影响，而是因为这是一个演示项目，我在其中使用从文件运行的 Db4o 对象数据库。

所以我有几个 DataAccess 测试检查我的存储库是否正常工作并且繁荣，MSTest 爆炸了。由于它尝试同时运行所有测试，因此当测试尝试访问数据库文件而其他测试正在使用它时会出错。

谁能想到一个快速的方法来解决这个问题？我不想放弃 MSTest（好吧，我愿意，但这是另一个故事），而且我肯定不想运行一个成熟的数据库服务，所以我会采取任何方式强制 MSTest 不要同时运行或与打开文件。

有人有想法么？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-03-31T05:19:41.460

您可能想尝试使用[Monitor](http://msdn.microsoft.com/en-us/library/system.threading.monitor.aspx)并输入 TestInitialize 并退出 TestCleanup。如果您的测试类都依赖于外部文件，那么您需要为所有这些类使用一个锁对象。

```
public static class LockClass
{
    public static object LockObject = new object();
}

...

[TestInitialize]
public void TestSetup()
{
     Monitor.Enter(LockClass.LockObject);
}

[TestCleanup]
public void TestCleanup()
{
     Monitor.Exit(LockClass.LockObject);
} 
```

这应该强制您的所有测试连续运行，并且只要您的所有测试通过/失败，它们就应该运行。但是，如果它们中的任何一个引发意外异常，那么所有其余的都将挂起，因为退出代码不会为爆炸的测试运行。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-05-17T13:28:35.753

我尝试过以这种方式使用锁。然而，我所经历的是，VS2010默认情况下**不会**并行执行测试，而是在单个线程中按顺序执行它们。（但是可以打开并行执行。但这并不能完全防止问题发生）

我发现非常令人不安的是，顺序执行将以任意顺序发生，甚至跨测试类！

例如，执行顺序可能如下所示：

*   A 类 - TestInitialize：将建立锁定
*   A 类 - TestMethod1：将执行，OK
*   B类-TestInitialize：将建立锁定=>线程将被阻止=>完整的单元测试将被阻止！原因是没有其他线程可以继续执行 A 类的方法。因此永远不会到达 Montor.Exit()。

我不明白为什么 MS 会这样做。其他 UnitTest 框架（例如 JUnit）按类执行测试方法。否则会有一些 SetUp/TearDown 方法的交错，这会导致描述的混乱......

有没有人知道如何防止 MSTest 在测试类之间跳转？（目前我使用 Resharpers 测试运行器，它的行为符合预期，在继续下一个类之前执行一个类的所有测试方法）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-11-01T21:19:23.897

使用有序测试

[http://msdn.microsoft.com/en-us/library/ms182630(v=VS.90).aspx](http://msdn.microsoft.com/en-us/library/ms182630(v=VS.90).aspx)

# asp.net - UserControl 文本框不会保持状态

> ID：700045
> 
> 赞同：0
> 
> 时间：2009-03-31T04:55:10.270
> 
> 标签：asp.net, user-controls, state

我有一个非常简单的用户控件，基本上是一个文本框和一个标签，其目的是在彼此之间切换。该控件在页面的`Page_Load event`. 在 UserControl 的`Page_Load`事件中，我调用 Toggle() 函数，该函数显示或隐藏适当的控件，并分别基于布尔 Editable 属性和字符串 Text 属性设置其文本。

这是我的 Toggle() 方法（记住 Editable 和 Text 是公共属性）：

```
Public Sub Toggle()
    If Editable Then
        txtText.Visible = True
        lblText.Visible = False
        txtText.Text = Text
        txtText.CssClass = TextboxCSSClass
    Else
        txtText.Visible = False
        lblText.Visible = True
        lblText.Text = Text
        lblText.CssClass = LabelCSSClass
    End If
End Sub 
```

我的问题也很简单：当页面上的按钮调用控件的 Toggle() 方法时，切换工作正常，但文本消失了！我已经用它旁边的一个普通的未绑定文本框尝试了这个，并且文本框保持它的文本值就好了。有什么我想念的吗？

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-31T05:04:21.623

当您将控件的 visible 属性设置为 False 时，它​​将不会以 Html 呈现，因此它不能在页面之间携带状态。而是考虑使用 MultiView 控件

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-31T15:45:49.193

**更新：**有关评论的更多信息。

如果您禁用了视图状态，并且为文本框设置了文本，则该文本是输入控件中的文本。当您尝试了解给定文本框的值是否已更改时，这可能会在不常见的情况下影响您。

上面的标签是不同的，因为它不是输入控件。在禁用视图状态的情况下，如果您没有在每个请求上设置文本，它将显示初始值（试试看）。视图状态自动允许在控件的回发中保留信息。

就像它发生在标签上一样，它也发生在你的用户控件上。如果您更改设置器以便直接设置两个控件文本，如果您使用视图状态，它将保留内部控件中的值。如果将其关闭，则标签的行为与文本框的行为不同。

另请注意，关闭视图状态也会影响您的可见配置。我经常关闭视图状态，但您可能有一个场景，您真的希望在回发中保留控件信息。关闭视图状态时，您需要确保始终配置控件，而不仅仅是在 !IsPostBack 时。

请注意，如果您跟踪应该是可见的内容和代码中的文本，那么您可以关闭内部控件的视图状态（假设您没有为它们分配任何其他属性）。

* * *

**初步答案：**

您正在将 Text 属性的当前值分配给标签/文本框。如果您没有在当前请求中设置该值，则它具有其默认值，因此您将获得空文本。

您可以将视图状态中的值保存为（c# 语法）：

```
public string Text
{
   get
   {
      return (string) ViewState["MyText"];
   }
   set
   {
      ViewState["MyText"] = value;
   }
} 
```

附言。这不是唯一的方法。如果切换没有设置文本，但是您在设置器上对两个控件进行了设置，那么它们将保留这些值（只要您在跟踪视图状态后分配用户控件的 Text 属性，就像在页面加载）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-31T17:51:52.620

我想到了！我为自己愚蠢而道歉。这就是我做错的事情：我的文本属性的获取/设置被存储在一个私有成员中。这意味着当对文本进行更新时，它不知道，因为它没有连接到文本框。相反，我做了以下事情：

```
Public Property Text() As String
    Get
        Return txtText.Text
    End Get
    Set(ByVal value As String)
        txtText.Text = value
    End Set
End Property 
```

在我的 Page_Load 事件中：

```
Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
    If Not IsPostBack Then
        lblText.Text = Text
        Toggle()
    End If
End Sub 
```

现在它工作正常！感谢那些让我走上正确道路的人！:)

# php - jQuery 不断 ping Ajax 响应

> ID：700048
> 
> 赞同：5
> 
> 时间：2009-03-31T04:55:47.993
> 
> 标签：php, jquery, ajax

如何使用 jQuery 不断运行 PHP 脚本并每秒获取响应，并将鼠标上的少量数据发送到同一个脚本？

我真的必须添加一些随机扩展才能让这样一个简单的计时器工作吗？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-03-31T05:41:04.920

> 迭代是人类，递归是神圣的。
> [-L。彼得·多伊奇](http://www.devtopics.com/101-great-computer-programming-quotes/)

```
var req = function () {
    $.ajax({
        url : 'http://example.com/yourscript.php',
        complete : function () {
            req();
        }
    });
};
req(); 
```

万一不是很明显，上面的请求会在前一个请求完成后立即发出一个新请求，永远。您还可以在请求之间设置 1 秒延迟，如下所示：

```
var req = function () {
    $.ajax({
        url : 'http://example.com/yourscript.php',
        complete : function () {
            setTimeout(function () {
                req();
            }, 1000);
        }
    });
};
req(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-31T05:34:21.753

```
function doAjax(data){
    $.ajax({
    type: "POST",
    data: data,
    url: 'http://example.com/yourscript.php',
  });
}
// Set interval
setInterval('doAjax()',1000);
// Set event handler
$(document).mousedown(function(){
  doAjax({key: 'value'});
}); 
```

如果您不想捕获整个页面上的点击，您可以将 $(document) 替换为实际元素。

如果您正在寻找回调等，您可以使用 ajax 函数做更多事情：http: [//docs.jquery.com/Ajax/jQuery.ajax](http://docs.jquery.com/Ajax/jQuery.ajax)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-02-12T06:59:01.483

//您需要的所有ping：

```
ping.pushCallback(function() { YourCallback(); });
$.data(document.body, 'data_ping', ping); 
```

//------------------------------------------------ - - - //脚本

```
$.ping = function(url, options) {
    this.url = url;
    this.options = $.extend({
        delay: 2000,
        dataType: 'json',
        timeout: 10000,
        data: {},
        callbacks: []
    }, options);
    this.queue();
};
$.ping.prototype = {
    queue: function() { var self = this;
        setTimeout(function() {
            self.send();
        }, self.options.delay);
    },
    send: function() { var self = this;
        $.ajax(self.url, {
            success: function(data) {
                for (var i in self.options.callbacks) {
                    self.options.callbacks[i](data);
                }
            },
            complete: function() {
                self.queue();
            },
            dataType: self.options.dataType,
            data: self.options.data,
            type: "GET",
            cache: false,
            timeout: self.options.timeout
        });
    },
    setData: function(key, value) { 
        this.options.data[key] = value;
    },
    pushCallback: function(callback) {
        this.options.callbacks.push(callback);
    }
}; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-31T05:16:29.283

您不必添加一些随机扩展。有本机 javascript 函数[setInterval 和 setTimeout](http://www.elated.com/articles/javascript-timers-with-settimeout-and-setinterval/)用于在设定的时间间隔内做事。你可能想要做类似的事情

```
function ajaxPing() {
  ...
}

setInterval("ajaxPing()", 1000);

$(element).mousedown(ajaxPing); 
```

另一方面，如果您真的想**每秒**`mousedown`执行一次 ping，只需将数据存储在变量中并在下一次 ping 时提交（这将在不到一秒的时间内发生）就足够了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-31T05:17:39.343

您可以将 ping 服务器的代码放在一个函数中，然后执行以下操作：

```
setInterval('ping()',1000); //this will ping 1000 milliseconds or 1 second 
```

# c# - 如何将字节数组转换为字符串

> ID：700061
> 
> 赞同：0
> 
> 时间：2009-03-31T05:03:01.860
> 
> 标签：c#, .net

我有一个从 FileStream.Read 返回的字节数组，我想把它变成一个字符串。我不能 100% 确定编码 - 它只是我保存到磁盘的一个文件 - 我该如何进行转换？是否有一个 .NET 类可以读取字节顺序标记并可以为我找出编码？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-31T05:09:55.167

请参阅[how-to-guess-the-encoding-of-a-file-with-no-bom-in-net](https://stackoverflow.com/questions/694923/how-to-guess-the-encoding-of-a-file-with-no-bom-in-net)。

由于字符串是 Unicode，因此您**必须**在转换时指定编码。文本流（甚至`ReadAllText()`）内部有一个活动编码，通常是一些合理的默认值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-31T05:10:16.723

尝试这样的事情：

```
buffer = Encoding.Convert( Encoding.GetEncoding("iso-8859-1"), Encoding.UTF8, buffer );
newString = Encoding.UTF8.GetString( buffer, 0, len ); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-31T05:32:54.160

你对文件了解多少？真的可以是*任何*编码吗？如果是这样，您需要使用启发式方法来猜测编码。如果它将是 UTF-8、UTF-16 或 UTF-32，那么

```
new StreamReader(new MemoryStream(bytes), true) 
```

将自动为您检测编码。如果您真的不知道编码，则文本非常讨厌。在很多情况下，您真的只是在猜测。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-31T05:39:45.953

如果`File.ReadAllText`可以正确读取文件，那么您有几个选择。

`BeginRead`您可以`File.ReadAllText`异步调用，而不是调用：

```
 delegate string AsyncMethodCaller(string fname);

    static void Main(string[] args)
    {
        string InputFilename = "testo.txt";
        AsyncMethodCaller caller = File.ReadAllText;
        IAsyncResult rslt = caller.BeginInvoke(InputFilename, null, null);

        // do other work ...

        string fileContents = caller.EndInvoke(rslt);
    } 
```

或者您可以从字节数组创建一个`MemoryStream`，然后使用`StreamReader`它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-31T08:11:39.673

没有简单的方法来获取编码，但如上所述使用

```
string str = System.Text.Encoding.Default.GetString(mybytearray); 
```

如果您不知道编码是什么。如果您在欧洲，那么 ISO-8859-1 可能就是您拥有的编码。

```
string str = System.Text.Encoding.GetEncoding("ISO-8859-1").GetString(mybytearray); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-31T05:05:38.903

System.IO.File.ReadAllText 做你想做的事。

# java - Java Socket 编程不适用于 10,000 个客户端

> ID：700072
> 
> 赞同：8
> 
> 时间：2009-03-31T05:06:04.457
> 
> 标签：java, sockets, c10k

我可以创建多个线程来支持套接字编程中的多客户端功能；这工作正常。但是如果要连接 10,000 个客户端，我的服务器无法创建这么多线程。

如何管理线程以便我可以同时收听所有这些客户端？

另外，如果在这种情况下，服务器想要向特定客户端发送一些东西，那怎么可能呢？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-31T05:25:41.663

您应该研究用于非阻塞网络编程的 Java 的 NIO（“New I/O”）库。NIO 旨在*准确*解决您面临的服务器可扩展性问题！

*   关于 NIO 的介绍性文章：[使用 Java NIO 构建高度可扩展的服务器](http://www.onjava.com/lpt/a/5127)
*   [O'Reilly 的Java NIO](http://www.google.com/books?id=BSz14O3uQwsC)书籍节选

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-31T05:25:08.500

Java 中高度可扩展的套接字编程需要“新 I/O”或 NIO 包中提供的[可选通道。](http://docs.oracle.com/javase/7/docs/api/java/nio/channels/SelectableChannel.html)通过使用非阻塞 IO，单个线程可以为许多套接字提供服务，只处理那些准备好的套接字。

Glassfish 应用服务器的[Grizzly](https://grizzly.java.net/)组件是更具可扩展性的开源 NIO 应用程序之一。[Jean-Francois Arcand](http://jfarcand.wordpress.com)撰写了许多关于他在该项目上的工作的信息丰富、深入的博客文章，并涵盖了使用 NIO 编写此类软件时的许多细微缺陷。

如果非阻塞 IO 的概念对您来说是新概念，那么使用像 Grizzly 这样的现有软件，或者至少将其作为您适应的起点，可能会很有帮助。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-31T16:08:16.143

NIO 的好处是值得商榷的。[请在此处](http://paultyma.blogspot.com/2008/03/writing-java-multithreaded-servers.html)和[此处](http://mailinator.blogspot.com/2008/02/kill-myth-please-nio-is-not-faster-than.html)查看 Paul Tyma 的博客条目。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-31T05:26:47.513

每个连接的线程模型（阻塞套接字 I/O）不会很好地扩展。下面是对 Java NIO 的介绍，它将允许您在 java 中使用非阻塞套接字调用：http: [//today.java.net/cs/user/print/a/350](http://today.java.net/cs/user/print/a/350)

正如文章所述，有很多可用的框架，所以你不必自己动手。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-01T20:55:01.470

如前所述，10.000 个客户并不容易。对于 java，NIO（可能增加了一个单独的线程池来处理每个请求而不阻塞 NIO 线程）是处理大量客户端的常用方法。

如前所述，根据实现，线程实际上可能会扩展，但这在很大程度上取决于客户端连接之间有多少交互。如果线程之间几乎没有同步，则大量线程更有可能工作。

也就是说，众所周知，NIO 在您第一次实施时很难做到 100% 正确。

我建议您尝试一下，或者至少在[naga.googlecode.com](http://naga.googlecode.com)上查看 Naga NIO 库的源代码。与大多数其他 NIO 框架相比，该库的代码库很小。您应该能够快速实施测试，看看您是否可以让 10.000 个客户端启动并运行。

（Naga 来源也恰好可以在不注明原作者的情况下自由修改或复制）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-31T16:04:56.120

为什么不一次只处理一定数量的请求。

假设您想一次处理最多 50 个请求（为了不创建太多线程）

您创建一个包含 50 个线程的线程池。

您将所有请求放入队列中（接受连接，保持套接字打开），每个线程在完成后获取下一个请求然后处理它。

这应该更容易扩展。

此外，如果需要，进行负载平衡会更容易，因为您可以为多个服务器共享队列

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-31T05:24:47.877

这不是一个简单的问题，但对于一个非常深入（对不起，不是在 java 中）的答案，请参见：[http ://www.kegel.com/c10k.html](http://www.kegel.com/c10k.html)

* * *

**编辑**

即使有了nio，这仍然是一个难题。10000 个连接对机器来说是一个巨大的资源负担，即使您使用的是非阻塞套接字。这就是大型网站有服务器场和负载平衡器的原因。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-07-02T16:40:43.043

就我个人而言，我宁愿使用创建自定义 I/O 非阻塞设置，例如使用一个线程来接受客户端并使用另一个线程来处理它们（检查是否有任何输入可用，并在必要时将数据写入输出）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-03-24T13:02:55.117

您必须弄清楚为什么您的应用程序在 10,000 个线程时失败。

1.  JVM 或操作系统中的线程数是否有硬性限制？如果是这样，它可以被取消吗？

2.  你的内存不足了吗？尝试为每个线程配置较小的堆栈大小，和/或向服务器添加更多内存。

3.  还有什么？修理它。

只有确定问题的根源，才能解决问题。理论上 10,000 个线程应该是可以的，但在那个并发级别上，如果你想让它发挥作用，它需要对 JVM 和操作系统进行一些额外的调整。

您也可以考虑 NIO，但我认为它也可以与线程一起正常工作。

# python - 在 python 中与长时间运行的任务进行通信

> ID：700073
> 
> 赞同：2
> 
> 时间：2009-03-31T05:06:06.703
> 
> 标签：python, multithreading, process, ctypes

我有一个 python GUI 应用程序，它使用它通过 ctypes 调用的 .so/.dll 中的长时间运行函数。

我正在寻找一种在函数在单独的线程或进程中运行时与函数通信的方法，以便我可以请求它提前终止（这需要在 C 端进行一些工作，然后才能返回部分结果）。我想这将需要从管道接收或读取某种信号，但我想让它尽可能简单。

您认为解决此类问题的最佳方法是什么？我能够在 python 和 C 端更改代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-31T05:32:01.930

您需要在这里回答两部分：一个是如何在两个进程之间进行通信（您的 GUI 和执行该函数的进程），另一个是如何更改您的函数以便它响应异步请求（“哦，我被告知只要归还我所有的东西”）。

计算出第二个问题的答案可能会决定第一个问题的答案。您可以通过信号来做到这一点（在这种情况下，您将获得一个信号处理程序来控制该过程，可以在其他地方查找更详细的说明，并在将控制权返回给您的函数之前更改您的内部数据结构），或者您可以拥有您的函数监控命令的控制接口（每毫秒，检查是否有命令等待，如果有，看看它是什么）。

在第一种情况下，您需要 ANSI C 信号处理（signal()、sighandler_t），在第二种情况下，您可能需要管道或类似的东西（pipe() 和 select()）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-31T05:33:50.740

您提到您可以同时更改 C 和 Python 方面。为了避免在 C 中编写任何套接字或信号代码，将大型 C 函数分解为 3 个较小的独立函数可能是最简单的，这些函数执行设置、一小部分工作和清理。工作包的运行时间应该在大约 1 毫秒到 1 秒之间，以在响应性和低开销之间取得平衡。面对不断变化的数据大小，将计算分解成这样的偶数块可能很困难，但是在一个也进行 I/O 的大型函数中您将面临同样的挑战。

用 Python 编写一个工作进程，通过 ctypes 调用这 3 个函数。让工作进程检查[Queue](http://docs.python.org/library/queue.html)对象以获取来自 GUI 的消息以提前停止计算。确保使用非阻塞 Queue.get_nowait 调用而不是 Queue.get。如果工作进程发现要提前退出的消息，则调用 C 清理代码并返回部分结果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-31T05:13:51.023

如果您在 *nix 上为您的 C 程序中的 SIGUSR1 或 SIGINT 注册一个信号处理程序，那么从 Python 使用 os.kill 发送信号。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-31T05:14:03.797

你说过：信号和管道。

它不必太复杂，但如果你使用现有的结构，它会比你尝试使用自己的结构容易得多。

# java - Xstream 对象序列化

> ID：700075
> 
> 赞同：0
> 
> 时间：2009-03-31T05:06:40.383
> 
> 标签：java, xml

给定这样的类：

```
public class Person {
  private String firstname;
  private String lastname;
  private PhoneNumber phone;
  private PhoneNumber fax;
  // ... constructors and methods
  private void calculate()
  {
  }
} 
```

还有一个像这样的[Xstream](http://xstream.codehaus.org/tutorial.html)对象：

```
XStream xstream = new XStream(new DomDriver()); 

Person joe = new Person("Joe", "Walnes");
joe.setPhone(new PhoneNumber(123, "1234-456"));
joe.setFax(new PhoneNumber(123, "9999-999"));

String xml = xstream.toXML(joe); 
```

生成的 XML 如下所示：

```
<person>
  <firstname>Joe</firstname>
  <lastname>Walnes</lastname>
  <phone>
    <code>123</code>
    <number>1234-456</number>
  </phone>
  <fax>
    <code>123</code>
    <number>9999-999</number>
  </fax>
</person> 
```

从 XML 反序列化一个对象如下所示：

```
Person newJoe = (Person)xstream.fromXML(xml); 
```

Person 反序列化后是否可以执行 newJoe.calculate() 方法？

可以将 person 类中存在的数字的值更改为另一个值，例如 newJoe.number = 4545;

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-31T05:22:05.400

是的，您可以调用方法并更改值。它就像任何其他实例一样，不同之处在于它从 XML 文件中获取值，而不是您显式地将它们传递给构造函数。

该对象将存在于您反序列化它的 VM 中。如果你想通过网络进行这项工作，你需要使用 RMI 之类的东西在网络中传递对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-01T16:05:38.063

Yes.

And I'm flattered to be referenced in the example.

# .net - 在托管环境中查询接口的 IronPython 脚本

> ID：700082
> 
> 赞同：2
> 
> 时间：2009-03-31T05:11:10.980
> 
> 标签：.net, ironpython, dynamic-language-runtime

我正在开发一个用 C# 编写的应用程序，它承载 IronPython。我的计划是用户将编写 python 脚本，其中包含实现预定义接口的类。

就像是：

在 C# 代码中定义接口：

```
public interface IPlugin
{
    void DoSomething();
} 
```

在 python 代码中实现接口。

```
class Plugin(IPlugin):

      def DoSomething():
          print "Doing stuff." 
```

在我的应用程序中，我加载 python 脚本并执行这些脚本中的类实现的方法。

我想知道：如何获取在 python 脚本中实现指定接口的所有类的句柄？

例如：如果我要在 C# 中做所有事情，我有反射来帮助我，我可以直接加载程序集并执行以下操作：

```
 Assembly assembly = Assembly.LoadFrom("plugin.dll");
    Type[] types = assembly.GetTypes();
    foreach(Type type in types)
    {
        foreach(Type interfaceType in type.GetInterface())
        {
            if(interfaceType == typeof(IPlugin))
            {
                // gotcha, invoke interface specific methods
            }
        }
     } 
```

当我处理 IronPython 脚本而不是程序集时，我该怎么做？[我知道使用 ObjectOperations 和 ScriptScope，如果我知道它的名称（如此处所述](http://www.voidspace.org.uk/ironpython/hosting_api.shtml#dynamic-operations)），我可以获得该类的句柄，但我正在寻找更强大的东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-01T01:12:58.457

您遇到的问题是 IronPython 类不是 .NET 类。Python 类比 C# 类动态得多，因此 IronPython 类通常是 .NET 对象。

当您在 IronPython 中对 .NET 接口进行子类化时，它*确实会*创建一个新的 .NET 类，但多个 Python 类实际上将共享一个支持 .NET 类（对于 IronPython 中子类化的每个 .NET 类型，只会创建一个 .NET 类）。

正确的方法是使用 Python 内省来收集 IronPython 类对象，并在需要实例化它们的地方使用工厂函数（您可以将其用作委托 - 将返回的实例转换为接口）。

例如，您可以尝试在 Python 范围内执行：

```
list_of_classes = IPlugin.\_\_subclasses_\_ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-31T05:15:12.063

动态语言通常不使用接口，您正在以一种非常静态类型的方式思考:)

与其担心它是否匹配某些预定义的接口，您可能应该只调用成员函数并处理抛出的任何异常 - 无论如何您都必须处理错误，只需将“不符合我们期望的方法调用”设置为多一个。在 Objective-C 中，这被称为“非正式协议”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-31T18:04:34.303

您始终可以通过调用 clr.GetClrType 来获取 Python 类型的支持 .NET 类型

Python.GetClrModule(engine) 返回 clr 模块，然后在其上调用 GetClrType 方法，传入您使用 objectoperations 获得的 Python 类。这应该会给你一个 System.Type。之后，像往常一样使用 GetInterfaces 方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-31T05:37:29.873

根据 IronPython FAQ，它不支持将 *.py 文件编译成可以链接到的程序集：

[http://ironpython.codeplex.com/Wiki/View.aspx?title=FAQ&referringTitle=Home](http://ironpython.codeplex.com/Wiki/View.aspx?title=FAQ&referringTitle=Home)

但 Paul 是对的，如果你打算使用动态语言来实现这种可扩展性，你会希望让它像编辑文件一样简单，而不必从运行时理解接口。

如果您将此可扩展点公开给系统管理员类型，您可能需要考虑托管 PowerShell。不久前我写了一篇关于如何做到这一点的帖子：

[http://notgartner.wordpress.com/2008/02/23/how-to-host-the-powershell-runtime/](http://notgartner.wordpress.com/2008/02/23/how-to-host-the-powershell-runtime/)

PowerShell 对此有好处，因为它已经在使用 Exchange 的环境中得到了一些采用。请注意 - 我是 PowerShell 的粉丝，所以请谨慎对待 :)

# visual-studio - 在 Visual Studio 中创建新类时如何将其默认为公共？

> ID：700086
> 
> 赞同：130
> 
> 时间：2009-03-31T05:13:00.557
> 
> 标签：visual-studio

当我在 C# Visual Studio 项目的解决方案中单击鼠标右键并选择添加...> 类...时，它会创建一个没有公共修饰符的类。如何让 Visual Studio (2008) 将该类默认为公共类？

* * *

## 回答 #1

> 赞同：179
> 
> 时间：2012-11-12T14:18:46.797

在**VS2012 中**，它就像去`C:\Program Files (x86)\Microsoft Visual Studio 11.0\Common7\IDE\ItemTemplates\CSharp\Code\1033\Class`编辑 Class.cs 文件一样简单。

无需解压缩或重建缓存。如果你问我，这是一个非常积极的变化。

**VS2015**：`C:\Program Files (x86)\Microsoft Visual Studio 14.0\Common7\IDE\ItemTemplates\CSharp\Code\1033\Class`

**VS2017(RC)**：`C:\Program Files (x86)\Microsoft Visual Studio\2017\Enterprise\Common7\IDE\ItemTemplates\CSharp\Code\1033\Class`

**VS2017（专业）**：`C:\Program Files (x86)\Microsoft Visual Studio\2017\Professional\Common7\IDE\ItemTemplates\CSharp\Code\1033\Class`

**VS2019（企业版）**：`C:\Program Files (x86)\Microsoft Visual Studio\2019\Enterprise\Common7\IDE\ItemTemplates\CSharp\Code\1033\Class\Class.cs`

**VS2019（专业版）**：`C:\Program Files (x86)\Microsoft Visual Studio\2019\Professional\Common7\IDE\ItemTemplates\CSharp\Code\1033\Class\Class.cs`

从 Visual Studio 2022 开始 VS 是一个 64 位应用程序，这意味着项目模板在`C:\Program Files\...`而不是`C:\Program Files (x86)`

**VS2022（社区）**：`C:\Program Files\Microsoft Visual Studio\2022\Community\Common7\IDE\ItemTemplates\CSharp\Code\1033\Class\Class.cs`

**VS2022（专业）**：`C:\Program Files\Microsoft Visual Studio\2022\Professional\Common7\IDE\ItemTemplates\CSharp\Code\1033\Class\Class.cs`

***过时的***

**VS2019（预览版）**：`C:\Program Files (x86)\Microsoft Visual Studio\2019\Preview\Common7\IDE\ItemTemplates\CSharp\Code\1033\Class\Class.cs`

* * *

## 回答 #2

> 赞同：79
> 
> 时间：2009-03-31T05:23:48.017

您需要修改位于`C:\Program Files\Microsoft Visual Studio 9.0\Common7\IDE\ItemTemplates\CSharp\Code\1033`.

**Visual Studio 2010 (10.0) 及更低版本：**其中有一个名为 Class.zip 的 zip 文件。解压此文件，编辑文件以放入您的`public`关键字，然后重新打包（确保备份原始文件）。

`C:\Program Files\Microsoft Visual Studio 9.0\Common7\IDE\ItemTemplatesCache`在此之后，通过打开 Visual Studio 命令外壳并执行以下命令，确保 VS 重建它的缓存（这只是解压缩到目录中的 zip 文件）：

```
devenv /installvstemplates 
```

**Visual Studio 2012 (11.0) 及更高版本：** 请参阅[@JochemKempe 的答案](https://stackoverflow.com/a/13345346/57611)，因为现在更改它要容易得多，只需编辑单个文件（无需解压缩或重新压缩）。

**更新：**在进行任何编辑之前，不要忘记以管理员权限打开您喜欢的文本编辑器。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2013-05-27T22:00:23.493

在默认情况下为 Visual Studio 2012 创建公共类：

编辑这个文件：

```
C:\Program Files (x86)\Microsoft Visual Studio 11.0\Common7\IDE\ItemTemplates\CSharp\Code\1033\Class\Class.cs 
```

看起来像这样：

```
using System;
using System.Collections.Generic;
$if$ ($targetframeworkversion$ >= 3.5)using System.Linq;
$endif$using System.Text;
$if$ ($targetframeworkversion$ >= 4.5)using System.Threading.Tasks;
$endif$
namespace $rootnamespace$
{
    public class $safeitemrootname$
    {
    }
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2021-12-02T21:21:41.783

在 VS 2022 Professional 中，对于那些只想编辑 Class.cs 文件并继续前进的人，鉴于 2022 是 64 位并且不再位于 x86 路径中，因此更改了路径。现在是：

```
C:\Program Files\Microsoft Visual Studio\2022\Professional\Common7\IDE\ItemTemplates\CSharp\Code\1033\Class 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-31T05:24:53.227

您可以创建自己的项目模板，也可以修改现有的模板。所有这些项目文件都是模板驱动的，因此您可以更改它们和/或添加自己的。

查看这些链接：

*   [VS 项目模板上的 MSDN](http://msdn.microsoft.com/en-us/library/6db0hwky(VS.80).aspx)
*   [创建自己的 VS 项目模板](http://www.carlosag.net/Articles/createVSTemplate.aspx)
*   [VS 项目模板上的 CodeProject](http://www.codeproject.com/KB/codegen/Templates.aspx)

马克

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2017-05-23T21:20:08.820

这是一个可重入的 PS 脚本，它将更新 C# 基类*Item Template*。路径会根据您使用的 Visual Studio 版本/版本而变化。它还会备份原始模板，以防您将来想要恢复。

```
$csharpClassTemplates = @("C:\Program Files (x86)\Microsoft Visual Studio 14.0\Common7\IDE\ItemTemplates\CSharp\Code\1033\Class\Class.cs",
                          "C:\Program Files (x86)\Microsoft Visual Studio 14.0\Common7\IDE\ItemTemplatesCache\CSharp\Code\1033\Class\Class.cs",
                          "C:\Program Files (x86)\Microsoft Visual Studio\2017\Community\Common7\IDE\ItemTemplates\CSharp\Code\1033\Class\Class.cs")

$csharpClassTemplates | % {
    Write-Output("Updating template $_")
    Copy-Item $_ -Destination "$_.backup"
    (get-content $_).Replace('public ', '').Replace('class ', 'public class ') | Set-Content $_
 } 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2019-07-17T19:14:34.497

除了 JochemKempe 很好的答案，这里是如何为 .NET 核心模板做的。

* * *

# .NET 核心

`\CSharp\`您需要编辑目录中的模板，而不是编辑目录中的模板`\AspNetCore\`。

**VS2019（企业版）**：`C:\Program Files (x86)\Microsoft Visual Studio\2019\Enterprise\Common7\IDE\ItemTemplates\AspNetCore\Code\1033\Class\Class.cs`

**VS2019（专业版）**：`C:\Program Files (x86)\Microsoft Visual Studio\2019\Professional\Common7\IDE\ItemTemplates\AspNetCore\Code\1033\Class\Class.cs`

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-01-12T07:13:08.863

[JochemKempe 的答案](https://stackoverflow.com/a/13345346/57611)很好用，但有点困难，因为您需要在`Program Files`.

只是为了更新答案。社区版的模板位于文件夹中：

`c:\Program Files (x86)\Microsoft Visual Studio\2017\Community\Common7\IDE\ProjectTemplates`

## 另一种解决方案

但是还有另一种可能来创建新模板。将文件从源文件夹复制到用户模板文件夹。

例如，对于 Windows 窗体应用程序，它可以是以下源文件夹之一*（对于 Visual Studio 2017 社区）*：

```
c:\Program Files (x86)\Microsoft Visual Studio\2017\Community\Common7\IDE\ProjectTemplates\CSharp\Windows Root\Windows\1033\WindowsApplication\
c:\Program Files (x86)\Microsoft Visual Studio 14.0\Common7\IDE\ProjectTemplates\CSharp\Windows Root\Windows\1033\WindowsApplication\
c:\Program Files (x86)\Microsoft Visual Studio 14.0\Common7\IDE\ProjectTemplatesCache\CSharp\Windows Root\Windows\1033\WindowsApplication\ 
```

默认用户模板文件夹是*（对于 Visual Studio 2017 社区）*：

```
C:\Users\<username>\Documents\Visual Studio 2017\Templates\ProjectTemplates\ 
```

新的 Windows 窗体应用程序模板的目标文件夹是：

```
C:\Users\<username>\Documents\Visual Studio 2017\Templates\ProjectTemplates\Visual C#\Windows\1033\MyWindowsApplication\ 
```

有了这个，您将在创建新项目时拥有两个“Windows 窗体应用程序”。这两者的区别仅在于默认文件名。为了更好地区分，可以更改模板的显示名称。要更改模板名称，请更新`.vstemplate`文件。

原始`csWindowsApplication.vstemplate`包含行：

```
 <Name Package="{FAE04EC1-301F-11d3-BF4B-00C04F79EFBC}" ID="2318" /> 
```

要更改名称，您需要将行更改为如下内容：

```
 <Name ID="2318">My Windows Form Application</Name> 
```

该解决方案的负面部分是，您必须重命名新模板并向现有模板添加新模板*（旧的“不正确”示例将保留，您仍然可以不情愿地使用它）*。

但也有好的部分。您无需成为管理员即可添加或更新示例。*（无需重写文件`Program Files`夹中的文件。）*

# wpf - 在 wpf 中禁用退格键

> ID：700094
> 
> 赞同：11
> 
> 时间：2009-03-31T05:15:20.317
> 
> 标签：wpf

我在 WPF 应用程序中工作，使用 C#.net 我想知道，有什么方法可以禁用`Backspace`特定 xaml 页面上的按钮。我想阻止用户使用`Backspace`此特定 xaml 页面上的按钮。即使用户按下`Backspace`按钮，也不会有任何效果。

谢谢

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2011-09-05T05:50:33.420

如果要防止退格键在 WPF 框架中备份导航历史记录，包括特殊的“后退”硬件按钮，请使用：

```
NavigationCommands.BrowseBack.InputGestures.Clear();
NavigationCommands.BrowseForward.InputGestures.Clear(); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-31T05:18:38.140

您需要捕获 onKeyDown 事件并将处理设置为 true 以进行退格。

```
private void Window_KeyDown(object sender, KeyEventArgs e)
{
    if (e.Key == Key.Back)
    {
         e.Handled = true;
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-12-05T11:55:32.643

所以我更喜欢[sipwiz 的方法，](https://stackoverflow.com/a/700104/340045)因为我不想禁用所有键盘快捷键（我仍然想使用 ALT-Left 等而不是 Backspace）。

对于使用 WPF NavigationWindow 的我来说，重写该`OnKeyDown`方法根本不起作用，当我按下 Backspace 键时，窗口仍然导航回来。覆盖`OnPreviewKeyDown`确实似乎开始工作，但是当我需要 Backspace 键来处理文本框时，我遇到了问题。

所以我从[Ed Andersen 的方法](https://stackoverflow.com/a/7304280/340045)中学到了什么，并将以下代码添加到我的 NavigationWindow 构造函数中：

```
KeyGesture backKeyGesture = null;
foreach(var gesture in NavigationCommands.BrowseBack.InputGestures)
{
    KeyGesture keyGesture = gesture as KeyGesture;
    if((keyGesture != null) &&
       (keyGesture.Key == Key.Back) &&
       (keyGesture.Modifiers == ModifierKeys.None))
    {
        backKeyGesture = keyGesture;
    }
}

if (backKeyGesture != null)
{
    NavigationCommands.BrowseBack.InputGestures.Remove(backKeyGesture);
} 
```

# c++ - C++ 中的内存分配分析

> ID：700097
> 
> 赞同：48
> 
> 时间：2009-03-31T05:16:25.073
> 
> 标签：c++, memory-management, profiling

我正在编写一个应用程序，并且惊讶地发现它的总内存使用量已经太高了。我想分析我的应用程序的动态内存使用情况：堆中有多少种对象，哪些函数创建了这些对象？另外，每个对象使用多少内存？

有没有一种简单的方法可以做到这一点？我在 linux 和 windows 上工作，所以任何平台的工具都足够了。

注意：我不关心这里的内存泄漏。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-03-31T13:36:43.387

你试过[Valgrind](http://valgrind.org/)吗？它是用于 Linux 的分析工具。它有一个名为 Memcheck 的内存检查器（用于内存泄漏和其他内存问题），但它还有一个名为 Massif 的堆分析器。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-03-31T05:50:12.930

对于简单的统计，只是为了找出所有内存的使用情况，您可以添加这样的模板：

```
template<class T>
class Stats {
  static int instance_count;
public:
  Stats() {
    instance_count++;
  }
  ~Stats() {
    instance_count--;
  }
  static void print() {
    std::cout << instance_count << " instances of " << typeid(T).name() <<
        ", " << sizeof(T) << " bytes each." << std::endl;
  }
};

template<class T>
int Stats<T>::instance_count = 0; 
```

然后，您可以将其作为基类添加到您怀疑有很多实例的类中，并打印出当前内存使用情况的统计信息：

```
class A : Stats<A> {
};

void print_stats() {
  Stats<A>::print();
  Stats<B>::print();
  ...
} 
```

这不会向您显示对象被分配在哪些函数中，也不会提供太多细节，但它可能足以让我找到浪费内存的地方。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-31T08:59:23.833

对于 Windows，请检查“crtdbg.h”中的函数。crtdbg.h 包含内存分配函数的调试版本。它还包含用于检测内存泄漏、损坏、检查堆指针有效性等的功能。

我认为以下功能对您有用。

_CrtMemDumpStatistics _CrtMemDumpAllObjectsSince

以下 MSDN 链接列出了堆状态报告函数和示例代码 [http://msdn.microsoft.com/en-us/library/wc28wkas(VS.80).aspx](http://msdn.microsoft.com/en-us/library/wc28wkas(VS.80).aspx)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-31T05:55:59.250

[您可以从http://www.softwareverify.com/cpp/memory/index.html](http://www.softwareverify.com/cpp/memory/index.html)尝试 Memory Validator

它是我遇到的用于分析内存使用情况的最佳工具之一。30 天评估版可免费下载。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2015-03-10T03:19:00.910

[Mtuner](https://github.com/milostosic/MTuner) - 免费的 C/C++ 内存分析器。说明如下：

Mtuner 是一个多平台内存分析、泄漏检测和分析工具，支持 MSVC、GCC 和 Clang 编译器。功能包括：基于时间轴的内存活动历史记录、强大的过滤、带有完整源代码的手动检测 SDK、通过命令行使用的持续集成支持、内存泄漏检测等等。使用 GCC 或 Clang 交叉编译器分析任何软件目标平台。内置对 Windows、PlayStation 4 和 PlayStation 3 平台的支持，以及基于 Windows 的交叉编译器所针对的平台。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-31T05:27:40.240

您可以做几件事。最简单的就是链接一个调试malloc库；有许多可用，具体取决于您的环境的详细信息（例如，google 用于 Windows 的 _malloc_dbg。）

第二种选择是可以在C++中重载*new*和*delete ；*使用跟踪内存分配和使用的新函数可能会使基本的 new 和 delete 重载。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2014-11-20T08:16:16.973

试试[gperftools](https://github.com/gperftools/gperftools) - 它可以：

*   一次分析代码的特定部分或整个程序。
*   通过显示精确函数调用及其继承的可视化图形表示数据。
*   专注于可视化图表中的特定代码区域。
*   显示转储之间的差异。
*   显示分配的空间而不是使用的空间——所有这些都是通过同一个转储完成的。

而且，它几乎不影响程序效率。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2011-10-29T14:01:24.623

我刚刚发布了一个 win32 本机内存分析器 MemPro，作为免费测试版。[http://www.puredevsoftware.com/MemPro.htm](http://www.puredevsoftware.com/MemPro.htm)。它连接到 new/delete 并将数据发送到外部应用程序，您可以在其中以各种不同的方式查看分配情况。希望这是有帮助的。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-31T05:27:05.170

在之前的工作中，我们使用了一个名为“Purify”的工具。它是由 Rational/IBM 制造的产品。我不认为这是一个免费工具，但我记得它非常好。这里有一些信息：

[http://en.wikipedia.org/wiki/IBM_Rational_Purify](http://en.wikipedia.org/wiki/IBM_Rational_Purify)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-03-17T02:28:54.387

[Game Programming Gems 第 8 卷](http://my.safaribooksonline.com/9781584507024/ch37)（Safari Book 预览链接）的第 4.6 章详细介绍了 Ricky Lung 的高级内存分析器，它可以以分层调用堆栈的方式显示分配统计信息，但支持多线程。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-03-31T06:03:42.197

[Game Programming Gems 第 2 卷](http://books.google.com/books?id=M2QYbTVd0VgC&printsec=toc&dq=game+programming+gems&source=gbs_summary_s&cad=0)（[亚马逊链接](https://rads.stackoverflow.com/amzn/click/com/1584500549)）的第 1.10 章详细介绍了 Peter Dalton 编写的一个简单但有效的插入式调试内存管理器，它在您转储日志时提供了一组不错的统计数据。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-31T05:57:36.330

刚刚在[AQtime 网站上](http://www.automatedqa.com/products/aqtime/screencast_overview.asp)看到他们对“分配分析”有很好的支持。

# java - 我如何反对像 Java 这样的强类型语言中的 Duck 类型？

> ID：700113
> 
> 赞同：7
> 
> 时间：2009-03-31T05:21:38.367
> 
> 标签：java, duck-typing

我在一个 Java 程序员团队中工作。我的一位同事不时建议我做一些类似“只需添加一个类型字段”（通常是“字符串类型”）的事情。或者代码将被提交满载“ `if (foo instanceof Foo){...} else if( foo instanceof Bar){...}`”。

尽管 Josh Bloch 告诫说“标记类是对适当类层次结构的模仿”，但我对这类事情的单线反应是什么？然后我如何更认真地阐述这个概念？

我很清楚 - 上下文是 Java - 所考虑的对象类型就在我们集体面前 - IOW：紧跟在“类”、“枚举”或“接口”等之后的词。

但除了难以演示或量化（现场）“它使你的代码更复杂”之外，我怎么说“用（或多或少）强类型语言进行鸭式打字是一个愚蠢的想法，暗示了更深层次的设计病态？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-31T05:33:23.067

其实你说的还不错。

事实是，comb 的“实例”几乎总是一个坏主意（例如，当您进行编组或序列化时会发生异常，在很短的时间间隔内您可能没有手头的所有类型信息。）正如 josh 所说，否则这是一个糟糕的类层次结构的标志。

您*知道*这是一个坏主意的方式是它使代码变得脆弱：如果您使用它，并且类型层次结构*发生变化*，那么它可能会在它出现的任何地方破坏该梳子的实例。更重要的是，你会失去强类型的好处；编译器无法通过提前捕获错误来帮助您。（这有点类似于 C 中类型转换引起的问题。）

### 更新

让我稍微扩展一下，因为从评论看来我不太清楚。您在 C 中使用类型转换的原因，或者`instanceof`，您想说“好像”的原因：将其`foo`用作`bar`. 现在，在 C 中，根本没有运行时类型信息，所以您只是在没有网络的情况下工作：如果您对某些内容进行类型转换，生成的代码将把该地址视为包含特定类型，无论如何，并且您应该只*希望*它会导致运行时错误，而不是默默地破坏某些东西。

鸭子打字只是将其提升为常态。在像 Ruby、Python 或 Smalltalk 这样的动态弱类型语言中，一切都是无类型引用；你在运行时向它发送消息，看看会发生什么。如果它理解一个特定的信息，它就会“像鸭子一样走路”——它会处理它。

这可能非常方便和有用，因为它允许奇妙的 hack，例如将生成器表达式分配给 Python 中的变量，或将块分配给 Smalltalk 中的变量。但这确实意味着您在运行时容易受到强类型语言在编译时可以捕获的错误的影响。

在像 Java 这样的强类型语言中，您根本不能真正严格地进行鸭式类型：您*必须*告诉编译器您将要处理的东西是什么类型。您可以通过使用类型转换来获得类似鸭子类型的东西，这样您就可以执行类似的操作

```
Object x;   // A reference to an Object, analogous to a void * in C

// Some code that assigns something to x

((FoodDispenser)x).dropPellet();          // [1]

// Some more code

((MissleController)x).launchAt("Moon");   // [2] 
```

现在在运行时，只要 x 是一种`FoodDispenser`at [1] 或`MissleController`at [2] 就可以了；否则*繁荣*。或者出乎意料，没有*繁荣*。

在您的描述中，您通过使用`else if`和`instanceof`

```
 Object x ;

 // code code code 

 if(x instanceof FoodDispenser)
      ((FoodDispenser)x).dropPellet();
 else if (x instanceof MissleController )
      ((MissleController)x).launchAt("Moon");
 else if ( /* something else...*/ ) // ...
 else  // error 
```

现在，您可以免受运行时错误的影响，但您有责任稍后在`else`.

但是现在假设您对代码进行了更改，因此“x”可以采用“FloorWax”和“DessertTopping”类型。您现在必须检查所有代码并找到该梳子的所有实例并修改它们。现在代码是“脆弱的”——需求的变化意味着大量的代码变化。在 OO 中，您正在努力使代码不那么脆弱。

OO 解决方案是使用多态性，您可以将其视为一种有限的鸭子类型：您定义了可以信任执行的所有操作。你可以通过定义一个高级类来做到这一点，可能是抽象的，它具有低级类的所有方法。在 Java 中，像这样的类最好表示为“接口”，但它具有类的所有类型属性。实际上，您可以将接口视为一种承诺，即可以信任特定类以“就好像”它是另一个类一样。

```
 public interface VeebleFeetzer { /* ... */ };
  public class FoodDispenser implements VeebleFeetzer { /* ... */ }
  public class MissleController implements VeebleFeetzer { /* ... */ }
  public class FloorWax implements VeebleFeetzer { /* ... */ }
  public class DessertTopping implements VeebleFeetzer { /* ... */ } 
```

您现在所要做的就是使用对 VeebleFeetzer 的引用，*编译器*会为您计算出来。如果您碰巧添加了另一个属于 VeebleFeetzer 子类型的类，编译器将选择该方法并检查交易中的参数

```
VeebleFeetzer x;   // A reference to anything 
                   // that implements VeebleFeetzer

// Some code that assigns something to x

x.dropPellet();

// Some more code

x.launchAt("Moon"); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-31T05:29:31.937

这与其说是鸭式打字，不如说是正确的面向对象风格；事实上，能够继承类 A 并在类 B 上调用相同的方法并让它做其他事情是语言中继承的全部要点。

如果你经常检查一个对象的类型，那么你要么太聪明了（尽管我认为这是鸭子打字爱好者喜欢的这种聪明，除了不那么脆弱的形式）或者你没有接受对象的基础知识面向编程。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-31T05:48:31.437

嗯……

如果我错了，请纠正我，但标记类和鸭子打字是两个不同的概念，尽管不一定相互排斥。

当一个人有在类中使用标签来定义类型的冲动时，恕我直言，应该修改他们的类层次结构，因为这是一个明显的概念流血，抽象类需要知道类父级尝试的实现细节隐藏。你使用正确的模式吗？换句话说，您是否试图以一种不自然地支持它的模式强制行为？

鸭子类型是一种松散定义类型的能力，只要定义了参数实例中的必要方法，方法就可以接受任何类型。然后该方法将使用该参数并调用必要的方法，而不会过多地打扰实例的父级。

所以在这里......正如查理指出的那样，臭味提示是使用instanceof。很像静态或其他臭名昭著的关键字，每当它们出现时，人们必须问“我在这里做正确的事吗？”，并不是说它们天生就是错误的，而是它们经常被用来破解糟糕或不合适的 OO 设计。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-31T07:03:08.980

我的一个回应是你失去了 OOP 的主要好处之一：多态性。这减少了开发新代码的时间（开发人员喜欢开发新代码，所以这应该有助于你的论点:-)

如果在向现有系统添加新类型时，除了确定要构造哪个实例之外，您还必须添加逻辑，那么在 Java 中，您做错了（假设新类应该只是替换为了另一个）。

通常，在 Java 中处理此问题的适当方法是保持代码多态并利用接口。因此，每当他们发现自己想要添加另一个变量或执行 instanceof 时，他们可能应该改为实现接口。

如果您可以说服他们更改代码，那么将接口改装到现有代码库中是很容易的。就此而言，我会花时间用 instanceof 编写一段代码并将其重构为多态。如果他们能看到前后版本并进行比较，人们就更容易明白这一点。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-31T07:04:10.757

您可能想向您的同事指出 Liskov 替换原则，它是 SOLID 中的五个支柱之一。

链接：

*   [维基百科条目](http://en.wikipedia.org/wiki/Liskov_substitution_principle "语言服务提供商")
*   [鲍勃叔叔写的文章](http://www.objectmentor.com/resources/articles/lsp.pdf)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-31T05:30:19.250

虽然我通常是像 python 这样的鸭式语言的粉丝，但我可以在 java 中看到你的问题。

如果您正在编写将与此代码一起使用的所有类，那么您不需要鸭式类型，因为您不需要考虑代码不能直接继承（或实现）的情况接口或其他统一的抽象。

鸭子类型的一个缺点是你有一个额外的单元测试类要在你的代码上运行：一个新类可能返回与预期不同的类型，并随后导致其余代码失败。因此，尽管鸭式打字允许向后灵活性，但它需要大量的前瞻性思维来进行测试。

简而言之，你有一个包罗万象（硬）而不是几个（容易）。我认为这就是病理学。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-31T05:31:05.410

为什么“模仿一个类层次结构”而不是设计和使用它？重构方法之一是用多态性替换“switch”es（链式 if 几乎相同）。为什么在多态性会导致代码更简洁的地方使用开关？

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-31T07:43:45.157

当您说“在强类型语言中输入鸭子”时，实际上是指“在静态类型语言中模仿（子类型）多态性”。

当您拥有不包含任何行为的数据对象 (DTO) 时，情况还不错。当您确实拥有成熟的 OO 模型时（问问自己是否真的如此），那么您应该在适当的情况下使用该语言提供的多态性。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-31T14:26:46.327

这不是鸭式打字，它只是在具有（或多或少）真正多态性的语言中模拟多态性的一种糟糕方法。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-31T06:12:09.040

回答标题问题的两个论据：

1) Java 应该是“一次编写，随处运行”，因此为一个层次结构编写的代码不应该在我们改变某处环境时抛出 RuntimeExceptions。（当然，这条规则也有例外——双关语。）

2) Java JIT 执行非常激进的优化，依赖于知道给定符号必须是一种类型且仅一种类型。解决此问题的唯一方法是强制转换。

正如其他人所提到的，您的“实例”与我在这里回答的问题不匹配。任何类型、鸭子或静态的任何东西都可能存在您描述的问题。有更好的 OOP 方法来处理它。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-31T07:06:54.340

您可以使用 Method- 和 Strategy-Pattern 而不是 instanceof，将代码混合在一起看起来比以前好多了...

# java - 我们如何使用 sessionId 取回特定会话？

> ID：700143
> 
> 赞同：0
> 
> 时间：2009-03-31T05:32:31.460
> 
> 标签：java, session, jakarta-ee, websphere

我从事一项涉及从一个应用程序移动/遍历到另一个应用程序的任务。这些应用程序位于不同的 JVM 中。

在遍历另一个应用程序时，我会跟踪会话 ID。但是，当我来回遍历时，会创建一个新会话。当我从子应用程序导航回父应用程序时，有什么方法可以让我使用我保留的 sessionId 返回相同的会话？

环境：带有 WebSphere 的 J2EE。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T20:39:55.777

正如 Mork0075 所述，sessionID 与 cookie 名称和服务器域相关联。如果您在不同的 JVM 上为两个应用程序使用相同的服务器域，我会看到在应用程序之间切换时维护会话的两个选项：

远景：1）如果您将数据库用于会话复制目的，则可以为两个应用程序使用相同的数据库，并且两个应用程序都可以使用 sessionID。我在这里看到的一个问题是会话中的对象可能在双方都不可用，因为代码会不同等。除非您在双方都维护代码等，否则它们可能会破坏对方的会话对象对象可用。

可能的可能性：2）在两个应用程序之一上为会话使用不同的 cookie 名称。默认情况下，会话使用 JSESSIONID 作为 cookie，当您切换到第二个应用程序时，它会尝试根据该 cookie 名称查找会话并且找不到它。因此，它会创建一个新的 sessionID 并将其发送回浏览器，从而导致您的 sessionID 发生更改，并且在您切换回原始应用程序时不可用。但是，如果您将第二个应用程序的 sessionID 更改为其他内容（例如 JSESSIONID2），您的浏览器最终会得到两个有效的 sessionID，每个 sessionID 在其正确的应用程序上都是有效的。您可以通过应用程序服务器的会话管理->启用cookies页面下的管理控制台更改名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T09:08:45.437

我不确定这是否有帮助，但在 ONE 应用程序场景中，您将在每个响应中提交一个 sessionID，将其保存在 URL、cookie 或隐藏字段中。通过向服务器提交一个新请求，同时也提交了 sessionID，以便在服务器端进行解析。据我了解，从一个应用程序切换到另一种意味着您必须在应用程序中向用户提供 sessionID。如果将 sessionID 保存在 cookie 中，这可能是不可能的，因为 cookie 仅限于某个服务器域。所以确保会话仍然有效，并且在返回应用程序启动后 sessionID 存在。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-26T14:37:35.773

您不必手动执行此操作。大多数应用服务器都支持单点登录 (SSO)，因此您可以登录到一个应用程序并访问同一 SSO 域中的所有应用程序。应用服务器将跟踪会话 ID，并将它们链接到特定于 Web 应用的 HTTPSession 对象。

请参阅[http://publib.boulder.ibm.com/infocenter/wasinfo/v6r1/topic/com.ibm.websphere.base.doc/info/aes/ae/csec_sso.html](http://publib.boulder.ibm.com/infocenter/wasinfo/v6r1/topic/com.ibm.websphere.base.doc/info/aes/ae/csec_sso.html)

# ruby-on-rails - 多态关联

> ID：700148
> 
> 赞同：8
> 
> 时间：2009-03-31T05:34:31.270
> 
> 标签：ruby-on-rails, ruby, migration

如果您有多态的 belongs_to 关联，那么引用将添加所需的两列：

```
create_table :products do |t|
  t.references :attachment, :polymorphic => {:default => 'Photo'}
end 
```

将添加一个列和一个默认值为“照片”`attachment_id`的字符串列。`attachment_type`

这到底是什么意思？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-31T05:43:50.327

以下是有关引用方法的文档：http: [//api.rubyonrails.org/classes/ActiveRecord/ConnectionAdapters/TableDefinition.html#M001938](http://api.rubyonrails.org/classes/ActiveRecord/ConnectionAdapters/TableDefinition.html#M001938)

引用方法的代码如下：

```
497:       def references(*args)
498:         options = args.extract_options!
499:         polymorphic = options.delete(:polymorphic)
500:         args.each do |col|
501:           column("#{col}_id", :integer, options)
502:           column("#{col}_type", :string, polymorphic.is_a?(Hash) ? polymorphic : options) unless polymorphic.nil?
503:         end
504:       end 
```

如你看到的。它将 [col]_id 和 [col]_type 列添加到表中。

这和说的一样：

```
create_table :products do |t|
  t.integer :attachment_id
  t.string  :attachment_type, :default => 'Photo'
end 
```

多态关联用于将一种对象连接到多种其他对象。

一个很好的例子可能是支持标签的应用程序，其中标签可以连接到`Products`和`Categories`。

在您的示例中，看起来产品可以附加到多种对象，其中默认对象类型是照片。（`attachment_type`将是“照片”，并且`attachment_id`将是“照片”表中一行的 ID）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-31T06:27:07.837

基本上，根据定义，多态关联增加了与许多其他 Rails ActiveRecord 模型创建关联的能力。

Rails 有两个列来知道关联所指的模型，您有 attachment_type 列（即字符串）（默认值为“照片”，表名：数据库中的照片），并且 attachment_id 有点像该特定模型/表的外键（即照片）。

通常这为您提供了将一个模型与许多其他模型相关联的灵活性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-31T05:41:08.913

多态意味着它可以属于不同的对象（或者，不同表中的不同记录）。它确定这一点的方式是基于 type 和 id 字段。如果您的关联不是多态的，它将只有一个 _id 字段。

# java - 代理背后的 Java Socket 编程

> ID：700161
> 
> 赞同：3
> 
> 时间：2009-03-31T05:43:36.193
> 
> 标签：java, sockets

我已经编写了一个运行良好的 TCP IP 套接字程序。但是如果我的服务器或客户端在代理后面，我的套接字程序就不起作用。那么如何克服这类问题。

谢谢巴皮

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-31T05:47:51.610

那么有两个问题需要考虑：

1.  在代理后面；和
2.  在防火墙后面。

防火墙往往更容易：您只需使用端口 80 (HTTP) 或 443 (HTTPS)。代理更难，因为直接网络通信往往被普通 PC 禁用。

这就是为什么你经常发现人们使用 HTTP 和/或 SSL 作为他们的传输媒介，因为他们绕过了这些类型的安全问题。您可以推送内容（使用长期连接，也就是 Comet 技术），因此通常没有真正的技术理由不这样做。

但是，如果不了解您的应用程序和任何相关要求的更多信息，就很难说这是否是一个好主意。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-31T05:52:22.333

代理通常在应用程序级别工作，而不是在传输级别。以下是有关 Java 和代理的[一些信息。](http://java.sun.com/javase/6/docs/technotes/guides/net/proxies.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-31T05:51:56.093

根据代理的不同，您可能无能为力。如果代理的设计目的是阻止它不直接处理的所有流量，那么您必须通过代理，以某种方式使用它，或者您必须找到一种方法潜入代理。

例如，许多应用程序正是基于 HTTP 构建的，因为它通常允许通过防火墙并且通常对代理友好。因此，当您知道将在可能存在代理的环境中安装应用程序时，这是一种非常安全的通信方式。

在您的情况下，这取决于您的应用程序使用的端口，这些端口是否通常由任何现有协议的代理处理，取决于您是否使用标准（众所周知）协议或发明了您的自己的，等等。

这个代理是透明代理吗？（也就是说，是否必须配置 Web 浏览器才能看到它？）代理的类型决定了您的应用程序需要如何使用它。代理是否由您的组织控制？

你说你用的是5018端口，作为一个实验，你可以试试用80端口吗？仅仅因为您使用端口 80 并不意味着您必须使用 HTTP。这值得一试，看看是否有帮助。

# language-agnostic - 检测文本字符串中的（淘气或漂亮）URL 或链接

> ID：700163
> 
> 赞同：38
> 
> 时间：2009-03-31T05:46:30.820
> 
> 标签：language-agnostic, url, sanitization, spam-prevention

**如何检测（使用正则表达式或启发式）文本字符串（如评论）中的网站链接？**

目的是防止垃圾邮件。HTML 被剥离，所以我需要检测复制和粘贴的邀请。 *垃圾邮件发送者发布链接应该不经济，因为大多数用户无法成功访问该页面*。我想要关于最佳实践的建议、参考或讨论。

一些目标：

*   像格式良好的 URL 一样容易实现的目标 ( `http://some-fqdn/some/valid/path.ext`)
*   URL 但没有`http://`前缀（即有效的 FQDN + 有效的 HTTP 路径）
*   任何其他有趣的事情

当然，我正在阻止垃圾邮件，但是可以使用相同的过程来自动链接文本。

## 想法

这是我在想的一些事情。

*   内容是母语散文，所以我可以在检测中触发快乐
*   我应该先去掉所有空格来捕捉“ `www .example.com`”吗？普通用户会知道自己删除空间，还是让任何浏览器“按我的意思做”并为您剥离它？
*   也许多次传球是一个更好的策略，扫描：
    *   格式正确的 URL
    *   所有非空格后跟“。” 后跟任何有效的 TLD
    *   还要别的吗？

## 相关问题

我已经阅读了这些内容，它们现在记录在此处，因此您可以根据需要在这些问题中引用正则表达式。

*   [用 HTML 链接 javascript 替换 URL](https://stackoverflow.com/questions/37684/replace-url-with-html-links-javascript)
*   [检查字符串是否为有效 URL 的最佳正则表达式是什么](https://stackoverflow.com/questions/161738/what-is-the-best-regular-expression-to-check-if-a-string-is-a-valid-url)
*   [获取 URL 的一部分（正则表达式）](https://stackoverflow.com/questions/27745/getting-parts-of-a-url-regex)

## 更新和总结

哇，我在这里列出了一些非常好的启发式方法！对我来说，最划算的是以下几点的综合：

1.  @Jon Bright 的 TLD 检测技术（一个很好的防御瓶颈）
2.  对于那些可疑的字符串，按照@capar 将点替换为点状字符
3.  @Sharkey 的下标 · 是一个不错的点状字符。（即“ [·] ”）。· 也是一个单词边界，因此很难随意复制和粘贴。

这应该使垃圾邮件发送者的每千次展示费用足够低以满足我的需求；“标记为不适当”的用户反馈应该可以捕捉到其他任何东西。列出的其他解决方案也非常有用：

*   去掉所有虚线四边形（@Sharkey 对他自己的回答的评论）
*   @Sporkmonger 对客户端 Javascript 的要求，它将所需的隐藏字段插入到表单中。
*   ping URL 服务器端以确定它是否是一个网站。（也许我可以通过 SpamAssassin 或其他贝叶斯过滤器按照@Nathan 运行 HTML ..）
*   查看 Chrome 智能地址栏的来源，看看 Google 使用了哪些巧妙的技巧
*   调用 OWASP AntiSAMY 或其他 Web 服务进行垃圾邮件/恶意软件检测。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-04-15T12:15:07.390

我将我的答案集中在试图避免垃圾邮件发送者上。这导致了两个子假设：因此，使用该系统的人将积极尝试违反您的检查，而您的目标只是检测 URL 的存在，而不是提取完整的 URL。如果你的目标是别的东西，这个解决方案看起来会有所不同。

我认为您最好的选择是使用 TLD。有两个字母的 ccTLD 和（当前）相对较小的其他列表。这些需要以点为前缀，并以斜杠或某些单词边界为后缀。正如其他人所指出的，这不会是完美的。如果不禁止合法的“我再试一次。它不起作用”或类似的话，就无法获得“buyfunkypharmaceuticals .it”。综上所述，这将是我的建议：

```
[^\b]\.([a-zA-Z]{2}|aero|asia|biz|cat|com|coop|edu|gov|info|int|jobs|mil|mobi|museum|name|net|org|pro|tel|travel)[\b/] 
```

这将得到的东西：

*   购买funkypharmaceutical **s.it**
*   谷**歌电子商务**
*   [http://stackoverflo](http://stackoverflo) **w.com/**questions/700163/

一旦人们开始混淆他们的 URL，它当然会中断，替换“。” 用“点”。但是，再次假设垃圾邮件发送者是您的目标，如果他们开始做这种事情，他们的点击率将再下降几个数量级，趋向于零。我认为，有足够信息可以对 URL 进行去混淆处理的一组人，以及一组不知道足以访问垃圾邮件站点的人，有一个微不足道的交集。此解决方案应让您检测到所有可复制粘贴到地址栏的 URL，同时将附带损害降至最低。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-14T03:10:11.140

我不确定使用正则表达式检测 URL 是否是解决此问题的正确方法。通常你会错过一些不为人知的边缘情况，如果垃圾邮件发送者有足够的动机，他们就可以利用这些情况。

如果您的目标只是从评论中过滤垃圾邮件，那么您可能需要考虑[贝叶斯](http://en.wikipedia.org/wiki/Bayesian_spam_filtering)过滤。事实证明，它在将电子邮件标记为垃圾邮件方面非常准确，它可能也能为您做同样的事情，具体取决于您需要过滤的文本量。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-15T02:39:28.943

我知道这对自动链接文本没有帮助，但是如果您搜索并用看起来相同的字符替换所有句号，例如希伯来语点 hiriq (U+05B4) 的 unicode 字符，该怎么办？

以下段落是一个示例：

这可能会工作ִ句号看起来有点奇怪，但仍然可读ִ当然好处是任何人复制和粘贴 wwwִgoogleִcom 都不会太远ִ :)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-14T20:09:09.067

嗯，很明显，低垂的果实是以 http:// 和 www 开头的东西。试图过滤掉诸如“www.g mail.com”之类的东西会导致关于你想走多远的有趣的哲学问题。你想采取下一步并过滤掉“www dot gee mail dot com”吗？URL 的抽象描述怎么样，例如“万维网的缩写，后跟一个点，后跟字母 g，后跟单词 mail，后跟一个点，以商业 TLD 缩写结尾”。

在继续尝试设计算法之前，划清您将要尝试过滤的类型的界限很重要。我认为应该在“gmail.com”被视为网址的级别划线，但“gmail.com”不是。否则，每次有人未能将句子中的第一个字母大写时，您都可能会得到误报。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-15T12:55:59.273

由于您主要是在寻找复制并粘贴到浏览器地址栏中的邀请，因此可能值得查看开源浏览器（例如 Chrome 或 Mozilla）中使用的代码，以确定是否输入“地址栏”的文本等效”是搜索查询或 URL 导航尝试。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-18T07:01:36.507

**ping 可能的 URL**

如果您不介意一点服务器端计算，那么像这样的东西呢？

```
urls = []
for possible_url in extracted_urls(comment):
    if pingable(possible_url):
       urls.append(url)  #you could do this as a list comprehension, but OP may not know python 
```

这里：

1.  extract_urls 接受评论并使用保守的正则表达式提取可能的候选者

2.  pingable 实际上使用系统调用来确定主机名是否存在于网络上。你可以有一个简单的包装器来解析 ping 的输出。

    **[ramanujan:~/base]$ping -c 1 www.google.com**

    PING www.l.google.com (74.125.19.147)：来自 74.125.19.147 的 56 个数据字节 64 个字节：icmp_seq=0 ttl=246 time=18.317 ms

    --- www.l.google.com ping 统计 --- 1 个数据包传输，1 个数据包接收，0% 数据包丢失往返 min/avg/max/stddev = 18.317/18.317/18.317/0.000 ms

    **[ramanujan:~/base]$ping -c 1 fooalksdflajkd.com**

    ping：无法解析 fooalksdflajkd.com：**未知主机**

不利的一面是，如果主机提供 404，您将无法检测到它，但这是一个相当不错的第一步——验证地址是否为网站的最终方法是尝试导航到该地址。您也可以尝试获取该 URL，但这是更重量级的。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-15T12:41:25.737

在多次尝试编写这段代码之后，我可以明确地说，您将无法绝对可靠地执行此操作，并且您当然无法检测到 RFC 允许的所有 URI 形式。幸运的是，由于您感兴趣的 URL 集非常有限，您可以使用上述任何技术。

但是，我可以非常肯定地说的另一件事是，如果您真的想击败垃圾邮件发送者，那么最好的方法就是使用 JavaScript。发送一段 JavaScript 执行一些计算，然后在服务器端重复计算。JavaScript 应该将计算结果复制到隐藏字段，以便在提交评论时也提交计算结果。在服务器端验证计算是否正确。绕过此技术的唯一方法是让垃圾邮件发送者手动输入评论，或者让他们开始为您运行 JavaScript 引擎。我使用这种技术将我网站上的垃圾邮件从每天 100 多封减少到每年一到两封。现在我收到的唯一垃圾邮件是人工输入的。收到主题垃圾邮件很奇怪。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-15T12:42:04.127

当然，您意识到如果垃圾邮件发送者决定使用 tinuyrl 或此类服务来缩短他们的 URL，您的问题只会变得更糟。在这种情况下，您可能需要编写一些代码来查找实际的 URL，使用像[TinyURL](http://kiserai.net/turl.pl)解码器这样的服务

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-18T12:07:10.157

考虑合并 OWASP AntiSAMY API...

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-04-19T05:00:54.497

到目前为止，我最喜欢*capar*的答案，但是处理 unicode 字体可能有点麻烦，旧版浏览器通常会显示一个有趣的东西或一个小框……而且 U+05B4 的位置有点奇怪。 .. 对我来说，它出现在管道之外 |ִ| 即使在他们之间。

有一个方便的· (·) 但是，它以相同的方式中断剪切和粘贴。它的垂直对齐可以通过 <sub>ing 来纠正，例如：

堆栈溢出[·] com

反常，但无论如何在FF3中有效，它不能被剪切和粘贴为URL。<sub> 实际上非常好，因为它使 URL 无法粘贴的原因在视觉上很明显。

不在可疑 URL 中的点可以单独放置，例如，您可以这样做

```
s/\b\.\b/<sub>&middot;<\/sub>/g 
```

另一种选择是在可疑点旁边插入某种零宽度实体，但像 ‍ 这样的东西 ‌ 和 &zwsp; 似乎在FF3中不起作用。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-04-19T05:38:45.060

这里已经有一些很好的答案，所以我不会再发布更多。不过，我会给出几个问题。首先，确保测试*已知*的协议，其他任何东西都可能是淘气的。作为一个爱好 telnet 链接的人，您可能希望在搜索中包含更多的 http(s)，但可能希望阻止说 aim: 或其他一些 url。其次，很多人会用尖括号 (gt/lt) 来界定他们的链接，比如 < [http://theroughnecks.net](http://theroughnecks.net) > 或括号“(url)”，没有什么比点击链接更糟糕的了> 或 ) 与 URL 的其余部分一起使用。

PS对自参考插头感到抱歉；）

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-04-24T12:48:26.020

假设给定协议或“www”前缀，我只需要检测带有/out 协议的简单 http url。我发现[上面](/a/700174/4689919)提到的[链接](http://www.regexguru.com/2008/11/detecting-urls-in-a-block-of-text/)很有帮助，但最后我得出了这个：

```
http(s?)://(\S+\.)+\S+|www\d?\.(\S+\.)+\S+ 
```

显然，这并不能测试是否符合 dns 标准。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2019-07-12T12:58:08.507

鉴于我在 Disqus 评论垃圾邮件中看到的类似字符形式的“其他有趣的业务”的混乱，你要做的第一件事就是处理它。

幸运的是，Unicode 人员为您提供了帮助。在您选择的编程语言中挖掘用于 Unicode 易混淆的 TR39 骨架算法的实现，并将其与一些 Unicode 规范化和 Unicode 感知的大写/小写匹配。

骨架算法使用由 Unicode 人员维护的[查找表](https://unicode.org/Public/security/latest/confusables.txt)来做一些概念上类似于大小写折叠的事情。

（输出可能没有使用合理的字符，但是，如果你将它应用到比较的两边，如果字符在视觉上足够相似，足以让人类理解意图，你就会得到匹配。）

下面是[这个 Java 实现](https://github.com/mpkorstanje/tr39-confusables)的一个例子：

```
// Skeleton representations of unicode strings containing 
// confusable characters are equal 
skeleton("paypal").equals(skeleton("paypal")); // true
skeleton("paypal").equals(skeleton("ỿℓ")); // true
skeleton("paypal").equals(skeleton("ρ⍺уן")); // true
skeleton("ρ⍺уן").equals(skeleton("ỿℓ")); // true
skeleton("ρ⍺уן").equals(skeleton("ỿℓ")); // true

// The skeleton representation does not transform case
skeleton("payPal").equals(skeleton("paypal")); // false

// The skeleton representation does not remove diacritics
skeleton("paypal").equals(skeleton("pàỳpąl")); // false 
```

（如您所见，您需要先进行一些其他规范化。）

鉴于您正在执行 URL 检测以判断某些内容是否为垃圾邮件，这可能是一种[不常见](https://eev.ee/blog/2015/09/12/dark-corners-of-unicode/)的情况，可以安全地开始将 Unicode 规范化为 NFKD，然后剥离声明为组合字符的代码点。

（然后，您需要在将案例提供给骨架算法之前对其进行规范化。）

我建议您执行以下操作之一：

1.  编写代码以在字符分解之前和之后运行混淆检查，以防在分解之前而不是之后被认为是可混淆的，并检查大写和小写的字符串，以防混淆表在大写和小写形式。
2.  通过编写一个小脚本来检查 Unicode 表并确定分解或小写/大写一对字符是否会改变的任何代码点，从而调查 #1 是否真的是一个问题（如果不是，则无需浪费 CPU 时间）认为相互混淆。

# asp.net-mvc - 允许多个角色访问控制器操作

> ID：700166
> 
> 赞同：309
> 
> 时间：2009-03-31T05:49:03.153
> 
> 标签：asp.net-mvc, controller, roles

现在我装饰了一个这样的方法来允许“成员”访问我的控制器操作

```
[Authorize(Roles="members")] 
```

**如何允许多个角色？**例如，以下内容不起作用，但它显示了我正在尝试做的事情（允许“成员”和“管理员”访问）：

```
[Authorize(Roles="members", "admin")] 
```

* * *

## 回答 #1

> 赞同：645
> 
> 时间：2009-10-01T13:14:00.350

另一种选择是在您发布时使用单个授权过滤器，但删除内部引用。

```
[Authorize(Roles="members,admin")] 
```

* * *

## 回答 #2

> 赞同：152
> 
> 时间：2012-05-23T15:32:34.653

如果你想使用自定义角色，你可以这样做：

`CustomRoles`班级：

```
public static class CustomRoles
{
    public const string Administrator = "Administrador";
    public const string User = "Usuario";
} 
```

用法

```
[Authorize(Roles = CustomRoles.Administrator +","+ CustomRoles.User)] 
```

如果您的角色很少，也许您可​​以像这样组合它们（为了清楚起见）：

```
public static class CustomRoles
{
     public const string Administrator = "Administrador";
     public const string User = "Usuario";
     public const string AdministratorOrUser = Administrator + "," + User;  
} 
```

用法

```
[Authorize(Roles = CustomRoles.AdministratorOrUser)] 
```

* * *

## 回答 #3

> 赞同：98
> 
> 时间：2014-03-25T18:21:25.217

一种可能的简化是子类`AuthorizeAttribute`：

```
public class RolesAttribute : AuthorizeAttribute
{
    public RolesAttribute(params string[] roles)
    {
        Roles = String.Join(",", roles);
    }
} 
```

用法：

```
[Roles("members", "admin")] 
```

从语义上讲，它与 Jim Schmehil 的回答相同。

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2014-02-19T20:42:59.333

对于 MVC4，在我的角色中使用`Enum`( `UserRoles`)，我使用自定义`AuthorizeAttribute`.

在我控制的行动中，我会：

```
[CustomAuthorize(UserRoles.Admin, UserRoles.User)]
public ActionResult ChangePassword()
{
    return View();
} 
```

我使用这样的自定义`AuthorizeAttribute`：

```
[AttributeUsage(AttributeTargets.Method | AttributeTargets.Class, Inherited = true, AllowMultiple = true)]
public class CustomAuthorize : AuthorizeAttribute
{
    private string[] UserProfilesRequired { get; set; }

    public CustomAuthorize(params object[] userProfilesRequired)
    {
        if (userProfilesRequired.Any(p => p.GetType().BaseType != typeof(Enum)))
            throw new ArgumentException("userProfilesRequired");

        this.UserProfilesRequired = userProfilesRequired.Select(p => Enum.GetName(p.GetType(), p)).ToArray();
    }

    public override void OnAuthorization(AuthorizationContext context)
    {
        bool authorized = false;

        foreach (var role in this.UserProfilesRequired)
            if (HttpContext.Current.User.IsInRole(role))
            {
                authorized = true;
                break;
            }

        if (!authorized)
        {
            var url = new UrlHelper(context.RequestContext);
            var logonUrl = url.Action("Http", "Error", new { Id = 401, Area = "" });
            context.Result = new RedirectResult(logonUrl);

            return;
        }
    }
} 
```

这是 Fabricio Martínez Tamayo 修改的 FNHMVC 的一部分[https://github.com/fabriciomrtnz/FNHMVC/](https://github.com/fabriciomrtnz/FNHMVC/)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2018-10-18T18:39:41.643

使用 AspNetCore 2.x，您必须采取一些不同的方式：

```
[AttributeUsage(AttributeTargets.Method | AttributeTargets.Class, Inherited = true, AllowMultiple = true)]
public class AuthorizeRoleAttribute : AuthorizeAttribute
{
    public AuthorizeRoleAttribute(params YourEnum[] roles)
    {
        Policy = string.Join(",", roles.Select(r => r.GetDescription()));
    }
} 
```

像这样使用它：

```
[Authorize(YourEnum.Role1, YourEnum.Role2)] 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2021-01-06T02:33:33.117

您可以在 Startup.cs 中使用授权策略

```
 services.AddAuthorization(options =>
    {
        options.AddPolicy("admin", policy => policy.RequireRole("SuperAdmin","Admin"));
        options.AddPolicy("teacher", policy => policy.RequireRole("SuperAdmin", "Admin", "Teacher"));
    }); 
```

在控制器文件中：

```
 [Authorize(Policy = "teacher")]
 [HttpGet("stats/{id}")]
 public async Task<IActionResult> getStudentStats(int id)
 { ... } 
```

“教师”政策接受 3 个角色。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2018-02-15T19:57:48.420

如果您发现自己经常应用这两个角色，您可以将它们包装在他们自己的 Authorize 中。这实际上是已接受答案的扩展。

```
using System.Web.Mvc;

public class AuthorizeAdminOrMember : AuthorizeAttribute
{
    public AuthorizeAdminOrMember()
    {
        Roles = "members, admin";
    }
} 
```

然后将您的新授权应用于操作。我认为这看起来更干净并且易于阅读。

```
public class MyController : Controller
{
    [AuthorizeAdminOrMember]
    public ActionResult MyAction()
    {
        return null;
    }
} 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2017-02-22T00:19:44.687

另一个明确的解决方案，您可以使用常量来保持约定并添加多个 [Authorize] 属性。看一下这个：

```
public static class RolesConvention
{
    public const string Administrator = "Administrator";
    public const string Guest = "Guest";
} 
```

然后在控制器中：

```
[Authorize(Roles = RolesConvention.Administrator )]
[Authorize(Roles = RolesConvention.Guest)]
[Produces("application/json")]
[Route("api/[controller]")]
public class MyController : Controller 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2016-01-27T07:20:44.083

添加子类的代码更好`AuthorizeRole.cs`

```
 [AttributeUsage(AttributeTargets.Method | AttributeTargets.Class, Inherited = true, AllowMultiple = true)]
    class AuthorizeRoleAttribute : AuthorizeAttribute
    {
        public AuthorizeRoleAttribute(params Rolenames[] roles)
        {
            this.Roles = string.Join(",", roles.Select(r => Enum.GetName(r.GetType(), r)));
        }
        protected override void HandleUnauthorizedRequest(System.Web.Mvc.AuthorizationContext filterContext)
        {
            if (filterContext.HttpContext.Request.IsAuthenticated)
            {
                filterContext.Result = new RedirectToRouteResult(
                new RouteValueDictionary {
                  { "action", "Unauthorized" },
                  { "controller", "Home" },
                  { "area", "" }
                  }
              );
                //base.HandleUnauthorizedRequest(filterContext);
            }
            else
            {
                filterContext.Result = new RedirectToRouteResult(
                new RouteValueDictionary {
                  { "action", "Login" },
                  { "controller", "Account" },
                  { "area", "" },
                  { "returnUrl", HttpContext.Current.Request.Url }
                  }
              );
            }
        }
    } 
```

如何使用这个

```
[AuthorizeRole(Rolenames.Admin,Rolenames.Member)]

public ActionResult Index()
{
return View();
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2022-03-01T01:17:38.653

```
[Authorize(Roles="admin")]
[Authorize(Roles="members")] 
```

将在`AND`需要时工作（如问题所问），而[此](https://stackoverflow.com/a/1503873/2361131)答案显示`OR`版本。[在https://docs.microsoft.com/en-us/aspnet/core/security/authorization/roles?view=aspnetcore-6.0#adding-role-checks](https://docs.microsoft.com/en-us/aspnet/core/security/authorization/roles?view=aspnetcore-6.0#adding-role-checks)查看更多信息

* * *

## 回答 #11

> 赞同：-9
> 
> 时间：2020-01-03T15:04:37.070

```
Intent promptInstall = new Intent(android.content.Intent.ACTION_VIEW);
promptInstall.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
promptInstall.setDataAndType(Uri.parse("http://10.0.2.2:8081/MyAPPStore/apk/Teflouki.apk"), "application/vnd.android.package-archive" );

startActivity(promptInstall); 
```

# java - 如何使用 JavaScript 处理 Java 对象序列化？

> ID：700176
> 
> 赞同：0
> 
> 时间：2009-03-31T05:56:11.763
> 
> 标签：java, javascript, xml

```
public class Person {
  private String firstname;
  private String lastname;
  private PhoneNumber phone;
  private PhoneNumber fax;
  // ... constructors and methods
  private void calculate()
  {
  }
} 
```

我已经序列化了位于服务器端的 Java 对象并将其发送到客户端

```
XStream xstream = new XStream(new DomDriver()); 

Person joe = new Person("Joe", "Walnes");
joe.setPhone(new PhoneNumber(123, "1234-456"));
joe.setFax(new PhoneNumber(123, "9999-999"));

String xml = xstream.toXML(joe); 
```

如何使用 JavaScript 将该 XML 字符串反序列化为 Java 对象，并使用 JavaScript 在客户端执行 person 类的方法？

请帮助我语法或任何指导方针。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-31T07:14:01.590

您可以通过使用 SOAP 在客户端使用 JavaScript 调用 Java 方法。本文[解释](http://java.sun.com/developer/technicalArticles/J2EE/j2ee_ws/)了如何创建任何支持 WSDL 的 SOAP 客户端都可以访问的 WSDL Web 服务。

然后，您可以使用 JavaScript 中的 AJAX 调用 Java WSDL 服务（如果您可以找到实现 SOAP 和 WSDL 的 JS 库）。

或者，您可以使用 PHP 的内置 SoapClient 库在 PHP 中编写 Java WSDL 服务的简化前端。让它接受一些简单的 GET 参数并返回 JSON 或 XML。然后，您可以通过 jQuery（或等效的 AJAX 支持库）使用 AJAX 轻松访问 PHP Web 服务。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-31T07:29:30.557

如果您要使用小程序并希望从 Java 进行 Javascript 调用，请检查带有 JSObject 包装器类的[LiveConnect 。](http://java.sun.com/products/plugin/1.3/docs/jsobject.html)这样您就可以在小程序中执行 javascript 函数（并在其间传递信息）；

```
Executor exe = Executors.newSingleThreadExecutor();
final JSObject page = JSObject.getWindow(applet);

if (page == null) {
    /* Break here, no connection could be made */
}

final String javascriptFunction = "yourJavaScriptFunction()";
executor.execute(new Runnable() {
    public void run() {
        page.eval(javascriptFunction);
    }
}); 
```

查看为 Flickr 制作的 IRIS 应用程序，它是开源的并使用了这种技术。比利时 JUG Parleys 在一次会议上发表了演讲，涵盖了其中的一些内容，[您可以在此处找到](http://parleys.com/display/PARLEYS/Home#talk=11763724;slide=25;title=IRIS%2C%20a%20RIA%20swing%20applet)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-31T06:01:45.853

XML 以 DOM 树的形式呈现给 JavaScript

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-03-31T06:05:22.397

您不能使用 Javascript 运行 Java 方法。您唯一能做的就是读取 Java 对象的属性——这是在 XML 文件中序列化的唯一信息。使用 javascript 读取 XML非常[容易。](http://www.w3schools.com/Xml/xml_parser.asp)

为了能够序列化 Java 对象，将其发送到客户端并执行 Java 代码，需要完全不同的架构。首先，您还需要在客户端上运行 Java。然后你需要使用像 RMI 这样的方法。

# flash - FLVPlayback 组件应该怎么做

> ID：700179
> 
> 赞同：0
> 
> 时间：2009-03-31T05:56:59.983
> 
> 标签：flash, flvplayback

我正在尝试将 ' `FLVPlayback`' 组件添加到一个非常简单的 Flash 电影中，如[Adob​​e 网站上所述。](http://www.adobe.com/devnet/flash/quickstart/flvplayback_component/)

我完全没有问题使用此代码动态实例化 FLVPlayback 对象。

```
import fl.video.*;

var flvPlayer:FLVPlayback = new FLVPlayback();
addChild(flvPlayer);
//The next line assumes you have copied the skin file to the local directory
flvPlayer.skin = "./SkinUnderPlaySeekMute.swf"
flvPlayer.source = "http://www.helpexamples.com/flash/video/water.flv"; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-10-06T07:46:15.497

你可以试试这个作为你的起点，我得到了一些东西：http: [//www.adobe.com/devnet/flash/articles/flvplayback_programming.html](http://www.adobe.com/devnet/flash/articles/flvplayback_programming.html)

# vim - 带有 vim 模式的文本编辑器？

> ID：700186
> 
> 赞同：39
> 
> 时间：2009-03-31T06:01:50.017
> 
> 标签：vim, text-editor, viemu

我遇到了[ViEmu](http://www.viemu.com/)，我读了一篇非常鼓舞人心的文章：[为什么，哦，为什么，做那些#?@！疯子用vi？](http://www.viemu.com/a-why-vi-vim.html)

不管怎样，我开始喜欢 vim 中的命令模式，特别是动作，我也喜欢 ViEmu 背后的想法，即将“vim 模式”带入一个典型的文本编辑器。

还有哪些其他编辑器具有类似的“vim 模式”或提供该功能的插件？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2016-01-22T23:48:04.787

我自己是 vim 的忠实粉丝，所以每当我尝试新的 IDE 时，我都会立即寻找 vim 插件。这是我找到的插件的简短列表：

*   **[Atom](https://atom.io/)** - [vim 模式](https://github.com/atom/vim-mode)
*   **[Eclipse](https://eclipse.org)** - [Vrapper](http://vrapper.sourceforge.net/home/) / [Vimplugin](http://www.vimplugin.org/) / [Eclim](http://eclim.org/)
*   **[Idea](https://www.jetbrains.com/idea/)** / **[WebStorm](https://www.jetbrains.com/webstorm/)** / **[pyCharm](https://www.jetbrains.com/pycharm/)** / **[RubyMine](https://www.jetbrains.com/ruby/)** / **[CLion](https://www.jetbrains.com/clion/)** / **[PhpStorm](https://www.jetbrains.com/phpstorm/)** / **[AppCode](https://www.jetbrains.com/objc/)** - [IdeaVim](https://github.com/JetBrains/ideavim)
*   **[NetBeans](https://netbeans.org/)** - [jVi](http://jvi.sourceforge.net/)
*   **[记事本++](https://notepad-plus-plus.org/)** - [ViSimulator](http://www.visimulator.com/)
*   **[Visual Studio](https://www.visualstudio.com/)** - [ViEmu](http://www.viemu.com/) / [vsvim](https://visualstudiogallery.msdn.microsoft.com/59ca71b3-a4a3-46ca-8fe1-0e90e3f79329 "与vim")
*   **[Xcode](https://developer.apple.com/xcode/)** - [Xvim](http://xvim.org/)

此外，一些编辑器/IDE 具有内置的 vim 模式：

*   **[AbiWord](http://abisource.com/)**文字处理器支持 vi 键绑定。
*   **[Kate](https://kate-editor.org/)**文本编辑器包括 vi 模式。
*   **[QtCreator](http://wiki.qt.io/Category:Tools::QtCreator)**有[FakeVim](http://doc.qt.io/qtcreator/creator-editor-fakevim.html)模式。
*   **[Sublime Text](http://www.sublimetext.com/)**有[复古模式](https://www.sublimetext.com/docs/2/vintage.html)。
*   甚至**[Emacs](https://www.gnu.org/software/emacs/)**也有[viper-mode](http://www.gnu.org/software/emacs/manual/html_mono/viper.html)！
*   **bash、gdb、mysql-client**和许多其他应用程序使用 GNU Readline 库与用户交互。Readline 包括 vi 模式。
*   **在像ksh**和**zsh**这样的 Bourne 风格的 shell中，键入 set -o vi 以启用类似 vi 的命令行编辑。
*   **[ViEmu](http://www.viemu.com/)**也适用于 Microsoft Outlook、Microsoft SQL Server 和 Word！

奖金 -*网络浏览器*！真的，试试吧，太棒了！

*   **火狐**- [vimperator](http://vimperator.org/trac/wiki/Vimperator)
*   **铬/铬**- [cvim](https://chrome.google.com/webstore/detail/cvim/ihlenndgcmojhcghmfjfneahoeklbjjh?hl=en) / [vimium](https://chrome.google.com/webstore/detail/vimium/dbepggeogbaibhgnhhndojpepiihcmeb)
*   **遗憾的是， Opera**的所有 vi 插件似乎都已过时。

如果我忘记了什么，请告诉我，我很乐意扩展列表。如需更广泛的列表（有时令人遗憾地过时了），请参阅[这篇文章](http://texteditors.org/cgi-bin/wiki.pl?ViFamily "本文")。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-03-31T21:58:07.597

值得注意的是，vi 不仅仅是键绑定。正如[这篇博](http://weierophinney.net/matthew/archives/211-Why-Vim-Plugins-for-IDEs-Fail.html)文所述，没有任何 IDE 插件可以模拟 vi 的所有功能。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-03-31T06:14:26.650

[Editra](http://editra.org/)有[vim 模式](http://editra.org/vi_emulation)

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-10-28T14:37:18.267

查看 Eclipse 的优秀[Vrapper](http://vrapper.sourceforge.net/home/)插件。

> Vrapper 是一个 Eclipse 插件，它充当 Eclipse 文本编辑器的包装器，为移动和编辑文本提供类似 Vim 的输入方案。
> 
> 与在 Eclipse 中嵌入 Vim 的其他插件不同，Vrapper 模仿 Vim 的行为，同时仍然使用您在工作台中打开的任何编辑器。目标是让不同模式、复杂命令和计数/操作符/动作组合带来的舒适和轻松，这些是使用 Vim 进行编辑的关键特性，同时保留不同 Eclipse 文本编辑器的强大特性，如代码生成和重构。
> 
> Vrapper 试图为 Eclipse 用户提供两全其美的体验。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-03-31T06:05:25.500

我主要使用：

*   [带有ViEmu](http://www.viemu.com/)的 Visual Studio
*   带有[jVi的 NetBeans](http://jvi.sourceforge.net/)

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2012-02-01T13:13:41.093

[Sublime Text](http://www.sublimetext.com/)具有用于 vi 样式编辑的[复古模式。](http://www.sublimetext.com/docs/2/vintage.html)

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2009-03-31T21:46:05.597

火狐用户：

*   设置[都是文字！](https://addons.mozilla.org/en-US/firefox/addon/4125)使用外部 vim - 它可以让你在 vim 中编辑这些文本框
*   [Vimperator](http://vimperator.org/trac/wiki/Vimperator)也很酷。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2009-03-31T16:31:22.453

Emacs 有[viper-mode](http://www.gnu.org/software/emacs/manual/html_mono/viper.html)，它提供了多个级别的 Vi 仿真（从更类似于 Vi 到更类似于 Emacs）。手册描述如下：

```
 Viper Is a Package for Emacs Rebels;
 it is a VI Plan for Emacs Rescue
 and/or a venomous VI PERil. 
```

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2009-03-31T07:37:39.663

[Komodo Edit](http://www.activestate.com/komodo_edit/)具有相当不错的 Vi 仿真模式。它对于代码感知等也非常有用。并且支持多种语言。Linux 和 Windows……该死的，我应该和这些家伙一起受委托……等一下，它是免费软件……该死！该死！该死！

无论如何...好的编辑器，Linux 和 Windows，免费，Vi（和 Emacs）仿真。

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2009-03-31T06:07:57.693

似乎[eclim 插件可以帮助您将真正的 GVim 嵌入到 Eclipse](http://eclim.sourceforge.net/eclimd.html#gvim-embedded)中。

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2010-10-10T21:22:15.837

[http://texteditors.org/cgi-bin/wiki.pl?ViFamily](http://texteditors.org/cgi-bin/wiki.pl?ViFamily)包含一长串 vi 克隆和一长串 vi 实现。第二个列表可能包括十几个带有“Vim 模式”的文本编辑器。

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2009-03-31T16:24:18.523

[Qt Creator](http://www.qtsoftware.com/products/appdev/developer-tools/developer-tools)有一个用于编辑的“vim 模式”，但它目前缺乏一些能力；同样，如果没有 .vimrc 中的设置，我会感到手足无措。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2009-04-01T10:14:44.803

还有用于 Eclipse 的免费软件[Vimplugin——](http://vimplugin.org/)它将 Vim 嵌入到 Eclipse 中，但是你失去了 Eclipse 提供的所有导航和代码完成功能，因此它的有用性是有争议的。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2009-03-31T06:03:36.253

我正在为 Eclipse 使用[viPlugin](http://www.viplugin.com/viplugin/)。不幸的是，它不是免费的，但它适用于所有基本的 Vim 命令。

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2009-03-31T06:12:47.480

[Slickedit](http://www.slickedit.com/products/slickedit/cool-features#commandline)有非常好的 vim 仿真。我做过的最合理的购买之一。

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2011-11-10T02:43:23.693

我发现[Sublime Text 2](http://www.sublimetext.com/2)中的 vim 模式非常棒，加上出色的扩展和出色的性能，使其成为我全年花费的 59 美元中最好的之一。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-03-31T21:57:34.213

~~[伊兹](http://www.yzis.org/wiki/index.php/Main_Page)~~受 vim 启发的类 vi 编辑器。

> Yzis 的目标是成为一个功能强大、速度快的编辑器，具有 Vim 的所有功能，并且希望在某个时候能够提供更多功能。（*引自 Yzis 网站*）

* * *

**编辑：***yzis*项目似乎已经死了。[互联网档案有 yzis 页面的](http://web.archive.org/web/20080602035203/www.yzis.org/wiki/index.php?title=Status)副本。

# unicode - Unicode、UTF、ASCII、ANSI 格式差异

> ID：700187
> 
> 赞同：383
> 
> 时间：2009-03-31T06:02:25.320
> 
> 标签：unicode, character-encoding, ascii, ansi, utf

`Unicode`, `UTF8`, `UTF7`, `UTF16`, `UTF32`, `ASCII`, 和`ANSI`编码有什么区别？

这些对程序员有什么帮助？

* * *

## 回答 #1

> 赞同：516
> 
> 时间：2009-03-31T06:15:04.150

往下看你的清单：

*   “ [Unicode](https://en.wikipedia.org/wiki/Unicode) ” 不是一种编码，尽管不幸的是，许多文档不精确地使用它来指代特定系统默认使用的任何 Unicode 编码。在 Windows 和 Java 上，这通常意味着 UTF-16；在许多其他地方，它意味着 UTF-8。正确地说，Unicode 指的是抽象字符集本身，而不是任何特定的编码。
*   [UTF-16](http://en.wikipedia.org/wiki/UTF-16)：每个“代码单元”2 个字节。这是 .NET 中字符串的本机格式，通常在 Windows 和 Java 中。[基本多语言平面](http://en.wikipedia.org/wiki/Basic_Multilingual_Plane)(BMP)之外的值被编码为代理对。这些*过去*很少使用，但现在许多消费者应用程序需要注意非 BMP 字符才能支持表情符号。
*   [UTF-8](http://en.wikipedia.org/wiki/UTF-8)：可变长度编码，每个码点 1-4 个字节。ASCII 值使用 1 个字节编码为 ASCII。
*   [UTF-7](http://en.wikipedia.org/wiki/UTF-7)：通常用于邮件编码。如果你认为你需要它并且你没有做邮件，那么你就错了。（这只是我在新闻组等中发帖的经验——在邮件之外，它实际上并没有被广泛使用。）
*   [UTF-32](http://en.wikipedia.org/wiki/UTF-32)：固定宽度编码，每个代码点使用 4 个字节。这不是很有效，但使 BMP 之外的生活更轻松。我有一个 .NET`Utf32String`类作为我的[MiscUtil](http://pobox.com/~skeet/csharp/miscutil)库的一部分，如果你想要的话。（请注意，它没有经过非常彻底的测试。）
*   [ASCII](http://en.wikipedia.org/wiki/ASCII)：仅使用低 7 位的单字节编码。（Unicode 代码点 0-127。）没有重音符号等。
*   ANSI：没有固定的 ANSI 编码——有很多。通常当人们说“ANSI”时，他们的意思是“我系统的默认语言环境/代码页”，它是通过[Encoding.Default](http://msdn.microsoft.com/en-us/library/system.text.encoding.default.aspx)获得的，通常是[Windows-1252](http://en.wikipedia.org/wiki/Windows-1252)，但也可以是其他语言环境。

[我的 Unicode 页面](http://csharpindepth.com/Articles/General/Unicode.aspx)上还有更多关于[调试 Unicode 问题的提示](http://csharpindepth.com/Articles/General/DebuggingUnicode.aspx)。

另一个重要的代码资源是[unicode.org](http://unicode.org)，它包含的信息比您能够通过自己的方式工作的更多——可能最有用的部分是[代码图表](http://unicode.org/charts)。

* * *

## 回答 #2

> 赞同：77
> 
> 时间：2009-03-31T06:10:06.970

一些读物让您开始了解字符编码： [Joel on Software：每个软件开发人员绝对、肯定必须了解 Unicode 和字符集的绝对最低要求（没有借口！）](http://www.joelonsoftware.com/articles/Unicode.html)

顺便说一句 - ASP.NET 与它无关。编码是通用的。

# c++ - 大量 sp_counted_impl_p 对象

> ID：700188
> 
> 赞同：0
> 
> 时间：2009-03-31T06:02:34.557
> 
> 标签：c++, boost, smart-pointers

我刚刚对我的应用程序中每种类型的对象数量进行了[分配分析。](https://stackoverflow.com/questions/700097/memory-allocation-profiling-in-c/700180#700180)我正在广泛使用 boost::shared_ptr。

我发现分配了大量的 sp_counted_impl_p 对象，每个占用 16 个字节。每个 shared_ptr 可以预期有多少 sp_counted_impl_p 对象？有人有想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-31T07:03:03.583

对于我在实现中可以看到的，每个 shared_ptr 只有一个。但是，请注意 boost 在内部使用了更多对象，它们可能直接使用这个计数的类或 shared_ptr 本身。另外，如果你使用 boost.serialization 框架，它也是基于这个类/机制的。无论如何，以“大数”来说，有多少？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-31T07:47:17.207

您指向的每个对象都应该有一个`shared_ptr`. 如果它们更多，您可能没有`shared_ptr`正确使用，并且您正在乞求诸如双释放错误之类的麻烦。

# flash - 我可以在 Flash 的第 2 帧而不是第 1 帧中加载 FLVPlayback 组件定义吗？

> ID：700189
> 
> 赞同：0
> 
> 时间：2009-03-31T06:03:17.097
> 
> 标签：flash

我正在尝试将 ' `FLVPlayback`' 组件添加到一个非常简单的 Flash 电影中，如[Adob​​e 网站上所述。](http://www.adobe.com/devnet/flash/quickstart/flvplayback_component/)它只有一个文本标题和一个简单的矢量图形边框。

使用此代码动态实例化 FLVPlayback 对象或在时间轴上创建实例，我完全没有问题。在任何一种情况下，由于视频播放器的定义，电影大小都会增加到大约 50kb。

```
import fl.video.*;

var flvPlayer:FLVPlayback = new FLVPlayback();
addChild(flvPlayer);
//The next line assumes you have copied the skin file to the local directory
flvPlayer.skin = "./SkinUnderPlaySeekMute.swf"
flvPlayer.source = "http://www.helpexamples.com/flash/video/water.flv"; 
```

问题是我希望在 Flash 电影开始流式传输时立即加载第 1 帧上的图形。当我运行带宽分析器时，第一帧为 50kb，即使此操作脚本直到第二帧才执行 - 或者 FLVPlayback 实例未添加到第 2 帧。

我尝试为 FLVPlayback 组件的链接关闭“在第一帧中导出”，但这没有什么区别。

解决方法：

创建从图形皮肤加载的第二个 FLV 电影。

问题 ：

我真的必须这样做吗？如果没有引用，是否没有办法让组件定义在第 2 帧之前不加载？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-01T01:15:22.180

将发布设置 -> Actionscript 设置下的“导出帧中的类”选项更改为 2。您还需要确保第一帧（和 Document 类）中舞台上的所有对象都不包含对FLVPlayback 类。

# c# - 如何附加不是来自数据库的实体框架对象？

> ID：700192
> 
> 赞同：23
> 
> 时间：2009-03-31T06:04:37.407
> 
> 标签：c#, entity-framework, .net-3.5, linq-to-entities

我完全分离了我的实体框架对象和我的 POCO 对象，我只是来回翻译它们......

IE：

```
// poco
public class Author
{
   public Guid Id { get; set; }
   public string UserName { get; set; }
} 
```

然后我有一个具有相同属性的 EF 对象“作者”..

所以我有我的业务对象

```
var author = new Author { UserName="foo", Id="Guid thats in the db" }; 
```

我想保存这个对象，所以我执行以下操作：

```
var dbAuthor = new dbAuthor { Id=author.Id, UserName=author.UserName };
entities.Attach(dbAuthor);
entities.SaveChanges(); 
```

但这给了我以下错误：

> 具有空 EntityKey 值的对象不能附加到对象上下文。

**编辑：** 看起来我必须使用entities.AttachTo("Authors", dbAuthor); 在没有 EntityKey 的情况下附加，但是我有硬编码的魔法字符串，如果我完全更改我的实体集名称，它会中断并且我不会有任何编译时间检查...有没有一种方法可以附加来保持编译时间检查?

我希望我能够做到这一点，因为硬编码的字符串会扼杀编译时验证 =)

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-08T06:51:06.803

现在才看到这个。如果你想 Attach() 到 ObjectContext，即让实体框架相信一个实体已经存在于数据库中，并且你想避免使用魔术字符串，即

```
ctx.AttachTo("EntitySet", entity); 
```

你可以尝试基于扩展方法的两种可能性，这两种可能性都绝对让生活更容易忍受。

第一个选项允许您编写：

```
ctx.AttachToDefault(entity); 
```

并在此处进行介绍：[技巧 13 - 如何以简单的方式附加实体](http://blogs.msdn.com/alexj/archive/2009/04/15/tip-13-how-to-attach-an-entity-the-easy-way.aspx)

第二个选项允许您编写：

```
ctx.EntitySet.Attach(entity); 
```

并在此处进行介绍：[技巧 16 - 今天如何模仿 .NET 4.0 的 ObjectSet](http://blogs.msdn.com/alexj/archive/2009/05/01/tip-16-how-to-mimic-net-4-0-s-objectset-t-today.aspx)

如您所见，两者都非常易于使用并且完全避免使用字符串。

希望这可以帮助

亚历克斯

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-03-31T06:22:14.603

您是否尝试过使用[AttachTo](http://msdn.microsoft.com/en-us/library/system.data.objects.objectcontext.attachto.aspx)并指定实体集？...

```
entities.AttachTo("Authors", dbAuthor); 
```

`"Authors"`您的实际实体集名称在哪里。

编辑：
是的，有更好的方法（应该有）。设计人员应该已经为您生成了 ObjectContext 的[“添加”方法](http://msdn.microsoft.com/en-us/library/system.data.objects.objectcontext.addobject.aspx)，这些方法可以转换为上面的调用。所以您应该能够做到：

```
entities.AddToAuthors(dbAuthor); 
```

从字面上看应该是：

```
public void AddToAuthors(Authors authors)
{
    base.AddObject("Authors", authors);
} 
```

在whateverobjectcontext.designer.cs 文件中定义。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-11-16T03:32:16.153

如果您不想使用 EntitySet 名称编写字符串，请尝试此操作

```
entities.AttachTo(entities.CreateObjectSet<T>().EntitySet.Name, entity); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-11-15T03:10:05.240

如果您不知道要在哪个实体上操作，则可以使用以下替代方法：

```
string className = entityObject.GetType().Name;
var container = _DbContext.MetadataWorkspace.GetEntityContainer(_DbContext.DefaultContainerName, DataSpace.CSpace);
string setName = (from meta in container.BaseEntitySets
                  where meta.ElementType.Name == className
                  select meta.Name).First();
_DbContext.AttachTo(setName, entityObject); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-21T19:57:43.757

你可以尝试以下

```
entities.AddToAuthors(dbAuthor); 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2010-10-13T14:36:52.850

为了我，

```
Context.Authors.AddObject(new Author()) 
```

完美运行。想知道我是否遗漏了什么？或者这不是正确的方法？

# .net - 是否有任何免费库可以在 .NET 中播放各种声音格式？

> ID：700202
> 
> 赞同：3
> 
> 时间：2009-03-31T06:08:12.250
> 
> 标签：.net, audio

我想在我的应用程序中播放声音，据我所知，.net 默认只能处理 wav 文件。有没有我可以使用的声音播放库？我知道贝斯，但它不能免费用于商业用途。任何指针都会有所帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-31T06:29:04.773

您可以使用[DirectShow.NET](http://directshownet.sourceforge.net/)，它是开源的，并允许您播放您拥有编解码器的音频文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-31T06:11:52.507

最简单的方法是嵌入 Windows Media Player，[就像这里所做的那样](http://www.codeproject.com/KB/vb/Play_sound_in_VBnet_with.aspx)。是否有您想要支持的特定格式？

# asp.net - 加速 ASP.NET 开发

> ID：700206
> 
> 赞同：5
> 
> 时间：2009-03-31T06:10:39.670
> 
> 标签：asp.net, performance, dotnetnuke, appdomain

我们正在开发使用 DotNetNuke 作为框架的 Web 应用程序，并使用我们的自定义模块来实现所需的功能。问题是，当您对代码进行任何更改时，加载网站需要很长时间。我每次重新启动最多需要 1 分钟，这真的很慢。这导致非常缓慢的开发-重建-测试周期。

我们正在使用控制台项目和 winforms 项目作为新功能的测试平台，以加快开发速度，但仍有许多 UI 功能必须通过浏览器完成。

是否有人对如何加快/防止在 Web 应用程序的 bin 文件夹中发生更改时发生的 appdomain 重启有任何提示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-31T06:18:56.093

当您添加/更改页面时，DNN 会按需编译，如果您预编译它们，您的周转时间应该会快得多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-04-26T05:44:41.363

当与大型 Web 应用程序一起使用时，您遇到了 ASP.NET 的一个缺点。

DotNetNuke 有许多重要的 DLL 和 VB 文件，如果您所做的只是更改一个 DLL，它们都必须重新处理。如果您的 bin 中有 50 个模块 DLL，则所有 50 个模块 DLL 将在您的下一个应用程序请求时由 ASP.Net 重新处理。

这是我的建议：

将以下文件夹连接到源代码管理（不是整个 DNN 文件夹）：

*   bin（我建议忽略所有 DNN DLL，以便升级更顺畅）
*   Portals_default\Skins
*   Portals_default\Containers
*   js
*   DesktopModules（忽略管理员或任何内置模块）
*   图像（如果您愿意，可以忽略核心 DNN 图像，或者您自己的任何笨重图像文件夹，例如数千张客户照片）
*   （可选）CompanyName\（您可能希望将其他需要对 DLL 的相对访问权限的 .NET 项目保留在 bin 文件夹中）

当您的一位开发人员需要重复编译/页面加载时，他将通过消除 bin 文件夹中尽可能多的 DLL 获得最大收益。如果可以的话，它也将有助于使用准系统皮肤进行测试（它们很容易制作）。

准系统皮肤（最多应使用 1 或 2 个皮肤对象）和绝对最少的 DLL（DNN 核心 + 您自己的最低限度）将为您提供最佳的开发速度。

当您的开发人员完成一个模块的重点开发后，他可以更新他从源代码管理中删除项目的那些文件夹（此处为 svn），在完整的 DLL/Skin 集的上下文中完成对他的代码的测试，他将被设置。

有时这是值得的麻烦。我无法让您将 ASP.NET 重新处理时间缩短到几秒钟，但我可以让您缩短到 10-15 秒。（假设您在 SSD 上运行）

就生产重启而言，请确保您的应用程序池在非工作时间回收。

我研究了多核设置是否可以以某种方式减少重新处理时间，但没有任何运气（我有一个关于服务器故障的悬而未决的问题）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-03-22T17:48:56.093

也许这会对你有所帮助？

[加快 ASP.NET 中的构建时间](https://stackoverflow.com/questions/771743/speeding-up-build-times-in-asp-net/1800201#1800201)

# javascript - 在 iframe 表面中发生 JavaScript 异常

> ID：700208
> 
> 赞同：2
> 
> 时间：2009-03-31T06:11:44.097
> 
> 标签：javascript, firefox, iframe

情况如下：

*   一个页面 ( `iframe.html`) 有一个 iframe 加载另一个页面 ( `iframe-content.html`)。
*   `iframe-content.html`在 iframe 中加载时可能会发生 JavaScript 错误。
*   我希望浏览器可以看到该异常（例如显示在 Firefox 错误控制台或 Firebug 中）。

这是我看到的：

1.  当`iframe.html`最初加载并加载`iframe-content.html`时`src="iframe-content.html"`，JavaScript 异常会显示在 Firebug 中。
2.  但是，如果页面是在 JavaScript ( ) 中加载的`document.getElementById('iframe').src = 'iframe-content.html'`，则不会显示异常。

您可以通过以下方式重现此内容：

1.  [http://avernet.googlepages.com/iframe.html](http://avernet.googlepages.com/iframe.html)与 Firefox。
2.  您将在`iframe-content.html`加载时看到异常。
3.  单击按钮：iframe 的内容再次加载，但这次异常没有在 Firebug 中显示。

#3 有没有办法显示异常，而不是默默地忽略它？（您不能在设置 src 的 JS 代码周围使用 try/catch，因为此代码会在页面加载到 iframe 之前立即返回。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-31T06:21:17.320

看来您的 iframe 页面第二次并没有真正加载。或者它是从缓存中加载的并且错误被忽略。这很有趣，但我想我找到了解决方法。

```
function setContent() {
    try {
        console.log("Loading iframe content");
        document.getElementById('iframe').src = 'iframe-content.html?foo=bar';
    } catch (e) {
        console.log("Caught", e);
    }
    console.log("Done loading");
} 
```

这样就会出现错误。

我所做的是诱使浏览器认为我正在加载一个全新的页面，因为 url 更改后的参数。

```
'iframe-content.html?foo=bar'; 
```

您可以用不断变化的时间戳替换我的“bar”字符串。当然，它会避免缓存，但也会强制它按照您的意愿生成错误。

# xml - 大文件的 XML 拆分

> ID：700213
> 
> 赞同：20
> 
> 时间：2009-03-31T06:12:47.650
> 
> 标签：xml

我有一个 15 GB 的 XML 文件，我想将其拆分。它有大约 3 亿行。它没有任何相互依赖的顶级节点。是否有任何可用的工具可以轻松为我做到这一点？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2011-10-19T15:24:04.413

XmlSplit - 一个分割大型 XML 文件的命令行工具

*   [http://xponentsoftware.com/xmlSplit.aspx](http://xponentsoftware.com/xmlSplit.aspx)

xml_split - 将巨大的 XML 文档拆分成更小的块

*   [http://www.perlmonks.org/index.pl?node_id=429707](http://www.perlmonks.org/index.pl?node_id=429707)
*   [http://metacpan.org/pod/XML::Twig](http://metacpan.org/pod/XML::Twig)

通过 bhayanakmaut 拆分 XML（没有源代码，我无法让这个工作）

*   [http://sourceforge.net/projects/splitthatxml/](http://sourceforge.net/projects/splitthatxml/)

一个类似的问题：[如何拆分一个大的 xml 文件？](https://stackoverflow.com/questions/4325823/how-do-i-split-a-large-xml-file/)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-02-12T12:01:10.773

QXMLEdit 有一个专门的功能：我成功地将它与维基百科转储一起使用。~2.7Gio 文件变成了一堆 ~1 400 000 个文件（每页一个）。它甚至允许您将它们分派到子文件夹中。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-31T06:32:19.040

我认为除非您有兴趣以编程方式进行拆分，否则您将不得不手动拆分。[这是一个执行此操作的示例](http://www.codeproject.com/KB/XML/SplitLargeXMLintoSmallFil.aspx)，尽管它没有提到处理的 XML 文件的最大大小。手动执行时，出现的第一个问题是如何打开文件本身。

我会推荐一个非常简单的文本编辑器——比如[Vim](http://www.vim.org/about.php)。在处理如此大的文件时，关闭所有形式的语法突出显示和/或折叠总是有用的。

其他值得考虑的选择：

1.  [EditPadPro](http://www.editpadpro.com/) - 我从未尝试过使用这种尺寸的任何东西，但如果它与其他 JGSoft 产品一样，它应该可以轻而易举地工作。记得关闭语法高亮。

2.  [VEdit](http://www.vedit.com/) - 我已经将它与 1GB 大小的文件一起使用，就像它什么都没有一样工作。

3.  [EmEditor](http://www.emeditor.com/)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-06-19T16:47:00.273

这是一个使用 CMarkup 文件模式在免费的 firstobject XML 编辑器 (foxe) 中执行此操作的低内存占用脚本。我不确定你所说的没有相互依赖的顶级节点或标签检查是什么意思，但假设在根元素下你有数百万个包含对象属性或行的顶级元素，每个元素都需要作为一个单元保存在一起，你想说每个输出文件 100 万，您可以这样做：

```
split_xml_15GB()
{
  int nObjectCount = 0, nFileCount = 0;
  CMarkup xmlInput、xmlOutput；
  xmlInput.Open("15GB.xml", MDF_READFILE);
  xmlInput.FindElem(); // 根
  str sRootTag = xmlInput.GetTagName();
  xmlInput.IntoElem();
  而 ( xmlInput.FindElem() )
  {
    如果（nObjectCount == 0）
    {
      ++n文件计数；
      xmlOutput.Open("piece" + nFileCount + ".xml", MDF_WRITEFILE );
      xmlOutput.AddElem(sRootTag);
      xmlOutput.IntoElem();
    }
    xmlOutput.AddSubDoc(xmlInput.GetSubDoc());
    ++n对象计数；
    如果（nObjectCount == 1000000）
    {
      xmlOutput.Close();
      nObjectCount = 0;
    }
  }
  如果（nObjectCount）
    xmlOutput.Close();
  xmlInput.Close();
  返回 nFileCount；
}
```

我在这里发布了一个 youtube 视频和文章：

[http://www.firstobject.com/xml-splitter-script-video.htm](http://www.firstobject.com/xml-splitter-script-video.htm)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-09-08T08:05:12.423

开源库逗号有几个工具可以在非常大的 XMl 文件中查找数据并将这些文件拆分为较小的文件。

[https://github.com/acfr/comma/wiki/XML-Utilities](https://github.com/acfr/comma/wiki/XML-Utilities)

这些工具是使用 expat SAX 解析器构建的，因此它们不会使用 xmlstarlet 和 saxon 之类的 DOM 树来填充内存。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-02-23T19:08:53.423

也许这个问题仍然存在，我相信它可以帮助某人。有一个 xml 编辑器[XiMpLe](http://www.ximple.cz)，其中包含一个用于拆分大文件的工具。只需要片段大小。并且还有将 xml 文件链接在一起的反向功能（！）。它对非商业用途是免费的，而且许可证也不贵。无需安装。对我来说效果很好（我有 5GB 文件）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-19T16:54:54.850

您需要以什么方式拆分它？使用`XmlReader.ReadSubTree`. 它将针对当前元素及其所有子元素返回一个新的 xmlReader 实例。因此，移动到根的第一个子节点，调用 ReadSubtree，写入所有这些节点，使用原始读取器调用 Read()，然后循环直到完成。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-04-26T22:31:34.367

```
Used this for splitting Yahoo Q&A dataset

    count = 0
    file_count = 1
    with open('filepath') as f:

    current_file = ""

    for line in f:
        current_file = current_file + line

        if "</your tag to split>" in line:
            count = count + 1

        if count==50000:
            current_file = current_file + "</endTag>"
            with open('filepath/Split/file_' +str(file_count)+'.xml' , 'w') as split:
                split.write(current_file)
            file_count = file_count + 1
            current_file = "<?xml version='1.0' encoding='UTF-8'?>\n<endTag>"
            count = 0

current_file = current_file + "</endTag>"
with open('filepath/Split/file_' +str(file_count)+'.xml' , 'w') as split:
    split.write(current_file) 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-11-18T04:45:28.133

我使用了 XmlSplit Wizard 工具。它真的很好用，您可以指定拆分方法，如元素、行、文件数或文件大小。唯一的问题是我必须以 99 美元的价格购买它，因为试用版不允许您拆分所有数据，只能拆分奇数个文件。我能够分割一个 70GB 的文件！

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-03-31T06:17:37.670

不是 Xml 工具，但[Ultraedit](http://www.ultraedit.com)可能会有所帮助，我已经将它与 2G 文件一起使用，它根本不介意，但请确保关闭自动备份功能。

# winapi - 存在哪些通讯端口？Win32

> ID：700215
> 
> 赞同：2
> 
> 时间：2009-03-31T06:13:02.097
> 
> 标签：winapi, serial-port

在 win32 上，使用 winapi，无论如何都知道哪些 comports（从 com0 向上）实际上作为设备存在？

目前我只是试图将它们全部打开（0 到 9），但我无法弄清楚一个不存在的失败与一个不能简单地使用因为其他人正在使用它的失败之间的区别。这两种情况似乎都返回相同的最后一个错误，所以我想知道是否可以列出系统上所有可用的组件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-31T06:25:20.867

在谷歌搜索“枚举 com 端口”。[这](http://www.codeproject.com/KB/system/serial_portsenum_fifo.aspx)是一个示例链接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-31T06:16:27.940

我相信您可以调用[QueryDosDevice()](http://msdn.microsoft.com/en-us/library/aa365461(VS.85).aspx)并为第一个参数传递 null ，然后解析结果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-07T12:58:49.467

这个名字很不幸，但“SetupAPI”是 Windows API 的相关部分。为设备接口类调用一次[SetupDiCreateDeviceInfoList](http://www.osronline.com/ddkx/install/di-rtns_2iya.htm)`GUID_DEVINTERFACE_COMPORT`。然后重复调用[SetupDiEnumDeviceInfo](http://www.osronline.com/ddkx/install/di-rtns_8z5e.htm)，从索引 0 开始直到`GetLastError()==ERROR_NO_MORE_ITEMS`.

# php - 确定 PHP 中是否存在数组键有什么更快更好的方法？

> ID：700227
> 
> 赞同：210
> 
> 时间：2009-03-31T06:17:31.197
> 
> 标签：php, performance

考虑这两个例子......

```
$key = 'jim';

// example 1
if (isset($array[$key])) {
    // ...
}

// example 2    
if (array_key_exists($key, $array)) {
    // ...
} 
```

我有兴趣知道这些是否更好。我一直使用第一个，但在这个站点上看到很多人使用第二个示例。

那么，哪个更好？快点？更明确的意图？

* * *

## 回答 #1

> 赞同：323
> 
> 时间：2009-03-31T06:23:39.513

`isset()`更快，但与`array_key_exists()`.

`array_key_exists()`纯粹检查键是否存在，即使值是`NULL`.

而 `isset()`如果`false`键存在且值为`NULL`.

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2014-02-13T16:02:32.477

如果你对我最近做过的一些测试感兴趣：

[https://stackoverflow.com/a/21759158/520857](https://stackoverflow.com/a/21759158/520857)

概括：

```
| Method Name                              | Run time             | Difference
=========================================================================================
| NonExistant::noCheckingTest()            | 0.86004090309143     | +18491.315775911%
| NonExistant::emptyTest()                 | 0.0046701431274414   | +0.95346080503016%
| NonExistant::isnullTest()                | 0.88424181938171     | +19014.461681183%
| NonExistant::issetTest()                 | 0.0046260356903076   | Fastest
| NonExistant::arrayKeyExistsTest()        | 1.9001779556274      | +209.73055713% 
```

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2019-05-14T13:48:40.350

Php 7 提供了使用[Null Coalescing Operator](https://www.php.net/manual/en/migration70.new-features.php#migration70.new-features.null-coalesce-op)的可能性。

> 已添加空合并运算符 (??) 作为语法糖，用于需要将三元组与 isset() 结合使用的常见情况。如果存在且不为 NULL，则返回其第一个操作数；否则返回第二个操作数。

因此，现在您可以指定一个默认值，以防该值为 null 或该键不存在：

```
$var = $array[$key] ?? 'default value' 
```

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2009-03-31T06:25:18.293

嗯，主要区别在于`isset()`不会返回`true`对应于空值的数组键，而`array_key_exists()`会。

运行一个[小的基准测试](http://codepad.org/RcdAewVF)表明`isset()`它更快，但它可能并不完全准确。

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2016-06-28T10:12:59.413

我想在这个问题上加上我的 2 美分，因为我错过了一个中间出路。

如前所述`isset()`，将评估键的值，因此`false`如果该值在`null`哪里，它将返回`array_key_exists()`仅检查键是否存在于数组中。

* * *

我使用 PHP 7 运行了一个简单的基准测试，显示的结果是完成迭代所花费的时间：

```
$a = [null, true];

isset($a[0])                            # 0.3258841  - false
isset($a[1])                            # 0.28261614 - true
isset($a[2])                            # 0.26198816 - false

array_key_exists(0, $a)                 # 0.46202087 - true
array_key_exists(1, $a)                 # 0.43063688 - true
array_key_exists(2, $a)                 # 0.37593913 - false

isset($a[0]) || array_key_exists(0, $a) # 0.66342998 - true
isset($a[1]) || array_key_exists(1, $a) # 0.28389215 - true
isset($a[2]) || array_key_exists(2, $a) # 0.55677581 - false

array_key_isset(0, $a)                  # 1.17933798 - true
array_key_isset(1, $a)                  # 0.70253706 - true
array_key_isset(2, $a)                  # 1.01110005 - false 
```

我已经将此自定义函数的结果添加到此基准测试以及完成中：

```
function array_key_isset($k, $a){
    return isset($a[$k]) || array_key_exists($k, $a);
} 
```

* * *

正如所见和已经告知的那样`isset()`是最快的方法，但如果值为 ，它可以返回 false `null`。`array_key_exists()`这可能会产生不需要的结果，如果是这种情况，通常应该使用。

但是，有一个中间出路，那就是使用`isset() || array_key_exists()`. 此代码通常使用更快的函数`isset()`，*如果* `isset()`返回 false**则仅**用于`array_key_exists()`验证。如上表所示，它与普通调用一样快`isset()`。

是的，编写和将其包装在一个函数中会更慢一些，但要容易得多。如果您需要它来提高性能、检查大数据等，请将其完整地写出来，否则如果它是 1 次使用，那么非常小的功能开销`array_key_isset()`可以忽略不计。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-03-31T06:23:31.993

您将阅读到与[php.net](http://us.php.net/array_key_exists)不同的地方：

> isset() 不会为对应于 NULL 值的数组键返回 TRUE，而 array_key_exists() 会。

一个非常非正式的测试显示`array_key_exists()`比`isset()`

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2014-03-08T22:49:04.087

结合`isset()`并`is_null()`针对其他函数（如：`array_key_exists()`、、+、、、+ ）提供最佳性能`isset()`，这里唯一的问题是，如果键不存在，该函数不仅会返回 false，而且即使键存在并且具有 null 值。`isset()``array_key_exists()``is_null()``isset()``is_null()`

**基准脚本：**

```
<?php
  $a = array('a' => 4, 'e' => null)

  $s = microtime(true); 
  for($i=0; $i<=100000; $i++) { 
    $t = (isset($a['a'])) && (is_null($a['a'])); //true 
    $t = (isset($a['f'])) && (is_null($a['f'])); //false
    $t = (isset($a['e'])) && (is_null($a['e']));; //false 
  } 

  $e = microtime(true); 
  echo 'isset() + is_null() : ' , ($e-$s)."<br><br>";
?> 
```

**信用**：[https ://web.archive.org/web/20140222232248/zomeoff.com/php-fast-way-to-determine-a-key-elements-existance-in-an-array/](https://web.archive.org/web/20140222232248/zomeoff.com/php-fast-way-to-determine-a-key-elements-existance-in-an-array/)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-31T06:23:26.940

至于“更快”：试试看（我的钱在`array_key_exists()`，但我现在不能尝试）。

至于“意图更清晰”：`array_key_exists()`

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-31T06:26:52.687

显然第二个例子的意图更清楚，这是毫无疑问的。要弄清楚示例 #1 的作用，您需要熟悉 PHP 的变量初始化特性——然后您会发现它对空值的作用不同，等等。

至于哪个更快 - 我不打算推​​测 - 在你的 PHP 版本上以紧密的循环运行几十万次，你会发现:)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-06-12T17:16:02.920

我想补充一点，您还可以使用 isset 搜索具有唯一元素的数组。它比使用 in_array、array_search 或 array_key_exists 快得多。您可以使用 array_flip 翻转数组并使用 isset 检查数组中是否存在值。

```
<?php

$numbers = [];
for ($i = 0; $i < 1000000; $i++) {
    $numbers[] = random_int("9000000000", "9999999999");
}

function evaluatePerformance($name, $callback)
{
    global $numbers;
    $timeStart = microtime(true);

    $result = $callback("1234567890", $numbers) ? 'true' : 'false';

    $timeEnd = microtime(true);
    $executionTime =  number_format($timeEnd - $timeStart, 9);

    echo  "{$name} result is {$result} and it took {$executionTime} seconds. <br>";
}

// Took 0.038895845 seconds.
evaluatePerformance("in_array", function ($needle, $haystack) {
    return in_array($needle, $haystack);
});

// Took 0.035454988 seconds.
evaluatePerformance("array_search", function ($needle, $haystack) {
    return array_search($needle, $haystack);
});

$numbers = array_flip($numbers);

// Took 0.000024080 seconds.
evaluatePerformance("array_key_exists", function ($needle, $haystack) {
    return array_key_exists($needle, $haystack);
});

// Took 0.000013113 seconds.
evaluatePerformance("isset", function ($needle, $haystack) {
    return isset($haystack[$needle]);
}); 
```

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2012-01-20T01:06:19.120

您的代码 ,`isset($array[$i]) || $array[$i] === null`在任何情况下都将返回 true，即使该键不存在（并产生未定义的索引通知）。为了获得最佳性能，您想要的是`if (isset($array[$key]) || array_key_exists($key,$array)){doWhatIWant();}`

# asp.net - 如何在 vb.net 中回滚数据

> ID：700229
> 
> 赞同：0
> 
> 时间：2009-03-31T06:18:55.797
> 
> 标签：asp.net, vb.net, transactions, rollback

我有一个页面，其中有 3 个部分。在第一部分中，我有一些详细信息要保存在数据库中。我通过名为 Procedure1 的 StoredProcedure(sql) 保存这些详细信息。详细信息存储在名为 Table1 的表中。表中有一个名为“ID”的主键。这个“ID”会自动插入到表中。

在第二和第三部分，我有数据操作网格。详细信息分别通过 StoredProcedures(sql)、Procedure2、Procedure3 插入到表 Table2 和 Table3 中。

Table1中自动生成的“ID”需要插入到Table2和Table3中，我该怎么做？

表2和表3中没有插入相应数据时，表1中的Details应该得到Rollback，即。这 3 个部分将同时插入。

现在我创建了一个 StoredProcedure，其中我结合了所有 3 个过程。

现在我该如何编写代码来回滚细节？或者任何人都可以建议另一种方法来解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-31T06:22:10.967

只需使用事务，并在出错时调用[Transaction.Rollback() 。](http://msdn.microsoft.com/en-us/library/system.transactions.transaction.rollback.aspx)处理细节是数据库的工作。

# asp.net - 如何在asp.net的详细信息视图中设置面板默认按钮？

> ID：700231
> 
> 赞同：1
> 
> 时间：2009-03-31T06:19:09.180
> 
> 标签：asp.net, detailsview, defaultbutton

```
<asp:panel ID="Panel1"  runat="server">

<asp:DetailsView ID="DetailsView1"

....

<asp:templatefield ShowHeader="False">

<insertitemtemplate>

<asp:Button ID="btnAdd" runat="server" CausesValidation="True" CommandName="Insert" Text="Insert"></asp:Button>

...
<asp:DetailsView>
</asp:panel>

and i write the code for setting the panels default button in details view's DataBound event

Button btnAdd = new Button();
  btnAdd = DetailsView1.Rows[indexNumber].FindControl("btnAdd") as Button;
  Panel1.DefaultButton = btnAdd.UniqueID;

but I get the error :
The DefaultButton of 'Panel1' must be the ID of a 
control of type IButtonControl. 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2009-03-31T06:36:30.043

在 ASP 中，您将 id 设置为

```
ID="BtnAdd" 
```

在您使用的代码中

```
FindControl("btnAdd") 
```

我相信 btnAdd 区分大小写

# hardware - 基于 FPGA 的 RTL 评估

> ID：700235
> 
> 赞同：3
> 
> 时间：2009-03-31T06:20:22.187
> 
> 标签：hardware, verilog, fpga, register-transfer-level

目前我正在测试一些 RTL，我正在使用 ncverilog，它非常......非常慢。我听说，如果我们使用某种 FPGA 板，那么事情会更快。是真的吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-31T07:47:11.013

你说的是两种不同的东西。

NCVerilog 是一个仿真工具，而 FPGA 板是真正的硬件。所以，会有差异。真正的硬件通常会更快，但使用模拟器，您可以获得各种调试乐趣。尝试探测特定信号只需在测试台上添加一条线即可。此外，您可以轻松更改仿真模型，而不必重新设计 FPGA 板。

如果您在足够强大的机器上运行仿真，您有时可以近似真实世界的性能（假设 FPGA 速度较慢）。

总而言之，你应该两者都做。使用模拟器进行基本开发和评估。一旦您的设计得到充分定义，就转移到您的 FPGA 硬件上。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-31T18:21:10.567

我们在模拟速度方面也遇到了同样的问题。但是，我们在大部分验证中都坚持使用模拟。每个 sim 检查一个特定的功能，并且比系统级 sim 快得多。我们还让它们进行自我检查，并且对回归测试（单元测试）很有用。

对于需要花费太多时间来模拟的真实世界信号的长时间系统测试，如果可以的话，我们会将它们移至 FPGA。我们需要在代码更改后再次手动重新检查所有这些测试用例，因此它可能会以自己的方式变慢。

但有时，FPGA 设计是不可行的。有时完整的设计太大而无法装入 FPGA，或者时钟速率太高。但请记住，您不一定必须对整个设计进行 FPGA 设计，获得您感兴趣的重要模块并全面检查可能就足够了。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-05T23:27:47.337

您可以使用 Altera SignalTap 或 Xilinx ChipScope 等“嵌入式逻辑分析仪”软件工具跟踪正在运行的 FPGA 设计中的信号活动。在将 RTL 合成/映射到设备之前，您将使用这些工具将软探针连接到您想要观看的信号。您可以设置触发器，以便仅在特定条件下记录信号值。然后生成位文件并使用 JTAG 对器件进行编程。逻辑分析仪通过 JTAG 与您的 PC 通信并记录您的探针上的活动，然后您可以对其进行分析。

设置起来有点复杂，因为这些工具并不是特别容易使用，但您会比使用 RTL 仿真更快地获得结果。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-31T07:38:33.717

您正在测试哪种 RTL？如果您使用 FPGA 板，那么您可以编译您的代码，前提是您拥有适用于正确 FPGA 的正确工具。由于 FPGA 是可重新编程的，那么您当然可以在板上测试您的代码，并让目标 (FPGA) 执行您的代码 (RTL)

但这不再是一种模拟，而是一种测试，使用给定的硬件，在给定的时钟速度下。而且你在屏幕上没有得到很好的结果，你需要使用物理探头和示波器。另外，您看不到代码的内部是如何工作的。

verilog 或 VHDL 模拟有点像使用调试器运行代码。FPGA 测试更像是使用 printf 进行调试。最大的区别在于，在模拟时，您的 CPU 必须模拟所有由您的代码产生的逻辑门的行为。在 FPGA 上，没有模拟，您只需“运行”代码，因此速度要快得多，但您拥有的信息更少。

您应该对非常小的组件使用仿真，然后在 FPGA 上测试您的整个程序。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-07-14T06:53:37.387

您可能在询问硬件仿真加速器。这是其中之一：[GateRocket](http://www.gaterocket.com/)

# sql - 用于为特定 MSSQL 表创建脚本的命令行工具

> ID：700238
> 
> 赞同：0
> 
> 时间：2009-03-31T06:20:46.273
> 
> 标签：sql, sql-server, database, sqlpubwiz

我一直在查看 SqlPubWiz.exe 命令来编写批处理文件，以便我可以在源代码管理中使我的脚本保持最新。但我需要的是命令行工具允许我选择要包含的特定表（并且我可以排除其他表）。我认为 SqlPubWiz.exe 不会为我做到这一点（如果我错了，请告诉我），但如果有人可以将我指向另一个可以做到这一点的工具，那就是我正在寻找的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-31T08:35:57.587

有几种商业工具可以创建数据库脚本，例如

*   ApexSQL 的[SQL 脚本](http://www.apexsql.com/sql_tools_script.asp)
*   [EMS 数据库提取](http://sqlmanager.net/en/products/mssql/extract)

这是一篇展示免费工具的文章 - 但是，它只会为您的数据库中的所有对象编写脚本：[Eric Moreau 的博客](http://www.emoreau.com/Entries/Articles/2009/02/Scripting-your-Microsoft-SQL-Server-database-objects.aspx)。

如果您想“自己动手”，请查看服务器管理对象 (SMO)——它们允许您检查数据库并从中创建脚本。

请参阅[此处](http://www.apexsql.com/sql_tools_script.asp)、[此处](http://davidhayden.com/blog/dave/archive/2006/11/09/ScriptDatabaseUsingSQLServerManagementObjects.aspx)或[此处](http://www.sqlservercentral.com/articles/SMO/scriptdatabaseobjectswithsmo/2342/)的信息。

马克

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-07-21T04:04:10.887

试试 DBSourceTools。[http://dbsourcetools.codeplex.com](http://dbsourcetools.codeplex.com)
它是开源的，专门设计用于脚本数据库 - 表、视图、procs 到磁盘。
它还允许您选择要编写脚本的表、视图、数据库对象。

# algorithm - 线性搜索和二分搜索有什么区别？

> ID：700241
> 
> 赞同：51
> 
> 时间：2009-03-31T06:21:12.357
> 
> 标签：algorithm, search, binary-search, linear-search

线性搜索和二分搜索有什么区别？

* * *

## 回答 #1

> 赞同：126
> 
> 时间：2009-03-31T06:25:17.543

[线性搜索](http://en.wikipedia.org/wiki/Linear_search)查找列表，一次一个项目，不跳转。在复杂性方面，这是一次`O(n)`搜索——搜索列表所花费的时间以与列表相同的速度变大。

[二进制搜索](http://en.wikipedia.org/wiki/Binary_search)是从排序列表的中间开始，查看它是否大于或小于您要查找的值，这决定了该值是在列表的前半部分还是后半部分。跳到子列表的一半，然后再次比较等等。这几乎是人类通常在字典中查找单词的方式（尽管我们使用更好的启发式，显然 - 如果你正在寻找“猫”，你不会从“M”开始）。在复杂性方面，这是一个`O(log n)`搜索 - 搜索操作的数量比列表增长得更慢，因为您将每个操作的“搜索空间”减半。

例如，假设您在 AZ 字母列表中查找 U（索引 0-25；我们正在查找索引 20 处的值）。

线性搜索会问：

> `list[0] == 'U'`?
> `list[1] == 'U'`没有。
> `list[2] == 'U'`没有。
> `list[3] == 'U'`没有。
> `list[4] == 'U'`没有。
> `list[5] == 'U'`没有。没有
> …… `list[20] == 'U'`？是的。完成的。

二进制搜索会问：

> 将`list[12]`('M') 与 'U' 进行比较：更小，看更远。（范围=13-25）
> 比较`list[19]`（'T'）和'U'：更小，看更远。（范围=20-25）
> 比较`list[22]`（'W'）与'U'：更大，看早。（范围=20-21）
> 比较`list[20]`（'U'）和'U'：找到了！完成的。

比较两者：

*   二分查找需要对输入数据进行排序；线性搜索不
*   二分查找需要*排序*比较；线性搜索只需要相等比较
*   二分查找的复杂度为 O(log n)；如前所述，线性搜索的复杂度为 O(n)
*   二分查找需要随机访问数据；线性搜索只需要顺序访问（这可能非常重要 - 这意味着线性搜索可以*流式*传输任意大小的数据）

* * *

## 回答 #2

> 赞同：71
> 
> 时间：2009-03-31T06:25:24.983

可以将其视为在电话簿中查找方式的两种不同方式。线性搜索从头开始，读取每个名称，直到找到所需内容。另一方面，二分搜索是当您打开书本（通常在中间），查看页面顶部的名称，然后确定您要查找的名称是大于还是小于您所要查找的名称'正在寻找。如果您要查找的名称更大，那么您将继续以这种方式搜索书的上半部分。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2010-09-18T06:50:31.790

线性搜索的工作原理是查看数据列表中的每个元素，直到找到目标或到达末尾。这导致给定列表的 O(n) 性能。二进制搜索具有必须对数据进行排序的先决条件。我们可以利用这些信息来减少我们需要查看的项目数量以找到我们的目标。我们知道，如果我们查看数据中的一个随机项（假设是中间项）并且该项大于我们的目标，那么该项右侧的所有项也将大于我们的目标。这意味着我们只需要查看数据的左侧部分。基本上，每次我们搜索目标并错过，我们可以消除一半的剩余项目。这给了我们一个很好的 O(log n) 时间复杂度。

请记住，即使使用最有效的算法对数据进行排序也总是比线性搜索慢（最快的排序算法是 O(n * log n)）。因此，您永远不应该仅仅为了稍后执行单个二进制搜索而对数据进行排序。但是，如果您将执行许多搜索（例如至少 O(log n) 次搜索），则可能值得对数据进行排序，以便您可以执行二进制搜索。在这种情况下，您还可以考虑其他数据结构，例如哈希表。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-04T20:50:31.580

一定要考虑一下更快的二进制搜索的胜利是否值得保持列表排序的成本（以便能够使用二进制搜索）。即，如果您有很多插入/删除操作并且只是偶尔进行搜索，则二进制搜索总体上可能比线性搜索慢。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-03-31T06:26:24.513

线性搜索从值列表的开头开始，并按顺序逐一检查您要查找的结果。

二进制搜索从已排序数组的中间开始，并确定您要查找的值在哪一侧（如果有）。然后以相同的方式再次搜索数组的“一半”，每次将结果分成两半。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-04T20:55:58.837

试试这个：选择一个随机名称“姓氏，名字”并在您的电话簿中查找。

第一次：从书的开头开始，读名字直到找到它，或者找到它按字母顺序出现的地方，并注意它不在那里。

第二次：在中途点打开书，看页面。问问自己，这个人应该在左边还是右边。无论是哪一个，取那个 1/2 并找到它的中间。重复此过程，直到找到条目所在的页面，然后将相同的过程应用于列，或者像以前一样沿页面上的名称线性搜索。

对两种方法都计时并报告！

[还要考虑如果你只有一个名字列表，而不是排序，哪种方法更好......]

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-06-05T07:49:17.633

线性搜索查找列表，一次一个项目，不跳转。在复杂性方面，这是一个 O(n) 搜索 - 搜索列表所花费的时间以与列表相同的速度变大。

二进制搜索是从排序列表的中间开始，查看它是否大于或小于您要查找的值，这决定了该值是在列表的前半部分还是后半部分。跳到子列表的一半，然后再次比较等等。这几乎是人类通常在字典中查找单词的方式（尽管我们使用更好的启发式，显然 - 如果你正在寻找“猫”，你不会从“M”开始）。在复杂性方面，这是一个 O(log n) 搜索 - 搜索操作的数量比列表增长得更慢，因为每个操作都将“搜索空间”减半。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-04-28T06:49:16.427

二进制搜索在 O(logn) 时间内运行，而线性搜索在 O(n) 时间运行，因此二进制搜索具有更好的性能

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-03-31T06:43:58.170

线性搜索也称为顺序搜索，从一开始就按顺序查看每个元素，以查看所需元素是否存在于数据结构中。当数据量较小时，这种搜索速度很快。它很容易，但所需的工作与要搜索的数据量成正比。如果所需元素不存在，则元素数量加倍将使搜索时间加倍。

对于较大的数组，二分查找是有效的。在此我们检查中间元素。如果值大于我们要查找的值，则查看前半部分；否则，查看后半部分。重复此操作，直到找到所需的项目。必须对表进行排序以进行二分查找。它在每次迭代中消除了一半的数据。它是对数的。

如果我们有 1000 个元素要搜索，二分搜索大约需要 10 步，线性搜索需要 1000 步。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-05-25T12:21:23.540

`Linear Search`查看项目，直到找到搜索到的值。

效率：`O(n)`

示例 Python 代码：

```
test_list = [1, 3, 9, 11, 15, 19, 29]
test_val1 = 25
test_val2 = 15

def linear_search(input_array, search_value):
    index = 0
    while (index < len(input_array)) and (input_array[index] < search_value):
        index += 1
    if index >= len(input_array) or input_array[index] != search_value:
        return -1

    return index

print linear_search(test_list, test_val1)
print linear_search(test_list, test_val2) 
```

`Binary Search`找到数组的中间元素。检查中间值是否大于或小于搜索值。如果它更小，它会获取数组的左侧并找到该部分的中间元素。如果它更大，则获取数组的正确部分。它循环操作，直到找到搜索到的值。或者，如果数组中没有值，则完成搜索。

效率：`O(logn)`

示例 Python 代码：

```
test_list = [1, 3, 9, 11, 15, 19, 29]
test_val1 = 25
test_val2 = 15

def binary_search(input_array, value):
    low = 0
    high = len(input_array) - 1
    while low <= high:
        mid = (low + high) / 2
        if input_array[mid] == value:
            return mid
        elif input_array[mid] < value:
            low = mid + 1
        else:
            high = mid - 1

    return -1

print binary_search(test_list, test_val1)
print binary_search(test_list, test_val2) 
```

您还可以在此处查看有关线性和二进制搜索的可视化信息：[https ://www.cs.usfca.edu/~galles/visualization/Search.html](https://www.cs.usfca.edu/~galles/visualization/Search.html)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-04-15T18:20:55.967

为了清楚地理解，请看一下我的 codepen 实现[https://codepen.io/serdarsenay/pen/XELWqN](https://codepen.io/serdarsenay/pen/XELWqN)

最大的区别是在应用二分搜索之前需要对样本进行排序，因此对于大多数“正常大小”（有争议的）样本，使用线性搜索算法进行搜索会更快。

这是 javascript 代码，对于 html 和 css 以及完整的运行示例，请参阅上面的 codepen 链接。

```
var unsortedhaystack = [];
var haystack = [];
function init() {
  unsortedhaystack = document.getElementById("haystack").value.split(' ');
}
function sortHaystack() {
  var t = timer('sort benchmark');
  haystack = unsortedhaystack.sort();
  t.stop();
}

var timer = function(name) {
    var start = new Date();
    return {
        stop: function() {
            var end  = new Date();
            var time = end.getTime() - start.getTime();
            console.log('Timer:', name, 'finished in', time, 'ms');
        }
    }
};

function lineerSearch() {
  init();
  var t = timer('lineerSearch benchmark');
  var input = this.event.target.value;
  for(var i = 0;i<unsortedhaystack.length - 1;i++) {
    if (unsortedhaystack[i] === input) {
      document.getElementById('result').innerHTML = 'result is... "' + unsortedhaystack[i] + '", on index: ' + i + ' of the unsorted array. Found' + ' within ' + i + ' iterations';
      console.log(document.getElementById('result').innerHTML);
      t.stop(); 
      return unsortedhaystack[i]; 
    }
  }
}

function binarySearch () {
  init();
  sortHaystack();
  var t = timer('binarySearch benchmark');
  var firstIndex = 0;
  var lastIndex = haystack.length-1;
  var input = this.event.target.value;

  //currently point in the half of the array
  var currentIndex = (haystack.length-1)/2 | 0;
  var iterations = 0;

  while (firstIndex <= lastIndex) {
    currentIndex = (firstIndex + lastIndex)/2 | 0;
    iterations++;
    if (haystack[currentIndex]  < input) {
      firstIndex = currentIndex + 1;
      //console.log(currentIndex + " added, fI:"+firstIndex+", lI: "+lastIndex);
    } else if (haystack[currentIndex] > input) {
      lastIndex = currentIndex - 1;
      //console.log(currentIndex + " substracted, fI:"+firstIndex+", lI: "+lastIndex);
    } else {
      document.getElementById('result').innerHTML = 'result is... "' + haystack[currentIndex] + '", on index: ' + currentIndex + ' of the sorted array. Found' + ' within ' + iterations + ' iterations';
      console.log(document.getElementById('result').innerHTML);
      t.stop(); 
      return true;
    }
  }
} 
```

# php - Zend Framework - 静态表单元素

> ID：700250
> 
> 赞同：2
> 
> 时间：2009-03-31T06:22:36.613
> 
> 标签：php, zend-framework, zend-form

我有一个表单，用户可以使用它来创建新商店和编辑现有商店。当此表单用于编辑商店时，我希望用户查看某些字段但不进行编辑，例如。store_id。我探索了不同的 Zend_Form_Elements 希望找到某种静态元素但没有运气。

所以我的问题是，如何使用 Zend_Form 显示用户无法编辑的信息？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-31T19:54:35.337

`readonly`单独是不够的，因为用户仍然可以根据需要对其进行编辑。您应该使用`$element->setIgnore(true)`它来确保`Zend_Form_Element`不会尝试从 POST/GET 填充元素，并且我也会仔细检查。您必须确保进入数据库的值永远不会包含此元素。

最后，如果您希望元素以不同于 with 的方式显示`readonly`，您可以通过更改元素装饰器来实现。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-01T00:08:59.747

我自己设法解决了这个问题。解决方案是将元素上的视图助手更改为 formNote 助手，例如。$element->helper = 'formNote'。这样做的结果是该值显示为纯文本，而不是在表单元素内。

感谢您的回答。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-09-29T10:59:26.250

当您在提交表单时不需要填充元素值时，这是一个非常好的解决方案。等效的解决方案是使用表单元素方法`setAttrib()`并禁用表单元素

```
$formElement->setAttrib('disable','disable') 
```

这只会冻结元素。

但是，如果您需要填充该字段，使用以前的解决方案，您可能需要添加额外的隐藏字段，这将传递值。开发自定义表单元素将是一种很好的风格，但这并不是每个开发人员都欢迎的，因此您可以使用一些棘手的方法将表单元素设置为仅文本但填充其值。这样，当您将元素创建为隐藏字段时，设置其值并使用 Form Element 方法`setDescription()`设置和显示元素文本值。

```
$formElement = new Zend_Form_Element_Hidden( 'elName',
        array( 'label' => 'elLabel', 'value' => 'elValue' ) );

$formElement->setDescription( 'elValue' ); 
```

然后您可以渲染该隐藏元素并使用 `$formElement->getDescription()`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-31T08:25:10.530

```
$element->setAttrib('readonly', 'true'); 
```

[http://www.w3.org/TR/html401/interact/forms.html#adef-readonly](http://www.w3.org/TR/html401/interact/forms.html#adef-readonly)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-05T11:30:09.197

根据 Amr Mostafa 的说法，如果您使用：

```
$element->setAttrib('readonly', 'true'); 
```

或者

```
$element->setAttribs(array('disabled' => 'disabled')); 
```

用户仍然通过 POST/GET 发送值，并将它们存储在数据库中。

我不考虑 POST/GES 值的唯一方法是：

```
$element->setIgnore(true) 
```

例子：

```
$element = new Zend_Form_Element_Text('element');
$element->setIgnore(true); 
```

# c - C：使用 sprintf 和 strncpy 将数据插入指针数组

> ID：700258
> 
> 赞同：0
> 
> 时间：2009-03-31T06:24:21.460
> 
> 标签：c, printf, strncpy

我有一个包含指针数组的结构。我想以字符串格式插入数组数字，即“1”、“2”等。

但是，使用 sprintf 或 strncpy 有什么区别吗？

我的代码有什么大错误吗？我知道我必须免费拨打电话，我将在我的代码的另一部分中这样做。

非常感谢您的任何建议！

```
struct port_t
{
    char *collect_digits[100];

}ports[20];

/** store all the string digits in the array for the port number specified */
static void g_store_digit(char *digit, unsigned int port)
{
    static int marker = 0;
    /* allocate memory */
    ports[port].collect_digits[marker] = (char*) malloc(sizeof(digit)); /* sizeof includes 0 terminator */
    // sprintf(ports[port].collect_digits[marker++], "%s", digit);
    strncpy(ports[port].collect_digits[marker++], digit, sizeof(ports[port].collect_digits[marker]));
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-31T06:34:31.997

是的，您的代码有一些问题。

*   在 C 中，不要强制转换`malloc()`. 它不是必需的，并且可以隐藏错误。
*   您根据指针的大小分配空间，而不是您要存储的大小。
*   复制也是一样。
*   目前还不清楚静态的`marker`作用，以及它周围的逻辑是否真的正确。是`port`要更改的插槽，还是由静态变量控制？

您想在数组中的每个插槽中仅存储一位数字还是多位数字？

给定声明，该函数的外观如下：

```
/* Initialize the given port position to hold the given number, as a decimal string. */
static void g_store_digit(struct port_t *ports, unsigned int port, unsigned int number)
{
  char tmp[32];

  snprintf(tmp, sizeof tmp, "%u", number);
  ports[port].collect_digits = strdup(tmp);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-31T06:38:47.247

```
strncpy(ports[port].collect_digits[marker++], digit, sizeof(ports[port].collect_digits[marker])); 
```

这是不正确的。

您已为 collect_digits 分配了一定数量的内存。

您将 char *digits 复制到该内存中。

您应该复制的长度是 strlen(digits)。您实际复制的是 sizeof(ports[port].collect_digits[marker])，它将为您提供单个 char * 的长度。

您不能使用 sizeof() 来查找已分配内存的长度。此外，除非您先验地知道数字与您分配的内存长度相同，否则即使 sizeof() 确实告诉您分配的内存的长度，您也会复制错误的字节数（太多；您只需要复制数字的长度）。

此外，即使两个长度始终相同，以这种方式获取长度也没有表现力；它误导了读者。

另请注意，如果指定的复制长度大于源字符串的长度，则 strncpy() 将用尾随 NULL 填充。因此，如果digits*是*分配的内存的长度，您将有一个非终止字符串。

sprintf() 行在功能上是正确的，但是对于您正在做的事情， strcpy() （与 strncpy() 相对）是，从我所看到和知道的代码来看，正确的选择。

不得不说，我不知道你想做什么，但是代码感觉很别扭。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-31T06:33:00.130

第一件事：为什么要有一个指针数组？你期望一个端口对象有多个字符串吗？您可能只需要一个普通数组或一个指针（因为您`malloc`稍后会 -ing）。

```
struct port_t
{
    char *collect_digits;
}ports[20]; 
```

您需要传递字符串的地址，否则，malloc 会作用于本地副本，您将永远无法取回您支付的费用。

```
static void g_store_digit(char **digit, unsigned int port); 
```

最后，它`sizeof`适用于指针上下文并且没有给你正确的大小。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-31T06:38:46.607

而不是使用`malloc()`and `strncpy()`，而只是使用`strdup()`- 它分配足够的缓冲区来保存内容并将内容复制到新字符串中，所有这些都是一次性的。

所以你根本不需要`g_store_digit()`- 只需使用`strdup()`, 并保持`marker`在调用者的级别。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-31T14:42:09.017

原代码的另一个问题：语句

```
strncpy(ports[port].collect_digits[marker++], digit, sizeof(ports[port].collect_digits[marker])); 
```

引用`marker`和`marker++`相同的表达式。在这种情况下，++ 的评估顺序是[未定义](http://www.eskimo.com/~scs/cclass/notes/sx7c.html)的——第二个引用`marker`可以在执行增量之前或之后评估。

# mfc - Clistctrl 项目文本颜色

> ID：700271
> 
> 赞同：2
> 
> 时间：2009-03-31T06:26:45.357
> 
> 标签：mfc, clistctrl

如何更改 Clistctrl 项目（报告视图）的文本颜色？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-31T08:03:43.827

您需要处理[NM_CUSTOMDRAW](http://msdn.microsoft.com/en-us/library/bb774865(VS.85).aspx)消息并更改该处理程序中的文本颜色。

例如，请参阅[这篇文章](http://www.codeproject.com/KB/list/lvcustomdraw.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-06-01T14:34:09.397

我将实现一个`CMFCListCtrl`派生类并覆盖该`OnGetCellTextColor`方法。这种方式比使用自定义绘图要容易得多。

# asp.net-mvc - MVC - 如何更改帖子中文本框的值？

> ID：700274
> 
> 赞同：4
> 
> 时间：2009-03-31T06:27:13.483
> 
> 标签：asp.net-mvc

`ModelState.AddModelError`用户单击我页面的提交按钮后，会出现一个经过验证的文本框，如果它无效，我会使用该方法显示错误消息。我需要替换此文本框的值并将带有错误消息的页面显示给用户。

问题是我无法更改文本框的值，我正在尝试`ViewData["textbox"] = "new value";`但它被忽略了......

我怎样才能做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-06-21T16:24:02.717

您可以使用 ModelState.Remove(nameOfProperty) 像：

```
ModelState.Remove("CustomerId");
model.CustomerId = 123;
return View(model); 
```

这将起作用。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-31T06:43:50.993

我也不知道答案，检查了`ModelState`对象并发现：

`ModelState.SetModelValue()`

我的模型有一个我检查的 Name 属性，如果它无效，会发生这种情况：

```
ModelState.AddModelError("Name", "Name is required.");
ModelState.SetModelValue("Name", new ValueProviderResult("Some string",string.Empty,new CultureInfo("en-US"))); 
```

这对我有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-30T13:13:49.900

我有一种情况，我想在 POST 到控制器之间保留一个隐藏值。隐藏值随着其他值的更改而被修改。如果不手动更新 ModelState 中的值，我无法更新隐藏元素。

我不喜欢这种方法，因为不使用对 Model 值的强类型引用感觉很奇怪。

我发现`ModelState.Clear`在返回 View 结果之前直接调用对我有用。然后它似乎从模型中获取值，而不是在之前的 POST 中提交的值。

我认为在 ModelState 中使用错误时，这种方法可能会出现问题，但我的场景不使用模型错误。

# gwt - 如何在 gwt 的选项卡面板中禁用选项卡

> ID：700290
> 
> 赞同：0
> 
> 时间：2009-03-31T06:34:07.710
> 
> 标签：gwt, tabpanel

我在 gwt 中有一个选项卡面板。我希望允许用户仅通过鼠标选择选项卡。对于这个我已经禁用了 tabpanle 中所有选项卡的 tabindex。我试过这段代码：

```
DOM.setElementAttribute(cdrMeseTabPanel.getElement(), "tabIndex", "-1" ); 
```

但它不工作。

请问有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-08T13:12:24.933

尝试将 tabIndex 设置为空属性：

```
DOM.setElementAttribute(cdrMeseTabPanel.getElement(), "tabIndex", "" ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-07-22T19:39:13.747

只需完全删除标签索引，它对我有用。

# c# - ASP.NET 有没有设计向导的好方法？

> ID：700292
> 
> 赞同：1
> 
> 时间：2009-03-31T06:34:52.107
> 
> 标签：c#, asp.net, wizard

我知道有一个可用的向导控件，但我想要的太简单了，我无法弄清楚我是从哪里开始偏离这里的深渊的。当用户输入他们的名字并点击下一步时，我希望日历控件可以选择开始日期。我可以将开始日期标记为绿色。我希望他们选择离开，直到他们点击继续按钮。问题 1 是他们可以在没有日期的情况下点击下一步。我想抓住那个。问题二是他们可以在点击下一个之前多次重新选择。我希望他们能够做到这一点。一旦他们点击下一个，我希望他们能够一遍又一遍地选择和结束日期，直到他们点击下一个。然后我希望他们确认他们的合作。我猜逻辑不是那么简单……我写的代码太糟糕了。:(。即使是正确的修复也让我头疼，因为 StartDateStartPart 和 EndDateStartPart 只会变成精神上的胡言乱语。我显然将不得不重新考虑并从头开始重做。

```
<script runat="server" enableviewstate="True">

DateTime begin;
DateTime end;
int iSelectedStart = 0;
int iSelectedEnd = 0;
int iPutName = 0;

protected void Button1_Click(object sender, EventArgs e)
{
  if (iPutName == 0)
  {
    Label1.Text = TextBox1.Text + " you will be slecting your start and end dates.";
    LabelInstructions1.Text = "Please select a begin date and hit next";
    Calendar1.SelectionMode = System.Web.UI.WebControls.CalendarSelectionMode.Day;
    iPutName = 1;
    ViewState["iPutName"] = 1;
    ViewState["Label1_Text"] = Label1.Text;
    ViewState["LabelInstructions1_Text"] = LabelInstructions1.Text;
    ViewState["Calendar1_SelectionMode"] = Calendar1.SelectionMode;
  }
  else
  {
    if (iSelectedStart <= 0)
    {
      LabelInstructions1.Text = "You have not selected a start date please do so.";
    }
    else if (iSelectedStart < 99)
    {
      iSelectedStart = 99;
      Label1.Text = TextBox1.Text + " you will be slecting your start and end dates.";
      LabelInstructions1.Text = "Please select an end date and hit confirm";
      ViewState["begin"] = begin;
      ViewState["iSelectedStart"] = iSelectedStart;
    }
    else
    {
      if (iSelectedEnd = 0)
      {
        LabelInstructions1.Text = "You have not selected a start date please do so.";
      }
    }

  }
}

protected void Calendar1_SelectionChanged(object sender, EventArgs e)
{
  if (iSelectedStart < 99)
  {
    iSelectedStart++;
    begin = Calendar1.SelectedDate;
    ViewState["iSelectedStart"] = iSelectedStart;
    ViewState["begin"] = begin;
  }
  else
  {
    if (begin == Calendar1.SelectedDate)
    {
      LabelInstructions1.Text = "Error you cannot select the same start and end date";
      LabelInstructions1.ForeColor = System.Drawing.Color.Red;
    }
    else
    {
      end = Calendar1.SelectedDate;
      iSelectedEnd = 0;
      ViewState["end"] = end;
    }
  }
}

protected void Calendar1_DayRender(object sender, DayRenderEventArgs e)
{
  if (e.Day.Date == begin)
  {
    e.Cell.BackColor = System.Drawing.Color.Green;
  }
  if (e.Day.Date == end)
  {
    e.Cell.BackColor = System.Drawing.Color.Red;
  }
}

protected void Page_Load(object sender, EventArgs e)
{
  if (ViewState["iPutName"] != null)
    iPutName = (int)ViewState["iPutName"];

  if (ViewState["Label1_Text"] != null) 
   Label1.Text = ViewState["Label1_Text"].ToString();

  if (ViewState["LabelInstructions1_Text"] != null)
    LabelInstructions1.Text = ViewState["LabelInstructions1_Text"].ToString();

  if (ViewState["Calendar1_SelectionMode"] != null)
    Calendar1.SelectionMode = (CalendarSelectionMode) ViewState["Calendar1_SelectionMode"];

  if (ViewState["begin"] != null)
    begin = (DateTime)ViewState["begin"];

  if (ViewState["end"] != null)
    end = (DateTime)ViewState["end"];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-01T03:19:54.283

如果您不想弄乱 AJAX，使用 Web 表单执行此类操作的更传统方法是为向导的每个页面/表单使用面板控件，然后在回发时隐藏或显示各种面板。它不像 AJAX 方法那样有趣或酷，但如果它真的只是一个简单的小向导，那么这是一种快速简便的方法。

Web 表单可能如下所示：

```
<%@ Page Language="C#" AutoEventWireup="true" CodeBehind="Default.aspx.cs" Inherits="PanelWizard._Default" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" >
<head runat="server">
    <title>Untitled Page</title>
</head>
<body>
    <form id="form1" runat="server">
    <div>
        <asp:Panel ID="wizForm1" runat="server" Height="50px" Width="125px">
            <asp:TextBox ID="txtName" runat="server" OnTextChanged="TextBox1_TextChanged"></asp:TextBox></asp:Panel>

    </div>
        <asp:Panel ID="wizForm2" runat="server" Height="50px" Width="125px" Visible="False">
            <asp:Calendar ID="calStart" runat="server"></asp:Calendar>
        </asp:Panel>
        <asp:Button ID="btnContinue" runat="server" OnClick="btnContinue_Click" Text="Continue" />
    </form>
</body>
</html> 
```

页面视图状态将管理您的控件的值，然后您可以在隐藏和显示面板时在代码隐藏中访问它以实现您的业务逻辑。例如：

```
namespace PanelWizard
{
    public partial class _Default : System.Web.UI.Page
    {
        protected void btnContinue_Click(object sender, EventArgs e)
        {
            // validate controls according to business logic
            //...

            // Hide and reveal panels based on the currently visible panel.
            if (wizForm1.Visible)
            {
                wizForm1.Visible = false;
                wizForm2.Visible = true;
            }
            else if (wizForm2.Visible)
            {
                // and so on...
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-31T07:10:20.307

看起来您可能必须使用 javascript/ajax 为向导构建直观的 UI。我会推荐 Jquery，因为它易于学习和操作 DOM 元素。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-01T02:46:22.647

经过深思熟虑，我认为我需要制作一个有限状态机，其中包含一个显示所有可能状态转换的图表。此外，选择好的变量名而不是作为学习的写作可能是必要的。

# macos - 是否有任何 API 可以在 Mac OSX 中打开 DXVA

> ID：700293
> 
> 赞同：0
> 
> 时间：2009-03-31T06:35:08.847
> 
> 标签：macos, macos-carbon

我在 MAC OSX 中写了一个基于 Carbon 的视频播放应用程序，有没有 API 可以打开显卡支持的 DXVA 功能？它是否支持 QuickTime SDK 或 Carbon API？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-31T08:48:54.110

我相信只有在最近的硬件上，QuickTime 才会使用硬件视频加速来解码某些类型的视频流。

请注意，这与显卡的功能没有特别的关系，例如 8800GT PureVideo 功能在 Windows 下运行良好，但在 OS X 中未使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-31T08:20:02.917

DirectX 是 Windows 的一部分。它在 Mac OS X 中不存在。

如果您正在进行硬件加速的视频播放：您为什么要担心它？如果硬件支持它，API 很可能会使用它。所以只要播放你的电影，让图书馆通过显卡来处理它。

如果你正在做视频捕捉：[Core Video](http://developer.apple.com/documentation/graphicsimaging/conceptual/CoreVideo/)会让你通过显卡来做到这一点。

# c# - 当具有已存在的外键对象时，如何使用实体框架添加对象

> ID：700310
> 
> 赞同：2
> 
> 时间：2009-03-31T06:41:25.553
> 
> 标签：c#, entity-framework, .net-3.5

我有 2 张桌子：

```
tblAuthors
 - id
 - username

tblPosts
 - id
 - authorid 
```

所以如果我创建一个新帖子

```
var post = new Post { Id=Guid.NewId(), Author=new Author { UserName="username", Id="id in database } }; 
```

帖子的作者已经在数据库中了，但是帖子本身没有...

所以我想做：

```
entities.AddToPosts(obj); 
```

但它试图添加作者和帖子......有没有办法让它保存作者并添加帖子？还是完全忽略作者？

我将 Post 和 Author 作为我自己的 POCO 业务对象，它们从数据库中提取，然后转换为我的业务层。我不想重新拉它们，因为我可以在我的业务层进行修改。所以我只想附加对象。

我不想保留数据对象，我将它们拉出来并将它们转换为业务对象，然后在我想推回数据库并将业务对象转换为数据对象之前不要再触摸它们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-31T06:47:55.023

您不应该首先从数据库中检索作者记录以便能够在 Post 对象中设置它吗？

所以你会得到：

```
var author = Author.Select(a => a.Id).FirstOrDefault();
var post = new Post { Id=Guid.NewId(), Author=author };
entities.AddToPosts(obj); 
```

也许您可以使用[Attach](http://msdn.microsoft.com/en-us/library/system.data.objects.objectcontext.attach.aspx)和[AttachTo](http://msdn.microsoft.com/en-us/library/system.data.objects.objectcontext.attachto.aspx) ObjectContext 来附加对象，但在 MSDN 库中没有提到是否执行对数据库的查询。通过一些跟踪，您可以检查是否发生了数据库查询。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-06T19:02:36.840

可以模拟“知名”实体，而无需访问数据库。创建一个新的实体对象，设置实体键中使用的实体的属性，然后调用 ObjectContext.AttachTo。这会将实体添加到处于未更改状态的上下文中，并且现在可以被其他实体引用。

```
// AttachTo
var item = new Item() { ItemId = wellKnownId };
context.AttachTo( "Items", item );
Assert.AreEqual( EntityState.Unchanged, item.EntityState ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-13T06:22:26.070

我有一种预感，您正在寻找的功能已在 EF 的下一个版本中公布。有一个与实体关联@mix 相关的完整主题。

~~或者您也可以尝试将 AuthorId 列从 db 映射到实体。（默认不映射）~~ 您无法映射外键，因此如果不从 db 获取一个对象，您就无法关联一个对象。

编辑：这就是为什么我仍在使用提供此功能的 linq2sql。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-13T19:29:35.520

EF 尚不完全支持此功能，我必须执行以下操作：

```
var post = new Post { Id=Guid.NewId(), AuthorReference.EntityKey = new EntityKey("Authors", "Id", authorIdValue) };
entities.AddToPost(post); 
```

# java - Swing中的Container有什么用？

> ID：700314
> 
> 赞同：-1
> 
> 时间：2009-03-31T06:44:52.677
> 
> 标签：java, swing

Swing中的Container有什么用？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-31T06:57:41.443

Swing Container 是一个包含或包裹其他组件的组件。它有助于在 GUI 中将相关组件组合在一起。网上有很多资源解释了如何使用容器。

*   [http://java.sun.com/products/jfc/tsc/articles/containers/index.html](http://java.sun.com/products/jfc/tsc/articles/containers/index.html)
*   [http://oreilly.com/catalog/jswing/chapter/ch08.pdf](http://oreilly.com/catalog/jswing/chapter/ch08.pdf)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-01T05:40:05.793

Swing 中的容器是包含其他组件的东西。

容器负责根据您的布局显示组件。

如果按钮位于左上角，则每次调整窗口大小时，按钮仍会位于左上角。这是因为容器包含按钮，同时包含其布局位置。这就是为什么它是 container.setLayout() 和 container.add()

在 Java Swing 中，很多组件都可以是一个容器。JButton 可以是容器，JLabel 也可以。JPanel 也是一个容器，任何扩展这三个的东西也可以是一个容器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-06T12:59:37.883

容器可以有其他组件或容器。它可以是三个级别。

1.  顶级的。比如JFrame、JDialog、JApplet。这些容器是不能包含的。
2.  即时容器，比如我们常用的Jpanel
3.  低级。这就是我们所知的低级组件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-31T06:56:46.360

嗯......容器用于包含其他小部件，并帮助以适合 UI 设计的方式排列它们。

例如，[JPanel](http://java.sun.com/j2se/1.3/docs/api/javax/swing/JPanel.html)是一个通用容器。与[LayoutManager](http://java.sun.com/j2se/1.4.2/docs/api/java/awt/LayoutManager.html)一起，您可以获得许多不同的小部件布局。

# popup - 现在默认弹出替换是什么？

> ID：700319
> 
> 赞同：3
> 
> 时间：2009-03-31T06:47:07.817
> 
> 标签：popup

我知道弹出窗口[不好](http://www.useit.com/alertbox/990530.html)，应该尽可能避免，但现在真的是这样吗，每当我想到使用弹出窗口时，我应该总是考虑其他选项？有什么例外吗？最后一个问题是：弹出窗口的默认替换是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-31T06:48:52.197

您可以使用任何基于 javascript 的对话框。[以jQuery UI 对话框](http://jqueryui.com/demos/dialog/)为例

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-31T06:50:34.707

“Web2.0”弹出窗口可能是一个灯箱。我希望这些只是昙花一现，因为它们有点烦人（很像弹出窗口）。

[http://en.wikipedia.org/wiki/Lightbox_(JavaScript)](http://en.wikipedia.org/wiki/Lightbox_(JavaScript))

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-31T15:39:22.873

横幅，就像你在 Stack Overflow 的顶部告诉你徽章、评论一样，如果你是新用户，请查看常见问题解答是我的最爱。他们并没有真正妨碍他们，并且可以链接到主要内容。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-01T03:42:43.680

这取决于您要完成的工作。在某些情况下，弹出窗口是完全可以接受的。对弹出窗口的厌恶源于以广告的形式将弹出窗口强加给用户。我认为弹出窗口在正确的情况下仍然是有效的设备。

我的经验法则是不要为用户做出任何他们可以自己做出的决定。这通常包括打开一个弹出窗口，因为如果他们愿意，他们可以右键单击并选择“在新窗口中打开链接”。

您想在不允许任何进一步交互的情况下捕获用户输入吗？模态对话框是您的朋友。

在某些情况下，您希望提供一些有用的信息或快速参考，而无需关闭网页的其余部分或导航到其他位置。这可以使用一些 javascript 和浮动 div 来解决，但很多时候弹出窗口会做你想做的事，而不会打扰用户。

我倾向于阅读 37 个信号和 UIE 之类的资源，以跟上在不疏远用户的情况下增强用户体验的最佳方法。

# java - 如何在 JPanel 上的 JPanel+图像上部分添加不同的形状

> ID：700322
> 
> 赞同：0
> 
> 时间：2009-03-31T06:48:43.197
> 
> 标签：java, swing

我的项目在 Java Swing 中。

我有一个 JPanel，我在其上添加了一些带有 .png 扩展名的图像（位于 JLabels 上）。

现在我想添加一条线，它部分位于 JPanel 上，部分位于该图像上。目前，当我添加线条时，JPanel 会显示线条，但是当我调整图像大小并将其拖到图像时，图像会隐藏线条。

怎么做才能使图像不隐藏我的线条并将其显示在图像上？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-31T06:56:04.507

您最好自己绘制图像并在同一控件的顶部绘制线条。创建一个扩展 Canvas 的类，并在 paint 方法中编写您自己的代码来绘制图像，然后绘制线条。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-31T16:17:34.250

另一种选择是使用 JLayeredPane 而不是 JPanel 作为主容器，并将非透明 (setOpaque(false)) JPanel 放在更高层使用 JLayeredPane.setLayer(yourPanel, highNumber) 并使用类似 GridBagLayout 或简单的东西填充 JLayeredPane自定义布局管理器。

然后，您可以在该面板上实现自定义绘画。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-31T16:13:27.007

您可以尝试使用[JXLayer](https://jxlayer.dev.java.net/)并为其定义一个自定义 LayerUI 来绘制线条。然后这些将出现在您需要绘制的组件上方。这有点高级，涉及使用第 3 方（开源）自定义组件，但可以让您改变对稍后用于渲染图像的 Swing 组件的想法。我认为[这篇](http://weblogs.java.net/blog/alexfromsun/archive/2008/07/jxlayer_30_how.html)文章最好地描述了如何实现你想要的。

过去我以各种方式解决了许多与此类似的问题，但没有一个具有 JXLayer 的灵活性和可维护性。

# iphone - 如何调整子视图和超级视图的大小

> ID：700326
> 
> 赞同：0
> 
> 时间：2009-03-31T06:51:33.797
> 
> 标签：iphone

我想用子视图在不同方向调整超级视图的大小。我有一个图像视图，我在这个图像中添加不同的子视图并分层。请告诉我如何在不同方向调整图像的所有部分。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-31T07:30:05.937

例如，如果您在 uiview 中有图像，如果您旋转 uiview，则里面的内容将随之改变。

调整大小相同。当方向改变时我手动调整大小（我使用观察者来监听方向的变化，并使用 CGAffineTransform 手动改变我的大小）

# c# - 如何在 Datalist 中检查子 td

> ID：700334
> 
> 赞同：0
> 
> 时间：2009-03-31T06:58:25.420
> 
> 标签：c#, asp.net, datalist, itemtemplate

我有一个数据列表。以下是 ItemTemplate 的结构：

```
<ItemTemplate>                                        
  <div id="driversGrid" runat="server" style="width:3500px;" >
    <table cellpadding="0" cellspacing="0" border="0" width="3500px"> 
      <tr>
        <td id="Td1" runat="server" style="visibility:hidden;">
          <asp:Label ID="lblID" runat="server" BackColor="White" Font-Bold="true" Text='<%# Eval("ID") %>'  /><br />
        </td>
        <td id="title" style="width:90px;text-align:center;">
          <asp:Label ID="lblTitle" runat="server" BackColor="White" Font-Bold="true" Text='<%# Eval("Name") %>'  /><br />
        </td>
        <td id="am0900" runat="server" style="width:90px;">&nbsp;</td>
        <td id="am0915" runat="server" style="width:90px;">&nbsp;</td>
        <td id="am0930" runat="server" style="width:90px;">&nbsp;</td>
        <td id="am0945" runat="server" style="width:90px;">&nbsp;</td>
        <td id="am1000" runat="server" style="width:90px;">&nbsp;</td>
        <td id="am1015" runat="server" style="width:90px;">&nbsp;</td>
        <td id="am1030" runat="server" style="width:90px;">&nbsp;</td>
        <td id="am1045" runat="server" style="width:90px;">&nbsp;</td>
        <td id="am1100" runat="server" style="width:90px;">&nbsp;</td>
      </tr>
    </table>
  </div>          
</ItemTemplate> 
```

现在，在 itemdatabound 事件中，我以上午 10:25 的形式从数据库中获取多个时间（数据）。

我操作每个数据并将其转换为`am1030`（类似于 itemTemplate 中的 td ID 之一）。现在我想检查 ItemTemplate 中的每个 td 并将`lblID`（即人员 ID）与我的变量中的 ID 进行比较，然后将其`tdID`与操作数据进行比较。如果它们匹配，则更改 td 的背景颜色。

简而言之，我想检查是否`lblID`为 3，然后获取带有 ID 的 td`am1030`并更改背景颜色。

**需要在 C#.net 中完成。**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-31T08:01:30.743

使用 foreach 循环遍历`e.Item.Controls`集合，如下所示 -

```
foreach (Control c in e.Item.Controls)
{
    //if c is HtmlCell, then check the ID and change the color.
} 
```

# c# - C# 和可变数量的参数

> ID：700335
> 
> 赞同：3
> 
> 时间：2009-03-31T07:01:43.710
> 
> 标签：c#, params

我尝试了以下代码：

```
class Program: ProgParent
    {

        public int Max(params int[] op)
        {
            return 0;
        }

        public int Max(int i, params int[] op)
        {
            return 1;
        }

        public int Max(int i, int j, params int[] op)
        {
            return 2;
        }

        public static void Main(string[] args)
        {
            System.Console.WriteLine((new Program()).Max(5, 6, 7, 8));
            System.Console.ReadKey();
        }
    } 
```

它执行并使用最具体的可用功能。但是编译器对此没有给出警告或错误。为什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-31T07:44:16.620

C# 语言规范说：

> 在执行重载决议时，带有参数数组的方法可以以它的正常形式[即传递一个数组]或它的扩展形式[即传递可变数量的参数]适用。方法的扩展形式仅在方法的正常形式不可用并且仅当与扩展形式具有相同签名的方法尚未在相同类型中声明时才可用"

简而言之（稍微简化）：如果重载决议不明确，编译器会选择非参数重载。

我猜这个决定的原因（而不是让像你这样的代码非法）包括：

*   如果您的方法具有签名：void fn(params object[] p)，您希望有某种方式来调用“正常形式”（通过传递 object[]）。所以编译器无论如何都必须处理模棱两可的情况。
*   Creating a temporary array is a lot more expensive than a method call, so you might want to create non-params overloads with 1,2,3 parameters that behave the same but are more efficient. (like e.g. String.Format)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-31T07:08:21.497

忽略构建错误（我将其归结为拼写错误）-您期望或想要什么警告？它正在寻找匹配的重载并使用它......

严格来说，我可以调用不同的重载——通过传递数组，但是是的，用法并不完全清楚。

如果没有多个重载 with `params`，这种模式在诸如`string.Concat`etc 之类的东西中被大量使用（它支持`+`引擎盖下的字符串）。

# c# - 无法在 ASP.NET 用户控件上执行任何 javascript

> ID：700337
> 
> 赞同：1
> 
> 时间：2009-03-31T07:01:46.940
> 
> 标签：c#, asp.net, telerik, scriptmanager, clientscript

我正在尝试做最简单的事情，通过 javascript 从我的用户控件 (ascx.cs) 的代码隐藏中显示警报弹出窗口。

我试过了

```
protected void btnSave_Click(object sender, EventArgs e)
{
    ScriptManager.RegisterStartupScript(btnSave, GetType(), "uniqueID", "alert('hello');", true);
} 
```

也

```
Page.ClientScript.RegisterStartupScript(GetType(), "uniqueID", "alert('hello');", true); 
```

但似乎没有什么对我有用。该控件位于 ASPX 页面中的 RadAjaxPanel (telerik) 内。

我在这里遗漏了一些明显的东西。有什么想法吗？

**编辑：**据我所知，javascript 没有注入到 html 源代码中。我在 html 中查找 ID 和实际的警报语句。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-31T07:09:57.733

将页面类型传递给*客户端脚本类型*参数：

```
Page.ClientScript.RegisterClientScriptBlock(typeof(MyPage), 
    "myPostBackScript", script, true); 
```

**编辑：**通常这段代码可以工作，但我不知道 Telerik 的控制如何影响注入的脚本。我认为你应该打开页面的 HTML 源代码并尝试找到注入的脚本。这将帮助我们解决您的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-31T14:27:21.410

啊，问题是 Telerik RadAjaxPanel。我只需要在它们上将 EnableOutsideScripts 设置为 true，如下所示：

```
<telerik:RadAjaxPanel ID="ajaxpanel" runat="server" LoadingPanelID="ajaxLoadingPanel" EnableOutsideScripts="true"> 
```

然后我可以使用以下代码：

```
ScriptManager.RegisterStartupScript(btnSave, GetType(), "uniqueID", "alert('hello');", true); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-31T07:03:34.423

你`<form runat="server"`的页面里有吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-31T07:48:37.063

如果从按钮的 onClienClick 事件中调用，你会调用吗？无论您使用什么控件，请确保您是从客户端事件调用 js

另外，看看[这个](http://msdn.microsoft.com/en-us/library/z9h4dk8y.aspx)的想法

### 编辑

你不能从服务器调用 js，js 是客户端脚本。您可以做的是在完成所有检查后注册您的脚本，并将其绑定到 onload 事件。有关详细信息，请参阅此[SO 问题](https://stackoverflow.com/questions/9434/how-do-i-add-an-additional-window-onload-event-in-javascript)

### 编辑2

查看[此页面上的最后一篇文章](http://forums.asp.net/t/999492.aspx)

# ruby-on-rails - 在 Rails 中反转 has_many

> ID：700338
> 
> 赞同：3
> 
> 时间：2009-03-31T07:02:29.420
> 
> 标签：ruby-on-rails, reverse, has-many

假设我有模型：用户和项目以及它们之间的多对多关系。如何获得具有已定义属性的确切（不再）项目的用户，即具有颜色 = ['red', 'black'] 的项目的用户。

当然我可以这样做：

```
User.all :joins => [:items, :items], :conditions => {:"items.color" => "red", :"items_users.color" => 'black'} 
```

但是对于更多的属性，这将是相当麻烦的。我也可以这样做：

```
User.all(:conditions => ["items.color in (?), ['red', 'black']], :include => :items) 
```

但是这个也返回了带有颜色的用户= ['red', 'black', 'blue', 'etc']

所以唯一的解决方案是获取所有内容并使用 ruby​​ 语法进行排序？如何在一个 SQL 查询或 Rails AR 语法中做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-31T08:02:36.280

在我看来，优化程序员时间和可读性的方式：

```
#get all users who have items which are both red and black but no other colors
candidate_users = User.all(:include => :items)
candidate_users.reject! do |candidate| 
  candidate.items.map {|item| item.color}.sort != ['black', 'red']
end 
```

如果您希望在那里循环访问大量用户，那么您需要对它进行 SQL 处理。警告：SQL 不是我的包，宝贝：使用前先测试。

```
select users.*, items.* FROM users 
  INNER JOIN items_users ON (items_users.user_id = users.id) 
  INNER JOIN items ON (items_users.item_id = items.id) 
    GROUP BY users.id HAVING COUNT(DISTINCT items.color) = 2 
```

我认为邪恶的混乱做了什么：

1) 抓住每个用户/项目组合 2) 筛选出拥有恰好 2 种不同颜色项目的用户

这意味着您需要：

```
candidate_users.reject! do |candidate| 
  candidate.items.map {|item| item.color}.sort != ['black', 'red']
end 
```

您可能可以完全消除这里对 ruby​​ 的需求，但 SQL 会变得丑陋七种。（交叉连接，哦，我的...）

# c# - 检查是否安装了 wmencoder 的特定修补程序

> ID：700346
> 
> 赞同：0
> 
> 时间：2009-03-31T07:06:57.177
> 
> 标签：c#

我想检查 Windows 2000 中的 wmencoder 是否安装了特定的修补程序。我在哪里查看注册表或是否有其他方法可以找到它

我已经调查过了，因为 xp 条目在那里，但对于 windows 2000 什么都没有

无论如何要这样做吗

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-02T19:26:07.867

[类似问题](https://stackoverflow.com/questions/815340/how-do-i-get-a-list-of-installed-updates-and-hotfixes)（如何获取已安装更新和修补程序的列表）

使用 WMI 和[Win32_QuickFixEngineering](http://msdn.microsoft.com/en-us/library/aa394391(VS.85).aspx)您可以获得系统上安装的所有修补程序。

```
const string query = "SELECT HotFixID FROM Win32_QuickFixEngineering";
var search = new ManagementObjectSearcher(query);
var collection = search.Get();

foreach (ManagementObject quickFix in collection)
    Console.WriteLine(quickFix["HotFixID"].ToString()); 
```

# jquery - 在表单验证之后和结果页面之前显示消息

> ID：700347
> 
> 赞同：0
> 
> 时间：2009-03-31T07:07:00.563
> 
> 标签：jquery, validation

我有一个使用出色的 jQuery 验证插件的表单。这是一个多阶段的表格，其中一个涉及上传文件，这些文件在被接受之前会进行病毒扫描。

由于上传和病毒扫描可能需要一段时间，理想情况下，我希望向用户显示一条临时消息，最好是模态叠加样式，它会一直保留到结果页面。

在我看来，这很简单，但我无法让它工作（我已经对消息代码进行了排序）。问题似乎是我的消息覆盖必须在成功验证后触发并且不停止提交表单。

我想要做的甚至可能吗？我开始认为我离它太近了，需要寻找另一种解决方案。任何帮助将不胜感激。

[编辑：顺便说一句，这是对上一个问题](https://stackoverflow.com/questions/656583/scan-php-uploads-for-viruses)的跟进。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-31T07:18:38.553

您是否尝试过使用[submitHandler](http://docs.jquery.com/Plugins/Validation/validate#options)？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-31T08:14:04.943

我会为此使用[blockUI](http://www.malsup.com/jquery/block/)或[facebox](https://github.com/defunkt/facebox)插件。

# python - 哪些语言提供用于与 Genesys 服务交互的 SDK？

> ID：700350
> 
> 赞同：0
> 
> 时间：2009-03-31T07:07:40.483
> 
> 标签：python, pbx, genesys, pabx

Genesys 是一个联络中心平台，提供用于处理硬 PBX 和软 PBX 的软件。他们还提供许多辅助服务来支持更广泛的联络中心业务。

我知道 Genesys 直接提供的 .NET 和 Java SDK。是否有任何其他语言的 SDK 支持，具体来说，是否有官方 Python 库用于与其服务交互？

或者，是否有任何设计用于与 Python 的 Genesys 服务交互的第三方库？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-31T07:36:48.620

如果他们提供 C 库，您可以使用 ctypes 与之交互。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-07-22T05:03:38.800

为了完整起见，可以将 ironpython ( [http://ironpython.net/](http://ironpython.net/) ) 与genesys 的.net 库一起使用。

FWIW，我将 java 库与 jython 一起使用。

我有点期待脚本是可互换的（即在 jython 和 Ironpython 之间），但不幸的是，API 在某些方面有所不同。IE。某些函数的参数不同或顺序不同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-02-01T12:06:22.907

您需要与什么进行交互？GIS 为许多功能提供了肥皂调用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-08-19T15:12:12.933

既没有原生 C 也没有 Python 库。最好的办法是按照建议使用 GIS。

# zend-framework - 使用 Zend 数据库时出现一些 Zend 消息错误

> ID：700354
> 
> 赞同：-1
> 
> 时间：2009-03-31T07:09:22.257
> 
> 标签：zend-framework

我收到以下错误消息：

```
致命错误：在 C:\wamp\www\VPZ\Lib\ 中带有消息“文件“Zend\Db\Adapter\Mysql.php”不存在或在文件中找不到类“Zend_Db_Adapter_Mysql”的未捕获异常“Zend_Exception” Zend\Loader.php:88
堆栈跟踪：
#0 C:\wamp\www\VPZ\Lib\Zend\Db.php(247): Zend_Loader::loadClass('Zend_Db_Adapter...')
#1 C:\wamp\www\VPZ\VPZ_Grid\core\vpz_datagrid.class.php(16): Zend_Db::factory('mysql')  
#2 C:\wamp\www\vpz_test.php(9): VPZ_DataGrid->ConnectDb(Object(VPZ_Connector))
#3 {main} 在第 88 行的 C:\wamp\www\VPZ\Lib\Zend\Loader.php 中抛出

```

我不知道这是怎么回事，在“Zend\Db\Adapter\Mysql.php”中找到目录没有但有 Mysqli.php

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-25T11:29:45.730

我认为，您正在尝试使用 MySQL 适配器创建 Zend_Db 对象。Zend 框架默认没有 MySQL 适配器。您应该使用 MySQLi 适配器或 Pdo_Mysql。签出您的代码，您将在其中创建 Zend_Db 对象。传入“Pdo_Mysql”作为适配器名称，而不是“Mysql”：

```
 $_db = Zend_Db::factory('Mysql', $configArray );
 // uses mysql adapter, which is not available by default.

 $_db1 = Zend_Db::factory('Mysqli', $configArray );
 // uses mysqli adapter, but needs php_mysqli extension to be installed.

 $_db1 = Zend_Db::factory('Pdo_Mysql', $configArray );
 // uses PDO mysql adapter which is much better, but needs PDO to be installed, which most of times is installed. 
```

您可以为 Zend_Db 编写自己的适配器。编写一个类并扩展 Zend_Db_Adapter_Abstract。但是实现 Mysql 适配器存在一些问题，因为 PHP_MySQL 扩展（将为 PHP 提供 mysql_* 函数）不支持许多功能（如客户端存储过程，...）。所以你不能实现其他 Zend_Db_Adapter 拥有的所有方法。我以前做过。我想使用我的应用程序，它使用了 Zend Framework，并将它托管在未安装 PDO 和 Mysqli 的服务器上。我为 Zend_Db 实现了一个 Mysql 适配器，但是因为我知道哪些方法没有实现，所以我避免调用这些方法。最好的事情是如果您可以安装 PDO，并使用 Pdo_* 适配器。

# msbuild - 编写使用另一个自定义 MSBuild 任务的自定义 MSBuild 任务

> ID：700355
> 
> 赞同：4
> 
> 时间：2009-03-31T07:09:30.323
> 
> 标签：msbuild

我编写了一个自定义 MSBuild 任务，称为 TaskA，它解析文件并对其进行一些处理。我现在想编写另一个 MSBUild 任务，称为 TaskB，在其中使用 TaskA。我知道我可以像使用普通类一样使用 TaskA，只需从 TaskB 调用它的执行方法。但是你觉得这靠谱吗？执行 TaskB 时，是否仍会记录来自 TaskA 的日志消息？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-31T07:27:35.227

是的，这是合理的，是的，来自 TaskA 的日志消息仍将被记录。不要忘记将 taskA.BuildEngine 设置为 taskB 之一。

```
public class TaskA : Task
{
    public override bool Execute()
    {
        Log.LogMessage("Task A");

        return true;
    }
}

public class TaskB : Task
{
    public override bool Execute()
    {
        Log.LogMessage("Task B");

        TaskA taskA = new TaskA();
        taskA.BuildEngine = BuildEngine;

        taskA.Execute();

        return true;
    }
} 
```

# c# - C#中的数据类型字符串与字符串

> ID：700361
> 
> 赞同：0
> 
> 时间：2009-03-31T07:10:30.133
> 
> 标签：c#

在 C# 中何时使用“字符串”以及何时使用“字符串”数据类型？

它们之间有什么区别？

谢谢。

* * *

重复： [C#中的字符串与字符串](https://stackoverflow.com/questions/215255/string-vs-string-in-c)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-31T07:18:05.013

没有区别。字符串是字符串的别名。int 和 Int32 等也是如此。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-31T07:11:33.547

他们是一样的。选择一种符号并坚持下去。

# artificial-intelligence - 解释或研究基于人工智能 (AI) 的麻将游戏方法/策略的资源

> ID：700363
> 
> 赞同：7
> 
> 时间：2009-03-31T07:11:19.943
> 
> 标签：artificial-intelligence, mahjong

虽然麻将（实际游戏，不是麻将纸牌）在基本规则和游戏玩法方面相当简单，但为 AI 设定目标以过渡到针对某些最终游戏目标似乎相当复杂。

有人知道与该主题相关的任何论文、研究或其他材料吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-01T16:50:53.430

我认为这可能是您正在寻找的：

> 麻将游戏程序
> 
> 信息技术系的硕士论文
> 
> 丹尼尔·赫尔森
> 
> 与主管 Jan Eric Larsson 和 Bengt Öhman
> 
> 2000 年 9 月 1 日

[http://www.it.lth.se/janeric/mastersprojects/past/hellsson/mother.pdf](http://www.it.lth.se/janeric/mastersprojects/past/hellsson/mother.pdf)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-11-17T11:06:32.547

查看Wan Jing Loh 撰写的**AI Mahjong ，2009 年 12 月 11 日 (** [PDF](http://www.stanford.edu/class/cs229/proj2009/Loh.pdf) )。

> 在这个项目中，我试图开发一个可行的 AI 麻将玩家，通过构建一个能够准确计算玩家获胜后的牌数的手部评估器。

# html - 图片未通过电子邮件正确发送

> ID：700364
> 
> 赞同：1
> 
> 时间：2009-03-31T07:11:27.620
> 
> 标签：html, email, image

我创建了一个电子邮件模板，我使用 PHP 发送电子邮件，但问题是我包含在电子邮件模板中的图像没有正确显示。它显示十字符号。在 Outlook 中，他们提到“单击此处下载图像” - 但是当我单击时没有任何反应。

解决方案是什么？如何将电子邮件与图像一起发送？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-31T07:13:27.100

您最好不要在电子邮件本身中发送图像，而是在网络上链接到它们。因此，在您的电子邮件中，您有：

```
<img src="http://www.example.org/picture.jpg" alt="My Picture"> 
```

# jquery - Jquery 动态表单 - 快速问题

> ID：700365
> 
> 赞同：0
> 
> 时间：2009-03-31T07:11:31.300
> 
> 标签：jquery, xhtml, forms, dynamic, fieldset

我有一个表单，顶部包含四个不同的单选按钮 - 表单的其余部分会根据选中的单选按钮而变化。目前，表单的每个“部分”都在其自己的字段集中，我正在使用 Jquery 隐藏/显示这些。

我怎样才能只提交与填写表格的哪一部分相关的数据？我不想在表格上提交三个空白区域，只填写一个部分。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-31T07:16:13.863

只需创建三个不同的表单，将它们之间的字段分开，然后提交正确的表单。它们都可以指向同一个 URL...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-31T07:58:41.390

你可以 $("#fieldset1").remove() 表单提交的字段集。不像 nivhab 提议的那样优雅，但它也是一种替代方案

# asp.net - SQL 登录访问 ASP.Net 应用程序数据库的权限

> ID：700369
> 
> 赞同：1
> 
> 时间：2009-03-31T07:12:04.060
> 
> 标签：asp.net, sql-server-2005, database-permissions

我总是想知道我需要为我从我的 asp.net 应用程序中使用来访问数据库的 sql 登录提供哪些确切的访问权限和权限。应用程序执行一些存储过程，将数据插入、更新和删除到表中。我也直接在表上选择、删除、更新。还有一些触发器。想知道是否有一个完整的权限矩阵列表来提供帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-31T08:32:50.590

好吧，这取决于你想让它变得多复杂:-)

**最简单的解决方案：**

*   使您的登录/数据库用户具有读取所有表的 db_datareader 角色
*   使您的登录/数据库用户具有 db_datawriter 角色来写入所有表

至于执行存储过程，我们所做的是在我们的数据库中创建一个新的自定义数据库角色“db_executor”，如下所示：

```
CREATE ROLE [db_executor] AUTHORIZATION [dbo]
GRANT EXECUTE TO [db_executor] 
```

然后我们也将此角色授予 db 用户。这个新的自定义数据库角色将对数据库中所有未来存储的 procs/func 的所有现有*AND具有执行权限。*

有了这个，您的 db 用户可以读取和写入任何表并执行任何存储的过程和存储的函数。

**更复杂的解决方案：** 您当然也可以将单个表、视图、过程、函数的权限授予单个数据库用户和/或数据库角色。但它可能会变得非常混乱和复杂。

马克

# python - 如何使用 .pth 文件添加 Python 导入路径

> ID：700375
> 
> 赞同：17
> 
> 时间：2009-03-31T07:15:05.770
> 
> 标签：python, python-import

如果我将 *.pth 文件放在站点包中，它会给出一个 .pth 文件`ImportError`。我没有通过创建 *.pth 文件来了解如何导入。

*（指[在python中导入](https://stackoverflow.com/questions/697281/importing-in-python)）*

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-03-31T07:23:40.290

如果您将`.pth`文件放在`site-packages`包含路径的目录中，python 会在此路径中搜索导入。所以我有一个`sth.pth`文件，其中只包含：

```
K:\Source\Python\lib 
```

在那个目录中有一些普通的 Python 模块：

```
logger.py
fstools.py
... 
```

这允许直接从其他脚本导入这些模块：

```
import logger

log = logger.Log()
... 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-03-31T08:11:16.570

```
/tmp/$ mkdir test; cd test
/tmp/test/$ mkdir foo; mkdir bar
/tmp/test/$ echo -e "foo\nbar" > foobar.pth
/tmp/test/$ cd ..
/tmp/$ python
Python 2.6 (r26:66714, Feb  3 2009, 20:52:03)
[GCC 4.3.2 [gcc-4_3-branch revision 141291]] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> import site, sys
>>> site.addsitedir('test')
>>> sys.path[-3:]
['/tmp/test', '/tmp/test/foo', '/tmp/test/bar'] 
```

# javascript - 实例化 JavaScript 日期对象的语法

> ID：700387
> 
> 赞同：0
> 
> 时间：2009-03-31T07:18:48.583
> 
> 标签：javascript, coding-style, instantiation

在 JavaScript 中，您似乎可以编写以下代码：

```
new Date().getTime(); 
```

...或者：

```
(new Date).getTime(); 
```

第一个是合乎逻辑的，但第二个对我来说似乎有点不寻常......这两种创建 Date 对象的方式有什么区别，第二个的目的是什么？

谢谢，

史蒂夫

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-31T07:44:19.070

似乎在 javascript 中，您可以在没有括号的情况下调用构造函数。至少它适用于我的 Firefox。所以（新日期）==新日期（）

暗示这两个表达式是等价的。或者你可以写

```
(new Date()).getTime(); 
```

这是我通常做的。

我认为这只是个人喜好问题。new 运算符优先于 . 操作员，但视觉可能暗示相反...

# c++ - 代码中的高分辨率计时部分

> ID：700392
> 
> 赞同：7
> 
> 时间：2009-03-31T07:22:35.470
> 
> 标签：c++, time, high-resolution

我想测量循环内函数的速度。但是为什么我这样做的方式总是打印“0”而不是具有 9 位十进制精度（即以纳/微秒为单位）的高分辨率计时？

正确的方法是什么？

```
#include <iomanip>
#include <iostream>
#include <time.h>
int main() {

 for (int i = 0; i <100; i++) {
    std::clock_t startTime = std::clock(); 
    // a very fast function in the middle
    cout << "Time: " << setprecision(9) << (clock() - startTime + 0.00)/CLOCKS_PER_SEC << endl;
 }

 return 0;
} 
```

### 相关问题：

*   [如何克服`clock()`低分辨率](https://stackoverflow.com/questions/588307/)
*   [带有 C++ 和 linux 的高分辨率计时器](https://stackoverflow.com/questions/538609/)
*   [相当于`QueryPerformanceCounter`OSX 上的 Windows](https://stackoverflow.com/questions/464618)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-31T07:25:01.580

将您的时间计算函数`for () { .. }`移到语句之外，然后将总执行时间除以测试循环中的操作数。

```
#include <iostream>
#include <ctime>
#define NUMBER 10000 // the number of operations

// get the difference between start and end time and devide by
// the number of operations
double diffclock(clock_t clock1, clock_t clock2)
{
    double diffticks = clock1 - clock2;
    double diffms = (diffticks) / (CLOCKS_PER_SEC / NUMBER);
    return diffms;
}

int main() {
    // start a timer here
    clock_t begin = clock();

    // execute your functions several times (at least 10'000)
    for (int i = 0; i < NUMBER; i++) {
        // a very fast function in the middle
        func()
    }

    // stop timer here
    clock_t end = clock();

    // display results here
    cout << "Execution time: " << diffclock(end, begin) << " ms." << endl;
    return 0;
} 
```

注意： std::clock() 缺乏足够的分析精度。[参考](http://www.cplusplus.com/reference/clibrary/ctime/clock.html)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-31T07:42:46.500

几点建议：

1.  我会小心优化器，如果我认为它没有做任何事情，它可能会抛出你所有的代码。
2.  您可能想要运行循环 100000 次。
3.  在进行总时间计算之前，将当前时间存储在一个变量中。
4.  多次运行您的程序。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-31T07:46:06.913

如果您需要更高的分辨率，唯一的方法就是依赖于平台。

在 Windows 上，查看[QueryPerformanceCounter/QueryPerformanceFrequency](http://msdn.microsoft.com/en-us/library/ms644904.aspx) API。

在 Linux 上，查找[clock_gettime()](http://www.tin.org/bin/man.cgi?section=3&topic=clock_gettime)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-31T07:46:52.963

请参阅我问过的关于同一件事的问题：显然`clock()`' 的分辨率不能保证这么高。

[C++ 在 Linux 上获取毫秒时间——clock() 似乎不能正常工作](https://stackoverflow.com/questions/588307/)

尝试`gettimeofday`功能，或[提升](http://www.boost.org/doc/libs/1_38_0/libs/timer/timer.htm)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-06T03:17:04.460

如果您需要平台独立性，您需要使用类似 ACE_High_Res_Timer ( [http://www.dre.vanderbilt.edu/Doxygen/5.6.8/html/ace/a00244.html](http://www.dre.vanderbilt.edu/Doxygen/5.6.8/html/ace/a00244.html) )

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-31T07:44:17.430

您可能想研究使用 openMp。

```
#include <omp.h>

int main(int argc, char* argv[])
{       
    double start = omp_get_wtime();

    // code to be checked

    double end = omp_get_wtime();

    double result = end - start;

    return 0;
} 
```

# java - 无论代理类型如何，java tcp ip socket 编程

> ID：700400
> 
> 赞同：3
> 
> 时间：2009-03-31T07:25:40.660
> 
> 标签：java, sockets

如何用java编写TCP IP套接字编程。如果客户端在任何类型的代理后面（可能是 http 或 socks 或没有代理）。

谢谢巴皮

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-31T07:43:58.807

当我遇到此类问题时，我不得不自己编写 http 层（通过 HTTP CONNECT）并使用现有的（在标准库中）socks 层。然而，主要问题是获取代理设置。就我为 Web Start 应用程序执行此操作而言，我可以使用默认浏览器设置。

# iphone - 如何为 iPhone 创建字典样式的滚动条（如在联系人列表中）？

> ID：700403
> 
> 赞同：1
> 
> 时间：2009-03-31T07:26:17.833
> 
> 标签：iphone, objective-c

我正在创建一个 iPhone 应用程序，我希望它具有与 iPhone 的本机联系人选择器视图类似的界面，即您可以滚动浏览的按字母顺序排列的列表，顶部有一个搜索栏，可以缩小列表的范围。特别是，我希望能够在侧面显示字母表中的字母，以便当您滚动列表时，您可以在滚动条中看到您在字母表中的位置。问题是我的数据基本上由键值对组成，而不是联系人数据，所以我不能轻易使用本机联系人选择器。

据我所知，我有两种选择来实现我想要的：

1.  使用 ABPeoplePickerNavigationController 类并破解它以使用我用非地址类型数据填充自己的地址簿。这样做的问题是，默认情况下，地址簿将填满来自 iPhone 的联系人，因此每次打开应用程序时，我都必须刷新这些联系人并建立自己的列表。（更不用说与使用绑定到特定数据结构的接口相关的其他问题）
2.  使用 UISearchBar 和 UIScrollView。这很好，但我不知道如何对滚动条做任何事情，除了改变它的颜色——我看不到如何覆盖它的内容。

关于哪种方法最简单的任何建议？有什么陷阱（特别是1）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-31T09:09:50.893

要将字母放在一边，您只需在表视图数据源中提供 -sectionIndexTitlesForTableView: 方法。至于搜索，那里有更多的工作，它非常依赖于您的数据。然而，UISearchBar 是开始的地方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T21:45:17.477

对于搜索栏，请查看[Three20 库](http://github.com/joehewitt/three20/)中的 TTSearchBar 。

其他一切都可以使用 UITableView 轻松实现。

# asp.net-mvc - 将 viewdata 传递给 asp.net mvc 母版页

> ID：700404
> 
> 赞同：6
> 
> 时间：2009-03-31T07:27:05.397
> 
> 标签：asp.net-mvc, master-pages, viewdata

我正在尝试将 ViewData 传递给我的 asp.net mvc 母版页，以获得我保留在母版页上的 mvc 用户控件。例如，我创建了一个名称下拉列表作为 mvc 用户控件，并将其放在我的母版页中。

我遇到的问题是将 ViewData 传递给母版页。我从 Microsoft 找到了这篇文章，它有一个不错的解决方案，但我想知道是否还有其他“更好”的解决方案。我不喜欢链接中的解决方案是我必须更改每个控制器以从新的控制器类继承。

[http://www.asp.net/learn/MVC/tutorial-13-cs.aspx](http://www.asp.net/learn/MVC/tutorial-13-cs.aspx)

**编辑**：我正在查看的问题是，如果我在依赖于 ViewData 的母版页中放置一个用户控件，我必须为使用所述母版页的每个页面重复包含该 ViewData **。**上面链接中的解决方案可能是最好的解决方案，但我希望还有其他选择。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-31T08:04:58.600

母版页已经可以访问 ViewData。如果你想要强类型访问它，你需要做两件事：

1.  将母版页内容放在基类中（例如 CommonViewData）
2.  您是否从通用 ViewMasterPage<> 类继承母版页：

    " %>

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-09T19:51:49.030

您可以`OnActionExecuting`在基本控制器类上使用该方法并在那里填充视图数据吗？

就像是：

```
protected override void OnActionExecuting(ActionExecutingContext context)
{
  context.Controller.ViewData.Model = GetDataForControl();
} 
```

我没试过所以只是一个想法......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-31T21:03:05.110

对于它的价值，我在当前项目中使用该教程中的方法，并且效果很好。

如果数据有些静态（例如变化不大的菜单），您还可以做的是将对象放在缓存上，这样就不会在每次控制器初始化时调用您的数据库。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-10-20T01:25:01.830

我通常为我的 MasterPage 使用一个抽象控制器类，这是最好的解决方案，因为 MasterPage 就像一个“抽象视图”。但是我重写了 MasgerPageController View() 方法以包含视图数据。

```
protected override ViewResult View(string viewName, string masterName, object model)
{
    this.ViewData["menu"] = this.PagesRepository.GetPublishPages();
    return base.View(viewName, masterName, model);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-31T21:51:00.923

我不太明白你的问题...

> 我正在查看的问题是，如果我在依赖 ViewData 的母版页中放置一个用户控件，我必须为使用所述母版页的每个页面重复包含该 ViewData。

嗯，是的……你当然知道。如果您的母版页中有用户控件，那么您当然必须为使用该母版页的每个操作和视图传递该用户控件所需的数据。

如果您只是从基本控制器继承，则不必重复自己。

您的问题是否是某些控制器具有执行和不调用从该特定母版页派生的视图的操作？因此，因此，如果您正在实现一个基本控制器，那么不使用该特定母版页的操作仍将具有它的视图数据......？（如果这一切都说得通的话 ;-)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-02-14T16:20:25.600

我认为建议的解决方案确实有效，但不是理想的解决方案。如果我们将代码放在 BaseController 构造函数中，即使是没有 MasterPages 的 Action 方法（例如 Post 方法和 Ajax 方法）也会被调用。
我认为更好的解决方案（不理想）是在母版页中调用 Html.Action 方法。

# ftp - 远程 ftp 帐户，但使用我的正常域名

> ID：700405
> 
> 赞同：0
> 
> 时间：2009-03-31T07:27:31.030
> 
> 标签：ftp, dns

我想要一个 ftp 帐户 thisaccount@mydomain.com 不访问我的正常 mydomain.com 服务器，但从某个服务提供商访问任何其他远程服务器。

我如何在仍然将 mydomain 保留在地址中的情况下执行此操作？哪些服务提供商只会给我一个 ftp 帐户而不将我的域移动到那里？我需要调查 ftp 重定向吗？

任何方向赞赏？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-31T07:31:22.547

一种选择是从 ftp.mydomain.com 为 yourftpprovider.com 设置一个 dns CNAME。

mydomain.com 的区域文件中的示例条目：

```
ftp IN CNAME yourftpprovider.com. 
```

# c - C中没有减号的减法

> ID：700410
> 
> 赞同：13
> 
> 时间：2009-03-31T07:30:03.970
> 
> 标签：c, math, integer, integer-arithmetic

如何在没有`-`运算符的情况下减去 C 中的两个整数？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-03-31T08:00:06.300

```
int a = 34;
int b = 50; 
```

您可以使用否定和加 1 将 b 转换为负值：

```
int c = a + (~b + 1);

printf("%d\n", c);

-16 
```

这是二进制补码否定。当您想要否定值或子跟踪它时使用“-”运算符时，处理器正在执行此操作。

转换浮点数更简单。只需否定第一位（shoosh 为您提供了如何执行此操作的示例）。

编辑：

好，朋友们。我放弃。这是我的编译器独立版本：

```
#include <stdio.h>

unsigned int adder(unsigned int a, unsigned int b) {
    unsigned int loop = 1;
    unsigned int sum  = 0;
    unsigned int ai, bi, ci;

    while (loop) {
        ai = a & loop;
        bi = b & loop;
        ci = sum & loop;
        sum = sum ^ ai ^ bi;      // add i-th bit of a and b, and add carry bit stored in sum i-th bit
        loop = loop << 1;
        if ((ai&bi)|(ci&ai)|(ci&bi)) sum = sum^loop; // add carry bit
    }

    return sum;
}

unsigned int sub(unsigned int a, unsigned int b) {
    return adder(a, adder(~b, 1));    // add negation + 1 (two's complement here)
}

int main() {
    unsigned int a = 35;
    unsigned int b = 40;

    printf("%u - %u = %d\n", a, b, sub(a, b)); // printf function isn't compiler independent here

    return 0;
} 
```

我正在使用 unsigned int 以便任何编译器都将其视为相同。

如果要减去负值，请这样做：

```
 unsgined int negative15 = adder(~15, 1); 
```

现在我们完全独立于有符号值约定。在我的方法结果中，所有整数都将存储为二进制补码 - 所以你必须小心更大的整数（它们必须以 0 位开头）。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-03-31T15:26:37.023

Pontus 是对的，C 标准不强制要求 2 的补码（即使它是事实上的硬件标准）。+1 菲尔的创造性答案；这是另一种在不使用标准库或 -- 运算符的情况下获得 -1 的方法。

C 规定了三种可能的表示，因此您可以嗅探正在运行的表示并为每个表示不同的 -1：

```
negation= ~1;
if (negation+1==0)                 /* one's complement arithmetic */
    minusone= ~1;
else if (negation+2==0)            /* two's complement arithmetic */
    minusone= ~0;
else                               /* sign-and-magnitude arithmetic */
    minusone= ~0x7FFFFFFE;

r= a+b*minusone; 
```

值 0x7FFFFFFFE 取决于您感兴趣的整数类型的宽度（“值位”的数量）；如果未指定，您需要做更多的工作来找出答案！

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-03-31T09:07:58.307

*   + 无位设置
*   + 独立于语言
*   + 可以针对不同的数字类型进行调整（int、float 等）
*   - 几乎可以肯定不是你的 C 作业答案（可能是关于位）

展开 ab：

```
ab = a + (-b)
    = a + (-1).b

```

制造-1：

```
浮动：pi = asin（1.0）；
（与 minusone_flt = sin(3.0/2.0*pi);
数学.h) 或 = cos(pi)
                  或 = log10(0.1)
复杂：减号_cpx = (0,1)**2；//我平方
整数：减号整数 = 0；minusone_int--；// 或转换上面的浮点数之一

```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-03-31T08:44:07.133

*   + 无位设置*   + 独立于语言*   + 独立于数字类型（int、float 等）*   -**要求 a>b**（即阳性结果）*   - 几乎可以肯定不是你的 C 作业答案（可能是关于位）

```
a - b = c
```

将自己限制在数字空间 0 <= c < (a+b) 中：

```
       (a - b) mod(a+b) = c mod(a+b)
a mod(a+b) - b mod(a+b) = c mod(a+b)

```

简化第二项：

```
(-b).mod(a+b) = (a+bb).mod(a+b)
              = a.mod(a+b)

```

代替：

```
a.mod(a+b) + a.mod(a+b) = c.mod(a+b)
2a.mod(a+b) = c.mod(a+b)

```

如果 b>a，则 ba>0，所以：

```
c.mod(a+b) = c
c = 2a.mod(a+b)

```

因此，如果 a 总是大于 b，那么这将起作用。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-03-31T07:49:42.503

鉴于在 C 中不强制要求对整数进行编码以支持二进制补码，因此迭代直到完成。如果他们希望您跳过燃烧的箍，则无需高效！

```
int subtract(int a, int b)
{
  if ( b < 0 )
    return a+abs(b);
  while (b-- > 0)
    --a;
  return a;
} 
```

愚蠢的问题......可能是愚蠢的采访！

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-31T08:01:32.820

要在 C 中减去两个整数，您只需要：

```
int subtract(int a, int b)
{
    return a + (~b) + 1;
} 
```

我不相信浮点数或双精度数（如整数）有一个简单而优雅的解决方案。因此，您可以将浮点数转换为数组并应用与[此处模拟的算法类似的算法](http://www.ecs.umass.edu/ece/koren/arith/simulator/FPAdd/)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-31T07:59:13.730

如果要对浮点数执行此操作，请从正数开始并更改其符号位，如下所示：

```
float f = 3;
*(int*)&f |= 0x80000000;
// now f is -3.
float m = 4 + f; 
// m = 1 
```

您也可以使用适当的 64 位整数对双精度数执行此操作。例如，在 Visual Studio 中，这是 __int64。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-31T08:06:23.540

我想这

b - a = ~( a + ~b)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-31T08:31:36.787

装配（蓄能器）样式：

```
int result = a;
result -= b; 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-31T08:27:41.167

由于问题要求整数 not `int`s，您可以实现一个小的解释器，而不是使用[Church numbers](http://en.wikipedia.org/wiki/Church_encoding)。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-03T22:29:02.970

为每个可能的 int-int 情况创建一个查找表！

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2010-06-09T10:08:50.710

未测试。不使用 2 的补码：

```
#include <stdlib.h>
#include <stdio.h>
int sillyNegate(int x) {
   if (x <= 0)
     return abs(x);
   else {
     // setlocale(LC_ALL, "C"); // if necessary.
     char buffer[256];
     snprintf(buffer, 255, "%c%d", 0x2d, x);
     sscanf(buffer, "%d", &x);
     return x;
   }
} 
```

假设 an 的长度`int`远小于 255，并且 snprintf/sscanf 往返不会产生任何未指定的行为（对吗？对吗？）。

减法可以使用计算`a - b == a + (-b).`

* * *

选择：

```
#include <math.h>
int moreSillyNegate(int x) {
   return x * ilogb(0.5);  // ilogb(0.5) == -1;
} 
```

* * *

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2010-08-13T18:31:27.857

这将使用整数溢出来工作：

```
#include<limits.h>    
int subtractWithoutMinusSign(int a, int b){
         return a + (b * (INT_MAX + INT_MAX + 1));
} 
```

这也适用于浮点数（假设你制作了一个浮点数版本……）

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2017-03-06T19:22:03.840

对于任何数据类型的最大范围，反码提供减1的负值到任何对应的值。例如：
~1 --------> -2
~2--------> -3
等等...我将使用小代码片段向您展示这个观察结果

```
#include<stdio.h>
int main()
{
   int a , b;
   a=10;
   b=~a; // b-----> -11    
   printf("%d\n",a+~b+1);// equivalent to a-b
   return 0;
} 
```

输出：0
注意：这仅对数据类型的范围有效。对于 int 数据类型，此规则仅适用于范围 [-2,147,483,648 到 2,147,483,647] 的值。谢谢你.....愿这对你有帮助

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2020-05-30T08:38:03.357

[如果](https://en.wikipedia.org/wiki/If_and_only_if)：

1.  Minuend 大于或等于`0`, 或
2.  减数大于或等于`0`, 或
3.  减数和被减数小于`0`

将 Minuend 乘以`-1`并将结果添加到 Subtrahend：

```
SUB + (MIN * -1) 
```

否则将被减数乘以`1`并将结果添加到减数。

```
SUB + (MIN * 1) 
```

* * *

示例（[在线试用](https://godbolt.org/z/6ovy-8)）：

```
#include <stdio.h>

int subtract (int a, int b)
{
    if ( a >= 0 || b >= 0 || ( a < 0 && b < 0 ) )
    {
        return a + (b * -1);
    }

    return a + (b * 1); 
}

int main (void)
{
    int x = -1;
    int y = -5;
    printf("%d - %d = %d", x, y, subtract(x, y) );
} 
```

输出：

```
-1 - -5 = 4 
```

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2010-06-09T09:58:28.067

```
 int num1, num2, count = 0;
        Console.WriteLine("Enter two numebrs");
        num1 = int.Parse(Console.ReadLine());
        num2 = int.Parse(Console.ReadLine());
        if (num1 < num2)
        {
            num1 = num1 + num2;
            num2 = num1 - num2;
            num1 = num1 - num2;
        }
        for (; num2 < num1; num2++)
        {
            count++;
        }
        Console.WriteLine("The diferrence is " + count); 
```

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2010-07-06T09:54:01.627

```
void main()
{
int a=5;
int b=7;

while(b--)a--;
printf("sud=%d",a);

} 
```

# testing - 流程建模应用程序的正确性测试

> ID：700416
> 
> 赞同：1
> 
> 时间：2009-03-31T07:32:21.033
> 
> 标签：testing, correctness

我们小组正在构建一个模拟工业过程的过程建模应用程序。这个过程的最终输出是一组代表化学和流速的数字。

该应用程序基于一些非常古老的软件，这些软件使用完全相同的基础数学模型来创建模拟。模拟中涉及数以千计的变量。

尽管每个组件都经过了单元测试，但我们现在需要能够确保我们的软件产生的数据输出与旧模拟软件的输出相匹配。我想知道如何以正式和严格的方式最好地解决这个问题。

旧程序通过文本文件指定输入来工作，所以我想我们可以以编程方式获取每个变量，在文件中调整其值（以及相应地在我们的新应用程序中），然后比较新旧应用程序之间的输出。我们对模型中的每个变量都这样做。

我们知道每个变量的允许范围，所以我认为每个变量的几个值的随机样本足以显示该特定变量的正确性。

对这种方法有什么想法吗？还有其他想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-31T12:53:09.920

新旧应用程序的输出比较绝对是个好主意。这有时称为背靠背测试。

关于测试输入样本 - 熟悉以下概念：

*   [等价划分](http://en.wikipedia.org/wiki/Equivalence_partitioning)
*   [边值分析](http://en.wikipedia.org/wiki/Boundary-value_analysis)

# visual-studio - 数据库部署 (vsdbcmd.exe)：DatabaseName 和 DefaultDataPath 被忽略？

> ID：700420
> 
> 赞同：12
> 
> 时间：2009-03-31T07:33:59.797
> 
> 标签：visual-studio, visual-studio-2008, database-project

Visual Studio 数据库版本附带一个工具 vsdbcmd.exe，它应该允许某人将 .dbschema 文件（由构建时的数据库项目生成）部署到数据库。它首先构建脚本，然后执行它：

> vsdbcmd.exe /a:Deploy /cs:"Data Source=(local);Integrated Security=True;Pooling=False" /dsp:Sql /dd /model:"..\Database.dbschema" /p:TargetDatabase=TargetDB /清单：“..\Database.deploymanifest”

我希望它可以毫无问题地将脚本部署到不同的数据库服务器。但是，实际 .mdf 文件的完整路径已编码在脚本中，以及对原始数据库的其他一些引用。要么没有控制它的选项，要么我找不到它。

有人用这个吗？你如何部署？我是否应该使用不同类型的数据库项目（我记得在“数据库项目”和“服务器项目”之间有选择，但我不知道这是否重要）？

**编辑**

我可以很好地覆盖 .sqlcmdvars，但这并不能解决问题。这是使用上述命令从生成的 .sql 文件中提取的内容：

```
GO
:setvar DatabaseName "TargetDB"
:setvar DefaultDataPath "C:\Program Files\Microsoft SQL Server\MSSQL10.MSSQLSERVER\MSSQL\DATA\" 
```

所以有“targetdb”目标数据库被正确记录。但是，还有几行：

```
CREATE DATABASE [$(DatabaseName)]
ON 
PRIMARY(NAME = [Original], FILENAME = 'C:\Program Files\Microsoft SQL Server\MSSQL10.MSSQLSERVER\MSSQL\DATA\Original.mdf', SIZE = 3072 KB, MAXSIZE = UNLIMITED, FILEGROWTH = 1024 KB)
LOG ON (NAME = [Original_log], FILENAME = 'C:\Program Files\Microsoft SQL Server\MSSQL10.MSSQLSERVER\MSSQL\DATA\Original_log.ldf', SIZE = 1024 KB, MAXSIZE = 2097152 MB, FILEGROWTH = 10 %) 
```

其中 Original.mdf 是原始数据库的名称（即我们在开发过程中部署的数据库，在数据库项目的项目属性中设置）。这是部署失败的地方，要么是因为目标机器上的确切路径可能不同，要么在我的机器上，因为该数据库已经存在。

这些值似乎只是硬编码在生成的脚本中。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2010-12-30T23:52:04.383

这可能是（是）在执行*Database Schema Synchronization -> Database Project*时引起的。（我的环境是VS2010 Enterprise RTM）。

生成的 ALTER DATABASE 语句用于镜像*源*数据库而不考虑任何替换值（它还将包括初始数据库大小等）。该问题不会出现在初始数据库导入中。

编辑在...下找到的文件

**架构对象\数据库级对象\存储\文件**

...并修复它们以包含正确的`$(DefaultDataPath)$(DatabaseName).mdf`/`$(DefaultLogPath)$(DatabaseName)_log.ldf`值 - 或其他 - 视情况而定。（现在在您的架构比较中将它们标记为“跳过”:-P）

通过上述“更正”，保持外部值将再次起作用，并且是管理此类属性的首选方法。

快乐编码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-28T04:23:30.927

根据您的编辑，也许这会有所帮助。 [https://blogs.msdn.com/gertd/Default.aspx?p=7](https://blogs.msdn.com/gertd/Default.aspx?p=7)

添加变量

到目前为止，我们一直在研究事情是如何工作的，现在是时候添加一些新变量并让它们发挥作用了。变量派上用场的一个地方是在定义文件的部署后文件中：storage.sql。变量将允许使用使位置环境依赖。

在存储文件中，您会发现如下内容：

IF NOT EXISTS(SELECT 1 FROM dbo.sysfiles WHERE name = 'fgdb_data') BEGIN ALTER DATABASE [$(databasename)] ADD FILE ( NAME = N'fgdb_data', FILENAME = N'C:\Program Files\Microsoft SQL Server\ MSSQL.1\MSSQL\DATA\fgdb_data.ndf', MAXSIZE = 100MB, FILEGROWTH = 10MB ) TO FILEGROUP [TABLES] END

我们可以对其进行参数化，以便通过变量将驱动器和目录抽象为：

:setvar 驱动器 "C:" :setvar 目录 "Program Files\Microsoft SQL Server\MSSQL.1\MSSQL\DATA"

如果不存在（从 dbo.sysfiles 中选择 1，其中名称 = 'fgdb_data'）开始更改数据库 [$（数据库名称）] 添加文件（名称 = N'fgdb_data'， **文件名 = N'$（驱动器）\$（目录）\ fgdb_data.ndf',** MAXSIZE = 100MB, FILEGROWTH = 10MB ) TO FILEGROUP [TABLES] END

现在我们已经参数化了脚本，接下来我们想让变量成为项目文件的一部分，所以我们将它们定义在一个地方，而不是通过 :setvar 语句分散在代码中的各个地方。

抱歉，我自己刚开始学习 GDR，但我需要这个问题的答案

# php - wordpress 数据库中的事务

> ID：700423
> 
> 赞同：8
> 
> 时间：2009-03-31T07:35:03.087
> 
> 标签：php, mysql, wordpress

[Wordpress](http://wordpress.org/)使用的是[MyISAM](http://en.wikipedia.org/wiki/MyISAM)存储引擎。MyISAM 不支持事务。

wordpress 如何维护交易？

我的意思是如果 wordpress 有两个数据库写入操作，它如何确保原子性？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-31T07:41:47.767

好吧，据我所知，它没有！没有太多问题的唯一原因是，大多数写入操作都是通过单个插入或更新完成的（添加评论，创建新帖子......）。

总的来说，到目前为止我见过的大多数 Web 应用程序都不太关心事务、原子性甚至引用完整性，这很可悲。一方面，令人遗憾的是，如此多的应用程序只是依靠纯粹的运气而没有发生任何不好的事情，另一方面，这可能会让人觉得所有这些技术在涉及数据库时并不那么重要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-31T07:39:19.440

我认为事务将确保上一层抽象的原子正确性。当事务发生时，它默认锁定正在写入的内容。不过我不确定。

# c# - 在 textbox_keydown 事件中模拟键盘快捷键来处理？

> ID：700424
> 
> 赞同：0
> 
> 时间：2009-03-31T07:35:55.143
> 
> 标签：c#

我正在尝试使用文本框中的 keydown 事件将键盘快捷键（例如（Ctrl + A，Ctrl + Shift + X））模拟到文本框中，但我有点进退两难。我正在使用列表框来记录在模拟键盘快捷键时引发的事件，但它会运行该事件两次。我问我如何让它只登录到列表框，如果它只有一个修饰键（ctrl，alt，shift，winkey）+一个字母数字键（az 0-9）？

```
 private void txtShortcut_KeyDown(object sender, KeyEventArgs e)
    {
        // Example key press: Ctrl + A
        if (e.Shift || e.Control || e.Alt)
        {
            string s = (e.Shift ? Keys.ShiftKey.ToString() + " + " : "") + // Shift
                (e.Control ? Keys.ControlKey.ToString() + " + " : "") +  // Control
                    (e.Alt ? Keys.Menu.ToString() + " + " : "") +  // Alt (menu)
                        e.KeyCode; // Key.

            lbLogger.Items.Add(s);
            // Logger Results:
            // 1) ControlKey + ControlKey
            // 2) ControlKey + A
            // * I'm trying to get it to only post the second line and only log the line
            // when a modifier key + a-z 0-9 key is pressed with it.
        }
    } 
```

如果按下修饰键 + az 或 0-9 键，则进行此仅记录过程的最有效方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-31T07:51:44.793

```
private void txtShortcut_KeyDown(object sender, KeyEventArgs e)
    {
                // Example key press: Ctrl + A
        if ((e.Shift || e.Control || e.Alt) && 
            (((e.KeyCode >= Keys.a) && (e.KeyCode <= Keys.z)) ||
            ((e.KeyCode >= Keys.A) && (e.KeyCode <= Keys.Z)) ||
            ((e.KeyCode >= Keys.NumPad0) && (e.KeyCode <= Keys.NumPad9)) ||
            ((e.KeyCode >= Keys.D0) && (e.KeyCode <= Keys.D9))))
        {
            string s = (e.Shift ? Keys.ShiftKey.ToString() + " + " : "") + // Shift
                                (e.Control ? Keys.ControlKey.ToString() + " + " : "") +  // Control
                                        (e.Alt ? Keys.Menu.ToString() + " + " : "") +  // Alt (menu)
                                                e.KeyCode; // Key.

            lbLogger.Items.Add(s);
                        // Logger Results:
                        // 1) ControlKey + ControlKey
                        // 2) ControlKey + A
            // * I'm trying to get it to only post the second line and only log the line
            // when a modifier key + a-z 0-9 key is pressed with it.
        }
    } 
```

# c++ - 如何从 C++ 获取 linux 2.6 中的 SPID

> ID：700426
> 
> 赞同：2
> 
> 时间：2009-03-31T07:36:51.553
> 
> 标签：c++, linux, multithreading, pthreads

我有一个问题： linux 2.6 中的 SPID 是否可以从 C++ 应用程序中获取？当我执行“ps -amT”时，我可以看到进程中的线程：

```
root@10.67.100.2:~# ps -amT
  PID  SPID TTY          TIME CMD
 1120     - pts/1    00:00:20 sncmdd
    -  1120 -        00:00:00 -
    -  1125 -        00:00:00 -
    -  1126 -        00:00:00 -
    -  1128 -        00:00:00 -
    -  1129 -        00:00:09 -
    -  1130 -        00:00:00 -
    -  1131 -        00:00:09 -
 1122     - pts/1    00:00:00 snstatusdemuxd
    -  1122 -        00:00:00 -
    -  1127 -        00:00:00 -
    -  1132 -        00:00:00 -
    -  1133 -        00:00:00 - 
```

然后在文件系统中我可以看到线程：

```
root@10.67.100.2:~# ls /proc/1120/task/
1120  1125  1126  1128  1129  1130  1131 
```

那么有什么方法可以从我的应用程序中获取 SPID，以便我可以以某种方式识别每个正在运行的线程中的 SPID 是什么？

谢谢！

/麦克风

编辑：我应该补充一点，从 getpid() 返回的 PID 在每个线程中都是相同的。

当我将此代码添加到我的线程时：

```
// Log thread information to syslog
syslog(LOG_NOTICE, "ibnhwsuperv: gettid()= %ld,  pthread_self()=%ld", (long int)syscall(224), pthread_self()); 
```

我得到这个结果：

```
Jan  1 01:24:13 10 ibnhwsupervd[1303]: ibnhwsuperv: gettid()= -1,  pthread_self()=839027488 
```

两者都不像 ps 或 proc 文件系统中给出的 SPID。

另外，请注意[gettid 不返回 SPID](http://ubuntuforums.org/showthread.php?t=345317)。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-31T07:51:37.647

[gettid()](http://linux.die.net/man/2/gettid)怎么样？

编辑：如果你的 libc 没有 gettid() 函数，你应该像这样运行它：

```
#include <sys/syscall.h>
syscall(SYS_gettid); 
```

...或查看[本手册页上的示例](http://manpages.courier-mta.org/htmlman2/syscall.2.html)。

# html - 多色文本框的想法？

> ID：700433
> 
> 赞同：3
> 
> 时间：2009-03-31T07:39:59.797
> 
> 标签：html

在我的网站中，我想实现一个文本框，人们可以在其中输入一组由分隔符分隔的字符串。
例如，此页面底部的标签文本框：标签（字符串）由空格（分隔符）分隔。
为了让用户更清楚，给每个字符串一个不同的背景颜色或其他视觉提示会很有意义。
我认为使用常规 input[text] 控件是不可能的。

你认为可以用 javascript 创建类似的东西吗？有人在我之前做过吗？你有什么其他的建议？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-31T08:23:55.637

**基本步骤**

1.  将一个文本框放在一个 div 中并设置它的样式也隐藏它。
2.  使 div 看起来像一个文本框。
3.  在 div 的 onClick 处理程序中，将输入焦点设置为隐藏的文本框。
4.  处理隐藏文本框的 onKeyUp 事件以捕获文本，根据需要格式化并更改 div 的 innerHtml。

这很简单。我会让你编写格式化程序，但基本上你只需按照半工作示例在分隔符上拆分字符串。

**简单大纲**

```
<html>
    <head>
    <script language="javascript" type="text/javascript">
    function focusHiddenInput()
    {
        var txt = document.getElementById("txtHidden");
        txt.focus();
    }

    function formatInputAndDumpToDiv()
    {
        alert('Up to you how to format');
    }
    </script>
    </head>

    <body>
    <div onclick="focusHiddenInput();">
    Some label here followed by a divved textbox:
    <input id="txtHidden" style="width:0px;" onKeyPress="formatInputAndDumpToDiv()" type="text">
    </div>
    </body>
    </html> 
```

**半工作示例**

您仍然需要扩展点击处理程序以通过键盘解决标签删除/编辑/退格/等问题......或者您可以只使用点击事件来弹出另一个上下文菜单 div。但是使用下面代码中标识的标签和间隔 ID 应该很容易：

```
<html>
    <head>
    <script language="javascript" type="text/javascript">

    var myTags=null;

    function init()
    {
        document.getElementById("txtHidden").onkeyup= runFormatter;
    }

    function focusHiddenInput()
    {
        document.getElementById("txtHidden").focus();
    }

    function runFormatter()
    {
        var txt = document.getElementById("txtHidden");
        var txtdiv = document.getElementById("txtBoxDiv");
        txtdiv.innerHTML = "";
        formatText(txt.value, txtdiv);
    }

    function formatText(tagText, divTextBox)
    {
        var tagString="";
        var newTag;
        var newSpace;
        myTags = tagText.split(' ');
        for(i=0;i<myTags.length;i++) {
            newTag = document.createElement("span");
            newTag.setAttribute("id", "tagId_" + i);
            newTag.setAttribute("title", myTags[i]);
            newTag.setAttribute("innerText", myTags[i]);

            if ((i % 2)==0) {
           newTag.style.backgroundColor='#eee999';  
        }
        else
        {
           newTag.style.backgroundColor='#ccceee'; 
        }
            divTextBox.appendChild(newTag);
            newTag.onclick = function(){tagClickedHandler(this);}

            newSpace = document.createElement("span");
            newSpace.setAttribute("id", "spId_" + i);
            newSpace.setAttribute("innerText", " ");
            divTextBox.appendChild(newSpace);

            newSpace.onclick = function(){spaceClickedHandler(this);}
       }
    }

    function tagClickedHandler(tag)
    {
      alert('You clicked a tag:' + tag.title);  
    }   

    function spaceClickedHandler(spacer)
    {
      alert('You clicked a spacer');    
    }   

    window.onload=init;
    </script>
    </head>

    <body>
    <div id="txtBoxDivContainer">
    Enter tags below (Click and Type):<div id="txtBoxDiv" style="border: solid 1px #cccccc; height:20px;width:400px;" onclick="focusHiddenInput();"></div>
    <input id="txtHidden" style="width:0px;" type="text">
    </div>
    </body>
    </html> 
```

**光标**

您可以使用闪烁（检查支持）对光标进行 CSS 处理，或者根据需要前进和隐藏动画 gif。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-31T07:57:02.410

这很有趣。您的问题的简短回答是否定的。不带基本输入元素。

真正的答案是：也许有一些 javascript 的诡计。

显然 Facebook 做了一些与此类似的事情。当您在 Facebook 中向多个人写新消息时，您可以通过这种方式输入他们的姓名。每个已识别的新名称都在此处添加，有点像标签，旁边有一个小十字用于删除它。

他们似乎在做的是通过绘制一个看起来像输入的框并使用 css 从实际输入中删除所有样式来伪造输入区域大小。然后他们用 javascript 完成了大量的逻辑，所以如果你添加了一个朋友作为标签并开始退格，它会立即删除整个朋友的名字。等等

所以，是的，这是可行的，但需要付出大量努力并增加可访问性问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-31T07:47:01.340

您可以在 TinyMCE 之类的脚本中查看他们是如何做到这一点的，它将此类功能添加到 textareas。在 textareas 中，您可以使用 HTML 为文本着色。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-03-31T07:49:38.713

您可以使用多个文本框

```
textbox1 <space> textbox2 <space> textbox3 .... 
```

等等...然后您可以将背景颜色样式应用于每个文本框。

# windows-installer - Where has my user installed my web setup project?

> ID：700436
> 
> 赞同：2
> 
> 时间：2009-03-31T07:42:21.103
> 
> 标签：windows-installer, virtual-directory, web-setup-project

I have a web setup project, and a web service project in visual studio 08

In my web setup project i allow the user to choose his virtual directory name and by the end of the installation i have an installer class in my web service project that "wants" to do some stuff such as opening a web page with the web service home page installed.

The thing is that i know how to pass parameters from the web setup project such as TARGETDIR in my installer class but i can't figure out the URL of what he installed. IE if he installed a virtual directory named foo i can assume that he it is located at [http://localhost/foo](http://localhost/foo) but what if i miss some configuration of the IIS and maybe the website is located under [http://localhost/whatever/foo](http://localhost/whatever/foo) ?

So, to keep it relatively short, by the end of the installation i need to know in my installer class my web service's URL.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-02-13T13:37:38.543

The installer variable for the Virtual Directory is `TARGETVDIR`.

# asp.net - 为我的 ASP.NET Http 处理程序指定确切路径

> ID：700443
> 
> 赞同：4
> 
> 时间：2009-03-31T07:44:11.910
> 
> 标签：asp.net, web-config, httphandler

我使用 Http 处理程序即时生成 XML/Google 站点地图，因此我不需要手动维护 XML 文件。

我已将我的 Http 处理程序映射到我的 web.config 中的“sitemap.xml”，如下所示：

```
<httpHandlers>
  <add verb="*" path="sitemap.xml" type="My.Name.Space, MyAssembly" />
</httpHandlers> 
```

它工作得很好。现在，www.mywebsite.com/sitemap.xml 设置我的 Http 处理程序并执行我想要的操作。但是，这个 url 会做同样的事情：www.mywebsite.com/some/folder/sitemap.xml 我真的不想要那个，即我只想将我的处理程序映射到我的应用程序的根目录。

我尝试将我的 web.config 中的处理程序的“路径”更改为“/sitemap.xml”和“~/sitemap.xml”，但都不起作用。

我在这里错过了什么吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-31T12:56:26.463

尝试将以下内容添加到您的 web.config

```
<urlMappings enabled="true">
    <add url="~/SiteMap.xml" mappedUrl="~/MyHandler.ashx"/>
</urlMappings> 
```

这使用了 ASP.NET 2.0 的一个鲜为人知的功能，称为[“Url Mapping”](http://www.developer.com/net/asp/article.php/3581326)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-01T08:49:23.093

继 Kirtan 建议的解决方案 #1 之后，您可以采取如下解决方法：

```
public void ProcessRequest(HttpContext context) {
  //Ensure that the sitemap.xml request is to the root of the application
  if (!context.Request.PhysicalPath.Equals(Server.MapPath("~/sitemap.xml"))) {
     //Invoke the Default Handler for this Request
     context.RemapHandler(null);
  }

  //Generate the Sitemap
} 
```

您可能需要稍微尝试一下，不确定调用默认处理程序是否只会导致 IIS 再次重新调用您的处理程序。可能值得在 VS 的调试模式下进行测试。如果它只是重​​新调用，那么您需要尝试调用一些静态文件处理程序，或者您可以自己发出 HTTP 404，例如

```
//Issue a HTTP 404
context.Response.Clear();
context.Response.StatusCode = (int)System.Net.HttpStatusCode.NotFound;
return; 
```

有关详细信息，请参阅有关 HttpContext.RemapHandler 的 MSDN 文档 - [http://msdn.microsoft.com/en-us/library/system.web.httpcontext.remaphandler.aspx](http://msdn.microsoft.com/en-us/library/system.web.httpcontext.remaphandler.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-31T07:58:15.900

2个解决方案：

Soln #1：您可以使用 Request.Url 属性检查请求路径，如果请求来自根路径，则可以生成 XML，否则不执行任何操作。

Soln #2：将具有以下设置的 web.config 文件放在您不想处理 sitemap.xml 文件请求的每个文件夹中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-01-04T13:36:29.477

或者，您可以在 global.asax 中运行检查，验证请求，最后通过 toout context.RemapHandler 方法重新分配新的处理程序。
唯一的问题是你必须为此建立一个工厂。

我建议你继承 HttpApplication，并在那里实现工厂，但那是你的电话。

# amazon-ec2 - ec2腻子连接问题

> ID：700455
> 
> 赞同：3
> 
> 时间：2009-03-31T07:48:07.530
> 
> 标签：amazon-ec2, putty

我已按照亚马逊的指示进行了这封信，但它不起作用。

ec2-api-tools-1.3-34128 - 这是我从亚马逊获得的 api 工具 按照说明进行设置。检查一切以确保我遵循指示。当我尝试使用它时，我只会得到：“invalid.blabla”，具体取决于我尝试使用的命令。有这个问题的人吗？

我删除了所有实例和所有密钥对。创建了新的（实例和密钥对）。像说明说的那样重新设置腻子（创建 .ppk 文件和所有内容）。问题仍然存在。当我尝试使用 putty 连接到我的 ec2 实例时，我得到“登录为：” ????????

另外，我正在使用Windows Vista。这是不是一个问题。

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2010-12-19T07:41:12.290

有同样的问题。我发现在腻子中我必须做三件事（在[http://docs.amazonwebservices.com/AmazonEC2/gsg/2007-01-19/putty.html](http://docs.amazonwebservices.com/AmazonEC2/gsg/2007-01-19/putty.html)的亚马逊指南中只提到了其中两件事）

1.  在 ssh -> Auth 部分提供转换后的私钥
2.  提供 dns 名称或 IP
3.  转到 Connection -> Data 并输入“ec2-user”作为自动登录用户名

希望这可以为其他人节省 20 分钟！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-16T15:15:54.850

您是否确保将“root”作为“数据”部分中的自动登录帐户？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-12-18T12:17:12.440

我犯的一个错误比给我相同的错误消息是设置“ **root** @ec2-.eu-west-1.compute.amazonaws.com”作为腻子中“主机名（或IP地址）”字段中的值。

您需要指定“ **ubuntu** @ec2-.eu-west-1.compute.amazonaws.com”。

# php - 在 PHP5 面向对象中获取大量数据的正确方法

> ID：700461
> 
> 赞同：3
> 
> 时间：2009-03-31T07:51:26.183
> 
> 标签：php, sql, oop

幸运的是，我知道如何从数据库中获取数据，这不是问题。对于我的面向对象应用程序，我将有一个包含用户/人员的表。我也有一`person`堂课。

**案例：** 我想向最终用户显示所有人员的列表。显示这样做的正确方法是什么？

1.  在这种情况下使用`mysql_fetch_object()`php 将创建它自己的对象类型，而不是我自己的对象类型`person`
2.  从数据库中获取所有行，然后为每个行创建一个对象？

还是有其他更好的方法来做到这一点？

您还可以显示一些（伪）代码吗？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-31T07:58:16.227

该[`mysql_fetch_object()`](http://www.php.net/mysql_fetch_object)函数接受第二个参数，即要使用的类名：

```
$myPerson = mysql_fetch_object($result, 'person'); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-31T07:56:08.230

*   选项 1：使用 ORM（Propeler，Doctrine）
*   选项 2：创建类 People ("Persons")，它将使用 加载它的数据`mysql_fetch_*`，然后创建 Person 对象数组。让它`IteratorAggregate`执行`getIterator`返回`ArrayIterator(personArray)`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-31T15:10:51.103

如果您使用[PDO](http://php.net/pdo)，则[`$pdoStatement->fetchObject($type)`](http://www.php.net/manual/en/pdostatement.fetchobject.php)获取单行作为`$type`Class的实例

要获取所有对象作为`$type`Class 的实例，请使用 [`$pdoStatement->fetchAll(PDO::FETCH_CLASS, $type)`](http://www.php.net/manual/en/pdostatement.fetchall.php)

# asp.net - 为什么从 iis 调用 XMLRPC 时 fiddler 不捕获请求？

> ID：700463
> 
> 赞同：3
> 
> 时间：2009-03-31T07:51:39.957
> 
> 标签：asp.net, iis, iis-7, fiddler

我有一个用 .NET 编写的 web 应用程序，它利用 CookComputing.XmlRpcV2 进行 xmlrpc 通信。

当我在 Visual Studio 2008 中调用我的单元测试时，fiddler2 成功捕获了实际的 xmlrpc 请求，但是当我在 IIS7 下运行实际的应用程序时，它什么也没显示。我已经验证它实际上调用了我的防火墙中的 xmlrpc-requests，但我需要查看请求的内容以进行调试。

我已经发布了一个运行提琴手的 iisreset，试图查看 IIS 在应用程序启动时是否真的从 WinINET 获取代理设置，但它没有帮助。

IIS 每个应用程序都有自己的代理设置吗？或者，如果它是 ASP.NET 的一部分……我似乎找不到任何关于它的信息。

我当然可以在 WebRequest 中以某种方式在代码中定义我自己的代理服务器，但是由于我只想将代理用于调试目的，我宁愿找到一个更简单的解决方案。

这是 Vista，运行带有 .NET 3.5 SP1 的 iis7。Fiddler2 版本 2.1.9.2

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-31T07:55:55.000

默认代理设置是每个用户。IIS 在什么身份下运行？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-06-04T19:21:20.973

查看[在 C# 中为所有用户设置注册表](https://stackoverflow.com/questions/2088221/setting-registry-key-for-all-users-in-c)项的答案。它指的是[http://www.pctools.com/guides/registry/detail/1147/](http://www.pctools.com/guides/registry/detail/1147/)，它建议创建一个 ProxySettingsPerUser 注册表设置并使用 0 DWORD 值。

# vba - 格式化函数vba更改日期

> ID：700472
> 
> 赞同：0
> 
> 时间：2009-03-31T07:55:42.083
> 
> 标签：vba, excel

vba 中的格式功能正在更改日期。例如对于格式（“3/12/2009”，“DD/MM/YYYY”），该函数返回 12/03/2009，其中“3/12/2009”是 excel vba 从值为 12 的单元格中读取的内容-Mar-2009，格式为“dd-mmm-yyyy”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-31T08:47:46.360

不，这不对。

如果将日期字符串传递给 Format 函数，它将使用当前区域设置对其进行解析。您的设置显然是 MM/DD/YYYY，这是美国的默认设置。如果手动设置，没有什么可以阻止 Excel 将日期显示为 DD/MM/YYYY，但默认情况下它将显示 MM/DD/YYYY。

要做的事情：停止将日期读取为字符串。将它们读作日期。

```
dim d as date
d = activecell.value 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-01-18T15:15:17.293

在 Access 中的 VBA 将大多数日期读取为欧洲日期但有些日期为美国时，我自己有几次问题：

这不能正常工作：

```
myRs.FindFirst ("Date =#" & myDate & "#") 
```

这有效：

```
myRs.FindFirst ("Date =#" & Format(myDate, "Long Date") & "#") 
```

长日期（例如 2012 年 1 月 1 日）明显区分了月份和日期

# .net - 开发具有集成硬件的专用计算机

> ID：700475
> 
> 赞同：4
> 
> 时间：2009-03-31T07:56:15.857
> 
> 标签：.net, usb, hid, integrated

我们正在考虑为集成计算机实施读卡器程序。该计算机是一个带有嵌入式计算机的触摸屏，运行 Windows XP，以及集成在屏幕中的读卡器。

阅读器是一个 USB 设备，但不幸的是，它与这个屏幕/计算机集成得如此紧密，以至于我无法将其分离并连接到其他设备。

启动时，SDK 很痛苦，因为它不存在。SDK 包含一个 VB（不是 .NET）应用程序，它通过 HID 子系统通过一些 windows api 函数与 USB 设备通信，由于我们需要它成为 .NET 应用程序的一部分，我们需要使用 P 重新实现它/调用。

因此，测试这将是一件痛苦的事情，因为我可能不得不不断地将新文件复制到机器上，并且有大量的日志记录来找出问题所在。

还是我？我还可以做些什么？在那台机器上运行 Visual Studio 将比仅仅复制程序和使用日志记录更痛苦，所以这不是一个选项，但还有什么？我可以从我自己的机器上远程调试吗？该机器具有网络功能，因此我可以通过网络很好地访问它。

任何人都可以提供任何提示或建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-31T08:13:03.977

[Visual Studio](http://msdn.microsoft.com/en-us/library/y7f5zaaa.aspx)和[命令行调试器](http://msdn.microsoft.com/en-us/library/cc266458.aspx)都支持远程调试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-31T08:23:41.940

看看[USB Over Network](http://www.fabulatech.com/usb-over-network.html)或类似的程序。您可以使远程 USB 端口在您的开发机器上显示为虚拟端口并在本地进行调试。

# java - 在 spring-security 中将基于命名空间的配置与不同的身份验证方法相结合

> ID：700476
> 
> 赞同：2
> 
> 时间：2009-03-31T07:57:02.003
> 
> 标签：java, spring, jakarta-ee, spring-security

我正在尝试让 spring-security 与一个项目一起工作，该项目既需要表单登录组件（用于网站访问），又需要用于 Web 服务的 http-basic 或 http-digest 组件。现在我们从基于命名空间的配置开始，例如一个 spring-security.xml 文件，其中包含以下内容：

```
<http auto-config="true">
    <intercept-url...>
    ...
</http> 
```

但是你必须默认使用基于表单或默认使用http-basic（即这只配置一个过滤器链）。我想要的是某些东西永远不会重定向到表单，而只是使用 http-basic 或等效的。该手册似乎确实[涵盖了这一点](http://static.springframework.org/spring-security/site/reference/html/supporting-infrastructure.html#filters)，只有当您遵循他们的建议时，您最终必须为所有内容定义自己的过滤器链。

所以我想知道，真的没有别的办法了吗？有没有一种方法可以将 http 元素引入的过滤器链重用于那些仍然可以使用旧方案的元素？基于命名空间的配置对我们来说非常方便，因为它易于阅读和理解，而 bean 定义列表则不那么......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-09T09:39:42.350

我会自己回答这个问题，因为似乎没有人会回答。似乎这个答案是“不”，我现在使用几乎完全基于 bean 的配置。当然，总是欢迎与我相矛盾的答案。:-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-01-01T22:21:25.050

这是在 Spring Security 路线图上。请参阅[问题 SEC-1171](https://jira.springsource.org/browse/SEC-1171)。

# c# - 如何给 RichTextBox 一个扁平的外观？

> ID：700479
> 
> 赞同：20
> 
> 时间：2009-03-31T07:57:30.787
> 
> 标签：c#, winforms, richtextbox, themes, uxtheme

我正在开发一个 WinForms SmartClient 应用程序，该应用程序使用了很多 RichTextBox 控件——出于各种原因，其中一些控件代替了常规的 TextBox。不幸的是，RichTextBox 绘制了丑陋的 Win95 3D 边框，而不是主题 XP 或 Vista 风格的边框。

有谁知道将主题边框应用于 RichTextBox 的方法？我不介意为此目的对它们进行子类化。

谢谢！

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-09-23T19:27:03.850

这确实是一种 hack，但您可以做的一件事是将 Panel 控件放到页面上。给它一个 FixedSingle 的 BorderStyle（默认为 None。）

将 RichTextBox 拖放到面板中并将 BorderStyle 设置为无。然后将 RichTextBox 的 Dock 属性设置为 Fill。

这将为您提供一个带有扁平边框的 RichTextBox。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-31T08:03:16.763

过去，我不得不使用一个面板来解决这个问题，其中文本框是内部的一个组件，并且 DockPadding 设置为 3 或 4 像素。然后我将该面板设置为单个像素。

我一直觉得这真的很烦人！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-02-03T23:15:26.470

这是 VB.NET 代码，它用 -1 膨胀非客户区，然后用 caded 蓝色填充非客户区。可以使用 SharpDevelop 4.4 将其转换为 C#。我从这篇文章中得到了代码：

[http://www.codeproject.com/Articles/13723/Themed-RichTextBox-A-RichTextBox-with-XP-styled-bo](http://www.codeproject.com/Articles/13723/Themed-RichTextBox-A-RichTextBox-with-XP-styled-bo)

```
Imports System.Runtime.InteropServices
Imports System.Windows.Forms
Imports System.Windows.Forms.VisualStyles
Imports System.Drawing
Imports System.Diagnostics

Public Class FlatRichTextBox
    Inherits RichTextBox

    Private BorderRect As RECT

    Sub New()
        If VisualStyleInformation.IsEnabledByUser Then
            BorderStyle = BorderStyle.None
        End If
    End Sub

    Protected Overrides Sub WndProc(ByRef m As Message)
        Const WM_NCPAINT = &H85
        Const WM_NCCALCSIZE = &H83
        Const WM_THEMECHANGED = &H31A

        Select Case m.Msg
            Case WM_NCPAINT
                WmNcpaint(m)
            Case WM_NCCALCSIZE
                WmNccalcsize(m)
            Case WM_THEMECHANGED
                UpdateStyles()
            Case Else
                MyBase.WndProc(m)
        End Select
    End Sub

    Private Sub WmNccalcsize(ByRef m As Message)
        MyBase.WndProc(m)

        If Not VisualStyleInformation.IsEnabledByUser Then Return

        Dim par As New NCCALCSIZE_PARAMS()
        Dim windowRect As RECT

        If m.WParam <> IntPtr.Zero Then
            par = CType(Marshal.PtrToStructure(m.LParam, GetType(NCCALCSIZE_PARAMS)), NCCALCSIZE_PARAMS)
            windowRect = par.rgrc0
        End If

        Dim clientRect = windowRect

        clientRect.Left += 1
        clientRect.Top += 1
        clientRect.Right -= 1
        clientRect.Bottom -= 1

        BorderRect = New RECT(clientRect.Left - windowRect.Left,
                              clientRect.Top - windowRect.Top,
                              windowRect.Right - clientRect.Right,
                              windowRect.Bottom - clientRect.Bottom)

        If m.WParam = IntPtr.Zero Then
            Marshal.StructureToPtr(clientRect, m.LParam, False)
        Else
            par.rgrc0 = clientRect
            Marshal.StructureToPtr(par, m.LParam, False)
        End If

        Const WVR_HREDRAW = &H100
        Const WVR_VREDRAW = &H200
        Const WVR_REDRAW = (WVR_HREDRAW Or WVR_VREDRAW)

        m.Result = New IntPtr(WVR_REDRAW)
    End Sub

    Private Sub WmNcpaint(ByRef m As Message)
        MyBase.WndProc(m)

        If Not VisualStyleInformation.IsEnabledByUser Then Return

        Dim r As RECT
        GetWindowRect(Handle, r)

        r.Right -= r.Left
        r.Bottom -= r.Top
        r.Top = 0
        r.Left = 0

        r.Left += BorderRect.Left
        r.Top += BorderRect.Top
        r.Right -= BorderRect.Right
        r.Bottom -= BorderRect.Bottom

        Dim hDC = GetWindowDC(Handle)
        ExcludeClipRect(hDC, r.Left, r.Top, r.Right, r.Bottom)

        Using g = Graphics.FromHdc(hDC)
            g.Clear(Color.CadetBlue)
        End Using

        ReleaseDC(Handle, hDC)
        m.Result = IntPtr.Zero
    End Sub

    <DllImport("user32.dll")>
    Public Shared Function GetWindowRect(hWnd As IntPtr, ByRef lpRect As RECT) As Boolean
    End Function

    <DllImport("user32.dll")>
    Public Shared Function GetWindowDC(hWnd As IntPtr) As IntPtr
    End Function

    <DllImport("user32.dll")>
    Public Shared Function ReleaseDC(hWnd As IntPtr, hDC As IntPtr) As Integer
    End Function

    <DllImport("gdi32.dll")>
    Public Shared Function ExcludeClipRect(hdc As IntPtr, nLeftRect As Integer, nTopRect As Integer, nRightRect As Integer, nBottomRect As Integer) As Integer
    End Function

    <StructLayout(LayoutKind.Sequential)>
    Public Structure NCCALCSIZE_PARAMS
        Public rgrc0, rgrc1, rgrc2 As RECT
        Public lppos As IntPtr
    End Structure

    <StructLayout(LayoutKind.Sequential)>
    Public Structure RECT
        Public Left As Integer
        Public Top As Integer
        Public Right As Integer
        Public Bottom As Integer

        Public Sub New(left As Integer, top As Integer, right As Integer, bottom As Integer)
            Me.Left = left
            Me.Top = top
            Me.Right = right
            Me.Bottom = bottom
        End Sub
    End Structure
End Class 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-30T18:09:50.853

我想这有点太晚了，但尽管如此。

您始终可以使用 P/Invoke 并使用 UXTheme API 子类化您的 RichEdit，这样您就可以根据需要禁用/启用它。

我认为 CodeProject 有一个使用 UXTheme/Visual Styles API 的 Richedit 控件

[随着 Windows 8 的推出，视觉样式 UXTheme API 可能会过时或弃用](http://msdn.microsoft.com/en-us/library/windows/desktop/bb773178%28v=vs.85%29.aspx)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2016-03-31T12:24:19.857

摆脱 3D 边框的最简单方法是设置另一个：

```
richTextBox.BorderStyle = BorderStyle.FixedSingle; 
```

-BorderStyle`FixedSingle`最接近`FlatStyle`例如 Button

# python - 使用 Python 控制对 WebDav/Apache 的访问

> ID：700480
> 
> 赞同：1
> 
> 时间：2009-03-31T07:58:05.777
> 
> 标签：python, django, apache, webdav

我想让用户使用 Apache 访问 WebDav，但我想先对他们进行身份验证并让每个用户访问特定文件夹。所有身份验证都必须针对基于 Django 的数据库进行。我可以让 Django 身份验证自己工作，但我需要帮助我对每个用户进行身份验证并为他们提供专用的 webdav 用户特定区域。

有什么提示吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-02-15T14:47:45.223

首先，对于其他读者，我的身份验证是使用[WSGI 身份验证脚本](http://www.davidfischer.name/2009/10/django-authentication-and-mod_wsgi/)针对 Django 完成的。

然后，问题的核心是，给每个 Django 用户，在这种情况下，他们自己的 WebDav 目录与其他用户分开。假设 Apache 虚拟站点配置中的以下 WebDAV 设置（通常在*/etc/apache2/sites-enabled/ 中*）

```
<Directory /webdav/root/on/server>
        DAV On

        # No .htaccess allowed
        AllowOverride None      

        Options Indexes

        AuthType Basic
        AuthName "Login to your webdav area"
        Require valid-user
        AuthBasicProvider wsgi
        WSGIAuthUserScript  /where/is/the/authentication-script.wsgi
   </Directory> 
```

请注意尚未设置 WebDav 的公共地址。这和用户区的东西，在同一个配置文件的两行中固定（把这些放在结束子句之后）：

```
RewriteEngine On
RewriteRule ^/webdav-url/(.*?)$ /webdav/root/on/server/%{LA-U:REMOTE_USER}/$1 
```

现在，可以在[http://my-server.com/webdav-url/](http://my-server.com/webdav-url/)上访问 webdav用户会收到登录提示，然后将进入 webdav 根目录的子目录，其名称与其用户名相同。*LA-U：*让 Apache “向前看”，让用户在确定安装路径*之前*登录，这很重要，因为该路径取决于用户名。如果没有一些重写规则，就没有 URL，用户也不会得到登录提示。换句话说，LA-U 避免了这种类型的登录处理的 catch-22。

**注意事项**：需要启用mod_rewrite，并且用户名必须作为目录名有效，无需任何修改。此外，这些命令不会自动创建用户目录，因此必须以其他方式确保它们的存在。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-31T13:13:34.473

您可能会发现 apache [mod_authn_dbd](http://httpd.apache.org/docs/2.2/mod/mod_authn_dbd.html)模块可以满足您的需求。该模块让 apache 检查 SQL 数据库的身份验证和授权。`<Location>`您可以在要保护的, `<Directory>`(etc) 区域中使用此指令：

```
<Directory /usr/www/myhost/private>
    # other config ere
    # mod_authn_dbd SQL query to authenticate a user
    AuthDBDUserPWQuery \
         "SELECT password FROM authn WHERE user = %s"
 </Directory> 
```

严格来说，这意味着您正在针对 Django 的数据库进行身份验证，而不是针对 Django 应用程序本身。请注意，您可以完全控制查询，因此您可以将其与任何表中的其他参数结合起来，以确保用户在允许身份验证之前处于良好的信誉，或在某些组中，或其他任何东西。

您可能需要大惊小怪，以确保在 apache 和 django 中使用的散列机制是相同的。

如果这不适合，请考虑将您的身份验证从 django 数据库移到 LDAP 服务器中。使用自定义身份验证后端（现有 django 的 LDAP 实现），django 将愉快地使用 LDAP...并且 Apache 中的 LDAP auth/auth 支持非常强大。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-08T03:34:34.893

我知道这个问题很老，但只是作为补充......如果您使用的是 mod_python，您可能还对Django 文档的“[从 Apache 对 Django 的用户数据库进行身份验证”部分感兴趣。](http://docs.djangoproject.com/en/dev/howto/apache-auth/#howto-apache-auth)

# c - GLib 哈希表循环问题

> ID：700485
> 
> 赞同：3
> 
> 时间：2009-03-31T07:59:07.240
> 
> 标签：c, hashtable, glib

我将在 C 程序中使用[GLib](http://en.wikipedia.org/wiki/GLib)的 Hash table 实现，现在我只是在试验它。我编写了以下代码进行测试：

```
 #include <glib.h>
 #include <stdlib.h>
 #include <stdint.h>
 #include <stdio.h>
 #include <string.h>

 int main(){
 // Some codes and declerations here
 GHashTable *g_hash_table;
 uint32_t *a;
 a=(uint32_t *)malloc(sizeof(uint32_t));
 if(a==NULL){
    printf("Not Enough Mem For a\n");
    return 1;
 }
 *a=1123231;

 uint32_t* key;
 key=(uint32_t *)malloc(sizeof(uint32_t));
 if(key==NULL){
     printf("Not Enough Mem For key\n");
     return 1;
 }
 *key=122312312;
 int i;
 g_hash_table=g_hash_table_new(g_int_hash, g_int_equal);
 for(i=0;i<TABLE_SIZE;i++){
     *key+=1;
     *a+=1;
     g_hash_table_insert(g_hash_table,(gpointer)key,(gpointer)a);
     uint32_t *x=(uint32_t *)g_hash_table_lookup(g_hash_table,key);
     printf("Counter:%d,  %u\n",i,*x);
 }

GHashTableIter iter;
g_hash_table_iter_init(&iter,g_hash_table);
int size=g_hash_table_size(g_hash_table);
printf("First size: %d\n",size);
uint32_t *val;
uint32_t *key_;
int counter=0;

// My problem is in the following loop it 
// always returns the same and the last key value pair
 while(g_hash_table_iter_next(&iter,(gpointer*)(void*)&key_,(gpointer*)(void*)&val)){
     counter++;
     printf("%u %u\n",(uint32_t)*key_,(uint32_t)*val);
     printf("Counter: %d\n",counter);
 }
 //Some more code here        
    return 0;
} 
```

不知何故，我的测试代码可以正确迭代，但在循环中它总是返回最后一个键和最后一个值对，而且它总是一样的。这里有什么问题？上面的代码可能无法运行，因为它是格式。我只是复制并粘贴了一些部分，以便清楚地了解我要做什么。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-31T08:05:03.730

我认为您的插入代码已损坏。您只分配一次内存，然后进行多次插入，增加存储在每个之间的单个分配位置中的值。

哈希表存储您的指针，因此最终会将每个键与相同的指针相关联。

此外，为了保持一致性，您可能应该`g_malloc()`与 glib 一起使用。

而且我总是建议`sizeof`在对象上使用而不是在它们的类型上使用；这样你就不会以非常危险的方式重复自己。所以，而不是

```
 guint32 *a;

  a = g_malloc(sizeof (guint32)); 
```

采用

```
 a = g_malloc(sizeof *a); 
```

通过这种方式，您“锁定”了依赖项，以便您始终分配足够的空间来存储任何`a`点，即使您后来更改了类型。

此外，您应该仔细检查您所做的每个演员表。将任何非常量指针强制转换`gpointer`为犹豫不决的程序员的标志。对于 glib，`gpointer`只是 的同义词`void *`，因此永远不需要强制转换。它只是给你的代码增加了杂乱无章，使它更难阅读。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-10-21T12:14:25.083

`key`,`a`声明中有错误。您总是将相同的指针放在哈希表中。尝试：

```
#include <glib.h>
#include <stdlib.h>
#include <stdint.h>
#include <stdio.h>
#include <string.h>

#define TABLE_SIZE 12

int main() {
    // Some codes and declarations here
    GHashTable *g_hash_table;
    int i;

    g_hash_table = g_hash_table_new(g_int_hash, g_int_equal);
    for (i=0; i<TABLE_SIZE; i++)
    {
        uint32_t* key = (uint32_t *)malloc(sizeof(uint32_t));
        uint32_t* a = (uint32_t *)malloc(sizeof(uint32_t));
        *key = i;
        *a   = i+10;
        g_hash_table_insert(g_hash_table, (gpointer)key, (gpointer)a);
        uint32_t *x = (uint32_t *)g_hash_table_lookup(g_hash_table,key);
        printf("key: %d -->  %u\n", *key ,*x);
    }

    GHashTableIter iter;
    int size=g_hash_table_size(g_hash_table);
    printf("First size: %d\n", size);

    uint32_t *val;
    uint32_t *key_;

    // My problem is in the following loop
    // it always returns the same and the last key value pair

    g_hash_table_iter_init (&iter, g_hash_table);
    while (g_hash_table_iter_next (&iter, (gpointer) &key_, (gpointer) &val))
    {
        printf("key %u ---> %u\n", (uint32_t)*key_, (uint32_t)*val);
    }

    // TODO: free keys
    return 0;
} 
```

# jquery - 使用 javascript 在 ie 中更改 iframe 源

> ID：700499
> 
> 赞同：15
> 
> 时间：2009-03-31T08:03:27.510
> 
> 标签：jquery, iframe

我使用了一个看起来像这样的 iframe：

```
<iframe style='width: 330px; height: 278px' scrolling='no' name="iframeId" class="advPlayer" id="iframeId" frameborder="0" src='../../player/iabpreview.php?adid=<?php echo $selectedAdIdx ?>&amp;autoPlay=true'></iframe> 
```

每当我点击 a`<div>`时，我都必须更改 iframe 的来源。我正在使用以下代码：

```
if ($j.browser.msie) {            
  frames['iframeId'].window.location="../player/iabpreview.php?adid="+adId+"&autoPlay=true";
}else {
  $j(".advPlayer").eq(0).attr("src", "../player/iabpreview.php?adid="+adId+"&autoPlay=true");    
} 
```

这适用于 Firefox，但不适用于 Internet Explorer。

什么代码也适用于 Internet Explorer？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2010-11-30T11:49:36.040

您永远不应该使用“浏览器检测”，而应该使用特征检测。恕我直言，最安全的方法是：

```
function SetIFrameSource(cid, url){
  var myframe = document.getElementById(cid);
  if(myframe !== null){
    if(myframe.src){
      myframe.src = url; }
    else if(myframe.contentWindow !== null && myframe.contentWindow.location !== null){
      myframe.contentWindow.location = url; }
    else{ 
      myframe.setAttribute('src', url); 
    }
  }
} 
```

只需测试 src 属性是否可用。如果不是，则在内容窗口上测试，最后一次尝试是 setAttribute。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-03-31T08:05:13.480

```
document.getElementById("iframeId").src = "Your URL here." 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-07-23T07:37:53.710

我已经尝试`getElementById`了很多其他变体。没有一个在 IE、FF、Opera 或 Chrome 上的工作方式相同。

这个效果很好：`parent.frames.IFRAME_ID.location.href = '/';`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-06-07T12:50:03.910

`document.getElementById('MsgBoxWindow').getAttribute('src')`在 Internet Explorer、Firefox、Safari 中工作，以获取源 URL。

`document.getElementById('MsgBoxWindow').setAttribute('src', urlwithinthedomain)`在相同的浏览器上工作以设置源 URL。

但是，必须在调用之前加载 iframe。调用 JavaScript 代码时，不要将其放在 iframe 之前。如果您在页面加载后立即调用它，则可以将两者放在 iframe 之后，它会按预期工作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-31T08:47:16.967

框架集合返回窗口对象（或等效对象）。您要定位文档对象；尝试做：

**window.frames['iframeId'].document.location.href = ....**

这适用于 IE、FF、Safari 等，因此也不需要杂乱的浏览器检测。

注意。IIRC 框架集合在 IE 中引用**名称，在其他浏览器中引用****id**，因此您需要 name 和 id 属性 - 但您已经拥有了，所以不用担心！

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-01-15T03:15:46.243

```
var myFrame = document.getElementById('myFrame'); 
myFrame.src = 'http://example.com'; 
```

它有内存泄漏。在 iframe src 多次更改后，您的浏览器会变慢到爬行。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-07-23T07:55:34.950

由于您使用了 jquery 标记，这可能会很方便。

```
function resizeIframe(height) {
    height = parseInt(height);
    height += 100;
    $('iframe#youriframeID').attr('height', height);   
} 
```

如果您正在进行跨浏览器调整大小，请查看这篇文章，其中解释了如何根据 iframe 内容自动调整高度。您将需要访问 iframed 网站的 html。 [根据内容调整 iframe 的大小](https://stackoverflow.com/questions/153152/resizing-an-iframe-based-on-content)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-07-23T08:01:56.323

您可以使用两种方法更改 iframe 的 src：

1.  更改href。
2.  更改源代码。

这两种方法都要求在尝试修改之前完全加载 iFrame。

更改 href 适用于所有浏览器，包括 IE5。你可以解决框架

*   通过引用元素的内容窗口：

    var myFrame = document.getElementById('myFrame'); myFrames.contentWindow.location = ' [http://example.com](http://example.com) ';

*   通过引用元素的名称：

    var myFrame = window.frames.myFrame; // 其中 myFrame 是元素的名称 myFrame.location = ' [http://example.com](http://example.com) ';

更改 src 如上所述，通过选择元素并更改 src - 但它必须是子元素，而不是后代元素。

```
var myFrame = document.getElementById('myFrame');
myFrame.src = 'http://example.com' 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-02-21T09:07:18.607

```
<script type="text/javascript">
  function changesrc(iframid, pagesrc)
  {
    document.getElementById(iframid).src = pagesrc; 
  }
</script>

<table style="width: 100%">
<tr>
  <td>
    <a href="#" onclick="changesrc('iframe1','page1.php')">Page1</a> <br/>
    <a href="#" onclick="changesrc('iframe1','page2.php')">Page2</a> <br/>
    <a href="#" onclick="changesrc('iframe1','page3.php')">Page3</a>
  </td>
  <td>   
    <iframe id="iframe1" src="page1.php" scrolling="no" 
            height="100%" width="100%" style="border:0px;"></iframe>
  </td>
</tr>
</table> 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-01-16T23:01:40.780

```
window.frames['iframeId'].document.location.href =... 
```

也有内存泄漏。这种效果在 IE 浏览器中更为显着。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2011-02-06T06:33:21.327

我从其他地方得到这个：

```
function getElementById(strId) {
  var element;

  if (document.getElementById) {
    element = document.getElementById(strId);
  }
  else if (document.all) {
    element = document.all[strId];
  } else if (document.layers) {
    element = document.layers[strId];
  } else {
    element = eval("document." + strId);
  }

  return element;
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-06-29T22:35:25.127

只需使用以下代码。

```
var iframe = document.getElementById('IFRAME ID'); // just for clarity
iframe .src = 'URL here'; 
```

它应该适用于所有浏览器。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2013-09-23T22:51:46.187

请注意，如果您只是更改 URL 的#anchor（即从 page.php#this 更改为 page.php#that），则 IE 不会刷新页面，但 Chrome 和 Firefox 会。如果这是您的问题，那么您可能希望在查询字符串中添加一些随机内容，以使 IE 认为这是一个全新的页面并强制重新加载。

例如（使用 jQuery）：

```
var hash = 'yourHash';
var rand = 1 + Math.floor(Math.random() * 9999);
var helpUrl = 'page.php?rand=' + rand + '#' + hash;
$('#iframe').attr('src', helpUrl); 
```

# apache-flex - Flex：内存问题

> ID：700504
> 
> 赞同：0
> 
> 时间：2009-03-31T08:05:43.293
> 
> 标签：apache-flex

我在删除运行时创建的组件时遇到问题。请帮我。

这是我创建组件的代码

```
var oh: ObjectHandles = new ObjectHandles;              
    oh.x =  event.localX-xOff;
    oh.y = event.localY-yOff;
    Canvas(event.target).addChild(oh);

    oh.addEventListener(KeyboardEvent.KEY_DOWN,deleteSel);
    oh.width=270;
    oh.height=200;
    oh.mouseChildren = true; 
    var vdo:FXVideo = new FXVideo;
    vdo.source = "http://thehq.tv/wp-content/uploads/flv/funny-people-trailer.flv";                 
    vdo.percentHeight = 100;
    vdo.percentWidth = 100;
    oh.addChild(vdo); 
```

键盘删除事件中的代码

```
 private function deleteSel(event:KeyboardEvent):void
     {
            if(event.charCode == 127) 
            {
               FXVideo(ObjectHandles(event.target).getChildAt(0)).stop();
               delete(ObjectHandles(event.target).getChildAt(0));

               ObjectHandles(event.target).removeAllChildren();
               ObjectHandles(event.target).parent.removeChild(ObjectHandles(event.target));
               delete ObjectHandles(event.target);                      
             }
      } 
```

在我删除对象句柄组件（内部是 FxVideo 组件）后，内存使用量仍然存在。删除后如何去除组件的内存分配？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-31T15:13:04.997

您需要移除事件侦听器，或者您可以添加带有弱引用的事件侦听器：

```
oh.addEventListener(KeyboardEvent.KEY_DOWN,deleteSel,false,0,true) 
```

我不建议调用删除。调用 removeAllChildren 应该会处理它。虽然，通过查看您的代码，这可能也不是必需的。删除事件侦听器后，它应该被清理干净。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-04T04:00:28.400

delete 仅适用于动态对象，不会在此处产生影响。我个人建议明确删除事件监听器：

```
event.target.removeEventListener(KeyboardEvent.KEY_DOWN,deleteSel); 
```

以及使用 Osman 建议的弱参考。

# c# - ASP.NET C# 语言文件不起作用

> ID：700507
> 
> 赞同：2
> 
> 时间：2009-03-31T08:07:40.637
> 
> 标签：c#, asp.net, localization

我刚开始使用显式资源文件。我执行了这些步骤：

*   在根目录下创建文件夹：`App_GlobalResources`

*   添加两个 resx 文件：`LocalizedText.en-us.resx`和`LocalizedText.resx`

*   在这两个文件中，我都有一个名为 ' `InstitutionTitle`'的值

*   `LocalizedText.en-us.resx`值是' `Institution`'，值`LocalizedText.resx`是' `Instelling`'

*   在我的`.aspx`文件中，我有以下标签：

    `<asp:Label ID="lblInstitution" runat="server" Text="<%$ Resources:LocalizedText, InstitutionTitle %>" />`

当我运行这个页面时，我总是得到荷兰语版本。无论我是否在浏览器中设置语言（FF 和 IE7），我总是得到荷兰语版本。当我请求浏览器的语言时，我得到`en-us`（使用：）`Response.Write(Request.Headers["Accept-Language"]);`。

有什么问题，我该如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-31T08:37:24.557

在浏览器中设置语言首选项是不够的。您必须确保在 ASP.NET 中相应地设置了当前线程的**Culture**和**UICulture**属性。

您可以在页面上以编程方式或声明方式执行此操作（<%@Page %> 指令的文化和 UICulture 属性）。

或者，您可以通过设置如下所示的 web.config 条目并将页面/母版页的 Culture/UICulture 属性设置为“auto”，让 ASP.NET 自动设置它们。

```
// web.config:
<globalization enableClientBasedCulture="true" ...>

// page/masterpage:
<%@ Page ... Culture="auto" UICulture="auto" %> 
```

查看[此页面](http://msdn.microsoft.com/en-us/library/bz9tc508.aspx)了解详情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-31T08:15:24.267

@martijn：

1.  检查浏览器缓存设置。开发时应该一直关闭缓存。

2.  安装 Firebug (FF) 和 Fiddler(IE) 以查看通过网络传输的内容。

希望这可以帮助...

签，

一个乡下人

# wpf - VS2008 因“致命执行引擎错误”而崩溃

> ID：700511
> 
> 赞同：4
> 
> 时间：2009-03-31T08:10:50.473
> 
> 标签：wpf, visual-studio, visual-studio-2008, crash

有没有人找到解决此错误（事件日志）导致 Visual Studio 崩溃的问题？

> .NET 运行时版本 2.0.50727.3082 - 致命的执行引擎错误 (7A2E1132) (0)

当我开始调试 xaml 中的问题时，它会执行此操作。然后 Visual Studio 将静默消失。

我查看了 SO 和 MS Connect，但没有找到修复或解决方法。我经常读到您应该禁用所有插件，但我没有。

编辑：是的，我安装了 SP1 和以下修复程序：

版本 9.0.30729.1 SP

KB944899 KB945140 KB945282 KB946040 KB946308 KB946344 KB946581 KB947171 KB947173 KB947180 KB947540 KB947789 KB947888 KB948127 KB9531756 KB950257 KB95645719

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-31T08:14:24.113

每次我看到这个，都是因为你最终会同时加载两个不同版本的 WPF（即一个来自 GAC，一个来自参考程序集）。

在 .csproj 文件中，是否有一行名为“允许在同一 AppDomain 中编译 XAML”的内容？（对不起，我实际上不记得真名） - Blend 喜欢把它放进去，它会导致问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-31T08:17:36.010

我也遇到过 VS2008 的 WPF 设计器崩溃的问题。我通过避免设计器并手动编辑 XAML 来解决问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-31T08:55:51.940

感谢保罗，我发现了一个非常奇怪的解决方法（我验证了几次）

*   打开解决方案
*   卸载项目（上下文菜单）
*   编辑 csproj（上下文菜单），不要进行任何更改
*   重新加载项目（联系菜单）

如果我在启动调试器之前这样做，VS 就不会崩溃。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-11T14:02:37.033

我刚刚发现了另一种解决这个问题的奇怪方法。我加载了解决方案，在打开任何 xaml 页面之前，我重建了项目。之后 xaml 页面加载正常，并且 VS2008 不会崩溃。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-31T12:58:47.783

您是否已将 VS 安装更新到 SP1？SP1 补丁修复了许多崩溃问题。

如果您已安装 SP1，请尝试同时安装以下补丁。这是对 VS 2008 SP1 中调试器相关问题的进一步修复

[http://support.microsoft.com/kb/957912](http://support.microsoft.com/kb/957912)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-07-20T20:17:56.590

我在尝试编辑 ASP.NET MVC 母版页或视图时遇到了同样的问题。我找到[了这个链接](http://code.google.com/p/mb-unit/issues/detail?id=354)。我的机器上安装了带有 VS2008 集成的 MBUnit Gallio。当我卸载 Gallio 时问题就消失了。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-10-14T20:49:33.903

我刚刚通过创建一个新解决方案并将“问题”解决方案中的所有项目添加到这个新解决方案中来解决了这个问题（无论如何都是症状）。完成此操作并丢弃旧解决方案后，一切正常。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-01-10T11:30:31.213

安装 devart 代码比较 V2.80.11 后我遇到了同样的问题 - 早期版本没有这个问题。删除devart后，问题就消失了。重新安装，问题又回来了。

我喜欢 devar 代码比较，所以我在没有 VS2008 集成的情况下安装了它。现在一切正常。

# security - 将简单的 MAC 添加到 url 参数？

> ID：700514
> 
> 赞同：1
> 
> 时间：2009-03-31T08:11:55.447
> 
> 标签：security, web-applications

我想在我的一些 URL 参数中添加一种简单的 MAC。这*仅*作为针对应用程序错误和缓存相关问题/错误的额外防线，而不是作为应用程序中实际登录安全性的任何形式的替代。给定的业务对象 ID 已受后端保护，仅限于单个用户。

所以基本上我想在我的 url 参数中添加一个简短的身份验证代码，大小为 2-4 个字符。我想我想按照 f(business-data-id + logged-on-user-id + ??) = hash 的方式设置一个可逆函数，但我愿意接受建议。

主要目的是停止 id 猜测，并确保每个登录用户的 url 相当不同。我*也不*想要像 MD5 这样又大又笨重的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-02T21:10:06.380

由于您不是在寻找加密质量，因此 24 位 CRC 可能会满足您的需求。虽然 MD5 在绝对意义上是“快”的，但 CRC 相对而言是“快得惊人”。然后可以使用 Base-64 编码将 3 字节 CRC 文本编码为四个字符。

这是用于 OpenPGP ASCII-armor 校验和的检查的 Java 实现：

```
private static byte[] crc(byte[] data)
{
  int crc = 0xB704CE;
  for (int octets = 0; octets < data.length; ++octets) {
    crc ^= (data[octets] & 0xFF) << 16;
    for (int i = 0; i < 8; ++i) {
      crc <<= 1;
      if ((crc & 0x1000000) != 0)
        crc ^= 0x1864CFB;
    }
  }
  byte[] b = new byte[3];
  for (int shift = 16, idx = 0; shift >= 0; shift -= 8) {
    b[idx++] = (byte) (crc >>> shift);
  }
  return b;
} 
```

我会散列一个密钥（只有服务器知道），连同你想保护的任何东西——可能是对象标识符和用户标识符的组合。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-01T13:23:21.540

如果你想要的基本上是 MD5 但更小，为什么不只使用 MD5 而只使用最后 4 个字符呢？这不会为您的网址添加一个巨大的 blob，它始终是 4 个漂亮的十六进制数字。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-31T08:20:55.377

一个简短的问题，我确信有一个很好的答案，但为什么不将此信息存储在 cookie 中呢？

然后你可以使用像 MD5 这样大而笨重的东西，你的 URL 仍然很漂亮。

# silverlight - 使用 Silverlight 的图像缩放效果

> ID：700516
> 
> 赞同：0
> 
> 时间：2009-03-31T08:12:52.043
> 
> 标签：silverlight, silverlight-2.0

我是 Silverlight 的新手。我需要在运行时使用 silverlight 为图像创建放大和缩小选项。请给出一些想法。最好用一些代码示例来解释。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-31T09:11:29.250

将 ScaleTransform 添加到您的图像或其容器，并在运行时通过其他一些输入机制控制 ScaleX 和 ScaleY 属性（通常是 Slider 控件在其更改的事件上更新比例值）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-31T08:39:28.330

考虑使用[Deep Zoom](http://msdn.microsoft.com/en-us/library/cc645)技术。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-19T17:22:25.270

您应该检查 vectorlight 工具包。它具有缩放、平移、放大镜功能的开箱即用控件。检查[Vectorlight.net](http://Vectorlight.net)网站。

# .net - LINQ to SQL 左外连接

> ID：700523
> 
> 赞同：146
> 
> 时间：2009-03-31T08:14:51.803
> 
> 标签：.net, database, linq, linq-to-sql

此查询是否等同于`LEFT OUTER`联接？

```
//assuming that I have a parameter named 'invoiceId' of type int
from c in SupportCases
let invoice = c.Invoices.FirstOrDefault(i=> i.Id == invoiceId)
where (invoiceId == 0 || invoice != null)    
select new 
{
      Id = c.Id
      , InvoiceId = invoice == null ? 0 : invoice.Id
} 
```

* * *

## 回答 #1

> 赞同：233
> 
> 时间：2011-01-19T19:32:11.890

**您不需要 into 语句：**

```
var query = 
    from customer in dc.Customers
    from order in dc.Orders
         .Where(o => customer.CustomerId == o.CustomerId)
         .DefaultIfEmpty()
    select new { Customer = customer, Order = order } 
    //Order will be null if the left join is null 
```

是的，上面的查询确实创建了一个 LEFT OUTER 连接。

链接到处理多个左连接的类似问题： [Linq to Sql: Multiple left outer joins](https://stackoverflow.com/questions/267488/linq-to-sql-multiple-left-outer-joins)

* * *

## 回答 #2

> 赞同：176
> 
> 时间：2009-03-31T08:33:01.590

不完全——因为左外连接中的每个“左”行都将匹配 0-n 个“右”行（在第二个表中），而你的只匹配 0-1。要进行左外连接，您需要`SelectMany`and `DefaultIfEmpty`，例如：

```
var query = from c in db.Customers
            join o in db.Orders
               on c.CustomerID equals o.CustomerID into sr
            from x in sr.DefaultIfEmpty()
            select new {
               CustomerID = c.CustomerID, ContactName = c.ContactName,
               OrderID = x == null ? -1 : x.OrderID }; 
```

（[或通过扩展方法](https://stackoverflow.com/questions/584820/how-do-you-perform-a-left-outer-join-using-linq-extension-methods)）

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2010-03-11T11:58:08.340

```
Public Sub LinqToSqlJoin07()
Dim q = From e In db.Employees _
        Group Join o In db.Orders On e Equals o.Employee Into ords = Group _
        From o In ords.DefaultIfEmpty _
        Select New With {e.FirstName, e.LastName, .Order = o}

ObjectDumper.Write(q) End Sub 
```

检查[http://msdn.microsoft.com/en-us/vbasic/bb737929.aspx](http://msdn.microsoft.com/en-us/vbasic/bb737929.aspx)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2010-12-23T02:51:10.867

我找到了 1 个解决方案。如果想将这种 SQL（左连接）翻译成 Linq 实体......

SQL：

```
SELECT * FROM [JOBBOOKING] AS [t0]
LEFT OUTER JOIN [REFTABLE] AS [t1] ON ([t0].[trxtype] = [t1].[code])
                                  AND ([t1]. [reftype] = "TRX") 
```

林克：

```
from job in JOBBOOKINGs
join r in (from r1 in REFTABLEs where r1.Reftype=="TRX" select r1) 
          on job.Trxtype equals r.Code into join1
from j in join1.DefaultIfEmpty()
select new
{
   //cols...
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-04-03T13:21:57.213

我想再补充一件事。在 LINQ to SQL 中，如果您的数据库已正确构建并且您的表通过外键约束相关联，那么您根本不需要进行连接。

使用 LINQPad 我创建了以下 LINQ 查询：

```
//Querying from both the CustomerInfo table and OrderInfo table
from cust in CustomerInfo
where cust.CustomerID == 123456
select new {cust, cust.OrderInfo} 
```

被翻译成下面的（稍微截断的）查询

```
 -- Region Parameters
 DECLARE @p0 Int = 123456
-- EndRegion
SELECT [t0].[CustomerID], [t0].[AlternateCustomerID],  [t1].[OrderID], [t1].[OnlineOrderID], (
    SELECT COUNT(*)
    FROM [OrderInfo] AS [t2]
    WHERE [t2].[CustomerID] = [t0].[CustomerID]
    ) AS [value]
FROM [CustomerInfo] AS [t0]
LEFT OUTER JOIN [OrderInfo] AS [t1] ON [t1].[CustomerID] = [t0].[CustomerID]
WHERE [t0].[CustomerID] = @p0
ORDER BY [t0].[CustomerID], [t1].[OrderID] 
```

注意`LEFT OUTER JOIN`以上。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-09-17T16:44:41.947

**注意性能：**

我经历过，至少对于**EF Core**，这里给出的不同答案可能会导致不同的性能。我知道 OP 询问了 Linq to SQL，但在我看来，EF Core 也会出现同样的问题。

在我必须处理的特定情况下，Marc Gravell 的（语法上更好的）建议导致交叉应用内的左连接 - 类似于 Mike U 所描述**的 - 结果是这个特定查询的估计成本是两个与没有交叉连接的查询相比高出 1 倍**。服务器执行时间**相差 3**倍。[1]

Marc Gravell 的解决方案导致了没有交叉连接的查询。

**上下文：**我基本上需要在两个表上执行两个左连接，每个表都需要连接到另一个表。此外，我必须在需要应用左连接的表上指定其他 where 条件。此外，我在主表上有两个内连接。

估计的运营商成本：

*   交叉应用：0.2534
*   无交叉应用：0.0991。

服务器执行时间（以毫秒为单位）（查询执行 10 次；使用 SET STATISTICS TIME ON 测量）：

*   交叉应用： 5, 6, 6, 6, 6, 6, 6, 6, 6, 6
*   无交叉应用：2, 2, 2, 2, 2, 2, 2, 2, 2, 2

（这两个查询的第一次运行都比较慢；似乎有些东西被缓存了。）

桌子尺寸：

*   主表：87行，
*   左连接的第一个表：179 行；
*   左连接的第二个表：7 行。

EF Core 版本：2.2.1。

SQL Server 版本：MS SQL Server 2017 - 14...（在 Windows 10 上）。

所有相关表仅在主键上有索引。

我的结论是：总是建议查看生成的 SQL，因为它确实可能有所不同。

* * *

[1] 有趣的是，当在 MS SQL Server Management Studio 中设置“客户端统计信息”时，我可以看到相反的趋势；即最后一次运行没有交叉应用的解决方案花费了超过 1 秒。我想这里出了点问题——也许是我的设置。

# jquery - ASP.NET MVC 视图和 jQuery.data()

> ID：700527
> 
> 赞同：1
> 
> 时间：2009-03-31T08:17:20.363
> 
> 标签：jquery, asp.net-mvc

设想：

我有一个局部视图，它在我的 ASP.NET MVC 应用程序的多个地方使用。部分视图包含要选择的“对象”列表，即类似于：

```
<ul>
    <%
        foreach (var person in Model.Persons)
        {
    %>
    <li><a href="#" class="person">
        <%= person.Name %></a></li>
    <%
        }        
    %>
</ul> 
```

每个人都有一个唯一的 id。

我将 jQuery 用于我的 AJAXy 内容，到目前为止，我已经通过以下方式向链接添加了点击功能（尽管它有一种非常不像 jQuery 的气味）

```
<a href="#" class="person" onclick="return selectPerson('<%= person.Id %>');">
            <%= person.Name %></a> 
```

它可以正常工作，但是它还要求我在使用此局部视图的每个页面上都有一个 selectPerson() javascript 函数（因为选择中发生的事情对于每个视图来说都是“特殊的”）。

我只是偶然发现了[jQuery Data()](http://docs.jquery.com/Core/data)方法，它似乎能够支持我的需求，即在使用我的部分人员列表视图的视图中，我可以执行以下操作：

```
$("a.person").click(function() { alert($(this).data("personId")); return false; }); 
```

如果我将 ID 附加到 DOM 元素上的“personId”数据属性。

现在我遇到的问题是我在服务器端进行 HTML 渲染，但是将“personId”数据属性附加到 DOM 元素必须在客户端完成。即在 foreach 循环期间或在单独的 JS 循环中，但我宁愿避免这种情况。

也许我走错了路，我不知道，但也许有人对此有解决方案，或者可能有更好的方法？

**编辑（为清楚起见更新）：**

以某种方式执行

$(*选择“当前”锚点*).data("personId",*设置为 person.Id 的值*);

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-31T08:35:42.237

更好的方法是使用不显眼的 javascript。您可以正常生成链接：

```
<a class="person" href="http://example.com/persons/select?id=<%= person.Id %>"><%= person.Name %></a>
<!-- or use helpers to generate the link -->
<%= Html.RouteLink(person.Name, "Default", new RouteValueDictionary(new { controller = "Persons", action = "Select", id = person.Id })) %> 
```

然后ajaxify它：

```
jQuery(function() {
    jQuery('a.person').click(function(evt) {
        jQuery.ajax({
            url: this.href,
            success: function(data) {
                // Do something with the returned content
            }
        });
    });
}); 
```

我不太明白你为什么要使用 JQuery.data()

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-31T08:51:21.327

为什么不将您的人员 ID“转储”到链接的 ID 字段中。

```
<a href="#" class="person" id="person_<%= person.Id %>"><%= person.Name %></a> 
```

现在您有了 id，您可以使用 jQuery 将`click`事件附加到该类的每个链接`person`，如 darin 所示：

```
jQuery(function() {
    jQuery('a.person').click(function(evt) {
        return selectPerson(this);
    });
}); 
```

现在在 selectPerson 函数中，或者在上述函数中，您必须获取`id`元素的 （类似于`person_234`）并取下`person_`零件，然后您就完成了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-19T15:51:28.100

您可以使用 jQuery Metadata 插件.. 基本上它在类属性中使用 json 数据，访问时会自动序列化..

但它虽然增加了很多标记..

请参阅[http://plugins.jquery.com/project/metadata](http://plugins.jquery.com/project/metadata)以供参考。

干杯，

埃里克

# java - 如何向 EJB 3.0 服务器验证应用程序客户端

> ID：700529
> 
> 赞同：2
> 
> 时间：2009-03-31T08:17:24.763
> 
> 标签：java, security, jakarta-ee, ejb-3.0, jaas

我对整个 J2EE 架构非常陌生。有人可以帮帮我吗？

我在机器 A 上有一个带有登录名、密码字段的 Swing 客户端。

```
Properties p = new Properties();
p.put(Context.INITIAL_CONTEXT_FACTORY, "org.jnp.interfaces.NamingContextFactory");
p.put(Context.URL_PKG_PREFIXES, "org.jboss.naming:org.jnp.interfaces");
p.put(Context.PROVIDER_URL, "jnp://localhost:1099/");

InitialContext ctx = new InitialContext(p);
ejb = (MyBeanRemote) ctx.lookup("DemoServer/MyBean/remote"); 
```

我在机器 B 上的 JBoss5 上有一个 EJB 3.0：

```
@Stateful
@DeclareRoles({"editor", "viewer"})
public class MyBean implements MyBeanRemote, Serializable  {

    @RolesAllowed({"editor"})
    public boolean modify() throws Exception {
            if(!ctx.isCallerInRole("editor")) throw new SecurityException("Can't modify");
            return true;
    }

    @RolesAllowed({"viewer","editor"})
    public boolean view() throws Exception {
            if(!ctx.isCallerInRole("viewer")) throw new SecurityException("Can't view");
            return true;
    }
} 
```

我在服务器上有一个包含用户和角色的数据库（conf/login-conf.xml）：

```
<application-policy name="jboss-secure">
  <authentication>
    <login-module code="org.jboss.security.auth.spi.DatabaseServerLoginModule" flag="required">
        <module-option name="unauthenticatedIdentity">guest</module-option>
        <module-option name="dsJndiName">java:/MyDerby</module-option>
        <module-option name="principalsQuery">SELECT Password FROM Users WHERE Username=?</module-option>
        <module-option name="rolesQuery">SELECT Role, 'Roles' FROM Users WHERE Username=?</module-option>
    </login-module>
  </authentication>
</application-policy> 
```

META-INF/jboss.xml：

```
<jboss>
    <security-domain>java:/jaas/jboss-secure</security-domain>
</jboss> 
```

据我了解，在客户端通过正确身份验证之前，我不应该获得 ejb 参考。我如何使用 LoginContext，我到底要不要使用它？我可以/应该使用`@EJB private MyBeanRemote ejb`吗？以及如何使整个事情发挥作用？

我只是在尝试构建一个看似微不足道的东西：应用程序客户端的授权。我觉得我好笨。

非常感谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-06T09:10:23.900

我最近在 JAAS 上做了一些工作，发现它可能非常棘手。查看这两个资源，我发现它们非常有用[http://www.jaasbook.com/](http://www.jaasbook.com/)和[http://docs.jboss.org/jbossas/admindevel326/html/ch8.chapter.html](http://docs.jboss.org/jbossas/admindevel326/html/ch8.chapter.html)

[我还在http://delicious.com/chronosMark/JAAS](http://delicious.com/chronosMark/JAAS)上找到了大量其他 JAAS 资源书，希望如果其他两个不这样做，其中一个会帮助您。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-31T09:07:39.667

[这里](http://java.sun.com/j2se/1.4.2/docs/guide/security/jaas/tutorials/GeneralAcnOnly.html)有教程

# c - 如何将 int/char 传递给 system() 一个 Linux 系统调用

> ID：700546
> 
> 赞同：4
> 
> 时间：2009-03-31T08:23:36.587
> 
> 标签：c, linux, parameter-passing

好吧，这听起来可能很愚蠢，但我想不出一种将 int/char 传递给这个系统调用的方法

这就是我希望它的工作方式

```
system ("cal %d %d", month, year); 
```

`cal 3 2009`我希望这会在终端“ ”上给我以下命令

终端会显示 2009 年 3 月的日历。

但是编译器抱怨它有太多参数

有任何想法吗？我需要让这个方法`system ("cal ")`返回一个动态日历。

备注：`cal`拿论据`cal month year`

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-31T08:28:41.130

您需要构建正确的命令行字符串，`system()`不会为您做：

```
char cmd[64];

snprintf(cmd, sizeof cmd, "cal %d %d", month, year);
system(cmd); 
```

[关于缓冲区溢出](http://en.wikipedia.org/wiki/Buffer_overflow)的常见警告适用，尽管在这种特殊情况下，当两个参数都是整数时，您应该是相当安全的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-31T08:29:32.050

基本上，只需在系统调用之外执行您的 printf 操作：

```
char my_cmd[MAX_SIZE];
snprintf(my_cmd, MAX_SIZE, "cal %d %d", month, year);
system(my_cmd); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-31T08:25:28.160

您需要传递一个已经进行了所有必要转换的字符串。您可以使用 sprintf() 来生成这样的字符串，只是要小心分配足够大的缓冲区。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-31T08:26:44.957

发生这种情况是因为您假设系统的行为类似于 printf，但事实并非如此。要获得所需的内容，您必须首先通过 sprintf 将替换获取到缓冲区中，然后将此缓冲区传递给系统。

不过要小心，这可能会成为一个潜在的安全漏洞，因为您可能会允许在命令行执行时传递未知参数。此外，您必须注意您使用的临时缓冲区足够大以容纳您的最终字符串。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-31T08:31:46.770

尝试

```
#include <stdlib.h>
#include <stdio.h>

int main()
{
  char command_buf [20];
  const int month = 3;
  const int year = 2009;
  snprintf(command_buf, sizeof(command_buf), "cal %d %d", month, year);
  system(command_buf);
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-31T08:26:43.337

您必须在使用它调用系统之前将命令格式化为字符串，例如使用 snprintf

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-31T08:28:17.153

```
char
  string[64];

sprintf( string, "cal %d %d", month, year );

system( string ); 
```

# java - 如何将 JTree“ctrl”选择模式设置为始终启用

> ID：700549
> 
> 赞同：5
> 
> 时间：2009-03-31T08:24:03.547
> 
> 标签：java, swing, user-interface, jtree

我有一个实现多选逻辑的 JTree。

当我使用鼠标 + Ctrl 键进行所有选择时，这非常有用。如果用户在未按下 Ctrl 键的情况下进行选择，则会破坏我的逻辑。

我真的不明白它为什么会中断，但我认为一个可能的解决方案是始终指示 TreeSelectionModel 已按下 Ctrl 键进行选择。

你有什么建议？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-31T15:26:11.690

我想我找到了解决方案

您将需要扩展 JTree 和 DefaultTreeSelectionModel。

JTree相关方法：

```
/////////////////////////////////////////////////////
/////////////////////////////////////////////////////
/// Implement selection using "adding" only logic. //
/////////////////////////////////////////////////////
/////////////////////////////////////////////////////

@Override
public void setSelectionPath(TreePath path) {

    System.out.println("MLDebugJTree: setSelectionPath(" + path + ")");

    addSelectionPath(path);

    return;
    //super.setSelectionPath(path);
}

@Override
public void setSelectionPaths(TreePath[] paths) {

    System.out.println("MLDebugJTree: setSelectionPaths(" + paths + ")");

    addSelectionPaths(paths);

    return;
}

@Override
public void setSelectionRow(int row) {

    System.out.println("MLDebugJTree: setSelectionRow(" + row + ")");

    addSelectionRow(row);

    return;
    //super.setSelectionRow(row);
}

@Override
public void setSelectionRows(int[] rows) {

    System.out.println("MLDebugJTree: setSelectionRows(" + rows + ")");

    addSelectionRows(rows);

    return;
    //super.setSelectionRows(rows);
} 
```

DefaultSelectionModel 相关方法：

```
package com.ml.tree2.model.impl;

import javax.swing.tree.DefaultTreeSelectionModel;
import javax.swing.tree.TreePath;

public class MLTreeSelectionModel extends DefaultTreeSelectionModel {
private static final long serialVersionUID = -4270031800448415780L;

@Override
public void addSelectionPath(TreePath path) {
    // Don't do overriding logic here because addSelectionPaths is ultimately called.
    super.addSelectionPath(path);
}

@Override
public void addSelectionPaths(TreePath[] paths) {
    if(paths != null) {
        for(TreePath path : paths) {

            TreePath[] toAdd = new TreePath[1];
            toAdd[0] = path;

            if (isPathSelected(path)) {
                // If path has been previously selected REMOVE THE SELECTION.
                super.removeSelectionPaths(toAdd);
            } else {
                // Else we really want to add the selection...
                super.addSelectionPaths(toAdd);
            }
        }
    }
} 
```

HTH。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-05-13T14:54:54.623

另一种解决方案是简单地扩展 BasicTreeUI 并更改选择行为以满足您的需求：

```
public class MultiSelectionTreeUI extends BasicTreeUI
{

    @Override
    protected boolean isToggleSelectionEvent( MouseEvent event )
    {
        return SwingUtilities.isLeftMouseButton( event );
    }
} 
```

然后在您的 JTree 上设置该 ui：

```
JTree tree = new JTree();
tree.setUI( new MultiSelectionTreeUI() ); 
```

# android - 是否可以使用标准的 android api 在屏幕上移动组件？

> ID：700550
> 
> 赞同：5
> 
> 时间：2009-03-31T08:25:03.090
> 
> 标签：android, user-interface

我想制作一个`android`用户界面，允许用户通过选择它们然后拖动它们来移动添加`components`/在屏幕上。`widgets`

这可以使用标准的android api吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-31T17:29:17.837

是的。这取决于您要达到的目标。

它可以*使用*标准 API 完成，但此功能不是标准 API 的*一部分*。也就是说，没有`widget.DragOverHere()`方法，除非你写一个。

也就是说，做起来不会很复杂。至少，您需要编写 View 的自定义子类并实现两个方法：`onDraw(Canvas c)`和`onTouch(MotionEvent e)`. 粗略的草图：

```
class MyView extends View {

    int x, y;  //the x-y coordinates of the icon (top-left corner)
    Bitmap bitmap; //the icon you are dragging around

    onDraw(Canvas c) {
      canvas.drawBitmap(x, y, bitmap);
    }

    onTouch(MotionEvent e) {
      switch(e.getAction()) {
      case MotionEvent.ACTION_DOWN:
        //maybe use a different bitmap to indicate 'selected'
        break;
      case MotionEvent.ACTION_MOVE:
        x = (int)e.getX();
        y = (int)e.getY();
        break;
      case MotionEvent.ACTION_UP:
        //switch back to 'unselected' bitmap
        break;
      }
      invalidate(); //redraw the view
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-31T15:49:15.597

在某种程度上。这取决于你想给用户多大的自由度。想到的一种解决方案是带有预定义单元格的 TableLayout。然后，用户可以点击并拖动组件。拖动组件时，您只想在用户的手指下绘制它的图像，但是当他们释放时，将组件从其先前的父级中删除，并使用 ViewGroup 添加/删除方法将其添加到新的父级。

虽然您可以以编程方式移动视图，但据我所知，动态切换布局是困难/不可能的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-31T17:45:17.067

我这样做的方法是拥有一个绝对布局，然后在拖动对象时更新它的位置。你必须自己实现拖动。如果小部件具有自然顺序（您希望能够在其中拖动按钮的工具栏），您可以在工具栏顶部堆叠绝对布局，当拖动开始时，您将其添加到绝对布局中，当它完成时，您将其添加回新位置的原始布局。

# java - org.hibernate.annotations 与 javax.persistence

> ID：700558
> 
> 赞同：58
> 
> 时间：2009-03-31T08:26:40.747
> 
> 标签：java, hibernate, jpa

使用来自

> javax.persistence 包

而不是使用

> org.hibernate.annotations 注释

我知道 using`javax.peristence`确实引入了另一个依赖项。但如果我忽略这一点，有什么优点/缺点？

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2009-03-31T08:31:06.540

恰恰相反。

Hibernate 是 Java Persistence API 的实现，在可能的情况下，您应该使用标准注解（在 javax.persistence 中）。这样，理论上您可以在其他 JPA 实现上运行您的代码。

只有当您需要特定于 Hibernate 的功能时，您才应该使用 Hibernate 注释。

额外的依赖只在 JPA 接口/注释 jar 文件上，而且非常轻。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-07-17T15:57:02.353

另一个缺点：

[http://www.mkyong.com/hibernate/cascade-jpa-hibernate-annotation-common-mistake/](http://www.mkyong.com/hibernate/cascade-jpa-hibernate-annotation-common-mistake/)

这在哪里：

```
@OneToMany(fetch = FetchType.LAZY, 
  cascade = {CascadeType.PERSIST,CascadeType.MERGE }, 
  mappedBy = "stock")
public Set<StockDailyRecord> getStockDailyRecords() {
    return this.stockDailyRecords;
} 
```

有了这个：

```
stockDailyRecords.setStock(stock);        
stock.getStockDailyRecords().add(stockDailyRecords);

session.save(stock);
session.getTransaction().commit(); 
```

不会像`@OneToMany`JPA 那样工作，它需要 JPA 级联 - `javax.persistence.CascadeType`. 但是，当您使用 Hibernate 会话保存它时，`org.hibernate.engine.Cascade`将执行以下检查：

```
if ( style.doCascade( action ) ) { 
```

和 Hibernate 保存过程会导致一个`ACTION_SAVE_UPDATE`动作，但是 JPA 会通过一个`ACTION_PERSIST`and `ACTION_MERGE`，它不会匹配并导致级联无法执行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-12-14T09:10:26.783

我使用`javax.persistence`了注解，当我用 Glass Fish 替换 Tomcat 6.0 时，Tomcat 6.0 包含了另一个 javax.persistence 包，它搞砸了一切。我认为使用`javax.persistence`注释不是一个好主意。天知道Tomcat到底发生了什么`javax.persistence`！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-06T12:16:26.693

官方建议在设置级联选项的情况下混合使用 JPA 和 Hibernate 注解，请参阅 [Hibernate 文档。2.4.7。级联](http://docs.jboss.org/hibernate/stable/annotations/reference/en/html/entity.html#entity-hibspec-cascade "休眠文档。 2.4.7。 级联")。如果您仅使用 JPA 注释，则在单向映射的情况下（在 Employer.java 中没有 Foo 类型的字段），您仍然会在调用 session.SaveOrUpdate 中获得“无法保存瞬态对象 Employer”。Cure 使用休眠风格的@Cascade 和 cascade={...}：

```
class Foo {
     @OneToMany( cascade = {CascadeType.PERSIST, CascadeType.MERGE} )
     @Cascade(org.hibernate.annotations.CascadeType.REPLICATE)
     public Collection<Employer> getEmployers()
...
} 
```

# tfs - 如何从 TFS 查询中的迭代路径中删除“根”

> ID：700568
> 
> 赞同：0
> 
> 时间：2009-03-31T08:29:44.640
> 
> 标签：tfs, iteration, tfs-workitem

在 Team Foundation 服务器中，我使用迭代/区域。但是，当我运行查询并选择迭代路径作为列时，它始终包含“根”迭代，即项目的名称。

有没有办法摆脱它？它占用了太多空间（我不明智地选择了长项目名称）并且没有添加任何额外信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-08T02:26:43.630

哎呀——我终于有时间自己检查一下，而不是从记忆中去。您可以重命名除根以外的所有节点。我的错。根被项目的名称替换。很抱歉误导了你。:-(

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T20:47:57.650

“根”是路径的标准部分，不能删除。

如果您想要一个较短的名称，您可以随时重命名它。它不必与项目的名称匹配 - 这样做只是为了在您第一次创建项目后为 root 设置一个默认值。

# asp.net - 计算一个月的天数

> ID：700569
> 
> 赞同：2
> 
> 时间：2009-03-31T08:29:45.060
> 
> 标签：asp.net, vb.net

我有一个以格式显示日期的文本框，例如：2008 年 3 月 20 日。然后我需要得到 2008 年 3 月的总天数。有人可以帮忙吗

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-31T08:35:07.810

您可以使用 DaysInMonth 函数

例如

```
Date.DaysInMonth(2008, 3) 
```

显然，您必须将年份和月份传递给函数

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-31T08:32:08.737

```
int year = DateTime.Now.Year;
int month = DateTime.Now.Month;
int numDays = DateTime.DaysInMonth(year, month); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-31T08:32:10.687

使用 DataTime.DaysInMonth()

[http://msdn.microsoft.com/en-us/library/system.datetime.daysinmonth(VS.71).aspx](http://msdn.microsoft.com/en-us/library/system.datetime.daysinmonth(VS.71).aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-31T08:39:37.267

请记住使用他们输入的日期。VB代码：

```
dim enteredDate as DateTime = cdate(txtDateBox.text)
dim daysInMonth as Int = DateTime.DaysInMonth(enteredDate.year,enteredDate.month) 
```

# c++ - 如何编写可以测试磁盘吞吐量的程序？

> ID：700570
> 
> 赞同：0
> 
> 时间：2009-03-31T08:31:03.043
> 
> 标签：c++, windows, file, operating-system, disk

如何使用 c++ 编写一个可以测试 Windows 系统中磁盘吞吐量的程序？

我可以用来编程的主要步骤和 API 是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-31T08:32:53.617

概述：

*   将已知（大量）数据写入磁盘（参见 write() ）
*   开始时钟（见 time() 或 clock() ）
*   从磁盘读取数据（参见 read() ）
*   停止时钟（见上文）
*   报告结果（见 cout）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-31T08:58:24.133

一个开源基准是[bonnie](http://www.textuality.com/bonnie/)，它主要使用标准 C API。您需要更改一些计时功能以适应 Windows。

# comments - How can I find the Reviews for all the technical Books?

> ID：700573
> 
> 赞同：-1
> 
> 时间：2009-03-31T08:31:38.940
> 
> 标签：comments, review

Is there any site for technical books reviews and comments. So that it is very useful before reading the book.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-31T08:35:09.570

Amazon.com?

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-31T08:42:22.067

I usually use Amazon's reviews and whatever a search finds me. Ideally I like to see a review weigh up pros and cons with examples of both the good and the bad, rather than just saying "This book is great."

There's a problem with reviewing technical books though: if you don't know the topic, you can't judge how accurate the book is, but you get a rough idea of how well it explains things (in terms of whether or not you get lost). If you *do* know the topic, you can judge accuracy but you can't judge how useful it would be to a newbie. I've [blogged about this in more detail](http://msmvps.com/blogs/jon_skeet/archive/2008/07/08/the-trouble-with-book-reviews.aspx). (If you happen to want to read a review of any book I've reviewed, I have a [book review tag](http://msmvps.com/blogs/jon_skeet/archive/tags/Book+reviews/default.aspx) on my blog. I tend to be harsher than most reviewers, partly because I have a very high standard for accuracy (not that I'm claiming to meet it myself), but I do at least explain why I do or don't like a book.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-31T08:35:37.450

[http://books.slashdot.org/](http://books.slashdot.org/)

# data-binding - Grails 日期绑定

> ID：700582
> 
> 赞同：4
> 
> 时间：2009-03-31T08:33:49.963
> 
> 标签：data-binding, grails, date

在 Grails 中，可以在控制器中“绑定数据”：

```
Book b = new Book()
bindData(b, params) 
```

如果我有来自用户输入的特定格式的日期字段（例如 yyyy-MM-dd）怎么办？在 Spring 中，我们可以使用 registerCustomEditor()。格瑞斯呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-10-29T16:55:47.117

使用 Grails 1.1.1，您可以实现 PropertyEditorRegistrar 并使用它来指定格式。请参阅[http://grails.1312388.n4.nabble.com/Grails-1-1-1-change-in-binding-date-properties-td1323105.html](http://grails.1312388.n4.nabble.com/Grails-1-1-1-change-in-binding-date-properties-td1323105.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-31T12:58:41.670

您是否已经遇到过[扩展数据绑定插件](http://www.grails.org/Extended+Data+Binding+Plugin)？

从网站上的文档来看，它似乎提供了您所指的两个方面

*   允许自定义 DataBinder，该 DataBinder 将用于解析用户定义的输入并使用自定义 PropertyEditor 在应用程序范围和特定于控制器的级别上填充对象（通常是域对象）。作为字符串。

*   使用动态方法扩展控制器以允许数据绑定和 bean 包装。

# visual-studio-2008 - 在 Visual Studio 2008 中获取最新版本快捷方式

> ID：700583
> 
> 赞同：2
> 
> 时间：2009-03-31T08:34:01.680
> 
> 标签：visual-studio-2008, version-control, keyboard-shortcuts

希望有一个键盘快捷键，它是我在 Visual Studio 2008 中从源代码控制中处理的解决方案的最新版本。

在任何地方的文档中都找不到！

此外，如果我可以获得其他源代码控制快捷方式来签入待处理的更改，那将是一件好事。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-31T08:38:03.370

您可以添加自己的...工具 -> 选项 -> 环境 -> 键盘

特别寻找：

*   File.GetLatestVersion
*   File.GetLatestSolutionFiles
*   文件签入

并在底部添加一个新的快捷方式

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-31T08:55:42.657

我有一个 Visual Studio 宏，它将枚举所有活动的键盘快捷键到一个格式良好的 HTML 页面，这里：

[http://www.codinghorror.com/blog/archives/000412.html](http://www.codinghorror.com/blog/archives/000412.html)

但正如 Marc 指出的那样，您可能必须添加自己的 .. 不确定您想要的这些东西实际上是否默认绑定到任何东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T13:47:52.160

在全新安装上工作的键盘快捷键的兼容性可能很有用，不幸的是在这种情况下它有点令人费解：

alt,v,p,(家) alt,f,r,l

选择解决方案资源管理器，必要时进入根目录，然后从文件菜单中获取最新信息。

# c++ - 将具有 std::auto_ptr 作为其成员变量的类的对象存储在 std::vector 中是否安全？

> ID：700588
> 
> 赞同：3
> 
> 时间：2009-03-31T08:35:15.110
> 
> 标签：c++, memory-management, stl

我不能在我的项目中使用 shared_ptr，没有提升 :(

因此，我的课程与以下课程大致相似：

```
class MyClass
{
private:
  std::auto_ptr<MyOtherClass> obj;
}; 
```

现在，我想将上述类的实例存储在 std::vector 中。安全吗？我在[这里读到](https://stackoverflow.com/questions/111478/why-is-it-wrong-to-use-stdautoptr-with-stl-containers)将 std::auto_ptr 与 STL 容器一起使用是错误的。它适用于我这里的情况吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-31T08:49:35.730

这是不安全的，因为当容器将复制 MyClass 实例时，默认复制运算符将为所有成员调用复制 - 并且对于 auto_ptr 成员也是如此，我们将遇到与您在问题中描述的相同的情况（将 auto_ptr 存储在容器中）

顺便说一句：为了避免在编译时混淆添加

```
private:
  MyClass& operator=( const MyClass& );  
  MyClass( const MyClass& ); 
```

如果您尝试使用复制运算符，则编译器输出错误，这可以节省您数小时的调试时间。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-31T09:03:51.453

正如 Neil Butterworth 所说， auto_ptr 可能不是要走的路。

[boost::shared_ptr](http://www.boost.org/doc/libs/1_38_0/libs/smart_ptr/shared_ptr.htm)显然是，但你说你不能使用 boost。

让我提一下，您可以下载 boost，仅使用[bcp 工具](http://www.boost.org/doc/libs/1_38_0/tools/bcp/bcp.html)提取 shared\ptr 所需的内容并使用[boost::shared_ptr](http://www.boost.org/doc/libs/1_38_0/libs/smart_ptr/shared_ptr.htm)。这仅意味着在您的项目中添加了一些 hpp 文件。我相信这是正确的方法。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-31T17:19:58.810

在标准容器中拥有包含 auto_ptr 的对象是*无效的。*您遇到未定义的行为。两个常见问题：

*   std::vector<>::resize 将其参数复制到每个创建的元素中。第一个副本将“成功”（见下文为什么不成功），但以后的每个副本都是空的，因为复制的元素也是空的！
*   如果在重新分配期间抛出某些东西，您可能碰巧复制了一些元素（到新缓冲区） - 但副本被丢弃 - 而其他元素则没有，因为`push_back`如果抛出异常，则必须没有任何影响。因此，您的一些元素现在是空的。

由于这都是关于未定义的行为，因此并不重要。但是，即使*我们*尝试根据我们认为有效的方式提出这种行为，无论如何我们都会失败。所有的成员函数，如`push_back`,`resize`等等都有一个 const 引用，它接受一个类型为 T 的对象。因此，`T const&`尝试将类型的引用复制到向量的元素中。但是隐式创建的复制构造函数/复制赋值运算符看起来像`T(T&)`- 也就是说，它需要从中复制一个*非常量对象！*标准库的良好实现会检查这一点，并在必要时无法编译。

在下一个 C++ 版本之前，您必须忍受这一点。下一个将支持仅*可移动*的元素类型。也就是说，移动的对象不需要与移动到的对象相等。这将允许将*流*、*所有权转移指针*和*线程*放入容器中。

查看标准对此 ( `17.4.3.6`) 的规定：

> 在某些情况下（替换函数、处理函数、对用于实例化标准库模板组件的类型的操作），C++ 标准库依赖于 C++ 程序提供的组件。如果这些组件不满足其要求，则标准对实施没有要求。
> 
> 特别是，在以下情况下效果是不确定的：
> 
> *   对于在实例化模板组件时用作模板参数的类型，如果对该类型的操作未实现适用的要求子条款（20.1.5、23.1、24.1、26.1）的语义。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-31T08:43:04.920

> 我已经发布了一个问题作为此答案的后续内容，请参阅 [包含存储在 vector 中的 auto_ptr 的类](https://stackoverflow.com/questions/704780/class-containing-autoptr-stored-in-vector)。

假设您的类没有用户定义的复制构造函数，那么不，它可能（见下文）不安全。当你的类被复制时（当它被添加到向量时会发生），将使用 auto_ptr 的复制构造函数。这具有将被复制的事物的所有权转移到副本的奇怪行为，因此被复制的事物的指针现在为空。

尽管不太可能，但您实际上可能想要这种行为，在这种情况下 auto_ptr 是安全的。假设你不这样做，你应该：

*   添加复制构造函数来管理复制

**请注意，这还不够 - 请参阅上面提到的后续问题以获取更多信息。**

或者：

*   使用更智能的、可能是引用计数的指针，例如 boost 智能指针之一

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-31T08:43:35.073

复制 MyClass 对象将导致调用赋值运算符或复制构造函数。如果它们没有以不寻常的方式重载处理 auto_ptr<>，它们会将复制构造函数（或赋值运算符）的调用传播到 auto_ptr<> 成员。这可能会导致您所链接的问题中描述的问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-31T09:00:52.270

实例化 auto_pointer 向量不安全的原因是有一种算法：sort()，它将在堆栈上的容器中复制一个对象。（sort() 实现了需要“pivot”的快速排序）因此在离开 sort() 函数的 scpope 时将其删除。同样，任何能够将容器作为参数并将其对象之一复制到堆栈上的算法或您自己的函数都会导致此问题。

那么在你的情况下，很简单，你必须确保你的类不表现为 auto_ptr，或者确保你永远不会调用可以删除底层对象的函数/算法。根据我的说法，第一个解决方案是最好的:)

因此，您的复制构造函数和伪装运算符也不应该放弃指针对象的属性。

实现这一点的最佳方法是包装一个 boost 智能指针而不是 auto_ptr，以在调用此类函数/算法时使您的容器安全。

顺便说一句，根据我的说法，定义一个更好的复制构造函数/影响运算符来绕过这个问题不是一个好的解决方案：我看不到一个好的复制构造函数实现（以及影响运算符）可以保证应用结果的安全sort() 算法。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-31T20:22:43.223

如果您想在容器中使用使用 auto_ptr 的类，您可以自己提供一个复制构造函数和赋值运算符：

```
class MyClass
{
private:
  const std::auto_ptr<MyOtherClass> obj; // Note const here to keep the pointer from being modified.

public:
  MyClass(const MyClass &other) : obj(new MyOtherClass(*other.obj)) {}
  MyClass &operator=(const MyClass &other)
  {
      *obj = *other.obj;
      return *this;
  }
}; 
```

`auto_ptr`但正如其他地方所提到的，该标准允许容器进行复制和分配，并假设所包含的类将以违反的特定方式运行。通过定义上述方法，您可以使包含 auto_ptr 行为的类。即使您的实现与 . 一起工作得很好`auto_ptrs`，您也会冒着发现另一个实现不起作用的风险。该标准仅保证性能和可观察的行为，而不是实施。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-31T08:52:29.920

不起作用。auto_ptr 不计算引用，这意味着在第一个析构函数调用时，您的指针将被释放。

请改用 boost::shared_ptr。

# active-directory - 应用程序 Active Directory 支持，究竟是什么意思？

> ID：700589
> 
> 赞同：0
> 
> 时间：2009-03-31T08:35:18.260
> 
> 标签：active-directory

我可以检查活动目录中的用户，如果他存在，那么我授予他打开应用程序窗口的权限，但是如果应用程序具有多个权限级别怎么办？我是否在活动目录中创建特殊的权限组并检查用户是否属于其中之一？. 应用程序可以自动登录，还是总是需要输入密码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-01T17:19:23.703

Active Directory 可以为应用程序实现两个相关但独立的功能：授权和身份验证。

身份验证正在验证使用您的应用程序的人是有效用户。如果您有用户的凭据（即应用程序提示用户输入他们的用户名和密码），您可以通过尝试使用他们的用户名/密码连接来针对 AD 对他们进行身份验证。

授权使您可以确定特定用户在您的应用程序中的权限级别。Active Directory 组是实现各种权限级别的一种相对简单且灵活的方式。通常，我会创建非常细粒度的权限组，这些权限组代表用户可以在应用程序中执行的每个安全操作（即 CanDeleteWidgets、CanAddWidgets、CanEditWidgets）。然后创建功能组或角色组，您可以在其中放置该角色的用户（即经理、协调员、技术人员等）。最后，您只需将角色组嵌套到权限组中，例如，如果业务需求是经理可以删除小部件，您可以将经理组添加为 CanDeleteWidgets 组的成员。虽然这看起来更复杂，

就自动登录而言，是的，您可以通过多种方式自动登录用户。对于 winforms 应用程序，您应该能够获取当前登录的用户并使用它。对于 Web 应用程序，如果您可以使用集成身份验证，那么您最终会得到相同的结果。您的 Web 服务器将处理身份验证部分并通过服务器标头变量中的用户的 DOMAIN\USERNAME 发送。

# tcp - 一个端口可以创建多少个套接字？

> ID：700594
> 
> 赞同：11
> 
> 时间：2009-03-31T08:36:40.537
> 
> 标签：tcp

一个端口可以创建多少个套接字？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-31T08:40:20.777

它取决于操作系统。

*   对于 Windows，请[在此处](http://support.microsoft.com/kb/158474)查找 MaxConnections 条目。

*   对于 Linux，请看[这里](https://stackoverflow.com/questions/651665/how-many-socket-connections-possible/651742#651742)的问题评论。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-31T08:39:31.027

这是操作系统限制。

基本上每个套接字都需要一个文件描述符（在 Linux/Unix 术语中；在 Windows 中可能等效）。操作系统将有一个每个进程的文件描述符限制（比如 250-1000），这将是上限。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-31T08:42:46.793

这将取决于您的进程可用的客户端端口数（即，当您打开与远程主机/端口组合的连接时，您还需要一个端口）。

客户端（或临时）端口的总数将可供您机器上的所有进程使用。因此，这取决于当前正在运行的其他内容。

端口数量和配置取决于操作系统。只是谷歌的“最大端口数”加上你的操作系统。

# wpf - WPF ListBox SelectedItem 有时不可见（滚动不同步）

> ID：700596
> 
> 赞同：8
> 
> 时间：2009-03-31T08:37:13.310
> 
> 标签：wpf, listbox

我有一个包含 30,000 个元素的列表框

```
<ListBox Name="lbWordlist" 
             Grid.Row="1" Margin="10"
             ItemsSource="{Binding Source={StaticResource WordListViewSource}}" 
             SelectedItem="{Binding Source={StaticResource MainViewModel}, Path=SelectedArticle}"
             IsSynchronizedWithCurrentItem="True"
             SelectionChanged="lbWordlist_SelectionChanged" /> 
```

我正在跟踪用户点击项目的历史记录

我有 2 个按钮 接下来，这些按钮允许用户在历史中返回和前进。

上一页 和 Next 按钮修改 ListBox 的 SelectedItem 属性

如果用户从 ListBox 中选择彼此相距很远的随机项目（例如，用户选择了列表顶部的一些项目和列表底部的少数项目），就会出现问题。

上一页 和 Next 按钮更改 SelectedItem 属性，但 ListBox 未与滚动同步，所选项目未突出显示，并且大多数情况下对用户不可见，因为它位于 ListBox 的可见项目区域之外。

有没有办法让 ListBox 正确显示当前选中的项目？

谢谢你。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-03-31T08:49:59.053

```
_listBox.ScrollIntoView(_listBox.SelectedItem); 
```

# python - 如何检测 RSS 提要中的更改和新项目？

> ID：700607
> 
> 赞同：7
> 
> 时间：2009-03-31T08:39:38.173
> 
> 标签：python, rss, feed

使用[feedparser](http://packages.python.org/feedparser/)或其他 Python 库来下载和解析 RSS 提要；如何可靠地检测`new`物品和`modified`物品？

到目前为止，我在提要中看到了发布日期早于最新项目的新项目。我还看到提要阅读器将发布的相同项目显示为单独的项目，但内容略有不同。我没有实现提要阅读器应用程序，我只是想要一个合理的策略来归档提要数据。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-01T01:22:33.940

这取决于您对提要来源的信任程度。feedparser 为提要项提供了一个 .id 属性——该属性对于 RSS 和 ATOM 源都应该是唯一的。例如，请参阅 feedparser 的[ATOM 文档](http://feedparser.org/docs/common-atom-elements.html)。尽管 .id 将涵盖大多数情况，但可以想象一个来源可能会发布具有相同 id 的多个项目。在这种情况下，您别无选择，只能对项目的内容进行哈希处理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-11-04T00:10:52.423

feedparser的[文档](https://universal-feedparser.readthedocs.io/en/latest/#http-features)中有两个[HTTP 功能](https://universal-feedparser.readthedocs.io/en/latest/#http-features)可以完成此操作：

### 1.使用ETags减少带宽

基本概念是提要发布者在发布提要时可能会提供一个特殊的 HTTP 标头，称为 ETag。您应该在后续请求中将此 ETag 发送回服务器。如果自您上次请求提要后未更改，服务器将返回一个特殊的 HTTP 状态代码 (304) 并且没有提要数据。

```
 import feedparser
    d = feedparser.parse('` <http://feedparser.org/docs/examples/atom10.xml>`_')
    d.etag``'"6c132-941-ad7e3080"'``
    d2 = feedparser.parse('` <http://feedparser.org/docs/examples/atom10.xml>`_', etag=d.etag)
    d2.status``304``
    d2.feed``{}``
    d2.entries``[]``
    d2.debug_message``'The feed has not changed since you last checked, so
    the server sent no data.  This is a feature, not a bug!' 
```

### 2\. 使用 Last-Modified 头来减少带宽

在这种情况下，服务器会在 HTTP 标头中发布提要的最后修改日期。您可以在后续请求中将其发送回服务器，如果提要没有更改，服务器将返回 HTTP 状态代码 304 并且没有提要数据。

```
import feedparser
d = feedparser.parse('` <http://feedparser.org/docs/examples/atom10.xml>`_')
d.modified``(2004, 6, 11, 23, 0, 34, 4, 163, 0)``
d2 = feedparser.parse('` <http://feedparser.org/docs/examples/atom10.xml>`_', modified=d.modified)
d2.status``304``
d2.feed``{}``
d2.entries``[]``
d2.debug_message``'The feed has not changed since you last checked, so
the server sent no data.  This is a feature, not a bug!' 
```

# sql-server - SQL：如何限制 MERGE 语句将插入的记录数

> ID：700611
> 
> 赞同：1
> 
> 时间：2009-03-31T08:42:07.697
> 
> 标签：sql-server, tsql, merge, filter

一些样本数据：

```
DECLARE @TARGET TABLE ( ID INT, value INT ) ;
DECLARE @SOURCE TABLE ( ID INT, value INT )

INSERT INTO @TARGET VALUES ( 1, 213 )             
INSERT INTO @TARGET VALUES ( 2, 3 )             
INSERT INTO @TARGET VALUES ( 3, 310 )             
INSERT INTO @TARGET VALUES ( 4, 43 )                     

INSERT INTO @SOURCE VALUES ( 1, 134 )             
INSERT INTO @SOURCE VALUES ( 2, 34 )             
INSERT INTO @SOURCE VALUES ( 13, 310 )             
INSERT INTO @SOURCE VALUES ( 14, 43 )             
INSERT INTO @SOURCE VALUES ( 15,32 )             
INSERT INTO @SOURCE VALUES ( 16, 30 )             
INSERT INTO @SOURCE VALUES ( 17, 60 )             
INSERT INTO @SOURCE VALUES ( 18, 5 )                   

MERGE @TARGET t USING (SELECT * FROM @SOURCE) AS s ON (t.id = s.id)
WHEN NOT MATCHED THEN
INSERT VALUES (s.id,s.value);

SELECT * FROM @TARGET 
```

所以我有一个目标表和一个源表。我想要完成的是，当有大量`not matched`项目时，只插入价值最高的 x 个顶部项目。
在合并本身上使用 top 是行不通的，因为这会限制整个源表，我想做类似的事情

```
WHEN NOT MATCHED 
LIMIT(5) AND ORDER BY Value DESC --only insert the 5 non-matches with the highest value
INSERT VALUES (s.id,s.value) 
```

---- UPDATE ----
我的 MERGE 语句还包含一个 WHEN MATCHED THEN 语句：

```
WHEN MATCHED THEN
UPDATE SET t.value = s.value 
```

这可悲地否定了伊恩和狗给出的答案......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-31T17:01:05.267

不推荐使用 SET ROWCOUNT，如果您这样做，则可以使用 top 子句：

```
;MERGE TOP (5) @TARGET t USING 
(SELECT TOP (100) PERCENT * FROM @SOURCE ORDER BY VALUE DESC) AS s ON (t.id = s.id)
WHEN NOT MATCHED 
THEN
INSERT VALUES (s.id,s.value);

SELECT * FROM @TARGET 
```

除非您有 TOP 子句，否则 ORDER BY int 合并将不起作用，因此使用 TOP (100) PERCENT 会欺骗 SQL 以允许排序。

编辑：

分两步做呢？

```
;MERGE TOP (5) @TARGET t USING 
(SELECT TOP (100) PERCENT * FROM @SOURCE ORDER BY VALUE DESC) AS s ON (t.id = s.id)
WHEN NOT MATCHED 
THEN
INSERT VALUES (s.id,s.value);/*
WHEN MATCHED THEN
UPDATE SET t.value = s.value;*/

update t 
set t.Value = s.Value
from     @Target t
    join @Source s on t.ID = s.ID 
where t.Value <> s.Value

SELECT * FROM @TARGET 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-31T08:44:43.620

您可以使用`SET ROWCOUNT n;`

例如;

```
SET ROWCOUNT 4;
UPDATE Production.ProductInventory
SET Quantity = 400
WHERE Quantity < 300; 
```

看; [http://msdn.microsoft.com/en-us/library/ms188774.aspx](http://msdn.microsoft.com/en-us/library/ms188774.aspx)

或者你可以做

```
Insert to @Target 
Select top 5 s.id, s.value from @Source s 
order by s.value desc ... etc. 
```

# sql - 如何将一个字段中的日期与另一个字段中的时间结合起来 - MS SQL Server

> ID：700619
> 
> 赞同：222
> 
> 时间：2009-03-31T08:46:19.920
> 
> 标签：sql, sql-server, datetime

在我正在处理的摘录中，我有 2`datetime`列。如图所示，一列存储日期，另一列存储时间。

如何查询表以将这两个字段组合成 1 列类型`datetime`？

**日期**

```
2009-03-12 00:00:00.000
2009-03-26 00:00:00.000
2009-03-26 00:00:00.000 
```

**时代**

```
1899-12-30 12:30:00.000
1899-12-30 10:00:00.000
1899-12-30 10:00:00.000 
```

* * *

## 回答 #1

> 赞同：270
> 
> 时间：2009-03-31T08:54:02.677

您可以简单地将两者相加。

*   **如果**`Time part`您的列`Date`的始终为零
*   **并且**`Date part`您的列`Time`的 也始终为零*（基准日期：1900 年 1 月 1 日）*

添加它们会返回正确的结果。

```
SELECT Combined = MyDate + MyTime FROM MyTable 
```

### 基本原理（感谢 ErikE/dnolan）

> 它的工作原理是这样的，因为日期存储为两个 4 字节 `Integers`，左 4 字节是`date`，右 4 字节是`time`. 就像在做`$0001 0000 + $0000 0001 = $0001 0001`

### 编辑关于新的 SQL Server 2008 类型

`Date`并且`Time`是 中引入的类型`SQL Server 2008`。如果你坚持添加，你可以使用`Combined = CAST(MyDate AS DATETIME) + CAST(MyTime AS DATETIME)`

### Edit2 关于 SQL Server 2008 及更高版本中的精度损失（对 Martin Smith 表示敬意）

看看[How to combine date and time to datetime2 in SQL Server?](https://dba.stackexchange.com/questions/51440/how-to-combine-date-and-time-to-datetime2-in-sql-server) 以防止使用 SQL Server 2008 及更高版本丢失精度。

* * *

## 回答 #2

> 赞同：141
> 
> 时间：2009-03-31T08:53:33.943

如果您的日期列的时间元素和时间列*的*日期元素都为零，那么[Lieven 的答案](https://stackoverflow.com/a/700649/370103)就是您所需要的。如果你不能保证总是这样，那么它会变得稍微复杂一些：

```
SELECT DATEADD(day, 0, DATEDIFF(day, 0, your_date_column)) +
    DATEADD(day, 0 - DATEDIFF(day, 0, your_time_column), your_time_column)
FROM your_table 
```

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2011-11-30T15:58:41.093

这是没有任何字符转换的替代解决方案：

```
DATEADD(ms, DATEDIFF(ms, '00:00:00', [Time]), CONVERT(DATETIME, [Date])) 
```

通过这种方式，您只能获得毫秒级的精度，但这通常是可以的。我已经在 SQL Server 2008 中对此进行了测试。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2013-02-06T10:54:35.523

这对我有用

```
CAST(Tbl.date as DATETIME) + CAST(Tbl.TimeFrom AS TIME) 
```

（在 SQL 2008 R2 上）

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2009-03-31T08:59:12.463

如果您不使用 SQL Server 2008（即您只有 DateTime 数据类型），您可以使用以下（诚然粗略和现成的）TSQL 来实现您想要的：

```
DECLARE @DateOnly AS datetime
DECLARE @TimeOnly AS datetime 

SET @DateOnly = '07 aug 2009 00:00:00'
SET @TimeOnly = '01 jan 1899 10:11:23'

-- Gives Date Only.
SELECT DATEADD(dd, 0, DATEDIFF(dd, 0, @DateOnly))

-- Gives Time Only.
SELECT DATEADD(Day, -DATEDIFF(Day, 0, @TimeOnly), @TimeOnly)

-- Concatenates Date and Time parts.
SELECT
CAST(
    DATEADD(dd, 0, DATEDIFF(dd, 0, @DateOnly)) + ' ' +
    DATEADD(Day, -DATEDIFF(Day, 0, @TimeOnly), @TimeOnly)           
as datetime) 
```

它粗糙且准备就绪，但它有效！

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2010-04-27T13:43:23.633

1.  如果您的两个字段都是日期时间，那么只需添加这些字段即可。

    例如：

    ```
    Declare @d datetime, @t datetime
    set @d = '2009-03-12 00:00:00.000';
    set @t = '1899-12-30 12:30:00.000';
    select @d + @t 
    ```

2.  如果您使用日期和时间数据类型，那么只需将时间转换为日期时间

    例如：

    ```
    Declare @d date, @t time
    set @d = '2009-03-12';
    set @t = '12:30:00.000';
    select @d + cast(@t as datetime) 
    ```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-10-20T09:58:18.340

将存储在 datetime 字段中的第一个日期转换为字符串，然后将存储在 datetime 字段中的时间转换为字符串，将两者附加并转换回 datetime 字段，所有这些都使用已知的转换格式。

```
Convert(datetime, Convert(char(10), MYDATETIMEFIELD, 103) + ' ' + Convert(char(8), MYTIMEFIELD, 108), 103) 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2017-01-02T19:53:11.717

将两个字段都转换为 DATETIME ：

```
SELECT CAST(@DateField as DATETIME) + CAST(@TimeField AS DATETIME) 
```

如果您[`Getdate()`](https://docs.microsoft.com/en-us/sql/t-sql/functions/getdate-transact-sql)首先使用它：

```
DECLARE @FechaActual DATETIME = CONVERT(DATE, GETDATE());
SELECT CAST(@FechaActual as DATETIME) + CAST(@HoraInicioTurno AS DATETIME) 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2017-08-30T14:35:36.133

如上所述，我有很多错误，所以我这样做了

```
try_parse(concat(convert(date,Arrival_date),' ',arrival_time) as datetime) AS ArrivalDateTime 
```

它对我有用。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2021-03-22T00:16:22.337

这是我的解决方案，它忽略了时间列的日期值

```
CAST(Tbl.date as DATETIME) + CAST(CAST(Tbl.TimeFrom AS TIME) as DATETIME) 
```

希望这对其他人有帮助

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-03-31T08:52:52.837

```
DECLARE @Dates table ([Date] datetime);
DECLARE @Times table ([Time] datetime);

INSERT INTO @Dates VALUES('2009-03-12 00:00:00.000');
INSERT INTO @Dates VALUES('2009-03-26 00:00:00.000');
INSERT INTO @Dates VALUES('2009-03-30 00:00:00.000');

INSERT INTO @Times VALUES('1899-12-30 12:30:00.000');
INSERT INTO @Times VALUES('1899-12-30 10:00:00.000');
INSERT INTO @Times VALUES('1899-12-30 10:00:00.000');

WITH Dates (ID, [Date])
AS (
    SELECT ROW_NUMBER() OVER (ORDER BY [Date]), [Date] FROM @Dates
), Times (ID, [Time])
AS (
    SELECT ROW_NUMBER() OVER (ORDER BY [Time]), [Time] FROM @Times
)
SELECT Dates.[Date] + Times.[Time] FROM Dates
    JOIN Times ON Times.ID = Dates.ID 
```

印刷：

```
2009-03-12 10:00:00.000
2009-03-26 10:00:00.000
2009-03-30 12:30:00.000 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2016-04-20T08:46:27.427

要将日期时间列中的日期和另一个日期时间列中的时间结合起来，这是最适合您的最快解决方案：

```
select cast(cast(DateColumn as date) as datetime) + cast(TimeColumn as datetime) from YourTable 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2021-11-19T14:12:24.377

找到这适用于两个日期，您希望从一个日期开始，从另一个日期开始：

```
declare @Time as datetime = '2021-11-19 12:34'
declare @Date as datetime = '2021-10-10'
SELECT @time + datediff(day, @Time, @Date) 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2016-12-13T10:00:30.423

```
SELECT CAST(your_date_column AS date) + CAST(your_time_column AS datetime) FROM your_table 
```

奇迹般有效

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2017-12-19T08:14:57.023

SELECT CAST(CAST(@DateField As Date) As DateTime) + CAST(CAST(@TimeField As Time) As DateTime)

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2018-12-03T15:40:49.983

另一种方法是使用`CONCAT`and `CAST`，请注意，您需要使用`DATETIME2(x)`它才能使其工作。您可以设置为没有精度损失`x`之间的任何值。`0-7` `7`

```
DECLARE @date date = '2018-03-12'
DECLARE @time time = '07:00:00.0000000'
SELECT CAST(CONCAT(@date, ' ', @time) AS DATETIME2(7)) 
```

退货`2018-03-12 07:00:00.0000000`

*在 SQL Server 14 上测试*

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2020-07-08T12:56:49.463

简单地连接两者，但首先将它们转换如下

```
select cast(concat(Cast(DateField as varchar), ' ', Cast(TimeField as varchar)) as datetime) as DateWithTime from TableName; 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2021-01-02T17:37:16.577

```
select s.SalesID from SalesTbl s 
        where cast(cast(s.SaleDate  as date) as datetime) + cast(cast(s.SaleCreatedDate as time) as datetime) between @FromDate and @ToDate 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2022-02-18T12:45:33.297

现有的答案没有解决`datetime2`数据类型，所以我将添加我的：

假设您要将一个[`time`](https://docs.microsoft.com/en-us/sql/t-sql/data-types/time-transact-sql?view=sql-server-ver15)值添加到一个[`datetime2`](https://docs.microsoft.com/en-us/sql/t-sql/data-types/datetime2-transact-sql?view=sql-server-ver15)值，其中：

*   该`datetime2`值可以包含非零时间分量和/或小数秒
*   该`time`值可以包含`23:59:59.9999999`86,399.9999999 秒、86,399,999,999.9 微秒或 86,399,999,999,900 纳秒¹

由于[`dateadd`](https://docs.microsoft.com/en-us/sql/t-sql/functions/dateadd-transact-sql?view=sql-server-ver15)功能¹的限制，您必须分两步添加它们：

*   将时间值转换为秒并使用`dateadd(second, ...)`
*   从时间值中提取纳秒`dateadd(nanosecond, ...)`并将它们添加到上面计算的日期

```
declare @dv datetime2 = '2000-01-01 12:34:56.7890123';
declare @tv time = '23:59:59.9999999';
select dateadd(
    nanosecond,
    datepart(nanosecond, @tv),
    dateadd(
        second,
        datepart(hour, @tv) * 60 * 60 + datepart(minute, @tv) * 60 + datepart(second, @tv),
        @dv
    )
);
-- 2000-01-02 12:34:56.7890122 
```

* * *

¹ 纳秒值可能不适合函数期望的[`int`](https://docs.microsoft.com/en-us/sql/t-sql/data-types/int-bigint-smallint-and-tinyint-transact-sql?view=sql-server-ver15)数据类型。`dateadd`

* * *

## 回答 #20

> 赞同：-1
> 
> 时间：2019-07-26T07:18:08.950

我遇到了类似的情况，我必须将日期和时间字段合并到日期时间字段。上述解决方案都不起作用，特别是添加两个字段，因为添加这两个字段的数据类型不一样。

我创建了下面的解决方案，我在日期中添加了小时和分钟部分。这对我来说效果很好。请检查一下，如果您遇到任何问题，请告诉我。

; tbl 为（选择 StatusTime = '12/30/1899 5:17:00 PM'，StatusDate = '7/24/2019 12:00:00 AM'）选择 DATEADD(MI, DATEPART(MINUTE,CAST(tbl .StatusTime AS TIME)),DATEADD(HH, DATEPART(HOUR,CAST(tbl.StatusTime AS TIME)), CAST(tbl.StatusDate as DATETIME))) 来自 tbl

结果：2019-07-24 17:17:00.000

# reportviewer - ReportViewer 上的图像字段

> ID：700620
> 
> 赞同：1
> 
> 时间：2009-03-31T08:46:28.577
> 
> 标签：reportviewer

任何人都试图在reportviewer 上显示图像字段（图像/字节数组）数据类型。

问候，彼得

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T18:19:45.130

是的。ReportViewer 需要 Base64 图像编码才能正确显示图像。

如果您的图像在 Byte 数组中，则需要将其转换为 Base64：

```
 Public Function ConvertImageToBase64String(ByVal img As Image) As String
    Dim output As String = ""

    Dim outputArray() As Byte
    Dim stream As New MemoryStream
    img.Save(stream, Drawing.Imaging.ImageFormat.Bmp)
    outputArray = stream.ToArray()
    stream.Close()
    output = Convert.ToBase64String(outputArray)

    Return output
  End Function 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-14T22:46:46.303

我在 SQL Server 中有一个图像数据类型。适用于 SSRS 2005 和 2008。

# silverlight - 在此 Silverlight MVVM 示例中，如何将 ModelView 连接到模型？

> ID：700629
> 
> 赞同：0
> 
> 时间：2009-03-31T08:48:54.327
> 
> 标签：silverlight, mvvm

我使用Silverlight 中的[模型视图视图模型 (MVVM) 文章作为在 Silverlight](http://mark-dot-net.blogspot.com/2008/11/model-view-view-model-mvvm-in.html)中创建我自己的 MVVM 示例的基础。

我有下面的所有部分：

*   **主页**（加载所有内容）
*   **查看**（带有绑定的 XAML 文件）
*   **模型**（生成虚假列表集合的客户类）
*   **ModelView**（继承 INotifyPropertyChanged 并具有 View 需要的两个字段的 PropertyChanged）

在我的主页中，我：

*   创建**视图模型**
*   **将ViewModel**绑定到**View**的**DataContext**
***   创建**模型**（客户）**

 ****但是现在我如何将 ModelView 连接到 Model 呢？**我觉得好像我需要以某种方式将我的客户模型注入到 CustomerViewModel 中，对吗？但具体如何？完成这个 MVVM 示例的下一步是什么，以便我可以开始使用 MVVM 模式的优势，例如用测试模型替换模型，用新视图替换视图等。

* * *

**MainPage.xaml.cs：** *创建 ViewModel，将 View 附加到 ViewModel*

```
using System.Windows.Controls;
using System.Collections.Generic;

namespace TestMvvm345
{
    public partial class MainPage : UserControl
    {
        private CustomerViewModel customerData;

        public MainPage()
        {
            InitializeComponent();

            customerData = new CustomerViewModel();
            customerHeaderView.DataContext = customerData;
            List<Customer> customers = Customer.GetCustomers();
        }
    }
} 
```

**MainPage.xaml：** *在主页面的上下文中显示视图*

```
<UserControl x:Class="TestMvvm345.MainPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
    xmlns:local="clr-namespace:TestMvvm345"
    Width="400" Height="300">
    <Grid x:Name="LayoutRoot" Background="White">
        <StackPanel HorizontalAlignment="Left">
            <local:CustomerHeaderView x:Name="customerHeaderView" Margin="10"/>
        </StackPanel>
    </Grid>
</UserControl> 
```

**CustomerViewModel.xaml：** *ViewModel*

```
using System.ComponentModel;

namespace TestMvvm345
{
    public class CustomerViewModel : INotifyPropertyChanged
    {
        private string firstName;
        private string lastName;

        public string FirstName
        {
            get { return firstName; }
            set
            {
                firstName = value;
                RaisePropertyChanged("FirstName");
            }
        }

        public string LastName
        {
            get { return lastName; }
            set
            {
                lastName = value;
                RaisePropertyChanged("LastName");
            }
        }

        public event PropertyChangedEventHandler PropertyChanged;

        private void RaisePropertyChanged(string property)
        {
            if (PropertyChanged != null)
            {
                PropertyChanged(this, new PropertyChangedEventArgs(property));
            }
        }
    }
} 
```

**CustomerHeaderView.xaml** *视图*

```
<UserControl x:Class="TestMvvm345.CustomerHeaderView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
    Width="400" Height="300">
    <Grid x:Name="LayoutRoot" Background="White">
        <StackPanel HorizontalAlignment="Left">
            <ListBox x:Name="CustomerList" ItemsSource="{Binding}">
                <ListBox.ItemTemplate>
                    <DataTemplate>
                        <StackPanel Orientation="Horizontal">
                            <TextBlock
                            Text="{FirstName}"/>
                            <TextBlock
                            Text="{LastName}"/>
                        </StackPanel>
                    </DataTemplate>
                </ListBox.ItemTemplate>
            </ListBox>
        </StackPanel>
    </Grid>
</UserControl> 
```

**Customers.cs** *模型*

```
using System;
using System.Collections.Generic;

namespace TestMvvm345
{
    public class Customer
    {
        public int ID { get; set; }
        public string FirstName { get; set; }
        public string LastName { get; set; }
        public int NumberOfContracts { get; set; }

        public static List<Customer> GetCustomers()
        {
            List<Customer> customers = new List<Customer>();
            customers = new List<Customer>();
            customers.Add(new Customer { FirstName = "Jim", LastName = "Smith", NumberOfContracts = 23 });
            customers.Add(new Customer { FirstName = "Jane", LastName = "Smith", NumberOfContracts = 22 });
            customers.Add(new Customer { FirstName = "John", LastName = "Tester", NumberOfContracts = 33 });
            customers.Add(new Customer { FirstName = "Robert", LastName = "Smith", NumberOfContracts = 2 });
            customers.Add(new Customer { FirstName = "Hank", LastName = "Jobs", NumberOfContracts = 5 });
            return customers;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-31T13:26:49.230

我使用 ViewModel 的方式有些不同。在我的例子中，它实际上包装了 Model 类，将大部分数据传递给模型。这样，模型中的所有标准业务规则仍然按照它们应该立即的方式工作。ViewModel 仅公开数据绑定或其他 UI 目的实际需要的那些属性。此外，ViewModel 可能包含用于数据绑定的其他属性/方法。

因此，使用您的客户示例： namespace TestMvvm345 { public class CustomerViewModel : INotifyPropertyChanged {

```
 private Customer _model;
    public Customer Model
    {
        get
        { return _model; }
        set
        {
            if (_model != null)
                Model.PropertyChanged -= Model_PropertyChanged;

            _model = value;

            if (_model != null)
                Model.PropertyChanged += Model_PropertyChanged;
        }
    }

    void Model_PropertyChanged(object sender, PropertyChangedEventArgs e)
    {
        RaisePropertyChanged(e.PropertyName);
        if (e.PropertyName == "FirstName" || e.PropertyName == "LastName")
            RaisePropertyChanged("FullName");
    }

    public string FirstName
    {
        get { return Model.FirstName; }
        set { Model.FirstName = value; }
    }

    public string LastName
    {
        get { return Model.LastName; }
        set { Model.LastName = value; }
    }

    public string FullName
    {
        get { return FirstName + " " + LastName; }
    }

    public static IList<CustomerViewModel> GetCustomers()
    {
        var result = new List<CustomerViewModel>();
        var customers = Customer.GetCustomers();
        foreach (var customer in customers)
        {
            result.Add(new CustomerViewModel() { Model = customer });
        }
        return result;
    }
    public event PropertyChangedEventHandler PropertyChanged;

    private void RaisePropertyChanged(string property)
    {
        if (PropertyChanged != null)
        {
            PropertyChanged(this, new PropertyChangedEventArgs(property));
        }
    }
}

public class Customer : INotifyPropertyChanged
{
    public int ID { get; set; }
    public string FirstName { get; set; }
    public string LastName { get; set; }
    public int NumberOfContracts { get; set; }

    public static List<Customer> GetCustomers()
    {
        List<Customer> customers = new List<Customer>();
        customers = new List<Customer>();
        customers.Add(new Customer { FirstName = "Jim", LastName = "Smith", NumberOfContracts = 23 });
        customers.Add(new Customer { FirstName = "Jane", LastName = "Smith", NumberOfContracts = 22 });
        customers.Add(new Customer { FirstName = "John", LastName = "Tester", NumberOfContracts = 33 });
        customers.Add(new Customer { FirstName = "Robert", LastName = "Smith", NumberOfContracts = 2 });
        customers.Add(new Customer { FirstName = "Hank", LastName = "Jobs", NumberOfContracts = 5 });
        return customers;
    }

    #region INotifyPropertyChanged Members

    public event PropertyChangedEventHandler PropertyChanged;

    #endregion
} 
```

}

现在在您的 UI 中使用以下代码进行绑定：customerHeaderView.DataContext = CustomerViewModel.GetCustomers();

ViewModel 中的代码确实变得有些大，但可以将很多代码放在基类中，并且模型中的所有属性都完全相同（想想 T4 模板）。

# vb.net - 如何报告更改 vb.net 的进度？

> ID：700631
> 
> 赞同：0
> 
> 时间：2009-03-31T08:49:32.687
> 
> 标签：vb.net, reporting, progress

我需要报告更改的进度。考虑以下代码：

```
Public Class Calculator
  Public Event CalculationProgress (ByVal sender As Object, ByVal e As MyCalculationProgressEventArgs)
Public Function Calculate(..)..
' Perform calculation here ...
' Reporting proggress
Dim args As New MyCalculationProgressEventArgs(myobj, myValue)
  RaiseEvent CalculationProgress (Me, args)
...
End Class 
```

*** 另一堂课

```
Private WithEvents calculator As Calculator

Private Function PerformCalculation(ByVal obj As Object) As CalcParams
Dim params As CalcParams = CType(obj, CalcParams)
calculator = GetCalculator()
....
Return params.result = calculator.Calculate
End Function

Private Sub calculationWorker_DoWork(ByVal sender As Object, ByVal e As DoWorkEventArgs) _
Handles calculationWorker.DoWork
  Dim calcResult As MyType = PerformCalculation(CType(e.Argument, MyType ))
  e.Result = calcResult
End Sub

Private Sub calculationWorker_ProgressChanged(ByVal sender As Object, ByVal e As ProgressChangedEventArgs) _
Handles calculationWorker.ProgressChanged
     CType(Parent.Parent, MainWindow).pbcCurrentProgress.Value = e.ProgressPercentage
End Sub 
```

我应该如何以及在哪里订阅 CalculationProgress 事件来调用

```
 calculationWorker.ReportProgress(MyCalculationProgressEventArgs.Percent) 
```

?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-31T12:48:56.107

您将在调用 GetCalculator 之后、调用Calculate 之前执行此操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-31T12:50:12.937

你在这里使用[BackgroundWorker](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker_members.aspx)对象吗？如果是这样，您要做的是订阅calculationWorker_DoWork 事件处理程序中的CalculationProgress 事件。您没有在 MyType 上发布任何信息，因此我假设您需要更改我的代码以获取 Calculator 实例。

```
Private Sub calculationWorker_DoWork(ByVal sender As Object, ByVal e As DoWorkEventArgs) _
  Handles calculationWorker.DoWork  

  Dim calcResult As MyType = PerformCalculation(CType(e.Argument, MyType ))  
  Dim calc = calcResult.Calculator
  AddHandler calc.CalculationProgress, AddressOf HandleCalculationProgress
  ...
  RemoveHandler calc.CalculationProgress, AddressOf HandleCalculationProgress
  e.Result = calcResult
End Sub 
```

# c# - 检查一个月的工作日

> ID：700635
> 
> 赞同：4
> 
> 时间：2009-03-31T08:50:01.017
> 
> 标签：c#, date, calendar

我有一个日期，例如 2009 年 4 月 1 日。我想知道工作日是什么，即 4 月 1 日是否是星期一、星期二等。同样，我想检查 4 月份每一天的工作日。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-31T08:52:37.050

使用[`DayOfWeek`](http://msdn.microsoft.com/en-us/library/system.datetime.dayofweek.aspx)属性：

```
new DateTime(2009, 4, 1).DayOfWeek 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-31T08:52:52.367

您可以使用[DayOfWeek](http://msdn.microsoft.com/en-us/library/system.datetime.dayofweek.aspx)属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-31T13:17:53.200

如果您选择的计算机语言没有`DayOfWeek`函数，您可以使用[Zeller's Congruence](http://en.wikipedia.org/wiki/Zeller%27s_congruence)，它使用简单的整数算术返回星期几。

# sql - 转义百分号 DB2 SQL

> ID：700648
> 
> 赞同：10
> 
> 时间：2009-03-31T08:53:53.083
> 
> 标签：sql, db2

我正在尝试选择连续包含四个百分号的数据。我怎样才能逃避百分比符号，以便我的 LIKE 条件有效？

谢谢

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-03-31T08:59:57.780

`@%`与转义字符子句一起使用：

```
select *
from tbl
where fld like '%@%%' escape '@' 
```

这将搜索列中包含该`"%"`字符的所有记录`fld`。

DB2/z 的格式略有不同：

```
select *
from tbl
where fld like {escape '@'} '%@%%' 
```

显然，您需要仔细选择转义字符，以免干扰字符串的其余部分，但这对于静态字符串来说相对容易。动态构建的字符串将需要动态构建的查询，以便它不使用字符串中的字符。

# c - 带有“goto”的流控制宏

> ID：700655
> 
> 赞同：6
> 
> 时间：2009-03-31T08:55:46.963
> 
> 标签：c, error-handling, coding-style, goto, control-flow

是的，**两个讨厌的构造结合在一起**。它是否像听起来那么糟糕，或者它可以被视为控制 goto 使用并提供合理清理策略的好方法？

在工作中，我们讨论了是否在我们的编码标准中允许 goto。一般来说，没有人愿意允许免费使用 goto，但有些人对使用它进行清理跳转持积极态度。如这段代码：

```
void func()
{
   char* p1 = malloc(16);
   if( !p1 )
      goto cleanup;

   char* p2 = malloc(16);
   if( !p2 )
      goto cleanup;

 goto norm_cleanup;

 err_cleanup:

   if( p1 )
      free(p1);

   if( p2 )
      free(p2);

 norm_cleanup:
} 
```

这种使用的最大好处是您不必最终得到以下代码：

```
void func()
{
   char* p1 = malloc(16);
   if( !p1 ){
      return;
   }

   char* p2 = malloc(16);
   if( !p2 ){
      free(p1);
      return;
   }

   char* p3 = malloc(16);
   if( !p3 ){
      free(p1);
      free(p2);
      return;
   }
} 
```

尤其是在具有许多分配的类似构造函数的函数中，这有时会变得非常糟糕，尤其是当有人必须在中间插入一些东西时。

因此，为了能够使用 goto，但仍然清楚地将其与自由使用隔离开来，创建了一组流控制宏来处理任务。看起来像这样（简化）：

```
#define FAIL_SECTION_BEGIN int exit_code[GUID] = 0;
#define FAIL_SECTION_DO_EXIT_IF( cond, exitcode ) if(cond){exit_code[GUID] = exitcode; goto exit_label[GUID];}
#define FAIL_SECTION_ERROR_EXIT(code) exit_label[GUID]: if(exit_code[GUID]) int code = exit_code[GUID];else goto end_label[GUID]
#define FAIL_SECTION_END end_label[GUID]: 
```

我们可以这样使用它：

```
int func()
{
   char* p1 = NULL;
   char* p2 = NULL;
   char* p3 = NULL;

   FAIL_SECTION_BEGIN
   {
      p1 = malloc(16);
      FAIL_SECTION_DO_EXIT_IF( !p1, -1 );

      p2 = malloc(16);
      FAIL_SECTION_DO_EXIT_IF( !p2, -1 );

      p3 = malloc(16);
      FAIL_SECTION_DO_EXIT_IF( !p3, -1 );
   }
   FAIL_SECTION_ERROR_EXIT( code )
   {
      if( p3 ) 
         free(p3);

      if( p2 ) 
         free(p2);

      if( p1 ) 
         free(p1);

      return code;
    }
    FAIL_SECTION_END

  return 0; 
```

它看起来不错，并且有很多好处，但是，在将其推广到开发中之前，我们应该考虑什么缺点吗？毕竟它是非常流量控制和 goto:ish。两人都气馁。在这种情况下阻止他们的论据是什么？

谢谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-31T09:11:18.517

`goto`错误处理是不太糟糕的罕见情况之一。

但是，如果我必须维护该代码，我会非常沮丧，因为这些代码`goto`被宏隐藏了。

所以在这种情况下`goto`对我来说是可以的，但不是宏。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-31T08:59:25.770

使用`goto`去一个常见的错误处理程序/清理/退出序列是绝对好的。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-31T09:01:50.303

这段代码：

```
void func()
{
   char* p1 = malloc(16);
   if( !p1 )
      goto cleanup;

   char* p2 = malloc(16);
   if( !p2 )
      goto cleanup;

 cleanup:

   if( p1 )
      free(p1);

   if( p2 )
      free(p2);
} 
```

在法律上可以写成：

```
void func()
{
   char* p1 = malloc(16);
   char* p2 = malloc(16);

    free(p1);
    free(p2);
} 
```

内存分配是否成功。

这是有效的，因为 free() 如果传递一个 NULL 指针什么都不做。在设计自己的 API 来分配和释放其他资源时，您可以使用相同的习惯用法：

```
// return handle to new Foo resource, or 0 if allocation failed
FOO_HANDLE AllocFoo();

// release Foo indicated by handle, - do nothing if handle is 0
void ReleaseFoo( FOO_HANDLE h ); 
```

像这样设计 API 可以大大简化资源管理。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-31T09:08:52.283

Cleanup with`goto`是一种常见的 C 习惯用法，[用于 Linux 内核](http://kerneltrap.org/node/553/2131)*.

**也许 Linus 的观点不是一个好的论证的最佳例子，但它确实表明`goto`在一个相对较大的项目中被使用。*

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-31T13:21:41.457

如果第一个 malloc 失败，则清理 p1 和 p2。由于 goto，p2 没有被初始化并且可能指向任何东西。我用 gcc 快速运行以检查并尝试释放（p2）确实会导致段错误。

在您的最后一个示例中，变量的范围在大括号内（即它们仅存在于 FAIL_SECTION_BEGIN 块中）。

假设代码在没有大括号的情况下工作，您仍然必须在 FAIL_SECTION_BEGIN 之前将所有指针初始化为 NULL 以避免段错误。

我不反对 goto 和宏，但我更喜欢 Neil Butterworth 的想法。

```
void func(void)
{
    void *p1 = malloc(16);
    void *p2 = malloc(16);
    void *p3 = malloc(16);

    if (!p1 || !p2 || !p3) goto cleanup;

    /* ... */

cleanup:
    if (p1) free(p1);
    if (p2) free(p2);
    if (p3) free(p3);
} 
```

或者如果它更合适..

```
void func(void)
{
    void *p1 = NULL;
    void *p2 = NULL;
    void *p3 = NULL;

    p1 = malloc(16);
    if (!p1) goto cleanup;

    p2 = malloc(16);
    if (!p2) goto cleanup;

    p3 = malloc(16);
    if (!p3) goto cleanup;

    /* ... */

cleanup:
    if (p1) free(p1);
    if (p2) free(p2);
    if (p3) free(p3);
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-31T09:06:20.637

我们都知道的“结构化编程”这个术语是反 goto 的东西，最初是作为一堆带有 goto（或 JMP）的编码模式开始和发展的。这些模式被称为`while`和`if`模式等。

因此，如果您使用 goto，请以结构化的方式使用它们。这限制了伤害。这些宏似乎是一种合理的方法。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-31T13:31:07.440

原始代码将受益于使用多个返回语句 - 无需跳过错误返回清理代码。另外，您通常也需要在普通返回时释放分配的空间 - 否则您会泄漏内存。`goto`如果你小心的话，你可以重写这个例子。在这种情况下，您可以在必要之前有效地声明变量：

```
void func()
{
    char *p1 = 0;
    char *p2 = 0;
    char *p3 = 0;

    if ((p1 = malloc(16)) != 0 &&
        (p2 = malloc(16)) != 0 &&
        (p3 = malloc(16)) != 0)
    {
        // Use p1, p2, p3 ...
    }
    free(p1);
    free(p2);
    free(p3);
} 
```

当每个分配操作之后有大量工作时，您可以在第一个`free()`操作之前使用标签，并且`goto`可以 - 错误处理是这些天使用的主要原因`goto`，其他任何事情都有些可疑.

我照顾一些确实具有嵌入 goto 语句的宏的代码。第一次遇到可见代码“未引用”但无法删除的标签时会感到困惑。我宁愿避免这种做法。当我不需要知道它们做什么时，宏就可以了——它们就是这么做的。当您必须知道它们扩展到什么以准确使用它们时，宏就不那么好了。如果他们不向我隐瞒信息，他们更多的是麻烦而不是帮助。

插图 - 为了保护罪犯而伪装的名字：

```
#define rerrcheck if (currval != &localval && globvar->currtub &&          \
                    globvar->currtub->te_flags & TE_ABORT)                 \
                    { if (globvar->currtub->te_state)                      \
                         globvar->currtub->te_state->ts_flags |= TS_FAILED;\
                      else                                                 \
                         delete_tub_name(globvar->currtub->te_name);       \
                      goto failure;                                        \
                    }

#define rgetunsigned(b) {if (_iincnt>=2)  \
                           {_iinptr+=2;_iincnt-=2;b = ldunsigned(_iinptr-2);} \
                         else {b = _igetunsigned(); rerrcheck}} 
```

有几十个变体`rgetunsigned()`有点相似——不同的大小和不同的加载器功能。

使用这些的一个地方包含这个循环 - 在一个较大的开关的单个案例中的一个较大的代码块中，带有一些小的和一些大的代码块（结构不是特别好）：

```
 for (i = 0 ; i < no_of_rows; i++)
            {
            row_t *tmprow = &val->v_coll.cl_typeinfo->clt_rows[i];

            rgetint(tmprow->seqno);
            rgetint(tmprow->level_no);
            rgetint(tmprow->parent_no);
            rgetint(tmprow->fieldnmlen);
            rgetpbuf(tmprow->fieldname, IDENTSIZE);
            rgetint(tmprow->field_no);
            rgetint(tmprow->type);
            rgetint(tmprow->length);
            rgetlong(tmprow->xid);
            rgetint(tmprow->flags);
            rgetint(tmprow->xtype_nm_len);
            rgetpbuf(tmprow->xtype_name, IDENTSIZE);
            rgetint(tmprow->xtype_owner_len);
            rgetpbuf(tmprow->xtype_owner_name, IDENTSIZE);
            rgetpbuf(tmprow->xtype_owner_name,
                     tmprow->xtype_owner_len);
            rgetint(tmprow->alignment);
            rgetlong(tmprow->sourcetype);
            } 
```

那里的代码带有 goto 语句并不明显！很明显，对它所来自的代码的罪恶进行完整的解释需要一整天的时间——它们是多种多样的。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-31T09:02:48.880

第一个示例对我来说比宏化版本更具可读性。而且[mouviciel](https://stackoverflow.com/questions/700655/flow-controlling-macros-with-goto/700718#700718)说的比我好得多

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-23T03:31:34.177

```
#define malloc_or_die(size) if(malloc(size) == NULL) exit(1) 
```

除非您有值得编写事务系统的软件，否则您无法真正从失败的 malloc 中恢复，如果您这样做，请将回滚代码添加到 malloc_or_die。

有关使用 goto 的真实示例，请查看使用计算 goto 的解析调度代码。

# amazon-web-services - 查找 S3 存储桶所有者

> ID：700657
> 
> 赞同：8
> 
> 时间：2009-03-31T08:56:54.683
> 
> 标签：amazon-web-services, amazon-s3, bucket, owner

如果有一个我可以从我的 AWS 账户读取/写入访问权限的存储桶，有没有办法获取所有者的 CanonicalUser id？

除非您是所有者，否则阅读 ACL 策略似乎是不可能的：/。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2017-06-06T21:16:48.343

如果您拥有存储桶的读取权限，请使用[get-bucket-acl 。](http://docs.aws.amazon.com/cli/latest/reference/s3api/get-bucket-acl.html)它会给出这样的输出

```
{
    "Owner": {
        "DisplayName": "my-username",
        "ID": "7009a8971cd538e11f6b6606438875e7c86c5b672f46db45460ddcd087d36c32"
    },
    "Grants": [
        {
            "Grantee": {
                "DisplayName": "my-username",
                "ID": "7009a8971cd538e11f6b6606438875e7c86c5b672f46db45460ddcd087d36c32"
            },
            "Permission": "FULL_CONTROL"
        }
    ]
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T00:57:58.253

你试过[GET Bucket](http://docs.amazonwebservices.com/AmazonS3/latest/API/RESTBucketGET.html)交易吗？它用于列出存储桶内的对象，它还返回一个标签，虽然看起来像是对象所有者，但根据文档，它是存储桶所有者：

> **所有者**
> 存储桶所有者。
> 类型：字符串
> 子项：DisplayName，ID
> 祖先：ListBucketResult.Contents | 常用前缀

# oracle - 在 Oracle 的 Select Satment 中使用 Case 返回多个列

> ID：700658
> 
> 赞同：6
> 
> 时间：2009-03-31T08:58:01.873
> 
> 标签：oracle

我有一个场景，我需要根据主选择语句中的条件从不同的子查询中检索值。我试图使用案例，但问题是案例不支持多列。是否有任何解决方法，或者有任何其他方法可以实现这一点。

我在简化查询中的场景

```
select col1,col2,
case when col3='E01089001' then 
        (select 1,3 from dual)
    else
        (select 2,4 from dual)
end
from Table1
where col1='A0529'; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-31T14:42:48.953

这是另一种编写方式，可以解决对第二个表的访问次数超出必要的问题。

```
select col1,col2,
case when col3='E01089001' then 1 else 2 end,
case when col3='E01089001' then 3 else 4 end
end
from Table1, dual
where col1='A0529'; 
```

您的示例使用了一个明显简化的子查询，所以这个版本看起来有点傻；根本没有理由加入 DUAL。但是在您的实际查询中，您可能有一个子查询，例如`SELECT a, b FROM otherTable WHERE someCondition`. 因此，您可能希望使用实际的列名而不是数字文字和实际的表名而不是对偶，并将子查询条件移动到最终的 WHERE 子句中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-31T15:01:02.263

一个快速而肮脏的解决方案。

```
选择虚拟,substr(c,1,instr(c,',')-1) c1,substr(c,instr(c,',')+1) c2
从 （
选择假人，
当 dummy='X' 时的情况
        (select 1||','||3 from dual)
结束 c
从（从双重选择*）
)

```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-31T12:39:57.470

如果每种情况只允许一列，那么您可能需要两种情况：

```
select col1,col2,
case when col3='E01089001' then 
    (select 1 from dual)
else
    (select 2 from dual)
end,
case when col3='E01089001' then 
    (select 3 from dual)
else
    (select 4 from dual)
end
from Table1
where col1='A0529'; 
```

我希望我不需要告诉你，当数据库表变大时，这类东西的伸缩性不是很好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-31T12:57:33.403

Case 确实支持条件检查中的多列

```
CASE WHEN A=X AND B=Y THEN ... END 
```

您在示例中尝试做的是将表（2 列）返回到需要一列的结果集中：col1，col2，（col3，col4）。

您需要分别返回它们：col1、col2、col3、col4

```
select
col1,
col2,
case when col3='E01089001' then (select 1 from dual) else (select 3 from dual) end,
case when col3='E01089001' then (select 2 from dual) else (select 4 from dual) end
from Table1 where col1='A0529'; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-06-16T23:03:12.380

对我来说最好的方法是使用 REGEXP_REPLACE。从 case 语句返回一个字符串，并在外部查询块 select 语句中将字符串标记为不同的字段。

# vb.net - 向access数据库添加一条记录，这段代码的错误在哪里？

> ID：700661
> 
> 赞同：0
> 
> 时间：2009-03-31T08:59:21.930
> 
> 标签：vb.net, ado.net, insert

在 Save Button 中阅读了很多关于 DataAdapter、DataTable 的信息，以访问此代码：

```
'insert new row
ds.Tables("Employees").Rows.Add(ENumTxt.Text, ENameTxt.Text, EPosTxt.Text,  
  EAgeTxt.Text, ESalTxt.Text, EPhonTxt.Text, EAdrsTxt.Text)
'save changes
ds.AcceptChanges()
Try
  If ds.HasChanges Then
    Dim AffectedDS As DataSet = ds.GetChanges(DataRowState.Added)
    'im ComBuilder As New OleDb.OleDbCommandBuilder(da)
    da.InsertCommand = ComBuilder.GetInsertCommand
    da.Update(AffectedDS, "Employees")
  End If
Catch e1 As OleDb.OleDbException
  MessageBox.Show(e1.Message)
End Try 
```

==================================================== ============================= 然后我尝试了这个：

```
Dim cb As New OleDb.OleDbCommandBuilder(da)
' Insert a new record in the DataSet
Dim r As DataRow = ds.Tables("Employees").NewRow()
r("EID") = ENumTxt.Text
r("EName") = ENameTxt.Text
r("Age") = EAgeTxt.Text
r("Salary") = ESalTxt.Text
r("EPhone") = EPhonTxt.Text
r("EAddress") = EAdrsTxt.Text
ds.Tables("Employees").Rows.Add(r)

' Insert the record even in the database
da.Update(ds.Tables("Employees").GetChanges())
' Align in-memory data with the data source ones
ds.AcceptChanges() 
```

==========

在运行时，两种情况下我都收到相同的错误消息

```
"Syntax error in INSERT INTO statement" 
```

请给我一些指导方针来解决这个错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-31T09:06:21.570

正如错误所说，您的 INSERT 语句中有错误...

DataAdapter 的“InsertCommand”指定的 INSERT 语句看起来如何？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-31T09:08:16.277

唯一想到的是，如果使用 Commandbuilder，您的表是否定义了主键？

# c# - 什么时候不使用通用集合？

> ID：700669
> 
> 赞同：5
> 
> 时间：2009-03-31T09:01:17.433
> 
> 标签：c#, .net, generics

使用泛型的优点是它增加了类型安全性——你只能放入正确类型的东西，并且你得到正确的类型而不需要强制转换。我能想到的不使用泛型集合的唯一原因是您需要存储一些任意数据。我错过了什么吗？在处理集合时还有什么其他原因不使用泛型？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-31T09:05:33.960

如果您需要存储任意数据，请使用`List<object>`（或其他）。然后绝对清楚这是*故意*任意的。

除此之外，我不会将非泛型集合用于任何事情。我*已经*使用`IEnumerable`并且`IList`当我一直在转换`object`引用并且不知道在编译时将其转换为的类型 - 所以非泛型*接口*有时很有用......但不是非泛型类本身。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-31T09:03:03.983

另一个明显的原因是使用不使用泛型集合的代码（可能是遗留代码）。

您可以在 .NET 本身中看到这种情况。`System.Windows.Form.Control.Controls`不是通用的，也不是`System.Web.UI.Control.Controls`。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-07T21:31:28.143

泛型几乎总是正确使用的东西。请注意，像 Haskell 和 ML 这样的语言基本上*只*允许该模型：在这些语言中根本没有默认的“object”或“void*”。

我可能不使用泛型的唯一原因是：

1.  当适当的类型在编译时根本不知道时。诸如反序列化对象或通过反射实例化对象之类的事情。

2.  当将使用我的代码的用户（还）不熟悉他们时。并非所有工程师都喜欢使用它们，尤其是在一些更高级的模式中，例如[CRTP](http://en.wikipedia.org/wiki/Curiously_recurring_template_pattern)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-31T12:49:54.780

主要优点是对值类型的通用集合没有装箱或拆箱惩罚。如果您使用 ildasm.exe 检查 il，则可以看到这一点。通用容器为值类型提供了更好的性能，而为引用类型提供了较小的性能改进。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-31T12:55:48.853

[泛型的类型差异](http://blogs.msdn.com/ericlippert/archive/tags/Covariance+and+Contravariance/default.aspx)可能会让您感到困惑，但大多数情况下您*应该*使用泛型集合。没有一个很好的理由来避免它们，世界上所有的理由都可以避免像 ArrayList 这样的无类型集合。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-31T12:56:08.477

我认为您需要考虑的一件事是，泛型集合并不总是替代非泛型集合。例如，**不能**简单地将 Dictionary<object,object> 插入到 Hashtable 的实例中。它们在可能并且将会破坏程序的许多场景中具有非常不同的行为。在这两个集合之间切换会迫使优秀的程序员检查用例以确保差异不会影响它们。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-31T09:06:43.287

这是一个答案：[从`Hashtable`到`Dictionary`](http://blogs.msdn.com/brada/archive/2004/04/26/120438.aspx)的变化。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-12-19T02:31:50.383

`Collection`命名空间中的非泛型`Microsoft.VisualBasic`有一些令人讨厌的怪癖和愚蠢，在很多方面都非常可怕，但它也有一个独特的特性：如果在枚举期间对其进行修改，它是唯一表现出合理语义的集合；如果使用某些其他集合类型，则可能需要大量重写满足某个谓词的集合的所有成员之类的代码。

# visual-studio - 如何为 VS 2008 编写自定义起始页？

> ID：700671
> 
> 赞同：1
> 
> 时间：2009-03-31T09:01:29.790
> 
> 标签：visual-studio

我环顾四周，并没有找到太多关于此的文档，所以我想我会问所有专家都在哪里闲逛。

我想创建一个带有错误跟踪和源代码控制界面的新起始页，而不是标准的 MSDN 提要。我似乎记得，人们可以做的不仅仅是提供不同的 URL，而且实际上可以实现一个组件作为起始页面运行，而无需使用 Web 内容。我可能错了。谁能给我一些提示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-31T12:35:15.610

转到工具 > 选项 > 环境 > 启动，然后将您的 RSS URL 放在起始页新闻频道字段中。

这应该足够了，但如果您想做更多，您可以在启动时下拉菜单中选择打开主页并将其指向具有适当内容的 URL。如果您使用具有 Windows 身份验证的 Intranet，则可以显示用户特定的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-31T13:37:06.303

您可以做的是创建一个 DTE工具窗口[（阅读：创建一个托管 .NET 用户控件的工具窗口）](http://blogs.msdn.com/hlong/archive/2005/09/30/475887.aspx)并在那里托管您的控件，然后创建一个插件非常容易，该插件将在运行时将工具窗口显示为文档。（与启动页面的外观相同）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-31T12:40:48.077

这将在 VS 2010 中完全可定制。您将能够在开始页面上做任何您想做的事情。

# php - 您如何检测您的网站访问者是否来自谷歌搜索结果？

> ID：700672
> 
> 赞同：5
> 
> 时间：2009-03-31T09:01:31.083
> 
> 标签：php, html

当用户从谷歌搜索并从他/她在结果页面中显示的结果登陆我们的网站时，我的网站有没有办法检测到他来自谷歌？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-31T09:06:06.720

检查`$_SERVER['HTTP_REFERER']`应该包含引用 URL 的变量。请注意，这不是防篡改或故障安全的，因为`Http-Referer`客户端可以轻松更改或修改标头。

**编辑：** 刚刚用谷歌搜索`phpinfo`（因为我得到了一个`phpinfo()`显示`$_SERVER['HTTP_REFERER']`变量的页面）来向你展示它的`Http-Referer`样子：

```
$_SERVER['HTTP_REFERER'] = "http://www.google.de/search?hl=de&q=phpinfo&btnG=Google-Suche&meta=" 
```

如您所见，您还可以提取谷歌查询中使用的搜索词（或检测搜索是否由谷歌浏览器地址栏发起）......

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-31T09:07:17.793

看起来您可以使用 $_SERVER['HTTP_REFERER'] 变量。但我认为该值是由客户控制的，不能总是保证存在或准确。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-31T09:05:24.820

您将检查`$_SERVER['HTTP_REFERER']`是否要在 PHP 中执行此操作。您也可以`document.referrer`在 javascript 中使用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-31T09:06:41.227

是的，使用 $_SERVER 数组中的 HTTP_REFERER 变量：

```
$_SERVER['HTTP_REFERER']; 
```

这应该包括类似[http://www.google.com/?q=etc](http://www.google.com/?q=etc)

但是请注意，REFERER 并不总是设置，因为客户端可以禁用他们的浏览器以在请求中发送它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-31T09:07:19.853

检查请求的引用者。它应该包含 www.google.com/...

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-31T12:35:47.013

HTTP_REFERER ：返回一个字符串，其中包含使用标记将请求引用到当前页面的页面的 URL。如果页面被重定向，HTTP_REFERER 为空。

使用用于 ASP 的 HTTP_REFERER。

# flash - 在 Flash CS4 中将字体值从 PT 更改为 PX

> ID：700675
> 
> 赞同：0
> 
> 时间：2009-03-31T09:02:38.303
> 
> 标签：flash, user-interface, properties, flash-cs4

刚买了 Flash CS4 Pro，由于某种原因，字体大小不是默认点而不是像素。我看不到任何地方可以改变这一点。有人有什么想法吗？

问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-31T15:22:26.533

根据我的经验，我没有发现任何区别，例如，如果在我的 Photoshop 设计中，de 字体以 px 为单位，而 flash 中的字体以 pt 为单位。

如果您希望使用 TextLineMetrics 类，可以单独更改所有字体线度量

[TextLineMetrics 类](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/text/TextLineMetrics.html)

# .net - VS：自动“ArgumentNull”检查？

> ID：700680
> 
> 赞同：2
> 
> 时间：2009-03-31T09:03:20.237
> 
> 标签：.net, visual-studio, autocomplete, code-generation, resharper

当我需要检查方法的参数是否为空时，通常会出现这种情况，例如：

```
public static bool operator <= 
    (ApplicationVersion i_app1, ApplicationVersion i_app2)
{ 
    if (i_app1 == null) throw new ArgumentNullException("i_app1");
    if (i_app2 == null) throw new ArgumentNullException("i_app2");
    [...]
} 
```

有没有办法（半）自动执行此操作，例如代码片段？自动完成？锐器？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-31T09:06:41.337

Resharper 有这个功能。如果您将光标悬停在参数名称上 - 比如说 i_app1 并按 Alt-Enter - 它会提供检查 null 的选项。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-31T09:06:55.283

我对此有一个扩展方法，它至少使它*稍微*简单一些：

```
i_app1.ThrowIfNull("i_app1"); 
```

实现很简单：

```
public static void ThrowIfNull<T>(this T argument, string name)
    where T : class
{
    if (argument == null)
    {
        throw new ArgumentNullException(name);
    }
} 
```

我更喜欢使用代码片段或其他任何东西，因为这意味着代码本身更短。打字对我来说很少成为问题——而尽可能保持代码可读性是。

希望.NET 4.0 中的[代码契约](http://microsoft.com/contracts)能让这一切变得更整洁。

# .net - WPF - 绑定到菜单图标

> ID：700681
> 
> 赞同：4
> 
> 时间：2009-03-31T09:03:31.033
> 
> 标签：.net, wpf, binding, menu

我有一个包含菜单的 UserControl。我需要将 Menu.Icon 绑定到 UserControl 的属性，但它不起作用。

代码是这样开始的 -

```
 <Border Grid.Row="0">            
        <DockPanel>
            <Image x:Name="testImage" Height="16" Width="16" Source="{Binding ElementName=UC,Path=AddImage}"/>
            <Menu DockPanel.Dock="Left" Height="20"
              VerticalAlignment="Center">
                <MenuItem Header="{Binding ElementName=UC,Path=AddText}">
                    <MenuItem.Icon>
                        <!--<Image x:Name="workswhenin" Height="16" Width="16" Source="pack://application:,,/Kowdox;component/Images/UserIcons/user_add.png"/>-->

                        <Image x:Name="realImage" Height="16" Width="16"
                        Source="{Binding ElementName=UC,Path=AddImage}"/>
                    </MenuItem.Icon>
                </MenuItem> 
```

您看到声明的第一张图片 (testImage) 完美运行，所以我很高兴绑定是正确的。第二个图像（注释掉并命名为“workswhenin”）包含我传递给 UserControls 绑定属性的包 URI，它也可以工作，但第三个（realImage）根本没有出现！

我看不出它不应该起作用的任何原因；我知道绑定很好，并且我知道图像在标记中的位置很好，所以发生了什么？

任何帮助将不胜感激。提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-10-27T14:44:06.320

无法确定，因为我看不到您的代码，但我很确定我知道问题出在哪里。

`Image.Source`需要一个类型的对象`ImageSource`。在 XAML 中指定 URL 时，默认 WPF 转换器用于将 URL 转换为`ImageSource`对象。因为您使用的是绑定，所以不使用默认转换器。因此，您可能正在尝试将图像源设置为 URL 值而不是`ImageSource`对象。

在您的属性代码中，您将不得不创建一个`ImageSource`对象，这真的很痛苦。您可以创建一个`BitmapImage`并传入 URL。

最简单的解决方案是在要绑定的属性的代码隐藏中使用 Microsoft 的默认转换器，或者在绑定中显式使用它。转换器称为`ImageSourceConverter`.

**编辑：**

这是一个简单的例子：

绑定源内的代码：

```
public ImageSource AddImageSource
{
    get
    {
        ImageSourceConverter imgConv = new ImageSourceConverter();
        return imgConv.ConvertFrom(this.AddImage);
    }
} 
```

更新绑定以针对此属性而不是 AddImage 属性。确保在 AddImage 属性更改时也为此属性触发 PropertyChanged 事件。

没有花时间为此构建测试场景，但它应该可以正常工作。

# vmware - VMWare ESXi 服务器 3.5

> ID：700685
> 
> 赞同：-1
> 
> 时间：2009-03-31T09:04:33.790
> 
> 标签：vmware, esxi

我正在尝试在具有 SATA 配置的 DELL GX280 机器上安装 VMWare ESXi 3.5。由于 ESXi 不支持 SATA，我无法继续。

通过进行一些更改，我可以在 IDE（也不支持）上安装。有没有办法在SATA上安装？？

请让我知道是否有人尝试过。

谢谢， 什维塔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-01T00:39:34.357

[对于VMware 论坛](http://communities.vmware.com/index.jspa)来说，这是一个比这里更合适的问题。

也就是说，ESXi 支持 SATA 驱动器，无需担心——我运行单个 SATA 驱动器进行引导，另外 4 个 SATA 驱动器插入 Adaptec 2405 RAID 控制器进行存储。完全支持的配置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-04T23:10:31.863

较新版本的 ESX 支持一些 SATA 芯片组。在某些时候，支持的芯片组是：

*   mptscsi_2xx (PCIE) - LSI1078
*   mptscsi_pcie - LSI1068E (LSISAS3442E)
*   mptscsi_pcix - LSI1068 (SAS 5)
*   aacaid_esx30 - IBM serveraid 8k SAS 控制器
*   cciss - 智能阵列 P400/256 控制器

# c# - 解析 EntityName 时出错

> ID：700686
> 
> 赞同：3
> 
> 时间：2009-03-31T09:04:59.173
> 
> 标签：c#, xml, parsing

我正在尝试将 xml 文档加载到 C# 中的对象 XPathDocument 中。我的 xml 文档包括这一行：trés dégagée + rade，当解析器到达那里时，它给了我这个错误：“解析 EntityName 时发生错误”我知道这是字符“é”的正常原因。有谁知道我怎样才能避免这个错误......我的想法是在 xml 文档中插入一个实体声明，然后用实体替换所有特殊字符......但它很长，我不确定它是否有效。你有其他想法吗？更简单？非常感谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-31T12:44:02.017

**正要发布这个，然后服务器就宕机了。我想我已经从记忆中正确地重写了它：**

我认为问题在于默认情况下`XPathDocument`使用 an`XmlTextReader`来解析所提供文件的内容，而这`XmlTextReader`使用`EntityHandling`.`ExpandEntities`

换句话说，当您依赖默认设置时，an`XmlTextReader`将验证输入 XML 并尝试解析所有实体。更好的方法是通过完全控制`XmlReaderSettings`（我总是手动进行）手动执行此操作：

```
string myXMLFile = "SomeFile.xml";
string fileContent = LoadXML(myXMLFile);

private string LoadXML(string xml)
{
  XPathDocument xDoc;
  XmlReaderSettings xrs = new XmlReaderSettings();
  // The following line does the "magic".
  xrs.CheckCharacters = false;

  using (XmlReader xr = XmlReader.Create(xml, xrs))
  {
    xDoc = new XPathDocument(xr);
  }

  if (xDoc != null)
  {
    XPathNavigator xNav = xDoc.CreateNavigator();
    return xNav.OuterXml;
  }
  else
    // Unable to load file
    return null;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-31T09:10:57.287

通常这是由用于读取文件的编码与实际编码的文件之间的不匹配引起的。

我猜我会说该文件是 UTF-8 编码的，但您正在使用默认编码读取它。

尝试用更多细节来加强你的问题，以获得更明确的答案。

# java - Eclipse 3.4 上的 Jboss 配置：停止问题

> ID：700697
> 
> 赞同：1
> 
> 时间：2009-03-31T09:07:07.093
> 
> 标签：java, eclipse, jboss

我在 eclipse ide 上的 jboss 配置有问题：
我不得不更改 jboss-service.xml 中的 Jboss 配置，因为使用的默认端口已在使用中（1099 端口）。
没有考虑 Eclipse 上的服务器配置更改：在我看来，启动操作时没有考虑服务器属性中的 jndi 端口。
所以我在 JBOSS/default/conf 存储库中修改了 jboss-service.xml。

```
<code>
   <!-- ==================================================================== -->
   <!-- JNDI                                                                 -->
   <!-- ==================================================================== -->

   <mbean code="org.jboss.naming.NamingService"
      name="jboss:service=Naming">
      <!-- The listening port for the bootstrap JNP service. Set this to -1
        to run the NamingService without the JNP invoker listening port.
      -->
      <attribute name="Port">1199</attribute>
      <!-- The bootstrap JNP server bind address. This also sets the default
      RMI service bind address. Empty == all addresses
       -->
      <attribute name="BindAddress">${jboss.bind.address}</attribute>
      <!-- The port of the RMI naming service, 0 == anonymous -->
      <attribute name="RmiPort">1198</attribute>
      <!-- The RMI service bind address. Empty == all addresses
       -->
      <attribute name="RmiBindAddress">${jboss.bind.address}</attribute>
   </mbean>

   <mbean code="org.jboss.naming.JNDIView" 
        name="jboss:service=JNDIView"
        xmbean-dd="resource:xmdesc/JNDIView-xmbean.xml"> 
   </mbean>
</code> 
```

JBoss 启动时很好地考虑了此更改，但我无法正常停止它。停止操作保留 1099 端口，因此它会杀死 java 进程而不是停止服务器。

配置：JBoss 3.2.5 和 eclipse 3.4.0

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-16T13:20:06.593

[JBoss Tools ( http://jboss.org/tools](http://jboss.org/tools) )附带的服务器适配器会自动从 xml 中获取端口值，如果这不起作用，您可以双击服务器并明确设置值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-22T23:54:36.867

JBoss，有时不会关闭服务器，因此当您尝试再次运行它时，该端口仍在使用中...进程再试一次，你可以这样查看端口和进程：

进入cmd：netstat -ano

使用您需要的端口查找进程的 PID。

转到任务管理器（如果尚未显示，请选择显示 PID 列）终止该进程。

再试一次......但是，更好的方法是为 jboss 保留端口。比如 JNP、RMI、WEB 等等。

# delphi - Delphi：显示没有激活的窗口

> ID：700698
> 
> 赞同：21
> 
> 时间：2009-03-31T09:07:07.403
> 
> 标签：delphi, focus, window

我很难在不失去焦点的情况下在主要表格上方显示第二个表格。

我试过`ShowWindow(second.handle, SW_SHOWNOACTIVATE)`了，但是主窗体失去了焦点。如果我`Visible := false`在第二个窗口上设置，则调用`ShowWindow`不会激活第二个表单，但显示时窗口是空的......

有人有这方面的好食谱吗？

更新：我正在尝试做的是在给定事件中显​​示通知窗口。关键是主窗体在任何时候都不会失去焦点。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-03-31T13:24:40.780

你的代码一定有问题。

我测试了这段代码，它可以工作：

```
procedure TForm1.Button1Click(Sender: TObject);
begin
  ShowWindow(Form2.Handle, SW_SHOWNOACTIVATE);
  Form2.Visible := True;
end; 
```

小心使用**`Visible`**，不要**`Show`**！否则它将覆盖`SW_SHOWNOACTIVATE`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-31T12:50:12.313

您可以显示窗口（非模式）并将焦点重置到主窗口。

```
procedure TMainForm.ButtonClick(Sender: TObject);
begin
  OtherForm.Show;
  SetFocus;
end; 
```

2006 年测试。

这不会在顶部显示其他表单。但是在顶部有一个没有焦点的窗口是非常违反直觉的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-31T15:42:06.363

我过去用过这个

```
SetWindowPos(WindowHandle, HWND_TOP, 0, 0, 0, 0, SWP_NOACTIVATE or SWP_NOSIZE or SWP_NOMOVE); 
```

不过，我还没有用最新版本的 Delphi 测试过这个......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-31T17:40:16.530

如果可能，您应该考虑使用某种工具提示窗口来显示通知信息。工具提示在显示或用户单击时不会从您的主窗口中窃取焦点。默认情况下，常规表单将具有边框，如果用户单击该边框，您的主表单将失去焦点。

这是执行此操作的一些基本代码。调用 free 时提示消失；但是，您最好设置一个计时器而不是使用睡眠。

```
with THintWindow.Create(nil) do
  try
    ActivateHint(MyRect, 'My Notification');
    Sleep(DisplayTime);
  finally
    Free;
  end 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-31T18:21:51.487

这个给你：

```
 // you have set your 2nd form as non resizable, without border nor title etc...
  Form2.Enabled := False; // prevent the 2nd form to grab focus even when clicked
  SetWindowPos(Form2.Handle, HWND_TOP, 0, 0, 0, 0, SWP_SHOWWINDOW or SWP_NOACTIVATE or SWP_NOSIZE or SWP_NOMOVE);
  // be sure to hide it automatically when done as it is disabled... 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-31T18:22:50.970

我过去这样做过，但我没有代码，因为它在上一份工作中是专有的（对不起）。

如果我没记错的话，我所做的是：

1.  从客户端类 A 调用不属于任何类的过程（或函数）（传统的 Pascal 方法）。
2.  从该方法中，调用不继承自 TForm 的类 B 中的某个方法
3.  从 B 中的方法，创建弹出窗体 P 的实例，但没有父或所有者；并调用实例中的方法。
4.  从实例中调用的方法中，显示自己。

代码（第 3 步）可能是这样的：

```
var p: TPopupForm;
begin
  p := TPopupForm.Create(nil);
  p.ShowWindow;
  p.Release;
end; 
```

如果这不起作用，我很抱歉，我也没有 Delphi。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-05-17T10:01:27.680

丹尼尔斯代码一直有效**，直到**......

```
ShowWindow(Form2.Handle, SW_SHOWNOACTIVATE);
Form2.Visible := True; 
```

直到您的第二个表单被**动态创建**。然后您的第二个表单位于 0,0 位置，具有默认宽度和高度。

在`ShowWindow`执行的一小会儿，您将在屏幕上看到第二个表单，在执行下一行时消失。

我正在使用动态创建的透明覆盖表单的代码。以下代码是给定答案的组合，并将未激活的第二个表单放在父表单上。

```
SetWindowPos(Form2.Handle, HWND_TOP, Left, Top, Width, Height, SWP_NOACTIVATE);
Form2.Visible := True; 
```

# c# - 使用 Open XML SDK 进行邮件合并

> ID：700706
> 
> 赞同：3
> 
> 时间：2009-03-31T09:08:40.007
> 
> 标签：c#, openxml, mailmerge

我有一个包含 3 列（a、b、c）的 DataTable 和一个设置了相应 MailMerge 字段的 docx 文件。我想要做的是对带有数据的文档执行邮件合并。

假设您可以写入硬盘（如果您需要创建一个 csv 等来进行合并等），您*没有*word、excel 等，安装了 Open XML SDK ，但同样我们*可以*安装其他任何东西。

就答案而言，将输入数据转换为所需的数据并不是真正的问题，问题是*如何*在 Open XML SDK（或其他免费 API）中执行邮件合并。

作为旁注，输出应该是一个有 n 页的文件（其中 n 是数据中的行数），即不是 n 个文档（尽管我不介意文档的合并是否在最后完成）。

（我应该补充一点，我不依赖于 MailMerge 概念，例如能够进行替换就可以了 - 尽管显然这需要在最后将文件合并在一起......）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-22T10:01:13.770

我已经以一种非常可怕的方式工作 - 基本上 - 目前，算法如下：

1.  解压docx文件
2.  读入 document.xml（到一个字符串）
3.  字符串。替换字段
4.  重新压缩到临时 docx
5.  合并所有创建的临时文档

合并文档的实际代码来自 Eric White 的博客：http: [//blogs.msdn.com/ericwhite/archive/2009/02/05/move-insert-delete-paragraphs-in-word-processing-documents-using -the-open-xml-sdk.aspx](http://blogs.msdn.com/ericwhite/archive/2009/02/05/move-insert-delete-paragraphs-in-word-processing-documents-using-the-open-xml-sdk.aspx)

# database - 是否有任何支持多线程的本地数据库？

> ID：700709
> 
> 赞同：2
> 
> 时间：2009-03-31T09:09:17.710
> 
> 标签：database, multithreading, delphi

我试过sqlite，通过使用多线程，只有一个线程可以同时更新数据库。我需要多线程同时更新数据库。是否有任何数据库可以完成这项工作？

ps：我用的是delphi6。

* * *

我发现sqlite可以支持多线程，

但是在我对asgsqlite的测试中，当一个线程插入时，其他线程会插入失败。

我还在测试中。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-31T12:33:38.437

SQLite 可用于多线程环境。

看看[**这个链接**](http://www.sqlite.org/threadsafe.html)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-31T12:43:21.503

[Firebird](http://www.firebirdsql.org)可以在嵌入式版本中使用，但在本地使用标准（服务器）安装也没有问题。非常小，易于部署，并发访问。与 Delphi 配合得很好，您应该将其作为一个选项进行研究。

另请参阅 StackOverflow 问题[“在 Delphi 应用程序中使用哪个嵌入式数据库？”](https://stackoverflow.com/questions/222699)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-01T20:03:34.950

Sqlite 在更新时会锁定整个数据库（除非自从我上次使用它以来这已经改变了）。第二个线程不能同时更新数据库（即使使用完全独立的表）。但是，有一个超时参数告诉第二个线程在失败前重试 x 毫秒。我认为 ASqlite 在数据库组件中显示了这个参数（我想我实际上写了那段代码，全部 3 行，但那是几年前的事了）。

将超时设置为大于 0 的值将允许多个线程更新数据库。但是，可能会对性能产生影响。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-31T12:37:14.483

从 3.3.1 版本开始，SQLite 对线程的要求[大大放宽了](http://sqlite.org/faq.html#q6)。在大多数情况下，这意味着它[可以正常工作](http://www.sqlite.org/threadsafe.html)。如果您确实需要更多的并发性，那么使用数据库服务器可能会更好。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-31T12:39:21.637

SQL Server 2008 Express 支持并发以及 SQL Server 的大多数其他功能。它是免费的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-31T12:48:55.657

为什么需要多个线程同时更新呢？我确信 sqlite 将确保更新正确完成，即使这意味着一个线程等待另一个线程完成；这对应用程序是透明的。

实际上，同时更新多个线程很可能对性能没有好处。也就是说，看起来可能有多个线程同时更新，但实际上结果是更新完成的速度比没有更新的慢（因为它们需要持有许多页面锁等以避免出现问题） .

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-31T14:03:38.597

ElevateSoft 的 DBISAM 在多线程模式下工作得非常好，并且具有自动会话命名，使这变得容易。请务必遵循帮助中的页面，了解如何确保一切安全并完成工作。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-31T14:34:28.850

实际上，我目前正在使用 Sybase ASE 上的多线程 Java 进程进行性能测试。该进程解析一个 1GB 的文件并插入到一个表中。

一开始我很害怕，因为许多高级程序员警告我“表锁定”以及并发访问数据库是多么危险。但是我继续进行了测试（因为我想自己找出答案）。

我创建了一个单线程进程并将其与使用 4 个线程的进程进行了比较。我的总执行时间只减少了 20%。我使用不同的线程数和批量插入大小重试了该过程。我可以挤压的最大值是 20%。

我们将很快切换到 Oracle，因此我将分享 Oracle 在发生这种情况时如何处理并发插入。

# unit-testing - 为现有代码组织单元测试

> ID：700712
> 
> 赞同：0
> 
> 时间：2009-03-31T09:09:51.563
> 
> 标签：unit-testing

我最近收到了一项新任务，即使用 MS Visual Studio 维护和改进用 C++ 编写的现有代码。代码构建到 exe 文件（不是 dll）中。我想为代码添加单元测试，我遇到的问题是如何组织我的测试项目。基本上我想要两个项目，一个是我收到的原始项目，第二个是测试项目。

我在互联网上看到，通常当被测试的主题被构建到一个 dll 中时，你必须在你的测试项目中静态链接从主项目构建的 lib 并且你可以访问被测试的函数。但是，当被测对象是 exe 文件时，如何做到这一点呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-31T12:51:06.930

当然，您可以将解决方案安排到共享代码的项目中，其中一个项目输出到 exe，而另一个项目输出到 DLL？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-04-05T09:57:44.393

无论项目可交付成果是什么，单元测试都在测试最小的单元：功能。单元测试通常遵循 tripe A 模式：安排（为测试创建环境）、执行（调用被测方法）、断言（验证方法的行为是否符合预期）。

有几种可能的项目结构：修改项目，使其编译成 DLL、生产可执行文件和单元测试程序。可执行源必须尽可能小，可能只是`main()`创建`Application`对象的函数。也可以有三个项目，一个用于 DLL，一个用于应用程序，第三个用于测试。

另一种方法是将单元测试嵌入到可执行文件中，并有一种方法可以调用它们，例如使用特殊`--unit-test`参数。

# struts2 - 在 Struts 2 中创建导航链接

> ID：700720
> 
> 赞同：0
> 
> 时间：2009-03-31T12:33:14.337
> 
> 标签：struts2

有什么方法可以复制 Rails 的“链接到除非电流”吗？

IE。如果我的导航中有一个链接列表，并且我想用不同的 css 样式标记当前页面（或者甚至是纯文本，而不是链接）？

现在我刚刚在我的操作类 (getPage()) 中创建了一个方法，它返回一个我为每个操作分配的名称，并在构建我的导航时对其进行测试......有效但不漂亮，我必须手动设置页面名称（无法以某种方式自动从上下文中获取它）。

使用 Struts 2、Tiles、JSP + Struts 标签库。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-07-07T21:41:39.097

要获取当前 url，您可以使用不带任何参数、操作等的 Url 标签：

```
<s:url var="currenturl" includeParams="get" escapeAmp="false"/> 
```

然后假设您构建导航网址，例如：

```
<s:url var="url" action="someAction" escapeAmp="false">
    <s:param name="id" value="id"/>
</s:url> 
```

然后，您可以使用普通的 if 标记来测试当前 url 是否与您构建的匹配。

```
<s:if test="#url eq #currenturl">
</s:if> 
```

例如，要更改类，您可以对锚定义进行条件内联：

```
<a href="<s:property value="#url"/>" <s:if test="#url eq #currenturl">class="current"</s:if>>XXX</a> 
```

如果您的 URL 中的参数对导航有意义，则使用 includeParams="get" 否则排除它并使用 if like：

```
<s:if test="#url.startsWith(#currenturl)"> 
```

# c# - 通过 .Net 应用程序在 Windows 中全局处理打印屏幕

> ID：700723
> 
> 赞同：0
> 
> 时间：2009-03-31T12:35:23.473
> 
> 标签：c#, .net, keyboard-shortcuts

如何使我的 C# 应用程序成为 Windows 中的默认“打印屏幕”处理程序？

我编写了一个屏幕捕获实用程序，理想情况下，我希望让它替换默认的打印屏幕处理程序，或者有一个独特的组合键来触发它。

我知道如何使用全局钩子等在 C++ 中执行此操作，但我不清楚如何在 .Net 中执行此操作。此外，如果有一种方法可以在不使用内存驻留应用程序的情况下做到这一点，那就太好了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-31T13:10:19.253

只要您使用 WM_KEYBOARD_LL 挂钩来捕获 PrintScreen 键，就没有理由不能在 C# 中执行此操作。它是可在托管代码中使用的少数全局挂钩之一，因为它不需要将 DLL 注入每个目标进程。相反，上下文将切换回原始应用程序进行处理。

Adam 的博客有一篇关于如何在 C# 中设置这样一个钩子的精彩文章：[http ://www.seesharpdot.net/?tag=wh_keyboard_ll](http://www.seesharpdot.net/?tag=wh_keyboard_ll)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-31T12:46:12.400

为什么不将[AutoHotKey](http://www.autohotkey.com/)（开源，免费）与以下脚本一起使用？

该脚本取自[AutoHotKey](http://www.autohotkey.com/)的新闻组，它将映射打印屏幕以使用 IrfanView。您可以使用它来触发您的程序。

```
~printscreen::
ifexist,%screenshot1%\irfanview.exe
    {
    run, "%screenshot1%\irfanview.exe" "/capture=0 /convert=%screenshots%\%A_now%_screenshot.jpg"
   sleep,500
   run,%screenshots%  ;open folder
   return
    }
return

~!printscreen::       ;copy only active window
ifexist,%screenshot1%\irfanview.exe
    { 
```

# c# - 非标准形状抗锯齿 WPF 窗口

> ID：700727
> 
> 赞同：0
> 
> 时间：2009-03-31T12:37:33.123
> 
> 标签：c#, .net, wpf, antialiasing, region

我正在使用 C# 创建一个非标准形状的 WPF 窗口，并且由于“ *AllowTransparency=True* ”的一些问题，我使用了**CreateRoundRectRgn**、**CreateEllipticRgn**和**SetWindowRgn** win32 API[区域函数](http://www.codeproject.com/KB/GDI/rgnguide.aspx)，但是有一个问题导致边缘不像你那样平滑可以在这里的图片中看到[http://img17.imageshack.us/img17/206/sampley.png](http://img17.imageshack.us/img17/206/sampley.png)：

[替代文字 http://img17.imageshack.us/img17/206/sampley.png](http://img17.imageshack.us/img17/206/sampley.png)

如何实现抗锯齿以使边缘看起来更平滑？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-31T13:41:49.663

您不能，抗锯齿边缘需要每个像素的 Alpha 通道（AllowTransparency=true 所做的） - 但是当您打开该选项时（使用 AllowTransparency 或通过调用 Win32 API，结果是相同的）您进入一大堆麻烦——就像你已经发现的那样。

# c++ - Qt4.4如何获取用户设置路径

> ID：700731
> 
> 赞同：18
> 
> 时间：2009-03-31T12:40:45.363
> 
> 标签：c++, qt

*   linux：`$HOME/.config`
*   视窗：`%APPDATA%`
*   苹果系统：`$HOME/.config`

可以使用[http://qt-project.org/doc/qt-4.8/qsettings.html#setPath](http://qt-project.org/doc/qt-4.8/qsettings.html#setPath)进行设置，但似乎我无法检索它。

[http://qt-project.org/doc/qt-4.8/qlibraryinfo.html#location](http://qt-project.org/doc/qt-4.8/qlibraryinfo.html#location) `QLibraryInfo::LibrariesPath`返回系统范围的设置目录，这不是我想要的。

有什么想法，还是我必须为每个平台单独编码？

€：我想创建一个子目录，并将文件存储到其中。（如果这是一个坏主意，你可以惩罚我）

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-03-31T16:55:46.420

这可能无法直接回答您的问题：如果您想存储每个用户的持久数据，您不应该使用[QDesktopServices::storageLocation(QDesktopServices::DataLocation)](http://qt-project.org/doc/qt-4.8/qdesktopservices.html#storageLocation)吗？

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-27T11:10:15.987

这是一个讨厌的解决方法。首先你创建`QSettings`，然后获取它的位置。

```
QSettings cfg(QSettings::IniFormat, QSettings::UserScope,
       "organization", "application");

QString config_dir = QFileInfo(cfg.fileName()).absolutePath() + "/"; 
```

积分转到 Qt 中心论坛。

`QSettings`将默认配置存储在用户 AppData 目录中。请参阅[`QSettings`](http://qt-project.org/doc/qt-4.8/qsettings.html). 此代码还指示以 Ini 文件格式存储配置。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-11-29T12:29:20.670

这适用于 qt 4 和 qt 5

```
QApplication::setApplicationName("MyApp");
QApplication::setOrganizationName("Me");

QString homePath;

#if QT_VERSION >= 0x050000
    homePath = QStandardPaths::writableLocation(QStandardPaths::DataLocation);
#else
    homePath = QDesktopServices::storageLocation(QDesktopServices::DataLocation);
#endif 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-31T13:14:00.337

据我所知，您无法检索路径。在 Qt 源码中`src/corelib/io/qsettings.cpp`，有一个获取路径的函数：

```
static QString getPath(QSettings::Format format, QSettings::Scope scope)
{
    ... 
```

但它不能从使用 Qt 的代码中访问。您也不能复制和使用它，因为它使用内部 Qt 全局变量来存储路径......

编辑：发布了一个解决方案，使用`QDesktopServices.storageLocation(QDesktopServices.DataLocation)`但它并没有完全满足问题的要求，即如果我使用`QSettings.setPath()`它设置自定义路径并不能反映更改。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-31T16:43:59.007

为什么需要知道设置路径？如果要在其中放置设置，则可以使用`QSettings`. 我可以看到创建一个子目录来保存各种设置，但似乎最简单的方法是`QSettings`直接使用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-31T12:49:00.337

你在哪个平台？
可能相关或不相关，但在 Windows 中，默认是将 QSettings 写入注册表。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-31T14:07:49.333

我对这个问题的了解比最初发布的要多。修改后更清晰。好的，所以你不能使用..

```
QString QSettings::fileName () const 
```

返回使用此`QSettings`对象写入设置的路径。

在 Windows 上，如果格式为`QSettings::NativeFormat`，则返回值为系统注册表路径，而不是文件路径。

# c++ - 是否有设计好的类模板的通用规则？

> ID：700735
> 
> 赞同：2
> 
> 时间：2009-03-31T12:42:40.740
> 
> 标签：c++, templates

我在一个部门工作，人们创建（或选择）他们在小型软件中实现的算法，以优化一些与领域相关的目标。我的大多数同事都比编程更了解数学建模和求解器。

我个人有几年开发 C++ 类模板的经验。我几乎知道如何设计代表算法的类模板，但我无法设计我同事编写的每一件软件（没有足够的时间，没有足够的兴趣）。

因此，我的目标是尝试教我的同事如何将他们想到的功能和算法转化为类模板。模板参数可以是结构类型或策略类。我觉得我需要想出一套“做/不做”的规则，但我似乎无法发明它们。

对我来说，一个好的类模板设计的目标是最大限度地提高可读性。

你个人有设计好的类模板的规则吗？从功能描述到类模板设计是否有正确的过程？

**编辑**

是的，很难让人们使用模板进行编程。我正在研究它并开发一个框架以使模板实例化尽可能图形化，并提供指南（并提供日常帮助）以使模板编程尽可能简单。但这里的问题只是关于设计，我认为这是一个完全不同的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-31T12:45:16.537

在你的情况下，我会开发一种框架，让你的同事只考虑公式、数学和求解器。

我认为所有“擅长数学”的人如果他们的工作不仅仅是实现数学函数，那么他们应该了解“设计模式：可重用的面向对象软件的元素”。

您还可以让您的同事注意提升算法。您可以采用一个[图形库](http://www.boost.org/doc/libs/1_38_0/libs/graph/doc/index.html)来满足您的项目需求。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-31T12:48:16.547

我不想在你的游行中下雨，但根据我的经验，试图让非程序员（或那些编程不是他们主要“事情”的人）对像用 C++ 编写好的模板代码这样相对神秘的东西感兴趣是一个西西弗任务。

哎呀，我在一个拥有大量非常优秀的 C++ 程序员的部门工作，即便如此，让组织承诺采用新技术并不总是那么容易。如果你的人是优秀的数学家，并且知道足够的编程知识，那么试图强加他们需要编写通用 C++ 的命令将是一个非常艰难的销售。

我会努力听从 Mykola 的建议，并尝试提出某种通用算法框架，以最大限度地减少他们需要做的原始模板编码；这可能是克服对不可避免的看法的抵制的最佳方法，即您只是在向他们推销更多的工作。

# visual-studio - VS2008：具有代码覆盖率的单元测试不适用于 /CLR

> ID：700736
> 
> 赞同：3
> 
> 时间：2009-03-31T12:42:43.063
> 
> 标签：visual-studio, visual-studio-2008, clr, c++-cli, code-coverage

我正在尝试在 VS2008 中设置具有代码覆盖率的单元测试，用于使用**/clr**编译的 C++/CLI DLL （不是 /clr:safe 或 /clr:pure - 它必须是 /clr，因为它使用 MFC） .

单元测试运行良好，但覆盖信息仅在我使用 /clr:safe 或 /clr:pure 编译时才有效。对于 /clr，*代码覆盖结果*窗口显示以下消息：

> 生成空结果：未使用任何已检测的二进制文件。查看任何仪器问题的测试运行详细信息。

我也尝试过“[去越野](http://blogs.msdn.com/ms_joc/articles/406608.aspx)”，但是当我将覆盖文件加载到 VS 中时，它也包含空结果。

恼人的是，我找不到任何具体说明代码覆盖率是否与 /CLR 一起使用的地方，所以我只好自己尝试一下。

如果它应该工作，谁能看到我在这里做错了什么？

* * *

[File]->[New]->[Project]
选择*Class Library*，输入*MyProj*作为项目名称，点击 OK

右键单击 MyProj 项目，选择 [Properties]
选择 [Configuration Properties]->[General]
确保“Common Language Runtime support”设置为**/CLR**

将此代码添加到*Class1*：

```
public:
    static int calc() { return 69; } 
```

构建解决方案

【测试】->【新建测试】->【单元测试】，点击确定，点击创建

将此代码添加到*TestMethod1*：

```
Assert::AreEqual(MyProj::Class1::calc(), 69); 
```

右击TestProject1项目，选择【References】
点击“Add New Reference”在“Projects”选项卡中
选择*MyProj*，点击OK，再次点击OK

[Test]->[Edit Test Run Configuration]->[Local Test Run]
选择[Code Coverage]
Check *MyProj.dll*，点击Apply，点击Close

[测试]->[运行]->[解决方案中的所有测试]

*测试结果*窗口显示 TestMethod1 已通过。*代码覆盖结果*窗口显示以下消息
：

 *> 生成空结果：未使用任何已检测的二进制文件。查看任何仪器问题的测试运行详细信息。

* * *

右键单击 MyProj 项目，选择 [Properties]
选择 [Configuration Properties]->[General] 将
“Common Language Runtime support”更改为**/CLR:SAFE**或**/CLR:PURE**，单击 OK

构建解决方案

[测试]->[运行]->[解决方案中的所有测试]

*测试结果*窗口显示 TestMethod1 已通过。*代码覆盖率结果*
窗口现在显示正确的覆盖率信息。

 ** * *

## 回答 #1

> 赞同：0
> 
> 时间：2011-01-24T04:09:18.630

是的，我认为这一切都必须在 CLR:Safe 项目中才能工作。我不完全明白为什么，但我和你在同一条船上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-02-27T15:05:20.397

基于[http://msdn.microsoft.com/en-us/library/ms182534.aspx](http://msdn.microsoft.com/en-us/library/ms182534.aspx)

1-项目必须处于调试状态

2.-在项目属性中你必须选择x 86平台。

3 在 GAC 中取消注册正在测试的项目。

# asp.net - 动态gridview列事件问题

> ID：700741
> 
> 赞同：0
> 
> 时间：2009-03-31T12:44:05.307
> 
> 标签：asp.net, gridview, dynamic

我有一个 GridView （可选），我想在所选行下方的新行中生成动态 GridView。

1.  我可以在 Gridview1 PreRender 事件中动态添加行和网格视图。我需要使用这个事件，因为：
    *   _OnDataBound 不会在每次回发时调用（对于 _OnRowDataBound 也是如此）
    *   _OnInit 是不可能的，因为 Gridview 的“内部表”是在 Init 之后添加的
    *   _OnLoad 是不可能的，因为尚未选择“选定”行。
2.  我可以根据我的 ITemplate 类将列添加到动态 GridView 中。但是现在按钮事件不会触发....有什么建议吗？

gridview的动态添加：

```
Private Sub GridView1_PreRender(ByVal sender As Object, ByVal e As System.EventArgs) Handles GridView1.PreRender
    Dim g As GridView = sender
    g.DataBind()

    If g.SelectedRow IsNot Nothing AndAlso g.Controls.Count &gt; 0 Then
        Dim t As Table = g.Controls(0)
        Dim r As New GridViewRow(-1, -1, DataControlRowType.DataRow, DataControlRowState.Normal)
        Dim c As New TableCell

        Dim visibleColumnCount As Integer = 0

        For Each d As DataControlField In g.Columns
            If d.Visible Then
                visibleColumnCount += 1
            End If
        Next

        c.ColumnSpan = visibleColumnCount
        Dim ph As New PlaceHolder

        ph.Controls.Add(CreateStockGrid(g.SelectedDataKey.Value))

        c.Controls.Add(ph)

        r.Cells.Add(c)
        t.Rows.AddAt(g.SelectedRow.RowIndex + 2, r)
    End If
End Sub

Private Function CreateStockGrid(ByVal PnmAutoKey As String) As GridView

    Dim col As Interfaces.esColumnMetadata
    Dim coll As New BLL.ViewStmCollection
    Dim entity As New BLL.ViewStm
    Dim query As BLL.ViewStmQuery = coll.Query

    Me._gridStock.AutoGenerateColumns = False

    Dim buttonf As New TemplateField()
    buttonf.ItemTemplate = New QuantityTemplateField(ListItemType.Item, "", "Button")
    buttonf.HeaderTemplate = New QuantityTemplateField(ListItemType.Header, "", "Button")
    buttonf.EditItemTemplate = New QuantityTemplateField(ListItemType.EditItem, "", "Button")

    Me._gridStock.Columns.Add(buttonf)

    For Each col In coll.es.Meta.Columns
        Dim headerf As New QuantityTemplateField(ListItemType.Header, col.PropertyName, col.Type.Name)
        Dim itemf As New QuantityTemplateField(ListItemType.Item, col.PropertyName, col.Type.Name)
        Dim editf As New QuantityTemplateField(ListItemType.EditItem, col.PropertyName, col.Type.Name)

        Dim f As New TemplateField()

        f.HeaderTemplate = headerf
        f.ItemTemplate = itemf
        f.EditItemTemplate = editf

        Me._gridStock.Columns.Add(f)
    Next

    query.Where(query.PnmAutoKey.Equal(PnmAutoKey))

    coll.LoadAll()

    Me._gridStock.ID = "gvChild"
    Me._gridStock.DataSource = coll
    AddHandler Me._gridStock.RowCommand, AddressOf Me.gv_RowCommand

    Me._gridStock.DataBind()

    Return Me._gridStock
End Function 
```

ITemplate 类：

```
Public Class QuantityTemplateField : Implements ITemplate
Private _itemType As ListItemType
Private _fieldName As String
Private _infoType As String

Public Sub New(ByVal ItemType As ListItemType, ByVal FieldName As String, ByVal InfoType As String)
    Me._itemType = ItemType
    Me._fieldName = FieldName
    Me._infoType = InfoType
End Sub

Public Sub InstantiateIn(ByVal container As System.Web.UI.Control) Implements System.Web.UI.ITemplate.InstantiateIn
    Select Case Me._itemType
        Case ListItemType.Header
            Dim l As New Literal
            l.Text = "&lt;b&gt;" & Me._fieldName & "</b>"
            container.Controls.Add(l)
        Case ListItemType.Item
            Select Case Me._infoType
                Case "Button"
                    Dim ib As New Button()
                    Dim eb As New Button()
                    ib.ID = "InsertButton"
                    eb.ID = "EditButton"
                    ib.Text = "Insert"
                    eb.Text = "Edit"
                    ib.CommandName = "Edit"
                    eb.CommandName = "Edit"
                    AddHandler ib.Click, AddressOf Me.InsertButton_OnClick
                    AddHandler eb.Click, AddressOf Me.EditButton_OnClick
                    container.Controls.Add(ib)
                    container.Controls.Add(eb)
                Case Else
                    Dim l As New Label
                    l.ID = Me._fieldName
                    l.Text = ""
                    AddHandler l.DataBinding, AddressOf Me.OnDataBinding
                    container.Controls.Add(l)
            End Select
        Case ListItemType.EditItem
            Select Case Me._infoType
                Case "Button"
                    Dim b As New Button
                    b.ID = "UpdateButton"
                    b.Text = "Update"
                    b.CommandName = "Update"
                    b.OnClientClick = "return confirm('Sure?')"
                    container.Controls.Add(b)
                Case Else
                    Dim t As New TextBox
                    t.ID = Me._fieldName
                    AddHandler t.DataBinding, AddressOf Me.OnDataBinding

                    container.Controls.Add(t)
            End Select
    End Select
End Sub

Private Sub InsertButton_OnClick(ByVal sender As Object, ByVal e As EventArgs)
    Console.WriteLine("insert click")
End Sub

Private Sub EditButton_OnClick(ByVal sender As Object, ByVal e As EventArgs)
    Console.WriteLine("edit click")
End Sub

Private Sub OnDataBinding(ByVal sender As Object, ByVal e As EventArgs)
    Dim boundValue As Object = Nothing
    Dim ctrl As Control = sender
    Dim dataItemContainer As IDataItemContainer = ctrl.NamingContainer
    boundValue = DataBinder.Eval(dataItemContainer.DataItem, Me._fieldName)

    Select Case Me._itemType
        Case ListItemType.Item
            Dim fieldLiteral As Label = sender
            fieldLiteral.Text = boundValue.ToString()
        Case ListItemType.EditItem
            Dim fieldTextbox As TextBox = sender
            fieldTextbox.Text = boundValue.ToString()
    End Select
End Sub
End Class 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-03-29T01:01:07.217

哦，我的哦，我去了 MVC，任何阅读这个问题的人都应该这样做:)

# networking - 在 Ubuntu 中，我如何确定哪个进程是网络猪

> ID：700743
> 
> 赞同：21
> 
> 时间：2009-03-31T12:44:41.220
> 
> 标签：networking, ubuntu

使用 top 很容易识别占用内存和 cpu 的进程，但偶尔我会看到我的计算机的网络活动峰值，但我无法确定哪个进程正在生成活动。在哪里寻找这些信息的正确位置？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2009-05-08T11:03:10.863

您还可以查看“NetHogs”：[http](http://nethogs.sourceforge.net/) ://nethogs.sourceforge.net/ 。小但非常方便的实用程序。特别是如果您想找出哪个进程占用了带宽。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-03-31T12:47:54.427

您可以安装多个应用程序来实时监控网络流量。[NTOP](http://www.ntop.org/)、[tcpdump](http://www.tcpdump.org/)、[trafshow](http://linux.maruhn.com/sec/trafshow.html)、[iptraf](http://iptraf.seul.org/)。

我会选择 NTOP 或 IPTRAF。但这只是个人口味。

此外，使用 Linux 的[netstat](http://linux.die.net/man/8/netstat)，您可以使用**-p**标志来查看进程使用了​​多少连接。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-25T17:45:25.293

您也可以使用[iftop](http://www.ex-parrot.com/~pdw/iftop/)。在 Ubuntu 中，您可以通过输入终端来安装它：`sudo aptitude install iftop`. 要使用 type: `sudo iftop -i eth0`，其中 eth0 是您的网络接口。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-30T11:55:22.490

包“nmon”提供了一个与 top 类似的工具。设计有点不同，因为内核没有通过 /proc 提供出色的统计信息。

```
Description: performance monitoring tool for Linux
 nmon is a systems administrator, tuner, benchmark tool.
 It can display the CPU, memory, network, disks (mini graphs or numbers), 
```

还有 iftop：

```
Description: displays bandwidth usage information on an network interface
 iftop does for network usage what top(1) does for CPU usage. It listens to
 network traffic on a named interface and displays a table of current bandwidth 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-08T21:00:16.113

lsof -i -n -P 为每个连接提供进程和端点...

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-04T19:36:42.537

对 Pablo Santa Cruz 的小修正-

在 linux 上：netstat -p 给出在端口上运行的程序的 pid。在 BSD 上： netstat -p 用于指定协议。

# xml - 与在 Dom4J 中使用 DOM 相比，XPath 的效率如何？

> ID：700747
> 
> 赞同：5
> 
> 时间：2009-03-31T12:45:35.443
> 
> 标签：xml, dom, xpath, dom4j

例如考虑以下 xml

```
<root>
  <childNode attribute1="value1">
     <grandChildNode attrib1="val1" attrib2="val2">some content1
     </grandChildNode>
     <grandChildNode attrib1="val1" attrib2="val2">some content2
     </grandChildNode>
     <grandChildNode attrib1="val1" attrib2="val2">some content3
     </grandChildNode>
  </childNode>
  <childNode attribute1="value1">
     <grandChildNode attrib1="val1" attrib2="val2">some content1
     </grandChildNode>
     <grandChildNode attrib1="val1" attrib2="val2">some content2
     </grandChildNode>
     <grandChildNode attrib1="val1" attrib2="val2">some content3
     </grandChildNode>
  </childNode>
  <childNode attribute1="value1">
     <grandChildNode attrib1="val1" attrib2="val2">some content1
     </grandChildNode>
     <grandChildNode attrib1="val1" attrib2="val2">some content2
     </grandChildNode>
     <grandChildNode attrib1="val1" attrib2="val2">some content3
     </grandChildNode>
  </childNode>
</root> 
```

使用 DOM 获取根节点，然后循环遍历 childNode 和 grandChildNode 是否有效，或者使用 XPath 表达式收集子节点和 grandChild 节点的详细信息是否有效？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-07T10:33:28.087

如果您想完整地处理一个 XML 文档，那么在反序列化时间、CPU 使用率和内存使用率方面，将 XML 解析为 DOM 几乎总是效率最低的。

解析为 DOM 需要大约 10-15 倍的内存量，因为 XML 文档需要磁盘空间。例如，一个 1 兆字节的 XML 文档将解析为一个占用 10-15 兆字节内存的 DOM。

仅当您打算修改部分或全部数据然后将结果放回 XML 文档时才解析为 DOM。对于所有其他用例，DOM 是一个糟糕的选择。

XPath 通常占用的资源要少得多，但这取决于文档的长度（即您有多少“childNode”元素）以及您感兴趣的数据在文档中的位置。

XPath 内存使用和完成时间往往会随着文档的深入而增加。例如，假设您有一个包含 20,000 个 childNode 元素的 XML 文档，每个 childNode 都有一个您事先知道的唯一标识符，并且您想从文档中提取一个已知的 childNode。提取第 18,345 个子节点将使用比提取第 3 个更多的内存。

因此，如果您使用 XPath 提取所有 childNode 元素，您可能会发现它的效率低于解析为 DOM 的效率。XPath 通常是一种提取 XML 文档的一部分的简单方法。我不推荐使用它来处理所有的 XML 文档。

到目前为止，如果您确实希望提取和处理 XML 文档中的所有数据，那么最好的方法是使用基于 SAX 的阅读器。这将比任何其他方法都快几个数量级，并且资源占用更少。

也就是说，它还取决于您正在处理的数据量。对于您提供的示例 XML 文档，您不会注意到任何实际差异。是的，DOM 会“慢”而 SAX 会“快”，但我们说的是毫秒或微秒的差异。

SAX 可以轻松地比 DOM 快数百或数千倍，但是如果这是 2 微秒和 2 毫秒之间的差异，您将不会注意到。当您处理包含 20,000 个 childNode 元素的文档时，2 秒与 200 秒将成为更大的问题。

# java - 如何比较数组中的值？

> ID：700748
> 
> 赞同：0
> 
> 时间：2009-03-31T12:45:37.567
> 
> 标签：java, arrays

如何比较数组中的值？

我有一个名为 list 的数组，其中包含 12 个元素。我查看索引 0 中的值是否等于或不等于索引 2 中的值。

我已经尝试过这段代码，但它似乎不起作用。

```
if ((list.get(0)==list.get(2) && list.get(1)==list.get(3)) 
{
   System.out.println("equal")
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-31T12:49:15.060

如果它*真的*是一个数组，你想要：

```
if (list[0] == list[2] && list[1] == list[3]) 
```

请注意，如果数组是引用类型，则按引用标识进行比较，而不是相等。你可能想要：

```
if (list[0].equals(list[2])) && list[1].equals(list[3])) 
```

尽管如果任何值为空，那将会爆炸。您可能需要一个辅助方法来解决这个问题：

```
public static objectsEqual(Object o1, Object o2)
{
    if (o1 == o2)
    {
        return true;
    }
    if (o1 == null || o2 == null)
    {
        return false;
    }
    return o1.equals(o2);
} 
```

然后：

```
if (objectsEqual(list[0], list[2]) && objectsEqual(list[1], list[3])) 
```

如果你真的有一个`ArrayList`而不是一个数组，那么以上所有内容仍然有效，只是在每个地方使用`list.get(x)`而不是。`list[x]`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-31T12:51:26.210

```
if(list[0] == list[2] && list[1] == list[3]){
    System.out.println("equal");
} 
```

如果它们是字符串：

```
if(list[0].equals(list[2]) && list[1].equals(list[3])){
    System.out.println("equal");
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-31T12:49:22.580

您正在比较对象引用，而不是对象本身。您需要使用方法调用。所有类都继承`equals()`自根`Object`类，因此它可能会起作用：

```
if(list.get(0).equals(list.get(2)) && list.get(1).equals(list.get(3)))
{
   System.out.println("equal");
} 
```

[这篇文章](http://leepoint.net/notes-java/data/expressions/22compareobjects.html)似乎是对其他可用比较方法的一个很好的总结。

# c# - 在 Asp.Net 中向 DataGrid 动态添加复选框

> ID：700749
> 
> 赞同：0
> 
> 时间：2009-03-31T12:45:42.323
> 
> 标签：c#, asp.net

我正在将复选框动态添加到 DataGrid。我想为这个动态生成的复选框生成事件？关于如何做到这一点的任何建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-31T12:48:15.390

```
 void Check_Clicked(Object sender, EventArgs e) 
  {
  }

  checkbox1.CheckedChanged += new EventHandler(this.Check_Clicked); 
```

# java - 如何（正确）使用 String.format %tz 报告时区？

> ID：700751
> 
> 赞同：4
> 
> 时间：2009-03-31T12:46:25.130
> 
> 标签：java

如果我执行：

```
System.out.println("Formatter: " + String.format("%1$tH:%1$tM:%1$tS %1$tz %1$tZ", now));
System.out.println("SimpleDF : " + new SimpleDateFormat("HH:mm:ss Z z").format(now)); 
```

我希望结果是一样的。如果我检查自动调整夏令时，值开始变化：

```
没有 dst（如预期的那样，gmt=9:48）：
格式化程序：10:48:16 +0100 GMT+01:00
简单DF：10:48:16 +0100 GMT+01:00
使用 dst（gmt 在格式化程序和 sdf 之间变化？？？）：
格式化程序：11:47:54 +0100 CEST
SimpleDF : 11:47:54 +0200 CEST

```

在 win xp 上运行，在 java 1.6-10/13 和 1.5.0-14 上的结果相同，语言环境为 en_US。你怎么看，一个错误？

也许相关：[http](http://bugs.sun.com/view_bug.do?bug_id=6286592) ://bugs.sun.com/view_bug.do?bug_id=6286592 。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-01T11:43:33.717

正确的方法是使用`SimpleDateFormat`（或者更确切地说是一个`DateFormat`）对象。String.format 用于格式化作为对`toString()`传递的对象调用方法的结果返回的字符串。第一行代码可以分解为，

```
String temp = now.toString();
System.out.println("Formatter: " + String.format("%1$tH:%1$tM:%1$tS %1$tz %1$tZ", temp)); 
```

临时字符串对象使用默认语言环境和设置进行格式化，因此可能无法保证完美的结果（根据我的经验）。

`SimpleDateFormat()`处理`Date`对象并访问属性并确保所有 DST 补丁。

# javascript - jQuery中的链接选择器

> ID：700752
> 
> 赞同：27
> 
> 时间：2009-03-31T12:47:06.877
> 
> 标签：javascript, jquery, css-selectors, method-chaining

我是一个习惯于 mootools 链接选择器的人，我似乎无法在任何地方找到如何在 jQuery 中做同样的事情。假设我在变量中有一个*选择元素。*`selectObj`我需要的是获得该选择中的最后一个选项。在 mootools 我会做类似的事情：

```
var option = $(selectObj).getElement('nth-child(last)') 
```

我可以做类似的事情，或者`option`在 jQuery 中获得最后一个的方法是什么？

PS。我知道[parent > child 选择器](http://docs.jquery.com/Selectors/child#parentchild)，但我不能真正使用它，因为我不知道使用什么选择器来获取`select`. 我只有结果元素。

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2009-03-31T12:55:41.863

```
$(selectObj).find(':last') 
```

您可以使用[`find`](http://docs.jquery.com/Traversing/find#expr)在当前查询中执行另一个查询。

通常，当您尝试了解如何选择某些内容时，可以查看 jQuery 文档上的[Selectors](http://docs.jquery.com/Selectors)和[Traversal页面。](http://docs.jquery.com/Traversing)

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-03-31T12:49:26.667

```
var option = $(selectObj).children(":last"); 
```

将返回任何元素的最后一个子元素

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-26T10:35:02.320

您也可以`.last()`用于此目的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-31T12:50:01.517

jQuery 有[:last 选择器](http://docs.jquery.com/Selectors/last)

```
$("tr:last").stuff() 
```

将对表格的最后一行做一些事情。

# javascript - 如何通过 PHP 在新窗口中打开外部链接？

> ID：700757
> 
> 赞同：0
> 
> 时间：2009-03-31T12:47:58.637
> 
> 标签：javascript, html

我想通过 php 将所有外部链接打开到新窗口/标签中，而无需触及每个外部链接代码。如果没有 target="blank"，我不想这样做。

我可以通过 javascript 做到这一点，但我想知道是否有 PHP 解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-31T12:59:45.723

PHP 无法完成这项工作。PHP 在服务器端，而您的问题需要与客户端交互。这是一个经典的事情，你会使用 javascript。

如果您使用 JQuery，事情变得非常简单：

```
// pretend you have links in your page <a href="link.htm" rel="external">Link</a>
// please note that the rel-value can be chosen at will
$(document).ready(function(){
    $('a[rel="external"]').click(function() {
        window.open(this.href, '_blank');
        return false;
    });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-31T12:49:30.787

不确定我是否正确，但如果您正在寻找“target=blank”的 JS 替代品，那么这个可以工作并且 xhtml 有效：

onclick="window.open(this.href, '_blank'); 返回 false;"

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-02-29T21:16:20.633

[基本目标](https://developer.mozilla.org/en/HTML/Element/base)应该为您完成。

# sql - 数据库复制 MSSQL 2000 到 2005

> ID：700770
> 
> 赞同：2
> 
> 时间：2009-03-31T12:49:54.450
> 
> 标签：sql, sql-server, database, sql-server-2005, replication

我正在尝试将数据库从 SQL Server 2000 复制到 2005，它们位于运行 Windows Server 2003 R2 的两台不同服务器上。我使用 SERVER1(SQL2000) 作为事务发布者和分发者，而 SERVER2(SQL2005) 是订阅者。我可以设置发布和订阅，但是当我尝试同步它们时，我收到以下错误：

SERVER1-TestReplication-TestReplication-IBSCNVII-ReplicationCNVII_2-99956FE2-402A-48D5-B801-2CBADF12BD3E 具有服务器访问权限（原因：无法获取有关 Windows NT 组/用户 '' 的信息，错误代码 0x5。[SQLSTATE 42000]（错误 15404） ）。

我需要将我的域用户添加到服务器上的某个用户组吗？有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T02:50:38.730

0x5 表示“拒绝访问”，并且不允许您查询 Active Directory 用户信息。很可能，sql server 服务帐户没有适当的域权限来在 AD 中执行查找。这可能是由于帐户密码已过期，因此无法启用 SQL 来验证 AD 或其他一些问题，例如作为本地系统而不是域帐户运行的服务。

我建议确认两个 SQL 服务器都使用有效的域帐户，而不是本地系统。然后检查该域帐户是否未锁定或过期。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-31T12:56:42.047

确保您用于执行复制的服务帐户对您的两个 SQL 服务器具有适当的权限

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-01T20:18:29.670

是的，请检查 services.msc 中的 SqlAgent 帐户。确保它是具有权限的用户（在域和 SQL 中）。如果这样可以解决问题，请确保在投入生产之前查找所需的最低权限。

# visual-studio-2008 - VC++ 2005/2008 调试器可视化工具将如何停止工作？

> ID：700778
> 
> 赞同：0
> 
> 时间：2009-03-31T12:50:19.257
> 
> 标签：visual-studio-2008, visual-c++

我突然发现 Debugger 可视化工具不适用于 vector、set 等 STL 容器。除了观察窗口显示的东西好像可视化器不存在外，没有任何东西损坏。但它们在那里，autoexp.dat 位于 C:\program files\Microsoft Visual Studio 9.0\Common7\Packages\Debugger。他们曾经工作，我不知道什么时候停止。

我并排安装了 VC++ 2005 和 2008。两者以前都工作过，但现在都没有。

有没有人有任何线索？（对于那些不知道什么是可视化工具的人，请参阅[此链接](http://www.codeguru.com/columns/kate/article.php/c15291__1/)）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-01T03:22:51.187

终于自己找到了答案，只要打开visual studio命令提示符，运行这个命令：

* * *

c:\Program Files\Microsoft Visual Studio 9.0\VC>devenv /ResetSettings

* * *

这实际上将 IDE 重置为新安装的阶段。

现在一切似乎都很好。

# mysql - 5.0.12 更改后的 MySQL LEFT JOIN - 如何重写查询

> ID：700779
> 
> 赞同：0
> 
> 时间：2009-03-31T12:50:30.097
> 
> 标签：mysql, join, mysql-error-1054

在 5.0.12 之后，MySQL 更改了左连接的语法以匹配 SQL2003 标准。所以

```
... FROM t1 , t2 LEFT JOIN t3 ON (expr) 
```

需要重写为

```
... FROM (t1 , t2) LEFT JOIN t3 ON (expr 
```

否则它将被解析为`... FROM t1 , (t2 LEFT JOIN t3 ON (expr))`

现在，我有一个从 MySQL 3.23（eek！）移植到 5.1 的古老应用程序，旧代码有这个查询：

```
select b.*, c.*, g.*, p.perfname, p.persname 
from bookings b, customer c 
left join grade g on b.chrggrade=g.grcode 
left join person p on b.person=p.percode 
where complete='Y' and invoiced='N' 
and datemade between '2009-03-25' and '2009-03-31' 
and c.custcode=b.cust 
order by cust, person, tsref, stdt 
```

这将失败并出现 SQL 错误 1054，b.chrggrade 中的未知列。这是因为它解析为

选择 b。*， C。*, g.*, p.perfname, p.persname 来自预订 b，（客户 c 在 b.chrggrade=g.grcode 上离开加入等级 g）在 b.person=p.percode 上离开加入人员 p，其中 complete='Y'并且 invoiced='N' 和 datemade 在 '2009-03-25' 和 '2009-03-31' 之间，并且 c.custcode=b.cust 由 cust、person、tsref、stdt 订购

我认为。

我确信正确放置的括号可以解决这个问题，但我很难过。[我在http://bugs.mysql.com/bug.php?id=13551](http://bugs.mysql.com/bug.php?id=13551)找到了对此更改的参考，它显示了如何修复简单的左连接，但我仍然无法解决此查询。大卫

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-31T13:13:53.317

完全停止使用逗号语法，并在您的 JOIN 语句中明确。逗号语法强制您将 JOIN 条件放在 WHERE 子句中，这可能要在 LEFT/RIGHT 连接之后才会执行，具体取决于它的解析方式。无论如何，使用显式 JOINS 会使查询更具可读性。

...FROM t1, t2 LEFT JOIN t3 ON (expr) 变为 ...FROM t1 INNER JOIN t2 ON (expr) LEFT JOIN t3 ON (expr)

这也将解决您看到的错误。除非 bookings 表中没有 chrggrade，否则没有任何东西可以修复错误。

# tdd - 界面疯狂

> ID：700781
> 
> 赞同：8
> 
> 时间：2009-03-31T12:50:51.097
> 
> 标签：tdd, inversion-of-control, interface

我正在喝酷拉德并且喜欢它——接口、IoC、DI、TDD 等等。工作得很好。但我发现我必须与让*一切都*成为界面的趋势作斗争！我有一个工厂，它是一个接口。它的方法返回可能是接口的对象（可能使测试更容易）。这些对象是他们需要的服务的 DI 接口。我发现使接口与实现保持同步正在增加工作-向类添加方法意味着将其添加到类+接口、模拟等。

我是否过早地考虑接口？是否有最佳实践来知道什么时候应该返回一个接口和一个对象？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-09T20:03:56.470

当您想要模拟对象与其合作者之一之间的交互时，接口很有用。但是，对于具有内部状态的对象，接口中的价值较小。

例如，假设我有一个服务与存储库对话，以便提取一些域对象以便以某种方式对其进行操作。

从存储库中提取接口具有一定的设计价值。我对存储库的具体实现可能与 NHibernate 或 ActiveRecord 密切相关。通过将我的服务链接到接口，我可以清楚地分离出这个实现细节。碰巧我也可以为我的服务编写超快速的独立单元测试，因为我可以给它一个模拟的 IRepository。

考虑到从存储库返回的域对象以及我的服务所作用的域对象，它的价值较小。当我为我的服务编写测试时，我会想要使用一个真实的域对象并检查它的状态。例如，在调用 service.AddSomething() 之后，我想检查是否已将某些内容添加到域对象中。我可以通过简单检查域对象的状态来测试这一点。当我单独测试我的域对象时，我不需要接口，因为我只会对对象执行操作并就其内部状态进行测试。例如，我的羊在睡觉时吃草是否有效？

在第一种情况下，我们对基于**交互**的测试感兴趣。接口有帮助，因为我们想要拦截在被测对象与其合作者之间通过模拟传递的调用。在第二种情况下，我们对基于**状态**的测试感兴趣。接口在这里没有帮助。试着意识到你是在测试状态还是交互，并让它影响你的界面或没有界面的决定。

请记住（如果您安装了 Resharper 的副本）稍后提取接口非常便宜。如果您决定根本不需要该接口，那么删除接口并恢复到更简单的类层次结构也很便宜。我的建议是在没有接口的情况下开始，当您发现要模拟交互时按需提取它们。

当您将 IoC 带入图片时，我会倾向于提取更多接口 - 但请尽量控制您将多少类推入 IoC 容器。通常，您希望将这些限制在很大程度上无状态的服务对象中。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-31T12:52:48.470

听起来你有点受[BDUF](http://en.wikipedia.org/wiki/Big_Design_Up_Front)的影响。

冷静下来，让它自然流动。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-31T13:11:09.313

请记住，虽然灵活性是一个有价值的目标，但 IoC 和 DI 增加的灵活性（在某种程度上是 TDD 的要求）也会增加复杂性。唯一的灵活性是使下游的更改更快、更便宜或更好。每个 IoC/DI 点都会增加复杂性，从而导致其他地方的更改更加困难。

这实际上是您需要在某种程度上预先进行大设计的**地方**：确定哪些领域最有可能发生变化（和/或需要广泛的单元测试），并在那里规划灵活性。重构以消除不太可能更改的灵活性。

现在，我并不是说您可以准确地猜测出哪里需要灵活性。你会错的。但很可能你会做对一些事情。在您后来发现不需要灵活性的地方，可以在维护时将其考虑在内。在您需要的地方，可以在添加功能时将其考虑在内。

现在，可能会或可能不会改变的领域取决于您的业务问题和 IT 环境。以下是一些反复出现的领域。

1.  我总是认为您集成到其他系统的外部接口是高度可变的。
2.  任何为用户界面提供后端的代码都需要支持 UI 中的更改。然而，主要是为功能的变化做计划：不要过分地为不同的 UI 技术做计划（例如同时支持智能客户端和 Web 应用程序——使用模式会有很大的不同）。
3.  另一方面，至少在公司环境中，为不同数据库和平台的可移植性而编写代码**通常是浪费时间。**四处询问并检查可能存在哪些计划来在您的软件的可能生命周期内更换或升级技术。
4.  更改数据内容和格式是一件棘手的事情：虽然数据偶尔会发生变化，但我见过的大多数设计都不能很好地处理这些变化，因此您可以直接使用具体的实体类。

但只有你可以判断什么可能改变或不应该改变。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-31T13:03:27.477

我通常发现我想要“服务”的接口——而主要关于“数据”的类型可以是具体的类。例如，我有一个`Authenticator`接口，但有一个`Contact`类。当然，它并不总是那么明确，但这是一个初步的经验法则。

不过我确实感受到了你的痛苦——这有点像回到 .h 和 .c 文件的黑暗时代......

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-31T13:11:27.053

我认为最重要的“敏捷”原则是 YAGNI（“你不需要它”）。换句话说，在实际需要之前不要编写额外的代码，因为如果您提前编写它，那么当（如果！）您最终确实需要它时，需求和约束很可能已经改变。

接口、依赖注入等——所有这些都增加了代码的复杂性，使其更难理解和更改。我的经验法则是让事情尽可能简单（但不要更简单），并且不要增加复杂性，除非它让我获得的收益足以抵消它带来的负担。

因此，如果您实际上正在测试并且拥有一个模拟对象将非常有用，那么请务必定义一个您的模拟类和真实类都实现的接口。但是不要仅仅基于假设它可能在某些时候有用，或者它是“正确的”OO设计而创建一堆接口。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-31T13:03:37.663

接口的目的是建立一个契约，并且当您想要更改执行任务的类时特别有用。如果不需要更改类，则接口可能会妨碍您。

有自动工具来提取接口，所以也许你最好在这个过程中延迟接口提取。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-31T14:37:34.240

这在很大程度上取决于您提供的内容......如果您正在处理内部事务，那么“在需要之前不要这样做”的建议是合理的。但是，如果您正在创建一个供其他开发人员使用的 API，那么稍后将其更改为接口可能会很烦人。

一个好的经验法则是用任何需要子类的东西来制作接口。这不是“在那种情况下总是做一个接口”之类的事情，你仍然需要考虑它。

因此，简短的回答是（这适用于内部事物和提供 API）是，如果您预计需要多个实现，则将其设为接口。

通常不是接口的东西是只保存数据的类，比如处理 x 和 y 的 Location 类。有另一种实现的可能性很小。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-03-31T13:05:12.090

不要先创建接口——你不需要它们。您无法猜测哪些类需要接口，哪些类不需要。因此，现在不要花时间用无用的接口来负担代码。

但是，当你有这样做的冲动时——当你看到需要接口时——在重构步骤中提取它们。

[这些答案](https://stackoverflow.com/questions/56867/interface-vs-base-class)也可以提供帮助。

# php - 不刷新页面自动更新记分牌

> ID：700782
> 
> 赞同：1
> 
> 时间：2009-03-31T12:50:57.943
> 
> 标签：php, ajax, automation, auto-update, performance

当我从我的管理员更新分数时，我想在不刷新的情况下自动更新客户端中的分数，任何人都可以帮助脚本和技术我看到这样的自动刷新[https://stackoverflow.com/](https://stackoverflow.com/) 答案，视图自动更新

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-31T12:57:44.823

我知道这样做的唯一方法是从客户端主动轮询您的服务器。

您需要创建一些轮询脚本来调用您的脚本服务页面并请求数据。然后，当数据保存在管理页面中时，服务将在下次询问时返回最新分数。

通常，您会使用 setInterval 和 clearInterval。因此，在页面加载时，您可以将轮询函数调用分配给 setInterval 方法，并给它一个合理的超时时间（10 秒以上，具体取决于您希望更新分数的频率和流量有多大）。

每当您想停止轮询时，都需要使用 clearInterval 。根据另一个答案，JS 框架将帮助您以 Xml 或 JSON 格式发出 Ajax 请求。鉴于您的标签暗示“更快”，那么我推荐 JQuery 和 JSON。

此外，无论您使用什么框架，都可以考虑使用 Google 的 CDN 来快速部署该框架。

我不知道任何使用 Ajax 的服务器推送，所以有兴趣看看该方法是否可用（尽管我对此表示怀疑）。

编辑：添加了有关 Google cdn 和框架的更多信息。高温下，

小号

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-31T12:55:59.070

您可能想研究一个 js 框架。

您执行此操作的步骤类似于：

向您的链接/按钮添加一个 onclick 侦听器当触发时，停止事件（这样您就可以阻止浏览器刷新/重定向页面）获取用户提交的数据并通过 json ajax 请求将其发送到服务器处理数据服务器侧并返回响应 处理响应并相应地更新接口

以下是有关如何使用 mootools 执行此操作的更多文档： * [http://mootools.net/docs/Request/Request.JSON](http://mootools.net/docs/Request/Request.JSON)如果您想使用 JSON 路径 * [http://mootools.net/docs /Request/Request.HTML](http://mootools.net/docs/Request/Request.HTML)如果你只想要一个 AJAX 更新程序

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-31T13:01:12.990

虽然我没有使用它，但听起来这就是“彗星”旨在解决的问题。这是一种将内容从服务器流式传输到客户端的方式——基本上是一种“推送”方式。这可能是您正在寻找的东西。

[http://ajaxian.com/archives/comet-a-new-approach-to-ajax-applications](http://ajaxian.com/archives/comet-a-new-approach-to-ajax-applications)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-31T13:04:25.213

如果使用 AJAx，则无需刷新页面。

使用 AJAX，您可以调用服务器并将结果放在网页的一部分中，而无需刷新页面。

这里有一篇关于[通过 jQuer](http://www.ibm.com/developerworks/library/x-ajaxjquery.html) y 使用 AJAX 的文章。

AJAX 上的[jQuery 文档](http://docs.jquery.com/Ajax/jQuery.ajax#options)也很好。

下面显示了一个从服务器请求数据并将结果附加到页面部分的示例：

```
 $.ajax({
   type: "POST",
   url: "some.php",
   data: "name=John&location=Boston",
   success: function(msg){
     $("#results").append(msg);
   }
 }); 
```

# c# - SQL：使用 1 个查询更新一行并返回一列值

> ID：700786
> 
> 赞同：55
> 
> 时间：2009-03-31T12:52:16.660
> 
> 标签：c#, sql-server, tsql, ado.net

我需要更新表中的一行，并从中获取列值。我可以做到这一点

```
UPDATE Items SET Clicks = Clicks + 1 WHERE Id = @Id;
SELECT Name FROM Items WHERE Id = @Id 
```

这会生成 2 个对表的计划/访问。是否可以在 T-SQL 中修改 UPDATE 语句以更新并返回仅具有 1 个计划/访问权限的 Name 列？

我正在使用 C#、ADO.NET`ExecuteScalar()`或方`ExecuteReader()`​​法。

* * *

## 回答 #1

> 赞同：102
> 
> 时间：2009-03-31T12:55:18.010

你想要[OUTPUT](http://msdn.microsoft.com/en-us/library/ms177564.aspx)子句

```
UPDATE Items SET Clicks = Clicks + 1
OUTPUT INSERTED.Name
WHERE Id = @Id 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-03-31T12:55:16.793

只访问一次表：

```
DECLARE @Name varchar(MAX);

UPDATE Items SET Clicks = Clicks + 1 , @Name = Name WHERE Id = @Id;
SELECT @Name; 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-31T12:56:55.260

如果您使用的是 SQL Server 2005 及更高版本，则[OUTPUT 子句](http://blog.sqlauthority.com/2007/10/01/sql-server-2005-output-clause-example-and-explanation-with-insert-update-delete/)非常适合此操作

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-31T12:54:52.693

为此使用存储过程。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-31T12:54:57.403

创建一个以@id 作为参数的存储过程，并同时执行这两项操作。然后使用[DbDataAdapter](http://msdn.microsoft.com/en-us/library/system.data.common.dbdataadapter.aspx)调用存储过程。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-10-31T14:04:41.230

**我无法在 select 语句**中更新并返回一行。即您不能使用其他答案中的选定值。

就我而言，我想在查询中使用选定的值。我想出的解决方案是：

```
declare @NextId int
set @NextId = (select Setting from Settings where key = 'NextId')

select @NextId + ROW_NUMBER() over (order by SomeColumnOfYourTable) from YourTable

update Settings set Setting = Setting + @@ROWCOUNT 
where key = 'NextId' 
```

# ruby - 如何从 Ruby 模块中只导入几个函数？

> ID：700790
> 
> 赞同：8
> 
> 时间：2009-03-31T12:53:20.700
> 
> 标签：ruby, import, function, module

假设我有一个带有方法的模块：function1，function2，function3。我想导入 function1 和 function2 但不是 function3。有没有办法在红宝石中做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-31T13:46:51.583

不确定是否有一种干净的方法来添加您想要的方法，但您可以使用`undef_method`.

```
module Foo
  def function1
  end

  def function2
  end

  def function3
  end
end

module MiniFoo
  include Foo
  not_wanted_methods = Foo.instance_methods - %w(function1 function2)
  not_wanted_methods.each {|m| undef_method m}
end

class Whatever
  include MiniFoo
end 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-31T14:05:02.557

类似的解决方案，但更自动化。我不知道会发生什么样的奇怪事情。

```
module Foo
  def m1
    puts "Hello from m1"
  end

  def m2
    puts "Hllo from m2"
  end
end

class Module
  alias :__include__ :include
  def include(mod, *methods)
    if methods.size > 0
        tmp  = mod.dup
        new_mod = Object.const_set("Mod#{tmp.object_id}", tmp)
        toremove = new_mod.instance_methods.reject { |m| methods.include? m.to_sym }
        toremove.each { |m| new_mod.send(:undef_method, m) }
        __include__(new_mod)
    else
      __include__(mod)
    end
  end
end

class Bar
  include Foo
end

class Baz
  include Foo, :m2
end

bar = Bar.new
baz = Baz.new
p bar.methods - Object.methods
p baz.methods - Object.methods

=>

["m1", "m2"]
["m2"] 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-31T17:04:27.117

假设您控制模块的源代码，我认为最简洁的方法是将模块拆分为更多，呃，模块化的部分。

如果您只想要模块的某些部分，这是一个很好的迹象，表明您可以将该模块重构为多个责任较小的模块。

# localization - 自动化 Photoshop 以从文件中插入文本

> ID：700792
> 
> 赞同：7
> 
> 时间：2009-03-31T12:53:41.620
> 
> 标签：localization, photoshop

我有一个多语言网站，需要自动化从 csv 源更新 psd 文件中的文本层的过程。

我知道由于宽度的变化，psp 中可能会出现故障，但无论如何，将文本放在文档中会有很大帮助。

我有哪些选择？

编辑：

Murmelschlurmel 有一个可行的解决方案。这是 Adob​​e 文档的链接。

[http://livedocs.adobe.com/en_US/Photoshop/10.0/help.html?content=WSfd1234e1c4b69f30ea53e41001031ab64-740d.html](http://livedocs.adobe.com/en_US/Photoshop/10.0/help.html?content=WSfd1234e1c4b69f30ea53e41001031ab64-740d.html)

csv 文件的格式不是很好：每个变量都需要一列。我希望每个变量都有一行。

它适用于变音符号（ä、ö 等）

编辑1：

另一种解决方案是使用 com 自动化 Photoshop。如果您有几个需要更改文本的模板（按钮），那就太好了。这是我在 python 中的脚本，可能会让你开始。

您需要一个包含以下列的 excel 文件：TemplateFileName, TargetFileName, TargetFormat, Text (ie template.psd, button1, gif, NiceButton)。不使用工作表的第一行。psp模板应该只有1个textlayer，不能有layergroups。

```
import win32com.client
import xlrd 
spreadsheet = xlrd.open_workbook("text_buttons.xls")
sheet = spreadsheet.sheet_by_index(0)

psApp = win32com.client.Dispatch("Photoshop.Application")  
jpgSaveOptions = win32com.client.Dispatch("Photoshop.JPEGSaveOptions")  
jpgSaveOptions.EmbedColorProfile = True
jpgSaveOptions.FormatOptions = 1
jpgSaveOptions.Matte = 1
jpgSaveOptions.Quality = 1

gifSaveOptions = win32com.client.Dispatch("Photoshop.GIFSaveOptions")

for rowIndex in range(sheet.nrows):
    if(rowIndex > 0):
        template =  sheet.row(rowIndex)[0].value
        targetFile = sheet.row(rowIndex)[1].value
        targetFileFormat = sheet.row(rowIndex)[2].value
        textTranslated = sheet.row(rowIndex)[3].value
        psApp.Open(r"D:\Design\Produktion\%s" % template ) 
        doc = psApp.Application.ActiveDocument

        for layer in doc.Layers:  
            if (layer.Kind == 2):
                layer.TextItem.Contents = textTranslated
                if(targetFileFormat == "gif"):
                    doc.SaveAs(r"D:\Design\Produktion\de\%s" % targetFile, gifSaveOptions,  True, 2)
                if(targetFileFormat == "jpg"):
                    doc.SaveAs(r"D:\Design\Produktion\de\%s" % targetFile, jpgSaveOptions,  True, 2) 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-04-21T13:57:35.577

您可以使用“数据驱动设计”来执行此操作。计算机科学中也有[数据驱动设计](http://en.wikipedia.org/wiki/Data-driven_design)的概念，但据我所知，这与 Photoshop 中这个词的使用无关。

以下是如何进行：

在 Photoshop 中加载图像并使用**Image > Variable > Define 定义变量**。

然后将您的 csv 转换为 Photoshop 可以读取的格式。我对**制表符分隔的文本**有最好的体验。

**最后在 Photoshop 中使用图像 > 变量 > 数据集**加载文本文件，让 Photoshop 保存所有迭代。

当我第一次尝试这个时，我发现 Photoshop 帮助文件没有提供足够的细节。我在 Internet 上搜索了**Photoshop“数据集”**并找到了一些不错的教程，例如来自[digitaltutors](http://www.digitaltutors.com/free_tutorials/video_d.php?vid=716)的这个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-31T13:50:28.410

它可能有点过分，但我使用 Adob​​e AlterCast/Grphics 服务器来处理完全相同的问题。

此外，如果它只是文本 GIF/JPG 图像，您可以使用 Python+PIL（Python 图像库）。这是一个示例代码（适用于安装了 Arial 和 Osaka 字体的 Windows 操作系统。）

```
#!/usr/bin/python
# -*- coding: utf-8 -*-
import ImageFont, ImageDraw, Image
#font = ImageFont.truetype("/usr/share/fonts/bitstream-vera/Vera.ttf", 24)
#font = ImageFont.truetype("futuratm.ttf", 18)
font = ImageFont.truetype("arial.ttf", 18)
im = Image.new("RGB", (365,20), "#fff")
draw = ImageDraw.Draw(im)
draw.text((0, 0), "Test Images", font=font, fill="#000")
im.save("TestImg_EN.gif", "GIF")

font = ImageFont.truetype("osaka.ttf", 18)
im = Image.new("RGB", (365,20), "#fff")
draw = ImageDraw.Draw(im)
draw.text((0, 0), u"テストイメージ", font=font, fill="#000")
im.save("TestImg_JP.gif", "GIF") 
```

# asp.net - asp.net 隐藏字段未设置新值，需要禁用替代

> ID：700794
> 
> 赞同：0
> 
> 时间：2009-03-31T12:54:10.167
> 
> 标签：asp.net, javascript, gridview, hidden

我的页面上有一个隐藏字段

```
<input runat="server" type="hidden" id="selectedIndex" /> 
```

它是由这串代码设置的，一个 onclick 事件到 gridview 的行：

```
var gridViewCtlId = '<%=GridView.ClientID%>';
var selectedIndex = '#<%=selectedIndex.ClientID%>';
var itemVisible = '<%=ItemVisible.ClientID%>';
var gridViewCtl = null;
var curSelRow = null;
var previousRowIndx = null;

window.onload = function showQuery()
{
    if ($(selectedIndex).val() != undefined)
    {
        if ($(selectedIndex).val() != '')
        {
            var prevRowID = $(selectedIndex).val();
            var prevRow = getSelectedRow(prevRowID);
            prevRow.style.backgroundColor = '#1A8CD4';
        }
    }       
}

 function getGridViewControl(rowIdx)
{
    if (gridViewCtl == null)
    {
        gridViewCtl = document.getElementById(gridViewCtlId);
    }
}

function onGridViewRowSelected(rowIdx)
{   
    if (document.getElementById(gridViewCtlId).disabled == false)
    {
        var selRowCCA = getSelectedRow(rowIdx);
        if (curSelRow != null)
        {   
            var previousRow = getSelectedRow(previousRowIndx);

            var CountIdx = previousRowIndx % 2;
            if (document.getElementById(itemVisible) == null)
            {
                if (CountIdx == 0)
                {
                    previousRow.style.backgroundColor = 'Silver';
                }
                else
                {
                    previousRow.style.backgroundColor = 'White';
                }
            }
        }

        if (null != selRow)
        {
            previousRowIndx = rowIdx;
            curSelRow = selRow;
            selRow.style.backgroundColor = '#1A8CD4';
        }
    }
}
function getSelectedRow(rowIdx)
{
    getGridViewControl(rowIdx);
    if (gridViewCtl != null)
    {
        $(selectedIndex).val(rowIdx);
        return gridViewCtl.rows[rowIdx];
    }
    return null;
} 
```

这就是发生的情况：当页面第一次加载时，隐藏字段是未定义的，它应该是。当我单击一行然后单击“选择”按钮时，该按钮将调用它：

```
GridView.Attributes.Add("disabled", "true"); 
```

网格视图被禁用（与选择按钮一起）并且出现另一个网格视图（这应该取决于在第一个网格视图中选择的内容）。所以现在，问题来了。当我单击 gridview 中的一行时（我只是在谈论初始的 gridview，而不是出现的第二个，这不是问题），然后单击选择，所有内容都变灰，并且大多数时候，页面加载时选定的行将突出显示（其他时候由于某种原因默认为第 2 行）。然后，假设您单击第 4 行，然后单击第 1 行，然后单击选择，由于某种原因，第 4 行将保持突出显示，然后第 4 行的数据将填充第二个网格视图，就像您从未单击第 1 行一样。但是如果我单击第 4 行然后单击第 1 行，然后再次单击第 1 行，是否保存。有谁知道为什么会这样？

Also, I'm pretty much trying to disable the first gridview when select is hit so I do

```
GridView.Attributes.Add("disabled", "true"); 
```

而不是 GridView.Enabled = false;

如果用户重新单击搜索按钮（之前位于页面上的另一个按钮，使此 gridview 变得可见），我希望辅助 gridview 隐藏，并且主 gridview（这个有问题）重新启用. 但是做

```
GridView.Attributes.Add("disabled", "false"); 
```

当搜索按钮被触发时，只会禁用gridview，这很奇怪。现在我知道除了 IE 之外的任何其他浏览器都不支持禁用字段，我只使用它是因为我需要检查 gridview 是否被禁用，因此用户在做出选择后无法单击另一行（发生这种情况如果我不执行以下操作：

```
if (document.getElementById(gridViewCtlId).disabled == false) 
```

那么有人可以让我知道完成该任务的另一种方法吗？再次提前感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-31T16:19:45.070

有关禁用的一些信息：

*   浏览器不会将任何禁用控件的值发送到服务器。这是根据定义。
*   其他浏览器支持禁用字段，但它使用不同的模型。注意支持的浏览器列表：http: [//www.w3schools.com/tags/att_input_disabled.asp](http://www.w3schools.com/tags/att_input_disabled.asp)（以及它是如何定义的 disabled='disabled'）。

另请参阅它与只读的比较：http: [//www.w3.org/TR/html401/interact/forms.html#h-17.12.2](http://www.w3.org/TR/html401/interact/forms.html#h-17.12.2)

另请注意，根据标准，它的支持仅限于某些元素。这很重要，因为您将它应用于不受支持的 html 元素，这也是它在您的场景中的其他浏览器中无法正常工作的可能原因。您可以使用脚本禁用支持的控件，让控件像 $get("someClientID").getElementsByTagName("input"); 一样应用它。

# naming-conventions - 功能服务器命名约定

> ID：700795
> 
> 赞同：10
> 
> 时间：2009-03-31T12:54:13.223
> 
> 标签：naming-conventions

我看过“[最酷的服务器名称](https://stackoverflow.com/questions/262657/the-coolest-server-names-closed)”，并且我看到了另一个与我有关的[较小的问题](https://stackoverflow.com/questions/631220/good-server-naming-convention)，不幸的是，该问题已关闭。

不过，这是一个严肃的问题，因为我在一个内部应用程序开发团队中，负责管理几十台服务器上的应用程序。网络人员通常不在乎我们如何称呼服务器，只要他们知道它们，因此我们可以提出任何约定。

服务器处理的应用程序可以是自制的自定义应用程序，也可以是更大的供应商，如 SharePoint。他们可以：

*   在无法相互通信的多个网络环境中（想想防火墙关闭的外部服务器与 Intranet 式服务器）
*   在不同的物理位置（加利福尼亚办公室与纽约等）
*   在多个部署层（生产、登台、测试、开发）中
*   具有一项或多项功能（Web 服务器、DB 服务器、邮件服务器、应用程序服务器）
*   负载均衡与否
*   备用（用于灾难恢复）或主要

哇！认为甚至有可能提出一个可以解决所有这些方面或重要方面的约定？很高兴听到服务器名称（或它的 DNS 条目）并能够立即知道它的作用，它也有助于让新人加快速度。“sharepoint-IPC-1 已关闭”可以解析为“位于加利福尼亚数据中心的内部生产 SharePoint Web 服务器，它是负载平衡中的第一个节点已关闭！”...但乍一看似乎过于复杂。

我脑海中的另一件事是旧的邮件中继服务器正在退役，这意味着我们必须搜索许多旧应用程序来重新指向硬编码的服务器值（我知道...... :)。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-31T13:42:15.590

根据我过去犯过的错误，以下是我尝试遵守的一些一般准则。

永远不要将您的机器名称基于...

*   **硬件**机器总是被换掉，如果你从 IBM 服务器换到 Sun 服务器再到 Dell 服务器，你不希望做太多的工作。

*   **位置**设备甚至整个服务器机房都可以根据业务需求或技术问题进行移动。

*   **预期用途**随着产品的发展，每台服务器的预期用途也会有所变化。拥有一台名为“dbsrv”但最终也充当文件服务器的机器令人困惑。

*   **所有者**“拥有”设备的人（员工）可能会因公司内部的解雇、裁员和搬迁而发生变化。

*   **子网**正如我之前所说，实验室可以移动，子网也可以。DNS 的主要目标之一是让您摆脱与特定 IP 地址的束缚，那么为什么要不必要地束缚自己呢？

现在，针对您描述的情况的一些建议...

*   **机器分布在一个区域**这就是 DNS 中子域的用途。你可以有“west.company.com”和“east.company.com”。

*   **有一个或多个功能**不要根据预期用途命名它们。如果你根据一些大的名字集合来命名它们——例如希腊诸神——你最终会直观地知道 zeus.east 意味着你的主数据库服务器，而 apollo.west 是你的备份数据库服务器。最坏的情况，在电子表格中查找。

*   **负载平衡与否**您可以采用两种方法。您可以在负载均衡器后面的每个节点都有一个唯一的名称，或者您可以执行诸如 athena-1.east、athena-2.east 之类的操作。无论哪种方式，负载均衡器都会（希望）让您不必担心太多每个节点的名称。

*   **待机与否**这听起来不像是应该对机器名称产生影响的标准。

我实质上要说的是：

1.  将您的设备分成不同的区域子域
2.  选择具有大量名称的命名方案（本例中为希腊诸神）
3.  不要将名称基于我上面提到的任何标准（预期用途、位置等）

试图做*更多*的事情将比它的价值更麻烦。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-31T13:14:19.930

我知道为描述其功能和其他类似属性的服务器分配名称是很诱人的，并且在一个可以工作的完美世界中，但实际上我发现一段时间后这些事情会随着服务器的功能和其他参数的变化而变得混乱（随着业务需求的变化）所以名称不再反映现实。

我认为您应该为不告诉任何有关功能或其他参数的服务器分配唯一名称，并有某种（最新）列表详细说明这些内容，以便您的人员可以查找它。这就是我们在这里所做的。

另一个极端是仅使用 IP 地址或使用基于 IP 地址的名称，如果您不得不更改 IP 地址，这也可能导致灾难。

# silverlight - Silverlight 应用程序的 DataGrid 中的动画 - 如何？

> ID：700798
> 
> 赞同：2
> 
> 时间：2009-03-31T12:55:12.207
> 
> 标签：silverlight, xaml, animation, datagrid

我开始通过重写现有的 ASP.NET 应用程序来开始使用 Silverlight（尽管目前感觉相反） - 与我想的一样，这是一个很好的起点。

我已经“掌握”了从数据库中提取数据，通过服务进入数据网格，并在行中填充图像元素。到现在为止还挺好。

现在我被困住了，头疼！

我想在每行的最后一列添加一个简单的动画（一个绿色矩形在红色矩形上移动以显示百分比进度），但无法将其连接起来。

我的 xml 看起来像这样：

```
<data:DataGrid.Columns>
.
.
.
.
<data:DataGridTemplateColumn>
    <data:DataGridTemplateColumn.CellTemplate>
        <DataTemplate>
            <StackPanel x:Name="AnimationPanel">
                <StackPanel.Resources>
                    <Storyboard x:Key="ShowProgress">
                        <DoubleAnimation Storyboard.TargetProperty="Width"
                                        Storyboard.TargetName="goalProgressBar_Complete"
                                         From="0" To="50"
                                        Duration="0:0:5">
                        </DoubleAnimation>
                    </Storyboard>
                </StackPanel.Resources>
                <Rectangle x:Name="goalProgressBar_Complete"
                           Width="1" Height="100"
                           Fill="#0aa60e"></Rectangle>
            </StackPanel>
        </DataTemplate>
    </data:DataGridTemplateColumn.CellTemplate>
</data:DataGridTemplateColumn>
</data:DataGrid.Columns> 
```

这显然是错误的（因为它不起作用），我开始认为不可能以这种方式向 Datagrid 添加动画。我用谷歌搜索了一段代码，虽然有一些令人兴奋的结果，但它们并没有起到任何作用。

我是在尝试做一些 Silverlight 根本不支持的事情，还是我错过了一些非常简单的事情？

提前致谢。

**更新：** 虽然我还没有走出困境，但我已经设法让动画与适当的列一起运行。MasterMax提供的答案让我看了一下EventTriggers，修改后的xaml看起来像这样：

```
<data:DataGridTemplateColumn>
    <data:DataGridTemplateColumn.CellTemplate>
        <DataTemplate>
            <Rectangle x:Name="GoalProgress" Height="100" Width="1" Fill="Green">
                <Rectangle.Triggers>
                    <EventTrigger RoutedEvent="Rectangle.Loaded">
                        <EventTrigger.Actions>
                            <BeginStoryboard>
                                <Storyboard>
                                    <DoubleAnimation Storyboard.TargetProperty="Width"
                                             Storyboard.TargetName="GoalProgress"
                                             From="0" To="50" Duration="0:0:5">
                                    </DoubleAnimation>
                                </Storyboard>
                            </BeginStoryboard>
                        </EventTrigger.Actions>
                    </EventTrigger>
                </Rectangle.Triggers>
            </Rectangle>
        </DataTemplate>
    </data:DataGridTemplateColumn.CellTemplate>
</data:DataGridTemplateColumn> 
```

我现在需要做的就是绑定 'To' 属性中的 % 值并添加我的底层红色矩形。毫无疑问，这不会像我目前希望的那样容易，但否则它不会很有趣;-)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-31T13:10:59.753

在我看来，您实际上并没有在玩故事板。您需要为矩形添加鼠标进入和鼠标离开处理程序，然后相应地播放和停止情节提要。确保在 enter 命令中停止然后播放故事板（否则你会得到一些有趣的副作用）。

### 更新

好的，我已经在 Silverlight 中度过了我的一天，我离帮助也不近了。我正在查看包含 DataGrid 的 Silverlight 程序集内的 generic.xaml 文件。你可以考虑进去看看。据我所见，尽管我还没有查看相应的代码以确定确切的方式，但他们通过控制模板实现了行细节转换的一些功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-31T17:29:43.857

尝试将它附加到 Datagrid 的 EventTrigger。与此类似的东西：

```
<Window.Triggers>
        <EventTrigger RoutedEvent="Window.Loaded">
            <BeginStoryboard>
                <Storyboard>
                    <DoubleAnimation Name="EntranceAnimation"
                        Storyboard.TargetName="MainWindow" 
                        Storyboard.TargetProperty="Opacity"
                        From="0.0"
                        To="1.0"
                        Duration="0:0:3">
                    </DoubleAnimation>
                </Storyboard>
                </BeginStoryboard>
        </EventTrigger>
    </Window.Triggers> 
```

在您的情况下，您将寻找 DataGrid.Loaded 事件（或类似事件）。这对我有用，我在加载页面时淡入整个窗口。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-31T12:59:46.143

对于这种类型的应用程序，动画可能不是最佳解决方案。您可能想尝试将移动矩形的宽度属性绑定到应用程序中的变量，或者随着进度的变化调整每个刻度的宽度。

# mercurial - 是否有可能在 mercurial 包中显示变更集？

> ID：700801
> 
> 赞同：2
> 
> 时间：2009-03-31T12:55:22.473
> 
> 标签：mercurial

[mercurial wiki](http://www.selenic.com/mercurial/wiki/index.cgi/LookingIntoBundles?highlight=%28bundle%29)提供了有关如何显示捆绑包将添加到给定存储库的变更集的提示。

是否有可能显示独立于特定存储库的捆绑包中包含的变更集（和日志消息）？

**编辑：**我提出问题的原因是有时我在工作中有一个存储库，而在家里有一个存储库。我使用 U 盘上的捆绑包来保持同步。

偶尔我想检查一下这个包是否包含它应该包含的所有变更集。我无法使用源存储库检查它，因为它已经包含捆绑包中的所有变更集。（我可以使用目标存储库检查它，但这并没有多大帮助，因为我无法访问源存储库。）

当然，当有疑问时，您总是可以重新创建捆绑包，所以这不是什么大问题。我只是想知道这是否可能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-31T13:17:28.223

**重新编辑**

使用传出存储库（其中包含已传输的变更集），对其进行捆绑，然后在将捆绑包放在您的存储棒上后将其应用到该存储库，这将算作这样的检查。至少，我就是这样做你描述的。

# javascript - YUI 支持 rtl 语言

> ID：700802
> 
> 赞同：1
> 
> 时间：2009-03-31T12:55:25.890
> 
> 标签：javascript, yui, hebrew, right-to-left, bidi

YUI 是否支持 rtl 语言？（rtl：从右到左，例如希伯来语或阿拉伯语）。

如果是这样，怎么做？我想显示一个菜单栏，其中不同的菜单项从右边距附近开始，然后向左移动。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-31T15:32:29.553

YUI 2.x 中不支持 RTL 语言。一年多前我提交了一个关于它的错误并得到回复说他们可能会在以后的版本中添加它。（对不起，自从他们切换到新的跟踪器后，我再也找不到错误了。）希望他们正在为 YUI 3.x 添加 RTL 支持，但我还没有查看预览版本（我也找不到他们提到添加RTL 支持）。

这并不是说 YUI 菜单不能做 RTL，尽管它需要一些工作，因为没有内置支持。我没有声称这在所有浏览器中都 100% 有效，尤其是 IE。

首先，您需要菜单项以相反的方向流动，并从页面的另一侧开始。我相信这适用于大多数浏览器（当然，除了 IE6，啊 - 对于那个浏览器，你需要做一些我不记得答案的额外工作）：

```
.yuimenubaritem { float: right; } 
```

其次，您需要 MenuBar 的子菜单以相反的方向流动。您可以通过更改菜单配置的*submenualignment*属性来做到这一点：

```
// For the main submenu
new YAHOO.widget.MenuBar("id", { submenualignment: ["tr","br"] });

// You have to manually add all the Menus,
// so that you can set the submenualignment on each.
new YAHOO.widget.Menu("id", { submenualignment: ["tl","tr"] }); 
```

最糟糕的部分是试图让键盘事件正常工作，因为此时按下右会使光标向左移动，反之亦然。为此，您必须劫持 MenuBar 的 _onKeyDown() 并对其进行更改，以便如果 MenuBar 设置为 RTL（将此信息存储在某个 var 中），它的左/右处理方式略有不同。（抱歉，您必须自己解决这个问题，但这应该是在按键上切换案例的简单问题）。

# c# - MSMQ 线程安全

> ID：700805
> 
> 赞同：1
> 
> 时间：2009-03-31T12:55:58.167
> 
> 标签：c#, multithreading, message-queue

我正在使用 c# 中的消息队列。我正在通过计时器调用的代码（在主线程中设置）以及后台工作线程将消息发送到队列。如果我有两个消息队列实例，一个用于计时器，一个用于后台工作线程，我会遇到任何线程问题吗？我在使用消息队列的单个实例时遇到了问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-01T13:20:58.207

请参阅[MSDN 上的消息队列](http://msdn.com/library/System.Messaging.MessageQueue)：

> 只有以下方法是线程安全的：BeginPeek、BeginReceive、EndPeek(IAsyncResult)、EndReceive(IAsyncResult)、GetAllMessages、Peek 和 Receive。

只要你坚持这些方法，你就可以（加上任何静态方法，除非明确标记为不是线程安全的）。

但是，MessageQueue 实例相当轻量级，因此您可以在需要时创建新实例（可能通过工厂来避免队列名称的全局变量）。

# insert - 如何使用 GetInsertCommand 方法？

> ID：700809
> 
> 赞同：0
> 
> 时间：2009-03-31T12:56:12.703
> 
> 标签：insert

## 我使用了这样的命名方法：

```
ds.Tables("Employees").Rows.Add(ENumTxt.Text, ENameTxt.Text,PosTxt.Text,EAgeTxt.Text,_
ESalTxt.Text, EPhonTxt.Text, EAdrsTxt.Text)
If ds.HasChanges Then
            Dim AffectedDS As DataSet = ds.GetChanges(DataRowState.Added)
            Dim ComBuilder As New OleDb.OleDbCommandBuilder(da)
            da.InsertCommand = ComBuilder.GetInsertCommand()
            da.Update(AffectedDS, "Employees")
End If 
```

* * *

但是当我在运行时检查插入命令时，它看起来像：

插入员工价值观(?,?,?,?,?,?,?)

我在文本框中输入的值在哪里？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-31T13:12:41.010

它们可能在 InserCommand 的参数集合中。查看 da.InsertCommand.Parameters。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-07T13:11:17.490

尝试向参数添加值，例如）：

```
adapter.InsertCommand.Parameters["@p1"].Value = // some value
adapter.InsertCommand.Parameters["@p2"].Value = // some value
adapter.InsertCommand.Parameters["@p3"].Value = DBNull.Value // if you need to pass a null; 
```

参数应与数据库表字段的顺序相匹配。

您还需要执行插入命令的查询：

```
adapter.InsertCommand.ExecuteNonQuery(); 
```

# asp.net - ASP.net 每周日程控制

> ID：700810
> 
> 赞同：3
> 
> 时间：2009-03-31T12:56:14.170
> 
> 标签：asp.net, data-binding, scheduling, custom-server-controls, servercontrols

任何人都可以推荐一个免费的 asp.net 控件，我可以将其用于以下用途：

*   工作日周一至周六沿顶行
*   沿左侧的时间
*   实际数据的模板字段
*   可数据绑定
*   单元格根据开始时间和结束时间跨越行

这是一个我发现非常好的控件，但我正在尝试寻找替代方案： [Databound Schedule controls](http://www.codeproject.com/KB/custom-controls/schedule.aspx)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-31T13:01:52.253

[DayPilot](http://www.daypilot.org/)是一个非常好的通用日历/日程控制。

完整版不是免费的，但有一个“精简版”可用，它不仅免费而且是开源的！

# asp.net-mvc - ASP.Net MVC MapRoute 问题

> ID：700826
> 
> 赞同：0
> 
> 时间：2009-03-31T13:00:08.780
> 
> 标签：asp.net-mvc, model-view-controller, url-routing

SO处理MapRoute问题似乎有很多问题。我已经阅读了其中的一堆，但我看不出我在实现中做错了什么。我已经设置了以下路线：

```
routes.MapRoute( _
    "FilesDisplay", _
    "{controller}/{action}/{year}/{month}", _
    New With {.controller = "Files", .action = "Display", .year = "", .month = ""})

routes.MapRoute( _
    "Default", _
    "{controller}/{action}", _
    New With {.controller = "Files", .action = "Index"}) 
```

和以下 RouteLink：

```
<%=Html.RouteLink("Show", "FilesDisplay", New With {.year = 2008, .month = 5})%> 
```

但是，“显示”的结果 URL 是 /Files/Index/2008/5。为什么它选择 Index 动作而不是 Display 动作？

**编辑：**作为一个云雀，我将第二条路由更改为`.action = "Display"`只是为了查看是否可以更改 URL，它**仍然**解析为 /Files/Index/2008/5。

**编辑2：**我也试过：

```
<%=Html.ActionLink("Show", "Display", "Files", New With {.year = 2008, .month = 5}, Nothing)%> 
```

但这也可以解析为 /Files/Index/2008/5。为什么无论我为某个操作指定什么，它都默认为索引？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-31T18:04:54.443

升级到 MVC RC 1.0 似乎可以修复 ActionLink，但不能修复 RouteLink。因此，我正在推进 ActionLink。我很想知道为什么 RouteLink 不想工作。

# nhibernate - NHibernate 错误报告建议

> ID：700830
> 
> 赞同：0
> 
> 时间：2009-03-31T13:02:01.287
> 
> 标签：nhibernate, error-handling

这与其说是一个问题，不如说是关于最佳实践的建议。我正在编写一个 ASP.Net MVC 应用程序，并且在我的 DAL 中我正在使用 NHibernate，但是如果在 DAL 中引发异常，你会怎么做？

您是否在 DAL 中捕获异常，记录错误然后重新抛出异常？您甚至根本不尝试捕获异常并使用 global.asax 中的 Application_Error() 方法作为通用捕获所有？您是否捕获了异常记录并将一个布尔值返回给控制器以指示成功或失败，或者您是否做了一些完全不同的事情？

从这个开始，你如何处理通知用户？您是否显示通用的“发生错误 - 请重试”类型页面，还是显示更多信息错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-31T21:22:48.150

这正是那些“取决于”的问题之一。这就是我所做的：

*   处理 Application_Error （或类似接收器位置）中的所有异常
*   如果异常是业务逻辑的基础——比如不能有重复项，只需捕获它并对其采取行动。
*   如果它是基础设施异常并且很有可能您可以通过重试来修复它 - 在 DAL 中处理它。
*   向用户传播特定的异常信息几乎没有任何好处，因为通常用户无论如何都无法对此做任何事情。因此，一般的错误消息通常可以做到。
*   所有意外和选定的预期异常都需要记录尽可能多的信息。还建议您收到包含异常信息的电子邮件。

现在专门针对 NHibernate - 如果 NH 抛出异常，建议您关闭并丢弃当前活动的 ISession 并失败。因为会话可能处于未知/不一致的状态，并且试图恢复它可能弊大于利。

显然取决于您的应用程序的规模和类型以及各种系统/程序员/等的数量。涉及到你真的可能自己处理日志记录。

# java - 为什么不能在方法中本地声明枚举？

> ID：700831
> 
> 赞同：63
> 
> 时间：2009-03-31T13:02:28.320
> 
> 标签：java, enums

今天，我发现自己在编写这样的代码......

```
public class LocalEnums {

    public LocalEnums() {
    }

    public void foo() {
        enum LocalEnum {
            A,B,C
        };

        // ....
        // class LocalClass { }

    }
} 
```

当编译器在本地报告错误时，我有点惊讶`enum`：

> 成员枚举 LocalEnum 不能是本地的

为什么不能像**类一样声明****枚举**？

 **我发现这在某些情况下非常有用。在我工作的情况下，其余代码不需要知道任何关于`enum`.

是否存在任何*结构/设计*冲突来解释为什么这是不可能的，或者这可能是Java的*未来特性吗？*

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-03-31T13:05:28.283

**枚举是静态嵌套类**，因为它们*定义静态成员变量（枚举值）*，*内部类不允许这样做*：http : [//docs.oracle.com/javase/specs/jls/se7/html/jls-8.html #jls-8.1.3](http://docs.oracle.com/javase/specs/jls/se7/html/jls-8.html#jls-8.1.3)

**更新：**我正在查看`JLS`（*java语言规范*）以获取有关静态嵌套类限制的更多详细信息，但没有找到（尽管它可能在那里，隐藏在不同的主题下）。从纯粹的实现角度来看，没有理由不能做到这一点。所以我怀疑这是一个语言哲学问题：不应该这样做，因此不会得到支持。但我不在场，所以这纯粹是猜测。

**作为评论：**如果您的方法足够大以至于它们需要自己的枚举，那么这是您需要重构的强烈迹象。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2020-07-09T04:44:24.893

从 Java 16（2021-03 发布）和 Java 17（2021-09 发布）开始，其他答案已过时。

# Java 16+ 中的本地枚举

作为[Java 16](https://en.wikipedia.org/wiki/Java_version_history#Java_SE_16)中引入的[记录](https://openjdk.java.net/jeps/395)功能的一部分，现在可以在本地定义枚举。事实上，**记录、枚举和接口**现在都可以是本地的。

 **引用 JEP 395：

> 引入了声明本地记录类、本地枚举类和本地接口的能力。
> 
> …</p>
> 
> 添加本地记录类是添加其他类型的隐式静态本地声明的机会。
> 
> 嵌套枚举类和嵌套接口已经是隐式静态的，因此为了保持一致性，我们定义了本地枚举类和本地接口，它们也是隐式静态的。

您现在可以运行以下示例代码来使用在方法中定义的枚举。

```
private void demoLocalEnum ( )
{
    enum Color { PURPLE, SAFETY_ORANGE }
    System.out.println( Color.PURPLE );
} 
```

在此屏幕截图中，我们可以看到本地枚举如何仅存在于其定义方法中。兄弟方法无法看到该枚举。尝试从另一个方法调用该枚举会产生错误。

[![由兄弟方法尝试调用在其他方法中定义的本地枚举导致的错误的屏幕截图。](https://i.stack.imgur.com/0q6TU.png)](https://i.stack.imgur.com/0q6TU.png)

查看在[IntelliJ](https://en.wikipedia.org/wiki/IntelliJ_IDEA) 2020.2 [IDE中](https://en.wikipedia.org/wiki/Integrated_development_environment)[运行的此类代码的演示](https://www.youtube.com/watch?v=lgZRMCpfYM4&feature=youtu.be&t=91)。

## 隐式`static`

本地定义的枚举有一个限制：无法访问周围类中的状态。

示例代码：

```
private void demoLocalEnum ()
{
    int x = 42;

    enum Color
    {
        PURPLE,
        SAFETY_ORANGE;

        public void demo ()
        {
            System.out.println( "Now is " + Instant.now() );  // This line works.
            System.out.println( "x = " + x );  // ERROR — Non-static variable 'x' cannot be referenced from a static context.
        }
    }

    Color.PURPLE.demo();
} 
```

我的[IntelliJ](https://en.wikipedia.org/wiki/IntelliJ_IDEA) [IDE](https://en.wikipedia.org/wiki/Integrated_development_environment)报告错误：

> 不能从静态上下文中引用非静态变量“x”

正如上面的 JEP 395 引用中提到的，本地枚举是隐式的`static`。因此，您可以在本地枚举上定义的任何方法都无法访问周围外部类的状态。

引用 JEP 395，关于本地记录，但也适用于本地枚举：

> 本地记录类是嵌套记录类的一个特例。与嵌套记录类一样，本地记录类是隐式静态的。这意味着他们自己的方法不能访问封闭方法的任何变量；反过来，这避免了捕获立即封闭的实例，该实例会默默地将状态添加到记录类。本地记录类是隐式静态的这一事实与本地类相反，后者不是隐式静态的。事实上，局部类永远不是静态的——隐式或显式——并且总是可以访问封闭方法中的变量。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-03-31T13:06:39.043

我很少发现自己在方法中编写任何*类型*，除非它是匿名内部类。但是，您可以编写嵌套枚举：

```
public class NestedEnum
{
    private enum MyEnum
    {
        X, Y, Z
    }

    public void foo()
    {
    }
} 
```

我不认为我真的想*阅读*一个在其中声明新类型的方法 - 你有什么具体的理由想要在方法中声明它而不是仅仅作为嵌套类型？我可以看到“不需要知道其他方法”的论点，但我认为评论可以解决这个问题，并且仍然留下更多可读的代码。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2010-05-26T05:23:17.870

1.  “嵌套枚举类型是隐式静态的。” [8.9 枚举](http://java.sun.com/docs/books/jls/third_edition/html/classes.html#8.9)

2.  推断嵌套枚举类型隐式包含静态访问修饰符是合理的。

3.  “如果本地类声明包含以下任何一种访问修饰符，则会出现编译时错误：public、protected、private 或 static。” [14.3 14.3 局部类声明](http://java.sun.com/docs/books/jls/third_edition/html/statements.html#14.3)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-01T04:41:30.950

这很奇怪，因为 java 内部类定义说编译时常量可以声明为静态的，而 Enum 的成员显然是编译时常量，加上 enum 是一个静态类，据说......

**[文档](http://java.sun.com/docs/books/jls/third_edition/html/classes.html#295574)：**

8.1.3 内部类和封闭实例

(...) 内部类不能声明静态成员，除非它们是编译时常量字段。

```
class Outer{
    class Inner extends HasStatic{
        static final int x = 3;         // ok - compile-time constant
        static int y = 4;           // compile-time error, an inner class
    }
    static class NestedButNotInner{
        static int z = 5;           // ok, not an inner class
    }
    interface NeverInner{}              // interfaces are never inner
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-31T13:23:33.403

[http://mindprod.com/jgloss/enum.html](http://mindprod.com/jgloss/enum.html)很好地描述了 java 枚举 - 如前所述，枚举被定义为静态，因此它们不能被声明为局部变量

# standards - 您的团队对主要版本代码部署执行什么标准？

> ID：700833
> 
> 赞同：11
> 
> 时间：2009-03-31T13:03:01.207
> 
> 标签：standards, release-management

我很好奇其他团队在主要版本中发布（或部署）代码之前确保什么样的标准到位。

我不是在寻找每个问题的具体答案，但这里是我想要了解的一个想法。

*   对于基于服务器的应用程序，您是否确保监控到位？到什么程度......只是它响应 ping，它可以在任何给定时刻命中其所有依赖项，应用程序实际服务的逻辑是合理的（例如，计算 2+2 的服务实际上返回“4 ")
*   在发布代码之前是否需要自动构建脚本？意思是，任何开发人员都可以走到一个新盒子上，从源代码控制中拉出一些东西，然后开始开发？当然，考虑到操作系统和 IDE 之类的东西。
*   对于基于服务器的应用程序，自动化部署脚本怎么样？
*   您需要什么级别的文档才能“完成”项目？
*   如果它是基于服务器的，您是否确定您对系统的所有主要组件都有完整的备份计划？
*   您是否执行代码质量标准？考虑用于 .NET 或圈复杂度评估的 StyleCop。
*   单元测试？集成测试？性能负载测试？
*   对于如何处理应用程序的错误日志记录，您有标准吗？错误通知呢？

同样，不一定要逐行查找以上任何内容的答案。简而言之，**在正式认为对您的团队“完成”之前，代码发布必须完成哪些非编码项目？**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-20T19:02:43.460

最低限度：

1.  单元测试工作
2.  集成测试工作
3.  在测试阶段部署好
4.  测试阶段的手动简短检查

更好的：

1.  单元测试工作
2.  [检查样式没](http://checkstyle.sourceforge.net/)问题
3.  集成测试工作
4.  [通过jmeter](http://jakarta.apache.org/jmeter/)和测试覆盖率等指标
5.  在测试阶段部署好
6.  测试阶段的一些手动测试

最终部署到生产阶段

所有单元和集成测试都自动运行，最好在持续集成服务器上运行，例如由[ant](http://ant.apache.org/)或[maven完成的](http://maven.apache.org/)[CruiseControl](http://cruisecontrol.sourceforge.net/)。在开发 Web 服务时，使用[soapui](http://www.soapui.org/)进行测试可以正常工作。

如果使用了数据库，则在部署之前完成自动升级（例如使用[liquibase](http://www.liquibase.org/)）。使用外部服务时，需要进行额外的配置测试，以确保 URL 正常（来自应用程序的头部请求、数据库连接、wsdl 获取……）。在开发 webpps 时，在某些页面上进行 HTML[验证会很有用。](http://validator.w3.org/)手动检查布局（例如使用[浏览器](http://browsershots.org/)截图）会很有用。

（Java 开发的所有示例链接）

最后（但并非最不重要的）：所有验收测试是否仍然通过？产品是所有者想要的吗？在继续之前与他在测试系统上进行实时审查！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-31T13:15:35.387

我主要做网络开发，所以我的项目可能与你的不同。就在我的头顶...

*   确保所有 Web 服务都是最新的
*   确保所有数据库脚本/更改/迁移都已部署到生产服务器
*   最小化所有 js 和 css 文件。
*   确保所有单元/功能/集成/Selenium 测试都通过（我们的目标是在开发过程中实现 95% 以上的测试覆盖率，因此这些通常在确定问题时非常准确）

还有更多，我知道还有，但我现在想不出来。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-23T21:49:53.257

每个项目都是不同的，但根据经验，这是我在让代码投入使用之前尝试完成的核心工作。

没有特别的顺序：

1) 用户稍后可以找到的版本标识，这对于此版本必须是唯一的。（通常是与可分发、库和可执行文件相关联的“版本号”，或从“关于”对话框中可见的用户。可能是众所周知的寄存器或固件中的偏移量）

2) 用于生成发布的确切代码的快照。（单片机系统中发布的标签或分支对此有好处）

3) 必须记录和存档重新创建源所需的所有工具（如果没有这个，步骤 2 中的源将变得有限使用）

4）实际发布的存档（发布的确切安装程序的副本，谁知道在 7 年内你的工具可能无法构建它，但现在至少你有源代码和可安装在你身边用于调查目的）。

5) 此发布版本与之前的版本（即发布说明）之间的一组记录更改（我喜欢使用附加到列表的样式，以便用户可以在一个地方使用所有发布更改）。

6) 候选发布测试周期完成。使用可分发的创建负载并使用完整/经过审查的测试计划进行测试，以确保核心功能正常运行，所有新功能都存在并按预期运行。

7) 缺陷跟踪显示所有未完成的项目都被标记为 a) 已修复 b) 不是缺陷 c) 延期。

您可以根据领域或开发风格加入许多其他步骤，但我会声明大多数软件“应该”在每个版本中执行上述步骤。YMMV。

玩得开心冲进城堡。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-25T07:52:15.820

*   代码风格（自动）
*   自动化测试（单元和集成测试）
*   手动测试（包括测试和 beta 阶段）
*   白盒渗透测试工具（自动）
*   黑盒渗透测试工具（自动化）
*   在推出之前对测试/beta 阶段进行手动异常/日志监控
*   随时恢复到以前版本的能力
*   代码审查和“非法签入”

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-25T12:53:09.317

对于网络/内部应用程序，除了其他建议之外还有一件事。

确保让运营/部署团队参与进来，这样您就不会交付需要比他们拥有更多服务器的软件（不要假设推动需求的人已经拥有）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-25T19:07:43.967

*   查看清单：检查是否已完成为该版本计划的所有新功能、更改请求和错误修复。
*   构建（在构建机器中）在发布模式下编译没有任何警告或错误。
*   所有自动化的单元测试都运行没有错误。
*   所有消息和图像均已获得产品团队的批准。
*   性能检查并不比以前的版本差。
*   完整的（手动）测试计划已经过测试团队的检查，没有错误。
    *   该应用程序在许多可能的场景（不同的操作系统、数据库引擎、配置和第三方应用程序）中进行了测试。
    *   应用程序的所有功能都经过测试：很多次发生在我们身上，一个功能的更改破坏了另一个认为不相关的功能，发生了糟糕的事情，所以我们必须将其最小化。
    *   设置或部署也适用于所有场景
    *   该设置能够升级以前的版本

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-26T10:20:28.833

我们最近发布了一个主要版本，所以这在我的脑海中仍然很新鲜。我们制作了一个带有 GUI 的 Windows 应用程序，我们为其发布了二进制可执行文件，因此我的列表必然与仅 Web 版本的列表大不相同。

1.  发布候选人前往测试团队。他们至少需要几天的时间来玩它。如果他们发现任何我们认为是阻碍因素的错误，则发布将被中止。这假设您有一个测试团队。我们仅在自构建日期起至少一周后才清除候选版本。

2.  所有自动化测试都必须工作并通过。自动化测试被认为是对现场测试人员的补充。

3.  任何标记为“阻止程序”的错误都必须在最终构建中解决。

4.  宣传材料必须准备好（在我们的案例中，是网页更新和电子邮件通讯）。经销商会提前几周收到通知，以便他们也可以准备材料。这主要不是程序员关心的问题，但我们会检查营销声明的准确性。

5.  必须更新许可以反映我们正在使用的任何复制保护。我们的测试版和发布版使用不同的许可模型，而这种变化需要编程工作。

6.  必须更新安装程序和许可协议。由于 beta 版本有一个安装程序，这通常只是一个文本更改，但仍然由程序员实际更新安装脚本。

7.  任何对 beta 版本的引用都需要从应用程序本身中删除。我们错过了其中的一些，令人尴尬。

8.  帮助文件和手册必须完全更新和校对，因为它们是发布包的一部分。

9.  如果存在无法及时修复的错误，我们至少会尝试减轻损失——例如，检测到某某错误正在发生，并通过道歉错误消息中止操作。这极大地有助于感知产品的稳定性。

很明显，主要版本的困难不是编程问题，而是管理/营销问题。其中许多事情都需要程序员的关注——帮助安装程序、校对功能列表以确保其中没有废话、校对手册的技术部分、更新许可等。主要的技术差异是从错误修复到错误缓解。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-19T12:10:06.607

1.  没有可见的错误？行
2.  单元测试工作？好的（有些被忽略）哈哈好吧
3.  设置你确定。行
4.  错误记录？当然 ！:-) 我们需要这个！修复错误！
5.  所有在 Cruisecontrol.net 上都很好。

# asp.net - 在 gridview 中使用 mouseover/mouseout 交替行

> ID：700840
> 
> 赞同：1
> 
> 时间：2009-03-31T13:04:19.207
> 
> 标签：asp.net, javascript, gridview, mouseover

我目前有一个带有交替颜色的网格视图，银色和白色，带有蓝色标题（显然不可选择）。最初，我让这个 onmouseover/onmouseout 工作，但由于某种原因，昨天早上它没有工作，昨天一整天，我一直在挣扎，在谷歌上搜索答案并做不到。这是数据绑定函数：

```
protected void GridView_OnRowCreated(object sender, GridViewRowEventArgs e)
    {
        if (e.Row.RowType == DataControlRowType.DataRow)
        {
            e.Row.Attributes.Add("onclick", "onGridViewRowSelected('" + j.ToString() + "')");
            e.Row.Attributes.Add("onmouseover", "HighlightOn(this)");
            e.Row.Attributes.Add("onmouseout", "HighlightOff(this)"); 
        }
    } 
```

这是 onmouseover 和 onmouse out 函数：

```
function HighlightOn(rowid)
{   
    if (document.getElementById(gridViewCtlId).disabled == false)
    {
        if ($(selectedIndex).val() != rowid.rowIndex)
        {
            rowid.style.backgroundColor = '#8FBAEF';
        }
    }
}

function HighlightOff(rowid)
{
    if (document.getElementById(gridViewCtlId).disabled == false)
    {   
        if ($(selectedIndex).val() != rowid.rowIndex)
        {
            var modIdx = rowid.rowIndex % 2;
            if (modIdx == 0)
            {
                rowid.style.backgroundColor = 'Silver';
            }
            else
            {
                rowid.style.backgroundColor = 'White';
            }
        }
    }
} 
```

selectedIndex 是由这个设置的：

```
function getSelectedRow(rowIdx)
{
    getGridViewControl(rowIdx);
    if (gridViewCtl != null)
    {
        $(selectedIndex).val(rowIdx);
        return gridViewCtl.rows[rowIdx];
    }
    return null;
} 
```

这个函数只是通过在gridview中给它行的id来获取行（用于onclick事件来改变行的颜色）。

问题是这样的：当我单击一行时，它会突出显示。然后当我移动鼠标时，其他行变得有点突出显示，这是正确的，但是当我单击另一行并将鼠标移出该行时，它会被取消突出显示。当我再次单击它时，它是否保持突出显示。selectedIndex 只是页面上的一个隐藏字段。有谁明白为什么这不能正常工作？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-20T21:55:27.810

首先你可以用一些 CSS 来解决这个问题（IE6 不支持）：

```
 tbody tr:hover td {
  background-color: orange;
} 
```

如果我要使用 JavaScript，我会使用一种[不显眼的技术](http://en.wikipedia.org/wiki/Unobtrusive_JavaScript)。然后你可以跳过 C#。您可以这样做：

```
 $(function () {
  $("tbody tr")
    .mouseenter(function () {
      $(this).addClass("Highlight");
    })
    .mouseleave(function () {
      $(this).removeClass("Highlight");
    });
}); 
```

你需要一些 CSS 才能工作：

```
 tbody tr.Highlight td {
 background-color: orange;
} 
```

# cmake - cmake项目的eclipse索引器问题

> ID：700850
> 
> 赞同：2
> 
> 时间：2009-03-31T13:07:07.110
> 
> 标签：cmake, eclipse-cdt

我已经用 cmake 创建了 eclipse 项目。我将 vtk 与 qt 一起使用。目录结构如下：

```
parent_dir:
    source - source.h, source.cpp
    build - this is where the .project resides 
```

我已经使用工作区目录*/path/parent*启动了 Eclipse 。

我已按照 [http://www.cmake.org/Wiki/Eclipse_CDT4_Generator](http://www.cmake.org/Wiki/Eclipse_CDT4_Generator)中描述的说明进行操作。一切正常，但导航不起作用。也就是说，日食给了我*source.h*还没有被索引的警告。

此外，自动完成功能不适用于 qt 和 vtk 相关的类。我检查了 Project|Properties，其中包含 qt 和 vtk。我究竟做错了什么？我真的很想在我的项目中使用 eclipse 中的自动完成和导航。我在 ubuntu 8.04 64 位上使用 eclipse ganymede。

提前谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-31T13:32:03.710

根据 Wiki，您应该将构建树放在源代码树之外。

> 如果构建目录是源目录的子目录，则不会创建此链接资源，因为 Eclipse 不允许加载链接资源指向父目录的项目。因此，我们建议不要将构建目录创建为子目录，而是作为源目录的同级目录。

你需要做这样的事情：

```
mkdir /home/user/parent_dir_build
cd  /home/user/parent_dir_build
cmake /home/user/parent_dir 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-03-02T12:13:47.590

我花了很长时间才弄清楚。您应该确保“Build”目录确实不是项目目录的一部分，这意味着包含“CMakeLists.txt”的最高级别目录。

所以就我而言，我有“dir/tree/project_dir”和“dir/tree/project_dir/src”，那么我应该创建构建目录“dir/tree/build_dir”。

然后，我创建了一个创建 Debug 和 Release 项目的小脚本：

```
#!/bin/sh
mkdir -p $1_build/Release
mkdir -p $1_build/Debug
cmake -E chdir $1_build/Release cmake -G"Eclipse CDT4 - Unix Makefiles" -DCMAKE_BUILD_TYPE=Release ../../$1
cmake -E chdir $1_build/Debug cmake -G"Eclipse CDT4 - Unix Makefiles" -DCMAKE_BUILD_TYPE=Debug ../../$1 
```

使用参数“project_dir”从“dir/tree”调用脚本。

然后，在 Eclipse 中，单击“文件”-->“导入”-->“常规”-->“现有项目到工作区”。指定目录“dir/tree/$1_build”，它会自动识别这两个项目。

现在，Release 和 Debug 项目都已加载到 Eclipse 中，您可以使用所有不错的选项，例如 Code Assist（代码完成），以及通过双击错误进行快速调试。

请注意，您可以在 Eclipse 中添加一些文件过滤器以从项目树中删除 CMake 文件。

# c++ - Win32_BaseBoard 的 WMI 查询不返回任何结果

> ID：700854
> 
> 赞同：3
> 
> 时间：2009-03-31T13:08:26.590
> 
> 标签：c++, wmi

以下通过 WMI 检索主板信息的 C++ 代码**适用于大多数机器，除了一台**：

```
IEnumWbemClassObject* pEnumerator = NULL;
hres = pSvc->ExecQuery(
    bstr_t("WQL"), 
    bstr_t("Select  *  from  Win32_BaseBoard"),
    WBEM_FLAG_FORWARD_ONLY | WBEM_FLAG_RETURN_IMMEDIATELY, 
    NULL,
    &pEnumerator);

if (FAILED(hres))
{
    // handle error, exit
}
IWbemClassObject *pclsObj = NULL;
ULONG uReturn = 0;
while (pEnumerator)
{
    HRESULT hr = pEnumerator->Next(WBEM_INFINITE, 1, 
        &pclsObj, &uReturn);

    if(0 == uReturn)
    {
        break;
    }
    VARIANT vtProp;

    hr = pclsObj->Get(L"Product", 0, &vtProp, 0, 0);
    std::wstring productNo = vtProp.bstrVal;
    // do stuff with productNo
} 
```

具体来说，`pEnumerator->Next()`返回 0，因此`pclsObj`保留为 NULL。

您是否遇到过 WMI 查询`Win32_BaseBoard`不返回任何条目的情况？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-09-06T18:24:56.750

我在 VirtualBox 虚拟机中干净的 Windows XP SP3 /w .NET Framework 2.0 机器不返回任何记录，如“wmic”工具所示：

```
wmic:root\cli>BASEBOARD
No Instance(s) Available 
```

因此，这似乎是一种正常情况，而不仅仅是孤立的事件。我会计划没有记录出现的可能性。

# asp.net - 在标准 .net 2.0 Gridview 中选择行时，如何获取行键/单元格值并调用方法

> ID：700857
> 
> 赞同：0
> 
> 时间：2009-03-31T13:09:08.413
> 
> 标签：asp.net, vb.net, gridview, .net-2.0, grid

我有标准的 .net 2.0 gridview 控件，我想在选择行时从网格中获取行键或单元格值。

每次选择一行时，我还需要调用一个方法。

有谁知道我如何使用 ASP.net 和 VB 来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-31T13:18:42.197

我假设您的意思是通过 Select 命令进行选择。这会触发 SelectedIndexChanged 事件。从那里开始，您就有了 Key 的 SelectedDataKey.Value（或 .Values）。

```
Protected Sub GridView1_SelectedIndexChanged(ByVal sender As Object, _
            ByVal e As EventArgs) _
            Handles GridView1.SelectedIndexChanged
    Dim key As Object = GridView1.SelectedDataKey.Value
End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-31T13:17:01.983

将按钮或链接按钮添加到您的 gridView。

对于放在“选择”中的命令名称

在设计器窗口中，双击您的 gridView，您选择的索引更改方法将自动生成。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-01T14:33:52.153

[我更喜欢使用像Telerik](http://demos.telerik.com/aspnet-ajax/grid/examples/overview/defaultcs.aspx)这样的第三方网格，它允许服务器和客户端选择以及点击回发以处理一些逻辑。

迪克

# c++ - 如何利用 sqlite 进行撤消/重做功能？

> ID：700863
> 
> 赞同：5
> 
> 时间：2009-03-31T13:10:57.770
> 
> 标签：c++, sqlite, undo, undo-redo

我正在编写一个桌面应用程序来用 C++ 进行矢量绘图，并考虑使用 sqlite 来支持我的撤消/重做功能。

有人使用 sqlite 进行撤消/重做功能吗？它对你有什么影响？

澄清：

我知道堆栈方法，我什至用这种方法实现了一个应用程序。我遇到的问题是一段时间后很难维护。

我使用 sqlite 的意思是将我的整个内存数据结构映射到一个 sqlite 数据库中，并让 sqlite 为我做差异和修订。如果我创建内存数据库，速度应该不是问题。

这就是想法，我想知道这是否可行。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-31T22:23:58.830

当 SQLite 数据库是应用程序的数据文件格式时，使用 SQLite 来支持撤消/重做是有意义的。有关如何使用 SQLite 触发器执行此操作的说明，请参阅[SQLite 网站。](https://www.sqlite.org/undoredo.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-31T13:15:14.670

基本上，撤消/重做功能可以使用堆栈来实现：当用户执行操作时，您将一个对象压入堆栈，该对象表示操作前后状态之间的增量，当您撤消时，您“展开”三角洲。因为用户执行的每个操作都会在堆栈上创建一个新的增量对象，所以 sqlite 可能不是您选择的技术，因为它可能太慢了。我建议考虑仅将撤消/重做信息存储在内存中的可能性，并且仅当您想要实际保存撤消/重做历史记录时才将其线性化到磁盘上。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-31T13:35:55.307

看看[纪念品设计模式](http://sourcemaking.com/design_patterns/memento)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-02-02T19:25:07.277

这是在 sqlite3 中对我有用的

```
BEGIN;
-- enter your INSERT, UPDATE or DELETE command
-- if you want to keep it then run command below
COMMIT;
-- to undo - run command below
ROLLBACK; 
```

源[SQLite 事务（开始、提交、回滚）](https://www.tutlane.com/tutorial/sqlite/sqlite-transactions-begin-commit-rollback)

# sql - 在执行缓慢的查询时，您最酷的 SQL 优化是什么？

> ID：700868
> 
> 赞同：5
> 
> 时间：2009-03-31T13:11:36.910
> 
> 标签：sql, performance, refactoring

只是和我的一个同事说话。在去咖啡机的路上，他步履蹒跚地走着。

我问他“'swarmy' walk 是怎么回事？”，他说，“我只是将两个小时的查询缩短到 40 秒！感觉真好”。

他更改了一个使用游标的存储过程并引入了一个临时表，该表是从原始数据集重构的——我会尽快给他发电子邮件，以获取有关实际实现的更多信息。

但最终，他在嗡嗡作响。

问题是，什么样的 SQL 会在您的脑海中留下深刻印象并让您嗡嗡作响，同时优化执行缓慢的查询？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-31T13:18:03.963

当我学会如何创建和使用覆盖索引时，我不得不说。现在，这*是*一个性能助推器。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-31T13:25:01.560

使用 SQL 的 BULKIMPORT 将几个小时的继承 INSERT 代码减少到不到一分钟。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-31T13:19:42.477

采用写得不好的、充满游标的查询并消除游标、将代码减半并多倍地提高性能总是很好的。

一些最好的改进在于清晰度（并且通常也会带来不错的性能提升）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-31T13:37:04.587

更改 WHERE 子句中条件的顺序，使其首先过滤最具区分性的条件（同时删除来自非区分列（如性别）的索引）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-31T15:59:38.007

过去，我在一个用 COBOL 编写的 CICS/DB2 系统上工作。尽管我们拥有所有正确的索引和`WHERE`子句，但我们的许多查询都在进行全表扫描（而且速度很慢）。

事实证明（我可能有这个倒退，已经 15 年了）问题是我们使用`PIC S9(n) COMP`in`WORKING STORAGE`作为查询参数，但 DB2 想要`PIC S9(n) COMP-3`. 由于使用了错误的数据类型，DB2 不得不进行全表扫描，以便将数据库中的值转换为我们传入的值。我们更改了变量定义，查询现在能够使用索引，这极大地提高了我们的表现。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-12-10T14:55:15.967

我有一个最初为 SQL Server 6.5 编写的查询，它不支持 SQL 92 连接语法，即

```
select foo.baz
from foo
  left outer join bar
  on foo.a = bar.a 
```

而是写成

```
select foo.baz
from foo, bar
where foo.a *= bar.a 
```

查询已经有一段时间了，相关数据的积累导致查询运行太慢，大约需要 90 秒才能完成。当这个问题出现时，我们已经升级到 SQL Server 7。

在处理了索引和其他复活节彩蛋之后，我将连接语法更改为符合 SQL 92。查询时间下降到 3 秒。

我想我再也不会有那种感觉了。我喜欢%$^ing 英雄。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-31T13:15:26.887

对不起，我不倾向于从那种事情中得到嗡嗡声，但大多数情况都是非常基本的，监控查询的性能并添加索引以加快它们的速度。

现在，通过更改类中的数据结构和算法来提高我编写的“真实”代码的速度，这就是我得到我的嗡嗡声的地方（并且被誉为工作中性能修复的首选人）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-31T13:18:03.527

嘿，在使用 sqlite 的 iphone 上，我使用独占写入事务立即将数据库处理时间从 40 秒减少到 2 秒......我非常高兴这样做

因为这是我在嵌入式设备上的第一次 sql 体验 - 与通常的服务器相关内容（索引、规范化等）完全不同

--- 就服务器而言，索引是真正的祝福。此外，如果您有点痛苦并尽可能多地删除表中的空值，您会对性能提升感到惊讶 - 没有多少开发人员专注于空值，他们通常使用索引和其他记录在案的东西

其他一些较少被利用的方法 - 使用 xml 一次性处理多个批量插入/更新/删除，而不是一次执行 1 个插入 - 在 sql 2005 中，这可能非常酷

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-31T13:28:34.437

这都是关于索引的。并避免使它们无用的愚蠢事物。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-31T13:34:19.837

将一个非常长的存储过程拆分为一组存储过程，该存储过程执行大量“如果在下午 5 点之后，则返回这段 sql”并且运行时间超过 20 秒，这些存储过程由一个控制 sp 调用，并将时间缩短到亚秒级响应。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-31T13:20:31.383

我在上一个问题上回答了这个问题（[“您通过最小的更改获得了最大的性能改进？”](https://stackoverflow.com/questions/545844/biggest-performance-improvement-youve-had-with-the-smallest-change/)），然而，这是一个如此简单的改进，但却经常被忽视，因此值得重复：

[索引！](https://stackoverflow.com/questions/545844/biggest-performance-improvement-youve-had-with-the-smallest-change/545877#545877)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-31T13:30:32.467

好吧，我们有类似的事情，我们在 Open Freeway 网站上的查询速度很慢。答案不是优化查询，而是优化它所在的服务器。我们增加了缓存限制和缓存大小，这样服务器就不会那么频繁地运行查询。

这大大提高了系统的速度，最终让客户满意！:)

不完全是原帖优化技巧的水准，但绝对让我们嗡嗡作响！

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-03-31T14:56:56.237

一个词，动态查询

如果您使用大量参数进行搜索，则可以将它们从 SQL 字符串中剔除。这大大加快了我的查询速度，而且相对轻松。

```
Create PROCEDURE dbo.qryDynamic
( 

@txtParameter1 nvarchar(255),
@txtParameter2 nvarchar(255),

AS
SELECT     qry_DataFromAView.*
FROM         qry_DataFromAView
BEGIN

    DECLARE @SQL nvarchar(2500)
    DECLARE @txtJoin nvarchar(50)

    Set @txtJoin = ' Where '

    SET @SQL = 'SELECT     qry_DataFromAView.*
                FROM         qry_DataFromAView'

    IF @txtParameter1 is not null
    Begin
        SET @SQL=@SQL + @txtJoin + ' Field1 LIKE N''%'' + @dynParameter1 + N''%'') '
        Set @txtJoin = ' And '
    end

    IF @txtParameter2 is not null
    Begin
        SET @SQL=@SQL + @txtJoin + ' Field2 LIKE N''%'' + @dynParameter2 + N''%'') '
        Set @txtJoin = ' And '
    end

    SET @SQL=@SQL + ' ORDER BY Field2'

    Exec sp_executesql @SQL, N'@dynParameter1 nvarchar(255), @dynParameter2 nvarchar(255)',  @dynParameter1 = @txtParameter1 ,@dynParameter2 = @txtParameter2

END
GO 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2010-08-10T17:36:25.497

（话题的一半）

我将一个 3000 行的存储过程重写为 LINQ2SQL/C#。存储过程在一堆未索引的临时表之间处理大量数据。LINQ2SQL 版本将数据读取到几个字典和 ILookups 中，然后我使用普通的旧 C# 代码手动加入数据。

存储过程耗时约 20 秒，LINQ2SQL/C# 版本耗时 0.2 秒。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2010-08-10T12:14:03.040

在能够使用交叉表查询来废弃处理和查找的大量（技术术语）之后，我有一种温暖的光芒......

通常它是简单的事情，比如添加索引或只获取您需要的数据，但是当您发现一个适合您以前见过的答案的问题时......好时机！

# c# - 通过索引检索 DataView 中的行

> ID：700869
> 
> 赞同：1
> 
> 时间：2009-03-31T13:11:46.537
> 
> 标签：c#, dataview

我有一个 DataView，它已按某种顺序排序。如何使用索引检索值。

像这样的东西：

```
if(dv.rows[0]["name"]=="xxx")  
{  
  --- do something ---  
}  
else  
  --- something else --- 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-31T13:22:43.217

你试过了吗：

```
DataRowView rowView = dv[index]; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-31T13:15:54.640

试试下面的代码

将排序后的 DataView 移动到 DataTable 中

```
DataTable dt = dv.ToTable(); 
```

然后使用

```
if (dt.Rows[0]["name"] == "xxx")
{
  [...]
} 
```

它会起作用的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-05-24T09:13:35.567

您可以直接使用 DataView，而不是将整个内容转换回表格：

要从 a 中获取一行`DataView`，您可以使用`Item`返回 a 的属性，`DataRowView`然后您可以调用`Item`get 来获取单元格，所有这些单元格都可以缩短为：

```
// Returns object, so needs to be cast to your required type:
if ((string)dv[0]["CellName"] == "ABCD")
{
  [...]
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-31T13:16:34.653

我不太清楚这是否是您正在寻找的答案：

```
if (dv.Rows[0].Cells["CellName"].Value == "ABCD")
{

} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-12-01T01:33:34.587

我认为，直接使用 DataRowView 比将 dv 转换回 DataTable （它可能从一开始就来自哪里）更简单。
`var currRow = dv[0]; currRow["your_col_name"]?.ToString();`

# build - 使用 NAnt 发布 WebApplication

> ID：700871
> 
> 赞同：4
> 
> 时间：2009-03-31T13:12:05.117
> 
> 标签：build, nant, publish

是否可以使用 NAnt 在解决方案上完成发布（如在 Web 应用程序项目上的 Visual Studio 中发布）？我只是找不到解决方案。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-31T13:26:17.280

他们的关键是使用内置的“_CopyWebApplication”目标。

这就是我所做的

```
<target name="compile" description="Compiles the project.">
        <exec basedir="." program="${DotNetPath}msbuild.exe" commandline=" src/MyProject.Web/MyProject.Web.csproj /nologo 
  /t:Rebuild
  /t:ResolveReferences;_CopyWebApplication
  /p:OutDir=../../output/build/bin/
  /p:WebProjectOutputDir=../../output/build/
  /p:Debug=${debug}
  /p:Configuration=${configuration}
  /v:m"
    workingdir="." failonerror="true" />
    </target> 
```

具有以下目录结构：

```
/project.build
/src/myprojct.sln
/src/myporject.web/myproject.web.csproj
/output 
```

编辑：我也使用它来使用 YUI 压缩来压缩我的 css 和 js

```
<target name="compress-js">
        <foreach item="File" property="filename">
            <in>
                <items basedir="output/build/assets/javascript/">
                    <include name="/**/*.js" />
                    <exclude name="/**/*.min.js" />
                    <exclude name="/**/*.pack.js" />
                </items>
            </in>
            <do>
                <exec basedir="." program="${JavaPath}java" commandline=" -jar S:\yuicompressor-2.4.1\build\yuicompressor-2.4.1.jar --type js --charset utf-8 -o &quot;${filename}&quot; &quot;${filename}&quot;" failonerror="true" />
            </do>
        </foreach>
    </target>

    <target name="compress-css" depends="combine-css">
        <foreach item="File" property="filename">
            <in>
                <items basedir="output/build/assets/css/">
                    <include name="/**/*.css" />
                    <exclude name="/**/*.min.css" />
                    <exclude name="/**/*.pack.css" />
                </items>
            </in>
            <do>
                <exec basedir="." program="S:\Java\jdk1.6.0_11\bin\java" commandline=" -jar S:\yuicompressor-2.4.1\build\yuicompressor-2.4.1.jar --type css --charset utf-8 -o &quot;${filename}&quot; &quot;${filename}&quot;" failonerror="true" />
            </do>
        </foreach>
    </target> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-24T07:17:09.527

使用 MSBuild 胜过使用 NAnt 的目的，NAnt 是替代 MSBuild 的东西，使用下面的代码对 Web 应用程序项目进行干净的 NAnt 编译，就像在 VS 2003/2005/2008 中一样。

这个对我有用！

```
<?xml version="1.0"?>
<project name="MyTest" default="run">
    <property name="basename" value="MyTest1x"/>
    <property name="debug" value="false"/>
    <property name="copytarget" value="c:\temp"/>

    <target name="clean">
        <delete>
            <fileset basedir="${copytarget}">
                <include name="bin/${basename}.dll"/>
                <include name="**/*.???x"/>
                <include name="Web.config"/>
            </fileset>
        </delete>
    </target>

    <target name="build">
        <mkdir dir="${copytarget}/bin" />
        <csc target="library" output="${copytarget}/bin/${basename}.dll" >
            <sources>
                <include name="*.cs"/>
            </sources>
        </csc>
    </target>

    <target name="run" depends="clean,build">
    <copy todir="${copytarget}" overwrite="true">
      <fileset basedir=".">
             <include name="**/*.???x" />
             <include name="Web.config" />
          </fileset>
       </copy>
   </target>
</project> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-03T15:01:18.030

我知道这是一个老问题，但我刚刚学到了一些东西，所以我决定分享：虽然“_CopyWebApplication”目标存在并且有效，但从 .NET 4.0 开始，它已被“ Microsoft.Web.Publishing.targets 中的 _WPPCopyWebApplication" 目标，支持 web.config 转换语法等新功能。

（转发所有类似措辞的问题，所以不要投票给这个:)）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-29T02:36:43.200

以下是使用 nant 的 MSBUILD 任务的方法：

```
<property name="debug" value="AutomatedDebug" />
<property name="configuration" value="Debug;TargetFrameworkVersion=v3.5" />

    <msbuild project="src\WebApplication1\WebApplication1.csproj" failonerror="true">
      <arg value="/nologo" />
      <arg value="/t:Rebuild" />
      <arg value="/t:ResolveReferences;_CopyWebApplication" />
      <arg value="/p:OutDir=../../build/Debug/WebApplication/" />
      <arg value="/p:WebProjectOutputDir=../../build/Debug/WebApplication-Deploy/" />
      <arg value="/p:Debug=${debug}" />
      <arg value="/p:Configuration=${configuration}" />
      <arg value="/v:m" />
    </msbuild> 
```

这会将 WebApplication 编译到可部署的文件夹中，就像使用 Visual Studio 中的“发布”功能一样。

# string - 从分隔字符串构建对象的最佳方法（希望不是循环大小写）

> ID：700872
> 
> 赞同：3
> 
> 时间：2009-03-31T13:12:20.140
> 
> 标签：string, parsing, loops, switch-statement

这个问题感觉好像已经被问过了，但我没有找到任何东西，所以这里......

我有一个构造函数，它被传递了一个分隔的字符串。我需要从该字符串中填充对象的实例变量。我可以很容易地用分隔符分割字符串，给我一个字符串数组。我知道我可以简单地遍历数组并使用 ifs 或基于当前数组索引的 switch/case 语句设置我的实例变量——但这感觉有点讨厌。伪代码：

```
String[] tokens = <from generic string tokenizer>;

for (int i = 0;i < tokens.length;i++) {
   switch(i) {
      case(0): instanceVariableA = tokens[i];
      case(1): instanceVarliableB = tokens[i];
      ...
   }
} 
```

有人对我如何做得更好/更好有任何想法吗？

对于它的价值，我正在使用 Java，但我想这与语言无关。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-31T13:18:34.883

嗯...“讨厌”是构造函数处理参数的方式。如果您无法更改，那么您的代码片段将尽可能好。

不过，您可以摆脱 for 循环...

```
instanceVariableA = tokens[0];
instanceVariableB = tokens[1]; 
```

然后引入常量（为了便于阅读）：

```
instanceVariableA = tokens[VARIABLE_A_INDEX];
instanceVariableB = tokens[VARIABLE_B_INDEX]; 
```

**注意**：如果您可以更改字符串参数语法，您可以引入一个简单的解析器，并通过一些反射，以稍微更优雅的方式处理这个事情：

```
String inputString = "instanceVariableA=some_stuff|instanceVariableB=some other stuff";
String[] tokens = inputString.split("|");
for (String token : tokens)
{
    String[] elements = token.split("=");
    String propertyName = tokens[0];
    String propertyValue = tokens[1];
    invokeSetter(this, propertyName, propertyValue); // TODO write method
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-31T13:21:03.673

您不能使用“for-each”循环来消除大部分混乱吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-31T13:23:33.903

我真的认为你这样做的方式很好，Manrico 也对使用常量提出了一个很好的建议。

另一种方法是创建一个带有整数键和字符串值的 HashMap，其中键是索引，值是属性的名称。然后，您可以使用一个简单的循环和一些反射来设置属性。反射部分可能会使这有点慢，但在另一种语言（例如 PHP）中，这会更干净。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-31T13:28:09.587

特定于 Python 的解决方案：

比方说`params = ["instanceVariableA", "instanceVariableB"]`。然后：

```
self.__dict__.update(dict(zip(params, tokens))) 
```

应该管用; 这大致相当于

```
for k,v in zip(params, tokens):
    setAttr(self, k, v) 
```

取决于访问者的存在/不存在。

在非动态语言中，您可以构建从字符串到某种引用/访问器的映射来实现相同的效果。

（还要注意`zip`当任一列表用完时停止。）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-31T13:30:22.483

只是一个未经检验的想法，

保留原始令牌...

```
String[] tokens = <from generic string tokenizer>; 
```

然后创建

```
int instanceVariableA = 0;
int instanceVariableB = 1; 
```

如果您需要使用它，那么只需

```
tokens[instanceVariableA]; 
```

因此不再有循环，不再`VARIABLE_A_INDEX`......

也许**JSON**可能会有所帮助？

# python - Python脚本中的EOFError

> ID：700873
> 
> 赞同：5
> 
> 时间：2009-03-31T13:12:33.587
> 
> 标签：python, pickle, raw-input, eoferror

我有以下代码片段：

```
def database(self):
    databasename=""
    host=""
    user=""
    password=""
    try:
        self.fp=file("detailing.dat","rb")
    except IOError:
        self.fp=file("detailing.dat","wb")
        pickle.dump([databasename,host,user,password],self.fp,-1)
        self.fp.close()
        selffp=file("detailing.dat","rb")
        [databasename,host,user,password]=pickle.load(self.fp)

    return 
```

它有错误：

```
Traceback (most recent call last):
  File "detailing.py", line 91, in ?
    app=myApp()
  File "detailing.py", line 20, in __init__
    wx.App.__init__(self,redirect,filename,useBestVisual,clearSigInt)
  File "/usr/lib64/python2.4/site-packages/wx-2.6-gtk2-unicode/wx/_core.py", line 7473, in __init__
    self._BootstrapApp()
  File "/usr/lib64/python2.4/site-packages/wx-2.6-gtk2-unicode/wx/_core.py", line 7125, in _BootstrapApp
    return _core_.PyApp__BootstrapApp(*args, **kwargs)
  File "detailing.py", line 33, in OnInit
    self.database()
  File "detailing.py", line 87, in database
    [databasename,host,user,password]=pickle.load(self.fp)
  File "/usr/lib64/python2.4/pickle.py", line 1390, in load
    return Unpickler(file).load()
  File "/usr/lib64/python2.4/pickle.py", line 872, in load
    dispatch[key](self)
  File "/usr/lib64/python2.4/pickle.py", line 894, in load_eof
    raise EOFError
EOFError 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-31T13:21:31.363

除非您有错字，否则问题可能出在您将文件句柄分配给`selffp`not的这一行中`self.fp`：

```
selffp=file("detailing.dat","rb") 
```

如果这是一个错字，并且您的代码实际上将文件打开到`self.fp`，那么您可能希望验证该文件是否确实具有内容（即：以前的泡菜工作）...错误表明该文件是空的。

编辑：在对这个答案的评论中，S. Lott 很好地总结了为什么拼写错误会产生你看到的错误，我在这里粘贴以保证答案的完整性：“selffp 将是未使用的打开文件，而 self.fp （旧的关闭文件）将用于加载”。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-31T13:48:23.157

这是我推荐使用的版本：

```
def database(self):
    databasename=""
    host=""
    user=""
    password=""
    try:
        self.fp=open("detailing.dat","rb")
    except IOError:
        with open("detailing.dat", "wb") as fp:
            pickle.dump([databasename,host,user,password],fp,-1)

        self.fp=open("detailing.dat","rb")
        [databasename,host,user,password]=pickle.load(self.fp)

    return 
```

正如已经指出的那样，self.fp 上有一个错字。但我注意到还有其他一些可能会导致问题的事情。

首先，您[不应该直接使用文件构造函数](http://docs.python.org/library/functions.html#file)。您应该改用内置的 open 函数。

其次，您应该避免在 finally 块之外调用文件的关闭方法。在这种情况下，我使用了带有块的 python 2.6。您可以在 Python 2.5 中通过以下命令使用它：

```
from __future__ import with_statement 
```

如果在任何地方抛出异常，这将防止文件被卡在打开状态（因为它会在退出 with 块时关闭文件）。虽然这不是您的问题的原因，但记住这一点很重要，因为如果文件对象的方法之一抛出异常，该文件将在 sys.traceback 中无限期地保持打开状态。

（请注意，您可能应该接受 Jarret Hardie 的回答，但他发现了这个错误 :-)）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-07-27T12:35:28.603

当我没有选择正确的模式来读取文件（`wb`而不是`rb`）时，我收到了这个错误。改回`rb`并不足以解决问题。但是，再次生成一个新的干净泡菜文件解决了这个问题。似乎没有选择正确的模式来打开二进制文件会以某种方式“损坏”该文件，然后该文件将无法打开。

但我是 Python 的初学者，所以我可能也错过了一些东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-07-13T17:17:19.063

虽然这不是对 OP 问题的直接答案——我在寻找`EOFError`尝试使用 : 解开二进制文件的原因时偶然发现了这个答案`pickle.load(open(filename, "r"))`。

```
import cPickle as pickle 
A = dict((v, i) for i, v in enumerate(words))
with open("words.pkl", "wb") as f:
    pickle.dump(A, f)

#...later open the file -- mistake:trying to read a binary with non-binary method
with open("words.pkl", "r") as f:
    A =pickle.load(f) # EOFError

# change that to
with open ("words.pkl", "rb") as f: # notice the "rb" instead of "r"
    A = pickle.load(f) 
```

# actionscript-3 - 我应该关闭（）声音，还是停止（）频道？(AS3)

> ID：700893
> 
> 赞同：4
> 
> 时间：2009-03-31T13:17:33.463
> 
> 标签：actionscript-3, mp3

我试图让 Flash 应用程序在用户离开页面时停止下载任何 MP3。到目前为止，我一直在使用 stop(); 频道上的命令，但是，您可以在浏览器活动中看到 MP3 仍在下载。从积极的方面来说，声音已经停止。

有任何想法吗？我试过 close(); 命令，但我只是收到 #2029 错误。

提前致谢。

最亲切的问候

汤姆

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-31T13:22:44.903

碰巧，我刚刚找到了答案。

基本上，#2029 错误与 MP3 流有关。当 MP3 流下载完成后，它不再存在，因此无法关闭。

我通过使用以下功能来关闭和停止我的声音播放/流式传输来解决此问题：

```
function stopMusic():void
{       
    if (my_sound.bytesLoaded < my_sound.bytesTotal)
    {
        my_sound.close();
    }

    if (my_channel) 
    {
        my_channel.stop();
    }
} 
```

从函数中可以看出，它仅在 MP3 仍在流式传输时使用 close() 命令。如果加载了 MP3，它只会停止通道。

希望这对将来的人有所帮助！

汤姆

# asp.net - jQuery 与 ASP.NET Ajax

> ID：700899
> 
> 赞同：5
> 
> 时间：2009-03-31T13:18:08.597
> 
> 标签：asp.net, jquery, asp.net-ajax

jQuery 和 ASP.NET Ajax 有什么区别？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-31T13:22:17.150

它们是非常独立的东西，[jQuery](http://jquery.com/)是一个 JavaScript 框架，能够执行一些基本的 Ajax 功能，而[ASP.NET Ajax](http://www.asp.net/ajax/)是一个功能更全面的 Ajax 框架，它包含 .NET 控件和服务器端方面以及客户端方面。

jQuery 的主要关注点是创建一个标准、稳定和强大的框架，以便在客户端中作为一个整体使用 JavaScript。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-31T13:54:58.883

尽管 ASP.NET AJAX 包含一个客户端框架，但它可能因其服务器端控件而闻名/恐惧/厌恶，尤其是 UpdatePanel。使用 ASP.NET AJAX 获得的是开箱即​​用的 AJAX，用于**最基本的东西**，而无需编写一行 JavaScript。

另一方面，如果您**需要**编写一些 JavaScript 或开箱即用，那么使用 ASP.NET AJAX 很快就会变得有点乏味。

另一方面，jQuery 是轻量级的，并且需要您编写 JavaScript，尽管在大多数情况下，jQuery 的家伙已经很好地隐藏了丑陋的 JavaScript 东西，所以除了一个小的学习曲线之外，它非常自然（特别是如果你在 CSS 选择器中处于首页拉伸状态）。

将 jQuery 与 ASP.NET 一起使用的主要问题可能是，如果您对 DOM 搞得太多，您可能会遇到 ViewState/Event 验证问题。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-31T13:22:00.210

[jQuery](http://jquery.com/)是一个独立的 javascript 库，可以集成到任何开发环境中。它被广泛使用，并且存在许多很棒的插件。

它的用途远不止 AJAX 功能。就像遍历当前元素并更改它们的功能一样。

ASP.NET AJAX 完全是另一回事，因为它只关注 .NET 环境中的类似 AJAX 的功能。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-31T13:29:06.230

ASP.NET Ajax 的主要目标是使用简单的 JavaScript 表示法从客户端调用 ASP.NET Web 服务。它还提供对某些 ASP.NET 服务器功能的客户端访问。以个人资料为例。所有其他操作最好使用 jQuery 执行。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-25T09:10:12.930

在我切换到 jQuery 之前，我广泛使用了 microsoft 的 Ajax Control Toolkit 2 年，根据我的经验，我认为 jquery ajax 调用比 ajax 控制工具包库更轻量级、更高效。除此之外，效率当然取决于您通过 ajax 调用发送和接收的数据。

您还可以在 jQuery ajax 调用中添加自定义 HTTP 状态代码，以捕获服务器上的任何错误并返回适当的响应。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-31T13:41:47.963

[@Andrew](https://stackoverflow.com/users/34211/andrew-hare)和[@Ólafur](https://stackoverflow.com/users/22459/211lafur-waage)一针见血，但我要补充一点，将这两种 ajax 开发方法分开的最大概念是，使用 jQuery，您可以完全控制客户端和服务器之间发生的事情。使用 MS AJAX 工具包，您可以放弃对这两个点之间发送内容的任何控制。如果你想“接近金属”，你最好选择 jQuery。如果您只是在开发一些需要零定制和快速交付的快速而肮脏的解决方案，那么您的客户所关心的就是，也许看看 MS AJAX 工具包。

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2009-03-31T13:25:10.390

顺便说一句 - scott gu 正式宣布 asp.net 将包括对 jquery 的支持（也包括完整的智能感知）和他们的 ajax 框架（这真的很臃肿）

检查此链接 - [http://weblogs.asp.net/scottgu/archive/2008/09/28/jquery-and-microsoft.aspx](http://weblogs.asp.net/scottgu/archive/2008/09/28/jquery-and-microsoft.aspx)

如果你使用过 ms ajax，你会意识到它真的很臃肿，而且 ms ajax 所做的很多事情 - 你可以通过 jquery 编写几行 javascript 代码来实现，你会节省很多带宽和性能

您甚至可以通过 jquery 调用 asp.net json + xml Web 服务，只需编写几行代码

# google-analytics - 使用谷歌分析跟踪单个网站中的多家公司

> ID：700900
> 
> 赞同：1
> 
> 时间：2009-03-31T13:18:15.023
> 
> 标签：google-analytics, tracking, statistics

我的任务是在我们的 (ASP.NET) 应用程序中实现 Google Analytics。这是场景：

1.  一个域上的单个网站
2.  多家公司都使用这个网站
3.  需要按公司和整体收集统计数据
4.  需要按公司或所有人分配报告访问权限（如果您可以将一系列报告分配给特定用户，那就太好了）

从可用的文档中，我不确定是否使用：

过滤器（对虚拟 url 应用过滤器以细分公司）

```
<script type="text/javascript">
   var pageTracker = _gat._getTracker("UA-12345-1");
   pageTracker._initData();
   pageTracker._trackPageview("/site.com/companyName/var1/var2");
</script> 
```

或细分

```
<script type="text/javascript">
    var pageTracker = _gat._getTracker("UA-12345-1");
    pageTracker._initData();  
    pageTracker._trackPageview();
    pageTracker._setVar("companyName");
    pageTracker._setVar("var1");
    pageTracker._setVar("var2");
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-31T13:24:09.720

虚拟地址可与 Google Analytics 配合使用。你会看到那里的内容页面给你一个列表，比如

/companyA/welcome.aspx
/companyA/aboutus.aspx
/companyC/orderstatus.aspx
/companyB/welcome.aspx
/companyA/confirmorder.aspx
/companyC/welcome.aspx

然后，您可以按公司名称过滤列表，它只会显示“ *welcome”或“companyA* ”它还会显示与查询匹配的内容的图表。

那里的列将显示；页面，浏览量，唯一浏览量，平均。页面停留时间、跳出率、退出百分比、美元指数。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-31T15:45:57.943

您发布的两个想法都有类似的缺陷。他们不隔离访问。为了隔离对每个公司报告的访问，您必须为每个公司创建一个单独的代码。因此，您可能有`UA-12345-1`、`UA-12345-1`和`UA-12345-1`。ASP.NET 将负责放入正确的代码。这样，您可以授予特定公司的用户访问权限。

唯一的问题是所有公司都缺乏统一的报告。我不知道 Analytics 可以同时进行隔离和统一报告。祝你好运！

# python - 如何设计多线程 GUI 网络应用程序？

> ID：700905
> 
> 赞同：2
> 
> 时间：2009-03-31T13:18:43.633
> 
> 标签：python, multithreading, user-interface

我正在使用 Python 开发一个小型实用程序应用程序。

网络将发送和接收消息。GUI 将显示来自 GUI 的消息，并为输入要发送的消息提供用户输入。还有一个*存储*部分，我称之为存储部分，它将获取所有网络消息并将它们保存在某种数据库中，以便稍后提供某种搜索。

我的问题是，设计这个的最佳方法是什么？当然，所有这些都必须在单独的线程中发生，但我想知道的是如何以最佳方式在它们之间传递信息？我应该使用 Python 中可用的哪种信号传递/线程锁定来避免可能出现的问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-31T14:14:38.587

对于这个问题，一个可能是最好的解决方案是使用[Twisted](http://twistedmatrix.com/)。它支持所有的 GUI 工具包。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-31T13:40:48.010

我认为您可以使用[队列](http://docs.python.org/library/queue.html)在 GUI 和网络线程之间传递消息。

至于一般的 GUI 和线程，您可能会发现[PyGTK 和 Threading](http://www.oreillynet.com/onlamp/blog/2006/07/pygtk_and_threading.html)文章很有趣。

# vb.net - VB 无法访问代码错误/警告

> ID：700916
> 
> 赞同：6
> 
> 时间：2009-03-31T13:21:52.160
> 
> 标签：vb.net, compiler-construction

我已经使用 VB.Net 一年多了，只是注意到了这一点

我要疯了，还是 VB.Net**没有**“无法访问的代码”警告？

下面的编译非常愉快，没有任何警告或错误，即使在两个 writeline 调用之间有返回。

```
Sub Main()
    Console.WriteLine("Hello World")
    Return
    Console.WriteLine("Unreachable code, will never run")
End Sub 
```

我错过了什么吗？有什么方法可以打开我找不到的。

如果没有，是否有充分的理由省略它？（即，或者我认为这是一种可悲的状况是正确的）

原谅这个问题的咆哮，这不是咆哮，我想要一个答案。

谢谢

* * *

我在[MS Connect](http://connect.microsoft.com)上提出了这个问题，作为 bug# 428529

**更新**

我从 VB Teams 项目经理那里收到了以下信息

> 感谢您花时间报告此问题。编译器对这种情况的支持有限，正如您所指出的，我们没有针对无法访问的代码的警告。我们的流量分析算法确实可以处理一些场景，例如：

```
Sub Main()
    Dim x As Integer
    Return
    x = 4
End Sub 
```

> 在这种情况下，您将收到一条警告说 x 从未被分配。但是，对于您提到的情况，我们将不得不考虑在未来的版本中实现它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-31T13:30:49.360

我的猜测是这是编译器的疏忽。流控制在任何语言中都是一个很难解决的问题，尤其是在像 VB 这样具有许多不同流控制机制的语言中。例如，

*   例外
*   去
*   出错时（恢复、转到等...）
*   退出通话

如果您对此问题有强烈的感觉，**请在**[Connect](https://connect.microsoft.com/VisualStudio)上提交错误。我们确实非常重视通过 Connect 提交的错误，并尽最大努力修复尽可能多的错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-31T14:05:04.753

他们在以下帖子中提到了这一点：

[https://stackoverflow.com/questions/210187/usage-statistics-c-versus-vb-net](https://stackoverflow.com/questions/210187/usage-statistics-c-versus-vb-net)

见最后一个帖子。

我想您可以使用 FXCop 来检查您的代码，或者从以下位置获取 Resharper 的副本：

[http://www.jetbrains.com/resharper/](http://www.jetbrains.com/resharper/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-31T21:13:44.630

我想谈谈贾里德的回答。

他提出的大部分问题对于数据流分析来说都不是问题。

一个例外是“错误/恢复”。他们把数据流分析搞得一团糟。

然而，这是一个非常简单的问题来缓解：

如果在一个方法中使用了多个“On Error”语句，或者使用了“Resume next”语句，则只需关闭数据流分析并报告通用警告即可。一个好的可能是“不推荐使用错误/恢复，而是使用异常”。:)

在只有“On Error”语句而没有“resume”语句的常见情况下，您几乎可以进行正常的数据流分析，并且应该从中得到合理的结果。

最大的问题在于现有 DFA 代码的实现方式。它不使用控制流图，因此更改它最终会非常昂贵。我认为，如果您想解决这类问题，您确实需要删除现有的 DFA 代码并将其替换为使用控制流图的代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-31T13:30:40.890

AFAIK，你是对的，VB.NET 没有给你警告。C# 可以。

# c# - 为什么安装 Visual Studio 2008 后调试器下的 catch(TException) 处理块行为不同？

> ID：700935
> 
> 赞同：9
> 
> 时间：2009-03-31T13:25:47.033
> 
> 标签：c#, .net, visual-studio, visual-studio-2008

考虑下面的控制台应用程序，该应用程序具有一个带有通用 catch 处理程序的方法，该处理程序可以捕获 type 的异常`TException`。

当此控制台应用程序使用“调试”配置构建并在 Visual Studio 调试器下执行（即通过 *.vshost.exe）时，在 Visual Studio 2005 和 Visual Studio 2008 中都会失败。

我相信这个问题是在我安装 Visual Stuido 2008 之后才出现的。

```
using System;

class Program
{
    static void Main()
    {
        Console.WriteLine(Environment.Version);
        CatchAnException<TestException>();

        Console.ReadKey();
    }

    private static void CatchAnException<TException>()
        where TException : Exception
    {
        Console.WriteLine("Trying to catch a <{0}>...", typeof(TException).Name);
        try
        {
            throw new TestException();
        }
        catch (TException ex)
        {
            Console.WriteLine("*** PASS! ***");
        }
        catch (Exception ex)
        {
            Console.WriteLine("Caught <{0}> in 'catch (Exception ex)' handler.", ex.GetType().Name);
            Console.WriteLine("*** FAIL! ***");
        }
        Console.WriteLine();
    }
}

internal class TestException : Exception
{
} 
```

在以下情况下，代码会按预期运行：

*   如果使用 'Release' 配置构建，它会成功。
*   如果直接通过 *.exe 执行，而不是通过 Visual Studio (F5)，它会成功。
*   如果通过放置调试器的`System.Diagnostics.Debugger.Launch();`第 1 行来附加调试器`Main()`仍然成功。

当控制台应用程序从 Visual Studio（2005 或 2008）中启动并因此在 ConsoleApplication.vshost.exe 下执行时，它会失败。

**这是我失败案例的输出**

```
2.0.50727.3068
Trying to catch a <TestException>...
*** FAIL! ***

Caught <TestException> in 'catch (Exception ex)' handler.
  Expected: <TestException>
    Actual: <TestException>
  Result of typeof(TException) == ex.GetType() is True 
```

是什么导致了这种特殊的失败？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-31T13:36:43.340

这确实很奇怪。我验证了 VB.Net 也存在这个问题，所以这不是 C# 特定的问题。它需要由核心调试器团队确认，但它看起来确实像一个错误。

[请在Connect](https://connect.microsoft.com/VisualStudio)上提交错误并将错误编号作为评论发布到我的 OP，以便我可以确保将其路由到正确的团队。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-01T10:17:50.223

这是一个由 CLR 中的错​​误引起的已知问题。它已在 CLR 4.0（尚未发布）中得到修复。

感谢 JaredPar 在这方面的帮助。有关更多详细信息，请参阅有关他的答案的评论，并链接到[Microsoft Connect 上的原始错误报告](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=362422&wa=wsignin1.0)。

# asp.net - 服务器生成的 PDF 未在某些（但不是全部）PC 上的 aspx 页面上的 IFrame 中显示

> ID：700939
> 
> 赞同：3
> 
> 时间：2009-03-31T13:26:18.217
> 
> 标签：asp.net, pdf

我们在一个页面上有一个 IFrame（我们称该页面为 DocViewer.aspx），它的 src 设置为另一个页面。让我们称另一个页面为 DocContent.aspx

这是 DocContent.aspx.vb 上的页面加载：

```
 Private Sub Page_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load

    'get pdf bytes from session
    Dim pdfBytes As Byte() = CType(Session("PDFBytes"), Byte())

    'remove pdf bytes from session
    Session.Remove("PDFBytes")

    With Response
        ' Set the response type to PDF
        .ClearHeaders()
        .Buffer = True
        .ContentType = "application/pdf"
        .AddHeader("Content-Disposition", "inline; filename=" & "midoc.pdf")

        .AddHeader("Content-Length", (pdfBytes.GetUpperBound(0) + 1).ToString)
        Response.OutputStream.Write(pdfBytes, 0, pdfBytes.Length)

        .End()
    End With ' response

End Sub 
```

这是 DocContent.aspx 页面的全部荣耀：

```
<%@ Page Language="vb" AutoEventWireup="false" Codebehind="DocContent" Inherits="OurCompany.OurNamespace.DocContent" %> 
```

我们使用 IFrame 的原因是允许我们将 PDF 托管在一个页面中，该页面还运行一些脚本并具有更多控件（如果满足某个条件，我们使用模态对话框扩展器弹出一个模态对话框，但是我们已经关闭了这种行为，问题仍然存在）。不使用 IFrame 也不是可行的解决方案。我检查了 IE 中的安全设置，它们都设置为允许显示 IFrame。

这就是问题所在 - 在某些测试仪 PC 上，页面显示 pdf 很好。在其他人我们只是得到一个空白页。

刚刚看到一台机器升级到IE7时不显示开始显示。不幸的是，这不是一个解决方案，因为我们必须支持任何低至 IE5.5 的东西 :(

我会非常感谢任何人的任何想法。

我还应该提到，这些机器在直接导航到类似于 DocContent 的页面时没有问题（而不是托管在 IFrame 中）。

哦，提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-10-05T19:01:56.873

行为不端的客户可能在安装 Adob​​e Acrobat Reader 时遇到问题。它具有是否应该出现在浏览器窗口内部或外部的设置。

解决方案可能就像卸载 Acrobat Reader、重新启动、使用默认设置重新安装 Acrobat Reader 一样简单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-09-24T23:06:39.590

我们在工作中遇到了类似的问题，一些用户最终会出现在空白屏幕上。我们所做的修复是将文件保存到磁盘，然后将浏览器重定向到该文件。我们还放置了一些代码，以便当用户请求文件时，它会清理文件夹（删除超过一小时的所有内容）。

# git - git 说项目描述文件没有被修改，即使它被实际修改过

> ID：700941
> 
> 赞同：3
> 
> 时间：2009-03-31T13:26:29.467
> 
> 标签：git

我在 Mac OS X 10.5.5 上，当我尝试执行 git push 时（我已经通过 google 代码上的 git 安装程序安装了 git），它向我显示以下错误

```
Counting objects: 86, done.
Compressing objects: 100% (43/43), done.
Writing objects: 100% (84/84), 4.68 MiB | 48 KiB/s, done.
Total 84 (delta 37), reused 84 (delta 37)
*** Project description file hasn't been set
error: hooks/update exited with error code 1
error: hook declined to update refs/heads/master
To <my_git_server>:project_name.git
 ! [remote rejected] master -> master (hook declined)
error: failed to push some refs to '<my_git_server>' 
```

神秘的是项目描述文件*实际上是*设置的，知道为什么它可能表现得很奇怪。

--
米

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-31T13:42:57.507

它正在查看服务器上的项目描述；确实`<my_git_server>:project_name.git`包含一个名为`description`“未命名存储库”以外的文件？

如果是这样，并且您仍然遇到问题，则可以完全禁用对描述的检查；这不是必需的。注释掉以下行`project_name.git/hooks/update`：

```
# check for no description
projectdesc=$(sed -e '1q' "$GIT_DIR/description")
case "$projectdesc" in
"Unnamed repository"* | "")
        echo "*** Project description file hasn't been set" >&2
        exit 1
        ;;
esac 
```

# ruby - 如何使用 Ruby 用一个换行符替换一行中的多个换行符

> ID：700942
> 
> 赞同：30
> 
> 时间：2009-03-31T13:26:46.873
> 
> 标签：ruby, regex, newline

我有一个用 ruby​​ 编写的脚本。我需要删除任何重复的换行符（例如）

```
\n
\n
\n 
```

到

```
\n 
```

我目前的尝试有效（或者更确切地说没有）使用

```
str.gsub!(/\n\n/, "\n") 
```

这对我的输出没有任何改变。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-03-31T13:33:29.433

这对我有用：

```
#!/usr/bin/ruby

$s = "foo\n\n\nbar\nbaz\n\n\nquux";

puts $s

$s.gsub!(/[\n]+/, "\n");

puts $s 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2013-09-29T16:27:13.147

使用更惯用`String#squeeze`的而不是`gsub`.

```
str = "a\n\n\nb\n\n\n\n\n\nc"
str.squeeze("\n") # => "a\nb\nc" 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-31T13:29:35.340

你确定它不应该是 /\n\n\n/, "\n" 你在上面的问题中似乎想要的东西。

另外，你确定它不是在做 Windows 换行符“\r\n”吗？

**编辑：附加信息**

每条评论

> “换行的数量可以改变。不同的行有 2 到 5 个换行。”

如果你只想打 2-5 行试试这个

```
/\n{2,5}/, "\n" 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-03-31T15:45:41.657

您需要匹配多个换行符，最多匹配一个无限量。您的代码示例只需稍作调整即可工作：

```
str.gsub!(/\n+/, "\n") 
```

例如：

```
str = "this\n\n\nis\n\n\n\n\na\ntest"
str.gsub!(/\n+/, "\n")  # => "this\nis\na\ntest" 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-03-31T13:31:07.347

简单地拆分和重新组合线条将产生所需的结果

```
>> "one\ntwo\n\nthree\n".split.join("\n")
=> "one\ntwo\nthree" 
```

编辑：我只是注意到这将用换行符替换所有空白子字符串，例如

```
>> "one    two three\n".split.join("\n")
=> "one\ntwo\nthree" 
```

首先检查这是否是您想要的！

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-31T13:36:34.777

简单地调用 split 也会删除你所有的空白。

您需要通过`\n`拆分

```
>> "one   ok \ntwo\n\nthree\n".split(/\n+/).join("\n")
=> "one  ok \ntwo\nthree" 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-08-26T17:23:01.543

此外，还适用于

*   空行上的空格
*   n 背靠背空行数

> str.gsub！/\n^\s*\n/, "\n\n"

在哪里，

*   \n 当然是换行符
*   \s 是空格
*   在 \s 之后使用时表示 1 个或多个空格

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2014-04-30T12:43:43.703

试试这个它对我有用：

```
s = test\n\n\nbar\n\n\nfooo 

s.gsub("\n\n", '') 
```

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2009-03-31T13:34:36.280

Ruby 需要以不同于您提供的方式转义的反斜杠。

```
str.sub!("\\\\n+\\\\n","\\\\n") 
```

[http://www.ruby-forum.com/topic/176239](http://www.ruby-forum.com/topic/176239)

# audio - 3D 音频引擎

> ID：700947
> 
> 赞同：8
> 
> 时间：2009-03-31T13:28:48.977
> 
> 标签：audio, platform-agnostic

尽管 3D 图形引擎取得了所有进步，但令我感到奇怪的是，音频并未受到同等程度的关注。现代游戏会实时渲染 3D 场景，但我们仍然会或多或少地获得伴随这些场景的预置音频。

想象一下——如果你愿意的话——一个 3D 引擎，它不仅可以模拟物品的物理外观，还可以模拟它们的音频属性。从这些模型中，它可以根据接触的材料、它们的速度、与虚拟耳朵的距离等动态生成音频。现在，当你蹲在沙袋后面，子弹从头顶飞过时，每个子弹都会发出独特而逼真的声音。

这种技术的明显应用将是游戏，但我相信还有许多其他可能性。

是否正在积极开发这种技术？有谁知道任何试图实现这一目标的项目？

谢谢，肯特

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-01T18:39:18.630

我曾经做过一些改进 OpenAL 的研究，模拟 3D 音频的问题在于你的大脑使用了太多的线索——不同角度的衰减略有不同，你前面和后面的声音之间的频率差异——对您*自己的*头脑非常具体，对其他人来说并不完全相同！

比如说，如果你想要一副耳机，让它听起来像一个生物在游戏中的树叶中和角色的前面，那么你实际上必须把那个玩家带进工作室，测量他们自己的特殊性耳朵和头部在不同距离改变声音的幅度和相位（幅度和相位不同，对大脑处理声音方向的方式都非常重要），然后教游戏对声音进行衰减和相移那个特定的球员。

确实存在用塑料模拟的“标准头”，用于获得头周围各个方向的通用频率响应曲线，但对于大多数玩家来说，平均或标准听起来永远不会完全正确。

因此，目前的技术基本上是向播放器出售五个便宜的扬声器，让他们将它们放在桌子周围，然后声音——虽然不是特别好再现——实际上听起来就像它们来自播放器的后面或旁边，因为，嗯，它们*来自*播放器后面的扬声器。:-)

但是有些游戏确实会费心计算声音如何通过墙壁和门被消音和衰减（这可能很难模拟，因为耳朵会在几毫秒的不同延迟内通过各种材料和反射表面接收相同的声音）环境，如果事情听起来很现实，所有这些都必须包括在内）。然而，他们倾向于将他们的库保密，因此像 OpenAL 这样的公共参考实现往往非常原始。

**编辑：**这是我当时找到的在线数据集的链接，可以用作创建更逼真的 OpenAL 声场的起点，来自 MIT：

[http://sound.media.mit.edu/resources/KEMAR.html](http://sound.media.mit.edu/resources/KEMAR.html)

享受！:-)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-31T14:04:46.957

Aureal 早在 1998 年就这样做了。我仍然有他们的一张卡，尽管我需要 Windows 98 来运行它。

想象一下光线追踪，但有音频。使用 Aureal API 的游戏将提供几何环境信息（例如 3D 地图），而声卡将提供光线追踪声音。这*就像*听到你周围世界的真实事物一样。您可以将注意力集中在声源上，并在嘈杂的环境中关注给定的声源。

据我了解，Creative 在一系列专利侵权索赔（均被驳回）中以法律费用的方式摧毁了 Aureal。

在公共领域世界中，存在 OpenAL - OpenGL 的音频版本。我认为发展在很久以前就停止了。他们有一个非常简单的 3D 音频方法，没有几何结构——软件中不比 EAX 好。

EAX 4.0（我认为还有更高版本？）终于 - 十年后 - 我*认为*已经合并了 Aureal 使用的一些几何信息光线追踪方法（Creative 在折叠后购买了他们的 IP）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-31T21:40:47.733

SoundBlaster X-Fi 上的 Source (Half-Life 2) 引擎已经做到了这一点。

这真的很值得一听。您绝对可以听到回声与混凝土、木材、玻璃等之间的区别……

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-01T12:01:20.163

一个鲜为人知的侧面区域是 voip。虽然游戏拥有积极开发的软件，但您也可能会在玩游戏时花时间与他人交谈。

Mumble ( [http://mumble.sourceforge.net/](http://mumble.sourceforge.net/) ) 是使用插件来确定谁在和你玩的软件。然后它将其音频定位在您周围的 360 度区域中，因此左侧在左侧，在您身后听起来就像这样。这是一个令人毛骨悚然的现实添加，在尝试时它导致了“马可，马球”的有趣游戏。

音频在 vista 中发生了巨大的逆转，不再允许使用硬件来加速它。这就像在 XP 时代一样扼杀了 EAX。软件包装器现在正在逐步构建。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-07-28T11:36:03.940

确实非常有趣的领域。太有趣了，我要写关于这个主题的硕士学位论文。特别是，它用于第一人称射击游戏。

到目前为止，我的文献研究清楚地表明，这个特定领域几乎没有理论背景。这方面的研究不多，大部分理论都是基于电影-音频理论。

至于实际应用，我目前还没有发现。当然，有很多标题和包支持实时音频效果处理，并根据审核员的一般环境应用它们。例如：听众进入大厅，因此对声音样本应用了回声/混响效果。这是比较粗暴的。视觉的类比是当有人关闭（或拍摄；））房间中五个灯泡中的一个时，将整个图像的 RGB 值减去 20%。这是一个开始，但根本不是很现实。

我发现的最好的工作是怀卡托大学 Mark Nicholas Grimshaw 的 (2007) 博士论文，名为[“第一人称射击游戏的声学生态学”](http://adt.waikato.ac.nz/public/adt-uow20070601.210202/index.html) 。分析游戏音频的分类法和术语。他还认为，音频对于第一人称射击游戏的重要性被大大忽视了，因为音频是进入游戏世界的强大力量。

考虑一下。想象一下在没有声音但画面完美的显示器上玩游戏。接下来，想象一下在你闭上眼睛的同时听到你周围的真实游戏（游戏）声音。后者会给你更大的“身临其境”的感觉。

那么为什么游戏开发者还没有全心全意地投入其中呢？我认为这个问题的答案很明确：销售要困难得多。改进的图像很容易出售：您只需提供一张图片或电影，就很容易看出它有多漂亮。它甚至很容易量化（例如更多像素=更好的图片）。对于声音来说，这并不容易。声音的现实主义更具有潜意识，因此更难推向市场。

现实世界对声音的影响是下意识的。大多数人甚至从未注意到其中的大多数。其中一些效果甚至无法有意识地听到。尽管如此，它们都在声音的感知真实性中发挥了作用。你可以自己做一个简单的实验来说明这一点。下次你在人行道上行走时，仔细聆听环境的背景声音：风吹过树叶，远处道路上的所有汽车等等。然后，当你走近或远离时，听听这些声音是如何变化的一面墙，或者当你走在一个悬垂的阳台下，或者当你经过一扇敞开的门时。这样做，仔细听，你会发现声音有很大的不同。可能比你记忆中的要大得多。

在游戏世界中，这些类型的变化并没有体现出来。即使你没有（还）有意识地想念它们，但你的潜意识里却想念它们，这将对你的出现水平产生负面影响。

那么，与图像相比，音频必须有多好？更实用：现实世界中的哪些物理效果对感知的真实感贡献最大。这种感知的现实主义是否取决于声音和/或情况？这些是我希望通过我的研究来回答的问题。之后，我的想法是为音频引擎设计一个实用的框架，它可以根据可用计算能力的数量（动态地）对部分或全部游戏音频应用一些效果。是的，我把标准定得很高:)

我将从 2009 年 9 月开始。如果有人感兴趣，我正在考虑建立一个博客来分享我的进展和发现。

Janne Louw（荷兰莱顿大学计算机科学理学士）

# sql - 合并两个或多个表，当您不知道要合并的表数时

> ID：700950
> 
> 赞同：1
> 
> 时间：2009-03-31T13:29:18.210
> 
> 标签：sql, sql-server, sql-server-2005, user-defined-functions

我正在使用 MS SQL 2005。我将树结构定义为：

```
1 
|\ 
2 3 
  /|\ 
 4 5 6 
```

我制作了一个 SQL 函数 Subs(id)，它获取 id 并返回子树表。因此，Subs(3) 将返回 4 行 3、4、5、6，而 Subs(2) 将返回 1 行 2。

我有一个返回上述 ID 的选择语句（将此树与其他表连接）

我想要在返回上述 ID 的 select 语句之后
（这将导致一个包含例如 2 行的表：）

```
2
3 
```

能够运行 Subs 功能

```
Subs(2) 
union 
Subs(3). 
```

（结果应该是 id 为 2,3,4,5,6 的行）

问题是我不知道如何传递参数，也不知道如何动态使用联合。

是否有可能在这个级别解决这个问题，或者我应该把它带到上层（C#）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-31T13:36:47.787

我认为您在这里不需要 UNION，使用 SQL Server 2005，您可以使用 CROSS APPLY 获得所需的结果：

```
select 
    f.* 
from 
    resultsTable rt
    cross apply dbo.subs(rt.ID) f 
```

那是假设 resultTable 是存储您的第一个查询结果的那个，并且该字段的名称是 ID

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-03-31T13:33:30.027

我认为您想阅读[Recursive Common Table Expressions](http://msdn.microsoft.com/en-us/library/ms186243(SQL.90).aspx)。

# c# - 用另一个日期替换 DateTime 中的日期

> ID：700962
> 
> 赞同：3
> 
> 时间：2009-03-31T13:31:07.440
> 
> 标签：c#

你如何改变`DateTime`结构的日部分？

我有一个`DateTime`值为 3/31/2009 8:00:00 AM 的值，并且想将其更改为任何其他日期，但时间应该相同。我不需要添加日期的解决方案，我需要用任意日期替换它。

我如何实现这一目标？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-31T13:37:30.000

要从其他两个 DateTime 构造 DateTime，其中一个包含日期，另一个包含时间，您可以使用：

```
DateTime result = date.Date + time.TimeOfDay; 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-03-31T13:37:28.033

```
day = 1
month = 4
year = 2009

Date2 = new DateTime(day,month,year,Date1.Hours,Date1.Minute,Date1.Seconds) 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-31T13:33:38.230

s = s.AddDays(1)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-31T13:35:13.703

您应该使用 DateTime.AddDays 方法。像这样：

```
DateTime s2 = s.AddDays( 1 ); 
```

# c# - 构造函数中的泛型类型

> ID：700966
> 
> 赞同：54
> 
> 时间：2009-03-31T13:32:23.943
> 
> 标签：c#, .net, generics, inversion-of-control

我有一个通用类型接口，并希望一个对象的构造函数接受通用接口。
像：

```
public Constructor(int blah, IGenericType<T> instance)
{} 
```

我希望创建此对象的代码指定 IGenericType（使用控制反转）。我还没有看到发生这种情况的方法。有什么建议可以做到这一点吗？

我希望有人创建对象，例如：

```
Constructor varname = new Constructor(1, new GenericType<int>()); 
```

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2009-03-31T13:35:47.743

您不能将构造函数设为通用，但可以使用通用静态方法：

```
public static Constructor CreateInstance<T>(int blah, IGenericType<T> instance) 
```

如果需要，然后在构造函数之后做任何你需要做的事情。在某些情况下，另一种选择可能是引入通用接口扩展的非通用接口。

编辑：根据评论...

如果要将参数保存到新创建的对象中，并且希望以强类型的方式进行，那么类型也必须是泛型的。

到那时，构造函数问题就消失了，但您*可能*希望在非泛型类型中保留一个静态泛型方法：因此您可以利用类型推断：

```
public static class Foo
{
    public static Foo<T> CreateInstance<T>(IGenericType<T> instance)
    {
        return new Foo<T>(instance);
    }
}

public class Foo<T>
{
    public Foo(IGenericType<T> instance)
    {
        // Whatever
    }
}

...

IGenericType<string> x = new GenericType<string>();
Foo<string> noInference = new Foo<string>(x);
Foo<string> withInference = Foo.CreateInstance(x); 
```

# java - 缓存解决方案和查询

> ID：700969
> 
> 赞同：8
> 
> 时间：2009-03-31T13:32:43.927
> 
> 标签：java, caching, jakarta-ee, jboss, glassfish

是否有任何适用于 java 的内存/缓存解决方案允许以某种形式查询缓存中对象的特定属性？

我意识到这是一个完整的数据库将被用于的东西，但我希望能够通过数据库的查询能力获得缓存的速度/性能。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-01T07:24:31.327

JBoss Cache 具有搜索功能。它被称为 JBossCacheSearchable。从网站：

> 这是 JBoss Cache 和 Hibernate Search 之间的集成包。
> 
> 目标是为 JBoss Cache 添加搜索功能。我们通过使用 Hibernate Search 在用户对象被添加到缓存和修改时为它们建立索引来实现这一点。通过传入有效的 Apache Lucene 查询来查询缓存，该查询随后用于搜索索引并从缓存中检索匹配的对象。

JBoss Cache 主页面：[http ://www.jboss.org/jbosscache/](http://www.jboss.org/jbosscache/)

JBossCacheSearch：[http ://www.jboss.org/community/docs/DOC-10286](http://www.jboss.org/community/docs/DOC-10286)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-04T15:16:09.430

[Terracotta](http://docs.huihoo.com/terracotta/TerracottaTreeCache.pdf)或[GBeans](http://www.jaxmag.com/itr/online_artikel/psecom,id,690,nodeid,147.html)或[POJOCache](http://www.samaxes.com/2009/03/jboss-pojocache-configuration/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-05-18T19:49:19.410

现在答案应该更新为[Infinispan](http://www.jboss.org/infinispan/)，它是 JBoss Cache 的继任者，并且搜索技术有了很大改进。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-31T13:44:26.613

起初，我想到了[HSQLDB](http://www.hsqldb.org/)，但那是内存中的关系数据库而不是对象数据库。不妨看看[这份清单](http://java-source.net/open-source/database-engines)。那里有一些对象数据库，其中一个可能满足您的需求。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-31T15:33:38.490

在相当轻量级的 java 对象数据库中查看[db4o 。](http://db4o.org)您甚至可以使用常规 java 代码查询数据：

```
List students = database.query( new Predicate(){
      public boolean match(Student student){
        return student.getAge() < 20
          && student.getGrade().equals(gradeA);}}) 
```

（来自[这篇文章](http://www.theserverside.com/news/thread.tss?thread_id=37595)）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-03T18:54:30.207

另一个想法是使用 Lucene 和 Directory 的 RAMDirectory 实现来索引您放入缓存的内容。这样，您就可以使用 Lucene 提供的所有搜索引擎查询功能进行查询。

在您的情况下，您可能会按原样（不使用分析器）索引对象的相关属性并使用布尔相等运算符进行查询。

Lucene 非常轻量级、高性能、线程安全且内存消耗低。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-06-17T06:00:36.347

你可能想看看这个库：

[http://casperdatasets.googlecode.com](http://casperdatasets.googlecode.com)

这是一种数据集技术。它支持表格数据（来自数据库或在代码中构建），然后您可以针对数据集（和排序）构建查询和过滤器，所有这些都在内存中。它快速且易于使用。最重要的是，您可以对数据集上的任何列或属性执行查询。

# sql - 可变数据库名称

> ID：700970
> 
> 赞同：23
> 
> 时间：2009-03-31T13:32:49.420
> 
> 标签：sql, mysql

MySQL中有什么方法可以将数据库的名称放入变量中？例如，当我有一个名为“db1”的数据库时，我可以这样做：

```
set @db= 'db1';
select * from @db.mytable; 
```

编辑：还有另一个我想做的例子：

```
set @dbfrom= 'db1';
set @dbto= 'db2';
insert into @dbto.mytable (col1,col2,col3) select col2,col1,col3 from @dbfrom.mytable; 
```

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-03-31T13:39:42.383

经过相当大的努力，是的。

```
SET @db = 'db1';
SET @q = CONCAT('SELECT * FROM ', @db, '.mycol');
PREPARE stmt FROM @q;
EXECUTE stmt;
DEALLOCATE PREPARE stmt; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-11-18T10:14:46.460

使用[Chaos 的“准备语句”解决方案](https://stackoverflow.com/a/701007/662581)，我设法创建了一个使用可变数据库名称的存储过程。

就像使用存储过程将数据从一个数据库迁移到另一个数据库的魅力一样。这样，代码就不会固定到单个数据库。

```
DELIMITER $$

DROP PROCEDURE IF EXISTS `SampleProcedure` $$
CREATE PROCEDURE `SampleProcedure`(IN HubDatabaseName VARCHAR(255))
BEGIN

SET @db = HubDatabaseName;
SET @q = CONCAT('

/* Import data from Hub database to local database */
INSERT INTO `table_name_in_local_database`
SELECT
  *
FROM
  ', @db ,'.`tablename`

');

PREPARE stmt FROM @q;
EXECUTE stmt;
DEALLOCATE PREPARE stmt;

END $$
DELIMITER ; 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2018-08-24T16:44:22.933

如果您安装了 PHP，您可以使用此脚本将 mysql 变量替换为实际值：

```
<?php

$sqlFile = 'migration.sql';
$fromDb = 'db1';
$toDb = 'db2';

echo str_replace(['@fromDb', '@toDb'], [$fromDb, $toDb], file_get_contents($sqlFile)); 
```

# macos - MacOS 上的视频捕获

> ID：700982
> 
> 赞同：0
> 
> 时间：2009-03-31T13:35:03.097
> 
> 标签：macos, qt, qt4, video-capture

我正在使用 Trolltech QT 库编写 C++ 应用程序，我需要从相机和一些医疗仪器中捕获视频流。

我可以使用什么样的硬件来做到这一点？我尝试过使用 OpenCV，但它无法识别我的 EyeTV 250。

我可以在 Mac 上使用 Pinnacle Video capture 吗？

谢谢，安德里亚

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-31T16:08:01.013

我相信 Qt 将 OS X 上的媒体委托给 QuickTime。因此，我希望QuickTime[支持](http://developer.apple.com/documentation/QuickTime/Conceptual/QTKitCaptureProgrammingGuide/GettingStarted/GettingStarted.html#//apple_ref/doc/uid/TP40004574-CH3-DontLinkElementID_19)的任何硬件都在发挥作用。如果您愿意被锁定在 OS X 上，使用本机 API 可能会容易得多。QTKit，用于 QuickTime 的 Objective-C API 是 Leopard (OS X 10.5) 的新功能，非常好。您可能希望从[QTKit 的 Capture API](http://developer.apple.com/documentation/QuickTime/Conceptual/QTKitCaptureProgrammingGuide/Introduction/Introduction.html)开始。由于您使用的是 C++，因此您还需要了解[Objective-C++](http://developer.apple.com/documentation/Cocoa/Conceptual/ObjectiveC/Articles/ocCPlusPlus.html#//apple_ref/doc/uid/TP30001163-CH10-SW1)以在 QTKit 和您的代码之间建立连接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-07-30T10:22:29.490

试试 openCV，这里有一个很好的项目：[http](http://code.google.com/p/opencv-cocoa/) ://code.google.com/p/opencv-cocoa/有 c++ 类。

# excel - 如何在不重命名或删除 xla 文件的情况下从 xls 中删除 xla？

> ID：700985
> 
> 赞同：0
> 
> 时间：2009-03-31T13:35:43.687
> 
> 标签：excel, vba, xls, xla

我需要从电子表格中删除 XLA（excel 插件），但网络上的所有内容似乎都指向重命名/删除 xla 文件。

这不是一个选项，因为 xla 文件被许多其他电子表格使用并且位于共享驱动器上。

还有其他选择吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-07T07:25:55.853

我将所有类和模块（拖放）从 xla 复制到“本地”项目。

保存并关闭 xls

我在注册表中搜索了 xla 项目名称（关闭了 excel）并删除了该值。

打开excel

完毕

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-31T16:31:34.090

您的意思是要从加载项对话框中删除它吗？断开与共享驱动器的连接，加载 Excel，然后尝试安装加载项。Excel 会告诉您找不到它并询问您是否要删除它。删除后，重新连接到共享云端硬盘。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-11-15T15:38:48.113

移动或重命名 .xla 文件，然后转到加载项管理器。选择加载项，然后在弹出的消息中单击“删除”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-31T16:56:51.457

如果我理解您的问题，解决方案可能是：

1.  在工具菜单上，单击加载项。
2.  在可用的加载项框中，清除要卸载的加载项旁边的复选框，然后单击确定。

资料来源： http: **[//office.microsoft.com/en-us/excel/HP052037321033.aspx](http://office.microsoft.com/en-us/excel/HP052037321033.aspx)**********