# StackOverflow 问答 000606000-000606999

# validation - asp.net 应用程序目前最好的验证框架是什么？

> ID：606000
> 
> 赞同：0
> 
> 时间：2009-03-03T11:20:24.760
> 
> 标签：validation, frameworks, design-by-contract

为了确保它是一种 DRY 方法，所有验证逻辑当然应该进入业务逻辑（模型）。

*   验证消息如何呈现给视图，应该能够本地化错误消息
*   你能从验证框架生成javascript吗？与 JQuery 的兼容性将是完美的
*   该框架是否与 DbC 方法兼容？

编辑：我认为这是迄今为止最好的一个，Castle 验证器 + 实时验证 [http://blog.codeville.net/2008/04/30/model-based-client-side-validation-for-aspnet-mvc/](http://blog.codeville.net/2008/04/30/model-based-client-side-validation-for-aspnet-mvc/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-03T11:51:31.440

[验证应用程序块](http://msdn.microsoft.com/en-us/library/cc309509.aspx)

来自 Microsoft 是一种选择，但我没有经验

# c++ - C++ 多维数据处理

> ID：606004
> 
> 赞同：1
> 
> 时间：2009-03-03T11:21:41.637
> 
> 标签：c++, oop, stl, containers

很多时候，我发现自己必须为多维数据定义一个容器。

举个例子：我有很多 Chip，每个 Chip 有很多 Registers，每个 Register 有很多 Cell，每个 Cell 有很多 Transistor。

在我的 C++ 程序的某个阶段，我必须读取这些数据，然后我必须使用它。

我不能为这些数据使用任何外部存储：文件、数据库等。

那么，我应该创建一些多维 STL 容器吗？一张矢量地图，或者类似的东西……？

或者我应该为它们中的每一个创建类（结构）？包含晶体管向量的单元类，然后是包含单元向量的寄存器类，等等？但是，如果以后我想通过晶体管而不是芯片访问我的数据怎么办？

还有什么办法吗？

谢谢

编辑：忘了提：我不能使用 boost。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-03T11:29:45.627

您需要映射您的域。

> 那么，我应该创建一些多维 STL 容器吗？一张矢量地图，或者类似的东西……？

每个矢量/地图都将包含某种类型的对象。这将我们带到您的下一个问题:)

> 或者我应该为它们中的每一个创建类（结构）？

看起来这至少是你需要的。

> 包含晶体管向量的单元类，然后是包含单元向量的寄存器类，等等？

看看两者`has-a`和`is-implemented-in-terms-of`设计。

> 但是，如果以后我想按晶体管而不是芯片对数据进行排序怎么办？

什么数据？您始终可以根据上下文传递比较器。另外，问问自己是否真的需要向`Transistor`使用`Chip`. 这将有助于开始。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-03T15:11:34.580

**Implement full classes for them. Your code will be cleaner in the end.**

Whenever I ignore this axiom, it comes back to haunt me. I implemented a hierarchical 3-tiered string collection in terms of std::pairs of std::strings and std:pairs. It was quick and simple, and when I had to replace one layer and then another with a class to contain extra attributes, it was surprisingly easy to do. But in the end, the code was a mess and I wasn't happy documenting it. Lesson learned again, and again, and again...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T11:41:53.773

If you want to access your data along different "dimensions," you may be interested in [`boost::multi_index_container`](http://www.boost.org/doc/libs/1_38_0/libs/multi_index/doc/index.html). I haven't used it myself, but it looks like it fits the bill.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-04T11:45:09.560

As advised, I chose to implement full classes:

```
class Chip
{
    map<RegisterLocation, Register> RegistersPerLocation;
  public:
    void AddRegisterPerLocation(RegisterLocation, Register); 

};

class Register
{
    map<CellLocation, Cell> CellsPerLocation;
  public:
    void AddCellPerLocation(CellLocation, Cell); 
};

// etc.. 
```

# tfs - 是否有用于编辑工作流程的 TFS 指南？

> ID：606018
> 
> 赞同：3
> 
> 时间：2009-03-03T11:27:58.283
> 
> 标签：tfs

我们最近开始使用 TFS。目前仅用于源代码控制。

我们正在考虑使用工作项而不是我们当前的错误跟踪系统。我听说工作流程是可定制的，我想尝试一下。

一个小例子是，有时在处理错误时，有人可能决定需要更新产品文档，可能是为了解释解决方法，或者如果错误修复导致屏幕布局发生变化，帮助文件中需要新的屏幕截图。我希望它能够正常工作，以便如果有人在工作项上勾选“必需文档”复选框，在修复和测试错误后，工作项将自动分配给我们的文档团队。

我听说 TFS 确实支持工作流程，但我正在努力寻找合适的指南来指导如何定制它。

你能为我指出正确的方向吗？或者，我误解了什么是可能的？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-03T11:29:38.980

> 欢迎使用 Visual Studio Team Foundation Server 项目站点的模式和实践团队开发！本指南向您展示如何充分利用 Team Foundation Server。它以终为始，向您展示如何逐步为您的组织采用 TFS。这是模式和实践、Team System 团队成员和行业专家之间的协作努力。

[http://www.codeplex.com/TFSGuide](http://www.codeplex.com/TFSGuide)

# authentication - 指纹验证

> ID：606019
> 
> 赞同：3
> 
> 时间：2009-03-03T11:28:20.090
> 
> 标签：authentication, verification, fingerprint, biometrics

我正在做指纹认证的最后一年项目。我已经完成了二值化、细化、细节提取。我在matlab中做。我被验证卡住了。我不知道如何进行验证。所以请帮我解决这个问题。我将感谢帮助的 ppl .. 提前致谢。请帮助我验证代码或算法至少...非常感谢...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T11:39:58.877

通常的方法是使用某种形式的统计分类器。最简单的是贝叶斯（我相信指纹不会这样做）。在生物统计学中，最流行的是 GMM（高斯混合模型）或 HMM（隐马尔可夫模型）。另一种方法是使用神经网络作为分类器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T11:58:08.350

我无法帮助您编写自己的验证，但我过去使用[Griaule Fingerprint SDK](http://www.griaulebiometrics.com/page/en-us/fingerprint_sdk)进行过指纹验证。我希望这能有所帮助。

# sharepoint - 从 MOSS 发布站点创建站点模板

> ID：606022
> 
> 赞同：2
> 
> 时间：2009-03-03T11:28:56.423
> 
> 标签：sharepoint, templates, moss, publishing, sites

我知道微软目前不支持从 MOSS 发布站点创建站点模板。

谁能告诉我是否支持创建基本站点，然后打开发布功能，然后创建站点模板 - 我猜不是因为它可能与创建发布门户相同？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T14:40:45.200

您可以将发布功能装订到您的网站模板上。

来自[知识库 986908](http://support.microsoft.com/kb/936908)：

> 您可以创建装订功能以将 Office SharePoint Server 发布功能装订到特定网站模板。例如，请参阅“Drive:\Program Files\Common Files\Microsoft Shared\Web server extensions\12\Template\Features\PublishingStapling”文件夹中的 Feature.xml 文件。要将 Office SharePoint Server 发布功能装订到所有网站模板，请使用 TemplateName="GLOBAL" 属性。如果站点定义未指定 AllowGlobalFeatureAssociations 属性，则此属性将特定功能装订到站点定义。（只有共享服务提供程序站点模板和空白站点站点模板使用 AllowGlobalFeatureAssociations="FALSE" 属性。）
> 
> 例如，当您使用 TemplateName="GLOBAL" 属性来装订 Office SharePoint Server 发布功能时，基于团队网站模板的网站使用为网站集的根网站配置的系统母版页。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-04T15:19:57.780

您仍然可以访问保存模板网页，并保存它...例如[http://localhost/website/_layouts/savetmpl.aspx](http://localhost/website/_layouts/savetmpl.aspx) 它就像一个魅力:-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-11T15:17:57.243

我们编写了自己的工具来解决导出问题。我们可以在发布站点中创建站点栏、内容类型、母版页、页面布局等，并将选定的项目导出到 WSP 包以部署到其他服务器。

[SPSource](http://spsource.codeplex.com/)工具采用了类似的方法，但创建了一个用于编译的 Visual Studio 解决方案。结果可以用[WSPBuilder](http://wspbuilder.codeplex.com/)打包。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T15:42:42.730

我认为您所描述的内容不会起作用（就像您说的，它与发布门户基本相同），但似乎有一种解决方法。根据SharePoint 解决方案团队的[这篇文章](http://sharepointsolutions.blogspot.com/2008/07/create-site-template-from-publishing.html)（显然与 Microsoft 无关），您可以创建发布网站，根据需要对其进行自定义，停用发布功能，从中创建网站模板，基于模板创建新网站，然后在您的新网站上激活发布功能。

听起来这很有效，但微软并未正式支持。要小心，因为它可能大部分都有效，但如果它的一些小块破裂，我不会感到惊讶。

# asp.net - 有什么方法可以加快 asp.net 中的编辑-编译-调试周期？

> ID：606023
> 
> 赞同：6
> 
> 时间：2009-03-03T11:29:14.113
> 
> 标签：asp.net, visual-studio

我一直在用 php 编程，最近我开始了一份新工作，现在我正在用 c#/asp.net 编程。

虽然 ASP 在部署时具有不错的性能，但在过去的几个月里，有一件事一直困扰着我。任何代码更改后，页面重新加载以进行测试大约需要 30 秒。

我猜它是在做 JIT 编译什么的。但这真的很令人沮丧，特别是如果我全神贯注，并且想尽快测试几个增量更改，只需要盯着空白页 30 秒。

有没有人有任何提示来加快这个过程？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T11:34:42.853

在 Visual Studio 2005 中，您添加的每个引用都会添加一个**.refresh**文件，以确保该引用自上次以来没有更改，如果是，则带来新版本 - 如果您的引用保持不变，您可以删除它！有关 VS 2005 的更多提示，
请参见[此处](http://weblogs.asp.net/scottgu/Common-Gotcha_3A00_-Slow-VS-2005-Web-Site-Build-Performance-Because-of-_1C20_Dueling-Assembly-References_1D20_)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-03-01T03:11:12.947

我发现了两件事：

*   尝试在项目属性/Web 选项卡中交替使用“用户 Visual Studio 开发服务器”和“本地 IIS 服务器”。根据您的项目，一个可能比另一个更快启动和附加。
*   如果您的解决方案中有项目，例如基于 CLR 的 SQL 过程，它们需要几秒钟才能部署到 SQL 服务器。如果您有能力记住重新打开它们，或进行单独的项目配置，请在构建中禁用它们，这样每次按 F5 时它们就不会被部署。

这样做将我的“F5 生存”时间从大约 20 秒缩短到 4 秒。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T11:34:06.723

我感觉到你的痛苦。

我个人更喜欢 ASP.NET`website project`以提高开发速度。不知道你有没有这种可能。。

在视觉工作室做文件-> 新网站。

对于这种项目类型，您不需要一直重新构建，您只需在浏览器中刷新页面即可。（无需重建/调试）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-03T11:40:43.867

我想这可能会令人沮丧，来自 PHP。三十秒听起来太长了。确保免费内存等基础知识。

一些提示。1\. 您不必为了运行站点而运行调试器。使用内置的 VS Web 服务器或 IIS 建立站点后，您可以更改代码、构建并在浏览器中刷新页面。无需点击播放并让 VS 启动整个调试过程。如果你真的想调试，你别无选择。2\. 对 aspx 页面的更改不需要重建。我进行更改并简单地刷新页面以立即查看结果。

查看项目设置中的 web 选项卡，以配置您希望 VS 如何处理站点服务。那里有一些选择，希望能帮助你适应你的风格。前任。每当我想调试时，我都不会让 VS 为我启动浏览器。我将选项设置为仅等待请求。然后我可以使用我选择的浏览器开始。

祝你好运

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-03T11:34:28.923

我有过类似的经历，有时重新编译可能会很慢，但会根据更改的位置和代码而有所不同——即它是 app_code 还是特定于页面。

你在什么样的硬件上运行？VS 可能会占用内存，小于 2GB 的任何内容似乎都会使其变慢。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-03-03T11:56:56.560

由于仅在应用程序启动阶段（ASP 工作进程启动时）发生的操作，我们的网站有很长的加载时间。特别是将常用对象从数据库加载到内存中会导致显着延迟。我们发现在调试时使用编译符号来禁用某些功能（例如安全性和用户角色）有很大帮助。

# database - 在高度规范化的数据库中选择表数据的通用版本控制策略

> ID：606031
> 
> 赞同：5
> 
> 时间：2009-03-03T11:32:20.440
> 
> 标签：database, database-design, version-control

对不起，冗长的标题，但要求/问题是相当具体的。

参考下面的示例（但非常简化）结构（在伪 SQL 中），我希望能更好地解释它。

```
TABLE StructureName {
  Id GUID PK,
  Name varchar(50) NOT NULL
}

TABLE Structure {
  Id GUID PK,
  ParentId GUID,                 -- FK to Structure
  NameId GUID NOT NULL           -- FK to StructureName
}

TABLE Something {
  Id GUID PK,
  RootStructureId GUID NOT NULL  -- FK to Structure
} 
```

可以看出，Structure 是一个简单的树形结构（不担心问题的子级排序）。StructureName 是翻译系统的简化。最后，'Something' 只是引用树的根结构的东西。

这只是需要进行版本控制的众多表之一，但对于大多数情况而言，此表是一个很好的示例。

对结构表的名称和/或树“布局”的任何更改都需要版本化。以前的版本应该始终可用。

似乎有一些解决这个问题的可能性，比如复制整个结构，但大多数方法会导致“松散”参照完整性。例如，如果遵循这种方法，则必须复制“Something”记录，因为根结构将是新记录，并且具有新 ID。

其他可能的解决方案正在研究 Wiki 如何处理这个问题，或者更进一步，看看适当的版本控制系统是如何工作的。

目前，我对如何以通用方式进行此操作感到有点不知所措。

任何想法将不胜感激。

谢谢

雷比

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-03T11:56:00.337

一些快速的想法：

**完整副本：**创建结构的副本，但为每个表添加一`version_id`列到 PK 和所有 FK；因此，您可以创建具有完整引用完整性的生活数据副本。

*   亲：方便查询历史
*   con：大量（复制的冗余数据）

**更改副本：**仅复制实际更改的内容以及`valid_from`/`valid_to`数据。

*   亲：低数据量复制
*   缺点：很难查询，因为必须间隔加入

**变化：**这适用于两种方案。您可以将当前记录保留在与旧版本相同的表中，而不是创建结构的副本，但将其标记为当前记录。

*   pro：表数量较少，更容易混合历史和当前信息
*   缺点：正常操作在更大的表上运行，这将导致性能影响

**审计日志：**根据您的实际要求，只需创建如下审计跟踪就足够了：

```
id,  timestamp,  changed_table,  changed_column,  old_value,  new_value,  changed_by 
```

您可以将其扩展到完整的表结构：

```
transaction,  table_change,  changed_column 
```

*   pro：通用，因此易于为大量表实现
*   缺点：如果您需要在给定时间重建一组记录的状态，查询将成为一场噩梦

我写[了一篇关于版本控制的各种方法的博客](http://blog.schauderhaft.de/2008/09/14/versionierte-vs-historisierte-objekte/)，但请注意：它是德语的。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-03T11:47:24.647

数据仓库人员有几种“缓慢变化的维度”算法。

更复杂的算法提供围绕维度值的数据范围以指示其何时有效。

根据您的版本控制要求，您可以执行其中一项操作，取自 Kimball 的 The Data Warehousing Toolkit。

1.  为结构表的行分配版本号。这意味着你必须做一些推理来收集一个完整的结构。它包括与早期版本中未更改的行合并的选定版本号。

2.  将日期范围或版本范围分配给结构表的行。这意味着有些行有开始日期和结束日期；在不可能的将来，某些行将在某个时期具有结束日期。或者，如果您使用版本号，您将有一个 start-end 对或 start-infinity 对，表明该行仍然是最新的。然后，您可以简单地查询“今天”有效的行或应用于请求的版本。

3.  克隆每个版本的结构。这令人不快，因为克隆操作代价高昂。然而，查询是微不足道的，因为整个结构都可以使用一个单一的、一致的版本号。

# c++ - 如何检索 Windows EXE 或 DLL 的版本号？

> ID：606036
> 
> 赞同：5
> 
> 时间：2009-03-03T11:33:30.173
> 
> 标签：c++, windows, winapi, version

如何在运行时检索存储在 Windows exe/dll 中的版本信息？此信息是使用资源文件手动设置的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-03T15:20:02.920

这是使用标准 Windows API 函数的 C++ 方法：

```
try
{
    TCHAR szFileName[ MAX_PATH ];
    if( !::GetModuleFileName( 0, szFileName, MAX_PATH ) )
        throw __LINE__;

    DWORD nParam;
    DWORD nVersionSize = ::GetFileVersionInfoSize( szFileName, &nParam );
    if( !nVersionSize )
        throw __LINE__;

    HANDLE hMem = ::GetProcessHeap();
    if( !hMem )
        throw __LINE__;

    LPVOID lpVersionData = ::HeapAlloc( hMem, 0, nVersionSize );
    if( !lpVersionData )
        throw __LINE__;

    if( !::GetFileVersionInfo( szFileName, 0, nVersionSize, lpVersionData ) )
        throw __LINE__;

    LPVOID pVersionInfo;
    UINT nSize;
    if( !::VerQueryValue( lpVersionData, _T("\\"), &pVersionInfo, &nSize ) )
        throw __LINE__;

    VS_FIXEDFILEINFO *pVSInfo = (VS_FIXEDFILEINFO *)pVersionInfo;
    CString strVersion;
    strVersion.Format( _T(" version %i.%i.%i.%i"),
        pVSInfo->dwProductVersionMS >> 16,
        pVSInfo->dwProductVersionMS & 0xFFFF,
        pVSInfo->dwProductVersionLS >> 16,
        pVSInfo->dwProductVersionLS & 0xFFFF
        );
    GetDlgItem( IDC_ABOUT_VERSION )->SetWindowText( strAppName + strVersion );

    if( !HeapFree( hMem, 0, lpVersionData ) )
        throw __LINE__;
}
catch( int err )
{
    ASSERT( !err ); // always break on debug builds to inspect error codes and such

    DWORD dwErr = ::GetLastError();

    // handle memory cleanup...
} 
```

请注意，*catch*部分纯粹是教育性的——在实际情况下，您将在内存分配后正确清理并实际使用错误代码！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T16:32:47.473

Valentin 的回答是正确的，但请注意评论者 plinth 关于内存泄漏可能性的警告。

我也不确定你为什么在这个时代使用 ::HeapAlloc。

这是一个片段，它使用 new 和 boost::shared_array 来做同样的事情，恕我直言，这是一种更安全、更清洁的方式。

```
#include <boost/shared_array.hpp> 

//.....

DWORD   dwHandle;
DWORD   dwFileVersionInfoSize = GetFileVersionInfoSize((LPTSTR)lpszFileName, &dwHandle);

if (!dwFileVersionInfoSize)
         return FALSE;

// ensure our data will be deleted
boost::shared_array<BYTE> data(new BYTE[dwFileVersionInfoSize]); 
LPVOID const lpData = data.get(); 

//party on with lpData.... 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-03T19:41:06.333

这是一个 Delphi 7 版本：

```
uses Windows, SysUtils;

function GetEXEVersion(exename: string; const Fmt : string = '%d.%d.%d.%d'): string;
{
    credit to martinstoeckli@gmx.ch 
  ( http://martinstoeckli.ch/delphi/delphi.html#AppVersion )
}
var
  iBufferSize, iDummy : dword;
  pBuffer, pFileInfo : Pointer;
  iVer : array[1..4] of word;
begin
  Result := '';
  iBufferSize := GetFileVersionInfoSize(PChar(exename), iDummy);
  if iBufferSize > 0 then begin
    GetMem(pBuffer, iBufferSize);
    try
      GetFileVersionInfo(PChar(exename), 0, iBufferSize, pBuffer);
      VerQueryValue(pBuffer, '\', pFileInfo, iDummy);
      iVer[1] := HiWord(PVSFixedFileInfo(pFileInfo)^.dwFileVersionMS);
      iVer[2] := LoWord(PVSFixedFileInfo(pFileInfo)^.dwFileVersionMS);
      iVer[3] := HiWord(PVSFixedFileInfo(pFileInfo)^.dwFileVersionLS);
      iVer[4] := LoWord(PVSFixedFileInfo(pFileInfo)^.dwFileVersionLS);
      finally FreeMem(pBuffer);
    end;
    Result := Format(Fmt, [iVer[1],iVer[2],iVer[3],iVer[4]] );
  end;
end; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-01-07T03:23:53.193

要检查 .NET 程序集，在 C# 中：

System.Reflection.Assembly.LoadFile(@"c:\windows\Microsoft.NET\Framework\v2.0.50727\system.data.dll").GetName().Version.ToString();

# linux - 如何在 Unix / Linux 中获取进程的路径

> ID：606041
> 
> 赞同：154
> 
> 时间：2009-03-03T11:35:05.317
> 
> 标签：linux, unix, process, path, environment

在 Windows 环境中，有一个 API 可以获取正在运行的进程的路径。Unix / Linux中有类似的东西吗？

或者在这些环境中是否有其他方法可以做到这一点？

* * *

## 回答 #1

> 赞同：207
> 
> 时间：2009-03-03T11:40:44.600

在 Linux 上，符号链接`/proc/<pid>/exe`具有可执行文件的路径。使用命令`readlink -f /proc/<pid>/exe`获取值。

在 AIX 上，此文件不存在。你可以比较`cksum <actual path to binary>`和`cksum /proc/<pid>/object/a.out`。

* * *

## 回答 #2

> 赞同：73
> 
> 时间：2014-07-01T08:19:54.330

通过这些方法可以轻松找到exe，自己试试吧。

*   `ll /proc/<PID>/exe`
*   `pwdx <PID>`
*   `lsof -p <PID> | grep cwd`

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2009-03-09T09:19:33.033

有点晚了，但所有答案都是针对 linux 的。

如果你还需要 unix，那么你需要这个：

```
char * getExecPath (char * path,size_t dest_len, char * argv0)
{
    char * baseName = NULL;
    char * systemPath = NULL;
    char * candidateDir = NULL;

    /* the easiest case: we are in linux */
    size_t buff_len;
    if (buff_len = readlink ("/proc/self/exe", path, dest_len - 1) != -1)
    {
        path [buff_len] = '\0';
        dirname (path);
        strcat  (path, "/");
        return path;
    }

    /* Ups... not in linux, no  guarantee */

    /* check if we have something like execve("foobar", NULL, NULL) */
    if (argv0 == NULL)
    {
        /* we surrender and give current path instead */
        if (getcwd (path, dest_len) == NULL) return NULL;
        strcat  (path, "/");
        return path;
    }

    /* argv[0] */
    /* if dest_len < PATH_MAX may cause buffer overflow */
    if ((realpath (argv0, path)) && (!access (path, F_OK)))
    {
        dirname (path);
        strcat  (path, "/");
        return path;
    }

    /* Current path */
    baseName = basename (argv0);
    if (getcwd (path, dest_len - strlen (baseName) - 1) == NULL)
        return NULL;

    strcat (path, "/");
    strcat (path, baseName);
    if (access (path, F_OK) == 0)
    {
        dirname (path);
        strcat  (path, "/");
        return path;
    }

    /* Try the PATH. */
    systemPath = getenv ("PATH");
    if (systemPath != NULL)
    {
        dest_len--;
        systemPath = strdup (systemPath);
        for (candidateDir = strtok (systemPath, ":"); candidateDir != NULL; candidateDir = strtok (NULL, ":"))
        {
            strncpy (path, candidateDir, dest_len);
            strncat (path, "/", dest_len);
            strncat (path, baseName, dest_len);

            if (access(path, F_OK) == 0)
            {
                free (systemPath);
                dirname (path);
                strcat  (path, "/");
                return path;
            }
        }
        free(systemPath);
        dest_len++;
    }

    /* again someone has use execve: we dont knowe the executable name; we surrender and give instead current path */
    if (getcwd (path, dest_len - 1) == NULL) return NULL;
    strcat  (path, "/");
    return path;
} 
```

**已编辑：**修复了 Mark lakata 报告的错误。

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2014-08-02T14:20:02.527

我用：

```
ps -ef | grep 786 
```

将 786 替换为您的 PID 或进程名称。

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2017-12-22T04:42:51.170

`pwdx <process id>`

此命令将从执行它的位置获取进程路径。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2019-01-25T12:58:32.163

下面的命令在正在运行的进程列表中搜索进程的名称，并将pid重定向到pwdx命令来查找进程的位置。

```
ps -ef | grep "abc" |grep -v grep| awk '{print $2}' | xargs pwdx 
```

将“abc”替换为您的特定模式。

或者，如果您可以将其配置为 .bashrc 中的一个函数，如果您需要经常使用它，您可能会发现使用起来很方便。

```
ps1() { ps -ef | grep "$1" |grep -v grep| awk '{print $2}' | xargs pwdx; } 
```

例如：

```
[admin@myserver:/home2/Avro/AvroGen]$ ps1 nifi

18404: /home2/Avro/NIFI 
```

希望这对某人有所帮助......

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-03-03T11:41:17.377

在 Linux 中，每个进程在`/proc`. 因此，您可以使用`getpid()`获取正在运行的进程的 pid，然后将其与路径`/proc`连接以获取您希望需要的文件夹。

这是 Python 中的一个简短示例：

```
import os
print os.path.join('/proc', str(os.getpid())) 
```

这也是 ANSI C 中的示例：

```
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <sys/types.h>

int
main(int argc, char **argv)
{
    pid_t pid = getpid();

    fprintf(stdout, "Path to current process: '/proc/%d/'\n", (int)pid);

    return EXIT_SUCCESS;
} 
```

编译它：

```
gcc -Wall -Werror -g -ansi -pedantic process_path.c -oprocess_path 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-03-03T11:44:30.037

没有“保证在任何地方工作”的方法。

第 1 步是检查 argv[0]，如果程序是通过它的完整路径启动的，这将（通常）具有完整路径。如果它是由相对路径启动的，同样适用（尽管这需要使用 getcwd() 获取当前工作目录。

第二步，如果以上都不成立，就是获取程序名，然后从argv[0]获取程序名，然后从环境中获取用户的PATH，看看有没有合适的具有相同名称的可执行二进制文件。

请注意，argv[0] 是由执行程序的进程设置的，因此它不是 100% 可靠的。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2015-08-11T04:50:28.957

谢谢： AIX 的[Kiwy](https://unix.stackexchange.com/questions/109175/how-to-identify-executable-path-with-its-pid-on-aix-5-or-more)
：

```
getPathByPid()
{
    if [[ -e /proc/$1/object/a.out ]]; then
        inode=`ls -i /proc/$1/object/a.out 2>/dev/null | awk '{print $1}'`
        if [[ $? -eq 0 ]]; then
            strnode=${inode}"$"
            strNum=`ls -li /proc/$1/object/ 2>/dev/null | grep $strnode | awk '{print $NF}' | grep "[0-9]\{1,\}\.[0-9]\{1,\}\."`
            if [[ $? -eq 0 ]]; then
                # jfs2.10.6.5869
                n1=`echo $strNum|awk -F"." '{print $2}'`
                n2=`echo $strNum|awk -F"." '{print $3}'`
                # brw-rw----    1 root     system       10,  6 Aug 23 2013  hd9var
                strexp="^b.*"$n1,"[[:space:]]\{1,\}"$n2"[[:space:]]\{1,\}.*$"   # "^b.*10, \{1,\}5 \{1,\}.*$"
                strdf=`ls -l /dev/ | grep $strexp | awk '{print $NF}'`
                if [[ $? -eq 0 ]]; then
                    strMpath=`df | grep $strdf | awk '{print $NF}'`
                    if [[ $? -eq 0 ]]; then
                        find $strMpath -inum $inode 2>/dev/null
                        if [[ $? -eq 0 ]]; then
                            return 0
                        fi
                    fi
                fi
            fi
        fi
    fi
    return 1
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-05-12T17:33:57.317

您还可以通过以下方式获取 GNU/Linux 上的路径（未经彻底测试）：

```
char file[32];
char buf[64];
pid_t pid = getpid();
sprintf(file, "/proc/%i/cmdline", pid);
FILE *f = fopen(file, "r");
fgets(buf, 64, f);
fclose(f); 
```

如果您希望可执行文件的目录可能将工作目录更改为进程的目录（对于媒体/数据/等），您需要删除最后一个 / 之后的所有内容：

```
*strrchr(buf, '/') = '\0';
/*chdir(buf);*/ 
```

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2011-10-28T15:10:09.573

查找进程名称的路径

```
#!/bin/bash
# @author Lukas Gottschall
PID=`ps aux | grep precessname | grep -v grep | awk '{ print $2 }'`
PATH=`ls -ald --color=never /proc/$PID/exe | awk '{ print $10 }'`
echo $PATH 
```

# c# - 从 App.xaml.cs 关闭 WPF 应用程序

> ID：606043
> 
> 赞同：37
> 
> 时间：2009-03-03T11:36:12.287
> 
> 标签：c#, wpf, application-shutdown

我目前正在编写一个 WPF 应用程序，它在 App.xaml.cs 中进行命令行参数处理（这是必要的，因为 Startup 事件似乎是获取这些参数的推荐方式）。根据我想在那个时候退出程序的参数，据我所知，应该在 WPF 中使用`Application.Current.Shutdown()`或在这种情况下（因为我在当前应用程序对象中）可能也只是`this.Shutdown()`.

唯一的问题是这似乎无法正常工作。在该行仍然执行之后，我已经逐步完成了调试器和代码，`Shutdown()`这导致该方法之后出现错误，因为我预计应用程序不会存活那么久。此外，主窗口（在 XAML 的 StartupUri 属性中声明）仍会被加载。

我检查了该方法的文档，并在评论中没有发现任何内容告诉我我不应该在期间`Application.Startup`或根本不使用它`Application`。

那么，此时退出程序的正确方法是什么，即。e. 对象中的`Startup`事件处理程序`Application`？

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2009-03-03T11:49:43.050

首先从 App.xaml 中删除 StartupUri 属性，然后使用以下内容：

```
 protected override void OnStartup(StartupEventArgs e)
    {
        base.OnStartup(e);

        bool doShutDown = ...;

        if (doShutDown)
        {
            Shutdown(1);
            return;
        }
        else
        {
            this.StartupUri = new Uri("Window1.xaml", UriKind.Relative);
        }
    } 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-02-15T18:14:46.550

如果您为具有 MainWindow 的应用程序从 app.xaml 中删除 StartupUri，您需要确保在 OnStartup 方法中进行以下调用，否则当您的 MainWindow 关闭时应用程序不会终止。

```
this.ShutdownMode = System.Windows.ShutdownMode.OnMainWindowClose; 
```

@Frank Schwieterman，这些方面的内容可能会帮助您解决控制台窗口问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-06-11T21:56:49.913

我做了一些不同的事情，以避免必须设置`StartupUri`and`ShutdownMode`属性。首先编辑`App.xaml`文件并替换`StartupUri`为`Startup`：

```
<Application x:Class="Menu.App"
         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
         xmlns:local="clr-namespace:Menu"
         Startup="Application_Startup">
    <Application.Resources>
    </Application.Resources>
</Application> 
```

然后添加`Application_Startup`到代码中`OnExit`：

```
public partial class App : Application
{
    private volatile static Mutex s_mutex;

    private void Application_Startup(object sender, StartupEventArgs e)
    {
        s_mutex = new Mutex(true, @"Global\MenuMutex", out bool grantedOwnership);

        if (!grantedOwnership)
        {
            MessageBox.Show($"Another instance is already running!", "Error", MessageBoxButton.OK, MessageBoxImage.Exclamation);
            Current.Shutdown();
        }
        else
            new MainWindow().Show();
    }

    protected override void OnExit(ExitEventArgs e)
    {
        s_mutex?.ReleaseMutex();
        s_mutex?.Dispose();
        s_mutex = null;
        base.OnExit(e);
    } 
```

# c# - Windows Mobile API 调用 - 成功但 GetLastWin32Error 返回错误代码 - 我应该担心吗？

> ID：606048
> 
> 赞同：0
> 
> 时间：2009-03-03T11:37:30.350
> 
> 标签：c#, .net, windows-mobile, pinvoke

我是 PInvoke 呼叫的新手。我用谷歌搜索了这个，因为这似乎是一个很简单的问题，但并不快乐。

我正在连续进行多次 Windows Mobile API 调用（以检测我的应用程序是否已经在运行，然后重新激活它）。一切正常，花花公子，但我想在它不能正常工作的时候加入日志记录等。

在编写此代码时，我发现即使我的调用显然返回了有效结果并且后续调用成功使用了有效结果（我认为证明它是有效的），我也会收到错误代码。

例如，我调用 CreateToolhelp32Snapshot，它为我提供了当前运行进程快照的句柄。在返回错误 6 后立即调用 Marshal.GetLatWin32Error，这显然意味着无效的句柄。但是返回值被后续调用其他方法成功使用，整个过程正常。绝对是这个特定的调用设置了错误 6，因为如果您在调用之前调用 Marshal.GetLatWin32Error，它会返回 0。

对 Process32First 和 Process32Next 的调用表现出类似的行为，即它们很高兴地给我进程信息，但有时会设置错误 6。我（认为）我知道这是因为我在每次调用之前和之后立即调用 Marshal.GetLatWin32Error，有时它在之前和 6 之前是 0后。目前我总是得到一个成功的结果（或者一个处理后续调用的句柄，或者一个转换为 1 如果 int 或 true 如果 bool 和进程信息成功复制到我的缓冲区中的值）。

所以……我应该关心吗？这一切都在工作....如果我返回一个被其余过程成功使用的结果，我是否关心设置了什么错误？我的直觉说是的，我当然愿意？无论哪种方式，如果我显然得到了成功的结果但也设置了错误代码，我怎么知道一切是否正常？我做噩梦发布一个不稳定的系统，它不会给我有用的错误信息............

更新

这是我的 loggong 代码的结果，试图为任何感兴趣的人说明我在说什么。简而言之，代码检查自身是否已经运行，然后检查客户端是否已经运行，如果找到则重新激活客户端。

```
Method name: CreateToolhelp32Snapshot, Result: 605618176, Pre-call error code: 0, Post-call error code: 6
Method name: Process32First, Result: True, Pre-call error code: 6, Post-call error code: 6               
Method name: Process32Next, Result: True, Pre-call error code: 6, Post-call error code: 6                
Method name: Process32Next, Result: True, Pre-call error code: 6, Post-call error code: 0                
Method name: Process32Next, Result: True, Pre-call error code: 0, Post-call error code: 0                
Method name: Process32Next, Result: True, Pre-call error code: 0, Post-call error code: 0                
Method name: Process32Next, Result: True, Pre-call error code: 0, Post-call error code: 0                
Method name: Process32Next, Result: True, Pre-call error code: 0, Post-call error code: 0                
Method name: Process32Next, Result: True, Pre-call error code: 0, Post-call error code: 0                
Method name: Process32Next, Result: True, Pre-call error code: 0, Post-call error code: 0                
Method name: Process32Next, Result: True, Pre-call error code: 0, Post-call error code: 0                
Method name: Process32Next, Result: True, Pre-call error code: 0, Post-call error code: 0                
Method name: Process32Next, Result: True, Pre-call error code: 0, Post-call error code: 0                
Method name: Process32Next, Result: True, Pre-call error code: 0, Post-call error code: 0                
Method name: Process32Next, Result: True, Pre-call error code: 0, Post-call error code: 0                
Method name: Process32Next, Result: True, Pre-call error code: 0, Post-call error code: 0                
Method name: Process32Next, Result: True, Pre-call error code: 0, Post-call error code: 0                
Method name: Process32Next, Result: True, Pre-call error code: 0, Post-call error code: 0                
Method name: Process32Next, Result: True, Pre-call error code: 0, Post-call error code: 0                
Method name: Process32Next, Result: True, Pre-call error code: 0, Post-call error code: 0                
Method name: Process32Next, Result: True, Pre-call error code: 0, Post-call error code: 0                                                                            
Method name: Process32Next, Result: False, Pre-call error code: 0, Post-call error code: 18              
Method name: CloseToolhelp32Snapshot, Result: True, Pre-call error code: 18, Post-call error code: 6     
Method name: CreateToolhelp32Snapshot, Result: 605618176, Pre-call error code: 6, Post-call error code: 0
Method name: Process32First, Result: True, Pre-call error code: 0, Post-call error code: 0               
Method name: Process32Next, Result: True, Pre-call error code: 0, Post-call error code: 0                
Method name: Process32Next, Result: True, Pre-call error code: 0, Post-call error code: 0                
Method name: Process32Next, Result: True, Pre-call error code: 0, Post-call error code: 0                
Method name: Process32Next, Result: True, Pre-call error code: 0, Post-call error code: 0                
Method name: Process32Next, Result: True, Pre-call error code: 0, Post-call error code: 0                
Method name: Process32Next, Result: True, Pre-call error code: 0, Post-call error code: 0                
Method name: Process32Next, Result: True, Pre-call error code: 0, Post-call error code: 0                
Method name: Process32Next, Result: True, Pre-call error code: 0, Post-call error code: 0                
Method name: Process32Next, Result: True, Pre-call error code: 0, Post-call error code: 0                
Method name: Process32Next, Result: True, Pre-call error code: 0, Post-call error code: 0                
Method name: Process32Next, Result: True, Pre-call error code: 0, Post-call error code: 0                
Method name: Process32Next, Result: True, Pre-call error code: 0, Post-call error code: 0                
Method name: Process32Next, Result: True, Pre-call error code: 0, Post-call error code: 0                
Method name: Process32Next, Result: True, Pre-call error code: 0, Post-call error code: 0                
Method name: Process32Next, Result: True, Pre-call error code: 0, Post-call error code: 0                
Method name: Process32Next, Result: True, Pre-call error code: 0, Post-call error code: 0                
Method name: Process32Next, Result: True, Pre-call error code: 0, Post-call error code: 0                
Method name: Process32Next, Result: True, Pre-call error code: 0, Post-call error code: 0                
Method name: Process32Next, Result: True, Pre-call error code: 0, Post-call error code: 0                                                                      
Method name: Process32Next, Result: False, Pre-call error code: 0, Post-call error code: 18              
Method name: CloseToolhelp32Snapshot, Result: True, Pre-call error code: 18, Post-call error code: 0     
Method name: ShowWindow, Result: True, Pre-call error code: 0, Post-call error code: 120                 
Method name: SetForegroundWindow, Result: True, Pre-call error code: 120, Post-call error code: 6 
```

结果始终为真，除了对 Process32Next 的最后一次调用，其中代码 18 的失败表示已到达最后一个条目。而且我刚刚注意到 ShowWindow 导致了不支持的错误 120，所以我会取消这个调用。

所以我的两个实际问题是：

为什么我成功时出现错误？
而且，当调用前和调用后错误相同时，我如何知道这是旧错误还是同一错误的第二次出现？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T13:36:20.113

除非 CreateToolhelp32Snapshot 返回 INVALID_HANDLE_VALUE，否则不应调用 GetLastWin32Error (GetLastError)。

看[http://msdn.microsoft.com/en-us/library/ms682489(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms682489(VS.85).aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T13:41:30.800

您希望 GetLastError() 在每次成功调用任何函数后返回 0。但这意味着这些函数在其结语中调用 SetLastError(0) 并不总是这样做。这就是为什么您无法区分旧错误代码和新错误代码的原因。仅在 MSDN 告诉您这样做的情况下调用 GetLastError()。

# actionscript-3 - 某些计算机中没有出现字体抗锯齿（win）

> ID：606051
> 
> 赞同：0
> 
> 时间：2009-03-03T11:39:27.037
> 
> 标签：actionscript-3, flex3

我已经测试了我的 Flash 游戏，并且字体在所有机器（Windows）中都没有抗锯齿。有没有办法强制 FLASH 总是抗锯齿？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T12:14:15.597

有问题的电脑上是否安装了字体？还是您将字体嵌入到 swf 电影中？

否则 swf 将显示默认字体，我想它不会显示消除锯齿的文本。

因此，我的第一个技巧是嵌入您正在使用的字体，然后在它不工作的计算机上再次测试。

我假设我们在这里谈论动态或输入文本？

# sql - sqlserver日期算术题

> ID：606055
> 
> 赞同：1
> 
> 时间：2009-03-03T11:40:28.907
> 
> 标签：sql, sql-server, sql-server-2005, tsql, stored-procedures

我有日历控件的开始时间和结束时间的事件记录。

我想在特定日期完成活动，比如 2009 年 2 月 28 日

但是 db 表的日期数据格式为 2/28/2009 10:00:00、2/28/2009 12:00:00。

我在 VS 2005 IDE 中创建的存储过程中尝试了这个查询，但它没有用

```
ALTER PROCEDURE dbo.spSelectBenchEvent
(   
@EVENT_DATE DATE // BTW, THIS RETURNS ERROR :CANNOT FIND DATE DATATYPE.
                 //@EVENT_DATE HAS INVALID DATATYPE 
)
AS
BEGIN TRAN
SET NOCOUNT ON;

SELECT     ID, EID, BENCHID, PACCODE, START_TIME, END_TIME
    FROM         tbl_benchbook
    WHERE START_TIME=EVENT_DATE
    ORDER BY START_TIME 
```

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T11:50:12.020

如果您希望评估 2009 年 3 月 29 日的所有事件，请使用以下 where 条款。

```
SELECT *
FROM tableName
WHERE Date >= '2009/03/29' AND  Date < '2009/03/30' 
```

这里要指出的关键点是，为了捕获在给定日期发生的所有记录，您需要定义一个包含当天所有时间值的日期范围。

有道理？

干杯，约翰

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T12:07:51.713

有很多与此相关的问题，请查看：

*   [在 SQL Server 中设置日期](https://stackoverflow.com/questions/85373/floor-a-date-in-sql-server/85379#85379)

并为了获得最佳性能解决方案检查：[MS SQL Date Only without Time](https://stackoverflow.com/questions/467103/ms-sql-date-only-without-time/467130#467130)

基本上你的代码可能看起来像：

```
select     
    id, eid, benchid, paccode, start_time, end_time
from  
    tbl_benchbook
where start_time >= dateadd(dd, datediff(dd, 0, @event_date), 0)
and start_time < dateadd(dd, datediff(dd, 0, @event_date)+1, 0) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-03T12:20:19.500

根据您更新的问题，这应该有效：

```
 SELECT  ID, EID, BENCHID, PACCODE, START_TIME, END_TIME
   FROM    tbl_benchbook
   WHERE   START_TIME >= @EVENT_DATE 
   AND     START_TIME < DATEADD(day,1,@EVENT_DATE)
   ORDER BY START_TIME 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-03-03T13:58:51.977

```
--1\. you need to make sure there is no time on the parameter
--2\. you can just use "+1" on the datetime, to get the next day

    enter ALTER PROCEDURE dbo.spSelectBenchEvent
    (   
    @EVENT_DATE DATETIME 
    )
    AS
    BEGIN TRAN
    SET NOCOUNT ON;

    --remove any time from given date
    SET @EVENT_DATE=CONVERT(char(10),@EVENT_DATE,111)

    SELECT     ID, EID, BENCHID, PACCODE, START_TIME, END_TIME
            FROM         tbl_benchbook
            WHERE START_TIME>=@EVENT_DATE AND START_TIME<@EVENT_DATE+1
            ORDER BY START_TIME
    code here 
```

# java - 我应该将 SQL 文件放在我的 Java 项目中的什么位置？

> ID：606062
> 
> 赞同：25
> 
> 时间：2009-03-03T11:43:18.277
> 
> 标签：java, sql, version-control

我有一个 Java 项目，其中包含许多用于查询数据库的大型 SQL 语句。我的问题是：我应该把它们存放在哪里？

我相当确定我希望每个语句都有自己的文本文件，由源代码控制管理。由于 Java 不支持多行字符串，因此我无法轻松地将 SQL 放入我的`.java`文件中，而且我认为我也不想这样做。在构建时，我可以将这些文本文件放入 JAR 并使用[`ClassLoader.getResourceAsStream()`](http://java.sun.com/javase/6/docs/api/java/lang/ClassLoader.html#getResourceAsStream%28java.lang.String%29).

所以我的问题变成了我应该把这些文件放在哪个目录中，我应该叫它们什么。理想情况下，我希望人们从`.sql`文件中分辨出哪个 Java 类使用它。我绝对不想要的是一个包含大量文件的单个目录，例如`report1.sql`等等`report3.sql`。

我的倾向是将它们与所有`.java`文件一起放在包目录中，但我有一位同事不喜欢`.java`在这棵树中拥有除文件之外的任何东西。因此，这导致替代一个独立的目录结构来镜像 Java 包，但这似乎是不必要的开销。

所以我很想听听你对 SQL 文件做了什么。

我们正在使用 Netbeans 6.5，以防影响您的答案。

（[这个问题](https://stackoverflow.com/questions/576571/where-do-you-put-sql-statements-in-your-c-projects)很相似，但遗憾的是答案非常特定于 C#，这对那个问题有好处，但对我不利。）

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-03-03T11:47:46.130

在 Java/Maven 设置中，我们用作项目层次结构：

```
project/src/main/java/Package/Class.java
project/src/test/java/Package/ClassTest.java
project/src/main/resources/Package/resource.properties
project/src/test/resources/Package/test_resource.properties 
```

为了回答您的问题：我会将 SQL 文件与资源一起放在 src/main/resources 下。

你可能想看看这个[线程](https://stackoverflow.com/questions/301839/unittest-how-do-you-organise-your-testing-files)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-03T13:01:24.407

我很想将 SQL 查询放在`SQL`src 下的专用文件夹中。这将 Java 代码与 SQL 分开：

```
+ src
  + java 
  + sql
     - Package/Class.sql
+ test 
```

或者，您可以使用上述结构将它们放入简单的属性文件中：

```
getUserByName = select * from users where name=?

getUserByEmail = select * from users where email=?

getUserByLongQuery = select * from users where email=? \
   and something = ? \
   where something_else = ? 
```

另外，我认为值得一提的是，如果您更喜欢采用这种方式，可以将多行字符串放入 Java 类中：

```
class MyClass {
    MY_QUERY = "select * from users where email = ? " + 
               "and something_else = ?";
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-03-24T16:49:04.050

为了与[http://maven.apache.org/pom.html#Resources](http://maven.apache.org/pom.html#Resources)保持一致，这个地方可能是以下之一：

*   `src/main/sql`
*   `src/main/upgrade`或`srv/main/migrate`- 用于版本之间的升级/迁移脚本
*   `src/main/db`, `src/main/schema`, `src/main/ddl`- 用于当前项目数据库模式，用于初始项目部署
*   等，只需放入`src/main/NAME`目录
*   `src/main/resources/NAME`是一种将 SQL 文件放入类路径的最快方法，因为 Maven/Gradle 默认会从 ``src/main/resources/` 复制所有内容到最终工件。

其他需要考虑的事项：

*   FlyWay DB 迁移工具假设升级`Vxx__YYY.sql`脚本位于，`classpath:resources/db/migration` [因此您将它们放置到项目](https://flywaydb.org/documentation/gradle/migrate) `src/main/resources/db/migration`目录中。
*   LiquiBase DB 迁移工具建议[在您的类路径中选择一个包来存储更改日志，最好靠近您的数据库访问类](http://www.liquibase.org/bestpractices.html)

IDE 可能不支持其他目录`src/main/java`，`src/main/resources`在*项目浏览器*的项目查看器中，请改用*文件查看器*。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-03T12:48:19.697

我完全同意布塔。Maven 为 src 文件夹管理设置了一个很好的标准。您是否考虑过将 SQL 存储在 XML 中？将查询保存在单个文件中可能更容易管理 SQL。我的第一直觉很简单：

```
<?xml version="1.0" encoding="UTF-8"?>
<queries>
    <query id="getUserByName">
        select * from users where name=?
    </query>
    <query id="getUserByEmail">
        select * from users where email=?
    </query>
</queries> 
```

要解析文件，请使用 xpath 甚至 SAX 来创建以 id 为键的查询映射，以实现快速查询查找。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-03T22:43:47.800

这是对最初问题的轻微重复，但可以说 SQL 越复杂，它就越属于数据库（或服务层）而不是 Java 代码。

否则，随着代码的成熟，就会出现[这样](https://stackoverflow.com/questions/565792/inserting-into-oracle-the-wrong-way-how-to-deal-with-it/567575)的问题。

# graphics - 在汇编程序中编程图形？

> ID：606067
> 
> 赞同：9
> 
> 时间：2009-03-03T11:44:40.303
> 
> 标签：graphics, assembly

我使用 Visual C++ 6.0 和 DirectX 开发了一个正在运行的 Super Mario Sprite。但这对我来说不是很令人满意（仅使用 3D 多媒体框架来显示 2D 精灵），所以我希望能够仅使用 C 和汇编程序来编写动画精灵。

因此，在查看旧游戏（例如 Wolfenstein）时，看起来大部分游戏都是用 C 编写的，并且每次涉及图形输出时都会使用汇编程序。

不幸的是，当尝试使用这个旧的汇编代码时，总是会出现错误消息“NTVDM.exe 发现无效指令”，所以现在这些东西似乎不起作用。

是否有任何关于汇编程序中图形编程的教程仍然有用？

（我不想使用任何臃肿的框架或库，我只想自己开发所有东西。WinAPI 可以用于创建全屏窗口和捕获用户输入，但不适用于图形，因为我也读过 GDI对于快速图形，速度较慢。）

我正在使用 WindowsXP 和 MASM 或 A86。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-03T12:42:34.717

我完全同意 samcl

不再使用汇编程序的主要原因是您无法再访问 Videomemory。早在早期（您提到了德军总部），有一种称为[0x13h](http://www.brackeen.com/vga/basics.html)的特殊视频模式，其中您的图形只是一块内存（每个像素都是调色板颜色，范围从 0-255<--1 字节）通过这种特定的视频模式访问此内存，但是，今天事情要复杂得多

今天你有非常快的视频内存，使用你的 CPU 访问它只会破坏所有性能，因为你的 CPU 是通过 PCI-Express/AGP/PCI/VESA-LOCALBUS/ISA 连接的（<-记住任何人！？）

图形编程通常是大量的读写访问（读取像素，检查是否透明，乘以 alpha，写入像素等）现代内存接口比直接访问显卡**内部要慢得多。**这就是为什么你真的应该使用着色器，正如 Robert Gould 所建议的那样。通过这种方式，您可以编写更快、更容易理解的代码，并且不会使您的 GFX-Memory 停滞。

如果您对 GFX 编程更感兴趣，您可以使用[shadertoy](https://www.shadertoy.com/)来满足您的胃口，这是一个致力于基于着色器的效果以及基于 WebGL 的着色器代码执行的社区。

此外，您的初学者汇编代码将非常蹩脚。在质量和性能上。相信我。优化这样的原始代码需要大量时间。因此，您编译的 C/C++ 代码将轻松胜过您的手写 asm。

如果您对 Assembler 感兴趣，请尝试编写类似 diskaccess 的代码。这是您可以获得很多性能的地方。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-03-03T11:49:07.780

听起来您只使用 Assembler，因为您似乎认为这是必要的。事实并非如此。如果您没有任何其他原因（即想学习它），请不要在这里使用 Assembler，除非您确切知道自己在做什么。

对于您的普通图形引擎，完全不需要汇编程序编程。特别是当涉及到超级马里奥风格的 2D 精灵引擎时。即使是像 Python 这样的“慢速”脚本语言，现在也足以应付这些事情了。

除此之外，如果您不太准确地知道自己在做什么，那么汇编程序*不会*比 C 快（事实上，它可能会更慢，因为您重新实现现有 C 函数的效率会降低）。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-03T12:06:33.197

我猜你是否已经在使用 C 和 DirectX，速度不是问题，这更像是一个学习练习。对于 Windows 下的 2D，C 和 DirectX 确实会非常快，正如 Konrad Rudolph 所指出的，手动汇编程序不太可能比高度优化的 SDK 更快。

从纯教育的角度来看，这是一项有趣的活动，但相当复杂。回到家用电脑和第一台 PCS 的早期，图形屏幕看起来就像一块内存，其中字节对应一个或多个彩色像素。通过更改屏幕内存的值，您可以绘制点，从而绘制线，并绘制到精灵等...在现代 PC 上，这往往不是一个选项，因为您通常通过 SDK 对显卡进行编程，以做同样的工作。然后，卡片会进行艰苦的工作，并为您提供更高级别的抽象。如果你真的想感受一下当时的感觉，我会推荐一个模拟器。对于现代游戏，请坚持使用您的 SDK。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-03T16:10:25.140

It is possible to program your own 2D engine in a recent version of Directx, if you wish to investigate this avenue. You can create a "screen space" aligned polygon, with no perspective correction, of which is texture mapped. You can then plot your sprites on a pixel-by-pixel basis onto this texture map.

* * *

As for mode 13h (Peter Parker), it brings back some memories!

```
__asm
{
mov ax,0x13
int 10h           // 16-bit code only, not Windows
} 
```

But of course this will fault in a 32-bit or 64-bit Windows program; 16-bit BIOS calls are not supported by the Windows kernel (which installs its own interrupt table as part of booting and switching the CPU to 64-bit mode.)

I would tend to avoid assembler with a barge pole, it can be particulary difficult to debug, and maintain; however if you wish to explore this subject in more detail, I can recommend [Michal Abrash's Graphics Programming Black Book](http://www.freetechbooks.com/michael-abrash-s-graphics-programming-black-book-t78.html). It's a bit old, but a good read and will give you some insight into graphics programming techniques before 3D hardware.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-03T12:01:00.653

图形汇编器是因为当时大多数人缺乏支持 3d 的图形卡，所以它必须在 CPU 上完成，而不是现在。现在它是关于着色器编程的。着色器语言允许您拥抱裸机。因此，如果您应该尝试将 2d 图形编码为着色基础，那么这种体验将具有作为职业技能的价值。

尝试 CUDA 作为初学者。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-03T12:01:41.667

我的建议是进行实验。从 C/GDI 和 C++/DirectDraw 开始，获取您的 sprite 代码并以多种形式编写。不用担心汇编程序。

DirectX 是快速动作图形的最佳选择。学习它，然后弄清楚如何使用汇编程序进行微优化。一般来说，汇编程序不会让您的 API 调用更快。它将为 3D 旋转、纹理映射、着色等更快的计算提供灵活性。

从 DirectDraw 开始。这是一个[常见问题解答](http://www.mvps.org/directx/faq/direct_draw.htm)。从技术上讲，DirectDraw 在 DirectX 7 之后被弃用，但您仍然可以使用它并从中学习。它将允许您直接修改帧缓冲区，这可能是您正在寻找的。

[TripleBuffer Software](http://triplebuffer.devmaster.net/)上有一些有用的教程和论坛。

还可以考虑将编译器升级到[Visual C++ 2008 Express](http://www.microsoft.com/express/vc/)。VC++ 6 有一个错误的编译器，在尝试编译某些 C++ 库时可能会出现问题。

# gridview - 如何分配单元格值

> ID：606068
> 
> 赞同：0
> 
> 时间：2009-03-03T11:44:43.423
> 
> 标签：gridview

如何将网格视图控件中的单元格值分配给字符串变量（局部变量）

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-04T13:35:49.653

在 GridView 行绑定事件上，该行的第一列类似于：

```
v = e.Row.Cells(0).Text 
```

具体来说，如果 val 是您的全局字符串，则：

```
Protected Sub GridView1_RowDataBound(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.GridViewRowEventArgs) Handles GridView1.RowDataBound
    If (e.Row.RowType = DataControlRowType.DataRow) Then
        val = e.Row.Cells(0).Text
    End If
End Sub 
```

# php - 展开链接以在不使用 javascript 的情况下显示图像

> ID：606069
> 
> 赞同：0
> 
> 时间：2009-03-03T11:44:56.417
> 
> 标签：php, javascript, html

我有一个包含一些文本和链接的页面。我想在单击这些链接时在其中显示图像。但是，我必须完全不使用 javascript。我只能使用一些服务器端组件，例如 PHP。谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T12:04:28.617

由于您在评论中声明您不想重新加载页面并且不能使用 Ajax，因此 PHP 不会帮助您，因为它在服务器上运行。相反，您可以使用 CSS 实现您想要的。看看[这个简单的演示](http://www.aisee.com/gallery/no_js.html)。

基本上，您将图像放在链接中：

```
<a href="#img1">link text <img src="..."></a> 
```

然后在您的 CSS 中指定如下内容：

```
a img {display:none}
a:visited img {display:inline} 
```

所以图片默认是隐藏的，但是一旦用户点击链接，图片就会显示出来。如果您的页面上有多个图像，则必须为每个链接分配不同的 href 锚点：

```
<a href="#img1">link text <img src="..."></a>
<a href="#img2">link text <img src="..."></a> 
```

这种方法的一个潜在问题是，一旦用户显示了特定图像，默认情况下，该图像也会在该用户随后访问该页面时显示，除非他清除其浏览器历史记录。如果您想防止这种情况发生，即默认情况下始终隐藏所有图像，那么，例如，您的 PHP 代码每次都会生成随机的 href 锚点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T11:48:32.163

这是完全可能的，但是您必须容忍这样一个事实，即当用户单击链接时，必须重新加载页面才能显示图像。

因此，基本上，您的链接将是这样的：

[http://myserver/myscript.php?id=0](http://myserver/myscript.php?id=0)

然后你的 PHP 会包含一个 IMG 标签来对应合适的图片，可能是这样的：

```
$id = $_GET['id'];
echo "<img src='/images/image_$id.jpg'>\n"; 
```

如果您能够使用 Javascript，则无需重新加载页面即可使其工作，但除此之外，使用 PHP 应该没问题。

# python - Python：如何转储 mechanize.Browser 实例的 cookie？

> ID：606072
> 
> 赞同：11
> 
> 时间：2009-03-03T11:47:21.823
> 
> 标签：python, cookies, mechanize-python

我正在学习如何使用[mechanize](http://wwwsearch.sourceforge.net/mechanize/)，一个 Python 模块来自动与网站交互。

一项功能是自动处理 cookie。我想从`mechanize.Browser`实例中转储 cookie 以进行调试，但我自己似乎无法弄清楚这一点。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-03-03T12:02:03.117

```
 >>> from mechanize import Browser
>>> b = Browser()
>>> b._ua_handlers['_cookies'].cookiejar
mechanize._clientcookie.CookieJar[]
>>> b.open('http://google.com')
response_seek_wrapper at 0xb7a922ccL whose wrapped object = closeable_response at 0xb7aa070cL whose fp = socket._fileobject object at 0xb7a94224
>>>
>>> b._ua_handlers['_cookies'].cookiejar
mechanize._clientcookie.CookieJar[Cookie(version=0, name='PREF', value='ID=57d545c229b4cf3f:TM=1236081634:LM=1236081634:S=p001WJMOr-V8Rlvi', port=None, port_specified=False, domain='.google.com', domain_specified=True, domain_initial_dot=True, path='/', path_specified=True, secure=False, expires=1299153634, discard=False, comment=None, comment_url=None, rest={}, rfc2109=False), Cookie(version=0, name='PREF', value='ID=20534d80a5ccf2ea:TM=1236081635:LM=1236081635:S=jW3UotZ0dg8sv6mf', port=None, port_specified=False, domain='.google.com.ua', domain_specified=True, domain_initial_dot=True, path='/', path_specified=True, secure=False, expires=1299153635, discard=False, comment=None, comment_url=None, rest={}, rfc2109=False)]
>>> 

```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-12-23T18:43:59.250

只需打印 CookieJar 实例

```
# Browser
br = mechanize.Browser()

# Cookie Jar
cj = cookielib.LWPCookieJar()
br.set_cookiejar(cj)

# Dump
print cj 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-01-26T22:18:25.097

Mykolas 的回答几乎给了我我想要的东西。我正在寻找如何将 cookie 保存到文件中。由于这个答案为将 cookie 转储到文件中提供了余地，因此它可能对其他来这里寻找它的人有用。要将 cookie 保存到文件中：

```
br._ua_handlers['_cookies'].cookiejar.save("cookie.txt", ignore_discard=True, ignore_expires=True) 
```

# java - Java中Xmodem协议的实现

> ID：606074
> 
> 赞同：1
> 
> 时间：2009-03-03T11:47:28.173
> 
> 标签：java, protocols, xmodem

如何使用 XMODEM 协议通过 Java 中的串行端口接收文件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-03T15:03:22.447

这里是。

我在[JModem 源代码](http://www.java2s.com/Code/Java/Network-Protocol/JModemsimplecommunicationsprogram.htm)中找到了这个。如果您查看它在哪里写入数据，您可以看到它在执行 SOH、blocknum、~blocknum、数据和校验和。它使用的扇区大小为 128。它们共同构成了标准的[XModem 协议](http://en.wikipedia.org/wiki/XMODEM)。从这里也可以简单地执行 XModem1K、YModem 和 ZModem。

```
/**
 * a tiny version of Ward Christensen's MODEM program for UNIX. 
 * Written ~ 1980 by Andrew Scott Beals. Last revised 1982.
 * A.D. 2000 - dragged from the archives for use in Java Cookbook.
 *
 * @author C version by Andrew Scott Beals, sjobrg.andy%mit-oz@mit-mc.arpa.
 * @author Java version by Ian F. Darwin, ian@darwinsys.com
 * $Id: TModem.java,v 1.8 2000/03/02 03:40:50 ian Exp $
 */
class TModem {

    protected final byte CPMEOF = 26;       /* control/z */
    protected final int MAXERRORS = 10;     /* max times to retry one block */
    protected final int SECSIZE = 128;      /* cpm sector, transmission block */
    protected final int SENTIMOUT = 30;     /* timeout time in send */
    protected final int SLEEP   = 30;       /* timeout time in recv */

    /* Protocol characters used */

    protected final byte    SOH = 1;    /* Start Of Header */
    protected final byte    EOT = 4;    /* End Of Transmission */
    protected final byte    ACK = 6;    /* ACKnowlege */
    protected final byte    NAK = 0x15; /* Negative AcKnowlege */

    protected InputStream inStream;
    protected OutputStream outStream;
    protected PrintWriter errStream;

    /** Construct a TModem */
    public TModem(InputStream is, OutputStream os, PrintWriter errs) {
        inStream = is;
        outStream = os;
        errStream = errs;
    }

    /** Construct a TModem with default files (stdin and stdout). */
    public TModem() {
        inStream = System.in;
        outStream = System.out;
        errStream = new PrintWriter(System.err);
    }

    /** A main program, for direct invocation. */
    public static void main(String[] argv) throws 
        IOException, InterruptedException {

        /* argc must == 2, i.e., `java TModem -s filename' */
        if (argv.length != 2) 
            usage();

        if (argv[0].charAt(0) != '-')
            usage();

        TModem tm = new TModem();
        tm.setStandalone(true);

        boolean OK = false;
        switch (argv[0].charAt(1)){
        case 'r': 
            OK = tm.receive(argv[1]); 
            break;
        case 's': 
            OK = tm.send(argv[1]); 
            break;
        default: 
            usage();
        }
        System.out.print(OK?"Done OK":"Failed");
        System.exit(0);
    }

    /* give user minimal usage message */
    protected static void usage()
    {
        System.err.println("usage: TModem -r/-s file");
        // not errStream, not die(), since this is static.
        System.exit(1);
    }

    /** If we're in a standalone app it is OK to System.exit() */
    protected boolean standalone = false;
    public void setStandalone(boolean is) {
        standalone = is;
    }
    public boolean isStandalone() {
        return standalone;
    }

    /** A flag used to communicate with inner class IOTimer */
    protected boolean gotChar;

    /** An inner class to provide a read timeout for alarms. */
    class IOTimer extends Thread {
        String message;
        long milliseconds;

        /** Construct an IO Timer */
        IOTimer(long sec, String mesg) {
            milliseconds = 1000 * sec;
            message = mesg;
        }

        public void run() {
          try {
            Thread.sleep(milliseconds);
          } catch (InterruptedException e) {
            // can't happen
          }
          /** Implement the timer */
          if (!gotChar)
            errStream.println("Timed out waiting for " + message);
            die(1);
        }
    }

    /*
     * send a file to the remote
     */
    public boolean send(String tfile) throws IOException, InterruptedException
    {
        char checksum, index, blocknumber, errorcount;
        byte character;
        byte[] sector = new byte[SECSIZE];
        int nbytes;
        DataInputStream foo;

        foo = new DataInputStream(new FileInputStream(tfile));
        errStream.println( "file open, ready to send");
        errorcount = 0;
        blocknumber = 1;

        // The C version uses "alarm()", a UNIX-only system call,
        // to detect if the read times out. Here we do detect it
        // by using a Thread, the IOTimer class defined above.
        gotChar = false;
        new IOTimer(SENTIMOUT, "NAK to start send").start();

        do {
            character = getchar();
            gotChar = true;
            if (character != NAK && errorcount < MAXERRORS)
                ++errorcount;
        } while (character != NAK && errorcount < MAXERRORS);

        errStream.println( "transmission beginning");
        if (errorcount == MAXERRORS) {
            xerror();
        }

        while ((nbytes=inStream.read(sector))!=0) {
            if (nbytes<SECSIZE)
                sector[nbytes]=CPMEOF;
            errorcount = 0;
            while (errorcount < MAXERRORS) {
                errStream.println( "{" + blocknumber + "} ");
                putchar(SOH);   /* here is our header */
                putchar(blocknumber);   /* the block number */
                putchar(~blocknumber);  /* & its complement */
                checksum = 0;
                for (index = 0; index < SECSIZE; index++) {
                    putchar(sector[index]);
                    checksum += sector[index];
                }
                putchar(checksum);  /* tell our checksum */
                if (getchar() != ACK)
                    ++errorcount;
                else
                    break;
            }
            if (errorcount == MAXERRORS)
                xerror();
            ++blocknumber;
        }
        boolean isAck = false;
        while (!isAck) {
            putchar(EOT);
            isAck = getchar() == ACK;
        }
        errStream.println( "Transmission complete.");
        return true;
    }

    /*
     * receive a file from the remote
     */
    public boolean receive(String tfile) throws IOException, InterruptedException
    {
        char checksum, index, blocknumber, errorcount;
        byte character;
        byte[] sector = new byte[SECSIZE];
        DataOutputStream foo;

        foo = new DataOutputStream(new FileOutputStream(tfile));

        System.out.println("you have " + SLEEP + " seconds...");

        /* wait for the user or remote to get his act together */
        gotChar = false;
        new IOTimer(SLEEP, "receive from remote").start(); 

        errStream.println("Starting receive...");
        putchar(NAK);
        errorcount = 0;
        blocknumber = 1;
        rxLoop:
        do { 
            character = getchar();
            gotChar = true;
            if (character != EOT) {
                try {
                    byte not_ch;
                    if (character != SOH) {
                        errStream.println( "Not SOH");
                        if (++errorcount < MAXERRORS)
                            continue rxLoop;
                        else
                            xerror();
                    }
                    character = getchar();
                    not_ch = (byte)(~getchar());
                    errStream.println( "[" +  character + "] ");
                    if (character != not_ch) {
                        errStream.println( "Blockcounts not ~");
                        ++errorcount;
                        continue rxLoop;
                    }
                    if (character != blocknumber) {
                        errStream.println( "Wrong blocknumber");
                        ++errorcount;
                        continue rxLoop;
                    }
                    checksum = 0;
                    for (index = 0; index < SECSIZE; index++) {
                        sector[index] = getchar();
                        checksum += sector[index];
                    }
                    if (checksum != getchar()) {
                        errStream.println( "Bad checksum");
                        errorcount++;
                        continue rxLoop;
                    }
                    putchar(ACK);
                    blocknumber++;
                    try {
                        foo.write(sector);
                    } catch (IOException e) {
                        errStream.println("write failed, blocknumber " + blocknumber);
                    }
                } finally {
                if (errorcount != 0)
                    putchar(NAK);
            }
        }
        } while (character != EOT);

        foo.close();

        putchar(ACK);   /* tell the other end we accepted his EOT   */
        putchar(ACK);
        putchar(ACK);

        errStream.println("Receive Completed.");
        return true;
    }

    protected byte getchar() throws IOException {
        return (byte)inStream.read();
    }

    protected void putchar(int c) throws IOException {
        outStream.write(c);
    }

    protected void xerror()
    {
        errStream.println("too many errors...aborting");
        die(1);
    }

    protected void die(int how)
    {
        if (standalone)
            System.exit(how);
        else 
          System.out.println(("Error code " + how));
    }
} 
```

# c - 如何将 char * 转换为 BSTR？

> ID：606075
> 
> 赞同：22
> 
> 时间：2009-03-03T11:47:38.627
> 
> 标签：c, string, com, vb6, bstr

如何将 char * 从 C dll 传递到 VB

这是示例代码：

```
void Cfunc(char *buffer,int len)
{
  BSTR buf_bstr = SysAllocString((BSTR)buffer);
  VBptr.VBfunc(buf_bstr,len);
} 
```

此功能不起作用，实际上一些其他值被发送到 VB，而不是实际值。

有人可以提出解决方案吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-03-03T11:59:59.797

呼叫`MultiByteToWideChar()`，然后选择`SysAllocString()`或`SysAllocStringLen()`。

`SysFreeString()`当您不再需要 BSTR 时不要忘记打电话。

详细（`SysAllocStringLen()`变体 - 它更短更快）：

1.  调用`MultiByteToWideChar()`并传递 0 作为第五和第六个参数。它将返回与 ANSI 字符串等效的 Unicode 字符数。请记住，ANSI 字符串可以包含任何字符，而不仅仅是 ASCII，因此在给定 ANSI 字符串长度的情况下手动计算 Unicode 字符数的任何尝试可能在某些情况下有效，而在其他情况下无效。

2.  使用 为 BSTR 分配缓冲区`SysAllocStringLen()`。传递 0 作为第一个参数，Unicode 字符的数量作为第二个参数。您现在有一个正确分配但未初始化的 BSTR。它已经有尾随零的位置，并且该尾随零已正确放置。

3.  第二次调用`MultiByteToWideChar()`，这次通过那里分配的 BSTR。该函数会将字符串转换为 Unicode 并将结果复制到 BSTR。现在您有一个正确分配的 BSTR，其中包含您的 ANSI 字符串的 Unicode 等价物。

4.  将 BSTR 传递给 VB。享受。

5.  调用`SysFreeString()`以解除分配 BSTR。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-03-03T11:51:15.730

使用`_bstr_t`：

```
_bstr_t bstrt(buffer); 
```

这是[字符串转换文章的圣杯](https://msdn.microsoft.com/en-us/library/ms235631.aspx)

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2013-06-12T13:21:43.737

这是我使用[尖牙](https://stackoverflow.com/a/606122/259)答案编写的代码

```
 int wslen = MultiByteToWideChar(CP_ACP, 0, str, strlen(str), 0, 0);
    BSTR bstr = SysAllocStringLen(0, wslen);
    MultiByteToWideChar(CP_ACP, 0, str, strlen(str), bstr, wslen);
    // Use bstr here
    SysFreeString(bstr); 
```

*请注意，使用 -1 作为字符串长度会导致结果中包含空终止符*

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-03T11:58:28.957

我对 ajryan 的回答没有任何异议，但这里有一个替代方案......

SysAllocString 被定义为采用 OLECHAR * 类型的参数。你给它一个 char *. 这些不是一回事。在某些情况下，它们*可能*是同一件事，但你不能依赖它。所以首先你需要将你的 char * 转换成 OLECHAR *。有一个名为 A2OLE 的宏可以为您执行此操作，并且在 char * 和 OLECHAR * 相同的情况下，宏编译为空（我认为）。

有关A2OLE 及其朋友的详细信息，请参阅[此页面。](http://msdn.microsoft.com/en-us/library/87zae4a3.aspx)

哦，将您的 char * 转换为 BSTR 实际上并没有改变它，它既不是 BSTR 也不是 OLECHAR *。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-01-27T10:31:27.820

而不是 char* 数组，尝试 _tchar* 数组。因为 Sysallocstring 在 32 位应用程序中只接受 Unicode 字符。

# jquery - 保存元素位置和大小（JQuery ui 可调整大小和可拖动）

> ID：606080
> 
> 赞同：1
> 
> 时间：2009-03-03T11:48:30.980
> 
> 标签：jquery, size, save, position

我是 jquery 甚至 javascript 的新手。我正在尝试创建一个系统，您可以在其中通过登录并拖动和调整 div 大小来编辑非常简单的静态页面。系统工作到您可以编辑站点的地步，但问题是如何保存 div 的坐标和大小。

系统不使用 mysql，因为登录仅适用于站点作者。我还想尝试不需要 javascript 来查看页面（通过 php 从文件中获取坐标和大小）。

所以，基本上我需要一种方法来检查 div 的宽度、高度、左侧和顶部，并在作者点击保存按钮时将它们存储到文件中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T11:54:43.927

您可以将变量存储在用户机器上的 cookie 中（jQuery 没有原生 cookie 支持，但[这个插件](http://plugins.jquery.com/project/cookie)提供给您）。

但是，这需要 Javascripw，您提到您不想需要它。但是，如果您希望用户能够在页面上拖动模块，那么如果没有 js 的帮助，您将无法做到这一点。

如果您确实想在服务器端存储这些数据，那么我建议不使用数据库的方法就是将它们存储在基于文件的缓存中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T14:59:54.717

使用 PHP 序列化将数据存储在序列化数组中，并通过 JSON（JavaScript 对象表示法）中的 AJAX 将它们提供给您的 javascript。

这样你就可以做到：

```
$s_my_data = unserialize(file_get_contents($s_my_filename));
$s_my_json_data = json_encode($s_my_data); 
```

如果您通过 AJAX 阅读此内容，您将能够像访问 JavaScript 对象一样访问它，例如：

```
myObject.myProperty 
```

希望这可以帮助 ;）

# java - How do you clear the Java Console?

> ID：606086
> 
> 赞同：3
> 
> 时间：2009-03-03T11:50:32.330
> 
> 标签：java, console, java-web-start, jnlp

I have output messages displayed on the [Java console](http://java.sun.com/j2se/1.5.0/docs/guide/deployment/deployment-guide/console.html) for an application that started using webstart. Instead of the user manually clearing message, is there a way of clearing console messages in code?

These messages are printed at the rate of about 1000 per second and seem to end up using too much memory, i could have stopped the printing to console, but the requirement is to always have it.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-03T13:07:06.360

You will not be able to clear that console, unless you find some handle on the classes for that console (which I doubt you would have access to).

The requirement you have has the inevitable requirement that the user will need to go in and manually clear the console every couple of minutes. I think that justifies a rethink about why the requirement exists and wether there is another solution to solve your problem.

Have you considered a different way of logging?

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T11:58:24.327

Seems to me the requirement should be rediscussed. If this isn't an alternative then you may limit the amount of output, because a 1000 messages/s seems an awful lot to me.

I don't know if you even can programmatically clear the console.

# c# - SignedXml.CheckSignature 在 .NET 1.1 中有效，但在 .NET 3.5 中失败

> ID：606091
> 
> 赞同：1
> 
> 时间：2009-03-03T11:52:03.793
> 
> 标签：c#, .net, encryption

我有以下 SignedXml 代码。此代码在 .NET 1.1 中完美运行，但是当我在 .NET 3.5 中运行此代码时，该方法`signedXml.CheckSignature()`一直返回 false。 **关于`SignedXml`课程，.Net 1.1 和 3.5 之间有什么变化吗？**我在这里很困惑！你们能帮我吗？

```
 SignedXml signedXml = new SignedXml();

        // Get public key
        Assembly assembly = Assembly.LoadFile("MyLib.Application.dll");
        Stream keyStream =
            assembly.GetManifestResourceStream("MyKey.xml");
        StreamReader keyReader = new StreamReader(keyStream, Encoding.UTF8);
        string publicKeyXml = keyReader.ReadToEnd();
        keyReader.Close();

        // Load and set key
        DSA dsaKeyPair = DSA.Create();
        dsaKeyPair.FromXmlString(publicKeyXml);
        KeyInfo keyInfo = new KeyInfo();
        keyInfo.AddClause(new DSAKeyValue(dsaKeyPair));
        signedXml.KeyInfo = keyInfo;

        // Load and set data
        XmlDocument xmlDocument = new XmlDocument();
        xmlDocument.PreserveWhitespace = true;
        xmlDocument.LoadXml(signedXmlData);

        XmlNodeList nodeList = xmlDocument.GetElementsByTagName("Signature");
        signedXml.LoadXml((XmlElement)nodeList[0]);

        string returnXml = null;
        if (signedXml.CheckSignature())
        {
            XmlElement dataElement = signedXml.GetIdElement(xmlDocument, "LicenseElement");
            returnXml = dataElement.InnerXml;
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-02-24T23:33:55.210

我发现signedXml.KeyInfo = keyInfo; 对我来说是个问题。当我使用密钥作为 CheckSignature() 的参数时，它起作用了——我能够在 2.0 应用程序中加载 1.1 签名的 xml。

只需完全删除 KeyInfo ：

```
 string returnXml = null;
    if (signedXml.CheckSignature(dsaKeyPair))
    {
        XmlElement dataElement = signedXml.GetIdElement(xmlDocument, "LicenseElement");
        returnXml = dataElement.InnerXml;
    } 
```

# .net - .net 代码生成解决方案：如何编写更少的代码？

> ID：606093
> 
> 赞同：1
> 
> 时间：2009-03-03T11:53:36.240
> 
> 标签：.net, code-generation

有哪些解决方案可以避免编写重复代码？例如代码生成器等。

更具体地说，用于在我的应用程序的多个层之间转换对象（从一个服务到另一个，从服务到客户端（ObservableCollections 等））。

当然，也欢迎更通用的解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T11:59:09.207

VS 包括许多工具。

包含：

*   班级设计师
*   LINQ 到 SQL
*   实体框架。

但在您的情况下，您可能想看看[T4 模板](http://msdn.microsoft.com/en-us/library/bb126445.aspx)可以做什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T12:00:40.200

这是我自己的工具[Gauntlet](http://gauntlet.codeplex.com)的无耻插件。它与 T4 的主要区别在于它可以在 Visual Studio 内部或外部工作（即从普通的旧 MSBuild 运行）。

# .net - 是否有框架属性可以在.Net 中隐藏成员以防止反射？

> ID：606095
> 
> 赞同：3
> 
> 时间：2009-03-03T11:54:09.297
> 
> 标签：.net, reflection

`typeof(MyType).GetProperties()`.net 中是否有隐藏成员（特别是属性）的属性？

我正在寻找快速解决方案 - 即不创建自定义属性等。

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-03T11:56:56.950

不。

反射允许人们查看所有内容，包括标记为私有的成员。

（最终，反射使用与 CLR （包括 JIT）相同的元数据。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T12:01:31.540

GetProperties 的特定重载（不带参数）仅返回公共属性。因此，您可以将该属性标记为私有/内部。否则，我同意上面的理查德。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T12:24:08.677

查看 PropertyDescriptor 而不是 PropertyInfo。

这些可以通过覆盖 TypeConverter 派生类中的 2 个 Properties 方法来提供。

只要有一点独创性，你几乎可以让它做任何事情。

我目前使用它来提供用于翻译目的的各种文化和值的平面属性列表，并将其提供给 PropertyGrid，而类结构如下所示：

```
class TagName
{
  Culture culture;
  string content;
}

[TypeConverter(typeof(TagConverter))]
class Tag
{
  TagName[] tagNames;
} 
```

在 PropertyDescriptor 中，您可以完全控制如何通过特定的 PropertyDescriptor 实例设置和获取值。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-03-03T11:58:49.817

如果有可能，Microsoft 将是第一个为 .NET 程序集自己做这件事的人 :)。

# iphone - 为 iphone HTTP API 添加自定义证书

> ID：606098
> 
> 赞同：3
> 
> 时间：2009-03-03T11:55:47.060
> 
> 标签：iphone, objective-c, cocoa, https

有没有办法在我的应用程序中捆绑证书 - 然后使用它来执行 HTTP GET/POST 使用`NSURLRequest`？

即证书不应该用于设备上的其他 HTTP 流量，只能由我的应用程序使用。

干杯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-11T17:57:24.620

我不这么认为，但由于所有应用程序都是沙盒化的，因此您在应用程序中可能拥有的任何特殊身份验证措施都无法被其他应用程序访问。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-06T14:25:34.117

最好（在我看来）您将要使用的私钥和证书放在钥匙串（或共享相同配置证书的其他第 3 方应用程序的钥匙串）上。

至于 p12 的实际加载，我们确实使用 openssl（我们确实围绕它编写了一个 obj-c 包装器）来解码我们发送到应用程序的 .p12（您始终可以使用 .DER 或 .PEM 来发送 p12你的应用程序）

# php - PHP 中的 mysqli 类是否 100% 防止 sql 注入？

> ID：606099
> 
> 赞同：5
> 
> 时间：2009-03-03T11:55:51.087
> 
> 标签：php, mysql, mysqli, sql-injection

我看过很多关于 mysqli 的文章和问题，他们都声称它可以防止 sql 注入。但它是万无一失的，还是有办法绕过它。我对跨站点脚本或网络钓鱼攻击不感兴趣，只对 sql 注入感兴趣。

我应该首先说的是我正在使用准备好的语句。这就是我对mysqli的意思。如果我使用没有任何字符串连接的准备好的语句，那么它是万无一失的吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-03T12:01:50.150

> 但它是万无一失的，还是有办法绕过它。

不，你必须知道你在做什么。如果你使用绑定参数（MySqli 自带的一个特性），你完全可以免受*来自这个攻击向量*的注入类型攻击。这不会阻止您（程序员）直接嵌入字符串，从而启用注入攻击。您必须按预期使用该功能。

### 回复：编辑

> 我应该首先说的是我正在使用准备好的语句。这就是我对mysqli的意思。如果我使用没有任何字符串连接的准备好的语句，那么它是万无一失的吗？

万无一失仍然是一个危险的词。但是对于通过准备好的语句绑定的变量，您可以免受注入攻击。这是因为绑定参数与 SQL 查询分开传输。使用“传统”嵌入字符串方法，数据库服务器需要解析输入，并且其中有很多边缘情况（字符集等）。当数据和查询分开发送时，不会进行实际的解析（至少不会解析变量数据）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T12:00:15.943

它并没有比旧的 mysql 模块更好地防止 sql 注入，只是让开发人员更容易做到这一点，他们现在可以使用准备好的语句而不是调用 mysql_real_escape_string。

# c# - 如何创建 LINQ 表达式树以选择匿名类型

> ID：606104
> 
> 赞同：48
> 
> 时间：2009-03-03T11:57:22.440
> 
> 标签：c#, linq, entity-framework, linq-to-entities, expression-trees

我想使用表达式树动态生成以下选择语句：

```
var v = from c in Countries
        where c.City == "London"
        select new {c.Name, c.Population}; 
```

我已经弄清楚如何生成

```
var v = from c in Countries
        where c.City == "London"
        select new {c.Name}; 
```

但我似乎找不到可以让我在我的选择 lambda 中指定多个属性的构造函数/重载。

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2009-04-06T20:12:27.093

如前所述，这可以在 Reflection Emit 和我在下面包含的辅助类的帮助下完成。下面的代码是一个正在进行的工作，所以把它当作它的价值......'它适用于我的盒子'。SelectDynamic 方法类应该扔在一个静态扩展方法类中。

正如预期的那样，您不会获得任何 Intellisense，因为直到运行时才创建类型。适用于后期绑定数据控件。

```
public static IQueryable SelectDynamic(this IQueryable source, IEnumerable<string> fieldNames)
{
    Dictionary<string, PropertyInfo> sourceProperties = fieldNames.ToDictionary(name => name, name => source.ElementType.GetProperty(name));
    Type dynamicType = LinqRuntimeTypeBuilder.GetDynamicType(sourceProperties.Values);

    ParameterExpression sourceItem = Expression.Parameter(source.ElementType, "t");
    IEnumerable<MemberBinding> bindings = dynamicType.GetFields().Select(p => Expression.Bind(p, Expression.Property(sourceItem, sourceProperties[p.Name]))).OfType<MemberBinding>();

    Expression selector = Expression.Lambda(Expression.MemberInit(
        Expression.New(dynamicType.GetConstructor(Type.EmptyTypes)), bindings), sourceItem);

    return source.Provider.CreateQuery(Expression.Call(typeof(Queryable), "Select", new Type[] { source.ElementType, dynamicType },
                 Expression.Constant(source), selector));
}

public static class LinqRuntimeTypeBuilder
{
    private static readonly ILog log = LogManager.GetLogger(System.Reflection.MethodBase.GetCurrentMethod().DeclaringType);
    private static AssemblyName assemblyName = new AssemblyName() { Name = "DynamicLinqTypes" };
    private static ModuleBuilder moduleBuilder = null;
    private static Dictionary<string, Type> builtTypes = new Dictionary<string, Type>();

    static LinqRuntimeTypeBuilder()
    {
        moduleBuilder = Thread.GetDomain().DefineDynamicAssembly(assemblyName, AssemblyBuilderAccess.Run).DefineDynamicModule(assemblyName.Name);
    }

    private static string GetTypeKey(Dictionary<string, Type> fields)
    {
        //TODO: optimize the type caching -- if fields are simply reordered, that doesn't mean that they're actually different types, so this needs to be smarter
        string key = string.Empty;
        foreach (var field in fields)
            key += field.Key + ";" + field.Value.Name + ";";

        return key;
    }

    public static Type GetDynamicType(Dictionary<string, Type> fields)
    {
        if (null == fields)
            throw new ArgumentNullException("fields");
        if (0 == fields.Count)
            throw new ArgumentOutOfRangeException("fields", "fields must have at least 1 field definition");

        try
        {
            Monitor.Enter(builtTypes);
            string className = GetTypeKey(fields);

            if (builtTypes.ContainsKey(className))
                return builtTypes[className];

            TypeBuilder typeBuilder = moduleBuilder.DefineType(className, TypeAttributes.Public | TypeAttributes.Class | TypeAttributes.Serializable);

            foreach (var field in fields)                    
                typeBuilder.DefineField(field.Key, field.Value, FieldAttributes.Public);

            builtTypes[className] = typeBuilder.CreateType();

            return builtTypes[className];
        }
        catch (Exception ex)
        {
            log.Error(ex);
        }
        finally
        {
            Monitor.Exit(builtTypes);
        }

        return null;
    }

    private static string GetTypeKey(IEnumerable<PropertyInfo> fields)
    {
        return GetTypeKey(fields.ToDictionary(f => f.Name, f => f.PropertyType));
    }

    public static Type GetDynamicType(IEnumerable<PropertyInfo> fields)
    {
        return GetDynamicType(fields.ToDictionary(f => f.Name, f => f.PropertyType));
    }
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2015-01-25T19:12:32.553

接受的答案非常有用，但我需要一些更接近真正匿名类型的东西。

真正的匿名类型具有只读属性、用于填充所有值的构造函数、用于比较每个属性值的 Equals/GetHashCode 实现以及包含每个属性的名称/值的 ToString 实现。（有关匿名类型的完整描述，请参阅[https://msdn.microsoft.com/en-us/library/bb397696.aspx](https://msdn.microsoft.com/en-us/library/bb397696.aspx)。）

基于匿名类的定义，我在 github 上的[https://github.com/dotlattice/LatticeUtils/blob/master/LatticeUtils/AnonymousTypeUtils.cs](https://github.com/dotlattice/LatticeUtils/blob/master/LatticeUtils/AnonymousTypeUtils.cs)放置了一个生成动态匿名类型的类。该项目还包含一些单元测试，以确保假匿名类型的行为与真实匿名类型一样。

这是如何使用它的一个非常基本的示例：

```
AnonymousTypeUtils.CreateObject(new Dictionary<string, object>
{
    { "a", 1 },
    { "b", 2 }
}); 
```

另外，另一个注意事项：我发现在实体框架中使用动态匿名类型时，必须使用“members”参数集调用构造函数。例如：

```
Expression.New(
    constructor: anonymousType.GetConstructors().Single(), 
    arguments: propertyExpressions,
    members: anonymousType.GetProperties().Cast<MemberInfo>().ToArray()
); 
```

如果您使用不包含“members”参数的 Expression.New 版本之一，Entity Framework 不会将其识别为匿名类型的构造函数。所以我假设这意味着一个真正的匿名类型的构造函数表达式将包含“成员”信息。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2017-07-20T04:45:04.990

也许有点晚，但可能对某人有所帮助。

`DynamicSelectGenerator`您可以通过调用从实体中选择来生成动态选择。

```
public static Func<T, T> DynamicSelectGenerator<T>()
            {
                // get Properties of the T
                var fields = typeof(T).GetProperties().Select(propertyInfo => propertyInfo.Name).ToArray();

            // input parameter "o"
            var xParameter = Expression.Parameter(typeof(T), "o");

            // new statement "new Data()"
            var xNew = Expression.New(typeof(T));

            // create initializers
            var bindings = fields.Select(o => o.Trim())
                .Select(o =>
                {

                    // property "Field1"
                    var mi = typeof(T).GetProperty(o);

                    // original value "o.Field1"
                    var xOriginal = Expression.Property(xParameter, mi);

                    // set value "Field1 = o.Field1"
                    return Expression.Bind(mi, xOriginal);
                }
            );

            // initialization "new Data { Field1 = o.Field1, Field2 = o.Field2 }"
            var xInit = Expression.MemberInit(xNew, bindings);

            // expression "o => new Data { Field1 = o.Field1, Field2 = o.Field2 }"
            var lambda = Expression.Lambda<Func<T, T>>(xInit, xParameter);

            // compile to Func<Data, Data>
            return lambda.Compile();
        } 
```

并通过此代码使用：

```
var result = dbContextInstancs.EntityClass.Select(DynamicSelectGenerator<EntityClass>()); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-03T12:25:07.943

我不相信你能做到这一点。虽然当你这样做`select new { c.Name, c.Population }`时，看起来你并没有创建一个你实际上是的类。如果您查看 Reflector 或原始 IL 中的编译输出，您将能够看到这一点。

你会有一个看起来像这样的类：

```
[CompilerGenerated]
private class <>c__Class {
  public string Name { get; set; }
  public int Population { get; set; }
} 
```

（好吧，我清理了一下，因为属性实际上只是一个`get_Name()`和`set_Name(name)`方法集）

您正在尝试做的是正确的动态类创建，直到 .NET 4.0 出现才可用（即使那样我也不确定它是否能够实现您想要的）。

您最好的解决方案是定义不同的*匿名*类，然后进行某种逻辑检查以确定要创建哪个类，并创建它您可以使用 object `System.Linq.Expressions.NewExpression`。

但是，如果您对底层 LINQ 提供程序非常了解，它可能（至少在理论上）是可能的。如果您**正在**编写自己的 LINQ 提供程序，则可以检测当前解析的表达式是否为 Select，然后确定`CompilerGenerated`类，反映其构造函数并创建。

绝对不是一项简单的任务，但它是 LINQ to SQL、LINQ to XML 等如何做到的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-07-04T10:34:49.823

您可以在此处使用 IQueryable-Extensions，这是“Ethan J. Brown”描述的解决方案的实现：

[https://github.com/thiscode/DynamicSelectExtensions](https://github.com/thiscode/DynamicSelectExtensions)

扩展动态构建匿名类型。

然后你可以这样做：

```
var YourDynamicListOfFields = new List<string>(

    "field1",
    "field2",
    [...]

)
var query = query.SelectPartially(YourDynamicListOfFields); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-03T12:32:18.020

您可以使用参数类而不是使用匿名类型。在您的示例中，您可以像这样创建一个参数类：

```
public struct ParamClass {
    public string Name { get; set; };
    public int Population { get; set; };
} 
```

…然后像这样将其放入您的选择中：

```
var v = from c in Countries
        where c.City == "London"
        select new ParamClass {c.Name, c.Population}; 
```

你得到的是那种类型的东西`IQueryable<ParamClass>`。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-03T12:53:07.220

这编译，我不知道它是否有效......

```
myEnumerable.Select((p) => { return new { Name = p.Name, Description = p.Description }; }); 
```

假设 p 是您的转换，并且 select 语句使用 lambda 的函数声明返回匿名类型。

编辑：我也不知道你将如何动态生成它。但至少它向您展示了如何使用 select lambda 返回具有多个值的匿名类型

编辑2：

您还必须记住，c# 编译器实际上会生成匿名类型的静态类。所以匿名类型在编译后确实有一个类型。因此，如果您在运行时生成这些查询（我假设您是），您可能必须使用各种反射方法构造一个类型（我相信您可以使用它们来动态创建类型）将创建的类型加载到执行上下文中并在生成的输出中使用它们。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-04T13:40:40.593

我认为大多数事情都已经得到解答——正如 Slace 所说，您需要一些可以从该`Select`方法返回的类。一旦你有了这个类，你就可以使用该`System.Linq.Expressions.NewExpression`方法来创建表达式。

如果你真的想这样做，你也可以在运行时生成类。这需要更多的工作，因为它不能使用 LINQ 表达式树来完成，但它是可能的。你可以使用`System.Reflection.Emit`命名空间来做到这一点——我刚刚做了一个快速搜索，这里有一篇文章解释了这一点：

*   [使用 Reflection.Emit 创建动态类型简介](http://www.codeproject.com/KB/dotnet/Creating_Dynamic_Types.aspx)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-03T12:23:56.400

您可以使用动态表达式 API，它允许您像这样动态构建您的选择语句：

```
 Select("new(<property1>,<property2>,...)"); 
```

您需要 LINQ 中的 Dynamics.cs 文件和 Visual Studio 的语言示例才能正常工作，两者都链接在[此页面](http://weblogs.asp.net/rajbk/archive/2007/09/18/dynamic-string-based-queries-in-linq.aspx)的底部。您还可以在同一 URL 上看到一个显示此操作的工作示例。

# flash - 使用 colorTransformer 制作颜色淡出效果

> ID：606106
> 
> 赞同：0
> 
> 时间：2009-03-03T11:57:49.630
> 
> 标签：flash, actionscript-3

是否有一个很好的示例如何制作颜色“淡出”演示效果，如下所示：

```
colorTransformer.redMultiplier = colorTransformer.redMultiplier -.2 ;
colorTransformer.greenMultiplier = colorTransformer.greenMultiplier -.2 ;
colorTransformer.blueMultiplier = colorTransformer.blueMultiplier  -.2 ; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-05T01:15:15.150

我同意丹尼尔的观点：gtween、tweener 和所有其他人都*轻松地*完成了这项工作。

如果你想定制它，你可以很好地使用 getter 和 setter（这通常用于更复杂的情况，但可能很有趣）：

```
private var _brightness:Number = 1;

public function set brightness(value:Number):void
{
    _brightness = value
    this.colorTransform = new ColorTransform(value,value,value);
}

public function get brightness():Number
{
    return _brightness;
} 
```

**例子 ：**

简单的 ：

`brightness = 0;`

随机线性：

`brightness -= Math.random() * .02;`

互动和轻松：

`brightness += ((stage.mouseY / stage.stageHeight)-brightness) * .9;`

等等

# javascript - Javascript 打印屏幕

> ID：606108
> 
> 赞同：1
> 
> 时间：2009-03-03T11:58:15.013
> 
> 标签：javascript

来自客户端的 Javascript。

那是javascript中的window.clipBoard，我得到了一些文档，其中复制到剪贴板的文本被获取并显示。

我希望通过 Web 应用程序实现“PrintScreen”功能。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-03T12:14:12.040

经过快速的谷歌搜索检查，不，你不能用 javascript 截图。您将需要使用不同的语言，如果您想放入网页，则会提示用户提供额外的权限。此外，window.clipBoardData 仅适用于 ie。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T12:14:34.380

`window.print()` ??

# c# - C#中结构数组的最小值

> ID：606109
> 
> 赞同：0
> 
> 时间：2009-03-03T11:58:20.817
> 
> 标签：c#

我使用 Select() 对结构数组的每个成员执行计算，现在希望拥有某个属性最小的成员。我想在选定的序列上使用像 Min() 这样的东西，但我不知道如何返回完整的结构，而不仅仅是最小的属性。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-03T12:20:45.520

如何按您的“价值”排序并获取第一个条目（最小值）：

```
Persons.OrderBy(p => p.Age).FirstOrDefault(); 
```

那当然是如果你只想要**一个**项目（这就是你所说的）。

或者：

```
from p in Persons
where p.Age == Persons.Select(p1 => p1.Age).Min()
select p; 
```

将为您提供所有价值最低的物品。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T12:12:56.990

听起来您想[`MinBy`](http://code.google.com/p/morelinq/source/browse/trunk/MoreLinq/Pull/Aggregation.cs)从[MoreLINQ](http://code.google.com/p/morelinq/)使用：

```
public static TSource MinBy<TSource, TKey>(this IEnumerable<TSource> source,
    Func<TSource, TKey> selector, IComparer<TKey> comparer)
{
    source.ThrowIfNull("source");
    selector.ThrowIfNull("selector");
    comparer.ThrowIfNull("comparer");
    using (IEnumerator<TSource> sourceIterator = source.GetEnumerator())
    {
        if (!sourceIterator.MoveNext())
        {
            throw new InvalidOperationException("Sequence was empty");
        }
        TSource min = sourceIterator.Current;
        TKey minKey = selector(min);
        while (sourceIterator.MoveNext())
        {
            TSource candidate = sourceIterator.Current;
            TKey candidateProjected = selector(candidate);
            if (comparer.Compare(candidateProjected, minKey) < 0)
            {
                min = candidate;
                minKey = candidateProjected;
            }
        }
        return min;
    }
} 
```

`ThrowIfNull`被定义为扩展方法：

```
internal static void ThrowIfNull<T>(this T argument, string name)
    where T : class
{
    if (argument == null)
    {
        throw new ArgumentNullException(name);
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T12:10:29.677

如果我理解正确，我会说：使用代表......

这是[克雷格墨菲的一个例子](http://www.c-sharpcorner.com/UploadFile/camurphy/csharpLists03302006170209PM/csharpLists.aspx)

```
public class Person
{
          public int age;
          public string name;
          public Person(int age, string name)
          {
                   this.age = age;
                   this.name = name;
          }
}
// everyone under 25:
List<person> young = people.FindAll(delegate(Person p) { return p.age < 25; });

// sort your list: 
people.Sort(delegate(Person p1, Person p2)
   { return p1.age.CompareTo(p2.age); }); 
```

# wpf - 让非 UI 对象响应 WPF 命令绑定

> ID：606115
> 
> 赞同：2
> 
> 时间：2009-03-03T11:58:57.023
> 
> 标签：wpf, command

我有一个 ViewModel 类，我想响应从按钮触发的内置 Refresh 命令，但我不确定如何声明 CommandTarget。

简而言之，我的代码如下

ViewModel 构造函数以及 CanExecute 和 Executed 事件处理程序 -

```
 public ViewModel()
    {
        CommandBinding binding = new CommandBinding(NavigationCommands.Refresh, CommandHandler);
        binding.CanExecute += new CanExecuteRoutedEventHandler(binding_CanExecute);
        binding.Executed += new ExecutedRoutedEventHandler(binding_Executed);
        CommandManager.RegisterClassCommandBinding(typeof(ViewModel), binding);
    }
    void binding_Executed(object sender, ExecutedRoutedEventArgs e)
    {
        Debug.Print("Refreshing...");
    }

    void binding_CanExecute(object sender, CanExecuteRoutedEventArgs e)
    {
        e.CanExecute = true;
    } 
```

标记是 -

```
<Button Command="Refresh">refresh</Button> 
```

现在，我尝试将此按钮上的 CommandTarget 设置为，`{Binding Source={StaticResource ViewModel}}`但我得到一个运行时说`Cannot convert the value in attribute 'CommandTarget' to object of type 'System.Windows.IInputElement'`.

我是命令新手，所以我完全有可能在这里错了。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-03T12:04:19.567

`RoutedCommand`s 和 MVVM 不能混用。`RoutedCommand`s 绑定到可视化树并依赖于 WPF 的`CommandBindings`集合。您应该实现自己的`ICommand`与 MVVM 模式一起使用的类。看看[Prism 的](http://prism.codeplex.com)初学者实现。

在我自己的 MVVM 项目中，我有几个命令实现：

*   `DelegateCommand`. 调用提供的委托来确定命令是否可以执行，并执行命令。
*   `ActiveAwareCommand`. 与接口 ( `IActiveAware`) 结合使用，并将命令执行发送到当前活动的项目。多个活动感知实现向命令注册自己，命令自动路由`CanExecute`/`Execute`调用当前活动项。

# sql - 将包含 top、count、group 和 order 的 SQL 转换为 LINQ（2 个实体）

> ID：606124
> 
> 赞同：5
> 
> 时间：2009-03-03T12:00:09.563
> 
> 标签：sql, linq

一些 LINQ 查询仍然让我感到困惑。

对于包含两列“页面”和“日期”的表“命中”，我想在定义的时间段内找到最多行的页面。

在 SQL 中我会使用这个：

```
SELECT TOP 10
      [Page]
      ,COUNT([Page]) as Number
FROM dbo.[Hits]
WHERE [Date] >= CONVERT(datetime,'14 Jan 2009')
AND [Date] < CONVERT(datetime,'15 Jan 2009')
Group BY [Page]
Order by Number DESC 
```

在 LINQ 中我不知道如何处理这个问题，任何人都可以在这里帮助我吗？我尝试使用 linqer 对其进行转换，但它只显示此表达式的错误。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-03T12:11:50.097

像这样的东西应该工作：

```
(from p in DataContext.Hits
where (p.Date >= minDate) && (p.Date < maxDate)
group p by p.Page into g
select new { Page = g.Key, Number = g.Count() }).OrderByDescending(x => x.Number).Take(10); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-03T13:11:22.857

```
var top10hits = objectContext.Hits
  .Where(h => minDate <= h.Date && h.Date < maxDate)
  .GroupBy(h => h.Page)
  .Select(g => new { Page = g.Key, Number = g.Count() })
  .OrderByDescending(x => x.Number)
  .Take(10); 
```

# oop - “依赖倒置”和“设计到接口”的原则是一样的吗？

> ID：606126
> 
> 赞同：7
> 
> 时间：2009-03-03T12:00:23.180
> 
> 标签：oop, dependency-inversion

“依赖倒置原则”（DIP）和“接口设计原则”表达了相同的原则吗？如果不是，会有什么区别？

**编辑**

为了澄清和缩小上下文：接口是指编程接口，如 Java`interface`或 C++ 中的纯抽象基类。不涉及其他“合同”。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-03-03T14:16:57.613

[我只是想在另一个与这个问题非常相似的问题](https://stackoverflow.com/questions/62539/what-is-the-dependency-inversion-principle-and-why-is-it-important)上加入并引用 Derek Greer ，因为在我看来，它确实很好地回答了这个问题。

> ‌<em>“依赖倒置原则没有提到的是通过使用接口（例如`MyService → [ILogger ⇐ Logger]`）抽象依赖关系的简单实践。”

虽然这将组件与依赖项的特定实现细节分离，但它并没有颠倒消费者和依赖项之间的关系（例如`[MyService → IMyServiceLogger] ⇐ Logger`）。”

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-14T23:14:08.537

依赖倒置确保您的更高级别的模块不依赖于较低级别的模块。因此，您的应用程序逻辑不依赖于您的业务模型或业务逻辑。有明确的关注点分离。

该原则表明您的应用程序定义并拥有您的业务层必须实现的接口。这样，您的业务层取决于您的应用程序定义的接口。因此依赖关系是倒置的。

扩展这一点，如果您现在拥有三个应用程序，每个应用程序都有自己的接口，由业务层实现，您的业务层可以更改，只要它们按照它们必须的方式实现接口，那么您的应用程序就不会更明智。

可以在我的网站上找到这个原理的一个很好的 Java 示例以及如何构建这样的项目：http: [//www.jeenisoftware.com/maven-dip-principle-example/](http://www.jeenisoftware.com/maven-dip-principle-example/)

依赖倒置与其说是关于接口的设计，尽管这就是正在发生的事情，但更多的是关于实现服务。换句话说，一种面向服务的设计模式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T12:15:44.610

[接口设计（作为契约设计](http://en.wikipedia.org/wiki/Design_by_contract)的变体）支持依赖倒置。两者都减少了耦合。然而：

*   接口设计和 DBC 没有说明对象是如何创建的（例如 DIP、[抽象工厂](http://en.wikipedia.org/wiki/Abstract_factory_pattern)、[工厂方法](http://en.wikipedia.org/wiki/Factory_method_pattern)）。
*   依赖倒置[（dependency injection](https://stackoverflow.com/questions/130794/what-is-dependency-injection)）一般依赖于接口，但侧重于对象生命周期而不是类设计。如果您愿意，可以将 DIP 与抽象基类一起使用，因此您并不真正致力于纯接口。

这些方法往往相互补充。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-03-03T12:08:00.403

“契约式设计”和“依赖注入”密切相关，但抽象层次不同。“按合同设计”是一个非常普遍的设计原则，可以通过各种技术来支持；在具有类 Java 类系统的语言中，一种技术是使用接口来避免具体的类依赖关系。“依赖注入”是另一种技术，它通常依赖于接口的存在来运行（但不必总是这样做——这取决于语言）。我想说“依赖注入”支持“按合同设计”的原则。

# c++ - 使用运算符重载 C++ 进行监控

> ID：606135
> 
> 赞同：4
> 
> 时间：2009-03-03T12:02:17.497
> 
> 标签：c++, operator-overloading

我想编写一个所有运算符重载的包装类，以便我可以检测我们何时写入/读取或修改其内容。例如：

```
probe<int> x;
x = 5;     // write
if(x) {    // read
   x += 7; // modify
} 
```

有人已经这样做了吗？如果不是，我必须重载哪些运算符以确保我不会错过任何内容？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T12:08:50.417

将此作为一个常见的想法。有很多像 &= |= [] 这样的运算符在您的情况下可能不是主要的。

```
template < typename T >
struct monitor
{
    monitor( const T& data ):
        data_( data )
    {
        id_ = get_next_monitor_id(); 
    }

    monitor( const monitor& m )
    {
       id_ = get_next_monitor_id();

       m.notify_read();
       notify_write();

       data_ = m.data_;
    }

    operator T()
    {
        notify_read();
        return data_;    
    }

    monitor& operator = ( const monitor& m )
    {
        m.notify_read();
        notify_write();

        data_ = m.data_;
        return *this;
    }

    monitor& operator += ( const monitor& m )
    {
        m.notify_read();
        notify_write();

        data_ += m.data_;
        return *this;
    }
/*
    operator *=
    operator /=
    operator ++ ();
    operator ++ (int);
    operator -- ();
    operator -- (int);
*/
private:
    int id_;
    T data_;

    void notify_read()
    {
        std::cout << "object " << id_ << " was read" << std::endl;
    }

    void notify_write()
    {
        std::cout << "object " << id_ << " was written" << std::endl;
    }
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T12:20:07.657

你不能，我想。operator?: 不可重载。此外，如果`T::T(int)`已定义，`T foo = 4`则合法但`T foo = probe<int>(4)`不合法。最多有一个用户定义的转换。

此外，由于探针不是 POD，因此程序的行为可能会发生变化。

# unit-testing - 测试内部类

> ID：606137
> 
> 赞同：5
> 
> 时间：2009-03-03T12:03:48.337
> 
> 标签：unit-testing, tdd, rhino

如何将单元测试写入内部类？？？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-03T12:10:22.893

您编写指定顶级类的外部接口行为的测试。该类是否使用内部类来实现该行为，是该类的实现细节，测试不需要了解它的任何信息。

如果内部类无法通过顶级类的接口进行充分测试，那么通常最好将内部类移出并直接作为新的顶级类进行测试。想要测试内部类是一种代码味道，内部类可能足够重要，可以成为顶级类。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-03T12:19:58.157

不是我推荐它，但您也可以使用[InternalsVisibleToAttribute](http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.internalsvisibletoattribute.aspx)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-03T12:10:26.417

使用 MS Visual Studio 进行单元测试时，您只需创建一个[私有 Accessor](http://msdn.microsoft.com/en-us/library/ms182523.aspx)。在内部，它与我认为的反射一起工作。只需看一下生成的代码。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-03T12:15:07.653

你不直接测试它。它将通过定义它的类进行测试。

而且，如果您应用 TDD，正如这个问题标签当前所暗示的那样，您刚刚编写的调用内部类的测试是什么？我的意思是它不能是标准课程，由您正在研究的课程私有吗？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-03T12:15:08.700

我们使用了一个辅助类，它使用反射来加载和调用内部类的方法。也可以在编译时使用 DEBUG 符号更改可访问性，例如

```
#if DEBUG
public
#else
internal
#endif
    class MyInternalClass
{
    ...
} 
```

然而，Esko Luontola 的回答更正确，因为它是最重要的功能或业务需求。很容易过于关注代码覆盖率而不是测试重要的风险区域。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-06-30T00:47:39.060

[请参阅http://msdn.microsoft.com/en-us/library/bb385974.aspx](http://msdn.microsoft.com/en-us/library/bb385974.aspx)中的详细说明

# c++ - 与 VS2008 捆绑在一起的 C++ ARM 编译器是否可再发行？

> ID：606138
> 
> 赞同：0
> 
> 时间：2009-03-03T12:04:02.003
> 
> 标签：c++, windows-ce

针对 WinCE 操作系统的 VS2008 C++ ARM 编译器是否可再发行？或者微软是否提供单独的可再发行包（SDK？）？我正在为 WinCE 寻找一个 C++ ARM 编译器（实际上是一个完整的构建环境），我可以将它与我的应用程序一起免费分发。我在这里有什么选择？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T12:13:08.220

如果是这样，我会很惊讶，您的用例相当罕见。我也不记得在 redist.txt 文件中看到过它们。

我的第一直觉是 GCC，因为它可以针对 ARM，并且在 GPL 下也可以再分发。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T18:25:30.323

Microsoft 的[eMbedded Visual C++ 4.0](http://www.microsoft.com/downloads/details.aspx?FamilyId=1DACDB3D-50D1-41B2-A107-FA75AE960856&displaylang=en)专门针对 WinCE，可以免费下载。我不确定是否要重新分配它。而且也变老了。

# java - JibX：如何将特定类中的字段输出到 XML 的不同部分

> ID：606145
> 
> 赞同：2
> 
> 时间：2009-03-03T12:05:34.480
> 
> 标签：java, xml, data-binding

当像这样使用继承进行映射时，我已经设法得到了我想要的东西：

这个类不应该存在

*   自由流消息
*   错误信息

BaseForm**扩展**ThisClassShouldntExist

*   功能
*   子函数

SpecificForm**扩展**BaseForm

*   地址

**我的绑定.xml：**

```
<binding>
    <mapping class="com.struts.form.ThisClassShouldntExist" abstract="true">
        <value name="free-flow-message" field="freeFlowMessage" />
        <value name="error-msg" field="errorMessage" />
    </mapping>  

    <mapping class="com.struts.form.BaseForm" abstract="true">
        <value name="prog-name" field="function" />
        <value name="sub-prog-name" field="subFunction" />
    </mapping>

    <mapping name="cngaddress" class="com.struts.form.AddressDisplayForm">
        <structure name="header">
            <structure map-as="com.struts.form.BaseForm" usage="optional" />
        </structure>

        <value name="address" field="addressline1" usage="optional"/>

        <structure name="FOOTER">
            <structure map-as="com.struts.form.ThisClassShouldntExist" 
                               usage="optional" />
        </structure>
    </mapping>  
</binding> 
```

**样本数据：**

```
<?xml version="1.0" encoding="UTF-8"?>
<cngaddress>
  <header>
    <prog-name>prog-name</prog-name>
    <sub-prog-name>sub-prog-name</sub-prog-name>
  </header>
  <address>address</address>
  <FOOTER>
    <free-flow-message>free-flow-message</free-flow-message>
    <error-msg>error-msg</error-msg>
  </FOOTER>
</cngaddress> 
```

* * *

**因此，底线是我需要将 BaseForm 类的输出“拆分”为 XML 输出的 2 个不同部分。第一部分进入`<header>`，第二部分进入`<footer>`，但我也想避免继承只是为了遵守 JibX。**

我尝试做这样的事情但没有奏效：

```
<structure name="FOOTER">
    <structure field="aFieldFromSuperClassBaseForm" 
               map-as="com.struts.form.ThisClassShouldntExist" 
               usage="optional" />
</structure> 
```

还尝试`<mapping>`在同一个绑定中为同一个类定义 2，但它当然行不通。

# clearcase - ClearCase：如何恢复到较早的基线？

> ID：606149
> 
> 赞同：5
> 
> 时间：2009-03-03T12:08:34.037
> 
> 标签：clearcase

如何恢复到较早的基线？我们有一个 UCM 并行开发（多流）项目。每个开发人员都有一个关于项目集成流的快照视图。开发人员希望在他们的快照视图中看到应用程序的早期版本，以便他们可以调试早期版本的应用程序以查找错误。

当我想更改现有快照视图的基础基线时，clearcase 不允许我这样做。那么我该怎么做呢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-03T14:02:22.700

由于您使用术语基线，我假设您使用的是 UCM。

在流上，您不能向后还原基线。

一种可能性是制作一个并行流，以所需的基线为基础：这是最快的方法。

* * *

在对这个新流进行更改之后，您可以进行新的 rebase 以更改基础基线，但前提是该新 rebase 使用来自父流的更新基线（而不是旧基线）

* * *

对于您的特定需要，我会推荐一个带有简单规则的非 UCM 快照视图

```
element * thePreviousBaseline 
```

为了让开发者拥有：

*   他/她当前的 UCM 开发视图（始终设置在与流关联的分支的最新）
*   第二个快照视图设置为他/她需要的任何基线。

第二个快照视图与 UCM 项目完全无关，并利用了基线的“完整”性质（请检查您的基线是否已设为“完整”，而不是“增量”。如果它是“增量” ，只需更改其类型并将其升级为完整）

因此，除了您当前的快照 UCM 视图之外，您还可以在任何需要非快照视图的位置创建：

```
cleartool mkview -snap -tag mylogin_myComponentname_csl_snap -vws myPathToViewStorage myPathToRootView
cd myPathToRootView
cleartool edcs
[add the selection rule: element * myOlderBaseline]
[add the load rule at the end: 'load /myVob_Including_MyComponent]
[save, type 'yes'] 
```

这对于咨询/执行来说很好，但是如果您需要修补（即我要**编写**、签出和在某些文件中），那么我建议**每个要修补的基线一个 UCM 流**。
这样，流清楚地代表了给定基线的补丁工作。它们不应该太多，除非您每五分钟将应用程序的新版本投入生产......这是不可取的;）

* * *

所以总结一下：

*   非 UCM 快照视图是独一无二的，可用于一次快速咨询/调试一个较旧的基线。
*   对于补丁（源代码修改），您创建一个正确命名的并行流，具有正确的基础基线，然后在其上创建一个 UCM 视图。您不仅可以调试还可以修复活动中的一些错误，如果该错误需要在更高的流上进行改装，则将该活动交付到主 Int 流。
    （注意：并非总是需要交付所有错误：与当前的开发状态相比，它们可能已过时）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T15:21:55.943

我解决这个问题的方法是制作另一个流，即集成流的子流。创建此 Stream 的最简单方法是打开 ClearCase Project Explorer（不是 Rational ClearCase Explorer）并导航到项目，然后是相关的 Stream。右键单击集成流并选择“创建子流...”

单击“高级选项”并为每个组件选择一个基线。通过选择组件然后选择“更改...”并选择您想要查看的特定基线来执行此操作。您可能想要选择“提示我为此流创建视图”。选择“确定”。

任何开发人员都可以做到这一点。您无需成为 VOB 所有者或项目或流所有者。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T13:50:32.450

这要看情况。实际上，答案在于设置您的配置规范以指向正确的文件。您的配置规范告诉您查看哪些版本的元素。但是你如何编写它取决于你的项目对基线的方法。您是否应用了标签来标记该基线？如果是这样，并且您只想阅读而不是签出任何新内容，那么您的配置规范可以很简单

```
element * <LABELNAME> 
```

如果您没有使用标签，您还可以设置配置规范以根据日期向您显示文件。您需要添加的规则越多来限制您的元素选择，它就会变得越复杂。如果您有更多细节，我可以尝试详细说明您可能需要哪些规则。否则，我会阅读 ClearCase 附带的手册。如果您从 ClearCase Explorer 查看扩展帮助，然后执行“在线查看 Rational ClearCase 手册”，它应该会为您提供一些指向命令参考的链接。每当我需要以某种新方式修改配置规范时，我都会去这里。

另外，请注意我们只使用动态视图，所以我不知道快照视图的工作方式是否不同。

# php - 未从 DOM 中删除的元素

> ID：606152
> 
> 赞同：0
> 
> 时间：2009-03-03T12:09:04.300
> 
> 标签：php, javascript, ajax, dom

我有代码从mysql中删除一条记录，通过php显示在一个表中，然后从页面中删除表行。记录被删除，但是页面或 DOM 中没有任何变化，它应该立即更改。

这是要从 DOM 中删除的 javascript 代码

```
function deleteItem(layer, url) {
    var xmlHttp=GetXmlHttpObject();
    if(xmlHttp==null) {
        alert("Your browser is not supported?");
    }
    xmlHttp.onreadystatechange = function() {
        if(xmlHttp.readyState==4 || xmlHttp.readyState=="complete") {
                if(xmlHttp.responseText == 'result=true') {
                        var row = document.getElementById(layer);
                        row.parentNode.removeChild(row);
                }

        } else if (xmlHttp.readyState==1 || xmlHttp.readyState=="loading") {
                document.getElementById(layer).innerHTML="loading";
        }
    }
    xmlHttp.open("GET",url,true);
    xmlHttp.send(null);
}
function deleteRec(layer, pk) {
    url = "get_records.php?cmd=deleterec&pk="+pk+"&sid="+Math.random();
    if (confirm("Confirm Delete?")) {
        deleteItem(layer, url);
    }
} 
```

从 php 调用如下：

```
echo '<tr id=\"article_' . $pk . '\">' . "\n";   
echo '<td><a href="#" onclick="deleteRec(\'article_' . $pk .'\', \'' . $pk . '\')">DELETE</a></td>' . "\n"; 
```

$pk 是记录的主键。

结果 html 很好（显然因为记录被删除了）

```
<a href="#" onclick="deleteRec('article_260343387801', '260343387801')">DELETE</a> 
```

但是该页面没有以任何方式更新。

为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T12:40:21.790

我只是将您的代码放入测试页面，当我删除以下内容时它对我有用：

```
 document.getElementById(layer).innerHTML=xmlHttp.responseText; 
```

就在该行之前的行：

```
} else if (xmlHttp.readyState==1 || xmlHttp.readyState=="loading") { 
```

`document.getElementById(layer).innerHTML=xmlHttp.responseText;`导致错误。

编辑：我将添加我的“版本”`get_records.php`只是一个 php 页面，回显“result = true”用于我自己的测试目的，所以如果你仍然遇到问题，那么我建议你的 PHP 脚本，而删除正确的数据，没有返回正确的字符串 - 您应该检查实际输出的内容`xmlHttp.responseText`

编辑 2：您的 PHP 代码实际上从未以您的 responseText 可以识别的方式返回“result=true”。你有：

```
if($cmd=="deleterec") {
    mysql_query('DELETE FROM AUCTIONS WHERE ARTICLE_NO = ' . $pk);
} 
```

所以你将删除正确的项目，但你没有`echo 'result=true';`任何地方，所以你的 if 语句检查 responseText 永远不会被调用。

编辑 3：我当前的测试代码（在 Firefox 中运行良好 [在其他浏览器中未经测试]）。

```
<script type="text/javascript">
    var xmlHttp;

    function GetXmlHttpObject(){
        var objXMLHttp = null;

        if (window.XMLHttpRequest){
        try{
            objXMLHttp = new XMLHttpRequest();
        }catch (e){
            objXMLHttp = false;
        }
    }else if (window.createRequest){
        try{
            objXMLHttp = new window.createRequest();
        }catch (e){
            objXMLHttp = false;
        }
    }else if (window.ActiveXObject){
        try {
            objXMLHttp = new ActiveXObject("Msxml2.XMLHTTP");
        }catch (e){
            try {
                objXMLHttp = new ActiveXObject("Microsoft.XMLHTTP");
            }catch (e){
                objXMLHttp = false;
            }
        }
    }

    return objXMLHttp;
  }
 function deleteItem(layer, url) {
 var xmlHttp=GetXmlHttpObject();
 if(xmlHttp==null) {
    alert("Your browser is not supported?");
 }
 xmlHttp.onreadystatechange = function() {
    if(xmlHttp.readyState==4 || xmlHttp.readyState=="complete") {
            console.log(xmlHttp.responseText);
            if(xmlHttp.responseText == 'result=true') {
                    var row = document.getElementById(layer);
                    row.parentNode.removeChild(row);
            }
            //document.getElementById(layer).innerHTML=xmlHttp.responseText;
    } else if (xmlHttp.readyState==1 || xmlHttp.readyState=="loading") {
            //document.getElementById(layer).innerHTML="loading";
    }
 }
 xmlHttp.open("GET",url,true);
 xmlHttp.send(null);
 }
 function deleteRec(layer, pk) {
    url = "get_records.php?cmd=deleterec&pk="+pk+"&sid="+Math.random();
    if (confirm("Confirm Delete?")) {
    deleteItem(layer, url);
    }
 }
</script>

<table>
      <tr id="article_260343387801">
      <td><a href="#" onclick="updateByPk()">Name</a></td>
      <td><a href="#" onclick="deleteRec('article_260343387801', '260343387801')">DELETE</a>
      </td>
      </tr>
 </table> 
```

这与 php 代码结合使用效果很好（数据库连接/查询内容已为我的个人测试注释掉）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T12:22:45.920

我没有立即明白为什么：

```
row.parentNode.removeChild(row); 
```

行不通……你确定你真的到了那里吗？您的错误报告有问题：

```
document.getElementById(layer).innerHTML=xmlHttp.responseText; 
```

'layer' 是一个 <tr>，你不能在 IE 的 <tr> 上分配 innerHTML。相反，您将收到“未知运行时错误”异常，并且脚本将停止。

（另外，如果你试图将文本直接放在 <tr> 内而不用 <td> 包围会发生什么，这是未定义的。）

# performance - Biztalk 中的垃圾收集，明智的做法是什么？

> ID：606158
> 
> 赞同：0
> 
> 时间：2009-03-03T12:10:33.767
> 
> 标签：performance, memory-leaks, garbage-collection, biztalk, orchestration

我们的 Biztalk 2006 应用程序包含两个经常调用的编排（大约每秒 15 个请求）。我们通过在主机中进行某些限制阈值更改来识别我们的应用程序中可能存在的内存泄漏。当我们禁用基于内存的限制时，进程内存开始增加到 1400 MB，之后我们开始遇到内存不足的异常。
发生这种情况时，我们被迫重新启动主机实例。
我们想知道在这种情况下，从 Orchestration 显式调用 GC.Collect 是否有效。使用这种方法有什么缺点？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T15:37:17.060

仅当垃圾收集器无法释放足够的内存来执行请求的分配时，才会发生内存不足异常。如果您有内存泄漏，则可能会发生这种情况，在垃圾收集平台中，这意味着某些对象引用的保留时间超过了它们需要的时间。泄漏的常见原因是保存全局数据（静态变量）的对象，例如保持引用时间过长的单例、缓存或池。

如果显式调用 GC.Collect，它也将无法释放内存，原因与隐式收集失败的原因相同。所以 explit GC.Collect 调用只会导致编排速度变慢。

如果您从编排中调用 .Net 类，我建议尝试通过从纯 .Net 应用程序调用相同的类来隔离问题（不涉及 BizTalk）

也有可能没有泄漏，但是每个实例同时消耗了太多内存。BizTalk 通常会在它认为有必要时使编排脱水，但如果编排（或大型原子范围）中的某个步骤执行时间过长，则可能会阻止这样做。

1400 mb 对于只有 15 个并发实例来说看起来也很大。您是否正在对编排中的大型消息进行操作？在这种情况下，您可以通过避免强制将整个消息加载到内存中的操作来大大减少内存使用量，而是使用流式处理消息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T12:55:59.960

不知道 Biztalk 我的答案可能很遥远……</p>

我假设在一个进程中运行的更多编排实例会增加单个编排实例完成所需的时间。然后，随着您增加让同时运行的编排实例的数量，在某些时候，它们完成所需的时间将足够大，以至于正在运行的编排实例的大小对您的 RAM 来说非常有用。

我认为您需要根据正在运行的编排实例的数量进行节流。如果您将“完成率”与“正在运行的编排实例数”绘制成图表，您可能会在图表中间看到一个大的平坦区域，选择您的节流以使您保持在这个稳定区域的中间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T16:05:09.397

I agree with the poster above. Trying to clear the memory or resetting the host instance is not the solution but just a band aid. you need to find where you are leaking memory. I would look at the whole Application and not just the orchestration; it is possible that the ports could also be causing your memory leak. Do you use custom functoids in your maps? how about inline code? Custom xslt? I would also look at custom pipelines if you are using them. If its possible i would try isolating the different components and putting them under stress and volume tests individually; somehow i dont think your orchestration itself is the problem, but rather a map or a custom component.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-10T06:51:24.973

我完全同意其他人所说的大部分内容——你应该看看你的漏洞在哪里并修复它；直接致电 GC 对您没有帮助，而且在任何情况下都不太可能是一种合理的前进方式。

不过，我要补充一点，如果您遇到资源消耗突然增加，节流的存在是为了保护您的环境不会陷入停顿；如果不进行限制，BizTalk（与任何其他服务器一样）可能会达到无法继续处理并有效“卡住”的程度；节流允许它放慢速度，以确保处理仍在进行，直到资源消耗水平（希望）恢复到正常水平；

出于这个原因，我还建议您考虑为您的环境配置一些限制，必须调整其值以适应您的情况

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-06T16:29:44.117

进行垃圾收集不会释放泄漏的内存，因为它仍然（错误地）被您的应用程序以某种方式引用。如果您做了很多生成短期对象并且知道您正处于释放它们的好时机，您只会调用 GC.Collect。

您必须识别并修复泄漏代码！

# ruby - 红宝石？如何忽略剪切和粘贴的用户输入中的换行符？

> ID：606160
> 
> 赞同：2
> 
> 时间：2009-03-03T12:11:57.100
> 
> 标签：ruby, highline

我编写了一个需要一些用户输入的小 Ruby 脚本。我预计用户在需要长条目的数据输入过程中的某些时候可能会有点懒惰，并且他们可能会从另一个包含换行符的文档中剪切和粘贴。

我一直在玩[Highline](http://rubyforge.org/projects/highline/) gem 并且非常喜欢它。我怀疑我只是在文档中遗漏了一些东西，但是有没有办法获得可变长度的多行输入？

编辑：问题在于换行符终止了该输入，并且换行符之后的字符最终成为下一个问题的输入。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-03T14:32:34.220

以下是作者在他的示例中使用的内容：（来自 highline-1.5.0/examples）

```
#!/usr/local/bin/ruby -w

# asking_for_arrays.rb
#
#  Created by James Edward Gray II on 2005-07-05.
#  Copyright 2005 Gray Productions. All rights reserved.

require "rubygems"
require "highline/import"
require "pp"

grades = ask( "Enter test scores (or a blank line to quit):",
              lambda { |ans| ans =~ /^-?\d+$/ ? Integer(ans) : ans} ) do |q|
  q.gather = ""
end

say("Grades:")
pp grades 
```

关于`HighLine::Question#gather`（来自 highline-1.5.0/lib/highline/question.rb）的一般文档

```
# When set, the user will be prompted for multiple answers which will
# be collected into an Array or Hash and returned as the final answer.
#
# You can set _gather_ to an Integer to have an Array of exactly that
# many answers collected, or a String/Regexp to match an end input which
# will not be returned in the Array.
#
# Optionally _gather_ can be set to a Hash.  In this case, the question
# will be asked once for each key and the answers will be returned in a
# Hash, mapped by key.  The <tt>@key</tt> variable is set before each
# question is evaluated, so you can use it in your question.
#
attr_accessor :gather 
```

这些似乎是您在图书馆中的主要选择。其他的，你必须自己做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T12:35:49.337

会不会是这样的：

```
input.gsub!('\r\n', '') 
```

# .net - .Net Compact Framework 中的 HTTP 进展

> ID：606176
> 
> 赞同：0
> 
> 时间：2009-03-03T12:16:42.567
> 
> 标签：.net, http, compact-framework, progress

我正在开发一个发出大量 HTTP“Web 服务”请求的应用程序，其中一些请求可能是相当大的 XML 文件。现在 HTTP 请求是在第二个线程上发出的，所以 GUI/Form 没有被锁定。但它仍然无法向用户反馈请求的进度。

到目前为止，我一直在使用 HTTPWebRequest 类来完成这项工作，我所有的研究都指向它不做异步进度报告回调，直到它完成。

在不久的将来，这个应用程序将不得不通过 3G/GPRS 上传大的 .jpg 和 .zip 文件。如果没有进度条或某种类型的反馈，使用起来会非常不愉快。

是否有任何其他（可能是第 3 方）框架或我可以使用的类？

请不要发布适用于 Desktop .Net 的代码，并假设它适用于 CF，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-05T04:54:55.467

请记住，如果 XML 文件使用 HTTP“Transfer-Encoding: chunked”标头发送，HTTP 不会告诉您文件有多大。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T10:48:03.040

您可以使用如下代码拦截来自服务器的字节流：

```
HttpWebResponse response = request.GetResponse();

Stream responseStream = response.GetResponseStream(); 
```

然后，您可以将响应流包装在您自己的类中，该类从 HTTP 流中读取并报告通过事件接收了多少字节。您必须启动自己的单独线程才能运行它，并且您必须将流的内容显式写入文件。（我没有在 CF 中尝试过，但这些方法被记录为适用于 CF。）

# php - 哪种加密算法最适合加密 cookie？

> ID：606179
> 
> 赞同：56
> 
> 时间：2009-03-03T12:18:15.213
> 
> 标签：php, security, cookies, encryption, remember-me

> 由于这个问题很受欢迎，我认为给它一个更新很有用。
> 
> 让我强调[AviD](https://security.stackexchange.com/users/33/avid)对这个问题 给出**的正确答案：**
> 
> **您不应在 cookie 中存储任何需要加密的数据。**相反，在 cookie 中存储一个大小合适（128 位/16 字节）的随机密钥，并将您希望在服务器上保持安全的信息存储在服务器上，由 cookie 的密钥标识。

* * *

我正在寻找有关加密 cookie 的“最佳”加密算法的信息。

我有以下要求：

*   它必须快速
    加密和解密数据（几乎）每个请求都会完成

*   它将在小型数据集上运行，通常是大约 100 个字符或更少的字符串

*   它必须是安全的，但这不像我们正在保护银行交易

*   我们需要能够解密信息，这样 SHA1 等就出来了。

现在我读到 Blowfish 既快速又安全，而且我读到 AES 又快又安全。Blowfish 具有较小的块大小。

我认为这两种算法都提供了足够的安全性？因此速度将成为决定性因素。但我真的不知道这些算法是否适合小字符串，以及是否有更适合加密 cookie 的算法。

**所以我的问题是：**
哪种加密算法最适合加密 cookie 数据？

**更新**
更准确地说，我们要加密 2 个 cookie：一个带有会话信息，另一个带有“记住我”信息。

该平台是 PHP 作为 VPS 上 Linux 上的 apache 模块。

**更新 2**
我同意[cletus](https://stackoverflow.com/users/18393/cletus)的观点，即在 cookie 中存储任何信息都是不安全的。

但是，我们需要实现“记住我”功能。公认的解决方法是设置 cookie。如果客户端提供此 cookie，则允许他或她以（几乎）相同的权限访问系统，就好像他/她提供了有效的用户名密码组合一样。

所以我们至少要加密 cookie 中的所有数据，以便：
**a)**恶意用户无法读取其内容，
**b)**恶意用户无法伪造或篡改自己的 cookie。

（在我们对它做任何事情之前，所有来自 cookie 的数据都经过清理并检查其有效性，但那是另一回事了）

会话 cookie 仅包含一个 sessionId/timestamp。它可能在没有加密的情况下使用，但我认为加密它没有害处？（计算时间除外）。

*因此，鉴于我们必须在 cookie 中存储一些数据，加密它的最佳方法是什么？*

**更新 3**
对这个问题的回答让我重新考虑选择的方法。我确实可以在不需要加密的情况下做同样的事情。我不应该加密数据，而应该只发送没有上下文*且无法猜测*的无意义的数据。

*然而，我也不知所措：*
我认为加密使我们能够将数据发送到 BigBadWorld™，并且仍然（相当）确定没有人可以读取或篡改它......
这不就是全部吗？加密点？

但下面的反应倾向于：不要相信加密来实现安全。

*我错过了什么？？*

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-03-03T12:27:49.450

没有真正的理由不使用 256 位的[AES 。](http://en.wikipedia.org/wiki/Advanced_Encryption_Standard)确保在[CBC 模式](http://en.wikipedia.org/wiki/Block_cipher_modes_of_operation#Cipher-block_chaining_.28CBC.29)和 PKCS#7 填充中使用它。正如您所说，快速且安全。

我已经阅读（未经测试）Blowfish 可能会稍微快一些......但是 Blowfish 的主要缺点是设置时间长，这对您的情况不利。此外，AES 更“经过验证”。

这假设确实*有*必要对您的 cookie 数据进行对称加密。正如其他人所指出的那样，它确实没有必要，而且只有少数边缘情况别无选择，只能这样做。通常，更改设计会更适合您，并返回到随机会话标识符，或者在必要时使用单向哈希（使用 SHA-256）。
在您的情况下，除了“常规”随机会话标识符之外，您的问题是“记住我”功能 - 这也应该实现为：

*   一个长随机数，存储在数据库中并映射到用户帐户；
*   或包含例如用户名、时间戳、mebbe a salt 和秘密服务器密钥的键控散列（例如 HMAC）。当然，这都可以在服务器端进行验证...

似乎我们对您最初的具体问题有点偏离主题 - 并通过更改设计来改变您问题的基础......
所以只要我们这样做，我也强烈建议*反对*这个功能坚持“记住我”的原因有几个，其中最大的一个原因是：

*   使某人更有可能窃取该用户的记忆密钥，从而使他们能够欺骗用户的身份（然后可能更改他的密码）；
*   [CSRF](http://www.cgisecurity.com/csrf-faq.html) -[跨站点请求伪造](http://www.owasp.org/index.php/Cross-Site_Request_Forgery)。您的功能将有效地允许匿名攻击者导致不知情的用户向您的应用程序提交“经过身份验证的”请求，即使没有实际登录。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-03-03T12:26:55.350

这涉及两个不同的问题。

首先，**会话劫持**。这就是第三方发现（例如）经过身份验证的 cookie 并获得对他人详细信息的访问权限的地方。

其次，还有**会话数据的安全性**。我的意思是您将数据存储在 cookie 中（例如用户名）。这不是一个好主意。任何此类数据基本上都是不可信的，就像 HTML 表单数据不可信一样（无论您使用什么 Javascript 验证和/或 HTML 长度限制，如果有的话），因为客户端可以自由提交他们想要的内容。

您经常会发现人们（正确地）提倡对 HTML 表单数据进行清理，但 cookie 数据将被盲目接受。大错。事实上，我从未在 cookie 中存储任何信息。我将其视为会话密钥，仅此而已。

**如果您打算将数据存储在 cookie 中，我强烈建议您重新考虑。**

对此数据的加密不会使信息更值得信赖，因为对称加密容易受到暴力攻击。显然 AES-256 比 DES 更好（呵呵），但是 256 位的安全性并不一定像你想象的那么重要。

一方面，SALT 通常是根据算法生成的，否则容易受到攻击。

另一方面，cookie 数据是[婴儿床](http://en.wikipedia.org/wiki/Crib_(cryptanalysis))攻击的主要候选者。如果知道或怀疑用户名在加密数据中，嘿，这就是你的婴儿床。

这让我们回到了第一点：劫持。

应该指出的是，在 PHP 中的共享托管环境中（例如），您的会话数据只是存储在文件系统上，并且同一主机上的其他任何人都可以读取，尽管他们不一定知道它用于哪个站点。因此，切勿在没有某种形式的加密的情况下存储纯文本密码、信用卡号、大量个人详细信息或任何可能在此类环境中被视为敏感的会话数据，或者更好的是，仅在会话中存储密钥并存储实际敏感信息数据库中的数据。

**注意：**以上不是 PHP 独有的。

但那是服务器端加密。

现在你可能会争辩说，用一些额外的数据加密会话会使其更安全，不会被劫持。一个常见的例子是用户的 IP 地址。问题是许多人在许多不同的位置（例如 Wifi 热点、工作、家）使用相同的 PC/笔记本电脑。此外，许多环境将使用各种 IP 地址作为源地址，尤其是在公司环境中。

您也可以使用用户代理，但这是可以猜测的。

所以真的，据我所知，根本没有真正的理由使用 cookie 加密。我从没想过有，但鉴于这个问题，我去寻找被证明是对还是错。我发现了一些关于人们建议加密 cookie 数据的方法、使用 Apache 模块透明地进行加密等方法的线程，但这些似乎都是为了保护存储在 cookie 中的数据（恕我直言，你不应该这样做）。

我还没有看到用于加密仅代表会话密钥的 cookie 的安全参数。

如果有人能指出相反的事情，我很乐意被证明是错误的。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2010-10-25T15:46:30.973

> **安全警告**：这两个功能不安全。他们使用[ECB 模式](https://blog.filippo.io/the-ecb-penguin/)，无法[验证密文](https://paragonie.com/blog/2015/05/using-encryption-and-authentication-correctly)。请参阅[此答案](https://stackoverflow.com/a/30189841/2224584)以获得更好的前进方式。

对于那些想在 PHP 脚本中使用此方法的人。这是一个使用 256 位 Rijndael（不是 AES）的工作示例。

```
function encrypt($text, $salt) 
{ 
    return trim(base64_encode(mcrypt_encrypt(MCRYPT_RIJNDAEL_256, $salt, $text, MCRYPT_MODE_ECB, mcrypt_create_iv(mcrypt_get_iv_size(MCRYPT_RIJNDAEL_256, MCRYPT_MODE_ECB), MCRYPT_RAND)))); 
} 

function decrypt($text, $salt) 
{ 
    return trim(mcrypt_decrypt(MCRYPT_RIJNDAEL_256, $salt, base64_decode($text), MCRYPT_MODE_ECB, mcrypt_create_iv(mcrypt_get_iv_size(MCRYPT_RIJNDAEL_256, MCRYPT_MODE_ECB), MCRYPT_RAND))); 
} 
```

然后保存cookie

```
setcookie("PHPSESSION", encrypt('thecookiedata', 'longsecretsalt')); 
```

并在下一页阅读：

```
$data = decrypt($_COOKIE['PHPSESSION'], 'longsecretsalt'); 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2015-07-30T01:42:23.337

## 使用 Libsodium 的快速、加密 Cookie

如果您需要 PHP 中快速、安全的加密 cookie，请查看[Halite](https://github.com/paragonie/halite)如何实现它们。Halite依靠[libsodium PECL 扩展](https://pecl.php.net/package/libsodium)来提供安全加密。

```
<?php
use \ParagonIE\Halite\Cookie;
use \ParagonIE\Halite\Symmetric\Key;
use \ParagonIE\Halite\Symmetric\SecretKey;

// You can also use Key::deriveFromPassword($password, $salt, Key::CRYPTO_SECRETBOX);
$encryption_key = new SecretKey($some_constant_32byte_string_here);

$cookie = new Cookie($encryption_key);

$cookie->store('index', $any_value);
$some_value = $cookie->fetch('other_index'); 
```

如果您无法安装 PECL 扩展，请让您的系统管理员或托管服务提供商为您安装。如果他们拒绝，你仍然有选择。

* * *

## 用 PHP 保护加密的 Cookie，请保持警惕

其他答案指示您使用 openssl 或 mcrypt 加密数据，但它们缺少关键步骤。如果您想[在 PHP 中安全地加密数据](https://paragonie.com/blog/2015/05/using-encryption-and-authentication-correctly)，您*必须*验证您的消息。

使用 OpenSSL 扩展，您需要遵循的过程如下所示：

* * *

### 前言

*   （在您考虑加密之前）生成 128 位、192 位或 256 位随机字符串。这将是您的**万能钥匙**。

    **不要使用人类可读的密码。**如果您出于某种原因*必须*使用人类可读的密码，请向[Cryptography SE](http://crypto.stackexchange.com)寻求指导。

    如果您需要特别注意，我的雇主提供[技术咨询服务](https://paragonie.com/service/technology-consulting)，包括开发密码学功能。

### 加密

1.  生成随机初始化向量 (IV) 或随机数。例如`random_bytes(openssl_cipher_iv_length('aes-256-cbc'))`
2.  使用[HKDF](https://github.com/defuse/php-encryption/blob/d2c33279e31d5f3d4b74a82139b6ce56d551965b/src/Crypto.php#L331-L397)或类似算法将主密钥拆分为两个密钥：
    1.  加密密钥 ( `$eKey`)
    2.  身份验证密钥 ( `$aKey`)
3.  使用步骤 2中的加密密钥 ( ) 使用您`openssl_encrypt()`的 IV 和适当的模式（例如）加密您的字符串。`aes-256-ctr``$eKey`
4.  使用密钥散列函数（例如 HMAC-SHA256）计算步骤 3 中密文的身份验证标签。例如`hash_hmac('sha256', $iv.$ciphertext, $aKey)`。**加密后进行身份验证以及封装 IV/nonce 非常重要。**
5.  将身份验证标签、IV 或 nonce 和密文打包在一起，并可选择使用`bin2hex()`or对其进行编码`base64_encode()`。（警告：这种方法*可能会*泄漏缓存计时信息。）

### 解密

1.  按照加密中的步骤 2 拆分您的密钥。在解密过程中我们需要相同的两个密钥！
2.  （可选地，解码和）解包来自打包消息的 MAC、IV 和密文。
3.  通过使用用户提供的 HMAC 重新计算 IV/nonce 和密文的 HMAC 来验证身份验证标签[`hash_equals()`](https://secure.php.net/hash_equals)。
4.  当且仅当第 3 步通过时，使用`$eKey`.

如果您想看看这一切看起来如何，请参阅[包含示例代码的答案](https://stackoverflow.com/a/30189841/2224584)。

如果这听起来工作量太大，请使用[defuse/php-encryption](https://github.com/defuse/php-encryption)或[zend-crypt](https://github.com/zendframework/zend-crypt)并收工。

* * *

## 记住我饼干

> 但是，我们需要实现“记住我”功能。公认的解决方法是设置 cookie。如果客户端提供此 cookie，则允许他或她以（几乎）相同的权限访问系统，就好像他/她提供了有效的用户名密码组合一样。

加密实际上不是这项工作的正确工具。你想按照这个过程[在 PHP 中安全记住我的 cookie](https://paragonie.com/blog/2015/04/secure-authentication-php-with-long-term-persistence#title.2)：

### 生成记住我的令牌

1.  生成两个随机字符串：
    1.  A`selector`将用于数据库查找。（使用随机选择器而不只是顺序 ID 的目的是*不*泄露您网站上的活跃用户数量。如果您愿意泄露此信息，请随意使用顺序 ID。）
    2.  A`validator`将用于自动对用户进行身份验证。
2.  计算一个哈希值`validator`（一个简单的 SHA-256 哈希就足够了）。
3.  将`selector`和 的哈希存储在`validator`为自动登录保留的数据库表中。
4.  将`selector`和存储`validator`在客户端的 cookie 中。

### 兑换记住我的令牌

1.  将传入的 cookie 拆分为`selector`and `validator`。
2.  基于.执行数据库查找（使用[准备好的语句！）](https://stackoverflow.com/a/60496/2224584)`selector`
3.  如果找到一行，则计算`validator`.
4.  将步骤 3 中计算的哈希值与存储在数据库中的哈希值进行比较，再次使用[`hash_equals()`](https://secure.php.net/hash_equals).
5.  如果第 4 步返回 true，则将用户登录到相应的帐户。

这是[Gatekeeper](https://github.com/psecio/gatekeeper)为长期用户认证所采用的策略，也是迄今为止为满足这一要求而提出的最安全的策略。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-09-23T12:32:09.480

您可以通过在 EAX 模式下使用 AES 安全地实现您想要的。密文会比明文大；这对于安全加密来说是正常的。

攻击者当然会从密文中知道明文的长度，但他们不应该能够确定其他任何内容。

随机生成 AES 密钥。

确保每次加密都使用新的随机数，并使用“关联数据”字段来确保您为一个目的加密的东西不会被显示为另一个目的（因此用户名和 cookie 名称之类的东西可以进入那里）

> 以下反应推向：不要相信加密来实现安全性。

更多“如果您不是加密专家，您会低估出错的容易程度”。例如，AFAICT 此线程中没有其他人讨论过链接模式或消息完整性，这涵盖了初学者的两个常见错误。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-03T12:27:57.780

虽然两者都很强大，但 AES 是一种标准。

至于小块数据的安全性：越小越好。公开的加密数据越少，您可以使用密钥的时间越长。在给定算法的一个密钥内可以加密多少数据而不会使系统面临风险，总是存在理论上的限制。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-10-29T14:03:17.080

正如在之前的评论中多次指出的那样，您**必须**对发送给用户并接受回的任何密文应用**完整性保护。**否则可以修改受保护的数据，或恢复加密密钥。

尤其是 PHP 世界充满了忽略这一点的不良示例（请参阅[PHP 密码学 - 谨慎](http://ipsec.pl/node/1085)操作），但这确实适用于任何语言。

我见过的几个很好的例子之一是[PHP-CryptLib](https://github.com/ircmaxell/PHP-CryptLib)，它使用组合的加密-身份验证模式来完成这项工作。对于 Python [pyOCB](http://ipsec.pl/node/732)提供了类似的功能。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-03T14:20:44.217

为什么要加密 cookie？

在我看来，有两种情况：要么给客户密钥，要么不给。

如果您不将密钥提供给客户，那么您为什么要给他们数据？除非您正在玩一些破坏弱加密的奇怪游戏（您明确没有这样做），否则您最好将数据存储在服务器上。

如果您*确实*将密钥交给了客户，那么您为什么要首先对其进行加密呢？如果您不加密密钥的通信，那么加密 cookie 就没有实际意义：MITM 可以查看 cookie 并向您发送他想要的任何 cookie。如果您使用到客户端的加密通道，为什么加密存储数据的额外开销？

如果您担心客户端计算机上的其他用户读取 cookie，请放弃并假设浏览器设置了良好的权限位 :)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-10-12T14:43:26.513

如果您加密 cookie，服务器仍然必须对其进行解码才能读取它（以检查相同的密钥），因此任何加密的 cookie 都是毫无意义的，因为如果被盗（并且未经编辑）它仍然会导致黑客访问您的帐户. 它就像根本没有加密一样不安全。

我相信有人窃取您的 cookie 的真正问题是服务器和客户端之间的连接。使用您的主机提供的 SSL 连接。

至于您的 cookie，您需要在数据库中为每个用户创建一个长的随机 id，（让它在每次登录时更改）并将其设置为 cookie 或会话。可以通过 php 检查包含密钥的 cookie，如果它等于数据库中的帐户或表，则像往常一样将数据转储到网页上。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-03T12:28:38.997

AES（也称为 Rijndael）是最受欢迎的。块大小为 128 位，即只有 16 字节，而您说的是“大约 100 个字符”。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-01-18T17:43:54.233

我认为“放弃”任何数据，即使是关于用户名和密码的加密数据也不好......有很多 JS 可以嗅探它......我建议你在用户数据库表中创建一个字段 cookie_auth 或其他...... .

首次登录后收集：当前：浏览器、IP、一些自己的盐键，加上您的主机名 var ...

创建一个哈希并存储在该字段中......设置一个cookie......当cookie“响应”时将所有这些与存储的哈希进行比较并完成......

即使有人“偷”了一个 cookie，他们也无法使用它 :-)

希望这可以帮助 ：-）

feha vision.to

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2011-03-14T18:09:15.637

另外，我已经尝试过`mcrypt_encrypt`一件事，请记住。如果你这样做`base64_encode(mcrypt_encrypt(...))`。

然后，您执行`base64_decode` 并输出加密数据 ( `echo`)。你可能会被搞砸，什么也看不到。但是，如果您这样做 `mcrypt_decrypt( ... base64_decode($value) )`。您将看到原始数据。

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2020-01-22T06:27:20.373

说了这么多可怕的事情，虽然这是真的，但让我们看到光明的一面，一点常识和持续关注您的网站可能会一直为您节省时间。

保存 cookie 是 Web 开发的重要组成部分，因此不容忽视。但也要尽量避免；只有在用户关闭浏览器后我想扩展登录会话时，我才会看到使用 Cookie。如果不想将用户会话扩展到浏览器关闭之外，则应使用会话组件。即使使用 Session 组件，也应该注意 Session Hijacking。

无论如何，回到 Cookie 的事情；在我看来，如果遵循以下预防措施，我很确定我们可以更安全。

我把`precautionary measurement`in分成两个阶段

**第一阶段：开发**

1.  设置`path`属性
2.  放`expiration_date`
3.  集合`secure`,`httpOnly`属性
4.  使用最新的加密算法
5.  使用两种算法：例如使用`blowfish`，然后`base64_encode`在其之上使用。

**第 2 阶段：运营/审计**

1.  定期进行现场审核，使用`burp`.

# .net - 在 DataGridView 中更新多个选定的 INofityPropertyChange 对象

> ID：606190
> 
> 赞同：1
> 
> 时间：2009-03-03T12:22:55.547
> 
> 标签：.net, winforms, data-binding, datagridview, inotifypropertychanged

我正在使用启用了 MultiSelect 的[`DataGridView`（Windows 窗体）](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.aspx)，它放置在用户控件中。我想通过调用实现以下代码的公共方法来更新用户控件外部的所有选定行：

```
foreach(DataGridViewRow dr in dataGridView.SelectedRows)
{
    MyBusiness business = (MyBusiness)dr.DataBoundItem;
    business.Rating = 5;
} 
```

Unfortunately, when multiple rows are selected, only one `DataGridViewRow`is immediately refreshed, namely the one that was last selected. 基础对象发生更改，并触发 NotifyPropertyChange 事件。此外，当我在更新后更改选择时，我会看到所有行都按照我希望它们立即更新的方式进行了更新。

第二件事，非常奇怪：当我在`Rating`触发 NotifyPropertyChange 的 -property 的 Setter 中设置断点并在那里等待几秒钟，然后继续执行代码时，一切正常（所有行都立即更新）。如果我不等待而是在每次通过断点时非常快速地按 F5，我就会得到上面描述的效果。

我的业务对象看起来像这样（当然显着缩短）：

```
public class MyBusiness : INotifyPropertyChanged
{
    private int _rating;
    public int Rating
    {
        get { return _rating; }
        set
        {
            if(_rating != value)
            {
                _rating = value;
                NotifyPropertyChanged("Rating");
            }
        }
    }

    #region INotifyPropertyChanged Members
    public event PropertyChangedEventHandler PropertyChanged;

    private void NotifyPropertyChanged(string propertyName)
    {
        if(PropertyChanged != null)
            PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
    }
    #endregion
} 
```

是否有人也已经注意到这种行为，或者甚至知道解决方案（或解决方法）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-10T05:16:28.843

如果您的 DGV 绑定到常规列表，则它仅订阅当前选定行的 PropertyChanged 事件。尝试改用 BindingList，或为每个更改的项目调用 BindingSource.ResetItem(n)。

[MSDN 给出了一个](http://msdn.microsoft.com/en-us/library/ms184414.aspx)使用 BindingList 并且（毫无意义地）调用 ResetItem 的示例。使用他们的示例，您可以看到删除对 ResetItem 的调用或将 BindingList 替换为常规 List<> 将按预期运行。

# python - 将字节转换为字符串

> ID：606191
> 
> 赞同：3231
> 
> 时间：2009-03-03T12:23:01.583
> 
> 标签：python, string, python-3.x

我正在使用此代码从外部程序获取标准输出：

```
>>> from subprocess import *
>>> command_stdout = Popen(['ls', '-l'], stdout=PIPE).communicate()[0] 
```

communicate() 方法返回一个字节数组：

```
>>> command_stdout
b'total 0\n-rw-rw-r-- 1 thomas thomas 0 Mar  3 07:03 file1\n-rw-rw-r-- 1 thomas thomas 0 Mar  3 07:03 file2\n' 
```

但是，我想将输出用作普通的 Python 字符串。这样我就可以像这样打印它：

```
>>> print(command_stdout)
-rw-rw-r-- 1 thomas thomas 0 Mar  3 07:03 file1
-rw-rw-r-- 1 thomas thomas 0 Mar  3 07:03 file2 
```

我认为这就是[binascii.b2a_qp()](http://docs.python.org/3.0/library/binascii.html?highlight=b2a#binascii.b2a_qp)方法的用途，但是当我尝试它时，我又得到了相同的字节数组：

```
>>> binascii.b2a_qp(command_stdout)
b'total 0\n-rw-rw-r-- 1 thomas thomas 0 Mar  3 07:03 file1\n-rw-rw-r-- 1 thomas thomas 0 Mar  3 07:03 file2\n' 
```

如何将字节值转换回字符串？我的意思是，使用“电池”而不是手动操作。我希望 Python 3 可以。

* * *

## 回答 #1

> 赞同：5012
> 
> 时间：2009-03-03T12:26:18.313

您需要解码 bytes 对象以生成字符串：

```
>>> b"abcde"
b'abcde'

# utf-8 is used here because it is a very common encoding, but you
# need to use the encoding your data is actually in.
>>> b"abcde".decode("utf-8") 
'abcde' 
```

请参阅：[https ://docs.python.org/3/library/stdtypes.html#bytes.decode](https://docs.python.org/3/library/stdtypes.html#bytes.decode)

* * *

## 回答 #2

> 赞同：343
> 
> 时间：2009-03-03T12:28:31.537

您需要解码字节字符串并将其转换为字符 (Unicode) 字符串。

在 Python 2 上

```
encoding = 'utf-8'
'hello'.decode(encoding) 
```

或者

```
unicode('hello', encoding) 
```

在 Python 3 上

```
encoding = 'utf-8'
b'hello'.decode(encoding) 
```

或者

```
str(b'hello', encoding) 
```

* * *

## 回答 #3

> 赞同：243
> 
> 时间：2012-08-22T12:57:08.690

我认为这种方式很简单：

```
>>> bytes_data = [112, 52, 52]
>>> "".join(map(chr, bytes_data))
'p44' 
```

* * *

## 回答 #4

> 赞同：118
> 
> 时间：2014-12-17T14:23:09.617

如果您不知道编码，那么要以 Python 3 和 Python 2 兼容的方式将二进制输入读入字符串，请使用古老的 MS-DOS [CP437](https://en.wikipedia.org/wiki/Code_page_437)编码：

```
PY3K = sys.version_info >= (3, 0)

lines = []
for line in stream:
    if not PY3K:
        lines.append(line)
    else:
        lines.append(line.decode('cp437')) 
```

因为编码是未知的，所以期望非英文符号翻译成`cp437`（英文字符不被翻译，因为它们在大多数单字节编码和 UTF-8 中匹配）。

将任意二进制输入解码为 UTF-8 是不安全的，因为您可能会得到以下信息：

```
>>> b'\x00\x01\xffsd'.decode('utf-8')
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 2: invalid
start byte 
```

这同样适用于`latin-1`Python 2 的流行（默认？）。查看[代码页布局](https://en.wikipedia.org/wiki/ISO/IEC_8859-1#Codepage_layout)中的缺失点- 这是 Python 与臭名昭著`ordinal not in range`的 .

**更新 20150604**：有传言称 Python 3 具有将`surrogateescape`内容编码为二进制数据而不会丢失数据和崩溃的错误策略，但它需要转换测试`[binary] -> [str] -> [binary]`，以验证性能和可靠性。

**更新 20170116**：感谢 Nearoo 的评论 - 也有可能使用`backslashreplace`错误处理程序对所有未知字节进行斜线转义。这仅适用于 Python 3，因此即使使用此解决方法，您仍然会从不同的 Python 版本中获得不一致的输出：

```
PY3K = sys.version_info >= (3, 0)

lines = []
for line in stream:
    if not PY3K:
        lines.append(line)
    else:
        lines.append(line.decode('utf-8', 'backslashreplace')) 
```

有关详细信息，请参阅*[Python 的 Unicode 支持](https://docs.python.org/3/howto/unicode.html#python-s-unicode-support)*。

**更新 20170119**：我决定实现适用于 Python 2 和 Python 3 的斜线转义解码。它应该比`cp437`解决方案慢，但它应该在每个 Python 版本上产生**相同的结果。**

```
# --- preparation

import codecs

def slashescape(err):
    """ codecs error handler. err is UnicodeDecode instance. return
    a tuple with a replacement for the unencodable part of the input
    and a position where encoding should continue"""
    #print err, dir(err), err.start, err.end, err.object[:err.start]
    thebyte = err.object[err.start:err.end]
    repl = u'\\x'+hex(ord(thebyte))[2:]
    return (repl, err.end)

codecs.register_error('slashescape', slashescape)

# --- processing

stream = [b'\x80abc']

lines = []
for line in stream:
    lines.append(line.decode('utf-8', 'slashescape')) 
```

* * *

## 回答 #5

> 赞同：113
> 
> 时间：2016-06-29T14:21:21.923

[在 Python 3](https://docs.python.org/3/library/stdtypes.html#bytes.decode)中，默认编码是`"utf-8"`，所以可以直接使用：

```
b'hello'.decode() 
```

这相当于

```
b'hello'.decode(encoding="utf-8") 
```

另一方面，[在 Python 2](https://docs.python.org/2.7/library/stdtypes.html#str.decode)中，编码默认为默认字符串编码。因此，您应该使用：

```
b'hello'.decode(encoding) 
```

`encoding`你想要的编码在哪里。

[**注意：**](https://docs.python.org/2.7/library/stdtypes.html#str.decode)在 Python 2.7 中添加了对关键字参数的支持。

* * *

## 回答 #6

> 赞同：49
> 
> 时间：2011-07-18T19:51:15.883

我认为你实际上想要这个：

```
>>> from subprocess import *
>>> command_stdout = Popen(['ls', '-l'], stdout=PIPE).communicate()[0]
>>> command_text = command_stdout.decode(encoding='windows-1252') 
```

Aaron 的回答是正确的，只是您需要知道要使用*哪种*编码。而且我相信 Windows 使用“windows-1252”。仅当您的内容中有一些不寻常的（非 ASCII）字符时才重要，但它会有所作为。

顺便说一句，它*确实*很重要的事实是 Python 转向对二进制和文本数据使用两种不同类型的原因：它不能在它们之间进行神奇的转换，因为除非你告诉它，否则它不知道编码！您知道的唯一方法是阅读 Windows 文档（或在此处阅读）。

* * *

## 回答 #7

> 赞同：40
> 
> 时间：2018-05-31T17:52:19.920

由于这个问题实际上是在询问`subprocess`输出，因此您可以使用更直接的方法。最现代的方法是使用[`subprocess.check_output`](https://docs.python.org/3/library/subprocess.html#subprocess.check_output)和传递`text=True`（Python 3.7+）使用系统默认编码自动解码标准输出：

```
text = subprocess.check_output(["ls", "-l"], text=True) 
```

对于 Python 3.6，`Popen`接受[*编码*](https://docs.python.org/3/library/subprocess.html#frequently-used-arguments)关键字：

```
>>> from subprocess import Popen, PIPE
>>> text = Popen(['ls', '-l'], stdout=PIPE, encoding='utf-8').communicate()[0]
>>> type(text)
str
>>> print(text)
total 0
-rw-r--r-- 1 wim badger 0 May 31 12:45 some_file.txt 
```

如果您不处理子进程输出，则标题中问题的一般答案是将字节*解码*为文本：

```
>>> b'abcde'.decode()
'abcde' 
```

没有参数，[`sys.getdefaultencoding()`](https://docs.python.org/3/library/sys.html#sys.getdefaultencoding)将被使用。如果您的数据不是，那么您必须在调用`sys.getdefaultencoding()`中明确指定编码：[`decode`](https://docs.python.org/3/library/stdtypes.html#bytes.decode)

```
>>> b'caf\xe9'.decode('cp1250')
'café' 
```

* * *

## 回答 #8

> 赞同：38
> 
> 时间：2014-01-21T15:31:09.370

将universal_newlines设置为True，即

```
command_stdout = Popen(['ls', '-l'], stdout=PIPE, universal_newlines=True).communicate()[0] 
```

* * *

## 回答 #9

> 赞同：34
> 
> 时间：2016-11-16T09:43:26.970

要将字节序列解释为文本，您必须知道相应的字符编码：

```
unicode_text = bytestring.decode(character_encoding) 
```

例子：

```
>>> b'\xc2\xb5'.decode('utf-8')
'µ' 
```

`ls`命令可能会产生无法解释为文本的输出。Unix 上的文件名可以是除斜杠`b'/'`和零 之外的任何字节序列`b'\0'`：

```
>>> open(bytes(range(0x100)).translate(None, b'\0/'), 'w').close() 
```

尝试使用 utf-8 编码对此类字节汤进行解码会引发`UnicodeDecodeError`.

情况可能更糟。 如果您使用错误的不兼容编码，解码可能会静默失败并产生[mojibake ：](https://en.wikipedia.org/wiki/Mojibake)

```
>>> '—'.encode('utf-8').decode('cp1252')
'â€”' 
```

数据已损坏，但您的程序仍然不知道发生了故障。

一般来说，使用什么字符编码并不嵌入字节序列本身。您必须在带外传达此信息。有些结果比其他结果更有可能，因此`chardet`存在可以*猜测*字符编码的模块。一个 Python 脚本可能在不同的地方使用多个字符编码。

* * *

`ls``os.fsdecode()` 可以使用即使对于[不可解码的文件名](https://www.python.org/dev/peps/pep-0383/)也能成功的函数将输出转换为 Python 字符串（它在 Unix 上使用 `sys.getfilesystemencoding()`和`surrogateescape`错误处理程序）：

```
import os
import subprocess

output = os.fsdecode(subprocess.check_output('ls')) 
```

要获取原始字节，您可以使用`os.fsencode()`.

如果您传递`universal_newlines=True`参数，则`subprocess`用于 `locale.getpreferredencoding(False)`解码字节，例如，它可以 `cp1252`在 Windows 上。

要即时解码字节流， [`io.TextIOWrapper()`](https://docs.python.org/3/library/io.html#io.TextIOWrapper) 可以使用：[example](https://stackoverflow.com/a/25945031/4279)。

不同的命令可能对其输出使用不同的字符编码，例如，`dir`内部命令 ( `cmd`) 可能使用 cp437。要解码其输出，您可以显式传递编码（Python 3.6+）：

```
output = subprocess.check_output('dir', shell=True, encoding='cp437') 
```

文件名可能与`os.listdir()`（使用 Windows Unicode API）不同，例如，`'\xb6'`可以替换为`'\x14'`——Python 的 cp437 编解码器映射`b'\x14'`来控制字符 U+0014 而不是 U+00B6 (¶)。要支持具有任意 Unicode 字符的文件名，请参阅将 [可能包含非 ASCII Unicode 字符的 PowerShell 输出解码为 Python 字符串](https://stackoverflow.com/q/33936074/4279)

* * *

## 回答 #10

> 赞同：28
> 
> 时间：2015-11-13T10:24:21.737

虽然[@Aaron Maenpaa 的回答](https://stackoverflow.com/a/33688948/1587329)很有效，但一位用户[最近问](https://stackoverflow.com/questions/33688837/urllib-for-python-3/33688948#comment55151210_33688948)：

> 还有更简单的方法吗？'fhand.read().decode("ASCII")' [...] 太长了！

您可以使用：

```
command_stdout.decode() 
```

`decode()`有一个[标准的论点](https://docs.python.org/3/library/stdtypes.html#bytes-and-bytearray-operations)：

> `codecs.decode(obj, encoding='utf-8', errors='strict')`

* * *

## 回答 #11

> 赞同：17
> 
> 时间：2017-11-22T04:20:55.377

如果您应该通过尝试获得以下信息`decode()`：

> AttributeError：“str”对象没有属性“decode”

您还可以直接在强制转换中指定编码类型：

```
>>> my_byte_str
b'Hello World'

>>> str(my_byte_str, 'utf-8')
'Hello World' 
```

* * *

## 回答 #12

> 赞同：12
> 
> 时间：2021-10-21T06:36:44.037

如果您遇到此错误：

*'utf-8 编解码器无法解码字节 0x8a'*

，那么最好使用以下代码将字节转换为字符串：

```
bytes = b"abcdefg"
string = bytes.decode("utf-8", "ignore") 
```

享受！

* * *

## 回答 #13

> 赞同：9
> 
> 时间：2016-06-01T00:03:04.803

我做了一个清理列表的功能

```
def cleanLists(self, lista):
    lista = [x.strip() for x in lista]
    lista = [x.replace('\n', '') for x in lista]
    lista = [x.replace('\b', '') for x in lista]
    lista = [x.encode('utf8') for x in lista]
    lista = [x.decode('utf8') for x in lista]

    return lista 
```

* * *

## 回答 #14

> 赞同：9
> 
> 时间：2017-01-18T07:21:09.763

对于 Python 3，这是一种更安全且*Pythonic*`byte`的从to转换方法`string`：

```
def byte_to_str(bytes_or_str):
    if isinstance(bytes_or_str, bytes): # Check if it's in bytes
        print(bytes_or_str.decode('utf-8'))
    else:
        print("Object not of byte type")

byte_to_str(b'total 0\n-rw-rw-r-- 1 thomas thomas 0 Mar  3 07:03 file1\n-rw-rw-r-- 1 thomas thomas 0 Mar  3 07:03 file2\n') 
```

输出：

```
total 0
-rw-rw-r-- 1 thomas thomas 0 Mar  3 07:03 file1
-rw-rw-r-- 1 thomas thomas 0 Mar  3 07:03 file2 
```

* * *

## 回答 #15

> 赞同：9
> 
> 时间：2018-03-16T13:28:25.110

在处理来自 Windows 系统的数据（带有`\r\n`行尾）时，我的答案是

```
String = Bytes.decode("utf-8").replace("\r\n", "\n") 
```

为什么？用多行 Input.txt 试试这个：

```
Bytes = open("Input.txt", "rb").read()
String = Bytes.decode("utf-8")
open("Output.txt", "w").write(String) 
```

你所有的行尾都将加倍（到`\r\r\n`），导致额外的空行。Python 的文本读取函数通常对行尾进行规范化，以便字符串仅使用`\n`. 如果您从 Windows 系统接收二进制数据，Python 没有机会这样做。因此，

```
Bytes = open("Input.txt", "rb").read()
String = Bytes.decode("utf-8").replace("\r\n", "\n")
open("Output.txt", "w").write(String) 
```

将复制您的原始文件。

* * *

## 回答 #16

> 赞同：5
> 
> 时间：2014-01-11T07:15:18.300

从*[sys — 系统特定的参数和功能](http://docs.python.org/3/library/sys.html)*：

要从/向标准流写入或读取二进制数据，请使用底层二进制缓冲区。例如，要将字节写入标准输出，请使用`sys.stdout.buffer.write(b'abc')`.

* * *

## 回答 #17

> 赞同：5
> 
> 时间：2019-08-07T14:15:31.163

对于“运行 shell 命令并将其输出作为文本而不是字节”的*特定*[`subprocess.run`](https://docs.python.org/3/library/subprocess.html#subprocess.run)情况，在 Python 3.7 上，您应该使用并传入`text=True`（以及`capture_output=True`捕获输出）

```
command_result = subprocess.run(["ls", "-l"], capture_output=True, text=True)
command_result.stdout  # is a `str` containing your program's stdout 
```

`text`曾经被称为`universal_newlines`，并在 Python 3.7 中被更改（嗯，别名）。如果要支持 3.7 之前的 Python 版本，请传入`universal_newlines=True`而不是`text=True`

* * *

## 回答 #18

> 赞同：4
> 
> 时间：2021-07-09T02:09:41.513

用 解码`.decode()`。这将解码字符串。传入`'utf-8'`) 作为内部的值。

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2018-06-03T22:44:45.393

```
def toString(string):    
    try:
        return v.decode("utf-8")
    except ValueError:
        return string

b = b'97.080.500'
s = '97.080.500'
print(toString(b))
print(toString(s)) 
```

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2019-06-01T02:30:56.067

如果要转换任何字节，而不仅仅是转换为字节的字符串：

```
with open("bytesfile", "rb") as infile:
    str = base64.b85encode(imageFile.read())

with open("bytesfile", "rb") as infile:
    str2 = json.dumps(list(infile.read())) 
```

然而，这不是很有效。它将一张 2 MB 的图片变成 9 MB。

* * *

## 回答 #21

> 赞同：3
> 
> 时间：2020-01-19T08:19:02.080

试试这个

```
bytes.fromhex('c3a9').decode('utf-8') 
```

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2021-05-18T19:07:58.637

尝试使用这个；此函数将忽略所有非字符集（如`utf-8`）二进制文件并返回一个干净的字符串。它经过测试`python3.6`及以上。

```
def bin2str(text, encoding = 'utf-8'):
    """Converts a binary to Unicode string by removing all non Unicode char
    text: binary string to work on
    encoding: output encoding *utf-8"""

    return text.decode(encoding, 'ignore') 
```

在这里，该函数将获取二进制文件并对其进行解码（使用 python 预定义的字符集将二进制数据转换为字符，并且该`ignore`参数忽略二进制文件中的所有非字符集数据，并最终返回您想要的`string`值。

如果您不确定编码，请使用`sys.getdefaultencoding()`获取设备的默认编码。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2022-02-23T12:52:03.080

`bytes.decode(encoding='utf-8', errors='strict')` 我们可以使用For 文档解码字节对象以生成字符串。点击[这里](https://docs.python.org/3/library/stdtypes.html#bytes.decode)

`Python3`例子：

```
byte_value = b"abcde"
print("Initial value = {}".format(byte_value))
print("Initial value type = {}".format(type(byte_value)))
string_value = byte_value.decode("utf-8")
# utf-8 is used here because it is a very common encoding, but you need to use the encoding your data is actually in.
print("------------")
print("Converted value = {}".format(string_value))
print("Converted value type = {}".format(type(string_value))) 
```

输出：

```
Initial value = b'abcde'
Initial value type = <class 'bytes'>
------------
Converted value = abcde
Converted value type = <class 'str'> 
```

注意：在 Python3 中，默认编码类型是`utf-8`. 所以，`<byte_string>.decode("utf-8")`也可以写成`<byte_string>.decode()`

# java - 静态变量和方法

> ID：606196
> 
> 赞同：3
> 
> 时间：2009-03-03T12:24:51.110
> 
> 标签：java, static-methods, static-members

我遇到了一个这样设置的类：

```
public class MyClass {

  private static boolean started = false;

  private MyClass(){
  }

  public static void doSomething(){
    if(started){
      return;
    }
    started = true;
    //code below that is only supposed to run
    //run if not started
  }
} 
```

我对静态方法的理解是，除非它们是常量并且不会更改，否则不应在其中使用类变量。相反，您应该使用参数。我的问题是为什么通过执行 MyClass.doSomething() 多次调用时这不会中断。在我看来，它不应该起作用，但确实起作用。它只会通过 if 语句一次。

那么有人可以向我解释为什么这不会中断吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-03T12:29:11.660

方法`doSomething()`和变量`started`都是静态的，所以变量只有一个副本，可以从`doSomething()`. 第一次`doSomething()`被调用，`started`是假的，所以它设置`started`为真，然后……嗯，某事。它被调用的第二次和随后的时间`started`是 true，所以它不做任何事情就返回。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-03T12:33:29.263

没有理由使用静态变量不起作用。我并不是说这是特别好的做法，但它会起作用。

应该发生的是：

1.  第一个电话被打了。类已初始化，started 为假。
2.  doSomething 被调用。if 失败并且代码绕过它。started 设置为 true 并且其他代码运行。
3.  再次调用 doSomething。if 通过并且执行停止。

需要注意的一件事是这里没有同步，因此如果在非常接近的单独线程上调用 doSomething()，每个线程都可以读取为 false，绕过 if 语句并执行工作，即存在竞争条件。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-03T12:55:55.933

给出的代码不是线程安全的。使此代码线程安全的简单方法是执行类似的操作

```
public class MyClass {

  private static AtomicBoolean started = new AtomicBoolean(false);

  private MyClass(){
  }

  public static void doSomething(){
    boolean oldValue = started.getAndSet(true);
    if (oldValue)
      return;
    }

    //code below that is only supposed to run
    //run if not started
  }
} 
```

这应该是线程安全的，因为 AtomicBoolean getAndSet 是同步的。

诚然，如果您不使用线程，这不是问题（请注意，Web 应用程序可以使用相当多的线程来处理各种请求，而您却没有意识到这一点）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-03T12:33:54.473

这不是特别好的代码——通常设计应该使用状态改变的对象实例，但它没有任何违法之处。

> 我对静态方法的理解是，除非它们是常量并且不会更改，否则不应在其中使用类变量。

您似乎已经从设计指南推断为语言功能。阅读在线提供的众多 Java 教程之一，了解该语言中实际允许的内容。您*可以*在静态方法中自由使用非最终静态字段，但这会导致程序化而不是面向对象的代码。

> 相反，您应该使用参数。

很难看出如何使用`started`参数——如果调用者知道进程已经启动，他们为什么要调用该方法？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-03T12:30:36.260

在静态方法中，您可以调用或访问同一类中的静态成员。

忽略多线程场景，第一次调用 doSomething 将使布尔静态变量为 true，因此，第二次调用将执行 if 块的代码，只是简单地退出该方法。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-03T12:37:02.797

您的静态方法正在与静态类变量对话，所以应该没问题。**您可以将其视为全局代码和全局变量，但它位于类的命名空间中。**

如果您尝试访问非静态成员变量：

```
private int foo = 0; 
```

在静态方法中，编译器会并且应该抱怨。

```
started is false - initial state.
MyClass.doSomething() - statered is now true
MyClass.doSomething() - started is STILL true

MyClass foo = new MyClass();
foo.started -> it's STILL true, because it's static
foo.doSomething() - not sure you can do this in Java, but if you can, it's be STILL TRUE! 
```

现在，上面的代码中存在线程安全问题，但除此之外，它似乎按设计工作。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-03T12:57:48.957

只要记住“静态变量是**类级**变量，所有非静态变量都是**实例**变量”的经验法则。那么你就不会有任何困惑了！

即对于静态变量，代码中对变量的所有引用都指向相同的内存位置。对于非静态变量，每当创建该类的新实例时都会完成新的内存分配（因此代码中对变量的每个引用都指向为调用类实例分配的不同内存位置）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-03T12:32:34.307

上面的代码运行良好（除非它在多线程环境中运行）。为什么你认为它应该打破？

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-03T12:33:03.430

> 我对静态方法的理解是，除非它们是常量，否则不应在其中使用类变量，并且不要更改

我猜只能访问静态成员。它不必是恒定的！

> 我的问题是为什么通过执行 MyClass.doSomething() 多次调用时这不会中断。在我看来，它不应该起作用，但确实起作用。它只会通过 if 语句一次

按照现有的逻辑。只有第一个调用运行该`//code to be run`部分

# c# - 套接字通信程序的测试

> ID：606213
> 
> 赞同：1
> 
> 时间：2009-03-03T12:32:26.613
> 
> 标签：c#, .net, testing, sockets, network-programming

我从一个简单的 UDPClient 程序开始使用套接字编程来发送一些数据。大代码片段如下：

```
using System;
using System.Text;
using System.Net;
using System.Net.Sockets;
using System.Threading;

class ShowIP
{
    public static void Main(string[] args)
    {
        string name = Dns.GetHostName();
        //name = "GSL1460";
        name = "GSL1296";
        try
        {
            IPAddress[] addrs = Dns.GetHostEntry(name).AddressList;
            foreach (IPAddress addr in addrs)
                Console.WriteLine("{0}/{1}", name, addr);

            Console.WriteLine("Started listening");
            Thread listenerThread = new Thread(new ThreadStart(StartListeningUDP));
            listenerThread.Start();

            Console.WriteLine("Started sending");
            for (int counter = 0; counter <= 3; counter++)
            {
                Thread.Sleep(1000);
                Console.WriteLine("Sending {0} time", counter.ToString());
                StartSendingUDP(addrs[0]);
            }
            Console.ReadLine();
        }
        catch (Exception e)
        {
            Console.WriteLine(e.Message);
        }
    }

    private static void StartListeningUDP()
    {
        UdpClient udpListener = null;
        IPEndPoint nwPoint = new IPEndPoint(IPAddress.Any, 12345);

        while (true)
        {
            try
            {
                udpListener = new UdpClient(12345);
                Console.WriteLine("Waiting to receive");
                Byte[] receivedBytes = udpListener.Receive(ref nwPoint);
                string receivedData = Encoding.ASCII.GetString(receivedBytes);

                Console.WriteLine("Data received : " + receivedData);
            }
            catch (Exception e)
            {
                Console.WriteLine(e.Message);
            }
            finally
            {
                udpListener.Close();
            }
        }
    }

    private static void StartSendingUDP(IPAddress clientAddress)
    {
        UdpClient udpSender = new UdpClient();
        try
        {
            Byte[] sendBytes = Encoding.ASCII.GetBytes("Say HI to Papa...");

            Console.WriteLine("Data Sent : Say HI to Papa...");
            udpSender.Send(sendBytes, sendBytes.Length, new IPEndPoint(clientAddress, 12345));
        }
        finally
        {
            udpSender.Close();
        }

    }
} 
```

该示例在本地计算机上运行良好，但无法将数据发送到 Intranet 上的另一台计算机。

在测试期间

*   我正在取消注释适当的代码以将数据发送到他的机器
*   我正在他的机器上运行接收器位
*   已检查他的机器上是否打开了所需的端口

我错过了什么吗？请建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T20:13:19.300

udpSender.Flush？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-04T14:36:11.380

UDP 侦听器可能仅在本地主机上侦听。你可以尝试更换

```
udpListener = new UdpClient(12345) 
```

在 StartListeningUDP() 中

```
udpListener = new UdpClient(new IPEndPoint(IPAddress.Any,12345)) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T14:00:33.440

I'm not a C# person, so I can't comment too much on your code, but it looks basically okay. Make sure that the IP address you're sending to is being resolved correctly to your receiving machine.

Also, see if Windows has firewalled your internet connection, and try disabling the firewall if so. And, I know that Microsoft has some ideas about "safe" code that have caused us some problems in the past. I don't have any specifics, but there might be settings in the project that keep it from being able to access the network.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-10-26T19:35:45.033

如果不做一些事情，你就不能真正通过互联网发送 UDP。你会在路上得到太多的udp过滤器。即使您将禁用防火墙，您的路由器/提供商调制解调器也可以设置为阻止它。否则 - 您的提供商服务器将阻止它。所以实际上你必须确保这个端口对 UDP 开放，就像在你的本地主机上它不会工作，除非你在防火墙中打开这个端口和/或安装环回适配器

# asp.net-mvc - 图像上的 ASP.NET MVC 未处理异常？

> ID：606219
> 
> 赞同：0
> 
> 时间：2009-03-03T12:33:39.530
> 
> 标签：asp.net-mvc, exception, http-status-code-404

当我浏览我的网站时，我无法复制异常......但我通过我的事件记录器发现了这一点（当发生未处理的异常时，它会通过电子邮件发送给我的手机）。

**这是一个例外：**

> 找不到路径“/Content/UsrImg/ImageFileName.jpg”的控制器，或者它没有实现 IController。

我认为发生的事情是谷歌（或者可能是代理服务器）缓存的图像不再存在。当试图直接转到该图像时，它会加载我写的“找不到页面”友好错误。

但是它应该在 404 错误上引发未处理的异常吗？对我来说似乎有点奇怪。也许我可以在路由中做些什么来解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-01-20T17:21:58.877

我昨天刚遇到这个问题。检查图像是否在您的服务器上。我的问题是文件的**Build Action**设置为 none，但它应该设置为**Content**。我发布网站时它不包括该文件。

您不需要更改路由，因为 Content 目录应该调用路由。

# .net - 如何在 WPF 中更改 Grid 的网格线颜色？

> ID：606220
> 
> 赞同：29
> 
> 时间：2009-03-03T12:33:45.817
> 
> 标签：.net, wpf

我有一个`Grid`（不是 DataGrid，而是一个真正的 Grid），`GridLines`设置为`True`. 如何更改网格线的颜色？XAML 中的硬编码是可以的，因为它只是出于开发原因。

```
<Grid ShowGridLines="True" /> 
```

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-03-03T17:16:27.417

抱歉，无法使用 ShowGridLines 完成 - 您需要设置包含的元素的样式。

**展品 A：**

MSDN 文档说“只有虚线可用，因为此属性旨在用作调试布局问题的设计工具，而不是用于生产质量代码。如果您希望网格内的线条，请将网格内的元素设置为具有边框。”

**图表 B - WPF 源代码：**

请注意在 System.Windows.Controls.Grid 用于绘制线条的这个密封内部类中硬编码的 Brushes.Blue 和 Brushes.Yellow。

来自 Grid.cs

```
 /// <summary>
    /// Helper to render grid lines. 
    /// </summary>
    internal class GridLinesRenderer : DrawingVisual 
    { 
        /// <summary>
        /// Static initialization 
        /// </summary>
        static GridLinesRenderer()
        {
            s_oddDashPen = new Pen(Brushes.Blue, c_penWidth); 
            DoubleCollection oddDashArray = new DoubleCollection();
            oddDashArray.Add(c_dashLength); 
            oddDashArray.Add(c_dashLength); 
            s_oddDashPen.DashStyle = new DashStyle(oddDashArray, 0);
            s_oddDashPen.DashCap = PenLineCap.Flat; 
            s_oddDashPen.Freeze();

            s_evenDashPen = new Pen(Brushes.Yellow, c_penWidth);
            DoubleCollection evenDashArray = new DoubleCollection(); 
            evenDashArray.Add(c_dashLength);
            evenDashArray.Add(c_dashLength); 
            s_evenDashPen.DashStyle = new DashStyle(evenDashArray, c_dashLength); 
            s_evenDashPen.DashCap = PenLineCap.Flat;
            s_evenDashPen.Freeze(); 
        } 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-06-03T10:58:17.807

```
var T = Type.GetType("System.Windows.Controls.Grid+GridLinesRenderer," +
    " PresentationFramework, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35");

var GLR = Activator.CreateInstance(T);
GLR.GetType().GetField("s_oddDashPen", BindingFlags.Static | BindingFlags.NonPublic).SetValue(GLR, new Pen(Brushes.Black, 1.0));
GLR.GetType().GetField("s_evenDashPen", BindingFlags.Static | BindingFlags.NonPublic).SetValue(GLR, new Pen(Brushes.Black, 1.0));

myGrid.ShowGridLines = true; 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2015-01-06T16:12:38.660

这个答案不是如何实际更改 GridLines，而是如何以一种非常简单的方式让它看起来像你所做的那样。我相信其他人有更好的方法来做到这一点，但这是我完成显示网格线的方法。

```
<Grid Height="115" Margin="0,0,0,0" ShowGridLines="False">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="220"/>
                                    <ColumnDefinition Width="220"/>
                                    <ColumnDefinition Width="200*"/> 
                                </Grid.ColumnDefinitions>
                                <Border Grid.Column="0" BorderBrush="White" BorderThickness="1">
                                </Border>
                                <Border Grid.Column="1" BorderBrush="White" BorderThickness="1">                      
                                </Border>
                                <Border Grid.Column="2" BorderBrush="White" BorderThickness="1">        
                                </Border>
                            </Grid> 
```

为您的列定义或网格定义创建一个边框，并将 Grid.Column 属性设置为您希望的任何值。然后您可以设置颜色、厚度或样式。甜美而简单。希望这对其他人有帮助！

这是这个网格的图像：

![在此处输入图像描述](https://i.stack.imgur.com/PNrs2.png)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-04-21T19:51:40.080

```
<Window.Resources>
   <SolidColorBrush x:Key="RedGridLine" Color="#FFFF4444" />
   <SolidColorBrush x:Key="BlueGridLine" Color="#554444FF"/>
</Window.Resources>

<my:DataGrid VerticalGridLinesBrush="{StaticResource RedGridLine}"
        HorizontalGridLinesBrush="{StaticResource BlueGridLine}" >
...
</my:DataGrid> 
```

参考：[http ://social.msdn.microsoft.com/Forums/en-US/wpf/thread/0202b0dd-38d9-4ad7-8576-d115922aeeec/](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/0202b0dd-38d9-4ad7-8576-d115922aeeec/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-11-08T13:54:49.553

[igalk474 答案](https://stackoverflow.com/a/10869736/1441398)的扩展，用作：

```
<FixedPage.Resources>
  <local:GridLinesRenderer x:Key="glr" StrokeColor="Black" StrokeWidth="1.0" />
</FixedPage.Resources>

...

<Grid ShowGridLines="True">
...
</Grid> 
```

本地程序集在哪里`local`，并且`FixedPage`是任何[FrameworkElement](https://msdn.microsoft.com/en-us/library/system.windows.frameworkelement(v=vs.110).aspx)。

```
using System;
using System.Reflection;
using System.Windows;
using System.Windows.Media;

namespace mynamespace.xaml {
    public class GridLinesRenderer : DependencyObject {

        public static readonly DependencyProperty StrokeWidthProperty = DependencyProperty.Register(
            "StrokeWidth", typeof(double), typeof(GridLinesRenderer), new PropertyMetadata(1.0, OnPropertyChanged)
        );

        public static readonly DependencyProperty StrokeColorProperty = DependencyProperty.Register(
            "StrokeColor", typeof(SolidColorBrush), typeof(GridLinesRenderer), new PropertyMetadata(Brushes.Black, OnPropertyChanged)
        );

        public double StrokeWidth {
            get { return (double)GetValue(StrokeWidthProperty); }
            set { SetValue(StrokeWidthProperty, value); }
        }

        public SolidColorBrush StrokeColor {
            get { return (SolidColorBrush)GetValue(StrokeColorProperty); }
            set { SetValue(StrokeColorProperty, value); }
        }

        public GridLinesRenderer() {
            OnPropertyChanged(this, new DependencyPropertyChangedEventArgs());
        }

        private static void OnPropertyChanged(DependencyObject source, DependencyPropertyChangedEventArgs e) {
            Type T = Type.GetType("System.Windows.Controls.Grid+GridLinesRenderer," +
                "PresentationFramework, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35");
            var glr = Activator.CreateInstance(T);
            Pen glrPen = new Pen(((GridLinesRenderer)source).StrokeColor, ((GridLinesRenderer)source).StrokeWidth);
            glr.GetType().GetField("s_oddDashPen", BindingFlags.Static | BindingFlags.NonPublic).SetValue(glr, glrPen);
            glr.GetType().GetField("s_evenDashPen", BindingFlags.Static | BindingFlags.NonPublic).SetValue(glr, glrPen);
        }

    }
} 
```

# python - python 正则表达式的麻烦

> ID：606221
> 
> 赞同：1
> 
> 时间：2009-03-03T12:33:45.893
> 
> 标签：python, regex

我有以下代码：

```
what = re.match("get|post|put|head\s+(\S+) ",data,re.IGNORECASE)
```

在**数据**变量中，假设我有这一行：

```
获取 some-site.com HTTP/1.0 ...
```

如果我在调试器中停止脚本，并检查**什么**变量，我可以看到它只匹配 GET。为什么它不匹配 some-site.com ？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-03T12:52:48.920

正则表达式语言运算符优先级`head\s+(\S+)`作为第四选择。*@Mykola Kharechko*的答案中的括号被安排为`head`第四个替代方案，`\s+(\S+)`并附加到与该组匹配的任何替代方案。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-03T12:38:52.200

```
 >>> re.match("(get|post|put|head)\s+(\S+) ",'GET some-site.com HTTP/1.0 ...',re.IGNORECASE).groups()
('GET', 'some-site.com')
>>> 

```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T12:59:45.863

+1 Mykola 的回答和 gimel 的解释。此外，您真的要为此使用正则表达式吗？正如您所发现的，它们并不像看起来那么简单。这是一个非基于正则表达式的方法：

```
def splitandpad(s, find, limit):
    seq= s.split(find, limit)
    return seq+['']*(limit-len(seq)+1)

method, path, protocol= splitandpad(data, ' ', 2)
if method.lower() not in ('get', 'head', 'post', 'put'):
    # complain, unknown method
if protocol.lower() not in ('http/1.0', 'http/1.1'):
    # complain, unknown protocol 
```

# vim - 将文本从 vim 复制到 windows

> ID：606224
> 
> 赞同：27
> 
> 时间：2009-03-03T12:34:49.480
> 
> 标签：vim

我正在尝试将选择的文本从 vim 复制到另一个 Windows 应用程序...例如 firefox 或记事本。但是我似乎无法使用该`y`命令执行此操作。我启用了 Windows 热键，因此通过按`ctrl-c`我可以实现这一点，但希望在 Vim 中完全摆脱这些 Windows 命令。

这可能吗？反之亦然，从 windows 复制并粘贴到 vim

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-03-10T07:28:26.537

我有

```
set clipboard=unnamed 
```

在我的 ~/.vimrc 中。然后将“yy”、“D”等直接拉到 Windows 剪贴板。它也适用于 MacVim。对于 Linux gvim，你必须记住在这些操作前加上 "+

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-03-03T12:36:45.963

我认为在 GVim 中使用 Windows 命令键没有任何害处。或者，您也可以使用热键`"+y`拉出（复制）和`"+p`粘贴到系统剪贴板和从系统剪贴板粘贴。这适用于大多数平台（在 unix 上不直接连接到 X 服务器的 Vim 实例有点困难）。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-03-03T16:48:53.067

根据上面的答案：

```
"*y
"*p 
```

使用 ctrl-v 会使在插入模式下输入控制字符变得困难，而 ctrl-v 在普通模式下是可视块，尽管 ctrl-q 也是如此。

个人发现以下非常自然和小指友好

```
vmap <a-c> "*y 
imap <a-p> "*p 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-03-03T13:40:00.900

不要使用 windows 绑定，因为那样你将无法在其他平台上的 Vim 中表现出色。

使用`"*y`- 复制到系统剪贴板。它在 Mac OS、Windows、Linux 上运行良好。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-03T22:53:02.723

如果要从窗口（或从 vim）复制，请尝试：

```
:set paste 
```

但要小心其他选项可能会被修改。一切都在：

```
:help paste 
```

希望能帮助到你。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-04-21T10:03:01.257

对于 Windows 7，您需要在以下位置编辑 vim 配置文件：

```
C:\users\<User>\vimfiles\vimrc 
```

只需将以下行添加到配置文件中：

```
set clipboard=unnamed 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-12-14T23:19:57.380

保存文件，在另一个使用标准 Windows 约定的编辑器中打开它，然后像往常一样复制和粘贴。

# python - 如何在 linux 中配置我的 sys.path 变量？

> ID：606226
> 
> 赞同：2
> 
> 时间：2009-03-03T12:35:03.473
> 
> 标签：python, linux, configuration, path

当我的用户在 linux 中运行时，我想自动将条目添加到 python 的 sys.path 变量中。我可以在我的主目录中调整一些东西来完成它吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-03T12:49:36.853

环境变量[`PYTHONPATH`](http://docs.python.org/tutorial/modules.html#the-module-search-path)设置初始`sys.path`值。

您可以将其设置为您的 shell 初始化脚本（例如`.bashrc`或`.cshrc`）

# encoding - 对 vb 脚本进行编码

> ID：606227
> 
> 赞同：0
> 
> 时间：2009-03-03T12:35:11.257
> 
> 标签：encoding, vbscript

如何编码vb脚本，让别人看不到里面的代码

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T12:40:35.753

看着

[http://www.microsoft.com/technet/scriptcenter/resources/qanda/mar06/hey0309.mspx](http://www.microsoft.com/technet/scriptcenter/resources/qanda/mar06/hey0309.mspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T12:57:36.587

其他张贴者（明智地）向您指出了 Microsoft Script Encoder 的方向，但以防万一您有一种错误的安全感，您需要了解对您的 scipts 进行取消编码也是相当简单的：

[http://www.aspheute.com/english/20011123.asp](http://www.aspheute.com/english/20011123.asp)
[http://www.greymagic.com/security/tools/decoder/](http://www.greymagic.com/security/tools/decoder/)

显然，编码器会吓跑一个随便的浏览器。如果您确实需要隐藏某些内容，则需要采取其他措施，例如，将代码包装在 ActiveX DLL 中（但即使这些也可以反汇编）。

可能有点矫枉过正，但值得一提。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T12:37:43.700

[微软脚本编码器](http://www.microsoft.com/downloads/details.aspx?familyid=E7877F67-C447-4873-B1B0-21F0626A6329&displaylang=en)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-05T16:06:52.323

Many of the popular scripting ISE's include a way to compile scripts so that the code is encrypted, but it also helps by packing the engine with the code which helps if you run it on a system that doesn't have the same version, or possibly doesn't have the same script engine. I would recommend something like AdminScriptEditor or PrimalScript

# wix - 在添加/删除程序中有多个条目的 WIX 安装程序

> ID：606228
> 
> 赞同：1
> 
> 时间：2009-03-03T12:35:15.890
> 
> 标签：wix, windows-installer, wix3

我正在使用 WIX 为应用程序套件开发安装程序，结构如下：
**应用程序核心
    |_ _ Flavor1
    |_ _ Flavor2
    |_ _ Flavor3**

Application Core 是一个类似 Visual Studio 的产品，Flavor 1,2,3 是它的子产品。

这是我的问题，
- 在添加删除程序中，应用程序核心、Flavor1、Flavor2 和 Flavor3 应该有 4 个条目。
- 我应该能够重新启动安装程序以添加/删除 Flavor1、Flavor2 和 Flavor3。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-04T00:00:46.787

**更新：**请注意，虽然 Office*似乎*安装了单独的功能，而不是单独的产品 - 它实际上安装了许多不显示在 ARP 中的单独产品。添加了一个单独的 ARP 条目以启动引导程序安装程序，然后维护添加、删除和更新您在 ARP 中看不到的现有产品。

这些应该是功能，而不是单独的产品。以 Microsoft Office 套件为例，如果您安装该套件，那么您在“添加/删除程序”中只有一个条目，而 Word、Excel、Powerpoint 等都只是 Microsoft Office 的“功能”，您可以通过这种方式对其进行更新。

但是，您可以使用它们自己的安装程序单独购买其中一些应用程序，在这些情况下，您所说的“应用程序核心”包含在每个安装程序中，使用共享组件，因此文件不需要安装两次，每个应用程序都可以彼此独立安装/卸载。

[以下是关于组件和功能](http://msdn.microsoft.com/en-us/library/aa368003(VS.85).aspx)的 Windows Installer 文档的一小段摘录（您可能还想阅读将[应用程序组织成组件](http://msdn.microsoft.com/en-us/library/aa370561(VS.85).aspx)）

> 共享相同组件 ID 的两个组件被视为同一组件的多个实例，而不管它们的实际内容如何。用户计算机上仅安装任何组件的单个实例。因此，几个功能或应用程序可能共享一些组件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T19:00:00.037

通常这是通过安装一个产品来完成的，因此添加/删除程序中的一个条目，您可以修改（选择产品，单击修改按钮）。然后将您带到功能树，您可以在其中添加或删除功能。

如果单独的条目是硬性要求，则应创建多个 MSI。但是你可以在你的例子中卸载“应用程序核心”，保持其他人安装，从而导致口味问题

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T15:15:42.357

听起来您确实想要功能，所以 Sander 得到了我的 +1。

但有时您可能希望对同一产品进行不同的安装，例如在同一台服务器上安装培训和测试版本。在这些情况下，您需要找到一种不同的方法，[这是](https://stackoverflow.com/questions/471424/wix-tricks-and-best-practices)我想出的一种方法（请参阅答案*Create Live, ...*）。请注意有关为每个文件创建组件和通配符的 guid 的编辑，因为这简化了过程，即不需要 BeforeBuild/AfterBuild 技巧。

# rss - 搜索一个开源 RSS 组件，有什么建议吗？

> ID：606229
> 
> 赞同：0
> 
> 时间：2009-03-03T12:35:32.287
> 
> 标签：rss

我正在搜索要在我的项目中使用的开源 RSS 组件（.Net 3.5、C#）。我找到了 ASP.Net RSS 工具包：[http](http://aspnetrsstoolkit.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=3674) ://aspnetrsstoolkit.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=3674 。你知道组件的优缺点吗？您能否建议一个更好的开源 RSS 组件，如果可以，建议的组件的优缺点是什么？

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-01T20:33:57.457

还有[Argotic Syndication Framework](http://www.codeplex.com/Argotic)。我可能会选择那个而不是你命名的那个，但两者都应该做你需要的。

# sql - 从多个表中选择 count(*)

> ID：606234
> 
> 赞同：274
> 
> 时间：2009-03-03T12:37:06.900
> 
> 标签：sql, oracle, count

我如何`count(*)`从两个不同的表中进行选择（调用它们`tab1`和`tab2`），结果是：

```
Count_1   Count_2
123       456 
```

我试过这个：

```
select count(*) Count_1 from schema.tab1 union all select count(*) Count_2 from schema.tab2 
```

但我只有：

```
Count_1
123
456 
```

* * *

## 回答 #1

> 赞同：392
> 
> 时间：2009-03-03T12:39:19.360

```
SELECT  (
        SELECT COUNT(*)
        FROM   tab1
        ) AS count1,
        (
        SELECT COUNT(*)
        FROM   tab2
        ) AS count2
FROM    dual 
```

* * *

## 回答 #2

> 赞同：93
> 
> 时间：2009-03-03T12:45:16.163

作为附加信息，要在 SQL Server 中完成同样的事情，您只需删除查询的“FROM dual”部分。

* * *

## 回答 #3

> 赞同：52
> 
> 时间：2009-03-03T16:51:29.737

只是因为它略有不同：

```
SELECT 'table_1' AS table_name, COUNT(*) FROM table_1
UNION
SELECT 'table_2' AS table_name, COUNT(*) FROM table_2
UNION
SELECT 'table_3' AS table_name, COUNT(*) FROM table_3 
```

它给出了转置的答案（每表一行而不是一列），否则我认为它没有太大不同。我认为在性能方面它们应该是等效的。

* * *

## 回答 #4

> 赞同：35
> 
> 时间：2009-03-03T12:45:31.387

我的经验是使用 SQL Server，但你能做到：

```
select (select count(*) from table1) as count1,
  (select count(*) from table2) as count2 
```

在 SQL Server 中，我得到了你想要的结果。

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2009-03-03T20:25:18.663

其他略有不同的方法：

```
with t1_count as (select count(*) c1 from t1),
     t2_count as (select count(*) c2 from t2)
select c1,
       c2
from   t1_count,
       t2_count
/

select c1,
       c2
from   (select count(*) c1 from t1) t1_count,
       (select count(*) c2 from t2) t2_count
/ 
```

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2017-06-02T22:07:27.550

```
 select 
    t1.Count_1,t2.Count_2
    from 
(SELECT count(1) as Count_1 FROM tab1) as t1, 
(SELECT count(1) as Count_2 FROM tab2) as t2 
```

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2009-03-03T12:41:10.760

一个快速的尝试想出了：

```
Select (select count(*) from Table1) as Count1, (select count(*) from Table2) as Count2 
```

注意：我在 SQL Server 中对此进行了测试，因此`From Dual`没有必要（因此存在差异）。

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2009-08-27T12:45:20.157

为了完整起见 - 此查询将创建一个查询，为您提供给定所有者的所有表的计数。

```
select 
  DECODE(rownum, 1, '', ' UNION ALL ') || 
  'SELECT ''' || table_name || ''' AS TABLE_NAME, COUNT(*) ' ||
  ' FROM ' || table_name  as query_string 
 from all_tables 
where owner = :owner; 
```

输出类似于

```
SELECT 'TAB1' AS TABLE_NAME, COUNT(*) FROM TAB1
 UNION ALL SELECT 'TAB2' AS TABLE_NAME, COUNT(*) FROM TAB2
 UNION ALL SELECT 'TAB3' AS TABLE_NAME, COUNT(*) FROM TAB3
 UNION ALL SELECT 'TAB4' AS TABLE_NAME, COUNT(*) FROM TAB4 
```

然后你可以运行它来获得你的计数。有时它只是一个方便的脚本。

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2009-03-05T10:09:26.007

因为我看不到任何其他答案提出这个问题。

**如果**您不喜欢子查询**并且**每个表中都有主键，您可以这样做：

```
select count(distinct tab1.id) as count_t1,
       count(distinct tab2.id) as count_t2
    from tab1, tab2 
```

但在性能方面，我相信 Quassnoi 的解决方案更好，也是我会使用的解决方案。

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2009-07-31T04:56:49.587

下面是我的分享

**选项 1 - 从不同表的相同域计数**

```
select distinct(select count(*) from domain1.table1) "count1", (select count(*) from domain1.table2) "count2" 
from domain1.table1, domain1.table2; 
```

**选项 2 - 从同一个表的不同域计数**

```
select distinct(select count(*) from domain1.table1) "count1", (select count(*) from domain2.table1) "count2" 
from domain1.table1, domain2.table1; 
```

**选项 3 - 使用“联合所有”从不同域对同一个表进行计数以具有计数行**

```
select 'domain 1'"domain", count(*) 
from domain1.table1 
union all 
select 'domain 2', count(*) 
from domain2.table1; 
```

享受 SQL，我总是这样做 :)

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2009-07-09T07:01:03.300

`SELECT (SELECT COUNT(*) FROM table1) + (SELECT COUNT(*) FROM table2) FROM dual;`

* * *

## 回答 #12

> 赞同：6
> 
> 时间：2009-03-03T12:39:54.817

```
select (select count(*) from tab1) count_1, (select count(*) from tab2) count_2 from dual; 
```

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2009-03-03T12:47:27.623

如果表（或至少一个键列）属于同一类型，只需先进行联合然后计数。

```
select count(*) 
  from (select tab1key as key from schema.tab1 
        union all 
        select tab2key as key from schema.tab2
       ) 
```

或者把你的satement放在它周围再放一个sum()。

```
select sum(amount) from
(
select count(*) amount from schema.tab1 union all select count(*) amount from schema.tab2
) 
```

* * *

## 回答 #14

> 赞同：5
> 
> 时间：2017-04-28T12:11:30.340

```
--============= FIRST WAY (Shows as Multiple Row) ===============
SELECT 'tblProducts' [TableName], COUNT(P.Id) [RowCount] FROM tblProducts P
UNION ALL
SELECT 'tblProductSales' [TableName], COUNT(S.Id) [RowCount] FROM tblProductSales S

--============== SECOND WAY (Shows in a Single Row) =============
SELECT  
(SELECT COUNT(Id) FROM   tblProducts) AS ProductCount,
(SELECT COUNT(Id) FROM   tblProductSales) AS SalesCount 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2016-08-03T19:14:06.743

```
Declare @all int
SET @all = (select COUNT(*) from tab1) + (select count(*) from tab2)
Print @all 
```

或者

```
SELECT (select COUNT(*) from tab1) + (select count(*) from tab2) 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2015-08-16T05:35:20.020

加入不同的表

```
SELECT COUNT(*) FROM (  
SELECT DISTINCT table_a.ID  FROM table_a JOIN table_c ON table_a.ID  = table_c.ID   ); 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2021-12-28T10:39:32.353

```
SELECT  (
        SELECT COUNT(*)
        FROM   tbl1
        )
        +
        (
        SELECT COUNT(*)
        FROM   tbl2
        ) 
    as TotalCount 
```

* * *

## 回答 #18

> 赞同：-1
> 
> 时间：2017-05-24T20:11:04.770

select (select count( *) from tab1 where `field`like 'value') + (select count(* ) from tab2 where `field`like 'value') count

* * *

## 回答 #19

> 赞同：-2
> 
> 时间：2011-06-24T10:46:03.227

```
select @count = sum(data) from
(
select count(*)  as data from #tempregion
union 
select count(*)  as data from #tempmetro
union
select count(*)  as data from #tempcity
union
select count(*)  as data from #tempzips
) a 
```

# c# - WPF RichTextBox 不删除文本

> ID：606240
> 
> 赞同：0
> 
> 时间：2009-03-03T12:39:36.457
> 
> 标签：c#, wpf

我正在尝试取消（阻止）RichTextBox 中的一些文本编辑。我正在使用 TextChanged 事件，但我没有找到如何取消或回滚某些更改的方法，有什么想法吗？

```
private void mainRTB_TextChanged(object sender, TextChangedEventArgs e)
        {
            TextRange text = new TextRange(mainRTB.Document.ContentStart, mainRTB.Document.ContentEnd);
            if (text.Text.Length >= this.MaxLenght)
            {
                mainRTB.Document.ContentEnd.DeleteTextInRun(-1);
                mainRTB.IsReadOnly = true;
            }
} 
```

通过执行 mainRTB.Document.ContentEnd.DeleteTextInRun(-1); 不删除任何文本。

mainRTB -> System.Windows.Controls.RichTextBox

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T13:30:46.740

我不相信有办法阻止编辑，因为只有 ChangedEvent 并且没有 Changed 或 PreviewChange 事件。不过，您可以尝试撤消更改。

```
private void mainRTB_TextChanged(object sender, TextChangedEventArgs e)  {
            TextRange text = new TextRange(mainRTB.Document.ContentStart, mainRTB.Document.ContentEnd);
            if (text.Text.Length >= this.MaxLenght && mainRTB.CanUndo)
            {
                mainRTB.Undo();
                mainRTB.IsReadOnly = true;
            }
} 
```

# c# - 多个 Regex.Replace 或 or'ed 模式？

> ID：606252
> 
> 赞同：1
> 
> 时间：2009-03-03T12:42:14.203
> 
> 标签：c#, regex

又是一个正则表达式问题。

什么更有效率？级联许多 Regex.Replace 与每个特定模式搜索或仅一个 Regex.Replace 与 or'ed 模式 (pattern1|pattern2|...)？

提前致谢， 法比安

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T12:51:24.963

我的回答很烂，但是：这取决于。你有多少？您节省的几毫秒真的会有所作为吗？哪种解决方案最易读、最容易维护、最具可扩展性？

根据您手头的具体要求尝试这两种方法，您会看到的。你可能会感到惊讶。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T12:56:54.200

完全取决于模式和实现逻辑 - 如果简单（我想大多数现实世界的情况都是如此），正则表达式会更快，如果可能是复杂的多个操作，但如果这是一个真正重要的情况，基准测试就是答案。

否则它会相对如此接近你不应该关心，过早优化等等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T13:12:08.923

这取决于您的文本有多大以及您期望的匹配数。如果可能的话，在正则表达式的前面放置一个文本文字或锚点（例如 ^）。.NET Regex 引擎将对此进行优化，以便它使用快速 Boyer-Moore 算法（可以跳过字符）而不是查看每个字符的标准 IndexOf 来搜索该文本。如果您在前面有多个带有文字文本的模式，则可以进行优化以创建一组可能的起始字符。所有其他人都会很快被忽略。

一般来说，您可能需要考虑阅读[Mastering Regular Expressions](https://rads.stackoverflow.com/amzn/click/com/0596528124)，其中重点介绍了一般优化以获得更好性能的想法（尤其是第 6 章）。

我想说如果你把所有东西都放在一个正则表达式中，你可能会获得更快的性能，但是首先把最有可能的选项放在第一位，然后是第二个最有可能的选项，等等。要注意的第一件事是回溯。如果你做类似的事情

```
".*" 
```

要匹配带引号的字符串，请意识到一旦找到第一个 "，那么默认情况下它总是会走到行尾，然后开始备份，直到找到另一个 "。

[Mastering Regular Expressions](https://rads.stackoverflow.com/amzn/click/com/0596528124)这本书深入探讨了如何避免这种情况。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-08-25T08:23:59.027

我很惊讶您的基准测试显示使用多个单独的表达式更快，我很想看看您正在使用的正则表达式的示例。基本的正则表达式（即没有像回溯这样的高级功能）可以编译为“有限状态机”，其速度相对于正在搜索的字符串的长度为 O(n)，与模式的长度*无关*。因此，运行 10 个不同的正则表达式平均需要比使用“|”组合这些模式的单个正则表达式长 10 倍。

（我知道这是 3 月份的一个老问题，但我忍不住加了 2 美分 :)

# windows-vista - 如何使用 VBScript 在 Windows Vista 中创建用户帐户？

> ID：606258
> 
> 赞同：0
> 
> 时间：2009-03-03T12:45:30.313
> 
> 标签：windows-vista, vbscript

如何使用[VBScript](http://en.wikipedia.org/wiki/VBScript)在 Windows Vista 中创建用户帐户？

我正在使用以下脚本。它在 Windows XP 上运行良好，但在 Windows Vista 上给我一个错误：

```
strUserName = "username"
strPassword = "password"
strComputer = "."
set objSystem = GetObject("WinNT://" & strComputer)
set objUser = objSystem.Create("user", strUserName)
objUser.SetPassword strPassword
objUser.SetInfo 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T12:52:11.153

我可以在我的 Vista 机器上运行这个脚本就好了，它会创建用户。

我怀疑这是UAC问题？

[Vista 的 UAC：如何提升脚本（VBScript 和 JScript）](http://4sysops.com/archives/vista%E2%80%99s-uac-how-to-elevate-scripts-vbscript-and-jscript/)

# c# - 通过示例学习构建真实世界的 .NET 应用程序

> ID：606262
> 
> 赞同：6
> 
> 时间：2009-03-03T12:46:04.867
> 
> 标签：c#, .net

在过去的 4 年里，我主要从事 SQL 和前端 HTML/CSS 的工作。我也用类似 BASIC 的语言完成了相当多的（程序）编码。我没有接受过正式的 CS 培训（我有经济学位）。

现在，我将在 C# .NET 中全职切换到 OOP。为了提高速度，我主要在 StackOverflow 和 Wikipedia 上阅读基本的 CS 主题（例如，数据结构、算法、大 O 表示法）。我还通读了 Code Complete 2、Refactoring 和 Head First Design Patterns 部分。

然而，我有一种感觉，我成为开发人员的方法有些倒退。我觉得我需要先熟悉 C# 和 .NET 中的可用工具，*然后*才能真正从学习如何最好地应用它们中受益。

我认为我缺少的部分是坐下来通过实际进行一些编程来熟悉 .NET 框架。我需要接触构建真实应用程序的日常任务。

由于我没有导师，我想知道是否有人可以推荐一本书或网站来指导初学者程序员通过构建（有点）真正的 .NET 应用程序来教授他们基础知识。

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-03T12:49:31.923

[http://www.asp.net/learn/mvc-videos/](http://www.asp.net/learn/mvc-videos/)

店面涵盖从设计到测试的所有内容。应该让你快速入门。

[http://codebetter.com/blogs/karlseguin/archive/2008/06/24/foundations-of-programming-ebook.aspx](http://codebetter.com/blogs/karlseguin/archive/2008/06/24/foundations-of-programming-ebook.aspx)

展示了一些基本概念，但它们非常有用。包括一个可供学习的示例应用程序。

最后，

[http://weblogs.asp.net/Scottgu/](http://weblogs.asp.net/Scottgu/)

ScottGu 的博客充满了实用的真实示例，并且有大量链接。

还有一点需要注意的是，如果您不熟悉 OO，BlueJ 这本书提供了一些对 OO 的深刻见解。

[http://www.bluej.org/](http://www.bluej.org/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-02T15:03:33.723

我和你处于类似的位置，正在寻找专业人士如何从头到尾设计和实施一个小程序。我发现了这两个有用的资源：

Rob Conery 有[一系列博客文章](http://blog.wekeroad.com/category/mvc-storefront/page/4)，他将带您了解他如何使用 ASP.NET MVC 设计电子商务网站。

以类似的方式，Stephen Walther使用 ASP.NET MVC[构建了一个论坛](http://stephenwalther.com/blog/archive/2008/09/05/asp-net-mvc-application-building-forums-1-create-the-perfect-application.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-02T15:28:35.440

由于大多数公司像黄金一样保护他们的软件工件（设计、测试等），因此很难通过阅读获得真实世界的体验。然而，有时公司会将他们在技术方面的经验作为案例研究发表。其中一些案例研究只不过是营销废话。但有时，您会发现信息的金矿，让您深入了解现实世界的项目。Barnes & Nobles 的这个关于开发新数据仓库的[案例研究在一定程度上做到了这一点。](http://www.google.com/url?sa=t&source=web&ct=res&cd=3&url=http%3A%2F%2Fdownload.microsoft.com%2Fdownload%2F7%2F7%2F2%2F7721c03b-717e-4f14-a4be-fe6bb40c5a5a%2Fbarnes_noble.pdf&ei=9WT8SbalD9y9twfv5Z3CCg&usg=AFQjCNFJ7dyvZzQqUVCnKj9A7mTclY026Q&sig2=JlAc3JEwXa35A2gRopAAFQ)以下是更多列表： [ASP .Net 案例研究](http://msdn.microsoft.com/en-us/asp.net/aa336563.aspx) [.Net 案例研究](http://www.microsoft.com/net/CaseStudies.aspx)

Ultimately, software development is driven by business needs and that's where your Econ background could come in handy. Check out the book [Return on Software: Maximizing the Return on Your Software Investment](https://rads.stackoverflow.com/amzn/click/com/0321228758) by Steven Tockey when you get the chance. He goes into things like ROI, IRR, etc. Things only an Econ major could love :)

# c# - 如何将方法的字符串参数从一个类传递到同一命名空间中的另一个类？

> ID：606263
> 
> 赞同：0
> 
> 时间：2009-03-03T12:46:17.127
> 
> 标签：c#, winforms, class

有点傻的问题，但被卡住了很长时间。我编写了两个类，一个是 Form（TreeDisplay 类），另一个包含业务逻辑（MyTreeNode 类）。TreeDisplay 类包含用于选择文件的浏览按钮，并将其传递给 MyTreeNode 类中的方法 *initiatingTree(string filename)*。
现在我必须将此字符串参数文件名传递给 MyTreeNode 类。当我运行我的代码时，我选择的 XML 文件显示在文本框中，但不在树视图中。
我已经编写了部分代码，但它正在抛出 NullReferenceException（对象引用未设置为对象的实例）。当整个代码编写在 Form.cs 中时，代码运行成功，但在分离业务逻辑时发生了异常。你能告诉我我哪里错了吗？

这是 TreeDisplay 类的浏览按钮中的代码（我的主窗体）：

```
if (open.ShowDialog(this) == DialogResult.OK)
        {
            txtFileName.Text = open.FileName;
            MytreeNodeClass treenodeClass = new MytreeNodeClass();
            treenodeClass.initiatingTree(open.FileName,treeView1); 
        } 
```

这是 MyTreeNode 类中的 initiatingTree() 代码：

```
public class MytreeNodeClass
{

    private readonly System.Windows.Forms.TextBox txtFileName;
    private TreeView treeView1;
    private readonly ToolStripStatusLabel toolStripStatusLabel1;

   public string Filename
    {
        get { return filename; }
    }
    protected string filename;

    public MytreeNodeClass()
    {
    }

    public void initiatingTree(string nameofFile,TreeView treeView1)
    {
        try
        {
            //Create XML document & load the XML file.
            XmlDocument xmlDocument = new XmlDocument();
            xmlDocument.Load(nameofFile);
            treeView1 = new System.Windows.Forms.TreeView();
            treeView1.Nodes.Clear();

            if (xmlDocument.DocumentElement != null)
            {
                TreeNode treeNodedoc = new TreeNode(xmlDocument.DocumentElement.Name);

                treeView1.Nodes.Add(treeNodedoc);
            } 
```

在使用断点 treeView1.Nodes.Clear() 时，代码从这一行出来并进入抛出 NullReferenceException 的 catch 块。

请帮助找到异常的根本原因。谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-03T12:49:48.007

断点处 treeView1 的值是多少？

我建议这可能为空，因为该参考在您的业务逻辑层中不可用。

* * *

更新了示例代码：

```
public void initiatingTree(string nameofFile, TreeView treeView1)
{
    try
    {
        //Create XML document & load the XML file.
        XmlDocument xmlDocument = new XmlDocument();
        xmlDocument.Load(nameofFile);

        treeView1.Nodes.Clear();

        if (xmlDocument.DocumentElement != null)
        {
            TreeNode treeNodedoc = new TreeNode(xmlDocument.DocumentElement.Name);

            treeView1.Nodes.Add(treeNodedoc);
        }
    }
} 
```

你称之为：

```
if (open.ShowDialog(this) == DialogResult.OK)
{
    txtFileName.Text = open.FileName;
    MytreeNodeClass treenodeClass = new MytreeNodeClass();
    treenodeClass.initiatingTree(open.FileName, treeView1); 
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T13:31:27.660

正如ck所说。

作为标准，您无权从业务层访问用户控件。为了简单起见，我建议您将控制代码保留在后面的 gui 代码中。

如何对代码进行排序的示例

（GUI 层）用于控制交互的代码隐藏
用于数据操作的业务层
用于数据库操作等的数据层

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T13:04:05.570

在访问它之前初始化 treeView1 对象。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T13:10:28.317

我猜你是复制粘贴的吧？

无论如何，这里有一点注意事项：当您在 VS Designer 中拖动表单上的控件时，vs 会“通常在 InitializeComponent() 中”为这些控件生成代码。VS 在您的类（例如 form1.cs）中编写引用，如下所示：

```
private System.Windows.Forms.TreeView treeView1; 
```

这只是声明一个 System.Windows.Forms.TreeView 类型的变量，这个变量（本身）存储在堆栈中，因为它只是一个引用，一个直到现在还没有指向任何实际堆对象的引用（即 NullReference） . 现在这个引用是无用的，除非你初始化它并告诉它指向堆上的真实对象，否则你不能使用它，这就是 VS 在设计器中为你所做的，它只是将下一行添加到 InitializComponents：

```
this.treeView1 = new System.Windows.Forms.TreeView(); 
```

这是您忘记复制到另一个类的行，它使您的引用未初始化（即仍然为 NullReference），因此当您尝试使用它时，会引发 NullReferenceException。我想这是你的问题，或者至少这是我能理解的。如果我没能理解你，请原谅我！

# asp.net - 是否存在从 ASP.NET 中的 DataTable 获取数据的现有 DataSource？

> ID：606265
> 
> 赞同：0
> 
> 时间：2009-03-03T12:48:00.273
> 
> 标签：asp.net, datasource, in-memory

我正在制作一个 ASP.NET Web 窗体应用程序。我想获得一个从 DataTable 中获取数据的 DataSource，并且该表在请求中持久化（最好在会话中，而不是 ViewState 中）。

这个想法是需要一些相当复杂的表格，其中每个表格都有几个网格视图。所有的网格视图都必须具有编辑功能（我们使用的是 DevExpress），但表单上必须有一个巨大的“保存”按钮，它可以保存所有内容。

因此，如果我能获得某种可以绑定这些 GridView 并且仅将数据存储在内存中的 DataSource，那就太好了。当用户单击“保存”按钮时，我将手动查询这些数据源并从中提取更改的数据。

是否存在为此，或者我必须自己编写（似乎是一项相当大的任务）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-03T13:13:29.653

您描述的场景；

1.  从数据源中检索数据并存储在数据表中
2.  以会话状态存储数据表。
3.  从不同的网格修改数据表

听起来它会起作用，我可以看到您遇到的问题是当数据更改时您必须在网格之间重新加载数据。您必须编写一个在对数据表进行更改时引发事件的类（您可能还希望将其包含在类中，并将类对象存储在会话状态中）。

我希望数据表不要太大......因为这不是我为网络应用程序采用的那种方法。

# c# - 从非托管 C++ mfc active x dll 启动 C# 对话框

> ID：606270
> 
> 赞同：1
> 
> 时间：2009-03-03T12:49:43.500
> 
> 标签：c#, c++, activex, unmanaged

有人告诉我用 C# 编写一个对话框，该对话框必须从非托管 c++ dll 实例化。我们在代码的其他地方执行此操作，只需将托管 c++ 类添加到 C++ 项目，然后从托管 c++ 类调用 C# dll。但是，我发现从我必须这样做的地方对我不起作用。我认为因为 c++ dll 是一个 MFCActiveX 项目。一旦我在此项目中的任何文件上设置了 clr，它将不再正确注册。当我尝试注册它时，我收到三个错误，然后是它注册的消息。但是，当我尝试使用它时，我得到一个 0x80040111“ClassFactory 无法提供请求的类”错误。如果有人知道这里的问题是什么，我将不胜感激。我要么需要能够完成这个（首选），要么证明这是不可能的。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-03T13:20:00.433

您现在必须使用“regasm”而不是“regsvr32”注册它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T13:22:15.420

我看不出 MFCActiveX 项目如何阻止您以这种方式创建 C# 类。除非它根本不允许添加托管类。

如果您无法使托管 C++ 类技巧发挥作用，另一种选择是使用 COM。可以在 C# 项目中将各种工厂注册为 COM 对象。说给它下面的界面

```
[ComVisible(true)]
[Guid("babe87fc-1467-4913-a1d3-47eeedf1afb5")]
public interface IDialogFactory {
  void Create(); 
} 
```

您还必须创建一个支持类。但是您可以注册托管程序集并使用 COM 访问它。

# language-agnostic - 在网站访问之间安全地存储凭据

> ID：606282
> 
> 赞同：3
> 
> 时间：2009-03-03T12:53:53.490
> 
> 标签：language-agnostic, password-storage

我正在建立一个网站，允许用户创建帐户并访问该网站的内容。我不希望用户在每次访问该站点时都登录，因此我计划将用户名和密码存储在 cookie 中——但是，我听说这是一种不好的做法，即使密码是经过哈希处理的饼干。

我应该遵循哪些“最佳实践”才能在访问我的网站之间安全地记住用户凭据？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-11T10:37:59.240

永远不要那样做。公开乱扔密码。

最安全的方法：

将用户名存储在数据库中，在同一行中存储随机生成的盐值，在同一行中存储包含盐的密码的哈希校验和。将另一个表用于引用具有用户凭据的表的会话。当用户登录时，您可以在会话表中插入您希望会话到期的日期（例如 15 天后）。将会话 ID 存储在 cookie 中。

下次用户登录时，您将获得密码，为用户添加盐，获取哈希，将其与您拥有的进行比较。如果它们匹配，则通过在会话表中插入一行并在 cookie 中发送会话 ID 来打开会话。您可以通过此cookie检查用户是否已登录以及是哪个用户。

编辑：

这种方法是大多数网站上最流行的方法。它在安全和实用之间取得了很好的平衡。

您不只是对会话 ID 使用自动增量值。您可以使用一些难以重复的复杂校验和来实现。例如连接用户名、时间戳、盐、另一个随机盐，并从中生成一个 md5 或 sha 校验和。

为了在网站/服务中实现涉及用户凭据的功能，客户端和服务器之间通常会进行一些与凭据相关的数据交换。这会将数据暴露给中间攻击者等。此外，cookie 存储在用户硬盘中。没有任何方法可以 100% 安全。

如果您想要额外的安全性，您可以让您的网站通过 https。这将防止人们使用中间人攻击窃取 cookie 和密码。

笔记：

将 IP 地址混入其中并不是一个好主意。大多数情况下，多个客户端将通过 NAT 等来自同一个 IP 地址。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T12:59:53.367

您不需要存储密码，只需存储您的应用程序可以解释为他们的用户的标识符。

您需要注意的事项：

*   如果 cookie 被复制，其他用户是否能够伪装成该用户
*   用户不应该能够构造一个 cookie 来将他们认证为另一个用户

处理这些问题的一种可能解决方案是为每个用户创建一个一次性密钥，该密钥在他们下次使用应用程序时更改。

您可能永远无法完全安全地记住用户，因此只有在不涉及敏感数据的情况下才应该使用它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-11T10:08:08.627

任何形式的密码都不应该存储在 cookie 中。Cookie 很容易被盗。

一些浏览器已经支持保存密码。为什么不让用户使用它呢？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T13:18:49.843

在 cookie 中存储用户名的哈希可以提供这种“记住我”的功能。

但是，对于系统的敏感区域，您需要知道用户在缓存凭据上进入系统，以便您可以在让他们造成任何实际损害之前提供用户名/密码提示。这可以作为基于会话的标志举行。

# python - 如何在 linux 中安装 python 的 sphinx 文档生成器？

> ID：606283
> 
> 赞同：3
> 
> 时间：2009-03-03T12:54:00.743
> 
> 标签：python, python-sphinx

我该如何运行它？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-03T12:56:37.617

[狮身人面像网站](http://sphinx.pocoo.org/)说：

```
easy_install -U Sphinx 
```

如果你想在系统 python 中安装它，你可能需要提升权限`sudo`：

```
sudo easy_install -U Sphinx 
```

如果您还`easy_install`没有，请参阅[http://peak.telecommunity.com/DevCenter/EasyInstall](http://peak.telecommunity.com/DevCenter/EasyInstall)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T13:28:34.123

我该如何运行它？

[http://sphinx-doc.org/tutorial.html#running-the-build](http://sphinx-doc.org/tutorial.html#running-the-build)

基本上，最简单的方法是从`sphinx-quickstart`命令开始。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T14:37:36.003

[http://showmedo.com/videos/video?name=2910020&fromSeriesID=291](http://showmedo.com/videos/video?name=2910020&fromSeriesID=291)

这个演示展示了如何使用 sphinx 来记录你自己的程序。

# sql-server - 将 Microsoft Works 数据库中的数据导入 SqlServer

> ID：606284
> 
> 赞同：2
> 
> 时间：2009-03-03T12:54:32.177
> 
> 标签：sql-server, sql-server-2005, ssis, import

如何将数据从 Microsoft Works 数据库（*.wdb 文件）导入 SqlServer2005 数据库。

SSIS 能做到这一点吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T16:01:32.337

我自己没有尝试过，但您可以将 wdb 导出到 csv。这是解释如何导出 uisng Microsoft Works 或仅 .wdb 文件的链接：[http ://www.mydigitallife.info/2008/12/10/convert-microsoft-works-database-wdb-to-csv-or-excel -without-works-installed/](http://www.mydigitallife.info/2008/12/10/convert-microsoft-works-database-wdb-to-csv-or-excel-without-works-installed/) SQL 服务器可以轻松导入 csv。

# php - php/html - http_referer

> ID：606288
> 
> 赞同：6
> 
> 时间：2009-03-03T12:56:41.987
> 
> 标签：php, html, http-referer

我正在创建一个网站，在一个特定页面上，我想将用户送回上一页。我对 PHP/HTML 相当陌生，并且一直在使用一些现有的代码来获得想法和帮助。

现有代码使用以下方法：

```
if (! empty($HTTP_REFERER)) 
{
    header("Location: $HTTP_REFERER");
} else 
{
    header("Location: $CFG->wwwroot");
} 
```

但是，当我使用此代码时，HTTP_referer 始终被视为空，并且用户被重定向到根页面。这段代码有什么明显的缺陷吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-03T13:03:59.083

不要依赖 HTTP Referrer 是一个有效的甚至是非空的字段。人们可以选择不使用此设置，将对该变量的任何检查留给 IF-ELSE 子句的空白侧。

您可以通过在 URL 或 POST 参数中发送一个参数来防止这种情况发生，该参数将包含一个值，您可以使用该值将用户重定向回。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-03-03T12:58:40.843

你需要使用：

```
$_SERVER['HTTP_REFERER'] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T13:08:01.397

如果您想将该人送回上一页并使其正常工作，无论引荐来源是否正确设置，您都可以将 GET 参数附加到 URL（或 POST）。您需要对 URL 进行编码。类似于

[http://www.domain.com.au/script.php?return=http%3a%2f%2fwww.domain.com.au%2fthis-is-where-i-was%2f](http://www.domain.com.au/script.php?return=http%3a%2f%2fwww.domain.com.au%2fthis-is-where-i-was%2f)

你可以使用PHP的`urlencode()`函数。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-08-18T10:57:50.917

isset($_SERVER['HTTP_REFERER']) ？$_SERVER['HTTP_REFERER'] : '';

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-03T13:03:42.997

另请注意，referer 标头可能为空或丢失，因此您根本不应该依赖它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-03T13:07:59.650

你应该使用

```
$_SERVER['HTTP_REFERER'] 
```

但是看一下 php.ini 中的 register_globals 配置，出于安全原因，它应该被关闭。[您可以在PHP 手册网站](http://uk3.php.net/register_globals)上阅读更多内容。

# .net - 解析Xml最有效的方法

> ID：606304
> 
> 赞同：17
> 
> 时间：2009-03-03T13:01:58.917
> 
> 标签：.net, xml, performance, linq-to-xml

.Net 框架现在（至少）有四种不同的读取 Xml 字符串的方法。我已经使用了 XmlDocument、XmlReader、XPath 和 XElement 中的每一个，但是在编码或执行期间哪个最有效？每个都是为不同的任务而设计的，优缺点是什么？

* * *

**更新：** 使用 XmlReader 似乎是读取 xml 的最快方法，这对我来说听起来很合理，但有其局限性。我想知道 XmlDocument 和 Xlinq 在非顺序访问 xml 方面是否存在任何性能差异。

* * *

**更新：** 我发现一些帖子比较了加载 xml 文档的不同方法。XmlReader 是最快的，XmlDocument 和 LINQ to XML 之间没有显着差异，直到您加载具有 10,000+ 个节点的文档，其中 LINQ to XML 排在前面。

*   [http://www.nearinfinity.com/blogs/page/jferner?entry=performance_linq_to_sql_vs](http://www.nearinfinity.com/blogs/page/jferner?entry=performance_linq_to_sql_vs)
*   [http://www.hanselman.com/blog/AtAGlanceXmlReaderVsXPathNavigatorVsXmlDocument.aspx](http://www.hanselman.com/blog/AtAGlanceXmlReaderVsXPathNavigatorVsXmlDocument.aspx)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-03T13:09:07.383

三种最常见的阅读方法是：

**XmlDocument** 它以树状结构读取整个文件，然后可以使用 XPath 或通过浏览所有节点来访问该文件。对于非常大的文件，它需要大量内存，因为必须将整个 XML 结构加载到内存中。对于较小的文件（少于几兆）非常好且易于使用。

**XmlReader** 快速，但使用起来也很痛苦，因为它是顺序的。如果您需要返回，则不能，而且 XML 结构通常很容易出现杂乱无章的顺序。此外，如果您从非结束的 XML 流中读取，这可能是唯一的方法。

**XML 序列化** 器 这基本上为您完成所有工作，您提供模型的根对象，它会为您创建和读取 XML。但是，您几乎无法控制结构，并且阅读旧版本的对象是一种痛苦。所以这对于持久性来说不是很好。

**XDocument 和 LINQ to XML** 正如 Daniel Straight 指出的那样。但我不知道足以发表评论。我邀请任何人编辑帖子并添加缺失的信息。

* * *

现在写作是另一个故事。维护 XmlDocument 很痛苦，而 XmlWriter 使用起来很容易。

我想说，根据我的经验，最好的组合是使用 XmlWriter 编写并使用 XmlDocument 读取。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-03T13:29:09.287

还有 XDocument 和 LINQ to XML，就程序员时间而言，我认为这是迄今为止最有效的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-03T13:08:01.303

最快的是`XmlTextReader`. 来自 MSDN：

> “表示提供对 XML 数据的快速、非缓存、只进访问的阅读器。”

更多：[XmlTextReader 类](http://msdn.microsoft.com/en-us/library/system.xml.xmltextreader.aspx)

尽管决定哪种“方法”最适合使用确实取决于问题。如果您只需要读取一次 XML 文件（例如：读取和缓存一些全局应用程序设置等），那么 XmlTextReader 是赢家。但请记住，它是只转发阅读器。如果您需要搜索/修改整个 XML，那么您可能应该使用[XmlDocument Class](http://msdn.microsoft.com/en-us/library/system.xml.xmldocument.aspx)。

# .net - PowerShell：.NET 方法调用的性能

> ID：606312
> 
> 赞同：1
> 
> 时间：2009-03-03T13:04:40.233
> 
> 标签：.net, performance, powershell, powershell-1.0

是否可以通过早期绑定从 PowerShell 调用 .NET 方法？

我有一个管道脚本，它在 .NET 中调用单个 .NET 方法`process {...}`。PowerShell 通过反射调用此方法，现在`Invoke`（不是方法本身，只是反射调用）占用了总执行时间的 70%。

方法总是一样的，所以我宁愿要求 PowerShell 根本不要使用反射。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T13:25:50.980

我相信在 PowerShell 中早期绑定或至少在动态语言中尽可能早绑定的唯一方法调用类型如下

1.  CmdLets。
2.  静态方法

我不太确定#2。我相信他们仍然必须使用反射来获得底层方法。

CmdLets 可能是这里更好的选择。在这种情况下，实际调用会提前绑定，但参数仍然必须经过转换过程。尝试将您的方法调用移动到 CmdLet 中，看看是否对您有帮助。

# objective-c - 继承一个 NSTextField

> ID：606319
> 
> 赞同：0
> 
> 时间：2009-03-03T13:06:41.400
> 
> 标签：objective-c, cocoa, xcode, interface-builder

我想扩展 NSTextField 的功能。我想要实现的目标是：

更改插入符号的外观和感觉。

检测文本何时达到一定数量的字符，然后在该限制之后对文本进行不同的着色。*

在花了相当长的时间谷歌搜索后，令我非常沮丧的是，我发现数百个点击简单地说明“Sublass NSTextField 并使用此代码。”，令我感到羞耻的是，我发现自己无法准确地了解如何做到这一点。

如果有人能给我一个实现我上面列出的两件事之一的子类的工作示例，以及关于如何实现代码的说明*，我将非常感激，这样我就可以通过查看一些内容来尝试弄清楚它是如何工作的实际的实时代码。

* * *

### 对于我迟到的回复，我深表歉意！

向你们所有人道歉。我家里有一个绞痛婴儿，正如你们（或至少你们中的那些有孩子的人）可以想象的那样，这会占用你相当多的可用时间。谢谢大家的回复。

我看到我的主要问题之一是我对代表和出口没有足够的了解。我已经购买了这里推荐的书（以及许多其他地方。我收集了某种“圣经”），我正在研究它，因为我们在这些天的几个沉默时间里说话。:)

但是，尽管我可以看到它对我来说将是一个不可或缺的工具，但我仍然通过学习示例而不是阅读理论来获得最多的理解*，所以如果有人会创建一个具有相关类的适当子类的项目，我将非常感激因为我知道我可能不应该扩展 NSTextfield 类？

我会立即将 Mark Thalmans 的帖子标记为答案，因为我确信这是一个适当的“傻瓜”回复，但我会坚持几天，因为我真的很喜欢一个文件来细读。但我并不忘恩负义！

哦，还有；当我说我在我真正知道的语言中没有那么无用时，请相信我。只是这些概念与 Interface Builder 和 GUI 与代码的连接对我来说是非常陌生的。我通常只是编写代码并保持不变。

* * *

*是的，我的第一个小培训项目确实是一个 Twitter 实用程序。

*喜欢孩子

*并不是说阅读理论对我也没有巨大的价值。如果没有 Colin Moock 的 AS3 权威指南，我就不会成为现在的我

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-03T14:25:18.043

`setInsertionPointColor:`将负责设置插入符号颜色，并且使用委托方法将是在字符数更改后为文本着色的最佳方法。一般来说，Cocoa中的很多类都是这样的；您可以对它们进行子类化，但您需要更改的大部分功能都在委托方法中。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-03T20:18:30.487

`NSTextField`很特别，因为它实际上并没有实现文本编辑。这是由一个共享的（每个窗口）完成的`NSTextView`，称为**字段编辑器**。您可以为给定的`NSTextField`. 这是通过子类化`NSWindow`(!) 和覆盖来规范地完成的`-fieldEditor:forObject:`。但是，当我查找此内容时，我发现了`NSTextFieldCell`'s`-setUpFieldEditorAttributes:`方法，它看起来好像可以返回与它所提供的不同的字段编辑器。

推荐阅读：[Cocoa 的控制和单元编程主题](http://developer.apple.com/DOCUMENTATION/Cocoa/Conceptual/ControlCell/ControlCell.html)，[文本系统概述](http://developer.apple.com/DOCUMENTATION/Cocoa/Conceptual/TextArchitecture/TextArchitecture.html)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-03T14:24:04.647

马丁，

我从“新建文件”对话框开始，选择左侧的“Cocoa”，然后选择 Objective-C 类。

这将生成以下代码，没有注释。然后您需要做的就是将标题的“@interface”行中的 NSObject 更改为“NSTextView”，并且您有一个工作子类。如果您使用的是 XCode 3.0，您可以转到 Interface Builder 并将您的 NSTextField 的类更改为“MyTextView”。

您还应该阅读 Aaron Hillegass 的书“Mac OS X 的 Cocoa Programming，第三版”，如果您还没有，它已经为 Leopard 更新了。

祝你好运。

```
 #import <Cocoa/Cocoa.h>

@interface MyTextView : NSTextView {
 // Outlets & Members go here
}
// Actions & messages go here
@end 
```

```
 #import "MyTextView.h"

@implementation MyTextView

@end 

```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-03T20:21:33.460

1.  如果你真的必须继承它，你必须继承[`NSTextFieldCell`](http://developer.apple.com/DOCUMENTATION/Cocoa/Conceptual/ControlCell/Tasks/SubclassingNSCell.html). 有关信息`NSCells`可[在线获取](http://developer.apple.com/documentation/Cocoa/Reference/ApplicationKit/Classes/NSCell_Class/Reference/NSCell.html)。

2.  如果不是绝对必要，不要对单元格进行子类化。使用[委托方法](http://developer.apple.com/documentation/Cocoa/Reference/ApplicationKit/Classes/NSTextField_Class/Reference/Reference.html)。

3.  至少可以使用[`NSTextField`'s bindings](http://developer.apple.com/documentation/Cocoa/Reference/CocoaBindingsRef/BindingsText/NSTextField.html)更改颜色，使用那些。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-03T22:58:17.093

您可能还可以获得格式化程序所需的一些功能。

# c# - C#中的虚方法问题

> ID：606321
> 
> 赞同：1
> 
> 时间：2009-03-03T13:06:59.777
> 
> 标签：c#, oop, virtual, abstract

在 MSDN 中提到，

[http://msdn.microsoft.com/en-us/library/9fkccyh4(VS.80).aspx](http://msdn.microsoft.com/en-us/library/9fkccyh4(VS.80).aspx)

我很困惑这个项目是什么意思“可以通过包含使用覆盖修饰符的属性声明来覆盖派生类中的虚拟继承属性。”？

（这是虚拟和抽象之间的第二个区别）

提前谢谢，乔治

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-03T13:13:14.363

虚拟和抽象之间的唯一区别是抽象方法或属性在定义它的类（抽象类）中没有实现，并且**必须**在子类中覆盖它；而虚拟方法或属性在定义它的类中具有实现，因此不必在子类中覆盖它。

```
public abstract AbstractClass
{
    // This class cannot be instantiated, since it is 
    // abstract, and the class is abstract because
    // it has an abstract member

    public abstract MyProperty {get; set; }
} 
```

在从 AbstractClass 派生的类中（上面的 AbstractClass 仅用于解释目的；由于它没有具有实现的方法/属性，因此您可以创建接口而不是抽象类），您必须提供`MyProperty`. 否则，它不会编译。您通过“覆盖” MyProperty 来做到这一点，您不想引入新成员，而只是为之前定义的属性提供实现。

```
public class ConcreteClass : AbstractClass
{
    public override MyProperty {
       get
       {
            return _someValue;
       }
       set
       {
            if( _someValue != value ) _someValue = value;
       }
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-16T17:07:55.710

我能理解这种困惑。我以前去过那里，所以我将分享我如何保持基本差异...

`virtual`与`abstract`：

*   如果一个类方法（或属性）被标记`virtual`，那么 如果您选择从该类*继承* （也称为*派生），则***可以** 使用关键字覆盖它。该关键字旨在唤起这样一种想法，即该方法可能是也可能不是实际调用的方法。因此，我一直认为成员是*默认实现*，这意味着它代表可以泛化的功能，例如类上的方法，这可能涉及用手吃饭。但是，一个类可能会覆盖的*默认*实现`override` **`virtual``virtual`*`Eat()``Human``ChineseHuman`*`Eat()`，以便允许使用筷子代替的实现。最后，因为虚拟方法和属性是*默认实现*，所以定义该成员的类必须提供方法或属性的完整实现。所有`Human`对象都必须*知道如何* `Eat()`。

    面向对象的思维方式可能会宣称`virtual`成员代表*本能*。To`Eat()`是类对象的*本能。*`Human`A`ChineseHuman`可以*学会*用`Eat()`筷子。****

***   如果一个类方法（或属性）被标记`abstract`，那么 如果您选择 从该类*继承，则***必须**使用关键字覆盖它。该关键字旨在唤起这样一种想法，即该类仅*支持*该成员表示的能力，并且没有任何通用逻辑可以针对该功能进行概括。换句话说，成员只是*概念性*的，因此它们缺乏实现。当我们实现继承关系时，C# 要求我们抽象成员有点令人困惑，但在这种情况下，这实际上意味着我们用具体实现覆盖了空概念。一个例子`override` *`abstract`*`abstract`*`override``abstract`一个`Human`类的成员可能是`Speak()`. 对于所有`Human`对象来说，不会有一种共同的说话方式，也不是本能的，因为它需要语言来表达。注意：有些人可能会争辩说，它`Speak()`属于 an`interface`而不是。

    面向对象的思维方式可能会声明`abstract`成员代表*要学习的行为（方法）和**要获得的*知识或信念（属性）。To`Speak()`是类对象的*学习*行为。`Human`A 的`ChineseHuman`学习方式可能`Speak()`与 an 不同`EnglishHuman`，但两者都不知道如何学习，`Speak()`因为他们都是`Human`.***** 

 **细微差别：

*   `virtual`方法不需要被覆盖。
*   没有类这样的东西`virtual`。
*   `abstract`成员只能出现在`abstract`类中。在上面的例子中，`abstract`在类上有一个方法`Human`意味着它`Human`是一个`abstract`类，因此，a`Human`不能使用短语 来实例化`var baby = new Human();`。相反，`BabyHuman`该类应该继承自`Human`，并且应该实例化为`var baby = new BabyHuman();`。因为 a`BabyHuman()`是 a`Human`并且`EnglishHuman`两者`ChineseHuman`都继承自`Human`，`EnglishHuman`所以可以继承自`BabyHuman`而不是`Human`。存在`Human`是`abstract`因为我们都不仅仅是简单的东西`Human`。
*   `abstract`成员不能被隐藏，只有它们的`override`实现可能是（在继承链上更进一步）。例如，`BabyHuman`必须将该`abstract` `Speak()`方法实现为`override`. 如果`EnglishHuman`继承自`BabyHuman`，则它可以使用关键字隐藏 的`BabyHuman`实现及其自己的实现（请参阅下面的“C# 中的方法隐藏”参考）。`Speak()``new`
*   `abstract`类可以有`virtual`成员。`interface`这是一个和一个`abstract`类之间的主要区别。从这个意义上说，一个`abstract`类可以定义一个契约和类行为的模板，而一个`interface`只定义一个契约。

代码参考：

*   抽象类与接口
    Rahman Mahmoodi
    [http://www.codeproject.com/KB/cs/abstractsvsinterfaces.aspx](http://www.codeproject.com/KB/cs/abstractsvsinterfaces.aspx)
*   方法隐藏在 C# 中，
    作者 Chetan Kudalkar
    [http://www.codeproject.com/KB/cs/cs_methodhiding.aspx](http://www.codeproject.com/KB/cs/cs_methodhiding.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T13:12:29.280

你能解释一下它有什么令人困惑的地方吗？属性可以像任何其他方法一样被覆盖。

```
public class Base {
  public virtual int Prop1 { get { ... } set { ... } }
}

public class Derived : Base {
  public override int Prop1 { get { ... } set { ... } } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-03T13:13:08.000

如果您在基类中声明一个虚拟方法，您可以在派生类中覆盖它。

例子

```
class MyBaseClass
{
   public virtual void MyOverridableMethod()
   {
          ...
   }

}

class MyDerivedClass : MyBaseClass
{
   public override void MyOverridableMethod()
   {
         ...
   }
} 
```

注意 MyDerivedClass 中的 override 修饰符。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-03T13:14:57.213

好的，假设您有一个基类，并且该基类本身是从另一个类派生的。

```
public class Bar : Foo
{
   virtual public int SomeProperty { get; set; }
} 
```

virtual 关键字的含义是，在从 Bar 派生的类中，您可以重写 SomeProperty 以更改其行为：

```
public class Baz : Bar
{
   private int thisInt;
   override public int SomeProperty 
   {
      get { return thisInt; }
      set 
      {
         if(value < 0)
         {
            throw new ArgumentException("Value must be greater than or equal to zero.");
         }
         thisInt = 0;
      }
   }
} 
```

**澄清：**当使用 Baz 类型的对象时，它的 SomeProperty 版本会被调用，除非该类型被强制转换为 Bar。如果您将 Baz 的 SomeProperty 定义为虚拟，则从 Baz 派生的类也可以覆盖它（实际上，这可能是必需的——我想不起来了）。

**进一步澄清：**抽象方法没有实现；当您向您的类添加一个时，您还必须将该类标记为抽象类，并且您不能实例化它的新实例，如下所示：

```
MyAbstractType m = new MyAbstractType(); 
```

另一方面，虚拟成员可以有一个实现（如上面的 SomeProperty），因此您不必标记类抽象，并且可以实例化它们。

# security - Delphi：从另一台计算机打开文件

> ID：606324
> 
> 赞同：2
> 
> 时间：2009-03-03T13:07:13.927
> 
> 标签：security, delphi, file

我的名字是来自巴西的 Carlos Im。我试图打开这样的文件：

```
image1.picture.loadfromfile('\\ntmemo01\c$\ozzy2.bmp'); 
```

但它不起作用。我收到异常

类 EFOpenError 带有消息“无法打开文件 '\ntmemo01\c$\ozzy2.bmp' 访问被拒绝。”

谢谢，卡洛斯

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-03T13:10:32.373

您必须使用双反斜杠。

```
image1.picture.loadfromfile('\\ntmemo01\c$\ozzy2.bmp'); 
```

如果您仍然收到异常，则说明您的应用程序无法访问该文件。

您应该做的第一件事是确保您可以使用 Windows 资源管理器访问该文件。

只需在开始菜单的“运行”对话框中输入它（WinKey+R），看看会发生什么。如果它不起作用，先*让它在*那里工作，然后再回到你的程序。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-03T15:13:20.160

ntmemo01 上的 C: 驱动器是否共享？如果未共享，则无法访问。如果它是共享的，但需要用户名和密码才能访问，则您必须以不同的方式访问它。您可以将驱动器号映射到它，在此过程中提供用户名和密码：

```
const
  RemoteName = '\\ntmemo01\C$';
  UserName = 'yourusername';
  Password = 'yourpassword';

function MapNetworkDrive: Boolean;
var
  NetRes: TNetResource;
  Res: DWord;
begin
  Result := True;
  FillChar(NetRes, SizeOf(TNetResource), 0);
  NetRes.dwType := RESOURCETYPE_DISK;
  NetRes.lpRemoteName := PChar(RemoteName);
  NetRes.lpLocalName := 'H:';   // Whatever drive letter you want
  Res := WNetAddConnection2(NetRes, PChar(Password), PChar(UserName), 0);
  Result := (Res = NO_ERROR);
end; 
```

之后取消映射：

```
function UnMapNetworkDrive: Boolean;
var
  Res: DWord;
begin
  Res := WNetCancelConnection2(PChar('H:'), 0, True); // same drive letter as above
  Result := (Res + NO_ERROR);
end; 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-03T17:08:07.280

如[DR](https://stackoverflow.com/questions/606324/open-a-file-from-another-computer-delphi/606339#606339)所述，文件名需要双反斜杠作为[UNC 路径](http://en.wikipedia.org/wiki/Path_(computing)#Uniform_Naming_Convention)

*拒绝访问*消息表明您无权访问 ntmemo01 计算机上的 C$ 共享。

C$ a 是隐藏的[管理共享](http://support.microsoft.com/kb/314984)您确定当前用户帐户具有正确的权限吗？[正如Ken White](https://stackoverflow.com/questions/606324/open-a-file-from-another-computer-delphi/606767#606767)所建议的，您首先必须在地图上创建一个驱动器

默认情况下，在 Windows Vista 和 Windows 7 中禁用管理共享，除非您加入域。您可以按如下方式手动启用它们。

> 单击开始按钮，然后在搜索框中键入“regedit”，然后按 Enter。
> 
> 浏览到`HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System`。
> 
> 添加一个名为**LocalAccountTokenFilterPolicy的新****DWORD**并为其赋值**1**。
> 
>  ****重新启动，你就完成了！
> 
> 资料来源： http: [//www.paulspoerry.com/2007/05/09/how-to-access-administrative-shares-on-vista-c/](http://www.paulspoerry.com/2007/05/09/how-to-access-administrative-shares-on-vista-c/)****

 ***** * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-03T14:53:34.327

当您在 Windows 资源管理器中复制这个完全相同的字符串时，文件是否打开？否则，这可能是一个权利问题，正如错误所暗示的那样。

# java - 用另一组字符（成对）替换一组字符：正则表达式中的“&”、“&”、“<”、“<”等

> ID：606325
> 
> 赞同：0
> 
> 时间：2009-03-03T13:07:47.917
> 
> 标签：java, xml, regex

我必须正确编码 5 个 XML 保留字符（& < > " 和 '），如下所示：

```
"&", "&amp;" "<", "&lt;" ">", "&gt;"
   "\"", "&quot;" "\'", "&apos;" 
```

我可以一个一个地做，但是在正则表达式中是否有可能像 ("[&|<|>|\"|\']", "&|<"); ... 等等这样就不会5个操作一个接一个地同时执行？

顺便说一句，可能在 Java 中使用`String.replaceAll(regexpString, string);`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-03T13:16:27.647

在 commons-lang 库中使用 StringEscapeUtils.escapeXml。

顺便说一句，如果不将几乎所有的公共库添加到我的依赖项中，我就永远不会开始 Java 进程。他们节省了很多时间..

```
<dependency>
    <groupId>commons-lang</groupId>
    <artifactId>commons-lang</artifactId>
    <version>2.4</version>
</dependency> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T13:15:00.927

[请参阅http://www.owasp.org/index.php/How_to_perform_HTML_entity_encoding_in_Java](http://www.owasp.org/index.php/How_to_perform_HTML_entity_encoding_in_Java)中的代码。

Jakarta 也有一个常用的[escapeXml](http://commons.apache.org/lang/api-release/org/apache/commons/lang/StringEscapeUtils.html#escapeXml(java.lang.String))方法来覆盖它，但如果你正在生成与 HTML 兼容的 XHTML，那些'&'' 实体是不可取的。

无论如何，当您只进行单字符替换时，IMO 的“同时”正则表达式并不能真正为您带来很多好处。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T14:21:02.423

如果您这样做是为了将一些数据插入到 XML 数据包中，那么最好使用实际的 XML API，它会为您编码这些数据。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-03-03T14:00:55.093

我想知道您是否最好将包含“魔术字符”的数据包装在 CDATA 部分中并称之为一天。让客户在收到它时将其剥离。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-03-09T13:53:17.667

```
protected static void escapeXMLSpecialCharactersAndWrite(Writer writer, String str) throws IOException {

    int len = str.length();
    for (int i = 0; i < len; i++) {
        char c = str.charAt(i);

        switch (c) {
        case '&':
            writer.write("&amp;");
            break;
        case '<':
            writer.write("&lt;");
            break;
        case '>':
            writer.write("&gt;");
            break;
        case '\"':
            writer.write("&quot;");
            break;
        case '\'':
            writer.write("&apos;");
            break;
        default:
            writer.write(c);
            break;
        }
    }
} 
```

# c# - 自联接关系具有附加属性时的 NHibernate 映射

> ID：606330
> 
> 赞同：5
> 
> 时间：2009-03-03T13:08:45.233
> 
> 标签：c#, nhibernate, nhibernate-mapping

*当这种关系本身具有属性时，*如何将一个类映射到同一类的其他实例？

我有一个名为 Person 的类，它映射到一个表 Person

```
PersonID   PersonName    PersonAge 
----------------------------------
       1   Dave Dee             55
       2   Dozy                 52
       3   Beaky                45
       4   Mick                 55
       5   Tich                 58 
```

我希望使用名为 PersonPerson 的连接表在 Person 和 Person 之间建立多对多关系：

```
 PersonPersonID  PersonID  RelatedPersonID RelationshipID 
 --------------------------------------------------------
              1         1                5              1
              2         3                4              2
              3         2                1              3 
```

我想要 PersonPerson 表中的以下属性：

```
RelationshipID  RelationshipName
--------------------------------
             1  Colleague
             2  Manager
             3  Tutor 
```

[这个问题和](https://stackoverflow.com/questions/350311/using-additional-data-on-intermediate-table-with-nhibernate/350702#350702)[Billy McCafferty](http://devlicio.us/blogs/billy_mccafferty/archive/2008/07/11/when-to-use-many-to-one-s-vs-many-to-many-with-nhibernate.aspx)的链接到帖子解释说，由于 PersonPerson 表中的附加列，必须将 PersonPerson 关系从正常的 JOIN 提升到其自身的实体。但是，它没有解释当它是自加入时要做什么。不同之处在于，如果我要求所有与**Dave Dee** (ID = 1) 相关的人，我不仅应该得到**Tich** (ID = 5)，而且我也应该得到**Dozy** (ID = 2)，因为 Dave Dee也在 RelatedPersonID 列中。

到目前为止，我的解决方案是在我的 Person 类中有两个属性。

```
public virtual IList<PersonPerson> PersonPersonForward {get;set;}
public virtual IList<PersonPerson> PersonPersonBack {get;set;}

private List<PersonPerson> personPersonAll;
public virtual List<PersonPerson> PersonPersonAll 
{
   get
   {
       personPersonAll = new List<PersonPerson>(PersonPersonForward);
       personPersonAll.AddRange(PersonPersonBack);
       return personPersonAll;
   }
} 
```

并在 hbm 中有以下内容：

```
 <bag name="PersonPersonForward" table="PersonPerson" cascade="all">
      <key column="PersonID"/>
      <one-to-many class="PersonPerson" />
 </bag>

 <bag name="PersonPersonBack" table="PersonPerson" cascade="all">
      <key column="RelatedPersonID"/>
      <one-to-many class="PersonPerson" />
 </bag> 
```

这似乎有点笨拙和不雅。NHibernate 通常对大多数日常问题都有优雅的解决方案。以上是明智的做法还是有更好的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-06T08:20:11.237

我想我也会这样做，但是，我认为这样建模有点“笨拙”。我的意思是：你有一个与某个人相关的人的集合，但你也有一个“反向关系”。
这真的有必要吗？是否可以选择删除此回溯集合，而是在 PersonRepository 上指定一个方法，该方法可以将所有与给定人员有某种关系的人返回给您？

嗯，这听起来可能有点晦涩难懂，所以这里有一些代码（请注意，为了简洁起见，我省略了“虚拟”修饰符等......（我也不想有这些修饰符，所以在 99 % 的时间，我在我的类映射中指定“lazy=false”）。

```
public class Person
{
    public int Id {get; set;}
    public string Name {get; set;}

    public IList<PersonPerson> _relatedPersons;

    public ReadOnlyCollection<PersonPerson> RelatedPersons
    {
        get
        {
           // The RelatedPersons property is mapped with NHibernate, but
           // using its backed field _relatedPersons (can be done using the 
           // access attrib in the HBM.
           // I prefer to expose the collection itself as a readonlycollection
           // to the client, so that RelatedPersons have to be added through
           // the AddRelatedPerson method (and removed via a RemoveRelatedPerson method).

           return new List<PersonPerson) (_relatedPersons).AsReadOnly();
        }
    }

    public void AddRelatedPerson( Person p, RelationType relatesAs )
    {
       ...
    }

} 
```

如您所见，Person 类只剩下一个集合，即表示此 Person 所具有的关系的 PersonPerson 对象的集合。为了获取与给定 Person 有关系的 Person，您可以在 PersonRepository 上创建一个返回这些 Person 的特定方法，而不是将它们放在 Person 类的集合中。我认为这也会提高性能。

```
public class NHPersonRepository : IPersonRepository
{
    ...

    public IList<Person> FindPersonsThatHaveARelationShipWithPerson( Person p )
    {
        ICriteria crit = _session.CreateCriteria <Person>();

        crit.AddAlias ("RelatedPersons", "r");

        crit.Add (Expression.Eq ("r.RelatedWithPerson", p));

        return crit.List();

    }
} 
```

“反向引用”不是 Person 类的成员；它必须通过存储库访问。这也是 Eric Evans 在他的 DDD 书中所说的：在某些情况下，最好在存储库中有一个专门的方法可以让您访问相关对象，而不是让它们（= 相关对象）随身携带与对象本身。

我没有测试代码，我只是在这里输入了它，所以我也没有检查语法错误等......但我认为它应该澄清一下我会如何看待这个。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-06T08:37:22.367

在我看来，您实际上已经构建了有[向图](http://en.wikipedia.org/wiki/Directed_graph)的模型，并且这两个映射`PersonPersonForward`分别`PersonPersonBack`表示传出和传入边。

您的关系类型的语义强化了这种定向性：虽然*is-a-Colleague-of*很可能是[对称关系](http://en.wikipedia.org/wiki/Symmetric_relation)，但*is-a-Manager-of*和*is-a-Tutor-of*几乎肯定是不对称的。

我认为在这种情况下，数据模型试图告诉您，这两个链接集合虽然是兼容类型，但在上下文中并不是一回事。

# visual-studio - 如何加速 Visual Studio(2005/2008) 工具箱初始化

> ID：606336
> 
> 赞同：7
> 
> 时间：2009-03-03T13:10:17.227
> 
> 标签：visual-studio, performance, toolbox

每次我在 VS .NET 中打开 Windows 窗体应用程序时，都需要几分钟来初始化工具箱。有没有办法告诉 VS 以某种方式缓存这个工具箱？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-03T13:16:18.600

在 Tools->Options->Windows Forms Designer->Tools 中关闭 AutoToolboxPopulate。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-18T13:52:19.407

这可能与已安装的软件包有关，请尝试：

```
devenv.exe /ResetSkipPkgs 
```

接着

```
devenv.exe /Setup 
```

VS Toolbox 通过浏览已安装的包来消耗大部分时间...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T21:50:27.990

工具箱有一个收集垃圾的坏习惯。在VS2005中它非常糟糕。但是最近发现VS2008也有这个问题。在 Vista 上，导航到 c:\users\yourname\appdata\local\microsoft\visualstudio\9.0。那里有一些隐藏文件。和文件似乎是备份文件`toolbox_reset.tbd`，`toolboxindex_reset.tbd`以摆脱真正的麻烦，在那里复制隐藏的 toolbox.tbd 和 toolboxIndex.tbd 文件。

查看 ProjectAssemblies 文件夹。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-03-18T23:29:33.220

从 visualstudio\9.0 中删除 .TBD 对我有用，但会导致弹出 TFS30330: Team Explorer cannot write the project list configuration file。此外，在 VisualStudio2008 初始化期间重新创建了文件，但初始化工具箱...不会发生。每次启动 VS2008 时都会出现 TFS30330 错误。然后我不得不重置我的 Visual Studio 设置。但最终它是值得的——不再像一位博主所说的那样强迫喝咖啡休息时间。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-03T13:15:19.663

第一次打开工具箱肯定会有延迟，但应该只是第一次出现。如果您看到重复延迟，则可能是以下情况之一。

1.  插件：你安装了哪些插件？尝试卸载它们并打开工具栏几次。这将消除插件作为嫌疑人
2.  自定义控件：如果您制作自定义控件，它们会被添加到工具箱中。这可能会导致一些性能问题（尽管不太可能），这是可行的。尝试注释掉控件中的功能代码，看看是否能提高性能。

# pdf - 更新 XSL 中的属性 for-each

> ID：606337
> 
> 赞同：0
> 
> 时间：2009-03-03T13:10:27.320
> 
> 标签：pdf, xslt, pdf-generation, xsl-fo

在工作中，我接到了使用 XSL 生成 PDF 的有趣任务。我正在使用的 XML 结构类似于

```
<records>
    <topLevel>
        <topLevelID></topLevelID>
        <secondLevel>
            <secondLevelID></secondLevelID>
            <thirdLevel>
            </thirdLevel>
            <thirdLevel>
            </thirdLevel>
        </secondLevel>
    </topLevel>
    <topLevel>
        <topLevelID></topLevelID>
        <secondLevel>
            <secondLevelID></secondLevelID>
            <thirdLevel>
            </thirdLevel>
            <thirdLevel>
            </thirdLevel>
        </secondLevel>
    </topLevel>
</records> 
```

我会尝试给出一个更有意义的 XML 示例，但我不想接近任何可能存在的法律界限。使用这种 XML 结构，我必须在 PDF 中为每个`thirdLevel`节点输出一个文本块。我到目前为止的 XSL 就像

```
<xsl:for-each select ="topLevel">          
    <xsl:variable name="topID" select="topLevelID"/>
    <xsl:for-each select ="secondLevel">
        <xsl:variable name="secondID" select="secondLevelID"/>
        <xsl:for-each select="thirdLevel">            
            <fo:block-container position="absolute" height="12.8pt" width="220.8pt" left="160pt" display-align="auto">
                <xsl:attribute name="top">
                    <xsl:value-of select="concat(193 + [whatshouldgohere]), 'pt')"/>
                </xsl:attribute>
                <fo:block font-size="7pt">                          
                    <xsl:call-template name="insertThirdLevel"/>
                </fo:block>
            </fo:block-container>
        </xsl:for-each>
    </xsl:for-each>
</xsl:for-each> 
```

基本上，我需要为 top 属性添加一些值，以使每个`thirdLevel`节点的文本出现在自己的行上。我尝试使用 ID 的加/乘组合（从 1 开始，每组加 1）和`position()`，但我似乎无法正确处理。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T13:41:29.133

我认为您应该真正研究一下`<xsl:apply-templates>`，它可以为您节省大量打字。

简化版：

```
<xsl:variable name="line-height" select="10" />

<xsl:template match="/records">
  <xsl:apply-templates select="//thirdLevel" />
</xsl:template>

<xsl:template match="thirdLevel">
  <xsl:variable name="top" select="193 + position() * $line-height" />
  <fo:block-container top="{concat($top , 'pt')}">
    <fo:block font-size="7pt">                          
      <xsl:call-template name="insertThirdLevel"/>
    </fo:block>
  </fo:block-container>
</xsl:template>

<xsl:template name="insertThirdLevel">
  Third Level!
</xsl:template> 
```

简化输出（“fo”命名空间除外）：

```
<fo:block-container top="203pt">
  <fo:block font-size="7pt">
    Third Level!
  </fo:block>
</fo:block-container>
<fo:block-container top="213pt">
  <fo:block font-size="7pt">
    Third Level!
  </fo:block>
</fo:block-container>
<fo:block-container top="223pt">
  <fo:block font-size="7pt">
    Third Level!
  </fo:block>
</fo:block-container>
<fo:block-container top="233pt">
  <fo:block font-size="7pt">
    Third Level!
  </fo:block>
</fo:block-container> 
```

# wpf - WPF 2 ComboBox 绑定问题

> ID：606343
> 
> 赞同：1
> 
> 时间：2009-03-03T13:12:42.773
> 
> 标签：wpf, data-binding, combobox, databound-controls

我有以下问题：
有一个具有几个字符串属性的类有
一个这样的类实体的集合

该集合显示在一些窗口左侧的树中，右侧显示详细信息。我将所选节点的字符串属性详细绑定到组合框。
第一个组合框始终具有相同的 ItemsSource 但第二个 ItemsSource 取决于第一个组合的 SelectedItem ...

```
<ComboBox 
  Grid.Column="1" 
  SelectedIndex="0"  
  x:Name="cbClass" 
  Style="{DynamicResource ComboBoxValidationError}" 
  SelectedValue="{Binding Path=Description.Node.ClassName, ElementName=userControl, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"  
  ItemsSource="{Binding Source={StaticResource classesProvider}}" 
  Width="Auto" 
  Height="Auto"  
  DisplayMemberPath="Description" 
  SelectedValuePath="FQN" />

<ComboBox 
  Grid.Column="1" 
  SelectedIndex="0" 
  Grid.Row="1"  
  x:Name="cbMethod" 
  SelectedValue="{Binding Path=Description.Node.MethodName, ElementName=userControl, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged,diag:PresentationTraceSources.TraceLevel=High}" 
  ItemsSource="{Binding Path=SelectedItem.Methods, ElementName=cbClass, Mode=Default,diag:PresentationTraceSources.TraceLevel=High}" 
  Style="{DynamicResource ComboBoxValidationError}" 
  Width="Auto" 
  Height="Auto" 
  SelectedValuePath="Name" 
  DisplayMemberPath="Description"  /> 
```

现在，当我在树中创建新节点时，两个字符串属性都有空引用。当第一个组合为 NEW 节点更改其 SelectedItem 时，第二个 ComboBox 将 null 绑定到 OLD 节点的字符串值，这是在树中创建新节点之前选择的......我想知道在这种情况下我应该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T13:37:19.937

我刚刚找到了答案。
绑定是按照声明的顺序通知的，WPF 不会分析绑定的依赖关系 :) 所以交换 ComboBoxes 的声明可以解决问题......在这种情况下是可以接受的，因为我将这些 ComboBoxes 放在 Grid 中手动设置它们的 Grid.Row和 Grid.Column... 虽然解决方案不是很令人满意，但它确实有效！

# linux - 愚蠢的 Linux SNMP 问题

> ID：606348
> 
> 赞同：-2
> 
> 时间：2009-03-03T13:13:18.297
> 
> 标签：linux, sysadmin, snmp

我正在运行 Ubuntu 并且正在运行 snmpd。我可以做一个 snmpwalk：

```
snmpwalk -c public -v 1 localhost .1 
```

我得到了大约 20 个值（SNMPv2-MIB——主要是系统描述/名称/正常运行时间的东西）。

内存、磁盘和网络值在哪里？我试过查询我在谷歌上找到的特定 OID，但没有找到。

我假设我必须以某种方式启用内存/磁盘/网络/等，但不知道如何（我花了很多时间在谷歌上搜索——显然这个问题太无聊了，没有人问过？？？） .

感谢您的任何见解。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-03T14:38:02.663

更改此 /etc/snmp/snmpd.conf

```
com2sec paranoid default public
#com2sec readonly default public
#com2sec readwrite default private 
```

部分：

```
#com2sec paranoid default public
com2sec readonly 127.0.0.1 public
#com2sec readwrite default private 
```

重启 snmpd：

```
sudo /etc/init.d/snmpd restart 
```

然后试试这个：

```
snmpwalk -c public -v 2c 127.0.0.1 . 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T14:21:36.463

假设它使用的是 snmpd，请检查配置文件：/etc/snmpd/snmpd.conf

SNMPD 支持更有限的监控，例如磁盘使用阈值。可能还有更多选择，我没有用它来监控机器。

显然你也可以使用安装程序：

```
snmpconf -g basic_setup 
```

它将提示您输入信息并为您配置系统。

祝你好运。

# python - 如何在 Python 中调试正则表达式？

> ID：606350
> 
> 赞同：20
> 
> 时间：2009-03-03T13:13:45.283
> 
> 标签：python, regex, debugging

有没有办法在 Python 中调试正则表达式？而且我不是指尝试和尝试直到他们工作的过程:)

下面是如何在 Perl 中调试正则表达式：

```
 use re 'debug';

my $str = "GET http://some-site.com HTTP/1.1";
if($str =~/get\s+(\S+)/i) {
    print "MATCH:$1\n";
} 
```

上面的代码在运行时会在我的计算机上产生以下输出：

```
 Compiling REx "get\s+(\S+)"
Final program:
   1: EXACTF  (3)
   3: PLUS (5)
   4:   SPACE (0)
   5: OPEN1 (7)
   7:   PLUS (9)
   8:     NSPACE (0)
   9: CLOSE1 (11)
  11: END (0)
stclass EXACTF  minlen 5
Matching REx "get\s+(\S+)" against "GET http://some-site.com HTTP/1.1"
Matching stclass EXACTF  against "GET http://some-site.com HTTP/1.1" (33 chars)
   0           |  1:EXACTF (3)
   3        |  3:PLUS(5)
                                  SPACE can match 1 times out of 2147483647...
   4       |  5:  OPEN1(7)
   4       |  7:  PLUS(9)
                                    NSPACE can match 20 times out of 2147483647...
  24       |  9:    CLOSE1(11)
  24       | 11:    END(0)
Match successful!
MATCH:http://some-site.com
Freeing REx: "get\s+(\S+)" 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-03-03T13:21:12.893

```
 >>> p = re.compile('.*', re.DEBUG)
max_repeat 0 65535
  any None
>>> 

```

[正则表达式'|' 运算符与每个子表达式的单独运行](https://stackoverflow.com/questions/580993/regex-operator-vs-separate-runs-for-each-sub-expression/582227#582227)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-11-26T08:08:55.823

[https://www.debuggex.com](https://www.debuggex.com)也不错。它是一个在线 Python（以及更多语言）调试器，它对匹配和不匹配的内容进行了非常简洁的可视化。如果您需要快速起草正则表达式，这是一个很好的资源。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T13:16:51.203

你为什么不使用一些正则表达式工具（我通常使用[Regulator](http://sourceforge.net/projects/regulator/)）并在那里测试正则表达式，当你满意时，只需将其复制/粘贴到你的代码中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T13:17:56.537

不确定直接在 Python 中做这样的事情，但我绝对可以建议使用 RegEx 编辑器工具。无论如何，这可能是你最好的选择。就个人而言，我使用过[The Regulator](http://sourceforge.net/projects/regulator/)并发现它非常有帮助。其他一些列在[这个 SO 线程](https://stackoverflow.com/questions/32282/regex-testing-tools#32365)中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-03T13:23:04.997

与已经提到的类似，还有[Regexbuddy](http://www.regexbuddy.com/benefits.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-03T14:00:22.690

我经常使用[RegexPal](http://regexpal.com/)进行快速检查（一个在线正则表达式原型器）。它列出了许多常见的表达方式以及一个简单的表达方式。当您没有专用工具并且只需要一种快速的方法来制定一个简单的正则表达式时，它非常方便。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-04T01:44:12.657

RegexBuddy 具有其他工具所没有的是一个内置[调试器](http://www.regexbuddy.com/debug.html)，它向您显示成功和失败匹配尝试的整个匹配过程。其他工具只显示最终结果（RegexBuddy 也可以显示）。

# java - 如何在 Java 中模拟 Web 服务器以进行单元测试？

> ID：606352
> 
> 赞同：53
> 
> 时间：2009-03-03T13:14:30.600
> 
> 标签：java, junit

我想使用模拟 Web 服务器创建一个单元测试。是否有一个用 Java 编写的 Web 服务器，可以通过 JUnit 测试用例轻松启动和停止？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2015-02-11T23:07:38.583

[Wire Mock](http://wiremock.org/index.html)似乎提供了一组可靠的存根和模拟来测试外部 Web 服务。

```
@Rule
public WireMockRule wireMockRule = new WireMockRule(8089);

@Test
public void exactUrlOnly() {
    stubFor(get(urlEqualTo("/some/thing"))
            .willReturn(aResponse()
                .withHeader("Content-Type", "text/plain")
                .withBody("Hello world!")));

    assertThat(testClient.get("/some/thing").statusCode(), is(200));
    assertThat(testClient.get("/some/thing/else").statusCode(), is(404));
} 
```

它也可以与 spock 集成。示例在[这里](https://allegro.tech/2015/07/testing-server-faults-with-Wiremock.html)找到。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-03-03T13:56:20.127

您是否尝试使用[*模拟*或*嵌入式*](http://www.martinfowler.com/bliki/TestDouble.html)Web 服务器？

对于*模拟*Web 服务器，请尝试使用[Mockito](https://github.com/mockito/mockito)或类似的东西，然后模拟`HttpServletRequest`和`HttpServletResponse`对象，例如：

```
MyServlet servlet = new MyServlet();
HttpServletRequest mockRequest = mock(HttpServletRequest.class);
HttpServletResponse mockResponse = mock(HttpServletResponse.class);

StringWriter out = new StringWriter();
PrintWriter printOut = new PrintWriter(out);
when(mockResponse.getWriter()).thenReturn(printOut);

servlet.doGet(mockRequest, mockResponse);

verify(mockResponse).setStatus(200);
assertEquals("my content", out.toString()); 
```

对于*嵌入式*Web 服务器，您可以使用[Jetty](https://www.eclipse.org/jetty/)，您可以[在测试](https://stackoverflow.com/questions/1593016/run-jettys-servlettester-within-junit-test)中使用它。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2017-03-01T17:39:48.477

您也可以使用 JDK 的类编写模拟`com.sun.net.httpserver.HttpServer`（不需要外部依赖项）。请参阅[此博客文章](https://alistairisrael.wordpress.com/2009/09/02/functional-http-testing-with-sun-java-6-httpserver/)，详细说明如何操作。

总之：

```
HttpServer httpServer = HttpServer.create(new InetSocketAddress(8000), 0); // or use InetSocketAddress(0) for ephemeral port
httpServer.createContext("/api/endpoint", new HttpHandler() {
   public void handle(HttpExchange exchange) throws IOException {
      byte[] response = "{\"success\": true}".getBytes();
      exchange.sendResponseHeaders(HttpURLConnection.HTTP_OK, response.length);
      exchange.getResponseBody().write(response);
      exchange.close();
   }
});
httpServer.start();

try {
// Do your work...
} finally {
   httpServer.stop(0); // or put this in an @After method or the like
} 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2009-03-03T13:40:21.817

尝试[简单](http://www.simpleframework.org)（[Maven](http://search.maven.org/#search%7Cga%7C1%7Cg%3A%22org.simpleframework%22%20a%3A%22simple%22)）它很容易嵌入到单元测试中。以 RoundTripTest 和使用 Simple 编写的[PostTest](https://svn.code.sf.net/p/simpleweb/svn/trunk/simple-test/src/test/java/org/simpleframework/http/validate/test/PostTest.java)等示例为例。提供如何将服务器嵌入到您的测试用例中的示例。

此外，Simple 比 Jetty 更轻、更快，没有依赖项。因此，您不必在类路径中添加多个 jar 文件。您也不必担心`WEB-INF/web.xml`或任何其他工件。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2014-11-13T10:42:03.433

另一个不错的选择是[MockServer](http://www.mock-server.com/)；它提供了一个流畅的界面，您可以使用该界面定义模拟 Web 服务器的行为。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2016-01-22T20:33:06.577

您可以尝试[Jadler](https://github.com/jadler-mocking/jadler/wiki)，它是一个具有流畅的编程 Java API 的库，用于在您的测试中存根和模拟 http 资源。例子：

```
onRequest()
    .havingMethodEqualTo("GET")
    .havingPathEqualTo("/accounts/1")
    .havingBody(isEmptyOrNullString())
    .havingHeaderEqualTo("Accept", "application/json")
.respond()
    .withDelay(2, SECONDS)
    .withStatus(200)
    .withBody("{\\"account\\":{\\"id\\" : 1}}")
    .withEncoding(Charset.forName("UTF-8"))
    .withContentType("application/json; charset=UTF-8"); 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2018-01-10T14:15:46.457

如果您使用的是 apache HttpClient，这将是一个不错的选择。 [HttpClientMock](https://github.com/PawelAdamski/HttpClientMock)

```
HttpClientMock httpClientMock = new httpClientMock() 
HttpClientMock("http://example.com:8080"); 
httpClientMock.onGet("/login?user=john").doReturnJSON("{permission:1}"); 
```

基本上，您然后对您的模拟对象发出请求，然后可以对其进行一些验证`httpClientMock.verify().get("http://localhost/login").withParameter("user","john").called()`

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-03-03T13:19:22.307

尝试使用[Jetty 网络服务器](http://www.eclipse.org/jetty/)。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2020-01-09T07:29:25.747

我推荐[Javalin](https://javalin.io/)。它是模拟真实服务的绝佳工具，因为它允许在测试中进行状态断言（服务器端断言）。

也可以使用[Wiremock 。](http://wiremock.org/)但这会导致难以维护行为测试（验证客户端调用是否符合预期）。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-10-02T15:29:03.877

为了完整起见，还用[骆驼](https://camel.apache.org/components/latest/jetty-component.html)包裹码头，使其更加用户友好。

让你的测试类扩展`CamelTestSupport`，然后定义一个路由前：

```
 @Override
  protected RouteBuilder createRouteBuilder() {
    return new RouteBuilder() {
      @Override
      public void configure() {
        from("jetty:http://localhost:" + portToUse).process(
                new Processor() {
                  @Override
                  public void process(Exchange exchange) throws Exception {
                    // Get the request information.
                    requestReceivedByServer = (String) exchange.getIn().getHeader(Exchange.HTTP_PATH);

                    // For testing empty response
                    exchange.getOut().setBody("your response");
                    .... 
```

获取它的示例 Maven 依赖项：

```
<dependency> <!-- used at runtime, by camel in the tests -->
  <groupId>org.apache.camel</groupId>
  <artifactId>camel-jetty</artifactId>
  <version>2.12.1</version>
  <scope>test</scope>
</dependency>
<dependency>
  <groupId>org.apache.camel</groupId>
  <artifactId>camel-core</artifactId>
  <version>2.12.1</version>
  <scope>test</scope>
</dependency>
<dependency>
  <groupId>org.apache.camel</groupId>
  <artifactId>camel-test</artifactId>
  <version>2.12.1</version>
  <scope>test</scope>
</dependency> 
```

# silverlight - XAML 矢量到 Illustrator 或类似

> ID：606360
> 
> 赞同：6
> 
> 时间：2009-03-03T13:16:18.943
> 
> 标签：silverlight, xaml, vector-graphics, adobe-illustrator

我可以很容易地从 Adob​​e Illustrator 中通过 XPS 虚拟打印机制作 XAML 文件，但是有没有办法将 XAML 中定义的矢量图形导入 Adob​​e Illustrator 以继续处理它？

干杯

```
Nik 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-20T20:38:39.180

您可以尝试使用[Inkscape](http://www.inkscape.org/)将您的 XAML 转换为 Illustrator 可以理解的格式。它支持 XAML 导入和导出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-08-25T06:43:04.243

将 Expression Designer 中的绘图导出为 PDF 或 PSD 并在 Illustrator 中打开

# flash - 无法使用动作脚本通过网络摄像头实现放大/缩小？

> ID：606362
> 
> 赞同：1
> 
> 时间：2009-03-03T13:16:30.643
> 
> 标签：flash, actionscript-3, actionscript, webcam, zooming

我猜这是不可能的，因为我的谷歌搜索没有产生任何结果！

所以问stackoverflow人才，如果网络摄像头具有缩放功能，我是否可以让网络摄像头放大和缩小？我猜没有？

这是我正在做的一个图像捕捉项目。

谢谢大家

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T13:25:42.073

不，您不能使用网络摄像头自己的缩放功能。不过，您可以实现“数字变焦”，具体取决于相机支持的分辨率，它可能看起来要么完全糟糕，要么看起来很差劲。

# c# - C#疑问，寻找数据类型

> ID：606365
> 
> 赞同：1
> 
> 时间：2009-03-03T13:17:14.540
> 
> 标签：c#, parsing, types

我有以下变量：

```
string str1 = "1";
string str2 = "asd";
string str3 = "3.5";
string str4 = "a"; 
```

现在我需要找到每个字符串的数据类型，即如果引号被删除，它可以转换成的数据类型。这是我希望每个变量转换为的内容：

> str1 - 整数
> str2 - 字符串
> str3 - 双
> 精度 str4 - 字符

注意：如果字符串有单个字符，它应该是 char，虽然字符串可以有单个字母，但我限制了它。

仅供参考：这些值是从我手动输入值的 DataGrid 获得的。所以一切都变成了一个字符串。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-03T13:24:12.763

当然，没有明确的方法可以做到这一点，但是如果您创建一个要按优先级排序的数据类型列表，那么这样的事情可能会奏效。

```
object ParseString(string str)
{
    int intValue;
    double doubleValue;
    char charValue;
    bool boolValue;

    // Place checks higher if if-else statement to give higher priority to type.
    if (int.TryParse(str, out intValue))
        return intValue;
    else if (double.TryParse(str, out doubleValue))
        return doubleValue;
    else if (char.TryParse(str, out charValue))
        return charValue;
    else if (bool.TryParse(str, out boolValue))
        return boolValue;

    return null;
} 
```

只需在每个字符串上调用此函数，您就应该返回适​​当类型的对象。一个简单的类型检查可以告诉你字符串是如何被解析的。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-03T13:30:24.917

**如果可以的话，**使用元数据****

 **您必须猜测数据类型是什么，这不是一个好主意。

两件事情

1 数据从哪里来？

如果是数据库，您确定它们是字符串吗？如果是数据库，应该返回一些元数据，告诉你字段的数据类型是什么。

如果它是一个 Xml 文件，是否定义了一个模式来为您提供类型？

2 如果非要继续猜。

请注意，您可以有恰好是数字的字符串，但它们是完全有效的字符串，例如电话号码、银行帐户号码，最好用字符串表示。这些数字也可以有很多位，如果将它们转换为双精度数，您可能会将一些数字丢失为浮点不准确（最多 14 位或 15 位数字应该没问题）

I'm sure by now - cause I've taken my time typing this - there are lots of answers telling you how to do this (i.e. tryparse int first, then double, then test length for char, if not then it's a string etc), but if I were you, I'd try to NOT do that, and see if there's any way you can get, or pass some meta-data that will tell you what type it **IS** and not just what type it *might* be

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-03T13:22:35.340

使用`TryParse`每种类型的方法。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-03T13:22:52.313

没有内置的方法可以做到这一点，您可以在数字类型上尝试 TryParse 以提高精度，但它不能保证它是正确的。

你最好的选择是像手动一样处理它。即有小数位吗？不 - 然后它是一个整数。多大？是负面的吗？

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-03T13:24:12.903

这些项目中的每一项的数据类型都是字符串。如果您想尝试将它们解析为不同的类型，您可以使用 Int32.TryParse、Double.TryParse 等。或者您可以使用 Regex：

```
bool isInt = new Regex(@"^\d+$").IsMatch(str);
bool isDouble = !(isInt) && new Regex(@"^\d+\.\d+$").IsMatch(str);
bool isChar = !(isInt || isDouble) && new Regex(@"^.$").IsMatch(str);
bool isString = !(isInt || isDouble || isChar); 
```

# django - memcached 缓存请求？

> ID：606372
> 
> 赞同：7
> 
> 时间：2009-03-03T13:22:10.303
> 
> 标签：django, memcached

在我的 django 项目缓存多个视图后 -@cache_page(60 * 5)- 我注意到 memcached 缓存了整个视图，甚至是请求参数！因此，如果第一个访问页面的用户是以 userxyz 身份登录的，那么所有其他询问同一页面的匿名或注册用户都将看到由用户 userxyz 缓存的页面！显然这不是一个理想的行为......所以我可以缓存视图上的所有内容，而不是请求参数吗？还是 memcached 仅适用于匿名会话？

提前致谢， 马科斯·戈古洛斯

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-03T13:30:57.160

如果您在一个页面上混合动态和静态数据，在您的情况下，动态数据是登录用户的用户名，那么页面缓存不是正确的选择。如果您使用基于文件的缓存存储而不是 memcached，这不会改变。

我建议尝试片段缓存。你可以这样做：

```
{% load cache %}
{% cache 500 sidebar %}
    .. sidebar ..
{% endcache %} 
```

这将使用标识符侧边栏将缓存标记的内容缓存 500 秒。

您可以在此处找到有关缓存的更多信息：

[http://docs.djangoproject.com/en/dev/topics/cache/](http://docs.djangoproject.com/en/dev/topics/cache/)

* * *

如果这是一个经常被点击的页面，例如欢迎页面，您认为使用页面缓存而不是片段缓存会受益（例如，唯一的动态数据是用户名），那么有一些其他选项。

例如，您希望拥有一个完全静态的页面，除了顶部的登录/注销部分，该部分根据用户是否登录显示不同的链接，然后您可以在页面打开时检查身份验证 cookie 的存在首先使用javascript加载并有条件地显示不同的数据。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T13:35:19.973

Memcached 只是一个后端。它会缓存您告诉它缓存的任何内容。所以你的问题真的是*“Django 的整页缓存适合动态页面吗？”* 可能您不想缓存整个页面，只是其中的一部分。或仅用于匿名请求的页面（使用`CACHE_MIDDLEWARE_ANONYMOUS_ONLY`）

参考书 [http://www.djangobook.com/en/1.0/chapter13/](http://www.djangobook.com/en/1.0/chapter13/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T16:48:10.990

您可能想要查看[模板片段](http://docs.djangoproject.com/en/dev/topics/cache/?from=olddocs#template-fragment-caching)并缓存那些非用户特定的内容。

# svn - 停止 CruiseControl.NET 自动构建

> ID：606376
> 
> 赞同：4
> 
> 时间：2009-03-03T13:22:42.983
> 
> 标签：svn, cruisecontrol.net

我有带有 SVN 源代码控制的 CruiseControl.NET 设置。

我的所有项目都运行良好，构建并部署到我不同的暂存环境。

但是，只要在 SVN 中对项目进行提交，CC.NET 就会自动开始构建。我们希望按需构建，而不是一直自动构建，因为我们所有的构建都部署到登台并且测试人员将一直注销。

有谁知道如何禁用此功能？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-03T13:33:48.090

这很简单，尽管我应该学习阅读 CC.NET 中项目的触发器部分的文档：

> 指定一个空元素 ( `<triggers />`) 意味着只能手动强制集成（例如使用 CCTray 或 Web Dashboard。）根本不包括元素意味着项目有一个具有默认配置的间隔触发器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T13:29:18.787

如果您访问 CCnet 的管理站点，您可以停止自动构建并使用 force 选项强制构建，或者您可以设置一个足够高的时间来检查新提交，可能是 8 小时，以便每天进行 1 个构建在测试人员开始工作之前。

希望这可以帮助你。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-23T14:56:06.013

版本：1.4.0.3524 - 按设计工作，无法在 Web 仪表板中看到，但托盘客户端明确表示：“项目不会自动触发”

# c# - 通过算法检查两打值，针对数据列的文本框

> ID：606378
> 
> 赞同：0
> 
> 时间：2009-03-03T13:23:01.983
> 
> 标签：c#, winforms, comparison, iteration

好吧，大脑袋这里的东西比要求更具挑战性。我有点难过。我通常只需要一个正确方向的刺激，所以准备好你的刺激棒。

我有一个包含在文本框中的选项卡控件。我想在同一表单上的列表视图上的 SelectedIndexChanged 事件期间检查所有文本框的内容。如果其中一个文本框具有与 DataTable 行不同的数据（由 ListView 项表示），我希望它询问用户是否愿意保留他们刚刚所做的更改。如果没有任何改变，我希望它只是改变选择。

所以很明显，我正在将文本框的内容与数据行中的相关列进行比较。

我可以强行检查并一次进行每个单独的检查。我宁愿想出一些巧妙的算法方法来循环遍历 tabcontrol 文本框并根据列值检查值。

有什么建议么？

编辑：我最喜欢下面的“巧妙命名的文本框”解决方案，尽管两者都很好。如果在接下来的 14 天内没有其他人有更好的想法，那么文本框的答案就会变成绿色。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-03T13:30:16.273

给文本框起一个巧妙的名称，因为名称的一部分是列/行名称。

分组文本框控件循环通过它们。对于每个控件，获取（部分）名称并将其用作对数据表的引用。检查值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T13:30:16.337

如果我对您的理解正确，您希望避免在每次更改时比较每个文本框，而只检查由 ListView 控件的 SelectedIndexChanged 事件驱动的更改的文本框。是对的吗？

好吧，DataRows 和 DataTables 已经实现了行版本控制和回滚，所以如果您将文本框绑定到底层行（通过编写事件来写回更改/失去焦点或使用自动化机制来完成相同的任务），然后检查 SelectedIndexChanged 上的 RowState 属性。如果 RowState 未更改，则提示用户保存。如果他保存，则提交更改，否则拒绝它们。

因此，例如，您希望在 SelectedIndexChanged 事件处理程序中使用类似的内容：

```
if (row.RowState == DataRowState.Modified) {
  // prompt for user input
  if (promptResult == PromptResult.Save) {
    row.AcceptChanges();
  }
  else {
    row.RejectChanges();
  }
} 
```

# php - 使用正则表达式解析 HTML 时转义 -> 和 =>

> ID：606402
> 
> 赞同：0
> 
> 时间：2009-03-03T13:31:09.390
> 
> 标签：php, regex

我需要解析并返回 PHP 代码文件中的标记名和属性：

```
<ct:tagname attr="attr1" attr="attr2"> 
```

为此，构建了以下正则表达式：

```
(\<ct:([^\s\>]*)([^\>]*)\>) 
```

此表达式按预期工作，但在解析以下代码时会中断

```
<ct:form/input type="attr1" value="$item->field"> 
```

由于 $item-> 字段中的 > 字符，原始正则表达式中断。我需要构建一个忽略 -> 或 => 但不是单个 > 的正则表达式。

我愿意接受任何建议......提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T13:44:35.787

试试这个：

```
<ct:([^\s\>]*)((?:\s+\w+\s*=\s*(?:"[^"]*"|'[^']*')\s*)*)> 
```

但如果那是 XML，最好使用 XML 解析器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T13:42:01.987

一般来说，任何解析问题都会很快遇到上下文无关但不规则的语言结构。编写一个上下文无关的解析器可能是一个更好的[1] 解决方案，忽略除您感兴趣的元素之外的所有内容。

[1] 从“做对的事”的角度来看，“更好”，不一定是投资回报。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T13:43:26.507

您可以尝试像这样使用负面的lookbehind：

```
(\<ct:([^\s\>]*)(.*?)(?<!-|=)\>) 
```

火柴 ：

```
<ct:tagname attr="attr1" attr="attr2">
<ct:form/input type="attr1" value="$item->field"> 
```

不确定它是否最适合您的情况，但尊重约束。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T13:38:45.863

我认为您想要做的不是识别`->`and `=>`，而是忽略引号之间的所有内容。

我认为可以通过插入（（

```
("[^"]*")* 
```

)) 在合适的地方。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-03T13:57:40.840

我的建议是匹配同一表达式中的属性。

```
\<ct:([^\s\>]*)((([a-x0-9]+)=\"([^\"]*)\")*)\> 
```

**编辑：**删除了关于 >在属性值中不是有效[xml的部分。](http://www.w3.org/TR/REC-xml/#syntax)

# c# - 锻炼分钟和小时

> ID：606404
> 
> 赞同：5
> 
> 时间：2009-03-03T13:31:51.713
> 
> 标签：c#, .net, datetime

我有一个分钟值，我想有 2 个字符串值，一个是多少小时，另一个是分钟，例如：

价值 - 121 分钟

字符串小时 = 2
字符串分钟 = 1

价值 - 58 分钟

字符串小时 = 0
字符串分钟 = 58

如何在 C# 中解决这个问题？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-03-03T13:38:04.913

```
var span = System.TimeSpan.FromMinutes(121);
var hours = ((int)span.TotalHours).ToString();     
var minutes = span.Minutes.ToString(); 
```

ToString() 是因为您要求提供字符串值...

TotalHours 是 TimeSpan 中的完整小时数，它们可以超过 24（而“小时”字段最多为 24）

哦，再想一想：为什么要使用 TimeSpan 而不是自己计算呢？因为 TimeSpan 已经由 Microsoft 调试和测试，所以它有一个漂亮干净的界面（查看代码，您可以轻松地看到发生了什么，而无需在心里进行计算）并且它很容易扩展到进一步的解决方案。（输入以秒为单位？使用 TimeSpan.FromSeconds()。想要天数吗？使用 span.TotalDays ...）

***更新：***

我刚刚注意到我的回答中有错误：TotalHours 返回所有小时的小数值，因此我们必须先将其截断为整数，然后再将其转换为字符串。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-03T13:37:15.693

使用 Timespan 结构及其[Parse](http://msdn.microsoft.com/en-us/library/system.timespan.parse.aspx)方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-03T13:34:34.953

```
int value = 121;
int hours = value / 60; // 2
int minutes = value % 60; // 1

string strHours = hours.ToString();
string strMinutes = minutes.ToString(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-03T13:37:16.520

```
int value = 121;
int hours = value / 60;
int minutes = value % 60; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-03T14:02:16.947

```
int value = 121;
TimeSpan timeSpan = TimeSpan.FromMinutes(value);

// gives you the rounded down value of 2
int hours = timeSpan.Hours; 

// gives you the minutes left of the hour
int minutes = value - (hours * 60); 
```

# ssl - 如何使用网络钓鱼过滤器在 SSL 下使用 iframe 消除页面上的安全非安全警告？

> ID：606411
> 
> 赞同：0
> 
> 时间：2009-03-03T13:34:59.147
> 
> 标签：ssl, filter, phishing

我在 SSL 下有一个带有 iframe 的页面，它通过 HTTP 刷新 prgama 每 20 秒刷新一次。如果我在启用 IE7 并启用网络钓鱼过滤器的情况下浏览该站点，我会以不规则的时间间隔收到安全-非安全内容警告，如果网络钓鱼过滤器被禁用，这些警告就会停止。即使启用了网络钓鱼过滤器，是否有人知道我可以做些什么来消除警告？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T14:11:25.877

You should make sure the iframe url is using ssl(https).

I'm not sure how the phishing filter in IE works but I would make sure all iframes also comes from the same domain.

I assume that the content you are getting in the iframe is not from your own code.

One way to do both would be to setup a simple web "proxy", an address in your server that only forwards contents from the other website. This would though increase your server traffic by twice the amount that you visitor today is consuming. However this could be reduced to half by caching the data assuming it is the same for all your visitors.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T13:47:03.363

That's a browser setting in IE7 which you wouldn't be able to enable/disable from your code. It's something that you'll have to fix so the user doesn't get the message in the first place.

[This may help you.](http://weblogs.asp.net/rchartier/archive/2008/03/12/ie7-this-page-contains-both-secure-and-nonsecure-items.aspx)

# c# - iBATIS.NET 可以与 ICollection 一起使用吗？

> ID：606415
> 
> 赞同：1
> 
> 时间：2009-03-03T13:37:14.243
> 
> 标签：c#, .net, ibatis.net, icollection

这个问题与我的另一个问题有关：[Using iBATIS.NET with generic custom collection interfaces and Unity](https://stackoverflow.com/questions/603808/using-ibatis-net-with-generic-custom-collection-interfaces-and-unity)

问题似乎是 iBATIS.NET 只会填充自定义集合（即 QueryForObject("Select_Foo") ，它具有自定义的 Bars 集合），如果它是自定义集合的具体实例而不是接口。有谁知道这是否是 iBATIS.NET 的限制，或者是否有办法做到这一点？

谢谢，

保罗

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T06:47:11.213

如果我理解正确，那么您希望完全控制 iBatis 映射到某个对象的方式。

您可以使用[ITypeHandlerCallback](http://ibatis.apache.org/SDK/dotnet/IBatisNet.DataMapper.TypeHandlers.ITypeHandlerCallback.html)执行此操作。在“3.5.5\. 自定义类型处理程序”部分的[PDF 文档](http://gd.tuwien.ac.at/infosys/servers/http/apache/dist/ibatis/binaries/ibatis.net/Doc-DataMapper-1.6.2.zip)中查看完整描述。

我对 DataTables 做了类似的事情。您的实现可能与此类似：

```
class DataTableBuilder : ITypeHandlerCallback
{
    public object GetResult(IResultGetter getter)
    {
        IDataReader reader = getter.DataReader;

        // (A) define whatever type you want to

        // (B) read rows from DataReader and populate your type from (A)
        while (reader.Read())
        {
            // iterate over the columns of the current row
            for (int i = 0; i < reader.FieldCount; i++)
            {
               // populate your type from (A)
            }                    
        }
        return ...;   // return your type from (A)
    }

    // implement the other members of ITypeHandlerCallback
    // the implementation below actually worked for me
    public object NullValue { get { return null; } }
    public void SetParameter(IParameterSetter setter, object parameter) { }
    public object ValueOf(string s) { return s; }
} 
```

最后一点：iBatis 非常适合构建数据传输对象 (DTO)。如果您尝试上述方法，您可能已经转向业务对象方法。使用 iBatis 可能会很痛苦。目前（好吧......由于时间不够，已经几个月了）我正在评估 NHibernate 作为替代方案。我认为 NHibernate 比 iBatis 更顺畅地处理业务对象方法。

# php - .NET & ASP 与 PHP

> ID：606419
> 
> 赞同：11
> 
> 时间：2009-03-03T13:37:28.470
> 
> 标签：php, asp.net

今天早些时候，我问使用 C# 开发网站是否是个好主意。大多数答案都指向 .NET 和 ASP。目前我用PHP开发。我涉足过 Python 和 RoR，但我总是回到 PHP。这是我第一次看到 .NET 和 ASP。谷歌搜索的桶负载稍后我并没有真正看到对 ASP 的在线支持，但是这一切似乎有点偏向 PHP/Apache/MySQL。

看起来这里有相当多的 .NET 和 ASP 人员，所以我认为值得一试，征求他们的意见，以尝试解决我自己头脑中的平衡问题。不可能都是坏事。

.NET 和 ASP 比 PHP 有什么优势？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-03T13:41:07.993

用过的：

> asp.net vs php 网站：stackoverflow.com

在谷歌搜索并得到：

[ASP.NET 与 PHP](https://stackoverflow.com/questions/304948/aspnet-vs-php)

[PHP vs ASP.net 的使用](https://stackoverflow.com/questions/543458/the-use-of-php-vs-asp-net-closed)

[PHP MVC (symfony/Zend) vs ASP MVC vs Spring MVC vs Ruby on Rails？](https://stackoverflow.com/questions/253785/php-mvc-symfony-zend-vs-asp-mvc-vs-spring-mvc-vs-ruby-on-rails)

[从事 PHP 或 ASP.NET 的职业？](https://stackoverflow.com/questions/558124/career-with-php-or-with-asp-net)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-03T13:50:40.937

我会说这取决于您的背景以及您也必须投入多少钱。ASP.net 有一些很棒的功能，但根据您的项目，您甚至可能不需要它们。工具很贵，托管也很贵。

PHP 很棒，因为您可以免费获得很多东西，但也需要权衡取舍。

就我个人而言，我更喜欢 .NET，因为这就是我开始的方式，我觉得我可以事半功倍，但这是个人喜好。我敢肯定，一些兽医 php 开发人员也有同样的感受。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T13:45:40.200

看看法朗格。它是在 .Net 框架上运行的 PHP，并且在过去几个月中取得了长足的进步。来自 PHP 时绝对值得研究。

[帕朗厄尔](http://www.codeplex.com/Wiki/View.aspx?ProjectName=Phalanger)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-03T13:48:19.990

我有 Perl/CGI、Classic ASP 和 ASP.NET 的背景。我决定使用 PHP 来看看为什么会有这么多的追随者。我觉得我在语言规模上倒退了一步，宁愿用 .NET 或 Perl 编写代码。

我认为杰夫阿特伍德会在这方面对我进行升级。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-05-09T13:35:13.300

以下是您应该继续使用 PHP 的原因：

[http://www.slideshare.net/eplawless/exception-safety-and-garbage-collection-and-some-other-stuff](http://www.slideshare.net/eplawless/exception-safety-and-garbage-collection-and-some-other-stuff)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-03T13:48:33.280

我在 PHP5 出来之前就停止使用 PHP，所以我认为我对 PHP 的看法已经过时了。尽管如此，我喜欢 C#（ASP.NET）的地方在于它迫使我获得更好的编程实践（尤其是 OO）。PHP4 不是面向对象的。可能以后的 PHP 版本不一样。我从 PHP 转向 ASP.NET 时遇到的最大障碍是理解 OO。如果对象不是您的编程风格的第二天性，您可能会发现您的 ASP.NET 学习曲线将比使用 PHP 时要浅得多。

# web-applications - Web应用程序的替代品？

> ID：606425
> 
> 赞同：3
> 
> 时间：2009-03-03T13:38:50.310
> 
> 标签：web-applications, language-agnostic

假设您有一个客户想要一个应用程序集中存储和维护其数据，用户可以连接到它（但也可以在本地存储数据）并使用它，而不是使用浏览器来查看和修改数据。此外，应用程序本身也应该集中维护。

所以没有传统的网络应用程序，但它仍然应该有它的好处。你们中的一些人知道如何解决这个问题吗？我考虑了一个客户端/服务器解决方案——但我不知道它如何随着用户、数据等的增长而扩展。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-03T13:41:59.863

我建议使用 C# 和 ClickOnce 进行部署。对于 UI，我个人的选择是 WPF；用于数据层 - Linq To SQL 或 EF（尽管很多人抱怨 EF）。

如果您希望某些逻辑在服务器上运行，您可以使用 WCF 将其公开给客户端。

当然，这使它以 Windows 为中心。因此，如果您也需要 Linux，您可以查看带有 xcopy 部署和 WinForms 的 C#/Mono。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-03T13:44:35.317

对于 Java，您将使用 Java Web Start 并使用 Web 服务或类似的东西（RMI、REST 等）与服务器通信。它支持本地存储等。有关更多信息，请阅读[Java Web Start 指南。](http://java.sun.com/developer/technicalArticles/Programming/jnlp/)如果你想要华丽的 UI，你可以使用 JavaFX 脚本。

**编辑**至于可扩展性，如果有任何线索，这样的解决方案应该与等效的 Web 应用程序一样可扩展*（可能更好，正如 S.Lott 在评论中提到的那样）*。您有一个 Web 服务调用，而不是一个页面请求。彼此彼此。

此外，JWS 类似于 ClickOnce，但在“所有”平台上运行，并且要求您使用 AWT/Swing（这很痛苦）或 JavaFX（不太成熟）。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-03T13:48:33.093

研究智能客户端技术。它为您提供两全其美的体验。具有扩展潜力的轻量级用户前端。还允许轻松部署和 Web 的灵活性。微软也一直在推动这项技术。

他们甚至在[这里有一个智能客户端软件工厂](http://msdn.microsoft.com/en-us/library/aa480482.aspx)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-03T13:45:47.593

[Adobe Air](http://www.adobe.com/products/air/)允许您使用 javascript、html 和 flash 构建客户端应用程序。它还包括一个自动更新程序，以便您可以维护您的应用程序，以及您可以存储本地数据的本地数据库。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-03T13:46:22.473

瘦客户端应用程序可能是您正在寻找的。

我能想到的最接近的东西是[Jade](http://www.jadeworld.com/)，它包含一个面向对象的数据库、语言和工具，并且非常常用于要维护的 1 台服务器上的数据库和应用程序以及连接瘦客户端。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-03T13:43:40.547

你想要的是所谓的 RIA，富互联网应用程序，有很多方法可以做到这一点。

基本上，您将应用程序分为 2 部分： - 服务器端 - 客户端

服务器端和客户端使用某种协议进行通信，最广泛接受的是 HTTP，即使您不想要 Web 应用程序，因为 HTTP 请求更有可能穿越防火墙。

您在 Flex 中对客户端进行编程，这将允许您在浏览器或桌面上运行它，您可以在 html/css/javascript（一个标准的 Web 应用程序）中编写您的客户端，并且有数十种替代方案。

但底线是：你想要的是所谓的 RIA。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-03T13:51:55.427

HTML5不会解决这个问题的很大一部分吗？只要坚持让您的客户使用支持 HTML5 的浏览器访问它，您就离开了，不是吗？

我可能会遗漏一些东西。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-02-14T18:18:19.297

不好意思我迟到了。但也许我的回答会对阅读它的其他人有用。

> 如果客户想要一个应用程序集中存储和维护其数据，用户可以连接到它并使用它，而不是使用浏览器来查看和修改数据。

在他们的盒子（几乎可以在任何操作系统上运行）和您的服务器上坚持托管 inferno。让应用程序在*他们的*inferno 上运行，但将数据集中在*您的*inferno 上。让他们的 inferno 的 init 脚本直接启动您的应用程序，而不必从菜单或其他东西中选择它。

您可以使用任何您喜欢的协议连接他们和您的终端，但如果您使用 styx 协议，那么远程访问只是他们的应用程序使用常规打开/读取/写入/搜索/关闭调用的问题。styx 可以被认证和加密。权限当然也适用。

> （但也可以在本地存储数据）

和上面一样。本地本身只是本地+远程一起的特例。

> 此外，应用程序本身也应该集中维护。

你的意思是，他们使用的程序应该存储在你的服务器上，下载并在他们的机器上运行？为此，您将二进制文件保存在服务器的 /bin 中，并在其末尾将其初始化脚本绑定 /n/yourserver/bin 到它自己的 /bin 中。然后当他们的启动脚本尝试加载应用程序时，它会在 /bin 中查找它。然后它只是加载并运行它，就好像它是本地的一样。

权限适用，因此他们无法将您的盒子弄乱。

也可以在您的服务器上进行所有执行，仅将它们的末端用作显示。在地狱术语中，这称为“cpu”。

如果他们正在寻找图形，图形程序真的很容易在 inferno 中编写。查看 8½ 论文中的图形 hello world。将其与您知道的任何其他图形进行比较，您会发现它更容易。

如果你找到一个 inferno 屏幕截图并看到它有自己的整个窗口管理器在其窗口内运行，而你不希望这样，也可以让你的应用程序直接写入主窗口。它不知道区别。如果您查看“acme SAC”，您就会明白我的意思。acme SAC 的字体也比你在多年前的 inferno 截图中看到的字体更好。

# c# - 在 WPF（使用数据绑定）中进行表单验证的最佳方法是什么？

> ID：606442
> 
> 赞同：1
> 
> 时间：2009-03-03T13:45:37.890
> 
> 标签：c#, .net, wpf, validation, data-binding

我有几个带有许多文本框/组合框的表单，我希望在至少一个字段无效时禁用“保存”按钮。我已经能够设置一些自定义验证规则，如下所示（显示文本框示例）：

```
<Binding Path="Name">
    <Binding.ValidationRules>
        <my:TextFieldNotEmpty/>
    </Binding.ValidationRules>
</Binding> 
```

我的问题是：如何设置我的表单，以便即使 1 个验证规则失败，“保存”按钮也不会启用？是否有处理情况的标准方法（可能是触发器），或者这是 WPF 不足的地方？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T14:22:03.997

这会回答你的问题吗？ [检测 WPF 验证错误](https://stackoverflow.com/questions/127477/detecting-wpf-validation-errors)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-08-16T17:17:56.830

您可能对**[WPF 应用程序框架 (WAF)](http://waf.codeplex.com)****的BookLibrary**示例应用程序感兴趣。它展示了如何在 WPF 中使用验证，以及在存在验证错误时如何控制“保存”按钮。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T12:07:17.560

查看 SignumFramework ErrorSummary 类：

[http://www.signumframework.com/EntityControls.ashx#ErrorSummary](http://www.signumframework.com/EntityControls.ashx#ErrorSummary) [http://signum.codeplex.com/SourceControl/changeset/view/25903#510524](http://signum.codeplex.com/SourceControl/changeset/view/25903#510524)

# python - 蟒蛇设计模式

> ID：606448
> 
> 赞同：169
> 
> 时间：2009-03-03T13:47:28.790
> 
> 标签：python, design-patterns

我正在寻找任何提供最佳实践、设计模式和使用 Python 的 SOLID 原则示例的资源。

* * *

## 回答 #1

> 赞同：152
> 
> 时间：2009-03-03T14:03:45.973

在这些方面有些重叠

[Python中的中级和高级软件木工](https://web.archive.org/web/20180504173504/http://ivory.idyll.org/articles/advanced-swc/)

[像 Pythonista 一样编写代码：惯用的 Python](https://web.archive.org/web/20180411011411/http://python.net/~goodger/projects/pycon/2007/idiomatic/handout.html)

[Python 习语和效率](https://web.archive.org/web/20120118192448/http://jaynes.colorado.edu/PythonIdioms.html)

[美国谷歌开发者日 - Python 设计模式](http://www.youtube.com/watch?v=0vJJlVBVTFg)

另一个资源是[Python 食谱](https://github.com/ActiveState/code)中的示例。很多人不遵循最佳实践，但您可以在其中找到一些有用的模式

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2009-03-04T12:16:09.330

类型

```
>>> import this 
```

在 Python 控制台中。

尽管这通常被视为（很好！）笑话，但它包含几个有效的特定于 python 的公理。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-03-04T09:55:25.127

Bruce Eckel*[在 Python 中的思考](http://docs.linuxtone.org/ebooks/Python/Thinking_In_Python.pdf)*很大程度上依赖于设计模式

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-03-03T13:48:44.043

您可以从[这里](http://www.python.org/workshops/1997-10/proceedings/savikko.html)和[这里](http://www.suttoncourtenay.org.uk/duncan/accu/pythonpatterns.html)开始。

要更深入地了解设计模式，您应该查看[Design Patterns: Elements of Reusable Object-Oriented Software](http://www.amazon.ca/Design-Patterns-Elements-Reusable-Object-Oriented/dp/0201633612)。源代码不在 Python 中，但您无需了解这些模式。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2010-03-23T21:06:34.993

在调用可能存在或可能不存在的对象的属性时，您可以用来简化代码的方法是使用[Null 对象设计模式](http://code.activestate.com/recipes/68205-null-object-design-pattern/)（我在[Python Cookbook](http://books.google.com.ar/books?id=Q0s6Vgb98CQC&pg=PT311&lpg=PT311&dq=Null+object+python+cookbook&source=bl&ots=hc3368UkpC&sig=qRrDqvZwg4FIoMuKo3JJhI7Bu_g&hl=es&ei=TiqpS5jZEMuVtgf08YGnAQ&sa=X&oi=book_result&ct=result&resnum=4&ved=0CBYQ6AEwAw#v=onepage&q=&f=false)中对此进行了介绍）。

> 粗略地说，Null 对象的目标是为 Python 中常用的原始数据类型 None 或其他语言中的 Null（或 Null 指针）提供“智能”替代。这些用于许多目的，包括重要的情况，即某组其他相似元素中的一个成员出于某种原因是特殊的。大多数情况下，这会导致条件语句来区分普通元素和原始 Null 值。

这个对象只是吃掉了缺少属性的错误，你可以避免检查它们的存在。

无非就是

```
class Null(object):

    def __init__(self, *args, **kwargs):
        "Ignore parameters."
        return None

    def __call__(self, *args, **kwargs):
        "Ignore method calls."
        return self

    def __getattr__(self, mname):
        "Ignore attribute requests."
        return self

    def __setattr__(self, name, value):
        "Ignore attribute setting."
        return self

    def __delattr__(self, name):
        "Ignore deleting attributes."
        return self

    def __repr__(self):
        "Return a string representation."
        return "<Null>"

    def __str__(self):
        "Convert to a string and return it."
        return "Null" 
```

有了这个，如果你这样做`Null("any", "params", "you", "want").attribute_that_doesnt_exists()`它就不会爆炸，而只是默默地变成`pass`.

通常你会做类似的事情

```
if obj.attr:
    obj.attr() 
```

有了这个，你只需：

```
obj.attr() 
```

忘记它。请注意，广泛使用该`Null`对象可能会隐藏代码中的错误。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-03T14:05:56.843

您可能还希望阅读这篇[文章](http://people.csail.mit.edu/gregs/ref-dyn-patterns.html)（选择 .pdf 文件），其中讨论了动态面向对象语言（即 Python）中的设计模式。引用页面：

> 本文探讨了当使用动态、高阶、面向对象的编程语言解决类似问题时，通常被称为“Gang of Four”或“GOF”一书中的模式如何出现。一些模式消失了——也就是说，它们被语言特性直接支持，一些模式更简单或有不同的侧重点，还有一些本质上没有变化。

# sharepoint - Possible for Word to edit documents directly off an web server without Sharepoint?

> ID：606456
> 
> 赞同：2
> 
> 时间：2009-03-03T13:50:26.583
> 
> 标签：sharepoint, ftp, ms-word, ms-office

I have a use case that seems pretty simple, but after Googling around I can't find a solution. I have some Word documents on an FTP server and I'd like to be able to create a link that would download them into Word and then allow the saved changes to be sent back to the FTP server.

The problem is that I can only get Word to either open the file from the FTP server as read-only and I can't save the changes back to the server automatically, or the file downloads to a temporary location which isn't automatically saved back to the server. I'm creating my link like this:

```
<a href="ftp://ftp.example.com/www/uploads/Image/test.doc">Test</a> 
```

Frustratingly, if I go into Word File|Open and paste the link "[ftp://ftp.example.com/www/uploads/Image/test.doc](ftp://ftp.example.com/www/uploads/Image/test.doc)" I can save back to the server. What gives? Is there a solution? From Googling around it seems that Sharepoint offers this ability, but that's not practical for us. We're using IE7 and Office 2003.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-03T13:57:35.070

I believe Microsoft Word can read / write WebDAV - see this question:

[Editable Word Document from JSP](https://stackoverflow.com/questions/302284/editable-word-document-from-jsp)

Can you set up some kind of proxy that can connect via FTP?

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-28T13:54:49.803

阅读此链接[http://www.webdavsystem.com/server/documentation/ms_office_read_only](http://www.webdavsystem.com/server/documentation/ms_office_read_only)（实际上是关于 webdav，但我猜这与 FTP 相同），有一节关于在非只读模式。这需要在客户端进行一些更改...

HTH 蒂姆

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-29T15:12:57.567

IE 的解决方案：在[ajaxbrowser.com](http://ajaxbrowser.com/)上放置一个文件（这是用于测试的 WebDAV 服务器）并在下一个代码中替换文件的完整路径：

```
var openDocumentsObject = new ActiveXObject("SharePoint.OpenDocuments");
openDocumentsObject.EditDocument('http://ajaxbrowser.com/mydoc.docx'); 
```

另一个例子：

```
<a href='http://ajaxbrowser.com/mydoc.docx' id='urltarget' target='_blank'>Edit through URI</a> 
```

# jquery-ui - jQuery datepicker 即时设置选定日期

> ID：606463
> 
> 赞同：131
> 
> 时间：2009-03-03T13:56:02.950
> 
> 标签：jquery-ui, datepicker

如何动态更改 jquery 日期选择器的选定日期？我说过创建了一个内联日期选择器。然后过了一段时间，我想在那里反映一个不同的日期，而不是从头开始重新创建日期选择器。

我尝试了 setDate 方法，但没有奏效，并且[doc](http://docs.jquery.com/UI/Datepicker)中没有太多文档。

[这里](http://www.kelvinluck.com/assets/jquery/datePicker/)还有另一个（扩展？）插件，但我想使用 jquery.ui.all.js 附带的插件。

* * *

## 回答 #1

> 赞同：200
> 
> 时间：2009-04-15T14:01:28.693

您使用的是什么版本的 jQuery-UI？我已经使用 1.6r6、1.7 和 1.7.1 测试了以下内容，并且可以正常工作：

```
//Set DatePicker to October 3, 2008
$('#dateselector').datepicker("setDate", new Date(2008,9,03) ); 
```

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2010-09-22T15:34:35.633

如果设置了 minDate 或 maxDate 选项，请检查您尝试将其设置为的日期是否在允许的日期范围内。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2014-05-30T21:52:11.380

此示例显示如何使用下拉日历中的默认值和文本框中的值。它还显示了如何将默认值设置为上一个日期。

selectedDate 是另一个变量，它保存日历控件的当前选定日期

```
 var date = new Date();
    date.setDate(date.getDate() - 1);

    $("#datepicker").datepicker({
        dateFormat: "yy-mm-dd",
        defaultDate: date,
        onSelect: function () {
            selectedDate = $.datepicker.formatDate("yy-mm-dd", $(this).datepicker('getDate'));
        }
    });

    $("#datepicker").datepicker("setDate", date); 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2010-08-18T10:12:13.537

请注意，对于 Keith Wood ( [http://keith-wood.name/datepickRef.html](http://keith-wood.name/datepickRef.html) ) 的 DatePicker，以下工作 - 请注意，默认日期的设置是最后一个：

```
 $('#datepicker').datepick({
        minDate: 0,
        maxDate: '+145D',
        multiSelect: 7,
        renderer: $.datepick.themeRollerRenderer,
        ***defaultDate: new Date('1 January 2008')***
    }); 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2018-08-24T22:09:17.080

```
$('.date-pick').datePicker().val(new Date()).trigger('change') 
```

最后，这就是我最近几个小时寻找的东西！我需要启动更改，而不仅仅是在文本字段中设置日期！

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-05-30T21:18:37.347

出于某种原因，在某些情况下我无法使 setDate 工作。

我发现的一种解决方法是简单地更新给定输入的 value 属性。当然，日期选择器本身不会更新，但如果您只是要显示日期，它可以正常工作。

```
var date = new Date(2008,9,3);
$("#your-input").val(date.getMonth()+"/"+date.getDate()+"/"+date.getFullYear());
// Will display 9/3/2008 in your #your-input input 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2017-12-18T12:07:42.673

这是一个旧线程，但我只想提供一些我如何使用的信息。如果您想设置今天的日期，您可以像下面这样简单地应用它。

```
 $("#datepickerid").datepicker("setDate", "0"); 
```

如果您想在当前日期之前/之后设置几天，请使用`-/+`您想要多少天的符号符号，如下所示。

```
 $("#datepickerid").datepicker("setDate", "-7");
 $("#datepickerid").datepicker("setDate", "+5"); 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2015-04-16T11:37:44.610

这对我有用：

```
$("#dateselector").datepicker("option", "defaultDate", new Date(2008,9,3)); 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2011-08-26T18:51:20.113

setDate 似乎只是 jquery UI 中使用的内联日期选择器的问题，具体错误是 InternalError: too much recursion。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2019-01-29T09:25:18.897

在 Html 中，您可以使用这样的日期选择器添加输入字段

```
<input class="form-control date-picker fromDates" id="myDate" type="text"> 
```

然后在java脚本中，初始化你的日期选择器并将你的值设置为这样的日期，

```
$('.fromDates').datepicker({
                maxDate: '0',
                dateFormat: "dd/mm/yy",
                changeYear: true,
                changeMonth: true,
                yearRange: "-100:+0"
            });

var myDateVal = moment('${value}').format('DD/MM/YYYY');
$('#myDate').datepicker().datepicker('setDate', myDateVal ); 
```

（这里的fromdate属性显示当前日期的前几个日期）

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2021-01-23T14:10:00.083

请在下面找到它对设置数据功能有很大帮助

$('#datepicker').datepicker({dateFormat: 'yy-mm-dd'}).datepicker('setDate', '2010-07-25');

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-07-31T02:06:24.887

```
var dt = new Date();
var renewal = moment(dt).add(1,'year').format('YYYY-MM-DD');
// moment().add(number, period)
// moment().subtract(number, period)
// period : year, days, hours, months, week... 
```

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2009-04-10T13:34:42.980

我在使用 setDate 方法时也遇到了很多麻烦。似乎只适用于 v1。然而，似乎有效的是使用 dpSetSelected 方法：

```
 $("#dateselector").dpSetSelected(new Date(2010, 0, 26).asString()); 
```

祝你好运！

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2015-03-19T12:32:50.743

或者你可以简单地拥有

```
$('.date-pick').datePicker().val(new Date()).trigger('change') 
```

# javascript - 是否有跨浏览器在 Javascript 中设置 style.float 的方式？

> ID：606470
> 
> 赞同：21
> 
> 时间：2009-03-03T13:57:53.647
> 
> 标签：javascript

通常，如果您需要在 JavaScript 中设置样式属性，您可以这样说：

```
element.style.attribute = "value"; 
```

有细微的变化，但通常属性名称是 HTML 属性名称的类似版本，尽管是驼峰式的。

对我来说问题是 float 属性不起作用。Float 是 JavaScript 中的一个关键字，因此 style.float 使所有 JavaScript 用于分页。我查看了 MSDN，它说要像这样使用 styleFloat：

```
element.style.styleFloat = "value"; 
```

这只适用于IE。Firefox、Safari、Chrome、Opera - 他们似乎都没有答案。我哪里错了？对此必须有一个简单的答案。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-03-03T13:58:38.547

使用 cssFloat 作为...

```
element.style.cssFloat = "value"; 
```

这适用于*除*IE 8 和更早版本之外的所有内容，但您始终可以检测浏览器并切换，或者同时设置它们。不幸的是，没有办法只设置一个样式值以在所有浏览器中工作。

所以总结一下，你需要设置浮动的每个人，只需说：

```
element.style.styleFloat = "value";
element.style.cssFloat = "value"; 
```

这*应该*在任何地方都有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-26T18:33:42.163

更好的：

```
element.style.styleFloat = element.style.cssFloat = "value"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-15T16:57:07.750

这是一个函数嗅探方法：

```
if (typeof elmt.style.cssFloat != "undefined")
    elmt.style.cssFloat = "none";
else
    elmt.style.styleFloat = "none"; 
```

但通常我们不需要为这种检测而烦恼。我已经用 Chrome 测试了 user2719099 的方法，如下所示：

```
 elmt.style.cssFloat = elmt.style.styleFloat = "none";
        console.log(elmt.style.cssFloat, elmt.style.styleFloat); 
```

结果在控制台中相当不错：

```
 none none 
```

# c++ - wifstream 相当于_wfopen 的“mode”参数？

> ID：606471
> 
> 赞同：1
> 
> 时间：2009-03-03T13:57:56.737
> 
> 标签：c++, unicode, file-io

我在使用 fstreams 而不是旧的基于 FILE 的文件处理函数在 C++ 中打开 Unicode 文件时遇到问题。使用 _wfopen 打开文件时，我可以指定一种模式来告诉它使用什么字符编码。例如：

```
_wfopen_s(&file, fileName, unicode ? L"r+, ccs=UTF-16LE" : L"r+" ); 
```

这工作正常。但是，当使用 wifstream 时，我在文件的开头得到了字节顺序标记，并且文件的其余部分出现在与 0x00 交错的内存中。显然，它只是将每个字符作为一个字节读取。

我的问题是：是否有任何等效于上面的“模式”参数用于 fstreams？如果没有也不可怕，我只是更喜欢流的语法而不是文件。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T14:12:55.827

您可以尝试使用流的转换方面进行设置。以文件[codecvt.h](http://www.farmanager.com/svn/branches/plugins/ftp/civilis/utils/codecvt.h)和[codecvt.cpp](http://www.farmanager.com/svn/branches/plugins/ftp/civilis/utils/codecvt.cpp)为例。

# svn - 带有视觉工作室项目和解决方案的颠覆/巡航控制/nant/nunit

> ID：606480
> 
> 赞同：7
> 
> 时间：2009-03-03T14:00:41.240
> 
> 标签：svn, nunit, nant, cruisecontrol

我在一个由 2 名开发人员组成的团队中工作，目前我们使用 VSS，没有持续集成或日常构建，也没有单元测试。

我希望将我们的源代码控制更改为 Subversion，同时以更专业的流程启动和运行。

到目前为止，Subversion/cruise control/nant/nunit 似乎是一个非常流行的组合，我刚刚将它们安装到备用机器上。

我已经下载了颠覆手册，其中一个工具就有 400 页长！

真的，我只想使用已经在野外证明的久经考验的模式启动并运行，然后根据需要进行调整，并且随着我对工具的熟悉程度的提高。

有没有人知道任何书籍/教程/演练只涵盖了使用这种特殊工具组合让我尽快启动和运行的基本要素？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-08T04:45:28.567

我已经使用 subversion 好几年了，我不得不说我找到的最好的介绍包含在 TortoiseSVN 的帮助文件中。TortoiseSVN 是另一个带有 Explorer 集成的免费 Windows 客户端。我强烈建议先阅读 Tortoise 帮助，甚至在原始 subversion 文档之前。如有必要，它会将您推荐给官方文档。

乌龟也恰好是我最喜欢的客户。事实上，在大多数机器上，它是我唯一需要的颠覆组件。它执行我日常使用的所有功能，包括创建存储库。虽然这对常规命令行工具没有影响，而且在大多数情况下我也会安装这些工具，但我只能从脚本和（不常见的）存储库维护功能中找到自动化所需的 cli 工具。

我正在重新构建我们自己的构建环境，因此我正在研究许多构建/开发工具的选项。以下是我可以推荐或从其他人那里得到好的建议的工具：

WinMerge：强烈推荐的免费 diff 工具，安装在 TortoiseSVN 之后以获得最佳集成。我每天都会出于多种目的使用这个工具，其中一些是在开发之外。

TeamCity：似乎经过精心打磨的 CI 服务器。我还没有尝试过这个，但鉴于我在 CC.NET 方面的经验（一年）和它收到的好评，它是 CC.NET 的主要竞争者。哈德逊是另一个备受好评的选择。

VisualSVN 服务器：推荐用于 SVN 的免费 http(s) 服务器，具有 AD 集成权限和微软风格的 msc 控制台。我刚刚在工作中完成了它，它非常简单。如果您想要远程 (IP) 签入/签出、ssl 加密、存储库挂钩脚本和其他基于服务器的功能，则必须这样做。

VisualSVN：一个备受好评的 SVN 的 Visual Studio 插件。没试过这个，但它被认为是一个不费吹灰之力的购买。[编辑：根据我在这里读到的关于溢出的内容，AnkhSVN 是一个免费的选项，工作原理大致相同。]

SVN-Monitor：推荐的免费监控软件，可以提醒您存储库中的更改。可配置它监控的内容和采取的操作。取决于正在安装的 TortoiseSVN。

BugTracker.NET：推荐的免费问题跟踪服务器。具有 SVN 集成功能，可将跟踪的问题与颠覆修订联系起来。不确定 TeamCity 是否有类似的功能，但我们已经在开发之外使用它来跟踪帮助台问题，而且它非常适合免费包。

我没有 .NET 的单元测试、覆盖率和文档工具方面的经验，所以我不能在那里发表评论。

虽然我是一个 Pythonista，所以我将插入一个 Python 对 wrt SVN 有用的东西，那就是你可以使用 PySVN 库来执行任何类型的自动化存储库工作，这些工作对于使用命令行工具编写脚本来说太复杂了。一旦准备好标记和部署构建，我就会使用它来创建标记。

选择其中一些工具，您将领先于游戏。围绕他们开发流程并培训人员，嗯，这仍然是你的工作。:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-08T07:19:40.523

我录制[了一段视频](http://www.stevetrefethen.com/videos/Continuous%20Integration.ashx)，说明了所有基础知识，包括 SubVersion、CruiseControl.NET 的设置。我什至说明了一个损坏的构建。使用的开发工具是 Delphi，但很容易使用 VS.NET。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T14:04:17.407

如果您想尽快启动并运行 Subversion 服务器，而不必对 repo 有很多了解，请[在此处](http://www.visualsvn.com/)查看 Visual SVN 。这是一个 GUI 应用程序，可让您设置存储库，而无需阅读大量文档。这里还有一个关于它的[dimecast](http://dimecasts.net/Casts/CastDetails/29)。

至于与 CC.NET 的集成，请在[此处](http://confluence.public.thoughtworks.org/display/CCNET/Subversion+Source+Control+Block)查找关于 subversion control block 的 CC.NET 文档，他们在他们的站点中已经很好地分解了它，您应该能够相当容易地找到 svn 的 xml 标签。

您还应该检查实施客户端工具，例如[Tortoise SVN](http://tortoisesvn.tigris.org/)和[Ankh SVN](http://ankhsvn.open.collab.net/)。

[对于 NANT，请在此处](http://dimecasts.net/Casts/ByTag/NAnt)查看这些 dimecast 。关于如何有效使用 nant 的精彩教程。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-03T14:24:30.573

由于您来自 VSS 背景，请查看[SourceGear Vault](http://www.sourcegear.com/vault/)和[SourceGear Fortress](http://www.sourcegear.com/fortress/)。如果他们做你想做的事，他们会更快地学习，因为它们是为具有 VSS 思维方式的人设计的。

我认为他们甚至可能对小团队免费。

（您仍然希望使用 nUnit 进行测试，但我会首先整理源代码控制和持续集成。）

如果您确实使用 Subversion，您会发现它非常稳定，并且能够满足大多数团队的需求。看看[TortoiseSVN](http://tortoisesvn.tigris.org/)以获得基于 Subversion 的简单 UI

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-03T14:04:23.197

这可能对手头的问题没有帮助，但是......

我并不是说没有……但即使你有这本手册，你也需要学习很多东西。在考虑将它们全部放在一起之前，您确实需要单独学习每个部分。

# windows - What is the meaning of these Windows Environment variables: HOMEDRIVE, HOMEPATH, HOMESHARE, USERPROFILE

> ID：606483
> 
> 赞同：43
> 
> 时间：2009-03-03T14:01:40.457
> 
> 标签：windows, samba

What is the meaning of these Windows Environment variables:

*   HOMEDRIVE,
*   HOMEPATH,
*   HOMESHARE,
*   and USERPROFILE?

Who set them? When? Who use them? For doing what?

How the configuration of the samba server modify these variables?

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2016-04-03T23:35:36.687

`USERPROFILE`由`userenv!LoadUserProfileW`which 设置，当加载用户的配置文件（`HKEY_USERS\<sid>`配置单元）时调用。

*   这通常发生在第一次为用户启动进程时。
*   如果您特别安排不加载配置文件（例如使用`/noprofile`for `runas`），则该进程在`Default User`仍然设置了此变量的配置文件中运行 - 从系统启动时加载*它的那一刻起。*

`HOMEDRIVE`,`HOMEPATH`和`HOMESHARE`（以及其他几个变量）在 Explorer 初始化¹`shell32!RegenerateUserEnvironment`中被调用。它们被放置在 (volatile)键中，该键是易失的，直到配置文件卸载为止。^(`HKCU\Volatile Environment`)

*   因此，它们仅在用户登录其桌面会话时设置。不适用于二次登录或服务。
    *   难怪[人们`USERPROFILE`现在](https://stackoverflow.com/questions/606483/what-is-the-meaning-of-these-windows-enviroment-variables-homedrive-homepath/648265#648265)更喜欢。
*   [要`HOMEPATH`进行设置，`SYSTEM`必须具有配置文件目录的权限](http://answers.microsoft.com/en-us/windows/forum/all/homepath-variable-has-disappeared/d1d12afd-4b06-4c6f-ba16-bd189fef198f)（当然，它们最初是设置的，但在使用 Cygwin 时可能会消失`chmod`）。

¹[代码还设置了一些已经由 设置的变量`userenv`。这表明这是自 NT4 天以来一直存在的旧代码。[配置文件和主路径之间的差异 - 服务器故障](https://serverfault.com/questions/29948/difference-between-profile-and-home-path)证实了这一点。]

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2012-01-10T02:30:20.500

`HOMEDRIVE`/`HOMEPATH`是用户个人文件所在的位置：下载、音乐、文档等。

`HOMESHARE``HOMEDRIVE`如果主目录使用 UNC 路径，则使用它来代替。

`USERPROFILE`用于存储用户的应用程序和操作系统配置文件以及个性化设置。它包括本地和漫游 (Active Directory) 文件夹。似乎人们比`HOMEPATH`现在更喜欢使用它。

需要注意的是，尽管`HOMEDRIVE`/`HOMEPATH`通常与路径相同`USERPROFILE`，但并非总是如此。

我认为 Samba 不会修改这些。它可能会利用它们来提供初始（主）目录。Active Directory 可能会更改它们。

* * *

参考：

*   [死链接] ~~[Windows NT 中的环境变量](http://support.microsoft.com/kb/100843)~~

*   [如果我面向多个操作系统版本，我应该在哪里存储我的数据和配置文件？](https://blogs.msdn.microsoft.com/patricka/2010/03/18/where-should-i-store-my-data-and-configuration-files-if-i-target-multiple-os-versions/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-03T14:05:32.460

if you go to the run box and type any of the above like this

%HOMEPATH%

then it will go to your environment path that is set on your machine. It's usefull when writing vb scrips and things like that where you want to perform a task on the users profile area for example.

Hope this helps

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-15T00:30:18.067

这些都是在登录时设置的，正如 SocialAddict 所说，当您需要在不同系统上执行操作时，它们在脚本中非常有用。

我对您的其他问题不太清楚，samba 服务器不应该关心这些变量。

有关详细说明，请参阅[http://vlaurie.com/computers2/Articles/environment.htm](http://vlaurie.com/computers2/Articles/environment.htm)。

# php - 如何将文本块中的所有图像放入数组中，PHP？

> ID：606484
> 
> 赞同：2
> 
> 时间：2009-03-03T14:01:47.117
> 
> 标签：php, wordpress

```
function has_thumbnail_image(&$post) {
    $content = $post->post_content;
    return preg_match('/<img[^>]+src="(.*?)"[^>]*>/', $content, $results);
} 
```

我需要一个函数来遍历动态返回的文本块，并将其中包含的所有图像放入一个数组（或者更具体地说是每个图像的图像源）。上面的函数只给了我第一张图像，我无法弄清楚如何让这个循环继续发生，直到所有图像都在数组中。对此的任何帮助将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-03T14:04:55.317

您可能想要调查[`preg_match_all`](http://uk.php.net/preg_match_all)。如果我没记错的话，`preg_match`只搜索第一个匹配项然后停止。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T14:05:18.497

你很亲近！你只需要`preg_match_all`而不是`preg_match`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T14:42:26.600

我不知道您对来源的了解程度，但您可能希望允许 src 属性使用单引号。

# xml - PXSL 的语法高亮显示？

> ID：606485
> 
> 赞同：3
> 
> 时间：2009-03-03T14:01:47.383
> 
> 标签：xml, development-environment, syntax-highlighting, notepad++

为了减轻使用 XML 的一些麻烦，我一直在试验[PXSL](http://community.moertel.com/pxsl/)，这是一种用于任何具有高级宏功能的 XML 文档的缩写语法。但是，由于它太新了，我还没有找到任何知道如何解析它以进行语法突出显示的文本编辑器。

您知道任何可以实现此功能的编辑器或插件吗？如果我想定义语法高亮，比如 Notepad++，我应该从哪里开始？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T18:47:55.947

我不是 Notepad++ 用户，但我可以推荐您使用 UltraEdit 及其自定义语法高亮功能。

它已经支持多种语言，如下所述：

[http://www.ultraedit.com/downloads/extras.html](http://www.ultraedit.com/downloads/extras.html)

最好的一面是，您可以通过查看示例来构建自己的 word 文件。

另一方面，最糟糕的是，UltraEdit 不是免费的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-11-30T17:00:32.293

我推荐 PSpad，支持很多语言的语法着色，而且它是免费软件。www.pspad.com

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-06-13T20:45:36.167

要在 Notepad++ 中启用 PXSL .pxl（或任何其他非典型文件扩展名）的语法突出显示，您需要：

1.  安装 XML 工具插件
2.  告诉 Notepad++ .pxl（和其他）文件扩展名应该突出显示为 XML。

对于 (1)，单击“插件”->“插件管理器”->“显示插件管理器”。向下滚动并选中 XML Tools，然后安装。

重新启动 Notepad++ 后，执行 (2)：

*   单击“设置”->“样式器配置器...”
*   在“语言”列表中，选择“XML”
*   在“用户分机”文本框中，输入“pxl”

* * *

*例如*，当我希望将我的[DITA](http://dita.xml.org/)源文件突出显示为 XML 时，我在 User ext 文本框中添加了“dita ditamap”以突出显示具有 .dita 或 .ditamap 扩展名的文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-12T19:56:00.657

你可以查看 VIM 中包含的[PApp 语法高亮](http://www.vim.org/htmldoc/syntax.html#papp.vim)。

PApp 语法文件处理 .papp 文件，并且在较小范围内处理 .pxml 和 .pxsl 文件，它们都是 perl/xml/html/other 的混合，使用 xml 作为顶级文件格式。默认情况下，phtml 或 pxml 部分中的所有内容都被视为带有嵌入式预处理器命令的字符串。如果设置变量：

```
:let papp_include_html=1 
```

在您的启动文件中，它会尝试在 phtml 部分中对 html 代码进行语法高亮显示，但这相对较慢且色彩过于丰富，无法进行明智的编辑；）（又名，pxsl 很难解析）

最新版本的 papp.vim 语法文件通常可以在[http://papp.plan9.de](http://papp.plan9.de/)找到。

# .net - lazy="false" 对 NHibernate 映射的类元素有什么影响？

> ID：606488
> 
> 赞同：10
> 
> 时间：2009-03-03T14:02:42.343
> 
> 标签：.net, nhibernate, lazy-loading

我正在使用我正在尝试添加 NHibernate 的遗留系统。我有一个需要映射到表的类，但它有很多不是虚拟的现有方法。

我发现如果我将映射文件的类元素上的“lazy”属性设置为“false”，即使存在非虚拟方法，我也可以让 NHibernate 成功加载映射。我想知道这会对我在此类中使用 NHibernate 产生什么影响。

我了解对属于对象的集合进行非延迟加载的含义，但我不清楚对类进行延迟加载或急切加载的含义。这是否意味着属于该对象的所有集合都将被预先加载？或者这是否意味着 NHibernate 不再使用动态代理来代替实际的类？还有什么？

另外，这里最好的做法是什么？设置该 lazy=false 值是不可取的吗？我应该创建一个类实现的接口，然后将其映射到表吗？还是我应该硬着头皮把所有现有的方法都标记在虚拟类上？

提前感谢您的任何建议！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-03T14:15:20.987

我总是在 NHIbernate 的类级别上指定lazy=false，因为如果我不想在我的类模型中这样做，我不希望 NHibernate 强迫我声明属性是虚拟的。

当您在类映射中指定“惰性”时（默认），NHibernate 在运行时使用“动态代理”类。此动态代理是从您的类继承的类。然后，据我了解，该类的实例应该延迟/按需初始化。在某些情况下，这对性能应该更好（至少，这是被告知的）。

但是，因为我不喜欢 NHibernate 告诉我我的类应该是什么样子，所以我总是为我的所有类指定lazy=false，我还没有遇到麻烦。:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T14:19:59.117

使用延迟加载在限制对象数量方面非常有效。此功能在某些情况下非常有用。例如，假设您有两个对象 User 和 Role，并且所有用户都有 1 个或多个角色。当您加载 User 对象时，您还希望加载其所有关联的角色。但是，当您为该用户加载角色时，您不希望加载与该角色关联的所有用户，因为这可能会加载整个用户数据库。

因此设置lazy = false 意味着在加载调用实例时将加载关系的整个对象集合。在某些情况下，这很好、很好且合适，在其他情况下，这可能会导致性能问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-10T06:07:58.893

Rob，那只是糟糕的设计。用户将具有角色类型的列表，但角色将没有用户类型的列表。User 是一个聚合根，要获取一个角色中的所有用户，在 User 上定义一个 GetByRole() 方法。像您描述的 2 路遍历构成了一个可怕的域模型。谷歌“循环引用”，看看它为什么不好。

# java - Gridview 类似于 Java 中休眠对象的显示？

> ID：606489
> 
> 赞同：0
> 
> 时间：2009-03-03T14:03:15.633
> 
> 标签：java, hibernate, user-interface, web-applications, gridview

本质上，我正在寻找的是构建快速数据库界面的好方法。在我对 ASP.net 的（有限）经验中，我使用了一个 Gridview 控件来完成这项任务。但是对于这个项目，我将使用 Java。

谁能推荐一种在 Java Web 框架中设置类似 Gridview 的控件（具有可编辑和可排序的行）的好方法？我倾向于使用 Spring MVC，但我并不特别依赖任何 Java Web 框架。

我的数据是使用 Hibernate 从数据库中提取的，因此任何可以直接插入其中的控件都会很棒。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T14:11:50.573

Java Server Faces (JSF) 有一个[dataTable](http://www.roseindia.net/jsf/dataTable.shtml)组件。如果您将它与构建在 JSF 之上的框架（例如[IceFaces](http://www.icefaces.org/main/home/index.jsp) ）结合起来，您也将获得排序。

但是，如果您正在寻找一个快速的库来放入 JSP，请查看[displayTag](http://displaytag.sourceforge.net/1.2/)。不处理数据的编辑（无论如何应该很容易为此编写一些代码），但会处理分页和排序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T15:59:00.143

Tapestry 5 还具有网格视图以及与 Hibernate 的良好集成。 [本教程](http://tapestry.apache.org/tapestry5/tutorial1/)向您展示了基础知识。

# sql - SQL 表 - 要么/或数据的模式

> ID：606493
> 
> 赞同：4
> 
> 时间：2009-03-03T14:04:46.330
> 
> 标签：sql, tsql, database-design

我有一个简单的问题 - 在 SQL 表设计中是否有存储“非此即彼”数据的最佳实践？

我有以下问题 - 我需要将模板数据（定义文件夹结构）存储在 SQL 表中。任何给定的文件夹都可能有一个静态名称（例如“电子邮件”），或者它可能为每个实例动态生成，具体取决于与其关联的对象（例如公司名称）。

实例化业务对象时，模板数据将用于创建实际的文件夹结构。

我正在考虑像这样存储数据：

```
创建表文件夹
(
    ID INT 身份主键，
    文件夹名称 NVARCHAR(50),
    IsDynamic BIT NOT NULL DEFAULT 0,
    DynamicFieldID INT FOREIGN KEY REFERENCES dynamicField,
    ParentID INT FOREIGN KEY REFERENCES 文件夹
)

```

因此，如果 IsDynamic 字段设置为 true，我知道会有一个规则（在外键上定义），但如果没有，我将使用存储在文件夹名称中的值。

然而，这对我来说似乎有点混乱 - 这种情况是否有“最佳实践”模式？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-03T14:09:20.780

这对我来说看起来还不错。

您可能需要考虑不要打扰“IsDynamic”字段，因为这可以从 DynamicFieldID 为空的事实中得出。然后在您的 SQL 中，您可以 LEFT JOIN 和 COALESCE 动态表中的字段。

但我不认为上述模型是那么混乱。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-03T14:09:39.237

```
CREATE TABLE folder
(
    ID INT IDENTITY PRIMARY KEY,
    ParentID INT FOREIGN KEY REFERENCES folder
)

CREATE TABLE dynamic_folder (
     ID INT FOREIGN KEY REFERENCES folder (id),
     DynamicFieldID INT FOREIGN KEY REFERENCES dynamicField
)

CREATE TABLE static_folder (
     ID INT FOREIGN KEY REFERENCES folder (id),
     FolderName NVARCHAR(50)
) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T14:13:34.110

您可以像这样`NULL`输入`DynamicFieldID`和查询：

```
SELECT COALESCE(dynamicName, folderName)
FROM folder
LEFT JOIN dynamicField ON (dynamicField.ID = folder.DynamicFieldID) 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-03-03T14:11:32.117

我不确定我是否完全理解了这个问题，但我认为您的意思是您有一个字段可以具有静态值或需要在运行时根据其他值确定的字段。

我会创建您自己的“变量”方案并将其存储在数据库中。我不知道你使用的是什么语言，所以我会基于它想出一些东西（让它与你的语言不同），我会使用一些围绕值的东西——开始和结束。例如：

值：/companyA/projectA/

或者

值 /@companyVariable@/@projectVariable@/

然后只需编写一个查找打开和关闭@ 符号的例程，并将它们换成适当的值。这是一个多一点的工作，但我认为它最终会是最容易理解和最灵活的。同样，@ 符号正是我首先想到的，使用对您最有意义的任何字符。

# asp.net - Why is my page not redirecting even though it does not error out?

> ID：606496
> 
> 赞同：0
> 
> 时间：2009-03-03T14:05:26.283
> 
> 标签：asp.net, vb.net, visual-studio-2008, jquery

I have this function that utilizes jQuery's post feature to send an ajax request to my logout handler, which destroys the session (set by asp.net) and redirects to the login page:

```
<script type="text/javascript">
    //<![CDATA[
    function doLogout() {
        var conf = false;
        conf = confirm("Really log out?");
        if (conf === true) {
            $.post("logout.ashx");
        }
    }
    //]]>
</script> 
```

So far, the logout link functions fine: user clicks it, the confirmation box pops up, and if they click yes it loads up the logout handler:

```
Public Sub ProcessRequest(ByVal context As HttpContext) Implements IHttpHandler.ProcessRequest
    With context
        If .Session IsNot Nothing Then
            context.Session.Clear()
            context.Session.Abandon()
        End If
        .Server.Transfer("default.aspx", False)
    End With
End Sub 
```

I have tried using `Response.Redirect` as well, nothing different happens.

I have verified by tracing that everything is functioning fine. There are no javascript or asp.net errors. The only problem is the page in the browser does not change.

Any ideas?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T14:12:16.920

When you post an ajax request you can redirect at the server all you want, but all you are doing is determining which page ultimately responds to that ajax request. If you want to redirect the entire page, you need to post from the entire page, or build the javascript that handles the response to know when you'll want to redirect and do it there.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T14:12:39.853

The problem is that the callback to the server is an asynchronous javascript call and not a page postback. if you wish to change the page in the browser you will also have to do this in your javascript function after the call to your logout function.

# database - 如何根据我的数据库模式验证客户端数据库？

> ID：606500
> 
> 赞同：0
> 
> 时间：2009-03-03T14:07:07.853
> 
> 标签：database, validation, schema, integrity

我们的客户使用 SQLServer/Oracle 数据库。多年来，我们向他们发送了许多必须手动运行的更新脚本。大多数情况下，一切都很顺利，但有时脚本没有完全运行到最后或者有一些错误（升级时没有检测到）。此外，有时甚至“聪明的用户”也出于某种原因将索引/表添加到这些数据库中。后来，这些违规行为会导致问题。

现在我的任务是找出一种方法来根据我们自己的数据库模式（表、数据类型、索引、视图......）来验证/验证我们的客户数据库。输出应该是某种差异文件，指示数据库中缺少什么/不应该是什么。我可以在我们的应用程序内部使用代码 (C++) 执行此操作，或者我可以为此目的创建一个外部工具。

现在在我开始编码之前，我想问一下是否已经有一个工具可以产生必要的结果，或者至少可以帮助我从我们的主数据库（Oracle 和 SQLServer）产生一个像样的 xml 文件？或者是否有一个库可以帮助我编写自己的工具？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-05T19:45:45.107

我以前使用过这种技术，它不需要购买任何工具。

Enterprise Manager 具有“创建脚本”功能。在您的参考数据库和比较数据库上执行此操作。选择适当的选项为您关心的对象生成脚本。接下来，只需将生成的两个文件与您最喜欢的 diff 工具进行比较。

您可以使用允许导出 DDL 脚本的 Oracle 工具执行类似的过程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-03T14:55:38.133

使用 Red Gate 的工具有三个选项：

1.  让您的客户进行比较。您需要说服您的客户购买 SQL Compare 许可证并向他们发送您的数据库的模式快照。
2.  使用 Red Gate 的 SQL 比较 SDK（10 个发行版 595 美元）编写您自己的应用程序，该应用程序可以在客户端站点上运行。
3.  请您的客户向您发送架构快照并使用您自己的 SQL 比较副本自己运行比较。Red Gate 提供了一个名为 SQL Snapper 的免费模式快照工具，该工具将创建快照，然后您的客户可以通过电子邮件将其发送给您。由于这不包括任何数据，因此您的客户可能愿意考虑。

SQL Snapper 工具和 SQL 比较 SDK 示例代码可以从我们的 labs.red-gate.com 网站下载。

Oracle 兼容性现在以 Early Access Build 的形式提供。如果您有兴趣或想试用该工具，[请访问产品页面](http://www.red-gate.com/products/schema_compare_for_oracle/index.htm)。在该工具完全发布之前，您可以免费使用它。

Red Gate Software 产品经理 David Atkinson。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T14:11:28.857

为此，我们使用 Redgate SQL Compare，它多年来一直为我们服务。

我们还使用 Redgate SQL Data Compare 来比较查找表的内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T14:11:53.303

redgate 的人有一个很棒的工具，叫做[SQL Compare](http://www.red-gate.com/products/sql_compare/index.htm)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-03T14:12:36.030

你能像 MySQL 的[SHOW CREATE TABLES](http://dev.mysql.com/doc/refman/5.0/en/show-create-table.html)那样创建一个模式转储吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-04T05:03:05.593

如果您使用的是 Windoze，我已经使用 Advanced Query Tool 多年，并且可以证明，为了钱，它比其他任何东西都做得更多。特别是，它将生成数据库之间的差异报告。它是 ODBC/VB6，可以针对几十个数据库运行。看看这个。（不，我不是 QueryTool 的成员，也不拥有它的任何部分，只是一个快乐的客户。）

# asp.net - 谷歌地图上的多个标记

> ID：606515
> 
> 赞同：2
> 
> 时间：2009-03-03T14:12:36.250
> 
> 标签：asp.net, javascript, vb.net, api, google-maps

我添加了一个带有两个标记的谷歌地图（我只是在测试），代码是：

```
function load() {

    var map = new GMap2(document.getElementById("map"));

    var marker = new GMarker(new GLatLng(<%=coordinates%>));
    var marker2 = new GMarker(new GLatLng(31.977211,35.951729));
    var html="<%=maptitle%><br/>" +
         "<%=text%>";
    var html2="<img src='simplemap_logo.jpg' width='20' height='20'/> " +
         "<%=maptitle%><br/>" +
         "<%=text%>" + "Alper";
    map.setCenter(new GLatLng(<%=coordinates%>), 5);
    map.setMapType(G_HYBRID_MAP);
    map.addOverlay(marker);
    map.addOverlay(marker2);
    map.addControl(new GLargeMapControl());
    map.addControl(new GScaleControl());
    map.addControl(new GMapTypeControl());

    marker.openInfoWindowHtml(html);
    marker2.openInfoWindowHtml(html2);
    } 
```

问题是，只有一个标记文本显示（里面有文本的白色三角形），另一个不可见，为什么？另一件事，我有一个地图表，例如：mapID、mapCoordinates、mapMarkerTitle、mapMarkerText，我可以检索这个表，但我想要一种能够将其所有记录传递给我的 javascript 并为每个地图创建一个标记的方法我的桌子上有，我知道这是两个，但是任何人都可以建议或帮助我编写代码吗？因为我对javascript一无所知：D

HTML 输出是：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head><title>
    Untitled Page
</title>
    <script src="http://maps.google.com/maps?file=api&amp;v=2&amp;key=ABQIAAAANgu3GlobW5KtQorgXrnJ_xTHM4EYhrvsce8mdg4KdiCoPfCQKxSOZ_5sjy4O31twg6cxfZqam24TCw"
      type="text/javascript"></script>

    <script type="text/javascript">

     function load() {

    var map = new GMap2(document.getElementById("map"));

    var marker = new GMarker(new GLatLng(32.523251,35.816068));
    var marker2 = new GMarker(new GLatLng(31.977211,35.951729));
    var html="maen<br/>" +
         " maen tamemi";
    var html2="<img src='simplemap_logo.jpg' width='20' height='20'/> " +
         "maen<br/>" +
         " maen tamemi" + "Alper";
    map.setCenter(new GLatLng(32.523251,35.816068), 5);
    map.setMapType(G_HYBRID_MAP);
    map.addOverlay(marker);
    map.addOverlay(marker2);
    map.addControl(new GLargeMapControl());
    map.addControl(new GScaleControl());
    map.addControl(new GMapTypeControl());

    marker2.openInfoWindowHtml(html2);
    marker.openInfoWindowHtml(html);
    }

    //]]>
    </script>

    <script type="text/javascript">

      function pageLoad() {
      }

    </script>

</head>
<body onload = "load()">
    <form name="form1" method="post" action="Xhome.aspx" id="form1">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwUJNDI5NDcxNTY4ZGTjxbb38769ZB2N9Ow9kAzPz2PIqA==" />
</div>

    <div id="map" style="width:400px;height:300px" >

    </div>
    </form>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T14:36:49.873

试试[Marker Manager API](http://googlemapsapi.blogspot.com/2006/11/marker-manager.html)，它更容易处理。这是谷歌的例子：

```
function setupMap() {
 if (GBrowserIsCompatible()) {
   map = new GMap2(document.getElementById("map"));
   map.addControl(new GLargeMapControl());
   map.setCenter(new GLatLng(41, -98), 4);
   window.setTimeout(setupWeatherMarkers, 0);
 }
}

function getWeatherMarkers(n) {
  var batch = [];
  for (var i = 0; i < n; ++i) {
    batch.push(new GMarker(getRandomPoint(), 
      { icon: getWeatherIcon() }));
  }
  return batch;
}

function setupWeatherMarkers() {
  mgr = new GMarkerManager(map);
  mgr.addMarkers(getWeatherMarkers(20), 3);
  mgr.addMarkers(getWeatherMarkers(200), 6);
  mgr.addMarkers(getWeatherMarkers(1000), 8);
  mgr.refresh();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T14:39:38.400

我不认为谷歌地图一次可以显示多个信息窗口，所以当你打开第二个时，第一个会关闭。

**编辑：**当您单击标记时，标记也不会自动打开信息窗口。您需要将单击处理程序附加到调用 showInfoWindowHtml 方法的标记。我使用一个辅助函数来创建标记并自动添加点击处理程序。

```
function createMarkerHtml(point, title, html) {
    var marker = new GMarker(point, { title: title });
    GEvent.addListener(marker, "click", function() { marker.openInfoWindowHtml(html); });
    return marker;
}

map.addOverlay(createMarkerHtml(new GLatLng(<%=coordinates%>), "Marker 1", html));
map.addOverlay(createMarkerHtml(new GLatLng(31.977211,35.951729), "Marker 2", html2)); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T17:37:17.007

针对您问题的第二部分：

> 我想要一种能够将其所有记录传递给我的 javascript 并为我的表中的每个地图创建一个标记的方法

我有（例如 - 大约一年前写的）以下代码：

在代码隐藏中，我有这样的东西（恐怕是 c#）：

```
[WebMethod]
public LatitudeLogitudeMessage[] GetPoints(string postCodes)
{
    string[] postCodeArray = postCodes.Split(",".ToCharArray());

    LatitudeLogitudeMessage[] pointArray = 
                   new LatitudeLogitudeMessage[postCodeArray.Length];
    int index = 0;
    foreach (string postCode in postCodeArray)
    {
        pointArray[index] = GetPoint(postCode);
        index++;
    }

    return pointArray;
} 
```

LatitudeLogitudeMessage 是一个自定义类，如下所示：

```
public class LatitudeLogitudeMessage
{
    public decimal? Latitude { get; set; }
    public decimal? Longitude { get; set; }
    public string Message { get; set; }
    public string Details { get; set; }
    public string Address { get; set; }

    public LatitudeLogitudeMessage(string addressToFind)
    {
        Address = addressToFind;
        Details = addressToFind.Replace(",", ",<br />");
    }
} 
```

GetPoint 方法基本上填充了这些细节。

在前面的代码中，我有：

```
PageMethods.GetPoints(address, showPoints); 
```

它在后面的代码上调用 GetPoints 方法，并将结果传递给 showPoints：

```
function showPoints(latLongs)
{
  GLog.write("Showing points");
  var points = [];
  var latLngBounds = new GLatLngBounds();

  for (var i = 0; i < latLongs.length; i++)
  {
    if ("" == latLongs[i].Message)
    {
      points[i] = new GLatLng(latLongs[i].Latitude, latLongs[i].Longitude);
      var marker = 
            new GMarker(points[i], {title: latLongs[i].Details, clickable: false});
      map.addOverlay(marker);
      latLngBounds.extend(points[i]);
    }
    else
    {
      GLog.write(latLongs[i].Message);
    }
  }

  if (points.length > 1)
  {
    var bounds = new GBounds(points);
    var center = new GLatLng(
         (latLngBounds.getSouthWest().lat() 
           + latLngBounds.getNorthEast().lat()) /2.,
         (latLngBounds.getSouthWest().lng() 
           + latLngBounds.getNorthEast().lng()) /2.);
    var newZoom = map.getBoundsZoomLevel(latLngBounds, map.getSize());
    map.setCenter(center, newZoom);
  }
  else
  {
    map.setCenter(points[0], defaultZoomLevel);
  }
} 
```

所以这需要点数组，并在它们上迭代创建一个标记，以列表中的第一项为中心（不聪明，但它对我有用）。

# python - Python 图形库

> ID：606516
> 
> 赞同：383
> 
> 时间：2009-03-03T14:12:37.873
> 
> 标签：python, graph

我正在编写一个 python 应用程序，它将大量使用图形数据结构。没什么复杂的，但我在想某种图形/图形算法库会帮助我。我已经用谷歌搜索了，但我没有发现任何让我特别兴奋的东西。

有人有什么好的建议吗？

* * *

## 回答 #1

> 赞同：266
> 
> 时间：2009-03-03T15:33:27.663

有两个很好的选择：

[网络X](http://networkx.github.io/)

和

[图形](http://igraph.org/)

我喜欢 NetworkX，但我也读过关于 igraph 的好东西。我经常将 NetworkX 与具有 100 万个节点的图一起使用，没有问题（它的开销大约是 V + E 大小的字典的两倍）

如果您想进行功能比较，请从 Networkx-discuss 列表中查看此内容

[功能比较线程](http://groups.google.com/group/networkx-discuss/t/7597ca97abbb3f90?hl=en)

* * *

## 回答 #2

> 赞同：117
> 
> 时间：2010-11-24T17:24:57.280

我想插入我自己的图形 python 库：[graph-tool](http://graph-tool.skewed.de)。

它非常快，因为它是在 C++ 中使用 Boost Graph Library 实现的，并且它包含大量算法和大量文档。

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2009-03-03T14:17:49.513

你看过[python-graph](http://code.google.com/p/python-graph/)吗？我自己没有使用过，但项目页面看起来很有希望。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-03-03T15:21:10.733

此外，您可能想看看[NetworkX](http://networkx.lanl.gov/)

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-03-03T14:16:51.467

看看[这个关于在 python 中实现图表的页面](http://www.python.org/doc/essays/graphs/)。

您还可以查看 sourceforge 上的[pygraphlib](http://sourceforge.net/projects/pygraphlib/)。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-03-03T14:22:56.583

使用[Boost 图形库 - Python 绑定](http://www.osl.iu.edu/~dgregor/bgl-python/)。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-01-20T19:57:32.680

我对 pydot 最幸运。其他一些很难在 Win 7 等不同平台上安装和配置。

[http://code.google.com/p/pydot/](http://code.google.com/p/pydot/)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-05-23T21:33:04.143

我赞同 zweiterlinde 的使用 python-graph 的建议。我将它用作我正在从事的基于图形的研究项目的基础。该库编写得很好，稳定，并且具有良好的界面。作者还可以快速回复查询和报告。

# c# - 为什么在这个非常简单的场景中没有调用我的 .net 析构函数？

> ID：606524
> 
> 赞同：2
> 
> 时间：2009-03-03T14:16:30.640
> 
> 标签：c#, .net, garbage-collection, destructor, finalizer

我有以下代码：

```
 public class A
    {
        ~A()
        {
            Console.WriteLine("destructor");
        }
    }

 public static A Aref;
 static void Main(string[] args)
    {
        Aref = new A();
        int gen = GC.GetGeneration(Aref);
        Aref = null;
        GC.Collect(gen, GCCollectionMode.Forced);
        Console.WriteLine("GC done");

    } 
```

我认为我的 Finalizer 方法会在我调用 GC.Collect 时被调用，但事实并非如此。

谁能解释我为什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-03T14:22:04.027

`GC.Collect()`在返回之前不会调用终结器。终结器在单独的线程中运行 - 您可以通过调用`GC.WaitForPendingFinalizers()`.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-03T14:22:20.000

在您的示例中，在收集期间未调用终结器，因为它仍由可终结队列根植。然而，它已被安排完成，这意味着它将在下一次垃圾收集期间被收集。

如果要确保收集带有终结器的类型的实例，则需要像这样进行两次收集。

```
GC.Collect();
GC.WaitForPendingFinalizers();
GC.Collect(); 
```

但通常您不应该`Collect()`自己调用该方法。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-03-03T14:22:54.273

即使您要求 GC 收集，也不确定该特定对象是否会被销毁（因为它不能在当时正在收集的一代中）

# c++ - 将 VARIANT 转换为...？

> ID：606527
> 
> 赞同：2
> 
> 时间：2009-03-03T14:17:02.557
> 
> 标签：c++, windows, vb.net, visual-studio-2008, com

**笔记：**

*   试图调用接口的方法，其返回类型为`_variant_t`

**代码：**

```
_variant_t resultsDataString;

_bstr_t simObjectNames;

simObjectNames = SysAllocString (L"TEST example 3");

resultsDataString = pis8->GetSimObject (simObjectNames); 
```

**如下所示**的内联函数，包含在**.tli**文件中：

```
inline _variant_t IS8Simulation::GetSimObject ( _bstr_t Name ) {
    VARIANT _result;
    VariantInit(&_result);
     HRESULT _hr = get_SimObject(Name, &_result);
   if (FAILED(_hr)) _com_issue_errorex(_hr, this, __uuidof(this));
    return _variant_t(_result, false);
} 
```

**笔记：**

*   `resultsDataString`属于**`struct` `tagVARIANT`**：
    *   **`VARTYPE vt`**是 9（无符号短）
    *   **`IDispatch`**IDispatch 接口指针

**问题**

*   然后我怎样才能**转换**或**提取**价值？
*   可以使用[VariantChangeType](http://msdn.microsoft.com/en-us/library/ms221258.aspx)吗？
*   其他方式？

## 编辑：

**笔记：**

*   希望将以下 Visual Basic 代码转换为 Visual C++

*   MFC 或 ATL，如果需要

*   理想情况下，纯 C++

**Visual Basic**等价物：

```
Public example1, example2 As SIMUL8.S8SimObject
Dim numberOfexamples As Variant
Dim resultString As Variant

Set example1 = MySimul8.SimObject("Example 1")
Set example2 = MySimul8.SimObject("Example 2")

numberOfexamples = example1.CountContents + example2.CountContents

resultString = CStr(numberOfexamples) & "*" 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T14:24:41.383

查看[_variant_t的 MSDN 文档](http://msdn.microsoft.com/en-us/library/x295h94e.aspx)

有一个[ChangeType](http://msdn.microsoft.com/en-us/library/2kc812h8.aspx)方法以及[Extractors](http://msdn.microsoft.com/en-us/library/ew0bcz27.aspx)。

**编辑：**一旦你有了一个`IDispatch`指针，你需要使用`[QueryInterface](http://msdn.microsoft.com/en-us/library/ms682521.aspx)`成员和方法来获取一个特定的对象类型，或者使用`[IDispatch::Invoke](http://msdn.microsoft.com/en-us/library/ms221479.aspx)`. 您可以查看 MSDN 文档以获取`[IDispatch](http://msdn.microsoft.com/en-us/library/ms221608.aspx)`. 无论哪种方式，您都需要了解`IS8Simulation::GetSimObject`调用返回的对象类型。

**编辑#2：**根据您的 VB 代码更新，您希望对 C++ 使用相同类型的代码，即使用`S8SimObject`其 C++ 形式的类型（查看生成的 .tlh 文件`_COM_SMARTPTR_TYPEDEF`）。然后你可以直接用`CountContents`. 否则，您将需要查找`CountContents`DISPID，`[IDispatch::GetIDsOfNames](http://msdn.microsoft.com/en-us/library/ms221306.aspx)`然后调用调用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-04T14:21:54.940

通过依赖 VC++ 编译器的内置 COM 支持，您似乎正在使用 C++ 作为 COM 客户端。为了使客户端编码“更容易”，您已经使用`#import`生成 C++ 包装类来尝试对您隐藏所有 COM 详细信息 - 或者至少使 COM 详细信息更简单。因此，您*不是*直接使用 COM SDK，而是使用客户端框架（我认为它类似于 ATL 或 MFC 的轻量级仅 COM 框架）。

但是，您的示例代码似乎将直接的低级 COM SDK ( `VARIANT`s, `BSTR`, `SysAllocString`) 与`#import`COM 框架 ( `_variant_t`, `_bstr_t`, `XXXXPtr`) 混合在一起。来自 C++ 的 COM 一开始很复杂——所以在一个完美的世界里，我建议在走得太远之前先了解 COM 的基础知识。

但是，如果您只是想要一些工作，我***猜***这是`#import`您提供的 VB 代码的 -style-of-COM-clients 版本：

```
_variant_t example1Var;
_variant_t example1Var;
SIMUL8::S8SimObjectQIPtr example1; // I'm guessing at this type-name from the VB code
SIMUL8::S8SimObjectQIPtr example2;

example1Var = pis8->GetSimObject(_bstr_t(L"Example 1"));
example2Var = pis8->GetSimObject(_bstr_t(L"Example 2"));
if (example1Var.vt == VT_DISPATCH && example2Var.vt == VT_DISPATCH)
{
   // **UPDATE** to try to spoon feed the QI ptr...
   example1 = IDispatchPtr((IDispatch*)example1Var);
   example2 = IDispatchPtr((IDispatch*)example2Var);
   // Does this screw-up reference counting?

   int numberOfexamples = example1->CountContents + example2->CountContents;

} 
```

**更新：**
[有关这方面的文档`#import`](http://msdn.microsoft.com/en-us/library/8etzzkb6(VS.71).aspx)使得从 C++ 中使用 COM 变得更加容易，但又是另一件事要学习......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T14:28:54.277

您不必*转换*. `_variant_t`它包含一个`IDispatch`接口指针，因此您可以像这样将其取出：

```
if (v.vt == VT_DISPATCH)
{
    IDispatchPtr pDispatch = v.pdispVal;
    // Do something with pDispatch.
    // e.g. assign it to a strongly-typed interface pointer.
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T14:26:16.700

对象（DISPID_VALUE）有一个“值”的概念。

这是关于解决可能有帮助的 VARIANT 的[codeproject.com 文章。](http://www.codeproject.com/KB/COM/resolving_variants.aspx)

# functional-programming - 如何让我的大脑以“lisp 模式”运转？

> ID：606533
> 
> 赞同：24
> 
> 时间：2009-03-03T14:19:04.423
> 
> 标签：functional-programming, lisp, clojure

我的教授告诉我们，我们可以为下一个编程任务选择一种编程语言。我一直想尝试一种函数式语言，所以我想我会尝试 clojure。问题是我理解语法并理解基本概念，但我无法让所有内容都在我的脑海中“点击”。有人有建议吗？还是我可能选择了错误的语言来开始函数式编程？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-03T14:30:23.647

这有点像骑自行车，只是需要练习。尝试用它解决一些问题，也许[是 ProjectEuler](http://projecteuler.net/)，最终它会点击。

有人提到了《小计谋者》这本书，这是一本很好的读物。尽管它针对的是 Scheme，但实际问题还是值得解决的。

祝你好运！

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-03-03T16:30:16.247

好吧，对我来说，当我开始做 OCAML 时，我遇到了和你一样的问题，但诀窍是你必须开始思考**你想要从代码**中得到什么，而*不是* **如何去做**！！！

例如，要计算列表元素的平方，忘记列表的长度等技巧，只需在**数学**上这样思考：

*   如果列表为空 -> 我完成了

*   如果没有，那么列表必须有头和尾->您计算头的平方，然后要求您的函数对尾执行相同的操作。

想想一般情况和基本情况，你是在发送数据而不是修改它（除非你想修改它；））。

祝你好运！

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-03T14:21:02.313

你可以看看[The Little Schemer](http://www.ccs.neu.edu/home/matthias/BTLS/)。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-10-27T22:56:00.817

这个怎么样：http: [//www.defmacro.org/ramblings/lisp.html](http://www.defmacro.org/ramblings/lisp.html)

这是从常规命令式程序员（Java、C# 等）的角度对 lisp 进行思考的非常简单的分步介绍。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-03T14:40:58.117

出于教育目的，我会推荐 PLT Scheme。它是一个可移植且功能强大的环境，具有非常好的示例和更好的文档。它将帮助您以非常简洁的方式一步一步地发现函数式编程背后的思想。选择一个小应用程序来实现将帮助您学习新语言。

[http://www.plt-scheme.org/](http://www.plt-scheme.org/)

此外，H. Abelssn、G. Sussman 和 J. Sussman 的“Structure and Interpretation of Computer Programs”是一本关于 Scheme（和编程）的非常好的书。

问候

缪

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-03-03T15:48:20.653

关于 Lisp 的一些想法，不是特定于 Clojure 的（我不是 Lisp 专家，所以我希望它们大多是正确和有用的）：

### AST 中的编码

我对编译器或解释器理论知之甚少，但每次我在 Lisp 中编码时，都会让我感到惊讶，感觉就像直接构建 AST。

这就是“代码 = 数据”含义的一部分，在 Lisp 中编码很像用 AST 节点填充数据结构（嵌套列表）。太棒了，而且它也很容易阅读（使用正确的文本编辑器）。

### 一种可编程的编程语言

所以代码块只是嵌套列表，列表操作是语言的一部分。因此，您可以非常轻松地编写生成 Lisp 代码的 Lisp 代码（请参阅 Lisp 宏）。这使得 Lisp 成为一种可编程的（本身！）编程语言。

这使得在 Lisp 中构建[DSL](http://en.wikipedia.org/wiki/Domain-specific_programming_language)或解释器变得非常容易（另请参见[元循环评估](http://en.wikipedia.org/wiki/Metacircular_evaluation)）。

### 永远不要重启任何东西

在大多数 Lisp 系统中，代码（包括文档）可以在运行时进行自省和热交换。

### 高级面向对象

然后，大多数 Lisp 系统都有某种派生自 CLOS 的对象系统，这是一种高级（与许多 OOP 实现相比）和可配置的对象系统（请参阅元对象[协议的艺术](http://en.wikipedia.org/wiki/The_Art_of_the_Metaobject_Protocol)）。

所有这些功能都是很久以前发明的，但我不确定它们是否可以在许多其他编程语言中使用（尽管大多数都在追赶，例如闭包），所以你必须“重新发现”并通过练习来习惯这些（见其他答案中的书籍）。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-03-25T06:22:00.813

看看[99 个 Lispy 问题](http://www.ic.unicamp.br/~meidanis/courses/mc336/2006s2/funcional/L-99_Ninety-Nine_Lisp_Problems.html)

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-03-03T14:44:56.670

请记住：都是数据！

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-03-03T17:45:26.283

写一些Lisp擅长的简单经典函数，比如

*   反转列表

*   判断一个原子是否在 s 表达式中的某个位置

*   写 EQUAL 来判断 2 个 s 表达式是否相等

*   编写 FRINGE 以获取 s 表达式边缘的原子列表

*   写 SUBST，然后写 SUBLIS

*   符号分化

*   代数化简

*   写一个简单的 EVAL 和/或 APPLY

了解 Lisp 非常适合这类无副作用的函数式程序。

它对于有状态的副作用（非功能性）程序也很有用，但它们更像是“程序”而不是“函数”。

对于给定的应用程序哪个更好取决于应用程序。一般来说，它包含的状态信息不应少于或多于必要的信息。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-03-04T03:32:48.260

简单的！

> **`M-x`**  `lisp-mode`

好的，好的，所以你的大脑可能没有 Emacs。说真的，你需要做的是真正擅长递归。当试图将递归的概念扩展到规范示例之外时，这可能是一个相当大的脑筋急转弯，但最终它会导致更流畅、更流畅的代码。

另外，很多人都被括号挂断了，我真的不知道为什么——语法非常简单和一致，可以在几分钟内掌握。对我来说，在学习了 C++ 和 Java 之后，我来到了 Scheme，我一直认为“函数”和“运算符”之间的区别是一种错误的二分法，看到这种区别被消除了，我感到很振奋。

就函数式编程而言，只要你能理解一个函数是一等值并且可以传入和传出其他函数的事实，你应该没问题。随着时间的推移，它的用处会变得很明显，但是你可以编写函数获取和函数返回函数就足够了。

最后，我不确定 Clojure 对宏有什么支持，但它们被认为是 lisp 的重要组成部分。但是，在您对上述项目非常熟悉之前，我不会担心学习它们 - 尽管宏非常有用且用途广泛，但与我提到的其他技术相比，它们的使用频率也较低。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-03-03T14:31:03.240

我会从一种可以解释的语言开始。我发现[莫斯科 ML](http://www.itu.dk/~sestoft/mosml.html)相当容易。它是标准 ML 的轻量级实现。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-03-03T14:38:27.153

我个人的做法是找一个小项目（可能需要 3-5 晚才能完成）并实施它。博客过滤工具怎么样？也许只是河内塔或链接列表的实施（这些通常是一晚的项目）。

通常的解决方法是我第一次实施得很糟糕，扔掉了我拥有的东西，最后点击了几个小时。

一个巨大的帮助是参加类似......嗯...... LISP 的课程！:) 作业将迫使您面对很多概念，并且在学期结束之前很久就对我产生了影响。

祝你好运！！

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-03-03T14:55:46.677

祝你好运。在 Scheme “点击”之前，我花了大约一半的时间完成了大学的“编程语言”课程。然而，一旦发生这种情况，一切都变得有意义了，我爱上了函数式编程。

用 Lisp 编写一个 Lisp 解释器。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-03-03T15:14:46.443

如果您还没有，请阅读是什么让 lisp 成为一种独特的语言。如果您不首先这样做，您将尝试做与其他编程语言相同的事情。

然后尝试实现一些小东西（尝试让它对你有用，否则你可能没有动力）。

[盒子里的 Lisp](http://common-lisp.net/project/lispbox/)是让你的脚湿透的好方法。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-03-03T17:24:59.127

谁说它会点击？*我总是很困惑*

但是，如果您考虑在 lisp 宏后面可以隐藏多少抽象。然后你的大脑就会爆炸。

:)

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-03-03T17:34:45.607

对我来说，重要的是确保你以“lisp-y”的方式做所有事情。不要想‘在 Java 中我会在这里使用 for 循环，我如何在 Lisp 中执行 for 循环？但是要通过足够的示例和教程（正如有人指出的那样，[SICP](http://mitpress.mit.edu/sicp/full-text/book/book.html)非常适合此），您可以在代码看起来“Lisp-y”时开始发现并识别常见的语言范式。

我当然知道查看我刚刚编写的一些代码的感觉，并且直观地知道它对于该语言和平台/框架来说是正确的惯用语——我认为，这就是它“点击”的时候。

**编辑**：选择函数式语言的荣誉，较小的学生会用Java完成它:)

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-03-03T17:58:22.650

我会看看 Programming Clojure。对于非 lispers 来说，这是一本很棒的书。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2009-03-04T03:16:12.903

除了其他 SO'ers 已经建议的内容之外，这是我的 2 美分：

1.  开始学习语言并尝试一些简单的数字/爱好问题
2.  **重要提示：**将解决方案/代码发布到 StackOverflow，征求人们的意见，这是否真的是 LISPy的*做法*。

祝你好运！

# windows - 打开远程机器的 Windows C 驱动器

> ID：606534
> 
> 赞同：26
> 
> 时间：2009-03-03T14:19:56.497
> 
> 标签：windows, windows-xp, sysadmin

我正在尝试在本地安装我 LAN 上的机器的 C 驱动器。在跟踪代码时，我需要能够浏览另一台机器的内容。我曾经看到一个系统管理员在 cmd 提示符下做一些疯狂的 Windows 咒语。类似 $remote_machine/local_access/C

有人熟悉这是如何完成的吗？

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2009-03-03T14:21:12.733

如果不是 XP 家庭版，可以使用`\\servername\c$`

马克布拉克特的评论：

> 请注意，您需要成为本地计算机上的管理员，因为共享权限已被锁定

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-03T15:01:47.893

如果您需要驱动器号（某些应用程序不喜欢以机器名称开头的 UNC 样式路径），您可以将驱动器“映射”到 UNC 路径。右键单击“我的电脑”并选择映射网络驱动器...或使用以下命令行：

网络使用 z：\server\c$\folder1\folder2

网络使用 y: \server\d$

请注意，您可以映射驱动器到驱动器或向下钻取并映射到子文件夹。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-03T14:24:11.433

默认情况下，Windows 使每个驱动器的根目录可用（前提是您具有管理员权限）为 (eg) `\\server\c$`。这些被称为[管理份额](http://en.wikipedia.org/wiki/Administrative_share)。

# ms-word - Making Word document embedded in a web page editable or read-only

> ID：606537
> 
> 赞同：5
> 
> 时间：2009-03-03T14:20:28.617
> 
> 标签：ms-word, ms-office, office-2003

I'm embedding some Word documents into our web page using `iframe` like this:

```
<iframe src="ftp://ftp.example.com/www/uploads/Image/test.doc" width="100%" height="400">  
    Alternative
</iframe> 
```

The problem is that the embedded Word control allows the user to edit the documents and shows an icon to save them, but doesn't actually save anything. Is it possible to setup Word to save edits back to the FTP server? If not, is there someway we can make the document read-only so the user doesn't get the idea that they can make changes? We're using IE7 and Word 2003.

(I just asked a related question about getting Word to save to a FTP server: [Possible for Word to edit documents directly off an web server without Sharepoint?](https://stackoverflow.com/questions/606456/possible-for-word-to-edit-documents-directly-off-an-web-server-without-sharepoint))

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-12-02T17:06:25.057

您可以使用像 EDraw OfficeView 或 UltraOffice 这样的 ActiveX 组件来嵌入 Office，并让您很少控制保存和编辑文档。您也可以将其发送回服务器进行保存。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-10T01:23:37.297

您的问题有多种解决方案，我认为最简单的是商业应用程序：[https](https://crocodoc.com/) ://crocodoc.com/ 。开发人员有无限的预览时间，但生产使用需要许可证，不知道这是否适合您的情况？要使其在 IE7 中工作，您还需要 [http://html5boilerplate.com/](http://html5boilerplate.com/)和[http://code.google.com/p/html5shiv/](http://code.google.com/p/html5shiv/)。

不确定此解决方案是否会保持免费，但目前是：[https](https://cloudconvert.org/page/api) ://cloudconvert.org/page/api 。他们提供了一个将文档转换为 html 的 api，您可以编写一个脚本在上传时将文档转换为 html，然后将 html 存储在网站上显示。

另一个不错的选择是[http://www.phpdocx.com/](http://www.phpdocx.com/)他们有一个转换插件可以将 docx 转换为 HTML、pdf 等。

至于使您现有的解决方案只读，我在某处读到您可以使用以下方法进行操作，但我无法测试，因为我在 Mac 上并且目前无法访问带有 IE 的机器。

```
<object id="msword" width="100%" height="100%" classid="clsid:67F2A879-82D5-4A6D-8CC5-FFB3C114B69D" data='[insert document name].doc'>
    <PARAM NAME="src" VALUE="file:////[insert full document path here].doc" >
    <PARAM NAME="readonly" value=true>
</object> 
```

希望这些建议对您的项目有所帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T18:56:14.580

我建议将文件转换为 mht 文件。这将在浏览器中显示时提供更清晰的线条，并防止用户编辑或保存文件。

# c# - Calling GetObjectData on serialization

> ID：606539
> 
> 赞同：4
> 
> 时间：2009-03-03T14:20:40.053
> 
> 标签：c#, .net, serialization

I am confused about the serialization sample from [MSDN](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.iserializable.getobjectdata.aspx).

My confusion is in method GetObjectData (which is called during serialization), will the method,

1.  serialize both the additional data (in method GetObjectData from AddValue) and the fields/properties of the class;
2.  or just write the data in method GetObjectData without writing fields/properties of the class?

I have debugged seems (2) is correct -- no fields/properties data are serialized if GetObjectData method is used? Is that correct? (I am not an expert and just want to confirm here, but 100% confident about myself.)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-03T14:41:35.713

我不确定您想要实现什么，但让 C# 为您完成工作并不容易：

```
using System;
using System.Collections.Generic;
using System.Xml.Serialization;

namespace Test
{
    [Serializable]
    public class TestObject
    {
        private String name;
        private String note;
        #region Getters/setters

        public String Name
        {
            get { return name; }
            set { name = value; }
        }

        public String Note
        {
            get { return note; }
            set { note = value; }
        }
        #endregion
    }
} 
```

现在您可以使用 XmlSerializer 或 BinaryFormatter 来（反）序列化对象

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-03T14:33:07.480

如果您实施`ISerializable`，您应对*所有*数据负责（即您的问题中的场景“2”）；没有额外的东西会自动序列化。你的要求是什么？诸如此类的东西`DataContractSerializer`可以是基于属性的，允许您装饰常规字段**和**自定义属性（具有一些逻辑）并正确序列化它们。如果您需要二进制文件（用于空间等），那么也许可以考虑[protobuf-net](http://code.google.com/p/protobuf-net/)之类的东西，它将两者混合在一起，同时节省空间。

那么：你的要求是什么？

数据合约示例：

```
[DataContract]
public class Foo {
    [DataMember]
    public int Bar {get;set;} // simple data

    [DataMember]
    private string DoSomeThinking {
        get {.... serialize the complex data ....}
        set {.... deserialize the complex data ....}
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-03T14:36:14.540

如果您实现 ISerializable，则必须使用 AddValue 将所有数据（至少是反序列化所需的数据）包括所有字段添加到 SerializationInfo。

# c# - asp.net, Panel Width

> ID：606546
> 
> 赞同：1
> 
> 时间：2009-03-03T14:21:46.883
> 
> 标签：c#, asp.net, panel

I am using .net 2005\. In that i have master page and content page, i am using panel inside content.

**Is any body know how to set panel width as per screen size at run time ??**

Thanks

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T14:27:59.380

Set a css class attribute on your panel

```
<asp:Panel CssClass="fullWidth" ID="MyPanel" runat="server">
</asp:Panel> 
```

Then link to an external css stylesheet from your master page an in that set the following

```
.fullWidth
{
    width: 100%;
} 
```

**NOTE: This sets the width of any element with class fullWidth to 100% of the width of it's parent and can be used for other elements also**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T14:27:23.563

Add a javascript function on onload event on the body tag to resize your panel width.

Note, this code has been typed without syntax verification.

```
<script language="javascript" type="text/javascript">
    function Resize(item, width)
    {
        document.getElementById(item).width = width;
    }
</script>

<body onload="Resize(<%= Mypanel.ClientID %>, screen.width)"> 
```

# vb.net - Use global.asax to trigger event on master.page to show application errors

> ID：606551
> 
> 赞同：1
> 
> 时间：2009-03-03T14:22:12.903
> 
> 标签：vb.net, asp.net-ajax, global-asax, modalpopupextender

I would like to use my AJAX-enabled VB web application's gloabal.asax application_error sub to manage all my error handling. However, instead of just sending the user to an error page, I would like to show the error message to the user via a modalpopupextender control located inside the site's master.page.

Can someone please explain in detail how this can be accomplished? I have managed to do this using a single aspx page (with the `modalpopupextender` dynamically loaded there via a placeholder) and my error-handler class raising the event to show the popup back on the page when an error occurs, but have not had success in doing the same using the master.page.

# c# - Converting Excel 2003 Workbook to Excel 97 in C#

> ID：606553
> 
> 赞同：1
> 
> 时间：2009-03-03T14:22:49.407
> 
> 标签：c#, excel

How would I convert and Excel 2003 Open XML Workbook to Excel 97 Format using C#?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T14:30:32.820

Is it simply data or are there formulas and VBA? If it is just data you could read in the file as XML and do use an XSLT to convert the data to a CSV file.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T14:34:03.267

使用 Visual Studio Tools for Office，打开工作簿，然后执行 SaveAs，选择 Excel 97 作为格式类型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T16:20:26.677

You could try following:

1.  Start Excel
2.  Start Macro recording mode
3.  Open an open-xml workbook.
4.  Save it as Excel 97.
5.  Stop Macro recording mode.
6.  View the generated VBA code and port it to C# using the VS tools for Office mentioned by Nathan.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T21:21:36.467

你是说 Excel 2007 Open XML 吗？没有 Excel 2003 Open XML 格式。Excel 2003 SpreadsheetML 格式是一种不完整的 XML 格式，也是一种死胡同。

[SpreadsheetGear for .NET](http://www.spreadsheetgear.com/)可以读取和写入 Excel 97-2003 (xls) 工作簿和 Excel 2007 Open XML (xlsx) 工作簿，并将在这两种格式之间进行转换。

如果您想尝试一下，可以免费[评估。](https://www.spreadsheetgear.com/downloads/register.aspx)

免责声明：我拥有 SpreadsheetGear LLC

# python - 如何在 Python 中获取 __main__ 模块的文件名？

> ID：606561
> 
> 赞同：73
> 
> 时间：2009-03-03T14:24:11.323
> 
> 标签：python, python-module

假设我有两个模块：

一个.py：

```
import b
print __name__, __file__ 
```

b.py：

```
print __name__, __file__ 
```

我运行“a.py”文件。这打印：

```
b        C:\path\to\code\b.py
__main__ C:\path\to\code\a.py 
```

**问题**：如何`__main__`从“b.py”库中获取模块的路径（在本例中为“a.py”）？

* * *

## 回答 #1

> 赞同：88
> 
> 时间：2009-03-03T16:04:22.800

```
import __main__
print(__main__.__file__) 
```

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2009-03-03T14:27:58.427

也许这会奏效：

```
import sys
from os import path
print(path.abspath(str(sys.modules['__main__'].__file__))) 
```

请注意，为了安全起见，您应该检查`__main__`模块是否具有`__file__`属性。如果它是动态创建的，或者只是在交互式 python 控制台中运行，它不会有`__file__`：

```
python
>>> import sys
>>> print(str(sys.modules['__main__']))
<module '__main__' (built-in)>
>>> print(str(sys.modules['__main__'].__file__))
AttributeError: 'module' object has no attribute '__file__' 
```

一个简单的 hasattr() 检查将起到防范场景 2 的作用，如果这在您的应用程序中是可能的。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-03-03T20:29:30.587

下面的 python 代码提供了额外的功能，包括它与[`py2exe`](http://www.py2exe.org/)可执行文件无缝协作。

我使用类似的代码来查找相对于运行脚本的路径，也就是`__main__`. 作为一个额外的好处，它可以跨平台工作，包括 Windows。

```
import imp
import os
import sys

def main_is_frozen():
   return (hasattr(sys, "frozen") or # new py2exe
           hasattr(sys, "importers") # old py2exe
           or imp.is_frozen("__main__")) # tools/freeze

def get_main_dir():
   if main_is_frozen():
       # print 'Running from path', os.path.dirname(sys.executable)
       return os.path.dirname(sys.executable)
   return os.path.dirname(sys.argv[0])

# find path to where we are running
path_to_script=get_main_dir()

# OPTIONAL:
# add the sibling 'lib' dir to our module search path
lib_path = os.path.join(get_main_dir(), os.path.pardir, 'lib')
sys.path.insert(0, lib_path)

# OPTIONAL: 
# use info to find relative data files in 'data' subdir
datafile1 = os.path.join(get_main_dir(), 'data', 'file1') 
```

希望上面的示例代码可以为如何确定运行脚本的路径提供额外的见解......

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2014-04-05T18:08:36.460

另一种方法是使用`sys.argv[0]`.

```
import os
import sys

main_file = os.path.realpath(sys.argv[0]) if sys.argv[0] else None 
```

`sys.argv[0]`如果 Python 开始使用`-c`或从 Python 控制台检查，则将是一个空字符串。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-01-17T20:57:33.853

```
import sys, os

def getExecPath():
    try:
        sFile = os.path.abspath(sys.modules['__main__'].__file__)
    except:
        sFile = sys.executable
    return os.path.dirname(sFile) 
```

此函数适用于 Python 和 Cython 编译的程序。

# versioning - 在分布式架构中，为什么很难管理版本？

> ID：606566
> 
> 赞同：6
> 
> 时间：2009-03-03T14:24:44.020
> 
> 标签：versioning

我一次又一次地看到这个。UAT 测试经理希望新版本在周五之前准备好进行测试。在预测试会议上提出的第一个问题是，“我将针对哪个版本进行测试？” （这是一个公平的问题）。房间里安静了下来，然后有人会回来说：“所有程序集都有自己的版本，只需右键单击并查看属性...”。

从测试经理的角度来看，这是没有用的。他们想要一个版本/标签/标签来​​告诉他们正在做什么**。**他们希望这些信息很容易获得。

我已经看到解决方案，其中系统的不同区域的版本存储在数据存储中，然后显示在主应用程序的关于框上。问题是，这需要维护。

您看到什么解决方案可以解决这个持续存在的问题？

编辑。分布式系统涵盖VB6、Classic ASP、VB.Net、C#、Web Services（跨部门，我们用的是哪个版本？）、SQL Server 2005。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T15:03:08.127

我认为问题在于您和您的测试经理在谈论两件不同的事情。程序集版本非常适合程序集，但如果您愿意的话，您的测试经理正在谈论更高级别的版本，即“系统版本”。至少这是我读到你的帖子。

在这种情况下，您必须将所有不同的组件组件映射到系统版本中。您说的内容类似于“系统的 1.5 版由 Foo.Bar.dll v1.4.6 和 Baz.Qux.dll v2.6.7 和（等）组成”。天啊，在分布式系统中，您可能希望每个服务有不同的版本，这些服务本身可能由不同版本的 .dll 组成。例如，您可能会说：“系统的 1.5 版本由 Foo 服务 v1.3 组成，该服务由 Foo.dll v1.9.3 和 Bar.dll v1.6.9 组成，以及 Bar 服务 v1.9，其中由 Baz.dll v1.8.2 和 Qux.dll v1.5.2 和（等）组成。

做这样的事情通常是组织中软件架构师和/或构建经理的工作。

您可以使用许多与您选择的语言无关的工具来处理此问题。目前我个人最喜欢的是[Jira](http://www.atlassian.com/software/jira/)，除了错误跟踪之外，它还具有出色的产品版本控制和路线图支持。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T14:29:15.897

可能想看看[这个页面](http://www.codeproject.com/KB/dotnet/ManagingAssemblyVersions.aspx)，它解释了将一致版本控制集成到构建过程中的一些方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T14:38:29.307

有许多不同的事情导致了这个问题。在我的脑海中，这是一个：

分布式架构的好处之一是，我们通过创建服务并以某种形式发布它们的接口，获得了巨大的重用潜力。这意味着客户端应用程序的发布不一定与底层服务的发布密切同步。因此，可能会发布一个新版本的业务应用程序，它使用它已经使用了一年的相同的旧可靠服务。在这种情况下，我们应该如何应用单个发布标签？

尽管如此，这是一个公平的问题，但需要一个重要的答案才能有意义。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T14:29:37.427

除了内部引用之外，不使用基于构建的版本编号。当 UAT 经理提出问题时，您会说“星期五*”。

唯一的技巧是确保标签在源代码管理中可靠地发生。

** 在此处插入适当的日期戳/标签*

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-03T14:31:36.813

我们使用 .NET 和 Subversion。我们所有的应用程序程序集都共享一个版本号，该版本号源自手动更新的主要和次要修订号以及 Subversion 修订号 ( `<major>.<minor>.<revision>`)。我们有一个预构建任务，它在共享的 AssemblyVersionInfo.vb 文件中更新此版本号。然后，当测试人员询问版本号时，我们可以给他们完整的 3 部分号码，也可以只给他们颠覆版本。我们使用的库没有改变，或者改变与测试人员无关。

# lucene - 使 lucene 将一个字段中的所有术语视为一个术语

> ID：606576
> 
> 赞同：0
> 
> 时间：2009-03-03T14:28:03.577
> 
> 标签：lucene

在我的 Lucene 文档中，我有一个“公司”字段，其中公司名称被标记化。我需要对我的应用程序的某个部分进行标记化。但是对于这个查询，我需要能够在整个公司字段上创建一个 PrefixQuery。

例子：

*   我的品牌
    *   我的
    *   品牌
*   婆罗门农场
    *   婆罗门
    *   农场

定期查询“bra”将返回两个文档，因为它们都有一个以 bra 开头的术语。
不过，我想要的结果只会返回最后一个条目，因为第一个词以 bra 开头。

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T14:40:33.937

创建另一个索引字段，其中公司名称*未*标记化。必要时，搜索该字段而不是标记化的公司名称字段。

* * *

如果您想要快速搜索，您需要有直接指向感兴趣记录的索引条目。您可能可以使用邻近数据来过滤记录，但这会很慢。我认为问题是：如何有效地执行对完整字段的“包含”查询？

您可以通过创建（为每个当前字段）“第一项”字段和“剩余项”字段来最小化索引大小的增加。这将消除两个字段中第一项的重复。对于“正常”查询，您可以在这些字段中的任何一个中查找查询词。对于“startswith”查询，您只搜索“first term”字段。但这似乎比它的价值更麻烦。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-10-26T00:56:28.270

使用[SpanQuery](http://lucene.apache.org/java/3_4_0/api/core/org/apache/lucene/search/spans/SpanQuery.html)仅搜索第一个词的位置。由 SpanPositionRangeQuery 包裹的由 SpanMultiTermQueryWrapper 包裹的 PrefixQuery：

```
<SpanPositionRangeQuery: spanPosRange(SpanMultiTermQueryWrapper(company:bra*), 0, 1)> 
```

# java - Generating and Displaying PDF file in Flex/Java

> ID：606580
> 
> 赞同：3
> 
> 时间：2009-03-03T14:29:40.717
> 
> 标签：java, apache-flex, pdf, pdf-generation, jasper-reports

We have Flex on the front end and Java on the back end. When a user will request for a PDF file, request will go to the Java backend, where a PDF file will be generated using Jasper Reports. What we dont know is how to display this PDF file in browser; since we dont want to use JSP/Servlets etc - It has to be flex only. Any suggestions?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T16:36:10.367

Flash Player cannot natively render PDF files. This is possible using Adobe AIR but not in a Flex application. Your best bet is to call navigateToURL() and open a Servlet in a new browser tab/window. The Servlet can simply write contents of the PDF file to the OutputStream and set the appropriate HTTP headers.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-08-02T08:03:04.787

我认为这个问题很老，但它可能对其他人有帮助，Jasper Forge 他们自己开发了一个新库，它直接处理 JasperReports，我的意思是它不是 PDF 查看器，而是 JasperReport 导出工具，你可以从[这里下载](http://sourceforge.net/projects/jasperreports/files/jasperreports-flash/)

我通过使用[JasperServer](http://jasperforge.org/projects/jasperserver)进行了尝试，在查看报告时，您可以选择不同的选项来导出它，其中之一是 flash，它工作得很好

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T14:32:12.457

对于初学者来说，PDF 并不总是显示在浏览器中。这取决于用户的设置。您基本上将它们放在 pdf 文件的标题上，然后他们下载它，或者在浏览器中打开像 Acrobat Reader 这样的程序来显示它。

不知道这是如何在 flex 中完成的，我想如果你使用 Java，一个简单的 servlet 就可以做到。

# java - 有没有办法让 JComboBox 像 HTML Select 一样？

> ID：606582
> 
> 赞同：4
> 
> 时间：2009-03-03T14:30:10.293
> 
> 标签：java, swing, jcombobox

我正在尝试模仿 HTML Select 标记。我想将文本显示为选项，但选择后，我会使用其值。

例如，我会有一个国家名称列表。但是，当用户选择日本时，我想获取该国家/地区的区域设置代码。所以用户看到他们选择了日本，但我的代码会得到“ja_JP”之类的东西。

我试图避免将国家名称和区域设置代码存储在 HashMap 或其他东西中。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-03T14:37:01.760

创建一个包含显示名称和国家代码的 Country 对象。您可以快速而肮脏地覆盖 toString 以显示显示名称，然后在用户选择某些内容时在需要时检索代码。

```
public class Country
{
    String display;
    String code;

    @Override
    public String toString()
    {
        return display;
    }

    public String getCode()
    {
        return code;
    }
} 
```

因为我很懒，所以省略了构造函数。如果您对覆盖 toString 不满意，您还可以创建自己的渲染器来处理 Country 对象，并通过新的 getter 使用显示。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T14:37:43.367

编辑：我需要更快地打字。

我通常创建一个自定义对象来保存“值”并覆盖 toString() 以返回 JComboBox 应该显示的内容。或者，您可以编写自己的单元格渲染器。

# c# - 如何在两组数据中找到部分不同的项目子集？

> ID：606591
> 
> 赞同：2
> 
> 时间：2009-03-03T14:31:13.647
> 
> 标签：c#, .net, linq, set-theory

我正在尝试获取dataA中位于dataB中的项目子集，并且具有不同的属性c值。属性 a 和 b 可以用作索引，因此我尝试仅过滤掉有用的对，然后检查它们是否具有不同的 c 值。

这是我想出的 linq 表达式，它确实有效，但似乎必须有更好/更快的方法来找到这个子集。

```
var itemsInBoth = from item in dataA
                  from item2 in dataB
                  where item.a == item2.a && item.b == item2.b
                      select new
                      {
                          first= item,
                          second = item2
                      };
var haveDifferentC = from item in itemsInBoth 
                     where item.first.c != item.second.c
                     select item.first; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T17:50:53.230

根据 David B 提供的答案，我最终决定对他的方法进行稍微修改的版本。尽管差异很小，但我想我会分享这个，主要是为那些（像我一样）喜欢表达语法的人展示一个版本。

此外，我决定使用匿名键/值对来简化结构，而不是分组。

```
var dictA = (from item in dataA
             select new
             {
                 key = CreateIndexValue(item.a, item.b),
                 value = item
             }).ToDictionary(kv => kv.key, kv => kv.value);
var dictB = (from item in dataB
             select new
             {
                 key = CreateIndexValue(item.a, item.b),
                 value = item
             }).ToDictionary(kv => kv.key, kv => kv.value);
var filesInBoth = from item in dictA
                  where dictB.ContainsKey(item.Key)
                  select new
                  {
                      itemA = dictA[item.Key],
                      itemB = dictB[item.Key]
                  };
var differentSize = from item in filesInBoth
                    where item.itemA.c!= item.itemB.c
                    select item.itemA; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T15:00:32.157

快点？你所拥有的是O（n ^ 2）。第一个列表中的每个项目将完全迭代第二个列表中的项目。您需要删除该连接中的冗余迭代。一种方法是使用另一种结构对匹配项进行 O(1) 查找。

这是一些未经测试（未经检查）的代码：

```
var dictionaryA = dataA
  .GroupBy(item => new {a = item.a, b = item.b})
  .ToDictionary(g => g.Key, g => g.ToList());

var dictionaryB = dataB
  .GroupBy(item => new {a = item.a, b = item.b})
  .ToDictionary(g => g.Key, g => g.ToList());

var results = dictionaryA
  .Where(g1 => dictionaryB.ContainsKey(g1.Key))
  .Select(g1 => new {g1 = g1, g2 = dictionaryB[g1.Key]})
  .SelectMany(pair =>
    pair.g1.SelectMany(item1 =>
      pair.g2
      .Where(item2 => item2.c != item1.c)
      .Select(item2 => new {item1, item2})
    )
  ); 
```

如果 a,b 对在每个列表中是唯一的，则这是一个简化版本。

```
var dictionaryA = dataA
  .ToDictionary(item => new {a = item.a, b = item.b}, item => item);

var dictionaryB = dataB
  .ToDictionary(item => new {a = item.a, b = item.b}, item => item);

var results = dictionaryA
  .Where(e1 => dictionaryB.ContainsKey(e1.Key))
  .Select(e1 => new {i1 = e1.Value, i2 = dictionaryB[e1.Key]})
  .Where(pair => pair.i1.c != pair.i2.c); 
```

# c# - 在.net 析构函数中重新创建对“this”的根引用是否合法？

> ID：606595
> 
> 赞同：4
> 
> 时间：2009-03-03T14:32:33.033
> 
> 标签：c#, .net, garbage-collection, destructor, finalizer

在 .net 中编写以下内容是否合法？

```
 public class A
    {
        public int i = 0;
        ~A()
        {
            Aref = this;
        }
    }

    public static A Aref;
    static void Main(string[] args)
    {
        Aref = new A();
        int gen = GC.GetGeneration(Aref);
        Aref = null;
        GC.Collect(gen, GCCollectionMode.Forced);
        GC.WaitForPendingFinalizers();
        Console.WriteLine(Aref.i);
        Console.ReadLine();
    } 
```

它按预期工作并向控制台写入'0'，但我想知道它是否保证始终工作。

有人知道幕后发生了什么吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-03T14:44:23.630

这叫做复活，是合法的。谷歌搜索“.net object resurrection”（以及类似的术语），您会发现以下内容：

[Resurrection 和 .NET 垃圾收集器](http://www.c-sharpcorner.com/UploadFile/raviramnath/ResurrectionGCRN12222005072151AM/ResurrectionGCRN.aspx?ArticleID=aa5775e4-8a46-49d1-8309-e03d8ef58372)

[对象复活](http://blogs.msdn.com/clyon/archive/2006/04/25/583698.aspx)

只要确保这些僵尸物体不会回来并试图吃掉你的大脑或其他东西。像所有的死灵法术一样，这是危险的东西。（主要是因为类层次结构中较高的终结器可能已经释放了一些必要的资源。还要注意，如果对象“未引用”，终结器将不会再次运行，除非您调用`GC.ReRegisterForFinalize`.）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T14:50:09.000

它之所以有效，是因为第一次垃圾收集不收集实例。它只是安排实例运行其终结器。终结器然后为实例创建一个新的根，所以当下一次收集发生时，实例实际上是根的，因此不适合收集。

你应该非常小心这个艰难的。如果使用终结器来确保释放对象，这实际上违反了协议，因为可释放模式表示，如果在释放后使用已释放的实例，则应抛出 ObjectDisposedException。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-12-02T08:06:13.033

垃圾收集器将对象分为三组：

1.  那些还活着的，因为最后检查了一个根引用存在于终结队列之外；
2.  那些需要删除的，因为任何地方都不存在根引用；
3.  那些需要最终确定的，因为根引用存在于终结队列中，但没有其他地方。

除非任何地方都没有根引用，否则无法删除对象。定稿是删除前的一个独特阶段；请注意，当一个对象被注册为终结时，它直接或间接引用的所有对象都将受到保护，不会被删除，但不会被终结。

# .net - .Net 是否有等效的 JavaBlackBelt？

> ID：606598
> 
> 赞同：2
> 
> 时间：2009-03-03T14:32:48.947
> 
> 标签：.net

当我第一次学习 java 时，我经常使用 JavaBlackBelt，现在我已经切换到 .Net，我想知道是否有一个等效的站点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T14:51:27.607

当我 7 年前刚开始工作时，我发现[CodeProject](http://www.codeproject.com)帮了我很多。那时它不那么拥挤，但它仍然是 Windows 和 .NET 程序员的绝佳资源。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-17T15:16:49.947

没有什么比 JavaBlackBelt 更能巧妙地激励开发人员提高他们的技能了。您必须向 Microsoft 支付任何测试费用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-19T05:02:53.087

实际上 JavaBlackBelt 有一些 c# 的东西（测试版考试）。我希望有更多的人来

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T14:35:39.173

我推荐 CodeBetter.com，它不一样但很有见地。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-03T14:48:17.053

Microsoft Developer Network ( [MSDN](http://msdn.microsoft.com) ) 有一个关于[培训](http://msdn.microsoft.com/en-us/bb188199.aspx)的部分。我意识到这不是一个开放的社区，但是由于您是 .NET 的新手，所以我想我会提到它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-18T20:48:38.083

我喜欢[Codeproject](http://www.codeproject.com)和[MSDN](http://msdn.microsoft.com)

# java - 突出显示继承的成员

> ID：606599
> 
> 赞同：4
> 
> 时间：2009-03-03T14:33:00.570
> 
> 标签：java, eclipse, syntax-highlighting

有没有办法在视觉上分离继承的类成员，即在超类中定义为公共/受保护的变量？

我注意到可以分别对抽象成员进行风格化......

我正在使用 Eclipse Ganymede。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T15:11:43.393

打开窗口 > 首选项。

选择左侧的常规 >​​ 外观 > 颜色和字体。

在右侧选择 Java > Inherited Members，然后选择所需的颜色。

此颜色将在继承成员的层次结构视图中使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T15:04:45.157

您可以在给定类的层次结构视图中看到明显的差异（在类名称上按 F4）。

然后按详细视图上的“显示所有继承的成员”按钮。

[替代文本 http://help.eclipse.org/ganymede/topic/org.eclipse.jdt.doc.user/tips/images/hierarchy-lockview.png](http://help.eclipse.org/ganymede/topic/org.eclipse.jdt.doc.user/tips/images/hierarchy-lockview.png)

**当前类型中声明的方法/变量以蓝色显示，继承的以黑色显示。**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-05T06:29:56.047

如果您在谈论编辑器，那么您可能是指被覆盖的方法（不是继承的），对吧？如果是这样，Eclipse 会在编辑器中用指向方法签名左侧的绿色箭头指示被覆盖的方法。单击绿色箭头将带您进入该方法的超类实现。

至于实际改变文本的颜色，我不知道——绿色箭头对我来说一直是足够的。

# msbuild - MSBuild Copy 任务第一次没有复制文件

> ID：606605
> 
> 赞同：14
> 
> 时间：2009-03-03T14:34:40.690
> 
> 标签：msbuild

我创建了一个 build.proj 文件，其中包含一个复制文件的任务，这些文件将在构建完成后生成。问题是这些文件第一次没有被复制，我必须在 build.proj 上再次运行 msbuild 以便可以复制文件。请谁能告诉我以下 build.proj 文件有什么问题：

```
<Configuration Condition="'$(Configuration)' == ''">Debug</Configuration>

<SourcePath Condition="'$(SourcePath)' == ''">$(MSBuildProjectDirectory)</SourcePath> 

<BuildDir>$(SourcePath)\build</BuildDir>

</PropertyGroup> 

<ItemGroup> 
    <Projects 
       Include="$(SourcePath)\src\myApp\application.csproj">  
    </Projects> 
</ItemGroup> 

<Target Name="Build">
   <Message text = "Building project" />    
   <MSBuild   
     Projects="@(Projects)" 
     Properties="Configuration=$(Configuration)" /> 
</Target>

<ItemGroup>
   <OutputFiles Include ="$(MSBuildProjectDirectory)\**\**\bin\Debug\*.*"/>
</ItemGroup>

<Target Name="CopyToBuildFolder">
   <Message text = "Copying build items" />
   <Copy SourceFiles="@(OutputFiles)" DestinationFolder="$(BuildDir)"/>
</Target>

<Target Name="All"
   DependsOnTargets="Build; CopyToBuildFolder"/>

</Project> 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-03-03T14:47:26.353

解析脚本时会评估项目组。那时你的文件还没有。为了能够找到文件，您必须从目标中填充项目组。

```
 <!-- SQL Scripts which are needed for deployment -->
  <Target Name="BeforeCopySqlScripts">
    <CreateItem Include="$(SolutionRoot)\04\**\Databases\**\*.sql">
      <Output ItemName="CopySqlScript" TaskParameter="Include"/>
    </CreateItem>
  </Target> 
```

此示例使用 Include 属性中的表达式创建名为“CopySqlScript”的 ItemGroup。

编辑：

现在我可以阅读您的脚本：在 CopyToBuildFolder 目标中添加 CreateItem 标记

# .net - 使用 NHibernate 映射字符串集合

> ID：606607
> 
> 赞同：14
> 
> 时间：2009-03-03T14:35:40.140
> 
> 标签：.net, nhibernate

我有一个域类，其属性`IList<string>`要映射到具有单个数据值的表（即它有一个 ID、域实体表的外键 ID 和一个 varchar 数据列）。

我不断收到错误：

> 关联引用未映射的类：System.String

如何将表映射到字符串集合？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-03-04T14:18:47.693

我刚刚遇到了类似的情况；我发现确实可以映射字符串集合。请注意，您必须将这些字符串映射为值对象。

这就是我所拥有的：

```
public class Chapter
{
    private ISet<string> _synonyms = new HashedSet<string>();

    public ReadOnlyCollection<string> Synonyms
    {
       get { return new List<string>(_synonyms).AsReadOnly(); }
    }
} 
```

映射：

```
<class name="Chapter" table="Chapter">
   <set name="Synonyms" table="ChapterSynonyms">
       <key column="ChapterId" />
       <element column="ChapterCode" type="string" />
   </set>
</class> 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-11T15:20:56.430

除非我弄错了，否则你可以这样做：

```
<bag name="Identities" access="property">
  <key column="accountId"/>
  <element column="identity" type="string"/>
</bag> 
```

身份是一个`IList<string>`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T19:45:40.397

您可以使用 IUserType 执行此操作，如下所示：

```
public class DelimitedList : IUserType
{
    private const string delimiter = "|";

    public new bool Equals(object x, object y)
    {
        return object.Equals(x, y);
    }

    public int GetHashCode(object x)
    {
        return x.GetHashCode();
    }

    public object NullSafeGet(IDataReader rs, string[] names, object owner)
    {
        var r = rs[names[0]];
        return r == DBNull.Value 
            ? new List<string>()
            : ((string)r).SplitAndTrim(new [] { delimiter });
    }

    public void NullSafeSet(IDbCommand cmd, object value, int index)
    {
        object paramVal = DBNull.Value;
        if (value != null)
        {
            paramVal = ((IEnumerable<string>)value).Join(delimiter);
        }
        var parameter = (IDataParameter)cmd.Parameters[index];
        parameter.Value = paramVal;
    }

    public object DeepCopy(object value)
    {
        return value;
    }

    public object Replace(object original, object target, object owner)
    {
        return original;
    }

    public object Assemble(object cached, object owner)
    {
        return cached;
    }

    public object Disassemble(object value)
    {
        return value;
    }

    public SqlType[] SqlTypes
    {
        get { return new SqlType[] { new StringSqlType() }; }
    }

    public Type ReturnedType
    {
        get { return typeof(IList<string>); }
    }

    public bool IsMutable
    {
        get { return false; }
    }
} 
```

然后将 IList<string> 属性定义为 type="MyApp.DelimitedList, MyApp"。

注意：SplitAndTrim 是一个字符串扩展，具有我创建的各种覆盖。下面是核心方法：

```
public static IList<string> SplitAndTrim(this string s, StringSplitOptions options, params string[] delimiters)
    {
        if (s == null)
        {
            return null;
        }
        var query = s.Split(delimiters, StringSplitOptions.None).Select(x => x.Trim());
        if (options == StringSplitOptions.RemoveEmptyEntries)
        {
            query = query.Where(x => x.Trim() != string.Empty);
        }
        return query.ToList();
    } 
```

# asp.net - 是否有更好和/或更简单的注销方式？

> ID：606608
> 
> 赞同：0
> 
> 时间：2009-03-03T14:35:40.267
> 
> 标签：asp.net, jquery, vb.net, session

情况如下：

1.  用户通过存储在 MSSQL 数据库中的用户名/密码登录
2.  如果用户已通过身份验证，系统会使用用户名/SHA1 密码创建会话变量，如果用户登录或未登录，则为布尔值（用于后续页面）
3.  我需要能够销毁会话变量。我也想要一个确认框。

这是我到目前为止所拥有的：

```
<script type="text/javascript">
    //<![CDATA[
    function doLogout() {
        try {
            var conf = false;
            conf = confirm("Really log out?");
            if (conf === true) {
                $.post("logout.aspx");
            }
        } catch (ex) {
            alert(ex);
        }
    }
    //]]>
</script> 
```

由于它是一个 ajax 请求，不会重新加载页面（功能正常，请求会破坏会话），我想我需要一种不同的方法来做到这一点。如果可能的话，我真的很希望能够在 ASP.NET 中完成这一切。

欢迎任何解决方案，只要满足上述＃3。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T14:43:30.450

好吧，对于初学者来说，您的解决方案取决于拥有 Javascript 的用户，如果他们不这样做，他们将无法注销。我认为您不应该为此使用 AJAX，只需一个简单的链接/按钮到 logout.aspx 就可以了，然后可以正确地将它们重定向到设置为“注销”状态的主页。然后，您可以使用一些不显眼的 Javascript 来添加确认。

jQuery版本（因为你提到过）：

```
<a href="logout.aspx" id="logout-link">Logout</a>
<script type="text/javascript">
    //<![CDATA[
    $(document).ready(function() {
        $('#logout-link').click(function () {
            return confirm("Really log out?");
        });
    });
    //]]>
</script> 
```

纯Javascript版本：

```
<a href="logout.aspx" id="logout-link">Logout</a>
<script type="text/javascript">
//<![CDATA[
window.onload = function() {
     if(!document.getElementById) return;
     document.getElementById('logout-link').onclick(function() {
         return confirm("Really log out?");
    });
}
//]]>
</script> 
```

# reporting-services - Reporting Services 参数约束

> ID：606621
> 
> 赞同：9
> 
> 时间：2009-03-03T14:38:05.503
> 
> 标签：reporting-services, ssrs-2008

我有一个报告服务 (SQL 2008) 报告，其中包含两个日期/时间参数 - begindate 和 enddate。我需要将 enddate 限制为与 begindate 相同的月份和年份。这似乎应该是一件容易的事，但我无法弄清楚。

目前，我正在检查传递给存储过程的参数，如果两个日期时间参数不在同一月份和年份，则会引发错误。我正在寻找一种更优雅的方式来实现这一点。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-03T15:44:18.137

您可以检查参数表达式中的 EndDate 值，如果不正确，请将其设置为 StartDate + 1 个月。
就像是：

```
= IIF(DateDiff(DateInterval.Month, Parameters!StartDate.Value, Parameters!EndDate.Value) = 0, Parameters!EndDate.Value, AddDate(DateInterval.Month, 1, Parameters!StartDate.Value)) 
```

如果您只想通知用户，您可以放置​​一些具有适当格式（红色大字体）的隐藏文本框和有关日期参数不正确范围的消息。在隐藏的表达式集中

```
= (DateDiff(DateInterval.Month, Parameters!StartDate.Value, Parameters!EndDate.Value) <> 0) 
```

此外，您可以将这两个操作与自定义代码结合起来：

```
Public DateMessage As String

Public Function ValidateDate(StartDate As DateTime, EndDate As DateTime) As DateTime
  Dim ResultDate As DateTime
  If (DateDiff(DateInterval.Month, StartDate, EndDate) <> 0) Then
    ResultDate = AddDate(DateInterval.Month, 1, StartDate)
    DateMessage = String.Format("End Date parameter value {0} 
      was out of range and was changed to {1}", EndDate, ResultDate)
  Else
    ResultDate = EndDate
  End If
End Function 
```

然后，在参数值表达式中：

```
= Code.ValidateDate(Parameters!StartDate.Value, Parameters!EndDate.Value) 
```

在 tbDateParameterMessage 文本框的 Value 属性中：

```
= Code.DateMessage 
```

在 Hidden 属性表达式中：

```
= String.IsNullOrEmpty(Code.DateMessage) 
```

**编辑** 但如果你想停止报告运行，使用这个自定义代码：

```
Public Function CheckDate(SDate as Date, EDate as Date) as Integer
    Dim msg as String
    msg = ""
    If (SDate > EDate)  Then
        msg="Start Date should not be later than End Date"
    End If
    If msg <> "" Then
        MsgBox(msg, 16, "Parameter Validation Error")
        Err.Raise(6,Report) 'Raise an overflow
    End If
End Function 
```

它取自[SQLServerCentral 论坛](http://www.sqlservercentral.com/Forums/Topic537763-145-1.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-05-23T14:14:59.570

很多时候，在 SSRS 报告中使用 Msgbox 功能会出现部署问题。它们在我们的开发机器上运行良好，但在实际部署时可能很难开始工作。以下是一些解释问题的链接：

[来自 MSDN](http://social.msdn.microsoft.com/Forums/en-US/sqlreportingservices/thread/61a85895-b4ee-43f9-b25e-dac8dcb21f7f)

[从 SQLDev](http://www.sqldev.org/sql-server-reporting-services/error-being-thrown-when-using-the-msgbox-function-in-code-block-35896.shtml)

我的解决方案是一个非常简单的实现，报告被停止，但它只是显示一个报告错误，并从报告查看器向用户显示消息。

1.  创建一个新的文本/字符串参数（我称之为 CheckDateRange）
2.  允许空白值并将其隐藏
3.  可用值 = 无
4.  高级 = 使用默认值
5.  默认值 = 指定值 - 在值中，使用功能按钮并使用以下内容： =CODE.CheckDateParameters(Parameters!BeginDate.Value,Parameters!EndDate.Value) - 请注意，您可以看到我检查日期的参数名称是 BeginDate和结束日期
6.  最后，对于报告代码，输入以下代码片段：

    ```
    Function CheckDateParameters(StartDate as Date, EndDate as Date) as Integer
    Dim msg as String
    msg = ""
    If (StartDate > EndDate) Then
      msg="Start Date should not be later than End Date"
      Err.Raise(22000, "VBCore.Utility", msg)
    End If
    End Function 
    ```

没有什么花哨的，但可以满足您的需求。

祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T19:16:10.387

我使用了隐藏文本框的想法，因为它比让报告崩溃要好。我希望完成的是强制用户在报告执行之前预先更改他们的参数。

顺便说一句，语法不起作用。我改用这个：

```
= Month(Parameters!begindate.Value) = Month(Parameters!enddate.Value) and Year(Parameters!begindate.Value) = Year(Parameters!enddate.Value) 
```

感谢coldice的想法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-02T03:45:13.643

```
>     Public Function CheckDate(SDate as Date, EDate as Date) as Integer Dim msg as String
>      msg = ""
>      If (SDate > EDate)  Then msg="Start Date should not be later than End Date"
>      End If
>      If msg <> "" Then MsgBox(msg, 16, "Parameter Validation Error") Err.Raise(6,Report)                    'Raise an overflow
>      End If End Function 
```

除非他们进行了更改，否则 MsgBox() 函数将无法在 SSRS 上运行。它不适用于 SSRS 2010。我相信它是一个 Windows 功能，因此不能在呈现的网页上使用。

# c# - 使用 c# 为 sharepoint 中的 webpart 布局表单

> ID：606626
> 
> 赞同：4
> 
> 时间：2009-03-03T14:39:14.377
> 
> 标签：c#, sharepoint, web-parts

我在 c# 中为 sharepoint 创建了一个 webpart。它基本上是一个带有文本框、文字、验证器和按钮的表单。

我不确定如何渲染此表单以使其看起来很漂亮。布局等完全在这个 c# 类中完成。

目前开始我只是覆盖`CreateChildControls()`方法并使用类似的东西添加每个表单控件：`this.Controls.Add(submitButton);`

关于如何最好地布局此表格的任何想法？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-06T00:22:08.903

创建自定义 Web 部件时，我也更喜欢通过重写**CreateChildControls()**和**Render()**方法来实现它们。在**Render()**方法中，我可以完全控制 html 输出，并且可以通过调用**this.someInnerControl.RenderControl(writer)**来呈现我的内部控件。

完全控制 html 输出还可以轻松地使用 CSS 设置 html 样式。正如其他人建议的那样，使用外部 CSS 文件并将样式应用于html 元素上的*class*属性或ASP.NET Web 控件上的*CssClass属性。*

当我实现不需要特殊品牌的 webpart 时，我更喜欢重用 SharePoint 定义的 CSS 类。这将确保我的 Web 部件在视觉上与 SharePoint 提供的 Web 部件相似，并且我保持一致的外观和感觉。

使用 SharePoint 定义的 CSS 样式时，您应该注意您的 html 输出。一些 CSS 类需要特定的 html 结构才能正确呈现。您始终可以使用浏览器“查看源代码”来检查您尝试模仿的 SharePoint 元素的 html。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T14:45:58.400

我建议从现有的共享点页面获取源代码并使用共享点定义的样式。 [这个 2003 年风格的链接](http://www.sharepointcustomization.com/resources/tipstricks/wss_cssguide.htm)很旧，但仍然是一个很好的入门指南。大多数 CSS 类名没有改变。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T14:49:35.927

在我的 Web 部件中，我在解决方案中包含 css 文件，并使用以下内容将它们注入页面：

```
this.Page.Header.RegisterCss("/_layouts/path/to/css/file.css", false); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T15:36:00.200

您可以覆盖 RenderContents(...) 方法以手动呈现 HTML 以任何您想要的方式。这包括添加您想要/使用的任何 css 包含、脚本包含等。

您可以将子控件呈现为字符串，然后也将它们输出，但您可能不应该调用 base.RenderContents(...) 方法。

只要确保你不要忘记渲染你的子控件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-03T16:52:50.967

如果在设计时看到对您很重要，请使用将用户控件嵌入到 Web 部件中的[SmartPart 。](http://www.codeplex.com/smartpart)（如果您不知道，可以使用 Visual Studio 中的工具设计用户控件。）

如果您更喜欢手动编码，那么您就在正确的轨道上。[只需在CreateChildControls()](http://msdn.microsoft.com/en-us/library/system.web.ui.control.createchildcontrols.aspx)方法中为您的控件创建和设置初始属性，然后像以前一样使用[this.Controls.Add()](http://msdn.microsoft.com/en-us/library/system.web.ui.controlcollection.add.aspx)。

在这两种情况下，尽可能使用 CssClass 属性，这样您就可以修改 CSS 文件的外观，而无需重新编译。您*可以*对 CSS 类名称进行硬编码，但最好使用 Web 部件属性或外部配置源来存储这些名称。在您的母版页中引用 CSS 文件，或使用此答案中提到的其他技术将其注入页面。

MSDN 文章[Windows SharePoint Services 中的 Web 部件](http://msdn.microsoft.com/en-us/library/ms476318.aspx)或[创建基本 Web 部件](http://msdn.microsoft.com/en-us/library/ms415817.aspx)也可能有所帮助。

# php - PHP中删除重音符号和其他字符的函数问题

> ID：606631
> 
> 赞同：1
> 
> 时间：2009-03-03T14:40:43.017
> 
> 标签：php, string, unicode, utf-8

我找到了一个简单的函数来从字符串中删除一些不需要的字符。

```
function strClean($input){

$input = strtolower($input);
$b = array("á","é","í","ó","ú", "ñ", " "); //etc...
$c = array("a","e","i","o","u","n", "-"); //etc...

$input = str_replace($b, $c, $input);

return $input;
} 
```

当我在重音符号或其他字符上使用它时，例如“á é ñ í”这个词，它会打印出那些问号或奇怪的字符，例如： [输出 http://img217.imageshack.us/img217/6794/59472278.jpg](http://img217.imageshack.us/img217/6794/59472278.jpg)

注意：我使用的是 UTF-8 格式的 strclean.php（包含此函数）和 index.php。index.php 如下所示：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title></title>
</head>
<body>
    <?php
    include('strclean.php');

    echo 'óóóáà';
    echo strClean('óóóáà');

    ?>
</body>
</html> 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-03T15:12:25.717

采用

```
iconv('UTF-8', 'ASCII//TRANSLIT', $input); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-03T14:49:56.270

您可能想尝试[iconv](http://uk.php.net/manual/en/function.iconv.php)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-03T14:48:06.930

是否发生了替换，即当您预先打印 $input 时，您是否得到相同的怪异字符？如果是这样，您的 PHP 源代码文件和输入的字符集不匹配，您可能需要在替换之前对输入使用 iconv()。

**编辑：**我拿走了你的两个文件，将它们上传到我的网络服务器，打印和清理工作正常（见[http://www.tag-am-meer.com/test1/](http://www.tag-am-meer.com/test1/)）。这是在 PHP 4.4.9 和 Firefox 3.0.6 上。我想到的更多潜在问题：

*   它在 Firefox 上对你有用吗？我模糊地记得 IE6（可能还有更高版本）期望 HTML 头部部分中的字符集以小写字母（“utf-8”）编写
*   您的编辑器是否在代码文件中包含字节顺序标记 (BOM)？我的没有，也许 PHP 扼杀了那些。
*   您能否查看 HTTP 标头以查看是否发生了异常情况，例如错误的 MIME 类型？Firefox的**Tamper Data**插件可以帮助解决这个问题。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-03T19:09:01.670

我已经测试了你的代码，并且错误在 strtolower 函数中......

将其替换为 mb_strtolower，如下所示

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title></title>
</head>
<body>

<?php
    function strClean($input) {
        $input = mb_strtolower($input, 'UTF-8');
        $b = array("á","é","í","ó","ú", "n", " ");
        $c = array("a","e","i","o","u","n", "-");
        return str_replace($b, $c, $input);
    }

    $string = 'á é í ó ú n abcdef ghij';
    echo $string ."<br />". strClean($string);
?>

</body>
</html> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-03-05T11:26:45.420

为什么要删除重音符号？您是否可能只想忽略它们？如果是这样，[这个答案](https://stackoverflow.com/questions/5157141/how-do-you-match-accented-and-tilde-characters-in-a-perl-regular-expression-rege/5163247#5163247)有一个 Perl 解决方案来演示如何做到这一点。请注意，Perl 是一种外语。:)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-04-09T17:14:17.773

我之前发现自己遇到了这个麻烦，我试图按照这篇文章的线索和我在路上找到的其他人，没有简单的解决方案，因为你必须知道你的系统使用的字符集（在我的例子中是 ISO-8859 -1）这就是我所做的：

```
 function quit_accenture($str){
      $pattern = array();
      $pattern[0] = '/[Á|Â|À|Å|Ä]/';
      $pattern[1] = '/[É|Ê|È]/';
      $pattern[2] = '/[Í|Î|Ì|Ï]/';
      $pattern[3] = '/[Ó|Ô|Ò|Ö]/';
      $pattern[4] = '/[Ú|Û|Ù|Ü]/';
      $pattern[5] = '/[á|â|à|å|ä]/';
      $pattern[6] = '/[ð|é|ê|è|ë]/';
      $pattern[7] = '/[í|î|ì|ï]/';
      $pattern[8] = '/[ó|ô|ò|ø|õ|ö]/';
      $pattern[9] = '/[ú|û|ù|ü]/';
      $replacement = array();
      $replacement[0] = 'A';
      $replacement[1] = 'E';
      $replacement[2] = 'I';
      $replacement[3] = 'O';
      $replacement[4] = 'U';
      $replacement[5] = 'a';
      $replacement[6] = 'e';
      $replacement[7] = 'i';
      $replacement[8] = 'o';
      $replacement[9] = 'u';
      return preg_replace($pattern, $replacement, $str);
    }
    $txt = $_POST['your_htmled_text'];
    //Convert to your system's charset. I checked this on the php.ini
    $txt = iconv('UTF-8', 'ISO-8859-1//TRANSLIT', $txt);
    //Apply your function
    $txt = quit_accenture($txt);
    //output
    print_r($txt); 
```

这对我有用，但我也认为是正确的方法:)

# c# - 处理 KeyNotFoundException 的最佳方法

> ID：606636
> 
> 赞同：72
> 
> 时间：2009-03-03T14:41:38.177
> 
> 标签：c#, exception, keynotfoundexception

我正在使用字典来查找我正在处理的程序。我通过字典运行了一堆键，我希望一些键没有值。我抓住[`KeyNotFoundException`](http://msdn.microsoft.com/en-us/library/system.collections.generic.keynotfoundexception.aspx)它发生的地方，并吸收它。所有其他异常将传播到顶部。这是处理这个问题的最好方法吗？或者我应该使用不同的查找？字典使用一个 int 作为它的键，一个自定义类作为它的值。

* * *

## 回答 #1

> 赞同：139
> 
> 时间：2009-03-03T14:42:52.480

改用[`Dictionary.TryGetValue`](http://msdn.microsoft.com/en-us/library/bb347013.aspx)：

```
Dictionary<int,string> dictionary = new Dictionary<int,string>();
int key = 0;
dictionary[key] = "Yes";

string value;
if (dictionary.TryGetValue(key, out value))
{
    Console.WriteLine("Fetched value: {0}", value);
}
else
{
    Console.WriteLine("No such key: {0}", key);
} 
```

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2009-03-03T14:42:44.257

尝试使用：Dict.ContainsKey

编辑：
性能方面，我认为`Dictionary.TryGetValue`正如其他一些建议的那样更好，但我不喜欢在不需要时使用 Out，所以我认为 ContainsKey 更具可读性，但如果您还需要该值，则需要更多代码行。

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2014-08-04T21:10:31.957

使用的一条线解决方案`TryGetValue`

```
string value = dictionary.TryGetValue(key, out value) ? value : "No key!"; 
```

请注意，**value**变量必须是字典在这种情况下返回的类型**string**。这里不能使用**var**进行变量声明。

如果您使用的是 C# 7，在这种情况下，您可以**包含**var 并内联定义它：

```
string value = dictionary.TryGetValue(key, out var tmp) ? tmp : "No key!"; 
```

这也是一个很好的扩展方法，它将完全按照您想要实现的 dict.GetOrDefault("Key") 或 dict.GetOrDefault("Key", "No value")

```
public static TValue GetOrDefault<TKey, TValue>(this Dictionary<TKey, TValue> dictionary, TKey key, TValue defaultValue = default(TValue))
{
      if (dictionary != null && dictionary.ContainsKey(key))
      {
           return dictionary[key];
      }
      return defaultValue;
 } 
```

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2013-07-02T22:50:30.960

这是一个单行解决方案（请记住，这会进行两次查找。请参阅下面的 tryGetValue 版本，它应该在长时间运行的循环中使用。）

```
string value = dictionary.ContainsKey(key) ? dictionary[key] : "default"; 
```

然而，我发现自己每次访问字典时都必须这样做。我希望它返回 null 所以我可以写：

```
string value = dictionary[key] ?? "default";//this doesn't work 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-03-03T14:44:47.327

您应该使用 Dictionary 的 'ContainsKey(string key)' 方法来检查键是否存在。对正常程序流使用异常不被认为是一种好的做法。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2019-02-13T20:53:13.333

我知道这是一个旧线程，但如果它有帮助，那么之前的答案很好，但是可以解决复杂性的评论和乱扔代码的担忧（所有这些对我也有效）。

我使用自定义扩展方法以更优雅的形式将上述答案的复杂性包装起来，这样它就不会在整个代码中乱七八糟，然后它可以很好地支持 null coalesce operator 。. . 同时也最大化性能（通过上面的答案）。

```
namespace System.Collections.Generic.CustomExtensions
{
    public static class DictionaryCustomExtensions
    {
        public static TValue GetValueSafely<TKey, TValue>(this IDictionary<TKey, TValue> dictionary, TKey key)
        {
            TValue value = default(TValue);
            dictionary.TryGetValue(key, out value);
            return value;
        }
    }
} 
```

然后你可以通过导入命名空间*System.Collections.Generic.CustomExtensions来使用它*

```
string value = dictionary.GetValueSafely(key) ?? "default"; 
```

# c# - C# 中的“跨线程操作错误”需要帮助

> ID：606642
> 
> 赞同：1
> 
> 时间：2009-03-03T14:43:25.083
> 
> 标签：c#, .net, multithreading, debugging

以下代码`MessageReceived`位于不同的线程上`label1`，当尝试访问它时，我会收到此错误：

> 跨线程操作无效：控件“label1”从创建它的线程以外的线程访问。

```
foo.MessageReceived += new Agent.MessageReceivedHandler(foo_MessageReceived); 

void foo_MessageReceived(Message message)
{
   label1.Text = message.Body;
} 
```

**我该如何解决这个问题？**

**更多**：显然我需要使用`delegate`and `invoke`，但我不知道怎么做，你能更详细地解释一下吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-03T14:53:46.760

希望这将作为一个完全相同的副本关闭，但如果不是：

不要从非 GUI 线程触摸 GUI。使用 BackgroundWorker 并适当地报告进度，或者阅读[我的线程文章的 WinForms 页面以](http://pobox.com/~skeet/csharp/threads/winforms.shtml)获得更直接的控制 (Control.Invoke/BeginInvoke)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T14:46:05.793

将更新标签委托给创建标签的线程，而不是尝试直接更新它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T15:10:04.100

您需要使用 Control.Invoke（或 Control.BeginInvoke）。首先，创建一个新的 Windows 窗体应用程序并添加一个标签和一个按钮。双击 Visual Studio 中的按钮以编辑其 Click 事件并添加以下代码：

```
 private void button1_Click(object sender, EventArgs e)
    {
        new System.Threading.Thread(new System.Threading.ThreadStart(Run)).Start();
    }

    void Run()
    {
        label1.Invoke(new Action(delegate()
        {
            label1.Text = System.Threading.Thread.CurrentThread.Name + " " + System.DateTime.Now.ToString();
        }));
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T14:45:42.253

这完全没有帮助。我希望我能投票给自己。

我可能已经过时了，但据我所知，除了主线程之外，不允许您更改 GUI 中的任何内容。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-03T14:57:18.123

在您的代理类中，当您引发 MessageReceived 事件时，您必须检查事件处理程序的目标是否实现 ISynchronizeInvoke。如果是这样，并且 InvokeRequired 属性返回 true，则您必须调用事件处理程序。

如果您使用的不是 WinForms，而是 WPF，则不能再依赖 ISynchronizeInvoke，因为 WPF 控件不实现该接口。相反，您必须使用 AsyncOperation 和 AsyncOperatoinManager。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-03T19:09:19.780

始终确保在主线程（GUI 线程）上更新您的 GUI。

foo.MessageReceived += new Agent.MessageReceivedHandler(foo_MessageReceived);

```
public delegate void MyDelegate(Message msg);
void foo_MessageReceived(Message message)
{ 
   if (InvokeRequired)
   {
      BeginInvoke(new MyDelegate(foo_MessageReceived),new object[]{message});
   }
   else
   {
      label1.Text = message.Body;
   }
} 
```

# c# - 在 C# 中使用枚举作为数据层对象的“状态”

> ID：606649
> 
> 赞同：2
> 
> 时间：2009-03-03T14:44:56.047
> 
> 标签：c#, .net, sql-server, enums

我有一个数据对象（假设它称为“条目”），它具有一组看起来像这样的潜在状态：

```
1 - 创建
2 - 添加文件
3 - 批准
4 - 无效
```

这在数据库中表示为带有自动编号主键的“状态”表，然后是主表中的“状态 ID”字段，并设置了适当的关系。

在我的（自定义）数据层中，我有“Entry”对象，目前，我还声明了一个具有上面列出的指定状态的 Enum。最后，我声明了这个 Enum 的私有实例以及相应的公共属性。

在我的“Commit()”方法中，我将 Enum 的实例转换为整数并将其传递给 Update 存储过程。

在我的静态“GetEntry()”方法中，我显然会从数据库传回一个整数。然后我使用“Enum.Parse()”方法提取一个对象，该对象是我的 Enum 的一个实例，它对应于返回的状态整数。我将其转换为我的 Enum 类型并将其分配给本地私有变量。

我的问题很简单——这种方法是否合适，如果不是，除了存储原始整数值（我不一定反对）之外，还有什么替代方法更好。

我问的原因是这一切对我来说似乎非常混乱，所有的铸造和维护两个相同值集的列表是什么。我接受好处在于为数据对象的消费者提供更好的体验，但即便如此......

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T15:01:44.463

在我们的一个项目中，我们有一些熟悉的东西。我们有一个包含项目类型的表。这些类型有一个 id，在代码中我们有一个具有相同 id 的枚举。问题是，在数据库中我们不使用自动编号（身份），因此我们可以完全控制 id。当保存我们的对象时，我们只需要枚举的 id 来保存对象。我也认为这种方法很混乱，但毕竟还不错。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T14:59:05.140

这种方法对我来说似乎很好。

在过去，我做过同样的事情，但也有一个表，其中包含枚举的每个成员的一行，然后该表是使用枚举值的任何表的外键，这样读取数据库的人就可以理解什么每个状态都无需查看实际枚举。

例如，如果我有一个像

```
enum status
{
    Active,
    Deleted,
    Inactive
} 
```

我会有一个名为 status 的表，其中包含以下记录

ID 名称
0 有效
1 已删除
2 无效

然后，该表将成为使用该枚举的任何表的外键。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-09-02T02:37:15.590

是的，这很好！

请始终明确设置这样的值。这样，如果有人去添加一些东西，他们就会意识到这些值很重要，不应该被弄乱。

```
enum status
{
    Active = 1,
    Deleted = 2,
    Inactive = 3
} 
```

如果您通过 WCF 传递值，我建议您添加

```
 NULL = 0 
```

否则，如果您尝试序列化来自数据库的 0，您将得到一个可怕的错误，并且您将永远进行调试。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T15:00:27.803

数据库查找表是必要的；编程枚举便于避免代码中出现“幻数”

但是，如果您的代码不需要操纵状态，则不需要枚举

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-03T15:01:18.877

我一直用 Enums 做这种方法。如果它是一个简单的项目，比如预计不会改变的状态，我更喜欢枚举。解析和转换是一个非常低影响的操作。

我已经用 Linq to Sql 成功地做到了一段时间，没有任何问题。Linq 实际上会自动从 Enum 转换为 int 并返回。

代码不仅仅是速度，还有可读性。枚举使代码可读。

要直接回答您的问题，这是一个非常有效的方法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-03T15:26:39.630

如果您的代码需要设置已知的“状态”值（您已在枚举中定义），那么可能还需要数据库中存在这些“状态”值。由于它们必须存在，因此您还应该控制分配给每个值的 Status_ID。

删除身份并明确设置查找值 ID。

# c# - 如何在一个项目中创建不同的 DLL？

> ID：606652
> 
> 赞同：3
> 
> 时间：2009-03-03T14:45:41.723
> 
> 标签：c#, visual-studio, c-preprocessor, visual-studio-2005, assemblies

有个问题不知道能不能解决。我在 Visual Studio 2005 上有一个 C# 项目，我想根据预处理器常量创建不同的 DLL 名称。我现在拥有的是预处理器常量、两个 snk 文件和两个程序集的 guid。我还创建了两个配置（调试和调试预处理器），它们使用适当的 snk 和 guid 完美编译。

```
#if PREPROCESSOR_CONSTANT
[assembly: AssemblyTitle("MyLibraryConstant")]
[assembly: AssemblyProduct("MyLibraryConstant")]
#else
[assembly: AssemblyTitle("MyLibrary")]
[assembly: AssemblyProduct("MyLibrary")]
#endif 
```

现在，我必须将这两个程序集放入 GAC。添加第一个程序集没有问题，但第二个程序集没有。

如何从一个 Visual Studio 项目创建两个或多个不同的程序集？

我可能忘记在“AssemblyInfo.cs”中添加一个新行来根据预处理器常量更改 DLL 名称？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-03T15:07:31.267

这是一个示例 Post-Build 事件：

```
if "$(ConfigurationName)" == "Debug" goto Debug
if "$(ConfigurationName)" == "Release" goto Release

goto End

:Debug
del "$(TargetDir)DebugOutput.dll"
rename "$(TargetPath)" "DebugOutput.dll"

:Release
del "$(TargetDir)ReleaseOutput.dll"
rename "$(TargetPath)" "ReleaseOutput.dll"

:End 
```

更改`DebugOutput.dll`和`ReleaseOutput.dll`到正确的文件名。您可以更改`"Debug"`并`"Release"`支持其他配置，并添加部分以支持更多配置。

* * *

该脚本将创建两个具有不同文件名的 dll；要创建两个不同的 AssemblyName，您有两个选择。

程序集名称构建[如下](http://msdn.microsoft.com/en-us/library/system.reflection.assemblyname.aspx)：

```
Name <,Culture = CultureInfo> <,Version = Major.Minor.Build.Revision> <, StrongName> <,PublicKeyToken> '\0' 
```

因此，您必须更改文化信息、版本或强名称。

两个最简单的选择是：

1.  更改程序集版本：

    ```
    #if SOME_COMPILER_SYMBOL
    [assembly: AssemblyVersion("1.0.0.0")]
    #else
    [assembly: AssemblyVersion("1.0.0.1")]
    #endif 
    ```

2.  更改密钥文件 - 使用该`sn`工具创建两个密钥文件，然后在`AssemblyInfo.cs`：

    ```
    #if SOME_COMPILER_SYMBOL
    [assembly: AssemblyKeyFile("FirstKey.snk")]
    #else
    [assembly: AssemblyKeyFile("SecondKey.snk")]
    #endif 
    ```

据 GAC 所知，这两个选项都会导致两个不同的程序集 - 因为它比较的是完整的程序集名称，而不是“简单”名称。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-03T14:55:30.670

Visual Studio 不允许按配置输出文件名。但是，您可以将输出文件重命名为构建脚本的一部分。您可以在您的 MSBuild 脚本中为相关的特定项目执行此操作。

例如，将其放在*.csproj*文件的末尾：

```
<Target Name="AfterBuild">
    <Copy SourceFiles="$(OutputPath)\YourAssembly.dll" DestinationFiles="$(OutputPath)\YourAssemblyRenamed.dll"/>
    <Delete Files="$(OutputPath)\YourAssembly.dll"/>
</Target> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T15:22:45.287

我自己没有尝试过，所以把它当作一个友好的建议。尝试手动编辑您的 .csproj 添加或取消注释 BeforeBuild 目标，其中的灵感来自以下内容：

```
<Target Name="BeforeBuild">
    <AssemblyName Condition="'$(Configuration)' == 'Release'">MyReleaseName</AssemblyName>
    <AssemblyName Condition="'$(Configuration)' == 'Debug'">MyDebugName</AssemblyName>
</Target> 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-03-03T14:48:41.420

我认为没有这样的方法。输出程序集名称严格固定在项目设置中：每个项目一个程序集。

此外，您给出的 AssemblyAttributes 仅指示可见的程序集属性（例如在 Windows 资源管理器中），而不是文件名。

# javascript - 在 Google 地图上放置街景按钮

> ID：606659
> 
> 赞同：10
> 
> 时间：2009-03-03T14:47:55.493
> 
> 标签：javascript, google-maps

如何将街景按钮放在相当典型的谷歌地图上，使其与右上角的标准地图/卫星/混合按钮内联？我已经看到了一个我再也找不到的例子。所以，我知道这是可能的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-08-06T11:35:37.197

是的，确实可以在地图的选项中指定控制位置——在[在线文档中查找](https://developers.google.com/maps/documentation/javascript/controls)*控制位置*。

## 如何指定谷歌地图控件位置

将街景控件定位在右上角添加

```
 streetViewControlOptions: {
    position: google.maps.ControlPosition.TOP_RIGHT
  } 
```

到您的地图选项。

检查此演示（使用 Google 地图 API 版本 3）：

```
var myLatlng = new google.maps.LatLng(-33, 151);
var myOptions = {
  center: myLatlng,
  zoom: 5,
  streetViewControl: true,
  streetViewControlOptions: {
    position: google.maps.ControlPosition.TOP_RIGHT
  }
};
var map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);
```

```
#map_canvas {
  width: 300px;
  height: 200px;
}
```

```
<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?sensor=false"></script>
<div id="map_canvas"></div>
```

这是官方文档中[另一个控制定位的例子。](https://developers.google.com/maps/documentation/javascript/examples/control-positioning)

### 控制放置标识符

这些是谷歌地图控件的所有可能位置（从`TOP_LEFT`到`BOTTOM_RIGHT`）：

```
 +----------------+ 
  + TL    TC    TR + 
  + LT          RT + 
  +                + 
  + LC          RC + 
  +                + 
  + LB          RB + 
  + BL    BC    BR + 
  +----------------+ 
```

有关职位的完整列表及其工作方式，请参阅[https://developers.google.com/maps/documentation/javascript/3.exp/reference#ControlPosition](https://developers.google.com/maps/documentation/javascript/3.exp/reference#ControlPosition)

## 以编程方式更改控制位置

您还可以使用[类](https://developers.google.com/maps/documentation/javascript/3.exp/reference#Map)`SetOptions`的方法在创建地图后动态更改位置。在这个例子中，我创建了一个上面的地图，然后将其更改为：[`google.maps.Map`](https://developers.google.com/maps/documentation/javascript/3.exp/reference#Map)`streetViewControl``TOP_RIGHT``LEFT_BOTTOM`

```
var myLatlng = new google.maps.LatLng(-33, 151);
var myOptions = {
  center: myLatlng,
  zoom: 5,
  streetViewControl: true,
  streetViewControlOptions: {
    position: google.maps.ControlPosition.TOP_RIGHT
  }
};
var map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);

// now change position to LEFT_BOTTOM changing streetViewControlOptions
// with setOptions
map.setOptions({
  streetViewControlOptions: {
    position: google.maps.ControlPosition.LEFT_BOTTOM
  }
});
```

```
#map_canvas {
  width: 300px;
  height: 200px;
}
```

```
<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?sensor=false"></script>
<div id="map_canvas"></div>
```

# visual-studio-2005 - Msbuild 是否识别除 DEBUG|RELEASE 之外的任何构建配置

> ID：606660
> 
> 赞同：21
> 
> 时间：2009-03-03T14:47:58.537
> 
> 标签：visual-studio-2005, msbuild

我通过 Visual Studio 创建了一个名为 Test 的配置，它目前只接受所有的 DEBUG 设置，但是如果构建恰好是 TEST|DEBUG|RELEASE，我会使用编译器条件来确定一些特定的操作。

但是如何让我的 MSBUILD 脚本检测 TEST 配置？

目前我建立

```
 <MSBuild Projects="@(SolutionsToBuild)" Properties="Configuration=$(Configuration);OutDir=$(BuildDir)\Builds\" /> 
```

@(SolutionsToBuild) 是我的解决方案。在[Common MsBuild Project Properties](http://msdn.microsoft.com/en-us/library/bb629394.aspx)中，它指出 $(Configuration) 是一个公共属性，但它总是显示为空白？

这是否意味着它永远不会被设置，而只是保留给我使用，或者它只能检测 DEBUG|RELEASE。如果是这样，允许创建不同的构建配置有什么意义？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-03-03T14:50:49.247

我在定义 MSBUILD 配置文件方面做得不多，但我已经使用这样的批处理文件构建了不同的配置

```
msbuild /v:n /p:Configuration=Release "Capture.sln" 
msbuild /v:n /p:Configuration=ReleaseNoUploads "Capture.sln" 
```

我在 Visual Studio 中定义了**ReleaseNoUploads配置。**

这是我必须做的（这是 Visual Studio 2005）：

*   打开*Tools:Options*菜单，转到*Projects and Solutions:General*选项，然后选中**Show advanced build configurations**。
*   从那里，转到*Build:Configuration* Manager 菜单
*   在弹出的对话框中，单击*Active solution configuration*下拉菜单并单击**<New...>**以创建新的构建配置。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-03T14:50:55.267

当然，您可以根据需要定义任意数量的自定义构建配置。有关设置的外观，请参阅此相关问题。

[如何根据构建配置有条件地部署 app.config？](https://stackoverflow.com/questions/350377/deploy-an-app-config-based-on-build-configuration)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-03T15:01:06.727

请注意，当“在 Visual Studio 内部”时，$(Configuration) 和 $(Platform) 始终由 VS 使用顶部下拉列表中的配置管理器内容进行设置。然而，如果您想从命令行使用 msbuild 设置这些值，则必须显式传入这些值（如@MarkBiek 的回答）。

（大多数 VS 项目模板将“默认”配置/平台的值，这样您就可以使用命令行 MSBuild 而无需明确指定这些值。这很好，但会使这两个有用/常见的属性看起来更神奇/比实际情况更奇怪。）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-01-02T16:52:37.587

通常，我从单个 MSBuild 脚本构建 Release 和 Debug 的方法是：

```
<PropertyGroup Condition="'$(Configuration)'==''">
  <Configuration>Debug;Release</Configuration>
</PropertyGroup> 
```

然后添加这个但 MSBuild 秘方：

```
 <Target Name="configurations">
     <CreateItem Include="$(Configuration)">
       <Output TaskParameter="Include" ItemName="Configuration" />
     </CreateItem>
   </Target> 
```

然后为每个目标做这样的事情：

```
 <Target Name="Compile" DependsOnTargets="configurations" Inputs="@(Configuration)" Outputs="target\%(Configuration.FileName)">
    <MSBuild Projects="@(MyProjects)" Targets="Build" Properties="Configuration=%(Configuration.Identity);WarningLevel=1" />
  </Target> 
```

# javascript - 用于谷歌地图或实时地图的 JavaScript 库

> ID：606672
> 
> 赞同：-1
> 
> 时间：2009-03-03T14:50:34.147
> 
> 标签：javascript, google-maps, virtual-earth

任何人都可以推荐一个好的 javascript 库来使用 Google Maps 或 Live Maps（virtualearth）吗？

jQuery og Prototype 需要考虑吗？

我想我记得 asp.net ajax 有一些控件和钩子用于在当天使用虚拟地球，但似乎再也找不到它了。

干杯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T15:00:04.543

jQuery 和 Prototype 是“通用”的 JS 框架（没有更好的词了），主要用于操作 DOM/处理事件等。您需要 Map API 之一：

*   [谷歌地图 API](http://code.google.com/apis/maps/)
*   [雅虎地图 JS API](http://developer.yahoo.com/maps/ajax/)
*   [虚拟地球 SDK](http://msdn.microsoft.com/en-us/library/aa905677.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T15:01:06.273

我使用过 jQuery 和 Prototype。它们都有起起落落，但是我最近从 Prototype 切换到 jQuery 并且真的很享受它。

这是[Google jQuery](http://code.google.com/p/jmaps/)插件的链接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T15:01:16.757

Google 自己的[Javascript 客户端库](http://code.google.com/apis/gdata/client-js.html)可用于与各种 google 服务进行交互，包括地图。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T16:08:27.390

我可以发誓这已经可用了。好像还不行 不过，Dojo 工具包可能是第一个实现它的工具。[在这里](http://dojotoolkit.org/forum/dojox-dojox/dojox-development-discussion/call-geo-features)寻找发展。

# tokyo-cabinet - 东京内阁 - 达到 100 万后插入速度较慢

> ID：606673
> 
> 赞同：5
> 
> 时间：2009-03-03T14:50:41.913
> 
> 标签：tokyo-cabinet

我正在评估东京内阁表引擎。在达到 100 万条记录后，插入速度会显着降低。批量大小为 100,000，并在事务中完成。我尝试设置 xmsiz 但仍然没有用。东京内阁有人遇到过这个问题吗？

**细节**

> Tokyo cabinet - 1.4.3
> Perl 绑定 - 1.23
> 操作系统：Ubuntu 7.10（Windows XP 之上的 VMWare Player）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-12-11T00:27:31.143

我也碰到了每个分片大约 100 万条记录的砖墙（在客户端进行分片，没什么特别的）。我尝试了各种 ttserver 选项，它们似乎没有任何区别，所以我查看了内核端，发现

`echo 80 > /proc/sys/vm/dirty_ratio`

（之前的值为 10）有很大的改进 - 以下是每分钟打印的数据的总大小（在 8 个分片上，每个分片在自己的节点上）：

```
总计：14238792 条记录，27.5881 GB 大小
总计：14263546 条记录，27.6415 GB 大小
总计：14288997 条记录，27.6824 GB 大小
总计：14309739 条记录，27.7144 GB 大小
总计：14323563 条记录，27.7438 GB 大小
（这里我更改了所有分片的dirty_ratio 设置）
总计：14394007 条记录，27.8996 GB 大小
总计：14486489 条记录，28.0758 GB 大小
总计：14571409 条记录，28.2898 GB 大小
总计：14663636 条记录，28.4929 GB 大小
总计：14802109 条记录，28.7366 GB 大小

```

所以你可以看到提高了 7-8 倍。那时每个节点的数据库大小约为 4.5GB（包括索引），并且节点有 8GB RAM（因此，dirty_ratio 为 10 意味着内核试图保持少于 800MB 的脏数据）。

接下来我要尝试的是 ext2（当前：ext3）和 noatime，并将所有内容保存在 ramdisk 上（这可能会浪费两倍的内存，但可能值得）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-04T06:53:21.727

我只是设置了缓存选项，它现在明显更快。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-29T14:08:35.830

我认为修改 dbtune 函数中的 bnum 参数也会显着提高速度。

# java - 数据集中的行数问题

> ID：606675
> 
> 赞同：0
> 
> 时间：2009-03-03T14:50:54.800
> 
> 标签：java, eclipse, reporting, report, birt

我的新问题如下：对数据库 (DB2) 的 SQL 查询返回 1500 行，但 BIRT 在数据集编辑器中只显示了 500 行。为了计算它们，我使用了具有以下逻辑的计算列（整数）：

```
Total.count(row["VPK"]) 
```

我正在使用 RCP-Designer (BIRT 2.1.3)。我怎样才能得到其他行呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-03-08T03:33:57.473

在 RCP-Designer 预览选项卡中它只显示前 500 行。我认为主要是为了性能。在 Eclipse 3.5 (Ganymeade) 中，您可以转到 Preferences->Report Design->Preview->Data 并更改那里输出的行数。

或者您可以尝试以 html 或 web-viewer 启动，这可能不会达到 500 行的限制。

一旦你在正确的运行时运行它，它不会将行限制为 500。

# web - Web 可访问性和 h1-h6 标题 - 所有内容都必须在这些标签下吗？

> ID：606678
> 
> 赞同：3
> 
> 时间：2009-03-03T14:52:34.873
> 
> 标签：web, accessibility, w3c, wcag

在我们的 Web 应用程序的许多页面的顶部，我们有错误消息和通知、“保存”和其他按钮，**然后**是带有内容标题的 h1 标签。在使 Web 应用程序可访问时，是否可以像我们在这里所做的那样在顶级结构标签之上放置内容？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-03T15:29:02.227

作为屏幕阅读器用户，我不喜欢主标题上方的内容。通常我按标题导航，所以会错过错误消息。更好的解决方案是在错误消息上方输出一个 h1 标题，然后将其余标题保持原样，为您提供两个 h1 标题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T14:56:09.997

是的（你可以在它们上面放东西）。H 仅表示标题。我猜这是标题与什么相关的问题。

我唯一需要注意的是，H2 不应该真的高于 H1，H3 也不应该高于 H2。但我不认为这是一个实际的规则。网站有菜单、警告、通知。将它们放在您的其他内容之上是可以接受的。只要您的内容按逻辑排序，我看不出它会如何影响可访问性。看看页面 CSS 关闭了。看起来合乎逻辑吗？这是可访问性最重要的部分。

尽管有些人确实加倍努力，将菜单作为标记中的最后一项，并使用 CSS 将其带回顶部。就个人而言，我发现该解决方案适得其反。菜单仍然很重要，它属于页面顶部。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T15:11:18.650

是的，只要考虑用户将获得信息的顺序。因此，如果您只是进行了一项操作，那么首先获取与其相关的任何消息听起来是个好主意。如果它是出现在与您正在做的事情无关的任何页面上的通知，我不会把它放在上面，因为它可能有点奇怪。您也可以使用不使用样式的文本浏览器，它应该看起来像带有适当标题的文档。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T16:00:45.990

标题标签用于指示其下方内容的层次结构。您应该只有一个 h1 标签，并且它应该是出现在您的页面上的第一个内容（这通常是网站的名称）。此外，在深入了解不同的内容层时，您不应跳过标题标签。

在您的情况下，您仍然可以使用 CSS 将项目定位在 h1 标记上方，只要它在 html 中的顺序正确。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-04T14:27:50.830

我假设标题上方的元素被 JavaScript 使用。在这种情况下，它们最好由 JavaScript 创建，而不是包含在页面源中。

回到您最初的问题，最好将它们放在页面的底部。但是，如果使用 CSS "display: none;" 隐藏它们 或“可见性：隐藏；” 属性，那么它们将不会被大多数（也许是全部？）屏幕阅读器或许多其他辅助技术看到，因此不应该成为问题。我已经写了一个相当详细[的解释，为什么无障碍技术会忽略这些元素](http://www.nickfitz.co.uk/2007/02/14/why-left-9999px-is-better-for-accessibility-than-display-none/)。

当然，如果有人禁用 CSS，事情看起来会很混乱。如果页面上的内容即使在禁用 CSS 和/或 JavaScript 的情况下也可以使用，那么将这些元素放在页面底部至少会使事情变得不那么混乱。

# python - 我可以使用 VS2005 为使用 VS2003 构建的 Python 系统构建扩展吗

> ID：606680
> 
> 赞同：3
> 
> 时间：2009-03-03T14:53:15.730
> 
> 标签：python, visual-studio-2005, visual-studio-2003, distutils

[RDFLib](http://rdflib.net/)需要编译 C 扩展才能安装在 ActiveState Python 2.5 上；据我所知，网络上没有明显的二进制安装程序。在尝试使用 安装时`python setup.py install`，它会产生以下消息：

`error: Python was built with Visual Studio 2003;`
`extensions must be built with a compiler than can generate compatible binaries.`
`Visual Studio 2003 was not found on this system. If you have Cygwin installed,`
`you can try compiling with MingW32, by passing "-c mingw32" to setup.py.`

网上有[各种关于为讨论使用 MinGW 的 distutils 配置编译器的](http://boodebr.org/main/python/build-windows-extensions) [资源](http://isegserv.itd.rl.ac.uk/blogs/alistair/)，尽管我还没有让它工作。作为替代方案，我有 VS2005。

谁能明确地告诉我您是否可以使用 VS2005 中的 C 编译器为 VS2003 编译的 Python（在本例中为 ActiveState Python 2.5）构建 Python 扩展模块。如果可以，需要什么配置？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-29T13:03:25.763

主要问题是 C 运行时库。Python 2.4/2.5 链接到 msvcr71.dll，因此所有 C 扩展都应该链接到这个 dll。

另一种选择是使用 gcc (mingw) 而不是 VS2005，您只能使用它来编译 python 扩展。有一个不错的安装程序，允许您将 gcc 配置为 Python 版本的默认编译器：

[http://www.develer.com/oss/GccWinBinaries](http://www.develer.com/oss/GccWinBinaries)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T15:35:15.800

我不能明确地告诉你，但我不相信你可以。我只是在相反的情况下遇到了这个问题（用 VS2005 构建的 Python，试图用 VS2003 构建）。搜索网络并没有找到任何破解它的方法。我最终的解决方案是获得 VC Express，因为 VC2005 是微软开始发布免费版本的时候。但这显然不是你的选择。

我不使用 ActiveState Python，但是您可以使用更新的版本吗？源代码附带了 VS2008 的项目文件，我很确定 python.org 二进制构建不久前停止使用 VS2003。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-03-23T17:25:15.407

截至 2012 年 3 月的今天，我可以断然地说 Python2.4.4（我只测试过一个）和 Visual Studio 2005 和 2008 是可能的。只需安装 VS10 即可检查。我不知道它为什么会起作用，而且我在使用 distutils 时遇到了问题，所以我必须手动编译。

# asp.net - 在 ASP.NET 中使用链接和锚点切换可见性的最佳方法是什么？

> ID：606681
> 
> 赞同：3
> 
> 时间：2009-03-03T14:53:20.567
> 
> 标签：asp.net, vb.net, hyperlink, anchor, visibility

我有一个页面，用于显示大量表格供用户填写并生成报告。这些表单中的每一个都在它自己的 ASP:Panel 控件中，因此我可以切换表单的可见性（这样只有具有适当权限的人才能访问他们被允许访问的报告）。

客户现在请求了一个“目录”，例如页面上带有指向每个表格的超链接的区域（这样他们就不必花时间滚动页面来找到他们想要的特定报告表格）。`<a href="#Area">`使用标准和`<a id="Area">`标签很容易做到这一点。我现在正在寻找的是一种允许我隐藏用户无权访问的报告链接的方法。

我首先考虑使用 ASP:LinkBut​​ton 控件，但我不希望通过单击链接发生任何回发（这将是非常不必要的）。我可以使用其他方法来实现相同的目标吗？我正在寻找可以让我轻松切换相应链接的可见性的东西，同时我正在切换包含报告表单的面板的可见性（现在从代码隐藏中完成）。

注意：使用VB作为语言

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T14:58:01.943

如果您使用链接控件，您可以根据其相关面板的可见性显示或隐藏链接。

```
Link1.Visible = Panel1.Visible 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T15:13:35.447

> 我首先考虑使用 ASP:LinkBut​​ton 控件，但我不希望通过单击链接发生任何回发（这将是非常不必要的）

我不同意。您说的是每次单击链接时都会重绘大部分页面，从技术角度来看，进行完整的回发是合适的。此外，用户习惯于在单击链接时期望往返于服务器。这就是超链接通常所做的。因此，从用户体验的角度来看，它也是合适的。

# jsp - 如何停止箭头键在 JSP 页面中的两个 DIV 中滚动

> ID：606685
> 
> 赞同：0
> 
> 时间：2009-03-03T14:53:56.290
> 
> 标签：jsp, html

我有一个带有各种**DIV的****JSP**页面，其中一个包含一个表格。

 **我可以在表格中选择一行，然后使用箭头键更改该选择。那也行。

我在表格中选择一行并按下一个按钮，该按钮会`DIV`显示隐藏。

这个新`DIV`的包含一个`SELECT`下拉。如果我单击`SELECT`下拉菜单，然后使用箭头键更改确实会更改的选择。但是我也发现我在原始表格中的选择也发生了变化。

我怎样才能阻止这个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-11T06:50:14.523

这听起来像是一个称为事件冒泡的问题。大多数 javascript 框架都有办法阻止这种行为。然而，确切的解决方案取决于您的源代码，您没有在您的问题中提供。

IE。jquery方式：[http ://api.jquery.com/event.stopPropagation/](http://api.jquery.com/event.stopPropagation/)

# sql-server - 如何在 SQL Server 2005 中限制失败的登录？

> ID：606686
> 
> 赞同：3
> 
> 时间：2009-03-03T14:53:57.290
> 
> 标签：sql-server, security

我相信我的服务器一直是对 SQL Server 2005 (SQLExpress) 的暴力攻击的持续目标。我的事件查看器日志中充满了 SQL Server 的“失败审核”消息。尝试通常持续一两个小时，尝试之间有 1-2 秒。

> 用户 'sa' 登录失败 [CLIENT: 222.169.224.163]

事件 ID：18456。根据 SQL Server 日志中的匹配条目，我发现每次登录都因密码不匹配而失败。我还看到了其他用户的尝试，包括“管理员”和“管理员”。每个会话都来自不同的 IP 地址，并且来自意大利和中国等国家/地区。

**可以采取哪些对策？**我不想锁定用户帐户，因为这样我的站点和应用程序将无法访问服务器。有没有办法通过 SQL Server 2005 限制登录尝试？例如，以几何方式增加失败登录尝试之间的“等待期”？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-03T14:56:33.180

据我所知，没有办法限制对 SQL Server 的登录尝试。但是，我有点好奇互联网用户是如何做到这一点的。你不是在防火墙后面吗？ **这是一些可怕的访问，应该尽快补救。**

我的 Web 服务器位于防火墙后面，唯一允许访问的端口是 80 和 443。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-03T14:57:09.043

虽然这不是您问题的答案，但将数据库服务器暴露在 Internet 上从来都不是一个好的做法。提供网络服务以安全的方式访问数据，并将服务器隐藏在防火墙后面。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T14:57:24.677

考虑使用防火墙阻止 SQL Server 端口 (1433) 上的传入连接。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-24T10:20:18.807

一个快速修复方法是重命名 sa 帐户并修改依赖此 Sql Server 的服务上的连接参数。

更改登录 sa 禁用；

使用名称更改登录 sa = [sys12-21admin]；

（当然，选择另一个名称而不是建议的名称。）

更多详情[http://blogs.msdn.com/sqltips/archive/2005/08/27/457184.aspx](http://blogs.msdn.com/sqltips/archive/2005/08/27/457184.aspx)

通过增加失败登录尝试之间的“等待时间”，您可以拒绝对 Sql Server 的正确访问。

据我了解，应用程序正在使用“sa”登录来执行日常任务，这可能会导致帐户被锁定。万一发生这种情况，请使用[http://www.windowsecurity.com/articles/Hacking_an_SQL_Server.html](http://www.windowsecurity.com/articles/Hacking_an_SQL_Server.html)

这当然是另一个安全问题，您应该尝试尽快停止访问，如之前的帖子中所建议的那样。

# .net - 链接到显示所有文化的 CultureInfo 的表格

> ID：606690
> 
> 赞同：3
> 
> 时间：2009-03-03T14:55:02.077
> 
> 标签：.net, localization, culture

我正在失去理智，试图找到一张显示文化所有日期时间格式的表格

我一直在疯狂搜索，我想要的只是那张桌子！精氨酸

IE

en-CA = DD/MM/YYYY 0.00 en-FR = MM/DD/YYYY 0,00

我正在寻找 MSDN 或维基百科的链接 - 我知道我以前见过这个

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-03T14:56:47.143

```
foreach (var c in System.Globalization.CultureInfo.
                         GetCultures(CultureTypes.AllCultures))
{
  Console.WriteLine("{0} = {1}", c.Name, 
                                 c.DateTimeFormat.FullDateTimePattern);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T15:30:01.180

如果您想要一个网页而不是自己制作信息，您可以随时使用[National Language Support API Reference](http://msdn.microsoft.com/en-us/goglobal/bb896001.aspx)：

```
Bashkir (Russia)
046D Codepage info
LCID    046D
Locale name Bashkir (Russia)
Language-English name   Bashkir
Language-native name    Башҡорт (Россия)
ANSI codepage   1251
OEM codepage    866
046D NLS formatting
Number formatting
Positive number example 12 346,00
Negative number example -12 346,00
Decimal separator   ,
Digits after decimal separator  2
Digit grouping  3;0;0
Thousands separator [blank][blank]
Negative format symbol  -
Number list separator   ;
Leading and trailing zeros: 0.700 formatted 0,70
Standard digits 0123456789
System of measurements  Metric
... 
```

# android - Android - ImageButton上翻转的不同图像

> ID：606694
> 
> 赞同：6
> 
> 时间：2009-03-03T14:55:58.220
> 
> 标签：android, imagebutton

当用户的焦点来到 ImageButton 时，是否可以指定不同的图像？我想在 LinearLayout 上显示一个图像按钮，并在用户的焦点落在按钮上或用户按下按钮时更改图像。

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-03T15:09:45.893

是的，你可以这样做。您需要的是一个定义选择器的可绘制 xml 文件。

```
<选择器 xmlns:android...
  <item android:state_enabled="false" android:state_focused="true" android:drawable="..." />
  <item android:state_enabled="true" android:state_focused="false" android:drawable="..." />
</选择器>

```

然后，在布局 XML 中指定 ImageButton 时使用此可绘制 XML 的 id。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T12:53:22.027

先例的答案对我不起作用。这是我在其他地方找到的代码：

```
 <selector xmlns:android="http://schemas.android.com/apk/res/android" >
         <item android:drawable="@drawable/refresh_pushed" android:state_pressed="true" />
         <item android:drawable="@drawable/refresh" />
    </selector> 
```

您还可以通过添加一条线并使用以下方法为焦点对象添加状态：

> 安卓：state_focused="真"

# c# - 奇怪的 C# 编译器错误：循环继承

> ID：606707
> 
> 赞同：1
> 
> 时间：2009-03-03T14:59:06.090
> 
> 标签：c#, inheritance, interface, compiler-errors

几天前，我在我们的一个 C# 应用程序中遇到了以下错误。错误消息如下所示：

> “继承的接口 '...ResourceManager.ResourcesManager' 在 D:...\Common\ResourceManager\IResourcesManagerView.cs 中的 '...ResourceManager.IResourcesManagerView' 的接口层次结构中导致循环”

这总是发生在我的机器上，但在构建机器上，构建成功的可能性为 50-50。我的类“ResourceManager”实现了一个接口“IResourcesManagerView”，它还实现了几个接口，其中一个是一个名为IInitializable 的通用接口。我找到了以下解决方法：声明一个实现 IInitializable 的虚拟接口 IDummy。

但这对我来说没有任何意义。有没有人遇到过这个问题？我使用 Windows XP、Visual Studio 2005。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T15:14:37.113

1）添加一个类图来可视化问题。有东西告诉我你现在不用了。

2）将问题最小化为您可以发布的内容。但是您可能会在此过程中自己发现它。

最佳猜测：闻起来像是有 2 个版本的 IInitializable 或 IResourcesManagerView。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T16:02:36.577

您可能引用了包含该接口的相同但不同版本的程序集。确保从同一位置引用公共程序集。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-05-12T13:30:36.730

我得到了同样的编译错误，修复了它（有点）并[在这里](https://stackoverflow.com/questions/37188355/inherited-interface-causes-a-cycle-in-the-interface-hierarchy)正式化了它。但这可能与您的问题不同。

# sql-server - 从 linq 到 sql 获取嵌套结果

> ID：606713
> 
> 赞同：2
> 
> 时间：2009-03-03T15:00:54.403
> 
> 标签：sql-server, linq, linq-to-sql

我的数据在表中如下所示：

```
ID     Name     Parent ID
---    ----     ---------
1      Mike     null
2      Steve    1
3      George   null
4      Jim      1 
```

我不知道如何编写一个 linq to sql 查询，该查询将返回父行与其子行分组的结果。因此，例如，这是我想要的结果：

```
1 Mike (no parent)
   2 Steve (Parent is 1)
   4 Jim (Parent is 1)
3 George (no parent) 
```

我现在这样做的方式是首先获取所有父行的结果集。然后我循环遍历它并找到每个父级的子级，并在循环时将所有这些插入到 List<> 中。最后 List<> 按我想要的顺序排列所有内容。

但是有没有办法在一个 linq 查询中做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T15:18:22.957

假设您有一个表的自引用关系，您可以执行以下操作：

```
 var q = db.People
           .OrderBy( p => p.ParentID == null
                          ? p.Name
                          : p.Parent.Name + ":" + p.ID + ":" + p.Name ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T15:07:50.563

您需要一个[公用表表达式 (CTE) 来执行递归 SQL](http://msdn.microsoft.com/en-us/library/ms186243.aspx)。Linq to Sql 不支持 CTE。您可以[直接执行查询](http://msdn.microsoft.com/en-us/library/bb399403.aspx)。

这就是 SQL 可能的样子，尽管它没有将孩子与他们的父母分组。我认为您不能使用 CTE 进行分组：

```
WITH DirectReports (ID, Name, ParentID, Level)
AS
(
    SELECT e.ID, e.Name, e.ParentID, 0 AS Level
    FROM Employee e
    WHERE e.ParentID IS NULL

    UNION ALL

    SELECT e.ID, e.Name, e.ParentID, Level + 1
    FROM Employee E
    JOIN DirectReports AS d
    ON e.ParentID = d.ID
)
SELECT *
FROM DirectReports 
```

# ajax - 一页中有两个ajax函数？

> ID：606724
> 
> 赞同：0
> 
> 时间：2009-03-03T15:03:44.643
> 
> 标签：ajax

嘿，我正在尝试在同一页面中运行两个 ajax 函数

一个发送输入用户名的值，另一个发送输入电子邮件的值，发送到 ajax.php 和 ajax1.php

下面是我的代码：

```
<script type="text/javascript">
function AjaxFunction(username)
{
var httpxml;
try
{
// Firefox, Opera 8.0+, Safari
httpxml=new XMLHttpRequest();
}
catch (e)
{
// Internet Explorer
try
{
httpxml=new ActiveXObject("Msxml2.XMLHTTP");
}
catch (e)
{
try
{
httpxml=new ActiveXObject("Microsoft.XMLHTTP");
}
catch (e)
{  
alert("Your browser does not support AJAX!");
return false;
}
}
}
 function stateck() 
{
 if(httpxml.readyState==4)
{
document.getElementById("msg").innerHTML=httpxml.responseText;

}
}

httpxml.onreadystatechange=stateck;
url="ajax.php?value=" + username.value;
httpxml.open("GET",url,true);
httpxml.send(null);

}

 function AjaxFunction(email)
 {
 var httpxml;
 try
 {
 // Firefox, Opera 8.0+, Safari
 httpxml=new XMLHttpRequest();
 }
 catch (e)
{
// Internet Explorer
try
{
httpxml=new ActiveXObject("Msxml2.XMLHTTP");
}
catch (e)
{
try
{
httpxml=new ActiveXObject("Microsoft.XMLHTTP");
}
catch (e)
{
alert("Your browser does not support AJAX!");
return false;
}
}
}
function stateck() 
{
if(httpxml.readyState==4)
 {
 document.getElementById("msg1").innerHTML=httpxml.responseText;

}
}

httpxml.onreadystatechange=stateck;
url1="ajax.php1?value=" + email.value;
httpxml.open("GET",url1,true);
httpxml.send(null);

}
</script>

<form id="form" name="form" method="post" action="">
  <p>
    <label>Username
       <input type="text" name="username" id="username" onBlur="AjaxFunction(username);">
    </label>
  <div id="msg"></div>
  <p>Email 
    <label>
       <input type="text" name="email" id="email" onBlur="email(EMAIL);">
  </label>  
   <div id="msg1"></div>
   <p>
     <label>
      <input type="submit" name="button" id="button" value="Submit">
    </label>
</form> 
```

然后应将响应文本放入 div 标签（msg & msg1）

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T15:08:35.227

您是否研究过[jQuery](http://docs.jquery.com/Ajax)，它将大大降低您页面的复杂性并为浏览器抽象提供一个不错的 API。我已经可以看到跨浏览器问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-07-05T00:48:18.247

您可能应该添加到“if (httpxml.readyState == 4)”的另一个 if 语句是“if (httpxml.status == 200)”。这确保服务器端没有任何问题。将这两个请求称为同一件事是危险的，因为对一个请求所做的任何更改都可能覆盖另一个。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-07-05T01:25:11.333

您希望避免重复代码吗？创建第三个函数来创建 httpxml 对象并将其传递给前两个。

```
httpxml = createAjax();
AjaxFunction(httpxml, username); 
```

# c++ - 如何从 bool 转换为 void*？

> ID：606728
> 
> 赞同：3
> 
> 时间：2009-03-03T15:04:45.127
> 
> 标签：c++, type-conversion

我正在尝试使用 mingw 在 Windows 上为 gtkmm 构建 cairomm。编译在函数调用处中断，该函数调用有一个参数，该参数将 bool 重新解释为 void*。

```
cairo_font_face_set_user_data(cobj(), &USER_DATA_KEY_DEFAULT_TEXT_TO_GLYPHS, reinterpret_cast<void*>(true), NULL); 
```

这是代码中断的地方，原因是“从 bool 到 void* 的 reinterpret_cast 无效”。为什么会发生这种情况，如何修改这一行以使其编译？需要帮忙

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-03T15:08:19.890

我看到这是用户数据，您可以控制该值的处理方式，首先将 bool 转换为 int: `reinterpret_cast<void *> (static_cast<int> (true))`。这样做很有意义，因为 void* 参数代替了这个 ANSI-C 库中的模板函数。您所需要的只是一个真/假值。因此，只要它有良好的文档记录，暂时将其编码为指针应该没有危险。真的，你最好用这个：`reinterpret_cast<void *> (1)`或`reinterpret_cast<void *> (+true)`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-03T15:28:17.863

根据标准，它看起来应该可以工作。3.9.1-7 节说 bool 是一个整数类型，而 5.2.10-5 节说整数类型的值可以使用 reinterpret_cast 显式转换为指针。看来您的编译器不是完全标准的。

你能把“真”改成1吗？在 C 和 C++ 中，整数和指针类型之间的转换是一个古老且不光彩的传统，如果找到一个不会这样做的编译器，那将是令人惊讶的。

或者，如果您真的必须这样做，请尝试 (void *)true。然后洗手。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-03T15:42:24.847

我唯一抱怨这个的编译器是 GCC (MinGW with GCC 3.4.5) - 我不知道为什么。该标准似乎清楚地表明这是允许的：

> 3.9.1 基本类型
> 
> ...
> 
> bool、char、wchar_t 类型以及有符号和无符号整数类型统称为整数类型。
> 
> 5.2.10 重新解释演员表：
> 
> ...
> 
> 整数类型或枚举类型的值可以显式转换为指针。

也就是说，[monjardin](https://stackoverflow.com/questions/606728/how-to-cast-from-bool-to-void/606742#606742)使用`reinterpret_cast<void *> (static_cast<int> (true))`or的解决方法`reinterpret_cast<void *> (1)`是合理的解决方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-03T15:11:42.770

reinterpret_cast 是个[坏主意](http://www.gotw.ca/gotw/017.htm)。告诉我们更多关于您要解决的问题的信息，也许我们会找到解决方案而无需重新解释。为什么要将 bool 转换为 void*？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-04T08:08:36.867

在某些情况下，非常希望编译器对类似 的代码发出警告或错误`reinterpret_cast<void*>(true)`，即使此代码显然是合法的 C++。例如，它有助于移植到 64 位平台。

将 64 位指针转换为小于指针的整数类型（例如`int`or `bool`）通常是一个错误：您正在截断指针的值。此外，C++ 规范似乎并不能保证您可以直接将指针转换为更小的整数类型（强调添加）：

> 5.2.10.4。指针可以显式转换为任何*大到足以容纳它的*整数类型。映射函数是实现定义的。

同样，将较小的整数类型转换为 64 位指针（如`reinterpret_cast<void*>(true)`）通常也是一个错误：编译器必须用某些东西填充指针的高位；它是零填充还是符号扩展？除非您正在为内存映射 I/O 访问或 DMA 编写特定于平台的低级代码，否则您通常根本不想这样做，除非您正在做一些 hacky（比如将布尔值填充到指针中） ）。但是 C++ 规范似乎并没有对这种情况说太多，除了它是实现定义的（脚注省略）：

> 5.2.10.5。整数类型或枚举类型的值可以显式转换为指针。 *
> 
> 转换为足够大小的整数（如果实现中存在这样的整数）并返回相同指针类型的指针将具有其原始值；指针和整数之间的映射是由实现定义的。

@monjardin 建议`reinterpret_cast<void*>(static_cast<int>(true))`。如果错误的根源是整数类型的大小和指针大小之间的不匹配，那么这将适用于大多数 32 位平台（其中`int`和`void*`都是 32 位），但在大多数 64 位平台（其中`int`32 位并且`void*`是 64 位）。在这种情况下，`int`在此表达式中替换为指针大小的整数类型，例如`uintptr_t`or `DWORD_PTR`（在 Windows 上）应该可以工作，因为`bool`指针大小的整数之间的转换是允许的，指针大小的整数和指针之间的转换也是如此。

更高版本的 GCC 具有以下[警告抑制选项](http://gcc.gnu.org/onlinedocs/gcc-4.3.3/gcc/Warning-Options.html)，但[不适用于 C++](http://osdir.com/ml/solaris.opensolaris.tools.general/2006-08/msg00014.html)：

> -Wno-int-to-pointer-cast（仅适用于 C 和 Objective-C）
> 禁止对不同大小整数的指针类型进行强制转换的警告。
> 
> -Wno-pointer-to-int-cast（仅限 C 和 Objective-C）
> 抑制从指针强制转换到不同大小的整数类型的警告。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-03T15:09:07.643

它失败了，因为强制转换没有任何意义——你正在获取一个布尔真/假值，并要求编译器将其解释为一个指针，直截了当地是一个内存位置。两者甚至没有关系。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-03T15:18:26.030

尝试更新版本的编译器。我刚刚测试过，这个演员至少适用于 gcc 4.1 及更高版本。我不确切知道 gcc 版本如何映射到 mingw 版本。

# xml - 保存为 XML 时 Excel 2007 中的数值精度问题

> ID：606730
> 
> 赞同：3
> 
> 时间：2009-03-03T15:04:52.270
> 
> 标签：xml, excel, excel-2007, spreadsheet

使用 Excel 2007 以 XML 电子表格 2003 格式保存文档时遇到一个奇怪的问题。

它似乎随机地将诸如“0.58”之类的数值更改为“0.57999999999999996”。

真正奇怪的是，当您在 Excel 中时，您看不到这个问题。只有在直接从文本编辑器查看 XML 数据时才能看到这一点。

有没有人遇到过这个？如果是这样，是否有任何修复或解决方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-03T15:24:56.513

Excel 将数值数据存储为浮点数。小数点右边的数字（小数部分）只是近似值。没有变通办法，0.58 不能表示为正好是 0.58 的浮点数。

在此时加载 XML 文件时，您应该将数字转换回浮点数或更好的固定数字十进制类（例如 C# 中的十进制）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T21:12:35.240

关键是 Excel 将数字存储为以 2 为底的浮点数。大多数小数部分不能表示为以 2 为底的浮点数。

一些答案表明“0.58不能用浮点表示”。这是不正确的，因为 0.58 可以用基数为 10 的浮点数字类型（例如 .NET Decimal 类型）表示 - 当然这对您没有好处，因为您无法更改 Excel 中用于数字的基础类型。

Excel 始终在公式栏中显示数字，精确到 15 位有效数字。因此，这个数字在公式栏中显示为 0.58，即使它不是“完全” 0.58 - 由于 Excel 基础数字类型的限制，也不能完全是 0.58。

您可以尝试打开显示的精度（在 Excel 2007 中，可以在 Excel 选项 -> 高级 -> 计算此工作簿时：-> 设置显示的精度） - 它可能会或可能不会导致 Excel 在保存时舍入此特定数字到 XML，但它至少会给你更一致的结果。请注意，因为显示的精度将舍入已经存储在数字单元格中的数字（它不可撤销），以及舍入计算结果（这部分是不可撤销的，因为关闭它会重新计算而不进行舍入）。显示的精度将根据数字格式进行四舍五入，因此“0.00”的数字格式将导致它四舍五入到小数点后两位 - 但大多数小数部分无法用 Excel 的以 2 为底的数字系统表示，因此为 0。当写入 XML 时，58 可能仍然会得到相同的结果。格式为“常规”的数字将四舍五入到 15 位有效数字，并启用“显示精度”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T15:46:41.327

数字 0.58 与 0.57999999999999996 相同。也就是说，*差异是 0*，或者说相同的另一种方式，数字是*相等*的。

现在，如果您使用的是“常规”高中数学，您可能会不同意。Excel 没有，一般计算机也没有。他们使用一组有限的位。二进制中 0.58 的精确表示使用无限组的位，因此您会丢失其中的一些位。

# iphone - 使用 UIActionSheet 委托的正确方法？映射到相同内存的指针

> ID：606733
> 
> 赞同：1
> 
> 时间：2009-03-03T15:05:16.920
> 
> 标签：iphone, memory, pointers, delegates

我正在使用 actionSheet:didDismissWithButtonIndex: 传递的 actionSheet 变量来将调用 actionSheet 与我的类中的 UIActionSheet 变量列表进行比较。这似乎是委托方法旨在区分事件的方式。

```
- (void)actionSheet:(UIActionSheet *)actionSheet didDismissWithButtonIndex:(NSInteger)buttonIndex {

if (actionSheet == actionSheet1) {
    switch (buttonIndex) {
        case 0:
            // Do Something
            break;
        case 1:
            // Do Something Else
            break;
        case 2:
            // Cancel
            break;
    }
}

if (actionSheet == actionSheet2) {
    switch (buttonIndex) {
        case 0:
            // Do Something
            break;
        case 1:
            // Do Something Else
            break;
        case 2:
            // Cancel
            break;
    }
} 
```

}

*每次显示 UIActionSheet 时，我都会将 UIActionSheet 的实例分配给类变量之一，设置显示属性，显示它，然后释放它*。

起初，这很顺利。问题是，运行一段时间后，最终两个 UIActionSheet 指针（上面代码示例中的类变量 actionSheet1 和 actionSheet2）最终都会指向同一个内存，具体取决于运行时发生的情况，从而导致委托中的两个 if 语句评价真假的方法。不好。

现在，如果我每次运行只分配每个 UIActionSheet 并保留内存（从不调用释放），这不应该发生。但我在这里试图保持保守。Apple 是否打算以这种方式使用委托？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-03T16:36:52.893

当你创建你的 UIActionSheet 时，给它一个标签：

```
actionSheet.tag = 1; // or 2 or 3 or ... 
```

然后，在您的委托方法中，根据标记进行切换以确定该特定工作表的行为。

# comparison - 两个大目录的比较

> ID：606739
> 
> 赞同：3
> 
> 时间：2009-03-03T15:07:33.450
> 
> 标签：comparison, directory

我有一个大目录，其中仅包含 CS 和数学中的内容。它的大小超过 16GB。类型为文本、png、pdf 和 chm。我目前有两个分支：我兄弟的分支和我的分支。最初的文件是相同的。我需要比较它们。我曾尝试使用 Git，但加载时间很长。

*比较两个大目录的最佳方法是什么？*

**[混合解决方案]**

1.  在两个目录中执行“ls -R > different_files”[1]
2.  “sdiff <(echo file1 | md5deep) <(echo file2 | md5deep)” [2]

你怎么看？有什么缺点吗？

*[1] 感谢 Paul Tomblin [2] 非常感谢所有回复者！*

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-23T15:51:52.650

使用 fslint:[网站](http://www.pixelbeat.org/fslint/)。该工具的选项之一是“重复”。根据该站点的描述：FSlint 最常用的功能之一是能够查找重复文件。从硬盘驱动器中删除 lint 的最简单方法是丢弃可能存在的任何重复文件。通常，计算机用户可能不知道他们的音乐收藏中有四个、五个或更多的完全相同的歌曲，但名称或目录不同。任何文件类型，无论是音乐、照片还是工作文档，都可以轻松复制到您的计算机上。随着副本的收集，它们会占用可用的硬盘空间。FSlint 提供的第一个菜单选项允许您查找和删除这些重复文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T15:10:39.993

**如何在没有预先存在的命令/产品的情况下比较 2 个文件夹：**

只需创建一个扫描每个目录并创建每个文件的文件哈希的程序。它输出一个包含每个相对文件路径和文件哈希的文件。

在两个文件夹上运行此程序。

然后您只需比较 2 个输出文件，看看它们是否相同。要比较这两个文件，您只需将它们加载到一个字符串中并进行字符串比较。

您使用的散列算法无关紧要。您可以使用 MD5、SHA、CRC，... 您还可以使用输出文件中的文件大小来帮助减少冲突的机会。

**如何将 2 个文件夹与预先存在的命令/产品进行比较：**

现在，如果您只想要一个执行此操作的程序，请使用[diff -r](http://unixhelp.ed.ac.uk/CGI/man-cgi?diff)或[windiff](http://www.grigsoft.com/download-windiff.htm)用于基于 Windows 的系统。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-03T15:11:56.200

使用[md5deep](http://md5deep.sourceforge.net/)创建这些目录中每个文件的递归 md5sum 列表。

您可以使用差异工具来比较生成的列表。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-03T15:11:18.683

您是否只是想发现一个文件中存在哪些文件而另一个文件中不存在，反之亦然？几个建议：

1.  在两个目录中执行“ls -R”，重定向到文件并区分文件。

2.  在它们之间执行“rsync -n”以查看如果允许复制 rsync 必须复制的内容。（-n 表示不执行 rsync，只是告诉您如果在没有 -n 的情况下运行它会做什么）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-03T15:11:22.130

我会`diff`比较输出`md5sum * | sort`

这将带你到不同/缺失的文件

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-21T10:56:08.973

我知道这个问题已经得到解答，但是如果你不打算自己编写这样的工具，sourceforge 上有一个名为[tardiff](http://tardiff.sourceforge.net/)的运行良好的开源项目，它基本上完全符合你的要求，甚至支持自动创建补丁（显然是 tar 格式）以解决差异。

希望这可以帮助

# latex - 如何在不干扰其他环境的情况下自定义现有的 LaTeX 环境？

> ID：606746
> 
> 赞同：1
> 
> 时间：2009-03-03T15:10:02.257
> 
> 标签：latex, python-sphinx

我正在使用[Sphinx](https://www.sphinx-doc.org)来记录项目。[它从reStructuredText](https://docutils.sourceforge.io/rst.html)生成 LaTeX 文件。

我想给*tips*和*notes*设置一个灰色的背景色，所以我在创建了一个graybox环境后自定义了*notice*环境：

```
\definecolor{MyGray}{rgb}{0.80,0.80,0.80}

\makeatletter\newenvironment{graybox}{%
   \begin{lrbox}{\@tempboxa}\begin{minipage}{\columnwidth}}{\end{minipage}\end{lrbox}%
   \colorbox{MyGray}{\usebox{\@tempboxa}}
}\makeatother

\makeatletter
\renewenvironment{notice}[2]{
  \begin{graybox}
  \bf\it
  \def\py@noticetype{#1}
  \par\strong{#2}
  \csname py@noticestart@#1\endcsname
}
{
  \csname py@noticeend@\py@noticetype\endcsname
  \end{graybox}
}
\makeatother 
```

一切正常，除非我在*通知环境中放置一个**[图形](http://en.wikibooks.org/wiki/LaTeX/Floats,_Figures_and_Captions#Figures)*环境。在这种情况下，我收到此错误：

 *> LaTeX 错误：不在外部标准模式下

有没有办法为那个*通知*环境设置灰色背景？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T20:54:58.123

这是一个[常见问题解答](http://www.tex.ac.uk/cgi-bin/texfaq2html?label=ouparmd)。将图形（或任何其他可以在输出中移动到其他位置的“浮点数”）放入灰色框内是没有意义的；如果您希望您的图形包含一个灰色框，请将灰色框环境放在图形环境中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-04T10:36:19.070

谢谢*Godbyk*和*Jouni*回答我的问题。

问题是我没有直接在*LaTeX*中编码。我用重组文本编写文档，Sphinx 输出*LaTeX*文件。

但我找到了一个解决方案：我重新定义了*图形*环境以使用*flowfram*包中的*staticfigure*：

```
\usepackage{flowfram}

\definecolor{MyGray}{rgb}{0.80,0.80,0.80}

\makeatletter\newenvironment{graybox}{%
   \begin{lrbox}{\@tempboxa}\begin{minipage}{\columnwidth}}{\end{minipage}\end{lrbox}%
   \colorbox{MyGray}{\usebox{\@tempboxa}}
}\makeatother

\makeatletter
\renewenvironment{notice}[2]{
  \begin{graybox}
  \bf\it
  \def\py@noticetype{#1}
  \par\strong{#2}
  \csname py@noticestart@#1\endcsname
}
{
  \csname py@noticeend@\py@noticetype\endcsname
  \end{graybox}
}
\makeatother

\renewenvironment{figure}[6]{
  \begin{staticfigure}
}{
  \end{staticfigure}
} 
```

PS：重新定义“数字”时，我必须将参数数量设为 6：如果我不这样做，它会在 pdf 文件中输出一些“htbp”（我不是*LaTeX*专家。这只是我找到的解决方案对于这个问题）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-04T05:58:16.100

正如 Jouni 正确指出的那样，图形和表格（即浮动）可以移动，而您的灰色框不能包含它们。要达到预期的效果，您有两种选择：

1.  将您的整个通知放入一个`figure`环境中（以便整个通知可以在页面上浮动，或者如果 LaTeX 选择，则可以浮动到新页面）。
2.  不要使用浮动（`figure`环境）——只需使用`\includegraphics`将图像直接弹出到`notice`环境中。但是，您将无法在此非图形中使用标题，因为标题只能在图形或表格环境中使用。如果您想要与此图像关联的标题，可以使用[`caption`包](http://tug.ctan.org/cgi-bin/ctanPackageInformation.py?id=caption)：

    ```
    \documentclass{article}
    \usepackage{caption}% let's us use captions outside of floats
    \usepackage{lipsum}% provides filler text
    \begin{document}
    \lipsum[1]
    \begin{center}
      \includegraphics{mypic}
      \captionof{figure}{This is my picture.}% makes a caption for non-floats
      \label{fig:mypic}
    \end{center}
    \lipsum[2]        
    \end{document} 
    ```

我没有使用过 Sphinx，所以恐怕无法帮助您将其集成到他们的输出中。

# iphone - 是否可以从 iPhone 表面的接近传感器访问数据？

> ID：606749
> 
> 赞同：2
> 
> 时间：2009-03-03T15:10:33.507
> 
> 标签：iphone

当您将 iPhone 放在耳边时，它会检测到有东西（接近传感器）并关闭显示屏。

是否可以在 iPhone 应用程序中访问此传感器？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T15:15:14.850

可以通过未记录的系统调用来实现，这就是 Google 的语音搜索在 iPhone 上的工作方式，以便在 iPhone 靠近您的耳朵时开始收听（或者我被告知）。尽管该 API 并未公开公开，因此尽管谷歌在商店中获得了该应用程序，但您的应用程序可能会受到更多审查。

抱歉，我不能确切地告诉你电话是什么。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T15:15:17.957

我不这么认为。

相反，它没有任何已发布的 API。

谷歌的语音搜索使用它，但这引起了一些大惊小怪，因为他们显然使用了一些未发布的功能。

[http://www.iphonehacks.com/2008/11/iphone-app-news.html](http://www.iphonehacks.com/2008/11/iphone-app-news.html)

编辑：

澄清一下，有已发布的 API 允许您打开和关闭它，但没有任何东西可以让您检测到它何时被触发。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-05-28T02:33:29.290

[我可以在此处](https://developer.apple.com/documentation/uikit/uidevice)的 Apple 文档中找到此功能，但我还没有尝试过。

> UIDevice 实例还提供对接近传感器状态的访问（由proximityState 属性描述）。接近传感器检测用户是否将设备靠近他们的脸。

# sql-server-2005 - 将整数转换为工作日列表

> ID：606751
> 
> 赞同：2
> 
> 时间：2009-03-03T15:10:45.830
> 
> 标签：sql-server-2005, tsql, dayofweek

我在数据库中存储了一个整数（SQLAgent 频率间隔）这个整数实际上是计划运行的一周中选定天数的总和 可能的值是这些值的任意组合

*   星期日 =1
*   星期一 = 2
*   星期二 =4
*   星期三= 8
*   星期四 = 16
*   星期五 = 32
*   星期六 =64

ex 65 表示计划应在周六和周日运行

我的问题是，当给定 65 时，我需要将这些值表示为文本“星期六”和“星期日”，我正在尝试在 SQL 中执行此操作

除了包含所有可能组合的巨大 CASE 语句之外，任何人都可以想到一种方法来做到这一点吗？

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-03T15:23:57.373

您可以在 T-SQL 中使用按位运算符。就是这样：

```
SELECT
  ( CASE WHEN daybits & 1 = 1 THEN 'Sunday ' ELSE '' END ) +
  ( CASE WHEN daybits & 2 = 2 THEN 'Monday ' ELSE '' END ) +
  ( CASE WHEN daybits & 4 = 4 THEN 'Tuesday ' ELSE '' END ) +
  ...
  ( CASE WHEN daybits & 64 = 64 THEN 'Saturday ' ELSE '' END ) + 
```

例如，这将产生“星期日星期六”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T15:15:42.743

我会先把它放在一个用户定义的函数上。此外，您可以使用在位级别运行的 and 来检查它 - 我认为它是 &，会更新。

**更新 1：**是 &，杰森已经举了一个例子。我仍然建议使用用户定义的函数:)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T15:20:18.833

编辑：这是执行位操作的 C# 代码。我在详细阅读问题之前发布了它，但我将把它留在这里作为替代方案。数据库真的是最好的地方吗...？

您可以使用数组：

```
// input: int value
string[] weekdays = { "Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Saturday" };
int flag = 1
List<string> days = new List<string>();
foreach (string day in days) {
   if ((value && flag) != 0) {
      days.Add(day);
   }
   flag <<= 1;
} 
```

结果是一个字符串列表，如果要合并它们，例如可以执行以下操作：

```
string selected = String.Join(", ", days.ToArray()); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T15:26:16.977

```
DECLARE @in INTEGER;
SET @in = 63;
WITH series(n) AS
    (
    SELECT  0
    UNION ALL
    SELECT  n + 1
    FROM    series
    WHERE   n < 6
    )
SELECT  CASE WHEN ROW_NUMBER() OVER (ORDER BY n) > 1 THEN ', ' ELSE '' END + DATENAME(weekday, DATEADD(day, n, '1980-09-03')) 
FROM    series
WHERE   (POWER(2, n) & @in) > 0
ORDER BY n
FOR XML PATH ('') 
```

# iis - 使用 ClearTrust 琐事填充事件查看器的企业库日志记录

> ID：606753
> 
> 赞同：1
> 
> 时间：2009-03-03T15:11:16.170
> 
> 标签：iis, logging, enterprise

有些东西变了，我说不出是什么。

我有一个带有开发、测试、QA 和生产环境的 IIS Web Farm 平台。一共7台服务器。Dev、Test 和 Prod 突然间充斥着来自每个使用 RSA ClearTrust 的网站的详细安全事件。QA 环境保持不变。

有些东西变了。这很明显，但根本不明显它是什么。ClearTrust 未升级。Windows 没有打补丁。应用程序没有被修改。IIS 未重新配置。EventLog 服务的注册表权限没有放宽。

我正在考虑区分健康和不健康盒子之间的注册表。有人有更简单的想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-20T14:56:28.013

这很奇怪。

EL 不是 Microsoft 支持的产品，尽管它是他们提供的免费资源。所以，他们无法真正告诉我发生了什么。无论如何，我们学到了一些东西。
1) EL 无法写入自定义事件日志
2) EntLib.config 文件按照宣传的方式工作。

在开发人员能够更适当地修改配置之前，我能够将 EntLib.config 配置为不写入任何内容。

# tcp - 通过互联网同步时钟

> ID：606761
> 
> 赞同：5
> 
> 时间：2009-03-03T15:12:00.537
> 
> 标签：tcp, latency, ntp

我正在使用我自己的协议通过互联网在两台专用计算机之间发送实时关键数据。

当然，存在延迟。

对于调试和优化，我喜欢让两台计算机使用相同的时基。即，我需要知道他们时钟的时差，以便更好地判断延迟。

当然，相对论之类的东西并不能真正让我完美地同步它们，但我喜欢尽可能接近。

仅依靠 NTP 似​​乎还不够好 - 根据我的经验，时钟可能会延迟半秒（澄清：到目前为止，我依赖于 Apple 提供的默认时钟）。

我需要至少 1/10 秒范围内的精度。两台计算机不会相距太远，ICMP ping 时间通常小于 100 毫秒。

任何建议如何做到这一点？

（目前，所涉及的机器运行 OS X，所以如果您知道专门为它们提供的解决方案，那将是一个开始）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-03T15:13:06.277

从连接到机器的 GPS 接收器获取时间。如果他们在数据中心，可能很难将天线安装到可以锁定的位置，但不幸的是。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-03T15:15:08.253

我建议您最好的选择是在其中一台机器上安装一个 ntp 服务器，并让另一台与它同步。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-03T15:15:46.003

您是否尝试将其中一台机器作为另一台机器的 NTP 服务器？可能它们不会与“实时”时间同步，但这可能会使您达到所需的精度。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-03T15:29:21.290

> 仅依靠 NTP 似​​乎还不够好 - 根据我的经验，时钟可能会延迟半秒。

那很奇怪。Internet 上的 NTPd 应该为您提供更高的精度。

# asp.net-mvc - RC1 的 MVC 框架浏览器缓存问题

> ID：606765
> 
> 赞同：0
> 
> 时间：2009-03-03T15:13:19.350
> 
> 标签：asp.net-mvc, caching

在我最新的 RC1 项目中，我注意到我遇到了无法解决的浏览器缓存问题。这就是我的标题的样子

```
HTTP/1.1 200 OK
Date: Tue, 03 Mar 2009 15:11:34 GMT
Server: Microsoft-IIS/6.0
X-Powered-By: ASP.NET
X-AspNet-Version: 2.0.50727
X-AspNetMvc-Version: 1.0
Cache-Control: private
Expires: Tue, 03 Mar 2009 15:11:34 GMT
Content-Type: text/html; charset=utf-8
Content-Length: 4614 
```

现在从技术上讲，如果这是私有的，它不应该对内容有到期日期吗？我也尝试过 no-cache 并获得相同的结果。有人对这个特定问题有任何经验吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T15:31:55.967

Cache-Control: private 仅指定响应仅针对单个用户，不应存储在共享缓存中（例如，在代理中）并用于为其他用户提供请求。我在协议文档中没有看到任何会排除使用带有值的 Expires 标头的内容。事实上，说“仅将其用于该用户的后续请求，而不是在此时间之后”似乎是完全合理的事情。Cache-Control 还有其他值，其中 Expires 可能没有意义，但我相信该协议具有消除冲突标头之间歧义的方法（请参阅协议文档的第 4 节）。

[引用HTTP 1.1 协议](http://www.ietf.org/internet-drafts/draft-ietf-httpbis-p6-cache-05.txt)文档的第 16.2 节：

> 私人的
> 
> ```
>  Indicates that all or part of the response message is intended for
>   a single user and MUST NOT be cached by a shared cache.  This
>   allows an origin server to state that the specified parts of the
>   response are intended for only one user and are not a valid
>   response for requests by other users.  A private (non-shared)
>   cache MAY cache the response.
> 
>   Note: This usage of the word private only controls where the
>   response may be cached, and cannot ensure the privacy of the
>   message content. 
> ```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T15:33:06.133

没有理由不能缓存私有内容，只是它应该只被当前用户上下文中的浏览器缓存，它不应该被缓存在服务器端或其他缓存，如代理服务器。

# matlab - 在 MATLAB 中自动将图形写入文件

> ID：606768
> 
> 赞同：11
> 
> 时间：2009-03-03T15:13:26.323
> 
> 标签：matlab, matlab-figure, eps

有谁知道是否可以在 MATLAB 中自动将数字写入 .eps 文件？

我正在运行一个生成大量图表的脚本，如果我不必手动保存每个图表，那就太好了！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-03T15:15:19.093

[打印功能](http://www.mathworks.com/access/helpdesk/help/techdoc/ref/print.html)这样做：

> 打印图形或保存为特定文件格式...
> 
> `print(filename,formattype)`使用指定的文件格式将当前图窗保存到文件中，例如`print('BarPlot','-dpng')`. 如果文件名不包含扩展名，则 print 会附加相应的扩展名。
> 
> `print(filename,formattype,formatoptions)`指定可用于某些格式的附加选项。
> 
> `print`将当前图形打印到默认打印机...

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-04T14:10:31.737

print 或 saveas 可以解决问题。

```
saveas(fig_handle, 'filename','eps')
print('-deps',fig_handle)
print -deps 1 
```

如果要指定输出文件名，最好使用 saveas。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-03T15:14:56.817

使用[PRINT](http://www.mathworks.com/access/helpdesk/help/techdoc/ref/print.html)命令在[另一个问题](https://stackoverflow.com/questions/575475/how-can-i-save-an-altered-image-in-matlab)中回答了这个问题。尽管该问题涉及制作 .tiff 图像，但修改这些答案中给出的代码以编写 .eps 应该很简单。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-06T13:03:18.443

假设您在一个循环中生成 N 个数字，那么您应该尝试使用命令行：

`saveas(gca,sprintf('Figure%02d.pdf',N ));`它产生 N 个数字 Figure1.pdf - FigureN.pdf `saveas(gca,sprintf('Figure%02d.eps',N ));`它产生 N 个数字 Figure1.eps - FigureN.eps

代替`gca`一个也可以使用`gcf`。第一个命令行是更好的解决方案。

希望这能解决您的问题。

# python - 模型和验证混淆 - 寻求建议

> ID：606782
> 
> 赞同：0
> 
> 时间：2009-03-03T15:15:16.630
> 
> 标签：python, django, validation

我对 Python、Django 有点陌生，我想要一些关于如何布局我想编写的代码的建议。

我编写了允许上传文件的模型。在模型保存方法中，我正在检查文件是否具有特定扩展名。如果它具有 XML 扩展名，我将打开文件并从文件中获取一些信息以保存在数据库中。我有这个模型工作。我已经在内置管理中对其进行了测试。有用。

目前，当出现错误（它不是 XML 文件；无法打开文件；特定属性不存在）时，我会抛出自定义“异常”错误。我想做的是如何*将*这些“异常”错误消息传递给视图（无论是自定义视图还是内置管理视图）并显示错误消息，就像正在使用表单库一样。那可能吗？

我开始认为我将不得不使用表单库再次编写验证检查。如果是这种情况，是否仍然可以使用内置的管理模板，但扩展它用来添加这些自定义验证的表单？

任何能帮助我困惑的事情都将不胜感激。

* * *

**更新：**

到目前为止，这是我的模型，对于那些询问的人，“nzb”是 XML 文件字段。
[http://dpaste.com/hold/6101/](http://dpaste.com/hold/6101/)

> 管理界面将使用您与模型关联的表单；您自己的意见也可以使用表格。

这正是我想做的。但是，我不知道如何将我的表单与我的模型相关联。过去，当我创建表单时，它们总是充当自己的实体。在使用 ModelForm 类时，我永远无法让管理视图使用它们。你能对此有所了解吗？

我已经阅读了你给我的链接，它似乎是我过去所做的，没有运气。

> 从文件中获取属性，应该是一种方法。

对不起，你能详细说明一下吗？方法在哪里？

* * *

**更新：**

看起来我已经完全错过了将表单链接到管理视图的这一步。 [http://docs.djangoproject.com/en/dev/ref/contrib/admin/#adding-custom-validation-to-the-admin](http://docs.djangoproject.com/en/dev/ref/contrib/admin/#adding-custom-validation-to-the-admin)

这现在应该允许我在表单中进行验证。但是，我仍然对如何实际处理验证感到困惑。S.Lott 说它应该是一种方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-03T16:04:29.163

表单错误自动成为管理视图的一部分。

请参阅[http://docs.djangoproject.com/en/dev/ref/forms/validation/#ref-forms-validation](http://docs.djangoproject.com/en/dev/ref/forms/validation/#ref-forms-validation)

如果您在表单中进行验证，您会最开心——这就是表单的用途。管理界面将使用您与模型关联的表单；您自己的意见也可以使用表格。

从文件中获取属性，应该是模型类的单独方法。模型类的单独方法可以被模型类的`save()`方法使用，也可以在其他时候被视图函数调用。

* * *

“在使用 ModelForm 类时，我永远无法让管理视图使用它们。”

[http://docs.djangoproject.com/en/dev/ref/contrib/admin/#form](http://docs.djangoproject.com/en/dev/ref/contrib/admin/#form)

[http://docs.djangoproject.com/en/dev/ref/contrib/admin/#adding-custom-validation-to-the-admin](http://docs.djangoproject.com/en/dev/ref/contrib/admin/#adding-custom-validation-to-the-admin)

* * *

“我仍然对如何实际处理验证感到困惑。S.Lott 说它应该是一种方法？”

表单中的验证是使用`clean()`方法或`clean_somefield()`方法完成的。

“向管理员添加自定义验证”链接（上方）显示了如何将`clean_name`方法添加到“MyArticleAdminForm”表单。

如果您仍然感到困惑，请尝试从 Django 网页实际输入代码并查看它的作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T16:14:08.033

我想最好的方法是实现一个特殊的字段类，该类通过`FileField`对上传文件的自定义验证进行扩展。

验证在字段的`clean`方法中实现。`ValidationError`如果遇到错误，它应该检查 XML 文件并引发s。然后，管理系统应该像对待任何其他字段错误一样对待您的自定义错误。

ImageField 类是此类特殊验证的一个很好的示例——我建议您[只阅读源代码](http://code.djangoproject.com/browser/django/trunk/django/forms/fields.py#L475)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T18:34:30.067

您可以提供管理站点将使用的表单。然后，您可以在管理区域中显示的表单代码中执行验证。

请参阅管理站点上的文档，尤其[是 ModelAdmin 的 form 属性](http://docs.djangoproject.com/en/dev/ref/contrib/admin/#form)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T20:45:21.673

“我正在抛出一个自定义的“异常”错误“ - 你到底在哪里抛出异常？在您的模型中还是在您的视图中？

我对您的问题感到困惑，所以我假设您应该问“如果有输入错误，我应该在哪里捕获输入错误？’对你自己。

我看到的模型和视图就像是一条小型装配线上的零件。视图/表单验证是应该执行的第一个操作。如果通过表格输入数据有任何问题。应该使用 form.is_valid() 等在表单级别防止它。

除了执行 CRUD 之外，模型的功能应该是提供有关实体本身的元信息。理想情况下，它不应该为 CRUD 操作获取的数据而烦恼。

# sql-server - 复制的差异

> ID：606785
> 
> 赞同：1
> 
> 时间：2009-03-03T15:15:27.800
> 
> 标签：sql-server

有没有办法解决目标表和源表中行数不同的问题。我检查了复制监视器，它显示复制工作正常，但是源和目标之间有 300 个表的差异。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T15:34:47.627

有问题的表是否包含在您的复制配置中，即是否已明确选择在发布服务器上复制的结构？

新创建的表不会自动包含在内。

如果没有，您将需要在 Publisher 更新发布，然后可以相应地更新复制拓扑。

说得通？

干杯，约翰

# .htaccess - 为什么我不能在 Apache 中禁用 .htaccess？

> ID：606786
> 
> 赞同：5
> 
> 时间：2009-03-03T15:15:34.070
> 
> 标签：.htaccess, apache2, mod-python

这是我读过的大多数问题的相反问题。我在带有 Apache 2.2.8 的 Amazon 实例上运行 Ubuntu 8.04，但我不明白为什么将 AllowOverride 设置为 None 并不能阻止包含我的 .htaccess 文件。

我有一个包含 hello.py 的子目录和一个 .htaccess 文件。当我浏览到该文件时，它与提供该文件的 modpython 一起工作得很好。如果我在 .htaccess 中放入一些垃圾，则会出现服务器错误，因此我知道正在使用 .htaccess 文件。此外，如果我删除 .htaccess 文件，则 hello.py 不再是 modpython 的服务器 - 而是浏览器尝试打开它。

在我的一个可用站点（在启用站点中链接）中，我的根目录有“AllowOverride None”。我认为这会阻止 .htaccess 从根目录及其所有子目录中包含，这会导致 hello.py 无法由 mod_python 提供服务。但是，它仍然可以正常运行，我可以测试 .htaccess 是否仍然包含在内，因为当我修改它时，我会在浏览器中看到结果。

也许我对启用站点的文件有些不理解。这是我正在使用的文件：

```
NameVirtualHost *:8080 
<VirtualHost *:8080>
<Directory />
AllowOverride None
</Directory>
</VirtualHost> 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T16:01:43.633

删除 .htaccess 时文件不通过 mod_python 提供的原因是 mod_python 的设置位于其中。如果您将这些内容移到您的站点可用文件中，您可以删除 .htaccess，对问题视而不见，然后收工。

如果这不能满足你，那么至于为什么 .htacess 被阅读，我不能说。您是正确的， AllowOverride None*应该*阻止文件被读取。您是否考虑过在添加虚拟站点时搞砸了某些事情的可能性？尝试将一些垃圾扔到配置中，看看它是否抱怨，只是为了确保它正在被读取。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T15:37:58.400

[`AllowOverride`](http://httpd.apache.org/docs/2.2/mod/core.html#allowoverride)只允许在`<Directory>`-sections 中，所以你做的一切都是正确的。

您可能遇到的一个问题是其他（子）`<Directory>`部分设置`AllowOverride`为不同于`None`. 这将覆盖这些子目录的设置。我用

```
<Directory />
    Options FollowSymLinks
    AllowOverride None
</Directory>
<Directory /var/www/>
    Options Indexes FollowSymLinks MultiViews
    AllowOverride AuthConfig 
    Order allow,deny
    allow from all
</Directory> 
```

在`/var/www`（我的 docroot）中，我可以使用`.htaccess`es。

`mod_python`如果您删除您的设置不再起作用，原因`.htaccess`是`mod_python`设置通常在`.htaccess`文件中。

如果您需要更多信息，请将您的配置发送给我们。

PS：事实上，上面链接的文档说你永远**不**应该设置`AllowOverride`不在`None`.`<Directory />`

# ajax - 使用 Firebug 调试 Ajax 代码

> ID：606794
> 
> 赞同：21
> 
> 时间：2009-03-03T15:17:18.137
> 
> 标签：ajax, json, firebug

我在调试 Ajax 调用中返回的代码时遇到了一些问题 - 特别是在 json 中返回的函数（错误不会被困在 Firefox 中） - 直到我开始在 Internet Explorer 中调试这些问题（我认为这是一个与 firefox 相关的问题，因为 Venkman 也没有检测到这些错误）你知道有什么方法可以调试从 Ajax 调用返回的 json 代码吗？

* * *

已编辑 03/04/2009 15:05

* * *

感谢大家的回复，但我认为我解释得不够好。我对 Firebug 的了解足以进行基本调试，但是当我在 Ajax 调用中获取一些有问题的代码时，就会出现问题。假设我们有以下 HTML 文件（您需要在同一文件夹中使用原型才能使其正常工作）：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<script type="text/javascript" src="prototype.js"></script>
</head>
<body>
<script>
function ajaxErrorTest()
{
    new Ajax.Request('data.json', {
           'method': 'get',
           'onSuccess': function(data){
           if(data.responseJSON.func)
           data.responseJSON.func();}});
}
</script>
<input type="button" value="test" onclick="ajaxErrorTest();" />
</body>
</html> 
```

然后，data.json 文件的内容是这样的：

```
{'func':function(){console.log('loaded...');alert('hey');}} 
```

如果您在浏览器中加载页面并单击“测试”按钮（一切顺利），您将在控制台中看到一些内容，以及一个显示“嘿”的警报框。现在将 data.json 文件更改为：

```
{'func':function(){console.log('loaded...');alerts('hey');}} 
```

...并再次单击“测试”按钮（无需重新加载页面；-）您得到控制台行，但没有警告框...并且没有错误！！！这是我要调试的那种错误。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-03-03T15:27:39.393

尝试单击“控制台”面板（它是一个选项卡）并启用它。您会发现任何 HTTP 请求都将与它们包含的任何信息一起被捕获。我使用它来查看存储在请求中的任何 JSON 以及任何错误（500/404/等）。

另请注意，您必须在每个域的基础上启用控制台面板。通常有三个子选项卡：标题、帖子和响应。当我调试我的 AJAX 时，我通常会经常使用 post/response 选项卡。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-03T16:04:06.607

您可能希望使用[Net 选项卡](http://getfirebug.com/net.html)并仅过滤 XMLHttpRequests (XHR) 的请求。

## 附加提示：

*   不要犹豫，在您的代码中或直接在控制台面板中使用[console.dir(yourObject) 。](http://getfirebug.com/console.html)这将为您提供对象的完整状态和属性。
*   检查您的请求/响应 HTTP 标头；有时这只是编码的问题。
*   如果您不知道触发此 XHR 调用的事件/用户操作，您可以在 AJAX 调用之前添加[console.trace() 。](http://getfirebug.com/console.html)这样，您将获得完整的调用堆栈。

## 编辑：

## 在另一个上下文中执行的代码

我想出的唯一方法是用（丑陋的）try/catch 包围你的代码。我猜这是因为代码是在另一个[javascript 上下文中执行的](http://dmitrysoshnikov.com/ecmascript/chapter-1-execution-contexts/)

```
<script>
function ajaxErrorTest()
{
    new Ajax.Request('data.json', {
           'method': 'get',
           'onSuccess': function(data){

           try{
             if(data.responseJSON.func)
             data.responseJSON.func();}});
           } catch (err) {
             console.dir(err);
           }
}
</script> 
```

此代码给出了详细的错误消息：

```
ReferenceError: alerts is not defined 
```

我真的怀疑更改执行上下文会解决问题。我不知道如何使用原型，但使用 jquery，可以轻松完成：

```
$.ajax({
  url: "test.html",
  context: document.body,
  success: function(){
    $(this).addClass("done");
  }
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-05-11T22:52:08.840

我会在 Firefox 中使用网络/控制台选项卡的组合。

从 Firefox 的 Net Tab 复制 json 结果。

然后将结果粘贴到控制台中的变量中并尝试执行有问题的函数。

在这种情况下，我粘贴了这个：

```
var x = {'func':function(){console.log('loaded...');alerts('hey');}}
x.func(); 
```

当我运行它时，萤火虫给了我这个错误。ReferenceError：未定义警报

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-05-12T13:15:04.003

这个很简单，我总是使用[FIDDLER](http://www.fiddler2.com/fiddler2/) 来调试我的 ajax 调用。

> Fiddler 是一个 Web 调试代理，它记录您的计算机和 Internet 之间的所有 HTTP(S) 流量。Fiddler 允许您检查所有 HTTP(S) 流量、设置断点以及“摆弄”传入或传出数据。Fiddler 包括一个强大的基于事件的脚本子系统，并且可以使用任何 .NET 语言进行扩展。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-05-12T12:29:22.590

正如其他人所提到的，通过在控制台选项卡中展开 AJAX URL 查看返回的 JSON/Javascript。

然后，如果您将其复制到控制台选项卡的运行/评估面板（右下角有一个向上/向下箭头，单击向上会将其更改为右侧的文本区域，单击向下会显示一条单行底部）。

如果您的 Ajax 调用返回：`function(){alert("hello")}`

然后你可以使用类似下面的东西：

```
x = eval('function(){alert("hello")}')
x(); 
```

这将允许您执行返回的 ajax。

要使用断点进行调试，请使用 HTML 视图创建一个标记（使用 Firebug 的 HTML 视图），然后简单地将代码粘贴到该标记内的函数中。然后，您可以设置断点并通过从 run'/eval 面板调用上一个函数来触发它。

如果这工作正常，那么显然存在您无法控制的错误，但您可以通过将 json 作为文本/纯文本发送回，将其分配给变量然后对其进行评估来简单地解决该问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-05-11T07:29:42.203

我不确定这个问题是否涉及检索到的实际 JSON。你可以尝试直接在你的`onSuccess`处理程序中抛出一个错误，看看它是否出现在 Firebug 控制台中？像这样的东西：

```
onSuccess: function() { alerts('hey'); } 
```

如果是这种情况，那么这个问题应该在 Firebug 1.7中[修复。](http://code.google.com/p/fbug/issues/detail?id=4085)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-02-21T11:42:08.850

我知道帖子中提到的具体问题是针对 Firefox 的。当我在谷歌上搜索一般如何调试来自 AJAX 调用的 java 脚本时，我登陆了这个页面，我相信很多其他人都会这样做。

我的情况是，我返回了一些其中包含脚本标记的 HTML，例如，如果 javascript 中的语法错误来自 firebug 中的 AJAX 请求，您将不会收到任何异常或错误。AJAX 内容将不会呈现。

在 google chrome 构建的调试器中，您将收到已引发的错误，但您将无法单步执行代码。如果您不想跨步，那么您需要为此制作一个虚拟页面。

这是迄今为止我能得到的最好的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-03T15:26:06.930

我使用了一个名为 fiddler 的 HTTP 代理调试器，它在调试我的 AJAX 问题时一直工作得很好。它捕获所有 HTTP 请求和响应以供您查看。它可从[http://www.fiddlertool.com/免费获得](http://www.fiddlertool.com/)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-05-12T13:59:56.003

您尝试调试的错误在本机 Firefox 控制台上非常明显。它是：“工具”-“错误控制台”
当然，你会在它发生后看到它，但行号错误（无限相似）

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-08-02T01:39:46.433

当您使用动态加载的库或 javascript 代码时，您可以在 javascript 代码的开头使用短语*//@sourceURL=foo.js* *foo.js*是分配它的名称。调试器将使用该名称显示它。这在我认为在萤火虫中的 chrome 中是正确的。在这种情况下，您可以在动态加载的 javascript（或 json）代码中放置断点。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2013-07-16T06:48:40.017

使用“调试器；” 作为您想要停止执行的代码行。这样，加载的源代码将在调试器的源代码部分中可用。我确定它可以在 chrome 上运行。

# java - 是否有适用于 Vista 和 Freebsd 的 Javax.comm 第三方解决方案？

> ID：606796
> 
> 赞同：0
> 
> 时间：2009-03-03T15:18:20.803
> 
> 标签：java, windows-vista, serial-port, freebsd

我需要在 Windows Vista 和 FreebSD 中使用 Java 访问串行端口，是否有任何第三方解决方案可以做到这一点？我知道 Sun 对此没有解决方案

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T16:19:51.840

查看[RXTX](http://rxtx.org/)以获得 Sun 串行端口库的替代方案。

# silverlight - Silverlight - 在 XAML 中而不是在构造函数中设置 DataContext？

> ID：606803
> 
> 赞同：30
> 
> 时间：2009-03-03T15:19:08.587
> 
> 标签：silverlight, datacontext

如何在 XAML 中而不是在构造函数中设置我的 Grid 上的 DataContext？

以下是我在构造函数中的操作方式（LayoutRoot 是 XAML 中定义的 XAML Grid）：

```
this.LayoutRoot.DataContext = this.HPVM; 
```

我宁愿在 XAML 中正确执行此操作，但我不知道如何在 XAML 中引用 HPVM 对象。HPVM 是 USerControl 类的公共属性。

如上所列，它工作得很好，但我只是想知道如何在 XAML 中设置 UserControl 类的属性，而不是总是必须在代码中进行。

以下是所有相关代码：

```
 <UserControl x:Class="SilverlightApplication1.SLHolePattern" x:Name="HolePatternsControl"
    xmlns="http://schemas.microsoft.com/client/2007"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
    xmlns:sys="clr-namespace:System;assembly=mscorlib"    
    xmlns:controls="clr-namespace:Microsoft.Windows.Controls;assembly=Microsoft.Windows.Controls"
    xmlns:local="clr-namespace:SilverlightApplication1"    
    xmlns:GeoPatterns="clr-namespace:GeoPatterns"
    Height="700">

    <UserControl.Resources>
    ... 
```

这是我当前设置 DataContext 的构造函数：

```
namespace SilverlightApplication1
{
    public partial class SLHolePattern : UserControl, INotifyPropertyChanged
    {
        public HolePatternsViewModel HPVM;

        public SLHolePattern()
        {
            InitializeComponent();

            this.HPVM=new HolePatternsViewModel();
            this.LayoutRoot.DataContext = this.HPVM;
            ...more code here
        } 
```

一切正常，但我只想学习如何在 XAML 中设置 DataContext，而不是在代码中。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-03-04T16:58:23.520

克里斯给出的答案很好。我已经测试过了，它对我有用。您可以在 XAML 中（在 UserControl.Resources 中）实例化您的类，然后将数据上下文绑定到静态资源。

关注代码：

```
 <UserControl ...>
    <UserControl.Resources>
       **<myNS:MyClass x:Name="TheContext" x:Key="TheContext"></myNS:MyClass>**
    </UserControl.Resources>
    <Grid x:Name="LayoutRoot" Background="White" **DataContext="{StaticResource TheContext}"** >
        <TextBlock Text="{Binding Path=Field1}">
        </TextBlock>
    </Grid>
</UserControl> 

```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2010-07-21T13:44:08.150

以下怪物在 Silverlight 4 中有效

```
<UserControl 
  DataContext="{Binding HPVM, RelativeSource={RelativeSource Self}}"> 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2010-01-30T13:58:46.960

```
<UserControl.DataContext>
  <vm:ThisUCViewModel />
</UserControl.DataContext> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-03T15:23:48.230

尝试这样的事情.....

```
<Grid DataContext="{Binding Path=HPVM}">
</Grid> 
```

其中HPVM是this的公共成员->您的表单等。

在 xaml 中创建你的类的实例，通过在你的资源部分添加这样的东西......（不要忘记添加你的 xmlns 命名空间）

```
<my:bogart x:Key="franken"/> 
```

然后，将数据上下文绑定到刚刚添加的静态资源......

```
<Grid x:Name="LayoutRoot" Background="White" DataContext="{StaticResource franken}">
    <TextBox  Background="Red" Foreground="White" Text="{Binding Path=sum}"  />
</Grid> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-01-19T21:39:25.187

在 Silverlight 4 中，我可以通过执行以下操作来完成这项工作：

给 Page/UserControl 一个 x:Name="myPage"

在您的控件绑定中使用正常的元素绑定语法。在我的情况下，我想在我的 ItemsSource 属性后面的代码中绑定到一个可观察的对象集合：

```
<ComboBox 
    ItemsSource={Binding ElementName=myPage, Path=MyObservableObjectList, Mode=TwoWay} 
```

我还没有尝试过使用 DataContext 进行此操作，但知道您可以为 DataContext 执行元素到元素绑定，就像我对上下文基于页面上某些其他下拉列表的选定项的网格执行此操作一样。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-03T17:43:48.613

这是不可能的（在 WPF 中可以使用`{Binding RelativeSource={RelativeSource Self}}`，但 Silverlight 受到更多限制。

你必须通过代码来完成。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-08-13T21:29:06.810

```
<UserControl.Resources>
  <ResourceDictionary>
     <vm:YourModelx:Key="myModel"/>
  </ResourceDictionary>
</UserControl.Resources>
<UserControl.DataContext>
   <Binding Source="{StaticResource myModel}"/>
</UserControl.DataContext> 
```

# tdd - TDD 和 DI：依赖注入变得繁琐

> ID：606811
> 
> 赞同：9
> 
> 时间：2009-03-03T15:22:49.247
> 
> 标签：tdd, dependency-injection

C#、nUnit 和 Rhino Mocks，如果结果证明适用的话。

当我试图围绕一个复杂的函数进行测试时，我对 TDD 的探索仍在继续。假设我正在编写一个表单，在保存时，它还必须在表单中保存相关对象......表单问题的答案、附件（如果有）和“日志”条目（例如“blahblah 更新了表单。”或“blahblah 附加了一个文件。”）。此保存功能还会根据保存功能期间表单状态的变化情况向不同的人发送电子邮件。

这意味着为了完全测试表单的保存功能及其所有依赖项，我必须注入五六个数据提供者来测试这一功能，并确保一切以正确的方式和顺序启动。在为表单对象编写多个链式构造函数以插入模拟提供程序时，这很麻烦。我认为我遗漏了一些东西，无论是重构方式还是设置模拟数据提供程序的更好方式。

我是否应该进一步研究重构方法以了解如何简化此功能？观察者模式听起来如何，以便依赖对象检测到何时保存父表单并自行处理？我知道人们说要拆分函数以便对其进行测试……这意味着我测试了每个依赖对象的单独保存函数，而不是表单本身的保存函数，这决定了每个人应该如何将自己保存在第一名？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-05T21:01:50.150

首先，如果您遵循 TDD，那么您不会围绕复杂的函数进行测试。您将函数包装在您的测试中。事实上，即使这样也不对。您将测试和函数交织在一起，几乎同时编写两者，测试稍微领先于函数。请参阅 [TDD 的三项定律](http://agileinaflash.blogspot.com/2009/03/unclebobs-three-rules-of-tdd.html)。

当你遵循这三个法则，并且勤奋地重构时，你永远不会得到“一个复杂的功能”。相反，您最终会得到许多经过测试的简单功能。

现在，进入你的观点。如果您已经有“一个复杂的功能”并且您想围绕它进行测试，那么您应该：

1.  显式添加您的模拟，而不是通过 DI。（例如一些可怕的东西，比如一个“测试”标志和一个选择模拟而不是真实对象的“如果”语句）。
2.  编写一些测试以涵盖组件的基本操作。
3.  毫不留情地重构，将复杂的函数分解成许多小的简单函数，同时尽可能频繁地运行拼凑在一起的测试。
4.  将“测试”标志推到尽可能高的位置。在重构时，将数据源传递给小的简单函数。不要让“测试”标志感染除最顶层函数之外的任何函数。
5.  重写测试。在重构时，尽可能多地重写测试以调用简单的小函数而不是大的顶级函数。您可以将模拟传递给测试中的简单函数。
6.  摆脱“测试”标志并确定您真正需要多少 DI。由于您在较低级别编写了可以通过参数插入模拟的测试，因此您可能不再需要在顶层模拟许多数据源。

如果在这一切之后，DI 仍然很麻烦，那么请考虑注入一个包含对所有数据源的引用的单个对象。注入一种东西总是比注入很多东西更容易。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-03T23:51:01.913

使用 AutoMocking 容器。有一个是为 RhinoMocks 写的。

想象一下，您有一个通过构造函数注入注入大量依赖项的类。这是使用 RhinoMocks 设置它的样子，没有 AutoMocking 容器：

```
private MockRepository _mocks;
private BroadcastListViewPresenter _presenter;
private IBroadcastListView _view;
private IAddNewBroadcastEventBroker _addNewBroadcastEventBroker;
private IBroadcastService _broadcastService;
private IChannelService _channelService;
private IDeviceService _deviceService;
private IDialogFactory _dialogFactory;
private IMessageBoxService _messageBoxService;
private ITouchScreenService _touchScreenService;
private IDeviceBroadcastFactory _deviceBroadcastFactory;
private IFileBroadcastFactory _fileBroadcastFactory;
private IBroadcastServiceCallback _broadcastServiceCallback;
private IChannelServiceCallback _channelServiceCallback;

[SetUp]
public void SetUp()
{
    _mocks = new MockRepository();
    _view = _mocks.DynamicMock<IBroadcastListView>();

    _addNewBroadcastEventBroker = _mocks.DynamicMock<IAddNewBroadcastEventBroker>();

    _broadcastService = _mocks.DynamicMock<IBroadcastService>();
    _channelService = _mocks.DynamicMock<IChannelService>();
    _deviceService = _mocks.DynamicMock<IDeviceService>();
    _dialogFactory = _mocks.DynamicMock<IDialogFactory>();
    _messageBoxService = _mocks.DynamicMock<IMessageBoxService>();
    _touchScreenService = _mocks.DynamicMock<ITouchScreenService>();
    _deviceBroadcastFactory = _mocks.DynamicMock<IDeviceBroadcastFactory>();
    _fileBroadcastFactory = _mocks.DynamicMock<IFileBroadcastFactory>();
    _broadcastServiceCallback = _mocks.DynamicMock<IBroadcastServiceCallback>();
    _channelServiceCallback = _mocks.DynamicMock<IChannelServiceCallback>();

    _presenter = new BroadcastListViewPresenter(
        _addNewBroadcastEventBroker,
        _broadcastService,
        _channelService,
        _deviceService,
        _dialogFactory,
        _messageBoxService,
        _touchScreenService,
        _deviceBroadcastFactory,
        _fileBroadcastFactory,
        _broadcastServiceCallback,
        _channelServiceCallback);

    _presenter.View = _view;
} 
```

现在，AutoMocking 容器也是如此：

```
private MockRepository _mocks;
private AutoMockingContainer _container;
private BroadcastListViewPresenter _presenter;
private IBroadcastListView _view;

[SetUp]
public void SetUp()
{

    _mocks = new MockRepository();
    _container = new AutoMockingContainer(_mocks);
    _container.Initialize();

    _view = _mocks.DynamicMock<IBroadcastListView>();
    _presenter = _container.Create<BroadcastListViewPresenter>();
    _presenter.View = _view;

} 
```

更容易，是吗？

AutoMocking 容器会自动为构造函数中的每个依赖项创建模拟，您可以访问它们进行测试，如下所示：

```
using (_mocks.Record())
    {
      _container.Get<IChannelService>().Expect(cs => cs.ChannelIsBroadcasting(channel)).Return(false);
      _container.Get<IBroadcastService>().Expect(bs => bs.Start(8));
    } 
```

希望有帮助。我知道随着 AutoMocking 容器的出现，我的测试生活变得轻松多了。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-03T15:29:04.803

你是对的，它可能很麻烦。

模拟方法的支持者会指出代码编写不当。也就是说，您不应该在此方法中构造依赖对象。相反，注入 API 应该具有创建适当对象的函数。

至于模拟 6 个不同的对象，这是真的。但是，如果您还对*这些*系统进行了单元测试，那么这些对象应该已经具有您可以使用的模拟基础设施。

最后，使用一个为您完成一些工作的模拟框架。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-07T21:51:01.420

我没有你的代码，但我的第一反应是你的测试试图告诉你你的对象有太多的合作者。在这种情况下，我总是发现其中缺少应该打包到更高级别结构中的构造。使用自动模拟容器只会抑制您从测试中获得的反馈。有关更长的讨论，请参阅[http://www.mockobjects.com/2007/04/test-smell-bloated-constructor.html](http://www.mockobjects.com/2007/04/test-smell-bloated-constructor.html)。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-04-30T05:26:29.133

在这种情况下，我通常会发现“这表明您的对象有太多依赖项”或“您的对象有太多合作者”这样的陈述是相当似是而非的说法。当然，MVC 控制器或表单将调用许多不同的服务和对象来完成其职责；毕竟，它位于应用程序的顶层。您可以将这些依赖项中的一些组合到更高级别的对象中（例如，将 ShippingMethodRepository 和 TransitTimeCalculator 组合到 ShippingRateFinder 中），但这只是到目前为止，尤其是对于这些顶级的、面向表示的对象。这是要模拟的少一个对象，但您只是通过一层间接混淆了实际的依赖关系，而不是实际删除它们。

一个亵渎神明的建议是，如果您要依赖注入一个对象并为其创建一个不太可能更改的接口（您真的要在更改代码时放入新的 MessageBoxService 吗？真的吗？），那么不要打扰。这种依赖是对象预期行为的一部分，您应该一起测试它们，因为集成测试是真正的业务价值所在。

另一个亵渎神明的建议是，我通常在单元测试 MVC 控制器或 Windows 窗体中看到很少的实用程序。每当我看到有人嘲笑 HttpContext 并测试是否设置了 cookie 时，我都想尖叫。谁在乎 AccountController 是否设置了 cookie？我不。cookie 与将控制器视为黑匣子无关；集成测试是测试其功能所必需的（嗯，在集成测试中 Login() 之后对 PrivilegedArea() 的调用失败）。这样，如果登录 cookie 的格式发生变化，您就可以避免使一百万个无用的单元测试失效。

保存对象模型的单元测试，保存表示层的集成测试，并尽可能避免模拟对象。如果模拟一个特定的依赖项很难，那么是时候务实了：不要做单元测试，而是编写一个集成测试，不要再浪费你的时间了。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-04-30T05:38:28.403

简单的答案是您尝试测试**的代码做得太多**。我认为坚持[单一职责原则](http://www.objectmentor.com/resources/articles/srp.pdf)可能会有所帮助。

Save 按钮方法**应该只包含一个顶级调用来将事情委托给其他对象**。然后可以通过接口抽象这些对象。然后，当您测试 Save 按钮方法时，您只测试与**mocked objects**的交互。

下一步是为这些较低级别的类编写测试，但事情应该会变得更容易，因为您只是单独测试它们。如果你需要一个复杂的测试设置代码，这是一个糟糕的设计（或一个糟糕的测试方法）的一个很好的指标。

推荐阅读：

1.  [清洁代码：敏捷软件工艺手册](https://rads.stackoverflow.com/amzn/click/com/0132350882)
2.  [Google 编写可测试代码的指南](http://misko.hevery.com/attachments/Guide-Writing%20Testable%20Code.pdf)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-03T15:30:02.147

构造函数 DI 不是执行 DI 的唯一方法。由于您使用的是 C#，如果您的构造函数没有做任何重要的工作，您可以使用 Property DI。这大大简化了对象的构造函数，但代价是函数的复杂性。您的函数必须在开始工作之前检查任何相关属性的空值，如果它们为空，则抛出 InvalidOperation。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-03T15:53:31.983

当很难测试某些东西时，通常是代码质量的症状，即代码不可测试（在[这个播客](http://www.hanselminutes.com/default.aspx?showID=164)，IIRC 中提到）。建议是重构代码，以便代码易于测试。决定如何将代码拆分为类的一些启发式方法是[SRP 和 OCP](http://butunclebob.com/ArticleS.UncleBob.PrinciplesOfOod)。有关更具体的说明，有必要查看相关代码。

# jquery - 浮动相同范围的刻度

> ID：606815
> 
> 赞同：2
> 
> 时间：2009-03-03T15:23:52.710
> 
> 标签：jquery, graph, plot, flot

嗨，我想添加不在固定范围内的刻度。即我的刻度将是 1,2,3,3,3,3,4,5 我将如何告诉图形类型的数据集根据刻度数而不是固定范围来绘制点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T16:07:15.007

我想通了，我所做的是在我的滴答声中我设置了一个递增范围为 0,1,n(+1) 的数组，并将其标签设置为我想要的任何值 @0 = '27', @1 = '56 ', @2 = '67' ...等等，对于我在 x 轴点上的数据集，我根据我的增量范围填写了它。

# .net - 如何使用 LINQ to XML 按属性查找 XML 元素？

> ID：606817
> 
> 赞同：3
> 
> 时间：2009-03-03T15:24:00.633
> 
> 标签：.net, xml, linq, linq-to-xml

我正在学习 LINQ to XML，需要找到具有特定属性的元素的存在。目前我正在使用：

```
XElement groupCollectionXml = XElement.Parse(groupCollection.Xml);
IEnumerable<XElement> groupFind =
    from vw in groupCollectionXml.Elements("Group")
    where (string) vw.Attribute("Name") == groupName
    select vw;

if (groupFind.Count() == 0)
    return false;
else
    return true; 
```

我知道有一种更简洁的方法可以做到这一点，可能使用 Any()，但我不确定如何重写查询以使用它。有人有什么好的建议吗？谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-03T15:36:23.850

```
groupCollectionXml.Elements("Group").Any(
    vw=>(string)vw.Attribute("Name") == groupName
  ); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T15:28:11.170

```
groupCollectionXml.
    Elements("Group").
    Where(item=>String.
        Equals(item.Attribute("Name"), groupName, OrdinalIgnoreCase)).
    Any(); 
```

如果你想在一条线上

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-30T10:57:38.160

感谢其他两个答案。我将一个的简洁性与另一个的正确性结合起来，然后搅拌并想出了这个效果很好：

```
groupCollectionXml.Elements("Group").Any(
  vw => string.Equals(vw.Attribute("Name").Value, groupName, StringComparison.OrdinalIgnoreCase)
); 
```

# java - 是否有用于访问本机 Windows API 的 Java 库？

> ID：606820
> 
> 赞同：22
> 
> 时间：2009-03-03T15:26:11.703
> 
> 标签：java, windows, winapi

是否有用于访问本机 Windows API 的 Java 库？使用 COM 或 JNI。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-03-03T15:29:50.917

你可以试试这两个，我都看到了成功。

[http://jawinproject.sourceforge.net](http://jawinproject.sourceforge.net)

> Java/Win32 集成项目 (Jawin) 是一个免费的开源架构，用于 Java 和通过 Microsoft 的组件对象模型 (COM) 或 Win32 动态链接库 (DLL) 公开的组件之间的互操作。

[https://github.com/twall/jna/](https://github.com/twall/jna/)

> JNA 使 Java 程序可以轻松访问本机共享库（Windows 上的 DLL），而无需编写 Java 代码以外的任何内容——不需要 JNI 或本机代码。此功能可与 Windows 的 Platform/Invoke 和 Python 的 ctypes 相媲美。访问在运行时是动态的，无需代码生成。
> 
> JNA 允许您使用自然 Java 方法调用直接调用本机函数。Java 调用看起来就像在本机代码中一样。大多数调用不需要特殊处理或配置；不需要样板文件或生成的代码。

还在这里阅读：

[http://en.wikipedia.org/wiki/Java_Native_Interface](http://en.wikipedia.org/wiki/Java_Native_Interface)

> Java 本机接口 (JNI) 是一种编程框架，它允许在 Java 虚拟机 (JVM) 中运行的 Java 代码调用和被本机应用程序（特定于硬件和操作系统平台的程序）和以其他方式编写的库调用[1](https://github.com/twall/jna/)语言，如 C、C++ 和汇编。

[http://en.wikipedia.org/wiki/Java_Native_Access](http://en.wikipedia.org/wiki/Java_Native_Access)

> Java Native Access 使 Java 程序无需使用 Java Native Interface 即可轻松访问本机共享库。JNA 的设计旨在以最少的努力以自然的方式提供本地访问。不需要样板或生成的胶水代码。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-03T15:33:57.130

[JNA](https://github.com/twall/jna/#getting_started)挺好看的。我只是一个初学者，我发现它很容易。不仅适用于 Win32 API，而且适用于几乎任何其他 DLL。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-05T06:26:07.353

[Jacob](http://danadler.com/jacob/)在 COM 方面相当出色（但它是*真正*的COM - 就像您用 C++ 编写的一样 - 如果您熟悉真正的 COM 编程，那么 Jacob 很容易上手）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-05T06:43:05.470

来自 TeamDev 的[JNIWrapper](http://www.teamdev.com/jniwrapper/index.jsf)或[ConfyJ 。](http://www.teamdev.com/comfyj/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-01-01T03:56:55.673

另一种选择是[WinRun4J](http://winrun4j.sf.net "WinRun4J")。它有一个原生绑定层，旨在与[pinvoke.net](http://pinvoke.net/)（点网中使用的原生绑定格式）兼容。有关更多信息，请参阅[示例](http://winrun4j.sourceforge.net/nativebinding.html)。它有点早，所以 YMMV。

（完全披露：我从事该项目）。

另一个选项是[JFFI](https://github.com/wmeissner/jffi) - 这在 jruby 和 jython 中用于与本机库进行交互。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-03-29T18:12:26.223

看看[华夫饼](http://waffle.codeplex.com/)

# matlab - 使用变量指定打印的文件名

> ID：606821
> 
> 赞同：2
> 
> 时间：2009-03-03T15:26:16.230
> 
> 标签：matlab

有谁知道我如何使用 print 打印出基于变量的文件名的文件？
目前，如果我这样做：

```
filename = 'pressure';
print -despc filename 
```

它将文件保存为“filename.eps”

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-03T15:27:19.737

像这样：

```
print('-despc', filename) 
```

顺便说一句，开关`-tiff`对于保存 eps 文件的 tiff 预览很有用。
**回答评论：**

```
print('-despc', '-tiff', filename)    # saves eps file with tiff preview 
```

# security - 当我的老板告诉我在我们的软件中默认设置密码与用户名相同时，我该怎么办？

> ID：606830
> 
> 赞同：5
> 
> 时间：2009-03-03T15:27:59.437
> 
> 标签：security, passwords

我的老板反对要求我们的用户拥有安全密码，甚至要求他们默认设置为与用户名相同的密码。在这种情况下我该怎么办？你会怎么办？

**更新**- 一些用户提出了应用程序是否需要高安全性的问题。例如，这不是信用卡信息，但确实包括敏感信息以及邮件列表管理和发送功能。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-03T15:29:51.057

为强密码做最好的情况，然后，不幸的是，如果他们没有看到你的观点，要么按照他们的要求去做，要么找到更好的工作。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-03T15:37:37.450

告诉你什么。

...然后恭敬地以书面形式让上级知道会导致什么问题。

不要抄送任何人。当然，这是我的看法。如果你抄送它会很明显。你真的只是想要安全，但你必须保护自己。不过，您不必为此背信弃义。

把它放在你的发件箱里，打印出来，无论如何，如果你真的担心的话。

编辑-除非这是某种道德败坏的问题，否则您会按照被告知的方式去做。然后你只需记录你做了什么以及你为什么这样做。请记住，如果您不记录它 - 它就不会发生。记录是你应该一直做的事情。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-03T15:31:33.533

作为折衷方案，有更好的默认设置，例如使用用户的序列号、出生年份、姓名首字母、某些组合，具体取决于您手头的内容。不是最安全的，但也不是最不安全的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-03T15:35:48.267

您的应用程序**需要**高安全性吗？如果您的软件控制的数据不敏感并且对用户的风险很低，那么您可能真的不需要强密码。

如果您的应用程序在允许密码较弱的情况下确实对用户构成重大风险，您应该尽可能以书面形式提出这种情况。如果您可以量化风险和责任，那么就这样做，但最终您将不得不将决定权交给您的上级。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-03T15:46:18.693

*与用户名相同的默认*密码没有任何问题，前提是系统要求用户在用户首次登录时创建一个新密码。如果安全要求较低，您可以允许任何内容作为密码。如果您正在处理敏感数据，则密码强度需要处于适当的级别。你还没有说你隐藏了什么数据。如果它是一个基于 Intranet 的时间跟踪系统，那么拥有超强密码（12 个字符、小写、大写、数字和符号，并且没有字典中的单词）是没有意义的。如果您正在访问诸如税务记录数据库之类的东西，那么您至少需要两级身份验证 - 字符串密码和一次密钥生成。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-03T15:41:18.003

你应该狠狠地揍他一顿。解释他/她可能因此而发生什么样的不良宣传，还取决于数据、*数据保护法*和类似的东西实际上可能会导致严重的责任。基本上这样做可以被视为软件缺陷，因此公司可以对结果负责。

基本上你需要给他一个会咬他、吓唬他的理由。这就是您销售安全和保险的方式:)

如果你的老板连这么简单的事情都想不通，而且最后不能信任像你这样的人，也许你应该开始寻找一个新的地方，你可以真正发挥自己的潜力，而不是处理这些问题。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-03T15:53:08.973

这是很差的安全性。

例如，如果它可能导致您的用户被盗，那么您就有非常严肃的社会责任来提高安全性。你本质上是在处理人们的生活。去找你的老板，去找他或她的老板。打印出这些评论并随身携带。去你的法律部门，告诉他们这会导致多少曝光。如果您的公司倾倒有毒废物，举报人法律将适用。个人信息和身份盗窃同样严重。以书面形式做所有事情来保护自己，并为肯定会随之而来的诉讼提供书面证据。不要让您的公司在事后否认任何风险知识。故意实施导致身份盗窃的可怕安全措施的公司应该在市场上失败，除了羞耻之外什么都不值得，

另一方面，如果这种糟糕的安全性可能导致相对较小的事情，那么您提高安全性的努力也可以从我上面描述的内容中缩减。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-03T16:15:14.893

通过电子邮件向他发送您的担忧（以非攻击性的方式）。给出逻辑攻击向量，揭示将暴露的内容。最后请他确认这是他的指示。然后发送给他（只有他，如前所述）

电子邮件存档您的原始电子邮件和他的确认。如果发生任何事情，这将为您提供保障。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-03T15:34:12.700

争论拥有更强密码的理由，但也要做出妥协。密码是否默认为用户名，某些字母可能被数字替换？这也取决于系统。如果这是一个内部系统，那么某人可能很难访问该系统并造成任何伤害。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-03T15:41:46.287

照老板说的做，但要让密码在相对较短的时间内过期。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-03T15:43:37.857

我会整理一份关于密码政策、强密码的好处等的摘要文件，然后提交给他进行审查，并尝试使其成为公司政策的一部分。如果他们仍然不喜欢它，那么就按照他们的要求去做，因为他们是最终客户，而您已经尽了自己的一份力量来教育他们了解陷阱。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-03T15:50:06.763

为什么首先使用用户/密码？

*   记录用户活动？
*   操作系统要求它？

如果您想将操作（无论如何）与用户联系起来，我作为用户会要求我的密码是安全的！

如果您的老板害怕他可能会丢失“知识”，如果用户不在，并且他需要访问该用户的数据，则要求每个人都将他的密码写在密封的信封中。

如果你的老板不信任你，kündige！

彼得

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-03-03T15:51:34.047

Slough 可能会有所作为——但它可能过于苛刻。

也许采取组合的方法。

做被问到的事 - 但在展示它时，请确保它打破，或者你有一些机制可以显示它如何或为什么不是一种安全的方法。（这将在实施之前经过审查过程对吗？）

还可以在书籍或在线甚至办公室同事中找到任何描述“最佳编码实践”的文档，这些文档可能能够支持您的观点。提出你的消息来源，如果他们忽视了，你已经尽了自己的职责和尽职调查，最终的结果将落在上级的肩上。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-03-03T16:00:00.843

我会首先考虑请求背后的原因。

它真的是一个具有用户名+密码的活跃用户吗？首先应该设置什么？即，也许用户应该收到一封带有激活链接的电子邮件:)

敏感信息何时进入系统？假设它是由用户输入的，只需有一个激活步骤，用户更改密码（或者是他第一次有密码）。

请注意，如果您正在处理敏感信息，则可能有与之相关的法律。我也会调查一下，如果它是非法的，它会成为一个强有力的案例，在这种情况下，你应该真正考虑说不（当然首先解释原因）。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-03-03T16:02:17.203

他是否说它们必须全部小写...他是否明确表示它们必须不包括数字...

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-03-03T16:07:38.110

你应该黑进他的账户。然后他就会知道为什么用户名=密码不起作用。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-03-03T16:14:33.350

我以前遇到过这种情况，他们不想使用安全密码和/或锁定他们的计算机。

然后碰巧我们的网站被黑了（不是密码泄露的 b/c，而是我们使用的 CMS 的有缺陷的组件/模块的 b/c - 但这是另一回事），在几个不同的场合，人们登录 exec 的电脑查看一些不合适的东西。

这种解释的原因是，直到我提请他们注意这个和其他一些案例研究，他们才明白安全密码的重要性。

作为一种解决方案，您可以尝试对案例研究进行一些研究，在这些案例研究中，在存储或保护的信息不是非常重要的系统或站点上发生了违规行为，但损坏的原因和恢复所需的资金是巨大的——例如有人在您的网站上设置网络钓鱼诈骗，劫持服务器或网站并不得不擦干净整个盒子以重新开始，或其他类型的违规行为。

不管怎样，看它的价值。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-03-03T16:26:10.280

您可能想与老板分享一些事情 -

1.  最大的安全威胁不是外人，而是与您一起工作的人。如果自从您在那里之后有人被解雇，请向您的老板提出 - “如果 XXXX 可以访问其他人的帐户怎么办？” 这个人很多不会窃取数据，但他们可能会试图破坏系统或出于恶意弄乱数据。或者他们甚至可以与竞争对手共享这些数据吗？

2.  提出一个更强大的默认值作为折衷方案 - 用户名和 4 位家庭电话号码。它并没有强多少，但它确实使猜测变得更加困难。

3.  People can make fairly secure passwords by using mnemonics. However, you need to train people in how to do that. Offer to hold a session with your users on how to create secure passwords. Honestly, it's not just good for where they work but for anyone who shops or banks online. Something that's easy for IT people who have to juggle multiple passwords may be harder for others.

BTW, I found a nice javascript generator of mnemonic passwords.

[http://digitarald.de/playground/mnemonic-password-generator/](http://digitarald.de/playground/mnemonic-password-generator/)

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-03-03T16:26:41.263

I've found situations where a password is shared by several people, because sometimes security is less important than other stuff. Specially in intranets.

A solution can be to store the IP address of each user. It's a security measure closer to security cameras than to locks, but it might be enough for what your boss has in mind.

# java - 在 Java 中，消息生产者应该如何标识自己？

> ID：606835
> 
> 赞同：3
> 
> 时间：2009-03-03T15:28:58.983
> 
> 标签：java, design-patterns

我有一个包含多个生产者和一个消费者的统一消息对象队列。消费者正在发布信息，并且需要能够根据数据的来源授予访问权限，因此我希望生产者随消息一起发送一个合适的标识符。生产者自己不能对远端访问限制负责。

id 应该与生产者在我的应用程序中的角色相关。我想强制所有生产者都必须定义一个，并且子类生产者可以选择继承或重新定义它。生产者的类名将是一个很好的近似值，但我要识别的属性并不是类结构中真正固有的，而是我定义的。

我可以使用反射来找出类名或接口名，但这闻起来开销太大。另外，我不确定要寻找什么合适的属性。

由于所有生产者都是同一个抽象父类的子类，我认为一个好方法是在其中（或在接口中）放置一个常量，但后来我意识到在 Java 中，“常量”实际上是“静态最终”，这意味着我不能覆盖它，所以它不能那样工作。

一个更有经验的 Java 程序员将如何做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-03T15:31:32.737

如果您需要识别“类型”，请定义一个强制类为您提供该类型的接口，然后在任何地方实现该接口。

例子：

```
public interface IHasType {
   public String getTypeId();
} 
```

但是，如果类型列表是固定的，我会更进一步，将类型设为`Enum`：

```
public enum MyType {
   TYPE_A, TYPE_B;
} 
```

然后返回 this`enum`而不是 a `String`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T15:32:59.537

生产者类可以将限制和“其他东西”封装在自己的方法中吗？这样，每个不同的生产者都可以相应地实施适当的方法。或者只是让该方法返回某种能力标识符，例如某种枚举。

如果这不起作用，比如说如果你想让其他消费者做不同的事情，那么显而易见的解决方案是有一堆“if (object instanceof ....)”语句。

我已经做到了两种方式，我不能说在所有情况下都特别“更好”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T15:44:04.360

首先，我认为您需要清楚您要保护的内容。您是否在防范恶意代码？如果没有，那么只需使用排队的对象。

如果您想防范恶意代码，那么显而易见的方法是为每个生产者分配一个入队对象。没有其他生产者应该能够获得另一个入队者，因此您可以信任添加到队列中的任何内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T15:49:42.583

让您的消息对象扩展 java.util.EventObject，并让消息生产者将自己设置为消息源。然后，消息消费者可以对消息调用 getSource() 并找出是谁发送的。当然，这假设您信任消息生产者能够正确填充此字段。

# java - XML 验证：我做对了吗？

> ID：606839
> 
> 赞同：0
> 
> 时间：2009-03-03T15:29:04.973
> 
> 标签：java, xsd, xml-validation

我只是想知道是否有人可以给我的 XML 验证代码一次，看看我是否做得对。这是给我带来麻烦的代码部分......

```
SAXParserFactory factory = SAXParserFactory.newInstance();

SchemaFactory schemaFactory = SchemaFactory
    .newInstance(XMLConstants.W3C_XML_SCHEMA_NS_URI);

// *** CODE FAILS ON THE BELOW LINE **/
factory.setSchema(schemaFactory
    .newSchema(new Source[] { new StreamSource(schemaStream) }));

SAXParser parser = factory.newSAXParser();

SAXReader reader = new SAXReader(parser.getXMLReader());
reader.setValidation(false);
reader.setErrorHandler(new ResultProducingErrorHandler());
reader.read(content); 
```

每当我运行上面的代码时，我都会收到如下错误：

```
src-resolve: Cannot resolve the name 'ns:myStructure' to a(n) 'type definition' component. 
```

错误消息中提到的元素都是通过调用 <xs:import /> 导入到模式中的元素。该模式似乎通过[W3C XML Schema Validator](http://www.w3.org/2001/03/webdata/xsv)验证 OK 。

我是否必须单独包含这些模式中的每一个，或者 Java 是否足够聪明以获取这些额外的模式？我尝试将它们添加到传递给 newSchema 调用的数组中，但这没有任何区别。

我不认为我可以给出架构的链接，所以我真的只是在寻找关于我的代码是否至少可以接受的是或否。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T15:32:34.233

确保 xs:import 语句指向可从应用程序的当前目录访问的路径。当前目录可能不是您认为的那样。

# c# - C#、Linq2SQL：获取每组的最高值

> ID：606841
> 
> 赞同：1
> 
> 时间：2009-03-03T15:29:39.107
> 
> 标签：c#, linq-to-sql

假设我有这张桌子：

```
PetID    Name    Age    Weight 
```

如何在 Linq2SQL 中获取其年龄组中最重的每只宠物的名称、年龄和体重？

因此，如果我有一只 5 岁的宠物和 4 只 2 岁的宠物，我想要 5 岁的宠物的名称、年龄和体重，以及这四个中最重的 2 岁宠物中的一个。

这应该不会太难，但我还不太喜欢查询思维。不过正在努力。这是一种我需要多次解决的问题，但我并没有完全理解如何去做......

我认为这将包括使用 Max 或 > 运算符，以及某种分组或加入，但就我所知......

* * *

感谢您的回答。当谈到 GroupBy 的东西时，所有这些都让我走上了正轨。我标记为答案的那个是最接近我最终得到的答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T15:50:20.460

试试这个查询：

```
var petsGroup = ctx.Pets.GroupBy(p => p.Age)
                        .Select(g => g.First(x => x.Weight == g.Max(y => y.Weight))); 
```

它按年龄对 Pets 进行分组，然后选择组中与组的最大权重匹配的第一个元素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T15:51:57.040

这对你怎么样。

```
public class Pet
{
     public int PetID { get; set; }
     public string Name { get; set; }
     public int Age { get; set; }
     public decimal Weight { get; set; }
}

List<Pet> pets = new List<Pet>() 
{ 
    new Pet {PetID = 1, Age = 5, Name = "Bob", Weight = 4M },
    new Pet {PetID = 2, Age = 5, Name = "Brad", Weight = 3M },
    new Pet {PetID = 3, Age = 2, Name = "Troy", Weight = 1M },
    new Pet {PetID = 4, Age = 2, Name = "Dave", Weight = 2M },
    new Pet {PetID = 5, Age = 2, Name = "Simon", Weight = 3M }
};

var fatPetsByAge = from pet in pets
                   group pet by pet.Age into petsByAge
                   select new
                   {
                       Age = petsByAge.Key,
                       FatPet = petsByAge.FirstOrDefault(
                                f => f.Weight == petsByAge.Max(m => m.Weight))
                   };

foreach (var fatty in fatPetsByAge)
{
    Console.WriteLine("PetID: {0}, Age: {1} Name: {2} Weight: {3}",
        fatty.FatPet.PetID,
        fatty.FatPet.Age,
        fatty.FatPet.Name,
        fatty.FatPet.Weight);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T16:12:45.073

它可能是这样的：

```
var pets =  from pet in petSource
            group pet by pet.Age into g
            let max = g.OrderByDescending(p => p.Weight).FirstOrDefault<Pet>()
            select new { Name = max.Name, Age = max.Age, Weight = max.Weight }; 
```

# php - 您成功使用了哪个 PHP RPC（XML 或 JSON）库？

> ID：606844
> 
> 赞同：2
> 
> 时间：2009-03-03T15:29:51.727
> 
> 标签：php, xml, json, rpc

您成功使用了哪个 PHP RPC（XML 或 JSON）库？

我进行了一些研究，但未能找到一个与众不同的图书馆。

我发现了以下内容：

[用于 PHP 的 XML-RPC](http://phpxmlrpc.sourceforge.net/)

[XML_RPC (梨)](http://pear.php.net/package/XML_RPC/)

[JSON-RPC PHP](http://jsonrpcphp.org/)

还有一些看起来不太活跃或不成熟的人。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-04T00:10:06.453

我已经成功使用了 XML_RPC (PEAR)。我个人不是 xml-rpc “方式”的粉丝，但该库使用简单，我们每天有几十个客户使用它，并通过网络提取大量数据，我们从来没有遇到任何问题.

无论如何，我们根本没有挑战这个信封，但我对图书馆非常满意，因为我什至不再考虑它了。该库并不优雅或其他任何东西，但 php 或 rpc 也不是，对吧？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-11-16T17:22:18.850

我为 PHP 5 编写了一个简单的 XML-RPC 库，称为 Ripcord。您可以在[http://ripcord.googlecode.com/](http://ripcord.googlecode.com/)下载它。它尽可能地易于使用，即使对于像 system.multicall 这样的更高级的功能也是如此。试试看。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-08T18:43:56.880

我们已经完成了一个非常强大的 RPC 库，100% 遵循 RPC 规范。您可以在 JSON-RPC-2.0 和 JSONP 之间动态切换，它还支持基于 Dojo 的 RPC 提议的批处理请求、签名请求和服务方法自省。

1.  XApp-RPC 核心包[https://github.com/XApp-Studio/xapp-Rpc](https://github.com/XApp-Studio/xapp-Rpc)
2.  示例用法：xappcommander.com

我们这样做是因为周围的一切都不符合我们的许可/质量要求。玩得开心。

# c# - 将自定义类型转换注入 .NET 库类

> ID：606854
> 
> 赞同：27
> 
> 时间：2009-03-03T15:32:45.730
> 
> 标签：c#, .net, guid

我想通过 C# 中的 Convert.ChangeType 实现两个库类之间的转换。我不能改变这两种类型。例如在 Guid 和 byte[] 之间转换。

```
Guid g = new Guid();
object o1 = g;
byte[] b = (byte[]) Convert.ChangeType(o1, typeof(byte[])); // throws exception 
```

我知道 Guid 提供了一个 ToByteArray() 方法，但我希望在 Guid 转换为 byte[] 时调用它。这背后的原因是转换也发生在我无法修改的库代码（AseDataAdapter）中。那么是否可以在不修改两个类的源代码的情况下定义两种类型之间的转换规则呢？

我正在尝试使用 TypeConverter，但似乎也不起作用：

```
Guid g = new Guid();
TypeConverter tc = TypeDescriptor.GetConverter(typeof(Guid));
byte[] b2 = (byte[])tc.ConvertTo(g, typeof(byte[])); // throws exception 
```

变量 tc 设置为 System.ComponentModel.GuidConverter，它不支持转换为 byte[]。我可以为同一个班级有两个 TypeConverter 吗？即使可以，我是否不需要在类的源代码中添加一个属性来分配 TypeConverter？

谢谢

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2009-03-03T16:03:26.983

`TypeConverter`您可以使用`TypeDescriptor.AddAttributes`;更改已注册的内容 这与 不太一样`Convert.ChangeType`，但可能就足够了：

```
using System;
using System.ComponentModel;
static class Program
{
    static void Main()
    {
        TypeDescriptor.AddAttributes(typeof(Guid), new TypeConverterAttribute(
            typeof(MyGuidConverter)));

        Guid guid = Guid.NewGuid();
        TypeConverter conv = TypeDescriptor.GetConverter(guid);
        byte[] data = (byte[])conv.ConvertTo(guid, typeof(byte[]));
        Guid newGuid = (Guid)conv.ConvertFrom(data);
    }
}

class MyGuidConverter : GuidConverter
{
    public override bool CanConvertFrom(ITypeDescriptorContext context, Type sourceType)
    {
        return sourceType == typeof(byte[]) || base.CanConvertFrom(context, sourceType);
    }
    public override bool CanConvertTo(ITypeDescriptorContext context, Type destinationType)
    {
        return destinationType == typeof(byte[]) || base.CanConvertTo(context, destinationType);
    }
    public override object ConvertFrom(ITypeDescriptorContext context, System.Globalization.CultureInfo culture, object value)
    {
        if (value != null && value is byte[])
        {
            return new Guid((byte[])value);
        }
        return base.ConvertFrom(context, culture, value);
    }
    public override object ConvertTo(ITypeDescriptorContext context, System.Globalization.CultureInfo culture, object value, Type destinationType)
    {
        if (destinationType == typeof(byte[]))
        {
            return ((Guid)value).ToByteArray();
        }
        return base.ConvertTo(context, culture, value, destinationType);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T15:43:31.443

如果执行转换的代码支持`TypeConverter`s，您可以`TypeConverterAttribute`在程序集级别使用。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-03-03T15:59:09.333

```
System.ComponentModel.ICustomTypeDescriptor 
```

是的，有可能。阅读 MSDN 上的文档以获取将其“注入”到正在运行的程序中的相关信息。（TypeDescriptor 提供方法 IIRC）。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-03-03T15:36:29.590

不幸的是，你不能——你可以编写一个扩展方法，作为框架的一部分，它*似乎是两种类型之间的转换。*

# iphone - iPhone 开发：基于视图的应用程序和基于窗口的应用程序有什么区别？

> ID：606874
> 
> 赞同：2
> 
> 时间：2009-03-03T15:36:40.760
> 
> 标签：iphone

据我了解，一个窗口有很多视图。View 是一个可以在屏幕上绘制东西的对象，而 Window 提供了绘制的空间。那么，我没有窗户的重点在哪里？他们之间有什么区别？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-03T16:00:43.260

在 iPhone 上，窗口实际上只是一种特殊的视图。如果您查看 UIWindow 类的文档，您会发现它具有超出常规 UIView 的附加方法。然而，这些方法中的大多数似乎都有类似的 UIView 对应物。

我发现 windows 有用的一件事是 UIViews 有一个“window”属性，可以用来立即访问窗口。如果您有许多嵌套视图并且需要立即从第 3 或第 4 级深度视图到达顶层，那么该窗口属性可以派上用场。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-07-22T05:45:38.343

在基于视图的应用程序中，我们可以创建前景布局和应用程序的外观，包括文本字段、按钮、标签......这取决于项目的要求以及应用程序视图必须如何有效才能使应用闪耀

在基于 Window 的应用程序中，我们拥有视图的背景，我们还可以通过使用 Interface Builder 连接来使用窗口创建视图。但是为了构建基于背景工作的应用程序，我们需要在控制台上运行基于 Window 的应用程序.

# pagination - 缩放分页器

> ID：606875
> 
> 赞同：2
> 
> 时间：2009-03-03T15:37:12.240
> 
> 标签：pagination, scaling

> << 1 2 3 4 ... 15 **16** 17 ... 47 48 49 50 >>
> 
> << 1 2 3 4 5 **6** 7 ... 47 48 49 50 >>
> 
> << 1 2 3 4 ... 44 **45** 46 47 48 49 50 >>

（粗体为选中页面）

是否有任何切割器逻辑可以创建这样的缩放分页？我之前已经创建了其中一个，但它最终变成了一团糟的逻辑语句。

我现在使用的语言是 PHP，但如果您有任何语言的示例或提示，将不胜感激。

通过缩放我的意思是当只有几页时。分页显示了这一点。

> << 1 2 3 **4** 5 6 7 >>

随着页数增长到某个点，分页将停止显示所有数字并开始将它们拆分。

> << **1** 2 3 4 ... 47 48 49 50 >>
> 
> << 1 2 3 **4** 5 6 ... 47 48 49 50 >>
> 
> << 1 2 3 4 5 **6** 7 8 ... 47 48 49 50 >>
> 
> << 1 2 3 4 .. 7 **8** 9 ... 47 48 49 50 >>
> 
> << 1 2 3 4 .. 15 **16** 17 ... 47 48 49 50 >>
> 
> << 1 2 3 4 ... 44 **45** 46 47 48 49 50 >>
> 
> << 1 2 3 4 ... 47 48 49 **50** >>

（注意，实际数字及其前后显示的数量不相关）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T15:49:33.177

抱歉，这里有一堆代码。希望评论足以告诉您它是如何工作的——如果发表评论，我可能会添加更多。

```
 /**
     * Get a spread of pages, for when there are too many to list in a single <select>
     * Adapted from phpMyAdmin common.lib.php PMA_pageselector function
     *
     * @param integer total number of items
     * @param integer the current page
     * @param integer the total number of pages
     * @param integer the number of pages below which all pages should be listed
     * @param integer the number of pages to show at the start
     * @param integer the number of pages to show at the end
     * @param integer how often to show pages, as a percentage
     * @param integer the number to show around the current page
     */
    protected function pages($rows, $pageNow = 1, $nbTotalPage = 1, $showAll = 200, $sliceStart = 5, $sliceEnd = 5, $percent = 20, $range = 10)
    {
        if ($nbTotalPage < $showAll)
            return range(1, $nbTotalPage);

        // Always show the first $sliceStart pages
        $pages = range(1, $sliceStart);

        // Always show last $sliceStart pages
        for ($i = $nbTotalPage - $sliceEnd; $i <= $nbTotalPage; $i++)
            $pages[] = $i;

        $i = $sliceStart;
        $x = $nbTotalPage - $sliceEnd;
        $met_boundary = false;
        while ($i <= $x)
        {
            if ($i >= ($pageNow - $range) && $i <= ($pageNow + $range))
            {
                // If our pageselector comes near the current page, we use 1
                // counter increments
                $i++;
                $met_boundary = true;
            }
            else
            {
                // We add the percentate increment to our current page to
                // hop to the next one in range
                $i = $i + floor($nbTotalPage / $percent);

                // Make sure that we do not cross our boundaries.
                if ($i > ($pageNow - $range) && !$met_boundary)
                  $i = $pageNow - $range;
            }

            if ($i > 0 && $i <= $x)
                $pages[] = $i;
        }

        // Since because of ellipsing of the current page some numbers may be double,
        // we unify our array:
        sort($pages);
        return array_unique($pages);
    } 
```

# c - 如何从c中的字符串数组中访问单个字符？

> ID：606879
> 
> 赞同：11
> 
> 时间：2009-03-03T15:38:24.513
> 
> 标签：c, arrays, pointers, string

只是想了解如何处理字符串数组中的单个字符。此外，这当然会让我理解指向一般下标指针的指针。如果我有`char **a`并且我想达到第二个字符串的第三个字符，这是否有效：`**((a+1)+2)`？好像应该...

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-03-03T15:41:42.197

差不多，但不完全。正确答案是：

```
*((*(a+1))+2) 
```

因为您需要首先取消对实际字符串指针之一的引用，然后再将该选定的字符串指针取消引用到所需的字符。（请注意，为了清楚起见，我在此处添加了额外的括号）。

或者，这个表达式：

```
a[1][2] 
```

也可以工作！....也许会更受欢迎，因为您尝试做的事情的意图更加不言自明，并且符号本身更加简洁。这种形式对于刚接触该语言的人来说可能不是很明显，但要理解数组表示法起作用的原因是因为在 C 中，数组索引操作实际上只是等效指针操作的简写。即：*(a+x) 与 a[x] 相同。因此，通过将该逻辑扩展到原始问题，有两个单独的指针取消引用操作级联在一起，其中表达式 a[x][y] 等价于 *((*(a+x))+ 的一般形式y)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-03T15:44:34.547

您不必使用指针。

> int main(int argc, char **argv){
> 
> printf("argv[1]的第三个字符是[%c].\n", argv[1][2]);
> 
> }

然后：

> $ ./main hello argv[1] 的第三个字符是 [l]。

那是一个和一个l。

如果你愿意，你可以使用指针......

> *(argv[1] +2)

甚至

> *((*(a+1))+2)

正如上面有人指出的那样。

这是因为数组名是指针。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-06-07T19:15:50.167

在乔恩·埃里克森 (Jon Erickson) 所著的《Hacking the art of exploit 2nd Edition》一书中有一个精彩的 C 编程解释，其中讨论了指针、字符串，仅在编程解释部分就值得一提 https://leaksource.files.wordpress.com/2014/08/ hacking-the-art-of-exploitation.pdf。

尽管该问题已经得到解答，但其他想了解更多信息的人可能会发现 Ericksons 书中的以下要点有助于理解问题背后的一些结构。

**标头**

您可能会使用可用于变量操作的头文件示例。

stdio.h - http://www.cplusplus.com/reference/cstdio/

stdlib.h - http://www.cplusplus.com/reference/cstdlib/

string.h - http://www.cplusplus.com/reference/cstring/

limits.h - http://www.cplusplus.com/reference/climits/

**职能**

您可能会使用的通用功能示例。

malloc() - http://www.cplusplus.com/reference/cstdlib/malloc/

calloc() - http://www.cplusplus.com/reference/cstdlib/calloc/

strcpy() - http://www.cplusplus.com/reference/cstring/strcpy/

**记忆**

”*编译程序的内存分为五个段：文本、数据、bss、堆和堆栈。每个段代表为某种目的而留出的特殊内存部分。文本段有时也称为代码段。这是程序的汇编机器语言指令所在的位置*“。

"*这一段指令的执行是非线性的，这要归功于前面提到的高级控制结构和函数，它们编译成汇编语言中的分支、跳转和调用指令。在程序执行时，EIP 被设置为第一条指令在文本段中。然后处理器遵循执行循环，执行以下操作：* “

" *1\. 读取EIP指向的指令*"

" *2\. 将指令的字节长度添加到 EIP* "

" *3\. 执行在步骤 1 中读取的指令*"

“ *4\. 回到第一步*”

"*有时指令会是跳转或调用指令，它将 EIP 更改为不同的内存地址。处理器并不关心更改，因为它期望执行是非线性的。如果 EIP 在步骤中更改3，处理器将返回到第 1 步并读取在任何 EIP 更改为*“.

"*文本段中的写入权限被禁用，因为它不用于存储变量，仅用于存储代码。这可以防止人们实际修改程序代码；任何尝试写入该内存段的尝试都会导致程序提醒用户：发生了不好的事情，程序将被杀死。这个段是只读的另一个优点是它可以在程序的不同副本之间共享，允许同时多次执行程序而不会出现任何问题。它还应该请注意，此内存段具有固定大小，因为其中没有任何变化*“。

" *data 和 bss 段用于存储全局和静态程序变量。data 段填充有已初始化的全局变量和静态变量，而 bss 段则填充了它们未初始化的对应部分。虽然这些段是可写的，但它们也有一个固定大小。请记住，尽管有函数上下文（如前面示例中的变量 j），全局变量仍然存在。全局变量和静态变量都能够持久存在，因为它们存储在自己的内存段中*“。

"*堆段是程序员可以直接控制的一段内存。这个段中的内存块可以被分配并用于程序员可能需要的任何东西。关于堆段的一个值得注意的点是它不是固定大小的，所以它可以根据需要变大或变小*”。

"*堆内的所有内存都由分配器和释放器算法管理，它们分别在堆中保留一个内存区域以供使用，并删除保留以允许该部分内存被重用以供以后保留。堆将增长和缩小取决于保留多少内存以供使用。这意味着使用堆分配功能的程序员可以即时保留和释放内存。堆的增长向下移动到更高的内存地址*“。

"*堆栈段也有可变大小，在函数调用期间用作临时暂存器来存储局部函数变量和上下文。这就是 GDB 的回溯命令查看的内容。当程序调用函数时，该函数将有自己的集合传递的变量，并且函数的代码将在文本（或代码）段中的不同内存位置。由于调用函数时上下文和EIP必须改变，因此堆栈用于记住所有传递的变量，函数完成后 EIP 应该返回的位置，以及该函数使用的所有局部变量。所有这些信息一起存储在堆栈中，统称为堆栈帧。堆栈包含许多“堆栈帧*”。

"*在一般计算机科学术语中，堆栈是一种经常使用的抽象数据结构。它具有先进后出 (FILO) 顺序，这意味着放入堆栈的第一项是最后一项把它想象成把珠子放在一根一端有结的绳子上——你不能把第一个珠子取下来，除非你把所有其他珠子都拿掉。当一个物品被堆成一堆时，它被称为推送，当一个项目从堆栈中移除时，它被称为“弹出*”。

”*顾名思义，内存的栈段，其实就是一个栈数据结构，里面包含栈帧。ESP寄存器用来跟踪栈尾的地址，随着item不断变化被推入并从中弹出。由于这是非常动态的行为，因此堆栈也不是固定大小是有道理的。与堆的动态增长相反，随着堆栈大小的变化，它会向上增长在内存的视觉列表中，朝向较低的内存地址*“。

"*堆栈的 FILO 特性可能看起来很奇怪，但由于堆栈用于存储上下文，因此非常有用。当调用函数时，几个东西在堆栈帧中一起被推入堆栈。EBP 寄存器 - 有时称为帧指针（FP）或局部基址（LB）指针——用于引用当前栈帧中的局部函数变量。每个栈帧都包含函数的参数、它的局部变量以及放置东西所必需的两个指针回到原来的样子：保存的帧指针 (SFP) 和返回地址。SFP 用于将 EBP 恢复到之前的值，返回地址用于将 EIP 恢复到函数调用后找到的下一条指令。恢复前一个堆栈帧的功能上下文*“。

**字符串**

“*在 C 中，数组只是特定数据类型的 n 个元素的列表。一个 20 个字符的数组就是位于内存中的 20 个相邻字符。数组也称为缓冲区*”。

```
#include <stdio.h>

int main()
{
    char str_a[20];
    str_a[0] = 'H';
    str_a[1] = 'e';
    str_a[2] = 'l';
    str_a[3] = 'l';
    str_a[4] = 'o';
    str_a[5] = ',';
    str_a[6] = ' ';
    str_a[7] = 'w';
    str_a[8] = 'o';
    str_a[9] = 'r';
    str_a[10] = 'l';
    str_a[11] = 'd';
    str_a[12] = '!';
    str_a[13] = '\n';
    str_a[14] = 0;
    printf(str_a);
} 
```

"*在前面的程序中，一个 20 元素的字符数组被定义为 str_a，并且数组的每个元素被一个一个地写入。请注意，数字从 0 开始，而不是 1。还要注意最后一个字符是一个 0* "。

" *（这也叫空字节。） 字符数组被定义了，所以给它分配了20个字节，但是这些字节中只有12个是实际使用的。最后的空字节编程用作分隔符来告诉任何处理字符串的函数都可以在此处停止操作。剩余的额外字节只是垃圾，将被忽略。如果在字符数组的第五个元素中插入空字节，则只有字符 Hello 会被打印printf() 函数*“。

"*由于在字符数组中设置每个字符很费力，而且字符串也经常使用，因此为字符串操作创建了一组标准函数。例如，strcpy() 函数会将字符串从源复制到目标，并迭代源字符串并将每个字节复制到目标（并在复制空终止字节后停止）* “。

"*函数参数的顺序类似于 Intel 汇编语法先目标后源。可以使用 strcpy() 重写 char_array.c 程序，以使用字符串库完成相同的操作。下一个版本的 char_array 程序如下所示包括 string.h，因为它使用字符串函数*“。

```
#include <stdio.h>
#include <string.h>

int main() 
{
    char str_a[20];
    strcpy(str_a, "Hello, world!\n");
    printf(str_a);
} 
```

查找有关 C 字符串的更多信息

http://www.cs.uic.edu/~jbell/CourseNotes/C_Programming/CharacterStrings.html

http://www.tutorialspoint.com/cprogramming/c_strings.htm

**指针**

" *EIP 寄存器是一个指针，在程序执行期间通过包含其内存地址来“指向”当前指令。在 C 中也使用了指针的概念。由于物理内存实际上无法移动，因此其中的信息必须复制。复制大块内存以供不同的功能或在不同的地方使用可能在计算上非常昂贵。从内存的角度来看，这也是昂贵的，因为必须在源之前保存或分配新目标副本的空间可以复制。指针是解决这个问题的一种方法。比起复制一大块内存，传递那个内存块的开头地址要简单得多*。

" *C 中的指针可以像任何其他变量类型一样定义和使用。由于 x86 架构上的内存使用 32 位寻址，因此指针的大小也是 32 位（4 字节）。通过在前面加上星号 (*) 来定义指针变量名。不是定义该类型的变量，而是将指针定义为指向该类型数据的东西。pointer.c 程序是与 char 数据类型一起使用的指针的示例，它只有 1 个字节大小*”。

```
#include <stdio.h>
#include <string.h>

int main() 
{
    char str_a[20]; // A 20-element character array
    char *pointer; // A pointer, meant for a character array
    char *pointer2; // And yet another one
    strcpy(str_a, "Hello, world!\n");
    pointer = str_a; // Set the first pointer to the start of the array.
    printf(pointer);
    pointer2 = pointer + 2; // Set the second one 2 bytes further in.
    printf(pointer2); // Print it.
    strcpy(pointer2, "y you guys!\n"); // Copy into that spot.
    printf(pointer); // Print again.
} 
```

"*正如代码中的注释所示，第一个指针设置在字符数组的开头。当这样引用字符数组时，它实际上是一个指针本身。这就是这个缓冲区作为指针传递给printf() 和 strcpy() 函数较早。第二个指针设置为第一个指针地址加二，然后打印一些东西（如下面的输出所示）* “。

```
reader@hacking:~/booksrc $ gcc -o pointer pointer.c
reader@hacking:~/booksrc $ ./pointer
Hello, world!
llo, world!
Hey you guys!
reader@hacking:~/booksrc $ 
```

" *address-of 运算符通常与指针一起使用，因为指针包含内存地址。addressof.c 程序演示了用于将整数变量的地址放入指针的 address-of 运算符。这一行显示在下方加粗*”。

```
#include <stdio.h>

int main() 
{
    int int_var = 5;
    int *int_ptr;
    int_ptr = &int_var; // put the address of int_var into int_ptr
} 
```

"*存在一个称为解引用运算符的附加一元运算符，用于与指针一起使用。此运算符将返回在指针指向的地址中找到的数据，而不是地址本身。它采用变量名前面的星号形式，类似于指针的声明。再一次，取消引用运算符存在于 GDB 和 C 中*。

"*对 addressof.c 代码的一些添加（显示在 addressof2.c 中）将演示所有这些概念。添加的 printf() 函数使用格式参数，我将在下一节中解释。现在，只关注程序输出*“。

```
#include <stdio.h>

int main() 
{
    int int_var = 5;
    int *int_ptr;
    int_ptr = &int_var; // Put the address of int_var into int_ptr.
    printf("int_ptr = 0x%08x\n", int_ptr);
    printf("&int_ptr = 0x%08x\n", &int_ptr);
    printf("*int_ptr = 0x%08x\n\n", *int_ptr);
    printf("int_var is located at 0x%08x and contains %d\n", &int_var, int_var);
    printf("int_ptr is located at 0x%08x, contains 0x%08x, and points to %d\n\n", &int_ptr, int_ptr, *int_ptr);
} 
```

“*当一元运算符与指针一起使用时，地址运算符可以被认为是向后移动，而解引用运算符则朝着指针指向的方向向前移动*”。

了解有关指针和内存分配的更多信息

加州大学计算机科学系 Dan Hirschberg 教授计算机内存 https://www.ics.uci.edu/~dan/class/165/notes/memory.html

http://cslibrary.stanford.edu/106/

http://www.programiz.com/c-programming/c-dynamic-memory-allocation

**数组**

这里有一个名为 Alex Alllain 的小伙子提供的关于多维数组的简单教程 http://www.cprogramming.com/tutorial/c/lesson8.html

这里有一个名为 Todd A Gibson 的小伙子提供的关于数组的信息 http://www.augustcouncil.com/~tgibson/tutorial/arr.html

**迭代一个数组**

```
#include <stdio.h>

int main() 
{

    int i;
    char char_array[5] = {'a', 'b', 'c', 'd', 'e'};
    int int_array[5] = {1, 2, 3, 4, 5};
    char *char_pointer;
    int *int_pointer;
    char_pointer = char_array;
    int_pointer = int_array;

    for(i=0; i < 5; i++) { // Iterate through the int array with the int_pointer.
        printf("[integer pointer] points to %p, which contains the integer %d\n", int_pointer, *int_pointer);
        int_pointer = int_pointer + 1;
    }

    for(i=0; i < 5; i++) { // Iterate through the char array with the char_pointer.
        printf("[char pointer] points to %p, which contains the char '%c'\n", char_pointer, *char_pointer);
        char_pointer = char_pointer + 1;
    }

} 
```

**链表与数组**

数组不是唯一可用的选项，有关链接列表的信息。

http://www.eternallyconfuzzled.com/tuts/datastructures/jsw_tut_linklist.aspx

**结论**

编写此信息只是为了传递我在整个研究过程中阅读的一些内容，这些内容可能对其他人有所帮助。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-03T15:44:03.830

Iirc，一个字符串实际上是一个字符数组，所以这应该工作：

```
a[1][2] 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-03T15:50:19.760

引用关于 C 指针的维基百科[文章-](http://en.wikipedia.org/wiki/Pointer#C_arrays)

在 C 中，数组索引是用指针算术形式定义的；也就是说，语言规范要求 array[i] 等价于 *(array + i)。因此，在 C 中，数组可以被认为是指向连续内存区域的指针（没有间隙），访问数组的语法与可用于取消引用指针的语法相同。例如，可以通过以下方式声明和使用数组：

```
int array[5];      /* Declares 5 contiguous (per Plauger Standard C 1992) integers */
int *ptr = array;  /* Arrays can be used as pointers */
ptr[0] = 1;        /* Pointers can be indexed with array syntax */
*(array + 1) = 2;  /* Arrays can be dereferenced with pointer syntax */ 
```

因此，针对您的问题 -**是**的，指向指针的指针可以用作数组，而无需任何其他声明！

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-03T15:42:08.467

试试`a[1][2]`。或`*(*(a+1)+2)`。

基本上，数组引用是指针解引用的语法糖。a[2] 与 a+2 相同，也与 2[a] 相同（如果您真的想要不可读的代码）。字符串数组与双指针相同。因此，您可以使用 a[1] 或`*(a+1)`. 然后，您可以使用 b[2] 或 . 在该字符串中找到第三个字符（现在称为“b”）`*(b + 2)`。将原始的第二个字符串替换为 'b'，我们最终得到 a[1][2] 或`*(*(a+1)+2)`.

# emacs - 我可以更改 Emacs 查找文件的历史记录吗？

> ID：606882
> 
> 赞同：8
> 
> 时间：2009-03-03T15:40:34.290
> 
> 标签：emacs

当我调用 find-file 打开一个新文件时，通常会发生我要查找的文件位于我已经加载的目录之一中。

理想情况下，我想使用向上/向下箭头滚动浏览历史记录。

这样做的问题是，如果我已经从一个目录加载了 10 个文件，我首先必须通过这 10 个文件，它们都在同一个目录中，然后才能看到我的文件可能所在的新目录。

最后，我经常只是再次输入目录或从 xterm 中剪切/粘贴它。

在 find-file 命令中，我可以更改向上/向下箭头的行为以遍历目录而不是文件。

或者，我可以更改文件顺序以匹配最近访问的缓冲区的顺序，而不是加载文件时的顺序吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-03T19:51:46.403

我的第一个答案是 TAB 完成在“查找文件”中不再按预期工作。但这项技术似乎仍然有用（如果你喜欢它，更可取）。

但是，此解决方案具有相同的历史行为，但在 'find-file.

我很想知道是否有办法避免建议查找文件，但我找不到任何让我知道调用了“查找文件”的内省。

```
(defadvice find-file (around find-file-set-trigger-variable protect activate)
  "bind a variable so that history command can do special behavior for find-file"
  (interactive (let (inside-find-file-command) (find-file-read-args "Find file: " nil)))
  ad-do-it)

(defadvice next-history-element (around next-history-element-special-behavior-for-find-file protect activate)
  "when doing history for find-file, use the buffer-list as history"
  (if (boundp 'inside-find-file-command)
      (let ((find-file-history (delq nil (mapcar 'buffer-file-name (buffer-list))))
            (minibuffer-history-variable 'find-file-history))
        ad-do-it)
    ad-do-it)) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-04T20:30:35.443

我建议[IDO](http://www.emacswiki.org/emacs/InteractivelyDoThings)。您可以在缓冲区列表或查找文件中搜索。在查找文件中搜索时，它在当前文件夹中没有匹配项，它会搜索历史记录。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T16:09:13.520

不是你想要的，而是

你试过（电缓冲列表）Ctrl-x Ctrl-b吗？

或（干）？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-03T18:36:11.530

这将使用缓冲区列表的历史顺序，这是您想要的。

```
(setq read-file-name-function 'my-read-file-name)
(defun my-read-file-name (prompt dir default-filename mustmatch initial predicate)
  (let ((default-directory dir)
        (files (directory-files dir))
        (history (delq nil (mapcar 'buffer-file-name (buffer-list)))))
    (completing-read prompt files predicate mustmatch initial 'history))) 
```

嗯...这改变了 find-file 的 TAB 完成的行为，因为 TAB 完成了历史记录（已经打开的文件），而不是您指定的目录中可用的文件。

让两者同时工作有点棘手......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-09-05T05:38:22.787

使用[*Icicles*](http://www.emacswiki.org/cgi-bin/wiki/Icicles)，您可以在候选文件名之间循环，并且可以通过多种方式对它们进行排序。您可以按上次使用的顺序访问它们等。

*   [http://www.emacswiki.org/emacs/Icicles__-_History_Enhancements](http://www.emacswiki.org/emacs/Icicles_-_History_Enhancements)
*   [http://www.emacswiki.org/emacs/Icicles_-_Sorting_Candidates](http://www.emacswiki.org/emacs/Icicles_-_Sorting_Candidates)
*   [http://www.emacswiki.org/emacs/Icicles_-_File-Name_Input](http://www.emacswiki.org/emacs/Icicles_-_File-Name_Input)

# c# - ViewState 维护了哪些控件？

> ID：606887
> 
> 赞同：4
> 
> 时间：2009-03-03T15:41:57.643
> 
> 标签：c#, .net, asp.net, viewstate

我试图围绕控制基础结构来了解 ASP.NET 维护哪些视图状态。

有这些常规的 HTML 控件，例如： `<input type="radio" checked="checked"/>`-> 我知道这些没有视图状态

然后是带有 runat="server" 的 HTML 控件 `<input type="radio" checked="checked" runat="server"/>`-> 在回发之间是否保持视图状态？

然后是 ASP.NET 控件 `<asp:TextBox id="txtMyText" runat="server"/>`-> 我知道这些确实有视图状态

我们有几个自定义控件继承了 HtmlTextBox `<myPrefix:myTextBox id="txtMyText" runat="server"/>`-> 这和上面的类型 2 一样吗？

假设任何带有`runat="server"`标签的控件都将保持视图状态是否安全？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-03T17:54:58.023

有 3 种类型的控件，标准的 HTML 元素，如添加了 runat=server 标签的 HTML 服务器控件，以及完整的 Web 控件。只有 Web 控件保持视图状态。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-12T23:42:14.750

当我们遇到 viewstate 问题时，我开始使用 Binary Fortress [http://www.binaryfortress.com/aspnet-viewstate-helper/的 Viewstate 帮助软件](http://www.binaryfortress.com/aspnet-viewstate-helper/)

它让您真正了解正在发生的事情 - 以及帮助解决与视图状态相关的性能问题，您可以一键解码视图状态并查看其中实际存在的内容 - 这样您就可以了解哪些控件正在使用视图状态，哪些不是t，以及他们在那里存储的确切内容。

此外，没有人提到的是 ControlState。这与 ASP.NET 2 一起出现，*理论*是控件运行所需的重要内容进入控件状态，数据等进入视图状态，因此您可以关闭视图状态并将数据绑定到您对每个回发的控制，并且该控制基本上仍然使用 controlstate 工作。我说“理论”是因为在实践中实施似乎不完整。例如，当您使用反射器查看下拉列表代码时，这没有正确实现。这可能会随着框架的后续版本而改变，我不确定。如果您搜索它，那里有很多关于 controlstate 的信息，我只是想我会提到它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-03T15:48:33.180

afaik 不，HTML 控件并非旨在维护视图状态中的任何内容，如果您关心它，请使用 webcontrols。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-06T16:41:11.720

您放在页面视图上并添加 runat="server" 的任何内容都将保持视图状态。

至于动态添加的控件，这取决于您何时以及如何将控件添加到控件树中。查看[这个问题](https://stackoverflow.com/questions/196518/problem-with-dynamic-controls-in-net/196963#196963)的公认答案，也可以[在这里查看我的问题](https://stackoverflow.com/questions/722570/how-to-pull-postback-data-into-a-dynamically-added-usercontrol-net)。

# svn - 是否有托管 SVN 提供商提供与 GitHub 相当的讨论工具？

> ID：606892
> 
> 赞同：3
> 
> 时间：2009-03-03T15:43:37.717
> 
> 标签：svn, hosting, github, collaboration

我们在工作中使用 SVN（即，这*不是*一个开源项目）并且有一个离岸团队在我们的代码中工作。我希望能够与他们更好地交流，而 GitHub 提供的评论系统将是完美的。

使用 GitHub 的系统，我可以**开始讨论提交中的任何代码行**。

所以，我的问题是：有人知道有类似工具的***托管SVN 提供商吗？***

需要明确的是，我正在专门寻找可以方便地讨论代码的讨论工具。GitHub 工具可让您在源代码浏览器中开始讨论一行代码。

我不是在寻找一个正式的同行评审工具，而是一个旨在促进关于提交中代码的对话的讨论工具。

* * *

我们目前正在使用 Assembla，他们在 Trac 存储库浏览器或他们自己开发的存储库浏览器中都没有提供这种功能。

* * *

[YouTube 上的示例](http://www.youtube.com/watch?v=BDjqQ6_LBJE)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-31T02:53:12.107

它不会被托管，但您可以设置之前由 @SilentGhost 提到的名为 Rietveld 的 Google 代码审查工具的开源版本：
[http ://code.google.com/p/rietveld/](http://code.google.com/p/rietveld/)

照原样，它在 Google AppEngine 上运行。您可以使用 AppEngine SDK 和 Apache 的 mod_proxy 自己托管它，但如果该站点要公开可见，我不建议这样做，因为 SDK 清楚地指出它不是用于生产的，因此对安全性的考虑很少。

或者，谷歌还发布了一个工具，用于将 AppEngine 应用程序转换为纯 Django 应用程序，然后您可以通过您最喜欢的 python web 运行时托管它。最重要的是，包含的演示应用程序转换实际上是 Rietveld，因此他们已经为您处理了这个问题。请参阅此处了解更多信息：
[http ://code.google.com/appengine/articles/pure_django.html](http://code.google.com/appengine/articles/pure_django.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T15:48:00.810

任何提供 Python 访问权限的主机。您可以将[Trac](http://trac.edgewall.org/)与[讨论插件一起使用](http://trac-hacks.org/wiki/DiscussionPlugin)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-01T06:04:00.130

使用[审查委员](http://www.review-board.org/)会怎么样？
放置很容易，可以通过密码轻松限制访问，并且可以与SVN接口。

我知道它不是托管服务，但是将其放置在适当的位置是如此容易，以至于它不应该成为阻碍。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-03T16:02:49.650

Google 代码提供[CodeReview](http://code.google.com/p/support/wiki/CodeReviews)功能，其中包括逐行注释和完整提交注释的可能性。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-03T00:59:11.853

我认为[Beanstalk](http://beanstalkapp.com/ "豆茎")是托管 Subversion 的最佳选择。

我认为您应该使用 git-svn 并将您的 subversion 存储库转换为 Git 并使用 github，但 Beanstalk 是迄今为止功能最好的。

祝一切顺利

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-03T15:46:43.997

我推荐[svnrepository.com](http://svnrepository.com/)。它为您安装[trac](http://trac.edgewall.org/)来管理您的项目。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-03T14:05:18.530

虽然它不是基于行的系统，但您可以使用[cvsdude和](http://cvsdude.com/screenshots/subversion-hooks.html)[Basecamp](http://www.basecamphq.com/tour)的钩子来按提交情况进行讨论。这是一个托管解决方案，您也可以使用 Lighthouse 甚至 FogBugz 来使用它。诚然，它可能更多的是用于修复错误而不是与团队本身进行交流，但我认为 Basecamp 集成可能适用于通用解决方案。不完美，但我喜欢它，所以我想我会把它扔在那里。

我认为现在没有任何东西可以逐行使用 Github - 也许这是一个很好的开始项目！实际上 cvsdude 确实为他们的企业服务提供了一个 API，所以如果你想构建自己的基本讨论系统，你可以根据我的猜测来做（我自己还没有仔细研究过）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-03T19:37:34.567

我建议您使用[Assembla](http://www.assembla.com)。只需单击一下即可获得[Subversion Repository http://www.assembla.com/catalog/12-Enhanced-Subversion-Repository-Package](http://www.assembla.com/catalog/12-Enhanced-Subversion-Repository-Package)，以后可以添加许多额外的工具以备不时之需：

# 存储库

*   [Subversion - 具有安全的 EC2 托管、漂亮的浏览器](http://www.assembla.com/catalog/1-Most-Popular---Subversion-Hosting-with-Integrated-Tickets-Package)

*   [Git - 带有漂亮的浏览器](http://www.assembla.com/catalog/21-Git-with-Integrated-Tickets---Recommended-Package)

*   水银

*   Github

*   你的 SVN 服务器

# 票证/问题

*   Assembla 敏捷工单和问题跟踪器
*   Trac，增强了团队和警报管理

# 合作

*   汇编维基
*   汇编消息
*   汇编文件
*   集合聊天
*   追踪维基

# 时间跟踪

*   项目时间报告
*   汇总时间报告
*   燃尽图
*   桌面时间跟踪器

# 管理

*   带有电子邮件警报和 RSS 的可见活动流
*   Scrum 报告
*   项目模板
*   品牌主页和空间
*   投资组合报告

# 一体化

*   REST API
*   Webhooks - 发布到任何 REST 接口
*   推特
*   日蚀米林
*   外部 SVN，Github

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-07-22T05:23:17.377

您可以[查看 InDefero](http://www.indefero.net)，它不提供代码的逐行审查，但这是 2009 年 9 月或更早的路线图。请注意，我是 InDefero 的开发人员。

# javascript - 自调用函数

> ID：606897
> 
> 赞同：4
> 
> 时间：2009-03-03T15:44:13.563
> 
> 标签：javascript, function

当我编码时：

```
var a =
function()
{
    alert("44")
    return function(){alert(33)}
}()(); 
```

此表达式是否按以下顺序计算？

1.  定义功能；
2.  将其引用指针传递给
3.  a() 被调用
4.  返回一个新的函数指针
5.  a() 再次被调用

如果是这样，为什么会出现语法错误：

```
function()
{
    alert("44")
    return function(){alert(33)}
}(); 
```

解释器首先想要一个左操作数......

但这种语法有效：

```
(
  function()
  {
    alert("44")
    return function(){alert(33)}
  };

)() 
```

外括号是什么意思？？？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T15:54:13.137

1.  **`function() { alert("44") return function(){alert(33)} }`** *你定义函数*
2.  `function() { alert("44") return function(){alert(33)} }`**`()`** *您调用该函数返回匿名函数* `function(){alert(33)}`
3.  `function() { alert("44") return function(){alert(33)} }()`**`()`** *你调用返回的函数，所以它实际上相当于* `function(){alert(33)}()`

所以整个执行相当于：

```
alert("44"); alert(33); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-03T16:04:12.767

这是语言的语法。如果要就地执行匿名函数，则必须将其括在括号中。

JS 有这些边缘情况，其中语法比你预期的更奇怪。举个例子，除非用括号括起来，否则评估具有 JSON 的字符串是行不通的。

```
// Wrong
eval("{ ... }");
// Right
eval("({ ... })"); 
```

这是语言的语法。

也就是说，我认为（这完全是恕我直言），您概述的步骤并不准确。

1.  定义和调用函数。警报（“44”）；结果发生。
2.  该函数返回另一个也被调用的函数。警报（“33”）；发生。
3.  最里面的函数不返回任何东西，所以 a 实际上是未定义的。typeof a 返回“未定义”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-01T15:11:22.023

我也只是在学习自调用函数。
我认为代码应该是3。`(function() { alert("44"); return function(){alert(33);} })()()`

# c# - 我应该为新的 CRUD asp.net 应用程序使用 SubSonic 还是 Dynamic Data？

> ID：606901
> 
> 赞同：5
> 
> 时间：2009-03-03T15:44:41.660
> 
> 标签：c#, asp.net, vb.net, subsonic, dynamic-data

我需要建立一个快速的 CRUD asp.net 站点，但这可能会成为一个更大的应用程序。[我对SubSonic](http://subsonicproject.com/)有一些经验，但是自从我用它做一个项目以来已经很久了，我不得不重新学习它。我也在考虑使用[Dynamic Data](http://www.asp.net/dynamicdata/)。有没有人对这些工具有任何经验可以告诉我应该走哪条路？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-03T16:15:17.250

这些天，我几乎在所有事情上都使用亚音速。SubSonic 的优势在于，如果您以后需要增强/扩展它，您可以在其之上构建任何您想要的抽象层——它实际上只用于一个主要目的——消除创建杂乱代码的废话。

我没有广泛使用动态数据，但从我读过的内容来看，它似乎为您创建了很多脚手架，并且它可能无法与更广泛的应用程序很好地混合。如果您需要未来的可扩展性，我推荐亚音速，但动态数据可能是严格用于通过网络维护数据库的短期一次性应用程序的方式。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-03T17:04:29.377

我以前使用过 SubSonic，就我而言，效果很好。如果您只需要一个抽象层，SubSonic 在保持设置和知识曲线非常简单的同时做得很好。我不确定动态数据，但是随着数据库的增长，使用 Subsonic 重新生成类的过程非常简单。此外，Subsonic 可以很好地与视图和存储过程配合使用，所有内容都可以从您的类中访问。本教程有助于设置数据提供者和引用。不确定动态数据是否有很大帮助。因此，如果您正在寻找快速简便的方法，我会说 SubSonic 是您的最佳选择。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-04T01:52:47.907

动态数据基本上是一种非常先进的可定制网格解决方案。如果您想通过一些额外的控件和自定义来执行 CRUD，那么这就是您要走的路。

如果您想要更复杂的逻辑，那么 SubSonic 更有意义。我认为动态数据非常适合为带有一些高级额外控件的 CRUD 设置模板。

看看 asp.net 上的一些视频以获得良好的印象。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-04T10:20:56.643

本质上它们是相同的，但是，使用 Subsonic，您可以对其进行更多自定义，并且您可以使用 T4 模板生成自己的代码来补充 subsonic 的东西。

# c# - 列表 铸造算法和性能注意事项

> ID：606902
> 
> 赞同：1
> 
> 时间：2009-03-03T15:44:54.810
> 
> 标签：c#, performance, casting, generic-list

我有以下代码

```
class Program
    {
        static void Main(string[] args)
        {
            List<A> aList = new List<A>();

            var aObj = new A();

            aObj.Go(aList.Cast<IB>());
        }
    }

    class A : IB
    {
        public void Go(IEnumerable<IB> interfaceList)
        {
            foreach (IB ibby in interfaceList)
            {
                Console.WriteLine("Here");
            }
        }
    }

    interface IB
    {
        void Go(IEnumerable<IB> interfaceList);
    } 
```

}

我最初尝试传递一个 List 但这[不起作用](http://blogs.msdn.com/ericlippert/archive/2007/10/17/covariance-and-contravariance-in-c-part-two-array-covariance.aspx)。经过[SO](https://stackoverflow.com/questions/504729/how-do-i-cast-a-listt-effectively)的大量帮助后，我发现传递 IEnumerable 是将对象作为 .ofType(IB) 传递的唯一方法。

对我来说不幸的是，在我的代码中，以下行将被执行数千次：

```
aList.Cast<IB>(); 
```

我想知道是否有人知道它是如何通过算法实现的（在 IL 中）以及它的时间顺序是什么。

也就是说，它是否比只强制转换每个项目的 foreach 循环更快，或者这正是它的作用？

**编辑**主类需要维护一个实际对象的列表。但读者只能通过界面触摸它们。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-03T15:48:54.740

您应该更改`Go`为：

```
public void Go<T>(IEnumerable<T> interfaceList)
    where T : IB
{
    foreach (IB ibby in interfaceList)
    {
        Console.WriteLine("Here");
    }
} 
```

然后你就可以不用打电话了`Cast`。我怀疑 Cast 的源代码实现非常简单，尽管我相信它在 3.5 和 3.5SP1 之间发生了变化。但是，它可能需要以正常的迭代器块方式设置新的状态机等。如果可能，最好避免它。

尽管新方法是通用的，但类型推断通常应该为您处理好它，因此您无需`T`显式指定。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-03T15:49:09.607

为什么不像这样声明列表：

```
List<IB> aList = new List<IB>(); 
```

有什么特别需要你列出具体类的吗？

* * *

因此，在这种情况下，我会将列表作为域的一部分。拥有像 IIBCollection 这样的接口（例如），公开您希望读者能够访问的方法。例如：

```
interface IIBCollection{
    IEnumerable<IB> IBs { get; }
}

// and in your implementation you can do

IEnumerable<IB> IBs { 
    get { 
        foreach(IB ib in innerList) yield return ib; 
}} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T15:49:33.693

它在内部实现为 CastIterator，它比强制转换每个项目的 foreach 稍慢。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T15:53:57.723

Cast 方法只会遍历列表并转换每个项目。

如果您要使用列表数千次，只需将转换结果存储为列表即可。

如果这是不可能的（即您每次都更改列表），请考虑使用 a`List<IB>`而不是 a `List<A>`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-03T15:54:48.250

这不是 C# 中的协方差的用途吗？我看不到您要做什么，所以我无法评论为什么它被执行了数千次。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-03T15:56:10.977

只需对这两种方法（Cast 扩展方法和带有强制转换的 for 循环）进行基准测试，这将是一件相当简单的事情。但是鉴于 Cast 是 Enumerable 类的扩展方法并且一般处理 IEnumerables，我想这正是它的实现。如果您想要最快的速度，最好实现您自己的专门用于 List 的扩展方法（通过其索引获取每个元素），考虑到迭代器的开销，这应该会稍微快一些。尽管如此，这两种方法都应该花费 O(n) 时间，所以差异应该不会很大。尽管如此，这是值得进行基准测试的东西......

# c# - DotNetZip：使用 C# 权限问题创建 zip

> ID：606908
> 
> 赞同：0
> 
> 时间：2009-03-03T15:47:23.480
> 
> 标签：c#, macos, permissions, zip, dotnetzip

我正在使用 DotNetZip，并注意到我在 Mac 上遇到了权限问题。这似乎只在我使用内容处置时发生。

即如果我只是将它保存到磁盘

```
using (ZipFile zip = new ZipFile(@"C:\zip\temp.zip"))
{
   // this works fine
} 
```

但是如果我像这样使用内容配置，则在 mac 上，用户权限被拒绝（每个人组都未选中）

```
Response.ContentType = "application/zip";
Response.AddHeader("content-disposition", "filename=" + filename);

using (ZipFile zip = new ZipFile(Response.OutputStream))
{
    // 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-24T05:06:56.700

您可以尝试将 ApplicationType 更改为“application/octet-stream”。信不信由你，这对我来说已经解决了问题。无论如何都值得一试。

最大的问题是如何从 Mac 端请求文件？如果它是提供文件的 Windows Web 服务器，则 Windows 无法在客户端设置权限。如果它是网络浏览器（Safari/Firefox），它们可能只是在默认设置下运行。因此，了解从 Mac 请求文件的内容可能有助于获得正确的答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T16:11:11.910

这可能有几个原因，但我的猜测是mac上的框架中有一个错误。在 Mac 上，我假设您使用的是单声道，因此请联系 Mono 组，看看他们要说什么。他们也有一个相当不错的[论坛](http://www.go-mono.com/forums/)，看看他们要说什么。

最后，如果您使用“content-disposition”遇到错误，请不要使用“content-disposition”，并使用它的工作方式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-05T05:35:12.200

我不知道它是否与 DotNetZip 有任何关系，但现在有更高版本的库 - v1.7。它进行 AES 加密、ZIP64 和其他一堆东西。v1.8 版本具有一些新的酷炫 Seelctor 功能，以及 GZipStream 的替代品。

# php - 图像循环仅返回一张图像，但应全部返回

> ID：606910
> 
> 赞同：0
> 
> 时间：2009-03-03T15:48:10.170
> 
> 标签：php

```
function all_images(&$post){
$content = $post->post_content;
if(preg_match_all('/<img[^>]+src="(.*?)"[^>]*>/', $content, $results)){
    $i = 0;
    $count = count($results);
    $count = $count - 1;
    while($i < $count)
    {
        foreach($results as $result){
            echo $result[$i];
        }
        $i++;
    }
  }
} 
```

上面的循环设法从原始文本中获取所有图像。但是，它只返回一张图像。我尝试了几种不同的 while() 和 foreach() 组合，但它只返回一个图像。有谁知道我做错了什么？谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-03T15:56:32.757

$results[1] 应该是第一个带括号的子模式上所有匹配项的数组，所以像这样简单的东西应该可以工作：

```
if(preg_match_all('/<img[^>]+src="(.*?)"[^>]*>/i', $content, $results)){
    foreach($results[1] as $src)
    {
       echo "src is $src<br>";
    }        
} 
```

请注意，我使用 /i 修饰符使匹配不区分大小写，这可能会对您有所帮助。

您可能还想提供一些您尝试匹配的示例内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T15:57:12.987

你为什么要 $count = $count - 1？

你应该能够做到这一点：

```
if(preg_match_all('/<img[^>]+src="(.*?)"[^>]*>/', $content, $results)){
    foreach($results[1] as $result)
    {
        echo $result;
    }
  }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T15:57:45.607

您必须考虑由返回的数组的结构[`preg_match_all`](http://docs.php.net/preg_match_all)。所以试试这个：

```
function all_images(&$post)
{
    $content = $post->post_content;
    if (preg_match_all('/<img[^>]+src="(.*?)"[^>]*>/', $content, $results)) {
        // $results[0] contains the whole match of the regular expression
        foreach ($results[0] as $result) {
            echo $result;
        }
    }
} 
```

# asp.net-mvc - 带有 MVC RC 刷新的 VaryByParam="None" 的 OutputCache 错误

> ID：606915
> 
> 赞同：0
> 
> 时间：2009-03-03T15:49:13.130
> 
> 标签：asp.net-mvc, outputcache

在使用 ASP.NET RC 刷新[而](https://stackoverflow.com/questions/323458/asp-net-mvc-outputcache-doesnt-work-for-root-uri/325093)`VaryByParam=""`不是`VaryByParam="None"`.

缓存工作，但页面[http://www.yoursite.com](http://www.yoursite.com)和[http://www.yoursite.com/home/index](http://www.yoursite.com/home/index)似乎将被单独缓存。

`VaryByParam=""`和 和有什么不一样`VaryByParam="None"`？

编辑：我的意思`VaryByParam=""`不是 VaryByParam="*" 因为 VaryByParam="*" 的错误仍然存​​在

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-03T15:54:04.603

VaryByParam="*" 将为传递的每个不同参数创建一个新缓存。
VaryByParam="None" 将创建一个且仅一个缓存，无论参数如何。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-09-30T10:01:55.923

路由元素不被视为 OutputCache 的参数。

[asp.net 中的 VaryByParam 是什么？](https://stackoverflow.com/questions/1899728/what-is-varybyparam-in-asp-net)

# xslt - 使用 xslt、js 和 css 转换 xml 使用什么

> ID：606916
> 
> 赞同：0
> 
> 时间：2009-03-03T15:49:29.230
> 
> 标签：xslt, browser

我想转换一个 xml 文件，在 html 页面上显示它的树视图。我已经下载了一个例子，它有 xslt、js、css 和一些图像。我使用 xmlspy 进行转换，但它不起作用。

谁能告诉我如何进行转换？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T15:59:05.790

我猜[这是](http://skew.org/xml/stylesheets/treeview/html/)您正在使用的示例。在这种情况下，您不必使用 XMLSpy 进行转换。较新的浏览器将内置 XSLT 处理器！尝试使用最新版本的[Firefox](http://getfirefox.com)或[IE](http://www.microsoft.com/windows/products/winfamily/ie/default.mspx)！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T16:00:39.470

如果您发现（像我一样）在浏览器中做尽可能多的事情更容易，请查看 Johann Burkard 的 xslt.js：

[http://johannburkard.de/software/xsltjs/](http://johannburkard.de/software/xsltjs/)

您可以直接在浏览器中进行/测试您的转换:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T15:52:10.503

W3Schools对如何使用 XSL 转换 XML有[很好的解释。](http://www.w3schools.com/xsl/xsl_transformation.asp)

**[编辑]**重新阅读您的问题后，您似乎正在寻找一种工具来将 XSL 应用于您的 XML 文件并输出结果？您是否已经尝试过[XML Notepad 2007](http://www.microsoft.com/DownLoads/details.aspx?FamilyID=72d6aa49-787d-4118-ba5f-4f30fe913628&displaylang=en)？

# c# - 奇怪的 .Net 无法加载程序集错误

> ID：606919
> 
> 赞同：1
> 
> 时间：2009-03-03T15:49:38.060
> 
> 标签：c#, .net, iis

我有一个发送电子邮件的超级基本表单。该代码包含在新服务器上的虚拟目录中，例如[http://url/emailer/emailer.aspx](http://url/emailer/emailer.aspx)，并且运行良好。

我们正在将一些额外的站点迁移到这个新服务器上。为了进行测试，我通过 IP 地址访问文件，以便可以在新服务器上看到该站点，例如[http://ip/url/emailer/emailer.aspx](http://ip/url/emailer/emailer.aspx)。

出于某种原因，每当我通过 IP URL 访问 aspx 页面时，我都会收到“*无法加载程序集...确保在访问页面之前编译它*”错误。但是，我已经确认当被拉入实时站点时，它工作正常。

为什么引用 IP URL 会导致此异常？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T15:52:33.403

是否在 IIS 中正确设置？如果它没有以与原始服务器相同的方式设置为应用程序，那么它将在不同的位置寻找 bin 目录。例如，如果您将 /myapp 作为目录，但不是应用程序，它将在 /bin 中查找，但如果您将其更改为应用程序，它将在 /myapp/bin 中查找。

我唯一一次看到这种情况是为 2 个不同的应用程序指定了相同的应用程序池，每个应用程序都设置为运行不同版本的框架。听起来这不是您的问题，但可能值得检查应用程序池身份，以防在 ip 上侦听可能使用不同框架版本的其他东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T15:53:42.730

这可能是 IIS 问题。有时会设置 IIS，以便 IP 地址本身指向另一个站点，因为您在同一台服务器上拥有多个网站/应用程序，并且有些人对正确解析的 URL 很挑剔。

您能否检查应用程序的 IIS 设置并查看 IP 地址是否映射到您的站点？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T16:36:11.863

当我所在的服务器磁盘空间不足时，我有时会遇到这个问题。该站点尝试加载引用的 DLL，但没有足够的可用空间来执行此操作，然后引发此错误。

只是要检查的东西。这发生在我的分区驱动器上，其中 C:\ 驱动器基本上被 Windows 更新填满，即使站点位于 D:\ 驱动器上，C:\ 上也没有足够的空间供 IIS 加载组件。

# amazon-web-services - ec2机器有多稳定？

> ID：606933
> 
> 赞同：11
> 
> 时间：2009-03-03T15:52:45.853
> 
> 标签：amazon-web-services, amazon-ec2

在 Amazon ec2 中，正在运行的机器实例多久会崩溃一次？有没有人经历过这个？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-03T19:50:15.500

我们在 EC2 上运行我们公司的基础设施（企业网站、JIRA、Confluence 和 Subversion）；大约 6 个月以来，我们的任何一台机器都没有中断过。自从 EC2 去年 10 月推出 Beta 版以来，他们就有了适当的[SLA](http://aws.amazon.com/ec2-sla/)。

您可以做一些事情来缓解 ec2 中断：

*   为您的确切配置创建一个机器映像 (AMI)，以便您可以在出现故障时立即启动一个新实例（并确保您可以在需要之前成功实例化您的新 AMI！）
*   将关键数据存储在[Elastic Block Store](http://aws.amazon.com/ebs/)卷上；即使 EC2 实例出现故障，这些仍然存在，并且比物理硬盘驱动器更可靠，因为它们的数据被复制。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-03T15:58:56.540

我已经使用 EC2 大约 6 个月了。去年他们不时崩溃（我跑了 4 次，平均一个月左右一次崩溃）。在过去的 3 个月里，我们根本没有发生过崩溃。我想说亚马逊确实加强了那里的基础设施，因为 EC2 现在已经退出测试版。

布鲁斯

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T15:59:36.447

几天来我已经运行了大约 10 个实例，它们运行良好，没有崩溃。它们运行非常稳定。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-04T07:09:19.783

我有一个 Windows Server 2003 实例运行了大约 3 个月，没有任何崩溃。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-10-14T02:16:49.283

我已经有一个 Ubuntu 8.04 实例近一年（今天 354 天）零大惊小怪。我将它用作我的 Web 开发项目的测试服务器。它只消失了一次，我所要做的就是重新启动它。

# c++ - 如何更正该程序执行的错误？

> ID：606940
> 
> 赞同：0
> 
> 时间：2009-03-03T15:54:08.690
> 
> 标签：c++

我已经尝试了一切，这是我的第一个 C++ 程序，但结果不正确。我收到两条错误消息。`error7:1 warning: character constan too long for its type.`和`7:error: expe`

```
//My first C++ program
#include <iostream>
int main():
{
    "-std::cout << "I will get it" << -std::cout::end1";
    "-std::cout << "I hope so" << -std::end1;
    return(0);
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-03T15:56:51.770

您的代码应该像这样固定：

```
#include <iostream>
int main()
{
    std::cout << "I will get it" << std::endl;
    std::cout << "I hope so" << std::endl;
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-03T15:57:20.193

您的引用完全错误，并且`:`后面有一个虚假的“”字符`main()`。您还有一些不需要的额外`'-'`字符。最后，在一种情况下，您指定`std::end1`了您想要的位置`std::endl`，而在另一种情况下，您指定 `std::cout::end1`了 (a `'1'`where you want a `'l'`) `std::endl`。感谢 Scottie T 的接球。

我相信你想要：

```
//My first C++ program
#include <iostream>
int main()
{
    std::cout << "I will get it" << std::endl;
    std::cout << "I hope so" << std::endl;
    return(0);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T15:58:14.233

看起来您正在为示例添加标点符号。在编程语言中，你必须准确地输入你给出的内容。

```
'int main()' 
```

不一样

```
int main() 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T16:02:55.720

此外，您可以声明

```
using namespace std; 
```

前

```
int main() 
```

而且您不需要`std::`每次都输入。

# internet-explorer-6 - IE6 中的页脚重叠内容

> ID：606941
> 
> 赞同：0
> 
> 时间：2009-03-03T15:54:13.103
> 
> 标签：internet-explorer-6

我有一个页脚与 Internet Explorer 6 中的内容重叠的页面。我将路径附加到屏幕截图、css 文件。

[http://shivanand.in/temp/overlapping-footer.gif](http://shivanand.in/temp/overlapping-footer.gif)
[http://shivanand.in/temp/skin.css](http://shivanand.in/temp/skin.css)
[http://shivanand.in/temp/skin-ie.css](http://shivanand.in/temp/skin-ie.css)

我试图解决 2 小时以来没有解决方案。我今天需要修复它。如果您有解决方案，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T16:06:10.750

Try this

[Footerstick](http://www.themaninblue.com/experiment/footerStickAlt/)

The second version, not the first one. It woks with both long and short content.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T16:01:20.623

如果不知道 (X)HTML 布局，我不能说太多，但您的内容似乎有一个绝对的位置。

绝对定位的元素不会影响页面布局，因此您的页脚位于内容上方是正常的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T16:02:41.197

你可以申请

> 明确：两者

到页脚。

# c# - 以编程方式访问样式以获取值

> ID：606943
> 
> 赞同：2
> 
> 时间：2009-03-03T15:54:42.137
> 
> 标签：c#, asp.net, stylesheet

在我们的应用程序中，我们有样式表来定义常用颜色等……我编写了一个快速而肮脏的函数，我从存储过程中获取数据集，删除我不想显示的列，将其塞进以编程方式生成的 DataGrid ，设置 DataGrid 的样式，然后将其导出到 Excel。每个人都喜欢 Excel 输出中的颜色（喘气！它们与 DataGrid 颜色相匹配，等等等等……）。

我想添加的最后一点是，我想以编程方式访问样式并从中获取颜色代码和其他项目（.IntranetGridHead），而不是对它们进行硬编码，这就是我现在正在做的事情。

```
int iHeaderColor = Convert.ToInt32 ("D0D7E8", 16);
DataGrid dg = new DataGrid();
dg.DataSource = dsReturnDataSet.Tables[0].DefaultView;
dg.DataBind();

dg.HeaderStyle.BackColor = System.Drawing.Color.FromArgb(iHeaderColor);
dg.HeaderStyle.Font.Bold = true;
dg.HeaderStyle.Font.Size = 10; 
```

显然，每当公司进行另一次“品牌重塑”并且样式表值发生变化时，excel 颜色会自动匹配，我会得到一个很大的（拍拍背||cookie）。

来自比我了解更多的 C# 人的任何想法（你们中的大多数人……）？
谢谢，
迈克尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T17:35:48.680

所有 Web.UI.Control 对象都有一个 .Styles 属性，可以作为 Styles["Name"] 访问。因此，您可以这样做：

```
DataTable dt = LookupStyles();
dg.Styles.Clear();
foreach (DataRow dr in dt.Rows)
  dg.Styles.Add(dr["StyleName"].ToString(), dr["StyleValue"].ToString()); 
```

几个月前我也有类似的想法 :) 请注意，要使其正常工作，您的网格必须是 runat="server"。

编辑：看起来您想阅读网格并使用它...如果您使用的是 .CssStyle 和样式表 (.css)，则必须对该 css 文件执行 HTTP GET 并自行解析。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T16:37:41.160

您必须自己解析 CSS 文件，而 IIRC 在 .NET 框架中没有现成的 CSS 文件解析器。但是，您可以在这里找到一个免费的：

[http://www.codeproject.com/KB/recipes/CSSParser.aspx](http://www.codeproject.com/KB/recipes/CSSParser.aspx)

然后，您应该能够使用它来解析 CSS 文件。从那里您应该能够获取样式和值并将其应用于您的数据网格。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-04T23:41:14.783

不久前，我按照这些思路写了一些东西。它涉及处理 CSS 文件的 HttpHandler，更改 IIS 配置以使 asp.net 接收 CSS 文件的请求，以及包含我的颜色定义的简单 xml 文件结构。但是你已经用数据库做到了，这也很好。

然后在CSS中我有这样的东西......

```
.button
{
    background-color: $colours:button-background-colour;
    color: $colours:button-text-colour;
} 
```

用我的 xml 定义按钮背景颜色和按钮文本颜色的值。我使用正则表达式文本替换来处理 CSS 文件，替换为 xml 文件中的相关值。

我相信您可以采用其中的一些想法并将其与您现有的代码结合起来以获得所需的效果。您当然需要处理数据库/xml 文件的缓存和更改。

希望有帮助。

如果您需要任何关于其中的任何指针，那么我相信我可以挖掘出一些示例代码。

# python - Django 覆盖表单

> ID：606946
> 
> 赞同：2
> 
> 时间：2009-03-03T15:55:21.557
> 
> 标签：python, django, forms

关于某些表格的另一个问题

这是我的模型

```
class TankJournal(models.Model):
    user = models.ForeignKey(User)
    tank = models.ForeignKey(TankProfile)
    ts = models.IntegerField(max_length=15)
    title = models.CharField(max_length=50)
    body = models.TextField() 
```

这是我的模型

```
class JournalForm(ModelForm):
    tank = forms.IntegerField(widget=forms.HiddenInput()) 

    class Meta:
        model = TankJournal
        exclude = ('user','ts') 
```

这是我的保存方法

```
def addJournal(request, id=0):
    if not request.user.is_authenticated():
        return HttpResponseRedirect('/')

    #
    # checking if they own the tank
    #
    from django.contrib.auth.models import User
    user = User.objects.get(pk=request.session['id'])

    if request.method == 'POST':
        form = JournalForm(request.POST)

        if form.is_valid():
            obj = form.save(commit=False)

            #
            # setting the user and ts
            #
            from time import time
            obj.ts = int(time())
            obj.user = user
            obj.tank = TankProfile.objects.get(pk=form.cleaned_data['tank'])

            #
            # saving the test
            #
            obj.save()

        else:
            print form.errors

    else:
        form = JournalForm(initial={'tank': id}) 
```

当它保存时..它抱怨坦克不是TankProfile而是一个整数..我怎样才能覆盖表单对象以使坦克成为TankProfile

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-03T16:17:01.007

我想你想要这个：

```
class JournalForm(ModelForm):
    tank = forms.ModelChoiceField(label="",
                                  queryset=TankProfile.objects.all(),
                                  widget=forms.HiddenInput) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T16:11:01.253

你为什么要推翻坦克的定义？

```
class JournalForm(ModelForm):
    tank = forms.IntegerField(widget=forms.HiddenInput()) 
```

如果你省略了这个覆盖，Django 会为你处理外键引用。

“如何覆盖表单对象以使 tank 成为 TankProfile？”

我不明白这个问题，因为看起来您专门覆盖了表单以防止外键工作。

# sharepoint - SharePoint 文档库

> ID：606948
> 
> 赞同：3
> 
> 时间：2009-03-03T15:55:52.443
> 
> 标签：sharepoint, document

我可以链接到 SharePoint 文档库中的特定文档吗？截至目前，我只能链接到整个文档库，而不是其中的特定文档。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-03T15:57:47.557

右键单击文档并选择“复制快捷方式”。那是你的链接。您也可以单击下拉菜单 -> 发送至 -> 发送链接以将链接直接通过电子邮件发送给某人。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-05T21:08:07.170

更重要的是，您甚至可以通过在文档上使用“发送到”来在文档上创建“符号链接”，然后选择要在其中显示文档“副本”的文档库。您可以选择是否希望 SharePoint 在您每次更新原始文档时提醒您将更改从原始文档更改为副本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T15:57:35.983

当然，只需附加文件名...

# asp.net - 在自定义 404 错误页面中获取失败的 url

> ID：606949
> 
> 赞同：-1
> 
> 时间：2009-03-03T15:56:08.123
> 
> 标签：asp.net, redirect, http-status-code-404

是否可以从自定义 404 错误页面获取失败请求的 URL？我正在使用 IIS 将自定义错误页面设置为要处理失败请求的 .net 页面。

我尝试使用请求对象中的 url 和 referer 属性，但它们不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T15:59:29.753

尝试使用您的 web.config 指向自定义错误页面并忽略 IIS 设置。看看你是否得到了推荐人。

# asp.net - OutputCache 和 RenderAction 缓存整个页面

> ID：606962
> 
> 赞同：7
> 
> 时间：2009-03-03T15:58:32.610
> 
> 标签：asp.net, asp.net-mvc, caching

我有一个包含`<% Html.RenderAction<MyController>(c => c.SidebarStats()); %>`. 在操作 SidebarStats 的控制器操作上，我有一个 OutputCache 操作过滤器来仅缓存页面的该部分。但是，整个页面都被缓存了，而不仅仅是那个动作。

我记得在某处看到这可能是 ASP.NET MVC 的一个错误，尽管我不确定。我目前正在使用 ASP.NET MVC RC1、IIS7、Windows Server 2008 和 .NET 3.5 SP1。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-13T06:29:36.610

我在[这里写了一个解决这个问题](http://haacked.com/archive/2009/05/12/donut-hole-caching.aspx)的方法。这很简单，但只有在您使用 WebFormViewEngine 时才有效。我们将努力弄清楚如何才能使这项工作适用于所有视图引擎。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T16:12:27.023

根据微软的说法，这是一个没有已知修复的已知错误。建议的唯一解决方法是创建您自己的 OutputCache 操作过滤器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-10-04T12:45:45.310

我现在正在使用**史蒂夫·桑德森**在[他的博客](https://blog.stevensanderson.com)中所做的，非常好：

```
public class ActionOutputCacheAttribute : ActionFilterAttribute
{
    // This hack is optional; I'll explain it later in the blog post
    private static readonly MethodInfo _switchWriterMethod = typeof (HttpResponse).GetMethod("SwitchWriter",
                                                                                             BindingFlags.Instance |
                                                                                             BindingFlags.NonPublic);

    private readonly int _cacheDuration;
    private string _cacheKey;
    private TextWriter _originalWriter;

    public ActionOutputCacheAttribute(int cacheDuration)
    {
        _cacheDuration = cacheDuration;
    }

    public override void OnActionExecuting(ActionExecutingContext filterContext)
    {
        _cacheKey = ComputeCacheKey(filterContext);
        var cachedOutput = (string) filterContext.HttpContext.Cache[_cacheKey];
        if (cachedOutput != null)
            filterContext.Result = new ContentResult {Content = cachedOutput};
        else
            _originalWriter =
                (TextWriter)
                _switchWriterMethod.Invoke(HttpContext.Current.Response,
                                           new object[] {new HtmlTextWriter(new StringWriter())});
    }

    public override void OnResultExecuted(ResultExecutedContext filterContext)
    {
        if (_originalWriter != null) // Must complete the caching
        {
            var cacheWriter =
                (HtmlTextWriter)
                _switchWriterMethod.Invoke(HttpContext.Current.Response, new object[] {_originalWriter});
            string textWritten = (cacheWriter.InnerWriter).ToString();
            filterContext.HttpContext.Response.Write(textWritten);

            filterContext.HttpContext.Cache.Add(_cacheKey, textWritten, null,
                                                DateTime.Now.AddSeconds(_cacheDuration), Cache.NoSlidingExpiration,
                                                CacheItemPriority.Normal, null);
        }
    }

    private string ComputeCacheKey(ActionExecutingContext filterContext)
    {
        var keyBuilder = new StringBuilder();
        foreach (var pair in filterContext.RouteData.Values)
            keyBuilder.AppendFormat("rd{0}_{1}_", pair.Key.GetHashCode(), pair.Value.GetHashCode());
        foreach (var pair in filterContext.ActionParameters)
            keyBuilder.AppendFormat("ap{0}_{1}_", pair.Key.GetHashCode(), pair.Value.GetHashCode());
        return keyBuilder.ToString();
    }
} 
```

请访问[Steve Sanderson 博客文章](https://blog.stevensanderson.com/2008/10/15/partial-output-caching-in-aspnet-mvc/) 了解更多信息。

# .net - Windows 托管的 WCF 服务可以使用 HTTPS 吗？

> ID：606965
> 
> 赞同：4
> 
> 时间：2009-03-03T15:58:54.933
> 
> 标签：.net, wcf

我有一个在端点上使用 webHttpBinding 的 WCF 服务，并且 WCF 服务作为 Windows 服务托管。是否可以通过使用 HTTPS 或其他方法在传输级别保护它？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-03T16:21:30.247

是的 - 如果您愿意，您可以使用 HTTPS 甚至 SSH 隧道。

[这是 MSDN 页面](http://msdn.microsoft.com/en-us/library/ms733768.aspx)，它解释了如何为 HTTPS 配置 WCF。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T16:19:43.463

我没有尝试使用 Windows 服务来执行此操作，但这是我使用 IIS 和共享证书成功保护 WCF 服务的方法。最大的区别是，它不是作为 Windows 服务在注册表中，而是由 ASP.net 托管的 .svc 文件，并且您的服务实现必须将 AspNetCompatibilityEnabled 属性标记为 TRUE

*   ~~[服务器配置](http://pastie.org/406026)~~
*   ~~[客户端配置](http://pastie.org/406035)~~

也可以看看：

*   [堆栈溢出文章](https://stackoverflow.com/questions/335719/how-can-i-configure-wcf-to-use-x509-certificates-over-the-internet)
*   [msdn文章](http://msdn.microsoft.com/en-us/library/ms751427.aspx)
*   ~~[wcf 安全模式](http://wcfsecurity.codeplex.com/Wiki/View.aspx?title=How%20Tos)~~

# iphone - iphone QuickTime 错误

> ID：606968
> 
> 赞同：2
> 
> 时间：2009-03-03T15:59:01.453
> 
> 标签：iphone, quicktime

我尝试在我的 Mac 中播放简单的 mp3 文件 iPhone 模拟器。我使用 AVFoundation.framework 和 AVAudioPlayer。在我的一台 Mac 上一切正常，但在另一台 Mac 上，当我构建应用程序（模拟器 2.2）时出现错误：

错误是：

```
Error loading /Library/QuickTime/DivX Decoder.component/Contents/MacOS/DivX Decoder:  dlopen(/Library/QuickTime/DivX Decoder.component/Contents/MacOS/DivX Decoder, 262): Symbol not found: _SCDynamicStoreCopyConsoleUser
 Referenced from: /System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/LangAnalysis.framework/Versions/A/LangAnalysis
 Expected in: /Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator2.2.1.sdk/System/Library/Frameworks/SystemConfiguration.framework/Versions/A/SystemConfiguration 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-28T23:21:42.913

实际上你确实有 DivX，但它缺少一个符号，你需要删除 /Library/QuickTime/DivX Decoder.component

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T16:03:03.503

您的其他 Mac 中似乎没有安装 DivX 解码器包 (DivX Decoder.component)。

我检查了我的mac，我也没有它，所以它是你自己安装的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T16:03:52.160

看起来 DivX 编解码器未安装在其他 Mac 上。 [安装 DivX](http://www.divx.com/en/products/software/mac/divx)，您应该一切就绪。

# ms-access - 根据其他值禁用复选框

> ID：606976
> 
> 赞同：4
> 
> 时间：2009-03-03T16:00:26.100
> 
> 标签：ms-access

我有一个相对简单的连续表格。有一个看不见的复选框，我们就叫它弗兰克吧。

还有第二个复选框 (Ralph)，它可能是 True 或 False。还有一个带有日期的文本框 (RalphDate)。

如果 Frank 是 True，我不希望用户能够更改 Ralph 或 RalphDate，不管已经存在什么。

现在，RalphDate 很简单，因为我只使用条件格式来检查启用或禁用 RalphDate 的 Frank 的值。此选项不适用于复选框。

我现在卡住了，因为使用一些 Visual Basic 会根据遇到的第一个 Frank 值的值将所有 Ralph 框的状态设置为相同。因此，问题是如何根据 Frank Check Box 为 True 仅禁用关联的 Ralph Check Box？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-03T17:14:16.250

**解决方案 1**

*   更新`Locked`属性而不是`Enabled`ckRalph。
*   在表单的 OnCurrent() 事件处理程序中执行此操作。

Locked 属性将阻止没有视觉提示的更改。这应该照顾功能部分，即使在视觉上该复选框仍将*看起来*已启用，但无法更改。

**解决方案 2**

另一种方法是通过这样做来模拟复选框：

*   使用文本框，称之为 fakeckRalph；把它变成一个小正方形。
*   使其记录源属性类似于' `=getstate()`'
*   创建一个执行以下操作的`getstate`函数：

    ```
    Public Function GetState() as string
        GetState = iif(ckRalph, "V", " ")
    End Function 
    ```

我建议使用符号字体和字符来使刻度在其框中显示得更好。
所以现在，如果你的*Ralph*为真，复选框将显示勾号，如果不是，它将为空。

*为了完成这个技巧，当Franck*为真时，使用文本框上的条件格式来禁用它。
为了使点击更加逼真，还将光标更改为手形指针。

最后需要做的是从我们的`fakeckRalph`文本框中连接 OnClick 事件，以便我们可以切换 Ralph 的状态并正确显示它：

```
Private Sub OnClick()
    Ralph = Not Ralph
    fakeckRalph.Requery
End Sub 
```

我使用了类似的技术来显示连续表单上的记录是否被锁定（使用来自 Windings 字体之一的蓝色挂锁符号）或可删除，并带有一个可以单击的大红十字：

[图 2 http://img9.imageshack.us/img9/6296/sshot2do5.png](http://img9.imageshack.us/img9/6296/sshot2do5.png) [图 1 http://img8.imageshack.us/img8/4997/sshot1ya5.png](http://img8.imageshack.us/img8/4997/sshot1ya5.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-04T05:04:48.600

这是连续形式的缺点之一，没有办法绕过它。

一般来说，我避免使用可编辑的连续表单——我只使用它们来显示列表，并使用链接到连续表单的 PK 的可编辑子表单来显示当前数据以进行编辑。

这避免了特定控件的条件显示的所有问题，因为您只需以连续形式显示数据，并且可以准确控制在单个详细信息子表单中可见/启用的内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T16:38:17.787

简短的回答是，如果您使用连续表格，则不能这样做。更改控件的设置会更改所有行的设置。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-06-10T21:21:32.940

将 Ralph 的控制源设置为一个函数，例如`=GetCheckState()`. 然后创建一个这样的函数：

```
Public Function GetCheckState() as boolean
    If Frank then
        GetCheckState = True
    Else
        GetCheckState = False
    End If
End Function 
```

这将根据 Frank 控制是否检查 Ralph。由于复选框绑定到函数，它不会让您通过单击它来更改值。

要对用户单击该框做出反应，请将代码添加到 On Mouse Up 事件：

```
Private Sub Ralph_MouseUp(Button As Integer, Shift As Integer, _
    X As Single, Y As Single)
    If Button = acLeftButton And Not Frank Then
        Frank = True
    End If
    Ralph.Requery
End Sub 
```

当控件源是函数时，Click 事件似乎完全被忽略，因此您必须改用 On Mouse Up（如果您愿意，On Mouse Down 也可以使用）。如果您希望该框在用户按下空格键或回车键时检查，您还可以将类似的代码添加到 KeyDown 事件。

唯一的缺点是：

*   无法单击时，该框不会变灰。
*   Access 将在状态栏中显示一条消息，说明由于单击控件时绑定的表达式，无法编辑控件。

对于第一点，如果您认为人们会感到困惑，您可以弹出一条解释它的消息。对于第二个，可能有办法解决它，但我找不到它。即使我尝试在 Mouse Down 和 Mouse Up 事件中设置自己的状态消息，该消息仍然出现。

如果在禁用时使该框变灰对您来说非常重要，那么这将不起作用，但我对接受的答案中建议的“模拟”复选框的外观和感觉不满意。这种方法允许我根据其他记录控制复选框的功能，并且仍然使用实际的复选框。

# c# - 使用 <%# isChecked %> 表达式设置复选框

> ID：606984
> 
> 赞同：1
> 
> 时间：2009-03-03T16:02:06.563
> 
> 标签：c#, .net, asp.net

这是我要实现的目标的简化示例；

```
<asp:CheckBox runat="server" Checked="<%# this.isChecked %>" id="myCheckBox" /> 
```

然后在我的代码后面；

```
public partial class _Default : System.Web.UI.Page 
{
    bool _isChecked = true;

    public string isChecked
    {
        get
        {
            return _isChecked.ToString();
        }
    }

    protected void Page_Load(object sender, EventArgs e)
    {
    }
} 
```

我知道，在这种情况下，我可以简单地使用 myCheckBox.Checked = true，但我只是出于说明目的使用此示例。真正的控制是一个自定义的，但我没有任何运气让这种方法起作用。它似乎忽略了我提供的价值。

以这种方式使用 <%# this.isChecked %> 是否有效？

**编辑：**

抱歉，我很匆忙地写了这篇文章，并意识到我并不是很清楚我打算“复选框”只是一个例子。我只是想将服务器端布尔值放入 ASP 控件的任何特定属性中，不一定是复选框控件的“已选中”属性。

**编辑 2：** 更新了我的示例以使用字符串属性而不是布尔字段，但它现在在我的 ASPX 文件中报告以下错误；

> 无法将类型“字符串”转换为“布尔”

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T16:03:31.663

如果您提供

```
checked="anything" 
```

它将被检查（在 HTML 中）。您需要省略已检查的属性以使其不被检查，因此这将不起作用。

* * *

编辑问题后，这是我的更新答案：

我不会尝试在 aspx 页面中设置属性，而是会使用 ID 并在代码中进行设置。

例如。

```
<asp:Control ID="uxMyControl" runat="server" attributes="other"... /> 
```

后面的代码：

```
private Boolean mypropery = false;

Page_Load(object sender, EventArgs e)
{
    this.myproperty = true;
    uxMyControl.attributes = myproperty;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T16:05:11.673

不，因为您返回的是布尔值而不是字符串（类型转换问题），所以您需要一个属性而不是字段来处理数据绑定表达式，并且某些浏览器不会正确呈现带有“真/假”字样的复选框”。相反，他们希望看到`checked="checked"`选中该框或什么都没有取消选中它。

根据您的编辑，我怀疑您在其他地方有代码试图设置 isChecked 布尔值。现在代码失败了，因为 isChecked 名称改为指向字符串属性。更新它以设置 _isChecked。

# .net - linq 为列表排序（MyObjects）

> ID：606997
> 
> 赞同：7
> 
> 时间：2009-03-03T16:04:16.183
> 
> 标签：.net, asp.net, vb.net, linq

如何在我的对象列表中按传递的字符串值排序？我需要对我的 List(Of) 对象进行分页和排序，分页没问题，但我不知道该让谁来工作。

这是我目前正在做的事情，效果很好：

```
Return returnReports.Skip(PageSize * (PageNumber-1)).Take(PageSize).ToList() 
```

我怎样才能让它工作？

```
Return returnReports.OrderBy(SortColumn).Skip(skip).Take(PageSize).ToList() 
```

SortColumn 是传递的字符串值

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-03T16:12:37.367

VB

```
Module OrderByExtensions
  <System.Runtime.CompilerServices.Extension()> _
  Public Function OrderByPropertyName(Of T)(ByVal e As IEnumerable(Of T), ByVal propertyName As String) As IOrderedEnumerable(Of T)
    Dim itemType = GetType(T)
    Dim prop = itemType.GetProperty(propertyName)
    If prop Is Nothing Then Throw New ArgumentException("Object does not have the specified property")
    Dim propType = prop.PropertyType
    Dim funcType = GetType(Func(Of ,)).MakeGenericType(itemType, propType)
    Dim parameter = Expression.Parameter(itemType, "item")
    Dim exp = Expression.Lambda(funcType, Expression.MakeMemberAccess(parameter, prop), parameter)
    Dim params = New Object() {e, exp.Compile()}
    Return DirectCast(GetType(OrderByExtensions).GetMethod("InvokeOrderBy", Reflection.BindingFlags.Static Or Reflection.BindingFlags.NonPublic).MakeGenericMethod(itemType, propType).Invoke(Nothing, params), IOrderedEnumerable(Of T))
  End Function
  Private Function InvokeOrderBy(Of T, U)(ByVal e As IEnumerable(Of T), ByVal f As Func(Of T, U)) As IOrderedEnumerable(Of T)
    Return Enumerable.OrderBy(e, f)
  End Function
End Module 
```

C＃

```
public static class OrderByExtensions
{
  public static IOrderedEnumerable<T> OrderByPropertyName<T>(this IEnumerable<T> e, string name)
  {
    var itemType = typeof(T);
    var prop = itemType.GetProperty(name);
    if (prop == null) throw new ArgumentException("Object does not have the specified property");
    var propType = prop.PropertyType;
    var funcType = typeof(Func<,>).MakeGenericType(itemType, propType);
    var parameter = Expression.Parameter(itemType, "item");
    var memberAccess = Expression.MakeMemberAccess(parameter, prop);
    var expression = Expression.Lambda(funcType, memberAccess, parameter);
    var x = typeof(OrderByExtensions).GetMethod("InvokeOrderBy", BindingFlags.Static | BindingFlags.NonPublic);
    return (IOrderedEnumerable<T>)x.MakeGenericMethod(itemType, propType).Invoke(null, new object[] { e, expression.Compile() });
  }
  static IOrderedEnumerable<T> InvokeOrderBy<T, U>(IEnumerable<T> e, Func<T, U> f)
  {
    return e.OrderBy(f);
  }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-03T16:08:15.690

将排序列作为函数传递。

所以它会是

```
public SomeList Foo(Function<Foo, bool> sortFunction, int skip, int PageSize)
{
   return returnReports.OrderBy(sortFunction).Skip(skip).Take(PageSize).ToList();
} 
```

像这样称呼它

```
SomeList(f => f.Bar, 5, 10); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-03T16:15:11.510

如果您使用数据库作为数据源，那么您可以使用[动态 LINQ](http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx)项目，该项目允许您将 Where 子句的参数指定为字符串。

如果您使用“Linq to objects”，则需要创建作为参数动态传递的 lambda 函数。为此，您可以使用“Expression.Xyz”方法构建表达式树，然后使用“Compile”方法将表达式树转换为可调用委托（Func<> 类型），您可以将其用作参数在哪里。可以在[此处的另一个 SO 线程](https://stackoverflow.com/questions/346523/how-do-i-compile-an-expression-tree-into-a-callable-method-c)中找到如何构造表达式树的示例。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-03T16:14:22.760

如果你只是传递了一个字符串，你就不能（容易地）做到这一点。您可以有一个从 String 到 的映射`Func<IEnumerable<Report>, IEnumerable<Report>>`，例如（在 C# 中）

```
// Horrible type. Ick.
private static readonly
    Dictionary<string, Func<IEnumerable<Report>,IEnumerable<Report>>> 
    Orderings = 
    new Dictionary<string, Func<IEnumerable<Report>,IEnumerable<Report>>>
{
    { "FirstColumn", (IEnumerable<Report> reports) => 
                          reports.OrderBy(report => report.FirstColumn) },
    { "SecondColumn", (IEnumerable<Report> reports) => 
                          reports.OrderBy(report => report.SecondColumn) },

    (etc)
}; 
```

然后使用：

```
// For production usage, include some error checking!
return Orderings[sortColumn].Skip(skip).Take(pageSize).ToList(); 
```

如果您可以`SortColumn`适当地传入`Func`（可能通过使您的方法通用），这将避免这里的混乱。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-16T16:17:27.940

您可以使用 .Sort 代替 .OrderBy。[只需像这样](http://msdn.microsoft.com/en-us/library/xh5ks3b3.aspx)为您的对象创建一个 Comparer 类。

```
public class FooComparer : IComparer<Foo>
   {
      private readonly string _sortBy;
      private readonly bool _sortDesc;

      public FooComparer(string sortBy)
      {
         _sortBy = sortBy.ToLower();
         _sortDesc = _sortBy.EndsWith(" desc");
         _sortBy = _sortBy.Replace(" asc", string.Empty).Replace(" desc", string.Empty);
      }

      //implement IComparer method
      public int Compare(Foo x, Foo y)
      {
         int ret = 0;

         switch (_sortBy)
         {
            //must match lowercase sortname 
            case "date":
               ret = DateTime.Compare(x.SomeDate, y.SomeDate);
               break;
            //other properties you can sort by as above...

         }

         //if there is a tie, break it consistently - this will be specific to your object
         if (ret == 0)
         {
            ret = (DateTime.Compare(x.InsertDate, y.InsertDate));
         }

         if (_sortDesc)
         {
            ret *= -1;
         }

         return ret;
      }
   } 
```

然后排序调用变为：

```
Return Foo.Sort(new FooComparer(sortName + " " + sortOrder) 
```

因此，您的将变为（排序顺序在未指定时默认为升序）：

```
returnReports.Sort(new ReturnReportsComparer(SortColumn));

return returnReports.Skip(skip).Take(PageSize).ToList() 
```***********