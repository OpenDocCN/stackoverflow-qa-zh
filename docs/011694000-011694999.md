# StackOverflow 问答 11694000-11694999

# php - php从https重定向到http不起作用

> ID：11694006
> 
> 赞同：1
> 
> 时间：2012-07-27T18:55:10.483
> 
> 标签：php, http, redirect, https, nginx

我有以下问题：

环境：

运行 php-fpm、php 5.3 的 nginx 网络服务器。

当我试图强制用户离开 https 区域时，它会再次重定向到 https 页面，从而创建无限循环。

测试文件：

```
header('Location: http://www.domain.com/phpinfo.php'); 
exit; 
```

但它会重定向到`**https**://www.domain.com/phpinfo.php`。

有任何想法吗？nginx\php 设置很常见。nginx 配置文件中没有一般的 http->https 重定向。

**更新**

1.  不包括浏览器缓存，我每次都使用匿名模式进行测试。
2.  重定向是“临时移动的”。

有什么想法吗？

谢谢

# c# - 如何从javascript向BHO中注册的对象添加属性？

> ID：11694009
> 
> 赞同：1
> 
> 时间：2012-07-27T18:55:22.417
> 
> 标签：c#, javascript, internet-explorer, bho, ie-plugins

有没有办法将 javasript 中的属性动态添加到 BHO 中注册的对象？

IE

```
// javascript
window.bho
window.bho.foo = "New property"; 
```

抛出“对象不支持此属性或方法”
解决方案必须适用于 .NET 2.0 Framework

```
// C#
public class ScriptableObject: IScriptableObject
{
    WebBrowser webBrowser;
    HTMLDocument document;

    public ScriptableObject(WebBrowser browser)
    {
        webBrowser = browser;
        document = webBrowser.Document as HTMLDocument;
    }

   // some methods or properties here
}

public class BHO : IObjectWithSite
{
    ...
    public void OnDownloadComplete()
    {
        document = webBrowser.Document as HTMLDocument;
        window = document.parentWindow as IHTMLWindow2;            
        IScriptableObject so = new ScriptableObject(webBrowser);

        // Adding our custom namespace to JavaScript land.
        PropertyInfo myProp = winExpando.AddProperty("bho");
        myProp.SetValue(winExpando, so, null);
    }

} 
```

# javascript - 主干视图将模板分配给 el

> ID：11694012
> 
> 赞同：1
> 
> 时间：2012-07-27T18:55:36.460
> 
> 标签：javascript, backbone.js, coffeescript

可以像这样将@template() 分配给@el：

someview.js.coffee

```
class SomeView extends Backbone.View
  template: JST["app/templates/sometemplate"]

  events:
    'click' : 'onClick'

  initialize: ->

  render: ->
    @el = @template()

  onClick: ->
    #do something 
```

index.js.coffee

```
class IndexView extends Backbone.View
  initialize: ->
    @collection.on('reset', @render, this)

  render: ->
    $(@el).html('')
    for m in @collection.models
      view = new App.Views.SomeView(model: m)
      $(@el).append(view.render().el) 
```

sometemplate.jst.hamlc

```
.someview_template
  .stuff_inside 
```

我所处的情况是 SomeView 类被一个 div 包裹，这让我失去了我想直接在“.someview_template”元素上分配的点击事件。我想解决这个问题的方法是重置 @el = @template()... 这可能还是正确的方法？

Backbone.View 的@el 是否应该始终是包含的 div，而模板应该只是该 div 中包含的元素？如果@el 自动设置为@template() 中的根节点，似乎会更基本。我是否应该让 sometemplate.jst.hamlc 只包含“.stuff_inside”，然后在 SomeView 中设置 $(@el).addClass('someview_template')，这样我就可以确定将事件分配给该元素？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-27T19:16:09.433

不，这不行，有几个原因：

1.  您将失去事件绑定，`@el`因此您的任何事件都不会起作用。
2.  缓存的`@$el`将不再匹配`@el`。

如果要替换`@el`，请使用[`@setElement`](http://backbonejs.org/#View-setElement)：

> **设置元素** `view.setElement(element)`
> 
> 如果您想将 Backbone 视图应用到不同的 DOM 元素，请使用**setElement**，它还将创建缓存`$el`引用并将视图的委托事件从旧元素移动到新元素。

你可能想要更像这样的东西：

```
render: ->
  @setElement(@template())
  @ 
```

# html - 对来自不同字段集的单选按钮进行分组？

> ID：11694015
> 
> 赞同：0
> 
> 时间：2012-07-27T18:55:49.717
> 
> 标签：html, radio-button, fieldset

是否有任何直接的机制可以将不同字段集中的单选按钮逻辑地组合在一起（即只允许一个选择）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-27T18:58:16.127

如果你给他们相同的`name`属性，它应该这样做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T11:08:55.067

我遇到了同样的问题，但我无法根据 jQuery Mobile 限制移动字段集。因此，使用 jQuery，我使用复选框模拟了收音机：

```
// add click to all checkboxes
$(':checkbox').click(function(){
    // select all checkboxes with same name that are checked but not(this) 
    $(":checkbox[name='"+$(this).attr("name")+"']:checked").not(this).each(function(){
        // uncheck them - call checkboxradio("refresh") to update changes visually
        $(this).attr('checked', false).checkboxradio("refresh");
    });
}); 
```

这在收音机上也能正常工作。如果不使用 jQuery Mobile，则必须省略 .checkboxradio。这仍然假设您的复选框/单选按钮将按相同的名称分组。

我在 each() 块中还有一些我想做的事情。如果您没有该要求，则可以使用较短的版本：

```
$(":checkbox[name='"+$(this).attr("name")+"']:checked").not(this).attr('checked', false).checkboxradio('refresh'); 
```

# java - 如何从 Velocity 生成的 jspa 页面获取值并在 Java 中使用它？

> ID：11694016
> 
> 赞同：0
> 
> 时间：2012-07-27T18:55:51.590
> 
> 标签：java, javascript, html, jsp, velocity

我有一个使用速度生成的 .jspa 页面，其中包含用户填写的表单，我需要从表单中获取数据并在 Java 中使用它进行计算，但我不知道如何去做。我可以使用任何 Java、HTML、Velocity 和 Javascript，但仅此而已。以下是与我的问题相关的代码段：

速度/HTML：

```
<form name="dates">
  <table cellspacing= "3">
    <td>Start Date: <input type="text" name="startdate" size="10" maxlength="10" value = $action.convertDateToString($action.getStartDate())></td>
    <td>Work Days: <input type="text" name="workdays" size="6" maxlength="4" value = $action.getWorkDays()></td>
    <td>End Date: <input type="text" name="enddate" size="10" maxlength="10" value = $action.convertDateToString($action.getEndDate())></td>
  </table>
</form> 
```

爪哇：

```
//converts a Date variable to a String format to be used for display
public String convertDateToString(Date d){
    SimpleDateFormat formatter = new SimpleDateFormat("MM/dd/yy");
    return formatter.format(d);
}

public int getWorkDays(){
    //needs to get the user entered value for number of works days to use when calculating the end date
    return 10;
}

public Date getEndDate(){
    //calculates the end date based on the number of work days given and the start date
    Calendar startCal = Calendar.getInstance();
    startCal.setTime(getStartDate());
    int duration = getWorkDays();

    for (int i = 1; i < duration; i++) {
        startCal.add(Calendar.DAY_OF_MONTH, 1);
        //loop through by number of work days, skipping Saturday and Sunday
        while (startCal.get(Calendar.DAY_OF_WEEK) == Calendar.SATURDAY || startCal.get(Calendar.DAY_OF_WEEK) == Calendar.SUNDAY)
          startCal.add(Calendar.DAY_OF_MONTH, 1);
      }

      return startCal.getTime();
}

public Date getStartDate(){
    setCurrProj();
    Date startDate = version.getReleaseDate();
    return startDate;
} 
```

所以我有一个表格，其中开始日期在 Java 中计算，工作日数由用户输入，然后将该值发送回 Java 以计算结束日期。我不确定如何从速度中获取数据并将其发送回 Java。最好在输入工作日数后立即（即自动）完成计算，但如果需要“计算”按钮，它也可以工作。我对 Java 比较熟悉，之前没有用 Velocity 或 JSP 做过很多 Web 开发。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T19:30:27.473

Java 和 Velocity 页面在服务器端执行。当用户在表单中输入内容时，它发生在浏览器中，在 Java/Velocity 代码完成生成 HTML 页面很久之后。

因此，您需要在 JavaScript 中完全计算结束日期，或者使用 AJAX 请求将 startDate 和天数发送到服务器，在 Java 中计算结束日期，将其发送到响应，从响应中获取此日期AJAX 响应处理程序，并在页面中更新它。

# objective-c - UIStepper 值 - 多次迭代后返回的垃圾值

> ID：11694018
> 
> 赞同：0
> 
> 时间：2012-07-27T18:55:56.063
> 
> 标签：objective-c, ios, uistepper

我已经解决了我在这篇文章中描述的问题，但我想了解它的原因（我花了很多时间来解决这个问题），正如我在下面的“问题”中提出的那样。

在使用 UIStepper 调用 IBAction 方法时，我遇到了递增和递减返回值的问题。当我运行和调试应用程序时，我可以上下调整，日志语句**总是**反映预期的步进值，但是当我迭代地提高 0.1、0.2 然后 0.3 然后降低时，当我回到 0.0 时，当我执行如果进行测试，则调试器中显示的 changeValue 的值是垃圾，并且测试没有导致**== 0.0**的条件为真。请注意，如果我只升到 0.2 然后又降到 0.0，则 changeValue 的 if 测试有效。只有当我提高到 0.3 时，当我回到 0.0 时才得到垃圾值。

最初，为了增加步进器，我将 stepValue 属性设置为：

```
viewStepper.stepvalue = 0.1 
```

该方法在升压到 0.3 并返回 0.0 后返回 0.0 的垃圾值。

当我将作业更改为：

```
viewStepper.stepValue - 0.1f 
```

问题已解决 - changeValue 为我的 if 测试返回预期的 0.0 changeValue，并且无论迭代次数如何，该方法都按预期工作。

问题：1）我有点明白这一点，但为什么如果 stepValue 是双精度值，赋值值是否需要显式包含“f”并且对我来说更奇怪 2）为什么我在方法中的测试在没有“f”的情况下工作在进行**两步**迭代时分配 viewStepper.stepValue 属性，但是当我向上进行**三步**迭代然后返回到 0.0 时为 changeValue 返回垃圾？

这是我正在测试的方法的核心：

```
- (IBAction)doStepper:(UIStepper *)sender
{
   double changeValue = [sender value];
   NSLog(@"(double)change value %f", (double)changeValue);
   NSLog(@"sender value:%0.1f", [sender value]);

   if ((double)changeValue == 0.0) {
       if (!something) {
           // do stuff
       }
   // do stuff

   } else {
        // do stuff
   }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T19:05:46.237

听起来像是浮点舍入错误的经典案例。一般规则是不比较浮点值是否相等 ( `==`)。在第二种情况下，您提高了数字的精度（到 a`double`而不是默认的 single-precision `float`），因此您的值的完整性持续了一些计算时间更长。如果您绝对需要跟踪细粒度的精确十进制值，请执行以下操作之一：

*   使用`Decimal`数据类型
*   以整数类型跟踪基础增量，但将其显示为小数。在您的示例中，如果您的步长始终为 0.1，您可以将*步数*作为整数跟踪，但将步数除以 10 以获得当前有用的值。

# wpf - 如何更改所选数据网格行的蓝色

> ID：11694022
> 
> 赞同：4
> 
> 时间：2012-07-27T18:56:16.283
> 
> 标签：wpf, datagrid

好吧，我已经看到了这样做的代码：

```
<DataGrid.RowStyle>
    <Style TargetType="DataGridRow">

        <Style.Triggers>
            <Trigger Property="IsSelected" Value="True">
                <Setter Property="Background" Value="Black"/>
                <Setter Property="Foreground" Value="Green">
                </Setter>
            </Trigger>
        </Style.Triggers>

        <Setter Property="Background">                        
            <Setter.Value>
                <MultiBinding Converter="{StaticResource ucComponentesColorFilaMultiValueConverter}">
                    <Binding ElementName="dgdComponentes" Path="ItemsSource" />
                    <Binding ElementName="dgdComponentes" Path="SelectedItems" />
                    <Binding ElementName="CurrentItem" />
                </MultiBinding>
            </Setter.Value>
        </Setter>
    </Style>
</DataGrid.RowStyle> 
```

确实代码是样式触发器，setter 属性是针对其他情况的，但是我添加了此代码会影响结果。

我想更改选定的行背景，默认情况下为蓝色，我想根据某些条件更改为其他颜色。例如，如果添加了一个寄存器，那么如果我选择该行，它将是绿色的，如果未选择该行，它将是浅绿色的。

我可以根据需要更改行的颜色，但是当我选择它时，总是蓝色的。

谢谢。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-27T19:17:23.917

你可以试试这样的东西也许......

```
 <SolidColorBrush x:Key="{x:Static SystemColors.HighlightBrushKey}" Color="Transparent" />
       <SolidColorBrush x:Key="{x:Static SystemColors.ControlBrushKey}" Color="Transparent" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T19:06:55.687

为此，您需要以编程方式指定行的颜色

```
<Setter Property="Background" Value="{Binding Path=BgColor}"/> 
```

将**BgColor**属性添加到绑定到网格的对象。根据您的条件设置**BgColor**（即，如果对象已注册，则 BgColor 为“绿色”）

# javascript - 从 CRM 2011 功能区按钮访问逻辑名称

> ID：11694026
> 
> 赞同：0
> 
> 时间：2012-07-27T18:56:56.283
> 
> 标签：javascript, dynamics-crm-2011

我在 CRM 2011 中创建了一个自定义功能区按钮，用于创建激活插件的触发器实体。我正在尝试通过在触发器实体中创建字段来将数据传输到插件中。我试图填写的字段之一是所选实体的逻辑名称（我试图使这项工作普遍适用，这就是为什么我不直接指定单个实体的原因）。如果选择了 homegrid 上的两个不同实体（并且它们是相同的实体类型），我如何使用 jscript 访问它们的逻辑名称？

我尝试使用 crm 参数`SelectedControlSelectedItemReferences`然后调用`references[0].LogicalName`，但这会返回“未定义”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T20:57:22.077

可以用 IE 访问 F12 开发者工具吗？如果可以，您可以在按钮执行的方法中在代码中添加断点。暂停执行后，检查`SelectedControlSelectedItemReferences`和 从那里的值，您将能够正确识别表示该属性的`EntityReference` `LogicalName`属性。

您可以使用此方法来识别 javascript 中任何未知方法或属性的特征。

![类型名称](../Images/1cc7e7c6afe8b31a40ffcf665c5d4d95.png)

# ms-access - Access中使用vba组合两个查询

> ID：11694028
> 
> 赞同：0
> 
> 时间：2012-07-27T18:57:02.343
> 
> 标签：ms-access, vba

我有两个组合框，Combo_A 在 Combo_B 中设置查询字符串。在从 combo_B 中选择一个选项并点击 go 按钮后，将根据 Combo_A 中的选择执行两个查询之一。如果在 Combo_A 中选择了选项 1，则执行按钮执行查询 A，如果在 Combo_A 中选择了选项 2，则执行按钮执行查询 B。这一切都很好，它通过将查询名称分配给变量然后执行一个 DoCmd.OpenQuery_Click。

我的问题是我想更进一步。我想在选中复选框时将上面的结果与另一个查询交叉引用，当未选中时，它的行为需要与我目前设计的完全相同。我知道我可以创建查询，但使用 vba 不太舒服。我可以使用代表查询的变量名来加入另一个查询吗？到目前为止，这是我的 vba 代码。

```
Option Compare Database

Private Sub AgencyorCarrierSelection_AfterUpdate()
If AgencyorCarrierSelection = "By Insurance Carrier" Then
    Combo7.Visible = True
    Text13.Value = "Select of of the following Carriers:"
    Text13.Visible = True
    Combo7.RowSource = "SELECT [tblRefInsuranceCarriers].[InsuranceCarrierID], [tblRefInsuranceCarriers].[CarrierName] FROM [tblRefInsuranceCarriers] ORDER BY [CarrierName];"
Else
    Combo7.Visible = True
    Text13.Value = "Select of of the following Agencies:"
    Text13.Visible = True
    Combo7.RowSource = "SELECT [tblRefInsuranceAgencies].[InsuranceAgencyID], [tblRefInsuranceAgencies].[AgencyName] FROM [tblRefInsuranceAgencies] ORDER BY [AgencyName]"
End If
End Sub
Private Sub lblSwitchboard_Click()
DoCmd.OpenForm "switchboard", acNormal
DoCmd.Close acForm, "frmInsuranceInformationConnect"
End Sub
Private Sub RunAgencyorCarrierQuery_Click()
On Error GoTo Err_RunAgencyorCarrierQuery_Click

Dim stDocName As String
If AgencyorCarrierSelection = "By Insurance Carrier" Then
    stDocName = "qryInsuranceCarrierAgentPremiumBreakout_Carrier"
Else
    stDocName = "qryInsuranceCarrierAgentPremiumBreakout_Agency"
End If

DoCmd.OpenQuery stDocName, acNormal, acEdit

Exit_RunAgencyorCarrierQuery_Click:
Exit Sub

Err_RunAgencyorCarrierQuery_Click:
MsgBox Err.Description
Resume Exit_RunAgencyorCarrierQuery_Click

End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T20:11:23.017

因此，您将使用基本相同的查询（A 或 B），但选中该框将通过一个额外的标准限制结果。挑战在于标准需要加入另一个表。

最简单的就是进行匹配A和B的C和D查询，但是有多余的表；然后`if...then`到所需的查询，就像您已经在做的那样。

或者，您可以使 A 和 B 查询包含连接表，以便额外的标准可用，并使用[参数查询](http://msdn.microsoft.com/en-us/library/office/aa160564%28v=office.11%29.aspx)来指定是否使用该标准。这似乎很复杂。

# jquery-ui - 有没有办法向 jqueryUI DatePicker 添加复杂的日期范围？

> ID：11694035
> 
> 赞同：0
> 
> 时间：2012-07-27T18:57:32.553
> 
> 标签：jquery-ui, jquery-ui-datepicker

我已将 Datepickers 添加到旧版 Web 应用程序的多个字段中。一个这样的文本框是到期日期字段。当用户不希望某些东西过期时，他们会将日期设置为 12/31/9999。出于这个原因，我希望 Datepicker 中的 yearRange 类似于“2012 到 2022 和 9999”。

设置从现在到 9999 的范围很容易，但这会创建一个带有数千个选项的年份下拉列表。我宁愿未来 10 年只有 10 个选项，然后是 9999 的第 11 个选项。

我尝试使用 this yearRange，但 Datepicker 似乎不理解逗号。有任何想法吗？

```
yearRange: "-0:+10,9999" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T23:21:45.970

使用[这篇文章的](https://stackoverflow.com/questions/4598850/how-do-you-add-buttons-to-a-jquery-datepicker-in-the-button-panel)帮助，我只是将我的范围保留为“-0：+10”，然后我添加了一个“从不”按钮，如下所示：

```
beforeShow: function( input ) {
    setTimeout(function() {
        var buttonPane = $(input)
            .datepicker("widget")
            .find(".ui-datepicker-buttonpane");

        var btn = $('<BUTTON class="ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all">Never</BUTTON>');
        btn
            .unbind("click")
            .bind("click", function () {
                $(input)
                    .datepicker("setDate", new Date(9999,11,31))
                    .datepicker("hide");
            });

        btn.appendTo(buttonPane);

    }, 1 );
} 
```

注意 - 这是我必须用来让 12/31/9999 正确显示的日期。

# sql - 本地 Visual Studio 数据库的 SQL 文本编辑器

> ID：11694037
> 
> 赞同：0
> 
> 时间：2012-07-27T18:58:01.510
> 
> 标签：sql, database, visual-studio-2010, text, editor

在 Visual Studio 2010 终极版中，我已将本地数据库添加到我的项目中。我知道如何使用图形编辑器来创建表格，但是有文本编辑器吗？似乎有一个用于编写查询的文本编辑器，我尝试执行 create table 语句，但 Visual Studio 不允许这样做。

什么是可用于编写创建表语句和查询的替代文本编辑器？我以前使用过管理工作室（更多用于服务器）。

任何帮助深表感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T19:01:04.807

我使用 DB Visualiser (http://www.dbvis.com/)；它是免费的，非常适合查看表、关系和执行基本查询。

顺便说一句，我不为他们工作——我只是一个长期快乐的用户！

干杯，

尼尔

# javascript - 在 d3.js 中设置轴的 css

> ID：11694038
> 
> 赞同：5
> 
> 时间：2012-07-27T18:58:03.613
> 
> 标签：javascript, svg, d3.js

在 d3.js 中有没有要做 .axis path { fill : none } 的事情？

我在 .call(d3.svg.axis() 上尝试了 .attr 和 .style 但无济于事。我只是在这里做错了什么......

我用来创建轴的完整代码如下：

```
 // create Axis
  svg.selectAll("axis")
      .data(d3.range(angle.domain()[1]))
    .enter().append("g")
      .attr("class", "axis")
      .attr("transform", function(d) { return "rotate(" + angle(d) * 180 / Math.PI + ")"; })
    .call(d3.svg.axis()
      .scale(radius.copy().range([0,0]))
      .ticks(1)
      .tickFormat("")
      .orient("left"))
      .attr("fill","none") // EDITED WITH FILL NONE
    .append("text") 
      .attr("y", 
        function (d) {
          if (window.innerWidth < 455){
            console.log("innerWidth less than 455: ",window.innerWidth);
            return -(0);
          }
          else{
            console.log("innerWidth greater than 455: ",window.innerWidth);
            return -(0);
          }
        })
      .attr("dy", "0em"); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-30T12:51:14.583

当我想将 CSS 设置应用于 d3 元素时，我发现最简单的方法是为它们分配一个 ID 或类（您在上面所做的），然后使用 CSS 应用所需的属性。比如保持上面的JS，然后在css中做：

```
.axis path {

    fill:           none;
} 
```

如果你想在 JS 中做，你应该使用：

```
.style('fill', 'none') 
```

但是，您应该将其应用于包含轴的 svg，而不是在 .call(d3.svg.axis()) 内。希望这可以帮助。

# java - 使用 Java 解压和重新打包 jar 会导致 jar 文件损坏

> ID：11694040
> 
> 赞同：1
> 
> 时间：2012-07-27T18:58:05.033
> 
> 标签：java, jar, io, compression, zip

我一直在调试一些 jar 更新片段，我遇到了一个 zip/unzip 组合，它应该是相反的，但是当我在一个 jar 上尝试它时，即使所有文件都存在，它也失败了。谁能弄清楚这是哪里出错了？

SSCCE（无需编译）：[在这里下载！](http://dev.fhmp.net/jar_sscce.zip)

```
package jarsscce;

import java.io.*;
import java.util.*;
import java.util.jar.*;
import java.util.zip.*;

public class JarSSCCE {

    public static void main(String[] args) throws IOException {
        File testJar = new File("test.jar");
        File testDir = new File("test");
        File jarPack = new File("packed_test.jar");

        unpack(testJar, testDir);
        jar(testDir, jarPack);
    }

    public static void jar(File directory, File zip) throws IOException {
        try (JarOutputStream jos = new JarOutputStream(new FileOutputStream(zip))) {
            jar(directory, directory, jos);
        }
    }

    private static void jar(File directory, File base, JarOutputStream jos) throws IOException {
        File[] files = directory.listFiles();
        byte[] buffer = new byte[1 << 12];

        if (files.length == 0) {
            JarEntry entry = new JarEntry(directory.getPath().substring(base.getPath().length() + 1) + File.separator);
            jos.putNextEntry(entry);
        } else {

            for (int i = 0, n = files.length; i < n; i++) {
                if (files[i].isDirectory()) {
                    jar(files[i], base, jos);
                } else {
                    try (FileInputStream in = new FileInputStream(files[i])) {
                        JarEntry entry = new JarEntry(files[i].getPath().substring(base.getPath().length() + 1));
                        jos.putNextEntry(entry);

                        int read;
                        while ((read = in.read(buffer, 0, buffer.length)) != -1) {
                            jos.write(buffer, 0, read);
                        }
                        jos.closeEntry();
                    }
                }
            }
        }
    }

    public static void unpack(File zip, File extractTo) throws IOException {
        try (ZipFile archive = new ZipFile(zip)) {
            Enumeration e = archive.entries();
            while (e.hasMoreElements()) {
                ZipEntry entry = (ZipEntry) e.nextElement();
                File file = new File(extractTo, entry.getName());
                if (entry.isDirectory() && !file.exists()) {
                    file.mkdirs();
                } else {
                    if (!file.getParentFile().exists()) {
                        file.getParentFile().mkdirs();
                    }
                    try (InputStream in = archive.getInputStream(entry)) {
                        BufferedOutputStream out = new BufferedOutputStream(new FileOutputStream(file));
                        byte[] buffer = new byte[1 << 13];
                        int read;
                        while ((read = in.read(buffer)) != -1) {
                            out.write(buffer, 0, read);
                        }
                        out.close();
                    }
                }
            }
        }
    }
} 
```

**编辑：**通过Winrar查看存档信息，我可以看到Netbeans创建的test.jar根本没有压缩，程序创建的那个是。“主机操作系统”和“要提取的版本”值也不同。虽然我看不出这有什么意义。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T19:36:30.930

我想我已经找到了问题，在这个链接上有一个高峰：http: [//viralpatel.net/blogs/creating-zip-and-jar-files-in-java/](http://viralpatel.net/blogs/creating-zip-and-jar-files-in-java/)。它谈到了使用，`entry.setMethod(ZipEntry.STORED)`但是我们必须创建自己的校验和等，但所有内容都在链接中进行了解释。

**附录：**

`zip()`通过使用不同的方法让它工作：

```
import java.io.*;
import java.net.URI;
import java.util.Deque;
import java.util.Enumeration;
import java.util.LinkedList;
import java.util.zip.ZipEntry;
import java.util.zip.ZipFile;
import java.util.zip.ZipOutputStream;

public class Main {

    public static void main(String[] args) throws IOException {
        File testJar = new File("test.jar");
        File testDir = new File("test");
        File jarPack = new File("packed_test.jar");

        unpack(testJar, testDir);
        jar(testDir, jarPack);
    }

    public static void jar(File directory, File zipfile) throws IOException {
        URI base = directory.toURI();
        Deque<File> queue = new LinkedList<>();
        queue.push(directory);
        OutputStream out = new FileOutputStream(zipfile);
        Closeable res = out;
        try {
            ZipOutputStream zout = new ZipOutputStream(out);
            res = zout;
            while (!queue.isEmpty()) {
                directory = queue.pop();
                for (File kid : directory.listFiles()) {
                    String name = base.relativize(kid.toURI()).getPath();
                    if (kid.isDirectory()) {
                        queue.push(kid);
                        name = name.endsWith("/") ? name : name + "/";
                        zout.putNextEntry(new ZipEntry(name));
                    } else {
                        zout.putNextEntry(new ZipEntry(name));
                        copy(kid, zout);
                        zout.closeEntry();
                    }
                }
            }
        } finally {
            res.close();
        }
    }

    private static void copy(File file, OutputStream out) throws IOException {
        try (InputStream in = new FileInputStream(file)) {
            byte[] buffer = new byte[1024];
            while (true) {
                int readCount = in.read(buffer);
                if (readCount < 0) {
                    break;
                }
                out.write(buffer, 0, readCount);
            }
        }
    }

    public static void unpack(File zip, File extractTo) throws IOException {
        ZipFile archive = new ZipFile(zip);
        Enumeration e = archive.entries();
        while (e.hasMoreElements()) {
            ZipEntry entry = (ZipEntry) e.nextElement();
            File file = new File(extractTo, entry.getName());
            if (entry.isDirectory() && !file.exists()) {
                file.mkdirs();
            } else {
                if (!file.getParentFile().exists()) {
                    file.getParentFile().mkdirs();
                }
                BufferedOutputStream out;
                try (InputStream in = archive.getInputStream(entry)) {
                    out = new BufferedOutputStream(
                            new FileOutputStream(file));
                    byte[] buffer = new byte[8192];
                    int read;
                    while (-1 != (read = in.read(buffer))) {
                        out.write(buffer, 0, read);
                    }
                }
                out.close();
            }
        }
    }
} 
```

多亏了我发现的这个问题:) [java.util.zip - 重新创建目录结构](https://stackoverflow.com/questions/1399126/java-util-zip-recreating-directory-structure)

# file - 如何使用 tcl 从文件中提取和比较特定数值？

> ID：11694043
> 
> 赞同：0
> 
> 时间：2012-07-27T18:58:18.630
> 
> 标签：file, file-io, compare, line, tcl

我想读取特定的值数字并从 tcl 中的文件中比较它们。例如：

```
node4 time: 3.03 PositionX :34.596   PositionY: 200.34
node5 time: 6.02 PositionX :4.50   PositionY: 30.234 
```

**我只**需要读取每行的节点号，如 node4 和 3.03 和 200.34 等等，然后打印它们或稍后进行比较。我怎么能在 tcl 中做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-27T20:02:42.297

看看[扫描](http://www.tcl.tk/man/tcl/TclCmd/scan.htm)。

例如：（循环执行）

```
scan $line "node%i time: %f PositionX :%f   PositionY: %f" nodenr time posx posy 
```

然后您可以使用变量`nodenr`、`time`和`posx``posy`

对于文件部分，您只需要[open](http://www.tcl.tk/man/tcl/TclCmd/open.htm)、[read](http://www.tcl.tk/man/tcl/TclCmd/read.htm)和[close](http://www.tcl.tk/man/tcl/TclCmd/close.htm)。请参阅此[Tcl 教程](http://www.tcl.tk/man/tcl/tutorial/Tcl24.html)。要将整个文件拆分为列表（可与[foreach](http://www.tcl.tk/man/tcl/TclCmd/foreach.htm)一起使用），请使用[split](http://www.tcl.tk/man/tcl/TclCmd/split.htm)

# scala - 将 build.sbt 与 project/Build.scala 和聚合混合

> ID：11694045
> 
> 赞同：8
> 
> 时间：2012-07-27T18:58:26.430
> 
> 标签：scala, sbt

在我有这样的东西（简化）之前，使用 sbt 0.11.3：

```
// project/Build.scala
import sbt._
import Keys._

object MyBuild extends Build {
   lazy val standardSettings = Defaults.defaultSettings ++ Seq(
      version      := "0.2",
      scalaVersion := "2.9.2"
   )

   lazy val main = Project(
      id        = "main",
      base      = file( "." ),
      settings  = standardSettings,
      aggregate = Seq( sub )
   )

   lazy val sub = Project(
      id        = "main-sub",
      base      = file( "sub" ),
      settings  = standardSettings
   )
} 
```

`build.sbt`但我想在纯文件中保留尽可能多的信息。所以现在我有

```
// build.sbt
version      := "0.2"

scalaVersion := "2.9.2" 
```

和

```
// project/Build.scala
import sbt._
import Keys._

object MyBuild extends Build {
   lazy val main = Project(
      id        = "main",
      base      = file( "." ),
      aggregate = Seq( sub )
   )

   lazy val sub = Project(
      id        = "main-sub",
      base      = file( "sub" )
   )
} 
```

但这似乎并没有将我的设置`build.sbt`混入子项目中：

```
> show version
[info] main-sub/*:version
[info]  0.1-SNAPSHOT
[info] main/*:version
[info]  0.2
> show scala-version
[info] main-sub/*:scala-version
[info]  2.9.1
[info] main/*:scala-version
[info]  2.9.2 
```

如何解决这个问题？我还尝试向`settings`子项目添加显式，例如

*   `settings = Defaults.defaultSettings`
*   `settings = Project.defaultSettings`
*   `settings = MyBuild.settings`
*   `settings = main.settings`（确定这个应该做吗？！）

...但没有一个工作。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-27T21:03:22.813

[这些信息在sbt 的 Multi Projects 文档](http://www.scala-sbt.org/release/docs/Getting-Started/Multi-Project)的最后一部分有点隐藏：

> 当有一个`.scala`文件设置不同的项目时，很容易在不同的项目中使用重用设置。但即使使用不同的文件，通过使用范围使设置全局应用`build.sbt`，仍然可以轻松地在主构建中的所有项目之间共享设置。`ThisBuild`

因此：

```
// build.sbt
version in ThisBuild := "0.2"

scalaVersion in ThisBuild := "2.9.2" 
```

哇，如果你有两打钥匙，那就*太糟糕了。*

# ios5 - NSPredicate 解析错误

> ID：11694050
> 
> 赞同：0
> 
> 时间：2012-07-27T18:58:58.473
> 
> 标签：ios5, nspredicate

我有一个类型为 double 的 iVar “total”类。我想将它视为一个字符串，仅用于搜索目的，所以我可以在我的谓词中使用 BEGINSWITH。

我错过了什么？这会导致解析错误：

```
NSPredicate *filter = [NSPredicate predicateWithFormat: @"[NSString stringWithFormat:@\"%f\",total] BEGINSWITH %@", searchText]; 
```

# powershell - 管道中 ForEach-Object cmdlet 的执行顺序如何工作？

> ID：11694057
> 
> 赞同：3
> 
> 时间：2012-07-27T18:59:12.897
> 
> 标签：powershell, pipeline

在 PowerShell 中，管道中 cmdlet 的执行顺序似乎没有以明显的方式执行。似乎不是每个 cmdlet 执行然后将结果传递给管道中的下一个 cmdlet，而是在执行前一个 cmdlet 完成之前将 cmdlet 的各个输出对象传递给下一个 cmdlet 的输入。以下证实了这种行为：

`1..5 | %{ Write-Host $_; $_ } | %{ Write-Host ([char]($_ + 64)) }`

印刷

```
1
A
2
B
3
C
4
D
5
E 
```

似乎正在发生的事情是`ForEach-Object`cmdlet 的每次执行都将在迭代之前执行其脚本块**和其管道中的每个后续命令。**

这是实际发生的情况吗？这种行为是否记录在任何地方？对于所有迭代 cmdlet `ForEach-Object`（例如`Where-Object`，等），都是这种情况吗？

`(1..5 | %{ Write-Host $_; $_ }) | %{ Write-Host ([char]($_ + 64)) }`我知道我可以将片段包装在表达式 (整个集合到管道中的下一个命令？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-27T19:36:22.757

这符合我对管道如何处理对象的理解。在触及下一个项目之前，对象会在管道中“尽可能远”地移动。一些 cmdlet 不使用“进程”块，而是在必要时使用“结束”块（例如，排序对象必须拥有所有项目才能实际执行排序），因此它们会阻塞管道。其他人使用写输出（你的第二个 $_ 正在隐式执行）并保持管道移动。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-01-21T21:25:32.620

每个对象都尽可能地通过管道。这就是为什么每个 cmdlet 都应该将其输出直接写入管道而不是将其累积在某个内部存储中，除非它必须像 Sort-Object 一样将所有输入一起处理。

它也有一些有趣的副作用。例如，如果 Get-Member cmdlet 从管道获取输入，则它会给出不同的输出；如果它从 InputObject 参数获取输入，则它会给出不同的输出。

而且，因为它是 PowerShell，所以都记录在这里：

```
Get-Help about_pipelines 
```

# ruby - Ruby：如何使用数组或哈希图对 json 响应进行排序

> ID：11694058
> 
> 赞同：0
> 
> 时间：2012-07-27T18:59:13.307
> 
> 标签：ruby, arrays, hash

我正在获取我的 json 响应并对其进行解析，我能够分别获得以下模型和标识符（见下文）。现在，我只需要按模型对它们进行排序，不区分大小写。因此，如果我创建一个数组，那么仅按模型排序就会变得很困难，如果不是不可能的话，如果我进行哈希，我将无法创建重复的键（模型）。
那么对这个 json 响应进行排序的最佳方法是什么？谢谢 ！！

```
 this is the model: 1 Series
  this is the identifier: Convertible
  this is the model: 1 Series
  this is the identifier: Coupe
  this is the model: 1 Series M
  this is the identifier: Coupe
  this is the model: 3 Series
  this is the identifier: Convertible
  this is the model: 3 Series
  this is the identifier: Coupe
  this is the model: 3 Series
  this is the identifier: Diesel
  this is the model: 3 Series
  this is the identifier: Sedan
  this is the model: 3 Series
  this is the identifier: Wagon
  this is the model: ALPINA B7
  this is the identifier: Sedan
  this is the model: ActiveHybrid 5
  this is the identifier: Sedan
  this is the model: ActiveHybrid 7
  this is the identifier: Sedan
  this is the model: ActiveHybrid X6
  this is the identifier: SUV 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T19:46:43.043

为什么数组无法排序？这将起作用。

```
[["1 Series","Convertible"],["3 Series","Coupe"]].sort 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T19:24:27.653

我会选择一组对象，其类混合在[Comparable](http://www.ruby-doc.org/core-1.9.3/Comparable.html)中。你只需要实现`<=>`（又名“宇宙飞船”），然后你就可以调用`sort`你的数组。

# unity-container - asp.net mvc 4 将依赖项注入不同的控制器类型

> ID：11694060
> 
> 赞同：0
> 
> 时间：2012-07-27T18:59:21.623
> 
> 标签：unity-container, asp.net-mvc-4

我正在使用 MVC 4 中可用的两种类型的控制器：System.Web.Mvc.Controller 和 System.Web.Http.ApiController。我需要能够使用 Unity 将依赖项注入到控制器中。

对于我使用 Unity.WebApi 的 ApiControllers： GlobalConfiguration.Configuration.DependencyResolver = new Unity.WebApi.UnityDependencyResolver(_container);

对于我尝试使用使用 Nuget 添加的 Unity.Mvc3 的控制器：DependencyResolver.SetResolver(new Unity.Mvc3.UnityDependencyResolver(_container));

但是，我收到运行时错误：无法加载文件或程序集“System.Web.Mvc，Version=3.0.0.0，Culture=neutral，PublicKeyToken=31bf3856ad364e35”或其依赖项之一。该系统找不到指定的文件。

有谁知道适用于这种情况的解决方案？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T15:23:08.153

在 web.config 中添加绑定重定向：

```
<runtime>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
      <dependentAssembly>
        <assemblyIdentity name="System.Web.Mvc" publicKeyToken="31bf3856ad364e35" />
        <bindingRedirect oldVersion="0.0.0.0-4.0.0.0" newVersion="4.0.0.0" />
      </dependentAssembly>      
    </assemblyBinding>
  </runtime> 
```

# c# - 抽象工厂从配置添加到字典

> ID：11694061
> 
> 赞同：0
> 
> 时间：2012-07-27T18:59:21.510
> 
> 标签：c#, configuration, dictionary, abstract-factory

嗨，我的工厂代码是这样的。我不想将这些值直接存储在字典中，而是将这些值存储在 app.config 文件中。正如我在下面显示的。

```
public class HandlerFactory
    {
        private Dictionary<string, IHandler> _handlers = new Dictionary<string,IHandler>();
        public HandlerFactory()
        {
            _handlers.Add("AMOUNT", new AmountValidator());
            _handlers.Add("FLOW", new FlowValidator());
        }
        public IHandler Create(string key)
        {
            IHandler result;
            _handlers.TryGetValue(key, out result);
            return result;
        }
    } 
```

我会将这些设置移动到我的配置文件中，如下所示。

```
 <?xml version="1.0" encoding="utf-8" ?>
        <configuration>
        <configSections>
            <section name="Indentifiers" type="System.Configuration.AppSettingsSection"/>
        </configSections>
        <Indentifiers>
            <add key="AMOUNT" value="AmountValidator" />
            <add key="FLOW" value="FlowValidator" />
        </Indentifiers>
    </configuration> 
```

我正在做这样的事情，但我没有成功。不知道如何添加到字典

```
NameValueCollection settings = ConfigurationManager.GetSection("Indentifiers") as NameValueCollection;
                if (settings != null)
                {
                    foreach (string key in settings.AllKeys)
                    {
                        _handlers.Add(key.ToString(), settings[key].ToString()); <-- how to handle here
                    }
                 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-28T06:50:52.327

```
public interface IHandler
{
    void Handle();
}

public sealed class HandlerFactory
{
    private readonly Dictionary<string, Type> _map = new Dictionary<string, Type>();

    public HandlerFactory()
    {
        var handlers = (NameValueCollection)ConfigurationManager.GetSection("Handlers");
        if (handlers == null)
            throw new ConfigurationException("Handlers section was not found.");
        foreach (var key in handlers.AllKeys)
        {
            var typeName = handlers[key] ?? string.Empty;
            // the type name must be qualified enough to be 
            // found in the current context.
            var type = Type.GetType(typeName, false, true);
            if (type == null)
                throw new ConfigurationException("The type '" + typeName + "' could not be found.");
            if (!typeof(IHandler).IsAssignableFrom(type))
                throw new ConfigurationException("The type '" + typeName + "' does not implement IHandler.");
            _map.Add(key.Trim().ToLower(), type);
        }
    }

    // Allowing your factory to construct the value 
    // means you don't have to write construction code in a million places.
    // Your current implementation is a glorified dictionary
    public IHandler Create(string key)
    {
        key = (key ?? string.Empty).Trim().ToLower();
        if (key.Length == 0)
            throw new ArgumentException("Cannot be null or empty or white space.", "key");
        Type type;
        if (!_map.TryGetValue(key, out type))
            throw new ArgumentException("No IHandler type maps to '" + key + "'.", "key");
        return (IHandler)Activator.CreateInstance(type);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T19:20:26.747

正如 ChaosPandion 所指出的， CreateInstance 方法应该很有用。假设您的两种处理程序类型都实现了 IHandler，并且它们位于正在运行的程序集中，

```
_handler.Add(key.ToString(), Activator.CreateInstance(null, settings[key].ToString())); 
```

应该做的伎俩！ [http://msdn.microsoft.com/en-us/library/d133hta4.aspx](http://msdn.microsoft.com/en-us/library/d133hta4.aspx) 第一个参数是程序集的名称，null 默认为正在执行的程序集。

# git-svn - git-svn 迁移致命：不是有效的 SHA1 update-ref refs/heads/master refs/remotes/trunk：命令返回错误：128

> ID：11694065
> 
> 赞同：18
> 
> 时间：2012-07-27T18:59:36.193
> 
> 标签：git-svn

尝试将大型但线性的 svn 存储库迁移到 git。svn 存储库没有标准布局（主干、分支、标签）……只有一个带有主干的目录。

Ubuntu 12.4 LTS，git 1.7.9.5。

```
$ git svn clone https://coawstmodel.sourcerepo.com/coawstmodel/COAWST --authors-file=../users.txt COAWST

...

    D   WPS/metgrid/storage_module.F
    D   WPS/metgrid/process_domain_module.F
W: -empty_dir: WPS/metgrid/gridinfo_module.F
W: -empty_dir: WPS/metgrid/input_module.F
W: -empty_dir: WPS/metgrid/interp_option_module.F
W: -empty_dir: WPS/metgrid/module_date_pack.F
W: -empty_dir: WPS/metgrid/process_domain_module.F
W: -empty_dir: WPS/metgrid/storage_module.F
r635 = c19181c9718e701788b540ed0cc559e4fbddf413 (refs/remotes/git-svn)
    M   Tools/Docs/COAWST_User_Manual.doc
r636 = 1b7849c3e5a20856c9ddb909a5f53ddf8501ad33 (refs/remotes/git-svn)
Auto packing the repository for optimum performance. You may also
run "git gc" manually. See "git help gc" for more information.
Counting objects: 14143, done.
Delta compression using up to 8 threads.
Compressing objects: 100% (14039/14039), done.
Writing objects: 100% (14143/14143), done.
Total 14143 (delta 8350), reused 0 (delta 0)
fatal: refs/remotes/trunk: not a valid SHA1
update-ref refs/heads/master refs/remotes/trunk: command returned error: 128 
```

我尝试过使用 -s、-t Trunk、-t COAWST、--preserve-empty-dirs（我想做）、--no-meta-data（每个 Pro Git）组合的变体......总是同样的最终错误。

感谢您的任何建议！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2014-05-07T18:19:06.120

每次这种情况发生在我身上时，Git 都无法从`trunk`Subversion 中获取提交：

```
fatal: refs/remotes/trunk: not a valid SHA1 
```

* * *

**原因：**

*   当它不是标准的（trunk-tags-branches）时，您没有指定 Subversion 布局。专门针对错误-您没有`/trunk`.
*   您没有从足够旧的版本中获取至少一个提交到主干（例如，使用`-r`选项）。
*   以上结合。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-07-27T19:52:08.750

我认为您运行了正确的命令。或者你可以运行

```
$ git svn clone https://coawstmodel.sourcerepo.com/coawstmodel --trunk=COAWST --authors-file=../users.txt COAWST 
```

git-svn 在每种情况下都几乎完成了它的工作。它唯一尝试做的就是将“master”设置为指向您的主干。由于一些错误，它试图将其设置为错误的值，但您可以手动执行它

```
$ git update-ref refs/heads/master refs/remotes/git-svn 
```

如果您仍然遇到问题，您可以尝试通过3 个步骤使用[SubGit转换存储库：](http://subgit.com/)

```
$ subgit configure path/to/svn/repository
#edit path/to/svn/repository/conf/subgit.conf to set trunk = COAWST:refs/heads/master and authorsFile = path/to/users.txt
$ subgit install path/to/svn/repository 
```

转换后的存储库将位于 path/to/svn/repository/conf/.git

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-12-21T23:23:43.370

我今天遇到了同样的问题。

问题可能是 SVN 存储库没有主干目录。标准的主干、标签和分支目录在 SVN 中似乎是可选的。但是 git-svn 在迁移时需要知道这一点。

也有可能某些目录存在但名称不同。（例如，主干可以命名为“项目”而不是“主干”，分支可以像往常一样命名为“分支”，标签可能会丢失。或者“主干”可以命名为“主干”。）

*   如果 SVN 存储库中没有这些标准目录，并且所有内容都放在存储库的根目录中，那么解决方案就是不要尝试克隆标准 svn 目录。只需克隆根。

*   如果它们存在（或其中一些存在），但名称不同，则必须告知 git-svn 这些名称。

我使用**Tortoise Git**从 SVN 迁移到 GIT。在 TortoiseGit 中，它是通过从 svn 存储库克隆（是的！）并选中“来自 SVN 存储库”复选框来完成的。

*   如果 SVN 存储库中没有主干、标签或分支目录，只需取消选中克隆对话框的“来自 SVN 存储库”部分中的“主干”、“标签”和“分支”复选框。

*   如果标准目录存在，但名称与正常目录不同，请保持选中状态，但将使用的名称写入它们旁边的文本框中。

    （从命令行可以使用 -T、-t 和 -b 开关来完成。请参阅 [http://www.sailmaker.co.uk/blog/2013/05/05/migrating-from-svn-to-git -preserving-branches-and-tags-3/](http://www.sailmaker.co.uk/blog/2013/05/05/migrating-from-svn-to-git-preserving-branches-and-tags-3/) 在“非标准 SVN 布局”下）。

（这是我遇到的两种情况 - 可能存在更复杂的情况。我有几个 SVN 存储库，没有主干、标签或分支目录，取消选中这 3 个复选框使其工作。我还有一个情况，主干目录被称为“项目” 而不是“主干”，但分支目录被正常命名，并且没有标签目录。取消选中标签复选框并输入主干目录的名称使这种情况有效。）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-11-15T03:45:25.183

我相信我的 Windows 机器上安装了两组 git 二进制文件：

一种。Git（无论典型的 Windows 安装是什么——忘记我在哪里得到它）。这个在右键单击文件资源管理器上下文菜单中安装“Git Bash Here”选项。

湾。乌龟 Git。

使用“Git Bash”（即 Git）克隆非标准 svn 存储库时收到错误消息。

然后我尝试使用 TortoiseGit（正如这里的一位海报所建议的那样），并且没有错误。

但是，TortoiseGit 显示了它正在使用的实际命令行，我开始怀疑，因为该命令行与我在 Git 中未成功使用的命令行相同。

然后我再次尝试“Git Bash”并提供了我认为是 TortoiseGit git 二进制文件的完整路径，即：

```
"C:/Program Files/Git/bin/git.exe" svn clone svn://localhost/dtapublic tempgitrepo 
```

效果很好。

然而，

```
git svn clone svn://localhost/dtapublic tempgitrepo 
```

导致错误。

我相信可能有两个 git 二进制文件在起作用，这就是为什么 TortoiseGit 解决了一张海报的问题。“Git”附带的 git 二进制文件不适用于非标准 svn 存储库，而“TortoiseGit”附带的 git 二进制文件确实有效。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-07-18T14:54:10.600

也有这个问题。发现 git 命令区分大小写，并且我指定`--trunk=trunk/MyLib`的是`--trunk=trunk.Mylib`

我设法以这种方式解决了它。

希望这可以帮助某人...

# java - PreparedStatement.executeQuery 是如何工作的？

> ID：11694068
> 
> 赞同：3
> 
> 时间：2012-07-27T18:59:52.133
> 
> 标签：java, sql, sql-server-2005, jdbc

如何`PreparedStatement.executeQuery`运作？它是否从数据库中获取结果并循环遍历它们？或者它获取第一个结果，然后在 record.next 上继续 sql 查询到下一行？

```
ResultSet record = statement.executeQuery("select * from users");
    while (record.next()) {
    //do something
} 
```

谢谢你

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-27T19:06:47.883

从文档中：

[陈述](http://docs.oracle.com/javase/6/docs/api/java/sql/Statement.html#executeQuery%28java.lang.String%29)

> ```
> public ResultSet executeQuery(String sql) throws SQLException 
> ```
> 
> 执行给定的 SQL 语句，该语句返回单个 ResultSet 对象。

[结果集](http://docs.oracle.com/javase/6/docs/api/java/sql/ResultSet.html)

> 表示数据库结果集的数据表，通常通过执行查询数据库的语句生成。
> 
> ```
> public boolean next() throws SQLException 
> ```
> 
> 将光标从其当前位置向下移动一行。ResultSet 游标最初位于第一行之前；第一次调用 next 方法使第一行成为当前行；第二次调用使第二行成为当前行，依此类推。
> 
> 如果当前行的输入流打开，则调用 next 方法将隐式关闭它。读取新行时会清除 ResultSet 对象的警告链。

* * *

作为一种表示，这意味着该语句执行一次，并且在迭代时迭代该执行的结果。

* * *

但是如何处理来自数据库的结果实际上取决于实现。为了进行对比，我将参考两个数据库 MSSQL、MYSQL。

## 微软SQL

MSSQL 驱动程序的文档准确地说明了结果的处理方式，您可以在[此处](http://msdn.microsoft.com/en-us/library/ms379039.aspx)找到：

> 有两种类型的结果集：客户端和服务器端。
> 
> 当结果可以适合客户端进程内存时，使用客户端结果集。这些结果提供了最快的性能，并由 Microsoft JDBC Driver for SQL Server 从数据库中完整读取。这些结果集不会通过产生创建服务器端游标的开销而对数据库施加额外的负载。但是，这些类型的结果集是不可更新的。
> 
> 当结果不适合客户端进程内存或结果集可更新时，可以使用服务器端结果集。使用这种类型的结果集，JDBC 驱动程序会创建一个服务器端游标，并在用户滚动浏览结果集时透明地获取结果集的行。

## MySQL

[您可以在此处](http://dev.mysql.com/doc/refman/5.0/en/connector-j-reference-implementation-notes.html)阅读的 JDBC 接口的 MySql 实现：

> 默认情况下，ResultSet 被完全检索并存储在内存中。在大多数情况下这是最有效的操作方式，并且由于 MySQL 网络协议的设计更容易实现。如果您正在使用具有大量行或大值的 ResultSet，并且无法在 JVM 中为所需的内存分配堆空间，您可以告诉驱动程序一次将结果流回一行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-27T19:03:39.420

你做对了。它从您的查询中获取整个结果，然后您遍历它们。
内部指针或游标最初在第一行*之前*开始，因此调用`record.next()`会将其移动到第一行。

[http://docs.oracle.com/javase/1.4.2/docs/api/java/sql/ResultSet.html#next%28%29](http://docs.oracle.com/javase/1.4.2/docs/api/java/sql/ResultSet.html#next%28%29)

# javascript - 如何让 impress.js 幻灯片自动播放和循环播放

> ID：11694069
> 
> 赞同：6
> 
> 时间：2012-07-27T18:59:53.090
> 
> 标签：javascript, impress.js

我有一个幻灯片，我想自动播放并连续循环播放。我找到了一些片段，可以让我设置全局幻灯片持续时间并使用 impress.next() 和 setInterval() 调用来继续前进，但是我失去了为每张幻灯片设置不同持续时间的能力。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-07-27T18:59:53.090

我很高兴分享我的解决方案。如果您看到改进的空间，请不要害羞。希望这可以帮助那里的人。

```
<script>
  var impress = impress();
  impress.init();

  document.addEventListener('impress:stepenter', function(e){
    if (typeof timing !== 'undefined') clearInterval(timing);
    var duration = (e.target.getAttribute('data-transition-duration') ? e.target.getAttribute('data-transition-duration') : 2000); // use the set duration or fallback to 2000ms
    timing = setInterval(impress.next, duration);
  });
</script> 
```

# javascript - 脚本在 JSfiddle 中运行良好，但在现场却不行

> ID：11694071
> 
> 赞同：0
> 
> 时间：2012-07-27T19:00:02.387
> 
> 标签：javascript, jquery, html

我正在研究在单击图像时显示/隐藏 div 并在页面加载时随机显示 div 的能力。我不太确定它为什么在测试区域（JSfiddle）中有效，但在我将它实施到站点时却不是。

这里是小提琴的链接：http: [//jsfiddle.net/JmVUx/17/](http://jsfiddle.net/JmVUx/17/)

这是我正在处理的网站的演示： http: [//sjdunham.com/test/yzn/](http://sjdunham.com/test/yzn/)

我错过了什么吗？不太清楚两者之间可能有什么区别。我已经尝试删除对其他脚本的任何其他引用，但仍然没有成功。我在检查器的演示站点上看不到任何错误。在过去的 4 个小时里，我一直盯着这个，我不知道是什么导致了这个问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-27T19:07:10.107

您在网站上有其他`<a>`元素。使用`$("a.control")`代替，并使用`.eq`代替`$($(...).get(x))`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T19:14:33.473

I've checked both of your codes and see that there's something smoothly different:

```
var randomIndex = Math.floor((Math.random() * 100) + 1)%2; // Site version
var randomIndex = Math.floor((Math.random() * 100)+ 1)%3;  // jsFiddle version 
```

Check everything out again. Maybe you get the answer. It should be random with both implementations, but it may not be random enough. What I mean is: it can be resulting much of the same randomIndex, so you cannot check the difference when loading page.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-27T19:20:56.810

您正在使用，并且在对正在使用的`Cufon font`任何更改后需要刷新以生效，因此在您的代码的最后添加此行，即`dom``Cufon font``Cufon.refresh();`

```
// other code
$('#' + field + '-gallery, #' + field + '-tag').fadeIn("slow");
Cufon.refresh(); // without this line your dom won't refresh (only for cufon font) 
```

您的所有内容都`p`替换为`cufon`如下代码，因为`Cufon.replace(...)`

```
<p>
    <cufon class="cufon cufon-canvas" alt="In " style="width: 20px; height: 16px; ">
        <canvas width="33" height="16" style="width: 33px; height: 16px; top: 0px; left: 0px; "></canvas>
        <cufontext>In </cufontext>
    </cufon>
    <cufon class="cufon cufon-canvas" alt="today's " style="width: 65px; height: 16px; ">
        <canvas width="78" height="16" style="width: 78px; height: 16px; top: 0px; left: 0px; "></canvas>
       <cufontext>today's </cufontext>
   </cufon>
   ....
</p> 
```

[**关于so​​的另一个答案**](https://stackoverflow.com/questions/11475807/superfish-cufon-hover/11477214#11477214)。

# sql - 使用批量插入 SQL Server 2008 导入现有表

> ID：11694073
> 
> 赞同：4
> 
> 时间：2012-07-27T19:00:23.900
> 
> 标签：sql, sql-server-2008

我已经有一个包含数百万行的现有表。外部文本文件（制表符分隔）需要能够用于现有表。在两组数据都在同一个表中后，我将进行规范化。我现有的表与我正在导入的表具有相同的表结构。如果我做类似的事情

```
BULK INSERT TableName
        FROM 'C:\SomeDirectory\my table.txt'
            WITH
    (
                FIELDTERMINATOR = '\t',
                ROWTERMINATOR = '\n'
    )
GO 
```

这会追加还是替换现有数据？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-27T19:04:17.583

它附加。如果要替换，请先 TRUNCATE 或 DELETE。

# javascript - 来自 JQuery AJAX 的 JSON 调用比数据库本身更大

> ID：11694075
> 
> 赞同：0
> 
> 时间：2012-07-27T19:00:48.870
> 
> 标签：javascript, jquery, ajax, database, json

这是代码：

```
$.ajax({
 url:"http://.....pullEntireDBPopulation.php",
 cache:false,
 datatype:"json",
 success:function(popData){
  alert("Population size: " + popData.length);
  popProducers = new Array();
  for(i=0;i<popData.length;i++){
   popProducers[i] = popData[i].ProducerName;
  }
 });
} 
```

我已经编写了 .PHP 来从数据库中提取每条数据，我已经在浏览器上检查了这些数据，所以我知道不是这样。尽管如此，每次我运行该页面时，它都会说该数组大约有 5000 长，尽管它比整个数据库都大。这是怎么回事？？？如果它有帮助，它还说当我将数据写入数组时，它们在数组中是未定义的。因此，数据被读入页面显然存在问题，因为我知道它可以独立工作，但我无法弄清楚。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T19:12:59.107

PopData is Object, not Array. And then `length` can work uncorrectly. For the same reason you can not apply "`for`".

Try

`popData.size()` or `$(popData).size()`

`popData.each(function(){ popProducers[i] = this.ProducerName; })` (or `$(popData).each`...)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-30T17:48:37.030

我发现了问题。`datatype: "json"`当它是这样愚蠢的事情时，显然不会像`dataType: "json"`我讨厌的那样呈现！由于我的大写错误，它没有将它作为 JSON 读取，它只是读取字符串而不是对象数组--> 问题。

# android - android中的mailto URI解析

> ID：11694082
> 
> 赞同：0
> 
> 时间：2012-07-27T19:01:26.950
> 
> 标签：android

我有一个发送反馈的按钮。在模拟器中，它当前显示“无法执行此操作”。我的应用程序也会在真实设备上这样说吗？如果是这样，实现 mailto 功能的解决方法是什么？我确实看到[了这个](https://stackoverflow.com/questions/3671303/mailto-links-unsupported-in-android)页面，但我无法在我的 MainActivity 中实现 webView

```
 Button btn2 = (Button)findViewById(R.id.feedback);
    btn2.setOnClickListener(new OnClickListener(){
        public void onClick(View v) {
            Uri address = Uri.parse("mailto:prasana91@gmail.com?subject=calculator_feedback");
            Intent i = new Intent(Intent.ACTION_VIEW,address);
            startActivity(i);
        }
        }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-27T19:15:50.677

您可以使用您发布的链接中的代码。我没有尝试过，但我不明白为什么它不起作用：

```
Intent i = new Intent(Intent.ACTION_SEND);
i.setType("text/plain");
i.putExtra(Intent.EXTRA_EMAIL, new String[]{ "prasana91@gmail.com" });
i.putExtra(Intent.EXTRA_SUBJECT, "calculator_feedback");
startActivity(i); 
```

让我知道这是否有效。

# java - JComboBox：ItemStateChange 上的行为

> ID：11694085
> 
> 赞同：5
> 
> 时间：2012-07-27T19:01:33.573
> 
> 标签：java, swing, jcombobox, joptionpane, itemlistener

所以我有一个要求，即基于从 JComboBox 中选择一个项目，我需要向用户展示一个选择确认对话框。我所做的是添加一个`ItemListener`并基于一定的逻辑，我弹出了这个对话框。

我面临的相当烦人的问题是对话框首先弹出（即使 ComboBox 项目选择已打开），我必须单击两次以确认我的选择。第一个是关闭 ComboBox 弹出窗口，第二个是确认对话框中的实际弹出窗口。

这是一个突出我的问题的 SSCCE：

```
import java.awt.event.ItemEvent;
import javax.swing.JOptionPane;

public class TestFrame extends javax.swing.JFrame {

    /**
     * Creates new form TestFrame
     */
    public TestFrame() {
        initComponents();
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jLabel1 = new javax.swing.JLabel();
        selectCombo = new javax.swing.JComboBox();

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);

        jLabel1.setText("Select Option");

        selectCombo.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "Option 1", "Option 2", "Option 3", "Option 4" }));
        selectCombo.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                selectComboItemStateChanged(evt);
            }
        });

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jLabel1)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(selectCombo, javax.swing.GroupLayout.PREFERRED_SIZE, 155, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(168, Short.MAX_VALUE))
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                .addContainerGap(22, Short.MAX_VALUE)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel1)
                    .addComponent(selectCombo, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(19, 19, 19))
        );

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void selectComboItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_selectComboItemStateChanged
        if (evt.getStateChange() == ItemEvent.SELECTED) {
            String selectedItem = (String) selectCombo.getSelectedItem();
            if (selectedItem == null || selectedItem.equals("Option 1")) {
                return;
            } else {
                JOptionPane.showConfirmDialog(this, "Do you want to change option to - " + selectedItem + " ?", "Confirm Option Selection", JOptionPane.YES_NO_OPTION);
            }
        }
    }//GEN-LAST:event_selectComboItemStateChanged

    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {

        try {
             javax.swing.UIManager.setLookAndFeel("com.sun.java.swing.plaf.windows.WindowsLookAndFeel");
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(TestFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(TestFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(TestFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(TestFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>

        /*
         * Create and display the form
         */
        java.awt.EventQueue.invokeLater(new Runnable() {

            public void run() {
                new TestFrame().setVisible(true);
            }
        });
    }
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JLabel jLabel1;
    private javax.swing.JComboBox selectCombo;
    // End of variables declaration//GEN-END:variables
} 
```

有人可以告诉我我做错了什么吗？我希望在用户完成选择他的选项并且 ComboBox 弹出窗口关闭后弹出确认对话框。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-27T19:05:21.000

我会通过调用适当的方法来做到这一点：

```
else {
            selectCombo.setPopupVisible(false);
            JOptionPane.showConfirmDialog(this, "Do you want to change option to - " + selectedItem
                    + " ?", "Confirm Option Selection", JOptionPane.YES_NO_OPTION);
        } 
```

# python - Python：OpenCv 函数 cvHaarDetectObjects 返回什么？

> ID：11694087
> 
> 赞同：0
> 
> 时间：2012-07-27T19:01:39.557
> 
> 标签：python, opencv, tracking

我正在尝试制作一个使用面部碰撞的游戏。但我还没有弄清楚 cvHaarDetectObjects 返回什么。这是一小段代码。

```
cascade = cv.Load('haarcascade_frontalface_alt.xml')
faces = cv.HaarDetectObjects(grayscale, cascade, storage, 1.2, 2,
cv.CV_HAAR_DO_CANNY_PRUNING)

if faces:
    for i in faces:
        print i 
```

我得到这样的东西 :((74, 22, 149, 149), 3) 这些信息是什么？泰

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T19:22:20.550

从[文档](http://opencv.willowgarage.com/documentation/python/objdetect_cascade_classification.html)：

> 该函数在给定图像中查找可能包含已训练级联对象的矩形区域，并将这些区域作为矩形序列返回......
> 
> 该函数返回一个元组列表 (rect, neighbors) ，其中 rect 是一个 CvRect 指定对象的范围，neighbors 是许多邻居。

另请参阅[此 SO 问题](https://stackoverflow.com/questions/7948055/classifiers-confidence-in-opencv-face-detector)。

# sql - SQL WHERE 子句上的 CHARINDEX

> ID：11694096
> 
> 赞同：0
> 
> 时间：2012-07-27T19:02:21.677
> 
> 标签：sql

我在表中有一个列，其中包含示例数据，如下所示：

```
ServiceTypeIDs
1,9
4 
```

在我的 Where 子句中，我使用以下内容对其进行搜索：

```
 WHERE
( @ServiceTypes is null or       
   charindex(','+cast(SEP.ServiceTypeIDs as varchar(255))+',',      
   ','+@ServiceTypes+',') > 0))) 
```

如果我的参数`@ServieTypes`等于`'1,9'`，那么我会得到结果，但是当它是`@ServiceTypes = '1'`or just时`'9'`，我不会收到任何回复。我被卡住并尝试了上述方法。

```
exact column looks like below

7
8
2
5
4
7
7
7
7
7
7
1
7
null
6,7
7
6
1
7
null
7
7
7
7
7
8
7
6
1
1
1
6
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
7
1
7
7
1
7
8
7
1
1
2
1
null
7
7
7
7
7
7
7
7
7
7
7
7
7
8
6
7
7
7
7
7
7
7
7
7
7
7
7
7
7
7
7
7
1
7
7
1
7
7
7
7
7
7
7
7
7
7
7
7
7
7
7
7
7
7
7
7
7
7
7
7
7
7
7
7
7
7
7
7
7
1
1
1
1
1,2
1
1
1,2
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1,2
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
null
7
7
7
7
7
7
7
7
7
7
7
7
7
7
7
7
7
7
7
7
7
7
7
7
7
7
7
7
7
7
6
7
7
1
8
7
7
7
7
7
7
7
7
7
7
7
2
7
null
null
1
1
1
1
1
7
7
7
1,2
6
7
1
2
1
1
7
7
7
7
7
7
7
7
7
7
7
7
7
7
7
7
7
7
7
7
7
7
7
7
7
7
7
7
7
7
7
7
5
5
1
1
1
7
7
7
1
7
7
7
7
7
7
7
7
7
7
7
7
7
7
7
7
3
1
9
9
9
9
null
9
1,2
9
9
9
8,9
1,9
1,9
1,9
2,9
1,9
1,9
1,9
1,8
1,9
1,9
9
9
9
9
5
4
3
1
null
1,2,3
6
9
9
9
8,9
9
9
9
1,9 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T19:07:44.153

你的论点[`CHARINDEX`](http://msdn.microsoft.com/en-us/library/ms186323.aspx)是相反的。改用这个：

```
CHARINDEX(','+@ServiceTypes+',', ','+CAST(SEP.ServiceTypeIDs AS VARCHAR(255))+',') > 0 
```

应该注意的是，您的实际问题是糟糕的数据库设计。您永远不应该将列表存储为这样的字符串，而是使用单独的表，每个关联一行。

# soapui - soapui 访问属性文件中的属性

> ID：11694097
> 
> 赞同：1
> 
> 时间：2012-07-27T19:02:24.153
> 
> 标签：soapui

我想从属性文件中加载属性，如此处所述[http://www.soapui.org/Scripting-Properties/working-with-properties.html](http://www.soapui.org/Scripting-Properties/working-with-properties.html)。我正在使用 testrunner.sh 来运行测试。我想做类似的事情，`./testrunner.sh -PServiceEndPoint=${serviceendpointvalue} sample_soapuitest.xml`但它不起作用。

serviceendpointvalue 已在 properties.txt 中定义。我修改了 testrunner.sh 中的 JAVA_OPTS 以包含 properties.txt。

有人试过这个吗？有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-28T18:02:34.643

我认为必须在从文件加载属性之前定义传递给 testrunner.sh 的参数。

不过，我 99% 确信您可以通过其他方式完成您想要的。

参数化请求中的端点。如果这是很多工作，我建议在文本编辑器中使用搜索和替换。我以前做过，而且效果很好。您只需注意服务端点可能出现的其他位置（例如在 WSDL/WADL/XSD 引用等中）

您希望在请求中为端点提供什么取决于您使用的是 SOAP 还是 REST。

```
For SOAP:  ${#Project#endpoint}
(assuming that your endpoint property is a project property)

For REST:  http://${#Project#server} 
```

我忘记了为什么它必须有所不同，但弄清楚它是一件痛苦的事。

在属性字段中，数据如下所示：

```
SOAP: http://server:8080
REST: server:8080
(whatever port is relevant) 
```

您可以使用文件设置这些属性。文件将在执行开始时被解析，请求将使用文件中的属性值。

于 2012 年 7 月 30 日编辑

您仍然可以使用我提到的方法。

此命令行运行我的示例测试，指定 test.props 文件。该文件中只有以下内容：

test=1234（由导出属性输出）

我的项目将名为 test 的项目属性设置为 1234 之外的另一个值。

ndfdXML 是我的项目名称.. 只是一个示例名称。

命令行：

C:\Program Files\SmartBear\soapUI-4.5.1\bin>testrunner.bat -Dsoapui.properties.ndfdXML=test.props ndfdXML-soapui-project.xml

```
soapUI 4.5.1 TestCase Runner
Configuring log4j from [C:\Program Files\SmartBear\soapUI-4.5.1\bin\soapui-log4j.xml]
14:32:29,283 INFO  [DefaultSoapUICore] initialized soapui-settings from     [C:\Users\chris.mead\soapui-settings.xml]
14:32:30,081 INFO  [WsdlProject] Loaded project from  [file:/C:/Program%20Files/SmartBear/soapUI-4.5.1/bin/ndfdXML-soapui-project.xml]
14:32:30,089 INFO  [AbstractTestPropertyHolderWsdlModelItem] Overriding 1 properties  from [test.props] in [ndfdXML]
14:32:30,702 INFO  [SoapUITestCaseRunner] Running soapUI tests in project [ndfdXML]
14:32:30,717 INFO  [SoapUITestCaseRunner] Running Project [ndfdXML], runType =  SEQUENTIAL
14:32:30,718 INFO  [SoapUITestCaseRunner] Running soapUI testcase [TestCase 1]
14:32:30,718 INFO  [SoapUITestCaseRunner] running step [CornerPoints - Request 1]
14:32:31,132 WARN  [AbstractSoapVersion] Ignoring validation error: error: cvc-complex- type.3.2.2: Attribute not allowed: encodingStyle@http://schemas.xmlsoap.o
rg/soap/envelope/ in element Envelope@http://schemas.xmlsoap.org/soap/envelope/
14:32:31,449 INFO  [SoapUITestCaseRunner] Assertion [SOAP Response] has status VALID
14:32:31,450 INFO  [SoapUITestCaseRunner] Assertion [XPath Match] has status VALID
14:32:31,450 INFO  [SoapUITestCaseRunner] running step [Properties]
14:32:31,454 INFO  [SoapUITestCaseRunner] running step [Property Transfer]
14:32:31,523 INFO  [SoapUITestCaseRunner] running step [Groovy Script]
14:32:31,912 INFO  [log] 1234 
```

最后一行是这个 groovy 输出的：

log.info(context.expand('${#Project#test}'))

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-30T10:10:50.993

文档中的示例相当不完整；您可以强制从 Java System Properties 中获取值，如下所示：

```
systemProperty = context.expand('${=System.getProperty("soapui.home")}')
testRunner.testCase.setPropertyValue("systemProperty", systemProperty)
log.info("systemProperty="+testRunner.testCase.getPropertyValue("systemProperty")) 
```

# .htaccess - htaccess 使用通配符和多个子域重写

> ID：11694098
> 
> 赞同：0
> 
> 时间：2012-07-27T19:02:26.467
> 
> 标签：.htaccess, rewrite, wildcard, subdomain

我想使用单个域在单个虚拟主机上实现 TEST、CERT 和 PROD 网页。这些网站对第一个子域使用通配符。

我有以下代码：

```
# for TEST
RewriteCond %{HTTP_HOST} (.*).test.domain.com
RewriteCond %{REQUEST_URI} !^/directory3
RewriteRule ^(.*)$ /directory3/$1 [L]

# for CERT
RewriteCond %{HTTP_HOST} (.*).cert.domain.com
RewriteCond %{REQUEST_URI} !^/directory2
RewriteRule ^(.*)$ /directory2/$1 [L]

# for PROD
RewriteCond %{HTTP_HOST} (.*).domain.com
RewriteCond %{REQUEST_URI} !^/directory1
RewriteRule ^(.*)$ /directory1/$1 [L] 
```

这有 3 个问题：
**1)**浏览器地址栏中的 URL 已更改，因此用户可以看到新的 URL。我希望用户看到原始类型的 URL
显示：

```
http:\\subdomain1.cert.com\directory2 
```

代替：

```
http:\\subdomain1.cert.com 
```

**2)** TEST 和 CERT 重写具有`Internal Server Error`.
当我替换固定子域的通配符时它工作正常

**3）** PROD RweriteCond 总是有效的（对于 CERT 和 TEST 子也是如此。这意味着它总是被转发到 directory1

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T19:08:58.613

规则互相干扰。因为 host:`(.*).domain.com`也匹配 cert 和 test 主机。您需要在“PROD”规则中排除它们：

```
RewriteCond %{HTTP_HOST} !test.domain.com
RewriteCond %{HTTP_HOST} !cert.domain.com
RewriteCond %{HTTP_HOST} (.*).domain.com
RewriteCond %{REQUEST_URI} !^/directory1
RewriteRule ^(.*)$ /directory1/$1 [L] 
```

这解决了#2 和#3。`http://`至于被重定向，那是另外一回事，除非目标中有一个或`R`方括号中有一个标志，否则这些规则不会重定向浏览器。

# apache - Magento：如何使用斜杠（文件夹）创建新 URL？

> ID：11694099
> 
> 赞同：1
> 
> 时间：2012-07-27T19:02:28.097
> 
> 标签：apache, url, magento, magento-1.7

我正在使用 magento 1.7.0.2，并且我有一个[扩展](http://www.magentocommerce.com/magento-connect/pagseguro-by-os-studios-1439.html)程序需要我设置 URL：

```
http://www.yourstore.com/pagseguro/pay/success/ 
```

这个 url 将被第三方使用到 API 以重定向回我的网站。我无法设置它。

我试图设置一个 CMS 页面，但它似乎不适用于任何斜线。我能够在 CMS 页面中设置 a`pagseguro`作为关键 URL，但是每当我尝试`pagseguro/pay/success/`作为关键 URL 甚至`pagseguro/`时，它都不起作用。

我怎样才能做到这一点？我启用了“使用 Web 服务器重写”，但即使禁用它，它也不起作用。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T19:22:13.500

url 重写或扩展名，其中`pagseguro`将是扩展名，`pay`-控制器和`success`-操作。但只要您只需要一个页面，我建议您重写 url。因此，假设您`pagseguro`设置了 CMS 页面，请转到`Admin\Catalog\Url Rewrite Management`并添加一个条目：

```
Type: Custom
ID Path: whatever
Request Path: pagseguro/pay/success
Target Path: pagseguro
Redirect: No 
```

# php - Magento 无法在另一个页面上获取会话值

> ID：11694100
> 
> 赞同：0
> 
> 时间：2012-07-27T19:02:34.877
> 
> 标签：php, session, magento

在列表页面上，我正在设置会话值，并且可以在那里访问。但是在产品视图页面上我无法获得价值。

```
 <?php 
  Mage::getSingleton('core/session')->setCategoryProductsIds($_catProductIds);

  $all_product_ids = Mage::getSingleton('core/session')->getCategoryProductsIds();
  print_r($all_product_ids); 
  ?> 
```

感谢您的任何建议，我被卡住了！！！！

需要注意的一件有趣的事情：这在 Safari 中按预期工作，但 Chrome 和 IE 正在产生上述问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T10:29:20.157

在 magento 中将会话值设置为会话 ID 有点不同。如果您想遵循 Magento 流程，则必须编写下面给出的代码来设置值并获取特定 Session Id 的值。

设置会话写入：

```
<?php Mage::getSingleton('core/session')->setData('session_Id'); ?> 
```

要获得该会话值，请写入：

```
<?php Mage::getSingleton('core/session')->getData('session_Id'); ?> 
```

# asp.net - 删除在离开时上传的不需要的文件 最佳实践

> ID：11694101
> 
> 赞同：0
> 
> 时间：2012-07-27T19:02:36.793
> 
> 标签：asp.net, image, image-uploading

嗨，我很困惑。我有一个可以接受多个[图像上传](http://www.dotnetcurry.com/ShowArticle.aspx?ID=317)的页面，比如最多 5 个。我添加了一些附加功能，例如在用户点击“全部上传”按钮时选择所需文件后，图像被保存到 App_Images 文件夹并且页面显示带有图像的占位符上传。

到目前为止一切都很好。

**大问题**

当用户没有点击最终的“提交”按钮（完成在页面上发布故事/漫画的活动）就离开时，图像仍然被保存。我想删除它们。我不想使用客户端脚本“您确定要离开此页面吗？” 有点东西。（如果它是唯一的选择，我在卸载之前尝试过，但我无法完美地实现它来删除图像。我需要考虑这一点。）

**我的想法**

1.  有没有办法实现一个功能来显示从用户机器本身上传的图像，并在单击提交按钮时我想将它们保存到 App_Images 文件夹？
2.  我可以将它们保存到名为 App_Temp 文件夹的文件夹中，并且在提交时我可以将它们保存到 App_Images 文件夹并从 App_Temp 文件夹中删除它们吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T19:13:11.450

我会自发地将图像保存在临时文件夹中，并在提交时将它们移动到生产目录。然后在图像足够老可以成为孤儿的给定时间清理临时文件夹。

//JaggenSWE

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T19:21:18.923

另一种选择是重新排列事物，以便在用户按下“最终提交”按钮时进行图像上传。

# javascript - 使用 Raphael JS 制作可点击对象

> ID：11694104
> 
> 赞同：0
> 
> 时间：2012-07-27T19:03:08.073
> 
> 标签：javascript, jquery, html, css, raphael

我创建了一个 3d 外观的圆圈，并希望它可以点击并显示其数据。我似乎无法让它工作。有人可以帮我解决这个问题吗？？？我尝试执行此操作的代码靠近底部....

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="en">
    <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Raphaël · Ball</title>
    <link rel="stylesheet" href="demo.css" type="text/css" media="screen">
    <link rel="stylesheet" href="demo-print.css" type="text/css" media="print">
    <script src="raphael.js" type="text/javascript" charset="utf-8"></script>
    <script type="text/javascript" charset="utf-8">
        Raphael.fn.ball = function (x, y, r, hue) {
            hue = hue || 0;
            return this.set(
                //this part is the drop shadow
                this.ellipse(x, y + r - r / 5, r, r / 2).attr({fill: "rhsb(" + hue + ", 1, .25)-hsb(" + hue + ", 1, .25)", stroke: "none", opacity: 0}),
                //this part is the top part of the circle
                this.ellipse(x, y, r, r).attr({fill: "r(.5,.9)hsb(" + hue + ", 1, .75)-hsb(" + hue + ", .5, .25)", stroke: "none"}),
                //this is the inner glow part from the top
                this.ellipse(x, y, r - r / 5, r - r / 20).attr({stroke: "none", fill: "r(.5,.1)#ccc-#ccc", opacity: 0})
            );
        };
        window.onload = function () {
            var R = Raphael("holder"), x = 300, y = 100, r = 100;
            //I cant tell what numbers are passed into here?????
            R.ball(x, y, r, Math.random()).data("i", i).click(function () {
            alert(this.data("i"));
         });
        };
    </script>
    </head>
    <body>
        <div id="holder"></div>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T20:05:02.360

如果我在这里弄错了，我深表歉意...但是此代码的示例对我来说很好用...。不幸的是，我似乎无法`var i`在您传递给的代码中找到`data('i',i)`...声明`var i = something;`或尝试此数据（ 'i','Hello') 让您知道它有效……希望对您有所帮助。

**[jsFiddle](http://jsfiddle.net/npzMU/)**

# python - 遍历一个文本文件并为每一行写一个新的文本文件 python

> ID：11694106
> 
> 赞同：3
> 
> 时间：2012-07-27T19:03:12.077
> 
> 标签：python

我正在尝试完成看似简单的任务，但我似乎无法弄清楚。我是 Python 菜鸟。

这是我的任务：
我有一个包含数字列表的文本文件，每个数字都在单独的行中......

```
100101
100201
100301
100401
100501
100601
100701
100801
100901
101001 
```

我想做的是从文本文件中读取并为包含该行的文件中的每一行编写一个新的文本文件，并且也使用该行命名...

```
100101.txt
contains one line of text "100101"

100201.txt
contains one line of text "100201"

etc... 
```

希望这是有道理的......谢谢！

海纳森

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-27T19:21:36.350

试试这个：

```
with open('data.txt') as inf:
    for line in inf:
        num = line.strip()
        if num:
            fn = '%s.txt' %num
            with open(fn, 'w') as outf:
                outf.write('contains one line of text "%s"\n' %num) 
```

使用该`with`构造确保每个文件在不再需要时关闭（或者如果应该发生异常）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-27T19:11:13.753

编辑：用于`with`使执行更安全。

```
lines = open(your_file, 'r')
for line in lines.readlines():
    with open(str(line).rstrip()+'.txt','w') as output_file
        output_file.write(line)
lines.close() 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-27T19:08:35.637

请注意，以下内容不会检查具有相同名称的预先存在的文件。

```
with open('numbers_file.txt','r') as numbers:
    for line in numbers:
        with open(line.rstrip() + '.txt','w') as new_file:
            new_file.write(line) 
```

# sql - 从三个不同的 select max 查询中选择最大值

> ID：11694109
> 
> 赞同：0
> 
> 时间：2012-07-27T19:03:27.227
> 
> 标签：sql, union, max

我有这个查询，它获取三个不同表的最大日期记录。我可以对这些表进行联合，让它们一起返回各自的日期。但是，我无法找到一种方法来选择返回的这三个记录中的最大值。有任何想法吗？

```
SELECT MAX (Date_submitted ) as a
FROM [AngelSQL] . [dbo]. [LSN_RESPONSES] , ACCOUNTS , LSN_ENTRIES , GB3_ASSOCIATIONS
where
LSN_RESPONSES . USER_ID = accounts . username
and LoginName = 'admin'
and TakenFromCourseId = 'TT-TC-TS-TD-Test-Test'
and LSN_RESPONSES . PARENT_ID = LSN_ENTRIES .ENTRY_ID
and LSN_RESPONSES . PARENT_ID = GB3_ASSOCIATIONS .LSN_ENTRY_ID
union
SELECT MAX ( dateEnd ) as a
FROM [AngelSQL] . [dbo]. [qti_assessment_attempt] ,dbo . ACCOUNTS, COURSES, qti_question_containers, GB3_ASSOCIATIONS
where   accounts . PERSON_ID = qti_assessment_attempt .person_id
and
taken_from_course_container_id = courses. CONTAINER_ID
and
accounts .LoginName = 'admin'
and COURSES . COURSE_ID= 'TT-TC-TS-TD-Test-Test'
and qti_assessment_attempt . question_container_id = qti_question_containers. id
and qti_question_containers . entry_ID = GB3_ASSOCIATIONS .LSN_ENTRY_ID
union
SELECT MAX ( PostDate ) as a
FROM dbo . ACCOUNTS, DiscussionPost , DiscussionForum , GB3_ASSOCIATIONS
where
accounts .USERNAME = DiscussionPost. AuthorId
and
LoginName ='admin'
and
discussionpost . CourseContext = 'TT-TC-TS-TD-Test-Test'
and
DiscussionPost . ForumId = DiscussionForum .ForumId
and DiscussionForum . EntryId = GB3_ASSOCIATIONS .LSN_ENTRY_ID} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T19:12:54.010

将您的查询用作子查询/CTE，如下所示：

```
with t as (<put your query here>)
select max(a)
from t 
```

# android - 如何停止通过 Soundpool 播放声音？

> ID：11694110
> 
> 赞同：6
> 
> 时间：2012-07-27T19:03:36.150
> 
> 标签：android, soundpool

请看一下这些代码：

```
private SoundPool soundPool;
private int soundID;

soundPool = new SoundPool(10, AudioManager.STREAM_MUSIC, 0);
soundID = soundPool.load(this, R.raw.batimanbailedosenxutos, 1); 
```

当我按下按钮时：

```
soundPool.play(soundID, volume, volume, 1, 0, 1f); 
```

如果我同时按下此按钮两次，它会同时播放声音，如果用户在播放时按下按钮，我想停止声音并再次播放

我试着放一个

```
soundPool.stop(soundID); 
```

在 soundPool.play 之前，但我不知道为什么它只适用于歌曲播放 1 次，你们知道为什么这只适用于 1 次吗？我该如何解决这个问题？谢谢

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-07-27T19:11:06.837

该方法`stop()`采用当前播放流的流 ID，而不是您已加载的声音 ID。所以是这样的：

```
int streamId = soundPool.play(soundID, volume, volume, 1, 0, 1f);

soudPool.stop(streamId);
streamId = soundPool.play(soundID, volume, volume, 1, 0, 1f); 
```

将停止当前播放的曲目并开始另一个。第二种选择是限制您`SoundPool`允许的流数量。如果您将您`SoundPool`的`maxStreams`值实例化为 1，那么当您尝试启动另一个声音时，任何当前播放的声音都会停止，这可能会更干净地实现您想要的行为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-27T15:37:58.410

你可以看到代码

```
public static void clear() {
        if (mSoundManager != null) {
            mSoundManager.mSoundPool = null;
            mSoundManager.mAudioManager = null;
            mSoundManager.mSoundPoolMap = null;
        }
        mSoundManager = null;
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-08-20T11:59:18.093

我通过再次加载soundpool track id来做到这一点..

```
mSoundPool.Stop(trackID);
trackID.load(getApplicationContext(),R.raw.audioclip,1; 
```

您可以在任何地方再次播放 mSoundPool.play()。

# c# - 将字符串转换为 HttpPostedFileBase

> ID：11694112
> 
> 赞同：3
> 
> 时间：2012-07-27T19:03:44.033
> 
> 标签：c#, .net, asp.net-mvc, asp.net-mvc-3, file

我正在尝试使用 MVC 上传附件功能。我实际执行上传/保存附件的方法需要一个 HttpPostedFileBase 类型。

```
public virtual string Upload(HttpPostedFileBase fileName) 
{
     //Code to upload/save attachment.
} 
```

我的问题是“fileName”作为字符串从 UI 传递。如何将字符串（文件路径名）转换为我的 Upload 方法可以使用的内容。

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-27T19:19:40.193

正如其他人所提到的，您的表单应如下所示：

```
<form id="form_UploadFile" action="" method="post" enctype="multipart/form-data">
  <label for="file">Filename:</label>
  <input type="file" name="file" id="file" />
</form> 
```

然后，正如您提到的，您尝试通过 ajax 发布，您可以使用 jQuery [serialize()](http://api.jquery.com/serialize/)序列化要推送到控制器的 formData。

```
$('#form_UploadFile').serialize(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-27T19:07:06.853

您不能只从 UI 传递一个字符串，您需要从`input type="file"`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-27T19:10:37.920

你必须让你的`<form>`标签看起来像这样：

```
<form action="" method="post" enctype="multipart/form-data"> 
```

然后您将收到适当的`HttpPostedFileBase`对象

关于所有细节，您可以参考这篇[文章。](http://haacked.com/archive/2010/07/16/uploading-files-with-aspnetmvc.aspx)

**更新**

使用 ajax 提交表单没有任何区别：

```
@using (Ajax.BeginForm("YourActionName", null, new AjaxOptions { UpdateTargetId = "YourTargetId" }, new { enctype = @"multipart/form-data" }))
{
    //Your inputs here
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-27T19:11:52.917

你记得使用详细`Html.BeginForm`方法吗？

```
 @using (Html.BeginForm("Attach", "File", FormMethod.Post, new { enctype = "multipart/form-data" })) {
    } 
```

重要的部分是`enctype="multipart/form-data"`

# javascript - 如何更改 iFrame 中元素的样式

> ID：11694113
> 
> 赞同：1
> 
> 时间：2012-07-27T19:03:45.717
> 
> 标签：javascript, html

# 问题：

我正在设计一个在所有页面上使用相同侧边栏的网站，因此我将侧边栏放在 iFrame 中以便以后编辑...但是在每个页面上，我希望 iFrame 中的当前页面链接为粗体...请您帮忙提供一个 JavaScript 语句或函数来解决这个问题。

我目前的代码如下：

### HTML（主网页）：

```
<!DOCTYPE html>
 <html>
  <head>
   <title>Example Page</title>
   <script type="text/javascript">
    var currentTag = function(tag){
     var currentPage = document.frames['tag_list'].document.getElementById(tag+'_tag-list'); currentPage.style.fontWeight = "bold";
    };
    currentTag("home")
   </script>
  </head>
  <body>
   <header>
    <!--All header code-->
   </header>
   <!--Sidebar (Problem)-->
   <iframe src="myframe.html" scrolling="no" id="tag_list">Your browser does not support the "iframe" element, please update...</iframe>
   <div id="content">
    <!--All content-->
   </div>
   <footer>
    <!--All footer code-->
   </footer>
  </body>
 </html> 
```

### HTML (iFrame):

```
<!DOCTYPE html>
<html>
 <head>
  <title>Sidebar Frame</title>
 </head>
 <body>
  <div id="tag_list">
   <h2>Pages</h2>
   <ul>
    <li><a href="#"><span id="home_tag-list">Homepage</span></a></li>
    <!--And all the other pages-->
   </ul>
  </div>
 </body>
</html> 
```

非常感谢您的帮助：D

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T19:06:29.747

iframe 中的任何内容都可以通过访问 iframe 的`contentWindow`属性来访问，但前提是 iframe 的内容来自与父窗口相同的来源。

一旦你在`contentWindow`，像往常一样访问元素 ( `document.getElementBy...`)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-27T19:09:44.277

不要使用 iframe。永远（除非真的没有其他选择）。在您的情况下，[服务器端包含](http://en.wikipedia.org/wiki/Server_Side_Includes)或使用[PHP 包含](http://php.net/manual/en/function.include.php)（或其他一些编程语言来包含侧边栏是一个**更好**的选择。

使用这些选项中的任何一个都可以解决您的 CSS 问题，并使您的网站对搜索引擎更加友好。

# c# - 列出 DataTable 值

> ID：11694121
> 
> 赞同：1
> 
> 时间：2012-07-27T19:04:16.320
> 
> 标签：c#, arrays, list, datatable

我有一个 DataTable ( `id`)，它有一列 ( `LinkID`)。此列的行中的项目是数字。我正在尝试按以下格式列出这些数字：

```
1, 2, 30, 494, etc... 
```

我将如何获得所有数字并以这种方式列出它们？

这是我尝试过的：

```
foreach (DataRow row in id.Rows)
{
    foreach (DataColumn column in id.Columns)
    {
        var test = row[0].ToString();
        List<string> ls = new List<string>();
        ls.Add(test);
        MessageBox.Show(ls.ToString());
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-27T19:11:05.227

您可以执行以下操作：

```
List<string> test = new List<string>();

foreach (DataRow row in id.Rows)
{
   test.Add(row[0].ToString());
}

MessageBox.Show(String.Join(",", test.ToArray())); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-27T19:16:15.947

由于您知道表中只有*一*列，因此我建议循环并使用 a[`StringBuilder`](http://msdn.microsoft.com/en-us/library/system.text.stringbuilder.aspx)来构建您的字符串，如下所示：

```
var builder = new StringBuilder();

// Cycle through the rows, append the field.
var query = 
    from row in id.AsEnumerable()
    select builder.Append(row.Field<int>(0)).Append(", ");

// Get the last or default, if there are no rows, builder will be null.
builder = query.LastOrDefault();

// If the builder is null, there are no rows, return
// null.
if (builder == null) return null;

// The builder is not null, there is content
// in the StringBuilder.
// This removes the last ", " which is appended at the end if
// there are any elements.
if (builder != null) builder.Length -= 2;

// Return the string from the builder.
return builder.ToString(); 
```

由于该[`StringBuilder.Append`方法](http://msdn.microsoft.com/en-us/library/43wt5x6h.aspx)使用[fluent interface](http://en.wikipedia.org/wiki/Fluent_interface)，因此您可以让 LINQ 查询返回相同的实例，并在继续附加逗号分隔值的同时获取最后一个实例。

您使用该[`LastOrDefault`方法](http://msdn.microsoft.com/en-us/library/bb301849.aspx)，以便在没有行的情况下获得一个`null`值，指示您没有行。

您在这里获得两个好处；对于大量行，您无需构建稍后必须连接的字符串列表。相反，您正在构建字符串并*根据需要*使用`StringBuilder`（预先分配容量）增加容量。

此外，最后不必调用[`Array.Join`](http://msdn.microsoft.com/en-us/library/57a79xd0.aspx)（或其他一些字符串连接方法），您最终会*再次*节省额外的连接操作。

# jquery - jQuery UI 插件链接

> ID：11694123
> 
> 赞同：0
> 
> 时间：2012-07-27T19:04:29.943
> 
> 标签：jquery, jquery-ui

我正在使用包装 dataTables 插件的 jQuery UI Widget 工厂编写插件，以添加可编辑插件中不可用的编辑功能。

在我的插件中，我向表头添加了两列和按钮，修改`aoColumn`s 以定义新列。然后我针对修改后的表运行数据表插件。然后我在表格标题中添加一个“添加”按钮，并将所有点击事件绑定到我插件中的方法。

所有 DOM 元素都已创建并且一切正常，除非我需要将结果与另一个插件链接。

结果不包含任何数据表插件方法或选项。我已将结果分配给选项集合中的属性，但我不知道返回什么以允许链接

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T20:47:38.903

链接的主要原则是你得到什么就是你返回什么。在链式函数结构中，您依赖`this`关键字作为方法的主题，因此您需要在每个可链式方法中返回它。

# python - tornado 写一个 Jsonp 对象

> ID：11694124
> 
> 赞同：9
> 
> 时间：2012-07-27T19:04:31.407
> 
> 标签：python, json, tornado

知道如何使用 Tornado 在 python 中输出 JSON 对象。任何好的示例、教程、库或输出 JSONP 对象的一行代码。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-07-27T23:49:53.193

Tornado 提供了`tornado.escape.json_encode`，它简单地包装`json`在 Python 2.6+ 或`simplejson`Python 2.5 上。使用简单：

```
from tornado.escape import json_encode
obj = { 
    'foo': 'bar',
     '1': 2,
     'false': True 
    }
self.write(json_encode(obj)) 
```

输出：

```
{"1": 2, "foo": "bar", "false": true} 
```

对于 JSONP 响应：

```
callback = self.get_argument('callback')
jsonp = "{jsfunc}({json});".format(jsfunc=callback,
    json=json_encode(obj))
self.set_header('Content-Type', 'application/javascript')
self.write(jsonp) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T19:53:59.247

您可以以这种方式返回 json obj

```
import json

class GetYearsHandler(tornado.web.RequestHandler):
    def get(self):
        try:
            response = get_years(self.get_argument("dataset_id"))
            result = {'status':'success', 'response': response}
            kk = tornado.escape.json_encode(result)
            kk = wrap_callback(self, kk)
            self.write(kk)
        except Exception, e:
            print >> sys.stderr, "Error occured:\n%s" % format_exc()
            self.write(json.dumps({'status': 'fail', 'error': "Error occured:\n%s" % format_exc()}))

def get_years (dataset_id):
    dates=[]
    years=[]
    conn = condb()
    cur = conn.cursor()
    data = {'dataset_id':dataset_id}
    cur.execute("SELECT layers.start_time FROM layers, datasets WHERE (layers.dataset_id=datasets.id) AND (datasets.business_id=%(dataset_id)s)",data)
    for row in cur.fetchall():
        dates.append(row[0])
    date=""
    for date in dates:
        year = int(date.year)
        if not year in years:
            years.append(year)
    conn.close()
    years.sort()
    return years 
```

注册课程

```
def main(db_fn=None):

    tornado.options.parse_command_line()
    application = tornado.web.Application([
    (r"/get_datasets", GetDatasetsHandler),
    (r"/get_years", GetYearsHandler),
) 
```

conn - 是数据库连接

# sql - SQL 查询插入到其他表中存在的表数据

> ID：11694126
> 
> 赞同：-2
> 
> 时间：2012-07-27T19:04:37.323
> 
> 标签：sql, mysqli

1.  类别表
2.  子类表

类别表的结构

```
id, name, article.
1, About, About content
2, Contact Us, Call us on 
```

AND 用于子类别表

```
id, cat_id, name 
1,  1, History
2,  1, Offices 
```

有人可以告诉我一个 SQL 查询，它可以将数据插入到我提供的子类别表中（类别表名称，例如：**关于**但不是 id，& 子类别名称：Carrer）。我可以使用类别表名称来查找相应的 id 并将其用于插入 cat_id 但如何？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T19:13:38.490

Can't figure out your question

But the basic sql is

```
Insert SomeTable(SomeColumn1,... SomeColumn99) 
  Select OtherColumn1,.. OtheColumn99 From SomeOtherTable Where .... 
```

# python - 自定义 Django 登录页面

> ID：11694127
> 
> 赞同：0
> 
> 时间：2012-07-27T19:04:44.480
> 
> 标签：python, django

我正在使用 django.contrib.auth 进行身份验证。用户。我正在使用默认登录视图，但我想添加更多内容（例如显示已登录用户的数量）。有什么方法可以自定义该视图，或者我必须将其复制粘贴到我的项目中并在其中更改一些内容？有没有办法在一个网址上调用两个视图？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T20:01:08.997

请记住，视图是函数。您可以编写自己的视图，在最后调用[Django 的登录视图](https://docs.djangoproject.com/en/dev/topics/auth/#django.contrib.auth.views.login)：

```
def mylogin(request):
    ...
    return login(request, 'my-login-template.html') 
```

您想要的自定义类型可以在模板中进行。

默认登录视图不提供扩展模板上下文的方法，您必须为此使用上下文处理器，或者编写自己的视图并调用[登录函数](https://docs.djangoproject.com/en/dev/topics/auth/#django.contrib.auth.login)，但这意味着编写更多可以引入的代码错误。

# php - 将 json 传递给视图模型时保持安全

> ID：11694131
> 
> 赞同：3
> 
> 时间：2012-07-27T19:05:00.060
> 
> 标签：php, json, security, codeigniter, knockout.js

我决定将 knockout.js 用于我的 Web 应用程序，并且对安全性有一些担忧。

数据流向如下：

*   用户通过 url 请求控制器
*   控制器收集所需信息，以 json 字符串形式发送到视图
*   json 字符串保存到 dom 以允许我的 javascript 代码访问它
*   json 被加载到 $(document).ready 内的淘汰视图模型中

我的问题是用户只需单击“查看源代码”就可以清楚地查看 json 字符串，这让我很担心，因为我知道这很容易在客户端更改，但我不完全确定其含义。

这是一些示例代码来说明我的观点。一、控制器：

```
 function view($id = null)
 {
    //other processing...

    $data = array();
    $data['json'] = $this->get_profile_json($id);
    $this->load->view('profile_page',$data);
 } 
```

个人资料页面视图

```
<script type="text/javascript">
    window.profile_json = "<?php echo $json; ?>";
</script>
<script type="text/javascript" src="<?php echo site_url('assets/js/profile_page.js'); ?>"></script>
<!-- The profile page below... --> 
```

个人资料页面 javascript

```
var vm = new ViewModel(profile_json); //load the json into view model
ko.applyBindings(vm); 
```

现在我知道我可以通过在创建视图模型之前从 javascript 代码中加载 json 来实现相同的目标，`$.getJSON`例如。

但是，在浏览器上安装了开发者工具扩展的人也可以看到（并且可能编辑？）这些数据。这是一个特殊的问题，其中一些数据包含权限标志等内容。

我的问题是，您如何确保传递给您的视图模型的数据不会被篡改？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-27T19:14:34.717

没有办法从客户端保证您信息的安全。这就是为什么对信息进行服务器端检查总是很重要的，然后发回您对信息是否可用的响应。

对于某些安全检查，您应该使用以下内容：

```
1) Strip_tags($_POST['key'])
2) Check to see if the value is numeric (if its a number)
3) Check to see if it only has alphabet and numbers (if this is all that's allowed)
...and so on 
```

要传递到后端的客户端信息总是可以被篡改，这就是为什么尽可能地锁定它很重要，如果任何信息似乎无效，那么您应该立即向客户并要求他们再试一次:)

假设后端数据是安全的，那么前端数据应该永远不会有问题。

希望这可以帮助！

# java - 自定义输入格式，hadoop

> ID：11694134
> 
> 赞同：0
> 
> 时间：2012-07-27T19:05:22.533
> 
> 标签：java, hadoop, mapreduce, customization

请帮忙，我有以下示例数据：

```
-21.33,45.677,1234,1245,1267,1290,1212,1111,10000,1902
-21.34,45.677,1264,1645,1266,1260,1612,1611,16000,1602
-21.35,45.677,1244,1445,1467,1240,1242,1211,11000,1912
-21.36,45.677,1231,1215,1217,1210,1212,1111,10010,1902 
```

我希望我的 hadoop mapreduce 代码应将前两个浮点条目视为键（-21.33,45.677），将剩余的整数条目视为值（1234,1245,1267,1290,1212,1111,10000,1902）。

我不确定是否可以使用现有的 FileInputFormats 来完成。那么我应该如何处理这个知道该值应该用作数组而不是文本。

另外我应该如何更改 inputSplit 以便我能够在地图中同时获取多个记录以进行计算。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-28T14:11:29.270

最简单的方法是使用 TextInputFormat 并让您的映射器在键和值之间进行拆分。映射器的输出键和值都可以是文本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T22:04:20.173

为什么你不能只使用 TextInputFormat 的`<LongWritable, Text>`输入类型，并相应地执行提取和转换？

如果这真的不可接受，那么考虑使用[ChainMapper](http://hadoop.apache.org/common/docs/r1.0.3/api/org/apache/hadoop/mapred/lib/ChainMapper.html) - 使用一个映射进行提取，然后将这些结果传递给另一个期望所需键/值的映射器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-03T06:54:14.733

最简单的方法是使用分隔符将记录拆分为“，”。然后在您的映射器中，只需获取前两个值并将它们附加到密钥中。您必须使用文本，因为您需要一个与您的键相对应的值。需要进行一些计算才能将密钥转换回数值。

# r - 遍历向量：替换的长度为零

> ID：11694135
> 
> 赞同：0
> 
> 时间：2012-07-27T19:05:24.873
> 
> 标签：r, vector, zoo

我正在尝试遍历一个向量并编辑一个新向量，但是我不断收到错误替换的长度为零。发生错误的部分在这里：

```
NewPos1 = rep(NROW(sig_decision))
for( i in 2:length(NewPos)) {
 NewPos1[i] = ifelse( NewPos[i] == 0 & NewPos[i-1] == 1 & ind1[i] > 0 , 1, 
      ifelse(NewPos[i] ==0 & NewPos[i-1] == -1 & ind1[i] < 0  , -1,0))
} 
```

好的，更具体

我哪里错了？

编辑：我应该更具体地说 ind1 是一个数字向量。我想要一个循环的原因是，如果 NewPos(NewPos[1]) 的前一个元素是 1 并且 ind1[2] > 0，那么从 NewPos1([NewPos[1]) 中的第二个元素开始，那么我想要 NewPos1[ 2] 为 1，依此类推，遍历整个向量，如果 ind1[3] >0，则 NewPos1[3] 也为 1

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-27T19:38:47.453

问题很可能在于`ind1`（因为你还没有告诉我们那是什么）。我猜想（如果`ind1`真的是一个与 长度相同的数字向量`NewPos`）这是解决您的问题的更有效的解决方案：

```
v <- NewPos[-1]  ## elements 2:n
ind2 <- ind1[-1] ## elements 2:n
vlag1 <- NewPos[-length(NewPos)] ## elements 1:(n-1)
NewPos1 <- ifelse(v==0 & vlag1==1 & ind2>0, 1,
               ifelse(v==0 & vlag==-1 & ind2<0, -1, 0)) 
```

正如@CarlWitthoft 指出的那样，`switch`有时可能很有用，但我认为两个嵌套`ifelse`语句并不过分。

# qt - QT Release构建DLL过程入口点错误

> ID：11694140
> 
> 赞同：20
> 
> 时间：2012-07-27T19:06:00.003
> 
> 标签：qt, dll, build, release

我在 Qt Creator 中构建了一个使用 CImg 进行图像处理的应用程序。当我从内部 IDE 运行它时它运行良好，但是如果我尝试从它的目录启动它，它会引发以下错误。

```
The procedure entry point ??4QString@@QAEAAV0@$$QAV0AAZ could not be located 
in the dynamic link library QtCore4.dll 
```

一切都指向安装了多个版本的 DLL。我发现我的 Xilinx IDE 使用 Qt 库，但有问题的 DLL 是相同的版本。我不是一个真正的软件人，在这里不知所措。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-07-28T08:40:09.763

即使库版本相同，它们也可能不兼容。例如，它们是用不同的配置编译的，比如有或没有 STL 支持、OpenGL、SQL 驱动程序......

`PATH`修复它的最简单方法应该是在环境变量的开头移动 Qt SDK 的路径。这样，每当您运行需要 Qt 库的可执行文件时，它将加载 SDK 附带的那些（在 中找到的第一个`PATH`），除非在可执行文件的目录中已经存在 QtCore4.dll、QtGui4.dll... 的副本。出于这个原因，如果您重新分发您的应用程序，您可能还必须在其目录中提供库。

另一种选择是静态链接，但您需要在 (L)GPL 许可下提供源代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-18T09:38:17.483

使用 DependencyWalker 列出加载 qtcore4.dll 的位置。我有同样的问题 - DependencyWalker 告诉我 qtcore4.dll 是从 c:\windows\system32 加载的 - 但这个文件夹中没有 qtcore4.dll。

注意：在 Windows 7 64 位 c:\windows\SysWOW64 上“映射”为 c:\windows\system32。在这个文件夹中，我找到了 dll - 我重命名了 dll，问题就解决了。

在这里查看这个答案： [Qt fresh Gui application crashing on startup, faulting at QtCore4.dll](https://stackoverflow.com/questions/14028362/qt-fresh-gui-application-crashes-on-startup-faulting-at-qtcore4-dll)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-27T19:21:06.403

静态链接库消除了这个问题。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2019-11-10T15:45:28.713

有同样的问题 [Windows 10, Qt5 + Mingw] 并且即使在我复制了所有必要的 Qt5 .dll 文件之后也出现了同样的错误。

DependencyWalker 为我崩溃了，所以我通过复制文件进行了反复试验。

原来我也需要复制 libstdc++-6.dll。

这表明可能还有其他库 - 除了 Qt 库 - 您需要复制。

# spring - 此错误的可能原因是什么 [ERROR,ContextLoader] 上下文初始化失败？

> ID：11694141
> 
> 赞同：0
> 
> 时间：2012-07-27T19:06:06.433
> 
> 标签：spring, hibernate, exception

我正在使用 Spring 3.1.2 和 Hibernate 4.1.4.Final，但我不运行我的应用程序。请帮帮我！

这是我的 applicationContext.xml

```
<beans xmlns="http://www.springframework.org/schema/beans"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:context="http://www.springframework.org/schema/context"
xmlns:tx="http://www.springframework.org/schema/tx"
xmlns:zksp="http://www.zkoss.org/2008/zkspring/core"
xmlns:jee="http://www.springframework.org/schema/jee"
xsi:schemaLocation="http://www.springframework.org/schema/jee http://www.springframework.org/schema/jee/spring-jee-3.1.xsd
    http://www.springframework.org/schema/lang http://www.springframework.org/schema/lang/spring-lang-3.1.xsd
    http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.1.xsd
    http://www.zkoss.org/2008/zkspring/core http://www.zkoss.org/2008/zkspring/core/zkspring-core.xsd
    http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
    http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.1.xsd
    http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.1.xsd">

<context:annotation-config />
<context:component-scan base-package="com.eagle.core" />

<!-- Enables ZK custom scopes for Spring Beans -->
<zksp:zk-config/>

<bean id="dataSource" class="org.springframework.jdbc.datasource.DriverManagerDataSource">
    <property name="driverClassName" value="com.mysql.jdbc.Driver" />
    <property name="url" value="jdbc:mysql://localhost:3306/ewo" />
    <property name="username" value="root" />
    <property name="password" value="" />
</bean>

<bean id="sessionFactory" class="org.springframework.orm.hibernate4.LocalSessionFactoryBean">
    <property name="dataSource" ref="dataSource" />
    <property name="packagesToScan" value="com.eagle.core.model" />
    <property name="hibernateProperties">
        <props>
            <prop key="hibernate.dialect">org.hibernate.dialect.MySQLDialect</prop>
            <prop key="hibernate.show_sql">true</prop>
            <prop key="javax.persistence.validation.mode">auto</prop>

            <!-- Habilita a alteração do banco de dados automaticamente sempre que o mapeamento das entidades forem alteradas -->
            <prop key="hibernate.hbm2ddl.auto">update</prop>            
        </props>
    </property>
</bean>

<!-- A transaction manager for working with Hibernate SessionFactories -->
<bean id="transactionManager" class="org.springframework.orm.hibernate4.HibernateTransactionManager">
    <property name="sessionFactory" ref="sessionFactory" />
</bean>

<tx:annotation-driven transaction-manager="transactionManager" />

<bean id="messageSource"   class="org.springframework.context.support.ReloadableResourceBundleMessageSource">
    <property name="basename" value="classpath:org/springframework/security/messages"/>
</bean> 
```

这是一个例外：

```
[ERROR,ContextLoader] Context initialization failed
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sessionFactory' defined in class path resource [applicationContext.xml]: Invocation of init method failed; nested exception is org.hibernate.MappingException: Could not instantiate collection persister org.hibernate.persister.collection.OneToManyPersister
at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1455)
at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:519)
at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)
at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)
at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)
at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)
at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:591)
at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:918)
at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:469)
at org.springframework.web.context.ContextLoader.configureAndRefreshWebApplicationContext(ContextLoader.java:383)
at org.springframework.web.context.ContextLoader.initWebApplicationContext(ContextLoader.java:283)
at org.springframework.web.context.ContextLoaderListener.contextInitialized(ContextLoaderListener.java:111)
at org.mortbay.jetty.handler.ContextHandler.startContext(ContextHandler.java:549)
at org.mortbay.jetty.servlet.Context.startContext(Context.java:136)
at org.mortbay.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1282)
at org.mortbay.jetty.handler.ContextHandler.doStart(ContextHandler.java:518)
at org.mortbay.jetty.webapp.WebAppContext.doStart(WebAppContext.java:499)
at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
at org.mortbay.jetty.handler.HandlerWrapper.doStart(HandlerWrapper.java:130)
at org.mortbay.jetty.Server.doStart(Server.java:224)
at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
at runjettyrun.Bootstrap.main(Bootstrap.java:97)
Caused by: org.hibernate.MappingException: Could not instantiate collection persister org.hibernate.persister.collection.OneToManyPersister
at org.hibernate.persister.internal.PersisterFactoryImpl.create(PersisterFactoryImpl.java:242)
at org.hibernate.persister.internal.PersisterFactoryImpl.createCollectionPersister(PersisterFactoryImpl.java:201)
at org.hibernate.internal.SessionFactoryImpl.<init>(SessionFactoryImpl.java:415)
at org.hibernate.cfg.Configuration.buildSessionFactory(Configuration.java:1744)
at org.hibernate.cfg.Configuration.buildSessionFactory(Configuration.java:1782)
at org.springframework.orm.hibernate4.LocalSessionFactoryBuilder.buildSessionFactory(LocalSessionFactoryBuilder.java:242)
at org.springframework.orm.hibernate4.LocalSessionFactoryBean.buildSessionFactory(LocalSessionFactoryBean.java:372)
at org.springframework.orm.hibernate4.LocalSessionFactoryBean.afterPropertiesSet(LocalSessionFactoryBean.java:357)
at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1514)
at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1452)
... 22 more
Caused by: java.lang.NoClassDefFoundError: antlr/TokenStream
at org.hibernate.sql.Template.renderOrderByStringTemplate(Template.java:695)
at org.hibernate.persister.collection.AbstractCollectionPersister.<init>(AbstractCollectionPersister.java:558)
at org.hibernate.persister.collection.OneToManyPersister.<init>(OneToManyPersister.java:85)
at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
at sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source)
at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source)
at java.lang.reflect.Constructor.newInstance(Unknown Source)
at org.hibernate.persister.internal.PersisterFactoryImpl.create(PersisterFactoryImpl.java:231)
... 31 more
Caused by: java.lang.ClassNotFoundException: antlr.TokenStream
at java.net.URLClassLoader$1.run(Unknown Source)
at java.security.AccessController.doPrivileged(Native Method)
at java.net.URLClassLoader.findClass(Unknown Source)
at org.mortbay.jetty.webapp.WebAppClassLoader.loadClass(WebAppClassLoader.java:392)
at runjettyrun.ProjectClassLoader.loadClass(ProjectClassLoader.java:89)
... 39 more
2012-07-27 15:20:59.295:WARN::Failed startup of contextorg.mortbay.jetty.webapp.WebAppContext@165091f{/ZKBase,C:\Users\Janderson\workspace_juno\ZKBase\src\main\webapp}
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sessionFactory' defined in class path resource [applicationContext.xml]: Invocation of init method failed; nested exception is org.hibernate.MappingException: Could not instantiate collection persister org.hibernate.persister.collection.OneToManyPersister
at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1455)
at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:519)
at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)
at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)
at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)
at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)
at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:591)
at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:918)
at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:469)
at org.springframework.web.context.ContextLoader.configureAndRefreshWebApplicationContext(ContextLoader.java:383)
at org.springframework.web.context.ContextLoader.initWebApplicationContext(ContextLoader.java:283)
at org.springframework.web.context.ContextLoaderListener.contextInitialized(ContextLoaderListener.java:111)
at org.mortbay.jetty.handler.ContextHandler.startContext(ContextHandler.java:549)
at org.mortbay.jetty.servlet.Context.startContext(Context.java:136)
at org.mortbay.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1282)
at org.mortbay.jetty.handler.ContextHandler.doStart(ContextHandler.java:518)
at org.mortbay.jetty.webapp.WebAppContext.doStart(WebAppContext.java:499)
at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
at org.mortbay.jetty.handler.HandlerWrapper.doStart(HandlerWrapper.java:130)
at org.mortbay.jetty.Server.doStart(Server.java:224)
at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
at runjettyrun.Bootstrap.main(Bootstrap.java:97)
2012-07-27 15:20:59.296:WARN::Nested in org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sessionFactory' defined in class path resource [applicationContext.xml]: Invocation of init method failed; nested exception is org.hibernate.MappingException: Could not instantiate collection persister org.hibernate.persister.collection.OneToManyPersister:
java.lang.ClassNotFoundException: antlr.TokenStream
at java.net.URLClassLoader$1.run(Unknown Source)
at java.security.AccessController.doPrivileged(Native Method)
at java.net.URLClassLoader.findClass(Unknown Source)
at org.mortbay.jetty.webapp.WebAppClassLoader.loadClass(WebAppClassLoader.java:392)
at runjettyrun.ProjectClassLoader.loadClass(ProjectClassLoader.java:89)
at org.hibernate.sql.Template.renderOrderByStringTemplate(Template.java:695)
at org.hibernate.persister.collection.AbstractCollectionPersister.<init>(AbstractCollectionPersister.java:558)
at org.hibernate.persister.collection.OneToManyPersister.<init>(OneToManyPersister.java:85)
at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
at sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source)
at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source)
at java.lang.reflect.Constructor.newInstance(Unknown Source)
at org.hibernate.persister.internal.PersisterFactoryImpl.create(PersisterFactoryImpl.java:231)
at org.hibernate.persister.internal.PersisterFactoryImpl.createCollectionPersister(PersisterFactoryImpl.java:201)
at org.hibernate.internal.SessionFactoryImpl.<init>(SessionFactoryImpl.java:415)
at org.hibernate.cfg.Configuration.buildSessionFactory(Configuration.java:1744)
at org.hibernate.cfg.Configuration.buildSessionFactory(Configuration.java:1782)
at org.springframework.orm.hibernate4.LocalSessionFactoryBuilder.buildSessionFactory(LocalSessionFactoryBuilder.java:242)
at org.springframework.orm.hibernate4.LocalSessionFactoryBean.buildSessionFactory(LocalSessionFactoryBean.java:372)
at org.springframework.orm.hibernate4.LocalSessionFactoryBean.afterPropertiesSet(LocalSessionFactoryBean.java:357)
at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1514)
at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1452)
at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:519)
at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)
at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)
at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)
at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)
at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:591)
at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:918)
at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:469)
at org.springframework.web.context.ContextLoader.configureAndRefreshWebApplicationContext(ContextLoader.java:383)
at org.springframework.web.context.ContextLoader.initWebApplicationContext(ContextLoader.java:283)
at org.springframework.web.context.ContextLoaderListener.contextInitialized(ContextLoaderListener.java:111)
at org.mortbay.jetty.handler.ContextHandler.startContext(ContextHandler.java:549)
at org.mortbay.jetty.servlet.Context.startContext(Context.java:136)
at org.mortbay.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1282)
at org.mortbay.jetty.handler.ContextHandler.doStart(ContextHandler.java:518)
at org.mortbay.jetty.webapp.WebAppContext.doStart(WebAppContext.java:499)
at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
at org.mortbay.jetty.handler.HandlerWrapper.doStart(HandlerWrapper.java:130)
at org.mortbay.jetty.Server.doStart(Server.java:224)
at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
at runjettyrun.Bootstrap.main(Bootstrap.java:97) 
```

这可能是什么原因？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T19:39:34.017

检查`java.lang.ClassNotFoundException: antlr.TokenStream`，antlr.jar 不在您的应用程序中或不在类路径中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-27T19:45:23.340

这很可能是因为[ANTLR](http://www.findjar.com/jar/org.antlr/jars/antlr-runtime-3.0.jar.html)的 jar不在您的类路径中。

可能值得考虑使用[Maven](http://maven.apache.org/)或[Ivy](http://ant.apache.org/ivy/)之类的依赖管理工具 （如果您使用的是[ANT](http://ant.apache.org/)。这应该可以解决这些类型的缺失依赖问题（假设它不是配置问题）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-30T16:46:55.250

问题出在我的位置 Maven 存储库上。我删除了我的位置 Maven 存储库，一切运行良好。

# java - 在 Google App Engine 的会话中维护列表对象

> ID：11694143
> 
> 赞同：0
> 
> 时间：2012-07-27T19:06:20.850
> 
> 标签：java, google-app-engine

我在 GAE 中有一个独特的问题。请注意我在下面描述的问题仅在我将代码部署到 GAE 但在本地工作正常时...请帮助大家...

我有一个 servlet 代码，它在会话属性中设置一个 List 对象并将请求转发到 JSP，如下所示：

```
 HttpSession session=request.getSession();
        session.setAttribute("msgListS", msgList);
        request.getRequestDispatcher("/WEB-INF/jsp/downloadpdf.jsp").forward(request, response); 
```

在 jsp 中......我正在获取列表并打印其大小，然后单击链接我调用另一个 servlet。JSP代码如下：

```
 List<Message> msgList=(List<Message>)session.getAttribute("msgListS");
        out.println("The total messages are : "+msgList.size());
        session.setAttribute("msgListS", msgList); 
```

现在在最后一个 servlet 中，我再次获取 List 对象，但这里的大小与列表的实际大小不同。在jsp中它显示正确，但在这个servlet中它显示大小为1。请帮助....servlet代码：

```
 HttpSession session=request.getSession(false);
       List<Message> msgList=(List<Message>)session.getAttribute("msgListS");
       out.println("The total messages are : "+msgList.size());

    On local machine it is working absolutely fine but GAE has above problem :( 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T22:31:08.943

你确定你得到了正确的会话吗？我的理解是你应该像这样获得它：

```
this.getThreadLocalRequest().getSession(); 
```

这就是我所做的以及推荐的[Google AppEngine 会话示例](https://stackoverflow.com/questions/1134800/google-appengine-session-example)

这里也有更多讨论

[我应该何时以及如何使用 ThreadLocal 变量？](https://stackoverflow.com/questions/817856/when-and-how-should-i-use-a-threadlocal-variable)

这显示了一个潜在的缺点（内存泄漏）......虽然我提到它只是为了参考，但不确定它是否适用。

# .net - 使用正则表达式获取最左边或最右边的有效字符

> ID：11694153
> 
> 赞同：0
> 
> 时间：2012-07-27T19:06:53.840
> 
> 标签：.net, regex

我正在寻找与 .NET 中的 Regex.Replace 兼容的正则表达式，以将用户输入过滤到最左边或最右边的有效字符。例如，如果我只需要获取大写字符，我可以这样做：

```
var userText = "Ukeaf-4DeT";
var userPattern = @"[^A-Z]";
var validText = Regex.Replace(userText, userPattern, string.Empty) 
```

将返回 UDT，但我需要 userPattern 指定最左边的 2 个有效字符，因此在这种情况下为 UD。同样，我需要一个单独的 userPattern 来执行最右边的 2 个有效字符（本例中为 DT）。

这可能与单个正则表达式模式有关吗？怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T22:04:38.307

这是可能的，但很难看。正如 zzzzBov 所指出的，通常没有理由将所有内容都放在一个正则表达式中。但同样多的事情，是可以做到的。

```
string twoFirst = "[^A-Z]|(?<=([A-Z].*){2})[A-Z]";
string twoLast = "[^A-Z]|[A-Z](?=(.*[A-Z]){2})";
string userText = "Ukeaf-4DeT";
string validText = Regex.Replace(userText, twoFirst, string.Empty); 
```

使用该`twoFirst`表达式，它将删除除第一次出现的两个大写字母之外的所有内容。前两个大写字母的特别之处在于它们前面没有两个或更多大写字母。这就是该表达式检查的内容。任何不是大写字母的字符，或者如果它前面至少有两个大写字母，都将被删除。

这可以概括为生成所需模式的东西：

```
string userText = "Ukeaf-4DeT";
int numOccurrences = 2;
string positivePattern = "[A-Z]";
string negativePattern = "[^A-Z]";

string first = negativePattern + "|(?<=(" + positivePattern + ".*){" + numOccurrences + "})" + positivePattern;
string last = negativePattern + "|" + positivePattern + "(?=(.*" + positivePattern + "){" + numOccurrences + "})";
string validText = Regex.Replace(userText, first, string.Empty); 
```

# regex - xemacs正则表达式中的“[+]”是什么？

> ID：11694163
> 
> 赞同：0
> 
> 时间：2012-07-27T19:07:31.657
> 
> 标签：regex, gdb, xemacs

在（我的）XEmacs 21.4 中，gdb-prompt-pattern 的描述变量给出：

```
Value: "^>\\|^(.*gdb[+]?) *\\|^---Type <return> to.*--- *" 
```

里面的“[+]”是什么？它只是意味着“+ 字符”吗？如果是这样，为什么不使用“\+”？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-27T19:14:48.550

在您的上下文中，`[+]` 与 , 相同`\+`，即匹配`+`字符，我想该正则表达式的原始作者要么出于可读性原因这样做，要么可能是因为 `[+]`过去曾经是某些字符集，例如 `[-+]`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T19:13:53.477

in regular expression `[+]` is symbol `+`

any symbol in `[]` is symbol except `-`

# php - 使用 FOSUserBundle 在 Symfony2 中自定义表单错误

> ID：11694167
> 
> 赞同：1
> 
> 时间：2012-07-27T19:07:57.047
> 
> 标签：php, symfony, fosuserbundle

我正在为用户端使用 Symfony2 和 FOSUserBundle 开发一个网站。我正在尝试自定义注册表单，并且正在尝试一些问题。

1.  我试图按照文档在字段旁边包含字段错误，但它只显示在表单顶部；
2.  当两个密码不同时，表格顶部会出现错误：该值无效。这不是很清楚，我想把它翻译成法语，但我似乎在语言文件中找不到它。我曾经翻译过所有的表格，除了那个错误。

这是我的字段模板：

```
{% block field_errors %}
{% spaceless %}
{% if errors|length > 0 %}
<ul class="list_error">
{% for error in errors %}
<li>{{ error.messageTemplate|trans(error.messageParameters, 'validators') }}</li>
{% endfor %}
</ul>
{% endif %}
{% endspaceless %}
{% endblock field_errors %}

{% block field_row %}
{% spaceless %}
<tr>
    <td>
        <label for="{{ form.vars.id }}">{{ form.vars.id|trans( {}, "FOSUserBundle" ) }}</label>
    </td>
    <td>
        {{ form_widget(form) }}
        {{ form_errors(form) }}
    </td>
</tr>
{% endspaceless %}
{% endblock field_row %} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-28T06:10:10.773

“无效”错误有点特殊，因为默认情况下所有字段都相同。您可以在重复字段（或任何字段）的选项中覆盖它：

```
$builder->add('password', 'repeated', array(
    'type' => 'password',
    'invalid_message' => 'Please enter the same password twice',
)); 
```

顺便说一句，重复字段的根表单的错误冒泡是[一个问题](https://github.com/symfony/symfony/issues/1971)，已在 Symfony 2.1 中修复。

# android - 显示联系人后后退按钮不起作用

> ID：11694172
> 
> 赞同：6
> 
> 时间：2012-07-27T19:08:15.573
> 
> 标签：android, android-intent

我正在使用 Pro Android 4 中的“可点击列表项”代码。代码基本上是：

```
public class MainActivity extends ListActivity implements OnItemClickListener
{
    @Override
    public void onCreate(Bundle savedInstanceState)
    {
        super.onCreate(savedInstanceState);

        CursorLoader loader = new CursorLoader(this, Contacts.CONTENT_URI, null,
            null, null, Contacts.DISPLAY_NAME + " ASC");
        Cursor cursor = loader.loadInBackground();

        String[] columns = new String[] { Contacts.DISPLAY_NAME };
        int[] views = new int[] { android.R.id.text1 };

        SimpleCursorAdapter adapter = new SimpleCursorAdapter(this, 
            android.R.layout.simple_list_item_1, cursor, columns, views, 
                CursorAdapter.FLAG_REGISTER_CONTENT_OBSERVER);
        setListAdapter(adapter);

        getListView().setOnItemClickListener(this);
    }

    @Override
    public void onItemClick(AdapterView<?> adapterView, View view, int position, long id)
    {
        Uri contactUri = ContentUris.withAppendedId(Contacts.CONTENT_URI, id);
        Intent intent = new Intent(Intent.ACTION_VIEW, contactUri);
        startActivity(intent);
    }
} 
```

这一切都很好。我看到了联系人列表，当我点击一个名字时，它会打开那个人的通讯录。

问题是地址簿中的“后退”按钮不起作用。根据书，从通讯录中点击后退按钮应该让我回到上面的活动。但相反，我被带回了主屏幕。

我的应用程序仍在运行，当我手动切换到它时，我回到它并且列表视图位于正确的先前滚动位置等。

这是在 Android 4.1.1 上。我想知道我是否应该实施一些额外的措施来完成这项工作？

这是清单文件：

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.contactslist"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="16"
        android:targetSdkVersion="15" />

    <uses-permission android:name="android.permission.READ_CONTACTS"/>

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <activity
            android:name=".MainActivity"
            android:label="@string/title_activity_main" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>

</manifest> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T20:22:55.743

听起来你的 Activity 堆栈不知何故搞砸了。在开始调用 startActivity(intent) 之前尝试添加以下内容

```
intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK); 
```

# html - 如何使按钮图像填充它？

> ID：11694175
> 
> 赞同：0
> 
> 时间：2012-07-27T19:08:35.213
> 
> 标签：html, sencha-touch, extjs, sencha-touch-2

我正在尝试将图像应用到 xtype='button' 但是当我这样做时，我的按钮看起来像这样

![在此处输入图像描述](../Images/6677c3932af6f3480ae3d3c609f572be.png)

我怎样才能让这个图像填充这个按钮？

代码（sencha touch 2 js）：

```
 {
            xtype: 'button',
            width: 140,
            height: 60,
            margin: 10,
            right: 20,  

            text: 'Enter',
            html: '<img src="resources/images/Dbutton.png"/>'
        } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-28T15:34:06.967

要在所有浏览器上工作，请将 html 更改为

```
 <input type='image' src='filename.png' width='25' height='25' name='whatever' value='submit' /> 
```

这使用图像作为提交按钮。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-27T19:20:07.683

如果图像是按钮上的背景图像，则使用 CSS 属性`background-size`。

```
.mybutton {
    background-size: cover;
} 
```

请注意，这在 IE8 或更早版本中不起作用。如果你想要 IE8 支持，你需要使用 polyfill javascript。试试这个：[https ://github.com/louisremi/jquery.backgroundSize.js](https://github.com/louisremi/jquery.backgroundSize.js)

希望有帮助。

# emacs - Emacs 切换到下一个窗口，不管框架

> ID：11694176
> 
> 赞同：6
> 
> 时间：2012-07-27T19:08:38.357
> 
> 标签：emacs, elisp

我希望 Cx o 命令（下一个窗口）包括其他框架中的窗口以及当前框架中的窗口。

有谁知道如何解决这个问题？我应该使用另一个命令吗？是否有一些 elisp 魔术片段可以轻松做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-27T19:20:21.397

`C-x o`是`other-window`。去另一个框架使用`C-x 5 o`它是`other-frame`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-28T23:02:29.467

来自`C-h f next-window`：

> （下一个窗口和可选窗口 MINIBUF ALL-FRAMES）...
> 
> ALL-FRAMES nil 或省略意味着考虑 WINDOW 框架上的所有窗口，加上由 MINIBUF 参数指定的 minibuffer 窗口。如果 minibuffer 很重要，请考虑共享该 minibuffer 的所有帧上的所有窗口。以下 ALL-FRAMES 的非零值具有特殊含义：
> 
> *   t 表示考虑所有现有框架上的所有窗口。
>     
>     
> *   “可见”意味着考虑所有可见框架上的所有窗口。
>     
>     
> *   0（数字零）表示考虑所有可见和图标化框架上的所有窗口。
>     
>     
> *   框架意味着只考虑该框架上的所有窗口。
>     
>     
> 
> 任何其他都意味着考虑WINDOW 框架上的所有窗口，而不考虑其他窗口。

有点讽刺的是，`other-window`它也支持这一点，因为它使用`next-window`. 不幸的是，我不知道以交互方式传递非数字参数的方法，但是一个简单的函数应该可以解决问题：

```
(defun my-other-window (count)
  (interactive "p")
  (other-window count t)) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-27T20:09:05.267

这可以是第一个近似值。
[http://www.gnu.org/software/emacs/manual/html_node/elisp/Cyclic-Window-Ordering.html](http://www.gnu.org/software/emacs/manual/html_node/elisp/Cyclic-Window-Ordering.html)
[http://www.gnu.org/software/emacs/manual/html_node/elisp/Frames.html](http://www.gnu.org/software/emacs/manual/html_node/elisp/Frames.html)

`other-window`有一个参数来控制它如何处理帧。

```
(global-set-key (kbd "C-x o")  (lambda ()
                 (interactive)
                 (other-window 1 t)
         (let ((nframe (window-frame (selected-window))))
           (select-frame-set-input-focus nframe)
           (make-frame-visible nframe)))) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-28T20:20:40.247

我使用*ace-jump-mode*的 2.0 版本。了解它的工作原理大约需要两分钟，并且从 2.0 版开始，它允许“跳转”到另一个帧。您可以从任何缓冲区/帧/窗口中跳转到您在屏幕上实际看到的任何字符，只需按三到四次按键即可。很难打败。

无论如何，这可以节省大量时间，所以我建议您检查一下，因为它真的很方便。

[http://www.emacswiki.org/emacs/AceJump](http://www.emacswiki.org/emacs/AceJump)

还有*“Emacs Rocks！第 10 集：跳跃”*两分钟的截屏视频，展示了它的实际效果：

[http://www.youtube.com/watch?v=UZkpmegySnc](http://www.youtube.com/watch?v=UZkpmegySnc)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-27T19:24:47.553

不确定这是否是您的意思，但如果您只想[循环浏览缓冲区列表中的缓冲区](http://www.gnu.org/software/emacs/manual/html_node/emacs/Select-Buffer.html)，而不管帧：

`Ctrl x``→</kbd>`

`Ctrl x``←</kbd>`

它们分别绑定到 (next-buffer) 和 (prev-buffer)。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-07-27T20:40:14.237

您必须按下`C-x` `5` `o` `C-h`才能查看有关使用框架的所有功能。

其中一些功能是其他框架。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-10-28T01:41:15.190

你说*“有没有办法在窗口中循环，不管它们在哪个框架中？这真的是我要找的吗？”*

是的，有，有[**冰柱**](http://www.emacswiki.org/cgi-bin/wiki/Icicles)。

您要求的是`icicle-select-window`使用前缀 arg 时命令执行的操作。如果您始终想要这种行为，您可以定义自己的命令来执行此操作而无需前缀 arg：

```
 (defun my-select-window ()
   "Select window by name.  Windows of all visible frames are candidates."
   (interactive)
   (let ((current-prefix-arg  1)) (icicle-select-window))) 
```

系统会提示您输入窗口名称。但是，如果您只是想循环，而不是通过键入部分名称来缩小候选范围，那么只需使用`C-down`来获取您想要的窗口。

（*窗口名称*是其显示缓冲区的名称，但根据需要添加后缀`[NUMBER]`，以使名称唯一。例如，如果您有两个显示缓冲区`*Help*`的窗口，则将调用其中一个窗口以 `*Help*[2]`与此命令一起使用。）

# java - 访问已作为参数传递的数组元素 - Java

> ID：11694177
> 
> 赞同：0
> 
> 时间：2012-07-27T19:08:42.327
> 
> 标签：java, arrays, nullpointerexception, parameter-passing

我有一个方法，它将一个数组作为另一个类的参数：

```
public void memPass(Memory[] memLocList) {

    memList = memLocList;

            for (int i = 0; i < 10; i++) {
        System.out.println(memList[i].getSomething());
    }
} 
```

-编辑- 上面打印出 10 个值（整数），但如果我在另一种方法中尝试相同的方法，整数介于 0 和 10 之间，我会得到一个 NPE。

谁能告诉我如何从另一个方法访问这个数组的元素，该方法也接受另一个类的参数？

我正在尝试按照以下方式做一些事情：

```
public void accessArray(int mem) {

           int someInt = memList[mem].getSomething();
} 
```

-编辑-对不起，我应该补充一点，这会产生 NullPointerException。

-新编辑-

好的，我现在已经编辑了代码，所以我在课堂上的所有内容是：

```
public class PLoop {

// instance variable
public Memory[] memlist;

  // method 1 
  public void memPass(Memory[] memLocList) {

   memList = memLocList;
   System.out.println(memList.length);
  }

  // method 2
  public void accessArray(int mem) {

   System.out.println(memList.length);
  }
} 
```

第一种方法打印一个表示“memList”长度的整数，第二种方法给出一个 NPE。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-27T19:16:38.103

如果我对您的理解正确，您希望能够存储 memLocList 然后稍后访问它吗？如果是这样，我看不出创建实例变量是行不通的。

```
public class Test {
    public Memory[] memlist;

    public void memPass(Memory[] memLocList) {
        memList = memLocList;
    }

    public void accessArray(int mem) {
        int someInt = memList[mem].getSomething();
    }
} 
```

当然，我在 Java 中的工作已经不够用了，所以可能无法创建和分配这样的实例变量。但是您始终可以将元素存储在另一个容器中。

```
public class Test {
    public List<Memory> memlist;

    public void memPass(Memory[] memLocList) {
        memlist = new ArrayList<Memory>(Arrays.asList(memLocList));
    }

    public void accessArray(int mem) {
        int someInt = memList.get(mem).getSomething();
    }
} 
```

对不起，如果我有任何语法错误。但是你明白了主要的想法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T19:17:27.287

如果`memList`是该类的实例变量，并且在两种情况下（两种方法）都是同一个类，那么这显然是`null`某个索引处的值`memList`。

```
private static class Memory {
    private static int index = 0;

    public int getSomething() {
        return index++;
    }
}

private static class Test {
    public Memory[] memlist;

    public void memPass(Memory[] memLocList) {
        memlist = memLocList;
    }

    public void accessArray(int mem) {
        int someInt = memlist[mem].getSomething();
        System.out.println(someInt);
    }
}
public static void main(String args[]) {
    Test t = new Test();
    Memory[] memList = new Memory[4];
    memList[0] = new Memory();
    memList[1] = null;
    t.memPass(memList);
    t.accessArray(0);
    t.accessArray(0);
    t.accessArray(1); //NPE thrown because null value in array
    //or
    Test t2 = new Test();
    t2.accessArray(0); //NPE thrown because array is null (different instance)
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-27T19:28:58.487

在您的实现中，您已经假设传递给该方法的数组有 10 个元素，并且这些数组项中的每一个都有一个值，因此，在某些时候您会遇到 NullPointerException。这很危险，尤其是当您只是处理作为参数传递给方法的数组时。为确保您只访问数组中可用的元素，您需要检查数组的长度。此外，您需要确保无论何时调用数组中元素的方法（或对其进行任何操作），首先检查它是否确实存在。对于您的 for 循环，您可以执行以下操作：

```
if (memList != null) {
    for (int i = 0; i < memList.length; i++) {
       if (memList[i] != null) {
         System.out.println(memList[i].getSomething());
       }
    }
} 
```

这样就可以避免空指针异常。使用相同的概念，您也可以将其应用于您的方法，如下所示：

```
public void accessArray(int mem) {

   if (mem > -1 && memList != null && memList.length > mem && memList[mem] != null){
      int someInt = memList[mem].getSomething();
   }
} 
```

当然这是假设带有 for 循环的方法和 accessArray 方法在同一个类（或父子类）中，并且 memList 是一个实例变量。

并且要将数组的元素保存为 memLocList 的深层副本，您可以使用@GJK 建议`Arrays.asList`的实例变量，并应用我上面提到的相同的空指针检查概念。

# php - PHP 应用程序中正确的 RESTful SOA 方法？

> ID：11694179
> 
> 赞同：5
> 
> 时间：2012-07-27T19:08:59.893
> 
> 标签：php, symfony1, soa, silex

所以，我最近阅读了很多关于 SOA 的文章，并试图实现一些有用的东西。我从一个简单的博客开始，创建了 RESTful API。到现在为止还挺好。它完美地工作。但是，在编写将使用 RESTful API 的 Web 界面时，我开始担心了。我不知道我是否做对了。

例如，Web 界面有一个管理面板。该管理面板通过 file_get_contents 和流选项向 API 发出 HTTP 请求。目前，API 是 localhost，Web 界面也是如此，但整个过程有点慢。这是正确的吗？这是实现 SOA 的正确方法吗？此外，我正在处理少量重复代码以进行验证。我应该在哪里验证数据？在 API 或 Web 界面中？最好的方法是什么？

欢迎使用提示、教程，特别是书籍。这是使用 Silex 实现的，它建立在 Symfony 组件之上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-28T17:24:46.157

我就是这样做的。尽管与 localhost 的连接一开始似乎是一种开销，但它是一项功能，因为您已准备好在任何地方部署 Web 界面应用程序并仍然使用您的 API，这可能在任何地方。当然，你会在上面放一些 SSL。

至于验证，您应该在 API 上验证并针对这些情况返回[HTTP 状态代码](http://en.wikipedia.org/wiki/List_of_HTTP_status_codes)（例如，无效参数的“400 Bad Request”）。这样，任何其他客户端都可以解释来自 API 的响应并将其处理以显示他们想要的方式。对于您的 Web 界面，基于 HTTP 状态代码的漂亮的小错误消息。

您还面临哪些其他问题？另外，就一般的 SOA 架构而言，[这本书](http://www.packtpub.com/soa-integration-automation-business-processes-books-best-of-packt/book)非常好。

# xcode - 无法使用 xCode 4.4 启动控制台应用程序

> ID：11694180
> 
> 赞同：7
> 
> 时间：2012-07-27T19:09:13.210
> 
> 标签：xcode

我有一个有两个目标的项目——一个 iOS 应用程序和一个 OSX 控制台应用程序。后者是使用 Xcode File->New Target 并选择“命令行工具”创建的。此控制台应用程序用于准备 iOS 应用程序所需的默认数据库——使用 CoreData。在我升级到 Mountain Lion 和 xCode 4.4 之前，这一直运行良好。现在，当我尝试运行命令行工具时，我收到“无法启动 - 权限被拒绝”错误。我尝试过使用签名证书，但无济于事。有趣的是，如果我在一个新项目中创建一个新的“hello, world”命令行工具，它工作得很好——而且它根本没有签名。

我检查了该文件，它具有 -rwxr-xr-x 权限。在调试器中，即使在尝试访问妈妈之前，应用程序也会在启动时失败。如果我尝试在命令行的调试器之外运行它，它会以 kill 9 消息结束。

任何想法将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-03T16:59:15.973

我在我的 iOS/Mac 项目中遇到了同样的问题。以上建议都没有帮助，但我设法找到了正确的答案，所以我分享给未来的参考。

我必须将代码签名设置为**不要**为 MacOSX 目标进行代码签名。无论您的部署目标是否设置为默认值，其余部分都可以正常工作。不要忘记将您的 Base SDK 设置为**Current OSX**并将支持的平台设置为**"x86_64 i386"**。

！干杯

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-26T19:02:52.530

此外，当您尝试使用在启动时未解锁的密码在设备上启动应用程序时，您可能会收到“无法启动 - 权限被拒绝”错误。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-27T19:17:32.083

找到了答案。在 Info 页面上，我必须将 OS X 部署目标从 Default 更改为 10.8。默认我猜不再正确默认。无论如何，它现在有效。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-07T04:50:16.033

在尝试运行新创建的 Cocoa 应用程序目标时，我也看到了此错误消息。问题是我在 iOS 应用程序项目中创建了我的应用程序目标，但我需要创建一个子项目并在新项目中创建应用程序目标。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-20T19:52:22.420

当我在创建和安装配置文件之前尝试运行时遇到了这个问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-08-20T01:30:01.643

就我而言，我将部署目标更改为 10.8（以前是 10.6），并且可以正常工作。

# iphone - 用于 uiwebview 的 iphone 测试工具

> ID：11694190
> 
> 赞同：0
> 
> 时间：2012-07-27T19:10:04.167
> 
> 标签：iphone

我正在寻找一个对 uiwebview 有很大支持的 iphone 测试工具。因为我正在制作一个混合应用程序，所以基本上制作一个本机外壳并在我的应用程序的 uiwebview 内呈现一个网站。我需要一个工具来帮助我测试用户与网站的交互。因此，当其他人更改网站时，他们可以先运行此测试，以确保他们的更改不会搞砸我的东西。我检查了几个流行的 iphone 测试工具，它们对 uiwebview 没有很好的支持。有什么建议吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T20:03:46.040

Fonemonkey 具有对 selenium 的内置支持，如果您可以为混合 Web 应用程序编写 selenium 脚本并使用 fonemonkey 运行它们，我想很有可能进行测试。

嘿，还有一件事，fonemonkey 现在被猴子说话取代了，试试看， [http: //www.360logica.com/360logica-social/blog/item/123-monkey-talk-for-ios-set-up](http://www.360logica.com/360logica-social/blog/item/123-monkey-talk-for-ios-set-up)

猴子谈话网站：[http ://www.gorillalogic.com/testing-tools/monkeytalk](http://www.gorillalogic.com/testing-tools/monkeytalk)

# android - SharedPreferences 不保存

> ID：11694191
> 
> 赞同：0
> 
> 时间：2012-07-27T19:10:04.307
> 
> 标签：android, sharedpreferences

我的问题：当我想保存 sharedPreference 并重新启动应用程序时，它没有加载正确的值。我的代码：

```
int punkteint = 0;
TextView test1;
String points;
private static String SHARED_PREF_ID = "0";

public void onCreate(Bundle savedInstanceState) {
    test1 = (TextView) findViewById(R.id.test1);
    SharedPreferences load = getSharedPreferences(SHARED_PREF_ID, 0);
    points = load.getString("punkte", "0");
    points = SHARED_PREF_ID;
    test1.setText(points);
    mehrPunkte();
    }

public void mehrPunkte() {

    punkteint++;

    SHARED_PREF_ID = Integer.toString(punkteint);
    SharedPreferences load = getSharedPreferences(SHARED_PREF_ID, MODE_PRIVATE);
    points = load.getString("punkte", "0");
    points = SHARED_PREF_ID;
    test1.setText(points);

    SharedPreferences save = getSharedPreferences(SHARED_PREF_ID, MODE_PRIVATE);
    save.edit().putString("punkte", SHARED_PREF_ID).commit();
} 
```

我在这里做错了什么？希望你能帮我

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T19:15:55.307

这一行：

```
save.edit().putString("punkte", SHARED_PREF_ID).commit(); 
```

正在将 SHARED_PREF_ID 保存为 punkte 的值。所以，它永远是 0。也许你的意思是：

```
save.edit().putString("punkte", String.valueOf(punkteint)).commit(); 
```

或者可能：

```
save.edit().putString("punkte", String.valueOf(points)).commit(); 
```

我不确定您要实际保存什么。

哦，一旦从共享首选项中获取值，您就会重新设置它：

```
points = load.getString("punkte", "0");
points = SHARED_PREF_ID; 
```

不要做第二行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T19:17:19.127

不确定您要在这里做什么：

```
points = load.getString("punkte", "0");
points = SHARED_PREF_ID;
test1.setText(points); 
```

基本上，您告诉它要做的是“将`punkte`值加载到`points`，然后加载`SHARED_PREF_ID`到`points`”。这意味着`points`将永远等于`SHARED_PREF_ID`这里。删除上面写着“ `points = SHARED_PREF_ID;`”的行，你可能会取得更大的成功。

此外，我不会改变`SHARED_PREF_ID`'s 的价值。使它成为 a`final String`并赋予它一些独特的价值（如`"punkte_prefs"`）。

最后，我会看一下包含*很好示例*[的文档](http://developer.android.com/guide/topics/data/data-storage.html)，以及@Kaediil 的回答（因为他抓住了我错过的东西......）。

 ** * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-28T02:05:35.047

我想你已经把自己搞得一团糟了。

```
 private static String SHARED_PREF_ID = "0";
  ...
  SharedPreferences load = getSharedPreferences(SHARED_PREF_ID, 0);
  points = load.getString("punkte", "0");
  points = SHARED_PREF_ID; 
```

这些行从名为“0”的文件中读取共享首选项。那是你想要的吗？对于文件来说，这不是一个非常有用的名称。下一行将名为“punkte”的字符串值读入变量“points”，然后立即丢弃该值并用“0”替换它。

```
punkteint++;
SHARED_PREF_ID = Integer.toString(punkteint);
SharedPreferences load = getSharedPreferences(SHARED_PREF_ID, MODE_PRIVATE); 
```

这些行增加一个计数器，使用它来生成一个全新的文件名，并从该文件加载一组全新的首选项。同样，您从这些首选项中加载“点”并立即丢弃该值，将其设置为这个新文件名。

```
SharedPreferences save = getSharedPreferences(SHARED_PREF_ID, MODE_PRIVATE);
save.edit().putString("punkte", SHARED_PREF_ID).commit(); 
```

这些行再次从该新文件重新加载首选项并将文件名写入“punkte”值。

看起来您是在故意生成一系列首选项文件，每个首选项文件在值“punkte”下都包含自己的名称。

下次运行应用程序时，您将返回从文件“0”读取首选项，获得与第一次相同的值：“0”

如果您告诉我们您实际上想要做什么，那将会有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-27T19:15:05.240

没有把握。你应该做什么，但我会用这个代替

```
SharedPreferences.Editor prefEditor = save.edit();
prefEditor.putString("blah", blah);
PredEditor.commit() 
```

在 onPause 中保存并在 onResume 中加载。如果数据是为了改变活动，可能会有所帮助。*

# c# - 我有一个文本文件，我想用空字符串替换其中的一个字符串，但是

> ID：11694193
> 
> 赞同：-1
> 
> 时间：2012-07-27T19:10:21.613
> 
> 标签：c#, sql, regex

我还想在此之后删除字符串，直到下一个逗号，如果该字符串在“select”之后，那么我想在 select 之后替换任何内容，直到下一个逗号。例如：select a.column, a.myID, a.studentID from mytable

我有很多这样的文本文件，所以我需要一些东西来处理它，比如如果我想用空字符串替换列，它应该看起来像从 mytable 中替换 select a.myID, a.studentID

如果我想用空字符串替换 myID 它应该在替换 select a.column, a.studentID from mytable 之后看起来像这样

如果我想用空字符串替换 studentID，它应该看起来像这样 select a.column, a.myID from mytable。

谢谢我正在使用 C# 我正在考虑使用正则表达式，但无法提出正则表达式。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T19:27:47.327

这就是你需要的>>

```
using System;
using System.Text.RegularExpressions;

class Program
{
  static void Main()
  {
    string input = "select ceiling(a.interest) as interest, a.myID as mID, a.studentID as sID from mytable";
    string column = "a.myID";
    string pattern = "((?<=\\bselect)\\s+[^,]*\\b" + Regex.Escape(column) + "\\b[^,]*\\s*,?|\\s*,\\s*[^,]*\\b" + Regex.Escape(column) + "\\b[^,]*(?=(?:,|\\sfrom\\b)))";
    string output = Regex.Replace(input, pattern, "", RegexOptions.IgnoreCase);
    Console.WriteLine(output);
  }
} 
```

[在此处](http://ideone.com/3KVQ3)测试此代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T19:37:33.333

如果您想在 C# 中使用正则表达式“在选择后替换任何内容，直到下一个逗号”，则以下内容将起作用：

```
Regex.Replace("select a.myID, a.studentID from mytable", @"select\s[^\,]+", "select newColumn"); 
```

但是，如果您需要保留表名/别名，您可能需要稍微修改一下：

```
Regex.Replace("select a.myID, a.studentID from mytable", @"select\s([^\.]+\.)[^\,]+", "select $1newColumn"); 
```

# php - 推动 ORM：原始保存（）在级联保存中重新触发

> ID：11694195
> 
> 赞同：2
> 
> 时间：2012-07-27T19:10:31.640
> 
> 标签：php, propel

我有两个基于 Propel（Propel 1.6）的模型类，FileUpload 和 Image：

```
<table name="file_upload">
  <column name="id" type="integer" required="true" primaryKey="true" autoIncrement="true" />
  <column name="name" type="varchar" size="500" required="false" />
  <column name="mime_type" type="varchar" size="100" required="true" />
  <column name="data" type="blob" required="false" lazyLoad="true" />
</table>

<table name="image">
  <column name="id" type="integer" required="true" primaryKey="true" autoIncrement="true" />
  <column name="file_upload_id" type="integer" required="true" />
  <foreign-key foreignTable="file_upload" onDelete="restrict">
    <reference local="file_upload_id" foreign="id" />   
  </foreign-key>
</table> 
```

当我实例化一个新的图像 $image，新的 FileUpload $upload，在 $image 下注册 $upload 然后尝试保存 $image 希望级联保存 $image（第二个）和 $upload（第一个）...

```
$image = new Image();
$upload = new FileUpload();
// [set required properties in both models]
$image->setFileUpload( $image );
$image->save(); 
```

我收到外键违规错误：

> 无法执行 UPDATE 语句 [UPDATE `image`SET `FILE_UPLOAD_ID`=:p1, `UPDATED_AT`=:p2 WHERE image.ID=:p3] [wrapped: SQLSTATE[23000]：完整性约束违规：1452 无法添加或更新子行：外键约束失败（`DATABASENAME`. `image`, 约束外`image_FK_1`键 ( `file_upload_id`) 参考`file_upload`( `id`))]

我发现这个错误是因为 $upload->save() 调用 BaseFileUpload->doSave() 引起的，除此之外，它会重新触发 $image->save()：

```
if ($this->collImages !== null) {
  foreach ($this->collImages as $referrerFK) {
    if (!$referrerFK->isDeleted()) {
      $affectedRows += $referrerFK->save($con);
    }
  }
} 
```

...这意味着 FileUpload 镜像从其他对象对它的反向引用，即使它本身只是被*引用*，而不是*引用*其他任何东西。

当我覆盖 Image->save() 以首先清除链接 FileUpload 上的所有镜像引用，然后调用 parent::save() 时，问题就消失了：

```
public function save( PropelPDO $con = null )
{
  $upload = $this->getFileUpload();
  if ( null !== $upload && $upload->isModified() ) {
    $upload->clearAllReferences();
    $upload->save( $con );
    $this->setFileUpload( $upload );
  }
  return parent::save( $con );
} 
```

这种方法有效，但感觉很hacky。它也只能在这里使用，因为一旦保存了 $upload 对象，我就可以轻松地恢复外部引用 - 在其他情况下，它可能不那么简单。

是否有任何干净的方法可以防止从 $upload->save() 重新触发 $image->save() 的保存 - 而不会过多地干扰 Propel 的默认行为？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-28T01:04:43.680

您可以只在父对象（FileUpload）上调用保存，Propel 在将子对象添加到父对象后保存子对象并在父对象上调用保存。

```
<?php
$upload = new FileUpload();
$image = new Image();
$image2 = new Image();

// set required fields on $upload, $image, and $image2
// ....

$upload->addImage($image);
$upload->addImage($image2);
$upload->save(); // save upload and new images

?> 
```

# php - Codeigniter：设置编辑页面的表单值

> ID：11694196
> 
> 赞同：0
> 
> 时间：2012-07-27T19:10:32.377
> 
> 标签：php, codeigniter

我正在尝试制作一个从数据库填充表单字段的编辑页面。我试图通过设置一些随机文本来让它工作，但我无法让它显示。

我的控制器中有以下内容：

```
public function edit($item_id) {

    $this->data['title'] = "Edit Item";

    $this->data['item_title'] = array(
        'name' => 'item_title',
        'id' => 'item_title',
        'type' => 'text',
        'value' => 'a title',
      );

      $this->data['url_slug'] = array(
        'name' => 'url_slug',
        'id' => 'url_slug',
        'type' => 'text',
        'value' => 'some-url-slug',
      );

    $this->template->build('admin/item/form', $this->data);
  } 
```

这是我的看法：

```
<?php echo form_open('admin/item/update_item', array('id' => 'item_form')); ?>

<input type="text" name="item_title" value="<?php echo set_value('item_title'); ?>" id="item_title" placeholder="Enter a title..."/>

<input type="text" name="url_slug" value="<?php echo set_value('url_slug'); ?>" id="url_slug" placeholder="url-slug-of-the-item"/> 
```

当我进入 /edit/id 页面时，占位符仍在显示并且值为空白。为什么没有设置？当我将它用于表单验证时，它工作正常。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T19:14:13.290

我对codeigniter还是新手，所以请原谅我的无知。

您不能简单地使用以下内容吗？

```
<input type="text" name="item_title" value="<?= $item_title['value'] ?>" id="item_title" placeholder="Enter a title..."/> 
```

**注意：**这对fuelphp有效；不是 100% 确定 codeigniter。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T20:39:34.143

我最终放弃了数组，只是`$this->data['item_title'] = 'some title';`在控制器中做，在视图中， set_value 实际上接受了第二个参数，如下所示：

```
<?php echo set_value('item_title', $item_title); ?> 
```

这可以解决问题，尽管如果变量不存在我会收到警告，所以我需要将它们全部声明。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-17T18:40:26.587

我最终放弃了数组，只做 $data['fullName'] = 'some title'; 在控制器和视图中， set_value 实际上接受第二个参数，如下所示：

```
<?php    
   if(!isset($fullname)) {
        $fullname = set_value('fullName');   
   }

   echo form_open(base_url() . "broker/practice_send.html");

   echo form_label("Name", "name");
   $data = array(
      'name'     => 'fullName',
      'id'       => 'name',
      'value'    => set_value('fullName', $fullname)
   );
   echo form_input($data); 
```

?>

# .net - 哪些“脚本语言”可以编译为 64 位？

> ID：11694200
> 
> 赞同：3
> 
> 时间：2012-07-27T19:10:47.500
> 
> 标签：.net, scripting, vbscript

我正在寻找允许 64 位编译的 VBScript 的替代品。你能给我指出一个资源，显示哪些语言支持这个吗？我的 Google-Fu 似乎是在这个问题上的一周。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T19:32:54.700

在某些操作系统上 Ruby 确实如此，他们正在处理其余的

[有 64 位的 Ruby 吗？](https://stackoverflow.com/questions/1829310/is-there-a-64-bit-ruby)

Ruby 被认为是一种脚本语言，但它也可以被编译。我正在从 Vbscript 切换到 Ruby，因为它是一个自然的升级，不像 Python，它更难学习（我个人的看法，并不是要在这里挑起战争）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-05-22T20:54:23.100

只是为了好玩......或存档。

可以编译BS2000操作系统（西门子/富士通）上的SDF-P语言。

```
/COMPILE-PROCEDURE *LIB(TRAMEX.B.LMSLIB,DISPLAY-HELLO),TO=*LIB-ELEMENT 
```

其中`TRAMEX.B.LMSLIB`是库的名称（伪 ZIP 或伪文件夹）
，`DISPLAY-HELLO`是过程的名称。

SDF-P 语言是 JCL 语言（作业控制语言）或允许在 BS2000 上进行结构化编程的脚本。

在控制台上显示 'Hello' 4 次的示例可以是

```
/ SET-PROCEDURE-OPTIONS
/ DECLARE-VARIABLE I-COUNT(TYPE=INTEGER, 0)
/ WHILE (I-COUNT < 4)
/     I-COUNT = I-COUNT + 1
/     WRITE-TEXT 'HELLO!'
/ END-WHILE
/ EXIT-PROCEDURE ERROR=*NO 
```

可以使用以下命令启动此脚本

```
/CALL-PROCEDURE *LIB(TRAMEX.B.LMSLIB,DISPLAY-HELLO)
/CLP *LIB(TRAMEX.B.LMSLIB,DISPLAY-HELLO),LOG=YES 
```

这种脚本语言仅在西门子创建的[BS2000 操作系统](https://en.wikipedia.org/wiki/BS2000)上已知，现在由富士通销售。

当前的 SDF-P 文档可以在[Fujitsu 网站文档站点](https://bs2manuals.ts.fujitsu.com/psSDFPV25en)上找到。

这种语言已经完全过时了，但它包含一些其他现代语言所没有的特殊特征。

# python - 使用另一个类中的一个类

> ID：11694202
> 
> 赞同：0
> 
> 时间：2012-07-27T19:10:56.713
> 
> 标签：python, class, python-2.7

我编写了一个简单的程序来读取日志并解析并获取最低的起始编号（头部）并打印它。我现在正在编辑该程序并将其与我编写的用于解析实际日志文件的类相结合。本质上，与基于我之前程序的日志中的简单数字进行排序相反，我现在需要将解析后的信息从一个类引用到另一个类。我想知道最方便的方法是什么。我是 python 的初学者程序员，不知道我是否可以显式引用该类。

这是课程。

解析器

```
class LogLine:

    SEVERITIES = ['EMERG','ALERT','CRIT','ERR','WARNING','NOTICE','INFO','DEBUG']
    severity = 1

    def __init__(self, line):
        try:
            m = re.match(r"^(\d{4}-\d{2}-\d{2}\s*\d{2}:\d{2}:\d{2}),?(\d{3}),?(\s+\[(?:[^\]]+)\])+\s+[A-Z]+\s+(\s?[a-zA-Z0-9\.])+\s?(\((?:\s?\w)+\))\s?(\s?.)+", line)
            timestr, msstr, sevstr, self.filename, linestr, self.message = m.groups()
            self.line = int(linestr)
            self.sev = self.SEVERITIES.index(sevstr)
            self.time = float(calendar.timegm(time.strptime(timestr, "%Y-%m-%d %H:%M:%S,%f"))) + float(msstr)/1000.0
            dt = datetime.strptime(t, "%Y-%m-%d %H:%M:%S,%f")
        except Exception:
            print 'error',self.filename

    def get_time(self):
        return self.time
    def get_severity(self):
        return self.sev
    def get_message(self):
        return self.message
    def get_filename(self):
        return self.filename
    def get_line(self):
        return self.line 
```

分拣机

```
class LogFile:

    def __init__(self,filepath):
        self.logfile = open(filepath, "r")
        self.head = None

    def __str__(self):
        return "x=" + str(self.x) + "y="+str(self.y)

    def readline(self):
        if self.head != None:
            h = self.head
            self.head = None
            return h
        else:
            return self.logfile.readline().rstrip(' ')

    def get_line(self):
        if self.head == None:
            self.head = self.readline().rstrip(' ')
            return self.head.get.line()
        else:
            return self.head.get.line()

    def close (self):
        self.logfile.close() 
```

我已经开始通过添加 get_line 函数来编辑我的第二堂课。不知道我是否走在正确的轨道上。

简单来说，我需要头部变成“LogLine”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T19:37:28.547

使用另一个班级的一个班级是可以的。您有一个类可以解析日志文件中的一行并构建一个表示该行的对象；你有另一个类从日志文件中读取行。二等舱叫一等舱是很自然的事。

这是一个非常简单的类，它从日志文件中读取所有行并构建一个列表：

```
class LogFile(object):
    def __init__(self,filepath):
        with open(filepath, "r") as f:
            self.lst = [LogLine(line) for line in f] 
```

您可以看到它`self.lst`被设置为输入日志文件中的行列表，而不仅仅是行的文本；该代码正在调用`LogLine(line)`以存储`LogLine`. 如果需要，您可以在构建列表后对其进行排序：

```
self.lst.sort(key=LogLine.get_line) 
```

如果日志文件非常大，则构建列表可能不切实际。你有一个`.get_line()`方法函数，我们可以使用它：

```
class LogFile(object):
    def __init__(self,filepath):
        self.logfile = open(filepath, "r")

    def get_line(self):
        try:
            line = next(self.logfile)  # get next line from open file object
            return LogLine(line)
        except StopIteration:  # next() raises this when you reach the end of the file
            return None  # return 

    def close(self):
        self.logfile.close() 
```

`open()`可以迭代打开的文件对象（由函数返回）。我们可以调用`next()`这个对象，它会给我们下一个输入行。当到达文件末尾时，Python 将引发`StopIteration`文件末尾的信号。

此处代码将捕获`StopIteration`异常并`None`在到达日志文件末尾时返回。但我认为这不是处理这个问题的最佳方式。让我们让 LogFile 类在`for`循环中工作，例如：

```
class LogFile(object):
    def __init__(self,filepath):
        self.f = open(filepath)

    def __next__(self):  # Python 3.x needs this to be named "__next__"
        try:
            line = next(self.f)
            return LogLine(line)
        except StopIteration:
            # when we reach the end of input, close the file object
            self.f.close()
            # re-raise the exception
            raise
    next = __next__  # Python 2.x needs this to be named "next" 
```

Python 中的`for`循环将重复调用`.__next__()`方法函数 (Python 3.x) 或`.next()`方法函数 (Python 2.x)，直到`StopIteration`引发异常。在这里，我们定义了两个方法函数名称，所以这段代码应该可以在 Python 2.x 或 Python 3.x 中工作。

现在你可以这样做：

```
for ll in LogFile("some_log_file"):
    ... # do something with ll, which will always be a LogLine instance 
```

# iphone - UIScrollView 触摸和监听事件

> ID：11694208
> 
> 赞同：1
> 
> 时间：2012-07-27T19:11:12.997
> 
> 标签：iphone, ios, ipad, uiscrollview

我在 UIScrollView 中有一个图像，并且我有在用户拖动手指时绘制文本的代码。我希望能够控制，当用户触摸屏幕时，如果

a) 用户应该用他们的手指来画画或者

b) 用户应该用手指移动滚动视图

我有一个布尔值来跟踪用户在做什么。我有接触方法：

```
-(void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event
{

    UITouch *mytouch=[[touches allObjects] objectAtIndex:0];
    if(draw == false) {
        printf("calling super");
        [scrollView touchesBegan:touches withEvent:event];
    }
    else
        [myPath moveToPoint:[mytouch locationInView:self]];

}
-(void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event
{

    UITouch *mytouch=[[touches allObjects] objectAtIndex:0];
    if(draw == false)
        [scrollView touchesMoved:touches withEvent:event];
    else {
        [myPath addLineToPoint:[mytouch locationInView:self]];
        [self setNeedsDisplay];
    } 
```

为什么这不起作用？基本上，如果我不画画，我会调用滚动视图的 touchesBegan 和 touchesMoved。如果我正在绘画，我会使用 myPath 进行绘画。

但是，当 draw 为 false 时，滚动视图不会四处移动或放大等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T23:51:09.573

我以前遇到过这个问题。我这样解决：

你应该做一个 mainView 。它有2个属性。一个是 yourScrollView ，一个是 yourDrawImageView 。`[yourScrollView addSubviews:yourDrawImageView];[mainView addSubviews:yourScrollView];`

然后像这样在 mainView.m 中编写你的 touches 方法（忽略 scrollView 语句）

```
-(void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event
{

    UITouch *mytouch=[[touches allObjects] objectAtIndex:0];
   if ([[touches allObjects] isKindOfClass:[yourDrawImageView class]]) 
   {

        [myPath moveToPoint:[mytouch locationInView:self]];
   }

}
-(void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event
{

    UITouch *mytouch=[[touches allObjects] objectAtIndex:0];
   if ([[touches allObjects] isKindOfClass:[yourDrawImageView class]]) 
   {

        [myPath addLineToPoint:[mytouch locationInView:self]];
        [self setNeedsDisplay];
   }

} 
```

最后一步，`s you ignor is to code scrollView touches event , it`yourSceollView.m 中写的是这样的：

```
#import "yourScrollView.h"

@implementation yourScrollView

- (id)initWithFrame:(CGRect)frame {

    self = [super initWithFrame:frame];
    if (self) {
        // Initialization code.
    }
    return self;
}

- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event{
    [super touchesBegan:touches withEvent:event];
    if(!self.dragging)
        [[self nextResponder] touchesBegan:touches withEvent:event];
}

- (void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event{
    [super touchesMoved:touches withEvent:event];
    if(!self.dragging)
        [[self nextResponder] touchesMoved:touches withEvent:event];
}

- (void)touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event{
    [super touchesEnded:touches withEvent:event];
    if(!self.dragging)
        [[self nextResponder] touchesEnded:touches withEvent:event];
}

- (void)dealloc {
    [super dealloc];
}

@end 
```

我希望它可以帮助你:-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T19:15:25.400

`UIScrollView`使用`UIGestureRecognizer`s，系统分别调用 s`touchesBegan:withEvent:`和好友。一种更简单的方法是在您不希望滚动视图对触摸做出反应时简单地禁用滚动视图。

# java - Windows 服务器上的简单 Java 应用程序...我应该使用 Java EE

> ID：11694210
> 
> 赞同：1
> 
> 时间：2012-07-27T19:11:13.343
> 
> 标签：java, jakarta-ee, windows-server

我将为我的公司创建一个相当简单的 Java 应用程序，它将每晚处理一个 csv 文件。它将在我们现有的 Small Business Server 2011 机器上运行，因此它肯定需要作为服务运行（因为无论是否有人登录到服务器，它都必须运行）。最终，我想向其中添加一个 Web 组件，这样我就可以通过浏览器查看该应用程序的日志文件，而不必手动将它们从服务器上拉下来。

我正在寻找有关此项目最佳方法的反馈。我应该使用 Jave SE 并在创建的应用程序周围使用服务包装器将其转换为服务。或者我应该使用 Jave EE（我假设它已经作为服务运行）？我从来没有使用或开发过 Java EE，所以我不确定这是否是最好的方法，或者它是否会矫枉过正。如果 Jave EE 是最好的方法，您可以分享有关如何开始使用它的所有信息，我们将不胜感激。

谢谢，哈利

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T19:14:24.853

Java EE 是一组 API，包括 JMS、servlet、JNDI、JDBC、EJB 等。因此，通过使用这些 API 中的任何一个，您几乎可以声称您正在使用 Java EE，因为它的价值。

至于您的特定问题，我可能会将您的程序开发为一个[简单的基于 servlet 的应用程序，并在](http://docs.oracle.com/javaee/6/tutorial/doc/bnafd.html)[Jetty](http://jetty.codehaus.org/jetty/)等小容器下运行它。这样你就有了一个轻量级的容器（Jetty）和一个相当简单的程序来编写，它可以有一个简单的前端用于管理/监控。请注意，Servlet API 构成了 Java EE 规范的一部分，因此您符合 Java EE 标准，尽管是次要的方式。

另一种方法是（取决于 Web 界面的重要性）是将程序编写为独立程序，并使用[Java Service Wrapper](http://wrapper.tanukisoftware.com/doc/english/introduction.html)将其作为服务运行。稍后，您可以[将 Jetty 嵌入](http://docs.codehaus.org/display/JETTY/Embedding+Jetty)到您的程序中，并编写简单的基于 servlet 的 API 以在嵌入式 Web 服务器下运行。我在许多项目中使用了这种方法，并且效果很好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-27T22:25:24.983

在短期内，您是否正在寻找一个 Web 界面，某人通过该 Web 界面上传（Web 界面）或某个进程推送（Web 服务）您然后处理的 csv 文件？如果是，那么请考虑 Java EE：servlet、RESTful Web 服务等，正如其他人提到的那样。

否则，您是否只是要按计划处理“在文件系统某处”的现有 csv 文件？如果是，则考虑[基于计时器的 Java EE 服务](http://docs.oracle.com/javaee/1.4/tutorial/doc/Session5.html)。

您的生产环境的管理团队可能对他们的喜好有所了解。如果他们面向 Windows 管理方案，他们可能会更适应“本机 Windows”方法来部署、启动、停止、重新启动、调度等（即服务包装的 Java 程序）。仅针对一个流程的另一层“服务管理”可能是不必要的复杂性。

无论您做什么，都要记录您的设置/配置/期望。

从长远来看，正如其他人所指出的，您对基于 Java 的 Web 监控界面的需求将需要一个应用服务器。考虑您的短期/长期优先事项、要满足的时间表等。您需要什么，什么时候？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-27T19:15:39.670

任何需要企业级功能的事情都应该使用 Java EE 来完成：

> Java EE 平台构建在 Java SE 平台之上。Java EE 平台为开发和运行大规模、多层、可扩展、可靠和安全的网络应用程序提供了 API 和运行时环境。

[http://docs.oracle.com/javaee/6/firstcup/doc/gkhoy.html](http://docs.oracle.com/javaee/6/firstcup/doc/gkhoy.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-27T19:15:45.473

除非您准备好从 Java SE 自己实现 Web 服务器，否则您别无选择：您需要一些 Web 应用程序框架。例如，它可以是 Java EE Web 容器，也可以是 Play 等其他实现。但是 Java SE 还不够。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-27T19:34:45.437

其他人已经向您解释了什么是 JavaEE。

既然你说“简单”，我想 JSP 和 Servlet 可以完成这项工作。您将需要一个像 tomcat 这样的 web 容器，仅此而已（这比拥有 ejb 容器 + web 更容易！）。实际上 servlet 和 JSP 也可以做一些不简单的事情。

如果您愿意使用像会话这样的东西，它的设计比 Servlet 会话更好，那么您可能想要处理 EJB 等。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2012-07-27T19:33:25.267

您可以使用 webservices 例如axis2

# wpf - 按下时最小化WPF窗口 +

> ID：11694212
> 
> 赞同：1
> 
> 时间：2012-07-27T19:11:17.703
> 
> 标签：wpf, windows, c#-4.0, wpf-controls

`Windows button`我有一个 WPF 应用程序，我想通过按+使其最小化，`M`就像任何普通窗口一样。如何才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T21:33:13.827

由于您没有提供太多信息，我只能猜测为什么您的窗口没有最小化。我的猜测是您已设置[`ResizeMode`](http://msdn.microsoft.com/en-us/library/system.windows.window.resizemode.aspx)为`NoResize`.

# wxpython - wxPython：为 ASCII 游戏创建多色文本小部件

> ID：11694213
> 
> 赞同：0
> 
> 时间：2012-07-27T19:11:21.267
> 
> 标签：wxpython

如何创建一个只读的多色文本小部件，如 StyledTextCtrl，但没有滚动条、边框等？它应该只是一个小部件，允许用不同的颜色绘制文本的不同部分，仅此而已......

也许 wxPython 不是最好的解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T13:37:29.217

您可以使用带有 TE_RICH 样式标志的 wx.TextCtrl 并将其设置为没有任何边框。或者您可以使用 HTMLWindow。

# c++ - Visual Studio C++ 项目错误回复：LOCALAPPDATA

> ID：11694217
> 
> 赞同：0
> 
> 时间：2012-07-27T19:11:32.873
> 
> 标签：c++, visual-studio-templates

我正在尝试在 VS 10 中创建一个新的 C++ 项目，甚至无法从模板中加载一个空项目。我收到一个错误...

“exists”函数只接受一个标量值，但它的参数“$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props”计算结果为“{~}”，它不是一个标量值。

{~} 值是我存储在计算机环境变量中的 LOCALAPPDATA 变量中的值，最后与“\Microsoft\MSBuild\v4.0\Microsoft.Cpp.Win32.user.props”连接。

我不愿意在不了解发生了什么的情况下更改任何模板文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T18:35:34.183

@Mihai 提供的链接提供了我找到解决方案所需的信息。问题是 LocalAppData 没有它正在寻找的值（正是错误消息所说的）。我无法更改该数据，因为其他应用程序已出于自己的目的对其进行了修改（值不是“~”，这是这篇文章的占位符）。

相反，我在记事本中打开了 .vcxproj 文件，并修改了导致错误的 ImportGroup 节点。而不是属性：

```
Condition="exists('$(UserRootDir)\Microsoft.Cpp.$(Platform).user.props')" 
```

...它现在读取

```
Condition="exists('$(UserProfile)\Local Settings\Application Data\Microsoft.Cpp.$(Platform).user.props')" 
```

项目现在加载。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T21:36:11.500

好吧，看起来 Windows XP 没有为这个变量提供任何默认值，而且“~”在你的 PC 上绝对不是一个有效的目录。尝试[按照此处所述](http://www.winhelponline.com/blog/add-localappdata-environment-variable-in-windows-xp/)进行设置，也许您会很幸运。VS2010 有[一些](http://connect.microsoft.com/VisualStudio/feedback/details/473376/localappdata-environment-variable-referenced-by-vc-projects-on-windows-xp)与此相关的错误。也许您还需要将其升级到 SP1。

# java - Java listFiles 显示引导目录和其他“受保护”文件

> ID：11694220
> 
> 赞同：0
> 
> 时间：2012-07-27T19:11:47.873
> 
> 标签：java, windows, file, recursion, directory

我正在使用以下递归方法列出给定目录中的所有文件和文件夹，但是它似乎列出了一些在 Windows 资源管理器中不可见的文件——即使我显示隐藏和系统保护的文件。我设置了扫描`C:\\`目录的方法，在输出目录中的`Boot`文件和`BOOTSECT.BAK`. 好吧，实际上，我不认为它挂起 - 看起来它返回了最终数组，但还有更多文件并且没有抛出异常！

```
private static ArrayList<File> recursiveSearch(File dir){
        File[] files = dir.listFiles();
        ArrayList<File> result = new ArrayList<File>();
        for(File file : files)
            if(file.isDirectory()){
                result.add(file);
                ArrayList<File >tempList = recursiveSearch(file);

                for(File temp : tempList)
                    result.add(temp);
            }else{
                result.add(file);
                System.out.println(file.getPath());
            }
        return result;

    } 
```

我知道`FileSystemView`但在这种情况下我不能使用它，因为我需要应用自定义文件名过滤器（我已从上面排除，但我已经测试过并且它不会影响方法输出）。任何帮助将不胜感激 - 在此先感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T19:24:02.953

此文件 (bootsect.bak) 被检测为目录，但返回一个空文件数组。一种解决方法是检查它是否已实例化：

```
private static List<File> recursiveSearch(File dir) {
    File[] files = dir.listFiles();
    List<File> result = new ArrayList<File>();
    if (files != null) {
        for (File file : files)
            if (file.isDirectory()) {
                result.add(file);
                List<File> tempList = recursiveSearch(file);

                for (File temp : tempList)
                    result.add(temp);
            } else {
                result.add(file);
                System.out.println(file.getPath());
            }
    }

    return result;
} 
```

# jquery - Nivo Slider not Diplaying

> ID：11694221
> 
> 赞同：0
> 
> 时间：2012-07-27T19:11:49.880
> 
> 标签：jquery, slider, nivo-slider

I am having an issue with the nivo slider JQuery script. I have the slideshow working on a page with no layout here: [http://www.studentbridges.org/nivo-slider/slideshow.php](http://www.studentbridges.org/nivo-slider/slideshow.php) .

But once I add it to my layout, it simply does not display. [http://www.studentbridges.org/new/](http://www.studentbridges.org/new/)

On that page, the slideshow is supposed to appear over the picture in the header. It just doesn't work. Here is the code for how I set up the slideshow:

```
<head>
    <link rel="stylesheet" href="/nivo-slider/themes/default/default.css" type="text/css" media="screen" />
    <link rel="stylesheet" href="/nivo-slider/nivo-slider.css" type="text/css" media="screen" />
</head>

<div style="position: relative; left: 29px; top: 77px;">
<div style="position:absolute; width: 356px; height: 263px;" >

        <div id="slider" class="nivoSlider">
            <img src="/nivo-slider/001.png" alt="" />
            <img src="/nivo-slider/002.png" alt="" />
            <img src="/nivo-slider/003.png" alt="" />
        </div>
        <div id="htmlcaption" class="nivo-html-caption">
            <strong>This</strong> is an example of a <em>HTML</em> caption with <a href="#">a link</a>. 
        </div>

<script type="text/javascript" src="/nivo-slider/jquery-1.7.1.min.js"></script>
<script type="text/javascript" src="/nivo-slider/jquery.nivo.slider.js"></script>
<script type="text/javascript">
$(window).load(function() {
$('#slider').nivoSlider({
    effect: 'fade', // Specify sets like: 'fold,fade,sliceDown'
    animSpeed: 500, // Slide transition speed
    pauseTime: 3000, // How long each slide will show
    startSlide: 0, // Set starting Slide (0 index)
    directionNav: true, // Next & Prev navigation
    directionNavHide: true, // Only show on hover
    controlNav: false, // 1,2,3... navigation
    controlNavThumbs: false, // Use thumbnails for Control Nav
    pauseOnHover: true, // Stop animation while hovering
    manualAdvance: false, // Force manual transitions
    prevText: 'Prev', // Prev directionNav text
    nextText: 'Next', // Next directionNav text
    randomStart: false, // Start on a random slide
});
});
</script>

</div>
</div> 
```

I believe I have all the stylesheets linked in my header. All the images are the same size as the container DIV as well, so I'm not sure what the issue is.

Anyone have any input as to what the issue could be?

~Noelle

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T20:34:05.743

问题似乎出在您的 php 头文件中。

头文件中的所有内容都已压缩为一行。这会导致您的 javascript 出现错误，因为您的滑块配置中有注释。这些评论阻碍了您的其他选择。

修复头文件的格式，一切都应该很好。

# matlab - MATLAB减少功能？

> ID：11694224
> 
> 赞同：2
> 
> 时间：2012-07-27T19:11:57.020
> 
> 标签：matlab, image-processing, functional-programming

我想使用 将图像单元格数组一起添加`imadd`，但`imadd`只需要两个参数。MATLAB中是否有一个reduce函数，我可以使用将所有这些图像添加在一起而无需编写for循环？

```
images = {im1, im2, im3};
sum = reduce(@imadd, images); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T19:27:09.737

您可以只使用具有额外维度的数组。例如二维（灰度图像）

```
images = {im1, im2, im3};
imarr = cat(3, images{:});
imsum = sum(imarr, 3); 
```

当然，首先不需要创建元胞数组；你可以直接去

```
imarr = cat(3, im1, im2, im3);
imsum = sum(imarr, 3); 
```

甚至

```
imsum = sum(cat(ndims(im1)+1, im1, im2, im3),ndims(im1)+1); 
```

这也更普遍地结合了任何维度矩阵。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-29T19:46:56.973

由于您使用的是图像处理工具箱，因此也可以使用[IMLINCOMB](http://www.mathworks.com/help/toolbox/images/ref/imlincomb.html)函数（图像的线性组合），只需将所有系数设为 1：

```
imsum = imlincomb(1,im1, 1,im2, 1,im3) 
```

# c# - Left hand side assignment in C# error

> ID：11694225
> 
> 赞同：2
> 
> 时间：2012-07-27T19:11:58.700
> 
> 标签：c#, vb.net

I am converting some VB code into C#. In VB the code looks like the following:

```
oTP.CreateObject("SomeInterop")    
oTP.Session("SomeKey") = 5 
```

In C#, if I do:

```
oTP.Session("SomeKey") = 5; 
```

I get a compilation error, "The left-hand side of an assignment must be a variable, property or indexer". In VB, oTP is declared as an object and in C#, i declared it as dynamic. In the oTP code, Session looks like this:

```
Public Property Session(ByVal VariableName As String) As Object
Get
....
End Get
Set(ByVal Value As Object)
.....
End Set 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-27T19:13:16.810

The syntax for [indexers](http://msdn.microsoft.com/en-us/library/6x16t2tx.aspx) in C# is different - you need to use square braces:

```
oTP.Session["SomeKey"] = 5; 
```

# c# - 将对象读写到 JSON

> ID：11694227
> 
> 赞同：-1
> 
> 时间：2012-07-27T19:12:07.097
> 
> 标签：c#, json, object

如果我有一堂课`Contact`：

```
 public class Contact
   {
    public Contact()
    {

    }

    public int ID { get; set;}
    public string firstName { get; set;}
    public string lastName { get; set;}

    } 
```

在我的代码中，我实例化了 5 个不同`Contact`的对象及其特定属性，然后将它们放入`List<Contact>`.

我的问题：

*   如何将其转换`List<Contact>`为 JSON？
*   如何将 JSON 读回`List<Contact>`?
*   如何从 JSON 中读取 ID 为 123 的联系人并从中实例化一个`Contact`对象，以便拥有所有属性？

非常感谢您的帮助！谢谢！

PS JSON 看起来像这样？：

```
{
    contacts:{
        contact:[
            {
                id:123,
                firstname:'jhon',
                lastname:'smith'
            },
            {
                id:1234,
                firstname:'robert',
                lastname:'smith'
            }
        ]
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T19:31:36.127

快速搜索网络会发现对 JavaScriptSerializer 的建议

```
System.Web.Script.Serialization.JavaScriptSerializer oSerializer = 
new System.Web.Script.Serialization.JavaScriptSerializer();
string sJSON = oSerializer.Serialize(YOUR CLASS HERE); 
```

我建议你试一试。

来源[在这里](http://blogs.microsoft.co.il/blogs/pini_dayan/archive/2009/03/12/convert-objects-to-json-in-c-using-javascriptserializer.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T19:33:18.330

查看 JSON.NET（OSS 第三方库）或 DataContractJsonSerializer（从 3.5 开始在框架中可用）。

# php - 社交网络的复杂代码逻辑

> ID：11694230
> 
> 赞同：0
> 
> 时间：2012-07-27T19:12:21.227
> 
> 标签：php, codeigniter

Node1id 是发送请求的用户，node2id 是接收请求的用户。我如何将下面的代码限制为仅显示对 node2id 的请求。我试着做：

```
$row->relationType == 'requested' && node2id == $userid 
```

但它似乎不想工作。有任何想法吗？

![在此处输入图像描述](../Images/364087f48b20c0ecd67c22ce156a6a66.png)

```
<?php
$selectedId = $_REQUEST['id'];
$myuserid = $this->session->userdata('userid');
$query1 = $this->db->query("SELECT * FROM friends WHERE node1id = '{$myuserid}' AND node2id = '${selectedId}'");
      foreach($query1->result() as $row) {
      if ($row->relationType == 'requested') { ?>
            <script type="text/javascript">
                $(document).ready(function() {
                    $("#addFriend").replaceWith('<span id="requestAlert"><span class="font1">wants to be your friend&nbsp;</span><input type="submit" id="acceptRequest" value="Accept" style="width: 60px; height: 28px" class="button1" />&nbsp;<input type="submit" id="denyRequest" value="Deny" style="width: 50px; height: 28px" class="button1" /></span>');
                });
            </script>
<?php } } ?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T19:31:15.397

编辑：根据您的评论。根据您的描述，我认为它应该是这样的：

```
<?php
  $selectedId = $_REQUEST['id'];
  $myuserid = $this->session->userdata('userid');
  $query1 = $this->db->query("SELECT * FROM friends WHERE relationType = 'requested' AND node2id = '${myuserid}' AND node1id ='$selectedId'");
  foreach($query1->result() as $row) { ?>
       <script type="text/javascript">
          $(document).ready(function() {
             $("#addFriend").replaceWith('<span id="requestAlert"><span class="font1">wants to be your friend&nbsp;</span><input type="submit" id="acceptRequest" value="Accept" style="width: 60px; height: 28px" class="button1" />&nbsp;<input type="submit" id="denyRequest" value="Deny" style="width: 50px; height: 28px" class="button1" /></span>');
          });
       </script>
  <?php }  ?> 
```

# javascript - Managing lightboxes and the content within them

> ID：11694232
> 
> 赞同：0
> 
> 时间：2012-07-27T19:12:37.670
> 
> 标签：javascript, jquery, html, ruby-on-rails

I want to find a better way of managing lightboxes with JS. I'm working in a Rails environment.

I usually put the HTML for lightboxes in my Rails application layout file, then I would simply use JS to show / hide these lightboxes when needed - this is very static. Sometimes I would use jQuery to create the lightbox and the content within it on the fly and then show and hide that, very messy.

Should I be using JS templates for this? I think I want to have several templates that contain different content for lightboxes - with the ability to output variables in these templates.

What's the best way to maintain several lightboxes of different widths / heights and content?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T19:23:07.930

我会完全抽象您的灯箱（不会将任何 html 放入布局中），而是动态生成整个内容并将其附加到正文或指定元素。至于存储不同尺寸的灯箱，我想这取决于您使用的是什么灯箱。它们中的很多都允许您传递一个配置对象，该对象控制尺寸等。这可能是最好的方法，因为您将重用相同的代码，只需为其指定不同的尺寸。

# visual-studio-2010 - Visual Studio 2010: prerequisites issue

> ID：11694249
> 
> 赞同：1
> 
> 时间：2012-07-27T19:14:00.157
> 
> 标签：visual-studio-2010, installation

On Microsoft Visual Studio 2010 I would like to create a installer for a solution I created.

I created it by menu way (File > New project... > Other Project Types > Setup and Deployment > Visual Studio Installer > Setup Project), added files to their correct destinations etc., and all works fine, except for prerequisites...

The problem is that my solution depends on .Net 3.5 and I would like to install it automatically together with the installer, in some offline way - no internet downloads on installation time.

If on installer project properties I mark "create setup to install install prerequisite components" and mark "download prerequisites from the same location as my application"...

![screenshot](../Images/9a540fe1b7a48f0f9c5ed9cc5b8db196.png)

... when I try to run, it shows messages like that:

> Error 7 The install location for prerequisites has not been set to 'component vendor's web site' and the file 'DotNetFX35SP1\dotNetFX20\aspnet.msp' in item '.NET Framework 3.5 SP1' can not be located on disk. See Help for more information. D:\Projetos\Eletronica\M013-Moura\HG-V6-release1\VidaCiclada-semTemperatura\VidaCiclada_Installer\VidaCiclada_Installer.vdproj VidaCiclada_Installer

Well, I put my offline installer of .Net 3.5 on the same folder EXE output of my solution is. What am I doing wrong?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T19:44:33.993

虽然我无法完全完成我的安装程序包，但我发现了问题：

1.  我点击了属性面板
2.  我点击了设置项目
3.  在名为“本地化”的属性上，我将值更改为“英语（美国）”

所以我可以构建项目并正常执行安装程序（除了 SQL Server Express，我也想用那个包安装，但是虽然它是用安装程序执行的，但它不会为它创建 Windows 服务......） .

即，问题是我的 VS2010 没有设置我的母语“葡萄牙语（巴西）”所需的文件，但它有英语。最终设置将安装英语语言的先决条件...

# xcode - Xcode and Core Data - 'Create NSManagedObject Subclass'

> ID：11694251
> 
> 赞同：3
> 
> 时间：2012-07-27T19:14:05.287
> 
> 标签：xcode, core-data

In Xcode, I can select ONE entity and go to Editor > Create NSManagedObject Subclass. This bit is fine. I get the class out of ONE entity.

However....

The other day, somehow I got Xcode instead to pop up a dialog with all my entities with checkboxes next to them. I could select multiple entities all at once, which it would then create the classes for all selected.

I can't seem to find how I did this !!! Anybody use this and know how?

(Don't suggest me to use mogenerator. I know about this.)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-27T19:22:34.000

我想到了。这太荒谬了。

选择/突出显示一个实体，然后突出显示该实体中的一个属性......任何一个......

...然后转到“编辑器 > 创建 NSManagedObject 子类”。

显然你也可以只突出显示多个实体，然后在上面做同样的事情，虽然我没有尝试过。

# apache - Why won't xampp apache server load localhost on any port when control panel says it's running?

> ID：11694256
> 
> 赞同：0
> 
> 时间：2012-07-27T19:14:25.443
> 
> 标签：apache, localhost

I just downloaded the most recent copy of xampp. I have been using this for some time. However, today I cannot get anything to load from localhost. The XAMPP control panel says it is running. I have seen when another application has port 80 and I cannot get it to start. It will report busy. That's not happening though.

I did install ruby on rails last night. I was following some online training with Lynda.com. That is supposed to use Webbrick server on port 3000\. That doesn't work anyway.
So, can anyone suggest what I should do? Thanks, Bruce

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T13:57:59.857

Did battle for 2 hours this am. Did a clean install of XAMPP on my Windows7 computer and walked through a ruby install. Apache would not start. I believe when I copied the code to add in httpd.conf into notepad++, I got slanting quotes. When I edited the quotes, they went back in as straight up and down. That was my stupid problem, just saying.

Details:

I ran the apache_start.bat file to see what was going on. I kept getting the error that line 520 which had to do with documentroot, was not a directory. I put ..htdocs/project01/public, which existed.

I thought maybe the permissions were wrong. Spent an hour in DOS (remember the attrib command), the changed UAC and still got the same error. Then I noticed that one of the quotes in the Ruby section at the bottom was slanted and the other was straight. When I deleted that and added another quote, it appeared straight up and down.

Used the bat file to start apache. Then it gave me an error on line 521 the Directory. Changed the quote on that and apache started. And I got the opening html page in Ruby.

I suspect if I had sudo or used the Windows Notepad editor and made sure I saved it as a MS-DOS text file, all would have been fine. Copying and pasting caused my issue.

# hibernate - Hibernate：Oracle 和 PostgreSQL 的映射

> ID：11694268
> 
> 赞同：0
> 
> 时间：2012-07-27T19:15:15.193
> 
> 标签：hibernate, oracle11g, postgresql-9.1

我有一个要求，我需要同时支持 Oracle 和 PostgreSQL。我有以下休眠映射 -

```
<id name="id" type="java.lang.Integer">
    <column name="id"  not-null="true" />
    <generator class="native">
        <param name="sequence">`OneTimeAccessToken_id_seq`</param>
    </generator>
</id>
<property name="resource" type="java.lang.String">
    <column name="`res`" not-null="true" />
</property>
<property name="expires" type="long">
    <column name="`expires`" not-null="true" />
</property> 
```

然而，这对 Oracle 不起作用，因为它有那个反引号。如果我删除反引号，则 PostgreSQL 将失败。关于如何为这两个数据库提供支持的任何输入。

我用`org.hibernate.dialect.Oracle10gDialect`的是Oracle 11.2版本，对吗？

我的问题是反引号而不是使序列在数据库之间兼容。我已经做到了。我在 hbm 文件中使用反引号使 PostgreSQL 根据我指定的字符大小写创建表/列。如果我删除这些反引号，PostgreSQL 会将所有内容都转换为小写。现在有了反引号，PostgreSQL 一切正常，但是，它与 Oracle 产生问题，说它***找不到表或视图：“OneTimeAccessToken”***。我试图确定我应该如何解决维护表/列名称案例的问题，并使其适用于 Oracle。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T13:09:14.573

有一个专门的发电机

```
<generator class="sequence-identity">
    <param name="sequence">OneTimeAccessToken_id_seq</param>
</generator> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T12:41:46.737

您好，我不知道您是否对基于注释的配置开放，但它似乎在[这种](https://stackoverflow.com/questions/4288740)情况下有效。正如我所看到的，他们刚刚指定了没有任何引号的序列名称，所以我希望这可以工作，我目前没有工作的 PostgreSQL 数据库（现在只是安装它）所以我无法运行我的应用程序用它并肯定地告诉你，但这应该可以工作。至于您[在此处](https://stackoverflow.com/questions/4369944/)看到的第二个问题，是的，使用 Oracle10gDialect 版本 11 应该没问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T15:25:34.093

我不会尝试在同一个 SessionFactory 中混合使用数据库方言。如果你有两个数据库要支持，你将不得不使用两种不同的 Hibernate 配置。这自然解决了 ID 生成冲突，因为您只需为 Oracle 域中的类与 Postgres 域中的类使用不同的生成器。

# post - 使用 Google Apps 脚本创建 POST 正文

> ID：11694271
> 
> 赞同：0
> 
> 时间：2012-07-27T19:15:24.580
> 
> 标签：post, google-apps-script, google-calendar-api, urlfetch

我正在尝试创建一个向用户的 Google 日历添加新所有者的 Google Apps 脚本。下面的第一个代码块可以正常工作（以 JSON 格式返回日历 ACL）。如何使用 Google Apps 脚本向 acl 添加新用户？第二个代码块显示了我尝试将新规则插入 acl。

```
function getCalendarACL() {

  // Get Calendar ID, script user's email, and the API Key for access to Calendar API
  var calId = 'abc123@group.calendar.google.com';
  var userEmail = Session.getActiveUser().getEmail();
  var API_KEY = '012345abc123';  

  // Get authorization to access the Google Calendar API
  var apiName = 'calendar';
  var scope = 'https://www.googleapis.com/auth/calendar';
  var fetchArgs = googleOAuth_(apiName, scope);

  // Get the authorization information and the given calendar
  fetchArgs.method = 'GET';

  // Get the requested content (the ACL for the calendar)
  var base = 'https://www.googleapis.com/calendar/v3/calendars/';
  var url = base + calId + '/acl?key=' + API_KEY;
  var content = UrlFetchApp.fetch(url, fetchArgs).getContentText();
  Logger.log(content); 
}

function googleOAuth_(name,scope) {
  var oAuthConfig = UrlFetchApp.addOAuthService(name);
  oAuthConfig.setRequestTokenUrl("https://www.google.com/accounts/OAuthGetRequestToken?scope="+scope);
oAuthConfig.setAuthorizationUrl("https://www.google.com/accounts/OAuthAuthorizeToken");

  oAuthConfig.setAccessTokenUrl("https://www.google.com/accounts/OAuthGetAccessToken");
  oAuthConfig.setConsumerKey("anonymous");
  oAuthConfig.setConsumerSecret("anonymous");
  return {oAuthServiceName:name, oAuthUseToken:"always"};
} 
```

这是返回服务器错误 400（“解析错误”）的第二个代码块：

```
 function insertRule() {

  // Get Calendar ID, script user's email, and the API Key for access to Calendar API
  var calId = 'abc123@group.calendar.google.com';
  var userEmail = Session.getActiveUser().getEmail();
  var API_KEY = '012345abc123'; 
  var newUserEmail = 'person@gmail.com'; 

  // Get authorization to access the Google Calendar API
  var apiName = 'calendar';
  var scope = 'https://www.googleapis.com/auth/calendar';
  var fetchArgs = googleOAuth_(apiName, scope);

  // Get the authorization information and the given calendar
  fetchArgs.method = 'GET';

  // Create the POST request body
  var rawXML = "<entry xmlns='http://www.w3.org/2005/Atom' " +
           "xmlns:gAcl='http://schemas.google.com/acl/2007'>" +
           "<category scheme='http://schemas.google.com/g/2005#kind'" +
           "term='http://schemas.google.com/acl/2007#accessRule'/>" +
           "<gAcl:scope type='user' value='"+newUserEmail+"'></gAcl:scope>" +
           "<gAcl:role='writer'>" +
           "</gAcl:role>" +
           "</entry>";

  // Get the requested content (the ACL for the calendar)
  var base = 'https://www.googleapis.com/calendar/v3/calendars/';
  var url = base + calId + '/acl?key=' + API_KEY;
  var content = UrlFetchApp.fetch(url, fetchArgs).getContentText();
  Logger.log(content); 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-28T07:53:55.637

在制作 rawXML 字符串然后重试时，我会像这样 encodeURIComponent(newUserEmail) 对 newUserEmail 变量进行编码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-05T03:05:46.387

您正在使用：

```
 fetchArgs.method = 'GET'; 
```

[但是在这里](https://developers.google.com/google-apps/calendar/v3/reference/acl/insert)找到的 Acl:insert 页面上说：

> **HTTP 请求**
> 
> ```
> POST https://www.googleapis.com/calendar/v3/calendars/calendarId/acl 
> ```

所以，应该是，

```
 fetchArgs.method = 'POST'; 
```

# function - 是否可以在 Haskell 中的列表上映射函数元组？

> ID：11694275
> 
> 赞同：6
> 
> 时间：2012-07-27T19:15:43.797
> 
> 标签：function, haskell, tuples, applicative

我正在尝试找到一种方法来做这样的事情：

```
(head, last) `someFunction` [1, 2, 3] 
```

生成元组`(1, 3)`作为输出。

它在理论上似乎类似于应用函子，但有点倒退。我猜有一个类似的功能可以做到这一点（或某种方法），但我似乎无法找到它/弄明白。

我尝试定义这样的函数：

```
fmap' :: ((a -> b), (a -> b)) -> [a] -> (b, b)
fmap' (f1, f2) xs = (f1 xs, f2 xs) 
```

但 GHC 实际上不会编译这个。

任何帮助都会很棒；谢谢！

**编辑（一年后！）：**

我`fmap'`不会编译，因为类型签名是错误的。显然有更好的方法来做我正在做的事情，但我的类型`fmap'`应该是：

```
fmap' :: ((a -> b), (a -> b)) -> a -> (b, b) 
```

在这种情况下，它编译并运行得很好。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-27T19:38:30.400

我认为你可以用箭头做到这一点。

```
head &&& last $ [1,2,3] 
```

将返回`(1,3)`。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-07-27T19:47:42.983

> 它在理论上似乎类似于应用函子，但有点倒退。

实际上，这是一个无聊的老前锋应用函子；具体来说，读者`((->) r)`。

```
Prelude Control.Applicative> liftA2 (,) head last [1,2,3]
(1,3) 
```

或者，如果你喜欢这样的事情：

```
Prelude Control.Applicative> let sequenceA [] = pure []; sequenceA (x:xs) = (:) <$> x <*> sequenceA xs
Prelude Control.Applicative> [head, last] `sequenceA` [1,2,3]
[1,3] 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-07-27T19:20:01.110

类型`fmap'`不对。它应该是

```
fmap' :: ([a] -> b, [a] -> b) -> [a] -> (b, b) 
```

或者，它可以更概括

```
fmap' :: (a -> b, a -> c) -> a -> (b, c) 
```

真的不像`fmap :: (a -> b) -> f a -> f b`。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-07-27T19:32:50.853

在这种情况下可以尝试的方法是省略类型签名并检查 GHC 推断的内容。

这样做并询问 GHCi`:t fmap'`会产生签名

```
fmap' :: (t2 -> t, t2 -> t1) -> t2 -> (t, t1) 
```

这与 KennyTM 的通用版本相同，将为您提供您正在寻找的行为。

# c++ - 使用不带 DISPLAY 的 GTK

> ID：11694278
> 
> 赞同：8
> 
> 时间：2012-07-27T19:15:51.680
> 
> 标签：c++, c, gtk

是否可以在没有有效 X 显示的情况下使用 GTK？

我想将 GTK 与 Webkit 一起使用，但目前我只对使用 DOM 函数进行实验感兴趣，因此我不需要实际显示任何内容。在没有显示器的服务器上通过 SSH 连接执行此操作对我来说非常方便。

但是，如果没有`DISPLAY`环境变量，`gtk_init()`只会失败并显示以下消息：

`Gtk-WARNING **: cannot open display:`

无论如何在没有显示器的情况下使用 GTK 吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-27T21:06:15.457

有一个名为 Xvfb 的 X 服务器，它提供一个有效`DISPLAY`的并将输出发送到文件而不是图形硬件。您可以在运行 gtk 客户端的同一台机器上运行它，而 gtk 将能够在不使用任何网络带宽的情况下做它想做的任何事情。作为奖励，您可以从文件中读取 Xvfb 的输出缓冲区，从而获得屏幕上的屏幕截图。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T21:59:09.840

虽然这不是您问题的直接答案，但我认为您正在寻找的是“无头”网络浏览器。有一个基于 WebKit，称为[PhantomJS](http://phantomjs.org/)。它不需要任何 GUI 堆栈，您可以在那里自由地试验 DOM。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-28T00:56:38.830

Gtk+ 3（好吧，GDK）现在支持多个后端，但仍然需要 X11、Wayland 或 Broadway（实验性 HTML5 后端）才能运行。

`DISPLAY`不一定需要实际的硬件；你可以运行一个假的 X 服务器，例如[Xvfb](http://en.wikipedia.org/wiki/Xvfb)或 Xvnc。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-05-04T22:25:55.340

我很高兴我更深入地阅读了文档并且不只是相信这个答案。

> `gtk_init_check()`
> 
> 此函数与 gtk_init() 的工作相同，只有一个更改：如果窗口系统无法初始化，它不会终止程序。相反，它在失败时返回 FALSE。

# android - 自由变换 Android 图像

> ID：11694282
> 
> 赞同：2
> 
> 时间：2012-07-27T19:16:03.097
> 
> 标签：android, image, matrix, bitmap, transform

我想自由转换​​ Android 图像。我已经习惯了使用矩阵来倾斜位图，如下所示（想象一下红色形状被位图或 jpeg 图像替换）：

![在此处输入图像描述](../Images/0ee96443761ef4942379245eacef20dc.png)

我想要做的是能够自由变换图像。因此，例如，仅移动 1 个角并让其他角保持在同一位置。这样做的有效方法是什么？

我需要做某种矩阵数学来做到这一点吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-28T02:43:04.850

[未应用 setPolyToPoly](https://stackoverflow.com/questions/5650809/setpolytopoly-not-applied)

matrix.setpolytopoly 解决了这个问题。上面是我找到的链接。

# php - PHP MYSQL 下一个和上一个产品按钮

> ID：11694285
> 
> 赞同：0
> 
> 时间：2012-07-27T19:16:09.253
> 
> 标签：php, mysql, database

我有一个从数据库中提取类别的动态页面。这个页面是`categories.php?CTGID=####`，`CTGID`代表分类号。然后，每个产品都有一个分配给它的 ID。

当他们点击该类别中的产品时，它会进入一个页面`Products.php?ID=###`。我想要创建的是当它们在产品页面中时有一个下一个和上一个按钮。

我基本上需要它做的是获取`CTGID`当前产品 ID，然后下一个按钮将是具有该类别 ID 的下一个产品的 ID。

```
<?php
$db=mysql_connect ("localhost",[username],[password]) or die(mysql_error());
mysql_select_db("rentals");
$rentID = $_GET['ID'];
//Strip html
$strip_ID = strip_tags($rentID);
$html = htmlentities($strip_ID, ENT_QUOTES);
$escape = addslashes($html);
$table="online_rental_db";

$sql = "SELECT * FROM $table WHERE ID=$escape";
$query = mysql_query($sql) or die(mysql_error());
$rentals = mysql_fetch_assoc($query);
$description = ucwords(strtolower($rentals['Description']));
$image = $rentals['Image'];
$download = $rentals['PDF'];
$ID = $rentals['ID'];
$CTGID = $rentals['CTGID'];
$category = $rentals['Category'];
$video = $rentals['Video'];
$bytes = filesize("rentals/".$download);
$model = $rentals['Model'];
$made = ucwords(strtolower($rentals['Manufacturer']));
$productnum = $rentals['Productnum']; 
```

然后在页面上我只是呼应我在哪个区域需要什么。我已经阅读了一些关于下一个和上一个按钮的文章，但决定我可能需要一些额外的建议！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T19:26:09.770

不确定您尝试过什么，但过去我已经通过以下查询实现了从数据库中获取下一个/上一个值：

```
$curId  = 42;  // current product id
$curCat = 1;   // current category

$sqlPrev = 'SELECT `id` FROM `table`
            WHERE `id` < '$curId' AND `catId` = '$curCat'
            ORDER BY `id` DESC LIMIT 1;

$sqlNext = 'SELECT `id` FROM `table`
            WHERE `id` > '$curId' AND `catId` = '$curCat'
            ORDER BY `id` ASC LIMIT 1;

// execute each query 
```

如果您没有从两个查询中的一个返回结果，则意味着您位于该类别的第一个或最后一个项目上，因此在这种情况下没有上一个/下一个按钮。

希望有帮助。

# django - Django：测试对象是否在集合中的最简单方法是什么

> ID：11694288
> 
> 赞同：1
> 
> 时间：2012-07-27T19:16:18.910
> 
> 标签：django

只是一个非关键问题在试图在文档中找到答案无济于事后困扰了我。

```
class Book(models.Model)
    authors = ManyToManyField(Author)

homer = Author.objects.get(pk=1)
iliad = Book.objects.get(pk=2)

iliad.authors.filter(pk=homer.pk).exists()
Book.objects.filter(name='Iliad', authors__in=homer).exists() 
```

我相信最后两个断言将测试荷马是否是《伊利亚特》的作者。但我有点不喜欢 (pk=homer.pk) 部分，我想知道是否有任何构造可以让我测试一个对象（假设我们已经从“get”中获得它）是否存在于查询集中？

```
(homer in iliad.authors) 
```

虽然上面的表达式也可以工作，并且可以说更pythonic，但它可能会从数据库中检索到不必要的太多作者。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T19:31:18.737

在这种特殊情况下`homer in iliad.authors`，只会比`exists`版本稍慢。大多数书籍都有一两个作者，因此从 DB 获取所有内容应该不是问题。

我认为如果不按照您使用的方式使用过滤器，那么在 Django 中无法更快地做到这一点，抱歉。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T19:34:43.597

[Django 的查询集代码](https://github.com/django/django/blob/master/django/db/models/query.py#L138)在使用操作符时实现了一些优化`in`。

为了获得更好的洞察力，我会尝试在查询集`in`上与您的其他示例对大数据集和小数据集的使用进行计时。

# android - 根据先前的微调器选择设置微调器选择

> ID：11694289
> 
> 赞同：0
> 
> 时间：2012-07-27T19:16:21.123
> 
> 标签：android, spinner, android-spinner

我确信这很简单，我只是忽略或做一些愚蠢的事情，但我将许多输入保存到数据库中，其中一个是微调器中选择的选项，并将其存储为文本使用：

```
idCategory = (add_category_spinner.getSelectedItemPosition() + " Position"); 
```

现在，在另一个活动中，我正在尝试将另一个微调器设置为完全相同的选择。我正在使用：

```
private String CategoryPosition

onCreate(...etc)

update_category_spinner = (Spinner) findViewById(R.id.update_category_spinner);
    ArrayAdapter<CharSequence> category_adapter = ArrayAdapter.createFromResource(
            this, R.array.category_array, android.R.layout.simple_spinner_item);

    category_adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
    update_category_spinner.setAdapter(category_adapter);

bundleduCategPos = takeBundledData.getString("clickeduCategPos");

CategoryPosition = String.valueOf(bundleduCategPos.charAt(0));
update_category_spinner.setSelection(Integer.parseInt(CategoryPosition)); 
```

现在，当我尝试打开该特定活动时，我收到以下 logcat 错误：

```
java.lang.NumberFormatException: Invalid int: "N" 
```

根据保存到我的数据库中的微调器选择，“invalid int”字母可能会改变。本质上，整个数据库被保存为字符串集，因此附加文本

```
".getSelectedItemPosition() + " Position");" 
```

我将其拉入，转换为 char，找到第一个零索引字符，它应该是微调器选择的 positionId，并将其转换回 int，最后使用该 int 将选择设置在新微调器上从同一个数组中读取。

请提供一些愚蠢的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-28T03:34:56.257

好的，我已经解决了...找到了 2 个不同的问题。问题 1 - 当我输入字符串而不先转换为 int 时，没有进行选择。我意识到实际上正在做出选择，但我没有看到它，因为我使用

```
update_category_spinner.setSelection(Integer.parseInt(CategoryPosition)); 
```

代替

```
update_category_spinner.setSelection(Integer.parseInt(CategoryPosition), true); 
```

下一个问题，发生 NumberFormatException 因为我有 3 个微调器并且正在保存 3 组

```
getSelectedItemId(); 
```

到我的数据库，然后给他们回电话。我不小心从错误的列中调用了其中一个 ID，所以

```
CategoryPosition = String.valueOf(bundleduCategPos.charAt(0)); 
```

从字符串数组中返回所选字符串的第一个字符，在上面的示例中为“N”。

# android - 按钮 setPressed() onClick

> ID：11694290
> 
> 赞同：0
> 
> 时间：2012-07-27T19:16:26.300
> 
> 标签：android

这是一个简单的问题，

在我的 xml 文件中，我有：

```
<Button
android:id="@+id/button_8"
android:layout_width="0dp"
android:layout_height="wrap_content"
android:text="@string/Bf"
android:background="@drawable/button_purple" 
android:layout_weight="1"
android:textColor="#ffffff"
android:onClick="action"            
/> 
```

在我的活动中，我有：

```
public void action (View v)
{
    s = "m";
    changeCouleur("blue");
    v.setPressed(true);
} 
```

当我按下按钮时，它正在工作，但按钮没有保持按下状态。

我不使用图像，这是我用于颜色的图像：

```
<selector xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:state_pressed="true" >
        <shape>
            <solid
                android:color="#449def" />
            <stroke
                android:width="1dp"
                android:color="#2f6699" />
            <corners
                android:radius="3dp" />
            <padding
                android:left="10dp"
                android:top="10dp"
                android:right="10dp"
                android:bottom="10dp" />
        </shape>
    </item>
    <item android:state_focused="true" >
        <shape>
            <solid
                android:color="#449def" />
            <stroke
                android:width="1dp"
                android:color="#2f6699" />
            <corners
                android:radius="3dp" />
            <padding
                android:left="10dp"
                android:top="10dp"
                android:right="10dp"
                android:bottom="10dp" />
        </shape>
    </item>
    <item>
        <shape>
            <gradient
                android:startColor="#449def"
                android:endColor="#2f6699"
                android:angle="270" />
            <stroke
                android:width="1dp"
                android:color="#2f6699" />
            <corners
                android:radius="4dp" />
            <padding
                android:left="10dp"
                android:top="10dp"
                android:right="10dp"
                android:bottom="10dp" />
        </shape>
    </item>
</selector> 
```

如果您发现有问题，请提前致谢。请问有人知道吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T19:28:42.483

据我了解，您正在尝试使用按钮来关闭/打开状态，按钮的状态也将清楚地指示功能的状态。

如果我是正确的，那么使用自定义复选框。无论如何，您都必须为复选框的不同状态定义选择器（如 user1071979 所述）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T19:20:47.823

你必须使用两个图像来做到这一点。

button_normal button_pressed 然后在drawable文件夹中创建一个xml资源

```
<?xml version="1.0" encoding="UTF-8"?>

<selector xmlns:android="http://schemas.android.com/apk/res/android">

<item android:state_pressed="false"
    android:drawable="@drawable/button_normal" />

<item android:state_pressed="true"
    android:drawable="@drawable/button_pressed" />

</selector> 
```

然后，将此文件设置为 imageview 的背景。这里我们使用 imageview 作为按钮。不要忘记在可绘制文件夹中包含这两个按钮。

# javascript - 部分视图中的 Javascript 函数无法访问页面中定义的 Javascript 变量（MVC 3）

> ID：11694292
> 
> 赞同：3
> 
> 时间：2012-07-27T19:16:37.297
> 
> 标签：javascript, knockout.js

我正在尝试学习使用 Knockoutjs，但我遇到了问题

这是场景：

我有一个页面，我在其中定义了一个 Knockoutjs viewModel，如下所示

```
$(document).ready(function () {
    var viewModel = {
        selectedColumns: ko.observableArray()
    };
    ko.applyBindings(viewModel);
}); 
```

现在有了一个 Ajax 请求，我在页面中添加了一个我想绑定到 viewModel 的复选框

```
<input type='checkbox' id='someId' data-bind='attr: { value: 'someValue' }, checked: $root.selectedColumns'>

 $(document).ready(function() {
                 ko.applyBindings(viewModel, document.getElementById(someId));
            }); 
```

但我总是得到

错误：ReferenceError：未定义 viewModel 源文件：[http ://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js](http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js)

我创建了一个测试页面，所有内容都在一个页面上并且可以正常工作

```
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Home Page</title>
    <script type='text/javascript' src='http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js'></script>
    <script src="../../Scripts/knockout-2.1.0.debug.js" type="text/javascript"></script>
    <script type="text/javascript">
        var count = 0;
        var viewModel = {
            selectedPeople: ko.observableArray()
        };

        $(document).ready(function () {
            ko.applyBindings(viewModel);
        });

        function AddAnotherCheckbox(){

            var id = "checkbox" + count;

            var checknox = count + "   <input type='checkbox' id='" + id + "' data-bind='attr: { value: \"" + count + "\" }, checked: $root.selectedPeople'><br/>";

            $("#container").append(checknox);
            count++;

             $(document).ready(function() {
                 ko.applyBindings(viewModel, document.getElementById(id));
            });
        }
    </script>
</head>
    <body>

        <input type="button" onclick="AddAnotherCheckbox()"/>

        <div id="container"></div>
        <br/>
        <br/>
        <br/>
        <span data-bind="text: selectedPeople"></span> 
    </body>
</html> 
```

但我无法使用局部视图使其工作

你能向我解释什么是问题，我该如何解决？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-27T19:25:42.610

### 描述

这不是关于 Knockout，而是关于一般的 JavaScript。您的测试代码有效，因为您已经定义`viewModel`了`$(document).ready`

这是另一个范围。

将这些与 jsFiddles 进行比较

*   [这不起作用](http://jsfiddle.net/YeJLs/2/)（您的方案）

*   [这有效](http://jsfiddle.net/YeJLs/1/)

### 样本

**这不起作用**

```
$(document).ready(function () {
    var viewModel = {
        someThing : "Test"
    };
});

$(document).ready(function () {  
    alert(viewModel.someThing);
}); 
```

**这将起作用**

```
var viewModel;
$(document).ready(function () {
    viewModel = {
        someThing : "Test"
    };
});

$(document).ready(function () {   
    alert(viewModel.someThing);
}); 
```

### 更多信息

*   [解释 JavaScript 作用域和闭包](http://robertnyman.com/2008/10/09/explaining-javascript-scope-and-closures/)

​</p>

# facebook-graph-api - 无法使长寿令牌正常工作

> ID：11694293
> 
> 赞同：0
> 
> 时间：2012-07-27T19:16:40.227
> 
> 标签：facebook-graph-api, access-token, facebook-access-token

我删除了offline_access 权限，撤销了offline_access 权限，并将我的应用设置为本机。现在我没有得到 2 hs 令牌，而是得到了 24 hs 令牌，但应该给出 60 天令牌，有人知道这里发生了什么吗？

已经尝试过：

[https://graph.facebook.com/oauth/access_token?client_id=](https://graph.facebook.com/oauth/access_token?client_id=) $APP_ID&client_secret=$APP_SECRET&grant_type=fb_exchange_token&fb_exchange_token=$TOKEN

并且仍然获得 24 小时令牌

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T19:40:51.067

[Facebook 60 天访问令牌和已弃用的 Offline_Access](https://stackoverflow.com/questions/9329564/facebook-60-day-access-token-and-deprecated-offline-access)

根据这篇文章，（弃用）离线访问设置必须打开。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T00:38:44.583

似乎在新策略之前创建的应用程序将使用长寿命令牌，直到最终推出，在他们宣布新令牌策略之后创建的任何新应用程序都将在预期时间到期

# haskell - MonadBaseControl 有什么用？

> ID：11694299
> 
> 赞同：27
> 
> 时间：2012-07-27T19:17:21.223
> 
> 标签：haskell, monads

我正在深入研究 Yesod 的单子，并且遇到了`MonadBaseControl`. 我看了一下hackage doc，然后迷路了。有人可以告诉我它试图解决的问题吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-08-11T07:18:52.130

Michael Snoyman 实际上写了一个关于 monad-control 的小教程：[http ://www.yesodweb.com/book/monad-control](http://www.yesodweb.com/book/monad-control)

那篇文章的要点可能如下：

想象一下你有这段代码：

```
withMyFile :: (Handle -> IO a) -> IO a
withMyFile = withFile "test.txt" WriteMode 
```

您可以应用于`withMyFile`该类型的任何函数`Handle -> IO a`并获得一个不错的`IO a`值。但是，如果你有一个 type 的函数`Handle -> ErrorT MyError IO a`并且想要获取 type 的值`ErrorT MyError IO a`怎么办？好吧，基本上，您必须进行修改`withMyFile`才能合并很多包装/展开。MonadBaseControl 允许您像`withMyFile`某些允许展开（“运行”）的 monad 转换器一样“提升”功能。因此，生成的代码如下所示：

```
useMyFileError :: (Handle -> ErrorT MyError IO ()) -> ErrorT MyError IO ()
useMyFileError func = control $ \run -> withMyFile $ run . func 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-07-28T03:19:49.433

它来自包[monad-control](http://hackage.haskell.org/package/monad-control)，并且是一对类型类之一（另一个是[MonadTransControl](http://hackage.haskell.org/packages/archive/monad-control/latest/doc/html/Control-Monad-Trans-Control.html#t%3aMonadTransControl) ），它们通过支持实现它的 monad的替代（resp. ）操作来增强[MonadBase](http://hackage.haskell.org/packages/archive/transformers-base/latest/doc/html/Control-Monad-Base.html#t%3aMonadBase%20%22transformers-base%3aControl.Monad.Base%3aMonadBase)（resp. [MonadTrans ）。](http://hackage.haskell.org/packages/archive/transformers/latest/doc/html/Control-Monad-Trans-Class.html#t%3aMonadTrans)这个增强版本不再在绝对基 monad（resp.immediate base monad）中采取简单的动作，而是采用一个函数，该函数*在该点获取基本 monad（resp.monad 转换器）的整个状态*作为其唯一参数并返回上述动作。`liftBase``lift`

 *正如包文档所述，此增强功能以​​及这些类型类的其余内容允许您从绝对基 monad（即直接基 monad）中提升函数，如`catch`,`alloca`和`forkIO`方案存在于[MonadBase](http://hackage.haskell.org/packages/archive/transformers-base/latest/doc/html/Control-Monad-Base.html#t%3aMonadBase%20%22transformers-base%3aControl.Monad.Base%3aMonadBase) (resp. [MonadTrans](http://hackage.haskell.org/packages/archive/transformers/latest/doc/html/Control-Monad-Trans-Class.html#t%3aMonadTrans) )，因为后者不允许你提升函数的*参数*，只是*results*，而[monad-control](http://hackage.haskell.org/package/monad-control)采用的方法允许两者。

因此，可以与 MonadBaseControl (resp. MonadTransControl ) 一起使用的 monads (resp. monad transformers)集合是可以与[MonadBase](http://hackage.haskell.org/packages/archive/monad-control/latest/doc/html/Control-Monad-Trans-Control.html#t%3aMonadBaseControl) (resp. [MonadTrans](http://hackage.haskell.org/packages/archive/monad-control/latest/doc/html/Control-Monad-Trans-Control.html#t%3aMonadTransControl) )一起使用的 monads 集合的[严格子](http://hackage.haskell.org/packages/archive/transformers-base/latest/doc/html/Control-Monad-Base.html#t%3aMonadBase%20%22transformers-base%3aControl.Monad.Base%3aMonadBase)[集](http://hackage.haskell.org/packages/archive/transformers/latest/doc/html/Control-Monad-Trans-Class.html#t%3aMonadTrans)，但是前一组出于同样的原因，它们比后者强大得多。*

# scala - 在 Traversable 上创建反向集合

> ID：11694304
> 
> 赞同：0
> 
> 时间：2012-07-27T19:17:31.857
> 
> 标签：scala, covariance

我只想反转这个集合中的项目，所以我决定要求它是它的一部分`Traversable`，以及它的任何子类型，并让它返回一个 Traversable，但我认为我可能还需要使用一个方差，但是，目前我在使用 Scala 2.10.0-M5 时遇到编译器错误。

```
trait Polynomials {
    def coefficients[+A <: Traversable[T]](x:A):Traversable[A] =  x.foldLeft(Traversable[A]())((b,a) => a :: b)

} 
```

这些是我遇到的错误，我不确定我做错了什么。

```
Description Resource    Path    Location    Type
']' expected but identifier found.  Polynomials.scala   line 4  Scala Problem
'=' expected but ']' found. Polynomials.scala   line 4  Scala Problem
illegal start of simple expression  Polynomials.scala   line 5  Scala Problem 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-27T19:29:38.083

Scala 没有[use-site variance](https://stackoverflow.com/q/4231305/247533)，因此`+A`不允许在方法中使用，只能在类中使用。无论如何，这真的没有意义。我想你不会错过的。此外，您需要在`T`某个地方，无论是在特征上还是在方法上。并`::`没有在可遍历上定义，但 a`List`是可遍历的，因此您可以使用一个。而且您实际上返回的是 a `Traversable[T]`，而不是 a `Traversable[A]`。所以：

```
trait Polynomials {
  def coefficients[T, A <: Traversable[T]](x: A): Traversable[T] = 
    x.foldLeft(List[T]())((b,a) => a :: b)
} 
```

但这`A <: Traversable[T]`并没有真正给你买任何东西，因为无论如何子类型都会让你这样做。所以更短更简单的是

```
trait Polynomials {
  def coefficients[T](x: Traversable[T]): Traversable[T] = 
    x.foldLeft(List[T]())((b,a) => a :: b)
} 
```

# c# - 无法计算表达式，因为当前线程处于堆栈溢出状态

> ID：11694309
> 
> 赞同：2
> 
> 时间：2012-07-27T19:18:10.757
> 
> 标签：c#, wpf, xaml

在我学习的过程中……我创建了一个简单的数据绑定项目，可以很好地处理数据，例如 firstName。但是，当我尝试使用 lastName 编译器时会抛出运行时错误

** 无法计算表达式，因为当前线程处于堆栈溢出状态。**

这是代码。如您所见，第二个字段（姓氏）被注释掉，因为它导致堆栈溢出。任何评论表示赞赏。

```
public partial class MainWindow : Window
{
    Person p;

    public MainWindow()
    {
        InitializeComponent();

        p = new Person();
        p.PropertyChanged += new System.ComponentModel.PropertyChangedEventHandler(p_PropertyChanged);

        this.DataContext = p;

        p.FirstName = p.OriginalFirstName;
        p.LastName = p.OriginalLastName;
    }

    void p_PropertyChanged(object sender, System.ComponentModel.PropertyChangedEventArgs e)
    {
        stat1.Text = (p.OriginalFirstName == p.FirstName) ? "Original" : "Modified";
        //stat2.Text = (p.OriginalLastName == p.LastName) ? "Original" : "Modifined";
    }

} 
```

编辑：

```
 class Person : INotifyPropertyChanged 
    {

        public string OriginalFirstName = "Jim";
        public string OriginalLastName = "Smith";

        private string _firstName;

        #region FirstName
        public string FirstName
        {
            get { return _firstName; }
            set
            {
                if (value != null)
                {
                    _firstName = value;
                    NotifyTheOtherGuy(FirstName);
                }
            }
        }
        #endregion FirstName

        private string _lastName;

        #region LastName
        public string LastName
        {
            get { return _lastName; }
            set
            {
                if (value != null)
                {
                    _lastName = value;
                    NotifyTheOtherGuy(LastName);
                }
            }
        }
        #endregion LastName

        public Person()
        {

        }

        public event PropertyChangedEventHandler PropertyChanged;
        void NotifyTheOtherGuy(string msg)
        {
            if (PropertyChanged != null)
            {
                PropertyChanged(this, new PropertyChangedEventArgs(msg));
            }

        }

    } 
```

XAML：

```
<Window x:Class="FullNameDataBinding.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow" Height="350" Width="525">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="100"/>
            <ColumnDefinition Width="100"/>
            <ColumnDefinition Width="100"/>
        </Grid.ColumnDefinitions>

        <Label Grid.Column="0" Grid.Row="0" Content="First Name:"/>
        <Label Grid.Row="1" Content="Last Name:"/>
        <TextBox  Grid.Column="1" Grid.Row="0" Background="Yellow" Margin="5" FontWeight="Bold" Text="{Binding Path=FirstName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
        <TextBlock x:Name="stat1" Grid.Column="2" />
        <TextBox x:Name="stat2" Grid.Column="1" Grid.Row="1" Background="Yellow" Margin="5" FontWeight="Bold" Text="{Binding Path=LastName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
        <TextBlock Grid.Column="2" Grid.Row="1" />
    </Grid>
</Window> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-27T21:42:43.787

我认为这部分 XAML 中的错误：

```
 <TextBox  Grid.Column="1" Grid.Row="0" Background="Yellow" Margin="5" FontWeight="Bold" Text="{Binding Path=FirstName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
    <TextBlock x:Name="stat1" Grid.Column="2" />
    <TextBox x:Name="stat2" Grid.Column="1" Grid.Row="1" Background="Yellow" Margin="5" FontWeight="Bold" Text="{Binding Path=LastName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
    <TextBlock Grid.Column="2" Grid.Row="1" /> 
```

我想你想要最后一个`TextBlock`，`x:Name="stat2"`而不是`TextBox`之前的。

当您更改 时`LastName`，会调用您的 PropertyChanged 事件处理程序，这会更改 的文本值`stat2`。因为`stat2`是使用绑定`TextBox`绑定其值的，这会导致绑定机制将您设置的值发送回视图模型。这会导致另一个 PropertyChanged 事件被触发，这会改变 的值，从而导致另一个 PropertyChanged 事件被触发......这个无休止的循环不会停止，这就是你得到堆栈溢出错误的原因。`LastName``TwoWay``stat2`

你不会得到任何这样的堆栈溢出，`FirstName`因为`stat1`它的属性`TextBlock`没有绑定。`Text`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T19:20:34.487

每次更改属性时，您都会更改一个属性（文本值），该属性会触发另一个属性更改事件，该事件会更改文本属性，该事件会触发 ....

你知道这是怎么回事吗？

您要么需要在更改文本属性时禁用事件触发，要么在属性更改事件处理程序的上下文中不更改它。

由于我们没有您的`Person`类的详细信息，我们不知道它是否已经支持某种机制来禁用事件触发，或者在不触发事件的情况下更改值。如果不存在，您可能需要创建自己的。你如何做到这一点将取决于该类的实现。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-27T19:31:10.713

我想 p_PropertyChanged 方法应该是静态的，并且您的方法的以下更改可以正常工作。

```
static void p_PropertyChanged(object sender, System.ComponentModel.PropertyChangedEventArgs e)
{
    MainWindow w = (MainWindow) sender;
    w.stat1.Text = (w.p.OriginalFirstName == w.p.FirstName) ? "Original" : "Modified";
    //stat2.Text = (p.OriginalLastName == p.LastName) ? "Original" : "Modifined";
} 
```

但如果您发布部分 XAML 代码会更好，因为您可能会以更简洁的方式获得相同的结果。

使用 WPF 时，您几乎应该忘记一些 winform 编程代码实践。我想您应该主要使用 Bindings 和 DependenciesProperty 编写代码。

编辑

1.  正如其他人所说，您可能将 stat1 名称分配给了错误的对象，这开始了引发 StackOverflowException 的无限递归。
2.  在 Person 类中，必须使用属性的名称而不是其值来调用 PropertyChanged。

下面是一个工作示例，它不会因该问题而停止，我还想向您展示 WPF 平台如何允许您将所有主要细化任务从 View 类中拉出，并允许您在 Model 类中移动该阶段[MVVM](http://msdn.microsoft.com/en-us/magazine/dd419663.aspx)范式

在 person 类中添加了 Check 属性：它评估触发异常的原始 propertychanged 方法的条件。如果针对 CheckFirstName 或 CheckLastName 的更改触发更改事件，则每次在类中都会更改 FirstName 或 LastName 属性。通过这种方式，您不需要为此目的处理 View 类中的更改事件，因为该模型类已经完成了条件的评估，并且结果可用并准备好用于绑定对象。

```
public class Person : INotifyPropertyChanged 
{

    public string OriginalFirstName = "Jim";
    public string OriginalLastName = "Smith";

    private string _firstName;

    #region FirstName
    public string FirstName
    {
        get { return _firstName; }
        set
        {
            if (value != null)
            {
                _firstName = value;
                NotifyTheOtherGuy("CheckFirstName");
            }
        }
    }
    #endregion FirstName

    private string _lastName;

    #region LastName
    public string LastName
    {
        get { return _lastName; }
        set
        {
            if (value != null)
            {
                _lastName = value;
                NotifyTheOtherGuy("CheckLastName");
            }
        }
    }
    #endregion LastName

    public string CheckFirstName
    {
        get
        {
            return (FirstName==OriginalFirstName) ? "Original": "Modified";
        }
    }
    public string CheckLastName
    {
        get
        {
            return (LastName==OriginalLastName) ? "Original": "Modified";
        }
    }

    public Person()
    {

    }

    public event PropertyChangedEventHandler PropertyChanged;
    void NotifyTheOtherGuy(string msg)
    {
        if (PropertyChanged != null)
        {
            PropertyChanged(this, new PropertyChangedEventArgs(msg));
        }

    }

} 
```

MainWindow 类：所有细化任务都从该类中删除，并且只有 Person 对象的 DependecyProperty 定义。

```
public partial class MainWindow : Window
{
    public static readonly DependencyProperty MyPersonProperty;
    static MainWindow()
    {
        MyPersonProperty = DependencyProperty.Register("MyPerson", typeof(Person), typeof(MainWindow));
    }
    Person MyPerson
    {
        set
        {
            SetValue(MyPersonProperty,value);
        }
        get
        {
            return GetValue(MyPersonProperty) as Person;
        }
    }
    public MainWindow()
    {
        MyPerson = new Person();

        InitializeComponent();
    }
} 
```

MainWindow XAML：每个组件都以正确的方式绑定到 Person DependencyProperty。TextBoxes 必须更新 Person 属性值，TextBlocks 必须获取 Check 属性的结果，这些属性（如前所述）在 Person 类的其他属性更改后通知其更改。

```
<?xml version="1.0" encoding="utf-8"?>
<Window
    x:Class="TryPrj.MainWindow" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:prj="clr-namespace:TryPrj"
    Title="TryPrj"
    Height="300"
    Width="300"
    x:Name="myWindow">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition
                Height="Auto" />
            <RowDefinition
                Height="Auto" />
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition
                Width="100" />
            <ColumnDefinition
                Width="100" />
            <ColumnDefinition
                Width="100" />
        </Grid.ColumnDefinitions>
        <Label
            Grid.Column="0"
            Grid.Row="0"
            Content="First Name:" />
        <Label
            Grid.Row="1"
            Content="Last Name:" />
        <TextBox
            Grid.Column="1"
            Grid.Row="0"
            Background="Yellow"
            Margin="5"
            FontWeight="Bold"
            Text="{Binding Path=MyPerson.FirstName, Mode=OneWayToSource, ElementName=myWindow, UpdateSourceTrigger=PropertyChanged}" />
        <TextBlock
            Grid.Column="2"
            Text="{Binding Path=MyPerson.CheckFirstName, Mode=OneWay, ElementName=myWindow}"
        />
        <TextBox
            Grid.Column="1"
            Grid.Row="1"
            Background="Yellow"
            Margin="5"
            FontWeight="Bold"
            Text="{Binding Path=MyPerson.LastName, Mode=OneWayToSource, ElementName=myWindow, UpdateSourceTrigger=PropertyChanged}" />
        <TextBlock
            Grid.Column="2"
            Grid.Row="1"
            Text="{Binding Path=MyPerson.CheckLastName, Mode=OneWay, ElementName=myWindow}" />
    </Grid>
</Window> 
```

# c++ - WSAStringToAddress 失败

> ID：11694312
> 
> 赞同：4
> 
> 时间：2012-07-27T19:18:18.180
> 
> 标签：c++, windows, sockets, ipv4

我正在尝试使用以下 C++ 代码从 IPv4 字符串地址填充 sockaddr_in 结构：

```
// WSAStringToAddress
struct sockaddr_in sock;

int addrSize = sizeof( struct sockaddr_in );

memset( &sock, 0, addrSize );

sock.sin_family = AF_INET;

rc = WSAStringToAddress( (LPWSTR) "192.168.0.1", 
                         AF_INET, 
                         NULL, 
                        (LPSOCKADDR) &sock, 
                        &addrSize ); 

if ( rc != 0 )
{
    rc = WSAGetLastError();

    printf( "WSAStringToAddress: error=[%d]\n", rc );
} 
```

它失败，错误代码为 10022，即 WSAEINVAL。在[http://msdn.microsoft.com/en-us/library/windows/desktop/ms742214%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms742214%28v=vs.85%29.aspx)上，它指出当 sockaddr_in 的地址系列未设置为 AF_INET 或AF_INET6，我已经清楚地做到了。

我在 Windows Server 2008 R2 SP1 上运行 Visual C++ 2008 Express Edition，但我没有使用较新的地址转换功能，因为我需要从 Windows XP/Windows Server 2000 开始向后兼容。

有谁知道如何解决这个问题/我的代码有什么问题？感谢您提供的任何解决方案：D

编辑：我发现使用 WSAStringToAddressA 允许使用 ASCII char 而不是 tchar

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-27T19:44:24.460

`WSAStringToAddress()``WSAEINVAL`当它无法翻译请求的地址时失败。不匹配的家庭值并不是`WSAEINVAL`发生错误的唯一方式。正如@ChristianStieber 所说，您正在使用类型转换来传递一个 8 位`char[]`字符串文字，其中需要一个 16 位`wchar_t*`指针。那是完全错误的。您正在将垃圾传递给`WSAStringToAddress()`，它正在检测它。

`TEXT()`将字符串文字传递给值时，您需要使用宏`LPTSTR`，例如：

```
rc = WSAStringToAddress( TEXT("192.168.0.1"), ... ); 
```

否则，`WSAStringToAddress()`直接调用 Unicode 版本，并`L`在字符串字面量前加上前缀，使其变为 a`wchar_t[]`而不是 a `char[]`，例如：

```
rc = WSAStringToAddressW( L"192.168.0.1", ... ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T19:34:03.473

我在网上看到的例子将 addrSize 设置为 sizeof(struct sockaddr_storage)。

[这个链接](http://www.winsocketdotnetworkprogramming.com/winsock2programming/winsock2advancedInternet3b.html)有一个例子。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-27T19:34:46.210

在我看来，此评论并没有说这是此错误的唯一可能原因。

特别是，这条线让我印象深刻：

```
(LPWSTR) "192.168.0.1", 
```

您正在获取一个 8 位字符串并将其转换为宽版本。您是否尝试使用 L"192...."？

# visual-studio-2010 - VS2010 开发服务器的 Axis2 HTTP 400 错误

> ID：11694315
> 
> 赞同：0
> 
> 时间：2012-07-27T19:18:37.997
> 
> 标签：visual-studio-2010, web-services, http, axis2

我有一个简单的问题，目前无法重新创建，我需要在下周一解决。

在开发环境中，我们有一个运行在VS2010 提供的ASP.NET 测试服务器上的.NET4 服务和一个运行Axis2 的Java 客户端。我们发现所有请求都失败了。使用 Wireshark，我们`400 Bad request`在每个请求中都发现了一个错误。

我们发现来自 Java 客户端的每个请求都需要`transfer-encoding: chunked`. 其余的似乎很好。在标头和几个字节之后，服务器会抛出 400 错误。

问题是：

### .NET 测试服务器是否支持分块传输？

### 我怎么能告诉 Axis2 使用纯 HTTP 甚至不保持活动状态只是为了确定？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-29T10:34:51.010

## 答案 1

不，它没有。禁用分块编码使一切正常！

## 答案 2

[http://wso2.org/library/209](http://wso2.org/library/209)提供了有关如何禁用分块传输的信息（代码中有错误）

```
FooStub stub = new FooStub(); 
stub._getServiceClient().getOptions().setProperty(org.apache.axis2.transport.http.HTTPConstants.CHUNKED, Boolean.FALSE); 
```

# javascript - 如何使用 jquery 小部件在单击时删除 LI 标记？

> ID：11694319
> 
> 赞同：0
> 
> 时间：2012-07-27T19:18:49.447
> 
> 标签：javascript, jquery, html, css, jquery-ui

我正在使用 jquery 来实现一个可拖动的 LI 对象。我希望能够在用户单击删除时删除图像。下面是代码：

```
<li class="ui-widget-content ui-corner-tr" id="1">
    <h5 class="ui-widget-header">Click for details</h5>
    <A href="" onclick='return onShowTask("Sample Task");'><img src="graphics/task.png" width="96" height="72" /></a>
    <center>Sample Task</center>
    <a href="" onclick='return onShowTask("Sample Task");' title="View details" class="ui-icon ui-icon-zoomin">View Details</a>
    <a href="" class="ui-icon ui-icon-trash">Delete image</a>
</li> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T19:21:29.697

当您单击删除按钮时，这将删除父 li。我相信这就是你的追求。

```
$(".ui-icon-trash").on("click", function(e) {
    e.preventDefault();
    $(this).parent("li").remove();
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T19:22:54.967

尝试：

```
$(".ui-icon-trash").click(function(){
    $(this).closest("li").find("img").remove();
    return false;
}) 
```

# mysql - 创建数据库时的 MySQL/Writing 文件错误 (Errcode 28)

> ID：11694321
> 
> 赞同：1
> 
> 时间：2012-07-27T19:19:03.250
> 
> 标签：mysql, asp.net-mvc-3, entity-framework-4.3

我在执行 sql 文件或通过实体框架代码优先方法创建数据库时出现以下错误

> 写入文件 '.\dbdemo\ads.frm' 时出错（错误代码：28）

在本地数据库服务器上它工作正常并通过 EF Code First Approach 创建数据库，但在我的网站托管服务器上面临这个问题。我通过执行 sql 文件和创建数据库 EF Code First Approach 都尝试了这两种技术都失败了。

知道如何解决这个错误！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T19:38:09.243

使用[`perror`命令](http://dev.mysql.com/doc/refman/5.0/en/perror.html)：

```
$ perror 28
OS error code  28:  No space left on device 
```

除非您的系统上的错误代码不同，否则您的文件系统已满。

请参阅[MySQL 文档](http://dev.mysql.com/doc/refman/5.0/en/cannot-create.html)。

该[博客](http://www.mysqlperformanceblog.com/2012/03/26/how-to-diagnose-errors-in-the-mysql-error-log/)解释了该错误。这[也是](http://forum.percona.com/index.php?t=rview&goto=8133&th=2160)。

> MySQL 使用 MyISAM 存储引擎创建了一个临时表，当磁盘满时，MyISAM 出现错误。

所以尝试清除临时文件夹。

# vb.net - 带有 Handler 的动态标签

> ID：11694323
> 
> 赞同：0
> 
> 时间：2012-07-27T19:19:09.267
> 
> 标签：vb.net, winforms, event-handling, tags, addhandler

我有动态添加到表单上的标签，每个标签在其标签下都有一个链接。我也有`AddHandler lbTitle.Click`动态标签，但是当我尝试这样做时，它不起作用：

```
Private Sub lbTitle_Click(ByVal sender As Object, ByVal e As EventArgs)
    Process.Start(e.Tag)
End Sub 
```

因为

> “标签”不是“System.EventArgs”的成员

我该如何解决这个问题，以便当有人点击动态添加的标签时，它会从标签的标签中启动 url。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T19:24:20.210

要添加事件处理程序，您需要[`AddressOf`Operator](http://msdn.microsoft.com/en-us/library/y72ewk2b.aspx)

```
AddHandler lbTitle.Click, AddressOf lbTitle_Click 
```

要`Label`在事件处理程序中获取对您的引用，您可以使用以下`sender`参数：

```
Private Sub lbTitle_Click(ByVal sender As Object, ByVal e As EventArgs)
    Dim label = DirectCast(sender, Label)
    Process.Start(label.Tag.ToString())
End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T19:25:14.517

sender 参数是标签，但您需要先将其转换为`Label`类型，然后才能访问其`Tag`属性。

```
Process.Start(CType(sender, Label).Tag) 
```

或者，要处理任何类型的控件，您可以将其转换为基本 Control 类型，而不是：

```
Process.Start(CType(sender, Control).Tag) 
```

# matlab - matlab中的特殊添加

> ID：11694324
> 
> 赞同：0
> 
> 时间：2012-07-27T19:19:28.533
> 
> 标签：matlab, vectorization, addition

> **可能重复：**
> [如何将行向量添加到列向量，如矩阵乘法](https://stackoverflow.com/questions/11690743/how-to-add-a-row-vector-to-a-column-vector-like-matrix-multiplication)

我有一个`nx1`向量和一个`1xn`向量。我想以一种特殊的方式添加它们，比如以一种有效的方式（向量化）进行矩阵乘法：

例子：

```
A=[1 2 3]'

B=[4 5 6]

A \odd_add B = 
[1+4 1+5 1+6
 2+4 2+5 2+6
 3+4 3+5 3+6
] 
```

我`bsxfun`在MATLAB中使用过，但我认为它很慢。请帮我...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-29T19:02:03.783

我对这里提到的不同方法进行了比较。我正在使用[TIMEIT](http://www.mathworks.com/matlabcentral/fileexchange/18798-timeit-benchmarking-function)函数来获得可靠的估计（负责预热代码、多次运行的平均时间......）：

```
function testBSXFUN(N)
    %# data
    if nargin < 1
        N = 500;        %# N = 10, 100, 1000, 10000
    end
    A = (1:N)';
    B = (1:N);

    %# functions
    f1 = @() funcRepmat(A,B);
    f2 = @() funcTonyTrick(A,B);
    f3 = @() funcBsxfun(A,B);

    %# timeit
    t(1) = timeit( f1 );
    t(2) = timeit( f2 );
    t(3) = timeit( f3 );

    %# time results
    fprintf('N = %d\n', N);
    fprintf('REPMAT: %f, TONY_TRICK: %f, BSXFUN: %f\n', t);

    %# validation
    v{1} = f1();
    v{2} = f2();
    v{3} = f3();
    assert( isequal(v{:}) )
end 
```

在哪里

```
function C = funcRepmat(A,B)
    N = numel(A);
    C = repmat(A,1,N) + repmat(B,N,1);
end

function C = funcTonyTrick(A,B)
    N = numel(A);
    C = A(:,ones(N,1)) + B(ones(N,1),:);
end

function C = funcBsxfun(A,B)
    C = bsxfun(@plus, A, B);
end 
```

时间安排：

```
>> for N=[10 100 1000 5000], testBSXFUN(N); end
N = 10
REPMAT: 0.000065, TONY_TRICK: 0.000013, BSXFUN: 0.000031
N = 100
REPMAT: 0.000120, TONY_TRICK: 0.000065, BSXFUN: 0.000085
N = 1000
REPMAT: 0.032988, TONY_TRICK: 0.032947, BSXFUN: 0.010185
N = 5000
REPMAT: 0.810218, TONY_TRICK: 0.824297, BSXFUN: 0.258774 
```

BSXFUN 显然是赢家。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-27T20:51:13.437

正如@b3 所述。这将是一个合适的地方使用`repmat`。但是总的来说，特别是如果您正在处理非常大的矩阵，`bsxfun`通常是更好的替代品。在这种情况下：

```
>> bsxfun(@plus, [1,2,3]', [4,5,6]) 
```

返回相同的结果，使用大矩阵限制中大约三分之一的内存。

`bsxfun`基本上将第一个参数中的函数应用于第二个和第三个参数中的每个项目组合，根据输入向量的形状将结果放置在矩阵中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-27T22:48:38.737

在 matlab 矢量化中，与任何其他内置的 Matlab 函数`Tony's Trick`相比，在速度方面没有替代品。`repmat`我确信以下代码对于您的目的必须是最快的。

```
>> A = [1 2 3]';
>> B = [4 5 6];
>> AB_sum = A(:,ones(3,1)) + B(ones(3,1),:); 
```

`A`对于较大的和，速度差异将更加明显（至少一个数量级）`B`。请参阅我前段时间进行的此[测试](https://stackoverflow.com/a/10327626/842808)`Tony's Trick`，以确定over`repmat`在时间消耗方面的优势。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-27T19:28:23.193

[REPMAT](http://www.mathworks.com/help/techdoc/ref/repmat.html)是你的朋友：

```
>> A = [1 2 3]';
>> B = [4 5 6];
>> AplusB = repmat(A, 1, 3) + repmat(B, 3, 1)

加 B =

     5 6 7
     6 7 8
     7 8 9

```

# sql - 具有多个 Where 语句的多个模型范围

> ID：11694325
> 
> 赞同：0
> 
> 时间：2012-07-27T19:19:34.370
> 
> 标签：sql, ruby-on-rails

我有一个处理网站的应用程序。有一个名为“sites”的模型，它有_many 个页面。站点模型有一个称为主页的列。每个站点的页面列表包含主页和附加页面（关于、定价等）。

在这篇文章： [基于多个模型创建范围](https://stackoverflow.com/questions/11693310/creating-scopes-based-on-multiple-models/11693380#11693380)，我能够弄清楚如何确定页面模型的范围，以便我可以将主页与其他页面分开。但我需要进一步修改范围，因为我注意到在附加页面中，出现了 robots.txt 文件。我想排除那些，但我不确定如何。我附加了这个：

```
.where("'robots.txt' <> pages.url[-10,10]") 
```

但没有运气。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T19:30:09.297

你可以使用这个：`.where("pages.url NOT LIKE '%robots.txt'")`

# boost-python - 使用 Boost.Python 和 macports Python.framework 的编译器错误

> ID：11694326
> 
> 赞同：3
> 
> 时间：2012-07-27T19:19:37.557
> 
> 标签：boost-python, xcode4.4

这可能是一个非常愚蠢的问题......

我正在尝试在 Xcode 项目中使用 Boost.Python（boost 1.50、xcode 4.4、OS X 10.8）。我通过macports安装了boost和python。我将 macports Python 框架（/opt/local/Library/Frameworks/Python.framework）拖到项目中，并尝试了尽可能最小的程序：

```
#include <boost/python.hpp>
int main(int argc, const char * argv[]) {
    Py_Initialize();
    Py_Finalize();
    return 0;
} 
```

并得到：

```
/opt/local/include/boost/python/detail/wrap_python.hpp:50:11: fatal error: 'pyconfig.h' file not found 
```

我是否需要将框架头文件夹显式添加到项目的头搜索路径中？这似乎不规则......所以希望我只是误解了什么？

# github - OS X Mountain Lion 更新后的 Git 克隆错误

> ID：11694329
> 
> 赞同：23
> 
> 时间：2012-07-27T19:19:47.497
> 
> 标签：github, osx-mountain-lion, brunch

我刚刚将我的 MBP 更新到 OSX 10.8，并尝试使用 brunch.io 启动一个新项目，默认情况下使用的是 coffeescript，我更喜欢 javascript，所以我需要克隆简单的 js 框架。所以是这样的：

```
brunch new <someprojectname> --skeleton https://github.com/brunch/simple-js-skeleton.git 
```

这是我以前使用过的，效果很好。但是今天我收到以下错误：

```
error: Git clone error: /bin/sh: git: command not found 
```

我真的不知道如何解决这个问题......

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-07-27T22:00:02.927

您可以通过以下任一方式下载 Apple 的官方开发人员命令行实用程序集合（包括 git）：

*   打开 Xcode，转到 Preferences > Downloads 并单击“Command Line Utilities”旁边的安装按钮
*   前往[developer.apple.com/downloads](https://developer.apple.com/downloads)并从 Xcode 4.4 类别下载“Xcode 4.4 Command Line Tools for OSX 10.8”

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-27T19:23:10.567

检查您的`.bashrc`或`.bash_profile`是否`PATH`设置了适当的。你是通过 macports 安装 git 的吗？更新可能会从 PATH 中删除`/opt/bin`或删除。`/opt/local/bin`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-27T20:16:29.403

我让一切恢复正常。显然，Mountain Lion 的更新完全放弃了 git。只需从[这里](http://git-scm.com/download/mac)下载安装包并运行它，一切都会再次运行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-07T06:12:51.397

基于[这篇](http://dwainm.wordpress.com/2012/12/19/mountain-lion-git-command-not-found-2-min-fix/)文章：

1.  打开你的 ~/.bash_profile，如果你使用 nano，它将是：$ sudo nano ~/.bash_profile

2.  将此行添加到文件中：export PATH=$PATH:/usr/local/git/bin/

3.  保存并关闭文件并在终端上输入： $ source ~/.bash_profile

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-07T19:39:27.570

您必须更改您的安全设置，转到系统偏好设置 > 安全和隐私 > 更改允许从 --> 任何地方下载的应用程序。在这种情况下，您的安全设置可能会被锁定，请按首选项窗格左下角的锁。

# mysql - AUSU jquery-Ajax 自动提示多个值

> ID：11694341
> 
> 赞同：0
> 
> 时间：2012-07-27T19:20:39.360
> 
> 标签：mysql, autosuggest

我有一个包含以下字段的表格：公司名称、地址、城市

使用 AUSU jquery autosuggest 脚本，我可以根据在公司字段中完成的搜索来填充地址字段，但我似乎无法完成的是用适当的值填充城市字段。所有数据都存储在 mysql 数据库中。

我已经能够让地址和城市填充地址字段，但我需要这两个值进入它们各自的字段（shiptoaddress 和 shiptocity）。

有什么建议么？

这是我的 php 从 mysql 数据库中获取数据：

```
 <?php 

    $con    =   mysql_connect("localhost","userid","password");
    if (!$con){ die('Could not connect: ' . mysql_error()); }
    mysql_select_db("dbase", $con);

    $id     =   @$_POST['id'];          // The id of the input that submitted the request.
    $data   =   @$_POST['data'];        // The value of the textbox.

 if ($id && $data)
{
    if ($id=='clients')
    {
        $query  = "SELECT shiptoaddress,company, shiptocity
                  FROM Clients
                  WHERE company LIKE '%$data%'
                  LIMIT 5";

        $result = mysql_query($query);

        $dataList = array();

        while ($row = mysql_fetch_array($result))
        {
            $toReturn   = $row['company'];
            $dataList[] = '<li id="' .$row['shiptoaddress'] .$row['shiptocity'] . '"><a href="#">' . htmlentities($toReturn) . '</a></li>';

        }

        if (count($dataList)>=1)
        {
            $dataOutput = join("\r\n", $dataList);
            echo $dataOutput;
        }
        else
        {
            echo '<li><a href="#">No Results</a></li>';
        }
    }
}
?> 
```

这是 html 表单代码的一部分：

```
<script>
$(document).ready(function() {
    $.fn.autosugguest({  
           className: 'ausu-suggest',
          methodType: 'POST',
            minChars: 2,
              rtnIDs: true,
            dataFile: 'data.php'
    });
});
</script>
</head>
<body>
<div id="wrapper">
  <form action="index.php" method="get">
    <div class="ausu-suggest">
      <input type="text" size="100" value="" name="clients" id="clients" autocomplete="off" />
      <input type="text" size="100" value="" name="shiptoaddress" id="shiptoaddress" autocomplete="off"/>
      <input type="text" size="100" value="" name="shiptocity" id="shiptocity" autocomplete="off"/>

    </div>
  </form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T14:58:50.267

我通过使用 Jquery 自动完成小部件解决了我的问题。

# asp.net-mvc - BindModel 在绑定到列表/集合时返回 null（但在绑定到 csla 集合时不返回）

> ID：11694349
> 
> 赞同：1
> 
> 时间：2012-07-27T19:21:15.477
> 
> 标签：asp.net-mvc, model-binding

我有一个自定义模型绑定器，它继承了看起来像这样的 DefaultModelBinder。

```
Public Class GridFormBinder : Inherits DefaultModelBinder

Public Overrides Function BindModel(controllerContext As System.Web.Mvc.ControllerContext, bindingContext As System.Web.Mvc.ModelBindingContext) As Object
    Dim result As Object = MyBase.BindModel(controllerContext, bindingContext)

    'Code to handle special case for grid/List binding.

    Return result
End Function 
End Class 
```

我有这个自定义活页夹的原因是我在网格中呈现各种项目列表（使用 devexpress mvc gridview）并将网格中的控件绑定到项目列表。

如果我使用派生自 BusinessCollectionBase 的类（来自一个非常修改的 CSLA 框架类），那么一切都完全符合我的要求。BusinessCollectionBase 派生自一个看起来像......

```
 <Serializable()> Public MustInherit Class BindableCollectionBase(Of T As IBusinessData)
        Inherits CollectionBase
        Implements IBindingList
        Implements System.Collections.Generic.IEnumerable(Of T) 
```

但是，如果我绑定到一个继承自`BindingList<Customer>`的类，`MyBase.BindModel(controllerContext, bindingContext)`总是什么都不返回。我尝试了各种通用和非通用 BCL 集合，并且 BindModel 方法总是返回 null。

我需要做些什么来让 DefaultModelBinder 创建并返回常规集合的模型吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-30T19:13:15.150

我查看了 DefaultModelBinder 的来源并找出了问题所在。

在 BindComplexModel 方法的 DefaultModelBinder 中，如果类型不是数组并且是通用 IEnumerable ( IEnumerable<>) 并且它是 ICollection<> 的实例，它将调用 UpdateCollection。由于所述的所有原因，它无法填充集合。因为 count = 0，UpdateCollection 方法返回 null。因此，我从 ICollection 派生的类（例如 BindingList）将具有这种行为。

但是，我的自定义集合实际上源自旧的 CollectionBase 类（并且它单独实现了通用的 IEnumerable）。这意味着 BindComplexModel 不会尝试填充集合，而是像往常一样绑定到对象。*

我个人认为这是一个错误或至少是一个疏忽。如果您绑定到一个集合并且表单有 0 个项目（例如用户已删除所有行），您将不会从默认绑定中得到任何回报。但是你不应该只得到零项目的集合吗？什么都不返回的原因是什么？这给 MVC 开发人员带来了更多的工作，因为现在他们必须先检查什么。

但无论如何，这就是原因。

*And this is also the reason I couldn't get the examples of binding to collections to work with my classes. They are not arrays but neither are they IEnumerable<> or IDictionary<>. Yet another bug I think.

# ruby - 尝试运行 RSPEC 时出错。为什么？

> ID：11694351
> 
> 赞同：0
> 
> 时间：2012-07-27T19:21:21.567
> 
> 标签：ruby, rspec, rspec2

我不知道为什么我的 RSPEC 不起作用。我使用 sudo gem install rspec 重新安装了 RSPEC，然后再次尝试使用特定版本号 ( `sudo gem install rspec -v 2.11.0`)

我继续收到以下错误消息，但我无法弄清楚它的含义。我相信我可能也安装了版本 1，也可能没有安装，不确定。

```
Castillo$ rspec document_spec.rb 
```

> /Users/Castillo/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require': no such file to load -- document (LoadError) from /Users/Castillo/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in` 来自/Users/Castillo/Desktop/document_spec.rb :1:in `<top (required)>' from /Users/Castillo/.rvm/gems/ruby-1.9.2-p290/gems/rspec-core-2.11.1/lib/rspec/core/configuration.rb:780:in`load' 来自 /Users/Castillo/.rvm/gems/ruby-1.9.2-p290/gems/rspec-core-2.11.1/lib/rspec/core/configuration.rb:780:in `block in load_spec_files' from /Users/Castillo/.rvm/gems/ruby-1.9.2-p290/gems/rspec-core-2.11.1/lib/rspec/core/configuration.rb:780:in`map'来自 /Users/Castillo/.rvm/gems/ruby-1.9.2-p290/gems/rspec-core-2.11.1/lib/rspec/core/configuration.rb:780:in `load_spec_files' from /Users/Castillo/.rvm/gems/ruby-1.9.2-p290/gems/rspec-core-2.11.1/lib/rspec/core/command_line.rb:22:in`run' 来自 /Users/Castillo/ .rvm/gems/ruby-1.9.2-p290/gems/rspec-core-2.11.1/lib/rspec/core/runner.rb:69:in `run' from /Users/Castillo/.rvm/gems/ruby-1.9.2-p290/gems/rspec-core-2.11.1/lib/rspec/core/runner.rb:8:in` block in autorun'

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-27T19:37:54.300

将文件的完整路径添加`document.rb`到规范文件中或使用 `require_relative` 或

```
require File.expand_path('../document.rb', __FILE__) 
```

# php - 素数类的构造不能自动工作

> ID：11694356
> 
> 赞同：0
> 
> 时间：2012-07-27T19:21:38.447
> 
> 标签：php, oop

我正在尝试为我的网站构建一个基本框架，为此我需要扩展主类，但主类的构造函数只有在我执行以下操作时才有效 -`parent::__construct()` 这是一个示例：

```
class prime
{
 protected __construct()
 {
   //code
 }
}

class subPrime extends prime
{
  protected __construct()
  {
    //code
  }

} 
```

有人知道解决方案吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-27T19:28:08.223

根据[php manual](http://php.net/manual/en/language.oop5.decon.php) parent contructor 不会自动调用：

> 注意：如果子类定义了构造函数，则不会隐式调用父构造函数。为了运行父构造函数，需要在子构造函数中调用 parent::__construct()。

这是正确的、预期的、期望的和有据可查的行为。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T19:23:44.890

通常，如果您想从子类调用父类的构造函数，您会按照您的建议 (parent::__construct()) 进行操作。或者干脆不覆盖子类中的构造方法。

如果您不需要更改子类中的构造函数行为，则最好不要覆盖父类的方法。

# php - Yii 登录返回 HTTP 404

> ID：11694357
> 
> 赞同：1
> 
> 时间：2012-07-27T19:21:40.303
> 
> 标签：php, mod-rewrite, apache2, yii

我已将我的 Yii 应用程序上传到运行 PHP5 和 Apache2.x 的 Ubuntu 12.04 服务器。.htaccess 文件包含：

```
RewriteEngine on
RewriteBase / 
```

/protected/controllers 中的 UserController.php 包含：

```
 public function actionLogin()
{
    $model= new Users();

    // if it is ajax validation request
    if(isset($_POST['ajax']))
    {
        echo CActiveForm::validate($model);
        Yii::app()->end();
    }
//                print_r($_POST['Users']);
    // collect user input data
    if(isset($_POST['Users']))
    {
        $model->attributes=$_POST['Users'];

        // validate user input and redirect to the previous page if valid
        if($model->login())
            $this->redirect(Yii::app()->user->returnUrl);
    }
    // display the login form
    $this->render('login',array('model'=>$model));
} 
```

当我登录该站点时，我收到一条 HTTP404 消息。apache2 error.log 状态

```
file does not exist /var/www/users 
```

如何纠正这个 404 错误？

更新：
returnURL 似乎没有被重视。如何设置 returnUrl 以便将用户重定向回上一页？

UPDATE2：这是来自 config/main.php 的片段：

```
'urlManager'=>array(
        'urlFormat'=>'path',
        'showScriptName'=>false,
        'rules'=>array(
            '<controller:\w+>/<id:\d+>'=>'<controller>/view',
            '<controller:\w+>/<action:\w+>/<id:\d+>'=>'<controller>/<action>',
            '<controller:\w+>/<action:\w+>'=>'<controller>/<action>',
        ), 
```

这是主 .htacess 文件的内容：

```
RewriteEngine On
RewriteBase /

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^admin/(.*)\?*$ admin.php/$1 [L,QSA]

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)\?*$ index.php/$1 [L,QSA]

php_value upload_max_filesize 20M
php_value post_max_size 21M 
```

更新：看起来根本原因可能与用于身份验证的 UserIdentity 类有关。这是用户模型的片段：

```
public function login()
{

        if($this->_identity===null)
        {
                $this->_identity=new UserIdentity($this->username,md5($this->password));
                $this->_identity->authenticate();
        }
        if($this->_identity->errorCode===UserIdentity::ERROR_NONE)
        {
                $duration=$this->rememberMe ? 3600*24*30 : 60*20; // 30 days
                Yii::app()->user->login($this->_identity,$duration);
                return true;
        }
        else{
                $this->addError('password','Incorrect username or password.');
                return false;
        }
} 
```

是否建议使用 CdbHttpSession 代替 UserIdentity 来完成登录？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-28T13:05:49.183

我认为你的 .htaccess 和 Yii 主要配置有问题。

[http://www.yiiframework.com/doc/guide/1.1/en/topics.url](http://www.yiiframework.com/doc/guide/1.1/en/topics.url)

我想如果你已经正确设置了你的 config/main.php （你可以用那个更新问题，特别是 urlManager 部分），你 .htaccess 需要

```
重写引擎开启

# 如果目录或文件存在，直接使用
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d

# 否则转发到 index.php
重写规则。索引.php

```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-28T13:22:39.810

尝试改变

```
$this->redirect(Yii::app()->user->returnUrl); 
```

到

```
$this->redirect(Yii::app()->user->getReturnUrl(Yii::app()->homeUrl)); 
```

高温高压

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-28T13:51:12.580

您可以使用以下方法显式设置 returnUrl：

`Yii::app()->user->setReturnUrl('controller/action');`

`components/userIdentity.php`你把它放在哪里取决于你，当你验证密码等时，我可能会在课堂上设置它，或者你可以在你的`$model->validate()`方法中设置它。

# c# - 发布到 wcf 时将 xml 版本标记添加到 xml 时数据丢失

> ID：11694362
> 
> 赞同：1
> 
> 时间：2012-07-27T19:22:05.523
> 
> 标签：c#, xml, wcf, serialization

好吧，我真的迷失了这个。我创建了一个 wcf 服务，我将 xml 发布到该服务，这些服务对数据进行了处理。一切都很好，除非我将打开的 xml 标记放在我的 xml 的最顶部。当我在调试模式下查看所有内容时，数据为空。

我在 wcf 中的 C# 代码是这样的：

```
public interface ITest
{
    [OperationContract]
    void DoWork();

    [OperationContract]
    [WebDispatchFormatter]
    [WebInvoke(UriTemplate = "MyTest", Method = "*")]
    void MyTest(PassedIn request);
}

[Serializable]
[DataContract(Namespace = "", Name = "")]
public class PassedIn
{
    public PassedIn() { }

    [DataMember]
    public string firstname {get; set;}
    [DataMember]
    public string lastname {get; set;}
    [DataMember]
    public string email {get; set;}
} 
```

这是不同的xml帖子：

```
<mypost>
    <firstname>test</firstname>
    <lastname>foo</lastname>
    <email>test@bar.com</email>
</mypost> 
```

```
<?xml version="1.0"?>
<mypost>
    <firstname>test</firstname>
    <lastname>foo</lastname>
    <email>test@bar.com</email>
</mypost> 
```

我可以通过将订单添加到数据成员来解决这个问题，当标签在 xml 中时数据不会丢失，如下所示：

```
public class PassedIn
{
    public PassedIn() { }

    [DataMember (order=1)]
    public string firstname {get; set;}
    [DataMember  (order=2)]
    public string lastname {get; set;}
    [DataMember  (order=3)]
    public string email {get; set;}
} 
```

但现在它产生了相反的效果。如果我没有“？xml 版本”标签，则数据将通过 null。

有没有人遇到过这个？真的可以使用一些建议。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T22:29:41.380

我想通了..当使用 DataContractSerializer 时，顺序很重要，但是如果您不指定顺序，默认情况下顺序是按字母顺序排列的，这就是为什么某些数据被设置而其他数据不被设置的原因。

我真的不想让顺序很重要，所以我不得不从 DataContractSerializer 切换到另一个序列化引擎。XmlSerializer。

一些对我有帮助的信息的链接： [WCF 禁用反序列化顺序敏感度](https://stackoverflow.com/questions/1727682/wcf-disable-deserialization-order-sensitivity) [http://msdn.microsoft.com/en-us/library/ms732038.aspx](http://msdn.microsoft.com/en-us/library/ms732038.aspx)

# android - 谷歌如何根据页面浏览量计算移动应用的指标

> ID：11694364
> 
> 赞同：-1
> 
> 时间：2012-07-27T19:22:11.967
> 
> 标签：android, google-analytics

我为我的手机使用谷歌分析，并使用`trackPageView`方法在我的应用程序上注册页面视图。当我在谷歌分析页面中看到时，平均访问持续时间约为 16 分钟或某些地区约为 32 分钟以上。我想了解“平均访问持续时间”、“访问者”、“访问次数”和“访问次数”等指标是如何根据我发送给谷歌分析的 pageViews 计算的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-29T04:42:32.770

每个页面浏览都使用时间戳进行注册。因此 GA 将访问持续时间计算为（记录在最后一页的时间戳 - 记录在第一页的时间戳）。因此，如果访问者序列是：

A -> B -> C -> D

访问时长 = 时间戳(D) - 时间戳(A)

请注意，GA 无法确定在页面 D 本身上花费了多少时间，因为没有参考可用于进行该计算的后续浏览量（以及时间戳）。

所以在现实中：

访问时长 = 在 A 上花费的时间 + 在 B 上花费的时间 + 在 C 上花费的时间

对于其他术语的定义，最好查看 Google Analytics 的有用词汇表：http: [//support.google.com/googleanalytics/bin/answer.py ?hl=en&answer=99118](http://support.google.com/googleanalytics/bin/answer.py?hl=en&answer=99118)

# linux - Linux：如何获取名称以大于 10 的数字结尾的文件

> ID：11694368
> 
> 赞同：4
> 
> 时间：2012-07-27T19:22:24.063
> 
> 标签：linux, bash, filenames, sh

我有一些文件的名称如下： 'abcdefg_y_zz.jpg' 'abcdefg' 是数字序列，而 'y' 和 'zz' 是字母。我需要获取所有以大于 10 的数字结尾的数字序列的文件。“fg”大于 10 的文件。

有没有人知道如何在 bash 脚本中做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T19:45:48.143

好的，从技术上讲，根据您的所有信息...

`ls | grep '[0-9]{5}[1-9][0-9]_[[:alpha:]]_[[:alpha:]]{2}.jpg'`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T19:26:14.963

这个怎么样？只排除在 f 位置为 0 的那些。

```
ls -1 | grep -v "?????0?_?_??.jpg" 
```

**更新** 由于您想要 > 10 而不是 >= 10，因此您也需要排除 10。所以这样做：

```
ls -1 | grep -v "?????0*_?_??.jpg" | grep -v "??????10_?_??.jpg" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-27T19:35:43.133

有更多的脚本

```
#!/bin/bash
for i in seq FIRST INCREMENT LAST
do
cp abcde$i_y_zz.jpg /your_new_dir //or whatever you want to do with those files
done 
```

所以在你的例子中，带有 seq 的行将是

```
for i in seq 11 1 100000000 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-27T19:50:54.680

如果文件名按顺序命名，则此`awk`解决方案有效：

```
ls | awk 'BEGIN { FIELDWIDTHS = "5 2" } $2 > 10' 
```

### 解释

*   `FIELDWIDTHS = "5 2"`表示`$1`将引用前 5 个字符和`$2`接下来的 2 个字符。
*   `$2 > 10`当字段 2 大于 10 并隐式调用默认代码块时匹配，即`'{ print }'`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-27T19:54:04.270

只有一个过程：

```
ls ?????+(1[1-9]|[2-9]?)_?_??.jpg 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-27T21:30:53.580

到目前为止提供的所有解决方案都很好，但是任何对 shell 编程有一定经验的人都知道**解析`ls`永远不是一个好主意，必须避免**。这实际上不适用于这种情况，我们可以假设文件的名称遵循某种模式，但这是一个应该记住的规则。更多解释[在这里](http://mywiki.wooledge.org/ParsingLs)。

使用 GNU 可以更安全地实现您想要的东西`find`- 假设您在文件所在的目录中运行命令，它看起来像这样：

```
find . -regextype posix-egrep -regex '\./[0-9]{5}[1-9][0-9]_[[:alpha:]]_[[:alpha:]]{2}.jpg$' 
```

# c# - 动态 Linq 搜索多种类型的多个列，包括可空类型

> ID：11694373
> 
> 赞同：2
> 
> 时间：2012-07-27T19:22:52.080
> 
> 标签：c#, linq, expression-trees, dynamic-linq

我需要动态选择我的列，并且我不提前知道列的类型。我有一个字符串，如果它们包含该字符串，我想搜索所有列，将非字符串转换为字符串以进行比较。

```
string format = "Convert.ToString({0}).Contains(@0)";
Model.Where(String.Format(format, columnName), searchString); 
```

它在可空类型上中断，但这应该没问题。我可以使用 HasValue 和 Value 然后转换为字符串。为此，我需要使用 typeof 检查类型是否为 Nullable<>。所以我写了一个大的讨厌的字符串来传递给动态 linq，它在`typeof` 我试图写一个表达式树但我没有得到任何地方。有什么办法可以做我想做的事吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T14:04:36.580

看看这篇博文。

[http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx](http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx)

它关于如何使用 LINQ 进行操作，它可以帮助

# php - 将亚马逊 MWS 暂存器查询转换为 API 调用

> ID：11694376
> 
> 赞同：11
> 
> 时间：2012-07-27T19:22:56.467
> 
> 标签：php, xml, api, amazon, amazon-mws

我想知道是否有办法将我的亚马逊 MWS[暂存器](https://mws.amazonservices.co.uk/scratchpad/index.html)查询转换为 API 调用

例如，当使用 MWS 便签本时，我得到了一个要签名的字符串

```
 "mws.amazonservices.co.uk"
   ."/Products/2011-10-01"
   ."AWSAccessKeyId=xxx&Action=ListMatchingProducts"
   ."&MarketplaceId=xxx&Query=star%20wars&SellerId=xxx"
   ."&SignatureMethod=HmacSHA256&SignatureVersion=2
   ."&Timestamp=2012-07-27T18%3A59%3A30Z&Version=2011-10-01 
```

在花了几天时间试图让[亚马逊的订单 API](https://developer.amazonservices.com/gp/mws/api.html/192-8794163-0963027?ie=UTF8&group=orders&section=orders&version=latest)工作后，我放弃了，一直希望下面的函数会返回一个 xml 字符串......但没有运气

```
function callAmazon(){
    $apicall =  "mws.amazonservices.co.uk"
   ."/Products/2011-10-01"
   ."AWSAccessKeyId=xxx&Action=ListMatchingProducts"
   ."&MarketplaceId=xxx&Query=star%20wars&SellerId=xxx"
   ."&SignatureMethod=HmacSHA256&SignatureVersion=2
   ."&Timestamp=2012-07-27T18%3A59%3A30Z&Version=2011-10-01   

    $resp = simplexml_load_file($apicall);   //make the call
} 
```

有没有人有任何可能的建议？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-27T19:37:53.057

我也为此苦苦挣扎了很长时间，以下是我为 Products API 解决的方法：

```
<?php
require_once('.config.inc.php');
$base_url = "https://mws.amazonservices.com/Products/2011-10-01";
$method = "POST";
$host = "mws.amazonservices.com";
$uri = "/Products/2011-10-01";

function amazon_xml($searchTerm) {

    $params = array(
        'AWSAccessKeyId' => AWS_ACCESS_KEY_ID,
        'Action' => "ListMatchingProducts",
        'SellerId' => MERCHANT_ID,
        'SignatureMethod' => "HmacSHA256",
        'SignatureVersion' => "2",
        'Timestamp'=> gmdate("Y-m-d\TH:i:s.\\0\\0\\0\\Z", time()),
        'Version'=> "2011-10-01",
        'MarketplaceId' => MARKETPLACE_ID,
        'Query' => $searchTerm,
        'QueryContextId' => "Books");

    // Sort the URL parameters
    $url_parts = array();
    foreach(array_keys($params) as $key)
        $url_parts[] = $key . "=" . str_replace('%7E', '~', rawurlencode($params[$key]));

    sort($url_parts);

    // Construct the string to sign
    $url_string = implode("&", $url_parts);
    $string_to_sign = "GET\nmws.amazonservices.com\n/Products/2011-10-01\n" . $url_string;

    // Sign the request
    $signature = hash_hmac("sha256", $string_to_sign, AWS_SECRET_ACCESS_KEY, TRUE);

    // Base64 encode the signature and make it URL safe
    $signature = urlencode(base64_encode($signature));

    $url = "https://mws.amazonservices.com/Products/2011-10-01" . '?' . $url_string . "&Signature=" . $signature;
    $ch = curl_init();
    curl_setopt($ch, CURLOPT_URL,$url);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
    curl_setopt($ch, CURLOPT_TIMEOUT, 15);
    curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, 0);
    $response = curl_exec($ch);

    $parsed_xml = simplexml_load_string($response);

    return ($parsed_xml);
}

?> 
```

该`.inc.config.php`文件包含我的访问密钥、密钥等。

编辑：
`$searchterm`是我从我的表格中传递的 isbn。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T19:30:43.100

您需要实际调用 API。您使用的字符串未指定 URL 的 http:// 部分。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T09:11:07.320

我在使用这段代码时遇到了一点问题，当我上传到托管的 Web 服务器时它可以工作，但在使用 windows 和 xampp 运行本地时却没有。

如果您遇到问题，请尝试将其添加到 curl-setopt 块的末尾。

> curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, 0);

顺便说一句，您还需要修改 xampp 文件夹中的 php.ini 文件以启用 curl。

# javascript - 数组比较后由于某种原因 for 循环中断

> ID：11694384
> 
> 赞同：0
> 
> 时间：2012-07-27T19:23:30.250
> 
> 标签：javascript

我有两个数组，我正在比较两个值，然后设置一个 json 对象：

```
var compare = ["hh", "pictures", "videos", "aboutMe", "contactMe", "cat", "location"];
var data = ["pictures", "videos", "aboutMe", "contactMe", "cat", "location"];
    for (var j=0; j<compare.length; j++) {
        if (compare[j] === data[j]) {
            self.MenuItems.menu_item[j].added = "added";
        }else if (compare[j] !== data[j]){
            self.MenuItems.menu_item[j].added = "";
        }
    } 
```

出于某种原因，对于 all `self.MenuItems.menu_item[j]`，它们都等于 "add" 或 "";...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T19:28:22.403

只是让您知道这种情况不是很有效，这里应该如何

```
if (compare[j] === data[j]) {
    self.MenuItems.menu_item[j].added = "added";
}else {
    self.MenuItems.menu_item[j].added = "";
} 
```

并且代码执行预期的操作。除非你有别的想法。

# javascript - CakePHP 省略发送输入字段并在提交时更改输入值？

> ID：11694387
> 
> 赞同：0
> 
> 时间：2012-07-27T19:23:40.647
> 
> 标签：javascript, arrays, cakephp, submit, hidden

我在办公室使用 CakePHP 1.2，在[我的最后一个问题](https://stackoverflow.com/questions/11692728/cakephp-select-input-is-setting-a-display-member-and-a-value-member-possible/11692848)之后，我想在`SELECT`输入中发送所选选项的数组键，而不是发送其实际值。我用这个`Model::beforeSave()`功能尝试了一些东西，但没有成功。

我知道 CakePHP 发布的数据不包括整个数组，而只包括选定的值。这是该功能目前的样子：

```
function beforeSave(){
    $this->Post->set('category_id', = array_keys($this->data['Annonce']['category_id']);
    # debug($this->data);
} 
```

是否有办法将数组键存储到隐藏输入中并根据用户在输入中选择的项目更改此输入值`SELECT`，并且还省略发送用户输入但仍发送隐藏值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T13:19:57.897

```
$categories = Set::combine($categories,'{n}.categories.id', '{n}.categories.nom'); 
```

这是为我做的... CakePHP 将`array_keys()`值自动分配给`value`输入的字段。

# c# - 将类似的 Web 服务添加到 .NET C# 应用程序

> ID：11694388
> 
> 赞同：1
> 
> 时间：2012-07-27T19:23:43.173
> 
> 标签：c#, wcf, web-services

我是 Web 服务的新手，我正在开发一个 C# WCF 服务，它调用另一家公司的外部服务来获取一些客户端数据（例如：姓名、地址、电话等），这部分到目前为止工作正常.

外部服务基于一个标准的 XML Schema，其他公司很快就会从相同的 XML Schema 生成相同的服务，使用相同的名称方法并返回相同类型的 xml 文件。

我的第一个问题是，在我完成第一个实现之后，有什么方法可以“动态地”添加其他外部公司服务，拥有它们的 URL/端口/等信息，还是我必须手动将它们作为服务插入每次我需要添加一个新的时在我的内部服务项目中引用，然后编译并重新部署？

我的第二个问题与数据合同/成员有关，我的理解是即使他们返回相同的 XML 文件，他们的数据合同/成员也会不同，是这样吗？所以我必须制作一个特定的代码来从他们的数据合同中为每个新的外部公司读取我需要的信息？？如果这是真的，我一直在考虑制作一个通用代码来读取原始 xml，这是最好的选择吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T19:34:11.803

虽然 C# 是一种编译语言，但它确实通过 MEF 支持插件架构。您可以使用它并为每个源添加一个小插件 .dll。

话虽如此，您很可能只需要一个配置列表，其中包含每个源的连接详细信息并动态连接到它们。这只有在他们使用完全相同的模式时才有效，这样他们所服务的对象将对所有源进行相同的序列化。当然，您必须使用该配置通过代码动态实例化代理。

我应该为您的第二个问题添加一些内容。只要您是定义合同的人，它们的实际对象是否不同都没有关系。您所关心的只是它们所服务的 xml，并且您可以使用您的表示进行连接。事实上，您可以将合同生成为 .wsdl 文档。然后，每个服务实施者都可以从中生成域对象。另一方面，如果您不是“拥有”合同的人，则某些消息来源可能会决定稍有不同，这会让您头疼。但希望这不是你的情况。

祝你好运！:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T19:39:13.517

> 我的第一个问题是，在我完成第一个实现之后，有什么方法可以“动态地”添加其他外部公司服务，包括他们的 URL/端口/等信息

不幸的是，您每次都会添加服务、编译和部署

> 我的第二个问题与数据合同/成员有关，我的理解是即使他们返回相同的 XML 文件，他们的数据合同/成员也会不同，是这样吗？

如果您将使用自动生成的每个服务将创建不同的合同。我会考虑创建自己的类并使用反射和扩展方法转换外部类

# javascript - 如何根据 xe:simpleValuePicker 中的选择修改 UL

> ID：11694393
> 
> 赞同：0
> 
> 时间：2012-07-27T19:24:13.813
> 
> 标签：javascript, lotus-notes, xpages

我正在使用允许将视图临时导出到 Excel 的 ax XPage，我希望用户不仅可以选择哪些列，还可以按照他们认为合适的方式重新组织它们。虽然我可以使用 inputTextarea 来做到这一点，但我更愿意将 UL 与启用 jQuery 的可排序条目一起使用。不幸的是，我对 XPages、jQuery 或扩展库并不熟悉。

我的 inputTextarea 很简单，但是复制粘贴文本很麻烦，并且有用户输入一些无效列标题的风险（我根据他们选择的列标题计算要导出的行）。

```
<xp:inputTextarea id="example" multipleSeparator=";"
rows="6" style="width:270.0px" value="#{reportDoc.WhichFields}">
</xp:inputTextarea> 
```

valuepicker 的代码在每个实例中都是相同的

```
 <xe:valuePicker for="example" id="valuePicker1"
        dialogTitle="Select the columns to include">
        <xe:this.dataProvider>
        <xe:simpleValuePicker valueListSeparator=",">
            <xe:this.valueList><![CDATA[#{javascript:var
                viewName=@UpperCase(getComponent("viewChoice").getValue());
                var tmp = @DbLookup(@DbName(),"dbprofile",viewName,"Value");
                tmp = "None";
                var thisdb:NotesDatabase=session.getCurrentDatabase();
                if (viewName != ""){
                    var view:NotesView=thisdb.getView(viewName);
                    tmp = view.getColumnNames();
                }
                @If(@IsError(tmp),"None",tmp)}]]>
            </xe:this.valueList>
        </xe:simpleValuePicker>
        </xe:this.dataProvider>
    </xe:valuePicker> 
```

扩展库的 ListTextBox 很好，但是单击会将其从列表中删除，而不是允许拖动，而且我不知道使其垂直而不是水平的语法。

```
<xe:djextListTextBox id="example" multipleSeparator=";"></xe:djextListTextBox> 
```

jQuery 中有一个不错的小示例，其中您的 HTML 应如下所示，以允许用户拖放排序：

```
<div class="demo">
    <ul id="sortable">
        <li class="ui-state-default">Item 1</li>
        <li class="ui-state-default">Item 2</li>
        <li class="ui-state-default">Item 3</li>
        <li class="ui-state-default">Item 4</li>
        <li class="ui-state-default">Item 5</li>
        <li class="ui-state-default">Item 6</li>
        <li class="ui-state-default">Item 7</li>
    </ul>
</div> 
```

然后我在底部有一个简单的脚本块来管理可排序的。

```
<xp:scriptBlock id="scriptBlock1">
    <script type="text/javascript" src="js/jquery-1.7.2.min.js" />
    <script type="text/javascript" src="ui/jquery.ui.core.js" />
    <script type="text/javascript" src="ui/jquery.ui.widget.js" />
    <script type="text/javascript" src="ui/jquery.ui.mouse.js" />
    <script type="text/javascript" src="ui/jquery.ui.sortable.js" />

    <script type="text/javascript">
        $(document).ready(function() {
            $( "#sortable" ).sortable({ placeholder: "ui-state-highlight" }); 
            $( "#sortable" ).disableSelection();
        });

        }
    </script>
</xp:scriptBlock> 
```

我希望我可以配置 valuePicker 的输出以在 LI 上添加和删除，或者可能将 onChange 放入 inputTextarea，但事实证明它超出了我的思考能力。

任何指导或想法表示赞赏。非常感谢 Russ Maher，因为他最近在 DC AdminDev 上的演讲让我朝着这个方向努力，他让我用更多的问题来烦他。

**编辑：**通过在 ListBoxText 中使用 onChange 并在 UL 中重复使用，我走得更远。它将选择作为新的 LI 放入 UL，但我不能拖放它们。

```
<xe:djextListTextBox id="djextListTextBox1" multipleSeparator=";">
    <xp:eventHandler event="onChange" submit="true"
            refreshMode="partial" refreshId="sortable">
    </xp:eventHandler>
</xe:djextListTextBox> 
```

并重复：

```
<ul id="sortable">    
    <xp:repeat id="repeat1" rows="30" var="myChoices">
        <xp:this.value><![CDATA[#{javascript:getComponent("djextListTextBox1").getValue();}]]></xp:this.value>
        <li class="ui-state-default"><xp:label value="#{javascript:myChoices;}">
        </xp:label></li>
    </xp:repeat>
</ul> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T15:03:06.053

[在另一个 Stack Overflow 问题上](https://stackoverflow.com/questions/11433315/djextlisttextbox-onchange-dependent-controls?rq=1)找到了一些帮助

通过在 ListBoxText 中使用 onChange 并在 UL 中重复使用，我走得更远。它将选择作为新的 LI 放入 UL，但我不能拖放它们。

```
<xe:djextListTextBox id="djextListTextBox1" multipleSeparator=";">
    <xp:eventHandler event="onChange" submit="true"
            refreshMode="partial" refreshId="sortable">
    </xp:eventHandler>
</xe:djextListTextBox> 
```

并重复：

```
<ul id="sortable">    
    <xp:repeat id="repeat1" rows="30" var="myChoices">
        <xp:this.value><![CDATA[#{javascript:getComponent("djextListTextBox1").getValue();}]]></xp:this.value>
        <li class="ui-state-default"><xp:label value="#{javascript:myChoices;}">
        </xp:label></li>
    </xp:repeat>
</ul> 
```

# javascript - 如何将 Javascript 中的转义字符转换为 .txt 文件？

> ID：11694396
> 
> 赞同：0
> 
> 时间：2012-07-27T19:24:28.243
> 
> 标签：javascript, escaping, text-files, activexobject

我有一个 HTML 文件，它使用 Javascript 通过 ActiveXObject 对 .txt 文件执行文件 I/O 操作（***仅***适用于 Windows OS 上的 Internet Explorer）。

HTML页面上有一个文本输入框，还有一个按钮。该按钮调用一个函数  `onclick`  以将输入的文本写入 .txt 文件的末尾。HTML页面上还有一个textarea，将.txt文件修改后的内容复制粘贴到其中。到目前为止，所有这些都在工作......

* * *

所以，我想用 Javascript 从我的 HTML 页面中将制表符和换行符插入到 .txt 文件中。我正在使用这一行将 .txt 文件内容复制到 textarea 中，并在变量中初始化：

```
var newText = oldText + "\n" + document.getElementById("userInput").value; 
```

当然，转义字符  `\n`  适用于 HTML 页面，而不适用于 .txt 文件......

* * *

那么如何将新行和制表符编码为 .txt 文件的可解析格式？我曾尝试  对[此处找到](https://stackoverflow.com/questions/6555995/ansi-escape-sequences-as-bytes)的  值和  [此处](http://www.danshort.com/ASCIImap/)找到的  值使用该`escape()`  方法  ，但没有运气。 到目前为止，这是我的代码： `ANSI``ASCII`

```
<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>New Web Project</title>
    </head>
    <body>

        <p>
            Enter some text here: &nbsp;
            <input type = "text" id = "userInput" />
        </p>

        <input type = "button" value = "submit" onclick = "main();" />
        <br />
        <hr />
        <br /><br /><br />
        <textarea id = "textHere" rows = 25 cols = 150></textarea>

        <script type = "text/javascript">

            // executes all code from this function to prevent global variables
            function main()
            {
                var filePath = getThisFilePath();

                var fileText = readFile(filePath);
                writeFile(filePath, fileText);

            } // end of function main

            function getThisFilePath()
            {
                var path = document.location.pathname;

                // getting rid of the first forward-slash, and ending at the last forward-slash to get rid of file-name
                var correctPath = path.substr(1, path.lastIndexOf("/") );

                var fixedPath = correctPath.replace(/%20/gi, " "); // replacing all space entities

                return fixedPath;
            } // end of function getThisFilePath

            function readFile(folder)
            {
                var fso = "";
                var ots = "";
                var oldText = "";

                try
                {
                    fso = new ActiveXObject("Scripting.FileSystemObject");

                    // in the same folder as this HTML file, in "read" mode (1)
                    ots = fso.OpenTextFile(folder + "writeToText.txt", 1, true);

                    oldText = ots.ReadAll();

                    ots = null;
                    fso = null;
                }
                catch(e)
                {
                    alert("There is an error in this code!\n\tError:  " + e.message);
                    exit(); // end the program if there is an error
                }

                return oldText;

            } // end of function readFile

            function writeFile(folder, oldText)
            {
                var fso = "";
                var ots = "";

                var newText = oldText + "\n" + document.getElementById("userInput").value;

                try
                {
                    fso = new ActiveXObject("Scripting.FileSystemObject");

                    // in the same folder as this HTML file, in "write" mode (2)
                    ots = fso.OpenTextFile(folder + "writeToText.txt", 2, true);

                    ots.Write(newText);
                    ots.Close();

                    ots = null;
                    fso = null;
                }
                catch(e)
                {
                    alert("There is an error in this code!\n\tError:  " + e.message);
                    exit(); // end the program if there is an error
                }

                setText(newText); // with the function below

            } // end of function writeFile

                // called from the function writeFile
                function setText(textFile)
                {
                    document.getElementById("textHere").value = textFile;

                } // end of function setText

        </script> <!-- end of javascript -->
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T19:53:42.323

Windows 需要`"\r\n"`换行符。我很确定您也会在您的文本区域中找到它们`value`（按 Enter 后）。当您使用 设置值时，它们将自动插入`"\n"`，并且大多数库（如 jQuery）在读取值时会用“正常”换行符替换它们。

但是，我希望文件读/写只能`"\n"`工作，并且当您将文件的文本加载到您的文本区域时，它们应该会显示出来。MS 记事本可能无法显示它们。

# nosql - 使用 Memcache API 兼容存储在删除/驱逐后保留缓存数据

> ID：11694398
> 
> 赞同：3
> 
> 时间：2012-07-27T19:24:45.083
> 
> 标签：nosql, memcached, couchbase

这个问题专门与 Couchbase 相关，但我相信它适用于任何使用 memcached api 的东西。

假设我正在创建一个客户端/服务器聊天应用程序，并且在我的服务器上，我将每个用户的聊天会话信息存储在数据桶中。聊天会话结束后，我将从数据桶中删除会话对象，但同时我还希望将其持久保存到永久 NoSQL 数据存储中，以用于报告和分析目的。我还希望会话对象在缓存驱逐、会话超时等时保持不变。

是否有某种“最佳实践”（甚至是我缺少的 Couchbase 功能）使我能够有效地做到这一点并保持内存缓存系统的最佳性能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T16:17:18.037

使用 Couchbase Server 2.0，您可以设置两个存储桶（如果您想分离物理资源，则可以设置两个单独的集群）。在会话集群上，您将存储 JSON 文档（键/值对中的值），可能如下所示：

```
{ 
  "sessionId" : "some-guid",
  "users" : [ "user1", "user2" ],
  "chatData" : [ "message1", "message2"],
  "isActive" : true,
  "timestamp" : [2012, 8, 6, 11, 57, 00]
} 
```

然后，您可以在会话数据库中编写一个 Map/Reduce 视图，为您提供所有过期项目的列表（注意下面带有 meta 参数的示例需要最近构建的 Couchbase Server 2.0 - 而不是 DP4。

```
function(doc, meta) {
  if (doc.sessionId && ! doc.isActive) {
    emit(meta.id, null);
  }
} 
```

然后，使用您喜欢的 Couchbase 客户端库，您可以执行查询视图、获取项目并将它们移动到分析集群（或存储桶）中的任务。所以在 C# 中，这看起来像：

```
var view = sessionClient.GetView("sessions", "all_inactive");
foreach(var item in view) 
{
   var doc = sessionClient.Get(item.ItemId);
   analyticsClient.Store(StoreMode.Add, item.ItemId, doc);
   sessionClient.Remove(item.ItemId);
} 
```

相反，如果您想使用明确的时间戳或过期时间，您的视图可以根据时间戳进行索引：

```
function(doc) {
   if (doc.sessionId && ! doc.isActive) {
      emit(timestamp, null);
   }
} 
```

然后，您的任务可以通过包含一个 startkey 来查询视图，以返回 x 天内未触及的所有文档。

```
var view = sessionClient.GetView("sessions", "all_inactive").StartKey(new int[] { DateTime.Now.Year, DateTime.Now.Months, DateTime.Now.Days-1);

foreach(var item in view)
{
   var doc = sessionClient.Get(item.ItemId);
   analyticsClient.Store(StoreMode.Add, item.ItemId, doc);
   sessionClient.Remove(item.ItemId);
} 
```

查看[http://www.couchbase.com/couchbase-server/next](http://www.couchbase.com/couchbase-server/next)以获取有关 Couchbase Server 2.0 的更多信息，如果您需要对此方法的任何说明，请在此线程上告诉我。

- 约翰

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-30T20:07:59.117

CouchDB 存储（最终）是持久的，并且没有内置的过期机制，因此您存储在其中的任何内容都将保持存储，直到您将其删除 - 它不像在 Memcached 中您可以为存储的数据设置超时。因此，如果您将会话存储在 CouchDB 中，您将不得不在它们过期时自行删除它们，因为它不是一种自动机制，但您自己做的事情没有理由不将数据保存在您想要的任何地方同时。

BTH 我认为使用 Persistent NoSQL 而非 SQL 进行会话存储（反之亦然）没有任何优势——两者的性能都将受到 IO 限制。仅内存密钥存储或混合解决方案是完全不同的故事。

至于您的问题：在您的应用程序会话到期/会话关闭机制中移动数据和/或运行定期检查会话存储中是否存在过期会话并移动数据的 cron 作业。

# outlook - 如何自动将电子邮件评论添加到现有的 JIRA 问题

> ID：11694401
> 
> 赞同：1
> 
> 时间：2012-07-27T19:24:46.933
> 
> 标签：outlook, jira

我以前做过这个，但不记得怎么做这个了。

假设我有一个 JIRA 问题#967 打开。我正在使用我的 Outlook 电子邮件向几个人发送有关此问题的评论的电子邮件。我需要做什么才能自动将此评论添加为 JIRA 问题的一部分？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-29T06:59:11.010

请确保您遵循适合您的 Jira 版本的指南，每个版本都有一个页面。[按照本指南通过电子邮件设置问题和评论创建](https://confluence.atlassian.com/display/JIRA/Creating+Issues+and+Comments+from+Email)。

基本上你需要：

1.  [配置邮件服务器](https://confluence.atlassian.com/display/JIRA/Using+Gmail+as+a+JIRA+Mail+Server)- 使用您的交换服务器或[外部服务作为 Google](https://confluence.atlassian.com/display/JIRA/Using+Gmail+as+a+JIRA+Mail+Server)。
2.  [配置邮件处理程序](https://confluence.atlassian.com/display/JIRA/Creating+Issues+and+Comments+from+Email#CreatingIssuesandCommentsfromEmail-SteptwoConfigureamailhandler)- 您可能想要使用[Jira 的内置邮件处理程序](https://confluence.atlassian.com/display/JIRA/Creating+Issues+and+Comments+from+Email#CreatingIssuesandCommentsfromEmail-Mailhandlers)之一。

重要笔记-

*   要为 isser 键创建注释，`TEST-123`电子邮件的主题必须包含问题键，例如`Subject: Re: TEST-123 updates`.
*   没有主题行的电子邮件将不会被处理。
*   [阅读本文以获取更多提示](https://confluence.atlassian.com/display/JIRA/Creating+Issues+and+Comments+from+Email#CreatingIssuesandCommentsfromEmail-handytips)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T20:33:10.793

请参阅[此处的 Atlassian 文档](https://confluence.atlassian.com/display/JIRA/Creating+Issues+and+Comments+from+Email#CreatingIssuesandCommentsfromEmail-Issuecommentcreation)。如果您使用的是旧版本，请将 URL 中的 JIRA 替换为您所在的版本号，例如 JIRA044

# javascript - 引用 JavaScript 变量

> ID：11694402
> 
> 赞同：0
> 
> 时间：2012-07-27T19:25:00.940
> 
> 标签：javascript, jquery

我在脚本标签中有 2 个变量，这些变量填充了字符串值。我还有一个`.each`循环遍历页面上的每个选择框。我想要一种将循环的索引值附加到变量名称并检索其值的方法。

```
var secQuestion1 = "bla"
var secQuestion2 = "bla"

    selectbox.each(function( index ) {
       var question = ['secQuestion' + (index+1) ];
       console.log("question = ", ['secQuestion' + (index+1)] )
    }); 
```

我想我也许可以使用括号表示法来检索值。关于如何做到这一点的任何想法，所以在循环中的每个索引上我都会得到我的问题值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T19:27:24.433

我会在这里使用一个数组，例如：

```
var arrQuestions = ["question A", "question B", "questionC"];

selectbox.each(function( index ) {
   var question = arrQuestions[index];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T19:30:31.803

这取决于您的代码在什么上下文中运行，如果您的变量是全局的，那么您可以这样做

```
window['secQuestion' + (index+1)] 
```

您也可以将它们放在一个对象中并以这种方式访问​​它们

```
var obj = {
    secQuestion1: "bla",
    secQuestion2: "bla"
};
selectbox.each(function( index ) {
   console.log("question = ", obj['secQuestion' + (index+1)] )
}); 
```

# haskell - Haskell Hamming 数字，有效但显示重复

> ID：11694404
> 
> 赞同：1
> 
> 时间：2012-07-27T19:25:18.023
> 
> 标签：haskell, hamming-numbers, smooth-numbers

我试图在haskell中生成汉明数，问题是我的输出列表中有重复的#，我无法弄清楚究竟是为什么。我应该只创建一个删除重复项功能还是我只是缺少一些简单的东西？

同样在汉明函数中，我想确保输入列表的大小正好是 3，如何找到列表的大小以便进行比较？

```
{- Merge lists x&y of possibly infinite lengths -}
merge [] [] = []
merge [] ys = ys
merge xs [] = xs
merge xs ys = min x y : if x < y then merge (tail xs) ys
                             else merge xs (tail ys)
    where x = head xs
          y = head ys

{- multiply each element in y by x -}
times x [] = []
times x y = x * (head y) : times x (tail y)

{- find the hamming numbers of the input primes list -}
ham [] = []
ham x = 1 : merge (times (head x) (ham x))
             (merge (times (x !! 1) (ham x)) (times (last x) (ham x)))

{- returns x hamming #'s based on y primes of size 3 -}
hamming x [] = []
hamming x y = take x (ham y) 
{- hamming x y = if "y.size = 3" then take x (ham y) 
                                 else "Must supply 3 primes in input list" -} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T19:51:37.537

您会得到重复项，因为许多汉明数是多个基数的倍数，并且您不会在`merge`函数中删除重复项。例如，对于经典的`2, 3, 5`汉明数，您可以得到 6`2 * 3`和`3 * 2`.

您当然可以创建重复删除功能。由于您创建的列表已排序，因此效率也不会很低。或者您可以删除合并功能中的重复项。

> 如何找到列表的大小以便进行比较？

您可以使用 中提供的`length`函数来获取列表的长度`Prelude`，但现在让我警告您，`length`只有在确实需要长度时才应该进行调用，因为`length`必须遍历整个列表来计算其长度。如果列表恰好很长，则需要花费大量时间，并且如果在其他地方引用该列表，则可能会导致大量内存使用，从而无法对其进行垃圾回收。如果列表甚至是无限的，那么评估它的长度当然永远不会终止。

你想做的也可以通过模式匹配来实现，

```
ham [a, b, c] = list
  where
    list = 1 : merge (map (a*) list) (merge (map (b*) list) (map (c*) list))
ham _ = [] 
```

您也可以使用带`length`支票的警卫

```
hamming x y
    | length y == 3 = take x (ham y)
    | otherwise     = [] 
```

确保您的输入列表恰好包含三个元素，但是如果您调用`hamming 10 [1 .. ]`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-28T03:27:24.843

在`List`模块中，Haskell 有一个名为`nub`. 这是在 hoogle 上：[http](http://www.haskell.org/hoogle/?hoogle=nub) ://www.haskell.org/hoogle/?hoogle=nub 。这是 O(n^2) ，所以你最好改变`merge`. 但是在优化之前首先使用已经为您编写的慢速解决方案可能是值得的。

*我怀疑您正在尝试通过这个小练习来学习 Haskell，但这是使用List monad*写出汉明数（没有重复，但不是按顺序）的另一种方法：

```
uglyNumbers = do { n <- [0..] 
                 ; k <- [0..n] 
                 ; j <- [0..n-k] 
                 ; return $ (2^(n-k-j))*(3^j)*(5^k) } 
```

这会生成一个惰性的、无限的汉明数列表。您可以使用*列表推导*等效地编写此代码：

```
uglyNumbers' = [(2^(n-k-j))*(3^j)*(5^k) | n <- [0..], k <- [0..n], j <- [0..n-k]] 
```

# javascript - JavaScript 中的 HTML 和 CSS 到 PDF

> ID：11694408
> 
> 赞同：6
> 
> 时间：2012-07-27T19:25:31.043
> 
> 标签：javascript, node.js, pdf

我知道那里有很多库，但似乎没有一个与我的场景完全匹配。所以我希望在这里得到一些建议......

技术：我在 Express.js 上使用 Node.js 作为后端，使用 html/css/js 作为前端。浏览器支持 IE8 及更高版本、chrome、FF 和其他现代浏览器。

我需要做的是：有一个“to pdf”按钮供用户单击，然后将一大块 DOM 转换为 pdf。这块 DOM 的 html 是在后端对另一个应用程序进行 API 调用时动态生成的。CSS 是静态的。

除此之外，我有很大的自由做任何我想做的事，只要我不必将明文数据发送给第三方等。

有什么推荐的方法吗？

* * *

更新：查看 wkhtmltopdf

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-01T00:21:51.630

基本上，这就是我最终做的

```
console.log("before");
fs.writeFile(html_filename, html, function (err) {
  if (err) {res.writeHead(400); res.end("" + err); return;}

  console.log("wrote html fine; now converting");
  exec('wkhtmltopdf ' + html_filename + ' ' + pdf_filename, function (err, stdout, stderr) {
    if (err) {res.writeHead(400); res.end("" + err); return;}

    console.log("converted; now reading");
    fs.readFile(pdf_filename, function (err, data) {
      if (err) {res.writeHead(400); res.end("" + err); return;}

      console.log("read fine; now serving");
      res.writeHead(200, {"content-type" : "application/pdf"});
      res.end(data);
    });
  });
}); 
```

IMO有点难看，因为它需要制作一个文件，然后转换它，然后提供它，最后删除这两个文件。我怀疑这里的可扩展性问题。wkhtmltopdf 似乎也不适合 osx。但是在linux上没有这样的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T01:10:56.287

试试 wkhtmltopdf 。您可以轻松查看 Ruby on Rails 驱动程序的当前实现并将其应用于 node 和 express。您基本上调用了一个命令行应用程序，它将使用您的打印 CSS 转换为 PDF。

# php - 无法将 PHP 变量传递给 file_get_contents()

> ID：11694409
> 
> 赞同：1
> 
> 时间：2012-07-27T19:25:34.380
> 
> 标签：php, html

我是一名新手编码员，试图使用 PHP 构建一个简单的 Web 应用程序。我正在尝试发送一封 HTML 电子邮件，其中的变量在每次发送时都会更改。启动电子邮件的代码是“email.php”，其中包含：

```
$body = file_get_contents('welcome/green2.html.php'); 
```

在“green2.html.php”文件中，我有一个名为 $highlight 的变量需要填充。$highlight 变量在“email.php”文件中定义。我曾试图简单地在“green2.html.php”文件中添加，但它没有被解析。我在输出变量时得到一个空格。

另外，我在“email.php”文件中添加了“welcome/green2.html.php”。当我回显它时，$highlight 变量会显示在结果页面上，但如果我回显 $body 则不会。

任何帮助将非常感激！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-27T19:27:22.493

您是否尝试过 str_replace 功能？[http://php.net/manual/en/function.str-replace.php](http://php.net/manual/en/function.str-replace.php)。

在 HTML 中添加一个占位符（例如，#name# 代表名称，#email# 代表电子邮件），然后在加载文件内容后使用字符串替换功能。

`$bodytag = str_replace("#name#", $name, $myfile);`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T19:35:28.077

通过加载文件`file_get_contents()`不会导致它被 PHP 解析。它只会作为静态文件加载，无论它是否包含 PHP 代码。

如果你想让它被 PHP 解析，你需要`include`or`require`它。

但听起来您正在尝试为您的电子邮件编写模板系统。如果这是您正在做的事情，最好不要将其作为要解析的 PHP 代码，而是在其中包含占位符标记，然后使用`str_replace()`或类似的函数将变量从主程序注入到字符串中。

希望有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-27T19:36:16.470

使用[http://php.net/manual/en/function.sprintf.php](http://php.net/manual/en/function.sprintf.php)在您的代码中放置一个 %s 而不是变量读取内容并将字符串放入 sprintf 中，其中包含您想要放置的变量。希望这会有所帮助。

# c# - 实体框架和存储过程不匹配的实体/模型

> ID：11694414
> 
> 赞同：0
> 
> 时间：2012-07-27T19:25:56.027
> 
> 标签：c#, sql-server, stored-procedures, entity-framework-4

我真的在这里寻找关于最佳实践的建议，所以我会解释这种情况。我们有一个相当大的应用程序，它建立在 POCO 和 EF 4 之上，并带有一个复杂的数据库。虽然我们对 Entity Framework 很满意，但在以下场景（相当简化）中，我们还需要做出明确的性能改进。

我们有一个名为 News 的表，其中包含已将其添加到收藏夹的用户集合和用户评分 (1 - 5) 的集合，例如：

```
public class News
{
   public virtual int NewsId;
   public virtual string Title;
   .......etc....

   public virtual ICollection<User> UserFavourites { get; set; }
   public virtual ICollection<Rating> Ratings { get; set; }
} 
```

我们编写了一个存储过程，它为用户返回新闻，并允许我们返回它是否是最喜欢的，以及它是否已经被我们请求数据的用户评级和新闻的当前评级，而不是使用 EF 构建这些来自 ICollections 的数据，我们最终得到一个如下所示的对象。

```
public class NewsDataModel
{
   public int NewsId;
   public string Title;
   .......etc....

   public bool IsFavourite { get; set; }
   public bool IsRated { get; set; }
   public double Rating { get; set; }
} 
```

存储过程要快得多，并且单个数据库命中而不是带有延迟加载的 EF，后者可能是多个调用，但存储过程返回的数据与上面的新闻的 POCO 类不匹配。

我们一直在尝试以最好的方式来推进这一点，因为我们有一个 INewsRepository，它可以返回与实体框架相关的类或我们正在使用存储过程和 ADO.NET 填充的自定义 DataModel 类。这感觉不对，当您想要一个具有从多个表构建的数据的单个对象时，我希望从其他人的经验中获得任何建议或见解，这将比实体框架快得多在启用延迟加载的情况下调用。

非常感谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-29T16:44:42.467

您的存储库返回实例的新方法没有任何问题`NewsDataModel`- 它仍然在您的范围内，`INewsRepository`因为它是从新闻信息构造的数据类。否则，您将拥有您定义的每个数据模型的存储库。

# javascript - 在旋转 javascript 横幅中添加链接

> ID：11694415
> 
> 赞同：0
> 
> 时间：2012-07-27T19:25:59.793
> 
> 标签：javascript, html, css, image, href

我有一个旋转横幅，我需要添加指向[示例](http://www.advancedfluids.com/2012/)的链接。下面是部分js代码。我的问题是让 href 在 index.php 页面中工作。

```
function change_banner(){

data=xmldata[changenum];                    //get current banner XML object 

img=$(data).attr("src");                    //retrieve variables
href=$(data).attr("href");
target=$(data).attr("target");

$(".banner_img_href").attr("href",href);        //change variables on HTML
$(".banner_img_href").attr("target",target);
$("#banner_image").attr("src",img); 
```

这是html：

```
<div class="banner">
    <div class="banner_text">
        <img src="images/banner_text.png">
    </div>
    <div class="banner_img">
         <img   border='0' src="images/banner_gas.png" id='banner_image' alt='Banner Image' />
    </div>
</div> 
```

我尝试了基本链接，但没有骰子。不知道我哪里出错了。

谢谢，

B坟墓

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T21:29:48.800

我知道您说您尝试了基本链接，但以下 html*应该可以*工作：

```
<div class="banner">
    <div class="banner_text">
        <a class="banner_img_href" href="http://someurl.com">
            <img src="images/banner_text.png">
        </a>
    </div>
    <div class="banner_img">
         <a class="banner_img_href" href="http://someurl.com">
             <img border='0' src="images/banner_gas.png" id='banner_image' alt='Banner Image' />
         </a>
    </div>
</div> 
```

JavaScript：

```
function change_banner(){

    data=xmldata[changenum];                    //get current banner XML object 

    img=$(data).attr("src");                    //retrieve variables
    href=$(data).attr("href");
    target=$(data).attr("target");

    $(".banner_img_href").attr("href",href);        //change variables on HTML
    $(".banner_img_href").attr("target",target);
    $("#banner_image").attr("src",img);
} 
```

在您的代码中，您没有任何带有 class 的元素`banner_img_href`，因此实际上并未在任何元素上设置 href 属性。

如果这不起作用，我将验证您的数据实际上是否包含有效的 href url，并且您能够检索它（使用浏览器中的开发人员工具设置断点并检查值，或输出使用 ) 将值传递给 JavaScript 控制台`console.log(href)`。

编辑：我刚刚检查了您如何获取数据和数据格式。您的 XML 文件可能应该采用不同的格式，如下所示：

```
<gallery fade="500" ontime="5000">
    <picture src="images/banner_gas.png" href="desiccant-dryers-air-dryers.php" />
    <picture src="images/banner_liquid.png" href="backwashing-sand-filters.php" />
    <picture src="images/banner_mis.png" href="air-cooled-chillers-explosion-preventers.php" />
</gallery> 
```

问题在于您获取数据的方式以及数据的格式。如果您如上所述格式化 xml 文件，它应该可以正常工作。

# php - 使用 Post/Redirect/Get 处理 PHP 表单验证

> ID：11694416
> 
> 赞同：-4
> 
> 时间：2012-07-27T19:25:59.890
> 
> 标签：php, forms, validation, session

所以我在我的网站上工作，我有一些表格。如果没有任何错误，我自己创建了一个小系统来发送/验证并添加到数据库中。在我的系统中，我还使用会话变量来处理表单中的所有错误，因为 Post/Redirect/Get 技术没有保存任何内容。

会话变量用于存储发送的数据，因此如果出现错误，您可以重新填充表单并存储有关表单问题的一些信息。

把所有这些步骤放在一起需要很多时间，这些时间可以用来在我的网站上做其他事情。

我希望有人有一个更容易起床和工作的解决方案。你们中的任何人都使用会话变量并这样做还是有其他解决方案？

我还使用 jQuery 验证插件在提交表单之前对其进行验证，但它并不是真正有用，因为我的 php 表单处理完成了它所做的一切。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T19:29:02.030

> 在我的系统中，我还使用会话变量来处理表单中的所有错误，因为 Post/Redirect/Get 技术没有保存任何内容。

只是在出现错误时不重定向，而仅在成功且有效的表单提交时重定向。

# jquery - jQuery UI Touch 库是否有别名？

> ID：11694417
> 
> 赞同：2
> 
> 时间：2012-07-27T19:26:02.373
> 
> 标签：jquery

我看到 jQuery UI Touch Puch 的开头是这样的：

```
(function ($) {

    // Detect touch support
    $.support.touch = 'ontouchend' in document; 
```

最后一行是这样的：

```
})(jQuery); 
```

这是否意味着此代码中的美元符号有别名？我们遇到了在同一页面上运行不同版本的 jQuery 的问题（Adobe Edge 动画需要旧版本，而我们的应用程序从新版本执行最新/最大的拖放操作）。我们想开始将我们的代码别名为不同的变量，并希望确保我们涵盖了所有版本。这个库是否已经别名？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T19:28:00.297

```
(function (jQ) {     // this is a reference to jQuery, see last line

  // Detect touch support
  jQ.support.touch = 'ontouchend' in document;// but than use your reference inside your fn

})(jQuery); 
```

或与`jQuery.noConflict()`：

```
jQuery.noConflict();
(function ($) {     // remap '$' to 'jQuery' (see last line)

  // Detect touch support
  $.support.touch = 'ontouchend' in document;// use '$' freely

})(jQuery); 
```

# excel - 在excel中将一行复制到多行

> ID：11694423
> 
> 赞同：3
> 
> 时间：2012-07-27T19:26:22.240
> 
> 标签：excel, excel-2007

我试着用谷歌搜索它并找不到一个简单的答案。如何取一行并将其应用于多行？例如，在一行中我有“状态”，我想将它复制到同一列中，一直向下（多行）。

我正在使用 Excel 2007。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T19:27:35.993

按住 Shift 键单击整个列（或行范围），然后点击 Fill->Down。

不过，在哪里`Fill`取决于您运行的 Excel 版本。

在 2007 年，填充位于功能区“主页”选项卡的右上角，在“编辑”控制框中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-10T07:26:43.120

首先选择复制要从下一行复制的行。示例 - A1 到 E1 将从 A2:E2 复制到 A420:E420

然后按 Ctrl+G 选择 GOTO 选项并输入目标单元格编号 Example A420 并按 去那里

从单元格编号 A420，按 Ctrl+Shift 和向上箭头，然后将选择 A420 到单元格编号 A1 之间的所有单元格进行复制。

再次按 Shift+向下箭头一步以取消选择第一行/单元格 A1 行，其中包含要从 A2 行复制到 A420 行的内容。

现在按下 ENTER 按钮，第一行/已被复制到 A420 Row

# xml - vb 2010 XslCompiledTransform 需要从字符串转换而不是从 URI 磁盘文件转换

> ID：11694424
> 
> 赞同：2
> 
> 时间：2012-07-27T19:26:35.630
> 
> 标签：xml, xslt, transform, vb.net-2010, xslcompiledtransform

以下代码有效，从本地磁盘获取 XSL 和 XML，并将转换后的 XML 返回到变量 Xtransoutput。

```
Dim XmlInputPath As String = "C:\Any.XML"
Dim XslInputPath As String = "C:\Any.XSL"

Dim StringWriter As New System.IO.StringWriter
Dim XsltTransformation As New XslCompiledTransform(True)
Dim XsltArgumentList As New XsltArgumentList
Dim Xtransoutput As String = Nothing

XsltTransformation.Load(XslInputPath)
XsltTransformation.Transform(XmlInputPath, XsltArgumentList, StringWriter)
Xtransoutput = StringWriter.ToString 
```

我的问题是我已经将 XML 和 XSL 放在单独的字符串中，它们不在磁盘上，出于安全原因，我不能将它们写入磁盘。关于如何让这些从字符串而不是磁盘文件工作的任何建议？

蒂亚！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-28T16:52:03.047

**这是一个 C# 示例**——将其转换为 VB 留给读者作为练习 :) )

```
using System;
using System.IO;
using System.Xml;
using System.Xml.Xsl;

namespace XsltInMemory
{
    class XsltInMemory
    {
        static void Main(string[] args)
        {
            XmlDocument doc = new XmlDocument();
            XslCompiledTransform xslt = new XslCompiledTransform();

            doc.LoadXml("<t/>");

            StringReader sr = new StringReader(

@"<xsl:stylesheet version='1.0'
 xmlns:xsl='http://www.w3.org/1999/XSL/Transform'>
 <xsl:output omit-xml-declaration='yes' indent='yes'/>

 <xsl:template match='node()|@*'>
  <xsl:copy>
   <xsl:apply-templates select='node()|@*'/>
  </xsl:copy>
 </xsl:template>
</xsl:stylesheet>"

            );

            MemoryStream ms = new MemoryStream();

            xslt.Load(new XmlTextReader(sr));

            xslt.Transform(doc, null, ms);

            ms.Flush();
            ms.Position = 0;

            StreamReader sr2 = new StreamReader(ms);

            Console.Write(sr2.ReadToEnd());
        }
    }
} 
```

# javascript - Backbone.js 更改模型的 url 参数并且 fetch 不会更新获取的数据

> ID：11694425
> 
> 赞同：12
> 
> 时间：2012-07-27T19:26:41.663
> 
> 标签：javascript, backbone.js

我有以下模型：

```
window.MyModel = Backbone.Model.extend({
     initialize: function(props){
          this.url = props.url;
     } 

     parse: function(){

          // @override- parsing data fetched from URL
     }

});

 // instantiate
  var mod = new MyModel({url: 'some/url/here'}); 
```

我使用这个全局变量“mod”从后端获取一些数据到这个模型中。

```
 // fetch

 mod.fetch({
       success: function(){ ...},
       error: ...

 }); 
```

以上所有工作都很好......我的问题：我想通过更改重置url并调用fetch来重用这个模型，但它不会以某种方式更新url。我尝试了以下方法：

```
 mod.fetch({ 
       data: {url:'/some/other/url'},
       postData: true,
       success: function(){ //process data},
       error: ...
  });

 mod.set({url: '/some/other/url'});
 // called fetch() without data: and postData: attributes as mentioned in previous 
```

如何为我的模型设置 url，以便我可以调用 fetch() 并从更新的 url 中获取数据？我是不是错过了什么。感谢您的任何指点..

**更新 1**：基本上，如果我这样做了，我将无法获得更新的值

```
 model.set({url: 'new value'}); 
```

其次是

```
 model.fetch(); 
```

“模型”是一个全局变量。创建一个新的“模型”实例有效：

```
 model = new Model({url:'/some/other/url'}); 
    model.fetch(); 
```

但是，按要求工作。这是否意味着模型实例永久附加到 url 并且无法重置？

**更新 1 中对我的问题的回答**模型实例未永久附加到 url。它可以动态重置。请阅读@tkone 的详尽解释，然后阅读@fguillens 的解决方案以便更好地理解。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-07-28T10:39:11.397

在了解了@tkone 的解释之后......

如果您仍然想要动态`Model.url`，您总是可以将其构造延迟到*运行时*，试试这个：

```
window.MyModel = Backbone.Model.extend({
  url: function(){
    return this.instanceUrl;
  },
  initialize: function(props){
    this.instanceUrl = props.url;
  } 
} 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-07-27T19:33:19.640

那么这里的答案是你想要做的：

```
mod.url = '/some/other/url' 
```

URL 不是模型本身实例的一部分，而是`MyModel`您从中创建模型实例的对象的属性。因此，您只需将其设置为普通的 JavaScript 对象属性即可。 `set`仅当您设置的数据（或相反地使用`get`）实际上是您要从服务器发送/接收的数据的属性时才使用。

但是为什么要更改 URL 是我们应该问的问题。Backbone 的模型/集合系统背后的想法是，您与一个 REST 端点对话，每个模型都有一个对应的端点。

就像您有一个博客并且该博客有一个“条目”对象，可在以下位置获得：

```
/rest/entry/ 
```

你有一个用于 Entry 的 Backbone 模型：

```
Entry = Backbone.Model.extend({urlBase: '/rest/entry'}); 
```

现在，当您`save`或`fetch`Backbone 知道这是如何工作的时候。

所以就像你正在制作一个新模型：

```
e = new Entry();
e.set({title: "my blog rulez", body: "this is the best blog evar!!!!1!!"});
e.save(); 
```

然后，这将使 Backbone`/rest/entry`对正文执行 HTTP POST 请求：

```
{
  "title": "my blog rulez",
  "body": "this is the best blog evar!!!!1!!"
} 
```

（当您这样做时，您`mod.set({url: '/some/other/url'});`实际上是在向数据集添加一个名为的字段`url`，因此服务器将`"url": "/some/other/url"`作为上述 JSON POST 正文的一部分发送：

```
{
  "title": "my blog rulez",
  "body": "this is the best blog evar!!!!1!!",
  "url": "/some/other/url" 
} 
```

然后，服务器将使用相同模型的 HTTP 200（或 201）响应进行响应，仅附有类似的 ID：

```
{
  "id": 1,
  "title": "my blog rulez",
  "body": "this is the best blog evar!!!!1!!"
} 
```

这不是你要找的，对吧？）

现在你有了这个模型，它有一个 ID。这意味着如果你改变它：

```
e.set('title', 'my blog is actually just ok');
e.save() 
```

Backbone 现在发出 HTTP PUT 请求`/rest/entry/1`以更新服务器上的资源。

服务器看到您正在谈论`/rest/entry/`端点上的 ID 1，因此知道要更新现有记录（并发回 HTTP 200）。

TL;博士

不要更改 URL，Backbone 会。为一条新数据创建一个新模型。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-07-30T16:55:36.337

```
model.urlRoot = "/your/url" 
```

或者

```
model.urlRoot = function(){ return "/your/url"; } 
```

或者

```
model.url = "/your/url" 
```

或者

```
model.url = function(){ return "/your/url"; } 
```

Backbone.Model 对象的默认“url”属性如下。Backbone.js 文档说：

> 服务器上模型表示的默认 URL - 如果您使用 Backbone 的 restful 方法，请覆盖它以更改将被调用的端点。

```
url: function() {
  var base = getValue(this, 'urlRoot') || getValue(this.collection, 'url') || urlError();
  if (this.isNew()) return base;
  return base + (base.charAt(base.length - 1) == '/' ? '' : '/') + encodeURIComponent(this.id);
}, 
```

很明显，它首先获取了 urlRoot 的值，如果不可用，它会查看模型所属的集合的 url。通过定义 urlRoot 而不是 url 具有在 urlRoot 为空的情况下回退到集合 url 的优势。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-03-13T16:15:40.243

您可以在 fetch 函数中将 url 设置为选项，如下所示：

```
var mod = new MyModel();
mod.fetch({
   url: '/some/other/url',
   data: {}
}); 
```

# javascript - Ajax 加载器和链式选择框

> ID：11694432
> 
> 赞同：2
> 
> 时间：2012-07-27T19:26:56.587
> 
> 标签：javascript, jquery, html, css, ajax

我正在使用动态选择框，并且正在使用 JS/Jquery 更新每个选择框的值。由于我是从 MySQL 表中提取值，因此有时需要更长的时间来加载带有其值的选择框。我搜索的一种解决方案是使用 ajax 加载器。

如何放置一个 ajax 加载器（就在 updateSelectBox.js 中的 jQuery.getJSON 之前），以便在第一个选项卡上加载时无法单击任何内容，并在成功处理后将其删除（在同一文件中）？或任何更好的解决方案？这是一个[示例](http://webprolearner.ueuo.com/dropdown-menu/test1.php)

**更新选择框.js**

```
var formObject = {
    run : function(obj) {

            obj.nextAll('.update').attr({'disabled': true, 'hidden':true}).html('<option value="">----</option>');
            var id = obj.attr('id');
            var v = obj.val();
            jQuery.getJSON('mod/postfile.php', { id : id, value : v }, function(data) {
            $('.update').removeClass('last');
                if (!data.error) {
                    obj.next('.update').html(data.list).removeAttr('disabled hidden');
                } else {
                 obj.addClass('last').nextAll('.update').attr({'disabled': true, 'hidden':true}).html('<option value="">----</option>');
                }
            });
        }   
}; 

$(function(){

    $('.update').live('change', function() {
        var str = "";
          $("select option:selected").each(function () {
                str += $(this).text() + " ";
              });
          $("#postSelected").text(str);

        formObject.run($(this));
    });

}); 
```

**HTML**

```
<select name="gender" id="gender" class="update" size="7"> 
  <option value="">Select one</option> 
    <?php if (!empty($list)) { ?> 
    <?php foreach($list as $row) { ?> 
       <option value="<?php echo $row['id']; ?>"> 
        <?php echo $row['category_name']; ?> 
       </option> 
    <?php } ?> 
    <?php } ?> 
</select> 

<select name="category" id="category" class="update" disabled="disabled" hidden="hidden" size="7"> 
  <option value="">----</option> 
</select> 

<select name="colour" id="colour" class="update" disabled="disabled" hidden="hidden" size="7"> 
  <option value="">----</option> 
</select> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-30T07:01:28.520

首先，您应该创建一个 ajax 加载器图像（例如[此处](http://ajaxload.info/)）并将其保存在您的服务器上。就在*getJSON*之前，应该显示 ajaxloader 覆盖（自定义图像源！）：

```
$('#tabs').append('<div class="overlay"><div class="overlay_image"><img src="ajaxloader.gif" alt="ajaxloader"></div></div>');
$('#tabs .overlay').css("line-height", $('#tabs').height()+'px'); 
```

并在成功处理程序结束时将其删除：

```
$('#tabs .overlay').remove(); 
```

您的*formObject*现在应该是：

```
var formObject = {
    run : function(obj) {
        obj.nextAll('.update').attr({'disabled': true, 'hidden':true}).html('<option value="">----</option>');
        var id = obj.attr('id');
        var v = obj.val();
        $('#tabs').append('<div class="overlay"><div class="overlay_image"><img src="ajaxloader.gif" alt="ajaxloader"></div></div>');
        $('#tabs .overlay').css("line-height", $('#tabs').height()+'px');
        jQuery.getJSON('mod/postfile.php', { id : id, value : v }, function(data) {
        $('.update').removeClass('last');
            if (!data.error) {
                obj.next('.update').html(data.list).removeAttr('disabled hidden');
            } else {
             obj.addClass('last').nextAll('.update').attr({'disabled': true, 'hidden':true}).html('<option value="">----</option>');
            }
            $('#tabs .overlay').remove();
        });
    }   
}; 
```

需要以下额外的样式表才能看到覆盖：

```
#tabs {
    position: relative;
}

.overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 2000;
    background-color: #EEEEEE;
    opacity: 0.5;
}

.overlay > div {
    position: relative;
    text-align: center;
}

.overlay > img {
    vertical-align: middle;
} 
```

另请参阅[此示例](http://jsfiddle.net/UZ3x4/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T19:49:29.763

一种可供您考虑的替代方法：您的 MySQL 查询根本不应该花费很长时间。这些是非常简单的查找；如果它们需要很长时间，则可能缺少索引。在添加预加载逻辑之前，我会查看查询在后端需要多长时间，并尝试优化这些查询。

# magento - Magento - 覆盖的网格不刷新

> ID：11694435
> 
> 赞同：0
> 
> 时间：2012-07-27T19:26:59.217
> 
> 标签：magento

我覆盖`class My_CategoryFilters_Block_Adminhtml_Catalog_Category_Tab_Product extends Mage_Adminhtml_Block_Widget_Grid`并将“可见性”列添加到_prepareCollection 和_prepareColumns。每当我尝试过滤时，网格都不会刷新。

我读到[Grid 没有出现在 Magento 的自定义管理模块中](https://stackoverflow.com/questions/5604451/grid-doesnt-appear-in-custom-admin-module-in-magento)和[Magento Grid Container Block not loading grid](https://stackoverflow.com/questions/5716580/magento-grid-container-block-not-loading-grid)。两者都建议创建一个重载的控制器。有一点 Magento 经验的人可以解释一下我所缺少的吗？

提前致谢。

编辑：从代码中删除了“渲染器”和“控制器”。

# 这是树的样子：

```
CategoryFilters
├── Block
│   └── Adminhtml
│       └── Catalog
│           └── Category
│               └── Tab
│                   └── Product.php
├── Core
│   └── etc
│       └── config.xml
└── etc 
```

# 这是我的代码：

```
protected function _prepareCollection()
{
    if ($this->getCategory()->getId()) {
        $this->setDefaultFilter(array('in_category'=>1));
    }
    $store = $this->_getStore();
    $collection = Mage::getModel('catalog/product')->getCollection()
        ->addAttributeToSelect('name')
        ->addAttributeToSelect('sku')
        ->addAttributeToSelect('price')
        ->addAttributeToSelect('store_id')
        ->addStoreFilter($this->getRequest()->getParam('store'))
        ->joinField('position',
            'catalog/category_product',
            'position',
            'product_id=entity_id',
            'category_id='.(int) $this->getRequest()->getParam('id', 0),
            'left')
        ->joinAttribute('visibility', 'catalog_product/visibility', 'entity_id', null, 'inner', $store->getId());
        ;

    $this->setCollection($collection);

    $this->getCollection()->addWebsiteNamesToResult();

    if ($this->getCategory()->getProductsReadonly()) {
        $productIds = $this->_getSelectedProducts();
        if (empty($productIds)) {
            $productIds = 0;
        }
        $this->getCollection()->addFieldToFilter('entity_id', array('in'=>$productIds));
    }

    return parent::_prepareCollection();
}

protected function _prepareColumns()
{
    $this->addColumn('visibility', array(
        'header'   => Mage::helper('catalog')->__('Visibility'),
        'width'    => '100',
        'sortable' => false,
        'index'    => 'visibility',
        'type'     => 'options',
        'options'  => Mage::getModel('catalog/product_visibility')->getOptionArray(),
        #'renderer' => new Rogue_CategoryFilters_Block_Adminhtml_Renderer_Visibility()
    ));
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T17:43:11.510

答案有点超出我的理解范围。我没有深入挖掘，但我假设它必须按照父母处理我的请求的方式来做。

发布更新的代码片段。

```
protected function _addColumnFilterToCollection($column)
{
    // Set custom filter for in category flag
    if ($column->getId() == 'in_category') {
        $productIds = $this->_getSelectedProducts();
        if (empty($productIds)) {
            $productIds = 0;
        }
        if ($column->getFilter()->getValue()) {
            $this->getCollection()->addFieldToFilter('entity_id', array('in'=>$productIds));
        }
        elseif(!empty($productIds)) {
            $this->getCollection()->addFieldToFilter('entity_id', array('nin'=>$productIds));
        }
    }
    else if ($column->getId() == 'websites') {
        $this->getCollection()->joinField('websites',
            'catalog/product_website',
            'website_id',
            'product_id=entity_id',
            null,
            'left');
        return parent::_addColumnFilterToCollection($column);
    }
    else {
        parent::_addColumnFilterToCollection($column);
    }

    return $this;
}

protected function _prepareCollection()
{
    $store = $this->_getStore();
    $collection = Mage::getModel('catalog/product')->getCollection()
        ->addAttributeToSelect('name')
        ->addAttributeToSelect('sku')
        ->addAttributeToSelect('price')
        ->addAttributeToSelect('store_id')
        ->addStoreFilter($this->getRequest()->getParam('store'))
        ->joinField('position',
            'catalog/category_product',
            'position',
            'product_id=entity_id',
            'category_id='.(int) $this->getRequest()->getParam('id', 0),
            'left');

    if ($store->getId()) {
        $collection->addStoreFilter($store);
        $collection->joinAttribute('visibility', 'catalog_product/visibility', 'entity_id', null, 'inner', $store->getId());
    }
    else {
        $collection->addAttributeToSelect('visibility');
    }

    $this->setCollection($collection);

    if ($this->getCategory()->getProductsReadonly()) {
        $productIds = $this->_getSelectedProducts();
        if (empty($productIds)) {
            $productIds = 0;
        }
        $this->getCollection()->addFieldToFilter('entity_id', array('in'=>$productIds));
    }

    parent::_prepareCollection();
    $this->getCollection()->addWebsiteNamesToResult();

    return $this;
} 
```

# java - 试图重写 Snake - Snake 自食其力

> ID：11694436
> 
> 赞同：3
> 
> 时间：2012-07-27T19:27:00.360
> 
> 标签：java

我遇到了一个（至少对我来说）*非常*奇怪的情况。
我正在尝试重写蛇，并且移动进展顺利，只有蛇在吃自己，虽然我正在删除 1 段，并添加 1 (x + 1 - 1 = x?) 但蛇消失了，而 Arraylist 保持相同的尺寸（打印它）。

计算蛇位置的函数（我认为这是导致它的原因）：

```
private void move() {
    System.out.println(position.size());
    Point toAdd = position.get(position.size() - 1);
    position.remove(0);
    if(dir == 1)
        toAdd.y -= 5;
    else if(dir == 2) 
        toAdd.x -= 5;
    else if(dir == 3)
        toAdd.x += 5;
    else if(dir == 4)
        toAdd.y += 5;

    if(toAdd.x < 0) toAdd.x = 150;
    else if(toAdd.x > 150) toAdd.x = 0;

    if(toAdd.y < 0) toAdd.y = 150;
    else if(toAdd.y > 150) toAdd.y = 0;
    position.add(toAdd);
} 
```

但是，为了使它成为一个简短的、独立的、正确的例子：

```
import javax.swing.JFrame;
import javax.swing.JPanel;
import java.awt.Graphics;
import java.awt.Point;
import java.awt.event.*;
import java.util.ArrayList;

class Snake extends JPanel implements Runnable {
    int x,y;
    boolean horizontal;
    ArrayList<Point> position = new ArrayList<Point>();
    byte dir = 3;

    public Snake(JFrame parent) {
        for(int i = 0; i < 5; i++)
            position.add(new Point(i*5 + 10, 10));

        parent.addKeyListener(new KeyAdapter() {
            public void keyPressed(KeyEvent e) {
                byte change = dir;
                switch (e.getKeyCode()) {
                    case KeyEvent.VK_DOWN:
                        change = 4;
                        break;
                    case KeyEvent.VK_UP:
                        change = 1;
                        break;
                    case KeyEvent.VK_LEFT:
                        change = 2;
                        break;
                    case KeyEvent.VK_RIGHT:
                        change = 3;
                        break;
                }

                changeDirection(change);
            }
        });
        System.out.println("starting thread");
        new Thread(this).start();
    }

    private void changeDirection(byte change) {
        if(change != dir && (change - 2 != dir || change + 2 != dir)) {
            dir = change;
        }
    }

    public void run() {
        for(int i = 0; i != -1; i++){
            try {
                move();
                this.repaint();
                Thread.sleep(1000);
            }
            catch (InterruptedException e) {
                System.out.println("INTERRUPTED");
            }
        }
    }

    private void move() {
        System.out.println(position.size());
        Point toAdd = position.get(position.size() - 1);
        position.remove(0);
        if(dir == 1)
            toAdd.y -= 5;
        else if(dir == 2) 
            toAdd.x -= 5;
        else if(dir == 3)
            toAdd.x += 5;
        else if(dir == 4)
            toAdd.y += 5;

        if(toAdd.x < 0) toAdd.x = 150;
        else if(toAdd.x > 150) toAdd.x = 0;

        if(toAdd.y < 0) toAdd.y = 150;
        else if(toAdd.y > 150) toAdd.y = 0;
        position.add(toAdd);
    }

    public void paintComponent(Graphics g) {
        g.clearRect(0,0,150,150);
        for(Point p : position)
            g.drawRect(p.x, p.y, 5, 5);
    }

    public static void main(String[] args) {
        Snake snake;
        JFrame f = new JFrame("Snake");
        f.setSize(150, 150);
        f.add((snake = new Snake(f)));
        f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        f.setResizable(false);
        f.setVisible(true);
    }
} 
```

运动是我尝试实施的第一件事，我还没有接触到碰撞检测/食物，这不是这里的问题。

我的问题是：

**为什么蛇在缩小而数组列表没有缩小，我该如何修复它，即阻止蛇除了前段之外消失？**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-27T19:41:22.340

好的。这很简单！

您正在更改列表中已经存在的点，`position`最后您将**相同的**点添加到此列表中。您最终会得到越来越多具有相同位置的相同（通过引用）元素。

您应该创建新实例`Point`并将其添加到列表中。

```
Point lastPoint = position.get(position.size() - 1);
    Point toAdd = new Point(lastPoint.x, lastPoint.y); 
```

# asp.net - 禁用 ASP .NET CheckBoxList

> ID：11694437
> 
> 赞同：0
> 
> 时间：2012-07-27T19:27:01.227
> 
> 标签：asp.net, html, cross-browser, internet-explorer-9, checkboxlist

我正在构建一个动态 ASP 表，每个单元格中都有 CheckBoxLists。根据内部情况，应禁用其中一些列表。它适用于 Chrome 和 FF，但不适用于 IE9。我已经逐步完成了禁用的代码，并且 Enabled 属性正确设置为 false，但它无法正确呈现给 IE。有人知道为什么吗？

```
Table optionTBL = new Table();
optionTBL.ID = "optionTBL";
TableRow headerRow = new TableRow();
TableRow listRow = new TableRow();
listRow.VerticalAlign = VerticalAlign.Top;
foreach( string[] iss in issues )
{
    // make a header
    TableHeaderCell cell = new TableHeaderCell();
    string headerTXT = "BLAH";
    cell.Text = headerTXT;
    cell.Width = Unit.Percentage( 33 );
    cell.Height = Unit.Pixel( 1 );
    cell.HorizontalAlign = HorizontalAlign.Center;
    headerRow.Cells.Add( cell );

    // put all the options in the radio list
    CheckBoxList checkLST = new CheckBoxList();
    checkLST.ID = "CKBLST" + iss[ 0 ];
    while( condition )
    {
        // build the issue radios here
        checkLST.Items.Add( new ListItem( "Text", "Value" ) );
    }

    foreach( ListItem li in checkLST.Items )
        li.Attributes.Add( "theValue", li.Value );

    // put the list in a cell in the row in the table
    TableCell cell2 = new TableCell();
    // some formatting
    checkLST.BorderColor = System.Drawing.Color.Black;
    checkLST.BorderStyle = BorderStyle.Solid;
    checkLST.BorderWidth = 1;
    checkLST.Width = Unit.Percentage( 100 );
    // here we disable the check list if needed
    if( needDisabled )
    {
        // disable the list, and check one
        checkLST.Enabled = false;
        checkLST.Items[ alreadySelected ].Selected = true;
    }
    // add the list in the cell
    cell2.Controls.Add( checkLST );
    cell2.Width = Unit.Percentage( 33 );
    // put the cell in the row
    listRow.Cells.Add( cell2 );
}

// put the table in the literal
optionTBL.Height = Unit.Percentage( 100 );
optionTBL.CellPadding = 5;
optionTBL.CssClass = "vote_table";

// here we have all the tables we need, stick em all in the literal on the page
contentPanel.Controls.Add( optionTBL ); 
```

内容面板在 ASPX 中如下所示，是标记中唯一的控件

```
<asp:Panel runat="server" ID="contentPanel" Height="450px" ></asp:Panel> 
```

IE9 的输出

```
<div style="height: 450px;" id="contentPanel">
<table style="height: 100%;" id="optionTBL" class="vote_table" border="0" cellPadding="5">
<tbody><tr>
<th style="width: 33%; height: 1px;" align="center">ballot 1<br>Select 1<br></th><th style="width: 33%; height: 1px;" align="center">ballot 2<br>Select 1<br></th>
</tr><tr vAlign="top">
<td style="width: 33%;"><table style="border: 1px solid black; width: 100%;" id="CKBLST8"" border="0">
<tbody><tr>
<td><span theValue="29"><input id="CKBLST8_0" name="CKBLST8$0" type="checkbox"><label for="CKBLST8_0">Name A</label></span></td>
</tr><tr>
<td><span theValue="30"><input id="CKBLST8_1" name="CKBLST8$1" type="checkbox"><label for="CKBLST8_1">Name B</label></span></td>
</tr><tr>
<td><span theValue="0" WWW="1"><input id="CKBLST8_2" name="CKBLST8$2" type="checkbox"><label for="CKBLST8_2"><input id="writeIn82" value="Write In Candidate" type="text"></label></span></td>
</tr>
</tbody></table></td><td style="width: 33%;"><table style="border: 1px solid black; width: 100%;" id="CKBLST9"" border="0">
<tbody><tr>
<td><span theValue="31"><input id="CKBLST9_0" name="CKBLST9$0" type="checkbox"><label for="CKBLST9_0">Name 1</label></span></td>
</tr><tr>
<td><span theValue="33"><input id="CKBLST9_1" name="CKBLST9$1" type="checkbox"><label for="CKBLST9_1">Name 2</label></span></td>
</tr><tr>
<td><span theValue="0" WWW="1"><input id="CKBLST9_2" name="CKBLST9$2" type="checkbox">   <label for="CKBLST9_2"><input id="writeIn92" value="Write In Candidate" type="text">         </label></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table>
</div> 
```

铬的输出

```
<div id="contentPanel" style="height:450px;">
<table id="optionTBL" class="vote_table" cellpadding="5" border="0" style="height:100%;">
<tbody><tr>
<th align="center" style="height:1px;width:33%;">ballot 1<br>Select 1<br></th><th align="center" style="height:1px;width:33%;">ballot 2<br>Select 1<br></th>
</tr><tr valign="top">
<td style="width:33%;"><table id="CKBLST8" disabled="disabled" border="0" style="border-color:Black;border-width:1px;border-style:Solid;width:100%;">
<tbody><tr>
<td><span disabled="disabled" thevalue="29"><input id="CKBLST8_0" type="checkbox" name="CKBLST8$0" checked="checked" disabled="disabled"><label for="CKBLST8_0">Name A</label></span></td>
</tr><tr>
<td><span disabled="disabled" thevalue="30"><input id="CKBLST8_1" type="checkbox" name="CKBLST8$1" disabled="disabled"><label for="CKBLST8_1">Name B</label></span></td>
</tr><tr>
<td><span disabled="disabled" thevalue="0"><input id="CKBLST8_2" type="checkbox" name="CKBLST8$2" disabled="disabled"><label for="CKBLST8_2"><input type="text" id="writeIn82" value="" disabled="disabled"></label></span></td>
</tr>
</tbody></table></td><td style="width:33%;"><table id="CKBLST9" disabled="disabled" border="0" style="border-color:Black;border-width:1px;border-style:Solid;width:100%;">
<tbody><tr>
<td><span disabled="disabled" thevalue="31"><input id="CKBLST9_0" type="checkbox" name="CKBLST9$0" checked="checked" disabled="disabled"><label for="CKBLST9_0">Name 1</label></span></td>
</tr><tr>
<td><span disabled="disabled" thevalue="33"><input id="CKBLST9_1" type="checkbox" name="CKBLST9$1" disabled="disabled"><label for="CKBLST9_1">Name 2</label></span></td>
</tr><tr>
<td><span disabled="disabled" thevalue="0"><input id="CKBLST9_2" type="checkbox" name="CKBLST9$2" disabled="disabled"><label for="CKBLST9_2"><input type="text" id="writeIn92" value="" disabled="disabled"></label></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table>
</div> 
```

请注意，这只是 ASP 面板的一部分，而不是整个网页

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T23:25:45.140

不要设置属性 enabled=false，而是设置属性 disabled=disabled

```
li.Attributes.Add( "disabled", "disabled" ); 
```

# php - 将多个查询的行合并为一个

> ID：11694438
> 
> 赞同：4
> 
> 时间：2012-07-27T19:27:06.383
> 
> 标签：php, mysql, sql

我正在用 PHP 和 MySQL 构建一个社交媒体新闻聚合 Web 应用程序。它需要将各种 URL（列 url）映射到特定趋势（列trend_id）。这是我的虚拟数据结构：

![样本数据](../Images/d5ed4ebde5794f9ab641238a88a42f14.png)

我需要构建一个查询来获取特定trend_id（例如12）的URL。这很简单：

> `url`从`url_table`哪里选择`trend_id`= '12'

现在，一些趋势与特定的父趋势相关。例如trend_ids 12,16 和45 与父trend_id 12 相关。所以这是我的查询：

> 选择“12”作为`parent_trend_id`，`url`从`url_table`哪里（`trend_id`=“12”或`trend_id`=“16”或`trend_id`=“45”）

这是另一个类似查询的示例：

> 选择“345”作为`parent_trend_id`，`url`从`url_table`哪里（`trend_id`=“345”或`trend_id`=“457”或`trend_id`=“16”）

问题是趋势之间存在多种这样的父子关系。到目前为止，我在 PHP 中运行了一个 for 循环并执行多个查询。此外，鉴于我的应用程序的性质，父趋势不能成为此表的一部分。有没有办法让一个查询包含多个这样的查询？

**编辑：**

我有一个单独的表来定义~~子~~关系。这是一个简单的 3 列表，具有 ID、trend_id（父）和 related_trend_id（子）。但是，一个related_trend_id（子）可以有多个trend_id（父）。这是关系表的快照：

![关系表样本数据](../Images/12902113984212aeaf75b3f4cac112f9.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T19:30:31.867

您的具体查询现在是：

```
SELECT r.trend_id as parent_trend_id,url 
FROM url_table
Join relations r on r.related_trend_id = childid
WHERE r.trend_id = 12 
```

或全部获取

```
SELECT r.trend_id as parent_trend_id,url 
FROM url_table
Join relations r on r.related_trend_id = childid 
```

完全符合我的预期：

[http://sqlfiddle.com/#!3/b137a/9](http://sqlfiddle.com/#!3/b137a/9)

你期待什么结果？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T19:34:52.740

加入包含父子关系的表？

```
SELECT url_table.*
FROM url_table
INNER JOIN parents
    ON url_table.trend_id = parents.trend_id
WHERE parents.parent_id IN (1,2,3); 
```

`(1,2,3)`是您要为其提取元组的所有父趋势。

# actionscript-3 - 如何通过仅允许受信任的域来保护 API？

> ID：11694443
> 
> 赞同：1
> 
> 时间：2012-07-27T19:27:29.423
> 
> 标签：actionscript-3, api, codeigniter, security

## 问题

如何通过仅允许受信任的域来保护 API？

## 细节

我正在构建一个 REST API。我需要一种分发 API 密钥的方法，但只允许它们在注册的域中工作。

主要问题是我的 API 密钥需要嵌入到一个 Flash 文件中，该文件很容易被反编译以窃取 API 密钥。如果 Flash 使这成为不可能，我可以改用 Javascript。

我听很多人说用`$_SERVER['HTTP_REFERER']`。但这很容易被欺骗。

*   如何构建 API 以确保请求来自允许的域？
*   如何创建绑定到域的 API 密钥？
*   如何通过仅允许受信任的域来保护 API？

## 相关的 Stackoverflow 问题：

这些问题是相关的，但并没有完全回答我的问题。想我会把它们放在这里以供将来参考。

*   [Google API 密钥和域检查](https://stackoverflow.com/questions/2113215/google-api-key-and-domain-check)
*   [谷歌地图如何保护他们的 API 密钥？如何制作类似的东西？](https://stackoverflow.com/questions/2256305/how-does-google-maps-secure-their-api-key-how-to-make-something-similar)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T20:52:56.190

JavaScript 在这里帮不了你——问题是密钥存储在客户端上，这意味着它不安全。您当然可以让攻击者更难一些（例如，就像您说检查引荐来源网址），但归根结底，所有服务器都可以验证密钥是否正确，并且由于密钥很容易被盗，那就是不是很有帮助。

可以保护这种情况的方法是让私钥在您提供给它们的任何人的服务器上运行，而不是在客户端中运行。根据您的需要，这可能不可行。

使攻击者更难的一种可能性是使用站点锁定技术，仅当 SWF 位于适当的域上时才允许它调用 API。有关示例，请参见[http://blog.boogatech.com/as3_tutorial_site-locking_your_flash_project/ 。](http://blog.boogatech.com/as3_tutorial_site-locking_your_flash_project/)但是请注意，这是*客户端*安全 - 站点锁定的目标通常只是阻止人们在其他站点上玩您的游戏（即使这样也无法阻止最敬业的攻击者）。在您的情况下，您正在处理服务器安全性 - 服务器不知道 SWF，它只知道它正在输入的参数，因此攻击者可以绕过 SWF 和客户端安全性并从其他地方调用 API .

我建议您考虑一下您要阻止的攻击和攻击者（为什么必须将 API 密钥绑定到域？）。这将帮助您更好地计划安全尝试。例如，如果你没有运行一个超关键的 API，你可以决定加入一些东西来让攻击者更难访问 API，因为你无法阻止一个非常专注的攻击者.

# django - 为 django 寻找电子表格（或表格）视图

> ID：11694445
> 
> 赞同：2
> 
> 时间：2012-07-27T19:27:32.320
> 
> 标签：django, spreadsheet

请原谅这个愚蠢的问题，但是我在哪里可以找到 Django 以类似电子表格的格式显示“表格”的视图（即每行一条记录，每列一个字段）。

（经过一番搜索后我找不到一个的事实告诉我，也许我对 Django 视图的菜鸟级别的理解太离谱了。）

在这里，我打算使用“表格”一词相当笼统。基本上，将表视为“列表列表”，附加约束是所有内部列表具有相同的长度。

（如果此表具有电子表格功能会很棒，例如可以通过单击列标题对行进行排序，或者剪切和粘贴单元格的任意矩形子集，但我意识到这可能希望太多.)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-27T14:43:05.417

另一种方法是使用表格内联，但您正在寻找列表视图。

# wcf - 较大请求的 WCF SOAP 错误

> ID：11694449
> 
> 赞同：0
> 
> 时间：2012-07-27T19:27:50.463
> 
> 标签：wcf, web-services, binding

我需要从第三方托管的 Web 服务下载几十万个实体。Web 服务允许我每次调用 Web 服务最多下拉 2,000 个实体，但实际上我一次只能下拉 50-75 个实体，因为当我调用更多记录时会收到间歇性错误。我正在尝试确定问题是否是由于我需要调整的设置，或者问题是否与第 3 方网络服务提供商有关。这是我收到的错误：

> 接收对 [https://some.vendor.com/API/SomeService.svc](https://some.vendor.com/API/SomeService.svc)的 HTTP 响应时出错。这可能是由于服务端点绑定未使用 HTTP 协议。这也可能是由于服务器中止了 HTTP 请求上下文（可能是由于服务关闭）。有关更多详细信息，请参阅服务器日志。

以下是我用于绑定 Web 服务的应用程序配置设置的副本：

```
<system.serviceModel>
    <bindings>
        <customBinding>
            <binding name="SomeService">
                <security defaultAlgorithmSuite="Default" authenticationMode="UserNameOverTransport"
                    requireDerivedKeys="true" securityHeaderLayout="Strict" includeTimestamp="true"
                    keyEntropyMode="CombinedEntropy" messageSecurityVersion="WSSecurity11WSTrustFebruary2005WSSecureConversationFebruary2005WSSecurityPolicy11BasicSecurityProfile10">
                    <localClientSettings cacheCookies="true" detectReplays="false"
                        replayCacheSize="900000" maxClockSkew="00:05:00" maxCookieCachingTime="Infinite"
                        replayWindow="00:05:00" sessionKeyRenewalInterval="10:00:00"
                        sessionKeyRolloverInterval="00:05:00" reconnectTransportOnFailure="true"
                        timestampValidityDuration="00:05:00" cookieRenewalThresholdPercentage="60" />
                    <localServiceSettings detectReplays="false" issuedCookieLifetime="10:00:00"
                        maxStatefulNegotiations="128" replayCacheSize="900000" maxClockSkew="00:05:00"
                        negotiationTimeout="00:01:00" replayWindow="00:05:00" inactivityTimeout="00:02:00"
                        sessionKeyRenewalInterval="15:00:00" sessionKeyRolloverInterval="00:05:00"
                        reconnectTransportOnFailure="true" maxPendingSessions="128"
                        maxCachedCookies="1000" timestampValidityDuration="00:05:00" />
                    <secureConversationBootstrap />
                </security>
                <textMessageEncoding maxReadPoolSize="64" maxWritePoolSize="16"
                    messageVersion="Soap11" writeEncoding="utf-8">
                    <readerQuotas maxDepth="32" maxStringContentLength="8192" maxArrayLength="16384"
                        maxBytesPerRead="4096" maxNameTableCharCount="16384" />
                </textMessageEncoding>
                <httpsTransport manualAddressing="false" maxBufferPoolSize="2147483647"
                    maxReceivedMessageSize="2147483647" allowCookies="false" authenticationScheme="Anonymous"
                    bypassProxyOnLocal="false" decompressionEnabled="true" hostNameComparisonMode="StrongWildcard"
                    keepAliveEnabled="true" maxBufferSize="2147483647" proxyAuthenticationScheme="Anonymous"
                    realm="" transferMode="Streamed" unsafeConnectionNtlmAuthentication="false"
                    useDefaultWebProxy="true" requireClientCertificate="false" />
            </binding>
        </customBinding>
    </bindings>
    <client>
        <endpoint address="https://secure.Some.com/API/1.2/Service.svc"
            binding="customBinding" bindingConfiguration="SomeService"
            contract="SomeService.SomeService" name="SomeService" />
    </client>
</system.serviceModel> 
```

正如您在应用程序配置绑定中看到的，我将 maxBufferPoolSize、maxReceivedMessageSize 和 maxBufferSize 增加到 2147483647。我还将 transferMode 更改为 Streamed。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T20:48:54.997

还有一个重要的设置可以通过添加一个行为来设置：

```
<behaviors>
  <endpointBehaviors>
    <behavior name="SomeBehavior">
      <dataContractSerializer maxItemsInObjectGraph="2147483647" />
    </behavior>
  </endpointBehaviors>
</behaviors> 
```

然后，更新您的端点：

```
<client>
  <endpoint address="https://secure.Some.com/API/1.2/Service.svc"
     binding="customBinding" bindingConfiguration="SomeService"
     contract="SomeService.SomeService" name="SomeService"
     **behaviorConfiguration="SomeBehavior"**/>
</client> 
```

# linux - Oracle Linux 服务器上的 phpmyadmin

> ID：11694451
> 
> 赞同：0
> 
> 时间：2012-07-27T19:27:56.377
> 
> 标签：linux, oracle, phpmyadmin

我是开源世界的新手。总是习惯于付费我无法想象我们可以免费获得整个操作系统！尽管如此，像甲骨文这样的知名公司，我被卖了！好的，所以我安装了 Oracle Linux 服务器 6.1 并且运行良好。我还在安装过程中检查了 webserver 和 MySQl 下的所有框，当我在浏览器上键入 localhost 并且我已经启动了 Apache 和 MySql 服务时，我可以看到 Apache 主页。

我的问题：是否有像 phpmyadmin 这样的基于 GUI 的管理工具来管理已安装的 MySql DB？如果没有，有人可以指出我的分步指南。自过去 4 天以来我一直在尝试，但我无法理解如何执行此操作以及需要什么？我还看到一些帖子说可以使用 Oracle Enterprise Manager 之类的东西，我们可以通过它来管理数据库，但我就是不知道如何进入控制台？是否有 locahost url 或其他东西可以让它工作？

最后，我要做的就是在 Linux 服务器上运行 Drupal，并能够使用 phpmyadmin 管理数据库，如果一切都很复杂，我可以只安装 LAMP 或 XXAMP，这将一次性给我所需的一切。虽然我觉得安装操作系统时已经安装了 Apache 和 MySQL，但不确定会发生什么。

我知道我到处都是，从 Windows 过渡，对此我真的很陌生。任何帮助将不胜感激。

谢谢，KK

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T23:29:32.260

Oracle Enterprise Linux 基于 Red Hat 源代码，就像 CentOS 一样。

找到了一个关于如何使用 CentOS 6 进行设置[的链接，该链接应该适用于 OEL。](http://pritisolanki.wordpress.com/2012/01/10/install-phpmyadmin-on-centos-6/)

# asp.net-mvc-3 - 在客户端缓存/查找 MVC 部分视图的模式

> ID：11694453
> 
> 赞同：2
> 
> 时间：2012-07-27T19:27:58.863
> 
> 标签：asp.net-mvc-3, caching, jquery, asp.net-mvc-partialview

这是我的场景。我正在调用一个指向返回部分视图的控制器方法的 url：

控制器方法：

```
public ActionResult UserProfile() { return View("UserProfile"); } 
```

获取视图的 Ajax 请求：

```
$.get('/Home/UserProfile', function (data) { $('.content').html(data); }); 
```

我想缓存我的“UserProfile”视图，以便每次用户单击它时，它不必返回服务器再次从控制器获取视图。

我还希望能够在从服务器获取视图之前确定视图是否已缓存在客户端上，如果有，请将其从缓存中取出并简单地将其注入到我的布局中的 div 中。

有没有人做过这样的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-28T07:14:45.663

您可以使用该[`[OutputCache]`](http://msdn.microsoft.com/en-us/library/system.web.mvc.outputcacheattribute.aspx)属性。它允许您指定要缓存视图的持续时间以及缓存的位置。例如，假设您想在客户端浏览器上缓存控制器操作的结果 30 秒：

```
[OutputCache(Duration = 30, Location = OutputCacheLocation.Client)]
public ActionResult UserProfile() 
{ 
    return PartialView(); 
} 
```

现在您可以触发许多 AJAX 请求，但 30 秒内只有一个会发送到服务器：

```
window.setInterval(function () {
    $.get('/Home/UserProfile', function (data) {
        $('.content').html(data);
    });
}, 4000); 
```

# css - 网站上线时不会出现悬停在图片上

> ID：11694455
> 
> 赞同：0
> 
> 时间：2012-07-27T19:28:06.133
> 
> 标签：css, hover

因此，当在我的计算机上本地使用此站点时，将鼠标悬停在图像上时效果很好。但是，当我将网站放在服务器上时，图像不会出现。

我指的是带有灰色背景图像的链接。我专门为联系我们链接提供了 css。

[http://bankruptcyimmigrationlaw.com/NEWSTARTLAW/Home.html](http://bankruptcyimmigrationlaw.com/NEWSTARTLAW/Home.html)

```
...

#Contact_us li:first-child a {
padding:9px 5px 15px 30px;
margin-top:25px;
background-image:url(../images/DefaultNavBg.png);
background-position:-30px -15px;
background-repeat:no-repeat;
height:76px;
width:350px;
border-bottom:none;
text-decoration:none;
}

#Contact_us li:first-child a:hover {
padding:9px 5px 0px 15px;
margin-top:25px;
background-image:url(../images/CurrentNavBg.png);
background-position:-30px -15px;
background-repeat:no-repeat;
height:76px;
width:350px;
border-bottom:none;
cursor:pointer;
text-decoration:none;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T19:34:57.147

看来您的图像不是您认为的位置，我收到 404。可能是您没有上传它，或者如果您在 Windows 上进行测试并部署到 *Nix，这可能是案例的问题文件（或目录）的名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T19:35:18.580

您没有将图像发送到服务器：

[http://bankruptcyimmigrationlaw.com/NEWSTARTLAW/images/CurrentNavBg.png](http://bankruptcyimmigrationlaw.com/NEWSTARTLAW/images/CurrentNavBg.png)

返回 404

提示：将 webbrowser 与一些王者`inspector`- 例如`Chrome`带有内置检查器或`Firefox`+的示例一起使用`Firebug`是每个网站管理员、webdevloper、webdesigner 等的最佳朋友。

**编辑**

尽量避免`CaseMixing`使用所有文件名和路径。这是错误和错误的非常原因，因此使用相同的小写变体肯定更好。

我最喜欢的符号`is_lower_case_underscored.jpg`，

使用 hypen 是另一种推荐的方式，但是在使用 JavaScript 创建文件名时可能会出错，因为 hypen 可能会`minus operator`被意外识别。

# glsl - 如何使用 Open GL ES 2.0 或 WebGL 创建雾？

> ID：11694458
> 
> 赞同：3
> 
> 时间：2012-07-27T19:28:15.163
> 
> 标签：glsl, opengl-es-2.0, webgl

我想为我的游戏创建雾效果，但我找不到任何关于如何使用 OpenGL ES 2.0 的教程。如果有人有教程链接，可以提供解释或源代码，我将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-27T22:12:13.337

在第 224 页的 OpenGL ES 2.0 编程指南中有一个关于使用着色器复制固定功能雾的部分。源代码可在 google 代码项目（MIT 许可证）中获得。这是一个巨大的 rendermonkey XML 文件，但[其中嵌入的着色器源非常简单](https://github.com/danginsburg/opengles-book-samples/blob/master/Windows/Chapter_10/RM_LinearFog/LinearFog.rfx)（我会直接在这里复制它，但不确定是否可以）。

这个想法是使用到特定像素的距离作为某些雾函数的输入。在该示例中，他们在顶点着色器中计算眼睛到顶点的距离，然后通过将其作为变量传递来提供到每个片段的插值距离。

然后他们做了一个简单的线性雾函数。有一些最小距离会出现零雾色，还有一些最大距离会输出所有雾色。您可以通过像素距离介于最大值和最小值之间的位置混合（线性插值）雾色和片段颜色。

正如书中提到的，一旦你完成了这项工作，就没有理由将自己限制在线性雾中。您可以轻松地使其指数化，依赖于其他变量（例如到地板的距离，由于纹理查找或噪声函数引起的变量），通过它制作神光等。

从您的问题中不清楚您到底在追求什么，因此，如果您想变得真正充满活力，那就是另一回事了（并不总是值得为获得的效果付出开发努力和性能成本）。对于现有的 WebGL 代码，您可以尝试类似[黑色三梦的加载屏幕，您可以在](http://www.ro.me/)[源代码](http://code.google.com/p/3-dreams-of-black/)中的某个位置找到它，或者您可以通过[将雾实际建模为 3d 流体](http://http.developer.nvidia.com/GPUGems3/gpugems3_ch30.html)来进行更多的模拟。

# c++ - 模板扣减失败

> ID：11694461
> 
> 赞同：1
> 
> 时间：2012-07-27T19:28:26.413
> 
> 标签：c++, templates

谁能解释为什么这不起作用：

```
#include "itkCovariantVector.h"
#include "itkImage.h"

template <typename TComponent, int NumberOfComponents>
void FillImage(itk::Image<itk::CovariantVector<TComponent,
NumberOfComponents>, 2>* const image,
               itk::Image<itk::CovariantVector<TComponent,
NumberOfComponents>, 2>* const output)
{
  std::cout << "Works." << std::endl;
}

int main(int, char* [] )
{
  typedef itk::Image<itk::CovariantVector<float, 3u>, 2u> ImageType;

  ImageType::Pointer imageSmartPointer = ImageType::New();
  ImageType* image = imageSmartPointer.GetPointer();
  FillImage(image, image);
  return 0;
}
/*
no matching function for call to ‘FillImage(ImageType*&, ImageType*&)’
note: candidate is:
template<class TComponent, int NumberOfComponents> void
FillImage(itk::Image<itk::CovariantVector<TComponent,
NumberOfComponents>, 2u>*, itk::Image<itk::CovariantVector<TComponent,
NumberOfComponents>, 2u>*)
*/ 
```

这些类模板的定义是：[http://www.itk.org/Doxygen/html/classitk_1_1CovariantVector.html](http://www.itk.org/Doxygen/html/classitk_1_1CovariantVector.html) http://www.itk.org/Doxygen/html/classitk_1_1Image.html

我用非 ITK 类创建了相同的情况，并且它工作正常：

```
#include <iostream>

template <typename TPixel, int Dimensions>
struct Image
{
};

template <typename TComponent, int NumberOfComponents>
struct Vector
{
};

template <typename TComponent, int NumberOfComponents>
void FillImage(Image<Vector<TComponent, NumberOfComponents>, 2 >* const image,
               Image<Vector<TComponent, NumberOfComponents>, 2 >* const output)
{
  std::cout << "Works." << std::endl;
}

int main(int, char* [] )
{
  typedef Image<Vector<float, 3>, 2 > ImageType;

  ImageType* image = new ImageType;
  FillImage(image, image);
  delete image;
  return 0;
} 
```

谁能解释可能有什么区别？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T20:44:03.960

问题是我必须将签名从更改为`<int NumberOfComponents>`以`<unsigned int NumberOfComponents>`匹配 ITK 类的定义。

```
#include <iostream>

template <typename TPixel, int Dimensions>
struct Image
{
};

// The deduction works with this
// template <typename TComponent, int NumberOfComponents>
// struct Vector
// {
// };

// The deduction does NOT work with this (unsigned int vs int above)
template <typename TComponent, unsigned int NumberOfComponents>
struct Vector
{
};

template <typename TComponent, int NumberOfComponents>
void FillImage(Image<Vector<TComponent, NumberOfComponents>, 2 >* const image,
               Image<Vector<TComponent, NumberOfComponents>, 2 >* const output)
{
  std::cout << "Works." << std::endl;
}

int main(int, char* [] )
{
  typedef Image<Vector<float, 3>, 2 > ImageType;

  ImageType* image = new ImageType;
  FillImage(image, image);
  return 0;
} 
```

# java - Java在Android中重用java类

> ID：11694462
> 
> 赞同：0
> 
> 时间：2012-07-27T19:28:34.657
> 
> 标签：java, android, class, reusability

我想知道是否可以将我用 J2ME 制作的一些类与 android 项目一起使用？例如，我有一个将 ip 作为参数并使用 java 套接字和线程扫描该 ip 的开放端口的类。那么我可以在不修改它的情况下将它与我的 android 项目一起使用吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T19:33:30.077

Android J2ME 运行程序允许现有的 J2ME 应用程序在 Android 平台上运行。您也不应该需要修改您的源代码。请参阅[此处](http://www.renjusblog.com/2010/09/install-jar-files-android-j2me-runner.html)了解更多信息。

# mysql - 我有 2 个查询，我想在第二个查询中使用第一个查询的结果

> ID：11694463
> 
> 赞同：-1
> 
> 时间：2012-07-27T19:28:41.430
> 
> 标签：mysql, sql

我有 2 个查询，我想在第二个查询中使用第一个查询的结果。第一个查询是这样的：

> 从“关于我们”之类的类别中选择 ID

假设这个返回**Cat_id = 2**

现在在我的第二个查询中，我需要使用第一个查询 EG 的结果：我需要使用 id（在查询 1 中返回）进入关于我们的子类别

第二个查询是这样的：

> 插入 sub_cat VALUES(NULL, **2** ,History) INTO(subCat_id, Cat_id, 'name')

那么如何将第一个 SQL 查询中返回的值用于我的第二个查询

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T19:33:18.093

您可以在查询中使用子`INSERT`查询：

```
INSERT INTO sub_cat (subCat_id, Cat_id, `name`)
VALUES (NULL, (SELECT id FROM category WHERE name = 'About Us'), 'History'); 
```

这假定您没有多个具有相同名称的类别。如果您的表*确实*有同名的类别，您可以`LIMIT 1`在子查询中添加一个，或者使用`INSERT INTO .. SELECT`他的回答中提到的 Stefan H. 之类的语句：

```
INSERT INTO sub_cat (subCat_id, Cat_id, `name`) (
    SELECT NULL, id, 'History' FROM category WHERE name = 'About Us'
) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T19:33:02.057

INSERT INTO SELECT 是您想要的查询

```
INSERT into 
    sub_cat 
SELECT 
    NULL AS subCat_id,
    Cat_id,
    'name' as History
FROM
    Category
Where 
    YourColumn like 'About Us' 
```

# javascript - jquery组合多个选择器

> ID：11694467
> 
> 赞同：0
> 
> 时间：2012-07-27T19:28:59.237
> 
> 标签：javascript, jquery, html

```
alert($('.input-large[name="name"]:parent:parent').html()); 
```

我的html是：

```
<div class="control-group">
    <label for="name" class="control-label">Clinic Name</label>
    <div class="controls">
       <input type="text" name="name" id="name" class="input-large" value="">
    </div>
</div> 
```

我在警报中得到空值。如何找到输入元素的父级的父级？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T19:30:51.560

尝试

```
alert( $('#name').parent().parent().html() ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T19:36:22.553

对于所有`input-large[name=name]`元素：

```
$(".input-large[name=name]").each(function(){
    alert($(this).parent().parent().html());
}); 
```

但是话又说回来，这将为您提供每个实例的警报。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-27T19:38:55.287

你可以像其他人一样做 parent().parent() 链，或者只是将父选择器传递给 .parents() 以获得更清晰的链，如下所示：

```
alert( $('#name').parents('.control-group').html() ); 
```

# sql-server - sql server 2008 SP2 中 sqlcmd 的替代方案

> ID：11694469
> 
> 赞同：2
> 
> 时间：2012-07-27T19:29:02.817
> 
> 标签：sql-server, sql-server-2008, sqlcmd

sqlcmd 实用程序是否有任何替代方法可以从 .sql 文件创建数据库？

由于表数据列中存在字符，我收到这些语法错误。我的 .sql 文件大小为 8GB，即使我可以修复 sqlcmd 认为不好的记录，如果有更多记录包含包含 % 符号或“（”等数据的列，则需要一段时间来保存并重新打开文件, sqlcmd 不喜欢。我使用了 On Error Ignore 指令，但这并没有太大帮助。

这是我关于同一问题的另一篇文章：

[sqlcmd 在解析我的 .sql 文件时遇到错误](https://stackoverflow.com/questions/11620594/sqlcmd-runs-into-error-while-parsing-my-sql-file)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-09-26T19:39:57.190

这是我的自定义解决方案。它只是一个可以执行巨大 .sql 文件的 powershell 脚本。

```
$filePath = "GiganticFile.sql";
$stream = [System.IO.File]::OpenText($filePath);
$connection = New-Object System.Data.SqlClient.SqlConnection;
$connection.ConnectionString = "Persist Security Info=True;User ID=<user>;Password=<password>;Initial Catalog=<database>;Data Source=<server>";
$connection.Open();
$command = New-Object System.Data.SqlClient.SqlCommand;
$command.Connection = $connection;
$statement = "";
$statementsProcessed = 0;
$totalBytes = (New-Object System.IO.FileInfo($filePath)).Length;
$bytesProcessed = 0;

while (-not $stream.EndOfStream) {
    $line = $stream.ReadLine();
    $bytesProcessed += $line.Length;
    if ($line.Trim() -eq "GO") {
        try {
            $command.CommandText = $statement;
            [void]$command.ExecuteNonQuery();
            $statement = "";
            "{0} statements processed ({1:f} MB) - {2:f}%" -f (++$statementsProcessed), ($bytesProcessed / 1024 / 1024), ($bytesProcessed / $totalBytes * 100);
        }
        catch {
            "!!! ERROR !!!";
            $Error;
        }
    }
    else {
        $statement += $line + [Environment]::NewLine;
    }
}    
$stream.Close(); 
```

输出样本：

```
137238 statements processed (544.54 MB) - 7.57%
137239 statements processed (544.55 MB) - 7.57%
137240 statements processed (544.56 MB) - 7.57%
137241 statements processed (544.57 MB) - 7.57%
137242 statements processed (544.58 MB) - 7.57%
137243 statements processed (544.59 MB) - 7.57%
137244 statements processed (544.60 MB) - 7.57%
137245 statements processed (544.61 MB) - 7.57%
137246 statements processed (544.63 MB) - 7.58%
137247 statements processed (544.64 MB) - 7.58%
137248 statements processed (544.65 MB) - 7.58%
137249 statements processed (544.66 MB) - 7.58%
137250 statements processed (544.67 MB) - 7.58%
137251 statements processed (544.68 MB) - 7.58%
137252 statements processed (544.69 MB) - 7.58%
137253 statements processed (544.70 MB) - 7.58% 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-07-11T09:12:34.207

有一个免费工具“SQLS *Plus”（在[http://www.memfix.com](http://www.memfix.com)上），它类似于*用于 SQL Server 的 Oracle SQL Plus。适用于所有 SQL Server 版本。它应该完成这项工作。

# histogram - IDL 累积直方图

> ID：11694470
> 
> 赞同：1
> 
> 时间：2012-07-27T19:29:04.880
> 
> 标签：histogram, idl-programming-language

我有一个数据数组，我想在 IDL 中用它制作一个累积直方图。是否有可以在 HISTOGRAM、PLOTHIST、PHIST 或 HISTO 命令上使用的输入来为我执行此操作？如果有，我该如何使用它？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-28T05:04:32.007

尝试`CUMULATIVE`关键字`TOTAL`：

```
IDL> x = randomu(seed, 1000) * 100.
IDL> h = histogram(x, binsize=10)  
IDL> ch = total(h, /cumulative, /preserve_type)        
IDL> plot, ch, psym=10 
```

# jquery - 垂直小时标签

> ID：11694472
> 
> 赞同：4
> 
> 时间：2012-07-27T19:29:07.677
> 
> 标签：jquery, html, css

有没有类似 hr 标签的东西，但在垂直意义上？

我不想使用表格，但基本上我有两个选项卡，并且我希望在选项卡的标题之间有一条线。

这是一个快速的[jsfiddle](http://jsfiddle.net/tprats108/r7rzt/14/)。

编辑：新版本的[jsfiddle](http://jsfiddle.net/r7rzt/40/)使用border-right

编辑：[足够接近！](http://jsfiddle.net/r7rzt/50/)但是，如果我将 padding-top = 10 放在friendsH 和familyH 中而不是标题中，由于某种原因它可以完美地工作，但是事情并没有垂直居中，所以我认为我更喜欢这种方式

[这](https://stackoverflow.com/questions/4295558/vertical-rule-as-opposed-to-hr-in-css)似乎是一种黑客方法，但如果这是唯一的方法，那么我想这只是同一个问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-27T19:33:40.827

是的你可以。`<hr style="display: inline" />`将导致垂直规则。

（不过，在 IE7 中失败，因此您可能需要对样式进行条件注释以隐藏它或将其替换为`|`）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-27T19:31:59.697

没有“垂直”小时标签。您可以使用“border-left”和“border-right”css 属性来获得这样的效果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-27T19:32:26.880

HTML 没有任何原生内容。您可以使用 CSS 创建一些东西，例如使用非常窄的 div，例如仅在一侧有边框或图像背景。如果您使用 jquery，您可能会找到一个插件来执行此操作，但它可能具有更多功能，例如允许用户拖动和调整划分区域的大小。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-27T20:59:13.933

这个怎么样：

[http://jsfiddle.net/tprats108/r7rzt/14/](http://jsfiddle.net/tprats108/r7rzt/14/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-01-22T18:31:02.947

我最近学到了一个技巧，它会产生一个垂直的`<hr>`：

```
<hr width="1" size="500" style="display:inline-block;"> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-09-20T12:35:48.763

没有垂直 hr 标签，但是您可以使用 css 制作垂直 hr

```
.vhr {
  width: 1px;
  height: 200px;

  }
```

```
<div class="v-hr"></div>
```

# jdbc - ColdFusion JDBC 连接字符串问题

> ID：11694476
> 
> 赞同：0
> 
> 时间：2012-07-27T19:29:21.477
> 
> 标签：jdbc, coldfusion

我正在尝试将第 3 方 JDBC 驱动程序设置为数据源，但我在 CFAdmin 的连接字符串字段中输入的内容似乎并不重要，它似乎根本没有使用它。

```
User=user@account.com;Password=!password; 
```

出错了`Login failed: You must provide a user and password to login.`

我尝试将随机文本放入连接字符串字段中，期望它会出错，但也没有任何反应。

我想知道我是否输入了错误的数据（我也尝试了使用 jdbc: 的整个连接字符串，但这也不起作用）或者是否有某种方法可以验证 ColdFusion 尝试使用的整个连接字符串。

我没有在我的 cfquery 标签中尝试任何特别的东西：`<cfquery name="output" datasource="mySource">`所以这不应该是问题。我可以通过在 cfquery 标记中硬编码这些值来解决用户/密码问题，但是我还需要提供第三个键作为连接值。

问题不应该出在我的连接字符串上，因为以下内容适用于纯 Java：

`conn = DriverManager.getConnection("jdbc:mydriver:User=user;Password=password;AccessToken=accessToken;");`

.

一个有趣的补充……ColdFusion 似乎根本不在乎我的 URL 末尾的内容，只要开头是正确的……

`jdbc:mydriverrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrr:`

给出用户名/密码错误。然而：

`jdbc:mydriveer:`

给我一个“找不到驱动程序”错误。

.

编辑：我在 CF9 中也遇到过这个问题，所以这不仅仅是 CF10 的问题

.

编辑：我可以在 CF 数据源设置中设置用户名/密码，但它似乎仍然忽略了我放在 URL 末尾或连接字符串中的任何内容（仍然需要 AccessToken）。

.

编辑：我尝试了 DSNless 连接： http: [//www.hostmysite.com/support/cfusion/dsnless/](http://www.hostmysite.com/support/cfusion/dsnless/)但它的行为类似于 CFAdmin，而它忽略了连接字符串部分。

`Login failed: You must provide a user and password to login.`

..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-28T07:08:18.223

我不知道`DataSource`您使用的是什么实现，但 DataSources 有自己的 javabeans 风格的属性，包括`user`和`password`. 您可能需要使用这些而不是提供带有 URL 的属性。

# nhibernate - NHibernate Fetch 返回错误的行数

> ID：11694480
> 
> 赞同：3
> 
> 时间：2012-07-27T19:29:48.800
> 
> 标签：nhibernate

我在我的项目中设置了一个 API，用于调用网格以获取审核记录以显示给管理员。网格具有无限滚动设置并使用 mvc4 内置的 oData。因此，它将调用 api，其中 $top 等于它应该获取的行数，并且 $skip 设置为到达正确的页面。

在 API 内部，我调用 nhibernate 来获取 IQueryable 以返回 MVC4 来执行它的黑暗 oData 魔法：

`m_session.Query<AuditInfo>().FetchMany(x => x.Parameters).Fetch(x => x.AuditType).Fetch(x => x.Status)`

在此，AuditInfo 有一组参数，以及类型和状态的查找表。

我的问题是，如果我要求 30 行，它将返回一些数字 <= 30。我已经能够稍微追踪一下，问题似乎是 nhibernate 在同一个查询中有`TOP`and`JOIN`语句，所以当一个审计有多个参数时，它会创建一份审计副本来保存第二个参数以返回它。这样做会占用查询允许的 TOP(30) 中的空间。然后，当它回到休眠状态时，它似乎合并了这些行，给我留下了一个记录比我想要的少的集合。

我的问题是：**如何设置此调用，以便获得准确数量的记录，而无需单独获取参数并进行 n+1 查询？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T13:02:52.593

基本上你不容易，因为这就是 sql 的工作方式。省略 FetchMany，它应该使用 Select N+1 工作。为了解决这个问题，您可以调整集合批量大小，以便 NH 一次加载多个相同类型的集合。

# jquery - iframe 中的颜色框内容（定位）问题

> ID：11694481
> 
> 赞同：1
> 
> 时间：2012-07-27T19:29:58.377
> 
> 标签：jquery, html, css, iframe, colorbox

我会尽力解释这个问题。

我已经完成并提交了一个项目，该项目使用 colorbox（一种灯箱类型脚本，供尚未使用它的人使用）在用户单击链接时显示信息。

获得我的工具的团队将其加载到他们主页上的 iframe 中。根据他们告诉我的情况，颜色框的位置很奇怪，具体取决于 iframe 中内容的大小。

如果内容是“短”的，那么颜色框会很好地显示（关于它的定位方式）。如果 iframe 中的内容“长”，则颜色框不正常……用户必须进行大量滚动才能真正看到颜色框内容。

下面的代码片段：

```
$(document).ready(function() {
    $(".iframe").colorbox({iframe:true, width:"80%", height:"80%"});
}); 
```

然后在我的HTML中我有这个：

```
<a class="iframe" href="http://LINK TO AN EXTNERAL PAGE">BLAH</a> 
```

关于如何使它在 iframe 中很好地工作（位置）的任何想法？我在想，对于初学者来说，colorbox js 和 css 需要添加到父页面（将我的工具加载到 iframe 中的页面）。

如果有人可以帮助我，我会很感激。抱歉，如果我没有提供足够的信息，或者我所写的内容没有意义。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T07:41:19.557

您可能应该从外部调用 colorbax。请查看此链接： [Controlling Colorbox position inside an iframe](https://stackoverflow.com/questions/7307362/controlling-colorbox-position-inside-an-iframe)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T19:35:34.907

颜色框主要位于页面的中心。但是当给出 (xx)% 的高度百分比宽度时，这可能会有所不同。也许您可以尝试给它一个 (xx)px 高度并尝试一下。

# tfs - 无法通过 Jenkins 插件登录到 TFS

> ID：11694493
> 
> 赞同：4
> 
> 时间：2012-07-27T19:31:05.850
> 
> 标签：tfs, continuous-integration, hudson, jenkins

我正在尝试轮询我的 TFS 存储库中的更改。

> 服务器网址：http: [//SERVER.com :8080/tfs/](http://SERVER.com:8080/tfs/)
> 
> 项目路径：$/QA TFS 项目
> 
> 登录名：DOMAIN\AaronH

当我运行作业时，我收到此错误：

> TF31002：无法连接到此 Team Foundation Server：http://SERVER.com:8080/tfs/ [Team](http://SERVER.com:8080/tfs/) Foundation Server 网址： http: [//SERVER.com](http://SERVER.com:8080/tfs/) :8080/tfs/ 。
> 
> 失败的可能原因包括：
> 
> > *   Team Foundation Server 的名称、端口号或协议不正确。
> > *   Team Foundation Server 处于脱机状态。
> > *   密码已过期或不正确。

我可以通过具有相同凭据的浏览器登录该站点。我迷路了，我对 Jenkins 设置相当陌生。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-27T20:20:09.003

指定包含项目集合的 URL。例如：

```
http://SERVER.com:8080/tfs/DefaultCollection 
```

# c# - 使用 C#“输出参数”嵌入单声道

> ID：11694499
> 
> 赞同：12
> 
> 时间：2012-07-27T19:31:18.813
> 
> 标签：c#, c, mono, mono-embedding

我正在尝试使用 libmono 在 C 应用程序中嵌入 C# 类，但文档有点缺乏。

我正在尝试使用原型调用方法`void MessageToSend(out MessageObject message);`

我如何表示“输出参数”？它是指向 MonoObject 的指针吗？谢谢。

PS。就 libmono 而言，'out' 和 'ref' 参数是否相同？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-27T23:26:18.120

你是对的，它是 MonoObject**。

并且对于除了 C# 编译器之外的几乎所有东西都是相同的`out`。`ref`

# html - 如何使 textarea 在 iframe 跨浏览器中工作？

> ID：11694501
> 
> 赞同：0
> 
> 时间：2012-07-27T19:31:19.603
> 
> 标签：html, iframe, cross-browser, textarea

我正在使用以下代码并出现 textarea，但我无法编辑 textarea 中的文本，甚至无法在 Firefox 中显示闪烁的光标：

```
<iframe contentEditable='true'; src="you.php"></iframe> 
```

“you.php”是：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head></head>
<body>
<textarea contentEditable='true';>the text.</textarea>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T20:41:09.167

您不需要 contentEditable 来编辑文本区域的内容。尝试这个：

```
<iframe src="you.php"></iframe> 
```

你.php：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head></head>
<body>
<textarea>the text.</textarea>
</body>
</html> 
```

# bash - Fedora 17 和 nautilus 的 SVN 客户端

> ID：11694504
> 
> 赞同：1
> 
> 时间：2012-07-27T19:31:36.537
> 
> 标签：bash, svn, fedora, nautilus

我是 Fedora 17 linux 用户，我已经为 SVN 搜索了 RabbitVCS 的一个很好的替代品，例如。15.0.5版本，我的FC17盒子不太稳定。我最后的选择是 nautilus-action-scrips。

有人可以帮我选择 Gnome 3 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-03T09:50:27.633

您可以使用 RapidSVN

```
sudo yum install rapidsvn 
```

或者，您可以从[这里](http://www.rapidsvn.org/download/release/0.12.1/rapidsvn-0.12.1.tar.gz)下载源代码并自己构建

# python - python regex：不给它匹配的组

> ID：11694505
> 
> 赞同：-1
> 
> 时间：2012-07-27T19:31:45.837
> 
> 标签：python, regex

这是模式

```
pattern_strings = ['\\xc2d', '\\xa0', '\\xe7', '\\xc3\\ufffdd', '\\xc2\\xa0', '\\xc3\\xa7', '\\xa0\\xa0', '\\xc2', '\\xe9']
join_pattern =  '[' + '|'.join(pattern_strings) + ']'
pattern = re.compile(join_pattern) 
```

这是功能

```
def find_pattern(path):
    with open(path, 'r') as f:
        for line in f:
            # print line
            found = pattern.search(line)
            if found:
                print dir(found)
                logging.info('found in line - ' + line)
                logging.info('found - ' + str(found.group(0))) 
```

这是输入

```
\xc2d 
d\xa0 
\xe7 
\xc3\ufffdd 
\xc3\ufffdd 
\xc2\xa0 
\xc3\xa7 
\xa0\xa0 
'619d813\xa03697' 
```

当我运行它时，我得到的输出为

```
INFO:root:found in line - \xc2d 

INFO:root:found - d
INFO:root:found in line - d\xa0 

INFO:root:found - d
INFO:root:found in line - \xc3\ufffdd 

INFO:root:found - u
INFO:root:found in line - \xc3\ufffdd 

INFO:root:found - u
INFO:root:found in line - '619d813\xa03697' 

INFO:root:found - d 
```

**问题** - 为什么它不告诉整个模式`\xc2d`？我在这里做错了什么吗？- 我需要做什么才能让模式匹配`\xc2d`而不是`d`

**更新**

chaging to`join_pattern = '(' + '|'.join(pattern_strings) + ')'`不匹配任何东西

**更新 1**

```
pattern_strings = ['\\xc2d', '\\xa0', '\\xe7', '\\xc3\\ufffdd', '\\xc2\\xa0', '\\xc3\\xa7', '\\xa0\\xa0', '\\xc2', '\\xe9']

join_pattern =   '|'.join(pattern_strings)
pattern = re.compile(join_pattern) 
```

这与输入中的任何内容都不匹配:(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T19:46:54.153

中的方括号`re`表示一个*集合*

`join_pattern = '[' + '|'.join(pattern_strings) + ']'`导致正则表达式匹配“中的任何一个字符集`{ \ x c 2 d a 0 e 7 3 u f 9 | }`”。这可能不是您想要的行为。对于您只想使用的表达式：

```
join_pattern = '|'.join(pattern_strings) 
```

不需要括号，除非您尝试指定捕获/非捕获组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T19:43:51.870

问题是您用方括号将正则表达式括起来，`[]`. 这些表示一组字符；也就是说，`[abc|def]`将匹配`a`, `b`, `c`, `|`, `d`, `e`, 或之一`f`。使用您拥有的正则表达式，不需要括号。如果这是更大表达式的一部分，您可以使用圆括号`()`来表示一个组，该组确实将正则表达式的一部分组合在一起。（它也是一个捕获组，因此可以使用 . 访问其内容`.group(1)`。）

# .net - 带有 /clr:pure 的 C 标准库

> ID：11694516
> 
> 赞同：0
> 
> 时间：2012-07-27T19:32:43.150
> 
> 标签：.net, visual-c++, c++-cli

据我了解，可以在 clr:pure 模式下编译使用 C 标准库和 Visual C++ 的 C 代码。使用什么库？

*   这是一个纯 CLR 库，可以将 C 函数转换为适当的 .NET，还是只是连接到非托管 CRT 的桥梁？
*   是否可以在带有 Mono 的 Linux 上使用这样的程序集？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-28T18:56:41.057

1.  它是非托管代码的桥梁。纯意味着编译器不会生成非托管代码。但它仍然会生成对非托管代码的调用。 `/clr:safe`甚至更强。

2.  如果您安装了 Wine 和 Microsoft Visual C++ 运行时 DLL，它应该可以在 Mono 上运行。

# api - 为什么 og:article 有 article:author 的属性？

> ID：11694520
> 
> 赞同：1
> 
> 时间：2012-07-27T19:32:51.010
> 
> 标签：api, facebook-graph-api, facebook-opengraph, meta-tags

这如何在 Facebook 中浮出水面/FB 对这些数据做了什么？article:tag 也有同样的问题——为什么用这个属性标记你的文章很有用？有什么好处？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T20:21:24.720

这些标签将与内置的 Open Graph 操作一起使用`read`： [https ://developers.facebook.com/docs/opengraph/actions/builtin/#read](https://developers.facebook.com/docs/opengraph/actions/builtin/#read)

您可以在此处查看所有 OG 标签的完整定义： [https ://developers.facebook.com/docs/opengraph/objects/builtin/#article](https://developers.facebook.com/docs/opengraph/objects/builtin/#article)

# c# - 如何在 Microsoft 的 .NET 4.0 图表中将 MinorGrid 行数固定为固定数？

> ID：11694521
> 
> 赞同：1
> 
> 时间：2012-07-27T19:32:51.730
> 
> 标签：c#, winforms, charts

我正在尝试在 X 轴为对数刻度的 .NET 4.0 图表中设置固定数量的次要网格线。

我尝试设置“Axis.Minor.Interval”属性，这只会使网格线消失。

```
chart1.ChartAreas[0].AxisX.IntervalAutoMode = IntervalAutoMode.VariableCount;
            chart1.ChartAreas[0].AxisX.IntervalType = DateTimeIntervalType.Number;
            chart1.ChartAreas[0].AxisX.Interval = 100d;

            chart1.ChartAreas[0].AxisX.MajorGrid.IntervalType = DateTimeIntervalType.Number;
            chart1.ChartAreas[0].AxisX.MajorGrid.IntervalOffsetType = DateTimeIntervalType.Number;
            chart1.ChartAreas[0].AxisX.MajorGrid.Interval = 10d;

            chart1.ChartAreas[0].AxisX.MinorGrid.IntervalType = DateTimeIntervalType.Number;
            chart1.ChartAreas[0].AxisX.MinorGrid.IntervalOffsetType = DateTimeIntervalType.Number;
            chart1.ChartAreas[0].AxisX.MinorGrid.Interval = 5; 
```

我的目标是每十年有一个主要网格的对数刻度，显示 10 条次要网格线。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-08T16:05:47.280

在用同样的问题把我的头撞在墙上几个小时之后，我似乎偶然发现了答案：

莫名其妙地，如果你将 MinorGrid Interval 设置为 1，那么你会得到传统的对数网格标记，每十年十个：

```
aChart.ChartAreas[0].AxisX.IsLogarithmic = true;
aChart.ChartAreas[0].AxisX.MinorGrid.Interval = 1;
aChart.ChartAreas[0].AxisX.MinorGrid.Enabled = true; 
```

希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-01-04T09:56:12.017

同样的事情。我的 xaml 代码：

```
<WindowsFormsHost.Child>
            <DVC:Chart
                x:Name="MyChart"
                Width="400"
                Height="250"
                BackColor="Transparent"
                Paint="IdVgChart_Paint">
                <DVC:Chart.ChartAreas>
                    <DVC:ChartArea x:Name="IdVgChartArea" BackColor="Transparent">
                        <DVC:ChartArea.AxisX>
                            <DVC:Axis
                                IntervalAutoMode="VariableCount"
                                IntervalOffset="0"
                                IntervalOffsetType="Auto"
                                IntervalType="Auto"
                                IsMarginVisible="False">
                                <DVC:Axis.MajorTickMark>
                                    <DVC:TickMark LineWidth="2" />
                                </DVC:Axis.MajorTickMark>
                                <DVC:Axis.MinorTickMark>
                                    <DVC:TickMark
                                        Enabled="True"
                                        LineWidth="1"
                                        TickMarkStyle="OutsideArea" />
                                </DVC:Axis.MinorTickMark>
                                <DVC:Axis.MajorGrid>
                                    <DVC:Grid
                                        LineColor="Gray"
                                        LineDashStyle="Dot"
                                        LineWidth="2" />
                                </DVC:Axis.MajorGrid>
                                <DVC:Axis.MinorGrid>
                                    <DVC:Grid
                                        Enabled="true"
                                        LineColor="Gray"
                                        LineDashStyle="Dot"
                                        LineWidth="1" />
                                </DVC:Axis.MinorGrid>
                            </DVC:Axis>
                        </DVC:ChartArea.AxisX>
                        <DVC:ChartArea.AxisY>
                            <DVC:Axis
                                Interval="0"
                                IntervalAutoMode="VariableCount"
                                IntervalOffset="0"
                                IntervalOffsetType="Number"
                                IntervalType="Number"
                                IsLogarithmic="True"
                                IsMarginVisible="False"
                                LogarithmBase="10"
                                Maximum="1e-4"
                                Minimum="1e-12">
                                <DVC:Axis.MajorTickMark>
                                    <DVC:TickMark LineWidth="2" />
                                </DVC:Axis.MajorTickMark>
                                <DVC:Axis.MinorTickMark>
                                    <DVC:TickMark
                                        Enabled="True"
                                        Interval="1"
                                        LineWidth="1"
                                        TickMarkStyle="OutsideArea" />
                                </DVC:Axis.MinorTickMark>
                                <DVC:Axis.MajorGrid>
                                    <DVC:Grid
                                        Enabled="True"
                                        LineColor="Gray"
                                        LineDashStyle="Dot"
                                        LineWidth="2" />
                                </DVC:Axis.MajorGrid>
                                <DVC:Axis.MinorGrid>
                                    <DVC:Grid
                                        Enabled="true"
                                        Interval="1"
                                        LineColor="Gray"
                                        LineDashStyle="Dot"
                                        LineWidth="1" />
                                </DVC:Axis.MinorGrid>
                            </DVC:Axis>
                        </DVC:ChartArea.AxisY>
                        <DVC:ChartArea.CursorX>
                            <DVC:Cursor IsUserEnabled="False" IsUserSelectionEnabled="False" />
                        </DVC:ChartArea.CursorX>
                        <DVC:ChartArea.CursorY>
                            <DVC:Cursor IsUserEnabled="False" IsUserSelectionEnabled="False" />
                        </DVC:ChartArea.CursorY>
                    </DVC:ChartArea>
                </DVC:Chart.ChartAreas>
            </DVC:Chart>
        </WindowsFormsHost.Child> 
```

# javascript - 在内联颜色框中加载 mediaelementjs，暂停视频 onClose

> ID：11694523
> 
> 赞同：0
> 
> 时间：2012-07-27T19:33:02.760
> 
> 标签：javascript, colorbox, mediaelement.js, mediaelement

尝试了一些事情，但无法使其正常工作。我有一个内联视频元素，我将其加载到颜色框中，然后将 mediaelementjs 应用到它。我在颜色框 onOpen 事件上触发了 mediaelement。

问题是当我关闭彩盒时电影继续播放。我无法在成功函数之外访问该播放器，例如在 onCleanup 或 onClose 中。

这是视频所在的html：

```
<div class="hidden">
    <div id="trailer-wrap">
        <video id="trailer" src="...video source..." type="video/mp4" controls="controls" width="720" height="480" preload="none">

            <object width="720" height="405" type="application/x-shockwave-flash" data="path/to/flashmediaelement.swf">
                <param name="movie" value="path/to/flashmediaelement.swf" />
                <param name="flashvars" value="controls=true&amp;file=...video source..." />
                <img src="poster.jpg" alt="No video playback capabilities" />
            </object>
        </video>    
    </div>
</div> 
```

这是它下面的脚本：

```
 $(".cbox-trigger").colorbox({
        inline:true, 
        innerWidth:"720px",
        innerHeight:"480px",
            scrolling:false,
            onOpen: function(){

                var player = new MediaElementPlayer('#trailer', {
                    success: function (mediaElement, domObject) {
                        // call the play method
                        mediaElement.play();
                    }
                });
                $.fn.colorbox.resize();
            },
            onCleanup: function(){
                [how to access player object here?].pause();
            }
        }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T07:52:47.930

为此，您可能需要`player`在颜色框块之外定义变量，然后在 onCleanup 回调中使用此变量

```
var player = null;
$(".cbox-trigger").colorbox({
    inline:true, 
    innerWidth:"720px",
    innerHeight:"480px",
        scrolling:false,
        onOpen: function(){

            player = new MediaElementPlayer('#trailer', {
                success: function (mediaElement, domObject) {
                    // call the play method
                    mediaElement.play();
                }
            });
            $.fn.colorbox.resize();
        },
        onCleanup: function(){
            player.pause();
        }
    }); 
```

# drupal-7 - DRUPAL 7 PDOException：SQLSTATE [HY000]：一般错误：1406

> ID：11694525
> 
> 赞同：0
> 
> 时间：2012-07-27T19:33:09.403
> 
> 标签：drupal-7

```
PDOException: SQLSTATE[HY000]: General error: 1406 Data too long for column 
'delta' at row 1: 
INSERT INTO {block} 
    (module, delta, theme, status, weight, region, pages, cache) 
VALUES 
    (:db_insert_placeholder_0, :db_insert_placeholder_1, :db_insert_placeholder_2, 
     :db_insert_placeholder_3, :db_insert_placeholder_4, :db_insert_placeholder_5, 
     :db_insert_placeholder_6, :db_insert_placeholder_7); 
Array ( 
    [:db_insert_placeholder_0] => panels_mini 
    [:db_insert_placeholder_1] => mini_panel_titulo_de_adminisracion
    [:db_insert_placeholder_2] => bartik 
    [:db_insert_placeholder_3] => 0 
    [:db_insert_placeholder_4] => 0 
    [:db_insert_placeholder_5] => -1 
    [:db_insert_placeholder_6] => 
    [:db_insert_placeholder_7] => -1 ) 
in drupal_write_record() 
(line 7013 of C:\xampp\htdocs\drupal-7.14\includes\common.inc). 
```

有人可以帮我解决这个错误.....

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T21:19:57.400

块表中的 delta 列是`varchar`最大长度为 32 个字符的 a。

该查询试图插入`mini_panel_titulo_de_adminisracion`34 个字符长的增量值。

我不使用面板，所以我不能真正提供建议，除了说如果您可以将管理标题字段的名称更改为至少短 2 个字符的名称，错误可能会消失。

[如果没有，您可以尝试在面板问题队列](http://drupal.org/project/issues/panels?categories=All)中提交错误报告

# php - php相同图像的不同哈希

> ID：11694533
> 
> 赞同：3
> 
> 时间：2012-07-27T19:33:37.293
> 
> 标签：php, hash, md5, unique

我有两个相同的图像存储在两个不同的服务器（保管箱和我自己的）中。但是，我意识到

```
hash("md5",file_get_contents($image1))
hash("md5",file_get_contents($image2)) 
```

正在为这些相同的图像返回不同的哈希值。我如何确保它们都返回相同的字符串？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T01:48:32.247

您是否考虑过使用 md5_file？

```
md5_file($image1);
md5_file($image2); 
```

[http://www.php.net/manual/en/function.md5-file.php](http://www.php.net/manual/en/function.md5-file.php)

# jquery - 打开新行时，Jquery切换不关闭行

> ID：11694536
> 
> 赞同：0
> 
> 时间：2012-07-27T19:33:40.110
> 
> 标签：jquery

我在尝试让 jquery 在打开另一个表时关闭一个表中的打开行时遇到问题。我试图使用 toggle() 无济于事，我知道我只是错过了一些东西。这是我的html：

```
<table class="ProcTable" rules="all" cellpadding="0" cellspacing="0">
   <thead>   
      <tr class="proctablerow">
         <th>Recently Issued Procedures</th>         
      </tr>
   </thead>
   <tbody>
      <tr>
         <td></td>
         <td>Admin</td>
         <td>User Name #1</td>
      </tr>
      <tr>
         <td></td>
         <td>Reader</td>
         <td>User Name #2</td>
      </tr>
      <tr>
         <td></td>
         <td>Reader</td>
         <td>User Name #3</td>
      </tr> 
      </tbody>    
</table>
<table class="ProcTable" rules="all" cellpadding="0" cellspacing="0">
   <thead>   
      <tr class="proctablerow">
         <th>Recently Viewed Procedures</th>         
      </tr>
   </thead>
   <tbody>
      <tr>
         <td></td>
         <td>Admin</td>
         <td>User Name #1</td>
      </tr>
      <tr>
         <td></td>
         <td>Reader</td>
         <td>User Name #2</td>
      </tr>
      <tr>
         <td></td>
         <td>Reader</td>
         <td>User Name #3</td>
      </tr>
      </tbody>      
      </table>
      <table class="ProcTable" rules="all" cellpadding="0" cellspacing="0">
   <thead>   
      <tr class="proctablerow">
         <th>Bookmarked Procedures</th>         
      </tr>
   </thead>
   <tbody>
      <tr>
         <td></td>
         <td>Admin</td>
         <td>User Name #1</td>
      </tr>
      <tr>
         <td></td>
         <td>Reader</td>
         <td>User Name #2</td>
      </tr>
      <tr>
         <td></td>
         <td>Reader</td>
         <td>User Name #3</td>
      </tr>
      </tbody>      
      </table>

      </table> 
```

这是我的jQuery代码：

```
$(document).ready(function() {    
    $("#accordion").accordion( { active: false, collapsible: true });
    $(".ProcTable").accordion( { active: false, collapsible: true, autoHeight: false });  

    $('table.ProcTable tr.proctablerow th') .click(
    function() {
        $(this) .parents('table.ProcTable') .children('tbody') .toggle();
    });

}); 
```

有人可以帮我弄清楚如何在打开另一行的同时关闭一行（手风琴风格）。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T19:39:47.003

```
$('table.ProcTable tr.proctablerow th').on('click', function() {
    var elm = $(this).parents('table.ProcTable').children('tbody');
    $('table.ProcTable').children('tbody').not(elm).hide();
    elm.toggle();
}); 
```

[小提琴](http://jsfiddle.net/TPXG6/2/)

# c++ - 用于在 C++ 中组合多个非常大的栅格数据文件的 STL 容器

> ID：11694542
> 
> 赞同：2
> 
> 时间：2012-07-27T19:34:12.913
> 
> 标签：c++, gis, raster

我正在编写一段代码，该代码需要在 C/C++ 中执行与 ArcGIS 中的 combine 函数非常相似的操作。请参阅：[http ://webhelp.esri.com/arcgisdesktop/9.3/index.cfm?TopicName=Combining%20multiple%20rasters](http://webhelp.esri.com/arcgisdesktop/9.3/index.cfm?TopicName=Combining%20multiple%20rasters)

C++ 代码将以块的形式读取多个非常大的栅格数据文件 (2GB+)，找到唯一的组合并输出到单个地图。例如，如果有 3 个地图并且 <1,3,5> 存在，恭敬地，在三个地图的第一个单元格中，那么我希望 <1,3,5> 的所有后续实例在最后一个具有相同的键输出地图。

我应该使用哪些 STL 容器来存储地图？分块读取文件肯定会增加项目的复杂性。该算法需要非常快，因此我不能使用具有 O(n) 复杂度的向量进行搜索。目前，我正在考虑使用 unsorted_multimaps 的 unsorted_map，但我不确定这是否正确以及是否能够获得所需的性能。

有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-28T00:11:48.363

是的，std::map 或 std::unordered_map 是正确的选择。如果您不需要订单，unordered_map 会更快更紧凑。如果您需要更快的东西，您可以将其替换为[其他地图实现](http://attractivechaos.wordpress.com/2008/08/28/comparison-of-hash-table-libraries/)。

使用紧凑的键作为键，例如 std::tuple 或 std::array。

# r - 如果在 R 中加权平均的语句

> ID：11694545
> 
> 赞同：0
> 
> 时间：2012-07-27T19:34:31.647
> 
> 标签：r, if-statement, genetic, weighted-average

我有一个数百万行长的数据文件，其中包含来自许多组的信息。下面是一个简短的部分：

```
MARKER      GROUP1_A1   GROUP1_A2   GROUP1_FREQ GROUP1_N    GROUP2_A1   GROUP2_A2   GROUP2_FREQ GROUP2_N
rs10    A   C   0.055   1232    A   C   0.055   3221
rs1000  A   G   0.208   1232    A   G   0.208   3221
rs10000 G   C   0.134   1232    C   G   0.8624  3221
rs10001 C   A   0.229   1232    A   C   0.775   3221 
```

我想创建频率 (FREQ) 变量的加权平均值（它本身很简单），但是在这种情况下，某些行不匹配（第 3 行和第 4 行）。如果字母没有对齐，则在计算该标记的加权平均值之前，需要将第二组的频率减去 1。

我想设置一个简单的 IF 语句，但我不确定这样一个任务的语法。

任何见解或方向表示赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T19:48:28.457

假设您已在名为 mydata 的数据框中读取数据。然后执行以下操作：

```
mydata$GROUP2_FREQ <- mydata$GROUP2_FREQ - (mydata$GROUP1_A1 != mydata$GROUP2_A1) 
```

它之所以有效，是因为 R 将 TRUE 值视为 1，将 FALSE 值视为 0。

编辑：尝试以下操作：

```
mydata$GROUP2_FREQ <- abs( (as.character(mydata$GROUP1_A1) != 
                            as.character(mydata$GROUP2_A1)) -                   
                          as.numeric(mydata$GROUP2_FREQ) ) 
```

# c - 不使用 *、/、+、-、% 运算符将数字除以 3

> ID：11694546
> 
> 赞同：697
> 
> 时间：2012-07-27T19:34:31.463
> 
> 标签：c, math, division, divide

`*`如果不使用, `/`, `+`, `-`, , 运算符，您如何将一个数除以 3 `%`？

该号码可以有符号或无符号。

* * *

## 回答 #1

> 赞同：552
> 
> 时间：2012-07-27T19:51:47.083

这是一个执行所需操作的[简单功能。](http://web.archive.org/web/20121103111129/http://forums.hscripts.com/viewtopic.php?f=13&t=1358)但它需要`+`运算符，所以您剩下要做的就是使用位运算符添加值：

```
// replaces the + operator
int add(int x, int y)
{
    while (x) {
        int t = (x & y) << 1;
        y ^= x;
        x = t;
    }
    return y;
}

int divideby3(int num)
{
    int sum = 0;
    while (num > 3) {
        sum = add(num >> 2, sum);
        num = add(num >> 2, num & 3);
    }
    if (num == 3)
        sum = add(sum, 1);
    return sum; 
} 
```

正如吉姆评论这个作品，因为：

*   `n = 4 * a + b`
*   `n / 3 = a + (a + b) / 3`
*   所以`sum += a`, `n = a + b`, 和迭代

*   当`a == 0 (n < 4)`,`sum += floor(n / 3);`即 1,`if n == 3, else 0`

* * *

## 回答 #2

> 赞同：440
> 
> 时间：2012-07-27T19:55:55.640

愚蠢的情况需要一个愚蠢的解决方案：

```
#include <stdio.h>
#include <stdlib.h>

int main()
{
    FILE * fp=fopen("temp.dat","w+b");
    int number=12346;
    int divisor=3;
    char * buf = calloc(number,1);
    fwrite(buf,number,1,fp);
    rewind(fp);
    int result=fread(buf,divisor,number,fp);
    printf("%d / %d = %d", number, divisor, result);
    free(buf);
    fclose(fp);
    return 0;
} 
```

如果还需要小数部分，只需声明`result`as`double`并将`fmod(number,divisor)`.

**解释它是如何工作的**

1.  `fwrite`写入字节（上例中的`number`数字为 123456）。
2.  `rewind`将文件指针重置到文件的前面。
3.  `fread`从文件中读取最大长度的`number`“记录” `divisor`，并返回它读取的元素数。

如果你写 30 个字节然后以 3 为单位读回文件，你会得到 10 个“单位”。30 / 3 = 10

* * *

## 回答 #3

> 赞同：307
> 
> 时间：2012-07-27T19:54:47.390

```
log(pow(exp(number),0.33333333333333333333)) /* :-) */ 
```

* * *

## 回答 #4

> 赞同：208
> 
> 时间：2012-07-27T20:01:49.597

```
#include <stdio.h>
#include <stdlib.h>

int main(int argc, char *argv[])
{

    int num = 1234567;
    int den = 3;
    div_t r = div(num,den); // div() is a standard C function.
    printf("%d\n", r.quot);

    return 0;
} 
```

* * *

## 回答 #5

> 赞同：113
> 
> 时间：2012-07-27T20:05:47.427

您可以使用（依赖于平台的）内联汇编，例如，对于 x86：（[也适用于负数）](http://ideone.com/D23q1x)

```
#include <stdio.h>

int main() {
  int dividend = -42, divisor = 5, quotient, remainder;

  __asm__ ( "cdq; idivl %%ebx;"
          : "=a" (quotient), "=d" (remainder)
          : "a"  (dividend), "b"  (divisor)
          : );

  printf("%i / %i = %i, remainder: %i\n", dividend, divisor, quotient, remainder);
  return 0;
} 
```

* * *

## 回答 #6

> 赞同：107
> 
> 时间：2012-07-27T19:49:39.967

使用[itoa](http://en.wikibooks.org/wiki/C_Programming/C_Reference/stdlib.h/itoa)转换为 base 3 字符串。删除最后一个[trit](https://en.wikipedia.org/wiki/Ternary_numeral_system)并转换回基数 10。

```
// Note: itoa is non-standard but actual implementations
// don't seem to handle negative when base != 10.
int div3(int i) {
    char str[42];
    sprintf(str, "%d", INT_MIN); // Put minus sign at str[0]
    if (i>0)                     // Remove sign if positive
        str[0] = ' ';
    itoa(abs(i), &str[1], 3);    // Put ternary absolute value starting at str[1]
    str[strlen(&str[1])] = '\0'; // Drop last digit
    return strtol(str, NULL, 3); // Read back result
} 
```

* * *

## 回答 #7

> 赞同：57
> 
> 时间：2012-07-27T19:46:17.980

*（注意：请参阅下面的编辑 2 以获得更好的版本！）*

这并不像听起来那么棘手，因为您说过“不使用 [..] `+`[..]**运算符**”。如果您想禁止`+`一起使用该字符，请参见下文。

```
unsigned div_by(unsigned const x, unsigned const by) {
  unsigned floor = 0;
  for (unsigned cmp = 0, r = 0; cmp <= x;) {
    for (unsigned i = 0; i < by; i++)
      cmp++; // that's not the + operator!
    floor = r;
    r++; // neither is this.
  }
  return floor;
} 
```

然后只说`div_by(100,3)`除以`100`。`3`

* * *

### **编辑**：您也可以继续并替换`++`操作员：

```
unsigned inc(unsigned x) {
  for (unsigned mask = 1; mask; mask <<= 1) {
    if (mask & x)
      x &= ~mask;
    else
      return x & mask;
  }
  return 0; // overflow (note that both x and mask are 0 here)
} 
```

* * *

# 编辑 2：稍快的版本，不使用任何包含`+`, `-`, `*`, `/`,`%` *字符*的运算符。

```
unsigned add(char const zero[], unsigned const x, unsigned const y) {
  // this exploits that &foo[bar] == foo+bar if foo is of type char*
  return (int)(uintptr_t)(&((&zero[x])[y]));
}

unsigned div_by(unsigned const x, unsigned const by) {
  unsigned floor = 0;
  for (unsigned cmp = 0, r = 0; cmp <= x;) {
    cmp = add(0,cmp,by);
    floor = r;
    r = add(0,r,1);
  }
  return floor;
} 
```

我们使用`add`函数的第一个参数是因为如果不使用字符就无法表示指针的类型`*`，除非在函数参数列表中，其语法`type[]`与`type* const`.

FWIW，您可以使用类似的技巧轻松实现乘法函数，以使用[AndreyT](https://stackoverflow.com/a/11694787/430766)`0x55555556`提出的技巧：

```
int mul(int const x, int const y) {
  return sizeof(struct {
    char const ignore[y];
  }[x]);
} 
```

* * *

## 回答 #8

> 赞同：43
> 
> 时间：2012-07-27T23:07:27.380

[在Setun 计算机](https://en.wikipedia.org/wiki/Setun)上很容易实现。

要将整数除以 3，[请右移 1 位](https://en.wikipedia.org/wiki/Balanced_ternary)。

我不确定是否可以在这样的平台上实现符合标准的 C 编译器。我们可能需要稍微扩展一下规则，比如将“至少 8 位”解释为“至少能够保存从 -128 到 +127 的整数”。

* * *

## 回答 #9

> 赞同：32
> 
> 时间：2012-07-27T21:33:36.633

这是我的解决方案：

```
public static int div_by_3(long a) {
    a <<= 30;
    for(int i = 2; i <= 32 ; i <<= 1) {
        a = add(a, a >> i);
    }
    return (int) (a >> 32);
}

public static long add(long a, long b) {
    long carry = (a & b) << 1;
    long sum = (a ^ b);
    return carry == 0 ? sum : add(carry, sum);
} 
```

首先，请注意

```
1/3 = 1/4 + 1/16 + 1/64 + ... 
```

现在，剩下的很简单！

```
a/3 = a * 1/3  
a/3 = a * (1/4 + 1/16 + 1/64 + ...)
a/3 = a/4 + a/16 + 1/64 + ...
a/3 = a >> 2 + a >> 4 + a >> 6 + ... 
```

现在我们所要做的就是将 a 的这些位移值相加！哎呀！但是我们不能加法，所以相反，我们必须使用按位运算符编写一个加法函数！如果您熟悉按位运算符，我的解决方案应该看起来相当简单……但万一您不熟悉，我将在最后介绍一个示例。

另一件要注意的是，首先我左移 30！这是为了确保分数不会四舍五入。

```
11 + 6

1011 + 0110  
sum = 1011 ^ 0110 = 1101  
carry = (1011 & 0110) << 1 = 0010 << 1 = 0100  
Now you recurse!

1101 + 0100  
sum = 1101 ^ 0100 = 1001  
carry = (1101 & 0100) << 1 = 0100 << 1 = 1000  
Again!

1001 + 1000  
sum = 1001 ^ 1000 = 0001  
carry = (1001 & 1000) << 1 = 1000 << 1 = 10000  
One last time!

0001 + 10000
sum = 0001 ^ 10000 = 10001 = 17  
carry = (0001 & 10000) << 1 = 0

Done! 
```

这只是你小时候学到的加法！

```
111
 1011
+0110
-----
10001 
```

这个实现**失败了**，因为我们不能添加方程的所有项：

```
a / 3 = a/4 + a/4^2 + a/4^3 + ... + a/4^i + ... = f(a, i) + a * 1/3 * 1/4^i
f(a, i) = a/4 + a/4^2 + ... + a/4^i 
```

假设`div_by_3(a)`= x 的结果，则`x <= floor(f(a, i)) < a / 3`。当 时`a = 3k`，我们得到错误的答案。

* * *

## 回答 #10

> 赞同：25
> 
> 时间：2012-07-27T19:52:12.260

将 32 位数字除以 3 可以将其乘以`0x55555556`，然后取 64 位结果的高 32 位。

现在剩下要做的就是使用位运算和移位来实现乘法......

* * *

## 回答 #11

> 赞同：18
> 
> 时间：2012-07-27T22:33:21.393

又一个解决方案。这应该处理除 int 的最小值之外的所有整数（包括负整数），这需要作为硬编码异常处理。这基本上是通过减法进行除法，但仅使用位运算符（移位、异或、& 和补码）。为了更快的速度，它减去 3 *（2 的递减幂）。在 c# 中，它每毫秒执行大约 444 次这样的 DivideBy3 调用（1,000,000 次除法需要 2.2 秒），因此速度不会太慢，但速度远不及简单的 x/3。相比之下，Coodey 的好解决方案比这个快大约 5 倍。

```
public static int DivideBy3(int a) {
    bool negative = a < 0;
    if (negative) a = Negate(a);
    int result;
    int sub = 3 << 29;
    int threes = 1 << 29;
    result = 0;
    while (threes > 0) {
        if (a >= sub) {
            a = Add(a, Negate(sub));
            result = Add(result, threes);
        }
        sub >>= 1;
        threes >>= 1;
    }
    if (negative) result = Negate(result);
    return result;
}
public static int Negate(int a) {
    return Add(~a, 1);
}
public static int Add(int a, int b) {
    int x = 0;
    x = a ^ b;
    while ((a & b) != 0) {
        b = (a & b) << 1;
        a = x;
        x = a ^ b;
    }
    return x;
} 
```

这是 c#，因为这是我得心应手的，但与 c 的差异应该很小。

* * *

## 回答 #12

> 赞同：16
> 
> 时间：2012-08-03T00:45:07.113

这真的很容易。

```
if (number == 0) return 0;
if (number == 1) return 0;
if (number == 2) return 0;
if (number == 3) return 1;
if (number == 4) return 1;
if (number == 5) return 1;
if (number == 6) return 2; 
```

（为了简洁起见，我当然省略了一些程序。）如果程序员厌倦了全部输入，我相信他或她可以编写一个单独的程序来为他生成它。我碰巧知道某个操作员，`/`这将极大地简化他的工作。

* * *

## 回答 #13

> 赞同：14
> 
> 时间：2012-08-01T07:00:45.610

使用计数器是一个基本的解决方案：

```
int DivBy3(int num) {
    int result = 0;
    int counter = 0;
    while (1) {
        if (num == counter)       //Modulus 0
            return result;
        counter = abs(~counter);  //++counter

        if (num == counter)       //Modulus 1
            return result;
        counter = abs(~counter);  //++counter

        if (num == counter)       //Modulus 2
            return result;
        counter = abs(~counter);  //++counter

        result = abs(~result);    //++result
    }
} 
```

执行模函数也很容易，请查看评论。

* * *

## 回答 #14

> 赞同：11
> 
> 时间：2012-07-28T23:48:33.287

这是base 2中的经典除法算法：

```
#include <stdio.h>
#include <stdint.h>

int main()
{
  uint32_t mod3[6] = { 0,1,2,0,1,2 };
  uint32_t x = 1234567; // number to divide, and remainder at the end
  uint32_t y = 0; // result
  int bit = 31; // current bit
  printf("X=%u   X/3=%u\n",x,x/3); // the '/3' is for testing

  while (bit>0)
  {
    printf("BIT=%d  X=%u  Y=%u\n",bit,x,y);
    // decrement bit
    int h = 1; while (1) { bit ^= h; if ( bit&h ) h <<= 1; else break; }
    uint32_t r = x>>bit;  // current remainder in 0..5
    x ^= r<<bit;          // remove R bits from X
    if (r >= 3) y |= 1<<bit; // new output bit
    x |= mod3[r]<<bit;    // new remainder inserted in X
  }
  printf("Y=%u\n",y);
} 
```

* * *

## 回答 #15

> 赞同：10
> 
> 时间：2012-07-27T19:45:36.863

用 Pascal 编写程序并使用`DIV`运算符。

由于问题标记为[c](/questions/tagged/c "显示标记为“c”的问题")，您可能可以在 Pascal 中编写一个函数并从您的 C 程序中调用它；这样做的方法是特定于系统的。

`fp-compiler`但这是一个安装了 Free Pascal 包的 Ubuntu 系统上的示例。（我这样做是出于完全错误的固执；我没有声称这是有用的。）

**`divide_by_3.pas`**：

```
unit Divide_By_3;
interface
    function div_by_3(n: integer): integer; cdecl; export;
implementation
    function div_by_3(n: integer): integer; cdecl;
    begin
        div_by_3 := n div 3;
    end;
end. 
```

**`main.c`**：

```
#include <stdio.h>
#include <stdlib.h>

extern int div_by_3(int n);

int main(void) {
    int n;
    fputs("Enter a number: ", stdout);
    fflush(stdout);
    scanf("%d", &n);
    printf("%d / 3 = %d\n", n, div_by_3(n));
    return 0;
} 
```

**构建：**

```
fpc divide_by_3.pas && gcc divide_by_3.o main.c -o main 
```

**示例执行：**

```
$ ./main
Enter a number: 100
100 / 3 = 33 
```

* * *

## 回答 #16

> 赞同：8
> 
> 时间：2012-08-01T06:15:07.810

```
int div3(int x)
{
  int reminder = abs(x);
  int result = 0;
  while(reminder >= 3)
  {
     result++;

     reminder--;
     reminder--;
     reminder--;
  }
  return result;
} 
```

* * *

## 回答 #17

> 赞同：7
> 
> 时间：2012-07-30T14:45:56.297

这应该适用于任何除数，而不仅仅是三个。目前仅适用于未签名，但将其扩展到已签名应该不是那么困难。

```
#include <stdio.h>

unsigned sub(unsigned two, unsigned one);
unsigned bitdiv(unsigned top, unsigned bot);
unsigned sub(unsigned two, unsigned one)
{
unsigned bor;
bor = one;
do      {
        one = ~two & bor;
        two ^= bor;
        bor = one<<1;
        } while (one);
return two;
}

unsigned bitdiv(unsigned top, unsigned bot)
{
unsigned result, shift;

if (!bot || top < bot) return 0;

for(shift=1;top >= (bot<<=1); shift++) {;}
bot >>= 1;

for (result=0; shift--; bot >>= 1 ) {
        result <<=1;
        if (top >= bot) {
                top = sub(top,bot);
                result |= 1;
                }
        }
return result;
}

int main(void)
{
unsigned arg,val;

for (arg=2; arg < 40; arg++) {
        val = bitdiv(arg,3);
        printf("Arg=%u Val=%u\n", arg, val);
        }
return 0;
} 
```

* * *

## 回答 #18

> 赞同：7
> 
> 时间：2012-07-29T10:58:00.177

没有交叉检查这个答案是否已经发布。如果程序需要扩展为浮点数，可以将数字乘以 10*所需的精度数，然后可以再次应用以下代码。

```
#include <stdio.h>

int main()
{
    int aNumber = 500;
    int gResult = 0;

    int aLoop = 0;

    int i = 0;
    for(i = 0; i < aNumber; i++)
    {
        if(aLoop == 3)
        {
           gResult++;
           aLoop = 0;
        }  
        aLoop++;
    }

    printf("Reulst of %d / 3 = %d", aNumber, gResult);

    return 0;
} 
```

* * *

## 回答 #19

> 赞同：7
> 
> 时间：2012-08-05T17:03:19.553

通过使用和字符串连接`/`在“幕后”使用运算符会作弊吗？`eval`

例如，在 Javacript 中，您可以这样做

```
function div3 (n) {
    var div = String.fromCharCode(47);
    return eval([n, div, 3].join(""));
} 
```

* * *

## 回答 #20

> 赞同：6
> 
> 时间：2012-07-31T09:49:32.380

在[PHP](http://en.wikipedia.org/wiki/PHP)中使用[BC 数学](http://www.php.net/manual/en/intro.bc.php)：

```
<?php
    $a = 12345;
    $b = bcdiv($a, 3);   
?> 
```

* * *

**[MySQL](http://en.wikipedia.org/wiki/MySQL)**（来自 Oracle 的采访）

```
> SELECT 12345 DIV 3; 
```

* * *

**[帕斯卡](http://en.wikipedia.org/wiki/Pascal_%28programming_language%29)：**

```
a:= 12345;
b:= a div 3; 
```

* * *

**x86-64 汇编语言：**

```
mov  r8, 3
xor  rdx, rdx   
mov  rax, 12345
idiv r8 
```

* * *

## 回答 #21

> 赞同：6
> 
> 时间：2012-07-27T23:51:33.317

首先是我想出的。

```
irb(main):101:0> div3 = -> n { s = '%0' + n.to_s + 's'; (s % '').gsub('   ', ' ').size }
=> #<Proc:0x0000000205ae90@(irb):101 (lambda)>
irb(main):102:0> div3[12]
=> 4
irb(main):103:0> div3[666]
=> 222 
```

**编辑：**对不起，我没有注意到标签`C`。但是你可以使用关于字符串格式化的想法，我猜......

* * *

## 回答 #22

> 赞同：5
> 
> 时间：2012-07-27T20:35:22.167

使用[**Hacker's Delight Magic 数字计算器**](http://hackersdelight.org/magic.htm)

```
int divideByThree(int num)
{
  return (fma(num, 1431655766, 0) >> 32);
} 
```

其中[fma](http://en.cppreference.com/w/c/numeric/math/fma)是`math.h`头文件中定义的标准库函数。

* * *

## 回答 #23

> 赞同：5
> 
> 时间：2012-08-01T15:16:15.147

以下脚本生成了一个 C 程序，它在不使用运算符的情况下解决了该问题`* / + - %`：

```
#!/usr/bin/env python3

print('''#include <stdint.h>
#include <stdio.h>
const int32_t div_by_3(const int32_t input)
{
''')

for i in range(-2**31, 2**31):
    print('    if(input == %d) return %d;' % (i, i / 3))

print(r'''
    return 42; // impossible
}
int main()
{
    const int32_t number = 8;
    printf("%d / 3 = %d\n", number, div_by_3(number));
}
''') 
```

* * *

## 回答 #24

> 赞同：4
> 
> 时间：2012-08-23T11:58:21.213

第一的：

```
x/3 = (x/4) / (1-1/4) 
```

然后弄清楚如何解决 x/(1 - y)：

```
x/(1-1/y)
  = x * (1+y) / (1-y^2)
  = x * (1+y) * (1+y^2) / (1-y^4)
  = ...
  = x * (1+y) * (1+y^2) * (1+y^4) * ... * (1+y^(2^i)) / (1-y^(2^(i+i))
  = x * (1+y) * (1+y^2) * (1+y^4) * ... * (1+y^(2^i)) 
```

y = 1/4：

```
int div3(int x) {
    x <<= 6;    // need more precise
    x += x>>2;  // x = x * (1+(1/2)^2)
    x += x>>4;  // x = x * (1+(1/2)^4)
    x += x>>8;  // x = x * (1+(1/2)^8)
    x += x>>16; // x = x * (1+(1/2)^16)
    return (x+1)>>8; // as (1-(1/2)^32) very near 1,
                     // we plus 1 instead of div (1-(1/2)^32)
} 
```

虽然它使用了`+`，但是已经有人通过按位运算实现了加法。

* * *

## 回答 #25

> 赞同：4
> 
> 时间：2012-08-23T08:08:02.570

我认为正确的答案是：

为什么我不使用基本运算符来进行基本操作？

* * *

## 回答 #26

> 赞同：4
> 
> 时间：2012-07-30T19:25:35.627

使用[fma() 库函数](http://en.cppreference.com/w/c/numeric/math/fma)的解决方案，适用于任何正数：

```
#include <stdio.h>
#include <math.h>

int main()
{
    int number = 8;//Any +ve no.
    int temp = 3, result = 0;
    while(temp <= number){
        temp = fma(temp, 1, 3); //fma(a, b, c) is a library function and returns (a*b) + c.
        result = fma(result, 1, 1);
    } 
    printf("\n\n%d divided by 3 = %d\n", number, result);
} 
```

[请参阅我的另一个答案](https://stackoverflow.com/a/11757290/981787)。

* * *

## 回答 #27

> 赞同：4
> 
> 时间：2012-08-22T07:11:07.217

这种方法（c#）怎么样？

```
private int dividedBy3(int n) {
        List<Object> a = new Object[n].ToList();
        List<Object> b = new List<object>();
        while (a.Count > 2) {
            a.RemoveRange(0, 3);
            b.Add(new Object());
        }
        return b.Count;
    } 
```

* * *

## 回答 #28

> 赞同：3
> 
> 时间：2014-01-24T04:58:43.620

通常，对此的解决方案是：

`log(pow(exp(numerator),pow(denominator,-1)))`

* * *

## 回答 #29

> 赞同：3
> 
> 时间：2012-07-29T07:34:04.523

使用[cblas](http://www.gnu.org/software/gsl/manual/html_node/Level-1-CBLAS-Functions.html)，作为 OS X 的 Accelerate 框架的一部分。

```
[02:31:59] [william@relativity ~]$ cat div3.c
#import <stdio.h>
#import <Accelerate/Accelerate.h>

int main() {
    float multiplicand = 123456.0;
    float multiplier = 0.333333;
    printf("%f * %f == ", multiplicand, multiplier);
    cblas_sscal(1, multiplier, &multiplicand, 1);
    printf("%f\n", multiplicand);
}

[02:32:07] [william@relativity ~]$ clang div3.c -framework Accelerate -o div3 && ./div3
123456.000000 * 0.333333 == 41151.957031 
```

* * *

## 回答 #30

> 赞同：2
> 
> 时间：2012-11-16T20:18:01.363

很有趣，没有人用通用的划分来回答：

```
/* For the given integer find the position of MSB */
int find_msb_loc(unsigned int n)
{
    if (n == 0)
        return 0;

    int loc = sizeof(n)  * 8 - 1;
    while (!(n & (1 << loc)))
        loc--;
    return loc;
}

/* Assume both a and b to be positive, return a/b */
int divide_bitwise(const unsigned int a, const unsigned int b)
{
    int int_size = sizeof(unsigned int) * 8;
    int b_msb_loc = find_msb_loc(b);

    int d = 0; // dividend
    int r = 0; // reminder
    int t_a = a;
    int t_a_msb_loc = find_msb_loc(t_a);
    int t_b = b << (t_a_msb_loc - b_msb_loc);

    int i;
    for(i = t_a_msb_loc; i >= b_msb_loc; i--)  {
        if (t_a > t_b) {
            d = (d << 1) | 0x1;
            t_a -= t_b; // Not a bitwise operatiion
            t_b = t_b >> 1;
         }
        else if (t_a == t_b) {
            d = (d << 1) | 0x1;
            t_a = 0;
        }
        else { // t_a < t_b
            d = d << 1;
            t_b = t_b >> 1;
        }
    }

    r = t_a;
    printf("==> %d %d\n", d, r);
    return d;
} 
```

已在其中一个答案中给出了按位加法，因此请跳过它。

* * *

## 回答 #31

> 赞同：2
> 
> 时间：2012-12-14T14:06:35.630

所有的答案可能都不是面试官喜欢听到的：

我的答案：

> “我永远不会那样做，谁来为这种愚蠢的事情买单。没有人会在这方面占优势，它不是更快，它只是愚蠢。Prozessor 设计师必须知道这一点，但这必须适用于所有数字，不仅除以 3"

* * *

## 回答 #32

> 赞同：2
> 
> 时间：2012-08-23T13:34:24.313

好的，我想我们都同意这不是现实世界的问题。所以只是为了好玩，这里是使用 Ada 和多线程的方法：

```
with Ada.Text_IO;

procedure Divide_By_3 is

   protected type Divisor_Type is
      entry Poke;
      entry Finish;
   private
      entry Release;
      entry Stop_Emptying;
      Emptying : Boolean := False;
   end Divisor_Type;

   protected type Collector_Type is
      entry Poke;
      entry Finish;
   private
      Emptying : Boolean := False;
   end Collector_Type;

   task type Input is
   end Input;
   task type Output is
   end Output;

   protected body Divisor_Type is
      entry Poke when not Emptying and Stop_Emptying'Count = 0 is
      begin
         requeue Release;
      end Poke;
      entry Release when Release'Count >= 3 or Emptying is
         New_Output : access Output;
      begin
         if not Emptying then
            New_Output := new Output;
            Emptying := True;
            requeue Stop_Emptying;
         end if;
      end Release;
      entry Stop_Emptying when Release'Count = 0 is
      begin
         Emptying := False;
      end Stop_Emptying;
      entry Finish when Poke'Count = 0 and Release'Count < 3 is
      begin
         Emptying := True;
         requeue Stop_Emptying;
      end Finish;
   end Divisor_Type;

   protected body Collector_Type is
      entry Poke when Emptying is
      begin
         null;
      end Poke;
      entry Finish when True is
      begin
         Ada.Text_IO.Put_Line (Poke'Count'Img);
         Emptying := True;
      end Finish;
   end Collector_Type;

   Collector : Collector_Type;
   Divisor : Divisor_Type;

   task body Input is
   begin
      Divisor.Poke;
   end Input;

   task body Output is
   begin
      Collector.Poke;
   end Output;

   Cur_Input : access Input;

   -- Input value:
   Number : Integer := 18;
begin
   for I in 1 .. Number loop
      Cur_Input := new Input;
   end loop;
   Divisor.Finish;
   Collector.Finish;
end Divide_By_3; 
```

* * *

## 回答 #33

> 赞同：1
> 
> 时间：2015-03-27T22:46:10.023

如果您提醒自己标准的学校除法方法并以二进制形式进行，您会发现在 3 的情况下，您只能除和减去一组有限的值（在这种情况下从 0 到 5）。这些可以用 switch 语句处理以摆脱算术运算符。

```
static unsigned lamediv3(unsigned n)
{
  unsigned result = 0, remainder = 0, mask = 0x80000000;

  // Go through all bits of n from MSB to LSB.
  for (int i = 0; i < 32; i++, mask >>= 1)
  {
    result <<= 1;
    // Shift in the next bit of n into remainder.
    remainder = remainder << 1 | !!(n & mask);

    // Divide remainder by 3, update result and remainer.
    // If remainder is less than 3, it remains intact.
    switch (remainder)
    {
    case 3:
      result |= 1;
      remainder = 0;
      break;

    case 4:
      result |= 1;
      remainder = 1;
      break;

    case 5:
      result |= 1;
      remainder = 2;
      break;
    }
  }

  return result;
}

#include <cstdio>

int main()
{
  // Verify for all possible values of a 32-bit unsigned integer.
  unsigned i = 0;

  do
  {
    unsigned d = lamediv3(i);

    if (i / 3 != d)
    {
      printf("failed for %u: %u != %u\n", i, d, i / 3);
      return 1;
    }
  }
  while (++i != 0);
} 
```

* * *

## 回答 #34

> 赞同：1
> 
> 时间：2013-03-14T01:21:22.920

```
#include <stdio.h>

typedef struct { char a,b,c; } Triple;

unsigned long div3(Triple *v, char *r) {
  if ((long)v <= 2)  
    return (unsigned long)r;
  return div3(&v[-1], &r[1]);
}

int main() {
  unsigned long v = 21; 
  int r = div3((Triple*)v, 0); 
  printf("%ld / 3 = %d\n", v, r); 
  return 0;
} 
```

* * *

## 回答 #35

> 赞同：1
> 
> 时间：2013-11-15T10:11:12.787

为什么我们不直接应用在大学学习的定义？结果可能效率低下但很清楚，因为乘法只是递归减法，减法是加法，因此可以通过递归异或/和逻辑端口组合来执行加法。

```
#include <stdio.h>

int add(int a, int b){
   int rc;
   int carry;
   rc = a ^ b; 
   carry = (a & b) << 1;
   if (rc & carry) 
      return add(rc, carry);
   else
      return rc ^ carry; 
}

int sub(int a, int b){
   return add(a, add(~b, 1)); 
}

int div( int D, int Q )
{
/* lets do only positive and then
 * add the sign at the end
 * inversion needs to be performed only for +Q/-D or -Q/+D
 */
   int result=0;
   int sign=0;
   if( D < 0 ) {
      D=sub(0,D);
      if( Q<0 )
         Q=sub(0,Q);
      else
         sign=1;
   } else {
      if( Q<0 ) {
         Q=sub(0,Q);
         sign=1;
      } 
   }
   while(D>=Q) {
      D = sub( D, Q );
      result++;
   }
/*
* Apply sign
*/
   if( sign )
      result = sub(0,result);
   return result;
}

int main( int argc, char ** argv ) 
{
    printf( "2 plus 3=%d\n", add(2,3) );
    printf( "22 div 3=%d\n", div(22,3) );
    printf( "-22 div 3=%d\n", div(-22,3) );
    printf( "-22 div -3=%d\n", div(-22,-3) );
    printf( "22 div 03=%d\n", div(22,-3) );
    return 0;
} 
```

正如有人所说...首先使这项工作。请注意，算法应该适用于负 Q...

* * *

## 回答 #36

> 赞同：0
> 
> 时间：2014-01-28T23:25:51.963

我将使用此代码来划分所有正数、非浮点数。基本上，您希望将除数位向左对齐以匹配被除数位。对于被除数的每个部分（除数的大小），您要检查以确保被除数的部分大于除数，然后您要向左移动，然后在第一个注册器中进行 OR。这个概念最初是在 2004 年创建的（我相信是斯坦福），这是使用该概念的 C 版本。注意：（我稍微修改了一下）

```
int divide(int a, int b)
{
    int c = 0, r = 32, i = 32, p = a + 1;
    unsigned long int d = 0x80000000;

    while ((b & d) == 0)
    {
        d >>= 1;
        r--;
    }

    while (p > a)
    {
        c <<= 1;
        p = (b >> i--) & ((1 << r) - 1);
        if (p >= a)
            c |= 1;
    }
    return c; //p is remainder (for modulus)
} 
```

示例用法：

```
int n = divide( 3, 6); //outputs 2 
```

* * *

## 回答 #37

> 赞同：0
> 
> 时间：2012-08-21T18:53:53.973

以 2 为底的 3 是 11。

因此，只需在以 2 为底的 11 进行长除法（如在中学）。以 2 为底比以 10 为底更容易。

对于从最高有效位开始的每个位位置：

判断前缀是否小于 11。

如果是输出0。

如果不是输出 1，则替换前缀位进行适当更改。只有三种情况：

```
 11xxx ->    xxx    (ie 3 - 3 = 0)
100xxx ->   1xxx    (ie 4 - 3 = 1)
101xxx ->  10xxx    (ie 5 - 3 = 2) 
```

所有其他前缀都无法访问。

重复直到最低位位置，你就完成了。

* * *

## 回答 #38

> 赞同：0
> 
> 时间：2013-01-01T23:59:15.213

似乎没有人提到以二进制表示的 3 的除法标准——偶数之和应等于奇数之和（类似于十进制 11 的标准）。[在检查数字是否可被 3 整除](https://stackoverflow.com/questions/844867/check-if-a-number-is-divisible-by-3)下，有使用此技巧的解决方案。

我想这是迈克尔伯尔的编辑提到的可能的重复。

* * *

## 回答 #39

> 赞同：0
> 
> 时间：2012-07-30T14:54:26.963

```
#!/bin/ruby

def div_by_3(i)
  i.div 3        # always return int http://www.ruby-doc.org/core-1.9.3/Numeric.html#method-i-div
end 
```

* * *

## 回答 #40

> 赞同：0
> 
> 时间：2012-08-21T18:02:23.900

如果我们考虑`__div__`不是正字法`/`

```
def divBy3(n):
    return n.__div__(3)

print divBy3(9), 'or', 9//3 
```

* * *

## 回答 #41

> 赞同：0
> 
> 时间：2013-02-25T18:10:46.827

`InputValue`除以3的数在哪里

```
SELECT AVG(NUM) 
  FROM (SELECT InputValue NUM from sys.dual
         UNION ALL SELECT 0 from sys.dual
         UNION ALL SELECT 0 from sys.dual) divby3 
```

* * *

## 回答 #42

> 赞同：-1
> 
> 时间：2012-07-30T22:29:17.920

它在 Python 中，基本上带有字符串比较和状态机。

```
def divide_by_3(input):
  to_do = {}
  enque_index = 0
  zero_to_9 = (0, 1, 2, 3, 4, 5, 6, 7, 8, 9)
  leave_over = 0
  for left_over in (0, 1, 2):
    for digit in zero_to_9:
      # left_over, digit => enque, leave_over
      to_do[(left_over, digit)] = (zero_to_9[enque_index], leave_over)
      if leave_over == 0:
        leave_over = 1
      elif leave_over == 1:
        leave_over = 2
      elif leave_over == 2 and enque_index != 9:
        leave_over = 0
        enque_index = (1, 2, 3, 4, 5, 6, 7, 8, 9)[enque_index]
  answer_q = []
  left_over = 0
  digits = list(str(input))
  if digits[0] == "-":
    answer_q.append("-")
  digits = digits[1:]
  for digit in digits:
    enque, left_over = to_do[(left_over, int(digit))]
    if enque or len(answer_q):
      answer_q.append(enque)
  answer = 0
  if len(answer_q):
    answer = int("".join([str(a) for a in answer_q]))
  return answer 
```

* * *

## 回答 #43

> 赞同：-1
> 
> 时间：2012-08-22T03:52:49.757

好吧，您可以考虑使用类似**图/树**的结构来解决问题。基本上生成与要除以 3 的数量一样多的顶点。然后继续将每个未配对的顶点与其他两个顶点配对。

粗略的伪代码：

```
function divide(int num)
    while(num!=0)
        Add a new vertice to vertiexList.
        num--
    quotient = 0
    for each in vertexList(lets call this vertex A)
        if vertexList not empty
            Add an edge between A and another vertex(say B)
        else
            your Remainder is 1 and Quotient is quotient
        if vertexList not empty
            Add an edge between A and another vertex(say C)
        else
            your remainder is 2 and Quotient is quotient
        quotient++
        remove A, B, C from vertexList
    Remainder is 0 and Quotient is quotient 
```

这显然可以优化，复杂性取决于你的数量有多大，但如果你可以做 ++ 和 -- 它应该可以工作。这就像只计算冷却器一样好。

* * *

## 回答 #44

> 赞同：-1
> 
> 时间：2014-08-26T02:29:33.180

这将起作用：

```
smegma$ curl http://www.wolframalpha.com/input/?i=14+divided+by+3 2>/dev/null | gawk 'match($0, /link to /input/\?i=([0-9.+-]+)/, ary) { print substr( $0, ary[1, "start"], ary[1, "length"] )}' 4.6666666666666666666666666666666666666666666666666666 
```

只需用您的数字替换“14”和“3”即可。

* * *

## 回答 #45

> 赞同：-2
> 
> 时间：2012-08-01T10:27:45.743

使用 Linux shell 脚本：

```
#include <stdio.h>
int main()
{
    int number = 30;
    char command[25];
    snprintf(command, 25, "echo $((%d %c 3)) ", number, 47);
    system( command );
    return 0;
} 
```

[请参阅我的另一个答案](https://stackoverflow.com/a/11728217/981787)。

* * *

## 回答 #46

> 赞同：-2
> 
> 时间：2012-08-21T19:39:13.027

这是我小时候祖父教给我的一种方法。它需要 + 和 / 运算符，但它使计算变得容易。

将各个数字加在一起，然后查看它是否是 3 的倍数。

但是这种方法适用于 12 以上的数字。

示例：36，

3+6=9 是 3 的倍数。

42,

4+2=6 是 3 的倍数。

* * *

## 回答 #47

> 赞同：-2
> 
> 时间：2012-08-14T17:11:51.830

好'ol [`bc`](http://en.wikipedia.org/wiki/Bc_programming_language)：

```
$ num=1337; printf "scale=5;${num}\x2F3;\n" | bc
445.66666 
```

# pdf - 打印机吐出“阶梯式”PostScript 源代码

> ID：11694549
> 
> 赞同：2
> 
> 时间：2012-07-27T19:34:40.213
> 
> 标签：pdf, printing, ghostscript, postscript

尝试使用 pdf2ps 和京瓷 1370DN 的 ghostscript 打印从 pdf 创建的 postscript 时出现此错误：

```
%!PS-Adobe-3.0
              %%BoundingBox:  0  0  612  792
                                            %%Creator: GPL Ghostscript 905 (ps2write 
```

*   我检查以确保环境变量中的路径正确。
*   我清除了 %WINDIR%\system32\spool\printers 中的打印机后台处理程序数据。
*   我重启了打印机和它所连接的电脑。
*   我检查并打印了测试页。测试页工作正常。
*   每次都是相同的错误消息。
*   我从那台打印机打印了一些其他文件，打印效果很好。

有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-28T08:26:50.737

打印机支持 PCL 和 PostScript，很可能需要（非 PostScript！）HP PJL 序列来告诉打印机以下是 PostScript。否则它将假定数据是 PCL。PCL 是一种二进制格式，当出现 7 位 ASCII 时，会将其视为文本并打印出来，这就是这里发生的情况。

尝试在文件前添加：

```
<ESC>%-12345X@PJL JOB
@PJL ENTER LANGUAGE=POSTSCRIPT 
```

注意表示ESCAPE ASCII字符码，即0x1B

并在文件末尾放置：

```
<ESC>%-12345X@PJL EOJ
<ESC>%-12345X 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T20:07:10.407

您使用哪种方法将 PostScript 文件发送到打印机？

看起来您的打印机不是 PostScript 打印机，因此它在看到 PostScript 代码时不理解它。

您正在发送 PostScript 代码，而打印机只能“看到”文本。所以它打印文本....

打印机在行尾也看不到 CR/LF 代码，而只看到 LF 代码。这就是为什么你会看到这种楼梯效应。

# objective-c - iOS 应用程序发布到 facebook 但未找到通过链接

> ID：11694555
> 
> 赞同：0
> 
> 时间：2012-07-27T19:34:46.830
> 
> 标签：objective-c, ios, facebook, facebook-graph-api

我试图弄清楚在有人使用我的应用程序发布后用户单击“通过应用程序”时设置重定向的位置。现在，当我单击我的通过[链接](https://www.facebook.com/apps/application.php?id=318721611552813)时，它告诉我找不到该页面。我想将此链接设置为我为我的应用程序制作的 Facebook 页面。

我已经检查了我的 developers.facebook.com 上的所有设置。我认为这是在图形 api 中设置的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T15:15:58.180

我必须为我的应用程序创建一个页面。那就是它试图重定向到的地方。您可以在应用详情中创建/设置您的页面。

# java - DB2：从 Java 中查找生成的列

> ID：11694558
> 
> 赞同：0
> 
> 时间：2012-07-27T19:35:07.327
> 
> 标签：java, db2, resultset

我正在使用 Java 代码处理 DB2 表，并使用 ResultSetMetaData 获取表的元数据。无论如何要知道该表是否已生成列，如果是，是否有办法找出用于它的公式。

只要可以通过 Java 代码，使用 ResultSetMetaData 或使用任何其他方法都可以。

梅胡尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T22:20:20.390

使用系统目录。在 Java 中将以下内容作为 ResultSet 打开

```
 SELECT colname
      FROM SysCat.Columns
      WHERE tabname = ?
        AND tabschema = ?
        AND identity = 'Y' 
```

如果 ResultSet 为空，则您的表没有 GENERATED 列。否则，您可以从上述查询的输出中确定生成了哪个列名。

如果您正在寻找一个可以为 IDENTITY 列“预先生成”下一个值的公式，那么就没有办法做到这一点，至少在数据库很热的时候不行。

# orchardcms - 如何在 Orchard CMS 中设置博客输出样式

> ID：11694569
> 
> 赞同：2
> 
> 时间：2012-07-27T19:36:17.003
> 
> 标签：orchardcms, styling

我是使用 Orchard CMS（以及一般的网页设计）的初学者。我无法在我的网站上设置博客页面的输出样式。我的许多页面都有自定义 HTML 来为文本创建背景。我想在通过仪表板创建的所有博客上重新创建此背景。

在过去的几周里，我浏览了这个网站和谷歌，试图找到信息，但我找不到任何不完全在我脑海中的实质性内容。

出于隐私原因，我删除了一些信息，但基本上代码创建了一个容器，我可以在其中放置我的内容。这是背景的（修改后的）代码：

```
<table style="float: right" width="100%" border="1" cellpadding="0" cellspacing="0">
    <tbody>
        <tr>
            <td style="width: 21px;"><img src="src.gif" /></td>
            <td style="background-image: url('src.gif'); font-family: Arial, Helvetica, sans-serif; color: white; font-size: 15px; font-weight: bold;">
                <span style="float: left">[Redacted]</span>
                <span style="float: right">
                        <script language="javascript">
                        var dayNames = new Array("Sunday","Monday","Tuesday","Wednesday",
                        "Thursday","Friday","Saturday");
                        var monthNames = new Array(
                        "January","February","March","April","May","June","July",
                        "August","September","October","November","December");
                        var now = new Date();
                        document.write(dayNames[now.getDay()] + ", " + 
                        monthNames[now.getMonth()] + " " + 
                        now.getDate() + ", " + now.getFullYear());
                    </script>
                </span>
            </td>
            <td style="width: 21px;"><img src="src.gif" /></td>
        </tr>
        <tr>
            <td style="background-image: url('src.gif');"></td>
            <td style="background-color: #fcfefc;">
<!-- Content goes here -->

<!-- End Content -->
            </td>
            <td style="background-image: url('src.gif');"></td>
        </tr>
        <tr>
            <td><img src="src.gif" /></td>
            <td style="src.gif');"></td>
            <td><img src="src.gif" /></td>
        </tr>
    </tbody>
</table> 
```

以下是我的问题：

1.  如何设置我的博客和每个博客页面的样式，以便所有内容都在这个容器中？
2.  如何更改“摘录”的输出？博客摘录的默认长度在奇怪的地方被截断。我希望能够控制这一点。
3.  除了 orchardproject.net，谁能推荐一个为初学者找到 Orchard 文档的好地方？我觉得学习曲线对我来说很陡峭，但我致力于学习 Orchard。你能推荐一个好的起点，这样我就可以为这类东西打下良好的基础吗？

我是一个初学者，但我正在努力变得更好，所以请多多包涵。我几乎没有 .Net 或 C# 经验，而且我的 CMS 知识很基础（Wordpress）。

谢谢阅读！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-28T10:59:18.960

1.  在您的主题中，覆盖 content.cshtml 模板，使其包含您的 html 而不是默认的。原始模板展示了如何添加要插入内容的区域（通常类似于`@Display(Model.Content)`.

2.  覆盖内容摘要模板。请参阅[http://weblogs.asp.net/bleroy/archive/2012/07/01/my-body-summary-template-for-orchard.aspx](http://weblogs.asp.net/bleroy/archive/2012/07/01/my-body-summary-template-for-orchard.aspx)

3.  [http://docs.orchardproject.net/Documentation/Orchard-TV](http://docs.orchardproject.net/Documentation/Orchard-TV)

如果可以的话，我也想对您的标记发表一些评论：

*   表格不应用于布局，而只能用于表格数据。
*   不应使用内联样式，而应将其替换为样式表中定义的样式。
*   该脚本不应内联添加，而应位于单独的文件中，并包含在 using 中`@Script.Include`，这样如果模板由于某种原因多次呈现，则不会多次添加该脚本。
*   该脚本正在污染全局命名空间。
*   该脚本不可本地化。
*   您可能应该使用服务器端代码而不是客户端脚本，顺便说一下，它已经知道世界上所有文化中的日期和月份名称。@DateTime.Now.ToString("dddd, MMMM yyyy") 应该能够替换整个脚本块。

# c# - Twitter时间到当地时间c#

> ID：11694576
> 
> 赞同：3
> 
> 时间：2012-07-27T19:36:27.513
> 
> 标签：c#, timezone

如何将用户发布的推文时间转换为本地时间？created_at 给了我创建推文的时间，并且基于用户的国家，我如何使用 c# 将其更改为我的本地时间。时间格式为“Fri Jul 27 15:14:11 +0000 2012”。utc_offset 是什么意思，如何使用它来更改时区？

我对时区的东西不是很熟悉，谢谢你的帮助:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-27T20:01:38.547

你会想要使用[`DateTimeOffset`结构](http://msdn.microsoft.com/en-us/library/bb341783)。这允许您捕获日期和时间以及与 UTC 的偏移量。

您要用于 Twitter 时间的格式是：

```
string twitterDate = "Fri Jul 27 15:14:11 +0000 2012";

DateTimeOffset dt = DateTimeOffset.ParseExact(twitterDate, 
    "ddd MMM dd HH:mm:ss zzz yyyy", CultureInfo.InvariantCulture); 
```

请注意，[虽然没有记录，`zzzz` *但确实*可以作为自定义日期时间格式](http://msdn.microsoft.com/en-us/library/8kb3ddd4)并成功地正确解析偏移量。这意味着您将来在依赖它时应该小心（除非文档更改以反映此功能）。

一旦有了`DateTimeOffset`，您就知道与 UTC 的偏移量。如果您想在本地时间获取它，*您*可以调用已解析的[`ToLocalTime`方法](http://msdn.microsoft.com/en-us/library/system.datetimeoffset.tolocaltime.aspx)，`DateTimeOffset`它将返回一个实例，该实例具有基于您本地设置的偏移量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T19:51:00.653

应该是这样的：

```
DateTime localDateTime = DateTime.ParseExact(dateString, "ddd MMM dd HH:mm:ss zzz yyyy", new CultureInfo("en-US")); 
```

除非您在 DateTime 的构造函数中提供 DateTimeKind，否则 DateTime 将位于工作站/服务器管理员为 Windows 选择的时区中。

# memory-management - 如何有效地使用精灵表？

> ID：11694577
> 
> 赞同：1
> 
> 时间：2012-07-27T19:36:29.360
> 
> 标签：memory-management, cocos2d-iphone, sprite-sheet

我想做的事：

我想使用精灵表来加载游戏中的所有敌人。一旦它们被好人摧毁或离开屏幕，它们就必须被移除。我有 6-7 个敌人，其中一些是动画。我将多次重复使用它们。我想从内存中有效地加载和卸载它们。

我在做什么：

我首先加载精灵表：

```
[[CCSpriteFrameCache sharedSpriteFrameCache] addSpriteFramesWithFile:@"Obstacles.plist"];
CCSpriteBatchNode *obstaclesspriteSheet = [CCSpriteBatchNode batchNodeWithFile:@"Obstacles.pvr.ccz"];
[self addChild:obstaclesspriteSheet]; 
```

我有一个名为 BadBoys 的类来处理坏人。每次我想创建一个坏人时，我都会创建一个类的实例。在类中，我创建了精灵并将其添加到图层中。

```
baddies[x] = [[BadBoys alloc] init];

//INSIDE THE CLASS
baddie = [CCSprite spriteWithSpriteFrameName:@"cannonball-hd.png"]; 
```

当精灵被破坏时，我从图层中删除它，然后释放该类的实例。

```
[self removeChild:[baddies[x] getBaddie] cleanup:YES]; //getBaddie returns the sprite
[baddies[x] release]; 
```

我知道这是一个很好的方法。我想知道的是这是否是最有效的方法？我想到了另一种加载图像的方法：

将图像异步加载到 CCTextureCache。然后使用缓存中的纹理创建一个精灵。将它添加到一个 NSMutableArray 中，它将容纳所有活着的敌人然后当我不再需要它时，我可以通过以下方式摧毁它：

```
CCTexture2D * texture = spriteName.texture;
[spriteName.parent removeChild:spriteName cleanup:YES];
[[CCTextureCache sharedTextureCache] removeTexture:texture];
[backgroundSprites removeObject:spriteName]; 
```

这是更好的方法吗？请分享您的观点和建议。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T19:52:10.923

正如你所说，你所做的很好。

你的替代方案是一个糟糕的主意。我会告诉你原因：你会希望避免在游戏过程中将纹理加载到内存中并经常从内存中删除它们。从闪存加载纹理很慢。从内存中删除纹理也需要一些时间，而且如果你有足够的可用内存可用，那就毫无意义了。

此外，如果您使用 spritesheet 并且您正在移除一个障碍物，但也尝试从内存中移除障碍物的纹理（即 Obstacles.pvr.ccz），那么纹理缓存无论如何都不会从内存中移除纹理。因为它仍然被 spritesheet 使用。

最后：[过早优化是万恶之源](http://c2.com/cgi/wiki?PrematureOptimization)。

# ssas - 如何在 mdx 中执行“事件后的平均天数”类型查询？

> ID：11694580
> 
> 赞同：1
> 
> 时间：2012-07-27T19:36:34.587
> 
> 标签：ssas, mdx, moving-average, weighted-average

我有一个过去用来报告事件计数的多维数据集。假设在 7 月份，我想分解每种产品发生的事件数量。

我会有这样的事情：

```
SELECT Measures.[Count] ON COLUMNS,
    Product.[Product Id].Members ON ROWS
FROM [MyCube]
WHERE [Time].[Month].[July 2012] 
```

输出如下：

```
 Count
Car     5
Train   6 
```

现在我想修改输出以获得如下内容：

```
 Count   Avg Days since sale
Car     5       12
Train   6       14 
```

我怎么做？

我花了几个小时试图在 MDX 中找到解决方案，但找不到解决方法。（我对 MDX 很陌生）

如果我在 COLUMNS 或 ROWS 中包含天数，我已经找到了几种可行的解决方案。例如：

```
WITH MEMBER Measures.[NumDays] as
    count([Time].[Date].CurrentMember :
        [Time].[Date].&[2012-07-27T00:00:00])
SELECT
    ([Time].[Date].Members,{Measures.[Count],Measures.[NumDays]}) ON COLUMNS,
    [Product].[Product Id].Members ON ROWS
FROM [MyCube]
WHERE [Time].[Month].[July 2012] 
```

这让我非常接近。结果是这样的：

```
 July 1                July 2                ...
        Count    Num Days     Count    Num Days     ...
Car     1        24           3        23
Train   0        24           1        23 
```

我可以使用这个结果集并在我的 .NET 代码中得到我想要的。我可以通过加权平均计算自销售以来的平均天数。
例如，对于汽车，它将是`(1*24 + 3*23)/(1 + 3)`. 我必须在我的 .NET 代码中做一些混乱和不幸的事情才能让它工作，而且我还必须从服务器发回大约 80 倍于我需要的数据。

我在使用 MDX 时遇到的问题是，一旦我`[Time].[Date].Members`从结果集中取出`[Time].[Date].CurrentMember`is `[Time].[Date].All`，我就无法从中进行任何有意义的计算。

有没有办法将第二个 MDX 用作子查询，并以我需要的方式汇总它返回的值？

我的解决方案不需要子查询方法，但我很好奇是否可以这样做。任何帮助，将不胜感激。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T21:25:34.217

您可以使用[Sum](http://msdn.microsoft.com/en-us/library/ms145484.aspx)函数：

```
WITH MEMBER [Measures].[NumDays] AS
    Count([Time].[Date].CurrentMember :
        [Time].[Date].&[2012-07-27T00:00:00])
MEMBER [Measures].[avg] AS Sum([Time].[Date].Members, Measures.[Count] * [Measures].[NumDays])/ Sum([Time].[Date].Members, Measures.[Count])
SELECT
    {[Measures].[avg]} ON COLUMNS,
    [Product].[Product Id].Members ON ROWS
FROM [MyCube]
WHERE [Time].[Month].[July 2012] 
```

当您`[Time].[Date].Members`从第二个查询中删除时，层次结构上的当前成员`[Time].[Date]`是默认成员（即 All 成员）。

# python - 什么时候“命令”比“打开”子进程更可取？

> ID：11694585
> 
> 赞同：4
> 
> 时间：2012-07-27T19:37:05.987
> 
> 标签：python, subprocess, popen

我在没有上过学的情况下学习系统管理，所以有时我错过了许多其他人的基本信息。

我试图在打印之前给我的 stdout 行另一个参数，但我不确定我应该使用哪个进程，如果我应该使用子进程的命令，我有点模糊。

我目前的代码是：

```
f = open('filelist', 'r')
searchterm = f.readline()
f.close()|
#takes line from a separate file and gives it definition so that it may be callable.

import commands
commands.getoutput('print man searchterm') 
```

这正在运行，但没有给我一个 shell 的输出。不过，我更重要的问题是，我是否使用正确的命令来获得我喜欢的过程？我应该改用其中一个子进程命令吗？我尝试使用 popen，但我对它的理解不够充分，无法正确使用它。

即，我在跑步

```
subprocess.Popen('print man searchterm') 
```

但我毫无疑问地知道这不是你应该如何运行它的。Popen 需要的参数比我给出的要多，比如文件位置和运行位置（Stdout 或 stderr）。但是我在使这些命令起作用时遇到了麻烦。会不会是这样的：

```
subprocess.Popen(pipe=stdout 'man' 'searchterm')
#am unsure how to give the program my arguments here. 
```

我一直在到处研究，但这是一个如此广泛使用的过程，我似乎正在遭受信息过剩而不是信息不足的困扰。任何帮助将不胜感激，我很新。

先发制人地感谢任何帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-27T19:48:30.403

从单独的进程获取数据的规范方法是使用[子](http://docs.python.org/library/subprocess.html#subprocess.Popen)进程（[命令](http://docs.python.org/library/commands.html#module-commands)已弃用）

```
import subprocess
p = subprocess.Popen(['print','man','searchitem'], stdout=subprocess.PIPE, stderr=subprocess.PIPE)
stdoutdata, stderrdata = p.communicate() 
```

请注意，存在一些用于将字符串拆分为参数列表的便捷函数。最值得注意的是[shlex.split](http://docs.python.org/library/shlex.html#shlex.split)它将接受一个字符串并将其拆分为一个列表，就像 shell 一样。（如果字符串中没有引用任何内容，也`str.split()`可以正常工作）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T19:47:23.387

`commands`在 Python 2.6 及更高版本中已弃用，并已在 Python 3 中删除。即使您坚持使用 Python 2.5 或更早版本，也可能没有在新代码中更可取的情况。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-27T19:48:33.550

从[文档](http://docs.python.org/library/commands.html#module-commands)：

> 2.6 版后已弃用：命令模块已在 Python 3 中删除。请改用 subprocess 模块。

要`man searchterm`在单独的进程中运行并在终端中显示结果，您可以这样做：

```
import subprocess
proc = subprocess.Popen('man searchterm'.split())
proc.communicate() 
```

# javascript - .on 负载不工作

> ID：11694586
> 
> 赞同：2
> 
> 时间：2012-07-27T19:37:08.203
> 
> 标签：javascript, jquery, html, events, load

我有我能写的最简单的 .on 函数。它开始是试图在加载时验证表单，然后经过几分钟的挫折，我尝试了以下操作：

```
 $('p').on('load',function(){
     console.log("hello"); 
  }); 
```

这甚至行不通。我很困惑。我在内外都试过了`$(document).ready()`，都不管用，我还检查了控制台，我的 JS 没有错误。

是什么原因造成的，这让我很生气

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T19:41:49.107

jQuery 没有办法在特定元素第一次可用时触发事件。您可以使用 setInterval 来执行此操作，但通常有更好的方法来处理它，具体取决于具体情况。

```
setInterval(function(){
    $("p").not(".alreadyloaded").trigger("load").addClass("alreadyloaded");
},100);
$(document).on('load','p',function(){
    console.log("hello"); 
}); 
```

**如果可能的话，我不建议使用这种方法。**

更好的处理方法是使用添加 p 元素的事件的回调（例如 or 的成功`.load()`）`$.ajax`或绑定委托事件，例如`$(document).on('click','p',function(){ alert('hello'); });`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T19:42:18.523

`p`s、`div`s 和其他元素没有`load`-event - 这仅适用于图像、窗口、框架和 iframe。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-27T19:44:24.357

**[演示](http://jsfiddle.net/n3ZfS/)**

您始终可以使用以下命令检查是否存在`length`：

```
var par = $('p.paragraph'); // make it special with some ID or class

if(par.length){         // If your elements exists....
   alert(" I'm 'LOADED!' ;) ");
} 
```

# php - 发送 PHP 电子邮件

> ID：11694587
> 
> 赞同：2
> 
> 时间：2012-07-27T19:37:22.097
> 
> 标签：php, email

我编写了一个脚本，如果表单失败，用户会看到一条错误消息，并且应该向我发送一封电子邮件。但是，我没有收到电子邮件。我在我的脚本中看不到任何错误，并且找不到电子邮件（甚至在垃圾邮件中也没有）。可能是什么问题？我相信我们正在使用 Linux 服务器，所以默认情况下应该安装 Mail 代理，对吗？防火墙会阻止消息吗？

编码：

```
<?php

if (isset($aErrors) && count($aErrors) > 0 ) {
        print '<ul class="errorlist">';
        foreach ( $aErrors as $error ) {
          print '<li>' . $error . '</li>';
        }
        print '</ul><br />';

$mail_ontv = "info@example.com"; 

$_POST['onderwerp'] = "Geen Twinfield Abonnement";

    // set datum 
    $datum = date("d.m.Y H:i"); 

    // set ip 
    $ip = $_SERVER['REMOTE_ADDR']; 

    $inhoud_mail .= $_SERVER['SCRIPT_URI'] . "\n\n";

    $inhoud_mail .= "Iemand probeerde zich aan te melden, maar had geen Twinfield abonnement!\n";   
    $inhoud_mail .= "Bedrijfsnaam: " . $_SESSION['bedrijfsnaam'] . "\n"; 
    $inhoud_mail .= "Telefoonnummer: " . $_SESSION['telefoonnummer'] . "\n"; 
    $inhoud_mail .= "E-mail adres: " . $_SESSION['email'] . "\n"; 
    $inhoud_mail .= "Telefoonnummer contactpersoon: " . $_SESSION['telefoonnummercontact'] . "\n"; 
    $inhoud_mail .= "E-mail adres contactpersoon: " . $_SESSION['emailcontact'] . "\n"; 
    $inhoud_mail .= "Gewenste gebruikersnaam: " . $_SESSION['gebruikersnaam'] . "\n";
    $inhoud_mail .= "Gekozen abonnement: " . $_SESSION['abonnement'] . "\n\n"; 

    $inhoud_mail .= "Verstuurd op " . $datum . " via het ip " . $ip . "\n\n"; 

    $headers = "From: " . $_SESSION['bedrijfsnaam'] . " <" . $_SESSION['emailcontact'] . ">";

    $headers = stripslashes($headers);
    $headers = str_replace("\n", "", $headers); // Verwijder \n 
    $headers = str_replace("\r", "", $headers); // Verwijder \r 
    $headers = str_replace("\"", "\\\"", str_replace("\\", "\\\\", $headers)); // Slashes van quotes 

    $_POST['onderwerp'] = str_replace("\n", "", $_POST['onderwerp']); // Verwijder \n 
    $_POST['onderwerp'] = str_replace("\r", "", $_POST['onderwerp']); // Verwijder \r 
    $_POST['onderwerp'] = str_replace("\"", "\\\"", str_replace("\\", "\\\\", $_POST['onderwerp'])); // Slashes van quotes 

    mail($mail_ontv, $_POST['onderwerp'], $inhoud_mail, $headers);                                      
}

?> 
```

多谢你们！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-27T19:44:09.707

除了 Mac B 的建议之外，还有一些额外的想法：

1) 有许多 PHP 库可以为您发送电子邮件。它们可以与本地或远程 SMTP 服务器一起工作。例如，[http://swiftmailer.org/](http://swiftmailer.org/)。

2) 如今，大多数电子邮件提供商（Gmail、Yahoo 等）都会拦截来自您本地计算机的垃圾邮件。我建议使用便宜的第三方 SMTP 服务来发送您的电子邮件 - 这将有助于提高可靠性。我多年来一直使用的一个叫做 CritSend (critsend.com)。还有很多其他的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-27T19:40:36.310

你检查过返回值`mail()`吗？如果你得到一个布尔值 fALSE，那么当 PHP 试图将电子邮件处理到你的 SMTP 服务器时发生了一些事情。

如果邮件返回 true，则切换成功，您必须查看 SMTP 服务器的日志以了解从那时起电子邮件发生了什么情况。

请记住：PHP 参与发送电子邮件，在现实世界中的等价物，就是将信封放入邮箱。而已。其他一切都完全超出了 PHP 的权限和控制范围。

# html - 基于 HTML5/websockets/javascript 的实时日志文件查看器？

> ID：11694591
> 
> 赞同：13
> 
> 时间：2012-07-27T19:37:39.127
> 
> 标签：html, logging, websocket

我正在寻找在使用 html5 或 javascript 的浏览器中运行的“tail -f”的等价物。

一个解决方案需要一个用 HTML5/websockets/javascript 编写的客户端代码和一个后端服务器端应用程序。我在 C# 中寻找一个，但我愿意用 php 或 python 重写它。

这是我见过的唯一接近的是

[http://commavee.com/2007/04/13/ajax-logfile-tailer-viewer/](http://commavee.com/2007/04/13/ajax-logfile-tailer-viewer/)

但是，现代浏览器具有 WebSockets，这使问题变得更加简单。

[http://www.websocket.org/echo.html](http://www.websocket.org/echo.html)

理想情况下，我希望拥有 BareTail 的一些功能

[http://www.baremetalsoft.com/baretail/](http://www.baremetalsoft.com/baretail/)

例如线条的颜色编码、排序和多文件制表符。

我找到了一个类似的帖子，有人正在寻找基于 Windows 的日志文件程序

[https://stackoverflow.com/questions/113121/best-tail-log-file-visualization-freeware-tool](https://stackoverflow.com/questions/113121/best-tail-log-file-visualization-freeware-tool)

有人有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-04-25T18:09:08.883

它与 tail 不完全一样，但[https://log4sure.com](https://log4sure.com)的实时日志功能确实允许您实时监控客户端日志。您必须像处理拖尾一样适当地设置和执行日志，但是您可以查看所有日志以及有关您的客户端的额外信息，例如浏览器、操作系统、国家/地区等。您还可以创建自己的自定义日志来记录内容. 查看网站上的演示以获得更好的想法。

设置代码非常简单，最好的部分是它是免费的。

```
// set up 
var _logServer;

(function() {
  var ls = document.createElement('script');
  ls.type = 'text/javascript';
  ls.async = true;
  ls.src = 'https://log4sure.com/ScriptsExt/log4sure-0.1.min.js';
  var s = document.getElementsByTagName('script')[0];
  s.parentNode.insertBefore(ls, s);
  ls.onload = function() {
    // use your token here.
    _logServer = new LogServer("use-your-token-here");
  };
})();

// example for logging text
_logServer.logText("your log message goes here.")

// example for logging error 
divide = function(numerator, divisor) {
    try {
      if (parseFloat(value) && parseFloat(divisor)) {
        throw new TypeError("Invalid input", "myfile.js", 12, {
          value: value,
          divisor: divisor
        });
      } else {
        if (divisor == 0) {
          throw new RangeError("Divide by 0", "myfile.js", 15, {
            value: value,
            divisor: divisor
          });
        }
      }
    } catch (e) {
      _logServer.logError(e.name, e.message, e.stack);

    }
  }
  // another use of logError in window.onerror
  // must be careful with window.onerror as you might be overwriting some one else's window.onerror functionality
  // also someone else can overwrite window.onerror.
window.onerror = function(msg, url, line, column, err) {
  // may want to check if url belongs to your javascript file
  var data = {
    url: url,
    line: line,
    column: column,

  }
  _logServer.logError(err.name, err.message, err.stack, data);

};

//example for custom logs
var foo = "some variable value";
var bar = "another variable value";
var flag = "false";
var temp = "yet another variable value";

_logServer.log(foo, bar, flag, temp);
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-05-17T17:24:12.410

虽然我希望它对实时跟踪和历史日志有更好的 JSON 对象美化，但以下 JS 客户端也可以工作并支持您的服务器端要求：

[https://github.com/logentries/le_js/wiki/API](https://github.com/logentries/le_js/wiki/API)

```
<html lang="en">
  <head>
    <title>Your page</title>
    <script src="/js/le.min.js"></script>
    <script>
    // Set up le.js
    LE.init('YOUR-LOG-TOKEN');
    </script>
 </head> 
```

......

```
<script>
// log something
LE.log("Hello, logger!");
</script> 
```

然而，就个人而言，要使上述代码正常工作，我必须在上面添加以下代码行`LE.init('YOUR-LOG-TOKEN')`：

```
window.LEENDPOINT = 'js.logentries.com/v1' 
```

.. 或者，Loggly 也可能适合：[https ://www.loggly.com/docs/javascript/](https://www.loggly.com/docs/javascript/)

# c# - 如何浏览或提取旧 (.db) 文件

> ID：11694592
> 
> 赞同：2
> 
> 时间：2012-07-27T19:37:41.107
> 
> 标签：c#, .net, database

我有一个旧的（.db）数据库文件，我需要提取它的内容或将其与 ac# 应用程序一起使用，但我不知道要使用哪个软件，请帮我检查列出 db 文件类型的链接。

[http://www.file-extensions.org/search/?searchstring=db&searchtype=2](http://www.file-extensions.org/search/?searchstring=db&searchtype=2)

谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T19:49:20.493

好吧，检查您问题中的链接，我可以浏览与 DB 扩展相关的应用程序。经过快速分析，我认为 dBASE 会满足您的需求。

[http://www.file-extensions.org/dbase-file-extensions](http://www.file-extensions.org/dbase-file-extensions)

它允许您打开、编辑、保存并转换为可能更适合您的另一个扩展程序。

我猜 MS Access 和 SQLite 可以为你做同样的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-29T14:31:13.157

问题是，它`*.db`已被*许多*程序使用。

使用任何 Unixoid 系统（Linux、BSD、MacOS），您都可以使用该`file(1)`实用程序来获取可能创建该文件的程序。使用此信息，您可以在此处寻求更*具体*的帮助。

作为*我的* `*.db`文件和输出的示例`file`：

```
/etc/libgda-4.0/sales_test.db:  SQLite 3.x database
/home/XXX/.mozilla/firefox/cert8.db:   Berkeley DB 1.85 (Hash, version 2, native 
/var/cache/man/cs/index.db: GNU dbm 1.x or ndbm database, 
```

# c# - TCP 端口侦听器不工作

> ID：11694593
> 
> 赞同：0
> 
> 时间：2012-07-27T19:37:43.987
> 
> 标签：c#, sockets, tcplistener

我需要将手持设备与 PC 连接。所以我正在关注这个具有客户端和服务器程序的[MSDN 示例。](http://msdn.microsoft.com/en-us/library/bb397809.aspx)

现在，掌上电脑是通过GPRS连接的。如果我在手持设备上运行客户端程序并监听 PC 上的端口，我会看到手持设备发送的数据。但是，如果我运行服务器程序，它不会收到任何东西。

我的代码完全遵循示例，只修改了两个程序中的端口（11000），在客户端中我将服务器 IP 更改为我的公共地址。

为什么我在我的 TCP 侦听器中看到数据，但在我的服务器程序中看不到？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T20:23:32.613

问题出在服务器代码中。配置 IPAddress 时，它没有创建正确的 IPAddress。

我用这一行更改了这一行，现在一切正常：

```
IPAddress ipAddress = new IPAddress(new byte[] { 192, 168, 1, 10 }); 
```

希望对另一个面临同样问题的人有所帮助！

# c++ - 有没有人在 Windows 7 机器上成功编译过 Vowpal Wabbit？

> ID：11694597
> 
> 赞同：3
> 
> 时间：2012-07-27T19:37:55.007
> 
> 标签：c++, windows, cygwin, mingw, vowpalwabbit

我正在尝试在 Windows 7 机器上编译 Vowpal Wabbit，在尝试了 Netbeans、Cygwin 和 MinGW 之后，我开始怀疑我是否正在尝试一些可行的方法。

以上每个都需要*** *.h 文件，这些文件不是为 Windows 设计的，例如 sys/socket.h。

任何实际这样做过的人，我都会很感激任何建议。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-05T02:16:31.380

*   运行cygwin的setup.exe，输入“boost”，多次点击“Default”直到变成“Install”，继续从cygwin安装boost库。
*   下载最新的 Vowpal Wabbit 并解压到您的 vw 目录。
*   打开 cygwin 并转到 Makefile 所在的 vw 目录 (cd .. (see @home) cd vw_dir)
*   在 cygwin 命令提示符下键入“make”

之后你可以关闭 cygwin，并使用 cmd 运行 vowpal。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-28T20:14:01.400

我从一个 kaggle 论坛上得到这个：“我设法在没有 Professional Visual Studio 2010 的 Windows 7 64 位下编译 VW。

您可以使用 Cygwin ( [http://www.cygwin.com/](http://www.cygwin.com/) ) 来完成。

1.  首先在您的计算机上安装 Cygwin：只需选择标准配置即可

2.  运行 Cygwin shell 并输入： git clone git://github.com/JohnLangford/vowpal_wabbit.git

3.  下载完成后写入：cd vowpal_wabbit

4.  此时可以运行命令：configure

5.  配置过程将指出系统中缺少的所有库，您应该通过再次运行 Cygwin 安装程序来安装

6.  在第 5 点的一些迭代之后，您最终将向 Cygwin 提供所有必要的库，您可以运行以下命令：make

7 在编译器完成 vw.exe 的 make 后，运行：make test 以检查您的构建是否一切正常。

现在你可以在Windows下开始使用VW了，只要打开一个shell试试看。"

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-07-09T02:43:29.337

另一个更新，Windows 的二进制版本自 2016 年 6 月 21 日起可用。截至今天的最新链接是：[https ://github.com/eisber/vowpal_wabbit/releases/tag/v8.2.0.6](https://github.com/eisber/vowpal_wabbit/releases/tag/v8.2.0.6)

它在 MSI 安装程序文件中可用。

（如果您将来遇到死链接，请从 eisber 的 github repo 中查找最新版本。）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-02T14:03:48.243

John Langford 最近在 VW 邮件列表中发帖称，Windows 端口正在开发中，但在某些方面仍然存在问题。我怀疑目前不可能让大众在 Windows 上运行（但我实际上没有尝试过）

[从这个线程：](http://tech.groups.yahoo.com/group/vowpal_wabbit/message/1029)

> Chris Quirk 为 VW 创建了一个 Windows 端口，该端口现已发布。它仍然不完整：网络和线程是问题点。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-11-14T03:52:05.383

我设法在没有 cygwin、本机 Windows 的情况下在 64 位 win 上构建。花了很长时间为构建设置环境，所以我写了一篇关于它的博客。我知道自我推销是不受欢迎的，但[这个链接有我](http://www.picnet.com.au/blogs/guido/post/2014/11/13/vowpal-wabbit-for-windows-and-binary-for-win-x64/)在我的机器上构建的二进制文件，保证只能在我的机器上工作，但任何人都可以免费试用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-05-05T03:50:39.567

为好奇的 googlers 更新：最近更新了 VW Windows 说明，如果您获得最新的源代码，您应该能够在 Visual Studio 上编译而没有重大障碍（我已成功尝试）：[https ://github.com/ JohnLangford/vowpal_wabbit/blob/master/README.windows.txt](https://github.com/JohnLangford/vowpal_wabbit/blob/master/README.windows.txt)

# c - Win32 API 处理数组

> ID：11694598
> 
> 赞同：1
> 
> 时间：2012-07-27T19:37:58.497
> 
> 标签：c, arrays

我是程序员的初学者。我不明白为什么不能将一些脚本从数组复制到另一个。

```
char array1[11];
char array2[2];
array1 = {'255 105 85'};
array2[0] = array1[0];
array2[1] = array1[1];
array2[2] = array1[2];

MessageBox(hwnd,array2,"mes",NULL); 
```

我得到的是“5”而不是“255”。我使用带有 GCC 编译器的 code::blocks。使用基于 win32 框架创建的项目。有人知道导致问题的原因是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T19:54:37.560

C 中不允许以下构造：

```
array1 = {'255 105 85'}; 
```

相反，您可以考虑使用这样的静态数组初始化：

```
char array1[11] = {255, 105, 85}; 
```

这将用 3 个指定值填充 array1 并将所有其他元素设置为 0（即元素以索引 3 开始并以索引 10 结束）。

令人惊讶的是，为什么编译器在您的情况下没有发出语法错误

**更新：** 还请注意，当您有这样的 array1[2] 表达式时，您正在使用单个字符进行操作。如果您想对字符串进行操作（即，您指定的数字有 3 个单独的字符串），您必须声明如下内容：

```
 char *array1[3] = {
         "255",
         "105",
         "85"
   };

   char *array2[3];

   array2[0] = array1[0];
   array2[1] = array1[1];
   array2[2] = array1[2]; 
```

因此，您将拥有一个字符串数组。array1 的每个条目将包含字符串“255”所在的内存的指针（地址）（请注意，“255”是一个包含 4 个字符的数组：'2'、'5'、'5'、'\0 '）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T19:52:01.183

Array1 应该这样声明：

`char array1[] = {0x255, 0x105, 0x85};`

单引号用于 ascii 中的单个字符，例如`'a'`or`'6'`或`'!'`。

此外，array2 的长度为 2，但您正在为第三个值 ( `array2[2]`) 分配一个值。这可能是一个错误。

# powershell - Powershell切换一对多关联

> ID：11694601
> 
> 赞同：2
> 
> 时间：2012-07-27T19:38:19.093
> 
> 标签：powershell, switch-statement, powershell-2.0, one-to-many

我想知道是否可以创建每个案例超过 1 个值的开关案例。我试图以不同的方式接受用户输入。菜单看起来像：

```
 $database = Read-Host "[1] db 1 [2] db2 [3] db3 [4] ALL dbs" 
```

然后根据用户在我的下一个读取主机中的响应，将其作为参数传递给 4 个不同的函数。在不制作大量案例的情况下，我希望能够接受所有可能的输入。即，如果用户想查看 2 个数据库，他们可以输入 32 或 23。如果他们想查看全部，它将接受 4、321、123、213... 目前我正在尝试通过以下方式完成此操作：

```
switch ($database) { 
(4 -or 123 -or 312 -or ...) {#return all paths}
(12 -or 21) { #return 1st 2 db paths}
(31 -or 13) { #return 1st and last db paths}
(1) {#return 1st db path}
...
} 
```

这会导致语法错误，因此它显然不起作用。如您所知，已经有很多案例（7）。如果我必须列出每一个选项，那将是两倍以上（16）。有没有办法在开关盒中创建一对多关联？如果没有，有没有人知道我可以采取的新方法来解决这个问题？

**解决方案**

```
 switch -regex ($database)
            {
                "[*1*]" {"\\db1"}
                "[*2*]" {"\\db2"}
                "[*3*]" {"\\db3"} 
                "[4]" {"\\db1";"\\db2";"\\db3"}
                default {Write-Host "Database(s) were not properly specified,
 Please run the script again"
exit}
            } 
```

这实现了我的目标，虽然我从来不知道如何`-or`在 switch 语句中放置条件，但我不相信这是可能的

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T21:03:06.437

你能用`string.Contains`吗？

```
$result = ""
if ($database.Contains("1") -or $database -eq "4") {
    $result += "db path 1";
}
if ($database.Contains("2") -or $database -eq "4") {
    $result += "db path 2";
}
if ($database.Contains("3") -or $database -eq "4") {
    $result += "db path 3";
}
if ($result = "") {
    #Error condition?
}
return $result 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T22:12:13.117

```
$database = Read-Host "[1] db 1 [2] db2 [3] db3 [4] ALL dbs"

if($database -like "*4*")
{
    "return all paths"
}
else
{
    [char[]]$database | Select-Object -Unique | Foreach-Object { "return db $_ path" }  
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-27T19:45:56.030

我认为你可以工作

```
switch -regex ($database) 
```

- 看看[这里](http://technet.microsoft.com/en-us/library/ff730937.aspx)

# android - 安卓 SQLite 3 教程

> ID：11694603
> 
> 赞同：-2
> 
> 时间：2012-07-27T19:38:44.017
> 
> 标签：android, sql, sqlite

所以我有一个名为`db.sqlite3`. 我在一个 Android 项目上工作。我需要对它做一些查询。

我有很多关于它的问题 - 有没有好的教程？

最重要的是，我把数据库放在哪里了？（在项目中不是很大，而是哪个文件夹？）

如何进行查询？

（当我搜索它时，我没有找到任何相关的东西。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T19:50:14.977

将数据库放在资产文件夹中。在运行时，您可以像这样访问它：

```
InputStream db = activityContext.getAssets().open("db.sqlite3"); 
```

您可以将其写入任何您想要的地方，但最好将其存储在`/data/data/%app_package_name%/databases`文件夹中。

然后扩展 SQLiteOpenHelper 并将“db.sqlite3”作为名称参数传递：

```
SQLiteOpenHelper(Context context, String name, SQLiteDatabase.CursorFactory factory, int version) 
```

稍后，您可以对返回的对象进行`getReadableDatabase()`或和发出查询。`getWritableDatabase()`

# git - Xcode 4.4 无法识别 git

> ID：11694605
> 
> 赞同：3
> 
> 时间：2012-07-27T19:38:47.947
> 
> 标签：git, xcode4, osx-mountain-lion

昨天我对 Mountain Lion 进行了全新安装，然后手动传输了所有文件。其中一个文件夹包含我的 Xcode 项目，其中一些项目中有 git 存储库。我安装了 Xcode 4.4，但是当我打开一个 git 项目时，它不再识别任何更改。也就是说，我可以进行更改并尝试提交它，但它只是说“没有文件”。项目导航器中的小 M 或 A 或其他任何内容也不会显示。我安装了命令行工具。`git`

我错过了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-28T00:02:10.140

打开管理器窗口 (Cmd-Shift-2) 并单击存储库选项卡。它出现在那里吗？是否说明有问题？此外，尝试关闭项目，单击 Organizer 的 Projects 选项卡，选择您的项目并将其从管理器中删除（您的项目不会被删除，只有 Xcode 对它的“感知”，直到您再次打开它）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-28T07:11:45.137

重新安装 Xcode 工作。仍然不知道出了什么问题，但我关心的是它现在正在工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-08T15:56:19.383

我在使用 Git 和 Xcode 时遇到了类似的问题。当我调用时，我的文件被标记为*已删除*和*未暂存*`git status`，这与我之前调用的次数无关`git add`。我的项目文件夹同时使用 SugarSync 同步。`.git`在我从 SugarSync 中排除该文件夹`git reset`并对受影响的文件进行处理后，一切都再次正常工作。

因此，请检查是否有任何同步服务（iCloud、Dropbox 等）没有干扰 Git 的领域。

# javascript - JQuery UI 选项卡闯入安全 (https) 页面

> ID：11694608
> 
> 赞同：1
> 
> 时间：2012-07-27T19:38:58.093
> 
> 标签：javascript, jquery, security, user-interface, https

我正在使用开箱即用的 JQuery UI 选项卡——它们在不安全的页面上运行良好，但在安全的 https:// 页面上却不行。

我这样称呼我的脚本：

```
 <script src="//code.jquery.com/ui/1.8.22/jquery-ui.min.js" type="text/javascript"></script>
        <script src="//jquery-ui.googlecode.com/svn/tags/latest/external/jquery.bgiframe-2.1.2.js" type="text/javascript"></script>
        <script src="//jquery-ui.googlecode.com/svn/tags/latest/ui/minified/i18n/jquery-ui-i18n.min.js" type="text/javascript"></script> 
```

此处的示例：http: [//ntcla.com/fb-static.php](http://ntcla.com/fb-static.php)和 [https://ntcla.com/fb-static.php](https://ntcla.com/fb-static.php)

（见页面底部的地图）

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T19:45:18.533

看起来 code.jquery.com 链接上存在 SSL 证书错误。您可以下载它并将其托管在您自己的站点/CDN 上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T12:20:24.787

当您尝试以下列方式使用任何 js 时，将引发 SSL 证书错误

下载上述文件并将它们复制到您的服务器上并使用脚本上的相对路径访问它们

# android - onResume 中的动画阻止了另一个活动的 onDestroy

> ID：11694615
> 
> 赞同：0
> 
> 时间：2012-07-27T19:39:26.090
> 
> 标签：android

我有以下两个活动，ActivityA 和 ActivityB。

在 ActivityA.java

```
startActivity(new Intent(this, ActivityB.class));
finish(); 
```

在 ActivityB.java 中

```
public void onResume() {
    super.onResume();
    anim1 = new TranslateAnimation(0, 0, fromYDelta, -height);
    anim1.setDuration(8000);
    anim1.setFillAfter(true);
    anim1.setStartOffset(0);
    aView.startAnimation(anim1);
} 
```

在 ActivityA 中启动 ActivityB 并完成自身的代码运行后，活动生命周期回调按以下顺序调用：

```
ActivityA.onPause();
ActivityB.onStart();
ActivityB.onResume(); //Start 8 seconds animation here
ActivityA.onStop();
ActivityA.onDestroy(); 
```

现在的问题是在调用 ActivityB.onResume() 后 8 秒调用了 ActivityA.onStop()，因为 ActivityB 的 onResume() 中启动了 8 秒动画。它在我的应用程序中导致了 OutOfMemoryError，因为 ActivityA.onDestroy() 被调用得很晚，系统不得不长时间持有 ActivityA 中的所有资源。

有什么建议么？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T20:02:48.223

我之前调查过这个问题，发现 Android 操作系统不保证活动一进入后台就会被销毁。首先，将优先考虑新的活动进行初始化并进入空闲状态。**只有在那之后**，您以前的活动才会被破坏。因此，没有本机解决方案。您不应该期望 onDestroy() 会在您调用`finish()`. 何时调用它完全取决于操作系统

检查这些线程 - 可能它会阐明您的问题：

[https://groups.google.com/forum/?fromgroups#!topic/android-developers/aDa7fiVL2Zg](https://groups.google.com/forum/?fromgroups#!topic/android-developers/aDa7fiVL2Zg)

[https://groups.google.com/forum/?fromgroups#!topic/android-developers/jkj_PvE9O1A](https://groups.google.com/forum/?fromgroups#!topic/android-developers/jkj_PvE9O1A)

# javascript - jquerymobile，将控件放在标题中

> ID：11694618
> 
> 赞同：0
> 
> 时间：2012-07-27T19:39:34.553
> 
> 标签：javascript, jquery-mobile, header

我试图在标题中放置几个​​控件。但是，下拉列表和分组复选框继续落入它们自己的行中。

这是我到目前为止所拥有的一个jsfiddle：

[http://jsfiddle.net/BxxC2/1/](http://jsfiddle.net/BxxC2/1/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-28T04:21:38.737

您也许可以使用“四列”布局网格。布局网格用于“内容”部分，但仍适用于“标题”部分。

文件在这里：http: [//jquerymobile.com/demos/1.1.1/docs/content/content-grids.html](http://jquerymobile.com/demos/1.1.1/docs/content/content-grids.html)

```
 <div class="ui-grid-c">
     <div class="ui-block-a">Block A</div>
     <div class="ui-block-b">Block B</div>
     <div class="ui-block-c">Block C</div>
     <div class="ui-block-d">Block D</div>
 </div><!-- /grid-c --> 
```

默认情况下，此网格创建 25%/25%/25%/25% 宽度，因此您可以添加 CSS 样式来调整宽度，如下所示：

```
 <div class="ui-grid-c">
     <div class="ui-block-a" style="width:15%;">Block A</div>
     <div class="ui-block-b" style="width:50%;">Block B</div>
     <div class="ui-block-c" style="width:20%;">Block C</div>
     <div class="ui-block-d" style="width:15%;">Block D</div>
 </div><!-- /grid-c --> 
```

你的代码可能是这样的：

```
<!-- Home -->
<div id="page1" data-role="page">
  <div data-role="header" data-theme="a" data-position="fixed">

    <div class="ui-grid-c">
        <div class="ui-block-a" style="width:15%;">
            <a class="ui-btn-left" 
            href="#page1" 
            data-iconsize="26" 
            data-role="button"
            data-theme="b" 
            data-transition="fade"
            data-inline="true"
            data-iconpos="left"
            data-icon="ios-pack-color-left-arrow">Button</a>
        </div>
        <div class="ui-block-b" style="width:260px;">

            <fieldset data-role="controlgroup" data-type="horizontal">

            <input id="checkbox1" name="checkbox1" type="checkbox">
            <label for="checkbox1">
                Checkbox
            </label>
            <input id="checkbox2" name="checkbox2" type="checkbox">
            <label for="checkbox2">
                Checkbox
            </label>
            <input id="checkbox3" name="checkbox3" type="checkbox">
            <label for="checkbox3">
                Checkbox
            </label>
            </fieldset>

        </div>
        <div class="ui-block-c" style="width:150px;padding-top:5px;">

            <select id="selectmenu1" name="selectmenu1" data-mini="true">
                <option value="option1">
                    Dropdown Box
                </option>
            </select>
        </div>
        <div class="ui-block-d" style="width:20%;text-align:right;">
            <a href="#page1" data-iconsize="26" 
            data-role="button" data-theme="b"
            data-transition="fade" data-iconpos="left" 
            data-icon="ios-pack-color-star">Button</a>
        </div>
    </div><!-- /grid-b -->

  </div>
  <div style="padding: 15px;" data-role="content">
  </div>
</div>​ 
```

谢谢你。

# javascript - 当涉及到 if 语句时，如何让 Javascript 不区分大小写？

> ID：11694620
> 
> 赞同：1
> 
> 时间：2012-07-27T19:39:41.043
> 
> 标签：javascript

我完全理解 Javascript 是区分大小写的，但是当涉及到 if 语句时，Sam 不等于 sam。我创建了一个调用此函数的提示框，我希望它在您在提示框中键入名称时将 sam 转换为 Sam 或将两者都设为 True。

```
function search(name) {
var ourContacts = contacts.length;
for (var i = 0; i < ourContacts; i++) {
if (contacts[i].name === name) {
printdog(contacts[i]);
}
}
} 
```

如果您需要它以获得更好的理解，这是我的整个脚本。

```
function dog(name, breed, age, color, weight, owner, owneraddress) {
    this.name = name;
    this.breed = breed;
    this.age = age;
    this.color = color;
    this.weight = weight;
    this.owner = owner;
    this.owneraddress = owneraddress;
}
//My Dogs
var sam = {
    name: "Sam",
    breed: "Chihuahua",
    age: 7,
    color: "White",
    weight: "7 lb",
    owner: "Bourton",
    owneraddress: "44 Berkley Drive"
};
var max = {
    name: "Max",
    breed: "Chihuahua",
    age: 4,
    color: "Brown",
    weight: "5 lb",
    owner: "Smith",
    owneraddress: "134 Door Ave"
};

//My array of dogs
var contacts = [sam, max];

function printdog(dog) {
    console.log(dog.name + " " + dog.owner);
}
function list() {
var ourContacts = contacts.length;
for (var i = 0; i < ourContacts; i++) {
printdog(contacts[i]);
}
}
list();
function search(name) {
var ourContacts = contacts.length;
for (var i = 0; i < ourContacts; i++) {
name = name.toLowerCase;
if (contacts[i].name === name) {
printdog(contacts[i]);
}
}
}

<button onclick="search(prompt('Search Dogs Name'))">Search for Dog</button> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-27T19:40:50.833

`.toUpperCase()`你可以在相等比较器之前在两端做类似的事情

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T19:41:19.757

只需[小写](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String/toLowerCase)或[大写](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String/toUpperCase)所有内容（搜索和数据）。您已经尝试为 执行此操作`name`，但未尝试执行此操作`contacts[i].name`（并且它们被命名为“Sam”和“Max”，因此它们永远不会等于小写输入字符串）。

此外，您忘记执行该函数 - 您只是获得了对它的引用。

```
function search(name) {
    var ourContacts = contacts.length;
    name = name.toLowerCase();
//                         ^^
    for (var i = 0; i < ourContacts; i++) {
        if (contacts[i].name.toLowerCase() === name) {
//                          ^^^^^^^^^^^^^^
            printdog(contacts[i]);
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-27T19:41:30.007

您可以在两个操作数上使用 Javascript [.toUpperCase()](http://www.w3schools.com/jsref/jsref_touppercase.asp)方法：

```
if (contacts[i].name.toUpperCase() === name.toUpperCase()) 
```

或者，您可以在两个操作数上使用[.toLowerCase()](http://www.w3schools.com/jsref/jsref_tolowercase.asp)方法：

```
if (contacts[i].name.toLowerCase() === name.toLowerCase()) 
```

# java - 我怎样才能让它更快？

> ID：11694622
> 
> 赞同：2
> 
> 时间：2012-07-27T19:39:46.263
> 
> 标签：java

我做了一个事件系统，但是太慢了。

问题是，我从未实际添加的地图中有多个条目。我不明白他们是如何到达那里的。

```
public class OrdinalMap<V> {

    private final Map<Integer, V> map;

    public OrdinalMap(Class<? extends Enum<?>> valueType, V virginValue) {
        map = new HashMap<Integer, V>();
        Enum<?>[] enums = valueType.getEnumConstants();
        for (int i = 0; i < enums.length; i++) {
            put(enums[i].ordinal(), virginValue);
        }
    }

    public OrdinalMap(Class<? extends Enum<?>> valueType) {
        this(valueType, null);
    }

    public V put(Integer key, V value) {
        return map.put(key, value);
    }

    public V get(Object o) {
        return map.get(o);
    }

    public Set<Entry<Integer, V>> entrySet() {
        return map.entrySet();
    }

} 
```

我想让*dispatchEvent*更快（更少的迭代）。*由于registerListener*它有太多的迭代

 *在所有其他优先级中都有事件处理程序方法，但它们不应该存在。我不知道为什么会有，但我确定它在*registerListener*中。因为它们在所有优先级中，所以我必须使用此检查： *if (mapping.getKey().getAnnotation(EventHandler.class).priority().ordinal() == entry.getKey()) {*

这使它变得更慢。

```
@Override
public void dispatchEvent(Event event) {
    OrdinalMap<Map<Method, EventListener>> priorityMap = getRegistry().get(event.getClass());

    if (priorityMap != null) {
        CancellableEvent cancellableEvent = null;
        boolean cancellable;
        if (cancellable = event instanceof CancellableEvent) {
            cancellableEvent = (CancellableEvent) event;
            if (cancellableEvent.isCancelled()) return;
        }

        try {
            for (Entry<Integer, Map<Method, EventListener>> entry : priorityMap.entrySet()) {
                for (Entry<Method, EventListener> mapping : entry.getValue().entrySet()) {
                    if (mapping.getKey().getAnnotation(EventHandler.class).priority().ordinal() == entry.getKey()) {
                        mapping.getKey().invoke(mapping.getValue(), event);
                        if (cancellable && cancellableEvent.isCancelled()) return;
                    }
                }
            }
        } catch (InvocationTargetException | IllegalAccessException e) {
            e.printStackTrace();
        }
    }
}

@Override
public void registerListener(EventListener listener) {
    for (Method method : listener.getClass().getMethods()) {
        EventHandler handler = method.getAnnotation(EventHandler.class);
        if (handler != null) {
            Class<?>[] parameters = method.getParameterTypes();
            if (parameters.length == 1) {
                @SuppressWarnings("unchecked")
                Class<? extends Event> event = (Class<? extends Event>) parameters[0];
                EventPriority priority = handler.priority();

                OrdinalMap<Map<Method, EventListener>> priorityMap = getRegistry().get(event);
                if (priorityMap == null) {
                    priorityMap = new OrdinalMap<Map<Method, EventListener>>(EventPriority.class, (Map<Method, EventListener>) new HashMap<Method, EventListener>());
                }

                Map<Method, EventListener> methodMap = priorityMap.get(priority.ordinal());

                methodMap.put(method, listener);
                priorityMap.put(priority.ordinal(), methodMap);

                getRegistry().put(event, priorityMap);
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-27T21:19:41.907

您正在使用地图，因此请考虑使用其好处而不是迭代所有条目

```
if (mapping.getKey().getAnnotation(EventHandler.class).priority().ordinal() == entry.getKey()) { 
```

比较两个 hahmap 键以找到匹配项并不是一个好主意。

以下怎么样，我希望我没有犯任何思考错误

```
Set<Integer> priorityMapKeySet = priorityMap.keySet();
for (Map<Method, EventListener> mapping : priorityMap.values()) {
    if (priorityMapKeySet.contains(mapping.getKey().getAnnotation(EventHandler.class).priority().ordinal())) {
        mapping.getKey().invoke(mapping.getValue(), event);
        if (cancellable && cancellableEvent.isCancelled()) return;
    }
} 
```

在这里你不再有外部 for 循环

我的坏，没有引起足够的重视...

但是想法是一样的，当使用 hashmaps / hashsets 时，应该始终尝试使用 get / contains 而不是迭代，为此需要设计注册表以使其成为可能

以下内容可以满足您的需求吗？（未经测试）

```
private final static class Registry {

    private final static Map<String, Set<Integer>>  prioritySetByEventMap = new HashMap<>();
    private final static Map<String, EventListener> eventListenerByEventAndPriorityMap = new HashMap<>();
    private final static Map<String, Method> methodByEventAndListenerMap = new HashMap<>();

    public static Set<Integer> getPrioritySetByEvent(Class<Event> event) {
        return prioritySetByEventMap.get(event.getName());
    }

    public static synchronized void registerEventByPriority(Class<Event> event, Integer priority) {
        Set<Integer> ps = prioritySetByEventMap.get(event.getName());
        if(ps == null) {
            ps = new HashSet<>();
            prioritySetByEventMap.put(event.getName(), ps);
        }
        ps.add(priority);
    }

    public static EventListener getEventListenerByEventAndPriority(Class<Event> event, Integer priority) {
        String key = event.getName() + "-" + priority;
        return eventListenerByEventAndPriorityMap.get(key);
    }

    public static synchronized void registerEventListenerByEventAndPriority(Class<Event> event, Integer priority, EventListener listener) {
        String key = event.getName() + "-" + priority;
        eventListenerByEventAndPriorityMap.put(key, listener);
    }

    public static Method getMethodByEventAndListener(Class<Event> event, EventListener listener) {
        String key = listener.toString() + "-" + event.getName();
        return methodByEventAndListenerMap.get(key);
    }

    public static synchronized void registerMethodByEventAndListener(Class<Event> event, EventListener listener, Method method) {
        String key = listener.toString() + "-" + event.getName();
        methodByEventAndListenerMap.put(key, method);
    }
} 
```

和

```
public void registerListener(EventListener listener) {
    for (Method method : listener.getClass().getMethods()) {
        EventHandler handler = method.getAnnotation(EventHandler.class);
        if (handler != null) {
            Class<?>[] parameters = method.getParameterTypes();
            if (parameters.length == 1) {

                Class<Event> event = (Class<Event>) parameters[0];

                EventPriority priority = handler.priority();

                Registry.registerEventByPriority(event, priority.ordinal());

                Registry.registerEventListenerByEventAndPriority(event, priority.ordinal(), listener);

                Registry.registerMethodByEventAndListener(event, listener, method);

            }
        }
    }
}

public void dispatchEvent(Event event) {
    Set<Integer> prioritySet = Registry.getPrioritySetByEvent((Class<Event>) event.getClass());

    if (prioritySet != null) {
        CancellableEvent cancellableEvent = null;
        boolean cancellable;
        if (cancellable = event instanceof CancellableEvent) {
            cancellableEvent = (CancellableEvent) event;
            if (cancellableEvent.isCancelled())
                return;
        }

        try {

            for(Integer priority : prioritySet) {

                EventListener listener = Registry.getEventListenerByEventAndPriority((Class<Event>) event.getClass(), priority);

                if(listener != null) {
                    Method m = Registry.getMethodByEventAndListener((Class<Event>) event.getClass(), listener);
                    if(m != null) {
                        m.invoke(listener, event);
                        if (cancellable && cancellableEvent.isCancelled()) {
                            return;
                        }
                    }
                }
            }

        } catch (InvocationTargetException | IllegalAccessException e) {
            e.printStackTrace();
        }
    }
} 
```*

# c# - SQL Server 紧凑型插入

> ID：11694623
> 
> 赞同：2
> 
> 时间：2012-07-27T19:39:47.503
> 
> 标签：c#, sql-server-ce

我想将数据插入到 sql server Compact edition 数据库表截图在[这里 >>>](http://www.flickr.com/photos/56760865@N04/7657986538) 我想在用户中添加数据添加脚本如下

```
SqlCeConnection Con = new SqlCeConnection();
Con.ConnectionString = "Data Source = 'Database.sdf';" +
                       "Password='Password';";
Con.Open();
int Amount=Convert.ToInt32(AmBox.Text),
Code=Convert.ToInt32(MCode.Text),
Num=Convert.ToInt32(MNum.Text);
string Name=Convert.ToString(NBox.Text),
FName=Convert.ToString(SOBox.Text),
Address=Convert.ToString(AdBox.Text);

SqlCeCommand Query =new SqlCeCommand("INSERT INTO Users VALUES " + 
                        "(++ID,Name,FName,Address,Code,Num,Amount)",Con);
Query.ExecuteReader(); 
```

当它运行时，它会生成错误说“列名无效[节点名（如果有）=，列名=ID]

我不知道问题请告诉我谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-27T19:56:34.670

你应该把你的代码改成这样

```
using(SqlCeConnection Con = new SqlCeConnection("Data Source = 'Database.sdf';" + 
                                                "Password='Password';")
{ 
    Con.Open(); 
    SqlCeCommand Query = new SqlCeCommand("INSERT INTO Users " + 
                             "(Name,FName,Address,MCode,MNum,Amount) " +
                             "VALUES (@Name,@FName,@Address,@Code,@Num,@Amount)",Con); 

    Query.Parameters.AddWithValue("@Name", NBox.Text);
    Query.Parameters.AddWithValue("@FName", SOBox.Text)); 
    Query.Parameters.AddWithValue("@Address",AdBox.Text)); 
    Query.Parameters.AddWithValue("@Code", Convert.ToInt32(MCode.Text));
    Query.Parameters.AddWithValue("@Num", Convert.ToInt32(MNum.Text));
    Query.Parameters.AddWithValue("@Amount" , Convert.ToInt32(AmBox.Text));
    Query.ExecuteNonQuery(); 
} 
```

*   using 语句保证连接的正确处理
*   Parameter 集合避免 Sql Injection Attacks 和引用问题
*   使用 of`ExecuteNonQuery`因为这是一个插入查询。
*   删除了 ++ID，它不是传递给数据库的有效值

如果 ID 字段是 Identity 列，那么您不会从代码中传递任何值，而是让数据库计算下一个值。
另外，我不确定您是否真的需要在数据源和密码键周围的连接字符串中使用单引号。

编辑 --- 有时 .SDF 数据库可能位于不同的文件夹中。（现代操作系统阻止写入应用程序文件夹）。
在这种情况下，需要在连接字符串中设置 SDF 文件的路径。
例如，SDF 可能位于 C:\ProgramData 目录的子文件夹中。

```
string conString = "Data Source=" + 
        Path.Combine(
               Environment.GetFolderPath(Environment.SpecialFolder.CommonApplicationData),
               "MyAppData\\database.sdf") + ";Password=yourPassword;"; 
```

# algorithm - 编辑距离变化

> ID：11694624
> 
> 赞同：0
> 
> 时间：2012-07-27T19:39:48.077
> 
> 标签：algorithm, data-structures, dynamic-programming

通过“Cormen 等人”的“算法简介”，我遇到了一个非常流行的动态规划问题，名为“编辑距离”。在阅读它并设计它的解决方案时，我对可能的相同变化感到困扰。

假设问题是：
给定两个字符串和操作：复制、插入、删除、匹配、旋转、杀死。
同样作为输入，我们给出了转换的数量（比如：**n**）。
查找是否可以在恰好“n”个转换中将第一个字符串转换为第二个字符串。

**注意：**给定的转换数可能大于最小转换数。

提前致谢。

# iphone - 如何为 iPhone 应用程序实现悬停提示？

> ID：11694630
> 
> 赞同：0
> 
> 时间：2012-07-27T19:40:24.163
> 
> 标签：iphone

我有一个 iPhone 应用程序，我想添加一些帮助提示。我在其他应用程序中看到过这种情况，您可能将鼠标悬停在文本字段或按钮上，然后会出现一个弹出窗口，向用户指示应该为该字段或按钮输入或完成的操作。

任何人都可以提供任何建议或例子吗？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T19:50:08.323

iPhone没有那种东西，因为你无法检测到有人何时将手指悬停在屏幕上，只有当你触摸它时。

如果您正在寻找向用户解释事物的方法，请查看其中一个设计模式库，例如[Mobile UI Patterns 上的 edu 演练](http://mobile-patterns.com/edu)。

# asp.net-mvc - 有没有一种简单的方法来查看 FormCollection 的内容？

> ID：11694631
> 
> 赞同：2
> 
> 时间：2012-07-27T19:40:26.357
> 
> 标签：asp.net-mvc, visual-studio-2010, debugging, formcollection

在测试/调试 ASP.NET MVC 应用程序时，通常会提交一个表单，然后检查所有名称/值对以确保

1.  所有预期的键都存在
2.  所有预期的键都有预期的值

在 Visual Studio 中进行调试非常适合检查单个变量（甚至是简单对象）是否包含预期值，并且就 FormCollection 而言，检查键的存在非常容易。但是，检查 FormCollection 中的键/值对是一件非常麻烦的事情。有没有一种简单的方法让 Visual Studio 并排列出键及其值以便快速检查？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-27T20:15:11.147

只是一个快速的自定义检查

```
 public void Edit(FormCollection team)
    {
        System.Text.StringBuilder st = new System.Text.StringBuilder();

        foreach (string key in team.Keys)
        {
            st.AppendLine(String.Format("{0} - {1}", key, team.GetValue(key).AttemptedValue));
        }

        string formValues = st.ToString();
        //Response.Write(st.ToString());
    } 
```

然后，您可以将鼠标放在上面`formValues`以检查键值。单击放大镜将显示键值

![在此处输入图像描述](../Images/73f00186b37133bb16e7929b516a39c2.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T19:48:47.200

看看[Glimpse](http://getglimpse.com/)，它在 nuGet 上。它公开了大量信息，对于 AJAX 和 MVC 开发来说非常宝贵。

> Glimpse 的核心允许您直接在浏览器中调试您的网站或 Web 服务。Glimpse 允许您“瞥见”您的 Web 服务器中正在发生的事情。换句话说，Firebug 用于调试客户端代码，Glimpse 用于在客户端中调试服务器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-07-23T22:03:21.677

这是一种以可读的键/值对格式将集合输出到即时窗口的方法，每行输出一对：

```
private void DebugWriteFormCollection(FormCollection collection)
{
    foreach (string key in collection.Keys)
    {
        string value = collection.GetValue(key).AttemptedValue;
        string output = string.Format("{0}: {1}", key, value);
        System.Diagnostics.Debug.WriteLine(output);
    }
} 
```

将其添加到您的代码中并设置断点。当您遇到断点时，从“立即”窗口调用该方法：

```
DebugWriteFormCollection(collection); 
```

结果：

```
Key1: Value1
Key2: Value2
Key3: Value3
etc. 
```

# c# - ASP.NET URL 重写混淆

> ID：11694635
> 
> 赞同：1
> 
> 时间：2012-07-27T19:40:44.420
> 
> 标签：c#, asp.net, iis, url-rewriting

我以前没有做过任何 URL 重写。在阅读[这篇](http://msdn.microsoft.com/en-us/library/ms972974.aspx)文章时，我在作者的 ModuleRewriter 类中遇到了一些问题，该类位于文章的一半左右。ModuleReWriter 中的代码引用了我找不到并且不知道如何创建自己的对象。它们是：

-RewriterRuleCollection
-RewriterUtils
-Regex

是我搞砸了还是作者的错？

# java - Google App Engine 将延迟任务添加到队列中会产生多个任务

> ID：11694638
> 
> 赞同：1
> 
> 时间：2012-07-27T19:40:59.087
> 
> 标签：java, google-app-engine

最近我注意到，当我重新安排延迟任务时，该任务会产生两个或多个完全相同的任务。我刚刚有一份工作产生了 4 个相同的任务。我们使用如下代码来重新安排我们的任务：

```
Queue q = null; 
if (queueName == null) 
  q = QueueFactory.getDefaultQueue(); 
else 
  q = QueueFactory.getQueue(queueName); 

TaskOptions to = TaskOptions.Builder.withPayload(this); 
q.add(to); 
```

这段代码非常简单，但它给我们的应用程序带来了很多问题。我们甚至尝试为任务命名，例如：

```
to.taskName(TASK_NAME); 
```

以防止重复任务无济于事。有没有其他人看到这个问题或有解决方案来防止重复。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-06-23T04:07:00.660

任务队列可能多次执行同一个任务。这是预期的行为。

您的任务必须是幂等的才能与任务队列一起使用。即，如果它运行多次，它必须表现得好像它运行一次。否则，您不能使用任务队列。

# google-apps-script - showDocsPicker - 添加到弹出窗口？

> ID：11694640
> 
> 赞同：1
> 
> 时间：2012-07-27T19:41:05.490
> 
> 标签：google-apps-script

我有一个很小的小工具，它放置在侧边栏中，其大小约为 100 像素宽。我有一个按钮，单击它会打开 showDocsPicker。我正在寻找一种解决方案，我可以将 showDocsPicker 的 UI 添加到弹出窗口或可以看到对话框的完整视图的东西......谁能指出我正确的方向？我在文档中看到了这一点，这并不令人鼓舞：

“与大多数 UiApp 对象不同，不应将 DocsListDialog 添加到 UiInstance 中。”

还有人试试这个吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T19:57:44.933

这是一个示例代码，它将在 fullView 中打开 docsPicker。

```
function doGet(){
  var app = UiApp.createApplication();
  var btn = app.createButton('Show Docs Picker');
  app.add(btn);
  var handler = app.createServerHandler('showdocsPicker_');
  btn.addClickHandler(handler);

  return app;
}

function showdocsPicker_(e){
  var app = UiApp.getActiveApplication();
  var handler = app.createServerHandler('listSelectedDocs_');
  app.createDocsListDialog().showDocsPicker().addSelectionHandler(handler).setMultiSelectEnabled(true)
    //for multiple selection
    .setMultiSelectEnabled(true);
  return app;
}

function listSelectedDocs_(e){
  var app = UiApp.getActiveApplication();
  for(var i in e.parameter.items){
    for(var j in e.parameter.items[i]){
      app.add(app.createLabel(e.parameter.items[i][j]));
    }
    app.add(app.createLabel('-------------'))
  }
  return app;
} 
```

# c# - 从后面的代码更新 GridView 行

> ID：11694645
> 
> 赞同：0
> 
> 时间：2012-07-27T19:41:27.743
> 
> 标签：c#, asp.net, datagrid, code-behind

当用户在编辑模板中更改文本框中的文本并单击更新时，当我尝试获取这些新值时，它仍然是文本框的旧值。

```
<asp:GridView ID="GridView1" runat="server" AutoGenerateColumns="False" 
        DataKeyNames="CompanyID" CellPadding="4"  
        GridLines="None" Width="1079px" ForeColor="#333333" 
        OnRowCancelingEdit="GridView1_RowCancelling"
        OnRowUpdating="GridView1_RowUpdating"
        OnRowEditing="GridView1_RowEditing">

        <AlternatingRowStyle BackColor="White" ForeColor="#284775" />
        <Columns>
            <asp:TemplateField ShowHeader="False">

                <EditItemTemplate>
                    <asp:LinkButton ID="LinkButton1" runat="server" CausesValidation="True" 
                        CommandName="Update" CommandArgument='<%# Eval("CompanyID") %>' Text="Update"></asp:LinkButton>
                    &nbsp;<asp:LinkButton ID="LinkButton2" runat="server" CausesValidation="False" 
                        CommandName="Cancel" Text="Cancel"></asp:LinkButton>
                </EditItemTemplate>
                <ItemTemplate>
                    <asp:LinkButton ID="LinkButton1" runat="server" CausesValidation="False" 
                        CommandName="Edit" Text="Edit" ></asp:LinkButton>
                </ItemTemplate>

            </asp:TemplateField>

            <asp:TemplateField HeaderText="Issue Date">

                <ItemTemplate>
                    <asp:Label runat="server" ID="IssueDate" Text='<%#Eval("IssueDate") %>' />                    
                </ItemTemplate>

                <EditItemTemplate>
                    <asp:TextBox runat="server" ID="txtIssueDate" Text='<%#Eval("IssueDate") %>' />
                </EditItemTemplate>

            </asp:TemplateField>

            <asp:TemplateField HeaderText="Notice Intent Response Due">

                <ItemTemplate>
                    <asp:Label runat="server" ID="NoticeIntentResponseDue" Text='<%#Eval("NoticeIntentResponseDue") %>' />                    
                </ItemTemplate>

                <EditItemTemplate>
                    <asp:TextBox runat="server" ID="txtNoticeIntentResponseDue" Text='<%#Eval("NoticeIntentResponseDue") %>' />
                </EditItemTemplate>

            </asp:TemplateField>

            <asp:TemplateField HeaderText="Deadline For Questions">

                <ItemTemplate>
                    <asp:Label runat="server" ID="DeadlineForQuestions" Text='<%#Eval("DeadlineForQuestions") %>' />                    
                </ItemTemplate>

                <EditItemTemplate>
                    <asp:TextBox runat="server" ID="txtDeadlineForQuestions" Text='<%#Eval("DeadlineForQuestions") %>' />
                </EditItemTemplate>

            </asp:TemplateField>

            <asp:TemplateField HeaderText="Bids Due">

                <ItemTemplate>
                    <asp:Label runat="server" ID="BidsDue" Text='<%#Eval("BidsDue") %>' />                    
                </ItemTemplate>

                <EditItemTemplate>
                    <asp:TextBox runat="server" ID="txtBidsDue" Text='<%#Eval("BidsDue") %>' />
                </EditItemTemplate>

            </asp:TemplateField>

            <asp:TemplateField HeaderText="Shortlist Notice">

                <ItemTemplate>
                    <asp:Label runat="server" ID="ShortlistNotice" Text='<%#Eval("ShortlistNotice") %>' />                    
                </ItemTemplate>

                <EditItemTemplate>
                    <asp:TextBox runat="server" ID="txtShortlistNotice" Text='<%#Eval("ShortlistNotice") %>' />
                </EditItemTemplate>

            </asp:TemplateField>

            <asp:TemplateField HeaderText="Final Selection">

                <ItemTemplate>
                    <asp:Label runat="server" ID="FinalSelection" Text='<%#Eval("FinalSelection") %>' />                    
                </ItemTemplate>

                <EditItemTemplate>
                    <asp:TextBox runat="server" ID="txtFinalSelection" Text='<%#Eval("FinalSelection") %>' />
                </EditItemTemplate>

            </asp:TemplateField>

            <asp:TemplateField Visible="false" HeaderText="CompanyID">

                <ItemTemplate>
                    <asp:Label runat="server" ID="CompanyID" Text='<%#Eval("CompanyID") %>' />
                </ItemTemplate>

            </asp:TemplateField>

        </Columns>

    </asp:GridView> 
```

更新按钮调用此函数：

```
protected void GridView1_RowUpdating(object sender, GridViewUpdateEventArgs e)

    {

        int key = Convert.ToInt32(GridView1.DataKeys[e.RowIndex].Value);

        Label CompanyID = (Label)GridView1.Rows[e.RowIndex].FindControl("txtCompanyID");

        TextBox thisIssueDate = (TextBox)(GridView1.Rows[e.RowIndex].FindControl("txtIssueDate"));

        TextBox NoticeIntentResponseDue = (TextBox)GridView1.Rows[e.RowIndex].FindControl("txtNoticeIntentResponseDue");

        Response.Write(NoticeIntentResponseDue.Text + " " + thisIssueDate.Text);
        Response.End();

        TextBox DeadlineForQuestions = (TextBox)GridView1.Rows[e.RowIndex].FindControl("txtDeadlineForQuestions");

        TextBox BidsDue = (TextBox)GridView1.Rows[e.RowIndex].FindControl("txtBidsDue");

        TextBox ShortlistNotice = (TextBox)GridView1.Rows[e.RowIndex].FindControl("txtShortlistNotice");

        TextBox FinalSelection = (TextBox)GridView1.Rows[e.RowIndex].FindControl("txtFinalSelection");
    } 
```

响应向我显示，被抓取的值仍然是框的原始文本值。不是您在框中键入的内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T19:46:45.070

在您的网格视图行更新事件中添加以下条件

```
protected void GridView1_RowUpdating(object sender, GridViewUpdateEventArgs e)
{
 if (e.Row.RowState == DataControlRowState.Edit )
 {

    int key = Convert.ToInt32(GridView1.DataKeys[e.RowIndex].Value);

    Label CompanyID = (Label)GridView1.Rows[e.RowIndex].FindControl("txtCompanyID");

    TextBox thisIssueDate = (TextBox)(GridView1.Rows[e.RowIndex].FindControl("txtIssueDate"));

    TextBox NoticeIntentResponseDue = (TextBox)GridView1.Rows[e.RowIndex].FindControl("txtNoticeIntentResponseDue");

    Response.Write(NoticeIntentResponseDue.Text + " " + thisIssueDate.Text);
    Response.End();

    TextBox DeadlineForQuestions = (TextBox)GridView1.Rows[e.RowIndex].FindControl("txtDeadlineForQuestions");

    TextBox BidsDue = (TextBox)GridView1.Rows[e.RowIndex].FindControl("txtBidsDue");

    TextBox ShortlistNotice = (TextBox)GridView1.Rows[e.RowIndex].FindControl("txtShortlistNotice");

    TextBox FinalSelection = (TextBox)GridView1.Rows[e.RowIndex].FindControl("txtFinalSelection");
    }  
  } 
```

更新：问题看起来您还绑定了您的编辑项模板列与数据表中的数据，当您在后面的代码中获取数据时，您没有获得用户在编辑模式下更新的更新数据仍在获取旧数据。`If you remove the Binding from the Edit Item Template feilds then your code will work.`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T21:42:17.203

我想通了，德里克是对的。它与页面加载中回发的绑定数据有关。我每次都绑定数据，而不仅仅是第一次。谢谢

# android - Android 设置了每个 .apk 允许的安装限制

> ID：11694646
> 
> 赞同：1
> 
> 时间：2012-07-27T19:41:29.233
> 
> 标签：android, security, activation

是否有标准方法来限制 .apk 允许的安装数量

如果我理解正确 Timestamp 限制了 .apk 对安装有效的时间，是否有类似的东西限制安装计数。

我计划在安装应用程序后使用 DeviceID 和 UserID 来填充一个数据库，该数据库检查日志中使用的用户 ID/设备 ID 组合以允许或不允许访问。

事情是我试图阻止安装超过 x 次的应用程序。

我在想类似的事情：

```
package com.tchip.kw;
public class mysoft {
static {
  try{
    System.loadLibrary("tchipmysoft");
  }
  catch(Exception e)
  {}
}
public native int getmachinestatus1();
public native int getmachinestatus2();
}

///this will read/call 2 solutions from mysoft when the end users try to run app. If the return value is 0, then it will say’ Quit’. For example:

mysoft kw = new mysoft();
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        //this.findViewById(id)
        if (kw.getmachinestatus1() && kw.getmachinestatus2() )
        setContentView(R.layout.main);
/////Star splash activity
else
{
You do not have proper license to use this software and it will quit
}
} 
```

我考虑过为 app.apk 编写一个安装 .APK，以检查远程持有的一组密钥，然后授予访问权限。

如果有一个标准化的方法，或者我错过了一些非常简单的东西，我会全神贯注。

# security - 显示输出不足以防止链接注入跨站点脚本吗？

> ID：11694650
> 
> 赞同：0
> 
> 时间：2012-07-27T19:41:38.790
> 
> 标签：security, xss, owasp

我是处理跨站点脚本问题的新手。我们有一些 404 页面输出未找到的 URL，据我所知，javascript 可以被恶意替换。为了防止 XSS 攻击，简单地删除错误 URL 的输出就足够了吗？还是我仍然需要以某种方式根据白名单过滤输入，为此我正在查看 OWASP 库：[https ://www.owasp.org/index.php/Category:OWASP_Enterprise_Security_API](https://www.owasp.org/index.php/Category:OWASP_Enterprise_Security_API)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T19:49:14.897

用户的任何输入都有潜在的危险。您收到它 - 它可能会占用您的全部记忆 :) 您显示它 - 您可能会受到跨站点脚本的伤害。你无论如何都试图解释它 - 你有 sql/ldap/js/xxx 注入。并且可能还有一些我什至不知道的攻击。因此，如果您不显示它，那么是的，您可以安全地抵御 xss。但是，您仍然应该小心用户的数据。OWASP 建议很好 - 白名单过滤是获得更高级别安全性的最简单方法

# jquery - jQuery提交表单而无需重新加载页面

> ID：11694653
> 
> 赞同：1
> 
> 时间：2012-07-27T19:42:01.347
> 
> 标签：jquery, ajax, forms, submit, reload

好的，所以我正在尝试使用 jquery 和经典 ASP 在我的网站上创建一个新的登录表单。截至目前，我的文档中有一个包含 div，它设置为隐藏，然后当用户选择登录链接时，div 将淡入淡出覆盖页面的表单。如果用户点击提交，页面将 POST 并且 div 覆盖消失。我真的希望它比那更顺畅。因此，如果用户单击提交，jquery 将使用 ajax 或其他东西在后台将其发布到数据库连接页面，然后从该 asp 获取响应文本，显示成功登录或错误标签中的错误。

我在我的网站上使用经典的 asp 来获取上次登录提交时的表单数据。然后检查数据库以查看输入的内容是否匹配。

我想让 jQuery 处理所有这些，并通过查询或后台的其他方法将值发送到包含 DB 连接的 ASP 页面，这样当单击提交时页面不会重新加载。

我看过一堆例子，但我似乎无法让它们正确运行。

到目前为止，这是一个[FIDDLE](http://jsfiddle.net/sUc8a/1/)与工作功能一起看。

任何帮助将不胜感激，在此先感谢。

```
<table cellspacing="0" cellpadding="0" width="900" >
      <tr>
            <a href="index.asp" class="linkheader">Home</a>&nbsp;&nbsp;|&nbsp;&nbsp;
            <a href="index1st.asp">1st</a>&nbsp;&nbsp;|&nbsp;&nbsp;
            <a href="index2nd.asp">2nd</a>&nbsp;&nbsp;|&nbsp;&nbsp;
            <a href="index3rd.asp">3rd</a>&nbsp;&nbsp;|&nbsp;&nbsp;
            <a href="index4th.asp">4th</a>&nbsp;&nbsp;|&nbsp;&nbsp;
            <a href='#' id='login' class='linkheader'>Log In</a></td>
     </tr>
</table>

<!-- blur_login is transparent overlay. starts as hidden untill link is selected -->
<div id="blur_login">
    <!-- show_login is container for login form -->
    <div id="show_login">

        <a class="OKclose" href="#" >[ Close ]</a>

        <form method="" id="getin">
        <p><label for="Username">Username</label><br />
        <input name="Username" id="users" type="text" size="14" maxlength="14" autocomplete="off" tabindex="1"/>
        </p>
        <p><label for="last_name">Password</label><br />
        <input name="last_name" type="password" size="14" maxlength="14" autocomplete="off" tabindex="2" /><br />
            <label for="errors"></label>
        </p>
    <p><input type="submit" id="send" value="Log In &rarr;"></p>
</form>
    </div>
</div> 
```

​</p>

```
$(document).ready(function() {
$(window).bind("resize", function(){
   $("#blur_login").css("height", $(window).height());
   $("#blur_logout").css("height", $(window).height());
});

//Adjust height of overlay to fill screen when page loads
   $("#blur_login").css("height", $(document).height());

    $('#login').click(function(a){
        $("#blur_login").fadeIn();
        // Page focus on fadein is the username input
        $('#users').focus(); 
        a.preventDefault;
        return false;
    });

    $('#logout').click(function(b){
        $("#blur_logout").fadeIn();
        b.preventDefault;
      return false;
    });

    $('#send').click(function(c){
        //AJAX form submit here
    });

// Functions for login form
var $submit = $("input[type=submit]"),
    $inputs = $('input[type=text], input[type=password]');

// Checks if fields are empty, if so then disable loginbutton
    function checkEmpty() {
        return $inputs.filter(function() {
            return !$.trim(this.value);
        }).length === 0;
    }
// Enables the submit button when characters have been entered in each field
    $inputs.on('keyup blur', function() {
        $submit.prop("disabled", !checkEmpty());
    }).keyup();  // trigger any one

// When the close link is selected the window will fade out
   $(".OKclose").click(function(d){
      $("#blur_login").fadeOut();
       d.preventDefault;
      return false;
});   
});​ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-27T19:48:16.030

那么你肯定是正确的使用（jQuery 的）[AJAX](http://api.jquery.com/jQuery.ajax/)的必要性。这是您应该在表单提交单击处理程序中放入内容的示例。

```
$.ajax({
  type: "POST",
  url: "dbProcessing.asp",
  data: $('#loginForm').serialize(),
  success: function(){
  // Insert any changes into the DOM that you like
  // msg will be whatever you print out in dbProcessing.asp
  // so set it to 'success' or something if the login was successful
  // and then do an if statement to see what === msg and insert
  // a message into the DOM or redirect based on that
  }
}); 
```

*为更好的实践而编辑（根据评论）*

*Edit2：现在我只是变得粗心了*

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-27T22:17:44.223

这是我在页面中使用的内容：

```
$('#loginbutton').click(function(event) {
    event.preventDefault(); /*  Stops default form submit on click */       
        $('#loginbutton').hide();                                                               //Hide Login Button
        $('#loginprogress').html('<img src="web/imgs/loader.gif"> Processing'); // Show Progress Spinner

        var username = $("#username").val();
        var password = $("#password").val();

        $.ajax({                                                                                        // Run getUnlockedCall() and return values to form
            url: "ajaxDispatcher.php?action=login",
            data: 'username=' + username + '&password=' + password,
            type: "POST",
            success: function(data){
                if (data == '') {
                    $('#loginbutton').show();                                               // Show Login button
                    $('.error').show();                                                     // Display login error message
                    $('#loginprogress').html('');                                           // Show Progress Spinner
                } else {
                    location.reload();
                    $('#logout').show();                                                        // Show logout button
                            $('#userinfo').show();
                    $('#loginprogress').hide();                                         // Hide Progress Spinner
                }
            }
            });
        }); 
```

简而言之，`#loginbutton`就是一个jquery按钮。单击它会隐藏以防止多次提交。调度程序运行一个检查登录的函数，使用来自 id 为“用户名”和“密码”的输入的传递值。成功时，如果登录失败，它将返回 false（显示错误警告），否则将返回值来操作 dom。在这个例子中，它显示了注销按钮，隐藏了`loginprogress`div，并显示了一个名为“userinfo”的 div。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-27T19:56:38.487

尝试使用 jQuerys post 方法：

```
$.post("dbProcessing.asp", $("#loginForm").serialize(), function(data)
{
    // TODO: function logic
}); 
```

[在这里](http://api.jquery.com/jQuery.post/)你可以找到手册`jQuery.post()`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-27T19:52:07.393

为了阻止表单重新加载页面，这是我使用的，它已经过测试可以在所有主要浏览器中工作：

```
function doStuff(e){
    e.returnValue = e.preventDefault && e.preventDefault() ? false : false;
    // handle AJAX here
} 
```

当然，您需要在表单中添加一个 onsubmit 来调用`doStuff(event);`.

# ios - AFNetworking http 客户端不发送 JSON 参数

> ID：11694656
> 
> 赞同：1
> 
> 时间：2012-07-27T19:42:07.343
> 
> 标签：ios, ios5, nsurlrequest, afnetworking

我创建了一个子类，`AFHTTPClient`并试图将一些 JSON 参数发送到服务器。

但是，服务器以预期的内容类型响应

```
{(
    "text/json",
    "application/json",
    "text/javascript"
)}, got application/xml 
```

根据[AFNetworking 常见问题解答](https://github.com/AFNetworking/AFNetworking/wiki/AFNetworking-FAQ)

> 如果您使用的是 AFHTTPClient，请将 parameterEncoding 属性设置为 AFJSONParameterEncoding。该 HTTP 客户端上带有参数参数的任何方法现在都将传递的对象编码为 JSON 字符串，并适当地设置 HTTP 正文和 Content-Type 标头。

我已经在这里完成了，但服务器似乎无法识别内容标题。有谁知道潜在的解决方案？

这是方法：

```
- (void)getCompanyDataWithString:(NSString*)companySearchQuery 
      finish:(LBMarkitAPIRequestCompletionBlock)finishBlock
{
    [self registerHTTPOperationClass:[AFJSONRequestOperation class]];
    [self setParameterEncoding:AFJSONParameterEncoding];

    NSDictionary *params = [NSDictionary dictionaryWithObject:
        companySearchQuery forKey:@"input"];
    NSMutableURLRequest *searchQueryRequest = [self requestWithMethod:@"GET"
        path:kMarkitCompanyURL parameters:params];

    AFJSONRequestOperation *searchRequestOperation = [AFJSONRequestOperation 
        JSONRequestOperationWithRequest:searchQueryRequest 
        success:^(NSURLRequest *request, NSHTTPURLResponse *response, id json) 
        {
            NSLog(@"Response: %@", response);
            NSLog(@"JSON: %@",json);
            NSMutableArray *results = [NSMutableArray array];

            NSError *anError = [[NSError alloc] init];
            if ([json objectForKey:@"Message"]) 
            {
                NSString *message = [json objectForKey:@"Message"];
                anError = [[NSError alloc] initWithDomain:message
                                                     code:100 
                                                 userInfo:nil];
            }

            // Need some error handling code here
            for (id item in json) 
            {
                NSString *aName = [item objectForKey:@"Name"];
                NSString *aSymbol = [item objectForKey:@"Symbol"];
                NSString *anExchange = [item objectForKey:@"Exchange"];

                LBCompany *aCompany = [[LBCompany alloc] initWithName:aName 
                    Symbol:aSymbol Exchange:anExchange];
                [results addObject:aCompany];
            }
            // Need to run the passed in block after JSON 
            // Request Operation succeeds

            finishBlock(results,anError);
          }
        failure:^(NSURLRequest *request, NSHTTPURLResponse *response, 
            NSError *error, id JSON)
        {
            NSLog(@"request failed: %@",[error localizedDescription]);
            NSLog(@"Response: %@",response);
            NSLog(@"JSON: %@",JSON);
        }];

    [searchRequestOperation start];
    NSLog(@"JSON operation started");
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T20:40:42.557

问题在于 URL 格式。我没有注意到需要发送查询参数并在 URI 中指定 JSON 输出的 API 实现细节。

AFNetworking 没有任何问题。

# android - /proc/config.gz 不存在

> ID：11694657
> 
> 赞同：3
> 
> 时间：2012-07-27T19:42:14.967
> 
> 标签：android, linux-kernel, kernel, adb

我有一个 Sony Xperia P。我安装了一个我自己编译的自定义内核。现在我找不到它的`config.gz`. 它不存在于`/proc/config.gz`. 我不确定在安装自定义内核之前它是否存在。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-28T15:22:22.317

请检查您是否启用了“通过 /proc/config.gz 启用对 .config 的访问”（IKCONFIG_PROC）选项。

# visual-studio-2010 - MATLAB mbuild -setup 编译器问题

> ID：11694661
> 
> 赞同：1
> 
> 时间：2012-07-27T19:42:38.180
> 
> 标签：visual-studio-2010, matlab, matlab-compiler

我有 MATLAB 2010a，我想将我的脚本编译成一个独立的 windows .exe 文件。问题是当我使用时`mbuild -setup`，我的 Visual Studio 2010 没有选项。我看到有一个 MEX 文件的补丁，我安装了这个补丁，但它没有帮助。

```
>> mbuild -setup
Please choose your compiler for building standalone MATLAB applications: 

Would you like mbuild to locate installed compilers [y]/n? n

Select a compiler: 
[1] Microsoft Visual C++ 2005 SP1 
[2] Microsoft Visual C++ 2008 Express 
[3] Microsoft Visual C++ 2008 SP1 

[0] None 
```

有任何想法吗？

如果我选择`[3]`，它无论如何都找不到它。我不在乎我使用什么编译器，我只想让它工作。

**编辑**

如果我`[y]`在询问时选择`Please choose your compiler for building standalone MATLAB applications:`，我会得到以下信息：

```
>> mbuild -setup
Please choose your compiler for building standalone MATLAB applications: 

Would you like mbuild to locate installed compilers [y]/n? y

Select a compiler: 

[0] None 

Compiler: 0

mbuild: No compiler selected. No action taken. 
```

忍者

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-29T18:04:01.633

根据支持和兼容的编译器[列表，虽然提供了一个](http://www.mathworks.com/support/compilers/R2010a/win32.html)[补丁](http://www.mathworks.com/support/solutions/en/data/1-D5W493/?solution=1-D5W493)来支持 VS2010 仅用于**MEX 编译**，但 R2010a 中的 MATLAB Compiler 产品与 VS2010 不兼容（至少不是官方的）。

如果你能做到，请知道`mbuild`在 Windows 上调用 Perl 脚本 ( `$matlabroot\bin\mex.pl`)，并使用其结果构建要运行的命令（作为 DOS/批处理）。您也许可以尝试自己破解它以使其与 VS2010 一起使用。只是不要指望我对此有任何帮助，该文件有近 3000 行 Perl 代码 :) 幸运的是，它似乎得到了很好的评论。

否则，请考虑将您的 MATLAB 安装升级到最新版本（开箱即用支持 VS2010）...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T22:14:58.097

[该](http://www.mathworks.com/help/toolbox/compiler/brtm1xm-6.html)站点表明您可以设置环境变量，以便您的编译器可以通过运行来识别`vsvars32.bat`。具体来说，看起来`MSVCDIR`必须适当地设置变量。

# c++ - 将 x86 代码注入 x64 进程

> ID：11694664
> 
> 赞同：2
> 
> 时间：2012-07-27T19:42:59.443
> 
> 标签：c++, winapi, x86, 64-bit, inject

我正在研究 x86 dll 注入器，我想将 x86 代码注入 x64 进程线程并执行它。首先，我在 x64 进程上调用*CreateRemoteThread*失败，导致错误代码 5。然后我发现[了这个技巧](https://dev.metasploit.com/redmine/projects/framework/repository/revisions/master/entry/external/source/meterpreter/source/common/arch/win/i386/base_inject.c)，我能够用它创建远程线程。但是当我尝试*ResumeThread*并在 x64 进程中执行该 x86 代码时，整个进程崩溃。

将 x86 注入 x86 效果很好，问题仅在于 x86 到 x64。

所以，我的问题是——是否有可能模拟和运行在 x64 进程中复制的 x86 代码？我知道这样做的一种方法是拥有相同代码的两个版本，并根据远程进程的体系结构选择一个，但我认为这不是最好的方法。

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-27T21:08:27.450

段选择器确定位数，因此您所做的只是使用正确的段选择器进行“某种形式的远跳”。在 64 位中，不再有那么多方法可以做到这一点。`retf`仍然有效。

未经测试，但你明白了：

```
sub rsp, 8
mov dword [rsp+4], 0x23   // 32 bit segment selector
mov dword [rsp], offset some32bitcode
retf 
```

就是这样，您现在处于 32 位模式。它可能会导致重大损坏（特别是如果您尝试调用任何 Windows 函数），但您可以这样做 - 您*可以*做到（只是不要）。

您可以更轻松地切换回来：

```
jmp far 33h:some64bitcode // 64 bit segment selector 
```

在 64 位模式下，直接远跳转不可编码。间接远跳转/远调用仍然存在，远返回，这显然也是间接的。

23h 和 33h 是 windows 的值，在其他操作系统上可能（并且可能）不同。

当然，这仍然意味着您必须以不同的方式处理 64 位进程。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-27T19:48:22.980

您不能在 x64 进程内运行 x86 代码，反之亦然。时期。操作系统根本不允许。您只能将 x86 代码注入 x86 进程，并将 x64 代码注入 x64 进程。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-27T21:43:11.763

我真的怀疑这是否会正常工作。请记住，AMD64 架构丢弃了所有的`INC`和`DEC`操作码，以便用 REX 前缀替换它们，而指令本身则被替换为两字节等效项。这意味着如果您的 x86 代码包含 a`INC`或`DEC`编码为一个字节，则 CPU 在 x64 中工作时会将其视为 REX 前缀，并将尝试将指令流中的下一个字节解码为普通指令，这将最由于指令被解码为不合理的东西，肯定会导致一般保护错误或类似的东西。

这是一个例子。假设我想使用以下代码（NASM）在循环中访问一个数组。

```
bits 32
mov ecx, 200
myloop:
 dec ecx
 mov eax, [myarray+ecx*4+0x100]
 jnz myloop
myarray resb 10 
```

将其编译为平面二进制文件并将其反汇编为 64 位代码后，`ndisasm`将返回以下内容：

```
00000000  B9C8000000        mov ecx,0xc8
00000005  498B048D0F010000  mov rax,[rcx*4+0x10f]
0000000D  75F6              jnz 0x5 
```

如您所见，“循环”不再是真正的循环，因为它的计数器永远不会递减，并且根据最后修改零标志的指令进行跳转。这清楚地表明指令解码器在 32 位和 64 位模式下的工作方式非常不同，在 64 位模式下运行时，您实际上无法运行汇编为 32 位的代码。

# java - Hibernate OpenSessionInViewFilter 过早关闭会话？

> ID：11694671
> 
> 赞同：3
> 
> 时间：2012-07-27T19:43:41.227
> 
> 标签：java, spring, hibernate, orm, wicket

我有一个 Spring、Hibernate 和 Wicket 应用程序设置为从数据库中读取国际化的 json 内容项，并通过 api url 上的请求将它们传递出去。负责传递数据的代码库是为企业客户开发的整体网站结构的一小部分。

api 在超过 90% 的情况下运行良好，但客户端遇到了一个有趣的偶尔问题，可能源于孤立的休眠会话。请求将通过 php 脚本失败并给出错误：

```
Warning: file_get_contents( http://client.net/api/attachment_lines?ce=false&language=en&region=na&ts=1341592326) [function.file-get-contents]: failed to open stream: Redirection limit reached, aborting in client_api->send_request() (line 38 of <sitepath>/api.class.php). 
```

并将在 tomcat 服务器日志中产生以下错误：

```
09:15:00,200 ERROR [RequestCycle] failed to lazily initialize a collection of role: com.client.data.AttachmentLineCode.attachmentSublineCodes, no session or session was closed
org.hibernate.LazyInitializationException: failed to lazily initialize a collection of role: com.client.data.AttachmentLineCode.attachmentSublineCodes, no session or session was closed 
```

该应用程序在 spring 中配置为使用 OpenSessionInViewFilter 和 @Transactional 注释设计模式，所以我不确定是什么导致间歇性请求失败。除此之外，客户端表示该 api 将在问题发生后大约 15 分钟内继续失败，考虑到配置，这似乎真的很古怪。在 web.xml 中，这里是过滤器的声明：

```
<filter>
    <filter-name>openEntityManagerInView</filter-name>
    <filter-class>org.springframework.orm.hibernate3.support.OpenSessionInViewFilter</filter-class>
</filter>
<filter-mapping>
    <filter-name>openEntityManagerInView</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping> 
```

在代码中，这里是通用 DAO 上的事务注释，它由内容项 DAO 扩展：

```
@Transactional(noRollbackFor={javax.persistence.EntityNotFoundException.class, org.springframework.orm.ObjectRetrievalFailureException.class})
public class GenericDaoHibernate<T, PK extends Serializable> implements GenericDao<T, PK> {
    @Autowired
    private SessionFactory sessionFactory; 
```

在通用 DAO 中，这里也是我检索和使用会话的地方：

```
protected Session getSession() {
    return sessionFactory.getCurrentSession();
}

protected Criteria createCacheableCriteria(Class<T> clazz) {
    Criteria criteria = createNonCacheableCriteria(clazz);
    criteria.setCacheable(true);
    criteria.setCacheMode(CacheMode.NORMAL);
    return criteria;
}

protected Criteria createCacheableCriteria(Class<?> clazz, String alias) {
    Criteria criteria = createNonCacheableCriteria(clazz, alias);
    criteria.setCacheable(true);
    criteria.setCacheMode(CacheMode.NORMAL);
    return criteria;
}

protected Criteria createNonCacheableCriteria(Class<?> clazz) {
    Session session = getSession();
    Criteria criteria = session.createCriteria(clazz);
    criteria.setCacheable(false);
    criteria.setCacheMode(CacheMode.IGNORE);
    return criteria;
}

protected Criteria createNonCacheableCriteria(Class<?> clazz, String alias) {
    Session session = getSession();
    Criteria criteria = session.createCriteria(clazz, alias);
    criteria.setCacheable(false);
    criteria.setCacheMode(CacheMode.IGNORE);
    return criteria;
} 
```

是否有某种方式可以使会话在此设置中成为孤儿？休眠会话是否有某种内置超时可能导致此问题？缓存可能有问题？在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T17:03:07.623

这里的解决方案与 Hibernate 或 Spring 无关，仅存在于我的错误中，没有注意到生产环境和我们的开发/登台之间的差异。生产环境实施了复杂的负载平衡策略，没有粘性会话。

事实证明，Wicket 的请求/响应周期涉及在 POST 之后缓存缓冲的响应。返回获取该响应的相应 GET 偶尔会抛出 302，因为负载平衡会将请求转发到没有缓存响应的服务器，并且代理对象将被遗忘。我选择实现以解决此问题的相关代码位于我的 Application.java 中的 init() 下：

```
public class ClientApplication extends SpringWebApplication {  
    ... 
    public void init() {
        ...
        getRequestCycleSettings().setRenderStrategy(IRequestCycleSettings.ONE_PASS_RENDER); 
```

这会将 Wicket 的渲染策略配置更改为不缓冲响应。结果出现了一个允许经典“刷新双重提交”问题的问题。因此，这不一定是一个理想的解决方案，但客户端不想使用粘性会话启用负载平衡，也不介意双重提交问题。

有关此问题的更多详细信息以及更雄辩/结构化的答案，请参阅： http: [//blog.comsysto.com/2011/04/08/lost-in-redirection-with-apache-wicket/](http://blog.comsysto.com/2011/04/08/lost-in-redirection-with-apache-wicket/)

# python - 仅在模块内的 Python Mock 类型

> ID：11694672
> 
> 赞同：0
> 
> 时间：2012-07-27T19:43:50.567
> 
> 标签：python, mocking, metaclass

我正在使用模拟在 Python 中进行测试。我正在尝试对覆盖该`__new__`方法然后在`type.__new__(cls)`内部调用的元类进行单元测试。

我不想真正打电话`type.__new__`，所以我想模拟出来`type`。当然，我不能修补`__builtin__.type`，因为它破坏了测试中的对象构造。

所以，我真的想限制`type`被测模块内的模拟。这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T19:48:49.033

是的。出于这些原因，您`patch`尽可能靠近您将要调用您的函数的位置。因此，在您的测试用例中，只有在您将调用的正在测试的函数（或任何可调用的）周围，您才能 patch `type`。

[`patch`](http://www.voidspace.org.uk/python/mock/patch.html#mock.patch)如果您想仔细阅读，文档中有很多示例。

干杯。

# javascript - 我可以使用 window.postMessage 方法从 iframe 中的网页与包含该 iframe 的 UIWebView 进行通信吗？

> ID：11694682
> 
> 赞同：2
> 
> 时间：2012-07-27T19:44:39.843
> 
> 标签：javascript, html, iframe, uiwebview, postmessage

我经常使用`window.postMessage`和“消息”事件侦听器在父网页与其子`IFRAME`元素中的网页之间跨域进行通信。我想知道 UIWebView 及其子`IFRAME`元素中的网页是否可以做到这一点。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-03T21:10:54.240

是的，这确实是可能的。几天前，我在自己的应用程序中对此进行了测试，并且成功了。

在我想与之通信的网页上，我只是在窗口中添加了一个“消息”事件侦听器

监听网页上的 UIWebView 消息

```
window.addEventListener("message", onmessage, false);
window.onmessage = function(e){
    // e.data contains message
    // e.origin will equal NULL as theres no domain in UIWebView    
} 
```

UIWebView 只需要抓取嵌入的 iFrame 对象的窗口并在其上调用 postMessage：

```
iFrameObject.contentWindow.postMessage("message", http://webpageDomain...); 
```

反过来，UIWebView 中的 html 实现也需要像上面的代码一样监听消息。这次 e.origin 将是网页的域。

网页只需要以 * 作为 targetDomain 调用以下内容，因为 UIWebView 不会有。

```
parent.postMessage("message", *); 
```

# sql - 如何在postgres中有效地选择具有MIN日期的行

> ID：11694685
> 
> 赞同：3
> 
> 时间：2012-07-27T19:44:49.560
> 
> 标签：sql, postgresql, query-optimization, postgresql-9.1

我需要从由它们分组`baz`的“最早”（）行中快速选择一个值（）。以下查询返回正确的行（几乎可以，当存在重复的 save_dates 时，它可以为每个 foo_id 返回倍数）。`MIN(save_date)``foo_id`

该`foos`表包含大约 55k 行，该`samples`表包含大约 2500 万行。

```
CREATE TABLE foos (
    foo_id     int,
    val        varchar(40),
    # ref_id is a FK, constraint omitted for brevity
    ref_id     int
)
CREATE TABLE samples (
    sample_id  int,
    save_date  date,
    baz        smallint,
    # foo_id is a FK, constraint omitted for brevity
    foo_id     int
)

WITH foo ( foo_id, val ) AS (
        SELECT foo_id, val FROM foos
        WHERE foos.ref_id = 1
    ORDER BY foos.val ASC
    LIMIT 25 OFFSET 0
)
SELECT foo.val, firsts.baz
FROM foo
LEFT JOIN (
    SELECT A.baz, A.foo_id
    FROM samples A
    INNER JOIN (
        SELECT foo_id, MIN( save_date ) AS save_date
        FROM samples
        GROUP BY foo_id
    ) B
    USING ( foo_id, save_date )
) firsts USING ( foo_id ) 
```

此查询当前需要超过 100 秒；我希望在大约 1 秒（或更短的时间内）内看到这个回报。

**我怎样才能写出这个查询是最优的？**

* * *

## 更新; 添加`explains`：

显然，我使用的实际查询没有使用表 foo、baz 等。

“简化”示例查询（从上面）`explain`：

```
Hash Right Join  (cost=337.69..635.47 rows=3 width=100)
  Hash Cond: (a.foo_id = foo.foo_id)
  CTE foo
    ->  Limit  (cost=71.52..71.53 rows=3 width=102)
          ->  Sort  (cost=71.52..71.53 rows=3 width=102)
                Sort Key: foos.val
                ->  Seq Scan on foos  (cost=0.00..71.50 rows=3 width=102)
                      Filter: (ref_id = 1)
  ->  Hash Join  (cost=265.25..562.90 rows=9 width=6)
        Hash Cond: ((a.foo_id = samples.foo_id) AND (a.save_date = (min(samples.save_date))))
        ->  Seq Scan on samples a  (cost=0.00..195.00 rows=1850 width=10)
        ->  Hash  (cost=244.25..244.25 rows=200 width=8)
              ->  HashAggregate  (cost=204.25..224.25 rows=200 width=8)
                    ->  Seq Scan on samples  (cost=0.00..195.00 rows=1850 width=8)
  ->  Hash  (cost=0.60..0.60 rows=3 width=102)
        ->  CTE Scan on foo  (cost=0.00..0.60 rows=3 width=102) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-27T21:01:00.553

如果我理解这个问题，你想要窗口。

```
WITH find_first AS (
  SELECT foo_id, baz,
    row_number()
  OVER (PARTITION BY foo_id ORDER BY foo_id, save_date) AS rnum
  FROM samples
)
SELECT foo_id, baz FROM find_first WHERE rnum = 1; 
```

使用`row_number`而不是`rank`消除重复并保证每个 foo 只有一个 baz。如果您需要了解没有 bazzes 的 foos，只需`LEFT JOIN`该查询的 foos 表即可。

使用索引 on `(foo_id, save_date)`，优化器应该足够聪明，可以只保留一个 baz 并愉快地进行分组。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-28T00:40:12.983

`row_number()`是一只美丽的野兽，但`DISTINCT ON`在这里更简单。

```
WITH foo AS (
    SELECT foo_id
    FROM   foos
    WHERE  ref_id = 1
    ORDER  BY val
    LIMIT  25 OFFSET 0
    )
SELECT DISTINCT ON (1) f.foo_id, s.baz
FROM   foo f
LEFT   JOIN samples s USING (foo_id)
ORDER  BY f.foo_id, s.save_date, s.baz; 
```

这是假设您希望每个`foo_id`. 如果有多行`sample`共享相同的最早`save_date`，`baz`则作为决胜局。

[这个案子和昨天](https://stackoverflow.com/q/11665286/939860)的这个问题很相似。

### 更多建议：

*   不要`val`在 CTE 中选择，您只需要在`ORDER BY`.

*   为了**避免昂贵的顺序**扫描`foos`：

    *   如果您总是在 with 中的行之后`foos`，请`ref_id = 1`创建[部分多列索引](http://www.postgresql.org/docs/current/interactive/indexes.html)：

        ```
        CREATE INDEX foos_val_part_idx ON foos (val)
        WHERE ref_id = 1; 
        ```

    *   如果`ref_id`是可变的：

        ```
        CREATE INDEX foos_ref_id_val_idx ON foos (ref_id, val); 
        ```

*   另一个最有帮助的索引`samples`：

    ```
    CREATE INDEX samples_foo_id_save_date_baz_idx
    ON samples (foo_id, save_date, baz); 
    ```

这些索引在 9.2 版中使用新的“**仅索引扫描**”变得更加有效。详细信息和链接[在这里](https://stackoverflow.com/a/11624409/939860)。

# r - 通过匹配列名上每一行中的值来填充列值

> ID：11694695
> 
> 赞同：2
> 
> 时间：2012-07-27T19:45:42.700
> 
> 标签：r

我想创建一个这样的数据框：

```
Label   Jim Charles Kevin Alan
Charles 0   1       0     0  
Kevin   0   0       1     0
Alan    0   0       0     1
Alan    0   0       0     1
Jim     1   0       0     0 
```

我从一个数据框开始，其中设置了列名，第一列中列出了人名，但所有数字都是 0。我希望能够通过匹配列出的名称快速将其中一些设置为 1第一列到列名。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-27T19:53:23.627

可能有更快的方法，但这应该可以很好地工作：

数据：

```
m <- matrix(0,nrow=5,ncol=4,
            dimnames=list(c("Charles","Kevin","Alan","Alan","Jim"),
            c("Jim","Charles","Kevin","Alan"))) 
```

用于`outer`将所有行与所有列进行比较：

```
mm <- outer(rownames(m),colnames(m),"==")
storage.mode(mm) <- "numeric" ## because as.numeric() loses matrix dimensions
dimnames(mm) <- dimnames(m)   ## reset row/column names 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-27T19:56:01.997

与 Ben 的回答类似，如果您的数据位于名为的 data.frame 中`df`：

```
df <- structure(list(Label = c("Charles", "Kevin", "Alan", "Alan", 
"Jim"), Jim = c(0, 0, 0, 0, 0), Charles = c(0, 0, 0, 0, 0), Kevin = c(0, 
0, 0, 0, 0), Alan = c(0, 0, 0, 0, 0)), .Names = c("Label", "Jim", 
"Charles", "Kevin", "Alan"), row.names = c(NA, -5L), class = "data.frame")

df[outer(df$Label, names(df), '==')] <- 1 
```

# java - MapActivity - 如何限制缩放级别？

> ID：11694696
> 
> 赞同：2
> 
> 时间：2012-07-27T19:45:43.307
> 
> 标签：java, android, android-mapview

[根据HelloMapView 教程](https://developers.google.com/maps/documentation/android/hello-mapview)和许多 StackOverflow 资源，我在其上实现了一个`MapActivity`带有 Pins 的功能。

出于我的应用程序的目的，我想**限制缩放级别**的最小值和最大值。事实上，我想避免`android:clickable="true"`在我的 MapView 上使用。

我找不到如何做到这一点。

*   是否可以？
*   有人知道该怎么做吗？
*   `onZoomChanged()`是否有像我没有看到的那样覆盖的内置函数？

### AndroidManifest.xml

```
<uses-sdk
    android:maxSdkVersion="16"
    android:minSdkVersion="7"
    android:targetSdkVersion="15" /> 
```

### MyMapActivity.java

```
// Here is my MapView
mMapView = (MapView) findViewById(R.id.game_map);
mMapView.setBuiltInZoomControls(false);
mMapView.setSatellite(true);
mMapController = mMapView.getController();
mMapController.setZoom(CONST_MAP_ZOOM);
mMapController.setCenter(new GeoPoint(48856700, 2351000));
mMapController.animateTo(new GeoPoint(48856700, 2351000)); 
```

但是当我使用手指时，我可以缩小直到看到整个星球。

我想要的是限制缩放级别。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T19:51:26.987

MapView 确实有 onSizeChanged

见[https://developers.google.com/maps/documentation/android/reference/com/google/android/maps/MapView#onSizeChanged(int](https://developers.google.com/maps/documentation/android/reference/com/google/android/maps/MapView#onSizeChanged(int) , int, int, int)

也许你可以听听，然后调用 getZoomLevel() 看看它是否在你可以接受的范围内，然后从那里改变它。

或者更好的是，您可以覆盖 onDraw 并始终在那里检查它。 [为 MapView 设置最小缩放级别](https://stackoverflow.com/questions/4146395/set-minimum-zoom-level-for-mapview)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-29T21:54:47.813

我找到了出路。

我在 MapView 上禁用多点触控：

```
<com.google.android.maps.MapView
    android:id="@+id/game_map"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:apiKey="@string/google_maps_api_key"
    android:clickable="true" /> 
```

然后我隐藏缩放控件：

```
mMapView = (MapView) findViewById(R.id.game_map);
mMapView.setBuiltInZoomControls(false); 
```

然后我实现了我自己的缩放控件。

# c - 调用堆栈 - 函数将局部变量的引用返回给调用函数，然后调用另一个函数

> ID：11694701
> 
> 赞同：0
> 
> 时间：2012-07-27T19:45:57.177
> 
> 标签：c, callstack

```
#include<stdio.h>

int *fun();
int main()    
{
   int *ptr;
   ptr=fun();
   printf("%d",*ptr);
   printf("%d",*ptr);
}
int * fun()
{
   int k=4;//If auto then cannot print it two times.....stack will be changed
   return(&k);
}

O/P: 4
    -2 
```

第一次调用 printf() 会打印正确的值。

在调用 fun() 之后立即调用任何函数（甚至 printf()）。这次 printf( ) 打印一个垃圾值。为什么会发生这种情况？为什么我们在第一个打印语句本身期间没有得到垃圾值？？？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T20:08:56.927

这不是您可以依赖的行为；在不同的系统，甚至不同版本的编译器或不同的编译器开关上，它可能并且可能会有所不同。

鉴于此，可能发生的情况是：fun 返回一个指向它存储 k 的位置的指针。堆栈的那部分不再可靠，因为分配它的函数已经退出。尽管如此，还没有人写过它，所以 4 仍然是它写的地方。然后 main 准备调用 printf。为此，它获取第一个参数 *ptr。为此，它从位置 ptr 点加载，这是 k 的（前）地址，因此加载得到的是那里的 4。这 4 存储在要传递给 printf 的寄存器或堆栈位置中。然后存储格式字符串的地址“%d”以传递给 printf。然后调用 printf。此时，printf 使用了大量的堆栈，并在 k 以前的位置写入新数据。但是，作为参数传递的 4 是在一个安全的地方， printf 的参数应该是，所以 printf 打印它。然后 printf 返回。然后主程序准备再次调用 printf。这一次，当它从 ptr 指向的位置加载时，4 不再存在；这是在第一次调用 printf 时写入的一些值。因此，该值是传递给 printf 并且是打印的值。

永远不要编写使用这种行为的代码。它不可靠，也不是正确的代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T21:08:57.957

为什么会让你感到惊讶？行为是未定义的，但观察你观察到的并没有什么不寻常的。

所有变量都存在于内存中的某个地方。当一个变量被正式销毁时（如函数退出时的局部变量），它曾经占用的内存仍然存在，并且很可能仍然保存最后写入的值。该内存现在正式免费，但它将继续保持最后一个值，直到其他代码将该内存用于其他目的并覆盖它。

这是你在实验中观察到的。即使变量`k`不再存在，指针`ptr`仍然指向它以前的位置。并且那个以前的位置仍然恰好持有 的最后一个值`k`，即`4`。

第一个`printf`“成功”接收到该值的副本以进行打印。第一个`printf`实际上是重用旧内存位置并覆盖`k`. 所有进一步取消引用的尝试都`ptr`将表明它`4`不再存在，这就是为什么您的第二个`printf`打印其他内容的原因。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-27T20:13:01.277

变量`k`是本地的`fun()`，意味着它会在函数返回时被销毁。这是一种非常糟糕的编码技术，总是会导致问题。

以及第一个`printf`返回正确值的原因：

首先，它可能会也可能不会返回值。事情是假设`k`写在堆栈内存的某个地方。第一次函数返回时 printf 可能会得到正确的值，因为这部分内存可能存在一段时间。但这不能保证。

# c - C 中参数的默认值

> ID：11694705
> 
> 赞同：2
> 
> 时间：2012-07-27T19:46:08.143
> 
> 标签：c, function, arguments

假设我在 C 中有一个函数定义为：

```
bool check ( int x, int y); 
```

现在，如果我使用它调用它`check(4);`

那将是什么价值`y`？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-27T19:55:59.463

只有在函数未声明（C89/90）或声明时没有原型（C89/90 和 C99）时，这样的代码才可能编译。

在任何情况下，行为都是未定义的。如果调用中使用的提升参数的数量和/或类型与函数定义中使用的不匹配，则行为未定义。

> **6.5.2.2 函数调用**
> 
> 6 [...] 如果参数的数量不等于参数的数量，则行为未定义 [...] 如果函数是使用不包含原型的类型定义的，并且后面的参数类型提升与提升后的参数不兼容，行为未定义

# google-apps-script - 隐藏由 loadComponent 显示的组件

> ID：11694709
> 
> 赞同：0
> 
> 时间：2012-07-27T19:46:25.553
> 
> 标签：google-apps-script

我在 doGet 中加载一个组件，在单击事件之后，我试图隐藏该组件并显示另一个。 *这些是在 GUI Builder 中制作的。* 首先，是否有可能有 2 个不同的组件？如果是这样，我怎样才能让第二个组件显示在另一个组件之上？这是我的代码：

```
function doGet() {
 var app = UiApp.createApplication();

  app.add(app.loadComponent("first", {"z-index": "1"}));

  return app;
}

function myClickHandler(e) {
   var app = UiApp.getActiveApplication();

   var label = app.getElementById('statusLabel');
   label.setVisible(true);

   app.close();
   return app;
}

function afterClick(){
   var app = UiApp.getActiveApplication();
    app.add(app.loadComponent("second", {"z-index": "100"}));

 return app;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T22:17:49.843

GUI builder 中不应该有 2 个组件，请查看[这篇文章](https://stackoverflow.com/questions/11661146/replicate-tab-panel-in-gui-builder-google-apps)，它为使用 GUI builder 的多个 UI 提供了解决方案。此选项会更流畅，因为 UI 实际上不会在每个面板显示之间关闭。

要使这种方法适应您的代码，不要忘记您可以将多个处理程序分配给同一个小部件，例如用于切换可见性的客户端处理程序和用于调用您的函数的服务器处理程序。两人会一起开火……

# javascript - Spry 般的幻灯片效果

> ID：11694715
> 
> 赞同：1
> 
> 时间：2012-07-27T19:46:53.713
> 
> 标签：javascript, jquery, mobile, slide

我不确定 Spry 是否比 jQuery 更流畅，但我永远无法让我的动画像[http://labs.adobe.com/technologies/spry/samples/effects/slide_sample.html一样流畅](http://labs.adobe.com/technologies/spry/samples/effects/slide_sample.html)

我执行我的动画如下：

```
 $("#button").click(function (e) {
    $("#thediv").css('margin-left',$(window).width + 10 + 'px');
    $("#thediv").animate({
       'margin-left' : '0'
   },100);
 }); 
```

我尝试过使用缓动，使用插件降低帧速率，调整 ms。Spry 有什么不同吗？据我所知，它像 jQuery 一样操纵 DOM。什么是创建平滑“从左滑动”div 过渡的理想动画设置。Web 应用程序用于手机，div 切换用于在视图之间切换。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T19:54:20.623

是的，您可以获得确切的效果：**工作演示** `:)` [http://jsfiddle.net/FjgjE/](http://jsfiddle.net/FjgjE/)或[http://jsfiddle.net/YWcgw/](http://jsfiddle.net/YWcgw/)

使用这些 js 和 css 文件，其余的 html 和完整的 js 代码在演示中。

如果我错过了什么，请让我知道！

希望它可以帮助您的事业`:)`休息随意玩演示。

**脚本**

```
<link href="http://labs.adobe.com/technologies/spry/css/samples.css" rel="stylesheet" type="text/css" />
<script src="http://labs.adobe.com/technologies/spry/includes/SpryEffects.js" type="text/javascript"></script> 
```

**代码**

```
 var animation_start = function(){
        var button = document.getElementById('animation_button');
        if (button){
            button.disabled = true;
            button.style.backgroundColor = '#FFF';
        }
    }

    var animation_stop = function(){
        var button = document.getElementById('animation_button');
        if (button){
            button.disabled = false;
            button.style.backgroundColor = '';
        }
    }

    var slide_func = new Spry.Effect.Slide('slideIt', {toggle:true, setup: animation_start, finish: animation_stop});​ 
```

# iphone - 使用核心数据存储绘制的地图路径

> ID：11694718
> 
> 赞同：1
> 
> 时间：2012-07-27T19:47:05.850
> 
> 标签：iphone, ios, xcode, map, overlay

我正在创建一个基于 Apple 提供的面包屑示例代码的应用程序，我想将应用程序绘制的覆盖路径存储在核心数据中。然后我想稍后再回忆这些数据并再次将其绘制在地图上。这可能吗？做这个的最好方式是什么？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-28T01:06:33.087

这是可能的。创建一个具有纬度、经度和时间戳属性的托管对象，然后在它们进入时将它们存储（一起作为一个对象）。要将它们显示在地图上，请反转过程并从对象创建图钉。您应该按时间戳排序以创建路径。

# c# - nHibernate 多对多映射只删除关联

> ID：11694719
> 
> 赞同：4
> 
> 时间：2012-07-27T19:47:08.713
> 
> 标签：c#, nhibernate, orm, mapping, many-to-many

我在这里看到过这个问题，但我没有找到一个正确回答的问题。我有这些表的多对多映射：

```
Collection
Items
Collection_Items 
```

一个**Collection**有许多**Items**，一个项目可以属于许多**Collections**。 **Collection_Items**是连接表。

如果（使用**nHibernate**）我想删除一个**Item**或**Collection**并让它删除它正在加入关联*而不*删除它的孩子......我该怎么做？

如果你有一个例子，它是 XML 还是 Fluent 还是属性或其他什么都没关系。

另外，我有将两个表连接到连接表的外键约束。

有什么例子吗？

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-27T20:13:52.103

事实证明，我只需要两侧的**CascaseStyle.None**并从**Items**侧删除**Inverse = True**。原来这是一个非常简单的映射。

# windows-8 - WIndows 8 Metro 列表视图事件监听器

> ID：11694720
> 
> 赞同：0
> 
> 时间：2012-07-27T19:47:10.733
> 
> 标签：windows-8, microsoft-metro

我正在尝试为 Windows 8 创建一个简单的 HTML Metro App。我想显示一个列表视图，并根据单击的项目在屏幕上显示不同的内容。这听起来微不足道，对吧？但它不起作用！这是我的代码：

```
<div  id="frameListViewTemplate"  data-win-control="WinJS.Binding.Template">
   <img data-win-bind="src: picture" class="thumbnail" />
</div>
<div id="basicListView" data-win-control="WinJS.UI.ListView" 
    data-win-options="{itemDataSource : DataExample.itemList.dataSource, itemTemplate: select('#frameListViewTemplate'),onselectionchanged : handler}">
</div> 
```

比在 defult.js 中

```
var myListView = document.getElementById("basicListView").winControl;
myListView.addEventListener("selectionchanged", handler); 
```

和处理程序：

```
function handler() {
console.log("Inside the handler  : ");
}
handler.supportedForProcessing = true; 
```

所以处理程序永远不会被调用。我的问题是：如何将事件侦听器及其处理程序添加到 listview 控件。如何识别单击了列表视图中的哪个元素。

PS列表视图在我的应用程序中正确显示。谢谢你的帮助，J

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T21:21:36.817

要获取被“点击”的项目，您需要使用 itemInvoked。当用户在项目上交叉滑动以选择它而不是点击/单击以“调用”它时，将发生选择更改。

[http://msdn.microsoft.com/en-us/library/windows/apps/br211827.aspx](http://msdn.microsoft.com/en-us/library/windows/apps/br211827.aspx)有一些基本的细节。

# php - 来自 Symfony sfMailer 的关于发送邮件的调试信息

> ID：11694724
> 
> 赞同：0
> 
> 时间：2012-07-27T19:47:16.443
> 
> 标签：php, symfony1, symfony-1.4, swiftmailer

我需要在 Symfony 1.4 中记录 sfMailer 发送电子邮件的结果

该消息将在用户提交包含其联系电子邮件地址的表单时发送。

如果失败（发送邮件），我应该使用记录器记录他的电子邮件地址。这对我来说很清楚。

我仍然没有得到的是如何从 sfMailer 获得关于发送是否成功的“更新”？如果可能，返回 true 或 false 的东西。

Web 调试工具栏很好，但在这里没有帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-28T08:55:39.337

根据[文档](http://swiftmailer.org/docs/sending.html)：

> 使用 send() 时，消息将像使用邮件客户端时一样发送。**返回一个整数，其中包括成功接收者的数量。**如果没有一个收件人可以发送到，那么将返回零，这相当于一个布尔值 false。如果您在邮件中设置了两个 To: 收件人和三个 Bcc: 收件人，并且所有收件人都已成功传递，则将返回值 5。

导致：

```
// Send the message
$result = $mailer->send($message);

// or in a symfony action
$result = $this->getMailer()->send($message); 
```

# ruby - 我可以使用 Ruby/Builder 在 xml 节点中编写代码吗？

> ID：11694726
> 
> 赞同：0
> 
> 时间：2012-07-27T19:47:25.413
> 
> 标签：ruby, xml, watir, builder

这是我的代码：

```
require 'builder'

def initXML(builder)
    builder.instruct!
    builder.results(:result => 'result'){}
end 
def writeXML(builder,name,hello)    
    builder.test(:name => name){
        builder.hello hello
        }
end 
builder = Builder::XmlMarkup.new(:target=> STDOUT, :indent=>4)
initXML(builder)
writeXML(builder,'name1','hello1')
writeXML(builder,'name2','hello2') 
```

执行我得到这个 XML：

```
<?xml version="1.0" encoding="UTF-8"?>
<results result="result">
</results>
<test name="name1">
    <hello>hello1</hello>
</test>
<test name="name2">
    <hello>hello2</hello>
</test> 
```

但我想要`</results>`文件末尾的结束标签。有办法在`<results>`节点内部写入吗？或者移动`</results>`到文件末尾？使用Nokogiri更好吗？还是手动生成我的 XML 更好？我正在尝试将它与 Watir 单元测试一起使用，我可以用它来将我的结果写入 XML 文件吗？

（更新）这就是我想要的 XML：

```
 <?xml version="1.0" encoding="UTF-8"?>
    <results result="result">    
    <test name="name1">
        <hello>hello1</hello>
    </test>
    <test name="name2">
        <hello>hello2</hello>
    </test>
    </results> 
```

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T20:03:15.153

它正在准确地写出您要告诉它的内容。

将一个块传递给`initXML`（`init_xml`在惯用的 Ruby，IMO 中）并执行它。但我不会这样称呼它`init_xml`，因为您实际上在做的是包装 XML 内容。

我不确定您要完成什么；使用普通的构建器语义很容易做到这一点。如果您想从方法返回 XML 节点，可以考虑将当前节点传递给方法。如果不确切知道您要做什么，就很难提出建议。

# amazon-ec2 - 基于 EC2 的部署的监控解决方案

> ID：11694727
> 
> 赞同：1
> 
> 时间：2012-07-27T19:47:29.920
> 
> 标签：amazon-ec2, monitoring

我们在 EC2 中有大约 20 台服务器，大多数是动态生成的（扩展组）。

我们正在寻找一种解决方案来监控我们的应用程序的正常运行时间。

作为一个额外的好处，这个解决方案还可以扩展到实际监控所涉及的服务器，因此它很容易及时返回并查看在停机之前发生了什么或诸如此类。

我们正在寻找一个理想的托管解决方案，它应该很容易扩展（它需要以某种方式动态地处理添加/删除的服务器，而无需我们进行交互）。

总之，希望大家给点建议。

* * *

一点背景...

我们目前正在使用自定义的 Nagios 设置，现在服务器已经完全动态化，它被简化为基本上进行简单的 http 检查。我们已经使用 PagerDuty 来交付页面。确实可以，但是为了维护成本，我们很可能使用 http 检查@Pingdom 的服务器密度。

我已经简要地查看了 ServerDensity，它看起来确实很有希望，我特别喜欢他们的安装机制，只需将文件转储到您的 AMI 中，剩下的就交给它了。

在深入研究任何特定解决方案之前，我想知道有哪些选择。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T20:01:32.890

我们结合使用 Server Density 进行监控和 PagerDuty 进行警报。两者配合得很好。

# c++ - msgpack C++ 实现：如何打包二进制数据？

> ID：11694730
> 
> 赞同：8
> 
> 时间：2012-07-27T19:47:37.140
> 
> 标签：c++, msgpack

我正在使用 C++ msgpack 实现。我在如何打包二进制数据方面遇到了障碍。就二进制数据而言，我有以下类型的缓冲区：

```
unsigned char* data; 
```

**data**变量指向一个实际上是图像的数组。我想要做的是使用 msgpack 打包它。似乎没有如何实际打包二进制数据的示例。从[格式规范](http://wiki.msgpack.org/display/MSGPACK/Format+specification)中支持原始字节，但我不确定如何使用该功能。

我尝试使用如下字符指针向量：

```
msgpack::sbuffer temp_sbuffer;
std::vector<char*> vec;
msgpack::pack(temp_sbuffer, vec); 
```

但这会导致编译器错误，因为没有**T=std::vector**的函数模板。

我也简单地尝试了以下方法：

```
msgpack::pack(temp_sbuffer, "Hello"); 
```

但这也会导致编译错误（即没有**T=const char [6]的函数模板**

因此，我希望有人能给我关于如何使用 msgpack C++ 打包表示为**char**数组的二进制数据的建议。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-30T15:28:09.260

Josh[提供了一个很好的答案](https://stackoverflow.com/a/11697811/30433)，但它需要将字节缓冲区复制到 char 向量。我宁愿尽量减少复制并直接使用缓冲区（如果可能的话）。以下是替代解决方案：

查看源代码并尝试根据我遇到的规范确定不同的数据类型是如何打包的`msgpack::packer<>::pack_raw(size_t l)`，`msgpack::packer<>::pack_raw_body(const char* b, size_t l)`. 虽然似乎没有这些方法的文档，但这就是我描述它们的方式。

1.  **msgpack::packer<>::pack_raw(size_t l)**：此方法将类型标识附加到缓冲区（即修复 raw、raw16 或 raw32）以及大小信息（这是该方法的参数）。
2.  **msgpack::packer<>::pack_raw_body(const char* b, size_t l)**：此方法将原始数据附加到缓冲区。

下面是一个如何打包字符数组的简单示例：

```
msgpack::sbuffer temp_sbuffer;
msgpack::packer<msgpack::sbuffer> packer(&temp_sbuffer);
packer.pack_raw(5);  // Indicate that you are packing 5 raw bytes
packer.pack_raw_body("Hello", 5); // Pack the 5 bytes 
```

上面的示例可以扩展为打包任何二进制数据。这允许直接从字节数组/缓冲区打包，而不必复制到中间（即字符向量）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-28T02:38:56.330

如果您可以将图像存储在 a`vector<unsigned char>`而不是原始数组中`unsigned char`，那么您可以将其打包`vector`：

```
#include <iostream>
#include <string>
#include <vector>
#include <msgpack.hpp>

int main()
{
    std::vector<unsigned char> data;
    for (unsigned i = 0; i < 10; ++i)
        data.push_back(i * 2);

    msgpack::sbuffer sbuf;
    msgpack::pack(sbuf, data);

    msgpack::unpacked msg;
    msgpack::unpack(&msg, sbuf.data(), sbuf.size());

    msgpack::object obj = msg.get();
    std::cout << obj << std::endl;
} 
```

奇怪的是，这只适用于`unsigned char`. 如果您尝试打包一个缓冲区，`char`而不是（甚至是个人`char`），它将无法编译。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-07-20T22:02:56.647

MessagePack 有一种`raw_ref`类型，您可以像这样使用它：

```
#include "msgpack.hpp"

class myClass
{
public:
    msgpack::type::raw_ref r;
    MSGPACK_DEFINE(r);
};

int _tmain(int argc, _TCHAR* argv[])
{
    const char* str = "hello";

    myClass c;

    c.r.ptr = str;
    c.r.size = 6;

    // From here on down its just the standard MessagePack example...

    msgpack::sbuffer sbuf;
    msgpack::pack(sbuf, c);

    msgpack::unpacked msg;
    msgpack::unpack(&msg, sbuf.data(), sbuf.size());

    msgpack::object o = msg.get();

    myClass d;
    o.convert(&d);

    OutputDebugStringA(d.r.ptr);

    return 0;

} 
```

免责声明：我通过查看头文件而不是通过阅读不存在的关于序列化原始字节的文档发现了这一点，因此它可能不是“正确”的方式（尽管它**是**与所有其他“标准”类型一起定义的序列化程序想要显式处理）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-05-31T04:29:00.013

msgpack-c 已在问题和答案发布后更新。我想告知目前的情况。

从 msgpack-c 版本 2.0.0 开始支持 C 样式数组。见[https://github.com/msgpack/msgpack-c/releases](https://github.com/msgpack/msgpack-c/releases)

msgpack-c 可以打包 const char 数组，例如“hello”。类型转换规则记录在[https://github.com/msgpack/msgpack-c/wiki/v2_0_cpp_adaptor#predefined-adaptors](https://github.com/msgpack/msgpack-c/wiki/v2_0_cpp_adaptor#predefined-adaptors)。

char 数组映射到 STR。如果你想使用 BIN 而不是 STR，你需要用`msgpack::type::raw_ref`. 那是包装概述。

以下是解包和转换说明： [https ://github.com/msgpack/msgpack-c/wiki/v2_0_cpp_object#conversion](https://github.com/msgpack/msgpack-c/wiki/v2_0_cpp_object#conversion)

解包意味着`msgpack::object`从 MessagePack 格式的字节流创建。转换意味着从 . 转换为 C++ 对象`msgpack::object`。

如果MessagePack 格式的数据是STR，并且隐蔽的目标类型是char 数组，则将数据复制到数组中，如果数组有多余的容量，则添加'\0'。如果 MessagePack 格式的数据是 BIN，则不添加“\0”。

这是基于原始问题的代码示例：

```
#include <msgpack.hpp>
#include <iostream>

inline
std::ostream& hex_dump(std::ostream& o, char const* p, std::size_t size ) {
    o << std::hex << std::setw(2) << std::setfill('0');
    while(size--) o << (static_cast<int>(*p++) & 0xff) << ' ';
    return o;
}

int main() {
    {
        msgpack::sbuffer temp_sbuffer;
        // since 2.0.0 char[] is supported.
        // See https://github.com/msgpack/msgpack-c/wiki/v2_0_cpp_adaptor#predefined-adaptors
        msgpack::pack(temp_sbuffer, "hello");
        hex_dump(std::cout, temp_sbuffer.data(), temp_sbuffer.size()) << std::endl;

        // packed as STR See https://github.com/msgpack/msgpack/blob/master/spec.md
        // '\0' is not packed
        auto oh = msgpack::unpack(temp_sbuffer.data(), temp_sbuffer.size());
        static_assert(sizeof("hello") == 6, "");
        char converted[6];
        converted[5] = 'x'; // to check overwriting, put NOT '\0'.
        // '\0' is automatically added if char-array has enought size and MessagePack format is STR
        oh.get().convert(converted); 
        std::cout << converted << std::endl;
    }
    {
        msgpack::sbuffer temp_sbuffer;
        // since 2.0.0 char[] is supported.
        // See https://github.com/msgpack/msgpack-c/wiki/v2_0_cpp_adaptor#predefined-adaptors
        // packed as BIN
        msgpack::pack(temp_sbuffer, msgpack::type::raw_ref("hello", 5));
        hex_dump(std::cout, temp_sbuffer.data(), temp_sbuffer.size()) << std::endl;

        auto oh = msgpack::unpack(temp_sbuffer.data(), temp_sbuffer.size());
        static_assert(sizeof("hello") == 6, "");
        char converted[7];
        converted[5] = 'x';
        converted[6] = '\0';
        // only first 5 bytes are written if MessagePack format is BIN
        oh.get().convert(converted);
        std::cout << converted << std::endl;
    }
} 
```

运行演示： [https ://wandbox.org/permlink/mYJyYycfsQIwsekY](https://wandbox.org/permlink/mYJyYycfsQIwsekY)

# php - 错误 324 (net::ERR_EMPTY_RESPONSE)：服务器关闭连接而不发送任何数据

> ID：11694732
> 
> 赞同：1
> 
> 时间：2012-07-27T19:47:49.713
> 
> 标签：php, timeout, execution-time

我正在尝试运行一个长时间运行的脚本来下载和解析页面的新闻项目。我的脚本下载了大约 260 多个 html 页面，并从每个页面解析新闻项目。

这是一个长期运行的脚本。

如果我将它必须解析的页面数量设置为低（这意味着它会花费更少的时间来执行），那么脚本运行良好：

```
// Since the University blog page has 262 pages, we'll iterate through that.
// Only 21 pages.
for ($i = 2; $i <= 21; $i++) {
    $url = "http://www.uvm.cl/noticias_mas.shtml?AA_SL_Session=34499aef1fc7a296fb666dcc7b9d8d05&scrl=1&scr_scr_Go=" . $i;
    $page = file_get_html($url);
    parse_page_for_news($page, $parsedNews);
} 
```

如果我将该页数增加到 40 或更多，脚本将不再返回任何内容。在 Google Chrome 上会出现此错误消息：

```
// Since the University blog page has 262 pages, we'll iterate through that.
// 41 pages this time. Longer running time!
for ($i = 2; $i <= 41; $i++) {
    $url = "http://www.uvm.cl/noticias_mas.shtml?AA_SL_Session=34499aef1fc7a296fb666dcc7b9d8d05&scrl=1&scr_scr_Go=" . $i;
    $page = file_get_html($url);
    parse_page_for_news($page, $parsedNews);
} 
```

* * *

> 没有收到任何数据
> 
> 无法加载网页，因为服务器未发送数据。
> 
> 以下是一些建议： 稍后重新加载此网页。
> 
> 错误 324 (net::ERR_EMPTY_RESPONSE)：服务器关闭连接而不发送任何数据。

这是我`php.ini`根据一些搜索所做的修改，但仍然没有工作修复。

```
;;;;;;;;;;;;;;;;;;;
; Resource Limits ;
;;;;;;;;;;;;;;;;;;;

max_execution_time = 0     ; Maximum execution time of each script, in seconds
max_input_time = 60 ; Maximum amount of time each script may spend parsing request data
memory_limit = -1      ; Maximum amount of memory a script may consume (8MB) 
```

另一个奇怪的是，当我将脚本设置为快速运行（迭代次数很少）时，我实际上可以在`access_log`文件中看到请求。

```
127.0.0.1 - - [27/Jul/2012:15:50:19 -0400] "GET /scrapernoticias/scraper.php HTTP/1.1" 200 509
127.0.0.1 - - [27/Jul/2012:15:50:23 -0400] "GET /scrapernoticias/scraper.php HTTP/1.1" 200 509
127.0.0.1 - - [27/Jul/2012:15:58:02 -0400] "GET /scrapernoticias/scraper.php HTTP/1.1" 200 500 
```

当我将事情设置为高（长时间运行迭代）时，我看不到这个新请求，就好像它从未到达服务器一样。

这是整个脚本：

```
<h1>Scraper Noticias</h1>

<?php

include('simple_html_dom.php');
include('rb.php');

// Setup RedBean to work with a database.
R::setup('mysql:host=localhost;dbname=noticias','root','');

set_time_limit(0);

class News {
    var $image;
    var $fechanoticia;
    var $title;
    var $description;
    var $sourceurl;

    function get_image( ) {
        return $this->image;
    }

    function set_image ($new_image) {
        $this->image = $new_image;
    }

    function get_fechanoticia( ) {
        return $this->fechanoticia;
    }

    function set_fechanoticia ($new_fechanoticia) {
        $this->fechanoticia = $new_fechanoticia;
    }

    function get_title( ) {
        return $this->title;
    }

    function set_title ($new_title) {
        $this->title = $new_title;
    }

    function get_description( ) {
        return $this->description;
    }

    function set_description ($new_description) {
        $this->description = $new_description;
    }

    function get_sourceurl( ) {
        return $this->sourceurl;
    }

    function set_sourceurl ($new_sourceurl) {
        $this->sourceurl = $new_sourceurl;
    }
}

// Declare variable to hold all parsed news items.
$parsedNews = array();

// Grab page number 1, and parse that first.
$initialPage = file_get_html('http://www.uvm.cl/noticias_mas.shtml');
parse_page_for_news($initialPage, $parsedNews);

// Since the University blog page has 262 pages, we'll iterate through that.
for ($i = 2; $i <= 3; $i++) {
    $url = "http://www.uvm.cl/noticias_mas.shtml?AA_SL_Session=34499aef1fc7a296fb666dcc7b9d8d05&scrl=1&scr_scr_Go=" . $i;
    $page = file_get_html($url);
    parse_page_for_news($page, $parsedNews);
}

echo "<h1>Noticias encontradas:" . count($parsedNews) . "</h1>";
//echo print_r($parsedNews[count($parsedNews) - 1]);

// Save each parsed news to the database.
foreach($parsedNews as &$tmpNews) {
    $noticia = R::dispense('noticia');
    $noticia->imagen = $tmpNews->get_image();
    $noticia->fecha = $tmpNews->get_fechanoticia();
    $noticia->titulo = $tmpNews->get_title();
    $noticia->url = $tmpNews->get_sourceurl();
    $noticia->descripcion = $tmpNews->get_description(); 
    $id = R::store($noticia);  
}

// Disconnect from the database.
R::close();

// Function receives an HTML Dom object, and the library works against that single HTML object.
function parse_page_for_news ($page, &$parsedNews) {

    foreach($page->find('#cont2 p') as $element) {

        $newItem = new News;

        // Parse the news item's thumbnail image.
        foreach ($element->find('img') as $image) {
            $newItem->set_image($image->src);
            //echo $newItem->get_image() . "<br />";
        }

        // Parse the news item's post date.
        foreach ($element->find('span.fechanoticia') as $fecha) {
            $newItem->set_fechanoticia($fecha->innertext);
            //echo $newItem->get_fechanoticia() . "<br />";
        }

        // Parse the news item's title.
        foreach ($element->find('a') as $title) {
            $newItem->set_title($title->innertext);
            //echo $newItem->get_title() . "<br />";
        }

        // Parse the news item's source URL link.
        foreach ($element->find('a') as $sourceurl) {
            $newItem->set_sourceurl("http://www.uvm.cl/" . $sourceurl->href);
        }

        // Parse the news items' description text.
        foreach ($element->find('a') as $link) {
            $link->outertext = '';
        }

        foreach ($element->find('span') as $link) {
            $link->outertext = '';
        }

        foreach ($element->find('img') as $link) {
            $link->outertext = '';
        }

        $newItem->set_description($element->innertext);

        // Add the newly formed NewsItem to the $parsedNews object.
        $parsedNews[] = $newItem;

        // For debugging purposes, it'll print each parsed News Item.
        //print_r($newItem);
        //echo "<br /><br /><br />";

    }
} 

?> 
```

# javascript - 在服务器中保存 xml 文件中的更改

> ID：11694733
> 
> 赞同：0
> 
> 时间：2012-07-27T19:47:51.280
> 
> 标签：javascript, xml

我有一个网页可以正确地将 xml 文件加载到 DOM 中，并使用该信息在 html 上使用 javascript 创建一个表，现在我想创建一个管理页面，您可以在其中轻松更改每个人的 xml 文件内容，但我不不知道我可以使用哪个工具、库或函数从 de DOM 创建一个 xml 文档并将更改保存在服务器中。
我怎样才能做到这一点？

**编辑：**这实际上是一个小列表，所以如果你能找到一个更好的方法，而不是使用 xml，请告诉

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T20:40:16.373

如果你想管理 XML 文件中的数据，我会使用 PHP 和 simpleXML 对象来存储数据，然后使用 foreach() 输出一个表单来遍历 XML 中的每个元素并将数据放入一堆输入如`<input type="text" value="<?php //output data here ?>" >`. 然后您可以允许用户编辑字段，点击保存按钮，删除旧的 XML 文件，基本上只需将新编辑的文件保存在您想要的任何位置。

# java - 下载 Maven 存储库文件

> ID：11694736
> 
> 赞同：3
> 
> 时间：2012-07-27T19:48:20.233
> 
> 标签：java, maven, netbeans

我有一个 Maven 存储库，其中包含我想在其他项目中本地使用的 jar 文件。从 Maven 存储库下载这些 jar 文件的最佳方法是什么。

我去了[http://mvnrepository.com/](http://mvnrepository.com/)但 jar 文件在我的构建中不起作用。我想要的是 Maven 构建 jar 文件，但我无法从我的 Netbeans 项目中保存它们。

有没有办法下载 Maven 存储库中的所有文件？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-27T19:50:48.143

maven Central 中可能有数千个 jar 文件，所以我不会尝试下载所有这些文件。

一般来说，如果你想使用在 maven 仓库中找到的 jars，你可能需要自己启动一个 maven 项目；将您的配置`pom.xml`为需要这些依赖项，它们将自动下载。

大多数 java IDE 都有 maven 支持或 maven 插件。

- 编辑 -

这是[maven 网站上](http://maven.apache.org/guides/getting-started/maven-in-five-minutes.html)`pom.xml`的一个非常简单的示例：

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
  <modelVersion>4.0.0</modelVersion>

  <groupId>com.mycompany.app</groupId>
  <artifactId>my-app</artifactId>
  <version>1.0-SNAPSHOT</version>
  <packaging>jar</packaging>

  <name>Maven Quick Start Archetype</name>
  <url>http://maven.apache.org</url>

  <dependencies>
    <dependency>
      <groupId>junit</groupId>
      <artifactId>junit</artifactId>
      <version>4.8.2</version>
      <scope>test</scope>
    </dependency>
  </dependencies>
</project> 
```

如果您使用 eclipse，您可能希望 m2e 插件为您处理大部分内容。另外，它还会将 javadoc 链接到这些 jar。:)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-27T19:52:07.573

你为什么不尝试使用[Maven](http://maven.apache.org/)呢？使用 Maven，您可以轻松地自动管理您的依赖项。

这真的很简单。请在 5 分钟内检查此[Maven，](http://maven.apache.org/guides/getting-started/maven-in-five-minutes.html)以便您可以成功开始使用它。有任何疑问，请告诉我。

- 编辑 -

一旦您了解了一些主要概念，例如依赖项，您就可以使用以下命令简单地启动您的项目：

```
mvn archetype:generate -DgroupId=com.mycompany.app -DartifactId=my-app -DarchetypeArtifactId=maven-archetype-quickstart -DinteractiveMode=false 
```

之后，您可以简单地导入到最常用的 IDE，如 Eclipse，使用：

```
mvn eclipse:eclipse 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-12-12T01:40:48.780

工具 mvn2get ( [https://github.com/groboclow/mvn2get](https://github.com/groboclown/mvn2get) ) 将下载适合在本地存储库中使用的已发布 Maven 工件。这包括 POM 文件、校验和文件和签名文件，以及能够搜索依赖项。

它允许单行执行来下载文件：

```
$ mvn2get.py -d my-local-repo-dir --resolve log4j:log4j:1.2.17 
```

我基于下载到本地存储库的类似需要编写了这个脚本。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-27T23:22:50.393

显而易见的答案是建议您考虑使用 Maven 构建代码。这将为您提供对 Maven 中央存储库的本机支持。

但是...我感觉您只是想将所需的文件下载到本地目录？在这种情况下，我建议使用[Apache ivy command-line](http://ant.apache.org/ivy/history/latest-milestone/standalone.html)。

# 例子

您想要的文件列在[ivy.xml](http://ant.apache.org/ivy/history/latest-milestone/ivyfile.html)文件中。例如：

```
<ivy-module version="2.0" xmlns:e="http://ant.apache.org/ivy/extra">
    <info organisation="com.myspotontheweb" module="demo"/>

    <dependencies>
        <dependency org="commons-lang" name="commons-lang" rev="2.6" conf="default"/>
        <dependency org="junit" name="junit" rev="4.10" conf="default"/>
    </dependencies>

</ivy-module> 
```

常春藤可以填充本地“lib”目录，如下所示：

```
java -jar ivy.jar -retrieve "lib/[artifact].[ext]" -ivy ivy.xml 
```

这种方法的优点是 ivy 可以下载您指定的模块的附加传递依赖项：

```
$ find lib -type f
lib/commons-lang.jar
lib/junit.jar
lib/hamcrest-core.jar 
```

**笔记：**

*   hamcrest-core 是 junit 的依赖项。

# clojure - clojure 代码示例中的这个函数定义有什么作用？

> ID：11694737
> 
> 赞同：4
> 
> 时间：2012-07-27T19:48:21.293
> 
> 标签：clojure, functional-programming, higher-order-functions

我正在关注“Clojure in Action”，对此我感到困惑：

```
(defn with-log [function-to-call log-statement ]
      (fn [& args]
          (println log-statement)
          (apply  function-to-call args))) 
```

这是让我感到困惑的代码段。到目前为止，这是我能破译的：

(defn with-log [function-to-call log-statement ] ..) 定义了一个名为“with-log”的函数，它接受参数“function-to-call”和“log-statement”以及function-to- call 是作为参数传递给此函数的函数。下一部分让我感到困惑：（fn [& args] .... 这里定义了一个匿名函数吗？'with-log' 函数是否返回一个新的函数定义？

```
(fn [& args]
          (println log-statement)
          (apply  function-to-call args)) 
```

因此，通过调用 (with-log somefunc "my label") - 它只是返回一个新的匿名函数吗？还是调用匿名函数？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-29T20:04:36.060

`with-log`将产生一个函数，当调用该函数时，它将完全执行所做的操作，除了将打印到之前使用给匿名函数的参数进行评估`function-to-call`的副作用。`log-statement``*out*``function-to-call`

这是[装饰器模式](http://en.wikipedia.org/wiki/Decorator_pattern)的一个示例——通过将现有函数包装在另一个函数中来扩展现有函数的行为，即`with-log`使用`(fn ...)`表单创建的匿名函数。

为了使装饰器函数`with-log`与任何可以想象`function-to-call`的 . 一起工作，指定匿名函数的参数列表，以便可以使用`(fn [& args] ...)`. 当匿名函数调用`function-to-call`它时，用函数“解包”参数列表`apply`）。

使用方法`with-log`可能是：

```
((with-log some-fn "Calling some-fn") arg1 arg2) 
```

或者

```
(defn my-fn [a b]
  (+ a b))
(def my-fn-with-logging (with-log my-fn "Calling my-fn"))

(my-fn 1 2) ; evaluates to 3
(my-fn-with-logging 1 2) ; prints "Calling my-fn" and evaluates to 3 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T20:04:25.103

它正在返回匿名函数，并且没有被调用。

例如，这将使用给定的参数调用匿名函数：

```
((with-log some-fn "log statement") arg1 arg2) 
```

这是有效的，因为返回的函数是列表中的第一项，这意味着它像任何其他函数一样被调用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-27T20:04:53.840

你是对的。`(fn ..)`是一种创建匿名函数的形式。这段代码，给定一个函数`f`和一些值`s`，将返回一个函数，当调用该函数时，将打印`s`然后调用`f`：

```
user=> (defn with-log [function-to-call log-statement ]
      (fn [& args]
          (println log-statement)
          (apply  function-to-call args)))
#'user/with-log
user=> (with-log + "String")
#<user$with_log$fn__1 user$with_log$fn__1@147264b1>
user=> ((with-log + "String") 1 2 3)
String
6
user=> 
```

注意以 开头的行`#<user$...`。这是刚刚创建的匿名函数的内部标识符，即简单调用`with-log`返回一个函数。然后我们将相同的函数（就其行为而言是相同的；实际上它将是不同的对象，因为每次调用`with-log`都会创建相同函数的新“实例”）应用于多个参数。`"String"`字符串被打印出来，然后 REPL 向我们显示`(+ 1 2 3)`.

[在这里](http://clojure.org/special_forms#Special%20Forms--%28fn%20name?%20%5Bparams%2a%20%5D%20exprs%2a%29)您可以了解更多信息。

# mysql - 我应该为 WHERE 子句中的所有字段添加索引吗？- MySQL

> ID：11694743
> 
> 赞同：17
> 
> 时间：2012-07-27T19:48:38.423
> 
> 标签：mysql, optimization, indexing, where

在我的程序中，我的插入很少，并且任何经常运行的都不需要立即运行，因此已更改为`INSERT DELAYED`. 我是否应该检查我的代码并查看`WHERE`子句中引用了哪些字段并为每个字段添加索引？如果是这样，我使用什么类型的索引？只是插入速度变慢了吗？

我也可以在任何数据类型上使用这些索引吗？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-07-27T20:00:01.370

有两个主要的地方我们可以考虑索引：WHERE 子句中引用的列和 JOIN 子句中使用的列。简而言之，应该为这些列建立索引，您需要根据这些列搜索特定记录。

*   仅索引 WHERE 和 ORDER BY 子句中需要的那些列。大量索引列会导致一些缺点。
*   对您考虑索引的列使用 NOT NULL 属性，以便永远不会存储 NULL 值。
*   使用 --log-long-format 选项记录不使用索引的查询。通过这种方式，您可以检查此日志文件并相应地调整您的查询。还有慢查询日志。
*   EXPLAIN 语句帮助您揭示 MySQL 将如何执行查询。它显示了表的连接方式和顺序。这对于确定如何编写优化查询以及是否需要对列进行索引非常有用。

这个[博客](http://ronaldbradford.com/blog/understanding-different-mysql-index-implementations-2009-07-22/)很好。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-27T19:54:52.747

您应该始终在要在 WHERE 子句中使用的任何字段上添加索引（无论是用于 SELECT、UPDATE 还是 DELETE）。索引的类型取决于字段中的数据类型以及是否需要每行具有唯一值。通常默认索引类型（Hash vs. Btree）最好保留默认设置，除非您真的知道自己在做什么。

现在，您是使用单个索引（每个字段一个）还是复合索引取决于应用程序的工作方式并且是一个更高级的主题，因此通常如果刚刚开始使用并为每个字段编制索引。请注意，您的主键自动具有索引，因此您无需在这些索引上创建另一个索引。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-27T19:50:31.013

在发现性能问题之前不要更改查询 - 这是过早的优化。相反，使用 MySQL 查询日志来查看哪些查询需要很长时间，并专注于改进这些查询。

# core-data - NSManagedObject 子类上“计算字段”的方法

> ID：11694747
> 
> 赞同：2
> 
> 时间：2012-07-27T19:49:00.920
> 
> 标签：core-data, nsmanagedobject, calculated-field

我想将一些自定义方法直接放入每个 NSManagedObject 中。想想，“计算字段”：这些方法根据实体上的持久值提供只读计算值 - 这与[这个问题](https://stackoverflow.com/questions/2745999/how-can-i-set-a-custom-attribute-of-an-nsmanagedobject-which-is-calculated-from)相同。

我正在使用 Xcode New File... Wizard 为我的每个实体创建 NSManagedObject 子类。我正在尝试从系统为我自动创建访问器中受益。例如：

核心数据实体：“站点”

```
@interface Site : NSManagedObject 
```

当我继续向我的实体添加新属性时，我正在使用向导替换它们对应的 NSManagedObjects。当每个文件被替换时，我的自定义方法都会丢失。

我是否应该在别处创建自定义方法以便继续使用向导？或者，我应该保留 NSManagedObject 上的方法并手动为新属性添加访问器吗？还有另一种方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-27T20:03:02.540

在您的 NSManagedObject 子类上创建一个类别：

*   在“新建文件...”对话框中，选择“Objective-C 类别”。
*   在“站点”上创建一个类别“CustomMethods”。
*   Xcode 将创建文件*Site+CustomMethods.h* ，为相应的实现声明`@interface Site (CustomMethods)`, 和*Site+CustomMethods.m 。*
*   将您的自定义方法添加到类别中。

当您在 Xcode 中重新创建*Site.m*和*Site.h*时，这些文件不会被覆盖。

所有类别方法都可以像在类本身中声明一样使用。在类别中唯一不能做的就是添加新的实例变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T19:57:13.453

一旦我使用向导创建了初始托管对象，我通常会手动更改它们。

另一种方法是创建向导生成的类文件的子类并使用它们。当它们重新生成时，您的所有自定义代码都在子类中，而不是被覆盖的类文件。

# c++ - 库构建系统是否应该默认关闭断言？

> ID：11694750
> 
> 赞同：3
> 
> 时间：2012-07-27T19:49:17.823
> 
> 标签：c++, c, build

我正在编写一个包含许多断言的库。打开断言后，该库要慢得多，并且该库的全部意义在于它很快，因此断言仅在测试或诊断错误时才有意义。我正在使用 autoconf，要求用户了解这个问题并传递一个标志来配置以禁用断言似乎是标准做法。在这种情况下，只有专家用户会知道足够的知识来安装适当版本的库！这真的是我应该做的吗？如果是这样，除了“这是专家用户和其他程序员所期望的”之外，还有其他充分的理由吗？

**编辑：** [这是](http://old.nabble.com/C++,-assert-and-NDEBUG-td28052920.html)一个讨论示例，说明您不应该在发布模式下默认定义 NDEBUG，尽管没有其他原因，因为这样做令人惊讶。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T18:50:07.923

我想我现在已经想通了。定义 NDEBUG 的问题在于它可能导致未定义的行为。我的是一个包含一些非模板部分的模板库，所以我的代码被内联到其他人的二进制文件中。如果我在编译非内联代码时定义了 NDEBUG，然后在没有 NDEBUG 的情况下编译了客户端代码，那么标头中的代码将有两个不兼容的版本——一个带有断言，一个没有。这会导致未定义的行为，我曾经遇到过这个问题，因为我遇到过一次神秘的崩溃。所以我不认为图书馆应该定义 NDEBUG - 负责在给定计算机上编译所有内容的人或构建系统应该是决定 NDEBUG 的人。

但是，我不必定义 NDEBUG 只是为了让我的库在没有断言的情况下默认运行。我现在有一个宏 MYLIB_DEBUG 和 MYLIB_ASSERT。如果 MYLIB_DEBUG 未定义，则 MYLIB_ASSERT(X) 什么也不做。如果定义了 MYLIB_DEBUG，则 MYLIB_ASSERT(X) 定义为 assert(X)。这使得断言选择加入而不会弄乱 NDEBUG。

所以我目前对我的问题的回答是，默认情况下库可以关闭断言，如果你的接口有任何包含断言的内联函数，就不要通过定义 NDEBUG 来做到这一点。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-29T00:31:57.370

如果使用 assert 会使您的库变慢，请按照您的意愿进行操作并将其关闭。确保它被清楚地记录在案......并停止担心。

# javascript - javascript重定向到新窗口

> ID：11694753
> 
> 赞同：3
> 
> 时间：2012-07-27T19:49:29.593
> 
> 标签：javascript, redirect

我有这段代码可以根据下拉列表的值重定向到页面：

```
<Script language="JavaScript">
function goto(form) { var index=form.select.selectedIndex
if (form.select.options[index].value != "0") {
location=form.select.options[index].value;}}
//-->
</SCRIPT> 
```

如何在新窗口中打开它？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-07-27T19:53:21.997

```
function goto(form) {
    var index = form.select.selectedIndex
    if (form.select.options[index].value != "0") {
        location = form.select.options[index].value;
        window.open(location);
    }
}​ 
```

有关可用选项的完整列表`window.open`，请参阅[https://developer.mozilla.org/en/DOM/window.open](https://developer.mozilla.org/en/DOM/window.open)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-10-26T10:14:23.243

制作javascript函数：-

```
 onBtnPress:function(){
        window.open("http://www.yashvekaria.com", "_blank");
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-27T19:52:32.860

```
window.open(url, "nameOfTheWindow"); 
```

查看[http://www.w3schools.com/jsref/met_win_open.asp](http://www.w3schools.com/jsref/met_win_open.asp)以查看详细选项，大多数浏览器都支持此功能，但其中一些无法很好地调整弹出窗口的大小。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-27T19:51:32.177

```
window.open(URL,name,specs,replace) 
```

url: 新窗口的 URL

名称：（可选）默认为 _blank

规格：（可选）Google JavaScript window.open 获取完整列表

替换：（可选）[true|false] 替换历史记录或追加

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-27T19:56:06.857

```
window.open(URL,name,specs,replace) 
```

[在这里](http://www.w3schools.com/jsref/met_win_open.asp)查看这个的详细用法。

# objective-c - Three20：使用 TTStyles 位于 TTButton 中文本上方的图像

> ID：11694759
> 
> 赞同：0
> 
> 时间：2012-07-27T19:50:06.723
> 
> 标签：objective-c, uibutton, three20

我正在尝试将 TTButton 设置为如下所示：

[http://tinypic.com/r/29c3oyh/6](http://tinypic.com/r/29c3oyh/6)

您会注意到图像和文本都在 TTButton 内居中对齐，并且图像位于文本上方。无论 TTBoxStyle 和排序如何组合，我似乎都无法同时正确对齐图像和文本。

```
- (TTStyle*)happyfaceIcon:(UIControlState)state {
return [TTImageStyle styleWithImageURL:nil defaultImage:nil contentMode:UIViewContentModeCenter size:CGSizeMake(40, 40) next:
        [TTBoxStyle styleWithMargin:UIEdgeInsetsMake(0, 20, 0, 0) next:nil]];
}

- (TTStyle*)happyfaceButton:(UIControlState)state {
return [TTShapeStyle styleWithShape:[TTRectangleShape shape] next:
        [TTSolidBorderStyle styleWithColor:[UIColor blackColor] width:1 next:
         [TTSolidFillStyle styleWithColor:[UIColor grayColor] next:
          [TTBoxStyle styleWithMargin:UIEdgeInsetsMake(45, 2, 5, 2) next:
           [TTTextStyle styleWithFont:[UIFont boldSystemFontOfSize:10]
                                color:[UIColor blackColor] textAlignment:UITextAlignmentCenter next:
            [TTPartStyle styleWithName:@"image" style:TTSTYLESTATE(happyfaceIcon:, state) next: nil
             ]]]]]];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T15:38:51.803

好吧，这似乎很简单。我只需要查看 TTLauncherButton 即可看到答案。

基本上 TTButton 属性 isVertical = YES 清除了所有问题。

如果有人感兴趣，这也是我的最终风格

```
- (TTStyle*)shortcutIcon:(UIControlState)state {
TTStyle* style =
[TTBoxStyle styleWithMargin:UIEdgeInsetsMake(-7, 0, 11, 0) next:
  [TTImageStyle styleWithImageURL:nil defaultImage:nil contentMode:UIViewContentModeCenter
                             size:CGSizeZero next:nil]];

if (state == UIControlStateHighlighted || state == UIControlStateSelected) {
    [style addStyle:
     [TTBlendStyle styleWithBlend:kCGBlendModeSourceAtop next:
      [TTSolidFillStyle styleWithColor:RGBACOLOR(0,0,0,0.5) next:nil]]];
}

return style;
}

- (TTStyle*)shortcutButton:(UIControlState)state {
return
[TTPartStyle styleWithName:@"image" style:TTSTYLESTATE(shortcutIcon:, state) next:
 [TTTextStyle styleWithFont:[UIFont fontWithName:@"Frutiger-Light" size:15] color:TTSTYLEVAR(shortcutTextColor)
            minimumFontSize:11 shadowColor:nil
               shadowOffset:CGSizeZero next:nil]];
} 
```

# mysql - 只选择并显示 MySQL 中的重复记录

> ID：11694761
> 
> 赞同：36
> 
> 时间：2012-07-27T19:50:13.447
> 
> 标签：mysql, duplicates

这个问题很简单，我由于某种原因无法得到正确的结果来只显示重复的记录

```
Table   : Paypal_ipn_orders
id                              payer_email
1                               susan@gmail.com
2                               ryan@gmail.com   
3                               susan@gmail.com
4                               steve@gmail.com
5                               steve@gmail.com

SELECT id, COUNT( payer_email ) `tot`
FROM paypal_ipn_orders
GROUP BY payer_email
HAVING `tot` >1 
```

样本输出

```
id       tot
1         2
4         2 
```

预期产出

```
id       payer_email 
1        susan@gmail.com
3        susan@gmail.com
4        steve@gmail.com
5        steve@gmail.com 
```

我该如何做到这一点？

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2012-07-27T19:56:04.330

```
SELECT id, payer_email
FROM paypal_ipn_orders
WHERE payer_email IN (
    SELECT payer_email
    FROM paypal_ipn_orders
    GROUP BY payer_email
    HAVING COUNT(id) > 1
) 
```

[sqlfiddle](http://sqlfiddle.com/#!2/6d708/2)

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2014-01-28T14:23:04.247

在我的`IN`情况下太慢了（180秒）

所以我改用了`JOIN`（0.3秒）

```
SELECT i.id, i.payer_email
FROM paypal_ipn_orders i
INNER JOIN (
 SELECT payer_email
    FROM paypal_ipn_orders 
    GROUP BY payer_email
    HAVING COUNT( id ) > 1
) j ON i.payer_email=j.payer_email 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2015-12-17T10:38:33.210

这是一个简单的例子：

```
select <duplicate_column_name> from <table_name> group by <duplicate_column_name> having count(*)>=2 
```

它肯定会起作用。:)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-03-03T09:36:03.960

从表中获取所有重复行的列表：

```
Select * from TABLE1 where PRIMARY_KEY_COLUMN NOT IN ( SELECT PRIMARY_KEY_COLUMN
FROM TABLE1 
GROUP BY DUP_COLUMN_NAME having (count(*) >= 1)) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-03-28T10:05:09.110

嗨，如果我想为两个行数据选择一个或多个不同或可能相同的列值，上述答案将不起作用

对于前。我也想选择用户名，出生日期。但是在数据库中，用户名不重复但出生日期将重复，则此解决方案将不起作用。

为此使用此解决方案需要在同一张表上进行自我加入/

```
SELECT  
    distinct(p1.id),  p1.payer_email , p1.username, p1.birth_date

FROM 
    paypal_ipn_orders AS p1 

INNER JOIN paypal_ipn_orders AS p2 

ON p1.payer_email=p2.payer_email

WHERE 

p1.birth_date=p2.birth_date 
```

上面的查询将返回所有具有相同 email_id 和相同出生日期的记录

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-04-27T11:46:37.700

使用此代码

```
 SELECT *  
    FROM  paypal_ipn_orders 
    GROUP BY  payer_email  
    HAVING COUNT( payer_email) >1 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-09-11T17:22:58.207

This works the fastest for me

```
SELECT
    primary_key
FROM
    table_name
WHERE
    primary_key NOT IN (
        SELECT
            primary_key
        FROM
            table_name
        GROUP BY
            column_name
        HAVING
            COUNT(*) = 1
    ); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-07-27T19:58:09.150

```
SELECT id, payer_email FROM paypal_ipn_orders
WHERE payer_email IN (
    SELECT payer_email FROM papypal_ipn_orders GROUP BY payer_email HAVING COUNT(*) > 1) 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-04-27T14:49:13.320

```
SELECT * FROM `table` t1 join `table` t2 WHERE (t1.name=t2.name) && (t1.id!=t2.id) 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-01-11T17:42:35.210

与[此答案](https://stackoverflow.com/a/21408164/4152012)类似，尽管我使用了临时表：

```
CREATE TEMPORARY TABLE duplicates (
    SELECT payer_email
    FROM paypal_ipn_orders
    GROUP BY payer_email
    HAVING COUNT(id) > 1
);
SELECT id, payer_email
FROM paypal_ipn_orders AS p
INNER JOIN duplicates AS d ON d.payer_email=p.payer_email; 
```

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2015-06-07T21:04:13.703

我认为这种方式更简单。输出显示 id 和付款人的电子邮件，其中付款人的电子邮件在此表的多个记录中。结果按 id 排序。

```
 SELECT id, payer_email
    FROM paypal_ipn_orders
    WHERE COUNT( payer_email )>1
    SORT BY id; 
```

* * *

## 回答 #12

> 赞同：-2
> 
> 时间：2012-07-27T19:53:02.877

试试这个查询：

```
SELECT id, COUNT( payer_email ) `tot`
FROM paypal_ipn_orders
GROUP BY id
HAVING `tot` >1 
```

它有帮助吗？

# android - Android Chrome 忽略 -webkit-text-size-adjust:none 属性。缩小时正在缩放文本

> ID：11694767
> 
> 赞同：7
> 
> 时间：2012-07-27T19:50:51.513
> 
> 标签：android, css, google-chrome

我们的客户请求了一个网站，但不想为移动版本付费。我们仍在使其在移动设备上运行。当一直缩小时，Android (4.0) 上的 Chrome 正在缩放一堆文本。我们尝试设置 -webkit-text-size-adjust:none 属性，但它似乎被忽略并且文本仍在按比例放大。

在 iOS 上运行良好。

有什么建议么？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-02-28T14:10:03.930

刚刚发现了一个解决方法。将文本的父元素的最大高度设置为比它出现的要大得多。例如，

```
<p class="intro">
  This is some text that is appearing blown up 
  and ridiculous on Chrome Mobile.
</p>

p.intro {
  max-height: 5000em;
} 
```

您可以在任何父元素上设置最大高度。它不一定是第一个父母。例如，

```
<footer class="primary">
  <p class="intro">
    This is some text that is appearing blown up 
    and ridiculous on Chrome Mobile.
  </p>
</footer>

footer.primary {
  max-height: 5000em;
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-07-29T23:13:46.680

请注意，`-webkit-text-size-adjust`您提到的属性是非标准的。[在此处](https://developer.mozilla.org/en/CSS/text-size-adjust)阅读更多相关信息。

目前，Android 版 Chrome 使用[字体增强](https://bugs.webkit.org/show_bug.cgi?id=FontBoosting)来缩放文本，并且无法禁用它。

如果您想要一种禁用字体增强的方法，请提供您的用例并通过[new.mcrbug.com](http://new.mcrbug.com)记录问题。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-09-02T08:20:13.787

`<meta name="viewport" content="width=device-width, maximum-scale=1.0, user-scalable=yes">`在`<head>`标签中可以禁用缩放

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-11-07T00:48:10.963

我在 Android 上使用 Firefox 时遇到了同样的问题。

我的解决方案是**添加样式“float：left;” 到包含问题文本的 div。**

您可能需要将 div 的宽度设置为与父级相同（以像素为单位或 100%），以确保它不会影响其余 div。

请参阅[如何防止移动浏览器调整文本大小](https://stackoverflow.com/questions/19802777/how-to-prevent-mobile-browser-from-resizing-text)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-09-20T17:21:23.700

`-webkit-text-size-adjust:none`太可怕了！

我的眼睛网站很差，而且我的页面经常以 200% 的默认缩放比例显示。使用`-webkit-text-size-adjust:none`，我无法阅读任何内容，我**唯一**的选择是使用 Firefox。这是我这些天浏览时的头号问题。

太多的网站使用它，尤其是网页上嵌入的 Facebook 评论。您应该停止使用它并创建一个可以使用任何大小字体的界面。

# drupal - 仅打印 drupal field_view_field 值

> ID：11694770
> 
> 赞同：11
> 
> 时间：2012-07-27T19:51:04.283
> 
> 标签：drupal, printing, field, render

我正在使用下面的代码将节点字段打印到特定区域，效果很好。但是有一个例子，我只想打印没有标签的字段值。似乎应该很容易，但我遇到了一些麻烦。我很感激任何帮助，因为我对 drupal 还很陌生。谢谢

```
<?php 
  print drupal_render(field_view_field('node', $node, 'field_description')); ?> 
```

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-07-27T21:09:25.893

`field_view_value()`接受一个`$display`可用于隐藏标签的参数：

```
$display = array('label' => 'hidden');
$view = field_view_field('node', $node, 'field_description', $display);
print drupal_render($view); 
```

如果您只想提取字段的原始值，则可以使用[`field_get_items()`](http://api.drupal.org/api/drupal/modules!field!field.module/function/field_get_items/7)：

```
$items = field_get_items('node', $node, 'field_description');
$first_item = array_shift($items);
$description = $first_item['value']; 
```

列名 ( `$first_item['whatever']`) 将取决于您使用的字段类型。对于文本字段，它将是`value`. 请记住在`check_plain()`输出之前对输入进行清理，因为 Drupal 的惯例是存储原始输入数据并在输出时对其进行清理。

# android - 如何在android中解决SaxParserException

> ID：11694772
> 
> 赞同：1
> 
> 时间：2012-07-27T19:51:21.963
> 
> 标签：android, android-mapview

我正在使用以下代码，但得到 saxparserexception。如何解决它。当我使用以下代码时，它会给出以下异常。

org.xml.sax.SAXParseException：未终止的实体引用（java.io.InputStreamReader@406cdeb0 中的位置：ENTITY_REF &@1:799）

如何解决它请有人帮助我。

```
*public class MapViewActivity extends MapActivity
{
MapView mapView;
@Override
protected void onCreate(Bundle savedInsatnceState)
{

    super.onCreate(savedInsatnceState);
    setContentView(R.layout.map);

    mapView = (MapView) findViewById(R.id.myMapView1);
    //mapView.setBuiltInZoomControls(true);
    double src_lat = 18.556019;
    double src_long = 73.822283;
    double dest_lat = 18.500487;
    double dest_long = 73.866900;
    GeoPoint srcGeoPoint = new GeoPoint((int) (src_lat * 1E6),
        (int) (src_long * 1E6));
    GeoPoint destGeoPoint = new GeoPoint((int) (dest_lat * 1E6),
            (int) (dest_long * 1E6));
    DrawPath(srcGeoPoint, destGeoPoint, Color.GREEN, mapView);
    mapView.getController().animateTo(srcGeoPoint);
    mapView.getController().setZoom(15);
}
protected boolean isRouteDisplayed() 
{

    return false;
}
private void DrawPath(GeoPoint src, GeoPoint dest, int color,
        MapView mMapView01) {
     System.out.println("in drawPath");
    // connect to map web service
    StringBuilder urlString = new StringBuilder();
    urlString.append("http://maps.google.com/maps?f=d&hl=en");
    urlString.append("&saddr=");// from
    urlString.append(Double.toString((double) src.getLatitudeE6() / 1.0E6));
    urlString.append(",");
    urlString
            .append(Double.toString((double) src.getLongitudeE6() / 1.0E6));
    urlString.append("&daddr=");// to
    urlString
            .append(Double.toString((double) dest.getLatitudeE6() / 1.0E6));
    urlString.append(",");
    urlString.append(Double
            .toString((double) dest.getLongitudeE6() / 1.0E6));
    urlString.append("&ie=UTF8&0&om=0&output=kml");
    Log.d("xxx", "URL=" + urlString.toString());
    // get the kml (XML) doc. And parse it to get the coordinates(direction
    // route).
    Document doc = null;
    HttpURLConnection urlConnection = null;
    URL url = null;
    try {
        url = new URL(urlString.toString());
        urlConnection = (HttpURLConnection) url.openConnection();
        urlConnection.setRequestMethod("GET");
        urlConnection.setDoOutput(true);
        urlConnection.setDoInput(true);
        urlConnection.connect();

        DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();
        DocumentBuilder db = dbf.newDocumentBuilder();
        doc = db.parse(urlConnection.getInputStream());

        if (doc.getElementsByTagName("GeometryCollection").getLength() > 0) {
            // String path =
            // doc.getElementsByTagName("GeometryCollection").item(0).getFirstChild().getFirstChild().getNodeName();
            String path = doc.getElementsByTagName("GeometryCollection")
                    .item(0).getFirstChild().getFirstChild()
                    .getFirstChild().getNodeValue();
            Log.d("xxx", "path=" + path);
            String[] pairs = path.split(" ");
            String[] lngLat = pairs[0].split(","); // lngLat[0]=longitude
                                                    // lngLat[1]=latitude
                                                    // lngLat[2]=height
            // src
            GeoPoint startGP = new GeoPoint((int) (Double
                    .parseDouble(lngLat[1]) * 1E6), (int) (Double
                    .parseDouble(lngLat[0]) * 1E6));
            mMapView01.getOverlays()
                    .add(new MyOverlay(startGP, startGP, 1));
            GeoPoint gp1;
            GeoPoint gp2 = startGP;
            for (int i = 1; i < pairs.length; i++) // the last one would be
                                                    // crash
            {
                System.out.println("in while");
                lngLat = pairs[i].split(",");
                gp1 = gp2;
                // watch out! For GeoPoint, first:latitude, second:longitude
                gp2 = new GeoPoint(
                        (int) (Double.parseDouble(lngLat[1]) * 1E6),
                        (int) (Double.parseDouble(lngLat[0]) * 1E6));
                mMapView01.getOverlays().add(
                        new MyOverlay(gp1, gp2, 2, color));
                Log.d("xxx", "pair:" + pairs[i]);
            }
            mMapView01.getOverlays().add(new MyOverlay(dest, dest, 3)); // use
                                                                        // the
                                                                        // default
                                                                        // color
        }
    } catch (MalformedURLException e)
    {
        e.printStackTrace();
    } catch (IOException e) 
    {
        e.printStackTrace();
    } catch (ParserConfigurationException e) {
        e.printStackTrace();
    } catch (SAXException e) {
        e.printStackTrace();
    }
} 
```

}*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-28T06:30:41.410

您需要传递 url 而不是 urlConnection 然后在其上使用 openStream：

```
doc = db.parse(url.openStream()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T08:51:44.030

问题可能与删除旧的 kml 数据以从 Google 检索地图信息有关。

[为什么使用 KML 数据检索适用于 Android 的 Google 路线不再有效？](https://stackoverflow.com/questions/11745314/why-retrieving-google-directions-for-android-using-kml-data-is-not-working-anymo)

# jquery - jQuery计算输入的总数

> ID：11694785
> 
> 赞同：0
> 
> 时间：2012-07-27T19:52:10.557
> 
> 标签：jquery, forms

我有一些代码可以连续计算输入的总数，然后在最后添加到总计，这是当前工作的代码如下：

```
$(":text[name='qty[]'],:text[name='rate[]']").keyup(function()
{
    var totalamount = 0.00;
    $("ul.rowData").each(function()
    {
        var quantity = +$(this).find(":text[name='qty[]']").val() || 0;
        var rate = +$(this).find(":text[name='rate[]']").val() || 0;
        var subtotal = quantity * rate;
        $(this).find(":text[name='price[]']").val(subtotal.toFixed(2));
        totalamount += subtotal;
    });
    $("#totalprice").val(totalamount.toFixed(2));
}); 
```

现在我有一个添加行按钮，它添加一行字段：

```
$('.mainForm').find('.addItem').click(function()
{
    $('.invoiceItems').append('<ul class="rowData">' +
    '<li class="txtLg"><span class="sep">Item:</span><input type="text" name="item[]" maxlength="255" value=""></li>' +
    '<li class="txtLg"><span class="sep">Description:</span><input type="text" name="description[]" maxlength="255" value=""></li>' +
    '<li class="txtSm"><span class="sep">Rate:</span><input type="text" name="rate[]" maxlength="10" value="0.00"></li>' +
    '<li class="txtSm"><span class="sep">Qty:</span><input type="text" name="qty[]" maxlength="5" value="1"></li>' +
    '<li class="txtSm"><span class="sep">Price:</span><input type="text" name="price[]" maxlength="10" value="0.00"><input type="hidden" name="itemid[]" value="0"></li>' +
    '</ul>').fadeIn(500);
    return false;
}); 
```

我的问题是，一旦我单击添加行，当您向字段中添加数字时，字段中的总数不会自动计算。任何想法为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T19:55:59.650

他们不会被重新计算，因为没有代码可以做到这一点:)

您基本上是在计算总数，并将其添加到页面中。您需要一些额外的代码，以便在修改原件时重新计算这些总数。您可能会重新使用一些现有的代码顺便说一句。

看看`.keyup()`和`.change()`jQuery 事件。前者将在每次释放键时触发，而后者仅在输入失去焦点时触发。您可能希望使用两者之一来更新总计字段；

```
$('.sep').on('change', function(e) {
  // stuff
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T19:58:35.247

您的绑定`$().keyup(function(){}}`不适用于动态添加到页面元素

```
$(":text[name='qty[]'],:text[name='rate[]']").live('keyup',function(){
   ...
} 
```

# java - 如何检查当前平台以及是否在 python 中安装了 java？

> ID：11694789
> 
> 赞同：1
> 
> 时间：2012-07-27T19:52:21.230
> 
> 标签：java, python

对于我正在制作的脚本，我需要一种跨平台的方式来检查：

1.  如果安装了java。
2.  脚本在什么平台上运行（例如 windows/amd64 或 linux/x86）

在蟒蛇。我怎么能做到这两点。

编辑：平台模块非常适合数字 2，但最好是查看是否安装了 java 而不是版本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T19:55:07.263

1.  是[如何通过python确定系统上是否安装了java的副本？](https://stackoverflow.com/questions/1332598/how-to-determine-whether-java-is-installed-on-a-system-through-python) 我同意第二个答案，特别是你不应该检查。你应该记录你对它的依赖，让你的包管理器在任何系统上安装它，在 Windows 上让你的用户自己安装它。

2.  [平台](http://docs.python.org/library/platform.html)模块。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-06-11T14:56:19.030

检查是否安装了java，你可以使用

```
def run_command(command):
    p = subprocess.Popen(command,
    stdout = subprocess.PIPE,
    stderr = subprocess.STDOUT)
    return iter(p.stdout.readline, b'')
out = list(run_command("java -version")) 
```

来自 vartec 在[运行 shell 命令并捕获输出](https://stackoverflow.com/questions/4760215/running-shell-command-and-capturing-the-output)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-27T19:56:22.030

我建议简单地尝试运行 java -version。正确安装 java 会将其添加到 Linux 和 Windows 上的路径中（因此可以从文件系统上的“任何位置”执行 java 命令行）。

例如 - 这是我运行时的结果

```
 java -version
java version "1.7.0_05"
Java(TM) SE Runtime Environment (build 1.7.0_05-b06)
Java HotSpot(TM) 64-Bit Server VM (build 23.1-b03, mixed mode) 
```

# jquery - jQuery：“DOMSubtreeModified”是处理动态添加元素（移动设备）的最佳方式吗？

> ID：11694795
> 
> 赞同：0
> 
> 时间：2012-07-27T19:52:57.907
> 
> 标签：jquery, dynamic, bind

我正在使用[http://detectmobilebrowsers.com/](http://detectmobilebrowsers.com/)来检测浏览器是否在移动设备上。如果为 true，则需要隐藏 facebook 分享按钮，因为它在移动设备上无法正常工作，而是使用 facebook 提要选项。

由于元素是动态添加的，我使用了以下内容：

```
if(jQuery.browser.mobile)
{
        $('#your-dialog-id').bind("DOMSubtreeModified", function() {
              $(this).find('.db-share').addClass('db-share-hide');
        });
} 
```

`#your-dialog-id`是一个 jQuery UI 模式。

**这可行**，但是：有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T08:22:42.190

iPhone 不喜欢 DOMSubtreeModified。最后，我使用了后端解决方案 code.google.com/p/php-mobile-detect

# node.js - 来自 Beanstalk 的 NPM 自定义 URL 模块

> ID：11694797
> 
> 赞同：0
> 
> 时间：2012-07-27T19:53:16.647
> 
> 标签：node.js, package, npm

我正在尝试将 package.json 文件中的依赖项设置为远程 beanstalk 存储库，以将其包含在项目中。

目前它的设置如下：

```
{
  "name": "SOME_NAME",
  "version": "0.0.1",
  "private": true,
  "dependencies": {
    "SOME_MODULE_NAME" : "git@xxx.beanstalkapp.com:/xxx.git#v0.0.1"
  }
} 
```

但是，这会返回以下 npm 错误：

```
npm WARN package.json SOME_NAME@0.0.1 No README.md file found!
npm http GET https://registry.npmjs.org/SOME_MODULE_NAME
npm http 404 https://registry.npmjs.org/SOME_MODULE_NAME
npm ERR! 404 'SOME_MODULE_NAME' is not in the npm registry.
npm ERR! 404 You should bug the author to publish it
npm ERR! 404 
npm ERR! 404 Note that you can also install from a
npm ERR! 404 tarball, folder, or http url, or git url. 
```

它似乎绕过了 beanstalk url 并回退到在全局 repo 中查找模块。有什么想法/建议吗？

我也尝试过使用 git+ssh:// 样式的 url 无济于事。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T23:12:52.480

**请参阅“[作为依赖项的 Git URL](https://docs.npmjs.com/files/package.json#git-urls-as-dependencies) ”**：

> Git url 可以是以下形式：
> 
> ```
> git://github.com/user/project.git#commit-ish
> git+ssh://user@hostname:project.git#commit-ish
> git+ssh://user@hostname/project.git#commit-ish
> git+http://user@hostname/project/blah.git#commit-ish
> git+https://user@hostname/project/blah.git#commit-ish 
> ```
> 
> commit-ish 可以是任何可以作为参数提供给 git checkout 的标记、sha 或分支。默认是主。

你的网址应该是：

```
"git://xxx.beanstalkapp.com/xxx.git#v0.0.1" 
```

# javascript - jQuery replaceWith() 后 JavaScript 断开连接

> ID：11694801
> 
> 赞同：0
> 
> 时间：2012-07-27T19:53:26.667
> 
> 标签：javascript, jquery, asp.net-mvc, twitter-bootstrap

在我当前创建的应用程序中，我对服务器进行了几次 AJAX 调用，并用部分视图替换了部分页面。`replaceWith()`除了使用 jQuery函数“替换”的按钮之外，一切似乎都正常工作。

在我的实际代码中，我不仅要替换一个按钮，而且要替换整个按钮，但[此处找到](http://jsfiddle.net/D2RLR/895/)`<div>`的代码将有助于说明我的问题。

单击按钮时，将调用 JavaScript，从而更新该按钮。但是，尝试再次单击该按钮，将不会调用或执行相同的 JavaScript。这里有一些我错过的断开连接。（在我看来，每次单击带有“updateButton”类的按钮时，都应该执行javascript。）请帮帮我。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T19:55:10.473

事件委托。

```
$(document).on('click','.updateButton',function (e) {
            e.preventDefault();
    var now = new Date().getTime();

   var newButton = "<span class='btn btn-info updateButton'>Update Button " + now + "</span>"

    $(this).replaceWith(newButton);
}); 
```

演示：http: [//jsfiddle.net/D2RLR/896/](http://jsfiddle.net/D2RLR/896/)

与其将事件绑定到将被删除的按钮（从而失去事件绑定），不如将其绑定到一个不会被删除但是该按钮的祖先的元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T20:00:36.617

无需在文档上绑定事件处理程序（如 Kevin B 的回答），只需将其重新绑定到您创建的新按钮以替换旧按钮。这是一种更有效的事件处理方法，因为事件不需要在事件触发之前从 DOM 树一直冒泡到文档。

[http://jsfiddle.net/D2RLR/900/](http://jsfiddle.net/D2RLR/900/)

```
var replaceBtn = function(domBtn,e) {
   e.preventDefault();
   var now = new Date().getTime();

   var newButton = $("<span class='btn btn-info updateButton'>Update Button " + now + "</span>");
    newButton.on('click',function(event) {
        replaceBtn(this,event);
    });

    $(domBtn).replaceWith(newButton);

}

$('.updateButton').click(function(event) {
     replaceBtn(this,event)
}); 
```

# python - Django：审核模型并记录管理员使用情况

> ID：11694804
> 
> 赞同：1
> 
> 时间：2012-07-27T19:53:42.180
> 
> 标签：python, django, django-admin

我正在尝试找到在我的 Django 项目中审核某些模型的最佳方法。提供一些上下文：该网站有帐户、项目和用户。其中任何一个都可以标记为活动或非活动。当项目的活动状态发生变化时，我想记录更改它的工作人员的日期和用户名。

我已经研究了解决这个审计问题的几种方法，但我希望 StackOverflow 社区可以为我指出一些更好的解决方案。Django 内置的管理界面历史有一个很好的格式，但还不够详细。它只告诉我一个项目已更改，但不告诉我它设置为什么状态：

![在此处输入图像描述](../Images/2dd7a1262cedaf52932b5a5dc407aef4.png)

如果我可以更改 Action 消息并仅记录某些字段的操作（而排除其他字段），我会喜欢使用 Django 的内置历史记录。

我下一次解决这个审计问题的尝试是研究插件。Django Reversion 似乎是最受欢迎的，但我不需要它的大部分功能，而且它确实面向版本控制而不是审计。我还发现了一个名为 AuditTrail 的插件，但它非常原始。

在尝试了这些可能性之后，我尝试推出自己的审计代码。我创建了一个新模型来记录活动。每次激活/停用帐户、项目或用户时都会写入一个条目。

```
class ActivityHistory(models.Model):
    """
    Stores the history of when accounts, projects, and users are active.
    This class uses generic relations in order to point to any model type.
    For more information see: https://docs.djangoproject.com/en/dev/ref/contrib/contenttypes/#generic-relations
    """
    content_type = models.ForeignKey(ContentType)
    object_id = models.PositiveIntegerField()
    content_object = generic.GenericForeignKey('content_type', 'object_id')
    active = models.BooleanField(help_text="The target state (true if the item was activated, false if it was deactivated).")
    date = models.DateTimeField(help_text="The time at which the active state was changed.")
    actor = models.ForeignKey(User, help_text="The staff member who changed the active state of the account, project, or user in question.")
    class Meta:
        ordering = ['-date'] 
```

问题是我必须使用信号记录信息。在信号处理程序中，我无权访问 HTTP`request`对象。那么如何记录哪个工作人员更改了有问题的项目呢？

这个问题还有其他更容易实施的解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T22:28:49.567

与其从头开始自己实施，我建议您查看现有解决方案是否可以满足您的需求或几乎可以满足您的需求。分叉它，根据您的需要扩展它，如果您感觉良好，请分享回来！

我在最近的项目中使用了[django-audit](https://github.com/KanbanSolutions/django-audit)，并且对它非常满意（有一些调整）。我现在尝试的另一个不错的选择是[django-audit-log](https://github.com/Atomidata/django-audit-log)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T20:35:55.333

您可以重新实现 Django 的 ModelAdmin constructor_change_message 方法并在其中添加您的功能，这样您就可以利用现有功能。

然而，这没有记录，所以它可能会在未来的 Django 版本中改变

[https://github.com/django/django/blob/master/django/contrib/admin/options.py#L665](https://github.com/django/django/blob/master/django/contrib/admin/options.py#L665)

# java - 在 Talend 中获取 NumberFormatException

> ID：11694813
> 
> 赞同：0
> 
> 时间：2012-07-27T19:54:20.763
> 
> 标签：java, jakarta-ee, talend

对于以下语句，我在 talend ETL 工具中收到 NumberFormatException：

```
Integer.parseInt("+2"); 
```

错误详情：

```
Exception in component tJavaRow_3
java.lang.NumberFormatException: For input string: "+2"
at java.lang.NumberFormatException.forInputString(NumberFormatException.java:48)
at java.lang.Integer.parseInt(Integer.java:449)
at java.lang.Integer.parseInt(Integer.java:499) 
```

这实际上是一个简单的代码，在我的测试 java 程序中运行没有任何问题。

```
public class Main { 
   public static void main(String[] args) { 
      String s = "+000000100"; 
      System.out.println(String.valueOf(new Integer(s))); 
   } 
} 
```

实际上是从位置文件中获取这个值，该值可以是 +0002 或 -0002 （一些以符号为前缀的有效数字）。有一件事是确定输入中不会有任何小数。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T19:56:47.430

`+2`不是一个有效的干扰。应该只是`2`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T19:59:14.390

只需`+`从数字的开头删除：

```
num = num.replaceAll("\\+", "");
// parse, etc. 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-27T20:08:09.227

在您的上下文中`+2`必须表示一个正数`2`。将字符串传递给进行解析的函数时要小心，因为因为它解析整数，所以某些表达式（例如`3.5`or `3,5`（十进制））不会像预期的那样产生结果。如果您可以控制该代码，则应在这些情况下使用 Double.parseDouble 或 Float.parseFloat。另一方面，负数 like`-2`将被解析而没有任何问题。

**编辑：**如果您使用的是位置文件，只需通过使用正则表达式或获取子字符串从字符串的开头删除 +。您还可以使用`startsWith("+")`来检查字符串是否以 + 开头。

# jquery-mobile - 在 jquery mobile 中设置自定义按钮类的样式

> ID：11694815
> 
> 赞同：0
> 
> 时间：2012-07-27T19:54:24.900
> 
> 标签：jquery-mobile

我在 jquery mobile 中有一系列按钮，它们需要有自己的外观和感觉。我给了他们一个自定义类（例如，“custom_btn”）。它们位于特定页面的页脚中。我可以使用更改文本大小

```
#thisPage .ui-footer .ui-btn-text {
    font-size: 36px;
} 
```

问题是我不希望这影响页脚中的所有按钮，而只影响具有 .custom_btn 类的按钮。我尝试了以下方法，但均无济于事：

```
.ui-footer .custom_btn.ui-btn-text
.ui-footer .custom_btn .ui-btn-text
.ui-footer .ui-btn-text .custom_btn
.ui-footer .ui-btn-text.custom_btn
.ui-footer .custom_btn.ui-btn-inner .ui-btn-text
.ui-footer .custom_btn .ui-btn-inner .ui-btn-text
.ui-footer .custom_btn-button .ui-btn-text
.ui-footer button.custom_btn .ui-btn-text
.ui-footer button .custom_btn .ui-btn-text 
```

在查看网络检查器时，该类似乎处于按钮级别，因此应该是 .ui-btn-text 的祖先和 .ui-btn 的子级。但是，每当我将 .custom_btn 类放在代码中时，样式都会中断。如何为这些按钮提供自定义样式？

编辑：这是我用来生成按钮的代码，标记为 1-9（忽略按钮标签前面的额外空格。它可以让标签出现在这篇文章中）。

```
 < button data-role="button" class="construct_answer" data-inline="true" value=1>1</button>;
    < button data-role="button" class="construct_answer" data-inline="true" value=2>2</button>;
    < button data-role="button" class="construct_answer" data-inline="true" value=3>3</button>;
    < button data-role="button" class="construct_answer" data-inline="true" value=4>4</button>;
    < button data-role="button" class="construct_answer" data-inline="true" value=5>5</button>;
    < button data-role="button" class="construct_answer" data-inline="true" value=6>6</button>; 
```

在一个外部 .js 文件中，我有这个代码

```
$(document).bind('pagecreate',function(e){
    if (e.target.id == 'assessment') {
        $('.consruct_answer').prev().css({'font-size':'30px'});
    }
} 
```

奇怪的是，当我将此代码包含在“内容”部分中时，我可以使用 Phil 提供的解决方案来设置按钮的样式，而不会出现问题。但是，当页脚中有相同的代码时，我无法让它工作。任何线索为什么会这样？

# python - 带有 unicode 键的字典

> ID：11694821
> 
> 赞同：11
> 
> 时间：2012-07-27T19:55:01.367
> 
> 标签：python, unicode

在 Python 中是否可以使用 Unicode 字符作为字典的键？我有用作键的 Unicode 西里尔字母。尝试通过键获取值时，我得到以下回溯：

```
 Traceback (most recent call last):
 File "baseCreator.py", line 66, in <module>
    createStoresTable()
 File "baseCreator.py", line 54, in createStoresTable
    region_id = regions[region]
 KeyError: u'\u041c\u0438\u043d\u0441\u043a/\u041c\u043e\u0441\u043a\u043e\u0432\u0441\u043a\u0438\u0439\xa0' 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-27T19:56:18.217

是的，这是可能的。您收到的错误意味着您使用的密钥在您的字典中不存在。

要调试，请尝试`print`使用您的字典；你会看到每个键的 repr 应该显示实际键的样子。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-12-30T11:04:02.057

Python 2.x 在比较两个键以测试一个键是否已经存在、访问一个值或覆盖一个值时，会将两个键都转换为字节串。一个键可以存储为 Unicode，但如果两个不同的 Unicode 字符串简化为相同的字节串，则它们不能同时用作键。

```
In []: d = {'a': 1, u'a': 2}
In []: d
Out[]: {'a': 2} 
```

在某种意义上，您可以使用 Unicode 键。

Unicode 键保留在 Unicode 中：

```
In []: d2 = {u'a': 1}
In []: d2
Out[]: {u'a': 1} 
```

您可以使用任何“等于”现有键的Unicode 字符串*或字节字符串访问该值：*

```
In []: d2[u'a']
Out[]: 1

In []: d2['a']
Out[]: 1 
```

使用密钥或“等于”密钥的任何内容写入新值将成功并保留现有密钥：

```
In []: d2['a'] = 5
In []: d2
Out[]: {u'a': 5} 
```

因为与`'a'`现有键相比`True`，与现有 Unicode 键对应的值被替换为`5`。在我给出的第一个示例`u'a'`中，文本中提供的第二个键 for`d`与之前分配的键进行了真实比较，因此字节串`'a'`被保留为键，但值被`2`.

# javascript - JavaScript：在 XMLSerializer 错误解析实体后，用 html 160 实体替换三个空格

> ID：11694826
> 
> 赞同：0
> 
> 时间：2012-07-27T19:55:40.657
> 
> 标签：javascript, regex, replace

我正在尝试做这样的事情......

```
f = f.replace('   ',' &#160; ','gi'); 
```

这个我也试过...

```
f = f.replace(/\ {3,}/g,' &#160; ','gi'); 
```

如何用上面的实体替换三个空格？

使用`\s`不起作用，我在 Stack 上经历了很多其他问答，但没有任何效果。

为了澄清，这个问题源于`XMLSerializer()`除了序列化之外的解析，并且空格位于每个句子的开头。我使用它来使代码在编辑时易于阅读。

XHTML 编辑器中的示例占位符文本（只是一个文本区域）...

```
 <p>1
 &#160; 2
 &#160; 3
 &#160; 4
 &#160; 5</p> 
```

...目标是序列化此代码并保留实体（序列化不应解析，但所有浏览器都会解析）或通过替换后效来“反解析”。

此外，变量 f 是一个字符串，而不是示例中的对象或片段。

**重要的！**

使用 encodeURI 后发现这些不是由`XMLSerializer()`, 生成的空格（添加空格以使其更具可读性）`%0A` `%20` `%C2` `%A0` `%C2` `%A0`。

* * *

以下是使用 encodeURI 确定字符是什么之前和之后文本的几个示例，因为它们不匹配空格，从而使试图提供帮助的人望而却步……

```
%0A%20&#160;&#160;First%20and

&#160;&#160;First and 
```

第一个插入了两个实体，不可取，我只需要一个。

```
&#160; Which is actually

%0A%20&#160;%20Which%20is%20actually 
```

使用@Bergi 的以下内容，第二个输出效果很好......

```
f = f.replace(/\u00a0/g, '&#160;') 
```

* * *

以下是不成功的尝试，最后一个是成功的尝试...

```
//f = f.replace(/^\s+|\s+$/g,'');
//f = f.replace('   ',' &#160; ','gi');
//f = f.replace( / {3,}/g, '&#160;' );
//f = f.replace(/ {3,}/g,' \u00a0 ');
//f = f.replace(/\ {3,}/g,' &#160; ');
f = f.replace(/ \u00a0/g, ' &#160;'); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T19:57:44.297

```
var f = "Hello      World";
f = f.replace( / {3,}/g, '&#160;' );
console.log(f);
// "Hello&#160;World" 
```

听起来你的问题与字符串替换无关，而是你如何使用它来修改你的 HTML。你在做什么？

**编辑**：如果您希望用户在浏览器中实际*看到* `&#160;`，那么您需要：

```
f = f.replace( /\s+{3,}/g, '&amp;#160;' ); 
```

## 演示：http: [//jsfiddle.net/wrMMy/](http://jsfiddle.net/wrMMy/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T20:00:49.180

```
f = f.replace(/\ {3,}/g,' &#160; '); 
```

这样可行。 `replace`只需要两个参数。
演示：http: [//jsfiddle.net/SjydF/](http://jsfiddle.net/SjydF/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-27T20:04:19.357

不要替换为实体，而是替换为实际字符：

```
 f = f.replace(/ {3,}/g,' \u00a0 '); 
```

当然，这取决于该字符串的输出，但通常您应该按原样使用字符串。

顺便说一句：为了使 html/xml 空格可读，我建议使用 css 属性`white-space:pre-wrap`而不是插入不间断字符。他们尤其使复制文本成为一种恐惧。此外，如果您希望显示与源中一样多的空格，则应替换`/\s{2}/`为`" \u00a0"`.

* * *

好的，您有一个非常奇怪的输入：换行符 ( `10`, `%0A`, `"\n"`)、一个普通空格 ( `32`, `%20`, `" "`) 和两个不间断空格 ( `160`, `%C2%A0`, `"\u00a0"`)。您现在可以做什么来获得所需的输出：

*   将第一个 nbsp 替换为其实体，将第二个替换为空白：`replace(/\u00a0{2}/g, "&#160; ")`
*   仅替换两个相邻 nbsp 中的第一个：`replace(/\u00a0(.)/g, "&#160;$1")`
*   用两个空格和一个实体替换三个空格：`replace(/\s{3}/g, " &#160; ")`

# php - 无法在 mysql 中存储日期和时间戳值

> ID：11694827
> 
> 赞同：0
> 
> 时间：2012-07-27T19:55:50.927
> 
> 标签：php, mysql, date, timestamp

我在 mysql 表中有日期和时间戳字段。

```
$timeString="Thu Jul 26 22:45:09 +0000 2012";

$time=strtotime($timeString);

$date=date('Y-m-d', $timeString); 
```

当我执行查询时，它存储以下值：

日期 0000-00-00 时间 0000-00-00 00:00:00

谁能解决我的问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-27T19:59:31.817

您正在尝试从`$timestring`（字符串）而不是`$time`（时间戳）构建日期

尝试：

```
$timeString="Thu Jul 26 22:45:09 +0000 2012";

$time=strtotime($timeString);

$date=date('Y-m-d', $time); 
```

您应该在您的开发环境中启用 php 警告。日期会告诉你的:)

> date() 期望参数 2 很长，给定字符串

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T20:26:00.890

```
$date = new DateTime('Thu Jul 26 22:45:09 +0000 2012');
echo $date->format('Y-m-d H:i:s'); 
```

# c# - 从 GridViewRow ASP.NET 获取项目

> ID：11694835
> 
> 赞同：8
> 
> 时间：2012-07-27T19:56:06.977
> 
> 标签：c#, asp.net, gridview

我有一个 GridView，我从 SQL 数据库将一个 DataSource 绑定到它，网格中有一个带有复选框的列，因此我可以在其中“选择”一些项目（实际上是行）。我想要在这里对每个选定行中的项目进行一些更新，但是经过一些搜索后，我找不到如何访问行中的项目，虽然 DataItem 可以工作，但它给了我一个 Null。

**编辑：**简而言之，我有一个从数据源构建的 GridView，所以基本上，每一行代表一个对象，当我在其中一行中选中一个复选框时，我希望能够获取与那行，实现这一目标的最简单方法是什么？

Page_Load 上的数据绑定：

> ```
>  if (!Page.IsPostBack)
>     {
>         gvUnusedAccessories.DataSource = currentContext.Items.OfType<Accessory>().Where(ac => ac.Item_Parent_Id == ((PhoneLine)currentItem).Parent.Item_Id);
>         gvUnusedAccessories.AutoGenerateColumns = false;
>         gvUnusedAccessories.DataBind();
>     } 
> ```

当我按下更新按钮时的事件，它实际上浏览了行，如果该行有一个复选框，它将进行更新：

> ```
> protected void btnAddToMobile_Click(object sender, EventArgs e)
> {
>     foreach (GridViewRow row in gvUnusedAccessories.Rows)
>     {
>         if(((CheckBox)row.FindControl("chkSelect")).Checked)
>         {
>             ((Accessory)row.DataItem).PhoneLine_Id = currentItem.Item_Id;
>         }
>     }
> } 
> ```

这是我在 .aspx 中的 GridView ：

```
 <asp:GridView ID="gvUnusedAccessories" runat="server">
    <Columns>
        <asp:CommandField ShowSelectButton="True" />
        <asp:TemplateField HeaderText="Select">
            <ItemTemplate >
                <asp:CheckBox ID="chkSelect" runat="server" AutoPostBack="True"/>
            </ItemTemplate>
        </asp:TemplateField>
        <asp:BoundField DataField="Item_Id" HeaderText="ID" ReadOnly="True"/>
        <asp:BoundField DataField="Item_Name" HeaderText="Name" ReadOnly="True"/>  
        <asp:BoundField DataField="AccessoryModel" HeaderText="Modèle" ReadOnly="True"/>
        <asp:BoundField DataField="AccessoryBrand" HeaderText="Marque" ReadOnly="True"/>
    </Columns>
</asp:GridView> 
```

关于如何访问包含在行中的对象的任何提示？我知道我实际上可以获取 ID，然后向我的数据库发出 SQL 请求，但它似乎有点繁重，必须有更好的解决方案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-31T19:34:41.260

除非您在数据绑定完成后将数据源存储在 ViewState 或会话中，否则您将丢失数据源。除非您这样做，否则 DataItem 将始终为空。因此，我经常发现自己将数据源存储在视图状态中。当然，这意味着您的页面大小会变大。您所说的另一个选项是使用某种主键重新查询数据源。根据您的需要，我不能说哪个选项更好。我倾向于查看状态而不是第二次数据库调用，因为这可能是一个昂贵的调用

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-27T20:14:04.560

鉴于您已`AutoPostBack`设置为 true，您`asp:checkbox`必须在设置复选框时更新该行

所以我建议你`OnCheckedChanged="chkStatus_OnCheckedChanged"`在`asp:checkbox`调用时设置事件`chkSelect`，然后你只能更新选定的行，而不必遍历整个网格。

这是一个示例，您如何获取所选复选框的行项目

```
public void chkStatus_OnCheckedChanged(object sender, EventArgs e)
{
    CheckBox chkStatus = (CheckBox)sender;

    //now grab the row that you want to update
    GridViewRow row = (GridViewRow)chkStatus.NamingContainer;

    string cid = row.Cells[1].Text;
    bool status = chkStatus.Checked;

    //now you can do you sql update here
} 
```

# c# - 刷新列表框的数据源

> ID：11694836
> 
> 赞同：0
> 
> 时间：2012-07-27T19:56:08.480
> 
> 标签：c#, refresh, datasource

我的更新方法有一个表单，该表单是详细视图。在文本框旁边，我有一个列表框，其中显示了数据库表中所有名称的名称。在列表框下，我还有一个额外的文本框可以快速搜索名称，以防用户想要输入它。

当我去更新其中一个名称时，例如将 John 更改为 Jonathan，数据库会使用我在 sql server 上检查过的新名称进行更新，但列表框中的名称不会改变！通过将当前选择列表框的位置移动到 movefirst() 来解决此问题有一种肮脏的方法。但是，在列表框下，我有一个文本框，正如我所提到的，它是一个快速搜索，所以我在搜索文本框中输入 Jonathan，但什么也没有出现。但是，如果我输入以前的名字 John，那么我会在表中获得该行的详细信息。

有没有办法解决这个问题？

更新 1：

我尝试使列表框数据源为空，然后再次重新分配它，但它不起作用。我已经把我的更新表格的代码放在下面。

* * *

命名空间 WindowsFormsApplication1 { 公共部分类 updateContact ：表单 { 公共 updateContact() { InitializeComponent(); }

```
 private void updateContact_Load(object sender, EventArgs e)
    {
        // TODO: This line of code loads data into the 'tblcontactsupdate.tblContacts' table. You can move, or remove it, as needed.
        this.tblContactsTableAdapter.Fill(this.tblcontactsupdate.tblContacts);
    }
    private void btnUpdateContact_Click(object sender, EventArgs e)
    {
        int x;

        Program.da.UpdateCommand = new SqlCommand("Update tblContacts SET FIRSTNAME = @FIRSTNAME, LASTNME = @LASTNME WHERE ID = @ID", Program.cs);
        Program.da.UpdateCommand.Parameters.Add("@FIRSTNAME", SqlDbType.VarChar).Value = fIRSTNAMETextBox.Text;
        Program.da.UpdateCommand.Parameters.Add("@LASTNME", SqlDbType.VarChar).Value = lASTNMETextBox.Text;
        Program.da.UpdateCommand.Parameters.Add("@ID", SqlDbType.VarChar).Value = iDTextBox.Text;

        Program.cs.Open();
        x = Program.da.UpdateCommand.ExecuteNonQuery();
        Program.cs.Close();

        if (x >= 1)
        {
            MessageBox.Show("Record(s) has been updated");
            Program.ds.Clear();
            Program.da.Fill(Program.ds);
            txtfindUpdatecontact.Text = "";
            //lbupdateContact.DataSource = null;
            //lbupdateContact.DataSource = this.tblcontactsupdate.tblContacts;
        }       
    }
    private void txtfindUpdatecontact_TextChanged(object sender, EventArgs e)
    {
        if (!txtfindUpdatecontact.Text.Equals(""))
        {
            this.tblContactsBindingSource.Filter = "FIRSTNAME = '" + txtfindUpdatecontact.Text + "'";

        }
        else
        {
            this.tblContactsBindingSource.RemoveFilter();
        }
    }

    private void lbupdateContact_SelectedIndexChanged(object sender, EventArgs e)
    {

    }

    private void iDTextBox_TextChanged(object sender, EventArgs e)
    {

    }

    private void fIRSTNAMETextBox_TextChanged(object sender, EventArgs e)
    {

    }

    private void lASTNMETextBox_TextChanged(object sender, EventArgs e)
    {

    }
} 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T20:19:42.320

更新源后，您将`DataSource`不得不再设置一次列表框。

如下所示：这是我的数据：

```
 public class Person
    {
        public int Age { get; set; }
        public string Name { get; set; }
    }

    public class MyDataSource
    {
        public static List<Person> Persons = new List<Person>
        {
            new Person{Age=30,Name="Ram"},
            new Person{Age=33,Name="Rahim"},
        };
    } 
```

然后在表单的构造函数中，您可以执行以下操作：

```
 listBox1.DataSource = MyDataSource.Persons;
 listBox1.DisplayMember = "Age"; 
```

然后进行更新，如下所示：

```
private void button1_Click(object sender, EventArgs e)
        {
            MyDataSource.Persons[0].Age = 45;
            listBox1.DataSource = null;
            listBox1.DataSource = MyDataSource.Persons;
            listBox1.DisplayMember = "Age";
        } 
```

这只是根据您的需要更改代码的示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-09-16T17:02:06.743

如果您的 DataSource 是一个 DataTable，您所要做的就是调用 AcceptChanges()，如下所示：

```
listBox.DataSource = null;  
((DataTable)listBox.DataSource).AcceptChanges(); 
```

# php - PHP - 将 12 小时格式的 GMT 时间转换为具有延迟时间的新时区

> ID：11694841
> 
> 赞同：2
> 
> 时间：2012-07-27T19:56:28.570
> 
> 标签：php, time

我从 GPS 跟踪器收到 12 小时时间格式。
例如，GPS 时间：`8:25:40`在 GMT0（12 小时格式）中
发送的 GPS 时间延迟可能在 1~20 分钟的范围内

从 GPS 接收时间，时区 `00:2:15`延迟`2012-07-27 23:27:55``Europe/Moscow`

***PS**：以上数据，我的GPS时间的结果一定是`2012-07-27 23:25:40`*

***问题：***
如何在我的时区 (`Europe/Moscow`) 中指定 GPS 时间？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-27T20:09:38.390

```
$gps_time      = "9:43:52";
$time_received = "01:45:04 2012-07-28";

$utc    = new DateTimeZone("UTC");
$moscow = new DateTimeZone("Europe/Moscow");

//Instantiate both AM and PM versions of your time
$gps_time_am = new DateTime("$gps_time AM", $utc);
$gps_time_pm = new DateTime("$gps_time PM", $utc);

//Received time
$time_received = new DateTime($time_received, $moscow);

//Change timezone to Moscow
$gps_time_am->setTimezone($moscow);
$gps_time_pm->setTimezone($moscow);

//Check the difference in hours. If it's less than 1 hour difference, it's the correct one.
if ($time_received->diff($gps_time_pm)->h < 1) {
    echo $gps_time_pm->format("H:i:s Y-m-d");
}
else {
    echo $gps_time_am->format("H:i:s Y-m-d");
} 
```

确保指定接收时间的确切日期，以防止出现异常。

PS莫斯科在欧洲。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T20:14:27.283

```
<?php

function correct_time($time)
{
    $yesterday = false;
    $tomorrow = false;

    #offset = abs(date('h') - (int) $time);
    $offset = '3';

    $time_of_day = ($hour < 12)? 'AM': 'PM';

    if($hour < 0)
    {
        $yesterday = true;
        $time_of_day = 'PM';
    }
    if($hour > 12)
    {
        $tomorrow = true;
        $time_of_day = 'AM';       
    }

    $screwed_gps_time = $time . ' ' . $time_of_day;

    $gps_time = new DateTime($screwed_gps_time, new DateTimeZone("Europe/London"));
    if($yesterday)
    {
        $gps_time->sub(new DateInterval('P1D'));
    }
    if($tomorrow)
    {
        $gps_time->add(new DateInterval('P1D'));
    }
    $gps_time->setTimezone(new DateTimeZone("Europe/Moscow"));

    return $gps_time->format("Y-m-d H:i:s");    
}

echo correct_time('8:25:40'); # 2012-07-27 23:25:40
echo correct_time('1:25:40'); # 2012-07-28 04:25:40
echo correct_time('11:25:40'); # 2012-07-28 02:25:40 
```

案例太多，这里就不一一介绍了

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-27T20:28:02.820

我不记得我所有的 PHP 库，所以

伪代码算法：

```
AdjustTimeToGPS(gpsTime : 12HourTime, currentTime : DayAndTime, currentTimeZone : TimeZone) : DayAndTime
begin
    gmtCurrentTime : DayAndTime := ConvertToGmt(currentTime, currentTimeZone);
    gmtCurrent12HourTime : 12HourTime := 12HourFromDayAndTime(gmtCurrentTime);
    gpsHour : Hour := GetHourFrom12HourTime(gpsTime); // hour is 0 to 11;
    gmtCurrentHour : Hour := GetHourFrom12HourTime(gmtCurrent12Hour);
    day : Day := GetDayFromDayAndTime(gmtCurrentTime);
    isPm : Boolean = IsPM(gmtCurrentTime);

    if (gmtCurrentHour == 0 AND gpsHour == 11)
    begin    
        // we need to subtract 12 hours
        isPm := Not(isPm);

        if (isPM)
        begin
            // we looped. need to subtract a day
            day := day - 1;
        end
    end

    if (gmtCurrentHour == 11 AND gpsHour == 0)
    begin    
        // we need to add 12 hours
        isPm := Not(isPm);

        if (Not(isPM))
        begin
            // we looped. need to add a day
            day := day + 1;
        end
    end

    return DayAndTimeFrom12Hour(gpsTime, isPM, day);
end 
```

# ruby - 如何为 gem 测试配置 rspec 和 mongoid？

> ID：11694844
> 
> 赞同：2
> 
> 时间：2012-07-27T19:56:36.537
> 
> 标签：ruby, rspec, mongoid

我正在创建一个新的 Gem，它有一些使用 Mongoid 的模型。我想使用 RSpec 测试我的 gem。我已经开始使用 RSpec 来编写测试。我已经安装了一个名为 mongoid-rspec 的 gem，并[根据它的文档进行了设置](https://github.com/evansagge/mongoid-rspec#use)。

现在我需要告诉 Mongoid 如何配置自己。从命令行运行 rspec，它现在告诉我它找不到 mongoid.yml 文件，我应该运行`rails g mongoid:config`. 显然这行不通，因为我正在测试宝石。

我是 rspec 和 mongoid 的新手，所以我不太确定在这个测试环境中正确配置它需要做的所有事情。它可能就像创建这个 mongoid.yml 文件一样简单，但我不确定放置它的最佳位置。

任何帮助，将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-02-06T20:47:59.987

以下是如何让 Mongoid 在 gem rspec 测试的上下文中工作。

例如下设置一个 Mongoid 配置文件`spec/config/mongoid.yml`。

```
development:
  sessions:
    default:
      database: your_gem_db
      hosts:
        - localhost:27017 
```

在您的`spec/spec_helper.rb`文件中，您可以添加

```
Mongoid.load!('./spec/config/mongoid.yml') 
```

[请在Mongoid 设置文档页面](http://two.mongoid.org/docs/installation/configuration.html)上找到有关此问题的更多详细信息

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-29T18:08:24.160

只需将以下代码段添加到`spec_helper`配置部分：

```
# Clean up all collections before each spec runs.
config.before do
  Mongoid.purge!
end 
```

这将在每次测试之前清除 mongo 数据库。您也可以使用`factory_girl`（它适用于 Mongoid）和非常有用的`mongoid-rspec`gem：[https ://github.com/evansagge/mongoid-rspec](https://github.com/evansagge/mongoid-rspec)

..基本上就是这样；）

# css - 将 Div 扩展为其容器的长度

> ID：11694856
> 
> 赞同：0
> 
> 时间：2012-07-27T19:57:54.693
> 
> 标签：css, html, extend

我正在尝试扩展我的左侧边栏，使其跨越页面（或容器 DIV）的长度。我尝试将容器的高度设置为 100%，然后将侧边栏的高度设置为 100%，但这不起作用。

这是我的编码：

```
div#container
{
overflow: hidden;
margin-left: auto;
margin-right: auto;
margin-top: 0px;    
padding-bottom: 10px;
width: 880px;   
height: 100%;
text-align: left;
}

div#left
{
float: left;
width: 280px;
height: 100%;   
padding: 4px;   
background: #F1D7A5;
} 
```

这是页面的样子： http: [//www.studentbridges.org/new/](http://www.studentbridges.org/new/)

任何关于如何扩展侧边栏的输入将不胜感激！

谢谢！

~诺艾尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T20:05:00.033

将高度设置为 100% 会限制容器的高度。如果您将容器设置为您希望的像素高度，则子 div 将扩展其高度以匹配。因为您的下 div 是其容器的子 div，所以 height: 100% 只会导致容器 div 中剩余的长度，如您所见。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-29T00:26:57.413

我通常通过将侧边栏的背景作为图像放在侧边栏的容器上并沿 y 轴重复来解决这个问题。这实际上并没有拉伸你的侧边栏，但它看起来是一样的。在您的情况下，您可以像现在一样获取页面的打印屏幕，将其裁剪为 1px 高度和 880px 宽度，并将其设置为您的背景`#container`：

```
background: url(<path_to_image>) repeat-y center; 
```

您也可以`#left`从那时起删除背景。一切都避免使用表格！

# javascript - Django - 开发服务器不提供管理静态文件

> ID：11694857
> 
> 赞同：1
> 
> 时间：2012-07-27T19:57:57.860
> 
> 标签：javascript, css, django, admin

一切都很好，但是在 MySQL python 的符号链接之后，管理员 CSS 和 JS 消失了。

*   我尝试对 Django 文件夹中的管理静态文件夹进行符号链接。
*   我将 CSS、图像、JS 复制并粘贴到静态文件夹，但它也不起作用。

这真的很奇怪，Django 文档提到“Django 开发服务器自动为管理应用程序的静态文件提供服务”，但现在情况不再如此。它运行良好。

以前有人遇到过这样的问题吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T20:19:18.870

Django 提供静态文件，但并非没有对 settings.py 进行一些编辑。您确定您没有更改下面列出的这些参数吗？

```
MEDIA_ROOT = '/absolute/path/Project/App/'
MEDIA_URL = '/media/'
STATIC_ROOT = '/absolute/path/Project/App/templates/' -> inside this folder should be your static content, accordingly to this example
STATIC_URL = '/static/'
    #URL prefix for admin static files -- CSS, JavaScript and images.
ADMIN_MEDIA_PREFIX = '/static/admin/' 
```

在您的模板中，您应该使用如下内容：

```
{{ STATIC_URL }}templates/styles_folder/styles.css 
```

Django 可能在错误的目录中寻找这些文件。如果它无法显示您的文件，很大程度上是因为它无法在您告诉它们的位置找到它们。

# c# - 如何防止站点访问其他站点文件夹？

> ID：11694861
> 
> 赞同：0
> 
> 时间：2012-07-27T19:58:31.333
> 
> 标签：c#, asp.net, .net, authentication, web-config

请帮助我，我正在开发一个 asp.net 应用程序，它有一个主站点和子站点，如下所示：

site.com/parent

site.com/parent/child1

site.com/parent/child2

父站点上的任何页面都可以访问 child1 和 child2 文件并复制、删除它们

但问题是：child1 也可以访问 child2 文件并复制、删除它们！

我想阻止 child1 站点访问 child2 文件

我正在使用 asp.net 和 IIS 7.5

请帮忙 ！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T20:16:45.737

设置具有不同安全性的站点，然后阻止对文件夹的访问。这将取决于您当前使用的身份验证类型，但让我们假设它是匿名访问。

假设 child1 和 child2 是虚拟目录：

创建一个您将分配给 child1 的用户和一个您将分配给 child2 的不同用户。

在 IIS 中，转到 child1 >> 身份验证。编辑匿名 >> 更改为 child1 的用户。

转到 child2 >> 身份验证。编辑匿名 >> 更改为 child2 的用户。

如果您不使用匿名访问，您可以对您使用的身份验证类型执行与上述类似的操作。（如果您使用 SSPI，请不要忘记您的数据库）

转到 child1 的文件和/或文件夹并将 ACL 更改为阻止 child2 用户。转到 child2 的文件和/或文件夹并将 ACL 更改为阻止 child1 用户。

编辑：

还要记住更改 ACL 以允许适当的用户访问文件/文件夹。因此，对于 child1 的文件/文件夹，添加允许读取、写入 child1 用户等。

如果您在共享主机上，我希望他们将允许您更改文件安全性。

您还可以在 web.config 中配置身份验证属性。例如，对于匿名身份验证：

[http://msdn.microsoft.com/en-us/library/ms689465%28v=vs.90%29.aspx](http://msdn.microsoft.com/en-us/library/ms689465%28v=vs.90%29.aspx)

# ruby-on-rails - Rails XML 解析——我应该把这个功能放在控制器还是模型中？

> ID：11694864
> 
> 赞同：0
> 
> 时间：2012-07-27T19:58:36.543
> 
> 标签：ruby-on-rails, xml, model, controller, nokogiri

我有一个 Rails 应用程序，它充当 XML 服务 API 的传递。

主要用例如下：

1.  [用户通过http://example.com/model/report](http://example.com/model/report)向 Rails 发布参数。为简洁起见，假设表单只是提交`zip_code=90010`。
2.  Rails`zip_code`通过 GET 请求获取并使用 RestClient 查询外部 XML 服务 API：http://xmlservice.example.com/report?report_id=1&zip_code= [90010](http://xmlservice.example.com/report?report_id=1&zip_code=90010)
3.  报告响应通过 XML 返回。我想通过 Nokogiri 解析 XML 并通过 report.html.erb 输出一个普通的 HTML 视图。

我正在努力弄清楚将我的 XML (Nokogiri) 代码放在哪里。我应该在我的*模型中处理 XML 还是在**控制器*中进行所有解析？

我知道这两种方法都行得通，但我想知道最佳做法是什么。这*也不*是后台 XML 提要抓取，因此它不适合作为每晚运行的延迟作业。它必须 24/7 全天候响应动态请求。

请记住，我已经从我的应用程序中删除了 ActiveRecord 以进行优化。这个应用程序不涉及任何数据库。它基本上是对将为客户端呈现 HTML 输出的 XML API 的传递。

我读过最好使用“瘦控制器”和“胖模型”，但我看到的大多数 Nokogiri 示例`doc = Nokogiri::XML(RestClient.get(myurl, myparams))`在控制器内部都有类型代码。

那么...模型还是控制器？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T20:04:24.957

我会将代码放在一个类中，该类将获取 xml 并为您解析 xml。

这样就更容易对类进行单元测试以进行解析或您想要对返回的 XML 执行的任何其他操作。

该类可以放在 lib 文件夹中，或者如果它有点像伪模型（带有 XML 数据库），它也可以放在模型中。这主要取决于类是什么以及您希望如何构建代码库。

**更新**：这种方法的一个优点是，即使您将服务换成其他东西，您的代码库也可以保持不变，因为您的代码库与此类交互，只需对此类进行更改。接口优势:)

# javascript - 黑洞请求 Cakephp

> ID：11694865
> 
> 赞同：1
> 
> 时间：2012-07-27T19:58:48.990
> 
> 标签：javascript, jquery, security, cakephp

在我的索引页面上，我的表格的每一行都有复选框。

要编辑选定的项目，我使用 javascript/jquery 来获取复选框的类，构建一个 id 数组，然后将其发布到我的控制器中的编辑选定方法。

现在，这一切都运行良好，但是当在我的 App Controller 中启用安全性时，我的帖子会被黑洞，并且不会发布数组。

这是我的 index.ctp 文件：

```
<table id="indexTable">
    <thead><tr>
        <th> <?php echo $this->Form->checkbox('select_all', array('value' => 'select_all')); ?> </th>
        <th> <?php echo $this->Paginator->sort('id', 'ID'); ?> </th>
        <th> <?php echo $this->Paginator->sort('name', 'Name'); ?> </th>
        <th>Auto Offset  </th>  <th>UTC Offset Sec  </th>  <th>In Month  </th>
        <th>In Week      </th>  <th>In Dow          </th>  <th>In Hour   </th>  <th>Out Month   </th>
        <th>Out Week     </th>  <th>Out Dow         </th>  <th>Out Hour  </th>  <th>Offset Sec  </th>
        <th>DST Ref      </th>  <th>Actions      </th>
    </tr></thead>

    <tbody>

<?php
$this->Form->create('LocalClock');
foreach($localClocks as $LocalClock) { ?>
        <tr>
            <td>  <?php echo $this->Form->checkbox('LocalClocks'.$LocalClock['LocalClock']['id'], array('value' => $LocalClock['LocalClock']['id'], 'hiddenField' => false));?>  </td>
            <td>  <?php echo $LocalClock['LocalClock']['id']; ?>              </td>
            <td>  <?php echo $LocalClock['LocalClock']['name']; ?>            </td>
            <td>  <?php echo $LocalClock['LocalClock']['auto_offset']; ?>     </td>
        </tr>
<?php } ?>
    </tbody>
</table>

</div>

<!-- This <div> contains all the actions that can be performed on the Local Clocks. -->
<div>
    <p>

        <span style="float: left">
            <?php echo $this->Html->link(__('Edit All Items'), array('action' => 'editAll'), array('class' => 'link'));?> &nbsp;&nbsp;
        </span>

        <span style="float: left">
            <?php echo $this->Html->link(__('Edit Selected Items'), array('action' => 'lceditSelected'), array('class' => 'general_dialog'));?> &nbsp;&nbsp;
        </span>

        <span style="float: right">
            <?php echo $this->Html->link(__('Delete Selected Items'), array('action' => 'deleteSelected'), array('class' => 'general_dialog'));?> &nbsp;&nbsp;
        </span>
    <?php $this->Form->end(); ?>

    </p>
</div> 
```

我拿出了一些不重要的东西。问题在于我选择的编辑和删除选定的功能。

这是等待他们点击然后构建数组以发布到控制器操作的 javascript 代码：

```
$('.general_dialog').live('click', function()
{
    $.ajaxSetup({ async: false });

        var $selDialog = $("#general_dialog").dialog(
        {
            autoOpen: false,
            modal: true,
        });

        var postInfo = $('#LocalClockIndexForm').serialize();
        $.ajax({
        url: $(this).attr('href'),
        type: "post",
        data: postInfo,
        success: function (response)
        {
            alert('success');
        },
        error: function()
        {
            alert("failed");
        }
    });
        $selDialog.load($(this).attr('href'), function ()
        {
            $selDialog.dialog('open');
        });
    return false; // Ensure the controller does not redirect to the actual edit page
}); 
```

任何关于如何让它工作而不被黑洞的帮助将不胜感激。

提前致谢

- - - - - - - - - - - - - - - - - - - - - 编辑 - - - - --------------------------------------- 我将`$this->Form->create('LocalClock')`and添加`$this->Form->end()`到表中并切换了 $ .post() 和 $.ajax() 调用。

如果我发送序列化表单，我不会得到黑洞，但是当我查看发布的数据时，它不包含任何复选框 ID。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-28T10:04:22.820

您的示例缺少表单标签。

您需要使用 Form helper 创建和结束表单，以确保安全令牌包含在表单生成中：

```
$this->Form->create();
  // Other form elements here.
$this->Form->end(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T09:27:34.603

您是否尝试过修改 crsf 保护策略？如果您使用相同的令牌重新加载页面，安全组件将黑洞请求。

```
var $components = array('Security'=>array('csrfUseOnce'=>false)); 
```

# css - Twitter Bootstrap：按钮下拉菜单中的图标

> ID：11694866
> 
> 赞同：2
> 
> 时间：2012-07-27T19:59:00.560
> 
> 标签：css, twitter-bootstrap, offset

[这](http://jsfiddle.net/DjHyQ/)是 jsfiddle 上的链接和一些演示。它在 Chrome 甚至 IE 中运行良好，但在 FF 图标下。我怎样才能修复它而不用负边距或类似的东西向上移动它们？我不知道为什么会这样。

![法郎](../Images/2ced7bdfacf99207279d293a1bb10e2d.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-27T20:37:33.287

只需添加以下样式

```
.dropdown-menu a {
    white-space:normal;
} 
```

[**演示**](http://jsfiddle.net/DjHyQ/47/)。

# c++ - 从静态方法访问非静态成员的工作示例

> ID：11694870
> 
> 赞同：2
> 
> 时间：2012-07-27T19:59:13.033
> 
> 标签：c++, class, pointers, static, non-static

我正在学习[ns-3 教程](http://www.nsnam.org/docs/release/3.13/tutorial/singlehtml/index.html#example-code)。我无法理解以下代码片段：

```
class MyObject : public Object
{
public:
  static TypeId GetTypeId (void)
  {
    static TypeId tid = TypeId ("MyObject")
       .SetParent (Object::GetTypeId ())
       .AddConstructor<MyObject> ()
       .AddTraceSource ("MyInteger",
                     "An integer value to trace.",
                      MakeTraceSourceAccessor (&MyObject::m_myInt))
       ;
     return tid;
  }

  MyObject () {}
  TracedValue<int32_t> m_myInt;
}; 
```

据我了解， MyObject::m_myInt 是从静态方法访问非静态类成员 m_myInt 并且 & 获取该成员的地址。此代码已成功编译并执行。怎么可能？静态方法使用什么类的实例？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T21:17:58.967

指向成员的指针可以是指向成员方法或成员变量的指针，并且不需要声明或分配类的实例。然而，这并不意味着您可以在没有实例的情况下做很多事情。你仍然需要一个实例来使用它们。考虑以下代码：

```
class A
{
public:
    void SomeMethod();
    int someVar;
};

void (A::*pSomeMethod)() = &A::SomeMethod; //Declares a member pointer to method and assigns
int A::*pSomeVar = &A::someVar; //Declares a member pointer to int variable and assigns

A a; //Defines an instance
(a.*pSomeMethod)(); //Uses an instance with the pSomeMethod member pointer.
int var = (a.*pSomeVar); //Uses an instance with the pSomeVar member pointer. 
```

这是可能的，它允许一些非常酷的东西。

# javascript - 将 Javascript 变量写入- 无需 onclick

> ID：11694872
> 
> 赞同：0
> 
> 时间：2012-07-27T19:59:14.373
> 
> 标签：javascript, gps

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-27T20:03:31.190

```
<a href="" id="location">GPS Location</a>

<script>
function onGeoSuccess(event)
{
    document.getElementById("Latitude").value =  event.coords.latitude; 
    document.getElementById("Longitude").value = event.coords.longitude;

    document.getElementById("location").href = "page.htm?Lat=" + event.coords.latitude + "&Long=" + event.coords.longitude;
}
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-28T14:35:01.403

Zoltan 让我朝着正确的方向开始 - 不能让它太拉，不得不在身体上增加一个负载。

现在我正在尝试重定向到该网址，但它不会与 javascript 重定向一起使用...

谢谢佐尔坦

```
 <script type="text/javascript"> 

// Get a single location update
function getLocationConstant()
{
    if(navigator.geolocation)
    {
        navigator.geolocation.getCurrentPosition(onGeoSuccess,onGeoError,{enableHighAccuracy:true,maximumAge:0});
    } else {
        alert("Your browser or device doesn't support Geolocation");
    }
}

// If we have a successful location update
function onGeoSuccess(event)
{
    document.getElementById("Latitude").value =  event.coords.latitude; 
    document.getElementById("Longitude").value = event.coords.longitude;
    document.getElementById("location").href = "track.cfm?track=s&Lat=" + event.coords.latitude + "&Long=" + event.coords.longitude;

var redirectUrl = "track.cfm?track=s&Lat=" + event.coords.latitude + "&Long=" + event.coords.longitude; 

}

// If something has gone wrong with the geolocation request
function onGeoError(event)
{
    alert("Error code " + event.code + ". " + event.message);
}

function redirect() 
{ 
    window.location = redirectUrl; 
} 
setTimeout(redirect,15000); 
  </script>

  </head>

  <body onload="getLocationConstant()">
   <br><br>
  <a href="" id="location">URL?</a> 
```

# c++ - C++ /cli 将 LPCSTR 转换为 System::String^

> ID：11694873
> 
> 赞同：2
> 
> 时间：2012-07-27T19:59:21.737
> 
> 标签：c++, string, c++-cli, marshalling, lpcstr

我在将 LPCSTR 转换为 System::String^ 时遇到问题，尽管我可以使用 Marshal 将 System::String 转换为 LPCSTR。

但是我如何将 LPCSTR 转换为 System::String^

谢谢你

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-27T20:01:12.440

```
gcnew System::String(lpcstrThing); 
```

# sql - SQL Server 查询说明

> ID：11694875
> 
> 赞同：0
> 
> 时间：2012-07-27T19:59:34.303
> 
> 标签：sql, sql-server, sql-server-2008-r2

我正在研究一个 2 年前担任我职位的人的代码，并且在破译他们的 SQL 代码块时遇到了麻烦。

```
WHERE  ACCOUNT NOT IN (SELECT ACCOUNT
                   FROM   MWAPPTS A1
                   WHERE  A1.ACCOUNT = A.ACCOUNT
                          AND ADATE > dbo.Endofmonth(ACTIONDATE)
                          AND REASON IN ('CPE','NPPE')
                          AND USERFLAG IN ( 'U', 'B' )) 
```

`dbo.Endofmonth`是一个存储过程，它获取输入日期的月份的最后一天。

如果我没看错，我们不包括显示的 select 语句将返回帐户的行。我在选择语句时遇到问题。我是否正确，它正在`ACCOUNT`比`ADATE`月底更早。原因是“CPE”还是“NPPE”，`USERFLAG`是“U”还是“B”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T20:03:46.540

是的，您要退回帐户没有以下内容的记录：

1)`ADATE`大于函数返回的日期`dbo.Endofmonth(ACTIONDATE)`。

2) 一个`Reason`是`CPE or NPPE`

3) 并且`Userflag`是`U or B`。

您必须查看函数中的代码`dbo.Endofmonth(ACTIONDATE)`以确定它返回的确切内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T20:05:08.720

> 我是否正确，它正在获得 ADATE 比月底大的 ACCOUNT。

内部本身正在`SELECT`寻找月末*之后*的条目。然后，外部的应该从 检索帐户是月末的行。`ADATE`*`ACTIONDATE``NOT IN``SELECT``ADATE``<=``ACTIONDATE`*

 *你的其他假设似乎是正确的。

旁白：它似乎`dbo.Endofmonth`是一个用户定义的函数，而不是一个存储过程（或者不可能这样调用它）。*

# objective-c - 有没有办法在 Xcode 4.4 中获得简洁的 Objective-C 文字索引功能？

> ID：11694877
> 
> 赞同：7
> 
> 时间：2012-07-27T19:59:54.387
> 
> 标签：objective-c, cocoa-touch, xcode4.4, objective-c-literals

我阅读了有关新的 Objective-C 文字的所有信息，并使用 Xcode 转换了我的旧代码，但索引代码没有改变。我手动更改了它，但它不会编译。我看到一个帖子说我们必须等到 iOS 6，但我现在想要索引！

有什么解决办法吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-07-27T19:59:54.387

好吧，有办法做到这一点！将索引方法作为类别添加到 NSArray 和 NSDictionary，您可以获得大多数您想要的类的功能。[您可以在此处](http://clang.llvm.org/docs/ObjectiveCLiterals.html)阅读 ObjectiveC 文字。并且感谢 James Webster 的 @YES 和 @NO 解决方案，您现在也可以在您的项目中正确使用它们！[（技术）](https://stackoverflow.com/a/11686024/96716)

1) 创建接口文件

```
// NSArray+Indexing.h
#if !defined(__IPHONE_6_0) || __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_6_0
@interface NSArray (Indexing)
- (id)objectAtIndexedSubscript:(NSUInteger)idx;
@end
@interface NSMutableArray (Indexing)
- (void)setObject:(id)obj atIndexedSubscript:(NSUInteger)idx;
@end
// NSDictionary+Indexing.h
@interface  NSDictionary (Indexing)
- (id)objectForKeyedSubscript:(id)key;
@end
@interface  NSMutableDictionary (Indexing)
- (void)setObject:(id)obj forKeyedSubscript:(id)key;
@end
#endif 
```

2）创建实现文件//在执行此操作之前请参阅下面的编辑 - 您可以跳过此

```
// NSArray+Indexing.m
#if !defined(__IPHONE_6_0) || __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_6_0
#import "NSArray+Indexing.h"
@implementation NSArray (Indexing)
- (id)objectAtIndexedSubscript:(NSUInteger)idx
{
    return [self objectAtIndex:idx];
}
@end
@implementation NSMutableArray (Indexing)
- (void)setObject:(id)obj atIndexedSubscript:(NSUInteger)idx
{
    [self replaceObjectAtIndex:idx withObject:obj];
}
@end

// NSMutableDictionary+Indexing.m
@implementation  NSDictionary (Indexing)

- (id)objectForKeyedSubscript:(id)key
{
    return [self objectForKey:key];
}
@end
@implementation  NSMutableDictionary (Indexing)
- (void)setObject:(id)obj forKeyedSubscript:(id)key
{
    [self setObject:obj forKey:key];
}
@end
#endif 
```

3) 将接口文件添加到您的 pch 文件中以供全局使用，或根据需要将它们添加到 .m 文件中

```
// Add to PCH file
#ifdef __OBJC__
    #import <UIKit/UIKit.h>
    #import <Foundation/Foundation.h>
...
#if !defined(__IPHONE_6_0) || __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_6_0

// New Indexing
#import "NSDictionary+Indexing.h"
#import "NSArray+Indexing.h"

// Provided by James Webster on StackOverFlow
#if __has_feature(objc_bool) 
#undef YES 
#undef NO 
#define YES __objc_yes 
#define NO __objc_no 
#endif 

#endif
#endif

#endif 
```

4) 重建，然后添加以下文件以验证一切正常

```
// Test Example
{

    NSMutableArray *a = [NSMutableArray arrayWithArray:@[ @"a", @"b", @"c" ]];
    NSLog(@"%@", a[1]);
    a[1] = @"foo";
    NSLog(@"a: %@", a);

    NSMutableDictionary *dict = [NSMutableDictionary dictionaryWithDictionary:@{ @"key" : @"object" }];
    NSLog(@"%@", dict[@"key"]);

    dict[@"key"] = @"New Object";
    dict[@"newKey"] = @"WOW a new object";

    NSLog(@"dict: %@", dict);

    NSLog(@" %@ %@", @YES, @NO );
} 
```

编辑：好吧，根据一位关键的 llvm/clang Apple 工程师的说法，有一个库已经与实现链接，所以你只需要接口文件：

日期：2012 年 8 月 20 日星期一 15:16:43 -0700 发件人：Greg Parker 收件人：... 主题：回复：如何使 Obj-C 集合下标在 iOS 5 上工作？...

> 作为一个实验，我为这些方法添加了@interface 类别，但没有添加@implementation——应用程序仍然运行良好（至少在 5.1 模拟器中）

编译器发出相同的调用。神奇之处在于名称越来越不准确的 libarclite（“It's Not Just For ARC Anymore™”），如果下标方法尚不存在，它会在运行时添加下标方法的实现。

IIRC 有一些 libarclite 没有升级的可下标的类（NSOrderedSet，也许？）所以你仍然需要在旧的部署目标上进行彻底的测试。

# coronasdk - 显示两个物体碰撞的图像

> ID：11694882
> 
> 赞同：0
> 
> 时间：2012-07-27T20:00:12.953
> 
> 标签：coronasdk

我正在使用 CI 并希望在两个对象相互碰撞时显示图像，那时会显示一个特定的图像，并且该图像应该仅在发生共谋的很短的时间内显示。

它似乎是一个 poof 函数或类似的东西。但我不明白如何解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T07:39:30.273

我将为您的问题提供一些示例代码。一个动画男孩与其他对象（coll1）发生碰撞。

```
animatedboy.collision=function(self,event)
if event.other.name == "coll1" then
    picture.isVisible=true

function updateTime()
       display.remove(picture) or picture.isVisible=false
end
timeTaken = timer.performWithDelay( 1000, updateTime, timerTicks )          

end

animatedboy:addEventListener( "collision", animatedboy ) 
```

# django - 通过hasattr确定子类如何触发django的orm中的db查询？

> ID：11694883
> 
> 赞同：0
> 
> 时间：2012-07-27T20:00:28.817
> 
> 标签：django, django-models, django-orm

例如，我对具有子类 ConceptNode 和 DerivedNode 的类 Node 使用多表继承。为了确定我正在处理的节点类型并将函数调用分发到适当的子类，我经常必须像这样调用 hasattr：

```
test_node = Node.objects.all()[0]

if hasattr( test_node, "conceptnode"):
    test_node.conceptnode.myFunction()
elif hasattr( test_node, "derivednode"):
    test_node.derivednode.myFunction()
else:
   raise Exception("Not a valid type.") 
```

我注意到这会导致多个数据库查询，这加起来确实会减慢我编写的某些函数的速度。

我尝试了另一种使用 try...catch 的方法，它不会减少查询的数量。

```
test_node = Node.objects.all()[0]

try:
    test_node.conceptnode.myFunction()
except ObjectDoesNotExist:
    test_node.derivednode.myFunction() 
```

我的主要问题是：django 如何确定在这里执行哪些查询？我看不到 hasattr 是如何被翻译成数据库查询的。

此外，如果有人可以建议一种更有效的方法来处理这个问题（尤其是从查询计数的角度来看），那也太好了！

编辑：为了转储执行的 sqlite 查询，我执行了以下操作：

```
from django.db import connection
from django import db
db.reset_queries()
hasattr(nds[0],'conceptnode')
hasattr(nds[0],'derivednode')
connection.queries 
```

我得到了以下结果：

```
{'sql': u'SELECT "nodes_node"."id", "nodes_node"."name", "nodes_node"."description", "nodes_node"."node_tree_id", "nodes_node"."unique_name", "nodes_node"."last_updated_timestamp", "nodes_node"."order", "nodes_node"."data_json", "nodes_node"."data_json_synchronized" FROM "nodes_node" LIMIT 1',  'time': '0.001'}
{'sql': u'SELECT "nodes_node"."id", "nodes_node"."name", "nodes_node"."description", "nodes_node"."node_tree_id", "nodes_node"."unique_name", "nodes_node"."last_updated_timestamp", "nodes_node"."order", "nodes_node"."data_json", "nodes_node"."data_json_synchronized", "nodes_conceptnode"."node_ptr_id", "nodes_conceptnode"."node_parent_id" FROM "nodes_conceptnode" INNER JOIN "nodes_node" ON ("nodes_conceptnode"."node_ptr_id" = "nodes_node"."id") WHERE "nodes_conceptnode"."node_ptr_id" = 1 ',  'time': '0.000'}
{'sql': u'SELECT "nodes_node"."id", "nodes_node"."name", "nodes_node"."description", "nodes_node"."node_tree_id", "nodes_node"."unique_name", "nodes_node"."last_updated_timestamp", "nodes_node"."order", "nodes_node"."data_json", "nodes_node"."data_json_synchronized" FROM "nodes_node" LIMIT 1',  'time': '0.001'}
{'sql': u'SELECT "nodes_node"."id", "nodes_node"."name", "nodes_node"."description", "nodes_node"."node_tree_id", "nodes_node"."unique_name", "nodes_node"."last_updated_timestamp", "nodes_node"."order", "nodes_node"."data_json", "nodes_node"."data_json_synchronized", "nodes_derivednode"."node_ptr_id", "nodes_derivednode"."node_source_id", "nodes_derivednode"."node_target_id" FROM "nodes_derivednode" INNER JOIN "nodes_node" ON ("nodes_derivednode"."node_ptr_id" = "nodes_node"."id") WHERE "nodes_derivednode"."node_ptr_id" = 1 ',  'time': '0.000'} 
```

其中第一个和第三个是获取原始节点对象。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T20:35:39.200

您有两个简单节点查找（`LIMIT 1`查询）的实例，因为您将查询集作为列表多次访问。

```
nodes = Node.objects.all()
nodes[0]
nodes[0] 
```

触发两个查询，而：

```
node = Node.objects.all()[0]
node
node 
```

触发一个。起初这看起来有点奇怪，但关键是要记住`Node.objects.all()`在您访问它之前不会对其进行评估（不进行查询）。

至于为什么单个对象查找运行两个查询，您使用的是[多表继承](https://docs.djangoproject.com/en/dev/topics/db/models/#multi-table-inheritance)。如果你的模型中有这个：

```
class Node(models.Model):
    pass

class ConceptNode(Node):
    pass 
```

Django 将创建两个表，其中`ConceptNode`行有一个 parent `Node`。

您可能正在寻找的是一个[抽象基类](https://docs.djangoproject.com/en/dev/topics/db/models/#abstract-base-classes)，它允许您在多个类之间共享方法和属性，同时只为每个类使用一个表。只需添加`abstract = True`到父类元：

```
class Node(models.Model):
    class Meta:
        abstract = True 
```

最后，请注意，这两个查询几乎都不需要时间，所以我不会太担心。

# c# - 如何使用 XmlSerializer 从数组中提取属性？

> ID：11694884
> 
> 赞同：0
> 
> 时间：2012-07-27T20:00:33.263
> 
> 标签：c#, xml-serialization, deserialization, xmlserializer, xml-deserialization

我想使用 XmlSerializer 提取图像属性“href”。

如果我的设置如下所示，它将起作用：

```
<images>
       <image id="285">  
          http://images1.com/test.jpg" 
       </image>

       <image id="286">
          http://images1.com/test.jpg"
       </image>       
</images> 
```

* * *

但如果它看起来像这样，则不是：

```
<images>
    <image href=http://images1.com/test.jpg" id="285" />
    <image href=http://images1.com/test.jpg" id="286" />        
</images> 
```

* * *

这是我的对象

```
 private string[] imageList;
   [XmlArrayItem("image", typeof(object))]
   [XmlArray("images")]

    public string[] imageLink
    {
        get
        {
            return imageList;
        }
        set
        {
            imageList = value;
        }

    } 
```

* * *

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T23:01:03.270

我尝试了多种方法来尝试让序列化程序符合这个 XML，但运气不佳。

你可能只想做这样的事情：

```
 string xml = @"<images>
    <image href=""http://images1.com/test.jpg"" id=""285"" />
    <image href=""http://images1.com/test2.jpg"" id=""286"" />        
</images>";

    List<string> images = new List<string>();
    using (StringReader sr = new StringReader(xml))
    using (XmlTextReader xr = new XmlTextReader(sr))
    {
        while (!xr.EOF)
        {
            xr.MoveToContent();
            xr.ReadToDescendant("image");
            xr.MoveToAttribute("href");
            xr.ReadAttributeValue();            
            images.Add(xr.Value);
            xr.MoveToElement();
            if (xr.Name != "images")
            {
                xr.ReadElementString();
            }
            else
            {
                xr.ReadEndElement();
            }
        }
    } 
```

我做了更多的研究，并想出了一种使用序列化并获得所需 XML 的方法：

```
[XmlRoot("images")]
public class ImageListWrapper
{
    public ImageListWrapper()
    {
        Images = new List<Image>(); 
    }

    [XmlElement("image")]
    public List<Image> Images
    {
        get; set;
    }

    public List<string> GetImageLocations()
    {
        List<string> imageLocations = new List<string>();

        foreach (Image image in Images)
        {
            imageLocations.Add(image.Href);
        }

        return imageLocations;
    }
}

[XmlRoot("image")]
public class Image
{
    [XmlAttribute("href")]
    public string Href { get; set; }
} 
```

# c++ - 遍历 2.5D 网格

> ID：11694886
> 
> 赞同：1
> 
> 时间：2012-07-27T20:00:39.560
> 
> 标签：c++, algorithm, math

我试图弄清楚如何以有效的方式遍历 2.5D 网格。网格本身是 2D 的，但网格中的每个单元格都有一个浮动的最小/最大高度。要遍历的线由两个 3D 浮点坐标定义。如果进入/退出网格单元格之间的 z 值范围不与该单元格的最小/最大高度重叠，我想停止遍历该线。

我目前正在使用 2D DDA 算法按顺序遍历网格单元（见图），但我不确定在到达每个网格单元时如何计算 z 值。如果我能做到这一点，我可以在进入/离开单元格时根据单元格的最小/最大高度测试 z 值。

有没有办法修改这个算法，允许在输入每个网格单元格时计算 z？还是有更好的遍历算法可以让我这样做？

[![网格](../Images/63ed16c8a704df172e3bbebc4e68c032.png)](https://i.stack.imgur.com/HPv7B.gif)

这是我正在使用的当前代码：

```
void Grid::TraceGrid(Point3<float>& const start, Point3<float>& const end, GridCallback callback )
{
    // calculate and normalize the 2D direction vector
    Point2<float> direction=end-start;
    float length=direction.getLength( );
    direction/=length;

    // calculate delta using the grid resolution
    Point2<float> delta(m_gridresolution/fabs(direction.x), m_gridresolution/fabs(direction.y));

    // calculate the starting/ending points in the grid
    Point2<int> startGrid((int)(start.x/m_gridresolution), (int)(start.y/m_gridresolution));
    Point2<int> endGrid((int)(end.x/m_gridresolution), (int)(end.y/m_gridresolution));
    Point2<int> currentGrid=startGrid;

    // calculate the direction step in the grid based on the direction vector
    Point2<int> step(direction.x>=0?1:-1, direction.y>=0?1:-1);

    // calculate the distance to the next grid cell from the start
    Point2<float> currentDistance(((step.x>0?start.x:start.x+1)*m_gridresolution-start.x)/direction.x, ((step.y>0?start.y:start.y+1)*m_gridresolution-start.y)/direction.y);

    while(true)
    {
        // pass currentGrid to the callback
        float z = 0.0f;     // need to calculate z value somehow
        bool bstop=callback(currentGrid, z);

        // check if the callback wants to stop or the end grid cell was reached
        if(bstop||currentGrid==endGrid) break;

        // traverse to the next grid cell
        if(currentDistance.x<currentDistance.y) {
            currentDistance.x+=delta.x;
            currentGrid.x+=step.x;
        } else {
            currentDistance.y+=delta.y;
            currentGrid.y+=step.y;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T21:16:00.183

[Bresenham Line 算法](http://en.wikipedia.org/wiki/Bresenham%27s_line_algorithm)的 3D 扩展似乎可以工作。您将遍历 X 并独立跟踪线段的 Y 和 Z 分量的误差，以确定每个相应 X 值的 Y 和 Z 值。当 Z 中的累积误差达到某个临界水平时，您只需停止，这表明它超出了您的最小值/最大值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T23:43:08.383

对于每个单元格，您都知道您来自哪个单元格。这意味着你知道你来自哪一方。在绿线和给定网格线的交点处计算 z 似乎微不足道。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-30T18:24:59.680

我想出了一个好办法。添加到函数的开头：

```
float fzoffset=end.z-start.z;
Point2<float> deltaZ(fzoffset/fabs(end.x-start.x), fzoffset/fabs(end.y-start.y));
Point2<float> currentOffset((step.x>0?start.x:start.x+1)*m_gridresolution-start.x, (step.y>0?start.y:start.y+1)*m_gridresolution-start.y); 
```

在 currentDistance.x/.y 递增的循环内，添加：

```
currentOffset.x+=m_gridresolution;  //When stepping in the x axis
currentOffset.y+=m_gridresolution;  //When stepping in the y axis 
```

然后在每一步计算z：

```
z=currentOffset.x*deltaZ.x+start.z;  //When stepping in the x axis
z=currentOffset.y*deltaZ.y+start.z;  //When stepping in the y axis 
```

# sql-server - SSIS使用派生列来引用同一表中的列

> ID：11694892
> 
> 赞同：1
> 
> 时间：2012-07-27T20:01:11.610
> 
> 标签：sql-server, excel, ssis

我正在尝试将 xls 电子表格导入表中，并且其中一列需要从同一表中的不同列派生。我想在导入阶段执行此操作，而不是在导入后创建一个 SQL 任务来执行此操作。在 SSIS 中创建表达式时我很糟糕，所以这可能是一项简单的任务——但我就是做错了。

```
DATEADD(s,-1,DATEADD(mm, DATEDIFF(m,0,columndata)+1,0)) 
```

这就是我试图使用的表达方式。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T21:30:23.333

您需要以下内容：

```
DATEADD("S",-1,DATEADD("M",DATEDIFF("M", (DT_DATE) 0,DATEADD("D",[dataDate],(DT_DATE)-2))+1,(DT_DATE)0) ) 
```

1）您需要使用 " 来包围您的日期部分。

2）您需要将您的 0 日期转换为明确的日期类型。

此表达式采用列日期序列号 [dataDate] 将该天数添加到日期 -2

```
DATEADD("D",[dataDate],(DT_DATE)-2) 
```

（显然 sql day 0 和 excel day 0 在我的版本（sql2008r2 和 excel 2007）上相差 2 天）并找到从日期 0 到该日期的月数，

```
DATEDIFF("M", (DT_DATE) 0,DATEADD("D",[dataDate],(DT_DATE)-2)) 
```

然后将 1 添加到该月数并将其添加回日期 0

```
DATEADD("M",DATEDIFF("M", (DT_DATE) 0,DATEADD("D",[dataDate],(DT_DATE)-2))+1,(DT_DATE)0) 
```

（获取列日期值之后的下个月的开始），然后从日期中减去 1 秒以获取日期时间格式的列日期值的月份的最后一秒。

```
DATEADD("S",-1,DATEADD("M",DATEDIFF("M", (DT_DATE) 0,DATEADD("D",[dataDate],(DT_DATE)-2))+1,(DT_DATE)0) ) 
```

# javascript - 使用父/子删除列表元素

> ID：11694894
> 
> 赞同：-1
> 
> 时间：2012-07-27T20:01:13.750
> 
> 标签：javascript, jquery, jquery-ui, html-lists

我希望从几个连接的 ul 列表中动态删除 li 元素。现在我正在通过使用分配“dblclick”事件行为`$("#sortable1").children().on('dblclick',function() {...})`

#sortable1 中的项目将被用户移动到其他列表（#sortable2、#sortable3 等）。

双击列表项时，会弹出一个对话框，询问用户是否要删除它。如果用户说是，我希望将列表项从它所在的任何列表中删除。我正在尝试使用类似的方法来做到这一点：

```
$($(this).parent().childNodes[$(this).index()]).remove() 
```

但这不起作用。

建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T20:09:20.110

像这样的东西应该工作。

```
var showPopup = function( elem ){
  //show your popup with a function like this, as i assume it already does...      
  $( '#delete_toggle' ).one( 'click', function(){
    elem.remove();
  });
};

$("#sortable1").children().on('dblclick',function(){
  showPopup( $(this) );
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T20:24:46.287

To remove the element that was clicked on, you just use this in the event handler:

```
$(this).remove(); 
```

or if you've saved the element reference to a variable `elem`, it would be this:

```
$(elem).remove(); 
```

You are trying to make it way more complicated than need be. The jQuery `.remove()` method looks at who its current parent is and takes care of all that for you.

# ios - 使用 JSON 的 iOS 谷歌搜索

> ID：11694898
> 
> 赞同：3
> 
> 时间：2012-07-27T20:01:20.270
> 
> 标签：ios, json, nsdictionary

**更新**

看来 resultField 是没有价值的。会调查这个，但我仍然很感激任何建议。

**原帖**

我的任务是开发一个基本的 iOS 应用程序，它只需发出搜索请求，然后显示大学工作的结果。我尝试使用 Google 自定义搜索引擎，但无法让它在 iPhone 上运行，因此我不得不求助于已贬值的 Google Web Search API（讲师对此表示同意）。

现在，我可以发出请求，它会按预期返回 JSON 数据，我认为我现在必须解析这些数据。可悲的是，我只有一周的时间来做这件事，这太疯狂了，因为我以前从未使用过 JSON。

**我想要的是，如果有人可以用一两个指针帮助我开始了解如何获得 JSON 数据的基本解析。**

我在 Stackoverflow 上环顾四周，看到了一些可能有用的东西，例如[此处](https://stackoverflow.com/questions/7134910/retrieving-values-from-json-using-objective-c)所选答案中的分解结构。

该人将其放在一起，当代码中显示时，这对我来说很有意义：

**一个伟大的结构解释**

```
dictionary (top-level)
     sethostname (array of dictionaries)
         dictionary (array element)
            msgs (string)
            status (number)
            statusmsg (string)
            warns (array)
                ??? (array element) 
```

可悲的是，我什至无法开始对我的应用程序中生成的代码做同样的事情。它采用类似于此示例代码的形式，由[google](https://developers.google.com/web-search/docs/#fonje)提供- 我不是 Paris Hilton 粉丝！

**来自谷歌的示例代码。**

```
{"responseData": {
 "results": [
  {
   "GsearchResultClass": "GwebSearch",
   "unescapedUrl": "http://en.wikipedia.org/wiki/Paris_Hilton",
   "url": "http://en.wikipedia.org/wiki/Paris_Hilton",
   "visibleUrl": "en.wikipedia.org",
   "cacheUrl": "http://www.google.com/search?q\u003dcache:TwrPfhd22hYJ:en.wikipedia.org",
   "title": "\u003cb\u003eParis Hilton\u003c/b\u003e - Wikipedia, the free encyclopedia",
   "titleNoFormatting": "Paris Hilton - Wikipedia, the free encyclopedia",
   "content": "\[1\] In 2006, she released her debut album..."
  },
  {
   "GsearchResultClass": "GwebSearch",
   "unescapedUrl": "http://www.imdb.com/name/nm0385296/",
   "url": "http://www.imdb.com/name/nm0385296/",
   "visibleUrl": "www.imdb.com",
   "cacheUrl": "http://www.google.com/search?q\u003dcache:1i34KkqnsooJ:www.imdb.com",
   "title": "\u003cb\u003eParis Hilton\u003c/b\u003e",
   "titleNoFormatting": "Paris Hilton",
   "content": "Self: Zoolander. Socialite \u003cb\u003eParis Hilton\u003c/b\u003e..."
  },
  ...
 ],
 "cursor": {
  "pages": [
   { "start": "0", "label": 1 },
   { "start": "4", "label": 2 },
   { "start": "8", "label": 3 },
   { "start": "12","label": 4 }
  ],
  "estimatedResultCount": "59600000",
  "currentPageIndex": 0,
  "moreResultsUrl": "http://www.google.com/search?oe\u003dutf8\u0026ie\u003dutf8..."
 }
}
, "responseDetails": null, "responseStatus": 200} 
```

这是目前为止的代码，正如您将很快了解到的那样，除了返回类似于上面代码的代码之外，它实际上并没有做太多其他事情。

```
 **My code.** 

 // query holds the search term
query = [query stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding];

//append theQuery with search URL
NSString *tempString = [NSString stringWithFormat:@"%@/%@", @"https://ajax.googleapis.com/ajax/services/search/web?v=1.0&q=", theQuery];

//Create NSURL out of tempString
NSURL *url = [NSURL URLWithString:tempString];

// Create a request object using the URL.
NSURLRequest *request = [NSURLRequest requestWithURL:url];

// Prepare for the response back from the server
NSHTTPURLResponse *response = nil;
NSError *error = nil;

    NSData *responseData = [NSURLConnection sendSynchronousRequest:request returningResponse:&response error:&error];

    NSDictionary *dictionary = [NSJSONSerialization JSONObjectWithData:responseData options:NSJSONWritingPrettyPrinted error:&error];

    NSDictionary* resultField = [NSDictionary dictionaryWithDictionary:[dictionary objectForKey:@"results"]];

// Send a synchronous request to the server (i.e. sit and wait for the response)

// Check if an error occurred
if (error != nil) {
    NSLog(@"%@", [error localizedDescription]);
    // Do something to handle/advise user.
}

// Convert the response data to a string.
NSString *responseString = [[NSString alloc] initWithData:responseData  encoding:NSUTF8StringEncoding];

    NSArray *results = [dictionary objectForKey:@"results"];
    //set label's text value to responseString's value.
endLabel.text = responseString; 
```

现在我遇到的主要问题是结果数组一直为空。我真的可以在这里做一个正确的方向。谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-28T00:12:42.107

看起来您在遍历从 JSON 中解析出来的数据结构时遇到了问题。

```
 NSDictionary *dictionary = [NSJSONSerialization JSONObjectWithData:responseData options:NSJSONWritingPrettyPrinted error:&error]; 
```

假设你传入的数据是好的，这`dictionary`包含了顶层结构。它具有三个键`responseData`、`responseDetails`和`responseStatus`。`NSLog`（你可以通过查字典来看到这一点。）

然后，您在该字典中查询 key `results`。它不存在，因此您的`resultField`变量设置为`nil`. 键的`dictionary`值`responseData`是另一个包含键的字典`results`——你需要那个中间步骤。

此外，`results`第二个字典中键的值是一个数组（包含更多字典），而不是字典本身。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-16T19:34:51.747

无需每次都创建新字典。为了便于阅读，我建议如下：

```
[[dictionary objectForKey:@"responseData"] objectForKey:@"results"] 
```

那里有一系列结果。然后您可以添加

```
[ [dictionary objec...] objectAtIndex:0] 
```

# c++ - 无法从 2D 数组到另一个 2D 数组的 strcpy

> ID：11694899
> 
> 赞同：0
> 
> 时间：2012-07-27T20:01:21.610
> 
> 标签：c++, operators, strcpy

两者都在同一类的 operator= 中

这是函数的定义。

```
 void segment::operator=(const segment& w) {

        strcpy(this->phrase, w.getPhrase()); //this line creates a problem. 
```

错误如下：

```
segment.cpp: In member function ‘void segment::operator=(const segment&)’:   
segment.cpp:186: error: passing ‘const segment’ as ‘this’ argument of ‘const char* 
segment::getPhrase()’ discards qualifiers
segment.cpp:186: error: cannot convert ‘char (*)[40]’ to ‘char*’ for argument ‘1’ to ‘char* strcpy(char*, const char*)’ 
```

* * *

```
 const char* segment::getPhrase(){
        return *phrase;
} 
```

以上是功能`getPhrase`

我不知道为什么我不能为此做一个 strcpy 。

我正在努力完成任务。

编辑：

这是类型`phrase`

```
char phrase[10][40]; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-27T20:16:03.640

有两个问题。首先，您必须创建`getPhrase`一个 const 方法。第二个问题是它`strcpy`不适用于额外的间接级别。你可能需要这样的东西：

```
const char* segment::getPhrase(int index) const { 
    return phrase[index]; 
} 

void segment::operator=(const segment& w) {  
    int index;
    for (index = 0; index < 10; ++index) {
        strcpy(this->phrase[index], w.getPhrase(index)); 
    }
} 
```

你应该`10`用常量替换

```
class segment {
    //other stuff
    static const int kNumPhrases = 10;
    char phrase[kNumPhrases][40];
} 
```

# c - 如何在 C 中用逗号格式化货币？

> ID：11694901
> 
> 赞同：5
> 
> 时间：2012-07-27T20:01:34.277
> 
> 标签：c, formatting

我正在寻找将 Long Float 格式化为 C 中的货币。我想在开头放置一个美元符号，逗号迭代小数点前的每三个数字，并在小数点前立即放置一个点。到目前为止，我一直在打印这样的数字：

`printf("You are owed $%.2Lf!\n", money);`

返回类似的东西

`You are owed $123456789.00!`

数字**应该**是这样的

`$123,456,789.00`
`$1,234.56`
`$123.45`

任何答案都不需要在实际代码中。你不必用勺子喂食。如果有与 c 相关的细节会有所帮助，请提及。其他伪代码很好。

谢谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-27T20:21:10.360

您`printf`可能已经能够使用`'`标志自己做到这一点。不过，您可能需要设置您的语言环境。这是我机器上的一个例子：

```
#include <stdio.h>
#include <locale.h>

int main(void)
{
    setlocale(LC_NUMERIC, "");
    printf("$%'.2Lf\n", 123456789.00L);
    printf("$%'.2Lf\n", 1234.56L);
    printf("$%'.2Lf\n", 123.45L);
    return 0;
} 
```

并运行它：

```
> make example
clang -Wall -Wextra -Werror    example.c   -o example
> ./example 
$123,456,789.00
$1,234.56
$123.45 
```

该程序在我的 Mac (10.6.8) 和我刚刚尝试过的 Linux 机器 (Ubuntu 10.10) 上都可以按照您希望的方式运行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-07-13T21:02:27.950

我知道这是一个很老的帖子，但我今天消失在`man`兔子洞里，所以我想我会记录下我的旅行：

`strfmon()`您可以包含一个名为的函数`monetary.h`来执行此操作，并根据本地或国际标准执行此操作。

请注意，它的工作方式类似于`printf()`，并且将采用与字符串中指定的格式一样多`double`的参数。`%`

它比我这里的要多得多，我发现这个页面是最有帮助的：[https ://www.gnu.org/software/libc/manual/html_node/Formatting-Numbers.html](https://www.gnu.org/software/libc/manual/html_node/Formatting-Numbers.html)

```
#include <monetary.h>
#include <locale.h>
#include <stdlib.h>
#include <stdio.h>

int main(){
    // need to setlocal(), "" sets locale to the system locale
    setlocale(LC_ALL, "");

    double money_amt = 1234.5678;

    int buf_len = 16;
    char simple_local[buf_len];
    char international[buf_len];
    char parenthesis_for_neg[buf_len];
    char specified_width[buf_len];
    char fill_6_stars[buf_len];
    char fill_9_stars[buf_len];
    char suppress_thousands[buf_len];

    strfmon(simple_local, buf_len-1, "%n", money_amt);
    strfmon(international, buf_len-1, "%i", money_amt);
    strfmon(parenthesis_for_neg, buf_len-1, "%(n", money_amt);
    strfmon(specified_width, buf_len-1, "%#6n", money_amt);
    strfmon(fill_6_stars, buf_len-1, "%=*#6n", money_amt);
    strfmon(fill_9_stars, buf_len-1, "%=*#8n", money_amt);
    strfmon(suppress_thousands, buf_len-1, "%^=*#8n", money_amt);

    printf( "===================== Output ===================\n"\
            "Simple, local:                  %s\n"\
            "International:                  %s\n"\
            "parenthesis for negatives:      %s\n"\
            "fixed width (6 digits):         %s\n"\
            "fill character '*':             %s\n"\
            "-- note fill characters don't\n"\
            "-- count where the thousdands\n"\
            "-- separator would go:\n"\
            "filling with 9 characters:      %s\n"\
            "Suppress thousands separators:  %s\n"\
            "================================================\n",
            simple_local, international, parenthesis_for_neg,
            specified_width, fill_6_stars, fill_9_stars,
            suppress_thousands);

    /** free(money_string); */
    return 0;
} 
```

```
===================== Output ===================
Simple, local:                  $1,234.57
International:                  USD1,234.57
parenthesis for negatives:      $1,234.57
fixed width (6 digits):          $  1,234.57
fill character '*':              $**1,234.57
-- note fill characters don't
-- count where the thousdands
-- separator would go:
filling with 9 characters:       $*****1,234.57
Suppress thousands separators:   $****1234.57
================================================ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-27T20:16:37.923

我认为没有 C 函数可以做到这一点，但您可以自己编写吗？说`float price = 23234.45`。先`(int)price`用逗号打印，打印小数点；然后对于小数部分，做`printf("%d", (int)(price*100)%100);`

# javascript - Backbone JST 模板，如何渲染 Rails 部分

> ID：11694904
> 
> 赞同：0
> 
> 时间：2012-07-27T20:01:51.640
> 
> 标签：javascript, ruby-on-rails, backbone.js

我的 JST 模板中的几个选择元素依赖于数据库来填充选择。我可以将部分导轨拉入我的模板吗？做这个的最好方式是什么？

例如这样的部分：

_font_faces.html.haml

```
.font_face
  = select("font", "style", Font.all.collect {|f| [ f.name, f.id ] }) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T19:51:15.990

这个问题的答案是，无论如何，您都不想将这种逻辑放入您的视图中。应该有一个单独的主干集合，一个字体集合，而不是对视图中数据库的调用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T20:36:56.523

如果您命名类似choices.jst.eco.haml 的名称，资产管道将从文件扩展名向后编译文件。因此，HAML 编译器将首先运行，然后是 ECO 编译器，然后是 JST gem 会将所有编译后的代码放入您可以在视图中引用的 JST 对象中。

# android - 缩放和动画到点mapview android

> ID：11694905
> 
> 赞同：0
> 
> 时间：2012-07-27T20:01:55.120
> 
> 标签：android, android-mapview, android-animation

所以在我当前的应用程序中，我想缩放到一个纬度/经度点，但也使用 animateTo （或等效）来确保屏幕正确居中。目前我只是在做这样的事情：

```
_mapController.animateTo(new GeoPoint(googleLat, googleLng));

            // Smooth zoom handler
            int zoomLevel = _mapView.getZoomLevel();
            int targetZoomLevel = AppConstants.MAP_ZOOM_LEVEL_SWITCH;
            long delay = 0;
            while (zoomLevel++ < targetZoomLevel) {
                handler.postDelayed(new Runnable() {
                    @Override
                    public void run() {
                       _mapController.zoomIn();
                    }
                }, delay);

                delay += 350; // Change this to whatever is good on the device
            } 
```

这种工作，但发生的是我的线程开始，在“动画到”完成之前，所以它放大然后“跳跃”以显示正确的中心地理点。有没有办法平滑地“向下钻取”到某个缩放级别，并同时移动到 geoPoint？类似于官方的 Googl eMaps 应用程序如何在您搜索地址后缩放到地址，这就是我想要做的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T20:36:30.183

我会做类似的事情：

```
_mapController.animateTo(new GeoPoint(googleLat,googleLong), new Runnable() {
 public void run()
 {
  _mapController.zoomIn ();
 }
}); 
```

这将实现平移然后缩放的效果。您可以在 runnable 中尝试相同的逻辑来执行多步放大。

# c# - 您如何将对象初始化器用于键值对列表？

> ID：11694910
> 
> 赞同：52
> 
> 时间：2012-07-27T20:02:14.293
> 
> 标签：c#

我无法弄清楚为以下内容进行内联集合初始化的语法：

```
var a = new List<KeyValuePair<string, string>>(); 
```

* * *

## 回答 #1

> 赞同：88
> 
> 时间：2012-07-27T20:10:58.180

请注意，字典集合初始化`{ { key1, value1 }, { key2, value2 } }`取决于 Dictionary 的`Add(TKey, TValue)`方法。您不能将此语法与列表一起使用，因为它缺少该方法，但您可以使用该方法创建一个子类：

```
public class KeyValueList<TKey, TValue> : List<KeyValuePair<TKey, TValue>>
{
    public void Add(TKey key, TValue value)
    {
        Add(new KeyValuePair<TKey, TValue>(key, value));
    }
}

public class Program
{
    public static void Main()
    {
        var list = new KeyValueList<string, string>
                   {
                       { "key1", "value1" },
                       { "key2", "value2" },
                       { "key3", "value3" },
                   };
    }
} 
```

* * *

## 回答 #2

> 赞同：82
> 
> 时间：2012-07-27T20:04:24.060

很简单：

```
var a = new List<KeyValuePair<string, string>>()
{
    new KeyValuePair<string, string>("A","B"),
    new KeyValuePair<string, string>("A","B"),
    new KeyValuePair<string, string>("A","B"),
}; 
```

请注意，您可以在最后一个元素之后留下尾随逗号（可能是因为 .net 创建者希望更轻松地自动生成代码），或者删除`()`列表构造函数的括号并且代码仍然可以编译。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2015-05-04T05:34:45.623

不需要创建子类的另一种选择：

```
List<KeyValuePair<String, String>> list = new Dictionary<String, String>
    {
        {"key1", "value1"},
        {"key2", "value2"},
    }.ToList(); 
```

正如评论中提到的：这种方法的缺点包括可能会丢失排序和无法添加重复的键。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2016-10-18T09:44:36.110

由于这里没有提到集合初始值设定项（C# 6.0）：

**执行**

```
public static class InitializerExtensions
{
   public static void Add<T1, T2>(this ICollection<KeyValuePair<T1, T2>> target, T1 item1, T2 item2)
   {
       if (target == null)
            throw new ArgumentNullException(nameof(target));

        target.Add(new KeyValuePair<T1, T2>(item1, item2));
    }
} 
```

**用法**

```
var list = new List<KeyValuePair<string, string>> { {"ele1item1", "ele1item2"}, { "ele2item1", "ele2item2" } }; 
```

**如何使它工作**

只需`using`在您的文件中包含正确的语句以便`InitializerExtensions`可用（意味着您可以`InitializerExtensions.Add`显式调用），如果您使用的是 VS 2015 或更高版本，则特殊的集合初始化器语法将变得可用。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-07-27T20:08:04.727

任何初始化都由`object(params_if_exist) { any public member or instance};`

铁`var list = new List<int> {1,2,3};`

`var bw = new BackgroundWorker() {WorkerSupportsCancellation = true};`

# javascript - 用Javascript打开另一个jsp页面的方法

> ID：11694911
> 
> 赞同：3
> 
> 时间：2012-07-27T20:02:24.183
> 
> 标签：javascript, html, jsp, redirect

我正在尝试使用 html/javascript 程序中的按钮将某人重定向到我的另一个页面。基本上，我创建了一个 .jsp 页面，该页面为用户提供了一些可供单击的按钮。如果用户单击一个按钮，它会调用一个方法，该方法应该打开我在同一项目下创建的新 .jsp 页面。但是，我不知道如何做到这一点，因为我是 Javascript 和 HTML 的新手。我在下面提供了一个示例：

**示例页面**

```
<html>
<title>Web Page</title>
<body>

    <p>Please click a button to redirect you to the page you wish to go to.</p>

    <br>

    <form>
        <input type="button" id="idname" value = "General Info " onclick="goToInfo()"/><br>
    </form>

    <br>

    <form>
        <input type="button" id="idname" value = "Other Information" onclick="goToOther()"/><br>
    </form>

    <script type="text/javascript">
        function goToInfo(){

        }

        function goToOther(){

        }

        </script>
</body>
</html> 
```

*例如，我的 NetBeans 项目中有另一个名为“GeneralInfo.jsp”的页面，我希望`goToInfo()`能够将该人重定向到该页面。谢谢您的帮助。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-27T20:05:57.087

您可以使用[window.location](https://developer.mozilla.org/en/DOM/window.location)将用户重定向到相应的 JSP 页面；但是，您需要确保以下代码中的路径与您的 JSP 页面的实际路径匹配，这些路径由您的 servlet 映射或基于相对于应用程序的绝对路径。

```
 function goToInfo(){
       window.location = '/GeneralInfo.jsp';
   }

   function goToOther(){
       window.location = '/someOtherJSPPage.jsp';
   } 
```

如果在尝试重定向到 JSP 页面时遇到 404 错误，请尝试将日志记录级别设置为 ALL 或 DEBUG，以便您可以看到来自框架或 Java 容器的日志，这些将有希望向您显示真实的文件路径，以便您然后可以调整 URL 以匹配实际的目标位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T20:08:26.100

当您单击 General Info 按钮时，这应该使用 GeneralInfo.jsp 打开新选项卡。

```
function goToInfo(){
window.location = "GeneralInfo.jsp";
 } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-05-03T06:23:03.617

你可以使用这个方法，

```
 <input type="button" value="General Info" name="INfoPage"
        onclick="document.forms[0].action = 'infoPage.jsp';" /> 
```

或者简单的方法是，

```
<a href="InfoPage.jsp">General Info</a> 
```

# mysql - MySql 中的日历功能

> ID：11694922
> 
> 赞同：0
> 
> 时间：2012-07-27T20:03:15.603
> 
> 标签：mysql, calendar

我有以下 MySql 表：

*   玩家桌 - 所有玩家的东西
*   Master_Task - 可供选择的所有任务
*   Player_Master_Task - 为玩家选择的所有任务
*   Player_Task_Plan - 玩家何时应该执行任务

假设玩家在 Player_Master_Task 中有“刷牙”。

该任务需要每天每天完成 3 次，直到永远。我该如何坚持？基本上我需要日历功能来确定何时应该执行任务。

有什么建议么？

谢谢，

安德鲁

# java - 在 Android 中传递变量

> ID：11694928
> 
> 赞同：0
> 
> 时间：2012-07-27T20:03:57.787
> 
> 标签：java, android, eclipse, variables

我目前在我的 Android 应用中有这个页面：

[![](../Images/25754f951a4d77e7aaab6b204af7f0f0.png)](https://i.stack.imgur.com/p5SNu.png)

我想将添加到这些字段中的数据传递给存储在设备上的 .txt 文件。

下面的代码：

```
<Button
android:id="@+id/Button02"
android:layout_width="match_parent"
android:layout_height="wrap_content"
android:text="@string/btn2" />
<ScrollView android:layout_width="match_parent" android:id="@+id/scrollView1" android:layout_height="wrap_content">
<LinearLayout android:id="@+id/linearLayout1" android:layout_width="match_parent" android:layout_height="match_parent" android:orientation="horizontal">
<TextView android:text="Please insert details below to confirm you have completed and understood the app" android:id="@+id/textView1" android:layout_height="fill_parent" android:layout_width="fill_parent" android:layout_gravity="center_horizontal">
</TextView>
</LinearLayout>
</ScrollView>
        <EditText
            android:id="@+id/editText1"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:ems="10"
            android:text="Forename" >

            <requestFocus />
        </EditText>

        <EditText
            android:id="@+id/editText2"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:ems="10"
            android:text="Surname" />

        <EditText
            android:id="@+id/editText3"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:ems="10"
            android:inputType="number"
            android:text="Staff ID" />

        <Button
            android:id="@+id/buttonformdata"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Submit" />
</LinearLayout> 
```

我相信这叫做 FileWriter？我在我的项目中创建了一个名为“FileWriterExample.java”的.java 文件。我正在努力做的是能够在我的 XML 文件“Screen10.xml”和这个“FileWriterExample”java 文件之间传递数据。

在我的 FileWriterExample 文件中，我有以下代码：

```
package org.example.screens;

import  java.io.File; 
import  java.io.FileWriter; 
import  java.io.IOException;

public class  FileWriterExample  { 

  FileWriter writer; 
  File file;

  public  void  write () { 
    // Create File 
     file =  new  File ( "FileWriterTest.txt" ) ; 
     try  { 
       // new FileWriter (file, true) - if the file already exists 
       // the bytes are written to the end of the file 

       // new FileWriter (file) - if the file already exists 
       // this will overwrite 
       writer =  new  FileWriter ( file, true ) ; 

       // text is written to the stream 
    writer.write (edittext1 +" ") ; 

       // text is written to the stream 
    writer.write (edittext2 +" ") ;

       // text is written to the stream 
    writer.write (edittext3 +" ") ;

       // Write the stream to the file 
       // Should always be run at the end, so that the stream  
       // is empty and everything in the file . stands 
       writer.flush () ; 

       // Closes the stream 
       writer.close () ; 
    }  catch  ( Exception e ) { 
      e.printStackTrace () ; 
    } 
  }

  public static  void  main ( String []  args ) { 
    FileWriterExample fileWriterExample =  new  FileWriterExample () ; 
    fileWriterExample.write () ; 
  } 
} 
```

现在我确定变量是在我编辑文本字段的地方传递的？如何链接变量以使其起作用？如果需要我的项目的代码，我可以上传它，如果这样会更容易。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T21:24:50.947

我假设您希望在用户单击提交按钮时将数据写入文件。您可以在`onClick()`附加到此按钮的侦听器方法中执行此操作，如下所示：

```
try{

FileOutputStream fout = openFileOutput(“yourfile.txt”,MODE_PRIVATE);

OutputStreamWriter osw = new OutputStreamWriter(fOut);

osw.write(editText1.getText().toString()+" ");
osw.write(editText2.getText().toString()+" ");
osw.write(editText3.getText().toString()+" ");

osw.close();

fout.close();

}catch(Exception e){

//do the exception handling
} 
```

如果您打算使用自己的类来处理所有写入和读取，则可以在`onClick()`方法内创建该类的实例并使用适当的参数对其调用读/写方法。

# mysql - 用于从多个大表中创建新表的 sql 语法

> ID：11694931
> 
> 赞同：1
> 
> 时间：2012-07-27T20:04:18.630
> 
> 标签：mysql, sql, phpmyadmin

我是 MySql 和 sql 的新手。我不知道如何执行以下操作：

我有一个包含四个相关*表格*的巴士时刻表数据库：

```
stops (24,403 rows)
-------------------
stop_id   int(11)

stopTimes (12,073,459 rows)
---------------------------
trip_id         varchar(30)
stop_sequence   int(11)     // running sequence within the trip: 1-last
stop_id         int(11)

trips (320,395 rows) 
---------------------------
trip_id   varchar(30)
route_id  int(11)

routes (9,748 rows)
---------------------------
route_id            int(11)
agency_id           int(11)                     
route_short_name    varchar(10) 
```

**关系**

*   **旅行路线：**一对多
*   **到站次数：**一对多
*   **停停次数：**一对一

在这些表中，我想创建一个包含以下字段的新表“routeStops”：

```
routeStops (~100,000 rows)
---------------------------
route_id            int(11)
agency_id           int(11)                     
route_short_name    varchar(10)
stop_id   int(11) 
```

它与停靠点之间存在一对多的关系。

是否有可以执行此操作的**SQL 查询？**

**我应该向route_id**和**stop_id**添加索引以优化性能吗？我应该向trip_id 添加全文索引吗？

我对此很陌生，并会欣赏一些见解。

我正在使用 PHPMyAdmin 和一个相当新的 XAMPP 安装。

tnx,

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T20:53:04.973

像这样的东西应该工作：

```
SELECT r.route_id
     , r.agency_id 
     , r.route_short_name
     , s.stop_id
  FROM stopTimes s
  JOIN trips t
    ON t.trip_id = s.trip_id
  JOIN routes r
    ON r.route_id = t.route_id
 GROUP
    BY r.route_id
     , r.agency_id 
     , r.route_short_name
     , s.stop_id
 ORDER
    BY r.route_id
     , r.agency_id 
     , r.route_short_name
     , s.stop_id 
```

注意：这将消除任何“重复”行；如果您希望返回重复项，则只需删除 GROUP BY 子句。

为了获得此查询的最佳性能，您可能希望覆盖将这些作为索引中的前导列的索引。

```
 ON route (route_id,agency_id,route_short_name)
    ON stopTimes (trip_id, stop_id)
    ON trips (route_id, trip_id) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T21:25:26.117

**是否有可以执行此操作的 SQL 查询？**

[您可以使用INSERT ... SELECT](http://dev.mysql.com/doc/refman/5.5/en/insert-select.html)语法来实现它：

```
INSERT INTO routeStops (route_id, agency_id, route_short_name, stop_id)
SELECT DISTINCT r.route_id, r.agency_id, r.route_short_name, s.stop_id
  FROM routes r
  JOIN trips t ON r.route_id = t.route_id
  JOIN stopTimes s ON t.trip_id = s.trip_id; 
```

**我应该向 route_id 和 stop_id 添加索引以优化性能吗？**

这些应该是他们表中的主键，以及其他表中的外键。

**我应该向trip_id 添加全文索引吗？**

我不推荐它，因为它太慢了。我建议你改变你的表并使用`int`trip_id：

```
CREATE TABLE trips (
  trip_id int(10) unsigned NOT NULL,
  trip_id_old varchar(30) DEFAULT NULL,
  route_id int(11) DEFAULT NULL,
  PRIMARY KEY (trip_id)
) 
```

# javascript - 试图做 JSON.parse 但它不喜欢我对服务器返回的字符串所做的事情

> ID：11694939
> 
> 赞同：0
> 
> 时间：2012-07-27T20:04:49.923
> 
> 标签：javascript, asp.net, json

我试图从我的服务器返回一个字符串，该字符串将被解析为一个 javascript 对象。但是，在解析过程中，我不断收到错误消息。我不知道为什么。也许你知道一些我不知道的事情。

我的字符串如下所示：

```
{{"fname":"bob","lname":"jones"},{...}} 
```

我想做的是像

```
var item = JSON.parse(myString); 
```

它应该制作项目，一个名称数组，所以我可以做类似的事情：

```
for(var i = 0; i < item.length; i++){
    alert(item[i].fname + " " + item[i].lname);
} 
```

我做错了什么吗？上面是一个示例，但下面实际上是代码片段：

```
while (reader.Read())
{
    if (reader["rt_id"] != DBNull.Value && reader["rt_name"] != DBNull.Value)
    {
          t = @"{""pValue"":""{ReportType},"+reader["rt_id"]+@""",""pText"":"""+reader["rt_name"]+@"""}";
          returnContentsArray.Add(t);
    }
}
returnContents = "{" + String.Join(",",returnContentsArray.ToArray()) + "}";
return returnContents; 
```

在客户端：

```
var item = JSON.parse(result); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T20:06:21.543

该字符串不是有效的 JSON。 `{}`表示一个对象，它需要有键。看来您想要一个数组，请`[]`改用。

```
returnContents = "[" + String.Join(",",returnContentsArray.ToArray()) + "]"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T20:09:33.720

您需要使用正确的 JSON 格式。看起来您应该使用的格式是

```
[{"fname":"bob","lname":"jones"},{...}] 
```

这将返回一个对象数组。只需让用户在尝试更改您的 JavaScript 代码之前，您可以在类似的 JSONLint 中验证 JSON。

# ios - 基于定时函数的iOS标签文本

> ID：11694943
> 
> 赞同：0
> 
> 时间：2012-07-27T20:05:05.080
> 
> 标签：ios, nsstring, nstimer, nsinteger

我一直在尝试创建一个脚本，该脚本设置一个计时器并在每次运行时将一个值减少 33。理论上，计时器应该在 6 次运行后自行停止，但它会继续运行并达到负值。是否有一个原因？

```
-(void)checkValue:(NSTimer *)myTimer{

    if(pplint > 0){
        pplint = pplint-33;
        NSString *ppllefttext = [NSString stringWithFormat:@"%d", pplint];
        peopleleft.text = ppllefttext;
        NSLog(@"Reduced Timer");   
    }
    if(pplint < 0){
        NSLog(@"Stop Timer");
        [myTimer invalidate];
    }
}

- (IBAction)gotocongrats{
    pplint = 198;
    NSString *ppllefttext = [NSString stringWithFormat:@"%d", pplint];
    peopleleft.text = ppllefttext;
    NSTimer * myTimer = [NSTimer scheduledTimerWithTimeInterval:1
                                                     target:self
                                                   selector:@selector(checkValue:)
                                                   userInfo:nil
                                                    repeats:YES];
    NSLog(@"Started Timer");
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T20:26:01.323

我拿了你的代码并对其进行了一些编辑，它对我来说很好用。

```
-(void)checkValue:(NSTimer *)myTimer{

if(pplint > 0){
    pplint = pplint-33;

    NSLog(@"%i",pplint);
    NSLog(@"Reduced Timer");   
}
if(pplint <= 0){
    NSLog(@"Stop Timer");
    [myTimer invalidate];
    }
}

- (IBAction)gotocongrats{
pplint = 198;

NSTimer * myTimer = [NSTimer scheduledTimerWithTimeInterval:1
                                                     target:self
                                                   selector:@selector(checkValue:)
                                                   userInfo:nil
                                                    repeats:YES];
NSLog(@"Started Timer");
} 
```

# java - 将按钮高度和宽度设置为包装内容并填充父项

> ID：11694945
> 
> 赞同：6
> 
> 时间：2012-07-27T20:05:11.233
> 
> 标签：java, android, height, width

我正在开发一个应用程序，用户应该能够通过按下其他按钮来改变按钮的外观。我使用四个按钮将高度设置为包装内容，高度设置为填充父项，宽度设置为包装内容，宽度设置为填充父项。

我用谷歌搜索了一下，找到了一个使用 LayoutParams 的解决方案，尽管该代码没有指定宽度的高度是否被改变。我也收到错误消息，说我的 IDE 无法识别“LayoutParams”。做这个的最好方式是什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-27T20:29:10.677

您需要寻找的是 View.ViewGroup.LayoutParams。每个 LayoutParams 都有 MATCH_PARENT 和 WRAP_CONTENT 属性的常量值。我准备了简单的代码示例，您可以使用：

活动：

```
package com.example.stack2;

import android.app.Activity;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.view.ViewGroup.LayoutParams;
import android.widget.Button;

public class MainActivity extends Activity implements OnClickListener{

    Button test;
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        Button b = (Button)findViewById(R.id.button1);
        b.setOnClickListener(this);
        b = (Button)findViewById(R.id.button2);
        b.setOnClickListener(this);
        b = (Button)findViewById(R.id.button3);
        b.setOnClickListener(this);
        b = (Button)findViewById(R.id.button4);
        b.setOnClickListener(this);
        test = (Button)findViewById(R.id.test);
    }
    public void onClick(View v)
    {
        LayoutParams lp = test.getLayoutParams();
        if(v.getId() == R.id.button1)
        {
            lp.height = LayoutParams.WRAP_CONTENT;
        }else if(v.getId() == R.id.button2){
            lp.width = LayoutParams.WRAP_CONTENT;
        }else if(v.getId() == R.id.button3){
            lp.height = LayoutParams.MATCH_PARENT;
        }else if(v.getId() == R.id.button4){
            lp.width = LayoutParams.MATCH_PARENT;
        }
        test.setLayoutParams(lp);
    }
} 
```

布局xml：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <LinearLayout 
        android:layout_height="wrap_content"
        android:layout_width="match_parent"
        android:orientation="horizontal">

        <Button
            android:id="@+id/button1"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="h_wc" />

        <Button
            android:id="@+id/button2"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="w_wc" />

        <Button
            android:id="@+id/button3"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="h_fp" />

        <Button
            android:id="@+id/button4"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="h_fp" />

    </LinearLayout>

    <Button
        android:id="@+id/test"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="test" />

</LinearLayout> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-27T20:19:38.060

通过使用下面的代码，您可以轻松地动态更改高度和宽度。

```
btn = new Button(Activity.this);
btn.setLayoutParams(new LinearLayout.LayoutParams(LayoutParams.FILL_PARENT,     LayoutParams.WRAP_CONTENT));

btn.setText("\t\t" + lbl + "\t\t\t  ");
        btn.setBackgroundResource(R.drawable.blue_button);
btn.setwidth(100); 
```

# c# - 在进程之间传输套接字？

> ID：11694948
> 
> 赞同：2
> 
> 时间：2012-07-27T20:05:32.483
> 
> 标签：c#, sockets, process, transfer

> **可能重复：**
> [在应用程序c#之间发送一个套接字](https://stackoverflow.com/questions/7359330/send-a-socket-between-applications-c-sharp)

是否有可能以某种方式在进程之间传输连接的套接字？

我拥有的是一台服务器，带有连接的套接字（TCP）。有时我需要重新启动程序，但是当您重新启动时，所有连接都断开了，因此所有连接的用户都必须重新连接。

是否可以将这些连接“转移”到不同的进程，以便我可以重新启动主程序，然后将套接字连接移回主程序？类似于使命召唤游戏中的“主机迁移”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T20:09:46.877

Socket.DuplicateAndClose方法将[套接字](http://msdn.microsoft.com/en-us/library/system.net.sockets.socket.duplicateandclose.aspx)转换为可以传递给另一个进程的形式，该进程随后可以打开套接字。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T20:09:44.413

（CoD :) 好笑......你的手柄是什么？有时间我们会玩）

无论如何，不​​是真的......除非您对客户端进行编码以处理异常并根据需要重新连接。或者，您可以在主机前面安装一个负载平衡路由器。想到 WCF 对等网络。

# windows - Windows 如何在示例图片上对真实文件名进行秘密隐藏？

> ID：11694949
> 
> 赞同：1
> 
> 时间：2012-07-27T20:05:45.730
> 
> 标签：windows, windows-shell

在 Windows 7 和更早的版本中，当您安装名为“Voorbeeld Afbeelding”的操作系统时，会有一个文件夹，荷兰语或翻译为“示例图像”。没什么普通的，我经常将它用作虚拟图像。

今天我正在用我的母语荷兰语制作一台机器，其中一个文件名为“Woestijn.jpg”。如果我转到一个上传表单，它会在浏览到名为“Desert.jpg”的文件后告诉我。在文件的属性中，没有关于英文翻译等的内容。

使用命令行列出此目录中的文件，它会告诉英文/真实名称，但在文件资源管理器中它不会显示它的迹象。

我在谷歌上找不到任何关于它的信息。那里有一些关于人们在删除此文件夹中的文件时遇到错误的链接，我猜是因为奇怪的名称 hack (http://forums.adobe.com/message/2862994)。

Windows 程序员是否使用了一些秘密符号链接来制作这些文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T13:16:02.340

可能是 Windows 区域设置没有完全应用。沙漠这个词是一个英语单词，而 Woestijn 是一个荷兰语单词，相当于沙漠这个词。

简而言之：Woestijn（荷兰语）=== Desert（英语）

因此，Windows 资源管理器可能会以您的母语（荷兰语）显示内容，而对话框和命令提示符仍在使用 Windows 操作系统的默认语言（英语）。

# html - CSS3 动画防止继承

> ID：11694950
> 
> 赞同：1
> 
> 时间：2012-07-27T20:05:46.820
> 
> 标签：html, css, css-animations

我有一个放大 div 框的 CSS3 动画。此 div 包含一个子元素“p”-tag。当我在div框上设置动画类时，p标签继承了动画。但我只想在父 div 元素而不是子元素上运行动画。

如何防止动画（-webkit-animation）继承？我试图在孩子上设置 -webkit-animation:none 但它不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T20:13:01.977

您可以尝试在 div 上使用 JQuery 动画（在您的情况下为高度，宽度），以便您可以选择要设置动画的特定元素

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T20:20:08.317

没有孩子`p`的动画，因为孩子`p`在`div`. 渲染上只有一个动画`div`。您可以尝试`p`使用 css 隐藏孩子：

```
div#yourDivId p {
    display: none;
    visibility: hidden;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-28T13:19:57.440

现在它可以工作了：http: [//jsfiddle.net/fiddly/FwHZn/1/](http://jsfiddle.net/fiddly/FwHZn/1/)

我必须设置“p”标签的宽度。否则动画将应用于 div 和 p 标签。

# android - 如何从我的计算机上接收来自 android 应用程序的数据

> ID：11694952
> 
> 赞同：0
> 
> 时间：2012-07-27T20:05:48.410
> 
> 标签：android, web-services

我必须通过互联网连接将我的 Android 设备连接到我的电脑。我该怎么做呢？创建应用程序与之对话的网络服务？（但是如何在我的计算机上接收来自 web 服务的数据？）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T20:21:48.553

你在正确的轨道上。查找 REST API。您可以在云中的某个地方运行 Web 服务，让 Android 和 PC 作为客户端连接，或者您可以在您的 PC 上放置一个 LAMP 堆栈并在那里运行 Web 服务器和数据库。

如果您允许直接 USB 连接，那么您也可以使用 ADB 或 Android 文件传输来获取数据，甚至无需直接使用您的应用程序。

# makefile - 递归调用另一个makefile后的奇怪行为

> ID：11694956
> 
> 赞同：0
> 
> 时间：2012-07-27T20:06:00.297
> 
> 标签：makefile, gnu-make, multiple-makefiles

我在项目的根目录中有一个主生成文件。*在包含*目录中还有另一个 makefile 。第二个 makefile 使用 include 关键字在我无法控制的其他项目中调用其他一些 makefile。我不能直接包含这个makefile，因为它有一些与我拥有的目标同名的目标。作为一种解决方法，我决定使用递归调用。当我通过 shell 运行这个 makefile 时，使用以下命令，它运行良好：

```
my_project$ make -C include -f Second_Makefile 
```

但是当我如下通过主 Makefile 调用它时，它的行为不正常，这意味着它报告了一些项目特定的错误，这些错误源于第二个 makefile 中包含的文件，这些文件很难找到。

```
all:
    @$(MAKE) -C include -f Second_Makefile 
```

我也尝试了以下行，但没有帮助：

```
cd include; @$(MAKE) -f Second_Makefile 
```

我认为递归调用和直接调用之间应该有区别，但我不知道它是什么。

# javascript - Javascript嵌套数组转换

> ID：11694958
> 
> 赞同：1
> 
> 时间：2012-07-27T20:06:10.670
> 
> 标签：javascript

我试图了解 Javascript 数组函数。我有一个像这样的嵌套数组，其中每一行都覆盖相同的时间段：

```
[{
    "category": "fruit",
    "variety": "apple",
    "data": [{
        "day": 1,
        "units": 2
    }, {"day": 2,
        "units": 4
    }]
},{
    "category": "fruit",
    "variety": "orange",
    "data": [{
        "day": 1,
        "units": 3
    }, {"day": 2,
        "units": 5
    }]
},{
    "category": "veg",
    "variety": "tomato",
    "data": [{
        "day": 1,
        "units": 4
    }, {"day": 2,
        "units": 2
    }]
}] 
```

我想按类别按天对单位求和，以获得这样的数组：

```
[{
    "category": "fruit",
    "data": [{
        "day": 1,
        "units": 5
    }, {"day": 2,
        "units": 9
    }]
},{
    "category": "veg",
    "data": [{
        "day": 1,
        "units": 4
    }, {"day": 2,
        "units": 2
    }]
}] 
```

我一直在通过长循环 if 语句来解决这个问题，并对其进行一些散列。你能看到一个优雅的方法来解决这个问题吗？

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T20:29:52.943

解决方案非常明显：遍历数组，并将数据存储在键值对中。然后，遍历 has，并使用[`Array.prototype.map`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/map). 最后，如果您想要一个格式良好的 JSON 字符串，请使用[`JSON.stringify(result, null, 4);`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/JSON/stringify)，其中`4`是用于漂亮格式的间隔数。

演示：http: [//jsfiddle.net/jde6S/](http://jsfiddle.net/jde6S/)

```
var list = [ ... ];
var hash = {};
for (var i=0; i<list.length; i++) {
    var obj = list[i];

    // This part makes sure that hash looks like {fruit:[], veg: []}
    var hashObjCat = hash[obj.category];
    if (!hashObjCat) {
        hashObjCat = hash[obj.category] = {};
    }

    // This part populates the hash hashObjCat with day-unit pairs
    for (var j=0; j<obj.data.length; j++) {
        var data = obj.data[j];
        if (hashObjCat[data.day]) hashObjCat[data.day] += data.units;
        else hashObjCat[data.day] = data.units;
    }
}
// Now, we hash looks like {fruit: {1:5, 2:9} }
// Construct desired object
var result = Object.keys(hash).map(function(category) {
    // Initial object
    var obj = {category: category, data:[]};
    var dayData = Object.keys(hash[category]);
    // This part adds  day+units dicts to the data array
    for (var i=0; i<dayData.length; i++) {
        var day = dayData[i];
        var units = hash[category][day];
        obj.data.push({day: day, units: units});
    }
    return obj;
});
// Test:
console.log(JSON.stringify(result, null, 4)); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-27T20:37:57.123

[将数组减少](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/Reduce)为一个对象（有关如何使用循环执行此操作，请参阅@RobW 的答案）：

```
var data = [...] // your input 

// Iterate the data with reduce...
var sumsbycategory = data.reduce(function(map, fruit) {
    var cat = fruit.category;
    // set an property to an object, iterating the days array...
    map[cat] = fruit.data.reduce(function(sums, day) {
        var d = day.day;
        // set or update the units for this day
        sums[d] = (sums[d] || 0) + day.units;
        return sums; // into the next iteration
    }, map[cat] || {}) // ...passing in the already existing map for this cat or a new one
    return map; // into the next iteration
}, {}); // ...passing in an empty object 
```

现在我们有以下格式：

```
{"fruit":{"1":5,"2":9},"veg":{"1":4,"2":2}} 
```

...我认为这更容易处理，但让我们构建你的数组：

```
var result = []; // init array
for (var cat in sumsbycategory) { // loop over categories
    var data = []; // init array
    // add category object:
    result.push({category:cat, data:data});
    for (var day in sumsbycategory[cat]) // loop over days in category
         // add day object
         data.push({day:day, units:sumsbycategory[cat][day]});
} 
```

可是等等！一个对象没有顺序，它可能发生在结果数组的`day2`前面`days1`（这可能会破坏您的应用程序？）因此，您可以在该对象的[键上使用](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Object/keys)[映射](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/map)，该键也可以在之前[排序](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/sort)，以生成一个数组干净利落的表达：

```
var result = Object.keys(sumsbycategory).map(function(cat) {
    return {
        category: cat,
        data: Object.keys(sumsbycategory[cat])
         .sort(function numbercompare(a,b){ return a-b; })
         .map(function(day) {
            return {
                day: day,
                units: sumsbycategory[cat][day]
            };
        })
    };
}); 
```

结果：

```
[{
  "category": "fruit",
  "data": [{"day":"1","units":5},{"day":"2","units":9}]
 },{
  "category": "veg",
  "data": [{"day":"1","units":4},{"day":"2","units":2}]
}] 
```

（[在 jsfiddle.net 上的演示](http://jsfiddle.net/tNEd7/)）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-27T20:12:07.400

如果您愿意获取一些外部代码并使用它来重新索引您的结构，您可能会做一些事情。我知道旧的 dojo 数据 api 使用起来很混乱，但可以允许您似乎在问什么。

就我个人而言，我会坚持使用循环，只是保持你的变量名可读。还要记住，对象字面量可以用数组/哈希语法 x[y] 或点语法 xy 来寻址

# powershell - 在powershell中保留文件夹结构的同时复制文件的正确方法是什么？

> ID：11694961
> 
> 赞同：4
> 
> 时间：2012-07-27T20:06:29.937
> 
> 标签：powershell, copy

我似乎永远无法做到这一点。

我有一个现有文件夹`c:\MyApps\Websites\MySite`，其中已经运行了一个现有网站。我已经下载了位于`c:\temp\MySite\artifacts`.

当我尝试运行它时

```
$source "c:\temp\MySite"
$destination "c:\MyApps\Websites\MySite"
copy-item $source $destination -recurse -force 
```

如果`c:\MyApps\Websites\MySite`已经存在，那么它会尝试将它放入`c:\MyApps\Websites\MySite\artifacts`，但如果它不存在，它会正确复制它。不知道这里发生了什么。有什么建议么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-27T20:37:52.840

只需使用`robocopy`命令。它**是**为这种事情而设计的。

`robocopy $source $destination /E`

它随 Windows 7 一起提供，所以它是一个内部命令，所以它仍然是一种“Powershell”方式，恕我直言，但如果你想使用复制命令，那么你非常接近，但你当前的实现会抓取`source`文件夹并将它在里面`target`（即结果是`C:\target\source\files`，不是`C:\target\files`）。当你想让 inside`target`看起来像 inside 时`source`，你需要这样做：

`cp C:\source\* C:\target -r -fo`

注意`*`，这会抓取文件夹的**内容**。`source`如果你想`target`先被清除，就`rm -r -fo C:\target\*`在复制之前做。

**Powershell 不处理长路径，因此如果您有长文件名或深文件夹，则无论如何都需要使用 robocopy。**

# c# - 在 MVVM 中使用自定义 ItemTemplate 将对象列表绑定到 ItemsControl

> ID：11694967
> 
> 赞同：0
> 
> 时间：2012-07-27T20:06:59.417
> 
> 标签：c#, wpf, data-binding, grouping, itemscontrol

# 当前设置

我有一个代表安装程序文件的自定义类和关于该文件的一些属性，符合以下接口

```
public interface IInstallerObject
{
    string FileName { get; set; }
    string FileExtension { get; set; }
    string Path { get; set; }
    int Build { get; set; }
    ProductType ProductType { get; set; }
    Architecture ArchType { get; set; }
    bool Configurable { get; set; }
    int AverageInstallTime { get; set; }
    bool IsSelected { get; set; }
} 
```

我`ViewModel`有一个`ReadOnlyObservableCollection<IInstallerObject>`名为`AvailableInstallerObjects`.

My`View`有一个`GroupBox`包含`ItemsControl`绑定到上述属性的 。

```
 <GroupBox Header="Products">
        <ItemsControl ItemsSource="{Binding Path=AvailableInstallerObjects}">
            <ItemsControl.ItemTemplate>
                <DataTemplate>
                    <StackPanel Orientation="Horizontal">
                        <CheckBox IsChecked="{Binding Path=IsSelected}"
                                  VerticalAlignment="Center" Margin="5"/>
                        <TextBlock Text="{Binding Path=FileName}" Margin="5" />
                    </StackPanel>
                </DataTemplate>
            </ItemsControl.ItemTemplate>
        </ItemsControl>
    </GroupBox> 
```

绑定工作正常，除了它不是用户友好的。显示了 100 多个项目。

# 在这里需要帮助

我希望能够使用我的`IInstallerObject`s 集合，但`View`现在它们具有以下`ItemTemplate`结构。

```
 <GroupBox Header="Products">
        <ItemsControl ItemsSource="{Binding Path=AvailableInstallerObjects}">
            <ItemsControl.ItemTemplate>
                <DataTemplate>
                    <StackPanel Orientation="Horizontal">
                        <CheckBox IsChecked="{Binding Path=IsSelected}"
                                  VerticalAlignment="Center" Margin="5"/>
                        <TextBlock Text="{Binding Path=ProductType}" Margin="5" />
                        <ComboBox ItemsSource="{Binding Path=Build}" />
                    </StackPanel>
                </DataTemplate>
            </ItemsControl.ItemTemplate>
        </ItemsControl>
    </GroupBox> 
```

基本上我希望能够按`ProductType`属性进行分组，显示可用产品的列表，其中表示 .s的`ComboBox`可用`Build`属性值。`IInstallerObject``ProductType`

我可以使用`LINQ`in`ViewModel`来提取分组，但我不知道如何绑定到我提取的内容。

我的研究还发现了使用 a 的可能性，`CollectionViewSource`但我不确定如何将它应用到我当前的设置中。

*我提前感谢您的帮助。我愿意学习，所以如果我忽略了一些明显的东西，请引导我查看信息，我很乐意自学。*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T22:04:06.513

您的问题的描述使我相信您正在寻找某种折叠/扩展/分组/树视图之类的东西。

树视图的 XAML

```
<Window x:Class="WPFLab12.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:loc="clr-namespace:WPFLab12"
        Title="MainWindow" Height="350" Width="525">
    <Grid>
      <GroupBox Header="Products">
        <TreeView ItemsSource="{Binding Path=ProductTypes}">
            <TreeView.Resources>
                <HierarchicalDataTemplate 
                    DataType="{x:Type loc:ProductType}"
                    ItemsSource="{Binding AvailableInstallerObjects}">
                    <TextBlock Text="{Binding Description}" />
                </HierarchicalDataTemplate>
                <HierarchicalDataTemplate DataType="{x:Type loc:InstallerObject}">
                    <StackPanel Orientation="Horizontal">
                        <CheckBox IsChecked="{Binding Path=IsSelected}" 
                                  VerticalAlignment="Center" Margin="5"/>
                        <TextBlock Text="{Binding Path=FileName}" Margin="5" />
                    </StackPanel>
                </HierarchicalDataTemplate>
            </TreeView.Resources>
        </TreeView>
      </GroupBox>
    </Grid>
</Window> 
```

那有什么作用？好吧，它根据找到的数据类型在树中建立了控制层次结构。第一个`HierarchicalDataTemplate`处理如何显示每个类的数据，以及它们在层次结构中的关系。第二个`HierarchicalDataTemplate`处理如何显示每个`InstallerObject`.

主窗口背后的代码：

```
public partial class MainWindow : Window
{
    public ReadOnlyObservableCollection<ProductType> ProductTypes
    {
        get { return (ReadOnlyObservableCollection<ProductType>)GetValue(ProductTypesProperty); }
        set { SetValue(ProductTypesProperty, value); }
    }

    // Using a DependencyProperty as the backing store for ProductTypes.  This enables animation, styling, binding, etc...
    public static readonly DependencyProperty ProductTypesProperty =
        DependencyProperty.Register("ProductTypes", typeof(ReadOnlyObservableCollection<ProductType>), typeof(MainWindow), new UIPropertyMetadata(null));

    public MainWindow()
    {
        this.InitializeComponent();

        this.ProductTypes = new ReadOnlyObservableCollection<ProductType>(
            new ObservableCollection<ProductType>()
            {
                new ProductType() 
                { 
                    Description = "Type A",
                    AvailableInstallerObjects = new ReadOnlyObservableCollection<InstallerObject>(
                        new ObservableCollection<InstallerObject>()
                        {
                            new InstallerObject() { FileName = "A" },
                            new InstallerObject() { FileName = "B" },
                            new InstallerObject() { FileName = "C" },
                        })
                },

                new ProductType() 
                { 
                    Description = "Type B",
                    AvailableInstallerObjects = new ReadOnlyObservableCollection<InstallerObject>(
                        new ObservableCollection<InstallerObject>()
                        {
                            new InstallerObject() { FileName = "A" },
                            new InstallerObject() { FileName = "D" },
                        })
                }
            });

        this.DataContext = this;
    }
} 
```

不过，这完全是作弊 - 通常`MainWindow.cs`不会用作 DataContext 并拥有所有这些东西。但是对于这个例子，我只是让它列出一个s 并用实例`ProductType`填充每个`ProductType`类。`InstallerObject`

我使用的类，注意我做了一些假设并修改了你的类以更好地适应这个视图模型：

```
public class InstallerObject
{
    public string FileName { get; set; }
    public string FileExtension { get; set; }
    public string Path { get; set; }
    public int Build { get; set; }
    public bool Configurable { get; set; }
    public int AverageInstallTime { get; set; }
    public bool IsSelected { get; set; }
}

public class ProductType
{
    public string Description { get; set; }
    public ReadOnlyObservableCollection<InstallerObject> AvailableInstallerObjects
    {
        get;
        set; 
    }
    public override string ToString()
    {
        return this.Description;
    }
} 
```

因此，在 MVVM 中，在我看来，您当前的`InstallerObject`课程更像是模型层之类的东西。您可能会考虑在您的 ViewModel 中将其转换为一组更易于在您的视图中管理的集合类。ViewModel 中的想法是对事物进行建模，类似于它们将如何被查看和交互。将您的平面列表转换`InstallerObjects`为新的分层数据集合，以便更轻松地绑定到视图。

有关使用和自定义 TreeView 的各种方式的更多信息：http: [//www.codeproject.com/Articles/124644/Basic-Understanding-of-Tree-View-in-WPF](http://www.codeproject.com/Articles/124644/Basic-Understanding-of-Tree-View-in-WPF)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T20:34:13.457

您所要做的就是`CollectionViewSource`在您的视图中声明 a 并将其绑定到`ObservableCollection`. 在此对象中，您声明一个或多个`GroupDescriptions`，它将​​源分成几组。

将此源绑定到列表框，为组描述创建一个模板，您就完成了。

可以在此处找到示例：[WPF 示例系列 - 列表框分组、排序、小计和可折叠区域](http://karlshifflett.wordpress.com/2009/06/10/wpf-sample-series-listbox-grouping-sorting-subtotals-and-collapsible-regions/)。更多关于 CollectionViewSource 的信息可以在这里找到：[WPF 的 CollectionViewSource](http://bea.stollnitz.com/blog/?p=387)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-27T20:28:28.760

如果 Build 应该是一个集合类型。

所以你的班级应该像这样作为一个例子。

```
Public Class Customer
 Public Property FirstName as string
Public Property LastName as string
Public Property CustomerOrders as observableCollection(OF Orders)
End Class 
```

这应该会给你预期的结果。主项目展示器中的每个项目将显示绑定到该客户订单的名字姓氏和组合框。我知道这很简单，但这应该可以。

# c++ - 模板实例化上的 C++11 样式 SFINAE 和函数可见性

> ID：11694970
> 
> 赞同：2
> 
> 时间：2012-07-27T20:07:10.520
> 
> 标签：c++, templates, c++11, sfinae, argument-dependent-lookup

我不确定这是否与 sfinae 有任何关系，或者只是与任何模板化函数相关的东西。我正在尝试使用 sfinae 基于相应自由函数的存在来启用/禁用成员函数，而该自由函数又根据另一种类型的成员函数的存在来启用/禁用，所有这些都使用[此处](https://stackoverflow.com/a/9154394/1554020)描述的方法：

```
struct S;

template <typename T>
inline auto f(S& s, T const& t)
   -> decltype(t.f(s), void())
{
   t.f(s);
}

struct S
{
    template <typename T>
    auto f(T const& t)
        -> decltype(f(*this, t), void())
    {
        f(*this, t); // <------------------------------------------- HERE
    }
};

struct pass
{
    void f(S&) const
    {
        //...
    }
};

struct fail
{
};

int main()
{
    S s;
    s.f(pass()); // should compile fine
    //s.f(fail()); // should fail to compile due to absence of f from S
    return 0;
} 
```

但是 gcc 4.7.1 在箭头标记的行上给了我这个：

> 错误：没有用于调用“S::f(S&, const pass&)”的匹配函数
> 注意：候选是：
> 注意：模板 decltype ((f((* this), t), void())) S::f (const T&)
> 注意：模板参数推导/替换失败：
> 注意：候选人需要 1 个参数，提供 2 个

这显然意味着`f`上面的全局不被考虑用于重载解决方案。

为什么会这样，我该怎么做才能做到这一点？

另外为什么上面两行没有错误，`f`在 decltype 中以类似的方式使用？

**更新**

正如@nm 所说，成员函数完全隐藏自由函数，即使它们的签名不同，所以这里有一个不会破坏 ADL 的解决方法`f`（与 @nm 建议的全名限定不同）。`f_dispatcher`在没人会看到的地方（）创建自由函数（`detail`），并在里面完全限定它的名字`S::f`。在该函数中调用 free`f`并让 ADL 从那里开始处理它，如下所示：

```
struct S;

template <typename T>
inline auto f(S& s, T const& t)
    -> decltype(t.f(s), void())
{
    t.f(s);
}

namespace detail
{
    template <typename T>
    inline auto f_dispatcher(S& s, T const& t)
        -> decltype(f(s, t), void())
    {
        f(s, t);
    }
}

struct S
{
    template <typename T>
    auto f(T const& t)
        -> decltype(detail::f_dispatcher(*this, t), void())
    {
        detail::f_dispatcher(*this, t);
    }
};

struct pass
{
    void f(S&) const
    {
        //...
    }
};

struct fail
{
};

int main()
{
    S s;
    s.f(pass()); // compiles fine
    //s.f(fail()); // fails to compile due to absence of f from S
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-27T20:24:21.057

这与 SFINAE 或模板或 C++11 或 ADL 无关。

无论类型如何，成员都会*隐藏*所有具有相同名称的非成员。如果你有一个成员 named `f`，你不能引用任何非成员 named `f`，除非你使用一个限定名（例如`::f`）。

只需使用`::f(*this, t);`.

# java - 为 Web 应用程序单点登录选择 Kerberos (SPNEGO) Java 库

> ID：11694975
> 
> 赞同：5
> 
> 时间：2012-07-27T20:07:30.900
> 
> 标签：java, single-sign-on, kerberos, spnego

我目前正致力于在我们的 Java Web 应用程序中实现企业身份验证机制，包括单点登录。Windows 网络是我们的主要目标，而 Kerberos 听起来是一个合理的选择。旁注：据我了解，Web（HTTP）环境中使用的 SSO 协议是 SPNEGO，它基本上是 Kerberos 的包装器。因此，听起来 Kerberos HTTP SSO 库实际上正在使用 SPNEGO——如果我错了，请纠正我。

当我开始研究这个话题时，我意识到没有明显的选择。让我列出这些：

1.  [Spring 安全 Kerberos/SPNEGO 扩展](http://static.springsource.org/spring-security/site/extensions/krb/index.html)。这是我第一次看到（因为我们已经在使用 Spring 安全性），但几年前它似乎停留在 v1.0.0 的第二个里程碑。只有这个[SO question](https://stackoverflow.com/questions/11040883/spring-security-kerberos-extension-for-production-use)略微希望它可以用于生产。
2.  [WAFFLE - Windows 身份验证功能框架](http://dblock.github.com/waffle/)。似乎很活跃，功能丰富。它可以“插入”为通用 servlet，也可以作为[Spring 安全过滤器](http://code.dblock.org/single-sign-on-spring-security-negotiate-filter-kerberos-ntlm-wwaffle)。
3.  [SPNEGO SourceForge](http://spnego.sourceforge.net/index.html)。看起来很轻量级，提供HTTP Servlet过滤器，教程很容易上手。

选择一个选项而不是另一个选项有什么特别的理由吗？周围还有其他选择吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-28T06:41:24.987

首先，你的假设是正确的。您需要 SPNEGO 才能使用 HTTP 执行 SSO。

1.  这只能在 Spring 中合理使用。如果你有它，就得到它。我们使用它超过两年。做它的工作。
2.  这仅适用于 Windows。
3.  使用与 Spring 相同的 JGSS，但与框架无关。这似乎工作得很好。

如果您使用的是 Tomcat 7，则已经有内置支持。我已经捐赠了适当的代码。你应该明确你的期望。如果您没有期望，但身份验证使用 3 或 1 和 Spring。

# c++ - 通过引用另一个类方法来传递向量成员变量

> ID：11694976
> 
> 赞同：1
> 
> 时间：2012-07-27T20:07:31.140
> 
> 标签：c++, reference

注意：我在我的问题中使用伪代码

假设我有一个名为 circle 的类，带有一个名为 circle.h 的接口，我也有一个名为 readdata 的方法，但这是在另一个名为 rectangle 的类中定义的（rectangle.h 是接口）我想在我的圈子中调用方法 readdata类并传入我的私有成员变量，它是一个向量。如何才能做到这一点？通过引用另一个类来传递 PRIVATE 成员变量是否正确。这是否违背了拥有私有成员变量的全部目的，因为现在我让类矩形访问圆形类向量变量，因为我通过引用传递它。这是我的做法（伪代码）

```
circle.h

private:
vector<struct> vect;

public:
dataread()

circle.cpp

rectangle.h

readdata(vector &)

method dataread() //class method to fill up my struct
{
 rectangle::readdata(vect);   //i call rectangle readdata method but i
 pass in a reference to my memebr variable....is this safe?
} 
```

我应该只在本地声明向量（在 dataread 方法中）并将其分配给参考吗？任何帮助将不胜感激。现在它可以编译，但有人告诉我这不是好的编程习惯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T20:26:13.057

There is nothing wrong with passing references to private members to methods in other classes. For example:

```
void myClass::myMethod() {
    std::copy(myVector1.begin(), myVector1.end(), myVector2.begin());
} 
```

While that doesn't pass a reference to myVector1 directly, it does pass a writable iterator which is just about the same thing. The class is making a request for some object/function to do something with its data. So long as that other object/function only does what it is supposed to do, there's no problem.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T20:18:45.913

我想我明白你在问什么。是的，您可以传递对您的私人数据的引用，不，您不应该这样做。您可以传递一个 const 引用，这样它就不能被修改或传递一个复制了内容的新向量。最好弄清楚为什么你需要这样做，然后找出在那里获取数据的最佳方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-27T20:21:05.527

将指针传递给“私有内存区域”不一定违反封装思想，因为拥有该内存区域的对象决定允许访问谁。它不允许“任何人访问它”。另一方面，这看起来不太自然。

您应该从 readdata 方法返回一个指针并在您的 circle 实例中使用它。同时，这样做违反了我个人使用的一项原则：分配内存的人对它负责，因此它也应该是在适当的时候释放它的人。考虑到这一点，返回实际向量而不是指向它的指针可能是一个好主意（但这意味着复制大量内存以防您不使用具有“返回值优化”的编译器）。

# javascript - 用里面的脚本设置innerHTML

> ID：11694977
> 
> 赞同：7
> 
> 时间：2012-07-27T20:07:37.020
> 
> 标签：javascript, firebug, innerhtml

如果我在任何页面上的 Firebug 中运行以下行：

```
document.documentElement.innerHTML="<script>alert(1)</script>"; 
```

为什么`alert`命令没有执行？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-27T20:26:38.320

It looks like that your `<script>` tag *is* being added as you expect, but the code within it is not being executed. The same failure happens if you try using `document.head` (or *any* other DOM element, it seems). For whatever reason (possibly standards compliance, possible security), inline code inside of `<script>` blocks that are added via `.innerHTML` simply doesn't run.

However, I do have working code that produces similar functionality:

```
var script = document.createElement('script');
script[(script.innerText===undefined?"textContent":"innerText")] = 'alert(1);';
document.documentElement.appendChild(script); 
```

Here, you add the `<script>` block with `documentElement.appendChild` and use `textContent` or `innerText` to set the content of the `<script>`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T20:17:01.507

实际上您可以使用`eval`，但这不是解决安全问题的好习惯。你可以这样做：

```
var scr = document.createElement('script');
scr.src = 'yourscriptsource';
document.body.appendChild(scr); 
```

希望能帮助到你！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-06-16T16:27:36.533

最好使用创建元素并附加它们，而不是使用 innerhtml 直接插入任何 html。

你可以在这里阅读更多关于它的信息：[https ://www.owasp.org/index.php/DOM_based_XSS_Prevention_Cheat_Sheet](https://www.owasp.org/index.php/DOM_based_XSS_Prevention_Cheat_Sheet)

此片段有效：

```
var newScript = document.createElement( "script" );
newScript.type = 'text/javascript';
var scriptContent = document.createTextNode( "googletag.cmd.push( function() { googletag.display( '" + encodeURIComponent( divID ) + "' ); } );" ); 
newScript.appendChild( scriptContent ); 
```

这是实际示例： [https ://jsfiddle.net/BrianLayman/4nu667c9/](https://jsfiddle.net/BrianLayman/4nu667c9/)

* * *

## 回答 #4

> 赞同：-4
> 
> 时间：2012-07-27T20:23:51.197

You don't to do that. In Firebug go to the "Console" tab. You can enter code directly there. Next to the three blue angle brackets at the bottom of the console type this and then hit the enter key: `alert("asdf");`

# java - 从标头Java Android获取文件长度

> ID：11694978
> 
> 赞同：2
> 
> 时间：2012-07-27T20:07:53.703
> 
> 标签：java, android, http

我有 Java 代码，我尝试了许多变体，但没有帮助。
一些主机正在关闭文件内容长度（文件大小），所以请帮我从标题中读取文件大小。
这是我的流代码的一部分，所以我需要打开列表并读取 int 值，对吗？

```
is = ucon.getInputStream();
fileLength = ucon.getContentLength();
List headersize = ucon.getHeaderFields().get("content-Lenght"); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T20:12:55.450

你可以这样做：

```
URL url = new URL("https://www.google.com/logos/classicplus.png");
URLConnection openConnection = url.openConnection();
System.out.println(openConnection.getContentLength()); 
```

根据[文件](http://docs.oracle.com/javase/6/docs/api/java/net/URLConnection.html#getContentLength%28%29)：

> ```
> public int getContentLength() 
> ```
> 
> 返回内容长度标头字段的值。
> 
> **返回：**此连接的 URL 引用的资源的内容长度，如果内容长度未知，则返回 -1。

该方法与您尝试手动执行的操作相同。如果未定义，您将收到`-1`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T20:12:03.693

你拼错`Content-Length`了。使用这个拼写

# scripting - 使用 sed，在模式上方或下方插入一行？

> ID：11694980
> 
> 赞同：83
> 
> 时间：2012-07-27T20:08:00.310
> 
> 标签：scripting, sed, awk

我需要编辑大量文件，方法是在独特模式的正下方或上方插入一行或多行。请告知如何在 shell 中使用`sed`, `awk`, `perl`（或其他任何东西）来做到这一点。谢谢！例子：

```
some text
lorem ipsum dolor sit amet
more text 
```

我想在`consectetur adipiscing elit`之后插入`lorem ipsum dolor sit amet`，所以输出文件将如下所示：

```
some text
lorem ipsum dolor sit amet
consectetur adipiscing elit
more text 
```

* * *

## 回答 #1

> 赞同：162
> 
> 时间：2012-07-27T20:17:12.757

在模式之后追加：（-i 用于就地替换）。line1 和 line2 是您要附加（或前置）的行

```
sed -i '/pattern/a \
line1 \
line2' inputfile 
```

**输出：**

```
#cat inputfile
 pattern
 line1 line2 
```

在前面添加行：

```
sed -i '/pattern/i \
line1 \
line2' inputfile 
```

**输出：**

```
#cat inputfile
 line1 line2 
 pattern 
```

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2012-07-27T20:18:54.653

下面在 . 之后添加一行`SearchPattern`。

`sed -i '/SearchPattern/aNew Text' SomeFile.txt`

它`New Text`在包含`SearchPattern`.

要添加**两行**，您可以使用 a`\`并在键入时输入换行符`New Text`。

POSIX sed在sed 函数`\`之后需要一个和一个换行符。`a`[1] 指定要附加的不带换行符的文本是 GNU sed 扩展（如`sed`信息页面中所述），因此它的使用不那么可移植。

[1] [https://unix.stackexchange.com/questions/52131/sed-on-osx-insert-at-a-certain-line/](https://unix.stackexchange.com/questions/52131/sed-on-osx-insert-at-a-certain-line/)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-07-27T20:24:26.630

Insert a new verse after the given verse in your stanza:

```
sed -i '/^lorem ipsum dolor sit amet$/ s:$:\nconsectetur adipiscing elit:' FILE 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-06-05T21:28:47.167

更便于使用 ed；某些系统不支持 sed 中的 \n

```
printf "/^lorem ipsum dolor sit amet/a\nconsectetur adipiscing elit\n.\nw\nq\n" |\
    /bin/ed $filename 
```

# java - 如何查找 hashmap a 中的值是否在 hashmap b 中不存在

> ID：11694984
> 
> 赞同：0
> 
> 时间：2012-07-27T20:08:25.660
> 
> 标签：java, hashmap

我有两个带有查询结果的不同哈希图，尽管这两个哈希图是不同大小的哈希图，我试图找到哈希图 A 中存在但哈希图 B 中不存在的记录。

到目前为止，我将发布我的代码；我通过 sql 进行了比较，得到了我想要的结果，但是当我尝试将其放入代码中时，我没有成功。我希望你能指出我正确的方向。提前致谢

```
HashMap<Integer, HashMap<String, Object>> mapA = new HashMap<>();
HashMap<Integer, HashMap<String, Object>> mapB = new HashMap<>(); 

int m=0;

for (int j = 0; j < mapA.size(); j++) {
    for (int k = 0; k < mapB.size(); k++) {
        if (!mapA.get(j).get("folio").toString().equals(
             mapB.get(k).get("folio").toString())) {
            m++; // count many records not exist on mapB
        }
    }
}
System.out.println(m); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T20:18:02.053

我不确定我是否理解你的方法。一个更合适的方法是（在伪代码中）：

```
For each element in Hashmap A:
  If !HashmapB.contains(element):
    ++Counter; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T22:45:49.633

逻辑上有错误。您希望找到不存在于 A 记录中，但每次迭代 HashMap 的值不相等时递增计数器（在这种情况下您将获得更大的 m）。你的代码应该是这样的。

```
for (int j = 0; j < mapA.size(); j++) {
    boolean found=false;
    for (int k = 0; k < mapB.size(); k++) {
        if (mapA.get(j).get("folio").toString().equals(
            mapB.get(k).get("folio").toString())) {
            found=true;   
            break;
        }
    }

    if (!found){
       m++; // count many records not exist on mapB
    }
} 
```

还有其他可能的错误。在一般情况下，您必须在 toString 方法之后而不是比较对象之后进行比较（我认为您没有过度使用对象的 toString 方法来返回有效标识符来比较它们。在大多数情况下，它不会返回您需要的内容。或者在换句话说，您应该覆盖哈希图中所有可能的对象的方法，并使用下一个代码进行比较：

```
mapA.get(j).get("folio").equals(mapB.get(k).get("folio")) 
```

在您的情况下（使用 toString）比较可以始终返回 false，因为典型的 toString 返回类和对象的 ID。

# android - Android FingerPaint 示例绘制四行

> ID：11694986
> 
> 赞同：0
> 
> 时间：2012-07-27T20:08:31.627
> 
> 标签：android, graphics, drawing

我正在尝试遵循 Android 的 APIDemos 示例项目中提供的 FingerPaint 示例的代码。在我的情况下（除非这应该发生），正在绘制四条镜像线，而不是**用户手指下的一条线**，这正是我想要的。我没有对代码进行任何更改：

```
package com.example.android.apis.graphics;

import android.content.Context;
import android.graphics.*;
import android.os.Bundle;
import android.view.Menu;
import android.view.MenuItem;
import android.view.MotionEvent;
import android.view.View;

public class FingerPaint extends GraphicsActivity
        implements ColorPickerDialog.OnColorChangedListener {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(new MyView(this));

        mPaint = new Paint();
        mPaint.setAntiAlias(true);
        mPaint.setDither(true);
        mPaint.setColor(0xFFFF0000);
        mPaint.setStyle(Paint.Style.STROKE);
        mPaint.setStrokeJoin(Paint.Join.ROUND);
        mPaint.setStrokeCap(Paint.Cap.ROUND);
        mPaint.setStrokeWidth(12);

        mEmboss = new EmbossMaskFilter(new float[] { 1, 1, 1 },
                                       0.4f, 6, 3.5f);

        mBlur = new BlurMaskFilter(8, BlurMaskFilter.Blur.NORMAL);
    }

    private Paint       mPaint;
    private MaskFilter  mEmboss;
    private MaskFilter  mBlur;

    public void colorChanged(int color) {
        mPaint.setColor(color);
    }

    public class MyView extends View {

        private static final float MINP = 0.25f;
        private static final float MAXP = 0.75f;

        private Bitmap  mBitmap;
        private Canvas  mCanvas;
        private Path    mPath;
        private Paint   mBitmapPaint;

        public MyView(Context c) {
            super(c);

            mPath = new Path();
            mBitmapPaint = new Paint(Paint.DITHER_FLAG);
        }

        @Override
        protected void onSizeChanged(int w, int h, int oldw, int oldh) {
            super.onSizeChanged(w, h, oldw, oldh);
            mBitmap = Bitmap.createBitmap(w, h, Bitmap.Config.ARGB_8888);
            mCanvas = new Canvas(mBitmap);
        }

        @Override
        protected void onDraw(Canvas canvas) {
            canvas.drawColor(0xFFAAAAAA);

            canvas.drawBitmap(mBitmap, 0, 0, mBitmapPaint);

            canvas.drawPath(mPath, mPaint);
        }

        private float mX, mY;
        private static final float TOUCH_TOLERANCE = 4;

        private void touch_start(float x, float y) {
            mPath.reset();
            mPath.moveTo(x, y);
            mX = x;
            mY = y;
        }
        private void touch_move(float x, float y) {
            float dx = Math.abs(x - mX);
            float dy = Math.abs(y - mY);
            if (dx >= TOUCH_TOLERANCE || dy >= TOUCH_TOLERANCE) {
                mPath.quadTo(mX, mY, (x + mX)/2, (y + mY)/2);
                mX = x;
                mY = y;
            }
        }
        private void touch_up() {
            mPath.lineTo(mX, mY);
            // commit the path to our offscreen
            mCanvas.drawPath(mPath, mPaint);
            // kill this so we don't double draw
            mPath.reset();
        }

        @Override
        public boolean onTouchEvent(MotionEvent event) {
            float x = event.getX();
            float y = event.getY();

            switch (event.getAction()) {
                case MotionEvent.ACTION_DOWN:
                    touch_start(x, y);
                    invalidate();
                    break;
                case MotionEvent.ACTION_MOVE:
                    touch_move(x, y);
                    invalidate();
                    break;
                case MotionEvent.ACTION_UP:
                    touch_up();
                    invalidate();
                    break;
            }
            return true;
        }
    }

    private static final int COLOR_MENU_ID = Menu.FIRST;
    private static final int EMBOSS_MENU_ID = Menu.FIRST + 1;
    private static final int BLUR_MENU_ID = Menu.FIRST + 2;
    private static final int ERASE_MENU_ID = Menu.FIRST + 3;
    private static final int SRCATOP_MENU_ID = Menu.FIRST + 4;

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        super.onCreateOptionsMenu(menu);

        menu.add(0, COLOR_MENU_ID, 0, "Color").setShortcut('3', 'c');
        menu.add(0, EMBOSS_MENU_ID, 0, "Emboss").setShortcut('4', 's');
        menu.add(0, BLUR_MENU_ID, 0, "Blur").setShortcut('5', 'z');
        menu.add(0, ERASE_MENU_ID, 0, "Erase").setShortcut('5', 'z');
        menu.add(0, SRCATOP_MENU_ID, 0, "SrcATop").setShortcut('5', 'z');

        /****   Is this the mechanism to extend with filter effects?
        Intent intent = new Intent(null, getIntent().getData());
        intent.addCategory(Intent.CATEGORY_ALTERNATIVE);
        menu.addIntentOptions(
                              Menu.ALTERNATIVE, 0,
                              new ComponentName(this, NotesList.class),
                              null, intent, 0, null);
        *****/
        return true;
    }

    @Override
    public boolean onPrepareOptionsMenu(Menu menu) {
        super.onPrepareOptionsMenu(menu);
        return true;
    }

    @Override
    public boolean onOptionsItemSelected(MenuItem item) {
        mPaint.setXfermode(null);
        mPaint.setAlpha(0xFF);

        switch (item.getItemId()) {
            case COLOR_MENU_ID:
                new ColorPickerDialog(this, this, mPaint.getColor()).show();
                return true;
            case EMBOSS_MENU_ID:
                if (mPaint.getMaskFilter() != mEmboss) {
                    mPaint.setMaskFilter(mEmboss);
                } else {
                    mPaint.setMaskFilter(null);
                }
                return true;
            case BLUR_MENU_ID:
                if (mPaint.getMaskFilter() != mBlur) {
                    mPaint.setMaskFilter(mBlur);
                } else {
                    mPaint.setMaskFilter(null);
                }
                return true;
            case ERASE_MENU_ID:
                mPaint.setXfermode(new PorterDuffXfermode(
                                                        PorterDuff.Mode.CLEAR));
                return true;
            case SRCATOP_MENU_ID:
                mPaint.setXfermode(new PorterDuffXfermode(
                                                    PorterDuff.Mode.SRC_ATOP));
                mPaint.setAlpha(0x80);
                return true;
        }
        return super.onOptionsItemSelected(item);
    }
} 
```

图片最终看起来像（我在屏幕中间涂鸦）：

![在此处输入图像描述](../Images/7ece9de778b92293271a8902e030eb0d.png)

这是我从学校开始第一次接触这样的绘图代码，所以我现在对它的理解有点不稳定。我想画一条跟随用户手指的线。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-16T18:33:31.497

您好，库中还有一个名为 GraphicActivity 的文件。代码如下。

```
enter code herepublic class GraphicsActivity extends Activity {
  @Override
     protected void onCreate(Bundle savedInstanceState) {
      super.onCreate(savedInstanceState);
  }

   @Override
  public void setContentView(View view){
    if (false){ // set to true to test Picture
        ViewGroup vg = new PictureLayout(this);
        vg.addView(view);      
        view = vg;
    }        
    super.setContentView(view);
  }
 } 
```

这将为您提供针对您的手指触摸的单行。

# mysql - MySQL按多个日期和结果使用大小写分组总计

> ID：11694988
> 
> 赞同：0
> 
> 时间：2012-07-27T20:08:51.667
> 
> 标签：mysql, sql, database

我有一个结果表，其中列出了一组值，每个值都链接到另一个表，其中包含生成结果的日期。

我有工作 SQL 来获取所有日期（使用 CASE）但是我只能检索一个范围的结果。

```
 Select 
    count(CASE
    WHEN  results.test_id IN ( SELECT id 
    FROM  `test` 
    WHERE  `posted` 
    BETWEEN  '2011-07-01 00:00:00'
    AND  '2011-07-01 23:59:59') 
    THEN results.test_id
    ELSE NULL
        END) AS "1st July"          
    from `results`
    WHERE results.window_id = 2 and results.mark > 90; 
```

我还有另一个 SQL 查询，它获取所有范围，但一次只能用于一个日期。

```
SELECT
CASE
    when mark > 90 then '>90%'
    when mark > 80 then '>80%'
    when mark > 70 then '>70%'
END as mark_results,
COUNT(*) AS count

FROM (SELECT mark from results where window_id =2) as derived
GROUP BY mark_results
ORDER BY mark_results; 
```

我想要的是在一个统一的查询中包含所有内容，显示每个结果范围的相关总数。如下所示：

```
Result Range | 1st July | 2nd July | 3rd July | 4th July
>90%         |    0     |    0     |    0     |    1
>80%         |    1     |    2     |    1     |    1
>70%         |    4     |    5     |    5     |    4 
```

以便每个范围的总数显示在其日期下方。

我认为这是可能的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-27T21:19:30.760

以下语句在 FROM 子句中连接结果和测试。然后它按标记范围聚合查询，包括每天的计数：

```
Select (CASE when mark > 90 then '>90%'
             when mark > 80 then '>80%'
             when mark > 70 then '>70%'
       END) as mark_results,
     sum(case when posted BETWEEN  '2011-07-01 00:00:00' AND  '2011-07-01 23:59:59' then 1 else 0 end) as July01,
     sum(case when posted BETWEEN  '2011-07-02 00:00:00' AND  '2011-07-02 23:59:59' then 1 else 0 end) as July02,
     . . . 
from `results` r join
     test t
     on r.test_id = t.test_id
WHERE r.window_id = 2 and results.mark > 90
group by (CASE when mark > 90 then '>90%'
               when mark > 80 then '>80%'
               when mark > 70 then '>70%'
          END)
order by 1 
```

只需在 SELECT 子句中添加您想要的任何日期。

我应该补充。. . 如果您想要所有日期，则需要将它们放在单独的行中：

```
Select date(posted) as PostedDate,
      (CASE when mark > 90 then '>90%'
             when mark > 80 then '>80%'
             when mark > 70 then '>70%'
       END) as mark_results,
     count(*) as cnt
     . . . 
from `results` r join
     test t
     on r.test_id = t.test_id
WHERE r.window_id = 2 and results.mark > 90
group by date(posted),
         (CASE when mark > 90 then '>90%'
               when mark > 80 then '>80%'
               when mark > 70 then '>70%'
          END)
order by 1, 2 
```

事实上，您可能会考虑为每个日期设置一个单独的行，并将范围作为列进行透视。

# haskell - 如何使用 Data.Reify 来具体化数据列表？

> ID：11694997
> 
> 赞同：5
> 
> 时间：2012-07-27T20:09:23.300
> 
> 标签：haskell

我试图阅读论文（[http://www.ittc.ku.edu/csdl/fpg/sites/default/files/Gill-09-TypeSafeReification.pdf](http://www.ittc.ku.edu/csdl/fpg/sites/default/files/Gill-09-TypeSafeReification.pdf)）并设法具体化我的符号表达式类型，但我不能t 弄清楚如何具体化它们的列表。这是简化的代码：

```
{-# OPTIONS_GHC -Wall #-}
{-# Language TypeOperators #-}
{-# Language TypeFamilies #-}
{-# Language FlexibleInstances #-}

import Control.Applicative
import Data.Reify

-- symbolic expression type
data Expr a = EConst a
            | EBin (Expr a) (Expr a)
            deriving Show

-- corresponding node type
data GraphExpr a b = GConst a
                   | GBin b b
                   deriving Show

instance MuRef (Expr a) where
  type DeRef (Expr a) = GraphExpr a
  mapDeRef _ (EConst c)  = pure (GConst c)
  mapDeRef f (EBin u v) = GBin <$> f u <*> f v

-- this works as expected
main :: IO ()
main = reifyGraph (EBin x (EBin x y)) >>= print
  where
    x = EConst "x"
    y = EConst "y"
-- (output: "let [(1,GBin 2 3),(3,GBin 2 4),(4,GConst "y"),(2,GConst "x")] in 1")

-- but what if I want to reify a list of Exprs?
data ExprList a = ExprList [Expr a]
data GraphList a b = GraphList [GraphExpr a b]

instance MuRef (ExprList a) where
  type DeRef (ExprList a) = GraphList a
  --  mapDeRef f (ExprList xs) = ??????? 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T15:54:36.563

我遇到了完全相同的问题，我找到了使用 data-reify 的解决方案。

要获得解决方案，您必须意识到： 1\. 即使 EDSL 没有列表，图形类型也可以包含它们 2\. 可以将不同类型的数据具体化为相同的结果类型。

因此，我们首先将列表构造函数添加到我们的结果类型：

```
data GraphExpr a b = GConst a
                   | GBin b b
                   | Cons b b
                   | Nil
                   deriving Show 
```

然后我们需要 MuRef 的第二个实例，它将 Expr a 的列表具体化为 GraphExpr。

```
instance MuRef [Expr a] where
    type DeRef [Expr a] = GraphExpr a
    mapDeRef _ [] = pure Nil
    mapDeRef f (x:xs) = Cons <$> f x <*> f xs 
```

现在有了这个，如果我们尝试具体化一个列表表达式

```
reified = reifyGraph [EBin x (EBin x y), Ebin y (EBin x y)]
              where x = EConst "x"
                    y = EConst "y" 
```

我们会得到结果

```
let [(1,Cons 2 6),(6,Cons 7 9),(9,Nil),(7,GBin 5 8),(8,GBin 3 5),(2,GBin 3 4),(4,GBin 3 5),(5,GConst "y"),(3,GConst "x")] in 1 
```

为了从这个图中提取具体的节点 ID 列表，我们可以定义一个小函数来遍历 Conses 并将节点 ID 从中提取到列表中。

```
walkConses :: Graph (GraphExpr t) -> [Unique]
walkConses (Graph xs root) = go (lookup root xs)
where 
    go (Just (Cons n1 n2)) = n1 : go (lookup n2 xs)
    go (Just Nil) = [] 
```

（如果图表很大，在开始步行之前将它们转换为 IntMap 可能是个好主意）

这看起来像一个偏函数，但是因为我们知道 DAG 的根将始终是一个 Cons-node（因为我们具体化了一个列表），并且因为我们知道所有节点 ID 都在 xs 中，所以这个函数将返回一个列表结果列表中的所有节点 ID。

因此，如果我们在结果图上运行 walkConses，我们将得到结果：

```
[2, 7] 
```

希望这会有所帮助，我也一直在努力解决这个问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-27T23:21:05.330

你真的不能用 MuRef 做到这一点。GraphLists 不包含 GraphLists。您可以依次具体化每个 Expr 并编写一次性组合器以将它们粉碎到您的 GraphList 中：

只需在 ExprList 内容上使用 traverse reifyGraph 即可。

此外，后者可能都应该是新类型。