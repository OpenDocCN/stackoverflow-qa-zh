# StackOverflow 问答 10192000-10192999

# iphone - How to simulate a call so that the bluetooth audio get streamed into a vehicle?

> ID：10192001
> 
> 赞同：0
> 
> 时间：2012-04-17T13:14:42.163
> 
> 标签：iphone, objective-c, core-bluetooth

The iphone connects to most vehicles via bluetooth. Phone calls as well as voice control and siri also get routed via the bluetooth audio and mic of the vehicle.

How can i stream audio in the same way?

I have sen answers about the vehicle capability to support streaming audio, but this is not what i am looking for. If siri and voice control can stream over the vehicle audio as it is treated as a voice call then i should be able to stream everything else.

Thank you

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-29T08:36:33.643

我认为那是假的。

谷歌做到了。他们在谷歌搜索中做到这一点。如果您使用语音搜索，它会模拟呼叫。

苹果的语音笔记应用程序也发生了类似的事情。您可以将音乐流式传输到汽车，就好像它是一个电话一样。

实际上，我的车不支持 A2DP，只支持通话，并且使用语音笔记我可以播放音乐（奇怪，但可以）。

但是......，我们如何才能实现它？？？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T14:58:59.673

听起来您想模拟来自 iPhone 的呼叫，而不是其他一些伪装成电话并与您的汽车配对的设备。你不能，因为 Apple 不提供 API 来做到这一点。

# video - ffmpeg和媒体播放器之间的帧提取差异

> ID：10192002
> 
> 赞同：1
> 
> 时间：2012-04-17T13:14:46.053
> 
> 标签：video, ffmpeg, flowplayer

我的目标是允许在选定的时间从视频中提取帧。不幸的是，我只得到了我*大部分时间*看到的框架！

我正在使用 ffmpeg 提取具有以下参数的帧：
ffmpeg.exe -ss 00:01:13.000 -i INPUT.mp4 -vframes 1 OUT_%d.jpg
有时我会得到我在当时的播放器（我测试过的播放器是 VLC 和 flowplayer），并且有时帧会处于稍微不同的点（毫秒！）。

我也尝试过使用 mplayer 来完成同样的任务，但我没有成功。任何关于为什么的想法都会受到赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T17:12:32.223

尝试`-ss`用作输出选项（在 之后`-i INPUT.mp4`）。改变的[行为](http://ffmpeg.org/pipermail/ffmpeg-user/2011-November/002976.html)：`-ss`

*   用作输入选项 ffmpeg 将尝试寻找您的时间然后开始解码；它更快但可能不准确。

*   当用作输出选项时，ffmpeg 将从文件的开头解码直到您想要的时间。它速度较慢，但​​通常更准确。

您可以通过应用`-threads`（为您的机器使用适当的值）作为输入选项来提高解码速度。

# css - 网格布局中的偏移 div

> ID：10192006
> 
> 赞同：1
> 
> 时间：2012-04-17T13:15:11.717
> 
> 标签：css, layout, grid-layout

我是网格布局的新手，我想知道让事物稍微退出网格的最佳方法是什么，例如“丝带”效果： ![在此处输入图像描述](../Images/e3e7a363700777457e76793efff97efe.png)

（图片来自[http://www.red-team-design.com/css-ribbons](http://www.red-team-design.com/css-ribbons)）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T13:31:26.470

将功能区与网格对齐并设置样式后，您将在 CSS 中添加如下内容：

```
.ribbon {
margin-left: -10px;
} 
```

# python - Matplotlib 中的剪辑。为什么这不起作用？

> ID：10192011
> 
> 赞同：7
> 
> 时间：2012-04-17T13:15:36.273
> 
> 标签：python, matplotlib

我正在尝试使用 Matplotlib 中的剪辑来剪辑圆形和椭圆之类的形状，但一定有我遗漏的东西.. 为什么不把圆圈剪成两半？：

```
import numpy as np
import matplotlib.pyplot as plt
from matplotlib.patches import Circle
from matplotlib.transforms import Bbox

clip_box = Bbox(((-2,-2),(2,0)))
circle = Circle((0,0),1,clip_box=clip_box,clip_on=True)

plt.axes().add_artist(circle)
plt.axis('equal')
plt.axis((-2,2,-2,2))
plt.show() 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-17T14:27:24.150

我不知道为什么您的代码不起作用，但是，以下代码段可以按您的预期工作。

据我所知，clip_on 与将给定的剪辑应用到形状无关，但该形状是否应该在显示区域中剪辑。

```
import matplotlib.pyplot as plt
from matplotlib.patches import Circle, Rectangle

rect = Rectangle((-2,-2),4,2, facecolor="none", edgecolor="none")
circle = Circle((0,0),1)

plt.axes().add_artist(rect)
plt.axes().add_artist(circle)

circle.set_clip_path(rect)

plt.axis('equal')
plt.axis((-2,2,-2,2))
plt.show() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-31T15:45:34.120

我一直在努力解决这个问题，所以这是我的版本：

```
import numpy as np
import matplotlib.pyplot as plt
from matplotlib.patches import Circle
from matplotlib.transforms import Bbox

# This is in PIXELS
# first tuple : coords of box' bottom-left corner, from the figure's bottom-left corner
# second tuple : coords of box' top-right corner, from the figure's bottom-left corner
clip_box = Bbox(((0,0),(300,300)))
circle = Circle((0,0),1)

plt.axis('equal')
plt.axis((-2,2,-2,2))
plt.axes().add_artist(circle)

# You have to call this after add_artist()
circle.set_clip_box(clip_box)

plt.show() 
```

两个区别是框的坐标以像素为单位（？！），并且`set_clip_box()`仅在之后才有效`add_artists()`（这就是为什么`clip_box=clip_box`不起作用）。我很想知道应该配置什么来让它在“轴单元”中工作。

对于后代，这是我用来解决此问题的黑客。它剪辑了*所有内容*，包括绘图、轴等：

```
for o in plt.findobj():
    o.set_clip_on(True)
    o.set_clip_box(clip_box) 
```

# objective-c - possibility of setting the Voice Over Cursor in Objective-C

> ID：10192013
> 
> 赞同：2
> 
> 时间：2012-04-17T13:15:49.737
> 
> 标签：objective-c, accessibility, voiceover

I am programming a text-based RPG for Voice-Over users on the iPhone.

I've got multiple UIViews added to my viewcontroller for different events.

I often remove and add them to my main View.

My Question is as follows: is it possible to update the VoiceOver Cursor to focus on the first Element on the View so the User doesn't has to check every Time if there has happened something new?

I figured out that this happens in a Navigationcontroller.

Is there a functionality to do this?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T09:43:04.433

通过发布`UIAccessibilityLayoutChangedNotification`，您通知 VoiceOver 屏幕布局已更改。`UIAccessibilityAnnouncementNotification`如果要发布特定公告，也可以使用。

```
UIAccessibilityPostNotification(UIAccessibilityLayoutChangedNotification, nil); 
```

参考：[UIAccessibility 协议介绍、通知](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIAccessibility_Protocol/Introduction/Introduction.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T04:44:19.527

您无法在 iOS 4 或 5 中控制 VoiceOver 光标。我希望您可以，它会解决很多问题。

我认为这将在 iOS 6 上成为可能。有关更多信息，请参阅此答案：[https ://stackoverflow.com/a/11995385/1455770](https://stackoverflow.com/a/11995385/1455770)

# java - SMS Logger：如何基于 ContentObserver 为应用创建 AndroidManifest.xml

> ID：10192014
> 
> 赞同：0
> 
> 时间：2012-04-17T13:16:04.320
> 
> 标签：java, android, sms, android-manifest, contentobserver

我是android应用程序的新手...

我希望基于 ContentObserver 创建尽可能简单的 android 背景（无 gui）应用程序，该应用程序将监视任何 sms 输入/输出活动并通知我这一事实。

我有这个：

```
import android.content.Context;
import android.database.ContentObserver;
import android.os.Handler;
import android.util.Log;

public class SMSNotifyActivity extends ContentObserver {
    private static String TAG ="SMSContentObserver";

    private Context MContext ;
    private Handler MHandler;

    public SMSNotifyActivity(Context Context, Handler Handler) {
        super(Handler);
        MContext = Context;
        MHandler = Handler;
    }

    @Override
    public void onChange(boolean selfChange) {
        Log.i(TAG, "The Sms Table Has Changed ") ;
    }
} 
```

我知道对于 ContentObserver 我需要在 AndroidManifest.xml 中创建一个服务：

```
<service android:name=".SMSNotifyActivity" /> 
```

并在启动时授予应用启动权限：

```
<uses-permission android:name="android.permission.RECEIVE_BOOT_COMPLETED" />

...

<receiver android:name=".SMSNotifyActivity" >
    <intent-filter>
        <action android:name="android.intent.action.BOOT_COMPLETED" />
    </intent-filter>
</receiver> 
```

但还是……错了……

我得到：无法实例化活动 ComponentInfo{com.example.smsnotify/com.example.smsnotify.SMSNotifyActivity}：java.lang.InstantiationException：com.example.smsnotify.SMSNotifyActivity

我的整个 AndroidManifest.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.smsnotify"
    android:versionCode="1"
    android:versionName="1.0" >
    <uses-sdk android:minSdkVersion="8" />
    <uses-permission android:name="android.permission.READ_SMS" />
    <uses-permission android:name="android.permission.RECEIVE_BOOT_COMPLETED" />
    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name" >
        <activity
            android:name=".SMSNotifyActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
        <service android:name=".SMSNotifyActivity" />
        <receiver android:name=".SMSNotifyActivity" >
           <intent-filter>
               <action android:name="android.intent.action.BOOT_COMPLETED" />
           </intent-filter>
        </receiver>
    </application>
</manifest> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T08:22:22.433

您对`Service`,`BroadcastReceiver`和有点困惑。`ContentObserver``Activity`

创建一个`Service`（从`Service`or扩展`IntentService`）并将您`ContentObserver`的作为内部类放入其中。

从清单中删除`<activity>`标签，您不需要它。

清单中的`<receiver>`元素应指向`BroadcastReceiver`扩展类。尝试扩展一个`BroadcastReceiver`，称之为 SMSNotifyStarter，把它放在你的清单中：

```
<receiver android:name=".SMSNotifyStarter" >
   <intent-filter>
      <action android:name="android.intent.action.BOOT_COMPLETED" />
   </intent-filter>
</receiver> 
```

当你开始广播启动时，启动你的`Service`.

# php - PHP数组如果找到则删除关键字下的所有数组

> ID：10192015
> 
> 赞同：1
> 
> 时间：2012-04-17T13:16:06.953
> 
> 标签：php, arrays, explode, keyword

我有 30 行文本并分解成由“\n”分隔的数组。结果如下：

```
[1]=> string(121) "In recent years, the rapid growth" 
[2]=> string(139) "information technology has strongly enhanced computer systems" 
[3]=> string(89) "both in terms of computational and networking capabilities" 
[4]=> string(103) "-------------------------" 
[5]=> string(103) "these novel distributed computing scenarios"
 .
 .
[30]=> string(103) "these computer safety applications. end" 
```

在这种情况下，我需要删除“-------------”下面的所有数组并产生如下输出：

```
[1]=> string(121) "In recent years, the rapid growth" 
[2]=> string(139) "information technology has strongly enhanced computer systems" 
[3]=> string(89) "both in terms of computational and networking capabilities" 
```

知道怎么做吗？谢谢。

迈克尔解决问题的方法

```
$i = 0;
$new_arr = array();
while ($array[$i] != "-------------------------") {
  // Append lines onto the new array until the delimiter is found
  $new_arr[] = $array[$i];
  $i++;
}
print_r($new_arr); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T13:19:26.717

例如

```
function getMyArray( $array ){

     $myArray = array();
     foreach( $array as $item ){
         if ( $item == '-------------------------' ){ return $myArray; }
         $myArray[] = $line;
     }
     return $myArray'
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T13:19:35.620

### 最佳解决方案：

使用`array_search()`然后截断数组[`array_splice()`](http://us3.php.net/manual/en/function.array-splice.php)：

```
$key = array_search("-------------------------", $array);
array_splice($array, $key); 
```

### 明显的解决方案：

您可以循环将输出复制到新数组。想到的第一个例子：

```
$i = 0;
$new_arr = array();
while ($array[$i] != "-------------------------") {
  // Append lines onto the new array until the delimiter is found
  $new_arr[] = $array[$i];
  $i++;
}
print_r($new_arr); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T13:20:55.953

[数组搜索](http://in.php.net/manual/en/function.array-search.php)

并[取消设置](http://in.php.net/unset)

你也可以使用 array_slice

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-17T13:20:46.587

```
foreach($array as $key => $value)
{
    if($value == '-------------')
          break;
    else
          $new_array[$key]=$value;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-17T13:22:14.633

您可以使用它`array_search`来查找其所在位置的密钥。

来自 PHP.net：

```
<?php
$array = array(0 => 'blue', 1 => 'red', 2 => 'green', 3 => 'red');
$key = array_search('green', $array); // $key = 2;
?> 
```

获得密钥后，您可以执行以下操作：

```
<?php
while($key < count($array) )
{
   $array = unset($array[$key]);
   $key++;
}
?> 
```

# php - Generate CSRF token for Non-Symfony forms hosted on another site

> ID：10192016
> 
> 赞同：1
> 
> 时间：2012-04-17T13:16:20.853
> 
> 标签：php, symfony1, symfony-1.4, csrf, csrf-protection

OK, so what I'm trying to do may seem like a cross-site attack - defeating the very purpose of CSRF tokens, but here is the need: I have a Symfony app site (app.timo.in) and the plain-PHP homepage web-app (www.timo.in). I wish to allow registered visitors to login from the homepage.

**INFO**: The app & homepage are on the same domain (timo.in)

A possible option is to generate some other token based on a sharedSecret that both sides can understand. I do not want that the token to expire too soon. One advantage I have is that the login form opens in a modal, so a fresh token can be generated each time, with a short validity. What other parameters do I need to make it secure? If I include session ID, will both sites understand it?

**ALERT**: I need some sort of CSRF protection, so do not suggest disabling it on the Symfony App's Login page :)

# iphone - 快速访问 Core Data 数据库信息？

> ID：10192019
> 
> 赞同：0
> 
> 时间：2012-04-17T13:16:27.307
> 
> 标签：iphone, ios, core-data, nsfetchrequest

我有带有核心数据的 iOS 应用程序，在我的一个功能中，我加载信息以通过这种方式显示我的应用程序的一个视图：

```
NSFetchRequest *fetchRequest = [[NSFetchRequest alloc] init];
NSEntityDescription *entity = [NSEntityDescription 
                               entityForName:@"MyDate" inManagedObjectContext:managedObjectContext];
[fetchRequest setEntity:entity];

NSError *error;

NSArray *fetchedObjects = [managedObjectContext executeFetchRequest:fetchRequest error:&error];

for (NSManagedObject *info in fetchedObjects) {

    if ([[[info valueForKey:@"status"] description] isEqualToString:@"Done"]) {

        NSArray *allTask = [[info valueForKey:@"taskes"] allObjects];
        for (NSManagedObject *task in allTask) {
            NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];
            [dateFormatter setDateFormat:@"yyyy-MM-dd"];

            if (IsDateBetweenInclusive([task valueForKey:@"firstDate"], fromDate, toDate)) {

                [taskArray addObject:task];
            }
        }
    }
} 
```

所以我迭代所有数据库以查找信息然后显示它，当我的数据库中的信息很少时，上面的方法很快，但是当我的数据库中的信息更多时，在我的 3GS 上需要几秒钟来显示该视图，而不是模拟器中的速度很快，所以我的问题是，有一种快速的方法可以从核心日期获取信息吗？我不知道有一个快速调用属性和我想从核心数据中检索的值？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T13:33:36.557

使用 NSPredicate，见[https://developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/CoreData/Articles/cdFetching.html](https://developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/CoreData/Articles/cdFetching.html)

以下代码将仅获取状态字段设置为“完成”的值

```
NSFetchRequest *fetchRequest = [[NSFetchRequest alloc] init];
NSEntityDescription *entity = [NSEntityDescription entityForName:@"MyDate" inManagedObjectContext:managedObjectContext];
[fetchRequest setEntity:entity];
[fetchRequest setPredicate:[NSPredicate predicateWithFormat:@"status == 'Done'"]];

NSError *error;

NSArray *fetchedObjects = [managedObjectContext executeFetchRequest:fetchRequest error:&error]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-24T06:41:54.043

创建`database`：

NSString *docsDir; NSArray *dirPaths;

```
dirPaths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);

docsDir = [dirPaths objectAtIndex:0];
databasePath = [[NSString alloc] initWithString: [docsDir stringByAppendingPathComponent: @"newapp.sqlite"]];

NSFileManager *filemgr = [NSFileManager defaultManager];

if ([filemgr fileExistsAtPath: databasePath ] == NO)
{
    const char *dbpath = [databasePath UTF8String];

    if (sqlite3_open(dbpath, &contactDB) == SQLITE_OK)
    {
        char *errMsg;
        const char *sql_stmt = "CREATE TABLE IF NOT EXISTS LIST (id VARCHAR, title VARCHAR , description VARCHAR ,date VARCHAR)";

        if ((sqlite3_exec(contactDB, sql_stmt, NULL, NULL, &errMsg) != SQLITE_OK) )
        {
            UIAlertView *alert=[[UIAlertView alloc]initWithTitle:@"Warning" message:@"Failed to create table" delegate:self cancelButtonTitle:@"OK" otherButtonTitles:nil];
            [alert show];
                        }

        sqlite3_close(contactDB);

    } else {
        UIAlertView *alert=[[UIAlertView alloc]initWithTitle:@"Warning" message:@"Failed to open/create database" delegate:self cancelButtonTitle:@"OK" otherButtonTitles:nil];
        [alert show];

    }
} 
```

插入值

NSString *id_str=@"21"; NSString *title=@"notisa"; NSString *description=@"新应用"; NSString *date=@"21/4/30";

```
const char *dbpath = [databasePath UTF8String];

if (sqlite3_open(dbpath, &contactDB) == SQLITE_OK){
    // error handling...
}
// Construct the query and empty prepared statement.
const char *sql = "INSERT INTO `LIST` (`id`,`title`,`description`,`date`) VALUES (?, ?, ?, ?)";
sqlite3_stmt *statement;

   // UIImage *image = [UIImage imageWithData:imgdata];
//NSData *imageData=UIImagePNGRepresentation(image);

// Prepare the statement.
if (sqlite3_prepare_v2(contactDB, sql, -1, &statement, NULL) == SQLITE_OK) {
    // Bind the parameters (note that these use a 1-based index, not 0).

    sqlite3_bind_text(statement,1, [id_str UTF8String], -1, SQLITE_TRANSIENT);
    sqlite3_bind_text(statement,2, [title UTF8String], -1, SQLITE_TRANSIENT);
    sqlite3_bind_text(statement,3, [description UTF8String], -1, SQLITE_TRANSIENT);
    sqlite3_bind_text(statement,4, [date UTF8String], -1, SQLITE_TRANSIENT);

        }

// Execute the statement.
if (sqlite3_step(statement) != SQLITE_DONE) {
    // error handling...
    UIAlertView *alert=[[UIAlertView alloc]initWithTitle:@"Warning" message:@"Failed to Save" delegate:self cancelButtonTitle:@"OK" otherButtonTitles:nil];
    [alert show];
       }
else
{
    UIAlertView *alert=[[UIAlertView alloc]initWithTitle:@"Database" message:@"Stored Successfully" delegate:self cancelButtonTitle:@"OK" otherButtonTitles:nil];
    [alert show];
     }
// Clean up and delete the resources used by the prepared statement.
sqlite3_finalize(statement);
sqlite3_close(contactDB); 
```

选择数据库： const char *dbpath = [databasePath UTF8String]; sqlite3_stmt *语句；

```
if (sqlite3_open(dbpath, &contactDB) == SQLITE_OK)
{
    NSString *querySQL = [NSString stringWithFormat: @"SELECT id,title,description,date FROM LIST"];

    const char *query_stmt = [querySQL UTF8String];

    if (sqlite3_prepare_v2(contactDB, query_stmt, -1, &statement, NULL) == SQLITE_OK)
    {
        while(sqlite3_step(statement) == SQLITE_ROW)
        {
            NSLog(@"ROW-->%d",SQLITE_ROW);

            const char* policyNo  = (const char *)sqlite3_column_text(statement, 1);
            NSString *PolicyNumber = policyNo == NULL ? nil : [[NSString alloc]initWithUTF8String:policyNo];

            NSLog(@"PolicyNumber:%@",PolicyNumber);

            const char* start  = (const char *)sqlite3_column_text(statement, 2);
            NSString *startDate = start == NULL ? nil : [[NSString alloc]initWithUTF8String:start];

            const char* end  = (const char *)sqlite3_column_text(statement, 3);
            NSString *endDate = end == NULL ? nil : [[NSString alloc]initWithUTF8String:end];

                   }
        sqlite3_finalize(statement);
    }
    sqlite3_close(contactDB);
} 
```

删除 ：

const char *dbpath = [databasePath UTF8String]; sqlite3_stmt *语句；

```
if (sqlite3_open(dbpath, &contactDB) == SQLITE_OK)
{
    NSString *querySQL = [NSString stringWithFormat: @"DELETE id,title,description,date FROM LIST"];

    const char *query_stmt = [querySQL UTF8String];

    if (sqlite3_prepare_v2(contactDB, query_stmt, -1, &statement, NULL) == SQLITE_OK)
    {
        while(sqlite3_step(statement) == SQLITE_ROW)
        {
            NSLog(@"ROW-->%d",SQLITE_ROW);

            const char* policyNo  = (const char *)sqlite3_column_text(statement, 1);
            NSString *PolicyNumber = policyNo == NULL ? nil : [[NSString alloc]initWithUTF8String:policyNo];

            NSLog(@"PolicyNumber:%@",PolicyNumber);

            const char* start  = (const char *)sqlite3_column_text(statement, 2);
            NSString *startDate = start == NULL ? nil : [[NSString alloc]initWithUTF8String:start];

            const char* end  = (const char *)sqlite3_column_text(statement, 3);
            NSString *endDate = end == NULL ? nil : [[NSString alloc]initWithUTF8String:end];

        }
        sqlite3_finalize(statement);
    }
    sqlite3_close(contactDB);
} 
```

# javascript - 从 ListBox 获取 SelectList 对象并放入 HTML 选择列表

> ID：10192029
> 
> 赞同：0
> 
> 时间：2012-04-17T13:16:53.697
> 
> 标签：javascript, jquery, html, asp.net-mvc

假设我有一个 ListBox 填充了名称值对 SelectList(myUsers, "Key", "Value")：

```
@Html.ListBox("ListReviewers", (SelectList)ViewBag.ListOFReviewers, new { style = "width:120px;" }) 
```

我想双击这个 ListBox 中的一个选项，并将其放在一个 SelectionList 中，如下所示：

```
<div class="selectedEmployees">
  <select class="selectionList" multiple="multiple" name="AssignedReviewer"    style="width:120px;">
     <!--x.UserID, x.FirstName + " " + x.LastName) -->
     <option value=""></option>
  </select>
</div> 
```

一旦将这个集合放在上面，我想将所有值存储在另一个 SelectionList 集合中以供以后使用。

这是我的 jQuery 代码的开始：

```
<script type="text/javascript">

$('#ListReviewers').dblclick(function (i, selected) {
    //double click on this value of listbox of type SelectList(myUsers, "Key", "Value")

    //store this value and text
    var value = $(this).val;
    //var empName = $(this).data[0];
    var empName = $(selected).text();

    alert(empName);

    //append an option element <option value=""></option>
    $('.selectionList').append('<option id="' + value + '">' + empName + '</option>');

}); 
```

我可以获取 dblclicked 集合对象的值，但不能获取集合对象的文本。有一个更好的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T13:26:39.617

尝试将您的事件附加到`option`选择本身内。然后，您可以使用`this`它来访问它的属性。

```
$('#ListReviewers option').dblclick(function () {
    var value = $(this).val();
    var empName = $(this).text();

    $('.selectionList').append('<option id="' + value + '">' + empName + '</option>');
}); 
```

或者，您可以使用`clone()`和从一个`append()`移动到另一个。这将使您不必担心附加的重复选项。`option``select`

```
$('#ListReviewers option').dblclick(function () {
    var $newOptions = $(this).clone(false);
    $(this).remove();

    $('.selectionList').append($newOption);
}); 
```

# javascript - jQuery与原型的回调函数如何避免$冲突

> ID：10192032
> 
> 赞同：0
> 
> 时间：2012-04-17T13:17:05.363
> 
> 标签：javascript, jquery

```
jQuery.noConflict(); or $.noConflict();    
(function($) { 
    $(document).ready( function() {
     // Show menu when #input1 is clicked
        $("#input1").contextMenu({
        menu: 'myMenu'
        },
         function(action, el, pos) {
        alert("clicked");
        });
    })(jQuery); 
```

在上面的代码中，我通过使用 function($){}(jQuery); 避免了与原型的冲突；但是在回调函数（action，e1，pos）中，它再次从原型调用函数。

两者 $.noConflict(); & jquery.noConflict(); 我试过但没有用。请提供建议显示我可以避免这种冲突。

现在冲突解决了。感谢大家的专家建议。但现在另一个问题是右键单击 input1 时未打开上下文菜单。请提出您宝贵的建议。

感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T13:47:35.400

问题出在[jquery.contextMenu.js](http://www.abeautifulsite.net/blog/2008/09/jquery-context-menu-plugin/)中。我已经提到了这些行：

```
// This plugin is dual-licensed under the GNU General Public License
//   and the MIT License and is copyright A Beautiful Site, LLC.
//
if(jQuery)( function() {
    $.extend($.fn, 
...
})(jQuery); 
```

所以我们不能说`'$'`是jQuery还是其他lib。这是**插件的一个错误**。

变更`function()`和`function($)`冲突应该得到解决。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T13:21:44.517

假设您应该使用`jQuery.noConflict()`以避免使用`$`符号的库之间的干扰，最后您还有一个额外`;`的

```
(function($) { 
    ...
}(jQuery)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T13:24:44.937

您的代码中有错误：`});(jQuery);`

您应该调用匿名函数，而不仅仅是定义它，并使用 jQuery 作为调用它的参数，因此在匿名函数内部`$`是`jQuery`，因为您现在有不同的范围。

如果你`(function($){/*your stuff*/});(jquery)`定义了一个匿名函数，但不要执行它。函数内部的任何内容都不会执行，并且由于匿名函数没有名称，因此您无法执行它。

删除该行中的第一个分号：

```
(function($) { 
    // do your stuff
})(jQuery); 
```

**编辑：**

关于它的工作原理的一点解释：

它是一个匿名函数（如果您不知道 Javascript 中的匿名函数是如何工作的，请参阅[这个问题](https://stackoverflow.com/questions/1140089/how-does-an-anonymous-function-in-javascript-work)），并且您使用`jQuery`. 如果您`jQuery.noConflict()`在代码中使用，因为您应该这样做以避免绑定`$`到 jquery，那么您将只能使用`jQuery('#myId')`jquery 函数之类的调用，而不是`$('#myId')`仍然`$`绑定到 Prototype 库的调用（我明确称它为 destinguish它来自`prototype`对象链）。

现在考虑您的匿名函数：

你有`(function($){ /* Some stuff with $ as a variable */ })`. 在函数内部，你有一个新的范围，因此`$`只是你传递给函数的变量，而不是`$`它的外部（仍然绑定到 Prototype 库）。

现在你将一些东西传递给匿名函数并因此执行它：`(function($){ /* Some stuff with $ as a variable */ })(jQuery)`. 现在`$`里面的函数是…… `jQuery`，和`$`外面的不一样。

**编辑2：**

当您更新您的问题时，我将解释使这两个库工作的步骤。您需要在 jQuery 之前包含对 Prototype 的引用，然后调用`jQuery.noConflict()`. 调用之后，`$()`默认使用 Prototype 库中的函数。要调用 jQuery 库中的函数，您必须使用`jQuery()`（请参阅[jQuery API 参考](http://api.jquery.com/jQuery.noConflict/)）。您将`jQuery`对象的引用传递给匿名函数，因此匿名函数内部`$`引用了 jQuery 对象，您无法使用 Prototype 库的功能。

现在关于回调函数的问题：问题可能出在`contextMenu`函数内部，因为该函数可能无法正确使用无冲突初始化，但这只是一个疯狂的猜测。你能给出你的`contextMenu`功能实现吗？

# macos - Mac 上的流行浏览器

> ID：10192041
> 
> 赞同：1
> 
> 时间：2012-04-17T13:17:43.910
> 
> 标签：macos, browser, safari

除了 Safari，Mac 上还有其他流行的浏览器吗？对于 Windows，有大量用户使用 FF 和 Chrome，但对于 Mac 用户也是如此吗？或者我可以肯定地说 Safari 覆盖了 95% 的 Mac 用户？我问是为了知道我需要为我的应用程序测试哪些浏览器/平台组合。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T13:21:43.670

我绝对不会假设您不需要测试 mac ff 和 chrome。这不会是一个非常大的工作量，因为 mac chrome 或 ff 似乎与它们各自的 Windows 版本没有太大差异。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T13:21:44.673

我们发现 Chrome 和 Firefox 在 Mac 上仍然相当普遍，但大约 10-20% 的 Mac 用户取决于网站。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T13:23:26.320

Firefox 可用于 Mac 以及 Opera。谷歌浏览器（铬）也在那里。以下是适用于 Mac 的可用浏览器列表：http://en.wikipedia.org/wiki/Category: [Mac_OS_X_web_browsers](http://en.wikipedia.org/wiki/Category:Mac_OS_X_web_browsers)

测试时也要记住其他平台。例如，Konqueror 在 Linux 上非常流行。

# xna - 入侵者到达屏幕最左侧时不会向下移动

> ID：10192044
> 
> 赞同：0
> 
> 时间：2012-04-17T13:17:56.517
> 
> 标签：xna

当入侵者到达屏幕的最左侧时，我无法向下移动它们，但是当它们到达最右侧时，它们向下移动却没有问题。运动的代码如下所示：

```
if  (Invaders[0].GetXPos() < 100) // if the first invader element riches the far left of the screen, change direction, and move down four pixels.

{
        AlienDirection = +1;

        for (int Count = 0; Count < 11; Count++)
        {
            Invaders[Count].MoveVertical(4);
        }
    }

    if (Invaders[10].GetXPos() > 924)
    {
        AlienDirection = -1;

        for (int Count = 0; Count < 11; Count++)
        {
            Invaders[Count].MoveVertical(4); // if the first invader element riches the far left of the screen, change direction, and move down four pixels.
        }
    } 
```

我不知道是什么导致外星人在他们向左齿轮时不向下移动。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T13:26:51.570

我最好的猜测是你的幻数“924”是错误的。

这都可以重构为以下

```
if(Invaders[0].GetXPos() < 100 || Invaders[10].GetXPos() > 924) 
{
  AlienDirection = 0 - AlienDirection; // turns -1 into 1 and 1 into -1
  for(int Count = 0; Count < 11; Count++)
  {
    Invaders[Count].MoveVertical(4);
  }
} 
```

# python - 将 OpenERP 与 Asterisk 集成

> ID：10192047
> 
> 赞同：0
> 
> 时间：2012-04-17T13:18:18.620
> 
> 标签：python, asterisk, openerp

我正在尝试将 OpenERP 和 Asterisk 与 asterisk_click2dial 模块集成。从软件电话到软件电话的呼叫工作正常，但我不能从 OpenERP 呼叫到软件电话。

经理.conf：

```
[general]
enabled = yes
webenabled = yes
port = 5038
bindaddr = 0.0.0.0

[openerp]
secret = openerp
deny=0.0.0.0/0.0.0.0
permit=0.0.0.0/0.0.0.0
read = system,call,log,verbose,command,agent,user
write = system,call,log,verbose,command,agent,user 
```

[星号服务器配置（img）](http://imageshack.us/photo/my-images/100/asteriskconf.png/)

我确定，用户设置没问题。

*当AMI 登录*是电话号码时，它不起作用，例如在软电话配置中。

蟒蛇调试：

```
[2012-04-17 14:17:44,072][asterisk] INFO:asterisk_click2dial:Asterisk Click2Dial from 103 to 101
[2012-04-17 14:17:44,078][asterisk] WARNING:web-services:The method action_dial_phone of the object crm.lead can not return `None` ! 
```

星号服务器调试：

```
== connect attempt from '192.168.1.106' unable to authenticate 
```

在通过 Wireshark 捕获 SIP 包时，我只看到了接收方号码 (101@192.168.1.100)。我没有看到 openerp 用户号（103），但只有 Unknown@192.168.1.106。但我第一次使用 Wireshark，所以也许没关系。

问题是：为什么OpenERP不能打电话到软电话，而软电话到软电话可以？

对不起我的英语不好 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T04:31:25.740

You need to concentrate on the authentication side. If OpenERP (which I am not familiar with) can only send a phone number (or extension number) as a username, then you need to set that as your username in manager.conf. The username portion is what's between the [ and ] above (in this case it's [openerp]. If you do not have the flexibility to set an actual username on the client side of OpenERP, then you'll need to simply replace the [openerp] with [phone_no or ext_no].

Then it should authenticate fine. Wireshark isn't likely to be terribly helpful in this instance.

# php - Wordpress 用 youtube 捕捉第一张图片

> ID：10192048
> 
> 赞同：1
> 
> 时间：2012-04-17T13:18:18.560
> 
> 标签：php, wordpress

我正在尝试向执行以下操作的 wordpress 站点添加一些功能...

*   检查第一个图像或第一个 youtube 嵌入的帖子
*   如果它首先找到图像然后返回它
*   如果它首先找到嵌入的 youtube，则返回屏幕截图

我在网上找到了几个类似的例子，但没有任何符合要求的例子，这是我目前使用的......

```
function catch_that_image() {
  global $post, $posts;
  $first_img = '';
  ob_start();
  ob_end_clean();
  $output = preg_match_all('/<img.+src=[\'"]([^\'"]+)[\'"].*>/i', $post->post_content,     $matches);
  $first_img = $matches [1] [0];

  if(empty($first_img)){ //Defines a default image
    $first_img = "/images/default.jpg";
  }
  return $first_img;
} 
```

这可以正常工作并正确返回帖子的第一张图片，我现在正在努力添加 youtube 功能，我在网上找到了以下代码片段，但我不知道如何将它添加到上面的函数中..

```
preg_match( '#https?://www\.youtube(?:\-nocookie)?\.com/embed/([A-Za-z0-9\-_]+)#', $markup, $matches );
    }

    // If we've found a YouTube video ID, create the thumbnail URL
    if ( isset( $matches[1] ) ) {
        $youtube_thumbnail = 'http://img.youtube.com/vi/' . $matches[1] . '/0.jpg';
    } 
```

如果帖子中有两者，则在图像上选择 youtube 视频拇指的逻辑可以稍后出现，现在我只有带有图像或嵌入 youtube 的帖子。任何人都可以帮助将两者结合起来吗？

* * *

****编辑****

在使用 hakres 优秀的例子和答案后，我正在使用这个......

```
function catch_image($content, $defaultImage = '/images/default.jpg')
{
    $image = $defaultImage;
    $found = strlen($content);
    foreach (array(
                 'image'   => array(
                     'regex' => '/<img.+src=[\'"]([^\'"]+)[\'"].*>/i',
                     'mask'  => '%s'
                 ),
                 'youtube' => array(
                     'regex' => '#(?:https?(?:a|vh?)?://)?(?:www\.)?    youtube(?:\-nocookie)?\.com/watch\?.*v=([A-Za-z0-9\-_]+)#',
                     'mask'  => 'http://img.youtube.com/vi/%s/2.jpg'
                 ),
             ) as $search)
    {
        extract($search);
        if (preg_match($regex, $content, $matches, PREG_OFFSET_CAPTURE)
            && $matches[1][1] < $found
        ) {
            list($image, $found) = $matches[1];
            $image = sprintf($mask, $image);
        }
    }
    return $image;
} 
```

我稍微修改了 youtube 正则表达式语句以及显示图像的掩码，一切正常。

但是我现在也需要尝试添加这些......

```
'regex' => '#<object[^>]+>.+?https?://www\.youtube(?:\-nocookie)?\.com/[ve]/([A-Za-z0-9\-_]+).+?</object>#s',
'regex' => '#https?://www\.youtube(?:\-nocookie)?\.com/[ve]/([A-Za-z0-9\-_]+)#',
'regex' => '#https?://www\.youtube(?:\-nocookie)?\.com/embed/([A-Za-z0-9\-_]+)#',
'regex' => '#(?:https?(?:a|vh?)?://)?(?:www\.)?youtube(?:\-nocookie)?\.com/watch\?.*v=([A-Za-z0-9\-_]+)#',
'regex' => '#(?:https?(?:a|vh?)?://)?youtu\.be/([A-Za-z0-9\-_]+)#', 
```

然后，这将涵盖嵌入 youtube 视频的所有不同方式

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T16:37:13.830

好的，这里有一些提示可以解决您的问题：

1.  您进行了多项测试，一个用于第一张图像，一个用于 youtube 视频。
2.  两种测试都可以成功或不成功。
3.  首先出现的一个测试（在位置上）应该获胜。

您所做的两个测试都基于正则表达式。你寻找一个模式，如果匹配，你挑出一个匹配。对于图像，图像 src，对于 youtube 视频，则需要将视频 ID 放入字符串中。因此，您进行匹配，如果正确，则选择一个匹配并将其集成到一个模式中。所以实际上两者都是一样的，只是图案和面具不同。例子：

```
array(
     'image'   => array(
         'regex' => '/<img.+src=[\'"]([^\'"]+)[\'"].*>/i',
         'mask'  => '%s'
     ),
     'youtube' => array(
         'regex' => '#https?://www\.youtube(?:\-nocookie)?\.com/embed/([A-Za-z0-9\-_]+)#',
         'mask'  => 'http://img.youtube.com/vi/%s0.jpg'
     ),
 ); 
```

因此，如果您将查找结果初始化为字符串末尾的默认图像，然后查找任何进一步的搜索并检查它们是否与它们匹配的位置匹配。如果他们在最后一场比赛之前匹配，他们获胜并且比赛将被更新：

```
/**
 * Representa! - Pimp ur posts media
 *
 * @author   hakre <http://hakre.wordpress.com>
 *
 * @param string $content
 * @param string $defaultImage (optional)
 *
 * @return string
 */
function representa_image($content, $defaultImage = '/images/default.jpg')
{
    $image = $defaultImage;
    $found = strlen($content);
    foreach (array(
                 'image'   => array(
                     'regex' => '/<img.+src=[\'"]([^\'"]+)[\'"].*>/i',
                     'mask'  => '%s'
                 ),
                 'youtube' => array(
                     'regex' => '#https?://www\.youtube(?:\-nocookie)?\.com/embed/([A-Za-z0-9\-_]+)#',
                     'mask'  => 'http://img.youtube.com/vi/%s0.jpg'
                 ),
             ) as $search)
    {
        extract($search);
        if (preg_match($regex, $content, $matches, PREG_OFFSET_CAPTURE)
            && $matches[1][1] < $found
        ) {
            list($image, $found) = $matches[1];
            $image = sprintf($mask, $image);
        }
    }
    return $image;
} 
```

用法：

```
$url = representa_image($post->post_content); 
```

我希望这可以简化您的问题，并让您了解如何解决此类问题。请注意，我正在使用`preg_match`的`PREG_OFFSET_CAPTURE`标志将返回与每个匹配项匹配的位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T13:24:30.583

好的，我为 filmyboss.com 实现此代码，它可以搜索该关键字的视频是否已经在数据库中，然后显示搜索结果，否则它会在 youtube 中使用该关键字搜索并更新它我认为您可以根据需要轻松调试它

```
 global $query_string;

                        if(have_posts()):
    //You already have it 
    else:
    $x = json_decode(file_get_contents("http://gdata.youtube.com/feeds/api/videos?q=some&format=5&max-results=1&v=2&duration=long&alt=jsonc"));
                        $y = $x->data;
                        $z = $y->items;
                        $d['_my_meta']['ytkey'] = $z['0']->id;
                        $t = $z['0']->title;
                        $post = array(
                        'post_status' => 'publish', 
                        'post_title' => $t, //The title of your post.
                        'post_type' => 'post');
                        echo $d; 
                        $key = "_my_meta";
                        $post_id = wp_insert_post( $post );
    endif; 
```

# saas - 软件即服务 - 方法

> ID：10192050
> 
> 赞同：0
> 
> 时间：2012-04-17T13:18:22.717
> 
> 标签：saas

我有一个桌面 ERP 应用程序，有大约 100 个客户在不同地点使用。由于管理此类环境的部署和安装很麻烦，我打算将其移至 Web 平台。我遇到了软件即服务的概念。我打算采用这种设计方法...我在这里面临的挑战是所有客户都将拥有自己的数据库，我想制作一个可以基于某些许可机制连接到所有数据库的单个 Web 应用程序...我不太确定如何做到这一点。

非常欢迎对此提供反馈和建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T07:13:32.017

SaaS 理念建立在两个原则之上。多租户原则和本地租户原则。首先，您将用户资料存储在一个数据库中，第二个用户创建的新数据库，第三个创建的新数据库等。在本地租户选项中，您将所有用户的所有数据存储在一个数据库中。首先-您需要一个数据库存储（mysql，msslg，其他），用于在浏览器中使用的Web应用程序（在php或html5中，adobe flash（OMG！）。Web应用程序与数据库连接-用户和使用的权限等等，就这么简单！

还有一个问题，您的 ERP 在其中存储用户、密码、文档和其他内容？根据答案，寻找解决方案。

# java - 卡住 om DefaultDataTable 组件 - 找不到错误

> ID：10192051
> 
> 赞同：0
> 
> 时间：2012-04-17T13:18:30.540
> 
> 标签：java, wicket

我卡住了，无法找出我在这里做错了什么。我已经阅读了几个关于它的教程，并尝试了“他们的”版本应该如何完成。Netbeans 没有给出任何错误，但我的浏览器有。她是我的密码。欢迎任何提示

RegistrerteBrukere.java

```
 package com.myapp.wicket;

import java.util.ArrayList;
import java.util.List;
import org.apache.wicket.PageParameters;
import org.apache.wicket.extensions.markup.html.repeater.data.table.DefaultDataTable;
import org.apache.wicket.extensions.markup.html.repeater.data.table.IColumn;
import org.apache.wicket.extensions.markup.html.repeater.data.table.PropertyColumn;
import org.apache.wicket.model.Model;

/**
 *
 * @author Bjørn J Aurheim
 */
public final class RegistrerteBrukere extends BasePage {

    private DefaultDataTable<Bruker> table;
    private int antallRekkerPrSide = 50;

    private BrukerProvider provider = new BrukerProvider();

    public RegistrerteBrukere() {
        super();

        // opprette testdata i liste for datatabellen

        // List<IColumn<Bruker>> kolonner = new ArrayList<IColumn<Bruker>>();
        List kolonner = new ArrayList();
        kolonner.add(new PropertyColumn<Bruker>(new Model("Fornavn"),"bruker","bruker"));
        kolonner.add(new PropertyColumn<Bruker>(new Model("Etternavn"),"etternavn","bruker"));
        kolonner.add(new PropertyColumn<Bruker>(new Model("Telefonnummer"),"telefonnummer","telefonnummer"));
        kolonner.add(new PropertyColumn<Bruker>(new Model("Mailadresse"),"mailadresse","mailadresse"));
        kolonner.add(new PropertyColumn<Bruker>(new Model("StartDato"),"startdato","startdato"));
        kolonner.add(new PropertyColumn<Bruker>(new Model("Passord"),"passord","passord"));
        table = new DefaultDataTable<Bruker>("brukertable", kolonner, provider, antallRekkerPrSide);
        add(table);

        }

    public RegistrerteBrukere(PageParameters params) {

        //TODO:  process page parameters

    }
} 
```

**RegistrerteBrukere.html**

```
 <?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns:wicket="http://wicket.apache.org">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
        <title>RegistrerteBrukere</title>
        <link rel="stylesheet" type="text/css" href="style.css"/>
    </head>
    <body>
        <wicket:extend>
            <table wicket:id="brukertable" class="brukere"></table>
        </wicket:extend>

    </body>
</html> 
```

BrukerProvider.java

```
public class BrukerProvider extends SortableDataProvider<Bruker>{
Bruker u = new Bruker();
Bruker u1 = new Bruker(); 
private static List<Bruker> brukere = Arrays.asList( );

        public BrukerProvider(){
            setSort("fornavn",true);
            u.setForNavn("Tore");
            u.setEtterNavn("Hansen");
            u.setTelefonnummer("99887766");
            u.setMailadresse("noen@home.her");
            u.setStartDato(new Date());
            u.setPassord("passord");
            brukere.add(u);
            u1.setForNavn("Hanne");
            u1.setEtterNavn("Ås");
            u1.setTelefonnummer("99324766");
            u1.setMailadresse("noener@homdfe.her");
            u1.setStartDato(new Date());
            u1.setPassord("passsdford");
            brukere.add(u1);
        }
@Override
        public Iterator<? extends Bruker> iterator(int first, int count){
          List<Bruker> data = new ArrayList<Bruker>(brukere);
          Collections.sort (data, new Comparator<Bruker>(){
        @Override
           public int compare(Bruker o1, Bruker o2) {
               int dir = getSort().isAscending() ? 1: -1;
               if ("fornavn".equals(getSort().getProperty())){
                   return dir * (o1.getForNavn().compareTo(o2.getForNavn()));
               } else {
                   return dir * (o1.getEtterNavn().compareTo(o2.getEtterNavn()));
               }

           }

        });
        return data.subList(first, Math.min(first + count, data.size())).iterator();
 }
@Override
        public int size(){
            return brukere.size();
        }
@Override
        public IModel<Bruker> model(Bruker object){
            return Model.of(object);
        }
} 
```

**我的错误信息：**

```
 WicketMessage: Can't instantiate page using constructor public com.myapp.wicket.RegistrerteBrukere()

Root cause:

java.lang.UnsupportedOperationException
     at java.util.AbstractList.add(AbstractList.java:148)
     at java.util.AbstractList.add(AbstractList.java:108)
     at com.myapp.wicket.BrukerProvider.<init>(BrukerProvider.java:29)
     at com.myapp.wicket.RegistrerteBrukere.<init>(RegistrerteBrukere.java:24)
     at java.lang.reflect.Constructor.newInstance(Constructor.java:525)
     at org.apache.wicket.session.DefaultPageFactory.createPage(DefaultPageFactory.java:192)
     at org.apache.wicket.session.DefaultPageFactory.newPage(DefaultPageFactory.java:57)
     at org.apache.wicket.request.target.component.BookmarkablePageRequestTarget.newPage(BookmarkablePageRequestTarget.java:298)
     at org.apache.wicket.request.target.component.BookmarkablePageRequestTarget.getPage(BookmarkablePageRequestTarget.java:320)
     at org.apache.wicket.request.target.component.BookmarkablePageRequestTarget.processEvents(BookmarkablePageRequestTarget.java:234)
     at org.apache.wicket.request.AbstractRequestCycleProcessor.processEvents(AbstractRequestCycleProcessor.java:92)
     at org.apache.wicket.RequestCycle.processEventsAndRespond(RequestCycle.java:1279)
     at org.apache.wicket.RequestCycle.step(RequestCycle.java:1358)
     at org.apache.wicket.RequestCycle.steps(RequestCycle.java:1465)
     at org.apache.wicket.RequestCycle.request(RequestCycle.java:545)
     at org.apache.wicket.protocol.http.WicketFilter.doGet(WicketFilter.java:486)
     at org.apache.wicket.protocol.http.WicketFilter.doFilter(WicketFilter.java:319)
     at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)
     at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
     at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:224)
     at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:169)
     at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)
     at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)
     at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:100)
     at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:929)
     at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
     at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:405)
     at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:964)
     at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:515)
     at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:304)
     at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
     at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
     at java.lang.Thread.run(Thread.java:722)

Complete stack:

org.apache.wicket.WicketRuntimeException: Can't instantiate page using constructor public com.myapp.wicket.RegistrerteBrukere()
     at org.apache.wicket.session.DefaultPageFactory.createPage(DefaultPageFactory.java:212)
     at org.apache.wicket.session.DefaultPageFactory.newPage(DefaultPageFactory.java:57)
     at org.apache.wicket.request.target.component.BookmarkablePageRequestTarget.newPage(BookmarkablePageRequestTarget.java:298)
     at org.apache.wicket.request.target.component.BookmarkablePageRequestTarget.getPage(BookmarkablePageRequestTarget.java:320)
     at org.apache.wicket.request.target.component.BookmarkablePageRequestTarget.processEvents(BookmarkablePageRequestTarget.java:234)
     at org.apache.wicket.request.AbstractRequestCycleProcessor.processEvents(AbstractRequestCycleProcessor.java:92)
     at org.apache.wicket.RequestCycle.processEventsAndRespond(RequestCycle.java:1279)
     at org.apache.wicket.RequestCycle.step(RequestCycle.java:1358)
     at org.apache.wicket.RequestCycle.steps(RequestCycle.java:1465)
     at org.apache.wicket.RequestCycle.request(RequestCycle.java:545)
     at org.apache.wicket.protocol.http.WicketFilter.doGet(WicketFilter.java:486)

java.lang.reflect.InvocationTargetException
     at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
     at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:57)
     at java.lang.reflect.Constructor.newInstance(Constructor.java:525)
     at org.apache.wicket.session.DefaultPageFactory.createPage(DefaultPageFactory.java:192)
     at org.apache.wicket.session.DefaultPageFactory.newPage(DefaultPageFactory.java:57)
     at org.apache.wicket.request.target.component.BookmarkablePageRequestTarget.newPage(BookmarkablePageRequestTarget.java:298)
     at org.apache.wicket.request.target.component.BookmarkablePageRequestTarget.getPage(BookmarkablePageRequestTarget.java:320)
     at org.apache.wicket.request.target.component.BookmarkablePageRequestTarget.processEvents(BookmarkablePageRequestTarget.java:234)
     at org.apache.wicket.request.AbstractRequestCycleProcessor.processEvents(AbstractRequestCycleProcessor.java:92)
     at org.apache.wicket.RequestCycle.processEventsAndRespond(RequestCycle.java:1279)
     at org.apache.wicket.RequestCycle.step(RequestCycle.java:1358)
     at org.apache.wicket.RequestCycle.steps(RequestCycle.java:1465)
     at org.apache.wicket.RequestCycle.request(RequestCycle.java:545)
     at org.apache.wicket.protocol.http.WicketFilter.doGet(WicketFilter.java:486)

display page view 
```

希望这是足够的信息..

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-17T13:27:38.963

问题在于您在此处声明列表：

```
private static List<Bruker> brukere = Arrays.asList( ); 
```

与您可能猜到的相反，[`Arrays.asList()`](http://docs.oracle.com/javase/6/docs/api/java/util/Arrays.html#asList%28T...%29)不返回[`ArrayList`](http://docs.oracle.com/javase/6/docs/api/java/util/ArrayList.html). 相反，它返回（引用 Javadoc）“由指定数组支持的固定大小的列表”。这里的关键词是“固定大小”，这意味着您不能增加或减少数组的大小。换句话说，`Arrays.asList()`应将返回的 List 视为数组的类 Collection 视图，而不是由数组支持的新列表。

您可以通过简单地将上面的行更改为：

```
private static List<Bruker> brukere = new ArrayList<Bruker>(); 
```

哪个将使用[`ArrayList`](http://docs.oracle.com/javase/6/docs/api/java/util/ArrayList.html)，这是[`List`](http://docs.oracle.com/javase/6/docs/api/java/util/List.html).

顺便说一句，您可能会看一下[这篇博客文章](https://kamleshkr.wordpress.com/2010/02/17/inside-java-arrays-aslistt-a/)，它更深入地研究了[`Arrays.asList()`](http://docs.oracle.com/javase/6/docs/api/java/util/Arrays.html#asList%28T...%29).

还值得注意的是`UnsupportedOperationException`，[对于`List.add()`](http://docs.oracle.com/javase/6/docs/api/java/util/List.html#add%28E%29). 这似乎违反了接口的预期性质，但 Java`List`类实际上提供了许多方法（`add()`、`addAll()`、`remove()`、`clear()`等，基本上是旨在更改底层存储列表的方法），实现可以选择不简单地实现投掷`UnsupportedOperationException`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T07:30:15.877

将 Arrays.asList 更改为 ArrayList 后，我​​仍然遇到错误。已通过替换更正

```
 List kolonner = new ArrayList();
    kolonner.add(new PropertyColumn<Bruker>(new Model("Fornavn"),"bruker","bruker"));
    kolonner.add(new PropertyColumn<Bruker>(new Model("Etternavn"),"etternavn","bruker"));
    kolonner.add(new PropertyColumn<Bruker>(new Model("Telefonnummer"),"telefonnummer","telefonnummer"));
    kolonner.add(new PropertyColumn<Bruker>(new Model("Mailadresse"),"mailadresse","mailadresse"));
    kolonner.add(new PropertyColumn<Bruker>(new Model("StartDato"),"startdato","startdato"));
    kolonner.add(new PropertyColumn<Bruker>(new Model("Passord"),"passord","passord"));
    table = new DefaultDataTable<Bruker>("brukertable", kolonner, provider, antallRekkerPrSide); 
```

和：

```
 `List kolonner = new ArrayList();
    kolonner.add(new PropertyColumn<Bruker>(new Model("Fornavn"),"fornavn","fornavn"));
    kolonner.add(new PropertyColumn<Bruker>(new Model("Etternavn"),"etternavn","etternavn"));
    kolonner.add(new PropertyColumn<Bruker>(new Model("Telefonnummer"),"telefonnummer","telefonnummer"));
    kolonner.add(new PropertyColumn<Bruker>(new Model("Mailadresse"),"mailadresse","mailadresse"));
    kolonner.add(new PropertyColumn<Bruker>(new Model("StartDato"),"startdato","startDato"));
    kolonner.add(new PropertyColumn<Bruker>(new Model("Passord"),"passord","passord"));
    table = new DefaultDataTable<Bruker>("brukertable", kolonner, provider, antallRekkerPrSide);` 
```

在 RegistrerteBrukere.java 文件中

# c# - WPF MVVM后台打印数据绑定问题

> ID：10192054
> 
> 赞同：3
> 
> 时间：2012-04-17T13:18:42.403
> 
> 标签：c#, wpf, data-binding, mvvm, printing

我正在使用 wpf/mvvm 开发一个销售点应用程序。在交易生命周期的许多部分，都会在后台打印收据。我已经使用其他示例在后台生成和打印收据。我在后台打印一个 UserControl，一切看起来都很棒。

然后，我为控件创建了 ViewModel，因此它可以加载要打印的事务。我从 2 个基本文本框开始 - 文本标题“客户收据”和顶部标题“打印日期：MM/dd/yy hh:mm tt”。

这就是我按下打印按钮时调试器显示生命周期的方式：

*   创建新的控件实例。
*   创建 ViewModel 的新实例
*   设置 INPC 属性的文本
*   在控件上运行测量以获得所需的预打印尺寸
*   加载打印对话框并检索名称打印队列
*   缩放控件的大小以适合收据纸（不应该为我当前选择的打印机缩放，因为 ImageArea 宽度设置为与我的 UC 相同）
*   根据“新”缩放图像大小重新测量和排列网格
*   调用 PrintDialog.PrintVisual - 发送 UserControl
*   打印机吐出收据 - 没有数据绑定文本
*   然后，我的调试器进入 get { return _HeaderText; 部分代码 - 在控件已经打印之后。

有没有办法在控件被发送到打印机之前强制对其进行数据绑定，而不必在面板中加载控件并使其可见？例如，我希望能够刷信用卡并让它在后台打印带有签名行的收据，从一个要求 CC 详细信息（或刷卡）的小弹出窗口。

有没有更好的方法来实现这一目标？

打印收据方法：

```
ClientReceiptView control = new ClientReceiptView(Message);       
System.Windows.Controls.PrintDialog printDlg = new System.Windows.Controls.PrintDialog();
PrintQueue ReceiptPrinter = new LocalPrintServer().GetPrintQueue("CITIZEN CT-S310");
PrintCapabilities PC = ReceiptPrinter.GetPrintCapabilities();
printDlg.PrintQueue = ReceiptPrinter;
control.Measure(new Size(Double.PositiveInfinity, Double.PositiveInfinity));
Size PreGridSize = control.DesiredSize;
double Scale = Math.Min(PC.PageImageableArea.ExtentWidth / PreGridSize.Width, PC.PageImageableArea.ExtentHeight / PreGridSize.Height);
control.LayoutTransform = new System.Windows.Media.ScaleTransform(Scale, Scale);
Size PaperSize = new Size(PC.PageImageableArea.ExtentWidth, Math.Min(PC.PageImageableArea.ExtentHeight, PreGridSize.Height));
control.Measure(PaperSize);
Point ptGrid = new Point(PC.PageImageableArea.OriginWidth, PC.PageImageableArea.OriginHeight);
control.Arrange(new Rect(ptGrid, PaperSize));
printDlg.PrintVisual(control, "My App"); 
```

和视图构造函数（带参数）

```
public ClientReceiptView(string Header)
{
    InitializeComponent();
    vm = new ClientReceiptViewModel(Header);
    this.DataContext = vm;
} 
```

和视图模型：

```
public class ClientReceiptViewModel : ViewModelBase
{
    #region Properties

    private string _HeaderText;

    public string HeaderText
    {
        get { return _HeaderText; }
        set { _HeaderText = value; OnPropertyChanged("HeaderText"); }
    }

    private int _TripID;

    public int TripID
    {
        get { return _TripID; }
        set { _TripID = value; OnPropertyChanged("TripID"); }
    }

    private string _PrintedOn;

    public string PrintedOn
    {
        get { return _PrintedOn; }
        set { _PrintedOn = value; OnPropertyChanged("PrintedOn"); }
    }

    #endregion

    public ClientReceiptViewModel(string Header)
    {
        HeaderText = Header;
        TripID = 2220013;
        PrintedOn = "Printed: " + DateTime.Now.ToString("MM/dd/yy hh:mm tt");
    }
} 
```

编辑：从绑定/创建调用堆栈，在 OnPropertyChanged("HeaderText") 上有一个中断：

```
Namespace.Main.POS.Receipts.ClientReceiptViewModel.PrintedOn.set(string value) Line 38  C#
Namespace.Main.POS.Receipts.ClientReceiptViewModel.SetData(string Header) Line 79 + 0x4f bytes  C#
Namespace.Main.POS.Receipts.ClientReceiptView.ClientReceiptView(string Header) Line 28 + 0x13 bytes C#
Namespace.Main.POS.Receipts.PrintReceipt.PrintClientReceipt(string Message) Line 12 + 0x1e bytes    C#
Namespace.Main.MainWindowView.button1_Click(object sender, System.Windows.RoutedEventArgs e) Line 23 + 0xb bytes    C#
PresentationCore.dll!System.Windows.RoutedEventHandlerInfo.InvokeHandler(object target, System.Windows.RoutedEventArgs routedEventArgs) + 0x78 bytes    
PresentationCore.dll!System.Windows.EventRoute.InvokeHandlersImpl(object source, System.Windows.RoutedEventArgs args, bool reRaised) + 0xbe bytes   
PresentationCore.dll!System.Windows.UIElement.RaiseEventImpl(System.Windows.DependencyObject sender, System.Windows.RoutedEventArgs args) + 0x79 bytes  
PresentationCore.dll!System.Windows.UIElement.RaiseEvent(System.Windows.RoutedEventArgs e) + 0x17 bytes 
PresentationFramework.dll!System.Windows.Controls.Primitives.ButtonBase.OnClick() + 0x4b bytes  
PresentationFramework.dll!System.Windows.Controls.Button.OnClick() + 0x4d bytes 
PresentationFramework.dll!System.Windows.Controls.Primitives.ButtonBase.OnMouseLeftButtonUp(System.Windows.Input.MouseButtonEventArgs e) + 0x9e bytes   
PresentationCore.dll!System.Windows.UIElement.OnMouseLeftButtonUpThunk(object sender, System.Windows.Input.MouseButtonEventArgs e) + 0x6c bytes 
PresentationCore.dll!System.Windows.Input.MouseButtonEventArgs.InvokeEventHandler(System.Delegate genericHandler, object genericTarget) + 0x31 bytes    
PresentationCore.dll!System.Windows.RoutedEventArgs.InvokeHandler(System.Delegate handler, object target) + 0x29 bytes  
PresentationCore.dll!System.Windows.RoutedEventHandlerInfo.InvokeHandler(object target, System.Windows.RoutedEventArgs routedEventArgs) + 0x3e bytes    
PresentationCore.dll!System.Windows.EventRoute.InvokeHandlersImpl(object source, System.Windows.RoutedEventArgs args, bool reRaised) + 0xbe bytes   
PresentationCore.dll!System.Windows.UIElement.ReRaiseEventAs(System.Windows.DependencyObject sender, System.Windows.RoutedEventArgs args, System.Windows.RoutedEvent newEvent) + 0x114 bytes    
PresentationCore.dll!System.Windows.UIElement.OnMouseUpThunk(object sender, System.Windows.Input.MouseButtonEventArgs e) + 0xc5 bytes   
PresentationCore.dll!System.Windows.Input.MouseButtonEventArgs.InvokeEventHandler(System.Delegate genericHandler, object genericTarget) + 0x31 bytes    
PresentationCore.dll!System.Windows.RoutedEventArgs.InvokeHandler(System.Delegate handler, object target) + 0x29 bytes  
PresentationCore.dll!System.Windows.RoutedEventHandlerInfo.InvokeHandler(object target, System.Windows.RoutedEventArgs routedEventArgs) + 0x3e bytes    
PresentationCore.dll!System.Windows.EventRoute.InvokeHandlersImpl(object source, System.Windows.RoutedEventArgs args, bool reRaised) + 0xbe bytes   
PresentationCore.dll!System.Windows.UIElement.RaiseEventImpl(System.Windows.DependencyObject sender, System.Windows.RoutedEventArgs args) + 0x79 bytes  
PresentationCore.dll!System.Windows.UIElement.RaiseTrustedEvent(System.Windows.RoutedEventArgs args) + 0x41 bytes   
PresentationCore.dll!System.Windows.UIElement.RaiseEvent(System.Windows.RoutedEventArgs args, bool trusted) + 0x2c bytes    
PresentationCore.dll!System.Windows.Input.InputManager.ProcessStagingArea() + 0x1ff bytes   
PresentationCore.dll!System.Windows.Input.InputManager.ProcessInput(System.Windows.Input.InputEventArgs input) + 0x45 bytes 
PresentationCore.dll!System.Windows.Input.InputProviderSite.ReportInput(System.Windows.Input.InputReport inputReport) + 0x62 bytes  
PresentationCore.dll!System.Windows.Interop.HwndMouseInputProvider.ReportInput(System.IntPtr hwnd, System.Windows.Input.InputMode mode, int timestamp, System.Windows.Input.RawMouseActions actions, int x, int y, int wheel) + 0x2c2 bytes 
PresentationCore.dll!System.Windows.Interop.HwndMouseInputProvider.FilterMessage(System.IntPtr hwnd, MS.Internal.Interop.WindowMessage msg, System.IntPtr wParam, System.IntPtr lParam, ref bool handled) + 0x67d bytes 
PresentationCore.dll!System.Windows.Interop.HwndSource.InputFilterMessage(System.IntPtr hwnd, int msg, System.IntPtr wParam, System.IntPtr lParam, ref bool handled) + 0x75 bytes   
WindowsBase.dll!MS.Win32.HwndWrapper.WndProc(System.IntPtr hwnd, int msg, System.IntPtr wParam, System.IntPtr lParam, ref bool handled) + 0xbe bytes    
WindowsBase.dll!MS.Win32.HwndSubclass.DispatcherCallbackOperation(object o) + 0x7d bytes    
WindowsBase.dll!System.Windows.Threading.ExceptionWrapper.InternalRealCall(System.Delegate callback, object args, int numArgs) + 0x53 bytes 
WindowsBase.dll!MS.Internal.Threading.ExceptionFilterHelper.TryCatchWhen(object source, System.Delegate method, object args, int numArgs, System.Delegate catchHandler) + 0x42 bytes    
WindowsBase.dll!System.Windows.Threading.Dispatcher.InvokeImpl(System.Windows.Threading.DispatcherPriority priority, System.TimeSpan timeout, System.Delegate method, object args, int numArgs) + 0xb4 bytes    
WindowsBase.dll!MS.Win32.HwndSubclass.SubclassWndProc(System.IntPtr hwnd, int msg, System.IntPtr wParam, System.IntPtr lParam) + 0x104 bytes    
[Native to Managed Transition]  
[Managed to Native Transition]  
WindowsBase.dll!System.Windows.Threading.Dispatcher.PushFrameImpl(System.Windows.Threading.DispatcherFrame frame) + 0xc1 bytes  
WindowsBase.dll!System.Windows.Threading.Dispatcher.PushFrame(System.Windows.Threading.DispatcherFrame frame) + 0x49 bytes  
PresentationFramework.dll!System.Windows.Application.RunDispatcher(object ignore) + 0x5b bytes  
PresentationFramework.dll!System.Windows.Application.RunInternal(System.Windows.Window window) + 0x74 bytes 
PresentationFramework.dll!System.Windows.Application.Run(System.Windows.Window window) + 0x2b bytes 
PresentationFramework.dll!System.Windows.Application.Run() + 0x1b bytes 
Namespace.App.Main() + 0x5e bytes   C#
[Native to Managed Transition]  
[Managed to Native Transition]  
mscorlib.dll!System.AppDomain.nExecuteAssembly(System.Reflection.RuntimeAssembly assembly, string[] args) + 0x9 bytes   
mscorlib.dll!System.Runtime.Hosting.ManifestRunner.Run(bool checkAptModel) + 0x6e bytes 
mscorlib.dll!System.Runtime.Hosting.ManifestRunner.ExecuteAsAssembly() + 0x90 bytes 
mscorlib.dll!System.Runtime.Hosting.ApplicationActivator.CreateInstance(System.ActivationContext activationContext, string[] activationCustomData) + 0x65 bytes 
mscorlib.dll!System.Runtime.Hosting.ApplicationActivator.CreateInstance(System.ActivationContext activationContext) + 0xd bytes 
mscorlib.dll!System.Activator.CreateInstance(System.ActivationContext activationContext) + 0x44 bytes   
Microsoft.VisualStudio.HostingProcess.Utilities.dll!Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssemblyDebugInZone() + 0x23 bytes   
mscorlib.dll!System.Threading.ThreadHelper.ThreadStart_Context(object state) + 0x63 bytes   
mscorlib.dll!System.Threading.ExecutionContext.Run(System.Threading.ExecutionContext executionContext, System.Threading.ContextCallback callback, object state, bool ignoreSyncCtx) + 0xb0 bytes    
mscorlib.dll!System.Threading.ExecutionContext.Run(System.Threading.ExecutionContext executionContext, System.Threading.ContextCallback callback, object state) + 0x2c bytes    
mscorlib.dll!System.Threading.ThreadHelper.ThreadStart() + 0x44 bytes   
[Native to Managed Transition] 
```

然后在 printDlg.PrintVisual(control, "My App"); 发出，收据打印出来，然后在断点上的调用堆栈 get { return _PrintedOn; }：

```
Namespace.Main.POS.Receipts.ClientReceiptViewModel.PrintedOn.get() Line 37  C#
[Native to Managed Transition]  
PresentationFramework.dll!MS.Internal.Data.PropertyPathWorker.GetValue(object item, int level) + 0x108 bytes    
PresentationFramework.dll!MS.Internal.Data.PropertyPathWorker.RawValue(int k) + 0x4a bytes  
PresentationFramework.dll!MS.Internal.Data.PropertyPathWorker.RawValue() + 0x12 bytes   
PresentationFramework.dll!MS.Internal.Data.ClrBindingWorker.RawValue() + 0x11 bytes 
PresentationFramework.dll!System.Windows.Data.BindingExpression.TransferValue(object newValue, bool isASubPropertyChange) + 0xa7 bytes  
PresentationFramework.dll!System.Windows.Data.BindingExpression.Activate(object item) + 0x194 bytes 
PresentationFramework.dll!System.Windows.Data.BindingExpression.AttachToContext(System.Windows.Data.BindingExpression.AttachAttempt attempt) + 0x38d bytes  
PresentationFramework.dll!System.Windows.Data.BindingExpression.MS.Internal.Data.IDataBindEngineClient.AttachToContext(bool lastChance) + 0x19 bytes    
PresentationFramework.dll!MS.Internal.Data.DataBindEngine.Task.Run(bool lastChance) + 0x31 bytes    
PresentationFramework.dll!MS.Internal.Data.DataBindEngine.Run(object arg) + 0xb6 bytes  
WindowsBase.dll!System.Windows.Threading.ExceptionWrapper.InternalRealCall(System.Delegate callback, object args, int numArgs) + 0x53 bytes 
WindowsBase.dll!MS.Internal.Threading.ExceptionFilterHelper.TryCatchWhen(object source, System.Delegate method, object args, int numArgs, System.Delegate catchHandler) + 0x42 bytes    
WindowsBase.dll!System.Windows.Threading.DispatcherOperation.InvokeImpl() + 0x8d bytes  
WindowsBase.dll!System.Windows.Threading.DispatcherOperation.InvokeInSecurityContext(object state) + 0x38 bytes 
mscorlib.dll!System.Threading.ExecutionContext.runTryCode(object userData) + 0x51 bytes 
[Native to Managed Transition]  
[Managed to Native Transition]  
mscorlib.dll!System.Threading.ExecutionContext.RunInternal(System.Threading.ExecutionContext executionContext, System.Threading.ContextCallback callback, object state) + 0x6a bytes    
mscorlib.dll!System.Threading.ExecutionContext.Run(System.Threading.ExecutionContext executionContext, System.Threading.ContextCallback callback, object state, bool ignoreSyncCtx) + 0x7e bytes    
mscorlib.dll!System.Threading.ExecutionContext.Run(System.Threading.ExecutionContext executionContext, System.Threading.ContextCallback callback, object state) + 0x2c bytes    
WindowsBase.dll!System.Windows.Threading.DispatcherOperation.Invoke() + 0x68 bytes  
WindowsBase.dll!System.Windows.Threading.Dispatcher.ProcessQueue() + 0x15e bytes    
WindowsBase.dll!System.Windows.Threading.Dispatcher.WndProcHook(System.IntPtr hwnd, int msg, System.IntPtr wParam, System.IntPtr lParam, ref bool handled) + 0x63 bytes 
WindowsBase.dll!MS.Win32.HwndWrapper.WndProc(System.IntPtr hwnd, int msg, System.IntPtr wParam, System.IntPtr lParam, ref bool handled) + 0xbe bytes    
WindowsBase.dll!MS.Win32.HwndSubclass.DispatcherCallbackOperation(object o) + 0x7d bytes    
WindowsBase.dll!System.Windows.Threading.ExceptionWrapper.InternalRealCall(System.Delegate callback, object args, int numArgs) + 0x53 bytes 
WindowsBase.dll!MS.Internal.Threading.ExceptionFilterHelper.TryCatchWhen(object source, System.Delegate method, object args, int numArgs, System.Delegate catchHandler) + 0x42 bytes    
WindowsBase.dll!System.Windows.Threading.Dispatcher.InvokeImpl(System.Windows.Threading.DispatcherPriority priority, System.TimeSpan timeout, System.Delegate method, object args, int numArgs) + 0xb4 bytes    
WindowsBase.dll!MS.Win32.HwndSubclass.SubclassWndProc(System.IntPtr hwnd, int msg, System.IntPtr wParam, System.IntPtr lParam) + 0x104 bytes    
[Native to Managed Transition]  
[Managed to Native Transition]  
WindowsBase.dll!System.Windows.Threading.Dispatcher.PushFrameImpl(System.Windows.Threading.DispatcherFrame frame) + 0xc1 bytes  
WindowsBase.dll!System.Windows.Threading.Dispatcher.PushFrame(System.Windows.Threading.DispatcherFrame frame) + 0x49 bytes  
PresentationFramework.dll!System.Windows.Application.RunDispatcher(object ignore) + 0x5b bytes  
PresentationFramework.dll!System.Windows.Application.RunInternal(System.Windows.Window window) + 0x74 bytes 
PresentationFramework.dll!System.Windows.Application.Run(System.Windows.Window window) + 0x2b bytes 
PresentationFramework.dll!System.Windows.Application.Run() + 0x1b bytes 
Namespace.App.Main() + 0x5e bytes   C#
[Native to Managed Transition]  
[Managed to Native Transition]  
mscorlib.dll!System.AppDomain.nExecuteAssembly(System.Reflection.RuntimeAssembly assembly, string[] args) + 0x9 bytes   
mscorlib.dll!System.Runtime.Hosting.ManifestRunner.Run(bool checkAptModel) + 0x6e bytes 
mscorlib.dll!System.Runtime.Hosting.ManifestRunner.ExecuteAsAssembly() + 0x90 bytes 
mscorlib.dll!System.Runtime.Hosting.ApplicationActivator.CreateInstance(System.ActivationContext activationContext, string[] activationCustomData) + 0x65 bytes 
mscorlib.dll!System.Runtime.Hosting.ApplicationActivator.CreateInstance(System.ActivationContext activationContext) + 0xd bytes 
mscorlib.dll!System.Activator.CreateInstance(System.ActivationContext activationContext) + 0x44 bytes   
Microsoft.VisualStudio.HostingProcess.Utilities.dll!Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssemblyDebugInZone() + 0x23 bytes   
mscorlib.dll!System.Threading.ThreadHelper.ThreadStart_Context(object state) + 0x63 bytes   
mscorlib.dll!System.Threading.ExecutionContext.Run(System.Threading.ExecutionContext executionContext, System.Threading.ContextCallback callback, object state, bool ignoreSyncCtx) + 0xb0 bytes    
mscorlib.dll!System.Threading.ExecutionContext.Run(System.Threading.ExecutionContext executionContext, System.Threading.ContextCallback callback, object state) + 0x2c bytes    
mscorlib.dll!System.Threading.ThreadHelper.ThreadStart() + 0x44 bytes   
[Native to Managed Transition] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T15:36:58.827

使用[Dispatcher](http://msdn.microsoft.com/en-us/library/system.windows.threading.dispatcher.aspx)在[DispatcherPriority](http://msdn.microsoft.com/en-us/library/system.windows.threading.dispatcherpriority.aspx)之后将打印作业排队`DataBind`。这样，您的所有数据绑定都会在打印作业之前得到处理。

```
Dispatcher.BeginInvoke(DispatcherPriority.Loaded,
    new Action(delegate() { printDlg.PrintVisual(control, "My App"); } )); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T14:41:37.873

我不知道是什么触发了初始绑定更新（你能从你的调用堆栈中看出吗？）。我也有兴趣了解一下。

解决它的一种方法可能是在 ViewModel设置为视图上下文**后设置它的值。**也许 PropertyChanged 通知将强制绑定更新，例如：

```
public ClientReceiptView(string Header)
{
    InitializeComponent();
    vm = new ClientReceiptViewModel();
    this.DataContext = vm;
    vm.SetHeader(Header);
} 
```

虽然只是猜测。：/

# java - Android getOrientation() 方法返回错误结果

> ID：10192057
> 
> 赞同：10
> 
> 时间：2012-04-17T13:18:48.880
> 
> 标签：java, android, orientation

我正在创建 3D Compass 应用程序。

我正在使用[getOrientation](http://developer.android.com/reference/android/hardware/SensorManager.html#getOrientation%28float%5B%5D,%20float%5B%5D%29)方法来获取方向（几乎与[此处](https://stackoverflow.com/questions/2963705/using-getrotationmatrix-and-getorientation-in-android-2-1)相同的实现）。如果我将手机放在桌子上，效果很好，但是当手机顶部指向天空（图片上减去 Z 轴；球体是地球）时，getOrientation 开始给出非常糟糕的结果。它给出了 Z 轴在 0 到 180 度之间的几个实际度数的值。有什么办法可以抑制这种行为？我制作了一个描述问题的[小视频（抱歉质量不好）。](http://youtu.be/U1o5TsCKOd0)提前致谢。

![在此处输入图像描述](../Images/fecd63d14cb77bab0b4bc584f128942b.png)

**解决方案**：当您旋转模型时，有以下区别：

```
gl.glRotatef(_angleY, 0f, 1f, 0f); //ROLL
gl.glRotatef(_angleX, 1f, 0f, 0f); //ELEVATION
gl.glRotatef(_angleZ, 0f, 0f, 1f); //AZIMUTH

gl.glRotatef(_angleX, 1f, 0f, 0f); //ELEVATION
gl.glRotatef(_angleY, 0f, 1f, 0f); //ROLL
gl.glRotatef(_angleZ, 0f, 0f, 1f); //AZIMUTH 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-29T05:36:58.397

好吧，我可以看到您的这种方法至少有一个问题。

我假设您将与磁力计相对应的 3D 矢量与平均低通滤波器相结合以平滑数据。尽管这种方法对于没有间断变化的传感器值非常有效，例如来自加速度计的原始数据，但对于从磁力计获取的角度变量来说，它并没有那么好用。为什么，有人可能会问？

因为这些角度变量（方位角、俯仰角、滚动角）有一个上限和一个下限，这意味着任何高于 180 度的值，比如 181 度，都会环绕到 181-360 = -179 度，并且任何变量-180 度以下会在另一个方向环绕。因此，当其中一个角度变量接近这些阈值（180 或 -180）时，该变量将倾向于振荡到接近这两个极端的值。当你盲目地对这些值应用低通滤波器时，你会得到从 180 度到 -180 度的平滑减小，或者从 -180 到 180 度的平滑增加。无论哪种方式，结果看起来都非常像您上面的视频......只要直接将平均缓冲区应用于原始角度数据`getOrientation(...)`，这个问题将会出现（并且不仅应该出现在手机直立的情况下，而且还应该出现在方位角环绕的情况下......也许你也可以测试这些错误......） .

您说您使用 1 的缓冲区大小对此进行了测试。理论上，如果根本没有平均，则问题不应该存在，尽管在我过去见过的循环缓冲区的某些实现中，这可能意味着存在仍然以至少 1 个过去值进行平均，而不是根本没有平均。如果这是您的情况，我们已经找到了您的错误的根本原因。

不幸的是，在坚持使用标准平均滤波器的同时，没有多少优雅的解决方案可以实现。在这种情况下我通常做的是切换到另一种类型的低通滤波器，它不需要任何深度缓冲区来操作：一个简单的 IIR 滤波器（1 阶）：

*差异 = x[n] - y[n-1]*

*y[n] - y[n-1] = alpha* * *(x[n] - y[n-1]) = alpha* * *diff*

...其中*y*是滤波后的角度，*x*是原始角度，并且*alpha* <1 类似于时间常数，因为 alpha=1 对应于无滤波器的情况，并且低通滤波器的频率截止得到随着 alpha 接近零而降低。现在，敏锐的眼睛可能已经注意到这对应于一个简单的*Proportional Controller*。

这样的过滤器允许补偿角度值的环绕，因为我们可以为*diff*添加或减去 360以确保*abs(diff)<=180*，这反过来又确保过滤后的角度值将始终增加/减少达到其“设定点”的最佳方向。

将定期安排的示例函数调用计算给定原始角度值 x 的过滤角度值 y，可能是这样的：

```
private float restrictAngle(float tmpAngle){
    while(tmpAngle>=180) tmpAngle-=360;
    while(tmpAngle<-180) tmpAngle+=360;
    return tmpAngle;
}

//x is a raw angle value from getOrientation(...)
//y is the current filtered angle value
private float calculateFilteredAngle(float x, float y){ 
    final float alpha = 0.1f;
    float diff = x-y;

    //here, we ensure that abs(diff)<=180
    diff = restrictAngle(diff);

    y += alpha*diff;
    //ensure that y stays within [-180, 180[ bounds
    y = restrictAngle(y);

    return y;
} 
```

然后可以使用类似这样的方法定期调用该函数`calculateFilteredAngle(float x, float y)`（例如来自函数的方位角`getOrientation(...)`：

```
filteredAzimuth = calculateFilteredAngle(azimuth, filteredAzimuth); 
```

使用这种方法，滤波器不会像 OP 提到的平均滤波器那样行为不端。

由于我无法加载 OP 上传的 .apk，我决定实施我自己的测试项目，以查看更正是否有效。这是整个代码（它不使用 .XML 作为主布局，所以我没有包含它）。只需将它复制到一个测试项目，看看它是否适用于特定设备（在 HTC Desire w/Android v. 2.1 上测试功能）：

文件 1：Compass3DActivity.java：

```
package com.epichorns.compass3D;

import android.app.Activity;
import android.content.Context;
import android.hardware.Sensor;
import android.hardware.SensorEvent;
import android.hardware.SensorEventListener;
import android.hardware.SensorManager;
import android.os.Bundle;
import android.view.ViewGroup;
import android.widget.LinearLayout;
import android.widget.TextView;

public class Compass3DActivity extends Activity {
    //Textviews for showing angle data
    TextView mTextView_azimuth;
    TextView mTextView_pitch;
    TextView mTextView_roll;

    TextView mTextView_filtered_azimuth;
    TextView mTextView_filtered_pitch;
    TextView mTextView_filtered_roll;

    float mAngle0_azimuth=0;
    float mAngle1_pitch=0;
    float mAngle2_roll=0;

    float mAngle0_filtered_azimuth=0;
    float mAngle1_filtered_pitch=0;
    float mAngle2_filtered_roll=0;

    private Compass3DView mCompassView;

    private SensorManager sensorManager;
    //sensor calculation values
    float[] mGravity = null;
    float[] mGeomagnetic = null;
    float Rmat[] = new float[9];
    float Imat[] = new float[9];
    float orientation[] = new float[3];
    SensorEventListener mAccelerometerListener = new SensorEventListener(){
        public void onAccuracyChanged(Sensor sensor, int accuracy) {}

        public void onSensorChanged(SensorEvent event) {
            if (event.sensor.getType() == Sensor.TYPE_ACCELEROMETER){
                mGravity = event.values.clone();
                processSensorData();
            }
        }   
    };
    SensorEventListener mMagnetometerListener = new SensorEventListener(){
        public void onAccuracyChanged(Sensor sensor, int accuracy) {}

        public void onSensorChanged(SensorEvent event) {
            if (event.sensor.getType() == Sensor.TYPE_MAGNETIC_FIELD){
                mGeomagnetic = event.values.clone();
                processSensorData();                
                update();
            }
        }   
    };

    private float restrictAngle(float tmpAngle){
        while(tmpAngle>=180) tmpAngle-=360;
        while(tmpAngle<-180) tmpAngle+=360;
        return tmpAngle;
    }

    //x is a raw angle value from getOrientation(...)
    //y is the current filtered angle value
    private float calculateFilteredAngle(float x, float y){ 
        final float alpha = 0.3f;
        float diff = x-y;

        //here, we ensure that abs(diff)<=180
        diff = restrictAngle(diff);

        y += alpha*diff;
        //ensure that y stays within [-180, 180[ bounds
        y = restrictAngle(y);

        return y;
    }

    public void processSensorData(){
        if (mGravity != null && mGeomagnetic != null) { 
            boolean success = SensorManager.getRotationMatrix(Rmat, Imat, mGravity, mGeomagnetic);
            if (success) {              
                SensorManager.getOrientation(Rmat, orientation);
                mAngle0_azimuth = (float)Math.toDegrees((double)orientation[0]); // orientation contains: azimut, pitch and roll
                mAngle1_pitch = (float)Math.toDegrees((double)orientation[1]); //pitch
                mAngle2_roll = -(float)Math.toDegrees((double)orientation[2]); //roll               
                mAngle0_filtered_azimuth = calculateFilteredAngle(mAngle0_azimuth, mAngle0_filtered_azimuth);
                mAngle1_filtered_pitch = calculateFilteredAngle(mAngle1_pitch, mAngle1_filtered_pitch);
                mAngle2_filtered_roll = calculateFilteredAngle(mAngle2_roll, mAngle2_filtered_roll);    
            }           
            mGravity=null; //oblige full new refresh
            mGeomagnetic=null; //oblige full new refresh
        }
    }

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);     
        LinearLayout ll = new LinearLayout(this);       
        LinearLayout.LayoutParams llParams = new LinearLayout.LayoutParams(LinearLayout.LayoutParams.FILL_PARENT, LinearLayout.LayoutParams.FILL_PARENT);      
        ll.setLayoutParams(llParams);      
        ll.setOrientation(LinearLayout.VERTICAL);      
        ViewGroup.LayoutParams txtParams = new ViewGroup.LayoutParams(ViewGroup.LayoutParams.WRAP_CONTENT, ViewGroup.LayoutParams.WRAP_CONTENT);        
        mTextView_azimuth = new TextView(this);
        mTextView_azimuth.setLayoutParams(txtParams);
        mTextView_pitch = new TextView(this);
        mTextView_pitch.setLayoutParams(txtParams);
        mTextView_roll = new TextView(this);
        mTextView_roll.setLayoutParams(txtParams);      
        mTextView_filtered_azimuth = new TextView(this);
        mTextView_filtered_azimuth.setLayoutParams(txtParams);
        mTextView_filtered_pitch = new TextView(this);
        mTextView_filtered_pitch.setLayoutParams(txtParams);
        mTextView_filtered_roll = new TextView(this);
        mTextView_filtered_roll.setLayoutParams(txtParams);

        mCompassView = new Compass3DView(this);        
        ViewGroup.LayoutParams compassParams = new ViewGroup.LayoutParams(200,200);
        mCompassView.setLayoutParams(compassParams);

        ll.addView(mCompassView);
        ll.addView(mTextView_azimuth);
        ll.addView(mTextView_pitch);
        ll.addView(mTextView_roll);
        ll.addView(mTextView_filtered_azimuth);
        ll.addView(mTextView_filtered_pitch);
        ll.addView(mTextView_filtered_roll);

        setContentView(ll);

        sensorManager = (SensorManager) this.getSystemService(Context.SENSOR_SERVICE);
        sensorManager.registerListener(mAccelerometerListener, sensorManager.getDefaultSensor(Sensor.TYPE_ACCELEROMETER), SensorManager.SENSOR_DELAY_UI); 
        sensorManager.registerListener(mMagnetometerListener, sensorManager.getDefaultSensor(Sensor.TYPE_MAGNETIC_FIELD), SensorManager.SENSOR_DELAY_UI);
        update();       
    }

    @Override
    public void onDestroy(){
        super.onDestroy();
        sensorManager.unregisterListener(mAccelerometerListener);
        sensorManager.unregisterListener(mMagnetometerListener);
    }

    private void update(){
        mCompassView.changeAngles(mAngle1_filtered_pitch,  mAngle2_filtered_roll, mAngle0_filtered_azimuth);

        mTextView_azimuth.setText("Azimuth: "+String.valueOf(mAngle0_azimuth));
        mTextView_pitch.setText("Pitch: "+String.valueOf(mAngle1_pitch));
        mTextView_roll.setText("Roll: "+String.valueOf(mAngle2_roll));

        mTextView_filtered_azimuth.setText("Azimuth: "+String.valueOf(mAngle0_filtered_azimuth));
        mTextView_filtered_pitch.setText("Pitch: "+String.valueOf(mAngle1_filtered_pitch));
        mTextView_filtered_roll.setText("Roll: "+String.valueOf(mAngle2_filtered_roll));

    }
} 
```

文件 2：Compass3DView.java：

```
package com.epichorns.compass3D;

import android.content.Context;
import android.opengl.GLSurfaceView;

public class Compass3DView extends GLSurfaceView {
    private Compass3DRenderer mRenderer;

    public Compass3DView(Context context) {
        super(context);
        mRenderer = new Compass3DRenderer(context);
        setRenderer(mRenderer);
    }

    public void changeAngles(float angle0, float angle1, float angle2){
        mRenderer.setAngleX(angle0);
        mRenderer.setAngleY(angle1);
        mRenderer.setAngleZ(angle2);
    }

} 
```

文件 3：Compass3DRenderer.java：

```
package com.epichorns.compass3D;

import java.nio.ByteBuffer;
import java.nio.ByteOrder;
import java.nio.FloatBuffer;
import java.nio.ShortBuffer;

import javax.microedition.khronos.egl.EGLConfig;
import javax.microedition.khronos.opengles.GL10;

import android.content.Context;
import android.opengl.GLSurfaceView;

public class Compass3DRenderer implements GLSurfaceView.Renderer {
    Context mContext;

    // a raw buffer to hold indices
    ShortBuffer _indexBuffer;    
    // raw buffers to hold the vertices
    FloatBuffer _vertexBuffer0;
    FloatBuffer _vertexBuffer1;
    FloatBuffer _vertexBuffer2;
    FloatBuffer _vertexBuffer3;
    FloatBuffer _vertexBuffer4;
    FloatBuffer _vertexBuffer5;
    int _numVertices = 3; //standard triangle vertices = 3

    FloatBuffer _textureBuffer0123;

    //private FloatBuffer _light0Position;
    //private FloatBuffer _light0Ambient;
    float _light0Position[] = new float[]{10.0f, 10.0f, 10.0f, 0.0f};
    float _light0Ambient[] = new float[]{0.05f, 0.05f, 0.05f, 1.0f};
    float _light0Diffuse[] = new float[]{0.5f, 0.5f, 0.5f, 1.0f};
    float _light0Specular[] = new float[]{0.7f, 0.7f, 0.7f, 1.0f};
    float _matAmbient[] = new float[] { 0.6f, 0.6f, 0.6f, 1.0f };
    float _matDiffuse[] = new float[] { 0.6f, 0.6f, 0.6f, 1.0f };

    private float _angleX=0f;
    private float _angleY=0f;
    private float _angleZ=0f;

    Compass3DRenderer(Context context){
        super();
        mContext = context;
    }

    public void setAngleX(float angle) {
        _angleX = angle;
    }

    public void setAngleY(float angle) {
        _angleY = angle;
    }

    public void setAngleZ(float angle) {
        _angleZ = angle;
    }

    FloatBuffer InitFloatBuffer(float[] src){
        ByteBuffer bb = ByteBuffer.allocateDirect(4*src.length);
        bb.order(ByteOrder.nativeOrder());
        FloatBuffer inBuf = bb.asFloatBuffer();
        inBuf.put(src);
        return inBuf;
    }

    ShortBuffer InitShortBuffer(short[] src){
        ByteBuffer bb = ByteBuffer.allocateDirect(2*src.length);
        bb.order(ByteOrder.nativeOrder());
        ShortBuffer inBuf = bb.asShortBuffer();
        inBuf.put(src);
        return inBuf;
    }

    //Init data for our rendered pyramid
    private void initTriangles() {

        //Side faces triangles
        float[] coords = {
            -0.25f, -0.5f, 0.25f,
            0.25f, -0.5f, 0.25f,
            0f, 0.5f, 0f
        };

        float[] coords1 = {
            0.25f, -0.5f, 0.25f,
            0.25f, -0.5f, -0.25f,
            0f, 0.5f, 0f
        };

        float[] coords2 = {
            0.25f, -0.5f, -0.25f,
            -0.25f, -0.5f, -0.25f,
            0f, 0.5f, 0f
        };

        float[] coords3 = {
            -0.25f, -0.5f, -0.25f,
            -0.25f, -0.5f, 0.25f,
            0f, 0.5f, 0f
        };

        //Base triangles
        float[] coords4 = {
            -0.25f, -0.5f, 0.25f,
            0.25f, -0.5f, -0.25f,
            0.25f, -0.5f, 0.25f
        };

        float[] coords5 = {
            -0.25f, -0.5f, 0.25f,
            -0.25f, -0.5f, -0.25f, 
            0.25f, -0.5f, -0.25f
        };

        float[] textures0123 = {
                // Mapping coordinates for the vertices (UV mapping CW)
                0.0f, 0.0f,     // bottom left                    
                1.0f, 0.0f,     // bottom right
                0.5f, 1.0f,     // top ctr              
        };

        _vertexBuffer0 = InitFloatBuffer(coords);
        _vertexBuffer0.position(0);

        _vertexBuffer1 = InitFloatBuffer(coords1);
        _vertexBuffer1.position(0);    

        _vertexBuffer2 = InitFloatBuffer(coords2);
        _vertexBuffer2.position(0);

        _vertexBuffer3 = InitFloatBuffer(coords3);
        _vertexBuffer3.position(0);

        _vertexBuffer4 = InitFloatBuffer(coords4);
        _vertexBuffer4.position(0);

        _vertexBuffer5 = InitFloatBuffer(coords5);
        _vertexBuffer5.position(0);

        _textureBuffer0123 = InitFloatBuffer(textures0123);
        _textureBuffer0123.position(0);

        short[] indices = {0, 1, 2};
        _indexBuffer = InitShortBuffer(indices);        
        _indexBuffer.position(0);

    }

    public void onSurfaceCreated(GL10 gl, EGLConfig config) {

        gl.glEnable(GL10.GL_CULL_FACE); // enable the differentiation of which side may be visible 
        gl.glShadeModel(GL10.GL_SMOOTH);

        gl.glFrontFace(GL10.GL_CCW); // which is the front? the one which is drawn counter clockwise
        gl.glCullFace(GL10.GL_BACK); // which one should NOT be drawn

        initTriangles();

        gl.glEnableClientState(GL10.GL_VERTEX_ARRAY);
        gl.glEnableClientState(GL10.GL_TEXTURE_COORD_ARRAY);
    }

    public void onDrawFrame(GL10 gl) {

        gl.glPushMatrix();

        gl.glClearColor(0, 0, 0, 1.0f); //clipping backdrop color
        // clear the color buffer to show the ClearColor we called above...
        gl.glClear(GL10.GL_COLOR_BUFFER_BIT);

        // set rotation       
        gl.glRotatef(_angleY, 0f, 1f, 0f); //ROLL
        gl.glRotatef(_angleX, 1f, 0f, 0f); //ELEVATION
        gl.glRotatef(_angleZ, 0f, 0f, 1f); //AZIMUTH

        //Draw our pyramid

        //4 side faces
        gl.glColor4f(0.5f, 0f, 0f, 0.5f);
        gl.glVertexPointer(3, GL10.GL_FLOAT, 0, _vertexBuffer0);
        gl.glDrawElements(GL10.GL_TRIANGLES, _numVertices, GL10.GL_UNSIGNED_SHORT, _indexBuffer);

        gl.glColor4f(0.5f, 0.5f, 0f, 0.5f);
        gl.glVertexPointer(3, GL10.GL_FLOAT, 0, _vertexBuffer1);
        gl.glDrawElements(GL10.GL_TRIANGLES, _numVertices, GL10.GL_UNSIGNED_SHORT, _indexBuffer);

        gl.glColor4f(0f, 0.5f, 0f, 0.5f);
        gl.glVertexPointer(3, GL10.GL_FLOAT, 0, _vertexBuffer2);
        gl.glDrawElements(GL10.GL_TRIANGLES, _numVertices, GL10.GL_UNSIGNED_SHORT, _indexBuffer);

        gl.glColor4f(0f, 0.5f, 0.5f, 0.5f);
        gl.glVertexPointer(3, GL10.GL_FLOAT, 0, _vertexBuffer3);
        gl.glDrawElements(GL10.GL_TRIANGLES, _numVertices, GL10.GL_UNSIGNED_SHORT, _indexBuffer);

        //Base face
        gl.glColor4f(0f, 0f, 0.5f, 0.5f);
        gl.glVertexPointer(3, GL10.GL_FLOAT, 0, _vertexBuffer4);
        gl.glDrawElements(GL10.GL_TRIANGLES, _numVertices, GL10.GL_UNSIGNED_SHORT, _indexBuffer);
        gl.glVertexPointer(3, GL10.GL_FLOAT, 0, _vertexBuffer5);
        gl.glDrawElements(GL10.GL_TRIANGLES, _numVertices, GL10.GL_UNSIGNED_SHORT, _indexBuffer);

        gl.glPopMatrix();
    }

    public void onSurfaceChanged(GL10 gl, int w, int h) {
        gl.glViewport(0, 0, w, h);
        gl.glViewport(0, 0, w, h);

    }

} 
```

请注意，此代码不会补偿平板电脑默认的横向方向，因此它只能在手机上正常工作（我附近没有平板电脑来测试任何校正代码）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-17T17:28:28.253

您可能应该尝试更长的延迟，例如 Game 和/或保持/增加循环缓冲区的大小。移动设备上的传感器（加速度计、指南针等）本质上是嘈杂的，所以当我问及“低通滤波器”时，我的意思是你是否使用更多数据来降低应用可用更新的频率。您的视频是在室内完成的，我还建议您去一个电磁干扰较少的地方，例如公园，以检查行为是否一致以及标准指南针重置操作（图 8 中的旋转设备）。最后，您可能必须应用一些启发式方法来丢弃“坏”数据，从而为用户提供更流畅的体验。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-24T15:19:49.697

好吧，我在检索方向时遇到了完全相同的问题。问题是我没有得到解决（在检索设备位置时我必须设置一个约束），我不知道你是否能够做到。

选择一个磁罗盘并在罗盘处于您描述的情况时尝试获取北方方向 - 您将得到相同的无意义结果。所以你不能指望设备的指南针做得更好！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-13T15:50:53.587

几句话关于过滤，你的权限。

1.  我建议在将其转换为角度之前对磁场矢量本身进行平均。
2.  仅对角度进行平均/平滑而不使用某种幅度是错误的。角度本身并没有提供足够的数据来检测方向/航向/方位。示例：当您想知道一整天的平均风向时，您必须使用风的强度，而不仅仅是角度。如果你只平均角度，你会得到绝对错误的风向。至于轴承方向，我会使用速度来表示大小。

# django - Django：为什么我可以在模板中反转 URL 而不是在视图中？

> ID：10192063
> 
> 赞同：2
> 
> 时间：2012-04-17T13:19:08.903
> 
> 标签：django, django-urls

django 1.4 中的 URL 反转代码发生了一些奇怪的事情。

我有一个视图叫做`settings.views.app_view`. 我通过手动输入 URL 来查看该页面，以验证基本 URL 模式是否有效。

```
url(r'^app/$', 'settings.views.app_view', name='settings_app_view'), 
```

我已经在模板中反转了 URL，它可以工作。

```
{% url settings_app_view %} 
```

因此，URL 模式有效，我可以调用获取模板中的 URL，单击链接并查看正确的页面。

那么为什么我不能使用 reverse() 在视图中获取 URL？所有的代码都清楚地在那里，不仅如此，当我看到页面并在模板中反转 URL 时，它的配置和工作都非常清楚。

我必须缺少一些小东西；有谁知道它是什么？

```
ViewDoesNotExist at /settings/app/
Exception Value:    Could not import settings.views.app_view. View does not exist in module settings.views.

# The highlighted code
url = reverse("settings_app_view") 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T13:29:45.723

reverse() 在你的代码中究竟是在哪里执行的？如果在导入 python 文件期间执行 reverse()，您可以获得递归导入。不幸的是，递归导入可能会产生不同的结果：AttributeError 可能发生在应该具有此属性的模块上......

请参阅：[https ://docs.djangoproject.com/en/dev/ref/urlresolvers/#reverse-lazy](https://docs.djangoproject.com/en/dev/ref/urlresolvers/#reverse-lazy)

# jquery - jQuery只选择孩子直到特定的班级

> ID：10192065
> 
> 赞同：3
> 
> 时间：2012-04-17T13:19:18.143
> 
> 标签：jquery, dom, selector, parent

我在以下树结构中有一些递归 HTML：

```
分项
 div.content
  输入
  div.container
   分项
    div.content
     输入
     div.container
      分项
       ETC...

```

这是一个带有工作示例的 jsfiddle：http: [//jsfiddle.net/HWHRZ/](http://jsfiddle.net/HWHRZ/)

我还有一个对象，其中包含对每个`.item`div 的 jQuery 引用。

我想要做的是，对于任何特定`.item`的，只选择下面的输入，不包括任何更深`.container`或`.item`元素中的输入。

更复杂的是，并非每个`.item`人的输入布局都相同。有时输入可能在其他`div`元素中，因此使用简单选择它们`.find('> .content :input')`并不总是有效。

我找到了一个解决方案，但是对于大树来说效率很低，而且一点也不优雅：（ `$(':input', $item).not($('.container :input', $item)).toggleClass('changed');` 是`$item`我保留在对象中的参考）。这个解决方案可以正常工作，但是对于任何足够大的树结构来说效率太低了，因为它`not()`必须处理很多节点。

简而言之：我需要选择不在特定其他子节点内的特定子节点。

有人知道更有效的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T13:28:24.357

我认为

```
$.each($($(".item")[0]).children(".changed"),function(){
$(this).removeClass("changed")
}) 
```

应该管用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-26T10:38:12.023

此功能可能会有所帮助：

```
$.fn.childrenUntil = function( selector, result)
{
    result = typeof result !== 'undefined' ? result : new $();
    this.children().each( function(){
       var thisObject = $( this );
        if( thisObject.is( selector ) ) 
            result.push( this );
        else
            thisObject.childrenUntil( selector, result );
    });
    return result;
} 
```

它遍历树直到遇到选择器。

# sql - 通过 SSMS 订购 SQL Azure 表列

> ID：10192067
> 
> 赞同：7
> 
> 时间：2012-04-17T13:19:22.123
> 
> 标签：sql, azure, ssms

我知道您可以进入 SQL Server Management Studios 中表的设计视图并在列出现在设计视图中时重新排序它们，但是这对于 SQL Azure 是不可能的，因为该选项被禁用。*有没有办法修改 SQL Azure 表，以便您可以在它们出现在设计视图中时重新排列它们的列？*

在过去的几个月里，我一直在运行一些数据库升级来支持新的需求，并希望重新排序列在设计视图中的显示方式，以便它们更易于阅读，即它们以主键开头，然后是外键，然后是普通列，并以添加的、修改的字段结尾。它纯粹是为了让表格在我随着时间的推移管理它们时更具可读性。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T13:26:27.790

只需对表运行脚本。它有点伪代码，但你应该明白。

```
CREATE TABLE TableWithDesiredOrder(PK,FK1,FK2,COL1,COL2)

INSERT INTO TableWithDesiredOrder(PK,FK1,FK2,COL1,COL2....)
SELECT PK,FK1,FK2,COL1,COL2.... FROM OriginalTable

DROP TABLE OriginalTable 
```

最后重命名表

```
sp_Rename TableWithDesiredOrder, OriginalTable 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-19T14:32:52.047

只是另一种选择：我使用 SQL Delta 将我的数据库更改从 dev db 传播到 Azure db。所以在这种情况下，我只需使用 SSMS GUI 在本地更改 col 顺序，SQL Delta 将为我执行 createnew>copytonew>dropold，以及我的其他本地更改。（在项目选项中，我设置保留列顺序=是。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-02-22T12:48:22.253

我在 Azure SQL 数据库中遇到了同样的情况，基本上，当从视图中执行 SELECT * 或列标题与列值混合时，我没有使用 ALTER 更改视图。

为了修复它，我删除了视图并重新创建了它。那行得通。

# java - 适用于具有 Python 背景的程序员的 Java 好教程/书籍

> ID：10192069
> 
> 赞同：2
> 
> 时间：2012-04-17T13:19:25.740
> 
> 标签：java, python

最近我开始意识到我应该了解一些 Java 编程知识（我想在 android 中编程）。当我阅读所有教程和一些免费电子书时，它们要么假设没有编程经验，要么假设读者来自 C/C++ 背景。由于我很早就习惯了 python 和 MATLAB，所以强类型的 C/C++ 对我来说很笨拙。你们中的一些人是否知道任何教程/书籍假设读者是 Python 程序员并指导他通过 Java 展示两种语言之间的异同？

我参考了以下书籍和网站：

[David J. Eck 的 Java 编程简介，](http://math.hws.edu/javanotes/)很好，但假设很少/没有编程经验，并且必须通过许多页面才能获得基本知识。

> Ricardo Flask 面向初学者的 Java

这本书来回移动，没有谈论用户的背景和其他事情。

话虽如此，我希望这本书能立即回答一些这样的问题，并通过 Java 编程：

- 为什么一个函数可以在不将它添加到可以在 python 中完成的 Java 类的情况下实现？-各种变量的范围，它们的定义以及它们与python有何不同？

在我看来，这些是 Python 程序员在尝试使用 Java 时会考虑的一些事情。

请推荐任何有助于 Python 程序员学习 Java 的材料。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T13:25:41.020

我们在我大学的 Java 入门课程之后使用了这本书：[面向对象的设计与模式，](http://www.horstmann.com/design_and_patterns.html)作者 Cay Horstmann。它很好地介绍了 java 以及模式。我喜欢它，从那里我们只使用在线参考。

很好的阅读。当您觉得需要时，我是否可以建议 IntelliJ Idea Community 版本作为 IDE。

# javascript - 共享对话框打开然后关闭

> ID：10192071
> 
> 赞同：0
> 
> 时间：2012-04-17T13:19:29.533
> 
> 标签：javascript, jquery, facebook, facebook-ui

当用户提交表单时，我的应用程序会打开一个共享对话框。提交后页面刷新时，在文档就绪 (jQuery) 上调用该对话框。

对话框确实打开，但几秒钟后关闭。这几乎使对话框无用。如果您尝试在它关闭之前点击“分享”，那么它确实有效，但显然大多数用户不会尝试和它竞争。

该应用程序可以在这里找到：[https ://apps.facebook.com/topmoviesseen/](https://apps.facebook.com/topmoviesseen/)

我注意到它可能是喜怒无常的，奇怪的是看到它完美地工作。其他时候，对话框消失仅在 4 或 5 秒后重新出现。我会冒险猜测有某种 JS 会影响框的 z-index 或可见性，但我找不到任何东西。

非常感谢任何帮助。

用于调用对话框的代码：

```
 $(document).ready(function(){
        // calling the API ...
        var obj = {
          method: 'feed',
          display: 'iframe',
          access_token: 'example',
          name: 'Top 100 Movies Seen',
          link: 'https://apps.facebook.com/topmoviesseen/',
          picture: 'https://mgnewmedia.com/topmovies/assets/images/for_stream.png',
          description: 'I have seen 62 of the top 100 movies of all time.  How many have you seen?',
          caption: 'Done any better?',
          message: '62 out of 100 isn\'t bad.'
        };

        FB.ui(obj, callback);
    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T07:06:52.750

您必须确保在您的 FB.init 完成后调用您的 FB.ui，因此在 window.fbAsycncInit 侦听器中设置它会有所帮助：

```
window.fbAsyncInit = function() { 
    FB.ui(...) 
}; 
```

# android - 如何使用 android 将所有类型的文档上传到谷歌文档？

> ID：10192072
> 
> 赞同：1
> 
> 时间：2012-04-17T13:19:33.747
> 
> 标签：android, google-docs

我是 android 开发的新手，我不知道在 google docs 中上传文档，意思是当我在 google 中搜索时，但我没有任何使用 android 将文档上传到 google docs 的示例代码。我不知道使用的是哪个 google api，所以请为此提供一些想法和任何教程（链接）。

提前谢谢。森希尔。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T14:01:57.563

这是一个开始的地方[https://developers.google.com/google-apps/documents-list/](https://developers.google.com/google-apps/documents-list/)

# php - 使用 regexp 和 php 搜索、替换和重组

> ID：10192074
> 
> 赞同：1
> 
> 时间：2012-04-17T13:19:40.790
> 
> 标签：php, regex, search, replace

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-17T20:13:43.827

我同意@Colin；但是，上面的`Searching and Replace`代码是在做你想要的吗？即它是否找到了 • 字符？如果是这样，我建议不要使用！SUB！替换，而是将其作为您的一部分

> 正则表达式：
> /(<p( class="normale")?>(•|•))(.*?)</p>/

如果不是，那么您必须找到相应的 ASCII 表示（十六进制或八进制）并将其放在`regex.<br>`

一旦您做到了这一点，XML 解析器就会快速处理其中的重新排序部分。:-)

# c# - Will the compiler only compile code that can get executed?

> ID：10192076
> 
> 赞同：36
> 
> 时间：2012-04-17T13:19:43.320
> 
> 标签：c#, visual-studio-2010, compiler-construction

I have a class library and am using only part of it. Is there a need to delete what isn't being used in order to shrink the size of the created code (in release configuration)?

As far as I've seen, the compiler takes care of that, and removing the code doesn't change the EXE file size. Will this always be true? Removing all unneeded code would take very long, so I want to know if there's need for that.

More information: there are methods and classes in the class library that aren't called from the executing code, but are referenced by other parts of code in the class library (which themselves are never called).

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-04-17T13:24:52.767

不，编译器也包含“死”代码。一个简单的原因是，并不总是能够准确地知道哪些代码将被执行，哪些代码不会被执行。例如，即使是从不引用的私有方法也可以通过反射调用，而公共方法可以被外部程序集引用。

您可以使用工具来帮助您查找和删除未使用的方法（包括仅由其他未使用的方法调用的方法）。尝试[您使用哪些工具和技术来查找死代码？](https://stackoverflow.com/questions/162641/what-tools-and-techniques-do-you-use-to-find-dead-code-in-net)并[查找未使用的代码](https://stackoverflow.com/questions/245963/find-unused-code)以帮助您入门。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-17T13:25:29.917

这一切都被编译了。不管它是否被调用。代码可以被外部库调用。

使编译器忽略代码的唯一方法是使用编译器预处理器指令。更多关于[这里](http://msdn.microsoft.com/en-us/library/ed8yd1ha%28v=vs.71%29.aspx)的内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T13:25:02.673

我怀疑编译器会删除任何东西。事实是，由于反射，编译器无法分辨出什么被使用，什么未被使用，因为类型可以被实例化，方法可以通过名称调用，这要归功于反射。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-17T13:26:26.433

假设有一个名为`Utility`. 您创建了一个新项目并将这个类库添加到该项目中。即使您的 EXE 只调用了类库中的 1-2 个方法，删除未引用的代码也不是一个好主意。

这将违反可重用性原则。尽管库中存在一些未从 EXE 引用的类，但它不会对程序的性能或大小产生任何不良影响。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-06-24T15:42:38.917

在大多数语言中，确定所有且唯一的死代码（如果人们理想化一个人有一个像语言一样的“数学世界”）递归地无法确定。（一些罕见的语言，如 Blaise 语言是可判定的。）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-12-03T23:12:43.477

关于是否“需要删除未使用的内容以缩小创建代码的大小”的问题：我认为这只会对节省网络带宽有用。删除未使用的代码在 Web 应用程序中对于提高加载速度等至关重要。

如果您的代码是 exe 或库，我看到删除死代码的唯一原因是提高您的代码质量。这样在 2 年后查看您的代码的人就不会摸不着头脑想知道它的作用。

# java - Does Java follow Object Oriented Programming Model fully?

> ID：10192083
> 
> 赞同：1
> 
> 时间：2012-04-17T13:20:30.313
> 
> 标签：java, oop, object, jvm, private

The following code illustrates the situation:

```
class Human {

 private String heart = "default heart";

    public void control(Human h) {

            h.heart = "$%^&*@@!#^";
      }

   public String getHeart() {
    return heart;
    }
  }

 public class HumanTest {

    public static void main(String[] args) {

    Human deb = new Human();
    Human kate = new Human();

    System.out.println(deb.getHeart());
    kate.control(deb);
    System.out.println(deb.getHeart());

   }

 } 
```

Here heart [private variable] of deb got modified unfortunately. :)

Java allows the code to run without any error.But is it justified to give a object the privilege to access private member of other object even if the code is in the same class ? Shouldn't Java disallow this?

As I know, private means restricting access beyond the class source code. But the same concept is applied in the source code above. and the result is disastrous since a person's heart can't be modified by any random person .

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-17T13:28:01.737

如果结果是灾难性的，则不应对类进行编码以使其允许。“错误”不是由类外部的代码引起的，而是由类本身的代码引起的。所以这只是你代码中的一个错误。

如果 Java 不允许，您只能通过它们的公共属性来比较同一类的对象，例如，这会破坏封装（通过公开私有内容）和/或非常慢（通过强制制作防御性副本私有属性，使它们可用于其他对象。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T13:24:04.500

一些语言在对象级别进行封装，而其他语言（Java、C++）在类级别进行封装。听起来您已经习惯（或刚刚阅读过）对象级别的封装。坦率地说，我发现类级别要自然得多，但也许这只是因为 C++ 为我提供了使用类进行编程的介绍。类级封装使一些习惯用法（工厂方法、复制构造函数、比较运算符）更容易编写。使用对象级封装，您最终会暴露比您真正想要的更多的东西，只是为了能够实现这些功能。

无论如何，这两种方式都不是“正确的”——它们只是不同而已。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T13:24:23.710

查看防御副本以避免这种情况。这是因为 java 对象的操作更像引用。“指针”不会改变，但是一旦你知道它，你就可以改变它包含的值。

[http://www.informit.com/articles/article.aspx?p=31551&seqNum=2](http://www.informit.com/articles/article.aspx?p=31551&seqNum=2)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-17T13:27:39.350

这并没有破坏面向对象——它是关于类内部元素的封装。

您可以使用此示例执行此操作似乎很愚蠢，但就我而言，这实际上并不是一件坏事。封装类元素的目的是让其他类无法修改它们——它们只能看到类的公共接口，`Human`例如进行更改。这意味着不止一个人可以在同一个项目上工作，编写不同的类（或者您可以在不同时间编写不同的类在同一个项目上工作），并且他们不需要知道代码的内部工作原理。

但是，您可以直接在 Human 中访问私有字段的唯一位置（条形反射）*来自*Human。当您编写 Human 类时，如果您选择对其他 Human 对象的私有字段进行修改，这取决于您 - 但它都包含在一个类中，这是您的设计。如果您以不合适的方式执行此操作，那么这是您的设计中的一个缺陷，而不是 Java - 在某些情况下，这样做非常有意义！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-17T13:29:14.450

好吧，我看到它的方式，这只是我对 private 关键字的解释，private 是类私有的，可以在类内部访问。它不限于类的实例。因此，您不能在“humantest”类中​​执行 kate.heart="xpto"，因为这会试图破坏它的隐私，但是允许使用 kate 的代码来改变 deb 的心脏，因为它是在类内部处理的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-17T13:30:52.110

Java 语言严格遵循面向对象的概念。这也是正确的..对吗？使用您的类的对象，您正在修改您的类的变量。但这取决于可以控制他的对象的程序员。

Human 的心在 Human 的类中是私有的。但是使用控制方法，您可以从外部访问它。这就是它被修改的原因..那有什么问题.？

# objective-c - reload cellView after performSelectorInBackground

> ID：10192085
> 
> 赞同：0
> 
> 时间：2012-04-17T13:20:39.680
> 
> 标签：objective-c, xcode, uinavigationcontroller, uisearchbar, reloaddata

I have a application that is made of "Navigation Controller" whith "UITableViewController" which contains a navigation item with a search field. In the storyboard, the Search Bar is inside the TableView.

I request XML from a server, if I do it directly on the main thread, it's very slow but it works, the informations from the server is getting shown on the CellView with "reloadData". But when I do it with a "performSelectorOnBackground" I managed to get the data but I have to click on the "Cancel" button of the search bar to show the result I just queried!

I tried already: "[self.tableView performSelectorOnMainThread:@selector(reloadData) withObject:nil waitUntilDone:NO];" but it doesn't change it. The worst is that when if I put a "NSLog" in "cellForRowAtIndexPath" it shows the content of the array. And the "searchBarCancelButtonClicked" is totally empty.

Sorry English is not my native language, and thanks a billion time for your help!

**EDIT 18/04/12:** Now the TableCellView gets populated correctly asynchronously but there is a problem. When the request from XML is ready, I can see it in the ViewController of my current view. But I have to type another letter in the searchBox in order to "push" the previous result to my tableViewCell. Now in my current view I call another class that in another thread (dispatch_async) ask another function to parse the XML and once done, I send a "NSNotification" so my current view initialise my NSMutableArray that is used to populate the form. Do someone has an idea on how to trick it? Thanks a billion time!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T13:53:24.143

完成数据解析后，您调用了 [tableview reloadData];。它将用更新的数据填充您的数据。

# wcf - IIS6 中的自定义用户名/密码身份验证

> ID：10192089
> 
> 赞同：0
> 
> 时间：2012-04-17T13:20:55.863
> 
> 标签：wcf, iis-6, transport-security

我有一个在 IIS6 中托管的 WCF 服务。我正在尝试使用传输级安全性设置自定义用户名/密码身份验证。我已经设置了一个测试证书并让一个客户端通过 SSL 连接而没有指定身份验证，即：

```
 <security mode="Transport">
        <transport clientCredentialType="Basic" />
      </security> 
```

我已经设置了一个具有消息安全性和客户端凭据类型“用户名”的自定义验证器，但我现在想将它与传输级安全性结合起来。当我设置了 web.config 时，当我尝试查看 WSDL 时，出现错误：“此服务的安全设置需要‘基本’身份验证，但托管此服务的 IIS 应用程序未启用它。”

以下是我的 web.config 的重要部分：

```
<system.serviceModel>
    <bindings>
      <wsHttpBinding>
        <binding name="UserNameBinding">
          <security mode="Transport">
            <transport clientCredentialType="Basic" />
          </security>
        </binding>
      </wsHttpBinding>
    </bindings>
    <services>
      <service behaviorConfiguration="ServiceAuthenticationBehavior"
        name="Service.WebServices.MyService">
        <endpoint address="mex" binding="mexHttpsBinding" bindingConfiguration=""
          name="mexBinding" contract="IMetadataExchange" />
        <endpoint binding="wsHttpBinding" bindingConfiguration="UserNameBinding"
          name="wsHttpBindingWithAuth" contract="Service.WebServices.IMyService" />
      </service>
    </services>
    <behaviors>
      <serviceBehaviors>
        <behavior name="ServiceAuthenticationBehavior">
          <serviceMetadata httpsGetEnabled="true" />
          <serviceDebug includeExceptionDetailInFaults="true" />
          <serviceCredentials>
            <serviceCertificate findValue="TestCert01" storeLocation="LocalMachine"
              storeName="TrustedPeople" x509FindType="FindBySubjectName" />
            <userNameAuthentication userNamePasswordValidationMode="Custom"
              customUserNamePasswordValidatorType="Service.WebServices.ClientCredentialsValidator, Service.WebServices" />
          </serviceCredentials>
        </behavior>
      </serviceBehaviors>
    </behaviors> 
```

我应该在 IIS6 中设置什么来启用它吗？在 IIS 中，我一开始是启用了“启用匿名访问”选项。我还尝试启用“基本身份验证（密码以明文形式发送）”复选框，但没有成功。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T13:28:14.670

这篇文章似乎暗示 Basic 仅适用于 Windows 帐户，具有 3rd 方解决方案...

[使用 WCF REST 服务对 Windows 帐户以外的东西进行基本身份验证？](https://stackoverflow.com/questions/660445/basic-authentication-with-wcf-rest-service-to-something-other-than-windows-accou)

我自己也来过这里，最后选择了 1-legged openauth，效果很好。

**编辑** 这篇文章让我很好地找到了解决方案[http://www.cleancode.co.nz/blog/523/oauth-dot-net](http://www.cleancode.co.nz/blog/523/oauth-dot-net)

值得一提的是 1 和 2 腿 OAuth 之间的差异。1-leg 是客户端和服务都知道客户端帐户名的客户端密码（密码）的地方，该帐户名用于加密和解密身份验证请求（所有这些都添加到查询字符串中）。对于 2-legged，这是由 google、facebook 等第 3 方生成的。

# php - 将xml文件插入sql

> ID：10192093
> 
> 赞同：0
> 
> 时间：2012-04-17T13:21:03.113
> 
> 标签：php, sql, xml

我想使用 php 将**大型**xml 值插入到 sql 中。

这是 xml 示例：

```
 <?xml version="1.0" encoding="utf-8" ?> 
<contacts>
<con>
  <id>1</id> 
  <name>user_name</name> 
  <city>city_name</city> 
  <street>street_name</street> 
  <phone1>phone_number1</phone1> 
  <phone2>phone_number2</phone2> 
  <phone3 /> 
  <phone4 /> 
  </con>

  <con>
  <id>2</id> 
  <name>user_name</name> 
  <city>city_name</city> 
  <street>street_name</street> 
  <phone1>phone_number1</phone1> 
  <phone2>phone_number2</phone2> 
  <phone3 /> 
  <phone4 /> 
  </con>

    </contacts> 
```

我像这样制作 SQL，所以我想在其中插入数据：

```
CREATE TABLE IF NOT EXISTS `contacts` (
  `id` int(11) NOT NULL auto_increment,
  `name` varchar(250) NOT NULL,
  `city` varchar(250) NOT NULL,
  `street` varchar(250) NOT NULL,
  `phone_1` text NOT NULL,
  `phone_2` text NOT NULL,
  `phone_3` text NOT NULL,
  `phone_4` text NOT NULL,
  PRIMARY KEY  (`id`)
) ENGINE=MyISAM DEFAULT CHARSET=cp1256 AUTO_INCREMENT=1 ; 
```

我可以用 php 完成这项工作吗？我该怎么做？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T13:25:55.687

首先`phone_3`and`phone_4`在数据库中是NOT NULL，而不是在XML中设置。

您可以通过使用[XML 解析器](http://php.net/manual/en/book.xml.php)（[替代参考](http://php.net/manual/en/ref.xml.php)）解析 php 代码中的 xml 来做到这一点。之后，它只是将它们插入数据库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T13:27:40.883

是的，您可以使用 xml 函数 xml_parse_into_struct() 将您的 xml 转换为数组，而不是使用循环您可以在数据库中插入数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T13:27:53.350

解析xml文件，循环为每个数据构造一个sql查询，执行查询，输出一些验证，比如查询是否成功......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-17T13:29:18.583

正如 dragon112 提到的，您希望在 PHP 代码中解析 XML。已经提出并回答了类似的问题。看看[这里](https://stackoverflow.com/questions/8938362/php-code-import-xml-file-from-web-server-public-html-ctrackxml-into-mysql-d)以获得一些灵感。

祝你好运

# api - 标准 API - 在 ElementCollection 中使用 UPPER

> ID：10192094
> 
> 赞同：3
> 
> 时间：2012-04-17T13:21:17.840
> 
> 标签：api, jpa, criteria

我有一堂课

```
@Entity
public class Person{
...
@ElementCollection
private Set<String> tags;
...
} 
```

我想使用 JPA 2.0 Criteria API 来搜索这些标签——但不区分大小写。因此，我想将搜索参数设置为 UPPER 并将列设置为 UPPER （伪 SQL：select p.* from Person p join Tags t on p.id=t.pId where upper(t.name)=upper('搜索参数');)

这是我在标签上没有 UPPER 的代码：

```
 CriteriaBuilder builder = this.em.getCriteriaBuilder();
  CriteriaQuery<Person> query = builder.createQuery(Person.class);
  Root<Person> root = query.from(Person.class);

  return this.em.createQuery(query.select(root).where(
     builder.isMember(builder.upper(builder.literal(searchTag)),
        root.get(Person_.tags)))).getResultList(); 
```

其中 searchTag 是输入参数。

如何将 UPPER 分配给 Person_.tags “列”？

换句话说，我想用 Criteria API 编写这个查询：

```
SELECT p FROM Person p JOIN p.tags t WHERE UPPER(t) = UPPER('searchString') 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T09:17:38.583

好的，我终于有了解决方案：

```
 cQuery.where(
     builder.equal(
        builder.upper(cQuery.from(Relation.class).join(Relation_.aliase)
           .as(String.class)),
        builder.upper(builder.literal(alias))
        )
     ); 
```

必须使用“.as(..)”方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T00:45:56.800

```
suburbCriteria = criteriaBuilder.equal( 
                    criteriaBuilder.upper(root.get(Property_.suburb)), 
                    criteriaBuilder.upper(criteriaBuilder.literal(searchBean.getSuburb()))); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T13:44:08.443

您需要从 Person 调用连接标签上的上部和文字属性名称。

```
CriteriaBuilder builder = this.em.getCriteriaBuilder();
CriteriaQuery<Person> query = builder.createQuery(Person.class);
Root<Person> root = query.from(Person.class);
Join<Person, Tag> tags = root.join(Person_.tags);

query.where(builder.isMember(
        builder.upper(builder.literal(searchTag)), 
        builder.upper(builder.literal(tags.get(Tag_.name)))
));

return this.em.createQuery(query).getResultList(); 
```

我省略`query.select(root)`了，不确定是否需要。Tou 也可以在 Tag_.name 上省略 builder.literal()，因为它是 String。

如果我在某处错了，请为更多用户编辑我的答案。

希望这可以帮助。

# python - 基本递减循环 - PYTHON

> ID：10192095
> 
> 赞同：0
> 
> 时间：2012-04-17T13:21:22.150
> 
> 标签：python

python 新手，在我的最新程序中遇到了障碍。简单地说，如果可能的话，我正在尝试为用户输入变量编写一个递减循环。本质上，我有一个全局常量设置为值，例如 13，每次程序循环时，它都会提示用户输入一个值，然后将该用户值剃掉 13 直到它达到 0。问题是它确实剃掉了它，但是当它重复时它将值重置为 13，并且仅删除输入的当前迭代值。因此，如果您在每次迭代中输入 2，它只会将其降低到 11……但我的目标是再次以 2 为例，11、8、5 等或以 3 为例 10、7、 4....任何帮助的人将不胜感激，干杯:)

```
a = 13

def main():
    runLoop()

def runLoop():
    while other_input_var > 0: # guys this is my main score accumulator
                               # variable and works fine just the one below
        b=int(input('Please enter a number to remove from 13: '))
        if b != 0:
            shave(a, b)

def shave(a, b):
    a -= b
    print 'score is %d ' % a
    if a == 0:
        print "Win"

main() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T13:43:23.970

以我的拙见，对于这么小的片段，附加功能最终会使事情变得复杂。然而很高兴看到你得到了这个概念。我没有对此进行测试，但这应该与您正在寻找的相同。注意第 5 行，我确保输入的数字不超过 a 的当前值。如果他们/您不小心输入了更高的内容，这应该会有所帮助。如果您还没有尝试过，下一步将是进行错误处理，请参阅[Python 错误处理](http://docs.python.org/tutorial/errors.html)。希望这可以帮助！

```
def main():
    a = 13
    while a:
        b = int(input("Please enter a number to remove from " +  str(a) + " : "))
        if b > 0 and b <= a:
            a -= b
            print "Score is ", str(a)
    print "Win"    

main() 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-17T14:33:58.777

不是您的问题的答案，而是字符串格式的演示。这是旧样式，使用`%`“字符串插值运算符”。

```
a = 100
while a:
    shave = int(raw_input("Input a number to subtract from %i:" % a))
    if ( shave > 0 ) and ( shave <= a ):
        a -= shave
    else:
        print ("Number needs to be positive and less than %i." % a) 
```

与该程序的会话：

```
Input a number to subtract from 100:50
Input a number to subtract from 50:100
Number needs to be positive and less than 50.
Input a number to subtract from 50:30
Input a number to subtract from 20:20 
```

原始`%i`字符串中的 是整数（表示整数）的占位符`i`，稍后由`%`字符串上的运算符填充。

还有`%f`浮点数、`%s`字符串等。您可以做一些漂亮的事情，例如指定数字应该打印多少个小数点 -`%.3f`三位小数 - 等等。

另一个例子：

```
>>> "My name is %s and I'm %.2f metres tall." % ('Li-aung',1.83211)
"My name is Li-aung and I'm 1.83 metres tall." 
```

这比以下内容更容易阅读：

```
"My name is " + name + " and I'm " + str(round(age,2)) + " metres tall" 
```

阅读更多关于[旧方式](http://docs.python.org/library/stdtypes.html#string-formatting-operations)或[新方式](http://docs.python.org/library/string.html#string-formatting)字符串格式化的信息。

# solr - 即使定期删除文档，Solr4 索引也会增长

> ID：10192103
> 
> 赞同：0
> 
> 时间：2012-04-17T13:21:49.643
> 
> 标签：solr, faceted-search

我们正在使用 Solr 4 引擎来使用旋转生成一些方面。该索引正在与文档一起提供，生成的方面，然后正在删除文档。尽管如此，该指数似乎在不断增长，而分面生成速度变慢了。现在，如果我们停止 solr 实例并删除索引，分面过程就会恢复其速度。

关于如何保持流程高效的任何建议？为什么删除文档后索引没有恢复效率？

顺便说一句，我们正在使用 Solrj，我们用于删除文档的命令是：

```
server.deleteByQuery(...);
server.commit(true, true);
server.optimize(true, true, 1); 
```

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T18:17:41.690

找到了答案。基本上，我们所做的是创建一个新内核，将旧内核与新内核交换，然后卸载旧内核。这似乎可以解决任何性能问题。有关如何创建、交换和卸载核心的信息，请访问[http://wiki.apache.org/solr/CoreAdmin](http://wiki.apache.org/solr/CoreAdmin)。

# ruby-on-rails - 无法获取对象属性

> ID：10192106
> 
> 赞同：1
> 
> 时间：2012-04-17T13:22:05.463
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

楷模：

```
class Car < ActiveRecord::Base
  ...
  belongs_to :manufacturer
  ...
end

class Manufacturer < ActiveRecord::Base
  ...
  has_many :cars
  ...
end 
```

汽车控制器：

```
 def index
     @title = "All cars"
     @cars = Car.paginate(:page => params[:page], :per_page => 20)
  end 
```

看法：

```
<%= car.manufacturer.name %> 
```

显示：nil:NilClass 的未定义方法“名称”

好的。看法：

```
<%= car.manufacturer[name] %> 
```

显示：#<#:0x460c488> 的未定义局部变量或方法“名称”

但！看法：

```
<%= car.manufacturer.to_yaml %> 
```

显示：

```
--- !ruby/object:Manufacturer
attributes:
  id: 1
  name: Acura
  created_at: 2011-11-30 09:59:19.750976000 Z
  updated_at: 2011-12-06 10:38:46.569531000 Z 
```

那么如何读取 Car.manufacturer 的名称？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T13:24:30.877

`<%= car.manufacturer.name if car.manufacturer %>`由于某些结果不会设置属性，因此这可确保您仅在设置了属性 getter 方法时才调用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T14:32:41.467

```
<%= car.manufacturer.try(:name) %> 
```

你可能对[Presenter 模式感兴趣](http://railscasts.com/episodes/287-presenters-from-scratch)

# regex - 将 inputText 值限制为仅字母字符

> ID：10192108
> 
> 赞同：4
> 
> 时间：2012-04-17T13:22:08.090
> 
> 标签：regex, jsf-2, input, primefaces

我需要`[A-Z,a-z]`在 PrimeFaces inputText 字段中只允许字母字符。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-17T13:55:05.160

不特定于 Primefaces，而是特定于底层 JSF：

您可以在输入字段上使用正则表达式验证器：

```
 <h:inputText value="#{myBean.myText}" >
     <f:validateRegex pattern="[a-zA-Z]+"/>
   </h:inputText> 
```

这也适用`p:inputText`。

使正则表达式适应您的功能要求。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2019-04-08T22:31:29.133

如果您需要避免视图中的字符（输入文本），您可以使用 p:keyFilter 标记，如下所示

```
<p:inputText id="apePat" 
            placeholder="Apellido Paterno" 
            value="#{actualizaDatos.user.apePat}" 
            autocomplete="off" 
            label="Apellido Paterno" 
            validatorMessage="El campo apellido paterno es requerido">

            <f:validateRequired/>

            <p:keyFilter regEx="/[a-zA-ZÀ-ú\\s\\' ]+/"/>

</p:inputText> 
```

# ruby-on-rails - 无法在我全新的 Mac OS X Lion 10.7.3 上安装导轨

> ID：10192121
> 
> 赞同：3
> 
> 时间：2012-04-17T13:23:13.160
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, macos, rubygems

刚买了一个新的 macbook pro，我在安装 rails 时遇到了麻烦。我已经安装了 ruby​​ 1.8.7，当我尝试编写“gem install rails”时，我得到：

```
ERROR:  While executing gem ... (Gem::FilePermissionError)
You don't have write permissions into the /Library/Ruby/Gems/1.8 directory. 
```

我还尝试安装更高版本的 ruby​​，它说：

```
 Nirs-MacBook-Pro:~ nirohayon$ rvm install 1.9.3
Fetching yaml-0.1.4.tar.gz to /Users/nirohayon/.rvm/archives
Extracting yaml-0.1.4.tar.gz to /Users/nirohayon/.rvm/src
Configuring yaml in /Users/nirohayon/.rvm/src/yaml-0.1.4.
Error running ' ./configure --prefix="/Users/nirohayon/.rvm/usr"  ', please read /Users/nirohayon/.rvm/log/ruby-1.9.3-p125/yaml/configure.log
Compiling yaml in /Users/nirohayon/.rvm/src/yaml-0.1.4.
Error running 'make ', please read /Users/nirohayon/.rvm/log/ruby-1.9.3-p125/yaml/make.log

Database file /Users/nirohayon/.rvm/config/packages does not exist.

Installing Ruby from source to: /Users/nirohayon/.rvm/rubies/ruby-1.9.3-p125, this may take a while depending on your cpu(s)...

ruby-1.9.3-p125 - #fetching 
ruby-1.9.3-p125 - #extracted to /Users/nirohayon/.rvm/src/ruby-1.9.3-p125 (already extracted)
ruby-1.9.3-p125 - #configuring 
Error running ' ./configure --prefix=/Users/nirohayon/.rvm/rubies/ruby-1.9.3-p125 --enable-shared --disable-install-doc --with-libyaml --with-opt-dir=/Users/nirohayon/.rvm/usr ', please read /Users/nirohayon/.rvm/log/ruby-1.9.3-p125/configure.log
There has been an error while running configure. Halting the installation.
ls: /Users/nirohayon/.rvm/rubies/*/bin/ruby: No such file or directory 
```

请帮助我，我以前使用过 Windows，而且对 Rails 也很陌生，所以我不太了解应该引导我的终端的路径。我需要一步一步的解释来安装导轨并站在我的 Mac 上。

非常感谢！尼尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T13:26:36.937

您对 RVM 的使用看起来很像您没有安装开发工具。从 App Store 获取 XCode，安装命令行工具！

如果你真的想在平台提供的 ruby​​ 上安装 rails，你需要做的就是`sudo gem install rails`，因为你需要使用管理员权限在系统 gemset 中安装 gems。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T13:35:16.463

[本教程](http://ryanbigg.com/2010/12/ubuntu-ruby-rvm-rails-and-you/)帮助我之前在 Mac 上安装了 OS X 10.6（我相信）。唯一麻烦的是 C 编译器，我发现这是查找错误之一的问题。

`Error running 'make ', please read /Users/nirohayon/.rvm/log/ruby-1.9.3-p125/yaml/make.log`您可能会通过键入`vi /Users/nirohayon/.rvm/log/ruby-1.9.3-p125/yaml/make.log`type `esc`key 然后键入`:q!`退出来查找输出。

正如先前的答案所建议的，您需要获得一个编译器。我不知道 Xcode 的细节，但我相信我在 Github 上找到了一个用于 Mac 的 GCC 编译器的安装程序，但直接从 Apple 包中可能会更好，（[教程在这里](http://www.tech-recipes.com/rx/726/mac-os-x-install-gcc-compiler/)）

另请注意，如果您最终不得不使用`sudo`，您可能已经偏离了在您的系统上安装 RVM 的指南。在这种情况下，您的路径将不在主目录中，并且调整源的指令`echo '[[ -s "$HOME/.rvm/scripts/rvm" ]] && source "$HOME/.rvm/scripts/rvm"' >> ~/.bash_profile`将不起作用。最终可能会像`"/usr/local/rvm/scripts/rvm"`

# java - 不显示 MotionEvent.ACTION_UP 或 MotionEvent.ACTION_CANCEL

> ID：10192122
> 
> 赞同：4
> 
> 时间：2012-04-17T13:23:14.000
> 
> 标签：java, android, touch

我正在编写一个需要响应触摸事件的 Android 应用程序。我希望我的应用程序将列表项的颜色更改为自定义颜色。我已经编写了以下代码，但只有该`MotionEvent.ACTION_DOWN`部分有效。LogCat 显示了这一点，`ACTION_CANCEL`并且`ACTION_UP`根本没有被调用。你能帮我理解为什么我的代码不起作用。

这是我的代码...

```
view.setOnTouchListener(new OnTouchListener() {

    public boolean onTouch(View v, MotionEvent event) {
        if (event.getAction() == MotionEvent.ACTION_UP) {
            view.setBackgroundColor(Color.rgb(1, 1, 1));
            Log.d("onTouch", "MotionEvent.ACTION_UP" );
        }
        if (event.getAction() == MotionEvent.ACTION_DOWN) {
            view.setBackgroundColor(Color.rgb(23, 128, 0));
            Log.d("onTouch", "MotionEvent.ACTION_DOWN" );
        }
        if (event.getAction() == MotionEvent.ACTION_CANCEL) {
            view.setBackgroundColor(Color.rgb(1, 1, 1));
            Log.d("onTouch", "MotionEvent.ACTION_CANCEL" );
        }
        return false;
    }
}); 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-04-17T14:14:34.417

如果您`false`从`onTouch`方法返回，则不会向侦听器传递更多事件。您`true`至少应该在`event.getAction() == MotionEvent.ACTION_DOWN`.

重构您的代码，如下所示：

```
view.setOnTouchListener(new OnTouchListener() {

@Override
public boolean onTouch(View v, MotionEvent event) {
if (event.getAction() == MotionEvent.ACTION_UP) {
    view.setBackgroundColor(Color.rgb(1, 1, 1));
    Log.d("onTouch", "MotionEvent.ACTION_UP" );
}
if (event.getAction() == MotionEvent.ACTION_DOWN) {
    view.setBackgroundColor(Color.rgb(23, 128, 0));
    Log.d("onTouch", "MotionEvent.ACTION_DOWN" );
    return true;
}

if (event.getAction() == MotionEvent.ACTION_CANCEL) {
    view.setBackgroundColor(Color.rgb(1, 1, 1));
    Log.d("onTouch", "MotionEvent.ACTION_CANCEL" );
}
return false;
}
}); 
```

# c# - 等轴测图-填空

> ID：10192125
> 
> 赞同：1
> 
> 时间：2012-04-17T13:23:31.777
> 
> 标签：c#, wpf, xaml

我正在尝试编写一个制作等距形状的小型应用程序。我已经能够在图片中制作一个立方体/长方体形状，但我需要能够填充立方体的表面。

[http://peterfleming.net84.net/cube.PNG](http://peterfleming.net84.net/cube.PNG)

我使用了 drawLine 方法和映射点，但我希望有一个更简单的，也许是我可以使用的 drawRectangle 方法，然后填充它们，但到目前为止我还没有找到任何方法，可能是因为等距性质形状。

任何帮助，将不胜感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T13:28:33.483

您所追求的可以通过[Polygon](http://msdn.microsoft.com/en-us/library/system.windows.shapes.polygon.aspx)类轻松完成。

# c# - 为什么我从数据库中获取索引越界错误

> ID：10192134
> 
> 赞同：1
> 
> 时间：2012-04-17T13:24:12.017
> 
> 标签：c#, database, arrays, indexoutofboundsexception

我知道什么是越界索引。当我调试时，我也看到了原因。基本上正在发生的事情是我对我的数据库进行过滤以查找潜在/待定的记录。然后，我收集一组这些数字，将它们发送到另一台服务器，以检查这些数字是否已升级为销售。如果它已升级为销售，服务器会返回新的销售订单 ID 和我的旧待处理销售订单 ID (SourceID)。然后，我在该列表上执行一个 for 循环，以将其过滤掉特定的 SourceID，并将 SourceID 更新为销售订单 ID，并更改几个其他值。问题是，当我在第一个过滤器上使用该过滤器时，它会引发索引越界错误。我检查过滤器返回的结果，它显示为 0。我觉得有点奇怪，因为我从列表中获取了销售订单号，所以它应该在那里。所以我不知道这笔交易是什么。这是引发错误的相关代码。而且它并非一直都这样做。就像我今天早上刚刚运行代码并没有抛出错误一样。但昨晚在我回家之前发生了。

```
 filter.RowFilter = string.Format("Stage = '{0}'", Potential.PotentialSale);
        if (filter.Count > 0)
        {
            var Soids = new int[filter.Count];
            Console.Write("Searching for Soids - (");
            for (int i = 0; i < filter.Count; i++)
            {
                Console.Write(filter[i][1].ToString() + ",");
                Soids[i] = (int)filter[i][1];
            }
            Console.WriteLine(")");
            var pendingRecords = Server.GetSoldRecords(Soids);
            var updateRecords = new NameValueCollection();
            for (int i = 0; i < pendingRecords.Length; i++)
            {
                filter.RowFilter = "Soid = " + pendingRecords[i][1];
                filter[0].Row["Soid"] = pendingRecords[i][0];
                filter[0].Row["SourceId"] = pendingRecords[i][1];
                filter[0].Row["Stage"] = Potential.ClosedWon;
                var potentialXML = Potential.GetUpdatePotentialXML(filter[0].Row["Soid"].ToString(), filter[0].Row["Stage"].ToString());
                updateRecords.Add(filter[0].Row["ZohoID"].ToString(), potentialXML);
            } 
```

如果我计算正确的第 17 行是引发错误的错误。pendingRecords 是一个 object[][] 数组。pendingRecords[i] 是单个记录。pendingRecords[i][0] 是新的 Sales OrderID (SOID)，pendingRecords[i][1] 是旧的 SOID（现在是 SourceID）

对这个有帮助吗？是因为我将 SOID 更改为新的 SOID，并且过滤器自动更新吗？我只是不知道

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T16:42:08.863

好吧，我最终改变了它的工作方式，现在它实际上排序得更好了。由于返回的表的结构，我即将发布的代码有一堆硬编码数字。对于那个很抱歉。从那时起我就学会了不要那样做，但我现在正在做一个不同的项目，当我必须改变程序时会改变它。但这是解决方案。

```
 var potentials = Server.GetNewPotentials(); //loads all records from server
        for (int i = 0; i < potentials.Length; i++)
        {
            var filter = AllPotentials.DefaultView;
            var result1 = CheckSoidOrSource(potentials[i].Soid, true);
            var result2 = CheckSoidOrSource(potentials[i].SourceID,false) ;
            //This potential can't be found at all so let's add it to our table
            if (result1+result2==0)
            {
                Logger.WriteLine("Found new record. Adding it to DataTable and sending it to Zoho");
                AllPotentials.Add(potentials[i]);
                filter.RowFilter = string.Format("Soid = '{0}'", potentials[i].SourceID);
                var index = AllPotentials.Rows.IndexOf(filter[0].Row);
                ZohoPoster posterInsert = new ZohoPoster(Zoho.Fields.Potentials, Zoho.Calls.insertRecords);
                AllPotentials.Rows[index]["ZohoID"] = posterInsert.PostNewPotentialRecord(3, filter[0].Row);
            }
            //This potential is not found, but has a SourceId that matches a Soid of another record.
            if (result1==0 && result2 == 1)
            {
                Logger.WriteLine("Found a record that needs to be updated on Zoho");
                ZohoPoster posterUpdate = new ZohoPoster(Zoho.Fields.Potentials, Zoho.Calls.updateRecords);

                filter.RowFilter = string.Format("Soid = '{0}'", potentials[i].SourceID);
                var index = AllPotentials.Rows.IndexOf(filter[0].Row);
                AllPotentials.Rows[index]["Soid"] = potentials[i].Soid;
                AllPotentials.Rows[index]["SourceId"] = potentials[i].SourceID;
                AllPotentials.Rows[index]["PotentialStage"] = potentials[i].PotentialStage;
                AllPotentials.Rows[index]["UpdateRecord"] = true;
                AllPotentials.Rows[index]["Amount"] = potentials[i].Amount;
                AllPotentials.Rows[index]["ZohoID"] = posterUpdate.UpdatePotentialRecord(3, filter[0].Row);
            }
        }
        AllPotentials.AcceptChanges();
    }
    private int CheckSoidOrSource(string Soid, bool checkSource)
    {
        var filter = AllPotentials.DefaultView;
        if (checkSource)
            filter.RowFilter = string.Format("Soid = '{0}' OR SourceId = '{1}'",Soid, Soid);
        else
            filter.RowFilter = string.Format("Soid = '{0}'", Soid);

        return filter.Count;
    } 
```

基本上发生的事情是，当我以这种方式过滤数据时，我注意到了一些关于我的数据的信息。这两个结果只会返回以下结果 (0,0) (0,1) 和 (1,0) (0,0) 表示该表中根本不存在该记录，因此我需要添加它。(1,0) 表示销售订单 ID (Soid) 与表中的另一个 Soid 匹配，因此它已经存在。最后 (0,1) 表示此表中不存在 Soid 但我找到了一条以 Soid 作为源的记录...对我来说这意味着将其作为源的记录已从潜在的销售，这反过来意味着我必须更新记录和 Zoho。这对我来说工作量要少得多，因为现在我不必搜索赢得和丢失的记录，我只需要搜索丢失的记录。更少的代码相同的结果总是一件好事:)

# android - 无法在 android ndk 中更新项目

> ID：10192135
> 
> 赞同：0
> 
> 时间：2012-04-17T13:24:12.597
> 
> 标签：android

我正在使用 linux，并且我已经成功安装并配置了 ndk。借助[Android NDK 安装](http://developer.android.com/sdk/ndk/index.html)但我无法生成 build.xml 文件

```
root@ndot-173:~/Desktop/NDK4/samples/bitmap-plasma# android update project -p . -s
android: command not found 
```

它显示找不到命令。我如何生成 build.xml 文件..？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-08-14T10:09:30.133

您必须在 PATH 中添加 android sdk 或

你使用android命令ex的绝对路径：you_android_sdk_path/tools/android

# jquery - 不显眼的javascript在提交表单之前重新加载数据输入表单

> ID：10192139
> 
> 赞同：0
> 
> 时间：2012-04-17T13:24:18.993
> 
> 标签：jquery, unobtrusive-javascript, unobtrusive-validation

我正在使用 ASP.Net MVC 并实现不显眼的 javascript 进行表单验证。这是我的代码：

```
@{
   AjaxOptions options = new AjaxOptions
   { 
    HttpMethod = "Post",
    LoadingElementId = "ProcessingMessageContainer",
    Url = @Model.SaveUrl,
    OnBegin = "OnBegin",
    OnSuccess = "OnSaveSuccess",
    OnFailure = "OnSaveFailure",
    OnComplete = "OnComplete",
   };   
 }
 <div id="DataEntryFormContainer">
     @using (Ajax.BeginForm(options)) 
     {
        [form here]
     }
 </div> 
```

问题是当我按下提交按钮时，表单会在服务器上处理实际提交之前重新加载。所以，这是一个糟糕的用户体验。表单数据被传送到服务器并进行相应处理。用户按下提交按钮后，如何防止数据输入表单被重新加载？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T15:09:43.030

听起来您还没有在 Web.config 文件中打开客户端验证和不显眼的 JavaScript。

仔细检查您在 Web.config 中是否有这两行：

```
<add key="ClientValidationEnabled" value="true"/>
<add key="UnobtrusiveJavaScriptEnabled" value="true"/> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T18:55:26.680

我想到了。我以某种方式绑定了 2 个不同的操作来提交按钮。它正在提交表单并请求原始页面。我通过使用萤火虫观看控制台来捕捉它。每次我提交表单时，我都会看到 2 个对服务器的请求：1 个用于提交表单的帖子和 1 个用于检索表单的获取。感谢大家的帮助。

# audio - mp3 音频适用于所有浏览器，但不适用于 IE9

> ID：10192140
> 
> 赞同：3
> 
> 时间：2012-04-17T13:24:20.840
> 
> 标签：audio, internet-explorer-9, html5-audio

我有三个 mp3 音频文件，它们在所有浏览器中都可以正常播放，但在 IE9 中只能播放 1.x 秒，除非我将“控件”更改为“自动播放”，在这种情况下它可以正常播放。

然后我收到了 .wav 格式的原始、未经编辑的文件。我自己将其编码为 mp3，但有同样的问题。

但是，如果我创建自己的 mp3 音频文件并将其插入到相同的标记中，它适用于所有浏览器，包括具有“控件”属性的 IE9。

我只能认为原始音频文件中的设置会导致问题，但不知道可能是什么。

这是测试标记：

```
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title></title> 
</head>
<body>
<audio src="poem.mp3" controls >
</body>
</html> 
```

编辑：

我在页面上放了三个音频文件。有时一两个会一直播放，而第三个根本不会播放。其他时候，两个会玩第二个，但第三个什么都不做。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-13T18:00:30.097

如果有人仍在处理这个问题，我会使用标准`<audio>`的 mp3 标记。

```
<audio controls="controls" preload="auto">
<source src="http://www.davehullthehullabalooer.com/help(5).mp4" type="audio/mp4"/>
<source src="http://www.davehullthehullabalooer.com/help.ogv" type="audio/ogv"/>
<source src="http://www.davehullthehullabalooer.com/help.webm" type="audio/webm"/>
<source src="http://davehullthehullabalooer.com/add-for-beatles-page-188.mp3" type="audio/mp3"/>
</audio> 
```

在 IE9 中：Internet 选项 > 高级选项卡 > 多媒体，我选择“在网页中播放声音”

都好！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T19:00:48.007

编辑：我的修复没有奏效。它在 IE9 中仍然失败，但在所有其他浏览器中一切正常。

我自己的问题的答案至少可以解决问题，但我还没有找到原因。

我不知道为什么某些 mp3 文件在 IE9 中播放得很好，但其他在任何现代浏览器中也能正常播放的文件，使用上面显示的标记无法在 IE9 中播放。我通过添加音频属性来播放音频`preload="auto"`，现在在 IE9 中一切正常。

现代浏览器不需要这个。为什么IE9会，我还不知道。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-19T22:12:42.883

我在 IE9 上显示音频控件时遇到问题，发现 IE9 与预加载属性有冲突。我不希望浏览器通过将所有文件都设置为“自动”来预加载所有文件，但发现将预加载设置设置为“元数据”而不是“无”可以解决问题。可能是替代解决方案。 [http://helephant.com/2011/12/29/the-html5-audio-tag/](http://helephant.com/2011/12/29/the-html5-audio-tag/)：“元数据表明浏览器只需下载足够的文件以找出尺寸、运行长度和大小等信息。”

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-03-09T14:11:19.317

遇到同样的问题，在 IE9 上将预加载设置为元数据时，音频文件只会播放第一秒。原来我的 API 是**gzip 压缩**所有响应，而 IE9 无法处理它。从音频和视频文件中删除 gzip/deflate 压缩后，IE9 就可以了。

# php - jquery .load() 和 wordpress 可用性

> ID：10192141
> 
> 赞同：1
> 
> 时间：2012-04-17T13:24:21.880
> 
> 标签：php, jquery, ajax, wordpress, wordpress-theming

我正在研究 wordpress 主题，你可以看看：greenzone.pl。我想做的是在中间 div 中显示所有帖子的可用性，即单个帖子、评论、附加图片等。2 侧 div 永远不应该重新加载。我对尝试使用的方法的任何替代方法持开放态度（也许是 IFRAME？）。

要加载单个帖子，我使用了 jquery .load()

```
$.ajaxSetup({ cache: false });
$(".openpost, .comments-link").click(function() {
    var post_url = $(this).attr("href");
    $(".container").load(post_url);
    return false;   
});

$(".closepost").click(function() {
    $(".container").load(index.php .postlist);
    return false;
}); 
```

我遇到了一个大问题——我不能使用 ajax 评论（我尝试了很多插件、教程等，没有任何效果）——所以基本上当你发布回复时，你会被重定向到例如。[http://greenzone.pl/?p=32#comment-26](http://greenzoner.pl/?p=32#comment-26)。我目前的评论js是：

```
var commentform = $('#commentform'); // find the comment form
commentform.prepend('<div id="comment-status" ></div>'); // add info panel before the form to provide feedback or errors

var statusdiv = $('#comment-status'); // define the infopanel

commentform.submit(function(){
    //serialize and store form data in a variable
    var formdata = commentform.serialize();

    //Add a status message
    statusdiv.html('<p>Processing...</p>');

    //Extract action URL from commentform
    var formurl = commentform.attr('action');

    //Post Form with data
    $.ajax({
        type: 'post',
        url: formurl,
        data: formdata,
        error: function(XMLHttpRequest, textStatus, errorThrown) {
            statusdiv.html('<p class="wdpajax-error" >You might have left one of the fields blank, or be posting too quickly</p>');
        },
        success: function(data, textStatus) {
            if (data == "success")
                statusdiv.html('<p class="ajax-success" >Thanks for your comment. We appreciate your response.</p>');
            else
                statusdiv.html('<p class="ajax-error" >Please wait a while before posting your next comment</p>');

            commentform.find('textarea[name=comment]').val('');
        }
    });
}); 
```

和 php：

```
add_action('comment_post', 'ajaxify_comments',20, 2);
function ajaxify_comments($comment_ID, $comment_status) {
    if(!empty($_SERVER['HTTP_X_REQUESTED_WITH']) &&      strtolower($_SERVER['HTTP_X_REQUESTED_WITH']) == 'xmlhttprequest'){
        //If AJAX Request Then
        switch($comment_status){
            case '0':
                //notify moderator of unapproved comment
                wp_notify_moderator($comment_ID);
            case '1': //Approved comment
                echo "success";
                $commentdata = &get_comment($comment_ID, ARRAY_A);
                $post = &get_post($commentdata['comment_post_ID']); 
                wp_notify_postauthor($comment_ID, $commentdata['comment_type']);
                break;
                default:
                echo "error";
        }
        exit;
    }
} 
```

使用此方法的其他问题是发布链接。

# session - Safari 5.1.5 中 iframe 上缺少 cookie

> ID：10192142
> 
> 赞同：0
> 
> 时间：2012-04-17T13:24:22.970
> 
> 标签：session, iframe, cookies, safari

这仅适用于 Safari 5.1.4 和 5.1.5。它适用于较旧的 Safari 版本。

如果您访问： http: [//gemal.dk/test/restob.html](http://gemal.dk/test/restob.html) 并单击按钮，您会在 iframe 中获得在线预订

如果您单击绿色日期，然后单击“您的会话已过期”的时间。

如果您检查 cookie，则您没有任何 cookie。

Safari 拒绝会话 cookie，这始于 Safari/Google 问题，其中 Safari 对 3rd 方 cookie 变得更加严格。版本 5.1.4+

我该如何解决这个问题？如何在 iframe 中设置 cookie？

我发送正确的 P3P 标头。我已经尝试了很多我无法让它工作的东西。

它适用于 Safari 5.1.4+ 以外的所有其他浏览器

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T11:42:00.687

也许，以下链接会对您有所帮助。

[http://www.reizbombardement.de/archives/safari-5-1-4-enforces-cookie-policy](http://www.reizbombardement.de/archives/safari-5-1-4-enforces-cookie-policy)

[Safari 3rd 方 cookie iframe 技巧不再有效？](https://stackoverflow.com/questions/9930671/safari-3rd-party-cookie-iframe-trick-no-longer-working/10098007#10098007)

当然，要为您的域设置 cookie 并刷新打开器然后关闭，您必须准备虚拟页面（例如...safari_cookie_fix.php）

但是......在我们的项目中，我们准备了它的虚拟页面作为好看（不错的可用性！）加载页面。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-08T21:20:59.653

我尝试了一个类似的问题。一个网络“父”页面在 jquery fancybox i-frame 跨域中打开我的“子”网站。Explorer、Chrome、Firefox、Opera 甚至 Mac 上的 Safari (5.8.1) 都没有问题。但是对于 iPhone、iPad 和 mini iPad，i-frame 中的会话会丢失。

这意味着每次点击 i-frame 中的元素（网站在 aspx 中）都会启动一个新会话。

我们以非常简单的方式解决问题：

当父网站启动时，它直接调用子网站中的页面（而不是在 i-frame 中）。在这个页面中，我只是设置了一个会话变量，然后我重定向到了父网站。现在，当子网站在 iframe 中打开时，会保留会话。

# ruby-on-rails - will_paginate NoMethodError

> ID：10192146
> 
> 赞同：3
> 
> 时间：2012-04-17T13:24:26.967
> 
> 标签：ruby-on-rails, ruby, will-paginate

为 railstutorial 编写 sample_app 并出现下一个错误。

我已添加 `<%= will_paginate @microposts %>`到用户个人资料视图`@microposts = @user.microposts.paginate(:page => params[:page])`和`UsersController`

```
> NoMethodError (protected method `wp_parse_options' called for #<Class:0x007fde66015a80>):
  app/controllers/users_controller.rb:17:in `show' 
```

哪里有问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T14:38:39.010

再次尝试`gem 'will_paginate', '~> 3.0'`捆绑安装，重新启动服务器。给分页一些额外的参数只是为了它`paginate(page: params[:page], per_page: 15)`

# php - 全局会话变量

> ID：10192147
> 
> 赞同：0
> 
> 时间：2012-04-17T13:24:29.080
> 
> 标签：php, codeigniter, session

我在会话中存储用户语言，然后像这样加载语言文件：

```
$language = $this->session->userdata('language');
$this->lang->load('form_validation', $language); 
```

但这很烦人，当我必须在每个控制器中加载上述`$language`变量时，如果它是一个全局变量会更好，所以我可以只使用：

```
$this->lang->load('form_validation', $language); 
```

*   其中`$language`var 将是一个全局变量。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T13:34:59.017

如果你真的想要一个单线那么为什么不做

```
$this->lang->load('form_validation', $this->session->userdata('language')); 
```

至于一般的全局变量，不必要地创建它们通常不是一个好习惯。原因是全局变量本质上可以从任何地方访问，因此可以从任何地方更新它们，这可能导致难以找到错误

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T13:31:36.807

您可以在 autoload.php 文件中放置一个助手；）。位于 /application/config/autoload.php

因此在助手中定义变量，并将助手放在 autoload['helper'] 数组中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T13:27:37.480

我认为最好的方法（或至少比使用全局变量更好）是在代码中的某处定义一个辅助函数（我不知道它在 CodeIgniter 中的位置），它会为你加载语言文件。

但是，这真的有问题吗？

# javascript - Javascript 应用程序 - 加载数据

> ID：10192150
> 
> 赞同：1
> 
> 时间：2012-04-17T13:24:41.353
> 
> 标签：javascript, asp.net

我有一个 javascript 应用程序，但我不知道加载数据的更好做法是什么。例如，我有一个包含我的联系信息（名字、姓氏、地址、电话号码、网站等）的联系表。所以现在我将展示这些信息并制作两个“列表”。在第一个列表中，我将显示我的所有联系人，但仅显示属性“FirstName”和“LastName”，如果我单击联系人，我将显示所有信息（名字、姓氏、地址、电话号码、网站等）。

一次加载整个信息还是仅在我单击联系人时才加载“详细”信息更好？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T13:41:15.163

取决于使用情况和网络，以下是这两种方式的一些优缺点。

**一次将所有内容加载到 JSON 中，显示需要/选择的内容：**

优点

*   如果数据变化不大，可以轻松缓存
*   没有AJAX，很简单
*   第一次加载后，一切都“立即”发生

缺点

*   如果数据块足够大，可能会伤害您

**通过 AJAX 获取个人信息：**

优点

*   如果数据不断变化，那就太好了
*   如果每个联系人的数据足够大以保证单独的 ajax 调用，那就太好了
*   如果网络延迟不是太可怕，那就太好了

缺点

*   小数据集的矫枉过正
*   增加复杂性

因此，如果您的数据集不是那么大，我会选择简单的路线。如果它是一个大型或不断变化的数据集，我会使用 AJAX 版本。

# php - php GD库 低于一定尺寸的图像不显示

> ID：10192153
> 
> 赞同：1
> 
> 时间：2012-04-17T13:24:54.590
> 
> 标签：php, gd

我正在拍摄链接图像，并使用 imagecopyresampled() 制作我自己调整大小的版本。

当尝试显示 GD 库重采样图像时，低于特定尺寸（大约 160 像素宽度）的图像仅显示为一堆乱码（例如：'����JFIF��>CREATOR: gd-jpeg v1.0（使用 IJG JPEG v62)，默认质量 ��C')。

我自己检查了图像，它们被很好地存储并在图片查看器中打开时正确显示。但是，将它们打印到浏览器是行不通的。当我将像素大小更改为更大的像素大小时，它工作正常。

我正在像这样在浏览器中显示图像

```
$handle = fopen($fileName, "rb");
$img = fread($handle, filesize($fileName));
fclose($handle);
$imgSize = strlen($img);
$image_type = exif_imagetype($fileName);
header('Content-Type: image/JPEG');
header('Content-Transfer-Encoding: binary');
header("Content-Length: $imgSize");
print $img;
return true; 
```

现在我开始相信这与 GD 库有关。其他人对此有任何进一步的了解吗？

谢谢。

编辑：

布拉德的一项建议向我展示了正确的方法。像往常一样，这是一个完全愚蠢的错误。我还不能回答我自己的问题，所以我想我会进行编辑。

我在最初的描述中忘记包含的是，之前的代码都在我的一个模型中，然后我调用了一个函数来在我的控制器中显示图像。

我最近切换到 Symfony2，并且在我的控制器中几乎所有地方都使用了响应返回。然而，我一直在重用我的旧节目图像代码，它是在没有 Symfony 的情况下编写的。我有一个“显示图像”类型的函数，我在控制器中调用它，然后返回一个空响应。因此，Symfony 的响应返回弄乱了编码。高级浏览器能够自动校正大图像，但不能自动校正小图像。

我的最终解决方案变成了

在我的模型中

```
$handle = fopen($fileName, "rb");
$image= fread($handle, filesize($fileName));
fclose($handle);
$image_type = exif_imagetype($fileName); 
```

在我的控制器中

```
return new Response($image, 200, array('Content-Type' => $image_type)); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T13:28:35.387

您看到的是原始图像数据，这意味着浏览器由于某种原因没有注册内容类型。

`Content-Type`我怀疑正在发生的事情是，您正在测试的任何浏览器都对标头**值**区分大小写。

更改`image/JPEG`为`image/jpeg`，看看是否适合您。

至于为什么它适用于更大的图像的解释......很可能`Content-Type`永远不会被识别为已知类型。浏览器会查看他们收到的实际内容，试图找出它是什么类型。它的内容嗅探功能中可能有一些东西，它看起来很短，然后说：“不，可能不是图像”，然后继续前进。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T13:37:58.607

它们有很多方法可以实现工作脚本..我给你2个例子，使用 `file_get_contents`和`read_file`

**示例 1** 使用`file_get_contents`

```
$fileName = "http://www.bestmastersineducation.com/teaching-to-tests/standardized-tests.jpg"; // Full path to image
$img = file_get_contents($fileName);
$imgSize = strlen($img);
header('Content-Type: image/jpeg');
header ('Content-Transfer-Encoding: binary' );
header ("Content-Length: $imgSize" );
echo $img;
return true; 
```

查看演示：[http ://codepad.viper-7.com/GFqsLe](http://codepad.viper-7.com/GFqsLe)

现在创建一个较小的图像样本

```
header ( 'Content-Type: image/jpeg' );
header ( 'Content-Transfer-Encoding: binary' );

$new_width = 100;
$new_height = 100;

$fileName = "http://www.bestmastersineducation.com/teaching-to-tests/standardized-tests.jpg"; // 
$img = file_get_contents ( $fileName );
$im = imagecreatefromstring ( $img );
if ($im !== false) {
    list ( $width, $height ) = getimagesize ( $fileName );
    $imageSample = imagecreatetruecolor ( $new_width, $new_height ); // new                                                    // Height
    imagecopyresampled ( $imageSample, $im, 0, 0, 0, 0, $new_width, $new_height, $width, $height );
    imagejpeg ( $imageSample, null, 100 );
} 
```

演示链接：[http ://codepad.viper-7.com/gXmoDW](http://codepad.viper-7.com/gXmoDW)

**示例 2**使用`readfile`

```
$fileName = "a.jpg" ;   //Full path to image
$imgSize = filesize($fileName);
$imageType = exif_imagetype($fileName);
header('Content-Type:' . image_type_to_mime_type ($imageType));
header('Content-Transfer-Encoding: binary');
header("Content-Length: $imgSize");
readfile($fileName); 
```

选修的

**如果您想强制下载，请改用它**

```
$fileName = "a.jpg" ; //Full path to image 
$imgSize = filesize($fileName);
$imageType = exif_imagetype($fileName);
header('Content-Type: application/octet-stream');
header('Content-Disposition: attachment; filename='.basename($fileName));
header('Content-Transfer-Encoding: binary');
header('Expires: 0');
header('Cache-Control: must-revalidate');
header('Pragma: public');
header("Content-Length: $imgSize");
readfile($fileName); 
```

我希望这有帮助

# jpa - 使用链接表和 JPA 返回集合

> ID：10192154
> 
> 赞同：0
> 
> 时间：2012-04-17T13:24:57.137
> 
> 标签：jpa, linker

在努力了几天试图取回通过外键链接到表的集合之后，我才意识到我链接到的表实际上是将表链接到具有实际数据的其他表（为规范化表填充一个）。

我仍在努力从带有外键引用的 ManyToOne 注释变量中获取集合，但是有没有办法可以从实际包含信息的表中提取数据？有没有人遇到过这种情况？

更新：根据请求，我将发布一些代码实例...这将是我将要调用的实体中的命名查询...

```
@NamedQuery(name="getQuickLaunchWithCollections", query = "SELECT q FROM QuickLaunch q LEFT JOIN FETCH q.quickLaunchDistlistCollection LEFT JOIN FETCH q.quickLaunchPermCollection LEFT JOIN FETCH q.quickLaunchProviderCollection")}) 
```

这些将是我想要填补的收藏...

```
@OneToMany(mappedBy="quickLaunchId", fetch=FetchType.EAGER)
private List<QuickLaunchPerm> quickLaunchPermCollection;

@OneToMany(mappedBy="quickLaunchId", fetch=FetchType.EAGER)
private List<QuickLaunchProvider> quickLaunchProviderCollection;

@OneToMany(mappedBy="quickLaunchId", fetch=FetchType.EAGER)
private List<QuickLaunchDistlist> quickLaunchDistlistCollection; 
```

如您所见，我将获取类型设置为渴望。所以从技术上讲，我应该取回一些数据？但实际上，这些只是将我真正想要拉回的数据链接起来。我需要弄清楚如何最终取回这些数据。

这就是我调用该命名查询的方式......

```
listQL = emf.createNamedQuery("getQuickLaunchWithCollections").getResultList(); 
```

好吧，似乎 LEFT JOIN FETCH
导致我的运行时抛出某种异常。目前还不清楚它是什么。但我觉得我用这种技术一无所获。我要尝试一些稍微不同的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T14:02:34.847

我建议简化示例以面对问题，因为您现在正在全球范围内。

指定`mappedBy="quickLaunchId"`属性，您是说，该`QuickLaunchPerm`实体具有`QuickLaunch`名为的属性`"quickLaunchId"`。这是真的？

如果不是，那么您需要在以下位置定义它`QuickLaunchPerm`：

```
@ManyToOne(fetch = FetchType.EAGER)
@JoinColumn(name = "QUICK_LAUNCH_ID")
private QuickLaunch quickLaunchId;

//getters setters 
```

# c# - 制作“编译器”/二进制编辑器来修改我的 .net 应用程序

> ID：10192163
> 
> 赞同：0
> 
> 时间：2012-04-17T13:25:35.897
> 
> 标签：c#, compiler-construction, binary

这就是我想要完成的事情：

我有两个应用程序。一个是客户端应用程序，另一个是编译器。客户端使用加密，出于安全原因，我希望用户能够运行“编译器”应用程序，该应用程序将在已编译的二进制文件中硬编码安全密钥，因此每个客户端都有自己的加密密钥存储在其中。这甚至可能还是解决方案会很疯狂？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T13:28:33.640

当然，您所说的只是重写 MSIL 代码。微软一直通过代码合同来做到这一点。这是一篇文章的链接，解释了如何：http: [//msdn.microsoft.com/en-us/magazine/cc188743.aspx](http://msdn.microsoft.com/en-us/magazine/cc188743.aspx)

另一个例子： http: [//www.codeproject.com/Articles/20565/Assembly-Manipulation-and-C-VB-NET-Code-Injection](http://www.codeproject.com/Articles/20565/Assembly-Manipulation-and-C-VB-NET-Code-Injection)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T13:35:47.147

如果你的程序集是强签名的，你就不能修改它。您无法将修改后的 .net 程序集保存回磁盘。但是，您可以构建您的程序集（如 Kevin 所述），以便能够在运行时修改加载到内存中的代码。它不会影响磁盘上的图像，并且每次启动应用程序时都会运行修改。

# structuremap - 使用 StructureMap DI 时 OpenRasta 服务中的内存泄漏

> ID：10192165
> 
> 赞同：1
> 
> 时间：2012-04-17T13:25:40.210
> 
> 标签：structuremap, openrasta

我们使用 OpenRasta 来提供二进制资源（主要是图像和 PDF）。其中一些相对较大（5-75MB）。我们遇到了性能问题，并且使用 ANTS 内存分析器确定似乎存在内存泄漏。

我们一直在为 DI 使用 StructureMap，在一篇[博](http://grahamrhay.wordpress.com/2011/03/05/releasing-http-scoped-objects-when-using-openrasta-with-structuremap/)文中发现了以下修改：

```
public void HandleIncomingRequestProcessed()
{
    HttpContextLifecycle.DisposeAndClearAll();
} 
```

当我们进行进一步修改时，泄漏消失了：

```
public void HandleIncomingRequestProcessed()
{
    HttpContextLifecycle.DisposeAndClearAll();
    ObjectFactory.EjectAllInstancesOf<IRequest>();
    ObjectFactory.EjectAllInstancesOf<IResponse>();
    ObjectFactory.EjectAllInstancesOf<ICommunicationContext>();
} 
```

**编辑：这不是一个好主意，因为它会弄乱并发请求。请参阅答案的评论。**

本质上，我想知道，这会搞砸什么吗？还是值得提交的拉取请求？

以下是分析器的前后照片：

![前](../Images/26075b555819c97d38fcb47964abde48.png)

![后](../Images/bba331e8d14a0c10fe6acfd8b49f6594.png)

谢谢-

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T16:11:28.850

做一个拉取请求。SM 支持很差，并且没有使用上下文存储，因此您会看到问题（以及其他问题）。

也就是说，驱逐所有 IRequest 实例不会删除 SM 使用的 http 上下文中的所有实例吗？您可能想查看那里的文档。

# knockout.js - 在不同视图中编辑项目不会在原始视图中更新

> ID：10192178
> 
> 赞同：0
> 
> 时间：2012-04-17T13:26:56.127
> 
> 标签：knockout.js

jsfiddle：http: [//jsfiddle.net/HCQAd/](http://jsfiddle.net/HCQAd/)

```
var Editor = function(v1){
    var self = this;
    self.load_editor = function(item){
        item.prop = "Test4";
    }
}

var sectionView = function(){
    var self = this;      
    self.items = ko.observableArray();
    self.load_items = function(){
        setTimeout(function(){
            var items = [{prop:'Test'}, {prop:'Test2'}, {prop:'Test3'}];
            self.items(items);
        }, 500);
    };        
    self.edit_item = function(item)
    {
        if(self.editor == null)
        {
            self.editor = new Editor(self);
            self.editor.load_editor(item);
        }            
    }
    ko.applyBindings(self, $('.items_container')[0]);
}

var v1 = new sectionView();
v1.load_items();

<div class="items_container">
   <!-- ko foreach: items -->
    <span data-bind="text: prop"></span>
    <a href="javascript:void(0);" data-bind="click: $parent.edit_item">edit</a>
    <br/>
       <!-- /ko -->
</div> 
```

单击编辑链接加载编辑器并传递正在编辑的项目。当我将属性设置为新值时，它不会更新原始视图？如何使其在原始视图中更新？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T14:37:45.073

您应该使用 observables 而不是普通属性。

您的可观察样本：http: [//jsfiddle.net/HCQAd/1/](http://jsfiddle.net/HCQAd/1/)

关于淘汰赛 observables 和 2-way data-binding 的文章。 [http://knockoutjs.com/documentation/observables.html](http://knockoutjs.com/documentation/observables.html)

# javascript - 将类分配给第二个元素Java Script

> ID：10192179
> 
> 赞同：0
> 
> 时间：2012-04-17T13:26:58.890
> 
> 标签：javascript, widget, twitter

我正在使用 JS 函数来提取推特提要，我当时只想显示两条推文，但我想将唯一的 css 类分配给第二个元素（div）我不知道该怎么做，谁能帮忙那，这是我的代码

```
JQTWEET = {

    // Set twitter username, number of tweets & id/class to append tweets
    user: 'username',
    numTweets: 2,
    appendTo: '#jstwitter',

    // core function of jqtweet
    loadTweets: function() {
        $.ajax({
            url: 'http://api.twitter.com/1/statuses/user_timeline.json/',
            type: 'GET',
            dataType: 'jsonp',
            data: {
                screen_name: JQTWEET.user,
                include_rts: true,
                count: JQTWEET.numTweets,
                include_entities: true
            },
            success: function(data, textStatus, xhr) {

             var html = '<div class="tweet">TWEET_TEXT';

                 // append tweets into page
                 for (var i = 0; i < data.length; i++) {
                    $(JQTWEET.appendTo).append(
                        html.replace('TWEET_TEXT', JQTWEET.ify.clean(data[i].text))
                            .replace(/USER/g, data[i].user.screen_name)
                            .replace('AGO', JQTWEET.timeAgo(data[i].created_at))
                            .replace(/ID/g, data[i].id_str)
                    );

                 }                  
            }   

        });

    }, 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T13:33:57.703

你的意思是

```
for (var i = 0; i < data.length; i++) {
  $(JQTWEET.appendTo)
   .append('<span class="'+((i%2==0)?"even":"odd")+'">')
   .append(
     html.replace('TWEET_TEXT', JQTWEET.ify
     .clean(data[i].text))
     .replace(/USER/g, data[i].user.screen_name)
     .replace('AGO', JQTWEET.timeAgo(data[i].created_at))
     .replace(/ID/g, data[i].id_str)
    .append('</span>');
} 
```

# windows-server-2003 - vmware 中的 Windows Server 2003 无法上线

> ID：10192180
> 
> 赞同：0
> 
> 时间：2012-04-17T13:27:01.587
> 
> 标签：windows-server-2003, vmware

我的主机是 64 位 Windows 7 Enterprise 设备。我安装了 vmware 播放器，并且有一个运行 XP SP3 的虚拟机，用于一些老式的 vb6 开发。在这个虚拟操作系统中，我可以正常访问互联网。虚拟机网络适配器设置为 NAT。

我还有另一台运行 Windows Server 2003 R2 SP2 的虚拟机。这也设置为 NAT。但是，我无法从这台机器内部访问网络。尝试的故障排除包括关闭防火墙、将我的主机上的 vmware 网络连接设置为自动检索 IP 和 DNS 以及在谷歌上进行长时间搜索。我发现了这个，[http://www.techexams.net/forums/off-topic/27651-vmware-nat-not-working-correctly.html](http://www.techexams.net/forums/off-topic/27651-vmware-nat-not-working-correctly.html)但似乎无法按照说明进行操作，因为它显然是一个更旧的 vmware 版本. （2006 年！）我还尝试禁用“Internet Explorer 增强的安全配置”

任何帮助都会很棒。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T07:13:35.540

您可以通过远程桌面连接到您的 VPS 吗？如果是，请检查代理的浏览器设置，看看它是如何连接到互联网的。如果您使用的是 FireFox，则需要按照以下步骤操作：

1.  打开火狐。
2.  单击工具-> 选项。
3.  转到高级 -> 网络选项卡。
4.  转到连接-> 设置。

# android - 锁定标签更改 - TabHost

> ID：10192182
> 
> 赞同：2
> 
> 时间：2012-04-17T13:27:09.193
> 
> 标签：android, testing, onclick, tabcontrol, android-tabhost

我使用以下方法检查选项卡是否被单击：

```
tabHost.setOnTabChangedListener(new OnTabChangeListener() {

            public void onTabChanged(String tabId) {
                int i = tabHost.getCurrentTab();

                if (i == 2) {
                    Log.i("Tab Number", "=" + i);
                    testFields(); // Verifies that the data fields were filled.
                }
            }
        }); 
```

当我检查字段是否正确时，我有一个“if or else”测试。

如果一切都完成了，OK！

如果没有，则无法进入下一个选项卡。必须保留标签“数据”才能完成填充。

**如何阻止选项卡中的更改？直到一切都正确？**

**编辑以显示测试有帮助**

```
final TabHost tabHost = (TabHost) getParent().findViewById(
                android.R.id.tabhost);
        // ONCLICK TABHOST
        for (int i = 0; i < tabHost.getTabWidget().getTabCount(); i++) {
            tabHost.getChildAt(i).setOnTouchListener(new OnTouchListener() {

                public boolean onTouch(View v, MotionEvent event) {
                    int action = event.getAction();

                    if (action == MotionEvent.ACTION_UP) {
                        String currentTabTag = (String) tabHost
                                .getCurrentTabTag();
                        String clickedTabTag = (String) v.getTag();

                        if ((etCargac.getText().toString().equals(""))
                                || (tsoloSelecionadac.equals("Selecione"))) {
                            return false; // allows tab change
                        }
                        return true; // doesnt allow tab change
                    }
                    return false;
                }
            });
        } 
```

我想做的这个活动是在另一个班级。它不属于 tabhost 类。所以我必须使用 getParent()，对吗？

我需要做的测试是检查字段“tab1 数据”是否已填写。

如果什么都不完整不应该切换到“tab3结果”

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-17T13:28:39.287

在每个选项卡上使用 OnTouchListener，您可以轻松防止更改选项卡。

```
 for (int i=0; i<tabWidget.getTabCount(); i++) {
        tabWidget.getChildAt(i).setOnTouchListener(new OnTouchListener() {
            @Override
            public boolean onTouch(View view, MotionEvent event) {
                int action = event.getAction();

                if (action == MotionEvent.ACTION_UP) {
                    String currentTabTag = (String) tabHost.getCurrentTabTag();
                    String clickedTabTag = (String) view.getTag();

                    testFields();

                    if (!fieldAreCorrect) {
                        return true; // does not allow tab change
                    }
                }
                return false; // allows tab change
            }               
        });
    } 
```

# ios - iOS 4 和 iOS 5 读取 pdf 文件时 UIWebView 的区别

> ID：10192186
> 
> 赞同：3
> 
> 时间：2012-04-17T13:27:33.750
> 
> 标签：ios, webview

我发现 iOS 4 和 iOS 5 之间的差异导致我的代码出错。当我创建一个`UIWebView`时，它还创建了一个名为`UIWebBrowserView`577 x 533 的框架的子视图。然后，我在其中加载了一个 PDF 文件，`UIWebView`这里 iOS 4 和 5 之间存在差异。在 iOS 4 中，当处理到达方法时“webViewDidFinishLoad:”，`UIWebBrowserView`仍然存在帧 577 x 2947（我想是 pdf 的大小），在 iOS 5 中，`UIWebBrowserView`不再存在，在它的地方有一个`UIWebPDFView`帧 577 x 533（我在这里期望尺寸为 577 x 2947 的帧）。最后，我引发了一个事件，并且视图符合我的预期（`UIWebBrowserView`iOS 4 中的帧为 577 x 2947，iOS 5`UIWebPDFView`中的帧为 577 x 2947.4）。

问题是当加载pdf文件时，当处理到达“webViewDidFinishLoad：”方法时，我想在PDF文件中添加注释，但在这个方法`UIWebPDFView`中还没有pdf的实际大小。如果我只是把笔记放在那里，它们就不会出现。在 iOS 4 中它可以工作，但在 iOS 5 中它不再工作了。任何人都可以帮助我如何将注释放在 webview 的加载上？

这是显示iOS和日志下方的不同行为的代码。

```
ViewController.h
#import <UIKit/UIKit.h>

@interface ViewController : UIViewController <UIWebViewDelegate, UIGestureRecognizerDelegate>
{
    IBOutlet UIView *view;
    IBOutlet UIWebView * webView;
}

- (void)handleTap:(UITapGestureRecognizer *)recognizer;

@end

ViewController.m
#import "ViewController.h"

@interface ViewController ()

@end

@implementation ViewController

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.

    [webView setUserInteractionEnabled:YES];
    [view bringSubviewToFront:webView];

    //Load view with a pdf file
    NSString *path = [[NSBundle mainBundle] pathForResource:@"pdf_teste" ofType:@"pdf"];
    NSData *pdfData = [NSData dataWithContentsOfFile:path];
    [webView loadData:pdfData MIMEType:@"text/pdf" textEncodingName:@"UTF-8" baseURL:[NSURL URLWithString:@""]];

    //Log
    NSLog(@"On viewDidLoad: %@", [[webView viewForZoomingInScrollView:(UIScrollView *)[[webView subviews] objectAtIndex:0]] description]);

    //Add a tap gesture recognizer
    UITapGestureRecognizer *recognizer = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(handleTap:)];
    recognizer.delegate = self;
    [webView addGestureRecognizer:recognizer];
}

- (void)webViewDidFinishLoad:(UIWebView *)view
{
    //Log
    NSLog(@"On webViewDidFinishLoad: %@", [[webView viewForZoomingInScrollView:(UIScrollView *)[[webView subviews] objectAtIndex:0]] description]);

    //I’d like to insert the saved notes here.

}

- (void)handleTap:(UITapGestureRecognizer *)recognizer
{
    //Log
    NSLog(@"On Tap Event: %@", [[webView viewForZoomingInScrollView:(UIScrollView *)[[webView subviews] objectAtIndex:0]] description]);
}

@end 
```

* * *

日志：

iOS 5.1

2012-03-30 14:24:28.075 WebViewTest[173:707] 在 vi​​ewDidLoad: >

2012-03-30 14:24:28.823 WebViewTest[173:707] 在 webViewDidFinishLoad 上：> 3 月 30 日 14:24:29 iPad2-de-ASDS WebViewTest[173]：OPDILG+TT857o00：FT_Select_Charmap 失败：错误 38。

## 2012-03-30 14:24:47.167 WebViewTest[173:707] 平移事件：>

iOS 4.3.5

2012-03-30 14:13:46.285 WebViewTest[823:607] 在 vi​​ewDidLoad: >

2012-03-30 14:13:47.049 WebViewTest[823:607] 在 webViewDidFinishLoad 上：> 3 月 30 日 14:13:47 BNBConsult01 WebViewTest[823]：OPDILG+TT857o00：FT_Select_Charmap 失败：错误 38。

2012-03-30 14:14:48.199 WebViewTest[823:607] 平移事件：>

# android - 如何使列表加载器从 Android 中的详细 Activity 重新加载

> ID：10192193
> 
> 赞同：0
> 
> 时间：2012-04-17T13:27:48.013
> 
> 标签：android, android-listfragment

我有一个 ListFragment，它的数据由 SimpleCursorLoader 加载（自己的实施；它用光标加载，不使用 URI）。

选择列表中的项目时。我要么启动一个新活动（详细活动），要么显示在 ListFragment 旁边的详细片段中选择的内容。视屏幕大小而定。

如果将详细信息片段添加到 ListActivity，我已经弄清楚如何重新加载列表。我为 ListActivity 分配了一个接口，并在发生更改时从详细信息片段中调用它。在列表片段中，我使用 getLoaderManager().restartLoader(0, null, this); 重新加载列表

现在我的问题是，如果加载了详细活动，我无法访问 ListActivity 上的方法。我可能可以实现一些观察者模式。但这必须有一个最佳实践。
当详细片段更改数据库中的数据时，如何使 ListFragment 重新加载列表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T15:24:08.743

尝试将您的列表创建代码移至 onResume。这样，它会在活动创建时运行，并且每次您离开活动并返回时都会运行。

# string - BASH 字符串行为异常

> ID：10192194
> 
> 赞同：0
> 
> 时间：2012-04-17T13:27:50.567
> 
> 标签：string, bash

为什么在本例中将分支设置为“m”而不是“master”？

```
$ branch="[master]"
$ echo $branch
m 
```

这发生在我所在的任何目录中，但仅在我的 mac 上而不是在我的一个 linux 机器上。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T13:31:40.760

貌似是[文件名扩展](http://tldp.org/LDP/Bash-Beginners-Guide/html/sect_03_04.html#sect2)，你当前目录下有文件叫`m`吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T13:34:52.800

事实上，正如 unwind 所说，这与文件名扩展有关。

```
[15:33] ~$ branch="[master]"
[15:33] ~$ echo $branch 
[master]
[15:33] ~$ touch m
[15:33] ~$ echo $branch
m
[15:33] ~$ 
```

当前目录中必须有一个名为`m`.

一个可能的补救措施是使用引用：

```
$ ls m # `m' exists
m
$ echo "$branch" # yet this echoes "[master]"
[master] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T13:33:24.073

也许是某种逃避问题，你有没有试图逃避 [ 和 ]？

编辑：我可以在我的系统上重现该行为，但前提是`m`存在名为的文件：

```
[sf@zeus:~] touch m
[sf@zeus:~] branch="[master]"
[sf@zeus:~] echo $branch
m 
```

# php - 在php中的单个页面上显示5张图片

> ID：10192197
> 
> 赞同：-2
> 
> 时间：2012-04-17T13:27:51.463
> 
> 标签：php, phpmyadmin

我有 5 个附件，我想将它们打印在一个页面上。我正在使用以下代码显示一个附件，现在我想通过换行符在第一个附件下方打印其他 4 个附件。

```
$path1=$rowArray['file1'];
$path2=$rowArray['file2'];
$path3=$rowArray['file3'];
$path4=$rowArray['file4'];
$path5=$rowArray['file5'];

<td><font face="Arial, Helvetica, sans-serif"><?php printf('<a href="%s">View all Files</a>',$path1); ?></font>

</td> 
```

File1 已成功显示，现在如何在第一个下方显示其他 4 个。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T13:33:15.853

你可以重复你对所有文件所做的事情。或者您可以只循环遍历数组，而忘记您拥有的五个变量。

```
<?php

foreach($rowArray as $value)
{
?>
    <td>
        <font face="Arial, Helvetica, sans-serif"><?php printf('<a href="%s">View all Files</a>', $value); ?></font>
    </td>
<?php
}
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T13:33:58.650

您可以简单地使用 4 个 tr 标签，并在 td 标签中显示您的文件，就像您在第一行显示它一样

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T13:31:01.917

添加另一行 ( `<tr>`) 并在列 ( ) 内显示图像`<td>`。

# c++ - 使用boost模块而不使用boost的其余部分？

> ID：10192199
> 
> 赞同：3
> 
> 时间：2012-04-17T13:27:58.723
> 
> 标签：c++, multithreading, boost, boost-asio, boost-signals

我想在我正在开发的一个小型教育框架中包含提升信号，但我不想添加所有内容，因为提升很大，我需要的是线程、信号 1&2 和 asio。

我的问题是关于由于没有完整的 boost 库而可能导致的任何依赖关系或许可问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-17T13:53:26.570

Boost 提供了一个名为[BCP](http://www.boost.org/doc/libs/1_49_0/tools/bcp/doc/html/index.html)的工具，它会自行提取 Boost 的部分内容来达到这个目的

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T13:46:10.620

引用[Boost 许可证](http://www.boost.org/LICENSE_1_0.txt)：

> 特此免费授予任何获得本许可所涵盖的软件和随附文档（“软件”）副本的个人或组织使用、复制、展示、分发、执行和传输该软件的许可，以及准备软件的**衍生作品**，并允许向其提供软件的第三方这样做，所有这些都受以下条件的约束：

整体 Boost 大小不会影响生成的二进制文件，因此，我认为，您关心的是您的框架分布大小。

您可以包含所有头文件库和二进制 Boost.System、Boost.Thread 和 Boost.Asio，它应该可以工作。

# c++ - 中央 Typedefs.h 文件 - 这是个好主意吗？

> ID：10192202
> 
> 赞同：2
> 
> 时间：2012-04-17T13:28:04.937
> 
> 标签：c++, typedef, header-files

来自没有 typedef 的 Java 世界，我有一个 C++ 开发人员的问题：

我的任务是用 C++ 重写一个大型 MATLAB 项目。为了了解代码的结构，我已经开始在没有实际实现功能的情况下重新构建模块和类结构。

我知道我经常需要像`Vector`and这样的类/类型`ParameterList`，这将由我尚未决定的一些框架提供。

所以我创建了一个中央头文件`Typedefs.h`，其中我有类型定义，如

```
typedef void Vector; // TODO: set vector class
typedef void ParameterList; // TODO: set parameter list class 
```

目前，这些设置为 void，但我可以使用这些类型来编写类骨架和方法签名。稍后我可以用实际类型替换它们。

这是有道理的吗？如果是，有没有办法避免`Typedefs.h`在每个文件中手动包含？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-17T13:32:02.610

我怀疑这会起作用，除非您使用例如`Vector*`. 您将无法拥有`Vector`对象或参数，因此几乎没有意义。

对于用作指针，您可以很好地进行前向声明。

无论如何，我真的不认为有任何需要。您可以声明一个空类而无需实现它，而且它甚至比 a 更容易编写`typedef`：

```
 typedef void Vector; 
```

对比

```
 struct Vector{}; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-17T13:32:12.820

请注意，您将无法使用`typedef`映射到相同类型的 s 重载函数：

```
void foo(Vector);
void foo(ParameterList);   // error: foo(void) already declared 
```

# mysql - MySql DB 查询优化器和like 关键字

> ID：10192204
> 
> 赞同：2
> 
> 时间：2012-04-17T13:28:09.663
> 
> 标签：mysql, sql, hibernate, query-optimization

MySql 查询优化器如何处理以下查询？

```
Select * from Eomlpyees e where e.department_id = 100 and e.name like '%%';

Select * from Eomlpyees e where e.department_id = 100; 
```

第一个查询是一个休眠命名查询。我正在介绍另一个不需要使用“名称”过滤器的 API。

我应该通过传递空的“名称”过滤器还是添加第二个命名查询来使用第一个查询。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T13:34:09.673

在这两种情况下，将使用 department_id 上的索引。在第一个查询中，MySQL 将对结果集执行额外的扫描（在按部门 ID 过滤之后）以过滤记录是否与名称模式匹配。优化器可能会看到这匹配所有帖子并且不执行此扫描（按照建议检查说明），但这也可能是特定于版本的

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T13:39:04.050

首先，这两个查询是不等价的。第二个查询将显示`null`名称的值，但第一个查询不会显示`null`名称的值。

否则，第一个查询有两个要比较的字段，因此第二个查询需要更多时间。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T13:29:23.857

您可以使用`EXPLAIN`.

[在这里](http://dev.mysql.com/doc/refman/5.1/en/using-explain.html)查看更多信息。

# iphone - 单击该单元格中的按钮时如何更改自定义单元格中的标签文本

> ID：10192214
> 
> 赞同：0
> 
> 时间：2012-04-17T13:28:42.797
> 
> 标签：iphone, uitableview

我创建了一个带有标签和按钮的自定义 tableView。在一个按钮上单击一个单元格，我只想更改该单元格中的标签文本。我的问题是当我单击按钮时，其他单元格中的相应标签也会发生变化。这是我的代码

```
 -(UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath{
static NSString *CellIdentifier=@"CellIdentifier";
UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier: CellIdentifier];

if (cell == nil) { cell = [[[UITableViewCell alloc]
                            initWithStyle:UITableViewCellStyleDefault 
                            reuseIdentifier: CellIdentifier] autorelease];

        UILabel *labelOne = [[UILabel alloc]initWithFrame:CGRectMake(70, 10, 100, 20)];
        labelOne.tag = 100;
        labelOne.backgroundColor=[UIColor clearColor];
        labelOne.font=[UIFont systemFontOfSize:14];
        [cell.contentView addSubview:labelOne];
        [labelOne release];

        UIButton *minusbutton=[[UIButton alloc]initWithFrame:CGRectMake(152, 5, 15, 20)];

        minusbutton.backgroundColor=[UIColor clearColor];
        [minusbutton addTarget:self action:@selector(DecreaseTickets:) forControlEvents:UIControlEventTouchUpInside];
        [minusbutton setTitle:@"-" forState:UIControlStateNormal];
        [minusbutton setTitleColor:[UIColor whiteColor] forState:UIControlStateNormal];
        [minusbutton setBackgroundImage:[UIImage imageNamed:@"button-green1.png"] forState:UIControlStateNormal];
        [cell.contentView addSubview:minusbutton];
        [minusbutton release];

        UILabel *quantity = [[UILabel alloc]initWithFrame:CGRectMake(170, 5, 20, 20)];
        quantity.tag = 103;
        quantity.backgroundColor=[UIColor clearColor];
        quantity.font=[UIFont systemFontOfSize:12];
        [cell.contentView addSubview:quantity];
        [quantity release];

        UIButton *addbutton=[[UIButton alloc]initWithFrame:CGRectMake(192, 5, 15, 20)];

        addbutton.backgroundColor=[UIColor clearColor];
        [addbutton addTarget:self action:@selector(IncreaseTickets:) forControlEvents:UIControlEventTouchUpInside];
        [addbutton setTitle:@"+" forState:UIControlStateNormal];
        [addbutton setTitleColor:[UIColor whiteColor] forState:UIControlStateNormal];
        [addbutton setBackgroundImage:[UIImage imageNamed:@"button-green1.png"] forState:UIControlStateNormal];
        [cell.contentView addSubview:addbutton];
        [addbutton release];

        UILabel *labelTwo = [[UILabel alloc]initWithFrame:CGRectMake(260, 10, 140, 20)];
        labelTwo.tag = 101;
        labelTwo.backgroundColor=[UIColor clearColor];
        labelTwo.font=[UIFont systemFontOfSize:14];
        labelTwo.textColor=[UIColor colorWithRed:0.25098 green:0.447059 blue:0.07451 alpha:1];
        [cell.contentView addSubview:labelTwo];
        [labelTwo release];

        UILabel *label3 = [[UILabel alloc]initWithFrame:CGRectMake(70, 30, 230, 30)];
        label3.tag = 102;
        label3.backgroundColor=[UIColor clearColor];
        label3.numberOfLines=2;
        label3.font=[UIFont systemFontOfSize:12];
        [cell.contentView addSubview:label3];
        [label3 release];

}

    UILabel *labelOne = (UILabel *) [cell.contentView viewWithTag:100];
    NSString *ss2=[[NSString alloc]initWithFormat:@"%@",[[eventTicketListArray objectAtIndex:indexPath.row ]tit] ];

    labelOne.text = ss2;    

    UILabel *labelTwo = (UILabel *) [cell.contentView viewWithTag:101];
    labelTwo.text = [[NSString alloc]initWithFormat:@"%@",[[eventTicketListArray    objectAtIndex:indexPath.row ]price] ];

    UILabel *label3 = (UILabel *) [cell.contentView viewWithTag:102];
    label3.text=[[NSString alloc]initWithFormat:@"%@",[[eventTicketListArray objectAtIndex:indexPath.row ]desc ] ];

    UILabel *label4 = (UILabel *) [cell.contentView viewWithTag:103];
    label4.text=[[NSString alloc]initWithFormat:@"%d",qty];
}

return cell; 
```

}

```
 Initially qty=0 
```

现在我希望当我单击添加按钮时，该单元格的数量会增加。这是我的按钮点击事件

```
 -(void)IncreaseTickets:(id)sender{

NSIndexPath *indexPath =[ticketTable indexPathForCell:(UITableViewCell *)[[sender superview] superview]];

//NSUInteger row = indexPath.row;
  UITableViewCell *currentCell = (UITableViewCell *)[[sender superview] superview] ;

UILabel *label4 = (UILabel *) [currentCell.contentView viewWithTag:103];
label4.text=[[[NSString alloc]initWithFormat:@"%d",qty++] ;

//NSLog(@"%d",row);

[ticketTable reloadData]; 
```

}

但问题是当我单击按钮时，所有单元格的数量都会增加。请指导我如何做到这一点。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T13:37:10.413

你打电话时

```
 [ticketTable reloadData]; 
```

您的所有数据重新加载并且您的表再次初始化

UITable 的魔力在于重用一些已分配的单元格（只需最少数量的单元格：屏幕上一次可查看的单元格），然后您应该在滚动时使用新的数据设置重用它们，通常在表数据中使用 NSArray代表...

和： 数量在哪里定义？似乎它是一个全局变量，而不是每个单元格都有一个......

你最好阅读一些苹果示例代码或一些教程

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T13:39:45.470

像这样设置条件..在全局变量 NSUInteger myRow 上设置。

```
 myRow = indexPath.row;//Set Selected index path. 
```

在 cellForRowAtIndexPath 设置条件。

```
 if(myRow == indexPath.row)
 {
     NSUInteger newqty = qty + 1;
     UILabel *label4 = (UILabel *) [cell.contentView viewWithTag:103];
     label4.text=[[NSString alloc]initWithFormat:@"%d",newqty];
 }
 esle
 {
     UILabel *label4 = (UILabel *) [cell.contentView viewWithTag:103];
     label4.text=[[NSString alloc]initWithFormat:@"%d",qty];
  } 
```

并为此设定一些逻辑。

# java - Windows 需要 64 位 jdk 1.5

> ID：10192215
> 
> 赞同：2
> 
> 时间：2012-04-17T13:28:56.620
> 
> 标签：java

我需要 Windows 7 的 64 位版本的 jdk 1.5 安装程序。我无法找到任何地方。我能看到的是用于 Windows 的 64 位 jdk1.5 的 AMD 版本。这行得通吗？或建议一个我可以获得旧版本 jdk 的站点。我看到了[链接](http://www.oracle.com/technetwork/java/javasebusiness/downloads/java-archive-downloads-javase5-419410.html#jre-1.5.0-oth-JPR)，但它没有给我 64 位版本。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T13:32:57.680

AMD64 表示 64 位，包括 Intel（IA-64 除外，在某些服务器上可以找到）。

不过说真的，1.5 很久以前就停产了。是时候升级了！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T13:32:37.863

> Java 开发工具包 5.0 更新 22、33.12 MB、jdk-1_5_0_22-windows-amd64.exe

听起来像你想要的？该链接在您链接到的那个页面上！

我不会像往常一样抱怨你/谁让你使用 Java 1.5 真的应该继续几个版本；）

# android - 如何在Android中将GridView的行高设置为适合屏幕

> ID：10192217
> 
> 赞同：3
> 
> 时间：2012-04-17T13:28:59.160
> 
> 标签：android, gridview

我想拉伸 GridView 的行以匹配 Android 中屏幕的高度。我该怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T09:09:24.633

> 您可以根据您放入的内容来控制行高。由于您的单元格似乎有多个小部件，因此它们可能被包裹在 LinearLayout 或其他东西中。将您的 LinearLayouts 设置为某个特定的高度，并且行都将是该高度。
> 
> 就个人而言，我认为如果要在每个单元格的基础上在每个图像的上方和下方放置文本，则应该调整图像的大小。

使用参考[公共软件链接](https://stackoverflow.com/questions/2375962/gridview-row-height/2379461#2379461)

# mysql - 如何在 MySQL 数据库中保存游戏进度

> ID：10192218
> 
> 赞同：6
> 
> 时间：2012-04-17T13:29:09.247
> 
> 标签：mysql

我正在开发一个网站，它是一种游戏。用户的进度保存在 MySQL 数据库中。

我想通过保存一个带有列保存（ID）和列进度的表来解决这个问题，其中进度是数据类型文本。当用户开始时，进度设置为（例如）“0”。如果他进入第 1 级，进度设置为“0#1”，第 2 级设置为“0#1#2”。关卡的顺序是免费的，我想保存它。所以进度可能是'0#4#2#15'等等。

这是一个好方法吗？我没有使用 SQL 的经验，也不想做一些非常愚蠢的事情。我已经阅读了很多关于表、外键和诸如此类的令人困惑的信息......

我要感谢您花时间阅读本文，我期待着答案。

瑞安

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T13:37:17.100

回答你的问题 1

我不会以这种方式解决您的问题。我将创建 3 个表：一个`Levels`表（'levelKey' 的主键）、一个`Users`表（'userKey' 的主键）和一个`User_Levels`具有 'levelKey' 和 'userKey' 复合键的表。当用户完成一个级别时，只需插入到`User_Levels`表中。然后查看用户是否完成了一个级别是一个简单的选择：

```
SELECT 'a' FROM User_Levels WHERE userKey = ? AND levelKey = ? 
```

如果行数 > 0，则用户已完成关卡

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T13:51:55.493

至于问题2，我想说查询的数量不是问题。毕竟，您是在将数据**写入**数据库，而不是访问它。就个人而言，每当用户实际完成一个级别时，我都会向数据库发送“保存”。

watcher 发布了一个很好的方法来将级别和用户拆分到不同的表中。从进度登录到 User_Levels 的顺序可以看出进度的顺序，因此无需存储类似 1#3#4#9 的内容

您可能希望使用 ajax 在后台发送存档，这样您就不会中断游戏。例如，查看[jQuery 的 $.post 方法](http://api.jquery.com/jQuery.post/)。或者，如果您的游戏是 Flash，您可以使用 URLRequest。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T13:38:49.137

关于你的第一个问题，如果游戏/关卡是非线性的，我会采取不同的方法；我只需添加一个表，其中包含用户 ID 列和已完成级别的列。因此，如果用户 1 完成了级别 0、4 和 7，我的表将有 3 行：

```
UID  levels_completed
1    0
1    4
1    7 
```

关于您的其他问题，您可以使用 javascript 事件和 ajax 来检测页面的关闭，但我不会依赖它；我会在需要时运行查询。如果你的会话被破坏，你已经太迟了......

# java - 如何应用连接池？

> ID：10192222
> 
> 赞同：0
> 
> 时间：2012-04-17T13:29:28.133
> 
> 标签：java, jsp, tomcat, servlets, connection-pooling

我对本教程很感兴趣：[BalusC 代码：DAO 教程 - 在 JSP/Servlet 中使用](http://balusc.blogspot.in/2008/07/dao-tutorial-use-in-jspservlet.html)
如何将连接池与此代码一起应用？代码会有什么变化？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T13:45:08.987

我不确定 Tomcat，但至少像 GlassFish 这样的应用程序服务器集成了连接池功能。您只需要在管理界面中配置连接详细信息。然后在您的 EJB 中使用：

```
@PersistenceContext
private EntityManager em; 
```

容器将负责连接池。

# bash - sudo 和 chpasswd 在一条线上

> ID：10192223
> 
> 赞同：2
> 
> 时间：2012-04-17T13:29:29.163
> 
> 标签：bash, ssh, passwords, sudo

我需要通过连接到服务器`ssh`并更改用户的密码，而无需键入`ssh`或`sudo password`。

我找到了一些示例，但我无法完成一个命令。

我找到了这个用于 ssh 连接的命令，而无需输入密码并`sudo`为删除用户运行命令：

```
sshpass -p $admin_password ssh -t $admin@$server "echo $admin_password | sudo -S /usr/sbin/userdel -r $usr" 
```

然后我找到了更改用户密码的命令：

```
echo "$usr:$password" | sudo -S /usr/sbin/chpasswd; 
```

最后，我想要这样的东西：

```
sshpass -p $admin_password ssh -t $admin@$server "echo $admin_password | sudo -S echo "$usr:$password" | sudo -S /usr/sbin/chpasswd;" 
```

你有什么想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T02:48:06.197

你的问题实际上需要两件事。远程更改用户密码的命令：

```
ssh remoteserver 'echo -e "passwdofuser\npasswdofuser" | passwd username' 
```

为了做到这一点，您可能需要成为 root，或者在 sudo 配置中，让“passwd”不需要密码才能运行您的用户。

```
visudo 
```

编辑文件：

```
Cmnd_Alias      MYPASSWD = /usr/bin/passwd
yourusername ALL = NOPASSWD: MYPASSWD 
```

这应该允许您 ssh 进入，而不必使用密码来运行 passwd 命令。

# enterprise-library - 如何升级到 EntLib 5（从 1.1） IRolesProvider 不存在

> ID：10192224
> 
> 赞同：0
> 
> 时间：2012-04-17T13:29:29.753
> 
> 标签：enterprise-library

我们正在从企业库 1.1 升级到 5.0，其中一些接口和类不适用于企业库 5.0 dll 参考。

1.  配置提供者
2.  IRolesProvider
3.  安全配置视图

这些在企业库 5.0 中不起作用

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T15:45:30.073

1.  配置已移至 .NET 2.0，因此任何自定义配置都应转换为使用 BCL 类。

2.  我认为 IRolesProvider 将被抽象的[RoleProvider](http://msdn.microsoft.com/en-us/library/system.web.security.roleprovider.aspx)类所取代。

3.  SecurityConfigurationView 在 4.1 和 5.0 版本之间被删除。它只是 SecuritySettings 配置类的一个小外观。您可以直接访问 SecuritySettings 或（重新）使用您自己的类创建功能。

# perl - Perl 中的嵌套子例程和作用域

> ID：10192228
> 
> 赞同：17
> 
> 时间：2012-04-17T13:29:50.737
> 
> 标签：perl, scope, nested, subroutine

我写 Perl 已经有一段时间了，总是在发现新事物，我只是遇到了一些有趣的东西，我没有解释，也没有在网上找到它。

```
sub a {
   sub b {
     print "In B\n";
   }
}
b(); 
```

为什么我可以`b()`从它的范围之外调用它并且它有效？

我知道这样做是一种不好的做法，但我不这样做，我在这些情况下使用封闭等，但只是看到了这一点。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-04-17T13:49:22.543

子例程在编译时存储在全局命名空间中。在您的示例`b();`中是`main::b();`. 要将函数的可见性限制在范围内，您需要将匿名子例程分配给变量。

命名子例程和匿名子例程都可以形成闭包，但由于命名子例程仅在嵌套它们时才编译一次，因此它们的行为不如许多人期望的那样。

```
use warnings;
sub one {
    my $var = shift;
    sub two {
        print "var: $var\n";
    }
}
one("test");
two();
one("fail");
two();
__END__
output:
Variable "$var" will not stay shared at -e line 5.
var: test
var: test 
```

Perl 中允许嵌套命名子例程，但这几乎可以肯定是代码执行错误的标志。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-11-26T00:40:29.403

在 perl 中创建嵌套子例程的“官方”方法是使用`local`关键字。例如：

```
sub a {
    local *b = sub {
        return 123;
    };
    return b();  # Works as expected
}

b();  # Error: "Undefined subroutine &main::b called at ..." 
```

perldoc 页面[perlref](http://perldoc.perl.org/perlref.html#Function-Templates)有这个例子：

```
sub outer {
    my $x = $_[0] + 35;
    local *inner = sub { return $x * 19 };
    return $x + inner();
} 
```

“这具有创建另一个函数的本地函数的有趣效果，Perl 通常不支持这种功能。”

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-04-17T15:58:09.980

以下打印`123`。

```
sub a {
    $b = 123;
}

a();
print $b, "\n"; 
```

那么你为什么对以下内容感到惊讶呢？

```
sub a {
    sub b { return 123; }
}

a();
print b(), "\n"; 
```

任何地方都没有任何要求`$b`或`&b`成为词汇的要求。事实上，你不能要求`&b`是词汇（还）。

```
sub b { ... } 
```

基本上是

```
BEGIN { *b = sub { ... }; } 
```

, , ...`*b`的符号表条目在哪里，当然还有。这意味着 subs 属于包，因此可以从包内的任何地方调用，或者如果使用了它们的完全限定名（），则可以在任何地方调用。`$b``@b``&b``MyPackage::b()`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-17T13:43:22.493

子程序是在编译时定义的，不受作用域的影响。换句话说，它们不能真正嵌套。至少就他们自己的范围而言不是。在被定义之后，它们被有效地从源代码中删除。

# c# - TFS、源代码、SharePoint

> ID：10192229
> 
> 赞同：1
> 
> 时间：2012-04-17T13:29:51.697
> 
> 标签：c#, visual-studio-2010, sharepoint, sharepoint-2010

如何将我的 Sharepoint 项目作为源代码添加到 TFS 中？我的主机中有原始目录，并将其作为主机和 VM 之间的共享文件夹。

当我尝试调试 Sharepoint 项目（在 VM 上）并部署我的更改，然后附加 w3wp 进程并启动网页时，会出现“服务不可用”消息。

如何在项目上部署我的更改并将我的项目作为源代码工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T17:33:31.060

您遇到的问题与 TFS 或源代码管理没有直接关系。为了将您的项目添加到源代码管理，您只需打开它并选择“添加到源代码管理”。我建议从您的主机上执行此操作。

为了顺利运行，您应该首先在 TFS 中创建适当的工作区映射，并将您的项目放在 TFS 工作区中。请检查此以获取更多信息：

[http://msdn.microsoft.com/en-us/library/cc138514(v=vs.90).aspx](http://msdn.microsoft.com/en-us/library/cc138514(v=vs.90).aspx)

您可能应该将问题的“服务不可用”部分发布到 Sharepoint 论坛，因为它与源代码控制无关。

# sql - 编辑数据源 Sql Select 语句以获取文本框输入

> ID：10192232
> 
> 赞同：0
> 
> 时间：2012-04-17T13:30:01.293
> 
> 标签：sql, select, gridview, datasource

我正在尝试使用 WHERE 子句创建一个可编辑并允许删除的网格视图，该子句在单击按钮时从文本框中获取其输入。

我知道如何在考虑文本框结果的情况下获取 select 语句并可以生成字符串，但是有没有办法可以更新数据源 select 语句？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T14:19:21.500

是的，让数据配置工具来完成这项工作。你想进入这个屏幕：

![在此处输入图像描述](../Images/0fbe3946efae3535524eabbff43a0f96.png)

呈现的 Update 语句和参数如下所示：

```
UpdateCommand="UPDATE [TestTable] SET [CustomerName] = @CustomerName, [Status] = @Status, [phone] = @phone, [CustomerDate] = @CustomerDate WHERE [ID] = @ID">

<UpdateParameters>
    <asp:Parameter Name="CustomerName" Type="String" />
    <asp:Parameter Name="Status" Type="Int16" />
    <asp:Parameter Name="phone" Type="String" />
    <asp:Parameter Name="CustomerDate" Type="DateTime" />
    <asp:Parameter Name="ID" Type="Int32" />
</UpdateParameters> 
```

# jquery - jquery选择属性存在和元素的子元素

> ID：10192233
> 
> 赞同：1
> 
> 时间：2012-04-17T13:30:04.240
> 
> 标签：jquery

我的任务是测试元素的一个或多个子元素是否具有给定属性，如果标记是

```
<div>
   <div attributename="xyz" />
</div> 
```

那么测试是真的但是如果标记是

```
<div>
   <div>
      <div attributename="xyz" />
   </div>
</div> 
```

那么结果应该是错误的。

到目前为止，我已经到了

```
$(":[attributename]",context); 
```

但这两种情况都会返回 true

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T13:32:38.817

用这个...

```
$(context).children(":[attributename]"); 
```

* * *

当你这样做...

```
$(":[attributename]",context) 
```

......这只是一种迂回的方式......

```
$(context).find(":[attributename]") 
```

...这更清楚地显示了正在发生的事情。您正在搜索所有后代。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T13:32:51.860

您是指`>`仅选择直接后代元素的选择器吗？

```
$("> div[attributename=xyz]",context); 
```

**请阅读此答案下方的评论！**

# ios - 更改在 Facebook 帖子上获取 [应用名称] 文本

> ID：10192235
> 
> 赞同：1
> 
> 时间：2012-04-17T13:30:11.767
> 
> 标签：ios, facebook, facebook-graph-api, ios5, sharekit

我已经使用 ShareKit 2.0 集成了 FB 共享，并且可以从我的应用程序中共享链接。但是我需要知道修改“获取 [应用程序名称]”和域 eg.www.apple.com 文本显示在帖子标题之后的可能性。我能改变这些吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T23:32:10.093

是的，在您的 CustomSHKConfigurator.m 中覆盖以下两种方法：

```
- (NSString*)appName {
    return @"";
}

- (NSString*)appURL {
    return @"";
} 
```

# c# - Assert.IsNotNull(...) - VS 2010 我需要添加哪个参考？

> ID：10192236
> 
> 赞同：1
> 
> 时间：2012-04-17T13:30:16.203
> 
> 标签：c#, reference, assert

我不确定这是错误还是我的安装完全缺少 DLL。我需要在 C# 中使用 ASSERT，所以我需要添加参考`Microsoft.VisualStudio.TestTools.UnitTesting;`

但是缺少引用的 DLL。我指向 VS 2010 中的错误 DLL？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T13:32:32.767

没有`Microsoft.VisualStudio.TestTools.UnitTesting.dll`。该类型的*命名空间*是`Microsoft.VisualStudio.TestTools.UnitTesting`，但定义该类型的程序集具有不同的名称。

从[文档](http://msdn.microsoft.com/en-us/library/ms243773%28v=vs.80%29.aspx)中，程序集的名称是“Microsoft.VisualStudio.QualityTools.UnitTestFramework”；它的 DLL 是`microsoft.visualstudio.qualitytools.unittestframework.dll`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T13:32:46.230

为了使用`Debug.Assert`，您需要参考`System.Diagnostics`。

您的意思是在课程中使用常规 Assert，对吧，还是您的意思是单元测试 Assert？`microsoft.visualstudio.qualitytools.unittestframework.dll`如果您使用 MsTest 而不是其他框架（例如 NUnit），则后者需要引用.

# c# - 将对象绑定到 wpf 的控件中

> ID：10192237
> 
> 赞同：2
> 
> 时间：2012-04-17T13:30:20.003
> 
> 标签：c#, wpf

我是 WPF 的新手，我想快速了解如何将此对象绑定到 wpf 控件，但我不知道应该使用哪个控件：

```
public class Parent
{
  public string Name{get; set;}
  public List<Child> Childs {get; set;}
}

public class Child
{
  public string Name{get; set;}
  public int Age {get; set;}
}

public class ParentFactory
{
   public List<Parent> Parents {get; set;}

   public ParentFactory()
   {
      Child child1 = new Child() {Name="Peter", Age=10;};
      Child child2 = new Child() {Name="Mary", Age=9;};
      Child child3 = new Child() {Name="Becky", Age=12;};

      Parent parent1 = new Parent(){Name="Adam", Childs = new List<Child<>(){child1, child2}};
      Parent parent2 = new Parent(){Name="Kevin", Childs = new List<Child<>(){child3}};

      Parents = new List<Parent>(){parent1, parent2};
   }
} 
```

创建此实例后：

ParentFactory parentFactory = new ParentFactory();

我想将 parentFactory.Parents() 绑定到 WPF 中的控件。我希望看到这样的东西：

* * *

亚当

——彼得，10 岁

——玛丽，9 岁

凯文

——贝基，12 岁

* * *

它们都显示在文本框中，我可以更改它们。

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T13:40:30.757

使用带有 HierarchicalDataTemplate 的 TreeView。

但是请注意，如果没有在您的模型上实现 INotifyPropertyChanged，您的绑定将不会在任何属性更改时更新。此外，如果不使用 ObservableCollections 替换您的列表，您的视图将不会随着您向列表中添加更多项目而更新。

像这样的东西应该可以工作，首先定义你的模板：

```
<Window.Resources>
    <HierarchicalDataTemplate DataType="{x:Type local:Parent}" ItemsSource="{Binding Childs}">
        <TextBlock Text="{Binding Name}"/>
    </HierarchicalDataTemplate>
    <DataTemplate DataType="{x:Type local:Child}">
        <StackPanel Orientation="Horizontal">
            <TextBlock Text="{Binding Name}"/>
            <TextBlock>, </TextBlock>
            <TextBlock Text="{Binding Age}"/>
        </StackPanel>
    </DataTemplate>
</Window.Resources> 
```

然后您可以将它们与这样的 TreeView 一起使用（假设 Parents 是 TreeView 的 DataContext 中的一个属性）：

```
<TreeView ItemsSource="{Binding Parents}"/> 
```

如果您不想要 TreeView，您可以轻松地使用 ListView 列出此内容，将 DataTemplates 更改为：

```
 <DataTemplate DataType="{x:Type local:Parent}">
        <StackPanel>
            <TextBlock Text="{Binding Name}"/>
            <ListView ItemsSource="{Binding Childs}"/>
        </StackPanel>
    </DataTemplate>
    <DataTemplate DataType="{x:Type local:Child}">
        <StackPanel Orientation="Horizontal">
            <TextBlock Text="{Binding Name}"/>
            <TextBlock>, </TextBlock>
            <TextBlock Text="{Binding Age}"/>
        </StackPanel>
    </DataTemplate> 
```

然后你可以像这样绑定它：

```
<ListView ItemsSource="{Binding Parents}"/> 
```

注意：您可能想要稍微摆弄一下样式，因为开箱即用，这看起来有点垃圾。至少，您可能希望缩进子 ListView（在父 DataTemplate 中定义的那个）并去掉它的边框。

另请注意：为名称和年龄布局多个 TextBlock 的 StackPanel 也不理想，但它又快又脏。你可能想以不同的方式处理它。您可以使用（多）转换器对其进行格式化，使用 StringFormat 或将另一个属性添加到您的模型中以供显示，甚至只是覆盖子类上的 ToString。

**另一个编辑**

使用 DataGrid 的一个快速（且丑陋）的示例：

```
<DataGrid ItemsSource="{Binding Parents}" AutoGenerateColumns="False">
    <DataGrid.RowDetailsTemplate>
        <DataTemplate>
            <DataGrid ItemsSource="{Binding Childs}"/>
        </DataTemplate>
    </DataGrid.RowDetailsTemplate>
    <DataGrid.Columns>
        <DataGridTextColumn Binding="{Binding Name}"/>
    </DataGrid.Columns>
</DataGrid> 
```

这使用行详细信息模板将数据网格放置在数据网格内。如果单击一行，它会将子项显示为行详细信息。如果您希望详细信息始终可用，您可以删除 RowDetailsTemplate 并将 DataGridTextColumn 替换为 DataGridTemplateColumn，然后为您的数据定义一个模板。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-17T14:10:36.677

如果您不希望树视图（这可能是最好的，因为您有一个层次结构 - 尽管它只有一层深度，所以您可能仍然需要一个列表）......
你可以做这样的事情（这是一个粗略的轮廓，你应该填写点）......

```
<ItemsControl ItemsSource="{Binding AllNodes}">
</ItemsControl> 
```

...并为每种类型专门定义了模板，就像马特提到的...

```
<DataTemplate DataType="{x:Type namespace:Child}">
...
</DataTemplate>

<DataTemplate DataType="{x:Type namespace:Parent}">
...
</DataTemplate> 
```

...虽然这`AllNodes`是您需要`flatten`从您拥有的层次结构中获取的列表，但您可以使用它...

```
var allnodes = Parents.SelectMany(p => new object[]{p}.Concat(p.Childs)); 
```

...并将 AllNodes 公开为类似于父母的属性 - 您只需要一个视图模型，并按照建议正确实施 INotifyPropertyChanged。

希望这可以帮助

# prolog - 如何将此规则的所有结果作为事实输入程序中，或者我如何将这些结果作为事实处理？

> ID：10192239
> 
> 赞同：0
> 
> 时间：2012-04-17T13:30:38.403
> 
> 标签：prolog, prolog-assert

```
%Examples
%course_meetings(maths4,tutorial,t07,khaled_mohamed,'tutorial for t07')
%days([sat,sun...])
%tutorialrooms([c6301,b4108,c2201,c2301,c2202,c2203])
%slots([1,2,3,4,5])

day_tut(Day,Slot,Place,Course,Group,Instr,Descr):-
    days(X),member(Day,X),
    tutorialrooms(X1),member(Place,X1),
    course_meetings(Course,tutorial,Group,Instr,Descr),
    slots(X2),member(Slot,X2). 
```

我想过使用 Assert 但我是新来的 prolog 不确定它是如何工作的想法是最终我想根据某些规则为所有组创建一个时间表例如每个组应该休息一天并且讲座应该先于教程.. .

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T19:10:54.870

我的建议来自 SWI-Prolog。

您可以使用 assert/1 将数据插入动态数据库；您可以使用 out/1 将元组放在 Linda 表上，或者使用更高级的功能，例如 db_assert。

然而，问题不是如何记录这些数据，而是为什么要这样做。根据您打算如何解决调度问题，您可能需要这种或那种记录策略，或者甚至不需要。

# spring - 如何将 jdbc.properties 传递给 Spring/Hibernate？

> ID：10192241
> 
> 赞同：6
> 
> 时间：2012-04-17T13:30:58.007
> 
> 标签：spring, hibernate

尝试将属性文件中的值传递给 Spring 时出现以下错误，因此我不必直接在***hibernate.cfg.xml***中提供它们。有没有更好（和正确）的方法？我知道正在引用属性文件，因为如果我输入无效密码，它就会失败。我会很感激任何帮助。

```
WARNING: No connection properties specified - the user must supply JDBC connections
Exception in thread "main" org.hibernate.HibernateException: Hibernate Dialect must be explicitly set
    at org.hibernate.dialect.DialectFactory.determineDialect(DialectFactory.java:57)
    at org.hibernate.dialect.DialectFactory.buildDialect(DialectFactory.java:39)
    at org.hibernate.cfg.SettingsFactory.determineDialect(SettingsFactory.java:426) 
```

这是 applicationContext.xml：

```
 <context:component-scan base-package="cmsutil"/>
    <context:property-placeholder location="jdbc.properties"/>

    <bean id="dataSource"
          class="org.springframework.jdbc.datasource.DriverManagerDataSource"
          p:driverClassName="${jdbc.driverClassName}"
          p:url="${jdbc.url}"
          p:username="${jdbc.username}"
          p:password="${jdbc.password}"/>

    <bean id="sessionFactory"
          class="org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean"
          p:dataSource-ref="dataSource"
          p:configurationClass="org.hibernate.cfg.AnnotationConfiguration"
          p:packagesToScan="cmsutil.*">

        <property name="exposeTransactionAwareSessionFactory" value="false" />

        <property name="hibernateProperties">
            <props>
                <prop key="hibernate.dialect">${hibernate.dialect}</prop>
                <prop key="hibernate.show_sql">${hibernate.show_sql}</prop>
                <prop key="hibernate.format_sql">${hibernate.format_sql}</prop>
                <prop key="hibernate.generate_statistics">${hibernate.generate_statistics}</prop>
            </props>
        </property>

    </bean>

    <bean id="txnManager"
          class="org.springframework.orm.hibernate3.HibernateTransactionManager"
          p:sessionFactory-ref="sessionFactory"/>

    <bean class="org.springframework.dao.annotation.PersistenceExceptionTranslationPostProcessor"/> 
```

这是我的 hibernate.cfg.xml 文件：

```
<hibernate-configuration>
  <session-factory>
    <property name="hibernate.dialect">org.hibernate.dialect.MySQLDialect</property>
    <mapping resource="cmsutil.entity/contentcomponent.hbm.xml"/>
  </session-factory>
</hibernate-configuration> 
```

根据 Ramesh 的要求 - web.xml

```
<web-app version="3.0" xmlns="http://java.sun.com/xml/ns/javaee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd">
    <context-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>/WEB-INF/applicationContext.xml</param-value>
    </context-param>
    <listener>
        <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
    </listener>
    <servlet>
        <servlet-name>dispatcher</servlet-name>
        <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
        <load-on-startup>2</load-on-startup>
    </servlet>
    <servlet-mapping>
        <servlet-name>dispatcher</servlet-name>
        <url-pattern>*.htm</url-pattern>
    </servlet-mapping>
    <session-config>
        <session-timeout>
            30
        </session-timeout>
    </session-config>
    <welcome-file-list>
        <welcome-file>redirect.jsp</welcome-file>
    </welcome-file-list>
</web-app> 
```

对于 Ramesh，这是我的 jdbc.properties，位于根目录 (/src/java/jdbc.properties)

```
jdbc.driverClassName=com.mysql.jdbc.Driver
jdbc.url=jdbc:mysql://xx:3306/x
jdbc.username=y
jdbc.password=z

hibernate.dialect=org.hibernate.dialect.MySQLDialect
hibernate.show_sql=true
hibernate.format_sql=false
hibernate.generate_statistics=false 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-17T13:45:11.640

将此 bean 添加到您的`applicationContext.xml`

```
<bean id="propertyConfigurer" class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
        <property name="location"><value>classpath:jdbc.properties</value></property>
    </bean> 
```

在 web.xml 而不是监听器中更新它

```
<servlet>
    <servlet-name>context</servlet-name>
    <servlet-class>
         org.springframework.web.context.ContextLoaderServlet
      </servlet-class>
    <load-on-startup>1</load-on-startup>
  </servlet> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T15:31:05.140

我有同样的问题，但这是我的 java 代码出错的结果。它需要[`configure()`](http://docs.jboss.org/hibernate/orm/3.5/api/org/hibernate/cfg/Configuration.html#configure%28%29)在`Configuration`调用之前调用`buildSessionFactory()`。

方法的javadoc `configure()`：

> 使用名为 hibernate.cfg.xml 的应用程序资源中指定的映射和属性。

**破代码：**

```
public static void main(String[] args) {
        Configuration cfg = new Configuration();

        factory = cfg.buildSessionFactory(); // missing the configure() call

        Session s = factory.openSession();
        Transaction tx = null;
        try {
            tx = s.beginTransaction(); 
```

**解决方案：**

```
public static void main(String[] args) {
        Configuration cfg = new Configuration();

        factory = cfg.configure().buildSessionFactory();

        Session s = factory.openSession();
        Transaction tx = null;
        try {
            tx = s.beginTransaction(); 
```

注意：我没有使用 Spring 配置。

# zend-framework - 使用 Zend 框架在一个表单中上传多个具有相同文件名的文件

> ID：10192246
> 
> 赞同：0
> 
> 时间：2012-04-17T13:31:20.143
> 
> 标签：zend-framework, file-upload

我有一个表单，用户可以上传 2 张图片。所以，我调用了这段代码两次，每张图片一个：

```
$upload = new Zend_File_Transfer_Adapter_Http();
$upload->addValidator('Count', true, array(1, 1))
    ->addValidator('Size', false, self::MAX_FILE_SIZE)
    ->addValidator('ImageSize', false, array('minwidth' => $minWidth))
    ->addValidator('MimeType', true, 
        array('image/gif', 'image/jpeg', 'image/png'))
    ->setDestination(Divescover_AssetManager::getUploadDir());

// We pass filename as parameter to receive so it can manage
// multiple files
if (!$upload->receive($filename)) {
    return array('pic' => $upload->getMessages());
} 
```

但是当用户在两个“图片选择器”中上传同一张图片时，我会收到此错误：-

> 文件“picture_main”被非法上传。这可能是一次可能的攻击。

我知道这是**因为这两个文件具有相同的名称**。我尝试使用重命名过滤器重命名文件，但没有成功。

我想解决这个问题，但我确实需要同时获取两张图片，即使它们是相同的。

# android - Android 3.x 和 4.x 中的 java.lang.IllegalStateException ；在 2.x 上运行良好

> ID：10192248
> 
> 赞同：7
> 
> 时间：2012-04-17T13:31:33.460
> 
> 标签：android, illegalstateexception

我正在使用`TabActivity`其中包含四个选项卡。对于我正在使用的每个选项卡`ActivityGroup`，`ActivityGroup`我有几个活动。在我的一个中，我`Activity`有一张谷歌地图。每当我单击 Google Map 中的内置后退按钮时，`Activity`我都会收到以下异常。

> android java.lang.illegalstateexception onsaveinstancestate 后无法执行此动作。

我在 3.x 和 4.x Android 版本中遇到了上述异常。但在 2.x 中它工作正常，没有任何异常。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T03:31:37.627

请发布您的代码。否则，没有讨论的意义。

据我所知，您可能会传递错误的参数或两次使用相同的 API。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T15:25:17.377

您是否在此活动的代码中的任何位置使用 startmanaging 光标。这适用于 2.3 操作系统，但 3.0 及更高版本会引发错误。我也遇到了同样的情况，解决的方法是只在 2.3 以下操作系统中添加启动管理光标。

# c# - ASP.NET JavaScript 弹出窗口无法获取属性

> ID：10192254
> 
> 赞同：0
> 
> 时间：2012-04-17T13:31:55.153
> 
> 标签：c#, javascript, asp.net

在我的 ASP.NET 应用程序中，我的弹出窗口为特定变量返回 null。
当我单击一个按钮时，此 JavaScript 被触发：

```
function Picker_OrderDefaultFirst() {
    OpenPageWithParam('OrderPermanentItems', '?ID=' + "<%=CommitteeUId %>" + "&btn=1", returnOrderPicker);
    return false;
} 
```

`returnOrderPicker`好像：

```
function returnOrderPicker() {
    alert("Test fra returnOrderPicker");
} 
```

`OpenPageWithParam`好像：

```
function OpenPageWithParam(PageName, Query, ReturnFunction) {
    var _window = null;

    InitBlocker();

    switch (PageName) {

        case "OrderPermanentItems":
            _window = PopupCenter(ROOT_DIR + "/Forms/Pickers/PermanentItemsPicker.aspx" + Query, PageName, 590, 600);
            break;
    }

    _window.ReturnFunction = ReturnFunction;

    return _window;
} 
```

我将弹出窗口的属性设置`ReturnFunction`为`ReturnFunction`上一页的数据。（在此示例中为`returnOrderPicker`函数）。

但是，当窗口弹出时， 的`window.ReturnValue`值为`undefined`。

在弹出窗口中调用如下所示：

```
<script type="text/javascript" language="javascript">
    window.onload = function (sender, eventArgs) { alert(window.ReturnFunction + " Window PermanentItemPickerPopup "); }
</script> 
```

有任何想法吗？

# ruby-on-rails-3 - rails-3 cron 作业不适用于 rails runner

> ID：10192257
> 
> 赞同：0
> 
> 时间：2012-04-17T13:32:02.610
> 
> 标签：ruby-on-rails-3, crontab, cron-task, runner

最近我遇到了以下不使用任何 Gem 运行 cron 作业的教程
[http://www.ameravant.com/posts/recurring-tasks-in-ruby-on-rails-using-runner-and-cron-jobs](http://www.ameravant.com/posts/recurring-tasks-in-ruby-on-rails-using-runner-and-cron-jobs)

我在 /app/delete_old_posts.rb 中创建一个文件

```
 class DeleteOldPosts < ActiveRecord::Base          
    # This script deletes all posts that are over 5 minutes old          
     post_ids = Post.find(:all, :conditions => ["created_at < ?", 5.minutes.ago])          
     if post_ids.size > 0     
      Post.destroy(post_ids)     
      puts "#{post_ids.size} posts have been deleted!"       
     end 
```

然后通过给出 crontab -e 命令并在我写的 cronjob 控制台中创建 cron 作业

```
*/2 * * * * /usr/bin/env ruby /home/abc/xyz/urjit.rajgor/workspace/thewall/rails/runner/home/XYZ/ABC/urjit.rajgor/workspace/thewall/app/delete_old_posts.rb 
```

cron 作业每两分钟运行一次，但它不起作用
请帮助我。
谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T16:35:41.867

尝试使用“无论何时”宝石。允许您在 ruby​​ 中定义您的 cronjobs，能够指定 rails runner、rake 或其他自定义包装器，它会为您处理编写 crontab。让生活变得更简单。

只需添加：`gem 'whenever', :require => false`到您的 gemfile

[https://github.com/javan/无论何时](https://github.com/javan/whenever)

[http://railscasts.com/episodes/164-cron-in-ruby](http://railscasts.com/episodes/164-cron-in-ruby)

# c# - C# - 将 XML 反序列化为给定完整类名的对象

> ID：10192258
> 
> 赞同：0
> 
> 时间：2012-04-17T13:32:11.877
> 
> 标签：c#, .net, serialization, xml-serialization

鉴于我有类的全名（作为字符串）和 XML（作为字符串），将 XML 反序列化为类的实例的正确方法是什么？需要注意的是，我在一个程序集中进行这项工作，而我想要反序列化的业务对象在另一个引用的程序集中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T13:43:15.270

```
 using (StringReader strreader = new StringReader("xml of the object"))
        {
            using (XmlReader xmlreader = XmlReader.Create(strreader))
            {
                dynamic result = new XmlSerializer(Type.GetType("your type")).ReadObject(xmlreader);
            }
        } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T03:15:42.597

```
/// <summary>
/// Deserialize string XML to the object of type T.
/// </summary>
/// <typeparam name="T">The type of the object where the xmlText are deserialized.</typeparam>
/// <param name="xmlText">The xml string to be deserialized to the object of type T.</param>
public static T DeserializeXMLToObject<T>(string xmlText)
{
    if (string.IsNullOrEmpty(xmlText)) return default(T);
    XmlSerializer xs = new XmlSerializer(typeof(T));
    using (MemoryStream memoryStream = new MemoryStream(new UnicodeEncoding().GetBytes(xmlText)))
    using (XmlTextReader xsText = new XmlTextReader(memoryStream))
    {
        xsText.Normalization = true;
        return (T)xs.Deserialize(xsText);
    }
} 
```

您需要要反序列化的 XML 类型。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T13:38:59.540

您不需要知道类名，而是需要对类类型的引用。

然后你可以像这样反序列化 XML：

```
StringReader read = new StringReader(xmlOfAnObject);
XmlSerializer serializer = new XmlSerializer(myObject.GetType());
XmlReader reader = new XmlTextReader(read);

WhateverTheType myObject = (WhateverTheType) serializer.Deserialize(reader);

reader.Close();
read.Close();
read.Dispose(); 
```

# jquery - 使用 jQuery 为 Rolodex 翻转效果制作动画

> ID：10192260
> 
> 赞同：5
> 
> 时间：2012-04-17T13:32:16.173
> 
> 标签：jquery, animation, jquery-animate, setinterval, css-transitions

所以我建立了一个非常小的老式rolodex风格时钟的演示。图形来自免费赠品 PSD，我使用 setInterval() 构建了时钟功能。您可以[在此处查看现场演示](http://byjakewithlove.com/code/rolodex/)。

我要做的是为数字的变化设置动画，以便顶部“翻转”以显示新数字。我绝对不知道该怎么做——我可以使用 bg 图像，但我觉得直接 HTML 中的数字对用户更友好。有人可以为此指出正确的方向吗？我希望能得到任何帮助......我还在下面提供了一张预览图片，以便您了解我正在构建的内容。

我也愿意尝试 CSS3 解决方案，但到目前为止我还没有找到比 jQuery 更好的解决方案。

![jquery 时钟预览](../Images/7c3c8a6a509d1fb8f1a10c43117b4b4e.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T01:36:41.240

我承认这只是答案的一半；它展示了如何使用 CSS/JQuery 动画滚动效果。

```
<html>
<head>
<script type="text/javascript" src="jquery.min.js"></script>
<script type="text/javascript" src="transformjs.1.0.beta.2.min.js"></script>
<style>
body {font-size:128px;}
</style>
<script>
$(function(){  //OnInit

$('.anim').click(function() {
  $(this).animate({    rotateX: '-='+(Math.PI/2),  },500,"",
    function(){ //OnComplete
    var n=(parseInt($(this).html())+1)%10;  //Turn 7 into 8, etc.
    $(this).html(n.toString());    //Update number while it is hidden
    $(this).animate({    rotateX: '+='+(Math.PI/2)  },500); //Rotate it back
    }
  );    
});  

});
</script>
</head>
<body>

<div class="anim" style="float:left">1</div><div class="anim" style="float:left">2</div><div class="anim" style="float:left">3</div>
</body>
</html> 
```

它需要 JQuery 1.5.1+ 和[transformjs 库](http://transformjs.strobeapp.com/)，可以在[这里下载](http://www.github.com/sproutcore/transformjs/downloads)。单击每个数字以旋转它。在 Firefox 11 和 Chromium 17 中测试；transform.js 应该可以在旧版浏览器和 IE 中使用。

顺便说一句，说到跨浏览器挑战，我最初在`<span>`s 上有三个数字。这适用于 Firefox，但 Chrome 不会为它们设置动画！`<div>`因此，对s的更改为`float:left`。

就像我说的，这只是解决方案的一半，因为它看起来还不太像翻牌。我认为这可以通过一些掩蔽来完成，并在数字之上创建一个临时 div（真正的 div 将有下一个数字；前一个数字将在那个临时 div 的顶部）。但在我没时间之前，我无法让它工作。

不过，我仍然认为值得发布；尝试在动画中的 rotateX 旁边添加一个 rotateY 和 rotateZ，以获得一些真正的 kewl 效果。

# java - 引用未定义的属性时如何使 JSTL 出错

> ID：10192263
> 
> 赞同：1
> 
> 时间：2012-04-17T13:32:30.470
> 
> 标签：java, jsp, jstl

在 jsp 页面中，我希望 JSTL 在引用未定义的变量时表现得严格。

例子：

## servlet 通过：

```
request.setAttribute("firstName", "hello");
request.setAttribute("lastName", "there"); 
```

## jsp页面：

```
${firstName} ${middleName} ${lastName} 
```

我希望 JSTL 给我一个错误，即 middleName 未定义，而不是默默地忽略它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T13:39:52.877

```
<c:if test="${empty middleName}">
  <c:out value="Middle name is empty"/>
</c:if> 
```

或者

```
<c:choose>
  <c:when test="${empty middleName}">
    <c:out value="Middle name is empty"/>
  </c:when>
  <c:otherwise>
    <c:out value="Middle name is NOT empty"/>
  </c:otherwise>
</c:choose> 
```

# android - 在 ListView 中显示标题

> ID：10192268
> 
> 赞同：-1
> 
> 时间：2012-04-17T13:32:43.037
> 
> 标签：android, listview

我正在使用在 ListView 中实现的数据库。
我想分割 ListView 并添加标题（分隔符）。我的意思是，我有很多城市，我想用分隔符按国家对它们进行分组。
这是我认为与标题有关的类：

```
String[] adobe_products = getResources().getStringArray(R.array.adobe_products);

        mAdapter = new ArrayAdapter<String>(this, R.layout.list_item, R.id.label, adobe_products);
        // Binding Array to ListAdapter
        this.setListAdapter(new ArrayAdapter<String>(this, R.layout.list_item, R.id.label, adobe_products));

        ListView lv = getListView();

        // listening to single list item on click
        lv.setOnItemClickListener(new OnItemClickListener() {
          public void onItemClick(AdapterView<?> parent, View view,
              int position, long id) {

            /*  // selected item 
              String product = ((TextView) view).getText().toString();

              // Launching new Activity on selecting single List Item
              Intent i = new Intent(getApplicationContext(), SingleListItem.class);
              // sending data to new activity
              i.putExtra("product", product);
              startActivity(i);*/ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T14:25:13.903

分隔符基本上只是一个自定义列表项。您需要覆盖适配器以返回您希望标题所在的禁用列表项。

对于您的实例，您可以在字符串数组中的正确位置添加分隔符，并对自定义适配器进行以下调整：

*   覆盖 getViewTypeCount() 以返回 2，用于分隔符和列表项
*   覆盖 getItemViewType() 为常规列表项返回 0，为分隔符返回 1
*   覆盖 getView() 并让它正确地创建正确的行并绑定它们。
*   覆盖 areAllItemsEnabled() 并返回 false。
*   覆盖 isEnabled() 并且如果位置是分隔符，则返回 false。

然后一种方法是创建一个仅包含标题项的单独列表，然后创建一个这样的方法来检查上述所有方法的项类型。

```
public Boolean isSeparator(int position) {
    if (separatorList.contains(getItem(position)) {
        return true;
    } else {
        return false;
    }
} 
```

# ruby-on-rails - 如何制作 :render => 没有任何效果

> ID：10192275
> 
> 赞同：6
> 
> 时间：2012-04-17T13:33:20.670
> 
> 标签：ruby-on-rails

我有一个加载窗口的 jquery AJAX 调用。在窗口中，有一个带有提交的表单，允许用户下载项目。**我必须使第二个表单使用常规提交，以便我可以提示下载。**
我的问题是当没有要下载的文件时，它会重定向到该文件所在的页面。
我正在尝试许多不同的风格让它什么都不渲染，但它们似乎都不起作用。

```
unless params[:controller] == "reports"
  unless @jobs.present?
   flash.now[:error] = "No work orders for this selection."
   render :nothing => true
 end
end 
```

还

```
respond_to do |format|
   format.html { render :nothing => true }
end 
```

似乎没有任何效果。有任何想法吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2014-12-21T12:06:14.523

不要使用`render: nothing.`这将“失败”ajax 请求。相反，使用：

```
render json: nil, status: :ok 
```

# ajax - ajax ci 制定 post var 值到另一个视图？

> ID：10192278
> 
> 赞同：0
> 
> 时间：2012-04-17T13:33:41.533
> 
> 标签：ajax, codeigniter, jquery-mobile

我正在尝试编写一个 ajax POST 以将一个值从一个 ci 视图发送到另一个。我在那里找到了很多关于此的帖子，但仍然无法正确处理，可能主要是因为它们展示了如何从表单控件发送数据，而我想从变量发送数据。在这个视图（编辑）上，我正在捕获当前 url，我想在点击 jqm 基本列表项时将其发送到下一个视图（图库）。

列表（在控制器上）：

```
$control .= '<ul data-role="listview" data-inset="true" class="toGallery">';
$control .= '<li >';
$control .= '<a href="'. site_url() .'/mobilegallery/gallery/'.$x[0]->attributes()->indexI.'">[imgname.png]</a>';
$control .= '</li>';
$control .= '</ul>'; 
```

jQuery（正在查看）：

```
$(document).bind('pageinit',function(event){
    var href = $(location).attr('href');

    $(".toGallery").live('tap',function(){

        $.ajax({
            type: "POST",
            url: "/mobilegallery/gallery",
            data: $('href').val(),
            success: function(data){
                var beforeUrl = href;
                alert(beforeUrl);
            }
        });

    });
}); 
```

在图库页面上，我想将 url 设为变量以供以后使用。我是像上面那样成功创建该变量，还是在图库页面上获得该值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T14:48:12.477

如果你想保留你的`url`变量以供以后使用（意味着后续的页面请求），你可以简单地将它作为自定义会话数据存储在你的控制器中：

```
// $your_url would be the URL sent from the view via the AJAX request
$this->session->set_userdata('your_url', $your_url); 
```

现在它可以在这样的任何视图中使用：

```
<?php echo $this->session->userdata('your_url'); ?> 
```

# php - 开发从 gmaps 扩展的嵌入式 js/maps 库

> ID：10192279
> 
> 赞同：1
> 
> 时间：2012-04-17T13:33:43.967
> 
> 标签：php, api, codeigniter

我目前有一个网络应用程序，它使用谷歌地图 API、PHP 和 MySQL 在地图上填充自定义地图气泡和标记。

目前，该应用程序由我们托管并由我们管理，并作为 iframe 包含在客户页面上，但这很烦人..

我想开发一个可以包含在页面上的 API/库，然后将代码注入到 div 容器中（就像谷歌地图一样）。**但是，我不知道要搜索什么或阅读什么来学习。**

我有一个基本的 rest api，它被配置为向授权客户端提供 json/jsonp 格式的只读功能。我正在为 CI 使用 Phil Sturgeon 的 REST-SERVER 库。

这是当前格式的链接，我们将此页面拉到没有滚动条的 iframe 中。 [http://fhaz.mapitusa.com](http://fhaz.mapitusa.com)

**更新：我找到了部分解决方案.. 网络小部件**：[http ://alexmarandon.com/articles/web_widget_jquery/](http://alexmarandon.com/articles/web_widget_jquery/)

我需要开发一个网络小部件。

**我需要知道：**

1.  学什么
2.  要了解哪些类型的编程方法
3.  寻找什么例子
4.  有哪些选择可以摆脱 iframe 并使用一种“硬嵌入”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T14:01:04.280

你没有大声说出来，但是因为你特别提到你现在有一个只读 api 我想你也想向（你的）服务器发送命令。我将从研究身份验证方法开始。为此，我会选择 OAuth。您必须编写一个基本的客户端类，它可以将客户端连接到服务器并对其进行身份验证。这可以非常简单和小。PHP 甚至有一个 pecl 扩展可用（参见[http://nl.php.net/manual/en/book.oauth.php](http://nl.php.net/manual/en/book.oauth.php)），它非常易于使用。如果您没有安装 pecl 扩展的可能性，curl 也可以解决问题，即使这样也不是必需的。Twitter 还对 OAuth 的工作原理进行了很好的解释，并提供了指向外部资源的链接。看看这个！[https://dev.twitter.com/docs/auth/oauth](https://dev.twitter.com/docs/auth/oauth)

请注意，在服务器级别，您必须实现自己的角色系统，oauth 只允许您的客户端以安全的方式连接到服务器。IE。它将让您的“用户”登录到您的应用程序，但不会检查登录用户是否（例如给出的示例）是具有所有权限的管理员用户、只读用户或中间的用户。

如果您已经理顺了 OAuth，只需编写一个您想要实现的 API 调用列表。您应该命名它们，例如：

```
/map/marker/get
/map/marker/set
/map/bubble/get
... 
```

您的客户端 API 应该能够进行如下调用：

```
$api = new MyGreatApi();
$params = array('id' => 3, 'color' => 'red', ...);
$response = $api->call('/map/marker/get', $params);
echo $response; 
```

查看一些 oauth 库实现，例如 Twitter 推广的那个 (https://dev.twitter.com/docs/twitter-libraries#php)，或者例如运行时使用的非常简单的一位 (http://developer. longtailvideo.com/botr/downloads/php-api-kit.zip)

在服务器级别，您捕获 api 调用并将请求路由到特定控制器（使用一些 MVC 术语）。例如，如果你获取调用'/map/marker/get'，你可以`explode('/', $call);`搜索正确的类/函数/方法/任何东西，让它为你做魔法，然后发回输出（可以是很简单`echo $output`），你就可以开始运行了！请注意，如果您具有身份验证和角色检查权限，则可以将产生输出的函数视为普通、oldschool、php 函数。他们没有什么特别的！api 调用的身份验证和路由应该是您主要关心的问题。

我希望这能澄清你的一些问题并给你一个方向。如果我误解了你的问题，请纠正我！

# xml - 重命名重复的 XML 标记

> ID：10192280
> 
> 赞同：0
> 
> 时间：2012-04-17T13:33:44.810
> 
> 标签：xml, xslt

我有一些带有重复标签名称的 xml XML 文档，如下所示：

```
<ROOT>
    <RECORD>
        <ID>A1</ID>
        <NAME>Name1</NAME>
        <ADDRESS>StreetName</ADDRESS>
        <ADDRESS>CityName</ADDRESS>
        <ADDRESS>State</ADDRESS>
        <ADDRESS>321</ADDRESS>
        <PHONE>12345</PHONE>
    </RECORD>
    <RECORD>
        <ID>A1</ID>
        <NAME>Name1</NAME>
        <ADDRESS>StreetName</ADDRESS>
        <ADDRESS>CityName</ADDRESS>
        <ADDRESS>State</ADDRESS>
        <ADDRESS>123</ADDRESS>
        <PHONE>12345</PHONE>
    </RECORD>
</ROOT> 
```

所以我必须得到总地址，但是当我应用 XSLT 时，我只得到第一个标签值。是否有可能将该地址标签名称更改为适当的标签名称，如 STREET、CITY、STATE 和 ZIP 标签。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T14:35:05.723

**这种转变**：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 xmlns:my="my:my">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <my:reps>
  <rep pos="1">STREET</rep>
  <rep pos="1">CITY</rep>
  <rep pos="1">STATE</rep>
  <rep pos="1">ZIP</rep>
 </my:reps>

 <xsl:variable name="vReps"
      select="document('')/*/my:reps/*"/>

 <xsl:template match="node()|@*">
  <xsl:copy>
   <xsl:apply-templates select="node()|@*"/>
  </xsl:copy>
 </xsl:template>

 <xsl:template match="ADDRESS">
  <xsl:variable name="vPos" select=
     "count(preceding-sibling::ADDRESS)+1"/>
  <xsl:element name="{$vReps[position()=$vPos]}">
    <xsl:apply-templates/>
  </xsl:element>
 </xsl:template>
</xsl:stylesheet> 
```

**应用于提供的 XML 文档时**：

```
<ROOT>
    <RECORD>
        <ID>A1</ID>
        <NAME>Name1</NAME>
        <ADDRESS>StreetName</ADDRESS>
        <ADDRESS>CityName</ADDRESS>
        <ADDRESS>State</ADDRESS>
        <ADDRESS>321</ADDRESS>
        <PHONE>12345</PHONE>
    </RECORD>
    <RECORD>
        <ID>A1</ID>
        <NAME>Name1</NAME>
        <ADDRESS>StreetName</ADDRESS>
        <ADDRESS>CityName</ADDRESS>
        <ADDRESS>State</ADDRESS>
        <ADDRESS>123</ADDRESS>
        <PHONE>12345</PHONE>
    </RECORD>
</ROOT> 
```

**产生想要的正确结果**：

```
<ROOT>
   <RECORD>
      <ID>A1</ID>
      <NAME>Name1</NAME>
      <STREET>StreetName</STREET>
      <CITY>CityName</CITY>
      <STATE>State</STATE>
      <ZIP>321</ZIP>
      <PHONE>12345</PHONE>
   </RECORD>
   <RECORD>
      <ID>A1</ID>
      <NAME>Name1</NAME>
      <STREET>StreetName</STREET>
      <CITY>CityName</CITY>
      <STATE>State</STATE>
      <ZIP>123</ZIP>
      <PHONE>12345</PHONE>
   </RECORD>
</ROOT> 
```

**说明**：

用模板匹配覆盖标识规则，`ADDRESS`并根据该元素的位置生成一个`ADDRESS`元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T13:42:27.887

是的，您可以根据需要更改名称，但这不会给您任何您尚未拥有的东西。拥有街道城市州的名称与获取节点地址[1]、地址[2]、地址[3]没有什么不同

# git - 如何找到原始名称已知的重命名文件的新路径？

> ID：10192285
> 
> 赞同：7
> 
> 时间：2012-04-17T13:34:02.413
> 
> 标签：git, refactoring, git-bash

考虑以下用例：

我正在本地分支上工作，而主分支上已经完成了重构。现在一些文件（类）已被重命名和/或移动到新位置。合并时，由于缺少类，我得到很多导入错误。

```
--A--B--C--D--E-- (master)
   \           \
    F--G--H--I--J  (topic) 
```

里面有`A`我用过的旧名字`F--G--H--I`。

在`B--C--D--E`文件中重构导致新的文件名在`E`. 这包括链式重命名，如

```
 B: path/to/File.java              
-> C: path/to/BetterName.java
-> D: better/package/BetterName.java 
-> E: final/package/FinalName.java 
```

`J`由于我的分支上缺少重构，现在合并导致许多（编译）错误。（因为我仍然指`path.to.File`而不是`final.package.FinalName`

为了修复损坏的构建，我需要知道旧类的新名称。

是否有一个 git 命令来获取已应用于特定文件的所有重命名？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T15:52:56.607

Git 应该找到文件的重命名。但是，如果文件在该文件中有 50% 或更多的行更改，将不再被视为重命名。如果您愿意，可以更改此阈值。

这是执行此操作的命令：

```
git log -M --diff-filter=R --stat 
```

它只会显示重命名。如果要将阈值更改为默认 50% 以外的其他值，只需将数字添加到 M 选项：

```
git log -M90 --diff-filter=R --stat 
```

仅当内容更改不超过 10% 时才会认为文件已重命名

**更新：**

要跳过所有中间步骤，请改用 diff。Git 将为您遵循重命名：

```
git diff -M --diff-filter=R --name-status ..master | cut -f2- 
```

当您在主题分支上时。

然后，您可以通过管道制作一堆 sed 指令来调整您的引用。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-26T08:12:43.190

我在网上找不到令人满意的答案，所以我写了一个（尴尬的）脚本来逐个浏览日志（通过重命名来重命名）

将脚本与上述示例一起使用可提供以下输出：

> `$ git history path/to/File.java`
> 
> **`final/package/FinalName.java`**

我将脚本添加到我的并在我的全局 git 配置中`~.bashrc`添加了一个选项`alias.history=!bash -ic 'git_file_history "$@"' -`

```
#! /bin/sh
### Takes a filename as parameter ($1)
### Echoes all filenames related to $1
function git_file_history() {
        loc_var=$1;
        old=""
        while [ "$loc_var" != "$old"  ] && [ "$loc_var" != "" ]
        do
                old=$loc_var;
                #echo $loc_var;
                hashes=$(git log --format="%P %H" -1 --follow --  $loc_var);
                status=$(git diff --name-status --find-renames $hashes | grep $loc_var);
                awks=`echo $status | awk '{print $3}'`
                loc_var=$awks;
        done 
        echo "$loc_var";
} 
```

# mysql - Codeigniter 和 MYSQL 日期时间

> ID：10192292
> 
> 赞同：3
> 
> 时间：2012-04-17T13:34:35.887
> 
> 标签：mysql, codeigniter, date

我有一个查询如下：

```
$query = $this->db->get_where('Bookings', array('Status' => 0, 'Driver_ID' => null, 'Date'=> 'NOW()')); 
```

Date 字段是一个日期时间类型，我想在它们的日期与今天相同的地方添加记录，但是上面的内容以及我厌倦的所有其他内容都不起作用。

谁能告诉我如何正确提取今天日期的记录，而忽略日期时间的时间部分。

谢谢你的帮助

**更新**

我现在已将查询转换为以下

```
$start = date('Y-m-d 00:00:00');
    $end = date('Y-m-d 23:59:59');
    $query = $this->db->get_where('Bookings', array('Status' => 0, 'Driver_ID' => null, 'Date' => 'BETWEEN '.$start.' AND '.$end)); 
```

但是仍然没有运气，只是重新调整没有结果！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T14:51:23.273

我会尝试

```
$this->db->where('Status', 0);
$this->db->where('Driver_ID', null);
$this->db->where('DATE(Date)', date('Y-m-d'), FALSE);
$query = $this->db->get('Bookings'); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T14:43:59.897

```
$params = array('Status' => 0, 'Booking_Date'=> date('Y-m-d'));
$this->db->query('SELECT * FROM Bookings WHERE Status=? AND Driver_ID Is Null AND    Date(Booking_Date) = ?',$params); 
```

认为这会奏效

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T13:45:13.443

在您的代码中，您说您希望 DateTime 字段为`NOW()`. 问题在于它`NOW()`给出了一个 DateTime 值，即“YYYY-MM-DD”形式的日期，后跟“HH:MM:SS”形式的时间。

您的查询正在做的是说“给我记录今天的日期，在这一刻”。你想要的是“给我今天日期的记录”。

这就是为什么在数据库中使用 DateTime 字段通常很麻烦。您必须使用 MySQL 函数将您的 Date 字段转换为日期，而不是时间，`DATE()`而不是`NOW()`返回 DateTime 值，您将希望使用`CURDATE()`仅返回 Date 值。我没有专门使用 CodeIgniter 的经验，但请尝试：

```
$query = $this->db->get_where('Bookings', array('Status' => 0, 'Driver_ID' => null, 'DATE(Date)'=> 'CURDATE()')); 
```

（我不知道您是否可以将 MySQL 函数应用于带有 的字段`$this->db->get_where`）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-17T13:38:09.713

MySql 标准日期时间格式是`date("Y-m-d H:i:s")`.

因此，您的查询将需要获取当天的所有内容，例如 where 子句；

```
SELECT * FROM `Bookings` WHERE `Date` BETWEEN date("Y-m-d 00:00:00") AND date("Y-m-d 23:59:59") 
```

# c# - 从列表中删除具有重复属性的对象

> ID：10192294
> 
> 赞同：3
> 
> 时间：2012-04-17T13:34:41.800
> 
> 标签：c#, linq, list

我在 C# 中有一个对象列表。所有对象都包含属性 dept 和 course。
有几个对象具有相同的部门和课程。

如何修剪每个唯一（部门和课程）属性只有一个对象的列表（或创建一个新列表）。

[任何其他重复项都将从列表中删除]

我知道如何用一个属性来做到这一点：

```
fooList.GroupBy(x => x.dept).Select(x => x.First()); 
```

但是，我想知道如何为多个属性（2 个或更多）执行此操作？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-17T13:38:54.383

要使用多个属性，您可以使用匿名类型：

```
var query = fooList.GroupBy(x => new { x.Dept, x.Course })
                   .Select(x => x.First()); 
```

当然，这取决于什么类型`Dept`和`Course`要确定相等性。或者，您的类可以实现`IEqualityComparer<T>`，然后您可以使用接受比较器的[`Enumerable.Distinct`方法。](http://msdn.microsoft.com/en-us/library/bb338049.aspx)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-17T14:00:50.833

另一种方法是将 LINQ`Distinct`扩展方法与`IEqualityComparer<Foo>`. 它需要你实现一个比较器；但是，后者是可重用和可测试的。

```
public class FooDeptCourseEqualityComparer : IEqualityComparer<Foo>
{
    public bool Equals(Foo x, Foo y)
    {
        return
            x.Dept == y.Dept &&
            x.Course.ToLower() == y.Course.ToLower();
    }

    public int GetHashCode(Foo obj)
    {
        unchecked {
            return 527 + obj.Dept.GetHashCode() * 31 + obj.Course.GetHashCode();
        }
    }

    #region Singleton Pattern

    public static readonly FooDeptCourseEqualityComparer Instance =
        new FooDeptCourseEqualityComparer();

    private FooDeptCourseEqualityComparer() { }

    #endregion
} 
```

我的示例使用单例模式。由于该类没有任何状态信息，因此我们不需要每次使用它时都创建一个新实例。

我的代码不处理`null`值。当然，如果它们可能发生，您将不得不处理它们。

像这样返回唯一值

```
var result = fooList.Distinct(FooDeptCourseEqualityComparer.Instance); 
```

* * *

更新

我建议使用在构造函数中接受 lambda 表达式并且可以在多种情况下重用的通用 EqualityComparer 类

```
public class LambdaEqualityComparer<T> : IEqualityComparer<T>
{
    private Func<T, T, bool> _areEqual;
    private Func<T, int> _getHashCode;

    public LambdaEqualityComparer(Func<T, T, bool> areEqual,
                                  Func<T, int> getHashCode)
    {
        _areEqual = areEqual;
        _getHashCode = getHashCode;
    }

    public LambdaEqualityComparer(Func<T, T, bool> areEqual)
        : this(areEqual, obj => obj.GetHashCode())
    {
    }

    #region IEqualityComparer<T> Members

    public bool Equals(T x, T y)
    {
        return _areEqual(x, y);
    }

    public int GetHashCode(T obj)
    {
        return _getHashCode(obj);
    }

    #endregion
} 
```

你可以像这样使用它

```
var comparer = new LambdaEqualityComparer<Foo>(
    (x, y) => x.Dept == y.Dept && x.Course == y.Course,
    obj => {
        unchecked {
            return 527 + obj.Dept.GetHashCode() * 31 + obj.Course.GetHashCode();
        }
    }
);

var result = fooList.Distinct(comparer); 
```

注意：您必须提供哈希码的计算，因为`Distinct`使用内部`Set<T>`类，而后者又使用哈希码。

* * *

更新#2

一个更通用的相等比较器自动实现比较并接受属性访问器列表；但是，您无法控制比较的执行方式。

```
public class AutoEqualityComparer<T> : IEqualityComparer<T>
{
    private Func<T, object>[] _propertyAccessors;

    public AutoEqualityComparer(params Func<T, object>[] propertyAccessors)
    {
        _propertyAccessors = propertyAccessors;
    }

    #region IEqualityComparer<T> Members

    public bool Equals(T x, T y)
    {
        foreach (var getProp in _propertyAccessors) {
            if (!getProp(x).Equals(getProp(y))) {
                return false;
            }
        }
        return true;
    }

    public int GetHashCode(T obj)
    {
        unchecked {
            int hash = 17;
            foreach (var getProp in _propertyAccessors) {
                hash = hash * 31 + getProp(obj).GetHashCode();
            }
            return hash;
        }
    }

    #endregion
} 
```

用法

```
var comparer = new AutoEqualityComparer<Foo>(foo => foo.Dept,
                                             foo => foo.Course);
var result = fooList.Distinct(comparer); 
```

# java - 请解释死锁概念

> ID：10192295
> 
> 赞同：0
> 
> 时间：2012-04-17T13:34:44.717
> 
> 标签：java, deadlock

我正在通过 Java 线程，特别是死锁概念，我发现下面的代码：

```
public static void main(String... a) {

    final String o1 = "Lock ";
    final String o2 = "Step ";

    Thread th1 = new Thread() {
        public void run() {
            while (true) {
                synchronized (o1) {
                    synchronized (o2) {
                        System.out.println(o1 + o2);
                    }
                }
            }
        }

    };

    Thread th2 = new Thread() {
        public void run() {
            while (true) {
                synchronized (o2) {
                    synchronized (o1) {
                        System.out.println(o2 + o1);
                    }
                }
            }
        }

    };

    new Thread(th1).start();
    new Thread(th2).start();

} 
```

请根据我的理解解释程序正在做什么上述程序产生死锁的其他方法，请告知，并且上面代码中正在使用的锁是实例级锁。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T13:36:41.467

考虑以下场景：

*   `th1`锁定`o1`并在有机会锁定之前被中断`o2`；
*   `th2`锁定`o2`并尝试锁定`o1`。

两个线程都无法取得进一步进展，并且您遇到了[deadlock](http://en.wikipedia.org/wiki/Deadlock)。

您的代码的原始版本（在编辑之前）没有死锁的可能性，因为两个线程都以相同的顺序（`o1`then `o2`）获得了两个锁。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T13:43:58.480

根据您编辑的帖子，th1 可以获得 o1，而 th2 可以获得 o2。然后两个线程都在等待另一个释放他们尚未获得的锁，并且它永远不会发生 ==> 死锁。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T13:42:32.817

要创建死锁，您需要创建多个线程正在等待其他线程持有的锁的情况。例如：

*   线程 1 需要 Lock1 和 Lock2
*   按顺序请求：Lock1、Lock2
*   线程 2 需要 Lock1 和 Lock2
*   按顺序请求：Lock2、Lock1

    1.  线程 1 请求 Lock1。
    2.  线程 2 请求 Lock2。
    3.  线程 1 获得 Lock1。
    4.  线程 2 获得 Lock2。
    5.  线程 1 请求 Lock2。
    6.  线程 2 请求 Lock1。
    7.  线程 1 不能拥有 Lock2，线程 2 持有它。/线程 1 等待...
    8.  线程 2 不能拥有 Lock1，线程 1 持有它。/线程 2 等待...

* * *

**在您的（第一个，未编辑的）示例中，两个线程都以相同的顺序**请求它们需要的锁，这非常重要。如果Thread1得到Lock1，Thread2就无法得到Lock2并产生Deadlock，因为它还在等待Lock1。避免了死锁，因为两个线程都尝试以相同的顺序获取锁。

在您的（新的、已编辑的）示例中，可能会发生死锁，如上所述。

# clojure - 编写 Clojure 宏来生成地图表单

> ID：10192298
> 
> 赞同：2
> 
> 时间：2012-04-17T13:34:53.870
> 
> 标签：clojure

我有一系列序列，从 clojure-csv 输出。

```
(def s1 [[:000-00-0000 "SMITH" "JOHN" 27][:000-00-0001 "FARMER" "FANNY" 28]]) 
```

我有一个列号 [0 3] 的向量，我想用它来从每个序列中提取数据。

与其编写一个函数将可变数量的地图形式压缩在一起，我认为宏可能会解决问题。但是，我遇到了麻烦。

这个宏接受一个序列和一个列“掩码”

```
 (defmacro map-cols [seq & columns]
    (for [col# columns
        :let [mc# `(map #(nth % ~col# nil) ~seq)]]
        mc#))

(map-cols s1 cols)
ClassCastException clojure.lang.LazySeq cannot be cast to clojure.lang.IFn  bene-csv.core/eval2168 
```

我希望生成如下所示的多个地图表单：

```
(zipmap (map #(nth % 0 nil) s1) (map #(nth % 1 nil) s1))
{:000-00-0001 "FARMER", :000-00-0000 "SMITH"} 
```

我会很感激我做错了什么的一些想法。当然，我可以根据需要提取的列数定制 a 函数。

谢谢你。

编辑：

修改宏

```
(defmacro map-cols [seq & columns]
    (vec (for [col columns
        :let [mc `(map #(nth % ~col nil) ~seq)]]
        mc)))

(apply zipmap (map-cols s1 cols))

ArityException Wrong number of args (1) passed to: core$zipmap  clojure.lang.AFn.throwArity 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T13:46:19.783

You are mixing up code that will execute at macro expansion with code that the macro will output. Until you enter a syntax-quote, you don't need to use auto-gensym (col#, mc# in your example). As for the macro output, it must always produce exactly one form. It seems that you are expecting it to produce several forms (one for each col), but that's not how this can work. Your macro output will currently look like

```
((map #(nth % 0 nil) s1) (map #(nth % 1 nil) s1)) 
```

This is a form with two members. The member in the head position is expected to be a function, and the whole form is supposed to be evaluated as a function call.

The way to salvage this is to wrap your `for` in the macro with a `vec` and then use `(apply zipmap (map-cols s1 cols))`.

That answers your immediate question, but the solution will still not make sense: `zipmap` wants exactly two args, not a variable number of them as you said you want, and the output is a map, not a sequence that zips together your fields. Zipping is achieved using `(map vector seq1 seq2 ...)`.

# c# - 如何在代码的其他部分动态添加控件的值？

> ID：10192305
> 
> 赞同：0
> 
> 时间：2012-04-17T13:35:05.263
> 
> 标签：c#, asp.net, visual-studio-2010

我有一种方法可以根据用户必须输入的参数值的数量创建文本框。而且它工作正常。问题是当用户单击确定时，我想获取用户在这些文本框中输入的值并将它们替换为字符串。当我搜索这些文本框以从中获取文本值时，没有找到它们。我如何获得这些值来继续我的项目？代码是：

```
 protected void btnPreview_Click(object sender, EventArgs e)
    {
        lbHeader.Text = "Template Designer";
        divQueryBuilder.Visible = false;
        divTemplateDesigner.Visible = false;
        divFloating.Visible = true;

        if (txtQuery.Text.Contains("WHERE") || txtQuery.Text.Contains("where")||txtQuery.Text.Contains("Where"))
        {
            string[] splitter=new string[10];
            splitter[0]="Where";
            splitter[1]="WHERE";
            splitter[2]="where";
            splitter[3]="AND";
            splitter[4] = "and";
            splitter[5] = "And";
            string[] condition=txtQuery.Text.Split(splitter, StringSplitOptions.None);
            int numberOfParameters = condition.Length - 1;
            string[] Condition1 =null;
            Label[] newLabel = new Label[10];
            TextBox[] txtBox = new TextBox[10];
            for (int i = 0; i < numberOfParameters; i++)
            {
                string lbValue="lbValue";
                string lbID=lbValue+i;
                string txtValue = "txtValue";
                string txtID = txtValue + i;
                HtmlGenericControl genericControl = new HtmlGenericControl("br/");
                Condition1 = condition[i + 1].Split('[', ']');
                newLabel[i] = new Label();
                txtBox[i] = new TextBox();
                newLabel[i].ID=lbID;
                newLabel[i].Text = Condition1[1];
                txtBox[i].ID = txtID;

                td2.Controls.Add(newLabel[i]);
                td2.Controls.Add(genericControl);
                td2.Controls.Add(txtBox[i]);
                td2.Controls.Add(genericControl);
                txtBox[i].EnableViewState = true;
            }
        }
    }

 private bool ControlExistence(string lbID)
    {
        try
        {
            td2.FindControl(lbID);
            return true;
        }
        catch(Exception ex)
        {
            return false;
        }
    }

    protected void btnOk_Click(object sender, EventArgs e)
    {
       // GetTextBoxValues();
        string[] splitter1 = new string[10];
        splitter1[0] = "Where";
        splitter1[1] = "WHERE";
        splitter1[2] = "where";
        splitter1[3] = "AND";
        splitter1[4] = "and";
        splitter1[5] = "And";
        string[] condition = txtQuery.Text.Split(splitter1, StringSplitOptions.None);
        int numberOfParameters = condition.Length - 1;
        string[] splitter = new string[4];
        splitter[0] = "[";
        splitter[1] = "]";
        splitter[2] = "'";

        string[] queryBoxValue = txtQuery.Text.Split(splitter,StringSplitOptions.RemoveEmptyEntries);
        StringBuilder query = new StringBuilder();
        TextBox txtBox = new TextBox();

        for (int i = 0; i < queryBoxValue.Length; i++)
        {
            if (!queryBoxValue[i].Contains("?"))
            {
                query.Append(queryBoxValue[i]);
                query.Append(" ");
            }
            else
            {
                for (int counter1 = 0; counter1 < numberOfParameters; counter1++)
                {
                    string txtValue = "txtValue";
                    string txtID = txtValue + counter1;
                    if (ControlExistence(txtID))
                    {
                        TextBox box = (TextBox)td2.FindControl(txtID);
                        string b = box.Text;
                        //txtBox.ID = txtID;
                    }
                    txtBox.Text = "'" + txtBox.Text + "'";
                    queryBoxValue[i] = queryBoxValue[i].Replace(queryBoxValue[i], txtBox.Text);
                    query.Append(queryBoxValue[i]);
                }

            }
        }
        string fireQuery = query.ToString();
        adp = new SqlDataAdapter(fireQuery, conn);
        tab = new DataTable();
        adp.Fill(tab);
        if (tab.Rows.Count > 0)
        {
            string[] tempString = txtTemplate.Text.Split(' ');
            for (int j = 0; j < tempString.Length; j++)
            {
                if (tempString[j].StartsWith("["))
                {
                    txtPreview.Text = txtTemplate.Text.Replace(tempString[j], tab.Rows[0][0].ToString());
                }
            }
        }
        divFloating.Visible = false;
        divQueryBuilder.Visible = false;
        divTemplateDesigner.Visible = true;
    } 
```

请帮忙。这已经成为我的障碍。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T13:39:18.230

列出添加的控件并在需要时使用它。

```
 for (int i = 0; i < numberOfParameters; i++)
        {
            // ...

            td2.Controls.Add(newLabel[i]);
            td2.Controls.Add(genericControl);
            td2.Controls.Add(txtBox[i]);
            td2.Controls.Add(genericControl);

            addedTextBoxes.Add(txtBox[i]);

            // ...
        } 
```

然后从代码的另一部分：

```
var values = addedTextBoxes.Select(tb => tb.Text).ToList();

foreach (var txtBox in addedTextBoxes)
{
    // ...
} 
```

ETC...

# html - HTML 中链接的可缩放背景图像

> ID：10192306
> 
> 赞同：0
> 
> 时间：2012-04-17T13:35:06.727
> 
> 标签：html, css, hyperlink, scaling

在 HTML（使用 CSS）中，我使用以下代码创建具有背景图像的链接列表（或者更确切地说：链接左侧的图像）：

**HTML：**

```
<ul>
    <li><a class="share_fb" href="#">Like on Facebook</a></li>
    <li><a class="share_tw" href="#">Share on Twitter</a></li>
    <li><a class="share_gp" href="#">+1 on Google Plus</a></li>
</ul> 
```

**CSS：**

```
a {
    font-size: 1.4em;
}
a.share_fb {
    background: transparent url(images/share_fb.png) scroll no-repeat left center;
    padding: 0.1em 0 0.1em 0.4em;
}
... 
```

问题是：我尽我所能使整个页面具有可扩展性。但是当涉及到背景图形时：应该怎么做呢？哪种尺寸最适合这些背景图像？它们可能不会比文本行大，但应该在文本时缩放。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T13:37:27.707

尝试添加：

```
background-size: contain; 
```

到你的`a.share_fb`班级。这应该使背景图像缩放到元素的整个高度（不是因为文本的宽度）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T13:42:37.987

`background-size: contain;`（或值，百分比，像素等）适用于 CSS3。

否则，对于 CSS2（IE8 等），定位是必要的：

**HTML：**

```
<div id="container">
    <a href="#" class="img">
        <img src="http://www.google.co.uk/images/srpr/logo3w.png" /><span>Google</span>
    </a>
</div> 
```

**CSS：**

```
#container{width:200px; height:200px; background:red;}
a{display:block;position:relative; width:150px; height:150px; background:yellow;}
a img{display:block; position:relative; width:50%; height:50%;}
a span{display:block; position:absolute; background:green; top:10px; left:10px;} 
```

[Click here to see it in action](http://jsfiddle.net/TwSPm/1/) - change the width and height of the anchor. Change the image width and height to 100% for thefull size

Link also includes css3 version

# c# - Web 服务：获取 http 参数

> ID：10192308
> 
> 赞同：0
> 
> 时间：2012-04-17T13:35:09.597
> 
> 标签：c#, visual-studio, web-services

VS 和 C# 的完整新手，我正在尝试设置一个 Web 服务，从非常简单的开始。我设法编写了一个类，它（希望）在给定项目代码的情况下返回项目的名称。现在我想实现它以便可以从网络上调用它，但我不知道如何检索参数。这个想法是拥有[http://myurl.com?ProdRef=XYZ](http://myurl.com?ProdRef=XYZ)，并返回产品 XYZ 的名称。
请不要拍，这是我第一次尝试 C# 和 VS ！

## 编辑：工作代码（对谁有帮助）

班级代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Data;
using System.Data.SqlClient;

/// <summary>
/// Summary description for Class1
/// </summary>
class Product    
    {
        public string ProdRef {get; set; }
        public string ProdName{get; set; }

        public static string GetLabel(string ProdRef)
        {
            //
            // create a new SqlConnection object with the appropriate connection string 
            SqlConnection sqlConn = new SqlConnection("Data Source=ssss;Initial Catalog=ccccc;Persist Security Info=True;User ID=uuu;Password=pppp;Network Library=dbmssocn");
            // open the connection 
            sqlConn.Open();
            // create the command object 
            SqlCommand sqlComm = new SqlCommand("select libelle from dbo.vwArticlesPerm WHERE Ref = '" + ProdRef + "'", sqlConn);
            string strResult = (string)sqlComm.ExecuteScalar();
            // close the connection
            sqlConn.Close();
            return strResult;
        }
    } 
```

网络服务代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Services;

/// <summary>
/// Summary description for WebService
/// </summary>
[WebService(Namespace = "http://xxxxx.lu/clientwebserv")]
[WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
// To allow this Web Service to be called from script, using ASP.NET AJAX, uncomment the following line. 
// [System.Web.Script.Services.ScriptService]
public class WebService : System.Web.Services.WebService {

    public WebService () {

        //Uncomment the following line if using designed components 
        //InitializeComponent(); 
    }

    [WebMethod]
    public string GetName(string prName) {
        return Product.GetLabel(prName);
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T13:41:32.223

我认为您应该以这种方式定义 GetName

```
[WebMethod]
public string GetName(string name) 
{
    return Product.GetLLabel(name);
} 
```

当客户端应用程序加载您的 WSDL 时，返回的 xml 显示该`GetName`函数需要输入字符串并返回字符串。就这样。

下一步：不要构建查询手动加入字符串、int、日期，使用参数。

```
SqlCommand sqlComm = new SqlCommand(
    "select libelle from dbo.vwArticlesPerm WHERE Ref = @par", sqlConn);
cmd.Parameters.AddWithValue("@par", ProdRef); 
```

如果你想使用`GetLabel`，你必须添加`public`到它的声明中，否则你将无法在它的类之外看到它！

```
public static string GetLabel(string ProdRef)
{
    string strResult = null;
    using (SqlConnection sqlConn = new SqlConnection("server=xxx;uid=yyy;pwd=zzz;database=myerp;"))
    {
        sqlConn.Open();
        using (SqlCommand sqlComm = new SqlCommand("select libelle from dbo.vwArticlesPerm WHERE Ref = '" + ProdRef + "'", sqlConn))
            strResult = (string)sqlComm.ExecuteScalar();
        sqlConn.Close();
        return strResult;
    }
} 
```

我给你的另一个建议是`using(...)`在实例化实现`IDisposable`接口的类时使用：当块类的执行退出被释放时`using`，这样你就可以避免内存浪费和一些头痛:)

# asp.net - 如何在网站项目中强制更新 .ascx 文件内容

> ID：10192316
> 
> 赞同：-1
> 
> 时间：2012-04-17T13:35:22.507
> 
> 标签：asp.net, web-site-project

我有网站项目，其中包含一些 .ascx 和 .aspx 文件。我`<asp:TextBox ID="tb1" runat="server" ... />`在 .ascx 文件中添加了新元素，并使用此元素在正确的 .ascx.cs 文件中编写了一些代码`tb1.Text = "SomeText";`：当我编译这个项目时，我收到以下错误：当前上下文中不存在名称“tb1”。

如何强制刷新 .ascx 页面的标记？我使用**网站**项目，我无法将其类型更改为 Webapplication。

UPD：我有**网站**项目，其中**没有**.ascx.designers.cs 文件。而且我无法将我的项目类型更改为 Web 应用程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T13:40:28.667

除非这里发生了其他事情，否则听起来`designer.cs`文件可能不同步。尝试将控件剪切并粘贴回标记中，或者进入用户控件的设计器文件并`TextBox`手动添加：

```
protected global::System.Web.UI.WebControls.TextBox tb1; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T13:40:50.297

您的设计文件似乎没有与您的代码隐藏文件连接。

您能否确认您是否将其定义如下，

```
<%@ Control Language="C#" AutoEventWireup="true" CodeBehind="yourcontrol.ascx.cs" Inherits="CompleteNameSpace.ClassName" %> 
```

# java - 如何从 JMeter 中的 CSV 数据集配置中读取下一行？

> ID：10192319
> 
> 赞同：1
> 
> 时间：2012-04-17T13:35:32.870
> 
> 标签：java, jmeter

我正在 JMeter 中创建一个测试位置，该位置访问随机数量的页面（从 2 到 10），其 URL 将从 CSV 数据集中获取。我已经创建了 CSV 数据集和工作正常的采样器，除了每个线程只从数据集中读取一行，这不是我需要的 - 我希望在采样器完成后读取一个新行（或之前，我没有大惊小怪）。

我看到[这个问题](https://stackoverflow.com/questions/7317943/jmeter-csv-dataset-config-how-to-move-through-variables-in-the-same-thread)非常相似，解决方案是使用[原始数据源](http://code.google.com/p/jmeter-plugins/wiki/RawDataSource)预处理器，它确实有效，但需要对相关文件进行艰苦的修改（在每行之前添加块大小），这有点痛苦当文件长约 500 行时。

有没有办法可以将 CSV 数据集设置为在读取时前进到下一行，或者使用一些后置或预处理器，例如 beanshell，来做到这一点？我见过有人说[CSVRead](http://jmeter.apache.org/usermanual/functions.html#__CSVRead)可以做到这一点，但说访问是每个线程的，这对我没有好处。

作为旁注 - 最终我想要做的就是访问文件中的随机行，该行被传递给 HTTP 采样器，如果有更简单或更好的方法来做到这一点，我愿意接受建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T17:52:11.583

您可以使用从[BeanShell Sampler](http://jmeter.apache.org/usermanual/component_reference.html#BeanShell_Sampler) / [BeanShell PostProcessor](http://jmeter.apache.org/usermanual/component_reference.html#BeanShell_PostProcessor) / [BeanShell PreProcessor](http://jmeter.apache.org/usermanual/component_reference.html#BeanShell_PreProcessor)执行的这个 beanshell (= java) 代码。

以下代码将从您的文件中读取所有行，然后选择单个随机数：

```
import java.text.*;
import java.io.*;
import java.util.*;

String [] params = Parameters.split(",");
String csvTest = params[0];
String csvDir = params[0];

ArrayList strList = new ArrayList();     

try {
    File file = new File(System.getProperty("user.dir") + File.separator + csvDir + File.separator + csvTest);

    if (!file.exists()) {
        throw new Exception ("ERROR: file " + csvTest + " not found in " + csvDir + " directory.");
    }

    BufferedReader bufRdr = new BufferedReader(new FileReader(file));
    String line = null;

    while((line = bufRdr.readLine()) != null) {
        strList.add(line);
    }

    bufRdr.close();            

    Random rnd = new java.util.Random();
    vars.put("csvUrl",strList.get(rnd.nextInt(strList.size())));
}
catch (Exception ex) {
    IsSuccess = false; 
    log.error(ex.getMessage());
    System.err.println(ex.getMessage());
}
catch (Throwable thex) {
    System.err.println(thex.getMessage());
} 
```

然后您可以通过变量访问提取的 URL（本例中为 ${csvUrl}）。

从性能的角度来看，我只是怀疑在每次迭代中读取完整文件（如果你必须在循环中执行）是一个很好的解决方案。

# facebook - Facebook客户端在codeigniter中的应用授权

> ID：10192324
> 
> 赞同：0
> 
> 时间：2012-04-17T13:35:49.430
> 
> 标签：facebook, codeigniter, authorization

我在使用 facebook javascript 客户端应用程序授权时遇到问题。当应用程序未授权时，以下代码按预期工作，出现应用程序授权弹出窗口。当相同的代码在 codeignigter 中运行时，授权对话框无法出现。

```
 // Load the SDK Asynchronously
  (function(d){
     var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
     if (d.getElementById(id)) {return;}
     js = d.createElement('script'); js.id = id; js.async = true;
     js.src = "//connect.facebook.net/en_US/all.js";
     ref.parentNode.insertBefore(js, ref);
   }(document));

  // Init the SDK upon load
  window.fbAsyncInit = function() {
    FB.init({
      appId      : '169550646480230', // App ID
      channelUrl : '//'+window.location.hostname+'/channel', // Path to your Channel File
      status     : true, // check login status
      cookie     : true, // enable cookies to allow the server to access the session
      xfbml      : true  // parse XFBML
    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T14:12:39.750

这可能是由于两件事（我在这里做假设）：

1.  CSRF 已启用并阻止来自 Facebook 的外部响应
2.  由于无效的 URI 字符，来自 FB 的响应被过滤掉。

首先禁用 CSRF，并检查它是否有效，这将是我的起点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T18:52:54.150

想出了这个。

在 Javascript 身份验证之前运行的任何 PHP facebook 调用都会在服务器上生成异常并停止所有 HTML 活动。我猜它被称为异步是有原因的。

# asp.net-mvc - 将服务器端 MVC 与 Backbone.js 相结合

> ID：10192325
> 
> 赞同：6
> 
> 时间：2012-04-17T13:35:55.820
> 
> 标签：asp.net-mvc, backbone.js

我将 .NET MVC 用于所有服务器端逻辑并提供初始页面，但我的应用程序在客户端非常繁重，因此我采用了 Backbone.JS，它被证明非常有用。

不过，我不确定如何构建我的系统以结合这两种技术。我看到它的方式我有两个选择

1.  在服务器端从 MVC 中删除“V”，在页面加载时将 JSON 数据返回给客户端，并使用主干客户端模板从基本 JSON/主干模型构建 GUI。

2.  从完全呈现在 .NET MVC 中的服务器返回初始页面。还返回用于渲染它们的数据并调用 [collection.reset({silent: true})](http://documentcloud.github.com/backbone/#Collection-reset)方法将返回的数据链接到视图。我是否认为这将允许我随后更改使用视图上的添加/删除/更改处理程序？

1 困扰我，因为我害怕放弃服务器端 MVC 的任何部分，这是我的核心技能所在。

2 我担心我可能会通过在客户端服务器上使用两种不同的渲染方法来引入风险和工作。

将服务器端 MVC 与骨干网 1 或 2 或其他方式结合起来的正确方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T13:53:57.470

1.  您并没有真正废弃 . `V`，您只是将其表示形式从 HTML 更改为 JSON。您感到困扰是因为您对服务器端的东西感觉更舒服，而这并不是一个真正有效的问题……您将完成需要完成的工作，并随时学习/创建 Javascript 模式。

2.  这是一种方法，如果您需要禁用 javascript 的后备或受可访问性指南的约束，它真的很有帮助。您缺少的部分是您必须在加载页面后重新渲染页面，以将您的模型附加到 DOM 元素。或者，您可以使用为您处理此映射的工具，但这会增加您必须自己权衡的复杂性。

在主干的职业使用中，我们并不一定支持无 javascript 的场景，所以我们只是在初始加载时加载模板 + js，然后让路由器接管并使用更像你第一个想法的东西。因为听起来你才刚刚开始，帮助我们真正开始行动的最重要的事情是意识到**对**模型进行更改然后让你的视图订阅模型更改事件更容易（而不是相反） .

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T13:54:44.453

我不知道 Accepted Way 是什么，但我发现从服务器端组合 V 然后编织 Backbone （等）是有问题的。在非常受控的情况下它可以解决，但如果你的应用程序要在客户端非常繁重，我的建议是忘记在服务器端渲染，只返回 JSON 并让 Backbone 通过某种模板（Mustache 等）处理您的内容的渲染。

是的，您可以完全控制 Backbone 事件，因此您可以控制它们来做您想做的事情。

我听说你要放弃你在服务器端的部分技能。我也是这样，但如果这是您的项目所要求的，我认为您会发现让服务器端渲染更容易。

祝你好运！

# c# - 网页响应慢

> ID：10192327
> 
> 赞同：0
> 
> 时间：2012-04-17T13:36:02.057
> 
> 标签：c#, api, httpwebresponse

我正在尝试使用 api 来获取有关电影的信息，我正在使用[这个](http://www.imdbapi.com/)api 并且它实际上可以工作。

唯一的事情就是放慢速度，我想知道是否有更快的方法来做到这一点？我必须说，这对我来说是相当新的。这是一些代码。

```
 public string Connect()
    {
        WebRequest request = WebRequest.Create(this.url);
        request.ContentType = "application/json; charset=utf-8";

        //this is slowing me down
        WebResponse response = (HttpWebResponse)request.GetResponse();

        using (StreamReader sr = new StreamReader(response.GetResponseStream()))
        {
            jsonString = sr.ReadToEnd();
        }
        return jsonString;
    }

    public static string GetFilmInfo(string titel)
    {
        MakeCon checkVat = new MakeCon("http://www.imdbapi.com/?i=&t=red" + titel + "/");
        JsonSerializer serializer = new JsonSerializer();
        string jsonString = checkVat.Connect();
        return JsonConvert.DeserializeObject<string>(jsonString);
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T13:42:53.550

恐怕您的服务的运行速度不会比 imdb api 查找的速度快，再加上与您和 imdb 服务之间的带宽相关的一些开销，以及调用 HttpWebRequest.GetResponse 的**微小**开销。

可能您可以加快服务速度的唯一方法是将其托管在与 imdb 相同的建筑物中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T15:02:07.350

最好的办法是同时运行多个请求，使用 WebRequest.GetResponse 调用的异步版本，即 WebRequest.BeginGetResponse/EndGetResponse。这是一个简单的例子：

```
 static void Main(string[] args)
    {
        RequestByTitle("Mission Impossible");
        RequestByTitle("Mission Impossible 2");
        RequestByTitle("Mission Impossible 3");
        RequestByTitle("The Shawshank Redemption");

        Console.ReadLine();
    }

    private const String IMDBApiUrlFormatByTitle =
        "http://www.imdbapi.com/?t={0}";

    private static void RequestByTitle(String title)
    {
        String url = String.Format(IMDBApiUrlFormatByTitle, title);
        MakeRequest(url);
    }

    private static void MakeRequest(String url)
    {
        HttpWebRequest req = (HttpWebRequest)HttpWebRequest.Create(url);
        req.ServicePoint.ConnectionLimit = 10;

        req.BeginGetResponse(GetResponseCallback, req);
    }

    private static void GetResponseCallback(IAsyncResult ar)
    {
        HttpWebRequest req = ar.AsyncState as HttpWebRequest;
        String result;
        using (WebResponse resp = req.EndGetResponse(ar))
        {
            using (StreamReader reader = new StreamReader(
                resp.GetResponseStream())
                )
            {
                result = reader.ReadToEnd();
            }
        }

        Console.WriteLine(result);
    } 
```

注意这一行：

```
req.ServicePoint.ConnectionLimit = 10; 
```

它允许您向同一个服务端点发出超过 2 个并发请求（有关详细信息，请参阅[此帖子）。](https://stackoverflow.com/questions/866350/how-can-i-programmatically-remove-the-2-connection-limit-in-webclient)并且您应该仔细选择号码，以免违反使用条款（IMDB api服务，如果有的话）。

# objective-c - 在与核心数据的多对多关系中，应用程序关闭和再次打开的结果不同

> ID：10192332
> 
> 赞同：0
> 
> 时间：2012-04-17T13:36:22.987
> 
> 标签：objective-c, core-data, many-to-many, cs193p

在我的核心数据模型中，我有两个实体：“照片”和“标签”。它们之间的关系就像：Photo << ------->> Tag。

当我将照片插入数据库并设置关系时，我想使用实体“标签”获取照片的 NSArray。代码是：

```
NSPredicate *predicate = [NSPredicate predicateWithFormat:@"(ANY tags == %@)", tag];
requestForPhoto.predicate = predicate;
NSSortDescriptor *sortD = [NSSortDescriptor sortDescriptorWithKey:@"title" ascending:YES];
requestForPhoto.sortDescriptors = [NSArray arrayWithObject:sortD];
NSArray *matches = [document.managedObjectContext executeFetchRequest:requestForPhoto error:nil]; 
```

匹配数为 0；然后我关闭应用程序，再次打开并执行上面的代码，数字变为正常，变为1。

我确定我执行方法**saveToURL: forSaveOperation:**来保存数据。
我在重新打开应用程序之前和之后 NSLog 数据库的内容，它工作正常，关系已经建立。

我有另一个核心数据模型：

photo <<---------> location
当我获取照片时，我使用位置（不是实体）的 NSString 来执行此操作。结果很规律。

# php - 有没有更好、更简单的方法？

> ID：10192335
> 
> 赞同：2
> 
> 时间：2012-04-17T13:36:33.813
> 
> 标签：php

在 php 中，我正在做一个循环，类似于

```
 $x = 0;

    for ($i = 0; $i < 100; $i++)
    {
        if ($x == 3)    //better way to do this? in this example, determine every 3 times in a loop
        {
            //"do something"
            $x = 0;
        }

        $x++; 
```

正如你所看到的，我每 3 次在循环中做某事，但问题是，是否有更好、更简单的方法来确定它是否该在循环中“做某事”？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-17T13:38:52.387

您可以使用模数：

```
if(($i % 3 == 0) && ($i > 0))
{
   ...
} 
```

（不要忘记检查它是否优于 0，否则它会在第一次迭代时进入 if。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-17T13:38:53.810

您可以使用模运算符`%`来查看 $i 是否可以被三整除。这应该使您无法管理 $x

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-17T13:39:39.033

而不是使用`$x`，只需检查`if( $i > 0 && $i % 3 == 0)`。如果您还想在第一次运行时发生某些事情，只需放下`$i > 0 &&`零件。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-17T13:39:41.390

嘶嘶声吧？你会想要模运算符 - %

```
if ((6 % 3) == 0) {
    echo "is divisable by three";
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-04-17T13:40:54.590

您可以通过使用[模运算符](http://php.net/manual/en/language.operators.arithmetic.php)避免 $x 变量：

```
if ($i % 3 == 0 && i > 0){
    // Do something
} 
```

基本上这实现了相同的逻辑；每第三次迭代，循环将运行您的额外代码。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-17T13:39:26.363

在 $i 上使用模数：

```
for ($i = 0; $i < 100; $i++)
{
    if($i % 3 == 0)
    {
        // do something
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-04-17T13:40:13.260

```
for ($i = 0; $i < 100; $i++) {
    {
        if($i%3==0){
       //Do Something
     }
 } 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-05-13T16:55:49.477

在这段代码中：

```
for ($i = 0; $i < 100; $i++)
    {
        if(($i%3==0) && $i>0)
        {
           //Do Something   #first will be after 4 time
        }
    } 
```

但是这个：

```
for ($i = 1; $i <=100; $i++)
    {
        if($i%3==0)
        {
           //Do Something   #even first will be after 3 time 
        }
    } 
```

# matomo - 如何解决 piwik 追踪来源问题

> ID：10192338
> 
> 赞同：1
> 
> 时间：2012-04-17T13:36:42.227
> 
> 标签：matomo

当我调用我的应用程序时，我得到了这个

XMLHttpRequest 无法加载[http://tracker.ushahidi.com/piwik/piwik.php?idsite=36439&rec=1](http://tracker.ushahidi.com/piwik/piwik.php?idsite=36439&rec=1)。Access-Control-Allow-Origin 不允许来源[http://maps.zgb.de 。](http://maps.zgb.de)

我不介意被跟踪的应用程序，只是我不知道为什么这是一个问题。

欢迎任何意见，

你的，

抢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T17:54:26.423

发生的情况是安装 Piwik 的域与应用程序所在的域不同。

valipour 对此有一个很好的解释

[https://stackoverflow.com/a/11281976/421042](https://stackoverflow.com/a/11281976/421042)

# emacs - 如何在 Emacs 中输入希腊字符

> ID：10192341
> 
> 赞同：30
> 
> 时间：2012-04-17T13:36:48.203
> 
> 标签：emacs

[这个](http://xahlee.org/emacs/emacs_n_unicode.html)页面表明希腊字母可以通过使用`M-i`. `M-i`但是，Debian Squeeze 变体中的 Emacs 23.2.1 在按下时会插入“制表符”字符。如何在 Emacs 中插入希腊字母，例如 α 和 β？

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2012-04-17T18:39:35.677

`M-x` `set-input-method RET TeX`将允许您编写例如`\beta`to get`β`或to get`\sum`等。`\Sigma``Σ`

`toggle-input-method`它可以用、绑定到`C-\`和 来打开和关闭`C-<`。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2012-04-17T16:26:45.410

您可以使用`ucs-insert`bound to `C-x``8``RET`按名称或按值插入任何 Unicode 字符。

例如插入一个 lambda 你可以做

*   `C-x``8``RET` `GREEK SMALL LETTER LAMBDA` `RET`→ λ
*   `C-x``8``RET` `03bb` `RET`→ λ

也可以使用制表符完成。

`C-x``8``RET``* lambda``TAB` 将列出以 lambda 结尾的每个 unicode 字符。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2012-04-17T15:12:53.393

您可以将输入法设置为希腊语：

```
M-x set-input-method RET greek 
```

或者

```
C-x RET C-\ greek 
```

（这是相同的）。要设置输入法，请按`C-\`( `toggle-input-method`)。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2015-04-17T08:57:38.953

扩展@Oleg Pavliv 的答案：

要在您的文件中一劳永逸地解决这个问题`.emacs`，您需要选择一个键模式（如`M-g + <latin letter>`）和一个可记忆的对应表`<greek letter> - <latin letter>`。我建议不要发明任何新东西，而是使用 PostScript Symbol 编码中的对应关系。这使我得出以下结论：

```
(global-set-key (kbd "M-g a") "α")
(global-set-key (kbd "M-g b") "β")
(global-set-key (kbd "M-g g") "γ")
(global-set-key (kbd "M-g d") "δ")
(global-set-key (kbd "M-g e") "ε")
(global-set-key (kbd "M-g z") "ζ")
(global-set-key (kbd "M-g h") "η")
(global-set-key (kbd "M-g q") "θ")
(global-set-key (kbd "M-g i") "ι")
(global-set-key (kbd "M-g k") "κ")
(global-set-key (kbd "M-g l") "λ")
(global-set-key (kbd "M-g m") "μ")
(global-set-key (kbd "M-g n") "ν")
(global-set-key (kbd "M-g x") "ξ")
(global-set-key (kbd "M-g o") "ο")
(global-set-key (kbd "M-g p") "π")
(global-set-key (kbd "M-g r") "ρ")
(global-set-key (kbd "M-g s") "σ")
(global-set-key (kbd "M-g t") "τ")
(global-set-key (kbd "M-g u") "υ")
(global-set-key (kbd "M-g f") "ϕ")
(global-set-key (kbd "M-g j") "φ")
(global-set-key (kbd "M-g c") "χ")
(global-set-key (kbd "M-g y") "ψ")
(global-set-key (kbd "M-g w") "ω")
(global-set-key (kbd "M-g A") "Α")
(global-set-key (kbd "M-g B") "Β")
(global-set-key (kbd "M-g G") "Γ")
(global-set-key (kbd "M-g D") "Δ")
(global-set-key (kbd "M-g E") "Ε")
(global-set-key (kbd "M-g Z") "Ζ")
(global-set-key (kbd "M-g H") "Η")
(global-set-key (kbd "M-g Q") "Θ")
(global-set-key (kbd "M-g I") "Ι")
(global-set-key (kbd "M-g K") "Κ")
(global-set-key (kbd "M-g L") "Λ")
(global-set-key (kbd "M-g M") "Μ")
(global-set-key (kbd "M-g N") "Ν")
(global-set-key (kbd "M-g X") "Ξ")
(global-set-key (kbd "M-g O") "Ο")
(global-set-key (kbd "M-g P") "Π")
(global-set-key (kbd "M-g R") "Ρ")
(global-set-key (kbd "M-g S") "Σ")
(global-set-key (kbd "M-g T") "Τ")
(global-set-key (kbd "M-g U") "Υ")
(global-set-key (kbd "M-g F") "Φ")
(global-set-key (kbd "M-g J") "Φ")
(global-set-key (kbd "M-g C") "Χ")
(global-set-key (kbd "M-g Y") "Ψ")
(global-set-key (kbd "M-g W") "Ω") 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-04-17T14:05:53.673

您可以使用另一个前缀，例如：

```
(global-set-key (kbd "C-x <ESC> a") "α")
(global-set-key (kbd "C-x <ESC> b") "β") 
```

或`global-abbrev-table`按照您提到的页面上的说明使用。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2013-06-18T22:44:42.303

在 Emacs 中偶尔插入希腊字符的最简单方法是使用**abbrev-mode**和[这个希腊字母缩写表](https://gist.github.com/egarson/5800285)。

要使用上述要点，请启动 emacs 并调用`M-x edit-abbrevs`它将启动 Abbrevs 编辑器。然后在该部分下剪切并粘贴其中的*定义*`(global-abbrev-table)`（以使它们全局可用）或将它们放在另一个标题下，例如`(text-mode-abbrev-table)`.

*确保使用Mx abbrev-mode RET*在给定缓冲区中启用 abbrev-mode，或者通过添加到您的 init 文件中**全局启用 abbrev-mode。**`(setq-default abbrev-mode t)`或者，如果您只想为文本和派生模式启用缩写模式，请使用`(add-hook 'text-mode-hook (lambda () (abbrev-mode 1)))`.

有关更多信息，请参阅[有关 abbrev-mode 的 emacs wiki](http://www.emacswiki.org/emacs/AbbrevMode)。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2013-08-16T05:45:07.067

`C-x 8 RET`，如上面@Daimrod 所述，适合一次性插入。

如果要绑定键以插入给定的 Unicode 字符： Load library [`ucs-cmds.el`](http://www.emacswiki.org/emacs-en/download/ucs-cmds.el)，然后使用`C-1 C-x 8 RET`. 这将插入您选择的字符，并创建一个具有相同名称的命令，您可以将其绑定到一个键。

例如，`C-1 C-x 8 RET GREEK SMALL LETTER LAMBDA RET`定义 command `greek-small-letter-lambda`，它在调用时插入该字符。

您可以使用宏一次创建多个这样的命令`ucsc-make-commands`，也可以从[`ucs-cmds.el`](http://www.emacswiki.org/emacs-en/download/ucs-cmds.el). 例如，要为**每个**希腊字母创建单独的命令，只需执行以下操作：

```
 (ucsc-make-commands "^greek [a-z]+ letter") 
```

然后你可以绑定，比如说，命令`greek-small-letter-beta`或`C-c b`任何东西：

```
 (global-set-key (kbd "C-c b") 'greek-small-letter-beta) 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2018-04-11T02:43:37.503

Rasmus 的表弟对非 TeX/LaTeX 需求的回答：

```
M-x set-input-method RET C-\ greek RET
or
                 C-x RET C-\ greek RET 
```

或者

```
M-x set-input-method RET C-\ greek-babel RET
or
                 C-x RET C-\ greek-babel RET 
```

这些中的任何一个都为您提供输入方法，例如键入单个击键，“a”只是为您提供一个 alpha (α)，“b”为您提供一个 beta (β) 等等。

之后，您只需输入

```
C-\ 
```

快速从默认输入法切换到希腊语输入法。很方便。

但你必须注意：键并不总是与声音相匹配。例如，输入 hello 会得到 ηελλο。这是因为他们把“h”键变成了希腊语 eta (η)，仅仅是因为 η 看起来像一个 h，而且大写的希腊语 eta (H) 与我们的“H”相同，尽管它发音不同。

greek-babel 输入法相对于希腊语的优势将主要被那些使用更高级/复杂的 Attic Greek 的人所欣赏，它使用了很多口音。（Attic 在柏拉图时代约公元前 400 年在雅典使用，尽管重音和小写字母是在几个世纪后添加的。）您可以按两个键 < o 并得到 ὁ。后撇号是“h”音，称为“粗呼吸”——因此ὁ发音为“ho”。口音非常简单和快速。您可以在同一个字符上组合重音。例如，按三个键 > ' a 你会得到ἄ。如果您不需要重音符号，只需使用希腊语输入法。

使用 greek 和 greek-babel 输入法，您还可以点击 Ch C-\ 以获取有关输入法的帮助缓冲区，其中包括一个可爱的表格，其中包含所有可能的击键组合供您使用。（Cx o 移动到下一个窗口，因此您可以进入该信息窗口并向下滚动..）

另请参阅[https://www.emacswiki.org/emacs/InputMethods](https://www.emacswiki.org/emacs/InputMethods)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2020-10-08T20:08:14.730

TeX 输入法通常非常适合输入符号，但是如果您以任何频率输入它们（例如，如果您正在使用某种函数式编程语言输入），每次您想要插入时`λ`，它很快就会变成拖累输入`\lambda`一个希腊字母。

另一方面，希腊语输入法可以有效地处理希腊字母，并且是一个干净的解决方案，因为它利用了 Emacs 的内置希腊语支持，但它作为默认输入法并不是很有用。

您可以像这样结合两种方法的好处（放在您的 Emacs 初始化配置中的某个位置）：

```
(progn
  ;; conveniently enter math and greek symbols

  ;; leverage built-in input methods support in emacs to enter greek letters
  ;; by using the prefix ",."
  ;; adapted from https://emacs.stackexchange.com/a/53810
  (set-input-method "greek")
  (setq greek-map (quail-map))

  ;; add a translation rule to the TeX input method to delegate to
  ;; the greek input method
  (set-input-method "TeX")
  (quail-defrule ",." greek-map)

  ;; set default input method to TeX so that it can be activated
  ;; with C-\, e.g. to enter math or other symbols in general
  (setq default-input-method "TeX")) 
```

这使用 TeX 输入法作为默认值，但在使用前缀时添加了一条规则以临时委托给希腊语输入法`,.`。

例子：

```
,.a => α
,.l => λ
,.v => ω
\to => →
\circ = ∘
^2 => ²
_i => ᵢ 
```

资料来源：

[https://emacs.stackexchange.com/a/53810](https://emacs.stackexchange.com/a/53810)

[https://stackoverflow.com/a/10197062/323874](https://stackoverflow.com/a/10197062/323874)

[https://stackoverflow.com/a/49765665/323874](https://stackoverflow.com/a/49765665/323874)

[https://emacs.stackexchange.com/a/419](https://emacs.stackexchange.com/a/419)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-02-28T11:33:51.073

要**了解**如何输入您已经在屏幕上某处看到的**单个字符**，您可以将该字符复制粘贴到某个 emacs 缓冲区/文件中，然后调用`M-x describe-char`. 有了 α，它产生

> ```
> [...] to input: type "C-x 8 RET 3b1" or "C-x 8 RET GREEK SMALL LETTER ALPHA" [...] 
> ```

PS：重新[你的个人资料](https://stackoverflow.com/users/580010/sabrewolfy)，也试试`['a'] * 28`

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-04-30T15:46:14.380

在 Spacemacs

```
M-m i u 
```

这使您可以按名称搜索所需的符号。

# java - 如何将 struts.xml 中定义的 Struts2 Action 设置为 PortletURL

> ID：10192342
> 
> 赞同：1
> 
> 时间：2012-04-17T13:36:52.887
> 
> 标签：java, jsp, struts2, liferay, portlet

在 JSP 页面中，我有这个用于在 Liferay 中发出 AJAX 请求：

```
PortletURL portletURL = response.createRenderURL();
portleturl.setWindowState(LiferayWindowState.EXCLUSIVE); 
```

我将把它`portletURL`作为 url 传递给下面的 JQuery 函数

```
jQuery.ajax({
    type: "POST",
    url: portleturl ,
    success: function(msg) {
        alert( "Data Saved: " + msg );
    }
}); 
```

这是我在文件中的动作映射`struts.xml`：

```
<action name="helloForm" class="com.action.Struts2Action">
    <result name="input">/WEB-INF/view/index.jsp</result>
    <result name="success">/WEB-INF/view/result.jsp</result>
</action> 
```

现在请告诉我如何将名为的动作设置`helloForm`为`portletURL`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T14:45:37.113

It is common in the code of Liferay. For example, in [this JSP file](https://github.com/liferay/liferay-portal/blob/master/portal-web/docroot/html/portlet/asset_publisher/view.jsp#L105) a link is created with a parameter defined by

```
<portlet:param name="struts_action" value="/asset_publisher/edit_subscription" /> 
```

(which points to this [action mapping](https://github.com/liferay/liferay-portal/blob/master/portal-web/docroot/WEB-INF/struts-config.xml#L272) inside the huge Liferay `struts-config.xml` file).

So, I suppose you just need to add a parameter to your URL in the same way, with the sole difference of doing it with the `PortletURL` object:

```
PortletURL portletURL = response.createRenderURL();
portleturl.setWindowState(LiferayWindowState.EXCLUSIVE);
portletURL.setParameter("struts_action", "helloForm"); 
```

# php - 重定向到专门的错误页面？

> ID：10192343
> 
> 赞同：1
> 
> 时间：2012-04-17T13:37:01.937
> 
> 标签：php, error-handling

PHP中是否有任何方法可以在出错时将浏览器重定向到新页面，同时保持错误日志记录？

1.  用户执行导致 PHP 致命错误的操作

2.  错误已记录

3.  浏览器被重定向到`example.com/error`

4.  用户会看到一个表单，预先填写错误，并且能够提供更多详细信息

# java - 从用户那里获取输入

> ID：10192349
> 
> 赞同：4
> 
> 时间：2012-04-17T13:37:13.113
> 
> 标签：java, io

`Scanner`从和获取输入 和有什么不一样`BufferedReader`？

这是一个`BufferedReader`例子......

```
BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
System.out.println("Enter characters, 'q' to quit.");

// read characters
do {
    c = (char) br.read();
    System.out.println(c);
} while(c != 'q'); 
```

这是一个`Scanner`例子......

```
Scanner scan = new Scanner(System.in);
char mrArray = new char[10];
// read characters
for (int i = 0; i < myArray.length; i++) {
    String temp = myScanner.next();
    myArray[i] = temp.charAt(0);
} 
```

这两种情况有什么区别吗？这些类中的任何一个将来可能会改变吗？我应该`BufferedStream`优先使用`Scanner`吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-17T13:40:20.350

> BufferedReader 是一个简单的类，旨在有效地从底层流中读取。通常，由 Reader（如 FileReader）发出的每个读取请求都会导致对底层流发出相应的读取请求。每次调用 read() 或 readLine() 都可能导致从文件中读取字节，转换为字符，然后返回，这可能非常低效。如果 Reader 在 BufferedReader 中变形，效率会显着提高。
> BufferedReader 是同步的，因此 BufferedReader 上的读取操作可以安全地从多个线程完成。
> 
> 另一方面，扫描仪内置了更多的奶酪。它可以做 BufferedReader 可以做的所有事情，而且效率也相同。但是，除此之外，Scanner 可以使用正则表达式解析基本流的基本类型和字符串。它还可以使用您选择的分隔符标记基础流。它还可以不考虑分隔符对底层流进行前向扫描！然而，扫描器不是线程安全的，它必须是外部同步的。

资料来源：[扫描仪与缓冲区阅读器](http://en.allexperts.com/q/Java-1046/2009/2/Difference-Scanner-Method-Buffered.htm)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-17T13:38:56.407

Scanner 用于从流的内容中解析令牌，而 BufferedReader 只是读取流并且不进行任何特殊解析。

实际上，您可以将 BufferedReader 作为要解析的字符源传递给扫描仪，并且 BufferedReader 是同步的，而 Scanner 不是，因此由您决定。

*编辑*System.in 是一个流。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-17T13:41:50.833

主要的实际区别只是[Scanner](http://docs.oracle.com/javase/7/docs/api/java/util/Scanner.html)直到 1.5 才引入，因此在此之前您别无选择，只能包裹`System.in`各种阅读器，然后自己解析输出以检索您想要的内容。

Scanner 现在为您管理了很多这些，因此除非您有令人信服的理由使用 BufferedReader 并完全自己解析/处理事物，否则我通常会默认使用 Scanner - 如果没有别的，因为它使代码更清晰。

# module - 修改登录页面外观，登录失败时运行javascript/jquery

> ID：10192350
> 
> 赞同：0
> 
> 时间：2012-04-17T13:37:14.613
> 
> 标签：module, dotnetnuke

我想修改登录页面的外观。我在 DesktopModules/AuthenticationServices/DNN/Login.ascx 中添加了一些 jquery 和 javascript，因此我可以拥有一个虚拟键盘，用户可以使用它来输入用户名和密码。问题是当登录失败时，在我看来 jquery 和 javascript 脚本没有执行，因此虚拟键盘没有出现。

我已经对此进行了很多搜索。我正在考虑制作一个新的登录模块，但我不确定这如何或是否能让我解决问题。

有什么建议吗？

DNN 版本：6.1.3

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T06:36:48.183

我建议不要直接更改核心登录，因为它被认为是“核心更改”并且会在升级中被覆盖。这将要求您在每次升级之前合并您的更改。

相反，如果您需要该级别的访问权限，我建议您创建自己的登录模块。

不过，在查看您的问题时，我认为这没有必要。您可以通过创建和实现皮肤小部件来实现相同的效果。皮肤小部件将允许您以几乎任何您能想到的方式操作 UI，因为您可以使用 jQuery 和注入 jQuery 插件。

这是一个更优雅的解决方案，可以扩展、可测试、安全升级，并允许您根据需要在多个站点和安装中重用它。

可以在以下两个链接中找到小部件和文档的示例：

[DNN Widget Suite Project](http://dnnwidgets.com/) [Skin Widget Wiki 文章](http://www.dotnetnuke.com/Resources/Wiki/Page/Widget.aspx)，包含许多链接资源

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T05:49:52.017

正如 Will 所说，您绝对不应该在核心文件中编辑或添加代码，因为它们会在 DNN 升级中被覆盖。您应该能够仅使用 Javascript 解决此问题，但您也可以查看像这样的第 3 方登录模块：[http](http://www.dnnspot.com/Modules/DotNetNuke-Custom-Login) : //www.dnnspot.com/Modules/DotNetNuke-Custom-Login 具有自定义登录的功能查看，登录查看，甚至错误消息。所以你应该能够在不同的情况下根据需要注入不同的 javascript。

*免责声明 - 我隶属于 DNNspot。*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-25T12:23:24.213

我使用了这个可爱的 javascript On-Screen-Keyboard (OSK)。（[http://www.greywyvern.com/code/javascript/keyboard](http://www.greywyvern.com/code/javascript/keyboard)）

我正在使用 DNN 5.6.8 所以我不确定我的解决方案是否适用于 DNN 6.x 。

我修改了我正在使用的“皮肤”的“page.ascx”文件，但我认为您也可以修改默认皮肤的“page.ascx”。

在 page.ascx 的顶部，在“Register”列表下方，我写道：

```
<script type="text/javascript" src="/js/keyboard.js" charset="UTF-8"></script>
<link rel="stylesheet" type="text/css" href="/js/keyboard.css"> 
```

这两个文件（keyboard.js 和keyboard.css）是屏幕键盘。当然，您可以将它们存储在“/js”以外的其他文件夹中。

在 page.ascx 的底部，我放了这个脚本：

```
<script type="text/javascript">
$(document).ready(function () {
    if (document.getElementById('dnn_ctr_Login_Login_DNN_txtUsername') != null) {
        $("#dnn_ctr_Login_Login_DNN_txtUsername").attr("lang", "es");
        $("#dnn_ctr_Login_Login_DNN_txtPassword").attr("lang", "es");
        VKI_attach(document.getElementById('dnn_ctr_Login_Login_DNN_txtUsername'));
        VKI_attach(document.getElementById('dnn_ctr_Login_Login_DNN_txtPassword'));
    }
});
</script> 
```

这些名称：'dnn_ctr_Login_Login_DNN_txtUsername' 和 'dnn_ctr_Login_Login_DNN_txtPassword' 是我通过右键单击和“查看源代码”运行的 DNN 站点看到的名称，我认为没有理由认为它们在其他 DNN 站点中会有所不同，但尽管如此你可以检查你的。

Obviously you must have jQuery active in your DNN installation. :)

That's it. It works great!!

HTH!

# android - Android jni 数据类型丢失精度（ByteBuffer，int）

> ID：10192354
> 
> 赞同：0
> 
> 时间：2012-04-17T13:37:19.147
> 
> 标签：android, java-native-interface, bytebuffer

我在做什么：我在 C 中添加了四个整数。在途中，我丢失了信息。

请参见下面的代码：

```
//c-file
jbyte *inputByteArray = (*env)->GetDirectBufferAddress (env, obj);

// checked every value, also sizeof(val1)= 4 etc...
int val1 = (int) *(inputByteArray + 1); //120 
int val2 = (int) *(inputByteArray + 2); //120
int val3 = (int) *(inputByteArray + 3); //180
int val4 = (int) *(inputByteArray + 4); //180
int result = val1 + val2 + val3 + val4;

return result; 
//return type is int

//output: 88, should be 600
// 88 binary: 0000 0000 0101 1000
//600 binary: 0000 0010 0101 1000 
```

关于此的特殊情况如下，这可能会导致问题：

输入的 4 个值来自 Java 的一个移交的 Buffer，它是一个直接的 ByteBuffer。它直接在 Java 中分配，以便不被垃圾收集器移动。在 c 端，我通过来自“GetDirectBufferAddress”的指针（参见代码）移交缓冲区，并且单个值确实与数组中的值匹配。

有谁知道这种奇怪的行为？

当我使用 IntBuffer 交出数字时，顺便说一句。
我在这里工作是为了提高性能，所以我想要小的缓冲区，而且我的数据值小到可以使用 ByteBuffer。（这只是 c 代码端更大计算的一个片段）

由于这是在Android上，我没有设法调试到c代码......

编辑：我在 Android 3.2.1 测试设备的当前版本中使用 eclipse/SDK/NDK

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T05:38:33.250

正如@Deucalion 所说，您的阵列看起来很狡猾。除非您尝试添加数组[1](https://encrypted.google.com/search?q=120%2b120-76-76&ie=utf-8&oe=utf-8&aq=t&rls=org.mozilla%3aen-US%3aofficial&client=firefox-a)、数组 [2]、数组 [3] 和数组 [4]。不使用数组 [0]。
无论如何假设你所做的是你想要的，你的价值正是你将得到的。
字节范围为 -128 t0 +127。所以 180 实际上存储为 -76。[瞧](https://encrypted.google.com/search?q=120%2b120-76-76&ie=utf-8&oe=utf-8&aq=t&rls=org.mozilla%3aen-US%3aofficial&client=firefox-a)！_

# c# - 从 web 服务返回两个值

> ID：10192356
> 
> 赞同：5
> 
> 时间：2012-04-17T13:37:20.767
> 
> 标签：c#, asp.net, web-services, return

可以从 WebService 向 jQuery 返回两个值。

我试过了

```
[WebMethod(EnableSession = true)]
public string testing(string testId)
{
    string data = string.Empty;
    string data1 = string.Empty;
    List<test1> datalist1 = new List<test1>();
    List<test> datalist = new List<test>();

    //coding
    data = jsonSerialize.Serialize(datalist1);
    data1 = jsonSerialize.Serialize(datalist);
    return [data,data1];
} 
```

但它显示错误......我们如何从这里的 web 服务返回两个值......

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-17T13:40:06.800

另一种方法是创建一个具有您想要的两个返回值的自定义数据类型：

```
[Serializable]
public sealed class MyData
{
    public string Data { get; set; }
    public string Data1 { get; set; }
} 
```

...

```
[WebMethod(EnableSession = true)]
public MyData testing(string testId)
{
    string data = string.Empty;
    string data1 = string.Empty;
    List<test1> datalist1 = new List<test1>();
    List<test> datalist = new List<test>();

    //coding
    data = jsonSerialize.Serialize(datalist1);
    data1 = jsonSerialize.Serialize(datalist);
    return new MyData { Data = data, Data1 = data1 };
} 
```

**或者**

```
[Serializable]
public sealed class MyData
{
    public List<test> Data { get; set; }
    public List<test1> Data1 { get; set; }
} 
```

...

```
[WebMethod(EnableSession = true)]
public string testing(string testId)
{
    MyData data = new MyData();
    string alldata = string.Empty;
    List<test1> datalist1 = new List<test1>();
    List<test> datalist = new List<test>();

    //coding
    data.Data = datalist1;
    data.Data1 = datalist;
    alldata = jsonSerialize.Serialize(data);
    return alldata;
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-04-17T13:39:00.727

那么你可以返回一个字符串*数组*：

```
public string[] Testing(...)
{
    return new string[] { data, data1 };
} 
```

然后，您需要在客户端上分别执行 JSON 反序列化的每一位，这不太可能令人愉快:(

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T13:39:43.473

`return [data, data1]`不是有效的 C# 语法。如果要向调用者返回 JSON 数组，请使用`JsonSerializer`序列化数组并返回结果字符串。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-17T13:40:09.757

webmethod 就像一个常规方法，它只能返回**一个**值。

如果它的类型相同，您可以使用列表或数组。

如果它的类型不同，您可以创建一个保存数据的类

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-27T10:56:59.093

我试过了

```
 return jsonSerialize.Serialize(new { list1 = datalist1, list = datalist }); 
```

我可以很容易地从我的 jQuery 文件中接收这些。谢谢大家的支持

# c# - 动态创建的 GridView 模板列面临一个小故障：没有 PAGING？

> ID：10192357
> 
> 赞同：1
> 
> 时间：2012-04-17T13:37:26.303
> 
> 标签：c#, .net, gridview, datatable, paging

我从 DataTable 动态创建我的 gridView。现在，当我向它添加分页时，我必须自动生成列。一旦我这样做，gridview 数据就会被复制。

每 150 列重复的 1.5K+ 记录看起来并不完全正确。

任何人都知道如何添加实际上不会搞砸一切的分页？

PS：我在 Button_Click 上启动了 LoadGridView() 事件。

[这是一个非常简单的例子，说明它是如何完成的](http://www.codeproject.com/Articles/13462/How-to-create-template-columns-dynamically-in-a-gr?msg=4223518#xx4223518xx)

# javascript - 如何从索引页面重新触发脚本？

> ID：10192362
> 
> 赞同：0
> 
> 时间：2012-04-17T13:37:40.853
> 
> 标签：javascript, jquery, getscript

我想重新启动在我的 index.php 主页中加载的脚本（syntaxhighlighter、processingjs）。

我还想在 .load() 请求的另一端执行脚本...这似乎不太可能，因为这些页面请求也命中 .text()，据我了解，它会删除脚本。这种事情总是依赖于脚本本身，还是我对页面编译不了解？

重申一下，我正在寻找一种方法来重新启动已经加载但不再影响 ajax 加载内容的脚本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T15:16:17.810

确定触发脚本的唯一方法是重新加载页面。

您对页面编译没有任何误解。当浏览器呈现 html 时，它会遇到`<script>`标签。这些它按照遇到它们的顺序执行。

正如您自己所说，可以使用 javascript 删除脚本块。虽然这对我来说非常不寻常，但我之前只听说过几次（并且调用`jQuery.fn.text()`肯定不会这样做），但仅此一项就不可能可靠地重新执行*所有内容*。

话虽如此，因为我们通常不希望在浏览器完成将所有元素加载到页面之前执行代码，因此仅在响应文档的 onload 事件时运行所有代码是一种常见的模式。这就是您的代码在设置`$(document).ready(function(){...})`或`$(function(){...})`（它们都是相同的）时正在执行的操作。由于该代码始终响应文档的加载事件而运行，因此您始终可以使用`$(document).ready()`或重新触发它`$(document).trigger('ready')`

但是，请彻底测试这一点，因为许多库都假设该事件只发生一次。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T15:08:44.573

大多数库都会附带一个在页面内容上“运行”它们的功能。您只需编写对它们的调用，将它们放入某种“初始化”函数中，并在需要时调用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T15:19:19.693

您可以修改加载的脚本，以便可以从函数中调用它们。然后，当您要运行脚本的内容时调用此函数。

如果您不知道如何修改脚本，请获取一些开发人员工具，例如 FireBug for FireFox，以便您可以在脚本运行时对其进行检查。

# c# - 动态减小 FontSize 以避免溢出

> ID：10192363
> 
> 赞同：1
> 
> 时间：2012-04-17T13:37:45.257
> 
> 标签：c#, wpf, overflow, itemscontrol, font-size

我已经编写了一个带有 a`Button`和`ItemsControl`. 每次单击 时`Button`，都会将字符串“AnotherWord”添加到`ItemsControl`. 现在，`ItemsControl`它显示为水平方向`StackPanel`，具有固定宽度（500 像素）。这意味着当您单击按钮一定次数（实际上是六次）时，新添加的字符串会被剪切，如下所示：

“另一个字另一个字另一个字另一个字另一个字另一个我”

这发生在`FontSize`13 时；如果你把它降低到 12.7，那么“AnotherWord”就有第六次出现的空间。我的问题是：有没有办法在运行时进行这种调整以避免溢出？

编辑：

在问题的上下文中，固定宽度`StackPanel`是强制性的 - 我们不能使用超过我们拥有的 500 像素。另一个要求是字体不能大于 13。

这是我写的所有代码：

```
<!-- MainWindow.xaml -->
<Window x:Class="FontSize.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow" Height="350" Width="525"
         DataContext="{Binding RelativeSource={RelativeSource Self}}">
    <Window.Resources>
        <DataTemplate x:Key="labelTemplate">
            <Label FontSize="13" Content="AnotherWord"></Label>
        </DataTemplate>
        <ItemsPanelTemplate x:Key="panelTemplate">
            <StackPanel Orientation="Horizontal" Width="500" Height="50" />
        </ItemsPanelTemplate>
    </Window.Resources>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>
            <ItemsControl Grid.Row="0" ItemsSource="{Binding Path=MyStrings}" ItemTemplate="{StaticResource labelTemplate}" 
                ItemsPanel="{StaticResource panelTemplate}" />
        <Button Grid.Row="1"  Click="Button_Click"></Button>
    </Grid>
</Window>

// MainWindow.xaml.cs
using System.Collections.ObjectModel;
using System.Windows;

namespace FontSize
{
    public partial class MainWindow
    {
        public MainWindow()
        {
            InitializeComponent();
            MyStrings = new ObservableCollection<string>();
        }

        public ObservableCollection<string> MyStrings
        {
            get { return (ObservableCollection<string>) GetValue(MyStringsProperty); }
            set { SetValue(MyStringsProperty, value); }
        }

        private static readonly DependencyProperty MyStringsProperty =
            DependencyProperty.Register("MyStrings", typeof (ObservableCollection<string>), typeof (Window));

        private void Button_Click(object sender, RoutedEventArgs e)
        {
            MyStrings.Add("AnotherWord");
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T15:38:41.097

将您`ItemsControl`的视图放入[Viewbox](http://msdn.microsoft.com/en-us/library/system.windows.controls.viewbox.aspx)并使用以下属性：

*   最大宽度
*   最大高度
*   拉紧
*   拉伸方向

**编辑**

并删除您的`Width`&`Height`属性`StackPanel`。

**编辑 2**

尝试这样的事情：

```
<!-- MainWindow.xaml -->
<Window x:Class="FontSize.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow" Height="350" Width="525"
         DataContext="{Binding RelativeSource={RelativeSource Self}}">
    <Window.Resources>
        <DataTemplate x:Key="labelTemplate">
            <Label FontSize="13" Content="AnotherWord"></Label>
        </DataTemplate>
        <ItemsPanelTemplate x:Key="panelTemplate">
            <StackPanel Orientation="Horizontal"/>
        </ItemsPanelTemplate>
    </Window.Resources>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>
        <Viewbox Grid.Row="0" MaxWidth="500" Stretch="Uniform">
            <ItemsControl 
                ItemsSource="{Binding Path=MyStrings}"
                ItemTemplate="{StaticResource labelTemplate}" 
                ItemsPanel="{StaticResource panelTemplate}" />
        </Viewbox>
        <Button Grid.Row="1"  Click="Button_Click"></Button>
    </Grid>
</Window> 
```

**编辑 3**

更改 的水平对齐方式，`Viewbox`使其不会被拉伸以填充网格。我放了“中心”，用你想要的替换。

```
...
<Viewbox 
    HorizontalAlignment="Center" 
    StretchDirection="DownOnly"
    Grid.Row="0"
    MaxWidth="500"
    Stretch="Uniform">
... 
```

# soundcloud - SoundCloud解析基本搜索结果，有api支持吗？

> ID：10192373
> 
> 赞同：0
> 
> 时间：2012-04-17T13:38:23.377
> 
> 标签：soundcloud

...只是想确认，由于最新的 soundcloud api 不提供数据接口，因此我们只能解析 http 请求的结果。

我担心的是生成的结构可能随时更改，从而使我的解析模式无效。还有其他人在做类似的事情吗？或更好？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T22:47:03.620

这是对的。所有 SoundCloud API 响应都将被序列化为 JSON 或 XML。我们非常重视向后兼容性，因此您可以依赖返回的格式和数据。

大多数语言至少有一个库能够自动将 JSON 解析为适当的数据类型（即散列数组）。在尝试访问密钥之前，您始终可以检查以确保其存在，例如在 Python 中：

```
import json
import urllib

url = 'https://api.soundcloud.com/tracks.json'

fp = urllib.urlopen('%s?%s' % (url, urllib.urlencode({
    'client_id': 'YOUR_CLIENT_ID',
    'limit': 2
})))
data = fp.read()

tracks = json.loads(data)
for track in tracks:
    print track.get('title', 'No title available') 
```

这有助于回答你的问题吗？

# c# - 无法加载在 GAC 中找到的程序集

> ID：10192376
> 
> 赞同：2
> 
> 时间：2012-04-17T13:38:32.740
> 
> 标签：c#, powershell-2.0, t4

我正在尝试加载存在于 C:\Windows\assembly\ 并称为 Microsoft.VisualStudio.TextTemplating（版本 9.0.0.0）的程序集

这是我正在使用的 PowerShell 2.0 中的命令

```
$inputfile = 'Hello.tt'
[Reflection.Assembly]::LoadWithPartialName("Microsoft.VisualStudio.TextTemplating") | 
   Out-Null

$server = New-Object ("Microsoft.VisualStudio.TextTemplating") $inputfile 
```

我得到的错误是 **default.ps1:Cannot find type [Microsoft.VisualStudio.TextTemplating] 确保加载了包含该类型的程序集。**

编辑：我使用相同的方法加载其他 Microsoft 程序集，如 Smo，这些程序集也注册在缓存中，所以我想知道这个程序集是否还有其他问题

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T14:07:56.917

这里的问题似乎不是程序集负载。我验证了该`LoadWithPartialName`方法确实加载了有问题的程序集。

问题是您的`New-Object`调用传递的是命名空间而不是类型。您需要在命名空间内传递一个类型名称`Microsoft.VisualStudio.TextTemplating`。

# javascript - 如何使用 javascript/jquery 关闭 iframe？

> ID：10192379
> 
> 赞同：0
> 
> 时间：2012-04-17T13:38:34.523
> 
> 标签：javascript, jquery, html

我在页面上有这个元素：

```
<iframe src="http://example.com" id="fa-iframe" scrolling="No" frameborder="0" style="height: 513px; width: 597px; "></iframe> 
```

现在，我在其中运行 jquery 并尝试关闭它...

jquery 应该在元素上执行一些函数...

我尝试了这样的解决方案..但它没有用：

```
document.getElementById('fa-iframe').style.display="none"; 
```

如何关闭 iframe..当带有 javascript 的文档在 iframe 内时？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T13:39:53.493

您需要操作父窗口 ( `parent`) 的 DOM。这是受[同源政策](http://en.wikipedia.org/wiki/Same_origin_policy)的约束。

# f# - 使函数适用于所有数字类型（int、float、long）

> ID：10192390
> 
> 赞同：3
> 
> 时间：2012-04-17T13:39:11.540
> 
> 标签：f#

这个简单的功能：

```
let sum a b = a + b 
```

仅**适用于 int 类型**

如何使它也适用于 float 和 long ？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-17T13:45:23.637

使用[内联](http://msdn.microsoft.com/en-us/library/dd548047.aspx)：

```
let inline sum a b = a + b 
```

* * *

**更新：**

如果您对编写自己的多态数值函数感兴趣，您应该同时使用[inline](http://msdn.microsoft.com/en-us/library/dd548047.aspx)和[LanguagePrimitives](http://msdn.microsoft.com/en-us/library/ee340276.aspx)模块。

这是来自线程[Converting Haskell Polymorphic Cosine function to F#](https://stackoverflow.com/questions/8905037/converting-haskell-polymorphic-cosine-function-to-f)的多态余弦函数：

```
let inline cosine n (x: ^a) = 
    let one: ^a = LanguagePrimitives.GenericOne
    Seq.initInfinite(fun i -> LanguagePrimitives.DivideByInt (- x*x) ((2*i+1)*(2*i+2)))
    |> Seq.scan (*) one
    |> Seq.take n
    |> Seq.sum 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-17T13:58:53.553

由于类型推断，您提供的示例函数仅适用于 int 类型；类型推断机制将自动推断 int 因为它看到了加法。如果你想为 float 和 long 制作相同的函数，你可以像 Pad 所说的那样做 inline 或者你可以这样做：

```
let sumFloat (a:float) b = a + b

let sumLong (a:int64) b = a + b 
```

但是*内联*是获得您正在寻找的通用“支持加法的任何类型”行为的正确机制。

# c# - 将任意数据从局部视图传递到布局视图

> ID：10192395
> 
> 赞同：1
> 
> 时间：2012-04-17T13:39:22.257
> 
> 标签：c#, asp.net, .net, asp.net-mvc-3

**更新**：似乎我试图在*局部*视图中设置 ViewBag 内容，而不是在*普通*视图中，MVC3 使得它很容易做到这一点。我仍然感兴趣为什么它不适用于部分视图，即为什么视图包不与部分视图共享。

我正在尝试使用`ViewData`/将部分视图中的一些数据传递到布局视图`ViewBag`

```
// Used in the partial view
public static void RequireAssets(this HtmlHelper helper, params Asset[] assets)
{
    var alreadyRequired = helper.ViewData["RequiredAssets"] as List<Asset>;
    if (alreadyRequired == null)
    {
        alreadyRequired = new List<Asset>();            
        helper.ViewData.Add("RequiredAssets", alreadyRequired);
    }

    foreach (var asset in assets.Where(anAsset => !alreadyRequired.Contains(anAsset)))
        alreadyRequired.Add(asset);
}

// Used in the layout view
public static MvcHtmlString RenderAssetStyles(this HtmlHelper helper)
{
    var requiredAssets = helper.ViewData["RequiredAssets"] as List<Asset>;
    return requiredAssets == null ? null : GetStyleSheets(requiredAssets.Select(e => new StyleSheet(e)).ToArray());
}

public static MvcHtmlString RenderAssetScripts(this HtmlHelper helper)
{
    var requiredAssets = helper.ViewData["RequiredAssets"] as List<Asset>;
    return requiredAssets == null ? null : GetScripts(requiredAssets.Select(e => new Script(e)).ToArray());
} 
```

问题是当在布局视图中触发 RenderAssetStyles/Scripts 时，`ViewData`不包含键“RequiredAssets”

**用法**

_Layout.cshtml：

```
<title>@ViewBag.Title</title>    
@Html.RenderAssetStyles() 
```

部分视图.cshtml：

```
@{ 
    Html.RequireAssets(Assets.Grid, Assets.FileUpload); 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T15:09:22.203

认为你做错了什么。无法复制你的努力。尝试检查 - 您的视图是否使用精确的这种布局。这一切都可以尝试创建可重现的简单示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T15:12:37.400

我无法重现这一点。我不得不简化你的代码并做出一些假设。但以下对我来说很好。

_Layout.cshtml

```
@using MyProject.Helpers
<title>@ViewBag.Title</title>    
@Html.RenderAssetStyles()
@Html.RenderAssetScripts()
@RenderBody() 
```

查看.cshtml

```
@using MyProject.Helpers
@{ 
    ViewBag.Title = "View";
    Html.RequireAssets(Asset.Grid, Asset.FileUpload);
    Layout = "~/Views/Shared/_Layout.cshtml";
} 
```

助手.cs

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Mvc;

namespace MyProject.Helpers
{
    public enum Asset
    {
        Grid=1,
        FileUpload=2
    }
    public static class Helper
    {

        public static void RequireAssets(this HtmlHelper helper, params Asset[] assets)
        {
            var alreadyRequired = helper.ViewData["RequiredAssets"] as List<Asset>;
            if (alreadyRequired == null)
            {
                alreadyRequired = new List<Asset>();
                helper.ViewData.Add("RequiredAssets", alreadyRequired);
            }

            foreach (var asset in assets.Where(anAsset => !alreadyRequired.Contains(anAsset)))
                alreadyRequired.Add(asset);
        }

        // Used in the layout view
        public static MvcHtmlString RenderAssetStyles(this HtmlHelper helper)
        {
            var requiredAssets = helper.ViewData["RequiredAssets"] as List<Asset>;
            return requiredAssets == null ? null : MvcHtmlString.Create("Test Style");
        }

        public static MvcHtmlString RenderAssetScripts(this HtmlHelper helper)
        {
            var requiredAssets = helper.ViewData["RequiredAssets"] as List<Asset>;
            return requiredAssets == null ? null : MvcHtmlString.Create("Test Script");
        }
    }

} 
```

# css - 奇怪的 CSS 问题 -标签中的文本被“下推”

> ID：10192398
> 
> 赞同：0
> 
> 时间：2012-04-17T13:39:38.563
> 
> 标签：css, wordpress

 我有一个奇怪的问题。 

在我的页面上，[http://radiovalerie.org/](http://radiovalerie.org/) - 包含在超链接标签中的文本被略微向下推，好像它应用了一些额外的“行高”属性，但我不知道这个属性在哪里在 CSS 中被调用。

示例：页面右侧的“通过 → iTunes • Winamp • WindowsMedia 收听”。“Listen via”部分是正常的，但是一旦超链接开始出现在它之后，就好像它们具有不同的行高。

我已经直接梳理了网站的 .css 文件，并使用 Chrome 的元素检查器窥探了代码，但我似乎无法找到导致超链接文本看起来略微偏离的罪魁祸首。

有人有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T13:48:01.087

您的 reset.css 第 20 行包括

```
vertical-align: middle; 
```

当我在 Safari 元素检查器中取消此行时，有问题的文本跳回与“Listen via ...”一致。

您可以通过添加来覆盖它

```
vertical-align: top; 
```

进入 style.css，在第 166 行开始的块中。

最初的问题很可能是由该字体中标准文本的高度`<a>`与应用了重置 css 的元素高度的差异引起的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T13:51:08.003

在你的第 20 行`reset.css`你有

```
vertical-align: middle; 
```

这就是文本被推送的原因。

简单地将其删除或更改为`top`您的链接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T13:49:27.357

在 FireFox 中，链接显示比文本*略高。*禁用 style.css 中 a 标签的底部填充会使它们向下移动到与文本相同的位置。

在 Chrome 中，禁用`vertical-align: middle`reset.css 似乎可以解决问题。这似乎是一个奇怪的 CSS 重置设置。同样的更改还修复了 FireFox 中的显示而不更改填充。

考虑到 Chrome 和 FireFox 在显示上的细微差别，您可能需要考虑使用不同的 CSS 重置。

# wpf - 如果不指定祖先，绑定将不起作用

> ID：10192404
> 
> 赞同：3
> 
> 时间：2012-04-17T13:39:45.610
> 
> 标签：wpf, binding, mvvm, combobox

如果我指定祖先，则下面的组合框绑定有效，否则无效。如果我不指定祖先，为什么它不起作用？

```
<wpftoolkit:DataGrid Grid.Row="4" Grid.Column="1" Grid.ColumnSpan="2"
                         Margin="5"
                         BorderBrush="#A6A6A6"
                         BorderThickness="1"
                         ItemsSource="{Binding DebitListing}"
                         AutoGenerateColumns="False"
                         SelectionMode="Single">
        <wpftoolkit:DataGrid.Columns>
            <wpftoolkit:DataGridComboBoxColumn
                Header="{Resx ResxName=MyBooks.Properties.Strings, Key=PartyListing_Party_Label}"
                SelectedItemBinding="{Binding Party, ValidatesOnDataErrors=True}"
                DisplayMemberPath="Name">

                <wpftoolkit:DataGridComboBoxColumn.ElementStyle>
                    <Style TargetType="{x:Type ComboBox}">
                        <Setter Property="ItemsSource" Value="{Binding Path=DataContext.CreditedAccounts, RelativeSource={RelativeSource AncestorType={x:Type UserControl}}}" />
                    </Style>
                </wpftoolkit:DataGridComboBoxColumn.ElementStyle>
                <wpftoolkit:DataGridComboBoxColumn.EditingElementStyle>
                    <Style TargetType="{x:Type ComboBox}">
                        <Setter Property="ItemsSource" Value="{Binding Path=DataContext.CreditedAccounts, RelativeSource={RelativeSource AncestorType={x:Type UserControl}}}" />
                    </Style>
                </wpftoolkit:DataGridComboBoxColumn.EditingElementStyle>

            </wpftoolkit:DataGridComboBoxColumn>

            <wpftoolkit:DataGridTextColumn
                Header="{Resx ResxName=MyBooks.Properties.Strings, Key=PartyListing_Amount_Label}"
                Binding="{Binding Amount, ValidatesOnDataErrors=True}"/>
        </wpftoolkit:DataGrid.Columns>
    </wpftoolkit:DataGrid> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T14:05:11.473

您需要引用从中获取所需 DataContext 的祖先的原因是因为`wpftoolkit`更改了其呈现的子元素上的 datacontext。您会发现几乎所有 ListView/DataGrid 控件都是如此——子元素 DataContext 被更改为引用当前行或列所代表的集合项。如果您希望这些子元素的模板或样式中的某些内容基于控件的 DataContext 之外的属性，则需要使用`RelativeSource Ancestor`它来获取它。

我知道这很令人困惑，因为在基本 XAML 中，子元素总是自动继承其父元素的数据上下文，但 DataContext 就像任何其他 DependencyProperty 一样，复杂的控件可以根据需要对其进行不同的设置。

如果愿意，可以通过给父控件（或设置 DataContext 的任何元素）一个名称来简化语法，例如`x:Name='ControlRoot'`. 然后，当您需要返回根数据上下文时，您只需执行以下操作：

```
Value="{Binding ElementName=ControlRoot, Path=DataContext.CreditedAccounts}" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T13:51:22.257

你的绑定必须指定哪个祖先的原因是每次你指定一个数据上下文（或者在这种情况下`ItemsSource`你的上`DataGrid`，它隐藏它的父级的数据上下文。你的组合框无权访问上面任何内容布局层次结构中的网格。要克服此限制，您可以指定要用于数据上下文的祖先。

# wordpress - Wordpress 两个类别循环，在起始页上具有粘性。分页错误

> ID：10192410
> 
> 赞同：0
> 
> 时间：2012-04-17T13:40:18.823
> 
> 标签：wordpress, pagination, sticky

希望你们能帮助我。

我有来自一类的两个非常简单的自定义循环：一个是粘性的，一个是非粘性的。我希望粘性帖子仅显示在第一页上，而不是在我分页时显示在其余页面上。每页还必须有 8 个帖子（包括第 1 页上的 Sticky 帖子）。所有这一切都适用于我在下面得到的代码。

问题是这样的：第一页：1 粘性和帖子 #15-9 **，**第二页：帖子 # **7** -1。由于粘性帖子，WP 在第二页上跳过了一个帖子（#8）。有人对此有解决方案吗？我将非常感谢您的帮助。

```
<!-- Sticky -->
<?php if ( $paged != True ): ?>
    <?php $wp_query = new WP_Query(array('post__in' => get_option('sticky_posts'), 'category_name' => Work)); ?>
        <?php while ($wp_query->have_posts()) : $wp_query->the_post(); ?>
            <?php get_template_part( 'loop', 'index' ); ?>
        <?php endwhile; ?>
    <?php wp_reset_postdata(); // reset the query ?>
<?php endif ?>

<?php 
$postcount = $wp_query->post_count; 
$postnumber = 8; 
if ( $paged != True ){ $postnumber = $postnumber - $postcount; }
?>

<!-- Non-Sticky -->
<?php $wp_query = new WP_Query(array('post__not_in' => get_option('sticky_posts'), 'category_name' => Work, 'posts_per_page' => $postnumber, 'paged' => $paged)); ?>
    <?php while ($wp_query->have_posts()) : $wp_query->the_post(); ?>
        <?php get_template_part( 'loop', 'index' ); ?>
    <?php endwhile; ?>
<?php wp_reset_postdata(); // reset the query ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T14:27:49.470

在这里查看我对类似问题的回答： [post_nav_link 导航可以与 WordPress 自定义页面模板一起使用吗？](https://stackoverflow.com/questions/10121230/can-post-nav-link-navigation-work-with-wordpress-custom-page-templates/10139530#10139530)
关键是`offset`

# java - 在我的 Android 应用程序中通过蓝牙接收数据的问题

> ID：10192417
> 
> 赞同：0
> 
> 时间：2012-04-17T13:40:34.273
> 
> 标签：java, android, bluetooth

对于今年夏天的机器人考试，我正在构建一个机器人，我想通过蓝牙与 Android 设备进行通信。为此，我正在编写自己的 Android 应用程序。*我发送*数据没有问题，但是我无法*接收*数据。我用于接收数据的代码不起作用，如下所示：

```
 new Thread(new Runnable() {
        public void run(){
            byte[] buffer = new byte[1024]; //Buffer for the incoming message
            int bytes; 
            TextView afstandsTekst = (TextView)findViewById(R.id.afstandsText);
            //Listen to the InputStream
            while(true){
                try {
                    if(mmInStream.available() != 0)
                    try {
                        bytes = mmInStream.read(buffer); //Read from the InputStream. This is where the app crashes.
                    }
                    catch(IOException e){
                        // TODO Auto-generated catch block
                        e.printStackTrace();
                    }
                } catch (IOException e) {
                    // TODO Auto-generated catch block
                    break;
                }
                afstandsTekst.setText(String.valueOf(bytes));
            }
        }
    }).start(); 
```

该应用程序崩溃在

```
 bytes = mmInStream.read(buffer); 
```

我不明白为什么。我已经在 Android Developers 使用蓝牙页面寻求帮助（http://developer.android.com/guide/topics/wireless/bluetooth.html#ManagingAConnection），并尝试*完全*按照他们的方式进行操作，但仍然崩溃，这就是为什么我现在尝试了上面粘贴的代码。此外，即使应用程序在正常运行时崩溃，当我选择在三星 Galaxy Nexus 上的 Eclipse 中调试它时，应用程序也不会崩溃，我不知道为什么。

这是我在这个论坛的第一篇文章，我非常希望那里有人能给出答案。提前致谢！

编辑：这是完整的代码：

```
 package skole.migogjesper.hospitalsseng;

    import java.io.IOException;
    import java.io.InputStream;
    import java.io.OutputStream;
    import java.lang.reflect.Method;
    import java.util.Set;

    import android.app.Activity;
    import android.bluetooth.BluetoothAdapter;
    import android.bluetooth.BluetoothDevice;
    import android.bluetooth.BluetoothSocket;
    import android.bluetooth.BluetoothClass.Device;
    import android.content.BroadcastReceiver;
    import android.content.Context;
    import android.content.Intent;
    import android.content.IntentFilter;
    import android.os.Bundle;
    import android.view.View;
    import android.widget.AdapterView;
    import android.widget.AdapterView.OnItemClickListener;
    import android.widget.ArrayAdapter;
    import android.widget.CheckBox;
    import android.widget.ListView;
    import android.widget.TextView;
    import android.widget.Toast;

    public class HospitalssengActivity extends Activity {
    private String address = "00:06:66:45:B8:DB";
        private static final int REQUEST_ENABLE_BT = 3;
        protected static final String EXTRA_DEVICE_ADDRESS = null;
        IntentFilter filter = new IntentFilter(BluetoothDevice.ACTION_FOUND);
        public ArrayAdapter<String> mArrayAdapter;
        BluetoothAdapter mBluetoothAdapter = BluetoothAdapter.getDefaultAdapter();                 //Indlæser bluetooth modulet i enheden.
        private BluetoothDevice mmDevice = mBluetoothAdapter.getRemoteDevice(address);
        private OutputStream mmOutStream;
        private InputStream mmInStream;
        private char stueDestination = '0';
        private char scannerDestination = '1';
        private char operationsstueDestination = '2';
        private char krematorieDestination = '3';
        private char xrayDestination = '4';
        private char planlagtStueDestination = 'q';
        private char planlagtScannerDestination = 'w';
        private char planlagtOperationsstueDestination = 'e';
        private char planlagtKrematorieDestination = 'r';
        private char planlagtXrayDestination = 't';
        private byte sendByte;

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    if(mBluetoothAdapter == null){ //Tjekker om bluetooth er underst¯ttet.
        Toast.makeText(HospitalssengActivity.this, "Enheden understøtter ikke bluetooth", Toast.LENGTH_LONG).show();
    }
    if(!mBluetoothAdapter.isEnabled()){ //Tjekker om bluetooth er tÊndt.
        Intent enableBtIntent = new Intent (BluetoothAdapter.ACTION_REQUEST_ENABLE);
        startActivityForResult(enableBtIntent, REQUEST_ENABLE_BT);
    }
    new Thread(new Runnable() {
        public void run(){
            byte[] buffer = new byte[1024]; //Buffer til den indkommende besked
            int bytes; //Bytes der kommer fra read()
            TextView afstandsTekst = (TextView)findViewById(R.id.afstandsText);
            //Lyt efter InputStream indtil der sker en exception
            while(true){
                try {
                    if(mmInStream.available() != 0)
                    try {
                        bytes = mmInStream.read(buffer); //Læs fra InputStream
                    }
                    catch(IOException e){
                        // TODO Auto-generated catch block
                        e.printStackTrace();
                    }
                } catch (IOException e) {
                    // TODO Auto-generated catch block
                    break;
                }
                //afstandsTekst.setText(String.valueOf(bytes));
            }
        }
    }).start();
}

private BluetoothSocket mmSocket;

public void Connect(BluetoothDevice device){
    BluetoothSocket tmp = null; //Dette er er et midlertidigt objekt, som senere bliver assigned til mmSocket.
    mmDevice = device;

    try { //Få en BluetoothSocket, som kan bruges til at forbinde med en BluetoothDevice
        Method m = device.getClass().getMethod("createRfcommSocket", new Class[] {int.class});
        tmp = (BluetoothSocket) m.invoke(device, 1);
    } catch(Exception e) {
        Toast.makeText(HospitalssengActivity.this, "FEJL!", Toast.LENGTH_LONG).show();
    }
    mmSocket = tmp;
    try{  //Forbind enheden gennem socket'en. Dette blokerer indtil den er succesfuld eller den fejler.
        mmSocket.connect();
    } catch (IOException connectException) {
        try{mmSocket.close();}  //Fejlet forbindelse. Luk socket'en og hop ud af metoden.
        catch(IOException closeException) {}
        return;
    }
}

public void cancel(){ //Lukker en forbindelse og lukker socket'en.
    try{mmSocket.close();}
    catch(IOException e) {}
}

public void write(byte sendByte){
    try {
        mmOutStream = mmSocket.getOutputStream();
        mmOutStream.write(sendByte);
        Toast.makeText(HospitalssengActivity.this, "Sendt", Toast.LENGTH_SHORT).show();
    }
    catch (IOException e) {}
}

public void scanKnap(View view){
    Connect(mmDevice);
}

public void afbrydKnap(View view){
    cancel();
}

public void stueKnap(View view){
    CheckBox planlagtCheck = (CheckBox) findViewById(R.id.planlagtCheck);
    if(!planlagtCheck.isChecked()){
        sendByte = (byte) stueDestination;
        write(sendByte);
    }
    if(planlagtCheck.isChecked()){
        sendByte = (byte) planlagtStueDestination;
        write(sendByte);
    }
}

public void scannerKnap(View view){
    CheckBox planlagtCheck = (CheckBox) findViewById(R.id.planlagtCheck);
    if(!planlagtCheck.isChecked()){
        sendByte = (byte) scannerDestination;
    write(sendByte);
    }
    if(planlagtCheck.isChecked()){
        sendByte = (byte) planlagtScannerDestination;
        write(sendByte);
    }
}

public void operationsstueKnap(View view){
    CheckBox planlagtCheck = (CheckBox) findViewById(R.id.planlagtCheck);
    if(!planlagtCheck.isChecked()){
        sendByte = (byte) operationsstueDestination;
        write(sendByte);
    }
    if(planlagtCheck.isChecked()){
        sendByte = (byte) planlagtOperationsstueDestination;
        write(sendByte);
    }
}

public void krematorieKnap(View view){
    CheckBox planlagtCheck = (CheckBox) findViewById(R.id.planlagtCheck);
    if(!planlagtCheck.isChecked()){
        sendByte = (byte) krematorieDestination;
        write(sendByte);
    }
    if(planlagtCheck.isChecked()){
        sendByte = (byte) planlagtKrematorieDestination;
        write(sendByte);
    }
}

public void xrayKnap(View view){
    CheckBox planlagtCheck = (CheckBox) findViewById(R.id.planlagtCheck);
    if(!planlagtCheck.isChecked()){
        sendByte = (byte) xrayDestination;
        write(sendByte);
    }
    if(planlagtCheck.isChecked()){
        sendByte = (byte) planlagtXrayDestination;
        write(sendByte);
    }
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T12:37:04.890

# 你不应该使用线程。

将 Service 用于后台内容，对于线程使用 ASyncTask 而不是 Thread！

提示：您可以在服务和活动之间进行**本地**广播！（您必须为此导入 android 支持库（请参阅 LocalBroadcast）。

Android 已经意味着操作系统位于另一个操作系统（Linux）之上。您不需要自己处理线程通信，让 Android 来处理！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T14:56:46.910

如果它在调试器中运行而不是通常听起来像一个竞争条件。似乎在多个线程中可用的唯一变量是 mmInStream。你在这个线程之外对 mmInStream 做了什么？

竞争条件是两个线程都可以访问共享的可变状态（在本例中为 mmInStream）。有时一个线程获胜，您会看到一个结果，而另一次另一个线程获胜，您会看到另一个结果。这些东西可能很难调试。

您可以在创建线程的位置发布代码吗？

查看您发布的代码，我看不到 mmInstream 的初始化位置。这将导致您报告的空指针异常，但它也会在调试器中发生（除非该线程从未运行）。

# jquery - 单击带有jquery的链接时更改div内容？

> ID：10192418
> 
> 赞同：0
> 
> 时间：2012-04-17T13:40:34.290
> 
> 标签：jquery

我有一个 jplayer 音乐播放器，它的播放列表可以正常工作，现在我希望能够在单击链接时将第一个 myPlaylist1 更改为 myPlaylist2。

将第一个播放列表 myPlaylist1 加载到 div #theplayer 的函数如下所示。

```
$(document).ready(function(){
    var description = 'Some description. ';

    $('#theplayer').ttwMusicPlayer(myPlaylist1, {
        autoPlay:false, 
        description:description,
        currencySymbol:'Kr ',
        buyText:'K&Ouml;P',
        tracksToShow:50,
        jPlayer:{
            swfPath:'http://www.mypage.com/music_player/jquery-jplayer' //You need to override the default swf path any time the directory structure changes
        }
    }); 
```

当我点击一个链接时，我想将上面的内容更改为下面的 myPlaylist2：

```
 $('#theplayer').ttwMusicPlayer(myPlaylist2, {
        autoPlay:false, 
        description:description,
        currencySymbol:'Kr ',
        buyText:'K&Ouml;P',
        tracksToShow:50, 
        jPlayer:{
            swfPath:'http://www.mypage.com/music_player/jquery-jplayer' //You need to override the default swf path any time the directory structure changes
        }
    }); 
```

有了这个，我希望将显示 playlist2 而不是 playlist1？

页面加载时加载的播放列表如下所示：

```
var myPlaylist1 = [
    {
        mp3:'http://www.www.mypage.com/music_player/mix/1.mp3',
        title:'Love The Way You Lie',
        artist:'Eminem',
        buy:'#',
        price:'12',
        cover:'http://www.mypage.com/music_player/images/1.jpg'
     }  
]; 
```

当点击链接时，我喜欢将播放列表更改为此。

```
 var myPlaylist2 = [
        {
            mp3:'http://www.www.mypage.com/music_player/mix/2.mp3',
            title:'Hey you',
            artist:'Madonna',
            buy:'#',
            price:'12',
            cover:'http://www.mypage.com/music_player/images/2.jpg'
         }  

]; 
```

或者，如果您对如何更改播放列表有任何其他建议？

任何输入都非常感谢，谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T08:11:54.140

创建一个 ID 为“pl_changer”的链接

并且应该按照您的要求执行以下操作：

```
<script>

$(document).ready(function(){
  $("#pl_changer").click(function(){
    $('#theplayer').ttwMusicPlayer(myPlaylist2, {
        autoPlay:false, 
        description:description,
        currencySymbol:'Kr ',
        buyText:'K&Ouml;P',
        tracksToShow:50, 
        jPlayer:{
            swfPath:'http://www.mypage.com/music_player/jquery-jplayer' //You need to override the default swf path any time the directory structure changes
        }
    });
  });
});

</script> 
```

# asp.net - ASHX 图像处理程序在 ie 中不工作，在 firefox 和 chrome 中工作

> ID：10192420
> 
> 赞同：2
> 
> 时间：2012-04-17T13:40:49.233
> 
> 标签：asp.net, updatepanel, httphandler

我将图像存储在数据库中，并使用图像处理程序使用文件路径 + id 显示图像。我遇到的问题是当我通过页面更新图像时，图像不会改变。奇怪的是，我对 Firefox 或 chrome 没有这个问题。

ASHX 处理程序

```
public void ProcessRequest(HttpContext context)
    {
        Guid image_id;
        if (context.Request.QueryString["id"] != null)
            image_id = System.Guid.Parse(context.Request.QueryString["id"]);
        else
            throw new ArgumentException("No parameter specified");

        context.Response.ContentType = "image/jpeg";
        Stream strm = GetImageFromDatabase(image_id);
        if (strm != null)
        {
            byte[] buffer = new byte[4096];
            int byteSeq = strm.Read(buffer, 0, 4096);

            while (byteSeq > 0)
            {
                context.Response.OutputStream.Write(buffer, 0, byteSeq);
                byteSeq = strm.Read(buffer, 0, 4096);
            }
            //context.Response.BinaryWrite(buffer);
        }
    } 
```

用户控制代码

```
string imagePath = "<a href=" + (Image.ImageUrl = "~/ShowImage.ashx?id=" + r["Image_id"]); 
```

标记

```
<asp:UpdatePanel ID="Upd1" runat="server" UpdateMode="Always" >
    <ContentTemplate>
        <div id="mpe" style="width: 600px; padding: 5px;">
            <uc2:IMG ID="IMG1" cssclass="bodycopy" runat="server" />
        </div>
        <asp:UpdateProgress ID="upp1" runat="server" AssociatedUpdatePanelID="Upd1">
            <ProgressTemplate>
                <div id="progressBackgroundFilter">
                </div>
                <div id="modalPopup">
                    &nbsp; &nbsp; Loading...
                    <img align="middle" src="../images/Ajax/loading_1.gif" />
                </div>
            </ProgressTemplate>
        </asp:UpdateProgress>
    </ContentTemplate>
</asp:UpdatePanel> 
```

我不确定要发布哪些其他代码，但这是我认为相关的内容。当我单击按钮更新图像时，它成功更新了数据库中的行。我还可以更新有关图像的数据，并且可以正确更新。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T12:17:32.173

如果 URL 没有改变，IE 会缓存数据并显示相同的数据。我也面临同样的问题，并使用以下技巧将其删除：-

```
imgUser.ImageUrl = "Handler.ashx?UserID=" + Convert.ToString(Session["userid"]) + "extraQS=" + DateTime.Now.Second; 
```

带有 DateTime.Now.Second 的 extraQS 查询字符串将通过使 URL 动态化来达到目的，因此 URL 将在每次请求时更改，并且不会从浏览器缓存中使用图像。

**注意： - 忽略 Handler.ashx 中额外的查询字符串参数。**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T14:24:29.483

您可以尝试使用此代码吗？

```
string imagePath = "<a href='" + Page.ResolveClientUrl("~/ShowImage.ashx?id=" + r["Image_id"]) + "' />"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-27T13:47:41.393

我最终做的是在我的图像处理程序中使用一个 guid 作为我的图像 id。但是在我的 SQL 中，当我更新图像时，我使用 sql 服务器内置的 newid() 函数，因此每次进行更新时，图像 guid 都会发生变化。通过这样做，IE 识别出它的 ID 不同，并且不使用缓存的图像。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-11-29T05:53:02.573

该问题可以通过在 QueryString 末尾添加当前秒数或随机数来解决。它适用于 IE。

```
string imagePath = "<a href=" + (Image.ImageUrl = "~/ShowImage.ashx?id=" + r["Image_id"] + "&timeInSec="+ DateTime.Now.Second); 
```

> 返回图像 URL 的另一个示例

```
protected string getImageURL(int index)
        {
            return  "ImageHandler.ashx?index=" + index + "&timeInSec=" + DateTime.Now.Second;
        } 
```

# rest - REST 执行操作

> ID：10192424
> 
> 赞同：2
> 
> 时间：2012-04-17T13:40:57.410
> 
> 标签：rest

我正在设计一个 REST API，我需要让客户端能够复制资源。例如，假设您有以下资源：customer/{customerno}/address

您将为客户提供将地址复制到 shippingaddress 的功能。我可以这样做：customer/{customerno}/address/copytoshipping

但那将是 RPC 而不是 REST。做这样的事情的正确方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T16:33:02.717

是否必须在 REST API 中？客户端可以只获取（帐单？）地址的表示并将其放入送货地址。是的，您可能会在客户端代码中隐藏这些细节（这对我来说似乎很合理），但是没有特别的理由用特殊操作来混淆 REST 接口来进行复制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T14:02:04.973

使用 Rel="CustomerAddress" 获取地址

POST 使用 Rel="CustomerShippingAddress" 示例 URL customer/{customerno}/address/shipping

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T17:48:17.413

一种不同的方法可能是：

*   公开“客户地址”的资源（如上所述）

    `GET /customer/{number}/address`

*   公开“客户送货地址”获取的资源：

    `GET /customer/{number}/shipping-address`

*   更新实际地址：

    ```
    PUT /customer/{number}/shipping-address
    Content-Type: application/xml  
    (xml/json of a single address) 
    ```

*   使用指向另一个地址的 URI 指针更新

    ```
    PUT /customer/number/shipping-address HTTP/1.1
    Content-Type: application/atom+xml
    (xml/json of an atom:link with href pointer to main address ('/customer/123/address') 
    ```

也许比您想要的更复杂，但会将复制负担放在服务器而不是客户端上。

# c# - Windows 8 Metro 中的 WebClient、Zip、隔离存储

> ID：10192428
> 
> 赞同：1
> 
> 时间：2012-04-17T13:41:17.950
> 
> 标签：c#, windows-8, microsoft-metro, .net-4.5

我有一个相当复杂的场景，我尝试从 Windows Phone 7 移植到 Windows 8。

我需要

1.  从 Internet 下载 Zip 文件
2.  解压到隔离存储
3.  读取解压后的 xml 文件和图片

问题

1.  在 Windows Phone 7 中，我使用了在 Windows 8 中不再可用的 WebClient。我尝试了 HttpClientHandler 但我只能将 ZIP 文件作为字符串下载，而且我不知道如何将其保存到独立存储中。

2.  我找到了 ZipArchive 类，但它需要一个 IO.Stream 并且我不确定如何使用它（如果我将文件保存在一些地方 - 第 1 点）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T13:59:02.533

我也刚开始使用新的 API（所以这可能有点偏离），但基于文档：

*   [`HttpClient`](http://msdn.microsoft.com/en-us/library/system.net.http.httpclient%28v=vs.110%29.aspx)（它是默认处理程序[`HttpClientHandler`](http://msdn.microsoft.com/en-us/library/system.net.http.httpclienthandler%28v=vs.110%29.aspx)）[`Task<HttpResponseMessage>`](http://msdn.microsoft.com/en-us/library/system.net.http.httpresponsemessage%28v=vs.110%29.aspx)从[`SendAsync`](http://msdn.microsoft.com/en-us/library/hh138176%28v=vs.110%29.aspx).
*   有[`HttpResponseMessage`](http://msdn.microsoft.com/en-us/library/system.net.http.httpresponsemessage%28v=vs.110%29.aspx)一个属性，[`Content`](http://msdn.microsoft.com/en-us/library/system.net.http.httpresponsemessage.content%28v=vs.110%29.aspx)它的类型是[`HttpContent`](http://msdn.microsoft.com/en-us/library/system.net.http.httpcontent%28v=vs.110%29.aspx)。
*   [`HttpContent`](http://msdn.microsoft.com/en-us/library/system.net.http.httpcontent%28v=vs.110%29.aspx)反过来有一个方法，[`ReadAsStreamAsync`](http://msdn.microsoft.com/en-us/library/system.net.http.httpcontent.readasstreamasync%28v=vs.110%29.aspx)，它返回[`Task<Stream>`](http://msdn.microsoft.com/en-us/library/system.io.stream%28v=vs.110%29.aspx)您应该能够使用（尽管是间接地）传递给[`ZipArchive`](http://msdn.microsoft.com/en-us/library/system.io.compression.ziparchive%28v=vs.110%29.aspx).

**或者**您可以只使用该[`HttpClient.GetStreamAsync`](http://msdn.microsoft.com/en-us/library/hh551738%28v=vs.110%29.aspx)方法来获取流（更简单）：

```
HttpClient client = new HttpClient();
Stream stream = await client.GetStreamAsync(uri); 
```

[~~如果这不起作用，那么您也可以将现在获得的字符串包装在 a 中[`MemoryStream`](http://msdn.microsoft.com/en-us/library/system.io.memorystream.aspx)并将其传递给，[`ZipArchive`](http://msdn.microsoft.com/en-us/library/system.io.compression.ziparchive%28v=vs.110%29.aspx)但这听起来有点不安全，因为可能存在编码问题。~~]

# javascript - 数据在数据表的初始化时消失

> ID：10192429
> 
> 赞同：0
> 
> 时间：2012-04-17T13:41:19.307
> 
> 标签：javascript, jquery, datatable, dynamic-tables

我正在使用 dataTable 插件 ( [datatable](http://datatables.net/index) ) 来管理我的 HTML 表格。

但是，当我调用这个插件的init时，我表的数据……消失了！为什么？

我不知道，我已经使用过这个方法，我从来没有遇到过这个问题！有人可以帮助我吗？

对 init 的调用是：

```
jQuery('#measure').dataTable( {
    "bDestroy": true,  //using this because I call this init many times
    "aoColumnDefs": [
        { "bSortable": false, "aTargets": [ 0 ] },
        { "bSortable": false, "bSearchable": false, "bVisible": false, "aTargets": [ 3,4,8,9,10,11,12,13,14,15,16,17 ] },
    ],
    "aaSorting": [[5, 'asc']]
}); 
```

如果我在这段代码之前在 JS 中使用阻塞警报来查看发生了什么，我可以看到包含正确数据的表。在此之后，我什至看不到来自 HTML 控制台的数据，比如 firebug。

编辑：

也许问题出在 bDestroy 上？我想每次在表中插入一行，每次我回忆这个 init 方法

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T09:51:03.593

我得到了它！:)

我动态添加数据...我的问题是我每次添加一行时都会调用数据表的init...

如果要动态添加数据，只需调用一次 init 方法，然后使用 datatable API 来添加/更新/删除表中的数据！;)

# css - CSS 透视错误

> ID：10192432
> 
> 赞同：1
> 
> 时间：2012-04-17T13:41:32.940
> 
> 标签：css, css-transforms

当尝试应用带有透视的 CSS 变换时，我遇到了一个奇怪的故障，即 div 的上半部分是不可选择的。我在[jsfiddle上创建了一个快速演示](http://jsfiddle.net/dG4kx/)

[顶部选择的红色框应该是可点击的等]

有谁知道如何解决这一问题？我查看了其他类似的错误，但他们的解决方案似乎在这里不起作用。

干杯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T19:46:19.503

这应该可以解决问题

```
.ca-item { 
-webkit-transform: skewX(-5deg) scale(1, 1);
-moz-transform: skewX(-5deg) scale(1, 1);
-ms-transform: skewX(-5deg) scale(1, 1);
transform: skewX(-5deg) scale(1, 1);
background-color: blue;
position:relative;
width:1060px;
height:550px;
text-align:center;
} 
```

# firefox-addon - 以编程方式显示 options.xul

> ID：10192434
> 
> 赞同：2
> 
> 时间：2012-04-17T13:41:37.170
> 
> 标签：firefox-addon, xul

我有一个基于 xul 覆盖的 Firefox 插件，它可以工作。它在 content/options.xul 中定义了内联选项，当用户转到 Firefox->Add-ons->Extensions->{The Name of My Extension}->Options 时，它们会正确显示/运行

问题是，我可以在我的加载项上创建一个按钮，通过单击将用户带到 Firefox->Add-ons->Extensions->{The Name of My Extension}->Options 来启动我的选项，或者通过启动基于 options.xul 的对话框？

现在，我正在维护一个单独的 options.html 和 options.js，当用户通过 Firefox 按钮导航到那里时，它们获取和设置与 options.xul 处理的相同设置，但我更愿意转储 options.html 和 options.js 并且仅维护我的 main.js 和 options.xul。

任何评论或代码示例将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T16:09:15.070

`BrowserOpenAddonsMgr()`这是通过浏览器窗口中定义的全局函数最容易做到的，如下所示：

```
BrowserOpenAddonsMgr("addons://detail/" + encodeURIComponent(addonID)); 
```

此功能负责关注现有的附加组件选项卡（如果有一个或打开一个新选项卡）。它不会向下滚动到选项，但是如果附加组件的描述很长，这是一个问题。从 Firefox 12 开始，这可以通过在视图标识符中添加“/preferences”来解决：

```
BrowserOpenAddonsMgr("addons://detail/" + encodeURIComponent(addonID) + "/preferences"); 
```

对于较旧的 Firefox 版本，您将不走运（并且您不应该在此处使用此后缀，它不起作用）。另一个问题是加载项管理器获取所有扩展的元数据可能会有一个冗长的“加载”阶段。

# android - 城市飞艇坠毁应用

> ID：10192435
> 
> 赞同：3
> 
> 时间：2012-04-17T13:41:40.793
> 
> 标签：android, push, noclassdeffounderror, urbanairship.com

尝试在我的 Android 应用程序中集成 Urban Airship PUSH 通知时遇到问题。

我认为我在 AndroidManifest 集中获得了所有权限和意图过滤器，但是在尝试像这样设置我的 AirshipConfigOptions 后应用程序立即崩溃：

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    AirshipConfigOptions options = AirshipConfigOptions.loadDefaultOptions(this);
    ...
} 
```

我的错误日志说：

```
java.lang.NoClassDefFoundError: com.urbanairship.AirshipConfigOptions 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-17T13:43:57.300

你在使用 ProGuard 吗？请参阅[这篇关于配置 ProGuard 以与 UrbanAirship 一起使用的文章](https://support.urbanairship.com/customer/portal/articles/241918-deploying-your-android-app-with-proguard)。

您使用的是 ADT r17 或更高版本吗？从 r17 开始，jar 文件需要位于“libs”文件夹中，将它们放在“lib”中将不起作用（即使 Eclipse 表示没有问题）。请参阅[这篇关于 Android 项目中的依赖项的文章](http://tools.android.com/recent/dealingwithdependenciesinandroidprojects)。

# java - 从java中用空格分隔的文件中读取整数

> ID：10192438
> 
> 赞同：1
> 
> 时间：2012-04-17T13:41:47.300
> 
> 标签：java

包含整数的输入文件将如下所示：

```
 5 2 3 5
     2 4 23 4 5 6 4 
```

那么我将如何阅读第一行，用空格分隔并将这些数字添加到 Arraylist1。然后读取第二行，用空格分隔并将数字添加到 ArrayList2 等等。（所以 Arraylist1 将包含 [5,2,3,5] 等）

```
 FileInputStream fstream = new FileInputStream("file.txt");
    DataInputStream in = new DataInputStream(fstream);
    BufferedReader br = new BufferedReader(new InputStreamReader(in));
    String data;
    while ((data = br.readLine()) != null)   {
      //How can I do what I described above here?
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T13:44:21.277

在家工作？

你可以使用这个：

```
String[] tmp = data.split(" ");    //Split space
for(String s: tmp)
   myArrayList.add(s); 
```

或者你看看 Scanner 类。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T13:45:45.607

考虑使用一个`StringTokenizer`

一些帮助：[字符串标记器](http://www.java-samples.com/showtutorial.php?tutorialid=236)

```
StringTokenizer st = new StringTokenizer(in, "=;"); 
while(st.hasMoreTokens()) { 
String key = st.nextToken(); 
String val = st.nextToken(); 
System.out.println(key + "\t" + val); 
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T13:43:38.330

你可以从 中得到一个标准数组`data.split("\\s+");`，它会给你 int[]。您需要一些额外的东西才能将不同的行放入不同的列表中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-07-08T23:34:48.180

在我尝试了 HectorLector 提供的答案后，它在某些特定情况下不起作用。所以，这是我的：

```
String[] tmp = data.split("\\s+"); 
```

这使用正则表达式

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-17T14:52:29.263

您需要的是类似`ArrayList of ArrayList`. 你可以使用`data.split("\\s+");`java中的函数来获取String数组中一行中的所有元素，然后将这些元素放入ArrayLists的ArrayList的内部ArrayList中。对于下一行，您可以移动到外部 ArrayList 的下一个元素，依此类推。

# algorithm - 算法谜题面试

> ID：10192443
> 
> 赞同：47
> 
> 时间：2012-04-17T13:42:10.007
> 
> 标签：algorithm

我找到了这个面试问题，我想不出比 O(N^2 * P) 更好的算法：

> 给定一个 P 个自然数 (1,2,3,...,P) 的向量和另一个长度为 N 的向量，其元素来自第一个向量，找到第二个向量中最长的子序列，使得所有元素均匀分布（具有相同的频率）。

示例：(1,2,3) 和 (1, **2,1,3,2,1,3,1,2,3** ,1)。最长的子序列在区间 [2,10] 中，因为它包含第一个序列中频率相同的所有元素（1 出现 3 次，2 出现 3 次，3 出现 3 次）。

时间复杂度应该是 O(N * P)。

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2012-04-17T14:09:46.410

“子序列”通常意味着不连续。我将假设您的意思是“子列表”。

这是一个 O(NP) 算法~~，假设我们可以散列~~（不需要假设；我们可以改为基数排序）。扫描数组，为每个数字保留一个运行总计。对于你的例子，

```
 1  2  3
 --------
  0  0  0
1 
  1  0  0
2
  1  1  0
1
  2  1  0
3
  2  1  1
2
  2  2  1
1
  3  2  1
3
  3  2  2
1
  4  2  2
2
  4  3  2
3
  4  3  3
1
  5  3  3 
```

现在，通过减去最小元素来标准化每一行。结果是

```
 0: 000
 1: 100
 2: 110
 3: 210
 4: 100
 5: 110
 6: 210
 7: 100
 8: 200
 9: 210
10: 100
11: 200. 
```

准备两个哈希，将每一行映射到它出现的第一个索引和它出现的最后一个索引。遍历键并取最后一个最大的键 - 首先。

```
000: first is at 0, last is at 0
100: first is at 1, last is at 10
110: first is at 2, last is at 5
210: first is at 3, last is at 9
200: first is at 8, last is at 11 
```

最佳键是 100，因为它的子列表长度为 9。子列表是第 (1+1) 个元素到第 10 个元素。

这是因为当且仅当它的第一个和最后一个非标准化直方图相同直到添加一个常数时，子列表才是平衡的，当且仅当第一个和最后一个标准化直方图相同时才会发生这种情况。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-17T14:21:09.667

如果内存使用不重要，那很容易......

您可以给出矩阵维度并在**(i)**`N*p`列中保存与在**(i)**第二个向量中的第一个元素之间查看的元素数量相对应的值...**`p`**

 ****完成矩阵后，您可以搜索列`i`中所有元素`i`都不不同的列。最大`i`的就是答案。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-19T05:14:07.090

通过随机化，您可以将其归结为线性时间。这个想法是用一个随机整数替换每个 P 值，使得这些整数总和为零。现在寻找两个相等的前缀和。这允许一些误报的可能性很小，我们可以通过检查我们的输出来补救。

在 Python 2.7 中：

```
# input:
vec1 = [1, 2, 3]
P = len(vec1)
vec2 = [1, 2, 1, 3, 2, 1, 3, 1, 2, 3, 1]
N = len(vec2)
# Choose big enough integer B.  For each k in vec1, choose
# a random mod-B remainder r[k], so their mod-B sum is 0.
# Any P-1 of these remainders are independent.
import random
B = N*N*N
r = dict((k, random.randint(0,B-1)) for k in vec1)
s = sum(r.values())%B
r[vec1[0]] = (r[vec1[0]]+B-s)%B
assert sum(r.values())%B == 0
# For 0<=i<=N, let vec3[i] be mod-B sum of r[vec2[j]], for j<i.
vec3 = [0] * (N+1)
for i in range(1,N+1):
    vec3[i] = (vec3[i-1] + r[vec2[i-1]]) % B
# Find pair (i,j) so vec3[i]==vec3[j], and j-i is as large as possible.
# This is either a solution (subsequence vec2[i:j] is uniform) or a false
# positive.  The expected number of false positives is < N*N/(2*B) < 1/N.
(i, j)=(0, 0)
first = {}
for k in range(N+1):
    v = vec3[k]
    if v in first:
        if k-first[v] > j-i:
            (i, j) = (first[v], k)
    else:
        first[v] = k
# output:
print "Found subsequence from", i, "(inclusive) to", j, "(exclusive):"
print vec2[i:j]
print "This is either uniform, or rarely, it is a false positive." 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-17T14:18:33.243

这是一个观察：你不能得到一个`P`长度不是乘法的均匀分布的序列。这意味着您只需检查, , ... long 的子序列 -`N`这样的序列。`P``2P``3P``(N/P)^2`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-25T21:35:18.740

您可以通过增强 uty 的解决方案将其降低到 O(N) 时间，而不依赖于 P。

对于每一行，不是存储每个元素的规范化计数，而是存储规范化计数的哈希，同时仅保留当前索引的规范化计数。在每次迭代期间，您需要首先更新归一化计数，如果计数的每次递减在递增时支付，则其摊销成本为 O(1)。接下来，您重新计算哈希。这里的关键是散列需要在被散列的元组元素之一的递增或递减之后轻松更新。

[在这个问题](https://cstheory.stackexchange.com/questions/3390/is-there-a-hash-function-for-a-collection-i-e-multi-set-of-integers-that-has)的答案中显示了至少一种有效地进行这种散列的方法，并具有良好的理论独立性保证。请注意，计算指数以确定要添加到哈希的数量的 O(lg P) 成本可以通过预先计算以素数为模的指数来消除，预计算的总运行时间为 O(P)，给出总O(N + P) = O(N) 的运行时间。****

# python - Visual Basic 开发人员想要编写 Linux 应用程序

> ID：10192444
> 
> 赞同：2
> 
> 时间：2012-04-17T13:42:16.757
> 
> 标签：python, linux, vb.net, visual-studio, raspberry-pi

我正在尝试选择一种语言、IDE 和其他工具，以便为 Linux 平台开发照片库应用程序。特别是运行 [Debian 6.0](http://en.wikipedia.org/wiki/Debian#Release_history) (Squeeze)的[树莓派。](http://en.wikipedia.org/wiki/Raspberry_Pi)

自 1990 年初以来，我的背景几乎完全是使用 Visual Basic，最近在[Visual Studio 2008](http://en.wikipedia.org/wiki/Microsoft_Visual_Studio#Visual_Studio_2008)中使用 VB.NET 。

我尝试在 Visual Studio 2008 中开发并使用[Mono](http://en.wikipedia.org/wiki/Mono_%28software%29)在目标机器上运行应用程序，但我很早就遇到了一些问题，这让我对这条路线没有太大信心。我确实喜欢我可以使用 Visual Studio 和 Visual Basic 的事实。

我正在考虑学习 Python 并使用[Tkinter](http://en.wikipedia.org/wiki/Tkinter)或[Glade](http://en.wikipedia.org/wiki/Glade_Interface_Designer) for [GTK+](http://en.wikipedia.org/wiki/GTK+)等 GUI 工具包之一，但我很困惑，因为似乎有很多选择。

我应该采取什么途径为 Linux 开发应用程序，它具有：

1.  来自 Visual Basic 的人的最小学习曲线。

2.  开发（生产力）的最大轻松/速度，而不是完成应用程序的速度或效率。

我完全控制了目标计算机，所以我不关心安装或分发问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T13:54:26.690

就“易于学习”而言，Python 可能与您将获得的一样好。

就 GUI 工具包的选择而言，我认为`wxWidgets`可能是最容易开始使用的。试试 Jan Bodnar 的[wxPython 教程](http://zetcode.com/wxpython/)。他也有 PyGTK 和 Tkinter（以及其他）的教程，如果你想查看这些教程进行比较。

# ios - iOS handleOpenURL 与 Phonegap 1.6.0

> ID：10192448
> 
> 赞同：1
> 
> 时间：2012-04-17T13:42:30.727
> 
> 标签：ios, ios5, cordova

科尔多瓦：1.6.0

iOS：5.1

X代码：4.3.1

我正在尝试使用一个非常基本的示例程序来利用 Phonegap 1.6.0 中的 handleOpenURL。每次发出 http/https 请求时，我都想分析一个 url。我现在所做的就是添加一条日志消息以查看 url 的主机。

```
- (BOOL) application:(UIApplication*)application handleOpenURL: 
(NSURL*)url 
{ 
    NSLog(@"Hi"); 
    NSLog(@"Host: %@", [url host]);

    if (!url) { 
        return NO; 
    }

    ... 
} 
```

但是，日志消息永远不会向控制台写入任何内容。

我确实注意到了评论：

```
// only valid if Example-Info.plist specifies a protocol to handle 
```

也许我的 Example-Info.plist 文件有误？我已经向其中添加了 CFBundleURLTypes，假设这就是“指定要处理的协议”的含义。我必须在某处添加其他东西吗？下面是我的 Example-Info.plist 文件的示例部分。模拟器是否可能无法识别我的 .plist 修改？

```
... 
<key>CFBundleURLTypes</key> 
<array> 
    <dict> 
        <key>CFBundleURLSchemes</key> 
            <array> 
                <string>http</string>
                <string>https</string> 
            </array> 
    </dict> 
</array> 
```

我也实现了，因为不推荐使用 handleOpenURL。

```
- (BOOL)application:(UIApplication *)application openURL:(NSURL *)url sourceApplication (NSString *)sourceApplication annotation:(id)annotation
{
    NSLog(@"Hi");
    ...
} 
```

当我在我的应用程序中打开 URL 时，两者都不会被调用。我已经尝试了堆栈溢出中的所有解决方案，但没有这样的运气。如果有任何帮助，我正在使用 jQuery mobile 1.1.0 进行页面转换。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T13:50:23.457

那不是这些方法的目的。它们将处理用于**打开**您的应用程序的 URL，而不是您在 UIWebView 中打开的任何 URL。

您应该查看[UIWebView的委托方法](http://developer.apple.com/library/ios/#DOCUMENTATION/UIKit/Reference/UIWebViewDelegate_Protocol/Reference/Reference.html)

具体来说

`- (BOOL)webView:(UIWebView *)webView shouldStartLoadWithRequest:(NSURLRequest *)request navigationType:(UIWebViewNavigationType)navigationType`

# c++ - 随机化 std::list 时提高性能

> ID：10192450
> 
> 赞同：1
> 
> 时间：2012-04-17T13:42:33.643
> 
> 标签：c++, performance, list, random, std

我有一个`std::list`我目前正在使用 Fisher-Yates shuffle 随机化（参见[http://en.wikipedia.org/wiki/Fisher-Yates_shuffle](http://en.wikipedia.org/wiki/Fisher-Yates_shuffle)）。总而言之，我的代码在列表中执行了以下步骤：

1.  循环遍历`list`.
2.  从当前位置开始用随机选择的元素交换元素，包括它自己。

因为列表不提供随机访问，这意味着我在第 1 步中迭代整个列表，并且对于每个元素我再次迭代，从那时起平均超过一半的剩余元素。这是我的程序性能的一个主要瓶颈，所以我正在寻求改进它。由于其他原因，我需要继续`list`用作我的容器，但我正在考虑`vector`在我的 randomize 函数开始时转换为 a ，然后在最后转换回`list`。我的列表通常包含 300 - 400 个项目，所以我猜想容器之间的转换成本是值得的，以避免按顺序遍历这些项目。

我的问题是：这似乎是优化代码的最佳方式吗？有没有更好的办法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T19:31:45.323

一个简单的改进是将数据复制到向量中，将向量打乱，然后将其复制回列表中。这就是 Max 和 PeskyGnat 在评论中所建议的：

```
vector<int> myVector(myList.size());
copy(myList.begin(), myList.end(), myVector.begin());
random_shuffle(myVector.begin(), myVector.end());
list<int> myListShuffled(myVector.begin(), myVector.end()); 
```

这个实现非常快。但是，它将在向量上执行三遍，您可以通过自己实现 shuffle 将其减少到两遍：

```
vector<int> myVector(myList.size());
int lastPos = 0;
for(list<int>::iterator it = myList.begin(); it != myList.end(); it++, lastPos++) {
    int insertPos = rand() % (lastPos + 1);
    if (insertPos < lastPos) {
        myVector[lastPos] = myVector[insertPos]; 
    }

    myVector[insertPos] = *it;
}

list<int> myListShuffled(myVector.begin(), myVector.end()); 
```

由于第一个版本更容易理解且不易出错，因此几乎总是更可取...除非这段代码可能对您的性能至关重要（并且您通过测量确认了这一点。）

编辑：顺便说一句，由于您正在查看 Wikipedia 文章，因此第二个代码示例使用了 Fisher-Yates 的“由内而外”变体。

# node.js - 上传和存储图像

> ID：10192452
> 
> 赞同：14
> 
> 时间：2012-04-17T13:42:38.697
> 
> 标签：node.js, mongodb, express, mongoose

是的，我知道[使用 Node.js、Express 和 Mongoose 上传图像](https://stackoverflow.com/questions/5149545/uploading-images-using-nodejs-express-and-mongo)以及[如何使用 node.js 在 mongodb 中存储图像？](https://stackoverflow.com/questions/4513002/how-can-i-store-images-in-mongodb-with-node-js)但解决这些问题并不是我想要实现的。我希望能够使用 Schema 将图像存储在二进制数据库中（Mongodb with Mongoose）。

那么，您知道使用组合 Node.js、Express 和 Mongodb 的任何应用程序吗？如果这个组合 + Jade 有任何应用程序是最好的，但我想这要求太多了。

提前致谢！

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-04-17T19:16:14.337

这是一个使用 node/express/mongoose 使用 mongodb 存储/显示 img的[快速示例。](https://gist.github.com/2408370)

# java - Java 类加载器更改

> ID：10192453
> 
> 赞同：7
> 
> 时间：2012-04-17T13:42:38.740
> 
> 标签：java, classloader

我有一些课`A`：

```
public class A {
    public A(String str) {
        System.out.println("Create A instance: " + str);
    }

    public void methodA() {
        System.out.println("#methodA1()");
    }
} 
```

我的类加载器实现：

```
public class MyClassLoader extends ClassLoader {
    public MyClassLoader() {    
        super();
    }

    @Override
    public synchronized Class<?> loadClass(String name) 
            throws ClassNotFoundException {

        System.out.println("Load: " + name);

        return super.loadClass(name);
    }
} 
```

现在我尝试更改当前线程中的默认类加载器：

```
import java.util.ArrayList;
import java.util.List;

public class ChangeLoaderTest {
    public static void main(String[] args) {
        // Save class loader so that we can restore later.
        ClassLoader oldLoader = Thread.currentThread().getContextClassLoader();

        MyClassLoader newLoader = new MyClassLoader();
        try {
            // Set new classloader.
            Thread.currentThread().setContextClassLoader(newLoader);

            // My class.
            A a = new A("1");
            a.methodA();

            // Standard Java class.
            List<Integer> list = new ArrayList<Integer>();
            list.add(2);
            list.add(3);
        } finally {
            // Restore.
            Thread.currentThread().setContextClassLoader(oldLoader);
        }
    }
} 
```

并`ChangeLoaderTest`输出：

```
Create A instance: 1
#methodA1() 
```

没有人

```
Load: ... 
```

为什么？我怎样才能`ClassLoader`变成一些线程？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T14:23:00.930

正如 Marko Topolnik 所指出的，[上下文类加载器是供框架使用的](http://docs.oracle.com/javase/jndi/tutorial/beyond/misc/classloader.html)。要自己使用类加载器，您必须调用`loadClass("somepackage.A")`然后使用反射 API 来创建 A ( `Class.newInstance()`) 的新实例。

您将无法直接在源代码中使用 A 或其方法，因为调用代码不知道 A - 它使用不同的类加载器。可以通过普通类加载器加载的 A 的接口或基类可用于避免反射。

```
interface AIF{
        void someMethod();
 }
class A implements AIF{
      public void someMethod(){}
 }

public void test(){
     MyLoader loader = new MyLoader();
     Class cla = loader.loadClass("A");
     AIF a = (AIF) cla.newInstance();
     a.someMethod();

 } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-17T13:58:40.870

基本`contextClassLoader`Java**操作**（如`new`. 只有在那里，各种框架才能访问负责的上下文类加载器并加载资源、类等。Java 将始终使用加载正在执行的代码的类加载器。这是您可以通过它访问的那个`ChangeLoaderTest.class.getClassLoader()`——您对此无能为力。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T13:58:12.720

我认为发生的事情是您的应用程序的类加载器也是您的类加载器的“父”可以找到`A`并加载它。因此，您的类加载器将不会被搜索或用于加载`A`。

老实说，我对类加载器没有太多经验，但是如果您将一个使用 URL 作为类路径的子类（以便它可以找到类文件）并且父类加载器无法加载它（不是类路径的一部分)，将使用您的自定义。

# wpf - 如何将左右轴和下轴的标签显示到右轴和上轴

> ID：10192454
> 
> 赞同：0
> 
> 时间：2012-04-17T13:42:40.560
> 
> 标签：wpf, vb.net, teechart

我想在折线图的左轴和下轴上显示标签到右轴和上轴，而不是左轴和下轴。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T14:52:45.567

您需要设置系列的水平轴和垂直轴：

```
line1.VertAxis = Steema.TeeChart.Styles.VerticalAxis.Right
line1.HorizAxis = Steema.TeeChart.Styles.HorizontalAxis.Top 
```

您将在教程 4 中找到有关轴设置的更多信息，可在 TeeChart 的程序组中找到。

# hadoop - 仅当所有映射器完成时才减少工作？

> ID：10192459
> 
> 赞同：1
> 
> 时间：2012-04-17T13:42:56.753
> 
> 标签：hadoop, mapreduce, reduce

美好的一天......我有点困惑；减少任务和减少工作有什么区别？这是我的情况；我已经读过reduce直到所有映射完成后才会开始......但在hadoop输出中我看到的是：

```
12/02/11 10:58:50 INFO mapred.JobClient: map 60% reduce 16%
12/02/11 10:58:54 INFO mapred.JobClient: map 60% reduce 20%
12/02/11 10:58:55 INFO mapred.JobClient: map 65% reduce 20% 
```

减少是 16%，而地图仍然是 60%……这里到底发生了什么？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-17T14:22:54.383

“reduce 阶段”分为三个阶段：shuffle、sort、reduce。shuffle 复制数据，而 sort 将键组合在一起。reduce 是您编写的实际`reduce`函数。

百分比的工作方式是 shuffle 是 33%，sort 是 33%，reduce 是 33%。您所看到的是“大约 16%/33%（即 48%）的数据已被复制到 reducer”。在所有映射器完成之前，最后 33% 的“减少”无法开始。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-17T14:40:22.343

当第一个映射器完成处理其输入时，reducers 开始复制输出映射器产生的结果，但在所有映射器完成执行任务之前，reducers 无法处理输入。这背后的原因是，reducer 可能会从未完成的映射器接收更多输入数据，这可能会改变它处理其输入的顺序。

您在控制台上看到的 reducer 完成百分比表示 reducer 正在从映射器复制数据。

# java - 测试AJAX文件上传

> ID：10192465
> 
> 赞同：3
> 
> 时间：2012-04-17T13:43:38.270
> 
> 标签：java, playframework-2.0

我想在我的应用程序中测试文件上传。上传本身的处理方式如[http://www.playframework.org/documentation/2.0/JavaFileUpload](http://www.playframework.org/documentation/2.0/JavaFileUpload)上的**直接文件上传**部分所述。

我正在使用最新的 Play20 版本并按照[此处](https://github.com/playframework/Play20/wiki/BuildingFromSource)所述进行构建。

我当前的代码看起来像这样，但显然缺少向请求添加测试文件的部分：

**测试.java**

```
FakeRequest request = fakeRequest(POST, "/measurement/123/file");
// how to append test file to this request?    
Result result = routeAndCall(request);
assertOK(result); 
```

**控制器.java**

```
public static uploadFile() {
    RequestBody body = request().body();
    if (body != null) {
        RawBuffer rawBuffer = body.asRaw();
        if (rawBuffer != null) {
            File uploadedFile = rawBuffer.asFile();
            // ...
        }
    }
    return ok();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T12:55:09.967

我对 Play 2 Java 文件上传测试的解决方案是创建一个 UploadFakeRequest 扩展 FakeRequest。在类里面，我有我自己的 withRawBody 方法，类似这样：

```
 RawBuffer raw = new RawBuffer(1000, data.getBytes()); // No clue what is the correct value here...
 AnyContentAsRaw content = new AnyContentAsRaw(raw);
 fake = new play.api.test.FakeRequest(POST, fake.path(), new play.api.test.FakeHeaders(Scala.asScala(map)), content, "127.0.0.1"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T07:54:15.047

根据[源代码](https://github.com/playframework/Play20/blob/master/framework/src/play-test/src/main/scala/play/api/test/Fakes.scala#L35)，FakeRequest 调用的签名是：

```
case class FakeRequest[A](method: String, uri: String, headers: FakeHeaders, body: A) extends Request[A] 
```

您应该能够检查将文件上传到应用程序的 POST 请求的主体，并将该主体作为参数复制到测试代码中。另一种方法是根据多部分 POST 上的[RFC 描述构建它。](http://www.faqs.org/rfcs/rfc1867.html)

# c# - Visual Studio 2010 - C# UserControl 事件触发

> ID：10192467
> 
> 赞同：0
> 
> 时间：2012-04-17T13:43:39.523
> 
> 标签：c#, winforms, visual-studio-2010, events, user-controls

我正在尝试在 Visual Studio 2010 中制作基于网格的地下城系统。我有一个主用户控件，其中包含 64 个其他较小的用户控件对象，我称之为 GridSquares，组织成一个 8x8 网格。网格方块背后的想法是充当“地牢”内的潜在移动空间。我目前遇到的问题是我需要能够在用户控件（GridSquares）本身上调用点击事件，这些控件已放置在屏幕上，以便我可以检索它们的坐标（名称）进行比较。但是，当我调用它（通过单击）时，该事件不起作用。

我知道当我将它们放在用户控件（GridSquare 对象）中时，这些事件会起作用，但是当单击用户控件本身时，我甚至需要单击才能起作用。

鉴于放置的所有 64 个对象都是同一类型，我无法在 GridSquare 类中工作，因为我需要通过事件返回用户控件的名称。

我希望这是有道理的，但请询问我是否需要进一步解释。

非常感谢，利亚姆

编辑：我不确定这将有多大帮助或显示什么代码，但 GridSpace 控件已添加到“地牢”用户控件中。然后在我将所有 64 个添加到字典中：

```
gridSpaces.Add(gs11.Name, gs11); 
```

其中 gs11 是 GridSquare 的名称。

从这里我尝试为地牢屏幕上的各个用户控件创建事件处理程序，但未能调用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T13:53:16.623

您可以为每个处理程序使用相同的处理程序，`GridSquare`并使用`sender`参数来确定单击了哪个处理程序：

```
protected void Page_Load(object sender, EventArgs e)
{
   for (int i = 0; i < 64; i++)
   {
      GridSquare square = new GridSquare();
      square.Click += new EventHandler(gridSquare_Click);
      grid.Add(gridSquare);
   }
}

void gridSquare_Click(object sender, EventArgs e)
{
   GridSquare square = (GridSquare)sender;
   // do something cool with the clicked square here
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T14:42:59.470

我想我明白你的意思。将此代码添加到您的用户控件：

```
public new event EventHandler Click {
    Add {
        base.Click += value;
        foreach(Control i in Controls) {
            i.Click+=value;
        }
    }
    remove {
        base.Click -= value;
        foreach(Control i in Controls) {
            i.Click -= value;
        }
    }
    } 
```

这会将点击事件添加到您的用户控件中的所有内容中，我希望我没有犯任何错误，这会有所帮助

# android - Viewpager + FragmentStatePagerAdapter + Fragment 不工作

> ID：10192468
> 
> 赞同：2
> 
> 时间：2012-04-17T13:43:42.800
> 
> 标签：android, fragment, android-viewpager

我有一个带有一些项目的 FragmentList。如果我单击一个项目，则会打开包含 Viewpager 的相应片段。到目前为止没问题，但是如果我返回列表并再次单击该项目，则不再调用 getItem(int position) 方法。
这里有一个类似问题的链接：
[Display fragment viewpager within a fragment](https://stackoverflow.com/questions/7700226/display-fragment-viewpager-within-a-fragment)

```
@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {

    view = inflater.inflate(R.layout.activity_fragment_runtime, container, false);
    mViewPager = (ViewPager) view.findViewById(R.id.pager);
    indicator = (TitlePageIndicator) view.findViewById(R.id.indicator);
    MyFragmentPagerAdapter mMyFragmentPagerAdapter = new MyFragmentPagerAdapter(getActivity().getSupportFragmentManager());
    mViewPager.setAdapter(mMyFragmentPagerAdapter);
    indicator.setViewPager(mViewPager);

    return view; 
  }

class MyFragmentPagerAdapter extends FragmentStatePagerAdapter implements TitleProvider {

    public MyFragmentPagerAdapter(FragmentManager fm) {
        super(fm);
    }

    @Override
    public String getTitle(int position) {

        return muxbusTitles[position];
    }

    @Override
    public Fragment getItem(int location) {

        return muxbusFragmentList.get(location);
    }

    @Override
    public int getCount() {

        return muxbusTitles.length;
    }

}

    return view;

} 
```

**编辑：** 如果有人感兴趣，解决方案是从 PagerAdapter 而不是 FragmentStatePagerAdpater 扩展，因为 Viewpager 已经在 Fragment 中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-11-11T07:18:37.847

我确实遇到了类似的问题，在摸索了很长一段时间后，我做出了**自己的理解（假设）**，即即使托管被破坏（未使用 Activity 测试），`ViewPager`也将其*子片段*的引用保留在内存中。`Fragment or Activity`所以我写了这个方法`freeFragmentsFromViewPager()`。你需要从`onDestroy()`你的`Fragment`.

```
 /**
     * This method free the child fragments from ViewPager as ViewPager keeps the reference
     * of child fragments into memory and next time when you again come to visit view pager it won't show the fragment layout
     * because it has the reference to the fragment whilst the fragment's view was already destroyed.
     */
    private void freeFragmentsFromViewPager()
    {
        for(int i = 0; i < TabsFragmentPagerAdapter.fragments.length; i++)
        {
            Fragment fragment = TabsFragmentPagerAdapter.fragments[i];

            if(fragment != null)
            {
                FragmentTransaction fragmentTransaction = getFragmentManager().beginTransaction();  
                fragmentTransaction.remove(fragment);
                fragmentTransaction.commit();

                TabsFragmentPagerAdapter.fragments[i] = null;
            }       
        }   
    } 
```

这是我的适配器代码

```
public class TabsFragmentPagerAdapter extends FragmentPagerAdapter
{
    public static final int NUM_TABS = 3;

    public static Fragment[] fragments = new Fragment[NUM_TABS];

    public TabsFragmentPagerAdapter(FragmentManager fm)
    {
        super(fm);
    }

    @Override
    public Fragment getItem(int position)
    {
        Log.e("TabsFragmentPagerAdapter", "getItem");

        Fragment fragment = TabsFragmentFactory.newInstace(position);

        fragments[position] = fragment;

        return fragment;
    }

    @Override
    public int getCount()
    {
        return NUM_TABS;
    }

    @Override
    public CharSequence getPageTitle(int position) 
    {
        return TabsFragmentFactory.getName(position);
    } 
```

# c++ - 不推荐使用的虚拟协变返回类型

> ID：10192470
> 
> 赞同：1
> 
> 时间：2012-04-17T13:43:43.910
> 
> 标签：c++, inheritance, g++, virtual, covariance

大家好，我在使用代码块编译代码时收到一些警告，这些代码块不知道这是什么意思，应该忽略它们，否则会在执行过程中反映我的程序

```
\src\..\inc\UTDB_Field.h|56|warning: deprecated covariant return type for 'virtual int* UTDB_intField::get_valField() const'
\src\..\inc\UTDB_Field.h|19|warning: overriding 'virtual void* UTDB_Field::get_valField() const' 
```

实际上`virtual void* UTDB_Field::get_valField() const`const 是 UTDB_Field（基类）中的纯虚函数，而`virtual int* UTDB_intField::get_valField() const`const 是派生的（UTDB_intField）。

我发现了一些关于 co variant 返回类型的含义的解释，但我的理解是返回类型 void*（在我的情况下）丢失并被 int* 取代，对我来说，这是我的目标，我想要一个通用类型return 并且每个派生类将负责自己的。

这是我在派生类 UTDB_intField 中定义的 operator==：

```
 virtual bool operator==(const UTDB_Field& Field) const
{
     if(this->typeF==(Field.get_typeField()))
      {
           if(this->nameF==(Field.get_nameField()))
           {
                if (this->val== Field.get_valField())
                return true;
                else
                {
                    std::cout<<" val 1: "<<*(this->get_valField())<<" and val2:  "<<*(int*)Field.get_valField() <<" are different"<<std::endl;
                    return false;
                }
            }
            else
                {
                    std::cout<<" name 1: "<<this->get_nameField()<<" and name 2: "<<Field.get_nameField() <<" are different"<<std::endl;
                    return false;
                }
      }
      else  {
                std::cout<<" type "<<this->typeF<<" and "<<Field.get_typeField() <<" are two incomparable types"<<std::endl;
                return false;
            }
}; 
```

当我用这个测试它时：

```
string  a="CurrField";
string* val=&a;
int b=5;
int* val2=&b;

std::cout<<"  *Construction*"<<endl;

UTDB_Field* UTField=new UTDB_strField("name",val);

UTDB_Field* UTField2=new UTDB_intField("Currency",val2);

std::cout<<" --------------- "<<std::endl;
std::cout<<"result of comparison "<<(*UTField2==(*UTField))<<endl; 
```

我得到我的信息：类型 int 和 str 是两种无与伦比的类型

比较结果 0

因此，如果两个字段具有相同的类型，那么我知道我有什么类型是可以的，但如果他们没有，我应该有不兼容的消息。

任何帮助将不胜感激

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T16:02:31.857

撇开设计考虑和意见不谈，这里唯一真正的问题是您超出了标准，并且无法与其他编译器一起编译。原因是标准只允许返回类型因协方差而不同。换句话说，重载的返回类型必须与基方法的类型相同；或隐式转换为基类的派生类型。这假设返回是通过指针/引用。

协变返回类型（通常）的目的是使类 A 可以具有从某个例程返回“A *”的方法。B 类派生自 A 并重载了该方法，但真的想返回一个“B *”。当然它可以说它返回一个'A *'，因为那是一个'B *'，但你想要额外的信息。

这样，如果有人使用 B 类型的对象并且已知它是 B，它可以利用该方法返回（至少）B* 的知识，而无需向上转换。

你在这里所做的很尴尬，但逻辑上很好。如果您将该对象用作 UTDB_Field*，则该方法会为您提供一个 void* ，它可以是任何东西。如果您将它用作 UTDB_IntField*（希望它确实如此），那么您会从原型中获得额外信息，即返回的不仅仅是一个 void *，而且确实是一个 int*。

我不会讨论这是好是坏，但了解将其带到其他编译器的可移植性问题可能对您很重要。

# c# - Kinect 侧身骨骼追踪

> ID：10192476
> 
> 赞同：42
> 
> 时间：2012-04-17T13:43:52.993
> 
> 标签：c#, kinect

目前我正在使用 Microsoft Kinect 来测量关节之间的角度。大多数测量工作正常。每当一个人侧身（坐在椅子上）时，Kinect 都不会准确地跟踪骨骼。为了说明我的问题，我添加了 3 张 Kinect 深度视图的图片。

![带骨骼跟踪的坐姿侧身测量](../Images/1340cfecb2726bba85c177717f781e4b.png)

![无骨骼跟踪的坐姿侧身测量](../Images/e2e1123672aac172676e2c5910d0c80f.png)

![带骨骼跟踪的侧向测量](../Images/df776986b1b09d493e138400e30fb8f8.png)

如您所见，3 次测量中有 2 次“正确”工作。每当我抬起腿时，Kinect 都会正确停止骨骼跟踪。有没有人可以解决这个问题，或者这只是 Kinect 的限制？

谢谢。

**更新 1：**屏幕截图 2 中显示 的`JointTrackingState-Enumeration`这些跟踪关节上的 标记为`Inferred`，但是深度视图正在跟踪我的全身。

**更新 2：** 在屏幕截图 2 中，我试图追踪我的前腿，突出显示为绿色。我知道另一条腿没有被跟踪，但这没关系，我猜。

**更新 3：** 以下代码选择一个骨架：

```
private Skeleton StickySkeleton(Skeleton[] skeletons)
{
    if (skeletons.Count<Skeleton>(skeleton => skeleton.TrackingId == _trackedSkeletonId) <= 0)
    {
        _trackedSkeletonId = -1;
        _skeleton = null;
    }

    if (_trackedSkeletonId == -1)
    {
        Skeleton foundSkeleton = skeletons.FirstOrDefault<Skeleton>(skeleton => skeleton.TrackingState == SkeletonTrackingState.Tracked);

        if (foundSkeleton != null)
        {
            _trackedSkeletonId = foundSkeleton.TrackingId;
            return foundSkeleton;
        }
    }

    return _skeleton;
} 
```

每当跟踪骨骼时，该数据将用于绘制关节点和计算关节之间的角度。

**更新 4：** 我已经测试过坐在“块”上，比椅子简单得多。不幸的是，Kinect 的行为仍然相同。

下面2个截图：

![坐在街区 1](../Images/fa6f8898d3e80f5437e9836135610e38.png)

![坐在街区 2](../Images/3bd3e51eb8616f5f56b1a4110cf37e10.png)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-21T16:05:02.207

正如 Renaud Dumont 所说，我会对`JointTrackingState`. 由于您使用膝盖，因此我使用了变量`leftknee`以及`rightknee`要`Joints`执行此操作的变量。这是代码，您可以使用`JointType.FootRight`and`JointType.FootLeft`和`Hip`类型，但我会留给您。

```
static Skeleton first = new Skeleton();

Joint leftknee = first.Joints[JointType.KneeLeft];
Joint rightknee = first.Joints[JointType.KneeRight];

if ((leftknee.TrackingState == JointTrackingState.Inferred ||
                leftknee.TrackingState == JointTrackingState.Tracked) && 
                (rightknee.TrackingState == JointTrackingState.Tracked ||
                rightknee.TrackingState == JointTrackingState.Inferred))
            {

            } 
```

或者，如果您只想一次跟踪一个膝盖，或者两者都跟踪，您可以这样做：

```
if ((leftknee.TrackingState == JointTrackingState.Inferred ||
                leftknee.TrackingState == JointTrackingState.Tracked) && 
                (rightknee.TrackingState == JointTrackingState.Tracked ||
                rightknee.TrackingState == JointTrackingState.Inferred))
            {

            }

            else if (leftknee.TrackingState == JointTrackingState.Inferred ||
                    leftknee.TrackingState == JointTrackingState.Tracked)
            {

            }

            else if (rightknee.TrackingState == JointTrackingState.Inferred ||
                    rightknee.TrackingState == JointTrackingState.Tracked)
            {

            } 
```

仅供参考，原因`Skeleton`是因为`first`它`static`可以用于制作接头

```
 static Skeleton first; 
```

反对

```
 Skeleton first; 
```

### 编辑 1

我得出的结论是，这**很难**做到，我认为上述方法会奏效，但我只是想包括我正在做的事情，以防你能找到某种方法让它发挥作用。无论如何，这是我正在处理的代码，这是`class`另一个`SkeletalTrackingState`我试图在`Inferred` `enum`其中制作的代码。但可惜`enum`是[不可能](https://stackoverflow.com/questions/757684/enum-inheritance)的`inherit`。如果你发现有这种效果的东西有效，我会永远尊重你，因为你是我的优秀程序员；）。事不宜迟：`.dll`我试图使：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using Microsoft.Kinect;

namespace IsInferred
{
public abstract class SkeletonInferred : Skeleton
{
    public bool inferred;
    static Skeleton first1 = new Skeleton();
    Joint handright;
    Joint handleft;
    Joint footright;
    Joint footleft;
    Joint ankleleft;
    Joint ankleright;
    Joint elbowleft;
    Joint elbowright;
    Joint head;
    Joint hipcenter;
    Joint hipleft;
    Joint hipright;
    Joint shouldercenter;
    Joint shoulderleft;
    Joint shoulderright;
    Joint kneeleft;
    Joint kneeright;
    Joint spine;
    Joint wristleft;
    Joint wristright;

    public SkeletonInferred(bool inferred)
    {

    }

    public enum Inferred
    {
        NotTracked = SkeletonTrackingState.NotTracked,
        PositionOnly = SkeletonTrackingState.PositionOnly,
        Tracked = SkeletonTrackingState.Tracked,
        Inferred = 3,
    }

    private void IsInferred(object sender, AllFramesReadyEventArgs e)
    {
        handright = first1.Joints[JointType.HandRight];
        handleft = first1.Joints[JointType.HandLeft];
        footright = first1.Joints[JointType.FootRight];
        footleft = first1.Joints[JointType.FootLeft];
        ankleleft = first1.Joints[JointType.AnkleLeft];
        ankleright = first1.Joints[JointType.AnkleRight];
        elbowleft = first1.Joints[JointType.ElbowLeft];
        elbowright = first1.Joints[JointType.ElbowRight];
        head = first1.Joints[JointType.Head];
        hipcenter = first1.Joints[JointType.HipCenter];
        hipleft = first1.Joints[JointType.HipLeft];
        hipright = first1.Joints[JointType.HipRight];
        shouldercenter = first1.Joints[JointType.ShoulderCenter];
        shoulderleft = first1.Joints[JointType.ShoulderLeft];
        shoulderright = first1.Joints[JointType.ShoulderRight];
        kneeleft = first1.Joints[JointType.KneeLeft];
        kneeright = first1.Joints[JointType.KneeRight];
        spine = first1.Joints[JointType.Spine];
        wristleft = first1.Joints[JointType.WristLeft];
        wristright = first1.Joints[JointType.WristRight];

        if (handleft.TrackingState == JointTrackingState.Inferred &
            handright.TrackingState == JointTrackingState.Inferred &
            head.TrackingState == JointTrackingState.Inferred &
            footleft.TrackingState == JointTrackingState.Inferred &
            footright.TrackingState == JointTrackingState.Inferred &
            ankleleft.TrackingState == JointTrackingState.Inferred &
            ankleright.TrackingState == JointTrackingState.Inferred &
            elbowleft.TrackingState == JointTrackingState.Inferred &
            elbowright.TrackingState == JointTrackingState.Inferred &
            hipcenter.TrackingState == JointTrackingState.Inferred &
            hipleft.TrackingState == JointTrackingState.Inferred &
            hipright.TrackingState == JointTrackingState.Inferred &
            shouldercenter.TrackingState == JointTrackingState.Inferred &
            shoulderleft.TrackingState == JointTrackingState.Inferred &
            shoulderright.TrackingState == JointTrackingState.Inferred &
            kneeleft.TrackingState == JointTrackingState.Inferred &
            kneeright.TrackingState == JointTrackingState.Inferred &
            spine.TrackingState == JointTrackingState.Inferred &
            wristleft.TrackingState == JointTrackingState.Inferred &
            wristright.TrackingState == JointTrackingState.Inferred)
        {
            inferred = true;
        }
      }
    }
  } 
```

项目中的代码（编译器错误）

```
 using IsInferred;

    static bool Inferred = false;
    SkeletonInferred inferred = new SkeletonInferred(Inferred);
    static Skeleton first1 = new Skeleton();

    Skeleton foundSkeleton = skeletons.FirstOrDefault<Skeleton>(skeleton =>  skeleton.TrackingState == SkeletonTrackingState.Inferred); 
```

祝你好运，我希望这能帮助你朝着正确的方向前进，或者对你有帮助！

我的代码

这是您要求的我的代码。是的，它来自[Skeletal Tracking Fundamentals](http://channel9.msdn.com/Series/KinectQuickstart/Skeletal-Tracking-Fundamentals)，但是这段代码在这里，我不想用大部分相同的东西开始一个新项目。享受！

### 代码

```
 // (c) Copyright Microsoft Corporation.
     // This source is subject to the Microsoft Public License (Ms-PL).
    // Please see http://go.microsoft.com/fwlink/?LinkID=131993 for details.
    // All other rights reserved.

using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Imaging;
using System.Windows.Navigation;
using System.Windows.Shapes;
using Microsoft.Kinect;
using Coding4Fun.Kinect.Wpf; 

namespace SkeletalTracking
{
/// <summary>
/// Interaction logic for MainWindow.xaml
/// </summary>
public partial class MainWindow : Window
{
    public MainWindow()
    {
        InitializeComponent();
    }

    bool closing = false;
    const int skeletonCount = 6; 
    Skeleton[] allSkeletons = new Skeleton[skeletonCount];

    private void Window_Loaded(object sender, RoutedEventArgs e)
    {
        kinectSensorChooser1.KinectSensorChanged += new  DependencyPropertyChangedEventHandler(kinectSensorChooser1_KinectSensorChanged);

    }

    void kinectSensorChooser1_KinectSensorChanged(object sender, DependencyPropertyChangedEventArgs e)
    {
        KinectSensor old = (KinectSensor)e.OldValue;

        StopKinect(old);

        KinectSensor sensor = (KinectSensor)e.NewValue;

        if (sensor == null)
        {
            return;
        }

        var parameters = new TransformSmoothParameters
        {
            Smoothing = 0.3f,
            Correction = 0.0f,
            Prediction = 0.0f,
            JitterRadius = 1.0f,
            MaxDeviationRadius = 0.5f
        };
        sensor.SkeletonStream.Enable(parameters);

        //sensor.SkeletonStream.Enable();

        sensor.AllFramesReady += new EventHandler<AllFramesReadyEventArgs>(sensor_AllFramesReady);
        sensor.DepthStream.Enable(DepthImageFormat.Resolution640x480Fps30); 
        sensor.ColorStream.Enable(ColorImageFormat.RgbResolution640x480Fps30);

        try
        {
            sensor.Start();
        }
        catch (System.IO.IOException)
        {
            kinectSensorChooser1.AppConflictOccurred();
        }
    }

    void sensor_AllFramesReady(object sender, AllFramesReadyEventArgs e)
    {
        if (closing)
        {
            return;
        }

        //Get a skeleton
        Skeleton first =  GetFirstSkeleton(e);

        if (first == null)
        {
            return; 
        }

        //set scaled position
        //ScalePosition(headImage, first.Joints[JointType.Head]);
        ScalePosition(leftEllipse, first.Joints[JointType.HandLeft]);
        ScalePosition(rightEllipse, first.Joints[JointType.HandRight]);
        ScalePosition(leftknee, first.Joints[JointType.KneeLeft]);
        ScalePosition(rightknee, first.Joints[JointType.KneeRight]);

        GetCameraPoint(first, e); 

    }

    void GetCameraPoint(Skeleton first, AllFramesReadyEventArgs e)
    {

        using (DepthImageFrame depth = e.OpenDepthImageFrame())
        {
            if (depth == null ||
                kinectSensorChooser1.Kinect == null)
            {
                return;
            }

            //Map a joint location to a point on the depth map
            //head
            DepthImagePoint headDepthPoint =
                depth.MapFromSkeletonPoint(first.Joints[JointType.Head].Position);
            //left hand
            DepthImagePoint leftDepthPoint =
                depth.MapFromSkeletonPoint(first.Joints[JointType.HandLeft].Position);
            //right hand
            DepthImagePoint rightDepthPoint =
                depth.MapFromSkeletonPoint(first.Joints[JointType.HandRight].Position);

            DepthImagePoint rightKnee =
                depth.MapFromSkeletonPoint(first.Joints[JointType.KneeRight].Position);

            DepthImagePoint leftKnee =
                depth.MapFromSkeletonPoint(first.Joints[JointType.KneeLeft].Position);

            //Map a depth point to a point on the color image
            //head
            ColorImagePoint headColorPoint =
                depth.MapToColorImagePoint(headDepthPoint.X, headDepthPoint.Y,
                ColorImageFormat.RgbResolution640x480Fps30);
            //left hand
            ColorImagePoint leftColorPoint =
                depth.MapToColorImagePoint(leftDepthPoint.X, leftDepthPoint.Y,
                ColorImageFormat.RgbResolution640x480Fps30);
            //right hand
            ColorImagePoint rightColorPoint =
                depth.MapToColorImagePoint(rightDepthPoint.X, rightDepthPoint.Y,
                ColorImageFormat.RgbResolution640x480Fps30);

            ColorImagePoint leftKneeColorPoint =
                depth.MapToColorImagePoint(leftKnee.X, leftKnee.Y,
                ColorImageFormat.RgbResolution640x480Fps30);

            ColorImagePoint rightKneeColorPoint =
                depth.MapToColorImagePoint(rightKnee.X, rightKnee.Y,
                ColorImageFormat.RgbResolution640x480Fps30);

            //Set location
            CameraPosition(headImage, headColorPoint);
            CameraPosition(leftEllipse, leftColorPoint);
            CameraPosition(rightEllipse, rightColorPoint);

            Joint LEFTKNEE = first.Joints[JointType.KneeLeft];
            Joint RIGHTKNEE = first.Joints[JointType.KneeRight];

            if ((LEFTKNEE.TrackingState == JointTrackingState.Inferred ||
            LEFTKNEE.TrackingState == JointTrackingState.Tracked) &&
            (RIGHTKNEE.TrackingState == JointTrackingState.Tracked ||
            RIGHTKNEE.TrackingState == JointTrackingState.Inferred))
            {
                CameraPosition(rightknee, rightKneeColorPoint);
                CameraPosition(leftknee, leftKneeColorPoint);
            }

            else if (LEFTKNEE.TrackingState == JointTrackingState.Inferred ||
                    LEFTKNEE.TrackingState == JointTrackingState.Tracked)
            {
                CameraPosition(leftknee, leftKneeColorPoint);
            }

            else if (RIGHTKNEE.TrackingState == JointTrackingState.Inferred ||
                    RIGHTKNEE.TrackingState == JointTrackingState.Tracked)
            {
                CameraPosition(rightknee, rightKneeColorPoint);
            }
        }        
    }

    Skeleton GetFirstSkeleton(AllFramesReadyEventArgs e)
    {
        using (SkeletonFrame skeletonFrameData = e.OpenSkeletonFrame())
        {
            if (skeletonFrameData == null)
            {
                return null; 
            }

            skeletonFrameData.CopySkeletonDataTo(allSkeletons);

            //get the first tracked skeleton
            Skeleton first = (from s in allSkeletons
                                     where s.TrackingState == SkeletonTrackingState.Tracked
                                     select s).FirstOrDefault();

            return first;

        }
    }

    private void StopKinect(KinectSensor sensor)
    {
        if (sensor != null)
        {
            if (sensor.IsRunning)
            {
                //stop sensor 
                sensor.Stop();

                //stop audio if not null
                if (sensor.AudioSource != null)
                {
                    sensor.AudioSource.Stop();
                }

            }
        }
    }

    private void CameraPosition(FrameworkElement element, ColorImagePoint point)
    {
        //Divide by 2 for width and height so point is right in the middle 
        // instead of in top/left corner
        Canvas.SetLeft(element, point.X - element.Width / 2);
        Canvas.SetTop(element, point.Y - element.Height / 2);

    }

    private void ScalePosition(FrameworkElement element, Joint joint)
    {
        //convert the value to X/Y
        //Joint scaledJoint = joint.ScaleTo(1280, 720); 

        //convert & scale (.3 = means 1/3 of joint distance)
        Joint scaledJoint = joint.ScaleTo(1280, 720, .3f, .3f);

        Canvas.SetLeft(element, scaledJoint.Position.X);
        Canvas.SetTop(element, scaledJoint.Position.Y); 

    }

    private void Window_Closing(object sender, System.ComponentModel.CancelEventArgs e)
    {
        closing = true; 
        StopKinect(kinectSensorChooser1.Kinect); 
    }

    private void kinectDepthViewer1_Loaded(object sender, RoutedEventArgs e)
    {

    }

   }
} 
```

### XAML

```
<Window x:Class="SkeletalTracking.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="MainWindow" Height="600" Width="800" Loaded="Window_Loaded" 
    xmlns:my="clr-namespace:Microsoft.Samples.Kinect.WpfViewers;assembly=Microsoft.Samples.Kinect.WpfViewers" 
    Closing="Window_Closing" WindowState="Maximized">       
<Canvas Name="MainCanvas">
    <my:KinectColorViewer Canvas.Left="0" Canvas.Top="0" Width="640" Height="480" Name="kinectColorViewer1" 
                          Kinect="{Binding ElementName=kinectSensorChooser1, Path=Kinect}" />
    <Ellipse Canvas.Left="0" Canvas.Top="0" Height="50" Name="leftEllipse"  Width="50" Fill="#FF4D298D" Opacity="1" Stroke="White" />
    <Ellipse Canvas.Left="100" Canvas.Top="0" Fill="#FF2CACE3" Height="50" Name="rightEllipse" Width="50" Opacity="1" Stroke="White" />
    <my:KinectSensorChooser Canvas.Left="250" Canvas.Top="380" Name="kinectSensorChooser1" Width="328" />
    <Image Canvas.Left="66" Canvas.Top="90" Height="87" Name="headImage" Stretch="Fill" Width="84" Source="/SkeletalTracking;component/c4f-color.png" />
    <Ellipse Canvas.Left="283" Canvas.Top="233" Height="23" Name="leftknee" Stroke="Black" Width="29" />
    <Ellipse Canvas.Left="232" Canvas.Top="233" Height="23" Name="rightknee" Stroke="Black" Width="30" />
</Canvas> 
```

这是一张图片，只是为了展示 Kinect 有时会如何关闭：
![](../Images/482cfd037331096cc8902f0faa8d12d1.png)
提示：注意如何只检测到我的手臂和部分背景

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T12:59:32.313

由于自身 SDK 的限制，kinect 无法准确跟踪骨架。本质上，每次设备尝试拾取骨架时，它总是假定它是正面的。如果保存关节，请从上向下查看并绘制 x 和 z 坐标，这很容易看到。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-22T23:28:58.330

我也在使用 Kinect，您可以获得膝关节角度的关节角度值，但您似乎面临的问题是由于 Kinect 本身，因为它没有显示推断值。最好使用整个骨架来跟踪你的膝盖，希望你能得到每个关节运动的所有值

# c++ - C++ cin 和 strnicmp 不起作用

> ID：10192483
> 
> 赞同：0
> 
> 时间：2012-04-17T13:44:12.977
> 
> 标签：c++, cin

```
void searchFlight(cust flights[] ,int row)
{    
    clrscr();
    cout << "Search for the flight you are looking for.\n";

    string airport;

    cout << "Enter Departing Flight : ";
    cin >> airport;   //error

    for (int r=0;r<row;r++)
    {
        if (strnicmp(airport, flights[r].airport[20], strlen(airport) ==0) //error  
        {
            clrscr();
            cout << flights[r].name[20] <<endl;
            cout << flights[r].airport[20] <<endl;
            cout << flights[r].destination[20] <<endl;
            cout << flights[r].ticket <<endl;
            cout << flights[r].passangers <<endl;
            cout << flights[r].opCost <<endl;
            cout << flights[r].income <<endl;
            cout << flights[r].netProfit <<endl;;
            pressKey();
        }
    }
    pressKey();
} 
```

对于 cin 错误：错误 C2678: binary '>>' : no operator found 采用'std::istream' 类型的左操作数（或没有可接受的转换）

对于 strnicmp 错误：错误 C2664: 'strlen' : cannot convert parameter 1 from 'std::string' to 'const char *'

我已经寻找解决此问题的方法，但无法解决。抱歉，如果这里有类似的帖子可以解决我的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T13:56:16.083

您是否包括以下内容：

```
<fstream>
<istream>
<iostream>
<string> 
```

我很确定你忘记了`<string>`

这是我运行的测试代码，它完美无缺！

```
#include <string>
#include <iostream>

using namespace std;

int main(int, char**)
{
   string foo;
   cin >> foo;
   cout << foo;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T14:04:29.287

> 对于 cin 错误：错误 C2678: binary '>>' : no operator found 采用'std::istream' 类型的左操作数（或没有可接受的转换）

添加`#include <string>`到您的 CPP 文件中。

> 对于 strnicmp 错误：错误 C2664: 'strlen' : cannot convert parameter 1 from 'std::string' to 'const char *'

确认您拥有`#include <cstring>`您的 CPP 文件，并将您的呼叫替换为： `strnicmp(airport.c_str(), flights[r].airport[20], strlen(airport.c_str()) ==0`。

我怀疑这`flights[r].airport[20]`也是不正确的，但我不知道，因为您没有发布完整的程序。

如果`cust::airport`声明为 like `std::string airport;`，那么您需要`flights[r].airport.c_str()`.

如果`cust::airport`声明为 like `char airport[20];`，那么您需要`flights[r].airport`.

# .htaccess - 拒绝访问 index.php 但允许 index.php?var=val

> ID：10192484
> 
> 赞同：0
> 
> 时间：2012-04-17T13:44:16.243
> 
> 标签：.htaccess, mod-rewrite

我想知道我是否可以拒绝访问[http://domain.tld/index.php](http://domain.tld/index.php)并只允许[http://domain.tld/index.php?var=val](http://domain.tld/index.php?var=val)

这可能与 rewritecond 和 rewriterule 吗？我无法弄清楚这一点。有什么帮助吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T15:35:44.603

是的，有可能。使用条件检查查询字符串的技巧，在您的 docroot`.htaccess`文件中使用它允许您禁止访问 index.php，除非设置了变量 var：

```
RewriteEngine  On
RewriteBase    /

RewriteCond    %{QUERY_STRING}   !\bvar=
RewriteRule    index.php         -        [F] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T13:51:34.223

它必须是重写规则吗？如果它是 PHP 脚本，您可以检测到所需参数的缺失，然后返回适当的 HTTP 标头以拒绝访问。

# java - 如何使用 java 在 OpenLdap 和 Active Directory 之间进行同步？

> ID：10192487
> 
> 赞同：0
> 
> 时间：2012-04-17T13:44:30.770
> 
> 标签：java, active-directory, openldap

我的要求是：

1.  在 openldap 服务器中创建的所有 ldap 用户都将被添加到广告服务器中。

2.  如果更改了现有 openldap 用户的密码，那么它也会更改广告中该用户的密码。

我想知道 openLdap 如何与 Active Directory 同步？openLdap 中的任何更改都将直接/使用 Active Directory 中的 java 更新。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T00:00:26.690

您可以将 OpenLDAP 配置为具有 LDAP 后端，该后端可以是 AD。或者有多种方法可以将其配置为代理或集群成员，这样 AD 又是另一个后端。看看 OpenLDAP 文档，它都在里面。

# c++ - Seg Fault - 将变量传递给方法会更改全局值

> ID：10192488
> 
> 赞同：1
> 
> 时间：2012-04-17T13:44:47.290
> 
> 标签：c++, pointers, dynamic-memory-allocation

我是 C++ 的新手，正在尝试使用动态内存创建一些基本的对象。我将一个 int 参数传递给一个方法，它正在改变全局变量的值。我认为这与我为新对象分配内存的方式有关，我不能让它以任何其他方式编译。

```
int main () {
    int inp;
    CRectangle rectb (2,2);
    cout << "enter number of items to add" << endl;
    cin >> inp; // let's say inp = 7
    rectb.addItemsArray(inp);
    cout << "inp after adding items: " << inp << endl; // inp is now 1.
} 
```

头文件：

```
class CRectangle {
    int width;
    int height;
    item *items[]; // SOLUTION: change this line to "item *items"
    int input;

public:
        CRectangle (int,int);
        int addItemsArray(int);
        int area () { return (width*height); }
        int get_items(int);

}; 
```

-和-

```
class item {
    int foo;
    char bar;
public:
    //SOLUTION add "item ();" here (a default constructor declaration without arguments)
    item (int, char);
    int get_foo();
    char get_bar();
}; 
```

方法：

```
int CRectangle::addItemsArray(int in) {
    cout << "value of in at begginning:" << in << endl; //in = 7
    int i;
    i = 0;
    //SOLUTION: add "items = new item[in];" on this line.
    while (i < in) {
        items[i] = new item(1, 'z'); //SOLUTION: change this line to "items[i] = item(1, 'z');"
        i++;
    }
    cout << "value of in at end " << in << endl; //in = 7
    return 1;
} 
```

有时我会遇到总线错误或段故障。有时它会像 2 或 3 这样的较小数字按预期工作，但并非总是如此。

任何帮助将不胜感激。

编辑（CRectangle 的构造函数）：

```
CRectangle::CRectangle (int a, int b) {
    width = a;
    height = b;
} 
```

（项目的构造函数）：

```
/* SOLUTION add default item constuctor
item::item() {
    foo = 0;
    bar = 'a';
}
*/

item::item(int arg, char arg2) {
    foo = arg;
    bar = arg2;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T13:52:20.790

问题是您没有为放入的指针分配任何存储空间`items`。我建议改变：

```
item *items[]; 
```

到

```
std::vector<item*> items; 
```

然后向其中添加项目：

```
items.push_back(new item(1, 'z')); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T14:04:39.630

看起来您忘记创建 items 数组...

您定义了一个动态分配的数组（不是 item *items[100]，而是 item *items[]）。在使用数组之前，您必须分配内存来保存项目：

```
items = new item[100]; 
```

并且不要忘记删除它

```
delete [] items; 
```

在末尾。;)

而不是

```
int i;
i = 0;
while (i < in) {
   items[i] = new item(1, 'z');
   i++;
} 
```

我会用

```
for (int i=0; i<in; i++)
{
   items[i] = new item(1, 'z');
} 
```

# sql - sql 选择一个值为 2 where

> ID：10192490
> 
> 赞同：1
> 
> 时间：2012-04-17T13:44:59.380
> 
> 标签：sql, join

这是我得到所有答案的唯一地方；）

我要选择：

```
SELECT 
    RTRIM(LTRIM(il.Num_bloc)) AS Bloc, 
    RTRIM(LTRIM(il.num_colis)) AS Colis,
    cd.transporteur AS Coursier, 
    cd.origine AS Origine, 
    cd.destination AS Destinataire,
    cd.adresse AS [Adresse Destinataire], 
    cd.poids AS Poids, 
    il.Signataire, il.num_cin AS CIN, il.date_livraison AS [Date Livraison]
FROM  
    dbo.cd 
INNER JOIN 
    dbo.il ON cd.bloc = il.Num_bloc AND dbo.cd.colis = dbo.il.num_colis
WHERE 
    (il.Num_bloc = RTRIM(LTRIM(@ParamBloc))) 
    AND (il.num_colis = RTRIM(LTRIM(@ParamColis))) 
```

如果用户将以太币`@ParamBloc`或`@ParamColis`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T13:51:39.340

尝试使用 IsNull() 函数。

一个简单的查询会像这样

```
Select * from yourTable
Where
  Num_bloc = ISNULL(@ParamBloc, Num_block) AND
  num_colis = ISNULL(@ParamColis, num_colis) 
```

如果 @parameter Bloc 或 Colis 为空，则第二个参数将使表达式为 true。此查询对于这两个参数的所有 4 种可能组合都很有用。

# sql - SQL For 循环调优

> ID：10192491
> 
> 赞同：1
> 
> 时间：2012-04-17T13:45:03.523
> 
> 标签：sql

我们即将开始一个新的进程。它将涉及超过 50 个表，总共超过 200 万行。该过程将在 For/For each 框中循环。在内部，表格将遭受不同的过程。Basicaly 更新（最常用的将是删除查找重复项）。最后，我们将获得一个新表，其中包含所有这 50 个表的全部内容，并完成所有更新。

所以我的问题是：就速度而言，在每个循环期间查找表中的重复项是否更好。还是在检查完整结果的过程结束时进行完全删除更好？工作量将或多或少相同。

非常感谢。

编辑。

更多信息。

循环是一种需要。这 50 个表位于两个不同的服务器中。甲骨文和访问。循环是将它们填充到本地 SQL 服务器中。在每个人口（循环）上，我都会进行一些更新并处理表格，以便它们准备就绪。

问题是，如果我们在表上执行的工作进入循环或在循环之外，是否会更快。

谢谢，希望越来越清楚。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T13:50:31.180

听起来像一个单一的声明

另外，为什么过早地去规范化？

# sql - 从地理列中搜索附近的点

> ID：10192498
> 
> 赞同：3
> 
> 时间：2012-04-17T13:45:25.593
> 
> 标签：sql, geolocation, sql-server-2008-r2, sqlgeography

我的表中有一个带有空间索引的地理类型列。如何在使用索引提高性能的同时选择给定纬度/经度 X 米内的前 N ​​行？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-17T15:31:58.307

当您说“同时使用索引”时-您是什么意思？

我才刚刚开始（今天）尝试使用 SQL 2012 及其`Geography`数据类型，但也许以下内容很有用 - 我确实意识到您正在使用`2008-R2`

创建一些数据：

```
CREATE TABLE SpatialTable 
    ( id int IDENTITY (1,1) PRIMARY KEY,
    GeogCol1 geography, 
    GeogCol2 AS GeogCol1.STAsText() );
GO

INSERT INTO SpatialTable (GeogCol1)
VALUES 
(geography::STGeomFromText('POINT(-122.360 47.656)',4326)),
(geography::STGeomFromText('POINT(-122.343 47.656)',4326)),
(geography::STGeomFromText('POINT(-122.358 47.660)',4326)),
(geography::STGeomFromText('POINT(-122.348 47.649)',4326)),
(geography::STGeomFromText('POINT(-122.348 47.658)',4326)),
(geography::STGeomFromText('POINT(-122.358 47.653)',4326)) 
```

创建索引：

```
CREATE SPATIAL INDEX Spatialindex ON SpatialTable ( GeogCol1 ) USING GEOGRAPHY_GRID 
WITH (
    GRIDS =(LEVEL_1 = MEDIUM,LEVEL_2 = MEDIUM,LEVEL_3 = MEDIUM,LEVEL_4 = MEDIUM),
    CELLS_PER_OBJECT = 16, PAD_INDEX  = OFF, SORT_IN_TEMPDB = OFF,
    DROP_EXISTING = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON
) 
```

定义兴趣点：

```
DECLARE @g geography;
SET @g = geography::STGeomFromText('POINT(-122.34900 47.65100)', 4326); 
```

在点的 750m 内找到最近的 2

```
SELECT TOP 2
        @g.STDistance(st.GeogCol1) AS [DistanceFromPoint (in meters)] 
    ,   st.GeogCol2
    ,   st.id
FROM    SpatialTable st WITH(INDEX(SpatialIndex))
WHERE   @g.STDistance(st.GeogCol1) <= 750
ORDER BY @g.STDistance(st.GeogCol1) ASC 
```

给出：

```
DistanceFromPoint (in meters) GeogCol2                 id
----------------------------- ------------------------ -----------
234.715604015178              POINT (-122.348 47.649)  4
711.760044795868              POINT (-122.358 47.653)  6 
```

`SQL Execution Plan`表明正在使用索引，并且该[网站](http://www.freemaptools.com/how-far-is-it-between.htm "FreeMap工具")表明返回的距离是正确的

如果这不是您需要的，请告诉我，我正在尝试自己学习，所以任何修订都很好！

*** 编辑 **** 我添加了一个索引表提示来强制查询使用索引（根据这个[MSDN 帖子](http://blogs.msdn.com/b/isaac/archive/2008/08/29/is-my-spatial-index-being-used.aspx)）。该链接解释了最初可能没有使用索引，因为 SQL 确定不使用索引会更快。我上面示例的执行计划显示使用/不使用索引的比例为 97%/3%，因此在这种情况下，SQL 优化器的想法是正确的。

*为什么*使用索引时查询速度较慢似乎是[SO](https://stackoverflow.com/questions/9708323/spatial-index-slowing-down-query)上众多博客文章和问题的主题。

# android - Android将自定义样式设置为Paint

> ID：10192499
> 
> 赞同：3
> 
> 时间：2012-04-17T13:45:37.863
> 
> 标签：android, paint

我想知道关于`Paint`Android中的类的一件事。我正在查看`FingerPaint`Android SDK Demos 中的示例代码，我很好奇是否有任何方法可以设置`mPaint`他们在那里使用的自定义样式。我的意思是创建一些用户可以用来绘制东西的新画笔。

```
 mPaint = new Paint();
    mPaint.setAntiAlias(true);
    mPaint.setDither(true);
    mPaint.setColor(0xFFFF0000);
    mPaint.setStyle(Paint.Style.STROKE);
    mPaint.setStrokeJoin(Paint.Join.ROUND);
    mPaint.setStrokeCap(Paint.Cap.ROUND);
    mPaint.setStrokeWidth(12); 
```

或者也许它不是调用风格，不太确定，但我没有在互联网上找到任何关于这个问题的有用信息，所以这就是我在这里问它的原因。

如果有人可以给我建议/建议和信息，如果可能的话，我会很高兴，我该怎么做。

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T14:33:51.970

[使用BitmapShaders](http://developer.android.com/reference/android/graphics/BitmapShader.html)可以实现您想要的。所以你需要一个小的位图，它作为一个包含构成画笔的小线和点的蒙版。使用 Shader.TileMode.REPEAT 或 MIRROR。要更改画笔的颜色，请使用 setColorFilter 将[ColorFilter应用于 Paint。](http://developer.android.com/reference/android/graphics/ColorFilter.html)

# c# - 将变量从 ViewModel 传递到另一个 View (MVVMCross)

> ID：10192505
> 
> 赞同：9
> 
> 时间：2012-04-17T13:46:17.510
> 
> 标签：c#, android, xamarin.ios, xamarin.android, mvvmcross

在过去的几周里，我一直在使用 MVVMCross 框架开发一个跨平台应用程序（IOS/Android/WP7）。今天我遇到了一个我真的不知道如何解决的问题，所以希望你能把我推向正确的方向。

在 IOS 中，我有以下结构用于导航到另一个页面（下面的代码位于 ViewModel 中）：

```
KeyValuePair<string,string> kvpAct1 = new KeyValuePair<string, string>("short", ".countertest5");

public IMvxCommand BeckhoffActuator1
{
    get
    {           
        return new MvxRelayCommand<Type>((type) => this.RequestNavigate<Beckhoff.BeckhoffActuatorViewModel>(kvpAct1));
    }
} 
```

当这个 IMvxCommand 被触发（按下按钮）时，下一个视图被加载，在本例中是 BeckhoffActuatorViewModel。在 BeckhoffActuatorView 的代码中，我使用了上面的键值对：

```
public class BeckhoffActuatorView : MvxTouchDialogViewController<BeckhoffActuatorViewModel>
{

    ICollection<string> icol;

    public BeckhoffActuatorView(MvxShowViewModelRequest request) : base(request, UITableViewStyle.Grouped, null, true)
    {

        icol = request.ParameterValues.Values;

    }

    public override void ViewDidLoad()
    {
        //Code
    }
} 
```

这种结构在 IOS 中运行良好，但我想在我的 android 应用程序中使用相同的结构。

ViewModel 中的代码没有改变，因为这就是 MVVM 的全部理念。但是对于 Android，BackhoffActuatorView 的代码是不同的：

```
public class BeckhoffActuatorView : MvxBindingActivityView<BeckhoffSensorViewModel>
{
    public ICollection<string> icol;

    public BeckhoffActuatorView()
    {
        Debug.WriteLine("Standard");
    }

    public BeckhoffActuatorView(MvxShowViewModelRequest request)
    {
        Debug.WriteLine("Custom");

        icol = request.ParameterValues.Values;
    }

    protected override void OnViewModelSet()
    {

        SetContentView(Resource.Layout.BeckhoffActuatorView);

    }
} 
```

上面的代码不起作用，MvxBindingActivityView 似乎没有实现类似于我在 IOS 中使用的 ViewController 的东西。代码只出现在标准构造函数中，当我完全离开那个构造函数时，它不会编译/运行。

有谁知道我可以访问我使用 RequestNavigate 发送的键值对？谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-17T14:12:29.493

MVVMCross 非常基于约定 - 它的工作原理是尽可能在 ViewModel 之间传递消息。

如果您使用以下方法导航到 ViewModel：

```
KeyValuePair<string,string> kvpAct1 = new KeyValuePair<string, string>("short", ".countertest5");

public IMvxCommand BeckhoffActuator1
{
    get
    {           
        return new MvxRelayCommand<Type>((type) => this.RequestNavigate<Beckhoff.BeckhoffActuatorViewModel>(kvpAct1));
    }
} 
```

那么您应该能够使用构造函数在 BeckhoffActuatorViewModel 中获取它：

```
public class BeckhoffActuatorViewModel : MvxViewModel
{
    public BeckhoffActuatorViewModel(string short)
    {
        ShortValue = short;
    }

    private string _shortValue;
    public string ShortValue
    {
        get
        {
            return _shortValue;
        }
        set
        {
            _shortValue = value;
            FirePropertyChanged("ShortValue");
        }
    }
} 
```

然后您的视图可以访问`ViewModel.ShortValue`（对于 iOS，这可以在 base.ViewDidLoad() 之后完成，对于 Android 在 OnCreate() 之后以及对于 WP7 在 OnNavigatedTo 之后完成）

有关这方面的示例，请查看 TwitterSearch 示例：

*   [https://github.com/slodge/MvvmCrossTwitterSearch](https://github.com/slodge/MvvmCrossTwitterSearch)

这有一个 HomeViewModel 调用导航使用：

```
 private void DoSearch()
    {
        RequestNavigate<TwitterViewModel>(new { searchTerm = SearchText });
    } 
```

和一个使用构造函数接收 searchTerm 的 TwitterViewModel：

```
 public TwitterViewModel(string searchTerm)
    {
        StartSearch(searchTerm);
    } 
```

~~请注意，`string`目前在此消息传递中只允许 s - 但您始终可以使用 JSON.Net 序列化您自己的对象 - 或者您可以扩展框架 - 它是开源的。~~

请注意，目前在此构造函数参数中只允许传递`string`s、`int`s、`double`s 和`bool`s - 这是由于 Xaml Urls 和 Android Intents 的序列化要求。如果您想使用自己的自定义序列化对象来试验导航，请参阅[http://slodge.blogspot.co.uk/2013/01/navigating-between-viewmodels-by-more.html](http://slodge.blogspot.co.uk/2013/01/navigating-between-viewmodels-by-more.html)。

`RequestNavigate<TwitterViewModel>(new { searchTerm = SearchText });`另外，请注意，如果您想使用匿名对象`InternalsVisibleTo`导航[（ /AssemblyInfo.cs](https://github.com/slodge/MvvmCrossTwitterSearch/blob/master/TwitterSearch.Core/Properties/AssemblyInfo.cs)：

```
[assembly: InternalsVisibleTo("Cirrious.MvvmCross")] 
```

* * *

此外...不适合胆小的人...这不是“好的 mvvm 代码”...但是如果您真的想要/需要访问 Android 活动中的 MvxShowViewModelRequest 数据，那么您可以从传入 Intent - 有一个包含请求的 Extras 字符串（请参阅[https://github.com/slodge/MvvmCross/blob/master/Cirrious/Cirrious.MvvmCross/Android/Views/MvxAndroidViewsContainer.cs](https://github.com/slodge/MvvmCross/blob/master/Cirrious/Cirrious.MvvmCross/Android/Views/MvxAndroidViewsContainer.cs)`CreateViewModelFromIntent` 中的反序列化）

# android - android递归列出sd卡中的文件

> ID：10192507
> 
> 赞同：1
> 
> 时间：2012-04-17T13:46:21.883
> 
> 标签：android, file-listing

我想在我的 sd 卡中搜索特定文件。所以我试图列出完整的文件并搜索模式。请看下面的代码

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    String root_sd = Environment.getExternalStorageDirectory().toString();
    file = new File(root_sd);
    listfiles( new File(root_sd));

}

public void listfiles(File file) {

    //file = new File(path);
    // file = new File( root_sd ) ;
    File list[] = file.listFiles();
    Log.i("DIR", "PATH" +file.getPath());
    for (int i = 0; i < list.length; i++) {
        // myList.add( list[i].getName() );
        File temp_file = new File(file.getAbsolutePath(),list[i].getName());
        Log.i("DIR", "PATH" +temp_file.getAbsolutePath());
        if (temp_file.isFile() && temp_file.listFiles() != null) {
            Log.i("inside", "call fn");
            listfiles(temp_file);

        } else {
            if (list[i].getName().toLowerCase().contains("pattern1"))
                Log.i("File", i + list[i].getName());
            if (list[i].getName().toLowerCase().contains("pattern2"))
                Log.i("File", i + list[i].getName());

        }
    } 
```

这里只发生第一级搜索。这个条件`if (temp_file.isFile() && temp_file.listFiles() != null)`

总是返回 false，因此不会发生递归调用。请帮我修复它。感谢您的回答和时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T14:32:23.580

如果`temp_file.isFile()`返回 true，则表示它是一个文件，因此`temp_file.listFiles()`自动变为 null，从而使您的整个语句为 false。因此，您的组合语句始终返回 false。你需要的是一个`||`代替`&&`.

# java - Having issues with android manifest files

> ID：10192510
> 
> 赞同：0
> 
> 时间：2012-04-17T13:46:28.843
> 
> 标签：java, android, android-manifest

I have the following AndroidManifest file...

```
<?xml version="1.0" encoding="utf-8"?>
    <manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="net.obviam.droidz"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk android:minSdkVersion="8" />

    <application
        android:icon="@drawable/images"
        android:label="@string/app_name" android:debuggable="true">
        <activity android:name=".HomeView" android:label="@string/app_name">
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
        <activity android:name=".DroidzActivity">
        </activity>
        <activity android:name=".GameOver">
        </activity>

    </application>

</manifest> 
```

I am getting the following compilation error, which I can't seem to figure out...

```
 [2012-04-17 08:39:23 - com.android.ide.eclipse.adt.internal.project.AndroidManifestHelper] Parser exception for /home/joshua/workspace/Droidz/AndroidManifest.xml: Element type "activity" must be followed by either attribute specifications, ">" or "/>". 
```

Could anyone please suggest the cause of the error.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T13:09:08.760

Still unsure as to what happened, but it appears the formatting was not the problem. After restarting eclipse, the issues went away. Sorry to have bothered you all, thank you for your help though.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T13:50:54.523

Your manifest file should end with

```
</manifest> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-02T20:12:03.857

When something like this problem happens in Eclipse, it can help to refresh and rebuild the project. Eclipse from version 3.7 can handle auto-refresh [https://stackoverflow.com/a/6049245](https://stackoverflow.com/a/6049245).

# python - 有没有办法从字符串渲染 mako 模板？

> ID：10192519
> 
> 赞同：1
> 
> 时间：2012-04-17T13:47:20.120
> 
> 标签：python, pyramid, mako

我需要运行渲染存储在数据库中的字符串中的 mako 模板。代码应该像

```
emailtext = render(template_string, {}) 
```

有没有办法在不创建临时`.mako`文件的情况下这样做？

在此先感谢，伊万。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T13:58:01.697

当然，这是 Mako 文档中的第一个示例：http: [//docs.makotemplates.org/en/latest/usage.html#basic-usage](http://docs.makotemplates.org/en/latest/usage.html#basic-usage)

# jquery - 如何使用 jquery 和 ajax 通过单击按钮更改页面上的图像？

> ID：10192526
> 
> 赞同：0
> 
> 时间：2012-04-17T13:48:03.887
> 
> 标签：jquery, html, ajax

我的 html 页面上有一个按钮，当我单击它时，我希望它异步更改页面上的特定图像。所以我有类似的东西：

```
<a href="/test/page"> button </a> 
```

我想在这里改变我的形象：

```
<div id="container" style="display: none">
  <img src="/test/image.png" />
</div> 
```

我想我想在这里使用 ajax，但我对 Web 开发很陌生，我不确定，建议将不胜感激。

注意：我希望在不加载新页面的情况下发生这种情况，只需重新加载图像。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T13:50:13.847

```
$('a').click(function(e){
    e.preventDefault();

    $('img').attr("src","newURL");
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T07:05:49.553

我们在这个上不使用 AJAX 怎么样？

HTML：

```
<a href="#" class="imageChanger" data-imgsrc="/link/new/image.jpg"> Press me </a>
<a href="#" class="imageChanger" data-imgsrc="/link/new/image23.jpg"> Press me too! </a>
<div id="container">
   <img src="lalala.jpg">
</div> 
```

JS：

```
$(function() {
  $(document).on("click", ".imageChanger", function(e) {
    e.preventDefault();

    newSrc = $(this).data("imgsrc");

    $("#container").empty().append( '<img src=" ' + newSrc + ' ">' );

  });
}); 
```

这是从头部输入的，因此可能无法正常工作。我会在早上检查它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T14:01:20.093

我将从查看 jquery 和 jquery-ui api 文档开始

[http://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

[http://jqueryui.com/demos/button/](http://jqueryui.com/demos/button/)

你想要的是一个提交按钮，它将进行 ajax 调用并重新加载特定的 div。

关于 ajax 的问题是你从哪里得到图像。如果它来自后端服务器，您应该使用 ajax 调用。但是，如果它全部在客户端上，您只需进行普通的 java 脚本调用即可。

带有对某些后端服务器的 ajax 调用的按钮的粗略示例

```
<script>
$(function() {
    $( "input:submit", ".demo" ).button();
    $( "a", ".demo" ).click(function() {
           $.ajax({
               url: "some url call to get image",
               data: " any data you want passed",
               success: function(html) {
                       $("#demo").html(html); // html you want reloaded for the div. 
              }
    });
});
</script>

<div class="demo">

<input type="submit" value="A submit button">

</div><!-- End demo --> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-09-29T19:07:22.907

```
var counter = 1;
$(function() {
var imgArray = 
new Array("slide/1.jpg","slide/2.jpg","slide/3.jpg","slide/4.jpg");
$(document).on("click", "#btnSubmit", function(e) {
 e.preventDefault();
 if(counter>=imgArray.length)
 {
 counter=0;
 }
 newSrc = imgArray[counter++];//   $(this).data("imgsrc");
 $("#container").empty().append( '<img src=" ' + newSrc + ' " class="image-1-1"  width="100%" height="400">' );

});
}); 
```

html

```
<div id="container" class="coffee-span-8 column-1">
<img src="/slide/1.jpg" class="image-1-1"  width="100%" height="400" ></img>
 </div>
 <div class="coffee-span-6"><form METHOD="LINK" ACTION="index.html">    <button id="btnSubmit" type="submit">next</button></FORM>
 </div> 
```

# wpf - WPF 上下文相关菜单功能区

> ID：10192527
> 
> 赞同：3
> 
> 时间：2012-04-17T13:48:10.823
> 
> 标签：wpf, menu, ribbon

我对 wpf 有点陌生。

我试图让备受赞誉的功能区成为我的自定义应用程序的所有菜单和命令的中心

现在我的主窗口是一个带有几个主要选项卡的选项卡控件：联系人、销售、约会、费用等。

tabcontrol 的顶部是一个功能区

（非常类似于 MS Outlook）

对于每个选项卡，我有不同的按钮，我需要

（每个选项卡都显示不同的 UserControl 作为其主要内容）

另外还有几个按钮应该始终在功能区中（设置，关于，新约会......）

最好的办法是我可以直接在用户控件中添加 RibbonTabs，并根据可见选项卡在运行时以某种方式自动将它们与主功能区合并

如果那不可能，那么有一个叫做 ContextualTabGroups 的东西，但在我的一生中，我找不到任何关于如何将不同的功能区绑定/触发到某些情况/子控件或其他东西的信息。

如果我需要在加载和关闭每个用户控件时调用 .visibilty，那么就没有任何“上下文”

非常感谢您

# javascript - 带有ios的Phonegap中的Facebook javascript sdk？

> ID：10192528
> 
> 赞同：3
> 
> 时间：2012-04-17T13:48:16.640
> 
> 标签：javascript, ios, facebook, cordova

这是我的代码

```
<html>
    <head>
        <head>
            <title></title>

           <script type="text/javascript" charset="utf-8" src="cordova-1.6.0.js"></script>
           <script type="text/javascript">

                    function go()
                    {

                        FB.login(function(response) {
                                 if (response.authResponse) {
                                 console.log('Welcome!  Fetching your information.... ');
                                 FB.api('/me', function(response) {
                                        console.log('Good to see you, ' + response.name + '.');
                                        });
                                 } else {
                                 console.log('User cancelled login or did not fully authorize.');
                                 }
                                 });                        

                    }

                </script>

                <body>
                    <div id="fb-root">

                    </div>

                    <script>
                        window.fbAsyncInit = function() {
                            FB.init({
                                    appId      : '', // App ID
                                    channelUrl : '', // Channel File
                                    status     : true, // check login status
                                    cookie     : true, // enable cookies to allow the server to access the session
                                    xfbml      : true,  // parse XFBML
                                    oauth      : true  //oauth v2.0 
                                    });

                        };

                        // Load the SDK Asynchronously
                        (function(d){
                         var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
                         if (d.getElementById(id)) {return;}
                         js = d.createElement('script'); js.id = id; js.async = true;
                         js.src = "//connect.facebook.net/en_US/all.js";
                         ref.parentNode.insertBefore(js, ref);
                         }(document));

                        </script>

                    <input onclick="go();" type='submit' id='login-button' value='Login' name='login' >

                </body>
</html> 
```

基本上，您单击该按钮，它应该会显示一个登录弹出窗口。当我在普通浏览器中尝试时它可以工作，但是当我在 iPhone 模拟器中尝试时没有任何反应。iv 还将 iPhone 浏览器设置为允许弹出窗口。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T10:03:42.533

我使用名为 Childbrowser 的 phonegap 插件让它工作了 :)

# iphone - Xcode，目标 C，IOS。线程 1：程序接收到的信号：“SIGABRT”。我做错了什么

> ID：10192533
> 
> 赞同：0
> 
> 时间：2012-04-17T13:48:37.133
> 
> 标签：iphone, objective-c, ios, xcode4, syntax-error

即使我将所有框架和代码添加到另一个 Xcode 应用程序中，我仍然在我的应用程序中遇到这个问题。它甚至在视图加载之前发生。

这是我的错误信息：

```
[Switching to process 11523 thread 0x2d03]
[Switching to process 11523 thread 0x2d03]
warning: No copy of <No file name> found locally, reading from memory on remote device.  This may slow down the debug session.
warning: No copy of <No file name> found locally, reading from memory on remote device.  This may slow down the debug session.
sharedlibrary apply-load-rules all
warning: No copy of <No file name> found locally, reading from memory on remote device.  This may slow down the debug session.
warning: No copy of <No file name> found locally, reading from memory on remote device.  This may slow down the debug session.
warning: No copy of <No file name> found locally, reading from memory on remote device.  This may slow down the debug session.
warning: Unable to read symbols for /Users/admin/Library/Developer/Xcode/iOS DeviceSupport/4.2.1 (8C148)/Symbols/usr/lib/info/dns.so (file not found).
warning: No copy of dns.so found locally, reading from memory on remote device.  This may slow down the debug session.
warning: No copy of <No file name> found locally, reading from memory on remote device.  This may slow down the debug session.
warning: No copy of <No file name> found locally, reading from memory on remote device.  This may slow down the debug session.
warning: No copy of <No file name> found locally, reading from memory on remote device.  This may slow down the debug session.
2012-04-17 09:33:30.166 Little Birds! - iPhone[7445:307] *** Terminating app due to uncaught exception 'NSUnknownKeyException', reason: '[<UIApplication 0x1129f0> setValue:forUndefinedKey:]: this class is not key value coding-compliant for the key HighScoresPodium.'
*** Call stack at first throw:
(
    0   CoreFoundation                      0x35f08c7b __exceptionPreprocess + 114
    1   libobjc.A.dylib                     0x30186ee8 objc_exception_throw + 40
    2   CoreFoundation                      0x35f08a01 -[NSException dealloc] + 0
    3   Foundation                          0x34018bbf -[NSObject(NSKeyValueCoding) setValue:forUndefinedKey:] + 186
    4   Foundation                          0x34018051 _NSSetUsingKeyValueSetter + 92
    5   Foundation                          0x34019ef3 -[NSObject(NSKeyValueCoding) setValue:forKey:] + 178
    6   Foundation                          0x33fcb805 -[NSObject(NSKeyValueCoding) setValue:forKeyPath:] + 144
    7   UIKit                               0x33aacf20 -[UIRuntimeOutletConnection connect] + 96
    8   CoreFoundation                      0x35ea9a8b -[NSObject(NSObject) performSelector:] + 18
    9   CoreFoundation                      0x35eb273b -[NSArray makeObjectsPerformSelector:] + 366
    10  UIKit                               0x33aab7a0 -[UINib instantiateWithOwner:options:] + 868
    11  UIKit                               0x33aad640 -[NSBundle(UINSBundleAdditions) loadNibNamed:owner:options:] + 140
    12  UIKit                               0x3386cb18 -[UIApplication _loadMainNibFile] + 144
    13  UIKit                               0x338669ec -[UIApplication _runWithURL:payload:launchOrientation:statusBarStyle:statusBarHidden:] + 256
    14  UIKit                               0x338202e4 -[UIApplication handleEvent:withNewEvent:] + 1476
    15  UIKit                               0x3381fb1c -[UIApplication sendEvent:] + 68
    16  UIKit                               0x3381f3b4 _UIApplicationHandleEvent + 6824
    17  GraphicsServices                    0x35262c88 PurpleEventCallback + 1048
    18  CoreFoundation                      0x35e9a5cb __CFRUNLOOP_IS_CALLING_OUT_TO_A_SOURCE1_PERFORM_FUNCTION__ + 28
    19  CoreFoundation                      0x35e9a589 __CFRunLoopDoSource1 + 164
    20  CoreFoundation                      0x35e8c835 __CFRunLoopRun + 580
    21  CoreFoundation                      0x35e8c50b CFRunLoopRunSpecific + 226
    22  CoreFoundation                      0x35e8c419 CFRunLoopRunInMode + 60
    23  UIKit                               0x33865554 -[UIApplication _run] + 548
    24  UIKit                               0x33862558 UIApplicationMain + 972
    25  Little Birds! - iPhone              0x0000248f main + 106
    26  Little Birds! - iPhone              0x00002420 start + 40
)
terminate called after throwing an instance of 'NSException'
warning: No copy of <No file name> found locally, reading from memory on remote device.  This may slow down the debug session.
(gdb) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T14:01:58.853

对我来说，这似乎是一个死机连接。XIB 中的对象连接到已从所有者类中删除的插座。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T13:51:53.520

您可以检查 XIB 的接口构建器中的所有连接吗？尝试重新创建 XIB。当我错误地从 IB 中删除标签并在标签上调用 setText 时，我发现了问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T14:04:01.137

看起来您的问题与“HighScoresPodium”有关。您可能错误地为该变量分配了一些东西。检查您将与该属性交互的位置，您应该接近问题。正如其他人所说，问题可能隐藏在 XIB 连接中。

# delphi - Delphi - 每个名称调用记录方法

> ID：10192534
> 
> 赞同：8
> 
> 时间：2012-04-17T13:48:38.747
> 
> 标签：delphi, record, rtti

我为我的应用程序编写了一种脚本语言，我的目标是使从 delphi 中发布任何类型的脚本成为可能。我使用 rtti 来自动化这个任务。对于像类这样的任何实例类型，我使用以下代码从脚本中查找和调​​用方法。

```
var  Info : TRttiType;  
     Meth : TRttiMethod;  
     Param : TArray<TValue>;  
     Result : TValue;  
     AnyClass : TClass;   
begin  
  ...  
  Info := RttiContext.GetType(AnyClass);  
  Meth := Info.GetMethod('AMethod');  
  Setlength(Param, 1);  
  Param[0] := TValue.From<Integer>(11);  
  Result := Meth.Invoke(ClassInstance, Param);  
  ...  
end; 
```

但是对于记录，此代码不起作用，因为 TRttiMethod 类型不为记录类型提供 Invoke() 方法。我可以通过 Info.GetMethod('AMethod') 从记录类型访问方法信息。
例如我有这样的记录：

```
TRecordType = record  
  Field1, Field2 : single;  
  procedure Calc(Value : integer);   
end; 
```

那么如果我有方法名或方法地址，有人知道从记录中调用方法的方法吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-17T16:02:11.547

在浏览了上面评论中发布的 delphi 文档中的链接之后，我仔细查看了 System.Rtti 中的 delphi 类型 TRttiRecordMethod。它提供了 DispatchInvoke() 方法，并且该方法需要一个指针。所以下面的代码有效：

```
TRecordType = record   
  Field1, Field2 : single;   
  procedure Calc(Value : integer);    
end; 

  Meth : TRttiMethod; 
  Para : TRttiParameter; 
  Param : TArray<TValue>; 
  ARec : TRecordType; 
begin 
  Info := RttiContext.GetType(TypeInfo(TRecordType)); 
  Meth := Info.GetMethod('Calc'); 
  Setlength(Param, 1); 
  Param[0] := TValue.From<Integer>(12); 
  Meth.Invoke(TValue.From<Pointer>(@ARec), Param); 
end; 
```

如果要调用静态方法或重载运算符，则代码不起作用。Delphi 在内部总是将 self 指针添加到参数列表，但这会导致访问冲突。因此，请改用此代码：

```
 Meth : TRttiMethod; 
  Para : TRttiParameter; 
  Param : TArray<TValue>; 
  ARec : TRecordType; 
begin 
  Info := RttiContext.GetType(TypeInfo(TRecordType)); 
  Meth := Info.GetMethod('&op_Addition'); 
  ... 
  Meth.Invoke(TValue.From<Pointer>(@ARec), Param); 
  Result := System.Rtti.Invoke(Meth.CodeAddress, Param, Meth.CallingConvention, Meth.ReturnType.Handle, Meth.IsStatic); 
end; 
```

# c# - 有没有更好的方法来用 Moq 编写这个测试？

> ID：10192540
> 
> 赞同：1
> 
> 时间：2012-04-17T13:48:54.783
> 
> 标签：c#, unit-testing, moq

我有一个私有方法，它在我正在测试的方法中被调用。我想验证是否将正确的参数传递给这个私有方法。我在 Moq 中编写了以下设置，它将测试我想要的内容，但是它并没有真正让我遵循 Arrange、Act、Assert 模式。

有什么方法可以执行类似的测试，其中断言可以与我的所有其他断言一起出现？目前，下面的代码位于 Arrange 中。

```
 myClass.Setup(
                x =>
                x.myMethod(
                    It.IsAny<Person>>(),
                    It.IsAny<string>(),
                    It.IsAny<Person>(),
                    It.IsAny<ICollection<string>>(),
                    It.IsAny<ICollection<string>>(),
                    It.IsAny<bool>())).Callback
                <Person, string, Person, Person, ICollection<string>, bool>(
                    (a, b, c, d, e, f) =>
                        { 
                            Assert.AreEqual("NameA", a.Name); 
                            Assert.AreEqual("StringB", b);
                            Assert.AreEqual("NameC", c.Name);
                            Assert.AreEqual(2, d);

                            var dList = d.ToList().OrderBy(x => x.Name);
                            Assert.AreEqual("PersonA", dList[0].Name)
                            Assert.AreEqual("PersonB", dList[1].Name);
                        }); 
```

我应该说，我知道您可以执行验证以检查是否已使用某些输入调用方法，但是我不知道有任何匹配 ICollection 参数的方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T14:07:20.843

如果您使用这些断言来检查参数，您可以在您的设置中进行。如果您的模拟使用严格的行为，如果参数与谓词不匹配，它将失败。

```
 // declare your mock with strict behavior

 myClass.Setup(
     x =>
     x.myMethod(
         It.Is<Person>(person => person.Name == "NameA"),
         "Stringb",
         It.Is<Person>(person => person.Name == "NameC"),,
         It.Is<ICollection<string>>(coll =>{ 
                //your other validations
            }),
         It.IsAny<ICollection<string>>(),
         It.IsAny<bool>())); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T13:57:00.543

单元测试的目的是验证您的类的行为是否符合预期。您应该通过其公共接口练习课程并检查以下内容：

*   类状态变化
*   返回结果
*   调用依赖

当类按预期运行时，其他东西没有价值。您可以重构您的类并使该私有方法内联。

# c# - 扩展具有返回类型的方法

> ID：10192541
> 
> 赞同：0
> 
> 时间：2012-04-17T13:49:02.273
> 
> 标签：c#, extension-methods

我正在尝试扩展一个已经具有返回类型的方法。例如：

```
IQueryable<int> GetCategoryIds() 
```

因此，我可以按如下方式使用它：

```
IQueryable<int> categories = GetCategoryIds(); 
```

我目前正在做：

```
IQueryable<int> categories = GetCategoryIds().Select(c => new Client() { ClientId == c.clientId }); 
```

这行得通，但我不想这样做`Select`。我宁愿做一个除了 a 之外的扩展方法，`type`这样我就可以在扩展方法中使用反射来确定类型等并返回相应的结果。扩展方法类似于：

```
public static IQueryable<T> LovelyExtension(this T objectType, int clientId) 
```

然后我可以使用这个扩展（希望如此）：

```
IQueryable<int> categories = GetCategoryIds().LovelyExtension<int>(1); 
```

这可能吗？当我尝试它时，我得到了一个错误，因为`GetCategoryIds`返回类型与扩展方法不同。但是，这适用于`Select`声明。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T13:56:30.107

您不需要编写扩展名`Type`（您的示例也没有这样做）。您需要在`IQueryable<T>`. 你可以这样做：

```
public static IQueryable<T> LovelyExtension<T>(this IQueryable<T> input, int clientId) {
    Type inputType = typeof(T);
    // Here you can use reflection if you need to: inputType corresponds to the type of T
    // Create an instance of IQueryable<T>, and return it to the caller.
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T13:56:08.360

更改您的签名，

```
public static IQueryable<T> LovelyExtension(this T objectType, int clientId) 
```

到

```
public static T LovelyExtension(this T objectType, int clientId) 
```

或者

```
public static IQueryable<T> LovelyExtension(this IQuerable<T> objectType, int clientId) 
```

GetCategoryIds() 返回一个 IQuerable （这是您传递给 LovelyExtension 的 objectType 的内容，您基于原始签名的返回类型变为 IQuerable>，这显然与您所追求的不匹配。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T13:56:31.273

我相信您将需要在您的客户端类上声明一个接口并为您的扩展方法添加一个约束。看看这个帖子[通用扩展方法](https://stackoverflow.com/questions/835843/generic-extension-method)

# css - 条件注释与 Javascript

> ID：10192542
> 
> 赞同：1
> 
> 时间：2012-04-17T13:49:05.433
> 
> 标签：css

目前我正在开发一个网页，只需要为 IE 设置一个样式。我正在使用有条件的评论：

```
<!--[if IE]>
    <link rel="Stylesheet" href="../../IEstyles.css" rel="Stylesheet" />
<![endif]--> 
```

这是执行此操作的最佳方法还是使用 javascript 是最佳实践？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T13:51:58.760

[Html5Boilerplate](http://html5boilerplate.com)是最佳实践的网站，他们的建议如下：

```
<!-- paulirish.com/2008/conditional-stylesheets-vs-css-hacks-answer-neither/ -->
<!--[if lt IE 7 ]> <html class="no-js ie6" lang="en"> <![endif]-->
<!--[if IE 7 ]>    <html class="no-js ie7" lang="en"> <![endif]-->
<!--[if IE 8 ]>    <html class="no-js ie8" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!--> <html class="no-js" lang="en"> <!--<![endif]--> 
```

这使您可以保留一个样式表，只需将上述任何类添加到针对特定条件黑客的前面。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T13:52:03.677

这几乎是最佳实践。您可能应该改为检查`[if lt IE 9]`，因为 IE 9 很好地支持 CSS，但*绝对*不要使用浏览器嗅探 JavaScript。这几乎总是解决问题的最坏方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T13:51:06.327

不是每个人都启用了 JavaScript - 我所知道的每个主流浏览器都支持 HTML 注释。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-17T13:51:18.950

由于这只是一个样式表，因此是一个 UI 问题，我会避免使用 javascript，而只使用条件注释来定位 IE。如果您尝试进行某种浏览器嗅探，这也解决了禁用 javascript 的人的问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-17T13:51:55.687

使用条件注释。它们可以防止其他浏览器必须下载/运行任何脚本，但具有始终为 IE 用户工作的好处。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-17T13:52:04.160

使用条件将是最好的主意，因为您无法保证访问者不会禁用 javascript 或禁用脚本。由于这仅适用于 IE 浏览器，其他浏览器将忽略它，而所有浏览器都将处理 Javascript，无论是否用于 IE。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-04-17T13:52:05.953

Javascript 可以被禁用，所以我会说条件注释是提供特定于 IE 的 CSS 的最佳方式。

# c# - 使用 ADO.NET 连接到 SQL Azure

> ID：10192550
> 
> 赞同：1
> 
> 时间：2012-04-17T13:49:30.900
> 
> 标签：c#, ado.net, azure-sql-database

您好我尝试使用 ADO.NET 连接到 SQL AZURE DB。

这是我的代码：

```
private static string userName = "<**@********>";
private static string password = "<********>";
private static string dataSource = "<******.database.windows.net>";
private static string databaseName = "<******>";

public void Save()
{
    SqlDataReader queryResultCloud;
    string queryString = "select * from tblScan";

    SqlConnectionStringBuilder connString2Builder;
    connString2Builder = new SqlConnectionStringBuilder();
    connString2Builder.DataSource = dataSource;
    connString2Builder.InitialCatalog = databaseName;
    connString2Builder.Encrypt = true;
    connString2Builder.TrustServerCertificate = false;
    connString2Builder.UserID = userName;
    connString2Builder.Password = password;

    using (SqlConnection connection = new SqlConnection(connString2Builder.ConnectionString))
    {
        SqlCommand command = new SqlCommand(queryString);
        command.Connection = connection;
        connection.Open();

        queryResultCloud = command.ExecuteReader();
        connection.Close();
    } 
```

我得到下一个错误：

```
A network-related or instance-specific error occurred while establishing a connection to SQL Server. The server was not found or was not accessible. Verify that the instance name is correct and that SQL Server is configured to allow remote connections. (provider: Named Pipes Provider, error: 40 - Could not open a connection to SQL Server) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-01T16:36:12.223

您可能使用了不允许到端口 1433 的出站连接的代理，这是[您可以与 SQL Azure 一起使用的唯一端口](http://msdn.microsoft.com/library/azure/ee336282.aspx)：

> Windows Azure SQL 数据库服务仅适用于 TCP 端口 1433。要从您的计算机访问 SQL 数据库数据库，请确保您的防火墙允许 TCP 端口 1433 上的传出 TCP 通信。

我也在这种情况下，最有希望/最具挑战性的解决方案似乎是这种[端口桥接应用程序技术](http://www.dotnetsolutions.co.uk/blog/connecting-to-sql-azure-without-changing-your-firewall)，但解决方案本身已经过时并且需要比我安装的旧版本的 VS，所以我正在看一些其他选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T08:06:05.057

您的代码似乎是正确的。要尝试的一件事是将 TrustServerCertificate 设置为 true，并查看它是否有效。请注意，当 Encrypt 设置为 true 时，建议将此属性设置为 false。但有报道称组合会导致连接问题。我建议您查看[http://www.wadewegner.com/2010/08/using-the-trustservercertificate-property-with-sql-azure-and-entity-framework/](http://www.wadewegner.com/2010/08/using-the-trustservercertificate-property-with-sql-azure-and-entity-framework/)了解更多信息。此外，再次检查您是否已将 SQL Azure 防火墙配置为允许连接到本地计算机。如果您使用代理，则需要将代理的 IP 地址添加到防火墙例外中。

此致，

明旭。

# image-processing - 通过基本矩阵校正未校准的相机

> ID：10192552
> 
> 赞同：5
> 
> 时间：2012-04-17T13:49:48.777
> 
> 标签：image-processing, opencv, emgucv, camera-calibration

我正在尝试使用 Emgu/OpenCV 校准 Kinect 摄像头和外部摄像头。我被困住了，我真的很感激任何帮助。

我选择通过基本矩阵，即极线几何来做到这一点。但结果并不如我所料。结果图像是黑色的，或者根本没有意义。Mapx和mapy点通常都等于infinite或-infinite，或者都等于0.00，很少有正则值。

这就是我尝试纠正的方式：

1.）**查找图像点** 从一组图像中获取两个图像点数组（每个相机一个）。我已经使用 chessboard 和 FindChessboardCorners 函数完成了这项工作。

2.) **找到基本矩阵**

```
 CvInvoke.cvFindFundamentalMat(points1Matrix, points2Matrix, 
_fundamentalMatrix.Ptr, CV_FM.CV_FM_RANSAC,1.0, 0.99, IntPtr.Zero); 
```

我是从整组图像中传递所有收集的点，还是仅从试图纠正的两个图像中传递？

3.)**查找单应矩阵**

```
 CvInvoke.cvStereoRectifyUncalibrated(points11Matrix, points21Matrix, 
_fundamentalMatrix.Ptr, Size, h1.Ptr, h2.Ptr, threshold); 
```

4.)**获取 mapx 和 mapy**

```
double scale = 0.02;
CvInvoke.cvInvert(_M1.Ptr, _iM.Ptr, SOLVE_METHOD.CV_LU);

CvInvoke.cvMul(_H1.Ptr, _M1.Ptr, _R1.Ptr,scale);
CvInvoke.cvMul(_iM.Ptr, _R1.Ptr, _R1.Ptr, scale);
CvInvoke.cvInvert(_M2.Ptr, _iM.Ptr, SOLVE_METHOD.CV_LU);
CvInvoke.cvMul(_H2.Ptr, _M2.Ptr, _R2.Ptr, scale);
CvInvoke.cvMul(_iM.Ptr, _R2.Ptr, _R2.Ptr, scale);

CvInvoke.cvInitUndistortRectifyMap(_M1.Ptr,_D1.Ptr, _R1.Ptr, _M1.Ptr, 
mapxLeft.Ptr, mapyLeft.Ptr) ; 
```

我有一个问题......因为我没有使用校准图像，我的相机矩阵和失真系数是多少？如何从基本矩阵或单应矩阵中得到它？

5.)**重新映射**

```
CvInvoke.cvRemap(src.Ptr, destRight.Ptr, mapxRight, mapyRight, 
(int)INTER.CV_INTER_LINEAR, new MCvScalar(255)); 
```

这并没有返回好的结果。如果有人能告诉我我做错了什么，我将不胜感激。

我有 25 对图像，棋盘图案大小为 9x6。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-15T19:08:22.930

O'Reilly 出版的“Learning OpenCV”一书有两整章专门讨论这个特定主题。两者都大量使用 OpenCV 包含的例程 cvCalibrateCamera2() 和 cvStereoCalibrate(); 这些例程是代码的包装器，与您在此处编写的代码非常相似，另外还有一个好处是可以由维护 OpenCV 库的人员进行更彻底的调试。虽然它们很方便，但两者都需要相当多的预处理才能实现例程的必要输入。实际上可能有一个示例程序，位于 OpenCV 发行版的示例目录的深处，它使用这些例程，以及如何从棋盘图像到校准/内在矩阵的示例。如果你深入了解这些地方，

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-08-04T21:47:09.247

`cv::findFundamentalMat`如果图像点的内在参数是单位矩阵，则无法工作。换句话说，它不能处理未投影的图像点。

# php - 使用 $_SESSION 缓冲/缓存 MySQL 查询

> ID：10192554
> 
> 赞同：7
> 
> 时间：2012-04-17T13:49:59.813
> 
> 标签：php, mysql, session, caching

我正在开发一个网站。目前，我正在使用cheapo 共享主机。但是一个男孩可以做梦，我已经在考虑我网站上的大量用户会发生什么。

访问者需要偶尔写入数据库，因为他们在网站上的游戏进度会被记录下来。

我想通过将进度和其他信息实时写入`$_SESSION`变量来最小化查询。只有当会话被破坏（注销、浏览器关闭或超时）时，我才想将内容写入`$_SESSION`数据库。

**问题：**

1.  那可能吗？当会话因超时或关闭浏览器而被破坏时，有没有办法执行函数？

2.  这有道理吗？对于共享服务器来说，几百个并发 SQL 查询是否会成为问题，并且使用`$_SESSION`作为缓冲区的想法会缓解其中的一些问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-17T13:58:44.680

> 当会话因超时或关闭浏览器而被破坏时，有没有办法执行函数？

是的，但它可能不像你想象的那样工作。您可以使用 定义自己的自定义会话处理程序[`session_set_save_handler`](http://php.net/manual/en/function.session-set-save-handler.php)，并且定义的一部分是提供`destroy`和`gc`回调函数。这两个在会话被显式销毁以及由于过期而被销毁时被调用，因此它们完全按照您的要求执行。

但是，由于超时而导致的会话到期*不会*以发条精度发生；过期会话实际上是“垃圾收集”可能需要很长时间。此外，垃圾收集是[概率性](http://php.net/manual/en/session.configuration.php#ini.session.gc-probability)触发的，因此*理论上*过期会话有可能*永远不会*被垃圾收集。

> 这有道理吗？对于共享服务器来说，几百个并发 SQL 查询是否会成为问题，并且使用 $_SESSION 作为缓冲区的想法可以缓解其中的一些问题。

我真的不会这样做有几个原因：

*   过早的优化（在你测量之前，不要只是假设它会“更好”）。
*   会话可能永远不会被垃圾收集；即使这没有发生，您也无法控制它们*何时*被收集。这可能是个问题。
*   有可能丢失会话包含的所有内容（例如服务器重新启动），其中包括玩家进度。玩家不喜欢失去进度。
*   同一用户的并发会话是不可能的（谁的“保存的数据”获胜并保留在数据库中？）。

替代品呢？

好吧，既然我们谈论的是便宜的共享主机，你肯定不会控制服务器，所以任何涉及 PHP 扩展（例如 memcached）的东西都是有条件的。数据库端缓存也不会飞。此外，您的服务器上的负载将受到您无法控制的变量的影响，因此您无法真正进行任何容量规划。

在任何情况下，我都会首先确保数据库本身的结构是最佳的，并且代码的编写方式可以最大限度地减少数据库的负载（只需在编辑器中输入内容即可释放性能）。

之后，您可以引入*只读缓存*：通常有很多东西需要显示但不打算修改。对于“几乎永远不会”更新的数据，您可以在需要时使会话缓存失效，这可能是一个简单且非常有效的改进（您甚至可以在失效方面出现误报，只要它们在宏伟的计划）。

最后，如果您担心在单个请求中两次从数据库中提取相同的数据，您可以添加每个请求的缓存（在变量中）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-17T13:57:59.330

在会话被销毁时写入数据不是一个好主意。由于会话数据可以通过您的主机配置的垃圾收集器销毁，因此您不知道会话何时真正关闭，直到用户的 cookie 过期。

所以...我建议您使用共享内存 (RAM) 缓存系统，如 memcache（如果您的主机提供它）或基于磁盘的缓存系统。

顺便说一句，如果您的查询经过优化，列正确索引等，您的共享主机可能会“同时”处理大量查询。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-17T14:04:11.963

> 这有道理吗？对于共享服务器来说，几百个并发 SQL 查询是否会成为问题，并且使用 $_SESSION 作为缓冲区的想法会缓解其中的一些问题。

不。首先，您永远不知道会话会发生什么（注销很明显，超时几乎无法检测到），因此无论如何它都不是值得信赖的缓存机制。如果您在几个请求的范围内多次查询结果，但这些结果不会经常更改，请将这些查询的结果保存到专用缓存机制，例如[APC](http://nl.php.net/manual/en/function.apc-add.php)或 memcached。

现在，我知道您的虚拟主机不会提供这些缓存系统，但是，您可能可以做不同的事情来优化您的网站。对于初学者，我最复杂的软件产品（*相当*复杂）平均每页查询数据库大约 6 次。如果结果是可重用的，我倾向于使用缓存，这样可以减少查询的数量。

最重要的是，编写*体面的*查询更为重要；您的设计和查询的质量比数量更重要。如果你的架构、索引和查询正确，10 个查询比一个未优化的查询要快。我会花时间研究如何编写有效的查询并阅读索引，而不是尝试通过“解决方法”来克服问题，例如在会话中缓存。

祝你好运，我希望你的网站取得如此巨大的成功，你实际上需要上面的建议；）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-17T14:01:16.270

实际上，您可以使用 $_SESSION 作为缓冲区来避免重复读取，这对我来说似乎是个好主意（memcached 甚至比这更好），当然不是为了延迟写入（这要复杂得多，应该由数据库处理）；

您可以使用保存在 $_SESSION 中的简单哈希

```
$cache = array();
$_SESSION['cache'] = $cache; 
```

那么当你必须进行查询时

```
if(isset($_SESSION['cache'][$id]){
    //you have a cache it
    $question = $_SESSION['cache'][$id];
}else{
    //no cache, retrieve your $question  and save it in the cache
    $_SESSION['cache'][$id] = $question ;
} 
```

# iphone - 如何将我的应用程序提供给客户进行测试

> ID：10192555
> 
> 赞同：0
> 
> 时间：2012-04-17T13:50:02.183
> 
> 标签：iphone, ios, xcode, ipad, ios5

嗨，我正在为居住在国外的客户开发一个 iphone 应用程序。每次我完成一项功能时，客户都希望查看该应用程序，以记录我的进度并提出必要的更改建议。如何在项目完全完成之前将我的应用程序提供给客户进行测试。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T13:52:50.047

你可以给他们 ADHOC 或你的应用程序的测试版本。

自己做起来相对容易（并且说明很容易在 Apple 的[“iOS 配置门户”](https://developer.apple.com/ios/manage/overview/index.action)上找到，或者也有一些在线第三方提供的服务可以让这个过程更加简单。我听说过好东西例如，关于[TestFlight](https://testflightapp.com)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-17T13:52:51.153

我建议您[创建一个临时证书](http://developer.apple.com/library/ios/#documentation/ToolsLanguages/Conceptual/DevPortalGuide/CreatingandDownloadingaDistributionProvisioningProfile/CreatingandDownloadingaDistributionProvisioningProfile.html)。然后使用[xcode 创建您的存档](http://diaryofacodemonkey.ruprect.com/2011/03/18/ad-hoc-app-distribution-with-xcode-4/)。
ps：您需要`UDID`客户端 iPhone 的 s 才能将设备添加到门户。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T18:49:49.983

你可以这样做-

1) 添加客户端的 UDID 并使用特定的配置文件和证书来构建您的应用程序。

2) 创建一个签名的 .ipa 和 .plist 文件。（分发给企业选项）。

3) 更简单的分发方式，因为您可以将其放在保管箱上并将其附加到 html 文件中。

4) 向您的客户发送您放在 Dropbox 上的那个 html 页面的公共链接。

希望能帮助到你。:)

# oauth - 带有 Oauth 支持的 Jersey 1.12

> ID：10192558
> 
> 赞同：0
> 
> 时间：2012-04-17T13:50:13.427
> 
> 标签：oauth, jersey

我正在尝试使用 OAuth 保护我的 Jersey (Jax RS) ReSTFul API，但并不是很成功。
如果我在部署到 Tomcat 时跳过 Jersey OAuth jar 文件（客户端、服务器、核心），它工作得很好，但是，当我添加 Jersey OAuth jar 时，尝试调用我的任何端点时都会出现以下错误：

> 严重：在参数索引处缺少构造函数公共 com.sun.jersey.oauth.server.api.OAuthServerFilter(com.sun.jersey.api.core.ResourceConfig,com.sun.jersey.oauth.server.spi.OAuthProvider) 的依赖项1 严重：缺少字段依赖项：私有 com.sun.jersey.oauth.server.spi.OAuthProvider com.sun.jersey.oauth.server.api.resources.AccessTokenRequest.provider 严重：缺少字段依赖项：私有 com.sun .jersey.oauth.server.spi.OAuthProvider com.sun.jersey.oauth.server.api.resources.RequestTokenRequest.provider

我检查了整个互联网，找不到任何提到这一点的东西。

我不知道还要在这篇文章中添加什么来帮助回答我做错了什么的问题。

谢谢。

编辑：

好的，我知道发生了什么...我不是要注入我的“请求”中的“提供者”

我在 web.xml 中使用以下 init-param 来添加 DefaultOAuthProvider，但它似乎没有帮助：

```
<init-param>
  <param-name>com.sun.jersey.config.property.packages</param-name>
  <param-value>com.sun.jersey.oauth.server.api.resources;com.sun.jersey.oauth.server.api.providers</param-value>
</init-param> 
```

调试控制台甚至说：

> 信息：找到提供程序类：com.sun.jersey.oauth.server.api.providers.DefaultOAuthProvider 类

我很困惑！！！！

# drupal - Drupal 7 - 动态、可折叠、导航栏/块

> ID：10192561
> 
> 赞同：0
> 
> 时间：2012-04-17T13:50:28.860
> 
> 标签：drupal, navigation, drupal-7

因为一张图讲了1000多个字。

在左侧，你会看到我需要什么。
在右侧，您可以看到我已经拥有的东西。

**问题：**

是否有可能在导航块（或类似的东西）中显示所有章节，如导航树？具有可折叠节点，同时如果您单击其中一些章节，主页会更改吗？

也许用jquery？
但是我找不到任何好的文档，我可以说，这就是我需要的。

我希望有人能帮忙

亲切的问候。

迪特

!['一张图片告诉了1000多个单词'](../Images/1f68d585ec8a5aeabb1e82223facd37a.png)

编辑：链接到图像->[图像全屏](http://verbeemen.sinners.be//a/Nieuwe%20map/example.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T03:27:20.250

使用菜单块模块解决左侧项目。创建一个名为 History 的基本页面或内容类型，然后您拥有“章节”的内容类型添加它们并将它们设置为 History 节点下的子项。从这里创建一个菜单块，并在您想要它们的页面上设置左侧边栏上的块。

[http://drupal.org/project/menu_block](http://drupal.org/project/menu_block)

# django - 在 Ngnix 下运行的 Django 不提供静态内容

> ID：10192563
> 
> 赞同：1
> 
> 时间：2012-04-17T13:50:32.227
> 
> 标签：django, nginx

我按照本[指南](http://www.rkblog.rk.edu.pl/w/p/django-nginx/)在 Ubuntu 11.10 上部署 Django + Nginx。Django 运行良好，但 Nginx 不提供任何静态文件。

我正在尝试将 app.com/static/ 指向本地文件夹 /project/app/static/

我也尝试了这个[问题](https://stackoverflow.com/questions/1474374/nginx-doesnt-serve-static)中的一切都无济于事

这是我的 settings.py 的摘录：

```
STATIC_ROOT = ''

STATIC_URL = '/static/'

ADMIN_MEDIA_PREFIX = DOMAIN_URL + '/static/admin/'

STATICFILES_DIRS = (
    os.path.join(PROJECT_ROOT, 'static'),
) 
```

从 nginx.conf

```
server {
                listen 80;
                server_name localhost;
                # site_media - folder in uri for static files
                location /static/  {
                        autoindex on;
                        alias /project/app/static;
                        }
location ~* ^.+\.(jpg|jpeg|gif|png|ico|css|zip|tgz|gz|rar|bz2|doc|xls|exe|pdf|p$
  access_log   off; # po co mi logi obrazków :)
  expires      30d;
}
                location / {
                        # host and port to fastcgi server
                        fastcgi_pass 127.0.0.1:8080;
                        fastcgi_param PATH_INFO $fastcgi_script_name;
                        fastcgi_param REQUEST_METHOD $request_method;
                        fastcgi_param QUERY_STRING $query_string;
                        fastcgi_param CONTENT_TYPE $content_type;
                        fastcgi_param CONTENT_LENGTH $content_length;
                        fastcgi_pass_header Authorization;
                        fastcgi_intercept_errors off;
                        } 
```

我在这里做什么？

这是nginx日志

```
 WSGIServer: missing FastCGI param SERVER_PORT required by WSGI!
WSGIServer: missing FastCGI param SERVER_PROTOCOL required by WSGI!" while read$
2012/04/17 13:48:24 [error] 15598#0: *3 open() "/etc/nginx/html/static/css/rese$
2012/04/17 13:48:24 [error] 15598#0: *4 open() "/etc/nginx/html/static/images/l$
2012/04/17 13:48:24 [error] 15598#0: *5 open() "/etc/nginx/html/static/js/scrip$
2012/04/17 13:48:24 [error] 15598#0: *6 open() "/etc/nginx/html/static/js/jquery$
2012/04/17 13:48:24 [error] 15598#0: *7 open() "/etc/nginx/html/static/style.cs$
2012/04/17 13:48:24 [error] 15598#0: *8 open() "/etc/nginx/html/static/js/jquery$
2012/04/17 13:48:24 [error] 15598#0: *5 open() "/etc/nginx/html/static/images/i$
2012/04/17 13:48:24 [error] 15598#0: *7 open() "/etc/nginx/html/static/images/i$
2012/04/17 13:48:24 [error] 15598#0: *8 open() "/etc/nginx/html/static/images/i$
2012/04/17 13:48:24 [error] 15598#0: *6 open() "/etc/nginx/html/static/images/s$
2012/04/17 13:48:24 [error] 15598#0: *3 open() "/etc/nginx/html/static/images/s$
2012/04/17 13:48:24 [error] 15598#0: *4 open() "/etc/nginx/html/static/images/s$
2012/04/17 14:07:33 [error] 16231#0: *1 FastCGI sent in stderr: "WSGIServer: mi$
WSGIServer: missing FastCGI param SERVER_PORT required by WSGI!
WSGIServer: missing FastCGI param SERVER_PROTOCOL required by WSGI!" while read$
2012/04/17 14:07:33 [error] 16231#0: *3 open() "/etc/nginx/html/static/css/rese$
2012/04/17 14:07:33 [error] 16231#0: *4 open() "/etc/nginx/html/static/style.cs$
2012/04/17 14:07:33 [error] 16231#0: *5 open() "/etc/nginx/html/static/js/jquery$
2012/04/17 14:07:33 [error] 16231#0: *6 open() "/etc/nginx/html/static/js/scrip$
2012/04/17 14:07:33 [error] 16231#0: *7 open() "/etc/nginx/html/static/js/jquery$
2012/04/17 14:07:34 [error] 16231#0: *7 open() "/etc/nginx/html/static/images/l$
2012/04/17 14:07:34 [error] 16231#0: *6 open() "/etc/nginx/html/static/images/i$
2012/04/17 14:07:34 [error] 16231#0: *4 open() "/etc/nginx/html/static/images/i$
2012/04/17 14:07:34 [error] 16231#0: *5 open() "/etc/nginx/html/static/images/i$
2012/04/17 14:07:34 [error] 16231#0: *3 open() "/etc/nginx/html/static/images/s$
2012/04/17 14:07:34 [error] 16231#0: *8 open() "/etc/nginx/html/static/images/s$
2012/04/17 14:07:34 [error] 16231#0: *5 open() "/etc/nginx/html/static/images/s$
2012/04/17 14:07:35 [error] 16231#0: *5 open() "/etc/nginx/html/static/images/f$
2012/04/17 14:10:30 [error] 16231#0: *9 FastCGI sent in stderr: "WSGIServer: mi$
WSGIServer: missing FastCGI param SERVER_PORT required by WSGI!
WSGIServer: missing FastCGI param SERVER_PROTOCOL required by WSGI!" while read$
2012/04/17 14:11:57 [error] 16471#0: *1 FastCGI sent in stderr: "WSGIServer: mi$
WSGIServer: missing FastCGI param SERVER_PORT required by WSGI!
WSGIServer: missing FastCGI param SERVER_PROTOCOL required by WSGI!" while read$ 
```

**更新：**

解决了。我没有指定 nginx.conf 中的根目录。一旦我这样做了，一切就到位了！

*掌心*

```
 server_name localhost;
                root /home/user/projects;
                # site_media - folder in uri for static files
                location /static/  {

                        root /static/;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T14:49:41.967

看起来 nginx*正在*提供文件，只是它们不存在。这是因为 1）你没有指定 a`STATIC_ROOT`和 2）你显然没有运行`collectstatic`，这会给你一个错误。

首先，设置：

```
STATIC_ROOT = '/project/app/static' 
```

或者，为了提高便携性：

```
import os.path

STATIC_ROOT = os.path.join(os.path.dirname(__file__), 'static') 
```

然后，在您的生产环境中运行以下命令：

```
python manage.py collectstatic 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T18:52:03.337

我没有指定 nginx.conf 中的根目录。一旦我这样做了，一切就到位了！ *掌心*

```
 server_name localhost;
            root /home/user/projects/;
            # site_media - folder in uri for static files
            location /static/  {

                    root /static/;} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-17T14:01:21.107

Django 实际上并不是为提供静态文件而设计的。他们在整个文档中多次提到这一点。只需使用 nginx 分别为您的静态文件提供服务，然后将 django 指向该位置。

# jquery - $get() 操作后，jQuery 禁用的表单元素不会重新打开

> ID：10192570
> 
> 赞同：0
> 
> 时间：2012-04-17T13:51:05.393
> 
> 标签：jquery

在下面的代码分支中，当“my_theme”选择菜单更改时，我对服务器进行了几次 $get 调用，以检索所选主题的默认颜色选项并预览图像。在此过程中，为避免用户在加载颜色之前单击“应用更改”按钮，我将该按钮设置为禁用，然后在操作完成后将其重置。

但是，在一次安装中，某些事情显然失败了，并且按钮保持禁用状态（即使 get 操作中没有明显的错误）。

在获取全部完成后，我如何更好地构建它以重新启用提交按钮？

```
$('#my_theme').change
(
    function()
    {
        $("#largePreview").hide();
        var myImage = $('#my_theme :selected').val();
        var thisOption = $(this);
        $('.selectedImage img').attr('src','<?php echo get_bloginfo('template_directory') ?>/styles/'+myImage+'/screenshot.jpg');
        $('.selectedImage img').attr('alt',myImage);

        try{
            $('button.save').attr('disabled','disabled');
            $.get('<?php echo get_bloginfo('template_directory') ?>/color.php', {theme: myImage, spot: '1'}, function(data){doColor('#my_theme_header_color', data);});
            $.get('<?php echo get_bloginfo('template_directory') ?>/color.php', {theme: myImage, spot: '2'}, function(data){doColor('#my_theme_sidebar_color', data);});
            $.get('<?php echo get_bloginfo('template_directory') ?>/color.php', {theme: myImage, spot: '3'}, function(data){doColor('#my_theme_spot_color_alt', data);});
            $.get('<?php echo get_bloginfo('template_directory') ?>/color.php', {theme: myImage, spot: '4'}, function(data){doColor('#my_theme_spot_color_alt2', data);});
            $.get('<?php echo get_bloginfo('template_directory') ?>/color.php', {theme: myImage, spot: '5'}, function(data){doColor('#my_bg_attach_color', data);});
        }
        catch(e){
            $('button.save').attr('disabled','');
        }
        $.get('<?php echo get_bloginfo('template_directory') ?>/get-image.php', {template: myImage, action: 'background'}, function(data){
            if(data){$('#currentBackgroundImage').attr('src','<?php echo get_bloginfo('template_directory') ?>/styles/'+myImage+'/background.png');}
            else{$('#currentBackgroundImage').attr('src','<?php echo get_bloginfo('template_directory') ?>/background-missing.png');}
        });

        $.get('<?php echo get_bloginfo('template_directory') ?>/get-image.php', {template: myImage, action: 'header'}, function(data){
            if(data){$('#currentHeaderImage').attr('src','<?php echo get_bloginfo('template_directory') ?>/styles/'+myImage+'/header.png');}
            else{$('#currentHeaderImage').attr('src','<?php echo get_bloginfo('template_directory') ?>/header-missing.png');}

            $('button.save').attr('disabled','');

        });

}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T13:53:24.267

尝试`$('button.save').removeAttr('disabled');`

“禁用”是一个布尔属性，所以它要么存在（真）要么不存在（假）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T13:54:05.000

尝试将属性设置为 false：

```
$('button.save').attr('disabled', false); 
```

或删除它：

```
$('button.save').removeAttr('disabled'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T13:56:44.990

您可以利用[http://api.jquery.com/jQuery.when/](http://api.jquery.com/jQuery.when/)因此您可以执行许多 ajax 请求，并在它们都完成后执行您想要的。

```
$.when($.ajax("/page1.php"), $.ajax("/page2.php")).done(function(a1,  a2){
    /* a1 and a2 are arguments resolved for the 
        page1 and page2 ajax requests, respectively */
   var jqXHR = a1[2]; /* arguments are [ "success", statusText, jqXHR ] */
   if ( /Whip It/.test(jqXHR.responseText) ) {
      alert("First page has 'Whip It' somewhere.");
   }
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-18T06:54:32.070

使用 .prop()。

.attr() 是这样做的旧方法。

$('button.save').prop("disabled", false);

[http://api.jquery.com/prop/#prop2](http://api.jquery.com/prop/#prop2)

要区分何时使用 prop 或 attr，请考虑以下技巧：

```
<tag anything=value> is an attr
<tag value> is a prop 
```

例如

```
<input disabled>
<input type="checkbox" checked>
<option selected> 
```

# android - thumbOffset 不起作用

> ID：10192574
> 
> 赞同：5
> 
> 时间：2012-04-17T13:51:12.063
> 
> 标签：android, android-layout

我的应用程序有一个带有自定义 thumbOffset 的搜索栏。它在某些设备上无法正常工作（例如我自己的三星 Galaxy GIO Android 2.3.3）

（我的应用是为 Android 2.1 构建的，我无法更改）

我制作了一个带有搜索栏的简单应用程序 - thumbOffset 在我的手机上仍然无法正常工作（但在其他一些设备上正常工作 - 请参阅 UPD）：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:a="http://schemas.android.com/apk/res/android"
          a:orientation="vertical"
          a:layout_width="fill_parent"
          a:layout_height="fill_parent">

    <SeekBar a:id="@+id/lights_downwash_slider"
         a:layout_width="280dp"
         a:layout_height="wrap_content"
         a:layout_gravity="center_horizontal"
         a:layout_margin="5dp"
         a:thumbOffset="-15dp"
         a:maxHeight="20dp"
         a:minHeight="20dp"
         a:progress="0"/>
</LinearLayout> 
```

有没有人遇到同样的问题并有解决方案？

UPD：在三星 Nexus (android 4.0.4)、模拟器 2.3 和 4.0.3 上正常工作

不适用于模拟器 2.1 和三星 Galaxy Gio (2.3.3)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-22T05:36:34.680

我遇到了同样的问题。我在运行时用等效的 API (setThumbOffset) 解决了这个问题。（不在设计时使用 xml）

请参阅下面的等效 API。 [http://developer.android.com/reference/android/widget/AbsSeekBar.html#setThumbOffset(int](http://developer.android.com/reference/android/widget/AbsSeekBar.html#setThumbOffset(int) )

# c++ - 第一次填充 QTableWidget 时，一切都很好，但是当我重新填充它时，速度明显变慢

> ID：10192579
> 
> 赞同：4
> 
> 时间：2012-04-17T13:51:23.787
> 
> 标签：c++, qt, qtablewidget, qtablewidgetitem

**编码：**

```
populateTable()
{
  tableWidget->clearContents();
  tableWidget->setRowCount(stringList.size());

  for(int i = 0; i < stringList.size(); ++i)
  {
    tableWidget->setItem(i, 0, new QTableWidgetItem(stringList.at(i)));
  }
} 
```

**问题：**

第一次运行 populateTable() 时，一切都很好。但是接下来的时间，它的运行速度明显比以前慢。

**讨论：**

经过仔细测试，我怀疑 clearContents() 是问题所在。因为只需将代码从

```
tableWidget->clearContents(); 
```

至：

```
tableWidget->setRowCount(0); 
```

解决了问题，但现在又出现了另一个问题；将行数设置为“0”似乎不会删除堆分配的 QTableWidgetItems，它似乎只是留下了项目的所有权，所以它留下了内存泄漏。（或者至少我只是这么认为......）

QTableWidget 中的 Qt 文档相当模糊，所以我不完全知道 clearContents() 的实际作用。在文档中，它说“从视图中删除所有不在标题中的项目”，这让我问，表格的内容是否只是隐藏？它会被删除吗？我不太确定。我的理论是 clearContents() 仅隐藏项目，并且任何下一次填充表的尝试实际上都会删除并删除每个项目，然后分配一个新项目以在表上设置，这反过来又是一项昂贵的操作。

另一个有趣的事情是 Qt 在 QTableWidget 上的文档建议填充 QTableWidget 的正确方法是在堆上分配一个 QTableWidgetItem 然后使用 setItem() 将它设置在一个表格单元格上，就像我在上面的代码中呈现的那样，我发现它是奇怪...

**总之：**

是否有另一种方法来填充和重新填充 Qt 表而不会出现所有这些问题？如果没有，有没有办法解决这些问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-17T18:20:54.903

*“Qt 关于 QTableWidget 的文档表明，填充 QTableWidget 的正确方法是在堆上分配 QTableWidgetItem，然后使用 setItem() 将其设置在表格单元格上，就像我在上面的代码中呈现的那样，我觉得这很奇怪...... "*

[考虑到QTableWidget::setItem 的文档](http://doc-snapshot.qt-project.org/4.8/qtablewidget.html#setItem)明确表示小部件拥有该项目的所有权，我觉得这并不奇怪！

*“将行数设置为'0'似乎并没有删除堆分配的QTableWidgetItems，它似乎只是留下了项目的所有权，所以它留下了内存泄漏。（或者至少我只是这么认为......）”*

与其猜测它是否泄漏，您可以创建自己的 QTableWidgetItem 子类...并将代码放入其析构函数中，以便您可以放置​​断点并确定。或者，Qt 源代码非常清晰。 `setRowCount`调用`removeRows`，确实删除了 QTableWidgetItems：

[http://qt.gitorious.org/qt/qt/blobs/4.8/src/gui/itemviews/qtablewidget.cpp#line370](http://qt.gitorious.org/qt/qt/blobs/4.8/src/gui/itemviews/qtablewidget.cpp#line370)

[http://qt.gitorious.org/qt/qt/blobs/4.8/src/gui/itemviews/qtablewidget.cpp#line100](http://qt.gitorious.org/qt/qt/blobs/4.8/src/gui/itemviews/qtablewidget.cpp#line100)

但这再次与[QTableWidget::setRowCount 的文档一致](http://doc-snapshot.qt-project.org/4.8/qstandarditemmodel.html#setRowCount)

> 将此模型中的行数设置为行。如果这小于 rowCount()，则丢弃不需要的行中的数据。

你真的不应该看到 clearContents() 和 setRowCount(0) 之间有太大的区别。您是否生成了一个小的可重现示例，没有与任何更大的程序交织在一起，来证明这种现象？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-07-22T00:11:46.773

我注意到不仅在重新填充 QTableWidget 方面，而且在进行任何更改方面都普遍缓慢。

例如，我有一个包含大约 1000 个单元格的单元格，它们通过 setCheckState() 在其上显示复选框。第一次通过选中/取消选中它们，它们很快。第二次通过，大约需要 15 秒，这是完全不可接受的。我在桌子上尝试了 blockSignals(true/false)，但没有任何效果。

诀窍是阻止*模型*而不是桌子上的信号。该模型正在消耗 CPU。

```
auto table = ui.tableWidget;
auto rows = table->rowCount();
auto cols = table->columnCount();

table->model()->blockSignals(true);

for (auto row = 0; row < rows; row++)
    for (auto col = 0; col < cols; col++)
        if (auto cb = table->item(row, col))
            cb->setCheckState(Qt::CheckState::Checked);

table->model()->blockSignals(false);
table->model()->layoutChanged();//Required, or else you won't see your changes immediately. 
```

# c# - MVC3：下划线和空格从 url 中删除

> ID：10192585
> 
> 赞同：1
> 
> 时间：2012-04-17T13:51:51.740
> 
> 标签：c#, asp.net-mvc-3, url, asp.net-mvc-routing

我的 MVC 3 应用程序有问题...如果我有这样的链接：

```
http://localhost:15838/ByBU/OpenTask/Details/Excess_Casualty/Index_Clear 
```

这个网址的路线是：

```
routes.MapRoute(
            "OpenTaskDetails",
            "{controller}/OpenTask/{action}/{BU}/{SLAName}",
            new { controller = "ByBU", action= "Details", BU = "BU", SLAName = "SLAName" },
            new [] { "SLA.Controllers" }
            ); 
```

当我在“详细信息”操作的第一行设置断点时，变量`BU`和`SLAName`是：过量（而不是`Excess_Casualty`）和`Index`（而不是`Index_Clear`）。

它以前工作得很好，然后突然停止工作，我不知道为什么会这样。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T14:13:16.270

从不建议 URL 使用下划线，因此您可能需要切换到破折号：

[http://www.mattcutts.com/blog/dashes-vs-underscores/](http://www.mattcutts.com/blog/dashes-vs-underscores/)

“谷歌将破折号视为单词分隔符，而下划线被视为单词的一部分。”

# c# - 模型绑定器未用于 ajax 请求

> ID：10192593
> 
> 赞同：0
> 
> 时间：2012-04-17T13:52:12.047
> 
> 标签：c#, asp.net, ajax, model-binding

我有一个包含逗号的小数自定义模型绑定器，它基于这篇关于[模型绑定十进制值的文章](http://haacked.com/archive/2011/03/19/fixing-binding-to-decimals.aspx)

这工作正常，除非由 ajax 请求使用

它适用于不包含带逗号的金额（即值小于一千）的 ajax 请求

错误是

```
System.ArgumentException: The parameters dictionary contains a null entry for parameter 'amount' 
 of non-nullable type 'System.Decimal' for method 
'System.Web.Mvc.JsonResult IsDepositRequired(System.String, System.String, System.String, 
  Boolean, System.Decimal, System.DateTime)' in 'Client.Controllers.DealingController'. An 
  optional parameter must be a reference type, a nullable type, or be declared as an 
  optional parameter.
  Parameter name: parameters
  at System.Web.Mvc.ActionDescriptor.
    ExtractParameterFromDictionary(ParameterInfo parameterInfo, IDictionary`2 parameters, MethodInfo methodInfo) 
```

模型绑定器在 gobal.asax 中正确注册

知道我可能错过了什么谢谢

阿贾克斯代码：

```
$.post('/Dealing/IsDepositRequired', {
                baseCurrency: deal.baseCurrency,
                termsCurrency: deal.termsCurrency,
                dealtCurrency: deal.dealtCurrency,
                isBuy: deal.direction == 'BUY',
                amount: deal.dealtCurrency == deal.baseCurrency ? deal.baseAmount : deal.termsAmount,
                valueDate: deal.valueDate
            }, function (show) {
                if (show) {
                    $('.Deposit').fadeIn(500);
                } else {
                    $('.Deposit').hide();
                }
            }, 'json'); 
```

控制器

```
[HttpPost]
public virtual JsonResult IsDepositRequired(string baseCurrency, string termsCurrency, string dealtCurrency, bool isBuy, decimal amount, DateTime valueDate)
{ 
```

Firebug 网络控制台：

```
amount          100,000.00
baseCurrency    GBP
dealtCurrency   GBP
isBuy           true
termsCurrency   EUR
valueDate           30/10/2012 
```

资源：

`baseCurrency=GBP&termsCurrency=EUR&dealtCurrency=GBP&isBuy=true&amount=100%2C000.00&valueDate=30%2F10%2F2012`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T14:00:06.840

您对操作的 ajax 调用可能未使用正确的查询字符串参数或表单编码值发送金额。您可以使用提琴手检查请求以查看发送的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T16:40:48.573

最好不要让您的操作方法采用那么多参数，而是将它们放入现有模型/新模型中并将视图字段包装在表单中，然后将表单序列化到请求中。像这样的东西？

假设这是您的字段的模型：

```
public class MyModel
{
    public string BaseCurrency { get; set; }
    public string TermsCurrency { get; set; }
    public string DealtCurrency { get; set; }
    public bool IsBuy { get; set; }
    public decimal Amount { get; set; }
    public DateTime ValueDate { get; set; }
} 
```

然后假设你有一个类似的视图：

```
@model MyModel

//putting these fields in a form with an id of myForm
@Html.EditorFor(m => m.BaseCurrency)
//rest of your fields... 
```

然后在您的 ajax 调用中指定数据时，您只需将以下内容作为数据发送：

```
$("#myForm").serialize() 
```

然后让您的操作方法采用模型，如下所示：

```
[HttpPost]
public virtual JsonResult IsDepositRequired(MyModel model) 
```

# iphone - iOS iPhone如何处理“用户可以从多个设备使用应用程序”这种要求？

> ID：10192599
> 
> 赞同：2
> 
> 时间：2012-04-17T13:52:38.980
> 
> 标签：iphone, ios, core-data, cloud, sync

我正在构建一个企业应用程序，我面前有一长串需求。

其中之一是“该应用程序需要可由同一用户在多个设备上使用，例如 iPhone 和 iPad 与云同步以获得无缝体验”。

这让我很担心，因为它可能涉及巨大的复杂性。该应用程序使用基于本地核心数据的堆栈来保存数据的本地版本，并且需要将此数据备份到云端。根据您的经验，**这样的核心数据到云同步是否可行？**保持多个设备无缝同步到基于云的存储需要多少努力？

任何其他关于如何以智能方式处理/谈论此类要求的意见都值得赞赏！是否有任何演示可以让我快速了解这种“多设备”类型的应用程序？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T14:07:31.750

还有一些关于苹果的进一步阅读：[https ://developer.apple.com/library/ios/#documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/iCloud/iCloud.html#//apple_ref/doc/uid/TP40007072-CH5-SW1](https://developer.apple.com/library/ios/#documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/iCloud/iCloud.html#//apple_ref/doc/uid/TP40007072-CH5-SW1)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T13:56:17.260

有与 iCloud 同步 coredata 的功能

看看[iOS How-To : Using Core Data with iCloud](http://goddess-gate.com/dc2/index.php/post/452)

# clojure - 返回满足谓词的映射/列表/序列中的第一项

> ID：10192602
> 
> 赞同：61
> 
> 时间：2012-04-17T13:52:46.193
> 
> 标签：clojure

我正在寻找一个函数，它返回 fn 评估为 true 的序列中的第一个元素。例如：

```
(first-map (fn [x] (= x 1)) '(3 4 1)) 
```

上面的假函数应该返回 1（列表中的最后一个元素）。Clojure中有这样的东西吗？

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2012-04-17T14:00:50.037

```
user=> (defn find-first
         [f coll]
         (first (filter f coll)))
#'user/find-first
user=> (find-first #(= % 1) [3 4 1])
1 
```

*编辑：*并发。:) 不。它不适`f`用于整个列表。由于`filter`.

* * *

## 回答 #2

> 赞同：56
> 
> 时间：2012-04-17T14:04:57.747

在你的情况下，成语是

```
(some #{1} [1 2 3 4]) 
```

它是如何工作的：#{1} 是一个集合文字。集合也是一个函数，如果 arg 存在于集合中，则评估其 arg，否则评估为 nil。任何集合元素都是“真实”值（好吧，除了布尔值 false，但这是集合中的罕见）。`some`返回针对结果为真的第一个集合成员评估的谓词的返回值。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2015-09-04T19:14:23.803

我尝试了这个线程中提到的几种方法（JDK 8 和 Clojure 1.7），并做了一些基准测试：

```
repl> (defn find-first
         [f coll]
         (first (filter f coll)))
#'cenx.parker.strategies.vzw.repl/find-first

repl> (time (find-first #(= % 50000000) (range)))
"Elapsed time: 5799.41122 msecs"
50000000

repl> (time (some #{50000000} (range)))
"Elapsed time: 4386.256124 msecs"
50000000

repl> (time (reduce #(when (= %2 50000000) (reduced %2)) nil (range)))
"Elapsed time: 993.267553 msecs"
50000000 
```

结果表明，这种`reduce`方式可能是 clojure 1.7 中最有效的解决方案。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2018-12-09T12:15:59.300

[2016 年有一个补丁提交给 clojure core](https://dev.clojure.org/jira/browse/CLJ-2056)`(first (filter pred coll))` ，它为idiom添加了一个有效的快捷方式，它被称为`seek`.

该实现避免了在此使用`(first (filter))`和`(some #(when (pred)))`替代方案的问题。也就是说，它可以有效地处理分块序列，并且可以很好地处理`nil?`和`false?`谓词。

修补：

```
(defn seek
  "Returns first item from coll for which (pred item) returns true.
   Returns nil if no such item is present, or the not-found value if supplied."
  {:added  "1.9" ; note, this was never accepted into clojure core
   :static true}
  ([pred coll] (seek pred coll nil))
  ([pred coll not-found]
   (reduce (fn [_ x]
             (if (pred x)
               (reduced x)
               not-found))
           not-found coll))) 
```

例子：

```
(seek odd? (range)) => 1
(seek pos? [-1 1]) => 1
(seek pos? [-1 -2] ::not-found) => ::not-found
(seek nil? [1 2 nil 3] ::not-found) => nil 
```

最终补丁被拒绝：

> 经审查，我们决定不希望将其包括在内。使用线性搜索（尤其是嵌套线性搜索）会导致性能下降——通常最好使用其他类型的数据结构，这就是为什么过去没有包含此功能的原因。~亚历克斯·米勒 12/5/17 下午 3:34

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2012-04-17T14:04:53.857

我认为`some`是完成这项工作的最佳工具：

```
(some #(if (= % 1) %) '(3 4 1)) 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2015-02-10T02:38:09.700

使用`drop-while`而不是应该解决分块序列`filter`的“过度应用” ：`f`

```
(defn find-first [f coll]
  (first (drop-while (complement f) coll)))
;;=> #'user/find-first

(find-first #(= % 1) [3 4 1])
;;=> 1 
```

# axapta - 确定字段是否为系统字段

> ID：10192603
> 
> 赞同：2
> 
> 时间：2012-04-17T13:52:47.843
> 
> 标签：axapta, dynamics-ax-2009, x++

我想知道是否有一种聪明/简短的方法来确定表中的字段是否是从系统生成的。我只有 TableNum 和 FieldNum 作为变量（没有硬编码，只有动态值），我希望能够写出这样的东西（伪代码）：

```
if( Sys::isSystemField(tableId, fieldId) )
{
    //...
} 
```

代替：

```
//...
str fieldName;
//...
;
//...

fieldName = dictTable.fieldName(fieldId);

if(fieldName == "modifiedDateTime"
    || fieldName == "DEL_ModifiedTime"
    || fieldName == "modifiedBy"
    || //etc...)
{

//... 
```

如果没有办法做我正在寻找的东西，这就是我要写的东西。希望有人可以提供帮助，不幸的是，我在文档中没有找到任何相关信息。

干杯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T14:11:11.450

使用`isSysId`全局方法。

例如用于`Global::buf2buf`：

```
static void buf2Buf(Common _from, Common  _to)
{
    DictTable   dictTable = new DictTable(_from.TableId);
    fieldId     fieldId   = dictTable.fieldNext(0);
    while (fieldId && ! isSysId(fieldId))
    {
        _to.(fieldId)   = _from.(fieldId);
        fieldId         = dictTable.fieldNext(fieldId);
    }
} 
```

# iphone - 删除高度大于其他单元格的单元格时，动画看起来很尴尬

> ID：10192607
> 
> 赞同：7
> 
> 时间：2012-04-17T13:52:57.070
> 
> 标签：iphone, ios, uitableview

我有一个普通的 UITableView，有 4 行，每行高度为 50。当我按下第四行时，我使用 UITableViewRowAnimationTop 插入高度为 80 的第五行。到目前为止，一切都很好。

再次按下第四行时，我想删除第五行。但是，当我使用 UITableViewRowAnimationTop（或任何其他动画样式）删除该行时，动画看起来很尴尬——动画开始但单元格在动画完成之前突然消失。（这仅在您使用具有背景颜色的单元格时才明显。您可以看到单元格的下半部分突然消失，而不是在其上方的单元格下方消失。）

代码是这样的：

```
[self.tableview beginupdates];
[self.tableView deleteRowsAtIndexPaths:[NSArray arrayWithObject:indexPath] withRowAnimation:UITableViewRowAnimationTop];
[self.tableview endupdates]; 
```

行高由该`tableView:heightForRowAtIndexPath:`方法提供。

当所有行都具有相同的高度，或者当被删除的行比其他行短时，不会发生此问题。

我认为一种解决方法是在删除之前将第五个单元格的高度更改为 50，但我宁愿不这样做。请帮忙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-05-19T14:21:15.133

我今天早上刚遇到这个问题。基本上，我最终自己处理动画，然后在动画完成后删除单元格。下面是一些代码来展示我是如何做到的：

```
@property (nonatomic, strong) NSArray *tableData;
@property (nonatomic, strong) NSMutableDictionary *deletedItems;
...

- (void)deleteItemForCell:(UITableViewCell *)cell
{
    NSIndexPath *indexPath = [self.tableView indexPathForCell:cell];
    NSObject *item = self.tableData[indexPath.row];

    NSNumber *rowKey = @(indexPath.row);

    __weak id weakSelf = self;
    [CATransaction setCompletionBlock:^{
        @synchronized(weakSelf) {
            [self.deletedItems removeObjectForKey:rowKey];
            [self.tableData removeObject:item];
            [self.tableView deleteRowsAtIndexPaths:@[indexPath]
                                  withRowAnimation:UITableViewRowAnimationNone];
        }
    }];
    self.deletedItems[rowKey] = item;

    [self.tableView beginUpdates];
    [self.tableView endUpdates];

    [CATransaction commit];
}

- (CGFloat)tableView:(UITableView *)tableView
    heightForRowAtIndexPath:(NSIndexPath *)indexPath
{
    if (self.deletedItem[@(indexPath.row)]) {
        return 0;
    }
    return CELL_HEIGHT;
} 
```

代码跟踪数据结构中已删除的项目并通知表进行更新。已删除数据结构中的任何项目的高度都将为 0，这将导致“折叠”动画。

该代码利用 CATransaction 来了解动画何时完成。完成后，项目将从 tableData 数据结构中删除并从表中删除，没有任何动画。

笔记：

*   我不确定是否需要同步，但似乎很聪明，因为我们正在处理异步删除项目。
*   我尝试使用 indexPath 对象作为字典的键，但它似乎不起作用。改为使用该行。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-10-06T15:27:10.040

使用 UITableViewRowAnimationMiddle 对我来说稍微不那么糟糕了。

同样，我注意到使用 UITableViewRowAnimationTop，超出 tableviews 默认单元格高度的高度会出现/消失而没有动画。所以如果你的 tableview 行高是 44，但是你在一个高度为 74 的单元格中动画，它会*立即*显示 30，然后在剩余的 44 中动画。

使用 UITableViewRowAnimationMiddle 单元格内容的动画效果很好，但单元格边框在动画期间出现故障 - 最初出现在 30，然后为剩余的 44 设置动画。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-02T08:25:23.147

您是否尝试过在没有开始/结束更新的情况下这样做？我隐约记得曾经使用过那些让事情变得奇怪的东西。

你试过`reloadRowsAtIndexPaths:`为*下一*行做一个吗？假设有一个，那就是。

您确定数据源`heightForRow`在您进行 deleteRowsAt 调用时的响应行为正确吗？（例如，您可以设置一些标志以指示在删除调用之后该事物不再可见，这可能导致新行的高度错误）

# android - 如何获取用相机拍摄的图像的 Uri 并存储到图库

> ID：10192608
> 
> 赞同：2
> 
> 时间：2012-04-17T13:52:59.733
> 
> 标签：android, camera, gallery

我正在从我的应用程序中启动相机。我正在使用带有额外 android.provider.MediaStore.EXTRA_OUTPUT 的 Android.provider.MediaStore.ACTION_IMAGE_CAPTURE。如果我使用 EXTRA_OUTPUT 与否，照片将添加到图库。

如何获取图库中图像的 Uri？我还没有找到一个干净的方法来做到这一点，我不想使用最后添加到图库的图像的 Uri，因为我不能确定它是用户拍摄的照片。

**编辑：** 让我在这里补充一下，我确实知道如何获取图像。目前我正在使用我的 Uri，我将其与 Intent 一起作为 EXTRA_OUTPUT 传递。那不是问题。问题是使用这种方法我得到两张照片写入 sdcard，我更喜欢只写一张。或者如果写了两个，一个在画廊中，一个在我自己的 Uri 中，我想使用其中一个 Uri:s 并删除另一个。在这两种情况下，我都需要照片的 Uri，它默认保存到 Gallery 中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T14:14:21.873

如果您通过调用启动相机

```
startActivityForResult(cameraIntent, REQUEST_CODE_CAPTURE_IMAGE_ACTIVITY); // start the camera 
```

在 onActivityResult 你可以捕获 mediaURI

```
 @Override
    public void onActivityResult(int requestCode, int resultCode, Intent data)
    {
        if (requestCode == REQUEST_CODE_CAPTURE_IMAGE_ACTIVITY
                && resultCode == RESULT_OK) {
                Uri imageUri = null;
                if (data != null){
                   imageUri = data.getData();
               }
        }
    } 
```

`REQUEST_CODE_CAPTURE_IMAGE_ACTIVITY`是一个静态整数值，用于标识通过意图发出的请求。因此，如果您有多个 startActivityForResults ，您可以确定哪一个正在返回。

请注意，如果您通过 EXTRA_OUTPUT 预先插入一个 URI，您将不会通过 data.getData() 取回 URI；您必须将预先插入的 URI 存储在一个变量中，并在您的 onActivityResult 中检索它，同时检查 imageUri 是否为空。

前任。

```
 Uri imageUri = null;
if (data != null){
   imageUri = data.getData();
}
if (imageUri == null && preinsertedUri != null)
 imageUri = preinsertedUri; 
```

// 用 imageUri 做事

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-21T06:52:22.510

`data.getData()`从in获取 Uri`onActivityResult()`不是解决方案。这适用于三分之一的测试设备，并且在摩托罗拉 Defy 模拟器上也失败了。

所以这就是我最终做的事情：

1.  用 调用相机`Android.provider.MediaStore.ACTION_IMAGE_CAPTURE`，不`EXTRA_OUTPUT`
2.  获取存储在 Gallery 中的图像的 Uri
    *   从结果中读取 Uri
    *   如果前一个失败，请使用此处的代码从 MediaStore 获取最后添加的图像的 Uri：http: [//kevinpotgieter.wordpress.com/2011/03/30/null-intent-passed-back-on-samsung-galaxy-标签/](http://kevinpotgieter.wordpress.com/2011/03/30/null-intent-passed-back-on-samsung-galaxy-tab/)

这似乎与测试设备配合得很好，但我仍然对这个解决方案并不完全满意，因为我不能完全确保最后添加的图像始终是用户捕获的图像。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-01T11:09:09.247

公共类 SampleImageActivity 扩展 Activity {

```
private static final int SELECT_PICTURE = 1;

private String selectedImagePath;
private ImageView img;

public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    img = (ImageView)findViewById(R.id.ImageView01);

    ((Button) findViewById(R.id.Button01))
            .setOnClickListener(new OnClickListener() {
                public void onClick(View arg0) {
                    Intent intent = new Intent();
                    intent.setType("image/*");
                    intent.setAction(Intent.ACTION_GET_CONTENT);
                    startActivityForResult(Intent.createChooser(intent,"Select Picture"), SELECT_PICTURE);
                }
            });
}

public void onActivityResult(int requestCode, int resultCode, Intent data) {
    if (resultCode == RESULT_OK) {
        if (requestCode == SELECT_PICTURE) {
            Uri selectedImageUri = data.getData();
            selectedImagePath = getPath(selectedImageUri);
            System.out.println("Image Path : " + selectedImagePath);
            img.setImageURI(selectedImageUri);
        }
    }
}

public String getPath(Uri uri) {
    String[] projection = { MediaStore.Images.Media.DATA };
    Cursor cursor = managedQuery(uri, projection, null, null, null);
    int column_index = cursor.getColumnIndexOrThrow(MediaStore.Images.Media.DATA);
    cursor.moveToFirst();
    return cursor.getString(column_index);
} 
```

}

# ajax - 2个并发ajax请求一慢一快，同时结束

> ID：10192609
> 
> 赞同：0
> 
> 时间：2012-04-17T13:53:06.380
> 
> 标签：ajax, apache, jquery

我必须同时查询（通过 Ajax）2 个脚本。

我确信一个非常快，它只显示一些 html，第二个是使用 WebService 进行一些查询。

快速请求总是在第一个请求之后发送。但是在我所有的尝试中，快速/快速的，在慢速之前永远不会完成。

用于调用第一个长 ajax 请求的代码：

```
$.ajax({
        type: "POST",
        url: '/fr/ajax_flight_get_other_oneway',
        cache: false,
        dataType: 'json',
        success: function(data) {
           // some treatment
        } 
```

第二个更快的 ajax 请求的代码：

```
$.ajax({
        type: "POST",
        url: '/fr/load_back_forflight?id=SN4422_23',
        cache: false,
        data: "comps="+compSelectedCodes+"&escale="+escale,
        dataType: 'json',
        success: function(data) {
           // some treatment
        } 
```

是 Apache 中应该更改的东西还是 jQuery 中的东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T14:51:48.273

我找到了解决问题的方法，它与会话相关联。

会话基于文件系统。所以第一个（长查询）是锁定会话文件，然后第二个被迫等待长查询完成。

通过在数据库中使用会话，我已经解决了这个问题。

感谢您的帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T13:56:33.027

把慢的放在快的成功回调中。这将保证快速请求在开始第二个请求之前首先完成。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T14:04:03.717

浏览器可能决定为两者使用相同的 HTTP 连接（使用 HTTP 标头 Keep-alive），因此它出现在队列中。这不是 jQuery 的事情——它是浏览器可以选择做的事情。

使用浏览器的 HTTP 网络流量调试器查看是否是这种情况。

如果没有，那么您的网络服务器可能只允许每个客户端一个连接并且正在排队。看到这个：

[如何配置 Apache2 以允许来自同一 IP 地址的多个同时连接？](https://stackoverflow.com/questions/3506574/how-do-i-configure-apache2-to-allow-multiple-simultaneous-connections-from-same)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-17T15:36:09.303

试试这个：

```
$.ajax({
    type: "POST",
    url: '/fr/ajax_flight_get_other_oneway',
    cache: false,
    dataType: 'json',
    success: function(data) {
        // some treatment
        //The code for the second faster ajax request:
        $.ajax({
            type: "POST",
            url: '/fr/load_back_forflight?id=SN4422_23',
            cache: false,
            data: "comps=" + compSelectedCodes + "&escale=" + escale,
            dataType: 'json',
            success: function(data) {
                // some treatment
            }
        });
    }
});​ 
```

# javascript - Android 2.2 浏览器上的 Javascript 无效日期

> ID：10192610
> 
> 赞同：2
> 
> 时间：2012-04-17T13:53:06.493
> 
> 标签：javascript, android, android-browser

我在具有以下日期格式的 Android 2.2 默认浏览器上收到无效日期异常。它在 Firefox、Safari、Chrome 和 Explorer 上有效。

```
>var date = new Date('1985-07-10T22:00:00.000Z')
>date.toString()
"Thu Jul 11 1985 00:00:00 GMT+0200 (Hora de verano romance)" 
```

我知道如何手动解析它，但我想避免这种情况。问题从何而来？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T16:25:39.687

在不同的浏览器中解析 ISO 日期并不一致。[JavaScript：哪些浏览器支持使用 Date.parse 解析 ISO-8601 日期字符串](https://stackoverflow.com/questions/5802461/javascript-which-browsers-support-parsing-of-iso-8601-date-string-with-date-par/5803041#5803041)

# android - DynaPDF 与 Android 的兼容性

> ID：10192612
> 
> 赞同：0
> 
> 时间：2012-04-17T13:53:14.550
> 
> 标签：android, c, android-ndk

我希望在我的 Android 项目中将[DynaPDF](http://www.dynaforms.com/index.htm)用作 C 库。但是，在下载页面上，我看到的唯一可以使用的选项是“DynaPDF for linux for x86 (32)”，据我了解，x86 基于架构，而 Android 使用 ARM 架构。我对本机编程很陌生，因此如果有人能确认我猜想或解释了另一种实现库的方法，我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T11:58:04.147

要移植库，您必须有权访问源（DynaPDF 的下载页面有指向已编译库的链接，这不是很有用）。

# knockout.js - knockout.mapping 访问 json 中的数组

> ID：10192618
> 
> 赞同：1
> 
> 时间：2012-04-17T13:53:25.167
> 
> 标签：knockout.js, knockout-mapping-plugin

这是我下面的例子。我在我的项目中使用了 knockout.mapping 插件。

我想将邮件数组中的“发件人”元素填充到我的未排序列表中：

在注释代码中，我添加了使用 jquery ajax 从数据库中检索的数据。

```
<!DOCTYPE html >
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title></title>
    <script src="js/jquery-1.7.1.min.js" type="text/javascript"></script>
    <script src="js/knockout-2.0.0.debug.js" type="text/javascript"></script>
    <script src="js/KnockoutMapping2.1.1.js" type="text/javascript"></script>
    <script type="text/javascript">

        $(document).ready(function () {
            var viewModel = {};

            $.ajax({
                url: "Service.aspx",
                type: 'POST',
                dataType: "json",
                contentType: "application/json; charset=utf-8",
                success: function (data) {
                    //data :
                    //       {
                    //   "id":"Inbox",
                    //   "mails":[
                    //      {
                    //         "id":"1",
                    //         "from":"Abbot ",
                    //         "to":"steve@example.com",
                    //         "date":"May 25, 2011",
                    //         "subject":"Booking confirmation #389629244",
                    //         "folder":"Inbox"
                    //      }
                    //   ]
                    //}
                    viewModel = ko.mapping.fromJS(data);

                    ko.applyBindings(viewModel);
                },
                error: function (request) {
                    alert(request.responseText);
                }
            });

        });
    </script>
</head>
<body>
    your id is : <span data-bind='text: id' />
    <ul data-bind="foreach : mails">
        <li data-bind="value:from"></li>
    </ul>
</body>
</html> 
```

将邮件绑定到我的列表的任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T14:28:47.480

[http://jsfiddle.net/nickolsky/EVaPL/](http://jsfiddle.net/nickolsky/EVaPL/)

```
your id is : <span data-bind='text: id' ></span>
    <ul data-bind="foreach : mails">
        <li data-bind="text:from"></li> 
```

1.  不要自关闭跨度（[可以使用 <span /> 关闭跨度吗？](https://stackoverflow.com/questions/2816833/can-a-span-be-closed-using-span)）
2.  对 li 使用文本绑定而不是值绑定

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T14:53:06.893

[http://jsfiddle.net/ryanwfiorini/DmWYS/](http://jsfiddle.net/ryanwfiorini/DmWYS/)

我为你准备了一个[小提琴](http://jsfiddle.net/ryanwfiorini/DmWYS/)，看看我喜欢怎么做。我喜欢创建一个类来保存我的数据，从而允许对它进行更多控制。您可以将它们包含连接等功能。

希望这可以帮助。

# batch-file - 批处理 - 读取数组中文件的内容

> ID：10192623
> 
> 赞同：2
> 
> 时间：2012-04-17T13:53:31.027
> 
> 标签：batch-file

我有一个包含两行的文本文件（比如 param.txt），如下所示：

```
Mar2012
dim1,dim2,dim3,dim4 
```

我想批量读取这个文件并将第一行的内容存储在一个名为 cube_name 的变量中。当我阅读第二行时，我想拆分逗号分隔的字符串 dim1,dim2,dim3,dim4 并创建一个包含四个元素的数组。我打算在脚本的后面部分使用变量和数组。

我创建的代码如下所示。代码没有按预期工作。

```
@echo off & setlocal enableextensions enabledelayedexpansion
set /a count_=0
for /f "tokens=*" %%a in ('type param.txt') do (
set /a count_+=1
set my_arr[!count_!]=%%a
)
set /a count=0
for %%i in (%my_arr%) do (
set /a count+=1
if !count! EQU 1 (
    set cube_name=%%i
)

if !count! GTR 1 (
    set dim_arr=%%i:@=,%
)
)
for %%i in (%dim_arr%) do (
echo %%i
)

echo !cube_name! 
```

当我运行代码时，我会看到以下内容：

```
C:\Working folder>test2.bat
ECHO is off. 
```

所以这似乎不起作用，我无法弄清楚我做错了什么。我对批处理脚本相当陌生，因此感谢您的帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T17:51:23.080

你的第一个 FOR 循环没问题。这不是我会怎么做，但它的工作原理。之后的一切都是一团糟。看起来您认为数组是批量的正式概念，但实际上并非如此。可以以一种让人联想到数组的方式使用变量。但是批次中不存在真正的数组。

您使用**%my_arr%**就好像它是一个数组，但**my_arr**甚至没有定义。您已经定义了变量**my_arr[1]** amd **my_arr[2]** - 括号和数字是变量名的一部分。

看起来您对 FOR 循环也有误解。我建议您仔细阅读 FOR 文档（`HELP FOR`从命令行输入）。另请查看此站点和其他站点上的示例。FOR 命令非常复杂，因为它有许多看起来与未经训练的眼睛相似的变体，但行为却截然不同。[http://judago.webs.com/batchforloops.htm](http://judago.webs.com/batchforloops.htm)是帮助您理解的一个极好的资源

* * *

假设文件总是正好有 2 行，我会像这样解决你的问题

```
@echo off
setlocal enableDelayedExpansion
set dimCnt=0
<param.txt (
  set /p "cube_name=" >nul
  set /p "dimList=" >nul
  for %%D in (!dimList!) do (
    set /a dimCnt+=1
    set "dim[!dimCnt!]=%%D"
  )
)
echo cube_name=!cube_name!
  for /l %%I in (1 1 !dimCnt!) do echo dim[%%I]=!dim[%%I]! 
```

上述解决方案的一个不错的功能是它允许在第二行的维度列表中使用不同数量的术语。如果有制表符、空格、分号、等号`*`或`?`在维度名称中，它将失败。如果需要，有一些相对简单的方法可以绕过这个限制。

制表符、空格、分号和等号可以通过使用搜索和替换将每个术语括在引号中来处理。

```
 for %%D in ("!dimList:,=","!") do (
    set /a dimCnt+=1
    set "dim[!dimCnt!]=%%~D"
  ) 
```

我不会在这里发布完整的解决方案，因为它不太可能需要。但是处理`*`和/或`?`需要用换行符替换逗号并切换到 FOR /F 语句。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T17:00:42.483

我对你的代码印象深刻！
您是否尝试在那里调试或回显任何内容？

你可以简单地添加一些回声来看看你的代码为什么不能工作。

```
@echo off & setlocal enableextensions enabledelayedexpansion
set /a count_=0
for /f "tokens=*" %%a in ('type param.txt') do (
  set /a count_+=1
  set my_arr[!count_!]=%%a
)
echo ### show the variable(s) beginning with my_arr...
set my_arr

echo Part 2----
set /a count=0
echo The value of my_arr is "%my_arr%"
for %%i in (%my_arr%) do (
    set /a count+=1
    echo ## Count=!count!, content is %%i
    if !count! EQU 1 (
        set cube_name=%%i
    )

    if !count! GTR 1 (
        echo ## Setting dim_arr to "%%i:@=,%"
        set dim_arr=%%i:@=,%
        echo 
    )
)
for %%i in (%dim_arr%) do (
    echo the value of dim_arr is "%%i"
)

echo cube_name is "!cube_name!" 
```

输出是

```
### show the variable(s) beginning with my_arr...
my_arr[1]=Mar2012
my_arr[2]=dim1,dim2,dim3,dim4
Part 2----
The value of my_arr is ""
cube_name is "" 
```

如您所见，您的第 2 部分完全失败。

# c# - 我如何创建通用库来创建与数据库相关的功能

> ID：10192633
> 
> 赞同：1
> 
> 时间：2012-04-17T13:54:32.707
> 
> 标签：c#, asp.net, .net-4.0, class-library

每次创建新应用程序时，我都需要为具有相关表的应用程序创建库以处理与数据库相关的功能。例如。假设我正在为购物中心创建应用程序，我的库将具有基于需要的业务对象的功能。现在，如果我正在为船舶管理创建另一个项目，那么我需要创建另一个具有特定业务对象的库。

有没有一种方法可以创建我的框架来处理与数据库相关的功能以及我可以传递给它的自定义业务对象。

或者关于如何创建可以轻松管理数据库相关功能的自定义框架的任何建议。

感谢您分享您的智慧。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T13:55:40.323

我觉得你应该看看啊[nhibernate](/questions/tagged/nhibernate "显示标记为“休眠”的问题")和[entity-framework之](/questions/tagged/entity-framework "显示标记为“实体框架”的问题")类的框架。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T13:59:33.503

使用许多现有的[对象关系映射](http://en.wikipedia.org/wiki/Object-Relational_Mapping)框架之一，例如[实体框架](http://www.asp.net/entity-framework)

# point-of-sale - 单独配置ofbiz pos

> ID：10192635
> 
> 赞同：-1
> 
> 时间：2012-04-17T13:54:33.987
> 
> 标签：point-of-sale, ofbiz

我想知道如何在我的机器上单独使用 ofbiz-pos。对于这个 POS，最少需要什么（软件）。我们是否需要在 POS 机中安装整个 ofbiz 框架才能运行 POS 应用程序？

谁能帮我解决这个问题

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T15:44:12.867

它与“全功能”Apache OFBiz 安装相同。

您基本上只需要 Java 6（以及用于生产的“真实”数据库，但对于测试/评估嵌入式 Derby 就足够了），请参阅[https://cwiki.apache.org/OFBTECH/apache-ofbiz-technical-production- setup-guide.html](https://cwiki.apache.org/OFBTECH/apache-ofbiz-technical-production-setup-guide.html)了解详细信息（当然，如果您不使用 Web 界面，则不需要 Url/Ports/SSL-Settings）

# c - Makefile：尽管给出了目标，但没有制定目标的规则？

> ID：10192636
> 
> 赞同：2
> 
> 时间：2012-04-17T13:54:35.000
> 
> 标签：c, makefile

尝试使用 Make 时出现以下错误：

```
make: *** 没有规则来制作目标 `paging.c'，​​`obj/paging.o' 需要。停止。
```

但是我已经给 makefile 提供了制作目标的规则。这是我的生成文件：

```
 --------
C_SOURCES= main.c monitor.c common.c descriptor_tables.c timer.c paging.c \
        fs.c initrd.c task.c syscall.c                           --------
S_SOURCES= boot.s interrupt.s gdt.s process.s
C_OBJECTS=$(patsubst %.c, obj/%.o, $(C_SOURCES))
S_OBJECTS=$(patsubst %.s, obj/%.o, $(S_SOURCES))
CFLAGS=-c -nostdlib -nostdinc -fno-builtin -fno-stack-protector -m32 -Iheaders
LDFLAGS=-Tlink.ld -melf_i386 --oformat=elf32-i386
ASFLAGS=-felf

all: kern/kernel

.PHONY: clean
clean:
-rm -f obj/*.o kern/kernel

kern/kernel: $(S_OBJECTS) $(C_OBJECTS)
ld $(LDFLAGS) -o $@ $^

$(C_OBJECTS): obj/%.o : source/%.c 
gcc $(CFLAGS) $< -o $@

vpath %.c source

$(S_OBJECTS): obj/%.o : %.s
nasm $(ASFLAGS) $< -o $@

vpath %.s asem 
```

注意：`--------`不在原始 makefile 中，它们仅用于选择我使用的规则。

制作输出：

```
nasm -felf asem/boot.s -o obj/boot.o
nasm -fenasm -felf asem/boot.s -o obj/boot.o
nasm -felf asem/interrupt.s -o obj/interrupt.o
nasm -felf asem/gdt.s -o obj/gdt.o
nasm -felf asem/process.s -o obj/process.o
gcc -c -nostdlib -nostdinc -fno-builtin -fno-stack-protector -m32 -Iheaders source/main.c -o obj/main.o
gcc -c -nostdlib -nostdinc -fno-builtin -fno-stack-protector -m32 -Iheaders   source/monitor.c -o obj/monitor.o
gcc -c -nostdlib -nostdinc -fno-builtin -fno-stack-protector -m32 -Iheaders   source/common.c -o obj/common.o
gcc -c -nostdlib -nostdinc -fno-builtin -fno-stack-protector -m32 -Iheaders source/descriptor_tables.c -o obj/descriptor_tables.o
gcc -c -nostdlib -nostdinc -fno-builtin -fno-stack-protector -m32 -Iheaders source/timer.c -o obj/timer.o
make: *** No rule to make target `source/paging.c', needed by `obj/paging.o'. Stop. 
```

尽管给了它需要的东西，为什么它仍然出现错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T14:07:36.223

您将不得不更改线路

```
$(C_OBJECTS): obj/%.o : %.c 
```

至

```
$(C_OBJECTS): obj/%.o : source/%.c 
```

编辑，以反映问题的变化：

```
void page_fault(registers_t regs)
void page_fault(registers_t *regs); 
```

比较 ;) 两者应该是一样的。根据 paging.c 中的代码块，应该更正 paging.h 中的版本（只需删除 *）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T13:57:24.817

文件 paging.c 是否与 Makefile 存在于同一目录中？

如果没有，Make 将寻找创建它的规则。由于没有创建 paging.c 的规则，它会给你这个错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T17:36:17.653

该错误告诉您“make”在 vpath 或当前目录中的任何位置都找不到文件“paging.c”，并且没有从任何其他源文件创建“paging.c”的规则。

确保在您认为有的地方确实有“paging.c”，并且它实际上被称为“paging.c”而不是“paging.c”（额外空间）或其他一些看起来像“paging”的 unicode 特殊内容.c" 当您打印出来时，但不是。

# java - 使用 JPA 继承作为获得不同方法实现的一种方式是否有意义？

> ID：10192637
> 
> 赞同：1
> 
> 时间：2012-04-17T13:54:42.087
> 
> 标签：java, jpa

所以，我一直在努力熟悉 JPA 的继承特性，并且到目前为止我真的很喜欢它们。我最近想到的一件事是，它们实际上可以用于检索数据以外的其他用途。鉴于它可以根据鉴别器值获取子类，因此继承实际上是一种将配置字段转换为实现的便捷方式。在那个阶段，我的知识与经验的比率处于“刚好够危险/不足以始终意识到它的区域”，我认为最好问问这是否是个好主意。

以 PRODUCT 和 BILLTYPE 表为例。

```
Product:
int Id
int billtypeid

Billtype:
int id
varchar[15] description 
```

Billtype 只是产品的一种计费策略（我们会说一些订单可能按重量计费，而另一些可能只是按箱计费）。在开票过程中，每种账单类型都需要使用不同的方法。Billtype 表可能只有少数条目，并且不应该变得非常大。

使用继承来子类化抽象的 Billtype 实体是否有意义，该实体还为发票代码所需的不同方法定义了一个接口？像这样的东西：

```
@Entity
@DiscriminatorColumn("description")
public abstract class BillType {
   // Getters, setters
   // Abstract methods that could be used elsewhere - ex:
   // BigDecimal calculateInvVal(...)
}

@Entity
@DiscriminatorValue("by case")
public class CaseBillType extends BillType {
   // Implementation of calculateInvVal - now when invoicing code needs this method, 
   // the right one is always associated with the current product!
} 
```

这提供了一种方便的方法来将行为与数据库中表示配置数据的字段相关联，但将业务代码与实体混合在一起（在大多数情况下，这非常顽皮）。可能有一个设计模式来解决我的曲目中缺少的这个问题，但我真的很想避免写很多，“如果账单类型是这样，获取这个子类，如果账单类型是这样，等等“ 代码。

我从答案中寻找的是对这种技术的潜在缺点的解释，我可能看不到这将证明寻找该问题的另一种解决方案是合理的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T14:12:09.220

如果可以在运行时添加、删除和修改帐单类型，而无需重新构建和重新部署应用程序的新版本，那么将产品与 BillType 实体链接是很有用的。您的示例并非如此。

因此，如果您拥有的是一组静态账单类型，每个都定义了由 BillType 子类封装的静态行为，那么您可以简单地使用 BillType 枚举。此枚举的每个实例都定义了自己的行为。为此，您不需要实体层次结构和附加表。

在 Product 实体中计算 InVal 的代码将完全相同：

```
BigDecimal computeInVal() {
    billType.calculateInVal(this);
} 
```

获取所有账单类型的代码是

```
return BillType.values(); 
```

而不是以下代码将账单类型与产品相关联：

```
product.setBillType(em.find(BillType.class, ID_OF_CASE_BILL_TYPE)); 
```

你只会有

```
product.setBillType(BillType.BY_CASE); 
```

# java - jaxb 隐藏枚举值

> ID：10192641
> 
> 赞同：2
> 
> 时间：2012-04-17T13:54:56.267
> 
> 标签：java, jaxb, cxf

是否有 JAXB 注释允许我们使用枚举隐藏某些值？

例如，如果我想在以下枚举中隐藏值 BLUE：

```
public enum COLOR {
   RED,
   YELLOW,
   GREEN,
   @SomeAnnotation
   BLUE
} 
```

有没有办法按照规范做到这一点？

编辑：一些评论者提到这样做没有意义。我（恭敬地）不同意。在 JAXB/Web 服务领域有这样的先例。这是我正在考虑的情况：

使用 Java-First Web 服务设计，类和枚举被直接转换为 XSD 并通过 Web 服务公开。现在可能存在我们想要从 Web 服务中隐藏某些（敏感？）数据的情况，但让库可以直接访问代码。对于类字段，JAXB 提供了一个 @XmlTransient 注释来隐藏不应通过 Web 服务公开的字段 - 它只表明枚举值也可能存在这种需求。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T16:08:58.353

**注意：** 我是[**EclipseLink JAXB (MOXy)**](http://www.eclipse.org/eclipselink/moxy.php)负责人，也是[**JAXB 2 (JSR-222)**](http://jcp.org/en/jsr/detail?id=222)专家组的成员。

以下示例适用于 EclipseLink JAXB (MOXy)，但似乎在我正在使用的 JDK (Oracle JDK 1.6.0_29) 中包含的 JAXB 版本引发异常。

**颜色适配器**

我使用 a`XmlAdapter`将`enum`值转换为 a `String`。如果值是，`BLUE`那么我返回 null 作为`String`值。这将导致 JAXB 不编组相应的节点。

```
package forum10192641;

import javax.xml.bind.annotation.adapters.XmlAdapter;

public class COLORAdapter extends XmlAdapter<String, COLOR> {

    @Override
    public COLOR unmarshal(String v) throws Exception {
        return COLOR.valueOf(v);
    }

    @Override
    public String marshal(COLOR v) throws Exception {
        if(v == COLOR.BLUE) {
            return null;
        }
        return v.name();
    }

} 
```

**颜色**

`XmlAdapter`是使用`@XmlJavaTypeAdapter`注解注册的。如果您希望将适配器应用于所有实例，`COLOR`则可以在`COLOR`枚举本身上指定适配器。

```
package forum10192641;

import javax.xml.bind.annotation.adapters.XmlJavaTypeAdapter;

@XmlJavaTypeAdapter(COLORAdapter.class)
public enum COLOR {
    RED,
    YELLOW,
    GREEN,
    BLUE
 } 
```

**富**

下面是一个具有三个 type 属性的域类`COLOR`：

```
package forum10192641;

import javax.xml.bind.annotation.XmlRootElement;

@XmlRootElement
public class Foo {

    private COLOR color1;
    private COLOR color2;
    private COLOR color3;

    public COLOR getColor1() {
        return color1;
    }

    public void setColor1(COLOR color1) {
        this.color1 = color1;
    }

    public COLOR getColor2() {
        return color2;
    }

    public void setColor2(COLOR color2) {
        this.color2 = color2;
    }

    public COLOR getColor3() {
        return color3;
    }

    public void setColor3(COLOR color3) {
        this.color3 = color3;
    }

} 
```

**jaxb.properties**

将 MOXy 指定为您的 JAXB 提供程序，您需要包含一个`jaxb.properties`与您的域模型在同一包中命名的文件，其中包含以下条目：

```
javax.xml.bind.context.factory = org.eclipse.persistence.jaxb.JAXBContextFactory 
```

**演示**

```
package forum10192641;

import javax.xml.bind.*;

public class Demo {

    public static void main(String[] args) throws Exception {
        JAXBContext jc = JAXBContext.newInstance(Foo.class);
        Marshaller marshaller = jc.createMarshaller();
        marshaller.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT, true);

        Foo foo = new Foo();
        foo.setColor1(COLOR.GREEN);
        foo.setColor2(COLOR.BLUE);
        foo.setColor3(COLOR.RED);
        marshaller.marshal(foo, System.out);
    }

} 
```

**输出**

下面是运行演示代码的输出。

```
<?xml version="1.0" encoding="UTF-8"?>
<foo>
   <color1>GREEN</color1>
   <color3>RED</color3>
</foo> 
```

# java - 需要帮助修复我的项目的输出

> ID：10192642
> 
> 赞同：0
> 
> 时间：2012-04-17T13:55:01.150
> 
> 标签：java, android, eclipse

```
int department;
Button search;
String display;
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    department = 0;
    search = (Button) findViewById(getResources().getIdentifier("btnSearch", "id",    getPackageName()));
    display = (String) findViewById(getResources().getIdentifier("tvDisplay", "id",      getPackageName()));

    search.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {
            // TODO Auto-generated method stub
            if (department == 1)
            {
                display = "food";
            } 
```

我想要做的是让用户输入一个数字，点击一个按钮，它将在我底部的 textView 中显示一个部门名称。但是，我遇到了错误，我已经将它的几个部分转换为字符串而不是 textView。我如何修复输出的去向？

`display = (String) findViewById(getResources().getIdentifier("tvDisplay", "id", getPackageName()));`说它不能从视图转换为字符串。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T13:58:44.833

尝试这个：

```
TextView display = (TextView) findViewById(getResources().getIdentifier("tvDisplay", "id", getPackageName()));

// get the text
String displayString = (String)display.getText(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T14:07:55.073

问题是您正在将文本视图转换为字符串。您应该将类​​型更改`display`为`TextView`，并使用其`setText`方法在其中显示文本，尝试以下代码：

```
int department;
Button search;
TextView display;

@Override
public void onCreate(Bundle savedInstanceState)
{
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    department = 0;
    search = (Button) findViewById(getResources().getIdentifier("btnSearch", "id", getPackageName()));
    display = (TextView) findViewById(getResources().getIdentifier("tvDisplay", "id", getPackageName()));

    search.setOnClickListener(new View.OnClickListener()
    {
        public void onClick(View v)
        {
            // TODO Auto-generated method stub
            if (department == 1)
            {
                display.setText("food");
            }
        }
    });
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T14:01:44.337

tvDisplay 是一个 TextView，而不是一个字符串。因此，请显示一个 TextView，找到该视图，然后调用 display.getText() 以获取显示的文本。

# c# - Emgu CV 检查网络摄像头连接

> ID：10192645
> 
> 赞同：1
> 
> 时间：2012-04-17T13:55:15.477
> 
> 标签：c#, emgucv

我正在使用 Emgu CV 编写 C# 网络摄像头应用程序。当用户在pictureBox中的帧捕获期间拔下网络摄像头时，我试图处理。
如果网络摄像头已拔下，则应用程序应每 2 秒开始扫描新的网络摄像头连接，直到可以再次更新图片框。
以下计时器代码无法捕捉任何内容，程序最初捕捉帧，我拔下相机，然后重新插上，但相机无法重新启动。

```
private void timer1_Tick(object sender, EventArgs e)
    {

        if (cap == null)
        {
            try
            {
                cap = new Capture(0);
                cap.SetCaptureProperty(CAP_PROP.CV_CAP_PROP_FRAME_WIDTH, 320);
                cap.SetCaptureProperty(CAP_PROP.CV_CAP_PROP_FRAME_HEIGHT, 240);

                Console.WriteLine("Restarting Cam");
            }
            catch (Exception ee){ 
                Console.WriteLine("null"); cap = null;  return; 
            }
        }
        else
        {
            Console.WriteLine("NO null");
        }

        try
        {
            Image<Bgr, byte> nextFrame = cap.QueryFrame();
        }
        catch(Exception ee)
        {
            Console.WriteLine("Frame Capture fail");
            cap.Dispose();
            cap = null;
            return;
        }
        using (Image<Bgr, byte> nextFrame = cap.QueryFrame())
        {
            if (nextFrame != null)
            {
                Image<Gray, byte> grayframe = nextFrame.Convert<Gray, byte>();
                videoBox.Image = nextFrame.ToBitmap();
            }
        }
    } 
```

程序继续打印“No null”，拔掉相机后 20 秒，输出控制台打印出线程 '' (0xb96c) has exited with code 0 (0x0)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-03-04T19:01:44.453

您可以使用 DirectShow lib 检查连接性。首先获取所有连接的摄像头阵列

```
DirectShowLib.DsDevice[] allCameras = DirectShowLib.DsDevice.GetDevicesOfCat(FilterCategory.VideoInputDevice); 
```

将所选相机名称的类属性添加到您的类属性中，然后您可以检查相机是否已连接

```
bool isConnected = DirectShowLib.DsDevice.GetDevicesOfCat(FilterCategory.VideoInputDevice).Any(c => c.Name == selectedCameraName); 
```

# php - preg_replace 可以一次进行多个搜索和替换操作吗？

> ID：10192646
> 
> 赞同：4
> 
> 时间：2012-04-17T13:55:24.573
> 
> 标签：php, regex

这是如何做到的，分几行：

```
// $str represents string that needs cleaning:
$str = " String with   line\nbreak and too  much spaces   ";
// Clean string with preg_replace():
$str = preg_replace('/[\x00-\x09\x0B-\x1F\x7F]|^ +| +$/', '', $str);
$str = preg_replace('/\x0A| +/', ' ', $str);

echo $str;
// Output:
"String with line break and too much spaces" 
```

我的问题集中在将两条 preg_replace() 行组合成一个 preg_replace() 来完成完全相同的工作。

这可能吗？如果是这样的话，应该怎么做？

* * *

这种行为有许多不同的用途，我所追求的一种是将正则表达式定义为常量或变量，并在类函数中使用它来清理和验证用户输入。

这样类的简化示例：

```
class cleaner{
    protected $defined_methods = array(
    'TRIM' => '/ +/',
    'STRIP_CC' => '/[\x00-\x1F\x7F]/',
    'TRIM_STRIP_CC' => array('/[\x00-\x1F\x7F]/', '/ +/')
    );
    protected $defined_results = array(
    'TRIM' => ' ', 
    'STRIP_CC' => '',
    'TRIM_STRIP_CC' => array('', ' ')
    );

    function clean(array $input, array $methods){
        foreach ($input as $key => $data){
            $input[$key] = preg_replace($defined_methods[$methods[$key]], $defined_results[$methods[$key]], $data);
        }
        return $input;
    }
} 
```

如果需要，这种方式验证方法（正则表达式）可以随输入数据而变化。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-17T13:59:54.217

```
$str = preg_replace(
    $patterns = array('/[\x00-\x09\x0B-\x1F\x7F]|^ +| +$/', '/\x0A| +/'),
    $replace  = array('',                                   ' '), 
    $str
); 
```

看[`preg_replace`](http://php.net/manual/function.preg-replace.php)，它支持多个替换。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T14:00:09.757

当然; 不过，这有点棘手：

```
$str = trim(preg_replace('/[\x00-\x09\x0B-\x1F\x7F\s]*\s[\x00-\x09\x0B-\x1F\x7F\s]*/', ' ', $str)); 
```

# javascript - 带主干的页面转换

> ID：10192647
> 
> 赞同：1
> 
> 时间：2012-04-17T13:55:34.377
> 
> 标签：javascript, backbone.js

我已按照示例进行操作，目前正在为我在骨干网中的应用程序使用事件聚合器路由器。

所以基本上我可能根本不使用锚元素，而是在点击事件触发路由器事件时有任何元素。

我仍然觉得我可能会遗漏一些东西，这种导航方式与通过模板编译直接放入链接相比有什么缺点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T04:02:18.483

我可以想到使用带有哈希路由的普通锚标记而不是让点击事件触发路由更改的几个好处：

*   它将使您的网站更容易被搜索引擎索引，从而改善 SEO。
*   它将允许用户轻松右键或 cmd 单击并在新选项卡/窗口中打开您的页面。

# c++ - 了解 Qt 的 QTransform 旋转功能

> ID：10192651
> 
> 赞同：6
> 
> 时间：2012-04-17T13:56:06.590
> 
> 标签：c++, qt, rotation, coordinates

由于[这个问题](https://stackoverflow.com/questions/10186102/determining-the-correct-origin-to-rotate-a-qpolygonf-around)，我想更多地了解 Qt 的`QTransform::rotate`功能。[在文档](http://qt-project.org/doc/qt-4.8/qtransform.html#rotate)中，它说：

> QTransform & QTransform::rotate ( qreal 角度, Qt::Axis 轴 = Qt::ZAxis )
> 
> 将坐标系绕指定轴逆时针旋转给定角度，并返回对矩阵的引用。
> 
> 请注意，如果将 QTransform 应用于在小部件坐标中定义的点，则旋转方向将是顺时针方向，因为 y 轴指向下方。
> 
> 角度以度数指定。

从我之前的问题中，我了解到要`QPolygonF`顺时针旋转，我实际上必须将它逆时针旋转 90 度，根据`rotate`函数：

```
QPolygonF original = QPolygonF() << QPoint(0, 1) << QPoint(4, 1) << QPoint(4, 2) << QPoint(0, 2);
QTransform transform = QTransform().translate(2, 2).rotate(90).translate(-2, -2);
QPolygonF rotated = transform.map(original);
qDebug() << rotated; 
```

输出：

```
QPolygonF(QPointF(3, 0) QPointF(3, 4) QPointF(2, 4) QPointF(2, 0) ) 
```

例如对于这个矩形：

![原始矩形旋转](../Images/4f74b09363b8209cffe992d05fd05f39.png)

旋转到这里：

![新的矩形旋转](../Images/1495f0768b508795774da6c9a89294da.png)

为什么是这样？当我相信我不在“小部件坐标”中时，为什么文档说我的调用`QTransform::rotate`实际上导致了顺时针旋转 - 这里没有涉及小部件。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-17T15:00:17.817

QTransform 在数学笛卡尔坐标系中运行。IE。右上角的象限是正 x 和正 y 的一个（象限 1）。您的图表位于 y 轴翻转的 Widget 坐标中，右下角为象限 1。

Rotate 确实逆时针旋转。但是由于 Y 轴在 Widget 坐标中是翻转的，所以它变成了顺时针方向。

正如您所提到的，多边形与小部件无关。它确实逆时针旋转，但您正在使用小部件坐标对其进行可视化。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-16T19:58:56.460

实际上我认为问题在于所讨论的函数旋转坐标系 - 而不是对象。如果要顺时针旋转对象，则相当于逆时针旋转坐标系。

# jpa - 更新/与 JPA 合并并不完美，我不知道为什么，它不会更新所有内容？

> ID：10192655
> 
> 赞同：0
> 
> 时间：2012-04-17T13:56:14.843
> 
> 标签：jpa, merge

编辑：我把案子改成了婚礼，但这里的情况完全一样。
我有一个这样的实体/数据库结构：组 <----> 用户 <-----> 婚礼。这意味着用户拥有婚礼，而婚礼可以有许多具有不同角色和组的用户。我正在尝试同时为注册用户和新（婚礼）用户添加婚礼。下面的代码将新婚礼插入数据库，但不是婚礼的新用户。如果我尝试添加一个新用户只是为此目的调用方法（与数据库不同的事务），我得到了一个新用户并与它结婚。之后我尝试合并 currentUser ，但 currentUser /注册用户的weddingID仍然为空。丑陋的代码，但我希望你能活下来！

用户实体：

```
@JoinColumn(name = "wedding_wedding_id", referencedColumnName = "wedding_id")
@ManyToOne (cascade= CascadeType.ALL)
private Wedding weddingWeddingId;

@ManyToMany(mappedBy = "usersCollection")
private Collection<Groups> groupsCollection; 
```

婚礼实体

```
@OneToMany(mappedBy = "weddingWeddingId",cascade=CascadeType.ALL)
    private Collection<Users> usersCollection; 
```

用户控制器：

```
public String createWeddingAndWeddingUser() {

        Users weddingUser = null;
        List<Users> usersCollection = (List<Users>) currentUser.getWeddingWeddingId().getUsersCollection();

        //Creates wedding and wedding user, one username and password for all guests
        if (currentUser.getHasGuestUsers() == Boolean.TRUE && currentUser.getWeddingWeddingId() != null) {

            // We are using Transient property
            weddingUser = currentUser.getWeddingWeddingId().getGuestUsers();

            //Fetching group for User-group. Table: Groups
            FacesContext context = FacesContext.getCurrentInstance();
            GroupsController groupsC = (GroupsController) context.getApplication().evaluateExpressionGet(context, "#{groupsController}", GroupsController.class);
            Groups userGroup = null;

            try {
                // Group 3 is group for users
                userGroup = groupsC.getGroupByGroupId(new Integer(3));
            } catch (Exception e) {
                JsfUtil.addErrorMessage(e, ResourceBundle.getBundle("resources/Bundle").getString("PersistenceErrorOccured"));
                return null;
            }

            Collection groupCollection = new ArrayList<Groups>();
            groupCollection.add(userGroup);

            weddingUser.setGroupsCollection(groupCollection);
            // Both user must have the same wedding, first one is admin and another one is user
            weddingUser.setWeddingWeddingId(currentUser.getWeddingWeddingId());

            weddingUser.setFirstName(weddingUser.getUsername());
            weddingUser.setLastName(weddingUser.getWeddingWeddingId().getName());

            if (usersCollection == null) {
                usersCollection = new ArrayList<Users>();
            } else {
                usersCollection.add(weddingUser);
                usersCollection.add(currentUser);
            }

            currentUser.getWeddingWeddingId().setUsersCollection(usersCollection);

            try {

                // Should update the "master" user and create a new user and a wedding
                currentUser = getFacade().mergeUser(currentUser);

                JsfUtil.addSuccessMessage(ResourceBundle.getBundle("resources/Bundle").getString("WeddingAndUserCreated"));
                return "View";

            } catch (Exception e) {
                JsfUtil.addErrorMessage(e, ResourceBundle.getBundle("resources/Bundle").getString("PersistenceErrorOccured"));
                return null;
            }

        } else {

            if (usersCollection == null) {
                usersCollection = new ArrayList<Users>();
            }
            usersCollection.add(currentUser);
            currentUser.getWeddingWeddingId().setUsersCollection(usersCollection);

            try {
              // Edit is same than MERGE                    
              getFacade().edit(currentUser);

                JsfUtil.addSuccessMessage(ResourceBundle.getBundle("resources/Bundle").getString("WeddingCreated"));
            } catch (Exception e) {
                JsfUtil.addErrorMessage(e, ResourceBundle.getBundle("resources/Bundle").getString("PersistenceErrorOccured"));
                return null;
            }

        }

        return "View";

    } 
```

**其他块工作得很好。**它只是为 currentUser 添加了一个新婚礼，一切正常。

我决定在更新派对/婚礼等时使用上层实体（用户）。例如，当用户添加婚礼时，我只需调用 MERGE USER。

你怎么看，我应该把整个案子分开吗？如果我只是先添加派对/婚礼并获得一个 ID。之后，我获取婚礼并从数据库获取自动增量 ID。然后我合并注册用户，以便它获得对婚礼的引用。之后我创建一个新用户并将婚礼ID插入其中？听起来很假，因为我认为 JPA 只是为了避免这种情况，对吗？这样就需要大量的阅读和写作……我认为在这种情况下应该是不必要的。我想一次处理所有事情，婚礼、更新当前用户（管理员）和创建婚礼用户。

# javascript - 如何检查 JavaScript 变量是否未定义？

> ID：10192662
> 
> 赞同：232
> 
> 时间：2012-04-17T13:56:34.083
> 
> 标签：javascript, undefined

我尝试过的似乎不起作用的事情：

```
if(lastName != "undefined") 
```

```
if(lastName != undefined) 
```

```
if(undefined != lastName) 
```

* * *

## 回答 #1

> 赞同：455
> 
> 时间：2012-04-17T13:58:39.883

```
var lastname = "Hi";

if(typeof lastname !== "undefined")
{
  alert("Hi. Variable is defined.");
} 
```

# haskell - 为什么我不能使用存在量化类型的记录选择器？

> ID：10192663
> 
> 赞同：31
> 
> 时间：2012-04-17T13:56:44.643
> 
> 标签：haskell, record, existential-type

当使用 Existential 类型时，我们必须使用模式匹配语法来提取`forall`ed 值。我们不能将普通的记录选择器用作函数。GHC 报告错误并建议使用以下定义的模式匹配`yALL`：

```
{-# LANGUAGE ExistentialQuantification #-}

data ALL = forall a. Show a => ALL { theA :: a }
-- data ok

xALL :: ALL -> String
xALL (ALL a) = show a
-- pattern matching ok

-- ABOVE: heaven
-- BELOW: hell

yALL :: ALL -> String
yALL all = show $ theA all
-- record selector failed 
```

* * *

```
forall.hs:11:19:
    Cannot use record selector `theA' as a function due to escaped type variables
    Probable fix: use pattern-matching syntax instead
    In the second argument of `($)', namely `theA all'
    In the expression: show $ theA all
    In an equation for `yALL': yALL all = show $ theA all 
```

我的一些数据包含超过 5 个元素。如果我使用模式匹配，很难维护代码：

```
func1 (BigData _ _ _ _ elemx _ _) = func2 elemx 
```

有没有一种好方法可以使这样的代码可维护或将其包装起来以便我可以使用某种选择器？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-04-17T17:42:33.530

存在类型以比常规类型更精细的方式工作。GHC（正确地）禁止您将`theA`其用作函数。但想象一下没有这样的禁令。该功能将具有什么类型？它必须是这样的：

```
-- Not a real type signature!
theA :: ALL -> t  -- for a fresh type t on each use of theA; t is an instance of Show 
```

说的很粗暴，`forall`就是让 GHC “忘记”构造函数参数的类型；类型系统只知道这个类型是`Show`. 所以当你试图提取构造函数参数的值时，没有办法恢复原来的类型。

GHC 在幕后所做的是上面对假类型签名的注释所说的——每次你对`ALL`构造函数进行模式匹配时，绑定到构造函数值的变量被分配一个唯一的类型，该类型保证不同于其他所有类型. 以这段代码为例：

```
case ALL "foo" of
    ALL x -> show x 
```

该变量`x`获得了一个独特的类型，该类型与程序中的所有其他类型都不同，并且不能与任何类型变量匹配。这些独特的类型不允许逃逸到顶层——这就是为什么`theA`不能用作函数的原因。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-04-17T14:10:09.860

您可以在模式匹配中使用记录语法，

```
func1 BigData{ someField = elemx } = func2 elemx 
```

有效，并且对于大型类型的打字要少得多。

# iphone - UITabBarItem 标题位置

> ID：10192665
> 
> 赞同：10
> 
> 时间：2012-04-17T13:56:45.873
> 
> 标签：iphone, objective-c, uitabbaritem

在网上搜索如何调整 UITabBarItem 标题位置的位置时，我浏览了[这个](https://stackoverflow.com/questions/5432169/uitabbaritem-title-in-centre-of-title-not-at-bottom)类似的帖子，但仍然想知道如何做到这一点。

甚至可以从下向上调整标题位置吗？（例如 5px）我需要这个，因为我有自定义图像，现在标题的位置并不完美。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-12-18T15:03:28.870

如果要向上移动，只需将垂直偏移设置为负值

```
UITabBarItem* it = [[self.tabController.tabBar items] objectAtIndex:0];
it.titlePositionAdjustment = UIOffsetMake(0.0, -2.0); 
```

您不必使用代理，因为它在这里完成[UITabBarItem 标题在标题中心，而不是在底部](https://stackoverflow.com/questions/5432169/uitabbaritem-title-in-centre-of-title-not-at-bottom)。您可以定义每个项目的偏移量。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2016-08-30T11:48:50.100

懒人的 Swift 版本 :)

```
UITabBarItem.appearance().titlePositionAdjustment = UIOffsetMake(0.0, -4.0) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2019-06-26T18:18:57.470

如果要更新所有这些：

```
tabBar.items?.forEach({ $0.titlePositionAdjustment = UIOffset(horizontal: 0.0, vertical: -2.0) }) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-17T15:02:06.533

为什么不为视图控制器设置一个空的标题属性并将标题添加到选项卡的自定义图像中？

您可以这样做（在 iOS 5.0 中）：

```
UIImage* iconSelected = [UIImage imageNamed:@"tabIconSelected.png"];
UIImage* iconNotSelected = [UIImage imageNamed:@"tabIconNotSelected.png"];
UITabBarItem *updatesListItem = [[UITabBarItem alloc] initWithTitle:@"" image:iconSelected tag:0];
[updatesListItem setFinishedSelectedImage:iconSelected withFinishedUnselectedImage:iconNotSelected];
[navigationController setTabBarItem:updatesListItem]; 
```

where`tabIconSelected.png`和`tabIconNotSelected.png`都包含选项卡的标题文本。

我写了一篇简短的文章[“为您的 UITabBar 图标添加一些颜色”](http://coderun.net/add-some-colour-to-your-uitabbar-icons/)，它解释了如何使用带有标签的自定义图像。

希望这可以帮助。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-10-23T13:58:04.880

目标 C 中的全局调整：

```
[[UITabBarItem appearance] setTitlePositionAdjustment:UIOffsetMake(0, -4)]; 
```

# php - Instagram 实时 PHP API

> ID：10192666
> 
> 赞同：2
> 
> 时间：2012-04-17T13:56:54.440
> 
> 标签：php, real-time, instagram

有一些关于 Instagram 实时 API 的问题。首先让我告诉你我想做什么。我想运行一个带有套接字连接或类似 Instagram API 的守护进程，以获取带有特定标签的照片的持续馈送。我们估计它是特定时间的大量数据（这就是我们想要实时的原因）。此过程将解析提要并将其存储到 mongodb 中。

其次，对于前端，我想实时显示所有新的实时照片，可能使用 ajax 或某种形式的检查设置间隔。

问题是，我找不到任何人用 php 做这个。我见过的所有资源都使用 Node.js 和 Tornado。有没有人用 PHP 做过这个，或者知道一个很好的实时 API 演示/教程来让我开始？

这是文档... [http://instagr.am/developer/realtime/](http://instagr.am/developer/realtime/)

# erlang - 钢筋生成：enotdir 错误

> ID：10192671
> 
> 赞同：0
> 
> 时间：2012-04-17T13:57:13.900
> 
> 标签：erlang, rebar

我正在尝试为我的 otp 应用程序设置钢筋释放。我遵循了本指南：[https ://github.com/basho/rebar/wiki/Getting-started](https://github.com/basho/rebar/wiki/Getting-started)

当我尝试生成一个版本时，我得到很多 enotdir 错误：

```
~/Projekte/mc-erl/repo $ ./rebar generate
==> rel (generate)
Error reading /home/clonejo/Projekte/mc-erl/repo/rebar/rebar_app_utils.beam's file info: enotdir
Error reading /home/clonejo/Projekte/mc-erl/repo/rebar/rebar_deps.beam's file info: enotdir
Error reading /home/clonejo/Projekte/mc-erl/repo/rebar/rebar_appups.beam's file info: enotdir
[... enotdir errors go on ...]
[... all above enotdir errors are repeated ...]
ERROR: Unable to generate spec: read file info /usr/lib/erlang/man/man1/preunzip.1 failed 
```

这是我的 erlang 版本：

```
$ erl
Erlang R15B (erts-5.9) [source] [64-bit] [smp:2:2] [async-threads:0] [hipe] [kernel-poll:false]

Eshell V5.9  (abort with ^G) 
```

我在[http://cloud.github.com/downloads/basho/rebar/rebar](http://cloud.github.com/downloads/basho/rebar/rebar)获得了钢筋（请参阅 GettingStarted wiki 页面）。

**更新：**详细模式只添加一个警告，这是不相关的：

```
WARN:  'generate' command does not apply to directory /home/clonejo/Projekte/mc-erl/repo/apps/mc_erl 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T11:38:39.133

很可能，您已经以某种方式安装了“重新加载器”模块，也许是通过您的 .erlang？该特定错误消息源自那里。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T09:24:34.077

你能用 -v 运行它吗

存在并且可能仍然存在错误 [http://lists.basho.com/pipermail/rebar_lists.basho.com/2011-July/000932.html](http://lists.basho.com/pipermail/rebar_lists.basho.com/2011-July/000932.html)

我建议更新 rebar 并运行 rebar -v 以查看更多信息。

# java - 无法理解 finally 块的行为

> ID：10192672
> 
> 赞同：2
> 
> 时间：2012-04-17T13:57:15.000
> 
> 标签：java, exception-handling

我是 Java 语言的新手，无法理解该程序中 finally 块的行为。该程序在打印 BC 后应该退出，而它正在打印 BCD。请帮忙。

```
class Main 
{  
    public static void main(String [] args) 
    {
        try 
        {
            badMethod();  
            System.out.print("A"); 
        }  
        catch (Exception ex) 
        {
            System.out.print("B");  
        } 
        finally 
        {
            System.out.print("C"); 
        } 
        System.out.print("D"); 
    }  
    public static void badMethod() throws Exception
    {
        throw new Exception(); /* Line 22 */
    } 
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-17T13:59:17.130

您正在捕获异常（在 catch 块中）而不是重新抛出它 - 因此您正在有效地*处理*异常，然后执行就好像它没有被抛出一样继续进行。程序只退出是因为它到达了`main`方法的结尾——它不像是突然终止。

If you change your code to *either* rethrow the exception from the catch block *or* just don't catch it in the first place (both of which will require you to declare that `main` throws `Exception`, of course) then it won't print `D`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-17T13:59:28.963

There is nothing to cause the program to exit.

The whole point of a `catch` block is to *catch* the exception and prevent it from propagating further.
After catching an exception, execution continues.

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-17T14:01:01.303

The `finally` block doesn't finalize the program, it just ensure to execute every time the try catch block runs whereas there is an exception or not..

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-17T13:58:50.780

如果您在块`BC`中重新抛出异常，它将打印。`catch`

```
catch (Exception ex) 
{
    System.out.print("B");  
    throw ex;
} 
```

然后你必须将你的主要声明为

```
public static void main(String [] args) throws Exception 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-17T14:00:07.830

Finally is called at the end of a try/catch block. It gets called even if the try fails and the catch is executed. The `Finally`block itself is only not executed if the program is killed somehow (JVM dies, forced to close, etc.)

In your example D is executing because it is outside of the try/catch/finally{} blocks.

There is a nice blog post on catching exceptions and the try/catch/finally behaviour [here](http://tutorials.jenkov.com/java-exception-handling/basic-try-catch-finally.html).

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-04-17T14:00:21.137

Which is correct. The above code will.

1.  Try to execute `badMethod` and will fail
2.  Execute the code in `catch`
3.  Execute the code in `finally`
4.  Continue in execution - print out the D

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-04-17T14:00:49.057

The `finally` block is processed after the `try` or `catch` block runs (depending on whether an exception was thrown/caught or not). If the exceptions were all caught properly and handles by the `catch`, it will run `finally` and then continue running the rest of the method.

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-04-17T14:02:20.247

Your program is functioning in the following way: 1\. Call a bad method that throws an exception 2\. Catch the exception 3\. Execute the finally block 4\. Resume

In Java, when an exception gets thrown it does not necessarily end program execution if the exception is handled. Your program does not actually handle the exception but catches it anyway and this is enough for the JVM to think it's ok to resume execution.

The output BCD is quite the right output.

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-04-17T14:10:07.643

Finally is the must executable block of java program. It allows all the allocated resources of the currently running program to get free and make it available for the other applications if required.

This is mainly used when we share the common resources like Database or the devices.

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-04-17T14:14:00.810

Think of the finally block as an independent block of code(s) you'll still expect your method to continue executing irrespective of whether an exception occurs or not.

And so in your case, `badMethod` throws an exception which is consequently caught by the catch block, your main then continue by executing the finally block independently.

In other words, if `badMethod` decides not to throw an exception, your finally block would still continue execute before reaching the end of the method.

Therefore with finally been an independent block it is then possible to also do something like this in your main code if prefered.

```
try
{
 fooA();
}
finally
{
 fooB();
} 
```

# iphone - UIScrollView 仅在显示键盘时才需要

> ID：10192678
> 
> 赞同：1
> 
> 时间：2012-04-17T13:57:44.693
> 
> 标签：iphone, ios, uiview, uiscrollview

我尝试了多种滚动视图的实现来处理键盘的存在，包括苹果自己的。我不能让他们中的任何一个工作。

我有一个在不显示键盘时不需要滚动的视图，但是一旦文本字段是第一响应者并且键盘显示，某些内容需要可滚动。

请注意，唯一可编辑的文本字段是屏幕上的第一个，因此我不需要滚动视图来取消隐藏任何内容 - 我只需要在屏幕的上半部分具有滚动能力，但仅在显示键盘时才需要。

这是我能得到的最接近的：

我可以成功注册键盘通知。加载时，我将滚动视图和内容大小设置为视图的全高。当键盘显示时，我将滚动视图的大小调整为原始高度减去键盘高度：

```
scrollView.frame = CGRectMake(0, 0, 320, 416 - kbSize.height); 
```

在隐藏时，我只是将其重置：

```
scrollView.frame = CGRectMake(0, 0, 320, 416); 
```

这几乎可以工作。除了，一旦显示键盘，如果我向下滚动到视图底部（保持键盘显示），然后使用它的返回键隐藏键盘，当滚动视图调整大小时，会有一个不雅的“跳转”回到顶部的屏幕。没有平滑的动画滚动来调整滚动视图的大小。

有任何想法吗？与 Apple 的实现相比，我认为我正在对此进行破解，但这是我所拥有的最接近的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T14:21:47.467

是的，就像贾斯汀保尔森评论的那样，但这里是代码

```
[UIView animateWithDuration:0.3 animations:^{
        self.scrollView.frame = newFrame;
}]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T14:54:28.790

我认为您可以在解雇之前修复滚动位置：

```
- (BOOL)textFieldShouldEndEditing:(UITextField *)textField {

    // like this:
    self.contentOffset = CGPointMake(0,0);

    // you can animate the frame change here, or where you were doing it
    [UIView animateWithDuration:0.2 animations:^{
        scrollView.frame = CGRectMake(0, 0, 320, 416);
    }];
    return YES;
} 
```

# javascript - 如何在javascript上将所有表单的数据放入JSON？

> ID：10192682
> 
> 赞同：0
> 
> 时间：2012-04-17T13:57:59.827
> 
> 标签：javascript, json

我有下一个表格：

```
<form id="form">
<input type="checkbox" name="numbers" value="1">
<select name="ordering[numbers]">
    <option value="ASC">Ascend</option>
    <option value="DESC">Descend</option>
</select><br>
<input type="checkbox" name="added_date" value="1"> Call date 
<select name="ordering[added_date]">
    <option value="ASC">Ascend</option>
    <option value="DESC">Descend</option>
</select>
</form> 
```

基本上我需要在提交表单之前将所有数据保存到 JSON 对象，我们称之为 form_json 我正在使用 jQuery.serializeArray() 函数

```
var form_json = $("#form").serializeArray(); 
```

如果两个复选框都被选中，我会得到下一个对象：

```
[
    {"name": "numbers", "value": "1"},
    {"name": "ordering[numbers]", "value": "ASC"},
    {"name": "added_date","value":"1"},
    {"name": "ordering[added_date]", "value": "ASC"}
] 
```

这不是我所期望的。我想以某种方式获得下一种格式：

```
[
    {"name": "numbers","value": "1"},
    {"name": "added_date","value": "1"},
    {"name": "ordering", "value": {
            "numbers": "ASC",
            "added_date": "ASC"}
    }  
] 
```

有可能这样做吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T14:22:15.337

我不确定 .serializeArray() 是否会创建该结构。您必须添加表单的其余部分，但这可能会让您更接近。

[http://jsfiddle.net/YSEZt/2/](http://jsfiddle.net/YSEZt/2/)

```
var ordering = {"name" : "ordering", "values" : {}};
ordering.values[$("select[name='ordering[numbers]']").prop('name')] =   $("select[name='ordering[numbers]']").val();    
ordering.values[$("select[name='ordering[added_date]']").prop('name')] =      $("select[name='ordering[added_date]']").val();
console.log(ordering)​ 
```

# .net - 指令 .NET 反射器的命名空间

> ID：10192687
> 
> 赞同：1
> 
> 时间：2012-04-17T13:58:17.410
> 
> 标签：.net, namespaces, assemblies, reflector, .net-reflector

在以前版本的 .NET Reflector 中，我能够在函数中获取指令的命名空间，但现在我不能，而且该文档不存在。

Red Gate 的 .NET Reflector 6.8.2.5（最后一个免费版本）

这条线工作但现在不行：指令.Value.declaringtype.namespace.ToString

如何获取指令的命名空间？

谢谢

```
Private Sub DesassamblerDLL(ByVal strDLLFile As String)
    Dim serviceProvider As New Reflector.ApplicationManager(Nothing)
    Dim assemblyManager As Reflector.CodeModel.IAssemblyManager
    Dim objAssembly As Reflector.CodeModel.IAssembly
    Dim objMod As Reflector.CodeModel.IModule
    Dim typeDeclaration As Reflector.CodeModel.ITypeDeclaration
    Dim methodDeclaration As Reflector.CodeModel.IMethodDeclaration

    assemblyManager = serviceProvider.GetService(GetType(Reflector.CodeModel.IAssemblyManager))
    objAssembly = assemblyManager.LoadFile(strDLLFile)

    For Each objMod In objAssembly.Modules
        For Each typeDeclaration In objMod.Types
            For Each methodDeclaration In typeDeclaration.Methods
                Dim methodBody As Reflector.CodeModel.IMethodBody = methodDeclaration.Body
                If Not methodBody Is Nothing Then
                    Dim instruction As Reflector.CodeModel.IInstruction
                    For Each instruction In methodBody.Instructions
                        str = instruction.Value.declaringtype.namespace.ToString
                    Next
                End If
            Next
        Next
    Next
End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T13:11:25.933

我在 Clive 的帮助下从[http://forums.reflector.net/questions/2226/namespace-of-an-instruction-net-reflector](http://forums.reflector.net/questions/2226/namespace-of-an-instruction-net-reflector)做到了。

```
Imports system.Reflection.Emit

Select Case instruction.Code
    Case OpCodes.Call.Value, OpCodes.Calli.Value, OpCodes.Callvirt.Value
        Dim targetMethodReference As Reflector.CodeModel.IMethodReference = instruction.Value
        Dim method As Reflector.CodeModel.IMethodDeclaration = targetMethodReference.Resolve
        Dim typeReference As Reflector.CodeModel.ITypeReference = method.DeclaringType
        ...
End Select 
```

# android - 故意关闭系统并重新启动应用程序

> ID：10192697
> 
> 赞同：1
> 
> 时间：2012-04-17T13:58:52.173
> 
> 标签：android, testing

我一直看到错误从我的应用程序中返回，它在系统停止后强制关闭，并且用户稍后将其带回前面。

我对导致此问题的原因有所了解，但我希望能够在尝试修复此错误之前重现此错误。

有谁知道一种方法可以让 android 系统表现得像它需要我的应用程序正在使用的内存并关闭它，以便我可以轻松且持续地重现此错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T14:00:32.433

如果您使用的是 Eclipse 或 DDMS，您可以在进程列表中选择您的应用程序并点击停止按钮。这应该关闭您的应用程序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T14:06:26.197

使用模拟器上的[开发工具应用](http://developer.android.com/guide/developing/debugging/debugging-devtools.html)程序，您可以让操作系统在应用程序停止后立即销毁它。

从文档中：

**立即销毁活动**

> 告诉系统在活动停止后立即销毁它（就像 Android 必须回收内存一样）。这对于测试 onSaveInstanceState(Bundle) / onCreate(android.os.Bundle) 代码路径非常有用，否则很难强制执行。由于不保存状态，选择此选项可能会揭示您的应用程序中的许多问题。有关保存活动状态的更多信息，请参阅活动文档。

进入开发工具应用程序后，您可以在开发设置下找到它。因此，在运行您的应用程序时，您可以切换到另一个应用程序（例如单击模拟器的硬电话按钮），然后返回到您的应用程序以测试销毁/创建过程。

# c# - 从 windows phone 中的其他类中检索对象

> ID：10192699
> 
> 赞同：0
> 
> 时间：2012-04-17T13:58:53.413
> 
> 标签：c#, oop, windows-phone

目前我在 Windows Phone 中有一个使用本地数据库的 Silverlight 应用程序。基本上会生成一个 listBox 来显示存储的“客户”的当前列表，它工作正常。现在我希望能够让用户编辑客户的详细信息之一。为此，我创建了一个新页面，每当用户单击主页上的按钮时都会加载该页面。事件如下：

```
public ClientItem selectedClient;

public void Edit_Click(object sender, EventArgs e)
    {
        if (clientItemsListBox.SelectedItem != null)
        {
            selectedClient = clientItemsListBox.SelectedItem as ClientItem;

            NavigationService.Navigate(new Uri("/EditClient.xaml", UriKind.Relative));
        }
    } 
```

以上只是检查选择了哪个客户端，将其存储为 selectedClient 并导航到 EditClient 页面。

在 EditClient 类中，我有以下方法：

```
 public void saveButton_Click(object sender, RoutedEventArgs e)
    {
        //Get the client that is selected

        ClientItem clientForDelete = mainPage.selectedClient;
        mainPage.ClientItems.Remove(clientForDelete);
        mainPage.clientDB.ClientItems.DeleteOnSubmit(clientForDelete);

        // Create a new client based on the text boxes
        ClientItem newClient = new ClientItem { ClientName = newClientNameTextBox.Text, ClientSurname = newClientSurnameTextBox.Text, ClientCompany = newClientCompanyTextBox.Text, ClientPhone = int.Parse(newClientPhoneTextBox.Text) };

        // Add new client to the database
        mainPage.clientDB.ClientItems.InsertOnSubmit(newClient);

        // Sava database changes
        mainPage.clientDB.SubmitChanges();

        // Go to main screen
        NavigationService.Navigate(new Uri("/MainPage.xaml", UriKind.Relative));
    } 
```

当我运行此代码时，它尝试执行时得到一个 nullReferenceException：

```
mainPage.ClientItems.Remove(clientForDelete); 
```

这是因为 selectedClient 为空。如何从其他类获取对象而不使其为空？因为我不想从主类中删除该项目，以防万一用户决定取消操作。此外，我想在加载页面时显示该客户端的详细信息，如果我设法获取对象，我知道该怎么做:)。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T14:27:53.417

您可以将客户端作为查询参数传递给其他页面：

```
 NavigationService.Navigate(
      new Uri("/MainPage.xaml?client="+clientId, UriKind.Relative)); 
```

然后在您的 MainPage 中`OnNavigatedTo()`检索客户端：

```
 if (this.NavigationContext.QueryString.ContainsKey("client"))
          client = this.NavigationContext.QueryString["client"]; 
```

# oop - 对象分配与对象创建

> ID：10192701
> 
> 赞同：1
> 
> 时间：2012-04-17T13:59:00.077
> 
> 标签：oop, object, pointers

我一直发现很难决定何时应该创建单个对象并将其传递给每个需要它的对象，或者为每个需要该项目的对象创建一个新对象。

有些情况非常明显，例如在分配和实例化后**只读的****实体**对象。您可以在任何地方传递同一个对象，而不必担心另一个对象会修改它，这会破坏持有对它的引用的其他对象。

 **我的问题主要在于向用户代表自己的对象。`CCSprite`cocos2d中的对象， `NSMenuItem`Cocoa (AppKit) 中的对象以及其他具有视觉表示的对象。

* * *

### 例子：

在**cocoa**中，我知道我必须`NSMenu`为 each创建一个`NSPopUpButton`，以便特定按钮的选择不会影响其余按钮。但是，`NSMenuItems`里面的内容呢？我可以创建一个集合并将它们传递给所有菜单吗？你的理由是什么，或者你是如何得出这样的结论的？

### 其他示例：

在 cocos2d 和几乎所有基于 GUI 的应用程序中，您可以将两个图像/精灵/...等传递给一个按钮。这样一个用于正常状态，另一个用于选择（突出显示、按下、单击）状态。我可以传递相同的图像/精灵/...等吗？对两者，使它们指向同一个对象？

我希望这不是一个与实现相关的问题（它最终取决于实现），因为我在很多编程项目中都遇到过它，在 cocoa、cocos2d、Java 等。

**PS：我需要帮助来选择合适的标签**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T22:07:48.733

我建议创建新实例，除非这样做会导致性能问题。`NSMenuItem`在许多人之间共享一个实例`NSMenu`会使维持对该实例的控制变得更加困难，从而增加了出错的风险。**

# linux - 基于子字符串匹配删除文件

> ID：10192703
> 
> 赞同：1
> 
> 时间：2012-04-17T13:59:04.170
> 
> 标签：linux, unix, unix-timestamp

在文件夹中有文件，例如 A_17APR2012.csv 。我的要求是删除除今天的时间戳以外的所有文件

我尝试这样做以列出所有**没有**今天日期时间戳的文件

```
#!/bin/ksh

DATE=`date +"%d%h%Y"`
DIR=/data/rfs/
FOLDER=Test
FILE=$DIR$FOLDER

UDATE="$(echo $DATE | tr '[a-z]' '[A-Z]')"

ls $FILE | grep -v "${UDATE}"

exit 0 
```

这是列出所有没有今天日期时间戳的文件。现在我必须删除列出的文件。请帮助我如何删除文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T17:31:35.817

这是另一种选择：

```
find folder -type f -not -name '*'$(date +"%d%h%Y")'*' -delete 
```

其中“文件夹”是包含要删除的文件的目录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T14:10:04.057

你有一些小错误。在 ls 行中，它应该通过 UPDATE 而不是 UPADTE。此外，可能 UPPDATE 行应该带有 UPDATE 和 ``（反引号）。修复后的脚本是：

```
#!/bin/ksh 

DATE=`date +"%d%h%Y"`
DIR=.
FOLDER=
FILE=$DIR$FOLDER

UPDATE=`echo $DATE | tr [a-z] [A-Z]`

ls -1 $FILE | grep -v "$UPDATE"

exit 0 
```

请注意，我还在 ls 中添加了“-1”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T05:52:04.427

错误是：

```
UPPDATE= echo $DATE | tr [a-z] [A-Z] 
```

您需要将其更改为：

```
UPPDATE="$(echo $DATE | tr '[a-z]' '[A-Z]')" 
```

完美运行

```
pearl.388> cat temp2.sh
#!/bin/ksh

DATE=`date +"%d%h%Y"`
DIR=data/
FOLDER=Test
FILE=$DIR$FOLDER

UPPDATE="$(echo $DATE | tr '[a-z]' '[A-Z]')"

ls -1 $FILE | grep -v "^${UPPDATE}"

exit 0
pearl.389> 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-04-17T14:16:21.820

我想你会想使用 find 命令，它有可以为你检查时间戳的选项，即

```
rm `find /data -ctime +1` 
```

这将删除 /data 中状态在 24 小时或更长时间前更改的所有罚款

有很多方法可以使用 find 检查时间戳。

# iphone - 什么是用于地址簿滚动的控件

> ID：10192711
> 
> 赞同：1
> 
> 时间：2012-04-17T13:59:33.900
> 
> 标签：iphone, xcode, ipad, controls

你能说出截图中右边滚动项的名称和来源吗？在这个示例中，它从“A”到“Z”，用户可以通过在右边的字符项上点击来选择想要的名称。

![在此处输入图像描述](../Images/4e03a6f881e6eb6d05548e1f29ad09b3.png)

# javascript - CSS 选择器性能，DOM 解析

> ID：10192712
> 
> 赞同：6
> 
> 时间：2012-04-17T13:59:35.190
> 
> 标签：javascript, jquery, dom, jquery-selectors

我的问题与触发 DOM 解析有关，我想知道为什么使用 CSS ID 选择器比使用类选择器更快。什么时候必须再次解析 DOM 树，我应该使用什么技巧和性能增强......另外，有人告诉我，如果我做类似的事情

```
var $p = $("p");  
$p.css("color", "blue"); 
$p.text("Text changed!"); 
```

代替

```
$("p").css("color", "blue");  
$("p").text("Text changed!"); 
```

提高性能，是否适用于所有浏览器？另外，我如何知道我的 DOM 树是否已被重新解析？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-17T14:06:12.593

好吧，`#id`选择器比类选择器更快，因为：（a）只能有一个具有给定 id 值的元素；(b) 浏览器可以保存一个地图`id -> element`，因此`#id`选择器可以像单个地图查找一样快速工作。

接下来，上面建议的第一个选项肯定更快，因为它避免了第二次查找，从而将基于选择器的总查找时间减少了 2 倍。

最后，您可以使用 Chrome 开发人员工具的**Selector Profiler**（在“**配置文件”**面板中）来分析浏览器处理页面中的选择器所花费的时间（匹配 + 将样式应用于匹配元素。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T14:07:37.207

我鼓励您在有疑问时进行自己的性能测试。您可以在此处获取有关如何执行此操作的更多信息：[您如何对 JavaScript 代码进行性能测试？](https://stackoverflow.com/questions/111368/how-do-you-performance-test-javascript-code). 一旦您自己测试了性能，您将永远不会忘记结果。

特别是，在`$()`给定的 jquery 选择器上执行函数必须获得匹配的 DOM 节点。我不确定这是如何工作的，但我猜它是`document.getElementById()`,`document.getElementsByTagName()`和其他的组合。这有一个处理成本，不管它有多小，如果你只调用一次然后重用它，你可以节省一些处理时间。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T14:08:07.130

ID 选择器比类选择器快，因为只有一个元素具有 ID，但许多元素可以共享一个类，并且必须对其进行搜索。

下面的代码不必要地解析 DOM 两次，所以它当然会更慢：

```
$("p").css("color", "blue");  
$("p").text("Text changed!"); 
```

# java - 无法弄清楚如何将回溯合并到我的伪递归方法中

> ID：10192715
> 
> 赞同：0
> 
> 时间：2012-04-17T13:59:44.173
> 
> 标签：java, recursion, backtracking

这是一个数独求解器，每个方块都有这个方法。我的想法是，如果此方法的一个实例通过循环而没有找到任何有效值，它将返回到调用它的上一个方法并继续循环 - 尝试来自 for 循环的下一个值。我希望这足以回溯，但我所有的测试都失败了，我完全不知道如何解决这个问题。/end noob-lament

```
public boolean recursive() {

    for(int i = 1; i <= boardSize; i++) {

        if(!validValue(i)) {
            continue;
        } else {
            setValue(i);

            if(getNext() == null) // This signifies that I am at the end of the list
                return true;
            else 
                getNext().recursive(); // same method in the next sudoku square
        }
    }

    return false;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T14:07:17.137

这里有两个正确性问题：

1.  您应该检查递归调用的结果是否是`true`- 如果是，您应该停止递归 - 您找到了解决方案，不要覆盖它！
2.  你应该冒泡递归的返回值，特别是 - 如果`getNext().recursive();`收益率`true`- 你应该把它冒泡`true`[并且如（1）中所说 - 停止递归，你有一个解决方案！]

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-21T21:20:42.400

好的 - 因此，由于我的一位同行帮助我解决了这个问题并设法让我了解缺少什么，我想我想在这里分享它，以防有人有兴趣知道缺少什么。

循环完成后，该方法需要重置其值。如果不是，在回溯之前之前测试过的旧值将在回溯之后保留。这意味着当 isValid() 方法检查给定方块所属的列、行和框时，isValid() 方法会找到许多先前设置的值。

所需要的只是在“return false”之前的一行；

```
//(end of for-loop)  
setValue(0);  
return false;  
//(method ends) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T14:09:36.933

你调用 getNext() 两次。如果它在 if 语句中没有返回 null，则再次调用它。你确定要这样做吗？

# yii - Yii AccessRules 将参数传递给表达式中的回调函数

> ID：10192720
> 
> 赞同：2
> 
> 时间：2012-04-17T13:59:53.813
> 
> 标签：yii, yii-components

我正在开发基于 YII 模块的应用程序

需要限制用户的某些操作以及整个模块

我能够限制用户`'expression' + callback`在规则中使用，但现在我想对两个不同的操作使用相同的回调函数，即我有一个回调函数，我想获取参数值并根据它评估要执行的操作，这里是我已经做了什么

```
public function accessRules()
    {
        return array(
            array('allow',  // allow all users to perform 'index' and 'view' actions
                'actions'=>array('index'),
                'users'=>array('*'),
                'expression'=>array($this, "checkAccessRule"),
            ),
            array('allow',  // allow all users to perform 'index' and 'view' actions
                'actions'=>array('login'),
                'users'=>array('?'),
            ),
            array('allow', // allow authenticated user to perform 'create' and 'update' actions
                'actions'=>array('view','create','update','admin','delete'),
                'users'=>array('@'),
                'expression'=>array($this, "checkAccessRule"), 
            ),
            array('deny',  // deny all users
                'users'=>array('*'),

            ),
        );
    } 
```

回调函数

```
function checkAccessRule($op){ 
        if($op == 1){
            if(in_array($this->module->getName(), Yii::app()->user->getState("companyModules")))
                return true;
            return false;
        }elseif($op == 2){
            if((Yii::app()->user->getState("user_role") == 1) && (in_array($this->module->getName(), Yii::app()->user->getState("companyModules"))))
                return true;
            return false;
        }
    } 
```

如果我发送它，则无法从回调中获取此“$ op”`'expression'=>array($this, "checkAccessRule(1)"),`

任何帮助，将不胜感激

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T14:27:58.730

这是行不通的，当您声明函数名称时，它将通过 Yii 作为字符串调用，因此`(1)`将作为函数名称的一部分。幸运的是，表达式参数也接受匿名函数 ( `function(){}`)。所以：

```
public function accessRules()
{
    return array(
        array('allow',  // allow all users to perform 'index' and 'view' actions
            'actions'=>array('index'),
            'users'=>array('*'),
            'expression'=>function(){$this->checkAccessRule(1)},
        ),
        array('allow',  // allow all users to perform 'index' and 'view' actions
            'actions'=>array('login'),
            'users'=>array('?'),
        ),
        array('allow', // allow authenticated user to perform 'create' and 'update' actions
            'actions'=>array('view','create','update','admin','delete'),
            'users'=>array('@'),
            'expression'=>function(){$this->checkAccessRule(1)},, 
        ),
        array('deny',  // deny all users
            'users'=>array('*'),

        ),
    );
} 
```

应该管用。

# actionscript-3 - 按箭头滚动磁贴列表，没有任何滚动条可见

> ID：10192726
> 
> 赞同：0
> 
> 时间：2012-04-17T14:00:22.970
> 
> 标签：actionscript-3, scrollbar

如果可以在不显示滚动条的情况下滚动 tileList 并单击向右或向左箭头，我想这样做

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T09:23:35.143

是的，有可能：

```
var tileList:TileList = addChild(new TileList()) as TileList;
tileList.setSize(500,50);
tileList.dataProvider = dp;//assumes there's already a DataProvider instance ready

tileList.scrollPolicy = ScrollPolicy.OFF;//' without showing the scroll bars'
stage.addEventListener(KeyboardEvent.KEY_DOWN, onKeyPressed);// right or left arrow
function onKeyPressed(event:KeyboardEvent):void{
    if(event.keyCode == Keyboard.LEFT)  tileList.horizontalScrollPosition -=10;
    if(event.keyCode == Keyboard.RIGHT) tileList.horizontalScrollPosition +=10;
} 
```

您可以使用自己的箭头剪辑和鼠标事件来代替键盘，但逻辑是相同的。请注意，我的示例中的 tileList 是 500x50，因此，horizo​​ntalScrollPosition，使用verticalScrollPosition 作为垂直纵横比。此外，当前滚动大小为 10，但它可能取决于每个渲染单元的大小/速度等。

另一种选择是使用[scrollToIndex()](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/fl/controls/SelectableList.html#scrollToIndex%28%29)方法：

```
var tileList:TileList = addChild(new TileList()) as TileList;
tileList.setSize(500,50);
tileList.dataProvider = dp;
var index:int = 0;//scroll index
var total:int = tileList.dataProvider.length;

tileList.scrollPolicy = ScrollPolicy.OFF;
stage.addEventListener(KeyboardEvent.KEY_DOWN, onKeyPressed);
function onKeyPressed(event:KeyboardEvent):void{
    if(event.keyCode == Keyboard.LEFT)  index--;
    if(event.keyCode == Keyboard.RIGHT) index++;
    if(index < 0    ) index = total-1;//loop to last
    if(index > total) index = 0;//loop to first
    tileList.scrollToIndex(si);
    trace('scroll index:',si);
} 
```

此外，您可能会从[Yahoo!找到](http://developer.yahoo.com/flash/astra-flash/)[Carousel 组件。](http://developer.yahoo.com/flash/astra-flash/carousel/)[Astra 组件设置](http://developer.yahoo.com/flash/astra-flash/)很有用，因为它听起来像您的描述，并且它与 Flash 的 V3 组件兼容（例如，使用相同的数据提供程序（`fl.data.DataProvider`）等）：

![雅虎！ Flash 轮播组件](../Images/e75f086fb76055790b84fc12b3e86fc5.png)

这是他们的示例片段：

```
var carouselData:Array =  
[  
    { label: "Ayers Rock", source: "uluru.jpg" },  
    { label: "Kata Tjuta", source: "katatjuta.jpg" },  
    { label: "Moraine", source: "morraine.jpg" },  
    { label: "Museum", source: "museum.jpg" },  
    { label: "Japan", source: "japan.jpg" },  
    { label: "YUI", source: "yui.jpg" }  
];  

var carousel:Carousel = new Carousel();  

carousel.dataProvider = new DataProvider( carouselData );  
carousel.labelField = "label";  
carousel.sourceField = "source";  

carousel.move( 54, 45 );  
carousel.setSize( 302, 102 );  
this.addChild( carousel ); 
```

# r - 从数据创建 graphNEL 对象

> ID：10192728
> 
> 赞同：1
> 
> 时间：2012-04-17T14:00:27.717
> 
> 标签：r, graph

我有一个名称向量和一个距离表

节点：

```
>V
SERPINA3
ABAT18
ABL1
ACADM 
```

边缘：

```
>distances
SERPINA3    1   179 713 627 1937    5984    747 1450    681 718 749 1124    1839    1617    1639    2017    3619    5985    5986                                                   
ABL1    3   175 12  77  81  179 144 174 208 213 223 270 274 282 305 331 348 459 532 517 785 710 889 5988    972 1120    1064    1592    1322    1324    1331    1373    1526    1566    1717    1718    1802    1847    1947
ABAT18  2 5987                                               
ACADM   4   5998 
```

从这两个文件中，我想使用以下命令创建一个 graphNEL 对象：

```
gR <- new("graphNEL", nodes=V, edgeL=edL1) 
```

有没有人知道如何做到这一点。我不知何故无法将距离列表放入列表列表中以适合 edgL 模型。

运行此命令后：

```
edL1 <- vector("list", length=ncol(Dist1))
names(edL1) <- V
for(i in 1:ncol(Dist1))
 edL1[[i]] <- list(edges=Dist1[,i], weights=sqrt(i))
gR <- new("graphNEL", nodes=V, edgeL=edL1) 
```

我不断收到此错误：

> 边缘中的 NA 元素。
> 
> 该图是无向的，并且以下边没有往复：NA|SERPINA3、NA|ABAT18、NA|ABL1、NA|ACADM
> 
> validObject(.Object) 中的错误：无效类“graphNEL”对象：FALSE

但是数据中没有NA。有人有想法吗？

谢谢阿萨

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T20:38:19.730

我在尝试制作 graphNEL 对象时遇到了类似的错误。我的问题是边列表的元素应该是节点的索引 - 所以一个示例 edgeL 可能看起来像

```
$SERPINA3
$SERPINA3$edges
[1] 1, 2, 4 
```

与人们最初可能期望的相比（以下内容*不正确*）：

```
$SERPINA3
$SERPINA3$edges
[1] 'SERPINA3', 'ABL1', 'ACADM' 
```

我不太明白 edgeL 元素如何映射到您在 V 中创建的节点（即，数字 1、2、3、4 或 179、175、5987、5998 与 V 的元素有何关系？）所以我无法提供特定于您的数据的答案，但使用索引而不是节点名称解决了我的问题。

编辑：

我遇到了您描述的确切问题，并找到了一个提供有用建议的[链接。](https://stat.ethz.ch/pipermail/bioconductor/2007-February/015989.html)首先创建一个有向图并使用 ugraph 函数来检索由您的有向图表示的“基础”无向图。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-22T11:27:47.267

我自己为此挣扎了一段时间。[文档](http://www.bioconductor.org/packages/release/bioc/manuals/graph/man/graph.pdf)不是很清楚。[最后，我在Rgraphviz 包](http://mae.ucdavis.edu/dsouza/Lectures/Rgraphviz.pdf)的文档中找到了答案。

您可以在不分配边的情况下初始化图形：

```
gR = new("graphNEL", nodes = V, edgemode = "directed") 
```

然后，您可以使用以下方法一一添加边：

```
gR = addEdge("SERPINA3", "ABAT18", gR, 5987) 
```

我确定这不是要走*的*路，但我的图表边缘很少，所以我停止寻找更好的选择。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-08-03T12:47:40.030

您需要定义一个捕获所有边的矩阵。举个例子：

```
From <- c("A","A","C","C")

To <- c("B","C","B","D")

L <- cbind(From,To)

mygraphNEL <- ftM2adjM(L, edgemode="directed") 
```

更多细节[在这里](http://www.math.ku.dk/~richard/courses/bioconductor2007/CDrom/Graphs/graphBasics.pdf)。

# c# - 如何在 Windows 应用程序的浏览器控件中调用 Web 应用程序？

> ID：10192729
> 
> 赞同：1
> 
> 时间：2012-04-17T14:00:30.123
> 
> 标签：c#, winforms, web-applications, webbrowser-control

我已经准备好了一个 Web 应用程序。说**MyWebApp**，我只需要创建另一个包含带有 Web 浏览器控件的表单的 Windows 应用程序。

我需要将此 Web 应用程序调用到该 Web 浏览器控件中。这个怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T14:03:32.500

只需将浏览器控件的 URL 设置为托管 Web 应用程序的 URL。

[http://msdn.microsoft.com/en-us/library/system.windows.forms.webbrowser.url.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.webbrowser.url.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T14:04:13.290

你能告诉我你想用什么语言创建寡妇应用程序吗？

如果你想在 C# 中：

```
private void Navigate(String address)
{
    if (String.IsNullOrEmpty(address)) return;
    if (address.Equals("about:blank")) return;
    if (!address.StartsWith("http://") &&
        !address.StartsWith("https://"))
    {
        address = "http://" + address;
    }
    try
    {
        webBrowser1.Navigate(new Uri(address));
    }
    catch (System.UriFormatException)
    {
        return;
    }
} 
```

要实现这一点： 1- 创建一个 web 控件并将其放在 windows 窗体中（在本例中称为 webBrowser1）。2-使用您要访问的网站的地址调用导航方法。

# apache - 服务器端包括 - 使用

> ID：10192730
> 
> 赞同：0
> 
> 时间：2012-04-17T14:00:31.457
> 
> 标签：apache, .htaccess, include, ssi

我正在构建一些 html 模板，工作必须在 2 人之间共享，我想创建一些公共区域并将它们包含在文件中，但其他用户没有安装 php。

我创建了一个 .shtml 并使用

*   人们还在使用 ssi 包括吗？

*   我可以将扩展名设为 .html 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T00:28:27.283

SSI 仍然用于[简单的应用程序](http://www.w3.org/Jigsaw/Doc/User/SSI.html)。使用以下内容添加`.html`为 SSI 的文件类型：

```
AddHandler server-parsed .html 
```

**参考**

*   [mod_include.c](http://www.askapache.com/servers/mod_include.c.html)
*   [扩展 Apache](http://www.fmc-modeling.org/category/projects/apache/amp/3_3Extending_Apache.html)
*   [阿帕奇模块](http://www.softpanorama.org/WWW/Webservers/Apache/modules.shtml)
*   [阿帕奇安全](http://www.softpanorama.org/WWW/Webservers/Apache/apache_security.shtml)
*   [使用服务器端包含](http://apacheweek.com/features/ssi)

# ipad - 是否可以在 iPad 上设置 UITableView 或单元格的宽度

> ID：10192746
> 
> 赞同：1
> 
> 时间：2012-04-17T14:01:28.080
> 
> 标签：ipad, uitableview, width

由于不可能“抓住”[这一点](https://stackoverflow.com/questions/2410494/change-width-of-uitableviewcontroller-on-iphone)并得到答案，而且没有一个答案能做到，我想我会问是否有人成功地做到了，如果成功了，如何做到的。

我创建了一个新文件，选择了带有 XIB 的子类 UITableViewController，一切正常。我可以设置所有东西的高度（使用委托方法），但不能设置任何东西的框架。

现在表格和 iPad 一样宽，每个单元格中的短标题看起来有点陈旧——IB 中没有任何东西可以改变拉伸或布局。

我会对任何导致单元格水平收缩的解决方案感到满意——比如边距。我在 IB 中尝试了滚动视图插图，但它们只会增加滚动视图的大小，因此它会比屏幕大。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T14:54:37.373

我认为您想继承 UViewController 并向其添加 UITableView，并使其成为您在 IB 中想要的大小。

# android - Android ACRA 表单键？

> ID：10192753
> 
> 赞同：2
> 
> 时间：2012-04-17T14:01:53.687
> 
> 标签：android

我刚刚开始使用 ACRA 来构建这个概念，它将捕获崩溃错误。我希望它通过电子邮件发送。

我正在关注这个.... [http://code.google.com/p/acra/wiki/AdvancedUsage#Sending_reports_for_caught_exceptions_or_for_unexpected_applic](http://code.google.com/p/acra/wiki/AdvancedUsage#Sending_reports_for_caught_exceptions_or_for_unexpected_applicat)

那么什么是表单键？我应该在哪里得到它？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T14:21:37.587

ACRA 可以使用几种不同的方法提供崩溃报告。其中一种方法是发布到谷歌文档表单。表单键是谷歌文档表单键。

使用电子邮件方法，表单键不相关。它仅用于 google docs form 方法。

附带说明一下，google docs 方法是最简单易用的。除非有理由需要通过电子邮件交付，否则请使用谷歌文档。您甚至可以配置表单，以便在表单更新时收到电子邮件 - 两全其美。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T14:22:52.110

请阅读 ACRA wiki [BasicSetup](http://code.google.com/p/acra/wiki/BasicSetup#Setting-up_your_project)。

简而言之，您必须将`CrashReports-template.csv`文件从 ACRA 复制到 Google Docs 并从中创建一个表单。然后，Google Docs 将为表单创建一个 formKey，您可以在表单创建页面底部的链接中找到它。

**编辑：** Jeffrey Blattman 的回答更相关，如果通过电子邮件发送崩溃报告，则不需要 formKey。

# iphone - 有没有办法通过重用视图的 UIScrollView 上的核心动画来更改内容偏移？

> ID：10192754
> 
> 赞同：0
> 
> 时间：2012-04-17T14:01:57.400
> 
> 标签：iphone, ios, cocoa-touch, uiscrollview, core-animation

编辑：我取得了一些进展，所以我简化并缩小了问题：[我创建了新问题，我希望它更清晰，更容易理解](https://stackoverflow.com/questions/10209849/how-to-call-scrollviewdidscroll-the-same-way-uiscrollview-does-but-during-cust)

* * *

我有非常大的水平滚动 UIScrollView，它正在重用它的子视图。当用户向左滚动时，最右边的视图移动到最左边的位置并更新其内容。同样，当用户向右滚动时，最左边的视图会移动到最右边的位置并更新其内容。与 UITableView 类似。使用 scrollviewDidScroll: 委托方法可以很好地工作。

现在我需要以编程方式更改偏移量，但要使用自定义动画行为（惯性和弹回最终位置）。

为了对此进行原型制作，我使用

```
[UIView animateWithDuration:contentOffsetCADuration 
                      delay:0 
                    options:UIViewAnimationOptionCurveLinear
                 animations:^{
                      [self setContentOffsetNoDelegateCalls:contentOffset animated:NO];
                 }
                 completion:^(BOOL finish){
                      dispatch_async(dispatch_get_main_queue(), ^{
                          [timer invalidate];
                      });
                 }]; 
```

我使用禁用的委托回调对内容偏移进行动画处理，以便在动画期间不会弄乱视图。但我需要一些东西来同时重用和重新定位它们。

我的解决方案是创建计时器并`scrollViewDidScroll:`手动调用，以便像往常一样重用，与动画并行。但它根本不起作用 - 没有任何东西被重用，并且动画之后的滚动视图的内容与动画之前的状态相同 -> 以前可见的页面被移出屏幕。

**所以问题缩小了如何在动画期间移动子视图和更新它们的内容？**

或者也许有完全不同的方式来做到这一点......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T13:07:19.587

[在这里](https://stackoverflow.com/a/10209929/796103)检查我的答案。

**编辑：**大声笑，刚刚注意到它是同一作者

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-17T14:09:22.617

您可以尝试在方法中更改滚动偏移量，然后您可以从中调用它

```
 [self performSelector:<#(SEL)#> withObject:<#(id)#> afterDelay:<#(NSTimeInterval)#>]; 
```

然后让它在达到特定值时停止

# python - 如何获取 Python 编译时使用的选项列表？

> ID：10192758
> 
> 赞同：77
> 
> 时间：2012-04-17T14:02:05.620
> 
> 标签：python, compilation, packages

您可以通过各种方式编译 Python。我想知道我的 Python 是用哪些选项编译的。

具体用例：我的 Python 是用 readline 编译的吗？我知道我可以通过“import readline”看到这一点，但我想查看我的 Python 二进制文件的编译设置列表。

编辑：我的意思是 Python 可执行文件，而**不是**我自己编写的源代码。

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2012-04-17T14:07:27.917

有一个模块可以查看系统配置

```
import sysconfig
print(sysconfig.get_config_vars()) 
```

它还提供了一个接口来获取单个变量。

```
sysconfig.get_config_var('HAVE_LIBREADLINE') 
```

它也可以通过 shell 访问：

```
python3 -m sysconfig | less 
```

编辑：

在python2.7之前，你必须使用

```
import distutils.sysconfig
print distutils.sysconfig.get_config_vars() 
```

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2014-04-22T22:39:17.830

要建立在 mirk 的答案上，要找到在构建过程中实际使用的配置标志，您要查找的值是`CONFIG_ARGS`.

例如，这是 Ubuntu 编译的 Python 的输出：

```
>>> print distutils.sysconfig.get_config_var('CONFIG_ARGS')
'--enable-shared' '--prefix=/usr' '--enable-ipv6'
'--enable-unicode=ucs4' '--with-dbmliborder=bdb:gdbm'
'--with-system-expat' '--with-system-ffi' '--with-fpe ctl'
'CC=x86_64-linux-gnu-gcc' 'CFLAGS=-D_FORTIFY_SOURCE=2 -g
-fstack-protector --param=ssp-buffer-size=4 -Wformat
-Werror=format-security ' 'LDFLAGS=-Wl,-Bs ymbolic-functions
-Wl,-z,relro' 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2014-07-30T21:43:09.387

还有另一种方法...... Python为每个安装的版本提供脚本......

```
 ls -l /usr/bin/python*config*
    16 Dec 21  2013 /usr/bin/python-config     -> python2.7-config
    16 Dec 21  2013 /usr/bin/python2-config    -> python2.7-config
    33 Mar 22 18:57 /usr/bin/python2.7-config  -> x86_64-linux-gnu-python2.7-config
    16 Mar 23 03:17 /usr/bin/python3-config    -> python3.4-config
    33 Apr 11 09:15 /usr/bin/python3.4-config  -> x86_64-linux-gnu-python3.4-config
    34 Apr 11 09:15 /usr/bin/python3.4m-config -> x86_64-linux-gnu-python3.4m-config
    17 Mar 23 03:17 /usr/bin/python3m-config   -> python3.4m-config

  python3-config --help
  Usage: /usr/bin/python3-config --prefix|--exec-prefix|--includes|--libs|--cflags|--ldflags|--extension-suffix|--help|--abiflags|--configdir

  python3-config --prefix
  /usr 
```

我的一个系统的答案是：

```
--prefix           /usr
--exec-prefix      /usr
--includes         -I/usr/include/python3.4m -I/usr/include/python3.4m
--libs             -lpthread -ldl  -lutil -lm  -lpython3.4m
--cflags           -I/usr/include/python3.4m -I/usr/include/python3.4m  -Wno-unused-result -Werror=declaration-after-statement -g -fstack-protector --param=ssp-buffer-size=4 -Wformat -Werror=format-security  -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes
--ldflags          -L/usr/lib/python3.4/config-3.4m-x86_64-linux-gnu -L/usr/lib -lpthread -ldl  -lutil -lm  -lpython3.4m -Xlinker -export-dynamic -Wl,-O1 -Wl,-Bsymbolic-functions
--extension-suffix @SO@
--abiflags         m
--configdir        /usr/lib/python3.4/config-3.4m-x86_64-linux-gnu 
```

因此，如果您需要为 bash 脚本等设置值，可以通过此命令行实用程序获得这些值。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2018-09-01T01:17:34.120

这是我用来比较不同 python 配置的命令。它包括获取输出的值：

```
$ python3.6 -c "import sysconfig;print('{}'.format('\n'.join(['{} = {}'.format(v, sysconfig.get_config_var(v)) for v in sorted(sysconfig.get_config_vars(), key=lambda s: s.lower())])))" > /tmp/python36.conf

$ python2.7 -c "import sysconfig;print('{}'.format('\n'.join(['{} = {}'.format(v, sysconfig.get_config_var(v)) for v in sorted(sysconfig.get_config_vars(), key=lambda s: s.lower())])))" > /tmp/python27.conf

$ sdiff /tmp/python36.conf /tmp/python27.conf

$ # This is my own version of colorized side-by-side diff from
$ # https://github.com/jlinoff/csdiff
$ csdiff /tmp/python36.conf /tmp/python27.conf 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2017-04-24T11:41:17.163

（这个仅供参考）

[顺便说一句，要获取编译PyPy](https://www.google.com.hk/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&uact=8&ved=0ahUKEwim1b71gL3TAhVkzlQKHTAuCYsQFggjMAA&url=https%3A%2F%2Fpypy.org%2F&usg=AFQjCNGME7DlfTEy1hYVp9SB5D3Gtiyatg)的选项列表，请运行

```
pypy --info 
```

# html - HAML 和 Ruby 循环和 UL 不工作

> ID：10192764
> 
> 赞同：3
> 
> 时间：2012-04-17T14:02:34.990
> 
> 标签：html, ruby, haml

我试图让这个简单的列表正常工作，但是 ul 正在关闭而不是在循环中包含 li 元素。我错过了一种简单的方法吗？

```
 %ul.nav.nav-tabs.nav-stacked
   - @courses.each do |c|
   %li
    = link_to "add", { :controller => "admin/relateds", :action => "edit", :id => c.id }, :confirm => "Are you sure?"
    = c.coursetitle 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T14:04:55.100

需要缩进，`%li`因为它在一个`do`块内。即使它是[有效的标记](http://haml.info/docs/yardoc/#indentation)，如果您选择使用 2 或 4 个空格进行缩进以获得更好的易读性，它也将节省您的调试时间，因为很难辨别。

```
%ul.nav.nav-tabs.nav-stacked
  - @courses.each do |c|
    %li
      = link_to "add", { :controller => "admin/relateds", :action => "edit", :id => c.id }, :confirm => "Are you sure?"
      = c.coursetitle 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T14:04:50.597

你需要缩进 %li 和里面应该有什么。目前你的循环什么都不做。

# deployment - 使用 TeamCity 进行持续部署

> ID：10192776
> 
> 赞同：16
> 
> 时间：2012-04-17T14:04:09.987
> 
> 标签：deployment, teamcity, continuous-deployment

我最近在 TeamCity 中设置了一个 CI 服务器，现在想把它带到下一步，持续部署。基本上，我们为每个客户提供一套宁静的服务和大约 3 个 Web 应用程序。所有客户都获得 3 个环境 QA、UAT 和 Prod。一旦我们的测试通过，我们希望能够自动部署我们的构建。我不是在寻找自定义脚本选项来执行此操作。我见过很多这样的。我们正在寻找的是像 UDeploy 这样的解决方案，但价格更低。有人知道 UDeploy 的替代品吗？或者其他与 TeamCity 一起使用的持续部署插件？

谢谢，

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-10-18T20:49:41.917

我同意@Niklas Ringdahl 的观点——我认为你想错了。

**[您可以使用MS WebDeploy](http://www.iis.net/downloads/microsoft/web-deploy)直接从 TeamCity 进行部署。**

请参阅 Troy Hunt 的优秀博客系列：

[第 1 部分：配置转换](http://www.troyhunt.com/2010/11/you-deploying-it-wrong-teamcity.html)

[第 2 部分：MS 构建和可部署包](http://www.troyhunt.com/2010/11/you-deploying-it-wrong-teamcity_11.html)

[第 3 部分：使用 WebDeploy 发布](http://www.troyhunt.com/2010/11/you-deploying-it-wrong-teamcity_24.html)

[第 4 部分：使用 TeamCity 进行持续构建](http://www.troyhunt.com/2010/11/you-deploying-it-wrong-teamcity_25.html)

[第 5 部分：使用 TeamCity 进行 Web 部署](http://www.troyhunt.com/2010/11/you-deploying-it-wrong-teamcity_26.html)

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-04-17T23:33:20.737

如果这是 .net，您应该查看 Octopus，它现在可以很好地与 TeamCity 配合使用。

[http://www.octopusdeploy.com/](http://www.octopusdeploy.com/)

[http://www.paulstovell.com/octopus/octopus-octopack-and-teamcity](http://www.paulstovell.com/octopus/octopus-octopack-and-teamcity)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-20T14:04:47.847

我不知道这是否有任何我不明白的部分，但我也会使用 TeamCity。

如果您有一个构建配置来管理您的测试，您可以轻松地为部署创建配置，这些配置由测试配置的成功触发。我们以这种方式处理许多部署。

再次，对不起，如果我在这里遗漏了什么......

**编辑**：

成功构建另一个配置时，可以触发 TeamCity 中的构建配置： [JetBrains 文档中的构建触发](http://confluence.jetbrains.net/display/TCD65/Configuring+Build+Triggers)（查看“完成构建触发器”）

或者您可以使用具有许多“构建步骤”的构建配置： [JetBrains 文档中的构建步骤](http://confluence.jetbrains.net/display/TCD65/Configuring+Build+Steps)

每个步骤都按顺序运行，并且仅在上一步成功的情况下运行。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-09-20T16:18:53.803

另一种选择：RedGate 最近更新了其部署管理器工具的定价：[http ://www.red-gate.com/delivery/deployment-manager/](http://www.red-gate.com/delivery/deployment-manager/)

如果您有 5 个或更少的项目，则该工具似乎是免费的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-18T17:49:43.290

我尽快熟悉 Nolio，但对其定价一无所知： [http ://www.noliosoft.com/product/nolio-automation-center](http://www.noliosoft.com/product/nolio-automation-center)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-01-07T15:22:24.707

作为该产品的开发人员，我将在此处将[BuildMaster](http://inedo.com/buildmaster)添加到选项列表中。基本上，您可以运行一个基本教程以开始从 TeamCity ( [http://inedo.com/buildmaster/extensions/teamcity](http://inedo.com/buildmaster/extensions/teamcity) ) 进行部署，然后根据需要自定义您的部署计划以适应任何其他环境。

# java - 忽略 Tomcat 中特定 URI 的 cookie

> ID：10192778
> 
> 赞同：3
> 
> 时间：2012-04-17T14:04:13.013
> 
> 标签：java, tomcat, servlets, cookies, jsessionid

我们有以下情况：

JSESSIONID 是通过 cookie 和 URL 发送的，但是由于 Adob​​e Flash BUG，它们是不同的（实际上，cookie JSESSIONID 是错误的）。

我们想要做的是使用 URL JSESSIONID 而不是在 cookie 中发送的那个。换句话说，当我执行 request.getSession() 时，它应该返回与 URL 中的 ID 关联的 HttpSession，而不是 cookie 中的。

我们查看了 Tomcat7 源代码，事实上，Tomcat 首先解析 URL，搜索标识符。然后，如果它们存在，它会用 cookie SESSIONID 覆盖它。这是 CoyoteAdapter.java (tomcat 7.0.26) 中截取的代码：

```
 String sessionID = null;
        if (request.getServletContext().getEffectiveSessionTrackingModes()
                .contains(SessionTrackingMode.URL)) {

            // Get the session ID if there was one
            sessionID = request.getPathParameter(
                    SessionConfig.getSessionUriParamName(
                            request.getContext()));
            if (sessionID != null) {
                request.setRequestedSessionId(sessionID);
                request.setRequestedSessionURL(true);
            }
        }

        // Look for session ID in cookies and SSL session
        parseSessionCookiesId(req, request);
        parseSessionSslId(request); 
```

我们可以完全禁用 cookie JSESSIONID，但我们不能，因为我们将它用于网站中的所有 URL。我们想为这个特定的 URL 禁用 cookie。

可能吗？有没有其他想法或解决方法来解决这个问题？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-04-17T14:36:23.940

您可以实现一个自定义[servlet 过滤器](http://docs.oracle.com/javaee/6/api/javax/servlet/Filter.html)，用您自己的包装器替换请求、响应和会话对象。然后，包装器可以根据 URL 采取不同的行为，例如委托或不委托给原始会话实例。尽管您将无法访问其他 id 的会话数据，但不更改 Tomcat 代码。

# c# - 从网站调用本地应用程序并传递一些参数

> ID：10192781
> 
> 赞同：-1
> 
> 时间：2012-04-17T14:04:31.783
> 
> 标签：c#, javascript, web-services

我有一个网站需要在访问者的本地计算机上执行一个小应用程序（他们有 Windows 7）。我将在他们的计算机上安装此应用程序。

网站调用此应用程序后，需要将一些参数（如姓名、电话...）传递给应用程序以打印它们。

我找到的解决方案是使用 Internet Explorer 和 ActiveXObject。Name, number ... 将作为参数传递。

但我不确定用户是否来自中国并通过 ActiveXObject 在汉字网站上写下他/她的名字是否能够将其作为参数发送到应用程序。

此解决方案还阻止我使用谷歌浏览器或其他浏览器。我发现我可以用 Mozilla FF 做同样的事情，但不确定我是否可以在谷歌 Chrome 中做同样的事情（网站用户体验更好）。

我已经阅读了关于谷歌浏览器的 NPAP，但我认为应用程序必须用 C 或 C++ 编写，我的是用 C# 编写的。¿ 有人可以确认吗？

所以我有兴趣将外来字符传递给这个应用程序以及在谷歌浏览器中实现它的方法。可以调用应用程序（将信息作为参数传递）或使用 Web 服务与该应用程序通信。完成打印后的应用程序必须关闭浏览器并重新启动它（我的网站将被设置为默认页面）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T15:02:05.960

您最好的选择可能是在您的页面上安装和使用带有此协议的链接时，将您的应用程序注册为协议处理程序（想想电子邮件客户端如何服务 mailto: 或 torrent 客户端如何服务磁铁：链接）。由于您同时控制发送方和接收方，因此您可以在其中传递几乎任何信息。[您可以在MSDN](http://msdn.microsoft.com/en-us/library/aa767914%28v=vs.85%29.aspx)找到用于注册句柄的 Windows 示例。如果您需要它用于任何其他系统，我很确定搜索“system_or_gui_name 注册协议处理程序”会首先显示您想要的结果。

# linux - 如何配置 vps 服务器在 linux 上发送电子邮件

> ID：10192785
> 
> 赞同：1
> 
> 时间：2012-04-17T14:04:43.040
> 
> 标签：linux, email, smtp, sendmail, vps

我打算在我的主站点之外租用一个 vps

我想将此 vps 配置为仅发送电子邮件不接收。

说在我的主站点我有一个 smtp 服务器 smtp.xyz.com

我不想将此 smtp 服务器用于新的 vps

如何配置 sendmail/postfix 以从该 vps 发送电子邮件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T14:35:48.697

这取决于您的 Linux 发行版。

在 Debian 上，您可以轻松地将邮件服务器配置为卫星服务器。这意味着服务器可以发送邮件但不能接收邮件。通常你需要一个中继主机。请参阅此处以获取示例： http: [//kurinchilion.com/2009/08/ubuntu-postfix-sendmail.html](http://kurinchilamp.kurinchilion.com/2009/08/ubuntu-postfix-sendmail.html)

如果要直接配置 Postfix，则必须指定中继选项。有关说明，请参见此处：[http ://www.postfix.org/SMTPD_ACCESS_README.html](http://www.postfix.org/SMTPD_ACCESS_README.html)

这个想法是你只为本地主机中继。查看空客户端配置：[http ://www.postfix.org/STANDARD_CONFIGURATION_README.html#null_client](http://www.postfix.org/STANDARD_CONFIGURATION_README.html#null_client)

# jquery - JQuery - Draggable - Resizable 组合麻烦

> ID：10192787
> 
> 赞同：0
> 
> 时间：2012-04-17T14:04:46.887
> 
> 标签：jquery, jquery-ui, user-interface, resizable

```
$(".divField")
            .draggable({ grid: [6, 6] })
            .resizable({ handles: 'se', grid: [6, 6] }) 
```

上面的代码在 Firefox 和 chrome 中完美运行......但在 IE8 中，我遇到了调整大小网格波动的问题，因此它报告是正确的，但明显不同。问题是我的大多数用户都在 IE8 上。

# php - 从 ajax 调用填充警报消息

> ID：10192790
> 
> 赞同：1
> 
> 时间：2012-04-17T14:04:53.497
> 
> 标签：php, jquery, ajax, post

我试图在进行 ajax 调用后填充一个元素，但我不太确定这是否是正确的方法，如果是，我哪里出错了。

这是我的代码...

```
$(document).ready( function() {
    $("#edit_delete").click(function() {
        $.post('mySelect.php', $("#edit_delete").serialize(), function(result) {
            $('#message1').html(<?php echo $myTest; ?>);
            $('#message2').html(<?php echo $myOtherTest; ?>);
        });
    }   
}); 
```

mySelect.php ：

```
<?php include '../../includes/connection.php' ?>
<?php
    $selected_user = $_POST["users"];
    $result = mysql_query("SELECT * FROM users WHERE id = $selected_user");
    $row = mysql_fetch_array($result, MYSQL_ASSOC);
?>
<?php $myTest = $row['id']; ?>
<?php $myOtherTest = $row['name']; ?>
<?php mysql_close($con); ?> 
```

（如果您需要更多信息，请告诉我，请随时编辑我的问题，这样才有意义！）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T14:07:56.257

在您进行 AJAX 调用后，*PHP 脚本的整个输出*将（在您的情况下）放置在回调的“结果”参数中。

这意味着如果您`echo 'Hello!';`在 mySelect.php 中，结果将包含字符串 'Hello!'。

如果你想提醒结果，那么你所要做的就是：`alert(results);`在你的回调中。

正如其他几个人指出的那样，您还可以查看使用[json_encoded](http://php.net/manual/en/function.json-encode.php)数组来帮助您更好地利用从服务器发回的数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T14:08:28.003

不，您应该将数据回显给客户端，然后使用它

```
<?php include '../../includes/connection.php' ?>
<?php
    $selected_user = $_POST["users"];
    $result = mysql_query("SELECT * FROM users WHERE id = $selected_user");
    $row = mysql_fetch_array($result, MYSQL_ASSOC);
//prepare an array to return
$return = array();
$return['id'] = $row['id']; 
$return['name'] = $row['name']; 
//set the header
header('application/json');
//encode it and echo it back
echo json_encode($return); 
```

进而

```
 $.post('mySelect.php', $("#edit_delete").serialize(), function(result) {
        $('#message1').html(result.id);
        $('#message2').html(result.name);
    }); 
```

您这样做是因为您正在对服务器进行异步调用：您无需重新加载页面，您只需进行调用并取回一些数据

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T14:08:34.177

结果的工作方式是发送应用程序的整个输出。所以变量不会按预期工作。

相反，您想要做的是 echo json_encode (javascript object notation )，如下所示：

```
<?php
  echo json_encode(array('myTest' => $row['id'], 'myOtherTest' => $row['name']));
?> 
```

然后你可以通过以下方式调用它：

来自 ajax 回调的 results.myTest

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-17T14:24:31.437

在我看来，您应该避免在 $.post 函数的回调中使用 php。你可以使用 ajax 做所有你想做的事。

Javascript代码：

```
$(document).ready( function() {
    $("#edit_delete").click(function() {
    $.ajax({
            type: "POST",
            url: "mySelect.php",   
            data: 'users='+$("#edit_delete").serialize(),
            success: function(data) {
            var result = $.parseJSON(data);    
                $('#message1').html(result.id);
                $('#message2').html(result.name);
            }
       });          
    }   
}); 
```

PHP代码：

```
<?php 
include '../../includes/connection.php';

$selected_user = $_POST["users"];
$result = mysql_query("SELECT * FROM users WHERE id = $selected_user");
$row = mysql_fetch_array($result, MYSQL_ASSOC);

$return = array(
'id' => $row['id'],
'name' => $row['name']
);

mysql_close($con);

echo json_encode($return);
?> 
```

尽量避免在每一行中打开和关闭 php 标签。一个在 fila 的开头和一个在它的结尾就足够了。

对不起我的英语不好。

祝你好运

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-17T14:09:56.433

你应该看看[jQuery 手册](http://api.jquery.com/jQuery.post/)

有一个使用 JSON 的例子

```
$.post("test.php", { "func": "getNameAndTime" },
 function(data){
   console.log(data.name); // John
   console.log(data.time); //  2pm
 }, "json"); 
```

在您提供的有关 Javascript 变量的代码中，结果将由您回显的任何内容填充。

# java - 问题捷径 JNLP

> ID：10192794
> 
> 赞同：5
> 
> 时间：2012-04-17T14:05:00.033
> 
> 标签：java, jnlp, java-web-start

我对 JNLP 有疑问。

当计算机安装了两个 Java 版本时，64 位和 32 位。计算机默认执行 32 位版本。

捷径是

```
C:\Windows\SysWOW64\javaws.exe -localfile 
    "C:\Users\Micro\AppData\LocalLow\Sun\Java\Deployment\cache\6.0\43\b9706ab-6de97627" 
```

如何通过`C:/Windows/System32/javaws.exe`独立的 Java 版本强制执行快捷方式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T15:15:56.803

> 计算机默认执行 32 位版本。

不完全是。它取决于调用应用程序。

让我们看两个例子：

1.  启动 cmd.exe（使用 WINDOWS+R 并键入 cmd）

2.  运行“java -version”，你会得到

    ```
    java version "1.7.0_03"
    Java(TM) SE Runtime Environment (build 1.7.0_03-b05)
    Java HotSpot(TM) 64-Bit Server VM (build 22.1-b02, mixed mode) 
    ```

3.  通过 32 位程序启动 cmd.exe（例如总指挥官）

4.  运行“java -version”，你会得到

    ```
    java version "1.7.0_03"
    Java(TM) SE Runtime Environment (build 1.7.0_03-b05)
    Java HotSpot(TM) Client VM (build 22.1-b02, mixed mode, sharing) 
    ```

可以尝试直接使用 windows\system32 和 windows\syswow64 中的存根。唯一的变化：

*   您可以使用从 64 位降级到 32 位

    ```
    c:\Windows\Syswow64\java -version 
    ```

我知道从 32 位提升到 64 位的唯一方法是显式使用运行 64 位版本

```
 "c:\Program Files\Java\jre6\bin\java.exe" -version 
```

此逻辑也适用于在 windows\system 中使用包装器的所有其他 java 命令，例如 javaws。

=> 链接到“c:\Program Files\Java\jre6\bin\javaws.exe”

# iphone - 在表格视图中显示地图注释

> ID：10192800
> 
> 赞同：1
> 
> 时间：2012-04-17T14:05:14.387
> 
> 标签：iphone, uitableview, mapkit

我有一个带有一些注释的地图，在另一个视图中，我在地图上显示了一个带有所有注释的表格视图，一切都很好，但是每次我运行我的应用程序时，在表格视图中显示注释的顺序都与以前不同，所以任何人都可以解释我以什么顺序创建表格单元格以及以什么顺序显示它们。

我将整个地图对象发送到我的表格视图以检索地图上的注释，即 [mymap 注释]。

谢谢你帮助我！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T15:51:47.660

尽管有这个名字，但地图视图不是将注释保留为数组，而是出于优化原因保留为 NSSet。由于 NSSet 更难使用，它会在请求注释时发送一个 NSArray，但在内部它不是一个 NSArray。您可能知道，NSSet 是无序的。

要具有相同的顺序，您应该创建一个属性来保存注释数组，而不是依赖 [mymap annotations]。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T14:38:06.840

这个问题与我一周前做的类似[，](https://stackoverflow.com/questions/10056677/set-mkpinannotationcolorred-just-for-the-first-and-last-mkannotation-on-mkmapvie)不是完全相同的问题，但您可以弄清楚如何解决。

# .net - 我想在visual web developer 2010中使用iis 7而不是iis express

> ID：10192801
> 
> 赞同：8
> 
> 时间：2012-04-17T14:05:17.720
> 
> 标签：.net, visual-web-developer

我在设置我的 vwd 2010 环境以在我的本地 iis 7.5 而不是 iis express 下运行时遇到了一些麻烦。

每当我转到项目属性并选择“网络”选项卡时，我都会在“服务器”下选择“本地 iis Web 服务器”。它会自动输入项目 URL [http://localhost/myprojectname](http://localhost/myprojectname)。

我单击创建虚拟目录，它会出现此警告，，，

'无法创建虚拟目录。本地 IIS Web 服务器和 IIS Express Web 服务器上都存在URL [http://localhost/myprojectname的站点。](http://localhost/myprojectname)您需要编辑“c:\Users\Mike\Documents\iisexpress\config\applicationhost.config”文件以更改 iis express 使用的端口号，或使用 iis manager 更改 iis 中的站点绑定。

非常感谢您的帮助解释为什么我不能使用内置功能来使用 iis 7.5 而不是 iis express。

先感谢您。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-25T15:45:31.533

可能会发生此问题，因为 IISExpress 中有一个站点设置绑定到端口 80，常规 IIS 也使用该端口。

打开提到的 applicationhost.config 并查找类似的内容：

```
 <site name="SomeAppName-Site" id="15">
    <application path="/" applicationPool="Clr4IntegratedAppPool">
    <virtualDirectory path="/" physicalPath="C:\Users\YourName\Documents\My Web Sites\SomeProjectsWebSite" />
    </application>
    <bindings>
       <binding protocol="http" bindingInformation="*:80:localhost" />
    </bindings>
</site> 
```

请注意说 :80 的部分将其更改为其他端口，因此它不与 80 共享，并且不被 IISExpress 中的另一个应用程序使用。您可以查看 applicationhost.config 中的其他站点节点以找到未使用的节点，或者尝试 8081 作为初学者。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-25T06:54:06.617

在 applicationhost.config 中，找到站点的名称并删除其站点部分..然后尝试再次重新加载您的网站项目

**编辑：**

1) 在 applicationhost.config 中找到“myprojectname”站点并完全删除它的部分

```
<site name="myprojectname" id="15">
    <application path="/" applicationPool="Clr4IntegratedAppPool">
    <virtualDirectory path="/" physicalPath="C:\Users\YourName\Documents\My Web Sites\SomeProjectsWebSite" />
    </application>
    <bindings>
       <binding protocol="http" bindingInformation="*:80:localhost" />
    </bindings>
</site> 
```

2）在解决方案资源管理器下的Visual Studio中，右键单击项目，然后选择“重新加载项目”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-12-14T00:11:17.493

我确实在以下位置尝试了从 applicationHost.config 文件中删除站点的建议：

IIS 快递：

%userprofile%\documents\iisexpress\config\applicationHost.config

%userprofile%\我的文档\iisexpress\config\applicationHost.config

IIS：

%WINDIR%\System32\inetsrv\config\applicationHost.config

但是，这对我不起作用。我发现我还必须删除/重命名位于 Visual Studio 项目文件夹中的项目用户文件。

示例 C# 项目名称为：MyProject

要重命名/删除的文件：MyProject.csproj.user

这是一个 xml 文件，其中包含一些关于 Web 项目的存储设置。

我关闭了VS。重命名文件。打开VS，项目加载就好了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-08T18:38:04.397

我遇到了同样的问题并决定选择“使用自定义 Web 服务器”，而不是“使用本地 Web 服务器”。

我在本地 IIS 7 中设置了我的站点`"http://localhost:8080"`（另一个应用程序已经在使用端口 80）。然后，我将其放入“服务器 URL”框中。

她的工作就像一个魅力，huzzah。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-17T14:09:43.073

您可能已经在 IIS 中设置了一个名为“myprojectname”的网站。转到它提到的配置文件并找到定义该项目的位置。从 XML 中删除该节点，然后重试。

# javascript - 如何在 javascript 中生成图像并在 IE7 中将其转换为 png（没有 html5 画布，也没有服务器端工作）

> ID：10192803
> 
> 赞同：1
> 
> 时间：2012-04-17T14:05:23.123
> 
> 标签：javascript, vector-graphics

我想用javascript创建一个图像：在一些像对象的画布上画线、弧、文本等，然后将它（在客户端）转换为base-64 png字符串。

我知道我可以使用 html5 画布（使用 canvas.toDataUrl("image/png")）来做到这一点，但我需要一些可以在 IE7/IE8 中使用的东西。

解决方案必须完全在客户端，因此获取 SVG，将其发送到服务器然后使用 Apache Batik 进行转换对我来说不起作用。

我找到了将位图（2d 像素数组）转换为 png - [http://www.xarg.org/2010/03/generate-client-side-png-files-using-javascript/](http://www.xarg.org/2010/03/generate-client-side-png-files-using-javascript/) 所以如果有一些库可以从某种矢量图形数据生成位图（或具有某些 getPixelAt(x,y) 功能），这可能会有所帮助。

谢谢，约阿夫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T14:15:08.860

你可以试试[fabricjs](http://fabricjs.com/)。它使用画布，但与 IE7/8 兼容（感谢 Excanvas 库）并具有您正在寻找的所有功能。

它在文档方面缺少一点，但是开发人员 Kangax 在这里和[Google 小组](http://groups.google.com/group/fabricjs)项目中非常活跃，所以任何疑问都应该很快得到解决。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-08-25T10:44:36.680

我也在寻找解决方案。原始的 javascript pnglib 非常好，但在现代 javascript 环境中编译时不会出错。我已经修复了错误，将其转换为 ES6，并使用类型数组使其更快。看一看：

[https://github.com/IjzerenHein/pnglib-es6](https://github.com/IjzerenHein/pnglib-es6)

# iis - 从 IIS 到 IISExpress 的 Web/msdeploy 同步失败

> ID：10192805
> 
> 赞同：1
> 
> 时间：2012-04-17T14:05:30.170
> 
> 标签：iis, msdeploy, iis-express, webdeploy

我在远程机器上的 IIS 上有一个网站。我想将远程服务器上的网站同步到本地 IISExpress。目前，我的本地 IISExpress 上没有该站点。我正在使用以下`msdeploy.exe`命令行（这里我将其格式化为几行，但实际的命令当然是一行）：

```
msdeploy.exe 
 -verb:sync 
 -source:webApp="mysubdomain.mydomain.com",computername=mycomputer,userName=myuser,password=mypassword
 -dest:auto 
 -apphostconfigdir=C:\Users\steen\Documents\IISExpress\config 
 -webserverdir="c:\program files (x86)\IIS Express" 
```

我得到以下错误返回：

```
Error: Application Definition with path 'mysubdomain.mydomain.com' does not exist. 
```

我做错了吗？

在我可以同步之前，我是否需要在本地 IISExpress 上拥有该站点（如果我必须首先在本地拥有它，是否有任何解决方法？）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T04:17:16.263

在 -source 参数中，尝试使用*webApp*的 Web 应用程序的名称（例如）并在*computername*参数`webApp="wordpress"`中指定服务器的 URL 。我认为您不需要首先在本地拥有该站点，但当然您需要在本地安装该站点使用的任何 Web 应用程序。

 *链接：webApp：[Web Deploy webApp Provider](http://technet.microsoft.com/en-us/library/gg418391%28WS.10%29.aspx)；计算机名：[Web 部署提供程序设置](http://technet.microsoft.com/en-us/library/dd569001%28WS.10%29.aspx)。*

# cocos2d-iphone - 我的 Cocos2d 游戏中的奇怪错误

> ID：10192807
> 
> 赞同：1
> 
> 时间：2012-04-17T14:05:39.660
> 
> 标签：cocos2d-iphone

我已经为孩子们制作了一个非常简单的 Cocos2d 教育游戏。游戏向用户显示带有字母或数字的气泡，并且语音告诉用户弹出特定的字母或字母。游戏大部分时间运行良好，但有时游戏会显示“Pop the Letter R”。然后当您尝试触摸并弹出时，它不会弹出。这种情况有 10% 的时间发生，这阻止了我将应用程序提交到应用商店。我不确定我在哪里失踪。

选择随机字母或数字的方法：

下面代码中的选项可以是一个 NSMutableArray，其中包含从 A 到 Z 的字母。

```
-(void) populateRandomBubbles:(NSMutableArray *) options 
{
    int randomNumber;
    int randomBubbleColor; 
    NSString *option = @"";

    for(int i=0;i<self.gamePlaySettings.noOfBubblesToDisplay;i++) 
    {
        randomNumber = arc4random() % options.count; 
        randomBubbleColor = arc4random() % self.bubbleColors.count; 
        option = [options objectAtIndex:randomNumber];

        CGPoint point = [self getRandomPointOnScreen]; 

        // add first bubble 
        Bubble *bubble = [[Bubble alloc] initWithColor:[self getRandomBubbleColor]];
        bubble.delegate = self; 
        bubble.text = option; 
        bubble.soundFile = [[option stringByAppendingPathExtension:@"caf"] lowercaseString];
        bubble.sprite.position = point; 

        bubble.tag = [option characterAtIndex:0];

        [bubble setStringForLabel:bubble.text];

        if([self getChildByTag:bubble.tag] == nil)
        {
            if(  (int) (self.bubbles.count) < self.gamePlaySettings.noOfBubblesToDisplay)
            {
                [self.bubbles addObject:bubble];
            }
        }
        else 
        {
            i--;
        }
    }

    // set the randomly selected alphabet 

    randomNumber = arc4random() % self.bubbles.count; 

    Bubble *bubble = [self.bubbles objectAtIndex:randomNumber];
    bubble.isSelected = YES;

    // play sound 
    [self.environment playSoundByFileName:bubble.soundFile];

} 
```

Bubble 类定义如下：

```
@implementation Bubble

@synthesize soundFile,text,isSelected,color,label,delegate = _delegate;

-(id) initWithColor:(NSString *)bubbleFile
{
    self = [super init];
    self.sprite = [CCSprite spriteWithFile:bubbleFile];
    [self addChild:self.sprite];
    return self; 
}

-(void) pop
{

    CCParticleExplosion *explosion = [[CCParticleExplosion alloc] init];
    explosion.position = self.sprite.position;
    [explosion setAutoRemoveOnFinish:YES];
    [self.parent addChild:explosion];
    [self.parent removeChild:self cleanup:YES];

    Environment *environment = [[Environment alloc] init]; 
    [environment playPopSound];
}

- (BOOL)ccTouchBegan:(UITouch *)touch withEvent:(UIEvent *)event {

    if([self containsTouchLocation:touch]) 
    {   
        // if this is the correct bubble then pop the bubble 

        if(self.isSelected) 
        {

            [self pop];
            [_delegate onBubblePop:self];

        }
        return YES;
    }

    return NO; 
} 
```

BaseNode 定义如下：

```
@implementation BaseNode

@synthesize sprite;

-(void) onEnter
{
    [[CCTouchDispatcher sharedDispatcher] addTargetedDelegate:self priority:0 swallowsTouches:YES];
    [super onEnter];
}

-(void) onExit
{
    [[CCTouchDispatcher sharedDispatcher] removeDelegate:self];
    [super onExit];
}

- (CGRect)rect
{
    CGSize s = [self.sprite.texture contentSize];
    return CGRectMake(-s.width / 2, -s.height / 2, s.width, s.height);
}

- (BOOL)containsTouchLocation:(UITouch *)touch
{
    BOOL isCollided = CGRectContainsPoint([self.sprite boundingBox], [self convertTouchToNodeSpace:touch]);

    return isCollided; 

} 
```

任何想法错误在哪里？

**更新 1：**

以下代码也粘贴在原始代码中，确保没有重复。它似乎工作正常，因为我从未遇到任何重复。

```
 if([self getChildByTag:bubble.tag] == nil)
        {
            if(  (int) (self.bubbles.count) < self.gamePlaySettings.noOfBubblesToDisplay)
            {
                [self.bubbles addObject:bubble];
            }
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T14:29:32.743

尝试使用它来确保您没有任何重复

```
int length = [YOURBUBBLEARRAY count];
NSMutableArray *indexes = [[NSMutableArray alloc] initWithCapacity:length];
for (int i=0; i<length; i++) [indexes addObject:[NSNumber numberWithInt:i]];
NSMutableArray *shuffle = [[NSMutableArray alloc] initWithCapacity:length];
while ([indexes count])
{
    int index = rand()%[indexes count];
    [shuffle addObject:[YOURBUBBLEARRAY objectAtIndex:index]];
    [indexes removeObjectAtIndex:index];
}
[indexes release];

Bubble *bubble = [shuffle objectAtIndex:randomNumber]; 
```

希望有帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T15:52:26.770

我可能已经解决了这个问题。我认为问题在于我从未进行检查以确保气泡集合中的对象是唯一的。更新后的代码如下：

```
NSArray *bubbleAlreadyInArray = [self.bubbles filteredArrayUsingPredicate:[NSPredicate predicateWithFormat:@"tag == %d",bubble.tag]];

        if([self getChildByTag:bubble.tag] == nil)
        {
            if(  (int) (self.bubbles.count) < self.gamePlaySettings.noOfBubblesToDisplay)
            {
                // only add to the bubbles array if not already added!
                if(bubbleAlreadyInArray.count == 0)
                {
                [self.bubbles addObject:bubble];
                }
            }
        }
        else 
        {
            i--;
        } 
```

I wonder if there is a better way than using NSPredicate but for now it works fine and does not get duplicates.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T14:14:06.430

```
The game works fine most of the time but sometimes the game says "Pop the Letter R". 
```

问题是......你弹出正确的字母r吗？您的代码中没有任何内容可以避免使用重复项。屏幕上可能同时有两个 r，按下其中一个不会触发另一个动作。

```
Bubble *bubble = [self.bubbles objectAtIndex:randomNumber]; 
```

如果有重复，则不会设置两个气泡。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-17T14:40:13.317

它真的在这里……

```
[self.parent removeChild:self cleanup:YES]; 
```

需要是

```
[self.parent removeChild:self.sprite cleanup:YES]; 
```

# css - 在正文中添加 word-wrap:break-word 是个好主意吗？

> ID：10192815
> 
> 赞同：2
> 
> 时间：2012-04-17T14:06:18.700
> 
> 标签：css, word-wrap

我可以在这段代码中遇到一些问题吗？

```
body {
   word-wrap:break-word;
} 
```

也许我应该更好地将该规则添加到更具体的选择器中？

**UPD**
我用它来解决 looooooooooooooooooooong 单词的问题，这些单词可以出现在任何地方并破坏布局。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T14:14:54.477

查看本期[样板/github](https://github.com/h5bp/html5-boilerplate/issues/947)中的评论，使用`word-wrap:break-word;`on `html`element 没有特别的缺点，但它似乎只对 links 元素有显着影响。

无论如何，为了避免不可预测的问题，我宁愿只将它用于`<a>`元素（只是一个偏好问题）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T18:33:41.217

不，这不是一个好主意，因为它可能会任意断词。如果偶尔有一些长字符串是你的问题，分析它们并决定一些合理的方法（例如，URL 可以用特殊的方式处理，但另一方面你应该避免将 URL 放入文本中）。

# jquery - 用户添加放置图钉，谷歌地图

> ID：10192819
> 
> 赞同：0
> 
> 时间：2012-04-17T14:06:26.400
> 
> 标签：jquery, google-maps, geolocation

我们正在创建一个在线应用程序，让用户可以将图钉添加到谷歌地图。请参见

我们如何通过用户点击添加位置？我想用户通过左/右键单击添加位置，放置一个图钉并在地图上出现一个框，然后用户输入有关该位置的一些信息。

名称
地址
商店 联系
商店经理
电子邮件
网站
备注

我希望谷歌地图放置一个大头针，地理定位，将信息传递到数据库并存储有关位置的用户输入。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T15:17:43.217

使用以下步骤：

1.  当用户点击地图时创建一个标记

    **google.maps.event.addListener(map, 'click', function(event) { addMarker to the map; });**

2.  当用户单击标记时，打开带有包含字段的表单的信息窗口以获取数据和提交按钮。

    **google.maps.event.addListener(marker, 'click', function(event) { Open the infowindow; });**

3.  当用户点击提交按钮时，将数据连同经度、纬度一起保存到数据库中

# ruby-on-rails - Nokogiri XML Builder 错误 -> “文档已经有一个根节点”

> ID：10192822
> 
> 赞同：1
> 
> 时间：2012-04-17T14:06:42.780
> 
> 标签：ruby-on-rails, xml, nokogiri, builder

在我的代码中，我正在构建一个 XML 请求。但是，这个简单的片段会产生错误：

```
def create_gateways_request
  @request_xml = Nokogiri::XML::Builder.new(:encoding => 'UTF-8') do |xml|
    xml.gateways(:ua => "#{@plugin_name} #{@version}") {
      xml.merchant {
        xml.account           MSP['merchant']['account_id']
        xml.site_id           MSP['merchant']['site_id']
        xml.site_secure_code  MSP['merchant']['site_code']
      }
      xml.customer {
        xml.country @customer[:country]
      }
    }
  end
  @request_xml.to_xml
end 
```

错误：

```
RuntimeError: Document already has a root node
from /Users/scriptdude/.rvm/gems/ruby-1.9.2-p290/gems/nokogiri-1.5.2/lib/nokogiri/xml/document.rb:212:in `add_child'
from /Users/scriptdude/.rvm/gems/ruby-1.9.2-p290/gems/nokogiri-1.5.2/lib/nokogiri/xml/node.rb:549:in `parent='
from /Users/scriptdude/.rvm/gems/ruby-1.9.2-p290/gems/nokogiri-1.5.2/lib/nokogiri/xml/builder.rb:371:in `insert'
from /Users/scriptdude/.rvm/gems/ruby-1.9.2-p290/gems/nokogiri-1.5.2/lib/nokogiri/xml/builder.rb:363:in `method_missing'
from (irb):146
from /Users/scriptdude/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.1.3/lib/rails/commands/console.rb:45:in `start'
from /Users/scriptdude/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.1.3/lib/rails/commands/console.rb:8:in `start'
from /Users/scriptdude/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.1.3/lib/rails/commands.rb:40:in `<top (required)>'
from script/rails:6:in `require'
from script/rails:6:in `<main>' 
```

根节点是`<gateways>`，对吧？

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T16:10:39.677

我无法在本地重现此内容，但您可以在方法结束时尝试此操作：

```
@request_xml.doc.to_xml 
```

它似乎认为您正在尝试向`<to_xml>`文档的根目录添加一个新节点，并且正在抱怨，因为您已经`<gateways>`在根目录中有一个元素。但是，我无法理解为什么 Nokogiri 1.5.2 会这样做，因为[Builder 确实有一个`to_xml`方法](http://nokogiri.org/Nokogiri/XML/Builder.html#method-i-to_xml)。

这是对我有用的简单测试：

```
require "nokogiri"
def do_it
  @builder = Nokogiri::XML::Builder.new{ |x| x.root{ x.kid } }
  @builder.to_xml
end

puts do_it
#=> <?xml version="1.0"?>
#=> <root>
#=>   <kid/>
#=> </root>

p Nokogiri::VERSION
#=> "1.5.2" 
```

# c# - WCF - 错误：无法获取元数据

> ID：10192824
> 
> 赞同：4
> 
> 时间：2012-04-17T14:06:48.800
> 
> 标签：c#, wcf, wcf-security

当我尝试从 WCF 测试客户端运行我的应用程序时，我收到以下错误：

> 错误：无法从[http://localhost:53867/MyAPI.svc](http://localhost:53867/MyAPI.svc)获取元数据如果这是您有权访问的 Windows (R) Communication Foundation 服务，请检查您是否已在指定地址启用元数据发布。
> 有关启用元数据发布的帮助，请参阅位于[http://go.microsoft.com/fwlink/?LinkId=65455.WS-Metadata](http://go.microsoft.com/fwlink/?LinkId=65455.WS-Metadata) Exchange 错误
> URI：[http://localhost:53867/MyAPI.svc](http://localhost:53867/MyAPI.svc)
> 的 MSDN 文档 元数据包含无法解析的引用：'http://localhost:53867/MyAPI.svc'。
> 内容类型应用程序/soap+xml；[服务http://localhost:53867/MyAPI.svc](http://localhost:53867/MyAPI.svc)不支持 charset=utf-8 。
> 客户端和服务绑定可能不匹配。
> 远程服务器返回错误：(415) Unsupported Media Type.HTTP GET Error
> URI: [http://localhost:53867/MyAPI.svc](http://localhost:53867/MyAPI.svc)
> HTML 文档不包含 Web 服务发现信息。

这是我的一些 web.config：

```
 <system.web>
    <compilation debug="true" targetFramework="4.0">
        <assemblies>
            <add assembly="System.Data.Entity, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" />
        </assemblies>
    </compilation>
    <membership defaultProvider="CustomMembershipProvider">
        <providers>
            <clear/>
            <add name="CustomMembershipProvider" type="Namespace.Models.MyMembershipProvider" />
        </providers>
    </membership>
</system.web>
<system.serviceModel>
    <bindings>
        <wsHttpBinding>
            <binding name="MembershipBinding">
                <security mode ="Message">
                    <message clientCredentialType="UserName"/>
                </security>
            </binding>
        </wsHttpBinding>
    </bindings>
    <behaviors>
        <serviceBehaviors>
            <behavior name="MyServiceBehavior">
                <serviceCredentials>
                    <userNameAuthentication
                    userNamePasswordValidationMode="MembershipProvider"
                    membershipProviderName="CustomMembershipProvider" />
                </serviceCredentials>
            </behavior>
        </serviceBehaviors>
    </behaviors>
    <serviceHostingEnvironment multipleSiteBindingsEnabled="true" aspNetCompatibilityEnabled="true" />
</system.serviceModel> 
```

我不知道是什么原因造成的？我的会员资格提供者位于该位置，并且具有正确的命名空间。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-17T14:25:12.157

删除 name 属性

```
 <behavior name="MyServiceBehavior"> 
```

并从

```
 <binding name="MembershipBinding"> 
```

并添加 serviceMetadata 元素

```
 <behaviors>
        <serviceBehaviors>
            <behavior>
                <serviceMetadata httpGetEnabled="True"/>
                <serviceCredentials>
                <userNameAuthentication
                    userNamePasswordValidationMode="MembershipProvider"
                    membershipProviderName="CustomMembershipProvider" />
                </serviceCredentials>

            </behavior>
        </serviceBehaviors>
    </behaviors> 
```

# java - ANT 能拯救我的一天吗？？？在 JBoss 上？

> ID：10192825
> 
> 赞同：-5
> 
> 时间：2012-04-17T14:06:49.203
> 
> 标签：java, ant

我的公司一直在寻找 JBoss 来构建 Java Web 系统并将它们推送到服务器。但我只是在想这一切都可以用 ANT 完成吗？我想是的，但我正在寻找一些第三方来告诉我，这样我就不会发疯，而 ANT 可以挽救我的一天。

我们需要以下内容：

*   可以将 java 程序（web/non-web）构建到类、JARS 和 WARS 中的东西
*   将 JARS 和 WAR 推送到服务器（FTP、SFTP）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T14:13:18.557

我使用 ant 来执行源代码检查。Build 编译和预编译 java 和 jasper jsp 文件。运行单元测试并将应用程序打包为 war 文件并将其上传到服务器。所以是的，这是可能的。

# php - 在 PHP 中读取远程页面的一部分

> ID：10192826
> 
> 赞同：2
> 
> 时间：2012-04-17T14:06:53.120
> 
> 标签：php, curl, file-get-contents

我在 URL **http://site.com/params 有一个页面。**我只想从这个远程页面读取**前 n 个字符。**和之类`readfile()`的功能似乎可以下载整个页面。无法弄清楚如何在 PHP 中执行此操作。`file_get_contents()``curl`

请帮忙...！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T14:25:28.850

[`file_get_contents()`](http://php.net/manual/en/function.file-get-contents.php)`maxlen`如果使用该参数，可能就是您要查找的内容。默认情况下，此函数：

```
//Reads entire file into a string
$wholePage= file_get_contents('http://www.example.com/'); 
```

但是，**maxlen**参数是*读取数据的最大长度*。

```
// Read 14 characters starting from the 1st character
$section = file_get_contents('http://www.example.com/', NULL, NULL, 0, 14); 
```

这意味着不读取整个文件，而仅`maxlen`读取字符（如果`maxlen`已定义）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T14:08:54.340

您可以尝试通过套接字[链接](http://php.net/manual/en/function.fsockopen.php)

```
$handle = fopen("http://domain.com/params", "r");
$buffer = fgets($handle, 100);
echo $buffer;
fclose($handle); 
```

# c# - 使用 Indexof 检查字符串是否包含字符

> ID：10192827
> 
> 赞同：0
> 
> 时间：2012-04-17T14:06:58.973
> 
> 标签：c#, printing, contains, indexof

我要做的是在box1中输入随机单词，单击一个按钮，然后在box2中打印所有以“D”开头的单词。因此，如果我输入“Carrots Doors Apples Desks Dogs Carpet”之类的内容并单击“Doors Desks Dogs”按钮，则会在 box2 中打印。

```
 string s = box1.Text;                
    int i = s.IndexOf("D");
    string e = s.Substring(i);
    box2.Text = (e); 
```

当我使用这个^^时
，它会打印出“Doors Apples Desks Dogs Carpet”而不仅仅是D。
注意：这些词是一个例子，我可以在 box1 中输入任何内容。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-17T14:09:13.620

您可以通过使用 LINQ 来简化它

```
var allDWords = box1.Text.Split(' ').Where(w => w.StartsWith("D"));
box2.Text = String.Join(" ", allDWords); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T14:10:32.963

尝试这个

```
box2.Text = String.Join(" ", 
                box1.Text.Split(' ')
                         .Where(p => p.StartsWith("D"))); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T14:09:32.700

您可以使用正则表达式匹配`D`单词并遍历结果

试试这个正则表达式

```
D\w+ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-17T14:10:17.727

首先，您需要将文本拆分为单词，然后检查每个单词是否以`D`. 在寻找第一个字符时，直接检查它更容易。

```
string s = box1.Text;  
StringBuilder builder = new StringBuilder();
foreach (var cur in s.Split(new char[] { ' ' })) {
  if (cur.Length > 0 && cur[0] == 'D') {
    builder.Append(cur);
    builder.Append(' ');
  }
}
box2.Text = builder.ToString(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-17T14:13:26.283

你可以做的一件事是：

让我们假设，

```
 string str = "Dog Cat Man etc";
            string[] words = str.Split(' ');

            List<string> wordStartWithD = new List<string>();

            foreach (string strTemp in words)
                if (strTemp.StartsWith("D"))
                    wordStartWithD.Add(strTemp); 
```

希望这有帮助。

# php - 如何将 localstorage 数组存储到 MySQL 数据库中？

> ID：10192828
> 
> 赞同：2
> 
> 时间：2012-04-17T14:06:59.760
> 
> 标签：php, jquery, mysql, html, local-storage

我目前正在使用 localstorage 来存储当前用户访问过的页面：

```
<?php
//start the session 
session_start();
//set $username as the current logged in user
$username=$_SESSION["Username"];
?> 
```

查询：

```
var journey = JSON.parse(localStorage.getItem('journey'))||[];
journey.push(location.protocol + 
'//' + location.host + location.pathname);
localStorage.setItem('journey', JSON.stringify(journey)); 
```

目前这是一个临时存储，但我也想让他们选择保存他们的旅程。

如何将单个 URL 与用户 ID（已存储在数据库中）一起保存到 MySQL 数据库中？例如，表名“Journey”，列“URL”和“UserID”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T14:19:50.887

MySQL旅程表：

```
CREATE TABLE journey (
    userId INT NOT NULL,
    journeyUrl VARCHAR(200) NOT NULL,
    PRIMARY KEY( userId, journeyUrl ),
    FOREIGN KEY( userId ) REFERENCES userTable( userId )        
); 
```

插入旅程查询：

```
$insert_query = "INSERT INTO journey ( userId, journeyUrl ) VALUES ( {$userId} , '{$journeyUrl}' );"; 
```

如果已经存在，则更新旅程查询：

```
$update_query = "UPDATE journey SET journeyUrl = '{$journeyUrl}' WHERE userId = {$userId};"; 
```

您的 php 脚本将在结果为布尔值的末尾回显结果。True 表示保存成功，False 表示保存失败：

```
echo json_encode($result); 
```

您将拥有一个 php 脚本，该脚本根据表中是否已经存在引用用户的记录来执行这些查询。

像这样的 jQuery AJAX 函数会调用脚本并保存旅程：

```
$.ajax({
    type: "POST",  
    url: "savejourney.php",  
    data: { id : userid, url : journeyUrl },
    dataType: "json", 
    success: function(data) {
        if(data) {
            alert("Journey saved sucessfully!");
        }
    }  
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T14:09:34.813

为此，您需要对服务器进行 Ajax 调用。您需要发出 Ajax 请求，您可以使用 Jquery 来完成。然后，您需要一种服务器端语言（例如 php）来处理请求并插入数据库。

这里有一个对 php 文件执行 AJAX 调用以插入数据库的[示例](http://www.w3schools.com/php/php_ajax_database.asp)。请注意，这不是您在生产环境中执行的方式。然而，这是一个很好的教程来理解这个过程。

**编辑**

根据您在下面的评论，我将进一步解释。上面的例子确实做了你想做的事。目前，您的数据位于“客户端”机器上的 javascript 中。您想将其传输到 mysql 数据库。

为此，您将使用 JQuery 或 Javascript 发送数据。在示例中，他们在`<script> </script>`位于 HTML 部分的标记中使用 Javascript。此javascript代码用于将数据发送到php文件，该文件在此行接收它。`$q=$_GET["q"];`然后php函数将此数据插入数据库。

在示例中，他们使用 a`GET`来实现此目的。您可能想要执行一个`POST`请求。[看看两者之间的区别](http://www.cs.tut.fi/~jkorpela/forms/methods.html)是值得的。

# java - 可以在带有参数的jsp中使用${object.method}吗？

> ID：10192831
> 
> 赞同：4
> 
> 时间：2012-04-17T14:07:13.310
> 
> 标签：java, jsp, el

我有一个像这样的对象

```
public class Employee {

  public String getName() {
    return "tommaso";
  }

  public String getName(String name) {
    return "tommaso "+name;
  }

} 
```

在我的操作（我使用 Struts）中，我设置了对象 Employee 的参数。

```
request.setAttribute("emp",employeeInstance); 
```

之后在jsp中我写了这段代码

```
${emp.name} 
```

输出是

```
托马索
```

如果我想使用第二种方法，`public String getName(String name) { ... }`使用相同的正式文本，`${emp. ...something passing a parameter... }`可以吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-17T14:10:38.783

如果您使用符合 Servlet 3.0 规范的 Servlet 3.0 容器（如 Tomcat 7、Glassfish 3、JBoss AS 6 等`web.xml`），那么您将能够在 EL 中调用带有参数的方法。然后可以按如下方式解决您的特定情况：

```
${emp.getName('foo')} 
```

如果您还没有使用 Servlet 3.0 或无法升级到它，那么您需要创建一个[自定义 EL 函数](https://stackoverflow.com/questions/9838710/how-do-i-use-static-methods-within-el/9838780#9838780)，该函数接受 2 个参数：the`Employee`和`name`.

```
public static String getEmployeeName(Employee employee, String name) {
    return employee.getName(name);
} 
```

然后按如下方式使用：

```
${my:getEmployeeName(emp, 'foo')} 
```

# iphone - xcode 解析或读取加载到 webview 中的 html 内容

> ID：10192837
> 
> 赞同：1
> 
> 时间：2012-04-17T14:07:30.520
> 
> 标签：iphone, objective-c, ios, xcode, jquery-mobile

我正在将 jqueryMobile html 页面加载到 webview 中。是否有任何方法可以读取 html 文件上的参数集以便执行本机函数？如何以及在哪里设置它？任何帮助，将不胜感激！谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T14:39:18.653

让 javascript 为您完成工作。

1.  包括一个以字符串形式返回值的 javascript 函数。说`getParam()`
2.  加载完 HTML 后，使用 `stringByEvaluatingJavaScriptFromString:`UIWebView (on `webViewDidFinishLoad`)的方法

例如：

```
-(void)webViewDidFinishLoad:(UIWebView *)webView {
    NSString *param = [webView stringByEvaluatingJavaScriptFromString:@"getParam();"];
} 
```

# jquery-ui - Rails 3.2：缺少 jQuery UI 图标

> ID：10192845
> 
> 赞同：4
> 
> 时间：2012-04-17T14:07:58.677
> 
> 标签：jquery-ui, ruby-on-rails-3.1, asset-pipeline

我已经迁移到 Rails 3.2.2，将所有更改部署到生产服务器。现在我所有的 jQuery UI 图标都不见了。

部署后，我确实使用以下方法编译了所有资源：

```
bundle exec rake assets:precompile 
```

我还在 application.js 中添加了 //= 需要 jquery-ui。

这些图标在开发环境中工作正常，但在部署到生产服务器后不显示。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T17:24:22.217

您是否将 jquery-UI 图像移动到适当的目录下

```
app/assets/images/ 
```

?

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T08:57:03.947

好的，原因是我忘记修改 jQuery UI 自定义 css 以使用资产管道。这是修复：

--rename jquery-ui-custom...css to .css.erb --append <%= assets_pipeline '...png' %> 到每个使用图像的地方。

# sql - 使用 sql 2005 将多个值插入单个单元格

> ID：10192854
> 
> 赞同：0
> 
> 时间：2012-04-17T14:08:36.287
> 
> 标签：sql, sql-server, sql-server-2005

我有典型的桌子：

```
LSRNbr  BatchNbr
111     1212
111     1414 
```

查询应该返回：

```
LSRNbr   BatchNbr
111      1212, 1414 
```

我正在浏览解决方案，我发现了这两个：

**解决方案1：**

```
;WITH C AS 
(
SELECT LSRNbr, BatchNbr FROM tblDTS_LSRBatch
)

SELECT Distinct LSRNbr, 
STUFF((SELECT ';' + BatchNbr FROM tblDTS_LSRBatch WHERE LSRNbr = c.LSRNbr FOR XML PATH('')),1,1,'') 
FROM C 
```

**错误：**

```
Msg 170, Level 15, State 1, Line 1
Line 1: Incorrect syntax near ';'.
Msg 170, Level 15, State 1, Line 7
Line 7: Incorrect syntax near 'XML'. 
```

**解决方案2：**

```
SELECT 
[LSRNbr], REPLACE(RTRIM((SELECT [BatchNbr] + ' ' FROM tblDTS_LSRBatch WHERE (LSRNbr = Results.LSRNbr ) FOR XML PATH (''))),' ',', ') AS NameValues
FROM tblDTS_LSRBatch Results
GROUP BY LSRNbr 
```

**错误：**

```
Msg 170, Level 15, State 1, Line 2
Line 2: Incorrect syntax near 'XML'. 
```

但是它们都不适合我，请参阅上面的错误。

这里可能是什么问题？

我正在使用 Microsoft SQL Server 2005

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T14:14:47.397

这些是语法错误。

您将通过自己找出特定错误来了解更多信息：

看一下[语法树](http://msdn.microsoft.com/en-us/library/ms190922.aspx)

看看[你正在尝试做](https://stackoverflow.com/questions/273238/how-to-use-group-by-to-concatenate-strings-in-sql-server)的一些[很好的例子](http://archive.msdn.microsoft.com/SQLExamples/Wiki/View.aspx?title=createacommadelimitedlist)

如果您仍有问题，请随时提出更多问题

# c# - 动态表达式 API - LINQ to SQL

> ID：10192855
> 
> 赞同：1
> 
> 时间：2012-04-17T14:08:36.727
> 
> 标签：c#, linq-to-sql, bit-manipulation, enumeration, dynamic-linq

我们正在使用 DynamicLinq.cs 类并尝试设置查询的 where 子句以检查按位数据值。

枚举示例（枚举上有 Flags 属性）：

```
None = 0 

Flag1 = 1

Flag2 = 2

Flag3 = 4 
```

我们特别想要实现的是返回不包括“Flag1”值的数据，即排除已解析的 1、3、5 和 7 值。我相信在标准 LINQ 中，您可以通过使用“& ~”但是我们似乎无法让动态表达式 API 接受我们正在做的事情，结果查询的解析总是会失败。

有谁知道如何在动态表达式 API 中操作和使用按位枚举？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T14:29:55.647

看起来动态 LINQ 不支持按位操作。您可以通过使用这个等效的数学公式来解决按位运算：

```
(a & 2^n == 0) <==> a % 2^(n+1) < 2^n 
```

动态 LINQ 库确实支持 mod 运算符 ( `%`)，因此您可以完成此操作：

```
Where("MyFlag % 2 < 1") 
```

基本上这是如何工作的。假设您要查找所有排除 的值`Flag3`。既然`Flag3 = 4`，就是`4 = 2^2`这样`n=2`。标准的写法是 ( `MyFlagValue & Flag3 == 0`)，也就是说，当你按位`and`使用时`Flag3`，你应该得到 0，表示不包括标志。

这也可以通过抓取最右边的 3 位（通过应用`% 8`）在不使用任何位运算符的情况下以数学方式表示，并检查该值是否小于`4`，如果从右起 3 位不是，则该值将是放。例如，与`MyFlagValue=14`

```
MyFlagValue =         14 = 0b1110
MyFlagValue % 8 =      6 = 0b0110
MyFlagValue % 8 < 4 =  false  ^ which means 3-from-right bit (Flag3) is set 
```

另一个例子，其中`MyFlagValue=58`：

```
MyFlagValue =         58 = 0b111010
MyFlagValue % 8 =      2 = 0b000010
MyFlagValue % 8 < 4 =  true     ^ which means 3-from-right bit (Flag3) is NOT set 
```

因此，这可以用 Dynamic LINQ 理解的数学方式表示，以检查是否未`Flag3`设置第三个标志：

```
Where("MyFlagValue % 8 < 4") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T14:25:59.503

快速浏览动态 linq 源代码显示不支持按位运算。

# iphone - 在 Objective C 中声明变量的基础

> ID：10192856
> 
> 赞同：0
> 
> 时间：2012-04-17T14:08:37.583
> 
> 标签：iphone, objective-c

如果我们有：

第一种方法是

我的类.h

```
@interface MyClass : UIViewController{   

    IBOutlet UILabel* _label;  
    NSString    *myString; 
} 
```

第二种方式是

```
MyClass.m

@interface MyClass() {

    IBOutlet UILabel* _label;  
    NSString    *myString;
}

@end 
```

我的问题是第一种方式和第二种方式有什么区别。

我知道第二种方法是为 MyClass 创建私有变量。第一种方式怎么样。它是否做同样的事情。

请就这个问题给我建议

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T14:12:05.677

第一种方式是在头文件 MyClass.h 中声明它的方式。使用这个类的人总是有你的头文件，所以他们会看到那些实例变量。

在实现文件 MyClass.m 中使用它的第二种方式。所以如果你给我一个框架，里面有你的类，只有 .h 文件，我可以使用你的 MyClass 类，但我不知道你的实例变量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T14:13:31.923

您可以使用`@private`关键字将第一个示例中的变量设为私有。这不是在*类扩展*中添加变量的重点。相反，在扩展中添加 ivars 可以让您从标头中删除不需要的依赖项，而无需使用前向声明。

例如，如果`MySpecialClass`在中定义`MySpecialClass.h`并且您想将其添加`MySpecialClass *special`为私有变量，则在标头中执行此操作将需要前向声明`@class MySpecialClass`，或者`MySpecialClass.h`在您自己的标头中包含标头。另一方面，将变量添加到扩展（您的第二种方式）可以让您包含`MySpecialClass.h`在您的*实现*.m 文件中，避免前向声明的混乱和不必要的头文件依赖。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T14:17:56.960

两者中，第二种方式更好。第一种方法要求您将内部实现细节放在类的公共接口中，即它通过将这些细节泄露给类的用户来破坏封装。

但是，现在有第三种更好的方法。您可以将实例变量放入实现中：

```
@implementation MyClass
{
@private
    IBOutlet UILabel* _label;  
    NSString    *myString;    
}

// method implementations

@end 
```

# c# - 更新面板内的 RadioButton 导致回发

> ID：10192860
> 
> 赞同：3
> 
> 时间：2012-04-17T14:09:00.583
> 
> 标签：c#, asp.net, ajax, updatepanel

我将以下控件放在更新面板中，以便整个页面不会刷新。单击按钮时，页面不会刷新，但是当我尝试更改单选按钮时，页面会刷新并导致完整的回发。这是我的代码：

```
<ajaxToolkit:ToolkitScriptManager ID="ToolkitScriptManager" runat="Server" EnablePartialRendering="true" />
<asp:UpdatePanel ID="updatePanelToggle" runat="server">
    <ContentTemplate>
        <asp:RadioButton ID="radioOn" AutoPostBack="true" runat="server" GroupName="toggle" Text="On" OnCheckedChanged="radioOn_CheckedChanged" />
        <asp:RadioButton ID="radioOff" AutoPostBack="true" runat="server" GroupName="toggle" Text="Off" OnCheckedChanged="radioOff_CheckedChanged" />
        <asp:Button ID="testButton" runat="server" OnClick="mybutton_click"/>
    </ContentTemplate>
</asp:UpdatePanel> 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-17T14:22:13.077

根据您的要求，您可以通过添加触发器来控制回发。如果您只想更新更新面板内容，请使用[AsyncPostBackTrigger 。](http://msdn.microsoft.com/en-us/library/system.web.ui.asyncpostbacktrigger.aspx)如果您需要完整的回发，请使用[PostBackTrigger](http://msdn.microsoft.com/en-us/library/system.web.ui.postbacktrigger.aspx)。

```
<asp:UpdatePanel ID="updatePanelToggle" runat="server" UpdateMode="Conditional">
    <ContentTemplate>
        <asp:RadioButton ID="radioOn" AutoPostBack="true" runat="server" GroupName="toggle" Text="On" OnCheckedChanged="radioOn_CheckedChanged" />
        <asp:RadioButton ID="radioOff" AutoPostBack="true" runat="server" GroupName="toggle" Text="Off" OnCheckedChanged="radioOff_CheckedChanged" />
        <asp:Button ID="testButton" runat="server" OnClick="mybutton_click"/>
    </ContentTemplate>
   <Triggers>
        <asp:AsyncPostBackTrigger ControlID="radioOn" />
        <asp:AsyncPostBackTrigger ControlID="radioOff" />
        <asp:PostBackTrigger ControlID="testButton" />
    </Triggers>
</asp:UpdatePanel> 
```

# metadata - 在 Alfresco 中为上传的内容添加属性

> ID：10192862
> 
> 赞同：2
> 
> 时间：2012-04-17T14:09:14.290
> 
> 标签：metadata, alfresco

我正在使用 Alfresco Web Quick Start 创建一个基本的 CMS 网站。我想知道是否有人可以解释如何向我上传的内容添加属性/元数据。例如，如果我有一个图像库（具有作者、已发布、大小和 Mime 类型的默认元数据）并且想要获取数据属性等，我将如何实现呢？

我已经做了一些研究，但还没有找到具体的解决方案，对此问题的任何帮助将不胜感激！谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T17:36:07.513

Alfresco 中给定节点的可用元数据由其[类型和方面](http://wiki.alfresco.com/wiki/Data_Dictionary_Guide)决定。

Alfresco 已经附带了一个 EXIF 方面（[在此处](http://svn.alfresco.com/repos/alfresco-open-mirror/alfresco/HEAD/root/projects/repository/config/alfresco/model/contentModel.xml)查找“exif:exif”），您可能希望将其用于您的用例，不幸的是 WCM QS 隐藏了它。您应该创建一个文件（[此处](http://svn.alfresco.com/repos/alfresco-open-mirror/alfresco/HEAD/root/projects/slingshot/config/alfresco/web-extension/share-config-custom.xml.sample)`share-config-custom.xml`为示例，官方[文档](http://docs.alfresco.com/4.0/index.jsp?topic=/com.alfresco.enterprise.doc/tasks/forms-aspect-display.html)），该文件应列出您要公开的方面的所有字段。`exif:exif`

像下面这样的东西应该可以工作：

```
<config evaluator="model-type" condition="exif:exif">
    <forms>
        <form>
            <field-visibility>
                <show id="exif:dateTimeOriginal"/>                  
            </field-visibility>             
        </form>
    </forms>
</config> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T23:33:15.543

这是皇家的痛苦。

首先，您需要创建一个模型。在该模型中，您需要创建一个方面。所有这些都在 XML 文件 #1 中。

然后你需要一个上下文文件来注册方面。这是 XML 文件 #2。

和一个属性文件，为方面提供一个友好的名称。

还有一个 web-site-custom-config 列出 XML 文件 1 中列出的所有属性。这是 XML 文件 #3

你需要一个共享自定义配置。这与 XML 文件 #3 的格式不同，但用途相同。

最后，您需要创建一个规则，自动将方面应用到文件夹中的每个项目。

参考：http: [//blogs.alfresco.com/wp/wabson/2010/02/25/adding-custom-aspect-support-in-alfresco-share/](http://blogs.alfresco.com/wp/wabson/2010/02/25/adding-custom-aspect-support-in-alfresco-share/)

* * *

共享自定义配置.xml

```
<alfresco-config>

    <!-- Repository Library config section -->
    <config evaluator="string-compare" condition="RepositoryLibrary" replace="true">
        <!--
         Whether the link to the Repository Library appears in the header component or not.
        -->
        <visible>true</visible>
    </config>

    <config evaluator="string-compare" condition="DocumentLibrary">

        <!--
         Used by the "Manage Aspects" action

         For custom aspects, remember to also add the relevant i18n string(s)
            cm_myaspect=My Aspect
        -->
        <aspects>
            <!-- Aspects that a user can see -->
            <visible>
                <aspect name="my:sampleProps" />
                <aspect name="ac:androidContentProps" />
            </visible>

            <!-- Aspects that a user can add. Same as "visible" if left empty -->
            <addable>
            </addable>

            <!-- Aspects that a user can remove. Same as "visible" if left empty -->
            <removeable>
            </removeable>
        </aspects>
    </config>

    <config evaluator="node-type" condition="cm:content">
        <forms>
            <form>
                <field-visibility>
                    <!-- fields from my example aspect -->
                    <show id="my:propOne" />
                    <show id="my:propTwo" />
                    <show id="my:propInt" />
                    <show id="my:propFloat" />
                    <show id="my:propDateTime" />
                    <show id="my:propDate" />
                    <show id="my:propBoolean" />
                    <show id="my:propQName" />
                    <show id="my:propCategory" />
                    <show id="my:propNodeRef" />
                    <show id="my:propPath" />
                    <!-- fields for android content -->
                    <show id="ac:propNotify" />
                    <show id="ac:propNotificationSummary" />
                    <show id="ac:propArchiveDate" />
                    <show id="ac:propPublishDate" />
                    <show id="ac:propPriority" />
                    <show id="ac:propRegion" />
                    <show id="ac:propMarket" />
                    <show id="ac:propDistrict" />
                    <show id="ac:propStore" />
                </field-visibility>
            </form>
        </forms>
    </config>

    <config evaluator="string-compare" condition="Remote">
        <remote>
            <endpoint>
                <id>alfresco-noauth</id>
                <name>Alfresco - unauthenticated access</name>
                <description>Access to Alfresco Repository WebScripts that do not require authentication</description>
                <connector-id>alfresco</connector-id>
                <endpoint-url>http://localhost:8080/alfresco/s</endpoint-url>
                <identity>none</identity>
            </endpoint>

            <endpoint>
                <id>alfresco</id>
                <name>Alfresco - user access</name>
                <description>Access to Alfresco Repository WebScripts that require user authentication</description>
                <connector-id>alfresco</connector-id>
                <endpoint-url>http://localhost:8080/alfresco/s</endpoint-url>
                <identity>user</identity>
            </endpoint>

            <endpoint>
                <id>alfresco-feed</id>
                <name>Alfresco Feed</name>
                <description>Alfresco Feed - supports basic HTTP authentication via the EndPointProxyServlet</description>
                <connector-id>http</connector-id>
                <endpoint-url>http://localhost:8080/alfresco/s</endpoint-url>
                <basic-auth>true</basic-auth>
                <identity>user</identity>
            </endpoint>

            <endpoint>
                <id>activiti-admin</id>
                <name>Activiti Admin UI - user access</name>
                <description>Access to Activiti Admin UI, that requires user authentication</description>
                <connector-id>activiti-admin-connector</connector-id>
                <endpoint-url>http://localhost:8080/alfresco/activiti-admin</endpoint-url>
                <identity>user</identity>
            </endpoint>
        </remote>
    </config>

</alfresco-config> 
```

# android - Android 应用：ANR keyDispatchingTimedOut 错误

> ID：10192868
> 
> 赞同：0
> 
> 时间：2012-04-17T14:09:27.427
> 
> 标签：android

当 UI 线程加载大量循环和逻辑操作时发生这种错误的任何建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T14:12:52.840

通过文件资源管理器中的 data/anr/trace.txt 获取错误消息。并且，还将所有逻辑操作和循环放入单独的线程中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T14:11:59.987

当您在 UI 线程上进行大量工作并且不允许刷新用户界面时，就会发生 ANR 错误。您的描述非常适合这种情况。

要修复它，请在不同的线程上运行这些操作。如果在您的情况下方便，您也可以使用 AsyncTask。请参阅[http://developer.android.com/reference/android/os/AsyncTask.html](http://developer.android.com/reference/android/os/AsyncTask.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T14:19:31.307

```
private class LongWork extends AsyncTask<Void, Integer, Void> 
```

{

```
@Override
protected Void doInBackground(Void... arg0) {

  //Do a long Task here
    return null;
}

@Override
protected void onPostExecute(Void result) { 
```

//在UI线程上做你必须做的事情

```
} 
```

}

然后

```
LongWork work=new LongWork();
work.execute(); 
```

# java - 春季多语言

> ID：10192877
> 
> 赞同：0
> 
> 时间：2012-04-17T14:09:57.303
> 
> 标签：java, spring-mvc

我是 Spring MVC 的新手，在向我的应用程序中添加多语言时遇到了一些问题。

我不使用 xml 配置。我有一个@Configuration 类

```
import org.springframework.context.MessageSource;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.ComponentScan;
import org.springframework.context.annotation.Configuration;
import org.springframework.web.servlet.HandlerInterceptor;
import org.springframework.web.servlet.HandlerMapping;
import org.springframework.web.servlet.LocaleResolver;
import org.springframework.web.servlet.ViewResolver;
import org.springframework.web.servlet.config.annotation.EnableWebMvc;
import org.springframework.web.servlet.handler.SimpleUrlHandlerMapping;
import org.springframework.web.servlet.i18n.CookieLocaleResolver;
import org.springframework.web.servlet.i18n.LocaleChangeInterceptor;
import org.springframework.web.servlet.i18n.SessionLocaleResolver;
import org.springframework.web.servlet.mvc.annotation.DefaultAnnotationHandlerMapping;

@Configuration
@EnableWebMvc
@ComponentScan(basePackages="com.springexamples.basic.controller")
public class BasicServletConfig extends BaseConfig {

    @Bean
    ViewResolver viewResolver() {
        return getViewResolver("views/basic/", ".jsp");
    }

    @Bean
    MessageSource messageSource() {
        return getMessageSource("/messages/messages");
}

@Bean
LocaleChangeInterceptor localeChangeInterceptor() {
    LocaleChangeInterceptor interceptor = new LocaleChangeInterceptor();
    interceptor.setParamName("lang");
    return interceptor;
}

@Bean
LocaleResolver localeResolver() {
    return new SessionLocaleResolver();
}

@Bean
HandlerMapping handlerMapping() {
    SimpleUrlHandlerMapping mapping = new SimpleUrlHandlerMapping();
    mapping.setInterceptors(new HandlerInterceptor[] { localeChangeInterceptor() });
    return mapping;
}
} 
```

当我测试应用程序时，我总是看到默认语言（西班牙语）。我使用参数“lang=en”或“lang=EN”发送请求，但我仍然以默认语言看到它。

¿ 有人知道解决方案吗？

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T14:46:48.983

我不确定如何`HandlerMapping`声明这种方式将与`@EnableWebMvc`. 配置拦截器的一种更惯用的方法`@EnableWebMvc`是使用`WebMvcConfigurer`：

```
@Configuration 
@EnableWebMvc 
@ComponentScan(basePackages="com.springexamples.basic.controller") 
public class BasicServletConfig extends BaseConfig implements WebMvcConfigurer {
    ...
    public void addInterceptors(InterceptorRegistry registry) {
        registry.addInterceptor(localeChangeInterceptor());
    }
    ...
} 
```

# c# - 如何从列表中获取重复次数

> ID：10192878
> 
> 赞同：4
> 
> 时间：2012-04-17T14:10:01.863
> 
> 标签：c#, linq, linq-to-sql

```
List<int> ListIdProducts = new List<int>();
var IdProductKey = from a in me.ProductKeywords where a.Keyword == item.Id select a;
 foreach (var item2 in IdProductKey)
 {
   ListIdProducts.Add(item2.Product.Value);
 } 
```

结果是：5 6 7 5 2 5

我需要得到以下 5=3, 6=1, 7=1, 2=1

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-17T14:12:18.200

使用[`GroupBy`](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.groupby%28v=vs.100%29.aspx)LINQ 方法：

```
ListIdProducts
    .GroupBy(i => i)
    .Select(g => new { Value = g.Key, Count = g.Count() }); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-17T14:18:41.993

```
var query1 = from a in ListIdProducts 
                         group a by new { a } into g
                         select new
                         {
                             item = g.Key,
                             itemcount = g.Count()
                         }; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-17T14:13:42.340

这是一个相当标准的分组问题。

```
//untested
var IdProducts = from a in me.ProductKeywords 
                 where a.Keyword == item.Id 
                 group by a.Product.Value into g
                 select g.Count(); 
```

# algorithm - 查找具有区域约束的 Voronoi 细分

> ID：10192883
> 
> 赞同：3
> 
> 时间：2012-04-17T14:10:08.223
> 
> 标签：algorithm, computational-geometry, voronoi

假设我们想要对一个具有 N 个点的矩形表面进行 Voronoi 分区。Voronoi 细分导致 N 个区域对应于 N 个点。对于每个区域，我们计算其面积并将其除以整个表面的总面积 - 称这些数字为 a1，...，aN。它们的总和等于一。

假设现在我们有 N 个数字的预设列表，b1，...，bN，它们的总和等于 1。

如何找到用于 Voronoi 分区的 N 个点的坐标的选择（任意），例如 a1==b1、a2==b2、...、aN==bN？

编辑：

经过一番思考，Voronoi 分区可能不是最好的解决方案，关键是要对表面进行随机不规则划分，以使 N 个区域具有适当的大小。Voronoi 在我看来是合乎逻辑的选择，但我可能弄错了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T14:59:01.053

我会去一些遗传算法。

以下是基本流程：

1) 创建 100 组属于您的矩形的随机点。

2) 对于每个集合，计算 voronoï 图和面积

3) 对于每组，评估它与您的预设权重的比较情况（称之为分数）

4) 按分数对点集进行排序

5) 丢弃 50 个最差的集合

6）通过mixins点从剩余的50个集合中创建50个新集合并添加一些随机的。

7) 跳转到第 2 步，直到满足条件（得分高于阈值、出现次数、花费时间等...）

你最终会（希望）得到一个“有点合适”的结果。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T15:21:57.130

如果您要查找的不一定是 Voronoi 镶嵌，而可能是幂图，则以下文章中描述了一个不错的算法：

F. Aurenhammer、F. Hoffmann 和 B. Aronov，*“Minkowski 型定理和最小二乘聚类”，* Algorithmica，**20** :61-76 (1998)。

他们的问题版本如下：给定多边形 P 中的 N 个点 (p_i)，以及一组非负实数 (a_i) 与 P 的面积相加，求权重 (w_i)，使得Power cell Pow_w(p_i) 与 P 的交集正好是 a_i。在论文的第 5 节中，他们证明了这个问题可以写成凸优化问题。要实施这种方法，您需要：

*   有效计算功率图的软件，例如[CGAL](http://www.cgal.org)和
*   凸优化软件。我发现使用 L-BFGS 等准牛顿求解器在实践中给出了非常好的结果。

[我的网页](http://quentin.mrgt.fr)上有一些代码正是这样做的，名称为“二次最优传输”。然而，这段代码不是很干净，也不是很好的文档，所以实现你自己的算法版本可能会一样快。您还可以查看我关于此主题的 SGP2011 论文，该论文可在同一页面上找到，以简要描述 Aurenhammer、Hoffman 和 Aronov 算法的实现。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T14:43:48.427

假设矩形与 x = 0 处的左边缘和 x = 1 处的右边缘以及 y = 0 处的水平平分线轴对齐的坐标。~~令 B(0) = 0 和 B(i) = b1 + ... +双。将点放在 ((B(i-1) + B(i))/2, 0) 处。~~这是不对的。我们将 x 坐标设为 xi，使得 bi = (x(i+1) - x(i-1)) / 2，将 x(0) 替换为 0，将 x(n+1) 替换为 1。这是三对角线和应该有一个简单的解决方案，但也许你不想要这么无聊的 Voronoi 图；这将是一堆垂直分区。

对于一个看起来更随机的图，可能是受到了物理学启发：随机放置点，计算 Voronoi 图，计算每个单元格的面积，使超重单元格对其邻居的点有吸引力，而体重不足的单元格排斥并为每个单元格计算一个小的增量点，重复直到达到平衡。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-17T14:41:37.077

当您计算最小生成树并移除最长边时，可以计算 voronoi 镶嵌。然后，mst 子树的每个中心都是 voronoi 图的一个点。因此，voronoi 图是最小生成树的子集。

# c++ - 世界空间逆投影透视

> ID：10192886
> 
> 赞同：0
> 
> 时间：2012-04-17T14:10:20.703
> 
> 标签：c++, matrix, 3d, transformation

我正在将阴影功能扩展到我作为课堂作业创建的现有 3d 渲染器。我正在尝试实现 2 pass z 缓冲区算法。我已经完成了第一遍并创建了深度图。但是，问题是我在屏幕空间中栅格化了我的线条，因此我必须将我的坐标带回图像空间，因为深度图的 z 值与片段坐标的 z 值之间的比较发生在图像空间中。

我使用堆栈实现，它以以下形式存储空间变换矩阵：

[Xsp] * [Xpi] * [Xiw ] * (x,y,z) 世界空间中的坐标 = x,y,z 在屏幕空间中 Xsp - 屏幕透视 Xpi - 图像透视 Xiw - 世界图像

这里，栈底包含Xsp，倒数第二个包含，Xsp与Xpi相乘，倒数第三个包含Xsp * Xpi与Xiw相乘的结果......

现在，我只想要图像空间中的 x,y,z ，即（世界空间中的 Xiw * x,y,z），所以在世界空间中获取 x,y,z 对我有用......是否有可能如果我将每个矩阵的逆相乘，然后将结果与屏幕空间中的 x,y,z 相乘，则实现？

我的意思是，我想做

[Xsp]inverse * [Xpi]inverse * [Xiw]inverse ，并将其与屏幕空间的 x,y,z 相乘，它会让我回到世界空间吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T19:46:58.213

让我猜猜。南加州大学 CS580？

反正我会帮忙的。

**你最初是如何得到你的顶点的：**

```
Xsp * Xpi * Xiw * Xwm * v = vf //Concat * model-space vertex = raster-space vertex

vf' = (vf.x / vf.w, vf.y / vf.w, vf.z / vf.w); //Perspective 
```

**你如何用 vf' 取回它：**

```
Xwm * vf = Xiw^-1 * Xpi^-1 * Xsp^-1 * vf' //Inverted partial concat * raster-space vertex = world-space vertex

v = (vf.x / vf.w,  vf.y / vf.w, vf.z / vf.w); //Perspective again 
```

法线是相同的想法，除了你只需要一个倒置的 Xiw 就可以回到世界空间，因为法线只进入图像空间。也没有涉及到观点。

# ninject - kernel.Get 获取单例实例

> ID：10192891
> 
> 赞同：0
> 
> 时间：2012-04-17T14:10:39.610
> 
> 标签：ninject

我有`ConverterTest`需要访问课程的`ValidateTest`课程。我不能`ValidateTest`使用构造函数传递，因为`ConverterTest`它是抽象类。如果我引入第二个构造函数来绑定`ValidateTest`，我会在派生类中遇到很多问题，很多事情都需要改变。所以我试图传递`ValidateTest`给`ConverterTest`使用属性注入（用注入属性装饰），但这也不起作用，因为`ConverterTest`不是由 Ninject 创建的，并且注入属性被忽略。所以我决定直接在`ValidateTest`类中创建实例属性并绑定自身的实例。`ValidateTest`要在课堂上获取实例，`ConverterTest`我使用`kernel.Get<ValidateTest>().Instance`. `kernel.Get`一切正常，但使用访问实例类是个好主意吗？还有其他解决方案吗？

```
public class ValidateTest
{

        private readonly ISettingsRepository _settingsRepository;

        [Inject]
        public ValidateTest Instance { get; set; }

        public ValidateTest(ISettingsRepository settingsRepository)
        {
            _settingsRepository = settingsRepository;            
        }
} 
```

捆绑

```
kernel.Bind<ISettingsRepository>().To<SettingsRepository>();
kernel.Bind<ValidateAbuse>().ToSelf().InSingletonScope(); 
```

在无法绑定构造函数且属性绑定不起作用的抽象类中获取使用实例`ValidateTest`。`kernel.Get`

```
public abstract class ConverterTest
{

        public void Execute()
        {
          NinjectHelper.kernel.Get<ValidateTest>().Instance
        }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T14:18:31.900

为什么不让您的子类`ConverterTest`通过 ConverterTest 中的公开属性或它们自己的构造函数来设置 ValidateTest？

```
public abstract class ConverterTest
{
     protected ValidateTest ValidateTest{get;set;}

     public void Execute()
     {
         ValidateTest.ValidateStuff();
     }
}

public class ConcreteConverter : ConverterTest
{
    [Inject]
    public ConcreteConverter(ValidateTest validateTest)
    {
        base.ValidateTest = validateTest;
    }
} 
```

或者，我认为您可以将属性公开`public ValidateTest ValidateTest{get;set;}` ，如果您添加适当的属性，它应该可以用于属性注入。

```
public abstract class ConverterTest
{
     [Inject]
     public ValidateTest ValidateTest{get;set;}

     public void Execute()
     {
         ValidateTest.ValidateStuff();
     }
} 
```

# windows - 是否可以使用 makecert 生成具有自定义密钥用法的证书？

> ID：10192894
> 
> 赞同：4
> 
> 时间：2012-04-17T14:11:02.607
> 
> 标签：windows, certificate, makecert

是否可以使用 makecert 创建具有特定密钥使用属性的自签名证书？

我需要生成一个自签名证书进行测试。它必须在“密钥使用”属性上具有“数字签名”和“不可否认”值，如[RFC 3280](http://www.faqs.org/rfcs/rfc3280.html)第 4.2.1.3 节中所述。

我尝试了一些使用“-sky”选项的变体，例如“3”（设置位 0 和位 1）和“1,2”。第一个不被接受，第二个创建一个证书，但它似乎没有设置“KeyUsage”属性。

请注意，这不是指“-eku”（扩展密钥用法）。

这是我正在使用的脚本：

```
makecert -r -pe -n "CN=cte-dev-CA" -ss CA -sr CurrentUser -a sha1 -sky signature -sv cte-dev-CA.pvk cte-dev-CA.cer

certutil -user -addstore Root cte-dev-CA.cer

makecert -pe -n "CN=cte-dev-SPC" -eku 1.3.6.1.5.5.7.3.2,1.3.6.1.5.5.7.3.4 -a sha1 -sky signature -ic cte-dev-CA.cer -iv cte-dev-CA.pvk -sv cte-dev-SPC.pvk cte-dev-SPC.cer

pvk2pfx -pvk cte-dev-SPC.pvk -spc cte-dev-SPC.cer -pfx cte-dev-SPC.pfx -po my-password 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-04T03:45:23.180

没有影响已创建证书的“密钥使用”字段的 makecert 参数。至少，我也一直找不到。

# iphone - 使用 addTarget:Action:forControlEvents 获取运行时异常

> ID：10192901
> 
> 赞同：0
> 
> 时间：2012-04-17T14:11:19.137
> 
> 标签：iphone, objective-c, xcode, ipad, uibutton

我正在尝试使用*addTarget:Action:forControlEvents*但我收到一个无法识别的选择器的运行时异常。

这是从*initWithFrame中的**UIView*子类调用的。下面是我的代码：

 *```
myButton = [[UIButton alloc] initWithFrame:frame];
[myButton addTarget:self action:&selector(displayList:)
                         forControlEvents:UIControlEventTouchUpInside]; 
```

我的方法：

```
-(void)displayList:(id)sender 
```

当我单击按钮时，它会收到以下消息：

`-[MyClass displayList:]: unrecognized selector sent to instance. Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: -[MyClass displayList:]: unrecognized selector sent to instance.`

*MyClass*是一个自定义控件，它是带有*UIButton*和*UILabel的**UIView*子类。这个类将被放置在另一个应用程序的 ViewController 上。

 **我不确定我错过了什么。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T14:13:52.170

它应该读

```
[myButton addTarget:self action:@selector(displayList:) forControlEvents:UIControlEventTouchUpInside]; 
```

@ 代替 ＆

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T14:14:35.033

```
[myButton addTarget:self action:&selector(displayList:) forControlEvents:UIControlEventTouchUpInside]; 
```

语法是 @selector(displayList:)
此外，您的按钮可能不会触发事件。尝试以这种方式创建它：

```
UIButton *button = [UIButton buttonWithType:UIButtonTypeRoundedRect]; //this will return an autoreleased UIButton object, be careful.
button.frame = CGRectMake(...);
... 
```***

# c - C中的时间（以毫秒为单位）

> ID：10192903
> 
> 赞同：60
> 
> 时间：2012-04-17T14:11:38.853
> 
> 标签：c, time, clock

使用以下代码：

```
#include<stdio.h>
#include<time.h>
int main()
{
    clock_t start, stop;
    int i;
    start = clock();
    for(i=0; i<2000;i++)
    {
        printf("%d", (i*1)+(1^4));
    }
    printf("\n\n");
    stop = clock();

    //(double)(stop - start) / CLOCKS_PER_SEC

    printf("%6.3f", start);
    printf("\n\n%6.3f", stop);
    return 0;
} 
```

我得到以下输出：

```
56789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382383384385386387388389390391392393394395396397398399400401402403404405406407408409410411412413414415416417418419420421422423424425426427428429430431432433434435436437438439440441442443444445446447448449450451452453454455456457458459460461462463464465466467468469470471472473474475476477478479480481482483484485486487488489490491492493494495496497498499500501502503504505506507508509510511512513514515516517518519520521522523524525526527528529530531532533534535536537538539540541542543544545546547548549550551552553554555556557558559560561562563564565566567568569570571572573574575576577578579580581582583584585586587588589590591592593594595596597598599600601602603604605606607608609610611612613614615616617618619620621622623624625626627628629630631632633634635636637638639640641642643644645646647648649650651652653654655656657658659660661662663664665666667668669670671672673674675676677678679680681682683684685686687688689690691692693694695696697698699700701702703704705706707708709710711712713714715716717718719720721722723724725726727728729730731732733734735736737738739740741742743744745746747748749750751752753754755756757758759760761762763764765766767768769770771772773774775776777778779780781782783784785786787788789790791792793794795796797798799800801802803804805806807808809810811812813814815816817818819820821822823824825826827828829830831832833834835836837838839840841842843844845846847848849850851852853854855856857858859860861862863864865866867868869870871872873874875876877878879880881882883884885886887888889890891892893894895896897898899900901902903904905906907908909910911912913914915916917918919920921922923924925926927928929930931932933934935936937938939940941942943944945946947948949950951952953954955956957958959960961962963964965966967968969970971972973974975976977978979980981982983984985986987988989990991992993994995996997998999100010011002100310041005100610071008100910101011101210131014101510161017101810191020102110221023102410251026102710281029103010311032103310341035103610371038103910401041104210431044104510461047104810491050105110521053105410551056105710581059106010611062106310641065106610671068106910701071107210731074107510761077107810791080108110821083108410851086108710881089109010911092109310941095109610971098109911001101110211031104110511061107110811091110111111121113111411151116111711181119112011211122112311241125112611271128112911301131113211331134113511361137113811391140114111421143114411451146114711481149115011511152115311541155115611571158115911601161116211631164116511661167116811691170117111721173117411751176117711781179118011811182118311841185118611871188118911901191119211931194119511961197119811991200120112021203120412051206120712081209121012111212121312141215121612171218121912201221122212231224122512261227122812291230123112321233123412351236123712381239124012411242124312441245124612471248124912501251125212531254125512561257125812591260126112621263126412651266126712681269127012711272127312741275127612771278127912801281128212831284128512861287128812891290129112921293129412951296129712981299130013011302130313041305130613071308130913101311131213131314131513161317131813191320132113221323132413251326132713281329133013311332133313341335133613371338133913401341134213431344134513461347134813491350135113521353135413551356135713581359136013611362136313641365136613671368136913701371137213731374137513761377137813791380138113821383138413851386138713881389139013911392139313941395139613971398139914001401140214031404140514061407140814091410141114121413141414151416141714181419142014211422142314241425142614271428142914301431143214331434143514361437143814391440144114421443144414451446144714481449145014511452145314541455145614571458145914601461146214631464146514661467146814691470147114721473147414751476147714781479148014811482148314841485148614871488148914901491149214931494149514961497149814991500150115021503150415051506150715081509151015111512151315141515151615171518151915201521152215231524152515261527152815291530153115321533153415351536153715381539154015411542154315441545154615471548154915501551155215531554155515561557155815591560156115621563156415651566156715681569157015711572157315741575157615771578157915801581158215831584158515861587158815891590159115921593159415951596159715981599160016011602160316041605160616071608160916101611161216131614161516161617161816191620162116221623162416251626162716281629163016311632163316341635163616371638163916401641164216431644164516461647164816491650165116521653165416551656165716581659166016611662166316641665166616671668166916701671167216731674167516761677167816791680168116821683168416851686168716881689169016911692169316941695169616971698169917001701170217031704170517061707170817091710171117121713171417151716171717181719172017211722172317241725172617271728172917301731173217331734173517361737173817391740174117421743174417451746174717481749175017511752175317541755175617571758175917601761176217631764176517661767176817691770177117721773177417751776177717781779178017811782178317841785178617871788178917901791179217931794179517961797179817991800180118021803180418051806180718081809181018111812181318141815181618171818181918201821182218231824182518261827182818291830183118321833183418351836183718381839184018411842184318441845184618471848184918501851185218531854185518561857185818591860186118621863186418651866186718681869187018711872187318741875187618771878187918801881188218831884188518861887188818891890189118921893189418951896189718981899190019011902190319041905190619071908190919101911191219131914191519161917191819191920192119221923192419251926192719281929193019311932193319341935193619371938193919401941194219431944194519461947194819491950195119521953195419551956195719581959196019611962196319641965196619671968196919701971197219731974197519761977197819791980198119821983198419851986198719881989199019911992199319941995199619971998199920002001200220032004

  2.169

  2.169

```

1.  开始时间和停止时间是一样的。这是否意味着程序几乎不需要时间来完成执行？

2.  如果 1\. 为假，则至少 (.) 之外的位数应该不同，这里不会发生这种情况。我的逻辑正确吗？

**注意：**我需要计算执行时间，因此需要计算上面的代码。

* * *

## 回答 #1

> 赞同：96
> 
> 时间：2012-04-17T14:17:01.333

是的，这个程序可能使用了不到一毫秒。尝试将微秒分辨率与`timeval`.

例如：

```
#include <sys/time.h>

struct timeval stop, start;
gettimeofday(&start, NULL);
//do stuff
gettimeofday(&stop, NULL);
printf("took %lu us\n", (stop.tv_sec - start.tv_sec) * 1000000 + stop.tv_usec - start.tv_usec); 
```

然后，您可以查询`stop.tv_usec - start.tv_usec`. 请注意，这仅适用于亚秒级时间（`tv_usec`循环也会如此）。对于一般情况，使用`tv_sec`和的组合`tv_usec`。

**编辑 2016-08-19**

一个更合适的`clock_gettime`支持系统的方法是：

```
struct timespec start, end;
clock_gettime(CLOCK_MONOTONIC_RAW, &start);
//do stuff
clock_gettime(CLOCK_MONOTONIC_RAW, &end);

uint64_t delta_us = (end.tv_sec - start.tv_sec) * 1000000 + (end.tv_nsec - start.tv_nsec) / 1000; 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2015-07-27T11:45:13.380

此代码片段可用于以秒、毫秒和微秒为单位显示时间：

```
#include <sys/time.h>

struct timeval start, stop;
double secs = 0;

gettimeofday(&start, NULL);

// Do stuff  here

gettimeofday(&stop, NULL);
secs = (double)(stop.tv_usec - start.tv_usec) / 1000000 + (double)(stop.tv_sec - start.tv_sec);
printf("time taken %f\n",secs); 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2012-04-17T14:16:32.033

有几件事可能会影响您看到的结果：

1.  您将`clock_t`其视为浮点类型，我认为不是。
2.  `1^4`除了计算 1 和 4 的按位[异或](http://en.wikipedia.org/wiki/Exclusive_or)之外，您可能期望 ( ) 执行其他操作，即它是 5。
3.  由于 XOR 是常量，它可能[被编译器折叠](http://en.wikipedia.org/wiki/Constant_folding)，这意味着它不会在运行时增加很多工作。
4.  由于输出是缓冲的（它只是格式化字符串并将其写入内存），它确实很快完成。

你没有指定你的机器有多快，但在现代硬件上运行得非常快并不是不合理的，不。

如果有，请尝试`[sleep()](http://linux.die.net/man/3/sleep)`在开始/停止快照之间添加调用。请注意，这`sleep()`是 POSIX，而不是标准 C。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2014-12-12T17:29:59.030

您可以与下面`gettimeofday()`的函数一起使用`timedifference_msec()`来计算两个样本之间经过的毫秒数：

```
#include <sys/time.h>
#include <stdio.h>

float timedifference_msec(struct timeval t0, struct timeval t1)
{
    return (t1.tv_sec - t0.tv_sec) * 1000.0f + (t1.tv_usec - t0.tv_usec) / 1000.0f;
}

int main(void)
{
   struct timeval t0;
   struct timeval t1;
   float elapsed;

   gettimeofday(&t0, 0);
   /* ... YOUR CODE HERE ... */
   gettimeofday(&t1, 0);

   elapsed = timedifference_msec(t0, t1);

   printf("Code executed in %f milliseconds.\n", elapsed);

   return 0;
} 
```

请注意，在使用 时`gettimeofday()`，即使您只关心微秒差异，您也需要考虑秒数，因为`tv_usec`它将每秒返回到零，并且您无法事先知道在一秒钟内获得每个样本的时间点。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2017-07-04T03:01:11.857

这是我写的以百万秒为单位获取时间戳的内容。

```
#include<sys/time.h>

long long timeInMilliseconds(void) {
    struct timeval tv;

    gettimeofday(&tv,NULL);
    return (((long long)tv.tv_sec)*1000)+(tv.tv_usec/1000);
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-04-17T14:29:25.727

从[人钟](http://linux.die.net/man/3/clock)：

> clock() 函数返回程序使用的处理器时间的近似值。

因此，没有迹象表明您应该将其视为毫秒。一些标准需要 的精确值`CLOCKS_PER_SEC`，所以你*可以*依赖它，但我不认为这是可取的。第二件事是，正如@unwind 所说，它不是浮点数/双精度数。[Man times](http://linux.die.net/man/2/times)表明这将是一个 int。另请注意：

> 此函数将大约每 72 分钟返回一次相同的值

如果你不走运，你可能会碰到它即将从零开始计数的那一刻，从而得到负值或巨大值（取决于你将结果存储为有符号值还是无符号值）。

这：

```
printf("\n\n%6.3f", stop); 
```

很可能会打印垃圾，因为将任何 int 视为 float 确实是未定义的行为（我认为这是您的大部分问题所在）。如果你想确保你总是可以做到：

```
printf("\n\n%6.3f", (double) stop); 
```

虽然我宁愿一开始就打印它`long long int`：

```
printf("\n\n%lldf", (long long int) stop); 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2020-10-26T14:39:13.643

标准 C 库提供`timespec_get`. 如果系统支持，它可以将时间精确到纳秒。然而，调用它需要更多的努力，因为它涉及一个结构。这是一个仅将结构转换为简单的 64 位整数的函数，因此您可以获得以毫秒为单位的时间。

```
#include <stdio.h>
#include <inttypes.h>
#include <time.h>

int64_t millis()
{
    struct timespec now;
    timespec_get(&now, TIME_UTC);
    return ((int64_t) now.tv_sec) * 1000 + ((int64_t) now.tv_nsec) / 1000000;
}

int main(void)
{
    printf("Unix timestamp with millisecond precision: %" PRId64 "\n", millis());
} 
```

与 不同`clock`的是，此函数返回一个 Unix 时间戳，因此它将正确计算阻塞函数所花费的时间，例如`sleep`.

* * *

## 回答 #8

> 赞同：-9
> 
> 时间：2015-12-21T14:25:39.467

现代处理器速度太快，无法记录运行时间。因此它可能返回零。在这种情况下，您开始和结束的时间太小，因此在一轮之后两个时间都相同。

# ios - UITableView 一次只勾选一行

> ID：10192908
> 
> 赞同：21
> 
> 时间：2012-04-17T14:11:50.737
> 
> 标签：ios, xcode, ios4, ios5, xcode4

使用此代码，我可以检查表中的多行。

但我想要的是一次只检查一行。这是我的代码：

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {

    [tableView deselectRowAtIndexPath:indexPath animated:YES];

    UITableViewCell *theCell = [tableView cellForRowAtIndexPath:indexPath];

    if (theCell.accessoryType == UITableViewCellAccessoryNone) {
        theCell.accessoryType = UITableViewCellAccessoryCheckmark;
    } else if (theCell.accessoryType == UITableViewCellAccessoryCheckmark) {
        theCell.accessoryType = UITableViewCellAccessoryNone;
    }
} 
```

如果用户选择不同的行，那么我希望旧行简单地*自动*取消选中。不知道该怎么做。

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2013-08-01T18:40:45.003

目标-C：

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath   *)indexPath
{
     [tableView cellForRowAtIndexPath:indexPath].accessoryType = UITableViewCellAccessoryCheckmark;
}

-(void)tableView:(UITableView *)tableView didDeselectRowAtIndexPath:(NSIndexPath *)indexPath 
{
    [tableView cellForRowAtIndexPath:indexPath].accessoryType = UITableViewCellAccessoryNone;
} 
```

迅速：

```
func tableView(_ tableView: UITableView, didSelectRowAt indexPath: IndexPath) {
    tableView.cellForRow(at: indexPath)?.accessoryType = .checkmark
}

func tableView(_ tableView: UITableView, didDeselectRowAt indexPath: IndexPath) {
    tableView.cellForRow(at: indexPath)?.accessoryType = .none
} 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2013-03-15T07:18:37.010

您可以创建一个新变量来跟踪在 didSelectRowAtIndex 处选择的索引。

```
int selectedIndex; 
```

在你的 cellForRowAtIndexPath

```
if(indexPath.row == selectedIndex)
{
   cell.accessoryType = UITableViewCellAccessoryCheckmark;
}
else
{
   cell.accessoryType = UITableViewCellAccessoryNone;
} 
```

在你的 didSelectRowAtIndex

```
selectedIndex = indexPath.row;
[tableView reloadData]; 
```

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2012-04-17T14:22:43.603

最好的方法是在 中设置附件类型`cellForRowAtIndexPath`。

用于`didSelectRowAtIndexPath`仅记录**应**选择哪个路径然后调用`reloadData`.

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2015-12-10T04:20:51.163

您不需要（也不应该）在每次选择后重新加载表格。

Apple 有关于如何管理选择列表的良好[文档。](https://developer.apple.com/library/ios/documentation/UserExperience/Conceptual/TableView_iPhone/ManageSelections/ManageSelections.html)示例见清单 6-3。

这与其他一些答案或多或少相同，但我想我会添加更多细节。

您要做的是将当前选定的 IndexPath 保存到一个变量中，并在 didSelectRowAtIndexPath 中使用它来删除旧的复选标记。这也是您将添加新复选标记的地方。

您需要确保还设置/取消设置 cellForRowAtIndexPath 中的复选标记，否则如果您的列表很大并且单元格被重复使用，它看起来就像选择了多行。这是其他一些答案的问题。

请参阅下面的 swift 2.0 示例：

```
// for saving currently seletcted index path
var selectedIndexPath: NSIndexPath? = NSIndexPath(forRow: 0, inSection: 0)  // you wouldn't normally initialize it here, this is just so this code snip works
// likely you would set this during cellForRowAtIndexPath when you dequeue the cell that matches a saved user selection or the default

func tableView(tableView: UITableView, didSelectRowAtIndexPath indexPath: NSIndexPath) {
    // this gets rid of the grey row selection.  You can add the delegate didDeselectRowAtIndexPath if you want something to happen on deselection
    tableView.deselectRowAtIndexPath(indexPath, animated: true) // animated to true makes the grey fade out, set to false for it to immediately go away

    // if they are selecting the same row again, there is nothing to do, just keep it checked
    if indexPath == selectedIndexPath {
        return
    }

    // toggle old one off and the new one on
    let newCell = tableView.cellForRowAtIndexPath(indexPath)
    if newCell?.accessoryType == UITableViewCellAccessoryType.None {
        newCell?.accessoryType = UITableViewCellAccessoryType.Checkmark
    }
    let oldCell = tableView.cellForRowAtIndexPath(selectedIndexPath!)
    if oldCell?.accessoryType == UITableViewCellAccessoryType.Checkmark {
        oldCell?.accessoryType = UITableViewCellAccessoryType.None
    }

    selectedIndexPath = indexPath  // save the selected index path

    // do whatever else you need to do upon a new selection
}

func tableView(tableView: UITableView, cellForRowAtIndexPath indexPath: NSIndexPath) -> UITableViewCell {
    let cell = tableView.dequeueReusableCellWithIdentifier("Cell", forIndexPath: indexPath)
    // if this is the currently selected indexPath, set the checkmark, otherwise remove it
    if indexPath == selectedIndexPath {
        cell.accessoryType = UITableViewCellAccessoryType.Checkmark
    } else {
        cell.accessoryType = UITableViewCellAccessoryType.None
    }
} 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2013-07-09T04:48:46.147

您不需要重新加载 tableView。

请参阅以下代码：

为你的类声明一个 NSIndexPath`lastSelectedIndexPath`变量

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {

    if(lastSelectedIndexPath) {

        UITableViewCell *lastCell = [tableView cellForRowAtIndexPath:lastSelectedIndexPath];
        [lastCell setAccessoryView:nil];
    }

    UITableViewCell *currentCell = [tableView cellForRowAtIndexPath:currentIndexPath];
    [currentCell setAccessoryView:UITableViewCellAccessoryCheckmark];

    lastSelectedIndexPath = indexPath;
} 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2017-05-24T08:54:59.050

对于 Swift 3，以下对我有用：

```
override func viewDidLoad() {
    super.viewDidLoad()

    // allow cells to be selected
    tableView.allowsSelection = true

    // ensure that deselect is called on all other cells when a cell is selected
    tableView.allowsMultipleSelection = false
}

func tableView(_ tableView: UITableView, didSelectRowAt indexPath: IndexPath) {
    tableVIew.cellForRow(at: indexPath as IndexPath)?.accessoryType = .checkmark
}

func tableView(_ tableView: UITableView, didDeselectRowAt indexPath: IndexPath) {
    tableVIew.cellForRow(at: indexPath as IndexPath)?.accessoryType = .none
} 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2012-06-07T09:26:12.153

我认为[https://stackoverflow.com/a/5960016/928599](https://stackoverflow.com/a/5960016/928599)会帮助你。
我使用了它，它也适用于 deselectRowAtIndexPath！

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2013-06-12T11:56:10.283

最简单的方法是保存选定的 IndexPath 并将其签入`cellForRowAtIndexPath`：

1.  初始化选定的索引路径：

    ```
    selectedIndexPath = [[NSIndexPath alloc] init]; 
    ```

2.  在`cellForRowAtIndexPath`：

    ```
    if([selectedIndexPath isEqual:indexPath]){
        [checkMark setHidden:NO];
    } else {
        [checkMark setHidden:YES];
    } 
    ```

3.  在`didSelectRowAtIndexPath`：

    ```
    selectedIndexPath = indexPath;
    [tableView reloadData]; 
    ```

它应该可以工作试试这个 Njoy :)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2015-05-15T02:32:23.590

试试这个：

```
func tableView(tableView: UITableView, didSelectRowAtIndexPath indexPath: NSIndexPath) {
    if indexPath.section == 1 {
        // un-select the older row
        if let selected = self.LastSelected {
            tableView.cellForRowAtIndexPath(selected)?.accessoryType = .None
        }

        // select the new row
        tableView.cellForRowAtIndexPath(indexPath)?.accessoryType = UITableViewCellAccessoryType.Checkmark
        self.LastSelected = indexPath
    }
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2016-03-24T12:37:37.837

在 Swift 中，以下工作完美：

```
lastSelectedIndexPath = NSIndexPath(forRow: 1, inSection: 0)//Row will be the previous selected row

    func tableView(tableView: UITableView, cellForRowAtIndexPath indexPath: NSIndexPath) -> UITableViewCell
{
    let cell:LabelsSelectionCell = tableView.dequeueReusableCellWithIdentifier("LabelsSelectionCell", forIndexPath: indexPath) as! LabelsSelectionCell
    cell.setCellLael(labelOptionsArray[indexPath.row])
    if lastSelectedIndexPath == indexPath
    {
        cell.setCellCheckedStatus(true)
    }
    return cell
}
func tableView(tableView: UITableView, didSelectRowAtIndexPath indexPath: NSIndexPath)
{
    if let _ = lastSelectedIndexPath
    {
        let lastCell:LabelsSelectionCell = tableView.cellForRowAtIndexPath(lastSelectedIndexPath!) as! LabelsSelectionCell
        lastCell.setCellCheckedStatus(false)
    }
    let currentCell:LabelsSelectionCell = tableView.cellForRowAtIndexPath(indexPath) as! LabelsSelectionCell
    currentCell.setCellCheckedStatus(true)

    lastSelectedIndexPath = indexPath

    tableView.deselectRowAtIndexPath(indexPath, animated: true)
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-02-24T13:52:25.047

斯威夫特 iOS

```
 var checkedIndexPath : NSIndexPath?

// table row which row was selected
func tableView(tableView: UITableView, didSelectRowAtIndexPath indexPath: NSIndexPath!) {
    tableView.deselectRowAtIndexPath(indexPath, animated: true)

    println("Section #\(indexPath.section)! You selected cell #\(indexPath.row)!")

    if (self.checkedIndexPath != nil) {
        var cell = tableView.cellForRowAtIndexPath(self.checkedIndexPath!)
        cell?.accessoryType = .None
    }

    var cell = tableView.cellForRowAtIndexPath(indexPath)
    cell?.accessoryType = .Checkmark

    self.checkedIndexPath = indexPath

}// end tableView 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-02-17T19:57:18.850

在 Swift 2.0 中，我使用了这个：

```
func tableView(tableView: UITableView, didSelectRowAtIndexPath indexPath: NSIndexPath) {

    if((lastSelectedIndexPath) != nil) {
        let lastCell = tableView.cellForRowAtIndexPath(lastSelectedIndexPath)
        lastCell?.accessoryType = UITableViewCellAccessoryType.None
    }

    let currentCell = tableView.cellForRowAtIndexPath(indexPath)
    currentCell?.accessoryType = UITableViewCellAccessoryType.Checkmark

    lastSelectedIndexPath = indexPath

} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2016-12-20T09:13:32.633

我的方法是在选择过程中取消选择其他单元格：

```
func tableView(_ tableView: UITableView, cellForRowAt indexPath: IndexPath) -> UITableViewCell {
    let cell = ....

    if condition {
        cell.accessoryType = .checkmark
        tableView.selectRow(at: indexPath, animated: false, scrollPosition: UITableViewScrollPosition.bottom)
    } else {
        cell.accessoryType = .none
    }

    return cell
}

func tableView(_ tableView: UITableView, didSelectRowAt indexPath: IndexPath) {
    for row in 0...tableView.numberOfRows(inSection: 0) {
        if row == indexPath.row {continue}
        tableView.deselectRow(at: IndexPath(row: row, section: 0), animated: true)
    }

    if let cell = tableView.cellForRow(at: indexPath) {
        cell.accessoryType = .checkmark
    }
}

func tableView(_ tableView: UITableView, didDeselectRowAt indexPath: IndexPath) {
    let cell = tableView.cellForRow(at: indexPath)
    cell?.accessoryType = .none
} 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2017-06-30T03:24:13.743

这是我遇到这个问题时想到的。
截至今天，此代码在最新版本的 Swift 中实现...
有关更多信息和/或扩展文件，请查看此代码段的[Github Gist](https://gist.github.com/gchriswill/7d168f35f7bc777812e04870170c0d3e)。

```
override func tableView(_ tableView: UITableView, didSelectRowAt indexPath: IndexPath) {       
    if let sip = selectedIndex {
        tableView.deselectRow(at: sip, animated: false)
    }
    selectedIndex = indexPath
}

override func tableView(_ tableView: UITableView, didDeselectRowAt indexPath: IndexPath) {
    if selectedIndex?.row == indexPath.row {
        selectedIndex = nil
    }
} 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2017-08-17T07:58:53.550

测试并解决了试试这个它工作得很好

> 将此添加为全局变量

```
var selectedIndexPath = NSIndexPath(row: 0, section: 0) 
```

> 在 didselect 方法中添加这个

```
 // old one check off
        if indexPath != selectedIndexPath as IndexPath {
            let oldCell = categorytable.cellForRow(at: selectedIndexPath as IndexPath)
            if oldCell?.accessoryView != nil {
                oldCell?.accessoryView = nil
            }
            else {
                let imageName = "checkmark"
                let image: UIImageView = UIImageView(image: UIImage(named: imageName))
                cell.accessoryView = image
            }
        }
        // the new one on

        if  cell.accessoryView == nil {
            let imageName = "checkmark"
            let image: UIImageView = UIImageView(image: UIImage(named: imageName))
            cell.accessoryView = image
        }
        else {
            cell.accessoryView = nil
        } 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2019-10-18T13:23:48.930

您可以在一行代码中以自定义单元格类型执行此操作。

```
final class CheckableTableViewCell: UITableViewCell {

  override func setSelected(_ selected: Bool, animated: Bool) {
    super.setSelected(selected, animated: animated)

    self.accessoryType = selected ? .checkmark : .none
  }

} 
```

要使此方法起作用 - 应选择您的单元格。

如果您不想看到所选单元格的突出显示，只需在情节提要或代码中将单元格的 selectionStyle 设置为 .none

如果您要调用，此方法将不起作用

```
tableView.deselectRow(at: indexPath, animated: true) 
```

也适用于多项选择。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2021-01-03T20:22:30.757

jeffjv 响应的 Swift 5 版本。

```
// for saving currently selected index path
var selectedIndexPath: NSIndexPath? = NSIndexPath(forRow: 0, inSection: 0)  // you wouldn't normally initialize it here, this is just so this code snip works
// likely you would set this during cellForRowAtIndexPath when you dequeue the cell that matches a saved user selection or the default

func tableView(tableView: UITableView, didSelectRowAtIndexPath indexPath: IndexPath) {
    // this gets rid of the grey row selection.  You can add the delegate didDeselectRowAtIndexPath if you want something to happen on deselection
    tableView.deselectRow(at: indexPath, animated: true) // animated to true makes the grey fade out, set to false for it to immediately go away

    // if they are selecting the same row again, there is nothing to do, just keep it checked
    if indexPath == selectedIndexPath! as IndexPath {
        return
    }

    // toggle old one off and the new one on
    let newCell = tableView.cellForRow(at: indexPath)
    if newCell?.accessoryType == UITableViewCell.AccessoryType.None {
        newCell?.accessoryType = UITableViewCell.AccessoryType.Checkmark
    }
    let oldCell = tableView.cellForRow(at: selectedIndexPath! as IndexPath)
    if oldCell?.accessoryType == UITableViewCell.AccessoryType.Checkmark {
        oldCell?.accessoryType = UITableViewCell.AccessoryType.None
    }

    selectedIndexPath = indexPath as NSIndexPath  // save the selected index path

    // do whatever else you need to do upon a new selection
}

func tableView(tableView: UITableView, cellForRowAtIndexPath indexPath: IndexPath) -> UITableViewCell {
    let cell = tableView.dequeueReusableCellWithIdentifier("Cell", forIndexPath: indexPath)
    // if this is the currently selected indexPath, set the checkmark, otherwise remove it
     if indexPath == selectedIndexPath! as IndexPath {
        cell.accessoryType = UITableView.CellAccessoryType.Checkmark
    } else {
        cell.accessoryType = UITableView.CellAccessoryType.None
    }
} 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2021-10-04T20:46:18.453

存储选定的索引路径，在 中更新它`didSelectRowAt:`，然后从那里调用`reloadRows(at:`以仅重新加载旧的和新的检查行（而不是整个表视图）：

```
var selectedIndexPath: IndexPath?

override func tableView(_ tableView: UITableView, didSelectRowAt indexPath: IndexPath) {
    let previous = selectedIndexPath
    selectedIndexPath = indexPath

    let allowDeselection = true // optional behavior
    if allowDeselection && previous == selectedIndexPath {
        selectedIndexPath = nil
    }

    tableView.reloadRows(at: [previous, selectedIndexPath].compactMap({ $0 }), with: .automatic)
    tableView.deselectRow(at: indexPath, animated: true)
} 
```

处理复选标记附件视图的设置`cellForRowAt indexPath:`。这将考虑到单元重用，并且还会由您对 的上述调用触发`reloadRows(at:`，避免重复设置单元附件的代码：

```
override func tableView(_ tableView: UITableView, cellForRowAt indexPath: IndexPath) -> UITableViewCell {
    let cell = tableView.dequeueReusableCell(withIdentifier: "IDENTIFIER", for: indexPath)

    cell.accessoryType = (indexPath == selectedIndexPath) ? .checkmark : .none

    // ...

    return cell
} 
```

# java - 为 ResponseEntity< HashMap 生成 XML 响应的 Restful 服务端点 >

> ID：10192909
> 
> 赞同：1
> 
> 时间：2012-04-17T14:11:55.990
> 
> 标签：java, spring, rest

我正在尝试实现一个产生 XML 响应的 RESTful 服务端点。此服务调用的返回实体是一个 HashMap，其中包含要生成的输出的数据。但是我在调​​用服务时不断收到以下异常：

> HttpMediaTypeNotAcceptableException：找不到可接受的表示

为了调查这个问题，我编写了另一个端点，它为单个对象（比如员工）产生响应。我已经用注释这个类`@XmlRootElement`并调用它工作得很好。如果我`@XmlRootElement`从 Employee 类中删除注释，此端点也会失败并给出我上面提到的相同异常。

根据我的理解，根对象`ResponseEntity`应该用`@XmlRootElement`. 我的问题集中在如何在 Map、List 等集合上使用此注释。

感谢所有帮助，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T12:44:59.267

我认为这是不可能的——您很可能必须在您的 Collection/Map 周围创建某种包装器或 DTO。这：[使用 JAXB 解组/编组 List<String>](https://stackoverflow.com/questions/1603404/using-jaxb-to-unmarshal-marshal-a-liststring)我相信与您的用例有关。

# jakarta-ee - 在容器内的 Java EE 应用程序中访问 hbase（使用 JPA、JDO 或任何其他方式）

> ID：10192911
> 
> 赞同：2
> 
> 时间：2012-04-17T14:12:04.260
> 
> 标签：jakarta-ee, jpa, jdo, hbase, datanucleus

如何在容器（例如 glassfish、jboss 等）内的 Java EE 应用程序中访问 hbase（使用 JPA、JDO 或任何其他方式）？如何在容器内建立连接池？我已经尝试过 datanucleus，但它的文档和示例并没有满足这个要求。此外，datanucleus 层使 hbase 访问速度比 hbase 自己的客户端 API 慢，而且我找不到在其中创建连接池的方法（到 hbase）。请提供任何链接以深入研究它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-18T13:50:15.897

正如评论中已经回答的那样，默认客户端在许多情况下是可以接受的（请参阅[包摘要](http://hbase.apache.org/apidocs/org/apache/hadoop/hbase/client/package-summary.html)）。简单的用例是使用 HBaseAdmin 创建/管理表和使用[HTable](http://hbase.apache.org/apidocs/org/apache/hadoop/hbase/client/HTable.html)[扫描](http://hbase.apache.org/apidocs/org/apache/hadoop/hbase/client/HBaseAdmin.html)/插入。需要手动投入资源或指定连接属性。`hbase-site.xml`

还有另一个客户端 - [Asynchbase](https://github.com/OpenTSDB/asynchbase)，它允许以异步方式使用 HBase。这里的入口点是`HBaseClient`类（它不使用 conf 文件，在代码中指定属性）。

# mysql - 如何用mysql解析url？

> ID：10192913
> 
> 赞同：1
> 
> 时间：2012-04-17T14:12:05.780
> 
> 标签：mysql, sql-server, function, stored-procedures, parse-url

`Mssql`有一个功能`parseURL`。
但是我们已经将我们的数据库`mssql`从`mysql`.

Mysql 没有`parse url`，现在我们需要`parseURL`手动创建函数。

如何在中创建`parse url`函数`mysql`？

这是 mssql 函数

`

```
SET QUOTED_IDENTIFIER ON  
SET ANSI_NULLS ON  
GO  
CREATE      FUNCTION [dbo].[parseURL]  (@strURL varchar(1000))  
RETURNS varchar(1000)  
AS  
BEGIN  
IF CHARINDEX('http://',@strURL) > 0 OR CHARINDEX('https://',@strURL) > 0  
-- Ghetto-tastic  
SELECT @strURL = REPLACE(@strURL,'https://','')  
SELECT @strURL = REPLACE(@strURL,'http://','')  
SELECT @strURL = REPLACE(@strURL,'www','')  
-- Remove everything after "/" if one exists  
IF CHARINDEX('/',@strURL) > 0 (SELECT @strURL = LEFT(@strURL,CHARINDEX('/',@strURL)-1))  

-- Optional: Remove subdomains but differentiate between www.google.com and www.google.com.au  
IF (LEN(@strURL)LEN(REPLACE(@strURL,'.','')))/LEN('.') < 3 - if there are less than 3 periods  
SELECT @strURL = PARSENAME(@strURL,2) + '.' + PARSENAME(@strURL,1)  
ELSE -- It's likely a google.co.uk, or google.com.au  
SELECT @strURL = PARSENAME(@strURL,3) + '.' + PARSENAME(@strURL,2) + '.' + PARSENAME(@strURL,1)  
RETURN @strURL  
END  
GO 
```

`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T14:16:16.487

SQL Server 也没有调用函数`parseURL`。无论你在哪里调用这个函数，运行：

```
EXEC sp_helptext 'parseURL'; 
```

如果您向我们展示函数的定义，我们可以帮助您翻译它并为 MySQL 创建一个等效函数。

# android - Android AsyncTask 在第二次调用时未执行

> ID：10192916
> 
> 赞同：2
> 
> 时间：2012-04-17T14:12:10.283
> 
> 标签：android, json, android-asynctask

我有一个扩展 AsyncTask 的类

```
public class SendJSONArray2Server extends AsyncTask<String, Void, HttpResponse> 
```

该类将 JSONArray 发送到服务器并以 JSONArray 的形式接收响应。我已按如下方式实例化了该类

```
private SendJSONArray2Server sendJSON;
String[] params = { "http://10.0.2.2:8084/xyz/abc",jsonArray.toString() };
sendJSON.execute(params); 
```

在 onPostExecute 我处理用户响应

```
@Override
protected void onPostExecute(HttpResponse response) 
```

AsyncTask 第一次像魅力一样执行，我收到了来自服务器的响应，但是当我第二次尝试将 JSONArray 发送到服务器时，AsyncTask 没有执行。

我在 logcat 中没有收到任何异常或错误。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-17T14:15:51.543

创建异步任务的单独实例并尝试像这样执行..

```
 new MyAsyncTask().execute(params); 
```

因为**Asynctask 只能执行一次（如果尝试第二次执行会抛出异常）**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T14:31:51.417

您不能多次运行 AsyncTask。为每次运行创建一个单独的实例。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-17T14:14:53.060

AsyncTask 只能执行一次。确保您没有错过控制台中抛出的异常。我查看了实际执行的方法的源代码并将其粘贴在下面。如您所见，当您尝试第二次执行它时将引发异常。

```
public final AsyncTask<Params, Progress, Result> executeOnExecutor(Executor exec,
        Params... params) {
    if (mStatus != Status.PENDING) {
        switch (mStatus) {
            case RUNNING:
                throw new IllegalStateException("Cannot execute task:"
                        + " the task is already running.");
            case FINISHED:
                throw new IllegalStateException("Cannot execute task:"
                        + " the task has already been executed "
                        + "(a task can be executed only once)");
        }
    }

    mStatus = Status.RUNNING;

    onPreExecute();

    mWorker.mParams = params;
    exec.execute(mFuture);

    return this;
} 
```

# drupal - 需要编辑“用户配置文件”页面的一部分 - DRUPAL 6

> ID：10192917
> 
> 赞同：0
> 
> 时间：2012-04-17T14:12:18.120
> 
> 标签：drupal, drupal-6

我在我的 drupal 网站中进行了搜索，该网站搜索在我的网站（查找器模块）中注册的用户。从用户搜索结果中单击任何用户后，它会转到该用户的个人资料页面。

在该页面的顶部，会显示一个文本“关系”。在它下面有一个链接，上面写着“成为 X 的朋友”（X 是 drupal 生成的用户名）。现在，'X' 是用户注册到站点时由 drupal 生成的默认名称。用户有自己的实名（存储在实名表中）。所以我想将链接显示为“成为 XYZ 的朋友”（X 的真名）。我应该在哪里编辑代码？在哪个php文件中？？

示例：对于用户 John Smith，链接将是“成为 john225de 的朋友”，而我希望它类似于“成为 John Smith 的朋友”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T09:58:39.083

你可以看到[这个视频播客](http://mustardseedmedia.com/podcast/episode21)。我认为它可以帮助你实现目标。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T09:29:15.087

您是否使用心跳模块来处理用户关系？一旦我也面临同样的问题，所以我将 user_relationships 与活动模块一起使用并解决了问题。

# c# - 从 C# 中的 div 中删除类

> ID：10192919
> 
> 赞同：3
> 
> 时间：2012-04-17T14:12:24.560
> 
> 标签：c#, css

我尝试使用 server-side `.CssClass`，但这不适用于我。我的 div 有`runat="server"`，所以我可以访问它，但是当我点击“。”时，我无法`.CssClass`在下拉列表中看到。有谁知道如何克服这个或任何其他可能有效的解决方案？

好吧，我的错。我刚刚发现这不适用于 HTML 控件，仅适用于 asp 控件

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-17T14:28:45.297

如果您想读取类名，则需要使用代码：

```
string className = Test.Attributes["class"].ToString(); 
```

如果要替换特定类，则需要使用以下代码：

```
Test.Attributes.Add("class", Test.Attributes["class"].ToString().Replace("spacerDiv", "")); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-04-17T14:15:00.653

```
HTML
<div id="Test" runat="server"></div> 
```

代码背后

```
add =>       Test.Attributes.Add("class", "myClass")

remove =>    Test.Attributes.("class") = ""; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-08-07T12:13:11.080

这将更具体：

HTML

```
<div id="Test" runat="server"></div> 
```

服务器代码：

```
Test.Attributes.Remove("class"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-12-04T13:16:21.603

这与 Tim 的解决方案相同，但我删除了不需要的 toString 方法。

```
myDiv.Attributes.Add("class", myDiv.Attributes["class"].Replace("spacerDiv", "")); 
```

将类添加到 div 有点相同。

```
myDiv.Attributes.Add("class", "spacerDiv"); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-07-31T08:53:40.443

**删除 CSS 类**

myDiv.Attributes["class"]="";

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-12-09T06:18:01.440

为任何 HtmlGenericControl 添加或删除类的更好方法是使用如下提供的扩展：

```
 public static void RemoveCssClass(this HtmlGenericControl controlInstance, string css)
    {
        var strCssClass = controlInstance.Attributes["class"];
        controlInstance.Attributes["class"] = string.Join(" ", strCssClass.Split(' ').Where(x => x != css).ToArray());
    }

    public static void AddCssClass(this HtmlGenericControl controlInstance, string css)
    {
        var strCssClass = controlInstance.Attributes["class"];
        controlInstance.Attributes["class"] = string.Join($" {css} ", strCssClass.Split(' ').ToArray());
    } 
```

对于 WebControl，相同的代码可以修改如下：

```
public static void RemoveCssClass(this WebControl controlInstance, string css)
        {
            controlInstance.CssClass = string.Join(" ", controlInstance.CssClass.Split(' ').Where(x => x != css).ToArray());
        }

    public static void AddCssClass(this WebControl controlInstance, string css)
    {
        controlInstance.CssClass = string.Join($" {css} ", controlInstance.CssClass.Split(' ').ToArray());
    } 
```

# django - Django admin - 如何更改内联选项？

> ID：10192920
> 
> 赞同：3
> 
> 时间：2012-04-17T14:12:25.757
> 
> 标签：django, django-admin

如何更改 Inlines 类中字段的选择？我不能在 Inlines 中使用 formfield_for_choice_field，那该怎么用呢？我必须在管理员中生成它，因为我需要通过请求。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-18T16:43:19.030

如果您的字段是具有选择属性的 IntegerField 或 Charfield，您可以使用以下内容覆盖内联类中的**formfield_for_choice_field**方法：

```
class YourInline(admin.StackedInline): # or TabularInline
    model = YourModelName

    def formfield_for_choice_field(self, db_field, request=None, **kwargs):
        if db_field.name == 'YOUR_FIELD_NAME':
            kwargs['choices'] = (('', '---------'), ('1', 'Choice1'), ('2', 'Choice2'))
        return db_field.formfield(**kwargs) 
```

祝你好运

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-01-31T06:01:17.587

就我而言，必须填写表格选项，希望对任何人有所帮助。

```
# admin.py
class YourInlineForm(forms.ModelForm):
    class Meta:
        fields = '__all__'
        model = YourModelName
        widgets = {
            'level': forms.widgets.Select(
                choices = (
                    (0,'A'),
                    (1,'B'),
                    (2,'C'),
                ),
            )
        }

# admin.py
class YourInline(admin.StackedInline): # or TabularInline
    model = YourModelName
    form = YourInlineForm

    def formfield_for_choice_field(self, db_field, request=None, **kwargs):
        if db_field.name == 'YOUR_FIELD_NAME':
            kwargs['choices'] = (('', '---------'), ('1', 'Choice1'), ('2', 'Choice2'))
        return db_field.formfield(**kwargs) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-10-08T16:17:23.517

我同意eos87的回答。然而，这只是部分解决方案。保存时，会出现验证错误，因为原始模型的选择正在用于验证。要解决该问题，请将此函数添加到您的模型中：

```
def clean_fields(self, exclude=None):
    exclude.append('YOUR_FIELD_NAME') # we will do our own validation on this field
    super(YOUR_MODEL, self).clean_fields(exclude = exclude)

    value = self.YOUR_FIELD_NAME
    if value and not self.validChoice(value):
        msg = 'Select a valid choice. %s is not one of the available choices.'
        errors = {''YOUR_FIELD_NAME'': ([msg % value])}
        raise ValidationError(errors)

def validChoice(self, value):
  # add your validation code here 
```

# actionscript-3 - Shape、Sprite、MovieClip 等显示对象：何时使用？

> ID：10192923
> 
> 赞同：3
> 
> 时间：2012-04-17T14:12:31.673
> 
> 标签：actionscript-3, flash, optimization, displayobject

包中有大量的显示对象`flash.display`。我不清楚在什么情况下应该使用`Shape`,`Sprite`或`MovieClip`. 使用它们的优点和缺点是什么？

先感谢您！！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-17T14:23:20.127

*   [形状](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/display/Shape.html)是您可以在舞台上添加的最简单的显示对象。它是最受限制的一个：您不能向其中添加子项（不扩展 DisplayObjectContainer），不具有交互性（不扩展 InteractiveObject），没有时间轴
*   [Sprite](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/display/Sprite.html)扩展了 DisplayObjectContainer 和 InteractiveObject，因此它是交互式的，您可以向其添加子对象。在我看来，这是最有用的展示类，只要你不需要时间线。
*   [MovieClip](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/display/MovieClip.htmlhttp://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/display/MovieClip.html)扩展了 Sprite，因此上述所有内容都是正确的，并且您还可以获得与时间线控制相关的方法/属性，但请注意，它是一个**动态**类，因此您可以在运行中做一些 hacky 的事情，但您会失去速度。

简而言之，在大多数情况下坚持使用 Sprite，除非您需要与 Flash Authoring 的 MovieClips 集成。形状很方便快速绘制，它比 Sprite 更“轻”，但不是很灵活，因为您不能在其中嵌套其他元素。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-17T14:23:54.153

您应该始终根据需要使用最轻的组件：

*   `Shape`是可能性最小的一个。当您只需要`DisplayObject`with`graphics`且没有鼠标交互时使用它。
*   `Sprite`是你需要的一切的父类。由于它是一个`DisplayObjectContainer`，您可以将其用作其他组件的基本容器。您还可以在此捕获鼠标事件。
*   `MovieClip`是一个`Sprite`具有使用框架的能力。仅用于逐帧动画（Flash 风格）。

# php - 清漆一直缺少缓存，cookies？

> ID：10192924
> 
> 赞同：5
> 
> 时间：2012-04-17T14:12:33.543
> 
> 标签：php, varnish

我在正确缓存清漆时遇到了一些麻烦。

当我转到一个页面并点击 refresh 时，varnish 将返回缓存的页面。但是，如果我使用另一台计算机并再次访问同一页面（在缓存时间范围内），它将报告 MISS。

[我使用了来自http://www.unixy.net/varnish](http://www.unixy.net/varnish)的 cpanel varnish 插件
我从我的 (php) 页面中删除了 session_start() 并且我不需要基于用户的 cookie。
我也在使用谷歌分析。

这是我的 default.vcl

```
###################################################
# Copyright (c) UNIXY  -  http://www.unixy.net    #
# The leading truly fully managed server provider #
###################################################

include "/etc/varnish/cpanel.backend.vcl";

include "/etc/varnish/backends.vcl";

sub vcl_recv {

# Use the default backend for all other requests
set req.backend = default;

# Setup the different backends logic
include "/etc/varnish/acllogic.vcl";

# Allow a grace period for offering "stale" data in case backend lags
set req.grace = 5m;

remove req.http.X-Forwarded-For;
set req.http.X-Forwarded-For = client.ip;

# cPanel URLs
include "/etc/varnish/cpanel.url.vcl";

# Properly handle different encoding types
if (req.http.Accept-Encoding) {
    if (req.url ~ "\.(jpg|jpeg|png|gif|gz|tgz|bz2|tbz|mp3|ogg|swf|ico)$") {
        # No point in compressing these
        remove req.http.Accept-Encoding;
    } elsif (req.http.Accept-Encoding ~ "gzip") {
        set req.http.Accept-Encoding = "gzip";
    } elsif (req.http.Accept-Encoding ~ "deflate") {
        set req.http.Accept-Encoding = "deflate";
    } else {
        # unkown algorithm
        remove req.http.Accept-Encoding;
    }
}

# Set up disabled
include "/etc/varnish/disabled.vcl";

# Exclude upgrade, install, server-status, etc
include "/etc/varnish/known.exclude.vcl";

# Set up exceptions
include "/etc/varnish/url.exclude.vcl";

# Set up exceptions
include "/etc/varnish/vhost.exclude.vcl";

# Set up vhost+url exceptions
include "/etc/varnish/vhosturl.exclude.vcl";

# Set up cPanel reseller exceptions
include "/etc/varnish/reseller.exclude.vcl";

# Restart rule for bfile recv
include "/etc/varnish/bigfile.recv.vcl";

if (req.request == "PURGE") {
        if (!client.ip ~ acl127_0_0_1) {error 405 "Not permitted";}
        return (lookup);
}

## Default request checks
if (req.request != "GET" &&
req.request != "HEAD" &&
req.request != "PUT" &&
req.request != "POST" &&
req.request != "TRACE" &&
req.request != "OPTIONS" &&
req.request != "DELETE") {
    return (pipe);
}

if (req.request != "GET" && req.request != "HEAD") {
    return (pass);
}

## Modified from default to allow caching if cookies are set, but not http auth
if (req.http.Authorization) {
    return (pass);
}

include "/etc/varnish/versioning.static.vcl";

## Remove has_js and Google Analytics cookies.
set req.http.Cookie = regsuball(req.http.Cookie, "(^|;\s*)(__[a-z]+|has_js)=[^;]*", "");

set req.http.Cookie = regsub(req.http.Cookie, "^;\s*", "");

if (req.http.Cookie ~ "^\s*$") {
    unset req.http.Cookie;
}

include "/etc/varnish/slashdot.recv.vcl";

# Cache things with these extensions
if (req.url ~ "\.(js|css|jpg|jpeg|png|gif|gz|tgz|bz2|tbz|mp3|ogg|swf|pdf)$" && ! (req.url ~ "\.(php)") ) {
    unset req.http.Cookie;
    return (lookup);
}

return (lookup);
}

sub vcl_fetch {

set beresp.ttl = 40s;
set beresp.http.Server = " - Web acceleration by http://www.unixy.net/varnish ";

# Turn off Varnish gzip processing
include "/etc/varnish/gzip.off.vcl";

# Grace to allow varnish to serve content if backend is lagged
set beresp.grace = 5m;

# Restart rule bfile for fetch
include "/etc/varnish/bigfile.fetch.vcl";

# These status codes should always pass through and never cache.
if (beresp.status == 503 || beresp.status == 500) {
    set beresp.http.X-Cacheable = "NO: beresp.status";
    set beresp.http.X-Cacheable-status = beresp.status;
    return (hit_for_pass);
}

if (beresp.status == 404) {
    set beresp.http.magicmarker = "1";
    set beresp.http.X-Cacheable = "YES";
    set beresp.ttl = 20s;
    return (deliver);
}

/* Remove Expires from backend, it's not long enough */    
unset beresp.http.expires;

if (req.url ~ "\.(js|css|jpg|jpeg|png|gif|gz|tgz|bz2|tbz|mp3|ogg|swf|pdf|ico)$" && ! (req.url ~ "\.(php)") ) {
    unset beresp.http.set-cookie;
    include "/etc/varnish/static.ttl.vcl";
}
include "/etc/varnish/slashdot.fetch.vcl"; 
else {
    include "/etc/varnish/dynamic.ttl.vcl";
}

/* marker for vcl_deliver to reset Age: */
set beresp.http.magicmarker = "1";

# All tests passed, therefore item is cacheable
set beresp.http.X-Cacheable = "YES";

return (deliver);
}

sub vcl_deliver {

  # From http://varnish-cache.org/wiki/VCLExampleLongerCaching
  if (resp.http.magicmarker) {
     /* Remove the magic marker */
     unset resp.http.magicmarker;

     /* By definition we have a fresh object */
     set resp.http.age = "0";
   }

   #add cache hit data
   if (obj.hits > 0) {
     #if hit add hit count
     set resp.http.X-Cache = "HIT";
     set resp.http.X-Cache-Hits = obj.hits;
   }
else {
     set resp.http.X-Cache = "MISS";
   }

}

sub vcl_error {

if (obj.status == 503 && req.restarts < 5) {
set obj.http.X-Restarts = req.restarts;
return (restart);
}

}

# Added to let users force refresh
sub vcl_hit {

if (obj.ttl < 1s) {
    return (pass);
}

if (req.http.Cache-Control ~ "no-cache") {
# Ignore requests via proxy caches,  IE users and badly behaved crawlers
# like msnbot that send no-cache with every request.
if (! (req.http.Via || req.http.User-Agent ~ "bot|MSIE|HostTracker")) {
    set obj.ttl = 0s;
    return (restart);
} 
}

return (deliver);

}

sub vcl_hash {

    hash_data(req.http.cookie);
} 
```

我的标题（在第二台计算机上）：

```
http://www.subtitleseeker.com/

GET / HTTP/1.1
Host: www.subtitleseeker.com
User-Agent: Mozilla/5.0 (Windows NT 5.1; rv:11.0) Gecko/20100101 Firefox/11.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-us,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: keep-alive
Referer: http://www.subtitleseeker.com/search/
Cookie: __utma=107027200.157820436.1334670333.1334670333.1334670333.1; __utmb=107027200.51.10.1334670333; __utmz=107027200.1334670333.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none); __utmc=107027200; __unam=4ca9c7b-136c095f22c-1396bc94-1

HTTP/1.1 200 OK
X-Powered-By: PHP/5.3.8
Vary: User-Agent,Accept-Encoding
Content-Encoding: gzip
Content-Type: text/html
Server: - Web acceleration by http://www.unixy.net/varnish
X-Cacheable: YES
Content-Length: 8169
Accept-Ranges: bytes
Date: Tue, 17 Apr 2012 14:10:12 GMT
X-Varnish: 916645159
Via: 1.1 varnish
Connection: keep-alive
Age: 0
X-Cache: MISS 
```

有人可以向我解释为什么会发生这种情况以及我应该改变什么吗？

谢谢 ！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T15:03:15.663

这是因为谷歌分析。即使您的 Web 应用程序不使用 cookie，您的分析 JavaScript 也会使用。结果是一样的，Varnish 会将请求传递给后端并避免使用它的缓存。

要解决此问题，请定义您的 Web 应用程序的 URL，您必须使用 cookie（例如管理面板）和不使用的位置（在这里您可以忽略 Google Analytics 的要求。大多数 Web 分析工具只需要浏览器和 JavaScript 之间的 cookie .)。

下面你可以看到一个 Varnish 配置文件的例子。有趣的是，对于您网站的非管理部分：发送的 cookie 以及一些新内容的浏览器请求标头将被删除。

```
sub vcl_recv {
  # regex to find all URLs where cookies are required
  if (req.url ~ "^/admin/") {
    # administration panel
    set req.http.admin = 1;
  } else {
    # public web site, ignore client request for fresh content, remove cookies
    unset req.http.Cache-Control;
    unset req.http.Max-Age;
    unset req.http.Pragma;
    unset req.http.Cookie;
  }
  ...
}

sub vcl_fetch {
  if (req.http.admin == 1) {
    # administration panel
    return (hit_for_pass);
  } else {
    # public web site, not allowed to set cookies
    unset beresp.http.Set-Cookie;
    ...
  }
  ...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T08:27:29.767

您可以使用`varnishlog`命令行工具来观察 Varnish 在处理每个请求时正在做什么。例如，您可以查看是否有任何 cookie 正在分裂。

我有一种感觉，可能是另一台计算机上的用户代理略有不同。Varnish 将这个值包含在 key 中（如果知道的话）。我们的规则`vcl_recv`是：

```
set req.http.User-Agent = ""; 
```

这为我们解决了类似的问题。

# c# - 添加元素后刷新 ListView

> ID：10192929
> 
> 赞同：3
> 
> 时间：2012-04-17T14:12:45.187
> 
> 标签：c#, data-binding, microsoft-metro, windows-runtime

我对 Windows 开发很陌生，当然对 Metro 风格的应用程序开发也很陌生。我不确定我是否了解数据绑定的工作原理。

我有一个项目清单。

```
private List<Expense> _expenses = new List<Expense>();
public List<Expense> Items
{
    get
    {
        return this._expenses;
    }
} 
```

我绑定到 XAML。（我使用分页模板）

```
 protected override void OnNavigatedTo(NavigationEventArgs e)
    {
        this.DefaultViewModel["Items"] = _data.Items;
    } 
```

然后我显示它

```
<UserControl.Resources>
    <CollectionViewSource
        x:Name="itemsViewSource"
        Source="{Binding Items, Mode=TwoWay}"/>
</UserControl.Resources>

<ListView
    x:Name="itemListView"
    AutomationProperties.AutomationId="ItemsListView"
    AutomationProperties.Name="Items"
    Margin="120,0,0,60"
    ItemsSource="{Binding Source={StaticResource itemsViewSource}}"
    SelectionChanged="ItemListView_SelectionChanged"
    ItemTemplate="{StaticResource DefaultListItemTemplate}"/> 
```

哪个工作正常。然后当用户单击按钮时，我将一个新项目添加到我的列表中

```
_data.Items.Add(new Expense
{
    Total = 100,
    When = new DateTime(2013, 6, 6),
    For = "Myself"
}); 
```

我期望`ListView`自从我设置后会自动刷新，`Mode=TwoWay`但事实并非如此。我是否误解了这个概念并且列表无法刷新？否则，我做错了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-17T14:19:45.273

为了在对集合进行更改后更新 UI，您需要实现它`INotifyCollectionChanged`。这将在发生更改时通知 UI，并通过在更改之上重新绑定 UI 来响应。

不过，实现这个接口是相当复杂的。相反，您应该只使用`ObservableCollection<T>`代替，`List<T>`并且该场景应该可以正常工作

```
private ObservableCollection<Expense> _expenses = new ObservableCollection<Expense>();
public ObservableCollection<Expense> Items
{
    get
    {
        return this._expenses;
    }
} 
```

# axapta - MorphX 报表设计器：还有其他选择吗？

> ID：10192934
> 
> 赞同：2
> 
> 时间：2012-04-17T14:13:05.367
> 
> 标签：axapta, dynamics-ax-2009

Ax 2009 中的 MorphX 报表设计器似乎不是报表设计器中的“最佳”。我不知道是否是我的错，或者 morphx 报表设计器是否过于笨拙而无法完成他的工作。我猜是否有其他方法可以为 Ax 2009 做报告：也许是 Crystal Report 和 Visual Studio？或者 ... ？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T17:00:23.873

SSRS 是 AX 2009 的主要替代方案。您可以为一些好的报告数据部署报告扩展和分析多维数据集。需要配置分析多维数据集以匹配您的个人许可证文件。

如果您只是希望能够创建 SSRS 报告，我相信您可以转到（管理>设置>业务分析>报告服务>报告服务器）并指向您的 SSRS 实例，并创建“Dynamics AX”数据源。

根据您的环境拓扑，您可能还需要进行 Kerberos 设置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T20:09:35.723

迄今为止，最好的替代选择是 Reporting Services。Dynamics AX 2009 以某种方式支持它，有工具和平台来开发报告，而不是尊重 AX 内部的安全性，以及能够将报告设计保留回应用程序对象树的重要功能（在报告库下） .

如何为 Dynamics AX 2009 设置和配置 SSRS 本身就是一个主题，但应该有很多很好的资源可以帮助您。

祝你好运！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T04:10:35.017

如果您要直接使用数据库，除了以前的答案之外，您还可以使用您喜欢的任何报表设计器。

但是请准备好一些 axapta 功能不会自动运行，例如 - 枚举值的标签。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-24T12:24:06.087

使用 Visual Studio 2008 开始使用 SSRS 的好地方是 youtube 上提供的截屏视频，只需进入 youtube 并搜索“AX2009 SSRS”。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-18T17:52:24.693

SSRS 适用于定期报告，但是“在线”报告——例如发票、选择清单等（发布时打印的任何内容）最好由外部软件处理。您可能希望打印到文件或数据库并使用第 3 方软件来获取设计/格式。

Bottomline 的 Create Forms 是我见过的一个例子。当您有不同要求的不同公司/客户/供应商时，您还可以选择工作流程选项，如果您在同一家公司中有多个品牌，那就更好了。

# php - 从文件夹列表递归创建文件夹数组

> ID：10192935
> 
> 赞同：0
> 
> 时间：2012-04-17T14:13:09.350
> 
> 标签：php, arrays, recursion

我在从文件夹数组创建类似文件夹结构的数组时遇到问题。

这是函数接收的数组

```
Array
(
[0] => Array
    (
        [id] => 6
        [name] => 2011
        [parent_folder] => 1
    )

[1] => Array
    (
        [id] => 5
        [name] => 2012
        [parent_folder] => 1
    )

[2] => Array
    (
        [id] => 7
        [name] => April
        [parent_folder] => 6
    )

[3] => Array
    (
        [id] => 2
        [name] => Folder2
        [parent_folder] =>
    )

[4] => Array
    (
        [id] => 1
        [name] => Folder1
        [parent_folder] =>
    )
) 
```

输出应该是一个数组，其中子文件夹作为数组存储在其 partent_folder 数组中的键“内容”下

```
Array
(
[0] => Array
    (
        [id] => 2
        [name] => Folder2
        [parent_folder] =>
    )

[1] => Array
    (
        [id] => 1
        [name] => Folder1
        [parent_folder] =>
        [content] => Array
            (
                [0] => Array
                    (
                        [id] => 6
                        [name] => 2011
                        [parent_folder] => 1
                        [content] => Array
                            (
                                [0] => Array
                                    (
                                        [id] => 7
                                        [name] => April
                                        [parent_folder] => 6
                                    )
                            )
                    )

                [1] => Array
                    (
                        [id] => 5
                        [name] => 2012
                       [parent_folder] => 1
                    )

            )
    )
) 
```

我试过了，但无法让它工作。必须有一种递归方式来重新排列数组。有人可以帮忙吗？将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T18:49:29.697

假设您的原始数组被称为

```
$tree; 
```

其中的每个元素都是一个数组，并具有三个命名条目：

1.  `id`- 代表自己 - 进一步称为`$idName`，
2.  `name`- 一些字符串 - 进一步调用`$parentName`，
3.  `parent`- 代表父母 - 进一步调用`$childrenName`

要将平面转换为树，每个孩子都必须能够解决它的父母。因此，创建了一个临时数组，该数组通过它的 id 对每个树元素都有一个别名。我简短地命名`$t`并创建它：

```
foreach ($tree as $k => $v)
    $t[$v[$idName]] = &$tree[$k]; 
```

由于这个别名表，现在可以将孩子分配给它的父母（如果父母不是`FALSE`），重新安排非常简单：

```
foreach ($tree as $k => $v)
    if (($p = $v[$parentName]) && ($t[$p][$childrenName][] = &$t[$v[$idName]]))
        unset($tree[$k]); 
```

完成此操作后，不再需要别名表并且可以取消设置：

```
 unset($t); 
```

瞧，树准备好了：

```
 var_dump($tree); 
```

输出：

```
array(2) {
  [3]=> array(3) {
    ["id"]=> string(1) "2"
    ["name"]=> string(7) "Folder2"
    ["parent_folder"]=> NULL
  }
  [4]=> array(4) {
    ["id"]=> string(1) "1"
    ["name"]=> string(7) "Folder1"
    ["parent_folder"]=> NULL
    ["content"]=> array(2) {
      [0]=> array(4) {
        ["id"]=> string(1) "6"
        ["name"]=> string(4) "2011"
        ["parent_folder"]=> string(1) "1"
        ["content"]=> array(1) {
          [0]=> array(3) {
            ["id"]=> string(1) "7"
            ["name"]=> string(5) "April"
            ["parent_folder"]=> string(1) "6"
          }
        }
      }
      [1]=> array(3) {
        ["id"]=> string(1) "5"
        ["name"]=> string(4) "2012"
        ["parent_folder"]=> string(1) "1"
      }
    }
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-08T14:23:41.133

我知道这个问题很老，但提供的答案对我不起作用。解决方案的第一部分来自 hakre 的回答。这就是我最终做的事情：

```
global $t;

foreach ($tree as $key => $value){
    $idName = $value['id'];
    $t[$idName] = $tree[$key];
}

foreach ($t as $key => $value){
    //echo $value['name'] . '<br />';
    $t[$key]['uri'] = recursiveArray($value).'/'.$value['name'];
    //echo '<br />';
}

function recursiveArray($value) {
    global $t;    

        if ($value['parentId'] != 0){            
            $parentName = $t[$value['parentId']]['name'];
            //$parentId = $value['parentId'];
            return recursiveArray($t[$value['parentId']]).'/'.$parentName;
        }        
        return '';
} 
```

`tree`是一个看起来就像 OP 的数组的数组。结果明显不同，不是嵌套数组，而是文件的嵌套在`uri`每个数组的值中返回。

```
[76] => Array
    (
        [id] => 76
        [parentId] => 17
        [name] => Evite Templates
        [uri] => /Resources/Tools and Forms/General Tools and Forms/Countdown Events/Evite Templates
    )

[79] => Array
    (
        [id] => 79
        [parentId] => 90
        [name] => Celebration Meeting
        [uri] => /Resources/Tools and Forms/General Tools and Forms/Celebration Meeting
    )

[80] => Array
    (
        [id] => 80
        [parentId] => 90
        [name] => Recruitment Meeting
        [uri] => /Resources/Tools and Forms/General Tools and Forms/Recruitment Meeting
    ) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T14:18:23.117

你需要这样设置：

```
function look_through_array($array) {
for ($i=0; $i<sizeof($array); $i++) {
    if (is_array($array[$i]))
        look_through_array($array[$i]);
    else
        create_folder($array[$i]);
}
}

function create_folder($array) {
    # make a folder
} 
```

# javascript - 从内部调用 JavaScript 函数事件

> ID：10192936
> 
> 赞同：0
> 
> 时间：2012-04-17T14:13:15.853
> 
> 标签：javascript, function, dom-events

我想知道是否可以在同一个 JS 文件中调用“eventNew”函数。当我试图从不同的函数访问“eventNew”函数时。

这是代码的一部分：

```
$calendar.weekCalendar({
    displayOddEven: true,
    timeslotsPerHour: 4,
    allowCalEventOverlap: true,
    overlapEventsSeparate: true,
    firstDayOfWeek: 1,
    businessHours: { start: 1, end: 24, limitDisplay: true },
    daysToShow: 7,
    switchDisplay: { '1 day': 1, '3 next days': 3, 'work week': 5, 'full week': 7 },
    title: function (daysToShow) {
        return daysToShow == 1 ? '%date%' : '%start% - %end%';
    },
    height: function ($calendar) {
        return $(window).height() - $("h1").outerHeight() - 1;
    },
    eventNew: function (calEvent, $event) {
        var $dialogContent = $("#event_edit_container");
        resetForm($dialogContent);
        var startField = $dialogContent.find("select[name='start']").val(calEvent.start);
        var endField = $dialogContent.find("select[name='end']").val(calEvent.end);
        var titleField = $dialogContent.find("input[name='title']");
        var bodyField = $dialogContent.find("textarea[name='body']");

        $dialogContent.dialog({
            modal: true,
            title: "New Calendar Event",
            close: function () {
                $dialogContent.dialog("destroy");
                $dialogContent.hide();
                $('#calendar').weekCalendar("removeUnsavedEvents");
            },
            buttons: {
                save: function () {
                    calEvent.id = id;
                    id++;
                    calEvent.start = new Date(startField.val());
                    calEvent.end = new Date(endField.val());
                    calEvent.title = titleField.val();
                    calEvent.body = bodyField.val();

                    SaveEvent(); // Modified

                    $calendar.weekCalendar("removeUnsavedEvents");
                    $calendar.weekCalendar("updateEvent", calEvent);
                    $dialogContent.dialog("close");
                },
                cancel: function () {
                    $dialogContent.dialog("close");
                }
            }
        }).show();

        $dialogContent.find(".date_holder").text($calendar.weekCalendar("formatDate", calEvent.start));
        setupStartAndEndTimeFields(startField, endField, calEvent, $calendar.weekCalendar("getTimeslotTimes", calEvent.start));

    }
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T14:20:22.330

您的`eventNew`函数是在匿名对象上定义的，因此从技术上讲，您将能够从定义在同一对象上的函数调用它，如`this.eventNew(...)`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T14:22:56.837

是的你可以。将函数放在对象外部的变量上（最好是命名空间，以免污染全局命名空间），然后从您希望的位置调用它：

```
var namespace.myEventNew = function (calEvent, $event) {
   [code here]
}

$calendar.weekCalendar({
  ...
  eventNew : function (calEvent, $event) {
      namespace.myEvent(calEvent, $event);
  },
  ...
}); 
```

您可能希望更松散地与任何类型的发布/订阅系统耦合。见：[https ://gist.github.com/1321768](https://gist.github.com/1321768)

# javascript - 在服务器上调用 Collection.insert 时，“流星代码必须始终在 Fiber 内运行”

> ID：10192938
> 
> 赞同：38
> 
> 时间：2012-04-17T14:13:17.857
> 
> 标签：javascript, meteor, node-fibers

我在 server/statusboard.js 中有以下代码；

```
var require = __meteor_bootstrap__.require,
    request = require("request")   

function getServices(services) {
  services = [];
  request('http://some-server/vshell/index.php?type=services&mode=json', function (error, response, body) {
    var resJSON = JSON.parse(body);
     _.each(resJSON, function(data) {
       var host = data["host_name"];
       var service = data["service_description"];
       var hardState = data["last_hard_state"];
       var currState = data["current_state"];
       services+={host: host, service: service, hardState: hardState, currState: currState};
       Services.insert({host: host, service: service, hardState: hardState, currState: currState});
    });
  });
}

Meteor.startup(function () {
  var services = [];
  getServices(services);
  console.log(services);
}); 
```

基本上，它从 JSON 提要中提取一些数据并尝试将其推送到集合中。

当我启动 Meteor 时，出现以下异常；

```
app/packages/livedata/livedata_server.js:781
      throw exception;
            ^
Error: Meteor code must always run within a Fiber
    at [object Object].withValue (app/packages/meteor/dynamics_nodejs.js:22:15)
    at [object Object].apply (app/packages/livedata/livedata_server.js:767:45)
    at [object Object].insert (app/packages/mongo-livedata/collection.js:199:21)
    at app/server/statusboard.js:15:16
    at Array.forEach (native)
    at Function.<anonymous> (app/packages/underscore/underscore.js:76:11)
    at Request._callback (app/server/statusboard.js:9:7)
    at Request.callback (/usr/local/meteor/lib/node_modules/request/main.js:108:22)
    at Request.<anonymous> (/usr/local/meteor/lib/node_modules/request/main.js:468:18)
    at Request.emit (events.js:67:17)
Exited with code: 1 
```

我不太确定那个错误是什么意思。有没有人有任何想法，或者可以提出不同的方法？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2013-08-30T21:38:00.647

仅将函数包装在 Fiber 中可能还不够，并且可能导致意外行为。

原因是，与 Fiber 一起，Meteor 需要一组附加到 Fiber 的变量。Meteor 使用附加到纤程的数据作为动态范围，将其与 3rd 方 api 一起使用的最简单方法是使用`Meteor.bindEnvironment`.

```
T.post('someurl', Meteor.bindEnvironment(function (err, res) {
  // do stuff
  // can access Meteor.userId
  // still have MongoDB write fence
}, function () { console.log('Failed to bind environment'); })); 
```

如果您想了解更多信息，请观看这​​些视频： [https ://www.eventedmind.com/posts/meteor-dynamic-scoping-with-environment-variables](https://www.eventedmind.com/posts/meteor-dynamic-scoping-with-environment-variables) [https://www.eventedmind.com/posts/meteor-什么是流星绑定环境](https://www.eventedmind.com/posts/meteor-what-is-meteor-bindenvironment)

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-04-18T04:00:17.707

如上所述，这是因为您在回调中执行代码。

您在服务器端运行的任何代码都需要包含在 Fiber 中。

尝试将您的 getServices 函数更改为如下所示：

```
function getServices(services) {
  Fiber(function() { 
    services = [];
    request('http://some-server/vshell/index.php?type=services&mode=json', function (error, response, body) {
      var resJSON = JSON.parse(body);
       _.each(resJSON, function(data) {
         var host = data["host_name"];
         var service = data["service_description"];
         var hardState = data["last_hard_state"];
         var currState = data["current_state"];
         services+={host: host, service: service, hardState: hardState, currState: currState};
         Services.insert({host: host, service: service, hardState: hardState, currState: currState});
      });
    });
  }).run();  
} 
```

我刚刚遇到了类似的问题，这对我有用。我不得不说的是，我对此很陌生，我不知道这是否应该这样做。

您可能只需将您的插入语句包装在 Fiber 中就可以逃脱，但我并不肯定。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-05-06T13:17:59.310

根据我的测试，您必须将插入包装在我测试过的代码中，该代码类似于上面的示例。

例如，我这样做了，但它仍然因 Fibers 错误而失败。

```
function insertPost(args) {
  if(args) {
Fiber(function() { 
    post_text = args.text.slice(0,140);
    T.post('statuses/update', { status: post_text }, 
        function(err, reply) {          
            if(reply){
                // TODO remove console output
                console.log('reply: ' + JSON.stringify(reply,0,4));
                console.log('incoming twitter string: ' + reply.id_str);
                // TODO insert record
                var ts = Date.now();
                id = Posts.insert({
                    post: post_text, 
                    twitter_id_str: reply.id_str,
                    created: ts
                });
            }else {
                console.log('error: ' + JSON.stringify(err,0,4));
                // TODO maybe store locally even though it failed on twitter
                // and run service in background to push them later?
            }
        }
    );
}).run();
  }
} 
```

我这样做了，它运行良好，没有错误。

```
function insertPost(args) {
  if(args) { 
post_text = args.text.slice(0,140);
T.post('statuses/update', { status: post_text }, 
    function(err, reply) {          
        if(reply){
            // TODO remove console output
            console.log('reply: ' + JSON.stringify(reply,0,4));
            console.log('incoming twitter string: ' + reply.id_str);
            // TODO insert record
            var ts = Date.now();
            Fiber(function() {
                id = Posts.insert({
                    post: post_text, 
                    twitter_id_str: reply.id_str,
                    created: ts
                });
            }).run();
        }else {
            console.log('error: ' + JSON.stringify(err,0,4));
            // TODO maybe store locally even though it failed on twitter
            // and run service in background to push them later?
        }
    }
);
  }
} 
```

我认为这可能会帮助其他人遇到这个问题。我还没有测试在内部代码之后调用异步类型的外部服务并将其包装在 Fiber 中。这可能也值得测试。就我而言，我需要在执行本地操作之前知道远程操作发生了。

希望这有助于这个问题线程。

# javascript - jQuery 小部件开发 - 我可以使用 MVC 模式吗？

> ID：10192941
> 
> 赞同：16
> 
> 时间：2012-04-17T14:13:29.020
> 
> 标签：javascript, model-view-controller, jquery-ui

我一直在使用 knockoutjs 和主干创建单页 JavaScript 应用程序。我使用主干模型和淘汰视图模型，但我也有很多 UI 控件，我使用 jQuery UI 小部件工厂来创建这些控件。

我的问题是如何更好地构造我的 jQuery 小部件中的代码。像 knockout/backbone/ember 这样的框架可以很容易地在主应用程序中实现 MVC 类型模式，但是当涉及到小部件开发时，我最终会得到大量用于输出和操作 DOM 元素的代码。我仍然可以对此进行测试，因为 jquery 可以很容易地查询 DOM，但代码非常难看。理想情况下，我也想在我的小部件中使用 MVC 模式。

是否有任何旨在帮助解决此问题的库或框架？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T15:10:32.997

In short:

*   Keep widgets as much as a view part of the MVC as you can. Delegate the data out whenever possible.
*   Don't write your widget with the predisposition of it being in your app. Treat the widget like a an island.
*   Use Events to handle data passing out of the widget. Don't query for it.
*   Use ["Tell, Don't ask"](http://pragprog.com/articles/tell-dont-ask) pattern in widgets to keep the controller clean

Ideally, JQuery is the V part of the MVC pattern of your overall application. If widgets you have need to retain and return data when the user interacts with them, eventing is the way to go. Use the ["Tell, don't ask"](http://pragprog.com/articles/tell-dont-ask) pattern of development in your widgets so that you don't have to query the state of your widgets to do something. This should clean up many of the issues.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T06:28:20.723

这在很大程度上取决于您所说的 jQuery 小部件是什么意思。如果您的小部件仅包含一些小的东西，例如增强 HTML 元素功能的东西（即文本框的自动完成功能），那么您最好构建好插件并正确[测试它](http://docs.jquery.com/QUnit)。尽可能简单。MVC 模式在那里会产生开销，因为人们通常只是喜欢获取一个`js`文件并在他们的项目中引用它。

相反，如果你想开发一个 Backbone 风格的 MVC 应用程序，[JavaScriptMVC](http://javascriptmvc.com/)可能是你想要的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T10:00:26.360

我只能帮助 MVC 中的“V”部分 :) 制作 DOM，我更喜欢 OOCSS 概念，其中每个类都继承父级的属性，但您可以将它们集成在一起。

## OOCSS

```
<div class="mod"> 
    <b class="top"></b>
    <div class="inner">
        <div class="bd"></div>
    </div>
    <b class="bottom"></b> 
</div> 
```

[https://github.com/stubbornella/oocss/wiki/Module](https://github.com/stubbornella/oocss/wiki/Module)

## jQuery 用户界面

```
<div class="ui-widget ui-widget-content">
  <div class="ui-widget-header"></div>
  <div class="ui-widget-content"></div>
</div> 
```

[http://jqueryui.com/docs/Theming/API](http://jqueryui.com/docs/Theming/API)

## 混合 OOCSS 和 jQuery UI

```
<div class="mod ui-widget ui-widget-content">
  <div class="top ui-widget-header"></div>
  <div class="inner ui-widget-content"></div>
  <div class="bottom ui-widget-footer ?"></div> 
</div> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-08T04:38:42.663

框架有帮助，但没有它们也可以解决原则。我通常会在我的小部件和/或自执行匿名函数中的私有函数中构建方法，这给了我正在寻找的分离。如果小部件变大，将图层拆分为不同的文件会有所帮助，但这可能会使使用最终产品变得更加困难。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-14T20:53:32.330

我已经通过以下方式阅读了您的问题，但我可能会偏离主题，所以*请注意购买者*。

在将您的代码分解为独立的代码单元方面，您可能需要考虑使用[AMD](http://requirejs.org/docs/whyamd.html)将它们全部重新拉回。就个人而言，我不是语法的粉丝，但从实用的角度来看，这可能会有所帮助，就像你决定将巨大的 mongo 文件分解为离散的可重用单元一样，你可能会看到很多受益于将功能单元隔离到独立文件中，并有一种简单的方法来确保您的依赖项以正确的顺序加载。

顺便说一句，一旦确定了依赖关系解析，您可能有兴趣将[PureMVCJS](http://puremvc.org/component/option,com_frontpage/Itemid,1/)作为一种组织原则进行检查——它提供了与许多其他 MVC 框架一样将代码分解为可重复使用的层或垂直切片的方法。开箱即用，它独立于任何 DOM 或 OOP 抽象库，根据您要实现的目标，它是一个福音（是的，我可以在不破坏我的服务的情况下更改我的 DOM 抽象库）或痛苦（我必须在我的 DOM 库和 PureMvc 视图之间编写一个集成层），但我发现它很有用（再说一遍，我可能有偏见，因为本着全面披露的精神，我是港口）。

无论如何，希望这会有所帮助。

# xsd - 是否可以在匿名类型上指定列表长度？

> ID：10192943
> 
> 赞同：5
> 
> 时间：2012-04-17T14:13:36.927
> 
> 标签：xsd

我正在将旧数据集转换为 schema/xml。它包含一些具有默认值的数组元素。我接近使用 xs:list; 的解决方案；

```
 <xs:element name="pressure"
            default="0.22 0.33 0.44 0.55 0.66 0.77 0.88 0.88 0.88 0.88">
  <xs:simpleType>
    <xs:list>
      <xs:simpleType>
        <xs:restriction base="xs:float">
           <xs:minInclusive value="0.0" />
           <xs:maxInclusive value="2.0" />
        </xs:restriction>
      </xs:simpleType>
    </xs:list>
  </xs:simpleType>
</xs:element> 
```

如何将列表的长度限制为 10？即，我将在哪里放置

```
 <xs:length value="10">? 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-23T14:08:54.273

基本类型是 xs:float 上的 xs:restriction。

```
<xs:simpleType name="ptype">
  <xs:restriction base="xs:float">
    <xs:minInclusive value="0.0" />
    <xs:maxInclusive value="2.0" />
  </xs:restriction>
</xs:simpleType> 
```

这包含在 xs:list 中。

```
<xs:simpleType name="ltype">
  <xs:list itemType="ptype"/>
</xs:simpleType> 
```

接下来，在列表中设置长度限制。

```
<xs:simpleType name="rtype">
  <xs:restriction base="ltype">
    <xs:length value="10"/>
  </xs:restriction>
</xs:simpleType> 
```

最后，元素，具有默认值

```
<xs:element name="pressure"
    default="0.22 0.33 0.44 0.55 0.66 0.77 0.88 0.88 0.88 0.88">
  <xs:simpleType>
    <xs:restriction base="rtype"/>
  </xs:simpleType>
</xs:element> 
```

要获得完全匿名的元素，请从顶部开始，并将每个构造嵌套到引用它的下一个较低构造中。最后，以这个结束；

```
<xs:element name="pressure"
        default="0.22 0.33 0.44 0.55 0.66 0.77 0.88 0.88 0.88 0.88">
  <xs:simpleType>
    <xs:restriction>
      <xs:simpleType>
        <xs:list>
          <xs:simpleType>
            <xs:restriction base="xs:float">
               <xs:minInclusive value="0.0" />
               <xs:maxInclusive value="2.0" />
            </xs:restriction>
          </xs:simpleType>
        </xs:list>
      </xs:simpleType>
      <xs:length value="10"/>
    </xs:restriction>
  </xs:simpleType>
</xs:element> 
```

# iphone - 从 sqlite 检索 BLOB 图像

> ID：10192945
> 
> 赞同：2
> 
> 时间：2012-04-17T14:13:45.603
> 
> 标签：iphone, objective-c, sqlite, blob

保存图片的代码：

```
NSData *imageData=UIImagePNGRepresentation(animalImage);
        NSString *insertSQL=[NSString stringWithFormat:@"insert into AnimalsTable (name,propertyID,animalID,breed,mainBreed,dateofbirth,sex,notes,imageData) values(\"%@\",\"%@\",\"%@\",\"%@\",\"%@\",\"%@\",\"%@\",\"%@\",\"%@\")",nameString,propertyString,animalidString,breedString,mainBreedString,dateString,sexString,notesString,imageData];
    sqlite3_stmt *addStatement;
        NSLog(@"%@",appDelegate.sqlFile);
    const char *insert_stmt=[insertSQL UTF8String];
    if (sqlite3_open([appDelegate.sqlFile UTF8String],&database)==SQLITE_OK) {
        sqlite3_prepare_v2(database,insert_stmt,-1,&addStatement,NULL);

        if (sqlite3_step(addStatement)==SQLITE_DONE) {

            sqlite3_bind_blob(addStatement, 1, [imageData bytes], [imageData length], SQLITE_TRANSIENT);
            NSLog(@"Data saved");

        }
        else{
            //NSAssert1(0, @"Error while updating. '%s'", sqlite3_errmsg(database));

            NSLog(@"Some Error occured");
    }

    sqlite3_close(database); 
```

对于检索图像：

```
NSString *select_sql=[NSString stringWithFormat:@"select name,animalID,imageData from AnimalsTable where mainBreed='%@' AND breed='%@'",mainString,subString];
        const char *sql = [select_sql UTF8String];
        sqlite3_stmt *selectstmt;
        if(sqlite3_prepare_v2(database, sql, -1, &selectstmt, NULL) == SQLITE_OK) {

            while(sqlite3_step(selectstmt) == SQLITE_ROW) {

            NSString *animalName = [NSString stringWithUTF8String:(char *)sqlite3_column_text(selectstmt, 0)];
            NSString *animalid=[NSString stringWithUTF8String:(char *)sqlite3_column_text(selectstmt, 1)];
            NSData *dataForCachedImage = [[NSData alloc] initWithBytes:sqlite3_column_blob(selectstmt, 2) length: sqlite3_column_bytes(selectstmt, 2)];           
            [animalNamesArray addObject:animalName];
            [animalIDArray addObject:animalid];
            [imageDataArray addObject:dataForCachedImage];

        }
    }
}
else
    sqlite3_close(database); 
```

在 UITableView CellForIndexPath 中：

```
NSData *dataForCachedImage=[imageDataArray objectAtIndex:indexPath.row];
    UIImage *dataImage=[[UIImage alloc] init];
    dataImage=[UIImage imageWithData:dataForCachedImage];
    cell.imageView.image=dataImage; 
```

当我调试代码时：

我得到 NSData=226381 字节和 dataImage 0x0 的字节。

请帮我。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T17:31:38.953

您需要将您的值正确绑定到查询才能正常工作。当您在第一行设置查询时，将插入数据的描述，而不是正确的数据。如果您要记录查询，您可能会看到类似`<0FFAEC32 ... 23F0E8D1>`. 然后，您稍后尝试正确绑定 blob，但由于您的查询未正确写入，因此没有任何效果。

```
//Although you try to bind a blob here it does not get bound
//to anything since you do not include a parameter template.
sqlite3_bind_blob(addStatement, 1, [imageData bytes], [imageData length], SQLITE_TRANSIENT); 
```

在这里解决这个问题是一个最小的例子：

```
//query does not need to be an NSString* but just a const char *
//replace all %@ with ?
const char *sql = "INSERT INTO AnimalsTable(name, ..., imageData) values(?, ..., ?)";
if (sqlite3_open([appDelegate.sqlFile UTF8String],&database)==SQLITE_OK) {
        sqlite3_prepare_v2(database,insert_stmt,-1,&addStatement,NULL);

        //Bind all of the values here before you execute the statement
        sqlite3_bind_text(addStatement, 1, [nameString UTF8String], -1, NULL);
        ...
        sqlite3_bind_blob(addStatement, 9, [imageData bytes], [imageData length], SQLITE_TRANSIENT);

        if (sqlite3_step(addStatement)==SQLITE_DONE) {
            NSLog(@"Data saved");
        }
        ...

        //You must finalize your statement before closing the database
        sqlite3_finalize(addStatement);
        sqlite3_close(database); 
```

使用绑定值有助于防止插入可能是 SQL 注入攻击的无效数据，并提高经常运行的查询的查询性能。

注意*：如果您要执行大量 SQL，请考虑使用[FMDB](https://github.com/ccgus/fmdb)甚至 Core Data。

# php - 在mysql中取消排序结果

> ID：10192952
> 
> 赞同：0
> 
> 时间：2012-04-17T14:14:05.070
> 
> 标签：php, mysql, mysqli

我被`FIND_IN_SET`MYSQL 5.5 中的函数卡住了，例如：

请检查以下查询，考虑`10,9,5,8,21`是用户 ID

```
SELECT u.user_id,u.first_name,u.last_name
FROM user u 
WHERE 
u.is_active = 'Y'       
AND FIND_IN_SET(u.user_id,'10,9,5,8,21'); 
```

当我触发此查询时，它会给我结果中的用户 ID 的升序

```
5
8
9
10
21 
```

我想要和我输入的顺序一样

```
10
9
5
8
21 
```

有没有办法实现它？

存储过程

```
DROP PROCEDURE IF EXISTS databaseName.procName;
DELIMITER //
CREATE PROCEDURE databaseName.procName(IN ZoneIDs LONGTEXT)

BEGIN       
        SELECT u.user_id,u.first_name,u.last_name

        FROM user u     
        WHERE u.is_active = 'Y'
        AND FIND_IN_SET(u.user_id,ZoneIDs); 

END //
DELIMITER ; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T14:21:40.903

尝试像这样使用它：

```
SELECT u.user_id,u.first_name,u.last_name
FROM user u 
WHERE u.is_active = 'Y' and u.user_id IN (10,9,5,8,21)
ORDER BY FIND_IN_SET(u.user_id,'10,9,5,8,21'); 
```

这用于`IN`仅选择`u.userid`该列表中的数据，然后使用您的特定订单进行排序`find_in_set`

[FIND_IN_SET](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_find-in-set)在第二个参数中返回第一个参数的索引 - 所以我很惊讶你的查询甚至工作......

# c# - 如何捕获视频并使用 C# 播放？

> ID：10192966
> 
> 赞同：1
> 
> 时间：2012-04-17T14:14:55.927
> 
> 标签：c#, wpf, video-capture

我想构建需要能够使用 C# 从网络摄像头捕获视频的应用程序。捕获的视频应该使用一些编解码器（没有什么特别的，任何可以节省空间的可用的东西）进行压缩，并在捕获时写入文件。不需要实时预览捕获。

第一个问题是哪个 API 适合这个，你会推荐（我见过 DirectShow、Windows Media Foundation 包装器等......不确定哪个最适合托管环境和 C#）？

我还需要 WPF 中的视频播放器来播放捕获的视频。此播放器必须能够从任意位置播放捕获的视频、暂停和开始/停止视频。将它们放在一起 - 视频是从后台的网络摄像头捕获的，同时播放器播放正在捕获的视频，但它可以暂停、重绕、停止 - 类似于现代 DVR。

第二个问题 - 是否可以使用 WPF MediaElement 创建这样的播放器？（混淆是关于文件同时从捕获中填充并在播放器中播放）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T14:19:39.117

很好的例子如何制作你想要的[网络摄像头](http://www.codeproject.com/Articles/125478/Versatile-WebCam-C-library)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-19T10:17:16.430

我已经使用 AForge( [http://www.aforgenet.com/](http://www.aforgenet.com/) ) 库集来逐帧接受视频。我使用 (private void videoSourcePlayer1_NewFrame(object sender, ref Bitmap image)) 函数来执行此操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T14:19:41.427

你可以试试 DirectShow.net 库。

[http://directshownet.sourceforge.net/](http://directshownet.sourceforge.net/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-17T14:57:04.617

我用过[VlcDotNet](http://vlcdotnet.codeplex.com/)。它非常灵活且易于使用。它也有一个非常活跃的用户群。

我用它来显示实时视频流以及录制到文件中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-02-20T07:57:39.883

我可以推荐 WPF [ffmediaelement](https://github.com/unosquare/ffmediaelement)。它建立在[ffmpeg](https://www.ffmpeg.org)上。那么什么都可以ffmpeg，也可以ffmediaelement。可以从网络摄像头和采集卡采集视频。与 DirectShow 不同，它非常简单。以下是设置视频源的方法：

```
Media.Source = new Uri("device://dshow/?video=Osprey-460e Video Device 1C"); 
```

...及其在 MediaOpening 事件中的参数：

```
Media.OnMediaOpening(s, e) =>
{
    e.Options.Input["framerate"] = "25";
    e.Options.Input["video_size"] = "768x576";
    e.Options.Input["pixel_format"] = "yuyv422";
}; 
```

# jquery - 在页面上多次使用视差插件？

> ID：10192970
> 
> 赞同：4
> 
> 时间：2012-04-17T14:15:12.870
> 
> 标签：jquery, parallax

我正在使用 github 使用的这个插件来实现它的视差效果：

[https://github.com/cameronmcefee/plax](https://github.com/cameronmcefee/plax)

这是一个很棒的插件，但我想在一个页面上多次使用它。

```
//PLAX - ONE
$('#one img').plaxify()
$('#one .back').plaxify({ "xRange": 50, "yRange": 0 })
$('#one .front').plaxify({ "xRange": 30, "yRange": 0, "invert": true })
$.plax.enable({ "activityTarget": $('#one ') })

//PLAX - TWO
$('#two img').plaxify()
$('#two .back').plaxify({ "xRange": 50, "yRange": 0, "invert": true })
$('#two .front').plaxify({ "xRange": 30, "yRange": 0 })
$.plax.enable({ "activityTarget": $('#two ') }) 
```

所以这是行不通的，我相信我可以做一些简单的事情来让它工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-12T15:22:07.223

看看[这个 github 项目](https://github.com/cameronmcefee/plax/blob/master/examples/dynamic.html)。

# java - Android：WIFI和移动互联网冲突

> ID：10192974
> 
> 赞同：0
> 
> 时间：2012-04-17T14:15:30.280
> 
> 标签：java, android, mobile, android-service, android-wifi

在我的 android 应用程序中，我必须向服务器发送请求以接收其响应。该应用程序运行良好，当我进行一些测试时发现以下问题。

认为 WIFI 已关闭且移动（3G）连接可用。因此，如果我在按下按钮将请求发送到服务器后打开 WIFI，应用程序将从以下代码行停止执行`resCode = httpConn.getResponseCode();`。此代码在单独的线程中运行并使用 Handler 类。

我认为发生这种情况是因为当我按下按钮（发送请求）时，它只有移动（3G）互联网并试图处理（移动互联网）。但是当我在处理时打开WIFI时，可能会尝试使用WIFI进行处理，因为WIFI具有最高优先级并产生冲突。

有没有人知道如何防止这种冲突。

**编辑。**..................................................... ......

```
InputStream in = null; 
int resCode = -1; 

     try 
     {                                                                                             
        URL url = new URL(urlStr.replace(" ", "%20"));                                             
        URLConnection urlConn = url.openConnection();                                             
        HttpURLConnection httpConn = (HttpURLConnection)urlConn;                                  
        httpConn.setAllowUserInteraction(false);                                                   
        httpConn.setInstanceFollowRedirects(true);                                                
        httpConn.setRequestMethod("GET");                                                           
        httpConn.connect(); 
        httpConn.setConnectTimeout(5500);        Log.v("State", "before get response code");                                                            
 /*->>*/ resCode = httpConn.getResponseCode();    Log.v("State", "After get response code");                                                            
        in = (resCode == HttpURLConnection.HTTP_OK) ? httpConn.getInputStream() : in;              

    } 
    catch (MalformedURLException e) 
    {
        e.printStackTrace();                                                                              
    }
    catch (IOException e) 
    {
        e.printStackTrace();                                                                               
    } 
```

在这种情况下它成功执行的最后一行是`httpConn.setConnectTimeout(5500);`and stop 从那里执行....

它运行`"before get response code"`但不在`"before get response code"`Logcat 中......

即使它没有任何例外......我检查了......

# c++ - c++: 用迭代器调用vector::erase

> ID：10192976
> 
> 赞同：2
> 
> 时间：2012-04-17T14:15:47.160
> 
> 标签：c++, vector, struct, iterator, erase

我正在研究结构向量。

当我尝试使用迭代器调用此函数时，如下所示：

```
vec2.erase (vec2.begin()+iter2); 
```

它向我发送了这个错误：

```
"no match for 'operator+' in '(+vec2)->std::vector<_Tp, _Alloc>::begin [with _Tp = wordstype, _Alloc = std::allocator<wordstype>]() + iter2'" 
```

我可以发送迭代器（或任何其他参数）吗？如果是，问题是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T14:17:21.200

您不能将[迭代器添加到迭代器](https://stackoverflow.com/a/9684875/13767)。

`iter2`已经指向向量中的具体位置，因此您可以编写：

```
iter2 = vec2.erase(iter2); 
```

反而。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T14:17:43.683

Yes`erase`可以使用迭代器，代码如下所示：

```
erase(itr2); 
```

你也可以这样做：

```
erase(vec2.begin() + 3); 
```

但是迭代器没有声明`operator+`，因此您的调用无效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T14:18:12.013

您正在尝试将两个迭代器相加，这是没有意义的。

发布您的代码并解释您正在尝试做什么。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-17T14:20:24.730

`std::vector<>::erase`根据错误消息，您描述的问题似乎与 没有任何关系。

编译器有问题的表达式是`vec2.begin() + iter2`. 显然，`iter2`在您的情况下是一个迭代器。`vec2.begin()`也是一个迭代器。您不能将一个迭代器添加到另一个迭代器。这根本没有意义。因此错误。

你想做什么`vec2.begin() + iter2`？如果`iter2`确实是一个迭代器，你为什么要尝试将它添加到`vec2.begin()`？

# javascript - 如何让 ResponsiveSlides 幻灯片在 Internet Explorer 中工作？

> ID：10192980
> 
> 赞同：0
> 
> 时间：2012-04-17T14:15:59.967
> 
> 标签：javascript, jquery, internet-explorer, jquery-plugins, slideshow

我正在使用 ResponsiveSlides.js(http://responsive-slides.viljamis.com/) 在我正在处理的网站上显示幻灯片。它在 Opera、Chrome 和 Firefox 中完美运行，但 IE 显示的图像比预期的要大得多。这是一个例子（http://www.brooklynlutheran.com/ie-maxwidth-test.asp）。ResponsiveSlides.js 提供的演示代码工作正常，我看不出有任何区别。谁能告诉我我做错了什么？

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T14:24:56.167

很可能 max-width: 400px 可能是问题，因为 IE 可能无法识别它。我还没有做研究，因为我要下班回家，但是......这样说：

```
<li><div style="width:400px;">[rest of code inside<li></li>]</div></li> 
```

这可能不会自动调整其中的图像大小，但至少应该限制。然后你可能需要一些额外的代码来减小它们的大小。希望能帮助到你。如果到我回家时没有其他人可以帮助您，我会尝试解决这个问题，而不仅仅是给出提示。祝你好运 ：）

编辑：

```
<li id="rslides1_s0" style="display: none; float: none; position: absolute; " class=""><div style="width:400px;"><img src="./IE Maxwidth Test_files/test-pic1.jpg" alt=""></div></li> 
```

使列表项看起来像这些（注意添加的），它在 IE 中是固定的 :)

# authentication - 如何在 LDAP 中使用身份验证设置 Tomcat？

> ID：10192981
> 
> 赞同：1
> 
> 时间：2012-04-17T14:16:01.507
> 
> 标签：authentication, tomcat, login, ldap, access-denied

> “如何通过自定义授权在 Tomcat 中使用 LDAP 进行身份验证”
> 
> “通过 Tomcat 中的 web.xml 进行 LDAP 身份验证”
> 
> “LDAP 身份验证要求及其操作方法”

我似乎不是唯一一个在这个问题上苦苦挣扎的人。使用当前配置，我可以使用我的 LDAP 用户而不是系统或 tomcat 用户进行身份验证。问题是每当我登录时，我都会被拒绝访问我应该看到的文件。

我目前有一个包含以下信息的 web.xml

```
<security-constraint>
<web-resource-collection>
<web-resource-name>Nrt</web-resource-name>
<url-pattern>/*</url-pattern>
</web-resource-collection>
<auth-constraint>
<role-name>admin</role-name>
</auth-constraint>
</security-constraint>
<login-config>
<auth-method>BASIC</auth-method>
<realm-name>Home</realm-name>
</login-config> 
```

和具有以下内容的 server.xml

```
<Realm className="org.apache.catalina.realm.JNDIRealm"
             connectionURL="ldap://192.168.75.146:389"
             userPattern="uid={0},ou=people,dc=localhost,dc=localdomain"
             roleBase="cn=admin,ou=group,dc=localhost,dc=localdomain"
             roleName="cn"
             roleSearch="memberUid={1}"
             debug="99"/> 
```

我试图在网上找到文档，但我只是卡住了。到目前为止，我已经设法在没有 LDAP 用户的情况下访问它，或者使用 LDAP 用户登录而不访问文件。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T16:28:51.860

如果我理解正确，您可以通过 LDAP 进行身份验证，但授权部分未按预期工作。根据您提供的信息，您缺少角色和组之间的映射。您可以在[此处找到说明](http://docs.oracle.com/javaee/5/tutorial/doc/bnbxj.html)

# c - 如何在整个项目（由其他人创建）中添加标志（例如-g）？

> ID：10192988
> 
> 赞同：3
> 
> 时间：2012-04-17T14:16:31.010
> 
> 标签：c, gcc, linux-kernel, makefile, automake

我有一个我正在使用的库（这对我的工作至关重要），我怀疑它可能有错误。不幸的是，图书馆的所有者对尝试我的示例代码反应迟钝。我将尝试自己调试它。

老实说，它不仅仅是一个库，它是一个库加上一组内核模块，并且崩溃发生在内核级别（非常讨厌），而且对于代码的所有者来说确实也很难发现。

有时我很幸运，我得到一个内核 oops，如果我可以使用 -g 选项构建他的代码，我可以找到发生错误的行（这很有帮助，因为我刚刚开始面对他的大量代码几乎没有线索）。

现在项目的 GNUmakefiles 是用 automake 构建的（我相信）。我的问题是**如何告诉我`make`要添加`-g`到`CFLAGS`整个构建中？**

我记得读过一些关于如何编写 Makefile 以便可以添加“外部”选项等的内容，但我不知道这些 makefile 是否会以这种能力生成（应该是因为它是 automake），或者这些外部选项是如何生成的反正给了！

我猜是这样的：

```
make CFLAGS=-g 
```

应该这样做，但老实说不知道。

* * *

编辑：请注意，我实际上对`-g`构建内核模块时要包含的标志感兴趣。我不能使用尝试和错误（例如使用上面的命令）来查看是否有效，因为内核构建只是打印`[CC] ...`而不显示任何选项！

编辑：实际上我确实尝试过，但`gdb ./module.ko`仍然声称没有调试符号。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T22:23:29.027

有`configure`剧本吗？如果是这样，它是由 autoconf 创建的吗？（可能。）然后你可以做

```
./configure CFLAGS='-g -O0'
make clean
make 
```

在调试和优化关闭的情况下重建整个事情。

否则，除非您提供 makefile 的相关摘录，否则没有人可以真正帮助您。

# ajax - 从 servlet 下载文件时的错误处理

> ID：10192990
> 
> 赞同：1
> 
> 时间：2012-04-17T14:16:49.923
> 
> 标签：ajax, servlets, error-handling, extjs4, download

我有一个必须与 IE7 一起使用的 Web 应用程序（是的，我知道..），其中前端完全由 ExtJS4 制成，并且有一个用于下载文件的 servlet。要下载文件，我发送了一些参数，所以我不能简单地使用`location.href`. 它必须是 POST。
到目前为止它可以工作，但是当 servlet 中引发异常时，我不知道如何处理它以向用户显示一些警报框或一些消息，而无需重定向到另一个页面。
在我的 webapp 中，我也使用 DWR 并且我知道该`openInDownload()`功能，但它会在 IE 中触发安全警告。
所以，（终于！）问题是

使用此代码：

```
post = function (url, params) {
var tempForm=document.createElement("form");
tempForm.action=url;
tempForm.method="POST";
tempForm.style.display="none";
for(var x in params) {
        // ...snip boring stuff to add params
}
document.body.appendChild(tempForm);
tempForm.submit();
return tempForm;
} 
```

提交后是否可以留在同一页面？

或与另一个：

```
Ext.Ajax.request({
        url: './descargaArchivoNivs', 
        method: 'POST',
        autoAbort: true,
        params: {
            nivs: jsonData
        },
        success: function(response){
        // HERE!!
        // i know this is wrong
            document.write('data:text/plain,' + response.responseText );
        /*    this looked promising but a warning pops up
              var newwindow = window.open();
              newwindow.document.open();
              newwindow.document.write('data:text/plain, ' + response.responseText );
              newwindow.document.close();*/

        },
        failure: function(resp){
            alert('There was an error');
        }
    }); 
```

是否可以打开`// HERE!!`包含`response`内容的文件下载对话框？

还是有其他方法可以在成功时打开文件下载对话框，并在失败时显示友好消息而不会丢失用户输入（POST 的参数）？

（对不起，如果这篇文章太长了）

# groovy - Using Groovy's CliBuilder to get option error when the option is not first argument

> ID：10192993
> 
> 赞同：0
> 
> 时间：2012-04-17T14:16:58.350
> 
> 标签：groovy

我的问题是：当我通过脚本传递： groovy MyScript.groovy -o mtest -f filetest 脚本可以获得 -o 选项。但是当我更改选项的位置时。groovy MyScript.groovy -f filetest -o mtest 无法获得 -o 的选项

为什么？我想念什么吗？

常规代码是：

```
def cli = new CliBuilder()
            cli.with {
        usage: 'Self'
        h longOpt:'help', 'U should input a analyze script with -o dataFileName!'
        o longOpt:'output', 'The file which should be analyzed.', args:1, required:true
        f longOpt:'file', 'File'
    }
            def opt = cli.parse(args)
            def action
            if( args.length == 0) {
                    cli.usage()
                    return
            }
            if( opt.h ) {
                    cli.usage()
                    return
            }
            println(args);
            println(opt);
            println(opt.o);
groovy MyScript.groovy -f filetest -o mtest 
```

打印结果为：[-f, filetest,-o,mtest] groovy.util.OptionAccessor@66b51404 false

groovy MyScript.groovy -o mtest -f filetest 打印结果是：[-o,mtest,-f, filetest] groovy.util.OptionAccessor@66b51404 mtest

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T16:45:43.443

Think you need to specify `args` on your `-f` option as well (as it takes an argument) ie:

```
def cli = new CliBuilder().with {
  usage: 'Self'
  h longOpt:'help', 'U should input a analyze script with -o dataFileName!'
  o longOpt:'output', 'The file which should be analyzed.', args:1, required:true
  f longOpt:'file', 'File', args:1
  it
}

def opt = cli.parse( args )

if( opt ) {
  println args
  println opt
  println opt.o
} 
```

# mysql - 如果存在则从表中选择，否则从完全不同的表中选择

> ID：10192996
> 
> 赞同：3
> 
> 时间：2012-04-17T14:17:05.353
> 
> 标签：mysql, select, query-optimization, multiple-tables, multiple-select

我有一个查询来获取两个值：

```
string query = @"SELECT price, weight
                 FROM   map 
                 WHERE  width = @width AND height = @height LIMIT 1";

if (_connSource.State != ConnectionState.Open)
    _connSource.Open();
MySqlCommand cmd = new MySqlCommand(query, _connSource);
cmd.Parameters.AddWithValue("width", width);
cmd.Parameters.AddWithValue("height", height);
r = cmd.ExecuteReader();

if (!r.Read())
{
    r.Close();

    query = @"SELECT retail_price, 0
              FROM   globe
              WHERE  PK_Id = @PK_Id LIMIT 1"

    cmd = new MySqlCommand(query, _connSource);
    cmd.Parameters.AddWithValue("PK_Id ", 1);
    r = cmd.ExecuteReader();
 } 
```

我需要的是根据一个条件获取`price`和，但如果它不存在于表中，那么我需要从一个没有约束的全新表中获取另外两个字段和一个常量 0（不管它是什么）从上表。**我可以在一个查询中得到这两个吗？**`weight``retail_price`

 **注意：请给我优化的查询，它不会强制多次读取相同的值（此函数在一次操作中执行数千次，因此速度非常关键 - 这是我试图将它整合到一起的原因询问）。谢谢..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-17T14:22:16.647

语法有点难看，但我认为你可以做到：

```
(SELECT price, weight
 FROM map 
 WHERE width = @width AND height = @height LIMIT 1)
UNION ALL
(SELECT retail_price as price, 0 as weight
 FROM  globe
 WHERE PK_Id = @PK_Id LIMIT 1) 
```

这将返回 0 到 2 行。如果返回 2 行，则选择第 1 行。

**编辑**您可以尝试通过使用这个可怕的构造来避免第二次查询的成本。我不确定 MySQL 是否能很好地处理它，但它很有可能避免第二个查询：

```
select
    ifnull(price, (select retail_price from globe where PK_Id = @PK_Id LIMIT 1))
,   ifnull(weight, 0)
from map 
WHERE width = @width AND height = @height LIMIT 1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T14:36:57.010

如果地图 WHERE 没有 Resultrow，则 DBNull 将被替换为地球值

```
SELECT 
    price = IFNULL(map.price,gl.price), 
    weight = IFNULL(map.weight,0)
FROM   map 
LEFT JOIN globe gl ON PK_Id = @PK_Id    
WHERE  width = @width AND height = @height 
LIMIT 1 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T14:38:44.370

我确实得到了一个非常hacky的解决方案，不小心。以下是如何做到这一点：

```
SELECT price, weight
FROM map
WHERE width = @width AND height = @height LIMIT 1

UNION ALL

SELECT retail_price, 0
FROM  globe
WHERE PK_Id = @PK_Id LIMIT 1 
```

如果我在第一个选择本身中得到答案，该`LIMIT 1`子句实际上会限制它读取第二个值。**请注意，我没有在任何地方添加括号，因此 MySQL 不会将其视为正常 UNION ALL**。[在此处](https://stackoverflow.com/questions/10205610/why-is-union-all-with-and-without-parenthesis-behaving-different)和[此处](http://dev.mysql.com/doc/refman/5.0/en/union.html)阅读更多相关信息

显然，您可以这样做以使其更有意义，但我认为它的性能不会更好：

```
SELECT price, weight
FROM map
WHERE width = @width AND height = @height LIMIT 1

UNION ALL

(SELECT retail_price, 0
FROM  globe
WHERE PK_Id = @PK_Id LIMIT 1) LIMIT 1 
```

在这里，由于我添加了括号，它就像普通的 UNION ALL 一样工作，也就是说，如果可能，我应该获取两条记录，但是`LIMIT 1`查询末尾的最后一个子句将结果限制为第一组。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-17T14:35:40.003

由于您的“限制”子句保证每个查询最多一行，您可以使用左连接，并使用“IF（）”处理“地图”记录的存在：

```
select ifnull(m.price,g.price), ifnull(m.weight,g.weight) from
(SELECT retail_price as price, 0 as weight
 FROM  globe
 WHERE PK_Id = @PK_Id LIMIT 1) g
LEFT JOIN
(SELECT price, weight
 FROM   map 
 WHERE  width = @width AND height = @height LIMIT 1) m
ON 1=1 
```

上述查询假定映射表中的价格和重量不能为空。**

# cakephp - 为什么在 CakePHP 中将 debug 更改为 0 会破坏静态页面？

> ID：10192997
> 
> 赞同：2
> 
> 时间：2012-04-17T14:17:08.710
> 
> 标签：cakephp

一切正常。没有错误。我将调试更改为 0，突然间我的页面出现 404 错误，在我的日志中，我注意到我在应用程序控制器中声明的变量（之前运行良好）现在返回未定义。

奇怪。为什么将 debug 更改为 0 会导致这种行为？

**编辑：2012 年 4 月 18 日**

我戳了一下 Pages 控制器。在“$path = func_get_args();”之后 当我投掷骰子时（print_r（$path））。使用调试 1 或 2，它会在我的主页上返回：

```
Array
(
    [0] => home
) 
```

当 debug 设置为 0 时为空。

这是我的一些路由：

```
Router::connect('/', array('controller' => 'pages', 'action' => 'display', 'home'));
Router::connect('/login', array('controller' => 'users', 'action' => 'login'));
Router::connect('/logout', array('controller' => 'users', 'action' => 'logout'));

Router::connect('/today', array('controller' => 'users', 'action' => 'today'));
Router::connect('/profile', array('controller' => 'users', 'action' => 'profile'));

$staticPages = array(
        'about',
        'contact'
);

$staticList = implode('|', $staticPages);

Router::connect('/:static', array(
    'plugin' => false,
    'controller' => 'pages',
    'action' => 'display'), array(
        'static' => $staticList,
        'pass' => array('static')
    )
); 
```

从调试日志：

```
2012-04-17 10:28:08 Notice: Notice (8): Undefined variable: loggedIn in [/Users/conrad/Desktop/Creative/DEV/virtutrain/app/View/Elements/Header.ctp, line 3]
Trace:
include - APP/View/Elements/Header.ctp, line 3
View::_evaluate() - CORE/Cake/View/View.php, line 908
View::_render() - CORE/Cake/View/View.php, line 872
View::element() - CORE/Cake/View/View.php, line 412
include - APP/View/Layouts/default.ctp, line 22
View::_evaluate() - CORE/Cake/View/View.php, line 908
View::_render() - CORE/Cake/View/View.php, line 872
View::renderLayout() - CORE/Cake/View/View.php, line 527
View::render() - CORE/Cake/View/View.php, line 471
Controller::render() - CORE/Cake/Controller/Controller.php, line 959
ExceptionRenderer::_outputMessage() - CORE/Cake/Error/ExceptionRenderer.php, line 263
ExceptionRenderer::error400() - CORE/Cake/Error/ExceptionRenderer.php, line 209
ExceptionRenderer::render() - CORE/Cake/Error/ExceptionRenderer.php, line 165
ErrorHandler::handleException() - CORE/Cake/Error/ErrorHandler.php, line 127
[main] - [internal], line ?? 
```

错误日志：

```
2012-04-17 10:28:08 Error: [NotFoundException] Not Found
#0 /Users/conrad/Desktop/Creative/DEV/virtutrain/lib/Cake/View/View.php(908): include()
#1 /Users/conrad/Desktop/Creative/DEV/virtutrain/lib/Cake/View/View.php(872): View->_evaluate('/Users/conrad/D...', Array)
#2 /Users/conrad/Desktop/Creative/DEV/virtutrain/lib/Cake/View/View.php(463): View->_render('/Users/conrad/D...')
#3 /Users/conrad/Desktop/Creative/DEV/virtutrain/lib/Cake/Controller/Controller.php(959): View->render('about', NULL)
#4 /Users/conrad/Desktop/Creative/DEV/virtutrain/app/Controller/PagesController.php(88): Controller->render('about')
#5 [internal function]: PagesController->display('about')
#6 /Users/conrad/Desktop/Creative/DEV/virtutrain/lib/Cake/Controller/Controller.php(485): ReflectionMethod->invokeArgs(Object(PagesController), Array)
#7 /Users/conrad/Desktop/Creative/DEV/virtutrain/lib/Cake/Routing/Dispatcher.php(103): Controller->invokeAction(Object(CakeRequest))
#8 /Users/conrad/Desktop/Creative/DEV/virtutrain/lib/Cake/Routing/Dispatcher.php(85): Dispatcher->_invoke(Object(PagesController), Object(CakeRequest), Object(CakeResponse))
#9 /Users/conrad/Desktop/Creative/DEV/virtutrain/app/webroot/index.php(96): Dispatcher->dispatch(Object(CakeRequest), Object(CakeResponse))
#10 {main} 
```

再次......当调试处于 1 或 2 时，不会出现任何错误......

此安装在 MAMP 上本地运行，但在 MediaTemple 的网格服务上运行的已发布站点上也会出现错误（具有或多或少的默认设置）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T12:51:51.203

Wow... this was sitting in my home.ctp Page view, and got copied to all other pages:

```
if (Configure::read('debug') == 0):
    throw new NotFoundException();
endif; 
```

Major wtf, but regardless... problem solved.