# StackOverflow 问答 000607000-000607999

# tfs - 如何在多个 TFS 构建脚本之间共享一个属性？

> ID：607008
> 
> 赞同：0
> 
> 时间：2009-03-03T16:07:16.223
> 
> 标签：tfs, msbuild

我有 3 个构建脚本，它们创建分布式应用程序套件的单独组件。它们存储在如下文件夹结构中：

LegacyComponents *- “实时”但正在被替换的 VB6 代码*
NewComponents *- 在 C#*
数据库中重写组件
TeamBuildTypes
└ LegacyBuild
└ NewBuild
└ DatabaseBuild

在每个构建文件夹中，我都有一个名为 TFSBuild.proj 的脚本。

因为构建是独立的，所以它们每个都被赋予一个不同的构建号。我需要用一个将它们联系在一起的字符串来标记每一个，这样我就可以“获取”一个标签并拥有整个一致的代码集。

我用 KitNumber 属性创建了一个名为 KitNumber.targets 的文件，并将它放在 TeamBuildTypes 文件夹中。然后我在每个构建脚本中加入以下行：

`<Import Project=".\..\KitNumber.targets"/>`

我现在应该能够在一个地方更改套件编号并将其应用于每个构建。

这适用于我的开发盒，因为源已经从 TFS 中关闭，但在构建机器上失败，因为只有包含构建脚本的目录的内容被关闭。

那么我在哪里存储共享属性以便我可以在每个脚本中使用它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-04T12:25:34.050

使用包含我要应用的标签的单行文本文件：

```
<Target Name="ApplyKitNumberLabel" Condition="$(KitNumber) != ''">

  <ReadLinesFromFile File="$(WorkspaceRoot)\TeamBuildTypes\KitNumber.txt">
    <Output TaskParameter="Lines"
      PropertyName="KitNumber" />
  </ReadLinesFromFile>

  <Label TeamFoundationServerUrl="$(TeamFoundationServerUrl)"
         Files="$(WorkspaceRoot)\$(BranchName)\LegacyComponents"
         Name="$(KitNumber)"
         Recursive="True" />

</Target> 
```

# asp.net - SelectedIndex = -1 与数据绑定组合

> ID：607009
> 
> 赞同：0
> 
> 时间：2009-03-03T16:07:35.147
> 
> 标签：asp.net, validation, combobox

当组合是数据绑定时，是否有任何等价物？我之前已经经历过数百次，但我正在经历一个大脑冻结的时刻。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T16:10:28.993

在 asp.net 中，您可以获得的最接近的方法是添加一个虚假项目，例如“---Select Something---”并将其作为索引 0，然后您将设置并在索引 0 上执行检查，而不是 -1。

例子：

```
dropdownlist1.datasource = DT
dropdownlist1.datatextfield = "EmployeeName"
dropdownlist1.datavaluefield = "EmployeeID"
dropdownlist1.databind

dropdownlist1.items.insert(0, "---"Select An Employee---")

dropdownlist1.selectedindex = 0 
```

然后在您的验证期间，您可以确保检查以确保`selectedindex <> 0`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T16:14:45.223

我过去做过的一个技巧是，如果您的 DataValue 字段将是一个数字字段（例如 Id），您可以为其分配一个范围验证器对象并检查该值本身是否大于 0。然后我创建我的“选择”项目，使其值为 -99，然后我可以在客户端执行验证。

# c# - 在我的 C# 到 PHP 代码转换中没有得到 sha1 匹配，我错过了什么？

> ID：607017
> 
> 赞同：0
> 
> 时间：2009-03-03T16:09:53.317
> 
> 标签：c#, php, hash, forms-authentication, sha1

我试图理解这一点，所以我可以做类似的事情。我知道：

buf 包含一个附加了哈希的身份验证密钥（最后 20 个字节） 在 MachineKeySection 中查找的 HashData 是 SHA1

```
length -= 20;
byte[] buffer2 = MachineKeySection.HashData(buf, null, 0, length);

for (int i = 0; i < 20; i++)
{
    if (buffer2[i] != buf[length + i])
    {
        return null;
    }
} 
```

这就是我认为正在发生的事情：我们正在散列除 buf 的最后 20 个字节之外的所有内容。然后，我们一次 1 个字节，将我们刚刚创建的散列与附加到 buf 的最后 20 个字节的散列进行比较。

所以在PHP中我正在尝试这个：

```
//get the length of the ticket -20 bytes
$ticketLn = strlen($buf)-40;
//grab all but the last 20 bytes
$ticket = substr($decrypthex, 0, $ticketLn);
//create a hash of the ticket
$hash = substr($decrypthex, $ticketLn); 
```

下一步是比较。但是当我回显 $hash 和 sha1($ticket) 的输出时，它们不匹配，所以我什至没有费心在代码中比较它们。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T16:29:42.630

默认情况下，php 的[sha1() 函数](http://us2.php.net/sha1)返回一个 40 个字符的十六进制数。如果这是您想要的，您必须明确请求 20 字节的二进制格式

```
$hash = sha1( $ticket, true ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T16:14:51.307

```
$ticket = substr($decrypthex, 0, -20);
$hash = substr($decrypthex, -20); 
```

# php - MYSQL PHP：检查已经查询不同的字段值？

> ID：607027
> 
> 赞同：0
> 
> 时间：2009-03-03T16:11:54.543
> 
> 标签：php, sql, mysql, select, distinct

我有一个页面列出了从 mysql 查询返回的产品。查询可以很大程度上取决于许多不同的事物。

我想要做的是给用户一个选项，通过一系列下拉列表来缩小当前结果。例如缩小产品类型。但是为了获得可用的产品类型，我目前只是从数据库中检查产品类型的不同值。这并不理想，因为如果某个特定产品类型不在任何当前结果中，那么它将不会显示任何结果。所以基本上我只想从当前查询结果中而不是从整个数据库中选择不同的值。

一旦查询完成，有没有办法可以做到这一点？

我正在寻找类似的东西：

```
SELECT DISTINCT product_field FROM (my_other_query) 
```

谢谢！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T16:14:18.313

当然，只需命名查询：

```
SELECT DISTINCT product_field FROM (SELECT * FROM table1 JOIN ... WHERE ...) oq 
```

# java - creating instances of classes

> ID：607031
> 
> 赞同：0
> 
> 时间：2009-03-03T16:12:46.303
> 
> 标签：java, object

I am currently working on some code with which I am having some trouble.

I have two buttons on a GUI. If one button is pressed it assigns a value to a string a value to reflect this.

The other button is the same except that a different value is assigned to the string.

This String is created at the beginning before the constructor in the following manner:

```
public string s = "String"; // public so I can call it in another class 
```

The problem comes when I want to find out which button was pressed in another class. I want to see what `s` is so I have to create an instance of that class GUI:

```
gui = new GUI(); 
```

This then resets the value of `s` to "String" again and this ruins my comparison.

Is there any way I can get around this?

I've tried lots of ideas but nothing seems to work.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T16:17:58.430

When you initially create the GUI (i.e. `GUI gui = new GUI();`), save that reference for when you want to access the member `s`.

When you create a new GUI object, that new object was never manipulated by the user, so its `s` value is just `"String"`. You need to hold the reference to the original object.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T16:18:40.347

It is probably better practice to pass the state of your first form to the second form or have the first form inform the second form that a particular event has occurred in real time. Otherwise you would need to pass a reference of the first form to the second form to do the comparison you are trying IE:

```
public class SecondForm {
    private FirstForm _firstForm = null;
    public SecondForm(FirstForm firstForm){
        _firstForm = firstForm;
    }

    ...

    if(_firstForm.s == "comparison"){
        ...
    }
}

SecondForm secondForm = new SecondForm(this); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-03-03T16:18:15.293

in the comments below this post, myself and 2 other individuals have determined that you should learn the java langauge, research the notion of object oriented programming (including object scope), and then learn how to implement the proper event handling code - there are several ways in which you can accomplish what you want, i would suggest a combination of the code i provided along with the reference suggestion supplied by Welbog up above (this of course, will require modification of my code, but not much actually if your main class is somewhere else)

basically, **google a java tutorial (or buy a book/"acquire" a book), and if you know some basic concepts skip ahead to the object-oriented part.**

if i follow what you want, here's some skeleton code:

```
// imports

public class GUI extends JFrame implements ActionListener {
    public String s = "String";

    public GUI() {
        // initializer code for buttons
        btn1.addActionListener(this);
        btn2.addActionListener(this);
    }

    public void actionPerformed(ActionEvent e) {
        if(s == "???")
            s = "this";
        else
            s = "that";
    }

    // other methods

} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-03-03T16:34:53.600

I would use a listener for observing the state of the 'string' variable.

```
public class Gui
{
    public static final String STRING_PROPERTY = "string";
    private String string = "String";
    private PropertyChangeSupport propertyChangeSupport = new PropertyChangeSupport(this);

    private void setString(String string)
    {
        String oldValue = this.string;
        this.string = string;
        propertyChangeSupport.firePropertyChange(STRING_PROPERTY, oldValue, this.string);
    }

    public void addPropertyChangeListener(String propertyName, PropertyChangeListener listener)
    {
        propertyChangeSupport.addPropertyChangeListener(propertyName, listener);
    }
} 
```

This snippet just demonstrates how to add propertyChangeListener support to your class. The class that is interested in knowing the value of 'string' would implement PropertyChangeListener and be added to through the 'addPropertyChangeListener' method.

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-03-03T16:38:31.453

You could use an ActionListener and an action command on each button as shown in this code

```
public class GUI  extends JFrame implements ActionListener
{
  public static final String BUTTON_1_PRESSED = "BUTTON_1_PRESSED";
  public static final String BUTTON_2_PRESSED = "BUTTON_2_PRESSED";

  public String s = "String";

  public GUI()
  {
    // create buttons
    button1.addActionListener(this);
    button1.setActionCommand(BUTTON_1_PRESSED);
    button2.addActionListener(this);
    button2.setActionCommand(BUTTON_2_PRESSED);
  }

  public void actionPerformed(ActionEvent e) 
  {
    if(e.getActionCommand().equals(BUTTON_1_PRESSED))
    {
      s = "this";
    }
    else if(e.getActionCommand().equals(BUTTON_2_PRESSED))
    {
      s = "that";
    }
  }
} 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-03-03T16:30:38.960

It's very difficult to decipher your question. But in general, if you want to know which button it was that caused an event, add a different `ActionListener` to each one (or its model). Keep the code as clean and simple as possible.

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2009-03-03T16:19:02.077

create an extra value that holds the button(name). Change the value when you click on the appropiate button and read it out from a different class. Basicly the same idea as s

# svn - 生成 svn 存储库中文件的完整 URL 的命令行？

> ID：607041
> 
> 赞同：2
> 
> 时间：2009-03-03T16:15:03.443
> 
> 标签：svn

我在 svn 的一个目录中，我想通过聊天告诉另一个开发人员关于那里的文件。

是否有一个简单的命令来获取该文件的完整 URL - 让我们说一些他可以作为参数发送到 svn export 或类似的东西。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-03T16:18:28.397

```
svn info «your_file» | grep URL 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T16:18:30.190

像“svn info”[文件]

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-01-31T19:29:17.033

这就是我所做的。它执行将其复制到剪贴板的附加步骤，以便您可以粘贴到浏览器或电子邮件中：

getUrl.bat：

```
@echo off

svn info %1 | grep URL | sed -e s/URL://g | clip 
```

这假设您已经安装了[cygwin](http://www.cygwin.com/)和 clip.exe 并在您的 PATH 上。Clip.exe 在最新版本的 Windows 中（2k3 Server 之后）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-28T17:05:00.450

您可以使用`svn info --xml`生成所有信息数据的 XML 转储。您可以使用它`xmllint --xpath`来准确提取正确的数据。小包装器[svninfo](http://ceving.blogspot.de/2013/11/reading-subversion-information-in.html)简化了使用：

```
svninfo /info/entry/url 
```

对于 URL，简单的`grep`可能就足够了，但对于其他值，精确的 XPath 表达式比`grep`.

# sql - Oracle：如何只返回部分结果？

> ID：607045
> 
> 赞同：1
> 
> 时间：2009-03-03T16:15:50.290
> 
> 标签：sql, oracle

我正在使用 Oracle 数据库。

在我的查询中，获取了 100 行。如果我想过滤 rownum 50 和 60 之间的行，查询会是什么？

```
SELECT EMPLID, EFFDT, ACTION, ACTION_REASON 
from JOB where emplid ='12345' 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-03T16:27:31.137

大多数人通常会告诉您使用 ROWNUM 来执行此操作，但更简洁的方法是使用 row_number() 分析函数。

```
select EMPLID, EFFDT, ACTION, ACTION_REASON
from
(
SELECT EMPLID, EFFDT, ACTION, ACTION_REASON, row_number() over (order by emplid) rn
from JOB where emplid ='12345'
)
where rn between 50 and 60; 
```

使用 row_number 函数允许您在单个查询中对结果进行排序和编号，然后您只需要一个包装查询即可获得所需的行。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-03T17:08:08.557

由于我比较了[乍得](https://stackoverflow.com/users/41665/chad-birch)和[尼克的](https://stackoverflow.com/users/62985/nick)方法来对尼克的回答发表评论，我想我会在这里发布我的发现。我使用 Tom Kyte 的[runstats](http://asktom.oracle.com/tkyte/runstats.html)包将它们与这个脚本进行比较：

```
begin
   runstats_pkg.rs_start('Chad');
   for i in 1..10000 loop
     for r in (
      SELECT EMPLID,EFFDT,ACTION,ACTION_REASON
      FROM (SELECT ROWNUM rnum, EMPLID,EFFDT,ACTION,ACTION_REASON
            FROM (SELECT EMPLID,EFFDT,ACTION,ACTION_REASON
                  FROM JOB
                  WHERE emplid = '12345')
            WHERE rownum <= 60
      )
      WHERE rnum >= 50
      ) loop
        null;
      end loop;
   end loop;
   runstats_pkg.rs_middle('Nick');
   for i in 1..10000 loop
     for r in (
      select EMPLID, EFFDT, ACTION, ACTION_REASON
      from
      (
      SELECT EMPLID, EFFDT, ACTION, ACTION_REASON, row_number() over (order by emplid) rn
      from JOB where emplid ='12345'
      )
      where rn between 50 and 60
      ) loop
        null;
      end loop;
    end loop;
   runstats_pkg.rs_stop(0,false,false,false,false,false,false,false,false);
end;
/ 
```

结果：

```
Run1 = Chad
Run2 = Nick

*** Comparative Time Report ***
Run                                   Time (hsecs)
--------------------------------------------------
Run1                                            69
Run2                                            77

Run1 ran in 89.61% of the time of Run2
Run2 ran in 111.59% of the time of Run1

PL/SQL procedure successfully completed. 
```

使用自动跟踪可以看出计划非常相似：

```
SQL>           SELECT EMPLID,EFFDT,ACTION,ACTION_REASON
  2            FROM (SELECT ROWNUM rnum, EMPLID,EFFDT,ACTION,ACTION_REASON
  3                  FROM (SELECT EMPLID,EFFDT,ACTION,ACTION_REASON
  4                        FROM JOB
  5                        WHERE emplid = '12345')
  6                  WHERE rownum <= 60
  7            )
  8            WHERE rnum >= 50
  9  /

no rows selected

Execution Plan
----------------------------------------------------------

------------------------------------------------------------------------------
| Id  | Operation                     | Name    | Rows  | Bytes | Cost (%CPU)|
------------------------------------------------------------------------------
|   0 | SELECT STATEMENT              |         |     1 |    41 |     3   (0)|
|*  1 |  VIEW                         |         |     1 |    41 |     3   (0)|
|*  2 |   COUNT STOPKEY               |         |       |       |            |
|   3 |    TABLE ACCESS BY INDEX ROWID| JOB     |     1 |    13 |     3   (0)|
|*  4 |     INDEX RANGE SCAN          | JOB2_PK |     1 |       |     2   (0)|
------------------------------------------------------------------------------

Predicate Information (identified by operation id):
---------------------------------------------------

   1 - filter("RNUM">=50)
   2 - filter(ROWNUM<=60)
   4 - access("EMPLID"=12345)

Statistics
----------------------------------------------------------
          1  recursive calls
          0  db block gets
          2  consistent gets
          0  physical reads
          0  redo size
        264  bytes sent via SQL*Net to client
        231  bytes received via SQL*Net from client
          1  SQL*Net roundtrips to/from client
          0  sorts (memory)
          0  sorts (disk)
          0  rows processed

SQL>           select EMPLID, EFFDT, ACTION, ACTION_REASON
  2            from
  3            (
  4            SELECT EMPLID, EFFDT, ACTION, ACTION_REASON, row_number() over (order by emplid) rn
  5            from JOB where emplid ='12345'
  6            )
  7            where rn between 50 and 60
  8  /

no rows selected

Execution Plan
----------------------------------------------------------

------------------------------------------------------------------------------
| Id  | Operation                     | Name    | Rows  | Bytes | Cost (%CPU)|
------------------------------------------------------------------------------
|   0 | SELECT STATEMENT              |         |     1 |    41 |     3   (0)|
|*  1 |  VIEW                         |         |     1 |    41 |     3   (0)|
|*  2 |   WINDOW NOSORT STOPKEY       |         |     1 |    17 |     3   (0)|
|   3 |    TABLE ACCESS BY INDEX ROWID| JOB     |     1 |    17 |     3   (0)|
|*  4 |     INDEX RANGE SCAN          | JOB2_PK |     1 |       |     2   (0)|
------------------------------------------------------------------------------

Predicate Information (identified by operation id):
---------------------------------------------------

   1 - filter("RN">=50 AND "RN"<=60)
   2 - filter(ROW_NUMBER() OVER ( ORDER BY "EMPLID")<=60)
   4 - access("EMPLID"=12345)
       filter("EMPLID"=12345)

Statistics
----------------------------------------------------------
          1  recursive calls
          0  db block gets
          2  consistent gets
          0  physical reads
          0  redo size
        264  bytes sent via SQL*Net to client
        231  bytes received via SQL*Net from client
          1  SQL*Net roundtrips to/from client
          0  sorts (memory)
          0  sorts (disk)
          0  rows processed 
```

看起来这两种方法之间没有太多选择，尽管乍得在我的数据库上始终稍快一些，即：

Oracle 数据库 10g 版本 10.2.0.3.0 - 64 位生产

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-03T16:21:46.033

这在 Oracle 中有点棘手，我认为你必须这样做：

```
SELECT EMPLID,EFFDT,ACTION,ACTION_REASON
FROM (SELECT ROWNUM rnum, EMPLID,EFFDT,ACTION,ACTION_REASON
      FROM (SELECT EMPLID,EFFDT,ACTION,ACTION_REASON
            FROM JOB
            WHERE emplid = '12345')
      WHERE rownum <= 60
)
WHERE rnum >= 50; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T16:22:05.440

您可以使用 ROWNUM（请参阅[此链接](http://www.oracle.com/technology/oramag/oracle/06-sep/o56asktom.html)）。如果您需要控制排序顺序，您可以围绕您的查询包装另一个查询。

# c# - ASP.NET 页面属性好主意或坏主意

> ID：607046
> 
> 赞同：2
> 
> 时间：2009-03-03T16:15:54.877
> 
> 标签：c#, asp.net, properties

我倾向于回避向我的 ASP.NET 页面添加属性。对我来说，这从来都不是一个好主意。但是，最近我在一些示例应用程序中看到了这种做法。我对向页面添加自定义属性的反感是没有根据的还是这是“取决于”情况？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-03T16:19:22.293

我认为使用属性清理服务器端页面上的代码没有任何问题。我喜欢使用属性来访问会话状态或视图状态信息，这样如果我修改访问数据的方式，我只更改一个地方。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-03T16:21:04.100

您需要记住的关于属性的事情是它们会持续整个页面生命周期。这使得它们既非常有用（在生命周期的早期设置一个属性，它在以后仍然有效）又很危险（在设置之前很容易访问一个属性，或者没有意识到另一个生命周期阶段改变了它）。

我见过的一个非常有效的属性是作为包装查询字符串和 Session 的一种很好的类型安全方式。为每个预期的查询字符串或会话值定义属性，未来的开发人员将非常清楚预期和可用的内容。

另一个常见用途是包装 ViewState 项。我希望这是您在示例中看到它们的地方，因为大多数示例倾向于假定 ViewState 已打开。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-03T16:19:23.870

Asp.net 不支持基于构造函数的注入。这是一个明确的场景，您希望使用 asp.net 属性（因为您可以使用基于属性的注入）。

更新 1：这是一个类似的场景，但用于控件 -[如何将依赖注入与 ASP.NET Web 窗体一起使用](https://stackoverflow.com/questions/589374/how-to-use-dependency-injection-with-asp-net)

**更新 2：**可以使用它们来包装视图状态或查询字符串。不过，我会仔细查看它，因为您不想滥用代码隐藏。如果您看到您在代码隐藏中多次使用包装属性之一，则代码隐藏中可能有太多代码。以这种方式看待它的副作用是避免与这些属性相关联的重复转换/解析。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-03T16:52:16.880

页面上的属性没有任何问题。他们可能会觉得奇怪，因为页面很少被外部代码作为对象操作，但可以做到。鉴于此，页面上的大多数属性都可以标记为私有。像所有事物一样，也有例外。

我对页面上的属性的最大用途之一是包装 ViewState 值时：

```
protected string TaskName
{
    get { return (string)ViewState["TaskName"] ?? string.Empty; }
    set { ViewState["TaskName"] = value; }
} 
```

在这种情况下，我已将该属性标记为“受保护”，这允许我从我的标记中访问它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-03T16:19:19.800

为什么会很糟糕？属性实际上只是方法，我相信您一直在向页面添加方法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-03T16:22:27.000

我在我的 asp.net 页面上使用属性来访问会话、视图状态和查询字符串。它只是让您编写更少的代码并提高可读性

# c# - 开源 MPG 到 FLV 转换器？

> ID：607047
> 
> 赞同：0
> 
> 时间：2009-03-03T16:16:36.933
> 
> 标签：c#, .net, actionscript-3, open-source

任何人都知道或使用我可以以编程方式使用的开源 MPG 到 FLV 转换器吗？最好是 .NET 。如果您还知道任何 .NET 商业链接，那么我也会感谢这些链接。

干杯，

安德鲁

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-03T16:21:37.890

我认为你可以用 FFMPEG 做到这一点。

这里有一个 .NET 包装器[。](http://ffmpegdotnet.codeplex.com/)

**编辑：**

看起来 codeplex 上的 .NET 包装器还没有完全完成。您可能想看看 coding4fun 网站上的[InnerTube](http://www.c4fbook.com/innertube)项目，因为它会下载 flv 文件并将它们转换为 wmv。源代码可能会为您指明正确的方向。

# php - 使用 PHP/MySQL 的分层递归菜单

> ID：607052
> 
> 赞同：3
> 
> 时间：2009-03-03T16:17:05.217
> 
> 标签：php, mysql, recursion

对于你们中的一些人来说，这应该（希望）是一个非常容易回答的问题。

我有一个来自 mySQL 数据库的有效递归菜单，现在我的主要问题是：

创建 URL 的最佳方法是什么？我更愿意引入每一行的标题，例如 /eggs/milk/bacon/。0 级的鸡蛋，例如：eggs-0、milk-1、bacon-2。关于如何动态输出这个的任何想法？

我非常喜欢“cletus”对这个问题的一些评论： [PHP/MySQL - building a nav menu hierarchy](https://stackoverflow.com/questions/477793/php-mysql-building-a-nav-menu-hierarchy)

但我需要更多关于如何做到这一点的解释。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-04T16:20:58.587

好吧，如果你想要一个层次结构，最好的方法是我所知道的称为“修改的预序树遍历”，[在这篇 Sitepoint 文章](http://www.sitepoint.com/print/hierarchical-data-database/)中有详细描述，大约从一半开始。

与 Guss 建议的主要区别在于，仅获取您正在寻找的树的一部分会更高效且更容易。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-04T09:43:55.873

除非您打算经常修改菜单树，否则为每个菜单项预先存储所需的分层 URL 可能是最简单的（对于运行时解析）。

如果您希望树经常被修改，比方说 - 通过 Web 界面，那么每次阅读菜单时生成路径会更容易，如下所示：

```
 id | name   | parent
----+--------+-------
 0  | eggs   | NULL
 1  | milk   | 0
 2  | bacon  | 1
 3  | tomato | 0
 4  | lettuce| 1

foreach (query("SELECT * FROM menu ORDER BY parent ASC") as $row) {
  $menuitem = array_merge(array(), $row);
  $menuLookup[$menuitem['id']] &= $menuitem;
  if ($menuitem['parent'] == null) {
    $menuitem['path'] = "/" . $menuitem['name'];
    $menu[] &= $menuitem[];
  } else {
    $parent &= $menuLookup[$menuitem['parent']];
    $menuitem['path'] = $parent['path'] . "/" . $menuitem['name'];
    $parent['menu'][] &= $menuitem;
  }
} 
```

我没有调试过这段代码，只测试了它的正确性；-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-29T22:40:09.263

我用 groovy 写了一些东西：http: [//blog.srvme.de/2009/11/29/reading-a-reflexive-association-in-a-recursive-way-for-grails-and-groovy/](http://blog.srvme.de/2009/11/29/reading-a-reflexive-association-in-a-recursive-way-for-grails-and-groovy/)

# language-agnostic - 命名时我们在哪里与词汇划清界限？

> ID：607054
> 
> 赞同：5
> 
> 时间：2009-03-03T16:17:50.427
> 
> 标签：language-agnostic

前几天我在查看我们的代码时遇到了一个类名 *IdempotentObject*，当时我不知道这是什么意思，所以我质疑它是否是一个选择不当的名称。我找到了它的作者，并问开发者为什么他把它命名得如此混乱。他很惊讶我不知道这意味着什么，并告诉我这是一个很好的选择名称，因为该对象是幂等的。

一方面，我看到了一个论点，即保持简单，让每个人在第一次阅读时都明白一切是什么。另一方面，我们认为我们应该准确地命名事物，如果您不知道其含义，请查找它。

哪一个更好、更精确或一目了然？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-03T16:21:39.310

没有冒犯，但是任何拥有计算机科学学位或希望在该领域实践的人都应该认识到“幂等”这个词在计算机科学中具有特定的含义，即使你不知道这个词并且必须查找它。

另一方面，我认为对象的名称中不应包含“对象”一词——这是多余的。

现在，如果它被称为“IdempotentDataAccessor”或既精确又具有描述性的东西，那就太好了。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-03T16:20:34.210

精确更重要。最初的开发人员或您可以在之后留下评论来解释命名，如果它不是一个可以在字典中轻松找到或通常为观众所知的术语。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-03T16:22:44.877

“当时我不知道这意味着什么，**所以我**认为这是一个选择不当的名字。”

有你的问题。如果您不知道某事意味着什么，正确的回答是找出答案。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-03T16:21:04.490

我建议将名称限制为问题范围内的名称。对于高级数学应用程序来说，幂等是可以接受的。如果这是一个会计应用程序，我更愿意使用另一个名称。

在某些情况下，评论可能会有所帮助，但我更喜欢更改名称。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-03T16:24:06.993

作为开发人员，您习惯于查看代码，注意到您不熟悉的语言或库的功能，查找它并将其合并到您自己对该语言的使用中。

这没有什么不同。

您不会强迫其他人避免 C# 的鲜为人知的功能，您为什么要为英语或任何其他语言这样做？

看看，学习一下。是否使用由您自己决定，但请不要限制他人的使用。你有参考。

-亚当

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-03T16:23:10.490

我想不出任何其他简洁的方式来描述幂等性。我认为这不是问题，因为幂等性是 RESTful 接口中非常常用的术语，并且在 Google 搜索中很容易找到清晰的描述。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-03T16:22:38.277

嗯，这是非常主观的。也许对于编写课程的人来说，这个名字很容易理解。很难确定哪些词汇容易或难以理解，因为阅读代码的人可能有许多不同的背景。

# asp.net - ASP.Net 日历/事件应用程序

> ID：607059
> 
> 赞同：3
> 
> 时间：2009-03-03T16:18:32.420
> 
> 标签：asp.net, calendar

我想知道是否有任何免费的 asp.net 日历/事件跟踪应用程序。我希望能够将一些东西插入我现有的网站，让管理员登录并将事件添加到日历中。然后，用户可以在首页上看到即将发生的事件的链接的简短列表，然后他们可以单击以查看更多详细信息。外面有这样的吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T19:42:44.770

我肯定会从看[DayPilot](http://www.daypilot.org/)开始。如果您只想要一个漂亮的（但只读的）类似 Outlook 的日程安排组件，它有一个免费的“轻量级”版本，但付费版本的功能要全面得多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-05T14:30:12.527

另一种选择是[VCalendar](http://www.scripts.com/asp-scripts/calendar-scripts/vcalendar-an-open-source-web-calendar/)。我没有使用过它，但看起来它看起来像是我会使用的可靠日历应用程序。

# tdd - TDD 和 JPEG 压缩

> ID：607067
> 
> 赞同：31
> 
> 时间：2009-03-03T16:19:21.623
> 
> 标签：tdd

在[臭名昭著的 Stack Overflow #38 播客中，](https://blog.stackoverflow.com/2009/01/podcast-38/) [Joel Spolsky](http://en.wikipedia.org/wiki/Joel_Spolsky)谈到了为 JPEG 压缩之类的东西执行 TDD 是多么困难。Bob Martin[想](http://blog.objectmentor.com/articles/2009/02/06/on-open-letter-to-joel-spolsky-and-jeff-atwood)在播客 #41 中介绍如何为一个实例进行 TDD，但我认为他们没有做到。因此：

如何使用 TDD 开发和测试 JPEG 压缩？

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2009-03-04T01:20:22.167

乔尔的问题是这样的。假设您想在某处设置一个位，导致显示低分辨率图像而不是高分辨率图像。您将如何使用 TDD 来实现它？你会写一个测试来显示图像是低分辨率的吗？

当然不是。您已经知道 JPEG 库可以工作。您已经知道，如果您使用正确的参数调用它，它将以低分辨率显示。您需要测试的是您设置的位是否被转换为对 JPEG 库的适当调用。因此，您使用一个由您的测试控制的非常简单的模块来模拟 JPEG 库。然后设置位，并请求显示。Mocked JPEG 库会记住它是如何被调用的，然后测试可以检查以确保它被正确调用。

好的，那么您将如何测试 JPEG 库的内部结构？我不太了解 JPEG 渲染，但我认为它与压缩、解压缩和位图有关。压缩和解压缩只是算法。算法具有来自给定输入的可预测输出。因此，您设置了一系列非常简单的输入，并确保获得可预测的输出。您设置输入以便覆盖 JPEG 算法的内部。相同的逻辑适用于位图。您不必在屏幕上渲染它们。可以将简单的小位图渲染到测试可以检查的内存缓冲区中。简单，我的意思是简单。3X3、5X5、8X8。简单的。同样，您构建输入数据以覆盖大部分代码。

这些都不是火箭科学。如果它是完美的，则没有。但是，一套 50 个测试证明 90% 的逻辑是正确的，当您想要进行更改时，可能会产生巨大的影响。

你能完全消除手动测试吗？当然不是。但是你*可以*显着减轻它。您可以将手动测试减少为几个非常具有战略意义的测试，而不是数千个令人痛苦乏味的测试计划。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-03T16:31:56.273

如果您认为 TDD 意味着测试先于任何代码或任何设计，那在很大程度上是不可能的。对于复杂的算法，您需要一些结果。而且在压缩的情况下，结果很难手工制作。不是不可能，但很难。

此外，压缩需要非常高性能的算法。仅仅通过测试是不够的。许多低性能算法可以通过基本的“正确性”测试。

要超越正确性，您需要证明您的算法是最优的。这只能在测试世界观之外发展。您需要使用**O** ( *something* ) 进行复杂性分析，这不是测试的结果；也不能很好地定义为测试的结果。

另一方面，如果您认为“可测试性”出现在大多数代码之前，那么这很容易。

*   设计你的算法。写一个证明它是最优的。

*   编写一些代码，将算法的关键部分公开为可测试的模块。

*   在某些情况下，编写代码来生成整体算法的测试结果。这可能是次优的蛮力代码，通过非常明显但缓慢的算法产生正确的答案。

*   组装一个单元测试以显示您的实现产生了预期的测试结果。

*   汇编一篇技术论文以证明它也是最优的。

这不是测试优先。但它是测试驱动的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-04T21:55:22.120

测试驱动开发不仅是编程，您还可以先使用测试来做很多其他事情，例如验收 tdd 等。

首先想想你希望它如何表现，这就是问题。对于算法，示例可能类似于：

*   “它必须在 10 秒内完成 5 次通话”
*   “它必须缩小到图像大小的 10%”
*   其他。

我相信清楚地思考你想要完​​成的事情只是一种生活方式：D

# ruby-on-rails - 使用 ActiveRecord，有没有办法在 after_update 期间获取记录的旧值

> ID：607069
> 
> 赞同：88
> 
> 时间：2009-03-03T16:19:23.667
> 
> 标签：ruby-on-rails, activerecord, model, callback

**使用一个简单的示例进行设置：**我有 1 个表 ( )，其中包含第二个表 ( )中每个记录的列`Totals`的总和。`amount``Things`

当 a`thing.amount`得到更新时，我想简单地将旧值和新值之间的差异添加到`total.sum`.

现在我正在减去`self.amount`during`before_update`并添加`self.amount`during `after_update`。这使更新成功的方式过于信任。

**约束：** 我不想简单地重新计算所有交易的总和。

**问题：**很简单，我想在`after_update`回调期间访问原始值。你想出了什么方法来做到这一点？

**更新：**我同意 Luke Francl 的想法。在`after_update`回调期间，您仍然可以访问`self.attr_was`正是我想要的值。我还决定使用一个`after_update`实现，因为我想在模型中保留这种逻辑。这样，无论我决定将来如何更新交易，我都会知道我正在正确更新交易的总和。感谢大家的实施建议。

* * *

## 回答 #1

> 赞同：155
> 
> 时间：2009-03-03T16:33:45.163

每个人都在谈论交易。

那就是说...

Rails 2.1 的 ActiveRecord 跟踪对象的属性值。所以如果你有一个属性`total`，你就会有一个`total_changed?`方法和一个`total_was`返回旧值的方法。

不再需要向模型添加任何内容来跟踪这一点。

**更新：**这是[ActiveModel::Dirty](http://api.rubyonrails.org/classes/ActiveModel/Dirty.html)要求的文档。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2014-07-02T10:09:53.470

将“_was”附加到您的属性将在保存数据之前为您提供先前的值。

这些方法称为[脏方法](http://api.rubyonrails.org/classes/ActiveModel/Dirty.html)方法。

干杯!

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-03-03T16:47:01.683

其他一些人提到将所有这些都包含在事务中，但我认为这已经为您完成了；**您只需要通过在 after_* 回调中引发错误来触发回滚。**

见[http://api.rubyonrails.org/classes/ActiveRecord/Callbacks.html](http://api.rubyonrails.org/classes/ActiveRecord/Callbacks.html)

> 保存、保存！或销毁调用的整个回调链在事务中运行。这包括 after_* 钩子。如果一切顺利，则在链完成后执行 COMMIT。
> 
> 如果 before_* 回调取消了操作，则会发出 ROLLBACK。您还可以触发 ROLLBACK 在任何回调中引发异常，包括 after_* 挂钩。但是请注意，在这种情况下，客户端需要注意它，因为普通保存会引发此类异常，而不是悄悄返回 false。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2013-08-05T18:55:01.523

要获取所有更改的字段，分别具有它们的旧值和新值：

```
person = Person.create!(:name => 'Bill')
person.name = 'Bob'
person.save
person.changes        # => {"name" => ["Bill", "Bob"]} 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-03-03T17:08:05.733

[ActiveRecord::Dirty](http://api.rubyonrails.org/classes/ActiveRecord/Dirty.html)是一个内置在 ActiveRecord 中的模块，用于跟踪属性更改。所以你可以`thing.amount_was`用来获取旧值。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-03T16:32:17.053

将此添加到您的模型中：

```
def amount=(new_value)
    @old_amount = read_attribute(:amount)
    write_attribute(:amount,new_value)
end 
```

然后在 after_update 代码中使用 @old_amount。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2020-11-10T06:53:02.367

如果要在更新后获取特定字段的值，可以使用 field_before_last_save 方法。

```
Example:

u = User.last
u.update(name: "abc")

u.name_before_last_save will give you old value (before update value) 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2021-01-23T00:19:04.410

从**Rails 5.1**开始，inside of after 回调的行为发生`attribute_was`了变化。`attribute_was`将在保存完成后返回值，并在`after_save`or`after_update`回调中返回当前值。

[`attribute_before_last_save`被调用两种方式](https://api.rubyonrails.org/classes/ActiveRecord/AttributeMethods/Dirty.html#method-i-attribute_before_last_save)`after_save`来获取和`after_update`回调中字段的前一个值：

选项1

```
attribute_before_last_save('yourfield') 
```

选项#2

```
*_before_last_save 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-03T16:28:14.380

首先，您应该在事务中执行此操作，以确保您的数据一起写入。

要回答您的问题，您可以在 before_update 中将一个成员变量设置为旧值，然后您可以在 after_update 中访问它，但这不是一个非常优雅的解决方案。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-03T16:28:36.283

想法 1：将更新包装在数据库事务中，这样如果更新失败，您的 Totals 表就不会更改：[ActiveRecord Transactions docs](http://www.railsbrain.com/api/rails-2.2.2/doc/index.html?a=C00000598&name=ActiveRecord::Transactions::ClassMethods "活动记录交易")

想法 2：在 before_update 期间将旧值存储在 @old_total 中。

# xsd - 寻找 XSDClassGen 的下载位置

> ID：607085
> 
> 赞同：1
> 
> 时间：2009-03-03T16:21:44.147
> 
> 标签：xsd, xsdobjectgen

[作为这个问题](https://stackoverflow.com/questions/386155/comparison-of-xsd-codegenerators-c)的后续，我正在寻找可以为我提供 XSDClassGen 链接的人，XSDClassGen 是 XSDObjectGen 的 .NET 2.0“版本”。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T16:35:41.133

它不是 XSDClassGen，但[此 CodePlex 项目](http://ivc.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=13385)的 Utilities 目录中的版本是 XSDObjectGen 的更新版本，它支持泛型（如果对您有任何用处）。感谢一些[随机的德语页面](http://translate.google.com/translate?prev=hp&hl=en&u=http%3A%2F%2Fwww.nldelphi.com%2FForum%2Fshowthread.php%3Fp%3D266430&sl=auto&tl=en)的链接;-)

# c# - C# 摘要注释中的 XML 字符串

> ID：607094
> 
> 赞同：32
> 
> 时间：2009-03-03T16:22:40.883
> 
> 标签：c#, documentation

我正在记录我在 C# 中编写的一些处理解析标记的方法。由于系统其他领域的一些技术限制，这些令牌需要采用 XML 元素的形式（即`<tokenName />`）。我想将这些标记的格式放在摘要语句本身中。

但是，这会引发错误：格式错误的 XML -- 名称以无效字符开头"。是否有任何类型的转义字符序列可用于在 C# 摘要注释中嵌入 XML？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-03-03T16:26:28.317

使用标准 XML 转义。例如：

```
<summary>This takes a &lt;token1&gt; and turns it into a &lt;token2&gt;</summary> 
```

将其作为代码键入或读取并不容易，但 IntelliSense 可以正确地取消转义，您会在工具提示中看到正确、可读的内容。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2009-03-03T16:27:19.827

使用 CDATA 部分。例如：

```
<![CDATA[ <name>Bob</name> ]]> 
```

当您拥有较大的 XML 片段时，这在源代码中比在实体引用中编码特殊字符更优雅和可读。

如果要嵌入的 XML 本身包含 CDATA 部分，则需要使用多个 CDATA 部分，如Stack Overflow或[Wikipedia](https://en.wikipedia.org/wiki/CDATA#Nesting)[上的另一个答案](//stackoverflow.com/a/223782/2157640)中所述。或者，您始终可以使用此处其他答案中所述的普通实体引用。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2011-12-20T08:59:16.657

我使用转义序列，因为 VisualStudios 工具提示不显示 CDATA 部分内的任何内容。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2013-07-01T07:31:05.080

我遇到了同样的问题。使用`<![CDATA[]]>`将隐藏 IntelliSense 中的注释。

更换两者`<`对`>`我来说工作量太大（懒惰:)）。我发现仅仅替换`<`为`&lt;`IntelliSense 就足够了，因为它使 xml 无效并且适合 IntelliSense 解析为摘要块中的文本。

这是一个例子：

```
/// <summary>
/// Parse the queue process response
/// <para>&lt;?xml version="1.0" encoding="utf-16"?>&lt;result success="True">&lt;entity type="resource" operation="update" />&lt;/result></para>
/// <![CDATA[
/// <?xml version="1.0" encoding="utf-16"?><result success="True"><entity type="resource" operation="update" /></result>
/// ]]></summary>
/// <param name="response"></param>
/// <returns></returns> 
```

IntelliSense 将显示：

```
Parse the queue process response
<?xml version="1.0" encoding="utf-16"?><result success="True"><entity type="resource" operation="update" /></result> 
```

# networking - 跨 NAT 使用 DAAP 共享

> ID：607098
> 
> 赞同：0
> 
> 时间：2009-03-03T16:23:49.773
> 
> 标签：networking, routing, itunes, multicast

我有一个 Linksys WRT54G 无线路由器连接到我宿舍里的一个大局域网。我们经常使用 DAAP（iTunes 共享）在不同的休息室和厨房播放我们自己的音乐。当我将笔记本电脑直接连接到 LAN 时，这很好用，但是一旦我通过路由器访问它，我就看不到其他共享，他们也看不到我的共享。问题是，我只能在宿舍的 LAN 上分配一个 IP 地址（必须通过 SSH 进行身份验证才能通过防火墙），所以我不能既通过 DAAP 共享，又让*我*的朋友同时使用我的无线路由器.

我了解这是因为 DAAP 使用 Bonjour 来发布和发现股票。

我的问题是；我可以把我的蛋糕也吃掉吗？有没有办法保留我的无线路由器并转发 Bonjour 发现？可以将它们全部转发到一台机器上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-12-12T01:41:02.913

如果您可以用 OpenWRT 替换路由器的库存固件，您应该可以分两步完成。

第一步是转发路由器上的端口，以便从宿舍的 LAN（从路由器的角度来看，这是 WAN）连接到路由器的 3689 端口（从路由器的角度来看，这是 WAN）连接到笔记本电脑上的 3689 端口（从路由器的角度来看，这是局域网。从你的宿舍局域网的角度来看，这不存在）。你可以用 iptables 做到这一点。

第二步是宣传您的 DAAP 服务。在路由器上安装 avahi 并运行 'avahi-publish-service sharename _daap._tcp 3689'

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T16:36:02.457

您应该能够使用从路由器到笔记本电脑的端口转发。您还必须打开路由器上的 Bonjour 端口。

# asp.net - 在动态数据中设置默认页面

> ID：607100
> 
> 赞同：1
> 
> 时间：2009-03-03T16:24:31.173
> 
> 标签：asp.net, asp.net-dynamic-data

我正在尝试为我的动态数据网站设置默认页面。问题是它是一个模板

所以它会是这样的：Orders/List.aspx

谁能帮我解决这个问题..

谢谢

奥维斯 F

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T16:31:35.587

您可以在 DynamicData 文件夹之外创建一个 Default.aspx 页面作为默认页面，然后将该页面重定向到 Orders/List.aspx 页面。

```
protected void Page_Init(object sender, EventArgs e) {
   Response.Redirect("Orders/List.aspx");
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T16:30:39.490

所以您是说您希望一个目录中的默认页面将您带到另一个目录中的页面？

我不相信你能做到这一点，相反，你必须让目录中的 ASPX 页面重定向到另一个目录中的页面。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T16:32:58.457

为您的默认页面使用模板没有问题。您需要在 IIS 中正确设置虚拟目录。阅读[此信息](http://msdn.microsoft.com/en-us/library/zwk103ab.aspx)，它应该会有所帮助。

# zend-framework - DataGrid for Zend Framework

> ID：607102
> 
> 赞同：2
> 
> 时间：2009-03-03T16:25:25.947
> 
> 标签：zend-framework, datagrid

Can you recommend good data grid component for Zend Framework?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2011-02-10T13:55:30.880

我正在使用[http://www.datatables.net](http://www.datatables.net)并通过 Zend REST 为它们提供定制的 JSON，它可以立即从模型中获取所有数据。工作得很好。

您必须自己生成 JSON 代码，但数据表值得。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T16:46:22.447

[`dojox.grid.DataGrid`](http://api.dojotoolkit.org/jsdoc/dojox/HEAD/dojox.grid.DataGrid)与来自 的数据一起使用[`Zend_Dojo_Data`](http://framework.zend.com/manual/en/zend.dojo.data.html)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-02-10T13:45:51.123

我建议将 ZendX_Jquery 与 jqGrid 一起使用，它是一个 jQuery 插件和非常高级的 Grid 组件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-10T08:24:43.187

这可能是一个迟到的答案，但有一个新[库 (Pike)](http://pike-project.org)构建在 Zend Framework 和 jqGrid 之上，您可能会喜欢它！你也可以在[GitHub 上](https://github.com/php-pike/Pike)找到它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-01-22T11:35:34.973

还有[http://code.google.com/p/kontorx/](http://code.google.com/p/kontorx/)

这个库非常有弹性。您可以将数据呈现为 HTML 表格或 Ext.DataGrid (JavaScript)

实时示例显示了完整的实现。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-03T16:28:12.197

So far I found these projects. But they seem to be in their beginnings so I am not sure if I should invest in adopting them.

1.  [zend-framework-datagrid](http://code.google.com/p/zend-framework-datagrid/)
2.  [zfdatagrid](http://code.google.com/p/zfdatagrid/)

[Zend_DataGrid](http://framework.zend.com/wiki/display/ZFPROP/Zend_DataGrid) seems to be proposed but not yet ready.

It is also recommended to use dojo to create data grid.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-10-11T15:04:57.050

看看这个： [http ://code.google.com/p/zendscaffolding/](http://code.google.com/p/zendscaffolding/)

简单，强大，支持数据关系（1-N，NN）

# visual-studio - 加载配置文件时出错：无法开始监控更改，因为已达到网络 BIOS 命令限制

> ID：607103
> 
> 赞同：2
> 
> 时间：2009-03-03T16:25:37.163
> 
> 标签：visual-studio, visual-studio-2005

这个错误今天早上才开始在一个特定项目中发生。当我尝试发布网站时，它给了我这个错误，我无法完成发布！有时重新启动 Visual Studio 会神奇地解决问题，但它稍后会再次出现。不仅如此，当我重新启动 VS 时，我失去了所有的“撤消功能”。

有一篇关于这个主题的[知识库文章](http://support.microsoft.com/kb/810886)，但它没有帮助。

我能做些什么来一劳永逸地阻止这个*非常烦人的问题？*

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2010-12-11T20:04:53.060

这基本上是说您必须通过网络运行许多连接到您的代码/程序集（或您要连接的任何东西）。这将通过告诉它仅使用 1 并让每个连接都通过它来解决您的问题。我相信这会给你一个真正的解决方案，而不是解决方法。

请记住，您只需要在您的机器上进行这些更改，而不是您想要访问的机器

*   在以下注册表项中添加以下 DWORD 值：HKEY_LOCAL_MACHINE\Software\Microsoft\ASP.NET\FCNMode
*   下面列出了 FCNMode DWORD 值的可能值以及与每个值关联的行为。
*   0 或大于 2 - 这是默认行为。对于每个子目录，应用程序将创建一个监视子目录的对象。
*   1 - 应用程序将禁用文件更改通知 (FCN)。
*   2 - 应用程序将创建一个对象来监控主目录。应用程序将使用此对象来监视每个子目录。我建议将值设置为 1，以禁用 FCN。当您尝试使用调试器时，这就是导致错误的原因。

    不要忘记：如果您运行的是 64 位版本的 Windows，您需要转到 HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\ASP.NET

这篇文章提供了更深入的答案：[http ://bencoffman.com/blog/2010/12/01/Error43AnErrorOccurredLoadingAConfigurationFileFailedToStartMonitoringChangesTo.aspx](http://bencoffman.com/blog/2010/12/01/Error43AnErrorOccurredLoadingAConfigurationFileFailedToStartMonitoringChangesTo.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-26T14:33:24.197

在 C:\ 上构建您的解决方案并不能真正解决问题，它只是避免了它。诚然，这是一个很好的解决方法，但您仍然无法从共享驱动器构建。我在 VS 中遇到了同样的问题，并且能够在**不**移动本地内容的情况下克服它。这是我所做的：

Microsoft 知识库文章或多或少为您提供了正确的方向：

[http://support.microsoft.com/kb/810886](http://support.microsoft.com/kb/810886)

请务必参考它，因为它告诉您调整的注册表项是正确的。

在您的本地计算机上，按照文章所述调整 MaxCmds 和 MaxMpxCt，或者添加它们。当我去检查时，这些值对我来说并不存在，所以我不得不创建它们。如果确实添加了它们，请选择 NEW -> DWORD 值。创建完成后，双击该项目以调整该值。确保在编辑 DWORD 值时单击十进制基数并且不使用十六进制基数。我为 MaxCmds 和 MaxMpxCt 都设置了 500。然后重新启动。

接下来，转到您的共享服务器，然后执行完全相同的操作。重新开始。

这些注册表项的值范围在 0 到 65535 之间，因此您可能需要进行相应调整，但对我来说 500 有效。

最后一件事...备份您的注册表永远不会受到伤害.. ;)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T18:29:53.480

网络管理员建议我从本地开发机器的 C: 运行我的解决方案。必须创建一个批处理文件来全天手动将源代码文件复制到网络驱动器（以便备份）。

# java - 在正在运行的系统上交换进出逻辑

> ID：607106
> 
> 赞同：2
> 
> 时间：2009-03-03T16:26:16.023
> 
> 标签：java, design-patterns, oop

我想设计这个系统，它有两个主要组成部分：

1.  基础/核心的东西。永不改变。
2.  在核心上运行的东西。变化相当频繁。

这将在 Java 中开发，但该问题适用于任何经典的 OO 语言。如何在运行的系统中替换上面的 2 而无需重新编译 1，甚至在运行时不停止 1。重新编译2没问题，但我不应该打扰1。

是否有任何设计模式可以做到这一点？我认为这有点类似于插件行为，但 2 实际上对应用程序的工作至关重要，而不仅仅是一个附加组件。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-03T16:32:31.827

没有更多信息很难回答……但您可以查看[OSGi](http://en.wikipedia.org/wiki/OSGi)作为一些想法的起点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T16:31:34.263

我们需要更多信息来解决这个问题。如果您谈论的是在运行时加载全新的逻辑，那可能会非常困难。如果您只是在谈论交换实现，则可以使用策略模式轻松完成。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-03T16:31:45.760

你需要一个插件模式来处理你经常变化的东西，再加上一些重新启动插件的界面。您的核心/基础 (1) 将负责动态加载包含您经常更改的内容 (2) 的程序集/罐子。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-03T16:41:29.043

这与 servlet 容器在处理 servlet 的热交换时遇到的问题集完全相同。网络服务器/容器应该连续运行，但必须能够按需加载新的 servlet。

我建议您首先查看 Tomcat 源代码（[可通过这些颠覆 URL 获得](http://tomcat.apache.org/svn.html)。）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-03T16:50:19.787

这基本上就是反射的用途。正如其他人所说，如果您遵循某种挂钩或插件模式，这应该可以帮助您完成大部分工作。基本上它是这样的：

1.  在您的代码中创建定义良好的接口来描述核心应用程序和插件之间的契约。
2.  设计一种在配置中存储 jar/类信息的方法，以便您可以在运行时通过反射加载类型
3.  通过#1中描述的接口上的反射和调用方法加载插件

现在，如果您开始陷入工作流程实施的困境，那么可能是时候研究现成的工作流程引擎了。这里有太多要提及的内容，但 Google 搜索应该可以帮助您入门。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-03T17:14:19.497

通过在 Java 之上使用 JRuby，我曾经做过一些听起来与您的目标相似的事情。核心部分是用 Java 编写的，并且会一直运行，而 Ruby 脚本是使用 JRuby 动态加载的。这样，我可以在不重新启动（或编译）Java 部分的情况下添加功能。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-03T16:36:31.223

将源代码拆分为两棵树很容易。这些的编译形式可以单独交付，非核心内容编译时将核心添加到 -classpath。

代码可以在运行时使用类加载器 ( `URLClassLoader.newInstance`) 加载。您必须小心卸载旧代码。您需要确保在任何地方都绝对没有（强）引用它。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-03T22:26:17.170

显然，这正是为 Eclipse 之类的东西开发的那种东西。他们使用 OSGi 构建了一个插件框架。

也就是说，我会选择一种可以在 JVM 上运行的脚本语言，例如 Jython、Rhino/JavaScript 或 JRuby。[Spring](http://www.springframework.org)等框架现在支持[在这些语言中定义 bean](http://static.springframework.org/spring/docs/2.5.x/reference/dynamic-language.html)并让它们动态重新编译的能力。

随着 JVM 对动态语言（在 JDK6 脚本之上）的更多支持，这些可能会在未来被广泛采用。

# java - Java 中的信号量问题与餐饮哲学家

> ID：607112
> 
> 赞同：5
> 
> 时间：2009-03-03T16:27:50.807
> 
> 标签：java, multithreading, locking, semaphore

我正在尝试在餐饮哲学家问题中学习信号量的基本要点。现在，我有一个 Chopstick 类数组，每个 Chopstick 都有一个带有 1 个可用许可证的信号量：

```
public class Chopstick
{
    Thread holder = null;
    private Semaphore lock = new Semaphore(1);

    public synchronized void take() throws InterruptedException
    {
        this.lock.acquire();
        holder = Thread.currentThread();

    }

    public synchronized void release()
    {   
        this.lock.release();
        holder = null;
    }
} 
```

holder 变量用于我不确定是否需要的函数：

```
public synchronized void conditionalRelease()
{
    if (holder == Thread.currentThread())
    {
        holder = null;
        this.lock.release();
    }
} 
```

程序编译并运行，但似乎在释放筷子时遇到了一些麻烦。有时，筷子会松开，有时不会。当他们不释放时，程序最终会在所有筷子都被拿走并且一位哲学家饿了时挂断。

这是 Philosopher 类中的代码，用于在随机时间后释放筷子：

```
System.out.println(this.name + " is eating");
Thread.sleep(this.getRandTime());
System.out.println(this.name + " has finished eating");

rightChopstick.release();
System.out.println(this.name + " has released the right chopstick");
leftChopstick.release();
System.out.println(this.name + " has released the left chopstick"); 
```

例如，我的程序确实输出“哲学家 0 吃完饭”，然后继续执行。另外两行从不输出，所以很明显我发布的方式有问题。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-03T16:30:07.527

我会从您的方法签名中删除“同步”关键字。您正在使用外部锁定机制（在本例中为信号量）。'synchronized' 关键字试图使用对象自己的互斥锁来获取锁。您现在锁定了 2 个我怀疑可能导致死锁的资源。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T16:33:53.930

问题是当thread1有一个特定的筷子并且另一个试图得到相同的筷子时，它会`take()`在线等待-method`this.lock.acquire();`但它**不会**释放对象本身的监视器。

如果现在 thread1 试图释放筷子，它就不能进入`release()`- 方法，因为它仍然被等待的另一个线程锁定`take()`。这是一个僵局

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T16:48:45.953

您既要锁定筷子又要让它持有大小为 1 的信号量，这似乎有点令人困惑。通常，信号量提供资源的票证，如果您只有一张票证，这实际上是互斥，与锁相同（同步块或 Lock 对象）。您可能会考虑让 Chopstick 成为锁定对象本身。

如果您有兴趣，我在不久前写了一篇关于用 Java 就餐哲学家的博客文章，尽管它实际上是关于如何通过使用其他策略来避免死锁。

*   [http://tech.puredanger.com/2008/02/12/reentrantlock-and-the-dining-philosophers/](http://tech.puredanger.com/2008/02/12/reentrantlock-and-the-dining-philosophers/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-11-26T20:55:37.793

确保没有使用任何锁定或同步关键字。下面的筷子代码对我来说很好用。不是专业人士，但必须给你一些想法；

```
public class Chopstick {
private boolean inuse;
Semaphore sem;

public Chopstick(){

    inuse = false;
    sem = new Semaphore(1);
}
public void pickUp()
{
    try
    {
        while(inuse)
        {
            try
            {
                sem.acquire();

            }
            catch(InterruptedException e) {}
        }
        inuse = true;
    }catch(Exception e){}
}
public void putDown()
{
    try
    {
        inuse = false;
        sem.release();

    }
    catch (Exception e){}
} 
```

}

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-11-27T11:12:55.247

Philospher 需要在开始进食之前锁定两个筷子，并且会先拾取 leftone，然后等待正确的所以开始进食，因此 start 方法应该同步。以下方法将使其工作：

```
public synchronized void startEating() {
    leftChopstick.acquire();
    rightChopstick.acquire();
}

public void finishEating(int id) {
    leftChopstick.release();
    rightChopstick.release();
} 
```

# asp.net - .NET Winform AJAX 登录服务

> ID：607116
> 
> 赞同：4
> 
> 时间：2009-03-03T16:29:01.227
> 
> 标签：asp.net, ajax, winforms, login

我正在处理一个连接到 ASP.NET 成员数据库的 Windows 窗体，并且我正在尝试使用 AJAX 登录服务。无论我做什么，我都会在 Authentication_JSON_AppService.axd 调用中不断收到 404 错误。

网页配置如下

```
<?xml version="1.0"?>
<!-- 
    Note: As an alternative to hand editing this file you can use the 
    web admin tool to configure settings for your application. Use
    the Website->Asp.Net Configuration option in Visual Studio.
    A full list of settings and comments can be found in 
    machine.config.comments usually located in 
    \Windows\Microsoft.Net\Framework\v2.x\Config 
-->
<configuration>
  <configSections>
    <sectionGroup name="system.web.extensions" type="System.Web.Configuration.SystemWebExtensionsSectionGroup, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35">
      <sectionGroup name="scripting" type="System.Web.Configuration.ScriptingSectionGroup, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35">
        <section name="scriptResourceHandler" type="System.Web.Configuration.ScriptingScriptResourceHandlerSection, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" allowDefinition="MachineToApplication"/>
        <sectionGroup name="webServices" type="System.Web.Configuration.ScriptingWebServicesSectionGroup, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35">
          <section name="jsonSerialization" type="System.Web.Configuration.ScriptingJsonSerializationSection, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" allowDefinition="Everywhere"/>
          <section name="profileService" type="System.Web.Configuration.ScriptingProfileServiceSection, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" allowDefinition="MachineToApplication"/>
          <section name="authenticationService" type="System.Web.Configuration.ScriptingAuthenticationServiceSection, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" allowDefinition="MachineToApplication"/>
          <section name="roleService" type="System.Web.Configuration.ScriptingRoleServiceSection, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" allowDefinition="MachineToApplication"/>
        </sectionGroup>
      </sectionGroup>
    </sectionGroup>
  </configSections>
  <connectionStrings <!-- Removed --> />
  <appSettings/>
  <system.web>
    <!-- 
            Set compilation debug="true" to insert debugging 
            symbols into the compiled page. Because this 
            affects performance, set this value to true only 
            during development.
        -->
    <compilation debug="true">
      <assemblies>
        <add assembly="System.Core, Version=3.5.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089"/>
        <add assembly="System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
        <add assembly="System.Xml.Linq, Version=3.5.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089"/>
        <add assembly="System.Data.DataSetExtensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089"/>
        <add assembly="System.Data.Linq, Version=3.5.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089"/>
      </assemblies>
    </compilation>
    <membership defaultProvider="dbSqlMembershipProvider">
      <providers>
        <add name="dbSqlMembershipProvider" type="System.Web.Security.SqlMembershipProvider, System.Web, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a" connectionStringName="Fire.Common.Properties.Settings.dbFireConnectionString" enablePasswordRetrieval="false" enablePasswordReset="true" requiresQuestionAndAnswer="true" applicationName="/" requiresUniqueEmail="false" passwordFormat="Hashed" maxInvalidPasswordAttempts="5" minRequiredPasswordLength="7" minRequiredNonalphanumericCharacters="1" passwordAttemptWindow="10" passwordStrengthRegularExpression=""/>
      </providers>
    </membership>
    <roleManager enabled="true" defaultProvider="dbSqlRoleProvider">
      <providers>
        <add connectionStringName="Fire.Common.Properties.Settings.dbFireConnectionString" applicationName="/" name="dbSqlRoleProvider" type="System.Web.Security.SqlRoleProvider, System.Web, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"/>
      </providers>
    </roleManager>
    <authentication mode="Forms">
      <forms loginUrl="Login.aspx" cookieless="UseCookies" protection="All" timeout="30" requireSSL="false" slidingExpiration="true" defaultUrl="default.aspx" enableCrossAppRedirects="false"/>
    </authentication>
    <authorization>
      <allow users="*"/>
      <allow users="?"/>
    </authorization>
    <customErrors mode="Off">
    </customErrors>
    <pages>
      <controls>
        <add tagPrefix="asp" namespace="System.Web.UI" assembly="System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
        <add tagPrefix="asp" namespace="System.Web.UI.WebControls" assembly="System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
      </controls>
    </pages>
    <httpHandlers>
      <remove verb="*" path="*.asmx"/>
      <add verb="*" path="*_AppService.axd" validate="false" type="System.Web.Script.Services.ScriptHandlerFactory, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
      <add verb="GET,HEAD" path="ScriptResource.axd" validate="false" type="System.Web.Handlers.ScriptResourceHandler, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
      <add verb="*" path="*.asmx" validate="false" type="System.Web.Script.Services.ScriptHandlerFactory, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
    </httpHandlers>
    <httpModules>
      <add name="ScriptModule" type="System.Web.Handlers.ScriptModule, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
    </httpModules>
  </system.web>
  <location path="~/Admin">
    <system.web>
      <authorization>
        <allow roles="Admin"/>
        <allow roles="System"/>
        <deny users="*"/>
      </authorization>
    </system.web>
  </location>
  <location path="~/Admin/System">
    <system.web>
      <authorization>
        <allow roles="System"/>
        <deny users="*"/>
      </authorization>
    </system.web>
  </location>
  <location path="~/Export">
    <system.web>
      <authorization>
        <allow roles="Export"/>
        <deny users="*"/>
      </authorization>
    </system.web>
  </location>
  <location path="~/Field">
    <system.web>
      <authorization>
        <allow roles="Field"/>
        <deny users="*"/>
      </authorization>
    </system.web>
  </location>
  <location path="~/Default.aspx">
    <system.web>
      <authorization>
        <allow roles="Admin"/>
        <allow roles="System"/>
        <allow roles="Export"/>
        <allow roles="Field"/>
        <deny users="?"/>
      </authorization>
    </system.web>
  </location>
  <location path="~/Login.aspx">
    <system.web>
      <authorization>
        <allow users="*"/>
        <allow users="?"/>
      </authorization>
    </system.web>
  </location>
  <location path="~/App_Themes">
    <system.web>
      <authorization>
        <allow users="*"/>
        <allow users="?"/>
      </authorization>
    </system.web>
  </location>
  <location path="~/Includes">
    <system.web>
      <authorization>
        <allow users="*"/>
        <allow users="?"/>
      </authorization>
    </system.web>
  </location>
  <location path="~/WebServices">
    <system.web>
      <authorization>
        <allow users="*"/>
        <allow users="?"/>
      </authorization>
    </system.web>
  </location>
  <location path="~/Authentication_JSON_AppService.axd">
    <system.web>
      <authorization>
        <allow users="*"/>
        <allow users="?"/>
      </authorization>
    </system.web>
  </location>
  <system.codedom>
    <compilers>
      <compiler language="c#;cs;csharp" extension=".cs" type="Microsoft.CSharp.CSharpCodeProvider,System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" warningLevel="4">
        <providerOption name="CompilerVersion" value="v3.5"/>
        <providerOption name="WarnAsError" value="false"/>
      </compiler>
      <compiler language="vb;vbs;visualbasic;vbscript" extension=".vb" type="Microsoft.VisualBasic.VBCodeProvider, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" warningLevel="4">
        <providerOption name="CompilerVersion" value="v3.5"/>
        <providerOption name="OptionInfer" value="true"/>
        <providerOption name="WarnAsError" value="false"/>
      </compiler>
    </compilers>
  </system.codedom>
  <!-- 
        The system.webServer section is required for running ASP.NET AJAX under Internet
        Information Services 7.0\.  It is not necessary for previous version of IIS.
    -->
  <system.webServer>
    <validation validateIntegratedModeConfiguration="false"/>
    <modules>
      <remove name="ScriptModule"/>
      <add name="ScriptModule" preCondition="managedHandler" type="System.Web.Handlers.ScriptModule, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
    </modules>
    <handlers>
      <remove name="WebServiceHandlerFactory-Integrated"/>
      <remove name="ScriptHandlerFactory"/>
      <remove name="ScriptHandlerFactoryAppServices"/>
      <remove name="ScriptResource"/>
      <add name="ScriptHandlerFactory" verb="*" path="*.asmx" preCondition="integratedMode" type="System.Web.Script.Services.ScriptHandlerFactory, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
      <add name="ScriptHandlerFactoryAppServices" verb="*" path="*_AppService.axd" preCondition="integratedMode" type="System.Web.Script.Services.ScriptHandlerFactory, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
      <add name="ScriptResource" verb="GET,HEAD" path="ScriptResource.axd" preCondition="integratedMode" type="System.Web.Handlers.ScriptResourceHandler, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
    </handlers>
  </system.webServer>
  <runtime>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
      <dependentAssembly>
        <assemblyIdentity name="System.Web.Extensions" publicKeyToken="31bf3856ad364e35"/>
        <bindingRedirect oldVersion="1.0.0.0-1.1.0.0" newVersion="3.5.0.0"/>
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="System.Web.Extensions.Design" publicKeyToken="31bf3856ad364e35"/>
        <bindingRedirect oldVersion="1.0.0.0-1.1.0.0" newVersion="3.5.0.0"/>
      </dependentAssembly>
    </assemblyBinding>
  </runtime>
</configuration> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T17:34:16.140

您需要在 web.config 中启用对身份验证服务的访问权限

```
<system.webServices>
   <authenticationService enabled="true" requireSSL="true|false"/>
</system.webServices> 
```

查看此视频了解更多信息。

[http://www.asp.net/learn/ajax-videos/video-166.aspx](http://www.asp.net/learn/ajax-videos/video-166.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-02-28T18:41:04.730

我有同样的问题。我的问题的解决方案是注册 iis。aspnet_regiis.exe -i

# javascript - 带有描述性文本的文本输入

> ID：607124
> 
> 赞同：1
> 
> 时间：2009-03-03T16:31:00.003
> 
> 标签：javascript, jquery, html, usability, textinput

我想知道是否有一种简单的方法使用 javascript（包括我们在网站上使用的 JQuery）将描述性文本放入文本输入中，直到用户单击它来输入他们自己的文本。

例如，我想将“搜索”一词放在文本输入中（最好是比实际输入更浅的颜色），直到用户单击输入，当它消失并允许他们输入搜索词时。

不过，我实际上不想让“搜索”这个词成为文本输入的值，因为用户可以搜索“搜索”这个词有点重要。

我正在考虑绝对定位一个 <p> 元素，并在输入上使用单词搜索并在单击它（或输入）时将其隐藏。

你怎么看？这是可怕的误导吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-03T17:03:38.210

我最近遇到了[jQuery Form Example 插件](http://mucur.name/system/jquery_example/)，它可以满足您的需求。该项目的 github 页面在[这里](http://github.com/mudge/jquery_example/tree/master)。使用该插件，您可以显示一个占位符值，该值将在点击时消失，只需：

`$('input#search').example('Search');`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-03T16:36:44.453

您可以将搜索输入的初始值设置为“搜索”，然后添加一个 onClick 侦听器将其移除。

`$("input.search-term").one("click", function() { $(this).removeAttr("value"); });`

它不会影响用户搜索“搜索”的能力。这是一种比尝试在输入上修改 a`<p>`或`<label>`元素更简洁的方法。

**编辑：**你是绝对正确的 - 删除每次点击的价值是糟糕的用户体验。这就是我快速回答的原因。:) 更新为仅删除初始值。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-02-22T06:10:03.933

你可能想看看这个：http: [//www.newmediacampaigns.com/page/nmcformhelper](http://www.newmediacampaigns.com/page/nmcformhelper)

基本上，[HTML 5](http://dev.w3.org/html5/spec/Overview.html#the-placeholder-attribute)支持输入元素的**占位符属性：**

```
<input type="text" placeholder="Your browser supports placeholder text" size=38> 
```

WebKit（Chrome 和 Safari）现在支持这个，但是对于 Firefox 和 IE 等其他浏览器，当浏览器不支持 HTML 5 功能时，您可以使用此脚本模拟使用 Javascript 的效果。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-03T16:38:19.270

多年来，一直有一个流行的“项目”，称为**[labels.js](http://www.google.com/search?q=labels.js)**，最初由旧的 youngpup.net 的 Aaron Boodman 编写。这个想法仍然存在，甚至存在一个[jQuery 版本](http://simonwillison.net/static/2008/xtech/)（演示 #4）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-03T17:03:57.007

> 不过，我实际上不想让“搜索”这个词成为文本输入的值，因为用户可以搜索“搜索”这个词有点重要。

在这种情况下，您可以在文本输入上使用背景图像。您可以在 CSS 中定义 :focus 不应该有背景，而 unfocused 应该有它。即使禁用了 javascript，此解决方案也有效。

更新：测试和使用 FF、Opera 和 Chrome 但不是 IE，因为 IE 不支持:focus，但 IE 支持背景图像，所以如果文本是浅灰色的应该不是问题。而且您始终可以使用 jquery 来更改输入字段应具有的分类。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-03T22:21:27.417

不久前我正在寻找这个解决方案并遇到了[这个](http://remysharp.com/2007/01/25/jquery-tutorial-text-box-hints/)

```
/**
* @author Remy Sharp
* @url http://remysharp.com/2007/01/25/jquery-tutorial-text-box-hints/
*/

(function ($) {

$.fn.hint = function (blurClass) {
  if (!blurClass) { 
    blurClass = 'blur';
  }

  return this.each(function () {
    // get jQuery version of 'this'
    var $input = $(this),

    // capture the rest of the variable to allow for reuse
      title = $input.attr('title'),
      $form = $(this.form),
      $win = $(window);

    function remove() {
      if ($input.val() === title && $input.hasClass(blurClass)) {
        $input.val('').removeClass(blurClass);
      }
    }

    // only apply logic if the element has the attribute
    if (title) { 
      // on blur, set value to title attr if text is blank
      $input.blur(function () {
        if (this.value === '') {
          $input.val(title).addClass(blurClass);
        }
      }).focus(remove).blur(); // now change all inputs to title

      // clear the pre-defined text when form is submitted
      $form.submit(remove);
      $win.unload(remove); // handles Firefox's autocomplete
    }
  });
};

})(jQuery);

$(function(){ 
    // find all the input elements with title attributes
    $('input[title!=""]').hint();
}); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-03T16:45:45.600

我会在 jQuery 中做这样的事情：

```
$("input.searchterm").click(function() { 
  var $input = $(this);
  if ($input.val() == "enter search term") $input.val("");
}; 
```

这样用户在再次点击时不会丢失他们之前输入的内容。只有当它是您分配给输入字段的默认值时，该值才会被清除。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-03T22:14:37.650

作为参考，这种技术通常称为**水印**。

# c# - httpmodule, asp.net application interaction

> ID：607125
> 
> 赞同：1
> 
> 时间：2009-03-03T16:31:07.227
> 
> 标签：c#, httpmodule

Is there any way to call functions in a httpmodule from an asp.net application, even if the httpmodule is in another process? Better yet, in a situation where the application pool is running as a web garden (>1 worker process) how can I communicate with all of the httpmodules that are running?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T16:44:11.173

您不应指望 HttpModule 的一个实例运行，然后让所有其他实例连接到该实例。

相反，听起来您应该开发一个服务来完成您想要的工作（或其他一些共享的编程资源，也许是 COM+ 中的单例？），然后让您的 HttpModules 使用某种分布式通信技术与服务通信（我'd 推荐 WCF，一个命名管道通道）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T16:43:02.440

为了在网络花园进程之间进行通信，您必须使用.Net remoting 或新的 WCF（正如 casperOne 指出的那样）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T16:50:06.230

我已经通过两种方式完成了这种事情。1) 使用远程处理设置 Web 服务以允许此类调用，以及 2) 使用从一台主机向另一台主机的命名空间发出手动 Web 请求。

如果您的请求可以作为简单的查询字符串工作，并且结果可以作为 html/xml，则第二种方法比实际设置完整的 Web 服务要简单得多（而且开销要少得多）。你已经有了一个请求-响应架构，因为这实际上是一个网络服务器，所以我认为使用它是有意义的。如果安全是一个问题，您可以使您调用的这些辅助页面仅响应来自 localhost/127.0.0.1 的请求。

# design-patterns - Ada 中的设计模式参考实现？

> ID：607126
> 
> 赞同：3
> 
> 时间：2009-03-03T16:31:13.140
> 
> 标签：design-patterns, ada

有谁知道 Ada 中常见设计模式的一些很好的参考实现？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-03T17:13:17.593

[关于“在 Ada 中实现的软件模式](http://www.adapower.com/index.php?Command=Class&ClassID=Patterns&Title=Patterns)”的几篇文章。

# .net - Type.MakeByRefType 的反义词是什么

> ID：607130
> 
> 赞同：6
> 
> 时间：2009-03-03T16:31:49.237
> 
> 标签：.net, reflection

.NET 中的[`Type.MakeByRefType`](http://msdn.microsoft.com/en-us/library/system.type.makebyreftype.aspx)方法返回类型的按引用版本，例如，传递类型的类型`System.Int32`返回表示`System.Int32&`.

但是，如果您已经拥有一个`System.Int32&`，那么获得一个普通 old 的机制是什么`System.Int32`？似乎没有相反的方法可以删除 by-ref 修饰符。

目前我已经放置了一个hack，它重新构建了程序集限定名称，没有`&`在类型名称的末尾，然后加载该类型，但这非常肮脏......

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-03T16:35:44.847

根据文档[`IsByRef`](https://docs.microsoft.com/en-us/dotnet/api/system.type.isbyref?view=net-5.0#System_Type_IsByRef)，您可以使用[`Type.GetElementType`](http://msdn.microsoft.com/en-us/library/system.type.getelementtype.aspx).

对于[`IsArray`](https://docs.microsoft.com/en-us/dotnet/api/system.type.isarray?view=net-5.0)or [`IsPointer`](https://docs.microsoft.com/en-us/dotnet/api/system.type.ispointer?view=net-5.0)is的类型也是如此`true`。

```
var typeInt = typeof(int);
var typeIntRef = typeInt.MakeByRefType();
var typeIntArray = typeInt.MakeArrayType();
var typeIntPointer = typeInt.MakePointerType();

Debug.Assert(typeIntRef.GetElementType() == typeInt);
Debug.Assert(typeIntArray.GetElementType() == typeInt);
Debug.Assert(typeIntPointer.GetElementType() == typeInt); 
```

# apache-flex - 为什么 FlexUnit 中没有 assertError() 函数？

> ID：607136
> 
> 赞同：4
> 
> 时间：2009-03-03T16:32:58.690
> 
> 标签：apache-flex, actionscript-3, error-handling, assertions, flexunit

似乎大多数 XUnit 测试框架在您想要断言给定操作将引发异常（或 AS3 术语中的错误）时提供断言。是否有一些我忽略的“标准”方法来执行此操作，其中可以解释 FlexUnit 中缺少 assertError() 断言吗？

我知道如何实现这样的事情，我可能会将它添加到我的 FlexUnit（去开源！），但这似乎是一个明显的遗漏，我不知道我是否只是做错了。

有人对此有想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-03T16:38:59.877

**编辑 05/02/2010：**我现在建议使用[FlexUnit 4](http://www.flexunit.org/)。它使用可扩展的元数据系统，支持预期的异常，还支持在不使用 AIR 的情况下在集成服务器环境中运行。

**编辑：**您应该看一下[fluint](http://code.google.com/p/fluint/)，它是由受够了 FlexUnit 的人构建的，它有局限性。它可能内置了其中一些类型的断言。

我完全同意。事实上，FlexUnit 缺少几个有用的方法（assertEvent、assertArrayEquals 等）。我知道你说过你知道如何实现它，但请随意使用我的：

```
public static function assertError(message : String, func : Function, errorClass : Class = null, errorMessage : String = null, errorCodes : Array = null) : Error 
{
    _assertionsMade++;

    if (errorClass == null) errorClass = Error;

    try
    {
        func();
    }
    catch(ex : Error)
    {
        if (!(ex is errorClass))
        {
            fail("Expected error of type '" + getQualifiedClassName(errorClass) + "' but was '" + getQualifiedClassName(ex) + "'");
        }

        if (errorMessage != null && ex.message != errorMessage)
        {
            fail("Expected error with message '" + errorMessage + "' but was '" + ex.message + "'");
        }

        if (errorCodes != null && errorCodes.indexOf(ex.errorID) == -1)
        {
            fail("Expected error with errorID '" + errorCodes.join(" or ") + "' but was '" + ex.errorID + "'");
        }

        return ex;
    }

    if (message == null)
    {
        message = "Expected error of type '" + getQualifiedClassName(errorClass) + "' but none was thrown"
    }

    fail(message);

    return null;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-05-10T08:37:53.127

FlexUnit 4 与 hamcrest-as3 配合得很好。hamcrest 有错误断言匹配器

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-19T19:05:59.793

您可能需要考虑使用此断言工具。

它不会取代 xxxunit 框架，只是方便你做出断言，让它们更英文，更少代码。

[https://github.com/osher/should.as](https://github.com/osher/should.as)

```
var p:Person = new Person();

//assume a method p.sayHi()
p.sayHi.should().throwError('name is not set');

p.name = "Radagast";
p.sayHi.should().not.throwError(); 
```

玩得开心 ：）

# hibernate - Hibernate：从查询中加载字段，但不将其插入表中

> ID：607138
> 
> 赞同：0
> 
> 时间：2009-03-03T16:33:07.550
> 
> 标签：hibernate

我有一个带有某个字段 f1 的 bean，它不应该映射到表中，但有时我确实想从一些查询中加载它（而不是表本身）

可以做到吗？如何？

我试过声明它 @Transient ，但它不会从查询中读取它，即使我声明`<return-property name="f1" column="f1"/>`

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-04T00:38:00.083

尝试像平常一样映射它，但将插入和更新设置为 false。或者，您可以将其定义为仅在公式中包含列名的公式。Hibernate 会很好地查询它，但会知道不要尝试编写它。

# java - 什么是 JAXB，我为什么要使用它？

> ID：607141
> 
> 赞同：112
> 
> 时间：2009-03-03T16:34:41.713
> 
> 标签：java, jaxb

这里有人发誓 JAXB 是自切片面包以来最伟大的东西。我很想知道 Stack Overflow 用户认为 JAXB 的用例是什么，以及是什么使它成为该案例的好或坏解决方案。

* * *

## 回答 #1

> 赞同：104
> 
> 时间：2009-03-03T17:09:14.093

我是处理 XML 的 JAXB 的忠实粉丝。基本上，它为这个问题提供了一个解决方案（我假设熟悉 XML、Java 数据结构和 XML 模式）：

使用 XML 很困难。需要一种方法来获取 XML 文件（基本上是文本文件）并将其转换为某种数据结构，然后您的程序可以对其进行操作。

JAXB 将采用您编写的 XML 模式并创建一组与该模式相对应的类。JAXB 实用程序将创建用于操作 XML 的数据结构层次结构。

然后可以使用 JAXB 读取 XML 文件，然后创建生成的类的实例 - 加载来自 XML 的数据。JAXB 也做相反的事情：接受 java 类，并生成相应的 XML。

我喜欢 JAXB，因为它易于使用，并且带有 Java 1.6（如果您使用的是 1.5，则可以下载 JAXB .jars。）它创建类层次结构的方式很直观，并且根据我的经验，做得不错抽象出“XML”，以便我可以专注于“数据”。

所以回答你的问题：我希望，对于小的 XML 文件，JAXB 可能是矫枉过正。它要求您创建和维护 XML 模式，并使用将 Java 类用于数据结构的“标准教科书方法”。（主类、表示“节点”的小内部类以及它们的巨大层次结构。）因此，对于应用程序的“首选项”的简单线性列表，JAXB 可能不是那么好。

但是，如果您有一个相当复杂的 XML 模式，并且其中包含大量数据，那么 JAXB 就太棒了。在我的项目中，我在二进制（由 C 程序使用）和 XML（以便人类可以使用和修改这些数据）之间转换大量数据。生成的 XML Schema 非常重要（许多层次的层次结构，一些字段可以重复，而另一些则不能），因此 JAXB 有助于处理它。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-03-03T17:50:08.690

这是不使用它的一个原因：性能受到影响。编组和解组时有很多开销。您可能还想考虑另一个用于 XML-Object 绑定的 API——例如 JiBX：http: [//jibx.sourceforge.net/](http://jibx.sourceforge.net/)

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2010-04-21T21:54:04.937

我一直在工作中使用 JAXB，我真的很喜欢它。它非常适合不断变化的复杂 XML 模式，尤其适用于随机访问 XML 文件中的标签。

我讨厌拉皮条，但我刚开始写博客，这实际上是我发布的第一件事！

在这里查看：

[http://arthur.gonigberg.com/2010/04/21/getting-started-with-jaxb/](http://arthur.gonigberg.com/2010/04/21/getting-started-with-jaxb/)

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2009-03-03T16:39:23.650

这是一个“XML 的 ORM”。最常与 JAX-WS 一起使用（实际上 Sun 实现是一起开发的），用于 WS Death Star 系统。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-03-03T17:04:42.200

使用 JAXB，您可以自动创建对象的 XML 表示（编组）和 XML 的对象表示（解组）。

就 XML Schema 而言，您有两种选择：

*   从 XSD 生成 Java 类
*   从 Java 类生成 XSD

还有一些更简单的 XML 序列化库，如[XStream](http://xstream.codehaus.org/)、[Digester](http://commons.apache.org/digester/)或[XMLBeans](http://xmlbeans.apache.org/)可能是替代品。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-03-03T22:36:37.037

`xsd`如果您必须对一些定义为 XML 模式 ( )的外部 XML 规范进行编码，那么 JAXB 非常棒。

例如，您有一个交易应用程序，您必须向*Uber Lame Trade Reporting 应用程序*报告交易，他们已经让您`ultra.xsd`继续进行下去。使用`$JAVA_HOME/bin/xjc`编译器将 XML 转换为一堆 Java 类（例如`UltraTrade`）。

然后，您可以编写一个简单的*适配器*层来将您的交易对象转换为`UltraTrades`并使用将`JAXB`数据编组到 Ultra-Corp。**比**将您的交易转换为 XML 格式更容易。

当 Ultra-Corp 没有真正遵守他们自己的规范时，一切都崩溃了`price`，他们以 a表示的交易`xsd:float`实际上应该表示为`double`！

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2016-07-19T18:40:49.847

**为什么我们需要 JAXB？** Web 服务的远程组件（用 Java 编写）使用 XML 作为相互交换消息的手段。**为什么选择 XML？**因为 XML 被认为是在资源有限的网络上交换消息的轻量级选项。所以我们经常需要将这些 XML 文档转换为对象，反之亦然。例如：简单的 Java POJO Employee 可用于将 Employee 数据发送到远程组件（也是一个 Java 程序）。

```
class Employee{
 String name;
 String dept;
 ....
} 
```

这个 Pojo 应该被转换（Marshall）为 XML 文档，如下所示：

```
<Employee>
  <Name>...</Name>
  <Department>...</Department>
</Employee> 
```

而在远程组件，从 XML 文档（Un-Marshall）返回 Java 对象。

**什么是 JAXB？**

JAXB 是执行 Marshalling 和 UnMarshalling 操作的库或工具。它使您免于头痛，就这么简单。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2011-07-18T09:05:58.140

您也可以查看 JIBX。它也是一个非常好的xml数据绑定器，它也是OTA（Open Travel Alliance）专业的，并且得到了AXIS2服务器的支持。如果您正在寻找性能和兼容性，可以查看：

[http://jibx.sourceforge.net/index.html](http://jibx.sourceforge.net/index.html)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-11-24T22:11:46.753

JAXB 通过默认编组优化提供改进的性能。JAXB 定义了一个程序员 API，用于从 XML 文档读取和写入 Java 对象，从而简化了通过 Java 读取和写入 XML。

# java - Vista 上 Netbeans 6.5 中的用户设置文件在哪里？

> ID：607144
> 
> 赞同：0
> 
> 时间：2009-03-03T16:35:23.427
> 
> 标签：java, netbeans6.5

我似乎找不到我的设置文件，在那里我可以找到我的 IDE Editir 颜色设置文件并保存它......所以如果我需要在另一台机器上安装 NB，我可以将我的设置从这台机器复制到新机器. 或者如果我的电脑死机需要恢复出厂设置，一切都会被删除，但如果我有这个设置文件，每次我需要重新安装 NB 时，它会为我节省很多时间。有谁知道它在哪里？在 XP 上我知道它在“文档和设置”中，但在 Vista 中没有这样的文件夹。

坦率

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T16:53:49.467

应该在 Users\\Documents 里面可能是 NetBeans 的一个子目录里面。

# silverlight - Silverlight 中的标签装饰

> ID：607155
> 
> 赞同：0
> 
> 时间：2009-03-03T16:36:50.600
> 
> 标签：silverlight, tabs

由于 Internet Explorer 中的 JQuery UI 出现问题，我在 Silverlight 中使用了一些选项卡。我想在 sliverlight 中设置标签的样式，使其看起来像 JQuery UI 中的标签，但似乎只能获得一些褪色的颜色。

任何人都知道描述如何做到这一点的任何链接？有没有办法将图像设置为选项卡？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-03T16:50:24.077

我尝试使用 jQuery UI 选项卡插件并遇到了很多问题，但很快发现创建自己的非常容易。

像这样的东西......显然你可以根据你的要求来皮肤

```
<div class="navcontainer">
 <ul>
  <li><a class="tab" id="p1" href="#1">Tab One</a></li>
  <li><a class="tab" id="p2" href="#2">Tab Two</a></li> 
 </ul>
</div> 
```

然后在 JS

```
var pageUrl = new Array();          
pageUrl[1] = "pageone.php";
pageUrl[2] = "pagetwo.php";

$(document).ready(function() { 

 $(".tab").click(function() {
  loadTab($(this).attr('id')); 
 });

});

function loadTab(id) {
 if (pageUrl[id].length > 0) {
  $("#preloader").show();
  $.ajax({
   url: pageUrl[id], 
   cache: false,
   success: function(message) {                         
    $("#tabdiv").empty().append(message);
   }
  });                   
 }
} 
```

不完全是确切的 Silverlight 答案，如果您不觉得这很有帮助，请见谅。但希望可以为您节省一些时间。

# c# - C#：明确声明“不安全”/编译器选项的好处

> ID：607159
> 
> 赞同：8
> 
> 时间：2009-03-03T16:37:41.673
> 
> 标签：c#, pointers, unsafe, compiler-options

我了解指针以及很少需要在 C# 代码中使用它们。我的问题是：必须在代码块中明确声明“不安全”的原因是什么。此外，为什么必须更改编译器选项以允许“不安全”代码？

**底线：** CLR（或语言规范）中的什么使得我们不能只在需要时使用指针（很像 C 和 C++）而不必键入“不安全”并更改编译器选项？

*澄清一下：我知道什么是“不安全”和“安全”代码。这只是一个问题，为什么我们必须做所有额外的工作（好吧，不是那么多额外的工作）才能使用这些功能。*

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-03T16:46:52.527

[这里](http://www.windowsdevcenter.com/pub/a/oreilly/windows/news/hejlsberg_0800.html)有一篇对 C# Creator Anders Hejlsberg 的采访，涉及到这个主题。基本上，正如@Marc Gravell 所说：类型安全第一，显式声明不安全。

所以回答你的问题：CLR 中没有任何东西可以阻止它；这是一种语言习语，旨在让您在处理类型时戴上安全手套。如果你想脱掉手套，这是你的选择，但你必须做出主动的选择来脱掉手套。

**编辑：**

> *澄清一下：我知道什么是“不安全”和“安全”代码。这只是一个问题，为什么我们必须做所有额外的工作（好吧，不是那么多额外的工作）才能使用这些功能。*

正如我在采访中提到的那样，这是一个明确的设计决定。C# 本质上是 Java 的演变，而在 Java 中，您根本没有指针。但是设计者希望允许指针；然而，由于 C# 通常会引入 Java 开发人员，他们认为最好是**默认**行为类似于 Java，即没有指针，同时仍允许通过显式声明使用指针。

所以“额外的工作”是故意强迫你在做之前考虑你在做什么。通过明确，它迫使您至少考虑：“我为什么要这样做？当引用类型就足够了时，我**真的**需要一个指针吗？”

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-03T16:40:24.133

这主要是关于可验证的。通过声明`unsafe`，手套已经关闭 - 系统无法再保证您的代码不会乱跑。在大多数情况下，非常希望留在安全区。

这在部分信任（插件等）中变得更加明显，但在常规代码中仍然很有价值。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-03T16:57:32.610

实际上，CLR 对 /unsafe 开关或关键字没有任何要求。实际上，C++/CLI（运行在CLR下的C++语言）没有这样的/unsafe开关，在CLR上可以自由使用指针。

因此，我将您的问题改写为“为什么 C# 需要在使用指针之前使用 /unsafe？” 该问题的答案与此处给出的其他答案中所述：帮助用户做出有意识的决定，失去在 CLR 上以低于完全信任模式运行的能力。C++ 实际上总是要求 CLR 上的完全信任，而 C#*可以*在您调用需要完全信任的代码时或在您使用指针时。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-03T16:41:33.117

当您使用不安全的块时，它具有使代码无法验证的效果。这需要某些权限才能执行，并且您可能不想在输出中允许它（特别是如果您处于共享源环境中），因此编译器中有一个开关来禁止它。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-03T16:47:13.490

从相反的角度考虑：因为它没有被标记为不安全，你可以推断大多数代码默认是“安全的”。那么什么是“安全”呢？对于 .Net 代码，这包括（但可能不限于）：

*   垃圾收集器可以照常工作。
*   对特定类型的引用*将*引用该类型（或 null）的对象。
*   保证代码符合 .Net 信任/安全要求。
*   该代码在数学上被证明不会直接接触它自己的 AppDomain 之外的内存。这可能看起来微不足道，但想象一下，如果您在同一个应用程序中有多个 AppDomain。程序员可以自信地将它们视为逻辑上分离的。

任何时候你使用指针，你都有机会打破这些保证。因此，将代码标记为不安全会放弃这些保护。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-03T18:05:31.807

简而言之，.NET 希望您陈述您的意图。

当然，编译器可以推断出需要“不安全”标志。但设计师希望这是一个深思熟虑的决定。

对我来说，这类似于 C# 中的一些语法要求：

*   无开关盒无中断
*   没有访问级别的“节”（例如 C++ 中的“public:”标记）
*   没有使用“var”的类字段

模式是你不应该移动或改变一件事而无意中影响另一件事。在合理的范围内，他们想让你不要“在脚上开枪”。

这里有很多很棒的、内容丰富的答案——也许这更适合你的问题。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-03T16:40:35.160

因此，如果没有提升的权限等，哪些代码不会在 Web 服务中运行是显而易见的。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-03T16:41:05.473

培养良好的习惯和安全感。每当您在程序集中使用不安全块时，都会要求堆栈提供 NativeCode 权限。这当然可以隐式完成，但我们不能也完全删除 private 关键字吗？我认为强制开发人员在使用之前明确要求不安全的代码是件好事。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-03T16:47:57.763

安全代码和不安全代码之间最显着的区别是 .net 的垃圾收集器无法访问不安全代码。自动 GC 是 .net 语言的重要组成部分，当你超越它的界限时，你会改变很多关于你的代码的假设。

指针尤其允许在没有 GC 引用的情况下在堆上创建对象。这导致另一个极好的理由要求将代码标记为“不安全”。当您意识到自己有内存泄漏时，它可以很容易地缩小内存泄漏的来源。

# authentication - 如何在认证后立即执行功能

> ID：607165
> 
> 赞同：0
> 
> 时间：2009-03-03T16:39:30.170
> 
> 标签：authentication, servlets, jakarta-ee, redirect, jaas

我的问题是：使用 Web 应用程序，在对受保护的资源执行登录身份验证后，如何运行某种函数（在这种情况下，我想运行一个函数来初始化一些与用户相关的会话范围变量）在网络应用重定向到受保护资源之前。

我正在使用 servlet 和 JSP 编写一个 web 应用程序，所有这些都在 struts 框架内。我相信我遵循了正确的 JAAS 或 J2EE 安全标准。

换句话说，我已经通过 web.xml 文件配置了 Web 应用程序，以将所有对受保护材料的请求重定向到向用户询问登录信息的登录表单。然后它提交给 j_Security_check，后者在将用户重定向到受保护的材料之前执行身份验证和授权。

因此，我需要在 Web 应用程序说“是的，这个人就是他们所说的那个人”之后以及在 Web 应用程序将他们推到他们想去的地方之前的某个时间运行一个函数。

希望您能够帮助我。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T16:43:26.480

如果您使用服务器端会话：

*   创建一个 servlet 过滤器
*   在过滤器中：查看是否设置了会话中的某个属性
*   如果没有：检查用户是否已通过身份验证，如果是，请执行您的操作。然后在会话中设置属性

因此，该操作将只执行一次。

# c# - 数据绑定自定义控件

> ID：607170
> 
> 赞同：7
> 
> 时间：2009-03-03T16:41:15.893
> 
> 标签：c#, winforms, controls

我有一个自定义控件（Windows 窗体），它是一个查找文本框。控件上的一个属性是当前选择，它是一个包含“标识符”、“代码”和“描述”的自定义对象。此属性是使用 BindingSource 的 Databound。

显示信息效果很好。另一方面，无论我将 Update 设置为 OnValidate 还是 OnValueChange，它都不会更新 BindingSource。我是否缺少一些东西来让它自动更新？

```
private System.Windows.Forms.BindingSource buildPlanComponentDataBindingSource;

    public void LoadBuildPlan(string itemNumber)
    {
        var buildPlanComponents = BuildPlan.LoadBuildPlanComponents(itemNumber, AutomaticPrice);
        buildPlanComponentDataBindingSource.DataSource = buildPlanComponents;
        AssemblyNumber = itemNumber;
    }

[Bindable(true)]
[DefaultValue(null)]
public ILookupSelection CurrentSelection
{
    get
    {
        if (currentSelection == null)
            currentSelection = new LookupSelection {Code = txtLookup.Text};

        return currentSelection;
    }

    set
    {
        if (value == null) return;

        currentSelection = value;

        SetText(currentSelection, DisplayText);
        SetDescription(currentSelection, DisplayDescription);
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T20:03:43.597

实施 INotifyPropertyChanged 似乎是解决方案！

```
 #region IPropertyChanged

    public event PropertyChangedEventHandler PropertyChanged;

    protected virtual void OnPropertyChanged(string propertyName)
    {
        OnPropertyChanged(new PropertyChangedEventArgs(propertyName));
    }

    protected virtual void OnPropertyChanged(PropertyChangedEventArgs e)
    {
        if (null != PropertyChanged)
        {
            PropertyChanged(this, e);
        }
    }

    #endregion 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T16:54:08.593

> 显示信息效果很好。另一方面，无论我将 Update 设置为 OnValidate 还是 OnValueChange，它都不会更新 BindingSource。

查看您的代码，我实际上对此不确定。在您的集合中，您测试 null 和放弃；如果数据实际上包含 null （这是您所描述的），您的控制将不同步。我想知道该检查是否掩盖了根本问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-06-04T00:22:35.117

也许您需要让 DataBinding 为您以这种方式设置其值的每个控件写入其值？

假设一个名为 txtMySetValue 的文本框的数据绑定：

txtMySetValue.DataBindings[0].WriteValue();

# fluent-nhibernate - NHibernate 中的条件关系

> ID：607174
> 
> 赞同：0
> 
> 时间：2009-03-03T16:42:12.583
> 
> 标签：fluent-nhibernate, nhibernate-mapping

根据**ObjectType**列，我有一个表需要与 2 个表的关系。

例如，如果 ObjectType=1，则**Object**列应指向 TABLE1，如果 ObjectType=2，则指向 TABLE2。

我可以在 NHibernate 映射中或作为 Fluent NHibernate 完成此操作吗？

如果不是，你会建议我对两个表类使用相同的接口吗？（注意：表模式完全不同）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-03T17:51:37.237

为什么不参考这两个表，并在类代码中根据您的需要使用一个或另一个？使用为两个表返回公共接口并根据对象类型提供一个或另一个表的属性。

# java - Java 等效于产生相同输出的 JavaScript 的 encodeURIComponent？

> ID：607176
> 
> 赞同：107
> 
> 时间：2009-03-03T16:42:53.503
> 
> 标签：java, javascript, unicode, utf-8

我一直在尝试各种 Java 代码，试图想出一些东西来编码包含引号、空格和“外来”Unicode 字符的字符串，并产生与 JavaScript 的[encodeURIComponent](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/encodeURIComponent)函数相同的输出。

我的折磨测试字符串是：**“A”B±“**

如果我在 Firebug 中输入以下 JavaScript 语句：

```
encodeURIComponent('"A" B ± "'); 
```

——然后我得到：

```
"%22A%22%20B%20%C2%B1%20%22" 
```

这是我的小测试 Java 程序：

```
import java.io.UnsupportedEncodingException;
import java.net.URLEncoder;

public class EncodingTest
{
  public static void main(String[] args) throws UnsupportedEncodingException
  {
    String s = "\"A\" B ± \"";
    System.out.println("URLEncoder.encode returns "
      + URLEncoder.encode(s, "UTF-8"));

    System.out.println("getBytes returns "
      + new String(s.getBytes("UTF-8"), "ISO-8859-1"));
  }
} 
```

——这个程序输出：

```
URLEncoder.encode 返回 %22A%22+B+%C2%B1+%22
getBytes 返回 "A" B ± "
```

关闭，但没有雪茄！使用 Java 对 UTF-8 字符串进行编码以使其产生与 JavaScript 相同的输出的最佳方法是什么`encodeURIComponent`？

**编辑：**我正在使用 Java 1.4 很快迁移到 Java 5。

* * *

## 回答 #1

> 赞同：129
> 
> 时间：2009-03-04T15:40:09.993

这是我最后想出的课程：

```
import java.io.UnsupportedEncodingException;
import java.net.URLDecoder;
import java.net.URLEncoder;

/**
 * Utility class for JavaScript compatible UTF-8 encoding and decoding.
 * 
 * @see http://stackoverflow.com/questions/607176/java-equivalent-to-javascripts-encodeuricomponent-that-produces-identical-output
 * @author John Topley 
 */
public class EncodingUtil
{
  /**
   * Decodes the passed UTF-8 String using an algorithm that's compatible with
   * JavaScript's <code>decodeURIComponent</code> function. Returns
   * <code>null</code> if the String is <code>null</code>.
   *
   * @param s The UTF-8 encoded String to be decoded
   * @return the decoded String
   */
  public static String decodeURIComponent(String s)
  {
    if (s == null)
    {
      return null;
    }

    String result = null;

    try
    {
      result = URLDecoder.decode(s, "UTF-8");
    }

    // This exception should never occur.
    catch (UnsupportedEncodingException e)
    {
      result = s;  
    }

    return result;
  }

  /**
   * Encodes the passed String as UTF-8 using an algorithm that's compatible
   * with JavaScript's <code>encodeURIComponent</code> function. Returns
   * <code>null</code> if the String is <code>null</code>.
   * 
   * @param s The String to be encoded
   * @return the encoded String
   */
  public static String encodeURIComponent(String s)
  {
    String result = null;

    try
    {
      result = URLEncoder.encode(s, "UTF-8")
                         .replaceAll("\\+", "%20")
                         .replaceAll("\\%21", "!")
                         .replaceAll("\\%27", "'")
                         .replaceAll("\\%28", "(")
                         .replaceAll("\\%29", ")")
                         .replaceAll("\\%7E", "~");
    }

    // This exception should never occur.
    catch (UnsupportedEncodingException e)
    {
      result = s;
    }

    return result;
  }  

  /**
   * Private constructor to prevent this class from being instantiated.
   */
  private EncodingUtil()
  {
    super();
  }
} 
```

* * *

## 回答 #2

> 赞同：71
> 
> 时间：2009-03-03T17:46:32.240

查看实现差异，我看到：

[MDC 上`encodeURIComponent()`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/encodeURIComponent)：

*   文字字符（正则表达式）：`[-a-zA-Z0-9._*~'()!]`

[Java 1.5.0 文档`URLEncoder`](http://docs.oracle.com/javase/1.5.0/docs/api/java/net/URLEncoder.html)：

*   文字字符（正则表达式）：`[-a-zA-Z0-9._*]`
*   空格字符`" "`被转换为加号`"+"`。

所以基本上，为了得到想要的结果，使用`URLEncoder.encode(s, "UTF-8")`然后做一些后处理：

*   将所有出现的 替换`"+"`为`"%20"`
*   将所有出现的`"%xx"`表示任何内容替换`[~'()!]`为其文字对应部分

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-03-03T17:13:57.967

使用 Java 6 附带的 javascript 引擎：

```
 import javax.script.ScriptEngine;
import javax.script.ScriptEngineManager;

public class Wow
{
    public static void main(String[] args) throws Exception
    {
        ScriptEngineManager factory = new ScriptEngineManager();
        ScriptEngine engine = factory.getEngineByName("JavaScript");
        engine.eval("print(encodeURIComponent('\"A\" B ± \"'))");
    }
} 

```

输出：%22A%22%20B%20%c2%b1%20%22

情况不同，但它更接近你想要的。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2016-02-09T14:13:03.567

我使用`java.net.URI#getRawPath()`，例如

```
String s = "a+b c.html";
String fixed = new URI(null, null, s, null).getRawPath(); 
```

`fixed`will的值是`a+b%20c.html`，这就是你想要的。

对 的输出进行后处理将消除*应该*在 URI 中的`URLEncoder.encode()`任何优点。例如

 *```
URLEncoder.encode("a+b c.html").replaceAll("\\+", "%20"); 
```

会给你`a%20b%20c.html`，这将被解释为`a b c.html`。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-04-05T16:20:43.813

我想出了我自己的encodeURIComponent版本，因为发布的解决方案有一个问题，如果字符串中有一个+，应该编码，它将转换为空格。

所以这是我的课：

```
import java.io.UnsupportedEncodingException;
import java.util.BitSet;

public final class EscapeUtils
{
    /** used for the encodeURIComponent function */
    private static final BitSet dontNeedEncoding;

    static
    {
        dontNeedEncoding = new BitSet(256);

        // a-z
        for (int i = 97; i <= 122; ++i)
        {
            dontNeedEncoding.set(i);
        }
        // A-Z
        for (int i = 65; i <= 90; ++i)
        {
            dontNeedEncoding.set(i);
        }
        // 0-9
        for (int i = 48; i <= 57; ++i)
        {
            dontNeedEncoding.set(i);
        }

        // '()*
        for (int i = 39; i <= 42; ++i)
        {
            dontNeedEncoding.set(i);
        }
        dontNeedEncoding.set(33); // !
        dontNeedEncoding.set(45); // -
        dontNeedEncoding.set(46); // .
        dontNeedEncoding.set(95); // _
        dontNeedEncoding.set(126); // ~
    }

    /**
     * A Utility class should not be instantiated.
     */
    private EscapeUtils()
    {

    }

    /**
     * Escapes all characters except the following: alphabetic, decimal digits, - _ . ! ~ * ' ( )
     * 
     * @param input
     *            A component of a URI
     * @return the escaped URI component
     */
    public static String encodeURIComponent(String input)
    {
        if (input == null)
        {
            return input;
        }

        StringBuilder filtered = new StringBuilder(input.length());
        char c;
        for (int i = 0; i < input.length(); ++i)
        {
            c = input.charAt(i);
            if (dontNeedEncoding.get(c))
            {
                filtered.append(c);
            }
            else
            {
                final byte[] b = charToBytesUTF(c);

                for (int j = 0; j < b.length; ++j)
                {
                    filtered.append('%');
                    filtered.append("0123456789ABCDEF".charAt(b[j] >> 4 & 0xF));
                    filtered.append("0123456789ABCDEF".charAt(b[j] & 0xF));
                }
            }
        }
        return filtered.toString();
    }

    private static byte[] charToBytesUTF(char c)
    {
        try
        {
            return new String(new char[] { c }).getBytes("UTF-8");
        }
        catch (UnsupportedEncodingException e)
        {
            return new byte[] { (byte) c };
        }
    }
} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2010-10-23T12:35:33.547

我想出了另一个实现，记录在[http://blog.sangupta.com/2010/05/encodeuricomponent-and.html](http://blog.sangupta.com/2010/05/encodeuricomponent-and.html)。该实现还可以处理 Unicode 字节。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-06-22T08:37:51.300

对我来说这有效：

```
import org.apache.http.client.utils.URIBuilder;

String encodedString = new URIBuilder()
  .setParameter("i", stringToEncode)
  .build()
  .getRawQuery() // output: i=encodedString
  .substring(2); 
```

或使用不同的 UriBuilder

```
import javax.ws.rs.core.UriBuilder;

String encodedString = UriBuilder.fromPath("")
  .queryParam("i", stringToEncode)
  .toString()   // output: ?i=encodedString
  .substring(3); 
```

在我看来，使用标准库是一个更好的主意，而不是手动后处理。@Chris 的回答看起来也不错，但它不适用于网址，例如“ [http://a+b](http://a+b) c.html”

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-05-22T16:42:09.820

我已经成功使用了 java.net.URI 类，如下所示：

```
public static String uriEncode(String string) {
    String result = string;
    if (null != string) {
        try {
            String scheme = null;
            String ssp = string;
            int es = string.indexOf(':');
            if (es > 0) {
                scheme = string.substring(0, es);
                ssp = string.substring(es + 1);
            }
            result = (new URI(scheme, ssp, null)).toString();
        } catch (URISyntaxException usex) {
            // ignore and use string that has syntax error
        }
    }
    return result;
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-09-25T14:12:35.883

这是 Ravi Wallau 解决方案的一个简单示例：

```
public String buildSafeURL(String partialURL, String documentName)
        throws ScriptException {
    ScriptEngineManager scriptEngineManager = new ScriptEngineManager();
    ScriptEngine scriptEngine = scriptEngineManager
            .getEngineByName("JavaScript");

    String urlSafeDocumentName = String.valueOf(scriptEngine
            .eval("encodeURIComponent('" + documentName + "')"));
    String safeURL = partialURL + urlSafeDocumentName;

    return safeURL;
}

public static void main(String[] args) {
    EncodeURIComponentDemo demo = new EncodeURIComponentDemo();
    String partialURL = "https://www.website.com/document/";
    String documentName = "Tom & Jerry Manuscript.pdf";

    try {
        System.out.println(demo.buildSafeURL(partialURL, documentName));
    } catch (ScriptException se) {
        se.printStackTrace();
    }
} 
```

**输出：** `https://www.website.com/document/Tom%20%26%20Jerry%20Manuscript.pdf`

它还回答了 Loren Shqipognja 评论中关于如何将 String 变量传递给`encodeURIComponent()`. 该方法`scriptEngine.eval()`返回一个`Object`，因此可以通过`String.valueOf()`其他方法将其转换为 String 。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2018-09-18T02:23:26.120

这就是我正在使用的：

```
private static final String HEX = "0123456789ABCDEF";

public static String encodeURIComponent(String str) {
    if (str == null) return null;

    byte[] bytes = str.getBytes(StandardCharsets.UTF_8);
    StringBuilder builder = new StringBuilder(bytes.length);

    for (byte c : bytes) {
        if (c >= 'a' ? c <= 'z' || c == '~' :
            c >= 'A' ? c <= 'Z' || c == '_' :
            c >= '0' ? c <= '9' :  c == '-' || c == '.')
            builder.append((char)c);
        else
            builder.append('%')
                   .append(HEX.charAt(c >> 4 & 0xf))
                   .append(HEX.charAt(c & 0xf));
    }

    return builder.toString();
} 
```

[它通过根据RFC 3986](https://www.rfc-editor.org/rfc/rfc3986)对不是非保留字符的每个字符进行百分比编码来超越 Javascript 。

* * *

这是相反的转换：

```
public static String decodeURIComponent(String str) {
    if (str == null) return null;

    int length = str.length();
    byte[] bytes = new byte[length / 3];
    StringBuilder builder = new StringBuilder(length);

    for (int i = 0; i < length; ) {
        char c = str.charAt(i);
        if (c != '%') {
            builder.append(c);
            i += 1;
        } else {
            int j = 0;
            do {
                char h = str.charAt(i + 1);
                char l = str.charAt(i + 2);
                i += 3;

                h -= '0';
                if (h >= 10) {
                    h |= ' ';
                    h -= 'a' - '0';
                    if (h >= 6) throw new IllegalArgumentException();
                    h += 10;
                }

                l -= '0';
                if (l >= 10) {
                    l |= ' ';
                    l -= 'a' - '0';
                    if (l >= 6) throw new IllegalArgumentException();
                    l += 10;
                }

                bytes[j++] = (byte)(h << 4 | l);
                if (i >= length) break;
                c = str.charAt(i);
            } while (c == '%');
            builder.append(new String(bytes, 0, j, UTF_8));
        }
    }

    return builder.toString();
} 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2019-07-22T14:02:16.690

我曾经 `String encodedUrl = new URI(null, url, null).toASCIIString();` 对网址进行编码。`url`在我使用的现有参数之后添加参数`UriComponentsBuilder`

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-05-25T02:48:02.307

我从 google-http-java-client 库中找到了 PercentEscaper 类，它可以很容易地用于实现 encodeURIComponent。

[来自 google-http-java-client javadoc](http://javadoc.google-http-java-client.googlecode.com/hg/1.9.0-beta/com/google/api/client/util/escape/PercentEscaper.html) [google-http-java-client home 的PercentEscaper](http://code.google.com/p/google-http-java-client/)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2016-03-23T05:26:13.807

Guava 库有 PercentEscaper：

`Escaper percentEscaper = new PercentEscaper("-_.*", false);`

“-_.*”是安全字符

false 表示 PercentEscaper 用 '%20' 转义空间，而不是 '+'

# c# - 如何枚举具有自定义类属性的所有类？

> ID：607178
> 
> 赞同：167
> 
> 时间：2009-03-03T16:43:25.903
> 
> 标签：c#, class, attributes, custom-attributes, enumerate

基于[MSDN 示例](https://web.archive.org/web/20170228051218/https://msdn.microsoft.com/en-us/library/aa288454(VS.71).aspx)的问题。

假设我们在独立桌面应用程序中有一些带有 HelpAttribute 的 C# 类。是否可以枚举具有此类属性的所有类？以这种方式识别类有意义吗？自定义属性将用于列出可能的菜单选项，选择项目将显示此类的屏幕实例。类/项目的数量将缓慢增长，但我认为这样我们可以避免在其他地方枚举它们。

* * *

## 回答 #1

> 赞同：223
> 
> 时间：2009-03-03T16:49:31.863

是的，一点没错。使用反射：

```
static IEnumerable<Type> GetTypesWithHelpAttribute(Assembly assembly) {
    foreach(Type type in assembly.GetTypes()) {
        if (type.GetCustomAttributes(typeof(HelpAttribute), true).Length > 0) {
            yield return type;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：117
> 
> 时间：2009-03-03T16:53:32.760

好吧，您必须枚举加载到当前应用程序域的所有程序集中的所有类。为此，您将在当前应用程序域的实例上调用该[`GetAssemblies`方法。](https://docs.microsoft.com/en-us/dotnet/api/system.appdomain.getassemblies)[`AppDomain`](https://docs.microsoft.com/en-us/dotnet/api/system.appdomain)

从那里，您将调用[`GetExportedTypes`](https://docs.microsoft.com/en-us/dotnet/api/system.reflection.assembly.getexportedtypes)（如果您只想要公共类型）或[`GetTypes`](https://docs.microsoft.com/en-us/dotnet/api/system.reflection.assembly.gettypes)在每个上调[`Assembly`](https://docs.microsoft.com/en-us/dotnet/api/system.reflection.assembly)用以获取程序集中包含的类型。

然后，您将在每个实例上调用[`GetCustomAttributes`扩展方法](https://docs.microsoft.com/en-us/dotnet/api/system.reflection.customattributeextensions.getcustomattributes)[`Type`](https://docs.microsoft.com/en-us/dotnet/api/system.type)，并传递您希望查找的属性的类型。

您可以使用 LINQ 为您简化此过程：

```
var typesWithMyAttribute =
    from a in AppDomain.CurrentDomain.GetAssemblies()
    from t in a.GetTypes()
    let attributes = t.GetCustomAttributes(typeof(HelpAttribute), true)
    where attributes != null && attributes.Length > 0
    select new { Type = t, Attributes = attributes.Cast<HelpAttribute>() }; 
```

上面的查询将为您提供应用了您的属性的每种类型，以及分配给它的属性的实例。

请注意，如果您将大量程序集加载到应用程序域中，则该操作可能会很昂贵。您可以使用[并行 LINQ](https://docs.microsoft.com/en-us/dotnet/standard/parallel-programming/parallel-linq-plinq)来减少操作时间（以 CPU 周期为代价），如下所示：

```
var typesWithMyAttribute =
    // Note the AsParallel here, this will parallelize everything after.
    from a in AppDomain.CurrentDomain.GetAssemblies().AsParallel()
    from t in a.GetTypes()
    let attributes = t.GetCustomAttributes(typeof(HelpAttribute), true)
    where attributes != null && attributes.Length > 0
    select new { Type = t, Attributes = attributes.Cast<HelpAttribute>() }; 
```

在特定条件下过滤它`Assembly`很简单：

```
Assembly assembly = ...;

var typesWithMyAttribute =
    from t in assembly.GetTypes()
    let attributes = t.GetCustomAttributes(typeof(HelpAttribute), true)
    where attributes != null && attributes.Length > 0
    select new { Type = t, Attributes = attributes.Cast<HelpAttribute>() }; 
```

如果程序集中有大量类型，那么您可以再次使用 Parallel LINQ：

```
Assembly assembly = ...;

var typesWithMyAttribute =
    // Partition on the type list initially.
    from t in assembly.GetTypes().AsParallel()
    let attributes = t.GetCustomAttributes(typeof(HelpAttribute), true)
    where attributes != null && attributes.Length > 0
    select new { Type = t, Attributes = attributes.Cast<HelpAttribute>() }; 
```

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2013-02-05T23:30:31.000

其他答案参考[GetCustomAttributes](http://msdn.microsoft.com/en-us/library/88d17d13.aspx)。添加这个作为使用[IsDefined的示例](http://msdn.microsoft.com/en-us/library/system.attribute.isdefined.aspx)

```
Assembly assembly = ...
var typesWithHelpAttribute = 
        from type in assembly.GetTypes()
        where type.IsDefined(typeof(HelpAttribute), false)
        select type; 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-03-03T17:03:27.947

如前所述，反思是要走的路。如果你要经常调用它，我强烈建议缓存结果，因为反射，尤其是枚举每个类，可能会很慢。

这是我的代码片段，它贯穿所有加载的程序集中的所有类型：

```
// this is making the assumption that all assemblies we need are already loaded.
foreach (Assembly assembly in AppDomain.CurrentDomain.GetAssemblies()) 
{
    foreach (Type type in assembly.GetTypes())
    {
        var attribs = type.GetCustomAttributes(typeof(MyCustomAttribute), false);
        if (attribs != null && attribs.Length > 0)
        {
            // add to a cache.
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2016-12-31T19:40:57.923

这是在公认解决方案之上的性能增强。迭代所有类可能会很慢，因为有很多。有时您可以过滤掉整个程序集，而无需查看其任何类型。

例如，如果您正在寻找您自己声明的属性，您不希望任何系统 DLL 包含具有该属性的任何类型。Assembly.GlobalAssemblyCache 属性是检查系统 DLL 的快速方法。当我在一个真实的程序上尝试这个时，我发现我可以跳过 30,101 种类型，而我只需要检查 1,983 种类型。

另一种过滤方法是使用 Assembly.ReferencedAssemblies。大概如果您想要具有特定属性的类，并且该属性是在特定程序集中定义的，那么您只关心该程序集和引用它的其他程序集。在我的测试中，这比检查 GlobalAssemblyCache 属性稍有帮助。

我将这两者结合起来，速度更快。下面的代码包括两个过滤器。

```
 string definedIn = typeof(XmlDecoderAttribute).Assembly.GetName().Name;
        foreach (Assembly assembly in AppDomain.CurrentDomain.GetAssemblies())
            // Note that we have to call GetName().Name.  Just GetName() will not work.  The following
            // if statement never ran when I tried to compare the results of GetName().
            if ((!assembly.GlobalAssemblyCache) && ((assembly.GetName().Name == definedIn) || assembly.GetReferencedAssemblies().Any(a => a.Name == definedIn)))
                foreach (Type type in assembly.GetTypes())
                    if (type.GetCustomAttributes(typeof(XmlDecoderAttribute), true).Length > 0) 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2016-07-27T09:54:19.850

在[Portable .NET 限制](https://blogs.msdn.microsoft.com/dotnet/2016/02/10/porting-to-net-core/)的情况下，以下代码应该可以工作：

```
 public static IEnumerable<TypeInfo> GetAtributedTypes( Assembly[] assemblies, 
                                                           Type attributeType )
    {
        var typesAttributed =
            from assembly in assemblies
            from type in assembly.DefinedTypes
            where type.IsDefined(attributeType, false)
            select type;
        return typesAttributed;
    } 
```

或者对于使用基于循环状态的大量程序集`yield return`：

```
 public static IEnumerable<TypeInfo> GetAtributedTypes( Assembly[] assemblies, 
                                                           Type attributeType )
    {
        foreach (var assembly in assemblies)
        {
            foreach (var typeInfo in assembly.DefinedTypes)
            {
                if (typeInfo.IsDefined(attributeType, false))
                {
                    yield return typeInfo;
                }
            }
        }
    } 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-02-02T16:26:54.793

这是 Trade-Ideas philip 提供的代码的另一个版本，我已将代码压缩为 linq，将其插入到一个不错的静态函数中，您可以将其放入项目中。

原文： [https ://stackoverflow.com/a/41411243/4122889](https://stackoverflow.com/a/41411243/4122889)

我还添加了`AsParallel()`- 在我的机器上有足够的内核等，并且有一个“正常”大小的项目（这完全是主观的），这是最快的/

没有`AsParallel()`这个需要 1,5 秒来获得大约 200 个结果，而有了它，它需要大约几毫秒 - 因此这对我来说似乎是最快的。

请注意，这会跳过 GAC 中的程序集。

```
private static IEnumerable<IEnumerable<T>> GetAllAttributesInAppDomain<T>()
{
    var definedIn = typeof(T).Assembly.GetName().Name;
    var assemblies = AppDomain.CurrentDomain.GetAssemblies();

   var res = assemblies.AsParallel()
        .Where(assembly => (!assembly.GlobalAssemblyCache) && ((assembly.GetName().Name == definedIn) ||
                                                               assembly.GetReferencedAssemblies()
                                                                   .Any(a => a.Name == definedIn))
            )
        .SelectMany(c => c.GetTypes())
        .Select(type => type.GetCustomAttributes(typeof(T), true)
            .Cast<T>()
            )
        .Where(c => c.Any());

    return res;
} 
```

用法：

```
var allAttributesInAppDomain = GetAllAttributesInAppDomain<ExportViewAttribute>(); 
```

请注意，如果每个类只有 1 个属性，而不是多个属性，则更容易将结果展平`IEnumerable<IEnumerable<T>>`为`IEnumerable<T>`：

```
var allAttributesInAppDomainFlattened = allAttributesInAppDomain.SelectMany(c => c); 
```

请记住，这使用`IEnumerable`so 调用`ToList()`来实际运行该函数。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-11-30T18:00:51.360

我们可以改进 Andrew 的答案并将整个事情转换为一个 LINQ 查询。

```
 public static IEnumerable<Type> GetTypesWithHelpAttribute(Assembly assembly)
    {
        return assembly.GetTypes().Where(type => type.GetCustomAttributes(typeof(HelpAttribute), true).Length > 0);
    } 
```

# asp.net - 是否有任何允许批量导入的*免费*、开源 .NET 购物车？

> ID：607183
> 
> 赞同：2
> 
> 时间：2009-03-03T16:44:49.690
> 
> 标签：asp.net, e-commerce

我已经审查了 DashCommerce、nopCommerce 和 DotShoppingCart 的可能用途，它们似乎都不允许以任何方式从现有数据中进行批量产品/类别/制造商/等导入（DotShoppingCart 似乎只允许在付费版本中使用它）。

我工作的公司有大约 30,000 种产品需要我们加载，至少有一千种左右。显然，手动输入是荒谬的，正如我之前在之前的问题中所说的那样，该公司非常便宜并且不会为软件付费，所以我需要一个免费的解决方案。

我没有时间按照 ASP.NET MVC Storefront 系列来推出我自己的解决方案，否则我只会这样做；我的老板似乎认为创建一个在线商店非常简单（几个月前我已经建立了一个经典的 ASP 网站，但我们最近更换了我们的主要供应商，所以我不能使用其中的大部分；无论如何，它几乎都被黑客入侵了，而且如果不为新供应商重新加工很多东西，我就无法真正使用它），如果/当我告诉他我需要几个月的时间时，我不想听到他的声音；他已经等了 90 天，因为他有一些 SEO 专家开始写博客/营销它，并且不明白编写软件需要时间，这不是一周甚至一个月就能拼凑起来的东西。

有什么东西可以满足这些要求吗？在紧要关头，我想我可以安装 DashCommerce 或其他东西并询问它创建的数据库模式以强制自己导入，从而为他提供他似乎想要的快速解决方案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-03T17:31:10.843

编写一个连接数据库并插入行的简单应用程序大约需要 20 分钟。您所需要的只是一个读取一行，写入一行的循环......

# python - Python 的“超级”如何做正确的事？

> ID：607186
> 
> 赞同：56
> 
> 时间：2009-03-03T16:45:37.193
> 
> 标签：python, constructor, multiple-inheritance, super, python-2.5

我正在运行 Python 2.5，所以这个问题可能不适用于 Python 3。当您使用多重继承创建菱形类层次结构并创建派生类的对象时，Python 会做正确的事情 (TM)。它调用派生类的构造函数，然后是从左到右列出的父类，然后是祖父类。我熟悉 Python 的[MRO](http://www.python.org/download/releases/2.3/mro/)；那不是我的问题。我很好奇从 super 返回的对象实际上如何以正确的顺序与父类中的 super 调用进行通信。考虑这个示例代码：

```
#!/usr/bin/python

class A(object):
    def __init__(self): print "A init"

class B(A):
    def __init__(self):
        print "B init"
        super(B, self).__init__()

class C(A):
    def __init__(self):
        print "C init"
        super(C, self).__init__()

class D(B, C):
    def __init__(self):
        print "D init"
        super(D, self).__init__()

x = D() 
```

代码做直观的事情，它打印：

```
D init
B init
C init
A init 
```

但是，如果您在 B 的 init 函数中注释掉对 super 的调用，则不会调用 A 和 C 的 init 函数。这意味着 B 对 super 的调用以某种方式知道 C 在整个类层次结构中的存在。我知道 super 返回一个带有重载 get 运算符的代理对象，但是 D 的 init 定义中 super 返回的对象如何将 C 的存在传达给 B 的 init 定义中 super 返回的对象？后续调用 super 使用的信息是否存储在对象本身上？如果是这样，为什么不是 super 而不是 self.super？

编辑：Jekke 非常正确地指出它不是 self.super 因为 super 是类的属性，而不是类的实例。从概念上讲这是有道理的，但实际上 super 也不是类的属性！您可以在解释器中通过创建两个类 A 和 B（其中 B 继承自 A）并调用`dir(B)`. 它没有`super`或`__super__`属性。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-03-03T17:17:53.700

将您的代码更改为此，我认为它会解释一些事情（大概`super`是在看，比如说，在哪里`B`？`__mro__`）：

```
class A(object):
    def __init__(self):
        print "A init"
        print self.__class__.__mro__

class B(A):
    def __init__(self):
        print "B init"
        print self.__class__.__mro__
        super(B, self).__init__()

class C(A):
    def __init__(self):
        print "C init"
        print self.__class__.__mro__
        super(C, self).__init__()

class D(B, C):
    def __init__(self):
        print "D init"
        print self.__class__.__mro__
        super(D, self).__init__()

x = D() 
```

如果你运行它，你会看到：

```
D init
(<class '__main__.D'>, <class '__main__.B'>, <class '__main__.C'>, <class '__main__.A'>, <type 'object'>)
B init
(<class '__main__.D'>, <class '__main__.B'>, <class '__main__.C'>, <class '__main__.A'>, <type 'object'>)
C init
(<class '__main__.D'>, <class '__main__.B'>, <class '__main__.C'>, <class '__main__.A'>, <type 'object'>)
A init
(<class '__main__.D'>, <class '__main__.B'>, <class '__main__.C'>, <class '__main__.A'>, <type 'object'>) 
```

另外值得一试[的是 Python 的 Super 很漂亮，但你不能使用它](http://fuhm.net/super-harmful/)。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-03-03T17:58:41.900

我在下面提供了一堆链接，这些链接比我希望的更详细、更准确地回答了您的问题。但是，我也会用我自己的话回答您的问题，以节省您的时间。我会用分数表示-

1.  super 是一个内置函数，而不是一个属性。
2.  Python 中的每个*类型*（类）都有一个`__mro__`属性，用于存储该特定实例的方法解析顺序。
3.  对 super 的每次调用都采用 super(type[, object-or-type]) 的形式。让我们暂时假设第二个属性是一个对象。
4.  在超级调用的起点，对象是派生类的类型（**比如 DC**）。
5.  super 在指定为第一个参数的类之后（在本例中为 DC 之后的类）在 MRO 中的类中查找匹配的方法（在您的情况下`__init__`）。
6.  当找到匹配方法时（比如在类**BC1**中），它被调用。
    （这个方法应该使用 super，所以我假设它确实如此 - 请参阅 Python 的 super 很漂亮但不能使用 - 下面的链接）然后该方法会导致在对象的类的 MRO 中搜索下一个方法，在右侧**BC1**。
7.  重复冲洗，直到找到并调用所有方法。

**你的例子的解释**

```
 MRO: D,B,C,A,object 
```

1.  `super(D, self).__init__()`叫做。isinstance(self, D) => True
2.  在 D 右侧的类中 搜索 MRO 中的**下一个方法。**

    `B.__init__`找到并打电话

* * *

3.  `B.__init__`来电 `super(B, self).__init__()`。

    isinstance(self, B) => False
    isinstance(self, D) => True

4.  因此，MRO 是相同的，但搜索继续到 B 的右侧，即 C、A、对象被一一搜索。调用下一个`__init__`找到的。

5.  等等等等。

**super 的解释**
[http://www.python.org/download/releases/2.2.3/descrintro/#cooperation](http://www.python.org/download/releases/2.2.3/descrintro/#cooperation)
**使用 super 时要注意的事项**
[http://fuhm.net/super-harmful/](http://fuhm.net/super-harmful/)
**Pythons MRO 算法：**
[http ://www.python.org/download/releases/2.3/mro/](http://www.python.org/download/releases/2.3/mro/)
**super 的文档：**
[http ://docs.python.org/library/functions.html](http://docs.python.org/library/functions.html)
**这个页面的底部有一个关于 super 的很好的部分：**
[http:// /docstore.mik.ua/orelly/other/python/0596001886_pythonian-chp-5-sect-2.html](http://docstore.mik.ua/orelly/other/python/0596001886_pythonian-chp-5-sect-2.html)

我希望这有助于清除它。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-03T17:14:45.220

只是猜测：

`self`在所有四个方法中都引用同一个对象，即 class `D`。因此，在 中`B.__init__()`，对 to 的调用`super(B,self)`知道整个钻石血统，`self`并且它必须从 'after' 获取方法`B`。在这种情况下，它是`C`类。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-12-18T20:57:49.843

`super()`知道**完整**的类层次结构。这是 B 的 init 内部发生的情况：

```
>>> super(B, self)
<super: <class 'B'>, <D object>> 
```

这解决了中心问题，

> D 的 init 定义中 super 返回的对象如何将 C 的存在传达给 B 的 init 定义中 super 返回的对象？

也就是说，在 B 的 init 定义中，`self`是 的一个实例`D`，因此传达了 的存在`C`。例如`C`可以在`type(self).__mro__`.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-07-09T21:48:22.220

Jacob 的回答显示了如何理解问题，而 batbrat 的回答显示了细节，hrr 的回答直截了当。

他们没有从您的问题中涵盖（至少没有明确）的一件事是这一点：

> 但是，如果您在 B 的 init 函数中注释掉对 super 的调用，则不会调用 A 和 C 的 init 函数。

要理解这一点，请将 Jacob 的代码更改为在 A 的 init 上打印堆栈，如下所示：

```
import traceback

class A(object):
    def __init__(self):
        print "A init"
        print self.__class__.__mro__
        traceback.print_stack()

class B(A):
    def __init__(self):
        print "B init"
        print self.__class__.__mro__
        super(B, self).__init__()

class C(A):
    def __init__(self):
        print "C init"
        print self.__class__.__mro__
        super(C, self).__init__()

class D(B, C):
    def __init__(self):
        print "D init"
        print self.__class__.__mro__
        super(D, self).__init__()

x = D() 
```

`B`看到那行`super(B, self).__init__()`实际上是在调用，这有点令人惊讶`C.__init__()`，因为`C`它不是`B`.

```
D init
(<class '__main__.D'>, <class '__main__.B'>, <class '__main__.C'>, <class '__main__.A'>, <type 'object'>)
B init
(<class '__main__.D'>, <class '__main__.B'>, <class '__main__.C'>, <class '__main__.A'>, <type 'object'>)
C init
(<class '__main__.D'>, <class '__main__.B'>, <class '__main__.C'>, <class '__main__.A'>, <type 'object'>)
A init
(<class '__main__.D'>, <class '__main__.B'>, <class '__main__.C'>, <class '__main__.A'>, <type 'object'>)
  File "/tmp/jacobs.py", line 31, in <module>
    x = D()
  File "/tmp/jacobs.py", line 29, in __init__
    super(D, self).__init__()
  File "/tmp/jacobs.py", line 17, in __init__
    super(B, self).__init__()
  File "/tmp/jacobs.py", line 23, in __init__
    super(C, self).__init__()
  File "/tmp/jacobs.py", line 11, in __init__
    traceback.print_stack() 
```

发生这种情况是因为`super (B, self)`不是'*调用 B 的基类版本`__init__`*'。相反，它是 '*调用`__init__`右侧的第一个类，`B`它存在于`self`'s上`__mro__`并且具有这样的属性*。

因此，如果您*在 B 的 init 函数中注释掉对 super 的调用*，则方法堆栈将停止在`B.__init__`，并且永远不会到达`C`or `A`。

总结一下：

*   无论哪个类引用它，`self`始终是对实例的引用，并且它`__mro__`和`__class__`保持不变
*   super() 查找查找 . 上当前类右侧的类的方法`__mro__`。由于`__mro__`保持不变，发生的情况是它作为列表而不是树或图进行搜索。

关于最后一点，请注意 MRO 算法的全称是*C3 超类线性化*。也就是说，它将结构扁平化为列表。当不同的`super()`调用发生时，它们实际上是在迭代该列表。

# asp.net-mvc - 支持下拉列表 .NET MVC 中的 optgroup？

> ID：607188
> 
> 赞同：65
> 
> 时间：2009-03-03T16:46:06.257
> 
> 标签：asp.net-mvc, drop-down-menu

从这个问题继续以[编程方式创建一个下拉列表](https://stackoverflow.com/questions/323063/whats-the-best-way-to-set-a-dropdown-to-selected-in-asp-net-mvc-markup)，我希望我的列表也有几个`optgroup`列表。这目前可能吗？

我知道我需要将 selectList 传递给 dropDownList，但不知道如何将文本、值、optgroup 添加到 selectList。

我希望最终结果产生：

```
<option value="">Please select</option>
  <optgroup label="Option A">
    <option value="1">1</option>
    <option value="2">2</option>
    <option value="3">3</option>
    <option value="4">4</option>
  </optgroup>
  <optgroup label="Option B">
    <option value="a">A</option>
    <option value="b">B</option>
    <option value="c">C</option>
  </optgroup>
</option> 
```

* * *

## 回答 #1

> 赞同：92
> 
> 时间：2010-11-22T18:26:47.977

我的扩展有点复杂，但它具有原始 DropDownList 所具有的所有重载。

实际上，我专门创建了它，以便能够生成带有组的 DropDownList 并在[jDoubleSelect的帮助下转换为两个连接的选择](http://www.senamion.com/blog/jDoubleSelect.html)

```
using System;using System.Collections;using System.Collections.Generic;using System.Globalization; using System.Linq;using System.Linq.Expressions;using System.Text; using System.Web;using System.Web.Mvc;using System.Web.Routing;

public class GroupedSelectListItem : SelectListItem
{
    public string GroupKey { get; set; }
    public string GroupName { get; set; }
}

public static class HtmlHelpers
{
    public static MvcHtmlString DropDownGroupList(this HtmlHelper htmlHelper, string name)
    {
        return DropDownListHelper(htmlHelper, name, null, null, null);
    }

    public static MvcHtmlString DropDownGroupList(this HtmlHelper htmlHelper, string name, IEnumerable<GroupedSelectListItem> selectList)
    {
        return DropDownListHelper(htmlHelper, name, selectList, null, null);
    }

    public static MvcHtmlString DropDownGroupList(this HtmlHelper htmlHelper, string name, string optionLabel)
    {
        return DropDownListHelper(htmlHelper, name, null, optionLabel, null);
    }

    public static MvcHtmlString DropDownGroupList(this HtmlHelper htmlHelper, string name, IEnumerable<GroupedSelectListItem> selectList, IDictionary<string, object> htmlAttributes)
    {
        return DropDownListHelper(htmlHelper, name, selectList, null, htmlAttributes);
    }

    public static MvcHtmlString DropDownGroupList(this HtmlHelper htmlHelper, string name, IEnumerable<GroupedSelectListItem> selectList, object htmlAttributes)
    {
        return DropDownListHelper(htmlHelper, name, selectList, null, HtmlHelper.AnonymousObjectToHtmlAttributes(htmlAttributes));
    }

    public static MvcHtmlString DropDownGroupList(this HtmlHelper htmlHelper, string name, IEnumerable<GroupedSelectListItem> selectList, string optionLabel)
    {
        return DropDownListHelper(htmlHelper, name, selectList, optionLabel, null);
    }

    public static MvcHtmlString DropDownGroupList(this HtmlHelper htmlHelper, string name, IEnumerable<GroupedSelectListItem> selectList, string optionLabel, IDictionary<string, object> htmlAttributes)
    {
        return DropDownListHelper(htmlHelper, name, selectList, optionLabel, htmlAttributes);
    }

    public static MvcHtmlString DropDownGroupList(this HtmlHelper htmlHelper, string name, IEnumerable<GroupedSelectListItem> selectList, string optionLabel, object htmlAttributes)
    {
        return DropDownListHelper(htmlHelper, name, selectList, optionLabel, HtmlHelper.AnonymousObjectToHtmlAttributes(htmlAttributes));
    }

    public static MvcHtmlString DropDownGroupListFor<TModel, TProperty>(this HtmlHelper<TModel> htmlHelper, Expression<Func<TModel, TProperty>> expression, IEnumerable<GroupedSelectListItem> selectList)
    {
        return DropDownGroupListFor(htmlHelper, expression, selectList, null /* optionLabel */, null /* htmlAttributes */);
    }

    public static MvcHtmlString DropDownGroupListFor<TModel, TProperty>(this HtmlHelper<TModel> htmlHelper, Expression<Func<TModel, TProperty>> expression, IEnumerable<GroupedSelectListItem> selectList, object htmlAttributes)
    {
        return DropDownGroupListFor(htmlHelper, expression, selectList, null /* optionLabel */, HtmlHelper.AnonymousObjectToHtmlAttributes(htmlAttributes));
    }

    public static MvcHtmlString DropDownGroupListFor<TModel, TProperty>(this HtmlHelper<TModel> htmlHelper, Expression<Func<TModel, TProperty>> expression, IEnumerable<GroupedSelectListItem> selectList, IDictionary<string, object> htmlAttributes)
    {
        return DropDownGroupListFor(htmlHelper, expression, selectList, null /* optionLabel */, htmlAttributes);
    }

    public static MvcHtmlString DropDownGroupListFor<TModel, TProperty>(this HtmlHelper<TModel> htmlHelper, Expression<Func<TModel, TProperty>> expression, IEnumerable<GroupedSelectListItem> selectList, string optionLabel)
    {
        return DropDownGroupListFor(htmlHelper, expression, selectList, optionLabel, null /* htmlAttributes */);
    }

    public static MvcHtmlString DropDownGroupListFor<TModel, TProperty>(this HtmlHelper<TModel> htmlHelper, Expression<Func<TModel, TProperty>> expression, IEnumerable<GroupedSelectListItem> selectList, string optionLabel, object htmlAttributes)
    {
        return DropDownGroupListFor(htmlHelper, expression, selectList, optionLabel, HtmlHelper.AnonymousObjectToHtmlAttributes(htmlAttributes));
    }

    public static MvcHtmlString DropDownGroupListFor<TModel, TProperty>(this HtmlHelper<TModel> htmlHelper, Expression<Func<TModel, TProperty>> expression, IEnumerable<GroupedSelectListItem> selectList, string optionLabel, IDictionary<string, object> htmlAttributes)
    {
        if (expression == null)
        {
            throw new ArgumentNullException("expression");
        }

        return DropDownListHelper(htmlHelper, ExpressionHelper.GetExpressionText(expression), selectList, optionLabel, htmlAttributes);
    }

    private static MvcHtmlString DropDownListHelper(HtmlHelper htmlHelper, string expression, IEnumerable<GroupedSelectListItem> selectList, string optionLabel, IDictionary<string, object> htmlAttributes)
    {
        return SelectInternal(htmlHelper, optionLabel, expression, selectList, false /* allowMultiple */, htmlAttributes);
    }

    // Helper methods

    private static IEnumerable<GroupedSelectListItem> GetSelectData(this HtmlHelper htmlHelper, string name)
    {
        object o = null;
        if (htmlHelper.ViewData != null)
        {
            o = htmlHelper.ViewData.Eval(name);
        }
        if (o == null)
        {
            throw new InvalidOperationException(
                String.Format(
                    CultureInfo.CurrentCulture,
                    "Missing Select Data"));
        }
        var selectList = o as IEnumerable<GroupedSelectListItem>;
        if (selectList == null)
        {
            throw new InvalidOperationException(
                String.Format(
                    CultureInfo.CurrentCulture,
                    "Wrong Select DataType"));
        }
        return selectList;
    }

    internal static string ListItemToOption(GroupedSelectListItem item)
    {
        var builder = new TagBuilder("option")
        {
            InnerHtml = HttpUtility.HtmlEncode(item.Text)
        };
        if (item.Value != null)
        {
            builder.Attributes["value"] = item.Value;
        }
        if (item.Selected)
        {
            builder.Attributes["selected"] = "selected";
        }
        return builder.ToString(TagRenderMode.Normal);
    }

    private static MvcHtmlString SelectInternal(this HtmlHelper htmlHelper, string optionLabel, string name, IEnumerable<GroupedSelectListItem> selectList, bool allowMultiple, IDictionary<string, object> htmlAttributes)
    {
        name = htmlHelper.ViewContext.ViewData.TemplateInfo.GetFullHtmlFieldName(name);
        if (String.IsNullOrEmpty(name))
        {
            throw new ArgumentException("Null Or Empty", "name");
        }

        bool usedViewData = false;

        // If we got a null selectList, try to use ViewData to get the list of items.
        if (selectList == null)
        {
            selectList = htmlHelper.GetSelectData(name);
            usedViewData = true;
        }

        object defaultValue = (allowMultiple) ? htmlHelper.GetModelStateValue(name, typeof(string[])) : htmlHelper.GetModelStateValue(name, typeof(string));

        // If we haven't already used ViewData to get the entire list of items then we need to
        // use the ViewData-supplied value before using the parameter-supplied value.
        if (!usedViewData)
        {
            if (defaultValue == null)
            {
                defaultValue = htmlHelper.ViewData.Eval(name);
            }
        }

        if (defaultValue != null)
        {
            var defaultValues = (allowMultiple) ? defaultValue as IEnumerable : new[] { defaultValue };
            var values = from object value in defaultValues select Convert.ToString(value, CultureInfo.CurrentCulture);
            var selectedValues = new HashSet<string>(values, StringComparer.OrdinalIgnoreCase);
            var newSelectList = new List<GroupedSelectListItem>();

            foreach (var item in selectList)
            {
                item.Selected = (item.Value != null) ? selectedValues.Contains(item.Value) : selectedValues.Contains(item.Text);
                newSelectList.Add(item);
            }
            selectList = newSelectList;
        }

        // Convert each ListItem to an <option> tag
        var listItemBuilder = new StringBuilder();

        // Make optionLabel the first item that gets rendered.
        if (optionLabel != null)
        {
            listItemBuilder.AppendLine(ListItemToOption(new GroupedSelectListItem { Text = optionLabel, Value = String.Empty, Selected = false }));
        }

        foreach (var group in selectList.GroupBy(i => i.GroupKey))
        {
            string groupName = selectList.Where(i => i.GroupKey == group.Key).Select(it => it.GroupName).FirstOrDefault();
            listItemBuilder.AppendLine(string.Format("<optgroup label=\"{0}\" value=\"{1}\">", groupName, group.Key));
            foreach (GroupedSelectListItem item in group)
            {
                listItemBuilder.AppendLine(ListItemToOption(item));
            }
            listItemBuilder.AppendLine("</optgroup>");
        }

        var tagBuilder = new TagBuilder("select")
        {
            InnerHtml = listItemBuilder.ToString()
        };
        tagBuilder.MergeAttributes(htmlAttributes);
        tagBuilder.MergeAttribute("name", name, true /* replaceExisting */);
        tagBuilder.GenerateId(name);
        if (allowMultiple)
        {
            tagBuilder.MergeAttribute("multiple", "multiple");
        }

        // If there are any errors for a named field, we add the css attribute.
        ModelState modelState;
        if (htmlHelper.ViewData.ModelState.TryGetValue(name, out modelState))
        {
            if (modelState.Errors.Count > 0)
            {
                tagBuilder.AddCssClass(HtmlHelper.ValidationInputCssClassName);
            }
        }

        return MvcHtmlString.Create(tagBuilder.ToString());
    }

    internal static object GetModelStateValue(this HtmlHelper helper, string key, Type destinationType)
    {
        ModelState modelState;
        if (helper.ViewData.ModelState.TryGetValue(key, out modelState))
        {
            if (modelState.Value != null)
            {
                return modelState.Value.ConvertTo(destinationType, null /* culture */);
            }
        }
        return null;
    }

} 
```

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2014-09-09T13:40:15.950

这是在 5.2 版中添加到 ASP.Net MVC 的，现在是内置的。

[SelectListItem 上](http://msdn.microsoft.com/en-us/library/system.web.mvc.selectlistitem(v=vs.118).aspx)的Group 属性允许您为每个项目指定一个组：

新的[SelectList 构造函数](http://msdn.microsoft.com/en-us/library/system.web.mvc.selectlist.selectlist(v=vs.118).aspx)还允许您在提供的项目列表中提供包含组标题的字段名称。

HtmlHelper DropDownList 和 DropDownListFor 方法现在根据项目列表中包含的组生成 optgroup 元素。

简单的！

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2009-05-21T21:45:27.930

我只是为此编写了一个扩展，请看：

* * *

```
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Web.Routing;

namespace System.Web.Mvc.Html
{
    public static class GroupDropListExtensions
    {
        public static string GroupDropList(this HtmlHelper helper, string name, IEnumerable<GroupDropListItem> data, string SelectedValue, object htmlAttributes)
        {
            if (data == null && helper.ViewData != null)
                data = helper.ViewData.Eval(name) as IEnumerable<GroupDropListItem>;
            if (data == null) return string.Empty;

            var select = new TagBuilder("select");

            if (htmlAttributes != null)
                select.MergeAttributes(new RouteValueDictionary(htmlAttributes));

            select.GenerateId(name);

            var optgroupHtml = new StringBuilder();
            var groups = data.ToList();
            foreach (var group in data)
            {
                var groupTag = new TagBuilder("optgroup");
                groupTag.Attributes.Add("label", helper.Encode( group.Name));
                var optHtml = new StringBuilder();
                foreach (var item in group.Items)
                {
                    var option = new TagBuilder("option");
                    option.Attributes.Add("value", helper.Encode(item.Value));
                    if (SelectedValue != null && item.Value == SelectedValue)
                        option.Attributes.Add("selected", "selected");
                    option.InnerHtml = helper.Encode(item.Text);
                    optHtml.AppendLine(option.ToString(TagRenderMode.Normal));
                }
                groupTag.InnerHtml = optHtml.ToString();
                optgroupHtml.AppendLine(groupTag.ToString(TagRenderMode.Normal));
            }
            select.InnerHtml = optgroupHtml.ToString();
            return select.ToString(TagRenderMode.Normal);
        }
}

    public class GroupDropListItem
    {
        public string Name { get; set; }
        public List<OptionItem> Items { get; set; }
    }

    public class OptionItem
    {
        public string Text { get; set; }
        public string Value { get; set; }
    }
} 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2009-03-03T17:07:24.347

查看[www.codeplex.com/aspnet](http://www.codeplex.com/aspnet)上的代码，SelectList 和 DropDownList 扩展方法似乎都不支持在选择中使用 OptGroup。看起来您需要编写自己的扩展方法并扩展 SelectListItem 以包含分组或在标记中手动生成选择。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-03-07T04:58:31.430

缺少客户端验证的数据注释？

在回答上面 Chrno Love 的问题时，添加到 Serge Zab 的解决方案 - Milimetric 在同一视图中使用下拉列表时对 MVC3 客户端验证属性的修复：

```
 public static MvcHtmlString DropDownGroupListFor<TModel, TProperty>(this HtmlHelper<TModel> htmlHelper,
                                                                        Expression<Func<TModel, TProperty>>
                                                                            expression,
                                                                        IEnumerable<GroupedSelectListItem>
                                                                            selectList, string optionLabel,
                                                                        IDictionary<string, object> htmlAttributes)
    {
        if (expression == null)
        {
            throw new ArgumentNullException("expression");
        }

        // fixing clientside validation attributes
        // http://stackoverflow.com/questions/4799958/asp-net-mvc-3-unobtrusive-client-validation-does-not-work-with-drop-down-lists/8102022#8102022
        var metadata = ModelMetadata.FromLambdaExpression(expression, htmlHelper.ViewData);
            var mergedAttributes =
                htmlHelper.GetUnobtrusiveValidationAttributes(ExpressionHelper.GetExpressionText(expression), metadata);

            if (htmlAttributes != null)
            {
                foreach (PropertyDescriptor descriptor in TypeDescriptor.GetProperties(htmlAttributes))
                {
                    object value = descriptor.GetValue(htmlAttributes);
                    mergedAttributes.Add(descriptor.Name, value);
                }
            }

        //return DropDownListHelper(htmlHelper, ExpressionHelper.GetExpressionText(expression), selectList, optionLabel, htmlAttributes);
        return DropDownListHelper(htmlHelper, ExpressionHelper.GetExpressionText(expression), selectList, optionLabel, mergedAttributes);
    } 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-12-11T16:32:09.167

Serge Zab 的回答正是我想要的。作为一个顽固的 VB 程序员，我将它移植到了这个 VB 模块：

```
'based on Serge Zab's answer on http://stackoverflow.com/questions/607188/support-for-optgroup-in-dropdownlist-net-mvc

Imports System.Collections
Imports System.Collections.Generic
Imports System.Globalization
Imports System.Linq
Imports System.Linq.Expressions
Imports System.Text
Imports System.Web
Imports System.Web.Mvc
Imports System.Web.Routing

Public Class GroupedSelectListItem
    Inherits SelectListItem
    Public Property GroupKey() As String
        Get
            Return m_GroupKey
        End Get
        Set(value As String)
            m_GroupKey = Value
        End Set
    End Property
    Private m_GroupKey As String
    Public Property GroupName() As String
        Get
            Return m_GroupName
        End Get
        Set(value As String)
            m_GroupName = Value
        End Set
    End Property
    Private m_GroupName As String
End Class

Public Module HtmlHelpers
    <System.Runtime.CompilerServices.Extension> _
    Public Function DropDownGroupList(htmlHelper As HtmlHelper, name As String) As MvcHtmlString
        Return DropDownListHelper(htmlHelper, name, Nothing, Nothing, Nothing)
    End Function

    <System.Runtime.CompilerServices.Extension> _
    Public Function DropDownGroupList(htmlHelper As HtmlHelper, name As String, selectList As IEnumerable(Of GroupedSelectListItem)) As MvcHtmlString
        Return DropDownListHelper(htmlHelper, name, selectList, Nothing, Nothing)
    End Function

    <System.Runtime.CompilerServices.Extension> _
    Public Function DropDownGroupList(htmlHelper As HtmlHelper, name As String, optionLabel As String) As MvcHtmlString
        Return DropDownListHelper(htmlHelper, name, Nothing, optionLabel, Nothing)
    End Function

    <System.Runtime.CompilerServices.Extension> _
    Public Function DropDownGroupList(htmlHelper As HtmlHelper, name As String, selectList As IEnumerable(Of GroupedSelectListItem), htmlAttributes As IDictionary(Of String, Object)) As MvcHtmlString
        Return DropDownListHelper(htmlHelper, name, selectList, Nothing, htmlAttributes)
    End Function

    <System.Runtime.CompilerServices.Extension> _
    Public Function DropDownGroupList(htmlHelper As HtmlHelper, name As String, selectList As IEnumerable(Of GroupedSelectListItem), htmlAttributes As Object) As MvcHtmlString
        Return DropDownListHelper(htmlHelper, name, selectList, Nothing, New RouteValueDictionary(htmlAttributes))
    End Function

    <System.Runtime.CompilerServices.Extension> _
    Public Function DropDownGroupList(htmlHelper As HtmlHelper, name As String, selectList As IEnumerable(Of GroupedSelectListItem), optionLabel As String) As MvcHtmlString
        Return DropDownListHelper(htmlHelper, name, selectList, optionLabel, Nothing)
    End Function

    <System.Runtime.CompilerServices.Extension> _
    Public Function DropDownGroupList(htmlHelper As HtmlHelper, name As String, selectList As IEnumerable(Of GroupedSelectListItem), optionLabel As String, htmlAttributes As IDictionary(Of String, Object)) As MvcHtmlString
        Return DropDownListHelper(htmlHelper, name, selectList, optionLabel, htmlAttributes)
    End Function

    <System.Runtime.CompilerServices.Extension> _
    Public Function DropDownGroupList(htmlHelper As HtmlHelper, name As String, selectList As IEnumerable(Of GroupedSelectListItem), optionLabel As String, htmlAttributes As Object) As MvcHtmlString
        Return DropDownListHelper(htmlHelper, name, selectList, optionLabel, New RouteValueDictionary(htmlAttributes))
    End Function

    <System.Runtime.CompilerServices.Extension> _
    Public Function DropDownGroupListFor(Of TModel, TProperty)(htmlHelper As HtmlHelper(Of TModel), expression As Expression(Of Func(Of TModel, TProperty)), selectList As IEnumerable(Of GroupedSelectListItem)) As MvcHtmlString
        ' optionLabel 
        ' htmlAttributes 
        Return DropDownGroupListFor(htmlHelper, expression, selectList, Nothing, Nothing)
    End Function

    <System.Runtime.CompilerServices.Extension> _
    Public Function DropDownGroupListFor(Of TModel, TProperty)(htmlHelper As HtmlHelper(Of TModel), expression As Expression(Of Func(Of TModel, TProperty)), selectList As IEnumerable(Of GroupedSelectListItem), htmlAttributes As Object) As MvcHtmlString
        ' optionLabel 
        Return DropDownGroupListFor(htmlHelper, expression, selectList, Nothing, New RouteValueDictionary(htmlAttributes))
    End Function

    <System.Runtime.CompilerServices.Extension> _
    Public Function DropDownGroupListFor(Of TModel, TProperty)(htmlHelper As HtmlHelper(Of TModel), expression As Expression(Of Func(Of TModel, TProperty)), selectList As IEnumerable(Of GroupedSelectListItem), htmlAttributes As IDictionary(Of String, Object)) As MvcHtmlString
        ' optionLabel 
        Return DropDownGroupListFor(htmlHelper, expression, selectList, Nothing, htmlAttributes)
    End Function

    <System.Runtime.CompilerServices.Extension> _
    Public Function DropDownGroupListFor(Of TModel, TProperty)(htmlHelper As HtmlHelper(Of TModel), expression As Expression(Of Func(Of TModel, TProperty)), selectList As IEnumerable(Of GroupedSelectListItem), optionLabel As String) As MvcHtmlString
        ' htmlAttributes 
        Return DropDownGroupListFor(htmlHelper, expression, selectList, optionLabel, Nothing)
    End Function

    <System.Runtime.CompilerServices.Extension> _
    Public Function DropDownGroupListFor(Of TModel, TProperty)(htmlHelper As HtmlHelper(Of TModel), expression As Expression(Of Func(Of TModel, TProperty)), selectList As IEnumerable(Of GroupedSelectListItem), optionLabel As String, htmlAttributes As Object) As MvcHtmlString
        Return DropDownGroupListFor(htmlHelper, expression, selectList, optionLabel, New RouteValueDictionary(htmlAttributes))
    End Function

    <System.Runtime.CompilerServices.Extension> _
    Public Function DropDownGroupListFor(Of TModel, TProperty)(htmlHelper As HtmlHelper(Of TModel), expression As Expression(Of Func(Of TModel, TProperty)), selectList As IEnumerable(Of GroupedSelectListItem), optionLabel As String, htmlAttributes As IDictionary(Of String, Object)) As MvcHtmlString
        If expression Is Nothing Then
            Throw New ArgumentNullException("expression")
        End If

        Return DropDownListHelper(htmlHelper, ExpressionHelper.GetExpressionText(expression), selectList, optionLabel, htmlAttributes)
    End Function

    Private Function DropDownListHelper(htmlHelper As HtmlHelper, expression As String, selectList As IEnumerable(Of GroupedSelectListItem), optionLabel As String, htmlAttributes As IDictionary(Of String, Object)) As MvcHtmlString
        ' allowMultiple 
        Return SelectInternal(htmlHelper, optionLabel, expression, selectList, False, htmlAttributes)
    End Function

    ' Helper methods

    <System.Runtime.CompilerServices.Extension> _
    Private Function GetSelectData(htmlHelper As HtmlHelper, name As String) As IEnumerable(Of GroupedSelectListItem)
        Dim o As Object = Nothing
        If htmlHelper.ViewData IsNot Nothing Then
            o = htmlHelper.ViewData.Eval(name)
        End If
        If o Is Nothing Then
            Throw New InvalidOperationException([String].Format(CultureInfo.CurrentCulture, "Missing Select Data", name, "IEnumerable<GroupedSelectListItem>"))
        End If
        Dim selectList As IEnumerable(Of GroupedSelectListItem) = TryCast(o, IEnumerable(Of GroupedSelectListItem))
        If selectList Is Nothing Then
            Throw New InvalidOperationException([String].Format(CultureInfo.CurrentCulture, "Wrong Select DataType", name, o.[GetType]().FullName, "IEnumerable<GroupedSelectListItem>"))
        End If
        Return selectList
    End Function

    Friend Function ListItemToOption(item As GroupedSelectListItem) As String
        Dim builder As New TagBuilder("option") With { _
             .InnerHtml = HttpUtility.HtmlEncode(item.Text) _
        }
        If item.Value IsNot Nothing Then
            builder.Attributes("value") = item.Value
        End If
        If item.Selected Then
            builder.Attributes("selected") = "selected"
        End If
        Return builder.ToString(TagRenderMode.Normal)
    End Function

    <System.Runtime.CompilerServices.Extension> _
    Private Function SelectInternal(htmlHelper__1 As HtmlHelper, optionLabel As String, name As String, selectList As IEnumerable(Of GroupedSelectListItem), allowMultiple As Boolean, htmlAttributes As IDictionary(Of String, Object)) As MvcHtmlString
        name = htmlHelper__1.ViewContext.ViewData.TemplateInfo.GetFullHtmlFieldName(name)
        If [String].IsNullOrEmpty(name) Then
            Throw New ArgumentException("Null Or Empty", "name")
        End If

        Dim usedViewData As Boolean = False

        ' If we got a null selectList, try to use ViewData to get the list of items.
        If selectList Is Nothing Then
            selectList = htmlHelper__1.GetSelectData(name)
            usedViewData = True
        End If

        Dim defaultValue As Object = If((allowMultiple), htmlHelper__1.GetModelStateValue(name, GetType(String())), htmlHelper__1.GetModelStateValue(name, GetType(String)))

        ' If we haven't already used ViewData to get the entire list of items then we need to
        ' use the ViewData-supplied value before using the parameter-supplied value.
        If Not usedViewData Then
            If defaultValue Is Nothing Then
                defaultValue = htmlHelper__1.ViewData.Eval(name)
            End If
        End If

        If defaultValue IsNot Nothing Then
            Dim defaultValues As IEnumerable = If((allowMultiple), TryCast(defaultValue, IEnumerable), New String() {defaultValue})
            Dim values As IEnumerable(Of String) = From value In defaultValues Select (Convert.ToString(value, CultureInfo.CurrentCulture))
            Dim selectedValues As New HashSet(Of String)(values, StringComparer.OrdinalIgnoreCase)
            Dim newSelectList As New List(Of GroupedSelectListItem)()

            For Each item As GroupedSelectListItem In selectList
                item.Selected = If((item.Value IsNot Nothing), selectedValues.Contains(item.Value), selectedValues.Contains(item.Text))
                newSelectList.Add(item)
            Next
            selectList = newSelectList
        End If

        ' Convert each ListItem to an <option> tag
        Dim listItemBuilder As New StringBuilder()

        ' Make optionLabel the first item that gets rendered.
        If optionLabel IsNot Nothing Then
            listItemBuilder.AppendLine(ListItemToOption(New GroupedSelectListItem() With { _
                 .Text = optionLabel, _
                 .Value = [String].Empty, _
                 .Selected = False _
            }))
        End If

        For Each group As Object In selectList.GroupBy(Function(i) i.GroupKey)
            Dim groupName As String = selectList.Where(Function(i) i.GroupKey = group.Key).[Select](Function(it) it.GroupName).FirstOrDefault()
            listItemBuilder.AppendLine(String.Format("<optgroup label=""{0}"" value=""{1}"">", groupName, group.Key))
            For Each item As GroupedSelectListItem In group
                listItemBuilder.AppendLine(ListItemToOption(item))
            Next
            listItemBuilder.AppendLine("</optgroup>")
        Next

        Dim tagBuilder As New TagBuilder("select") With { _
             .InnerHtml = listItemBuilder.ToString() _
        }
        TagBuilder.MergeAttributes(htmlAttributes)
        ' replaceExisting 
        TagBuilder.MergeAttribute("name", name, True)
        TagBuilder.GenerateId(name)
        If allowMultiple Then
            TagBuilder.MergeAttribute("multiple", "multiple")
        End If

        ' If there are any errors for a named field, we add the css attribute.
        Dim modelState As ModelState = Nothing
        If htmlHelper__1.ViewData.ModelState.TryGetValue(name, modelState) Then
            If modelState.Errors.Count > 0 Then
                TagBuilder.AddCssClass(HtmlHelper.ValidationInputCssClassName)
            End If
        End If

        Return MvcHtmlString.Create(TagBuilder.ToString())
    End Function

    <System.Runtime.CompilerServices.Extension> _
    Friend Function GetModelStateValue(helper As HtmlHelper, key As String, destinationType As Type) As Object
        Dim modelState As ModelState = Nothing
        If helper.ViewData.ModelState.TryGetValue(key, modelState) Then
            If modelState.Value IsNot Nothing Then
                ' culture 
                Return modelState.Value.ConvertTo(destinationType, Nothing)
            End If
        End If
        Return Nothing
    End Function

End Module 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-02-18T16:54:40.060

我一直在尝试@Serge Zab 解决方案，该解决方案效果很好，但在进行不显眼的验证时遇到了一些问题，经过一番检查后我发现了问题。

如果您希望在创建 TagBuilder 之后触发 Jquery 验证，则 select 元素中似乎缺少一些必需的属性

```
TagBuilder tagBuilder = new TagBuilder("select"); 
```

添加这些属性

```
tagBuilder.MergeAttribute("data-val", "true",true); 
tagBuilder.MergeAttribute("data-val-required", "your validation message", true) 
```

并且应该触发不引人注目的验证。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-09-14T20:45:03.977

在 Serge Zab的[回答](https://stackoverflow.com/questions/607188/support-for-optgroup-in-dropdownlist-net-mvc#4248856)中，数据属性，例如`data_valuename`，不要以正确的形式进行边距`data-valuename`。

我将方法中的代码`tagBuilder.MergeAttributes(htmlAttributes);`替换`SelectInternal`为此

```
foreach (var htmlAttribute in htmlAttributes)
{
     tagBuilder.MergeAttribute(
        htmlAttribute.Key.Replace('_', '-'), 
        (string)htmlAttribute.Value
     );
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-08-17T19:56:14.723

只是关于使用 Serge 的扩展在同一个表单上创建多个选择列表的说明。我在获取第二个选择列表以应用组时遇到问题，当我检查正在生成的 html 时，我意识到两者都被赋予了相同的 id。要解决此问题，请进入 serge 扩展中的 SelectInternal 函数并注释掉/删除以下两行：

tagBuilder.MergeAttribute("name", name, true /* replaceExisting */); tagBuilder.GenerateId(name);

或者，您可以将唯一的 id 传递给每个（尽管 DropDownGroupListFor 不采用“字符串名称”参数，因此您必须添加一个重载）

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-05-31T07:49:00.987

我需要一个解决方案来处理 optgroup 的多项选择，我使用了 Serge Zab 解决方案。我对此只有两条评论（评论太长了）。

*   尽管他声称，他的解决方案不支持所有现有的 DropDownListFor 重载，因为它不支持模型中经常使用的 MultiSelectList 或 SelectList。但这并不难添加这些。

*   他的解决方案不适用于多重选择以从模型中初始化选定/未选定项目：初始值不受影响。我刚刚修改了以下方法：

    私有静态 MvcHtmlString DropDownListHelper(...) { return SelectInternal(htmlHelper, optionLabel, expression, selectList, false /* allowMultiple */, htmlAttributes); }

对此：

```
private static MvcHtmlString DropDownListHelper(HtmlHelper htmlHelper, string expression, IEnumerable<GroupedSelectListItem> selectList, string optionLabel, IDictionary<string, object> htmlAttributes)
{
    bool allowMultiple = htmlAttributes.ContainsKey("multiple");
    return SelectInternal(htmlHelper, optionLabel, expression, selectList, allowMultiple, htmlAttributes);
} 
```

它按预期工作。当然必须定义多个属性：@Html.DropDownGroupListFor(m => m.Selected, Model.Values, new { multiple = "multiple" })

感谢 Serge 的回答。

# html - 在 IE 中填充文本输入...可能吗？

> ID：607198
> 
> 赞同：22
> 
> 时间：2009-03-03T16:48:09.213
> 
> 标签：html, internet-explorer, padding, textinput

我有一个带有绝对搜索按钮的文本输入...为按钮腾出空间我使用了一些填充来防止文本进入按钮下方，这很好，它适用于Firefox，但不适用于IE。

事实上......在 IE 中，文本输入上的填充似乎根本不起作用。

他们有以下代码

```
 <style type="text/css">
#mainPageSearch input {
    width: 162px;
    padding: 2px 20px 2px 2px;
    margin: 0;
    font-size: 12px;
    -moz-border-radius: 5px;
    -webkit-border-radius: 5px;
    background:#F3F3F3 url(form-shadow.png) repeat-x scroll left top;
    border-color:#C6C6C6 #C6C6C6 #E3E3E3;
    border-style:solid;
    border-width:1px;
    color:#666666;
}
#mainPageSearch {
    margin-bottom: 10px;
    position: relative; /* Lets me absolute position the button */
}
#mainPageSearchButton {
    display: block;
    position: absolute;
    top:0px;
    right: -2px;
    text-indent: -2000em;
    height: 22px;
    width: 22px;
    background: transparent url('images/searchBtn.png') top center no-repeat;
}
</style>

<form id="mainPageSearch" action="">
    <input type="text"/>
    <a id="mainPageSearchButton" href="#">Search</a>
</form> 
```

我正在尝试做的事情是否可能，或者我应该把它吸起来并处理搜索按钮下的文本？

我知道我可以制作一个带有透明背景/边框的搜索框，并使用包含 div 来绘制样式……但这并不是一个真正的选择，因为我必须在网站上更改多少个地方。

也许我会为这个文本输入创建一个新类，使其透明并将正常的文本输入样式分配给包含的 div？你怎么看？

**编辑**：对不起，我应该包括文档类型......这里是：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> 
```

另外，我遇​​到的问题在 IE 7 中

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2009-12-15T23:12:34.613

尝试使用 line-height

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2011-03-18T22:26:39.857

我也遇到了这个问题，我通过添加以下行来解决它

```
input 
{
    overflow:visible;
    padding:5px;
} 
```

希望这可以帮助？让我知道。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-06-24T11:45:30.823

尝试`border-right`代替`padding-right`. 这对我有用。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-04-06T13:22:21.580

使您的输入透明并将样式放置在容器 div 中：

[http://jsfiddle.net/LRWWH/211/](http://jsfiddle.net/LRWWH/211/)

HTML

```
 <div class="input-container">
 <input type="text" class="input-transparent" name="fullname"> 
 </div> 
```

CSS

```
 .input-container {
    background:red;
    overflow:hidden;
    height: 26px;
    margin-top:3px;        
    padding:6px 10px 0px;
    width: 200px;
  }

 .input-transparent {
    background-color:transparent;
    border:none;
    overflow:hidden;        
    color:#FFFFF;
    width: 200px;
    outline:none;
  } 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-03-14T11:59:02.813

有一个仅适用于它的 css 修复程序

```
div.search input[type="text"] {
    width: 110px;
    margin: 0;
    background-position: 0px -7px;
    text-indent:0;
    padding:0 15px 0 15px;
}
/*ie9*/ div.search input[type="text"] {
    border-left: 25px solid transparent;
}
/*ie8*/ div.search input[type="text"] {
    border-left: 25px solid transparent;
    background-position-x: -16px;
    padding-left: 0px;
    line-height: 2.5em;
} 
```

感谢穆罕默德·阿提夫·楚格泰

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-03T16:56:17.230

在应用填充/边距之前，您必须在“#mainPageSearch 输入”上使用 float: left/right。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-07-28T22:39:42.990

我遇到了类似的问题 - IE 正在填充输入字段，但没有使其变大，从而将文本向下推入其中。我也通过设置输入的高度来修复它。试试看。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-03T16:57:55.977

我在 IE7 中有以下工作。你的目标是什么版本？

```
<style type="text/css">

    input#test {
        padding: 10px;
    }

</style>

<input type="text" id="test" /> 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-05-27T11:08:44.057

声明 DOCTYPE 怎么样？

`<!DOCTYPE html>`通过在 IE8 中添加填充对我来说非常有用。以下面的代码为例：

```
<!DOCTYPE html>
<html>
  <head>
    <style>
      #myInput {
        padding: 10px;
      }
    </style>
  </head>
  <body>
    <input id="myInput" value="Some text here!" />
  </body>
</html> 
```

# sql - SQL Base32 转换

> ID：607200
> 
> 赞同：0
> 
> 时间：2009-03-03T16:48:17.437
> 
> 标签：sql, syntax

我正在编写一个 SQL 函数，它将接受小数并返回该小数的 base32 表示。

我的问题是小数到 ascii 的转换。

我被允许运行以下查询并返回一个 ascii 字符

“SELECT CHAR(65)”返回“A”

但是，在我的函数中，当我尝试构建输出字母字符串时，我无法将 bigint 转换为 char，然后将该 char 连接到另一个 char 的末尾（这将是我的输出）。

示例代码行：“SET @OutputChar = @OutputChar + CAST((@Output + 55)AS CHAR(255))”

将 bigint 转换为 char 然后将该 char 连接到另一个的正确方法是什么？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-03T16:51:59.783

你如何声明@OutputChar？

如果你有：

```
DECLARE @OutputChar CHAR(255) 
```

那么每次连接时，它都会将其截断为 255。CHAR 末尾包含空格，也许您的意思是使用 varchar 而不是 CHAR？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T16:53:00.717

试试这个：

```
SET @OutputChar = @OutputChar + CONVERT(varchar(255),@Output + 55) 
```

# symbian - Symbian 和 OpenC 应用程序

> ID：607214
> 
> 赞同：2
> 
> 时间：2009-03-03T16:52:55.350
> 
> 标签：symbian, nokia

我一直在研究试图找到开始开发应用程序的最佳方法，该应用程序旨在根据传出的 SMS 消息分析用户的写作风格。我已经安装了 Symbian 的 SDK 和 Carbide，并购买了一本关于他们特定的 C++ 风格的书来开始使用。但是，我被告知要查看 Open C for Symbian，因为我以前有一些 C 经验。我已经从[http://www.forum.nokia.com/Resources_and_Information/Explore/Runtime_Platforms/Open_C_and_C++/](http://www.forum.nokia.com/Resources_and_Information/Explore/Runtime_Platforms/Open_C_and_C++/)安装了插件并测试了一个简单的 Hello, World！申请成功。

虽然最初的成功让我相信 Open C 对我来说是一个更好的选择，但我担心使用 Open C 的局限性。例如，我需要能够访问 Symbian OS 的本机功能来捕获击键，同时在短信作曲家中。我还需要能够在后台运行我的应用程序并让它在系统启动时加载，以免干扰用户的正常活动。

有人可以澄清 Open C 是否可以访问这些功能并满足我在开发这个特定应用程序方面的需求吗？此外，与标准 Symbian C++ 相比，使用 Oepn C 有哪些限制？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T17:09:07.650

我绝不是 Symbian 专家，但我们在这里使用了适用于 Symbian 的 Open C/C++ 插件。我的理解是该插件只是一个扩展——它为您提供标准库并让您处理熟悉的功能（在我们的例子中，我们正在寻找简单的 cstring.h 和 stdio.h 库）。

您仍然可以混合和匹配 Symbian 调用，并且可能必须处理一些痛苦的转换才能让您`char*`进入正确的“[描述符](http://en.wikipedia.org/wiki/Descriptor)”。但是，您应该只需要在您接触现有 Symbian 库的接口上执行这些操作（因为它们需要的是描述符，而不是`char*`s）。

在我们的代码中，我们在某些地方使用`remove`调用来删除文件并在同一个类中创建详细的 Symbian `RFs`abd`RFile`对象。

所以是的，虽然我们使用 C/C++ 库来做一些低级的东西和大量的字符串操作，但我们还使用了 Web 浏览器控件、键输入监控等等。

...是的，我们需要清理我们的代码。:-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-26T14:29:53.440

Open C 为 Symbian OS 程序提供了一组标准 C 库，即它是一个库。

这意味着您可以在同一个程序中自由调用 Open C 代码和 Symbian 本机代码，就像使用任何其他库一样，只要您尊重库所需的先决条件和假设。

这就是复杂性所在，因为标准的 Symbian API 通常需要描述符和有效的活动调度程序之类的东西，而 Open C 库则不需要。但只要你小心，你就可以做你想做的事。

# ruby-on-rails - 导轨菜单

> ID：607218
> 
> 赞同：0
> 
> 时间：2009-03-03T16:53:52.803
> 
> 标签：ruby-on-rails, navigation, routes

我想知道是否有一个好的插件可以在 Rails 中呈现导航链接。如果它可以直接从路由文件呈现控制器上所有可能的 GET 操作的链接，那就太好了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-04T00:13:23.607

我可以问你问题的目的吗？RESTful 控制器中只有四个获取操作（索引、显示、编辑和新建）。使用特殊的路由生成器即时生成列表的开销可能太多了。

您可以简单地创建一个部分，可以为您当前正在查看的任何控制器呈现这四个操作（想想 params[:controller]）。

至于所有可能的获取操作：所有可能的获取操作将包含数据库中每个项目的显示操作。也就是说，再次，最好在部分处理和使用link_to。

不过，很难给出完整的答案，因为您的情况似乎很独特。

我希望这会有所帮助。

-克里斯

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-04T02:38:44.350

虽然这不能回答具体问题，但您可以通过运行在命令行上查看所有 OWN 路由

```
rake routes 
```

这将为您提供网站上所有路线的个人读数，但就像克里斯上面所说的那样，这并不是一个具体的答案，更多的是仅供参考。

干杯!

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-08-18T16:57:28.947

你应该试试 mmmenu： http: [//github.com/snitko/mmmenu](http://github.com/snitko/mmmenu) 它非常灵活。

# vb.net - C# readonly 关键字的 VB.NET 等效项是什么？

> ID：607221
> 
> 赞同：6
> 
> 时间：2009-03-03T16:54:45.313
> 
> 标签：vb.net

在 C# 中，您可以这样做以使您的成员变量不可变：

```
public readonly int y = 5; 
```

VB.NET 中等效的“只读”关键字是什么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-03T16:55:34.237

令人惊讶的是，它是[只读的](http://msdn.microsoft.com/en-us/library/z2b2c2ka.aspx?ppud=4)

# iphone - 如何解决iphone开发中遇到的EXC_BAD_ACCESS错误

> ID：607222
> 
> 赞同：15
> 
> 时间：2009-03-03T16:55:23.893
> 
> 标签：iphone, objective-c, cocoa-touch, file-access

我正在尝试做一件简单的事情；从互联网上读取图像，将其保存到 iphone 上应用程序的文档目录中，然后从该文件中读取它，以便我以后可以用它做其他事情。编写文件工作正常，但是当我尝试读回它时，我在 GDB 中得到一个 EXC_BAD_ACCESS 错误，我不知道如何解决。这是我的代码基本上的样子：

```
-(UIImage *) downloadImageToFile {
NSURL * url = [[NSURL alloc] initWithString: self.urlField.text];

NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);

NSString *documentsDirectory = [paths objectAtIndex:0];

[paths release]
NSString * path = [documentsDirectory stringByAppendingString:@"/testimg.png"];

NSData * data = [[NSData alloc] initWithContentsOfURL:url];

[data writeToFile:path atomically:YES];

return [[UIImage alloc] initWithContentsOfFile:path];
} 
```

当我尝试从文件初始化 UIImage 时，代码在 return 语句中失败。有任何想法吗？

**编辑**：忽略添加最初是代码中问题的版本。

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2011-01-02T23:42:11.640

***注意：**这特别适用于**非 ARC**内存管理。*

由于这有很多观点，并且检查过的答案适当地指出“代码显示严重缺乏关于内存管理在 Objective-C 中如何工作的知识”，但没有人指出具体错误，我想我会添加一个触及他们的答案。

关于调用方法，我们必须记住的基线级别规则：

*   如果方法调用包含单词**alloc**、**new**、**copy**或**retain**，我们就拥有所创建对象的所有权。¹如果我们拥有一个对象的所有权，我们有责任释放它。

*   如果方法调用*不*包含这些词，我们就没有创建对象的所有权。¹如果我们*没有*对象的所有权，释放它*不是*我们的责任，因此我们永远不应该这样做。

让我们看一下 OP 代码的每一行：

```
-(UIImage *) downloadImageToFile { 
```

我们开始了一种新方法。在这样做的过程中，我们开始了一个新的上下文，每个创建的对象都生活在这个上下文中。请记住这一点。下一行：

```
 NSURL * url = [[NSURL alloc] initWithString: self.urlField.text]; 
```

我们拥有`url`：那里的单词**alloc**告诉我们我们拥有该对象的所有权，并且我们需要自己释放它。如果我们不这样做，那么代码将泄漏内存。

```
 NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES); 
```

我们不拥有`paths`：没有使用四个神奇的词，所以我们没有所有权，绝对不能自己释放。

```
 NSString *documentsDirectory = [paths objectAtIndex:0]; 
```

我们不拥有`documentsDirectory`：没有魔法=没有所有权。

```
 [paths release] 
```

回顾几行，我们看到我们不拥有**路径**，因此当我们尝试访问不再存在的内容时，此版本将导致 EXC_BAD_ACCESS 崩溃。

```
 NSString * path = [documentsDirectory stringByAppendingString:@"/testimg.png"]; 
```

我们不拥有`path`：没有魔法=没有所有权。

```
 NSData * data = [[NSData alloc] initWithContentsOfURL:url]; 
```

我们拥有：那里的**alloc**`data`一词告诉 use 我们拥有该对象的所有权，并且我们需要自己释放它。如果我们不这样做，那么代码将泄漏内存。

 **以下两行不创建或释放任何内容。然后是最后一行：

```
} 
```

该方法结束，因此变量的上下文已经结束。查看代码，我们可以看到我们拥有`url`和`data`，但没有发布它们中的任何一个。因此，每次调用此方法时，我们的代码都会泄漏内存。

这个`NSURL`物体`url`不是很大，所以我们可能永远不会注意到泄漏，虽然它仍然应该被清理，但没有理由泄漏它。

`NSData`对象`data`是 png 图像，并且可能非常大；每次调用此方法时，我们都会泄漏对象的整个大小。想象一下，每次绘制表格单元格时都会调用它：不会花费很长时间使整个应用程序崩溃。

那么我们需要做些什么来解决这些问题呢？这很简单，我们只需要在不再需要对象时立即释放它们，通常是在最后一次使用它们之后：

```
-(UIImage *) downloadImageToFile {

    // We own this object due to the alloc
    NSURL * url = [[NSURL alloc] initWithString: self.urlField.text];

    // We don't own this object
    NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);

    // We don't own this object
    NSString *documentsDirectory = [paths objectAtIndex:0];

    //[paths release] -- commented out, we don't own paths so can't release it

    // We don't own this object
    NSString * path = [documentsDirectory stringByAppendingString:@"/testimg.png"];

    // We own this object due to the alloc
    NSData * data = [[NSData alloc] initWithContentsOfURL:url];

    [url release]; //We're done with the url object so we can release it

    [data writeToFile:path atomically:YES];

    [data release]; //We're done with the data object so we can release it

    return [[UIImage alloc] initWithContentsOfFile:path];

    //We've released everything we owned so it's safe to leave the context
} 
```

有些人喜欢在方法结束时上下文关闭之前立即释放所有内容。在这种情况下，两者`[url release];`都会`[data release];`出现在右`}`大括号之前。我发现如果我尽快发布它们，代码会更清晰，当我稍后仔细检查它时，我会清楚地知道我在哪里完成了对象。

总结一下：我们拥有使用`alloc`、`new`、`copy`或`retain`在方法调用中创建的对象，因此必须在上下文结束之前释放它们。我们不拥有任何其他东西，也绝不能释放它们。

* * *

¹这四个词实际上并没有什么神奇之处，它们只是苹果公司创建相关方法的人们一贯使用的提醒。如果我们为自己的类创建自己的初始化或复制方法，那么在其适当的方法中包含单词 alloc、new、copy 或 retain 是我们的责任，如果我们不在名称中使用它们，那么我们'将需要自己记住所有权是否已经过去。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-05T20:43:03.627

对我有很大帮助的一件事是在 objc_exception_throw 上设置一个断点。每当我即将抛出异常时，我都会点击这个断点，然后我可以调试堆栈链。我只是在我的 iPhone 项目中一直启用这个断点。

为此，在 xcode 中，转到左窗格“组和文件”底部附近并找到“断点”。打开它并单击 Project Breakpoints，然后在详细信息窗格（顶部）中，您将看到一个标有“双击符号”的蓝色字段。双击它并输入“objc_exception_throw”。

下次您抛出异常时，您将停止并在调试器中，您可以返回堆栈链到导致异常的代码。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-03T17:50:26.617

您的代码显示严重缺乏关于内存管理如何在 Objective-C 中工作的知识。除了您收到的 EXC_BAD_ACCESS 错误之外，不正确的内存管理也会导致内存泄漏，这在 iPhone 这样的小型设备上会导致随机崩溃。

我建议你仔细阅读：

[Cocoa 内存管理编程指南简介](http://developer.apple.com/documentation/Cocoa/Conceptual/MemoryMgmt/index.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-03T17:52:54.393

一定要快速回顾一下内存管理规则。没有什么会导致您遇到错误，但是您正在泄漏所有分配的对象。如果您不了解保留/释放模式，则很可能在您的代码中的另一个地方您没有正确保留对象，这就是导致 EXC_BAD_ACCESS 错误的原因。

另请注意 NSString 具有处理文件系统路径的方法，您不必自己担心分隔符。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-01-02T22:13:57.523

但总的来说，如果您的代码中出现 EXC_BAD_ACCESSs 并且您终生无法弄清楚原因，请尝试使用 NSZombie（不，我不是在开玩笑）。

在 Xcode 中，展开左侧的 Executables 部分。双击与您的项目同名的列表（它应该是唯一的）。在弹出的窗口中，转到参数，然后在底部单击加号按钮。名称应为*NSZombieEnabled*，值应设置为*YES*

这样，当您尝试访问已发布的对象时，您将更好地了解您正在做的事情。找出错误后，只需将值设置为*NO即可。*

希望这对某人有帮助！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-03T17:00:51.400

当您对内存管理不善时会发生这些错误（即对象被过早释放或类似情况）

尝试执行以下操作..

```
UIImage *myImage = [[UIImage alloc] initWithContentsOfFile:path];
return [myImage autorelease]; 
```

我花了很多时间进行实验，同时掌握了释放/自动释放的概念。有时也需要播放保留关键字（尽管在这种情况下可能不需要）

另一种选择可能只是路径不存在，或者无法读取？

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-03-03T17:08:43.503

也许， initWithContentsOfFile 不接受路径参数？浏览 UIImage 的不同初始化方法，我认为有一个不同的方法可以接受路径。

您可能还需要做一些更有趣的事情来制作路径？我记得用“捆绑”做一些事情吗？不好意思说的太含糊了，暂时就记得这么多了。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2009-03-03T17:12:57.173

去掉路径上的斜线，并确保它在项目中。它是否在该目录中并不重要，但必须将其添加到项目中才能访问它。

# sql - 如何判断索引是否包含 varchar(max) 类型的列？

> ID：607226
> 
> 赞同：3
> 
> 时间：2009-03-03T16:56:19.850
> 
> 标签：sql, sql-server, tsql

我正在处理我的 MSSQL 索引碎片整理脚本。某些类型的索引可以在线重建，而其他类型的则不能。

对于聚集索引，很容易查看表是否包含任何 LOB 列，但对于非聚集索引，我需要特别知道该特定索引是否包含任何 LOB 列。

我以前可以通过查看 dm_db_index_physical_stats 中的 alloc_unit_type_desc 来做到这一点，但这不适用于 varchar(max) 和 xml 类型的列。

这不适用于我的数据库，所以我不想讨论索引是否合适，让我们接受它存在并且我希望脚本能够处理这种情况。

有谁知道我可以写什么样的 SQL 来检查这个？假设我在标量变量中有所有相关的对象 ID 和对象名称。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T17:13:05.643

如果您有一个具有最大长度的 char 或 nvarchar，那么它将在 sys.columns 表中具有该字段的相应系统类型 ID 的条目，最大长度为 -1。

因此，如果要查找具有 varchar（系统类型 id 167）的所有索引的所有 id，您可以这样做：

```
select distinct
    si.*
from
    sys.indexes as si
        inner join sys.index_columns as ic on
            ic.object_id = si.object_id and
            ic.index_id = si.index_id
            inner join sys.columns as sc on
                sc.object_id = ic.object_id and
                sc.column_id = ic.column_id
where
    sc.system_type_id = 167 and
    sc.max_length = -1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T17:08:54.640

我认为对于“最大”列，sys.columns 表中的长度或大小字段应该是-1。我面前没有文档，但如果可行，请告诉我。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-01-16T05:17:16.817

小心，伙计们。就 LOB 而言，聚簇索引是另一种动物。让我们做一个测试，看看我的意思。

首先，让我们设置一个测试表。此测试不需要数据，但我们确实有一个聚集索引 (IndexID=1) 作为 PK。我们还有一个非聚集索引 (IndexID=2)，它不包含作为 INCLUDE 的 LOB 列，我们还有一个包含作为 INCLUDE 的 LOB 列的非聚集索引。这是测试设置代码...

```
--========================================================================
--      Test Setup
--========================================================================
--===== If the test table already exists, 
     -- drop it to make reruns in SSMS easier.
     IF OBJECT_ID('dbo.IndexTest','U') IS NOT NULL
        DROP TABLE dbo.IndexTest
;
GO
--===== Create the test table
 CREATE TABLE dbo.IndexTest
        (
         SomeID     INT IDENTITY(1,1)
        ,SomeInt    INT
        ,SomeLOB1   VARCHAR(MAX)
        ,CONSTRAINT PK_IndexTest_Has_LOB
         PRIMARY KEY CLUSTERED (SomeID)
        )
;
--===== Add an index that has no INCLUDE of a LOB
 CREATE INDEX IX_Has_No_LOB 
     ON dbo.IndexTest (SomeInt)
;
--===== Add an index that has INCLUDEs a LOB
 CREATE INDEX IX_Includes_A_LOB 
     ON dbo.IndexTest (SomeInt) INCLUDE (SomeLOB1)
; 
```

现在，让我们尝试使用 sys.index_columns 查找包含 LOB 的索引的代码。我已经在 WHERE 子句中注释掉了 system_type_id 以将其打开一点......

```
--========================================================================
--      Test for LOBs using sys.index_columns.
--========================================================================
select distinct
    si.*
from
    sys.indexes as si
        inner join sys.index_columns as ic on
            ic.object_id = si.object_id and
            ic.index_id = si.index_id
            inner join sys.columns as sc on
                sc.object_id = ic.object_id and
                sc.column_id = ic.column_id
where
    --sc.system_type_id = 167 and
    sc.max_length = -1
; 
```

这是上面运行的输出......

```
object_id   name              index_id    type type_desc    ...
----------- ----------------- ----------- ---- ------------ ...
163204448   IX_Includes_A_LOB 3           2    NONCLUSTERED ... 
```

它无法判断聚集索引包含 LOB，因为 LOB 不是索引列之一。尝试重建此聚集索引将导致失败。

```
 ALTER INDEX PK_IndexTest_Has_LOB 
     ON dbo.IndexTest REBUILD WITH (ONLINE = ON)
; 
```

> 消息 2725，级别 16，状态 2，第 1 行无法对索引“PK_IndexTest_Has_LOB”执行联机索引操作，因为该索引包含数据类型为 text、ntext、image、varchar(max)、nvarchar(max)、varbinary 的列“SomeLOB1” （最大）或 xml。对于非聚集索引，该列可以是索引的包含列，对于聚集索引，它可以是表的任何列。在 drop_existing 的情况下，该列可能是新索引或旧索引的一部分。该操作必须离线执行。

向 Remus Rusanu 致敬（系统不允许我发布链接）...

...我们可以尝试一些不同的东西。每个索引（集群、非集群或 HEAP）都显示为一个分配单元，并且还将标识行内数据、行外数据和 LOB。下面的代码查找与它们关联的 LOB 的所有索引......甚至是聚集索引。

```
--===== Find all indexes that contain any type of LOB
 SELECT  SchemaName = OBJECT_SCHEMA_NAME(p.object_id)
        ,ObjectName = OBJECT_NAME(p.object_id)
        ,IndexName  = si.name
        ,p.object_id
        ,p.index_id
        ,au.type_desc
   FROM sys.system_internals_allocation_units au --Has allocation type
   JOIN sys.system_internals_partitions p        --Has an Index_ID
     ON au.container_id = p.partition_id
   JOIN sys.indexes si                           --For the name of the index
     ON si.object_id    = p.object_id
    AND si.index_id     = p.index_id
  WHERE p.object_id     = OBJECT_ID('IndexTest')
    AND au.type_desc    = 'LOB_DATA'
; 
```

这会为此特定测试产生以下输出。请注意，它确实通过 object_id 和 index_id 拾取了聚集索引，而基于 sys.index_columns 的代码没有。

```
SchemaName ObjectName IndexName            object_id index_id type_desc
---------- ---------- -------------------- --------- -------- ---------
dbo        IndexTest  PK_IndexTest_Has_LOB 163204448 1        LOB_DATA
dbo        IndexTest  IX_Includes_A_LOB    163204448 3        LOB_DATA 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-07-17T06:38:32.687

您还可以检查 DMV - `sys.dm_db_index_physical_stats`。

它有一`alloc_unit_type_desc`列可以告诉我们索引是否有**LOB_DATA**。

```
SELECT S.name as 'Schema',
T.name as 'Table',
I.name as 'Index',
DDIPS.avg_fragmentation_in_percent,
DDIPS.page_count,
DDIPS.alloc_unit_type_desc
FROM sys.dm_db_index_physical_stats (DB_ID(), NULL, NULL, NULL, 'LIMITED') AS DDIPS
INNER JOIN sys.tables T on T.object_id = DDIPS.object_id
INNER JOIN sys.schemas S on T.schema_id = S.schema_id
INNER JOIN sys.indexes I ON I.object_id = DDIPS.object_id
AND DDIPS.index_id = I.index_id
WHERE DDIPS.database_id = DB_ID()
and I.name is not null
and DDIPS.alloc_unit_type_desc = 'LOB_DATA' 
```

# oracle - 使用有效日期记录

> ID：607227
> 
> 赞同：0
> 
> 时间：2009-03-03T16:56:20.130
> 
> 标签：oracle, peoplesoft

如何获取员工，例如有效日期记录中的 5 个最新 Action_reason 行，没有未来行，应仅选择当前行和历史行（生效日期 <= sysdate）。我可以在单行中获取这些，还是对于员工来说是 5 行？

```
select emplid, effdt, action_reasons
-- we have to build a logic here.
-- Should we initialize 5 ACT variables to fetch rows into it?
-- Please help
from JOB
where emplid = '12345'
  and effdt <= sysdate. 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-03T17:03:57.273

```
SELECT  LTRIM(SYS_CONNECT_BY_PATH(emplid || ', ' || effdt || ', ' || action_reasons, ', '), ', ')
FROM    (
        SELECT 
        FROM (
             SELECT emplid, effdt, action_reasons, ROW_NUMBER() OVER (ORDER BY effdt) AS rn
             FROM   JOB
             WHERE  emplid= '12345'
              AND  effdt <= SYSDATE
             )
        WHERE rn <= 5
        )
WHERE   CONNECT_BY_ISLEAF = 1
START WITH  
    rn = 1
CONNECT BY
    rn = PRIOR rn + 1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T18:04:18.143

```
SELECT JOBXX.EMPLID,JOBXX.EFFDT,JOBXX.ACT1,JOBXX.ACT2,JOBXX.ACT3,JOBXX.ACT4,JOBXX.ACT5
FROM
  (SELECT SD.EMPLID,
          SD.EFFDT,
          CHR(SUBSTR(TO_CHAR(SUM(CASE WHEN SD.R3 = 1 THEN SD.A1 ELSE 0 END)),1,2)) ||
          CHR(SUBSTR(TO_CHAR(SUM(CASE WHEN SD.R3 = 1 THEN SD.A1 ELSE 0 END)),3,2)) ||
          CHR(SUBSTR(TO_CHAR(SUM(CASE WHEN SD.R3 = 1 THEN SD.A1 ELSE 0 END)),5,2))
          AS ACT1,
          CHR(SUBSTR(TO_CHAR(SUM(CASE WHEN SD.R3 = 2 THEN SD.A1 ELSE 0 END)),1,2)) ||
          CHR(SUBSTR(TO_CHAR(SUM(CASE WHEN SD.R3 = 2 THEN SD.A1 ELSE 0 END)),3,2)) ||
          CHR(SUBSTR(TO_CHAR(SUM(CASE WHEN SD.R3 = 2 THEN SD.A1 ELSE 0 END)),5,2))
          AS ACT2,
          CHR(SUBSTR(TO_CHAR(SUM(CASE WHEN SD.R3 = 3 THEN SD.A1 ELSE 0 END)),1,2)) ||
          CHR(SUBSTR(TO_CHAR(SUM(CASE WHEN SD.R3 = 3 THEN SD.A1 ELSE 0 END)),3,2)) ||
          CHR(SUBSTR(TO_CHAR(SUM(CASE WHEN SD.R3 = 3 THEN SD.A1 ELSE 0 END)),5,2))
          AS ACT3,
          CHR(SUBSTR(TO_CHAR(SUM(CASE WHEN SD.R3 = 4 THEN SD.A1 ELSE 0 END)),1,2)) ||
          CHR(SUBSTR(TO_CHAR(SUM(CASE WHEN SD.R3 = 4 THEN SD.A1 ELSE 0 END)),3,2)) ||
          CHR(SUBSTR(TO_CHAR(SUM(CASE WHEN SD.R3 = 4 THEN SD.A1 ELSE 0 END)),5,2))
          AS ACT4,
          CHR(SUBSTR(TO_CHAR(SUM(CASE WHEN SD.R3 = 5 THEN SD.A1 ELSE 0 END)),1,2)) ||
          CHR(SUBSTR(TO_CHAR(SUM(CASE WHEN SD.R3 = 5 THEN SD.A1 ELSE 0 END)),3,2)) ||
          CHR(SUBSTR(TO_CHAR(SUM(CASE WHEN SD.R3 = 5 THEN SD.A1 ELSE 0 END)),5,2))
          AS ACT5
  FROM (
         SELECT EMPLID,EFFDT,ACTION_REASON,
                SUBSTR(ACTION_REASON,1,1),
                SUBSTR(ACTION_REASON,2,1),
                SUBSTR(ACTION_REASON,3,1),
                TO_NUMBER(ASCII(SUBSTR(ACTION_REASON,1,1)) ||
                ASCII(SUBSTR(ACTION_REASON,2,1)) ||
                ASCII(SUBSTR(ACTION_REASON,3,1))) AS A1,
                ROW_NUMBER() over(PARTITION BY EMPLID,EFFDT ORDER BY EFFDT desc,EFFSEQ desC) R3
        FROM PS_JOB
        WHERE action in ('ABC','XYZ')
        and action_reason in ('123','456','789')
        and emplid IN('12345','ABCDE')
        AND effdt  between '01-jan-2008' and '18-dec-2008'
        ORDER BY EFFDT DESC, EFFSEQ DESC
    ) SD                        
  GROUP BY EMPLID , EFFDT              
) JOBXX 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-05T16:30:19.927

您可以以任何您希望的方式获取数据。如果你想要它作为五行，那么你可以使用这个：

```
select * from (
             select emplid, empl_rcd, effdt, action_reason
                  , rank() over (partition by emplid, empl_rcd 
                                 order by effdt desc, effseq desc) rank1
               from ps_job
              where emplid = '12345'
                and effdt <= sysdate)
 where rank1 <= 5 
```

如果您希望将数据全部放在一行上，请使用 Oracle 的 LAG 分析功能，因此：

```
select * from ( 
    select emplid, empl_rcd, effdt
         , lag(effdt) over(partition by emplid, empl_rcd order by effdt, effseq) effdt_lag1
         , lag(effdt, 2) over(partition by emplid, empl_rcd order by effdt, effseq) effdt_lag2
         , lag(effdt, 3) over(partition by emplid, empl_rcd order by effdt, effseq) effdt_lag3
         , lag(effdt, 4) over(partition by emplid, empl_rcd order by effdt, effseq) effdt_lag4
         , action_reason
         , lag(action_reason) over(partition by emplid, empl_rcd order by effdt, effseq) action_reason_lag1
         , lag(action_reason, 2) over(partition by emplid, empl_rcd order by effdt, effseq) action_reason_lag2
         , lag(action_reason, 3) over(partition by emplid, empl_rcd order by effdt, effseq) action_reason_lag3
         , lag(action_reason, 4) over(partition by emplid, empl_rcd order by effdt, effseq) action_reason_lag4
      from ps_job
     where emplid = '12345') j
 where effdt = (
            select max(j1.effdt) from ps_job j1
             where j1.emplid = j.emplid
               and j1.empl_rcd = j.empl_rcd
               and j1.effdt <= sysdate) 
```

这给出了最后 5 个 effdt 值和最后 5 个动作原因值。如果您不需要以上两个 SQL 可以相应地修剪。

# architecture - Resources for designing .dll structure

> ID：607230
> 
> 赞同：0
> 
> 时间：2009-03-03T16:58:12.780
> 
> 标签：architecture, dll, assemblies

I just came out of a design meeting and had a question posed to me about where I got one of my ideas about how to structure some .dlls of a project we are building. To be honest I have no idea where this "idea" came from it just seemed like natural knowledge to me. However it would useful if I could back up these opinions with some documented analysis.

Does anyone know of any resources that explicity discuss different mechanisms for structuring assemblies/modules/source?

UPDATE:

Well the idea was nothing special. We were discussing an abstraction layer for some hardware so the "app" that consumes these services could be (sort of) platform independant. Previously we've had an interfaces .dll that declares the interfaces the app requires and an implementation .dll that implements them for the one platform we've had thus far. Now we have two platforms but they are very similar. To prevent the interfaces .dll from being polluted or some hideous scenario where the implementations reference one another I merely suggested we create another .dll that sits between the interfaces and specificplatform.dlls where common abstract implementations can live.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T17:31:45.257

If you have a chance, have a look at the book by Robert C. Martin:

[Agile Principles, Patterns, and Practices in C#](http://search.barnesandnoble.com/Agile-Principles-Patterns-and-Practices-in-C/Martin-Robert-Martin-Micah-Martin-Robert-Martin-Micah/e/9780131857254) (This is the new version specifically targeted to .Net)

There is a chapter dedicated to component design that (probably) answers your question.

In summary, and after reading that book, I always recommend separating components by these criteria:

*   **Assemblies are units or reuse**: If there are classes that have to be used together, they go in the same assembly.

*   **Assemblies are units of change**: If there are classes that do not have to change for the same reason, they probably should not be in the same assembly.

*   **Assemblies are units of deployment**: If there are classes that have to be physically deployed in the same place, they probably should go in the same assembly.

Of course these are just *heuristics* and not recipes. You eventually need to decide how much of each one of those three design heuristics you need based on the architectural goals of your application (specifically the architectural goals for deployment and evolution/modification).

# java - 使用 CruiseControl.net 将 java 应用程序部署到 Tomcat

> ID：607232
> 
> 赞同：0
> 
> 时间：2009-03-03T16:58:57.800
> 
> 标签：java, tomcat, cruisecontrol, war

我在当前用于 Microsoft Projects 的机器上安装了 CruiseControl.net。我需要将一个 java 项目添加到同一个构建服务器。生成的java war文件需要复制到Tomcat下的另一台服务器上。但是，由于文件访问被拒绝消息，当它尝试复制到该网络位置时，我遇到了很多问题，因为正在使用某些 jar 文件。

在尝试复制文件之前，我尝试远程停止 tomcat，但没有成功。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-03T18:07:09.400

有一些[Ant 任务](http://tomcat.apache.org/tomcat-5.5-doc/manager-howto.html)允许您使用 build.xml 管理 Tomcat。也许那些可以提供帮助。

# java - 如何获取泛型枚举的类型对象？例如：EnumSet.noneOf( )

> ID：607250
> 
> 赞同：0
> 
> 时间：2009-03-03T17:06:11.870
> 
> 标签：java, generics

我有一个在某个枚举上参数化的泛型类型，声明如下：

```
public class FlagsField<T extends Enum<T>> {

    private EnumSet<T> _flagSet;

    public FlagsField() {
        _flagSet = EnumSet.<T>noneOf( /* what goes here? */ );
    }

    ...
} 
```

我想像上面那样在构造函数中初始化 _flagsField ，但是我一生都无法弄清楚 noneOf 方法的正确参数是什么。它需要是 type `Class<T>`。如果这不是通用的，你会`MyFooEnumType.class`在这里使用，但`T.class`它是无效的。

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-03T17:12:45.863

您遇到了[类型擦除](http://java.sun.com/docs/books/tutorial/java/generics/erasure.html)。您的构造函数将需要如下所示：

```
public FlagsField(Class<T> enumClass) {
    _flagSet = EnumSet.<T>noneOf(enumClass);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-08T14:54:42.317

您可以在构造函数中使用此技巧：（请参阅[通用数据访问对象](http://community.jboss.org/wiki/GenericDataAccessObjects)，“使用查找准备 DAO”部分）

```
enumClass = (Class<T>) ((ParameterizedType) getClass().getGenericSuperclass()).getActualTypeArguments()[0]; 
```

但我相信这段代码只有在类被子类化并且子类的实例执行它时才有效。

# c# - C# 中 3D 数学的好库？

> ID：607254
> 
> 赞同：15
> 
> 时间：2009-03-03T17:08:01.413
> 
> 标签：c#, math, 3d

我正在编写一个工具，它将用于处理一堆 3D 数据，执行诸如旋转对象、平移、缩放和所有这些好东西之类的事情。有谁知道一个很好的图书馆已经做了一些常见的 3D 东西？

我目前对可视化数据不感兴趣，主要对执行操作感兴趣。

我知道我现在需要的东西：

*   2D/3D/4D 向量
    *   （加法、减法、点积、叉积等...）
*   使用矩阵进行旋转/平移/缩放
*   四元数

我能够找到[Sharp3D](http://sharp3d.codeplex.com/)库，但它似乎可以做我想要的，但很长时间没有更新。以前有人用过这个吗？还有其他（更好的）建议吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-03T17:14:06.343

[Microsoft.Xna.Framework](http://msdn.microsoft.com/en-us/library/microsoft.xna.framework.aspx)（发布这个 XNA）可以完成这项工作。

> XNA 框架数学库有多种基本几何类型，可用于在 2D 或 3D 空间中操作对象。该库中的原始对象表示表示几何对象或对该对象的操作所需的数据。每种几何类型都有许多该类型支持的数学运算。
> 
> **向量**
> 
> XNA 框架提供了 Vector2、Vector3 和 Vector4 类来表示和操作向量。矢量通常用于表示方向和大小。但是，在 XNA 框架中，它也可能用于存储坐标或其他具有相同存储要求的数据类型。
> 
> 每个向量类都有执行标准向量操作的方法，例如：
> 
> *   点积
> *   交叉产品
> *   正常化
> *   转型
> *   线性、三次、Catmull-Rom 或 Hermite 样条插值。
> 
> **矩阵**
> 
> XNA 框架为几何变换提供了 Matrix 类。Matrix 类使用行主顺序来寻址矩阵，这意味着在描述二维矩阵的元素时，行在列之前指定。Matrix 类提供了用于执行标准矩阵运算的方法，例如计算矩阵的确定矩阵或逆矩阵，此外还提供了用于创建缩放、平移和旋转矩阵的辅助方法。
> 
> **四元数**
> 
> XNA 框架提供四元数结构来表示和计算围绕指定角度的向量的有效旋转。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-01-30T23:14:03.680

我以前从未使用过它，但我只是抓住了 Sharp3D，它似乎运行良好（除了一些关于强名称的问题需要几分钟才能解决）。我的印象是它的重量并不完全轻，但远非沉重。

至于最近没有更新，它不像数学正在改变或任何东西......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-20T06:10:45.017

[在www.obacs.com](http://www.obacs.com)上试用 Scinet Linea 。它不是一个免费的图书馆，但与替代品相比，它不是很贵 ww

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-27T11:08:43.553

www.obacs.com 不再提供 Scinet Linea。它现在包含在具有更多功能的 Scinet Math 中。一个月前，我为我的研究购买了一份副本。我喜欢它，到目前为止。

# sqlite - 如何让sqlite查询更高效？

> ID：607258
> 
> 赞同：2
> 
> 时间：2009-03-03T17:08:18.963
> 
> 标签：sqlite

我正在构建的程序中有以下 sql 语句，其中 id_list 有时是一个非常大的列表。

```
for id in id_list:
    self.cursor.execute("""update songs set rating='L' where trackid=?""", (id,))
self.db.commit() 
```

有没有更有效的方法来做到这一点，不涉及这么多更新查询？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T17:09:23.173

SQL：

```
update songs set rating='L' where trackid IN (id_list) 
```

代码：

```
self.cursor.execute("update songs set rating='L' where trackid IN (%s)"%','.join(['?']*len(id_list)), id_list)
self.db.commit() 
```

还有更优雅但次优的解决方案：

```
self.cursor.executemany("update songs set rating='L' where trackid=?", id_list)
self.db.commit() 
```

# c++ - 使用静态变量和模板

> ID：607259
> 
> 赞同：18
> 
> 时间：2009-03-03T17:08:19.430
> 
> 标签：c++, templates, static, visual-c++-6

我在这样的头文件中定义了一个模板类。这里我也定义了一个静态变量：

```
#ifndef TEST1_H_
#define TEST1_H_

void f1();

static int count;

template <class T>
class MyClass
{
public:

    void f()
    {
        ++count;
    }

};

#endif 
```

我在不同的 cpp 文件中定义了 main() 函数，如下所示：

```
int main(int argc, char* argv[])
{
    MyClass<int> a;
    a.f();
    f1();

    cout<<"Main:" << count << "\n";

    return 0;
} 
```

我在不同的 cpp 文件中实现了函数 f1()，如下所示：

```
void f1()
{
    MyClass<int> a;
    a.f();

    cout<<"F1: " <<count <<"\n";
} 
```

当我使用 VC6 编译它时，我得到的输出是“F1:0 Main:2”。这怎么可能？另外，一般来说，如果我想将静态变量与模板一起使用，我应该如何处理？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-03-03T17:28:10.553

因为您在头文件中声明了一个静态变量，所以您将获得同一个变量的两个副本。当你以`static`这种方式声明一个全局变量时，你说它是编译单元（`.o`文件）的本地变量。由于您将标头包含在两个编译单元中，因此您将获得两个`count`.

我认为您在这里真正想要的是与模板类的每个*实例相关联的静态模板成员变量。*它看起来像这样：

```
template <class T>
class MyClass
{
    // static member declaration
    static int count;
    ...
};

// static member definition
template<class T> int MyClass<T>::count = 0; 
```

这将为您的模板的每个实例化计数。也就是说，您将拥有 , , 等的计数`MyClass<int>`现在`MyClass<foo>`看起来`MyClass<bar>`像 `f1()`这样：

```
void f1() {
    MyClass<int> a;
    a.f();

    cout<<"F1: " << MyClass<int>::count <<"\n";
} 
```

* * *

如果您想计算 MyClass 的**所有**实例化（不管它们的模板参数），您确实需要使用**全局变量**。

但是，您可能不希望直接使用全局变量，因为您冒着在初始化之前使用它的风险。您可以通过创建一个返回对您的计数的引用的全局静态方法来解决此问题：

```
int& my_count() {
    static int count = 0;
    return count;
} 
```

然后像这样从您的班级中访问它：

```
void f() {
    ++my_count();
} 
```

这将确保 count 在使用之前被初始化，无论您从哪个编译单元访问它。有关更多详细信息，请参阅[有关静态初始化顺序的 C++ 常见问题解答](http://www.parashift.com/c++-faq-lite/ctors.html#faq-10.12)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-03T17:11:27.677

将静态声明放在头文件中将导致每个 .cpp 文件获得自己的变量版本。所以这两个 cout 语句正在打印不同的变量。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-04T07:07:30.380

你期待“F1:1 Main:1”吗？您`MyClass<int>`在两个单独的翻译单元（即两个目标文件）中进行了实例化，并且链接器发现存在重复的模板实例化，因此它丢弃了在`f1`目标文件中的实例化。

您是传递[`/OPT:ICF`还是`/OPT:REF`](http://msdn.microsoft.com/en-us/library/aa278533(VS.60).aspx)传递给 VC6 链接器？这可能与重复模板实例化删除有关（或不相关；与普通重复函数相比，重复模板实例化可能是一种特殊情况）。GCC 似乎在某些平台上做[了类似的事情。](http://gcc.gnu.org/onlinedocs/gcc/Template-Instantiation.html)

无论如何，我不会依赖这种行为在编译器之间保持一致。此外，在链接器命令行上更改目标文件的顺序可能会影响丢弃哪个实例化。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-12-18T15:58:57.373

还有另一种解决方案，你可以创建一个共享父类并将这个静态变量放入其中，然后让你的模板类私有继承它，这是一个例子：

```
class Parent
{
protected: 
    static long count;
};

long Parent::count = 0;

template<typename T>
class TemplateClass: private Parent
{
private: 
    int mKey;
public:
    TemplateClass():mKey(count++){}
    long getKey(){return mKey;}
}

int main()
{
    TemplateClass<int> obj1;
    TemplateClass<double> obj2;

    std::cout<<"Object 1 key is: "<<obj1.getKey()<<std::endl;
    std::cout<<"Object 2 key is: "<<obj2.getKey()<<std::endl;

    return 0;
} 
```

输出将是：

```
Object 1 key is: 0 
Object 2 key is: 1 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2015-11-16T10:26:46.770

我认为这实际上是*未定义的行为*。

根据 C++14 [basic.def.odr]/6：

> 如果每个定义出现在不同的翻译单元中，并且定义满足以下要求，则程序中可以有多个定义类模板 [...] 的 [...] 成员函数。给定这样一个`D`在多个翻译单元中定义的实体，那么
> 
> *   D 的每个定义都应由相同的记号序列组成；和
> *   在 D 的每个定义中，根据 3.4 查找的相应名称应指在 D 的定义中定义的实体，或应指同一实体，经过重载解析（13.3）和部分模板特化匹配（14.8） .3)，除了如果对象在 D 的所有定义中具有相同的文字类型，并且该对象使用常量表达式 (5.19) 初始化，则名称可以引用具有内部链接或没有链接的非易失性 const 对象，并且该对象不是 ODR 使用的，并且该对象在 D 的所有定义中具有相同的值；[...]

问题是在第一个`.cpp`文件中，其中的名称与第二个文件中的名称`count`所指`f1`的对象不同，因此违反了相应名称应指代同一实体的条件。`count``f1``.cpp`

它们是不同的对象，因为说明`static`符表示每个翻译单元都有自己的具有该名称的对象。

# nhibernate - Nhibernate：使与地图的多对多关系成为一对一

> ID：607260
> 
> 赞同：2
> 
> 时间：2009-03-03T17:08:28.917
> 
> 标签：nhibernate, fluent-nhibernate, nhibernate-mapping

我有两个项目 A 和 B，它们具有单向的一对一关系。（A 有一个 B）

在数据库中，它们由 ATable 和 BTable 表示，它们由 ABTable 链接在一起。（从数据库设置来看，似乎存在多对多关系，但实际上并没有，这样做是出于规范化的原因）。

问题是由于这种设置，我只能让 NHibernate 将其映射为实体之间的多对多关系。无论如何使实体具有一对一的关系？

*我能想到的最好的方法是让它具有多对多关系，然后在 A 实体上有两个属性，一个返回 B 的列表，这将满足映射和第二个非映射属性，它将获得列表中的第一个 B，以满足我的应用程序。*- 但这似乎不优雅。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T21:02:31.303

你确定你的意思是一对一？[当他们真正](http://blog.jagregory.com/2009/01/27/i-think-you-mean-a-many-to-one-sir/)的意思是多对一时，我有很多人要求一对一。

无论如何，除了更改您的架构之外，最简单的事情就是您的建议；但是，为了使其更简洁，您可以将集合设为私有，这样您只公开获取第一项的两个属性。您可以在[wiki](http://wiki.fluentnhibernate.org)上查看Fluent NHibernate 中用于映射私有属性的[各种方法](http://wiki.fluentnhibernate.org/show/StandardMappingPrivateProperties)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T17:21:38.480

您可以尝试以各种方式组合`join-table`with`one-to-one`映射。映射`join-table`允许单个类在具有一对一关系的多个表中持久化。

# php - 如何计算 MySQL 查询返回的行数？

> ID：607264
> 
> 赞同：44
> 
> 时间：2009-03-03T17:08:51.693
> 
> 标签：php, mysql

如何计算 MySQL 查询返回的行数？

* * *

## 回答 #1

> 赞同：91
> 
> 时间：2009-03-03T17:13:49.573

## 获取查询结果中的总行数...

你可以迭代结果并计算它们。你没有说你正在使用什么语言或客户端库，但 API 确实提供了一个[mysql_num_rows](http://dev.mysql.com/doc/refman/5.0/en/mysql-num-rows.html)函数，它可以告诉你结果中的行数。

这在 PHP 中公开，例如，作为[mysqli_num_rows](http://php.net/manual/en/mysqli-result.num-rows.php)函数。当您编辑问题以提及您正在使用 PHP 时，这是一个使用 mysqli 函数的简单示例：

```
$link = mysqli_connect("localhost", "user", "password", "database");

$result = mysqli_query($link, "SELECT * FROM table1");
$num_rows = mysqli_num_rows($result);

echo "$num_rows Rows\n"; 
```

## 获取符合某些条件的行数...

只需使用 COUNT(*) - 请参阅MySQL 手册中的[Counting Rows](http://dev.mysql.com/doc/refman/5.0/en/counting-rows.html)。例如：

```
SELECT COUNT(*) FROM foo WHERE bar= 'value'; 
```

## 使用 LIMIT 时获取总行数...

如果您使用了 LIMIT 子句但想知道没有它会得到多少行，请在查询中使用[SQL_CALC_FOUND_ROWS](http://dev.mysql.com/doc/refman/5.0/en/select.html#id959825)，然后是 SELECT [FOUND_ROWS();](http://dev.mysql.com/doc/refman/5.0/en/information-functions.html#function_found-rows)

```
SELECT SQL_CALC_FOUND_ROWS * FROM foo
   WHERE bar="value" 
   LIMIT 10;

SELECT FOUND_ROWS(); 
```

对于非常大的表，这不会特别有效，您最好先运行一个更简单的查询来获取计数并缓存它，然后再运行查询以获取数据页。

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2015-09-04T14:50:44.130

如果您必须使用简单的 SQL 来解决问题，您可以使用内联视图。

```
select count(*) from (select * from foo) as x; 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-03T17:16:45.840

如果您的 SQL 查询有一个`LIMIT`子句，并且您想知道该数据集中总共有多少个结果，您可以使用`SQL_CALC_FOUND_ROWS`后跟`SELECT FOUND_ROWS();`这返回的行数比使用`COUNT(*)`
示例（直接来自 MySQL 文档）更有效地返回：

```
mysql> SELECT SQL_CALC_FOUND_ROWS * FROM tbl_name
    -> WHERE id > 100 LIMIT 10;
mysql> SELECT FOUND_ROWS(); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-03T17:16:17.790

```
SELECT SQL_CALC_FOUND_ROWS *
FROM   table1
WHERE  ...;

SELECT FOUND_ROWS(); 
```

`FOUND_ROWS()`必须在查询后立即调用。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-03T17:15:39.740

如果您想要结果加上返回的行数，请执行以下操作。使用 PHP。

```
$query = "SELECT * FROM Employee";
$result = mysql_query($query);
echo "There are ".mysql_num_rows($result)." Employee(s)."; 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-03T17:32:35.287

假设您正在使用 mysql_ 或 mysqli_ 函数，您的问题应该已经被其他人回答了。

但是，如果您使用的是 PDO，不幸的是，没有简单的函数可以返回 select 语句检索到的行数。您必须在结果集上使用 count() （通常在将其分配给局部变量之后）。

或者，如果您只对数字感兴趣，而不对数据感兴趣，请在 SELECT COUNT(1)... 结果中使用 PDOStatement::fetchColumn()。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2015-09-12T19:31:01.240

由于它是 2015 年，并且`mysql_*`功能已弃用，因此这是一个`PDO`仅可视化。

```
<?php
    // Begin Vault (this is in a vault, not actually hard-coded)
    $host="hostname";
    $username="GuySmiley";
    $password="thePassword";
    $dbname="dbname";
    // End Vault

    $b='</br>';
    try {
        $theCategory="fruit";   // value from user, hard-coded here to get one in

        $dbh = new PDO("mysql:host=$host;dbname=$dbname;charset=utf8", $username, $password);
        $dbh->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);

        // prepared statement with named placeholders
        $stmt = $dbh->prepare("select id,foodName from foods where category=:theCat and perishable=1");
        $stmt->bindParam(':theCat', $theCategory, PDO::PARAM_STR,20);
        $stmt->execute();
        echo "rowCount() returns: ".$stmt->rowCount().$b;   // See comments below from the Manual, varies from driver to driver

        $stmt = $dbh->prepare("select count(*) as theCount from foods where category=:theCat and perishable=1");
        $stmt->bindParam(':theCat', $theCategory, PDO::PARAM_STR,20);
        $stmt->execute();
        $row=$stmt->fetch();    // fetches just one row, which is all we expect
        echo "count(*) returns: ".$row['theCount'].$b;

        $stmt = null;
        // PDO closes connection at end of script
    } catch (PDOException $e) {
        echo 'PDO Exception: ' . $e->getMessage();
        exit();
    }
?> 
```

## 用于测试的架构

```
create table foods
(   id int auto_increment primary key,
    foodName varchar(100) not null,
    category varchar(20) not null,
    perishable int not null
);
insert foods (foodName,category,perishable) values 
('kiwi','fruit',1),('ground hamburger','meat',1),
('canned pears','fruit',0),('concord grapes','fruit',1); 
```

对于我的实现，我得到了上述`2`两者的输出`echos`。上述 2 种策略的**目的**是确定您的驱动程序实现是否发出 rowCount，如果没有，则寻求备用策略。

来自[PDOStatement::rowCount](http://php.net/manual/en/pdostatement.rowcount.php)手册：

> PDOStatement::rowCount() 返回受 DELETE、INSERT 或 UPDATE 语句影响的行数。
> 
> `For most databases`, PDOStatement::rowCount() 不返回受 SELECT 语句影响的行数。相反，使用 PDO::query() 发出 SELECT COUNT(*) 语句，其谓词与预期的 SELECT 语句相同，然后使用 PDOStatement::fetchColumn() 检索将返回的行数。然后，您的应用程序可以执行正确的操作。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-07-19T15:26:30.077

如果您使用 Wordpress 获取数据，那么您可以使用 $wpdb->num_rows 访问返回的行数：

```
$wpdb->get_results( $wpdb->prepare('select * from mytable where foo = %s', $searchstring));
echo $wpdb->num_rows; 
```

如果您想要基于 mysql 计数查询的特定计数，那么您可以这样做：

```
$numrows = $wpdb->get_var($wpdb->prepare('SELECT COUNT(*) FROM mytable where foo = %s', $searchstring );
echo $numrows; 
```

如果您正在运行更新或删除，则直接从函数调用返回受影响的行数：

```
$numrowsaffected = $wpdb->query($wpdb->prepare(
   'update mytable set val=%s where myid = %d', $valuetoupdate, $myid)); 
```

这也适用于 $wpdb->update 和 $wpdb->delete。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2019-12-17T20:46:18.043

# 基础

要获取 SQL 中匹配的行数，您通常会使用`COUNT(*)`. 例如：

```
SELECT COUNT(*) FROM some_table 
```

要在 PHP 中获取该值，您需要从返回结果的第一行的第一列中获取值。下面演示了一个使用 PDO 和 mysqli 的示例。

但是，如果您想获取结果并且仍然知道您使用 PHP 获取了多少条记录，那么您可以使用[`count()`](https://www.php.net/manual/en/function.count.php)或利用结果对象中的预填充计数，如果您的 DB API 提供它，例如[mysqli's`num_rows`](https://www.php.net/manual/en/mysqli-result.num-rows.php)。

# 使用 MySQLi

使用 mysqli，您可以使用获取第一行`fetch_row()`，然后访问该`0`列，该列应包含`COUNT(*)`.

```
// your connection code
mysqli_report(MYSQLI_REPORT_ERROR | MYSQLI_REPORT_STRICT);
$mysqli = new \mysqli('localhost', 'dbuser', 'yourdbpassword', 'db_name');
$mysqli->set_charset('utf8mb4');

// your SQL statement
$stmt = $mysqli->prepare('SELECT COUNT(*) FROM some_table WHERE col1=?');
$stmt->bind_param('s', $someVariable);
$stmt->execute();
$result = $stmt->get_result();

// now fetch 1st column of the 1st row 
$count = $result->fetch_row()[0];

echo $count; 
```

如果您想获取所有行，但仍然知道行数，那么您可以使用`num_rows`or `count()`。

```
// your SQL statement
$stmt = $mysqli->prepare('SELECT col1, col2 FROM some_table WHERE col1=?');
$stmt->bind_param('s', $someVariable);
$stmt->execute();
$result = $stmt->get_result();

// If you want to use the results, but still know how many records were fetched
$rows = $result->fetch_all(MYSQLI_ASSOC);

echo $result->num_rows;
// or
echo count($rows); 
```

# 使用 PDO

使用 PDO 要简单得多。您可以直接调用`fetchColumn()`该语句以获取单个列值。

```
// your connection code
$pdo = new \PDO('mysql:host=localhost;dbname=test;charset=utf8mb4', 'root', '', [
    \PDO::ATTR_EMULATE_PREPARES => false,
    \PDO::ATTR_ERRMODE => \PDO::ERRMODE_EXCEPTION
]);

// your SQL statement
$stmt = $pdo->prepare('SELECT COUNT(*) FROM some_table WHERE col1=?');
$stmt->execute([
    $someVariable
]);

// Fetch the first column of the first row
$count = $stmt->fetchColumn();

echo $count; 
```

同样，如果您无论如何都需要获取所有行，那么您可以使用`count()`函数来获取它。

```
// your SQL statement
$stmt = $pdo->prepare('SELECT col1, col2 FROM some_table WHERE col1=?');
$stmt->execute([
    $someVariable
]);

// If you want to use the results, but still know how many records were fetched
$rows = $stmt->fetchAll();

echo count($rows); 
```

PDO 的语句不提供带有获取的行数的预计算属性，但它有一个名为`rowCount()`. 此方法可以告诉您结果中返回的行数，但不能依赖，一般不建议使用。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2020-02-29T09:05:00.677

*这不是问题的直接答案，但在实践中，我经常*希望估计结果集中的行数。对于大多数类型的查询，MySQL 的“EXPLAIN”提供了这一点。

例如，如果解释看起来足够糟糕，我会使用它来拒绝运行客户端查询。

然后每天在每个涉及的 MySQL 服务器上的表上运行“分析本地表”（在复制之外，以防止集群锁定）。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-10-10T04:00:12.203

```
> SELECT COUNT(*) AS total FROM foo WHERE bar= 'value'; 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-04-23T09:06:39.853

使用以下 2 个查询，一个用于获取有限制的数据，另一个用于获取总匹配行数。

前任：

```
SELECT * FROM tbl_name WHERE id > 1000 LIMIT 10;
SELECT COUNT(*) FROM tbl_name WHERE id > 1000; 
```

如[Mysql guide](https://dev.mysql.com/doc/refman/8.0/en/information-functions.html#function_found-rows)所述，这是最优化的方式，并且**SQL_CALC_FOUND_ROWS**查询修饰符和**FOUND_ROWS()**函数自 MySQL 8.0.17 起**已弃用**

# php - 为什么我的 SHA1 哈希不匹配？

> ID：607272
> 
> 赞同：3
> 
> 时间：2009-03-03T17:10:49.473
> 
> 标签：php, sha1

我觉得我上次说的不够具体。开始了：

我有一个十六进制字符串：

> 742713478fb3c36e014d004100440041004 e0041004e00000060f347d15798c9010060 6b899c5a98c9014d007900470072006f007 500700000002f0000001f7691944b9a3306 295fb5f1f57ca52090d35b50060606060606

最后 20 个字节应该（理论上）包含第一部分的 SHA1 哈希（完整字符串 - 20 个字节）。但它不适合我。

试图用 PHP 做到这一点，但没有运气。你能得到一个匹配吗？

### 票：

> 742713478fb3c36e014d004100 440041004e0041004e00000060 f347d15798c90100606b899c5a 98c9014d007900470072006f00 7500700007002f9400909

### 附加到原始票的 sha1 哈希：

> 3306295fb5f1f57ca52090d35b50060606060606

### 我的票的 sha1 哈希：

> b6ecd613698ac3533b5f853bf22f6eb4afb94239

这是票证中的内容及其存储方式。FWIW，我可以提取用户名等，并找出各种分隔符。 [http://www.codeproject.com/KB/aspnet/Forms_Auth_Internals/AuthTicket2.JPG](http://www.codeproject.com/KB/aspnet/Forms_Auth_Internals/AuthTicket2.JPG)

编辑：我发现该字符串在此之前通过的解密函数在末尾填充。我删除了最后 6 个字节并相应地通过票证和哈希进行了调整。仍然不起作用，但我更接近了。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-03T17:18:35.337

您的票是根据十六进制字符串本身计算的。也许附加的哈希是根据相同数据的另一个表示计算的？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-03T17:30:47.287

我认为您对字节与字符感到困惑。

在内部，php 将字符串中的每个字符存储为一个字节。PHP 生成的 sha1 哈希是 20 字节二进制数据的 40 字符（40 字节）十六进制表示，因为每个二进制值需要用 2 个十六进制字符表示。

我不确定这是否是您的差异的实际来源，但看到这种误解让我想知道它是否相关。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-03T17:16:01.287

首先尝试修剪字符串，在末尾有一个换行符或空格会完全改变哈希值，这非常容易。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-03T17:40:34.503

根据此[在线 SHA1 工具](http://www.tools4noobs.com/online_php_functions/sha1/)，给定文本的哈希值（删除新行和空格后）为

```
b6ecd613698ac3533b5f853bf22f6eb4afb94239 
```

想法：确保您输入的字符不是 PHP 版本的十六进制数字。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-09T17:52:42.740

问题是原件是一个键控散列。我必须使用带验证密钥的 hash_hmac() 而不是不带验证密钥的 sha1()。

# perl - 发现 Perl 模块所有子例程的最佳方法是什么？

> ID：607282
> 
> 赞同：24
> 
> 时间：2009-03-03T17:14:05.813
> 
> 标签：perl, reflection, perl-module, subroutine

以编程方式发现 perl 模块具有的所有子例程的最佳方法是什么？这可以是一个模块、一个类（没有@EXPORT）或任何介于两者之间的东西。

编辑：下面的所有方法看起来都可以工作。我可能会在生产中使用 Class::Sniff 或 Class::Inspector。但是，Leon 的答案被标记为“已接受”，因为它回答了所提出的问题，即使`no strict 'refs'`必须使用。:-) Class::Sniff 可能是一个不错的选择。看起来已经有很多想法了。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-03-03T17:29:56.430

```
sub list_module {
    my $module = shift;
    no strict 'refs';
    return grep { defined &{"$module\::$_"} } keys %{"$module\::"}
} 
```

ETA：如果你想过滤掉导入的子程序，你可以这样做

```
use B qw/svref_2object/;

sub in_package {
    my ($coderef, $package) = @_;
    my $cv = svref_2object($coderef);
    return if not $cv->isa('B::CV') or $cv->GV->isa('B::SPECIAL');
    return $cv->GV->STASH->NAME eq $package;
}

sub list_module {
    my $module = shift;
    no strict 'refs';
    return grep { defined &{"$module\::$_"} and in_package(\&{*$_}, $module) } keys %{"$module\::"}
} 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-03-03T19:27:51.483

[类::检查员](http://search.cpan.org/perldoc?Class::Inspector)：

> Class::Inspector 允许您获取有关已加载类的信息。大多数或所有这些信息都可以通过其他方式找到，但它们并不总是非常友好，并且通常涉及相对较高水平的 Perl 魔法，或者看起来很奇怪和不寻常的代码。Class::Inspector 试图为这些信息提供一个更简单、更友好的界面......

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-03-03T18:08:17.213

看看这个： [Class::Sniff](https://metacpan.org/pod/Class::Sniff)

> 该界面目前相当临时，并且可能会发生变化。创建新实例后，调用报告方法是您的最佳选择。然后，您可以直观地检查它以查找潜在问题：
> 
> ```
> my $sniff = Class::Sniff->new({class => 'Some::Class'});
> print $sniff->report; 
> ```
> 
> 该模块试图帮助程序员在面向对象的代码中找到“代码异味”。如果它报告了什么，这并不意味着你的代码是错误的。这只是意味着您可能想更仔细地查看您的代码，看看您是否有任何问题。
> 
> 目前，我们假设 Perl 的默认最左、深度优先搜索顺序。我们将来可能会改变它（并且有一个解决路径方法的方法。稍后会详细介绍）......

# sql-server-2005 - 是否有与 SQL Server NewId() 函数等效的 Access？

> ID：607288
> 
> 赞同：7
> 
> 时间：2009-03-03T17:14:53.130
> 
> 标签：sql-server-2005, ms-access

我编写了将数据加载到 SQL Server 数据库中的 SQL 语句（存储在文本文档中）。这些陈述需要每天重复。一些语句使用该`NewId()`函数来填充数据库中的键域，这很好用。

在编写应用程序来复制这些语句的过程中，我想使用 Access 查询和宏，而不是将查询复制并粘贴到 SQL Server 中，从而节省了我每天的时间。一切正常，但我找不到任何可以替换 SQL Server 函数的`NewId()`函数。是否存在或是否有解决方法？

我正在使用 SQL Server 2005 和 Access 2007。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-04T02:27:16.343

在马特的回答之上，您可以简单地使用[直通查询](http://www.mssqltips.com/tip.asp?tip=1482)，而只需使用来自 MS Access 的现有工作查询。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-20T07:13:03.963

一个解决方案是在您的代码中插入 stguidgen() 函数，您可以在此处找到它：http: ~~//trigeminal.fmsinc.com/code/guids.bas~~ [https://web.archive.org/web/20190129105748 /http://trigeminal.fmsinc.com/code/guids.bas](https://web.archive.org/web/20190129105748/http://trigeminal.fmsinc.com/code/guids.bas)

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-03-04T05:01:40.560

同样，这里似乎存在混淆。

如果我理解正确：

您有一个 Access 前端。

您有一个 SQL Server 2005 后端。

您需要的是能够在 SQL Server 表中生成 GUID。因此，建议在 Access 中添加 ReplicationID 类型的 AutoNumber 字段的答案将无济于事，因为该表不是 Jet 表，而是 SQL Server 表。

SQL当然可以作为直通查询执行，它将所有内容交给SQL Server进行处理，但我想知道为什么SQL Server中这个字段没有默认值？SQL Server 2005 表可以没有 NewId() 作为默认值吗？或者是否有其他方法可以让字段填充新的 GUID？我似乎记得一些关于使用 GUID 并将它们标记为“不用于复制”的事情（我目前无法访问 SQL Server 来查找它）。

在我看来，最好让数据库引擎做这种事情，而不是在你的 SQL 中执行一个函数来做这件事，但也许有人可以告诉我为什么我错了。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-03-03T17:29:34.590

我能想到的唯一解决方法是在您的访问数据库中定义“复制 ID”类型的列，并使其成为自动编号字段。这将自动为每一行生成一个唯一的 GUID，您根本不需要使用 newid()。在 SQL Server 中，您只需为“newid()”列设置默认值。

# sharepoint - SharePoint 列表中带有项目链接的自动编号列

> ID：607291
> 
> 赞同：2
> 
> 时间：2009-03-03T17:16:05.763
> 
> 标签：sharepoint, sharepoint-2007, custom-lists

发布了关于同一主题的类似问题，但我正在添加问题并且之前的讨论已解决。

这是原始问题的链接： [SharePoint 列表中的自动编号列](https://stackoverflow.com/questions/72537/auto-number-column-in-sharepoint-list/606872#606872)

我现在试图找出在 MOSS SharePoint 2007 的自定义列表中是否有一个名为“ID（链接到项目）”的列。
我知道在 SharePoint 中创建问题列表时，视图中默认包含一个“问题 ID（链接到项目）”字段，但是，我无法确定自定义列表是否存在类似字段。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T23:53:30.470

答案是否定的……但您可以创建一个。

[使用SharePoint 管理器](http://www.codeplex.com/spm)（它会摇晃）打开一个网站，您可以看到“IssueID”列的定义以及用于显示“ID（链接到项目）”的定义我在下面包含了我网站中的架构 xml

```
<?xml version="1.0" encoding="utf-16"?>
<Field ID="{de57307b-e69a-4cf9-b3a9-b6a728ecf773}" Sealed="TRUE" ReadOnly="TRUE" Name="IssueID" Type="Computed" DisplayName="Issue ID" SourceID="http://schemas.microsoft.com/sharepoint/v3" StaticName="IssueID" FromBaseType="TRUE">
  <FieldRefs>
    <FieldRef Name="ID" />
  </FieldRefs>
  <DisplayPattern>
    <Column Name="ID" />
  </DisplayPattern>
</Field>

<?xml version="1.0" encoding="utf-16"?>
<Field ID="{03f89857-27c9-4b58-aaab-620647deda9b}" ReadOnly="TRUE" Type="Computed" Name="LinkIssueIDNoMenu" DisplayName="Issue ID" Dir="" DisplayNameSrcField="IssueID" AuthoringInfo="(linked to item)" SourceID="http://schemas.microsoft.com/sharepoint/v3" StaticName="LinkIssueIDNoMenu">
  <FieldRefs>
    <FieldRef Name="ID" />
  </FieldRefs>
  <DisplayPattern>
    <HTML><![CDATA[<a  href="]]></HTML>
    <URL />
    <HTML><![CDATA[" ONCLICK="GoToLink(this);return false;" target="_self">]]></HTML>
    <Column HTMLEncode="TRUE" Name="ID" />
    <HTML><![CDATA[</a>]]></HTML>
  </DisplayPattern>
</Field> 
```

更改 GUID，您可以将这些列添加到自定义列表中，它们将以您需要的方式显示。我建议为列创建一个功能（可能使用[STSDev](http://www.codeplex.com/stsdev)）并通过解决方案发布到开发站点以外的任何东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-12T17:46:42.887

您可以使用 SharePoint Designer 将列表视图转换为数据视图 WebPart。从那里您可以完全控制用于视图呈现的 XSL，这将使您可以轻松地从任何或所有字段链接到项目。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-05-16T17:37:31.633

有一个可用的 powershell 脚本，您可以使用它来为字段添加上下文菜单。

[使用 POWERSHELL 将共享点列表项的上下文菜单添加到任何列](http://www.ilovesharepoint.com/2008/08/add-sharepoint-list-item-context-menu.html)

```
PS> & .\AddMenuColumn.ps1 -webUrl http://[server:port]/site/subsite/ -listName "Test" -fieldTitle "justAnyColumn" -addToDefaultView $true 
```

# mysql - 使用 SQL 将结果限制为不同的列

> ID：607292
> 
> 赞同：1
> 
> 时间：2009-03-03T17:16:12.423
> 
> 标签：mysql

我正在尝试获取项目列表以及每个项目的订单信息。一个订单总是至少有 1 个与之关联的项目。我想将此列表限制为 10 个**订单**中的所有项目。正如我的查询如下所示，它得到 10 **items**。将其限制为 10 个订单的最佳方法是什么，同时获取与这些订单相关的所有项目（无论是 10 行还是 200 行）？

```
SELECT o.*, i.*
FROM orders o, items i
WHERE i.order_id = o.id
LIMIT 0, 10 
```

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T17:21:02.910

尝试使用您首先限制订单的子选择。在外部选择中，您可以获取这 10 个订单的所有项目。

```
SELECT o.*, i.*
FROM items i, (SELECT * FROM orders LIMIT 0, 10) o
WHERE i.order_id = o.id 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T17:21:07.747

```
SELECT oo.*, i.*
FROM (
  SELECT *
  FROM orders o
  LIMIT 10
  ) oo , items i
WHERE i.order_id = oo.id 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T17:21:31.333

我不知道mysql，但猜测一下

```
SELECT o.*, i.*
FROM orders o, items i
WHERE i.order_id = o.id and 
o.id in (select o.id from orders o limit 0, 10) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-03T17:21:53.690

像这样的东西应该工作：

```
SELECT o.*, i.*
FROM items i INNER JOIN orders o ON o.id = i.order_id
WHERE o.order_id IN (
  SELECT o.id
  FROM orders
  LIMIT 0, 10
) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-03T17:24:57.847

```
SELECT orders1.*, items.*
FROM
(select * from orders 
LIMIT 10) AS orders1
LEFT JOIN items ON orders1.id = items.order_id; 
```

# genetic-programming - 模拟电路仿真库？

> ID：607297
> 
> 赞同：4
> 
> 时间：2009-03-03T17:17:24.887
> 
> 标签：genetic-programming, circuit

我正在研究一种基因编程工具，我想开发模拟电路。任何人都可以建议一个库或工具，甚至是连接我的 GP 代码的参考吗？我只需要某种方法让 SPICE 之类的东西评估由我的代码创建的电路。我已经看到了对 SPICE 等工具使用的电路（网表）的纯文本表示形式的引用。我想知道是否有比运行它并在标准输入上传递网表更好的方法来连接到模拟器。如果您想知道我对哪种库感兴趣，我的代码是用 C 编写的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T19:35:58.017

[Modelica](http://www.modelica.org/)具有各种电路分析功能。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T17:39:28.513

[SPICE](http://bwrc.eecs.berkeley.edu/Classes/IcBook/SPICE/)是参考电子模拟器。

我认为它主要是用 Forth 编写的，现在主要使用 Forth-to-C 翻译器。我会尝试集成它，只需阅读其文本输出即可选择您想要{min/max}最大化的值

# c# - 可以使用 Boost 或 STL 显示自定义字符串的 C++ 断言？

> ID：607299
> 
> 赞同：0
> 
> 时间：2009-03-03T17:18:12.170
> 
> 标签：c#, c++, testing, boost, assert

我真的很想去：（在 C++ 中）

```
assert( num > 0, "The number must be greater than zero!"); 
```

在 C# XNA 中，他们有一个方法可以做到这一点：

```
Debug.Assert( num > 0, "The number must be greater than zero!"); 
```

有没有办法做到这一点，以便运行时给我一个有意义的完整错误，而不仅仅是“断言失败”错误？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-03T17:28:24.187

您可以在大多数任何断言中使用它：

```
assert(("The number must be greater than zero!",  num > 0)); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-03T17:25:21.683

运行时通常会显示失败的表达式，因此您可以执行以下操作：

```
assert(num > 0 && "The number must be greater than zero!"); 
```

这不会影响逻辑，但断言失败消息将包含一个描述性字符串。

此外，这无需 STL 或 Boost 即可工作。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-03T17:24:07.957

使用 assert( num > 0 && "该数字必须大于零！" );

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-12T11:21:26.933

使用 BOOST，您可以使用他们的断言，如[http://www.boost.org/doc/libs/1_50_0/libs/utility/assert.html](http://www.boost.org/doc/libs/1_50_0/libs/utility/assert.html)中所述：

```
#include <boost/assert.hpp>
/* ... */

BOOST_ASSERT_MSG( num > 0, "The number must be greater than zero!"); 
```

会完全按照要求做。

# c# - 如何绑定属于自定义控件的某些属性？

> ID：607306
> 
> 赞同：0
> 
> 时间：2009-03-03T17:21:20.943
> 
> 标签：c#, .net, wpf, data-binding, custom-controls

如果我有以下控制：

```
public partial class MyControl : UserControl{
    public string MyControlText{
        get { return MyTextBox.Text; } 
        set { MyTextBox.Text = value; }
    }

    public MyControl(){ ... }
} 
```

当我将控件放在我的一个页面上时，如何绑定到“MyControlText”属性，如下所示：

```
<local:MyControl MyControlText={Binding Path=SomeField} /> 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T17:23:54.183

您需要将该属性设为依赖属性。DependencyProperty 类的文档向您展示了如何执行此操作：

[http://msdn.microsoft.com/en-us/library/system.windows.dependencyproperty.aspx#](http://msdn.microsoft.com/en-us/library/system.windows.dependencyproperty.aspx#)

# asp.net-mvc - 如何在 asp.net mvc 控制器中处理 stackoverflow 的问题 url？

> ID：607308
> 
> 赞同：3
> 
> 时间：2009-03-03T17:21:27.107
> 
> 标签：asp.net-mvc, routing, url-routing

我想知道如何在 asp.net mvc 中设置路由，以便我可以拥有与 stackoverflows 问题 url 类似的 url？

[你相信 ASP.Net MVC 已经准备好投入生产了吗？](https://stackoverflow.com/questions/115634/do-you-believe-that-asp-net-mvc-is-ready-for-production/)

我猜想对于 url 创建有一个帮助类来创建问题 url。

我想知道的部分是如何在控制器端实现这一点。我认为很可能家庭控制器有一个问题操作，id 是 115634。然后是问题的标题——我想这是为了搜索引擎优化。我的问题是控制器方法签名的样子。

它是同时包含 id 和标题的 Question(int?id) 还是 Question(string?param)？

将如何实现这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-03T17:25:41.137

查看[这个问题](https://stackoverflow.com/questions/25259/how-do-you-include-a-webpage-title-as-part-of-a-webpage-url/25486#25486)，Jeff Atwood 本人在其中发布了他们用来制作友好 URL 的代码。另外，我不是 C# 开发人员，所以我不确定在 ASP.NET MVC 上是如何工作的，但是如果您尝试删除 StackOverflow URL 中的标题，该页面仍然可以正常工作。它们对于人类的可读性（因此他们知道在看到链接时会发生什么）和搜索引擎具有 100% 的可读性。因此，我希望如果您想要类似的东西，您可以将其作为控制器中的可选参数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T17:51:22.543

看看这个[问题](https://stackoverflow.com/questions/217960/asp-net-mvc-friendly-url)......可能是你正在寻找的答案（：

# c# - LINQ to SQL 等效于 T-SQL 和强制转换中的 ISDATE()？

> ID：607312
> 
> 赞同：2
> 
> 时间：2009-03-03T17:21:58.853
> 
> 标签：c#, sql, linq-to-sql

有谁知道 LINQ to SQL 查询语法中的 ISDATE() 等效项？我在 SQL 中有一个包含日期的 varchar 字段，我需要过滤掉非日期行。

希望有这样的事情：

```
var query = SomeDataContext;
    query = from p in query
    where p.ISDATE(field1) == true;
    select p; 
```

另外，如何在 Linq 语法中为 SQL 转换一些东西？

```
CAST(SomeDate AS SMALLDATETIME) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T19:02:31.310

这样做的技巧是在数据库中创建一个用户函数，它只调用 ISDATE 作为返回值

```
 CREATE FUNCTION My_ISDATE(@maybeDate varchar(max))
  returns bit
  as return ISDATE(@maybeDate); 
```

然后将 My_IsDate 添加到您的数据库上下文中，并在您的查询中使用它：

```
var db = SomeDataContext;
var query = from p in db.MyTable
where db.My_ISDATE(p.field1)
select p; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T17:29:59.770

我认为在使用 LINQ to SQL 时没有映射到 ISDATE 的扩展方法。

如果您可以加载所有数据然后在客户端空间中进行过滤，则在该字段上使用 TryParse 并与日期进行比较。

否则，我将创建一个存储过程，该过程将返回您想要的数据（以便您可以使用 ISDATE），然后通过上下文执行该过程。

此外，您使用 ISDATE 的语法不正确。ISDATE 只是告诉您表达式是否是有效的日期格式。您的查询将如下所示：

```
var query = SomeDataContext;
    query = from p in query
    where ISDATE(field1) != 0 && CONVERT(datetime, field1) > some date
    select p; 
```

语法无效，但它让您了解如何形成查询。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T17:56:36.150

看起来你可以做到。链接：

[http://msdn.microsoft.com/en-us/library/bb386973.aspx](http://msdn.microsoft.com/en-us/library/bb386973.aspx)

这可能会有所帮助，但我还没有看过：

[http://mtaulty.com/videos/nuggets/l2s/15_mt_l2s_callingsqlfunctions.wmv](http://mtaulty.com/videos/nuggets/l2s/15_mt_l2s_callingsqlfunctions.wmv)

完整列表在这里：

[http://mtaulty.com/CommunityServer/blogs/mike_taultys_blog/archive/2007/05/10/9322.aspx](http://mtaulty.com/CommunityServer/blogs/mike_taultys_blog/archive/2007/05/10/9322.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-05-08T08:18:20.710

SO的一个问题是，越来越多的关于问题答案的线程包含过时的答案，主要是因为它们多年来没有被触及。然而，结合搜索引擎（例如谷歌），当您查询“我应该如何在 Linq 中使用 IsDate”时，它会以 #1 的形式返回链接（例如这篇文章），它需要有人添加一个答案（在底部带有0票）的最新正确答案。

:: [https://github.com/dotnet/efcore/issues/8488](https://github.com/dotnet/efcore/issues/8488) >

它现在已添加到 EF.Functions 中，因此您可以简单地执行以下操作：

```
Where(x=>  EF.Functions.IsDate(x.somefield)) 
```

# iis-6 - FTP 响应代码

> ID：607314
> 
> 赞同：1
> 
> 时间：2009-03-03T17:23:18.817
> 
> 标签：iis-6, ftp

我正在客户端站点对 Microsoft 的 FTP 服务器 (IIS 6.0) 进行故障排除。在 FTP 日志中，我想知道一些响应代码的含义。

例如，在该行中：

12:01:15 10.4.152.122 [194326] 创建 x.jpg 550 1450

我想知道1450的含义。还有其他的，比如550 2，和550 32。

任何人都知道具有这些子代码含义的站点或参考（不确定正确的术语是什么）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-03T17:27:20.260

450 / 550 值均来自[RFC 959](https://www.rfc-editor.org/rfc/rfc959)。

由于 450 和 550 都是 FTP 错误，因此第二个值*可能*对应于 Windows 错误代码。这里的页面与[此](http://msdn.microsoft.com/en-us/library/ms681381.aspx)一致，值 2、32 和 1450 都与文件 I/O 错误有关。

> 2 =`ERROR_FILE_NOT_FOUND`
> 
> *   该系统找不到指定的文件。
> 
> 32 =`ERROR_SHARING_VIOLATION`
> 
> *   该进程无法访问该文件，因为它正被另一个进程使用。
> 
> 1450 = `ERROR_NO_SYSTEM_RESOURCES` - 系统资源不足，无法完成请求的服务。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T17:27:02.337

据此[，](http://www.altools.com/image/support/alftp/ALFTP_35_help/FTP_response_codes_rfc_959_messages.htm) 550 是：

```
未采取请求的操作。
文件不可用（例如，文件未找到，无法访问）。
```

# asp.net - 在 ASP.NET 中下载文本文件是附加网页 HTML

> ID：607319
> 
> 赞同：3
> 
> 时间：2009-03-03T17:24:24.727
> 
> 标签：asp.net, vb.net, visual-studio, download

感谢我之前[在这个论坛](https://stackoverflow.com/questions/426219/how-do-i-send-a-binary-blob-to-a-client-browser)上收到的帮助，我能够让我的 asp.net 网站将各种文件下载到客户端浏览器。

出于某种奇怪的原因，当我下载文本文件时，网页的 HTML 被附加到文本中！所有其他文件类型都可以正常工作！

这是正在下载的代码：

```
 Public Sub DownloadBlob(ByVal Blob As Byte(), ByVal FileName As String, ByVal Response As HttpResponse)
    Response.AddHeader("content-disposition", String.Format("attachment;filename={0}", FileName.Replace(" ", "_")))
    Response.ContentType = String.Format("application/{0}", Path.GetExtension(FileName).Substring(1))
    Response.BinaryWrite(Blob)
  End Sub 
```

这是我的文本文件中的内容：

```
Here is a test file
I hope it works!
:)
Saul

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head><title>
    EEI - Case
</title><link rel="stylesheet" href="EEI.css" />

  <script language="javascript" id="jssembleWare" src="sembleWare.js"></script>

</head>
<body>
  <form name="form1" method="post" action="EEICaseEditForm.aspx" id="form1">
<div>
<input type="hidden" name="__EVENTTARGET" id="__EVENTTARGET" value="" />
<input type="hidden" name="__EVENTARGUMENT" id="__EVENTARGUMENT" value="" />
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwUKLTg4MDg2NjA2Ng8WAh4Uc2VtYmxlV2FyZV9QYWdlU3RhdGUymXsAAQAAAP////8BAAAAAAAAAAwCAAAARnN3UnVudGltZUFTUE5ldCwgVmVyc2lvbj0zLjUuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPW51bGwMAwAAAEBzd1J1bnRpbWUsIFZlcnNpb249My41LjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1udWxsDAQAAABJU3lzdGVtLCBWZXJzaW9uPTIuMC4wLjAsIEN1bHR1cmU9bmV1dHJhbCwgUHVibGljS2V5VG9rZW49Yjc3YTVjNTYxOTM0ZTA4OQUBAAAAKHNlbWJsZVdhcmUuUnVudGltZS5BU1BOZXQuUGFnZU5hdmlnYXRpb24KAAAAE21vUHJldmlvdXNQYWdlU3RhdGUKbXNQYWdlTmFtZRJtc1JlZGlyZWN0UGFnZU5hbWUPbW9TdXBwbGllZFBhcnRzB21vTGlzdHMKbWJWaWV3T25seQdtbkRlcHRoCm1vUGFydFBvb2wKbW9TZXR0aW5ncxBtb1BlcnNpc3RlZEl0ZW1zBAEBBAMAAAQDBChzZW1ibGVXYXJlLlJ1bnRpbWUuQVNQTmV0LlBhZ2VOYXZpZ2F0aW9uAgAAACdzZW1ibGVXYXJlLlJ1bnRpbWUuQVNQTmV0LlN1cHBsaWVkUGFydHMCAAAA8wFTeXN0ZW0uQ29sbGVjdGlvbnMuR2VuZXJpYy5EaWN0aW9uYXJ5YDJbW1N5c3RlbS5TdHJpbmcsIG1zY29ybGliLCBWZXJzaW9uPTIuMC4wLjAsIEN1bHR1cmU9bmV1dHJhbCwgUHVibGljS2V5VG9rZW49Yjc3YTVjNTYxOTM0ZTA4OV0sW3NlbWJsZVdhcmUuUnVudGltZS5BU1BOZXQuTGlzdFN0YXRlLCBzd1J1bnRpbWVBU1BOZXQsIFZlcnNpb249My41LjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1udWxsXV0BCBtzZW1ibGVXYXJlLlJ1bnRpbWUuUGFydFBvb2wDAAAAHFN5c3RlbS5Db2xsZWN0aW9ucy5IYXNodGFibGUtU3lzdGVtLkNvbGxlY3Rpb25zLlNwZWNpYWxpemVkLkxpc3REaWN0aW9uYXJ5BAAAAAIAAAAJBQAAAAYGAAAAFS9FRUlDYXNlRWRpdEZvcm0uYXNweAoJBwAAAAkIAAAAAAMAAAAJCQAAAAkKAAAACQsAAAABBQAAAAEAAAAJDAAAAAYNAAAAEi9DYXNlR3JpZEZvcm0uYXNweAoJDgAAAAkPAAAAAAIAAAAKCgoFBwAAACdzZW1ibGVXYXJlLlJ1bnRpbWUuQVNQTmV0LlN1cHBsaWVkUGFydHMCAAAAD21vU3VwcGxpZWRQYXJ0cwxtb05hdmlnYXRpb24DBPYBU3lzdGVtLkNvbGxlY3Rpb25zLkdlbmVyaWMuRGljdGlvbmFyeWAyW1tTeXN0ZW0uU3RyaW5nLCBtc2NvcmxpYiwgVmVyc2lvbj0yLjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWI3N2E1YzU2MTkzNGUwODldLFtzZW1ibGVXYXJlLlJ1bnRpbWUuQVNQTmV0LlN1cHBsaWVkUGFydCwgc3dSdW50aW1lQVNQTmV0LCBWZXJzaW9uPTMuNS4wLjAsIEN1bHR1cmU9bmV1dHJhbCwgUHVibGljS2V5VG9rZW49bnVsbF1dKHNlbWJsZVdhcmUuUnVudGltZS5BU1BOZXQuUGFnZU5hdmlnYXRpb24CAAAAAgAAAAkQAAAACQEAAAAECAAAAPMBU3lzdGVtLkNvbGxlY3Rpb25zLkdlbmVyaWMuRGljdGlvbmFyeWAyW1tTeXN0ZW0uU3RyaW5nLCBtc2NvcmxpYiwgVmVyc2lvbj0yLjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWI3N2E1YzU2MTkzNGUwODldLFtzZW1ibGVXYXJlLlJ1bnRpbWUuQVNQTmV0Lkxpc3RTdGF0ZSwgc3dSdW50aW1lQVNQTmV0LCBWZXJzaW9uPTMuNS4wLjAsIEN1bHR1cmU9bmV1dHJhbCwgUHVibGljS2V5VG9rZW49bnVsbF1dBAAAAAdWZXJzaW9uCENvbXBhcmVyCEhhc2hTaXplDUtleVZhbHVlUGFpcnMAAwADCJIBU3lzdGVtLkNvbGxlY3Rpb25zLkdlbmVyaWMuR2VuZXJpY0VxdWFsaXR5Q29tcGFyZXJgMVtbU3lzdGVtLlN0cmluZywgbXNjb3JsaWIsIFZlcnNpb249Mi4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1iNzdhNWM1NjE5MzRlMDg5XV0I9wFTeXN0ZW0uQ29sbGVjdGlvbnMuR2VuZXJpYy5LZXlWYWx1ZVBhaXJgMltbU3lzdGVtLlN0cmluZywgbXNjb3JsaWIsIFZlcnNpb249Mi4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1iNzdhNWM1NjE5MzRlMDg5XSxbc2VtYmxlV2FyZS5SdW50aW1lLkFTUE5ldC5MaXN0U3RhdGUsIHN3UnVudGltZUFTUE5ldCwgVmVyc2lvbj0zLjUuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPW51bGxdXVtdBwAAAAkSAAAABwAAAAkTAAAABQkAAAAbc2VtYmxlV2FyZS5SdW50aW1lLlBhcnRQb29sAgAAAAptblNlcXVlbmNlC21vUG9vbEl0ZW1zAAMIHFN5c3RlbS5Db2xsZWN0aW9ucy5IYXNodGFibGUDAAAAEwAAAAkUAAAABAoAAAAcU3lzdGVtLkNvbGxlY3Rpb25zLkhhc2h0YWJsZQcAAAAKTG9hZEZhY3RvcgdWZXJzaW9uCENvbXBhcmVyEEhhc2hDb2RlUHJvdmlkZXIISGFzaFNpemUES2V5cwZWYWx1ZXMAAAMDAAUFCwgcU3lzdGVtLkNvbGxlY3Rpb25zLklDb21wYXJlciRTeXN0ZW0uQ29sbGVjdGlvbnMuSUhhc2hDb2RlUHJvdmlkZXII7FE4PwEAAAAKCgsAAAAJFQAAAAkWAAAABQsAAAAtU3lzdGVtLkNvbGxlY3Rpb25zLlNwZWNpYWxpemVkLkxpc3REaWN0aW9uYXJ5BAAAAARoZWFkB3ZlcnNpb24FY291bnQIY29tcGFyZXIEAAADPFN5c3RlbS5Db2xsZWN0aW9ucy5TcGVjaWFsaXplZC5MaXN0RGljdGlvbmFyeStEaWN0aW9uYXJ5Tm9kZQQAAAAICBxTeXN0ZW0uQ29sbGVjdGlvbnMuSUNvbXBhcmVyBAAAAAoAAAAAAAAAAAoBDAAAAAEAAAAKBhcAAAAOL01haW5NZW51LmFzcHgGGAAAAAAJGQAAAAkaAAAAAAEAAAAKCgoBDgAAAAcAAAAJGwAAAAkFAAAAAQ8AAAAIAAAABAAAAAkdAAAABwAAAAkeAAAABBAAAAD2AVN5c3RlbS5Db2xsZWN0aW9ucy5HZW5lcmljLkRpY3Rpb25hcnlgMltbU3lzdGVtLlN0cmluZywgbXNjb3JsaWIsIFZlcnNpb249Mi4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1iNzdhNWM1NjE5MzRlMDg5XSxbc2VtYmxlV2FyZS5SdW50aW1lLkFTUE5ldC5TdXBwbGllZFBhcnQsIHN3UnVudGltZUFTUE5ldCwgVmVyc2lvbj0zLjUuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPW51bGxdXQQAAAAHVmVyc2lvbghDb21wYXJlcghIYXNoU2l6ZQ1LZXlWYWx1ZVBhaXJzAAMAAwiSAVN5c3RlbS5Db2xsZWN0aW9ucy5HZW5lcmljLkdlbmVyaWNFcXVhbGl0eUNvbXBhcmVyYDFbW1N5c3RlbS5TdHJpbmcsIG1zY29ybGliLCBWZXJzaW9uPTIuMC4wLjAsIEN1bHR1cmU9bmV1dHJhbCwgUHVibGljS2V5VG9rZW49Yjc3YTVjNTYxOTM0ZTA4OV1dCPoBU3lzdGVtLkNvbGxlY3Rpb25zLkdlbmVyaWMuS2V5VmFsdWVQYWlyYDJbW1N5c3RlbS5TdHJpbmcsIG1zY29ybGliLCBWZXJzaW9uPTIuMC4wLjAsIEN1bHR1cmU9bmV1dHJhbCwgUHVibGljS2V5VG9rZW49Yjc3YTVjNTYxOTM0ZTA4OV0sW3NlbWJsZVdhcmUuUnVudGltZS5BU1BOZXQuU3VwcGxpZWRQYXJ0LCBzd1J1bnRpbWVBU1BOZXQsIFZlcnNpb249My41LjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1udWxsXV1bXQUAAAAJEgAAAAMAAAAJIAAAAAQSAAAAkgFTeXN0ZW0uQ29sbGVjdGlvbnMuR2VuZXJpYy5HZW5lcmljRXF1YWxpdHlDb21wYXJlcmAxW1tTeXN0ZW0uU3RyaW5nLCBtc2NvcmxpYiwgVmVyc2lvbj0yLjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWI3N2E1YzU2MTkzNGUwODldXQAAAAAHEwAAAAABAAAABwAAAAP1AVN5c3RlbS5Db2xsZWN0aW9ucy5HZW5lcmljLktleVZhbHVlUGFpcmAyW1tTeXN0ZW0uU3RyaW5nLCBtc2NvcmxpYiwgVmVyc2lvbj0yLjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWI3N2E1YzU2MTkzNGUwODldLFtzZW1ibGVXYXJlLlJ1bnRpbWUuQVNQTmV0Lkxpc3RTdGF0ZSwgc3dSdW50aW1lQVNQTmV0LCBWZXJzaW9uPTMuNS4wLjAsIEN1bHR1cmU9bmV1dHJhbCwgUHVibGljS2V5VG9rZW49bnVsbF1dBN/////1AVN5c3RlbS5Db2xsZWN0aW9ucy5HZW5lcmljLktleVZhbHVlUGFpcmAyW1tTeXN0ZW0uU3RyaW5nLCBtc2NvcmxpYiwgVmVyc2lvbj0yLjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWI3N2E1YzU2MTkzNGUwODldLFtzZW1ibGVXYXJlLlJ1bnRpbWUuQVNQTmV0Lkxpc3RTdGF0ZSwgc3dSdW50aW1lQVNQTmV0LCBWZXJzaW9uPTMuNS4wLjAsIEN1bHR1cmU9bmV1dHJhbCwgUHVibGljS2V5VG9rZW49bnVsbF1dAgAAAANrZXkFdmFsdWUBBCNzZW1ibGVXYXJlLlJ1bnRpbWUuQVNQTmV0Lkxpc3RTdGF0ZQIAAAAGIgAAABNDb3VudHJ5T2ZPcmlnaW5MaXN0CSMAAAAB3P///9////8GJQAAAA5Bc3NpZ25lZFRvTGlzdAkmAAAAAdn////f////BigAAAAOQ2FzZVN0YXR1c0xpc3QJKQAAAAHW////3////wYrAAAAFFJlcXVlc3RlZFNlcnZpY2VMaXN0CSwAAAAB0////9////8GLgAAAAlEb2N1bWVudHMJLwAAAAHQ////3////wYxAAAAB0hpc3RvcnkJMgAAAAHN////3////wY0AAAAE1JlcXVlc3RlZEJ5VXNlckxpc3QJNQAAAAEUAAAACgAAAOxROD8eAAAACgoXAAAACTYAAAAJNwAAABAVAAAAAQAAAAY4AAAABlVzZXJJRBAWAAAAAQAAAAgJBwAAAAAAAAABGQAAAAcAAAAJOQAAAAkMAAAABBoAAADzAVN5c3RlbS5Db2xsZWN0aW9ucy5HZW5lcmljLkRpY3Rpb25hcnlgMltbU3lzdGVtLlN0cmluZywgbXNjb3JsaWIsIFZlcnNpb249Mi4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1iNzdhNWM1NjE5MzRlMDg5XSxbc2VtYmxlV2FyZS5SdW50aW1lLkFTUE5ldC5MaXN0U3RhdGUsIHN3UnVudGltZUFTUE5ldCwgVmVyc2lvbj0zLjUuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPW51bGxdXQMAAAAHVmVyc2lvbghDb21wYXJlcghIYXNoU2l6ZQADAAiSAVN5c3RlbS5Db2xsZWN0aW9ucy5HZW5lcmljLkdlbmVyaWNFcXVhbGl0eUNvbXBhcmVyYDFbW1N5c3RlbS5TdHJpbmcsIG1zY29ybGliLCBWZXJzaW9uPTIuMC4wLjAsIEN1bHR1cmU9bmV1dHJhbCwgUHVibGljS2V5VG9rZW49Yjc3YTVjNTYxOTM0ZTA4OV1dCAAAAAAJOwAAAAAAAAABGwAAABAAAAANAAAACR0AAAAHAAAACT0AAAABHQAAABIAAAAHHgAAAAABAAAABAAAAAP1AVN5c3RlbS5Db2xsZWN0aW9ucy5HZW5lcmljLktleVZhbHVlUGFpcmAyW1tTeXN0ZW0uU3RyaW5nLCBtc2NvcmxpYiwgVmVyc2lvbj0yLjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWI3N2E1YzU2MTkzNGUwODldLFtzZW1ibGVXYXJlLlJ1bnRpbWUuQVNQTmV0Lkxpc3RTdGF0ZSwgc3dSdW50aW1lQVNQTmV0LCBWZXJzaW9uPTMuNS4wLjAsIEN1bHR1cmU9bmV1dHJhbCwgUHVibGljS2V5VG9rZW49bnVsbF1dAcL////f////Bj8AAAAEQ2FzZQlAAAAAAb/////f////BkIAAAAUUmVxdWVzdGVkU2VydmljZUxpc3QJQwAAAAG8////3////wZFAAAAEUN1cnJlbnRTdGF0dXNMaXN0CUYAAAABuf///9////8GSAAAABNDb3VudHJ5T2ZPcmlnaW5MaXN0CUkAAAAHIAAAAAABAAAAAQAAAAP4AVN5c3RlbS5Db2xsZWN0aW9ucy5HZW5lcmljLktleVZhbHVlUGFpcmAyW1tTeXN0ZW0uU3RyaW5nLCBtc2NvcmxpYiwgVmVyc2lvbj0yLjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWI3N2E1YzU2MTkzNGUwODldLFtzZW1ibGVXYXJlLlJ1bnRpbWUuQVNQTmV0LlN1cHBsaWVkUGFydCwgc3dSdW50aW1lQVNQTmV0LCBWZXJzaW9uPTMuNS4wLjAsIEN1bHR1cmU9bmV1dHJhbCwgUHVibGljS2V5VG9rZW49bnVsbF1dBLb////4AVN5c3RlbS5Db2xsZWN0aW9ucy5HZW5lcmljLktleVZhbHVlUGFpcmAyW1tTeXN0ZW0uU3RyaW5nLCBtc2NvcmxpYiwgVmVyc2lvbj0yLjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWI3N2E1YzU2MTkzNGUwODldLFtzZW1ibGVXYXJlLlJ1bnRpbWUuQVNQTmV0LlN1cHBsaWVkUGFydCwgc3dSdW50aW1lQVNQTmV0LCBWZXJzaW9uPTMuNS4wLjAsIEN1bHR1cmU9bmV1dHJhbCwgUHVibGljS2V5VG9rZW49bnVsbF1dAgAAAANrZXkFdmFsdWUBBCZzZW1ibGVXYXJlLlJ1bnRpbWUuQVNQTmV0LlN1cHBsaWVkUGFydAIAAAAGSwAAABNTZW5pb3JFdmFsdWF0b3JSb2xlCUwAAAAFIwAAACNzZW1ibGVXYXJlLlJ1bnRpbWUuQVNQTmV0Lkxpc3RTdGF0ZQoAAAAKbXNMaXN0TmFtZRFtb1NlbGVjdGVkUm93S2V5cw1tb1BhZ2VSb3dLZXlzDm1uTGlzdFJvd0NvdW50Dm1uUGFnZVJvd0NvdW50D21uUGFnZVJvd051bWJlchBtbkN1cnJlbnRQYWdlTnVtDG1zU29ydENvbHVtbg5tYlJldmVyc2VPcmRlchFtc1JlcG9zaXRpb25BbGlhcwEDAwAAAAABAAGOAVN5c3RlbS5Db2xsZWN0aW9ucy5HZW5lcmljLkxpc3RgMVtbc2VtYmxlV2FyZS5SdW50aW1lLkFTUE5ldC5Sb3dEYXRhLCBzd1J1bnRpbWVBU1BOZXQsIFZlcnNpb249My41LjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1udWxsXV2OAVN5c3RlbS5Db2xsZWN0aW9ucy5HZW5lcmljLkxpc3RgMVtbc2VtYmxlV2FyZS5SdW50aW1lLkFTUE5ldC5Sb3dEYXRhLCBzd1J1bnRpbWVBU1BOZXQsIFZlcnNpb249My41LjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1udWxsXV0ICAgIAQIAAAAJIgAAAAlOAAAACU8AAAAAAAAAAAAAABYAAAABAAAACRgAAAAACRgAAAABJgAAACMAAAAJJQAAAAlSAAAACVMAAAAAAAAAAAAAAP////8BAAAACRgAAAAACRgAAAABKQAAACMAAAAJKAAAAAlWAAAACVcAAAAAAAAAAAAAAP////8BAAAACRgAAAAACRgAAAABLAAAACMAAAAJKwAAAAlaAAAACVsAAAAAAAAAAAAAAAEAAAABAAAACRgAAAAACRgAAAABLwAAACMAAAAJLgAAAAleAAAACV8AAAAEAAAACgAAAAEAAAABAAAACRgAAAAACRgAAAABMgAAACMAAAAJMQAAAAliAAAACWMAAAACAAAACgAAAP////8BAAAACRgAAAAACRgAAAABNQAAACMAAAAJNAAAAAlmAAAACWcAAAAAAAAAAAAAAAYAAAABAAAACRgAAAAACRgAAAAQNgAAAAkAAAAGaQAAABtFRUlDYXNlNjMzNzE2Nzk2NjQ3NjU2MjUwMTEGagAAABpFRUlDYXNlNjMzNzE2Nzk2NTg1MzEyNTAwOQZrAAAAGFN0YWZmNjMzNzE2Nzk2NTE2MDkzNzUwNgZsAAAAHVN5c3RlbVVzZXI2MzM3MTY3OTY1MTU2MjUwMDA1Bm0AAAAaUGVyc29uNjMzNzE2Nzk2NTg1MzEyNTAwMTAGbgAAAB1TeXN0ZW1Vc2VyNjMzNzE2Nzk2NDYwNjI1MDAwMwZvAAAAGVBlcnNvbjYzMzcxNjc5NjQ2MDYyNTAwMDQGcAAAABhSb2xlNjMzNzE2Nzk2NjUxMDkzNzUwMTMGcQAAABpFRUlDYXNlNjMzNzE2Nzk2NTg1MzEyNTAwOBA3AAAACQAAAAlyAAAACXMAAAAJdAAAAAl1AAAACXYAAAAJdwAAAAl4AAAACXkAAAAJegAAAAE5AAAAEAAAABoAAAAJewAAAAcAAAAJfAAAAAE7AAAAEgAAAAc9AAAAAAEAAAAEAAAAA/gBU3lzdGVtLkNvbGxlY3Rpb25zLkdlbmVyaWMuS2V5VmFsdWVQYWlyYDJbW1N5c3RlbS5TdHJpbmcsIG1zY29ybGliLCBWZXJzaW9uPTIuMC4wLjAsIEN1bHR1cmU9bmV1dHJhbCwgUHVibGljS2V5VG9rZW49Yjc3YTVjNTYxOTM0ZTA4OV0sW3NlbWJsZVdhcmUuUnVudGltZS5BU1BOZXQuU3VwcGxpZWRQYXJ0LCBzd1J1bnRpbWVBU1BOZXQsIFZlcnNpb249My41LjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1udWxsXV0Bg////7b///8GfgAAAAtMaXN0TGltaXRzMQl/AAAAAYD///+2////BoEAAAALTGlzdExpbWl0czIJggAAAAF9////tv///waEAAAAD1BlcnNvbkxpc3RMaW1pdAmFAAAAAXr///+2////BocAAAAHRUVJQ2FzZQmIAAAAAUAAAAAjAAAACT8AAAAJigAAAAmLAAAAMAAAAAoAAAAAAAAAAQAAAAkYAAAAAAmHAAAAAUMAAAAjAAAACUIAAAAJjwAAAAmQAAAAAAAAAAAAAAD/////AQAAAAkYAAAAAAkYAAAAAUYAAAAjAAAACUUAAAAJkwAAAAmUAAAAAAAAAAAAAAD/////AQAAAAkYAAAAAAkYAAAAAUkAAAAjAAAACUgAAAAJlwAAAAmYAAAAAAAAAAAAAAD/////AQAAAAkYAAAAAAkYAAAABUwAAAAmc2VtYmxlV2FyZS5SdW50aW1lLkFTUE5ldC5TdXBwbGllZFBhcnQFAAAAC21lUGFydFN0YXRlC21vS2V5VmFsdWVzCG1zUG9vbElECm1zUGFydE5hbWUHbXNBbGlhcwQFAQEBHXNlbWJsZVdhcmUuUnVudGltZS5QYXJ0U3RhdGVzAwAAAAIAAAAFZv///x1zZW1ibGVXYXJlLlJ1bnRpbWUuUGFydFN0YXRlcwEAAAAHdmFsdWVfXwAIAwAAAAIAAAAJmwAAAAacAAAAGFJvbGU2MzM3MTY3OTY3NDEwOTM3NTAxNQadAAAABFJvbGUJSwAAAAROAAAAjgFTeXN0ZW0uQ29sbGVjdGlvbnMuR2VuZXJpYy5MaXN0YDFbW3NlbWJsZVdhcmUuUnVudGltZS5BU1BOZXQuUm93RGF0YSwgc3dSdW50aW1lQVNQTmV0LCBWZXJzaW9uPTMuNS4wLjAsIEN1bHR1cmU9bmV1dHJhbCwgUHVibGljS2V5VG9rZW49bnVsbF1dAwAAAAZfaXRlbXMFX3NpemUIX3ZlcnNpb24EAAAjc2VtYmxlV2FyZS5SdW50aW1lLkFTUE5ldC5Sb3dEYXRhW10CAAAACAgJnwAAAAAAAAAAAAAAAU8AAABOAAAACaAAAAAhAAAARAAAAAFSAAAATgAAAAmfAAAAAAAAAAAAAAABUwAAAE4AAAAJogAAAAEAAAAEAAAAAVYAAABOAAAACZ8AAAAAAAAAAAAAAAFXAAAATgAAAAmkAAAAAQAAAAQAAAABWgAAAE4AAAAJnwAAAAAAAAAAAAAAAVsAAABOAAAACaYAAAADAAAACAAAAAFeAAAATgAAAAmfAAAAAAAAAAAAAAABXwAAAE4AAAAJqAAAAAQAAAAKAAAAAWIAAABOAAAACZ8AAAAAAAAAAAAAAAFjAAAATgAAAAmqAAAAAgAAAAYAAAABZgAAAE4AAAAJnwAAAAAAAAAAAAAAAWcAAABOAAAACawAAAAcAAAAOgAAAAVyAAAAH3NlbWJsZVdhcmUuUnVudGltZS5QYXJ0UG9vbEl0ZW0KAAAACG1zUGFydElECG1zSXRlbUlECm1vUGFydFBvb2wQbWFvRWxlbWVudFZhbHVlcw1tYW9Mb2FkVmFsdWVzCG1hb0ZsYWdzC21lUGFydFN0YXRlCm1zUGFydE5hbWUKbWVMaWZldGltZQdJc1ZhbGlkAQEEBQUFBAEEABtzZW1ibGVXYXJlLlJ1bnRpbWUuUGFydFBvb2wDAAAAHXNlbWJsZVdhcmUuUnVudGltZS5QYXJ0U3RhdGVzAwAAACNzZW1ibGVXYXJlLlJ1bnRpbWUuUG9vbEl0ZW1MaWZldGltZQMAAAABAwAAAAatAAAAC0VFSUNhc2UsIDE3CWkAAAAJCQAAAAmwAAAACbEAAAAJsgAAAAFN////Zv///wIAAAAJhwAAAAVL////I3NlbWJsZVdhcmUuUnVudGltZS5Qb29sSXRlbUxpZmV0aW1lAQAAAAd2YWx1ZV9fAAgDAAAAAAAAAAEBcwAAAHIAAAAGtgAAABpFRUlDYXNlNjMzNzE2Nzk2NTg1MzEyNTAwNglqAAAACQkAAAAJuQAAAAm6AAAACbsAAAABRP///2b///8BAAAABr0AAAAHRUVJQ2FzZQFC////S////wAAAAABAXQAAAByAAAABr8AAAAJU3RhZmYsIDE1CWsAAAAJCQAAAAnCAAAACcMAAAAJxAAAAAE7////Zv///wIAAAAGxgAAAAVTdGFmZgE5////S////wAAAAABAXUAAAByAAAABsgAAAANU3lzdGVtVXNlciwgNwlsAAAACQkAAAAJywAAAAnMAAAACc0AAAABMv///2b///8CAAAABs8AAAAKU3lzdGVtVXNlcgEw////S////wAAAAABAXYAAAByAAAABtEAAAAZUGVyc29uNjMzNzE2Nzk2NTg1MzEyNTAwNwltAAAACQkAAAAJ1AAAAAnVAAAACdYAAAABKf///2b///8BAAAABtgAAAAGUGVyc29uASf///9L////AAAAAAEBdwAAAHIAAAAG2gAAAB1TeXN0ZW1Vc2VyNjMzNzE2Nzk2NDYwNjI1MDAwMwluAAAACQkAAAAJ3QAAAAneAAAACd8AAAABIP///2b///8BAAAABuEAAAAKU3lzdGVtVXNlcgEe////S////wAAAAABAXgAAAByAAAABuMAAAAZUGVyc29uNjMzNzE2Nzk2NDYwNjI1MDAwNAlvAAAACQkAAAAJ5gAAAAnnAAAACegAAAABF////2b///8BAAAABuoAAAAGUGVyc29uARX///9L////AAAAAAEBeQAAAHIAAAAG7AAAAAdSb2xlLCAxCXAAAAAJCQAAAAnvAAAACfAAAAAJ8QAAAAEO////Zv///wIAAAAG8wAAAARSb2xlAQz///9L////AAAAAAEBegAAAHIAAAAG9QAAABpFRUlDYXNlNjMzNzE2Nzk2NTg1MzEyNTAwNQlxAAAACQkAAAAJ+AAAAAn5AAAACfoAAAABBf///2b///8BAAAACb0AAAABA////0v///8AAAAAAQF7AAAAEgAAAAd8AAAAAAEAAAAEAAAAA/gBU3lzdGVtLkNvbGxlY3Rpb25zLkdlbmVyaWMuS2V5VmFsdWVQYWlyYDJbW1N5c3RlbS5TdHJpbmcsIG1zY29ybGliLCBWZXJzaW9uPTIuMC4wLjAsIEN1bHR1cmU9bmV1dHJhbCwgUHVibGljS2V5VG9rZW49Yjc3YTVjNTYxOTM0ZTA4OV0sW3NlbWJsZVdhcmUuUnVudGltZS5BU1BOZXQuU3VwcGxpZWRQYXJ0LCBzd1J1bnRpbWVBU1BOZXQsIFZlcnNpb249My41LjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1udWxsXV0BAv///7b///8G/wAAAAtDdXJyZW50VXNlcgkAAQAAAf/+//+2////BgIBAAAJU3RhZmZVc2VyCQMBAAAB/P7//7b///8J4QAAAAkGAQAAAfn+//+2////CeoAAAAJCQEAAAF/AAAATAAAAAH2/v//Zv///wEAAAAKCXEAAAAJhwAAAAYNAQAAC0xpc3RMaW1pdHMxAYIAAABMAAAAAfL+//9m////AQAAAAoJagAAAAmHAAAABhEBAAALTGlzdExpbWl0czIBhQAAAEwAAAAB7v7//2b///8BAAAACgltAAAABhQBAAAGUGVyc29uBhUBAAAPUGVyc29uTGlzdExpbWl0AYgAAABMAAAAAer+//9m////AgAAAAkXAQAACWkAAAAGGQEAAAdFRUlDYXNlCRkBAAABigAAAE4AAAAJGgEAAAAAAAABAAAAAYsAAABOAAAACRsBAAAAAAAADAAAAAGPAAAATgAAAAkaAQAAAAAAAAEAAAABkAAAAE4AAAAJHQEAAAAAAAAFAAAAAZMAAABOAAAACRoBAAAAAAAAAQAAAAGUAAAATgAAAAkfAQAAAAAAABAAAAABlwAAAE4AAAAJGgEAAAAAAAABAAAAAZgAAABOAAAACSEBAAAAAAAAIwAAABCbAAAAAQAAAAgJAQAAAAAAAAAHnwAAAAABAAAAAAAAAAQhc2VtYmxlV2FyZS5SdW50aW1lLkFTUE5ldC5Sb3dEYXRhAgAAAAegAAAAAAEAAABAAAAABCFzZW1ibGVXYXJlLlJ1bnRpbWUuQVNQTmV0LlJvd0RhdGECAAAACSIBAAAJIwEAAAkkAQAACSUBAAAJJgEAAAknAQAACSgBAAAJKQEAAAkqAQAACSsBAAAJLAEAAAktAQAACS4BAAAJLwEAAAkwAQAACTEBAAAJMgEAAAkzAQAACTQBAAAJNQEAAAk2AQAACTcBAAAJOAEAAAk5AQAACToBAAAJOwEAAAk8AQAACT0BAAAJPgEAAAk/AQAACUABAAAJQQEAAAlCAQAADR8HogAAAAABAAAABAAAAAQhc2VtYmxlV2FyZS5SdW50aW1lLkFTUE5ldC5Sb3dEYXRhAgAAAAlDAQAADQMHpAAAAAABAAAABAAAAAQhc2VtYmxlV2FyZS5SdW50aW1lLkFTUE5ldC5Sb3dEYXRhAgAAAAlEAQAADQMHpgAAAAABAAAABAAAAAQhc2VtYmxlV2FyZS5SdW50aW1lLkFTUE5ldC5Sb3dEYXRhAgAAAAlFAQAACUYBAAAJRwEAAAoHqAAAAAABAAAABAAAAAQhc2VtYmxlV2FyZS5SdW50aW1lLkFTUE5ldC5Sb3dEYXRhAgAAAAlIAQAACUkBAAAJSgEAAAlLAQAAB6oAAAAAAQAAAAQAAAAEIXNlbWJsZVdhcmUuUnVudGltZS5BU1BOZXQuUm93RGF0YQIAAAAJTAEAAAlNAQAADQIHrAAAAAABAAAAIAAAAAQhc2VtYmxlV2FyZS5SdW50aW1lLkFTUE5ldC5Sb3dEYXRhAgAAAAlOAQAACU8BAAAJUAEAAAlRAQAACVIBAAAJUwEAAAlUAQAACVUBAAAJVgEAAAlXAQAACVgBAAAJWQEAAAlaAQAACVsBAAAJXAEAAAldAQAACV4BAAAJXwEAAAlgAQAACWEBAAAJYgEAAAljAQAACWQBAAAJZQEAAAlmAQAACWcBAAAJaAEAAAlpAQAADQQQsAAAACIAAAAICREAAAAAAAAACA0AgHkxl0HLCAZqAQAADEJ1enogdGhlIG1hbgZrAQAAFEJTYyAoRW5nKSBFbGVjdHJpY2FsDQYICOgDAAAICAAAAAAIAQAIAQANBQgIBwAAAAgIEwAAAAgIBAAAAAgICAAAAAgIAgAAAAoICAQAAAAICAIAAAAICAEAAAAICAkAAAANBRCxAAAAIgAAAAgJEQAAAAAAAAAIDQCAeTGXQcsICWoBAAAJawEAAA0GCAjoAwAACAgAAAAACAEACAEADQUICAcAAAAICBMAAAAICAQAAAAICAgAAAAICAIAAAANAggIAgAAAAgIAQAAAAgICQAAAA0FELIAAAAxAAAACAIGCAIGCAIFCAIFCAIECAIECAIECAIFCAIFCAIFCAIFCAIFCAIECAIECAIFCAIFCAIFCAIFCAIBCAIFCAIFCAIFCAIFCAIFCAIFCAIFCAIFCAIFCAIFCAIFCAIFCAIFCAIFCAIFCAICCAIBCAIACAICCAIDCAIBCAIBCAIBCAIBCAIBCAIACAIBCAIBCAIBCAIBELkAAAAiAAAADQoICAAAAAAICAAAAAAIAQAIAQANFBC6AAAAIgAAAA0iELsAAAAxAAAACAIHCAIHCAIFCAIFCAIECAIECAIECAIFCAIFCAIFCAIFCAIFCAIECAIECAIFCAIFCAIFCAIFCAIBCAIFCAIFCAIFCAIFCAIFCAIFCAIFCAIFCAIFCAIFCAIFCAIFCAIFCAIFCAIFCAIDCAIBCAIACAICCAIDCAIBCAIBCAIBCAIBCAIBCAIACAIBCAIBCAIBCAIBEMIAAAAEAAAACAkPAAAAAAAAAAoGbgEAAAlNeVNpZy5KUEcICAcAAAAQwwAAAAQAAAAICQ8AAAAAAAAACgluAQAACAgHAAAAEMQAAAAGAAAACAIGCAIBCAIFCAIFCAICCAICEMsAAAAKAAAACAkHAAAAAAAAAAoGbwEAAAg0MjNQUjkDEwoICAUAAAAICAEAAAAKCAgIAAAADQIQzAAAAAoAAAAICQcAAAAAAAAACglvAQAACggIBQAAAAgIAQAAAAoICAgAAAANAhDNAAAADgAAAAgCBggCBwgCBQgCBQgCBQgCBQgCBQgC
</div>

<script type="text/javascript">
//<![CDATA[
var theForm = document.forms['form1'];
if (!theForm) {
    theForm = document.form1;
}
function __doPostBack(eventTarget, eventArgument) {
    if (!theForm.onsubmit || (theForm.onsubmit() != false)) {
        theForm.__EVENTTARGET.value = eventTarget;
        theForm.__EVENTARGUMENT.value = eventArgument;
        theForm.submit();
    }
}
//]]>
</script>

<!--Script to confirm btnEditDocument Action--> 
```

我没有包括所有内容。你明白了。

那么，我的代码有什么问题，如何防止这种情况发生？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-03T17:26:04.677

你需要打电话`Response.End`。

```
Public Sub DownloadBlob(ByVal Blob As Byte(), ByVal FileName As String, ByVal Response As HttpResponse)
    Response.AddHeader("content-disposition", String.Format("attachment;filename={0}", FileName.Replace(" ", "_")))
    Response.ContentType = "text/plain"
    Response.BinaryWrite(Blob)
    Response.End()
End Sub 
```

另请注意，我对 ContentType 的设置略有不同。

# 64-bit - 64位处理器有什么优势？

> ID：607322
> 
> 赞同：36
> 
> 时间：2009-03-03T17:25:18.750
> 
> 标签：64-bit, cpu

显然，64 位处理器具有 64 位地址空间，因此您可以使用超过 4 GB 的 RAM。将相同的程序编译为 64 位并在 64 位 CPU 上运行是否有任何其他优势可能实际上有益于那些*不是*巨大内存占用的程序？

我问的是一般的 CPU，特别是与 Intel 兼容的 CPU。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-03-03T17:30:26.150

[Wikipedia 上](http://en.wikipedia.org/wiki/EM64T#Intel_64)有一篇很棒的文章，介绍了 64 位 Intel/AMD cpus 与 32 位版本的区别和优势。它应该包含您需要的所有信息。

一些主要区别是：

*   16 个通用寄存器而不是 8 个
*   其他 SSE 寄存器
*   防止缓冲区溢出攻击的无执行 (NX) 位

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-03-03T18:37:35.427

64 位 CPU 的主要优点是能够拥有 64 位指针类型，允许大于 4GB 的虚拟地址范围。在 32 位 CPU 上，指针大小（通常）为 32 位宽，允许指针引用 2^32 (4,294,967,296) 个离散地址之一。这允许程序在内存中创建一个最大为 4GB 的数据结构，并通过简单地取消引用指针来解析其中的任何数据项。现实比这稍微复杂一些，但就本次讨论而言，这是一个足够好的观点。

64 位 CPU 具有 64 位指针类型，可以引用具有 2^64 (18,446,744,073,709,551,616) 个离散地址或 16 艾字节空间的任何地址。像这样的 CPU 上的进程可以（理论上）通过简单地取消引用指针（在指针中保存的地址处查找数据）来构造和逻辑寻址高达 16 艾字节大小的数据结构的任何部分。

这允许 64 位 CPU 上的进程处理比 32 位 CPU 上的进程更大的数据集（受物理内存限制）。从大多数 64 位系统用户的角度来看，主要优势是应用程序能够处理内存中更大的数据集。

除此之外，您可能会得到一个原生的 64 位整数类型。一个 64 位整数使用 64 位类型（例如 C 语言）进行算术或逻辑运算`long long`比使用两个 32 位运算实现的更快。浮点运算不太可能受到显着影响，因为大多数现代 32 位 CPU 上的 FPU 本机支持 64 位`double`浮点类型。

任何其他性能优势或增强的功能集都是特定芯片实现的功能，而不是具有 64 位 ALU 的系统所固有的功能。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-03T17:27:10.727

这篇文章可能会有所帮助：

[http://www.softwaretipsandtricks.com/windowsxp/articles/581/1/The-difference-between-64-and-32-bit-processors](http://www.softwaretipsandtricks.com/windowsxp/articles/581/1/The-difference-between-64-and-32-bit-processors)

这个有点离题，但如果您打算使用 Ubuntu，可能会有所帮助：

[http://ubuntuforums.org/showthread.php?t=368607](http://ubuntuforums.org/showthread.php?t=368607)

下面的 pdf 包含详细的技术规范：

[http://www.plmworld.org/access/tech_showcase/pdf/Advantage%20of%2064bit%20WS%20for%20NX.pdf](http://www.plmworld.org/access/tech_showcase/pdf/Advantage%20of%2064bit%20WS%20for%20NX.pdf)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-03T18:21:03.080

轻微修正。在 32 位 Windows 上，该限制约为 3GB 的 RAM。我相信剩余的 1GB 地址空间是为硬件保留的。您仍然可以安装 4GB，但只能访问 3 个。

就我个人而言，我认为任何在以前的生活中没有愉快地在 8 位操作系统上使用 16K 生活的人都应该小心不要对今天开始成为猪的*一些*软件进行诽谤。事实是，随着我们的资源变得更加丰富，我们的期望也在增加。不久之后 3GB 将开始显得小得离谱。在那一天之前，坚持使用您的 32 位操作系统并保持快乐。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-03T17:31:15.057

由于 32 位计算的指令级并行性，速度提高了大约 1-3%。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-18T06:46:54.223

只是想添加一些关于 64 位 CPU 的优缺点的信息。[https://blogs.msdn.microsoft.com/joshwil/2006/07/18/should-i-choose-to-take-advantage-of-64-bit/](https://web.archive.org/web/20170425125539/https://blogs.msdn.microsoft.com/joshwil/2006/07/18/should-i-choose-to-take-advantage-of-64-bit/)

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2013-10-07T10:20:36.653

32 位处理器和 64 位处理器之间的主要区别在于它们的运行速度。64 位处理器可以提供用于家庭计算的双核、四核和六核版本（即将推出八核版本）。多核允许增加处理能力和更快的计算机操作。在大多数情况下，需要许多计算才能运行的软件程序在多核 64 位处理器上运行得更快。需要注意的是，即使 Windows 操作系统是 64 位版本，64 位计算机仍然可以使用基于 32 位的软件程序。

32 位处理器和 64 位处理器之间的另一个重大区别是支持的最大内存 (RAM) 量。32 位计算机最多支持 3-4GB 的内存，而 64 位计算机可以支持超过 4 GB 的内存量。这对于用于图形设计、工程设计或视频编辑的软件程序很重要，其中执行许多计算以渲染图像、绘图和视频片段。

需要注意的一点是 3D 图形程序和游戏不会从切换到 64 位计算机中受益很多（如果有的话），除非程序是 64 位程序。32 位处理器足以满足为 32 位处理器编写的任何程序。在电脑游戏的情况下，通过升级视频卡而不是获得 64 位处理器，您将获得更多的性能。

最后，64 位处理器在家用电脑中变得越来越普遍。由于价格更便宜，而且现在越来越多的用户使用 64 位操作系统和程序，大多数制造商都使用 64 位处理器制造计算机。计算机零件零售商提供的 32 位处理器越来越少，而且很快可能根本不提供任何产品。

# visual-studio - Visual Studio，MS 构建

> ID：607337
> 
> 赞同：1
> 
> 时间：2009-03-03T17:28:54.950
> 
> 标签：visual-studio, msbuild

我正在尝试在批处理文件中构建多个 .sln 文件。到目前为止一切都很好。我正在尝试在批处理文件中添加检查，因此如果错误数大于 0，则批处理文件将停止执行并且不会构建下一个 .sln 文件。我怎样才能做到这一点？基本上是这样的：

msbuild test.sln（检查构建错误 > 0 停止） msbuild test2.sln

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-03T17:34:08.700

MSBUILD 将设置 ERRORLEVEL，因此类似于：

```
msbuild test.sln
IF NOT ERRORLEVEL 0 exit 1 
```

编辑：显然它应该是：

```
msbuild test.sln
IF ERRORLEVEL 1 exit 1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-07T21:35:30.363

在我看来，在这里使用自定义 msbuild 文件并将 msbuild 任务与您的一组解决方案一起使用要容易得多。有关详细信息，请参见[此处](http://msdn.microsoft.com/en-us/library/z7f65y0d.aspx)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T17:35:07.387

```
msbuild.exe test.sln
if errorlevel 1 goto :errors

msbuild.exe test2.sln
if errorlevel 1 goto :errors

:: ...

:: Everything was fine.
echo Build completed without errors.
goto :eof

:error
echo Build failed. 
```

# ant - 过滤使用 refid 引用的文件集

> ID：607338
> 
> 赞同：20
> 
> 时间：2009-03-03T17:29:01.473
> 
> 标签：ant, fileset

我有一个文件集（从 Maven Ant 任务返回），它包含我需要重新打包的所有 jar。此文件集由 refid 引用。我只想包括我们自己的罐子，所以我想过滤它。但是如果使用 refid，Ant 文件集不支持任何进一步的属性或嵌套标记。

例如，如果文件集是：

```
org.foo.1.jar
org.foo.2.jar
log4j.jar 
```

我想要一个仅包含的文件集

```
org.foo*.jar 
```

我该怎么做？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-03-16T09:16:42.497

尝试使用[`restrict`](http://ant.apache.org/manual/Types/resources.html#restrict)资源集合，您可以像`fileset`在任何使用资源集合来选择要操作的文件组的任务中一样使用它。

例如，对于`fileset`通过 id 引用的从 Maven 任务返回的，`dependency.fileset`您可以声明一个`restrict`资源集合，如下所示：

```
<restrict id="filtered.dependencies">
    <fileset refid="dependency.fileset"/>
    <rsel:name name="org.foo*.jar"/>
</restrict> 
```

请注意，您必须声明资源选择器命名空间，因为它不是内置 Ant 命名空间的一部分：

```
<project xmlns:rsel="antlib:org.apache.tools.ant.types.resources.selectors">
    ...
</project> 
```

从这里您可以引用您的`restrict`资源集合，其方式与引用您的`fileset`. 例如，要创建过滤后的文件集的备份：

```
<copy todir=".">
    <restrict refid="filtered.dependencies"/>
    <globmapper from="*" to="*.bak"/>
</copy> 
```

当然，`restrict`如果您愿意，您可以内联您的资源集合：

```
<copy todir=".">
    <restrict>
        <fileset refid="dependency.fileset"/>
        <rsel:name name="org.foo*.jar"/>
    </restrict>
    <globmapper from="*" to="*.bak"/>
</copy> 
```

查看关于[资源集合](http://ant.apache.org/manual/Types/resources.html#collection)的 Ant 文档以获取更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T19:47:58.953

我认为您需要为此编写一个蚂蚁任务。不过，它们很容易编写。

见[http://ant.apache.org/manual/develop.html#writingowntask](http://ant.apache.org/manual/develop.html#writingowntask)

在您的任务中，您需要调用 getProject() 并要求它为您提供文件集、遍历它并创建一个新文件集。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T20:01:57.190

如果您使用的是最新版本的 Ant 和 JDK，例如 Ant 1.7 和 JDK 6，那么您可以使用[可选的脚本任务](http://ant.apache.org/manual/Tasks/script.html)来执行您想要的操作。（早期版本也可能有效。）我链接到的页面，如果您向下滚动到文本“目标是列出文件大小”，那么您将看到一个创建文件集的示例脚本。

这不适合胆小的人，您自己编写的自定义 ant 任务可能会更灵活。但我想指出这个选项。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-16T09:03:51.450

我将 Ant 与[Ivy](http://ant.apache.org/ivy/)一起使用。在 Ivy 的帮助下，可以过滤依赖项以进行检索，在 ivy.xml 中使用以下代码：

```
<dependency name="Project1" rev="latest.integration" transitive="true" conf="modlibs">
<exclude name="${exclusionRegEx}" matcher="regexp" />
</dependency>
<dependency name="Project2" rev="latest.integration" transitive="false" conf="modules"/> 
```

也许快速浏览一下常春藤源会有所帮助？

# asp.net-mvc - 在 ASP.NET MVC 站点上安装 OpenID 时出现问题

> ID：607340
> 
> 赞同：1
> 
> 时间：2009-03-03T17:29:30.690
> 
> 标签：asp.net-mvc, openid, dotnetopenauth

我正在尝试将 openID 安装到我使用 ASP.NET MVC 的网站项目中，特别是使用 Yahoo

雅虎一直给我这个： **“警告：本网站尚未确认其与雅虎的身份，可能是欺诈性的。除非您确定它是合法的，否则不要与本网站共享任何个人信息。”**

但是我遵循了设置程序我有一个 Yardis 文档设置，并且在我的领域 URI 的标题中有以下内容

```
<meta http-equiv="X-XRDS-Location" content="http://www.daimokuchart.com/yadis" /> 
```

我的Yardis文件如下

```
<?xml version="1.0" encoding="UTF-8"?>
<xrds:XRDS
    xmlns:xrds="xri://$xrds"
    xmlns:openid="http://openid.net/xmlns/1.0"
    xmlns="xri://$xrd*($v*2.0)">
    <XRD>
        <Service priority="1">
            <Type>http://specs.openid.net/auth/2.0/return_to</Type>
            <URI>http://www.daimokuchart.com/Users/Authenticate</URI>
        </Service>
    </XRD>
</xrds:XRDS> 
```

这变得相当令人沮丧，因为我不确定我还能错过什么。

**注意：**此示例中给出的域此时实际上并不存在......但是，我正在一个实时站点上对其进行测试，因为我们尚未完成站点开发，所以目前我无法提供 URL。

**更新 3/4**我确实找到了一个 Yadis 测试站点，它通过了，所以问题是雅虎由于某种原因没有发现它。

**更新 3/5**仍然没有运气我和某人谈过，他们这么说

需要在我的根网址中，所以我这样做了，现在雅虎报告该网站有问题......但不确定问题是什么......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-10T00:34:55.877

检查您的 openid.return_to 参数是否在您的 YADIS/XRDS 文档中找到，包括匹配的大小写。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T18:00:12.317

我的第一个想法是，当我尝试浏览时，您的领域 URL ( [http://www.daimokuchart.com/yadis](http://www.daimokuchart.com/yadis) ) 似乎重定向到[http://blog.daimokuchart.com/yadis 。](http://blog.daimokuchart.com/yadis)以下文章（链接自 Yahoo 的 OpenID 常见问题解答）提到域 URI 无法重定向：

[为什么选择雅虎！表示您的 OpenID 站点的身份未得到确认](http://blog.nerdbank.net/2008/06/why-yahoo-says-your-openid-site.html)

[雅虎！OpenID - 常见问题](http://developer.yahoo.com/openid/faq.html)

# event-log - 如何在没有 EventMessageFile 的情况下读取 Windows 事件日志？

> ID：607345
> 
> 赞同：3
> 
> 时间：2009-03-03T17:30:04.980
> 
> 标签：event-log, eventlog-source, formatmessage, readeventlog

我有读取 Windows 事件日志的代码。它使用 OpenEventLog、ReadEventLog 并获取事件源和事件 ID。然后它在下面查找源

```
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Eventlog\Application 
```

键，根据其中列出的内容加载适当的 DLL `EventMessageFile`，最后用于`FormatMessage`将事件字符串与消息 DLL 内容合并以获得最终的事件消息文本。这是推荐的方法，虽然有点痛苦，但效果很好。

直到...我去查找源并发现它没有一个`EventMessageFile`，而是一个`ProvideGuid`条目。这似乎是一种新方式（它们出现在 Vista 和 Windows 2008 上）。Uggh - 没有任何东西可以传递给 FormatMessage 来查找消息文本并合并到数据字符串中

:(

在注册表中搜索 guid 确实会导致对其他文件的引用（在 HTTP 源的情况下为 http.sys），但我永远无法获得完整的消息文本。我必须使用这些`EvtOpenSession`API 吗？我希望不会，因为我已经`EVENTLOGRECORD*`调用了 to `ReadEventLog`，并且该软件需要在`EvtOpenSession`不受支持的 Windows 2003 上运行（仅在 Vista 和 Windows 2008 上可用）。注意：Vista 上的某些源具有 ProviderGUID，而另一些具有 EventMessageFile，因此旧方法仍然可行。

因此，我所追求的是一种查看 ProviderGuid 并获取需要传递给 FormatMessage 以显示完整事件日志消息文本的 DLL 的方法。

感谢您的任何意见

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T17:50:51.670

有用于读取/扩展事件日志条目的 Win32 API。

请参阅 MSDN： http: [//msdn.microsoft.com/en-us/library/aa385780 (VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa385780(VS.85).aspx)

其他任何东西，您都可能会发现补丁有问题，更不用说服务包或新版本了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-29T09:02:07.323

Richard 链接到的 API 用于 Vista/Server 2K8 中引入的新型 Eventing 系统（代号为 Crimson，有时称为 Manifest Based Providers）。这个新系统的工件之一是使用这些日志的新 API，另一个是使用这个新框架产生事件的某些 EventSources 的 ProviderGuid 键。

我认为您应该稍后使用 Windows Vista 上的功能来使用这些日志，它应该为您处理工作。您可以使用 EvtFormatMessage 方法来格式化字符串。我相信这些 API 也会读取“经典”提供者产生的事件。

如果您从 .NET 应用程序使用这些消息，则可以使用 System.Diagnostics.Eventing.Reader 命名空间中的类型，该命名空间在 .NET 3.5 中引入。

# php - Facebook 连接和第三方 cookie？

> ID：607346
> 
> 赞同：5
> 
> 时间：2009-03-03T17:30:25.667
> 
> 标签：php, cookies, facebook

当“第三方”cookie 被禁用时，让用户保持登录状态的最佳方式是什么？我目前有一个 Facebook 连接应用程序（仅在 PHP 中），当我在 Firefox 中选中它时效果很好，但在未选中时重定向到我的登录页面。即使 Facebook 自己的示例应用程序（[therunaround](http://www.somethingtoputhere.com/therunaround/index.php)）也有同样的问题，所以我想知道是否没有办法解决这个问题。

**编辑：**

@codege3k

尝试了一堆 p3p 标头。到目前为止没有骰子。我有一个登录页面，当用户“连接”时重定向到我的索引......第一次加载，我能够从中获取用户 ID，`get_loggedin_user()`但是当我刷新时，该函数返回 null。cookie 存在，当我返回登录页面并再次单击连接时，它不会提示我登录，所以我知道它部分工作。在 Firefox 中打开“第三方 cookie”后，它就像一个魅力。

**编辑：**

如果第三方 cookie 不受广泛支持，那么在用户登录的上下文中处理 facebook 连接的最佳方法是什么？我是否应该只使用有效的初始登录并为我自己的网站设置一个本地 cookie 并使用它而不是每次都检查 facebook 状态？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-03T19:35:12.183

好的，推广会议似乎有效。

```
$fbUserId = self::$facebook->get_loggedin_user();
if ($fbUserId)
{
     self::$facebook->promote_session();
     return $fbUserId;
} 
```

**编辑：**

因此，这会在每个请求上获取会话，但本质上，必须启用第三方 cookie，Facebook Connect 才能按预期工作。从他们的文档中：

> 用户的浏览器必须设置为接受第 3 方 Cookie，以便在点击之间保持连接。

来源：[http ://wiki.developers.facebook.com/index.php/Logging_In_And_Connecting](http://wiki.developers.facebook.com/index.php/Logging_In_And_Connecting)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T17:32:27.003

我对 3rd 方 cookie 也有类似的问题。检查这个[问题](https://stackoverflow.com/questions/540926/ie7-iframe-blank-page)，看看它是否解决

可以通过添加 p3p 标头来解决。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T02:30:48.767

那么 P3P 是否可以为不接受 3rd 方 cookie 的浏览器解决此问题？[我在http://bugs.developers.facebook.com/show_bug.cgi?id=5009](http://bugs.developers.facebook.com/show_bug.cgi?id=5009)评论了一个 FB 错误。

# c - C 数组和完整列表

> ID：607348
> 
> 赞同：1
> 
> 时间：2009-03-03T17:30:45.150
> 
> 标签：c, arrays

/edit：感谢到目前为止的帮助，但是我没有任何解决方案来获取示例输入并提供示例输出。我的描述不是很清楚，抱歉。

我有一个由二进制数据组成的数组。我想要做的是确定每个完整的 1 或 0 段有多长。

假设我有这些数据：

```
0111010001110 
```

`binaryArray`在我需要转换为的数组中：

```
0100110 
```

存储在`nwArray`where`0`表示窄（小于 3 位长）和`1`表示宽（>3 位长）。我不关心二进制值，而是关心每个组件的长度。我不确定这种解释是否合理。

这就是我所拥有的；它不起作用，我明白为什么，但我想不出一个好的解决方案。

```
for(x=0;x<1000;x++){
    if(binaryArray[x]==binaryArray[x+1]){
        count++;
        if(count>=3){
            nwArray[y]=1;
            y++;
            count=0;
        }
    }else{
        if(barcodeArray[x]){
            nwArray[y]=0;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-03T17:45:05.350

这行吗？

```
int count = 0;
for (x=0; x<1000;x++)
{
    if (binaryArray[x] != binaryArray[x+1]) 
    {
        if (count < 3)
           nwArray[y]=0;
        else 
           nwArray[y]=1;

        y++;
        count = 0;
    }
    else
        count++;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-03T17:35:14.017

您遇到的一个问题是您过早地将 count 与 3 进行比较。等到您看到比特流发生变化。尝试一个while循环，直到位翻转然后比较计数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T18:20:50.117

修改[了@MikeW 的答案](https://stackoverflow.com/questions/607348/c-arrays-and-unbroken-lists/607398#607398)：

```
int count = 0;
int nwSize = 0;    
const int ilast = SIZEOF(binaryArray) - 1;
for (int i = 0; i <= ilast; ++i)
  if (i == ilast || binaryArray[i] != binaryArray[i+1]) {
    nwArray[nwSize++] = (count > 1); /* true for '1110'; false for '110' */
    count = 0;
  }
  else
    ++count;
assert(count == 0); 
```

# objective-c - Objective C 范围问题

> ID：607357
> 
> 赞同：0
> 
> 时间：2009-03-03T17:33:02.320
> 
> 标签：objective-c, function, scope, methods

我有以下正常工作的 Obj C 函数：

```
 NSString* myfunc( int x )
 {
    NSString *myString = @"MYDATA";

    return myString;        
 } 
```

但是，如果我添加代码来更新 UIImage 编译将失败，并且 image1 是未知的。image1 是有效的：它在 .h 中设置，合成并且该确切的代码行在此函数下方的方法中工作。只有当我将代码行移至此函数时，它才会失败。

```
 NSString* myfunc( int x )
 {
    NSString *myString = @"MYDATA";
    image1.image = [UIImage imageNamed:@"image1.png"];  // fails to compile
    return myString;        
 } 
```

不应该在这个特定的 .m 文件中的任何地方识别 image1 吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-03T17:39:21.883

`myfunc`这里是 C 风格的函数，而不是类范围内的 Objective-C 方法，所以你看不到你的实例变量 image1。

您想将其声明为方法：

```
- (NSString *)myFuncWithParam:(int)x
{
  ...
} 
```

# javascript - JS：从具有其他域源的其他框架中删除脚本

> ID：607365
> 
> 赞同：0
> 
> 时间：2009-03-03T17:35:34.467
> 
> 标签：javascript

有没有办法从其他域的框架中删除站点中的脚本？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-03T17:45:04.117

不可以。some-origin 策略意味着如果页面中的代码来自另一个域，则页面中的代码无法访问框架内页面的 DOM。

如果框架内的页面是您控制的页面（即两个域都是您的），我猜您可以设置该页面，以便如果将某个查询字符串添加到 URL，脚本将在服务器上删除 -边。但我猜这不是你控制的页面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T17:47:32.723

不可以，但您可以使用代理从其他域加载内容并从您自己的域重新提供（删除脚本）。我想你在谈论你无法控制的内容。（请记住，这可能是道德的，也可能不是道德的，具体取决于内容许可。）

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-03-03T18:02:27.397

[IE中有](http://msdn.microsoft.com/en-us/library/ms534622.aspx)：

```
<iframe security="restricted" /> 
```

但它通常被认为是一种损坏的安全机制，你当然不能依赖它。

# java - Clojure 中的编译问题

> ID：607368
> 
> 赞同：7
> 
> 时间：2009-03-03T17:37:14.883
> 
> 标签：java, clojure, compilation, classpath

我一直在尝试在 Clojure 中编译一个非常简单的 test.clj，但没有成功。我在[Clojure Google Group上有一个](http://groups.google.com/group/clojure)[帖子](http://groups.google.com/group/clojure/browse_thread/thread/1adda2c8053f304d#)，上面有几个回复，但没有任何帮助。快速总结一下，这是我的 clojure 文件：

```
(ns test.test
    (:gen-class))

(defn -main
    [gre]
    (println (str "Hello " gre))) 
```

基本上它是[Clojure 文档](http://clojure.org/compilation)中提供的示例文件。

我已将此文件适当地放在 中`clojure/src/test/test.clj`，并且应该能够使用 进行编译`(compile 'test.test)`，但我不断收到错误消息：

```
java.io.IOException：系统找不到指定的路径（test.clj:1）
```

这让我相信这是一个类路径问题。我尝试使用[Clojure 文档](http://clojure.org/repl_and_main)中给出的所有标准命令以及线程的最新建议来运行 Clojure `java -classpath .;src;classes;clojure.jar clojure.main`。

如果有帮助，我的文件系统如下所示：

```
-+-clojure
 +-classes/
 +-+-src/
 | |-+-test/
 | | \-test.clj
 +-\-test.clj
 +-test.clj
 +-clojure.jar 
```

PS 我在 Vista Ultimate 上运行，所以*可能*是权限问题，但我检查了权限，没有发现任何问题。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-03T18:52:28.900

在 Windows 上编译*test.clj*的控制台输出：

```
C:\clojure>dir /b/s
C:\clojure\classes
C:\clojure\src
C:\clojure\src\test
C:\clojure\src\test\test.clj

C:\clojure>java -cp c:\dev\clojure.jar;.\src;.\classes clojure.lang.ReplClojure
user=> (compile 'test.test)
test.test
user=> 
```

生成的类文件在类目录中。

另外，请注意您在*main*中缺少右括号。修正版：

```
(ns test.test
    (:gen-class))

(defn -main
    [gre]
    (println (str "Hello " gre))) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-10-01T09:51:06.250

```
 C:\clojrue\java -cp .\src;.\classes;clojure.jar 
    -Dclojure.compile.path=classes clojure.lang.Compile test.test 
```

# .net - WPF：如何设置用户控件显示的对话框的所有者窗口？

> ID：607370
> 
> 赞同：60
> 
> 时间：2009-03-03T17:37:22.887
> 
> 标签：.net, wpf, vb.net, dialog, user-controls

我有一个包含这三种类型的 WPF 应用程序......

*   主窗口
*   用户控制扎克
*   窗口模式

UserControlZack1 位于我的 WindowMain ...

```
<Window x:Class="WindowMain"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:ProjectName"
        ...
        Name="WindowMain">
    <Grid>
        ...
        <local:UserControlZack x:Name="UserControlZack1" ... />
        ...
    </Grid>
</Window> 
```

UserControlZack1 显示一个 WindowModal 对话框...

```
部分公共类 UserControlZack

   ...

    私有子 SomeButton_Click(...)
        '实例化对话框并以模态方式打开...
        暗箱 As WindowModal = New WindowModal()
        框。所有者 = ?????
        box.ShowDialog()
        '如果对话框被接受，则处理用户输入的数据...
        如果 (box.DialogResult.GetValueOrDefault = True) 那么
            _SomeVar = box.SomeVar
            ...
        万一
    结束子

结束类

```

如何将 box.Owner 设置为正确的 Window，即我正在运行的 WindowMain 实例？

我不能使用`box.Owner = Me.Owner`，因为“'Owner' 不是 'ProjectName.UserControlZack' 的成员。”

我不能使用`box.Owner = Me.Parent`，因为它返回一个网格，而不是窗口。

我不能使用`box.Owner = WindowMain`，因为“'WindowMain' 是一种类型，不能用作表达式。”

* * *

## 回答 #1

> 赞同：135
> 
> 时间：2009-03-04T08:11:14.940

尝试使用

```
.Owner = Window.GetWindow(this) 
```

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2009-03-04T08:08:09.113

要获得您的控件所在的顶级窗口，假设有一个：

```
(Window)PresentationSource.FromVisual(this).RootVisual 
```

获取主窗口：

```
Application.Current.MainWindow 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2011-10-03T14:28:44.183

```
MyWpfDialog dialog = new MyWpfDialog();

//remember, this is WinForms UserControl and its Handle property is
//actually IntPtr containing Win32 HWND.

new System.Windows.Interop.WindowInteropHelper(dialog).Owner = this.Handle;

dialog.ShowDialog(); 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-03T17:51:58.640

更新以尝试从评论中帮助 Greg。该命令适用于主窗口菜单、用户控件中的按钮和用户控件中的上下文菜单。

我会用命令来做。所以有一个类 Commands.cs 类似：

```
public static class Commands
{
    public static RoutedUICommand TestShowDialogCommand = new RoutedUICommand("Test command", "TestShowDialog", typeof(Commands));
} 
```

在您的主窗口中注册这些：（您不需要 canshow 它默认为 true）

```
 public Window1()
    {
        InitializeComponent();

        CommandManager.RegisterClassCommandBinding(typeof(System.Windows.Controls.Control),
            new CommandBinding(Commands.TestShowDialogCommand, ShowDialogCommand, CanShowDialogCommand));
    }

    private void ShowDialogCommand(object sender, ExecutedRoutedEventArgs e)
    {
        var box = new Window();
        box.Owner = this;
        box.ShowDialog();

    }

    private void CanShowDialogCommand(object sender, CanExecuteRoutedEventArgs e)
    {
        e.CanExecute = true;
    } 
```

这是我的主窗口的 xaml：

```
<Window x:Class="WpfApplication1.Window1"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
xmlns:WpfApplication1="clr-namespace:WpfApplication1"
Title="Window1" Height="300" Width="322">
<Grid>
    <StackPanel>
        <Menu>
            <MenuItem Header="Test">
                <MenuItem Header="ShowDialog" Command="{x:Static WpfApplication1:Commands.TestShowDialogCommand}"/>
            </MenuItem>
        </Menu>
        <WpfApplication1:BazUserControl />
    </StackPanel>
</Grid>
</Window> 
```

这是我的用户控件的 xaml（仅默认代码）

```
<UserControl x:Class="WpfApplication1.BazUserControl"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
xmlns:WpfApplication1="clr-namespace:WpfApplication1"
Height="300" Width="300">
<Grid>
    <StackPanel>
        <Button Command="{x:Static WpfApplication1:Commands.TestShowDialogCommand}" Content="ClickMe" ></Button>
        <TextBox>
            <TextBox.ContextMenu>
                <ContextMenu>
                    <MenuItem Header="ShowDialog" Command="{x:Static WpfApplication1:Commands.TestShowDialogCommand}" />
                </ContextMenu>
            </TextBox.ContextMenu>
        </TextBox>
    </StackPanel>
</Grid>
</UserControl> 
```

你可以更进一步，在控制器类中处理命令，让它更像 MVC。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-03T17:44:04.510

我通过我的 XAML 一直爬回它来让它工作......

```
box.Owner = DirectCast(DirectCast(DirectCast(Me.Parent, Grid).Parent, Grid).Parent, Window)

```

但这似乎很不雅。有没有更好的办法？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-03T17:47:34.063

将窗口的名称更改为 WindowMain1 或其他内容，并将所有者设置为该名称怎么样？

# asp.net - 内网 Web 应用程序安全

> ID：607372
> 
> 赞同：1
> 
> 时间：2009-03-03T17:37:44.883
> 
> 标签：asp.net, security, intranet

使用 Active Directory / Windows 集成身份验证是给定的。从开发的角度来看，使用它的最佳方式是什么？

是通过配置吗？

```
<location path="SecurePage.aspx">
    <system.web>
        <authorization>
            <allow roles="MyDomain\My Secure Users" />
            <deny users="*" />
        </authorization>
    </system.web>
</location> 
```

是通过[代码](http://msdn.microsoft.com/en-us/library/system.security.principal.windowsprincipal.isinrole.aspx)吗？

```
User.IsInRole(@"MyDomain\My Secure Users"); 
```

将其存储在数据库中是个好主意吗？那么授予新用户/组可以通过自定义应用程序完成吗？（我问这个是因为这是现状。）这个想法有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T17:52:20.667

没有理由不能同时使用两者。通过 web.config 进行操作非常简单有效。始终在角色级别操作。您将代码版本用于配置不够用的场景，以及当您想要显示/隐藏 UI 的特定部分时（也有此控件的版本）。

**更新 1：**您已经支持角色，所以我假设数据库实际上是将角色映射到功能。Asp.net 内置支持和它支持的扩展点是在角色级别。如果您真的需要完全动态，那么您需要在代码级别进行检查（.config 对角色进行操作）。这是需要额外努力的问题，因此它更多地取决于系统的大小。在大多数情况下，坚持角色就足够了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T17:52:56.827

我个人更喜欢声明式方法（即基于位置的 web.config 方法）。这使得在必要时更容易进行更改，而无需重新部署代码。

在任何情况下，我都不建议像您在示例中那样使用静态字符串调用 User.IsInRole() ；如果您的身份验证没有更改，请使用 web.config 声明性方法。

走您在上一段中建议的路线非常好，但我只建议您的身份验证信息可能经常更改的情况，即 CMS 应用程序或类似的应用程序。

简而言之，我认为这个主题没有“最佳实践”。这真的取决于应用程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T17:41:51.800

如果它不会有太大变化，请使用 web.config。

如果要更改很多，则使用代码方法，但使用数据库使其易于修改。

更多的是对编码实践的一般答案，而不是与安全性有关。

# php - 有什么方法可以知道 php 脚本是否在 cli 模式下运行？

> ID：607373
> 
> 赞同：10
> 
> 时间：2009-03-03T17:38:09.283
> 
> 标签：php, command-line-interface

... 或者反过来，有没有办法知道 php 脚本是否在 Web 服务器中运行？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-03-03T17:43:55.087

[http://www.php.net/manual/en/function.php-sapi-name.php](http://www.php.net/manual/en/function.php-sapi-name.php)

```
function is_cli()
{
    return php_sapi_name() === 'cli';
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-03T17:41:50.270

通常，在 CLI 模式下运行时，将设置超全局变量`$argv`和`$argc`，并且其中的许多典型内容`$_SERVER`（例如请求方法）将不可用。此外，还将设置预定义的控制台流，`STDIN`例如和`STDOUT`。`STDERR`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-03T17:42:21.707

您可以检查 $_SERVER 变量...例如：

```
$_SERVER['SERVER_ADDR'] 
```

如果它不是通过网络服务器执行的，这将是空的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-03T17:55:34.810

我写了一个只包含这一行的小 php 脚本：

```
print_r($_SERVER); 
```

当我在命令行中执行它时，这是我输出的一部分：

```
rascher@eggs:~$ php test.php 
Array
(
    [TERM] => xterm
    [SHELL] => /bin/bash
    [SSH_CLIENT] => 192.168.1.104 57547 22
    [SSH_TTY] => /dev/pts/1
    [USER] => rascher
    [LS_COLORS] => no=00:fi=00:di=01;34:ln=01;36:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:su=37;41:sg=30;43:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arj=01;31:*.taz=01;31:*.lzh=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.gz=01;31:*.bz2=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.jpg=01;35:*.jpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.avi=01;35:*.fli=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.flac=01;35:*.mp3=01;35:*.mpc=01;35:*.ogg=01;35:*.wav=01;35:
    [MAIL] => /var/mail/rascher
    [PATH] => /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games
    [PWD] => /home/rascher
    [LANG] => en_US.UTF-8
    [HISTCONTROL] => ignoreboth
    [SHLVL] => 1
    [HOME] => /home/rascher
    [LOGNAME] => rascher
    [SSH_CONNECTION] => 192.168.1.104 57547 192.168.1.105 22
    [LESSOPEN] => | /usr/bin/lesspipe %s
    [LESSCLOSE] => /usr/bin/lesspipe %s %s
    [_] => /usr/bin/php
    [PHP_SELF] => test.php
    [SCRIPT_NAME] => test.php
    [SCRIPT_FILENAME] => test.php
    [PATH_TRANSLATED] => test.php
    [DOCUMENT_ROOT] => 
    [REQUEST_TIME] => 1236100063
    [argv] => Array
        (
            [0] => test.php
        )

    [argc] => 1
) 
```

在网络服务器上运行相同的东西给了我这个：

```
Array
(
    [HTTP_HOST] => xxxx.com
    [HTTP_USER_AGENT] => Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.9.0.6) Gecko/2009020911 Ubuntu/8.10 (intrepid) Firefox/3.0.6
    [HTTP_ACCEPT] => text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
    [HTTP_ACCEPT_LANGUAGE] => en-us,en;q=0.5
    [HTTP_ACCEPT_ENCODING] => gzip,deflate
    [HTTP_ACCEPT_CHARSET] => ISO-8859-1,utf-8;q=0.7,*;q=0.7
    [HTTP_KEEP_ALIVE] => 300
    [HTTP_CONNECTION] => keep-alive
    [HTTP_PRAGMA] => no-cache
    [HTTP_CACHE_CONTROL] => no-cache
    [PATH] => /sbin:/usr/sbin:/bin:/usr/bin
    [SERVER_SIGNATURE] => <address>Apache/2.2.6 (Fedora) Server at xxxx.com Port 80</address>

    [SERVER_SOFTWARE] => Apache/2.2.6 (Fedora)
    [SERVER_NAME] => xxxx.com
    [SERVER_ADDR] => 208.109.29.70
    [SERVER_PORT] => 80
    [REMOTE_ADDR] => 69.134.191.151
    [DOCUMENT_ROOT] => /xxxx/httpdocs
    [SERVER_ADMIN] => jpg@gfhome.com
    [SCRIPT_FILENAME] => /xxxx/args.php
    [REMOTE_PORT] => 52187
    [GATEWAY_INTERFACE] => CGI/1.1
    [SERVER_PROTOCOL] => HTTP/1.1
    [REQUEST_METHOD] => GET
    [QUERY_STRING] => 
    [REQUEST_URI] => /args.php
    [SCRIPT_NAME] => /args.php
    [PHP_SELF] => /args.php
    [REQUEST_TIME] => 1236102678
) 
```

值得注意的是这些变量，它们最终可能是最有用的：

```
[argv] => Array
    (
        [0] => test.php
    )

[argc] => 1 
```

# c - 如何使用 pthread 读取/写入共享变量？

> ID：607374
> 
> 赞同：3
> 
> 时间：2009-03-03T17:38:29.453
> 
> 标签：c, pthreads

我有两个线程，在 linux 上使用 C pthreads。其中一个写入数据，另一个正在读取数据。我正在使用一个变量来允许读取线程何时允许读取并允许写入线程。所以互斥锁适用于这个名为“newData”的布尔变量。我的问题是：我是否需要在“if”条件内锁定/解锁访问周围的互斥锁？两种方式都有效，但我认为只是因为在这个变量上重叠写/读的机会很少。我展示了两种选择来更好地解释我的问题：

线程 1：

```
pthread_mutex_lock( &lattice_mutex );
if (!newData) {
    pthread_mutex_unlock( &lattice_mutex );
    uchar *lattice_pos = lattice;
    int i;
    for(i=0; i<size; i++) {
        *lattice_pos = rand()%CHAR_MAX;
        lattice_pos++;
    }
    pthread_mutex_lock( &lattice_mutex );
    newData = TRUE;
    pthread_mutex_unlock( &lattice_mutex );
} else {
    pthread_mutex_unlock( &lattice_mutex );
} 
```

线程 2：

```
pthread_mutex_lock( &lattice_mutex );
if(newData) {
    pthread_mutex_unlock( &lattice_mutex );
    renderUpdate();
    pthread_mutex_lock( &lattice_mutex );
    newData = FALSE;
    pthread_mutex_unlock( &lattice_mutex );
} else {
    pthread_mutex_unlock( &lattice_mutex );
} 
```

第二个版本，有效，但我不知道它是否正确：

线程 1：

```
if (!newData) {
    uchar *lattice_pos = lattice;
    int i;
    for(i=0; i<size; i++) {
        *lattice_pos = rand()%CHAR_MAX;
        lattice_pos++;
    }
    pthread_mutex_lock( &lattice_mutex );
    newData = TRUE;
    pthread_mutex_unlock( &lattice_mutex );
} 
```

线程 2：

```
if(newData) {
    renderUpdate();
    pthread_mutex_lock( &lattice_mutex );
    newData = FALSE;
    pthread_mutex_unlock( &lattice_mutex );
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-03T18:30:19.390

这是从您的第一个版本派生的 - 它有点简单。

### 话题一：作家

```
pthread_mutex_lock(&lattice_mutex);
if (!newData) {
    pthread_mutex_unlock(&lattice_mutex);  // Omit?
    uchar *lattice_pos = lattice;
    int i;
    for (i = 0; i < size; i++)
        *lattice_pos++ = rand() % CHAR_MAX;
    pthread_mutex_lock(&lattice_mutex);   // Omit?
    newData = TRUE;
}
pthread_mutex_unlock(&lattice_mutex); 
```

### 线程2：阅读器

```
pthread_mutex_lock(&lattice_mutex);
if (newData) {
    pthread_mutex_unlock(&lattice_mutex);   // Omit?
    renderUpdate();
    pthread_mutex_lock(&lattice_mutex);     // Omit?
    newData = FALSE;
}
pthread_mutex_unlock(&lattice_mutex); 
```

这取决于晶格信息的确切使用方式，但鉴于互斥体的名称，我认为您应该在修改晶格时将其锁定，因此标有“省略？”的两对线。应该被删除。否则，格不会受到并发访问的保护。

补充：我认为第二个版本是错误的——它没有正确保护晶格。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-03T17:49:53.683

第一个版本是正确的，写入和读取都需要互斥锁。

然而，AFAIK，几乎所有的架构都有对一个数据单元（例如 int）原子的简单读写访问。但是，请注意，在内存排序较弱的架构上，您可能会遇到问题，例如在缓冲区实际包含数据之前看到“缓冲区满”标志为真。

请注意，代码可能不是您能做的最好的，因为它从不休眠（使用忙等待）。如果您想在任一线程中等待数据，则必须将条件变量与互斥锁一起使用。

# python - 读取文件时保留最后一个新行

> ID：607375
> 
> 赞同：2
> 
> 时间：2009-03-03T17:38:44.320
> 
> 标签：python, file

我正在用 Python 读取一个文件，其中每条记录由一个空的新行分隔。如果文件以两个或更多新行结尾，则按预期处理最后一条记录，但如果文件以单个新行结尾，则不处理。这是代码：

```
def fread():
    record = False
    for line in open('somefile.txt'):
        if line.startswith('Record'):
            record = True
            d = SomeObject()

        # do some processing with line
        d.process(line)

        if not line.strip() and record:
            yield d
            record = False

for record in fread():
    print(record) 
```

在这个数据样本中，一切都按预期工作（'---' 是一个空行）：

> 记录1
> 数据a
> 数据b
> 数据c
> \n
> 记录2
> 数据a
> 数据b
> 数据c
> \n
> \n

但在此，最后一条记录没有返回：

> 记录1
> 数据a
> 数据b
> 数据c
> \n
> 记录2
> 数据a
> 数据b
> 数据c
> \n

如何保留文件中的最后一个新行以获取最后一条记录？

PS.：我使用“保留”这个词，因为我找不到更好的名字。

谢谢。

**编辑** 原来的代码是一个剥离版本，只是为了说明问题，但似乎我剥离太多。现在我发布了所有函数的代码。

再解释一下：对象`SomeObject`是为文件中的每条记录创建的，记录由空的新行分隔。在记录的末尾，它会返回对象，以便我可以使用它（保存到数据库，与另一个对象进行比较等）。

当文件以一个新行结束时的主要问题，最后一条记录没有产生。当它是空白时，Python 似乎不会读取最后一行。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-03T18:16:43.510

现在写的方式可能无论如何都行不通；在`d = SomeObject()`您的循环中，将为每一行创建一个新的 SomeObject 。但是，如果我理解正确，您想要的是空行之间的所有行都为该对象做出贡献。你可以这样做：

```
def fread():
    d = None
    for line in open('somefile.txt'):

        if d is None:
            d = SomeObject()

        if line.strip():
            # do some processing
        else:
            yield d
            d = None

    if d: yield d 
```

这不是很好的代码，但它确实有效；当循环完成时，将产生最后一个错过其空行的对象。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-03T18:14:17.090

您可能会发现在更经典的 Python 方向上稍作改动会提高代码的可预测性：

```
def fread():
    for line in open('text.txt'):
        if line.strip():
            d = SomeObject()
            yield d

    raise StopIteration

for record in fread():
    print record 
```

在 Python 中结束生成器的首选方法是使用 StopIteration 异常，尽管通常不是绝对必要的。简单地使用`if line.strip()`意味着如果在去除空格后还有任何剩余的内容，您将完成收益。SomeObject() 的构造可以在任何地方......我只是碰巧移动了它，以防 SomeObject 的构造很昂贵，或者如果该行为空，则不应该发生副作用。

编辑：为了后人的缘故，我会在这里留下我的答案，但下面的 DNS 的初衷是正确的，其中几行有助于相同的 SomeObject() 记录（我完全掩盖了）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T17:56:02.967

line.strip() 将在空行上产生一个空字符串。空字符串是 False，所以你吞下空行

```
>>> bool("\n".strip())
False
>>> bool("\n")
True 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T17:58:16.287

如果您`readline`在文件对象上重复（循环）调用（而不是使用`in`），它应该可以按预期工作。比较这些：

```
>>> x = open('/tmp/xyz')
>>> x.readline()
'x\n'
>>> x.readline()
'\n'
>>> x.readline()
'y\n'
>>> x.readline()
''
>>> open('/tmp/xyz').readlines()
['x\n', '\n', 'y\n'] 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-03T18:28:41.000

替换`open('somefile.txt'):`为`open('somefile.txt').read().split('\n'):`，您的代码将起作用。

但 Jarret Hardie 的回答更好。

# .net - 可以在 aspx 页面上显示来自代码隐藏的实际源代码（对于代码示例页面）

> ID：607377
> 
> 赞同：3
> 
> 时间：2009-03-03T17:39:26.580
> 
> 标签：.net, asp.net, reflector

我正在做一个 aspx 页面来显示库的代码使用示例。

所以基本上，我想例如有：描述源代码按钮输出（在数据网格中）

与其将按钮后面的代码复制并粘贴到 aspx 页面中用于显示目的，我认为能够在运行时读取实际源代码并显示它可能会很好。除了光滑之外，这还有一个额外的好处，即确保显示的源代码是最新的，而如果有人进行了更改并忘记使用新代码更新 aspx 页面，则复制和粘贴可能会过时。

我可以想到 2 种可能的方法来做到这一点： 1) (kludgy) - 部署文件背后的代码，然后可以在运行时读取这些代码，并且可以解析并显示正确的功能代码。2）（首选）运行时反编译 DLL（如反射器所做的那样）并显示代码。

所以我知道如何做＃1，但不知道＃2（如果可能的话）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-03T17:45:58.250

在运行时反编译代码不会产生与您编写的完全相同的代码。在这一点上，它变得更像是一种解释。

第三种选择是让您的应用程序针对您的代码存储库工作以检索特定文件。然后，您将在浏览器中显示该文件的内容。它类似于选项 1，但您不会将 .cs 文件直接部署到服务器。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-03T17:44:53.243

阅读实际的源文件是去这里的方式，IMO - 如果你真的，真的确定你不介意每个人都能看到你的服务器的源代码。如果你使用像 Reflector 这样的东西，你会丢失所有的注释，可能是局部变量，并且像迭代器块这样的东西会变得特别奇怪。

我有一个代码格式化程序（实际上是一个控件），我在[C# in Depth 网站上](http://csharpindepth.com)使用它。它相对原始，但如果您愿意，欢迎您使用它。（如果您想尝试一下，可以通过[网站本身的页面使用它。）](http://csharpindepth.com/CodeFormatterTool.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T17:43:10.610

如果您想保留注释和原始变量名称，那么反射将不起作用。解析代码可能是最直接的方法。可能还可以选择从 PDB 文件中提取数据。

# algorithm - 如何在网络上的多台计算机上构建分布式健壮链表？

> ID：607382
> 
> 赞同：1
> 
> 时间：2009-03-03T17:40:37.170
> 
> 标签：algorithm, linked-list, distributed, robustness

我正在考虑构建一个使用类似算法的raid（磁盘）的程序。如果一台电脑死机。下一个将介入。在它的位置。它需要从 1 到 1000 台计算机进行扩展。

我需要一些建议。

我需要学习的算法的名称是什么？

在某一时刻，我认为可以在 git 之上构建它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-03T17:48:22.020

您可能想阅读有关 Google 文件系统的这篇[论文。](http://labs.google.com/papers/gfs.html)从摘要：

> 我们设计并实现了 Google 文件系统，这是一个可扩展的分布式文件系统，适用于大型分布式数据密集型应用程序。它在廉价商品硬件上运行时提供容错能力，并为大量客户端提供高聚合性能。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-05T10:41:02.873

试试[Hazelcast](http://www.hazelcast.com)。它具有 Set、List 等的分布式实现。Hazelcast 是队列、主题、映射、集合、列表、锁定和执行器服务的开源事务性、分布式/分区实现。使用起来超级容易；只需将 hazelcast.jar 添加到您的类路径中并开始编码。几乎不需要任何配置。

Hazelcast 是在 Apache 许可下发布的，并且还提供企业级支持。代码托管在[Google Code](http://code.google.com/p/hazelcast/)上。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-05T16:23:18.480

我已经看到提到过 Hadoop 和 Google 文件系统，但没有人特别提到[HDFS](http://hadoop.apache.org/core/docs/r0.19.1/hdfs_design.html "高密度文件系统") - Hadoop 附带的分布式文件系统。您可以设置所需的冗余级别，并在不丢失数据的情况下丢失偶尔的节点。

一个警告：您需要确保拥有“namenode”（HDFS 集群中的主机和单点故障）的一台机器是可靠的——RAID 镜像、备份、工作。你失去了namenode，你失去了集群。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-03T17:52:45.423

[分布式哈希表](http://en.wikipedia.org/wiki/Distributed_hash_table)突然出现在我的脑海中......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-03T18:01:21.067

另请查看[MapReduce](http://en.wikipedia.org/wiki/MapReduce)算法。这是一种获得高可扩展性的相对简单的方法，不会强迫算法设计者考虑锁定、通信等。有几种可用的实现，例如 Apache 基金会的开源[Hadoop](http://hadoop.apache.org/)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-05-28T05:33:15.347

1）您可以使用分布式锁/互斥锁，如：

一种用于分散系统中互斥的 sqrt(N) 算法，作者 Maekawa：[http ://portal.acm.org/citation.cfm?id=214445](http://portal.acm.org/citation.cfm?id=214445)

Lubowich 和 Taubenfeld 关于基于锁的分布式同步的性能：[http ://portal.acm.org/citation.cfm?id=1946155](http://portal.acm.org/citation.cfm?id=1946155)

2）或者您可以使用无锁链表，如下所示：

Fomitchev 和 Rupert 的无锁链接列表和跳过列表：[http ://www.cse.yorku.ca/~ruppert/papers/lfll.pdf](http://www.cse.yorku.ca/~ruppert/papers/lfll.pdf)

Valois 使用比较和交换的无锁链表： http://portal.acm.org/citation.cfm?id= [224988](http://portal.acm.org/citation.cfm?id=224988)

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-03-06T19:42:47.990

您可能想查看[Appistry EAF](http://www.appistry.com)。它是一个分布式执行平台。它为您处理所有任务的故障转移，因此您不必将其构建到您的代码中。如果一个节点发生故障，另一个节点会自动接管。与 Grid 不同，没有集中式控制器，您可以消除这些类型的解决方案的单点故障/瓶颈。

最多可免费下载 5 台机器。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-03-03T17:42:47.163

比特流？:)

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-03-03T17:51:50.340

您可以构建类似[memcached](http://www.danga.com/memcached/)的东西。每个散列条目可以是一个文件块（例如块到内容的 SHA 散列）。

# jquery - jquery addclass/removeclass 在设置“速度”时并不总是有效（鼠标事件）

> ID：607386
> 
> 赞同：5
> 
> 时间：2009-03-03T17:41:51.567
> 
> 标签：jquery, jquery-ui

在 css 类“employee_mouseover”中，我将 bg 颜色设为红色。

```
 $(".employee").bind("mouseenter", function() {
            $(this).addClass("employee_mouseover");
        });
        $(".employee").bind("mouseleave", function() {
            $(this).removeClass("employee_mouseover");
        }); 
```

这工作正常。

但是，当我设置一个速度让它看起来更漂亮时，当我快速执行 mouseenter+mouseleave 时，元素保持红色；

```
 $(".employee").bind("mouseenter", function() {
        $(this).addClass("employee_mouseover", "fast");
    });
    $(".employee").bind("mouseleave", function() {
        $(this).removeClass("employee_mouseover", "fast");
    }); 
```

这效果不好，除非我非常缓慢地进出元素。

有一个更好的方法吗？

提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-07-14T15:59:06.900

来自[jQuery UI 文档](http://docs.jquery.com/UI/Effects/ClassTransitions)：

> jQuery UI 效果核心扩展了基类 API，以便能够在两个不同的类之间进行动画处理。以下方法已更改。它们现在接受三个附加参数：速度、缓动（可选）和回调。

所以@Thomas 肯定在他的页面上同时包含了 jQuery 和 jQuery UI 库，从而启用了 addClass 和 removeClass 的速度和回调参数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-03T22:09:41.750

你使用了错误的事件。你要：

```
$(".employee").hover(function() {
 $(this).addClass("employee_mouseover");
}, function() {
 $(this).removeClass("employee_mouseover");
}); 
```

并且没有关于添加或删除类的速度参数。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-03T22:16:47.677

可以，但是需要安装[jquery coloranimate插件](http://plugins.jquery.com/project/color)。然后你可以使用下面的代码慢慢改变颜色：

```
$(".employee").bind("mouseenter", function() {
  $(this).animate({backgroundColor: "#bbccff"}, "slow");

});
$(".employee").bind("mouseleave", function() {
  $(this).animate({backgroundColor: "white"}, "slow");
}); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-03T17:43:32.983

是的，用 CSS 做！

```
.employee:hover{background:pink;} 
```

此外，[addClass 没有速度参数](http://docs.jquery.com/Attributes/addClass)，速度仅存在于效果。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-02-16T22:19:56.090

removeClass 有一个持续时间参数（http://docs.jquery.com/UI/Effects/removeClass），但它在 FF 中不起作用。我的代码有什么问题吗？我是 JQuery 的新手。我现在要尝试动画功能。

我在这里尝试做的是使用锚点，然后在单击锚点时突出显示目标锚点位置。这是我的 HTML 代码 -

```
<ul>
                <li><a href="#caricatures">Caricatures</a></li>
                <li><a href="#sketches">Sketches</a></li>
</ul> 
```

我的目的地锚是-

```
<a href="#" id="caricatures"><h3>Caricatures</h3></a> 
```

这是我可能改变背景颜色的地方。

这是我的 CSS -

```
<style>
            .spotlight{
                background-color:#fe5;
            }
</style> 
```

这是我的 JQuery 代码 -

```
<script>
    $('a[href$="caricatures"]').click(function(){
        $('a[id="caricatures"] h3').addClass("spotlight");
        $('a[id="caricatures"] h3').removeClass("spotlight",1000);
    });
    </script> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-03T17:58:12.527

`addClass`用于向元素添加 CSS 类。如果您希望通过补间来更改某些 CSS 属性，那么您需要使用[Effects](http://docs.jquery.com/Effects)显式地执行此操作。

你的代码：

```
$(this).addClass("employee_mouseover", "fast"); 
```

将添加两个类`employee_mouseover`和`fast`to `this`，这显然不是你想要的。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-07-11T21:03:01.083

这是我使用 jQuery 的过渡：

```
$("#layoutControl .actionList").click(
    function(){
        $("#assetsContainer").fadeOut("fast",function(){
            $(this).removeClass("assetsGrid").addClass("assetsList");
            $("#iconList").attr("src", "/img/bam/listIcon.png");
            $("#iconGrid").attr("src", "/img/bam/gridIconDim.png");
            $(this).fadeIn("fast");
        });
    }
); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-10-30T14:08:21.303

**此外，addClass 没有速度参数，速度只存在于效果。**

正确的。

但也许这个插件可能会有所帮助：

[动画课堂](http://plugins.jquery.com/project/animate-to-class)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-02-15T04:34:03.030

即使您正确地包含了 JqueryUI，当您使用“duration”参数时，这些似乎都会在 FF 之外失败。导致 IE 中的 JS 错误。我会坚持 animate() 这很糟糕。

[http://jqueryui.com/docs/addClass/](http://jqueryui.com/docs/addClass/)

[http://jqueryui.com/docs/removeClass/](http://jqueryui.com/docs/removeClass/)

[http://jqueryui.com/docs/switchClass/](http://jqueryui.com/docs/switchClass/)

[http://jqueryui.com/docs/toggleClass/](http://jqueryui.com/docs/toggleClass/)

jqueryui 网站上的文档中没有说明这一点。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-02-15T04:58:49.220

```
$(".employee").hover(function() {
    $(this).stop().animate({ backgroundColor: "#bbccff" }, "slow");
}, function() {
    $(this).stop().animate({ backgroundColor: "white" }, "slow");
}); 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2011-02-23T16:35:22.757

您可以使用 CSS3 过渡来实现此效果。

```
a:hover {
    color: red;
    -webkit-transition: 1s color linear;
    -moz-transition: 1s color linear;
}

a:link, a:visited {
    color: white;
    -webkit-transition: 1s color linear;
    -moz-transition: 1s color linear;
} 
```

# sql-server - 是否可以将远程 MSSQL 表中的数据复制到本地表中？

> ID：607407
> 
> 赞同：0
> 
> 时间：2009-03-03T17:48:37.010
> 
> 标签：sql-server, linked-server

这样做的最佳方法是什么？我发现了一些`INSERT`陈述，但它们似乎都只适用于内部数据库复制。

我的演绎：

```
INSERT INTO [PROGRAM003].[dbo].[faq]
    ([id], [category], [question], [answer], [tags])
SELECT ([id], [category], [question], [answer], [tags])
FROM [SQL2005_552664_gsow].[dbo].[faq] 
```

我对 MSSQL 还不是很流利，因此感谢所有帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T18:04:08.750

我们说的有多“遥远”？如果它是同一服务器上的另一个数据库，您可以在前面添加数据库名称，如您最初的示例所示：

```
INSERT INTO [mytable] SELECT * FROM [database].dbo.[table] 
```

如果它在完全不同的服务器上，则需要将它们设置为链接服务器。然后你可以这样做：

```
INSERT INTO [mytable] SELECT * FROM [server].[database].dbo.[table] 
```

当然，您还*必须*完全指定该服务器中的数据库和模式，并且预计性能会受到影响，因为它需要通过网络移动数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T17:56:47.583

您可以使用[OPENDATASOURCE](http://msdn.microsoft.com/en-us/library/ms179856.aspx)或[OPENROWSET](http://msdn.microsoft.com/en-us/library/ms190312.aspx)访问其他服务器上的表。您需要在查询中提供 SQL 凭据，或者设置两个数据库以允许访问您的 windows id 以使其正常工作。您还可以使用 SQL Server Management Studio 中的导入/导出向导 -- 右键单击​​数据库并选择 Tasks-->Import 或 Tasks-->Export。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-04-14T15:06:21.040

使用大师

去

EXEC sp_addlinkedserver @server = 'RemoteSer'，@srvproduct = ''，@provider = 'MSDASQL'，@provstr = 'DRIVER={SQL Server};SERVER=000.000.000.000\SQLEXPRESS;' 去

从 [RemoteSer].[bnk].[dbo].[test1] 中选择 * 进入 bnkWeb.dbo.test1

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T17:55:30.677

您可能想查看 DTS 或 (2005+) Integration Services。这两者都将从一个数据库（表）中获取数据并将数据复制到另一个数据库（表）中。

集成服务链接：http: [//msdn.microsoft.com/en-us/library/ms141091.aspx](http://msdn.microsoft.com/en-us/library/ms141091.aspx)

# sql - 按行过滤分组

> ID：607410
> 
> 赞同：1
> 
> 时间：2009-03-03T17:50:15.913
> 
> 标签：sql, group-by

假设我有一个表格来描述汽车的品牌、型号、年份和其他一些列。

从那以后，我想得到最近一年的每个品牌和型号的一整排。

或者换一种说法。每一行将具有唯一的品牌和型号组合，以及来自相应行的其他数据，其中年度值最大。

标准的 SQL 解决方案会很棒。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T17:55:00.507

MySQL解决方案：

```
SELECT * FROM cars GROUP NY CONCAT(make, "-", model) ORDER BY year DESC; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T17:55:20.147

```
select t1.make, t1.model, t1.year, t1.other_cols
from table t1
where year = (select max(year) from table t2
              where t2.make = t1.make
              and t2.model = t1.model
             ); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T17:57:38.033

这应该在任何地方都有效：

```
SELECT c1.* 
FROM cars c1
INNER JOIN 
  (
     SELECT Make, Model, Max(Year) AS Year
     FROM cars
     GROUP BY Make, Model
  ) c2 ON c1.Make=c2.Make AND c1.Model=c2.Model, c1.Year=c2.Year 
```

主要警告是 Year 通常是保留字（函数名），转义保留字的方法因平台而异。要解决此问题，请将年份列重命名为 ModelYear。

# c# - C# Designer 序列化问题

> ID：607417
> 
> 赞同：4
> 
> 时间：2009-03-03T17:51:41.263
> 
> 标签：c#, serialization, designer

我在序列化我的对象时遇到了一些问题，并将问题缩小到特定情况（参见下面的代码）。我收到以下错误：

错误 1 ​​Resx 文件无效。无法加载在 .RESX 文件中使用的类型 Serialisation.Harness.Blob、Serialisation、Version=1.0.0.0、Culture=neutral、PublicKeyToken=null。确保已将必要的引用添加到您的项目中。第 129 行，位置 5....

现在真正奇怪的是，重新启动 Visual Studio 会导致错误消失并且代码可以工作，但是在看似随机数量的构建之后（在此期间所述代码*没有*更改），它会再次中断。

你能看到我做错了什么/错过了什么吗？

提前谢谢了，

我也是

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.ComponentModel;
using System.Windows.Forms;
using System.Windows.Forms.Design; using System.ComponentModel.Design;

namespace Serialisation.Harness
{    

    [Serializable]
    public class Blob
    {
        public Blob()
        {
        }
    }

    [Serializable]
    public class Basic
    {

        private List<Blob> blobs;
        public List<Blob> Blobs
        {
            get { return blobs; }
            set { this.blobs= value; }
        }

        public Basic()
        {
            basics = new List<Blob>();
        }

    }

    public class BasicComponent : Component
    {

        private Basic basic = new Basic();

        private IContainer components = new Container();

        public List<Blob> Blobs
        {
            get { return basic.Blobs; }
            set { basic.Blobs= value; }
        }

        public BasicComponent(IContainer container)
        {
            container.Add(this);
        }

    }

} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-03T18:24:19.983

首先，该[`Serializable`](http://msdn.microsoft.com/en-us/library/system.serializableattribute.aspx)属性不用于设计器序列化。序列化对象时，当设计器不知道如何将资源文件写入设计器代码时，它会序列化到资源文件。这会使用对象类型的默认构造函数将其作为 blob 写入 resx [`InstanceDescriptor`](http://msdn.microsoft.com/en-us/library/system.componentmodel.design.serialization.instancedescriptor.aspx)（这会丢失您可能还想包含的任何属性值）。这就是`Blobs`属性正在发生的事情，因为设计器没有很好地序列化通用列表（它确实知道如何序列化数组）。

为了在这些持久化对象中保留信息，您需要创建一个[`TypeConverter`](http://msdn.microsoft.com/en-us/library/system.componentmodel.typeconverter.aspx)指定不同构造函数的构造函数[`InstanceDescriptor`](http://msdn.microsoft.com/en-us/library/system.componentmodel.design.serialization.instancedescriptor.aspx)（该构造函数实际上采用某种状态来描述属性，例如您的`Blobs`属性）。例如，如果你向你的`BasicComponent`类型添加了一个构造函数，它接受一个`IEnumerable<Blob>`，然后你可以得到一个[`InstanceDescriptor`](http://msdn.microsoft.com/en-us/library/system.componentmodel.design.serialization.instancedescriptor.aspx)构造函数，传入一个 s 数组`Blob`（你会`List<Blob>`在构造函数中围绕它创建一个新的）。因为设计器知道如何将一个持久化[`InstanceDescriptor`](http://msdn.microsoft.com/en-us/library/system.componentmodel.design.serialization.instancedescriptor.aspx)到代码中，并且因为它知道如何将数组持久化到代码中，所以它会将其添加到您的设计器代码中，而不是 resx。

您还可以实现 a[`CodeDomSerializer`](http://msdn.microsoft.com/en-us/library/system.componentmodel.design.serialization.codedomserializer.aspx)来指定用于描述您的实例的代码，设计器可以使用它来将您的对象保存到设计器代码而不是 resx。

### 类型转换器

要使用类型转换器方法，您可以执行以下操作：

```
public class BasicComponentTypeConverter : TypeConverter
{
    public override bool CanConvertTo(ITypeDescriptorContext context, Type destinationType)
    {
        bool canConvert = base.CanConvertTo(context, destinationType);

        if (!canConvert &&
            (destinationType == typeof(InstanceDescriptor))
        {
            canConvert = true;
        }

        return canConvert;
    }

    public override object ConvertTo(ITypeDescriptorContext context, CultureInfo culture, object value, Type destinationType)
    {
        object conversion = null;

        if (culture == null)
        {
            culture = CultureInfo.CurrentCulture;
        }

        BasicComponent component = value as BasicComponent;
        if (basicComponent != null)
        {
            if (destinationType == typeof(InstanceDescriptor))
            {
               // Note that we convert the blobs to an array as this makes for nicer persisted code output.
               // Without it, we might just get a resource blob which is not human-readable.
               conversion = new InstanceDescriptor(
                   typeof(BasicComponent).GetConstructor(new Type[] { typeof(IEnumerable<Blob>) }),
                   new object[] { basicComponent.Blobs.ToArray() },
                   true);
            }
        }

        if (conversion == null)
        {
            conversion = base.ConvertTo(context, culture, value, destinationType);
        }

        return conversion;
    }
} 
```

请注意，您可能还需要为该`Blob`类型编写一个类型转换器。要将类型转换器附加到类型，只需[`TypeConverter`](http://msdn.microsoft.com/en-us/library/system.componentmodel.typeconverterattribute.aspx)在类型转换器将转换的类上声明属性，即上面示例的 BasicConverter。

# excel-formula - Excel条件计数

> ID：607431
> 
> 赞同：0
> 
> 时间：2009-03-03T17:55:43.093
> 
> 标签：excel-formula

这是我工作场所出现的一个疑问，应该很简单。

我们有两列数字，比如说：

```
1 1
1 2
2 1
2 2 
```

并且我们希望获得具有相同数字 (2) 的行数，而无需为每个比较提供帮助列。我们无法获得有效的矩阵运算（这是我们认为正确的方式）。有任何想法吗？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T17:59:38.653

我们使用：

```
{=SUM(IF(A1:A10=B1:B10;1;0))} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-10-07T23:05:11.833

还有三个在这里堆积：

精简数组函数：

1.  `{=SUM(--(A1:A10=B1:B10))}`

相同的函数，但包装在 SUMPRODUCT 中而不是数组函数中：

2.  `=SUMPRODUCT(--(A1:A10=B1:B10))`

忽略空格：

3.  `=SUMPRODUCT(--(A1:A10=B1:B10)*NOT(A1:A10="")*NOT(B1:B10=""))`

# c# - .net 数据绑定 - 引用匿名类型属性

> ID：607433
> 
> 赞同：4
> 
> 时间：2009-03-03T17:56:24.543
> 
> 标签：c#, linq, data-binding, reflection, anonymous-types

我已将 ASP.net GridView 绑定到一组匿名类型。

如何在 RowDataBound 事件处理程序中引用匿名类型的属性之一？

我已经知道像这样强制转换匿名类型的方法：

```
protected void GridView1_RowDataBound(object sender, GridViewRowEventArgs e)
{
    if (e.Row.RowType == DataControlRowType.DataRow)
    {
        var AnonObj = Cast(e.Row.DataItem, 
          new { StringProperty = "", BoolProperty = false, IntProperty = 0 });

        if (AnonObj.BoolProperty)
        {
            e.Row.Style.Add(HtmlTextWriterStyle.Color, "Red");
        }
    }
}

T Cast<T>(object obj, T type)
{
    return (T)obj;
} 
```

我想大多数人会说这很混乱，即使它确实有效。在我的真实代码中，我有超过 3 个属性，每当我添加或重新排序匿名类型的属性时，我都必须在两个地方更新代码。

有没有更好的方法来告诉 e.Row.DataItem 它具有特定类型的特定属性并强制对象给我该值（除了创建一个类）？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-03T17:58:11.557

研究使用反射。

例子：

```
object o = e.Row.DataItem;
Type t = o.GetType();
PropertyInfo pi = t.GetProperty("StringProperty");
if (pi != null && pi.PropertyType == typeof(string))
{
  // the property exists!
  string s = pi.GetValue(o, null) as string;
  // we have the value
  // insert your code here
  // PROFIT!  :)
} 
```

错误检查和优化留给读者作为练习。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-03T17:57:45.240

更好的方法是创建一个类型来处理这个问题，这样您就不必进行所有转换来使用匿名类型。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-11-05T10:56:12.423

我所做的是......例如，

```
string Name = (string)DataBinder.Eval(dataItem.DataItem, "Name"); 
```

...但这是在 listview`ItemDataBound`事件处理程序中。认为它可能对某人有用。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-03T18:09:01.640

您使用的方式（通过示例进行转换）是混乱且**非常**脆弱的 - 我**真的**不推荐它（如果您添加一个属性，或者以不同的顺序命名它们，它会中断；等等）。更好的方法是在投影中使用您自己的命名类型。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-03T17:59:28.887

不，我认为没有比这更好的方法了。C# 的人并不真正支持在本地方法范围之外使用匿名类型（即，在这里你有一个匿名类型附加到你的 Row 对象。）

通常的建议是创建一个真正的课程。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-03T18:10:10.563

您用来投射匿名对象的方法（虽然很酷）是一种 hack。它之所以起作用，仅仅是因为 C# 编译器足够聪明，如果属性相同，它只会为整个应用程序创建一个匿名类的实例。所以使用匿名类型确实没有任何好处，因为无论如何都是在幕后创建一个类。是的，你可以破解它，你可以使用反射，但严重的是，为什么要麻烦呢？在这种情况下使用匿名类型有什么好处？

# vim - 为什么 Vim 使用 ~ 扩展名保存文件？

> ID：607435
> 
> 赞同：209
> 
> 时间：2009-03-03T17:56:45.447
> 
> 标签：vim

我发现在 Windows 上使用 Vim 时，Vim 会保存文件、`.ext.swp`关闭 Vim 窗口时删除的文件和`.ext~`文件。

我假设该`.ext.swp`文件是一个会话备份，以防 Vim 崩溃。`.ext~`然而，该文件的目的是什么？这是永久备份文件吗？这很烦人，因为我想将我正在处理的所有文件复制到我的主机上，而没有这些重复。**我怎样才能关闭它，或者**，如果它有充分的理由，**隐藏文件**？

* * *

## 回答 #1

> 赞同：245
> 
> 时间：2009-10-26T16:44:11.040

我认为更好的解决方案是将这些行放在您的 vimrc 文件中

```
set backupdir=~/vimtmp//,.
set directory=~/vimtmp//,. 
```

第一行是备份文件，第二行是交换文件。最后的双斜杠确保在两个文件具有相同名称的情况下不会发生冲突，请参阅注释（在此编辑时，此选项仅适用于交换文件，[尚未适用于备份文件](https://stackoverflow.com/questions/26742313/why-vim-backup-filenames-are-not-correct-backupdir-option-not-performing-as-e)）。如果前者不存在，则允许使用当前目录`,.`。`vim`

您必须在您的主目录中创建一个名为 vimtmp 的目录才能正常工作。此外，请检查您的配置中是否启用了备份（`set backup`如果没有，请添加）。

这样一来，您就可以两全其美了，您不必查看文件，但如果确实有问题，您可以从 vimtmp 获取备份文件。不要忘记时不时地清理目录。

* * *

## 回答 #2

> 赞同：241
> 
> 时间：2009-03-03T18:04:59.810

该`*.ext~`文件是一个备份文件，包含编辑之前的文件。

该`*.ext.swp`文件是交换文件，用作锁定文件并包含撤消/重做历史以及 Vim 需要的任何其他内部信息。如果发生崩溃，你可以重新打开你的文件，Vim 会从交换文件中恢复它以前的状态（我觉得这很有帮助，所以我没有关闭它）。

要关闭备份文件的自动创建，请使用（在您的 vimrc 中）：

```
set nobackup
set nowritebackup 
```

Where`nowritebackup`改变了 Vim 的默认“保存”行为，即：

1.  将缓冲区写入新文件
2.  删除原始文件
3.  重命名新文件

并使 Vim 将缓冲区写入原始文件（导致在 I/O 错误的情况下破坏它的风险）。但是你用它防止在 Windows 桌面上“跳转文件”，这是我有它的主要原因`nowritebackup`。

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2009-03-03T18:04:29.797

要关闭这些文件，只需将这些行添加到 .vimrc（基于 unix 的操作系统上的 vim 配置文件）：

```
set nobackup       #no backup files
set nowritebackup  #only in case you don't want a backup file while editing
set noswapfile     #no swap files 
```

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2009-03-03T22:13:59.353

您还可以设置不同的备份扩展名以及保存这些备份的位置（我更喜欢`~/.vimbackups`在 linux 上）。我曾经通过以下方式使用“版本化”备份：

```
au BufWritePre * let &bex = '-' . strftime("%Y%m%d-%H%M%S") . '.vimbackup' 
```

这将设置一个动态备份扩展 ( `ORIGINALFILENAME-YYYYMMDD-HHMMSS.vimbackup`)。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2009-03-03T18:02:10.130

```
:set nobackup 
```

将关闭备份。如果您仍然想要这些备份文件但在中央文件夹中，您也可以设置备份目录。这样你的工作目录就不会被 ~ 文件乱扔了。

**您可以在:he backup**下找到有关备份的更多信息。

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2017-07-10T02:34:48.510

将此行放入您的`vimrc`：

`set nobk nowb noswf noudf` `"` [`nobackup`](https://vimhelp.org/options.txt.html#%27backup%27) [`nowritebackup`](https://vimhelp.org/options.txt.html#%27writebackup%27) [`noswapfile`](https://vimhelp.org/options.txt.html#%27swapfile%27) [`noundofile`](https://vimhelp.org/options.txt.html#%27undofile%27)

* * *

在[Windows](/questions/tagged/windows "显示标记为“windows”的问题")中，这将是：

```
C:\Program Files (x86)\vim\_vimrc 
```

用于所有用户的系统范围的 vim 配置文件。

设置最后一个`noundofile`在 Windows 中很重要，以防止`*~`在编辑后创建 tilda 文件。

* * *

我希望 Vim 默认包含该行。没有人喜欢丑陋的目录。

让用户首先选择是否以及如何启用高级备份/撤消文件功能。

这是 Vim 中最烦人的部分。

下一步可能是设置：

`set noeb vb t_vb=` `"` [`errorbells`](https://vimhelp.org/options.txt.html#%27errorbells%27) [`visualbell`](https://vimhelp.org/options.txt.html#%27visualbell%27)

也禁用[vim](/questions/tagged/vim "显示标记为“vim”的问题")中的哔哔声:-)

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-03-03T18:03:33.993

你是正确的，该`.swp`文件被 vim 用于锁定和作为恢复文件。

`set nobackup`如果您不想要这些文件，请尝试放入您的 vimrc。如果您想要完整的独家新闻，或者想要拥有 .bak 文件，请参阅[Vim 文档以获取各种与备份相关的选项...](http://www.vim.org/htmldoc/version4.html)

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2017-04-06T15:18:01.563

对我有用的唯一选择是将这一行放在我的 ~/.vimrc 文件中

设置 noundofile

引用备份文件的其他选项不会阻止创建以 ~ 结尾的临时文件（波浪号）

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-03-01T19:44:08.533

我不得不添加`set noundofile`到 ~_gvimrc

“~”目录可以通过`cd ~`命令改变目录来识别

# database-design - 网站部分安全/权限的最佳设计是什么 - 数据表明智？

> ID：607437
> 
> 赞同：5
> 
> 时间：2009-03-03T17:57:08.893
> 
> 标签：database-design

关于设计：

1.  每个用户都是某个组的一部分。（销售、零件、棒球运动员等）
2.  每个“网页”都会被一群人看到。（销售+零件+获得特别许可的会计乔）
3.  每个网页通常是某个级别的一组网页的一部分 - 您可能会尝试将它们保存在某个目录中或以某些前缀开头，但并非总是如此 - 即当有人加入您不想指定的销售时 - 他们可以看到 SalesPage1、SalesPage2、SalesPage3、SalesPartsPage1 等。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-03T18:03:37.490

最简单的方法如下：

**用户**：包含您的用户、名称和 ID 列表

**SecurityGroups**：包含安全组列表，例如“Sales”、“Marketing”。(id, 安全组名)

**Pages**：包含您的页面列表（id，页面名称）

**UserSecurityGroups** : (userId, securityGroupId)。分配权限的交叉引用表

**PageSecurityGroups**：（pageId，securityGroupId，允许）。允许访问页面的安全组成员的交叉引用表。

对于每个页面加载，您将检查特定页面的 PageSecurityGroups 表是否包含用户拥有的组访问权限。

显然，这可能还有更多，例如将页面分配给特定用户，但您可以根据应用程序的需要对此进行推断。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-03T18:03:30.250

由于“每个网页*通常*是一组网页的一部分......”可能最好表现得好像“每个网页*总是*一组网页......” - 即使某些组只会有1个成员！

这将您的数据模型简化为：

用户 ---> 用户组 <-------> 页面组 <--- 页面

# entity-framework - Where to find ADO.NET Entity Framework error list?

> ID：607445
> 
> 赞同：2
> 
> 时间：2009-03-03T17:58:20.763
> 
> 标签：entity-framework

Where can I find an ADO.NET Entity Framework error list?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T17:36:42.883

Click on Error List (At the bottom of Visual Studio) and then, click on "Message".

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T18:00:08.917

[Here they are.](http://msdn.microsoft.com/en-us/library/ms677004(VS.85).aspx)

# sql - 存储过程中的sql2000循环

> ID：607456
> 
> 赞同：2
> 
> 时间：2009-03-03T18:01:10.927
> 
> 标签：sql, stored-procedures, loops

我对 SQL 很陌生，我可以很容易地使用基本语句，但我还没有弄清楚循环。

```
Foreach(JobHeaderID AS @OldJobHeaderID in dbo.EstimateJobHeader WHERE EstimateID=@OldEstimateID)  
{  
  INSERT EstimateJobHeader (ServiceID,EstimateID) 
  SELECT ServiceID, @NewEstimateID 
  FROM EstimateJobHeader 
  WHERE EstimateID=@OldEstimateID;  

  SELECT @err = @@error 
  IF @err <> 0 
  BEGIN 
    ROLLBACK TRANSACTION 
    SET @RETURN_VALUE = 4 
    RETURN 4 
  END  

  SET @NewJobHeaderID = CAST(SCOPE_IDENTITY() AS INT)  

  SELECT @err = @@error 
  IF @err <> 0 
  BEGIN 
    ROLLBACK TRANSACTION 
    SET @RETURN_VALUE = 3 
    RETURN 3 
  END  

  INSERT EstimateDetail (JobHeaderID, OtherCols) 
  SELECT (@NewJobHeaderID,OtherCols) 
  FROM EstimateDetail 
  WHERE JobHeaderID=@OldJobHeaderID

  SELECT @err = @@error 
  IF @err <> 0 
  BEGIN 
    ROLLBACK TRANSACTION 
    SET @RETURN_VALUE = 3 
    RETURN 3 
  END  

  INSERT EstimateJobDetail (JobHeaderID, OtherCols) 
  SELECT (@NewJobHeaderID, OtherCols) 
  FROM EstimateJobDetail 
  WHERE JobHeaderID=@OldJobHeaderID  

  SELECT @err = @@error 
  IF @err <> 0 
  BEGIN 
    ROLLBACK TRANSACTION 
    SET @RETURN_VALUE = 3 
    RETURN 3 
  END  
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-03T18:09:08.850

您应该避免存储过程中的循环。

Sql 是一种声明性语言，而不是您最习惯的命令式语言。几乎所有你想对循环做的事情都应该作为基于集合的操作来完成，或者在客户端代码中完成。当然，也有例外，但没有你想象的那么多。

看到这个：
[为什么在 T-SQL 中做一个循环这么难](https://stackoverflow.com/questions/588050/why-is-it-so-difficult-to-do-a-loop-in-t-sql)

* * *

你问如何使用基于集合的方法来做到这一点。我会尽力而为，但是您的代码早期存在一个错误，这使我很难确定我是否正确阅读了它。第一个 INSERT 语句的条件与 FOREACH 循环的条件相匹配。因此，要么循环只运行一次（在那里返回一条记录），要么您的插入在每次迭代中插入几条新记录（是的，插入语句一次可以添加多条记录）。如果它添加了几条记录，为什么你只得到最后一个插入创建的标识？

也就是说，我想我理解得足够好，可以向你展示一些东西。看起来您只是在复制估算值。您也没有解释 @NewEstimateID 值的来源。如果有父表，那就这样吧，但了解一下会很有帮助。

```
/* Where'd @NewEstimateID come from? */
/* If there are several records in EstimateJobHeader with @OldEstimateID,
 *  this will insert one new record for each of them */
INSERT EstimateJobHeader (ServiceID,EstimateID)
     SELECT ServiceID, @NewEstimateID 
     FROM EstimateJobHeader
     WHERE EstimateID= @OldEstimateID

/* Copy EstimateDetail records from old estimate to new estimate */
INSERT EstimateDetail (JobHeaderID, OtherCols) 
    SELECT (new.JobHeaderID,ed.OtherCols) 
    FROM EstimateJobHeader new
    INNER JOIN EstimateJobHeader old ON old.EstimateID= @OldEstimateID 
        AND new.EstimateID= @NewEstimateID AND old.ServiceID=new.ServiceID
    INNER JOIN EstimateDetail ed ON ed.JobHeaderID= old.JobHeaderID

/* Copy EstimateJobDetail records from old estimate to new estimate */
INSERT EstimateJobDetail (JobHeaderID, OtherCols)
    SELECT (new.JobHeaderID,ed.OtherCols) 
    FROM EstimateJobHeader new
    INNER JOIN EstimateJobHeader old ON old.EstimateID= @OldEstimateID 
        AND new.EstimateID= @NewEstimateID AND old.ServiceID=new.ServiceID
    INNER JOIN EstimateJobDetail ejd ON ejd.JobHeaderID= old.JobHeaderID 
```

上面的代码假设 ServiceID+EstimateID 在 EstimateJobHeader 表中是唯一的。如果不是这种情况，我需要知道哪些列或哪些列唯一标识表中的行，以便我可以将旧记录与新记录连接起来，并确定关系是 1:1。

最后，为简洁起见，省略了错误检查。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-03T18:03:16.803

看一下 WHILE 语句：

[http://msdn.microsoft.com/en-us/library/aa260676(SQL.80).aspx](http://msdn.microsoft.com/en-us/library/aa260676(SQL.80).aspx)

但是，根据您想要做的事情，可能有更好的、基于集合的方式来做您想要做的事情，并且应该首先考虑这一点。

# c++ - 在 C++ 中存储任意对象的列表

> ID：607458
> 
> 赞同：7
> 
> 时间：2009-03-03T18:01:35.560
> 
> 标签：c++, collections, types

在 Java 中，您可以拥有一个对象列表。您可以添加多种类型的对象，然后检索它们、检查它们的类型并针对该类型执行适当的操作。
例如：（抱歉，如果代码不完全正确，我将从记忆中开始）

```
List<Object> list = new LinkedList<Object>();

list.add("Hello World!");
list.add(7);
list.add(true);

for (object o : list)
{
    if (o instanceof int)
        ; // Do stuff if it's an int
    else if (o instanceof String)
        ; // Do stuff if it's a string
    else if (o instanceof boolean)
        ; // Do stuff if it's a boolean
} 
```

在 C++ 中复制这种行为的最佳方法是什么？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-03-03T18:09:51.047

[`boost::variant`](http://www.boost.org/doc/libs/1_38_0/doc/html/variant.html)类似于 dirkgently 的建议`boost::any`，但支持访问者模式，这意味着以后添加特定于类型的代码更容易。此外，它在堆栈上分配值而不是使用动态分配，从而导致代码效率稍高一些。

**编辑：**正如 litb 在评论中指出的那样，使用`variant`而不是`any`意味着您只能保存来自预先指定的类型列表之一的值。这通常是一种优势，尽管在提问者的情况下它可能是一个弱点。

这是一个示例（虽然不使用访问者模式）：

```
#include <vector>
#include <string>
#include <boost/variant.hpp>

using namespace std;
using namespace boost;

...

vector<variant<int, string, bool> > v;

for (int i = 0; i < v.size(); ++i) {
    if (int* pi = get<int>(v[i])) {
        // Do stuff with *pi
    } else if (string* si = get<string>(v[i])) {
        // Do stuff with *si
    } else if (bool* bi = get<bool>(v[i])) {
        // Do stuff with *bi
    }
} 
```

（是的，从技术上讲，您应该使用`vector<T>::size_type`而不是`int`for`i`的类型，并且`vector<T>::iterator`无论如何您都应该在技术上使用，但我试图保持简单。）

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-03-03T18:51:41.133

您使用 Boost.Variant 和访问者的示例：

```
#include <string>
#include <list>
#include <boost/variant.hpp>
#include <boost/foreach.hpp>

using namespace std;
using namespace boost;

typedef variant<string, int, bool> object;

struct vis : public static_visitor<>
{
    void operator() (string s) const { /* do string stuff */ }
    void operator() (int i) const { /* do int stuff */ }
    void operator() (bool b) const { /* do bool stuff */ }      
};

int main() 
{
    list<object> List;

    List.push_back("Hello World!");
    List.push_back(7);
    List.push_back(true);

    BOOST_FOREACH (object& o, List) {
        apply_visitor(vis(), o);
    }

    return 0;
} 
```

使用这种技术的一个好处是，如果稍后您将另一种类型添加到变体中并且您忘记修改访问者以包含该类型，它将无法编译。你*必须*支持每一个可能的情况。然而，如果您使用 switch 或级联 if 语句，很容易忘记在任何地方进行更改并引入错误。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-03-03T18:04:21.980

C++ 不支持异构容器。

如果您不打算使用`boost`hack，则可以创建一个虚拟类，并让所有不同的类都派生自这个虚拟类。创建一个您选择的容器来保存虚拟类对象，然后您就可以开始了。

```
class Dummy {
   virtual void whoami() = 0;
};

class Lizard : public Dummy {
   virtual void whoami() { std::cout << "I'm a lizard!\n"; }
};

class Transporter : public Dummy {
   virtual void whoami() { std::cout << "I'm Jason Statham!\n"; }
};

int main() {
   std::list<Dummy*> hateList;
   hateList.insert(new Transporter());
   hateList.insert(new Lizard());

   std::for_each(hateList.begin(), hateList.end(), 
                 std::mem_fun(&Dummy::whoami));
   // yes, I'm leaking memory, but that's besides the point
} 
```

如果你打算使用`boost`你可以试试[`boost::any`](http://www.boost.org/doc/libs/1_38_0/doc/html/any.html)。[下面](http://www.boost.org/doc/libs/1_38_0/doc/html/any/s02.html)是一个使用的例子`boost::any`。

您可能会发现这篇由两位感兴趣的领先 C++ 专家撰写的优秀[文章。](http://www.ddj.com/cpp/184403808)

现在，正如[j_random_hacker 所](https://stackoverflow.com/users/47984/jrandomhacker)提到的，`boost::variant`另一件需要注意的事情。因此，这里有一个[比较](http://www.boost.org/doc/libs/1_38_0/doc/html/variant/misc.html#variant.versus-any)，以便对使用什么有一个公平的了解。

上面的`boost::variant`代码看起来像这样：

```
class Lizard {
   void whoami() { std::cout << "I'm a lizard!\n"; }
};

class Transporter {
   void whoami() { std::cout << "I'm Jason Statham!\n"; }
};

int main() {

   std::vector< boost::variant<Lizard, Transporter> > hateList;

   hateList.push_back(Lizard());
   hateList.push_back(Transporter());

   std::for_each(hateList.begin(), hateList.end(), std::mem_fun(&Dummy::whoami));
} 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-03-03T18:13:56.903

这种东西多久有用一次？我已经用 C++ 编程了好几年，在不同的项目上，从来没有真正想要一个异构容器。由于某种原因，它在 Java 中可能很常见（我的 Java 经验要少得多），但是对于在 Java 项目中使用它的任何特定用途，可能有一种方法可以做一些不同的事情，在 C++ 中会更好地工作。

C++ 比 Java 更强调类型安全，这是非常不安全的。

也就是说，如果这些对象没有共同点，为什么要将它们存储在一起？

如果他们确实有共同点，你可以为他们创建一个类来继承；或者，使用 boost::any。如果他们继承，有要调用的虚函数，或者如果你真的必须使用 dynamic_cast<>。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-05T10:26:51.940

我只想指出，使用动态类型转换以基于类型进行分支通常暗示架构中的缺陷。大多数情况下，您可以使用虚函数实现相同的效果：

```
class MyData
{
public:
  // base classes of polymorphic types should have a virtual destructor
  virtual ~MyData() {} 

  // hand off to protected implementation in derived classes
  void DoSomething() { this->OnDoSomething(); } 

protected:
  // abstract, force implementation in derived classes
  virtual void OnDoSomething() = 0;
};

class MyIntData : public MyData
{
protected:
  // do something to int data
  virtual void OnDoSomething() { ... } 
private:
  int data;
};

class MyComplexData : public MyData
{
protected:
  // do something to Complex data
  virtual void OnDoSomething() { ... }
private:
  Complex data;
};

void main()
{
  // alloc data objects
  MyData* myData[ 2 ] =
  {
    new MyIntData()
  , new MyComplexData()
  };

  // process data objects
  for ( int i = 0; i < 2; ++i ) // for each data object
  {
     myData[ i ]->DoSomething(); // no type cast needed
  }

  // delete data objects
  delete myData[0];
  delete myData[1];
}; 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-03T18:08:25.700

遗憾的是，在 C++ 中没有简单的方法可以做到这一点。您必须自己创建一个基类并从该类派生所有其他类。创建一个基类指针向量，然后使用 dynamic_cast（它有自己的运行时开销）来查找实际类型。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-03T19:32:07.993

只是为了这个主题的完整性，我想提一下，您实际上可以使用纯 C 来执行此操作，方法是使用 void* 然后将其转换为必须的任何内容（好吧，我的示例不是纯 C，因为它使用向量，但这样可以节省我一些代码）。如果你知道你的对象是什么类型，或者你在某个地方存储了一个记住它的字段，这将起作用。你肯定不想这样做，但这里有一个例子表明它是可能的：

```
#include <iostream>
#include <vector>

using namespace std;

int main() {

  int a = 4;
  string str = "hello";

  vector<void*> list;
  list.push_back( (void*) &a );
  list.push_back( (void*) &str );

  cout <<  * (int*) list[0] << "\t" << * (string*) list[1] << endl;

  return 0;
} 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-03T23:59:11.910

虽然您不能将原始类型存储在容器中，但您可以创建类似于 Java 的自动装箱原始类型的原始类型包装类（在您的示例中，原始类型文字实际上是自动装箱的）；其实例出现在 C++ 代码中（并且（几乎）可以使用），就像原始变量/数据成员一样。

请参阅[C++ 中具有面向对象设计模式的数据结构和算法](http://www.brpreiss.com/books/opus4/html/book.html)[中的内置类型的对象包装](http://www.brpreiss.com/books/opus4/html/page115.html#SECTION006240000000000000000)器。

使用包装的对象，您可以使用 c++ typeid() 运算符来比较类型。我很确定以下比较会起作用： `if (typeid(o) == typeid(Int))`[其中 Int 将是 int 原始类型的包装类等...]（否则只需将一个函数添加到返回 typeid 的原始包装器中，因此： `if (o.get_typeid() == typeid(Int))`...

话虽如此，就您的示例而言，这对我来说有代码味道。除非这是您检查对象类型的唯一地方，否则我倾向于使用多态性（特别是如果您有其他特定于类型的方法/函数）。在这种情况下，我将使用原始包装器添加一个接口类，该类声明将由每个包装的原始类实现的延迟方法（用于执行“做事”）。有了这个，您将能够使用您的容器迭代器并消除您的 if 语句（同样，如果您只有这一个类型比较，则为此使用多态性设置延迟方法将是矫枉过正）。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-03T18:06:12.367

我是一个相当缺乏经验的人，但这是我会去的 -

1.  为您需要操作的所有类创建一个基类。
2.  编写容器类/重用容器类。（在看到其他答案后修改 - 我之前的观点太神秘了。）
3.  编写类似的代码。

我相信有更好的解决方案是可能的。我也确信有更好的解释是可能的。我了解到我有一些不好的 C++ 编程习惯，所以我尝试在不涉及代码的情况下传达我的想法。

我希望这有帮助。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-03T18:32:38.357

除此之外，正如大多数人所指出的那样，你不能这样做，或者更重要的是，你很可能真的不想这样做。

让我们忽略您的示例，并考虑更接近现实示例的内容。具体来说，我在一个真正的开源项目中看到的一些代码。它试图在字符数组中模拟 CPU。因此，它将根据操作码将一个字节的“操作码”放入数组中，然后是 0、1 或 2 个字节，这些字节可以是字符、整数或指向字符串的指针。为了处理这个问题，它涉及了很多位摆弄。

我的简单解决方案：4 个单独的堆栈<>s：一个用于“操作码”枚举，一个用于字符、整数和字符串。从操作码堆栈中取出下一个，然后将带您获取其他三个中的哪一个来获取操作数。

您的实际问题很有可能以类似的方式得到处理。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-03T18:04:28.283

好吧，您可以创建一个基类，然后创建从它继承的类。然后，将它们存储在 std::vector 中。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-03T18:11:20.670

简短的回答是……你不能。

长答案是......您必须定义自己的新对象层次结构，这些对象都继承自基础对象。在 Java 中，所有对象最终都源自“对象”，这就是允许您执行此操作的原因。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-03-03T18:31:56.797

C++ 中的 RTTI（运行时类型信息）一直很困难，尤其是交叉编译器。

您最好的选择是使用 STL 并定义一个接口以确定对象类型：

```
public class IThing
{
   virtual bool isA(const char* typeName);
}

void myFunc()
{
   std::vector<IThing> things;

   // ...

   things.add(new FrogThing());
   things.add(new LizardThing());

   // ...

   for (int i = 0; i < things.length(); i++)
   {
       IThing* pThing = things[i];

       if (pThing->isA("lizard"))
       {
         // do this
       }
       // etc
   }
} 
```

麦克风

# internet-explorer - Windows XP 与 Windows Vista 上的 IE 6/7

> ID：607466
> 
> 赞同：0
> 
> 时间：2009-03-03T18:03:30.967
> 
> 标签：internet-explorer, windows-vista, web, windows-xp

您是否注意到在 IE 6 或 IE 7 上在 Windows XP 上运行与在 Windows Vista 上运行时网站呈现的显着差异？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-03T18:07:32.160

就我所注意到的而言，渲染是相同的，只要您将苹果与苹果进行比较（意思是：IE7 在两者上看起来都一样，但 IE6 可能与 IE7 看起来不一样）。Vista 可能会执行一些额外的安全措施，但我不知道任何细节。而且在 Vista 上没有 IE6 这样的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T18:06:21.070

浏览器引擎应该呈现相同的内容，但是不太可能在不是通过 VM 或 VirtualPC 运行的 vista box 上安装 IE6 实例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T18:07:51.863

我们最近对 XP 和 Vista 进行了 IE7 测试。在我的记忆中，IE7 在 XP 和 Vista 上没有明显差异。我们没有尝试在 Vista 机器上安装 IE6。

XP 上的 IE6 和 IE7 还是有区别的。我不会详细介绍，因为我相信您可以通过快速搜索轻松找到数百个线程。我们最大的问题是与 ASP .Net Web 应用程序集成时的一些 JavaScript 问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T18:13:51.880

实质性差异？绝对没有

# sharepoint - 具有深层菜单结构的 SharePoint 2007 发布网站

> ID：607497
> 
> 赞同：1
> 
> 时间：2009-03-03T18:09:58.817
> 
> 标签：sharepoint, content-management-system, moss, navigation

我是 SharePoint 的初学者，我需要创建具有多级菜单的发布网站。要求是不固定级别，并且客户端应该能够添加页面和自定义菜单。
如果我没记错的话，页面只能在第一级网站下创建。我没有看到类似文件夹概念的东西。出于导航目的，我可以添加标题，它将显示为另一个级别。如果我需要更多关卡，我需要创建子站点。

```
地点
   第1页
   第2页
   标题
     第3页

```

它是否正确？

```
地点
   第1页
   第2页
   子层_1
     第1_1页
     Sublevel_2
        第2_1页
        Sublevel_3
            第3_1页
         ...

```

我可以在不创建 SharePoint 子网站的情况下执行此类操作吗？如果我不需要，我将跳过编写一些自定义菜单控件或编写自定义 SiteMapProvider。我还需要编写 UI 来管理导航。

**编辑：**
我已经设法在页面列表中创建文件夹并创建（实际移动）页面到该文件夹​​，甚至创建子文件夹，但它们甚至没有显示在菜单上，甚至没有显示在导航设置页面中。我无法批准文件夹，无论我尝试什么，它都处于待处理状态。

我看起来[安德鲁康奈尔不可能做到这一点：MOSS Publishing Sites 的页面库中*不支持子文件夹*](http://andrewconnell.com/blog/archive/2008/05/19/Subfolders-are-not-Supported-in-the-Pages-Library-in-MOSS.aspx)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T23:21:51.997

开箱即用，您可以手动修改发布网站的导航。

我假设您正在寻求一种更自动化的方式来执行此操作。不幸的是，修改 PublishingWeb 导航的方法是通过对象模型和 PublishingWeb.CurrentNavigationNodes 对象，当页面被编辑/添加/删除时，这将需要一个计时器作业或其他一些方法来更新。

This is non-trivial and you will still need to create a solution/feature package. The other way is to create a custom navigation provider. The issue with both of these options (aside from the actual coding and release) is caching the navigation structure. We have used the standard web cache for the object holding the navigation structure, but using the standard user browsing (i.e. the menu code itself) to kick of a refresh of the navigation is fraught with threading issues.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T18:14:54.577

您可以在一个站点中创建多个文档库，然后将页面放入各个库中。这样您就不需要创建子站点

# asp.net - ASP.NET 中的 AS400 数据连接

> ID：607502
> 
> 赞同：4
> 
> 时间：2009-03-03T18:12:59.697
> 
> 标签：asp.net, database, enterprise-library, ibm-midrange

我有一个应用程序将驻留在 business2business 网络中，该网络将在我们的内部网络环境中与我们的 AS400 进行通信。防火墙已配置为允许数据请求通过我们的 AS400，但我们发现连接速度和响应时间存在巨大延迟。例如，在我们的本地开发环境中需要不到半秒的时间在我们的 B2B 环境中需要超过 120 秒。

这是我们用来获取数据的功能。我们使用的是企业库应用程序块，所以 ASI 对象是数据库...

```
/// <summary>
/// Generic function to retrieve data table from AS400
/// </summary>
/// <param name="sql">SQL String</param>
/// <returns></returns>
private DataTable GetASIDataTable(string sql)
{
    DataTable tbl = null;

    HttpContext.Current.Trace.Warn("GetASIDataTable(" + sql + ") BEGIN");
    using (var cmd = ASI.GetSqlStringCommand(sql))
    {
        using (var ds = ASI.ExecuteDataSet(cmd))
        {
            if (ds.Tables.Count > 0) tbl = ds.Tables[0];
        }
    }
    HttpContext.Current.Trace.Warn("GetASIDataTable() END");
    return tbl;
} 
```

我正在尝试集思广益，以考虑为什么会发生这种情况。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-04T01:55:16.763

从未愤怒地使用过 ASP.NET 或 AS400，但我以前见过这种行为，它通常表明某种网络问题，通常是反向 DNS 查找超时。

假设您已通过防火墙启用 ping，请检查您是否可以双向 ping。

还要从每台机器上运行 traceroute 以尝试诊断可能出现延迟的位置。

希望有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-04T01:49:29.257

抱歉，我不能告诉你发生了什么，但我只有几条评论......首先我会输出 sql，看看它是否有很多连接和/或正在访问一个大的表（文件）记录的数量。如果您真的想深入挖掘您选择的分析器（我使用 Ants Profiler）并尝试为 400 找到一个分析器 - 查看服务器资源是什么以及通过 odbc 驱动程序后的实际查询。

我曾多次使用过 asp.net 和 as400，而我最成功的方法实际上是使用 sql server 与 AS400 的链接服务器。我创建了一个视图以使其更易于使用 - 隐藏 as400 命名的奇怪之处。它在我的场景中运行良好，因为应用程序无论如何都需要从 sql server 中提取信息。

我想我会提到它以防万一……祝你好运

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-04T03:39:14.033

还要检查 iSeries 系统的大小。根据查询的大小以及系统对于运行在其上的应用程序而言是否过小，这可能需要一些时间。虽然它不应该作为一种可能性被抛弃，但我过去曾看到过类似的行为。但当然更有可能是网络问题。

如果您可以解决速度问题或大小问题，另一个想法是将其存储在 MS SQL Server 中，然后将记录从 SQL Server 写入 iSeries。

# user-interface - 防止用户错误的 UI 提示

> ID：607505
> 
> 赞同：7
> 
> 时间：2009-03-03T18:13:57.357
> 
> 标签：user-interface

应该遵循哪些 UI/GUI 指南来巧妙地（或不那么巧妙地）指导用户，以免他们自责。

例如，您可能希望高级用户能够“清理”不常用记录的数据库，但如果新用户刚刚花费数小时输入新记录，您不希望新用户尝试该选项 - 他们可能失去它们，因为它们“不经常使用”。请不要解决这个特定问题 - 它只是为了澄清问题。

虽然可以编写一堆业务逻辑来防止某些问题，但您不能考虑用户可能做的所有事情。

*   **有哪些常见的技术、提示和技巧可以防止不当使用？**
    *   即，我应该如何设计界面以提醒用户注意某个功能或操作
*   **如果采取了不良行动，我应该设计什么来限制风险和暴露？**

-亚当

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-03-03T18:16:38.253

一切都可以撤消。不要擦除 - 停用。在每次破坏性操作之前进行备份，并为用户提供恢复方式。

这就是路径。很难一直遵循它，但这就是您的目标。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-03T18:15:52.983

使撤消危险操作成为可能。

如果它是一个相当大的应用程序或系统，那么危险操作也需要单独的管理员访问权限。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-03T18:20:54.530

[不要让我思考](http://www.sensible.com/)

你可以，事实上你必须考虑他们可能做的一切。因为您（作为设计师）是赋予他们做所有这些事情的能力的人。

在将任何项目作为你自己放在 gui 上之前“这会被滥用吗？” 如果可以，您可能希望使用较低级别的可定制性。示例层次结构

*   按钮 - 可以点击。
*   T/F 单选按钮（强制）- 只有两个选项。
*   组合框 - 许多选项，可能是“没有选项”。更令人困惑。
*   文本字段 - 无数非常不一致的选项。对用户来说更混乱，对编码员来说更危险。

基本上，如果用户不需要额外的选项，那么就不要给他们额外的选项。你只会混淆他们。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-03-03T18:18:20.153

这是一篇旧文章，但它仍然是一篇很棒的文章：

[Microsoft 归纳式用户界面指南](http://msdn.microsoft.com/en-us/library/ms997506.aspx)

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-03-03T18:20:12.207

永远不要依赖任何说“你确定吗？”的东西。用户总是确定的，那就是如果他们在解雇之前甚至费心阅读它。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-03-03T18:21:26.197

我的思想流派认为，在不明确或模棱两可的情况下，用户很少出错，而用户界面总是受到指责。所以，当你说“打用户的脸”时，用“pebkac”标记，我认为*你*会用一记耳光做得很好。

不幸的是，我无法提供任何好的 UX 建议，因为我只是一名程序员，因此从定义上或多或少地失去了作为优秀 UI 设计师的资格。我只想指出一种可能性，即您实际上可能是需要获得线索的人，并尝试对用户更加谦虚。

***编辑亚当：***

我对UX知之甚少就是我对它知之甚少。这是一条完整的职业道路。我知道一个事实，在 Stack Overflow 上提出一个让我擅长这个问题的问题几乎没有人能学到东西。这就像我在问“帮助我编写更好的代码”，正文被表述为我的同事如何嘲笑我的代码的故事。

我们，程序员，是工程师。我们喜欢秩序、理性和合乎逻辑的决定。但普通用户不是程序员，不是工程师，而且在许多情况下，对计算机本身一点也不感兴趣。

我很高兴人们给了你一些很好的建议，我很高兴你，与我的第一印象相反（对此我很抱歉），渴望接受这些内容并了解用户的需求。

但重点仍然存在：您需要购买书籍（正如已经推荐的那样，Don't Make Me Think 是一个很好的起点）。您需要观察人们如何使用您的软件。你需要观察他们在哪里绊倒，然后调整事情直到你的 UI 看起来很自然。

对不起，我仍然不能给你答案。因为我没有。即使我*有*它，我也可能不得不向你收取每小时 50 欧元的费用，直到未来数年。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-03-03T18:22:15.633

对您的用户进行分区并拥有细粒度的权限。

定义一些启用“更危险”操作的超级用户权限。

超级用户权限不会轻易授予 - 仅授予实际的超级用户 - 并且很容易撤销。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-03-03T18:24:16.643

使用户操作的结果可见，并提供一种撤消这些更改的方法。

当更改可见时，用户会收到结果是否是他想要做的反馈，如果不是，那么撤消的可能性将让用户再次尝试以达到他的目标。如果可能，在用户调用操作之前使操作的结果可见（例如，当拖动某个元素时，显示如果用户释放鼠标按钮会发生什么，例如可视化添加将要移动的元素并可视化删除元素的移动位置）。

有几种类型的撤消。最简单的是单步撤消（如在记事本中），但通常还不够。更好的是多步骤撤消（如在 Word 中），它涵盖了大多数情况，但不允许撤消特定操作而不撤消其后执行的所有操作。这可以通过特定于对象的撤消来解决，例如在具有许多字段（或 Excel 中的网格中的单元格）的表单中，右键单击该字段将显示该字段中先前值的列表。对于已删除的数据，您可以存储已删除的数据，用户可以在删除后从中恢复内容（例如，如果用户删除了 Powerpoint 中的幻灯片）。最后，您可以获得每个更改的完整版本历史记录，例如[本地历史记录](http://www.jetbrains.com/idea/features/local_history.html)在 IntelliJ IDEA 中工作 - 每次保存文件时都创建一个历史记录条目（并在几秒钟不活动后自动保存所有内容）。

确认对话框没有帮助。用户可能第一次阅读它，但很快在对话框中单击“确定”就变成了一个自动化过程，用户甚至会在对话框出现之前按 Enter。那么确认对话框就变成了不必要的机械工作的来源。用户总是确信要做一些动作，即使他错了——否则他不会做那个动作。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-03T18:22:26.103

好吧，我可以/做一些不同的方式来处理这些类型的事情。

1.  用户文档——首先是为他们提供一些文档以供他们使用，并使系统易于使用。只是一般可用性和描述性名称/操作。
2.  提供带有警告的确认屏幕。完全披露行动将要做什么，黄色框内的警告。它引起了人们的注意，并有助于防止对其他物品的需要。
3.  有一个回滚计划。对于大型风险操作，您可以简单地设置“已删除”标志，或者在他们意外删除/修改意外数据时将数据卸载到各种临时“回收站”。
4.  需要多次批准，对于数据清除操作，尤其是采用两层方法，需要不同用户的批准。

这些只是我的一些想法。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-03T18:36:38.457

有两件事立刻浮现在脑海。

第一个是渐进式披露的概念，即只向用户展示他们需要什么才能完成手头的任务。我们见过多少在一个对话框上有数百个控件的 UI？将控件划分为各自的任务，并且一次只允许用户执行一项任务。对话框上的高级按钮是实现此功能的一种方式，并且此概念具有将高级用户与普通用户分开的额外好处。普通用户不太可能尝试可能超出其技能水平的任务。

第二个是利用向导概念来完成复杂的任务。我知道巫师已经过时了，但如果一项任务真的很复杂，用户通常会喜欢在前几次握住他们的手。WinZip 向导界面就是一个很好的例子。如果您以前从未压缩过文件，此向导将使用逻辑进程引导您完成整个过程。然后，一旦您习惯了它，您就可以更快地切换到经典界面来压缩文件。

当然，要做到这一切，不仅需要开发人员的承诺，还需要管理层的承诺。可悲的是，这就是许多可用性战斗失败的地方。

# php - 访问过的链接颜色变化

> ID：607521
> 
> 赞同：1
> 
> 时间：2009-03-03T18:18:41.883
> 
> 标签：php, html, css

我有这堂课：

```
.news_item_info 
{
    font-size: .7em; 
    color:#000000; 
    text-indent: 30px;
    a:link { color: #000000; }
    a:visited { color: #000000; }   
} 
```

这里有代码：

```
<div class="news_item_info">
    <?php echo $articles[$index]->getPoints(); ?> puntos por <span class="news_item_user"><a href="/index.php?action=user&param=<?php echo $articles[$index]->getUsername(); ?>">
    <?php echo $articles[$index]->getUsername(); ?></a> </span>
    <?php echo $articles[$index]->getElapsedDateTime(); ?> | <span class="comments_count"><a href="<?php echo "/index.php?action=comments&param=".$articles[$index]->getId(); ?>"><?php echo $articles[$index]->getNumberOfComments($articles[$index]->getId()); ?> comentarios</a></span>
</div> 
```

问题是，在我访问用户个人资料后，它显示为灰色，我想保持黑色。

如果有人知道答案，我将不胜感激。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-03T18:20:17.620

发布的 CSS 无效，您必须通过级联定义来限定样式。尝试像这样取消嵌套链接定义：

```
.news_item_info 
{
    font-size: .7em; 
    color:#000000; 
    text-indent: 30px;       
}

.news_item_info a:link { color: #000000; }
.news_item_info a:visited { color: #000000; } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-03T18:20:50.427

你不能那样做 CSS（嵌套块）。

```
.news_item_info 
{
    font-size: .7em; 
    color:#000000; 
    text-indent: 30px;
}

.news_item_info a:link { color: #000000; }
.news_item_info a:visited { color: #000000; } 
```

# c# - 使用 C#.net 的 LINQ

> ID：607524
> 
> 赞同：-1
> 
> 时间：2009-03-03T18:19:17.250
> 
> 标签：c#, .net, linq

如何开始在 C#.net 中学习 LINQ。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-03T18:22:28.397

LINQ 是一个相当大的主题。

我将从[Hooked On LINQ开始](http://www.hookedonlinq.com/)

我学习 Linq 的方式是从[Linq in Action一书](https://rads.stackoverflow.com/amzn/click/com/1933988169)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-03T18:31:27.843

获取[LinqPad](http://www.linqpad.net/)！

它是学习 LINQ 的好方法，支持 LINQ to SQL、LINQ to Objects 和 LINQ to XML，并且预装了 200 多个来自[C# 3.0 in a Nutshell](http://www.albahari.com/nutshell/)书中的示例。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T18:32:44.033

[MSDN LINQ 入门页面](http://msdn.microsoft.com/en-us/library/bb397926.aspx)对我很有帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T18:22:11.487

[http://www.asp.net/learn/](http://www.asp.net/learn/)上的视频很棒。他们有一个关于 Linq 的完整部分，将带您从“新解决方案”到完整的工作示例。

[http://www.asp.net/learn/linq-videos/](http://www.asp.net/learn/linq-videos/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-03T20:45:56.023

我是一名长期的 SQL 开发人员，我发现过渡到学习 LINQ 所需的只是来自 msdn 的[101 个 LINQ 示例](http://msdn.microsoft.com/en-us/vcsharp/aa336746.aspx)。如果您已经了解基于查询的语法的一般性，那么所有基础知识都在那里。我不知道你现有的专业知识是什么，所以我想我会把它扔在那里。

# sql-server - Reporting Services 报表管理器生成报表消息

> ID：607527
> 
> 赞同：0
> 
> 时间：2009-03-03T18:19:46.063
> 
> 标签：sql-server, sql-server-2005, reporting-services

我们正在为我们的报告使用报告服务，并且目前正在使用报告管理器应用程序来允许用户运行报告。可以从防火墙外部访问报表管理器应用程序，因此我们配置了报表服务，以便报表管理器 Web 应用程序位于与报表服务器 Web 服务不同的服务器上。

此配置运行良好，除非用户运行报告时它不会在生成报告时显示“正在生成报告”消息。屏幕没有变化，也没有显示正在生成报告的迹象。它确实正确地生成了报告，并且一切正常，它只是没有给用户任何关于正在生成报告的指示。

当我们将报表管理器和报表服务器 Web 服务放在不同的服务器上时，我才遇到这个问题。我进行了很多搜索，但没有找到任何有关可能导致此问题的原因或如何解决此问题的信息。我非常感谢有关如何解决此问题的任何建议，以便用户确实得到正在生成报告的指示。

在呈现报告之前，“正在生成报告”消息会显示一瞬间。例如，如果一个长报告需要五分钟才能运行，我将在五分钟内什么也得不到，然后一瞬间我会收到“正在生成报告”的消息，然后它会显示报告。

谢谢你，

埃里克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-03T18:21:54.683

在报表服务器上运行它并在显示“生成报表”消息时查看源代码。

当应显示“生成报告”消息时，在另一台服务器上执行相同操作。

我怀疑某些文件/图像可能会丢失。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T20:41:21.150

您是否在两台机器上运行 SQL Profiler 以查看运行报告时发生了什么？我见过三种服务器配置，其中 ReportManager、RS 目录数据库和 SQL 数据库位于不同的机器上，RS 目录机器上的负载很大，导致一切都停止了。

希望这可以帮助，

账单

# c - 带参数调用 obj-c 方法

> ID：607528
> 
> 赞同：9
> 
> 时间：2009-03-03T18:19:55.327
> 
> 标签：c, objective-c, function, methods

我已将 c 风格的函数更改为 Objective-c 方法。作为一种方法，我该如何使用它？

```
 NSString* myfunc( int x )

       is now:

    - (NSString *)myFuncWithParam:(int)x

 c code:  myString = myfunc(x);  // works

 obj-c code: myString = myFuncWithParam(x); // fails to compile. 
```

从答案之一： myString = [object myFuncWithParam:x];

在那种情况下，“对象”会是什么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-03T18:22:07.803

`myString = [object myFuncWithParam:x];`

其中 object 是具有您正在调用的方法的对象。如果你从同一个对象调用它，你将使用'self'。[本教程](http://cocoadevcentral.com/d/learn_objectivec/)可能会帮助您学习 Obj-C。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T18:24:19.030

您需要使用方括号“消息”语法：

myString = [myObject myFuncWithParam: value];

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T18:36:38.143

题外话/老人的胡言乱语：

有一次，当我无聊时，我尝试使用运算符重载为 C++ 创建一个类似于 Obj-C 的语法。我相信我能够得到

```
myString = myObject[myFuncWithParam](value); 
```

去工作。

# asp.net - asp.net - 如何在 ListItem 文本属性中呈现 html 标签？

> ID：607529
> 
> 赞同：2
> 
> 时间：2009-03-03T18:20:02.987
> 
> 标签：asp.net, html, css

我有一个通过服务器端填充的 DropDownList 控件。

我使用 For Each [datarow] 循环并创建一个 New ListItem

DataRow 中有一个 ID 为“Title”的列；此字段可能包含 <B> 或 <I> 标记。（例如“<i>[父职称]</i>中的[职称]”）

我面临的问题是当我 [DropDownList].Controls.Add([ListItem]) 它按字面呈现文本......所以它按字面显示 <B> 或 <I> 标签并且不加粗/斜体字体.

我已经尝试到处寻找答案，有人可以指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-03T18:45:31.867

DropDownList 控件呈现为`select`hhtml 代码中的元素，而 ListItem 控件呈现为`option`元素。`option`元素不支持文本中的 html 格式。一些浏览器可能支持整个`option`文本的某些样式，但没有浏览器支持部分文本的样式。

如果您需要在下拉列表中设置 html 格式，您要么必须使用 DHTML 制作自己的替换下拉列表控件，要么找到已经做过的人。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T18:24:30.433

您可以尝试为每个列表项添加样式属性，但我不确定在不同浏览器中的普遍支持程度。

```
ListItem li = new ListItem(dr["Name"], dr["Course"]);
if (bold) li.Attributes.Add("style", "font-weight:bold");
listcontrol.Items.Add(li); 
```

重新阅读您的问题，我注意到您想在列表中的单个项目中混合正常和粗体文本。我几乎可以肯定这不支持使用标准下拉列表。我认为您需要看看使用模拟下拉列表的基于 CSS 的控件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T18:26:58.727

如果您需要粗体和斜体格式，我建议使用 .net Literal 控件作为下拉列表的占位符。然后在回发或数据绑定时，您可以遍历您的结果集，手动生成 HTML 代码（因为它并不复杂），然后将生成的 HTML 插入到 Literal 控件中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-03-25T09:05:17.373

确实这是不可能的。

尽管它们有一些小缺点，但您有几个选择，因为它们的行为并不完全像下拉列表。在大多数解决方案中，您只能用鼠标选择一个选项，而不是输入几个字符。当然，可以对这种行为进行编程，但这需要一些时间和精力。

我发现的替代方案是：

[来自 marghoob suleman 的 jquery 解决方案](http://www.marghoobsuleman.com/jquery-image-dropdown)

[来自 sanchez salvador 的 jquery 解决方案](http://jquery.sanchezsalvador.com/samples/example.htm)

# .net - 您如何将消息从一个程序传递到另一个程序？

> ID：607530
> 
> 赞同：2
> 
> 时间：2009-03-03T18:20:10.367
> 
> 标签：.net, vb.net, .net-3.0

我有一个 .Net 3.0 应用程序，它需要将一个整数传递给同一台机器上的另一个程序。我正在使用 WCF 服务来执行此操作，但在尝试在本地机器上托管服务时遇到了用户权限问题。任何关于如何实现这一点的想法都将不胜感激。

谢谢，

戴夫

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-03T18:25:36.187

WCF 仍然是要走的路。

通常，对于同一台机器上的进程间通信，您将使用命名管道通道。如果您不使用它，我建议您这样做，然后确定托管错误是什么。

如果两个程序都有正在处理的消息循环，并且您正在发送一个整数，您也可以通过 P/Invoke 层使用对 SendMessage 的调用，但这只是因为您发送的数据等于或小于SendMessage 将允许。较大的消息将需要 WCF 之类的东西。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T18:24:18.733

[System.IO.管道](http://msdn.microsoft.com/en-us/library/system.io.pipes.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T18:24:07.423

[.NET Remoting](http://msdn.microsoft.com/en-us/library/kwdt6w2k(VS.71).aspx)是一种在程序之间传递消息的方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T18:24:14.147

你是如何主持的？请注意，使用 http 的非管理员程序将需要使用端口（在 http.sys 中）的权限。这是通过 netsh (Vista) 或 (IIRC) httpcfg (XP)。

例如，请参见[此处。](https://stackoverflow.com/questions/443640/httplistener-start-accessdenied-error-on-vista)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-09-14T20:36:12.740

**WCF**是要走的路。您应该使用**NetNamedPipeBinding**来保护同一台机器的通信。
更多关于 WCFBindings [https://msdn.microsoft.com/en-us/library/ms730879(v=vs.110).aspx](https://msdn.microsoft.com/en-us/library/ms730879(v=vs.110).aspx)

# objective-c - 如何调试 GNUstep 应用程序？

> ID：607546
> 
> 赞同：2
> 
> 时间：2009-03-03T18:23:15.523
> 
> 标签：objective-c, gnustep

我刚开始在 Windows 上使用 GNUstep 学习 Objective-C，我想知道有哪些类型的调试选项可用？我正在使用 make 来编译和链接代码，但是一旦我运行应用程序，似乎就没有办法单步执行代码并检查变量、调用堆栈或其他任何东西。现在这不是世界末日，如果我能弄清楚如何在 shell 中写入标准输出或某种可见的日志窗口，但是在运行 GNUstep 应用程序时调用 printf 和 NSDebugLog 似乎不起作用.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T18:29:48.177

[如 GNUstep文档](http://www.gnustep.org/resources/documentation/Developer/Base/General/Debugging.html)中所述，您最有可能使用 GDB（可能是 MinGW 品种）。

另请注意，GDB 有许多前端，可以提供更愉快的调试体验。（包括 Emacs 和 Eclipse）

# asp.net - 使用纯 CSS 为 asp:GridView 定义全局站点样式（不使用 VS 皮肤）

> ID：607547
> 
> 赞同：4
> 
> 时间：2009-03-03T18:23:22.277
> 
> 标签：asp.net, css

我正在开发一个相当大的 aspx web 项目，广泛使用 asp:GridViews

默认情况下，我想使用 CSS 在一个地方定义所有网格视图的外观。

据我了解，一种方法是通过 Visual Studio 中的“皮肤”……但我记得不久前做了一些研究，发现很多人鄙视皮肤，并且总是在 asp.net 中使用纯 CSS项目（尽管我不完全记得它们有什么不好的地方）。

所以我的问题是： 1) 是否可以使用纯 CSS 执行此全局默认 asp:GridView 样式 2) 使用 VS Skins 有什么好处，还是纯 CSS 与使用皮肤一样强大且易于维护？

更新：我还想说说 GridView 有许多独特的样式，例如 SelectedRowStyle-BackColor；这对我原来的问题有什么影响吗？如果有人可以发布或链接到任何此类示例，那将非常有帮助。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-04T12:43:53.210

定义样式表并在某处设置这些样式：

```
/**
 * GRIDVIEW STYLES
 **/
.gridview {
        font-family:"arial";
        background-color:#FFFFFF;
        width: 100%;
        font-size: small;
}
.gridview th {
        background: #7AC142;
        padding: 5px;
        font-size:small;

}
.gridview th a{
        color: #003300;
        text-decoration: none;
}
.gridview th a:hover{
        color: #003300;
        text-decoration: underline;
}
.gridview td  {
        background: #D9EDC9;
        color: #333333;
        font: small "arial";
        padding: 4px;
}
.gridview tr.even td {
        background: #FFFFFF;
}
.gridview td a{
        color: #003300;
        font: bold small "arial";
        padding: 2px;
        text-decoration: none;
}
.gridview td a:hover {
        color: red;
        font-weight: bold;
        text-decoration:underline;     
} 
```

然后需要使用 CssClass 和 AlternatingRowStyle-CssClass 设置您的 gridview 以利用这些：

```
<asp:GridView   ID="GridView1"
                runat="server"
                CssClass="gridview"
                AlternatingRowStyle-CssClass="even"> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T18:51:24.363

您可能想要使用对 css 友好的适配器，这将使您从 gridview 中获得更清晰的 html。只需查看 html 输出，并使用 css 正常设置样式。如果你发现需要在 gridview 上定义一些东西，你可以使用全局皮肤来分配一个 css 类，这样你也可以设置它的样式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T18:26:39.337

Gridview 将呈现为 HTML 表格。您可以为它分配一个类并像其他任何表格一样对其进行样式设置。我对 VS Skins 了解不多，但我用这种方式设计了很多网格视图。

# python - 将 postfix 邮件集成到我的 (python)webapp 中

> ID：607548
> 
> 赞同：4
> 
> 时间：2009-03-03T18:23:31.140
> 
> 标签：python, email, message, postfix-mta

我有一个 postfix 服务器监听和接收在 mywebsite.com 收到的所有电子邮件现在我想在自定义界面中显示这些 postfix 电子邮件，并且也为每个用户显示

需要明确的是，mywebsite.com 的所有用户都将获得诸如 someguy@mywebsite.com 之类的邮件地址，他们在我的生产机器上接收电子邮件，但他在 mywebsite.com 的仪表板中内置的自己的控制台中看到这些电子邮件。

因此，为了让用户看到他收到的邮件，我需要创建一个后缀邮件的电子邮件副本，以便 mywebsite（在 django-python 上运行）能够轻松地反映它们。我如何做到这一点。确切地说，这是我的问题，如何将后缀邮件转换为 python 邮件对象（以便我的系统/网站）理解它？

为了清楚起见，我编写了伪代码来实现我想要的：

```
email_as_python_object = postfix_email_convertor(postfix_email)
attachments_list = email_as_python_object.attachments
body = email_as_python_object.body # be it html or whatever 
```

顺便说一句，我已经尝试过 python 附带的默认电子邮件模块，但这对所有情况都不是很方便。甚至我需要手动处理邮件附件（我讨厌）。我只需要一种简单的方法来处理这样的情况（我想知道 postfix 如何理解收到的电子邮件。即..它如何自动找出不同的标题、附件等）。请帮我。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-03T18:50:21.293

你想让 postfix 发送到本地邮箱，然后使用 webmail 系统让人们访问存储的邮件。

不要挂在 postfix 上——它只是一个传输代理——它从一个地方获取消息，并将它们放在另一个地方，它不存储消息。所以 postfix 将通过 SMTP 接收消息，并将它们放入本地邮件文件中。

然后 IMAP 或某些网络邮件系统会将这些邮件显示给您的用户。

如果您希望将邮件集成到您的 web 应用程序中，那么您可能应该运行一个 IMAP 服务器，并使用 python IMAP 库来获取邮件。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-03T19:17:57.623

首先，Postfix 邮件路由规则可能非常复杂，并且您可能首选的解决方案在错误的地方涉及很多诡计。您不想不小心向某些用户显示其他邮件，是吗？其次，尽管 Postfix 几乎可以做任何事情，但它不应该，因为它只是一个 MDA（邮件传递代理）。

您的解决方案最好通过使用 POP3 或 IMAP 服务器（Cyrus IMAPd、Courier 等）来解决。IMAP 服务器可以拥有可以阅读所有用户邮件的“超级用户帐户”。然后，您的 Web 应用程序可以连接到用户邮箱并检索标题和正文。

如果您只想显示主题行，您可以使用特殊的 IMAP 命令和非常低的开销来获取那些。Python IMAP 库并不是最容易理解的 API。我将通过标准库中的示例试一试（未检查！）：

```
import imaplib

sess = imaplib.IMAP4()
sess.login('superuser', 'password')
# Honor the mailbox syntax of your server!
sess.select('INBOX/Luke') # Or something similar. 
typ, data = sess.search(None, 'ALL') # All Messages.

subjectlines = []
for num in data[0].split():
    typ, msgdata = sess.fetch(num, '(RFC822.SIZE BODY[HEADER.FIELDS (SUBJECT)])')
    subject = msgdata[0][1].lstrip('Subject: ').strip()
    subjectlines.append(subject) 
```

这会登录到 IMAP 服务器，选择用户邮箱，获取所有消息 ID，然后（希望）仅获取主题行并将结果数据附加到*主题行*列表中。

要获取邮件的其他部分，请使用*sess.fetch*更改行。有关*fetch*的特定语法，请查看[RFC 2060](http://www.faqs.org/rfcs/rfc2060.html)（第 6.4.5 节）。

**祝你好运！**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T18:35:07.820

我不确定我是否理解这个问题。

如果您希望远程 Web 应用程序能够查看用户的邮箱，您可以安装 pop 或 imap 服务器并使用邮件客户端（您应该能够找到现成的）来阅读电子邮件。或者，您可以编写一些东西来使用 Python 本身附带的相关库来询问 pop/imap 服务器。

如果您想将邮件复制到另一台机器，您可以使用 procmail 并设置操作来执行此操作。可以设置 Postfix 以这种方式调用 procmail。

# php - 请批评我的 PHP 身份验证工作

> ID：607560
> 
> 赞同：11
> 
> 时间：2009-03-03T18:27:03.970
> 
> 标签：php, authentication, login

不久前发布[此](https://stackoverflow.com/questions/443988/simple-authorisation-login-capability-in-php)内容后，我决定在 PHP 中创建自己的注册/身份验证功能。我希望任何人指出缺陷/改进机会，特别是围绕会话中存储的内容......

逻辑流程是：

1 - 用户注册时使用电子邮件作为用户名、“站点名称”，然后构成他们可以访问的任何 url 的一部分，以及至少 6 个字符的密码，其中必须包含字母和数字（我知道这可能会更强大）

2 - 如果用户和站点是唯一的，那么我将这两者以及随机生成的字符串 (salt) 存储在我数据库的 auth 表中的一行中。然后我获取用户密码，将盐连接到它，并将这个加盐密码的 md5 哈希存储在同一数据库行中

3 - 当用户登录时，我获取她输入的密码并将盐连接到它，创建一个 md5 哈希，并将其与我存储在数据库中的内容进行比较 - 如果它们匹配，则用户输入正确的密码，他们的用户名被写入会话

4 - 在每个请求中，我使用存储在会话中的用户名来查询数据库并读取与该用户关联的站点名称。然后我将它与 url 本身中的站点名称进行比较，如果它们匹配，我设置一个可供其余部分或脚本访问的变量（不是全局变量，它只是由我的控制器读取，它决定用户是否可以看到特定页面）如果两个站点名称不匹配，则将用户重定向回登录

我担心有人可以写信给会话，因此如果他们知道他们注册的用户名就可以访问人们的页面吗？您将如何防止这种情况发生？

在有人指责我疏忽之前，这是一个个人学习项目——我不会暴露任何客户数据！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-03T18:46:19.320

1.  为什么是 6 个字符？使其更大，至少需要 6 个（或更多）字符。没有理由将密码中的字符数限制为 6 个。

2.  在会话中放置多个用户名。但要安全地执行此操作，您必须在每次登录时更改盐：

A- 从登录页面：使用现有的盐验证名称和密码。如果有效，则使用新的盐更新用户表盐和密码（您有来自用户的密码，因此您可以再次对其进行 md5 和盐）。将密码的 md5 写入会话。B- 从任何其他页面：将用户和散列密码与数据库进行比较。如果它们不匹配，则重定向到登录页面。

这个想法的缺陷是用户无法在多台机器/浏览器上维护登录。

您的注册系统需要工作。你怎么知道电子邮件地址是有效的？您如何知道注册用户拥有该电子邮件地址？您必须向包含返回您网站的链接的地址发送电子邮件，在您允许帐户访问任何内容之前必须单击该链接。否则，有人可以在其他人的电子邮件地址下注册，以该人的身份进行欺诈性声明，或者只是导致您的网站向该人发送垃圾邮件，让您的网站关闭。

您可能还想调查 CAPTCHA 以限制脚本注册。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-03T18:51:39.073

简短的回答：看起来不错！

长答案：

1.  是的，您应该允许使用更强/更长的密码，否则没关系。只需确保您只接受站点名称的有效 url 部分字符（我会坚持使用 PCRE 字字符）。但是，“验证此电子邮件”系统将是合适的，以确保注册人实际控制所提供的电子邮件地址。
2.  看起来不错。不过，我喜欢 sha1 胜过 md5。
3.  只要您的会话是安全的，您就可以存储的不仅仅是用户名（对于每个页面请求，这将是一个相当昂贵的 SQL 查找 - 继续并存储他们的 PK）。
4.  看起来不错，但应该根据我在 #3 中的评论进行调整

为确保正确处理会话安全，请查看[PHPSec 指南](http://phpsec.org/projects/guide/4.html)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-03T19:00:09.443

*   限制登录速度。记录用户的每次尝试，并在多次尝试失败后将其锁定。随着失败尝试的增加，锁定的时间越来越长。

*   在您的代码中添加静态盐，并将其与数据库中的盐结合使用。然后，如果您的数据库被黑客入侵，他们仍然没有代码中的盐。这种盐不能/不应该改变。

*   用户可以找回密码/重置锁定吗？您将需要收集挑战问题和答案。

*   当用户重置他们的密码时，他们是否必须知道原来的密码？

如果这是一个安全站点，或者只是一个跟踪某人的站点。我知道一些网站，您可以将您的 cookie 从一台机器带到另一台机器进行登录。它总是记得你，但只是一个论坛，所以麻烦的可能性很低。

为什么要对代码和数据库加盐？一旦你的数据库被黑客入侵，你的网站就完蛋了。然而，看到用户倾向于在许多网站上使用相同的密码，帮助破解每个人的财产毫无意义。如果他们也得到了你的代码，那么就会发生皇家搞砸，但让我们尽可能多地设置障碍。

通过默默无闻的安全性是愚蠢的，但多层安全性可以提供帮助。

**关于将用户名放入会话中** 散列用户名、网址和盐。将其存储在数据库和会话中。将其用作身份验证，如果那无效将它们转储到登录名。他们不能将 cookie 复制到另一个站点，他们不会暴露他们的用户名，并且它消除了查询。

您甚至可以在每次浏览 X 次页面时重新生成该加盐值并将其存储在会话中以使其过期，并随着时间的推移使窃取它的用处降低。然后，您将在数据库中存储两种盐。一个用于密码，一个用于身份验证会话值。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-03T18:30:45.350

如果有人正在观看注册表提交，那么他们就会知道您担心他们会弄清楚的信息。第一步：为您的表单使用 HTTPS。

至于加密数据库的东西，我会让其他人对此提出异议。:-)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-03-07T15:44:11.867

> 我担心有人可以写信给会话，因此如果他们知道他们注册的用户名就可以访问人们的页面吗？您将如何防止这种情况发生？

我不确定你是什么意思。有人会如何“写信给会议”？会话 [通常] 是存储在服务器上的文件，客户端无法查看或修改。

如果您担心会话劫持（又名固定），那么您需要启用 SSL 并禁用 URL 字符串中的会话 ID。（见 php.ini 的[session.use_only_cookies](http://www.php.net/manual/en/session.configuration.php#ini.session.use-only-cookies)）

> 4 - 在每个请求中，我使用存储在会话中的用户名来查询数据库并读取与该用户关联的站点名称。然后我将它与 url 本身中的站点名称进行比较，如果它们匹配，我设置一个可供其余部分或脚本访问的变量（不是全局变量，它只是由我的控制器读取，它决定用户是否可以看到特定页面）如果两个站点名称不匹配，则将用户重定向回登录

这听起来像是最大的担忧。网站名称是什么样的？你是如何将它与 URL 匹配的？用正则表达式？

关于这方面的更多细节会很好，因为如果您的访问控制有缺陷，那么您的身份验证质量就无关紧要了。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-04T20:51:49.447

如果我的流程正确，那么如果我知道您的用户名和站点名称，请转到站点名称并给您一个带有用户名的 cookie（因为会话毕竟保存为 cookie），我在 - 没有密码需要吗？那不是缺陷吗？

# asp.net - Visual Studio 开发服务器使用错误的端口

> ID：607562
> 
> 赞同：26
> 
> 时间：2009-03-03T18:28:21.923
> 
> 标签：asp.net, visual-studio, visual-studio-2008, vs-devserver

与我认为已解决但实际上并未解决的[先前问题](https://stackoverflow.com/questions/500957/unable-to-launch-the-asp-net-development-server-because-port-1900-is-in-use)相关...

我认为我的 Visual Studio 2008 安装可能有点混乱。

1.  当我的 ASP.NET 项目设置为使用具有固定端口的 VS Dev Server 时，我收到[链接问题](https://stackoverflow.com/questions/500957/unable-to-launch-the-asp-net-development-server-because-port-1900-is-in-use)中描述的“使用中的端口”错误。
2.  当我的项目设置为使用随机（自动分配）端口号时，它可以工作，但它使用比实际开发服务器端口号小 3 的端口号启动浏览器（例如，如果端口号是 1903，则浏览器启动到[http://localhost:1900/](http://localhost:1900/)）
3.  如果我对项目设置进行更改，在我保存并重新启动 Visual Studio 之前，它们不会“接受”。

任何想法如何追踪这个？

谢谢！

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2009-03-17T17:50:35.357

我有一个类似的问题，它同时袭击了我的两台主机。在调查中，我发现它与 Eset 个人安全有关（猜测最近的更新搞砸了）。为了解决这个问题，我从活动浏览器过滤中排除了 VS2008 - 这是在：设置 -> 高级防火墙设置 -> 防病毒和反间谍软件 -> Web 访问保护 -> HTTP -> webbrowsers

在此处取消选择 vsdev 解决了问题 - 有趣的是，禁用防火墙和防病毒/反间谍软件并没有解决问题，因此如果您运行不同的安全软件，则值得寻找类似的设置

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-03-13T06:51:52.173

首先尝试杀死所有**“WebDev.WebServer.exe”**进程。

*   在解决方案资源管理器中，单击应用程序的名称。
*   在“属性”窗格中，单击“使用动态端口”旁边的向下箭头，然后从下拉列表中选择“假”。这将启用端口号属性的编辑。
*   在“属性”窗格中，单击端口号旁边的文本框并输入端口号。
*   在“属性”窗格之外单击。这将保存属性设置。

希望这可以帮助

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-11-24T15:12:21.267

我完全同意宏的回答。只想分享 Eset Nod32 v5 的解决方案

在**ESET NOD32 v5**中，要允许 Visual Studio 运行开发或 IIS Express 服务器，您必须在 Nod32**高级设置 => Web 和电子邮件 => 协议过滤 => Web 和电子邮件客户端中取消选中 Visual Studio**

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-04T12:35:38.597

奇怪的！

端口号存储在 .sln 文件中。所以，我会先把解决方案文件吹走，重新创建它，看看会发生什么。如果这没有帮助，我会转到 web.config 文件并将其吹走并重新开始。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-11T18:15:59.717

我也遇到了同样的错误信息：

> > 无法启动 Visual Studio 开发服务器，因为端口 [xxxx] 正在使用中。

但是，我没有安装 ESET。相反，我最近在我的机器上安装了 GlassFish 服务器，这导致了问题。因此，在 Windows 任务管理器中，我杀死了它运行的进程，`java.exe`它解决了问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-11-19T10:11:23.560

这也适用于 Visual Studio 2010。

还有更多。

症状：

*   Web（服务）项目配置为在特定端口运行，例如 10080。
*   一段时间后，Visual Studio 出现“<strong>无法启动 Visual Studio 开发服务器，因为端口 '10080' 正在使用中”</li>
*   原因尚不清楚。这可能与 webdev 服务器崩溃有关。
*   重启电脑并不能解决问题。
*   Netstat 不显示端口 10080 的条目
*   在端口 10080 手动启动 WebDev.WebServer40.exe 工作正常。

因为我想从 Visual Studio 开始，所以我移到了端口 10081，然后移到了 10082，今天移到了 10083。我的端口用完了。

**无效的解决方案**：

*   重新启动 Visual Studio
*   调整 Trendmicro 安全设置（无法访问它们）
*   禁用 Forticlient 防病毒/防火墙

**有效的解决方法**：

* * *

*   配置我的项目以手动启动服务器
*   右键项目，选择属性
*   点击标签“网络”
*   选择启动操作“**启动外部程序**”并将其指向**Webdev.Webserver40.EXE** （对我来说：C:\Program Files (x86)\Common Files\Microsoft Shared\DevServer\10.0\WebDev.WebServer40.EXE）
*   命令行参数：**/port:10080 /path:C:\Solution\Project**
*   工作目录：**C:\Solution\Project**
*   在服务器下检查“**使用自定义 Web 服务器**”
*   不要选中任何调试器复选框

* * *

副作用：我的项目*认为*断点没有受到影响。（“未加载符号”）。事实证明他们应该像他们那样工作。

我希望任何人都能找到明确的解决方案，但在此之前，这种解决方法对我有用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-05-11T14:15:28.580

要解决您的问题，只需重新启动 PC。我有同样的问题，我做了同样的事情。

# .net - 如何验证是否需要以编程方式重建项目

> ID：607568
> 
> 赞同：2
> 
> 时间：2009-03-03T18:29:03.030
> 
> 标签：.net, vb.net

我有一个加载项，它执行操作以在当前解决方案中打开项目。在我执行任何这些操作之前，我想验证我是否需要构建项目或现在。有没有办法检查项目是否过时（Up-To-Date = True）？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-07T00:18:42.587

在项目列表中迭代并检查

```
Project.Saved 
```

财产。（[http://msdn.microsoft.com/en-us/library/envdte.project.saved(VS.80).aspx](http://msdn.microsoft.com/en-us/library/envdte.project.saved(VS.80).aspx)）

你的朋友是*ENVDTE*命名空间，

> (..) 程序集包装的 COM 库，其中包含 Visual Studio 核心自动化的对象和成员。库内容与 Visual Studio 的早期版本相比没有变化。所有更改和新功能都包含在 EnvDTE80 中。

# sql-server - 如何在 SQL Server 2000 中禁用登录？

> ID：607569
> 
> 赞同：2
> 
> 时间：2009-03-03T18:29:36.523
> 
> 标签：sql-server

任何人都可以请让我知道我们如何禁用 SQL Server 2000 中的登录。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T18:36:34.353

完全取决于你所追求的。但是禁用用户的简单 SQL 是：

```
ALTER LOGIN [MyUser] DISABLE 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-15T04:32:50.547

在 SQL Server 2000 中，您可以使用[sp_denylogin](http://msdn.microsoft.com/en-us/library/aa933273(SQL.80).aspx)拒绝 NT 登录/组访问。您只能删除 SQL 登录。

SQL Server 2005 +，事情发生了变化。

# c# - 相当于 c# 中的 javax.nio.Buffer.flip()

> ID：607587
> 
> 赞同：3
> 
> 时间：2009-03-03T18:35:00.223
> 
> 标签：c#, java, bytearray

我正在移植一些 java 代码并且需要能够翻转 ( `javax.nio.Buffer.flip()`)。

我正在使用 byte[] 来存储数据，并且我想**翻转**这些字节数组，就像 Buffer 一样，因为我相信 Buffer 类下面也使用 byte[] 。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T18:38:45.470

.NET中没有直接等效的`java.nio`包。异步 IO 通常使用`Stream.BeginRead`/处理`EndRead`，但实际上并不是同一个模型。你能告诉我们你想做什么吗？

编辑：您现在已经提供了您正在尝试做的事情的低级详细信息，但是由于`nio`.NET 中的类没有真正的等价物，您*要么*必须自己编写它们（并非不可能，但很痛苦) 或使用不同的更高级别的类型。例如，您可能可以使用`MemoryStream`- 写入其中，然后返回开始。这*有点*像翻转字节缓冲区。但是，如果没有关于更高级别目标的更多信息，我们无法判断这是否合适。可能有更好的方法来做到这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T19:18:46.420

`ByteBuffer`可以使用`byte[]`（创建自，比如说，`ByteBuffer.wrap`）或非 Java 堆内存（使用创建`ByteBuffer.allocateDirect`）。`byte[]`您可以使用获得底层证券`ByteBuffer.array`。但是在缓冲区上调用`flip`和类似方法不会改变实际数据。而是更改了与数据关联的偏移量。因此，等效`byte`于更改代码与其关联的偏移量。

# sql-server - 将图像数据类型从一个表复制到另一个表

> ID：607589
> 
> 赞同：5
> 
> 时间：2009-03-03T18:36:09.470
> 
> 标签：sql-server

如何在 SQL Server 中将图像数据类型（或 varbinary(max)）从一个表复制到另一个表，而无需先将数据保存到文件中？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-03T18:49:55.333

您从一个表中选择记录并插入到另一个表中。当您在同一个查询中执行此操作时，数据不会离开数据库，因此您不必将其存储在任何地方。

例子：

```
insert into SomeTable (SomeId, SomeBinaryField)
select SomeId, SomeBinaryField
from SomeOtherTable
where SomeId = 42 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-10-01T15:37:04.653

你可以随心所欲地制作复杂的东西。

我更喜欢使用 select 语句解析同一字段中的同一字段，以将图像数据从一个表复制到另一个表。

```
Update [Database].[dbo].[DataTableA$Attachment]
SET [Store Pointer ID] = (SELECT [Store Pointer ID]
FROM [Database].[dbo].[DataTableB$Attachment]
WHERE [No_] = '35975') WHERE [No_] = '35975' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T18:48:31.717

您可以只使用带有 SELECT 子句的插入语句，例如：

```
declare @t1 table (t1 image)
declare @t2 table (t2 image)
insert into @t2 select t.t1 as t2 from @t1 as t 
```

您可以在此处获取有关 INSERT 语句的完整详细信息：

[http://msdn.microsoft.com/en-us/library/ms174335.aspx](http://msdn.microsoft.com/en-us/library/ms174335.aspx)

# ruby-on-rails - 如何调试 cron 未执行给定脚本或其他脚本的问题？

> ID：607599
> 
> 赞同：4
> 
> 时间：2009-03-03T18:38:55.297
> 
> 标签：ruby-on-rails, cron, centos, selinux

我有一个希望每天运行的 Rails 脚本。我知道有很多方法，并且某些人不赞成使用 cron 的`script/runner`方法，但它似乎满足了我的需求。

但是，我的脚本没有按计划执行。

我的应用程序位于`/data/myapp/current`，脚本位于`script/myscript.rb`. 我可以手动运行它而不会出现问题`root`：

```
/data/myapp/current/script/runner -e production /data/myapp/current/script/myscript.rb 
```

当我这样做时，特殊日志文件 ( `log/myscript.log`) 会按预期记录到：

```
Tue Mar 03 13:16:00 -0500 2009 Starting to execute script...
...
Tue Mar 03 13:19:08 -0500 2009 Finished executing script in 188.075028 seconds 
```

我将它设置为`cron`每天早上 4 点运行。 `root`的 crontab：

```
$ crontab -l
0 4 * * * /data/myapp/current/script/runner -e production /data/myapp/current/script/myscript.rb 
```

事实上，它看起来就像在今天早上之前尝试运行的一样！

```
$ tail -100 /var/log/cron
...
Mar  2 04:00:01 hostname crond[8894]: (root) CMD (/data/myapp/current/script/runner -e production /data/myapp/current/script/myscript.rb)
...
Mar  3 04:00:01 hostname crond[22398]: (root) CMD (/data/myapp/current/script/runner -e production /data/myapp/current/script/myscript.rb)
... 
```

但是，我的日志文件中没有条目，并且它应该更新的数据也没有得到更新。日志文件权限（作为测试）甚至设置为全局可写：

```
$ ls -lh
total 19M
...
-rw-rw-rw- 1 myuser apps 7.4K Mar  3 13:19 myscript.log
... 
```

我在 CentOS 5 上运行。

所以我的问题是...

1.  我还能在哪里寻找信息来调试它？
2.  这可能是 SELinux 问题吗？是否有我可以设置或更改的安全上下文来解决此错误？

谢谢！

**更新**

感谢保罗和卢克。事实证明这是一个环境问题，将其捕获`stderr`到日志文件使我能够找到错误。

```
$ cat cron.log 
/usr/bin/env: ruby: No such file or directory

$ head /data/myapp/current/script/runner 
#!/usr/bin/env ruby
require File.dirname(__FILE__) + '/../config/boot'
require 'commands/runner' 
```

将特定的 Ruby 可执行文件添加到命令中就可以了：

```
$ crontab -l
0 4 * * * /usr/local/bin/ruby /data/myapp/current/script/runner -e production /data/myapp/current/script/myscript.rb >> /data/myapp/current/log/cron.log 2>&1 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-03T18:44:36.703

默认情况下，cron 将其输出邮寄给运行它的用户。你可以看看那里。

重定向 cron 运行的脚本的输出非常有用，这样您就可以在日志文件中查看结果，而不是在服务器上查看一些随机用户的本地邮件。

以下是将 stdout 和 stderr 重定向到日志文件的方法：

```
cd /home/deploy/your_app/current; script/runner -e production ./script/my_cron_job.rb >> /home/deploy/your_app/current/log/my_file.log 2>&1 
```

将`>>`标准输出重定向到文件，并将`2>&1`标准错误重定向到标准输出，因此也会记录任何错误消息。

完成此操作后，您将能够检查错误消息以了解实际情况。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T18:44:20.823

当有人发现他们的脚本从命令行运行时无法在 cron 作业中运行时，通常的问题是它依赖于交互式会话具有但 cron 没有得到的某些环境。一些常见的候选者是“PATH”环境，可能还有“HOME”。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2010-09-10T12:38:53.093

在 Linux 上，确保所有配置文件（/etc/crontab、/etc/crond.{daily、hourly、etc}/* 和 /etc/cron.d/*）只能写入用户 root 并且不是符号链接，否则他们甚至不会被考虑。

要允许非 root 和/或符号链接，请为 crond 守护程序指定 -p 选项。

# postgresql - 如何覆盖 CRecordSet 的 SQL，然后重新查询？

> ID：607602
> 
> 赞同：0
> 
> 时间：2009-03-03T18:40:26.607
> 
> 标签：postgresql, visual-c++, odbc, visual-c++-6

我有一个 CRecordSet (Visual C++ 6.0)，我正在使用 ODBC 连接到 postgresql 8.0.8。

__

问题：我将一行插入具有序列 ID（自动增量）的表中，并且我想在插入后检索该 ID。

我不能使用 RETURNING 关键字，这个版本的 PGsql 不支持，但我可以使用 currval('sequence')。

但是，在我的代码中，我需要执行默认查询，然后覆盖它以使用 currval() 执行查询。

据我了解，我只能通过再次调用 CRecordSet::Open() 来覆盖查询，这将创建一个新会话，从而使 currval() 无用。

__

那么：如何覆盖 SQL，然后通过 Requery() 而不是通过 Open() 执行这个新查询？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-05T21:49:35.633

As far as I understand, currval() is not connection specific. You should get the correct value back on the new connection. You could also try and append the 'select currval()' at the end of your INSERT statement.

```
INSERT INTO mytable VALUES (1); SELECT currval('mysequence'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T03:27:56.900

使用 currval()。这是特定于会话且并发安全的。语法在 Imraan Parker 的回答中。

但事实是，对于新会话，没有安全的方法可以获取此信息。

# c# - C# 模型视图控制器

> ID：607605
> 
> 赞同：-1
> 
> 时间：2009-03-03T18:42:02.327
> 
> 标签：c#, model-view-controller, model, view

所以我正在以模型-视图-控制器模式创建一个 C#/Winforms 应用程序。我的视图控制器需要实例化多组对象。对象组是模型的元素和视图的元素。因此，例如一个文本框和该文本框后面的模型。

我想知道最好的方法是否是将所有东西放在某种集合中并用钥匙将它们绑在一起？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T22:54:50.863

在我构建的 WinForm MVC 应用程序中，我通常不允许控制器实例化任何东西（我尝试将“new”关键字保留在我的控制器之外）。

如果我需要一个对象，我会向服务请求它，并且在内部该服务将从数据源（存储库等）中获取该对象，或者在新对象的情况下，它可能会利用某种工厂来给我一个新对象（任何必要的预填充属性都已设置为默认值、运行规则等）。

我喜欢思考这类问题的方式是：如果我没有用于视图的 GUI，而是有用于视图的命令行输入，我将如何使这项工作（并使其可重用）？创建/添加/删除/更新模型的逻辑应该在您的域中的某个地方，而不是在控制器中。然后控制器就成为模型和视图之间的中介。视图变成了一种 I/O 机制，它只是一个更漂亮的命令行界面版本。

希望这是有道理的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T18:48:20.113

您是否考虑过使用 WPF 而不是 WinForms？它有一个更好的类似 MVC 的模型和更强大的内置数据绑定。它可能会解决您的问题并帮助您使用更现代的技术进行构建。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-05T00:25:14.473

也许你应该设计你的模型来匹配视图的需要？那么控制器将只有一个模型传递给视图。

# php - 寻求有关使用 SMS 更新在线数据库的建议

> ID：607606
> 
> 赞同：1
> 
> 时间：2009-03-03T18:42:12.060
> 
> 标签：php, mysql, database, sms

我正在寻找编写一个小型应用程序来接收 SMS 文本消息并将结果记录在在线数据库中。我对 php/mysql 最满意，但可以使用您可能有的任何建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T18:49:26.600

去年夏天我写了一些像这样可爱又小巧的东西，但我使用了一个真正的 SMS 服务器并使用 Twitter 以特定格式接收我的文本消息，然后每隔*n 个*时间单位通过我的 RSS 提要运行一个守护程序服务来获取数据并将其存储在平面文件中。这是一个有趣的练习，而且是免费的，据我所知，没有免费的 SMS 接收器可用。如果你愿意，你可以使用 MySQL，但我觉得你需要一种比 Web 应用程序更适合编写服务的语言（即 PHP）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-04T03:10:59.997

我使用[clickatell](http://www.clickatell.com/developers.php)为 Nagios 设置 SMS 通知。从来没有用它们来接收短信。我的猜测是你可能给了他们一些神奇的 URL，然后他们用一个包含消息中所有数据的 POST 来解决这个问题。

不过，您将找到任何免费的东西。事实上，如果您发送大量短信，您可能会发现 SMS 相当昂贵。当您每周发送 10k 条消息时，即使是 0.01 美元/条消息也很多。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-04T04:49:28.340

如果您正在寻找设置自己的服务器，那么您可以使用[gnokii](http://www.gnokii.org)。您必须物理连接诺基亚手机，一旦收到消息，您就可以将它们添加到数据库中。

# android - 如何更改 RatingBar 的星图？

> ID：607610
> 
> 赞同：29
> 
> 时间：2009-03-03T18:45:19.933
> 
> 标签：android, ratingbar

有了`Android SDK 1.1 r1`，有什么方法可以`RatingBar`用我自己的方式更改小部件类的星形图像？这可能吗？如果是这样，那怎么办？

谢谢。

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2010-02-06T23:35:32.443

不确定 1.1，但是对于 1.6 及更高版本，您可以扩展`Widget.RatingBar`样式并覆盖负责星形可绘制对象的属性（在 中`values/styles.xml`）：

```
 <style name="myRatingBar" parent="@android:style/Widget.RatingBar">
        <item name="android:progressDrawable">@drawable/my_ratingbar_full</item>
        <item name="android:indeterminateDrawable">@drawable/my_ratingbar_full</item>
 </style> 
```

无需继承 RatingBar，只需使用 'style' 属性将此样式传递给它：

```
<RatingBar style="@style/myRatingBar" ... /> 
```

下载 android 源代码并查看 core drawable 文件夹中的 ratingbar_full.xml 以查看要放入的内容`my_ratingbar_full`。

您可以在此处找到更完整的版本： [如何在 Android 中创建自定义评分栏](https://stackoverflow.com/questions/5800657/how-to-create-custom-ratings-bar-in-android)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-05T03:45:53.447

简短的回答是它看起来在技术上是可行的。最简单的方法是根据 RatingBar 源代码创建您自己的 RatingBar（更优雅的是`extend`将原始的 RatingBar 变成您自己的）。从那里您还需要使用原始 RatingBar 源 xml 作为示例创建自己的 RatingBar 样式（或继承和扩展原始 RatingBar 样式）。

在 developer.android.com 上可以使用 git 获取源代码。

我怀疑不鼓励制作自己的评分栏，因为它违背了操作系统的一致外观和感觉。

# tdd - 在数据库而不是假存储库上运行测试是不好的做法吗？

> ID：607620
> 
> 赞同：13
> 
> 时间：2009-03-03T18:49:44.023
> 
> 标签：tdd, domain-driven-design, data-access

我知道优势是什么，并且在处理更复杂的系统时会使用假数据。

如果我正在开发一些简单的东西，我可以很容易地在一个真实的数据库中设置我的环境，并且正在访问的数据非常小，以至于访问时间不是一个因素，我只运行了几个测试。

创建假数据仍然很重要，还是我可以忘记额外的编码并直接跳到真实数据？

当我说真实数据库时，我指的不是生产数据库，而是测试数据库，而是使用真实的实时 DBMS 和与真实数据库相同的模式。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-03-05T20:46:37.877

使用假数据而不是真实数据库的原因是：

1.  速度。如果您的测试很慢，您将不会运行它们。模拟数据库可以使您的测试运行得比其他方式快得多。
2.  控制。您的测试需要成为测试数据的唯一来源。当您使用假数据时，您的测试会选择您将使用哪些假数据。因此，您的测试不可能因为有人以不熟悉的状态离开数据库而被破坏。
3.  秩序独立。我们希望我们的测试能够以任何顺序运行。一个测试的输入不应依赖于另一个测试的输出。当您的测试控制测试数据时，测试可以彼此独立。
4.  环境独立。您的测试应该可以在任何环境中运行。您应该能够在火车上、飞机上、家中或工作中运行它们。他们不应该依赖外部服务。当您使用假数据时，您不需要外部数据库。

现在，如果您正在构建一个小型应用程序，并且通过使用真正的数据库（如 MySQL）可以实现上述目标，那么请务必使用数据库。我愿意。但是不要误会，随着应用程序的增长，您最终将面临模拟数据库的需要。没关系，当你需要的时候做。雅尼。只要确保你在需要时这样做。如果你放手，你会付出代价的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T19:09:37.423

这有点取决于你想测试什么。通常您想测试代码中的实际逻辑而不是数据库中的数据，因此设置一个完整的数据库只是为了运行您的测试是浪费时间。

还要考虑维护测试和测试数据库的工作量。使用数据库测试您的代码通常意味着您正在测试整个应用程序，而不是孤立地测试不同的部分。这通常会导致大量工作使数据库和测试保持同步。

最后一个问题是测试应该独立运行，因此每个测试应该在自己的数据库版本上运行，或者让它保持与测试运行前完全相同的状态。这包括测试失败后的状态。

话虽如此，如果你真的想在你的数据库上进行测试，你可以。有一些工具可以帮助设置和拆除数据库，例如[dbunit](http://www.dbunit.org/)。

我见过有人尝试像这样创建单元测试，但结果几乎总是比实际价值要多得多。大多数在项目中途放弃它，大多数在项目期间完全放弃 ttd，一般认为经验转移到单元测试。

因此，我建议保持测试简单和隔离，并将您的代码封装得足够好，以便可以单独测试您的代码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-03T19:25:18.370

至于 Real DB 不会妨碍您，并且您可以通过这种方式更快地进行操作，我会务实并坚持下去。

在单元测试中，“测试”比“单元”更重要。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-03T19:38:57.603

我认为这取决于您的查询是否在存储库中固定（更好的选择，IMO），或者存储库是否公开可组合查询；例如 - 如果您有一个存储库方法：

```
IQueryable<Customer> GetCustomers() {...} 
```

然后你的 UI 可以请求：

```
var foo = GetCustomers().Where(x=>SomeUnmappedFunction(x));

bool SomeUnmappedFunction(Customer customer) {
   return customer.RegionId == 12345 && customer.Name.StartsWith("foo");
} 
```

这将通过基于对象的虚假 repo，但对于*实际*的db 实现将失败。当然，您可以通过让存储库在内部处理所有查询（无外部组合）来取消这一点；例如：

```
Customer[] GetCustomers(int? regionId, string nameStartsWith, ...) {...} 
```

因为这个不能组合，所以可以单独检查DB和UI。使用可组合查询，如果您希望它有用，就必须自始至终使用集成测试。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-03T18:57:58.967

这取决于数据库是否由测试自动设置，也取决于数据库是否与其他开发人员隔离。

目前它可能不是问题（例如只有一个开发人员）。但是（对于手动数据库设置）设置数据库是运行测试的额外障碍，这是一件非常糟糕的事情。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-03T18:59:10.430

如果您只是在编写一个您绝对知道不会增长的简单一次性应用程序，我认为很多“最佳实践”都被抛在了脑后。

*如果您编写的只是一个简单的“联系我们”表单，则无需*使用DI/IOC 或进行单元测试或模拟您的数据库访问。但是，很难在“简单”应用和“复杂”应用之间划清界限。

换句话说，请使用您的最佳判断，因为对此没有一成不变的答案。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-03T18:59:45.247

假设您想自动执行此操作，最重要的是您可以以编程方式生成初始条件。听起来就是这样，甚至更好的是您正在测试真实世界的数据。

但是，有一些缺点：

您的真实数据库可能无法涵盖代码中的某些条件。如果你有虚假数据，就会导致这种行为发生。

正如您所指出的，您有一个简单的应用程序；当它变得不那么简单时，您将希望拥有可以归类为单元测试和系统测试的测试。单元测试应该针对一个简单的功能，这将更容易处理假数据。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-03T19:19:44.403

只要您不将它们视为“单元”测试，就可以针对该场景执行此操作。那些将是集成测试。您还需要考虑是否会一次又一次地通过 UI 进行手动测试，因为您可能只是自动化了冒烟测试。鉴于此，您甚至可以考虑根本不进行集成测试，而只在功能/用户界面测试级别工作（因为它们已经涵盖了集成）。

正如其他人所指出的那样，很难在复杂/非复杂上划清界限，而且你现在通常会为时已晚:(。如果你已经习惯这样做，我相信你不会得到太多开销。如果不是这样，你可以从中学习:)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-03T18:55:07.520

这是一个非常简单的应用程序，您看不到它在增长，我认为在真实数据库上运行您的测试没有问题。但是，如果您认为此应用程序会增长，那么在测试中说明这一点很重要。

让一切尽可能简单，如果您以后需要更灵活的测试，那就这样做吧。不过要提前计划，因为您不希望在 3 年内拥有一个依赖于旧的和 hacky（对于大型应用程序）测试的大型应用程序。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-03T18:57:39.433

假存储库的一个优点是您的回归/单元测试是一致的，因为您可以预期相同查询的相同结果。这使得构建某些单元测试变得更加容易。

如果您的代码（如果不是只读查询）修改数据，则有几个缺点： - 如果您的代码中有错误（这可能是您测试的原因），您最终可能会破坏生产数据库。即使你没有打破它。- 如果生产数据库随着时间的推移发生变化，尤其是在您的代码执行时，您可能会忘记添加的测试材料，并且以后很难将其从数据库中清除。- 来自访问数据库的其他系统的生产查询可能会将您的测试数据视为真实数据，这可能会破坏未来某处重要业务流程的结果。例如，即使您用某个标志或前缀标记了您的数据，您能否保证访问数据库的任何人都将遵守此模式？

此外，某些数据库受隐私法监管，因此根据您的合同和谁拥有主数据库，您可能会或可能不会被法律允许访问真实数据。

如果您需要在生产数据库上运行，我建议您在可以在高峰时段轻松创建的副本上运行。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-03T19:00:46.057

对数据库运行测试的缺点是速度慢，并且在运行测试之前设置数据库状态很复杂。

如果您对此有控制权，那么直接针对数据库运行测试就没有问题；这实际上是一种很好的方法，因为它比针对虚假数据运行更好地模拟您的最终产品。关键是采取务实的方法，将最佳实践视为指导方针而不是规则。

# windows - 使用 http 复制 Windows 文件

> ID：607625
> 
> 赞同：5
> 
> 时间：2009-03-03T18:50:50.480
> 
> 标签：windows, command-line

是否有 Windows 命令可以将文件从 http url 复制或下载到文件系统？我尝试过使用 copy、xcopy 和 robocopy，但它们似乎不支持 http url。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-03T19:14:53.997

您可以使用 powershell 脚本来完成此操作。
Get-Web [http://www.msn.com/](http://www.msn.com/) -toFile www.msn.com.html

```
function Get-Web($url, 
    [switch]$self,
    $credential, 
    $toFile,
    [switch]$bytes)
{
    #.Synopsis
    #    Downloads a file from the web
    #.Description
    #    Uses System.Net.Webclient (not the browser) to download data
    #    from the web.
    #.Parameter self
    #    Uses the default credentials when downloading that page (for downloading intranet pages)
    #.Parameter credential
    #    The credentials to use to download the web data
    #.Parameter url
    #    The page to download (e.g. www.msn.com)    
    #.Parameter toFile
    #    The file to save the web data to
    #.Parameter bytes
    #    Download the data as bytes   
    #.Example
    #    # Downloads www.live.com and outputs it as a string
    #    Get-Web http://www.live.com/
    #.Example
    #    # Downloads www.live.com and saves it to a file
    #    Get-Web http://wwww.msn.com/ -toFile www.msn.com.html
    $webclient = New-Object Net.Webclient
    if ($credential) {
        $webClient.Credential = $credential
    }
    if ($self) {
        $webClient.UseDefaultCredentials = $true
    }
    if ($toFile) {
        if (-not "$toFile".Contains(":")) {
            $toFile = Join-Path $pwd $toFile
        }
        $webClient.DownloadFile($url, $toFile)
    } else {
        if ($bytes) {
            $webClient.DownloadData($url)
        } else {
            $webClient.DownloadString($url)
        }
    }
} 
```

来源[http://blogs.msdn.com/mediaandmicrocode/archive/2008/12/01/microcode-powershell-scripting-tricks-scripting-the-web-part-1-get-web.aspx](http://blogs.msdn.com/mediaandmicrocode/archive/2008/12/01/microcode-powershell-scripting-tricks-scripting-the-web-part-1-get-web.aspx)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-03T19:07:10.737

我不熟悉 Windows 上可以执行此操作的任何命令，但我总是在 Windows 上下载[GNU wget](http://users.ugent.be/~bpuype/wget/)用于这些和类似目的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-03T19:26:22.783

[卷曲浮现](http://curl.haxx.se/)在脑海中。

```
curl -o homepage.html http://www.apptranslator.com/ 
```

此命令下载页面并将其存储到文件 homepage.html 中。数以千计的选择可用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-12-30T14:48:20.993

使用**[BITSAdmin 工具](https://msdn.microsoft.com/en-us/library/aa362813(v=vs.85).aspx)**（bitsadmin 是 Windows 上的命令行实用程序）

例子 ：

```
bitsadmin /transfer "Download_Job" /download /priority high "http://www.sourceWebSite.com/file.zip" "C:\destination\file.zip" 
```

其中，Download_Job - 您想要的任何相关工作名称

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-03T19:02:38.267

我不记得有任何命令行实用程序。也许您可以使用 JavaScript（使用 WinHttpRequest）实现类似的东西并像这样运行它：

```
wscript your_script.js 
```

或者只是用 wget 安装 msys。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-04T10:11:09.817

只需使用 Win32 api（C 语言中的 1 行代码...）

# linux - 我能否在 Virtualbox 中成功运行这个 Ubuntu (linux) 设置？

> ID：607632
> 
> 赞同：-2
> 
> 时间：2009-03-03T18:52:30.930
> 
> 标签：linux, ubuntu, virtualization, virtualbox, multiple-monitors

有4路DVI输出。[似乎我希望对此有驱动程序支持](http://reviews.cnet.com/graphics-cards/sapphire-radeon-hd-4850/4505-8902_7-33421567-2.html?tag=txt;page)。关于支持 4 个输出的详细信息在网上是粗略的，但似乎是可能的。

我的问题来自 Linux 小组和 Virtualbox 专业人士.... VirtualBox 的无缝方法是否允许我将所有 3 台显示器用于多屏幕。我想坚持使用 Ubuntu 并从我的 VirtualBox 运行 Visual C# 和其他工具。Compiz 效果太神奇了，不需要 Aero Glass。

你觉得怎么样，我的系统能否使用 VirtualBox 和这张显卡的多台显示器？我已经用谷歌搜索了几个小时，仍在寻找答案。

**编辑：**

我昨晚尝试了virtualbox。非常漂亮，虽然我在安装 Visual C#NET 时出错。但是，它不会让你在多个屏幕之间拖动？？？这是主机必须解决的问题，还是访客会话需要对多个显示器进行特殊设置？在谷歌中找不到任何支持带有 virtualbox 的多显示器的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T19:02:38.610

您应该能够很好地配置您的屏幕。不知道 ATI 设置的确切细节，但您应该能够使用[Xinerama](http://en.wikipedia.org/wiki/Xinerama)创建一个大型虚拟桌面，然后只运行 VirtualBox（老实说，我更喜欢[KVM](http://en.wikipedia.org/wiki/Kernel-based_Virtual_Machine)，它运行在提供[本机虚拟化](http://en.wikipedia.org/wiki/Native_virtualization)的现代 CPU 上支持）在其中一台显示器上全屏显示。然后，您将能够拥有三个专用于 Ubuntu 的屏幕，第四个专用于 Windows。

您可能想研究多显示器的非 Xinerama 方法。然后将每个显示器视为其自己的屏幕（因此您的 X 显示器将具有：0.0、:0.1、:0.2 和 :0.3）。您无法在屏幕之间移动应用程序，但您可以获得四个独立的桌面。我个人发现这比在多个显示器上使用单个拉伸桌面的想法更有用；当我使用笔记本电脑作为我的主要系统时，我就是这样做的，当我为我的电脑配备第二台显示器时，我可能会回到这种做事方式。您必须研究 ATI 的这种设置的细节，但 X 服务器支持它，因此只需查看 ATI 驱动程序的文档即可将各个部分组合在一起。

# asp.net - 如何配置社区服务器以使联系我们页面正常工作？

> ID：607634
> 
> 赞同：0
> 
> 时间：2009-03-03T18:54:02.890
> 
> 标签：asp.net, web

我有一个社区服务器网站，我在其中启用了联系我们页面，但出于某种原因，我不知道它不起作用。但是当有人在帖子或论坛上发送评论时，我会在同一封邮件中收到所有通知。

任何人都可以告诉我是什么问题或我该如何解决或配置？

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-03T18:59:50.413

尝试在社区服务器支持站点上发布您的问题。

[http://dev.communityserver.com/forums/](http://dev.communityserver.com/forums/)

你的不是编程问题，也不属于stackoverflow。

# ruby - 如何在 ruby 中读取 INI 文件

> ID：607640
> 
> 赞同：7
> 
> 时间：2009-03-03T18:55:09.517
> 
> 标签：ruby, configuration

如何在 ruby​​ 中读/写 ini 文件。我有一个需要的ini文件

1.  读
2.  更改条目
3.  写出到不同的位置

我将如何在红宝石中做到这一点？这方面的文档很惨淡。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2014-03-29T16:10:12.750

## 使用 InIFile Gem

正如@method 所说，使用[inifile](http://rubygems.org/gems/inifile) gem。还有一个[ini](http://rubygems.org/gems/ini) gem，但我没有使用它。

我发现[这里的](http://www.ruby-doc.org/gems/docs/i/inifile-2.0.1/IniFile.html)[文档](http://rubydoc.info/gems/ini/0.1.1/frames)比gem 页面链接的文档更有用。

例子不多，所以这里有一些代码可以帮助您入门：

## 示例设置

首先，创建一个`/tmp/desktop.ini`包含以下内容的文件：

```
[Desktop Entry]
Version=1.0
Type=Application
Name=Foo Viewer
Comment=The best viewer for Foo objects available!
TryExec=fooview
Exec=fooview %F
Icon=fooview 
```

确保您已从命令行运行`gem install inifile`。

## 示例代码

`/tmp/ini-test.rb`使用以下内容创建一个文件：

```
require 'inifile'
require 'pp'

# read an existing file
file = IniFile.load('/tmp/desktop.ini')
data = file["Desktop Entry"]

#output one property
puts "here is one property:"
puts data["Name"]

# pretty print object
puts "here is the loaded file:"
pp file

# create a new ini file object
new_file = IniFile.new

# set properties
new_file["Desktop Entry"] = {
    "Type" => "Application",
    "Name" => 'test',
    "Exec" => 'command',
}

# pretty print object
puts "here is a object created with new:"
pp new_file

# set file path
new_file.filename = "/tmp/new_ini_file.ini"

# save file
new_file.write()
puts "the new object has been saved as a file to /tmp/new_ini_file.ini" 
```

## 示例结果

运行该文件`ruby /tmp/ini-test.rb`应该会产生如下内容：

```
here is one property:
Foo Viewer

here is the loaded file:
{ this output hidden for brevity }

here is a object created with new:
#<IniFile:0x007feeec000770
 @comment=";#",
 @content=nil,
 @default="global",
 @encoding=nil,
 @escape=true,
 @filename=nil,
 @ini=
  {"Desktop Entry"=>
    {"Type"=>"Application",
     "Name"=>"test",
     "Exec"=>"command",
     "Icon"=>"icon_filename",
     "Comment"=>"comment"}},
 @param="=">

the new object has been saved as a file to /tmp/new_ini_file.ini 
```

根据需要进行修改以满足您的需要。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-03-04T03:25:45.593

我最近使用了[ruby​​-inifile](http://rubygems.org/gems/inifile)。与这里的简单片段相比，也许它有点过分了......

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-09-25T17:02:08.497

这是读取和写入 .ini 文件的模块，对原始文件的更改尽可能少（对于读取人类和机器的文件）：

```
`class IniFileExc < RuntimeError
end

class IniNode
  def initialize(name, value=nil)
    @line_start = -1;
    @line_end = -1;
    @level = 0;
    @name = name;
    @value = value;
    @keys = {};
    @keylist = [];
    @modified = false;
    @deleted = false;
  end
  attr_reader :level,:line_start,:line_end,:name,:value,:keylist,:keys,:modified,:deleted
  attr_writer :level,:line_start,:line_end,:name,:value,:keylist,:keys,:modified,:deleted

def to_str
    return @name.to_s + ' = ' + @value.to_s;
  end

def to_s
    return @value.to_s;
  end
  def to_i
    return @value.to_i
  end
  def to_f
    return @value.to_f;
  end

def 
    insert(key, nil);
    return @keys[key];
  end

def insert(key, value)
    return false  if (@keys.has_key?(key));
    node = nil;
    if (value && ((value.class == IniNode) || (value.class == IniSection)))
      node = value;
    else
      if (@level <= 0)
        node = IniSection.new(key);
      else
        node = IniNode.new(key, value)
      end
    end
    node.line_start = @line_end + 1  if (node.line_start < 0);
    node.level = @level + 1;
    @keys[key] = node;
    @keylist.push(key);
    return true;
  end

def []=(key, value)
    rc = insert(key, value);
    @keys[key].value = value;
    @keys[key].modified = true;
    @modified = true;
  end

def delete(key)
    return false  if (! @keys.has_key?(key));
    @keys[key].deleted = true;
    @modified = true;
  end
end

class IniSection < IniNode
  def initialize(name)
    super(name);
  end

def to_str
    return  ('[' + @name + ']');
  end
end` 
```

```
``class IniFile < IniNode
  def initialize(path, load=true)
    super(path);
    @lines = [];
    reload()  if (load);
  end

def reload
    begin
      input = File.new(@name, "r");
    rescue
      raise;
    else
      prevnode = node = self;
      lineno = 0;
      input.each do |line|
        @lines.push(line);
        parsed_node = parse_line(lineno, line);
        if (parsed_node);
          if (parsed_node.class == IniSection)
            if (parsed_node != node)
              prev_node = node;
              node = parsed_node;
              insert(node.name, node);
              prev_node.line_end = lineno - 1;
            end
          else
            node.insert(parsed_node.name, parsed_node);
          end
        end
        lineno += 1;
      end
      input.close;

```
 node.line_end = @line_end = lineno - 1;
end 
```

end

def parse_line(lineno, line)
    return nil  if (line =~ /^\s*$/);
    return nil  if (line =~ /^\s*#/);
    return nil  if (line =~ /^\s*;/);
    if (line =~ /^\s*[\s*(.+)\s*].*$/)
      rv = IniSection.new($1);
      rv.line_start = lineno;
      rv.level = @level + 1;
      return rv;
    elsif (line =~ /^\s*(\S?.*[^=\s])\s*=\s*(\S?[^#;]*[^#;\s\n]).*$/)
      rv = IniNode.new($1, $2);
      rv.line_start = rv.line_end = lineno;
      rv.level = @level + 2;
      return rv;
    end
    return nil;
  end

def write
    inserted = {};
    @keylist.each do |sect|
      sectnode = @keys[sect];
      next  if (!sectnode.modified || sectnode.deleted);
      if (sectnode.line_end < 0)
        @lines.push("\n");
        @lines.push(sectnode.to_str + "\n");
      end
      sectnode.keylist.each do |key|
        keynode = sectnode.keys[key];
        next  if (!keynode.modified || keynode.deleted);
        if (keynode.line_end < 0)
          if (sectnode.line_end < 0)
            @lines.push(keynode.to_str + "\n");
          else
            idx = sectnode.line_end.to_i;
            inserted[idx] = []  if (! inserted.has_key?(idx));
            inserted[idx].push(keynode.to_str);
          end
        else
          line = @lines[keynode.line_start];
          if (line =~ /^(\s*)(\S?.*[^=\s]\s*=\s*\S?.+[^#;\s])(\s*[#;].*)$/)
            line = $1 + keynode.to_str + $3 + "\n";
          else
            line = line.gsub(/^(\s*)(\S?.*[^=\s]\s*=\s*\S?[^#;]+[^#;\n\s])(.*)$/){
              $1 + keynode.to_str + $3};
          end
          @lines[keynode.line_start] = line;
        end
      end
    end`` 
```

```
 ``deleted = {};
    @keylist.each do |sect|
      sectnode = @keys[sect];
      next  if (!sectnode.deleted && !sectnode.modified);
      if (sectnode.deleted && (sectnode.line_start >= 0) && (sectnode.line_end >= 0) \
          && (sectnode.line_end >= sectnode.line_start))
        for i in sectnode.line_start..sectnode.line_end
          deleted[i] = true;
        end
      end
      sectnode.keylist.each do |key|
        keynode = sectnode.keys[key];
        next  if (!keynode.deleted);
        deleted[keynode.line_start.to_i] = true  \
          if ((keynode.line_start >= 0) && (keynode.line_end >= 0) && (keynode.line_start == keynode.line_end));
      end
    end

```
begin
  file = File.new(@name, 'w');
rescue
  raise(IniFileExc, "Failed to open " + @name + " for writing: #{$!}", caller);
else
  cnt = -1;
  @lines.each do |line|
    cnt += 1;
    if (inserted.has_key?(cnt))
      inserted[cnt].each do |ins|
        file.puts(ins + "\n");
      end
    end
    next  if (deleted[cnt]);
    file.puts(line);
  end
  file.close;
end 
```

end
end`` 
```

`使用示例：`

 ````
 begin
  ini = IniFile.new('file.ini');
  ini['common']['param'] = 'value';
  ini['common'].delete('unused_param');
  ini.delete('unused_section');
  print "Valuable value: ", ini['common']['param'], "\n";
  ini.write;
rescue IniFileExc
  print "Oh, that's not good: ", $!, "\n";
end 
```

希望这可以帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-09-08T17:32:04.370

这是另一种选择： [http ://rubygems.org/gems/ini](http://rubygems.org/gems/ini)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-03T20:06:34.590

如果我理解正确，

```
outFile = File.new('out.ini', 'w')
File.open('in.ini', 'r') do |inFile|
  inFile.each_line do |line|
    # foo is the entry you want to change, baz is its new value.
    outFile.puts(line.sub(/foo=(.*)/, 'foo=baz'))
  end
end
outFile.close 
```

请注意，当您使用`File.open`块时，文件将在块终止时自动关闭。

* * *

## 回答 #6

> 赞同：-4
> 
> 时间：2009-03-03T19:06:46.027

```
file = File.new("your.ini", "r")
  while (line = file.gets)
   puts "#{line}" #additionally make changes
  end
file.close 
```

# c# - 多个 httpmodule 实例

> ID：607641
> 
> 赞同：3
> 
> 时间：2009-03-03T18:55:29.597
> 
> 标签：c#, asp.net, httpmodule

我有一个使用 Web 应用程序的 asp.net 网站，它们都在同一个应用程序池中（有 1 个工作进程）。该网站在其 web.config 文件中加载了一个 httpmodule，奇怪的是，主网站和应用程序都将由 httpmodule 的单独实例提供服务。为什么是这样？由于它们处于同一进程中，因此它们似乎应该使用一个实例。

此外，如果我尝试在应用程序中使用静态变量，它们将指向与 asp.net 网站不同的对象。和以前一样的问题，因为它们在同一个进程中，它们不应该是同一个对象还是.net在进程内部强加某种边界？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T19:03:03.383

IIS 为每个应用程序创建一个单独的 AppDomain。这些 AppDomain 存在于同一个操作系统进程中，但从托管代码的角度来看，它们可以被视为单独的进程。即它们不共享加载的程序集、内存等。

[http://www.odetocode.com/articles/305.aspx](http://www.odetocode.com/articles/305.aspx) [http://weblogs.asp.net/owscott/archive/2007/09/02/application-vs-appdomain.aspx](http://weblogs.asp.net/owscott/archive/2007/09/02/application-vs-appdomain.aspx) [http://msdn.microsoft。 com/en-us/library/system.appdomain(VS.85).aspx](http://msdn.microsoft.com/en-us/library/system.appdomain(VS.85).aspx)

# c# - C# 线程和 this.Invalidate()

> ID：607646
> 
> 赞同：3
> 
> 时间：2009-03-03T18:58:01.197
> 
> 标签：c#, winforms, multithreading, graphics

我正在开发一个**Windows Mobile**应用程序（**Compact Framework 2.0 SP1**），这个代码给我一个错误：

```
 public Image Imagen
        {
            get
            {
                return imagen;
            }
            set
            {
                imagen = value;
                this.Invalidate();
            }
        } 

```

从新线程调用代码。我尝试使用 **InvokeRequired 解决：

```
 public Image Imagen
        {
            get
            {
                return imagen;
            }
            set
            {
                imagen = value;
                if (this.InvokeRequired)
                    this.Invoke(this.Invalidate);
                else
                    this.Invalidate();
            }
        } 

```

但是这一行**this.Invoke(this.Invalidate);** 不编译。我该如何解决这个问题？第一个错误是您可以与在另一个线程上创建的控件进行交互。

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2011-01-18T09:10:48.577

Invalidate 不需要调用。

无效仅包括要由主线程处理的绘制消息以及其余未决消息。但是当您调用无效时绘制并没有完成，并且该线程没有更改控件，因此您不需要对其使用调用。

如果您需要确保刷新控件，则可能无效还不够，您还需要调用更新。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-03T19:25:48.477

试试这个。

为什么这是必要的冗长版本。Invoke 方法不采用特定的 Delegate 类型作为参数，而是采用 System.Delegate 类型。此类型不提供强类型签名的类型。它是基委托类，而是提供了一种通用机制来调用所有委托。

不幸的是，当在 C# 中将方法名称作为委托源传递时，它必须传递给特定的委托类型。否则，C# 不知道要在后台创建什么类型的委托，并且与 VB 不同，它不会生成匿名委托类型。这就是为什么您需要像 MethodInvoker 这样的特定委托类型才能调用该函数的原因。

**编辑**手动定义的 MethodInvoker，因为它在 Compact Framework 中不存在

```
public delegate void MethodInvoker();

public Image Imagen
{
    get { get return imagen; }
    set {
        imagen = value;
        if (this.InvokeRequired)
            this.Invoke(new MethodInvoker(this.Invalidate));
        else
            this.Invalidate();
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T19:01:32.810

函数 Invoke 需要一个委托，因此您可以使用内置的 Action 委托：

```
public Image Imagen
{
    get
    {
        return imagen;
    }
    set
    {
        imagen = value;
        if (this.InvokeRequired)
            this.Invoke(new Action(this.Invalidate));
        else
            this.Invalidate();
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T20:42:47.870

我对**Compact Framework 2.0 SP1**的解决方案是：

```
...

delegate void InvocadorMetodos();

...

        public Image Imagen
        {
            get
            {
                return imagen;
            }
            set
            {
                imagen = value;
                if (this.InvokeRequired)
                {
                    InvocadorMetodos invalida = Invalidar;
                    this.Invoke(invalida);
                }
                else
                    this.Invalidar();

            }
        } 

```

谢谢！

# language-agnostic - 学习标准库资源

> ID：607648
> 
> 赞同：3
> 
> 时间：2009-03-03T18:59:17.153
> 
> 标签：language-agnostic

一个人如何研究开源库代码，尤其是标准库？代码库通常庞大且难以导航。如何找到一些函数或类定义？

我是否搜索下载的源文件？我需要 cvs/svn 吗？也许是网络搜索？我应该只知道标准库的结构吗？有什么参考吗？还是某些 IDE 有这样的功能？还是其他一些工具？没有人如何有效地做到这一点？在任何开源库中这样做的最佳实践是什么？是否有任何关于如何在 Linux/Unix 系统上操作源的约定？特定编程语言有什么区别？

强烈鼓励对该主题进行广泛的介绍。我标记了这个“社区维基”，这样每个人都可以改写和扩展我笨拙的表述！

**更新**：可能没有足够清楚地表达问题。我想要的只是查看某些特定库类或函数的*源代码*。问题主要在于工作组织和可用性 - 我如何在大量资源中导航以找到东西，也许有特定的工具或方法？感觉应该早就存在一些解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T19:22:21.653

需要注意的一件事是，标准库有时（通常？）的优化程度超过了对大多数生产代码的好处。

因为它们被广泛使用，它们必须在各种条件下都表现良好，并且可能充满巧妙的技巧和针对极端情况的特殊逻辑。

也许它们不是初学者学习的最佳选择。

只是一个想法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T19:21:26.867

好吧，我认为只是站点下来阅读图书馆的代码是很疯狂的。我的方法是每当我遇到需要自己实现某些东西时进行搜索，然后研究它在这些库中的实现方式。

还有很多项目/库具有出色的文档，我发现阅读这些文档比阅读代码更重要。在基于 Unix 的系统中，您经常在手册页中找到有价值的信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T19:28:41.933

哇，这是个大问题。

简短的回答：这取决于。

长答案：一些库提供文档，而另一些则不提供。标准库通常都有很好的文档记录，无论您选择的库实现是否包含文档。例如，您可能已经找到了一个没有文档的 c 标准库的实现，但是 c 标准已经存在了足够长的时间，以至于有数百本很好的参考书可供使用。带有超链接的文档是学习新 API 的一种非常有用的方法。无论如何，我首先要看的是图书馆的主要网站

对于缺乏文档的鲜为人知的库，我发现两种不同的方法非常有用。

首先是一个文档生成器。几乎我所知道的每一种语言都有一种。它基本上解析源代码树并创建可用于学习库的文档（通常为 html 或 xml）。有些人在代码中使用特殊格式的注释来创建更完整的文档。JavaDoc 就是一个很好的例子。许多其他语言的文档生成器都借鉴了 JavaDoc。

第二个带有类浏览器的 IDE。这些充当一种即时文档。有些只显示库的界面。其他的包括来自图书馆来源的描述评论。

这两个都需要访问库源（如果您打算实际使用库，这将派上用场）。

许多这些工具和技术同样适用于封闭/专有图书馆。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T20:57:46.323

标准 Java 库的源代码可用。对于 Java 初学者来说，这可能是一本很好的读物。尤其是 Collections 框架是一个很好的起点。以 ArrayList 的实现为例，了解如何在 Java 中实现可调整大小的数组。大多数来源甚至都有有用的评论。

最好的阅读部分可能是您可以立即理解的目的。从简单的部分开始，并尝试遵循隐藏在您从自己的代码中进行的单个调用背后的所有步骤。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-11-27T15:54:31.603

我不时做的事情：

```
apt-get source foo 
```

然后在 Eclipse 中新建 C++ 项目（或其他）并导入。

=> 哇！可浏览！（使用 F3）

# encoding - GUID 中有多少个字符？

> ID：607651
> 
> 赞同：85
> 
> 时间：2009-03-03T18:59:47.573
> 
> 标签：encoding, guid

使用 ASCII 编码，一个 GUID 中有多少个字符？

我对 Microsoft 样式感兴趣，其中包括大括号和破折号。

* * *

## 回答 #1

> 赞同：133
> 
> 时间：2009-03-03T19:02:05.040

来自[MSDN](http://msdn.microsoft.com/en-us/library/aa373931(VS.85).aspx)：

> GUID 是一个 128 位值，由一组 8 个十六进制数字组成，后跟三组每组 4 个十六进制数字，然后是一组 12 个十六进制数字。以下示例 GUID 显示了 GUID 中的十六进制数字分组：6B29FC40-CA47-1067-B31D-00DD010662DA

来自[维基百科](http://en.wikipedia.org/wiki/Globally_Unique_Identifier)：

> 通常会添加大括号来包含上述格式，例如：
> 
> ```
> {3F2504E0-4F89-11D3-9A0C-0305E82C3301} 
> ```

所以在典型的带花括号的十六进制编码中总共有 38 个字符。

-亚当

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2010-07-14T15:49:20.993

## TL；DR：没有。

正如 Adam Davis 所说，Microsoft 风格是 HEX 编码（带有大括号和破折号以使其更具可读性），可以使用 ASCII 字符的子集（0-9 和 AF）来显示，但这并不是专门的 ASCII 编码。

我想重要的是要记住显示 GUID 的微软风格只是 GUID 的表示，它实际上是一个 16 字节的整数值（如 Micheal Trausch 所述）。

您还可以通过将字节转换为不同的字符集（如 ASCII），以不同的、更紧凑的方式呈现它。

从理论上讲，您可以将每个字节显示为扩展的 ASCII 字符（255 个字符），这将允许您将 GUID 保存为 16 个字符长度的字符串。

但它的可读性不是很好，因为它会包含空白字符（CR、空格、制表符等）和其他特殊字符，因此只有当您想以非人类可读的字符格式有效地保存 GUID 时，这才有意义，例如在不支持 GUID 或快速匹配小二进制值的数据库中： [http ://en.wikipedia.org/wiki/Extended_ASCII](http://en.wikipedia.org/wiki/Extended_ASCII)

恕我直言，显示更紧凑的 GUID 的最易读的方法是使用 Base64 编码，它允许您将其保存在长度为 22 个字符的字符串中，并使其看起来像这样：

```
7v26IM9P2kmVepd7ZxuXyQ== 
```

但正如 Jeff Atwood 在他的网站上所说，您还可以将 GUID 推送到 20 个字符的 ASCII85 编码字符串中：

```
[Rb*hlkkXVW+q4s(YSF0 
```

如需更多灵感，请参阅： http: [//www.codinghorror.com/blog/2005/10/equipping-our-ascii-armor.html](http://www.codinghorror.com/blog/2005/10/equipping-our-ascii-armor.html)

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-03-03T19:06:38.197

正如亚当在 MSDN 引用中提到的那样，UUID 是 128 位值。这意味着它们需要 16 字节的 RAM 来保存一个值。文本表示将占用 32 个字节（每个单个字节两个字节），加上 4 个连字符，加上两个括号，如果你想包含它们；这相当于 38 个字节。

请记住，如果您向软件的用户公开 UUID，他们可能会提供带有或不带括号的 UUID。如果您将值存储在任何地方，最好将其存储为 16 字节二进制表示。如果您正在与其他 UUID 实现进行互操作，您可能希望使用基本文本格式来实现互操作性，因为不同的实现在存储二进制 UUID 值时对字节顺序执行不同的操作。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2014-03-31T15:14:01.657

长度取决于编码。您可以使用此代码段获得标准编码和长度：

```
public void Main() 
{
    var guid = Guid.Empty;
    Write(guid, "N"); // 32 characters
    Write(guid, "D"); // 36 characters (default)
    Write(guid, "B"); // 38 characters
    Write(guid, "P"); // 38 characters
    Write(guid, "X"); // 68 characters
}    

private void Write(Guid guid, string format) 
{
    var guidString = guid.ToString(format);
    Console.WriteLine("{0}: {1} ({2} characters)", format, guidString, guidString.Length);
} 
```

有关详细信息，请参阅[Guid.ToString](http://msdn.microsoft.com/en-us/library/97af8hh4%28v=vs.110%29.aspx)方法：

# .net - 自定义日历的 DateTimePicker

> ID：607658
> 
> 赞同：2
> 
> 时间：2009-03-03T19:01:27.053
> 
> 标签：.net, winforms, calendar, globalization

您知道公历以外的日历的任何 DateTimePickers 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T19:13:12.453

您能否更具体地说明您对哪种类型的日历感兴趣？

代码项目上有一个波斯语日历控件：http: [//www.codeproject.com/KB/selection/FarsiLibrary.aspx](http://www.codeproject.com/KB/selection/FarsiLibrary.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-06T05:45:54.977

试试 RadControls：用于 ASP.NET AJAX 的 RadCalendar：[http](http://www.telerik.com/products/aspnet-ajax/calendar.aspx) : //www.telerik.com/products/aspnet-ajax/calendar.aspx 用于 WinForms的 RadCalendar：http: [//www.telerik.com/products/winforms/calendar。 aspx](http://www.telerik.com/products/winforms/calendar.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-06T06:13:12.477

你不能改变 datetimepicker 的文化是不允许本地检查[这个](http://support.microsoft.com/Default.aspx?scid=kb%3ben-us%3b889834&x=18&y=19)

# c# - 将 Object 类型拆箱为原始类型和其他类型（模拟后期绑定）

> ID：607668
> 
> 赞同：0
> 
> 时间：2009-03-03T19:03:11.713
> 
> 标签：c#, .net, binding

我有一个包含每个原始类型、字符串和 INetSerializable 的类 Append 成员的类：

```
 public class TypeAppender
   {
         public void Append(int i ) {}
         public void Append(double d) {}
         public void Append(string s){}i){}
         public void Append(INetSerializable ins){}
    } 
```

从另一个类，我想通过传递 Object 来“一般来说”调用这个方法

说我有类似的东西：

```
class SomeClientClass
{
    TypeAppender _appender=new TypeAppender ();  
    Dictionary<string, Object> _cmdTable =new Dictionary<string, Object>();   

    public void Process()
    {   
        foreach(KeyValuePair<string, Object> pair in cmdTable )   
        {
              _appender.Append(pair.Key);

              Object obj = pair.Value;
              if (obj is int)
                 _appender..Append((int)obj);
              else if (obj is double)
                 _appender..Append((double)obj);
              else if (obj is char)
                 _appender..Append((char)obj);
              else if (obj is string)
                 _appender..Append((string)obj); 
        }
    }     
    public void AddParam<T>(string key, T value)
    {
            _cmdTable.Add(key, value);
    }
} 
```

**问题 #1：** pair.Value 是否会被拆箱为正确的原语？s

**问题 #2：** AddParam 成员函数有什么问题吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T19:06:29.507

不。

使用原样的代码，它将无法编译，因为没有从对象 -> 非对象类型的合适转换。您必须手动将代码转换为适当的类型。

一种选择是提供 Object 类型的 Append 的重载并在那里执行逻辑。

```
void Append(object obj) {
  if ( obj is int ) {
    Append((int)obj);
  } else if ( obj is double) { 
    Append((double)obj);
  ...
} 
```

**编辑**问题 #2

从某种意义上说它可以正常运行并没有错。但是，它似乎并没有为您的应用程序增加任何价值，而不是拥有一个采用对象参数的非通用应用程序。

# c# - 如何以编程方式将 Word 文件转换为 PDF？

> ID：607669
> 
> 赞同：229
> 
> 时间：2009-03-03T19:03:26.363
> 
> 标签：c#, vb.net, pdf, ms-word

我发现了几个开源/免费软件程序，它们允许您将 .doc 文件转换为 .pdf 文件，但它们都是应用程序/打印机驱动程序的种类，没有附加 SDK。

我发现有几个程序确实有一个 SDK，允许您将 .doc 文件转换为 .pdf 文件，但它们都是专有类型，一个许可证 2,000 美元左右。

有谁知道使用 C# 或 VB.NET 解决我的问题的任何干净、廉价（最好是免费）的编程解决方案？

谢谢！

* * *

## 回答 #1

> 赞同：207
> 
> 时间：2009-03-03T20:58:44.043

使用 foreach 循环而不是 for 循环 - 它解决了我的问题。

```
int j = 0;
foreach (Microsoft.Office.Interop.Word.Page p in pane.Pages)
{
    var bits = p.EnhMetaFileBits;
    var target = path1 +j.ToString()+  "_image.doc";
    try
    {
        using (var ms = new MemoryStream((byte[])(bits)))
        {
            var image = System.Drawing.Image.FromStream(ms);
            var pngTarget = Path.ChangeExtension(target, "png");
            image.Save(pngTarget, System.Drawing.Imaging.ImageFormat.Png);
        }
    }
    catch (System.Exception ex)
    {
        MessageBox.Show(ex.Message);  
    }
    j++;
} 
```

这是对我有用的程序的修改。它使用安装了[另存为 PDF 插件的](http://www.microsoft.com/downloads/details.aspx?FamilyID=4d951911-3e7e-4ae6-b059-a2e79ed87041&displaylang=en)Word 2007 。它在目录中搜索 .doc 文件，在 Word 中打开它们，然后将它们保存为 PDF。请注意，您需要向解决方案添加对 Microsoft.Office.Interop.Word 的引用。

```
using Microsoft.Office.Interop.Word;
using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Text;

...

// Create a new Microsoft Word application object
Microsoft.Office.Interop.Word.Application word = new Microsoft.Office.Interop.Word.Application();

// C# doesn't have optional arguments so we'll need a dummy value
object oMissing = System.Reflection.Missing.Value;

// Get list of Word files in specified directory
DirectoryInfo dirInfo = new DirectoryInfo(@"\\server\folder");
FileInfo[] wordFiles = dirInfo.GetFiles("*.doc");

word.Visible = false;
word.ScreenUpdating = false;

foreach (FileInfo wordFile in wordFiles)
{
    // Cast as Object for word Open method
    Object filename = (Object)wordFile.FullName;

    // Use the dummy value as a placeholder for optional arguments
    Document doc = word.Documents.Open(ref filename, ref oMissing,
        ref oMissing, ref oMissing, ref oMissing, ref oMissing, ref oMissing,
        ref oMissing, ref oMissing, ref oMissing, ref oMissing, ref oMissing,
        ref oMissing, ref oMissing, ref oMissing, ref oMissing);
    doc.Activate();

    object outputFileName = wordFile.FullName.Replace(".doc", ".pdf");
    object fileFormat = WdSaveFormat.wdFormatPDF;

    // Save document into PDF Format
    doc.SaveAs(ref outputFileName,
        ref fileFormat, ref oMissing, ref oMissing,
        ref oMissing, ref oMissing, ref oMissing, ref oMissing,
        ref oMissing, ref oMissing, ref oMissing, ref oMissing,
        ref oMissing, ref oMissing, ref oMissing, ref oMissing);

    // Close the Word document, but leave the Word application open.
    // doc has to be cast to type _Document so that it will find the
    // correct Close method.                
    object saveChanges = WdSaveOptions.wdDoNotSaveChanges;
    ((_Document)doc).Close(ref saveChanges, ref oMissing, ref oMissing);
    doc = null;
}

// word has to be cast to type _Application so that it will find
// the correct Quit method.
((_Application)word).Quit(ref oMissing, ref oMissing, ref oMissing);
word = null; 
```

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2012-09-21T11:40:55.627

总结一下 vb.net 用户，免费选项（必须安装办公室）：

Microsoft Office 程序集下载：

*   [用于 Office 2010 的 pia](https://www.microsoft.com/en-us/download/details.aspx?id=3508)
*   [用于 Office 2007 的 pia](https://www.microsoft.com/en-us/download/details.aspx?id=18346)

*   添加对 Microsoft.Office.Interop.Word.Application 的引用

*   将 using 或 import (vb.net) 语句添加到 Microsoft.Office.Interop.Word.Application

VB.NET 示例：

```
 Dim word As Application = New Application()
        Dim doc As Document = word.Documents.Open("c:\document.docx")
        doc.Activate()
        doc.SaveAs2("c:\document.pdf", WdSaveFormat.wdFormatPDF)
        doc.Close() 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2016-11-04T18:51:39.533

只是想补充一点，我使用了 Microsoft.Interop 库，特别是我在这个线程中没有看到的 ExportAsFixedFormat 函数。

```
using Microsoft.Office.Interop.Word;
using System.Runtime.InteropServices;
using System.IO;
using Microsoft.Office.Core;

Application app;

public string CreatePDF(string path, string exportDir)
{
    Application app = new Application();
    app.DisplayAlerts = WdAlertLevel.wdAlertsNone;
    app.Visible = true;

    var objPresSet = app.Documents;
    var objPres = objPresSet.Open(path, MsoTriState.msoTrue, MsoTriState.msoTrue, MsoTriState.msoFalse);

    var pdfFileName = Path.ChangeExtension(path, ".pdf");
    var pdfPath = Path.Combine(exportDir, pdfFileName);

    try
    {
        objPres.ExportAsFixedFormat(
            pdfPath,
            WdExportFormat.wdExportFormatPDF,
            false,
            WdExportOptimizeFor.wdExportOptimizeForPrint,
            WdExportRange.wdExportAllDocument
        );
    }
    catch
    {
        pdfPath = null;
    }
    finally
    {
        objPres.Close();
    }
    return pdfPath;
} 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2009-03-03T19:33:35.213

[PDFCreator](http://sourceforge.net/projects/pdfcreator/)有一个 COM 组件，可从 .NET 或 VBScript（下载中包含示例）调用。

但是，在我看来，打印机正是您所需要的——只需将它与[Word 的自动化](http://www.codeproject.com/KB/office/WordPrint.aspx)功能结合起来，您就可以开始使用了。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-03-03T19:05:15.873

在Joel 的论坛上有完整[的关于将 Word 转换为 PDF 的库](http://discuss.joelonsoftware.com/default.asp?joel.3.533855.12)[的讨论](http://discuss.joelonsoftware.com/default.asp?joel)。来自线程的一些建议：

*   [假设](http://www.aspose.com/categories/file-format-components/aspose.pdf-for-.net-and-java/default.aspx)
*   [pdf创作者](http://sourceforge.net/projects/pdfcreator/)
*   [PDFsharp](http://www.pdfsharp.com/PDFsharp/index.php)

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2016-02-26T10:07:12.750

当有人把 10000 个单词的文件丢给我以转换为 PDF 时，我经历了 Word 到 PDF 的痛苦。现在我在 C# 中完成了它并使用了 Word 互操作，但如果我尝试使用 PC，它会很慢并且崩溃......非常令人沮丧。

这让我发现我可以转储互操作和它们的缓慢......对于我使用的 Excel（EPPLUS），然后我发现你可以获得一个名为 Spire 的免费工具，它允许转换为 PDF......但有限制！

[http://www.e-iceblue.com/Introduce/free-doc-component.html#.VtAg4PmlRhE](http://www.e-iceblue.com/Introduce/free-doc-component.html#.VtAg4PmLRhE)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2019-03-25T09:11:26.830

**`Microsoft.Office.Interop.Word`用于在 PDF 中转换 WORD 的简单代码和解决方案**

```
using Word = Microsoft.Office.Interop.Word;

private void convertDOCtoPDF()
{

  object misValue = System.Reflection.Missing.Value;
  String  PATH_APP_PDF = @"c:\..\MY_WORD_DOCUMENT.pdf"

  var WORD = new Word.Application();

  Word.Document doc   = WORD.Documents.Open(@"c:\..\MY_WORD_DOCUMENT.docx");
  doc.Activate();

  doc.SaveAs2(@PATH_APP_PDF, Word.WdSaveFormat.wdFormatPDF, misValue, misValue, misValue, 
  misValue, misValue, misValue, misValue, misValue, misValue, misValue);

  doc.Close();
  WORD.Quit();

  releaseObject(doc);
  releaseObject(WORD);

} 
```

**添加此过程以释放内存：**

```
private void releaseObject(object obj)
{
  try
  {
      System.Runtime.InteropServices.Marshal.ReleaseComObject(obj);
      obj = null;
  }
  catch (Exception ex)
  {
      //TODO
  }
  finally
  {
     GC.Collect();
  }
} 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-03T19:32:20.443

似乎是这里的一些相关信息：

[在 ASP.NET 中将 MS Word 文档转换为 PDF](https://stackoverflow.com/questions/159744/converting-ms-word-documents-to-pdf-in-asp-net)

此外，由于 Office 2007 具有发布到 PDF 功能，我想您可以使用办公自动化在 Word 2007 中打开 *.DOC 文件并另存为 PDF。我不太热衷于办公自动化，因为它速度慢且容易挂起，但只是把它扔在那里......

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-03-24T11:48:23.373

Microsoft PDF add-in for word 似乎是目前最好的解决方案，但您应该考虑到它不会将所有 word 文档正确转换为 pdf，在某些情况下，您会看到 word 和输出 pdf 之间存在巨大差异。不幸的是，我找不到任何可以正确转换所有 word 文档的 api。我发现确保转换 100% 正确的唯一解决方案是通过打印机驱动程序转换文档。缺点是文档需要排队并一一转换，但您可以确定生成的 pdf 与 word 文档布局完全相同。我个人更喜欢使用UDC（通用文档转换器）并在服务器上安装了Foxit Reader（免费版），然后通过启动“进程”并将其动词属性设置为“打印”来打印文档。

# windows - Windows shell 命令获取当前目录的完整路径？

> ID：607670
> 
> 赞同：309
> 
> 时间：2009-03-03T19:03:26.550
> 
> 标签：windows, batch-file, command-line, cmd

是否有可用于获取当前工作目录的完整路径的 Windows 命令行命令？

另外，如何将此路径存储在批处理文件中使用的变量中？

* * *

## 回答 #1

> 赞同：484
> 
> 时间：2009-03-03T19:05:28.947

如果您直接使用`cd`shell，或者`%cd%`如果您想在批处理文件中使用它（它的行为类似于环境变量），则不带参数使用。

* * *

## 回答 #2

> 赞同：118
> 
> 时间：2013-07-04T08:13:40.280

您可以按如下方式设置批处理/环境变量：

```
SET var=%cd%
ECHO %var% 
```

来自 Windows 7 x64 cmd.exe 的示例屏幕截图。

![在此处输入图像描述](https://i.stack.imgur.com/6s6Xi.jpg)

***更新：***如果你做 a`SET var = %cd%`而不是`SET var=%cd%`，下面会发生什么。感谢杰布。

![在此处输入图像描述](https://i.stack.imgur.com/S2Kmp.jpg)

[从批处理文件中捕获当前目录](http://blogs.msdn.com/b/oldnewthing/archive/2005/01/28/362565.aspx "从批处理文件中捕获当前目录")

* * *

## 回答 #3

> 赞同：55
> 
> 时间：2009-03-04T11:55:31.033

`set`引用命令 ( )的 Windows 帮助`set /?`：

```
如果启用了命令扩展，那么有几个动态的
可以扩展但不显示的环境变量
SET 显示的变量列表。这些变量值是
每次扩展变量的值时动态计算。
如果用户明确定义了具有这些名称之一的变量，则
该定义将覆盖下面描述的动态定义：

%CD% - 扩展为当前目录字符串。

%DATE% - 使用与 DATE 命令相同的格式扩展到当前日期。

%TIME% - 使用与 TIME 命令相同的格式扩展到当前时间。

%RANDOM% - 扩展为 0 到 32767 之间的随机十进制数。

%ERRORLEVEL% - 扩展为当前的 ERRORLEVEL 值

%CMDEXTVERSION% - 扩展到当前的命令处理器扩展
    版本号。

%CMDCMDLINE% - 展开到调用
    命令处理器。

```

注意**`%CD% - expands to the current directory string.`**部分。

* * *

## 回答 #4

> 赞同：30
> 
> 时间：2009-03-03T19:06:11.457

在 Unix 上？

密码

* * *

## 回答 #5

> 赞同：27
> 
> 时间：2013-03-03T00:29:45.693

这一直对我有用：

```
SET CurrentDir="%~dp0"

ECHO The current file path this bat file is executing in is the following:

ECHO %CurrentDir%

Pause 
```

* * *

## 回答 #6

> 赞同：22
> 
> 时间：2013-10-01T13:46:10.307

对于 Windows，我们可以使用

`cd`

对于 Linux

`pwd`

命令在那里。

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2015-08-17T17:01:34.617

***在 Windows 上：***

**CHDIR** 显示或更改当前目录的名称。

***在 Linux 中：***

**PWD** 显示当前目录的名称。

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2018-09-12T18:57:38.937

在下创建一个`.bat`文件`System32`，让我们将其命名`copypath.bat`为复制当前路径的命令*可以是*：

```
echo %cd% | clip 
```

**说明：**

`%cd%`会给你当前的路径

```
CLIP

Description:
    Redirects output of command line tools to the Windows clipboard.
    This text output can then be pasted into other programs.

Parameter List:
    /?                  Displays this help message.

Examples:
    DIR | CLIP          Places a copy of the current directory
                        listing into the Windows clipboard.

    CLIP < README.TXT   Places a copy of the text from readme.txt
                        on to the Windows clipboard. 
```

现在`copypath`可以从任何地方获得。

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2009-03-03T19:10:20.760

对于 Windows，`cd`它本身会显示当前的工作目录。

对于 UNIX 和类似工作的系统，`pwd`将执行相同的任务。您还可以`$PWD`在某些 shell 下使用 shell 变量。我不确定 Windows 是否支持通过 shell 变量获取当前工作目录。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2009-03-03T19:23:37.623

基于对 chdir 帖子的评论中的后续问题（将数据存储在变量中），我打赌他想存储当前路径以在更改目录后恢复它。

原始用户应该查看“pushd”，它会更改目录并将当前目录推送到可以使用“popd”恢复的堆栈上。在任何现代 Windows cmd shell 上，这是制作批处理文件的方式。

如果您真的需要获取当前路径，那么现代 cmd shell 也有一个 %CD% 变量，您可以轻松地将其塞入另一个变量中以供参考。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2016-01-30T10:09:55.240

在 Windows 命令提示符下，`chdir`或`cd`将在控制台中打印当前工作目录的完整路径。

如果我们想复制路径，那么我们可以使用：`cd | clip`。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2013-07-04T08:30:27.233

```
@echo off
for /f "usebackq tokens=*" %%x in (`chdir`) do set var=%%x
echo The currenct directory is: %var% 
```

但是，*当然*，gmaran23 的答案要容易得多。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-05-24T10:12:41.660

作为可能的代码之一

```
 echo off
    for /f "usebackq tokens=* delims= " %%x in (`chdir`) do set var=%var% %%x
    echo The current directory is: "%var:~1%" 
```

* * *

## 回答 #14

> 赞同：-2
> 
> 时间：2016-09-29T11:04:00.427

在 Windows 上，键入`cd`当前工作路径。

在 Linux 上，`pwd`用于当前工作路径。

# php - 使用 jQuery 设置 PHP $_SESSION['var']

> ID：607673
> 
> 赞同：34
> 
> 时间：2009-03-03T19:04:01.493
> 
> 标签：php, jquery, session-variables

我需要使用 jQuery 设置一个 PHP $_SESSION 变量。如果用户单击图像，我想将与该图像关联的一条信息保存为 php.ini 中的会话变量。

我想我可以通过调用 php 页面或函数并将该信息附加到查询字符串来做到这一点。

有任何想法吗。我通过谷歌几乎没有找到帮助。

谢谢迈克

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2009-03-03T19:16:22.290

你不能单独通过 jQuery 来做到这一点；您将需要 Ajax（可以使用 jQuery）和 PHP 后端的组合。一个非常简单的版本可能如下所示：

**HTML：**

```
<img class="foo" src="img.jpg" />
<img class="foo" src="img2.jpg" />
<img class="foo" src="img3.jpg" /> 
```

**Javascript：**

```
$("img.foo").onclick(function()
{
    // Get the src of the image
    var src = $(this).attr("src");

    // Send Ajax request to backend.php, with src set as "img" in the POST data
    $.post("/backend.php", {"img": src});
}); 
```

**PHP（后端.php）：**

```
<?php
    // do any authentication first, then add POST variable to session
    $_SESSION['imgsrc'] = $_POST['img'];
?> 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-03T19:08:40.093

可能想尝试将 PHP 函数放在另一个 PHP 页面上，并使用 AJAX 调用来设置变量。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-03T19:09:27.627

您正在寻找的是[jQuery Ajax](http://docs.jquery.com/Ajax)。然后只需设置一个 php 页面来处理请求。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-03T20:51:46.353

这里的很多回复都在解决如何而不是为什么。PHP $_SESSION 键/值对存储在服务器上。这与存储在浏览器上的 cookie 不同。这就是为什么您能够从 PHP 和 JavaScript 访问 cookie 中的值的原因。更糟糕的是，来自浏览器的 AJAX 请求不包括您为网站设置的任何 cookie。因此，您必须让 JavaScript 提取会话 ID cookie 并将其包含在每个 AJAX 请求中，以便服务器能够对其进行正面或反面。从好的方面来说，如果 cookie 没有与 HTTP 标头一起发送，PHP 会话被设计为故障转移到 HTTP GET 或 POST 变量。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2010-03-23T00:29:14.673

在 (backend.php) 中一定要包含 include

session_start();

-泰勒 [http://www.hawkessolutions.com](http://www.hawkessolutions.com)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2011-03-21T10:43:56.430

我还自己设计了一个“php session value setter”解决方案（类似于 Luke Dennis 的解决方案。这里没什么大不了的），但是在设置了我的 session 值之后，我的需求是“跳转到另一个 .php 文件”。好的，我做到了，在我的 jquery 代码中......但有些东西不太奏效......

我的问题很简单：

- 在你“$.post”你的值到小的 .php 文件之后，你应该等待一些“成功/失败”返回值，并且只有在读取这个成功值之后，才执行跳转。如果您只是立即跳转到下一个大 .php 文件，您的会话值可能尚未设置到 php 会话运行时引擎上，并且您可能会在执行 $_SESSION["my_var"]; 时读取“空” 从目标 .php 文件。

就我而言，为了纠正这种情况，我以这种方式更改了我的 jQuery $.post 代码：

```
$.post('set_session_value.php', { key: 'keyname', value: 'myvalue'}, function(ret){
    if(ret==0){
        window.alert("success!");
        location.replace("next_page.php");
    }
    else{
        window.alert("error!");
    }
}); 
```

当然，你的 "set_session_value.php" 文件，应该返回 'echo "0"; ' 或 '回显“1”；'（或您可能需要的任何成功值）。

问候。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-05-05T09:50:35.277

类似于卢克的答案，但使用 GET。

将此 php 代码放在 php 页面中，例如。获取页面.php：

```
<?php
$_SESSION['size'] = $_GET['size'];
?> 
```

然后使用这样的 jQuery 脚本调用它：

```
$.get( "/getpage.php?size=1"); 
```

同意费德里科。在某些情况下，您可能会在使用 POST 时遇到问题，但不确定它是否与浏览器相关。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-09-17T09:16:15.253

如果您在 javascript 部分将 onClick() 更改为 click()，它适用于 firefox。

```
$("img.foo").click(function()
{
    // Get the src of the image
    var src = $(this).attr("src");

    // Send Ajax request to backend.php, with src set as "img" in the POST data
    $.post("/backend.php", {"img": src});
});
```

# user-interface - 触摸屏上最小的按钮尺寸

> ID：607675
> 
> 赞同：3
> 
> 时间：2009-03-03T19:04:05.223
> 
> 标签：user-interface, touchscreen

我参与为医疗设备编写触摸屏应用程序。该程序类似于信息亭，因为用户无法访问开始菜单等，并且用户将使用屏幕键盘在他们需要的罕见事件中键入任何文本。指定的屏幕尺寸为 1280x1024。

问题是：合理界面的最小可触摸按钮尺寸是多少？我认为美国一角硬币在各个方向上都是合理的最小尺寸，原因是一角硬币的大小与我们可以预期人们用手指感觉到的一样小（它的直径为 17.91 毫米，根据万能的维基百科）。

还是大尺寸的一角钱？

编辑：关于我们用户的一些额外知识。由于设备的性质，他们必须有双手，而且他们不会戴手套。他们必须能够操作尺寸最大为 14x17 英寸的胶卷盒（同样，由于设备的性质），所以我有理由相信他们有一定的手动灵活性。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T19:12:33.407

有很多因素会导致按钮变得更大。

根据我的经验，我会使用不小于美国 25 美分硬币的东西——一角硬币对于重复使用来说实在是太小了。如果用户会戴手套或其他东西来“增肥”手指，那么您将需要更大的按钮。如果您的用户有残疾或运动控制不佳（比您预期的更常见），那么一角钱大小的按钮绝对没用。请记住，某些触摸屏并不是特别准确。我已经使用了一些在边缘附近最多 25 像素的东西。

此外，他们多久按一次按钮，屏幕上有多少个按钮？必须按顺序点击许多小的触摸屏按钮会让用户发疯。这就是您会注意到许多触摸屏系统（例如 ATM）开始具有超过 1 英寸 x 2 英寸的按钮的原因之一。

此外，如果他们不小心按下了错误的按钮，系统的容错能力如何？Mabye是因为屏幕关闭还是他们从某个角度观看？它的容错性越差，你的按钮就需要越大。错误发生。较小的按钮意味着更多的错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T19:16:01.310

这在很大程度上取决于设备本身以及您在其上放置的 UI。

许多触摸屏（不包括多点触控）平均触摸区域，因此您可能不想将 UI 项目放置在比指尖区域更近的位置以减少误触。

触摸屏需要在安装后进行校准，即便如此，根据屏幕类型或观看屏幕的自然角度，仍可能存在一些视差。

您还可以考虑在触地时提供视觉反馈，并且仅在触地释放时让事件通过。当你得到触摸时，以接触点为中心显示一个大于指尖的 x 并让它跟踪，直到触摸被释放。该点就是点击点。

最重要的是，用户测试，用户测试，用户测试。

如果您真的担心大小 - 让它变得流畅，以便您可以轻松更改它并在真实情况下在真实用户身上进行测试。我提到用户测试了吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T19:29:12.307

取决于很多因素...

所有触摸屏都会随着时间的推移而退化，并且随着时间的推移会产生更不准确、更嘈杂和更少线性的结果。随着时间的推移，电阻式触摸屏已经有了很大的改进，但您仍然会遇到问题，尤其是对于如此大的触摸屏。

此外，人们有不同大小的手指，以及不同程度的手/眼协调。

最后，在触摸进入您的应用程序之前实际处理触摸的硬件和软件需要进行校准和表征。

所以这真的比仅仅询问按钮需要多大要困难得多。

首先，我会与触摸屏本身的制造商以及硬件/软件接口的制造商交谈，并了解他们的建议。

其次，我会做一些测试——在屏幕上制作几个目标，然后记录触摸屏硬件在您按下它们时向您发送的所有点。对快速猛击、长按、轻按等进行一系列测试。查看输入跳跃的幅度（您可能会感到惊讶……）以及它实际响应的速度（重过滤可能会使压力迟到，这可能会在没有快速反馈的情况下降低可用性）。

第三，我会设计用户界面以获得良好的用户反馈。使按钮比手指宽，这样当用户按下它时，他们仍然能看到按钮的一小部分，并且在按下它时它看起来会被压下。

第四，我会考虑增加适应性学习。您必须偶尔运行校准并重新运行，但在此期间您可以稍微调整以适应用户以减少出错的可能性。但是，它不适合胆小的人，而且很容易做错，所以如果你想考虑它，请小心。

-亚当

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-03T19:37:33.723

我会在某种程度上同意[James](https://stackoverflow.com/questions/607675/smallest-button-size-on-a-touchscreen/607723#607723)的观点，即美国 25 美分是一个更好的目标，但通常你可以改变它，所以它在一个维度上是一个美国四分之一，另一个是一美分。当然，您希望将活动 UI 元素的中心彼此分开至少一美分的距离，具体取决于单击错误元素的“可解决性”程度。（如果正在做的只是选择它，单击列表中的错误元素很容易解决；单击对话框的退出按钮不是那么多。）

确保让您最常见的案例变得非常容易。这通常意味着制作一个非常大的按钮。或者，有时，使整个 UI 区域“可点击”（但如果你这样做，用户通常会更好地看到该区域中的某种按钮以暗示他们可以点击它。）

根据触摸屏的质量，您通常可以在边缘“作弊”。边缘和角落不仅在传统的基于鼠标的界面上最容易被击中，而且它们也可以用于基于触摸屏的界面，因为用户可以将手指直接按在框架元素上，而不必担心触发其他东西. 如果 UI 元素也靠近边缘，请确保它们接受一直到屏幕边缘的点击。使用它，您可以在每个角落都有一个美国硬币大小的按钮，该按钮仍然可以重复点击（尽管如果您的用户手指较大，可能会缺乏反馈）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-06T10:01:46.687

越大越好，因为我们知道尺寸很重要。

当点击屏幕上的某个地方时，触摸屏界面的用户获得反馈很重要，因为这不能像普通键盘或鼠标按钮那样是机械的，我们使用声音和/或改变颜色。

仅在单击控件时播放声音，而不是在屏幕上的任何位置每次触摸时播放声音，以实现良好的可用性。

如果工作环境嘈杂，您也必须提供颜色反馈，在这种情况下，按钮应该比手指大两倍或三倍。当用户的手在屏幕上时，用户可以看到反馈很重要，而且您知道手不是来自玻璃的。

在屏幕上订购也很重要。对于鼠标驱动的界面，使用下拉组合框、菜单等是好的，但对于触摸屏，你会扼杀它们的可用性。因此，不要将控件放在屏幕的左上角，而是将它们放在右下角。这将使您的用户在工作时可以在屏幕上解放双手信息区域。

想想左/右手布局，以及日/夜配色方案。

目前我正在努力为触摸屏创建一组 .net UI 组件，您可以很快在我的网站上查看演示。

阿塔纳斯

# c++ - 返回在 main() 函数之外创建的对象的地址

> ID：607677
> 
> 赞同：0
> 
> 时间：2009-03-03T19:04:27.843
> 
> 标签：c++, visual-c++, pointers

我正在尝试创建一个链接列表，但是我在函数内创建对象并将指针分配给它们的地址时遇到了麻烦，因为我相信当函数退出时它们会超出范围。这是真的？而且，如果是这样，我怎样才能在 main 之外创建一个对象并仍然使用它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T19:06:37.400

你是对的，局部变量将在功能块的末尾超出范围。您需要创建指向对象的指针并使用[new](http://msdn.microsoft.com/en-us/library/kewsb8ba.aspx)分配它们。当您从列表中删除对象时，不要忘记删除该对象。

如果您不想处理指针带来的麻烦和错误，请参阅[boost::shared_ptr](http://www.boost.org/doc/libs/1_38_0/libs/smart_ptr/shared_ptr.htm)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T19:07:52.890

使用新运算符：

```
void f()
{
  CMyObject *p = new CMyObject();
  List.AddTail(p); // Or whatever call adds the opbject to the list
} 
```

当您的列表被销毁时，请注意删除对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T19:17:19.823

使用 new 运算符创建对象。IE

```
void foo( myObject* bar1, myObject* bar2 )
{
  bar1 = new myObject();
  bar2 = new myObject();
  // do something
}

int main( int argc, char* argv[] )
{
  myObject* thing1;
  myObject* thing2;
  foo( thing1, thing2 );

  // Don't forget to release the memory!
  delete thing1;
  delete thing2;

  return 0;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T19:18:36.793

为什么不在列表中存储对象（不是指向对象的指针）？Creator-function 将返回对象。

如果您确实需要指针列表，请考虑使用特殊的指针列表容器 ( `boost::ptr_list`) 或在其中存储智能指针 ( `boost::shared_ptr`)。为了防止对象从函数返回后超出范围，您需要使用 operator new 动态分配它们。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-10-28T17:53:39.457

接受的答案是不正确的。在函数中

```
void foo( myObject* bar1, myObject* bar2 )
{
  bar1 = new myObject();
  bar2 = new myObject();
  // do something
} 
```

新分配的对象被分配给局部变量。它们不会影响调用函数中指针的值。

```
int main( int argc, char* argv[] )
{
  myObject* thing1;
  myObject* thing2;
  foo( thing1, thing2 ); // thing1 and thing2 don't get assigned
                         // They continue to be uninitialized in
                         // this function

  // Don't forget to release the memory!
  delete thing1;  // These two deletes will lead to undefined behavior.
  delete thing2;

  return 0;
} 
```

你需要的是：

```
void foo( myObject*& bar1, myObject*& bar2 )
{
  bar1 = new myObject(); // Now the value of the pointers in the calling
  bar2 = new myObject(); // will be changed since the pointers are passed by reference.
  // do something
} 
```

# asp.net - 在 Web Garden 中创建带有工具提示的图表

> ID：607681
> 
> 赞同：0
> 
> 时间：2009-03-03T19:05:27.980
> 
> 标签：asp.net, charts, tooltip, web-garden

我需要在 ASP.NET 页面上显示[折线图，其中每个数据点都有一个工具提示，显示其确切的 X 和 Y 值。](http://en.wikipedia.org/wiki/Line_chart)特定数据集的图表可能只会被请求一次，因此缓存被禁用，如果需要再次显示图表将重新生成。

限制：

1.  需要在网络花园环境中工作
2.  无法使用会话
3.  不能使用富媒体，例如 Flash 或 Silverlight。

我见过的方法使用图像映射来生成图表图像。由于限制，到目前为止，我所有的图表都是在内存中的处理程序中生成的，直接流回给用户，然后被处理掉。现在我需要添加工具提示，这需要 HTML 和图像。

我目前的计划是在页面上生成一次图表获取HTML，忽略生成的图片，重写图片标签的“src”指向第二个页面。第二个页面生成与第一个页面完全相同的图表，忽略 HTML 标记，并将图像流式传输回客户端。这一切似乎都很笨拙。

有没有更好的方法来做到这一点，而不涉及两次生成图表？

可用的图表控件：

1.  开发快递 8.2
2.  同步融合 6.2
3.  ?? - 推荐一些东西

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-03T20:15:01.417

使用[Google Chart API](http://code.google.com/apis/chart/)和[.Net 包装器](http://groups.google.com/group/google-chart-api/web/useful-links-to-api-libraries)怎么样？有关更多信息，请参阅此[SO 讨论](https://stackoverflow.com/questions/348706/how-create-charts-with-the-google-chart-api-in-asp-net)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T16:19:41.283

我通过使用 MS Chart Control 解决了这个问题。磁盘处理程序可以在网络花园中的服务器之间共享图像，并在其自身之后自动清理。

# c# - 需要 n 层架构反馈

> ID：607683
> 
> 赞同：1
> 
> 时间：2009-03-03T19:05:42.457
> 
> 标签：c#, design-patterns, n-tier-architecture, feedback

我开始了我的网站，比如 stackoverflow，我想要偿还一点技术债务。作为一名合同开发人员，我去过很多地方，看到了很多不同的方法来实现这个结果，但我要走的路是……

演示文稿（网络）

业务层（老式实体类和 BL 层）

数据层（通过存储过程到 SQL Server 的 DA 类）

我的问题主要涉及业务层。现在我有一个实体命名空间和一个业务逻辑命名空间。

提单提到了 DA 和实体。实体有对 DA 的引用（DA“不知道”提单或实体）

我真的希望将数据转换为实体的所有工作都发生在 BL 中——也就是业务逻辑中。但是，如果需要，我希望实体能够访问 BL，从而删除实体对 DL 的引用。

所以...

将 BL 和 Entity 对象放在同一个命名空间中以便它们可以一起工作是“错误的”吗？

本质上，我正在尝试拥有一个像 Employee 这样的实体对象（经典示例，嗯？）并让 Employee 有一个

```
public Hashtable[] SubordinateEmployees 
```

该属性返回向该员工报告的其他员工对象的哈希表。但我不想在需要之前加载它。因此，对于大多数员工来说，该属性永远不会被访问，但当它访问时，它会通过调用 BL 来自动加载，而 BL 会调用 DA。

这个问题有意义吗？

如果是这样，我的解决方案是吗？

提前非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T19:12:50.583

处理您的示例所代表的那种情况的常用方法是使用外观。您无需尝试从 Employee 对象中获取下属员工，而是使用对业务逻辑的调用来获取它。

```
hashtable = BL.GetSubordinateEmployees(supervisor); 
```

这样，您就可以通过单点访问下属，并且只有一件事（BL）访问数据层并创建实体。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T20:31:07.290

让我看看我能不能告诉你一个更好的方法来思考这个问题

你有你的数据访问权限（sql server、mysql、flat xml 文件等）所有这些都应该被抽象掉，你的应用程序中没有其他东西应该关心或知道你是如何获取数据的，只要它剂量，如果有其他知道的话你如何获得你的数据你有一个图层违规。如果 DAL 执行任何其他操作，则获取数据，您有层违规。接下来，您实现业务层使用的类似 IDAL 的数据访问接口，这对于通过强制分离层来使您的代码可测试非常重要。

您的数据实体可以放置在 DAL 名称空间中，也可以将它们放在那里，给它们自己的力量分离。数据实体是愚蠢的对象，应该包含很少甚至没有逻辑，并且只知道它们自己和它们拥有的数据，它们不包含业务逻辑！、数据访问逻辑或 UI 逻辑。如果他们这样做，你有一个图层违规。数据实体的唯一功能是保存数据并从一层传递到下一层。

Biz 层实现了一个数据访问接口，就像我们讨论过的 IDAL 一样，您可以使用工厂、IOC 容器或其他所有失败的具体类型来实例化它，但添加一个 setter 属性以便可以更改它以进行测试。商务层只处理业务逻辑，它不知道也不关心数据来自哪里或去往哪里，它只关心操作数据以符合业务规则，这将包括日期验证、过滤（其中一部分是告诉 DAL 它需要什么数据，让 DAL 弄清楚如何获取它）。基本上，BIZ 处理与 UI 相关或与数据检索无关的所有逻辑。就像 DAL 一样，出于同样的原因，Biz 应该实现一个接口。

UI 层访问 Biz 层的方式与 Biz 层访问 DAL 的原因相同。UI 层关心的只是显示数据和从用户那里获取数据。IU 层不应该知道任何关于业务规则的信息，除了填充数据实体所需的数据验证。

这种架构的优点是它强制关注点分离，使其更易于测试、更灵活且更易于维护。今天你正在建立一个网站，但明天你想允许其他人集成一个 Web 服务，你所要做的就是创建一个实现 IBIZ 接口的 Web 服务，当你必须修复 BIZ 中的错误时，你就完成了层，它已经在您的网站和网络服务中修复。

将其提升到一个新的水平，假设您正在进行大量繁重的数字运算，并且您需要更强大的服务器来处理此问题，因此您所要做的就是实现一个 IDal 和 IBIZ 接口，它们实际上是处理通信的 WCF 的包装器在您的服务器之间，现在您的应用程序分布在多个服务器之间，您无需更改代码即可。

# apache - 这些声明在我的 .htaccess 文件中是什么意思？

> ID：607692
> 
> 赞同：1
> 
> 时间：2009-03-03T19:06:46.307
> 
> 标签：apache, .htaccess, mod-rewrite

我是 PHP 的新手。谁能告诉我每行在这里做什么。我需要这个吗？它给了我错误

```
RewriteCond %{REQUEST_URI} /~([^/]+)/?
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*) /~%1/rewrite.php?p=$1&%{QUERY_STRING} [L]
RewriteCond %{REQUEST_URI} /~([^/]+)/?
RewriteRule ^index\.php?(.*)$ /~%1/rewrite.php?p=%1&%{QUERY_STRING} [L]
#there is no ~ character in the URL
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*) ./rewrite.php?p=$1&%{QUERY_STRING} [L]
RewriteRule ^index\.php?(.*)$ ./rewrite.php?p=$1&%{QUERY_STRING} [L]
#WJ-180 fix
RewriteRule ^resume\.php?(.*)$ ./rewrite.php?p=resume\.php$1&%{QUERY_STRING} [L] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T19:11:56.577

如果您是新手，请阅读[http://httpd.apache.org/docs/1.3/mod/mod_rewrite.html](http://httpd.apache.org/docs/1.3/mod/mod_rewrite.html)，它的解释非常好。

*ps*你的标题“这些声明在我的 PHP .htaccess 文件中意味着什么？” 不正确，.htacces 不是 php 文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T19:33:16.917

这些说

```
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d 
```

“仅当请求与现有文件或目录不匹配时，才使用以下规则。”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T19:11:58.183

这些是[mod_rewrite](http://httpd.apache.org/docs/1.3/mod/mod_rewrite.html)配置条目。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T19:12:01.413

它是一个 Apache mod_rewrite 规则。除非您使用某种框架，否则您可能不需要它。有关详细信息，请参阅 Apache mod_rewrite。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-03T19:18:11.430

简单的答案：这些声明将每个请求重写为`rewrite.php`文件。

更全面的答案：`RewriteCond`and`RewriteRule`指令来自[Apache 模块 mod_rewrite](http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html)并提供基于规则的 URL 重写机制。

似乎这些规则旨在将每个请求重写为`rewrite.php`文件，无论是在特定目录（`/~`*foobar*`/rewrite.php`）还是在根目录（`/rewrite.php`）。

# .net - NHibernate 数据类型 - 否是布尔值

> ID：607693
> 
> 赞同：1
> 
> 时间：2009-03-03T19:06:54.967
> 
> 标签：.net, nhibernate, nhibernate-mapping, types

在 NHibernate 映射中获得 YesNo 布尔类型的反向行为的最佳方法是什么？

我希望“Y”表示错误，“N”表示正确。

有 NoYes 类型吗？你写自定义类型吗？真的很容易吗？

需要反转布尔值的问题存在于 40 多个表中的至少一个字段上。试图适应遗留数据库。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-03T19:17:22.383

我发现处理遗留数据库中奇怪的数据格式可以通过实现自定义类型轻松实现。例如，我最近制作了一个简单的用户类型来映射`DateTime`到表单上的 8 位数字`yyyyMMdd`，这恰好是日期存储在我必须使用的 DB2 转储中的方式。

Los Techies 有一个实现示例`IUserType`，您可以使用它来解决您的问题：[使用 NHibernate 的 IUserType 将字符串映射到布尔值](http://www.lostechies.com/blogs/rhouston/archive/2008/03/23/mapping-strings-to-booleans-using-nhibernate-s-iusertype.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-02-13T13:05:26.210

我有一个类似的问题。我发现的更简单的解决方案是从 NHibernate 扩展 CharBooelanType 并在映射上使用新类型。它会是这样的：

```
using NHibernate.Type;
using NHibernate.SqlTypes;

namespace MyAssembly.MyNamespace 
{
    public class NewBoolType : CharBooleanType 
    {
        public NewBoolType()
            : base(new AnsiStringFixedLengthSqlType(1)) { }

        protected override string TrueString 
        {
            get { return "N"; }
        }

        protected override string FalseString 
        {
            get { return "Y"; }
        }

        public override string Name 
        {
            get { return "inverted_bool"; }
        }
    }
} 
```

映射将是这样的：

```
<property name="MyProperty" column="MyColumn" type="MyAssembly.MyNamespace.NewBoolType, MyAssembly" /> 
```

# c# - .NET 数据绑定

> ID：607699
> 
> 赞同：1
> 
> 时间：2009-03-03T19:07:54.823
> 
> 标签：c#, .net, data-binding

我已经在[ActionScript](http://en.wikipedia.org/wiki/ActionScript) 3 / [Flex Builder](https://en.wikipedia.org/wiki/Adobe_Flash_Builder) 3 中进行了一段时间的开发，并且在开发这些类型的应用程序时对数据绑定非常满意。

最近，我接触了一些 C#，但我一生都找不到关于如何数据绑定的好的参考资料。

我想知道是否有人可以给我一些关于如何数据绑定的信息，也许还有一些在.NET中绑定时发现的警告（做和不做）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T19:10:29.683

这是一篇关于 Windows 窗体中的数据绑定的文章：

*[Windows 窗体数据绑定](http://msdn.microsoft.com/en-us/library/ef2xyb33.aspx)*

在 Windows Presentation Foundation 中：

*[http://msdn.microsoft.com/en-us/magazine/cc163299.aspx](http://msdn.microsoft.com/en-us/magazine/cc163299.aspx)*

在 ASP.NET 中：

*[ASP.NET 数据绑定概述](http://support.microsoft.com/kb/307860)*

# .net - WPF 工具包数据网格

> ID：607701
> 
> 赞同：1
> 
> 时间：2009-03-03T19:08:11.483
> 
> 标签：.net, wpf, database, wpftoolkit

我想在 XPS 文档中显示数据网格内容（行、列）。我有 20 列。当我使用 XPSDocumentWriter.Write 方法将数据网格发送到 XPS 时，它只显示一些列而不是全部。我如何在 xps 中显示所有列和行（如 Xceed datagrid xps 导出）

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-09-03T17:16:39.870

问题可能出在与 XPSDocumentWriter 页面大小相关的网格宽度上。

WPF 将按原样在 Document 中写入您提供的元素。这意味着它不会以任何方式缩放以适应页面的内容。

假设您的文档大小正确（假设是字母），您需要确定文档的可打印区域并将 RenderTransform 应用于网格，然后再将其写入 XPSDocumentWriter

执行此操作的代码类似于：

```
Grid grd = new Grid();
XpsDocumentWriter wrt = new XpsDocumentWriter();
//Bunch of code to manipulate your grid here

//Now we calculate the scaling required:
double ScaleX = PageWidth / grd.Width; //The page width must be in Device Independent Units
double ScaleY = ScaleX;

grd.RenderTransform = new ScaleTransform(ScaleX, ScaleY);

wrt.Write(grd); 
```

**编辑：**更改代码，使 ScaleX 和 ScaleY 都指向使网格完全适合 XpsDocument 所需的量

# java - 数据源或 rss 提要从美国当局获得最新的货币兑换率

> ID：607704
> 
> 赞同：4
> 
> 时间：2009-03-03T19:08:54.523
> 
> 标签：java

嗨，我需要开发一个假设获取每日汇率的工具。我正在从授权的美国政府机构寻找一些提要或服务。回应将不胜感激。

谢谢卡马尔

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-03T19:39:13.267

我不知道有哪个美国机构，但欧洲中央银行[会发布每日汇率信息](http://www.ecb.int/stats/eurofxref/eurofxref-daily.xml)。

您可以使用它从美元转换为欧元，然后再转换为其他任何东西。

如果你有钱，我也会看看[XE.com 的 XE Datafeed](http://www.xe.com/dfs/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T19:38:09.087

没有真正的美国政府机构负责提供这些信息。您可以使用来自[Currency Source](http://www.currencysource.com/webmasters.html#currencyExchangeRss)的 RSS 提要来获取尽可能最新的信息。他们声称他们的提要至少每 20 分钟更新一次。

# c++ - 在 Valgrind 中运行程序时如何调试？

> ID：607713
> 
> 赞同：1
> 
> 时间：2009-03-03T19:11:11.710
> 
> 标签：c++, debugging, valgrind

我正在完成一个代码模块，并想通过 Valgrind 运行我的程序以确保我已经考虑了所有内存，但是我的程序失败了一个断言，该断言在单独运行时不会失败。从 Valgrind 运行时是否可以在调试器中停止？我目前正在阅读手册，但我想我可以更快地从你们那里得到答案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T19:56:58.653

我发现了这个`--db-attach=yes`论点。每次检测到错误时都会停止，并询问您是否要在此时进入调试器。

然而，对于我的程序，这被证明很难使用。我从标准输入中读取了一个文件进行初始化，我认为 Valgrind 将 EOL 解释为对其提示的响应。

# sharepoint - biztalk 可以将多个 xml（信息路径）表单发布到同一个文档库吗？

> ID：607715
> 
> 赞同：0
> 
> 时间：2009-03-03T19:11:41.507
> 
> 标签：sharepoint, biztalk

我需要执行以下操作：

业务流程涉及多种基于 cXML 的文档类型。BizTalk 需要能够将这些推送到 SharePoint 表单库（作为 InfoPath 表单）以进行手动工作流。工作流完成后，xml 文档将返回给 BizTalk。

为了能够使用单个文档库，我必须使用内容类型。InfoPath 连接器能否使用单个库中的内容类型？

BizTalk 2006，WSS 3.0

感谢任何输入。

直流

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-03T19:47:10.593

所以我在[这里](http://www.eggheadcafe.com/software/aspnet/31620933/uploading-documents-to-a.aspx)找到了答案：

在编排中，添加消息分配形状 将以下代码添加到消息分配形状：

SharePointOutMsg(WSS.ConfigPropertiesXml) = PropertyName1>My Custom ContentType [添加更多自定义元数据] ";

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-01T21:02:21.780

如果不使用内容类型，模板可以作为项目存储在单独的表单库中。BizTalk 然后使用 href 属性将提交的文档与正确的模板相关联。

# ruby-on-rails - 需要用户能够在 ruby on rails 应用程序中连续下载 2 个文件

> ID：607717
> 
> 赞同：1
> 
> 时间：2009-03-03T19:11:49.040
> 
> 标签：ruby-on-rails, ruby

处理用户需要下载 2 个文件的最佳方法是什么。我正在使用*send_data*将文件发送到浏览器。如何允许用户从一个请求中获取两个动态生成的文件，**或者**有什么更好的替代方法。我正在尝试做的一个简单示例是：

```
 def data_out
    output = "foo foo foo "
    send_data(output,:type => "text/csv",:filename => "foo.txt")

    output2 = "bar bar bar"
    send_data(output2,:type => "text/csv",:filename => "bar.txt" )
  end 
```

调用 data_out 时，只向浏览器发送*bar.txt*文件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T21:04:32.717

我会先使用 RubyZip 压缩它们，然后将 zip 文件作为单个下载文件呈现。下载体积更小，下载速度更快。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T20:06:41.920

从隐藏的 iframe 调用每个。

您可以将此文件作为其`src`.

# c++ - Android 平台上的原生 C/C++ 代码

> ID：607721
> 
> 赞同：8
> 
> 时间：2009-03-03T19:12:18.277
> 
> 标签：c++, android, native

我对 Android 平台上的原生 C/C++ 有两个问题：

1.  设备制造商是否可以在 Android 平台上开发原生 C++ 应用程序？

2.  如何在 Android 平台上开发自己的具有上层 Java 前端/API 的原生 C++ 应用程序/库？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-26T22:42:24.023

官方公告及下载链接：

> 介绍 Android 1.5 NDK，第 1 版
> David Turner 于 2009 年 6 月 25 日上午 10:30 发布
> 
> 你们中的许多人一直在要求能够从 Android 应用程序调用本机代码。我很高兴地宣布，开发人员现在可以从 Android 开发人员网站下载 Android Native Development Kit。

[http://android-developers.blogspot.com/2009/06/introducing-android-15-ndk-release-1.html](http://android-developers.blogspot.com/2009/06/introducing-android-15-ndk-release-1.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-11-09T08:27:55.193

此博客条目解释了如何在 android 上进行本地编程： [http](http://rxwen.blogspot.com/2009/11/native-programming-on-android.html) ://rxwen.blogspot.com/2009/11/native-programming-on-android.html 希望对您有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T19:16:57.343

这是可能的，但不支持。从一个 Android 系统到另一个系统，本机代码要求可能会有很大差异；除非您在非常低级别的基础架构上工作，否则最好采用 Java-source-to-Dalvik-VM 路线以实现可移植性。当然，您可能会被绑定到您为其编写本机代码的手机，但如果您将其集成到 Android 中，它可能会被系统打算支持的所有平台接受和维护。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-31T17:14:40.337

这篇文章解释得很好：[http ://davanum.wordpress.com/2007/12/09/android-invoke-jni-based-methods-bridging-cc-and-java/](http://davanum.wordpress.com/2007/12/09/android-invoke-jni-based-methods-bridging-cc-and-java/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-03T22:55:49.503

当然，如果您是设备制造商。你基本上可以做任何你想做的事。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-18T15:00:41.757

Google 已经发布了一个原生开发工具包 (NDK)（根据[http://www.youtube.com/watch?v=Z5whfaLH1-E](http://www.youtube.com/watch?v=Z5whfaLH1-E)在 00:07:30）。

希望这些信息会在 google 群组页面 ( [http://groups.google.com/group/android-ndk](http://groups.google.com/group/android-ndk) ) 上更新，因为它表示尚未发布。

我不知道在哪里可以得到一个简单的下载，但我听说你可以从谷歌的 Git 存储库的 donut 分支下获得一份 NDK 的副本。

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2009-03-05T19:58:20.693

好吧，Android 往往在底部有一个普通的 Linux，所以如果你只能在其中获取代码，编写 Linux 应用程序应该是可能的......（但通常你不能，因为手机被锁定在那个级别）

所以答案是：

1.  是的，但这取决于
2.  是的，但这取决于

# user-interface - 对 Log4Net 配置 Gui 有什么建议吗？

> ID：607722
> 
> 赞同：8
> 
> 时间：2009-03-03T19:12:25.513
> 
> 标签：user-interface, configuration, log4net

有没有人对 Gui 编辑 log4net 配置文件有任何建议。我们有该领域的人需要能够增加、减少或专门化日志记录，但不具备在 XML 中搞砸的背景。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-03T21:20:10.423

几年前，我使用这个[http://www.codeproject.com/KB/cs/Log4netEditor.aspx为 log4net 提供了一个简单的 GUI。](http://www.codeproject.com/KB/cs/Log4netEditor.aspx)我最近没有使用它，所以我不知道它是否仍在使用最新版本的 log4net。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-02T10:17:35.030

It's not that hard to make a simple .NET Winforms app that can read a .xml file and allow the user to edit it. As it will only be used by users with specific needs you can just put in the necessary drop-down menus, ticks boxes or edit boxes to allow then to change the values needed.

You can then do some basic error/range checking to make sure they can't enter invalid values.

# .net - .net Web 服务中的日期时间时区转换

> ID：607727
> 
> 赞同：2
> 
> 时间：2009-03-03T19:13:56.197
> 
> 标签：.net, web-services, datetime, timezone

我有一个 Web 服务（实际上是一个启用 Silverlight 的 wcf 服务，但出于所有意图和目的，它是一个 Web 服务），其方法采用 datetime 参数。该方法从客户端调用，该客户端可能位于不同的时区。托管 Web 服务的服务采用太平洋标准时间，并且 Web 服务似乎正在将日期时间值转换为服务器时区。Web 服务的目的是将日期时间值与数据库中的值进行比较，但数据库中的值是基于客户端时区的，因此由于转换，比较不起作用。

有什么办法可以关闭转换吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-04T17:44:31.427

> 并且似乎 Web 服务正在将日期时间值转换为服务器时区。

我试图确保我有这个正确：您的 Web 服务方法采用 DateTime 类型的参数（如 System.DateTime）并且正在转换传递的参数？

DateTime 对象不携带隐式时区，因此 Web 服务推断本地时间的任何决定都将是一个逻辑缺陷（至少不支持时区标准。）

如果您可以提供您的服务器和客户端代码片段，它将使该场景更易于诊断。

更新：不确定这种情况是否准确，因此请澄清：

*   客户端提交 DateTime 值为 '12:00:00 00:00:00 PM CST' 的请求
*   PST 中的服务器在“10:00:00 00:00:00 PM PST”接收/解释请求

如果是这种情况，您可以将所有数据转换为 UTC 时间吗？如果您正在执行查询查找，这意味着将存储的数据也转换为 UTC。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-05T05:47:24.357

DateTime 实例（结构）不携带 TimeZone 信息并不完全正确。从 .NET ... 3.0 开始，每个 DateTime 结构都有一个[DateTimeKind属性？](http://msdn.microsoft.com/en-us/library/shx7s921.aspx)我不知道版本。“种类”是 UTC、本地或未指定。因此，虽然它本身不是 TimeZone，但它表明时间要么以本地时区表示，要么以通用时区表示。查看文档以获取更多信息。

要回答最初的问题 - 将每个人都转换为一个标准时区。UTC 工作得很好，而且很容易，因为 BCL 内置了一些方法，但你选择什么时区并不重要。只要让每个人都同意一个标准。

您可以做的另一件事是将时间值作为“TotalSeconds”值传输，因为......过去的某个特定时间。如 1970 年 1 月 1 日（unix time_t）或 1601 年 1 月 1 日（Windows FILETIME）。但这种方法隐含的是所有合作方都同意这个时间点是UTC。所以从一开始的一百万秒（“纪元”）指的是同一时刻，无论我是在埃尔帕索、纳舒厄、东京还是伦敦。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T19:25:25.390

看看这个问题，它有一些关于你想要什么的讨论。

*   [覆盖 ASP.NET WebMethod 参数的 DateTime 序列化](https://stackoverflow.com/questions/331455/override-datetime-serialization-for-aspnet-webmethod-parameters)

看起来最简单的方法是在 web 方法中也传递客户端时区，或者只是将整个时间作为字符串而不是 DateTime 传递

# emacs - Emacs 函数用 printfs 换行文本

> ID：607728
> 
> 赞同：1
> 
> 时间：2009-03-03T19:14:01.440
> 
> 标签：emacs, formatting

一些语言，比如 Perl，支持打印预先格式化的代码：

```
print <<EOL
  a line
  another line
  and another.
EOL 
```

有些语言没有。

对于那些不这样做的人，我希望能够编写我的文本，然后将其转换为一堆 printfs：

```
printf "一行\n";
printf "另一行\n";
printf "和另一个\n";

```

进行这种转换的好方法是什么？（最好在 emacs 中）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T19:18:32.520

```
(defun my-add-printf (b e)
  "Add printf's to region"
  (interactive "r")
  (let ((comment-start "\tprintf \"")
        (comment-end "\\n\";"))
    (comment-region b e))) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T21:23:22.283

除非我必须每天多次这样做，否则我可能会以交互方式进行：

```
Mx 查询替换正则表达式 RET .* RET printf "\&\\n"; RET
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-09T19:39:35.057

只是想建议另外两种方法，确保启用 cua 模式，然后在开始时按 C-enter，向下按直到到达最后一行（同一列）并输入“printf”。

另一种是制作宏。输入以下内容：

```
C-x ( 
printf "
C-e
";
C-a
C-n
C-x )
C-x e
e e e e e e e e .... 
```

# javascript - Javascript：呈现网页后可以动态呈现哪些 Document 对象属性？

> ID：607735
> 
> 赞同：1
> 
> 时间：2009-03-03T19:16:52.897
> 
> 标签：javascript, dom

根据一项学校作业，在呈现网页后，只能动态更改 Document 对象的一个​​属性。是身体还是饼干？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T19:22:49.717

您可以操作正文内容，但不能分配给正文属性。这是一个只读属性。但是，您可以设置或获取与文档关联的 cookie。参考：[http ://www.w3schools.com/htmldom/dom_obj_document.asp](http://www.w3schools.com/htmldom/dom_obj_document.asp)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T19:31:43.020

赋值错误：以下所有属性在 DOM 中都有特殊含义并且是可写的：

*   链接颜色
*   背景颜色
*   曲奇饼
*   fgColor
*   链接颜色
*   标题
*   vlinkColor

上面的列表应该适用于不同的浏览器。还有其他的（比如IE的`charset`and ，或者 Geckos[的其中一些](https://developer.mozilla.org/en/DOM/document#Properties)）没有，而且不是所有的都是[标准](http://www.w3.org/TR/DOM-Level-2-HTML/html.html#ID-1006298752)的。`defaultCharset`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T19:35:25.507

我认为你的任务是基于过时的技术。

使用 Javascript，您可以在网页呈现后执行任何操作。例如动态更改任何 DOM 的 id 名称、属性、事件处理程序等。

# visual-studio - vs2008：类设计师看起来很有限？

> ID：607737
> 
> 赞同：0
> 
> 时间：2009-03-03T19:17:03.553
> 
> 标签：visual-studio

我看不到使用 Visual Studio 的类设计器显示所有权、包含、关联等的方法。我错过了什么还是真的那么有限？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T19:24:03.507

VS 中的类设计器功能不是 UML 设计器，并且不显示 UML 的各个部分。它专注于 .Net 结构，例如成员、继承、属性、字段、方法等......

可以看到类之间的关系。这适用于 1-1、1-N 和 N-1 映射。

如果这不能回答您的问题，您能否更具体地了解您感兴趣的关系类型？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T19:22:13.260

vs2008 确实显示了关系，即属性、继承等。

# database-design - 您如何设计一个模式来有效地查询键值数据库中的嵌套项？

> ID：607746
> 
> 赞同：3
> 
> 时间：2009-03-03T19:18:47.543
> 
> 标签：database-design, erlang, schema, couchdb, mnesia

我将 Mnesia 与 Erlang 一起使用，但这个问题适用于任何键值数据库，如 couchdb 等。

我试图摆脱 RDBMS 的思维过程，但我不知道如何有效地实现这种模式。

假设我有一个用户记录，他有很多 SubItemA 记录，其中有很多 SubItem B 记录，所以：

```
User
-SubItem A
--SubItem B
... 
```

我需要对 SubItem B 运行查询。当它嵌套时这样做是否有效？我应该把它标准化，这样它会更快吗？

我听说有些人使用数据复制，所以数据既嵌套又分离，这很荒谬还是在某些情况下真的有用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T19:36:07.003

潜在的问题是，什么时候性能**足够好**？

如果您确实需要详细检查每个 SubItem B 并且 B 的大小决定了字典的整体大小，那么对 User 字典进行表扫描不会产生过多的开销。

如果这还不够好，请将其规范化，以便在查询 SubItem B 时避免预先读取所有 User 和 SubItem A 数据。在 SubItem B 中使用复合键，例如 (UserId, SubItemAId, SubItemBId)字典，如果表是有序的，那么您可以进行范围查询。

如果这完全破坏了您的 User/SubItem A 查询性能，那么将数据复制作为最后的手段，因为它更容易出错。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-04T17:51:19.383

在 CouchDb 中，为每个 SubItems 发出视图条目是微不足道的。这将使您可以非常快速地访问这些项目。根据您还放入视图条目的内容，您可能会提供链接回父文档/子项目所需的任何信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-04T17:55:01.247

我不确定 Mnesia，而且我才刚刚开始使用 CouchDB，但我的理解是，在 CouchDB 中，由于您生成自己的自定义索引（“视图”），因此您可以直接在这些子上构建索引项目。

示例地图功能：

```
function(doc) {
    for(var i in doc.subitems_a) {
        var subitem_a = doc.subitems_a[i];

        for(var j in doc.subitems_a[item_a].subitems_b) {
            var subitem_b = subitem_a.subitems_b[j];

            emit(subitem_b, doc)
        }
    }
} 
```

这实际上是子项 B 的索引列表，然后您可以根据选择从该列表中剪切和拼接。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-08T03:36:03.530

实际上，我认为这取决于您使用的数据库。在 CouchDB 中，一件事会更好，而在 Mnesia 中，另一件事会更好。您应该对数据进行分区和分片吗？你应该按照什么标准这样做？多少数据重复才足够？

正如 Jeffery Hantin 所说，需要进行一些实验和分析才能找出正确的解决方案。也就是说，大多数非关系数据库都为您提供了解决问题所需的工具。你的职责是弄清楚每一个的权衡，以及你可以接受的权衡与其他权衡。

# plot - 如何设置绘图窗口的窗口大小？

> ID：607751
> 
> 赞同：19
> 
> 时间：2009-03-03T19:21:08.537
> 
> 标签：plot, octave

是否可以设置绘图窗口的窗口大小/位置（图）？

```
plot(0:20, sin(0:20)) 
```

或者还有其他可能改变*print()*命令的大小吗？

```
print('aa.png', '-dpng') 
```

因为*-Sxsize,ysize*参数不会改变任何东西。写入的图片 (aa.png) 的大小始终与绘图窗口的大小相同。

我正在使用 Octave 3.0。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-03-04T10:16:29.147

是的，有可能：

```
figure(1, 'position',[startx,starty,width,height]);
plot(0:20,sin(0:20)); 
```

[startx,starty] 是图形（窗口）左下角的坐标。

您还可以使用打印功能的分辨率选项

```
print('aa.png','-dpng','-r300'); 
```

我想第一个解决方案可能会更好......

问候

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2017-08-31T16:05:59.463

如果要最大化，可以使用下面的代码：

```
figure(1,"position",get(0,"screensize")) 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2018-11-29T13:27:44.607

[正如Janusz Lenar](https://stackoverflow.com/users/154970/janusz-lenar)所指出的，从 octave 版本 4.2.2 开始，以下工作：

```
print('filename.png', '-dpng', '-S1280,720'); 
```

缩放图形以创建 1280x720 像素的图像。

# asp.net - 具有怪癖和标准模式的可重复使用的 Asp.net 服务器控制

> ID：607756
> 
> 赞同：0
> 
> 时间：2009-03-03T19:23:34.537
> 
> 标签：asp.net, javascript, ajax, web-standards

我正在开发一个可重用的 ASP.net 服务器控件，它需要在 IE 6+、FF 2+ 和 Safari 的 Quirks 和标准模式下工作。

该控件将公开两个用户可定义的属性高度和宽度，这两个属性都可以定义为百分比或像素值。

在控件内部，我有两列 Div，其中包含导航栏和控件内容。当内容大于容器时，列需要是一个 Div 才能使用溢出样式。请参阅下面的示例原型代码；

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
     <head>
        <title></title>
    </head>
    <body>
        <div style="height: 100%; width:400px; background-color: Green; ">
            <div style="height: 100%; width: 25%; background-color: Red; float:left; overflow:auto;">
                LongString:<br />Stuffsdfsfdsdfsfsdfdfsdfsdfsdfsdfsdxgsdfgsdfgsdgiusdfgiudfgifdgu
            </div>
            <div style="height: 100%; width: 75%; background-color: Pink; float:right;">
                Stuff
                <br />
                More stuff
                <br />
                And some more
            </div>
            <div style="clear:both;"></div>
        </div>
    </body>
</html> 
```

我遇到的问题是，在标准模式下，当使用百分比基高时，div 只呈现与其内容一样大的内容。看来解决此问题的唯一方法是使用 JavaScript。

然后，这会产生问题，即控件可以使用 AJAX 异步重新渲染，并且高度不同步。

我想要实现的目标是不可能的，还是我找错了地方？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-03T21:30:19.007

```
<div style="height: 100% 
```

100% 什么？div 不是绝对定位的，所以答案是它的父级。父母是身体。

身材有多高？未指定：默认为`auto`. `auto`表示 body 的高度是根据其内容的高度计算的。Quirks Mode 中的错误是`body`具有与视口匹配的最小高度。

将 html 和 body 都设置`height: 100%`为在标准模式下真正获得 100%。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-10T00:13:29.147

我不想这么说，但有时当不得不使用旧浏览器时，使用老式技术有时可以更快地完成工作。试试 <table> 标签。:(

```
<table style="height: 100%; width:400px; background-color: Green; ">
    <tr>
        <td style="height: 100%; width: 25%; background-color: Red; overflow:auto;">
            LongString:<br />
            Stuffsdfsfdsdfsfsdfdfsdfsdfsdfsdfsdxgsdfgsdfgsdgiusdfgiudfgifdgu
        </td>
        <td style="height: 100%; width: 75%; background-color: Pink; ">
            Stuff
            <br />
            More stuff
            <br />
            And some more
        </td>
    </tr>
</table> 
```

# python - Python解析

> ID：607760
> 
> 赞同：4
> 
> 时间：2009-03-03T19:25:17.807
> 
> 标签：python, regex, parsing, text-parsing

我正在尝试将 RSS 2.0 提要中的标题标签解析为该提要中每个条目的三个不同变量。使用 ElementTree 我已经解析了 RSS，以便我可以`)`使用以下代码打印每个标题 [减去尾随 ]：

> ```
> feed = getfeed("http://www.tourfilter.com/dallas/rss/by_concert_date")
> 
> for item in feed:  
>  print repr(item.title[0:-1]) 
> ```

我将其包括在内，因为如您所见， item.title 是一种 repr() 数据类型，我对此不太了解。

交互式窗口中的特定`repr(item.title[0:-1])` `print`ed 如下所示：

> ```
> 'randy travis (Billy Bobs 3/21'
> 'Michael Schenker Group (House of Blues Dallas 3/26' 
> ```

用户选择一个乐队，我希望在将每个变量解析`item.title`为 3 个变量（乐队、场地和日期各一个......或者可能是一个数组，或者我不知道......）之后，只选择与乐队相关的那些选择。然后将它们发送到 Google 进行地理编码，但这是另一回事。

我看过一些例子，`regex`我正在阅读它们，但它似乎非常复杂。是吗？我想也许这里有人会对如何以一种智能的方式做到这一点有一些见解。我应该使用该`re`模块吗？输出当前是`repr()`s 是否重要？有没有更好的办法？我在想我会使用这样的循环（这是我的伪Python，只是我正在写的一种笔记）：

```
     列表 = bandRaw、地点、日期、latLong  
     对于提要中的项目：  
      为 bandRaw、地点、日期解析 item.title  
       如果 bandRaw == str(band)   
        将场地名称+“，达拉斯，德克萨斯”发送到谷歌进行地理编码  
        返回纬度，经度  
      list = list + return character + bandRaw + "," + place + "," + date + "," + lat + "," + long  
     别的  

```

最后，我需要在 .csv（逗号分隔）文件中选择如下所示的条目：

> ```
> band,venue,date,lat,long  
> randy travis,Billy Bobs,3/21,1234.5678,1234.5678  
> Michael Schenker Group,House of Blues Dallas,3/26,4321.8765,4321.8765 
> ```

我希望这不是太多的要求。我会自己研究它，只是想我应该在这里发帖以确保它得到答复。

所以，问题是，我如何最好`repr(item.title[0:-1])`地将每个值解析`feed`为 3 个单独的值，然后我可以将它们连接成一个 .csv 文件？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-03T19:35:41.917

不要让正则表达式吓跑你......它非常值得学习。

鉴于上面的示例，您可以尝试将尾括号放回原处，然后使用以下模式：

```
import re
pat = re.compile('([\w\s]+)\(([\w\s]+)(\d+/\d+)\)')
info = pat.match(s)
print info.groups()

('Michael Schenker Group ', 'House of Blues Dallas ', '3/26') 
```

要获取每个组的个体，只需在`info`对象上调用它们：

```
print info.group(1) # or info.groups()[0]

print '"%s","%s","%s"' % (info.group(1), info.group(2), info.group(3))
"Michael Schenker Group","House of Blues Dallas","3/26" 
```

在这种情况下，正则表达式的难点在于确保您知道标题中所有已知的可能字符。如果“Michael Schenker Group”部分中有非 alpha 字符，您必须调整该部分的正则表达式以允许它们。

上面的模式分解如下，从左到右解析：

`([\w\s]+)`：匹配任何单词或空格字符（加号表示应该有一个或多个这样的字符）。括号表示匹配将作为一个组被捕获。这是“Michael Schenker Group”的一部分。如果这里可以有数字和破折号，您需要修改方括号之间的部分，这是该集合的可能字符。

`\(`: 一个字面括号。反斜杠转义括号，否则它被视为正则表达式命令。这是字符串的“（”部分。

`([\w\s]+)`: 和上面一样，但这次匹配的是“达拉斯蓝调之家”部分。在括号中，因此它们将被捕获为第二组。

`(\d+/\d+)`: 匹配数字 3 和 26，中间有一个斜线。在括号中，因此它们将被捕获为第三组。

`\)`: 上面的右括号。

正则表达式的 python 介绍非常好，您可能想花一个晚上来了解它[http://docs.python.org/library/re.html#module-re](http://docs.python.org/library/re.html#module-re)。另外，请查看 Dive Into Python，它有一个友好的介绍：[http](http://diveintopython3.ep.io/regular-expressions.html) ://diveintopython3.ep.io/regular-expressions.html 。

编辑：见下面的 zacherates，他有一些不错的编辑。三个臭皮匠顶个诸葛亮！

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-03T19:35:51.947

正则表达式是解决这个问题的好方法：

```
>>> import re
>>> s  = 'Michael Schenker Group (House of Blues Dallas 3/26'
>>> re.match(r'(.*) \((.*) (\d+/\d+)', s).groups()
('Michael Schenker Group', 'House of Blues Dallas', '3/26') 
```

作为旁注，您可能希望查看用于处理 RSS 解析的[Universal Feed Parser](http://feedparser.org/)，因为 Feed 有格式错误的坏习惯。

**编辑**

关于您的评论...字符串偶尔被包裹在 "s 而不是 's 与您使用 repr 的事实有关。字符串的 repr 通常用 's 分隔，除非该字符串包含一个或多个 's，而它使用 "s 以便不必对 's 进行转义：

```
>>> "Hello there"
'Hello there'
>>> "it's not its"
"it's not its" 
```

注意不同的报价风格。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T20:22:36.750

关于这`repr(item.title[0:-1])`部分，不确定你从哪里得到的，但我很确定你可以简单地使用`item.title`. 你所做的只是从字符串中删除最后一个字符，然后调用`repr()`它，它什么都不做。

您的代码应如下所示：

```
import geocoders # from GeoPy
us = geocoders.GeocoderDotUS()

import feedparser # from www.feedparser.org
feedurl = "http://www.tourfilter.com/dallas/rss/by_concert_date"
feed = feedparser.parse(feedurl)

lines = []
for entry in feed.entries:
    m = re.search(r'(.*) \((.*) (\d+/\d+)\)', entry.title)  
    if m:
        bandRaw, venue, date = m.groups()

        if band == bandRaw:
            place, (lat, lng) = us.geocode(venue + ", Dallas, TX")
            lines.append(",".join([band, venue, date, lat, lng]))

result = "\n".join(lines) 
```

**编辑**：替换`list`为`lines`var 名称。`list`是内置的，不应用作变量名。对不起。

# windows - VB6 应用程序不再在 Vista 计算机上打开

> ID：607763
> 
> 赞同：0
> 
> 时间：2009-03-03T19:25:44.047
> 
> 标签：windows, vb6, windows-vista

我有一个 VB6 应用程序，它以前在 Vista 机器上~~作为计划任务~~完美运行，但它将不再在同一台机器上打开。该应用程序在指定文件夹中生成导出文件，在屏幕上没有直接输出。我没有收到任何错误，没有遗漏的参考资料，完全*没有*。

机器运行 Vista Business 32 位，使用单个管理员帐户禁用 UAC，并关闭自动更新。该应用程序驻留在不受保护的文件夹中，导出文件放在桌面上的文件夹中。客户发誓，自从我安装此应用程序以来，他们对该计算机所做的唯一更改就是安装 Norton Antivirus，这在我们的软件之前从未引起过问题。

除了正常的 VB6 引用之外，该应用还引用了 Microsoft Scripting Runtime (scrrun.dll) 和 Microsoft DAO 3.6 (dao360.dll)。这两个文件都存在并注册在目标机器上，以及所有其他 VB6 依赖项。我在 Sub Main() 的开头添加了 MsgBox 语句，只是为了查看是否正在执行任何操作，而事实并非如此。禁用诺顿没有产生任何结果，重新安装 VB6 运行时也没有排除任何损坏的库。我没有一次从我的应用程序中收到任何消息、错误或其他信息。

我以前从来没有遇到过这样的问题，我完全被难住了。还有其他可能导致这种情况的原因吗？

编辑 - 即使我手动运行该应用程序也不会运行，因此关于它是计划任务的部分与我的问题无关，抱歉包含它。

用户拥有完整的管理员凭据，在最初的测试中不需要兼容模式，当时是在我遇到问题的这台机器上完成的。对于笑我尝试了 XP 和 2000 的兼容模式，仍然没有。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T19:32:13.983

尝试检查 - 如果您可以访问它们 - 事件查看器消息。也许你会在那里找到一些告示牌......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-04T14:25:25.617

您可以尝试在Microsoft 提供的免费独立调试器[Windbg中运行该程序。](http://www.microsoft.com/whdc/devtools/debugging/default.mspx)将您的 VB6 EXE 编译为带有符号的本机代码（创建 PDB 文件），您将能够在 Windbg 中调试您的应用程序。

我猜会发生两件事中的一件。

*   Windbg 将无法加载 EXE。大概有一条错误消息可以识别您的问题。
*   Windbg 将加载 EXE，您可以单步执行以查看会发生什么。

这是 Microsoft 人员[2006 年](http://blogs.msdn.com/marklon/archive/2006/01/28/518616.aspx)关于将 Windbg 与 VB6 结合使用的[博文，以及另一位 Microsoft VB 人员 2004 年](http://mtaulty.com/communityserver/blogs/mike_taultys_blog/archive/2004/08/03/4656.aspx)对 Windbg 进行简要介绍的博文。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T19:29:05.333

用户是否更改了密码？这将导致计划任务失败，直到他们重新输入任务密码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T19:30:02.227

您是否尝试过直接运行该过程，而不是作为计划任务？我远非专家，但可能是因为程序作为任务运行而产生的任何错误都没有显示出来。

# wcf - 可以在 JSON(P) 和 XML 中响应并且仍然用作 SOAP Web 服务的 RESTful WCF 服务？

> ID：607767
> 
> 赞同：9
> 
> 时间：2009-03-03T19:27:28.583
> 
> 标签：wcf, json, rest

给定一个合同，例如：

```
[ServiceContract] public interface IService
{
    [OperationContract]
    [WebGet(UriTemplate = "GetData/{id}.{format}")]
    ResponseData GetData(string id, string format);
} 
```

有没有办法让服务在请求时以 json 响应：/GetData/1234.json, xml 当请求为 /GetData/1234.xml 并且仍然可以在其他一些 url 上作为适当的肥皂服务使用，具有强烈的键入 wsdl 合同？

使用 Stream 作为 GetData 的返回值是不可行的，就好像它满足了前两个要求一样，wcf 无法创建完整的 wsdl 规范，因为它不知道结果 Stream 的内容是什么。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-03T19:32:06.403

您*应该*有两个单独的方法，它们采用 id 和 format （它们会调用一个返回的共享实现`ResponseData`），它们具有不同的[`WebGet`属性](http://msdn.microsoft.com/en-us/library/system.servicemodel.web.webgetattribute.aspx)：

```
[ServiceContract]
public interface IService
{
    [OperationContract]
    [WebGet(UriTemplate = "GetData/{id}.{format}.xml", 
        ResponseFormat=WebMessageFormat.Xml)]
    ResponseData GetDataXml(string id, string format);

    [OperationContract]
    [WebGet(UriTemplate = "GetData/{id}.{format}.json", 
        ResponseFormat=WebMessageFormat.Json)]
    ResponseData GetDataJson(string id, string format);
} 
```

对于 SOAP 端点，您应该能够调用任一方法，但您将必须有一个单独的[`ServiceHost`](http://msdn.microsoft.com/en-us/library/system.servicemodel.servicehost.aspx)实例来托管合同的实现。

# c++ - 模板中的无名枚举

> ID：607770
> 
> 赞同：4
> 
> 时间：2009-03-03T19:28:51.387
> 
> 标签：c++, templates

很多模板代码如下所示：

```
template <typename T>
class foo
{
   enum { value = <some expr with T> };
}; 
```

在素数检查程序中可以看到一个示例[，](http://zwabel.wordpress.com/2008/12/18/c-template-support-in-kdevelop4-another-milestone/)我也曾在 Factorial 实现中看到过它。

我的问题是为什么要使用无名枚举？这有什么特别的原因吗？例如，静态 const int 也可以工作？

编辑：

@Benoît：感谢您的链接，它提供了我正在寻找的洞察力！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-03T19:36:25.020

静态 const 变量会占用内存（就像肖恩所说），而枚举不占用任何内存。它们只存在于编译器的世界中。在运行时，它们只是常规整数。

除此之外，它会起作用，除了编译器对标准的错误实施。

在 boost mailing-list 中有一个关于该主题的详尽[主题：](http://lists.boost.org/Archives/boost/2003/01/41847.php)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-03T19:31:20.383

如果我没记错的话，静态 const 将要求您通过声明和定义变量来分配空间，而未命名的枚举则不需要。

# .net - 如何编写利用多核处理器的 .NET 应用程序

> ID：607775
> 
> 赞同：7
> 
> 时间：2009-03-03T19:29:48.467
> 
> 标签：.net, multicore

随着多核处理器变得越来越流行，我认为熟悉如何编写代码以利用它们对我来说是明智的。我是 .NET 开发人员，不知道从哪里开始（说真的，我*不知道*从哪里开始）。有什么建议么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-03T19:42:25.020

多核编程本质上是多线程编程。只要您的应用程序是多线程的，操作系统就会确定在哪个内核上运行哪个线程。

那么，你真正的问题应该是，什么样的应用程序会从多线程中受益？想想这样一个应用程序，然后实例化多个线程来解决相同部分的问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-03T19:34:00.830

最好的开始方法是获取并行扩展框架的最新 CTP 并开始研究他们的示例代码。

*   并行团队页面：http: [//msdn.microsoft.com/en-us/concurrency/default.aspx](http://msdn.microsoft.com/en-us/concurrency/default.aspx)
*   最新 CTP 公告：http: [//blogs.msdn.com/somasegar/archive/2008/06/02/june-2008-ctp-parallel-extensions-to-the-net-fx.aspx](http://blogs.msdn.com/somasegar/archive/2008/06/02/june-2008-ctp-parallel-extensions-to-the-net-fx.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-03T19:34:53.683

阅读 .NET 使用的异步编程模型。研究允许委托在线程池中执行的 BeginXXX 和 EnxXXX 范式。

Stream 类都有BeingXXX、EndXXX 方法（例如BeginRead、EndRead），它们允许您进行异步IO。如果您正在处理大量基于 IO 的事情，您将希望使用这些方法来增加并行度。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-03T19:34:57.800

我不再经常推荐书籍，但 Joe Duffy 的[Windows 并发编程](https://rads.stackoverflow.com/amzn/click/com/032143482X)简直是不可替代的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-03T19:34:19.097

在 .net 4.0 上查找信息。它将为其添加不同的构造。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-03T20:06:04.573

就像 JaredPar 所说的并行扩展非常好。我和他们一起玩了一下，他们很容易使用并增加了性能。

我非常喜欢的构造是 Parallel.ForEach() 和 PLinq。

Parallel.ForEach 类似于 DotNet 2.0 集合中的 ForEach(delegate) 函数。它接受一个动作委托并并行运行它。

Plinq 允许您通过在查询末尾添加 .AsParallel() 以并行方式执行任何普通 Linq 查询。

查看 Jared 发布的链接以获取更多信息。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-03T19:33:23.140

这可能是一个[很好的起点](http://msdn.microsoft.com/en-us/concurrency/default.aspx)。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-03T19:41:44.600

只需将您的项目分成专门用于执行特定功能的多个线程，您就可以利用多个内核。操作系统处理将不同线程调度到最可用的处理器内核。

# asp.net - IHierarchicalDataSource，层次结构，ASP.NET

> ID：607780
> 
> 赞同：1
> 
> 时间：2009-03-03T19:31:29.087
> 
> 标签：asp.net, sql-server, web-controls, hierarchical-trees

我正在从头开始构建层次结构，并且正在尝试确定最佳路线。我从另一个 StackOverflow 问题中找到了以下链接：

[嵌套集模型](http://www.intelligententerprise.com/001020/celko.jhtml)

我喜欢嵌套集的想法，并且已经开始基于这种模式构建我的数据库。我现在不确定如何以能够轻松绑定到控件（例如 TreeView）的方式查询数据。我还需要能够重新排序并提交数据。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T19:42:50.620

SQL 2005 增加了对递归查询的支持。我正在使用递归查询来返回填充 TreeView 的数据树。对于每条记录，我从 TreeView 中找到匹配的父节点并添加它的新子节点。

对于更新，您可以将树序列化为 XML，然后使用 sql 2005 中的 XML 功能运行“更新”语句。

# c - Obj-C 方法：带参数调用

> ID：607797
> 
> 赞同：2
> 
> 时间：2009-03-03T19:34:31.310
> 
> 标签：c, objective-c, function, methods

我一直在使用 C 风格的函数，但我刚刚了解到它们看不到实例变量。所以我被建议将它们转换为 Objective-C 方法。

```
NSString* myfunc ( int x ) 
```

变成：

```
- (NSString *)myfunc:(int)x 
```

和

```
myString = myfunc(x); 
```

变成

```
myString = [myString myfunc:x]; 
```

??

这编译时带有不祥的警告，但不起作用。我误解了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T19:42:10.933

看来您的呼叫不正确。也许尝试：

```
NSString *myString = [self myfunc:x]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T20:23:19.633

据我了解，您将`-myfunc:`消息发送到 NSString 对象。所以该`-myfunc:`方法应该在`NSString`类（或一个类别`NSString`）中声明。

如果这是您想要做的，您不需要将对象本身作为方法的结果返回：您可以在方法实现中修改其实例变量。方法调用（或消息发送）如下所示：

```
[myString myfunc:x]; 
```

如果您想将消息发送到另一个类的对象并返回一个字符串，则您的方法声明是正确的，但必须出现在您的类实现中，并且消息的接收者（这是方括号左侧的项目）必须属于那个类别：

```
@implementation MyClass
-(NSString *)myfunc:(int)x
{
    NSString * returnString;
    ...// do something with x, returnString and instance variables
    return returnString;
}
@end;
...
MyClass * myobj = [[MyClass alloc] init];
NSString * myString = [myobj myfunc:42]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-04T11:37:05.630

作为第二个答案，我试图通过您最近提出的所有问题来了解您的问题。

一[开始](https://stackoverflow.com/questions/602211/objective-c-nsstring-question)，有一个 C 函数返回一个指向`NSString`对象的指针：

```
NSString * myfunc( int x )
{
           ... // Do something with x
   NSString * myString = @"MYDATA";
           ... // Do something with myString
   return myString;        
} 
```

[然后](https://stackoverflow.com/questions/607357/objective-c-scope-problem)，您想在该函数中添加一些关于`UIImage`对象的代码：

```
image1.image = [UIImage imageNamed:@"image1.png"]; 
```

建议您将函数转换为方法。如果要访问`.image`实例变量，则此方法必须属于`image1`对象的类（假设这是`AlanImage`类）。像这样的东西：

```
@interface AlanImage : NSObject {
    UIImage image;
}
- (NSString *) myfuncWithParam: (int) x;
@end;

@implementation AlanImage
- (NSString *) myfuncWithParam: (int) x
{
    NSString * myString = @"MYDATA";
    image = [UIImage imageNamed:@"image1.png"];
    return myString;        
}
@end 
```

[第三](https://stackoverflow.com/questions/607528/calling-a-obj-c-method-with-a-parameter)，你不知道方法的接收者是什么。我的调查倾向于使您的`image`对象成为一个好的候选人：

```
aNiceString = [image myfunc:aNiceInteger]; 
```

最后（这个问题），没有得到令人满意的答案，你改写了你的第三个问题，这次成功了。

我很想更全面地了解您的项目，以便给您一些提示。无论如何，您似乎正在学习 Objective-C 和面向对象的概念：恭喜并保持动力！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T19:50:25.190

你还没有弄清楚什么是[面向对象编程](http://en.wikipedia.org/wiki/Object-oriented_programming)。`[theObject method]`你只能调用属于特定实例的方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-04T10:47:23.787

我不确定以下技巧是否适用于“通用”objective-c，但在苹果实现中你可以这样做：

```
@interface SomeClass: NSObject {
  int m_someVariable;
  ...
};

- (NSString *) someMethod;
...
@end 

@implementation SomeClass
...
//pure c function with extra one parameter 
//for accessing to instance variables
static NSString privatePlainCeeMethod(SomeClass *my, int fortyTwo) {
  NSString *str;
  //access to a instance variable as for a usual
  //cee structure field: my->fieldName
  ...
  return [NSString stringWithFormat:@"someVariable:%d, fortyTwo:%d",
    my->m_someVariable, fortyTwo];
};

- (NSString *) someMethod  { 
  ...
  return privatePlainCeeMethod(self,42);
};
...
@end 
```

我使用这种技巧在可观察的私有简单函数上划分一个大的 objc 方法。这些函数 (a) 不会污染类接口，并且 (b) 调用速度比 objc 方法快。

# asp.net-mvc - ASP.NET MVC URL 路由没有给我漂亮的 URL

> ID：607798
> 
> 赞同：5
> 
> 时间：2009-03-03T19:34:44.867
> 
> 标签：asp.net-mvc, asp.net-mvc-routing

我已经建立了一个 ASP.NET MVC 项目，一切都很好，但我确实有一个路由问题。我的 Global.asax 看起来像这样：

```
public static void RegisterRoutes(RouteCollection routes) {
        routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

        routes.MapRoute(
            "Default",                                              // Route name
            "{controller}/{action}/{id}",                           // URL with parameters
            new { controller = "Home", action = "Index", id = "" }  // Parameter defaults
        );
    } 
```

所以，没有什么不寻常的。我的问题是，当我使用 HTML.ActionLink 链接到控制器/动作/参数时，如下所示：

```
<%= Html.ActionLink("My link", "SomeAction", "SomeController", new {param="someParam"})%> 
```

它应该生成（至少在我看来是有意义的）一个链接，例如：`http://www.localhost/SomeController/SomeAction/someParam`.

但相反，它会生成这样的链接：`http://localhost/SomeController/SomeAction?param=someParam`

如果我手动创建链接到预期结果（SomeController/SomeAction/someParam）的链接，则调用正确的控制器和操作，但操作方法中定义的参数始终为空。

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-03T19:40:02.657

尝试添加：

```
routes.MapRoute(
                    "Default",                                                                                              // Route name
                    "{controller}/{action}/{param}",                                                   // URL with parameters
                    new { controller = "Home", action = "Index", param = "" }  // Parameter defaults
            ); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-03T19:41:16.240

我认为如果参数名称`id`而不是`param`. 如果您想在那里提供一些其他参数，则必须创建不同的路线。

# vb6 - How do I change an EXE or DLL version number from the command line?

> ID：607809
> 
> 赞同：4
> 
> 时间：2009-03-03T19:36:37.530
> 
> 标签：vb6, build-automation, versioning

I need to build an old VB6 application with a version number where the 4th digit is greater than 9999, for example, version `1.2.0.10003`. VB6 won't let you do this; the build fails.

The current workaround is to build version `1.2.0.9999` and then manually edit the file in Visual Studio to insert the correct version. There must be a better way. Is there a command-line tool that allows you to modify the version number fields of an EXE or DLL? Preferably a way that allows you to edit specific version number fields individually.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T19:47:01.797

[ChangeVersion](http://www.the-software-box.com/changeversion.aspx) (and others) taken from:

[How do I set the version information for an existing .exe, .dll?](https://stackoverflow.com/questions/284258/how-do-i-set-the-version-information-for-an-existing-exe-dll)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T19:52:58.273

~~There are a number of tools for editing the version info of a windows executable but I don't think you will need them.~~

Look here are using resource files in vb [http://visualbasic.about.com/od/usevb6/a/ResVB6.htm](http://visualbasic.about.com/od/usevb6/a/ResVB6.htm)

And here for info on the version resource [http://msdn.microsoft.com/en-us/library/aa381058.aspx](http://msdn.microsoft.com/en-us/library/aa381058.aspx)

And here for info on the microsoft resource compiler [http://msdn.microsoft.com/en-us/library/aa381042(VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa381042(VS.85).aspx)

~~With these two you should be able to disable VB's builtin versioning and use whatever version info you want.~~

Nevermind, VB6 inserts its own version resource as a post build operation with no way to turn it off. Overwriting the version info in the executable is the only solution.

See [http://www.darinhiggins.com/?s=%22resource+files%22](http://www.darinhiggins.com/?s=%22resource+files%22)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-10T00:10:47.440

**[Resource Tuner Console](http://www.heaventools.com/command-line_resource_editor.htm)**

> This console resource editor allows creating a reliable and repeatable process for updating Product Version Information resources during the final stage of the build process from the command prompt.

See specifically the **batch manipulation of file version information** page for greater details:

*   [http://www.heaventools.com/rtconsole-update-version-info.htm](http://www.heaventools.com/rtconsole-update-version-info.htm "Edit Version Info")

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-03-16T19:16:35.553

[StampVer](http://www.elphin.com/downloads/stampver/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-08-19T19:21:56.257

I think `editbin` might be a better solution (installed with Visual Studio)

# asp.net - 通过 ASP.Net AJAX 使用 Windows 身份验证

> ID：607810
> 
> 赞同：1
> 
> 时间：2009-03-03T19:36:44.207
> 
> 标签：asp.net, ajax, authentication, active-directory

我正在使用带有 Web 服务的 ASP.Net 开发我的第一个应用程序，但我遇到了身份验证问题。至少我认为这是问题所在。

当我在调试模式下本地运行应用程序时，它工作正常。当我在 IE 7 中以调试模式（通过 IIS）运行它时，它甚至可以工作。但是当我有一个同事在他们的机器上运行它（从我的 IIS）时，它就不起作用了。查询活动目录以查找用户时，会出现以下错误：

Sys.Net.WebServiceFailedException：服务器方法“GetCurrentUser”失败，出现以下错误：System.Runtime.InteropServices.COMException - 发生操作错误。

我需要做什么才能让这个远程工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-12-24T01:44:23.117

确保 IE 正确地将区域识别为 Intranet，以便它会自动发送它的用户名。如果不是，您需要在 IE 设置中手动将 URL 添加到 Intranet 区域。

那应该可以解决它，并且根据您的配置，您可能需要添加到您的 web.config

您的 web 服务的 web.config 是什么

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-12-30T01:15:54.730

IIS 中网站的身份验证设置是什么？除非它设置为集成 Windows 身份验证，否则不太可能是权限问题。如果您想排除身份验证，请将身份验证方法更改为匿名访问并让您的同事重试。

此外，如果您在 web.config 中指定要模拟的用户，并且在 Active Directory 连接字符串中使用不同的用户名，则可能会导致错误，但尚不清楚这是否会导致您的问题。

# xml - 重用部分 XML 文档的最佳方式是什么？

> ID：607812
> 
> 赞同：0
> 
> 时间：2009-03-03T19:37:47.387
> 
> 标签：xml, reusability

假设我有一个类似于以下的 XML 格式：

```
 <Random>
  <...Some arbitrary amount of nesting here...>
    <Random2>
      <Definition>
        <Name>Ape</Name>
        <Description>A mammal</Description>
      </Definition>
    </Random2>
    <Random2>
      <Definition>
        <Name>Ape</Name>
        <Description>A mammal</Description>
      </Definition>
    </Random2>
  <...More Random2 here, end of nesting.../>
</Random> 
```

是否有通用的标准方法来支持在这种类型的场景中重用定义？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T19:49:13.273

在 xml 模式或 DTD 中，您可以定义 id 和 idref 属性。这允许您在第一次使用它时使用 id 创建它并引用以后的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T19:44:56.917

如果您不希望重复，则在顶层创建一个“定义”元素并将所有“定义”元素放在那里。然后只需在“Random2”元素中放置某种指向定义的指针。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T20:39:46.210

原来我想要标准的 key/keyref 部分，它还允许您指定对象集（例如定义列表） [http://www.w3schools.com/schema/el_keyref.asp](http://www.w3schools.com/schema/el_keyref.asp)

# database - 数据库变更管理工具？

> ID：607813
> 
> 赞同：6
> 
> 时间：2009-03-03T19:37:56.560
> 
> 标签：database, database-design, deployment, database-versioning

我们目前正在巩固数据库变更管理流程。我们在 RedHat 5 上运行 MySql 5。我选择 LiquiBase 作为工具，因为它是开源的，并且允许我们稍后在需要时扩展它的功能。它似乎也是少数仍然活跃的免费项目之一。这里有人有使用 LiquiBase 或其他 Db 版本控制工具的经验吗？

公司背景：我们是一家提供 7/24 托管应用程序的 SaaS 公司。有几十个实例运行同一数据库的不同版本，我们需要一种方法来管理部署过程，因为它开始失控。数据库有数百个表，我们通常每 3 个月发布一次。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-14T05:59:04.023

自从我开始 LiquiBase 以来，我可能有偏见，但我已经在生产环境中使用它好几年了，并且有很多次，如果没有它，发布将是一场噩梦。LiquiBase 已经发展到非常灵活和强大，我已经有一段时间没有遇到它无法处理（以某种方式或另一种方式）的情况了。

我正在使用 LiquiBase 进行的项目中包含的最后一个代码版本包含一个主要的数据库重构，其中包含数百个数据库更改，并且需要应用于具有不同数据库起点的各种安装。当我们发布时，数据库更新没有任何问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T20:08:21.277

Doctrine，一个 PHP ORM/DBAL 提供[Migrations](http://www.doctrine-project.org/documentation/manual/1_0/en/migrations)，做你想做的事。

> Doctrine 迁移包允许您通过一个漂亮的编程接口轻松更新您的生产数据库。更改以某种方式完成，以便您的数据库是版本化的，您可以在数据库版本中来回走动。

# sql-server - 从 T-SQL 中的周数获取日期

> ID：607817
> 
> 赞同：56
> 
> 时间：2009-03-03T19:39:18.693
> 
> 标签：sql-server, tsql, date

在 Microsoft SQL Server 中，我有一个星期数

```
(from DATEPART(wk, datecol)) 
```

但我想做的就是把它变成那一周的日期跨度。

例如，

```
SELECT DATEPART(wk, GETDATE()) 
```

`yields 10`. 我想从这个数字中得出`3/1/2009`和。`3/7/2009`

这可能吗？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-03-03T20:23:26.780

Quassnoi 的回答有效，但是如果日期是在一天中的日期，那么会让你陷入清理日期的麻烦（如果你在中间使用时间，他的一周开始会让你比你需要的时间早一天当天 - 您可以使用 GETDATE()) 进行测试。

我过去用过这样的东西：

```
SELECT 
   CONVERT(varchar(50), (DATEADD(dd, @@DATEFIRST - DATEPART(dw, DATECOL), DATECOL)), 101),
   CONVERT(varchar(50), (DATEADD(dd, @@DATEFIRST - DATEPART(dw, DATECOL) - 6, DATECOL)), 101) 
```

这样做的一个附带好处是，通过使用@@DATEFIRST，您可以处理非标准的一周开始日期（默认为星期日，但使用 SET @@DATEFIRST 您可以更改此设置）。

SQL Server 中的简单日期操作必须如此神秘，这似乎很疯狂，但是你去...

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-11-09T19:09:19.807

您可以将@WeekNum 和@YearNum 设置为您想要的任何值——在此示例中，它们派生自@datecol 变量，该变量设置为GETDATE() 以进行说明。获得这些值后 - 您可以使用以下方法计算一周的日期范围：

```
DECLARE @datecol datetime = GETDATE();
DECLARE @WeekNum INT
      , @YearNum char(4);

SELECT @WeekNum = DATEPART(WK, @datecol)
     , @YearNum = CAST(DATEPART(YY, @datecol) AS CHAR(4));

-- once you have the @WeekNum and @YearNum set, the following calculates the date range.
SELECT DATEADD(wk, DATEDIFF(wk, 6, '1/1/' + @YearNum) + (@WeekNum-1), 6) AS StartOfWeek;
SELECT DATEADD(wk, DATEDIFF(wk, 5, '1/1/' + @YearNum) + (@WeekNum-1), 5) AS EndOfWeek; 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-04-16T22:45:43.557

要回答您的问题：

```
--CHANGE A WEEK NUMBER BACK INTO A DATE FOR THE FIRST DATE OF THE WEEK
DECLARE @TaskWeek INT = 17
DECLARE @TaskYear INT = 2013

SELECT DATEADD(WEEK, @TaskWeek - 1,DATEADD(dd, 1 - DATEPART(dw, '1/1/' + CONVERT(VARCHAR(4),@TaskYear)), '1/1/' + CONVERT(VARCHAR(4),@TaskYear))) 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-09-17T11:44:34.080

如果您的一周从星期一开始（在 SQL Server 2008 上）

```
select datecol,
  DATEPART(ISOWK, datecol) as week,
  ((DATEPART(dw, datecol)+5)%7)+1 as weekday,
  (DATEADD(dd, -((DATEPART(dw, datecol)+5)%7), datecol)) as Monday,
  (DATEADD(dd, -((DATEPART(dw, datecol)+5)%7)+6, datecol)) as Sunday 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-03T19:46:07.977

```
SELECT DATECOL - DATEPART(weekday, DATECOL), DATECOL - DATEPART(weekday, DATECOL) + 7 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-01-31T14:49:27.353

一个函数如何跳转到该周数之前的一周，然后逐步执行接下来的几天，直到周数发生变化（最多 7 步），返回新日期？

```
CREATE FUNCTION dbo.fnGetDateFromWeekNo
(@weekNo int , @yearNo  int)
RETURNS smalldatetime
AS
BEGIN 

DECLARE @tmpDate smalldatetime

set @tmpdate= cast(cast (@yearNo as varchar) + '-01-01' as smalldatetime)
-- jump forward x-1 weeks to save counting through the whole year 
set @tmpdate=dateadd(wk,@weekno-1,@tmpdate)

-- make sure weekno is not out of range
if @WeekNo <= datepart(wk,cast(cast (@yearNo as varchar) + '-12-31' as smalldatetime))
BEGIN
    WHILE (datepart(wk,@tmpdate)<@WeekNo)
    BEGIN
        set @tmpdate=dateadd(dd,1,@tmpdate)
    END
END
ELSE
BEGIN
    -- invalid weeknumber given
    set @tmpdate=null
END

RETURN @tmpDate

END 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2014-03-19T17:53:13.243

我采用了 elindeblom 的解决方案并对其进行了修改 - 字符串的使用（即使转换为日期）让我对世界各地使用的不同日期格式感到紧张。这避免了这个问题。

虽然没有要求，但我还包括时间，因此一周在午夜前 1 秒结束：

```
 DECLARE @WeekNum INT = 12,
        @YearNum INT = 2014 ;

    SELECT  DATEADD(wk,
                    DATEDIFF(wk, 6,
                             CAST(RTRIM(@YearNum * 10000 + 1 * 100 + 1) AS DATETIME))
                    + ( @WeekNum - 1 ), 6) AS [start_of_week],
            DATEADD(second, -1,
                    DATEADD(day,
                            DATEDIFF(day, 0,
                                     DATEADD(wk,
                                             DATEDIFF(wk, 5,
                                                      CAST(RTRIM(@YearNum * 10000
                                                                 + 1 * 100 + 1) AS DATETIME))
                                             + ( @WeekNum + -1 ), 5)) + 1, 0)) AS [end_of_week] ; 
```

是的，我知道我还在选角，但从一个号码开始。它对我来说“感觉”更安全。

这导致：

```
 start_of_week           end_of_week
    ----------------------- -----------------------
    2014-03-16 00:00:00.000 2014-03-22 23:59:59.000 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2020-05-07T06:36:09.203

另一种方法：

```
declare @week_number int;
declare @start_weekday int = 0 -- Monday
declare @end_weekday int = 6 -- next Sunday

select @week_number = datediff(week, 0, getdate())

select 
    dateadd(week, @week_number, @start_weekday) as WEEK_FIRST_DAY, 
    dateadd(week, @week_number, @end_weekday) as WEEK_LAST_DAY 
```

解释：

*   @week_number 是根据初始日历日期“1900-01-01”计算得出的。将*getdate()*替换为您想要的任何日期。
*   如果星期一，@start_weekday 为*0 。*如果是星期日，则将其声明为*-1*
*   如果下周日，@end_weekday 为*6 。*如果是星期六，则声明为*5*
*   然后`dateadd`函数，将给定的周数和给定的天数添加到初始日历日期“1900-01-01”。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-12-16T22:59:22.587

这应该工作，不管`@@DATEFIRST`

```
ALTER FUNCTION dbo.DEV_VW_WeekSerial
    (@YearNum int,
    @WeekNum int,
    @DayNum int)
    RETURNS Date AS

    BEGIN

        DECLARE @FirstDayYear As Date;

        SET @FirstDayYear='01/01/' + CAST(@YearNum As varchar)

        RETURN dateadd(d,(@DayNum-datepart(weekday,@FirstDayYear)),dateadd(week, @WeekNum-1,@FirstDayYear))

    END 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-08-20T20:10:36.590

```
dateadd(
  dd, 
  datepart(wk, @Date)*7, 
  convert(smalldatetime, convert(char,year(max(@Date)))+convert(char, '-01-01'))
)-1 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2012-11-15T07:25:01.850

在这里你只需要传递年份和周数。

```
DECLARE @Year VARCHAR(4)

SET @Year= '2012'

DECLARE @FirstDate DATETIME

SET @FirstDate = (SELECT DATEADD(dd,1,(SELECT DATEADD(wk,DATEPART(wk,GETDATE())-1,Convert(DAteTime,'01-01-' + @Year))))
                 )
DECLARE @LastDate DATETIME

SET @LastDate =(SELECT DATEADD(dd,4,@FirstDate))

SELECT @FirstDate
       ,@LastDate 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2014-03-25T03:18:29.800

给它@Year 和@Week，返回该周的第一个日期。

```
Declare @Year   int
,@Week int
,@YearText varchar(4)

set @Year = 2009
set @Week = 10

set @YearText = @Year

print dateadd(day
             ,1 - datepart(dw, @YearText + '-01-01')
                + (@Week-1) * 7
             ,@YearText + '-01-01') 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2015-06-30T17:53:57.587

我刚刚将 SELECT 与 CASE 语句合并（对于我的情况，星期一标记为一周的第一天，并且不想处理 SET DATEFIRST 命令：

```
CASE DATEPART(dw,<YourDateTimeField>)
   WHEN 1 THEN CONVERT(char(10), DATEADD(DD, -6, <YourDateTimeField>),126) +  ' to ' + CONVERT(char(10), <YourDateTimeField>,126)
   WHEN 2 THEN CONVERT(char(10), <YourDateTimeField>,126) +  ' to ' + CONVERT(char(10), DATEADD(DD, 6, <YourDateTimeField>),126)
   WHEN 3 THEN CONVERT(char(10), DATEADD(DD, -1, <YourDateTimeField>),126) +  ' to ' + CONVERT(char(10), DATEADD(DD, 5, <YourDateTimeField>),126)
   WHEN 4 THEN CONVERT(char(10), DATEADD(DD, -2, <YourDateTimeField>),126) +  ' to ' + CONVERT(char(10), DATEADD(DD, 4, <YourDateTimeField>),126)
   WHEN 5 THEN CONVERT(char(10), DATEADD(DD, -3, <YourDateTimeField>),126) +  ' to ' + CONVERT(char(10), DATEADD(DD, 3, <YourDateTimeField>),126)
   WHEN 6 THEN CONVERT(char(10), DATEADD(DD, -4, <YourDateTimeField>),126) +  ' to ' + CONVERT(char(10), DATEADD(DD, 2, <YourDateTimeField>),126)
   WHEN 7 THEN CONVERT(char(10), DATEADD(DD, -5, <YourDateTimeField>),126) +  ' to ' + CONVERT(char(10), DATEADD(DD, 1, <YourDateTimeField>),126)
   ELSE 'UNK'
END AS Week_Range 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2017-03-28T03:55:42.117

**除一年中的第一周和最后一周**外，得票最多的答案效果很好。当*datecol*值为**'2009-01-01'**时，结果将是**01/03/2009**和**12/28/2008**。

我的解决方案：

```
DECLARE @Date date = '2009-03-01', @WeekNum int, @StartDate date;
SELECT @WeekNum = DATEPART(WEEK, @Date);
SELECT @StartDate = DATEADD(DAY, -(DATEPART(WEEKDAY, DATEADD(YEAR, DATEDIFF(YEAR, 0, @Date), 0)) + 6), DATEADD(YEAR, DATEDIFF(YEAR, 0, @Date), 0));
SELECT CONVERT(nvarchar, CASE WHEN @WeekNum = 1 THEN CAST(DATEADD(YEAR, DATEDIFF(YEAR, 0, @Date), 0) AS date) ELSE DATEADD(DAY, 7 * @WeekNum, @StartDate) END, 101) AS StartOfWeek
      ,CONVERT(nvarchar, CASE WHEN @WeekNum = DATEPART(WEEK, DATEADD(DAY, -1, DATEADD(YEAR, DATEDIFF(YEAR, 0, @Date) + 1, 0))) THEN DATEADD(DAY, -1, DATEADD(YEAR, DATEDIFF(YEAR, 0, @Date) + 1, 0)) ELSE DATEADD(DAY, 7 * @WeekNum + 6, @StartDate) END, 101) AS EndOfWeek; 
```

这将在第一周显示**01/01/2009**和**01/03/2009**，并在第 10 周显示**03/01/2009**和**03/07/2009**。

我认为这正是您想要的。您可以根据需要将变量替换为它们的表达式。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2018-09-27T09:08:25.130

```
declare @IntWeek as varchar(20)
SET @IntWeek = '201820'

SELECT 
    DATEADD(wk, DATEDIFF(wk, @@DATEFIRST, LEFT(@IntWeek,4) + '-01-01') +
    (cast(RIGHT(@IntWeek, 2) as int) -1), @@DATEFIRST) AS StartOfWeek 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2010-09-23T18:12:57.353

```
SELECT DATEADD(week, @weekNumber - 1, DATEADD(DAY, @@datefirst - DATEPART(weekday, CAST(YEAR(GETDATE()) AS VARCHAR) + '-01-01') - 6, CAST(YEAR(GETDATE()) AS VARCHAR) + '-01-01')) 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2011-07-04T14:57:08.577

```
DECLARE @dayval int,
 @monthval int,
 @yearval int

SET @dayval = 1
SET @monthval = 1
SET @yearval = 2011

DECLARE @dtDateSerial datetime

        SET @dtDateSerial = DATEADD(day, @dayval-1,
                                DATEADD(month, @monthval-1,
                                    DATEADD(year, @yearval-1900, 0)
                                )
                            )

DECLARE @weekno int
SET @weekno = 53

DECLARE @weekstart datetime
SET @weekstart = dateadd(day, 7 * (@weekno -1) - datepart (dw, @dtDateSerial), @dtDateSerial)

DECLARE @weekend datetime
SET @weekend = dateadd(day, 6, @weekstart)

SELECT @weekstart, @weekend 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2014-03-10T20:26:50.943

**回答：**

```
select  DateAdd(day,-DATEPart(DW,<Date>), <Date>) [FirstDayOfWeek] ,DateAdd(day,-DATEPart(DW,<Date>)+6, <Date>) [LastDayOfWeek]
FROM <TABLE> 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2016-01-20T15:32:31.000

**这对我有用：**

```
select 
    convert(varchar(50), dateadd(dd, - datepart(dw, DATECOL) + 1, DATECOL), 101),
    convert(varchar(50), dateadd(dd, - datepart(dw, DATECOL) + 7, DATECOL), 101) 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2016-08-04T18:20:54.910

我没有花时间在这里测试每个答案，但似乎没有什么比这更简单有效：

```
DECLARE @WeekNum int
DECLARE @YearNum char(4)

SELECT DATEADD(wk, DATEDIFF(wk, 6, '1/1/' + @YearNum) + (@WeekNum-1), 6) AS StartOfWeek

SELECT DATEADD(wk, DATEDIFF(wk, 5, '1/1/' + @YearNum) + (@WeekNum-1), 5) AS EndOfWeek 
```

# python - Django 电子邮件

> ID：607819
> 
> 赞同：12
> 
> 时间：2009-03-03T19:40:23.560
> 
> 标签：python, django, email, django-email

我正在使用 Gmail SMTP 服务器发送来自我网站用户的电子邮件。

这些是我的 settings.py 中的默认设置

```
EMAIL_HOST = 'smtp.gmail.com'
EMAIL_HOST_USER = 'example@example.com'
EMAIL_HOST_PASSWORD = 'pwd'
EMAIL_PORT = 587
EMAIL_USE_TLS = True
SERVER_EMAIL = EMAIL_HOST_USER
DEFAULT_FROM_EMAIL = EMAIL_HOST_USER 
```

如果我希望用户发送电子邮件，我将覆盖这些设置并使用 Django 的电子邮件发送方法发送电子邮件。当系统发生异常时，我会收到来自 example@example.com 的电子邮件。有时我会收到来自某个登录用户的电子邮件。这也可能意味着当用户收到从我的网站发送的电子邮件时，它的发送地址与实际用户不同。

应该怎么做才能避免这种情况？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-03-03T21:15:14.893

Django 仅在任何邮件发送函数传递或空字符串作为*发件人地址时使用***settings.DEFAULT_FROM_EMAIL**。这可以在 中验证。`None`*`django/core/mail.py`*

 *当出现未处理的异常时，Django 调用始终使用**settings.SERVER_EMAIL**`mail_admins()`的函数，并且**只**发送到**settings.ADMINS**中列出的地址。这也可以在.`django/core/mail.py`******`django/core/mail.py`******

 ******Django 本身发送电子邮件的唯一其他地方是如果**settings.SEND_BROKEN_LINK_EMAILS**为 True，那么 CommonMiddleware 会将邮件发送到**settings.MANAGERS**中列出的所有地址，并且电子邮件发件人是**settings.SERVER_EMAIL**。

因此，普通用户只有在您致电时才会收到来自您网站的电子邮件`send_mail()`。因此，始终传递真实地址作为`from_mail`参数，您将避免用户收到来自**settings.SERVER_EMAIL**或**settings.DEFAULT_FROM_EMAIL**的电子邮件。

旁注：django-registration 至少是 Django 插件的一个示例，它将从**settings.DEFAULT_FROM_EMAIL**发送邮件，因此在这种情况下，您需要确保它是正确的电子邮件地址，例如 support@yoursite.com 或网站管理员@yoursite.com。

# delphi - 如何枚举 JvMemoryData...或者，如何创建具有单个键和多个值的哈希？

> ID：607820
> 
> 赞同：0
> 
> 时间：2009-03-03T19:40:33.420
> 
> 标签：delphi, data-structures, hash

我正在使用[JvMemoryData](http://sourceforge.net/projects/jvcl)来填充 JvDBUltimGrid。我主要使用这个 JvMemoryData 作为数据结构，因为我不知道有什么其他东西可以满足我的需求。

我没有处理大量数据，但我确实需要一种方法来枚举我添加到 JvMemoryData 的记录。有没有人这样做过？是否有可能使用 TSQLQuery 以某种方式“查询”这些数据？

或者，有没有更好的方法来做到这一点？在数据结构方面我有点天真，所以也许有人可以指出我正确的方向。我真正需要的是一个字典/哈希，它允许 1 个键和许多值。像这样：

```
KEY1: val1;val2;val3;val4;val5;etc...
KEY2: val1;val2;val3;val4;val5;etc... 
```

我考虑在 IniFiles 单元中使用[THashedStringList](http://www.functionx.com/bcb/classes/thashtable.htm)，但它仍然存在同样的问题，因为它只允许 1 个键与一个值相关联。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T21:36:06.667

一种方法是创建一个 TStringList，并让每个项目的对象指向另一个包含所有值的 TList（或 TStringList）。如果最上面的字符串列表已排序，则检索只是二进制搜索。

要将项目添加到最顶层列表，请使用类似以下的内容 (SList = TStringList)：

```
Id := SList.AddObject( Key1, tStringList.Create );
InnerList := tStringList(SList.Objects[id]);
// for each child in list
  InnerList.add( value ); 
```

当需要处理列表时，请确保您也释放了每个内部列表。

```
for i := 0 to SList.count-1 do
  begin
    if Assigned(SList.Objects[i]) then
      SList.Objects[i].free;
    SList.Objects[i] := nil;
  end;
FreeAndNil(SList); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T19:45:28.353

我不是 Delphi 程序员，但你不能只使用列表或数组作为每个哈希条目的值吗？在 Java 术语中：

```
Map<String,List> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T20:53:58.827

你似乎已经在使用 Jedi。Jedi 包含允许你用任何东西映射任何东西的类。

看看这个[相关的问题](https://stackoverflow.com/questions/247654/how-to-use-jedi-tjclhashmap-classes)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T20:17:06.637

我一直在将任意复杂的用户定义记录类型的数组与 TStringList 或 THashedStringList 结合使用作为缓存。我使用密钥访问每条记录。首先，我检查字符串列表是否匹配。如果不匹配，则从数据库中获取记录并将其放入数组中。我将它的数组索引放入字符串列表中。使用我正在使用的记录，我的代码如下所示：

```
function TEmployeeCache.Read(sCode: String): TEmployeeData;
var iRecNo: Integer;
    oEmployee: TEmployee;
begin
  iRecNo := CInt(CodeList.Values[sCode]);
  if iRecNo = 0 then begin
    iRecNo := FNextRec;
    inc(FNextRec);
    if FNextRec > High(Cache)  then SetLength(Cache, FNextRec * 2);
    oEmployee := TEmployee.Create;
    oEmployee.Read(sCode);
    Cache[iRecNo] := oEmployee.Data;
    oEmployee.Free;
    KeyList.Add(Format('%s=%s', [CStr(Cache[iRecNo].hKey), IntToStr(iRecNo)]));
    CodeList.Add(Format('%s=%s', [sCode, IntToStr(iRecNo)]));
  end;
  Result := Cache[iRecNo];
end; 
```

我一直以这种方式获得看似即时的访问权限。

杰克

# wpf - WPF中的Width和ActualWidth有什么区别？

> ID：607827
> 
> 赞同：50
> 
> 时间：2009-03-03T19:42:42.790
> 
> 标签：wpf, size, width, actualwidth

我目前`Panel`在 WPF 中使用 s ，我注意到关于`Width`and`Height`属性，还有另外两个称为`ActualWidth`and的属性`ActualHeight`。

> `ActualWidth`
> 
> 获取此元素的呈现宽度。这是一个依赖属性。（继承自 FrameworkElement。）
> 
> `Width`
> 
> 获取或设置元素的宽度。这是一个依赖属性。（继承自 FrameworkElement。）

*参考：[MSDN](http://msdn.microsoft.com/en-us/library/system.windows.controls.panel_members.aspx)*

谁能指出**两者之间的区别以及何时使用其中之一？**

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2009-03-03T19:48:57.890

`Width`/`Height`是*请求的或布局*大小。如果您设置为 Auto，则该值是`double.NaN`您在后面的代码中访问该属性时的值。

`ActualWidth`//`ActualHeight`和`RenderSize.Width`/`RenderSize.Height`都返回元素的渲染大小，因为*RenderSize*是**Size**类型。如果您想要/需要项目的实际大小，请使用这些属性中的任何一个。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2010-10-25T02:34:56.933

`ActualWidth`当我想将一个元素的宽度或高度绑定到另一个元素时，我发现它最有用。

在这个简单的示例中，我有两个并排排列的按钮，下面的注释被限制为包含两个按钮的 StackPanel 的宽度。

```
<StackPanel>

    <StackPanel Margin="0,12,0,0" Orientation="Horizontal" Name="buttonPanel" HorizontalAlignment="Left" >
         <Button Content="Yes - Arm the missile" FontWeight="Bold" HorizontalAlignment="Left"/>
         <Button Content="No - Save the world" HorizontalAlignment="Left" Margin="7,0,0,0"/>
    </StackPanel>

    <TextBlock Text="Please choose whether you want to arm the missile and kill everybody, or save the world by deactivating the missile." 
               Width="{Binding Path=ActualWidth,ElementName=buttonPanel}" Margin="0,5,0,0" HorizontalAlignment="Left" TextWrapping="Wrap"/>

</StackPanel> 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2010-10-21T16:20:57.040

`ActualWidth`考虑值中的填充，因此任何时候您都需要知道可以调用的数字`Actualwidth`而不是宽度并避免计算。

编辑：删除 Margin b/c 它不是 ActualWidth 的一部分。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-10-04T11:32:10.530

有一个很好的理由**不使用`ActualWidth`**to 绑定到（显然`ActualHeight`相应地）。当您将`Width`一个元素的设置`ActualWidth`为另一个元素时，您可能会**破坏布局链**。

在最好的情况下，您的元素/控件需要在父（绑定源）的布局过程完成后进行解析。这意味着额外的时间。如果它与父级处于同一层次结构级别，则布局过程需要（至少）两次运行来计算确定的大小。

例如，我有一个控件，它的 size 属性被一种样式覆盖，该样式会将其设置为`TemplatedParent` **(don't do)**：

```
<Rectangle DockPanel.Dock="Top" Width="{TemplateBinding ActualWidth}" 
           Height="1" Fill="#000000"/> 
```

当调整包含窗口的大小时，控件会阻止容器变小并阻止布局。将其设置为`Width`将解决问题**（做）**：

```
<Rectangle DockPanel.Dock="Top" Width="{TemplateBinding Width}" 
           Height="1" Fill="#000000"/> 
```

如果您必须使用`ActualWidth`一般情况下您的 xaml 有问题。更好地解决这个问题，而不是弄乱布局运行的最终大小。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-03T19:46:41.237

`ActualWidth`由渲染系统设置，可能会根据其他元素的宽度和整体大小限制而有所不同。结果，它无法更改。`Width`是一个可以改变的属性，应该用来增加或减少元素的宽度。

来自[MSDN](http://msdn.microsoft.com/en-us/library/system.windows.frameworkelement.actualwidth.aspx)：

> 此属性是基于其他宽度输入和布局系统的计算值。该值由布局系统本身根据实际渲染过程设置，因此可能会稍微落后于作为`Width`输入更改基础的属性的设置值。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-03T19:47:11.030

正是这样，渲染宽度！=布局宽度。一个用于布局，另一个用于渲染。它与 WinForms 一样，有一个 Size 和一个 ClientSize 属性，略有不同，您应该使用 Atual/Client 的渲染大小和 Width/Height 进行布局。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-03T19:52:28.680

您可以设置`Width`属性，但不能设置`ActualWidth`属性。

该`Width`属性用于确定面板的呈现方式，然后将`ActualWidth`其设置为使用的实际宽度。这可能与 Width 的值不同，具体取决于它的子元素的大小和它的父元素的限制。

`ActualWidth`设置属性时不会立即设置，`Width`但会在渲染期间更新（一次或多次）。

# haskell - 使用 Haskell state monad 有代码味道吗？

> ID：607830
> 
> 赞同：62
> 
> 时间：2009-03-03T19:44:31.273
> 
> 标签：haskell, coding-style, monads, state-monad

上帝我讨厌“代码气味”这个词，但我想不出更准确的说法。

我在业余时间为[Whitespace](http://compsoc.dur.ac.uk/whitespace/)设计高级语言和编译器，以了解编译器构造、语言设计和函数式编程（编译器是用 Haskell 编写的）。

在编译器的代码生成阶段，我必须在遍历语法树时维护“状态”数据。例如，在编译流控制语句时，我需要为要跳转到的标签生成唯一名称（从传入、更新和返回的计数器生成的标签，并且不得再次使用计数器的旧值）。另一个例子是当我在语法树中遇到内联字符串文字时，需要将它们永久转换为堆变量（在 Whitespace 中，字符串最好存储在堆中）。我目前正在将整个代码生成模块包装在 state monad 中来处理这个问题。

有人告诉我，编写编译器是一个非常适合函数式范例的问题，但我发现我设计它的方式与我在 C 中设计它的方式非常相似（你真的可以用任何语言编写 C - 甚至带有状态单子的 Haskell）。

我想学习如何在 Haskell 中思考（而不是在函数范式中）——而不是在带有 Haskell 语法的 C 中。我真的应该尝试消除/最小化 state monad 的使用，还是它是一种合法的功能性“设计模式”？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2009-03-04T04:23:24.473

我在 Haskell 中编写了多个编译器，状态 monad 是许多编译器问题的合理解决方案。但是你想让它保持抽象——不要让它明显你正在使用一个 monad。

这是来自 Glasgow Haskell Compiler 的一个示例（我没有编写它*；*我只是围绕一些边缘工作），我们在其中构建控制流图。以下是制作图表的基本方法：

```
empyGraph    :: Graph
mkLabel      :: Label -> Graph
mkAssignment :: Assignment -> Graph  -- modify a register or memory
mkTransfer   :: ControlTransfer -> Graph   -- any control transfer
(<*>)        :: Graph -> Graph -> Graph 
```

但正如您所发现的，维持唯一标签的供应充其量是乏味的，因此我们也提供以下功能：

```
withFreshLabel :: (Label -> Graph) -> Graph
mkIfThenElse :: (Label -> Label -> Graph) -- branch condition
             -> Graph   -- code in the 'then' branch
             -> Graph   -- code in the 'else' branch 
             -> Graph   -- resulting if-then-else construct 
```

整个`Graph`事情是一个抽象类型，翻译者只是愉快地以纯粹的功能方式构造图形，而不知道任何单子正在发生。然后，当最终构建图时，为了将其转换为可以生成代码的代数数据类型，我们为其提供唯一标签，运行状态单子，并提取数据结构。

状态单子隐藏在下面；虽然它没有暴露给客户端，但定义`Graph`是这样的：

```
type Graph = RealGraph -> [Label] -> (RealGraph, [Label]) 
```

或者更准确一点

```
type Graph = RealGraph -> State [Label] RealGraph
  -- a Graph is a monadic function from a successor RealGraph to a new RealGraph 
```

状态单子隐藏在抽象层后面，一点也不臭！

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2009-06-30T07:10:14.157

我会说这种状态通常不是代码气味，只要它保持小且控制良好。

这意味着使用诸如 State、ST 或定制的 monad，或者只是拥有一个包含状态数据的数据结构，然后传递到几个地方，这并不是一件坏事。（实际上，monad 只是帮助做这件事！）然而，拥有遍布整个地方的状态（是的，这意味着你，IO monad！）是一种难闻的气味。

一个相当明显的例子是，当我的团队为[2009 年 ICFP 编程竞赛](http://icfpcontest.org/)的参赛作品工作时（代码可在 git://git.cynic.net/haskell/icfp-contest-2009 获得）。我们最终得到了几个不同的模块化部分：

*   VM：运行模拟程序的虚拟机
*   控制器：几组不同的例程，它们读取模拟器的输出并生成新的控制输入
*   解决方案：根据控制器的输出生成解决方案文件
*   可视化器：几组不同的例程，它们读取输入和输出端口，并生成某种可视化或模拟过程中发生的日志

它们中的每一个都有自己的状态，它们都通过 VM 的输入和输出值以各种方式进行交互。我们有几个不同的控制器和可视化器，每个都有自己不同的状态。

这里的关键是任何特定状态的内部都仅限于它们自己的特定模块，每个模块甚至对其他模块的状态存在一无所知。任何特定的有状态代码和数据集通常只有几十行，状态中包含少量数据项。

所有这些都被粘在一个大约十几行的小函数中，它无法访问任何状态的内部，它只是在循环模拟时以正确的顺序调用正确的东西，并通过一个非常有限的每个模块的外部信息量（当然还有模块的先前状态）。

当状态以如此有限的方式使用，并且类型系统阻止您无意中修改它时，它很容易处理。这是 Haskell 的优点之一，它可以让你做到这一点。

一个答案是：“不要使用单子。” 在我看来，这完全是倒退。Monad 是一种控制结构，除其他外，它可以帮助您最大限度地减少接触状态的代码量。如果您以单子解析器为例，解析器的状态（即，正在解析的文本、已进入其中的程度、已累积的任何警告等）必须贯穿解析器中使用的每个组合器. 然而，实际上直接操纵状态的组合器只有少数；其他任何东西都使用这几个功能之一。这使您可以在一个地方清楚地看到所有可以更改状态的少量代码，并且更容易推断出如何更改状态，从而更容易处理。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-03T20:41:21.387

你看过[属性语法](http://www.haskell.org/haskellwiki/Attribute_grammar)（AG）吗？[（有关维基百科](http://en.wikipedia.org/wiki/Attribute_grammar)的更多信息和Monad Reader 中的[文章）？](http://www.haskell.org/haskellwiki/The_Monad.Reader/Issue4/Why_Attribute_Grammars_Matter)

使用 AG，您可以将*属性*添加到语法树。这些属性分为*合成*属性和*继承*属性。

合成属性是您从语法树生成（或合成）的东西，这可能是生成的代码，或所有注释，或您感兴趣的任何其他内容。

继承的属性被输入到您的语法树中，这可能是环境，或者是代码生成期间要使用的标签列表。

在乌得勒支大学，我们使用[属性语法系统](http://www.cs.uu.nl/wiki/HUT/AttributeGrammarSystem)( [UUAGC](http://hackage.haskell.org/cgi-bin/hackage-scripts/package/uuagc) ) 来编写编译器。这是一个预处理器，它`.hs`从提供的文件生成haskell 代码（文件）`.ag`。

* * *

虽然，如果你还在学习 Haskell，那么也许现在不是开始学习另一层抽象的时候。

在这种情况下，您可以手动编写属性语法为您生成的那种代码，例如：

```
data AbstractSyntax = Literal Int | Block AbstractSyntax
                    | Comment String AbstractSyntax

compile :: AbstractSyntax -> [Label] -> (Code, Comments)
compile (Literal x) _      = (generateCode x, [])
compile (Block ast) (l:ls) = let (code', comments) = compile ast ls
                             in (labelCode l code', comments)
compile (Comment s ast) ls = let (code, comments') = compile ast ls
                             in (code, s : comments')

generateCode :: Int -> Code
labelCode :: Label -> Code -> Code 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-04T11:56:30.017

您可能想要一个应用函子而不是单子：

[http://www.haskell.org/haskellwiki/Applicative_functor](http://www.haskell.org/haskellwiki/Applicative_functor)

我认为原始论文比维基解释得更好，但是：

[http://www.soi.city.ac.uk/~ross/papers/Applicative.html](http://www.soi.city.ac.uk/~ross/papers/Applicative.html)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-05-03T12:52:24.743

我不认为使用 State Monad 来建模状态时会产生代码异味。

如果您需要通过函数线程化状态，您可以显式执行此操作，将状态作为参数并在每个函数中返回它。State Monad 提供了一个很好的抽象：它为您传递状态并提供许多有用的函数来组合需要状态的函数。在这种情况下，使用 State Monad（或 Applicatives）并不是代码异味。

但是，如果您使用 State Monad 来模拟命令式编程风格，而函数式解决方案就足够了，那么您只会让事情变得复杂。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-04T15:03:07.663

一般来说，您应该尽可能避免使用状态，但这并不总是可行的。 `Applicative`使有效的代码看起来更漂亮、更实用，尤其是树遍历代码可以从这种风格中受益。对于名称生成问题，现在有一个相当不错的包可用：[value-supply](http://hackage.haskell.org/cgi-bin/hackage-scripts/package/value-supply-0.5)。

* * *

## 回答 #7

> 赞同：-5
> 
> 时间：2009-03-03T20:12:59.223

好吧，不要使用单子。函数式编程的强大之处在于函数纯度和它们的重用。我的一位教授曾经写过这篇论文，他是帮助构建 Haskell 的人之一。

这篇论文叫做“[为什么函数式编程很重要](http://www.cse.chalmers.se/~rjmh/Papers/whyfp.html)”，我建议你通读一遍。这是一个很好的阅读。

* * *

## 回答 #8

> 赞同：-13
> 
> 时间：2009-03-03T20:14:13.573

让我们注意这里的术语。状态本身并不坏；函数式语言有状态。当您发现自己想要分配变量值并更改它们时，什么是“代码气味”。

当然，Haskell 状态 monad 的存在正是出于这个原因——与 I/O 一样，它让您在受限的上下文中执行不安全和无功能的事情。

所以，是的，这可能是代码的味道。

# c++ - hash_map 有多普遍？

> ID：607836
> 
> 赞同：4
> 
> 时间：2009-03-03T19:45:50.457
> 
> 标签：c++, compiler-construction, portability

和头文件`hash_map`还`hash_set`没有包含在 C++ 标准中，但是它们可以作为我最近使用的所有编译器的扩展提供。

我想知道在不牺牲可移植性的情况下，我可以在多大程度上依赖这些实际代码。我正在研究需要在大量架构和编译器上运行的工具项目，包括：

*   **Linux（x86_64、AMD/Intel）：** GCC、Intel、Portland 编译器
*   **AIX（电源）：** GCC、xlC
*   **Cray XT 系列 (AMD)：** GCC、Portland、Pathscale 编译器
*   **IBM Blue Gene 系列（电源）：** xlC、GCC
*   **SGI Altix (Itanium)：**英特尔编译器
*   **Windows：**不是真正的优先事项，但随时提供有用的答案。

我意识到其中一些非常奇特，但这不是重点。您对跨多个平台和编译器的 STL 扩展有何经验？它们无处不在吗？你会在**你**的项目中使用它们吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-03T19:53:16.150

我可能会寻找升压等效物并使用它。至少他们有一些来自用户的压力，要求他们独立于平台。我无法想象如果您针对 GCC 和 Intel 编译器提交错误并告诉他们调和他们在 hash_map 实现方式上的分歧会发生什么。充其量你可以让他们互相交谈。假设您甚至实现了这一点，那么您只修复了 Intel 和 GCC 编译器的不同之处。祝大家好运，并在几年内解决问题。

至少通过提升，您知道一个组织正在解决跨平台的任何差异..

**编辑** boost 等价物显然是[unordered set](http://www.boost.org/doc/libs/1_36_0/doc/html/boost/unordered_set.html)或[unordered map](http://www.boost.org/doc/libs/1_37_0/doc/html/boost/unordered_map.html)。（感谢头极客）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-03T19:50:42.177

不，如果你是一个足够大的组织/项目，你会自己写。这样，您可以定制它们以更好地满足您的需求并解决可移植性问题。EA 做到了这一点，他们的“eastl”旨在针对所有游戏平台，PC、Mac、XBOX360、Wii、PS2、PS3 等......

# c# - 我的网站是否已关闭、无法正常工作或有错误？

> ID：607846
> 
> 赞同：1
> 
> 时间：2009-03-03T19:48:13.447
> 
> 标签：c#, .net, asp.net, vb.net, web

我想创建一个小型 Windows 应用程序，它会在每个时间段自动转到我的站点并检查它是否运行正常，是否发现它已关闭、无法正常工作或出现错误“示例：404，网络错误，与数据库的连接失败”它将在我的屏幕上显示一条消息。

我怎么知道使用任何 .NET 语言以编程方式存在错误？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-03T19:59:16.540

使用`WebClient`. 它看起来像这样：

```
 WebClient client = new WebClient();
    try
    {
        string response =
            client.DownloadString("http://www.example.com/tester.cgi");

        // We at least got the file back from the server

        // You could optionally look at the contents of the file
        // for additional error indicators      
        if (response.Contains("ERROR: Something"))
        {
            // Handle
        }
    }
    catch (WebException ex)
    {
        // We couldn't get the file.
        // ... handle, depending on the ex
        //
        // For example, by looking at ex.Status:
        switch (ex.Status)
        {
            case WebExceptionStatus.NameResolutionFailure:
                // ...
            break;
            // ...
        }
    } 
```

`Timer`您可以将其与's事件或其他东西挂钩`Tick`以定期进行检查。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-03T20:00:45.367

何苦？[您可以从像RedAlert](http://www.redalert.com/)这样的提供商那里以便宜的价格获得更好的解决方案

这样做的好处是：

1) 它从防火墙外部测试您的站点，因此它可以检测到更广泛的问题。

2) 它是一个公正的第 3 方，因此如果您需要 SLA，您可以证明正常运行时间。

3) 只需支付少量费用，您就可以尝试诊断问题。

4）当出现问题时，它可以寻呼或发送电子邮件给您。

5）您不需要调试新服务器。

天啊，我听起来像是给这些家伙打的广告，但我保证我不会为他们工作或得到回扣。我刚刚对我们服务器的服务感到满意。

顺便说一句：我检查了定价，每个站点/月约为 20 美元。因此，您可能会在比自己构建它所需的时间更短的时间内支付一年的服务费用。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-03T20:11:34.343

想要执行相同的功能，我首先研究了第三方解决方案。[MonitorUs](http://mon.itor.us/)是一项免费且相当准确的特定服务。

但是，如果您想建立自己的，那么我会有一个建议。考虑使用 Head 请求而不是 get 请求：

> HEAD 方法与 GET 相同，只是服务器不能在响应中返回消息体。响应 HEAD 请求的 HTTP 标头中包含的元信息应该与响应 GET 请求发送的信息相同。此方法可用于获取有关请求所隐含的实体的元信息，而无需传输实体主体本身。这种方法通常用于测试超文本链接的有效性、可访问性和最近的修改。[w3.org](http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html)

这是[Peter Bromberg](http://www.eggheadcafe.com/tutorials/aspnet/2c13cafc-be1c-4dd8-9129-f82f59991517/the-lowly-http-head-reque.aspx)文章的链接，该文章解释了如何在 C# 中执行 Head 请求。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-03T19:53:35.977

使用 HttpWebRequest，并将其包装在 WebException 的 try catch 中。异常对象中的错误代码将为您提供代码。404等。如果是500，您可以打印消息。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-03T19:54:35.990

使用 System.Net.WebClient 对象。它比 HttpWebRequest 更容易使用。它有一个“DownloadString”方法，可以将 URL 的内容下载到字符串中。如果服务器返回 500，该方法也可能引发 WebException 错误。对于其他错误，您可以解析字符串并查找关键字。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-03T20:03:57.373

如果你这样做，创建一个特殊的页面来运行任何特殊的子系统，比如数据库、文件 IO 等，并以纯文本而不是 html 的形式提供结果。这将使您能够更轻松地解析返回的数据，并且还可以捕获可能不会给您 404 或 500 HTTP 错误的 DB 或 IO 问题。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-03T20:10:24.283

试试 Adventnet 的应用程序管理器（[http://www.manageengine.com/products/applications_manager/](http://www.manageengine.com/products/applications_manager/)），它可以免费使用 5 台显示器，并提供出色的监控功能

您可以配置在发送电子邮件等失败时可以执行的操作。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-03T20:06:13.153

如果您希望在站点关闭时接收电子邮件/短信，请尝试[Are My Sites Up](http://www.aremysitesup.com/)基于 Web 的解决方案。

# c# - c#中继承和接口的意外行为

> ID：607848
> 
> 赞同：2
> 
> 时间：2009-03-03T19:48:18.487
> 
> 标签：c#, inheritance, interface

今天，在用 c# 实现一些测试类时，我偶然发现了一些关于 c# 中的继承（和接口）的问题。下面我有一些示例代码来说明我的问题。

```
interface ILuftfahrzeug
{
    void Starten();
}

class Flugzeug : ILuftfahrzeug
{
    public void Starten()
    {
        Console.WriteLine("Das Flugzeug startet, "+Dings());
    }

    protected string Dings()
    {
        return "Flugzeug Dings";
    }
}

class Motorflugzeug : Flugzeug, ILuftfahrzeug
{
    public new void Starten()
    {
        Console.WriteLine("Das Motorflugzeug startet, "+Dings());
    }

    protected new string Dings()
    {
        return "Motorflugzeug Dings";
    }
}

class InterfaceUndVererbung
{
    static void Main(string[] args)
    {
        //Motorflugzeug flg = new Motorflugzeug(); // case1: returns "Das Motorflugzeug startet, Motorflugzeug Dings"
        //Flugzeug flg = new Motorflugzeug(); // case2: returns "Das Flugzeug startet, Flugzeug Dings"
        ILuftfahrzeug flg = new Motorflugzeug(); // case3: returns "Das Motorflugzeug startet, Motorflugzeug Dings"
                    // if Motorflugzeug implements ILuftfahrzeug explicitly, 
                    // otherwise "Das Motorflugzeug startet, Motorflugzeug Dings"

        flg.Starten();
        Console.ReadLine();
    }
} 
```

这些是我的问题：

1.  使用 Flugzeug 声明和初始化 flg = new Motorflugzeug(); （case2）我希望调用 Motorflugzeug.Starten 而不是 Flugzeug.Starten（我很确定这是 Java 显示的行为）。openbook.galileo 说在这种情况下使用 c# 运行时类型是 Flugzeug。有什么理由吗？对我来说，这种继承行为毫无意义。
2.  与 ILuftfahrzeug flg = new Motorflugzeug(); 相同 (case3) - 在这里我可以通过让 Motorflugzeug 显式地实现 ILuftfahrzeug 来解决问题（就像在示例代码中一样）。但对我来说这是多余的，因为 Flugzeug 已经实现了 ILuftfahrzeug。
3.  现在我想覆盖由 Starten() 调用的受保护方法 Dings()。如果我按照示例中的实现方式运行代码，则一切正常。但是如果在 Motorflugzeug 中没有实现 Starten()，则将调用基类的 Dings() 而不是 Motorflugzeug.Dings()。有人告诉我 Java 也表现出这种行为。
    有什么模式可以解决这个问题吗？否则，我将不得不覆盖调用我实际打算覆盖的方法（此处：Dings()）的每个方法（此处：Starten()），即使它与基类中的完全相同。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-03T19:54:55.147

1：您正在*重新声明*方法（`new`）；如果你`override`应该工作。`new`打破任何多态行为。

2：你正在*重新实现*接口；这确实是最高的实现。再次，`override`将解决此问题。

```
class Flugzeug : ILuftfahrzeug {
    public virtual void Starten() {
        Console.WriteLine("Das Flugzeug startet, " + Dings());
    }    
    protected virtual string Dings() {
        return "Flugzeug Dings";
    }
}
class Motorflugzeug : Flugzeug {
    public override void Starten() {
        Console.WriteLine("Das Motorflugzeug startet, " + Dings());
    }    
    protected override string Dings() {
        return "Motorflugzeug Dings";
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T19:56:28.777

只需确保将您希望能够覆盖的方法声明为虚拟方法。然后在继承的类上使用 override 关键字。

**更新 1：** new 关键字明确了这样一个事实，即在直接使用该类时，仅在继承的类上声明非虚拟方法只会隐藏基方法。每当您使用基类时，都没有什么可隐藏的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T19:57:29.417

new keywork 和 override 关键字做了两件非常不同的事情，并且您正在体验 new 的行为，从您的描述来看，我认为您希望使用 override，因为这遵循通常预期的继承行为。您需要在基类中声明方法/属性 virtual 并使用 override 而不是 new。

呵呵，太慢了！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T19:57:46.107

这是因为您使用了“new”修饰符，请参阅[MSDN](http://msdn.microsoft.com/en-us/library/435f1dw2(VS.80).aspx)

您应该改用“覆盖”

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-03T19:59:26.913

实现的接口成员不是自动虚拟的。让它们成为虚拟的、抽象的等取决于你。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-03T19:59:50.313

您的程序没有按照您的预期执行的原因是因为`new`您的方法中的关键字。

c#方法默认不动态绑定。这意味着调用的方法是在编译时确定的。您可以查看*变量的类型*确定调用哪个方法而不是内存中它背后的实际对象。

要达到你想要的效果，你需要确保c3动态绑定方法。`virtual`你可以通过声明方法和覆盖方法来做事`override`。

```
class Flugzeug : ILuftfahrzeug
{
    public virtual void Starten()
    {
        Console.WriteLine("Das Flugzeug startet, "+Dings());
    }

    protected virtual string Dings()
    {
        return "Flugzeug Dings";
    }
}

class Motorflugzeug : Flugzeug, ILuftfahrzeug
{
    public override void Starten()
    {
        Console.WriteLine("Das Motorflugzeug startet, "+Dings());
    }

    protected override string Dings()
    {
        return "Motorflugzeug Dings";
    }
} 
```

一般来说，永远不要`new`在方法上使用。它几乎从不做你想做的事。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-03T20:04:33.300

我赞同 Freddy Rios 关于虚拟关键字的观点。除非您的基类使用 virtual 关键字声明方法，否则根本不会出现多态行为。无论您使用覆盖还是新的都没有关系。

# php - PHP&MySQL：是否可以在运行 mysql_query 并插入以获取新行的 ID 后？

> ID：607850
> 
> 赞同：1
> 
> 时间：2009-03-03T19:49:00.933
> 
> 标签：php, mysql, insert-query

有没有一种直接的方法来运行 mysql_query 并获取新行的 ID，例如在返回中？或者我是否必须使用 select 进行另一个查询来检查它？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-03T19:51:25.687

mysql_insert_id()

或者

选择 last_insert_id()

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T19:51:45.530

运行 mysql_query 后只需调用[mysql_insert_id即可获得 ID。](http://us2.php.net/mysql_insert_id)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-03T19:52:01.300

尝试[mysql_insert _id()](http://us.php.net/manual/en/function.mysql-insert-id.php)

# apache-flex - 如何引用可编辑 ComboBox 的 TextInput？

> ID：607854
> 
> 赞同：0
> 
> 时间：2009-03-03T19:49:25.817
> 
> 标签：apache-flex, actionscript, combobox, editor, textinput

我有一个可编辑的 ComboBox 组件，我想引用显示的 TextInput，以便以编程方式选择其中的文本。这在 TextInput 上非常简单：

```
private function selectNameText():void
{
    nameTextInput.selectionBeginIndex = 0;

    nameTextInput.selectionEndIndex = nameTextInput.text.length;
} 
```

但我找不到任何方法来访问可编辑组合框的 TextInput。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T20:21:42.680

*由于这个*原因，似乎没有必要引用 TextInput，因为默认情况下会选择文本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T15:10:23.223

我在使用 ComboBox 作为 DataGrid itemRenderer 时遇到了这个问题。如果您需要引用 TextInput，您可以覆盖 ComboBox 并创建一个返回受保护的 textInput 的 getter。在我的情况下，我需要防止 ComboBox 可编辑时发生的自动选择。查看 ComboBox，这发生在 updateDisplayList 期间，所以这应该可以解决问题：

```
package com.whatever.controls
{

import mx.controls.ComboBox;

public class EditableComboBox extends ComboBox
{

    public function EditableComboBox()
    {
        super();
    }

    override protected function updateDisplayList(unscaledWidth:Number, unscaledHeight:Number):void
    {
        super.updateDisplayList(unscaledWidth, unscaledHeight);

        if (editable)
        {
            textInput.selectionBeginIndex   = text.length;
            textInput.selectionEndIndex     = text.length;
        }
    }

}
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-23T14:18:48.043

在 Combobox 的“创建完成”事件期间，您可以直接获取组件：

```
private function creationCompleteEvt ( evt:FlexEvent ) : void
{
    var targTextInput:UITextInput = UITextInput( myComboBox.getChildAt(2) );
    targTextInput.setSelection( 0, targTextInput.selectionEndIndex );
} 
```

# java - 你觉得 java.util.logging 足够了吗？

> ID：607863
> 
> 赞同：42
> 
> 时间：2009-03-03T19:51:37.417
> 
> 标签：java, logging, frameworks

根据标题，您是否发现默认的 Java 日志框架足以满足您的需求？

您是否使用其他日志服务，例如[log4j](http://logging.apache.org/log4j/)或其他？如果是这样，为什么？我想听听您对不同类型项目中的日志记录要求的任何建议，以及何时集成框架实际上是必要和/或有用的。

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2009-06-05T21:19:52.883

java.util.logging (jul) 从一开始就没有必要。忽略它。

jul 本身有以下缺点：

*   在 Java 1.4 中引入 jul 时，已经有一个广泛使用的完善的日志框架：LOG4J
*   预定义的日志级别为：SEVERE、WARNING、INFO、CONFIG、FINE、FINER、FINEST。我不会告诉你我个人对这些预定义级别的看法，以保持这个答案是半客观的。
*   可以定义其他级别。jul 最多支持 4G 不同的日志级别，恕我直言，这有点矫枉过正。少即是多。
*   最重要的一点：**如果你敢定义自己的日志级别，你很可能会遇到内存泄漏问题！**
    请随时在此处阅读有关此效果的信息：

    *   [类加载器泄漏：可怕的“java.lang.OutOfMemoryError: PermGen space”异常](http://blogs.oracle.com/fkieviet/entry/classloader_leaks_the_dreaded_java)
    *   [如何修复可怕的“java.lang.OutOfMemoryError: PermGen space”异常（类加载器泄漏）](http://blogs.oracle.com/fkieviet/entry/how_to_fix_the_dreaded)

    即使您不打算使用自定义级别，这也是一本非常有趣的书，顺便说一句，因为问题是一个广泛存在的问题，它根本不只适用于 jul。

*   它位于 java.* 命名空间中，因此无法在运行时交换实现。这有效地防止了将其桥接到 SLF4J，就像在 commons.logging 和 LOG4J 的情况下一样。为 jul 完成桥接的方式会对性能产生影响。这使得 jul 成为最不灵活的日志框架。
*   通过引入 jul，Sun 隐含地将其定义为“标准的 java 日志框架”。这导致了一个普遍的误解，即“优秀的 Java 公民”应该在他们的库或应用程序中使用 jul。
    **情况恰恰相反。**
    如果您使用 commons.logging 或 LOG4j，则可以通过桥接到 SLF4J 来交换实际使用的日志框架（如果需要）。这意味着使用 commons.logging、LOG4J 或 SLF4J 的库都可以记录到同一个记录目标，例如文件。

我个人建议将[SLF4J](http://slf4j.org/) + [Logback](http://logback.qos.ch/)组合用于所有日志记录目的。这两个项目都由 LOG4J 背后的人 Ceki Gülcü 协调。
SLF4J 是 commons.logging 的一个有价值的（但非官方的，因为它不是来自同一组）继任者。它比 CL 问题少，因为它静态地解决了实际使用的日志记录后端。此外，它具有比 CL 更丰富的 API。
另一方面，Logback 是 LOG4J 的（非）官方继任者。它本机实现 SLF4J，因此没有任何包装器造成的开销。

***现在***，如果您仍然认为我应得的，您可以否决我。;)

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-03-03T21:06:23.727

### 使用第三方库记录依赖关系

在大多数情况下，Java JDK 日志记录本身并不够。但是，如果您有一个使用多个开源第三方库的大型项目，您会很快发现其中许多具有不同的日志记录依赖项。

正是在这些情况下，从日志实现中抽象出日志 API 变得很重要。我建议使用[slf4j](http://www.slf4j.org/)或[logback](http://logback.qos.ch/)（使用 slf4j API）作为您的 API，如果您想坚持使用 Java JDK 日志记录，您仍然可以！Slf4j 可以毫无问题地输出到许多不同的记录器实现。

在最近的一个项目中发生了它有用的一个具体例子：我们需要使用需要 log4j 的第三方库，但我们不想并排运行两个日志框架，所以我们使用了 slf4j log4j api 包装器库和问题解决了。

总之，Java JDK 日志记录很好，但是从长远来看，我的第三方库中使用的标准化 API 可以节省您的时间。试想一下重构每个日志语句！

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-03-03T19:59:28.210

[SLF4J](http://www.slf4j.org/)是新来的。我已经用它做了一些工作，它非常好。它的主要优点是[参数化日志记录](http://www.slf4j.org/faq.html#logging_performance)，这意味着您可以这样做：

```
logger.debug("The new entry is {}. It replaces {}.", entry, oldEntry); 
```

而不是这样：

```
logger.debug("The new entry is " + entry + ". It replaces " + oldEntry + "."); 
```

并且只有在实际记录了语句时才完成所有字符串操作。看起来也更干净。

应该注意的是，SLF4J 是一个类似于 commons-logging 的包装器，尽管它声称不太容易出现 commons-logging 的类加载器问题。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2010-02-10T10:07:42.210

我们始终使用 java.util.logging。也适用于大型项目。您应该调整一些东西（例如默认格式），但这不是重点。我发现 Java 中日志记录框架的数量以及它们实现的功能蔓延对于 Java 社区来说相当烦人且有些尴尬。关于日志记录的宗教辩论的程度是一个明确的迹象，表明出现了严重错误。

JUL 为您提供的是一个简单但足够的 API 和一个配置您想要查看的日志输出的单一位置（logging.properties 或 JMX...）。而且它始终存在且稳定。

所有想要记录的代码都应该遵守标准约定（默认级别是 INFO），否则不要做更多，而是使用有意义的名称（例如包或类名）的记录器，你会没事的。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-03-03T20:03:19.557

除非有令人信服的理由使用 JDK 之外的东西，否则我更喜欢使用 Sun 提供的东西。

许多使用 Log4J 日志记录的项目在“标准”日志记录 API 存在之前就使用它。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-11-06T11:34:43.217

JDK 日志记录工具**一直**在做我需要他们做的事情——从来没有遇到过问题。

对我来说，第三方日志工具既没必要也不可取。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-03-03T20:22:01.277

我无法弄清楚如何控制 java.util.logging 框架中各个类的日志记录级别，这在 log4j 中是可能的。如果我在诊断错误时遇到问题，或者有一个记录重要信息的高流量类，我可以更改单个类的级别以记录更多信息，并使我的其余类相对安静。

注意 可能是我不知道该怎么做，或者 java.util.logging 可能在我尝试后发生了变化。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-03T21:41:21.507

java.util.logging 很好，但没有默认从类路径中获取的配置。这对我们来说是一个痛点，因为我们有许多不共享日志配置的部署，而且在 7 月这样做相当麻烦

Log4j 目前没有得到太多开发，所以如果需要在后端部分进行开发，logback 在我看来是目前最具活力的选择。

（警告：参与了 slf4j 和 logback 的一些晦涩的开发，但这是由于而不是导致我在上面所做的陈述:)）

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-03T19:54:34.633

我们将[log4j](http://logging.apache.org/log4j/)与[commons logging](http://commons.apache.org/logging/)一起使用。我认为我们只是使用它们，因为其他人都这样做。在 jdk 支持日志记录之前，我们使用的是 log4j。

编辑：仅仅因为其他人都在开玩笑，但这可能是我开始使用 log4j 和 commons 日志记录的原因。

[以下是使用公共日志记录的一些原因。](http://wiki.apache.org/commons/Logging/FrequentlyAskedQuestions)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-03T20:00:03.963

我想我会使用 log4j - 正如@ScArcher2 所提到的，只是因为每个人都这样做。但是在处理了这两个选项之后，我发现 java.util.logging 足以满足我的大部分需求——而且我说的是一个庞大的系统，其中有许多分散的组件一起工作。

因此，在我看来，没有必要使用替代服务。Java.util.logging 对于大多数情况来说已经足够强大了。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-03-03T22:14:46.340

`j.u.l` `LogManager`编写一个将所有日志记录推迟到使用 Log4J 的定制实现的类非常容易。这意味着您可以使用 log4j，但仍然有一个不错的功能，即使用 jul 记录的库可以像使用 Log4J 一样进行控制。

在使用了两者（和公共日志记录）之后，我不得不说，*真正让我***非常**恼火的是：

```
log4j.error("An Exception", e);

jul.severe("An Exception", e); // GRRR! no such method

jul.log(Level.SEVERE, "An Exception", e); //Must use this method 
```

他们为什么做出这样的设计选择？为什么？另一件事是没有`PatternFormatter`附带的`j.u.l`- 你必须自己动手。

也就是说，我`j.u.l`从现在开始使用它是错误的，因为它减少了外部依赖并且使用起来不再复杂。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-03-03T23:33:16.010

在我从事的项目中，我们倾向于使用来自 Jakarta 的 commons-logging。这不是一个日志系统本身，而是能够包装一些最常见的记录器——log4j、java.util.logging 或其他。

这样，根据应用程序部署到的环境切换日志记录相对容易（开发人员可能希望在他的机器上使用 simplelog 或 java.util.logging，因为易于维护，而在 SIT 系统上，log4j可以部署所有应用程序的通用配置等）

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2010-08-09T01:29:01.633

这完全取决于您的日志记录要求。您看到的不仅仅是应用程序开发人员使用的 API，而且坦率地说，这是最不重要的问题，因为无论您做出哪种选择，大部分日志 API 都很容易适应。

重要的部分是你需要什么样的日志配置来**操作**，他们应该告诉你他们需要什么。

1.  它可以像滚动的文本文件一样简单。
2.  它可能更复杂，例如记录到 JMS 或数据库。
3.  它可能需要单独的日志用于性能、审计等。
4.  发生日志事件时可能需要电子邮件详细信息。

他们的 varia 包中的 Log4J 已经支持这些以及更多，并使用他们的 API 进行了测试。现在使用 java.util.logging 您应该可以下载它们，但它们不像 Log4J 那样广为人知，而且可能更难找到相关信息。

要考虑的另一件事是您正在使用的供应商 API。大多数供应商为您“强制”使用日志记录 API。Spring 就是其中之一，它需要公共日志记录。

作为一名开发人员，如果可以的话，我会尝试将 java.util.logging 用于我自己的东西，但在现实世界的场景中，你必须改变他们在操作中需要的东西，并让它驱动你的选择，因为**他们**拥有在应用程序上线时使用这些日志。既不是应用程序架构师也不是开发人员应该做出选择，尽管他们应该提出建议。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2012-01-25T08:18:48.260

在这个线程中没有人提到的一件事 - java.util.logging 不支持开箱即用的 syslog。这对我来说是一个交易破坏者，（这让我有点惊慌，不得不重构 java.util.logging 的东西来代替更多的果汁。

这是我今天遇到的：

*   [http://logging.apache.org/log4j/1.2/](http://logging.apache.org/log4j/1.2/) - 唯一的，虽然它似乎有点老化..

*   [http://slf4j.org/](http://slf4j.org/) - 试图夺取 log4j 的王冠，它看起来有一些桥接/重定向行为.. 它可能适合直接替换，但我找不到任何明确的例子。我应该花更多的时间在这个上。

*   [http://syslog4j.org/](http://syslog4j.org/) - 它是系统日志，但没有替代品（似乎什么都没有，java 人不是很多系统日志吗？）

*   [http://people.apache.org/~psmith/logging.apache.org/sandbox/jul-log4j-bridge/apidocs/org/apache/logging/julbridge/JULLog4jBridge.html](http://people.apache.org/~psmith/logging.apache.org/sandbox/jul-log4j-bridge/apidocs/org/apache/logging/julbridge/JULLog4jBridge.html) - jul-log4j-bridge 宣传它是一个替换掉，看起来很有前途，而且占地面积小。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-03-03T20:45:20.830

我对所有日志框架的一个问题是，除非您团队中的每个人都花时间精通如何设置和控制它，否则您永远不知道给定的调试语句是否会打印出来。

您可能关闭了一个级别（调试），或者您可能关闭了一个包。

我已经浪费了太多时间假设调试语句会打印而它不会。现在我主要依赖 System.out.println() 并在完成调试时通过并删除或转换它们。

我知道这并不能回答你的问题——我只是说你可能想在增加复杂性之前考虑你有多少理由。

日志记录并不复杂，并且在大多数大型项目中肯定是合理的。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-03-03T20:47:40.450

我个人使用[Simple Logger](https://simple-log.dev.java.net/ "简单记录器")，但在工作中我使用我们的公司包装器到 JDK 记录器。我使用 Simple Logger，因为它易于设置，而且它支持在 Fatal 和 Ludicrous 之间记录 7 个级别。

* * *

## 回答 #17

> 赞同：-4
> 
> 时间：2010-01-04T10:14:52.747

如果您需要登录您的应用程序，那么您可能做错了什么。我认为报告偶尔出现的问题是可以的，但是在许多具有逻辑的类中使用调试、信息等语句是完全错误的。任何大型应用程序在其大多数逻辑填充类中都有记录语句，即使选择了正确的记录器，也将导致信息过载。大多数情况下，信息将不完整、嘈杂，或者您需要的实际信息明显缺失。

我基本上是说你应该只需要编写调试语句来通知用户程序对外部因素的反应

*   基于文本的配置文件中的格式化问题。
*   打开或查找所需文件时出现问题。

# c++ - 在调整大小时禁用矢量填充值？C++

> ID：607864
> 
> 赞同：7
> 
> 时间：2009-03-03T19:51:41.207
> 
> 标签：c++, vector

我处于必须使用 ac 样式函数返回复制的 len 的情况。我决定我应该调整到最大值，然后调整到返回的长度[展开作为内存传递的向量的大小](https://stackoverflow.com/questions/605539/expand-size-of-vector-passed-as-memory)

我知道 resize 将值设置为 fillValue （总是 0？）。因此，每秒进行 60 次毫无意义的初始化（希望每次少于 mb）。有没有办法在调整大小时禁用启动？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-03T19:59:17.883

基本上没有。向量中的元素默认是在调整大小时构造的（对于整数，这会导致 0）。

假设您使用 reserve() 来确保 resize() 不会分配内存，我不会担心这一点，除非后来证明这是一个性能问题。

如果您担心，您可能希望考虑仅使用常规数组并将项目计数存储在单独的变量中。这将为您提供最佳性能。

**更新：**

约翰问：

> 构造函数真的保证将内存归零吗？我以为那是未定义的？

是和不是。原始类型（int、bool、float 等）确实具有将它们初始化为零的默认构造函数。然而，与常规类或结构不同，编译器不会自动调用它们。

例如

```
int a;         // uninitialized
int b = int(); // initialized to 0 
```

因为 vector::resize 在添加项目时使用后一种形式，所以可以保证创建的元素将正确初始化为零。这适用于所有隐式创建元素的 STL 集合。

# c# - 关闭 NamedPipeServer#WaitForConnection 上阻塞的线程的好方法是什么？

> ID：607872
> 
> 赞同：44
> 
> 时间：2009-03-03T19:52:42.860
> 
> 标签：c#, .net-3.5, named-pipes

我启动了我的应用程序，它产生了许多线程，每个线程都创建一个 NamedPipeServer（.net 3.5 为命名管道 IPC 添加了托管类型）并等待客户端连接（块）。代码按预期运行。

```
private void StartNamedPipeServer()
  {
    using (NamedPipeServerStream pipeStream =
                    new NamedPipeServerStream(m_sPipeName, PipeDirection.InOut, m_iMaxInstancesToCreate, PipeTransmissionMode.Message, PipeOptions.None))
    {
      m_pipeServers.Add(pipeStream);
      while (!m_bShutdownRequested)
      {
        pipeStream.WaitForConnection();
        Console.WriteLine("Client connection received by {0}", Thread.CurrentThread.Name);
        .... 
```

现在我还需要一个 Shutdown 方法来彻底关闭这个过程。我尝试了通常的布尔标志 isShutdownRequested 技巧。但是管道流在 WaitForConnection() 调用上保持阻塞，并且线程不会死亡。

```
public void Stop()
{
   m_bShutdownRequested = true;
   for (int i = 0; i < m_iMaxInstancesToCreate; i++)
   {
     Thread t = m_serverThreads[i];
     NamedPipeServerStream pipeStream = m_pipeServers[i];
     if (pipeStream != null)
     {
       if (pipeStream.IsConnected)
          pipeStream.Disconnect();
       pipeStream.Close();
       pipeStream.Dispose();
     }

     Console.Write("Shutting down {0} ...", t.Name);
     t.Join();
     Console.WriteLine(" done!");
   }
} 
```

加入永不返回。

我没有尝试但可能可行的一个选项是调用 Thread.Abort 并吃掉异常。但这感觉不对..任何建议

**更新 2009-12-22**
很抱歉没有早点发布。这是我收到的来自 Kim Hamilton（BCL 团队）的回复

> 进行可中断的 WaitForConnection 的“正确”方式是调用 BeginWaitForConnection，在回调中处理新连接，然后关闭管道流以停止等待连接。如果管道关闭，EndWaitForConnection 将抛出 ObjectDisposedException 回调线程可以捕获，清理任何松散的末端，并干净地退出。
> 
> 我们意识到这一定是一个常见问题，所以我团队中的某个人计划很快在博客上讨论这个问题。

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2009-07-28T02:36:32.783

这很俗气，但这是我工作的唯一方法。创建一个“假”客户端并连接到您的命名管道以通过 WaitForConnection。每次都有效。

此外，即使 Thread.Abort() 也没有为我解决这个问题。

* * *

```
_pipeserver.Dispose();
_pipeserver = null;

using (NamedPipeClientStream npcs = new NamedPipeClientStream("pipename")) 
{
    npcs.Connect(100);
} 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-03-04T16:49:49.453

切换到异步版本：`BeginWaitForConnection`.

如果它确实完成了，您将需要一个标志，以便完成处理程序可以调用`EndWaitForConnection`吸收任何异常并退出（调用 End... 以确保能够清理任何资源）。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-05-07T15:57:18.763

您可以使用以下扩展方法。请注意包含“ManualResetEvent cancelEvent” - 您可以从另一个线程设置此事件以表示等待连接方法现在应该中止并关闭管道。在设置 m_bShutdownRequested 时包括 cancelEvent.Set() 并且关闭应该相对优雅。

```
 public static void WaitForConnectionEx(this NamedPipeServerStream stream, ManualResetEvent cancelEvent)
    {
        Exception e = null;
        AutoResetEvent connectEvent = new AutoResetEvent(false);
        stream.BeginWaitForConnection(ar =>
        {
            try
            {
                stream.EndWaitForConnection(ar);
            }
            catch (Exception er)
            {
                e = er;
            }
            connectEvent.Set();
        }, null);
        if (WaitHandle.WaitAny(new WaitHandle[] { connectEvent, cancelEvent }) == 1)
            stream.Close();
        if (e != null)
            throw e; // rethrow exception
    } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-09-08T11:41:43.790

我写了这个扩展方法来解决这个问题：

```
public static void WaitForConnectionEx(this NamedPipeServerStream stream)
{
    var evt = new AutoResetEvent(false);
    Exception e = null;
    stream.BeginWaitForConnection(ar => 
    {
        try
        {
            stream.EndWaitForConnection(ar);
        }
        catch (Exception er)
        {
            e = er;
        }
        evt.Set();
    }, null);
    evt.WaitOne();
    if (e != null)
        throw e; // rethrow exception
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-04-17T04:23:35.547

一个最简单的解决方案是创建一个虚拟客户端并与服务器建立连接。

```
NamedPipeServerStream pServer;
bool exit_flg=false;
    public void PipeServerWaiter()
{

    NamedPipeServerStream  pipeServer = new NamedPipeServerStream("DphPipe", PipeDirection.InOut, NamedPipeServerStream.MaxAllowedServerInstances);
    pServer = pipeServer;
    pipeServer.WaitForConnection();

    if (exit_flg) return;
    thread = new Thread(PipeServerWaiter);
    thread.Start();

}
public void Dispose()
{
    try
    {
        exit_flg = true;
        NamedPipeClientStream clt = new NamedPipeClientStream(".", "DphPipe");
        clt.Connect();
        clt.Close();

        pServer.Close();
        pServer.Dispose();

    } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-07-14T01:23:48.583

一种可行的方法是在 WaitForConnection 之后立即检查 m_bShutdownRequested。

在关机过程中设置布尔值。之后向所有现有管道发送虚拟消息，以便它们打开连接并检查布尔值并干净地关闭。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2016-09-07T11:11:05.030

```
using System;
using System.Collections.Generic;
using System.IO;
using System.IO.Pipes;
using System.Threading;
using System.Windows;
using System.Windows.Controls;

namespace PIPESERVER
{
    public partial class PWIN : UserControl
   {
    public string msg = "", cmd = "", text = "";
    public NamedPipeServerStream pipe;
    public NamedPipeClientStream dummyclient;
    public string PipeName = "PIPE1";
    public static string status = "";
    private static int numThreads = 2;
    int threadId;
    int i;
    string[] word;
    char[] buffer;
    public StreamString ss;

    public bool ConnectDummyClient()
    {
        new Thread(() =>
        {
            dummyclient = new NamedPipeClientStream(".", "PIPE1");
            try
            {
                dummyclient.Connect(5000); // 5 second timeout
            }
            catch (Exception e)
            {
                Act.m.md.AMsg(e.Message); // Display error msg
                Act.m.console.PipeButton.IsChecked = false;
            }
        }).Start();
        return true;
    }

    public bool RaisePipe()
    {
        TextBlock tb = Act.m.tb;
        try
        {
            pipe = new NamedPipeServerStream("PIPE1", PipeDirection.InOut, numThreads);
            threadId = Thread.CurrentThread.ManagedThreadId;
            pipe.WaitForConnection();
            Act.m.md.Msg("Pipe Raised");
            return true;
        }
        catch (Exception e)
        {
            string err = e.Message;
            tb.Inlines.Add(new Run("Pipe Failed to Init on Server Side"));
            tb.Inlines.Add(new LineBreak());
            return false;
        }
    }

    public void ServerWaitForMessages()
    {
        new Thread(() =>
        {
            cmd = "";
            ss = new StreamString(pipe);
            while (cmd != "CLOSE")
            {
                try
                {
                    buffer = new char[256];
                    text = "";
                    msg = ss.ReadString().ToUpper();
                    word = msg.Split(' ');
                    cmd = word[0].ToUpper();
                    for (i = 1; i < word.Length; i++) text += word[i] + " ";
                    switch (cmd)
                    {
                        case "AUTHENTICATE": ss.WriteString("I am PIPE1 server"); break;
                        case "SOMEPIPEREQUEST":ss.WriteString(doSomePipeRequestReturningString()):break;
                        case "CLOSE": ss.WriteString("CLOSE");// reply to client
                            Thread.Sleep(1000);// wait for client to pick-up shutdown message
                            pipe.Close();
                            Act.m.md.Msg("Server Shutdown ok"); // Server side message
                            break;
                    }
                }
                catch (IOException iox)
                {
                    string error = iox.Message;
                    Act.m.md.Msg(error);
                    break;
                }
            }
        }).Start();
    }

    public void DummyClientCloseServerRequest()
    {
        StreamString ss = new StreamString(dummyclient);
        ss.WriteString("CLOSE");
        ss.ReadString();
    } 
```

//用法，将 ToggleButtons 放在 StackPanel 中，然后在代码中支持它们：

```
private void PipeButton_Checked(object sender, RoutedEventArgs e)
    {
        Act.m.pwin.ConnectDummyClient();
        Act.m.pwin.RaisePipe();
    }
private void PipeButton_Unchecked(object sender, RoutedEventArgs e)
    {
        Act.m.pwin.DummyClientCloseServerRequest();
        Act.m.console.WaitButton.IsChecked = false;
        Keyboard.Focus(Act.m.md.tb1);
    }
private void WaitButton_Checked(object sender, RoutedEventArgs e)
    {
        Act.m.pwin.Wait();
    }
private void WaitButton_Unchecked(object sender, RoutedEventArgs e)
    {
    } 
```

//对我来说就像一个魅力。尊敬的，zzzbc }

# ruby-on-rails - Ruby on Rails 高级 JSON 序列化

> ID：607873
> 
> 赞同：18
> 
> 时间：2009-03-03T19:52:48.053
> 
> 标签：ruby-on-rails, ruby, json, serialization, xml-serialization

我希望在我的 rails 应用程序中通过 JSON 呈现所有文章的索引以及一篇完整的文章，但我在弄清楚如何做到这一点时遇到了一些麻烦。

这是我现在的控制器：

```
if params[:id]
    @article = Article.find(params[:id])
else
    @article = Article.published.not_draft.by_recent.first
end

respond_to do |format|

format.js { render :json => @article.to_json(
:except => [ :created_at, :updated_at, :draft, :id, :publish ], 
:include => {
    :comments => {
        :only => [:body]
    }
}),
:callback => params[:callback]}
end 
```

我想在响应中做的是添加所有文章的索引，如下所示：

```
@index = Article.find(:all, :select => 'id, title') 
```

我能够做到的唯一方法是将索引和文章都放入哈希或数组中，然后将其放入 JSON。

```
@response = { :item => @article, :index => @index } 
```

两者的完整代码：

```
@index = Article.find(:all, :select => 'id, title')

if params[:id]
    @article = Article.find(params[:id])
else
    @article = Article.published.not_draft.by_recent.first
end

@response = { :item => @article, :index => @index }

respond_to do |format|

format.js { render :json => @response.to_json(), :callback => params[:callback]}

end 
```

这很好，但现在我无法指定`:include`或`:except`让它正确渲染。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2010-08-15T02:16:06.037

您在问题中暗示了解决方案。您很可能希望构建一个散列以呈现为 JSON。现在最好的方法是为 as_json 方法提供一个实现。as_json 通过构建包含您希望编码的数据的哈希来提供自定义 to_json 输出的正式方法。

可以在[Jonathan Julian 的博客](http://jonathanjulian.com/2010/04/rails-to_json-or-as_json/)上找到有关 as_json 和 to_json 如何交互的更彻底的处理。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-04T02:43:10.500

为了清楚起见，上面的代码与 :include 和 :except 一起使用。通过作品，我的意思是它不会引发错误。问题是它包含索引中每篇文章的评论。我只想包含对 :item 的评论，而不是索引中列出的任何文章。

我无法将嵌套用作哈希或 OpenStruct 对象。

嵌套在 :include 上会引发错误，嵌套在 :except 上不会引发错误，但没有任何内容被过滤掉，:created_at 等仍然会出现。

```
...

@response = { :item => @article, :index => @index }

format.js { render :json => @response.to_json(
:except => {:item => [ :created_at, :updated_at, :draft, :id, :publish ]}, 
:include => { :item => {
        :comments => {
                :only => [:body]
        }
}}),
:callback => params[:callback]}
end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-08-10T02:01:48.227

to_json 有一个 :method 选项，其中包括您命名的任何方法的结果，您可以在该模型上定义一个方法，该方法返回您想要的 JSON 中的其他数据。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-03T20:22:23.973

您应该能够像这样嵌套`:include`,`:except`等：

```
:except => {:item => [ :created_at, :updated_at, :draft, :id, :publish ]}... 
```

如果这不起作用，请将其设为对象（例如 OpenStruct）而不是散列。

——马库斯

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-06-28T14:41:36.170

（请采纳答案）

我认为 nirvdrum 提供的链接包含您的答案。我只回答，因为没有人提到`encode_json`。

在您的情况下，您应该只处理`as_json`. 通过构建一个哈希（通过各种调用`as_json`）并将其发送到`render :json => ...`（不调用`to_json`），或者通过简单地`as_json`在您的模型上实现并让 rails 完成所有工作。（但我怀疑你需要前者。）

如果您在呈现的响应中确实需要一些花哨的 js，那么您可以`encode_json`在您的类中实现（同样，不是`to_json`）。例如：

```
class JsEmptyClosure
  def encode_json(*args)
    "jQuery[\"noop\"] || function(){}"
  end
  def as_json(*args) self end
end 
```

这现在将使用有效的 js 进行响应`to_json`（但请注意，它实际上不是 json）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-28T03:58:26.990

感谢您的提问，我可以为具有多个关联的模型自定义我的 json 格式。

> 渲染 json：@posts.to_json(
> 
> :except => [ :created_at, :updated_at, :user_id ],
> 
> :include => {
> 
> :user => {:only => [:email, :phone]},
> 
> :location => {:only => [:title, :lat, :lon, :street, :city, :state, :zipcode]},
> 
> :uploads => {:only => [:image]}
> 
> }
> )

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-07-10T15:19:15.273

我建议重载 attributes 方法以返回将在 to_json 输出中自动使用的备用哈希。

```
class Article
   def attributes
     { ... } # define your hash that you want to return at the '...'
   end
end 
```

对我来说，这似乎比直接使用 to_json 简单得多。

# delphi - Indy HTTP：读取 403 上的响应内容

> ID：607876
> 
> 赞同：6
> 
> 时间：2009-03-03T19:52:51.470
> 
> 标签：delphi, http, indy

我在使用带有 Google 联系人 API 的 Indy HTTP（在 Delphi 中）时遇到问题。

请参考下页的“ClientLogin Response”部分：

[http://code.google.com/apis/accounts/docs/AuthForInstalledApps.html](http://code.google.com/apis/accounts/docs/AuthForInstalledApps.html)

当身份验证不正确或发生错误时，服务器返回 403 ......正如预期的那样。但是，根据该文档，响应内容中有客户端需要的信息，例如错误原因和验证码 URL 等。

问题是 Indy IdHTTP 组件在 403 上抛出异常，响应内容为空。到目前为止，我还没有找到获取此内容的方法。我已经尝试将对 Post 的调用包装在尝试中...除了读取响应流之外，但它在 403 上始终为空。

我该怎么做呢？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-03T20:34:42.617

我找到了解决方案。看起来内容存储在 EIdHTTPProtocolException 的 ErrorMessage 字段中。

```
try 
   http.Post('https://www.google.com/accounts/ClientLogin', slReq);
except
   on E: EIdHTTPProtocolException do
      Memo1.Lines.Add(E.ErrorMessage);
end; 
```

似乎可以解决问题。

（顺便说一句，我使用的是 Indy 9。我确信 Indy 10 是相似的。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-03T20:14:18.097

你说的对。似乎在`TIdHTTPProtocol.ProcessResponse`响应中被读取但之后被丢弃。（甚至没有设置为零）

但是应该很容易适应将`CheckException`响应写入的函数`IdHTTP.Response.ContentStream`

也许您可以提交错误报告或功能请求。

# file-io - 在单行逗号分隔文件中求和值

> ID：607879
> 
> 赞同：3
> 
> 时间：2009-03-03T19:53:10.097
> 
> 标签：file-io, language-agnostic, sum

***编辑：****谢谢大家。Python 解决方案运行速度极快 :)*

我有一个看起来像这样的文件：

```
132,658,165,3216,8,798,651 
```

但它要**大得多**（~ 600 kB）。没有换行符，除了文件末尾的换行符。

现在，我必须总结所有存在的值。我希望最终的结果会很大，但如果我用 C++ 总结它，我拥有一个 bignum 库，所以它应该不是问题。

我应该怎么做，用什么语言/程序？C++、Python、Bash？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-03T20:08:15.007

## 企鹅赛德，“Awk”

```
sed -e 's/,/\n/g' tmp.txt | awk 'BEGIN {total=0} {total += $1} END {print total}' 
```

## 假设

*   你的文件是 tmp.txt （你可以很明显地编辑它）
*   awk 可以处理这么大的数字

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-03T20:14:31.573

Python

```
sum(map(int,open('file.dat').readline().split(','))) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T19:57:53.360

只要你有一个 bignum 库，语言并不重要。一个粗略的伪代码解决方案是：

```
str = ""
sum = 0
while input
    get character from input
    if character is not ','
        append character to back of str
    else
        convert str to number
        add number to sum
        str = ""
output sum 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-03T19:59:06.573

如果所有数字都小于 (2**64)/600000（仍然有 14 位数字），那么像 C 中的“long long”这样的 8 字节数据类型就足够了。该程序非常简单，使用您选择的语言。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-03T20:00:43.153

由于将大量输入作为一个整体处理很昂贵，我建议你看看[这篇](https://stackoverflow.com/questions/568968/does-any-one-know-of-a-faster-method-to-do-string-split/568983#568983)文章。它解释了如何编写用于字符串拆分的生成器。它在 C# 中，但非常适合处理这种输入。

如果您担心总和不适合整数（例如 32 位），您可以轻松实现自己的 bignum，特别是如果您只使用整数和加法。只需将第 31 位带到下一个 dword 并继续添加。

如果精度不重要，只需将结果累加为双精度即可。那应该给你足够的范围。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-03T20:09:14.223

[http://www.koders.com/csharp/fid881E3E70CC37E480545A0C37C98BC8C208B06723.aspx?s=datatable#L12](http://www.koders.com/csharp/fid881E3E70CC37E480545A0C37C98BC8C208B06723.aspx?s=datatable#L12)

一个快速的 C# CSV 解析器。我已经看到它很快就处理了几千个 1MB 的文件，我让它作为每月消耗大约 6000 个文件的服务的一部分运行。

无需重新发明一个快轮。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-03-03T19:59:54.480

python可以处理大整数。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-03-03T20:08:32.243

```
tr "," "\n" < file | any old script for summing 
```

Ruby 很方便，因为它会自动处理大数字。我不记得 Awk 做了任意精度算术，但如果是这样，你可以使用

```
awk 'BEGIN {RS="," ; sum = 0 }
     {sum += $1 }
     END { print sum }' < file 
```

# apache-flex - 打印可变高度的 Flex DataGrid

> ID：607902
> 
> 赞同：0
> 
> 时间：2009-03-03T19:58:58.087
> 
> 标签：apache-flex, printing

我有一份需要从我编写的 Flex 项目中打印的报告。报告需要如下所示：

```
 Header
 -----------
 text, more text

 .----------------------------.
 |Data Grid of Variable Height|
 |============================|
 |                            |
 |                            | 
 |~~~~~~~~~~~~~~~~~~~~~~~~~~~~|
  Possible Page Break
 .~~~~~~~~~~~~~~~~~~~~~~~~~~~~.
 |                            | 
 |                            |
 |____________________________|

 Fixed height chart

 Lots more text
 End 
```

我花了大约 16 个小时试图让这个工作。我发现的每个示例都有一个 PrintDataGrid 其容器的固定高度为 100%，然后执行一些非常冗长的代码以将其跨越到多个页面。有没有人得到这样的工作？我正在考虑制作一个 Web 服务来获取数据并将其返回为 Html，但我必须重新创建图表。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-03T21:32:46.800

你不能。甚至不要尝试在 flex 中打印。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-05T20:36:40.303

我不确定您所说的冗长是什么意思，但请查看[http://www.brucephillips.name/blog/index.cfm/2008/4/11/Flex--Printing-A-DataGrid-上的伪代码和实现That-Spans-Multiple-Printed-Pages](http://www.brucephillips.name/blog/index.cfm/2008/4/11/Flex--Printing-A-DataGrid-That-Spans-Multiple-Printed-Pages)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-03-22T16:13:43.803

嗨，跨一个网站可能对这个问题很感兴趣：[使用 FlexReport 打印多个页面](http://flextutorial.org/2009/06/02/printing-multiple-pages-using-flexreport/)

希望它会有所帮助

# php - PHP：在服务之前重新解析整个页面？

> ID：607911
> 
> 赞同：1
> 
> 时间：2009-03-03T20:00:03.683
> 
> 标签：php, parsing, php4

在一个页面的末尾，如果有什么事情发生了，就需要清除它，然后整个页面需要重新解析，然后再提供给客户端。我打算回显一个 javascript 来刷新页面，但这会让他们加载页面然后重新加载它......我想知道是否有一种方法可以告诉 php 引擎回到开头并重新-解析整个页面？

谢谢！

我会尝试更清楚地解释这个问题，但它很复杂，而且我是一个糟糕的沟通者。我在列出产品的页面上为用户提供了选择字段以缩小结果的选项。系统会记住这一点，因此他们不必一直选择它们。如果他们缩小了金属颜色之类的类别，然后转到与金属颜色无关的类别，例如水晶雕像，它将不会显示任何结果，因为没有一个与所选金属颜色相匹配。生成查询以从数据库中提取产品非常复杂，因为不同的类别对找到正确的产品有不同的要求。因此，一旦生成查询，我想针对 mysql_num_rows() 对其进行测试，如果没有结果，请清除用户的选择并重新开始。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-03T20:03:58.993

你有点含糊，但如果你只是在谈论重新解析输出，你可以使用[output buffering](http://us.php.net/outcontrol)来做到这一点。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-03T20:04:31.910

我不完全清楚问题是什么，但你不能在创建 HTML 之前决定要显示什么，然后第一次发送正确的东西吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T20:07:06.087

输出缓冲（ob_start 和 ob_clean），结合将手头的功能分离到一个单独的文件和 eval()'ing 应该可以解决问题。

哦，最近的 PHP 版本实际上有一个*goto*声明......虽然我总是否认提及它。:-)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-03T20:30:57.433

> 生成查询以从数据库中提取产品非常复杂，因为不同的类别对找到正确的产品有不同的要求。因此，一旦生成查询，我想对其进行测试`mysql_num_rows()`，如果没有结果，请清除用户的选择并重新开始。

在这种情况下，只需将查询放在返回结果的函数中，检查行数，如果为零则清除过滤器并再次调用该函数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-03T20:12:50.407

我觉得你有点过头了。

重新解析页面应该做的是将用户再次重定向到页面，使用

```
header('Location: thepagefile.php'); 
```

但是，如果您真的想在不创建新页面的情况下重新解析文件，您也可以再次包含该文件：

包括页面文件.php

但你可能会得到相同的结果。如果您想实际**解析**页面的输出，您可以执行以下操作：

```
ob_start(); // this is at the very top of the code/page
// all the code goes here
$output = ob_get_clean();
eval($output); // WTF? 
```

但这实际上没有任何意义，但我希望它有所帮助。

我实际上想知道您要解决的真正问题是什么。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-03T20:31:19.177

我认为您正在寻找这样的东西：

```
<?php
ob_start(); //we start output buffering, this means nothing is send to the browser
//We do some code stuff
$time = microtime();
echo "Hai \n"; //Note taht mixing logic and output in real life
echo $time;  // is terribly practice
echo "\n bai"; //I do it here purely for the example
if(/*some condition */){
 $anErrorHappened = true;
}
if($anEroorHappened === true){
  //Load the output in a var if you need it
  //Otherwise don't
  $output = ob_get_clean();
  //Do other code stuff
  //I.E. send an error page
  include('errorPage.html');
}
else{
 ob_end_flush(); //Send everything the script has echo()'d, print()'ed and send to the browser in any other way (I.E. readfile(), header() etc.)
}
?> 
```

# asp.net - DropDownList SelectedIndex 值未在 AutoPostback 上更新

> ID：607918
> 
> 赞同：6
> 
> 时间：2009-03-03T20:02:43.833
> 
> 标签：asp.net, vb.net, linq, autopostback

看起来这个问题[在这里得到了解决](https://stackoverflow.com/questions/312735/dropdownlist-selectedindex-always-0-yes-i-do-have-ispostback)，但他的解决方案对我不起作用。我正在创建一个动态下拉菜单系统，该系统根据第一个下拉列表中的所选项目使用查询结果填充辅助下拉列表。

第一个下拉列表被填充：

```
Dim db As New linqclassesDataContext
Dim categories = (From c In db.faq_cats)

NewFaqDropDownCategory.DataSource = categories
NewFaqDropDownCategory.DataTextField = "category"
NewFaqDropDownCategory.DataValueField = "category_id"
NewFaqDropDownCategory.DataBind()
Unset(categories)
Unset(db) 
```

第二个下拉列表被填充：

```
Protected Sub NewFaqDropDownCategory_SelectedIndexChanged(ByVal sender As Object, ByVal e As System.EventArgs)
    Dim temp As Integer = CInt(Val(NewFaqDropDownCategory.SelectedIndex))
    MsgBox(theDrop.SelectedValue)
    Return

    'Dim db As New linqclassesDataContext
    'Dim faqs = (From f In db.faqs Where f.category = NewFaqDropDownCategory.SelectedValue)

    'NewFaqDropDownList.DataSource = faqs
    'NewFaqDropDownList.DataTextField = "question"
    'NewFaqDropDownList.DataValueField = "id"
    'NewFaqDropDownList.DataBind()
    'NewFaqLabel.Visible = True
    'NewFaqDropDownList.Visible = True
    'Unset(faqs)
    'Unset(db)
End Sub 
```

第一个下拉菜单的标记...

```
<asp:DropDownList ID="NewFaqDropDownCategory" AutoPostBack="true" runat="server" OnSelectedIndexChanged="NewFaqDropDownCategory_SelectedIndexChanged">
</asp:DropDownList> 
```

而第二...

```
<asp:DropDownList ID="NewFaqDropDownList" runat="server" Visible="false">
</asp:DropDownList> 
```

无论我尝试了什么，我总是得到“1”（第二个下拉列表中第一项的值）。我之前引用的帖子说这与 AutoPostBack 和服务器不知道列表已更新有关。

任何人都可以为我澄清一下吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-03T20:22:23.630

在以下行设置断点：NewFaqDropDownCategory.DataBind() 和事件处理程序中的一个 (NewFaqDropDownCategory_SelectedIndexChanged)。我怀疑在您的 NewFaqDropDownCategory_SelectedIndexChanged 事件触发之前调用了数据绑定，从而导致您选择的值发生更改。

如果是这样，您需要确保仅在您不在自动回发中间时进行数据绑定，或者在事件处理程序的第一行不使用 NewFaqDropDownCategory.SelectedIndex 您可以将 sender 参数转换为 DropDownList 并使用选定的值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-20T11:49:23.693

我有同样的问题。发现我忘记查看是否回发到页面，并且在页面事件中绑定了我的 DropDownList 控件`Page_Load`。我忘了使用：

```
if (!IsPostBack)
{
   .... do databind ....
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T20:21:35.583

我认为第二个下拉框的 LINQ 查询中有一个错误

```
Dim faqs = (From f In db.faqs Where f.category = NewFaqDropDownCategory.SelectedValue) 
```

在这里，您将 SelectedValue 与类别进行比较。然而，在第一个组合框中，您说 DataValueField 应该是 category_id。尝试将 f.category 更改为 f.category_id

# testing - 有什么方法可以访问 SilkTest 中的 cookie？

> ID：607926
> 
> 赞同：2
> 
> 时间：2009-03-03T20:05:00.457
> 
> 标签：testing, cookies, automation

我们正在使用 SilkTest 2008R2 测试 Web 应用程序，需要定期检查 cookie 的值。

我们目前通过 ExecLine 函数使用 javascript：

```
BrowserPage.ExecLine ("alert(document.cookie.split(';').join('/n'))", TRUE) 
```

然后只需从生成的弹出窗口中读取文本。

这有点容易出错。

有没有其他方法可以获取 SilkTest 中的 cookie？将是一种仅使用本机`SilkTest`功能的方法。

# svn - 使用 mod_wsgi 在 Apache 上部署 TRAC/Subversion (SVN) 时，TRAC 根本不打开任何页面

> ID：607931
> 
> 赞同：1
> 
> 时间：2009-03-03T20:06:43.777
> 
> 标签：svn, apache, trac, mod-wsgi, mod-python

我已经使用 apache/mod_wsgi（无 SSL）部署了 trac（最好，因为我面临的 CGI 问题是性能），并且它在没有 SVN 集成的情况下工作正常。但我实际上需要 SVN，所以当我配置存储库路径（即：repository_dir = c:/projects/svn/my_project）时，我什至无法让我的项目 TRAC 甚至打开它的任何页面。

在 Mozilla Firefox 上显示白页，在 MS-IE 上显示“无法显示页面”错误，就好像服务器“超时”一样。

我已经尝试使用 mod_python (3.3.1) 并且发生了完全相同的问题。虽然它适用于 CGI。

我也尝试过禁用 SVN 身份验证，认为这可能是身份验证冲突（我使用的是 Apache Basic Auth）。

**环境：**

*   赢 2000 服务器 SP 4；
*   阿帕奇 2.2.10；
*   蟒蛇2.5.2；
*   mod_wsgi 修订版 1018 2.3，py25_apache22；
*   跟踪 0.12dev;
*   颠覆 1.5.3。

**配置文件：**

*   Apache httpd.conf 摘录：

> ```
> WSGIScriptAlias /trac "c:/projects/apache/trac.wsgi"
> 
> <Directory c:/projects/apache>
>   WSGIApplicationGroup %{GLOBAL}
>   Order deny,allow
>   Allow from all
> </Directory> 
> ```

*   跟踪.wsgi：

> ```
> import sys
> sys.stdout = sys.stderr
> 
> import os
> os.environ['TRAC_ENV_PARENT_DIR'] = 'c:/projects/trac'
> os.environ['PYTHON_EGG_CACHE'] = 'c:/projects/eggs'
> 
> import trac.web.main
> 
> application = trac.web.main.dispatch_request 
> ```

*   trac.ini 摘录：

> ```
> repository_type = svn
> repository_dir = c:/projects/svn/my_project 
> ```

有任何想法吗？？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-04T21:17:58.497

**解决了！**

我已将 Apache 和 Python 使用的 SVN 的 dll 版本与此处可用的版本对齐：http://subversion.tigris.org/servlets/ProjectDocumentList?folderID [=](http://subversion.tigris.org/servlets/ProjectDocumentList?folderID=8100) 8100 还按照此处提到的 SVN 说明进行操作：[http:// trac.edgewall.org/wiki/TracInstall#VersionControlSystem](http://trac.edgewall.org/wiki/TracInstall#VersionControlSystem)

一步步：

1.  将我的 Subversion 更新到 v1.5.5，Apache 2.2.x 的 Win32 二进制文件（可在[http://subversion.tigris.org/files/documents/15/44589/svn-win32-1.5.5.zip](http://subversion.tigris.org/files/documents/15/44589/svn-win32-1.5.5.zip)获得）。

    1.  删除了我的旧颠覆并扩展了新的颠覆；
    2.  把新的放在系统路径上，这样Apache就可以看到SVN dll；
    3.  将“mod_dav_svn.so”和“mod_authz_svn.so”复制到 Apache 的模块目录。
2.  更新了 Win32 上 Subversion 的 Python 2.5 绑定（可在[http://subversion.tigris.org/files/documents/15/44591/svn-win32-1.5.5_py.zip](http://subversion.tigris.org/files/documents/15/44589/svn-win32-1.5.5.zip)获得）。

    1.  将文件从 '\libsvn' 复制到 'c:\Python25\Lib...\libsvn
    2.  按照说明将 libsvn/*.dll 文件重命名为 .pyd（因为 python 2.5 不再读取 dll）；
3.  更新了 Win32 的 Python 2.5 绑定安装程序（可在[http://subversion.tigris.org/files/documents/15/44597/svn-python-1.5.5.win32-py2.5.exe](http://subversion.tigris.org/files/documents/15/44597/svn-python-1.5.5.win32-py2.5.exe)获得）。

    1.  安装了“exe”；
4.  重新启动窗口。

只是为了记录……它并没有完全按照这个顺序发生，也不是和平发生的。我整天都在为不同的 .zips/.exes/.dlls/.sos 苦苦挣扎。因此，在放弃该解决方案之前，请务必在所有涉及的部分中对齐 SVN。

结果：它奏效了，我的 Trac/SVN 性能显着提高。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-05T17:56:58.720

实际上，在修改了我的 subversion 存储库后，我遇到了更多问题。它再次停止工作，行为相同。所以我尝试“重新同步”（因为有一条日志消息与缓存的不同版本有关）但什么也没有。

所以我卸载了所有东西并重新安装了它（包括Apache），按照上面的一步一步加：

*   在我的项目上运行重新同步（trac-admin c:\projects\myproject resync）；
*   从 'c:\Python25\Lib\site...\libsvn' 中删除由 'Python 2.5 bindings installer for Win32' 安装的 subversion 的 dll，并从 'c:\svn-win32-1.5.5\bin' 复制 subversion 的 dll 到 over它。

它有效（到目前为止）。

我会通知任何更改。

# java - 从子类获取数据而不实例化

> ID：607934
> 
> 赞同：2
> 
> 时间：2009-03-03T20:07:28.470
> 
> 标签：java

我有一个抽象超类和各种子类。每个子类都包含一个我想静态使用的值，但无法创建抽象静态方法。我想动态地从它们那里获取一个值，而不必创建实例。我该怎么办？

另一个问题是：我将如何遍历子类？有可能吗？

一次尝试涉及将类名（Subclass.class）映射到值并尝试在它们上使用 newInstance，以便我可以使用一种方法来获取值，但这不起作用。

我的方法哪里出错了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T20:15:37.080

为什么不另辟蹊径呢？将数据放在静态可访问的地方并让子类从那里获取数据？

当然，这样做的可行性取决于数据的性质，但是当您发现自己遇到这种障碍时，通常有助于退后一步并重新检查您的假设。

——马库斯

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T20:18:49.863

您可以通过反射引用静态成员/方法，但没有自动方法来查找类的所有子类。

考虑通过其他机制提供子类/实例工厂/元数据类，例如[ServiceLoader](http://java.sun.com/javase/6/docs/api/java/util/ServiceLoader.html)服务或其他一些插件框架。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T20:25:37.413

也许您正在寻找枚举？

```
public enum Planet
{
  MERCURY (2.4397e6),
  VENUS   (6.0518e6),
  EARTH   (6.37814e6);

  private final double radius;

  Planet(double radius)
  {
    this.radius = radius;
  }

  public double radius()
  {
    return radius;
  }
} 
```

您不必`enum`自己创建实例。枚举可以有值，例如`radius()`在示例中。您可以通过在它们上定义抽象方法来向它们添加行为，以便它们可以像普通类一样工作，例如

```
public enum Planet
{
  ...
  abstract double weightOnSurface(double weight);
  ...
} 
```

您可以遍历枚举，如下所示：

```
for (Planet p : Planet.values())
{
  System.out.println(p.radius());
} 
```

所以他们似乎符合你的所有标准。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T20:16:41.023

如果您有一组固定的子类，那么您可以将数据放在超类中。如果可以添加子类，则无法将它们全部列出。您可能会通过静态初始化程序让子类让超类知道它们的存在（或使用代理！）。

通常超类不应该知道它们的子类。但是，您可能想考虑（或更好地重构）您的超类为超类型和其他一些负责您的子类的类。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-03T20:17:48.447

您将需要扫描包和类以找到扩展您的超类的包 - 不幸的是，这不能通过反射 API 完成，而必须通过 URL（文件系统类、jar 文件等）完成。在这种情况下使用注释可能会更好，许多开源产品都使用这种方法（Hibernate 等）。

然后你可以在每个（一致的命名或注释）中都有一个静态方法，你应该能够调用它 as`method.invoke(MyObject.class, arguments)`

另一种选择是将注册表映射放在抽象类中 - 如果您需要强制它，抽象构造函数将获取静态值（或者如果需要计算，则只存储子类）。如果您要控制所有子类，只需确保每个子类中都有一个静态块以将其添加到注册表中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-03T22:30:29.437

映射子类......你可以通过反射来做到这一点（但它不会很有趣）。

newInstance() （可能）将不起作用，除非：

*   课程是公开的
*   构造函数是公开的
*   构造函数不带参数

最后一个是强制性的，另外两个取决于你从哪个包做事（我想，我已经有一段时间不在乎了）。使用 Constructor 类更好。

您能否给出一个简短的代码示例来说明您正在考虑做什么？基于此，我（和其他人）也许可以给你更好的答案。如果你确实需要做映射子类的事情，我可以挖掘一些代码来做这件事......

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-03T22:42:11.547

为每个子类创建代表该子类类型的第二个类可能会起作用。

例如，为每个子类（负责创建该子类的实例的类）创建一个工厂类。每个工厂类只需要一个实例。

然后，每个工厂类都可以负责了解您描述的特定于子类的数据。然后，您只需要遍历一组固定的工厂类。

# nhibernate - 使用 Fluent NHibernate 生成表索引

> ID：607935
> 
> 赞同：25
> 
> 时间：2009-03-03T20:08:03.820
> 
> 标签：nhibernate, fluent-nhibernate, nhibernate-mapping

是否可以使用 Fluent NHibernate 与数据库模式的其余部分一起生成表索引？我希望能够通过自动构建过程生成完整的数据库 DDL。

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2009-11-19T08:07:00.800

在 Fluent NHibernate 的最新版本中，您可以调用该`Index()`方法来执行此操作，而不是使用`SetAttribute`（不再存在）：

```
Map(x => x.Prop1).Index("idx__Prop1"); 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-03-03T20:24:02.783

您是指列上的索引吗？

您可以`ClassMap<...>`通过附加在文件中手动执行此操作`.SetAttribute("index", "nameOfMyIndex")`，例如：

```
Map(c => c.FirstName).SetAttribute("index", "idx__firstname"); 
```

或者您可以使用自动映射器的属性特征来做到这一点 - 例如像这样：

创建持久性模型后：

```
{
    var model = new AutoPersistenceModel
    {
        (...)
    }

    model.Conventions.ForAttribute<IndexedAttribute>(ApplyIndex);
}

void ApplyIndex(IndexedAttribute attr, IProperty info)
{
    info.SetAttribute("index", "idx__" + info.Property.Name");
} 
```

然后对您的实体执行此操作：

```
[Indexed]
public virtual string FirstName { get; set; } 
```

我喜欢后者。Is 是一个很好的折衷方案，既不干扰您的域模型，又对正在发生的事情非常有效和清晰。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-05-26T12:52:21.397

Mookid 的回答很好，对我帮助很大，但与此同时，不断发展的 Fluent NHibernate API 发生了变化。

因此，现在编写 mookid 示例的正确方法如下：

```
//...
model.ConventionDiscovery.Setup(s =>
            {
                s.Add<IndexedPropertyConvention>();
                //other conventions to add...
            }); 
```

其中 IndexedPropertyConvention 如下：

```
public class IndexedPropertyConvention : AttributePropertyConvention<IndexedAttribute>  
{
    protected override void Apply(IndexedAttribute attribute, IProperty target)
    {
         target.SetAttribute("index", "idx__" + target.Property.Name);
    }
} 
```

[Indexed] 属性现在的工作方式相同。

# c# - 通过 System.Net.Mail C# 发送邮件时出现问题

> ID：607941
> 
> 赞同：3
> 
> 时间：2009-03-03T20:09:36.750
> 
> 标签：c#, email, system.net.mail

这是我的邮件发送代码。我收到“邮件标题中有无效字符”错误。当我更改我的计算机名称时，一些最短的名称。问题解决了。但是在我的域中，整个计算机名称都像“04500-ab04545.xxxdomain.gov.tr”，所以我需要为这个问题找到另一个解决方案。

因此，从 c# 代码发送邮件时，我无法提供静态计算机名称。

```
 MailMessage msg = new MailMessage();
 msg.Body = "axxxxxx";
 msg.To.Add(new MailAddress("xxxx@xxxx.domain"));
 msg.From = new MailAddress("xxxx@xxxx.domain","blab blalb");
 msg.Subject = "Subject xxx";
 SmtpClient server = new SmtpClient("xxxxxxxx",25);
 server.Credentials = new NetworkCredential("xxxxx", "xxxxxxx");
 SmtpClient server = new SmtpClient("mail.adalet.gov.tr",25);
 server.Credentials = new NetworkCredential("xxx", "xxx");
 server.Send(msg); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-03T20:25:23.263

我怀疑这可能是与编码相关的问题。

尝试使用`new MailAddress("xxxx@xxxx.domain","blab blalb", Encoding.Default)`构造函数。

其他尝试`Encoding.Unicode`。

更新：

经过一番挖掘，此异常从以下位置抛出：

```
void System.Net.BufferBuilder.Append(string,int,int); 
```

如果您的电子邮件地址中有任何高于 \xff 的字符，就会发生这种情况。这不应该发生，因为名称应该已经被编码，但我猜其他的东西会很有趣。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T20:22:47.420

消息试图发送的标题是什么？

您可以使用此 MSDN 片段轻松转储：

```
string[] keys = message.Headers.AllKeys;
        Console.WriteLine("Headers");
        foreach (string s in keys)
        {
            Console.WriteLine("{0}:", s);
            Console.WriteLine("    {0}", message.Headers[s]); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-20T13:53:31.563

如果将其修改为“网络”，我会收到此错误 --- 然后错误得到解决。（我的理解是 - 如果指定pickingdirectory 选项，标头-encoding utf-8 (base64) 给出错误）

希望能帮助到你

# iphone - 在 iPhone 游戏中播放声音 - 减速

> ID：607942
> 
> 赞同：4
> 
> 时间：2009-03-03T20:09:47.967
> 
> 标签：iphone, cocoa-touch

我正在使用 AVAudioPlayer 在我的应用程序的单独线程上播放声音 FX。现在我的应用程序相当简单，我有一个 UIScrollView 用于滚动背景，还有几个 CALayer 代表一个简单的横向卷轴类型游戏中的玩家和敌人（想想马里奥或功夫之类的）......我可以左右移动播放器，视图可以适当滚动，没有问题。我有一个正在播放音效的“攻击”按钮……而且很多时候，当我播放音效时，我在图形上遇到了一点麻烦。这只是使用 Quartz 在 iPhone 上的课程吗？有没有什么方法可以在不开始研究 OpenGL 的情况下让它执行得更顺畅一些？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-04T00:20:59.377

使用 NSData dataWithContentsOfMappedFile 而不是 dataWithContentsOfFile。

AVAudioPlayer 也处理它自己的线程，你不需要创建一个。[AVAudioPlayer play] 开始播放后返回，而不是播放完毕后返回。

并且不要忘记在不再需要时释放 AVAudioPlayer，例如，如果您只想播放一次声音，请实现 audioPlayerDidFinishPlaying:successfully: 委托并在其中释放它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T20:13:13.560

你是如何播放声音的？如果我猜测一下，每次播放声音时，操作系统实际上都是从磁盘加载它并播放它。

**更新：**

好的，你真的不需要创建一个新线程来播放声音。仅此一项就可能导致游戏卡顿并且也是多余的 - AVAudioPlayer 播放方法是异步的 - 它会立即返回，而不是在声音结束时返回。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-19T22:07:20.020

我在减速方面遇到了同样的问题。为了解决这个问题，我首先在音量为 0 时播放并暂停声音——这比 prepareToPlay 效果更好，后者似乎仍然会导致速度变慢：

```
player.volume = 0.0;
[player play];
[player pause];
player.volume = 1.0; 
```

当需要播放声音时，我只是 [player play];。然后，每个更新周期我都会遍历所有活动声音并捕捉即将结束的声音并将它们倒回而不是让它们过期 - 这避免了从头开始声音的开销和减慢。此处的示例在声音结束后 1/15 秒处停止声音：

```
for ({each player in active sounds})
{
  if ((player.duration - player.currentTime) <= (1.0/15.0))
  {
    [player pause];
    player.currentTime = 0.0;
  }
} 
```

现在它已经准备好进行下一场比赛了。似乎工作正常！

**更新：**原来我在第一次播放声音时仍然有一些停顿。我认为以零音量播放实际上并没有做任何事情，但我将其更改为以 0.0001 音量播放然后暂停 - 它听不见，但似乎完成了声音准备工作。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-05-06T18:53:55.653

一开始也有同样的问题。根据文档，每次声音播放完毕时，您都需要调用“prepareToPlay”。采用 AVAudioPlayerDelegate 协议并添加以下方法即可。

```
-(void)audioPlayerDidFinishPlaying:(AVAudioPlayer *)player successfully:(BOOL)flag{
    [player prepareToPlay];
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-03T21:29:29.570

（使用答案而不是评论的长度，所以我可以显示代码）：

我的声音播放方法如下：

```
- (void)playSoundThreaded:(id)soundPlayer
{
  if(soundPlayer == nil)
    return;

  NSAutoreleasePool* pool = [[NSAutoreleasePool alloc] init];
  [(AVAudioPlayer*)soundPlayer play];
  [pool release];
}

- (void)playSound:(AVAudioPlayer*)player
{
  if(player == nil)
    return;

  [NSThread detachNewThreadSelector:@selector(playSoundThreaded:)
    toTarget:self withObject:(id)player];
} 
```

声音加载如下：

```
fxPlayer = [[AVAudioPlayer alloc] initWithData:
  [NSData dataWithContentsOfFile:
    [[NSBundle mainBundle] pathForResource:@"voicehiya" ofType:@"caf"]] error:NULL]; 
```

我们已经知道声音每次都从磁盘重新加载......但不知道为什么会这样或如何防止它。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-04T02:18:48.937

我认为线程过度复杂化你的播放器。试试这个：

```
/* setup the sound player */
AVAudioPlayer *player1=[[AVAudioPlayer alloc] initWithContentsOfURL:[NSURL     fileURLWithPath:audioFilePath] error:NULL];
player1.numberOfLoops = 0;
player1.volume=1.0f;
[player1 prepareToPlay]; 
```

然后 playSound 变成

```
[player play]; 
```

并且不要忘记正确设置 AudioSession 类别。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-19T22:23:21.337

为什么不直接使用 AudioServicesPlaySystemSound？这非常适合音效。

我在我的游戏 (vConqr) 中使用它，它也基于 UIScrollView，还有许多其他视图（所以都有自己的 CALayer），它不会显着影响性能。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-11-29T18:44:59.983

由于我正在工作的一个项目，我已经调查了几天。我在代码中添加了一些自制的分析，发现播放声音的调用导致了我的 OpenGL 游戏中的帧速率问题。根据我的发现，我为您提供了一些建议：

1.  使用 AVAudioPlayer 播放 mp3 作为背景音乐。

2.  将 OpenAL 用于您的音效。

3.  对于音效，请使用 Apple 的音频转换器命令行工具将您的声音转换为 .caf 格式。这是一种未压缩格式，不需要 CPU 在将声音发送到声卡之前将其解压缩到内存中。它可以直接去，节省您的时间。可以在[**此处**](http://developer.apple.com/library/ios/#documentation/AudioVideo/Conceptual/MultimediaPG/UsingAudio/UsingAudio.html)找到有关使用该工具的说明。（滚动到页面的最底部）

4.  使用听起来还不错的最低位深度。您实际上并不需要 128 kbps - 您可能在很多事情上都可以使用 20 kbps。较低的比特率 = 更少的处理 = 更快的声音。

如果我发现其他有用的东西，我会告诉你的！祝你好运！

# java - 在 Mac OS 上安装 Java 6

> ID：607945
> 
> 赞同：7
> 
> 时间：2009-03-03T20:10:30.540
> 
> 标签：java, macos, java-6

是否可以在 Mac OS 10.5 上安装最新的 JDK？考虑到 Apple 提供的版本是 1.5，最好的选择是什么？

**更新：**我正在尝试安装需要 JDK 6 的 JDeveloper 11。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-03T20:17:41.643

如果您有配备 Core 2 Duo 的 Intel Mac，请转到 Applications/Java 并运行 Java Preferences.app

您将能够选择“Java SE 6”作为您的默认 Java 版本（我猜为了兼容性，版本 5 仍然是操作系统的默认出厂设置）。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-03T20:15:22.447

根据您的硬件，Apple 提供的[最新版本](http://developer.apple.com/java/)实际上是 Java 6，但它并未作为默认版本激活。Apple 仅为 64 位 Intel Macs 提供 Java 6（即不为最初的 Core Duo Macs 提供）。对于较旧的 Mac，您可以尝试[Java 6 for Mac](http://landonf.bikemonkey.org/static/soylatte/) (SoyLatte) 的 OpenJDK 端口。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-09-04T20:43:44.380

Apple 为 Leopard (OS X 10.5) 提供 Java 6 (1.6) 作为更新，但仅提供 64 位版本。因此，如果您的 Mac 不是 64 位 Intel，那么 Leopard 上就不会有 Java 6。

如果您确实有 64 位 Intel，请确保安装最新的操作系统更新，尤其是 Java 更新，以确保您获得 Java 1.6。此外，您仍然需要在 Java Preferences 中将 Java 6 设置为默认 VM，因为它默认为 Java 1.5。

目前，如果您拥有 32 位 Intel 处理器，最简单的解决方案是升级到 Snow Leopard，其中包括 32 位和 64 位版本的 Java 6。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T20:16:42.677

[OS X](http://developer.apple.com/java/)在 Update 1 之后确实有 Java 6。您所指的版本号是**Java** 6 的版本。您在安装 JDeveloper 11 时是否收到任何错误？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-03T20:16:58.837

这只是一个软件更新。这是描述它的[博客文章。](http://gephi.org/support/install-java-6-mac-os-x-leopard/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-09-19T06:00:32.240

像 netbeans 和 eclipse 这样的 JDeveloper 提供了一个配置文件（通常是 .conf），您可以在其中更新 jdkhome 属性，以添加 jdk6 安装的路径，如前所述，您可以从[Java 6 for Mac 的 OpenJDK 端口](http://landonf.bikemonkey.org/static/soylatte/)获取它。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-01-23T19:30:22.690

您还需要注意：

*   如果您有别名“CurrentJDK”并且该别名已“损坏”，则必须将其删除才能安装新的 JDK。
*   删除该“别名”将解决问题。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-03-03T20:16:09.543

这是。在这里查看：[Apple 支持](http://support.apple.com/kb/HT1856)

# vb.net - 多线程的最佳方式

> ID：607950
> 
> 赞同：1
> 
> 时间：2009-03-03T20:11:45.340
> 
> 标签：vb.net, multithreading, dll

我的大学作业很快就要到期了，我需要能够调用一个需要很长时间（可能是无限的，它依赖于用户输入）来执行的 C++ dll。我通过 VB 调用它。发生这种情况时，我的 VB GUI 会冻结，我想保持 GUI 响应，以便用户可以停止这个可能的无限循环。

任何人都可以建议最好/最快的方法吗？

一点背景知识，C++ 正在尝试使用网络摄像头在斯诺克台球桌上保持得分，而 VB 记分牌​​很容易更新，我想编写脚本以便分析几乎是连续的，同时仍然允许用户进行交互。目前该项目要求用户按下按钮来开始镜头分析，但如果程序自己编写脚本会更好。我现在才意识到这个问题，而且截止日期很快。

更新：我们的讲师建议了一个解决问题的选项，但似乎这里的大多数选项和他建议的选项对我们不起作用，因为由于硬件限制，网络摄像头图像捕获所需的处理时间太长而无法处理。感谢您抽出宝贵时间提供帮助，非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T20:15:20.887

在 VB.NET 中处理线程的最佳方式是通过[System.Threading](http://msdn.microsoft.com/en-us/library/system.threading.aspx)命名空间。

您还可以查看**Application.DoEvents()**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-05T01:39:47.103

我肯定会使用后台工作进程。您可以将它拖到表单上并使用 DoWork 子例程来实际执行冻结 GUI 线程的工作。您还可以使用 ReportProgress 事件将进度实际提供给您的表单。

至于您关于两个单独线程的问题，如果这两个步骤都需要很长时间才能完成，我会一个接一个地在同一个线程中运行它们。

使用线程可能会咬你的一件事是交叉线程。在您的问题的上下文中，这意味着没有您的第二个线程更新表单控件。

关于如何实现此代码以及处理跨线程的一个非常好的资源是此[PDF](http://www.agiledeveloper.com/articles/BackgroundWorker.pdf)。

我还应该指出，如果您使用的是 .net 1.0/1.1，您仍然可以执行多线程，但没有后台工作控制的奢侈。您只需要从 System.Threading 命名空间创建一个新线程。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T20:31:43.607

试试 Mark 说的 system.Threading，也试试看 VB.NET 中更简单的后台工作进程。在[这里阅读](http://msdn.microsoft.com/en-us/library/8xs8549b.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T20:40:11.090

作为替代方案，您可以让您的 C++ 一直在后台实际处理。当从 VB 调用时，它只会从中检索数据或向其发送命令（开始、退出、???），所有这些都会立即返回。

这也可以为您提供更高的可靠性，因为当 VB 收集垃圾或洗碗或 VB 在后台执行任何操作时，C++ 永远不会错过视频帧——C++ 将使您更接近实时系统。

RE：关于如何的评论。

我可能会做的是让我的 VB 程序向 C++ 发送“消息”（正如我所说）。消息只是考虑函数/方法调用的一种方式——但通常它们会很快返回。

“开始”消息将告诉 C++ 代码开始它的线程运行并返回。这是一个 Linux [C++ 线程 howto](http://www.linuxselfhelp.com/HOWTO/C++Programming-HOWTO-18.html)，我不确定你是否需要在 Windows 中做一些不同的事情（我希望不会，但几十年来我没有使用 C++ 作为我的主要开发语言）。

如果这不起作用，只需谷歌“C++ 线程”

发送“停止”消息将停止线程（并且可能会释放资源）。

“获取数据”调用将转到 C++ 线程用于存储数据的位置，获取数据并返回。

抱歉这么笼统，这些天我非常喜欢Java。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-05T16:52:19.500

我很惊讶没有人建议使用 a [`BackgroundWorker`](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx)。

# jboss - 一个 JBoss 实例上的多个应用程序

> ID：607952
> 
> 赞同：0
> 
> 时间：2009-03-03T20:12:19.847
> 
> 标签：jboss, web-applications

我试图找出是否可以配置一个 JBOSS 实例来运行多个应用程序。每个应用程序都服务于不同的端口，我希望 JBoss 有这个功能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-03T20:18:44.543

我知道这在 WebLogic 上是可能的。当我为新应用程序创建域时，我可以指定端口。我确信 JBoss 具有类似的能力。

# c++ - 如何在 Eclipse 中将执行显示输出到远程 C++ 的控制台？

> ID：607976
> 
> 赞同：3
> 
> 时间：2009-03-03T20:17:22.817
> 
> 标签：c++, eclipse, remote-debugging, eclipse-3.4

我正在使用带有 Hp/UX 插件的 Eclipse 3.4.1 来远程调试 C/C++。它工作得很好，除了一个问题：每当我编译我的项目时，输出显示是 Eclipse 的控制台视图，但是当我运行或调试任何项目时，输出窗口是旧的和不太好的 MS-DOS 命令窗口. 我还没有找到任何方法来改变这种行为。

如何将执行输出显示设置到 Eclipse 控制台？

**更新**：环境：在 Windows XP 上运行 Eclipse 3.4.1 并在 HP/UX 服务器上调试 C/C++ 应用程序。

CDT 版本为 5.0.0。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-15T08:51:53.983

您使用的是哪个版本的 CDT？因为从这个[“hello world”指南](http://max.berger.name/howto/cdt/ar01s04.jsp#N10321)看来，spawner.dll 几乎可以为您处理这个控制台重定向。

# c# - 如何在 ASP.NET 中创建带有节和标题的表？

> ID：607980
> 
> 赞同：3
> 
> 时间：2009-03-03T20:18:38.913
> 
> 标签：c#, asp.net, sql-server, grouping

我有一些数据必须以包含多个部分的表格形式呈现。特别是，每个数据部分都按天分解（带有自己的标题）。这基本上是一次性的单页交易，不会真正维护，所以我不想在架构上投入太多精力。

我有两张桌子。标题和项目。

HEADERS 的格式为：

```
date(datetime), type(tinyint), firstline(varchar), secondline(varchar) 
```

项目的格式为

```
id(int), date(datetime), type(tinyint), name(varchar), value1(int), 
    value2(int), value3(int) 
```

我需要数据看起来与此类似（第一行和第二行是数据填充，第三行是静态文本，项目行是数据填充）：

```
1/1/2009
--------------------------------------------------------------------------
|                              [First line]                              |
--------------------------------------------------------------------------
|                             [Second line]                              |
--------------------------------------------------------------------------
|  Date |       Name            |   Value 1    |   Value 2   |  Value 3  |
==========================================================================
| [Date]|      [Name]           |  [Value 1]   |  [Value 2]  | [Value 3] |
--------------------------------------------------------------------------
| [Date]|      [Name]           |  [Value 1]   |  [Value 2]  | [Value 3] |
--------------------------------------------------------------------------
1/2/2009
--------------------------------------------------------------------------
|                              [First line]                              |
--------------------------------------------------------------------------
|                             [Second line]                              |
--------------------------------------------------------------------------
|  Date |       Name            |   Value 1    |   Value 2   |  Value 3  |
==========================================================================
| [Date]|      [Name]           |  [Value 1]   |  [Value 2]  | [Value 3] |
--------------------------------------------------------------------------
| [Date]|      [Name]           |  [Value 1]   |  [Value 2]  | [Value 3] |
-------------------------------------------------------------------------- 
```

这将在数​​据库中当前的所有日子重复，每一天都有它自己的表和它自己的标题。它们还将按类型过滤。该页面将仅显示指定类型的标题和项目。类型是一个tinyint。

**所以问题是，什么是最好的 ASP.NET 元素？数据列表？网格视图？以及如何以标题/项目格式包含两个表中的数据？**

编辑：对不起，忘了提到这必须在 Windows 2000/IIS5 上工作，所以我坚持使用 ASP.NET 2.0 并且不能使用 3.0 或 3.5 功能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T20:35:40.883

看看 asp:table。您可以在代码中的某些嵌套条件迭代中以编程方式添加行和列。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T20:27:05.273

我建议将数据作为 XML 返回，然后使用 XSLT 构建您的报告。否则，您将不得不使用嵌套的 GridView 或中继器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T22:16:49.207

如果模式每次都适用于相同数量的行等。中继器可能是您最好的选择，它可以让您最大程度地控制布局在屏幕上的外观。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-04T13:24:02.537

在页面上放置一个`<asp:Table>`并从后面的代码构建它。

对列（单元格）使用 colspan 参数，因为这允许您为需要的行创建跨越许多列的条目。

对于上面的应用程序，这意味着 First Line 和 Second Line 的 colspan 为 5。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-05T00:30:14.697

好的，这是我想出的最终解决方案。我确信这不是最有效或最快的，但我只需要完成它并继续做其他事情。

我的第一步是创建一个基类，我称之为 RowBase，这是一个抽象类，它实现了一个名为 GetRow() 的抽象方法；然后我从 RowBase 派生了另外两个类 BannerRow 和 ItemRow。这些类包含包含我的表中使用的所有数据的字段。

然后我创建了两个 DataTable，并通过 DataAdapter 用我的两个查询的结果填充它们。

接下来，我创建了一个 List<RowBase> 并对数据表进行交互，根据行的类型创建 BannerRow 或 ItemRow。

接下来，我运行了一个 List<RowBase>.Sort，对日期和行类型进行排序，以确保 BannerRows 优先于 ItemRows。

最后，我在我的网络表单上创建了一个表格，将其设置为 runat="server"，id="maintable"，然后我遍历我的 List<RowBase> 并在每个 RowBase 上调用 GetRow。

BannerRow 和 ItemRow 都有一个 GetRow() 覆盖，它返回一个 HtmlTableRow 格式化以包含正确格式的数据。然后，我使用了一些条件逻辑来为 ItemRow 数据插入标题行。

这是 Rob 和 Ben 的想法的一个变体，但包含了更多的数据按摩，所以我给了他们两个都投了赞成票，但我相信自己的答案。

# java - 如果它们不在 NetBeans javafx 面板中，则在 javafx 中使用 Swing 组件

> ID：607984
> 
> 赞同：2
> 
> 时间：2009-03-03T20:19:17.490
> 
> 标签：java, swing, netbeans, javafx

我刚开始在 NetBeans 中使用 javafx，我让它做一些简单的事情（带有按钮的窗口 + 之类的），但想尝试一些更现实的东西。

“Swing/AWT 组件”调色板有一大堆“JavaFX 脚本代码剪辑”调色板没有的东西（它有 Button、CheckBox、ComboBox、ComboBoxItem、Label、RadioButton、Slider、TextField 和 ToggleButton）。如何向此调色板添加内容？

我想尝试使用 org-netbeans-swing-outline.jar 中的一些组件

* * *

编辑：啊哈。我有点忽略了这一点：javafx.ext.Swing.* 中只有一些 javafx 包装的 Swing 组件可用，所以如果您想要其他 Swing 组件之一，您必须自己包装它们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-04T20:04:33.383

啊哈，我想出了我需要做什么：

有一种方法可以使用[将 Swing 组件包装到 javafx 组件](http://javafx.com/samples/ExercisingSwing/index.html)中`javafx.ext.swing.SwingComponent.wrap()`

# asp.net-mvc - 使用模型和 ViewData 项创建 ViewDataDictionary 的简写？

> ID：607985
> 
> 赞同：26
> 
> 时间：2009-03-03T20:19:20.347
> 
> 标签：asp.net-mvc, renderpartial

有没有办法`ViewDataDictionary`用一行代码创建一个模型和附加属性。我试图`RenderPartial`在组装模型和一些额外的显示配置属性时调用强类型视图，而无需跨多行显式组装 ViewDataDictionary。`RenderPartial`考虑到同时采用模型`object`和 a的重载似乎是可能的，`ViewDataDictionary`但看起来它只是忽略了`ViewDataDictionary`它们都被填充的时候。

```
// FAIL: This will result in ViewData being a ViewDataDictionary
// where Model = MyModelObject and there are no other parameters available.
this.Html.RenderPartial("SomePartialView", MyModelObject, new ViewDataDictionary(new { SomeDisplayParameter = true })); 
```

我发现其他人有[同样的问题](https://stackoverflow.com/questions/495351/asp-net-mvc-rc1-renderpartial-viewdatadictionary)，但他们的解决方案与我发现的多线概念相同：`ViewDataDictionary`使用模型创建一个离散，添加新参数并在`RenderPartial`调用中使用它。

```
var SomeViewData = new ViewDataDictionary(MyModelObject);
SomeViewData.Add("SomeDisplayParameter", true);
this.Html.RenderPartial("SomePartialView", SomeViewData); 
```

我总是可以将该逻辑包装到一个`ChainedAdd`方法中，该方法返回一个添加了新元素的重复字典，但似乎我缺少某种方法来创建一个`ViewDataDictionary`可以为我做到这一点的方法（这比我希望的要多一点开销为了）。

```
this.Html.RenderPartial("SomePartialView", new ViewDataDictionary(MyModelObject).ChainedAdd("SomeDisplayParameter", true));

public static ViewDataDictionaryExtensions {
    public static ViewDataDictionary ChainedAdd(this ViewDataDictionary source, string key, object value) {
        return source.ChainedAdd(new KeyValuePair<string,object>(key, value));
    }
    public static ViewDataDictionary ChainedAdd(this ViewDataDictionary source, KeyValuePair<string, object> keyAndValue) {
        ViewDataDictionary NewDictionary = new ViewDataDictionary(source);
        NewDictionary.Add(keyAndValue);
        return NewDictionary;
    }
} 
```

同样，尝试`ViewDataDictionary`使用显式组装 a`Model`并`ModelState`简单地导致编译错误，因为 ModelState 是只读的。

```
// FAIL: Compilation error
this.Html.RenderPartial("SomePartialView", new ViewDataDictionary { Model = MyModelObject, ModelState = new ViewDataDictionary( new { SomeDisplayParameter = true }}); 
```

**回答（S）：**看起来克雷格和我最终找到了两种不同的语法来完成工作。在这种情况下，我肯定是有偏见的，但我喜欢先设置模型然后“装饰”它的想法。

```
new ViewDataDictionary(MyModelObject) { { "SomeDisplayParameter", true }, { "SomeOtherParameter", 3 }, { "SomeThirdParameter", "red" } };

new ViewDataDictionary(new ViewDataDictionary() { {"SomeDisplayParameter", true }})
    { Model = MyModelObject }; 
```

当然，如果没有他[最终准确]的回答，我仍然会旋转我的轮子，所以，圆圈得到了正方形。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-03-03T20:26:02.717

使用[对象初始化器](http://blogs.msdn.com/howard_dierking/archive/2007/08/13/c-3-0-object-initializers.aspx)和集合初始化器：

```
new ViewDataDictionary(new ViewDataDictionary() { {"SomeDisplayParameter", true }})
    {
        Model = MyModelObject
    } 
```

内部 ViewDataDictionary 初始化其集合，然后使用构造函数重载填充“真实” ViewDataDictionary，该构造函数重载采用 ViewDataDictionary 而不是对象。最后，对象初始化器设置模型。

然后只需传递整个事情而不单独设置 MyModelObject ：

```
this.Html.RenderPartial("SomePartialView", null, 
    new ViewDataDictionary(new ViewDataDictionary() { {"SomeDisplayParameter", true }})
        { Model = MyModelObject }); 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-03-04T15:04:51.297

使用 Craig 的答案作为起点——我什至不知道你可以将构造函数调用和对象初始化程序结合起来——我偶然发现了来自巴勒莫的这个[片段](http://jeffreypalermo.com/blog/viewdata-mechanics-and-segmentation-excerpt-from-asp.net-mvc-in-action/)，它导致了一个有效的组合。他使用某种字典速记，以某种方式最终填充对象初始值设定项`ModelState`使用的时间。`ViewDataDictionary`

```
new ViewDataDictionary(MyModelObject) { { "SomeDisplayParameter", true }, { "SomeOtherParameter", 3 }, { "SomeThirdParameter", "red" } };
// Of course, this also works with typed ViewDataDictionary objects (what I ended up using)
new ViewDataDictionary<SomeType>(MyModelObject) { { "SomeDisplayParameter", true }, { "SomeOtherParameter", 3 }, { "SomeThirdParameter", "red" } }; 
```

鉴于您无法`ModelState`在初始化程序中显式设置，我仍然看不到这最终是如何工作的，但它似乎确实同时维护了原始模型对象和视图的“附加”参数。这种语法肯定有许多其他排列不起作用 - 您不能将模型与字典组合在单个对象中，或者对字典值使用对象初始化器语法 - 但上述版本似乎有效。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-06-26T21:59:21.447

我在 HtmlHelper 上创建了一个扩展方法，用于将属性名称和值从匿名对象复制到 ViewDataDictionary。

**样本**

```
Html.RenderPartial("SomePartialView", MyModelObject, new { SomeDisplayParameter = true }) 
```

**HtmlHelper 扩展**

```
public static void RenderPartial(this HtmlHelper htmlHelper, string partialViewName, object model, object viewData)
{
    var vdd = new ViewDataDictionary(model);
    foreach (var property in viewData.GetType().GetProperties()) {
        vdd[property.Name] = property.GetValue(viewData);
    }
    htmlHelper.RenderPartial(partialViewName, vdd);
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-11-22T15:42:31.953

这在旧式 mvc aspx 视图中对我有用：

```
<% Html.RenderPartial("ContactPartial", Model.ContactFactuur, new ViewDataDictionary(this.ViewData ) { TemplateInfo = new TemplateInfo { HtmlFieldPrefix = "Factuur" } }); %> 
```

这里的问题是，在构造函数中，我使用了当前的视图数据“new ViewDataDictionary(this.ViewData)”，这是一个包含验证消息所需的模型状态的视图数据字典。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-20T20:17:39.743

我带着完全相同的问题来到这里。

我认为可能有用的是这个（请原谅 VB Razor 语法）

```
 @Code Html.RenderPartial("Address", Model.MailingAddress, New ViewDataDictionary(New With {.AddressType = "Mailing Address"}))End Code 
```

但是当然你会在运行时得到这个错误：

System.InvalidOperationException 未被用户代码处理

Message=传递到字典中的模型项的类型为“VB$AnonymousType_1`1[System.String]”，但该字典需要类型为“ViewModel.Address”的模型项。

但我发现，无论如何我真正想要的是使用编辑器模板。

而不是 RenderPartial 使用：

```
@Html.EditorFor(Function(model) model.MailingAddress, "Address",  New With {.AddressType = "Mailing Address"}) 
```

编辑器模板只是存在的部分视图

~/Views/{Model|Shared}/EditorTemplates/templatename.vbhtml

我的 Address 模板是一个强类型的局部视图，但是 EditorFor 方法提供了使用匿名对象轻松添加其他视图数据项的能力。

在上面的示例中，我不需要包含模板名称“地址”，因为 MVC 会查找与模型类型同名的模板。

您也可以以相同的方式覆盖显示模板。

# .net - 需要 .Net 登录程序的帮助（在本地机器上工作，而不是在远程机器上工作）

> ID：607992
> 
> 赞同：2
> 
> 时间：2009-03-03T20:22:06.190
> 
> 标签：.net, asp.net, asp.net-membership

我有一个非常愚蠢的问题，但已经一个星期了，我无法继续前进。我有受身份验证保护的小应用程序。一切都在本地工作，您可以登录等。在远程机器上，您无法登录，它告诉您您的登录名未被识别。现在，我认为它可能是数据库连接等，所以我制作了列出 asp_users 表的小型测试页面，并通过对用户进行更改，我可以看到本地和远程都通过该连接看到同一个表，为什么用户身份验证不起作用是超越我。

为了澄清，它是 asp.net 应用程序和表单身份验证，数据库连接基于我创建的列出 asp_users 表的测试页面工作。

它并没有真正报告任何错误，只是说'您的登录尝试不成功。请再试一次。' 这一定是非常简单的事情，我现在太沮丧了，看不到它，这就是我寻求帮助的原因。帮助 ！:)

好的，所以我尝试发布 web.config 的部分内容，但它没有显示出来。它是真正的基本配置，包含连接字符串、成员资格和角色部分（无配置文件）。所以问题是你会怎么做，你会检查什么。

提前感谢任何建设性的意见。

泽利科

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-04T13:46:37.207

我们的情况有点类似，虽然我们可以登录，但网站在选择时拒绝“记住我”。它归结为确保成员资格和角色提供者都指向相同的资源。是的，那是一个“Doh！” 我的时刻。:)

您是在尝试在远程服务器上使用 SQLExpress，还是指向完整的 SQLServer 实例？根据我的经验，大多数共享托管环境都没有设置为允许在 App_Data 文件夹中使用 .MDF ......无论如何，知道这将为您指明正确的方向。

**这里有几件事可以尝试：**

1.  确保您的登录 ID 未被锁定；真的可能就这么简单

2.  确保包含登录页面的文件夹上没有安全修整

3.  检查 web.config 文件中的相应提供程序设置，并确保

    *   所有提供者都需要具有相同的“应用程序”属性值

    *   所有提供者都需要使用相同的连接字符串和提供者“设置”

        *   这很可能意味着使用**SqlMembershipProvider**和**SqlRoleProvider**
        *   如果您的应用程序不是 v3.5 应用程序，那么您可能需要添加对 System.Web.Security 的引用。那是你真正需要的命名空间
    *   如果您确定您的站点可以使用 SQLExpress，请尝试使用**AspNetMembershipProvider**和**AspNetRoleProvider**

！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T20:41:14.070

你有域名吗？如果您不这样做，那么您必须以运行您的 asp.net 应用程序的系统的用户身份登录。

如果您确实有域，请尝试以

域名\用户名

只是把那个扔在那里。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T20:59:50.250

目前尚不清楚您使用的是哪种类型的身份验证，但如果是 Windows 身份验证，则可能是您正在从本地计算机读取登录用户，而该用户在远程计算机上不存在。

如果您已正确实施表单身份验证，那么听起来可能是数据库连接问题，您应该从那里开始进行故障排除..

*   也许首先尝试从远程机器的 sql 管理工作室连接到数据库（使用 web.config 中的连接信息）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T21:35:59.960

IIS 的目录安全设置是什么？确保“匿名访问和身份验证控制”对话框的设置相同。此处的无效设置是此特定错误的最可能原因。

# asp.net - 如何从子程序共享变量到子程序？

> ID：607998
> 
> 赞同：0
> 
> 时间：2009-03-03T20:22:37.577
> 
> 标签：asp.net, vb.net

我有一个子程序，我从数据库中提取信息。我想在另一个子例程中使用这个子例程中的变量。我尝试公开所有内容，但它不想友好和分享。

```
Dim strEmail as String
Public Sub readDB()
strEmail = "whatever@doohikcy.com"
End Sub

Public Sub submit_btn(ByVal sender As Object, ByVal e As EventArgs)
Response.Write(strEmail)
End Sub 
```

readDB 将读取数据库并设置变量并执行它需要执行的任何操作。然后，当他们提交表单时，它会将表单通过电子邮件发送到任何电子邮件地址。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T20:53:09.687

每次加载 asp.net 页面时，都会清除全局变量。您可以通过使用会话变量来避免这种情况。

```
Public Sub readDB()
   Session("strEmail") = "whatever@doohikcy.com"
End Sub 
```

然后：

```
Public Sub submit_btn(ByVal sender As Object, ByVal e As EventArgs)
    Response.Write(CStr(Session("strEmail")))
End Sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T20:51:03.750

将它们作为参数传递是很棒的，如果对相关潜艇的调用顺序使之可行的话。如果您确实需要一个对同一类中的不同 sub 可见的变量（ASP.Net 中的代码隐藏页面），那么您正在寻找的可能是一个私有成员变量。*使用访问修饰符Private*在任何子或函数之外声明它，并且类中的所有子都可以访问它。

```
Private _foo As String 
```

下划线是有些人喜欢，有些人讨厌的约定。如果您想定义一个属性来公开变量，它在 VB 中会派上用场，您不能将*Foo用作与**foo*明显不同的地方，但那是另一回事了。

*这与 ASP.Net 意义上的术语“全局*变量”通常理解的不同，其中变量将在整个应用程序上下文中可见，这至少会导致意外后果。私有成员变量仅对拥有它的类可见。

编辑：您的示例代码是在我最初的回答之后添加的。我的 VB 有点生疏，但正如你所写的，**strEmail**看起来应该具有类级别的可见性，包括在**submitbtn**内部（如果我错了，请有人纠正我）。一种可能性，因为您提到您在**Page_Load**中调用 readDB是，如果您在页面加载中检查回发，并且仅在初始加载时调用 readDB，而不是在回发时，单击按钮时会出现这种情况。您可能已经看过一些示例，其中包括检查 Postback 并没有意识到它的作用（我只是建议您这样做，因为您提到您是 ASP.Net 的新手，如果您是新手，它并不直观——不冒犯意图）。

```
Protected Sub Page_Load (sender as object, e as EventArgs)
    If Not IsPostback
        // this doesn't get called when the button is clicked so
        // strEmail would not be populated when submitbtn is invoked
        readDB
    End If
End Sub 
```

不过，这有点凭空猜测，所以可能有点离谱。您是否在 Page_Load、readDB 和 submitbtn 中设置了断点来查看每个中 strEmail 的状态？*******`***