# StackOverflow 问答 000839000-000839999

# sql - ExecuteReader 需要一个打开且可用的连接。连接的当前状态为关闭

> ID：839014
> 
> 赞同：8
> 
> 时间：2009-05-08T09:30:57.497
> 
> 标签：sql, sqldatareader, sqlconnection

好的，我本周早些时候询问了这个非常错误的问题，并得到了一些非常有用的答案，毫无疑问，自从我开始遵循这些建议以来，情况已经有了很大的改善。

但是，现在我正在使用“正确”的最佳实践方法来访问数据库，但在某些功能上仍然出现此错误，并且我无法让它在该块中消失。这是我的代码：

```
 Public Shared Function doesBasketExist(ByVal baskethash As String) As Boolean
    Dim _r As Boolean
    Using db As New SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings("pitstopConnectionString").ConnectionString)
        Using cmd As New SqlCommand("doGetBasketByHash", db)
            cmd.CommandType = CommandType.StoredProcedure
            cmd.Parameters.AddWithValue("@baskethash", baskethash)
            Using dr As SqlDataReader = cmd.ExecuteReader()
                If dr.HasRows() = True Then
                    _r = True
                Else
                    _r = False
                End If
                dr.Close()
            End Using
        End Using
    End Using
    Return _r
End Function 
```

现在无论我做什么，我都会得到：ExecuteReader 需要一个开放且可用的连接。连接的当前状态为关闭。在这个连接上。我在这个类（cmd、dr 等）中确实有带有对象的函数（cmd、dr 等），但是 Using 会在它自身之后关闭，不是吗？

欢迎提出建议:)

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-08T09:33:47.850

我想你忘记打开连接了。

在此行之前打开它：

```
cmd.Parameters.AddWithValue("@baskethash", baskethash) 
```

使用 -

```
db.Open() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-08T09:34:47.613

您实际上忘记了`Open`连接：

```
 db.Open()
        Using dr As SqlDataReader = cmd.ExecuteReader() 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-12-21T19:00:34.540

造成这种情况的一个原因是您的连接根本无法打开。“SqlConnection.Open”语句中出现的任何异常都被抑制了。如果问题不在您的应用程序中，则可能是服务器无法授予您连接。可能是因为您的应用程序或同一服务器上托管的其他数据库中的连接泄漏。

# postgresql - 索引组织表能否为更快的 SELECT COUNT(*) FROM 表铺平道路

> ID：839015
> 
> 赞同：3
> 
> 时间：2009-05-08T09:30:59.387
> 
> 标签：postgresql, count, rows, performance

我发现创建触发器只是为了获取表的当前总行数而不执行 COUNT(*) FROM 表很麻烦。我在想他们为 Postgres 8.5 计划的索引组织表是否可以实现？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-19T23:50:31.527

我不会想到索引组织的表一定会更快地扫描以计算所有可见的元组。从逻辑上讲，它必须经过相同数量的数据，无论是组织成数据是在 b-tree 叶节点还是在现有的堆格式中。

目前，postgresql 索引只存储 [key,ctid] 对（本质上）。（一个 ctid 本质上是一个“rowid”——堆页号和元组行指针索引）所以你不能仅仅通过索引来计算表中的行数，因为你需要检查每个元组的 [xmin,xmax] - 这仅与数据一起保存在堆中。

您也可以将 [xmin,xmax] 放入索引中——对此的建议会不时出现。但这会使索引膨胀，并且为了有用，所有更新/删除都必须确保它们保持最新：这会导致问题，尤其是因为更新所涉及的工作现在已经扩大了一些倍通过表上的索引数。对于诸如 tsvector 上的重索引，或者基于昂贵的用户表达式的索引，这可能需要一段时间，并且在某些令人讨厌的情况下根本不起作用，行现在似乎在索引中是活动的，但在堆。这个练习的重点应该是允许数据库在可能的情况下完全依赖索引中的活跃度信息。

我想一种可能性是将索引标记为可选地具有 [xmin,xmax] - 例如仅以这种方式标记 pkey 索引。然后必须对计划者进行更改才能确定何时这是一个优势——这似乎是一项相当多的工作。

索引组织的表，如果它们像我相信它们在 Oracle（和 SQL Server，其中任何具有聚集索引的表基本上是索引组织的）中工作的那样工作，则通过将 [key,tuple] 存储在主键索引中来工作（并且大概[key,pkey] 在所有其他） - 没有 ctid，没有堆。所以“元组”将包含 [xmin,xmax,cminmax,natts,....] 等，您只需扫描索引即可满足“从表中选择计数（*）”。但这基本上与扫描堆上的元组相同——它们不会神奇地占用更少的空间，因为它们现在位于“索引”中。

AFAICT 索引组织表的主要原因是具有单个主键索引的小表将占用 1 页而不是 3 页，并且按主键进行索引扫描可能会更快一些。我似乎确实记得我为 IOT 提供的与 Oracle 相关的建议是，它们是为静态维度表设计的，而不是通用用途，部分原因是维护二级索引的成本（我不认为 Oracle 存储 [ key,pkey] 在 IOT 二级索引中，而是某种替代 rowid）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-12-02T03:29:49.080

这已经过时了，但是在 PostgreSQL 9.2 中，您可以获得仅索引扫描，它也可以执行 count(*)。

也可以看看，

*   [“count(*)”现在快得多了吗？](https://wiki.postgresql.org/wiki/Index-only_scans#Is_.22count.28.2A.29.22_much_faster_now.3F)

# c# - GZipInputSteam DeCompression 不适用于大小超过 13239 的数据

> ID：839021
> 
> 赞同：1
> 
> 时间：2009-05-08T09:32:31.987
> 
> 标签：c#, java, compression

我已经在 c#.NET 和 Java 中使用 GZipinputstream 创建了压缩和解压缩技术。如果我在 c#.NET 中压缩到 13239 字节，那么我可以在 Java 中解压缩它，但如果我在 c#.NET 中压缩超过 13239 字节，那么我无法在 Java 中解压缩它。但我可以使用 C#.NET 解压缩它。有什么想法可能导致这种情况吗？

谢谢巴皮

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T19:39:41.270

建议你尝试用gzip、gunzip 压缩，看看问题出在哪里。

我已经使用 Java 压缩和解压缩了更大的文件，并且这些文件也可以与实用程序一起正常工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T10:10:35.123

在关闭流之前刷新流/尝试从 Java 端读取它。我的猜测是你碰到了某种缓冲区，并不是所有的数据都被传输了。

# ruby - 如何在 Shoes 中制作一个简单的文本编辑应用程序？

> ID：839022
> 
> 赞同：3
> 
> 时间：2009-05-08T09:32:50.880
> 
> 标签：ruby, shoes

我正在尝试使用鞋子编写一个简单的工具。这将缩进我们使用的晦涩脚本语言的代码。它有一个大文本框和一个按钮。我有程序在命令行上运行，但我没有运气把它包在鞋子里。如果有人可以给出一个应用程序的工作示例，该应用程序执行以下任务以使我启动并运行，那将非常有用。

单击按钮时，我想：获取文本，拆分为行数组（此处发生缩进），再次加入行并使用新数据刷新文本框。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-08T15:26:55.013

```
Shoes.app :width => 300, :height => 450 do
  @text = edit_box :width => 1.0, :height => 400
  btn = button 'Indent!'
  btn.click do
    ugly_txt = @text.text
    lines = ugly_txt.split $/ #the record separator
    lines.collect! { |line| '  ' + line } #your indentation would replace this
    @text.text = lines.join $/
  end
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T15:38:11.337

我认为示例文件夹中有一个示例

# flash - 防止谷歌地图标记在拖动时“飞”起来

> ID：839029
> 
> 赞同：1
> 
> 时间：2009-05-08T09:34:44.930
> 
> 标签：flash, actionscript-3, google-maps

我正在使用 Google Maps Flash API，并且我有一个靶心标记，用户应该将其拖动到正确的位置，但是每当你拖动某些东西时，它就会飞起来一点，下面会出现这个愚蠢的目标十字，这就是我想要的防止，因为它看起来不太好，我什至会说它令人困惑。

到目前为止，我唯一的想法是为图标设置偏移量，以补偿用户单击标记时的“飞行”高度，但我想也许有一个隐藏的选项可以做到这一点，或者只是我没有'不是从文档中得到的，但我想我现在已经全部尝试过了。

干杯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-19T22:09:32.510

尝试类似：

```
var square = new GIcon();

square.dragCrossImage = ""; // no image for the cross
square.maxHeight = 0.1; // it only raises a fraction of a bit

square.image = "/edit/images/square.gif";
square.shadow = "";
square.iconSize = new GSize(10, 10);
square.shadowSize = new GSize(5, 5);
square.iconAnchor = new GPoint(5, 5);
square.infoWindowAnchor = new GPoint(15, 15); 
```

传递可选属性**dragCrossMove: false**

# mysql - Sql日期选择彼此X秒范围内的行

> ID：839036
> 
> 赞同：7
> 
> 时间：2009-05-08T09:35:42.790
> 
> 标签：mysql, date, time, logic

我的 sql 表类似于 (message,created)

我想选择彼此相距 X 秒内的那些行。假设最后一条消息在 NOW() 的 X 秒内，那么它应该选择它。如果倒数第二条消息在最后一条消息的 X 秒内，那么它也应该选择它。换句话说，每一行都应该与下一行进行比较并检查。对于最后一行，应使用 NOW() 进行检查。基本上我想要最后一个消息会话（即我们相互链接的最后一组消息，假设 X 秒内的后续消息相互链接）

我不知道如何为此编写 SQL 查询。甚至可能吗？

非常感谢您的宝贵时间。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-08T09:49:17.530

此脚本适用于 SQLServer。您应该能够取出 select 语句并在 MySQL 中运行它。

```
DECLARE @Messages TABLE (Message VARCHAR(10), Created DATETIME)
DECLARE @Interval FLOAT

-- Interval is 1 day.
SET @Interval = 1

-- These should be in result
INSERT INTO @Messages VALUES ('Message1', GetDate())    
INSERT INTO @Messages VALUES ('Message2', GetDate()-1)
-- These should not be in result
INSERT INTO @Messages VALUES ('Message3', GetDate()-3)
INSERT INTO @Messages VALUES ('Message4', GetDate()-5)

SELECT m1.Message, m1.Created
FROM @Messages m1
     INNER JOIN @Messages m2 ON m2.Created <= m1.Created + @Interval                                
                                AND m2.Created >= m1.Created
                                AND m2.Message <> m1.Message
UNION ALL SELECT m2.Message, m2.Created
FROM @Messages m1
     INNER JOIN @Messages m2 ON m2.Created <= m1.Created + @Interval                                
                                AND m2.Created >= m1.Created
                                AND m2.Message <> m1.Message
ORDER BY Created 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T09:49:27.750

我相信您的想法太复杂了（但话又说回来，也许我误解了要求？）

这将选择在特定消息之前 30 秒内创建的所有消息：

```
SELECT
  Id,
  MessageText,
  MessageDate
FROM
  Message
WHERE
  TIME_TO_SEC(TIMEDIFF(
    (
      SELECT MessageDate 
      FROM   Message
      WHERE  Id = 17
    ),
    MessageDate
  )) <= 30 
```

其中 17 当然是您感兴趣的消息 ID，而 30 是您的时间范围内的秒数。

# sh - 无法在 .screenrc 中获取资源

> ID：839039
> 
> 赞同：2
> 
> 时间：2009-05-08T09:37:36.390
> 
> 标签：sh, screenrc

我的 .screenrc 中有以下内容

```
 source ~/bin/Screen/multiUserSettings 
```

它给了我

```
No such file or directory 
```

虽然我有。

以下代码告诉我未知命令“。”。

```
. ~/bin/Screen/multiUserSettings 
```

这很奇怪，因为我可以通过 . 例如，在 .vimrc 和 .zshrc 中。

文件**多用户设置**

```
 # allow the following people full control
 addacl root,aledesma,mymanager,mycoworker1,mycoworker2
 aclchg aledesma +rwx ?#??

 # allow everyone readonly access
 aclchg *,!aledesma -rwx ?#??

 # setup 10,000 lines of available scrollback ? copy/paste
 defscrollback 10000

 # fix scrollback in putty
 termcapinfo xterm* ti@:te@ 
```

**如何在 .screenrc 中获取资源？**

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2010-10-09T01:11:03.633

使用绝对路径不能跨机器移植（例如，如果您使用 git 或 svn 在您登录的服务器之间同步 .rc 文件）。更好的是使用在 .screenrc 文件中工作的 $HOME 变量。例如：

```
source $HOME/bin/Screen/multiUserSettings 
```

这样，如果您使用 .screenrc 的一台机器有一个主目录 /home/yourname，另一台有 /Users/yourname，另一台有 /opt/export/yourname，它仍然可以正常工作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-08T10:09:19.247

尝试使用

```
source /home/yourname/bin/Screen/multiUserSettings 
```

反而。我的猜测是 screen 在这种情况下不支持扩展 ~ 。

如果这不起作用，我认为您应该进行调查以准确找出它抱怨“没有这样的文件或目录”的文件名。您可以使用 strace 来记录系统调用。

# mysql - 如何交换 MySQL 表并自动更改 auto_increment？

> ID：839040
> 
> 赞同：0
> 
> 时间：2009-05-08T09:37:39.137
> 
> 标签：mysql

我有两张桌子：

```
CREATE TABLE table_a (
    id SERIAL
);
CREATE TABLE table_b (
    id SERIAL
); 
```

我想交换表并将新 table_a 的 auto_increment 设置为 table_b 的 MAX(id)+1。例如

```
SELECT @A:=MAX(id) FROM table_a;
SET @qry = CONCAT('ALTER TABLE table_b AUTO_INCREMENT =', @A+1);
PREPARE stmt FROM @qry;
EXECUTE stmt;
RENAME TABLE table_a TO table_b_tmp, table_b TO table_a, table_b_tmp TO table_a; 
```

不幸的是，我无法锁定表，也无法在事务中执行此操作，因为 RENAME TABLE 不适用于锁定的表，并且 ALTER TABLE 隐式提交。

我能想到的避免重叠 id 的唯一解决方案是设置 auto_increment + 50，但由于这个过程经常发生，我宁愿在我的 id 中没有大量的漏洞。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-08T19:34:13.903

As long as the server is not on a version of [MS Windows](http://dev.mysql.com/doc/refman/5.0/en/alter-table-problems.html) and you stick with non-transactional tables, you should be able to use table locks and `ALTER TABLE` *`table_name`* `RENAME TO` *`new_table_name`* statements.

```
LOCK TABLES table_a WRITE, table_b WRITE;
SELECT @A:=MAX(id)+1 FROM table_a;
ALTER TABLE table_a RENAME TO table_a_tmp;
LOCK TABLES table_b WRITE, table_a_tmp WRITE;
PREPARE stmt FROM 'ALTER TABLE table_b RENAME TO table_a, AUTO_INCREMENT = ?';
EXECUTE stmt USING @A;
ALTER TABLE table_a_tmp RENAME TO table_b;
UNLOCK TABLES; 
```

The second lock worries me. If there are any other pending sessions, will they get a chance at the tables before the lock? I could also easily be wrong about the above working. I'm basing the above on the pages below about locks, transactions and ALTER statements.

My other thought is you could create a [MERGE](http://dev.mysql.com/doc/refman/5.0/en/merge-storage-engine.html) table for inserts, updating the merge method to FIRST or LAST instead of (along with?) swapping the tables. Would that work?

*   [12.1.7\. ALTER TABLE Syntax](http://dev.mysql.com/doc/refman/5.0/en/alter-table.html)
*   [B.1.7.1\. Problems with ALTER TABLE](http://dev.mysql.com/doc/refman/5.0/en/alter-table-problems.html)
*   [12.4.3\. Statements That Cause an Implicit Commit](http://dev.mysql.com/doc/refman/5.0/en/implicit-commit.html)
*   [12.4.5.1\. Interaction of Table Locking and Transactions](http://dev.mysql.com/doc/refman/5.0/en/lock-tables-and-transactions.html)

# domain-driven-design - 领域建模提示 - 产品/销售

> ID：839042
> 
> 赞同：2
> 
> 时间：2009-05-08T09:38:13.597
> 
> 标签：domain-driven-design, modeling

我目前正在对一些域类进行建模，以存储有关产品、经销商和付款的信息。有些产品可能是典型的一次性付款交易，例如购买硬盘驱动器。其他产品可能包括具有不同折扣和付款间隔的服务协议。

该模型应能应对不断变化的产品价格、销售额、多种产品的发票等。产品价格的变化不应影响现有的服务协议。到目前为止，我主要关心的是如何跟踪服务交易的付款（以及未付款）。

我很确定这个问题之前已经解决了一百万次。在我第 1000001 次解决这个问题之前，我想问问以前做过这个的人。有人知道适合的模式吗？非常欢迎提示和经验！有什么我应该注意的问题吗？

只是为了说清楚，我不希望任何人为我做我的工作，只是给我一些指示:-)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-06-20T19:54:03.120

[有界上下文](http://devlicio.us/blogs/casey/archive/2009/02/11/ddd-bounded-contexts.aspx)的概念涵盖了您正在谈论的内容。

当客户订购服务交易时，需要将交易条款复制到订单中（假设在下订单时条款是固定的）。这将使您免受未来服务条款更新的影响。

# c# - C# 设计器错误

> ID：839044
> 
> 赞同：3
> 
> 时间：2009-05-08T09:40:21.127
> 
> 标签：c#, designer, declaration

我是 C# 的新手，所以如果我问一些愚蠢的问题，请原谅...

这是我的问题：

*   我有一个继承自“TabPage”的类“ProtocolTabPage”。
*   我有一个从“面板”继承的“控制面板”。
*   我有一个由我的 ProtocolTabPage 实例化的 ControlPanel。
*   我的两个类都在命名空间“AutoTestProtocols.Interface”中。

在 ProtocolTabPage[Design] 中，我有以下错误：

“变量‘ProtocolPanel’要么未声明，要么从未赋值。

在 System.ComponentModel.Design.Serialization.CodeDomSerializerBase.Error(IDesignerSerializationManager manager, String exceptionText, String helpLink) at System.ComponentModel.Design.Serialization.CodeDomSerializerBase.DeserializeExpression(IDesignerSerializationManager manager, String name, CodeExpression expression) at System.ComponentModel.Design System.ComponentModel.Design.Serialization.CodeDomSerializerBase.DeserializeStatement（IDesignerSerializationManager 管理器，CodeStatement 语句）处的 .Serialization.CodeDomSerializerBase.DeserializeExpression（IDesignerSerializationManager 管理器，字符串名称，CodeExpression 表达式）"

虽然，在我的 ProtocolTabPage.Designer 中，我有

```
[...]
this.ProtocolPanel = new AutoTestProtocols.Interface.ControlPanel();
[...]
this.splitContainer1.Panel2.Controls.Add(this.ProtocolPanel);
[...]
this.ProtocolPanel.AutoScroll = true;
this.ProtocolPanel.Dock = System.Windows.Forms.DockStyle.Fill;
this.ProtocolPanel.Location = new System.Drawing.Point(0, 0);
this.ProtocolPanel.Name = "ProtocolPanel";
this.ProtocolPanel.Size = new System.Drawing.Size(696, 700);
this.ProtocolPanel.TabIndex = 0;
[...]
private AutoTestProtocols.Interface.ControlPanel ProtocolPanel;" 
```

怎么了 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T14:53:49.633

乍一看，您似乎在尝试使用类型名称作为变量名称，通常应该避免这种情况。在您的 ProtocolPanel 实例化中，尝试：

```
ProtocolPanel myProtocolPanel = new AutoTestProtocols.Interface.ControlPanel();

```

然后，您可以将所有对“This.ProtocolPanel”的调用更改为“myProtocolPanel”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-24T05:38:21.580

这是我在 5 分钟内的猜测......您看到的调用堆栈是当 .Net 不知道如何序列化/反序列化 gui 类的成员时得到的。

尝试以下操作：

```
[Browsable(false)]
ProtocolPanel ProtocolPanel {get {...} set {...} } 
```

如果它仍然不起作用，请打开表单的 resx 并单击“字符串”（类型）下拉菜单。点击“Other”，看看里面是否列出了与ProtocolPanel相关的二进制序列化数据。如果是这样，请删除它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-10T08:32:19.890

我遇到了同样的错误并打开了 *.resx 文件。字符串包含没有值的 String1 变量。我删除了它，它强制保存并修复了问题（使用 Visual Studio 2010）

1.  在解决方案资源管理器中展开违规表单
2.  双击 *.resx 文件
3.  从下拉列表中选择字符串
4.  右键单击 String1 并选择删除
5.  确定保存然后关闭 *.resx 并重新打开表单

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-08-19T08:35:20.713

我的猜测，因为我遇到了类似的问题：
**您的 ProtocolPanel 类在它的构造函数中做了一些事情，这在设计时不起作用**。例如，您正在读取一个不存在的设置文件，这会引发异常？或者你主动序列化一些不可序列化的东西？

在我的构造函数中，有访问模型的初始化代码，该代码在设计时不存在。我在构造函数路径中引入了以下代码，这有帮助：

```
if (DesignMode || LicenseManager.UsageMode == LicenseUsageMode.Designtime)
{               
    return;   //in design mode do not initialize anything (accessing the model here may cause troubles)
} 
```

# version-control - SSIS 包 - 版本控制和维护问题

> ID：839046
> 
> 赞同：3
> 
> 时间：2009-05-08T09:40:50.110
> 
> 标签：version-control, ssis, maintenance

我们已经开发 SSIS 包大约一年了，并且有两个与这些包的维护相关的主要问题：

1）我们正在使用版本控制，但试图识别包版本之间的变化是一场噩梦——一个包的两个版本之间的文本差异的结果基本上是不可用的。

2）对于不熟悉软件包的人来说，帮助维护的工具不是很好。例如，试图找到特定列的设置位置并不容易。您可以做的唯一搜索是在 xml 上 - 然后您必须对其进行逆向工程以找出该列的使用位置

有没有人对工具/技术有任何想法来帮助解决这些问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-09T02:05:08.333

您尝试过 BIDS Helper 吗？它并不能解决 SSIS 版本控制的所有问题（我同意，这很可怕），但它的 Smart Diff 使 diff'ing 更好一些。

[http://bidshelper.codeplex.com/](http://bidshelper.codeplex.com/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-08T09:55:57.157

你是对的，SSIS 很难维护。

我能给你的唯一建议是按照[单一责任原则](http://en.wikipedia.org/wiki/Single_responsibility_principle)设计你的包。你最终会得到很多小包，但它们不太可能改变，并且当它们改变时更容易维护。

# apache-flex - 如何将位图存储到 flex 中的数组中（动作脚本 3）？

> ID：839049
> 
> 赞同：0
> 
> 时间：2009-05-08T09:42:21.730
> 
> 标签：apache-flex, actionscript-3, air, flash

在我的项目中，我使用了具有 16+16 32+32 48+48 128+128 不同尺寸图像的图像数组作为系统托盘图标，但我穿上 bitmes 然后显示

错误 #2005：参数 0 的类型不正确。应该是类型 BitmapDat。

public var imageURLs:Array = ['icon/toy.png','toy32.png','TOY48.png','joy128.png']; NativeApplication.nativeApplication.icon.bitmaps = new Array(imageURLs);

我做错了什么代码。如何将图像存储到位图数组？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-08T09:47:27.270

您应该改为使用[`BitmapData`](http://livedocs.adobe.com/flex/3/langref/flash/display/BitmapData.html)该类。阅读更多关于[这里](http://livedocs.adobe.com/flex/3/html/Working_with_Bitmaps_03.html)`Bitmap`的`BitmapData`课程。

[这是](http://livedocs.adobe.com/flex/3/html/help.html?content=taskbar_1.html)关于 Flex 任务栏图标的教程。

# java - Java Applet 中的开箱即用 SSL

> ID：839051
> 
> 赞同：0
> 
> 时间：2009-05-08T09:43:35.627
> 
> 标签：java, applet, ssl

我目前正在尝试实现让（签名的）小程序通过 SSL 与服务器程序通信。我找到了正确的咒语来为客户端、客户端的信任管理器和服务器创建密钥存储。这允许我在客户端和服务器上创建兼容的 SSL 上下文。

但是，就目前而言，此设置需要管理员创建密钥存储，然后将它们分发到客户端和服务器计算机。我想避免让人们配置系统。

因此，作为后备，是否可以自动生成客户端密钥并使用“lobotomised”信任管理器来创建兼容的 SSL 上下文而无需任何配置？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-08T12:57:28.773

如果您正在与之通信的是*您*的知名服务器，并且 SSL 以某种方式让您头疼，那么您也可以考虑放弃 SSL 的选项。

SSL 真正旨在解决与“未知”服务器通信的问题，因此证书和协议协商的复杂性。如果您要解决的问题只是将一些加密数据发送到*已知*服务器，那么您始终可以生成一个 RSA 密钥对，将公钥粘贴到 jar 中的文件中，然后使用无聊的旧密码学 API 发送并解释您的数据。只是一个想法...！

**更新：**我应该提到，我首先假设您有一种可信赖的方式在您的客户端上安装软件。一位评论者正确地指出，如果不是这种情况，那么以这种方式分发公钥会受到中间人攻击（MITM 会为您提供一个带有公钥的篡改 jar，以便他们窃听服务器）。我曾假设这不是您试图保护的线程模型，并且客户是从受信任的来源获得 jar 的（例如，公司的工程师在他们的系统上安装了该程序）。如果他们通过 Internet 下载 jar，通过电子邮件等方式发送，那么您仍然需要*签名*带有 CA 颁发证书的 jar，即使在您的实际代码中，您也可以使用您在 jar 中分发的公钥进行连接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T04:16:24.683

我不明白。客户端应该已经有一个受信任的根证书存储，它们可以用来验证您的服务器。如果他们不这样做，服务器身份验证有什么意义？

匿名（且已弃用）密码套件，如`"TLS_DH_anon_WITH_AES_128_CBC_SHA"`，提供隐私。但是，这种配置*容易受到中间人*攻击。在某些内部网络上，它可能是安全的，但一般来说，应用层需要一些复杂的互锁协议来进行身份验证。

* * *

*更新以回应评论：*如果组织使用来自知名认证机构的服务器证书（即包含在内置密钥库中的证书），他们不必自己负责分发。（尽管在高安全性应用程序中，一些组织确实采取了额外的步骤来验证这些证书的完整性。）如果他们没有获得“真正的”证书——可能使用自签名证书——那么为了安全 组织必须提供一些带外机制来分发证书并确保它没有被更改。

# sql - 在另一列上使用 sum 时选择不同的 id？

> ID：839052
> 
> 赞同：2
> 
> 时间：2009-05-08T09:43:49.150
> 
> 标签：sql

一个订单可以由多行组成，因此 OrderId 不是唯一的。如何进行 SUM 而不必 GROUP BY 以使 SQL 正确解析？

```
SELECT DISTINCT OrderId, SUM(ProductPrice * ProductQuantity ) as Total
FROM OrderDetails
GROUP BY OrderId 
```

如果我取消 GROUP BY 线，那么我会得到

```
'OrderDetails.OrderId' is invalid in the select list because it is not contained in either an aggregate function or the GROUP BY clause. 
```

**编辑**

我想要的结果是，如果一个订单包含 2 个产品，那么它应该输出两行。

group by 正在输出 1 行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-08T09:47:07.723

你不需要独特的。
对额外的列进行求和/计数时，您必须有一个 group by
您将通过 group by 获得每个订单的总数。

所以
1-20.00
1-30.00
2-10.00

将得到
1-50.00
2-10.00

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T09:46:54.760

你没有订单表吗？

通常订单包含订单和详细信息（订单行），因此您应该改为与主表进行连接。这应该有效。

```
SELECT O.OrderID,  SUM(Od.ProductPrice * OD.ProductQuantity ) as Total
FROM Orders AS O INNER JOIN OrderDetails AS OD ON O.orderID = OD.OrderID
group by O.OrderID 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T09:50:16.657

如果您选择一个非聚合列（在这种情况下`OrderID`）和一个聚合列（`SUM(xxx)`），那么您必须对非聚合列进行分组...

但是当您分组时，OrderID 无论如何都会不同，因为它会将每个 orderID 的所有其他值组合在一起。

# wpf - 需要滚动一个 WPF Grid

> ID：839062
> 
> 赞同：3
> 
> 时间：2009-05-08T09:47:30.157
> 
> 标签：wpf, scroll, grid

我想在 WPF 页面中创建两个网格。`Grid`需要滚动条或滚动查看器。另一个`Grid`是静态的。网格在页面中一个一个放置。如何首先创建和设置滚动`Grid`？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2010-03-08T07:45:24.773

```
<ScrollViewer>  
    <StackPanel>  
        ...   
    </StackPanel>  
</ScrollViewer> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-07-29T18:46:34.283

听起来这个用户只是希望第一个网格滚动，例如：

```
<StackPanel>
    <ScrollViewer>
        <Grid>
        </Grid>
    </ScrollViewer>
    <Grid>
    </Grid>
</StackPanel> 
```

# c# - .net 不可变对象

> ID：839066
> 
> 赞同：5
> 
> 时间：2009-05-08T09:49:12.913
> 
> 标签：c#, reflection, properties

我想通过以下测试强制执行我的代码库不可变规则

```
[TestFixture]
public class TestEntityIf
{
    [Test]
    public void IsImmutable()
    {
        var setterCount =
            (from s in typeof (Entity).GetProperties(BindingFlags.Public | BindingFlags.Instance)
             where s.CanWrite
             select s)
                .Count();

        Assert.That(setterCount == 0, Is.True, "Immutable rule is broken");
    }
} 
```

它通过：

```
public class Entity
{
    private int ID1;
    public int ID
    {
        get { return ID1; }
    }
} 
```

但不是为了这个：

```
public class Entity
{
    public int ID { get; private set; }
} 
```

问题来了：“WTF？”

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-08T10:00:44.853

问题是，该属性是公共的 - 因为公共 getter - 它是可写的 - 因为私有 setter。您将不得不改进您的测试。

此外，我想补充一点，您不能以这种方式保证不变性，因为您可以修改方法内部的私有数据。为了保证不变性，您必须检查所有字段是否都声明为只读并且没有自动实现的属性。

```
public static Boolean IsImmutable(this Type type)
{
    const BindingFlags flags = BindingFlags.Instance |
                               BindingFlags.NonPublic |
                               BindingFlags.Public;

    return type.GetFields(flags).All(f => f.IsInitOnly);
}

public static Boolean IsImmutable(this Object @object)
{
    return (@object == null) || @object.GetType().IsImmutable();
} 
```

使用此扩展方法，您可以轻松测试类型

```
typeof(MyType).IsImmutable() 
```

和实例

```
myInstance.IsImmutable() 
```

因为它们的不变性。

**笔记**

*   查看实例字段允许您拥有可写属性，但确保现在有可以修改的字段。
*   由于私有的匿名支持字段，自动实现的属性将无法通过预期的不变性测试。
*   您仍然可以`readonly`使用反射修改字段。
*   也许应该检查所有字段的类型是否也是不可变的，因为这些对象属于状态。
*   `FiledInfo.FieldType.IsImmutable()`由于可能的循环和基本类型是可变的，这不能通过简单的所有字段来完成。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-08T10:03:12.367

你可能需要打电话

```
propertyInfo.GetSetMethod().IsPublic 
```

因为 set-method 和 get-method 没有相同的访问修饰符，所以您不能依赖 PropertyInfo 本身。

```
 var setterCount =
        (from s in typeof (Entity).GetProperties(
           BindingFlags.Public 
           | BindingFlags.NonPublic 
           | BindingFlags.Instance)
         where 
           s.GetSetMethod() != null       // public setter available
         select s) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-08T10:20:09.690

对其他地方发布的答案的小修改。如果至少有一个属性具有受保护或公共设置器，则以下将返回非零值。请注意检查 GetSetMethod 返回 null（无 setter）和检查 IsPrivate（即非公共或受保护）而不是 IsPublic（仅限公共）。

```
 var setterCount =
           (from s in typeof(Entity).GetProperties(
              BindingFlags.Public
              | BindingFlags.NonPublic
              | BindingFlags.Instance)
            where
              s.GetSetMethod(true) != null // setter available
              && (!s.GetSetMethod(true).IsPrivate)
            select s).Count(); 
```

然而，正如[Daniel Brückner 的回答所指出的那样](https://stackoverflow.com/questions/839066/net-immutable-objects/839113#839113)，一个类没有公开可见的属性设置器这一事实是该类被认为是不可变的必要条件，但不是充分条件。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-08T09:57:10.803

我认为原因是 CanWrite 说如果有 setter 则返回 true。私人二传手也是二传手。

让我有点吃惊的是第一次通过，因为它有一个公共设置器，所以除非我的咖啡因仍然太低，否则设置器计数为 1，因此断言应该失败。它们都应该失败，因为 CanWrite 只为两者返回 true。（并且 linq 查询只是检索公共属性，包括 ID，因为它是公共的）

（编辑）我现在看到您更改了第一类的代码，所以它不再有二传手了。

所以事情是你假设 CanWrite 查看 setter 方法的访问器，事实并非如此。你应该做：

```
var setterCount =
            (from s in typeof (Entity).GetProperties(BindingFlags.Public | BindingFlags.Instance)
             where s.GetSetMethod().IsPublic
             select s)
                .Count(); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-08T10:06:07.973

我建议将财产状况更改为：

```
s.CanWrite && s.GetSetMethod().IsPublic 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-08T09:53:36.803

第二个肯定是你`private set`的。

首先，类的实例`Entity`可以将其 ID1 属性写入外部类。

在后者中，setter 对类本身是私有的，因此只能从 Entity 内部调用（即它自己的构造函数/初始化程序）

在第二个中取出`private`你的二传手，它应该通过

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-08T10:03:37.717

如果我理解正确，您希望 Entity 是不可变的。如果是这样，则应将测试更改为

```
var setterCount = (from s in typeof(string).GetProperties(BindingFlags.Public | BindingFlags.Instance).Select(p => p.GetSetMethod())
    where s != null && s.IsPublic
    select s).Count();

Assert.That(setterCount == 0, Is.True, "Immutable rule is broken"); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-08T10:19:16.507

您是否尝试过调试它以查看您的 LINQ 查询返回了哪些 CanWrite 属性为 true 的属性？显然，它正在拾取你意想不到的东西。有了这些知识，您就可以使您的 LINQ 查询更有选择性，以按照您希望的方式工作。另外，我同意@Daniel Bruckner 的观点，即除非字段也是只读的，否则您的课程并非完全可变。调用者可能会调用一个方法或使用一个 getter，它可能会在内部修改通过 getter 公开公开为只读的私有字段，这会破坏不可变规则，让客户感到意外，并导致问题。对可变对象的操作不应该有副作用。

# gdata-api - Google 通讯录 API - 风险太大？

> ID：839068
> 
> 赞同：3
> 
> 时间：2009-05-08T09:49:22.040
> 
> 标签：gdata-api, import-contacts

我正在考虑将 Google Contacts API 用于 web 应用程序，但我担心用户可能会遇到糟糕的体验，这可能会归咎于我。

我打算以负责任的方式使用这些数据，我可能会因为别人滥用它而受到指责。其他人有这个吗？你对此做了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T09:58:08.853

你可能对此无能为力，但我不会担心。在您提到的情况下，问题出在哪里很明显-人们不会在一周内注册那么多网站。即使对于某个用户来说确实发生了巧合，当他们搜索时，他们也不会找到您找到的所有垃圾邮件引用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T10:06:23.683

回答这个问题：你能保护你的 webapp 免受所有黑客的攻击吗？你比外面的任何罪犯都聪明吗？

如果不是，那么数据将不安全。犯罪分子会想出巧妙的方法从网络数据中勒索收入。如果我必须申请一份新工作，我可以让 StackOverflow 为我创建一份简历——他们拥有所有必要的数据，但那是因为我想要它。所以这可能没问题。但是有些病态的人可能会在我的帖子中找到一些我从未想过的模式——词频、帖子的长度、答案的复杂性、发布的时间——以扣除一些我不想要的更多信息公开。

所以更好的问题是：收入（你想要的）值得冒险吗？如果除了责备之外你没有得到任何数据，为什么要收集它？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T10:11:40.160

我认为这个问题通常会让人们对第三方联系人应用程序感到害羞，因此你应该避免让你的应用程序依赖它。

阅读了您的故事后，我可以肯定地告诉您，现在我永远不会让*任何*第三方应用程序以*任何*理由通过 API 访问我的联系人。

# python - python3k中的sqlite3中的cursor.rowcount总是-1

> ID：839069
> 
> 赞同：34
> 
> 时间：2009-05-08T09:49:27.173
> 
> 标签：python, database, sqlite

我试图在我的 Python3k 程序中得到`rowcount`a `sqlite3` `cursor`，但我很困惑，因为`rowcount`总是`-1`如此，尽管 Python3 文档说了什么（实际上它是矛盾的，它应该是`None`）。即使在获取所有行之后，`rowcount`仍停留在`-1`. 它是一个`sqlite3`错误吗？我已经检查了表中是否有行。

我可以绕过这个检查 a`fetchone()`返回的东西是否不同于`None`，但我认为这个问题很适合讨论。

谢谢。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-05-08T11:33:06.813

从[文档](http://docs.python.org/3.0/library/sqlite3.html#sqlite3.Cursor.rowcount)中：

> 根据 Python DB API 规范的要求，rowcount 属性“如果没有在游标上执行 executeXX() 或最后一个操作的行数无法由接口确定，则为 -1”。
> 
> **这包括`SELECT`语句，因为在获取所有行之前，我们无法确定查询产生的行数。**

这意味着**所有** `SELECT`语句**都没有`rowcount`**. 您观察到的行为已记录在案。

**编辑：**文档没有说明在您执行之后`rowcount` **会**更新的任何地方，`fetchall()`因此假设是错误的。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2014-02-17T19:57:48.027

```
cursor = newdb.execute('select * from mydb;')
print len(cursor.fetchall()) 
```

fetchall() 将返回从选择返回的行列表。该列表的 Len 将为您提供行数。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2016-06-13T11:21:05.893

这样可以更好地计算行数：

```
 print cur.execute("SELECT COUNT(*) FROM table_name").fetchone()[0] 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-05-10T15:50:09.773

我建议不要“检查 fetchone() 是否返回与 None 不同的东西”，而是：

```
cursor.execute('SELECT * FROM foobar')
for row in cursor:
   ... 
```

这是-only （在其他 DB API 实现中不支持），但对于 - 特定的Python 代码`sqlite`非常方便（*并且有*完整的文档，请参阅[http://docs.python.org/library/sqlite3.html](http://docs.python.org/library/sqlite3.html)）。`sqlite`

 ** * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-05-02T11:30:04.217

我花了太长时间试图找到这个，如果你使用这条线，你会想要使用`.rowcount`它应该适合你。我用它来检查我的语句是否会返回任何数据。

```
 if (len(cursor.execute(sql).fetchall())) < 1: # checks there will be data by seeing if the length of the list make when getting the data is at least 1
        print("No data gathered from statement") #
    else:
       #RUN CODE HERE 
```

* * *

## 回答 #6

> 赞同：-6
> 
> 时间：2017-01-13T01:31:52.807

使用 PYCharm，在调试模式下，如果您将光标放在光标变量上，则会出现一个小 +，当您单击它时，您会看到对象的不同属性。

在我的 1 个元素的光标中，我看到：

```
rowcount={int}
arraysize={int}1 
```

因此，在您的代码中，只需使用：

```
print(cursor.arraysize)
1 
```

# random - Java API 中是否有 .Net 框架的 Random.Next(Int32, Int32) 等效项？

> ID：839073
> 
> 赞同：2
> 
> 时间：2009-05-08T09:50:17.873
> 
> 标签：random, java

我正在将现有的 VB.Net 应用程序移植到 Java，但找不到与 Random.Next(Int32, Int32) 等效的应用程序。

我只能`java.util.Random.next(int val)`在 Java API 中找到。

Java API 中是否有 .Net 框架的 Random.Next(Int32, Int32) 等效项？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-08T09:54:09.143

正如 Marc 所说，只需`Random.nextInt(int)`进行一些健全性检查即可适应：

```
public static int nextInt(Random rng, int lower, int upper) {
    if (upper < lower) {
        throw new IllegalArgumentException();
    }
    if ((long) upper - lower > Integer.MAX_VALUE) {
        throw new IllegalArgumentException();
    }
    return rng.nextInt(upper-lower) + lower;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-08T09:53:37.943

不，但你可以这样：

```
public static int randomInRange(int min, int max){
      return min+Random.next(max-min);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-08T09:54:20.513

考虑 Apache Commons Lang 的 RandomUtils：

[http://commons.apache.org/lang/apidocs/org/apache/commons/lang/math/RandomUtils.html](http://commons.apache.org/lang/apidocs/org/apache/commons/lang/math/RandomUtils.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-08T09:52:15.170

那么，您可以使用[Random.nextInt(int)](http://java.sun.com/j2se/1.4.2/docs/api/java/util/Random.html#nextInt(int))指定范围，然后只添加最小值？即 rand.nextInt(12) + 5

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-08T09:54:18.953

调用`Random.Next(x, y)`可以翻译成类似`Random.nextInt(y - x) + x;`

# delphi - 将带有特殊字符的 Delphi DFM 迁移到 D2009

> ID：839076
> 
> 赞同：4
> 
> 时间：2009-05-08T09:51:04.750
> 
> 标签：delphi, unicode, delphi-2009, dfm, ohm

我有许多 Delphi 表格，其中我们使用了几个特殊字符——“度”符号和“欧姆”符号。这些字符用于保存在 DFM 文件中的标签标题中，不会在运行时生成或修改。回到我们第一次设计这些形式的时候，度数符号很简单，因为它在 Ansi 字符集（代码 176）中，但欧姆符号需要希腊字符集才能与代码 217 一起使用。幸运的是（我们发现）我们发现的所有其他字符需要（字母和数字）与希腊字符集配合得很好。

现在我们希望这些表单在 D2009 中看起来相同。度数符号看起来很好，但欧姆符号显示“Ù”，因为 dfm 文本是“Caption = 'Typed in Ohms - 1234 '#217”。我发现我可以编辑表格以输入正确的 unicode 欧姆符号（8486），但当然这会丢失为“？” 回到 D7 时。理想情况下，我想告诉 D2009 继续使用带有表格的希腊字符集，以便 dfm 中的 #217 映射到欧姆符号。这可能吗？它似乎忽略了“GREEK_CHARSET”的 Font.Charset 设置。我发现了一种解决此问题的肮脏方法，即遍历所有组件并执行“S​​tringReplace（S，'Ù'，OhmsChar，[rfReplaceAll]）”，但这太可怕了，肯定有更好的方法吗？

谢谢，布赖恩

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-08T15:16:59.093

使用[dxgettext](http://dxgettext.po.dk/)解决了我遇到的类似问题。我没有使用有问题的标题，而是使用了干净的 ascii（例如，“Typed in Ohms”），然后将它们翻译成 po 文件，作为资源嵌入到 exe 中。

顺便说一句，[dxgettext](http://dxgettext.po.dk/)是一种向应用程序添加翻译的好方法，只需很少的开销和标准格式 (po/mo) 以及良好的 3p 编辑器 (poEdit)。适用于 D7 和 D2009。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-08T15:15:15.603

正如布鲁斯已经提到的，您可以使用代码来提供这些值。我只是举一个例子和一些额外的信息。

```
resourcestring
{$IFDEF UNICODE}
  cOhm = unicodeohm;        // replace with correct values.
  cDegree = unicodedegree;
{$ELSE}
  cOhm = ansiohm;
  cDegree = ansidegree; 
```

我建议对可翻译文本使用资源字符串而不是 const，因为大多数翻译工具都使用资源。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-08T12:57:53.203

我发现最干净的方法是在代码中填充这些“特殊”标题，如果需要，您可以在其中使用 IFDEF。

# xml - XSD all 和 XSD 序列之间的中间方式

> ID：839079
> 
> 赞同：26
> 
> 时间：2009-05-08T09:52:19.287
> 
> 标签：xml, xsd

我正在使用 XSD 定义用户元素。对于此示例，用户具有姓名、电子邮件和一个或多个国籍。我试过了：

```
<xs:all>
  <xs:element name="name" blabla />
  <xs:element name="email" blabla />
  <xs:element name="nationality" minOccurs="1" maxOccurs="unbounded" />
</xs:all> 
```

然而，这是非法的。显然，“全部”中的元素只能出现一次（或根本不出现）。我可以通过将 All 更改为 Sequence 来解决这个问题，但是人们必须按照确切的顺序输入属性，我实际上并不关心。

有没有这两者的组合可用？不是根据[http://www.w3schools.com/Schema/schema_complex_indicators.asp](http://www.w3schools.com/Schema/schema_complex_indicators.asp)，但也许它是隐藏的（或者我没有经验的眼睛看不到它）。

凭直觉，我也尝试过：

```
<xs:all>
  <xs:element name="name" blabla />
  <xs:element name="email" blabla />
  <xs:sequence>
    <xs:element name="nationality" minOccurs="1" maxOccurs="unbounded" />
  </xs:sequence>
</xs:all> 
```

但不幸的是，这是无效的。

* * *

这是当前的、真实的 XSD：

```
 <!-- user -->
  <xs:complexType name="user">
    <xs:sequence>
      <xs:element name="firstname" type="xs:string" minOccurs="1" maxOccurs="1" />
      <xs:element name="appendix" type="xs:string" minOccurs="0" maxOccurs="1" />
      <xs:element name="lastname" type="xs:string" minOccurs="1" maxOccurs="1" />
      <xs:element name="address" type="xs:string" minOccurs="1" maxOccurs="1" />
      <xs:element name="zipcode" type="xs:string" minOccurs="1" maxOccurs="1" />
      <xs:element name="city" type="xs:string" minOccurs="1" maxOccurs="1"/>
      <xs:element name="username" type="xs:string" minOccurs="1" maxOccurs="1"/>
      <xs:element name="email" type="xs:string" minOccurs="1" maxOccurs="1"/>
      <xs:element name="country" type="country" minOccurs="1" maxOccurs="1"/>
      <xs:element name="nationality" type="xs:string" minOccurs="1" maxOccurs="unbounded"/>
    </xs:sequence>
  </xs:complexType> 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-05-08T10:00:06.397

你能不能把你的“国籍”东西变成它自己的 complexType，然后在你的 xs:all 中使用那个新的复杂类型？

```
<xs:complexType name="NationalityType">
  <xs:sequence>   
    <xs:element name="nationality" minOccurs="1" maxOccurs="unbounded" />
  </xs:sequence>
</xs:complexType>

<xs:all>
  <xs:element name="name" blabla />
  <xs:element name="email" blabla />
  <xs:element name="nationalities" type="NationalityType" />
</xs:all> 
```

我手头没有任何东西可以测试这个，所以这真的只是我的头顶......试一试！

编辑：现在测试它 - 它可以工作，唯一要付出的小代价是你的 XML 必须看起来像这样：

```
<....>
  <email>......</email>
  <nationalities>
    <nationality>ABC</nationality>
    <nationality>CDE</nationality>
  </nationalities>
  <name>.....</name>
</.....> 
```

所以你得到一个额外的节点，它将包含任意长的`<nationality>`项目列表。

马克

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2011-11-28T14:28:29.077

只是遇到了一个类似的问题（我想以任意顺序排列任意数量的每个元素）并通过一系列选择来解决它。使用上面的示例：

```
<?xml version='1.0' encoding='UTF-8'?>
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <xs:element name='user'>
    <xs:complexType>
      <xs:sequence minOccurs="0" maxOccurs="unbounded">
        <xs:choice>
          <xs:element name="name" type="xs:string" />
          <xs:element name="email" type="xs:string" />
          <xs:element name="nationality" />
        </xs:choice>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
</xs:schema> 
```

这允许您以任意顺序拥有任意数量的姓名、电子邮件和国籍。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-12-03T20:43:19.410

我认为您正在寻找的内容会违背 XML 的意图。有这样一个有效的 XML 片段似乎很奇怪：

```
<user>
  <nationality/>
  <name/>
  <nationality/>
  <email/>
  <nationality/>
</user> 
```

听起来你在要求类似 marc_s 提议的东西：

```
<user>
  <name/>
  <email/>
  <nationality/>
  <nationality/>
  <nationality/>
<user> 
```

这需要被推入：

```
<user>
  <name/>
  <email/>
  <nationalities>
     <nationality/>
     <nationality/>
     <nationality/>
  </nationalities>
<user> 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-09T16:47:19.850

您的代码应该在 XSD 1.1 中有效。对于 XSD 1.0，您必须找到一种解决方法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-08-12T06:19:28.463

对于 XSD 1.0，leppie 的建议有效。

XSD

```
<?xml version='1.0' encoding='UTF-8'?>
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <xs:element name='user'>
    <xs:complexType>
      <xs:sequence>
        <xs:element name="name" type="xs:string" />
        <xs:element name="email" type="xs:string" />
        <xs:choice minOccurs='0' maxOccurs='unbounded'>
          <xs:element name="nationality" />
        </xs:choice>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
</xs:schema> 
```

针对架构进行验证的示例 XML 文档

```
<user>
  <name>Name</name>
  <email>name@name.com</email>
  <nationality>Italian</nationality>
  <nationality>Japanese</nationality>
  <nationality>Alien</nationality>
</user> 
```

和验证，例如使用**xmllint**

```
xmllint --noout --schema test.xsd test.xml
test.xml validate 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-08T12:32:48.083

或者，既然“USER”会设置多个子元素，为什么不设置成复杂类型呢？像这样的东西应该工作。

```
<xs:complexType>
  <xs:sequence>
    <xs:element name="Name" type="xs:string" />
    <xs:element name="Password" type="xs:string" />
    <xs:element minOccurs="1" maxOccurs="unbounded" name="Nationality" type="xs:string" />
  </xs:sequence>
</xs:complexType> 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-05-08T12:57:27.790

`xs:choice`行不通？如果没有，只需将其按顺序包装，反之亦然。

# sql-server - 向现有用户 SQL server 2008 添加新角色

> ID：839081
> 
> 赞同：0
> 
> 时间：2009-05-08T09:52:44.373
> 
> 标签：sql-server, sql-server-2008

我正在使用 VB.net 应用程序以编程方式附加一个新数据库。我编写了数据库脚本并使用命令对象执行它们。附加数据库后，我必须创建登录名并添加角色。如果要创建的登录名已经存在于该目标 SQL 服务器上，那么我只是使用 (EXEC SP_addrolemember) 添加角色，问题从这里开始。角色被添加到用户，但它只显示在我刚刚附加的数据库中。IE-

在管理工作室 -> 数据库 -> （（新附加的数据库）） -> 安全 -> 用户

但它没有添加到主 SQL 服务器中，即 -

在管理工作室 -> 安全 -> 登录 -> （（用户名））

当我双击“用户映射”下的主 sql 服务器登录中的用户名时，我没有找到附加的角色。它仅在我附加的数据库下更新。因此，当我尝试使用现有用户凭据打开新附加的数据库时，它会说拒绝访问新附加的数据库！

有没有办法解决这个问题？？

提前致谢

赛

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T10:04:27.900

我有类似的问题，我恢复了一个包含用户的数据库，并且在 sql 安全性下存在一个冲突的用户。我发现这个[链接](http://blog.sqlauthority.com/2007/02/15/sql-server-fix-error-15023-user-already-exists-in-current-database/)提供了答案。

# xml - 如何让 Nokogiri 了解我的命名空间？

> ID：839082
> 
> 赞同：5
> 
> 时间：2009-05-08T09:52:51.190
> 
> 标签：xml, ruby, xpath, nokogiri

我有以下 XML 文档：

```
<samlp:LogoutRequest ID="123456789" Version="2.0" IssueInstant="200904051217">
  <saml:NameID>@NOT_USED@</saml:NameID>
  <samlp:SessionIndex>abcdefg</samlp:SessionIndex>
</samlp:LogoutRequest> 
```

我想从中获取`SessionIndex`（即'abcdefg'）的内容。我试过这个：

```
XPATH_QUERY = "LogoutRequest[@ID][@Version='2.0'][IssueInstant]/SessionIndex"
SAML_XMLNS  = 'urn:oasis:names:tc:SAML:2.0:assertion'
SAMLP_XMLNS = 'urn:oasis:names:tc:SAML:2.0:protocol'

require 'nokogiri'
doc = Nokogiri::XML(xml)
doc.xpath(XPATH_QUERY, 'saml' => SAML_XMLNS, 'samlp' => SAMLP_XMLNS) 
```

但我收到以下错误：

```
Nokogiri::XML::SyntaxError: Namespace prefix samlp on LogoutRequest is not defined
Nokogiri::XML::SyntaxError: Namespace prefix saml on NameID is not defined
Nokogiri::XML::SyntaxError: Namespace prefix samlp on SessionIndex is not defined 
```

我已经尝试将命名空间添加到 XPath 查询中，但这并没有改变任何东西。

为什么我不能让 Nokogiri 相信命名空间是有效的？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2010-08-20T18:30:48.220

我为您看到了两种不同的选择：

1.  删除所有命名空间

    [http://www.rubydoc.info/github/sparklemotion/nokogiri/Nokogiri/XML/Document#remove_namespaces%21-instance_method](http://www.rubydoc.info/github/sparklemotion/nokogiri/Nokogiri/XML/Document#remove_namespaces%21-instance_method)

    蛮力的做法。可能会导致存在命名空间冲突的问题。

2.  使用 collect_namespaces

    [http://www.rubydoc.info/github/sparklemotion/nokogiri/Nokogiri/XML/Document#collect_namespaces-instance_method](http://www.rubydoc.info/github/sparklemotion/nokogiri/Nokogiri/XML/Document#collect_namespaces-instance_method)

    一个更好的解决方案。您可以使用它一次来识别名称空间（例如在 irb 中）并对其进行硬编码。

    或者

    在运行时使用它，并将其作为第二个参数提供给[https://www.rubydoc.info/github/sparklemotion/nokogiri/Nokogiri/XML/Searchable#xpath-instance_method](https://www.rubydoc.info/github/sparklemotion/nokogiri/Nokogiri/XML/Searchable#xpath-instance_method)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-08T16:18:31.380

看起来本文档中的命名空间没有正确声明 -根节点上应该有`xmlns:samlp`和属性。`xmlns:saml`在这种情况下，Nokogiri 基本上会忽略名称空间（因为它无法将它们映射到 URI 或 URN），因此如果您删除它们，您的 XPath 就可以工作，即

```
doc.xpath(XPATH_QUERY) 
```

# html - CSS：Div 位置：相对对齐问题

> ID：839085
> 
> 赞同：4
> 
> 时间：2009-05-08T09:53:41.170
> 
> 标签：html, css

我对 div 位置相对对齐有疑问。

即使我删除了第一个 div，我也希望将第二个 div 固定到位。问题是当第一个 div 被移除时，第二个 div 会调整其位置。

我的问题是，即使我删除了第一个 div，我如何才能保留第二个 div 的位置？谢谢 ：）

这段代码：

```
<div style="border: 1px solid red;width:400px;height:150px;margin:0px auto;" >

    <div style="border: 1px solid red; position: relative;
    width: 262px; height: 20px; top: 20px; left: 20px;">div-1</div> 

    <div style="border: 1px solid red; position: relative;
    width: 262px; height: 20px; top: 60px; left: 20px;">div-2</div>
</div> 
```

将输出：

![替代文字](https://farm4.static.flickr.com/3660/3512692766_539e6b4f8d_o.jpg)

然后如果第一个 div 被移除，第二个 div 会调整它的位置。这段代码：

```
<div style="border: 1px solid red;width:400px;height:150px;margin:0px auto;" >

    <div style="border: 1px solid red; position: relative;
    width: 262px; height: 20px; top: 60px; left: 20px;">div-2</div>
</div> 
```

将输出： ![替代文字](https://farm4.static.flickr.com/3645/3512692796_2e0a7afb1d_o.jpg)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-08T10:22:01.650

如果将外部元素的定位设置为相对，则其内部的绝对定位元素将相对于封闭元素定位：

```
<div style="border: 1px solid red;width:400px;height:150px;margin:0px auto; position:relative" >
    <div style="border: 1px solid red; position: absolute;
    width: 262px; height: 20px; top: 20px; left: 20px;">div-1</div>
    <div style="border: 1px solid red; position: absolute;
    width: 262px; height: 20px; top: 60px; left: 20px;">div-2</div>
</div> 
```

现在您可以删除 div1 并且 div2 不会移动。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T10:06:17.133

使用绝对定位，这将使内部 div 的位置相对于父 div（也称为包含块）是绝对的。

我建议不要使用内联样式并使用样式表：

```
<style type="text/css">
    #top 
    {
        position:relative;
        border: 1px solid red;
        width:400px;
        height:150px;
        margin:0px auto;
    }

    #child1, #child2
    {
        position: absolute;
        border: 1px solid red;
        width: 262px;
        height: 20px;
        left: 20px;
    }

    #child1 
    { top: 20px; }
    #child2
    { top: 60px; }
</style>    

 <div id="top">
    <div id="child1">div-1</div>
    <div id="child2">div-2</div>
</div> 
```

[http://kilianvalkhof.com/2008/css-xhtml/understanding-css-positioning-part-1/](http://kilianvalkhof.com/2008/css-xhtml/understanding-css-positioning-part-1/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T10:14:50.527

您可以使用绝对定位 - position:absolute 或 display:none (css)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-09T13:02:15.670

您可以将 DIV1 上的[可见性 CSS 属性](http://www.w3schools.com/CSS/pr_class_visibility.asp)设置为隐藏，即使不可见，它也会占用页面上的原始空间量。

```
<div style="border: 1px solid red;width:400px;height:150px;margin:0px auto;" >
    <div style="border: 1px solid red; position: relative;
    width: 262px; height: 20px; top: 20px; left: 20px;
    visibility:hidden;">div-1</div>
    <div style="border: 1px solid red; position: relative;
    width: 262px; height: 20px; top: 60px; left: 20px;">div-2</div>
</div> 
```

# java - 如何将 HTML 作为 GET-Request 参数发送？

> ID：839090
> 
> 赞同：1
> 
> 时间：2009-05-08T09:54:34.977
> 
> 标签：java, http, encoding, httpclient

我想用 Apaches HttpClient 发送一个带有 GET 请求的 html 字符串：

```
http://sample.com/?html=<html><head>... 
```

目前这不起作用，我认为这是一个编码问题。你有什么想法吗？

```
method.setQueryString(new NameValuePair[] {new NameValuePair("report", "<html>....")});
client.executeMethod(method) 
```

这失败了`org.apache.commons.httpclient.NoHttpResponseException: The server localhost failed to respond`。如果我用`"<html>"`“test..”替换它，它工作正常。

**编辑**

编码后似乎是URL长度的问题，服务器除了这么长的URL之外没有。将其作为 POST 发送可以解决问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-08T09:57:45.110

首先尝试使用 URL 编码来格式化您的 html 字符串。

```
String yourHtmlString = java.net.URLEncoder.encode("<html>....");
method.setQueryString(new NameValuePair[] {new NameValuePair("report", yourHtmlString)}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-08T10:03:23.770

我会使用 base64 编码，并且可能会在它之前进行某种压缩，具体取决于给定内容的长度：

RFC 2068 规定：服务器应谨慎对待超过 255 字节的 URI 长度，因为一些较旧的客户端或代理实现可能无法正确支持这些长度。URL 长度规范没有规定最小或最大 URL 长度，但实现因浏览器而异。在 Windows 上：Opera 支持 ~4050 个字符，IE 4.0+ 正好支持 2083 个字符，Netscape 3 -> 4.78 在导致关闭错误之前最多支持 8192 个字符，而 Netscape 6 在导致启动错误之前支持 ~2000 个字符。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-08T10:01:10.403

HTML 字符串包含应进行 URL 编码的字符。[在这里](http://java.sun.com/j2se/1.5.0/docs/api/java/net/URLEncoder.html)阅读。

您可以使用[UrlUtils.simpleFormUrlEncode进行编码](http://hc.apache.org/httpcomponents-client/httpclient/apidocs/org/apache/http/client/utils/URLUtils.html#simpleFormUrlEncode(org.apache.http.NameValuePair[],%20java.lang.String))

# c# - 从 C# 中的 ParameterInfo 数组中删除元素

> ID：839093
> 
> 赞同：0
> 
> 时间：2009-05-08T09:54:53.790
> 
> 标签：c#

我有一个 ParameterInfo 数组。我需要从数组中删除某些值。我怎样才能做到这一点。？

考虑我有， ParameterInfo[] pi 包含值，

```
{Int32 param1}
{System.String param2}
{System.Collections.Hashtable param3} 
```

我需要从数组中删除第二个值，即 {System.String param2}。我怎样才能做到这一点。？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-08T09:58:20.990

您不能从数组中删除项目。但是，您可以创建一个没有该项的新数组。可能最方便（但不一定有效）的方式是通过列表：

```
List<ParameterInfo> list = new List<ParameterInfo>(args);
list.RemoveAt(1);
args = list.ToArray(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-08T10:00:03.700

您实际上不能从数组中*删除元素，因为数组是固定大小的。*但是，您可以创建一个省略旧元素的新数组：

```
public static T[] RemoveElement<T>(T[] original, int elementToRemove)
{
    T[] ret = new T[original.Length-1];
    Array.Copy(original, 0, ret, 0, elementToRemove);
    Array.Copy(original, elementToRemove+1, ret, elementToRemove,
               ret.Length - elementToRemove);
    return ret;
} 
```

# http - WWW 或无 WWW 的技术/编程/非 SEO 优缺点？

> ID：839095
> 
> 赞同：4
> 
> 时间：2009-05-08T09:55:36.330
> 
> 标签：http

对于域和子域，www 或无 www的**技术/编程/非 SEO**优缺点是什么？

来自 Jeff Atwood 在[http://twitter.com/codinghorror/status/1637428313](http://twitter.com/codinghorror/status/1637428313)的推特：
“有点后悔没有 www 的选择，因为它会导致向所有子域提交完整的 cookie。:(”
这是什么意思？有博客吗？帖子或文章详细说明了这一点？

**对于 www. 与无 www。**

**更新**：
在搜索有关此主题的更多信息时，我发现以下内容很有帮助（除了 Laurence Gonsalves 的回答）：

*   [删除 WWW 前缀](https://blog.stackoverflow.com/2008/06/dropping-the-www-prefix/)
*   对搜索结果的影响：[Jivlain](https://blog.stackoverflow.com/2008/06/dropping-the-www-prefix/#comment-1340)和[Isaac Lin 的](https://blog.stackoverflow.com/2008/06/dropping-the-www-prefix/#comment-1361)评论
*   [为组件使用无 Cookie 域](http://developer.yahoo.com/performance/rules.html#cookie_free)
*   在 StackOverflow 上：[我是否应该将我的网站默认为 www.foo？](https://stackoverflow.com/questions/355217/should-i-default-my-website-to-www-foo-or-not)
*   在 StackOverflow 上：[什么时候应该使用“www”子域？](https://stackoverflow.com/questions/486621/when-should-one-use-a-www-subdomain)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-08T10:31:21.253

默认情况下，Cookie 仅限于设置它们的 URL 的主机。[因此，在“ http://example.com/foo.html](http://example.com/foo.html) ”上设置的 cookie可以被“example.com”上的其他页面看到，但不能被其他主机上的页面看到——甚至子域也不行。

可以为 cookie 设置域属性，使其对更多主机可见。此域属性必须以点开头，并且必须是设置 cookie 的页面的主机名的后缀。使用域属性设置的 Cookie（可能）对以域属性为后缀的主机上的页面可见。因此，如果 cookie 的域属性是“.example.com”，它将在“www.example.com”、“forums.example.com”、“foo.bar.example.com”上可见，但在“example.com ”上*不*可见”。因此，如果您从“example.com”提供您网站的一部分，则您无法制作对子域可见的 cookie，但如果您始终使用子域，那么您可以制作所有子域都可以看到的 cookie。

[您可以在RFC2965](http://www.ietf.org/rfc/rfc2965.txt)中找到非常详细但有点难以阅读的解释。我还找到了[一篇网站齿轮文章](http://content.websitegear.com/article/subdomain_tips.htm)，其中有一个非常清楚的解释。

# sqlite - 使用表中的更改更新列表视图

> ID：839096
> 
> 赞同：2
> 
> 时间：2009-05-08T09:55:55.830
> 
> 标签：sqlite, list, listview, wxwidgets

我有一个包含大量日志消息的 SQLite 数据库。

我想在列表视图中显示它（使用 wxWidgets）。

用户可以重新排序列表（通过按下列标题），对结果集应用过滤器，并使用滚动条像通常的列表一样浏览它。用户还可以选择列表中的一个或多个条目并删除它们。

我有一个虚拟列表模型：列表视图向模型询问特定行的内容。该模型使用当前过滤条件和顺序发出选择查询，并从结果中返回相应的行。

为了让它更快，我保留了结果的页面缓存：当请求一行时，我使用 LIMIT 和 OFFSET 获取整个页面（约 100 行）并从页面返回特定行。我存储了许多页面，下次请求一行时，我首先查看它是否在其中一个缓存页面中可用。事实证明，即使有*很多*条目（50k+），这种技术也能快速响应。

**问题**

我的问题是如何处理更新/插入/删除。我每个都有一个触发器，因此每当发生插入/更新/删除时都会通知模型。触发器还告诉模型受影响条目的 ID（主键）。

我的第一个版本只是在每次触发后对模型进行了完全重置。这不是很快，但足够快。问题是，如果用户选择了一行或几行，选择就会丢失。

模型的基类 (wxDataViewVirtualListModel) 包含在发生更改时应调用的方法：

*   RowInserted（行）
*   行已删除（行）
*   RowChanged（行）

如果我使用它们，选择问题将得到解决，但是存在问题：

*   我如何知道更改的行是否在当前过滤集中？
*   我如何知道列表视图中的哪一行受到了影响？

第一个问题可以通过创建一个检查条目是否属于集合的方法来解决。它的行为必须与 SQL 条件完全相同，但它是可行的。

第二个问题我根本不知道如何解决。

我使用了一个虚假的（0 或最后一行）行号来强制更新视图，但问题是如果在选择之前插入/删除了行，则选择之后指向错误的行，等等。

你会怎么做？在内存中保留包含所有条目的高级数据结构？

*这个问题与另一个问题有关： [显示大结果集](https://stackoverflow.com/questions/821506/display-large-result-set)*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T11:18:47.490

我将围绕两个不同的 SELECT 操作进行设计，一个只获取所有行的主键和时间戳（INSERT / UPDATE），另一个获取单页行的所有数据。在现代机器上，即使是 100000 行，在内存中保留完整的主键和时间戳列表也不应该成为问题。

每当过滤条件更改或触发器触发时，我都会再次检索主键和时间戳列表。该模型维护一个主键列表和匹配时间戳，模型与新列表之间的比较显示需要插入、无效或删除哪些行。时间戳已更改的缓存行将从缓存中删除，具有相同时间戳的缓存行无需再次检索。当缓存变得太大时，将删除最旧的缓存条目。

列表的选择可以通过其主键值来识别，因此除非该行已被删除，否则始终可以在更改模型后重新选择它，即使它现在处于完全不同的位置。我发现这比在排序更改时保持相同的行位置更直观，因为它选择了完全不同的行。

**编辑：**

这适用于来自其他数据库客户端的并发数据更改，我已经为使用 Firebird 数据库服务器的应用程序实现了这种方式。如果无法从外部更改数据，则可能不需要始终检索主键和时间戳的完整列表。

# iphone - 从实例化类 obj-c 调用启动器类中的方法

> ID：839099
> 
> 赞同：0
> 
> 时间：2009-05-08T09:56:29.073
> 
> 标签：iphone, objective-c, oop, class, delegates

我有一个按钮类 - 单击按钮时，将调用 MyAudio 类的 playFile 方法。所以我的问题是，从按钮类调用 playFile 方法很简单，但是如何从启动器类调用方法 displayStopButton 呢？

**按钮类**

```
- (void)myButtonClicked: (id)sender
{
    [MyAudio playFile];

}

-(void)enablePlayButton
{
  // test
} 
```

* * *

**我的音频类**

```
-(BOOL)playFile{

   // Init AVAudioPlayer
}

- (void)audioPlayerDidFinishPlaying: (AVAudioPlayer*)player successfully: (BOOL)flag
{

   // make a call back to calling class????

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T22:06:34.530

您所称的 Button 类看起来像您的控制器类。audioPlayerDidFinishPlaying 听起来像是一个也应该在控制器类中实现的方法。这样，您可以将控制器类设置为音频播放器类的委托，并且 audioPlayerDidFinishPlaying 方法的实现可以调用 [self displayStopButton]。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-09T21:22:09.483

您必须在控制器中保留要启用和禁用的所有控件的指针。使用这些手柄，您可以在收到来自音频子系统的通知时打开和关闭它们。

# wpf - WPF 的综合指南：MVVM 与 MVP

> ID：839118
> 
> 赞同：16
> 
> 时间：2009-05-08T10:01:17.317
> 
> 标签：wpf, design-patterns, mvvm, mvp, prism

我很困惑。也许你可以帮助我:)

我一直遵循 CAG 的指导，发现 MVP 模式对我来说非常自然。假设我有一个 UI 就绪模型（例如：实现 INotifyPropertyChanged），我使用演示者将此模型绑定到视图（演示者知道视图的接口），使我的代码隐藏尽可能小，仅处理绑定（模型和命令）属性（或方法）或没有 ICommand 的控件的事件，在这种情况下立即委托给演示者。

1.  一段时间后，我发现了 MVVM 模式，但到目前为止我还没有发现它。据我所知，我只会在我的模型未准备好 UI 时使用 MVVM。但是保留演示者并只使用新模型是否更合理，我不明白这种用法会失去什么。我知道我错过了一些东西，但它是什么:)。

2.  此外，当您的 View 是通用的并且可以处理多种模型（例如在 PropertyGrid 中）时。建议 ViewModel 与 DataTemplate 一起使用，但在这种情况下，您无法为模型中的每个实体创建模板，只需要在运行时进行调查，您会推荐什么？

3.  [看 Josh Smith 在截屏](http://joshsmithonwpf.wordpress.com/2008/03/04/craig-shoemaker-unveils-pixel8/)中讲 MVVM 的时候，我有一种感觉，在 ViewModel 中重新暴露 Model 违反了 DRY（不要重复），真的无法避免吗？[与现在 ADO.Net 动态数据元数据类](http://mtaulty.com/CommunityServer/blogs/mike_taultys_blog/archive/2009/05/01/metadata-classes-a-force-for-good-or-evil.aspx)的火焰相比，没有人对此争论不休，这让我感到惊讶。

希望它足够清楚

谢谢

爱丽儿

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-09-04T17:18:49.817

关于#3，很多人会使用“另一层间接”的说法，说模型的变化不会影响视图。虽然这在技术上是正确的，但这并不是这样做的真正原因。

如果您将模型视为您从数据访问层或服务（通常被认为是这些）返回的实体，您就会开始了解为什么需要 ViewModel。ViewModel 旨在***使用 View 需要的行为扩展模型***。

例如。如果您希望能够更改属性并通过绑定通知视图此更改，则该属性需要引发某种形式的 NotifyPropertyChanged 以便视图可以做出反应。这是您的典型模型不会有的行为。

在另一个示例中，假设您有一个集合，并且当用户单击视图中该项目旁边的复选标记时，您希望使用布尔值标记该集合中的每个项目。您可能需要一个“IsSelected”属性。这是模型不应该提供的行为。

但是我知道你来自哪里......我一开始肯定有这个问题。我第一次将模型的内容复制并粘贴到我的视图模型中时，我的胃转了，但你只需要接受这样一个事实，即要让视图工作，它需要模型应该有的这种额外行为不提供。

无论这是多么不干燥，强制您的 WCF 类型或 LINQ to SQL 类型（或任何您最喜欢的 ORM）来实现 INotifyProperyChanged 会更糟。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-09-02T00:34:34.413

除了上面的评论。我想分享一些我个人对差异的理解。

通常在 MVP 中你有一个 View 接口，例如。IView，用于抽象实际视图并将数据绑定到这些实际视图。相反，在 MVVM 中，您通常使用实际视图的 DataContext，例如。一个 XAML 用户控件，用于进行数据绑定，类似于 MVP 中的 IView。因此，假设不准确，两种模式的绑定相似。

主要区别在于 Presenter 与 ViewModel 部分。视图模型与演示者非常不同，演示者是 UI 和模型之间交换数据的桥梁。实际上，正如它的名字一样，它是视图的模型。ViewModel 中暴露的数据主要用于 UI 流程。所以据我了解，在 MVVM 中，ViewModel 是视图的抽象。与之相反，MVP 主要使用 IView 来抽象视图。所以通常 MVVM 中的层数比 MVP 少，因此您可以编写更少的代码来在 MVVM 中完成相同的工作：

MVVM: Model - ViewModel(代表实际视图，即UI) - Actual Views

MVP：Model - Presenter（模型和 UI 之间交换数据的桥梁） - IView（代表实际视图，即 UI） - Actual Views

MVVM 相对于 MVP 的优势主要基于 Microsoft 产品中的以下 2 个强大功能，

1.  WPF 中的命令。尽管已经有一些实现不在 Silverlight 运行时中，但它可能会在未来的 Silverlight 中可用

2.  WPF 和 Silverlight 中的 DataContext。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-08T10:57:01.580

广告 3。看起来你在 ViewModel 中暴露 Model 似乎是在重复自己，但你真正做的是抽象 Model，让 View 只知道这个抽象（View 只知道 ViewModel）。

这是因为对模型的更改不应破坏视图。此外，您的模型可以实现为从不同来源获取数据的许多不同服务。在这种情况下，您不希望 View 了解所有这些，因此您创建了另一个抽象 - ViewModel。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-08T10:47:01.823

如果演示者知道视图的界面，您要么需要演示者使用的所有视图具有相同的界面，要么为每个视图创建一个演示者。使用 MVVM，视图知道 viewModel，而 viewModel 知道模型（反之亦然）。这意味着多个视图可以使用一个 VM，多个 VM 可以使用一个模型。

我不太确定您在第二点中要问什么。VM 不是视图（或不知道视图），对我来说，DataTemplate 定义了对象的显示方式。我将我的 DataTemplates 放在绝对属于视图的 ResourceDictionary 中。我的 VM 层中唯一的 WPF“东西”是命令。

我需要更多信息来回答您的第三点。如果您深入了解 MVVM，也许它会自行回答。

[这是我的相关帖子，可能会对您有所帮助](https://stackoverflow.com/questions/833837/design-patterns-for-event-driven-logic/834198#834198)

祝你好运。

# c# - 后台线程上的新 System.Transactions.TransactionScope() 停止程序

> ID：839119
> 
> 赞同：0
> 
> 时间：2009-05-08T10:01:18.580
> 
> 标签：c#, crash, transactionscope

我有一些使用 a 的代码`System.Transactions.TransactionScope`，创建事务范围的新实例只会停止程序。

没有异常或消息，程序只是停止，Visual Studio 返回到代码编辑模式。这个过程完全没有了。事件查看器中没有异常、消息或事件。

我有另一个使用 TransactionScope 没有问题的测试应用程序，所以它不应该是环境问题。

我只是不知道如何获取异常详细信息。我在 Visual Studio 的 Debug->Exceptions 对话框中打开了所有“抛出”复选框，希望 VS 在抛出异常时自动中断，但事实并非如此。

谁能帮我找出程序退出的原因？

**编辑：**我刚刚发现了一些新东西。TransactionScope 正在通过在后台线程上运行的方法中创建`ThreadPool.QueueUserWorkItem`。如果我只是直接在主应用程序线程上调用该方法，这个问题就会消失。所以现在我的问题是“在线程池线程上使用 TransactionScope 有什么问题？”。*注意在调用新线程之前*我*没有*启动事务范围，它都在线程池线程上运行的一个方法中。

 ** * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-08T11:35:40.723

我发现了问题。它是操作我电脑的柔软有机组件。

`ThreadPool.QueueUserWorkItem()`将开始在线程池线程上工作。这意味着一个[后台线程](http://msdn.microsoft.com/en-us/library/h339syd0.aspx)。该代码在一个测试控制台应用程序中运行，当然我忘记了放入任何东西`Main()`来阻止程序在调用`ThreadPool.QueueUserWorkItem()`. 这意味着当我按下 F10 进入下一行时，程序实际上已经停止了，所以调试器自己关闭了。

`Console.ReadKey()`我所做的只是在最后添加一个调用来修复它`Program.Main()`，现在一切正常。请注意，该问题与线程池线程无关`System.Transactions.TransactionScope`。无论我把断点放在哪一行，它都会发生。

**注意**：
如果您认为我应该看到 a `ThreadAbortException`，那么阅读上面链接的文章会指出为什么没有发生这种情况。这是一个直接的报价：

> 当运行时因为进程正在关闭而停止后台线程时，线程中不会引发异常。但是，当线程因 AppDomain.Unload 方法卸载应用程序域而停止时，前台和后台线程都会引发 ThreadAbortException。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T10:06:19.923

一个疯狂的猜测：Microsoft 分布式事务协调器服务 (MSDTC) 已停止？例如，在 Vista 上默认情况下就是这种情况。不过，我预计会引发异常，所以我不确定你为什么会观察到这种行为。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T11:07:45.253

首先，Windows 事件日志中有什么内容吗？

如果没有，您可能会通过将调试器附加到 Visual Studio 来获得一些运气 - Visual Studio 本身或 NTSD（[Windows 调试工具的](http://www.microsoft.com/whdc/devtools/debugging/default.mspx)一部分）。

如果失败了，同行代码审查可能会有所帮助（第二双眼睛可能会注意到某些事情）或尝试一种霰弹枪方法 - 系统地删除一些代码，直到您发现为什么这个应用程序失败而另一个使用 TransactionScope 的应用程序没有失败。

# text - 用于语法着色的状态机

> ID：839123
> 
> 赞同：1
> 
> 时间：2009-05-08T10:02:19.043
> 
> 标签：text, lexer, state-machine

我目前正在学习词法分析器和解析器的工作方式，并且我有以下关于状态机的问题。例如，我需要通过以下规则为文本着色：对于此规则，简单的状态转换表将如下所示：

```
current event next  action
IDLE    $     COLOR -
COLOR   any   -     OnColor()
COLOR   \n    IDLE  - 
```

这将为 '$' 和行尾之间的每个字符调用 OnColor() 操作，以便我可以对其进行着色。当然同样可以从正则表达式自动生成，但我真的很想知道在大量使用魔法之前它是如何工作的:)。接下来是问题：如果我有一个规则：（想为任何以美元结尾的文本行着色，状态转换表不是很清楚：

```
current      event next             action
IDLE         any   -                -
IDLE         $     DOUND_DOLLAR     -
FOUND_DOLLAR \n    IDLE             OnDollar()
FOUND_DOLLAR any   IDLE             - 
```

我可以教我的状态机调用 OnDollar() 如果它在行尾找到一个“$”符号，但是我可以做些什么来为遇到美元符号之前的文本着色？解决此类问题的常见模式是什么？当然，它将是 1 行与正则表达式，但我真的很想知道如何通过状态机实现这样的解析器，是否有可能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T10:15:37.780

如果您一次只能为一个字符着色（即您没有缓冲、前瞻、重新着色或标记能力），那么这是不可能的。

否则，如果你有这样的能力，是可以做到的；该技术取决于什么是可用的。

*   重新着色 - 有一个可以重新着色 n 个字符的动作。显然，这是一个简单的解决方案。

*   缓冲/标记 - 具有将字符放在缓冲区末尾/在源中设置命名标记的操作，而不是让字符通过。然后，当您稍后发现要做什么时，请执行一个操作，以一种或另一种方式提交缓冲区，或从命名标记刷新。不过，用这个重新着色超过 1 个字符会有些复杂。

*   Lookahead - 具有推测性转换，即使用[NFA](http://en.wikipedia.org/wiki/Nondeterministic_finite_state_machine)而不是[DFA](http://en.wikipedia.org/wiki/Deterministic_finite_state_machine)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T10:32:51.233

大多数着色器总是在更大的块上工作，比如一整行（这在大多数情况下就足够了）加上一个“泄漏”标志，比如多行注释。有关此类 API，请参阅[Qt Syntax Highlighter](http://doc.trolltech.com/4.2/richtext-syntaxhighlighter.html)示例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-10T12:46:02.003

通过阅读“Purple Dragon Book”（原文如此），现代编译器和解释器似乎在积极使用“前瞻”缓冲区并积累最近的文本，因此他们可以轻松地检查几个下一个符号和几个前一个符号以获得准确的词法类型。

因此，在我的示例中， event() 需要查看下一个和上一个符号，以确定可能累积的词法类型。

# oracle - ORA-27101: Oracle 9 中不存在共享内存领域

> ID：839134
> 
> 赞同：0
> 
> 时间：2009-05-08T10:05:23.843
> 
> 标签：oracle

当我尝试连接到 Oracle 9 中的数据库（在 Windows 2003 服务器上运行）时出现此错误

我试图手动启动 Oracle 服务，但它拒绝启动......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T12:01:22.433

试试看：在服务器上，以管理员身份登录，然后：

```
SQLPLUS /nog
connect / as sysdba
startup 
```

任何错误信息？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T13:42:32.847

> 我试图手动启动 Oracle 服务，但它拒绝启动......

因此，某处有与此相关的错误消息。检查 Windows 事件日志，包括系统和应用程序。还要检查 Oracle 警报日志，它可能在 %ORACLE_HOME%\admin\ *sid*中​​；该目录中也可能有跟踪文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T11:58:20.210

每当我在 *nix 上得到这个时，都是因为 ORACLE_HOME 的设置不太正确。虽然不能真正帮助Windows。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-13T20:20:39.107

查看 sqlnet.ora 文件并确保其设置为：SQLNET.AUTHENTICATION_SERVICES=(NONE) 而不是 (NTS)

转到控制面板，服务，选择OracleService，右键单击并选择属性，选择登录选项卡。单击帐户单选按钮并确保正在使用的帐户是域合格的 dba 用户并且提供的密码正确。点击应用并确定并尝试启动服务。

如果仍然失败，请查看该 sid 的警报日志并查看错误是什么。还要确保没有对数据库用于启动实例的 spfile 进行任何更改。如果是这样，请将损坏的 spfile 移开并创建一个 pfile 来启动数据库。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-09-02T15:56:58.400

我在 Unix 环境中的经验：

即使乍一看似乎 ORACLE_SID 和 ORACLE_HOME 都配置正确，我也遇到了同样的问题。

就我而言，问题出在 ORACLE_HOME 中，因为预计它不会以斜杠字符结尾。当我从值中删除结束斜线时，事情开始正常工作。

```
# WRONG, leading to ORA-27101:
export ORACLE_HOME=/usr/local/oracle/11gR2/

# CORRECTLY set up:
export ORACLE_HOME=/usr/local/oracle/11gR2 
```

所以，我的建议是，即使它看起来不错，也要检查 ORACLE_HOME 变量的尾部斜杠。

# flash - 为 Flash 10 更新 Flash 8 AS2 内容时需要注意哪些问题

> ID：839135
> 
> 赞同：0
> 
> 时间：2009-05-08T10:05:38.600
> 
> 标签：flash, actionscript-3, actionscript-2, flash-cs4

我有大量使用 Flash 8 (AS2) 编写的 Flash 项目。我最近购买了 Flash CS4 以将此内容更新到新版本。我有一些新功能要添加并希望利用 Flash 10 中的一些新功能（本地文件访问等）。我在 CS4 中打开文件时已经遇到了一些问题，任何人都可以添加到此列表中吗？

1.  CS4 无法识别 Flash 8 项目文件格式并且无法打开它们
2.  无法加载我在 Flash 8 中使用的远程处理类（导入 mx.remoting）
3.  不支持对按钮或影片剪辑的所有操作
4.  不支持文本字段变量

我相信还会有更多，我还需要注意什么？还有其他我需要注意的陷阱吗？

多谢你们

ps 这很方便 - [http://www.adobe.com/devnet/actionscript/cookbook/](http://www.adobe.com/devnet/actionscript/cookbook/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T23:42:00.860

Flash CS4 保留了与 AS2 的向后兼容性以及 Flash 8 的几乎所有功能，尽管两者之间的转换不一定是平滑的。如果您只是在 Flash CS4 中打开一个 Flash 8 FLA 并使用 Flash CS4 自动分配的发布设置（带有 ActionScript2 的 Flash Player 10）发布它，您应该没问题。

但是，如果您尝试使用 AS3 将 Flash 8 FLA 发布到 FP10，您将遇到上面提到的所有问题。这是因为 AS3 不仅仅是 AS2 的升级，而是一种完全不同的语言（好吧，没有听起来那么激烈，但你明白了）。Flash CS4 中的许多新功能（IK、新 Motion 等）不适用于 AS2，需要您发布到 AS3。这可能是您的问题的根源；您正在尝试将仅限 AS2 的功能（在本例中为 AS2 代码）与仅限 AS3 的功能相结合。要做到这两点，您必须将您的 AS2 代码重写为 AS3。不幸的是，没有快速解决方法可以做到这一点。

我的建议是继续学习 AS3。可能有点难以理解来自 AS2 的内容，但它是一种更完整的语言，并且会持续很长时间。

# php - Linux 上的 PHP4，Windows 上的 Dev ...... Subversion 问题

> ID：839145
> 
> 赞同：0
> 
> 时间：2009-05-08T10:08:39.450
> 
> 标签：php, svn, tortoisesvn

“清理未能处理以下路径系统找不到指定的文件”

Tortoise SVN 去 SAMBA 分享时遇到这个问题.. 对设置有什么想法吗？它可能权限被搞砸了，但这个设置感觉不是很健壮..我不得不删除受影响的目录，然后从 svn 重新创建。

我在 Windows 盒子上用记事本++ 完成我的所有开发，并通过 Samba 使用 Windows 共享驱动器。

Windows Vista 笔记本电脑运行颠覆和乌龟。

在 VMWare 下运行的 Ubuntu8.10 运行 PHP4 和一个旧的 sybase_ct 驱动程序与主机上的 MSSQL 对话。我需要这个来镜像生产环境。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-09T21:15:12.480

我们在工作中有同样的问题

通常 Tsvn (TortoiseSVN) 在移动自己创建的文件夹时遇到问题，因此我们会收到类似“**无法将 xxx 移动到 yyy...** ”之类的错误消息，“**工作副本已锁定，请清理**”或类似内容，然后清理失败。

我们尝试`readonly = yes`在 samba 共享定义中使用“”，但没有成功。

之后我们发现Tsvn创建的文件夹创建了444或类似的文件夹（对所有者也是只读的），因此在需要移动文件夹时无法删除文件夹。`'force create mode = 600'`我们在共享定义中解决了这个问题。

还有更多，我告诉你，当你被该错误阻止时，你不需要删除整个项目并从 SVN 签出一个新的工作副本：当你在目标共享根目录中时，从 shell 启动这个命令就足够了项目文件夹

```
rm -rf `find . -type d -name .svn` 
```

递归删除 .svn 文件夹，然后签出（已经存在的文件只会重新版本，不会下载）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T10:36:05.860

根据我使用 Apache + SVN 的经验，它比共享文件存储库要强大得多，尽管设置起来更困难（对于 Ubuntu 来说可能还不错，因为它有 apt）

或者，您可以使用 ssh+svn，即到 linux 机器的隧道。

这两种方法都消除了听起来可疑的 samba 和文件共享。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T14:43:50.483

我想我找到了我的问题：

[http://tortoisesvn.tigris.org/faq.html#samba](http://tortoisesvn.tigris.org/faq.html#samba)

在我的 /etc/samba/smb.conf 文件中放入 delete readonly = yes

十指交叉……

# c# - WPF 数据绑定到更改对象

> ID：839147
> 
> 赞同：6
> 
> 时间：2009-05-08T10:10:04.470
> 
> 标签：c#, wpf, data-binding, binding

我有一个用户控件，它显示当前登录的用户名。我已将控件中的 TextBlock 绑定到应用程序中 User 对象的 UserId 属性。

我遇到的问题是，每次新用户登录时，我的绑定作为源的用户对象都会更改。

我可以想到一个解决方案，当用户对象发生变化时我会触发一个事件，这会被我控制，然后重新初始化绑定，但这似乎不太理想。

有没有办法解决这个问题，我感觉应该很常见吧？

干杯，

詹姆士

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-08T10:15:26.033

大多数 UI 绑定已经通过属性通知来处理这个问题，特别是（对于 WPF）`INotifyPropertyChanged`。- 即，如果您在*单个*实例上更新 UserId：

```
class User : INotifyPropertyChanged {
   public event PropertyChangedEventHandler PropertyChanged;
   protected virtual void OnPropertyChanged(string propertyName) {
      PropertyChangedEventHandler handler = PropertyChanged;
      if(handler!=null) handler(this, new PropertyChangdEventArgs(
                                            propertyName));
   }
   private string userId;
   public string UserId {
       get {return userId;}
       set {
           if(userId != value) {
              userId = value;
              OnPropertyChanged("UserId");
           }
       }
   }
} 
```

这应该会自动更新绑定。相反，如果您要更改实际的用户实例，请考虑相同的技巧，但针对用户的任何主机：

```
public User User {
    get {return user;}
    set {
        if(user != value) {
            user = value;
            OnPropertyChanged("User");
        }
    }
} 
```

如果你绑定到某个东西的“User.UserId”，那么它应该可以工作。

# oracle - 如何运行程序？

> ID：839154
> 
> 赞同：12
> 
> 时间：2009-05-08T10:11:54.903
> 
> 标签：oracle, plsql

包在这里..

```
CREATE OR REPLACE PACKAGE G_PKG_REFCUR AS
    TYPE rcDataCursor IS REF CURSOR;
END; 
```

让我们考虑PROC..

```
Create procedure gokul_proc(
    pId in number,
    pName in varchar2,
    OutCur OUT G_PKG_REFCUR.rcDataCursor ) is
BEGIN
    Open OutCur For
        select * from gokul_table ob 
        where ob.active_staus-'Y' AND ob.id=pId AND ob.name=pNname;
END; 
```

这是我的问题：如何执行此程序？

如果没有 OutCur 参数，那么我可以这样执行..

```
EXEC gokul_proc(1,'GOKUL'); 
```

但是，问题是 OutCur。我不知道在这里传递哪个值。

例如

```
EXEC gokul_proc(1,'GOKUL', ??????); 
```

我只需要知道传递什么值作为过程的参数。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-05-11T13:08:28.233

在 SQL Plus 中：

```
VAR rc REFCURSOR
EXEC gokul_proc(1,'GOKUL', :rc);
print rc 
```

# c# - MVC View Details and Edit

> ID：839155
> 
> 赞同：0
> 
> 时间：2009-05-08T10:12:01.610
> 
> 标签：c#, asp.net-mvc, web-applications

I have a view which displays data from the database like a blog post and at the bottom I would like the ability for a user to comment, how would one achieve this?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T10:49:40.507

通过在视图底部添加一个将发布到操作方法的表单。然后，该操作方法将处理表单并针对博客文章保存评论。

# vb.net - VB.NET 中的 UploadString（发布方法）不起作用

> ID：839158
> 
> 赞同：0
> 
> 时间：2009-05-08T10:13:43.213
> 
> 标签：vb.net, post, webclient, uploadstring

我正在尝试将简单数据发布到某个站点，在此示例中是我本地服务器上的一个 php 文件。我的 VB.NET 代码：

```
Dim W As New Net.WebClient
Dim A As String = ""

W.Encoding = System.Text.Encoding.UTF8
Dim URL As String = "http://localhost/test/p.php"
A = W.UploadString(URL, "bla=test")

MsgBox(A) 
```

这里是 p.php：

```
<?
print_r($_POST);
echo "\n";
print_r($_GET);
?> 
```

所以，当我启动 VB.NET 应用程序时，它只是简单地调用 p.php (GET) 但 POST 不起作用。什么都试过了。将 p.php 上传到其他服务器，检查 php ($_REQUEST) 中的其他变量，使用 UploadString(URL,"POST","bla=test)，使用 PERL、ASP.. 什么都没有。

我正在使用 .NET Framework 3.5 任何想法如何使用 vb.net 发布数据？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-10T11:05:07.430

我自己想通了：

```
 Dim W As New Net.WebClient
    Dim NC As New System.Collections.Specialized.NameValueCollection
    NC.Add("test", "TEEEEEST")

    Dim RESP As Byte()
    Dim R As String
    RESP = W.UploadValues("http://localhost/test/p.php", NC)
    R = System.Text.Encoding.ASCII.GetString(RESP)

    MsgBox(R) 
```

# iis - C# Deleting a IIS virtual directory on windows server 2003 gives a COMException

> ID：839167
> 
> 赞同：0
> 
> 时间：2009-05-08T10:16:38.807
> 
> 标签：iis, virtual-directory, comexception

```
 DirectoryEntry oDirectoryEntry = new DirectoryEntry(virtualDirMetaPath);
  oDirectoryEntry.DeleteTree(); 
```

This throws a COMException 0x80005000\. Any pointers welcome. Creation of virtual directory is fine. Its only at uninstall I get this error logged in Event Viewver.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-08T10:22:11.103

How come you're using `DirectoryEntry`, which is purely ActiveDirectory-related class, to manage IIS virtual directories? See [this](http://blogs.officezealot.com/charles/archive/2004/10/26/3191.aspx) for pointers.

# polymorphism - WCF -> Websphere Integration Developer and polymorphism

> ID：839168
> 
> 赞同：0
> 
> 时间：2009-05-08T10:16:43.177
> 
> 标签：polymorphism, websphere

I have a .NET WCF service which exposes an object that uses polymorphism.

Apparantly, Websphere Integration Developer is unable to handle this properly (I am not the Websphere developer), except by adding all fields of all possible polymorphisms and using a enum or such to say that it is an object of such and such type.

I can't possibly believe that IBM has created a product that doesn't support polymorphism! so.. Can anyone explain how to handle this, or point to resources which I can pass on?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T10:28:10.887

This may not be the problem, but you should be aware that web services, in general, do not support virtual methods. As such, they don't really support polymorphism.

In fact, web services are not object oriented at all. They're all about XML, which is not object oriented. Any resemblance to classes with methods and properties is a figment of the imagination of your tools - specifically the tools that produce your proxy classes look at the (XML) description of the web service and produce classes that are more or less like what is described.

Sometimes more, and sometimes less.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-02-03T16:07:43.827

问题是您的客户仅通过合同或 wsdl 了解您的服务。

wsdl 仅定义合同中方法的输入和输出（以及这些方法使用的数据合同） - 它不公开服务类（或任何数据合同）的任何基类等) 您的客户将致电。

并不是 WebSphere 不能处理多态性，而是 wsdl 不能以您期望的方式表达它。

# fonts - SIFR 字体调整是一场噩梦！

> ID：839169
> 
> 赞同：0
> 
> 时间：2009-05-08T10:17:02.240
> 
> 标签：fonts, sifr

我一直在尝试调整我的 SIFR 导航。我正在用 Gill 代替（尽管我对其他字体也有同样的问题）。

问题是，无论我对字母间距做什么，短词都可以使用一种设置，但不能使用长词，反之亦然。

为了停止任何单词换行，我必须将字母间距设置为 1px（例如），但这会导致较大的单词拥有比他们需要的更大的电影，并且由于导航是水平的，这会将下一个项目推得太远正确的。

有没有人有同样的问题？如果是这样，你解决了吗？

在此处查看图片：[http ://www.glg-group.com/gill.jpg](http://www.glg-group.com/gill.jpg)

这让我疯狂！

非常感谢

汤姆·高斯林

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-10T21:08:12.150

如果您使用 sIFR 3，您可以添加`fitExactly: true`用于替换的参数，这将使 Flash 影片的宽度恰好足以容纳文本。

（注意 Flash 可能使用不正确的值，但您可以使用`offsetLeft`/`offsetTop`和`tuneWidth`/`tuneHeight`参数来调整文本位置和影片尺寸。）

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-05-08T10:58:04.153

很抱歉没有直接回答您的问题，但您可能想试试[Cufon](http://wiki.github.com/sorccu/cufon)

> Cufón 旨在成为 sIFR 的一个有价值的替代品，尽管它有优点，但设置和使用仍然非常棘手。

希望它能解决这个问题。

# php - Accessing user credentials with PHP on IIS 7

> ID：839172
> 
> 赞同：1
> 
> 时间：2009-05-08T10:17:46.607
> 
> 标签：php, iis, iis-7

We are installing WordPress MU onto an IIS 7 sever

We need to enable single sign on against the AD.

We are happy to code the PHP to auto login / create accounts for the users etc.

What we need help with is how to we get the users Credential (username,email,name etc.) from the IIS / windows server into PHP variables so we can use them.

All advice welcomed

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T19:58:46.043

You want to use ldap. The hardest part for me was figuring out the OU my users were in and the format we needed to have our usernames (USERNAME@DOMAIN.COM instead of domain\username). We have them all in the default Users OU. This is taken from a cakephp app I wrote and it grabs some additional information, but it should set you along the right track. Your php of course needs to have an ldap extension compiled.

```
protected function findLdapUser($username, $password, $otheruser = false){
    $config = Configure::read('ldap');
    if(!$username && !$password && $otheruser){
        $username = $config['username'];
        $password = $config['password'];
    }
    if($password == ""){return false;} //prevent anonmyous bind
    if(!$otheruser){
        $otheruser = $username;
    }
    $connection = ldap_connect($config['host'], $config['port']);
    if($connection === false){      //does not detect properly depending on enviroment!
        debug("cannot connect to ldap server");
        return 0; //cannot connect!
    }
    ldap_set_option($connection, LDAP_OPT_PROTOCOL_VERSION, $config['version']);
    if (!@ldap_bind($connection, $username . $config['userpostfix'], $password)){
        return false;
    }

    //search for user data
    $fields = array('mail', 'name', 'telephoneNumber', 'physicalDeliveryOfficeName');
    //$filter = "sAMAccountName=" . $username;
    $filter = "userPrincipalName=" . $otheruser . $config['userpostfix'];
    $results = ldap_search($connection, "CN=USERS,".$config['basedn'], $filter, $fields);
    $info =  ldap_get_entries($connection, $results);
    if($info['count'] == 0){return false;}
    @ldap_unbind($connection);
    $return['LdapUser']['email'] = $info[0]['mail'][0];
    $return['LdapUser']['fullname'] = $info[0]['name'][0];
    //supress warnings
    @$return['LdapUser']['office'] = $info[0]['physicaldeliveryofficename'][0];
    @$return['LdapUser']['phone'] = $info[0]['telephonenumber'][0];
    return $return;
} 
```

# javascript - 在 JS 中，这个特性叫什么？

> ID：839173
> 
> 赞同：4
> 
> 时间：2009-05-08T10:17:57.057
> 
> 标签：javascript, json

我正在尝试了解我在代码中不断看到的 javascript 的这个特性，但我不知道谷歌的构造名称......

```
var Stats = {
  onLoad: function(e) {
    // content
    this.variable++;
  },

  variable: 1
}; 
```

这种组织函数和变量的方式是基于 JSON 的吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-08T10:21:08.593

这是一个“对象文字” - 请参阅[JavaScript 指南](https://developer.mozilla.org/En/Core_JavaScript_1.5_Guide/Literals#Object_Literals)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-08T10:21:20.183

它被称为[对象文字](http://www.dyn-web.com/tutorials/obj_lit.php)语法。
它是 JSON 的超集。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-08T10:22:26.110

示例代码创建一个包含两个条目的对象文字（即哈希映射）。第一个条目将“onLoad”映射到匿名函数，第二个条目将“变量”映射到 1。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-08T10:27:32.947

谢谢大家，我给了 Richie 作为第一个的答案，但是 Greg 给出的链接有更多的例子，所以我当然会用这两个来学习（以及来自谷歌的其他人）。

@Barry：感谢您解释它的作用，但这并不是我提出问题的真正目的:)

# java - 为什么 Java 的 Iterator 不是 Iterable？

> ID：839178
> 
> 赞同：184
> 
> 时间：2009-05-08T10:19:43.387
> 
> 标签：java, iterator, iterable

为什么`Iterator`接口不扩展`Iterable`？

该`iterator()`方法可以简单地返回`this`。

是故意的还是只是 Java 设计者的疏忽？

能够使用带有迭代器的 for-each 循环会很方便，如下所示：

```
for(Object o : someContainer.listSomeObjects()) {
    ....
} 
```

where`listSomeObjects()`返回一个迭代器。

* * *

## 回答 #1

> 赞同：226
> 
> 时间：2009-05-08T10:23:35.873

迭代器是有状态的。这个想法是，如果您调用`Iterable.iterator()`两次，您将获得*独立*的迭代器 - 无论如何，对于大多数可迭代对象。在您的情况下显然不是这种情况。

例如，我通常可以写：

```
public void iterateOver(Iterable<String> strings)
{
    for (String x : strings)
    {
         System.out.println(x);
    }
    for (String x : strings)
    {
         System.out.println(x);
    }
} 
```

那应该将集合打印两次-但是使用您的方案，第二个循环总是会立即终止。

* * *

## 回答 #2

> 赞同：68
> 
> 时间：2009-05-08T10:23:01.943

因为迭代器通常指向集合中的单个实例。Iterable 意味着可以从一个对象获取一个迭代器来遍历它的元素——并且不需要迭代单个实例，这就是迭代器所代表的。

* * *

## 回答 #3

> 赞同：65
> 
> 时间：2011-03-10T23:18:48.053

对于我的 0.02 美元，我完全同意 Iterator 不应该实现 Iterable，但我认为增强的 for 循环也应该接受。我认为整个“使迭代器可迭代”的论点是作为一种解决语言缺陷的方法出现的。

引入增强型 for 循环的全部原因是它“在迭代集合和数组时消除了迭代器和索引变量的乏味和容易出错的情况”[ [1](http://download.oracle.com/javase/1.5.0/docs/relnotes/features.html#forloop "[1]") ]。

```
Collection<Item> items...

for (Iterator<Item> iter = items.iterator(); iter.hasNext(); ) {
    Item item = iter.next();
    ...
}

for (Item item : items) {
    ...
} 
```

那么为什么同样的论点不适用于迭代器呢？

```
Iterator<Iter> iter...
..
while (iter.hasNext()) {
    Item item = iter.next();
    ...
}

for (Item item : iter) {
    ...
} 
```

在这两种情况下，对 hasNext() 和 next() 的调用都已被删除，并且内部循环中没有对迭代器的引用。是的，我知道 Iterables 可以重复使用来创建多个迭代器，但这一切都发生在 for 循环之外：在循环内部，每次只有一个项目在迭代器返回的项目上向前推进。

此外，允许这样做也可以很容易地将 for 循环用于枚举，正如在其他地方指出的那样，它类似于迭代器而不是迭代器。

所以不要让Iterator实现Iterable，而是更新for循环来接受。

干杯，

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2011-12-18T21:59:23.607

正如其他人指出的那样，[`Iterator`](http://docs.oracle.com/javase/7/docs/api/java/util/Iterator.html)和[`Iterable`](http://docs.oracle.com/javase/7/docs/api/java/lang/Iterable.html)是两个不同的东西。

此外，`Iterator`实现早于增强的 for 循环。

用一个简单的适配器方法来克服这个限制也是微不足道的，当与静态方法导入一起使用时，它看起来像这样：

```
for (String line : in(lines)) {
  System.out.println(line);
} 
```

示例实现：

```
 /**
   * Adapts an {@link Iterator} to an {@link Iterable} for use in enhanced for
   * loops. If {@link Iterable#iterator()} is invoked more than once, an
   * {@link IllegalStateException} is thrown.
   */
  public static <T> Iterable<T> in(final Iterator<T> iterator) {
    assert iterator != null;
    class SingleUseIterable implements Iterable<T> {
      private boolean used = false;

      @Override
      public Iterator<T> iterator() {
        if (used) {
          throw new IllegalStateException("SingleUseIterable already invoked");
        }
        used = true;
        return iterator;
      }
    }
    return new SingleUseIterable();
  } 
```

* * *

在 Java 8 中，使 an 适应`Iterator`an`Iterable`变得更简单：

```
for (String s : (Iterable<String>) () -> iterator) { 
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2016-12-21T06:35:55.230

令人难以置信的是，还没有其他人给出这个答案。`Iterator`以下是使用新的 Java 8方法“轻松”迭代 an的[`Iterator.forEachRemaining()`](https://docs.oracle.com/javase/8/docs/api/java/util/Iterator.html#forEachRemaining-java.util.function.Consumer-)方法：

```
Iterator<String> it = ...
it.forEachRemaining(System.out::println); 
```

当然，有一个“更简单”的解决方案可以直接与 foreach 循环一起使用，将 包装`Iterator`在`Iterable`lambda 中：

```
for (String s : (Iterable<String>) () -> it)
    System.out.println(s); 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2012-02-06T15:49:26.243

正如其他人所说，一个 Iterable 可以被多次调用，每次调用都返回一个新的 Iterator；迭代器只使用一次。所以它们是相关的，但服务于不同的目的。然而，令人沮丧的是，“compact for”方法仅适用于可迭代对象。

我将在下面描述的是一种两全其美的方法——即使底层数据序列是一次性的，也返回一个 Iterable（为了更好的语法）。

诀窍是返回实际触发工作的 Iterable 的匿名实现。因此，不是执行生成一次性序列的工作，然后在其上返回一个迭代器，而是返回一个迭代器，每次访问它时，都会重做工作。这可能看起来很浪费，但通常你只会调用 Iterable 一次，即使你多次调用它，它仍然具有合理的语义（不像一个简单的包装器使 Iterator “看起来像”一个 Iterable，这不会'如果使用两次不会失败）。

例如，假设我有一个 DAO，它提供了来自数据库的一系列对象，并且我想通过迭代器提供对它的访问（例如，如果不需要，避免在内存中创建所有对象）。现在我可以只返回一个迭代器，但这使得在循环中使用返回的值很难看。因此，我将所有内容都包装在 anon Iterable 中：

```
class MetricDao {
    ...
    /**
     * @return All known metrics.
     */
    public final Iterable<Metric> loadAll() {
        return new Iterable<Metric>() {
            @Override
            public Iterator<Metric> iterator() {
                return sessionFactory.getCurrentSession()
                        .createQuery("from Metric as metric")
                        .iterate();
            }
        };
    }
} 
```

然后可以在这样的代码中使用它：

```
class DaoUser {
    private MetricDao dao;
    for (Metric existing : dao.loadAll()) {
        // do stuff here...
    }
} 
```

这让我可以使用紧凑的 for 循环，同时仍然保持增量内存使用。

这种方法是“懒惰的”——在请求 Iterable 时不会完成工作，而是在稍后迭代内容时才完成——你需要意识到这样做的后果。在带有 DAO 的示例中，这意味着迭代数据库事务中的结果。

所以有各种警告，但在许多情况下这仍然是一个有用的习惯用法。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2015-11-04T00:23:54.290

`Iterator`是一个允许你迭代某些东西的接口。它是在某种集合中移动的一种实现。

`Iterable`是一个功能接口，表示某物包含可访问的迭代器。

在 Java8 中，这让生活变得非常轻松......如果你有一个`Iterator`但需要一个，`Iterable`你可以简单地做：

```
Iterator<T> someIterator;
Iterable<T> = ()->someIterator; 
```

这也适用于 for 循环：

```
for (T item : ()->someIterator){
    //doSomething with item
} 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2010-10-03T10:54:07.973

我也看到很多人这样做：

```
public Iterator iterator() {
    return this;
} 
```

但这并不正确！这种方法不是你想要的！

该方法`iterator()`应该从头开始返回一个新的迭代器。所以需要做这样的事情：

```
public class IterableIterator implements Iterator, Iterable {

  //Constructor
  IterableIterator(SomeType initdata)
  {
    this.initdata = iter.initdata;
  }
  // methods of Iterable

  public Iterator iterator() {
    return new IterableIterator(this.intidata);
  }

  // methods of Iterator

  public boolean hasNext() {
    // ...
  }

  public Object next() {
    // ...
  }

  public void remove() {
    // ...
  }
} 
```

问题是：有什么方法可以让抽象类执行此操作吗？因此，要获得一个 IterableIterator 只需要实现 next() 和 hasNext() 这两个方法

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2017-09-06T00:37:26.570

我同意接受的答案，但想添加我自己的解释。

*   Iterator 表示遍历的状态，例如，您可以从一个迭代器中获取当前元素并继续前进到下一个。

*   Iterable 代表一个可以被遍历的集合，它可以返回任意数量的迭代器，每个迭代器代表它自己的遍历状态，一个迭代器可能指向第一个元素，而另一个可能指向第三个元素。

如果 Java for 循环同时接受 Iterator 和 Iterable，那就太好了。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2019-10-02T22:55:28.070

# 避免依赖`java.util`包

根据原始 JSR，[*Java™ 编程语言的增强 for 循环*](https://jcp.org/aboutJava/communityprocess/jsr/tiger/enhanced-for.html)，建议的接口：

*   [`java.lang.Iterable`](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/Iterator.html)
*   `java.lang.ReadOnlyIterator`
    （建议改装到`java.util.Iterator`，但显然这从未发生过）

…被设计为使用`java.lang`包命名空间而不是`java.util`.

引用 JSR：

> 这些新接口用于防止语言对 java.util 的依赖性，否则会导致这种依赖性。

* * *

顺便说一句，旧的在 Java 8+ 中`java.util.Iterable`获得了一个新[`forEach`](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Iterable.html#forEach(java.util.function.Consumer))方法，用于 lambda 语法（传递 a [`Consumer`](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/function/Consumer.html)）。

这是一个例子。[`List`](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/List.html)接口扩展接口，[`Iterable`](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Iterable.html)因为任何列表都带有`forEach`方法。

```
List
.of ( "dog" , "cat" , "bird" )
.forEach ( ( String animal ) -> System.out.println ( "animal = " + animal ) ); 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2016-03-07T19:25:35.180

如果您来这里是为了寻找解决方法，您可以使用[IteratorIterable](https://commons.apache.org/proper/commons-collections/apidocs/org/apache/commons/collections4/iterators/IteratorIterable.html)。（适用于 Java 1.6 及更高版本）

示例用法（反转向量）。

```
import java.util.Vector;
import org.apache.commons.collections4.iterators.IteratorIterable;
import org.apache.commons.collections4.iterators.ReverseListIterator;
public class Test {
    public static void main(String ... args) {
        Vector<String> vs = new Vector<String>();
        vs.add("one");
        vs.add("two");
        for ( String s: vs ) {
            System.out.println(s);
        }
        Iterable<String> is
            = new IteratorIterable(new ReverseListIterator(vs));
        for ( String s: is ) {
            System.out.println(s);
        }
    }
} 
```

印刷

```
one
two
two
one 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-08T10:37:54.780

为了简单起见，Iterator 和 Iterable 是两个截然不同的概念，Iterable 只是“I can return an Iterator”的简写。我认为你的代码应该是：

```
for(Object o : someContainer) {
} 
```

带有一些容器实例`SomeContainer extends Iterable<Object>`

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2010-11-09T10:12:19.190

顺便说一句：Scala 在 Iterator 中有一个 toIterable() 方法。请参阅[从迭代器到可迭代的 scala 隐式或显式转换](https://stackoverflow.com/questions/2746814/scala-implicit-or-explicit-conversion-from-iterator-to-iterable)

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2015-03-16T16:00:33.537

在相关说明中，您可能会发现 Apache Commons Collections4 中的 IteratorIterable 适配器很有用。只需从迭代器创建一个实例，您就有了相应的可迭代对象。

[https://commons.apache.org/proper/commons-collections/apidocs/org/apache/commons/collections4/iterators/IteratorIterable.html](https://commons.apache.org/proper/commons-collections/apidocs/org/apache/commons/collections4/iterators/IteratorIterable.html)

ID：org.apache.commons:commons-collections4:4.0

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2016-07-30T12:27:15.050

迭代器是有状态的，它们有一个“下一个”元素，一旦迭代就变得“筋疲力尽”。要查看问题出在哪里，运行以下代码，打印了多少个数字？

```
Iterator<Integer> iterator = Arrays.asList(1,2,3).iterator();
Iterable<Integer> myIterable = ()->iterator;
for(Integer i : myIterable) System.out.print(i);
System.out.println();
for(Integer i : myIterable) System.out.print(i); 
```

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2013-06-19T10:10:59.250

您可以尝试以下示例：

```
List ispresent=new ArrayList();
Iterator iterator=ispresent.iterator();
while(iterator.hasNext())
{
    System.out.println(iterator.next());
} 
```

# iphone - iPhone multiple NSTimer problem

> ID：839179
> 
> 赞同：1
> 
> 时间：2009-05-08T10:20:01.280
> 
> 标签：iphone, objective-c, cocoa-touch

I am writing a multithreaded iphone application in which the socket operations take place at the backend. The front end is the user interface. My problem is that the NSTimer is working only at the front end. That too only one timer works on the frontend. Unable to implement NSTimers at the backend? Are there any threading issues involved? Can\t figure out what might be the problem.

# ajax - 启用 AJAX 的 Web 应用程序

> ID：839189
> 
> 赞同：0
> 
> 时间：2009-05-08T10:22:22.553
> 
> 标签：ajax, visual-studio-2008, .net-3.5

sy 知道为什么 VS 2008 中的 Ajax Enable WebAppication，即使你把目标框架 3.5，目标之后 .NET 2.0 框架？

（所以我使用 ASP.NET 2.0 Ajax Extensions 1.0 features enable (.NET framework 3.5) 创建 Web 应用程序，然后我在项目属性的 Application Tab 中检查 Target Framework，它是 2.0 编写的）

我需要在我的机器上安装更多 sg 吗？

提前谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T10:45:25.027

ASP.NET 3.5 基本上是 ASP.NET 2.0 + System.Web.Extensions - 默认情况下，Web 应用程序项目中包含与 AJAX 扩展相同但版本号和扩展不同的模型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T10:39:34.463

尝试创建 ASP.NET Web 应用程序。在 New Project 对话框的右上角选择 .NET Framework 3.5。要使其启用 AJAX，只需将 ScriptManager 放入您的页面中。

我的 VS 2008 中没有带有 ASP.NET 2.0 Ajax Extensions 1.0 模板的 Web 应用程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T09:15:06.363

您需要创建 ASP.NET Web 应用程序。在 New Project 对话框的右上角选择 .NET Framework 3.5 并选择所需的目标框架。

[www.interviewsworld.com](http://www.interviewsworld.com)

# pdf - cfdocument 使用什么渲染引擎进行 HTML->PDF 转换？

> ID：839190
> 
> 赞同：9
> 
> 时间：2009-05-08T10:22:25.720
> 
> 标签：pdf, coldfusion

简单的问题：有谁知道 CF8 使用什么将 HTML 呈现为 PDF？

更具体地说，我想知道版本以及是否完整描述了它支持/不支持的样式。

（例如，它不支持 CSS 分页 - 您需要使用不那么灵活的 cfdocumentitem）

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-08T17:36:15.263

是的，它确实使用 iText。CF8 使用 1.4 版本：

```
<cfset doc = createObject("java", "com.lowagie.text.Document")>
<cfdump var="#doc.getVersion()#"> 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-08T11:23:47.010

该[标签的](http://livedocs.adobe.com/coldfusion/8/htmldocs/help.html?content=Tags_d-e_05.html)[文档`cfdocument`](http://livedocs.adobe.com/coldfusion/8/htmldocs/help.html?content=Tags_d-e_05.html)包括支持的 CSS 样式列表。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-12T16:28:32.990

CFDOCUMENT 使用 ICEBrowser 呈现 HTML，然后使用 iText 将其写入 PDF。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-08T14:11:06.363

据我记得，cfdocument 使用[iText](http://www.lowagie.com/iText/)生成 PDF。我不记得版本号，但你可以打开 itext.jar 并查看应该包含版本的清单。

# sharepoint - session variable issue with user control in Son of smart part webpart

> ID：839193
> 
> 赞同：0
> 
> 时间：2009-05-08T10:23:09.963
> 
> 标签：sharepoint, sharepoint-2007, smartpart

The user control is a search screen that consists of a gridview. I am string the filtered results of the gridview in a datatable and storing the datatable in the session. I am accessing the datatable in the session on the next postback.

The problem is that when I am storing the dattable in the session, even though the lines of code don't throw any exception, the web page shows "An unexpected error has occurred". I was able to track down the reason to be the assignment of the session variable with the help of remote debugging.

I had earlier tested the user control outside of sharepoint and checked that it worked perfectly in asp.net page.

I am using sharepoint 2007 and using VS 2008 for development, the framework being used is 2.0\. I am very new to sharepoint development and any lead will be very helpful.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-08T11:19:02.167

您是否启用了会话状态并在服务器上配置了 SSP？

看看[这篇 TechNet 文章](http://technet.microsoft.com/en-us/library/cc263527.aspx)。

# javascript - Positioning an element below another element in Javascript

> ID：839196
> 
> 赞同：3
> 
> 时间：2009-05-08T10:24:15.637
> 
> 标签：javascript, dhtml

I'm trying to create a dialog similar to the one that shows when clicking the 'flag' link here on SO (without using JQuery or any other library though).

The code below displays a dialog when the Show Dialog link is clicked. The code works very well except one thing which is that when the text of the page is resized, the dialog doesn't display below the link, how can this be fixed?

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<title>Test</title>
<script type="text/javascript">

function ShowDialog(link)
{
  var dlgID = "popupDialog";
  if(!document.getElementById(dlgID))
  {
    dialog = document.createElement("div");
    dialog.id = dlgID;
    dialog.style.position = "absolute";
    dialog.style.width =  "200px";
    dialog.style.zIndex = "100";
    dialog.style.padding = "10px";
    dialog.style.backgroundColor = "#FF0000";
    dialog.innerHTML = 
      "Violation Type:<br />" +
      "<input type='radio' id='Option1' name='ViolationType' checked='checked' /><label for='Option1'> Option 1</label><br />" +
      "<input type='radio' id='Option2' name='ViolationType' /><label for='Option2'> Option 2</label><br />" +
      "<input type='radio' id='Option3' name='ViolationType' /><label for='Option3'> Option 3</label><br />" +
      "<input type='radio' id='Option4' name='ViolationType' /><label for='Option4'> Option 4</label>" +
      "<p style='text-align:right;margin-top:10px;'><input type='button' value='OK' /> <input type='button' value='Cancel' /></p>";
    document.body.appendChild(dialog);
  }
  else
  {
    dialog = document.getElementById(dlgID);
  }

  dialog.style.visibility = "visible";
  dialog.style.left = getX(link) + "px";
  dialog.style.top = getY(link) + link.offsetHeight + "px";
}

function getY(oElement)
{
  var iReturnValue = 0;
  while (oElement != null)
  {
    iReturnValue += oElement.offsetTop;
    oElement = oElement.offsetParent;
  }
  return iReturnValue;
}

function getX(oElement)
{
  var iReturnValue = 0;
  while (oElement != null)
  {
    iReturnValue += oElement.offsetLeft;
    oElement = oElement.offsetParent;
  }
  return iReturnValue;
}

</style>
</head>
<body>
Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Proin enim diam, imperdiet eget, luctus eget, rhoncus vel, lacus. Maecenas ipsum nulla, pretium vel, vehicula a, tincidunt luctus, dui. Donec adipiscing. Sed aliquet, lorem id porttitor vestibulum, libero pede pretium sem, id iaculis mauris ante a orci. Etiam mi felis, adipiscing nec, aliquet vel, hendrerit non, libero. Curabitur posuere pede vitae enim. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Proin sem. Pellentesque iaculis. Morbi at tellus a velit venenatis tempor. Vivamus quam augue, commodo sed, dapibus nec, posuere in, augue. Mauris ultrices. Integer fringilla turpis et dui. Quisque varius elementum ipsum. Aenean pede. Sed vestibulum condimentum ipsum.<br />
Lorem ipsum dolor sit amet <a href="#" onclick="ShowDialog(this);return false;">Show Dialog</a><br />Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Proin enim diam, imperdiet eget
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-08T10:42:26.453

这是一个在这种情况下效果很好的“hack”。只需触发 window.onresize() 事件内的链接的 click 事件。

将以下内容添加到脚本标记的顶部：

```
<script type="text/javascript">
var myLink;
window.onresize = function()
{
   myDialog = document.getElementById("popupDialog");
   if(myDialog && myDialog.style.visibility == "visible")
   {         
      myLink.fireEvent("onclick");
   }
}
function ShowDialog(link)
{
  myLink = link;
  var dlgID = "popupDialog";
  if(!document.getElementById(dlgID))
  {
    dialog = document.createElement("div");
    dialog.id = dlgID;
    dialog.style.position = "absolute";
    dialog.style.width =  "200px";
    dialog.style.zIndex = "100";
    ......... 
```

# javascript - Access the control of one page from another page

> ID：839200
> 
> 赞同：0
> 
> 时间：2009-05-08T10:26:47.613
> 
> 标签：javascript, html

In my project, I need to disable some controls in one page from an another page. For example Mainpage.html has a button named "View profile", which needs to be disabled from Profile.html. Any suggestions?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T10:31:20.473

On the profile page set a cookie that is read on Mainpage.html, depending on whether its set or not the control is disabled.

# asp.net - ADFS and ASP.NET

> ID：839206
> 
> 赞同：1
> 
> 时间：2009-05-08T10:28:33.303
> 
> 标签：asp.net, security, adam, adfs

Just looking for clarification on the above topics.

*   There are a number of domains with their own AD
*   The domain where my ASP.NET application is running hosts the ADFS server (the root domain)
*   there are TRUSTs established between each domain and the root domain

Then there shouldn't be a problem? I don't use Forms authentication, instead I explictly need to say in the web.config that I'm using ADFS, am I right?

How does ADAM fit into all of this? I don't see that I need it, as each domain has their own AD. ADAM is a separate user-store to AD?

Is this right, or am I waaaaay off?

Thanks

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T18:36:01.880

> “……那应该没问题吧？”

您的问题尚不清楚，但如果期望来自“任意数量的域”的用户应该能够使用 Windows 集成身份验证向 ADFS 服务器进行身份验证，那么答案是肯定的，应该没有问题。

> “我不使用表单身份验证，而是明确需要在 web.config 中说明我正在使用 ADFS，对吗？”

如果您指的是告诉 ADFS 是否使用 Windows Integrated Auth 而不是 Forms Auth，您需要确保这是ADFS 站点的 web.config 部分中`<add name="Integrated" page="auth/integrated/"/>`的第一项。`localAuthenticationTypes`

如果您指的是告诉您的 ASP.NET 应用程序使用 ADFS 对用户进行身份验证，您需要安装[Windows Identity Foundation](http://msdn.microsoft.com/en-us/security/aa570351.aspx)并使用“添加 STS 引用”功能来设置 web.config。

> ADAM 如何融入这一切？我认为我不需要它，因为每个域都有自己的 AD。ADAM 是独立于 AD 的用户存储吗？

是的，如果您已经在 AD 中拥有用户，则不需要 ADAM。ADAM - 现在称为 AD LDS - 只是一个轻量级的独立用户存储。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T19:09:15.557

通常，如果您将 ADFS 放在 AD 之上，则信任位于 ADFS 实例之间，而不是 AD 实例之间。您通常会删除这些信任。

ADFS 没有开箱即用地使用 ADAM。你已经有广告了。如果需要使用 ADAM，则必须添加另一个属性存储。

# iphone - iPhone UITableView 与 UISearchBar 和刷新部分索引

> ID：839211
> 
> 赞同：6
> 
> 时间：2009-05-08T10:29:44.393
> 
> 标签：iphone, uitableview, uisearchbar

我有一个 UITableView，顶部有一个 UISearchBar。

我还使用 Section Index 代理在右侧显示 ABC...XYZ。

当我单击搜索框并且键盘从底部出现时出现问题，部分索引被挤压，因此只显示 A *D* ...*Z - 当我关闭搜索并且他们的键盘消失时，索引停留在这个“压扁”状态，直到我滚动或类似。

```
 // animate the searchbar
[UIView beginAnimations:nil context:NULL];
CGRect tempRect = [[self searchBar] frame];
tempRect.size.width = 320-kMarginRight;
[[self searchBar] setFrame:tempRect];
[UIView commitAnimations];  

    // animate the search index back into view
for (UIView *view in [[self tableView] subviews]) {
    if ([view respondsToSelector:@selector(moveIndexIn)]) {
        MovableTableViewIndex *index = (MovableTableViewIndex*)view;
        [index moveIndexIn];
    }
}   

    // try a whole load of stuff to try and get the section indexes to draw again properly
    // none of which work!  

[searchBar setText:@""];
[searchBar resignFirstResponder];

letUserSelectRow = YES;
searching = NO;
[[self navigationItem] setRightBarButtonItem:nil];
[[self tableView] setScrollEnabled:YES];        
[[self tableView] reloadData];
[[self tableView] flashScrollIndicators];
[[self tableView] sizeToFit];
[[self tableView] zoomScale];       
[[self tableView] reloadSectionIndexTitles]; 
```

我的问题是，有人见过这种行为吗？有没有办法重新绘制 RHS 上的部分索引（`[[self tableView] reloadData]`不起作用）

太感谢了！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-10-02T23:40:23.547

您应该在完全激活搜索时禁用索引绘制。只需在您的委托中返回 nil，如下所示：

```
- (NSArray *)sectionIndexTitlesForTableView:(UITableView *)tableView {
  if ([self.searchDisplayController isActive]) 返回零；

  ...
}

```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-12T08:19:22.213

你可以尝试使用

```
- (void)flashScrollIndicators 
```

哪个刷新滚动条并希望也刷新部分索引？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-05-05T18:50:26.647

它工作正常！

> `[searchBar setContentInset:UIEdgeInsetsMake(5, 0, 5, 35)];`

# c# - javax.crypto.IllegalBlockSizeException in AES encryption

> ID：839213
> 
> 赞同：0
> 
> 时间：2009-05-08T10:30:11.660
> 
> 标签：c#, java, encryption

I am using AES/CBC/PKCS5Padding padding standard in java and my friend uses PKCS7 standard in c#.NET If My friend encrypt the data using AES and send me the key then I can decrypt it.

But If my data length increases more than 2920 bytes then if i encrypt the data in c#.NET and decrypt the data in java then my decryption does not work good. It gives me the following error.

"javax.crypto.IllegalBlockSizeException: Input length must be multiple of 16 when decrypting with padded cipher"

Thanks Bapi

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T10:38:48.770

您再次忘记刷新缓冲区，这意味着数据流不完整。

[编辑] 我不了解 C# 但在 Java 中，您必须在所有数据到达后调用 doFinal() 一次。（请参阅[文档](http://java.sun.com/javase/6/docs/technotes/guides/security/crypto/CryptoSpec.html#Cipher)）。

问题的根源在于加密 API 需要知道您何时完成。它无法从数据中分辨出来，您必须调用一个方法来说“将其包装起来，创建最终的校验和，无论如何，以便接收器可以对其进行解码”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-03-24T10:45:46.257

只需使用`cipher.dofinal("Your byte array","offset...put 0","block size...16");`

```
eg : c.dofinal(ByteArray,0,16); 
```

# javascript - 在 JavaScript (GIF/PNG) 中创建 DIV 的图像

> ID：839216
> 
> 赞同：9
> 
> 时间：2009-05-08T10:31:17.040
> 
> 标签：javascript, image

我想知道是否有可用的 JavaScript 库允许我从 DIV 的内容生成图像。

基本上，对于一些需要从浏览器打印背景的服务器端打印代码来说，这是必需的。

我最终想做的是将 DIV 内容编码为 PNG 格式，并使用打印操作发布编码数据。

如果可能的话，有什么想法吗？

[编辑] 我拥有的是一个地图应用程序，其中背景数据来自图像服务器直接进入浏览器 DIV（想想谷歌地图）。那个 div 是我主要数据的背景。当按下打印时，服务器从它知道的数据中生成一个 PDF，但对浏览器的背景数据一无所知。我真正想要的是能够以某种方式为服务器提供浏览器背景图像！

干杯，罗

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-08T10:52:41.233

也许有可能`Canvas`：

[MDN - 使用 Canvas 绘制图形](https://developer.mozilla.org/en/drawing_graphics_with_canvas)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T10:37:00.647

您可以从 JavaScript 创建图像标记，但不能创建其中的实际图像：JS 没有为位图分配内存的命令，也没有在其上渲染任何内容的命令。

通常的解决方案是在服务器上有一个报告生成器，根据请求创建图像。查看[BIRT](http://www.eclipse.org/birt/phoenix/)或[JasperReports](http://jasperforge.org/projects/jasperreports)。

[编辑] 根据您的评论，解决方案很简单：检查 DIV，找到背景图像的 URL 并将 DIV 替换为 IMG 元素。将 URL 放入 SRC 属性中，然后打印。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-08T12:20:47.503

非常有趣的问题。

实际上我使用 ajax 解决了这个问题（将图像的位置传输到服务器，服务器从片段中创建一个图像，保存并将 url 发送到客户端）。我不太喜欢这个解决方案，但我还不知道其他解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-08T10:48:42.320

我真的不认为这在浏览器上是可能的，当然不是没有某种插件。

您能否向网络服务器发送一些坐标信息或其他内容，这样网络服务器就可以从图像服务器请求相同的地图图像？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-08T10:52:17.427

只能在 IE5 中生成图像 :( 然后由于安全原因它被删除了。我仍然想念它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-08T10:59:06.570

我想我已经找到了一种方法来做到这一点。

1) 当用户按下打印时，查询 DIV
2) 该 DIV 上的图像由 OpenLayers API 生成
3) 获取每个图像的 URL
4) 获取每个图像在屏幕上的
位置 5) 将屏幕位置转换为真实世界位置（我有这个 API）
6）作为打印的一部分，发送所有图像 URL 及其真实世界范围
7）允许服务器重新请求图像并将它们绘制到适当的位置。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-08T12:16:33.537

它必须在浏览器端完成吗？我已经看到您可以在哪里进行服务器端调用，服务器响应上的 MIME 类型是图像类型。我认为我正在考虑的示例是用于数据库中 b64 编码的 jpeg，但过程应该是相同的。响应将是当前 DIV 中的数据。对不起，如果我离基地很远。

# php - 在我的 PHP 代码中使用子域名？

> ID：839221
> 
> 赞同：0
> 
> 时间：2009-05-08T10:32:18.473
> 
> 标签：php, url

首先，有什么区别：

> www.domain.com

和

> 域名.com

我在编码时应该注意这一点吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-08T10:33:50.373

我强烈建议使用相对路径。

这有很多优点，例如：

*   路径更短
*   如果您想转移到不同的域名，您不必检查数千条代码行

一般来说，www.domain.com 和 domain.com 之间是有区别的。“www”前缀只不过是一个普通的子域：[http ://en.wikipedia.org/wiki/Subdomain](http://en.wikipedia.org/wiki/Subdomain)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-08T10:50:21.223

```
domain.com 
```

是注册域名和

```
www.domain.com 
```

是 的子域`domain.com`，它们并不总是相同的。大多数网站将设置其网络服务器以将 domain.com 重定向到 www.doamin.com，反之亦然。

根据 DNS 区域文件配置，子域可以指向不同的 IP 地址（可能是不同的物理服务器）。

```
example.com.  A     10.0.0.1              ; ip address for "example.com"
ns            A     10.0.0.2              ; ip address for "ns.example.com"
www           CNAME ns                    ; "www.example.com" is an alias for   "ns.example.com"
wwwtest       CNAME www                   ; "wwwtest.example.com" is another alias for "www.example.com"
mail          A     10.0.0.3              ; ip address for "mail.example.com", any MX record host must be 
```

取自维基百科 - [DNS 区域文件](http://en.wikipedia.org/wiki/Zone_file)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T11:13:48.950

相对网址不是最好的主意。让一个常量保持相对 url 的值，其余的保持静态是个好主意

# asp.net - 连接下拉列表中的两个字段

> ID：839223
> 
> 赞同：0
> 
> 时间：2009-05-08T10:32:47.053
> 
> 标签：asp.net, sql-server, vb.net, drop-down-menu, concatenation

在 sql 表中有一个 id、名字和姓氏字段。我想连接名字和姓氏字段并将其显示为下拉控件中的一个。

这是 vb.net 代码：

```
con()
    sqry = "[SELECT QUERY]"
    sqcom = New SqlCommand(sqry, sqcon)
    da.SelectCommand = sqcom

    ds.Clear()
    da.Fill(ds)
    ddl_adv.DataSource = ds
    ddl_adv.DataTextField = "emp_fname"
    ddl_adv.DataValueField = "emp_no"

    ddl_adv.DataBind()
    sqcon.Close() 
```

^此代码仅显示名字。我如何在 asp.net 中进行连接？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-08T10:42:08.717

如果你使用这样的东西，它会起作用吗？

```
sqry = "SELECT emp_no, emp_fname+' '+emp_lname as emp_fullname FROM employee"
sqcom = New SqlCommand(sqry, sqcon)
da.SelectCommand = sqcom

ds.Clear()
da.Fill(ds)
ddl_adv.DataSource = ds
ddl_adv.DataTextField = "emp_fullname"
ddl_adv.DataValueField = "emp_no"

ddl_adv.DataBind()
sqcon.Close() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T10:43:03.923

您需要重新处理数据对象中的项目（`ds`在您的情况下）以包含一个属性，该属性是名字和姓氏的串联。

您使用的是哪个版本的 VB.NET？如果您正在使用（或可以使用）.NET 3.5，那么您可能会发现[LINQ to SQL](http://weblogs.asp.net/scottgu/archive/2007/05/19/using-linq-to-sql-part-1.aspx)（或[其他 ORM](http://en.wikipedia.org/wiki/List_of_object-relational_mapping_software)）将使您的数据访问生活更轻松，因为它为您提供了与数据库中的数据相关的强类型对象。

# java - 什么时候可以从 Servlet 抛出 ServletException？

> ID：839225
> 
> 赞同：17
> 
> 时间：2009-05-08T10:33:01.780
> 
> 标签：java, servlets

过去我一直在抛出`ServletException`s，当 Servlet 中出现某些/任何问题时，通常只是将异常包装在`ServletException`.

现在我认为实际上最好不要抛出 a`ServletException`而是响应`response.sendError(sc)`并使用正确的 HTTP 状态代码。

如果我不能使用`reponse.sendError`, ( `IOException`) 发送错误，我将其包装`IOException`在`ServletException`.

以上是更好的回应方式吗？什么时候可以扔一个`ServletException`？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-03-06T03:14:17.440

我刚刚得出与@alamar 相反的结论。我的情况是编写一个 REST 样式的 servlet，由 Oracle 数据库中的代码调用，而不是由人类调用。

当请求信息无效或丢失时，我想向调用者返回 HTTP 代码*400 Bad Request 。*抛出 a`ServletException`会导致容器返回*500 Internal Server Error*，这表明服务器有问题，而不是请求。

这是我采用的解决方案。

1.  创建一个简单的异常类`RequestException`，扩展`Exception`.
2.  使用 throw 的方法检查请求的有效性`new RequestException(message)`。
3.  捕获`RequestException`servlet 的`doPost`方法并`HttpServletResponse.sendError()`像这样调用：

    ```
    try {
        validateRequest(request);
        // Do stuff with a valid request.
    } catch (RequestException e) {
        response.sendError(HttpServletResponse.SC_BAD_REQUEST, e.getMessage());
    } 
    ```

消息将返回给调用者，就像使用`ServletException`.

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-08T10:49:40.740

最好扔一个`ServletException`。

稍后您可以在您`web.xml`的 .

如果您只是使用`sendError()`，则在不同程度上无法做到这一点。

# linux - 如何在 Unix 系统上编辑二进制文件

> ID：839227
> 
> 赞同：66
> 
> 时间：2009-05-08T10:33:49.250
> 
> 标签：linux, unix, binaryfiles, hex-editors

在 Windows 机器上，有许多第三方编辑器可用于编辑二进制文件。

知道如何在 Unix 系统上编辑二进制文件吗？

* * *

## 回答 #1

> 赞同：120
> 
> 时间：2009-05-08T12:24:40.037

在 vim 中你可以输入**:%!xxd**把它变成一个十六进制编辑器。**:%!xxd -r**回到正常模式。xxd 在 vi​​m 安装中提供。

有关使用 vim 编辑二进制文件的一些说明，请参见[此处](http://vimdoc.sourceforge.net/htmldoc/editing.html#edit-binary)（归结为**:set binary**以避免麻烦，仅使用“R”或“r”命令更改文本，不要删除字符）。

如果您是 Emacs 粉丝，请参阅[此处](http://www.delorie.com/gnu/docs/emacs/emacs_464.html)以获取有关如何使用 Emacs 编辑二进制文件的指南。

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2009-05-09T04:34:56.397

您也可以尝试 ghex2 GNOME 实用程序。这为您提供了侧面的自动十六进制到 ASCII，以及底部的各种字符/整数解码。 [（来源：][[googlepages.com](http://kmbrandt.googlepages.com/hexeditor.jpg)][）][![ghex2](https://i.stack.imgur.com/gWSg1.jpg)](https://i.stack.imgur.com/gWSg1.jpg)

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-05-09T15:35:01.110

Linux/Unix 上有更多的十六进制编辑器......

我在 Ubuntu 上使用 hexedit

```
sudo apt-get install hexedit 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-05-08T10:38:07.260

你可以查看[维基百科](http://en.wikipedia.org/wiki/Comparison_of_hex_editors)。

我特别喜欢[BIEW](http://biew.sourceforge.net/)。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-05-08T13:15:17.310

# [Bless](http://home.gna.org/bless/)是一个高质量、全功能的十六进制编辑器。

它是用 mono/Gtk# 编写的，它的主要平台是 GNU/Linux。但是，它应该能够在 mono 和 Gtk# 运行的每个平台上毫无问题地运行。主要功能 Bless 目前提供以下功能：

*   高效编辑大型数据文件和块设备。
*   多级撤消 - 重做操作。
*   可定制的数据视图。
*   在屏幕上快速呈现数据。
*   多个选项卡。
*   快速查找和替换操作。
*   数据转换表。
*   高级复制/粘贴功能。
*   突出显示文件中的选择模式匹配项。
*   基于插件的架构。
*   将数据导出为文本和 html（其他带有插件）。
*   数据的按位运算。
*   全面的用户手册。

[从 http://home.gna.org/bless/ 复制](http://home.gna.org/bless/)

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2015-08-16T11:07:35.160

我曾经使用过[bvi](http://bvi.sourceforge.net/)。

我正在开发[hexvi](https://github.com/rr-/hexvi)来克服`:%!xxd`和`bvi`的限制。

## 六六

特征

*   类似 vim 的键绑定和命令
*   去特定的偏移量
*   插入、替换、删除
*   搜索东西（PCRE 正则表达式）
*   一切都是命令，可以映射到`hexvirc`
*   配色方案
*   支持大文件
*   支持多个文件（通过选项卡）
*   Python 所以入门级别应该低于 C
*   CLI 贯穿始终

缺点

*   截至 2016 年 3 月，它是 alpha 版，因此缺少功能，但我正在研究这些：
    *   文件保存
    *   撤销重做
    *   命令历史
    *   视觉选择
    *   手册页
*   没有自动完成

## 英属维尔京群岛

特征

*   类似 vim 的键绑定和命令
*   去特定的偏移量
*   插入、删除、替换
*   搜索东西（文本和十六进制）
*   撤销重做
*   CLI 贯穿始终

缺点

*   关于它的 vim 功能 - 不幸的是，它只理解最基本的东西，在这方面肯定需要更多的爱（例如：不理解`:wq`，但理解`:w`和`:q`）
*   没有任何视觉选择支持
*   没有标签/分屏支持
*   经常崩溃
*   不支持大文件
*   没有命令历史
*   没有自动完成

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2016-03-29T13:50:22.417

作为变体，您可以使用[radare2](http://radare.org)：

```
> r2 -w /usr/bin/ls

[0x004049d0]>V

[0x004049d0 14% 1104 (0x0:-1=1)]> x @ entry0
- offset - | 0 1  2 3  4 5  6 7  8 9  A B  C D  E F| 0123456789ABCDEF
0x004049d0 |31ed 4989 d15e 4889 e248 83e4 f050 5449| 1.I..^H..H...PTI
0x004049e0 |c7c0 103a 4100 48c7 c1a0 3941 0048 c7c7| ...:A.H...9A.H..
0x004049f0 |202a 4000 e877 dcff fff4 660f 1f44 0000|  *@..w....f..D..
0x00404a00 |b807 e661 0055 482d 00e6 6100 4883 f80e| ...a.UH-..a.H...
0x00404a10 |4889 e576 1bb8 0000 0000 4885 c074 115d| H..v......H..t.]
0x00404a20 |bf00 e661 00ff e066 0f1f 8400 0000 0000| ...a...f........
0x00404a30 |5dc3 0f1f 4000 662e 0f1f 8400 0000 0000| ]...@.f.........
0x00404a40 |be00 e661 0055 4881 ee00 e661 0048 c1fe| ...a.UH....a.H..
0x00404a50 |0348 89e5 4889 f048 c1e8 3f48 01c6 48d1| .H..H..H..?H..H.
0x00404a60 |fe74 15b8 0000 0000 4885 c074 0b5d bf00| .t......H..t.]..
0x00404a70 |e661 00ff e00f 1f00 5dc3 660f 1f44 0000| .a......].f..D..
0x00404a80 |803d c19b 2100 0075 1155 4889 e5e8 6eff| .=..!..u.UH...n.
0x00404a90 |ffff 5dc6 05ae 9b21 0001 f3c3 0f1f 4000| ..]....!......@.
0x00404aa0 |bf10 de61 0048 833f 0075 05eb 930f 1f00| ...a.H.?.u......
0x00404ab0 |b800 0000 0048 85c0 74f1 5548 89e5 ffd0| .....H..t.UH....
0x00404ac0 |5de9 7aff ffff 662e 0f1f 8400 0000 0000| ].z...f.........
0x00404ad0 |488b 0731 d248 f7f6 4889 d0c3 0f1f 4000| H..1.H..H.....@. 
```

有关如何在可视模式下工作的详细信息，您可以[在此处阅读](https://radare.gitbooks.io/radare2book/content/visual_mode/intro.html)

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-05-08T16:03:39.760

我喜欢**KHexEdit**，它是[KDE的一部分](http://www.kde.org)

对于大多数人来说，它的“Windows 风格”用户界面可能很快就能学会（无论如何，与 Vim 或 Emacs 相比 :)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-05-08T10:46:55.100

有轻量级的二进制编辑器，检查 hexedit。[http://www.linux.org/apps/AppId_6968.html](http://www.linux.org/apps/AppId_6968.html)。我尝试使用它至少在 Linux 中编辑 ELF 二进制文件。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2011-03-19T22:37:32.243

我制作了 wxHexEditor，它是开源的，用 C++/wxWidgets GUI 库编写，甚至可以打开你的 EB 大小的磁盘！

[http://wxhexeditor.sf.net](http://wxhexeditor.sf.net)

你试一试。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-05-08T15:49:44.270

对于小的更改，我使用了 hexedit：

[http://rigaux.org/hexedit.html](http://rigaux.org/hexedit.html)

简单但快速且有用。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2012-01-31T20:25:50.250

我在[wxHexEditor](http://www.wxhexeditor.org/)方面有很好的经验……只要确保你正在对驱动器进行十六进制编辑，你就可以通过菜单进行操作

```
Devices -> Open Disk Device -> SCSI Disk Drive Partition #_N_ 
```

# xml - 什么是 XML 信息集，它与 XML 文档有何不同？

> ID：839229
> 
> 赞同：17
> 
> 时间：2009-05-08T10:34:13.493
> 
> 标签：xml, xml-validation, well-formed, infoset

我试图阅读[http://www.w3.org/TR/xml-infoset/](http://www.w3.org/TR/xml-infoset/)和[维基百科条目](http://en.wikipedia.org/wiki/XML_Information_Set)。但坦率地说，我仍然不确定有什么区别。

报价单 ：

> 如果 XML 文档格式正确且满足名称空间约束，则它具有信息集。为了拥有信息集，XML 文档不要求有效。

从维基百科条目似乎没有意义。一个无效的文档怎么可能有任何语义，因此它怎么可能是一个“信息”集？

这个“信息集”是什么

> 格式良好并满足命名空间约束

XML有？以及它本身以何种方式有用。换句话说，从语义上讲，为什么有必要定义**XML**信息集？有没有不能用 XML 表示的信息？如果是这样，我可以看到 XML Infoset 的限制集，但如果不确定，XML Infoset 是否与术语“信息”一样毫无意义？

**感谢您提供有趣的答案：** *我仍然无法理解为什么 Xml 信息集有任何用途，而不是术语信息集。但是你们已经给了我这个问题的直接答案*。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-08T10:43:15.547

XML 不是文本。XML“是”XML 信息集。然后可以将其序列化为 XML 文档中的文本，但实际情况是 XML 信息集。

例如，信息集可能作为 DOM 树存在于内存中。它作为抽象对象模型的实现存在于内存中。

如果我将其序列化为 UTF-8，然后将其序列化为 UTF-16。结果可能是两组不同的位，但信息集相同。

还要考虑使用文本进行字符串连接之类的事情是有意义的。您不想将“<”连接到 XML 元素的中间。您必须先对其进行编码。如果只是文本，为什么要这样做？例如，如果您使用 DOM，您只需说 element.InnerText = "<"; 序列化时，“<”将被编码为“<”。然而，它是相同的信息集。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-10-01T11:55:53.547

思考 XML 文本和 XML 信息集之间区别的一种有用方法是考虑[快速信息集](http://en.wikipedia.org/wiki/Fast_Infoset)。这是 XML 信息集的二进制表示。

所以你有一个抽象的“信息集”，它是一个表示 XML 数据（节点、元素、属性等）的概念模型。这可以物理地表示为文本 XML 文档，或快速信息集流。两者都代表相同的数据，但方式完全不同。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-08T10:37:50.177

有效的 XML 文档满足 DTD 或 XSD（或其他标准）的要求。如果它格式正确，如果它违反了给定 DTD 或 XSD 中的规则，它仍然可能是“无效的”。

编辑：我是 XML 领域的新手，但看起来信息集是 XML 文档各部分的“抽象级别”描述，独立于实际的技术实现 - 例如，可能是文档对象模型执行。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-08T21:52:05.867

XML 信息集是一组抽象概念，例如可用于描述有效 XML 文档的属性和实体。根据规范，“一个 XML 文档的信息集由许多信息项组成；任何格式良好的 XML 文档的信息集将至少包含一个文档信息项和其他几个信息项。”

仅仅因为 XML 文档是信息集并不意味着它符合 XSD 并且是有效的 XML 文档。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-12-12T10:44:25.073

请参阅 MSDN 的此链接。 [http://msdn.microsoft.com/en-us/library/aa468561.aspx](http://msdn.microsoft.com/en-us/library/aa468561.aspx)

这是对这些概念的一个非常好的解释，希望能让你清楚。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-10-01T11:50:35.103

我刚刚遇到的一个很好的例子是[David Chappell 的 WCF PDF](http://www.davidchappell.com/IntroducingWCFv1.2.1.pdf)。这是使用 TCP 时的工作方式，例如：

> 为了在通信双方都基于 WCF 构建时获得最佳性能，在这种情况下使用的线路编码是 SOAP 的优化二进制版本。消息仍然符合 SOAP 消息的数据结构，称为其 Infoset，但它们的编码使用该 Infoset 的二进制表示，而不是 XML 的标准尖括号和文本格式。使用此选项对于与呼叫中心客户端应用程序进行通信是有意义的，因为它也是基于 WCF 构建的，并且性能是最重要的问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-05-25T14:38:41.793

XML是一种语言，所以它有语法，而XML Infoset有数据模型的规范，这是因为应用程序需要基于数据模型而不是语法；XML 位于 XML Infoset 之前；参考：Web Linkbase Access 的协议注意事项

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-09-04T13:26:46.537

XML Infoset 是关于如何构建序列化 XML 文档的要求。

序列化的 XML 可以有不同的形式，例如一些二进制格式（[快速信息集](https://en.wikipedia.org/wiki/Fast_Infoset)）或文本（最流行的形式）。

基本上对于 XML 文档格式（文本），每个元素和属性都应该通过相应的命名空间在 XSD 中定义。

[在这里](https://www.w3.org/TR/xml-infoset/#example)你会找到一个例子。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-10-02T06:28:46.603

XML 信息集是一**组定义**，用于需要**引用 XML 文档中的信息的**其他规范。

**XML 信息集**的目的是提供一组一致的定义，以供其他规范使用，这些规范需要引用格式良好的**XML 文档**中的信息。

获取 XML 信息集的方法之一是解析 XML 文档。

XML 文档的信息集由许多**信息项**组成。术语“信息集”和“信息项”在含义上与通用术语“树”和“节点”相似。

可以在[XML 信息集](https://www.w3.org/TR/xml-infoset/)上找到详细信息。

# java - FileChannel#map的内存使用情况

> ID：839230
> 
> 赞同：5
> 
> 时间：2009-05-08T10:34:45.910
> 
> 标签：java, memory-management, mmap

[`FileChannel#map`](http://java.sun.com/javase/6/docs/api/java/nio/channels/FileChannel.html#map(java.nio.channels.FileChannel.MapMode,%20long,%20long))是立即分配结果所需的所有内存`ByteBuffer`，还是仅在从缓冲区读取期间按需分配？

我刚刚尝试在一个简单的测试程序中映射所有 500+ MB 的文件，并查看了进程的内存使用情况。（`Runtime#totalMemory`在 OS X 活动监视器中同时使用并在 groovysh 进程中观察它。）内存使用量从未超过 30-ish MB。

那么，Java 实现是否可以在本机调用中“隐藏”一些内存使用情况？如果是这样，有没有办法找出 OS X 上有多少？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-08T10:51:22.453

内存使用从来都不是直截了当的。实际使用的缓冲区`FileChannel.map`不是 Java 堆的一部分。实际上，内存可能与其他进程共享。在触摸页面之前，甚至可能无法从光盘中读取文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T14:37:41.823

是的。它不是堆的一部分。尽管如此，根据操作系统的不同，仍然会保留内存。在 OS X 上，因为它类似于 UNIX，您应该能够使用 top 或 ps 来检查它需要多少内存。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-03-18T16:08:31.940

java.nio.MappedByteBuffer#load 将触发将所有文件内容加载到内存中（否则它是按需的）：

> 此方法尽最大努力确保在返回时 * 此缓冲区的内容驻留在物理内存中。调用此 * 方法可能会导致发生一些页面错误和 I/O 操作。

# django - 我应该放弃 Google App Engine 吗？

> ID：839231
> 
> 赞同：5
> 
> 时间：2009-05-08T10:35:18.577
> 
> 标签：django, google-app-engine, web-frameworks

我正在 GAE 上开发某种金融市场模拟。虽然我已经取得了很大的进步，但最近几天我开始考虑放弃 GAE 并寻求 Django + rdbms 解决方案。说一下我的理由：

1.  交易：GAE 支持单一实体组的交易。如果应用程序涉及复杂的交易，例如金融市场中的交易，则不能使用此机制（阅读：没有可用的交易机制）。一些高尚的用户已经开发了解决此问题的解决方案，但尚未发布，据说仅在 java 中可用。

2.  全文搜索：很讽刺，但目前有一个非常原始的API。此外，路线图中没有提到改进。

3.  分页：开发一个友好的分页机制不适合胆小的人（或按时限）。

4.  后台进程：batch 在金融应用中很重要，暂时得用 Cron 做实验。但我认为后台进程已在路线图中，并将在短时间内可用。

我选择 GAE 是为了缩短开发时间，轻松应对未来可能出现的可扩展性问题。我真的很喜欢 GAE，它有一些出色的功能，但是一起解决这些问题需要付出太多的努力，而且很可能会抵消掉使用 GAE 的任何好处。

如果你是我，你会怎么做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-20T19:03:40.603

1.  事务：你是对的，GAE 不能处理复杂的查询，但是使用 Big-Table 方法没有任何东西能够像 RDB 那样处理复杂的计算。

2.  全文搜索：使用“原始”API 进行全文搜索后，您应该远离它，它非常乏味，而且绝不可扩展（如果我没记错的话，不能组合四个以上的词来搜索）。

3.  后台进程：最新版本中可用的 CRON 进程还不错，但我认为您希望在后台进程上做更多事情。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-08T11:16:00.770

如果您需要后台事务+类似云的可扩展性，[亚马逊弹性云计算](http://aws.amazon.com/ec2/)是我所知道的唯一可能。它有点难以维护，因为你基本上得到了整个操作系统，但这也让你可以灵活地运行任何你想要的东西..

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-12T14:04:44.667

在仔细研究了这个主题之后，我决定使用 django + rdbms 解决方案。GAE 似乎需要时间才能成熟。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-08T11:40:17.850

正如 Andreas 所说，看看 Amazon Web Services，它是一个严肃的生产环境，会为您提供许多您可能还没有想到的东西，包括内容交付网络（节省您的带宽）、简单的数据库和有趣的（但我我还没有想到我可以使用它的用途）Machanical Turk 服务，哦，一年和 EC2 虚拟服务器 - 在这些服务器上运行任何你喜欢的东西。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-08T11:08:15.500

正如您所了解的，通常直到使用一段时间后，才会发现像 GAE 这样的开发环境的所有问题和陷阱。这很可能适用于任何环境。

在提交到替代环境（Django + rdbms）之前，您对该平台的熟悉程度如何？如果您不熟悉它，您可能会发现遇到其他问题。

另一方面，如果您完全熟悉 Django + rdbms，那就另当别论了。当然有人想知道你是否熟悉它们，为什么一开始选择 GAE？您一定觉得它提供了一些好处，而放弃 GAE 会放弃这些好处。

也许您需要列出每个平台的优缺点，然后尝试平衡这些列表以做出决定。最终没有灵丹妙药，无论你走哪条路，无疑都会遇到一些问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-08T10:58:54.667

移动它需要多少工作量？很高兴听到您使用 GAE 的经历。

我一直认为最好有更多的控制权，如果你碰到砖墙，你应该移动。这是我的看法，希望对你有帮助！

# c - 在 C 中使用 popen() 失败？

> ID：839232
> 
> 赞同：4
> 
> 时间：2009-05-08T10:35:37.873
> 
> 标签：c, screenshot, popen, piping, x11

我可以运行以下命令

`xwd -root | xwdtopnm | pnmtojpeg > screen.jpg`

在 linux 下的终端中，它将生成我当前屏幕的屏幕截图。

我尝试使用代码执行以下操作：

```
#include <stdio.h>
#include <stdlib.h>
int main()
{
   FILE *fpipe;
   char *command="xwd -root | xwdtopnm | pnmtojpeg";
   char line[256];

   if ( !(fpipe = (FILE*)popen(command,"r")) )
   {  // If fpipe is NULL
      perror("Problems with pipe");
      exit(1);
   }

   while ( fgets( line, sizeof line, fpipe))
   {
      //printf("%s", line);
      puts(line);
   }
   pclose(fpipe);
} 
```

然后我编译并运行程序`./popen > screen.jpg`，但生成的文件 screen.jpg 无法识别。我怎样才能做到这一点，以便我可以正确地通过我的程序？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-08T10:46:25.787

您不应该使用`fgets`and`puts`来处理二进制数据。`fgets`只要看到换行符就会停止。更糟糕的是，`puts`将输出额外的换行符，并且在遇到 \0 时也会停止。使用`fread`and`fwrite`代替。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-08T11:02:30.960

这些函数`fgets`和`puts`不打算与图像文件等二进制数据一起使用。它们只能与文本字符串一起使用。在 C 中，字符串以空字节 ( `'\0'`) 结尾。由于这实际上只是一个零，它可能出现在二进制文件的任何位置。假设它`line[]`充满了 256 个字符的数据。当您调用 时`puts`，该函数会读取数组，直到遇到空字节，然后假定它已到达字符串的末尾并停止。由于在二进制文件中，空字节可能出现在任何地方（而不仅仅是在数组的末尾），因此该`puts`函数很容易无法打印出您的数据部分。

如果我是你，我会研究`fread`and`fwrite`函数并使用它们。在 Linux 机器上，您应该只能通过键入`man 3 fread`来阅读这两个函数的文档。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-08T20:34:27.270

For those having this same problem, I ended up finally getting it working by using the Unix read/write system calls:

```
#include <stdio.h>
#include <stdlib.h>
#include <fcntl.h>
#include <sys/stat.h>
#include <sys/types.h>

//writes to an output file test.jpg directly
int main()
{
    FILE *fpipe;
    char *command="xset b off  && xwd -root | xwdtopnm 2> /dev/null | pnmtojpeg";
    char buff[256];
    size_t result_write;
    size_t result_read;

    if ( !(fpipe = (FILE*)popen(command,"r")) )
    {  // If fpipe is NULL
        perror("Problems with pipe");
        exit(1);
    }

    int dest_fd = open("test.jpg",  O_RDWR|O_TRUNC|O_CREAT, S_IRUSR|S_IWUSR );
    int fd = fileno(fpipe);
    while((result_read = read(fd, buff, sizeof(char)*256))>0){  
        if(result_read < 0){
            perror("Problem while reading.\n");
            exit(1);
        }
        result_write = write(dest_fd, buff, sizeof(char)*256);
        if(result_write < 0){
            perror("Probelms writing to outputfile.\n");
            exit(1);
        }   
    }
    close(dest_fd);     
   pclose(fpipe);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-08T10:42:52.787

在没有测试您的代码的情况下，我怀疑“xwd -root | xwdtopnm | pnmtojpeg”是否可以作为 C 管道的参数。

无论如何，我不会使用 C 程序来解决这样的问题。请改用简单的 Bash 脚本。

# windows - 监控串口

> ID：839236
> 
> 赞同：1
> 
> 时间：2009-05-08T10:36:55.450
> 
> 标签：windows, monitoring, serial-port, dial-up

我正在使用通信程序（Tera Term）通过拨号连接与另一台计算机通信。我将使用此软件发送文件，但我想监视端口（如 PortMon）以测量传输文件所需的时间。你知道没有这个软件有什么方法吗？

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T13:50:03.733

如果你喜欢冒险，你可以自己写。[这里](http://www.ddj.com/windows/184416559)有一篇 Dobbs 博士的文章会告诉你怎么做。

或者，您可以尝试使用硬件分离器。

# iphone - iPhone - 如何将通过系统设置应用程序看到的设置包放入您自己的应用程序中？

> ID：839242
> 
> 赞同：7
> 
> 时间：2009-05-08T10:38:07.710
> 
> 标签：iphone, settings

我想在我的应用程序中创建一个设置页面，该页面看起来与我使用 Settings.bundle 和 Root.plist 在系统设置应用程序中创建的页面完全相同。

是否有一种简单的方法可以访问 PSMultiValueSpecifier 等控件并将它们添加到实际视图中？

谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2010-02-12T06:10:15.683

这是另一个解决方案：

*   [http://www.inappsettingskit.com/](http://www.inappsettingskit.com/)

    > InAppSettingsKit 是一个开源解决方案，可以轻松地将应用内设置添加到您的 iPhone 应用程序。它通过维护 Settings.app 窗格来使用混合方法。所以用户可以选择在哪里更改设置...
    > 
    > 要支持传统的 Settings.app 窗格，应用程序必须包含至少一个 Root.plist 的 Settings.bundle 以指定设置 UI 元素与 NSUserDefaults 键的连接。InAppSettingsKit 基本上只是使用相同的 Settings.bundle 来完成它的工作。这意味着当您想要包含新的设置参数时，无需额外的工作。它只需添加到 Settings.bundle 中，它就会出现在应用程序内和 Settings.app 中。支持所有设置类型，如文本字段、滑块、切换元素、子视图等...

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-08T14:03:56.133

关于设置是否应该在您的应用程序或偏好应用程序中的主题是有争议的，主要是因为无法从应用程序打开设置（如答案 coob 链接中所述）并且因为无法向设置添加交互- 您可能想要的原因有很多，包括有效性/一致性/网络检查等。

因此，如果您想呈现一个类似于应用程序中的设置 UI 的 UI，我不知道有任何简单或现成的代码可以做到这一点，但[Matt Gallagher 的代码](http://cocoawithlove.com/2008/12/heterogeneous-cells-in.html)是您自己推出的一个很好的开始。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-08T16:31:21.597

Craig Hockenberry 有一个名为[GenericTableViews](http://furbo.org/2009/04/30/matt-gallagher-deserves-a-medal/)的项目，它可以帮助您轻松地为设置或表单制作表格视图。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-02-12T06:26:00.653

还有另一个（由于“新手垃圾邮件保护”而单独发布抱歉）。

*   [http://bitbucket.org/keegan3d/inappsettings/wiki/Home](http://bitbucket.org/keegan3d/inappsettings/wiki/Home)
    更多信息在这里：inscopeapps.com/blog/inappsettings-vs-inappsettingskit

他们使用“标准”的 Settings.bundle 方法——但在应用程序中呈现相当容易。您还可以免费获得系统“设置”行为。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-06-04T19:19:32.067

还有另一种选择：

*   [我的设置](http://bitbucket.org/karemorstol/mysettings/overview)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-08-30T03:52:26.893

在 iOS 8 及更高版本上，如果您已经有一个设置包，那么从您的应用程序启动到设置应用程序来管理它非常容易：（Swift 3 示例）

```
if let settingsURL = URL(string: UIApplicationOpenSettingsURLString) {
            UIApplication.shared.open(settingsURL)
        } 
```

# vba - 使用 VBA 在新实例中打开 excel 2007 时出现问题（使用 OLE 和绑定对象框架）

> ID：839243
> 
> 赞同：2
> 
> 时间：2009-05-08T10:38:08.757
> 
> 标签：vba, excel-2007, ole, instances

我在使用 VBA（来自 Access 2002）创建新的 excel 2007 实例时遇到问题。

起初我误解了这个问题，它比我想象的要复杂。

```
Set myXL = CreateObject("Excel.Application") 
```

创建新进程（我以为没有），但仍然发生奇怪的事情。我使用 OLE 将 Excel 文件存储在 SQL Server 数据库中。

这是将 excel 文件绑定到表单的函数：

```
Public Function OpenExcelObjFrame() As BoundObjectFrame
    Dim myXL As Object

    Set myXL = CreateObject("Excel.Application") '#1

    Set gTempWorkbook = myXL.Workbooks.Add
    myXL.Visible = True               '#2

    DoCmd.OpenForm "Excel_OBJ"
    Forms("Excel_OBJ").Visible = False
    Forms("Excel_OBJ").RecordSource = "SELECT Excel_File FROM Excel_File_Obj;"
    Set OpenExcelObjFrame = Forms("Excel_OBJ").Excel_File
End Function 
```

上下文：

```
Dim tExcelObjFrame As BoundObjectFrame
Set tExcelObjFrame = OpenExcelObjFrame()

tExcelObjFrame.Verb = acOLEVerbOpen
tExcelObjFrame.Action = acOLEActivate '#3 
```

**ad 1**第二个进程 excel.exe 启动

**ad 2**添加了这一行来检查第二个过程发生了什么

**ad 3** OLE 将文件绑定到现有的 excel 实例，第二个进程在这里被杀死：/

所以问题是：

1.  为什么 tExcelObjFrame.Action = acOLEActivate 会杀死第二个进程

2.  如何在第二个过程中强制对象框架激活 excel 文件

**编辑**

我在这里找到了部分解释（没有明确的解决方案）：

[http://www.xtremevbtalk.com/showthread.php?t=292170](http://www.xtremevbtalk.com/showthread.php?t=292170)

> 1.  如果没有正在运行的 Excel 实例，OLE 会在您直接或通过编程访问该对象时创建一个 Excel 实例。
> 2.  如果 Excel 的实例已在运行，则这是 OLE 对象使用的实例。

问题是 OLE 对象选择了错误的 excel 实例。问题是是否有办法将 OLE 指向特定实例。

此处描述的相同问题（未给出解决方案）：

[http://groups.google.com/group/microsoft.public.win32.programmer.ole/browse_thread/thread/9c4cde2a79453037](http://groups.google.com/group/microsoft.public.win32.programmer.ole/browse_thread/thread/9c4cde2a79453037)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T10:45:43.637

**更新：**
我一直在我的工作站上尝试您现有的代码，并且：

```
Set myXL = CreateObject("Excel.Application") 
```

似乎按您的要求工作。
我打开了一个进程，然后运行该行并创建另一个进程。

我一直在进一步调查，结果发现这是 Excel 2007 的一个怪癖。
我一直在查看的所有内容都让我回到 Windows[文件类型](http://answers.google.com/answers/threadview/id/728295.html)（向右滚动到底部）或[注册表](http://www.eggheadcafe.com/conversation.aspx?messageid=33740759&threadid=32321083)黑客，这在这种情况下基本上都在改变同样的事情。

我知道在 VBA 中，您可以使用 CreateNewKey 和 SetKeyValue 来处理注册表项，但我不确定您是否愿意这样做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-06-16T20:45:50.657

```
Sub New_Excel()

'Create a Microsoft Excel instance via code using late binding. (No references required)

Dim xlApp As Object

Dim wbExcel As Object

'Create a new instance of Excel

Set xlApp = CreateObject("Excel.Application")

'Open workbook

Set wbExcel = xlApp.Workbooks.Open("Book1")  'or you may place here the complete name and path of the file you want to open upon the creation of the new instance

'Set the instance of Excel visible. (It's been hiding until now)

xlApp.visible = True

'Release the workbook and application objects to free up memory

Set wbExcel = Nothing

Set xlApp = Nothing

End Sub 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T12:25:57.427

尝试在单个 Excel 2007 实例中打开多个工作簿时，我遇到了类似的问题 - 在 Excel 2003 中这工作正常，但现在它们都在同一个实例中打开。

我不知道这是否也能解决您的问题，但我通过告诉 Excel 不要使用 DDE（选项、高级、常规、忽略使用 DDE 的其他应用程序）来修复它（或让它按我想要的方式工作！）。请注意，如果您这样做，您需要更改资源管理器中所有启动 Excel 的文件类型，因为它们默认使用 DDE - 编辑文件选项，取消选中“使用 DDE”并在末尾添加“%1”命令行。

（实际上，我认为这可能会回答安迪的回答中的评论，其中只创建了一个 Excel 实例，但不一定有助于解决打开多个实例的原始*问题*）

# java - Swing、mouseClicked 和 Z-Order

> ID：839245
> 
> 赞同：0
> 
> 时间：2009-05-08T10:39:07.210
> 
> 标签：java, swing

我有一个空布局的 JFrame 和两个单字符 JLabels 在同一位置。

当我添加一个 MouseListener 时，MouseClicked 事件总是转到第一个 JLabel，即使它在那里有一个透明像素。有解决方案吗？

（例如：我显示“a”和“á”，我需要知道用户是点击了字符还是重音）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-08T10:46:34.010

IIRC，您需要调用`setOpaque`false 和 override `contains(int,int)`。

# django - 'Answer' 实例需要有一个主键值才能使用多对多关系

> ID：839250
> 
> 赞同：2
> 
> 时间：2009-05-08T10:40:38.517
> 
> 标签：django, django-models, many-to-many

我有一个名为的模型`Answer`，它`ForeignKey`与另一个名为`Question`. 这意味着自然可以有多个问题的答案。

```
class Question(models.Model):
    kind = models.CharField(max_length=1, choices=_SURVEY_QUESTION_KINDS)
    text = models.CharField(max_length=256)

class Answer(models.Model):
    user = models.ForeignKey(User, related_name='answerers')
    question = models.ForeignKey(Question)
    choices = models.ManyToManyField(Choice, null=True, blank=True) # <-- !
    text = models.CharField(max_length=_SURVEY_CHARFIELD_SIZE, blank=True) 
```

现在我正在尝试创建一个`Answer`实例，然后将 M2M 关系设置为`Choice`，但在接触 M2M 之前出现以下错误：`'Answer' instance needs to have a primary key value before a many-to-many relationship can be used.`

```
 ans = Answer(user=self._request.user,
              question=self._question[k],
              text=v)
 ans.save() # [1] 
```

当我注释掉`[1]`问题时，问题当然消失了，但我不明白为什么它首先出现，因为如您所见，我*对 M2M 根本没有做任何事情！*

* * *

编辑：名称似乎也不是问题`choices`。我尝试将其每次出现都更改`options`为相同的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-08T11:56:44.037

感谢所有花时间在这个问题上的人。我的问题中提供的类不完整，因为我认为内部`Meta`类无关紧要。事实上，`Answer`看起来像这样：

```
class Answer(models.Model):
    """
    We have two fields here to represent answers to different kinds of
    questions.  Since the text answers don't have any foreign key to anything
    relating to the question that was answered, we must have a FK to the
    question.
    """

    class Meta:
        order_with_respect_to = 'options'

    def __unicode__(self):
        return '%s on "%s"' % (self.user, self.question)

    user     = models.ForeignKey(User, related_name='answers')
    question = models.ForeignKey(Question)
    options  = models.ManyToManyField(Option, blank=True)
    text     = models.CharField(max_length=_SURVEY_CHARFIELD_SIZE, blank=True)
    answered = models.DateTimeField(auto_now_add=True) 
```

看看`order_with_respect_to`你就会明白错误来自哪里。:)

# java - IBM MQ V6.0 是否设置了 JMSXDeliveryCount 属性？

> ID：839251
> 
> 赞同：4
> 
> 时间：2009-05-08T10:41:17.017
> 
> 标签：java, jms, ibm-mq

我需要在部署在 IBM 支持的环境中的应用程序中实现 JMS 消息的重新传递处理，因此 JMS 提供程序是独立的 MQ V6.0。

你知道它是否正确设置了 JMSXDeliveryCount 属性并且我可以依赖这个属性的值吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-14T09:55:38.267

我刚刚找到了我的问题的答案:)

IBM WebSphere MQ 设置以下 JMSX* 标头属性：

**JMSXUserId**将在您发送消息时由 WMQ JMS 设置 - 它查看运行应用程序的用户 ID 并相应地设置 JMSXUserId。

**JMSXAppId**也将在您发送消息时由 WMQ JMS 设置 - 类似于“ *WebSphere MQ Client for Java* ”。关于如何解释这个 JMS 规范存在一些争论——一些 JMS 提供者允许应用程序设置它，而另一些则不允许。目前，WebSphere MQ 实现没有。

**JMSXDeliveryCount**将在消息发送到接收应用程序时由 WMQ JMS 设置 - 它告诉接收应用程序 WebSphere MQ 尝试将消息传递到该应用程序或其他应用程序的次数。通常，消息应该只传递一次，但在失败或事务显式回滚等情况下，传递计数可能会变得更高，应用程序或 JMS 提供者可以使用该信息来发现何时出现问题并可能做某事不同的是，例如将消息移动到死信队列，甚至丢弃消息，具体取决于消息的性质、应用程序和上下文。

# java - 我如何正确 Log4j，关闭所有 Appender，因此，文件

> ID：839255
> 
> 赞同：15
> 
> 时间：2009-05-08T10:42:28.277
> 
> 标签：java, servlets, resources, log4j

我的基于 servlet 的 web 应用程序有时无法在重新部署时关闭 Log4j 日志文件，泄漏到文件描述符泄漏，有时会导致包含 servlet 的文件因“打开的文件过多”而死亡。

我有一个 ContextListener，我应该在它的 contextDestroyed() 中放入什么来告诉 log4j 关闭并释放所有资源？

快速浏览 javadocs 揭示了带有 shutdown() 方法的 Hierachery 类。我不知道如何实际获取当前的 Hierachery，并且 javadoc 指出此类内部没有用户可维护的组件:)

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-05-08T11:01:14.830

试试这个：

```
org.apache.log4j.LogManager.shutdown(); 
```

但是，您遇到的问题很奇怪，不应该发生。您使用的是什么 JVM、容器、log4j 版本？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-11-15T13:52:11.170

我有同样的问题，但我的解决方案需要两个步骤：

首先，我必须`LogManager.shutdown()`从 servlets`destroy()`方法调用。

然后我必须修复`close()`我们自己的 Appender 实现的方法（它是 的子类`AppenderSkeleton`），以便它正确地关闭来自`getAllAppenders()`.

# c++ - 如何让 CMFCToolBar 识别图像蒙版？

> ID：839257
> 
> 赞同：1
> 
> 时间：2009-05-08T10:43:00.197
> 
> 标签：c++, transparency, mask, mfc-feature-pack, 24-bit

我有一个`CMFCToolBar`- 派生类，其实例是 -`CDockablePane`派生类的成员。

我查看了 VisualStudioDemo 示例以了解它是如何完成的，并且到目前为止：

```
int CMyPane::OnCreate(LPCREATESTRUCT lpCreateStruct)
{
    // Removed all "return -1 on error" code for better readability

    CDockablePane::OnCreate(lpCreateStruct);

    if(m_toolBar.Create(this, AFX_DEFAULT_TOOLBAR_STYLE, IDR_MY_TOOLBAR) &&
       m_toolBar.LoadToolBar(IDR_MY_TOOLBAR, 0, 0, TRUE /* Is locked */))
    {

        if(theApp.m_bHiColorIcons) // Is true, i.e. following code is executed
        {
            m_toolBar.CleanUpLockedImages();
            m_toolBar.LoadBitmap(IDB_MY_TOOLBAR_24, 0, 0, TRUE /*Locked*/);
        }

        m_toolBar.SetPaneStyle(m_toolBar.GetPaneStyle() | CBRS_TOOLTIPS | CBRS_FLYBY);
        m_toolBar.SetPaneStyle(m_toolBar.GetPaneStyle() & ~(CBRS_GRIPPER | CBRS_SIZE_DYNAMIC | CBRS_BORDER_TOP | CBRS_BORDER_BOTTOM | CBRS_BORDER_LEFT | CBRS_BORDER_RIGHT));

        m_toolBar.SetOwner(this);

        // All commands will be routed via this control , not via the parent frame:
        m_toolBar.SetRouteCommandsViaFrame(FALSE);
    }

    return 0;
} 
```

加载了高彩色图像（24 位），但可以看到洋红色蒙版 (R255 G0 B255)。我不知道如何告诉工具栏识别面具。
这甚至可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-14T18:05:52.253

我不知道这是否每次都有效，但我`RGB(192, 192, 192)`用作遮罩颜色并且它确实被识别。

（似乎 CMFCToolBar 控件已准备好`::GetSysColor(COLOR_BTNFACE)`用作透明颜色...）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T10:59:44.383

我刚刚发现一种解决方法是使用 32 位图像及其 alpha 通道。我之前尝试使用 32 位图像，但由于其他原因无法正常工作，然后发现 32 位图像无法正常工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-03-21T15:00:43.907

如果要使用 32 位图像，请不要`CBitmap`使用`ATL::CImage`or`CPNGImage object`并加载相应`resource ID`的 .

# mysql - 如何仅使用一台服务器镜像 MySQL 数据库

> ID：839265
> 
> 赞同：0
> 
> 时间：2009-05-08T10:44:49.020
> 
> 标签：mysql, replication

我需要经常将我的 MySQL 服务器上的一个数据库复制到同一台 MySQL 服务器上的镜像数据库。

我正在编写一个 bash 脚本，该脚本在一个单独的子域上生成我的 Web 应用程序（PHP/MySQL）的镜像。用户可以在不影响生产环境的情况下，通过这个镜像尝试各种疯狂的东西。该脚本应该每晚自动运行。

复制源代码很容易。我只是`rsync -a`用来将包含生产环境的目录中的所有内容复制到镜像目录并应用补丁来更新一些配置文件。问题在于复制数据库，该数据库的大小已增长到近 3 GB。

当我使用`mysqldump live_db | mysql mirror_db`时，复制数据库需要很长时间。此外，在此期间 CPU 使用率达到 100%，我的 Web 应用程序变得异常缓慢。

数据库复制似乎不是一种选择，因为我只有一个 MySQL 服务器。复制需要两台服务器。

复制生产数据库的最佳方法是什么？它不必很快，但不应过多影响系统的性能。当镜像脚本在后台运行时，人们应该仍然可以使用我的 Web 应用程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T13:22:26.747

我能想到的可能解决方案：

1) 购买更快的服务器

2）复制原始表。这并不理想，但如果它只是为了测试可能是可行的。

我假设您使用的是 MyISAM 表，但步骤如下：

*   理想情况下写锁生产数据库中的表，如果不可能，请忽略
*   将二进制表数据/索引从`/var/lib/mysql/production_schema`（或类似）复制到`/var/lib/mysql/development_schema`. `rsync -a`（以root身份运行）将是这样做的想法。
*   重启 MySQL 服务器（这是整个过程中你唯一的停机时间）
*   `CHECK/REPAIR`所有的标签`development_schema`

值得补充的是，我不会使用这种方法将数据从一个生产环境复制到另一个生产环境，而无需在复制之前停止服务器。

3）考虑是否需要开发环境中的所有生产数据。你能聪明点，只复制数据的一个子集吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T13:37:41.717

如果你有 MyISAM 表，你可以使用[mysqlhotcopy](http://dev.mysql.com/doc/refman/5.0/en/mysqlhotcopy.html)。

# c# - Windows Mobile：如何突出显示数据网格中的行和编译延迟

> ID：839268
> 
> 赞同：1
> 
> 时间：2009-05-08T10:45:58.660
> 
> 标签：c#, windows-mobile, datagrid

我有两个 Windows 移动问题：

1.  如何突出显示数据网格中的行（在我运行任何查询之后）？

2.  为什么20-30编译后，编译需要6-7分钟（第一次需要1分钟）？

*提前致谢！*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-10T19:55:19.133

对于 #1，请查看 Ilya Tumanov[在 DataGrid 中自定义格式数据](http://blogs.msdn.com/netcfteam/archive/2006/04/25/583542.aspx)的示例。他对其中的细胞进行了定制绘画。这就是您“突出显示”一行的方式。

对于＃2，您的环境有问题。我还没有看到或听说过它的报道，而且我已经使用 Studio 开发 CF 应用程序有一段时间了，一次运行超过 10-30 次编译。我的猜测是你有一个网络驱动器映射。取消映射并查看是否有任何变化（尽管 6-7 分钟确实令人发指）。此外，如果您正在使用包含大量项目的解决方案，则应该为所有内容提供一个输出目录，而不是每个项目都有自己的输出目录，并将所有引用的 CopyLocal 设置为 false。这有助于将构建期间的磁盘访问降至最低。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-04T14:05:19.830

对于#2：如果您使用的是 Visual Studio 2008，它也可能是 PostBuild 验证任务的问题。当我遇到问题时，以下链接为我指明了正确的方向：

[http://blogs.msdn.com/vsdteam/archive/2006/09/15/756400.aspx](http://blogs.msdn.com/vsdteam/archive/2006/09/15/756400.aspx)

# php - 如何在 SHTML 页面中包含 PHP 文件？

> ID：839272
> 
> 赞同：3
> 
> 时间：2009-05-08T10:46:35.663
> 
> 标签：php, file, include, webpage, shtml

我有一个 shtml 文件 index.shtml，我想在其中包含一个 PHP 文件，该文件执行一些编程并返回 HTML 数据。我正在尝试包含我的 PHP 文件，但我不知道该怎么做，我尝试了以下但没有任何效果，

以下行只是打印错误，“ **[处理此指令时发生错误]** ”：

```
<!--#include file="/SSI/test.php"--> 
```

此行显示一些垃圾字符：

```
<!--#include virtual="/SSI/test.php"--> 
```

此行不执行任何操作并在 .shtml 页面中显示命令

```
<?PHP 
    include("/SSI/test.php");
?> 
```

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-08T18:38:11.667

如果除了您提到的关于流量的内容之外，您使用 .shtml 没有特别的原因，您可以在 .htaccess 文件中更改其处理：

```
<Files *.shtml>
ForceType application/x-httpd-php
</Files> 
```

或者您可以特别指定该文件：

```
<Files filename.shtml>
ForceType application/x-httpd-php
</Files> 
```

这将告诉服务器解析 .shtml 就像它是一个 .php 文件一样，因此应该处理任何 PHP 命令，例如您的 include 语句。无需更改文件扩展名。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-03-16T03:41:53.450

我可能是错的，但是鉴于您遇到的错误，问题可能不在包含语句中，而是在要包含的 php 文件中的错误导致了问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T10:54:31.743

最后一个工作只需将您的 .shtml 重命名为 .php 但请注意，这将阻止其中的任何 shtml 工作。但这不应该是一个问题，如果你也将它重写为 php。

从您的评论中编辑：
如果您运行 apache，您可以在 .htacces 中添加以下内容，然后您可以将文件重命名为 .php

```
 redirect permanent filename.shtml filename.php 
```

这会将访问 example.com/filename.shtml 的人重定向到 example.com/filename.php

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-08T11:43:06.393

我认为您不能在 Apache 中使用（我不知道其他 Web 服务器）。[Apache 文档](http://httpd.apache.org/docs/2.2/howto/ssi.html)说“include_virtual”允许您包含 CGI 程序的结果；但 PHP 不是 Apache 术语中的 CGI 应用程序：它由不同的模块以不同的方式处理。

科林

# c++ - 异常后返回的对象？

> ID：839276
> 
> 赞同：1
> 
> 时间：2009-05-08T10:47:20.670
> 
> 标签：c++, exception, return-value

```
 int somefunction(bool a)
    {
      try
      {
        if(a)
        throw Error("msg");
        return 2;
      }
     catch (Error const & error)
     {
       //do i need to return anything here??
       //return -1;
     }
    } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-08T10:51:04.920

您需要返回某些内容或重新抛出异常（或抛出新异常）。您只需使用关键字即可重新引发相同的异常

```
throw 
```

在 catch 块中，之后没有异常或参数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T10:50:32.143

如果您不在那里返回任何东西，那么被调用者之后可能会做错事，因为返回值将是未定义的，并且可能会获得有效的返回码之一！试试这个：

```
printf("%i\n", somefunction(false));
printf("%i\n", somefunction(true)); 
```

输出：

```
2
2293512 
```

编译器还为此发出警告（fe“控制到达非无效函数的结尾”）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-08T10:52:20.673

该函数返回一个int，因此您需要返回一个int。另一种方法是不在函数中捕获异常并让它传播。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-08T10:56:06.497

首先，通过在第 9 行捕获您在第 6 行抛出的异常，您正在滥用异常。您基本上是在使用“if”语句执行正常程序流程可以执行的操作。通过将以这种方式抛出的异常添加到您的代码库中，将不再将异常用于真正的异常情况。当有一个简单的替代方案时，不要从你的函数中抛出异常。

也就是说，您可以通过`int`两种方式退出函数：

*   返回一个`int`
*   抛出异常

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-08T10:51:27.430

除非您重新抛出异常，否则您需要返回一个 int （可能是一个错误标记值）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-08T10:51:27.930

根据您的编译器/编译器设置，您将无法编译返回 int 的函数，该函数可能没有返回值，即“执行到达非 void 函数的结尾”。所以是的，你必须返回一个值，除非你想重新抛出异常。

# iphone - 检测设备是否正在充电

> ID：839279
> 
> 赞同：33
> 
> 时间：2009-05-08T10:49:34.423
> 
> 标签：iphone

[我用我最喜欢的工具](http://www.google.com)找不到任何确定的东西，但我想我会把它放在这里......

有没有办法使用 iPhone SDK 让应用程序检测设备是否处于通电状态（充电、坞站等）？

如果设备正在通电，我希望能够自动禁用 idleTimer（否则它是用户指定的设置）。

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2010-09-24T22:07:51.820

你最好使用：

```
[[UIDevice currentDevice] setBatteryMonitoringEnabled:YES];

if ([[UIDevice currentDevice] batteryState] != UIDeviceBatteryStateUnplugged) {
      [UIApplication sharedApplication].idleTimerDisabled=YES;
    } 
```

这是因为您必须关注 **两种**不同的状态——一种是电池正在*充电*，另一种是*充满电*。

如果您*真的*想完整了解它 - 您将注册以接收电池监控通知，因此如果用户断开主电源等，您可以重新启用空闲计时器。

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2009-05-08T12:36:15.703

是的，UIDevice 能够告诉你这个：

```
[[UIDevice currentDevice] setBatteryMonitoringEnabled:YES];

if ([[UIDevice currentDevice] batteryState] == UIDeviceBatteryStateCharging) {
    NSLog(@"Device is charging.");
} 
```

请参阅文档中的[UIDevice](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIDevice_Class/Reference/UIDevice.html)参考以获取更多信息，以及有关 batteryState 的其他值。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2016-03-10T08:12:44.223

**斯威夫特 4**

```
UIDevice.current.isBatteryMonitoringEnabled = true

if (UIDevice.current.batteryState != .unplugged) {
    print("Device is charging.")
} 
```

**斯威夫特 3**

```
UIDevice.currentDevice().batteryMonitoringEnabled = true;

if (UIDevice.currentDevice().batteryState != .Unplugged) {
    print("Device is charging.");
} 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2017-02-20T11:50:11.890

斯威夫特 3：

```
UIDevice.current.isBatteryMonitoringEnabled = true
let state = UIDevice.current.batteryState

if state == .charging || state == .full {
    print("Device plugged in.")
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-02-11T13:33:24.380

您可以使用[darwin 通知中心](https://developer.apple.com/library/mac/documentation/CoreFoundation/Reference/CFNotificationCenterRef/#//apple_ref/c/func/CFNotificationCenterGetDarwinNotifyCenter)并使用事件名称[com.apple.springboard.fullycharged](http://iphonedevwiki.net/index.php/SpringBoard.app/Notifications)。

这样，您将收到有关您的自定义方法的通知，这是一个代码片段：

```
// Registering for a specific notification
NSString *notificationName = @"com.apple.springboard.fullycharged";
CFNotificationCenterAddObserver(CFNotificationCenterGetDarwinNotifyCenter(),
                                NULL,
                                yourCustomMethod,
                                (__bridge CFStringRef)notificationName,
                                NULL, 
                                CFNotificationSuspensionBehaviorDeliverImmediately); 
```

* * *

```
// The custom method that will receive the notification
static void yourCustomMethod(CFNotificationCenterRef center, void *observer, CFStringRef name, const void *object, CFDictionaryRef userInfo)
{
  NSString *nameOfNotification = (__bridge NSString*)name;

  if([nameOfNotification isEqualToString:notificationName])
  {
    // Do whatever you want...
  }
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-02-20T11:09:04.993

**斯威夫特 4.2**

布尔值

```
 var batteryState: Bool {
        IDevice.current.isBatteryMonitoringEnabled = true
        let state = UIDevice.current.batteryState

        if state == .charging || state == .full {
            print("Device plugged in.")
            return true

        } else {
            return false
        }

    } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-03-15T13:01:58.480

```
func checkForCharging() {

UIDevice.current.isBatteryMonitoringEnabled = true

if UIDevice.current.batteryState != .unplugged {

print("Batery is charging")

} else if UIDevice.current.batteryState == .unplugged {

print("Check the cable")

} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-10-08T13:21:54.037

如果您想检查多个地方，而不是这样。

```
class Device {

    static let shared = Device()

    func checkIfOnCharcher() -> Bool {
        UIDevice.current.isBatteryMonitoringEnabled = true
        if (UIDevice.current.batteryState != .unplugged) {
            return true
        } else {
            return false
        }
    }
} 
```

用法：

```
if Device.shared.checkIfOnCharcher() == true { 
      //Some Code
} else { 
   // Some code
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-03-26T14:10:07.967

...和@Brad 对**Swift 5**的回答：

```
 UIDevice.current.isBatteryMonitoringEnabled = true
    if UIDevice.current.batteryState != .unplugged {
        UIApplication.shared.isIdleTimerDisabled = true
    } 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-09-09T18:42:32.180

正如许多人所说，您可以使用`UIDevice.current.batteryState`.

但您可以走得更远，使用通知中心查看状态何时发生变化。

这是一个示例，如果您希望在插入应用程序时屏幕保持唤醒状态：

## 斯威夫特 5

```
 class BatteryManager {
        static let shared: BatteryManager = .init()

        private init() {
            UIDevice.current.isBatteryMonitoringEnabled = true

            NotificationCenter.default.addObserver(
                self,
                selector: #selector(batteryStateDidChange),
                name: UIDevice.batteryStateDidChangeNotification,
                object: nil
            )
        }

        deinit {    
            NotificationCenter.default.removeObserver(
                self,
                name: UIDevice.batteryStateDidChangeNotification,
                object: nil
            )
        }

        @objc private func batteryStateDidChange() {
            let state = UIDevice.current.batteryState

            UIApplication.shared.isIdleTimerDisabled = state == .full || state == .charging
        }
    } 
```

# vb.net - 在 VB.NET 中使用 HmacSHA256 加密字符串的正确方法

> ID：839280
> 
> 赞同：0
> 
> 时间：2009-05-08T10:49:34.440
> 
> 标签：vb.net, hash, encryption, hmac, sha256

我需要为要发送给第 3 方的 XML 字符串创建一个键控散列。这是我正在使用的代码，但它产生的哈希值与第 3 方发送给我的示例不同。我已经阅读了所有可以找到的教程，并一次又一次地重新阅读 MSDN。我究竟做错了什么？还是我应该怀疑另一端有问题？

```
Public Shared Function HashString(ByVal StringToHash As String) As String
    Dim myEncoder As New System.Text.UTF32Encoding
    Dim Key() As Byte = myEncoder.GetBytes(My.Settings.PortalHASH)
    Dim XML() As Byte = myEncoder.GetBytes(StringToHash)
    Dim myHMACSHA256 As New System.Security.Cryptography.HMACSHA256(Key)
    Dim HashCode As Byte() = myHMACSHA256.ComputeHash(XML)
    Return Convert.ToBase64String(HashCode)
End Function 
```

它需要进行 base-64 编码，这就是我有最后一行的原因。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T12:46:38.127

（阅读我的评论）
如果 My.Settings.PortalHASH 是 Base64 编码的密钥，您需要这样做：

```
Dim Key() As Byte = Convert.FromBase64String(My.Settings.PortalHASH) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T10:54:27.797

我无法评论 VB 的正确性，但从命名的明显性来看，我可以说它看起来是正确的。

所以这里没有足够的信息来说明什么是错的；你可能已经说出了你所知道的一切。因此，为您验证这一点的人将是您的第三方。他们能说出什么是错的。

PS：奇怪的是没有对方发来的nonce作为挑战？

# php - PHP XML Parser - 忽略嵌套/子标签

> ID：839287
> 
> 赞同：0
> 
> 时间：2009-05-08T10:51:11.267
> 
> 标签：php, xml, parsing

我有一种情况，我正在使用 XML 解析器从 php://input 中提取数据。

发送的数据如下所示：

```
<this>foo</this>
<that>bar></that>
<data><dong>zebras</dong><fong>monkeys</fong></data> 
```

现在，问题是因为处理程序：

```
$xml_parser = xml_parser_create();

xml_parser_set_option($xml_parser, XML_OPTION_CASE_FOLDING, false);
xml_set_element_handler($xml_parser, "startTag", "endTag");
xml_set_character_data_handler($xml_parser, "contents");

$document = file_get_contents("php://input");                  

xml_parse($xml_parser, $document);

xml_parser_free($xml_parser); 
```

...正在为我解释标签以破译内容以使其有用...它似乎遗漏了任何内容，`<data>`即我需要找出如何让它忽略子/嵌套元素/标签，然后放屁数据什么的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T17:15:04.660

WideDonkey，您是否考虑过使用 DOM 代替？您可以轻松做到：

```
$dom = new DOMDocument();
$dom->loadXML(file_get_contents('php://input'));

$data = $dom->getElementsByTagName('data');
$data = $data[0]->asXML(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T12:51:22.953

我不确定我是否正确理解了这个问题，但是

```
<?php
function contents($parser, $data) {
  echo $data;
}

$xml_parser = xml_parser_create();
xml_parser_set_option($xml_parser, XML_OPTION_CASE_FOLDING, false);
// xml_set_element_handler($xml_parser, "startTag", "endTag");
xml_set_character_data_handler($xml_parser, "contents");
// $document = file_get_contents("php://input");
$document = '<x><this>foo</this><that>bar</that><data><dong>zebras</dong><fong>monkeys</fong></data></x>';
xml_parse($xml_parser, $document);
xml_parser_free($xml_parser); 
```

印刷

```
foobarzebrasmonkeys 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-30T10:25:11.890

我最终做的是使用 SimpleXML 来做：-

```
$xml = new SimpleXMLElement($input);

$whatIwant = $xml->bar->monkeys 
```

您可以根据需要降低任意多个级别，例如测试

$xml 是最远的包装标签。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-30T10:27:39.000

[phpQuery](http://code.google.com/p/phpquery/)为您提供了封装在 PHP 外壳中的 jQuery 选择器的所有功能。

```
phpQuery::newDocumentFileXHTML('my-xhtml.html')->find('p'); 
```

# c - 为什么我应该在“char bigchar[1u << 31 - 1];”时使用 malloc() 工作得好吗？

> ID：839291
> 
> 赞同：8
> 
> 时间：2009-05-08T10:51:44.230
> 
> 标签：c, arrays, static, malloc

与静态数组相比，使用 malloc（除了失败时返回 NULL）有什么优势？以下程序将占用我所有的内存并仅在未注释循环时才开始填充交换。它不会崩溃。

...

```
#include <stdio.h>

unsigned int bigint[ 1u << 29 - 1 ];
unsigned char bigchar[ 1u << 31 - 1 ];

int main (int argc, char **argv) {
  int i;
/*   for (i = 0; i < 1u << 29 - 1; i++) bigint[i] = i; */
/*   for (i = 0; i < 1u << 31 - 1; i++) bigchar[i] = i & 0xFF; */

  getchar();
  return 0;
} 
```

...

经过反复试验，我发现上面是我的 32 位 Intel 机器上允许使用 GCC 4.3 的最大静态数组。这是标准限制、编译器限制还是机器限制？显然，我想拥有多少就拥有多少。它会出现段错误，但前提是我要求（并尝试使用）多于 malloc 无论如何都会给我。

有没有办法确定静态数组是否实际分配并安全使用？

编辑：我对为什么使用 malloc 来管理堆而不是让虚拟内存系统处理它感兴趣。显然，我可以将数组的大小设置为我认为需要的大小的许多倍，并且虚拟内存系统只会将所需的内容保存在 ram 中。如果我从不写这些巨大数组的结尾（或开头），那么程序就不会使用物理内存。此外，如果我可以写入每个位置，那么除了在堆中增加一个指针或在同一进程中搜索先前的分配之外，malloc 还能做什么？

**编者注：** 如果 int 是 32 位，`1 << 31` [则会导致未定义的行为](https://stackoverflow.com/questions/26192284/why-does-1-31-31-result-in-1/)`1u`，因此我已将问题修改为 read 。该问题的目的是询问有关分配大型静态缓冲区的问题。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-08T12:11:19.197

好吧，实际上有两个原因：

1.  由于可移植性，有些系统不会为您进行虚拟内存管理。

2.  您将不可避免地需要将此数组划分为更小的块以使其有用，然后跟踪所有块，然后最终当您开始“释放”您不再需要的数组块时，您会遇到[内存碎片](http://en.wikipedia.org/wiki/Memory_fragmentation)的问题。

总而言之，您最终将实现大量内存管理功能（实际上几乎是重新实现 malloc）而没有可移植性的好处。

因此原因：

*   通过内存管理封装和标准化实现代码可移植性。

*   通过代码重用的方式提高个人生产力。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-08T10:57:26.433

请参见：

[malloc() 和 C/C++ 堆](https://stackoverflow.com/questions/196136/malloc-and-the-c-c-heap)

[对象列表应该存储在堆还是栈上？](https://stackoverflow.com/questions/647092/should-a-list-of-objects-be-stored-on-the-heap-or-stack)

[C++ 哪个更快：堆栈分配或堆分配](https://stackoverflow.com/questions/161053/c-which-is-faster-stack-allocation-or-heap-allocation)

[在 C++ 中正确使用堆栈和堆？](https://stackoverflow.com/questions/599308/proper-stack-and-heap-usage-in-c)

[关于 C/C++ 堆栈分配](https://stackoverflow.com/questions/685601/about-c-c-stack-allocation)

[C++ 中的栈、静态和堆](https://stackoverflow.com/questions/408670/stack-static-and-heap-in-c)

[内存管理、堆损坏和 C++](https://stackoverflow.com/questions/7525/of-memory-management-heap-corruption-and-c)

[new 在堆栈而不是堆上（如 alloca 与 malloc）](https://stackoverflow.com/questions/472015/new-on-stack-instead-of-heap-like-alloca-vs-malloc)

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-05-08T10:56:41.817

使用 malloc，您可以扩大和缩小您的数组：它变成动态的，因此您可以根据需要准确分配。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-05-08T10:54:28.890

我猜这叫做自定义内存管理。你可以这样做，但你必须自己管理那块内存。你最终会编写自己的 malloc() 来处理这个块。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-08T12:01:01.280

关于：

> 经过反复试验，我发现上面是我的 32 位 Intel 机器上允许使用 GCC 4.3 的最大静态数组。这是标准限制、编译器限制还是机器限制？

一个上限取决于 4GB（32 位）虚拟地址空间在用户空间和内核空间之间的分区方式。对于 Linux，我相信最常见的分区方案有 3 GB 的用户空间地址范围和 1 GB 的内核空间地址范围。分区可在内核构建时配置，2GB/2GB 和 1GB/3GB 分割也在使用中。加载可执行文件时，必须为每个对象分配虚拟地址空间，无论是否分配了实际内存来备份它。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-08T12:04:53.143

您可能能够在一个上下文中分配那个巨大的数组，但不能在其他上下文中分配。例如，如果您的数组是结构的成员，并且您希望传递该结构。某些环境对结构大小有 32K 的限制。

如前所述，您还可以调整内存大小以完全使用您需要的内存。在性能关键的上下文中，如果可以避免分页到虚拟内存，这一点很重要。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-05-08T12:09:16.080

除了超出范围之外，没有其他方法可以释放堆栈分配。因此，当您实际使用全局分配并且 VM 必须为您分配真正的硬内存时，它会被分配并保留在那里直到您的程序用完。这意味着任何进程只会在它的虚拟内存使用中增长（函数具有本地堆栈分配，这些将被“释放”）。

一旦超出功能范围，您就不能“保留”堆栈内存，它总是被释放。因此，您必须知道在编译时将使用多少内存。

然后归结为您可以拥有多少个 int foo[1<<29]。由于第一个占用了整个内存（在 32 位上）并且将是（让我们说谎：0x000000），第二个将解析为 0xffffffff 或大约。那么第三个会解决什么问题？32 位指针无法表达的东西。（请记住，堆栈保留部分在编译时解决，部分在运行时通过偏移量解决，当您分配这个或那个变量时堆栈偏移量被推送多远）。

所以答案几乎是，一旦你有了 int foo [1<<29] ，你就不能再有任何合理的函数深度和其他局部堆栈变量了。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-08T12:06:56.287

你真的应该避免这样做，除非你知道你在做什么。尽量只请求所需的内存。即使它没有被使用或妨碍其他程序，它也可能会弄乱它自己的过程。有两个原因。首先，在某些系统上，尤其是 32 位系统上，它会在极少数情况下导致地址空间过早耗尽。此外，许多内核对保留/虚拟/未使用内存有某种每个进程的限制。如果您的程序在运行时请求内存，如果内核请求保留的内存超过此限制，则内核可以终止该进程。我见过由于 malloc 失败而崩溃或退出的程序，因为它们在只使用几 MB 的同时保留 GB 的内存。

# iphone - 如何相对于任何点（除了它的中心）旋转 UIImageView？

> ID：839296
> 
> 赞同：10
> 
> 时间：2009-05-08T10:54:17.127
> 
> 标签：iphone, cocoa-touch, uikit, core-animation

默认情况下， UIImageView 将仅围绕其中心旋转。如何让它围绕图像中的任何其他点旋转？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-08T12:46:55.037

一种方法是更改​​ UIImageView 底层的 anchorPoint 并围绕它旋转。您可以使用以下内容更改旋转点：

```
imageView.layer.anchorPoint = CGPointMake(0.25, 0.25); 
```

anchorPoint 是根据层内的相对坐标定义的。也就是说，(0,0) 是图层的左上角（在 iPhone 上，UIView 图层已经翻转了 Y 坐标），而 (1,1) 是右下角。

移动锚点可能会移动您的图像，因此您可能需要在之后调整其位置。

要围绕该新锚点旋转图像的图层，您可以使用以下内容更改图层的 CATransform3D 结构：

```
CATransform3D rotatedTransform = imageView.layer.transform;
rotatedTransform = CATransform3DRotate(rotatedTransform, 60.0 * M_PI / 180.0, 0.0f, 0.0f, 1.0f);
imageView.layer.transform = rotatedTransform; 
```

此示例围绕锚点进行 60 度的增量旋转。

默认情况下，对图层的所有更改都是动画的。您可以通过将您对这些属性的更改包含在 CATransaction 中来禁用此动画，如下所示：

```
[CATransaction begin];
[CATransaction setValue:(id)kCFBooleanTrue forKey:kCATransactionDisableActions];    

// Code for changes here

[CATransaction commit]; 
```

# linux - Linux调度器的性能评估

> ID：839301
> 
> 赞同：2
> 
> 时间：2009-05-08T10:54:48.357
> 
> 标签：linux, performance, benchmarking, evaluation, scheduler

我对 Linux 内核中的调度程序做了一些简单的更改。现在，我想看看这些变化如何影响系统的响应时间；换句话说，我想知道与原始调度程序相比，我的修改需要多长时间的上下文切换。一种直接的方法是使用时间戳计数器，然后使用 printk 输出上下文切换所花费的时间；显然，在这种情况下会打印出很多信息。所以我想知道是否还有其他更好的方法来测量 Linux 调度程序的响应时间？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T11:11:08.520

有几个内核级跟踪框架，可能会对您有所帮助。请参阅[eLinux.org上的](http://eLinux.org)[内核跟踪系统](http://elinux.org/Kernel_Trace_Systems)页面，以获得对可用选项的很好的概述。

# asp.net-mvc - 如何使用 ASP.Net MVC 为手机使用 M.domain.com 地址

> ID：839304
> 
> 赞同：1
> 
> 时间：2009-05-08T10:55:16.547
> 
> 标签：asp.net-mvc, mobile

假设我有一个托管在 www.somedomain.com 的 ASP.Net MVC 网站。现在我有兴趣在 m.somedomain.com 上提供移动版本。我需要完全重写网站还是 MVC 可以检测浏览器类型并自动路由到移动优化页面？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-08T12:23:49.057

您可以检测浏览器类型并进行路由，但您必须自己做一些工作 - 它并不是真正内置的。Scott Hanselman 在这里有一些很好的示例代码：

[混合：使用 ASP.NET MVC 和移动浏览器定义文件的移动网站](http://www.hanselman.com/blog/MixMobileWebSitesWithASPNETMVCAndTheMobileBrowserDefinitionFile.aspx)

# cruisecontrol.net - 需要帮助配置 CruiseControl.NET 统计信息合并

> ID：839306
> 
> 赞同：1
> 
> 时间：2009-05-08T10:56:26.887
> 
> 标签：cruisecontrol.net

我正在寻找有关如何从合并 xml 文件中获取统计信息的指针。文件结构如下所示..

```
<CyclometricComplexity>
  <module name="Srvr" type="unit" total="14" low="14" medium="0" high="0" ultra="0"/>
</CyclometricComplexity> 
```

我创建了一个合并发布者来获取此文件，但无法将统计发布者配置为获取总计、低、中、高和超的值。

有没有人可以举个例子来帮助我？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-11T08:12:37.663

我想我找到了如何做到这一点。首先，我需要了解 XPath 的工作原理！然后我改变了我的输出工具来创建整个项目的摘要，而不是试图让 CCNET 将它们聚合在一起，所以输出现在有整个项目的总、低、中等。然后我将我的统计部分更改为如下...

```
 <firstMatch name='Total Methods' generateGraph='true' xpath='//CyclometricComplexity/@total'/>
  <firstMatch name='Low Complexity' generateGraph='true' xpath='//CyclometricComplexity/@low'/>
  <firstMatch name='Medium Complexity' generateGraph='true' xpath='//CyclometricComplexity/@medium'/>
  <firstMatch name='High Complexity' generateGraph='true' xpath='//CyclometricComplexity/@high'/>
  <firstMatch name='Ultra Complexity' generateGraph='true' xpath='//CyclometricComplexity/@ultra'/> 
```

统计数据现在显示在详细统计数据中，我现在需要开始询问有关如何制作定制图表的问题！

# sql - 在列中构建和显示复杂的复合主键

> ID：839312
> 
> 赞同：1
> 
> 时间：2009-05-08T10:58:29.177
> 
> 标签：sql, sql-server

我需要构建一个由 3 个部分组成的主键。

*   第一部分是 3 个字母长，必须是 a，后跟两位数字，例如“a00”
*   第二部分是 3 位唯一标识符，包括前导零，例如“003”
*   第三部分是日期的年份部分，例如“2008”

这都是用破折号分隔的，所以一个完整的键看起来像“a00-014-2008”

我的解决方案是保存三个单独的列，每个列的数据未格式化，然后添加集群主键约束并在需要在视图中显示时对其进行格式化。这是解决问题的好方法吗？我认为可能有一种方法可以使用触发器制作整个更新键，但我不知道如何。另外我将如何连接并在视图中显示它？

虽然不是家庭作业问题，但这将在学术上帮助我。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-08T11:02:03.410

我的问题是：这三个值中的任何一个本身是否有意义？或者它们只是主键的组成部分？如果它们绝对没有其他含义，那么恕我直言，您最好只创建一个包含整个值的列。

现在“意义”可能很难限定。这可能意味着它是一个特定的客户代码或被搜索的东西，或者很多东西。

通常，我会尽量避免使用复合键，因为它们会使连接复杂化，并且通常会使您的 ORM 生活变得困难（通常将这种做法 - 正确或错误地 - 视为“遗留”）。

如果这些字段确实有意义，那么可以说它们不应该是主键的一部分。我认为这种做法是[错误](https://stackoverflow.com/questions/621884/database-development-mistakes-made-by-appdevelopers/621891#621891)的。我几乎总是对主键值使用自动编号列或序列（称为“技术键”，而不是语义键）。

鉴于用户提供了其中的一部分并且需要以特定方式对其进行格式化，我假设密钥具有整体意义，无论是产品代码、患者代码、预订号码还是类似的东西。那会是正确的吗？

如果是这样，鉴于这一点以及我对技术密钥的几乎完全偏好（对此问题的意见各不相同），我会考虑不将其作为主键。为此创建一个自动编号字段。只需将其作为具有唯一索引的列，即 varchar(12) 或其他。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-08T11:07:01.307

```
CREATE TABLE mytable (
      first TINYINT NOT NULL CHECK(first BETWEEN 0 AND 99),
      second INT NOT NULL CHECK (second BETWEEN 0 AND 999),
      third INT NOT NULL,
      CONSTRAINT pk_mytable_123 PRIMARY KEY (first, second, third)
      )
GO
CREATE VIEW v_mytable AS
SELECT  'a' + RIGHT('00' + CAST(first AS VARCHAR), 2) AS first,
        RIGHT('0000' + CAST(second AS VARCHAR), 4) AS second,
        third
FROM    mytable
GO

INSERT
INTO    mytable
VALUES  (1, 1, 2008)
GO

SELECT  *
FROM    v_mytable
GO

first  second  third
----   ----    ----
a01    0001    2008 
```

这个主键将只保存`INT`值，所有格式都将在视图中完成。

请注意，为了在性能方面获得最佳结果，您最好创建计算列而不是视图，并在这些列中创建附加`UNIQUE`索引：

```
CREATE TABLE mytable (
      _first TINYINT NOT NULL CHECK(_first BETWEEN 0 AND 99),
      _second INT NOT NULL CHECK (_second BETWEEN 0 AND 999),
      third INT NOT NULL,
      first AS 'a' + RIGHT('00' + CAST(_first AS VARCHAR), 2),
      second AS RIGHT('0000' + CAST(_second AS VARCHAR), 4)
      CONSTRAINT pk_mytable_123 PRIMARY KEY (_first, _second, third)
      )

CREATE UNIQUE INDEX ux_mytable_123 ON mytable (first, second, third) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-08T11:10:11.520

主键传统上有两个目的：唯一标识一行，并允许其他数据库表引用它。复合主键实现了第一个目的，但使第二个目的变得困难，因为另一个表必须引用 3 列。ORM 系统也是如此，甚至是来自网页的更新。

最佳实践解决方案是将标识列作为主键。这允许轻松引用行，并且是所有 ORM 层都可以处理的场景。然后在构成主键的三列上添加一个“唯一”索引。这样，您就可以两全其美。

# java - 从 SQL 日期解析年份

> ID：839313
> 
> 赞同：0
> 
> 时间：2009-05-08T10:58:35.010
> 
> 标签：java, sql

我目前正在编写一个与 MySQL 数据库交互的 Java 应用程序。
我的问题是我正在尝试编写一个函数，用数据库中注册的唯一年份值填充 JComboBox。
我可以在 SQL 查询中的日期字段上使用 UNIQE，但这只会排除一些日期，而不是所有日期，但每年只有一个日期。
任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-08T11:02:55.250

```
SELECT DISTINCT YEAR(yourDateColumn) FROM yourTable; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T11:03:51.003

使用[年份](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_year)功能

# java - ClientAbortException: java.net.SocketException: Connection reset by peer: socket write error

> ID：839314
> 
> 赞同：24
> 
> 时间：2009-05-08T10:58:46.507
> 
> 标签：java, tomcat, socketexception, connection-reset

从数据库列中检索文件对象时，我经常收到以下错误。我该如何解决这个问题？

```
May 8, 2009 3:18:14 PM org.apache.catalina.core.StandardHostValve status
  WARNING: Exception Processing ErrorPage[errorCode=404, location=/error.jsp]
  ClientAbortException:  java.net.SocketException: Connection reset by peer: socket write error
  at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:327)
  at org.apache.catalina.connector.OutputBuffer.flush(OutputBuffer.java:293)
  at org.apache.catalina.connector.Response.flushBuffer(Response.java:537)
  at org.apache.catalina.core.StandardHostValve.status(StandardHostValve.java:286)
  at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:136)
  at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:105)
  at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:107)
  at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:148)
  at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:869)
  at org.apache.coyote.http11.Http11BaseProtocol$Http11ConnectionHandler.processConnection(Http11BaseProtocol.java:664)
  at org.apache.tomcat.util.net.PoolTcpEndpoint.processSocket(PoolTcpEndpoint.java:527)        
  at org.apache.tomcat.util.net.LeaderFollowerWorkerThread.runIt(LeaderFollowerWorkerThread.java:80)
  at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:684)
  at java.lang.Thread.run(Unknown Source)

Caused by: java.net.SocketException: Connection reset by peer: socket write error
  at java.net.SocketOutputStream.socketWrite0(Native Method)
  at java.net.SocketOutputStream.socketWrite(Unknown Source)
  at java.net.SocketOutputStream.write(Unknown Source)
  at org.apache.coyote.http11.InternalOutputBuffer.realWriteBytes(InternalOutputBuffer.java:746)
  at org.apache.tomcat.util.buf.ByteChunk.flushBuffer(ByteChunk.java:433)
  at org.apache.coyote.http11.InternalOutputBuffer.flush(InternalOutputBuffer.java:304)
  at org.apache.coyote.http11.Http11Processor.action(Http11Processor.java:991)
  at org.apache.coyote.Response.action(Response.java:182)
  at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:322)
  ... 13 more 
```

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-05-08T11:08:22.600

您的 HTTP 客户端已断开连接。

这可能有几个原因：

*   响应请求时间过长，客户端放弃
*   您回复了客户不理解的内容
*   最终用户实际上取消了请求
*   发生网络错误
*   ...可能更多

您可以相当容易地模拟该行为：

```
URL url = new URL("http://example.com/path/to/the/file");

int numberOfBytesToRead = 200;

byte[] buffer = new byte[numberOfBytesToRead];
int numberOfBytesRead = url.openStream().read(buffer); 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-06-12T07:09:45.730

您的日志指示 ClientAbortException，当您的 HTTP 客户端断开与服务器的连接时发生这种情况，并且这发生在服务器可以关闭服务器套接字连接之前。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-05-12T22:40:52.500

**我在Google Cache**的打开页面上收到此错误。

我认为，缓存页面（客户端）在页面加载时*断开连接。*

*您可以使用 try-catch on filter*忽略此错误日志。**

 ** * *

## 回答 #4

> 赞同：-2
> 
> 时间：2014-11-14T13:08:08.857

Windows 防火墙可能会导致此异常，请尝试禁用它或为端口甚至程序添加规则（java）

# google-app-engine - Google App Engine Set-Cookie 无法使用我的到期日期

> ID：839316
> 
> 赞同：6
> 
> 时间：2009-05-08T10:58:59.737
> 
> 标签：google-app-engine, cookies

我正在尝试在我的 Google App Engine 页面中设置一个 cookie：

```
self.response.headers.add_header('Set-Cookie','CookieName=1234; expires:Sun, 31-May-2009 23:59:59 GMT; path=/;') 
```

到期日期未显示在浏览器中。因此，它会在会话结束时自行删除。

这是 curl -D 的输出：

```
HTTP/1.1 200 OK
Content-Type: text/html; charset=utf-8
Cache-Control: no-cache
Set-Cookie: CookieName=1234; expires:Fri, 01 Jan 2010 11:48:41 GMT
Date: Fri, 08 May 2009 11:57:25 GMT
Server: Google Frontend
Expires: Fri, 08 May 2009 11:57:25 GMT
Transfer-Encoding: chunked 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-08T12:08:56.750

问题是您使用带有冒号的“过期：”。需要为“expires=”和等号。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-08T11:33:06.860

使用“curl -D somefile”，我可以检查您的 cookie 是否完全按照指定的方式到达客户端。你能检查一下，并确认问题出在你的浏览器及其设置上，而不是服务器端吗？

# jquery - 在 2 个文本框之间进行验证 - jquery

> ID：839318
> 
> 赞同：0
> 
> 时间：2009-05-08T10:59:13.870
> 
> 标签：jquery, validation, datetime

我如何使用 jquery 验证两个日期文本框。我遇到了这段代码。如何输入文本框参数：

```
$.validator.addMethod('greaterThan', function(value, element, param) { return ( IsNaN( value ) && IsNaN( $(param).val() ) ) || ( value > $(param).val() ); }, 'Must be greater than {0}.' );

$.validator.addMethod('lesserThan', function(value, element, param) { return ( IsNaN( value ) && IsNaN( $(param).val() ) ) || ( value < $(param).val() ); }, 'Must be lesser than {0}.' ); 
```

开始日期必须大于结束日期。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T11:09:33.313

```
$(function() {
  $("#msg").text('');

  $("#checkdates").click(function(event) {
    var startdate = Date.parse($("#startdate").val());
    if (!startdate) {
      $("#msg").append("Start Date is not a valid date<br/>");
    }

    var enddate = Date.parse($("#enddate").val());
    if (!enddate) {
      $("#msg").append("End Date is not a valid date<br/>");
    }

    if (startdate && enddate) {
      if (startdate < enddate) {
        $("#msg").text("Start date must be greater than end date");
      } else {
        $("#msg").text("all good!");
      }
    }
    event.preventDefault();
    return false;
  });
});
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<form>
  Start: <input type="text" id="startdate" value="1/1/2000" />
  End: <input type="text" id="enddate" value="1/1/1990" />
</form>
<button id="checkdates">Check Dates</button>

<div id="msg"></div>
```

抓取日期JS

[http://www.datejs.com/](http://www.datejs.com/)

# javascript - jQuery：从第一个孩子或自我返回文本

> ID：839328
> 
> 赞同：2
> 
> 时间：2009-05-08T11:03:01.550
> 
> 标签：javascript, jquery

我正在尝试获取元素内的文本，并且我只想获取文本，如果它位于占位符 div 的第一个子元素内，或者如果没有子元素并且里面只有文本。
所以这两种情况是：

```
<div id="wrap">text1</div> 
```

和

```
<div id="wrap"><b>text1</b><b>text2</b></div> 
```

因此，在这两种情况下，我都想回来`"text1"`
，我知道如何使用 2 个不同的查询来做到这一点，但我正试图将它们合并为一个

```
$("#wrap :first-child").text()
$("#wrap").text() 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-08T11:07:49.980

```
$("#wrap :first-child").text() || $("#wrap").text() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T15:00:11.690

由于 jquery 选择器表达式按文档顺序给出结果，因此可以组合表达式。

```
$('#wrap :first-child, #wrap').filter(':last').text() 
```

# javascript - Javascript中的onkeyup键值

> ID：839331
> 
> 赞同：2
> 
> 时间：2009-05-08T11:03:46.247
> 
> 标签：javascript, jquery

我有一个标准的文本框，并且页面上有 jQuery。我想在用户在文本框中输入空格时采取行动。但是，我不确定如何执行此操作。

有人可以帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-08T11:09:07.433

```
var KEYS = {
    SPACE: 32
};

$("#textbox").keyup(function(e) {
    if (e.keyCode === KEYS.SPACE) {
        console.log("Space key pressed");
    }
}); 
```

参考：

*   [http://docs.jquery.com/Events/keyup](http://docs.jquery.com/Events/keyup)
*   [http://www.asciitable.com](http://www.asciitable.com)

# asp.net - ASP.NET 3.5 路由未处理/（根 URL）

> ID：839335
> 
> 赞同：2
> 
> 时间：2009-05-08T11:04:04.607
> 
> 标签：asp.net, routing

我正在使用 ASP.NET 3.5 中的新路由功能来充当对我网站的页面请求的全部功能。我在 global.asax 中注册了我的路线，如下所示，

```
<%@ Application Language="C#" %>
<%@ Import Namespace="System.Web.Routing" %>
<script runat="server">

    void Application_Start(object sender, EventArgs e) 
    {

        RegisterRoutes(RouteTable.Routes);

    }

    private void RegisterRoutes(RouteCollection Routes)
    {

        Route r = new Route("{*URL}", new MyRouteHandler());
        Routes.Add(r);

    }

</script> 
```

该代码对除 / （根页面）之外的所有 URL 都非常有效。如果我转到任何其他 URL /blah/something/foo/ 它工作正常并且我的处理程序按预期运行。

我怎样才能让它在根页面上运行？我正在通过 Visual Studio 2008 的内置 Web 服务器运行代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T12:28:30.340

Cassini（Visual Studio 的内置网络服务器）可能存在路由问题。

引用[Dmitryr 的博客](http://blogs.msdn.com/dmitryr/archive/2009/04/23/cassini-support-for-friendly-urls-routing.aspx)：

> 由于目录列表功能，Cassini 在使用路由的 ASP.NET 项目中遇到了问题。Cassini 将以目录列表响应任何对目录的请求，而不将请求移交给 ASP.NET。因此，对友好 URL 的请求将被 Cassini 拦截，并且永远不会到达 ASP.NET。
> 
> 此更新 (v3.5.0.1) 改变了逻辑——所有请求首先转到 ASP.NET，然后 Cassini 拦截 404 响应，如果请求是针对目录的，它会以目录列表进行响应。依赖友好 URL / 路由的应用程序现在可以更好地与 Cassini 配合使用。

您没有提到当您转到根目录时会看到什么行为。如果您没有获得目录列表，也许您需要删除您的默认页面？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T11:03:40.337

我不确定您是否可以使用 web.routing 定位根目录。

我在这里做了一个很大的假设，即您已经在 Web 表单应用程序上实现了 web.routing。如果是这种情况，您仍在将根请求捕获到默认页面（即 Default.aspx），在这种情况下，您可以从那里处理请求。

我过去的 web.routing 实现针对的是根目录中的 ASPX 页面，我也将其设置为默认页面。如果一个请求在没有任何路由信息的情况下到达该页面，我假设该请求是针对 home 的。

但是，如果您使用的是 Web 表单引擎，但使用的是 MVC 样式的文件夹结构。我建议要么添加适当重定向的默认页面，要么可能在 BeginRequest 事件中捕获请求。

富有的

# visual-c++-6 - VC6环境下调试时如何查看CString对象值

> ID：839338
> 
> 赞同：2
> 
> 时间：2009-05-08T11:05:36.897
> 
> 标签：visual-c++-6

在 VC 6 环境中，在调试模式下查看 CString 的值需要做哪些设置。即使在监视窗口中？？？出现 CString 变量！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T11:17:01.813

你有正确的调试符号吗？. pdb 可能已过时

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-03-30T16:54:35.530

尝试在监视窗口中使用 GetBuffer 方法。

```
cStringVariable.GetBuffer() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-06-26T21:42:56.557

Try using XDebug plugin for VC6\. Look [here](http://humanier.blogspot.com/2010/06/viewing-strings-in-visual-studio-6.html)

# php - 如何解决 CakePHP 的 ACL 教程中的“无效节点”错误？

> ID：839344
> 
> 赞同：0
> 
> 时间：2009-05-08T11:07:48.920
> 
> 标签：php, cakephp, acl

[我使用CakePHP 文档](http://book.cakephp.org/1.2/en/The-Manual/Tutorials-Examples/Simple-Acl-controlled-Application.html)中描述的方法创建了一个应用程序，但是在我尝试登录后出现了一个错误，上面写着，

```
DbAcl::allow() - Invalid node [CORE\cake\libs\controller\components\acl.php, line 325] 
```

我做了与网站上提到的完全相同的操作，但是登录后我收到了这个错误消息。请帮我纠正这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-10T00:05:52.477

是的。肯定有问题，因为如方法中所述，aros 表的结构应该与该部分中提到的结构完全相同。当我使用 cakephp 生成的 CRUD 创建组时，所有组都正确进入数据库，但用户信息未在 aros 表中更新。我会再次尝试一下，看看我是否做错了什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T11:53:00.033

没有足够的信息来提供答案，但该错误意味着您的 ACL 树、ARO 或 ACO 中有问题，*或者*您向 allow() 发送了错误的参数。

尝试使用 acl 控制台来确定您的 ARO/ACO 树是否组织正确，如教程中所述。如果不是，请截断您的 ACL 表并从头开始插入。不过这次很认真！:-P

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-09T16:02:33.697

超级老问题，但是，我遇到了这个问题，找不到我的问题的答案（即使在这个线程中）。

我的问题实际上是我有一个与控制器同名的方法，让我用一些代码解释一下我的意思：

```
class Users extends AppController{
  public function users(){
  }
} 
```

更改方法名称为我解决了这个问题。

PS：使用 cakePHP 1.2

# configuration - maven2中的蚂蚁替换？

> ID：839349
> 
> 赞同：1
> 
> 时间：2009-05-08T11:09:07.370
> 
> 标签：configuration, maven-2, ant, build-process

我正在寻找某种方法在构建期间用值替换文件中的模式。

例如，配置文件可能看起来相同，只是不同的机器在某些设置中需要不同的主机名。在这种情况下，我想要一个模板文件，其中主机名替换为@@hostname@@ 然后在构建时，我想创建文件的单独版本，并将模式替换为每个环境的正确值。

在ant中你可以使用“replace”，maven2中有类似的东西吗？我知道我可以运行 ant form maven，但如果有一个 maven 插件可以做到这一点，我更喜欢那个。

我找到了[http://code.google.com/p/maven-replacer-plugin/](http://code.google.com/p/maven-replacer-plugin/) 但它很新...

建议？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-08T21:55:16.250

资源插件是 Maven 中的过滤器。IIRC 它支持 ant 语法以及 ${foo} maven 语法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-08-19T07:57:32.503

跟上[maven-replacer-plugin](http://code.google.com/p/maven-replacer-plugin/)，该项目仍然存在并且运行良好

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-08T14:20:21.490

Maven 的[资源过滤](http://maven.apache.org/plugins/maven-resources-plugin/examples/filter.html)可能会对您有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-08T11:15:32.550

为什么不用[Maven-ant](http://maven.apache.org/plugins/maven-antrun-plugin/)插件呢？

# php - PHPBB3如何在索引中显示最后的帖子标题

> ID：839352
> 
> 赞同：0
> 
> 时间：2009-05-08T11:09:45.060
> 
> 标签：php, templates, phpbb3

我在 phpbb3 中使用 prosilver 主题。在文件`forumlist_body.html`中有一个部分看起来像这样：

```
<dd class="lastpost"><span>
<!-- IF forumrow.LAST_POST_TIME -->
<dfn>{L_LAST_POST}</dfn> {L_POST_BY_AUTHOR} {forumrow.LAST_POSTER_FULL}
  <!-- IF not S_IS_BOT -->
  <a href="{forumrow.U_LAST_POST}">{LAST_POST_IMG}</a>
  <!-- ENDIF -->
<br />
{forumrow.LAST_POST_TIME}
<!-- ELSE -->{L_NO_POSTS}<br />
<!-- ENDIF -->
</span></dd> 
```

我怎样才能让它也显示最后一个帖子标题。我试过`{forumrow.LAST_POST_TITLE}`了，但没有用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T11:22:03.610

{forumrow.LAST_POST_SUBJECT} 可能是您需要的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-04-12T12:32:32.910

its simple ,,

i have made those modifications ,,

here is the code just replace :

```
<dd class="lastpost"><span>
                    <!-- IF forumrow.U_UNAPPROVED_TOPICS --><a href="{forumrow.U_UNAPPROVED_TOPICS}">{UNAPPROVED_IMG}</a><!-- ENDIF -->
                     <!-- IF forumrow.LAST_POST_TIME -->{forumrow.LAST_POST_SUBJECT}&nbsp;&nbsp; {L_POST_BY_AUTHOR} {forumrow.LAST_POSTER_FULL}
                    <!-- IF not S_IS_BOT --><a href="{forumrow.U_LAST_POST}">{LAST_POST_IMG}</a> <!-- ENDIF --><br />{forumrow.LAST_POST_TIME}<!-- ELSE -->{L_NO_POSTS}<br />&nbsp;<!-- ENDIF --></span>
                </dd>
                <dd class="topics">{forumrow.TOPICS}<br /><span>{L_TOPICS}</span><dfn>{L_TOPICS}</dfn></dd>
                <dd class="posts">{forumrow.POSTS}<br /><span>{L_POSTS}</span><dfn>{L_POSTS}</dfn></dd> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-15T05:43:48.663

看起来不像我的。。

```
*

  {forumrow.FORUM_NAME}{L_FORUM}
      {L_TOPICS}
      {L_POSTS}
      {L_LAST_POST}

*

  {forumrow.FORUM_IMAGE} {forumrow.FORUM_NAME}
  {forumrow.FORUM_DESC}
  {forumrow.L_MODERATOR_STR}: {forumrow.MODERATORS}
  {forumrow.L_SUBFORUM_STR} {forumrow.SUBFORUMS}
      {L_REDIRECTS}: {forumrow.CLICKS}
      {forumrow.TOPICS} {L_TOPICS}
      {forumrow.POSTS} {L_POSTS}
      {L_LAST_POST}{L_POST_BY_AUTHOR}{forumrow.LAST_POSTER_FULL}  {LAST_POST_IMG}
      {forumrow.LAST_POST_TIME}{L_NO_POSTS} 
```

{L_NO_FORUMS}

# asp.net - 我应该如何绑定到我的文本框的事件？

> ID：839357
> 
> 赞同：0
> 
> 时间：2009-05-08T11:10:16.493
> 
> 标签：asp.net, vb.net, events, event-handling

我正在`txtFileNature`使用弹出窗口中的值填充文本框 ( )。文本框有一个 onfocus 处理程序设置为

```
onfocus=("this.blur();") 
```

问题是我想根据 的值进行一些计算，`txtFileNature`并希望在其下方显示结果。在哪种情况下我可以使用我的 VB 代码。我无法使用 textchanged 事件，因为我没有在文本框中输入内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-08T11:27:13.507

使用客户端事件 - Javascript：

[http://www.w3schools.com/jsref/jsref_onchange.asp](http://www.w3schools.com/jsref/jsref_onchange.asp)

[http://benreichelt.net/blog/2006/03/02/firing-javascript-events-when-textbox-changes/](http://benreichelt.net/blog/2006/03/02/firing-javascript-events-when-textbox-changes/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T11:38:08.153

根据计算的性质，您可以在服务器端或客户端执行此操作。如果计算的性质允许在客户端上完成，您应该使用`onchange`客户端事件进行计算，正如**fusion**在他的回答中所写的那样。

如果它是您需要的服务器端计算，那么您有很多选择。我假设您有一些填充`txtFileNature`客户端文本框的客户端事件。您可以添加到该事件以使其触发 AJAX 调用或回发（取决于您的应用程序）以获取计算结果。或者，您可以使用`onchange`客户端事件来触发回发或 AJAX 调用。无论哪种方式，最终的结果都是一样的。

# design-patterns - 前端控制器与外观模式

> ID：839359
> 
> 赞同：13
> 
> 时间：2009-05-08T11:10:45.293
> 
> 标签：design-patterns

好的，我在网上做了一些搜索，找到[了这个](http://www.coderanch.com/t/100644/OO-Patterns-UML-Refactoring/Difference-between-Facade-Front-Controller)帖子，但它对我来说仍然不太清楚。

前端控制器模式和外观模式之间究竟有什么区别？

就我目前的理解而言：外观模式不包含任何业务逻辑，而只是集中了对多个对象的访问。

Front Controller 做同样的事情，但可能包含业务逻辑，以方便根据输入数据等决定调用什么。

为了理解这一点，以下简单的伪代码片段是否意味着 drawLine 是一个 Façade 以简化将坐标转换为点然后实现实际工作的 draw 方法？

```
 private void drawLine(Int32 StartX, Int32 StartY, Int32 EndX, Int32 EndY)
    {
        Point Start = new Point(StartX, StartY);
        Point End = new Point(EndX, EndY);

        Draw(Start, End);
    } 
```

Façade 是否可以调用应用程序的较低层，或者它真的只是为了集中访问同一层上的许多组件？

据我了解，前端控制器协调完整的函数调用过程。

示例：前端控制器将检查数据，然后决定采取什么行动。然后它将为每个后续调用较低级别的类编译数据，直到它到达可以提供给调用系统的合适响应。

我认为我对 Façade 模式的理解是错误的或者过于简单化了。如果我错了，请纠正我。

[如果我对此的理解是正确的，那么将应用程序外观更改为Microsoft 应用程序架构指南 2.0](http://www.codeplex.com/AppArchGuide)中的前端控制器是否更有意义？我特别关注第 18 章中的服务架构。（虽然我有 Beta 2 版本）

**更新：**感谢符文的精彩回应。为什么说将 Facade 更改为 Front 控制器是不正确的？我是 Front-controller 的忠实粉丝，因为它可以让所有较低级别的东西更加可控。因此，尽管它可能没有更多意义，但这样做是完全错误的吗？如果是：为什么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-08T11:42:15.303

前端控制器模式定义了一个负责处理应用程序请求的组件。通常用作（例如）通道请求的“瓶颈”，以巩固每次都需要执行的标准行为。

请参阅以下链接以简要说明要点：

*   [http://java.sun.com/blueprints/patterns/FrontController.html](http://web.archive.org/web/20120419115929/http://java.sun.com/blueprints/patterns/FrontController.html)
*   [http://www.oracle.com/technetwork/java/frontcontroller-135648.html](http://www.oracle.com/technetwork/java/frontcontroller-135648.html)
*   [http://martinfowler.com/eaaCatalog/frontController.html](http://martinfowler.com/eaaCatalog/frontController.html)

另一方面，Facade 用于包装其他方法/服务，以提供统一的接口、隐藏复杂性或减少对外部系统的依赖（例如 DDD 的反腐败层：[http ://www.goeleven.com/blog/ entryDetail.aspx?entry=168](http://www.goeleven.com/blog/entryDetail.aspx?entry=168)）等。

外观是一个瘦包装器，它不应该包含任何逻辑，除了用于在两个系统之间转换的逻辑。Front Controller 没有这样的要求。

参见例如：[http ://en.wikipedia.org/wiki/Facade_pattern](http://en.wikipedia.org/wiki/Facade_pattern)

并回答您有关 AppArchGuide 的问题：不，这是不正确的。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2010-12-13T14:59:04.017

Front Controller 模式是一种[架构模式](http://en.wikipedia.org/wiki/Architectural_pattern_(computer_science))（它将架构结构强加于您的应用程序）。

相反，Façade 模式是一种[设计模式](http://en.wikipedia.org/wiki/Design_pattern_(computer_science))（它用于构建您的应用程序 [一个模块] 的特定功能，并且不会将结构强加于您的整个应用程序）。

# automation - 如何自动化开发环境设置？

> ID：839360
> 
> 赞同：80
> 
> 时间：2009-05-08T11:10:56.570
> 
> 标签：automation, agile, development-environment, scrum

每次新开发人员加入团队或开发人员使用的计算机发生变化时，开发人员都需要做大量工作来设置本地开发环境以使当前项目正常工作。作为一个 SCRUM 团队，我们正在尝试自动化包括部署和测试在内的所有事情，所以我要问的是：是否有工具或实践可以使本地开发环境设置自动化？

例如，要设置我的环境，首先我必须安装 eclipse，然后是 SVN、Apache、Tomcat、MySQL、PHP。之后我填充了数据库，我不得不对各种配置文件等进行细微的更改......有没有办法将这种工作减少到一键式？

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2009-05-08T11:55:39.263

有几个选项，有时这些选项的组合很有用：

*   自动安装
*   磁盘映像
*   虚拟化
*   源代码控制

各种选项的详细信息：

1.  **自动安装** 工具，用于自动安装和配置工作站的各种服务、工具和配置文件：

    *   [Puppet](https://puppet.com/)具有学习曲线，但功能强大。您定义机器的类别（开发盒、Web 服务器等），然后它会执行安装、配置和保持机器处于正确状态所需的操作。您要求单击一次，但 Puppet 默认情况下是零单击，因为它会定期检查您的机器以确保它仍按需要进行配置。它将检测文件或模式何时更改，并修复问题。我目前使用它来维护一些 RedHat Linux 机器，尽管它能够处理数千个机器。（截至 2009 年 5 月 8 日，不支持 Windows）。
    *   [Cfengine](http://www.cfengine.org/)是另一个。我已经在一家有 70 名工程师使用 RedHat Linux 的商店成功地使用了这种方法。它的局限性是 Puppet 出现的部分原因。
    *   [SmartFrog](http://en.wikipedia.org/wiki/SmartFrog)是另一个配置主机的工具。它确实支持Windows。
    *   外壳脚本。 [RightScale](http://blog.rightscale.com/2007/08/07/configuring-servers-with-rightscripts/)提供了如何使用 shell 脚本配置 Amazon EC2 映像的示例。
    *   安装软件包。在 Unix 机器上，可以完全使用包来完成此操作，而在 Windows 上，msi 可能是一种选择。例如，[RubyWorks](http://studios.thoughtworks.com/rubyworks)为您提供了一个完整的 Ruby on Rails 堆栈，所有这些都是通过安装一个包，然后通过依赖项安装其他包来完成的。
2.  **磁盘映像** 当然还有[磁盘映像工具](http://en.wikipedia.org/wiki/List_of_disk_imaging_software)用于存储已配置主机的映像，以便可以将其恢复到另一台主机。与虚拟化一样，这对于测试盒特别好，因为很容易将事物恢复到干净的状态。让事情持续更新仍然是一个问题——是否值得为了传播配置文件更改而制作新图像？

3.  **[虚拟化](http://en.wikipedia.org/wiki/Full_virtualization)**是另一种选择，例如制作 Xen、VirtualPC 或 VMWare 映像的副本以创建新主机。这对于测试盒特别有用，因为无论测试造成什么混乱，您都可以轻松恢复到干净的已知状态。与磁盘映像工具一样，与使用自动安装/配置工具相比，使主机保持最新需要更多的手动步骤和警惕性。

4.  **源代码控制** 一旦您安装/配置了必要的工具，那么构建应该就是从源代码存储库中检查所需的内容并构建它。

目前我使用上述组合来自动化该过程，如下所示：

*   从在 VMWare 来宾上安装准系统操作系统开始
*   运行 shell 脚本来安装 Puppet 并从源代码控制中检索其配置
*   木偶安装工具/组件/配置
*   从源代码控制中签出文件以构建和部署我们的 Web 应用程序

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2013-05-21T17:39:58.770

我偶然发现了这个问题，并且很惊讶没有人提到[Vagrant](http://www.vagrantup.com/)。

![流浪汉](https://i.stack.imgur.com/Lf6Q6.png)

正如 Pete TerMaat 和其他人所提到的，虚拟化是管理和自动化开发环境的好方法。Vagrant 基本上消除了设置这些虚拟盒子的痛苦。

几分钟之内，您就可以启动并运行您最喜欢的 Linux 发行版的全新副本，并以与生产服务器完全相同的方式进行配置[。](http://docs.vagrantup.com/v2/provisioning/index.html)

无需再与 OSX 或 Windows 争夺安装 PHP、MySQL 等。所有软件都在虚拟机中生存和运行。您甚至可以使用 SSH 登录`vagrant ssh`。如果您犯了错误或破坏了某些东西，`vagrant destroy`那就去做吧，然后`vagrant up`重新开始。

Vagrant 会自动为您的本地文件系统创建一个[同步文件夹](http://docs.vagrantup.com/v2/synced-folders/index.html)，这意味着您无需在虚拟机中进行开发（即使用 Vim）。使用您选择的任何编辑器。

我现在几乎为我所做的每个项目都创建了一个新的“Vagrant box”。我的所有设置都保存在项目存储库中，因此很容易引入其他团队成员。他们只需要提取 repo 并运行`vagrant up`，就可以开始使用了。

这也使得处理具有不同软件要求的项目变得更加容易。也许您有一些依赖 PHP 5.3 的项目，但也有一些运行 PHP 5.4 的较新项目。只需为该项目安装您想要的版本。

[一探究竟！](http://www.vagrantup.com/)

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-05-08T11:19:38.530

重要的一点是在源代码控制中设置您的项目，以便您可以在签出后立即构建、部署和运行。

这意味着您还应该检查辅助基础设施，例如 Makefile、ant 构建文件等，以及工具的设置，例如 IDE 项目文件。

这应该解决个别项目的设置麻烦。

对于基本的机器设置，您可以使用标准图像。另一种选择是使用您平台的工具来自动安装。在 Linux 下，您可以创建一个依赖于您需要的所有包的元包。在 Windows 下，类似的事情应该可以使用 MSI 等。

*编辑：*

理想情况下，您无需签入帮助基础架构，而是签入允许构建*生成*帮助基础架构的信息。这是例如 GNU 构建系统（autotools 等）或 Maven 所采用的方法。这更加优雅，因为您可以（理论上）为任何（受支持的）构建环境生成基础架构，因此您不必绑定到例如一个特定的 IDE，并且辅助基础架构（路径等）中的设置不需要复制主要项目设置。

然而，这也是一种更复杂的方法，所以如果你不能让它工作，我相信直接签入像 IDE 文件这样的东西是可以接受的。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-05-08T11:18:40.907

我喜欢使用 Virtual PC 或 VMware 来虚拟化开发环境。这提供了一个可以在开发人员之间共享的标准“开发环境”。您不必担心用户可能添加到系统中的软件可能与您的开发环境发生冲突。它还为我提供了一种方法来处理两个项目，其中开发环境不能都在一个系统上（使用两个不同版本的核心技术）。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-08T11:19:45.037

使用[puppet](http://reductivelabs.com/trac/puppet/wiki/AboutPuppet)配置您的开发和生产环境。使用一流的自动化系统是扩展您的运营的唯一方法。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-09-10T19:08:01.560

如果您使用 OSX 并使用 Rails。我建议：

*   [https://github.com/platform45/let-there-be-light](https://github.com/platform45/let-there-be-light)
*   [https://github.com/thoughtbot/laptop](https://github.com/thoughtbot/laptop)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-08T11:15:18.620

总是有使用虚拟机的选项（参见例如[VMWare Player](http://www.vmware.com/download/player/)）。只需最少的配置，即可为每位新员工创建一个环境并将其复制过来。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-08T13:32:19.360

在以前的地方，我们在 SCM（clearcase 然后 SVN）中拥有一切（我的意思是一切）。当一个新的开发人员可以安装 ClearCase|SVN 并吸收存储库时。当您需要更新特定的库/工具时，这也可以处理这种情况，因为您可以让开发团队更新他们的环境。

我们为此使用了两个 repo，因此代码和工具/配置位于不同的位置。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-06-04T06:11:49.887

我强烈推荐 DevStructure 的 Blueprint。它是开源的，您的用例实际上是我们最初编写该软件的*确切原因。*我们的目标有所改变，但它仍然是您所描述内容的完美工具。简而言之，您可以创建可重用的服务器配置 - 非常简单的配置管理。我希望这有帮助！

[https://github.com/devstructure/blueprint](https://github.com/devstructure/blueprint)（蓝图@Github）

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2011-08-17T22:51:17.797

我自己一直在思考这个问题。您可以将其他一些技术加入其中。这是我目前正在设置的内容：

*   基于 PXE 的预播种安装映像 (Debian Squeeze)。您可以启动裸机（或新的虚拟设备）并从 PXE 引导菜单中选择映像。这具有能够将您的环境安装在物理机器上的主要优势（除了虚拟设备）。
*   有人已经提到了Puppet。我使用 CFEngine 但这是一个类似的交易。本质上，您的配置被记录并集中在策略文件中，这些文件由客户端上的代理持续执行。
*   如果您不想要一个僵化的环境（即开发人员可以选择工具集的组合），您可以推出自己的 deb 包，以便新开发人员可以键入`sudo apt-get install acmecorp-eclipse-env`或`sudo apt-get install acmecorp-intellij-env`，例如。
*   有点题外话，但如果您运行基于 Debian 的环境（即 Ubuntu），请考虑安装`apt-cacher`（包代理）。除了节省带宽外，它还会使您的安装速度更快（因为软件包缓存在您的本地网络上）。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-08T11:21:06.000

如果您使用的是 linux 风格，您可能拥有一个包管理系统：认为 .rpm 用于 fedora/redhat，或 .deb 用于 ubuntu/debian。您描述的许多东西已经有可用的软件包：svn、eclipse 等。您可以为公司特定软件推出自己的软件包，创建一个存储库（可能仅在本地网络上可用），然后您的设置可以简化为单个bash 脚本，它将公​​司 repo 添加到 /etc/apt/sources.list (debian/ubuntu)，然后调用类似的命令，

```
 /home/newhire$ apt-get update && apt-get install some complete package list 
```

您可以使用[buildbot](http://buildbot.net/trac)自动为经常更改的公司包进行定期构建。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-08T11:14:49.917

如果您使用标准配置的机器，您可以使用全新的、完美配置的安装来镜像磁盘——这在许多公司中是一种非常流行的方法（不仅适用于开发人员）。如果您需要单独配置的操作系统，您可以在将配置的操作系统转换为所需的设置后 tar-bz2 所有添加和更改的文件，然后以 root 身份解压以从头开始构建所需的环境。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2014-07-05T16:17:30.890

[在http://nsnihalsahu.github.io/devscript](http://nsnihalsahu.github.io/devscript)试用 DevScript 。它的一个命令就像 , `devscript lamp`or `devscript laravel`or `devscript django`。在大约几分钟内，取决于您的互联网公司的速度

# java - JavaCC - 将数学表达式解析为类结构

> ID：839362
> 
> 赞同：1
> 
> 时间：2009-05-08T11:11:35.290
> 
> 标签：java, parsing, javacc

我正在使用这个语法来计算数学表达式：

```
 // Konfiguration (JavaCC-Manual konsultieren)
options {
    STATIC = true; // alle Parser-operationen sind static
    // verwende zwei Token um zu entscheiden, was passieren soll
    LOOKAHEAD = 2;
}

// hier beginnt unsere Parser Klasse ("MathParse")
PARSER_BEGIN(MathParse)
// hier kann ganz normaler Java-Code verwendet werden
public class MathParse {
    public static void main(String[] args) {
        // auch ein statischer Parser muss initiiert werden
        // - allerdings nur einmal
        MathParse parser = new MathParse(System.in);
        try {
            System.out.println(parser.parse());
        } catch(ParseException e) {
            e.printStackTrace();
        }
    }

    // die Parser-Methoden werden automatisch hinzugefügt
}
PARSER_END(MathParse)

// Diese Zeichen ignorieren wir
// SKIP : { $regex$ }
SKIP : { " " | "\t" }

// Jetzt definieren wir unsere Token

// TOKEN : { < $tokenname$ : $regex$ >}
// "NUMBER" entspricht einer unbegrenzten Anzahl (min. 1) an Zahlen
// (von 0 bis 9)
TOKEN : { < NUMBER : (["0"-"9"])+ ("." (["0"-"9"])+)? > }
TOKEN : { < EOL : "\n" > }

// Und fröhlich weiter mit der tatsächlichen Syntax
double parse() : {
    double value;
}
{
    value=expr()
    (<EOF> | <EOL>)     { return value; }
}

double expr() : {
    double x;
    double y;
}
{
    x=term()
    (
        "+" y=expr()    { x += y; }
    |
        "-" y=expr()    { x -= y; } 
    )*
    { return x; }
}

double term() : {
    double x;
    double y;
}
{
    x=value()
    (
        "*" y=term()    { x *= y; }
        |
        "/" y=term()    { x /= y; }
    )*
    { return x; }
}

double value() : {
    double value;
}
{
    "-" value=number()  { return -value; }
    |
    value=number()      { return value; }
}

double number() : {
    Token t;
    double value;
}
{
    t=<NUMBER>      { return Double.parseDouble(t.image); }
    |
    "(" value=expr() ")"    { return value; }
} 
```

这很好用。但是现在我不想得到一个数字作为结果，而是一个代表术语的类结构。我想到了这样的事情：

```
public abstract class Expression {
    public abstract double calculate();
}

public class NumberExpression extends Expression {
    public double Value;

    public NumberExpression(double value) {
        this.Value = value;
    }

    public double calculate() {
        return this.Value;
    }
}

public class ComplexExpression extends Expression {
    public Operator Operator;
    public Vector SubExpressions;

    public double calculate() {
        double result = ((Expression)this.SubExpressions.elementAt(0)).calculate();

        for (int i = 1; i < this.SubExpressions.size(); ++i)
            result = this.Operator.calculate(result, ((Expression)this.SubExpressions.elementAt(i)).calculate());

        return result;
    }
}

public abstract class Operator {
    public abstract String getOperator();
    public abstract double calculate(double x, double y);
} 
```

我与 Java 或 JavaCC 没有太多关系，所以你能告诉我如何为此编写语法吗？

PS：我正在使用Java ME。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-04-20T08:55:48.500

eWolf,

Try using JJTree which is a preprocessor for JavaCC and automatically introduces java code that creates Abstract Syntax Trees for parsed input.

Just visit [https://javacc.dev.java.net/](https://javacc.dev.java.net/) and find the JJTree manual.

# c# - 在与 ASP.Net 中的搜索控件相同的页面上显示搜索结果的最佳方式

> ID：839365
> 
> 赞同：1
> 
> 时间：2009-05-08T11:13:45.613
> 
> 标签：c#, .net, asp.net, controls, postback

我在一个页面上有两个控件，一个是搜索条目和提交控件，另一个是搜索结果控件，由于站点的布局，它们必须分开。我正在研究让搜索控件提交在结果控件中显示搜索结果的不同方式，最初我不关心回发，我更关心两件事

1）我如何将选定的搜索词传递回同一页面（或者实际上是显示结果的控件）查询字符串、隐藏字段、会话、视图状态（有效隐藏字段）？

2）我实际上如何使页面提交给自己。

抱歉，如果这有点基本但我不是 ASP.Net 专家

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-08T11:55:40.137

这些是用户控件，对吗？我认为在 UserControls 之间进行通信的最佳方式是使用事件。创建您自己的 EventArgs 类来封装搜索条件。提交控件在提交搜索时引发事件，包含页面处理该事件并调用搜索结果控件上的方法来执行搜索并显示结果。

或者，结果控件可能只负责显示对象集合，而搜索控件将实际执行搜索并在 EventArgs 中返回集合。

下面是一个来自用户控件的主-详细信息集的示例。ProjectList UserControl 在选择项目时引发事件：

```
public event EventHandler<ProjectSelectedEventArgs> ProjectSelected;

    protected void uxProjectList_OnSelectedIndexChanged(object sender, EventArgs e)
    {
        if (ProjectSelected != null)
        {
            var keys = uxProjectList.DataKeys[uxProjectList.SelectedIndex].Values;
            var projectId = (Guid)keys[0];

            var args = new ProjectSelectedEventArgs(projectId);
            ProjectSelected(this, args);
        }
    } 
```

容器页面处理事件并调用 ProjectDetail UserControl 上的方法来显示项目的详细信息。

```
 protected void uxHeroProjectList_ProjectSelected(object sender, ProjectSelectedEventArgs e)
    {

        uxProjectDetails.Visible = true;
        uxProjectDetails.DisplayDetails(e.ProjectId);
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-08T11:32:33.883

有很多很多方法可以满足您的要求，老实说，我不确定是否有正确的答案。这完全取决于您的开发风格和您要解决的问题。

我在编写搜索界面方面有相当多的经验，我认为使用查询字符串是传递搜索条件的好方法。然而，这有它的优点和缺点。

优点：

*   只需传递查询字符串，您就可以从站点或外部站点的任何位置访问搜索结果页面。

*   您的搜索结果可以很容易地被抓取，因为它们只是您网站上的页面。

*   查询字符串使用起来相当简单。

*   用户可以在查询字符串中看到他们正在搜索的内容。（但是这可能是一件坏事，这取决于它的用途。）

*   用户可以为他们的搜索结果添加书签（感谢 Fredrik Mörk）

缺点：

*   您可能需要花时间让您的搜索条件看起来很漂亮。IE 您是否希望您的用户只看到一个对他们来说毫无意义的 id？

*   您可能在对搜索条件进行 html 编码时遇到问题，因为它们需要作为查询字符串参数传递。编码可以很容易地完成，但如果您将保留字符用于其他事情，它可能会让您头疼。

*   您的用户可以看到他们正在搜索的内容。（就像我说的，这可能是好事也可能是坏事。）

*   您的查询字符串可能会变得太长。

可能还有其他一些我没有想到的事情，但这给了你一个想法。

至于再次将页面发布回自身，有几种方法可以做到这一点，但请尝试使用带有 # 符号作为 href 属性的提交按钮或锚标记。

另一件要考虑的事情可能是使用 url 重写器来使你丑陋的查询字符串成为一个好看的 URL。

例如：

used_car_search.aspx?make=ford&model=focus

可能变成：

used_ford_focus.html

快乐编码:)

# java - 在 Hadoop 中并行化 Ruby 减速器？

> ID：839371
> 
> 赞同：4
> 
> 时间：2009-05-08T11:15:42.160
> 
> 标签：java, ruby, hadoop, mapreduce

Ruby 中一个简单的 wordcount reducer 如下所示：

```
#!/usr/bin/env ruby
wordcount = Hash.new
STDIN.each_line do |line|
keyval = line.split("|")
wordcount[keyval[0]] = wordcount[keyval[0]].to_i+keyval[1].to_i
end

wordcount.each_pair do |word,count|
puts "#{word}|#{count}"
end 
```

它在 STDIN 中获取所有映射器的中间值。不是来自特定的键。所以实际上所有人只有一个减速器（而不是每个单词或每组单词的减速器）。

但是，在 Java 示例中，我看到这个接口获取一个键和值列表作为 inout。这意味着中间映射值在归约之前按键分组，并且归约器可以并行运行：

```
public static class Reduce extends MapReduceBase implements Reducer<Text, IntWritable, Text, IntWritable> {
            public void reduce(Text key, Iterator<IntWritable> values, OutputCollector<Text, IntWritable> output, Reporter reporter) throws IOException {
              int sum = 0;
              while (values.hasNext()) {
                sum += values.next().get();
              }
              output.collect(key, new IntWritable(sum));
            }
          } 
```

这是 Java 独有的功能吗？或者我可以使用 Ruby 使用 Hadoop Streaming 来做到这一点吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-09T19:13:10.013

无论您是否使用流式处理，Reducers 将始终并行运行（如果您没有看到这一点，请验证作业配置是否设置为允许多个 reduce 任务 - 请参阅集群或作业配置中的 mapred.reduce.tasks ）。不同之处在于，当您使用 Java 与流式传输时，框架会更好地为您打包。

对于 Java，reduce 任务获取一个针对特定键的所有值的迭代器。如果您在 reduce 任务中对 map 输出求和，这使得遍历值变得容易。在流式传输中，您实际上只是得到一个键值对流。您**可以**保证这些值将按键排序，并且对于给定键的值不会在 reduce 任务中拆分，但是您需要的任何状态跟踪都取决于您。例如，在 Java 中，您的 map 输出以符号形式出现在您的 reducer 中

key1, {val1, val2, val3} key2, {val7, val8}

使用流式传输，您的输出看起来像

key1, val1 key1, val2 key1, val3 key2, val7 key2, val8

例如，要编写一个计算每个键的值总和的化简器，您需要一个变量来存储您看到的最后一个键，并需要一个变量来存储总和。每次读取新的键值对时，都执行以下操作：

1.  检查密钥是否与最后一个密钥不同。
2.  如果是这样，输出您的密钥和当前总和，并将总和重置为零。
3.  将当前值添加到总和并将最后一个键设置为当前键。

HTH。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T13:22:49.350

我自己没有尝试过 Hadoop Streaming，但通过阅读文档，我认为您可以实现类似的并行行为。

流式传输将通过键对映射器输出进行分组，而不是将具有关联值的键传递给每个化简器。它还保证具有相同键的值不会被拆分到多个 reducer。这与正常的 Hadoop 功能有些不同，但即便如此，reduce 工作仍将分布在多个 reducer 上。

尝试使用该`-verbose`选项来获取有关实际情况的更多信息。您还可以尝试使用`-D mapred.reduce.tasks=X`X 是所需的减速器数量的选项。

# class - 静态类相对于使用单例的优势

> ID：839383
> 
> 赞同：8
> 
> 时间：2009-05-08T11:19:45.397
> 
> 标签：class, static, singleton

## 复制

> [单例有什么问题？](https://stackoverflow.com/questions/86654/whats-wrong-with-singleton)
> [单身人士：好的设计还是拐杖？](https://stackoverflow.com/questions/11831/singletons-good-design-or-a-crutch)
> [Singleton：应该如何使用 Singletons有](https://stackoverflow.com/questions/86582/singleton-how-should-it-be-used)
> [什么不好](https://stackoverflow.com/questions/137975/what-is-so-bad-about-singletons)

* * *

您可以找到许多使用单例而不是静态类的原因。但是在某些情况下，在 Singleton 之前使用静态类肯定会更好。这些是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-08T11:38:37.263

您可以在以下情况下使用静态类：

1）它的所有方法都是实用程序（很好的例子 - 数学类）

2）你不想处理从垃圾收集器中保留你的实例（在小程序中），但我最好在那里使用单例

3）您绝对确定它将来不会变成有状态的，并且您确定您将始终只需要该类的一个实例

如果您正在使用单例，并且在某一时刻您意识到您需要多个实例，那么您的单例可以很容易地转换为多音，但是您将遇到静态类的问题

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-08T11:24:18.020

多年来与静态类消费者的可测试性作斗争后，我可以诚实地说它们是邪恶思想的产物。不过说真的，我会在 C# 中将静态类用于扩展方法，但在其他任何地方都不会。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-08T11:23:11.877

如果您的类不存储任何状态，则使用静态类。

如果它存储状态并且您需要单个实例，那么（也许）使用单例。

否则使用普通课程。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-08T11:22:53.360

当您不需要更改实现时，静态类会更好。使用 Singleton，您可以拥有具有各种实现的接口。一个静态类，只能是一个实现。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-04-05T13:35:10.787

单例是只能实例化一个实例的类，而没有与静态方法关联的实例。

如果您可以使用单个静态方法实现您想要的功能，那么这可能是您最好的方法，因为它更容易实现。考虑扩展方法——它们只是带有语法糖的静态方法。如果您可以在逻辑上将静态方法视为现有类的帮助器，那么使用静态方法是有意义的。

另一方面，如果您尝试实现的功能涉及某种状态，那么最好使用 Singleton 代替。Singleton 对象可以包含/管理其状态并管理并发访问/线程，而使用静态类和静态方法会变得更加复杂。如果您在 C# 中使用单例，我强烈建议您阅读 Jon Skeet 关于正确单例实现的文章，该文章可在[http://www.yoda.arachsys.com/csharp/singleton.html](http://www.yoda.arachsys.com/csharp/singleton.html)获得。

与静态方法相比，单例更类似于静态类。在此比较中，单例的一大优势是它们可以实现接口并从基类派生。这允许您将它们的实现与它们的接口分离。例如，如果我的`IAccountService`核心程序集中有一个带有 Singleton 实现的接口，`SingletonAspNetAccountService`在我的服务层中，那么我可以`IAccountService`使用 IoC 容器将其注入我的 UI 层，而无需在 UI 层中依赖我的服务层。另一方面，如果我有一个静态`Accounts`类，那么我必须要么为静态类的方法创建一个适配器，要么依赖我的 UI 中的服务层才能访问静态帐户功能。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-05-08T11:22:37.463

它始终是您实际上不需要在任何地方传递单例实例的地方。例如，如果单例实现了某个接口，它将很有用，而您不能使用静态类来实现。

请记住，每个 Class 实例都是一个单例，由 JVM 管理。所以静态类是一个单例。

# python - Twisted 和 p2p 应用程序

> ID：839384
> 
> 赞同：14
> 
> 时间：2009-05-08T11:20:58.777
> 
> 标签：python, twisted, protocols, p2p

你能告诉我：我可以使用 twisted 来创建 p2p 应用程序吗？我应该为此选择什么协议？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-11T02:02:34.023

最好的解决方案是使用 BitTorrent 的源代码。它是使用 Twisted 构建的，直到他们切换到称为 Utorrent 的 C++ 实现。

*   BitTorrent 的最后一个已知 Twisted 版本
    *   [http://download.bittorrent.com/dl/archive/BitTorrent-5.2.2.tar.gz](http://download.bittorrent.com/dl/archive/BitTorrent-5.2.2.tar.gz)
*   旧版本
    *   [http://download.bittorrent.com/dl/archive/](http://download.bittorrent.com/dl/archive/)

作为替代方案，您可能还想看看[Vertex](https://github.com/twisted/vertex)。

它是一个建立在 Twisted 之上的 p2p 库，并带有绕过防火墙之类的好东西。

它可能比其他人的样本更完整。

*   链接到顶点
    *   [https://github.com/twisted/vertex](https://github.com/twisted/vertex)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-08T13:06:53.697

[bittorrent 扭曲的 python 客户端/服务器](http://code.activestate.com/recipes/440555/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-08T11:30:12.390

是的，twisted 用于创建 Bittorrent 的初始版本。有一些开源库可以开始。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-11T01:46:14.737

是的，您绝对可以使用 twisted 创建 p2p 应用程序。我首先想到的是 Dtella ( [http://dtella.org/](http://dtella.org/) )。它使用 Direct Connect 协议。

他们提供了源代码，这样你就可以开始了。我知道很多不同的大学网络都在运行 DC 集线器。这似乎是该协议的理想用途。

# sql - 我怎么能忽略加入这些#temp（默认数据）和另一个表？

> ID：839386
> 
> 赞同：2
> 
> 时间：2009-05-08T11:21:03.787
> 
> 标签：sql, sql-server, sql-server-2005, tsql

我尝试使用查询（如下）生成一个表（查看表 1）。

```
CREATE TABLE #temp(
[VisitingCount] int,
[Time] nvarchar(50) )
DECLARE @DateNow DATETIME,@i int

SET @DateNow='00:00'
set @i=1;

    while(@i<1440)
begin
    set @DateNow=DATEADD(minute, 1, @DateNow)
    insert into #temp ([VisitingCount], [Time]) values(0, right(left(convert(nvarchar, @DateNow, 121), 16), 5))
    set @i=@i+1
end

select Count(VisitingCount) as VisitingCount,[Time]      
from   
#temp as Alltimes
left outer join   
( SELECT Page,Date,[user],      
        dbo.fn_GetActivityLogArranger2(Date,'hour') as [Time]
        FROM scr_SecuristLog      
) scr_SecuristLog      
on Alltimes.[Time] = scr_SecuristLog.[Time]
where      
        Date between '2009-04-30' and '2009-05-02'      
and      
        [user] in      
(       select USERNAME      
        from scr_CustomerAuthorities      
        where customerID=Convert(varchar,4)      
        and ID=Convert(varchar,43)      
)      
group by [Time] order by [Time] asc
drop table #temp
```

* * *

我需要这个结果（下）。这个代码是关于系统入口日志的，但是在 12:30 和 13:30 之间有一个休息午餐。所以在 12:30 到 13:30 之间不能进入我们的系统。如果你画 log Graghic。由于早午餐间隙，您可以看到“M”字符

我的梦想表 1 结果：

计数---------时间---------
10------------10:30
22------------10 :40
30------------10:50
44------------11:00
。
.
.
.
.
0--------------12:30
0-------------12:40
0--------------12： 50
0--------------13:00
。
.
.
.
.
10--------------16:00
21-------------16:10
56--------------16： 20
46-------------16:30

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-08T13:08:36.313

这是您的 where 子句，过滤了一些时间范围。您需要为内部选择设置该子句：

```
select Count(VisitingCount) as VisitingCount,[Time]      
from   
#temp as Alltimes
left outer join   
( SELECT Page,Date,[user],      
        dbo.fn_GetActivityLogArranger2(Date,'hour') as [Time]
        FROM scr_SecuristLog      
        where Date between '2009-04-30' and '2009-05-02'      
        and      
        [user] in      
        (       select USERNAME      
                from scr_CustomerAuthorities      
                where customerID=Convert(varchar,4)      
                and ID=Convert(varchar,43)      
        )      
) scr_SecuristLog      
on Alltimes.[Time] = scr_SecuristLog.[Time]
group by [Time] order by [Time] asc 
```

# unit-testing - BizTalk IDE 和 XmlReader 之间的架构验证差异

> ID：839391
> 
> 赞同：1
> 
> 时间：2009-05-08T11:22:23.300
> 
> 标签：unit-testing, validation, schema, biztalk

我正在尝试对我正在开发的 BizTalk 应用程序进行单元测试，遵循 Michael Stephensons[博客文章](http://geekswithblogs.net/michaelstephenson/archive/2008/03/30/120850.aspx)中的示例，并且似乎正在取得进展

然后我得到了一个错误，我追踪到我正在使用的“无效”XML测试文件，但这正在通过我对模式单元测试的验证......
-*原因是不正确的命名空间*

我的困惑是为什么 XmlReader 认为 XML 与架构相比是有效的，但是如果我使用 BizTalk IDE“验证实例”选项，我会收到错误
……*错误 BEC2004：架构 FromFrontOffice.xsd 的验证实例失败， 文件： ...*

```
XmlSchema schema = XmlSchema.Read(schemaStream, null);
XmlReaderSettings xmlReaderSettings = new XmlReaderSettings();
xmlReaderSettings.Schemas.Add(schema);
xmlReaderSettings.ValidationType = ValidationType.Schema;
xmlReaderSettings.ValidationEventHandler += ValidationEventHandler;
XmlReader xmlReader = XmlReader.Create(xmlStream, xmlReaderSettings);
while (xmlReader.Read())

private void ValidationEventHandler(object sender, ValidationEventArgs args)
{
  if (args.Exception == null) return;
  _IsValid = false;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-08T16:35:21.120

认为我已经对其进行了排序......技巧似乎是使用 ValidationFlags

```
xmlReaderSettings.ValidationFlags =
    XmlSchemaValidationFlags.ReportValidationWarnings |
    XmlSchemaValidationFlags.ProcessIdentityConstraints |
    XmlSchemaValidationFlags.ProcessInlineSchema |
    XmlSchemaValidationFlags.ProcessSchemaLocation; 
```

# java - 在 Java 中复制 C 结构填充

> ID：839407
> 
> 赞同：4
> 
> 时间：2009-05-08T11:27:34.270
> 
> 标签：java, c, compiler-construction, padding

根据[这里](http://c-faq.com/struct/padding.html)，C编译器将在将结构写入二进制文件时填充值。正如链接中的示例所说，在编写这样的结构时：

```
struct {
 char c;
 int i;
} a; 
```

对于二进制文件，编译器通常会在 char 和 int 字段之间留下一个未命名的、未使用的空洞，以确保 int 字段正确对齐。

如何使用不同的语言（在我的例子中是 Java）创建二进制输出文件（用 C 生成）的精确副本？

是否有自动方法在 Java 输出中应用 C 填充？还是我必须通过编译器文档来查看它是如何工作的（顺便说一下，编译器是 g++）。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-08T11:37:59.090

不要这样做，它很脆弱，会导致对齐和字节顺序错误。

对于外部数据，最好以字节为单位显式定义格式，并使用移位和掩码（不是联合！）编写显式函数以在内部和外部格式之间进行转换。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-08T11:31:05.337

不仅在写入文件时如此，在内存中也是如此。如果结构是逐字节写出的，那么结构在内存中填充的事实会导致文件中出现填充。

通常很难确定地复制确切的填充方案，尽管我猜一些启发式方法会让你走得很远。如果您有 struct 声明以进行分析，它会有所帮助。

通常，大于一个字符的字段将被对齐，以便它们在结构内的起始偏移量是它们大小的倍数。这意味着`short`s 通常会在偶数偏移量上（可被 2 整除，假设`sizeof (short) == 2`），而`double`s 将在可被 8 整除的偏移量上，依此类推。

**更新**：出于这样的原因（以及与字节序有关的原因），将整个结构转储到文件中通常是一个坏主意。最好逐个字段进行，如下所示：

```
put_char(out, a.c);
put_int(out, a.i); 
```

假设`put`-functions 只写入值所需的字节，这将向文件发出结构的无填充版本，从而解决问题。也可以通过相应地编写这些函数来确保正确的、已知的字节排序。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-08T12:11:43.233

> 是否有自动方法在 Java 输出中应用 C 填充？还是我必须通过编译器文档来查看它是如何工作的（顺便说一下，编译器是 g++）。

两者都不。相反，您明确指定数据/通信格式并实现该规范，而不是依赖 C 编译器的实现细节。您甚至不会从不同的 C 编译器获得相同的输出。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-08T12:13:12.343

对于互操作性，请查看 ByteBuffer 类。

本质上，您创建一个一定大小的缓冲区，在不同位置放置不同类型的变量，然后在最后调用 array() 以检索“原始”数据表示：

```
ByteBuffer bb = ByteBuffer.allocate(8);
bb.order(ByteOrder.LITTLE_ENDIAN);
bb.put(0, someChar);
bb.put(4, someInteger);
byte[] rawBytes = bb.array(); 
```

但是由您决定在哪里放置填充 - 即在位置之间跳过多少字节。

为了读取从 C 写入的数据，通常在从文件中读取的某个字节数组周围*wrap()一个 ByteBuffer。*

如果它有帮助，我在[ByteBuffer](http://www.javamex.com/tutorials/io/nio_byte_order.shtml)上写了更多。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-08T19:03:11.950

在 Java 中读/写 C 结构的一种方便方法是使用 javolution Struct 类（参见[http://www.javolution.org](http://www.javolution.org)）。这不会帮助您自动填充/对齐数据，但它确实使处理保存在 ByteBuffer 中的原始数据更加方便。如果您不熟悉 javolution，那么值得一看，因为里面还有很多其他很酷的东西。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-08T11:30:09.380

这个洞是可配置的，编译器有开关来将结构对齐 1/2/4/8 字节。

所以第一个问题是：你想模拟哪种对齐方式？

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-08T11:40:22.517

对于 Java，数据类型的大小由语言规范定义。例如，一个`byte`类型是 1 个字节，一个`short`是 2 个字节，以此类推。这与 C 不同，其中每种类型的大小取决于体系结构。

因此，了解二进制文件的格式以便能够将文件读入 Java 非常重要。

可能需要采取措施来确定字段是特定大小的，以考虑编译器或体系结构的差异。提到对齐似乎表明输出文件将取决于架构。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-08T12:52:30.813

你可以试试[preon](http://preon.sourceforge.net/)：

> Preon 是一个 java 库，用于以声明性（基于注释）的方式为比特流压缩数据构建编解码器。想想 JAXB 或 Hibernate，然后是二进制编码数据。

它可以处理 Big/Little endian 二进制数据、对齐（填充）和各种数字类型以及其他功能。这是一个非常好的图书馆，我非常喜欢它

我的 0.02 美元

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-08T19:09:11.093

我强烈推荐[协议缓冲区](http://code.google.com/p/protobuf/)来解决这个问题。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-08T17:29:51.253

据我了解，您是说您不控制 C 程序的输出。你必须把它当作给定的。

那么您是否必须为某些特定的结构集阅读此文件，或者您是否必须在一般情况下解决这个问题？我的意思是，有人说“这是程序 X 创建的文件，你必须用 Java 读取它”的问题吗？还是他们希望您的 Java 程序读取 C 源代码，找到结构定义，然后用 Java 读取它？

如果你有一个特定的文件要读取，那么问题并不是很困难。通过查看 C 编译器规范或研究示例文件，找出填充的位置。然后在 Java 端，将文件作为字节流读取，并构建您知道即将到来的值。基本上我会编写一组函数来从 InputStream 读取所需的字节数并将它们转换为适当的数据类型。像：

```
int readInt(InputStream is,int len)
  throws PrematureEndOfDataException
{
  int n=0;
  while (len-->0)
  {
    int i=is.read();
    if (i==-1)
      throw new PrematureEndOfDataException();
    byte b=(byte) i;
    n=(n<<8)+b;
  }
  return n;
} 
```

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2009-05-08T11:31:27.253

您可以更改 c 端的打包以确保不使用填充，或者您可以在十六进制编辑器中查看生成的文件格式，以允许您在 Java 中编写一个忽略填充字节的解析器。

# javascript - 回调函数中“this”的值

> ID：839408
> 
> 赞同：4
> 
> 时间：2009-05-08T11:28:50.880
> 
> 标签：javascript, ajax

我有这个代码来对 web 服务执行 ajax 请求：

```
var MyCode = {
    req: new XMLHttpRequest(), // firefox only at the moment

    service_url: "http://url/to/Service.asmx",

    sayhello: function() {
        if (this.req.readyState == 4 || this.req.readyState == 0) {
            this.req.open("POST", this.service_url + '/HelloWorld', true);
            this.req.setRequestHeader('Content-Type','application/json; charset=utf-8');
            this.req.onreadystatechange = this.handleReceive; 
            var param = '{}';
            this.req.send(param);
        }
    },

    handleReceive: function() {
        if (this.req.readyState == 4) {
            // todo: using eval for json is dangerous
            var response = eval("(" + this.req.responseText + ")");
            alert(response);
        }
    }
} 
```

它当然是用 MyCode.sayhello() 调用的。

它的问题是在handleReceive函数的第一行“req is not defined”。它确实被调用了 4 次，所以我知道上面的代码将请求发送到服务器。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-08T11:31:48.033

经典的闭包问题。当你得到回调时，闭包实际上已经引用了 HTTP 对象。

您可以按照某人的建议执行以下操作：

```
var that = this;
this.req.onreadystatechange = function() { this.handleReceive.apply(that, []); }; 
```

或者只需执行以下操作：

```
var that = this;
this.req.onreadystatechange = function() { that.handleReceive(); }; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-08T11:39:13.407

您可以通过在 MyCode 中创建一个引用 this 的变量来解决这个问题。像

```
var MyCode = {
    req: new XMLHttpRequest(), // firefox only at the moment

    self = this

    ...
} 
```

然后你可以引用 self 而不是 this。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T11:39:16.077

改变这个：

```
this.req.onreadystatechange = this.handleReceive; 
```

对此：

```
var self = this;
this.req.onreadystatechange = function() { self.handleReceive(); } 
```

这将创建一个可以解决您的问题的闭包。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-08T11:41:36.227

你应该能够通过改变使它工作

```
this.req.onreadystatechange = this.handleReceive; 
```

到

```
var that = this;
this.req.onreadystatechange = function() { this.handleReceive.apply(that, []); }; 
```

Function.prototype.apply 可用于显式调用函数`this`和函数的参数。

# php - 如何从 PHP 运行 .bat 文件返回和处理结果

> ID：839409
> 
> 赞同：2
> 
> 时间：2009-05-08T11:30:00.630
> 
> 标签：php, windows, amazon-ec2, batch-file

我有一个执行 .bat 文件的 PHP 脚本，使用

```
system("cmd /c C:\dir\file.bat"); 
```

这将启动 AWS 服务器并返回信息，例如启动的服务器的 id。稍后我需要在脚本中使用这个 id。如何将 .bat 文件中的结果返回给 PHP，然后如何从其余结果中提取 id。返回的数据是否只是一个字符串，我需要对其进行切片以获得所需的位？

然后，我将运行一个执行以下命令的 .bat 文件 -

```
ec2-associate-address -i i-######id  ip.###.###.### 
```

谢谢大家

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-08T12:14:22.043

您可以使用 exec() 函数或 passthru() 函数来捕获系统命令的输出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T12:18:07.853

您可以使用[proc_open() 而不是 system()](http://nl.php.net/manual/en/function.proc-open.php)。这样您就可以通过读取 stdout 管道来读取 .bat 文件的输出。然后你得到你的简单字符串，你可以切片'n dice 来获取你的进程ID。

# iphone - 你将如何为 UIScrollView 实现 dataSource 对象？

> ID：839413
> 
> 赞同：0
> 
> 时间：2009-05-08T11:30:48.910
> 
> 标签：iphone, cocoa-touch, uikit, uiview, uiscrollview

如果我错了，请告诉我：

我创建了一个新类 ScrollViewDataSource。该类符合我在委托中为滚动视图创建的协议。嗯，它是一个非常特殊的委托，它在滚动时会做一些非常复杂的事情。因此，此委托在初始化时接收该数据源对象。数据源对象现在有一个方法

*   (NSArray*)subviewsFromIndex:(NSInteger)fromIndex toIndex:(NSInteger)toIndex;

因此，当用户滚动时，委托会在滚动时多次响铃数据源对象以请求数据。我将在滚动期间回收视图。这意味着，如果用户向下滚动，我会从上到下删除视图，并用新数据填充它们。

NSArray 包含 UIView 对象，这些对象将在滚动期间适当定位。此外，在第一次启动包含滚动视图的视图时，数据源将传递数据以显示第一个可见内容。

这是一个好的模式，还是你有更好的想法？顺便说一句：我知道 UITableView 做了类似的事情。但我想学那个。这对我来说是一种练习。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-10-10T18:46:10.197

可能，

这是您可以使用的最佳模式。Apple 在其各种数据显示视图（如 iPhone 中的 UITableView 和 Mac 中的 NSTableView、NSOutlineView）中排他性地紧随其后。

一切顺利。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-10T21:00:01.813

如果您的内容视图使用相同的布局，我将使 ScrollViewDataSource 仅包含内容视图所需的数据，因此在询问新数据时我不需要为我的 UIScrollView 分配/创建新的 UIView（因为 MyScrollView 持有我的内容视图可以重复使用）：

```
@interface MyScrollView : UIView {
@private
    id <MyScrollViewDelegate> _delegate;
    id <MyScrollViewDataSource> _dataSource;

    UIScrollView *_scrollView;
    NSMutableArray *_contentViews; // you need to create/maintain/reuse contentView from here
}

@property (nonatomic, assign) id <MyScrollViewDelegate> delegate;
@property (nonatomic, assign) id <MyScrollViewDataSource> dataSource;
@end

@protocol MyScrollViewDataSource <NSObject>
@optional
- (NSString *)myScrollView:(MyScrollView *)myScrollView requestTitleForContentViewAtIndex:(NSInteger)index;
- (UIImage *)myScrollView:(MyScrollView *)myScrollView requestLogoForContentViewAtIndex:(NSInteger)index;
@end

... 
```

这样做的好处是，您的 MyScrollView 界面对于超级视图来说看起来很干净，并且您正在处理 MyScrollView 中的所有滚动、布局、重绘和内容更新内容，并且不会打扰外部的其他视图或控制器。

但是，如果您的内容视图彼此完全不同，我不会使用这样的模式。

# json - 需要带有 Json 的 jGrid

> ID：839416
> 
> 赞同：0
> 
> 时间：2009-05-08T11:31:40.453
> 
> 标签：json

我得到了适用于表格而不适用于 Json 格式的 JGrid，有没有人有 json 版本

[http://www.overset.com/2008/08/30/animated-sortable-datagrid-jquery-plugin-jtps/](http://www.overset.com/2008/08/30/animated-sortable-datagrid-jquery-plugin-jtps/)

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-07-03T04:26:28.010

这是示例

```
{ 
  total: "xxx", 
  page: "yyy", 
  records: "zzz",
  rows : [
    {id:"1", cell:["cell11", "cell12", "cell13"]},
    {id:"2", cell:["cell21", "cell22", "cell23"]},
      ...
  ]
} 
```

您可以在以下链接中找到此信息：

[http://www.secondpersonplural.ca/jqgriddocs/index.htm](http://www.secondpersonplural.ca/jqgriddocs/index.htm)

该示例是默认的 json readear，但您可以对其进行修改

# db2 - DB2 sp_rename 等效项

> ID：839423
> 
> 赞同：2
> 
> 时间：2009-05-08T11:34:03.427
> 
> 标签：db2

是否有与 sp_rename 等效的 DB2 v9.1？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-08T18:41:42.190

这取决于对象。

对于表和索引，可以使用[RENAME](http://publib.boulder.ibm.com/infocenter/db2luw/v9/index.jsp?topic=/com.ibm.db2.udb.admin.doc/doc/r0000980.htm) sql 语句。

如果要重命名列，可以使用[ALTER TABLE ... RENAME COLUMN](http://publib.boulder.ibm.com/infocenter/db2luw/v9/topic/com.ibm.db2.udb.admin.doc/doc/r0000888.htm)。

对于其他对象，您可能必须删除并重新创建它。

希望有帮助。

# database-design - 为不同类型的动作设计动作历史数据库

> ID：839425
> 
> 赞同：2
> 
> 时间：2009-05-08T11:35:45.373
> 
> 标签：database-design

在错误跟踪系统中，我想跟踪一些操作。更改状态、添加评论、更改优先级和其他操作等操作。

问题是，我如何使用不同的参数存储这些不同的动作。例如当有人改变状态时，它需要保存状态变化，旧状态和新状态。但是当有人添加评论时，它需要保存添加的评论，带有评论ID。

一种解决方案是将这些参数保存为纯文本。像“oldstatus => new status”、“comment 001 added”。但这似乎并不可行。

有人知道这如何工作得最好吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T11:42:33.570

您可以将实际状态存储在错误表中，并将状态更改的历史记录保存在不同的表中：

```
changeid (pk) - ticketid (fk) - date - oldstatus - newstatus - username 
```

评论通常也在不同的表格中：

```
commentid (pk) - ticketid (fk) - date - username - comment 
```

检索数据时，您可以检索错误的所有评论，例如：

```
select 
from comments 
where comments.bugid = 12 
```

PS (pk) = 主键，(fk) 是外键

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T11:42:35.553

我宁愿`TaskInfoRevision`为每次更改在表中保留一个单独的条目，包括状态、注释、属性等所有字段，然后确定应用程序代码中发生的更改，而不是数据库本身。

# sorting - OAuth - c#中的字典字节值排序

> ID：839429
> 
> 赞同：2
> 
> 时间：2009-05-08T11:38:24.580
> 
> 标签：sorting, oauth, parameters

我已经为 OAuth 编写了一个服务提供者实现，其中一位开发人员发现该实现对查询参数进行排序的方式存在错误。我完全错过了OAuth 规范中的[字典顺序](http://oauth.net/core/1.0/#anchor14)要求，只是对名称值参数进行了基本的字符串排序

给定来自消费者的以下 URI 请求：

```
http://api.com/v1/People/Search?searchfor=fl&communication=test@test.com&Include=addresses 
```

生成的签名库应将参数排序为：

```
Include=addresses, communication=test@test.com, searchfor=fl 
```

给定来自消费者的以下 URI 请求：

```
http://api.com/v1/People/Search?searchfor=fl&communication=test@test.com&include=addresses 
```

生成的签名库应将参数排序为：

```
communication=test@test.com, include=addresses, searchfor=fl 
```

请注意查询字符串参数“include”中的大小写差异。据我了解，字典字节值排序将使用 ascii 值对参数进行排序，然后按 asc 排序。

由于 I = 73 和 i = 105，大写 I 应该排在小写 i 之前。

到目前为止，我有以下内容：

```
IEnumerable<QueryParameter> queryParameters = parameters
.OrderBy(parm => parm.Key)
.ThenBy(parm => parm.Value)
.Select(
parm => new QueryParameter(parm.Key, UrlEncode(parm.Value))); 
```

但这不会按字符排序覆盖 ascii 字符（IncLude=test&Include=test 不会正确排序）。

关于如何制定一个有效的算法来解决这个问题的任何想法？或者如何通过 ICompare 使排序区分大小写？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-08T18:57:05.490

尼克，你已经发现 StringComparison.Ordinal 是要走的路。我只是想提醒您在对每个键和值进行 URI 编码后进行排序。

顺便说一句，已经有一些 OAuth 库，[DotNetOpenAuth](http://dotnetopenid.googlecode.com)是我最喜欢的（免责声明：出于偏见的原因）。您确定要构建/维护这个吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T12:34:10.140

我通过创建自定义比较器解决了这个问题，但是，它看起来很笨重，我觉得必须有更好的方法：

```
public class QueryParameterComparer : IComparer<QueryParameter> {
    public int Compare(QueryParameter x, QueryParameter y) {
          if(x.Key == y.Key) {
             return string.Compare(x.Value, y.Value, StringComparison.Ordinal);
          }
           else {
             return string.Compare(x.Key, y.Key, StringComparison.Ordinal);
          }
    }
} 
```

使用序数字符串比较对我来说是什么。它进行字节比较，这正是我所需要的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-08T19:33:28.497

我对相同的表达式有问题（尽管它在 OAuth 文档中不再拼写错误，如果那是拼写错误的地方。）

Wikipedia sais，“[字典顺序](http://en.wikipedia.org/wiki/String_(computer_science)#Lexicographical_ordering)”在给出字母顺序时有意义。当元素的顺序已经指定时，它指定一系列元素（字母）的顺序。

这对我来说听起来很合理。:)。

# android - Android核心库错误

> ID：839435
> 
> 赞同：20
> 
> 时间：2009-05-08T11:39:58.600
> 
> 标签：android

当我包含 jaxp.jar 时，我收到以下错误 -

```
trouble processing "javax/xml/XMLConstants.class":
[2009-05-08 16:53:18 - TestProject] 
Attempt to include a core VM class in something other than a core library.
It is likely that you have attempted to include the core library from a desktop
virtual machine into an application, which will most assuredly not work. If
you really intend to build a core library -- which is only appropriate as
part of creating a full virtual machine binary, as opposed to compiling an
application -- then use the "--core-library" option to suppress this error
message. If you go ahead and use "--core-library" but are in fact building
an application, then please be aware that your build will still fail at some
point; you will simply be denied the pleasure of reading this helpful error
message.
[2009-05-08 16:53:18 - TestProject] 1 error; aborting
[2009-05-08 16:53:18 - TestProject] Conversion to Dalvik format failed with error 1 
```

有没有人遇到过这个问题？任何帮助将不胜感激我已经采用了一些解决方案，但它们并不具体。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-18T20:47:10.497

您从 Dx 获得的错误仅基于您正在导入的库的 java 包名称，而不是其他任何内容。

该消息可以概括为：**如果您在`java.*`or`javax.*`命名空间中导入一个库，它很可能依赖于其他“核心”库，这些库仅作为 JDK 的一部分提供，因此在 Android 平台中不可用.** 它本质上是在防止您做一些愚蠢的事情，当您看到该消息时，99% 的时间都是准确的。

现在，当然，仅仅因为 java 包以`java.*`或`javax.*`并不一定意味着它依赖于适当的 JDK。它可能在android中工作得很好。要绕过愚蠢检查，请将 --core-library 选项添加到 dx. 更改 from 的最后一行`$ANDROID_HOME/platform-tools/dx`，

```
exec java $javaOpts -jar "$jarpath" "$@" 
```

至，

```
exec java $javaOpts -jar "$jarpath" --core-library "$@" 
```

就我而言，我包含了一个依赖于 JAXB 的 Jackson 库。对我来说，重写愚蠢检查是可以接受的，因为该库对 Jackson 的使用仅用于 JSON，而不用于 XML 序列化（我只包括 JAXB API 库，而不是 impl）。当然，我希望有一种更简洁的方法来解决这个问题，但是重写顶级库以避免使用 Jackson 不是一种选择。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-12-15T06:22:34.033

我看到两种可能性：

在您的项目文件夹中，该文件`.classpath`可能是错误的。尝试将其替换为：

```
<?xml version="1.0" encoding="UTF-8"?>
<classpath>
<classpathentry kind="src" path="src"/>
<classpathentry kind="src" path="gen"/>
<classpathentry kind="con" path="com.android.ide.eclipse.adt.ANDROID_FRAMEWORK"/>
<classpathentry kind="output" path="bin"/>
</classpath> 
```

如果它不起作用，则意味着您尝试包含的库与 Android 不兼容。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-02-27T01:24:18.310

如果您*包含*核心类，则此错误是不言自明的。如果你不是（搜索你的代码，只是为了确保）那么我只在使用 Eclipse 时不时看到这个错误，当 Android“库”被意外添加到 Eclipse 构建路径中时。

我不知道它是如何进入那种状态的，但它现在已经发生在我身上两次了。要解决它，您需要修复 Nicolas 指出的 .classpath 文件。另一种方法是编辑“Java 构建路径”（右键单击项目并选择属性）并删除您的 Android* 库（如果有多个将它们全部删除）。

这将导致项目无法编译并出现许多错误，但是，一旦你确定你已经摆脱了所有的库，你可以再次右键单击项目并选择“Android工具”->“修复项目属性”和Android.jar 的正确（单一副本）将被添加回来，并且从那里开始一切正常。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-02-09T22:58:54.367

在将 Android 项目复制粘贴到同一个工作区后，我得到了这个。之后从磁盘中删除它是不够的，因为 Eclipse 仍然隐藏了一些对它的引用。我还必须删除工作区文件夹下的以下文件夹：

> .metadata\.plugins\org.eclipse.core.resources.projects[NameOfTheDuplicateProject]

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2010-01-11T16:48:55.663

> 我不包括核心类或构建核心库或任何其他内容。

是的，你是：

> 处理“javax/xml/XMLConstants.class”时出现问题

java.* 和 javax.* 都算。如果您只想在测试应用程序中忽略它，您可以使用 --core-library 开关，但请注意警告：“您的应用程序在某些时候仍将无法构建或运行。请为那些发现的愤怒客户做好准备，例如，一旦他们升级操作系统，您的应用程序就会停止运行。这个问题将由您负责。”

正如它所说，对于运输应用程序，正确的解决方法是重新打包这些类（即将它们移动到新目录，相应地编辑它们的“包”行，并更新调用者中的“导入”行）。

# java - 我怎样才能获得未来 不使用 ExecutorService？

> ID：839440
> 
> 赞同：17
> 
> 时间：2009-05-08T11:41:48.800
> 
> 标签：java, multithreading

我真的很想做这样的事情：

```
 Callable<MyObject> myCallable = ....
 Future<MyObject> = new Thread( myCallable).start(); 
```

我基本上想启动一个与我的主要任务并行运行的长时间运行的任务，并且我不希望池化或线程重用。Executors 的东西似乎非常面向池，它需要我关闭池，所有这些我都不想做。

我*想*使用“Callable/Future”模式，因为我以后可能不得不介绍 Executors，但就目前的情况而言，它们只是开销。

有什么建议么 ？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-05-08T11:54:57.410

尝试未来任务。它对 Executor 框架没有任何显式依赖，可以按原样实例化，或者您可以对其进行扩展以自定义它。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-05-08T11:48:01.343

好吧，您可以相当容易地编写一个辅助方法：

```
public static Future<T> createFuture(Callable<T> callable)
{
    ExecutorService service = Executors.newSingleThreadExecutor();
    Future<T> ret = service.submit(callable);
    // Let the thread die when the callable has finished
    service.shutdown();
    return ret;
} 
```

编辑：要扩展[alphazero 的答案](https://stackoverflow.com/questions/839440/how-can-i-get-a-futuremyobject-without-using-executorservice/839467#839467)，您可以这样使用`FutureTask`：

```
FutureTask<MyObject> future = new FutureTask<MyObject>(myCallable);
new Thread(future).start(); // FutureTask implements Runnable
// Now use the future however you want 
```

是的，我会说这比我的第一个答案更好:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-08T12:01:29.890

可调用/未来的东西基于线程池。如果您需要多次执行相同的操作，我强烈建议您使用池。

如果您不想使用线程池，那么我建议您手动使用线程。通过使用单个线程并加入它来做你想做的事情并不难。

```
class X extends Thread {
   MyObject result;

   public void run() {
      // .. do the operation here. Set result
   }

   public MyObject getResult() {
      // This will block until the thread is complete
      join();
      return result;
   }
} 
```

要运行此调用：

```
X x = new X();
x.start(); 
```

最终你会调用 getResult ，它会阻塞直到 X 的线程完成：

```
x.getResult(); 
```

# c++ - 汇总来自多个捐助者的捐款

> ID：839455
> 
> 赞同：1
> 
> 时间：2009-05-08T11:49:29.403
> 
> 标签：c++, generics, stl

当我尝试使我的 C++ 技能现代化时，我不断遇到这种情况，“STL 方式”对我来说并不明显。

我有一个对象想要将来自多个来源的贡献收集到一个容器中（通常是一个`std::vector`）。每个源都是一个对象，每个对象都提供一个方法，该方法`get_contributions()`返回任意数量的贡献（从 0 到许多）。收集者将调用`get_contributions()`每个贡献者并将结果汇​​总到一个集合中。

问题是，最好的签名是`get_contributions()`什么？

选项1： `std::vector<contribution> get_contributions() const`

这是最直接的，但它会导致大量复制，因为收集器将每组结果复制到主集合中。是的，性能在这里很重要。例如，如果贡献者是几何模型并且获得贡献相当于将它们镶嵌成三角形进行渲染，那么速度将很重要，贡献的数量可能是巨大的。

选项 2： `template <typename container> void get_contributions(container &target) const`

这允许每个贡献者通过调用将其贡献直接添加到主容器`target.push_back(foo)`。这里的缺点是我们将容器暴露给其他类型的检查和操作。我宁愿保持界面尽可能窄。

选项 3： `template <typename out_it> void get_contributions(out_it &it) const`

在这个解决方案中，聚合器将`std::back_insert_iterator`为主集合传递 a，而单个贡献者将为`*it++ = foo;`每个贡献做。这是迄今为止我想出的最好的方法，但我觉得必须有一种更优雅的方式。`back_insert_iterator`感觉就像一个kludge 。

选项 3 是最好的，还是有更好的方法？这种聚集模式有名字吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-08T11:52:53.857

还有第四个，这需要您定义迭代器范围。查看 Alexandrescu 关于[“迭代器必须走”](http://www.boostcon.com/site-media/var/sphene/sphwiki/attachment/2009/05/08/iterators-must-go.pdf)的演讲。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T12:19:18.317

选项3是最惯用的方式。请注意，您不必使用 back_insert_iterator。如果您知道要添加多少元素，则可以调整向量的大小，然后提供一个常规向量迭代器。它不会调用 push_back （并可能为您节省一些复制）

`back_insert_iterator`的主要优点是它可以根据需要扩展向量。

不过，这不是杂牌。它专为此目的而设计。

一个小的调整是按值传递迭代器，然后在函数返回时返回它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T12:13:08.160

我想说有两种惯用的 STL 方式：您的选项 3（采用输出迭代器，顺便说一下，您将按值传递）和采用您将随每个贡献调用的仿函数。

当然，这些中的每一个都只有在适合将 get_contributions 实现为模板时才合适。

# sql - 如何在 SQL 中从 UDF 转换数据表？

> ID：839456
> 
> 赞同：0
> 
> 时间：2009-05-08T11:49:48.000
> 
> 标签：sql, sql-server, sql-server-2005, tsql

此代码给我错误：
**消息 156，级别 15，状态 1，过程 DefaultActivity，第 2 行关键字“返回”附近的语法不正确。消息 137，级别 15，状态 2，过程 DefaultActivity，第 3 行 必须声明标量变量“@returnTable”。消息 1087，级别 15，状态 2，过程 DefaultActivity，第 18 行必须声明表变量“@returnTable”。**

```
CREATE FUNCTION dbo.DefaultActivity
RETURNS
    @returnTable table (
[VisitingCount] int,
[Time] nvarchar(50)
)

AS
BEGIN

DECLARE @DateNow DATETIME,@i int
set @DateNow='00:00'
set @i=1;

    while(@i<1440)
        begin
            set @DateNow=DATEADD(minute, 1, @DateNow)
                insert into @returnTable ([VisitingCount], [Time]) values(0, right(left(convert(nvarchar, @DateNow, 121), 16), 5))
            set @i=@i+1
        end

    RETURN
END 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-08T11:57:09.650

尝试指定一个空的参数列表？

```
CREATE FUNCTION dbo.DefaultActivity()
RETURNS
... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T11:52:04.873

我想应该是

```
CREATE FUNCTION dbo.DefaultActivity()
RETURNS                    -- RETURN vs RETURNS here 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T11:58:04.610

这应该有效：

```
CREATE FUNCTION dbo.DefaultActivity ()
RETURNS @returnTable 
TABLE 
(
  [VisitingCount] int,
  [Time] nvarchar(50)
) 
AS
BEGIN
    DECLARE @DateNow DATETIME,@i int

    set @DateNow='00:00'
    set @i=1;

    while(@i<1440)
        begin
                set @DateNow=DATEADD(minute, 1, @DateNow)
                insert into @returnTable ([VisitingCount], [Time]) 
                values(0, right(left(convert(nvarchar, @DateNow, 121), 16), 5))
                set @i=@i+1
        end

    RETURN
END

GO

select * from dbo.DefaultActivity() 
```

# crystal-reports - 水晶：TOC加点

> ID：839457
> 
> 赞同：0
> 
> 时间：2009-05-08T11:49:56.767
> 
> 标签：crystal-reports, tableofcontents

我尝试在 Crystal Reports 中的页面标题和页码之间添加点以作为目录。我在网上找到了[http://www.tek-tips.com/viewthread.cfm?qid=1545153&page=1](http://www.tek-tips.com/viewthread.cfm?qid=1545153&page=1)，但我想知道是否有更简单直接的方法来获得相同的结果。

我在 VS 2008 中使用 CR 运输。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-13T14:40:33.017

您可以在页面标题和页码字段后面画一条虚线，将这些字段放在前面，并将它们的背景设置为白色。这不是您要寻找的时期，但与其他方法相比，它的巴洛克风格要少一些。

# excel - Excel：如何将多张纸的数据合二为一？

> ID：839460
> 
> 赞同：2
> 
> 时间：2009-05-08T11:51:42.550
> 
> 标签：excel

我编写了一个脚本，它创建了一个复杂的 Excel 表，其中包含来自多个数据源的数据。每张纸上的数据通常为 1-5 行。如果我可以创建另一个表格来在线显示其他表格中的数据，那就太好了（即概览表格应该随着我更改数据表格而改变）。我还需要用各种样式格式化数据，并让概览表复制它们。最后，数据表具有不同的列宽。

我在想我可以简单地导入工作表。当我将每张工作表保存到一个文件中，然后将它们作为 OLE 对象导入时，这很有效。难道没有办法只用一个文件来达到同样的效果吗？

我需要告诉 Excel“在 Sheet1 上的 Sheet2 上绘制 A1:F3 到单元格 A1 中”。

“插入对象”让我可以创建 Word 文档或 PP 演示文稿并将其放入单元格中，但我无法创建新的 Excel 工作表并将其放入单元格中。是什么赋予了？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-09-25T15:49:01.770

您可以使用相机对象。

1.  在封面上复制您想要的范围
2.  转到封面
3.  按住 shift 并单击*编辑*菜单
4.  单击*粘贴图片链接*菜单项

这将粘贴一个动态图片对象，只要数据表上的相应区域发生更改，该对象就会更新。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-08T12:08:09.560

如果您想自己构建解决方案，请尝试： http:
[//poi.apache.org/](http://poi.apache.org/)
Apache POI - 访问 Microsoft 格式文件的 Java API 它真的很容易使用...您可以轻松地格式化数据等...

我使用 POI 和 Apache Digester ( [http://commons.apache.org/digester/](http://commons.apache.org/digester/) )
从 XML 文件中读取数据并创建 Excel 表格。

[编辑] 使用这种方法，您可以读取现有的 Excel 工作表，复制工作表之间的相关单元格（包括格式）。但是，这并不能解决“不同的列宽”和“在线更新”。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-08T12:10:42.830

您可以使用以下语法引用其他工作表：

```
SheetName!Cell 
```

所以在 Sheet1, A1 中的公式为

```
=Sheet2!B4 
```

将在 B4 处实时引用 sheet2 中的值

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-09-25T15:24:01.937

复制范围。移动到要保存引用的单元格。在选择编辑菜单时按住 Shift 键。注意有新的菜单项；“粘贴图片”和“粘贴图片链接”。您要选择“粘贴图片链接”。现在，每当更新“源”或格式更改时，“目标”都会更新。

```
Sub DemoIt()

    'open excel and vbe windows side-by-side
    '   to see results when break points hit

    'setup values
    Range("A1").Select
    ActiveCell.FormulaR1C1 = "A"
    Range("A2").Select
    ActiveCell.FormulaR1C1 = "B"
    Range("A3").Select
    ActiveCell.FormulaR1C1 = "C"

    'select "source" values and copy
    Range("A1:A3").Select
    Selection.Copy

    'move to "destination"
    Range("B1").Select

    'paste the "picture link"
    ActiveSheet.Pictures.Paste(Link:=True).Select
    Application.CutCopyMode = False

    'check out results
    Stop

    'change values
    Range("A2").Select
    ActiveCell.FormulaR1C1 = "99"

    'notice "destination" changed
    Stop

    'change formatting
    Range("A3").Select
    Selection.Font.Size = 20

    'notice formatting changed
    Stop

End Sub 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-08T11:58:02.270

一个 Excel 工作簿可以包含多个工作表。一个工作表中的公式可以引用同一工作簿中另一工作表中的单元格。

# c# - 将大量数据加载到数据网格中的最佳方法

> ID：839465
> 
> 赞同：0
> 
> 时间：2009-05-08T11:53:26.243
> 
> 标签：c#, .net, datagridview

我正在尝试将大量数据加载到数据网格中，正如您所期望的那样需要很长时间才能加载。这是因为我正在从一个 COM 对象加载数据，我已经使用自定义枚举器将其包装到 .NET 对象中。

我研究了虚拟加载数据网格，它工作正常，但我想知道是否有更好的方法来做同样的事情。

我所追求的是一个显示全部数据量的滚动条的数据网格，但只加载前 50 行的数据，然后在滚动后加载接下来的 50 行左右。

有谁知道这是否可能，或者是否有可用的控件自动执行此操作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-08T13:19:42.680

是否可以仅从 COM 对象加载部分数据？如果是这样，加载例如 100 行，并保存行数。然后在网格的滚动事件中，使用 FirstDisplayedScrollingRowIndex 属性查看是否接近 100，并加载更多行，并增加行数。

但是，这不会显示所有可加载行的滚动条。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-05-08T11:58:20.117

查看[Telerik](http://www.telerik.com)数据网格控件。

# c++ - 查找不匹配的大括号/预处理器指令的提示和工具

> ID：839468
> 
> 赞同：16
> 
> 时间：2009-05-08T11:55:09.733
> 
> 标签：c++, c

这是我最害怕的 C/C++ 编译器错误之一：

> file.cpp(3124) : 致命错误 C1004: 发现意外的文件结尾

file.cpp 包含近百个头文件，而这些头文件又包含其他头文件。超过3000行。代码应该模块化和结构化，源文件更小。我们应该重构它。作为一名程序员，总是有一个改进事物的愿望清单。

但现在，代码一团糟，最后期限也快到了。*在所有这些行中的某个地方*——很可能在一个包含的头文件中，而不是在源文件本身中——显然有一个不匹配的大括号、不匹配的 #ifdef 或类似的。问题是，当缺少某些东西时，编译器无法真正告诉我它*在哪里*丢失。它只知道当它到达文件末尾时，它没有处于正确的解析器状态。

您能否提供一些工具或其他提示/方法来帮助我找到错误的原因？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-08T12:14:18.597

如果#includes 都在源文件中的一个位置，您可以尝试在#includes 之间放置一个杂散的右大括号。如果您在编译时遇到“不匹配的右大括号”错误，那么您知道这一切都是平衡的。这是一种缓慢的方法，但它可能会帮助您查明问题。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-08T12:26:12.093

一种方法：如果你有Notepad++，打开所有文件（打开100个文件没问题），搜索{和}（搜索->查找->在所有打开的文档中查找），注意计数的差异（应该是1） . 随机关闭 10 个文件，看看计数的差异是否仍然为 1，如果是则继续，否则问题出在其中一个文件中。重复。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-08T12:41:26.457

实用提示：

对于每个头文件，自动生成一个包含它的源文件，然后可选地包含一个空的 main 方法，并且什么都不做。将所有这些文件编译为测试用例，尽管运行它们没有意义。

假设每个标头都包含自己的依赖项（这是一个很大的“提供”），这应该让您更好地了解哪个标头导致了问题。

这个技巧改编自 Google 发布的 C++ 样式指南，该指南说每个组件的源文件都应该在任何其他标题之前包含该组件的接口标题。这具有相同的效果，即确保至少有一个源文件无法编译，并暗示该头文件（如果有任何问题）。

当然它不会在宏中捕获不匹配的大括号，因此如果您以宏的方式使用太多，您可能不得不求助于在源文件上运行预处理器，并手动和 IDE 检查结果。

另一个方便的提示，现在为时已晚：

更频繁地签入（在私人分支上，以防止其他人看到未完成的代码）。这样，当事情变得糟糕时，您可以与最后编译的内容进行比较，并专注于更改的行。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-08T12:02:53.380

提示：

*   进行小改动并在每次小改动后重新编译
*   对于不匹配的大括号，使用支持大括号匹配高亮的编辑器/IDE
*   如果所有其他方法都失败了，Ye Olde 使用二进制印章方法注释掉代码块的方法对我有用

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-08T11:57:45.110

我认为使用一些带有大括号突出显示的编辑器会有所帮助。还应该有一些工具可以自动缩进代码。

编辑：这个[vim 脚本](http://www.vim.org/scripts/script.php?script_id=7)有帮助吗？它似乎做了#ifdef 突出显示。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-08T12:21:54.770

你能创建一个脚本来执行所有的操作，然后把所有的东西都写到一个临时文件中吗？或者尝试编译器来帮助你？然后您可以使用各种编辑器的括号突出显示功能来查找问题，并且您可能能够识别文件。（额外的帮助可以是让您的脚本在每个包含的文件周围添加注释）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-02-14T14:27:42.133

这可能与您的问题无关，但在 #if/#else/#endif 块中构建一些头文件时出现“意外的 #else”错误。

我发现如果我将问题模块设置为不使用预编译头文件，问题就消失了。与“#pragma hdrstop”有关的内容不应包含在#if/#endif 中。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-08-10T16:11:21.043

派对很晚，但在 linux 上你可以使用`fgrep -o`

> ```
>  -o, --only-matching
>           Print only the matched (non-empty) parts of a matching line,
>           with each such part on a separate output line. 
> ```

因此，如果您`fgrep -o {`这样做，您将获得文件中所有左大括号的列表。

然后，您可以将其通过管道传递`wc -l`给您，这将为您提供文件中左大括号的数量。

With a bit of bash arithmetic, you can do the same with closing braces, and then print the difference.

In the below example I'm using `git status -s` to get the `short-format` output of all modified files from my git repo, and then I'm iterating over them to find which files may have mismatched braces

```
for i in $(git status -s | awk '{print $2}'); do 
    open=$(fgrep -o { $i | wc -l);   # count number of opening braces
    close=$(fgrep -o } $i | wc -l);  # count number of closing braces 
    diff=$((open-close));            # find difference
    echo "$diff : $i";               # print difference for filename
done 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-08T12:05:39.350

看看这个[问题](https://stackoverflow.com/questions/542929/highlighting-unmatched-brackets-in-vim)（在 vim 中突出显示不匹配的括号）

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-08T12:24:49.070

首先预编译您的代码，这将创建一个大块，其中包含文件填充到同一个文件中。然后你可以使用那些大括号匹配脚本。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-01-17T12:15:43.483

我最近在重构一些代码时遇到了这种情况，我不喜欢上面的任何答案。问题是他们忽略了一个非常基本的假设：

任何给定的文件（很可能）都会有匹配的大括号和 if/endif 宏。

* * *

虽然确实可以有一个 C++ 源文件，它打开一个括号或一个 if 块并包含另一个关闭它的模块，但我在实践中从未见过这种情况。类似于以下内容：

foo.cpp

```
namespace Blah{
#include "bar.h" 
```

酒吧.h：

```
}; /// namespace Blah 
```

* * *

因此，假设任何给定的文件/模块都包含匹配的大括号集和预处理器指令，这个问题现在很容易解决。我们只需要一个脚本来读取文件/计算它找到的括号和指令并报告不匹配。

我在这里用 Ruby 实现了一个，请随意采用并适应您的需求：

[https://gist.github.com/movitto/6c6d187f7a350c2d71480834892552ab](https://gist.github.com/movitto/6c6d187f7a350c2d71480834892552ab)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2017-04-12T05:21:33.803

我刚刚花了一个小时来解决这样的问题。很难发现，但最后，我在一行中输入了一个双 #：

`##ifdef FEATURE_X` ...

那打破了世界。

虽然很容易搜索。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2018-04-05T16:42:42.487

The simplest and fastest solution is to comment file from the end by consistent blocks. If the error still exists, then you not yet comment the open brace.

# sql - SQL笛卡尔连接问题

> ID：839472
> 
> 赞同：1
> 
> 时间：2009-05-08T11:56:02.227
> 
> 标签：sql, join, hierarchical-data, cartesian-product

我有三张桌子

*   A：A.pID 主键，A.Name nvarchar(250)
*   B：B.pID 主键，B.Name nvarchar(250)
*   C: C.pID 主键，C.Name nvarchar(250)

A 和 B 之间存在 am 到 n 关系（`lA_B`具有主键的表`lA_B.pID`和`.pInstanceA`表 A 的`.pInstanceB`外键和表 B 的外键）

A 和 C 之间存在 am 到 n 关系（表 A`table lA_C`的主键`lA_C.pID`和外键以及表 C 的外键）`.pInstanceA``.pInstanceB`

*   A1 与 B1、B2 和 C1 相关
*   A2 与 B3 和 C2、C3 相关
*   A3 与 B4 相关
*   A4 与 C4 相关
*   A5没有关系

这是我的 SQL：

```
CREATE TABLE [dbo].[A]( [pID] [bigint] NOT NULL, [Name] [nvarchar](250) NULL )
CREATE TABLE [dbo].[B]( [pID] [bigint] NOT NULL, [Name] [nvarchar](250) NULL )
CREATE TABLE [dbo].[C]( [pID] [bigint] NOT NULL, [Name] [nvarchar](250) NULL)
CREATE TABLE [dbo].[lA_B]( [pID] [bigint] NOT NULL, [pInstanceA] [bigint] NULL, [pInstanceB] [bigint] NULL )
CREATE TABLE [dbo].[lA_C]( [pID] [bigint] NOT NULL, [pInstanceA] [bigint] NULL, [pInstanceB] [bigint] NULL )

INSERT INTO [dbo].[A] ([pID] ,[Name]) VALUES (1,'A1')
INSERT INTO [dbo].[A] ([pID] ,[Name]) VALUES (2,'A2')
INSERT INTO [dbo].[A] ([pID] ,[Name]) VALUES (3,'A3')
INSERT INTO [dbo].[A] ([pID] ,[Name]) VALUES (4,'A4')
INSERT INTO [dbo].[A] ([pID] ,[Name]) VALUES (5,'A5')

INSERT INTO [dbo].[B] ([pID] ,[Name]) VALUES (1,'B1')
INSERT INTO [dbo].[B] ([pID] ,[Name]) VALUES (2,'B2')
INSERT INTO [dbo].[B] ([pID] ,[Name]) VALUES (3,'B3')
INSERT INTO [dbo].[B] ([pID] ,[Name]) VALUES (4,'B4')

INSERT INTO [dbo].[C] ([pID] ,[Name]) VALUES (1,'C1')
INSERT INTO [dbo].[C] ([pID] ,[Name]) VALUES (2,'C2')
INSERT INTO [dbo].[C] ([pID] ,[Name]) VALUES (3,'C3')
INSERT INTO [dbo].[C] ([pID] ,[Name]) VALUES (4,'C4')

INSERT INTO [dbo].[lA_B] ([pID],[pInstanceA],[pInstanceB])   VALUES   (1,1,1)
INSERT INTO [dbo].[lA_B] ([pID],[pInstanceA],[pInstanceB])   VALUES   (2,1,2)
INSERT INTO [dbo].[lA_B] ([pID],[pInstanceA],[pInstanceB])   VALUES   (3,2,3)
INSERT INTO [dbo].[lA_B] ([pID],[pInstanceA],[pInstanceB])   VALUES   (4,3,4)

INSERT INTO [dbo].[lA_C] ([pID],[pInstanceA],[pInstanceB])   VALUES   (1,1,1)
INSERT INTO [dbo].[lA_C] ([pID],[pInstanceA],[pInstanceB])   VALUES   (2,2,2)
INSERT INTO [dbo].[lA_C] ([pID],[pInstanceA],[pInstanceB])   VALUES   (3,2,3)
INSERT INTO [dbo].[lA_C] ([pID],[pInstanceA],[pInstanceB])   VALUES   (4,4,4) 
```

这个查询：

```
SELECT
  A.Name AS A, 
  B.Name AS B, 
  C.Name AS C
FROM
  A  
  left JOIN lA_B  ON (A.pID = lA_B.pInstanceA)
  left JOIN B     ON (B.pID = lA_B.pInstanceB)
  left JOIN lA_C  ON (A.pID = lA_C.pInstanceA)
  left JOIN C     ON (C.pID = lA_C.pInstanceB) 
```

返回

```
A1 B1 C1
A1 B2 C1
A2 B3 C2
A2 B3 C3
A3 B4 空
A4 空 C4
A5 空 空

```

现在的问题:-) 如何查询接收

```
A1 B1 空
A1 B2 空
A1 空 C1
A2 B3 空
A2 空 C2
A2 空 C3
A3 B4 空
A4 空 C4
A5 空 空

```

问题是，当我与 B 和 C 进行连接时，结果具有 B C 的所有组合。我怎样才能消除这个？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-08T12:02:50.620

您可以使用 UNION 来做到这一点：

```
SELECT A.Name AS A, B.Name AS B, NULL AS C 
FROM A
left JOIN lA_B ON (A.pID=lA_B.pInstanceA) 
left JOIN B ON (lA_B.pInstanceB=B.pID) 
UNION
SELECT A.Name AS A, NULL AS B, C.Name AS C 
FROM A
left JOIN lA_C ON (A.pID=lA_C.pInstanceA) 
left JOIN C ON (lA_C.pInstanceB=C.pID) 
```

第一部分选择 A 和 B 的所有组合，第二部分选择 A 和 C 的所有组合。

如果您希望过滤掉 (A4,NULL,NULL) 之类的行，因为已经有一行 (A4,NULL,C4)，请尝试以下查询：

```
SELECT A.Name AS A, B.Name AS B, NULL AS C 
FROM A
LEFT JOIN lA_B ON (A.pID=lA_B.pInstanceA) 
LEFT JOIN B ON (lA_B.pInstanceB=B.pID) 
WHERE b.name is not null 
    or not exists(select * from lA_C where A.pID=lA_C.pInstanceA) 
UNION
SELECT A.Name AS A, NULL AS B, C.Name AS C 
FROM A
LEFT JOIN lA_C ON (A.pID=lA_C.pInstanceA) 
LEFT JOIN C ON (lA_C.pInstanceB=C.pID)
WHERE c.name is not null 
ORDER BY A,B,C 
```

对于 B 上的连接，这表示包括在 B 中匹配或在 C 中没有匹配的行。C 上的连接仅包括在 C 中匹配的行。不匹配的行将从中包含B 上的连接。

请注意，UNION 会过滤掉重复的行，例如 DISTINCT。要包括每一行，您可以使用 UNION ALL。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T12:36:48.837

我认为这样做：

```
select a,
       case when b='zzz' then null else b end as b,
       case when c='zzz' then null else c end as c
from (SELECT  A.Name AS A
             ,b.Name as b
             ,'zzz' as c
      FROM  A    
      JOIN lA_B  ON (A.pID = lA_B.pInstanceA)  
      JOIN B     ON (B.pID = lA_B.pInstanceB)  
      union
      select  a.Name
             ,'zzz'
            ,c.NAme
      from A
      left JOIN lA_C  ON (A.pID = lA_C.pInstanceA)  
      left JOIN C     ON (C.pID = lA_C.pInstanceB)) as a 
```

# math - 带圆圈的加号是什么意思？

> ID：839479
> 
> 赞同：51
> 
> 时间：2009-05-08T11:58:20.100
> 
> 标签：math, cryptography, matrix

我无法理解“66 ⊕ fa = 9c”的计算。总和显然超过“ff”，所以我很困惑。题目是简单的加密算法。

**带圆圈的加号是什么意思？**

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2009-05-08T12:23:04.470

人们说这个符号并不意味着加法。这是真的，但没有解释为什么加号符号用于非加法的东西。

答案是对于 1 位值的模加法，0+0 == 1+1 == 0 和 0+1 == 1+0 == 1。这些值与 XOR 相同。

因此，在这种情况下，加圈表示“按位加法模 2”。正如大家所说，这就是整数的异或。在数学中很常见的是在一个圆圈中使用加号来进行一种加法运算，但不是常规的整数加法。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-05-08T12:02:03.103

这不是加号，而是二元运算符[XOR的符号](http://en.wikipedia.org/wiki/XOR)

```
a   b   a XOR b
0   0   0
0   1   1
1   0   1
1   1   0 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-08T12:01:21.373

这不是加法，而是异或运算。至少输出确认相同。

[![在此处输入图像描述](https://i.stack.imgur.com/cyBSX.gif)](https://i.stack.imgur.com/cyBSX.gif)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-05-08T12:04:47.433

那是 XOR 运算符，而不是 PLUS 运算符

XOR 一点一点地工作，而不像 PLUS 那样结转

```
1 XOR 1 = 0
1 XOR 0 = 1
0 XOR 0 = 0
0 XOR 1 = 1 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-05-08T12:32:26.680

希望这个布局有效，用[**XOR**](http://en.wikipedia.org/wiki/Exclusive_or)把它变成二进制表示：

```
66h = 102 decimal = 01100110 binary
FAh = 250 decimal = 11111010 binary
------------------------------------
                    10011100 binary <------ that's 9Ch/156 decimal 
```

*   1 异或 1 = 0 假
*   1 异或 0 = 1 真
*   0 异或 0 = 0 假

但是如果需要，我之前链接的 wiki 会为您提供更多详细信息……这就是他们在您提供的屏幕截图中所做的事情

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-05-08T12:01:32.057

圆圈中的加号不表示加法。这是一个异或运算。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-05-08T12:26:32.090

这是一个异或（XOR）。如果我没记错的话，在进行按位数学运算时，点 (.) 表示 AND，加号 (+) 表示 OR。在加号周围画一个圆圈表示 XOR 与用于 OR 的样式一致。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-08T12:26:38.237

我使用了 rampion 和 schnaader 的回复中的逻辑。我将总结我是如何确认结果的。我将数字更改为二进制，然后使用 XOR 操作。或者，您可以使用十六进制表：[单击此处！](http://www.garykessler.net/library/byte_logic_table.html)

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2011-07-20T14:14:31.503

它是异或。XOR 函数的另一个名称是无进位加法。我想这就是符号可能有意义的方式。

# javascript - 使用 JavaScript 进行特殊字符验证

> ID：839483
> 
> 赞同：2
> 
> 时间：2009-05-08T11:59:42.763
> 
> 标签：javascript, validation, special-characters

特殊字符 `<`, `>`, `%`, `''`, `""`,`$`和`^`不允许出现在文本框中。我需要进行验证检查以在提交时限制这些字符以及空检查。

我在一个函数中编写了整个验证代码，并在单击提交按钮时调用它，但单击时无法识别该函数。

请帮我写一些 JavaScript 代码来实现这个功能。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2010-09-21T18:24:47.683

一个更简单的方法是在 javascript 中使用 indexOf，

```
function isSpclChar(){
   var iChars = "!@#$%^&*()+=-[]\\\';,./{}|\":<>?";
   if(document.qfrm.q.value.indexOf(iChars) != -1) {
     alert ("The box has special characters. \nThese are not allowed.\n");
     return false;
   }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-11-16T09:14:34.767

```
function isSpclChar(){
var iChars = "!@#$%^&*()+=-[]\\\';,./{}|\":<>?";
for (var i = 0; i < document.qfrm.q.value.length; i++) {
    if (iChars.indexOf(document.qfrm.q.value.charAt(i)) != -1) {
    alert ("The box has special characters. \nThese are not allowed.\n");
    return false;
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-10-08T10:18:05.317

尝试这个：

```
$('#text').keypress(function (e) {
    validationForSpecialchar(e); 		        
});

function validationForSpecialchar(e){
    var regex = new RegExp("^[a-zA-Z0-9-]+$"); 
    var str = String.fromCharCode(!e.charCode ? e.which : e.charCode);
    if (regex.test(str)) {
        return true;
    }
    e.preventDefault();
    return false;
}
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
Enter something here : <input id="text">
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-16T06:07:14.793

```
function alphanumeric_only(event)
 {
    var keycode;

   keycode=event.keyCode?event.keyCode:event.which;

   if ((keycode == 32) || (keycode >= 47 && keycode <= 57) || (keycode >= 65 && keycode <= 90) || (keycode >= 97 && keycode <= 122)) {

        return true;

    }

    else {
        alert("Sorry You can not insert Special Character");
        return false;

    }
    return true;

} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-08T12:08:06.380

尝试类似的东西

```
<form ... onsubmit="function()"> 
```

在函数中，您可以从 textarea 或您正在使用的内容中获取文本。如果数据有效，函数 () 应该返回 true。否则不会提交表单。

# jquery - 为什么 jQuery 的事件处理程序不能处理更改的 DOM 元素？

> ID：839484
> 
> 赞同：2
> 
> 时间：2009-05-08T12:00:06.070
> 
> 标签：jquery, ajax

在我的应用程序中，我有一个下拉表单，它会触发 AJAX 请求 onchange 并返回选定的用户名值，旁边有一个“删除”图像。

```
<div id="el">User Name <img src="ico/del.gif" onclick="ajax_delete(12)" class="del" /></div> 
```

奇怪的是，如果页面是第一次加载，以下 jQuery 代码会正确执行，并且鼠标指针会在所有 .del 图像上发生变化：

```
$("img.del").css('cursor', 'pointer'); 
```

但是，如果上面的 html 代码是由 AJAX 请求添加的，如下所示：

```
$("#el").html('User Name <img src="ico/del.gif" onclick="ajax_delete(12)" class="del" />'); 
```

鼠标指针更改不适用于 AJAX 请求添加的图像。

任何线索为什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-08T12:03:43.143

在您运行 css 函数时该元素不存在。将 css 函数附加到 DOM 后，您必须运行它。

[从实时文档中：](http://docs.jquery.com/Events/live)

> **.live 不支持 liveQuery 提供的无事件样式回调。只有事件处理程序可以与 .live 绑定。**

您需要使用[liveQuery 插件](http://plugins.jquery.com/project/livequery)来完成此操作。

从那里开始很简单：

```
$('#el').livequery(function() {
  $(this).css('background', 'green');
}); 
```

请注意，liveQuery 也可以通过使用第二个参数来触发已删除或不再匹配的元素（例如，如果您基于值比较进行匹配）：

> unmatchedFn 在元素更改并且不再匹配或从 DOM 中删除时触发。

*好的。*

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-08T12:04:22.270

**$("img.del") 返回当前文档**中所有图像的选择集，其 ClassName 等于 del。在调用该命令之后插入一个新元素。因此，您将需要使用[现场活动](http://docs.jquery.com/Events/live)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-08T12:01:40.450

您需要使用现场活动。

[http://docs.jquery.com/Events/live](http://docs.jquery.com/Events/live)

当您使用普通方法绑定事件时，它们仅绑定到现有项目。之后在 DOM 上创建的任何项目都不会受到影响。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-08T12:02:34.067

也许 live() 处理程序会帮助你。在文档中阅读它。

# iphone - 用于 AES 加密的 iPhone 中有哪些不同的填充模式和密码模式？

> ID：839499
> 
> 赞同：4
> 
> 时间：2009-05-08T12:04:02.490
> 
> 标签：iphone, encryption

用于 AES 加密的 iPhone 中有哪些不同的填充模式和密码模式？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-07-30T04:52:55.337

有两种填充模式——PKCS #7 和无——以及两种相应的密码模式——CBC 和 ECB。如果您指定`kCCOptionPKCS7Padding`，那么您将获得 CBC，如果您指定`kCCOptionECBMode`，则没有填充，您将获得 ECB。根据[CommonCrypto 标头](http://www.opensource.apple.com/source/CommonCrypto/CommonCrypto-32207/CommonCrypto/CommonCryptor.h)，默认值为 CBC 。

# java - Vim Java 代码完成？

> ID：839514
> 
> 赞同：7
> 
> 时间：2009-05-08T12:11:01.240
> 
> 标签：java, vim

在 vim 中是否有与 java 的 OmniCppComplete 等效的东西？我知道 eclim，但我认为对于这样一个简单的功能来说太过分了。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-08T12:27:16.677

见[http://www.vim.org/scripts/script.php?script_id=1785](http://www.vim.org/scripts/script.php?script_id=1785)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-08T14:35:13.903

还发现了 VJDE - [http://www.vim.org/scripts/script.php?script_id=1213](http://www.vim.org/scripts/script.php?script_id=1213) - 需要评估哪个更好/更新

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-08T15:04:49.467

似乎您对上面的代码完成有一些选择。

我还建议您获取[TagList](http://www.vim.org/scripts/script.php?script_id=273)的副本，它提供了一个显示当前文件结构的侧边栏。

TagList 使用的 ctags 也可以用于 Vim 中的快速导航。Ctrl+] 在文本“curiousMethod()”上应该带你到该方法的定义。

# design-patterns - REST 是否适合大型 3NF 模型

> ID：839517
> 
> 赞同：6
> 
> 时间：2009-05-08T12:12:23.467
> 
> 标签：design-patterns, rest

有许多将 REST 与简单数据模型结合使用的示例。例如，具有 5 个属性的客户和具有 6 个属性的订单集合。但是，我很难针对更复杂的模型使用 REST 进行可视化——您可能会在政府采购、财务、医疗记录管理等领域找到这种模型。是否有将 REST 用作大型 LOB 环境的主要 API 的示例。

也许我对 REST 方法的要求太多了？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-11T12:10:30.980

我正在构建一个目前拥有 250 多个资源的 REST 接口。到我完成时，我预计会有超过 1000 个。这是一个 ERP 应用程序，涵盖会计、库存、销售、劳动力成本计算、工程等。

单个资源的大小或复杂性与 REST 没有直接关系，而更多地与媒体类型有关。我选择了定义自己的媒体类型的路线，因为我也在构建客户端，并且界面不是供公众使用的。为您的情况选择最佳媒体类型可能是设计 REST 接口最困难的部分之一。

不幸的是，大多数人似乎都在选择媒体/类型决定并选择通用应用程序/json 或应用程序/xml，然后在浏览器中使用下载的 javascript 来解释格式。 [1] 只要您拥有的唯一客户端是浏览器并且您不希望其他任何人重复使用您的界面，它就可以工作。对我来说，这似乎违背了 REST 的主要目标之一，即由于松散耦合和标准化格式而导致的偶然重用。

为了进一步解释我的意思，请考虑将 application/json 或 application/xml 交付给客户端应用程序的情况。一旦客户端应用程序进入该通用格式并获取特定数据，您就在客户端和服务器之间创建隐藏的耦合。相反，如果您使用媒体格式“application/vnd.mycompany.myformat+xml”，您将明确定义与客户端的合同。当您更改格式并且可以选择创建“application/vnd.mycompany.myformatV2+xml”时，这具有巨大的优势

人们认为 REST 是一个松散指定的接口，但实际上并非如此。REST 接口在它返回和期望接收的精确媒体类型中应该非常明确。媒体类型是合同。如果您收到 application/xml 并使用客户端代码提取 /Customer/Name 您违反了合同。

使用下载的 javascript 的 Web 应用程序可以使用“application/xml”，因为合同的详细信息没有编译到客户端中。但是，客户端的行为极其受限于执行 javascript 已预编程的任何操作。不幸的是，大多数公共 RESTful 接口忽略了这个约束，人们构建了与未指定合约紧密耦合的客户端。这就是为什么当 Twitter 改变其格式时，许多客户端都会崩溃。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-08T12:22:17.843

REST 是一种架构风格，而不是数据的表示。今天，数据通常以 XML 或 JSON 表示，它们已经过实战测试，可以轻松支持您所指的大型复杂模型。

在最基本的形式中，REST 只是控制“资源”的 HTTP 动词。该资源的表示可以根据您的需要简单或复杂。CRUD 和列表操作是最直接的。此外，还可以在此上下文中轻松生成更复杂的 API。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T12:21:37.360

只要有合理的描述性路径来描述您希望访问的数据，REST 就适用。

当您尝试完成的是发布 API 时，REST 感觉不像 RESTful，但是，我会注意到使用 REST 哲学开发的 API 非常成功。

根据您的描述，您正在处理数据，无论结构多么复杂，它都应该很好地遵守 REST。REST 不禁止发布模式，因此您可能也需要考虑这一点。

# dotnetnuke - 在 DNN 中创建子菜单标题

> ID：839523
> 
> 赞同：0
> 
> 时间：2009-05-08T12:15:55.237
> 
> 标签：dotnetnuke, skinning

我正在创建一个客户 DotNetNuke(DNN) 皮肤 - 我想做的一件事是有子菜单分组。

例如：

*   **生活**

*   到处走走
*   房价
*   学校信息

在哪里：

*   生活是主菜单项
*   LIVING IN WIDGETVILLE 只是子菜单项的描述或组。我可以在这些下方有其他分组，但垂直突出而不是嵌套组描述。
*   组描述下面的每个项目符号项都是实际的菜单链接。

关于如何实现这一目标的任何想法？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T03:11:17.827

有一些菜单模块可以为您做到这一点，您可能会在 Snowcovered.com 上查看 - 您也可以只编写一个小菜单来为您执行此操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-12-17T06:36:07.157

考虑后的另一个选择是添加额外的禁用页面，这些页面是站点之一-不确定您要实现的目标，但该划分确实不是菜单的一部分，而是站点的结构

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-09-02T05:50:10.043

我通过将以下内容添加到我的 ASCX 皮肤文件中来实现这一点 -

```
<%=PortalSettings.ActiveTab.BreadCrumbs(0).TabName%> 
```

# sql-server - 在 SQL Server Analysis Services 中处理大型结果集

> ID：839526
> 
> 赞同：1
> 
> 时间：2009-05-08T12:16:42.973
> 
> 标签：sql-server, performance, ssas, olap, cubes

我有一个数据库，其中包含有关**文章**、**结构**和**制造商**的数据。这意味着一篇文章链接到 1 个制造商和 N 个结构节点（认为是文章分类节点）。

在很多条件下使用 T-SQL 查询文章目前太慢而无法用于电子商店，即使硬件良好且索引表正确。（应低于 1 秒）。现在我想知道通过 OLAP Cube 访问这些数据是否有意义。我已经开发了一个来获取聚合，例如：在节点 Y 下***递归****存在多少制造商 X 的文章？*

 **这些聚合非常快，现在我想知道通过多维数据集检索整个文章结果集是否有意义。含义：*给我递归地存在于节点 Y 下的制造商 X 的**每***一篇文章 ID 。因为结果集可能非常大，查询需要更长的时间..

因此我的问题是，有没有办法处理 SSAS 中的大型结果集，或者这完全是我采取的错误方向？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T12:22:53.737

您绝对可以通过利用聚合来处理大量数据并使其在 SSAS 中表现良好。当然，如果您要通过网络传输，仍然需要移动大量数据，因此请记住这一点。您的查询将很快返回；结果需要一段时间才能转移。

SSAS 的真正强大之处在于能够在您的方法中成为目标。我们可以从高层次开始，向下钻取，找到我们想要的层次，然后继续向下钻取，向下钻取，直到你得到你真正想要的数据，而不是说“把一切都给我”。

# c++ - 如何向我的应用程序添加搜索功能

> ID：839530
> 
> 赞同：2
> 
> 时间：2009-05-08T12:18:57.540
> 
> 标签：c++, windows, indexing, full-text-search, information-retrieval

我正在编写存储大量文本文件的 Windows 应用程序（使用 Borland C++ Builder）。我希望用户能够非常快速地搜索这些文件，所以我需要一个索引和搜索库。我不使用数据库，而是使用我自己的文件格式来存储文档（所有文件都在一个文件中）。

Windows 有这样的库吗？它应该根据请求将文档添加/删除到索引中，并查找类似于 Google 查询的文档（“car house -payment”）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-08T12:21:18.047

[CLucene](http://clucene.wiki.sourceforge.net/)是 lucene (java) 库的 C-Port。我只使用了原始的 java 版本，但 lucene 能够满足您的要求。

# testing - 使用构建脚本和持续集成的原因是什么？

> ID：839541
> 
> 赞同：4
> 
> 时间：2009-05-08T12:22:40.027
> 
> 标签：testing, msbuild, continuous-integration

我试图通过构建脚本、夜间构建和持续集成等技术来掌握这个想法，但我看不到它的优势。以此为例：

我们是一个开发应用程序的 4 人团队，没有单元测试。我们还使用 Subversion 进行源代码控制。

通过使用自定义构建脚本和持续集成之类的东西，我们可以获得什么好处？您是否“需要”为此进行单元测试？

我还可以提到我们在本地机器上开发，当代码工作时，我们只需更新生产服务器上的 svn checkout。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-08T12:24:48.600

如果您没有[持续集成](http://en.wikipedia.org/wiki/Continuous_integration)，您将需要等到有人决定进行集成构建以找出冲突或不一致的提交。集成构建是包含来自所有开发人员的更改的构建。如果每个开发人员都努力更新他们的本地工作副本，那么您可能无需定期集成构建就可以逃脱，但实际上，您为什么不自动化它呢？

测试套件还将帮助发现破坏事物但不一定导致集成构建失败的行为更改。

对新的集成构建执行[冒烟测试](http://en.wikipedia.org/wiki/Smoke_test#Smoke_testing_in_software_development)也是标准做法。

除了检测破坏事物的冲突和更改之外，每晚集成的构建意味着您将始终拥有一个包含每个人迄今为止的工作的最新构建。这是测试和演示目的的福音。

[为破坏夜间构建的人考虑适当的惩罚](https://stackoverflow.com/questions/211426/what-punishment-do-you-have-when-someone-on-the-team-breaks-the-build)也有一些乐趣——这意味着他们在没有检查它的情况下提交了一些东西，所以除了解决构建破坏提交之外，他们应该感到一些痛苦。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-08T12:25:42.950

好吧，首先，从已知环境中进行可重复的构建会很有用。如果您需要对特定版本进行小的更改（例如，即使您现在正在开发 3.2，客户也不愿意从 1.5 版迁移，但您可以在分支上应用 1.5 的补丁），这真的很有帮助轻松构建。

这也意味着一旦你*开始*编写单元测试，你就会从它们中获得更多的好处。

如果您目前没有任何构建脚本/服务器，您如何构建您发布的内容？只是在一个随机的开发者盒子上？

另请参阅[此相关问题的答案](https://stackoverflow.com/questions/610732)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-08T12:30:34.937

那么，您如何确保您的一位同事所做的更改不会破坏任何功能？您是否在每次签到后尝试并测试每一项功能？听起来对我来说浪费了很多时间，您可以通过实施单元测试来节省。

以及如何确保两个或多个单独的程序员所做的更改不会干扰下一个在干净机器上进行检查的人将无法构建软件？在计划发布之前，意识到这些问题的好时机很短。

许多这些技术背后的原因是提早失败，因此您可以查明并更改使您宝贵的软件停止正常工作的任何原因。

现在，您不需要持续集成的单元测试，但它们肯定是您构建过程的重大改进，您绝对应该考虑阅读并使用它们！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-08T12:30:45.140

使用 CruiseControl 和 CCTray 之类的东西会给你信心，你知道当那个小图标是绿色的时候，你可以获得最新的代码，它很可能与你的本地副本一起工作。

要从中获得最大的收益，您需要养成良好的习惯，在提交之前始终保持最新等。它不会停止冲突，甚至是破坏的构建，但它会让您充满信心地继续您的开发，因为知道有软件的工作版本。

使用自定义构建脚本，再次让您充满信心，因为您可以完成构建，然后运行单元测试、代码覆盖率、fxcop。这一切都增加了代码主体的质量。

与往常一样，需要时间和精力成本，但您很快就会在需要多少质量以一致地交付软件与您想要进行多少测试和代码分析之间取得平衡。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-08T12:35:01.027

拥有专用构建机器（将 CI、单元测试甚至自动化构建放在一边）的关键优势是确保您拥有一个**干净**、可预测和可重现的构建环境。

仅此一项就应该导致更稳定的产品发布。它可以帮助您在部署/发布后更早地发现解决方案和代码库的问题。一个常见的示例可能是在开发人员的机器上进行 GAC 处理但在部署的产品中丢失的组件。

自动构建很有用，因为它们消除了人为因素——即它们每次都重复相同的步骤（例如，它们不太容易忘记构建步骤）——这为您提供了可预测性。如果您使用相同的源运行相同的构建脚本，您应该得到相同的输出。这对于正确的发布管理至关重要。

当您开发构建环境时，可以对其进行扩展，以便为开发团队提供更多支持——尤其是在团队开始壮大时。其余的可以讨论 - 如果您（或您的团队）可以看到降低项目风险或工作量的价值，则可以实施。

持续集成 (CI) 基本上可以让您更早地知道是否与项目的源代码/解决方案有任何冲突 - 即，在团队其他成员从源代码​​控制刷新源代码时，他们会在收到损坏的代码库之前。

这里的主要优势是更快地解决损坏的代码库 - 通常当它在人们的脑海中仍然新鲜时（因为理论上，他们只是将更改提交到源代码控制存储库）。然而，人们确实需要密切关注它..

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-20T14:10:06.763

简单地说，我们使用它来确保如果有人将代码提交到集成分支/发布分支​​，并且没有经过适当的测试，我们会在 10 分钟内而不是 10 天内发现。

我们不使用它来测试，我们使用它来备份我们的测试过程。

# asp.net - 如何将更新“推送”到（ASP.NET）网页表/网格中的单个单元格？

> ID：839545
> 
> 赞同：2
> 
> 时间：2009-05-08T12:23:24.843
> 
> 标签：asp.net, javascript, ajax

我正在构建类似于价格比较网站的东西。这将在 ASP.NET/WebForms/C#/.NET 3.5 中开发。该站点将被公众使用，因此我无法控制客户端 - 并且该应用程序对他们的生活并不那么重要，以至于他们会不遗余力地使其工作。

我想要一个表格/网格，在行中显示产品，在列中显示供应商，在单元格中显示价格。价格更新将不断到达（在服务器上），我想将任何更新“推送”到客户的浏览器 - 理想情况下只更新已更改的内容。因此，如果供应商 A 更改产品 B 的价格，我希望立即更新所有正在查看此信息的浏览器中的相关单元格。

我不想使用任何浏览器插件（例如 Silverlight）。Javascript很好。

最好的方法是什么？

大概我的选择是：

1）让客户端页面不断轮询服务器以获取更新，找到正确的单元格并进行更新；或 2) 让服务器能够将更新发送到正在侦听这些更新的所有打开的浏览器页面。

第一个似乎是最合理的，但我不想限制 SO 社区的集合智慧。

我很乐意购买任何可能对此有所帮助的第三方组件（例如网格）。我已经有了 DevExpress 网格/ajax 组件，如果它们提供任何有用的话。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-08T12:56:14.533

我认为你的直觉是正确的，拉模型更容易构建。iWeasel 提到了 Ajax，我想指出 Dave Ward 关于[jQuery、Ajax 和 PageMethods](http://encosia.com/2008/06/26/use-jquery-and-aspnet-ajax-to-build-a-client-side-repeater/) in Asp.Net 的帖子。他的博客有一个优秀的系列，可以帮助你实现你想做的事情。

为了验证 Dave 的方法，[Rick Strahl 也有一篇](http://www.west-wind.com/presentations/jQuery/jQueryPart2.aspx)关于 jQuery 和 Asp.net 的精彩文章，在他的示例中，他以类似网格的格式显示产品。

虽然我没有使用此 jQuery 插件的经验，但您可能想研究[jQuery Timer](http://jquery.offput.ca/every/)以帮助您调整时间间隔。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T12:33:50.607

我不认为你可以“轮询”浏览器（IE、Firefox 等），所以我知道获取数据的唯一方法是让页面请求它。

每隔这么多秒刷新一个 AJAX 更新面板怎么样。这样页面不会闪烁，您将限制来回发送的数据量。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-08T13:09:22.363

您可能会看到一些所谓的服务器端推送技术，例如 - AjaxPush、Comet 甚至一些商业产品，例如[kaazing gateway](http://www.kaazing.com/)和[lightstreamer](http://www.lightstreamer.com/)

# java - 让 Struts 为不同的角色显示不同的 JSP

> ID：839547
> 
> 赞同：2
> 
> 时间：2009-05-08T12:23:52.580
> 
> 标签：java, jsp, struts, roles

我们有一个 Struts 2 Web 应用程序，几乎每个员工都使用它来管理和配置我们的服务器场的作业。我们正在制定一项为客户制作仪表板的计划，这样他们就可以看到自己的工作，并非常简单地显示其状态（“进行中”、“准备打样”、“完成”等）。客户可以看到的所有页面的信息都将比员工的视图少得多，并且无法编辑或更改任何内容。但归根结底，它们本质上是相同信息的两种不同视图：一种非常简单，一种更复杂且可控。

天真的方法是在每个 jsp 中都有 if/else：

```
<s:if test="user.role == 'customer'">
    <!-- TODO - Display simple customer view -->
</s:if>
<s:else>
    <!-- TODO - Display complex employee view -->
</s:else> 
```

有没有更简单的方法来做到这一点？我可以创建两个单独的 jsps 目录，一个名为“customer”，一个名为“employee”（或默认值或其他），然后让 Struts 在我的操作中关闭属性以决定检查哪个目录？

还是有其他方法可以做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T12:36:12.410

我建议在您的控制器中管理它。为客户添加一个新视图，并检查用户在控制器中的角色并显示适当的视图。这将使您现有的视图保持不变，并增加为您的客户提供真正自定义视图的能力。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T13:11:31.080

从问题中并不清楚这两种观点是否完全不同，或者客户是否有额外的东西，或者员工是否有额外的东西。如果一个角色有额外的东西，只需将常见的部分放在一个文件中，将不常见的部分放在他们自己的文件中，然后使用包含或拼贴（或类似的东西）来组合 JSP 来制作页面。

如果两个视图完全不同，它们应该是单独的 JSP，在这种情况下，动作可以根据角色转发到适当的视图，正如 Rich Kroll 所建议的那样。

至于您询问有关复制结果定义的评论，当您有两个独立的互斥功能时，您需要两个代码路径。您能做的最好的事情就是将通用性分解到共享代码文件中。

如果您经常使用此模式，则可以简化操作代码的一种方法是选择与您所需的转发名称最匹配的 ActionForward。

所以，如果通常你会这样做

```
return mapping.findForward("success"); 
```

你可以做这样的事情

```
ActionForward defaultMapping = mapping.findForward("success");
ActionForward roleMapping = mapping.findForward(user.getRole() + "_success");
if (roleMapping != null) {
  return roleMapping ;
} else {
  return defaultMapping;
} 
```

把它放在你的基类中的一个方法中，然后你的动作就不需要知道他们要去什么视图。那么你的 struts-config 可以是这样的：

```
<action path="/home" class="HomeAction">
  <forward name="success" path="home.jsp"/>
</action>
<action path="/viewOrder" class="ViewOrderAction">
  <forward name="customer_success" path="customer_order.jsp"/>
  <forward name="employee_success" path="employee_order.jsp"/>
</action> 
```

在这种情况下，您不会通过名称动态查找 jsps 以确定它们是否存在，但至少可以使操作代码保持简单。

# visual-studio-2008 - 自动扩展 C# 3 语法糖

> ID：839561
> 
> 赞同：1
> 
> 时间：2009-05-08T12:26:43.917
> 
> 标签：visual-studio-2008, visual-studio-2005, c#-3.0, c#-2.0

您好，我遇到了 SlimDX 示例，它只是假装支持 VS 2005。嗯，有 VS2005 解决方案/项目文件，但源代码本身包含 C# 3.0 新语言功能（主要是自动属性）。手动将这些东西转换为 C# 2.0 将是地狱​​。有什么工具可以自动完成吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T12:33:48.720

我知道免费提供的[CodeRush Express](http://msdn.microsoft.com/en-us/vcsharp/dd218053.aspx)可以做到这一点，因为我已经使用过它。该功能称为“创建后备存储”。那里还有其他重构，我确信转换为/从推断类型（'var'）也是可能的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T12:33:52.153

[Resharper](http://www.jetbrains.com/resharper/)肯定会通过几次点击将自动属性转换为具有支持字段的属性。

它还将根据您定义的标准处理一批文件，以便您可以让它做您需要的事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T12:32:57.943

尝试使用 C# 3.0 编译器编译源代码，然后使用 Reflector + [FileDisassembler](http://www.denisbauer.com/NETTools/FileDisassembler.aspx)将反编译的源代码转储到与 C# 2.0 兼容的文件中。

# compiler-construction - Stratgo/XT 编程语言

> ID：839564
> 
> 赞同：3
> 
> 时间：2009-05-08T12:26:55.273
> 
> 标签：compiler-construction, programming-languages

有人知道[Stratego/XT](http://en.wikipedia.org/wiki/Stratego/XT)编程语言吗？到底有什么好处呢？有什么好的和/或不好的经历吗？任何真实的现场运行示例？

非常感谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-12-13T09:20:06.660

Stratego/XT 是一种基于术语重写和可编程重写策略的程序转换语言和工具集。

[您可以在http://strategoxt.org](http://strategoxt.org)找到有关语言和工具集的文档和科学论文。

Stratego/XT 的一个实际应用是 WebDSL (webdsl.org)，这是一种用于开发 Web 应用程序的领域特定语言，而该语言又被用于构建 researchr.org。

Stratego/XT 也是 Spoofax/IMP 工具集的基础，用于为自定义（特定领域）语言构建 Eclipse IDE 插件（请参阅stratego 网站上的 Spoofax-IMP 页面）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-12T21:30:01.217

请改用[TXL](http://txl.ca)。它更容易开始并完成类似的工作。它的网站上有例子。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-02-22T18:55:02.497

如果您对 Stratego（或 TXL）感兴趣，那么您很可能对[DMS Software Reengineering Toolkit](http://www.semanticdesigns.com/Products/DMS/DMSToolkit.html)感兴趣。

DMS 是一个功能齐全的程序转换系统，其核心是提供源到源的重写，如 Stratego 和 TXL。您可以使用它来实现您自己的自定义 DSL 编译器，或大量源代码更改引擎。

DMS 的不同之处在于它可以通过 Java、C#、C++、C 和 COBOL 的测试前端获得，其中大部分将解析您的源代码、构建 AST 和符号表，其中一些提供控制流、数据流和指向分析器的点。
分析基础设施是通用的，也可以在您的 DSL 上使用。

您可以在网站上找到这些系统的比较。

# c - 如何使用文件、环境和/或命令行初始化 C 程序？

> ID：839565
> 
> 赞同：5
> 
> 时间：2009-05-08T12:27:15.350
> 
> 标签：c, configuration, initialization, ini

在 C 语言中，如何使用键值对配置某些程序的初始设置，其中任何或全部：纯文本[配置文件](http://en.wikipedia.org/wiki/Configuration_file)、环境变量和命令行上的选项。此外，如何确定哪种方法的值会覆盖其他两种方法的值。然后，如果值已更改，则可选择更新配置文件。

最简单的方法是什么？如果有的话，最被接受的方法是什么？是否有一个最好是小型的开源程序来提供一个很好的例子来说明如何做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-08T12:54:56.437

基础：

*   要使用环境变量配置程序，可以使用 stdlib.h 中定义的 getenv 函数。
*   要使用命令行参数配置程序，请声明主函数，如“int main(int argc, const char* const* argv)”，并使用循环遍历 argv 数组中的参数。它的大小由 argc 给出。
*   要使用配置文件配置您的程序，最好选择一些为您执行此操作的库，而不是发明另一种自定义配置文件格式。请注意，根据您的目标平台，还有一些库可以解析命令行参数。

哪个设置源应该相互覆盖取决于应用程序，但在我看来，通常命令行参数 > 环境变量 > 配置文件最有意义。

这是从环境和命令行获取配置的示例，命令行覆盖环境：

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

int main(int argc, const char* const* argv) {
    int i;
    const char* myConfigVar;

    // get default setting from environment
    myConfigVar = getenv("MY_CONFIG_VAR");

    // if the variable wasn't defined, initialize to hardcoded default
    if (!myConfigVar)
        myConfigVar = "default value";

    // parse commandline arguments
    // start at 1, because argv[0] contains the name of the program
    for (i = 1; i < argc; ++i) {
        if (strcmp("--my-config-var", argv[i]) == 0) {
            if (i + 1 < argc)
                myConfigVar = argv[i + 1];
            else
                printf("missing value for my-config-var argument\n");
        }
    }

    printf("myConfigVar = '%s'\n", myConfigVar);
    return 0;
} 
```

您已经看到它很快就会变得非常冗长和乏味，因此如果您想要的目标平台存在一个现有的库，那么最好使用现有的库，或者至少将这种代码分解为许多函数。

另一个有趣的选择是将脚本语言绑定到您的应用程序，然后您可以让您的应用程序只读取和“执行”您的设置文件，并且用户可以配置设置文件以从环境读取一些设置，从命令行读取一些设置，例如。这实际上取决于应用程序的类型和大小以及您的目标受众是否值得这样做。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-08T14:15:07.010

[Eric Raymond 在The Art of Unix Programming](http://www.faqs.org/docs/artu/)第 10 节中涵盖了很多内容显然这是以 Unix 为中心，但大多数原则都可以应用于任何操作系统。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-08T12:31:20.397

有大量的库用于处理各种格式的配置文件解析。寻找两种流行的选择 XML 和 INI 格式。编写自定义解析器可能不是一个好主意，因为它可能需要大量工作而收效甚微或毫无收获。[这](http://ndevilla.free.fr/iniparser/)是一个用于解析 INI 文件的随机 C 库，XML 留作练习。

设置之间的优先级通常是命令行选项覆盖任何“环境”设置。我会建议这样的优先级，按重要性降序排列：

1.  命令行选项覆盖任何东西
2.  设置文件是下一个
    *   有时在用户的本地文件和系统全局文件之间拆分
3.  接下来是环境变量

但是 2 和 3 很可能会颠倒过来。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-08T12:34:18.967

这个问题不是很清楚。问题是“存在哪些机制？”、“参数和格式的约定是什么？”还是“我应该如何混合和匹配？”？

有几种非常标准的方法（至少在 unix 世界中）：

*   环境变量
*   配置文件
*   命令行参数
*   作为上述的子集，在命令行上指定的配置文件

要选择用于您自己的程序的方法，请在冻结您自己的选择、阅读一些博客、阅读一些书籍之前从公认的实践规范中检查*许多程序……*

配置文件可能是跨操作系统最可移植的。

治疗可能会变得相当复杂。如果命令行参数可能会影响配置文件或环境变量的解释，但您仍然希望命令行推翻其他机制（一个好主意），您可能需要三遍：

1.  解析命令行并设置任何影响进一步设置的变量（比如要读取哪个配置文件）
2.  处理配置文件和环境变量（什么顺序？）
3.  重新运行命令行以覆盖所有其他设置。

* * *

在 unix 传统中，请查看`getopt`and `getopt_long`。还要考虑像这样的工具[`gengetopt`](http://www.gnu.org/software/gengetopt/gengetopt.html)

您可以通过制作设置环境变量的 shell 脚本来简化配置文件问题（但这会将您锁定在 unix 模型中）。解析纯文本很容易且跨平台，但需要编写更多代码。使用标准格式和库对用户的构建环境提出了要求，但应该可以避免错误和混乱。

* * *

如果你的配置环境比较复杂，把配置状态封装在一个结构体中，可以根据需要进行传递是非常有帮助的。这是 采用的方法`gengetopt`，我发现它很有用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-08T14:30:21.357

对于这方面的类 Unix 设计模式，请查看 Raymond 的“ Unix[编程](http://books.google.com/books?id=CZae0PbOXJMC)[艺术](https://rads.stackoverflow.com/amzn/click/com/0131429019)[”](http://www.catb.org/~esr/writings/taoup/)。它讨论了命令行参数优先于环境变量和配置文件等。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-09T01:13:19.253

[Lua](http://www.lua.org/)语言的部分动机是需要为一组工具提供一个定义良好的配置语言。将 Lua 集成为配置语言仍然很容易。一个相当完整的示例在《Lua 编程》一书中，该书的旧版本可在线获得。[第 25 章](http://www.lua.org/pil/25.html)描述了使用 Lua C API 将 Lua 作为配置语言嵌入，以及您可能想要这样做的原因。

# javascript - Javascript中的onBecomesVisible用于无点击分页？

> ID：839567
> 
> 赞同：1
> 
> 时间：2009-05-08T12:27:25.617
> 
> 标签：javascript, ajax, pagination

一旦某个元素在浏览器画布中可见，是否有任何 javascript 库为我提供自定义事件？

基本思想是，一旦列表中的最后一个元素在屏幕上可见，我想加载接下来的 10 个元素，这样用户就不需要单击“下一页”按钮。为了实现这一点，在显示最后一个元素时立即触发的 onBecomesVisible 事件会很方便。有这样的吗？

[Slashdot](http://slashdot.org)以这种方式加载其首页。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-08T12:54:10.107

您可以使用 jQuery 编写自己的简单插件。

```
 $.belowViewport = function(elem){
  var port = $(window).scrollTop() + $(window).height();
  return port <= $(elem).offset().top;
 }

 $.fn.onBecomeVisible = function( fn ){
  var obj = this;
  $(window).scroll( function() {
   obj.each( function() {
    if(!$.belowViewport(this) && !$(this).data('scrollEventFired')){
     $(this).data('scrollEventFired', true);
     fn(this);
    }
   });
  });
  return this;
 } 
```

然后像这样使用它

```
 $('.elements:last').onBecomeVisible( function(elem){ loadNewElems(); } ); 
```

该脚本将 fn 绑定到每个匹配的元素。当任何匹配的元素滚动到视图中时，该函数将被触发。该函数还将传递哪个元素触发了事件。

请注意，您不能使用 live 绑定此事件，因此您必须在添加新元素后重新绑定它（假设您也希望在最后一个元素上使用该事件。）。

**编辑**
我在这里错了， :visible 不会返回元素是否在视口中。但是我已经编辑了源代码，所以它现在会检查元素是否在视口中。该函数检查元素是否在视口下方，我们假设如果它不在视口下方，则它已被滚动到视图中并且我们应该执行该函数。

**EDIT2**
在 google chrome 1.0、firefox 3.0.10 和 IE7 中对此进行了测试

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-08T12:32:46.977

您可能想查看无休止的滚动：

[http://plugins.jquery.com/project/endless-scroll](http://plugins.jquery.com/project/endless-scroll)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-08T12:42:30.510

Dustin Diaz（他真的很聪明，你应该阅读更多他的东西）在 2007 年写了一篇关于[检测元素何时滚动到视图中的文章。](http://www.dustindiaz.com/element-scroll-into-view/)

可能正是您需要的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-09T11:00:54.347

另一种想法是始终使用包装函数来显示/隐藏所有内容。换句话说，您总是使用自己的函数，而不是直接执行`style.display='none';`or ，将元素的 id 传递给该函数。`$("#something").hide();`

然后，您可以更轻松地跟踪元素何时变为可见/隐藏并设置要运行的事件句柄。

# java - Java：类是它自己的子类吗？

> ID：839569
> 
> 赞同：4
> 
> 时间：2009-05-08T12:29:44.423
> 
> 标签：java, class, inheritance

如果一个类的内部类扩展了外部类，那么该类可以是其自身的“子类”，因此该类以某种方式扩展自身而不会引发任何异常。那么，这真的意味着一个类也是它自己的一个子类吗？

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-08T12:33:30.123

一个类不是它自己的子类。内部类可以是某个其他类的子类，但那是一个单独的类。您可以通过比较调用 getClass() 时获得的 Class 实例来验证这一点。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-08T12:36:37.917

子类的定义是它扩展了另一个类并继承了该类的状态和行为。一个类不能扩展自己，因为它是它自己，所以它不是子类。允许内部类扩展外部类，因为它们是两个不同的类。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-08T13:00:00.607

```
public class ParentClass {

    int intField = 10;

    class InnerClass extends ParentClass {

    }

    public static void main(String... args) {
        ParentClass parentClass = new ParentClass();
        InnerClass innerClass = parentClass.new InnerClass();

        System.out.println(innerClass.intField);

        InnerClass innerClass2 = innerClass.new InnerClass();
    }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-08T12:44:13.767

实际上 JVM 现在没有关于内部类的任何东西。

所有内部类在编译后都成为普通类，但编译器为它们提供了外部类所有字段的访问器。

在 OOP 理论中，类不能是它的子类或超类。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-08T12:32:50.423

不，内部类与外部类完全不同。除非我误解了你的问题......

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-08T12:44:05.623

如果您将自己的子类定义为这样：

```
public class Test {

    public static void main(String[] args) {
        // whatever...
    }

    class TestChild extends Test {
        // whatever...
    }
} 
```

那么是的，这是可能的。但请注意，这是两个完全独立的类，除非一个是另一个内部的。

# regex - 如何匹配 RewriteCond 中的子目录？

> ID：839575
> 
> 赞同：7
> 
> 时间：2009-05-08T12:31:10.693
> 
> 标签：regex, mod-rewrite

RewriteCond 的正则表达式有问题

```
RewriteCond %{REQUEST_URI} !^/foo/ 
```

可以按预期工作，也就是说，重写后不适用于所有以 /foo/ 开头的 URL。

```
RewriteCond %{REQUEST_URI} !^/foo/bar/ 
```

另一方面，它不像我预期的那样工作。以 /foo/bar/ 开头的 URL 仍在被重写。

如何输入正确的正则表达式以排除子目录？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-08T13:38:15.430

也许它是应用规则的内部重定向的新 URL。[`L`国旗](http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html#rewriterule)就是这样做的。

> [...] 如果`RewriteRule`生成内部重定向（在每个目录上下文中重写时经常发生），这将重新注入请求并导致从第一个`RewriteRule`.

如果您想确保初始 URL 路径不是以“/foo/bar”开头，请检查[请求行](http://www.w3.org/Protocols/rfc2616/rfc2616-sec5.html#sec5.1)（请参阅[`THE_REQUEST`变量](http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html#rewritecond)）：

```
RewriteCond %{THE_REQUEST} !^[A-Z]+\ /foo/bar/
RewriteRule … 
```

# c# - 频道 'tcp' 已注册

> ID：839577
> 
> 赞同：10
> 
> 时间：2009-05-08T12:31:19.740
> 
> 标签：c#, remoting

我希望给定的应用程序（Windows 服务）充当远程服务器和远程客户端。在生产中，我将运行我的应用程序的两个实例，通过 .NET Remoting 相互监控，并相应地报告故障。

我写了一个基本的部分，并得到“通道'tcp'已注册”异常..我想以编程方式设置通道配置。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-08T13:49:08.307

正如其他人所说，如果您不指定频道名称，则默认情况下代码使用“tcp”并且每个频道都必须有一个唯一的名称：所以为您打开的每个频道指定一个唯一的名称......

```
 int tcpPort = 52131;
    // ------------------------------------------------------------
    BinaryServerFormatterSinkProvider serverProv =
        new BinaryServerFormatterSinkProvider();
    serverProv.TypeFilterLevel = TypeFilterLevel.Full; 
    RemotingConfiguration.CustomErrorsMode = CustomErrorsModes.Off;

    serverProv.TypeFilterLevel = TypeFilterLevel.Full;
    IDictionary propBag = new Hashtable();
    // -----------------------------------------
    bool isSecure = [true/false];
    propBag["port"] = tcpPort ;
    propBag["typeFilterLevel"] = TypeFilterLevel.Full;
    propBag["name"] = "UniqueChannelName";  // here enter unique channel name
    if (isSecure)  // if you want remoting comm to be secure and encrypted
    {
        propBag["secure"] = isSecure;
        propBag["impersonate"] = false;  // change to true to do impersonation
    }
    // -----------------------------------------
    tcpChan = new TcpChannel(
        propBag, null, serverProv);
    ChannelServices.RegisterChannel(tcpChan, isSecure);
    // --------------------------------------------

    string uRI = MyUniversalResourceIndicatorName;
    // ---------------------------------------------

    RemotingConfiguration.RegisterWellKnownServiceType(
        typeof(ImportServiceManager), uRI ,
        WellKnownObjectMode.SingleCall); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-08T12:40:17.893

具有特定端口号的通道只能由一个应用程序实例创建。您需要为每个实例使用不同的端口号和通道名称。

这需要使用单独的频道模板（如果您使用的是模板？）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-08T12:36:52.067

您只能使用相同的端口号创建相同的通道一次`AppDomain`。那是怎么回事？

# iphone - 如何动态填充 NSArray？

> ID：839578
> 
> 赞同：15
> 
> 时间：2009-05-08T12:31:20.147
> 
> 标签：iphone, objective-c, uikit, nsmutablearray, nsarray

我有一个`for`循环。在那个循环中，我想`NSArray`用一些对象填充一个。但我没有看到任何可以让我这样做的方法。我提前知道有多少物体。我想避免`NSMutableArray`，因为有些人告诉我，与`NSArray`.

我有这样的事情：

```
NSArray *returnArray = [[NSArray alloc] init];
for (imageName in imageArray) {
    UIImage *image = [UIImage imageNamed:imageName];
    //Now, here I'd like to add that image to the array...
} 
```

我查看了文档`NSArray`，但是如何指定其中要包含多少个元素？还是我必须真正使用`NSMutableArray`它？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-05-08T12:40:50.730

是的，您需要使用`NSMutableArray`：

```
int count = [imageArray count];
NSMutableArray *returnArray = [[NSMutableArray alloc] initWithCapacity:count];
for (imageName in imageArray) {
    UIImage *image = [UIImage imageNamed:imageName];
    [returnArray addObject: image];
    ...
} 
```

编辑 - 声明已修复

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-08T12:40:08.970

您需要为此使用[NSMutableArray](http://developer.apple.com/DOCUMENTATION/Cocoa/Reference/Foundation/Classes/NSMutableArray_Class/index.html)，因为添加是突变，而[NSArray](http://developer.apple.com/DOCUMENTATION/Cocoa/Reference/Foundation/Classes/NSArray_Class/Reference/Reference.html#//apple_ref/occ/cl/NSArray)是不可变的。

您可以将 a 填充`NSMutableArray`到`NSArray`之后（[请参阅此处进行讨论](http://www.cocoabuilder.com/archive/message/cocoa/2007/10/4/190321)），但您不会`NSArray`很快将项目添加到常规旧的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-08T12:37:43.343

现在是使用[NSMutableArray](http://developer.apple.com/DOCUMENTATION/Cocoa/Reference/Foundation/Classes/NSMutableArray_Class/Reference/Reference.html)的好时机吗？

我知道你提到你想避免它，但有时这样的事情是有原因的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-09T18:14:28.420

我建议仅在您知道`NSMutableArray` *会*导致性能下降时才进行优化，但如果是这样，您始终可以在填充可变数组后从可变数组创建静态数组。这取决于性能下降是由您随后使用`NSMutableArray`或仅由创建它引起的。

我的猜测是，这不会成为您应用程序的性能瓶颈。

# c# - MSBuild：如何覆盖输出文件名以不同于程序集名称？

> ID：839594
> 
> 赞同：1
> 
> 时间：2009-05-08T12:34:17.407
> 
> 标签：c#, msbuild

我的解决方案中有 2 个 C# 项目，它们都是 DLL：

*   MyApp.UI.WPF.csproj
*   MyApp.UI.WinForms.csproj

我的设置过程保证在任何给定时间只安装其中一个。无论是哪一种，当用户运行应用程序时，它都会被 MyApp.exe 引导程序拾取。

由于两个 DLL 包含相同的入口点，我想保持引导程序的通用性：

```
class Bootstrapper
{
    static void Main()
    {
        var asm = Assembly.Load("MyApp.UI");

        // Execute the UI entry point here.
    }
} 
```

这意味着我必须在项目选项中为两个 DLL 提供相同的程序集名称：“MyApp.UI”。问题是 MSBuild 使用程序集名称作为输出名称，这对我造成了冲突。

是否可以说服 MSBuild 使用不同的文件名，例如项目名称？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T08:43:19.753

您可以将 a 添加`<PostBuildEvent>`到您的构建中，以将您的输出程序集重命名为通用名称。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T14:55:09.567

这将是 CoreCompile 任务的功能，您必须覆盖它才能修改 csc 上的 /out 开关。这不是推荐的做法，但可以实现您的目标。

# mysql - Mysql：如何查询类型为位的列？

> ID：839596
> 
> 赞同：30
> 
> 时间：2009-05-08T12:34:31.183
> 
> 标签：mysql, select, bit

嗨，我正在使用休眠和 Mysql。我有一个名为“活动”的布尔属性的类。

生成的数据库表具有 BIT 数据类型。到现在为止还挺好。我想查询这个值，但我不知道该怎么做。我试过了

```
 SELECT * from table where active = 1 
```

不起作用，以下都不是

```
 SELECT * from table where active = true 
```

我在参考手册和 Stackoveflow 都没有找到任何东西。

有什么提示吗？

提前致谢！

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-05-08T12:36:48.493

```
SELECT * FROM table WHERE active = (1) 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-05-08T12:40:00.203

根据[此页面，对于](http://dev.mysql.com/doc/refman/5.0/en/numeric-type-overview.html)**5.0.3 之前**的版本，BIT 是 TINYINT(1) 的同义词。

你试过这些吗？

```
SELECT * from table where active = (1)
SELECT * from table where active = 'true'
SELECT * from table where active = b'1' 
```

此[博客条目](http://www.xaprb.com/blog/2006/04/11/bit-values-in-mysql/)建议完全避免使用 BIT 数据类型。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-08T12:38:10.003

要指定位值，可以使用 b'value' 表示法。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-07-11T17:01:10.697

实际上 MySQL 有内置的位字面量：

```
select*from table where active = 0b1 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-05-08T12:44:06.713

您是否尝试过将其转换为整数进行比较

```
SELECT * from table where cast(active as unsigned) = 1 
```

我大部分时间都使用 MS SQL，如果这不起作用，请原谅我，因为我无法测试它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-09-07T11:27:48.800

好吧，对于比较和更新，0 和 1 对我有用：

这是一个位（1）类型的字段，一行，该字段当前为假：

```
mysql> select isfeatured from nodes where isfeatured = 1;
Empty set (0.00 sec)

mysql> select isfeatured from nodes where isfeatured = 0;
+------------+
| isfeatured |
+------------+
|            |
+------------+
1 row in set (0.00 sec) 
```

更新将 isfeatured 中的 0 更改为 1，即 bit(1) 类型...

```
mysql> update nodes set isfeatured=1 where isfeatured = 0;
Query OK, 1 row affected (0.05 sec)
Rows matched: 1  Changed: 1  Warnings: 0 
```

换了一行...再试一次：

```
mysql> update nodes set isfeatured=1 where isfeatured = 0;
Query OK, 0 rows affected (0.00 sec)
Rows matched: 0  Changed: 0  Warnings: 0 
```

没有按预期更改行。

与以前相同的选择查询：

```
mysql> select isfeatured from nodes where isfeatured = 1;
+------------+
| isfeatured |
+------------+
|           |
+------------+
1 row in set (0.00 sec)

mysql> select isfeatured from nodes where isfeatured = 0;
Empty set (0.01 sec) 
```

看，它有效。

我正在使用：

mysql Ver 14.14 Distrib 5.5.31，适用于使用 readline 6.2 的 debian-linux-gnu (x86_64)

和

/usr/sbin/mysqld Ver 5.5.31-0+wheezy1 用于 x86_64 上的 debian-linux-gnu ((Debian))

# c# - 使用 IEqualityComparer 在字典中查找键

> ID：839599
> 
> 赞同：0
> 
> 时间：2009-05-08T12:35:41.930
> 
> 标签：c#, .net

我有一个名为 AvailableBoxes 的字典。我想在这本词典中查找一个字符串。但是，我想比较小写（并忽略特殊字符）。

我发现我可以执行以下操作来了解字典中是否存在密钥：

```
AvailableBoxes.Keys.Contains(CurrentBox.Name, new BoxNameEqualityComparer()) 
```

BoxNameEqualityComparer 是我自己的实现 IEqualityComparer 的比较器。

但是有没有类似的方法可以找到这个键的索引？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T12:39:37.987

看看使用`StringComparer`类中的预定义之一。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T12:43:17.870

如果您只是比较无大小写的字符串，则无需定义自己的比较器。只需使用内置的 StringComparer 类

```
AvailableBoxes.Keys.Contains(CUrrentBox.Name, StringComparer.OrdinalIgnoreCase); 
```

如果您将 Keys 集合视为有序列表，则可以确定特定键的索引。这是一个糟糕的假设。因为如果您将新项目添加到字典中，它可以出现在 Keys 集合中的任何位置。

如果你真的想在你的字典中排序，我建议你使用 OrderedDictionary。

# javascript - Dhtml 过渡

> ID：839617
> 
> 赞同：0
> 
> 时间：2009-05-08T12:40:33.603
> 
> 标签：javascript, html, dhtml

当用户单击按钮时，是否可以将幻灯片从左向右移动。我正在使用 progid:DXImageTransform.Microsoft.Slide(slideStyle='PUSH',bands=1)。它从右向左移动，就像我需要从左向右移动一样。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-08T13:15:43.113

仅 IE 函数中的 DXImageTransform。

最常见的是，这可以使用任何流行的 JavaScript 库来完成，例如 jQuery 或 Prototype/Scriptaculous。

使用[Prototype/Scriptaculous](http://wiki.github.com/madrobby/scriptaculous/effect-move)你可以这样做：

```
new Effect.Move('divName',{mode:'relative',x:-500,y:0}) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-08T13:16:03.407

你不会喜欢这个，但由于过渡是 IE 特有的功能，我*强烈*建议完全避免使用它们并找到另一种方法来创建你想要的效果。

我将从查看[Mootools 动画](http://demos.mootools.net/)开始，并考虑这些动画如何与 AJAX 技术交互。

# windows - Windows 在哪里存储 ACL，ACL 是否将文件从一台机器转移到另一台机器？

> ID：839625
> 
> 赞同：8
> 
> 时间：2009-05-08T12:42:20.493
> 
> 标签：windows, svn, permissions, installshield, acl

我们的应用程序使用的组件需要目录中的许可证文件和我们的可执行文件，这恰好是一个 .NET WinForms 应用程序，尽管我认为这对这个问题无关紧要。当安装在某些 XP Pro 机器上时（目前只有几百台机器中的三台），该组件会引发许可证异常。所以我重新生成了许可证文件并将其发送给组件供应商 (EMC Captiva)，供应商声称该错误是由于“用户”组对该文件没有读取权限。遇到错误的用户恰好是本地管理员，但除此之外，我仍然对更一般的问题感到好奇。

所以我的问题是，ACL 是否存储在文件中，以便它们在文件的整个生命周期中都跟随文件，特别是当许可证文件是在我的开发机器（机器 1）上生成、存储在 Subversion（机器 2）中、从源代码控制中签出时由 TeamCity（机器 3），由 InstallShield（机器 4）打包成安装程序，最后部署到由管理员安装的客户机器（机器 5）？在我的开发机器（机器 1）上生成文件后，如何通过他们的支持站点（机器 2）将其上传到组件供应商，然后支持人员将其下载到他们的机器以供检查（机器 3）？

我不确定这一点（这就是我在这里问它的原因），但我假设每台 Windows 机器都将 ACL 存储在由 NTFS 管理的某个中央目录/列表/表中，而不是存储在文件中。当原始文件的 ACL 从一台机器复制到另一台机器、存储在 Subversion 中、打包到 MSI 等时，会发生什么情况？有人可以指出我可以阅读的一些好的参考资料吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-08T12:53:14.727

ACL 存储在 NTFS 分区的一部分中，该分区执行所有后台管道 - MFT（主文件表）。

ACL 不会跟随文件，因为它不是文件的一部分（就像文件名一样，它是元数据）。文件可以跨越分区类型边界（NTFS->FAT），ACL 不能。

现在，如果您在一个 NTFS 分区内*移动*一个文件，您可能会觉得 ACL 实际上跟随该文件。这是因为在移动过程中，实际上只更改了 MFT 中的文件名。其他一切都保持不变。

如果您复制文件或将其移动到另一个分区或计算机（实际上是复制+删除操作），则复制的文件将默认继承其新容器的权限（准确地说是可继承的）。

但是，有些工具能够在复制操作后保留文件的 ACL（只需在复制操作后在目标文件上重新创建它），即使在分区或计算机边界上也是如此。xcopy 可以做到这一点，等等。

但由于 ACL 可以包含“域所有”的 SID，因此 ACL 条目可能对不属于同一域的目标计算机实际上没有意义（例如，当带回家一个 NTFS 格式的 USB 驱动器时）。在这种情况下，ACL 条目将不起作用。

其他 SID 是“众所周知的”，例如“SYSTEM”SID。这些实际上将被跨域识别。

# sql - 是否有任何具有语法、逻辑格式等的与平台无关的 SQL 查询构建器？

> ID：839629
> 
> 赞同：0
> 
> 时间：2009-05-08T12:43:41.583
> 
> 标签：sql, editor, cross-platform, text-editor, editing

是否有任何轻量级工具允许独立于与特定数据库关联的主要应用程序/实用程序的易于阅读的 SQL 制作？

我最近发现自己正在使用 MySQL、Access 和现在的 MS-SQL，并使用 Notepad++ 构建查询，因为它提供了基本的语法突出显示，可以帮助我不熟悉的眼睛，但没有逻辑格式 - INNER JOIN、WHERE 等的新行，缩进继续参数，我敢说它甚至 IntelliSense - 那种东西。

特别是在重新调整呈现为难以理解的块的现有查询时，能够将其粘贴到某个地方，单击一个按钮并以更人性化的格式显示它会很好。

这样的工具存在吗？

**编辑：**感谢您的建议。特别是，SQLinForm 具有我理想中的那种细粒度控制。

可惜只有在线版本是免费的，一个 OSS 独立应用程序（不是 Java - gumph！）会更可取，因为 SQL 并不是我工作的主要重点，我什至看不到我在 bean 柜台上摆动 30 美元，所以我不要为试图修复他们糟糕的报告而头疼。

还有吗？

**编辑2：** 哎呀，这似乎已经被问过了。当我检查时，我显然不是在寻找正确的东西。搜索工具名称[或通过 Google 搜索](https://stackoverflow.uservoice.com/pages/1722-general/suggestions/181675-use-google-search-instead-on-the-inbuilt-one)，提出了许多类似的问题 - 投票结束。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-08T12:56:57.993

我过去使用它来使一些丑陋的 sql 有点可读性：[http ://www.dpriver.com/pp/sqlformat.htm](http://www.dpriver.com/pp/sqlformat.htm)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T13:02:56.090

我过去使用过[SQLInform](http://www.sqlinform.com/)，结果非常好——它再次以合理的准确性格式化您粘贴的任何 SQL。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T12:57:16.980

我主要为此使用了oracle SQL Developer。但这并不完全是轻量级的。MS-SQL-Server 开发 UI 也适用于此。（我认为它们也适用于不同的数据库）。

Toad 是另一个不错的 UI。（但也不是轻量级的）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-08T13:54:03.863

我还没有尝试过，但我看到至少有一个 SQuirreL 插件提到了格式化。免费/开源/Java。 [http://www.squirrelsql.org/index.php?page=plugins](http://www.squirrelsql.org/index.php?page=plugins)

# html - 有效的 html 标头

> ID：839630
> 
> 赞同：2
> 
> 时间：2009-05-08T12:43:42.830
> 
> 标签：html, header, validation

有没有办法写一个有效的标题/链接/图像？就像是

```
<a href="index.html"><h1 id="logo">Company name</h1></a> 
```

（将图像设置为背景，文本向左移动，因此通过 css 不可见）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-08T12:47:14.990

就像是：

```
<h1 id="logo"><a href="index.html">Company Name</a></h1>

#logo a {
    display: block;
    width: 200px; /* width and height equal to image size */
    height: 100px;
    background: transparent url(images/logo.png) no-repeat;
    text-indent:-9999px;
} 
```

您原始标记的问题在于它`<a>`是内联元素并且`<h1>`是块元素。内联元素不能包含块元素。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-08T12:59:36.490

不，锚元素不能包含 h1 元素。

此外，背景图像应为*背景*保留- 徽标不是背景，它是重要信息。

```
<h1><a href="/"><img src="/images/logo.png" alt="Company Name"></a></h1> 
```

请记住，虽然公司的身份可能是主页上最重要的标题，但它可能不在其他页面上——因此通常应该将其降级为其他页面。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-08T12:47:33.150

那是无效的 HTML 代码，但您可以使用带有有效代码的 CSS 来实现您想要的：

**HTML**

```
<h1 id="logo"><a href="index.html">Company name</a></h1> 
```

**CSS**

```
h1 a:link, h1 a:visited {
  display: block;
} 
```

您可以进一步设置 A 元素的样式以实现您想要的效果。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-08T12:58:37.177

这是有效的，我认为可以实现您正在寻找的东西，即整个图像是指向主页的链接。

```
<a href="index.html"><img src="logo.png" id="logo" alt="Company Name" /></a> 
```

如果您所做的只是在示例中包装 H1 标记，则该链接只能在文本周围单击。这将排除 H1 标签的边距。

这不需要 CSS 来隐藏文本，因为公司名称位于 ALT 属性中，由 Google 和屏幕阅读器读取。

**其他方式：**

如果您确实需要图像作为背景并在前景中显示文本，则还有另一种方法：

```
<body>
   <div id="header"> 
      <h1>Some Text Here</h1>
   </div>

   <div id="main-content">
       ... lots of content here ...
   </div>
 </body> 
```

CSS：

```
#header { 
    height: 55px;   // The height of you image
    width: 780px;   // The width of the image
    background: url(picture.png);
    margin: 0 auto; // To keep this div centered 
}

#header h1 {
    font-family: 'Times New Roman';
    text-decoration: bold;
    margin-left: 55px;  // This makes the text come in 55px from 
                        // the left of the containing div. Adjust to suit.
    margin-top: 10px;   // Same as above.
} 
```

如果您想经常更改文本，这是一种有用的方法。一天类型的事情的报价，或者如果你的老板总是要求你调整背景图像。

# python - Python 异常的最佳实践？

> ID：839636
> 
> 赞同：71
> 
> 时间：2009-05-08T12:44:43.280
> 
> 标签：python, exception

创建异常的最佳实践是什么？刚看到这个，不知道是应该惊恐还是喜欢。我在书中多次读到异常永远不应该包含字符串，因为字符串本身可以抛出异常。这有什么真实的吗？

基本上根据我对脚本的理解，这样做是为了让所有内部 Python 库都有一个通用的错误消息格式（迫切需要的东西），所以我可以理解为什么放置错误消息字符串是一个好主意。（几乎每个方法都会抛出异常，因为完全不需要任何无效的通过）。

有问题的代码如下：

```
"""
Base Exception, Error
"""
class Error(Exception):
    def __init__(self, message):
        self.message = message

    def __str__(self):
        return "[ERROR] %s\n" % str(self.message)

    def log(self):
        ret = "%s" % str(self.message)
        if(hasattr(self, "reason")):
            return "".join([ret, "\n==> %s" % str(self.reason)])
        return ret

class PCSException(Error):
    def __init__(self, message, reason = None):
        self.message = message
        self.reason = reason
    def __str__(self):
        ret = "[PCS_ERROR] %s\n" % str(self.message)
        if(self.reason != None):
            ret += "[REASON] %s\n" % str(self.reason)
        return ret 
```

这只是冰山一角，但有人可以告诉我是什么让这成为一个可怕的想法吗？或者，如果有更好的异常编码过程/风格。

* * *

## 回答 #1

> 赞同：91
> 
> 时间：2009-05-08T13:41:01.507

[强大的异常处理（在 Python 中）](http://eli.thegreenplace.net/2008/08/21/robust-exception-handling/) ——我不久前写的一篇“Python 异常的最佳实践”博客文章。您可能会发现它很有用。

博客中的一些关键点：

> **永远不要使用异常进行流量控制**
> 
> 例外情况存在例外：不属于正常执行的事件。

如果未找到模式，请考虑在返回 -1 的字符串上执行“查找”，但超出字符串末尾的索引会引发异常。找不到字符串是正常执行。

> **在知道如何处理异常的级别处理异常**
> 
> ...
> 
> 最好的地方是可以处理异常的那段代码。对于某些异常，例如编程错误（例如 IndexError、TypeError、NameError 等），最好将异常留给程序员/用户，因为“处理”它们只会隐藏真正的错误。

总是问“这是处理这个异常的正确地方吗？” 并小心捕捉所有异常。

> **记录您的代码引发的异常**
> 
> ...
> 
> 思考你的代码可能会抛出哪些异常将帮助你编写更好、更安全和更封装的代码

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2009-05-08T12:54:39.963

> 我在书中多次读到异常永远不应该包含字符串，因为字符串本身可以抛出异常。这有什么真实的吗？

什么？

请提供参考或链接。这是完全不真实的。

由于所有对象都可以抛出异常，因此该逻辑不会将任何对象包含在异常中。

不，“无字符串”在 Python 上下文中简直太疯狂了。也许您在 C++ 上下文中阅读它。

* * *

**编辑**

曾几何时（回到过去），您可以通过名称而不是实际类引发 Python 异常。

```
raise "SomeNameOfAnExceptionClass" 
```

这是不好的。但这*不*包括异常中的字符串。这是用字符串而不是实际的类对象命名异常。在 2.5 中，这仍然可以工作，但会收到弃用警告。

也许这就是你读到的“不要用字符串名称引发异常”

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2011-11-25T15:48:03.930

我相信反对使用字符串创建异常的建议来自“Learning Python”（O'Reilly）。在标题为**字符串异常的部分中！**，它指出了（现在已删除）直接使用任意字符串创建异常的能力。

它作为示例提供的代码是：

```
myexc = "My exception string"
try:
    raise myexc
except myexc:
    print ('caught') 
```

这是在第四版（平装本）的 p858 上。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-08T13:20:42.883

第一印象是对于异常来说代码太多了。

格式化异常应该在记录器配置中完成。日志记录本身也是如此。

它还重新定义了标准（和不推荐使用的）消息属性，并且不调用超类构造函数。（这可能会或可能不会破坏 Python 3.0 异常链接，我没有尝试过，因为我正在运行 2.6）

通过将以下内容记录为“消息”，可以使用 BaseException.args 来实现大部分额外代码的功能：

```
'\n==> '.join(exception.args) 
```

我认为，如果可以使用通用/惯用机制来完成某些事情，那么尤其应该在异常处理中这样做。（异常是一种*跨*应用程序层发出信号的机制。）

就个人而言，我尽量避免超出

```
class SomeException(Exception): pass 
```

（免责声明：回答主观，可能是由于问题的性质。）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-01-18T06:37:59.943

```
class Error(Exception):
    """Base class for other exceptions"""
    pass

class empty_string_error(Error):
    """Raised when the input value is too large"""
    pass
while(1):
    try:
        if("Your Condition"):
            raise empty_string_error
        else:
            print("OUTPUT")
    except empty_string_error:
        print("APT MESSAGE")
        print(" ")
    finally:
        pint("Mandatory code") 
```

# c++ - 获取 std::fstream 失败错误消息和/或异常

> ID：839644
> 
> 赞同：34
> 
> 时间：2009-05-08T12:48:34.737
> 
> 标签：c++

我正在使用 fstream。有什么方法可以获取失败消息/异常？

例如，如果我无法打开文件？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-05-08T13:03:24.657

默认情况下，流不会在错误时抛出异常，它们会设置标志。您可以使用流的 exception() 成员函数使它们抛出异常：

```
ifstream ifs;
ifs.exceptions( std::ios::failbit );   // throw if failbit get set 
```

从理论上讲，您可以执行以下操作：

```
try {
  int x;
  ifs >> x;
}
catch( const std::exception & ex ) {
   std::cerr << "Could not convert to int - reason is " 
                  << ex.what();
} 
```

不幸的是，C++ 标准没有指定抛出的异常包含任何错误消息，因此您在此处处于特定于实现的领域。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-08T13:05:10.953

简短的回答：没有。即使在各种操作`errno`之后检测到故障（例如使用`bad()`, `fail()`）后进行检查也不能可靠地工作。创建`ifstream`/`ofstream`包装一个无法打开的文件不一定会设置失败位，直到您尝试读取、写入或关闭它。

长答案：您可以调用`ios::exceptions(ios_base::iostate)`请求`ios_base::ios_failure`在设置相应位（badbit、failbit、eofbit）时抛出异常，但这（至少在 GNU 和 Microsoft C++ 库上）并没有为您提供比手动检查更多的信息位，最终在很大程度上毫无意义，恕我直言。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-16T18:19:59.817

通过检查，我发现`errno`也`GetLastError()`确实设置了最后一个错误并检查它们非常有帮助。要获取字符串消息，请使用：

```
strerror(errno); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-11-05T19:07:43.247

如果您正在寻找比所提供的更详细的消息，[`std::ios_base::failure`](https://en.cppreference.com/w/cpp/io/ios_base/failure)那么这里是一个[`errno`](https://en.cppreference.com/w/cpp/error/errno)用于*重新引发*a的示例[`std::system_error`](https://en.cppreference.com/w/cpp/error/system_error)：

```
terminate called after throwing an instance of 'std::system_error'
  what():  broken/path: No such file or directory 
```

```
#include <fstream>

int main() {
  const std::string filename{ "broken/path" };
  try {
    std::ifstream file{ filename };
    file.exceptions(std::ios::failbit); // std::ios_base_failure is thrown here
  } catch (std::ios_base::failure&) {
    throw std::system_error{ errno, std::generic_category(), filename };
  }
} 
```

这适用于 UNIX 和 Windows，因为“所有`errno`值都是…… UNIX-compatible”（[来源](https://docs.microsoft.com/en-us/cpp/c-runtime-library/errno-doserrno-sys-errlist-and-sys-nerr?view=msvc-160)）。

如果您想要*更具体的*Windows 错误代码（即*文件已在另一个程序中打开*），您应该查看特定于平台的`GetLastError()`api 而不是`errno`.

# primary-key - 抄表+新PK

> ID：839647
> 
> 赞同：0
> 
> 时间：2009-05-08T12:50:10.257
> 
> 标签：primary-key

我有一张没有PK的桌子。该表大约有 500 行，所以我不想手动编写它们。添加PK的最佳方法是什么？

谢谢，

拉法

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-08T12:51:37.490

```
ALTER TABLE T ADD PkColumn INT NOT NULL IDENTITY
ALTER TABLE T ADD CONSTRAINT PK_T PRIMARY KEY (PkColumn) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T12:52:04.277

嗯.. 读取所有记录并将它们插入到带有 PK 的新表的简单程序？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T12:58:57.537

```
ALTER TABLE CurrentTable ADD pkNewColumn INT IDENTITY (1,1) NOT NULL
ALTER TABLE CurrentTable ADD CONSTRAINT PK_pkNewColumn PRIMARY KEY (pkNewColumn) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-08T12:59:11.403

取决于您是添加将作为主键的新列，还是要将现有列指定为主键。要修改现有列：

创建当前表的克隆，并使用

插入备份表（COLA，COLB，COLC）从表中选择COLA，COLB，COLC；

然后使用主键重新创建原始表，并使用与上述类似的 SQL 语句将备份表复制到原始表中。

# c - 为什么可以定义具有超类类型的变量，但将其分配给子类的对象？

> ID：839664
> 
> 赞同：1
> 
> 时间：2009-05-08T12:54:52.007
> 
> 标签：c, objective-c

这对我来说还不是很清楚。例子：

NSArray *arr = [[NSMutableArray alloc] init];

我的意思是......是的，它有效。但是：为什么我可以告诉编译器“嘿，我的 var 只是一个 NSArray，你只需要保留空间以便它适合那里”然后，实际上，在那个地方有一个大而胖的 NSMutableArray更多的方法，更多的实例变量，只是需要更多的空间。我的意思是……这怎么可能？

我会理解另一种方式：左侧是大胖 NSMutableArray，右侧是小 NSArray。据我了解，超类总是比子类更小、更简单。子类可能会覆盖一些东西，但它也可能会添加一些东西。对？

想象一下你买了一个车库，因为你的妻子在电话里告诉你她买了可以开车的东西。那么，它就不像你想象的那样只是一辆小型车。她买了一辆大卡车。它不适合在那里。

那么我必须如何思考这个问题，才能把它记在脑海里呢？;)

这转到社区 wiki，以防其他人也感到困惑。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-08T12:59:01.950

对象大小与它无关，因为赋值只分配一个**引用**（可能将其视为内存地址）。参考大小是固定的，与对象大小无关。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-08T13:18:40.920

我相信你犯错的关键点是变量包含对象并且编译器为它们保留空间的信念。

在 Objective-C 中，就像在 Java 中一样，变量只包含对对象的引用——编译器的参与到此为止。对象本身位于称为堆的内存区域中，由运行时维护。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-08T13:23:22.143

在您的示例中，子类的大小无关紧要，因为您正在为堆上的大胖子类分配内存，然后将指向它的指针存储在指向超类的指针中。

为了纠正你的类比，你告诉某人建造一个足够大的车库来放你妻子的车。你所做的就是指出那个车库在哪里。您可能指向一个大车库或一个小车库，这对您来说并不重要，因为您只是将您的妻子指向车库所在的位置，其他人负责确保车库足够大。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-08T13:38:14.040

在我看来，您对此的两个方面感到困惑。一个与空间分配有关，许多其他答案已经解决了这个问题。总而言之，在面向对象的系统中声明引用不会分配空间来保存该类型的对象，它只是分配空间来保存指针。

您似乎感到困惑的另一个问题是类型在面向对象系统中的实际含义。

> 我会理解另一种方式：左侧是大胖 NSMutableArray，右侧是小 NSArray。

将任何类视为由两个独立的事物组成：接口，它是它公开的一组方法和成员，以及一个实现，它确定对这些方法和成员的访问实际上会做什么。

当您声明对 NSArray 的引用时，这意味着该引用将指向支持与 NSArray 相同接口的对象。因为 NSMutableArray 是 NSArray 的子类，所以 NSMutableArray 的实例将始终支持 NSArray 的接口。因此，分配是安全的。

相反，如果您声明对 NSMutableArray 的引用，它必须指向支持子类接口的对象。因此，您不能将指向 NSArray 实例的指针分配给该变量，因为 NSArray 不支持 NSMutableArray 的完整接口。（在弱类型系统中，如果您尝试调用存在于接口中但不存在于实例化对象中的方法，则可能会执行分配，但随后会出现运行时错误。我不知道目标的强类型C 是。）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-08T13:00:57.093

在更强类型的语言中，将指向子类对象的指针存储在已声明为指向基类的指针的变量中是完全正常的。但是，您不能访问任何子类的方法或成员变量。

Objective-C 的类型不是很强，尤其是 wrt 消息调用，其中 (AFAICR) 没有类型检查，如果无法处理请求的消息，则会出现运行时错误或无操作。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-08T13:06:03.853

您忘记了类型系统。NSArray 是一个框架类，而不是语言原语。运行时系统正在维护一些信息。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-08T13:16:08.150

您说得对，子类通常比父类占用更多空间。然而，这不是问题，因为子类根本没有真正存储在数组中——唯一存储在数组中的是对实际对象的引用，它们总是具有相同的大小。

使用你的类比，假设你有许多车库，你的妻子在那里有她的汽车。显然，这些车的尺寸不同，但这并不妨碍您列出每辆车的数量（您妻子的第一辆车被标记为 1，接下来是 2）以及该车目前停在哪里（您妻子有这么多您必须为自己的停车场编号的汽车）。这些汽车有不同的尺寸和不同的型号，但您仍然可以将它们全部写在清单上，它们仍然都是汽车，因此它们有一些共同点（例如，您可以驾驶它们，每辆都获得如此多的 mpg）。

面向对象编程的好处之一是子类可以用来代替它们的超类。

# c# - Silverlight 3 - TreeView：滚动到特定项目

> ID：839666
> 
> 赞同：2
> 
> 时间：2009-05-08T12:54:58.997
> 
> 标签：c#, silverlight-3.0, treeview

在 Silverlight 3 中，我有一个 TreeView 绑定到我的 ViewModel 中的 ObservableCollection。这些项目使用分层数据模板进行格式化。从 WebService 填充集合并且 TreeView 显示该集合时，它会滚动到列表的底部。

我将如何寻找可能在层次结构中的任何地方的特定项目？更重要的是，我如何将该项目滚动到 TreeView 控件的中间或顶部？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-11-26T13:35:52.207

要使用 Toolkit Treeview 执行此操作，您必须编写附加的行为 - 抱歉对这些不够熟悉以提供帮助。

但是，您可以使用 Telerik 树视图控件开箱即用地执行此操作，该控件具有称为**“带入视图”**的功能。

有关此功能的详细信息，[请访问 http://www.telerik.com/help/silverlight/radtreeview-features-treeviewitem-bring-into-view-support.html](http://www.telerik.com/help/silverlight/radtreeview-features-treeviewitem-bring-into-view-support.html)。缺点是这个控制不是免费的:-(

# c++ - 我应该多担心英特尔 C++ 编译器为 AMD 发出次优代码？

> ID：839667
> 
> 赞同：28
> 
> 时间：2009-05-08T12:55:00.010
> 
> 标签：c++, optimization, compiler-construction, intel, amd-processor

我们一直是一家英特尔商店。所有开发人员都使用 Intel 机器，最终用户推荐的平台是 Intel，如果最终用户想在 AMD 上运行，那是他们的了望。也许测试部门在某处有一台 AMD 机器来检查我们没有运送任何完全损坏的东西，但仅此而已。

直到几年前，我们还只使用了 MSVC 编译器，因为它并没有真正提供很多超出 SSE 级别的处理器调整选项，所以没有人担心代码是否会偏向一个 x86 供应商而不是另一个供应商。然而，最近我们一直在使用英特尔编译器。我们的东西肯定会从中获得一些显着的性能优势（在我们的英特尔硬件上），它的矢量化能力意味着更少需要去 asm/intrinsics。然而，人们开始对英特尔编译器是否实际上可能没有为 AMD 硬件做得这么好感到有点紧张。当然，如果您进入英特尔 CRT 或 IPP 库，您会看到很多 cpuid 查询显然设置跳转表以优化功能。不过，英特尔似乎不太可能为 AMD 芯片做任何好事。

在这方面有任何经验的人可以评论这在实践中是否重要吗？（我们自己实际上还没有对 AMD 进行任何性能测试）。

**2010-01-04 更新**：嗯，支持 AMD 的需求从未变得足够具体，以至于我自己无法进行任何测试。[这里](http://arstechnica.com/hardware/reviews/2008/07/atom-nano-review.ars/6)有一些关于这个问题的有趣读物，[这里](http://www.agner.org/optimize/blog/read.php?i=49)和[这里](http://www.brightsideofnews.com/print/2009/12/17/why-the-ftc-lawsuit-against-intel-has-substance.aspx)。

**2010-08-09 更新**：似乎 Intel-FTC 的解决方案对这个问题有话要说 - 请参阅[本文](http://www.semiaccurate.com/2010/08/06/more-intel-dirt-cleaned-ftc/)的“编译器和肮脏技巧”部分。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-08T13:10:17.400

买一个 AMD 盒子并在上面运行它。这似乎是唯一负责任的事情，而不是信任互联网上的陌生人；）

除此之外，我认为 AMD 对英特尔的诉讼的一部分是基于英特尔的编译器专门生成在 AMD 处理器上运行效率低下的代码的说法。我不知道这是否属实，但 AMD 似乎相信如此。

但即使他们不故意这样做，毫无疑问，英特尔的编译器专门针对英特尔处理器进行了优化，仅此而已。

话虽如此，我怀疑它会产生巨大的影响。AMD CPU 仍将受益于编译器的所有自动矢量化和其他巧妙功能。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-08T17:08:54.410

我肯定会说显而易见的，如果性能对您的应用程序至关重要，那么您最好在硬件/编译器的所有组合上进行一些测试。没有任何保证。作为局外人，我们只能给你我们的猜测/偏见。您的软件可能具有与我们所见不同的独特特征。

我的经验：

我曾经在英特尔工作，并开发了一个性能至关重要的内部 (C++) 应用程序。我们尝试使用 Intel 的 C++ 编译器，但它**总是**表现不佳 - 即使在运行配置文件后，使用配置文件信息重新编译（icc 据称用于优化）并在完全相同的数据集上重新运行（这是在 2005-2007 年） ，现在情况可能有所不同）。因此，根据我的经验，您可能想尝试 gcc（除了 icc 和 MSVC），这样您可能会获得更好的性能并回避这个问题。切换编译器应该不会太难（如果你的构建过程是合理的）。

现在我在另一家公司工作，IT 人员进行了广泛的硬件测试，有一段时间英特尔和 AMD 的硬件相当，但最新一代的英特尔硬件明显优于 AMD。因此，我相信他们购买了大量的英特尔 CPU，并向运行我们软件的客户推荐相同的 CPU。

但是，回到英特尔编译器是否专门针对 AMD 硬件运行缓慢的问题。我怀疑英特尔会为此烦恼。某些使用有关英特尔 CPU 架构或芯片组内部知识的优化可能会在 AMD 硬件上运行得更慢，但我怀疑它们专门针对 AMD 硬件。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-01-05T17:02:46.067

我们所看到的是，无论英特尔编译器必须对可用指令集做出运行时选择，如果它不能识别英特尔 CPU，它就会进入他们的“标准”代码（正如您所料，这可能不是最佳的） ）。

请注意，即使我在上面使用了“编译器”这个词，这也主要发生在它们提供的（预编译的）库和检查指令集并调用最佳代码的内部函数中。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-11T11:51:21.613

对不起，如果你按了我的通用按钮。

这是关于低级优化的主题，因此仅对 1) 程序计数器花费大量时间和 2) 编译器实际看到的代码很重要。例如，如果 PC 将大部分时间花在您不编译的库例程中，那么它应该不是很重要。

无论条件 1 和 2 是否满足，以下是我的优化经验：

进行了几次采样和修复迭代。在这些中的每一个中，都会发现一个问题，并且通常与程序计数器的位置无关。而是在调用堆栈的中层存在函数调用，由于性能至关重要，因此可以替换它们。[为了快速找到它们，我这样做了。](https://stackoverflow.com/questions/375913/what-can-i-use-to-profile-c-code-in-linux/378024#378024)

请记住，如果有一个函数调用指令在堆栈上的大部分执行时间，无论是在几个长调用中还是在许多短调用中，该调用都对那部分时间负责，因此删除它或不经常执行它可以节省大量时间。而且，这种节省远远超过任何低级优化。

该程序现在可以比开始时快 *很多倍。**我从未见过任何大型程序，无论编写得多么仔细，都不能从这个过程中受益。* 如果该过程尚未完成，则不应认为低级优化是加快程序速度的唯一方法。

在这个过程完成到根本无法再完成之后，如果样本显示 PC 处于编译器看到的代码中，那么低级优化可以产生影响。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-02-10T00:45:30.487

在此线程启动时，Microsoft C++ 默认使用代码生成，这在某些情况下对 AMD 有利而对 Intel 不利。他们最近的编译器默认使用对两者都有好处的混合选项，特别是在两个品牌的 CPU 都解决了它们特有的性能错误之后。当我第一次在英特尔工作时，他们的编译器为英特尔特定的架构设置保留了一些优化。我想这可能是一些 FTC 证词的主题，尽管在我 10 小时的证词中没有出现，而且由于最新 CPU 模型和需要更高效地利用编译器开发时间。如果您在最新的 Intel CPU 上使用这些过时的编译器之一，您可能会看到一些相同的性能缺陷。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-07-14T15:02:27.200

如果你不能采取行动，那么担心是没有意义的。可能的措施是：不购买 AMD，或使用不同的编译器。所以显而易见的事情是：

（1）买一台AMD盒子，用Intel编译器测一下代码编译的速度。速度够快吗？如果是，你就完成了，你可以购买 AMD，别担心。

(2) 如果否：使用不同的编译器编译代码并在 AMD 机器上运行。速度够快吗？如果没有，你就完了，你不能买 AMD，别担心。

(3) 如果是：在 Intel 机器上运行相同的代码。速度够快吗？如果是，你就完成了，你可以购买 AMD 但必须切换编译器，不用担心。

(4) 如果不是：可能的情况是：不要购买 AMD，将所有 Intel 计算机扔掉，或者使用两种不同的编译器进行编译。选一个。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2015-09-29T22:17:26.387

当供应商试图阻止 Lotus 产品在他们提供之前进入市场时，我直接经历了有目的的技术瘫痪。有一种可行的技术可用，但 Lotus 被禁止使用它。呃，好吧...

几年前，有一些博客向用户展示，在英特尔编译器中修补单个字节会导致它发出在 AMD 上使用时不会被削弱的“最佳”代码。我已经好几年没有寻找那些博客条目了。

我倾向于相信这种竞争行为仍在继续。我没有其他证据可以提供。

# solaris - mmap 会使用用户 cpu 而不是整个 sys cpu 吗？（太阳能）

> ID：839668
> 
> 赞同：1
> 
> 时间：2009-05-08T12:55:30.447
> 
> 标签：solaris, cpu, mmap

在使用 mmap 分配一些匿名 mem 时，我们通常将起始地址设置为 0/null，因此 mmap 会自行计算起始地址。为了获得起始地址，它会在整个虚拟内存空间中找到一个可以分配内存卡盘的孔。我想这是作为用户 cpu 而不是 sys cpu 计算的。如果虚拟内存是碎片化的，那么找起始地址的时候会占用更多的用户cpu，我的理解是否正确

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-08T13:15:29.370

我不认为这是正确的。在 mmap 系统调用中花费的时间计为系统时间。不过，找到足够大的地址空间窗口并设置映射的时间应该是微不足道的。

# iphone - 何时在 iPhone 上使用 OpenGL

> ID：839677
> 
> 赞同：0
> 
> 时间：2009-05-08T12:57:22.080
> 
> 标签：iphone, opengl-es

什么时候在 iPhone 上使用 openGl-es 和其他工具包比较合适？我一直在学习使用它，突然觉得它可能对我的想法有点过头了。对于像二十一点游戏这样的游戏来说，这是一个不错的选择吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T13:01:48.560

考虑到纸牌游戏具有一组固定且静态定义的图形元素（即，一组标志性图像就可以了），这可能有点矫枉过正。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T13:03:44.560

你应该阅读这个问题：

[iPhone 上的大多数游戏都是用 OpenGL ES 完成的吗？](https://stackoverflow.com/questions/747672/are-most-games-on-the-iphone-done-with-opengl-es/747743#747743)

一般来说，OpenGL ES 是高度优化的，不会有太多的开销，您应该将`CoreAnimation`其视为更简单、更抽象的选项。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-08T13:18:37.707

好吧，如果您想让 3D 动画卡片平滑地在屏幕上翻转而不是静态移动卡片，那么是的，使用 OpenGL ES。如果您想学习有关 3D 编程或矢量数学的知识，也可以使用它。当然，二十一点游戏并不是最先进的，但您可能想要一个比 Windows Solitaire 更华丽的 UI。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-23T02:07:12.283

还考虑到如果您构建一个通用框架（例如 OpenGL ES），您还可以将游戏移植到其他支持 OpenGL ES 的手机上，并且它不会依赖于 iphone...

# svn - 如何从复杂的 subversion 存储库迁移到分布式版本控制系统？

> ID：839683
> 
> 赞同：2
> 
> 时间：2009-05-08T12:58:04.513
> 
> 标签：svn, git, mercurial, dvcs, bazaar

假设我们有一个 subversion 存储库，它看起来像

```
/original/0.1
/original/0.2
/variantA/trunk
/variantA/branches/who/branch_for_xxx
/variantA/branches/she/branch_for_yyy
/variantB/trunk
/variantB/branches/who/branch_for_zzz
(... 30 or 40 alike) 
```

其中 variantA 和 variantB 是原始软件的分支。

我正在寻找一种将此存储库迁移到分布式版本控制系统中的方法：一种方法

*   不一定只有一个命令
*   适用于任何一种著名的分布式版本控制系统
*   让 dvcs 想到它们的分支：/official/{0​​.1,0.2} 树，/variantA/trunk 树，...
*   让 dvcs 知道这些树的继承关系

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-26T15:04:56.713

Mercurial 带有一个转换扩展，它应该可以满足您的需求。请参阅[Mercurial 网站上的转换扩展详细信息。](http://www.selenic.com/mercurial/wiki/ConvertExtension)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-08T16:39:37.710

对于 Git，请参阅[http://github.com/guides/import-from-subversion上的说明](http://github.com/guides/import-from-subversion)

上次我手动执行此操作时，我使用了以下命令。（这是针对不使用标签或分支的项目。如果您有标签或分支，使用[svn2git](http://github.com/nirvdrum/svn2git/tree/master)可能会产生比 git-svn 更好的结果。）

```
cat "mysvnusername = Me Myself <me.myself@somewhere.com>" >> authors.txt

svnserve --daemon --foreground --root <SVN-REPO-PARENT-DIR>
git svn clone --stdlayout --authors-file=authors.txt --no-metadata svn://localhost/<SVN-REPO-NAME>

# push to a public repo and clone from there, to get push/pull working easily
cd <SVN-REPO-NAME>
git remote add origin git@github.com:mygithubusername/<GIT-REPO-NAME>.git
git push origin master
cd ..
rm -rf <SVN-REPO-NAME>

git clone git@github.com:mygithubusername/<GIT-REPO-NAME>.git 
```

但是由于您有一个非标准的 SVN 存储库布局，您需要为[git svn clone](http://git-scm.com/docs/git-svn)指定 --trunk、--tags 和 --branches 参数而不是 --stdlayout 。

为了表示存储库的整个继承历史，您可以尝试重新排序存储库，以便您拥有标准的平面存储库布局，而不是非标准层次结构：

```
/branches/original-0.1
/branches/original-0.2
/branches/variantA-trunk
/branches/variantA-who-branch_for_xxx
/branches/variantA-she-branch_for_yyy
/branches/variantB-trunk
/branches/variantB-who-branch_for_zzz
... 
```

这应该使导入工具更容易理解存储库。然后，当它们被导入后，您可以在新存储库中更好地重新组织它们。

另外，我听说 Git 1.6.x 支持深度克隆，因此您可以提供`git svn clone`参数，例如`--branches=branches/*/*`可以深入查看分支层次结构的参数。有关使用它的示例，请参见[这篇文章。](https://stackoverflow.com/questions/572893/cloning-a-non-standard-svn-repository-with-git-svn/573619#573619)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T16:35:59.060

如果您将**[Git](http://git-scm.com/)**视为可能的 DVCS 候选者，那么 ruby​​ 脚本**[svn2git 可以满足](http://github.com/nirvdrum/svn2git/tree/master)**您的需求。

问题中的更多详细信息：[**Cloning a Non-Standard Svn Repository with Git-Svn**](https://stackoverflow.com/questions/572893/cloning-a-non-standard-svn-repository-with-git-svn/572898#572898)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-08T17:05:14.357

$ bzr svn-import --layout trunk1 *svn-root-url* bzr.repo

应该做正确的事。您需要安装 bzr-svn 插件才能执行此操作。

# wcf - 为什么 WCF 在作为 Web 服务托管时不能“正确”使用/公开抽象类型

> ID：839696
> 
> 赞同：9
> 
> 时间：2009-05-08T13:01:59.120
> 
> 标签：wcf

我设计 Web 服务已经有一段时间了，但直到最近才不得不公开一个“复杂”的 WCF 服务。我对 WCF 中明显缺乏对抽象类型的“适当支持”感到困惑。当然 - 你可以使用它们 - 确保你可以让它们“工作”......你只是没有得到你想要的东西......

第一个问题是，如果您从具有抽象类型的 wsdl 生成代码，您将获得截然不同的代码，因为它回退到 xmlserializer 而不是 DataContractSerializer。这显然有点不理想......我想使用花哨的新更快的序列化程序，谢谢......（以及Service / DataContract附带的所有内容）

另一方面 - 如果您首先从代码开始并将正确归因的抽象 wcf 类公开为 Web 服务，则公开的 wsdl 不包含使“抽象类”在技术上具体的抽象 =“真”属性......这不是我想要的当然...

我有一个解决方法，但它涉及大量的“黑客”，我首先创建 wsdl/xsd 合同，删除任何 abstract="true"（哦 - 更不用说我不能在 xsd 中使用属性应该我们），然后 svcuitl 结果...但是现在我留下了具有具体抽象类的 ac# api，然后我需要去修改它以添加抽象关键字...这“有效”但它是一个巨大的皮塔饼-而且不容易“编写脚本”...

这一切都被击垮了！我希望有人能准确地向我解释'为什么'这是......我欢迎不引用“可靠”资源的答案，但我真的在等待这个人告诉我 - 有适当的文档（比如最好来自好老唐·博克斯本人）为什么会这样……因为我就是不明白……

谢谢大家-如果有人想了解更多详细信息-请告诉我！

更新以添加示例请求 - 从 c# 开始

```
[ServiceContract]
public interface IShapeTest
{
  [OperationContract]
  AbsShape EchoShape(AbsShape shape);
}

public class ShapeTestImpl : IShapeTest
{
  public AbsShape EchoShape(AbsShape shape)
  {
    return shape;
  }
}

[KnownType(typeof(Square))]
public abstract class AbsShape
{
  [DataMember]
  public int numSides;
}

public class Square : AbsShape
{
  public Square() : base()
  {
    numSides = 4;//set the numSides to 'prove' it works
  }
} 
```

预期类型：

```
<xs:complexType name="AbsShape" abstract="true"> <!--NOTE abstract="true"-->
  <xs:sequence>
    <xs:element minOccurs="0" name="numSides" type="xs:int"/>
  </xs:sequence>
</xs:complexType> 
```

实际发射类型：

```
<xs:complexType name="AbsShape"> <!--NOTE the lack of abstract="true"-->
  <xs:sequence>
    <xs:element minOccurs="0" name="numSides" type="xs:int"/>
  </xs:sequence>
</xs:complexType> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-15T11:43:01.213

嗯，这是因为 WCF 不传递对象，它传递*消息*。这不是远程处理，因此客户端上的类型与服务器上的类型不同 - 它只是各种属性的持有类。实现“abstract="true" 根本没有意义。消息只是数据 - 客户端如何知道要使用的具体类型，因为您不共享类，而只是消息的表示。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-15T11:53:31.530

“抽象”是一个实现细节。它在服务合同中没有位置。自然，一旦您坚持要求您的调用者必须知道您正在返回一个抽象类型，WCF 就必须求助于可以公开这一事实的序列化程序：而您又回到了使用 XmlSerializer 的困境。

我怀疑您正在使用抽象，因为这是 OO 做事的方式。但是您不是在做 OO，而是在做 Web 服务——SOA。有区别。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-08-16T20:40:53.270

这个问题的前提是WCF应该将一个抽象属性设置为true的XSD complexType元素映射为一个C#抽象类。如果您查看[有关未来可扩展性的 WSDL 规范，](http://www.w3.org/TR/wsdl20/#eii-extensibility)您将看到一个示例，说明该规范如何使用此 XSD 特性来允许添加“元素项”，而无需修改 WSDL 规范本身。

XSD 抽象属性的目的是允许其他 XSD“类型”从基本类型继承定义。这可能听起来像@dovholuk 正在寻找 WCF 做的事情，但实际上它是 XSD 类型定义的设备。此 XSD 功能与将 XML 序列化为 C# 类构造无关，因为它旨在**在**XSD 定义中使用。因此，总结@blowdart 和@JohnSaunders，WCF 是对消息交换的抽象，其中基于 XSD 的类型定义是实现细节。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-01-11T03:43:42.883

当您使用 Java EE 时，抽象类型的属性“abstract=true”以及类型的继承会保留在 WSDL 中。WSDL 和 XSD 中保留了对象模型中对传统 Java 关键字（如“抽象”或“扩展”）的任何使用。不需要特殊属性或修改。

WCF 服务无法在 WSDL 中生成抽象属性。WCF 也无法遍历对象模型继承，需要使用 KnownTypeAttribute 才能使正确的 XSD 继承产生 WSDL。

然而，WCF 客户端将从将某些类型描述为抽象的服务生成 WSDL 的抽象类型，并保留任何类型的继承（例如，使用 Visual Studio 中的“服务参考”将客户端设置为 Java EE 服务） .

因此，WCF 尊重在 WSDL 中为客户端代理定义的抽象类型，但它不会在服务中为 WSDL 创建创建抽象类型（可能不需要特别注意，例如继承所需的 KnownTypeAttribute）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-05-03T06:46:33.123

使用 [XmlSerializerFormat] 属性

# c# - 我是否需要为开源项目保护我的强名称密钥文件？

> ID：839697
> 
> 赞同：14
> 
> 时间：2009-05-08T13:02:36.793
> 
> 标签：c#, open-source, gac, assembly-signing

我正在创建一个入门工具包，它将来自开源项目的已编译程序集安装到 GAC 中，以便更轻松地在模板中引用程序集。由于他们要加入 GAC，因此需要签署。

我是否需要密码保护和保护密钥文件，或者是否可以将其保持打开状态并将文件包含在源代码管理中？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-08T13:16:12.300

强名称签名有几个目的（尽管*不是*为了防止篡改程序，这是常见的误解） - 在您的情况下，使用强密钥来唯一标识（和验证）特定程序集的特定版本，即GAC 要求。在这种情况下，防止其他程序集欺骗的另一种用法似乎没有必要（如果我错了，请纠正我）。出于这个原因，我认为让密钥保持打开状态（不受密码保护）并将文件包含在源代码控制中是完全可以接受的。据我所知，您不会通过密码保护密钥来阻止任何您不想要的东西。（但是，如果您可以提供有关安全上下文的更多详细信息，我可能不得不修改该视图。）

此外，请参阅[这篇 MSDN 文章](http://msdn.microsoft.com/en-us/magazine/cc163583.aspx)，详细了解如何正确使用强名称签名。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-08T13:16:40.927

我想说在源代码控制中包含一个“开发”密钥，以使构建更容易，并避免强迫人们花时间创建和使用自己的密钥。源代码控制中的密钥在安全方面毫无意义，因为任何人都可以使用它签名。如果人们想要签署他们构建的开源项目，他们可以替换他们可以以任何他们喜欢的方式管理的密钥。

您还可以提供用于下载的构建，并使用安全密钥（您不给任何人）签名，但是对于想要使用这些二进制文件的人来说，他们需要信任您。你值得信赖吗？:)

# mysql - 总和直到某个点 - MySql

> ID：839704
> 
> 赞同：8
> 
> 时间：2009-05-08T13:05:11.780
> 
> 标签：mysql, sum

如何查询和显示记录直到达到一定数量？

假设你要选择学生，直到学生的钱总和达到1000？

## 添加

```
 Student ID   Student Name   Student Money 
 ---------    -----------     --------------
   1           John            190
   2           Jenny           290
   3           Ben             200
   4           Andy            120
   5           Lynna           300 
```

如果我想停在 500，我会得到记录号 1 和 2 (190 + 290)。如果我想停在 1000，我会得到记录 1 到 4。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2011-07-26T20:18:45.100

在寻找我自己的答案时遇到了这个问题。我想我会把我的解决方案留在这里，因为它是完成相同任务的另一种方式，并且可能更有效。诀窍是使用自我加入`>=`

```
 SELECT s1.ID, s1.name, s1.money, sum(s2.money) as accumulator
    FROM student s1 
    INNER JOIN student s2 ON s1.id >= s2.id 
    GROUP BY s1.id HAVING accumulator <= 500; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-08T13:17:57.787

SQL 表没有“内在”顺序，因此您必须指定一些 ORDER BY 子句以赋予该“直到”短语任何含义。鉴于此，可以使用 SELECT SUM(money) FROM student ORDER BY xxx LIMIT N 获得“第一”N 条记录的总和。使用具有自然顺序整数的辅助表 INTS，您可以找到最合适的N 通过类似的东西：

```
SELECT MAX(N) FROM INTS
WHERE (SELECT SUM(money) FROM student ORDER BY xxx LIMIT N) < 1000 
```

最后将其作为另一个嵌套 SELECT 插入到整个 SELECT 中的 LIMIT 子句中。不过，所有这些闻起来都会相当低效！通常，当嵌套的 SELECT 看起来太多且太慢时，另一种方法是逐步执行此操作：首先使用“渐进总和”构建一个临时表，然后使用它来帮助您找到所需的限制。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-08T14:27:28.917

**糟糕... MySQL ...此解决方案适用于 MS SQL ...**

这是使用 ROW_NUMBER() 函数的解决方案。

```
SELECT Student.*, SUM(StudentBefore.Money) AS AccumulatedMoney  
FROM (  
       SELECT *, ROW_NUMBER() OVER(ORDER BY Id) AS RowNumber  
       FROM Students  
     ) AS Student  
     INNER JOIN  
     (  
       SELECT *, ROW_NUMBER() OVER(ORDER BY Id) AS RowNumber  
       FROM Students  
     ) AS StudentBefore  
     ON StudentBefore.RowNumber <= Student.RowNumber  
GROUP BY Student.RowNumber, Student.Id, Student.Name, Student.Money  
HAVING SUM(StudentBefore.Money) < 1000 
```

执行计划表明排序表是最昂贵的操作。如果要排序的列上有索引——你的例子表明你想按主键 id 排序——索引扫描将成为最昂贵的操作。

# c++ - qt麻烦覆盖paintEvent

> ID：839705
> 
> 赞同：1
> 
> 时间：2009-05-08T13:05:26.180
> 
> 标签：c++, qt, widget, qprogressbar

我在自定义小部件中继承 QProgressBar，并使用以下代码覆盖了**paintEvent方法：**

```
 void myProg::paintEvent(QPaintEvent *pe)
{
    QProgressBar::paintEvent(pe);
    QRect region = pe->rect();
    QPainter *painter = new QPainter(this);
    QPen *pen = new QPen;
    painter->begin(this);
    painter->setBrush(Qt::red);
    int x = this->x();
    int y = this->y();
    pen->setWidth(10);
    painter->setPen(*pen);
    painter->drawLine(x,y,x+100,y);
    painter->end();

} 
```

我试图显示一条红线作为起点，以查看我可以将自己的修改添加到小部件中。但是，这是行不通的。我只将小部件视为常规 QProgressBar。关于什么可能是错的任何想法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-08T13:22:45.030

您需要使用的坐标系是相对于小部件的左上角的，但您显然使用的是相对于小部件的父级的坐标系。（小部件的 x 和 y 坐标相对于它们的父级）。所以你的线会被剪掉。

此外，当您使用 QWidget * 参数构造它时，无需调用 QPainter::begin 和 QPainter::end。而且您代码中的画家也不会被删除。没有必要在堆上创建一个画家`new`：我只是在堆栈上创建它。

尝试：

```
无效 myProg::paintEvent(QPaintEvent *pe)
{
    QProgressBar::paintEvent(pe);
    QRect 区域 = pe->rect();
    QPainter 画家（本）；
    QPen 笔（Qt::red）；//注意：像这样设置线条颜色

    //（画笔线被移除；画线时不需要）
    诠释 x = 0; //注意改变了
    int y = 高度() / 2; //注意改变了
    pen.setWidth(10);
    画家.setPen（笔）；
    画家.drawLine(x,y,x+100,y);

}

```

这应该从小部件的左中部开始绘制一条 100 像素长的红色水平线。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T13:22:10.927

只是对你写的东西的一些评论：

1.  您构建画家的`QPainter(this)`方式意味着您不需要显式调用`begin()`and `end()`，QT 会为您处理。
2.  `QPainter`考虑到这一点，析构函数永远不会被调用，这将由于所有 new s而泄漏大量内存。
3.  我很确定`this->x()`并`this->y()`返回窗口的左上角，但您仍然应该在窗口顶部看到一条 5 像素宽的红线。

设置`QPainter`s 画笔时，尝试显式使用`QBrush`构造函数，如 `painter->setBrush( QBrush(Qt::red) );`

# unit-testing - 什么是单元测试？

> ID：839709
> 
> 赞同：1
> 
> 时间：2009-05-08T13:06:40.887
> 
> 标签：unit-testing, tdd

我已经阅读了几十篇关于单元测试的文章，并且相信我只是通过上下文了解到单元测试是什么，但我想确定我是对的。以下是我对单元测试的理解。

请更正此声明：

“单元测试是一种方法，它为被测方法提供已知参数，并将被测方法的结果与预定的预期结果进行比较，当且仅当所有结果都与预期结果匹配时返回成功，否则返回失败。 "

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-08T13:15:43.127

这是[MSDN 的答案](http://msdn.microsoft.com/en-us/library/aa292197(VS.71).aspx)：

“单元测试的主要目标是获取应用程序中最小的可测试软件，将其与代码的其余部分隔离开来，并确定它的行为是否完全符合您的预期。”

您可能会发现实际上这个定义经常被拉伸并且变得更加复杂。

查看与其他测试学科相关的单元测试更有趣，例如集成测试、回归测试和手动测试（测试用例或测试场景驱动）。为了获得最佳结果，我认为结合使用测试方法很重要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T13:29:39.007

维基 说：

> ...在计算机编程中，**单元测试**是一种软件验证和确认方法，程序员可以在其中确信各个源代码单元适合使用。...

如果您想获得真正的价值，请查看[http://ayende.com/102/section.aspx/redirect/1](http://ayende.com/102/section.aspx/redirect/1) ...这里只是开始

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-08T13:53:36.937

从概念上讲，单元测试很重要，因为一组理想的单元测试将在编译时将多个、可想象的、全面的参数集断言（包括通过和失败条件）提交到代码段中，这将详细说明提交的源代码中的疏忽/缺点-代码修改。

这始终是一种很好的做法，但对于大规模应用程序来说，这是强制性的，其中一个小而广泛使用的源代码段中的编码错误可以有效地破坏应用程序。它不仅会告诉您哪些程序不正常，还会告诉您以何种方式运行。

.

*至于您的具体要求：*

“单元测试是对特定方法的编译时测试调用断言。每个调用通常利用参数来模拟真实世界/通过失败条件，并在给定测试未遵循预期结果时停止程序编译。理想地在每次编译期间，通过和失败的综合条件都被断言到给定的方法中，之后修改了代码段。”

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-08T13:12:04.277

这是一个家庭作业问题吗？您在一段中给出了一个很好的简洁定义。

当然，您可以轻松地深入研究该主题并编写有关单元测试的页面和页面。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-05-08T13:17:20.923

我会添加“这些是旨在定期运行的自动任务集，以提供对应用程序的全面覆盖。”

# sql - 理解存储过程的更好方法

> ID：839725
> 
> 赞同：0
> 
> 时间：2009-05-08T13:11:43.433
> 
> 标签：sql, sql-server-2005, stored-procedures

我试图破译存储过程的绝对怪物，但我运气不佳。是否有任何免费工具可以帮助可视化查询或至少将语法格式化为更易读的格式？

也欢迎任何提示和提示。

我使用的数据库类型是 MS sql server 2005

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-08T13:17:51.937

找到所有正在使用的表格，并为自己画一个 ERD 以便更好地理解。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-08T13:15:18.557

如果您使用的是 SQL Server，则可以查看执行计划。

如果存储过程状态不佳，您还可以使用[SQLInform 之](http://www.SQLInform.com)类的工具重新格式化存储过程。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-08T13:22:13.953

你手边有 Visual Studio 的副本吗？Visual Studio 突出显示有时有助于隔离逻辑块的语句块。如果您可以节省带宽，您可以下载（免费）[Express Edition 。](http://www.microsoft.com/exPress/download)

[如果您想要更轻量级的产品，这里](http://www.sqlserverportal.com/software/development/development.htm)有一长串产品。

对于存储过程调试技巧..我建议以下：

1.  尝试并确定声明变量的使用 - 特别是如果它们在各种查询中被引用（随时添加注释，将帮助您拼凑起来）
2.  看看你是否可以复制存储过程的各个部分，即将它分解成你可以更容易调查的块
3.  隔离任何依赖项（例如 udf）并确保您了解它们对 proc 的贡献 - 有时 udf 可能会给您提供您无法通过其他方式收集的洞察力

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-08T13:31:56.943

通常它可以帮助手动运行存储过程的各个部分。这需要一些工作，但可能会有所帮助。

首先通过删除 sproc 声明并声明和初始化每个需要的参数，将存储过程变成标准 sql。

运行 sproc 的增量部分，并检查结果以了解发生了什么。通过打印变量或临时表来做到这一点，或者只是通过修改屏幕输出而不是临时源来实现。

并确保你记录/拆分/重写你最终找到的东西——你不希望其他人也必须这样做，对吧？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-08T13:45:58.017

它有什么可怕的？它是一个巨大的陈述，许多连续的陈述，还是陈述的许多条件分支？对于非常大的复杂语句，我认为将子查询拉到 CTE 中可以简化可读性。如果有许多语句或条件分支，将处理单元拉出到怪物 sproc 调用的其他 sproc 会很有帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-08T13:59:04.397

如果有很多循环和/或 IF/ELSE，请添加许多“PRINT 'Loop/IF XY'”，其中 X 是您选择的唯一 Loop/IF 名称/编号，Y 是该 Loop/IF 中的唯一位置。然后从管理工作室运行程序。这将使您快速了解程序的运行流程。

您可以扩展这个想法，并在过程中的各个位置输出局部变量及其值、行数等，以了解发生了什么。

如果您不确定如何手动运行它，因为您不知道要使用哪些参数，请捕获参数。在程序的第一行插入日志表：

```
INSERT INTO YourLogTable
    VALUES ('EXEC YourProcedureName @Param1='+COALESCE(''''+convert(varchar,@Param1)+'''','NULL')+', @Param2='+COALESCE(''''+convert(varchar,@Param2)+'''','NULL')) 
```

然后，您可以运行您的应用程序来调用该过程，然后从日志中剪切/粘贴并手动运行该过程。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-08T14:08:18.757

我同意埃普兹的观点。“滚动你自己的”图表将帮助您更好地理解该过程。我发现这个工具非常有用：http: [//www.aivosto.com/visustin.html](http://www.aivosto.com/visustin.html)

# c++ - 使用 CDatabase，我可以在不使用 CRecordSet 的情况下发送 SQL 吗？

> ID：839739
> 
> 赞同：0
> 
> 时间：2009-05-08T13:16:00.163
> 
> 标签：c++, mfc, odbc

在使用 MFC 类 CDatabase 连接数据源时，有什么方法可以在不打开 CRecordSet 对象的情况下执行 SQL 语句？我之所以问是因为 CRecordSet::Open() 在我使用它来调用不返回任何内容的存储过程时似乎会引发异常 - 并且没有理由期望来自 sp `_`delete`_`行的结果。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T02:50:33.763

我使用 CDatabase::ExecuteSQL()

```
CDatabase database;
//database is connected somewhere
database.ExecuteSql("Drop table [users]");  // sql statement from little Johnny Drop tables 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-10T17:14:58.393

您可以直接执行 CCommand 来执行标量查询。

# sql - SQL-Server 表中最后添加的记录

> ID：839748
> 
> 赞同：0
> 
> 时间：2009-05-08T13:17:32.093
> 
> 标签：sql, sql-server

是否可以在不使用日期时间列的情况下查看何时在 SQL 表中插入记录？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T13:24:34.463

不。sql server 没有开箱即用的这个功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T13:26:23.477

如果您使用 SQL Server 2008，您可以查看[Change Data Capture](http://msdn.microsoft.com/en-us/library/bb522489.aspx)，这是一种新的审计功能，我想会有这个功能。

~~另一种可能性是在表上放置一个标识列。然后你可以按列降序排序。~~

您也可以尝试[DBCC Log](http://searchsqlserver.techtarget.com/tip/0,289483,sid87_gci1173464,00.html)命令。我不知道这是否会给你想要的东西，可能需要一些工作才能让它达到你可以解释它给你的数据的地步。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-08T13:35:00.633

IF you want to see meta data such as date inserted or updated you need to set this up. The easiest way to see the inserted date is to add a date inserted column. The more difficult way is to add auditing (which frankly every production system that contains business critical information should have anyway). This can involve triggers or an outside auditing system or change data tracking in SQL Server 2008, but none of those methods are set up automatically and you cannot use them to look up data added before you set up a a system. If someone recently added a record, you might be able to tell when it was added from the transaction log using a tool that reads the logs, but this an expensive way to go usually and it still wouldn't tell you who added the record which most auditing solutions would.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-08T13:21:55.000

是的，如果您使用的 dbms 具有日志功能并且您已启用该功能。然后您可以查询系统日志表。oracle 有类似的东西，默认情况下是启用的。如果您使用的是 sqlserver，我认为您必须启用日志记录机制。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-08T13:28:03.677

我知道的唯一方法是将您的备份+事务日志恢复到某个时间点。然后您可以检查行是否存在，清洗，冲洗，重复。如果这是 sql 2000，我相信那里有一些日志解析器，所以也许它们可以帮助您找到提交行的日志中的哪个点。如果是sql 2005/2008，我认为还没有日志解析器。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-08T13:28:17.420

对于 SqlServer，您需要一个 sql 日志查看器/分析器，例如 Red Gate 工具套件中的那个。

# user-interface - 面向开发人员的免费 UI 工具

> ID：839751
> 
> 赞同：6
> 
> 时间：2009-05-08T13:18:21.077
> 
> 标签：user-interface

与许多中小型商店的开发人员一样，我必须不时戴上我的设计师帽子。我真的无法证明购买 CS4 或其他设计工具之类的东西是合理的。我目前确实有一个小工具包，里面有很多有用的免费工具，比如

[油漆网](http://www.getpaint.net/)

[图标提取](http://www.nirsoft.net/utils/iconsext.html)

[彩色警察](http://colorcop.net/)

还有其他我应该检查或应该使用的好东西吗？

编辑：忘了提到我也有一些表达工具，这要归功于我的 MSDN

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-08T13:21:09.043

[Gimp](http://www.gimp.org/)有一个陡峭的学习曲线，但会比 Paint.Net 更灵活（顺便说一下，我认为它非常好）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-08T13:34:07.170

[Inkscape](http://www.inkscape.org/)是一个很棒的矢量绘图工具。

我发现它对于创建简单的徽标、网站背景和其他小的 UI 图像特别有用。

不过确实需要一点时间来适应——不是因为它的 UI 不好，只是因为使用矢量绘图与手绘以及 GIMP 和 Paint.NET 之类的东西非常不同。非常值得花时间学习 IMO 并且周围有一些很棒的教程。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-08T13:28:20.850

[IrfanView](http://www.irfanview.com/)可用于批量转换。

[ColorMania](http://blacksunsoftware.com/)作为一个非常简单的吸管/放大镜很有用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-08T13:34:22.537

我最喜欢的工具是[Inkscape](http://www.inkscape.org/ "墨景")。这是一个 SVG 绘图程序 - 因为所有绘图都是基于矢量艺术（相对于像素），您的绘图可以完美地重新缩放。此外，由于您的“作品”实际上是位置的集合，因此您可以比使用基于像素的艺术包更容易地调整图像。

不过，根据您要绘制的内容，它可能不合适。

除了使用它为我的程序生成艺术作品之外，我还使用它来模拟 UI。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-11-30T20:23:04.600

我使用[Pixlr.com](http://www.pixlr.com)。

# python - 如何在官方 Windows Python 2.5 上使用时间 > 2038 年

> ID：839755
> 
> 赞同：5
> 
> 时间：2009-05-08T13:19:17.130
> 
> 标签：python, time, python-2.5, time-t, year2038

Windows 上的官方 Python 2.5 是使用 Visual Studio.Net 2003 构建的，它使用 32 位 time_t。因此，当年份 > 2038 时，它只会给出例外。

虽然这在 Python 2.6 中已修复（使用 VS2008 将 time_t 更改为 64 位），但我想使用 2.5，因为已经为它编译了许多模块。

所以这是我的问题 - 是否有任何解决方案可以轻松让我的程序处理年份 > 2038 并且仍然使用官方 Python 2.5？例如一些预制库，如`"time64"`或“长期”等......

请不要告诉我升级到 2.6+ 或忘记这个错误 - 我有理由需要让它工作，这就是我在这里发布问题的原因。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-08T13:34:27.450

标准库中的`datetime`模块应该适合您。您需要从不提供的模块`time`中获得`datetime`什么？

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-08T13:35:51.223

我并不是说听起来老套，但为什么不：

*   忘记 Python 2.5 的 Y2038 错误
*   在 2038 年之前的某个时间点升级到 Python 2.6

**编辑：** 澄清：（我是认真的 - 我不是故意开玩笑）

假设您可以在从现在到 2038 年之间的某个不确定时间将 Python 升级到 2.6（或更高版本）。也许在 2012 年。也许在 2015 年。也许在 2037 年。

如果您知道应用程序中 Python 时间戳变量之间的差异（我不是 Python 用户），那么这些似乎是需要考虑的重要方面：

*   哪些数据被永久保存
*   如何使用 Python 2.6 恢复已持久化的 Python 2.5 时间戳变量（大概它会“做正确的事”）
*   旧数据是否会以其持久形式存储足够长的时间以产生歧义（例如，在考虑 1950 年至 2049 年之间时，“96”年是明确的，但如果该数据一直保存到 2230 年，那么“96”可能是 1996 年, 2096 或 2196)

如果答案是有利的，只需使用带有 2038 错误的常规时间戳。您必须将其与您必须做的重新设计/重构的数量进行比较，以使您的应用程序使用备用时间戳（例如数据库时间戳字符串或其他）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-12-08T09:17:53.970

我发现的最佳解决方案是获取 Python 2.5 的源代码副本，并使用默认 time_t 为 64 位的编译器重新编译 time 模块，例如 VS2005 或 VS2008（也可以配置 C 运行时以防止并行- 侧面问题）。

# java - 为什么我的 JDialogs 会泄漏？

> ID：839763
> 
> 赞同：3
> 
> 时间：2009-05-08T13:21:26.390
> 
> 标签：java, swing

我有一个 JFrame 并从中打开一个 JDialog 并从该对话框中打开另一个 JDialog - 这意味着我有 3 个可见的窗口（JFrame、JDialog1、Jdialog2）。

当我关闭两个对话框并运行垃圾收集器几次（来自 netbeans 分析器）时，我可以看到 JDialog2（从 JDialog1 打开的那个）已被垃圾收集，但 JDialog1（从 JFrame 打开）仍然挂在活动对象池中。

我每次都创建新对象 - 所以一段时间后我有一个 OutOfMemoryError 由于内存泄漏。

我是否必须以某种特殊的方式处理 JDialogs，以免它们泄漏？

顺便说一句，我`setDefaultCloseOperation(JDialog.DISPOSE_ON_CLOSE)` 在两个对话框中都这样做，

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-08T13:29:27.713

您是否在对话框中注销了所有侦听器（包括它的任何组件）？

让监听器注册可能是内存泄漏的主要来源。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-08T13:27:43.677

您的默认关闭操作是什么？从 java [JDialog](http://java.sun.com/j2se/1.5.0/docs/api/javax/swing/JDialog.html#setDefaultCloseOperation(int)) api：

> 该值`HIDE_ON_CLOSE`默认设置为。

这意味着基本上`setVisible(false)`是当用户单击关闭时调用的那个或几乎等同的那个。您观察到的行为与此一致。

尝试

```
jDialog1.setDefaultCloseOperation(JDialog.DISPOSE_ON_CLOSE) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-08T13:28:09.103

为了释放分配的资源，您必须调用 dispose 方法。仅仅隐藏对话框是不够的。

# c++ - C 接口中句柄的正确类型

> ID：839765
> 
> 赞同：17
> 
> 时间：2009-05-08T13:21:58.713
> 
> 标签：c++, c, api

我正在创建一个在 DLL 文件中隐藏某些功能的 C api。

由于内部的一切都是 C++，因此大多数函数都针对直接映射到 API 内部的 this 指针的句柄工作。

为了为这些句柄获得某种程度的类型安全，我将它们定义如下：

```
typedef struct MyType1* MyType1Handle;
typedef struct MyType2* MyType2Handle; 
```

我实际上并没有在任何地方定义 MyType1 或 MyType2 ，因为我只将它们用作指针并在 api 内部对实际指针类型进行类型转换。

我的问题是，在 Visual Studio 的 clr 项目中使用我的库时，我得到了这个`warning: unresolved typeref token (token) for 'type'; image may not run.`

[http://msdn.microsoft.com/en-us/library/h8027ys9(VS.80).aspx](http://msdn.microsoft.com/en-us/library/h8027ys9(VS.80).aspx)

这没什么大不了的，因为它有效，但它看起来不专业。

我不喜欢使用 void*：

```
typedef void* MyType1Handle;
typedef void* MyType2Handle; 
```

这使得调用需要 MyType1Handle 和 MyType2Handle 的函数成为可能，因为它们实际上是相同的类型。

我不想使用的另一种方法是这样的

```
typedef int MyType1Handle;
typedef int MyType2Handle; 
```

只要 int 和指针具有相同的大小，这将正常工作，但情况并非总是如此，而且似乎没有万无一失的方法来获取特定于平台的指针大小的整数。它也具有与 void* 相同的类型安全问题。

我尝试的另一种方法是这样做：

```
struct MyType1{};
typedef struct MyType1* MyType1Handle; 
```

这在 C 中不起作用，因为空结构是无效的 C 代码。我当然可以用一个虚拟成员扩展我的结构，但似乎应该有更好的方法来做到这一点。

所以我的问题归结为：

您通常如何以最兼容的方式指定这种类型？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-08T13:32:54.477

如果您查看 Microsoft 如何定义它的 winapi 句柄 (winnt.h)，它实际上看起来像这样：

```
struct HWND__ { int unused; }; typedef struct HWND__ *HWND 
```

事实上，他们有一个宏：

```
#define DECLARE_HANDLE(name) struct name##__{int unused;}; typedef struct name##__ *name 
```

所以..这似乎是一种常见的做法。不幸的是，除了你已经提到的这个，我无法提出其他建议，但我希望它对你有所帮助。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-12T03:05:24.347

使用不透明的结构。在许多情况下，在用 C 定义库的接口时，这是一个好主意：它提高了模块化，隐藏了不必要的细节

正如 JamieH 所说，您可以通过声明（但不定义）结构来获得不透明的结构。将指向不透明结构的指针作为参数传递到库函数中并将它们作为值返回是完全有效的。然而，库的用户不能创建或修改不透明结构的对象，因为它的大小和内容是未知的。

C 标准库和许多其他标准库已经使用这种方法，因此应该很熟悉。典型的例子是使用`FILE *`:`fopen()`创建和初始化结构并返回指向它的指针，`fclose()`清理并释放它，所有其他 i/o 函数从传入的`FILE *`.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-09T23:12:46.613

我认为您可以只声明而不是定义源结构：

> 结构 MyType1;
> 
> typedef struct MyType1* MyType1Handle;

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-12-25T13:58:39.770

类似主题： [句柄比较：空类与未定义类与 void*](https://stackoverflow.com/questions/4525847/handles-comparison-empty-classes-vs-undefined-classes-vs-void)

# eclipse - 为 Groovy/Grails 开发从 Eclipse 切换到 IntelliJ

> ID：839772
> 
> 赞同：7
> 
> 时间：2009-05-08T13:23:04.000
> 
> 标签：eclipse, grails, intellij-idea

我将从 Eclipse 切换到 IntelliJ，因为我很快就会做一些 Grails 开发（以及用于 Eclipse 的 Groovy/Grails 插件很烂）。

我已经使用 IntelliJ 几个小时了，但无法真正弄清楚如何有效地使用它。是否存在某种 Eclipse 模式，使其行为类似于 Eclipse，或者为 Eclipse 用户提供某种教程来解释两者之间的区别。

此外，关于如何使用 Grails 支持的信息似乎很少。到目前为止，我发现的只是[这个页面](http://www.jetbrains.com/idea/features/groovy_grails.html)。

谢谢，唐

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-08T16:43:04.830

您是否启用了 Eclipse 键绑定？如果您不熟悉 IntelliJ 绑定，这对生产力来说是一个福音。

为此，只需在 Preferences 面板中搜索“Keymaps”，Eclipse 就是一个下拉选项（至少这是 8.1 之前的配置方式）

您需要检查的另一件事是您是否安装了 JetGroovy 插件。这可以通过首选项的插件部分实现。

一旦到位，您的项目应该被视为 Grails 项目。

从那里您可能想要验证您的每个项目设置是否正在使用您希望它使用的 GRAILS_HOME。在 8.1 之前的模块配置中的这个配置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T17:13:00.577

关于 Eclipse 键绑定的好提示。您可能想尝试 KeyPromoter 插件 - 当您手动调用它们时，它会弹出一个带有相关键命令的窗口

我建议花一点时间阅读[Intellij-IDEA Refcard](http://refcardz.dzone.com/refcardz/intellij-idea-update)，以便更熟悉 IDE。

Hamlet D'Arcy 有一篇关于[从 Eclipse 迁移到 IntelliJ](http://hamletdarcy.blogspot.com/2008/02/10-helpful-hints-on-moving-from-eclipse.html)的好文章，还有[许多其他关于 IntelliJ 和 Groovy 支持的好文章](http://hamletdarcy.blogspot.com/search/label/IDEA)。

# direction - 如何使用 iPhone UITouch 检测手指运动方向

> ID：839773
> 
> 赞同：4
> 
> 时间：2009-05-08T13:23:19.863
> 
> 标签：direction

UITouch的文档中提到可以获取手指滑动的[B]方向[/B]。但我无法找到任何方式/参考如何获取方向信息。

[我在这里](http://nuigroup.com/?ACT=28&fid=42&aid=696_Nh3eV276ETEwxTj8C42f)找到了一个旧版本的 UITouch 类参考，其中提到了方向信息。

但是这种方式对我不起作用（我有最新的 iPhone SDK）。

你们有人试过找方向吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-01-15T21:50:02.017

苹果说你可以得到它，但在[事件处理](http://developer.apple.com/iphone/library/documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/EventHandling/EventHandling.html#//apple_ref/doc/uid/TP40007072-CH9-SW14 "事件处理")文档中，他们也明确表示你必须计算它。不过，这并不难，并且其中提供了一个示例。我只是通过缓存初始触摸点来做到这一点，并在触摸结束时确保触摸在一个方向上移动了至少 80 像素，而在另一个方向上移动了不超过长度的 75%。这给了我很好的结果，但请随意尝试你认为给出最少误报和否定的方法。

# regsvr32 - 如何修复崩溃的损坏的 regsvr32？

> ID：839775
> 
> 赞同：0
> 
> 时间：2009-05-08T13:23:34.607
> 
> 标签：regsvr32

我不知道发生了什么，但我不能再注册任何 dll。似乎 regsvr32 或一些依赖的 dll:s 已被破坏（我不认为它是病毒的东西，但当然你永远不会知道）。

我经常注册 dll 以与不同的硬件进行通信，今天我没有时间对我的电脑进行干净安装。那么，您知道修复 regsvr32 和相关 dll 的任何方法吗？

这不是一个真正的编程问题，但非常相关，因为 regsvr32 是我编程日的重要组成部分。

我得到的错误是（翻译自瑞典错误消息）：
title:regsvr32.exe - Cold not find a component
message: This program could not be started because of PSAPI.DLL could not be found。

如果单击确定，我会收到一个新错误：
title:regsvr32.exe - Cold not find a component
message: This program could not be started because of OLEACC.DLL could not be found。

在 windows32 文件夹中，我得到了 PSAPI.dll，23kB，更改为 2008-04-14 和 OLEACC.dll，160kB 更改为 2004-08-04。regsvr32.exe，30kB，于 1996 年 8 月 9 日更改。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-08T13:41:06.827

我找到了。我刚刚展开了安装盘上 I386 文件夹中的 regsvr32.ex_。

展开 regsvr32.ex_regsvr32.exe

并将展开的文件复制到 system32 文件夹，现在它又可以工作了。

# svn - SVN + 项目管理 + 维基 + 待办事项列表

> ID：839777
> 
> 赞同：7
> 
> 时间：2009-05-08T13:23:50.067
> 
> 标签：svn, wiki, todo

假设我在 linux 上有一个网络托管帐户，我希望在其上托管一个带有 wiki 的 svn 服务器、项目管理来做列表、错误等。

你能推荐我这样一个工具（如果可能的话，它拥有所有这些工具）还是我必须将它们分开放置？

您知道有关如何设置这些教程的良好链接吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-08T13:26:31.650

也许[http://trac.edgewall.org/](http://trac.edgewall.org/)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-09T10:49:14.063

另一种选择

[http://www.redmine.org](http://www.redmine.org)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-08T13:26:28.423

带有 Mylyn、mediawiki 插件和 SVN 插件的 Eclipse。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-09T10:34:05.800

[Polarion](http://www.polarion.com)有一个名为 track & wiki 的商业工具，它是一个跟踪器和一个 wiki。特殊功能是：所有内容（甚至配置！）都存储在 SVN-Repository 中。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-20T13:10:39.653

[Assembla](https://www.assembla.com/home)也是一个不错的选择。它可以管理多个项目并跟踪进度、错误、测试用例等。还有几个包。如果你不是开源开发者，也可以看看这个。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-08T14:07:49.167

我不相信你会找到任何包含颠覆的一体化安装。

很抱歉无耻地插入 Joel 自己的产品 FogBugz，但它对我们非常有效。它可以安装在 Linux 上。要求在[这里](http://www.fogcreek.com/FogBugz/docs/60/topics/setup/UnixSystemRequirements.html)。它包括项目管理、错误跟踪、wiki，并与 SVN[集成。](http://www.levelone.com/fogbugz/help/topics/advanced/Sourcecontrolintegration.html)

SVN 的安装说明取决于您的 Linux 发行版，但最好的资源是[subversion book](http://svnbook.red-bean.com/)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-08T14:09:29.847

[来自华盛顿时报的 django-projectmgr](http://opensource.washingtontimes.com/projects/django-projectmgr/)怎么样？它具有 SVN 集成、功能请求、任务、错误报告、wiki 甚至时间线。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-10-09T11:40:05.800

商业工具 Polarion 使用 OpenSource-Project XWiki 的核心。XWiki ( [http://www.xwiki.com/](http://www.xwiki.com/) ) 具有很强的可扩展性，并且具有 SVN 扩展，请参见[http://extensions.xwiki.org/xwiki/bin/view/Extension/SVN+Application](http://extensions.xwiki.org/xwiki/bin/view/Extension/SVN+Application)。

# javascript - Javascript：检查用户是否正在通过表单提交或简单的链接点击导航

> ID：839780
> 
> 赞同：2
> 
> 时间：2009-05-08T13:26:12.713
> 
> 标签：javascript, forms, navigation, onunload

我需要在用户离开页面时提醒他们一些事情，这可以通过 window.onUnload 事件来处理。但我还需要通过在页面上提交表单或单击导航链接来检查用户是否正在导航。我可以使用表单的 onSubmit 事件设置一个标志，然后在 window.onUnload 事件中检查该标志，但我不确定哪个先触发。

有任何想法吗 ？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-08T13:46:43.193

你实际上想要 window.onbeforeunload

```
window.onbeforeunload = function (e) {
  var e = e || window.event;

  // For IE and Firefox
  if (e) {
    e.returnValue = 'Are You Sure?';
  }

  // For Safari
  return 'Are You Sure?';
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T14:04:31.840

事实证明 form.onSubmit 事件首先触发，所以我可以使用一个标志。我只在 Firefox 和 Safari 中检查过这个。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-03-09T15:42:10.147

```
var isRefresh = true;
window.onunload = function () {
    alert('the page was ' + (isRefresh == false ? 'NOT ' : '') + 'refreshed');
}
$('a').live('click', function () { isRefresh = false; alert('a link was clicked'); });
$('form').bind('submit', function () { isRefresh = false; alert('form was submitted'); }); 
```

基于[如何捕获浏览器窗口关闭事件？](https://stackoverflow.com/questions/1631959/browser-window-close-event/1632004#1632004). 我添加了刷新逻辑。

# php - 我的脚本在 foreach 循环后停止

> ID：839786
> 
> 赞同：2
> 
> 时间：2009-05-08T13:26:59.123
> 
> 标签：php, foreach

我的剧本表现得很奇怪。在 foreach 循环之后，脚本停止。我没有来自 Apache 的任何错误、警告或通知。这是代码：

```
foreach($clientFact as $line)
{
    $cliTemp1[] = $line["idcliente"];
    echo "qwerty";
}
echo "123"; 
```

如果我在循环中添加一个“echo(qwerty”)”，它将显示“qwerty”，但是在循环结束后它不会做任何事情。

我错过了什么吗？！

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-08T13:48:46.713

Apache 不会将错误作为 PHP 错误返回。添加

```
error_reporting(E_ALL | E_STRICT); 
```

在您的页面顶部是一个非常好的主意，这样您就可以看到发生的每个错误。也可能是您的错误处理程序没有显示错误而只是结束脚本。

如果您的错误处理程序有问题，请添加

```
restore_error_handler(); 
```

在 error_reporting 函数之前

编辑：阅读您对数组索引的评论。如果每次都停在特定索引处，这听起来肯定像是在 PHP 中达到了内存限制。

你可以使用：

```
ini_set('memory_limit', '100M'); 
```

将您的内存限制更改为 100 兆。不推荐，但如果它有效，它的内存不足的问题。尝试重构您的程序，使其使用更少的内存

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-08T13:31:32.777

`$clientFact`上面的语法看起来不错，所以在这里在黑暗中完整拍摄 -数组有多大？数组是否有可能`$cliTemp1`变得如此之大以至于超出了内存限制？

也许不是回显“qwerty”，而是回显`$line["idcliente"]`每次迭代的内容，以确保您成功通过`$clientFact`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-08T13:32:19.377

猜测一下，您正在因循环内的错误而死，因为您的一个`$line`s 不是您期望的数组，并且错误被隐藏了。尝试`error_reporting(E_ALL)`在循环之前设置，并且可能`ini_set('display_errors', true)`.

# c# - 有没有办法只在 C# 中设置一次属性

> ID：839788
> 
> 赞同：78
> 
> 时间：2009-05-08T13:27:22.523
> 
> 标签：c#, .net

我正在寻找一种允许 C# 对象中的属性仅设置一次的方法。编写代码来执行此操作很容易，但如果存在标准机制，我宁愿使用标准机制。

```
公共 OneShot<int> SetOnceProperty { 获取；放; }

```

我想要发生的是，如果尚未设置该属性，则可以设置该属性，但如果之前已设置该属性，则抛出异常。它应该像 Nullable 值一样起作用，我可以在其中检查它是否已设置。

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2009-05-08T13:29:23.703

.NET 4.0 中的 TPL 对此有直接支持；

（编辑：上面的句子是在预期`System.Threading.WriteOnce<T>`当时可用的“预览”位中存在的，但这似乎在 TPL 击中 RTM/GA 之前已经消失了）

在那之前，请自己检查...根据我的记忆，它的行数并不多...

就像是：

```
public sealed class WriteOnce<T>
{
    private T value;
    private bool hasValue;
    public override string ToString()
    {
        return hasValue ? Convert.ToString(value) : "";
    }
    public T Value
    {
        get
        {
            if (!hasValue) throw new InvalidOperationException("Value not set");
            return value;
        }
        set
        {
            if (hasValue) throw new InvalidOperationException("Value already set");
            this.value = value;
            this.hasValue = true;
        }
    }
    public T ValueOrDefault { get { return value; } }

    public static implicit operator T(WriteOnce<T> value) { return value.Value; }
} 
```

然后使用，例如：

```
readonly WriteOnce<string> name = new WriteOnce<string>();
public WriteOnce<string> Name { get { return name; } } 
```

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2009-05-08T13:32:38.563

您可以自己滚动（有关更强大的线程安全并支持默认值的实现，请参见答案的末尾）。

```
public class SetOnce<T>
{
    private bool set;
    private T value;

    public T Value
    {
        get { return value; }
        set
        {
            if (set) throw new AlreadySetException(value);
            set = true;
            this.value = value;
        }
    }

    public static implicit operator T(SetOnce<T> toConvert)
    {
        return toConvert.value;
    }
} 
```

你可以像这样使用它：

```
public class Foo
{
    private readonly SetOnce<int> toBeSetOnce = new SetOnce<int>();

    public int ToBeSetOnce
    {
        get { return toBeSetOnce; }
        set { toBeSetOnce.Value = value; }
    }
} 
```

**下面更健壮的实现**

```
public class SetOnce<T>
{
    private readonly object syncLock = new object();
    private readonly bool throwIfNotSet;
    private readonly string valueName;
    private bool set;
    private T value;

    public SetOnce(string valueName)
    {
        this.valueName = valueName;
        throwIfGet = true;
    }

    public SetOnce(string valueName, T defaultValue)
    {
        this.valueName = valueName;
        value = defaultValue;
    }

    public T Value
    {
        get
        {
            lock (syncLock)
            {
                if (!set && throwIfNotSet) throw new ValueNotSetException(valueName);
                return value;
            }
        }
        set
        {
            lock (syncLock)
            {
                if (set) throw new AlreadySetException(valueName, value);
                set = true;
                this.value = value;
            }
        }
    }

    public static implicit operator T(SetOnce<T> toConvert)
    {
        return toConvert.value;
    }
}

public class NamedValueException : InvalidOperationException
{
    private readonly string valueName;

    public NamedValueException(string valueName, string messageFormat)
        : base(string.Format(messageFormat, valueName))
    {
        this.valueName = valueName;
    }

    public string ValueName
    {
        get { return valueName; }
    }
}

public class AlreadySetException : NamedValueException
{
    private const string MESSAGE = "The value \"{0}\" has already been set.";

    public AlreadySetException(string valueName)
        : base(valueName, MESSAGE)
    {
    }
}

public class ValueNotSetException : NamedValueException
{
    private const string MESSAGE = "The value \"{0}\" has not yet been set.";

    public ValueNotSetException(string valueName)
        : base(valueName, MESSAGE)
    {
    }
} 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-05-08T13:33:40.323

这可以通过摆弄标志来完成：

```
private OneShot<int> setOnce;
private bool setOnceSet;

public OneShot<int> SetOnce
{
    get { return setOnce; }
    set
    {
        if(setOnceSet)
            throw new InvalidOperationException();

        setOnce = value;
        setOnceSet = true;
    }
} 
```

这不好，因为您可能会收到运行时错误。在编译时强制执行此行为要好得多：

```
public class Foo
{
    private readonly OneShot<int> setOnce;        

    public OneShot<int> SetOnce
    {
        get { return setOnce; }
    }

    public Foo() :
        this(null)
    {
    }

    public Foo(OneShot<int> setOnce)
    {
        this.setOnce = setOnce;
    }
} 
```

然后使用任一构造函数。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2020-10-21T15:07:12.597

## C# 9 内置了这个特性。它被称为[Init only setter](https://docs.microsoft.com/en-us/dotnet/csharp/whats-new/csharp-9#init-only-setters)

```
public DateTime RecordedAt { get; init; } 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-08T13:32:47.907

C# 中没有这样的功能（截至 3.5）。你必须自己编码。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-05-08T13:34:58.447

正如 Marc 所说，在 .Net 中默认情况下无法做到这一点，但自己添加一个并不太难。

```
public class SetOnceValue<T> { 
  private T m_value;
  private bool m_isSet;
  public bool IsSet { get { return m_isSet; }}
  public T Value { get {
    if ( !IsSet ) {
       throw new InvalidOperationException("Value not set");
    }
    return m_value;
  }
  public T ValueOrDefault { get { return m_isSet ? m_value : default(T); }}
  public SetOnceValue() { }
  public void SetValue(T value) {
    if ( IsSet ) {
      throw new InvalidOperationException("Already set");
    }
    m_value = value;
    m_isSet = true;
  }
} 
```

然后，您可以使用它作为您特定属性的支持。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2013-01-03T18:51:12.870

你考虑过只读吗？[http://en.csharp-online.net/const,_static_and_readonly](http://en.csharp-online.net/const,_static_and_readonly)

它只能在初始化期间设置，但可能是您正在寻找的。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2016-10-24T00:33:52.043

这是我对此的看法：

```
public class ReadOnly<T> // or WriteOnce<T> or whatever name floats your boat
{
    private readonly TaskCompletionSource<T> _tcs = new TaskCompletionSource<T>();

    public Task<T> ValueAsync => _tcs.Task;
    public T Value => _tcs.Task.Result;

    public bool TrySetInitialValue(T value)
    {
        try
        {
            _tcs.SetResult(value);
            return true;
        }
        catch (InvalidOperationException)
        {
            return false;
        }
    }

    public void SetInitialValue(T value)
    {
        if (!TrySetInitialValue(value))
            throw new InvalidOperationException("The value has already been set.");
    }

    public static implicit operator T(ReadOnly<T> readOnly) => readOnly.Value;
    public static implicit operator Task<T>(ReadOnly<T> readOnly) => readOnly.ValueAsync;
} 
```

[Marc 的回答](https://stackoverflow.com/a/839798/64334)表明 TPL 提供了此功能，我*认为* `TaskCompletionSource<T>`这可能是他的意思，但我不能确定。

我的解决方案的一些不错的属性：

*   `TaskCompletionSource<T>`是一个官方支持的 MS 类，它简化了实现。
*   您可以选择同步或异步获取值。
*   此类的实例将隐式转换为它存储的值的类型。当您需要传递值时，这可以稍微整理您的代码。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2014-10-02T14:18:16.447

```
/// <summary>
/// Wrapper for once inizialization
/// </summary>
public class WriteOnce<T>
{
    private T _value;
    private Int32 _hasValue;

    public T Value
    {
        get { return _value; }
        set
        {
            if (Interlocked.CompareExchange(ref _hasValue, 1, 0) == 0)
                _value = value;
            else
                throw new Exception(String.Format("You can't inizialize class instance {0} twice", typeof(WriteOnce<T>)));
        }
    }

    public WriteOnce(T defaultValue)
    {
        _value = defaultValue;
    }

    public static implicit operator T(WriteOnce<T> value)
    {
        return value.Value;
    }
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-11-13T14:51:45.697

答案假设将来接收到对象引用的对象不会尝试更改它。如果您想防止这种情况发生，您需要使您的一次性编写代码仅适用于实现 ICloneable 或原语的类型。例如，String 类型实现了 ICloneable。那么您将返回数据的克隆或原语的新实例，而不是实际数据。

仅用于基元的泛型： T GetObject where T: struct;

如果您知道获取数据引用的对象永远不会覆盖它，则不需要这样做。

此外，请考虑 ReadOnlyCollection 是否适用于您的应用程序。每当尝试对数据进行更改时都会引发异常。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-09-23T18:32:55.367

```
interface IFoo {

    int Bar { get; }
}

class Foo : IFoo {

    public int Bar { get; set; }
}

class Program {

    public static void Main() {

        IFoo myFoo = new Foo() {
            Bar = 5 // valid
        };

        int five = myFoo.Bar; // valid

        myFoo.Bar = 6; // compilation error
    }
} 
```

请注意，myFoo 被声明为 IFoo，但被实例化为 Foo。

这意味着 Bar 可以在初始化程序块中设置，但不能通过稍后对 myFoo 的引用来设置。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-03-16T01:42:56.227

我创建了一个允许在构造时设置值的类型，然后该值只能设置/覆盖一次，否则会引发异常。

```
public class SetOnce<T>
{
    bool set;
    T value;

    public SetOnce(T init) =>
        this.value = init;

    public T Value
    {
        get => this.value;
        set
        {
            if (this.set) throw new AlreadySetException($"Not permitted to override {this.Value}.");
            this.set = true;
            this.value = value;
        }
    }

    public static implicit operator T(SetOnce<T> setOnce) =>
        setOnce.value;

    class AlreadySetException : Exception
    {
        public AlreadySetException(string message) : base(message){}
    }
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2018-05-23T21:08:53.483

虽然接受和评价最高的答案最直接地回答了这个（较旧的）问题，但另一种策略是构建一个类层次结构，以便您可以通过父母构造孩子，加上新属性：

```
public class CreatedAtPointA 
{
    public int ExamplePropOne { get; }
    public bool ExamplePropTwo { get; }

    public CreatedAtPointA(int examplePropOne, bool examplePropTwo)
    {
        ExamplePropOne = examplePropOne;
        ExamplePropTwo = examplePropTwo;
    }
}

public class CreatedAtPointB : CreatedAtPointA
{
    public string ExamplePropThree { get; }

    public CreatedAtPointB(CreatedAtPointA dataFromPointA, string examplePropThree) 
        : base(dataFromPointA.ExamplePropOne, dataFromPointA.ExamplePropTwo)
    {
        ExamplePropThree = examplePropThree;
    }
} 
```

通过依赖构造函数，您可以在代码气味上喷洒一些Febreeze，尽管它仍然很乏味并且可能是一种昂贵的策略。

* * *

## 回答 #14

> 赞同：-2
> 
> 时间：2009-05-08T13:49:32.313

您可以这样做，但这不是一个明确的解决方案，代码可读性也不是最好的。如果你正在做代码设计，你可以看看[单例](http://en.wikipedia.org/wiki/Singleton_pattern)实现与 AOP 一起[拦截](http://www.delarou.net/weblog/PermaLink,guid,72bdda24-0357-4ed9-9f2d-a5d1c884a35b.aspx)setter。实现只有 123 :)

# c# - 从页面基类中查找页面中的控件

> ID：839794
> 
> 赞同：5
> 
> 时间：2009-05-08T13:28:14.940
> 
> 标签：c#, asp.net, inheritance, hyperlink, findcontrol

希望你星期五过得愉快……好吧，这是我的问题：

我所有的 ASPX 页面都继承自一个名为 BasePage 的基类。BasePage 继承自：

```
System.Web.UI.Page 
```

现在，如何从我的页面库访问/设置我的 aspx 页面中的控件？我试过这个：

```
HyperLink hypMainMenu = (HyperLink)Page.FindControl("hypMainMenu");
hypMainMenu.NavigateUrl = AppConfiguration.AppSettings.Urls.MainMenu; 
```

但是 hypMainMenu 总是为空——我找不到那个混蛋。有任何想法吗？或者这是一种不好的做法，有人可以推荐一种更好的方法来做到这一点？

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-08T13:34:15.453

尽管什么是好的做法和不好的做法是非常主观的，但我必须说，尝试从控件的基类访问**任何东西是不好的做法。**一个基类应该**只**包含与**所有**继承它的类相关的代码，你怎么知道你以后写的每个页面都会有这个控制？

解决您的问题的更好方法（我假设您的主菜单仅在一个地方有代码）是编写 a`UserControl`并且您将其包含在每个页面上。如果您需要对该控件执行特定操作，可以在`UC`'s中执行此操作`CodeBehind`。

# algorithm - 在具有 Y 个可用位置的路径上获取 X 个对象的最平均位置

> ID：839801
> 
> 赞同：1
> 
> 时间：2009-05-08T13:29:39.677
> 
> 标签：algorithm, math, actionscript, average

现在是星期五，当地时间是下午 3.22，所以我的大脑不会给我解决方案，所以我问：

我试图在 Actionscript 3.0 中编写一个函数/算法，它为我提供了沿 y 个可用位置的路径的 x 个位置的最平均位置。

当然，Y 总是大于 X。

背景是，我有一张地图，其中包含例如 50 个可能的对象位置（沿路径）。但是我只有 32 个对象可以沿着这条路径放置，但我希望它们的放置尽可能平均/均匀地沿着这条路径。因此，例如，它最终不会有很大的差距。我的可用位置目前存储在一个带有点值的数组中。

如果你只是做 totalPos/wantedPos 并将其落地，最后将是一个“丑陋”的差距，有什么想法吗？

编辑：

我想添加该功能以防其他人想要它：

```
function place (x : uint, y : uint ) : Array
{
    var a : Array = new Array();
    var s : Number = y / x;
    var c : Number = 0;

    for (var i : Number = 0; i<x; i++) {
        c++;
        var pos : Number = Math.round(i * s);
        a.push(posArray[pos]);
    }
    return a;
} 
```

假设你有一个数组 posArray 已经有可能的位置......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-08T13:55:15.653

如果您执行 totalPos/wantedPos，您会得到一个可能不在 int 中的数字。

例如 32/7 = 4.57...

如果你把它放倒并选择 4，那么你最终会得到一个很大的差距。但是，如果您累积 4.57 并下限，您将缩小差距。

再次例如 32/7 = 4.57... 所以最初您选择 4。对于下一个数字，您会得到 2 * 4.57... = 9.14...，所以您选择 9。然后 3 * 4.57... = 13.71 所以你选择 13\. 等等...

如果你四舍五入而不是地板可能会更好。

祝你好运 ：）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T14:57:59.280

如果我理解正确的话，我认为这种事情有一个基本的算法（但它离学校太久了！）。基本上，它是一个递归调用，因此您传入端点并将对象放在中间点。然后，您将开始到中间作为第一个端点，将中间到结束作为第二个端点进行递归。所以你一直把差距分成两半。

当我键入此内容时，我意识到这仅在要分配的对象数量为正方形时才有效。但是，我会留下答案，以防它给别人一个更好的主意。

# visual-studio-2008 - 当我运行我的网站时，Silverlight 项目不再自动构建

> ID：839805
> 
> 赞同：0
> 
> 时间：2009-05-08T13:30:48.880
> 
> 标签：visual-studio-2008, silverlight

我在卸载 Silverlight 2 后刚刚安装了 Silverlight 3 + RIA 服务，现在我的 Silverlight 项目在我运行 (F5) 我的网站时不再自动构建。我必须手动构建 silverlight 应用程序，然后运行该网站，这真的很烦人。任何想法如何解决这个问题？

谢谢，

派特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T16:07:33.230

尝试这个：

**右键单击**网站项目 ->**项目依赖项..**从上下文菜单中 ->**勾选**silverlight 项目旁边的框（这将使网站项目依赖于 SL 项目，因此将首先编译 SL 项目）。

和这个：

**右键单击**网站项目 ->上下文菜单中的**属性-> 左侧的****Silverlight 应用程序**选项卡，并确保您的 SL 应用程序在列表中。

# c# - ASP.Net (C#) & SQL Server - 或者 - PHP & MySQL 的性能？

> ID：839807
> 
> 赞同：2
> 
> 时间：2009-05-08T13:30:51.093
> 
> 标签：c#, php, mysql, sql-server

***金钱、员工、技能和对开源或商业的偏好是中立的***。

让我们挑选最好的程序员（为了争论）考虑一下：

什么会整体表现更好：

*   PHP 和 MySQL

或者

*   ASP.Net 和 SQL Server

（*我不想要有偏见的答案，只是在寻找性能和速度*）。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-08T14:29:31.577

我是 PHP 人（也使用 .NET），我会说：所有事情都是平等的（所选平台、硬件、带宽等的程序员技能） 带有 SqlServer 的 ASP.NET 将比 PHP 更快使用 MySQL（在运行时）。在地狱中，解释语言无法以运行时速度击败编译语言。

我想提出一个问题：“这重要吗”，我无法为你回答这个问题。但就我而言，我遇到的大多数答案都是肯定的。我发现通常（设计良好的）代码中原始速度的差异可以忽略不计，尽管当然是 YMMV。

选择主要取决于问题的答案：“你想什么时候快？”

1.  在写代码的时候
2.  在运行代码时
3.  在调试代码时
4.  上述所有的

PHP 在大多数情况下击败 ASP.NET 的唯一情况是 1；在编写代码时 ASP.NET 在两种情况下胜出；2和3，运行和调试代码。

如果您想要最快的整体，答案将是不确定的，直到我们知道使用两个平台在 1、2 和 3 中的每一个上花费的时间。

-- 下面补充 --

我显然忘了提到，有一个潜在的大事在 PHP 中（还没有）解决，但在 .NET 中很容易做到，那就是多线程。您可以（付出很多努力）在 PHP 中进行一些多处理，但 .NET 可以轻松地在一个进程中运行多个实际线程。如果这不是一个交易破坏者，那么两者都可以。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-08T13:36:28.023

ASP.NET 是经过编译的（并使用具有最先进的 JIT 和垃圾收集器的非常有效的运行时），而 PHP 是一种解释性脚本语言。我将在这个上使用 .NET。加上 SQL Server(2005+) 在严肃的数据库方面比 MySQL 好得多

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-08T13:42:01.257

我已经看到报告显示 mysql 在一些简单的情况下更快（即放入单个表，从单个表中获取）。但速度差异不会很大。我的经验是，网站中任何可察觉的缓慢都是由于以下原因之一：（1）数据库的硬件不足（例如，磁盘 i/o 或内存不足）或（2）数据库需求的复杂性（与必要的争用有关你想做什么）。因此，mysql 擅长的简单场景不太可能成为避免慢速站点最受关注的问题。我的观点是添加额外的前端服务器非常简单，因此 asp.net 或 php 并不重要。在数据库端进行横向扩展通常非常困难（可以做到，但复杂性要大得多）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-08T14:22:22.843

我在这两个方面都做过，所以我实际上已经研究过了，答案真的是“没关系”。

从用户的角度来看，排队 HTTP 请求所花费的时间多于执行代码所花费的时间，无论是 PHP/MySql 还是 ASP.NET/MSSQL。如果您有一个用其中一种语言编写的网站，那么增加服务器的规格以获得性能几乎总是比用另一种语言重新编写更便宜。

根据我的经验，虽然 .NET 应该更快，但类似的 PHP 页面响应速度更快，并且它们在功能上几乎相同（非常简单的 CMS 站点，页面和产品在数据库中）。我开发了这两个，所以我在这两个中都看到了很多网站。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-08T14:23:05.323

您的应用程序设计和人员的技能水平将对性能产生最大影响

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-08T13:57:56.037

对于 Web 应用程序，选择 PHP 或 ASP.NET 可能并不重要，因为它们都将花费大部分时间等待。ASP.NET 在 CLR 上编译和运行，而 PHP 被解释并具有字节码缓存，从而大大加快了执行速度。

MySQL 和 MSSQL 很难说。大多数非常大的网站都在 MySQL 上运行。Facebook、Yahoo、Google、Digg、Twitter 都有在 MySQL 中运行的东西。除非您做一些需要 MSSQL 特定功能的商业智能工作，否则我不会使用它。它非常昂贵，并且在性能方面没有经过证实的好处。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-08T13:59:56.907

您可以从这两种组合中获得非常好的性能。ASP.NET - 已编译，编译后可以运行得更快。

但是有一些好的 php 有一些很好的缓存插件，它们实际上保存了生成的 php 字节码。php ist 需要考虑的另一件事是，它的大部分库实际上是用 C 语言编写并编译的。使用 php，您运行的代码要少得多 - 没有框架、请求/上下文/响应对象和控制树的实例化。总体而言php可以运行得非常快。

我会为企业 Web 应用程序选择 ASP.NET，为公共网站选择 php。

对于数据库 - 在某些情况下，mysql 可能比 MSSQL 快一点，但它们都非常好。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-05-08T14:05:20.623

你不会得到任何数字。但如果你真的想要数字，我建议你同时尝试并测量。

# c# - 远程服务器返回错误：(422)

> ID：839820
> 
> 赞同：4
> 
> 时间：2009-05-08T13:33:32.617
> 
> 标签：c#, .net, webresponse

当我尝试使用 WebResponse 时出现以下错误

```
WebResponse response = request.GetResponse() 
```

**远程服务器返回错误：(422)。**

```
at System.Net.HttpWebRequest.GetResponse()
   at HopSharp.HoptoadClient.Send(HoptoadNotice notice) in D:\Projects\...dClient.cs:line 65 
```

有人知道这个例外吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-08T13:46:36.500

该异常意味着 Web 服务器以错误代码响应，即 422。您需要与远程站点的管理员联系，了解原因。（或者查看响应的主体，如果有任何返回，它可能包含一些提示）。

以下是错误代码 422 的解释：[https ://www.rfc-editor.org/rfc/rfc4918#section-11.2](https://www.rfc-editor.org/rfc/rfc4918#section-11.2)

您发送到服务器的请求很可能以某种方式无效。如果不知道您针对哪个系统发送哪个请求，就不可能知道确切的错误是什么。

# apache-flex - Flex：将标签的字体大小绑定为另一个标签的一半？

> ID：839831
> 
> 赞同：1
> 
> 时间：2009-05-08T13:36:25.590
> 
> 标签：apache-flex

有没有办法将标签的字体大小绑定为另一个标签的字体大小的一半？

我试过这个：

```
<mx:Label id="mytitle" text="{title}" fontSize="{(mylabel.getStyle('fontSize') as Number)/2}"/> 
```

不走运……有人知道方法吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T15:44:32.130

您尝试过的调用过早，因此“mylabel”的字体尚未初始化。在填充 UI 组件后，您可以使用初始化事件来执行此操作。

```
<mx:Label id="mytitle" text="{halfSize}"
          initialize="{setStyle('fontSize', mylabel.getStyle('fontSize') / 2)}"/> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-11T14:57:33.727

您选择的方法将不起作用，因为 getStyle 不可绑定。您始终可以将两个标签绑定到某个其他值（一个绑定到未修改的值，一个绑定到该值除以 2）并更改它，而不是更改标签本身的字体大小。

一个好的解决方案的存在可能取决于你为什么要这样做。

# ruby - 如何对 Ruby 中的 Excel 事件做出反应？

> ID：839838
> 
> 赞同：1
> 
> 时间：2009-05-08T13:38:16.257
> 
> 标签：ruby, excel

我可以找到 10^1000 个使用 Ruby 编写 Excel 脚本的示例，但我一生都无法弄清楚如何让 Ruby 对 Excel 中的事件做出反应。我正在尝试在选择工作表时检索工作表中一行的内容，但是这种基于事件的检索我找不到任何方法或示例。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T16:01:26.897

使用*WIN32OLE_EVENT.new*方法创建一个 OLE 事件对象，然后调用其*on_event*方法。调用*WIN32OLE_EVENT.message_loop*方法来启动事件监控循环。

下面是一个示例，它打印出选定范围的值，然后在保存工作簿之前停止事件监视：

```
require 'win32ole'

def exit_event_loop
    $LOOP = false
end

xl = WIN32OLE.connect('Excel.Application')
wb = xl.ActiveWorkbook

ev = WIN32OLE_EVENT.new(wb, 'WorkbookEvents')
ev.on_event('SheetSelectionChange') do
    range = xl.Selection
    puts(range.Value)
    STDOUT.flush
end

ev.on_event('BeforeSave') do
    exit_event_loop
end

$LOOP = true
while $LOOP
    WIN32OLE_EVENT.message_loop
    sleep 0.1
end 
```

希望有帮助。

# java - 将 Java 开发从 Windows 切换到 Mac 是否有任何问题或好处？

> ID：839839
> 
> 赞同：12
> 
> 时间：2009-05-08T13:38:28.127
> 
> 标签：java, windows, macos, comparison

我可以选择使用 Windows 笔记本电脑或 Mac 笔记本电脑来进行 Java 开发。在承诺其中之一之前，我想我会发现在使用 Mac 笔记本电脑而不是 Windows 笔记本电脑方面是否有任何问题或好处？

我确实听到的一件事是 Java JDK 版本对于 Mac 来说并不总是最新的，您需要等待一段时间。

我的环境很简单：Eclipse 和 Java EE 5.0

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-08T13:45:34.257

对于您的配置，没有问题...的确，有时您必须等待发布，但没有什么是无法克服的...不过，我遇到了 Eclipse 的一些问题。它经常崩溃，但我正在做密集的事情......

我的一个问题是快捷方式，这听起来很愚蠢，但我是一个沉重的快捷方式用户，在控制和苹果键和 alt 之间切换有时很难记住..

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-08T14:39:39.620

可能有兴趣知道 Apple 对 Java 1.6 的支持仅适用于 64 位英特尔架构。如果您正在运行 32 位 cpu，您必须对 1.5 感到满意

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-08T13:49:32.797

我没有发现在 Mac 上进行 Java 开发的主要问题（我通常在 Linux 和 Mac 平台上进行开发）。关于 sdk，与 Linux/Windows 版本相比，它们的发布确实有所延迟。

[你会在Apple Developer Connection](http://developer.apple.com/mac/)找到最新的 jdk ，你需要一个苹果开发者账号（它是免费的）。作为建议，请保留您从 Apple 下载的图像，因为它们可能会在一段时间后不可用，特别是对于旧版本。

关于摇摆开发，我认为 SpringLayout 的处理有点不同（缺少一些弹簧），因为在 Linux 中开发的一些 JPanel 在 Mac 中会产生一些警告。在 Mac 上开发的 JPanel 在其他平台上也能正常工作。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-08T13:53:50.570

不要忘记您仍然可以运行 Windows（虚拟或本机（通过 BootCamp）），所以即使归结为更喜欢这台机器，Mac 仍然值得考虑。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-08T14:00:27.200

我使用 Mac Pro 进行 Java 开发（Eclipse 和 Java 5），Eclipse 非常不稳定。可能是32位的原因。我总是遇到内存不足错误。我基本上在 VMWare Fusion 下运行 Linux VM 并在其中进行开发。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-08T13:44:51.107

UI 框架存在（/曾经？）某些问题。但通常它应该工作。

也看看：http: [//developer.apple.com/java/](http://developer.apple.com/java/)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-08T13:59:01.777

从我非常有限的经验中我能想到的唯一问题是 Mac OS X (10.5.x) 使用默认库 JVM 1.5，其中最新的是 JVM 1.6，所以在某些情况下，使用来自 JVM 1.6 的新函数/类，您将不得不手动更改它。它在 Eclipse 中非常简单。

项目 -> 属性 -> Java 构建路径 -> 库。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-08T14:00:02.867

[并非所有 Eclipse Profiler 都受支持。](http://dev.eclipse.org/newslists/news.eclipse.tptp/msg07162.html)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-11T21:02:53.127

我经常在两者之间来回工作，唯一偶尔让我感到困扰的是布局管理器。他们喜欢在操作系统之间定位不同的组件。当然容易修复，但要注意犯错误。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-05-11T22:24:56.707

OS X 上的 Eclipse 对我来说工作得很好，而且 IntelliJ Idea 似乎也不错（我自己没有在 OS X 上使用过它，但认识很多人）。此外，Apple 开发人员工具附带的 Shark 分析器可以很好地与 Java 应用程序配合使用（您需要添加 -XrunShark 作为 VM 属性），允许您在运行时轻松附加。另外它是免费的，这很好。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-08T13:54:59.197

mac 平台相对于 windows 平台的一个好处是你有一个真正的终端，它可以工作。这在您远程部署代码时非常有用。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-08T18:04:20.923

google widget toolkit (GWT) 开发工具也不完全支持；请参阅[GWT 入门指南](http://code.google.com/intl/nl-NL/webtoolkit/gettingstarted.html)。

与 eclipse 一样，问题通常出在 SWT GUI 绑定中。它们绑定到 java，但它们本身并不独立于平台。您总是必须希望绑定对于您的平台是正确的（例如按预期工作）。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-05-08T18:20:41.477

对于那些坚持使用 OSX 32 位的用户，如果需要 1.6 ，可以尝试[SoyLatte](http://landonf.bikemonkey.org/static/soylatte/)

# c# - 在 XAML 中重用路径对象

> ID：839843
> 
> 赞同：14
> 
> 时间：2009-05-08T13:40:14.287
> 
> 标签：c#, .net, wpf, xaml

我有一个路径（一个明星人物）：

```
<Path x:Name="NiceStar" StrokeThickness="10" Stroke="#ff000000" StrokeMiterLimit="1" Data="F1 M 126.578613,11.297852 L 162.373535,83.825684 L 242.412598,95.456055 L 184.495605,151.911133 L 198.167480,231.626953 L 126.578613,193.990234 L 54.988770,231.626953 L 68.661621,151.911133 L 10.744629,95.456055 L 90.783691,83.825684 L 126.578613,11.297852 Z">
    <Path.Fill>
        <RadialGradientBrush MappingMode="Absolute" GradientOrigin="390.395508,448.130371" Center="390.395508,448.130371" RadiusX="113.034821" RadiusY="113.034821">
            <RadialGradientBrush.Transform>
                <MatrixTransform Matrix="1,0,-0,-1,-263.816895,569.592773" />
            </RadialGradientBrush.Transform>
            <GradientStop Offset="0" Color="#ff00ff00"/>
            <GradientStop Offset="1" Color="#ff006736"/>
        </RadialGradientBrush>
    </Path.Fill>
</Path> 
```

现在我想多次复制这个路径（只是指“NiceStar”）。我可以在纯 XAML 中执行此操作吗？

通过这样做，我可以使用它一次：

```
<Decorator Child="{StaticResource star}" /> 
```

但是，我不能复制这条线。我的编译器说：

> 指定元素已经是另一个元素的逻辑子元素。先断开它。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-05-08T14:04:18.253

创造一种风格。

```
<Style x:Key="NiceStarPath" TargetType="{x:Type Path}">
    <Setter Property="StrokeThickness" Value="10"/>
    <Setter Property="Stroke" Value="#FF000000"/>
    <Setter Property="StrokeMiterLimit" Value="1"/>
    <Setter Property="Data" Value="F1 M 126.578613,11.297852 L 162.373535,83.825684 L 242.412598,95.456055 L 184.495605,151.911133 L 198.167480,231.626953 L 126.578613,193.990234 L 54.988770,231.626953 L 68.661621,151.911133 L 10.744629,95.456055 L 90.783691,83.825684 L 126.578613,11.297852 Z"/>
    <Setter Property="Fill">
        <Setter.Value>
            <RadialGradientBrush MappingMode="Absolute" GradientOrigin="390.395508,448.130371" Center="390.395508,448.130371" RadiusX="113.034821" RadiusY="113.034821">
                <RadialGradientBrush.Transform>
                    <MatrixTransform Matrix="1,0,-0,-1,-263.816895,569.592773" />
                </RadialGradientBrush.Transform>
                <GradientStop Offset="0" Color="#ff00ff00"/>
                <GradientStop Offset="1" Color="#ff006736"/>
            </RadialGradientBrush>
        </Setter.Value>
    </Setter>
</Style> 
```

...

```
<Path Style="{StaticResource NiceStarPath}"/> 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-08T13:59:56.127

当然，只需为路径定义一个样式，然后您就可以将其作为静态资源重用：

```
<Page
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
<Page.Resources>
    <Style x:Key="StarStyle" TargetType="Path">
    <Setter>
        <Setter.Property>Fill</Setter.Property>
        <Setter.Value>                
             <RadialGradientBrush MappingMode="Absolute"
              GradientOrigin="390.395508,448.130371" Center="390.395508,448.130371"
              RadiusX="113.034821" RadiusY="113.034821">
             <RadialGradientBrush.Transform>
                 <MatrixTransform Matrix="1,0,-0,-1,-263.816895,569.592773" />
             </RadialGradientBrush.Transform>
             <GradientStop Offset="0" Color="#ff00ff00"/>
             <GradientStop Offset="1" Color="#ff006736"/>
             </RadialGradientBrush>
         </Setter.Value> 
    </Setter>
    <Setter Property="StrokeThickness" Value="10" />
    <Setter Property="Stroke" Value="#ff000000" />
    <Setter Property="StrokeMiterLimit" Value="1" />
    <Setter Property="Data" Value="F1 M 126.578613,11.297852 L 162.373535,83.825684 L 242.412598,95.456055 L 184.495605,151.911133 L 198.167480,231.626953 L 126.578613,193.990234 L 54.988770,231.626953 L 68.661621,151.911133 L 10.744629,95.456055 L 90.783691,83.825684 L 126.578613,11.297852 Z"/>
    </Style>
</Page.Resources>
<StackPanel>  
    <Path Style="{StaticResource StarStyle}" />
    <Path Style="{StaticResource StarStyle}" />
</StackPanel>
</Page> 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-11T19:57:26.213

在相关说明中，（尽管可能不会直接回答您的问题），您还可以将 FrameworkElement 声明为 Resource，给它一个键，只要添加`x:Shared="False"`，您就可以在代码中一次又一次地访问该资源。

这是一个伪代码示例：

```
<Window ....>
   <Window.Resources>
      <Ellipse x:Key="ReusableEllipse" x:Shared="False" ...>
         <Ellipse.Fill>
            <!--STUFF-->
         </Ellipse.Fill>
      </Ellipse>
   </Window.Resources>
   <Canvas x:Name="drawCanvas" Background="White"/>
</Window> 
```

然后，在代码中，您可以访问资源形状并根据需要多次重复使用它。

```
Ellipse tempRect = (Ellipse)FindResouce("ReusableEllipse"); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-07-27T13:06:38.727

我会将路径变成[DrawingBrush](http://msdn.microsoft.com/en-us/library/system.windows.media.drawingbrush.aspx)。这在混合中很容易做到，只需选择路径，工具 > 制作画笔资源 > 制作绘图画笔资源。然后，您将拥有资源中的画笔，可以重复使用。我希望它的性能会非常好，因为画笔是非交互式且可重复使用的。

这是 XAML：

```
<Window
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Width="640" Height="480">
    <Window.Resources>
        <DrawingBrush x:Key="NiceStarBrush" Viewbox="0,0,250,240" ViewboxUnits="Absolute">
            <DrawingBrush.Drawing>
                <GeometryDrawing Geometry="F1M126.578613,11.297852L162.373535,83.825684 242.412598,95.456055 184.495605,151.911133 198.16748,231.626953 126.578613,193.990234 54.98877,231.626953 68.661621,151.911133 10.744629,95.456055 90.783691,83.825684 126.578613,11.297852z">
                    <GeometryDrawing.Brush>
                        <RadialGradientBrush MappingMode="Absolute" Center="390.395508,448.130371" GradientOrigin="390.395508,448.130371" RadiusX="113.034821" RadiusY="113.034821">
                            <RadialGradientBrush.Transform>
                                <MatrixTransform Matrix="1,0,0,-1,-263.816895,569.592773"/>
                            </RadialGradientBrush.Transform>
                            <GradientStop Color="Lime" Offset="0"/>
                            <GradientStop Color="#FF006736" Offset="1"/>
                        </RadialGradientBrush>
                    </GeometryDrawing.Brush>
                    <GeometryDrawing.Pen>
                        <Pen Brush="Black" DashCap="Flat" EndLineCap="Flat" LineJoin="Miter" MiterLimit="1" StartLineCap="Flat" Thickness="10">
                            <Pen.DashStyle>
                                <DashStyle/>
                            </Pen.DashStyle>
                        </Pen>
                    </GeometryDrawing.Pen>
                </GeometryDrawing>
            </DrawingBrush.Drawing>
        </DrawingBrush>
    </Window.Resources>
    <Grid x:Name="LayoutRoot">
        <Rectangle Margin="181,115,0,0" Fill="{DynamicResource NiceStarBrush}" HorizontalAlignment="Left" VerticalAlignment="Top" Width="50" Height="46" />
    </Grid>
</Window> 
```

另一种选择是使用[DrawingImage将路径包装到图像源中](http://msdn.microsoft.com/en-us/library/system.windows.media.drawingimage.aspx)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2017-12-19T12:12:50.097

您可以为此使用带有控件模板的样式

```
<Style TargetType="Control" x:Key="FolderIcon">
    <Setter Property="IsTabStop" Value="False"/>
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate>
                <Path Data="M -1,0 h 5 M 0,3 h 10 v 5 h -10 Z" StrokeThickness="2" Stroke="White" Fill="White" />
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

然后使用它：

```
<Button>
    <Control Style="{StaticResource FolderIcon}"/>
</Button> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-03-09T19:59:41.063

如果您想多次重用路径数据，可能在多个样式之间，您可以定义一个 Geometry 资源：

```
<ResourceDictionary>
    <Geometry x:Key="StarPathData">F1 M 126.578613,11.297852 L 162.373535,83.825684 L 242.412598,95.456055 L 184.495605,151.911133 L 198.167480,231.626953 L 126.578613,193.990234 L 54.988770,231.626953 L 68.661621,151.911133 L 10.744629,95.456055 L 90.783691,83.825684 L 126.578613,11.297852 Z</Geometry>
</ResourceDictionary> 
```

然后直接使用它：

```
<Path Data="{StaticResource StarPathData}"> 
```

或风格：

```
<Style x:Key="NiceStarPath" TargetType="{x:Type Path}">
    <Setter Property="Data" Value="{StaticResource StarPathData}"/>
    ...
</Style> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-04-08T05:39:09.930

我在单独的 XAML 文档中定义了一个路径，然后将其重新用作 ContentControl 的内容。

在资源文件或资源字典中：

```
<Path  x:Key="SearchIcon"
        Width="30" Height="30" Margin="3" Fill="Blue"
        Data="Path data here"            
        Stretch="Fill" /> 
```

在 WPF 控件中：

```
<ContentControl Content="{StaticResource SearchIcon}"></ContentControl> 
```

# cisco - TAPI 和 TSAPI 有什么区别

> ID：839846
> 
> 赞同：5
> 
> 时间：2009-05-08T13:41:22.660
> 
> 标签：cisco, tapi, avaya

我有一个 C++ 程序，它使用 Microsoft TAPI 接口从 Cisco Call Manager PBX 收集呼叫事件。为了获得 Cisco 事件，我从呼叫管理器下载了 TSP，然后我的 TAPI 代码就可以工作了。

我可以用 Avaya AES 服务器做同样的事情吗？我看到 Avaya 使用 TSAPI 而不是 TAPI，但我看不出这会对我的程序产生什么影响。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-05-08T17:06:42.900

TAPI 是 Microsoft 开发的电话 API，TSAPI 是最终成为 Avaya（AT&T -> Lucent -> Avaya）的公司开发的电话 API。TAPI 的设计面向第一方呼叫控制（即电话），而TSAPI 面向第三方呼叫控制（即PBX 和中心局交换机）。TAPI 确实对处理呼叫音频有一些有限的支持，TSAPI 没有。如果您能找到适用于 Avaya AES 的 TAPI TSP，我会感到非常惊讶，如果您这样做了，您将不会从 Avaya 获得它。

如果您只对调用事件感兴趣，那么您可以使用两个 API 执行相同的操作，但代码将完全不同。大多数拥有必须与 Avaya AES 和 Cisco Call Manager 通信的产品的公司都为其产品创建了通用 CTI 接口，然后编写代码模块（也称为驱动程序），将 TSAPI 和 TAPI 呼叫事件转换为其通用事件格式。在您的情况下，根据您的操作系统，您可以将 TAPI 代码移动到单独的 DLL/共享库中，然后创建一个单独的 DLL/共享库来实现相同的功能，但使用 TSAPI 而不是 TAPI。

不幸的是，许多较小的 PBX 制造商将基于 TAPI 或 TSAPI 的 API 用于其 CTI 接口，因此如果您必须连接到第三个 PBX，则很有可能重用这两个模块中的一个。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-08T13:48:28.773

一种只是“电话”，另一种是“电话服务”。区别类似于办公桌上的电话 (TAPI) 和公司通讯柜 (TSAPI) 中的 PBX 之间的区别，不同之处在于，由于它们都是软件，因此您*可以*使用 TAPI 编写程序来完成 PBX 的大部分功能. 但我认为您会发现使用 TSAPI 会更容易。

# solr - Solr 分面查询语法

> ID：839854
> 
> 赞同：3
> 
> 时间：2009-05-08T13:44:43.400
> 
> 标签：solr

我想过滤多值字段上的分面计数（无文档）

例如：

```
select?q=*:*&rows=5&facet=true&facet.limit=5&facet.field=productID&facet.sort=true 
```

有没有机会过滤我的 facet.field 上的计数`productId`？

鉴于前面的查询，我得到的是：

```
<lst name="facet_counts">
<lst name="facet_queries"/>
−
<lst name="facet_fields">
−
<lst name="productID">
**<int name="EG7SpTw03mJ25vxS5jcB24">603</int>**
<int name="E53OBaX5hjGDAKzbHHaDG1">573</int>
<int name="sSLMrsA0wjLF8iWRAbzNq4">415</int>
<int name="ijcfPOTpg3eeGoXSW8h8L5">336</int>
<int name="Lij0a3kVgQzLxtOMgOXb06">296</int>
</lst>
</lst>
<lst name="facet_dates"/>
</lst> 
```

我只想过滤查询以获得如下结果：

- - 603 573 415 336 296

```
 <lst name="facet_counts">
    <lst name="facet_queries"/>
    −
    <lst name="facet_fields">
    −
    <lst name="productID">
    <int name="E53OBaX5hjGDAKzbHHaDG1">573</int>
    <int name="sSLMrsA0wjLF8iWRAbzNq4">415</int>
    <int name="ijcfPOTpg3eeGoXSW8h8L5">336</int>
    <int name="Lij0a3kVgQzLxtOMgOXb06">296</int>
    <int name="Lij0a3kVgQzLxtOMYERESW">293</int>
    </lst>
    </lst>
    <lst name="facet_dates"/>
    </lst> 
```

只想按productId过滤：EG7SpTw03mJ25vxS5jcB24 ...

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-11T07:15:36.213

好吧，我找到了解决方案，它只是使用 facet.prefix 参数

select?q= *:* &rows=5&facet=true&facet.limit=5&facet.field=productID&facet.sort=true&facet.prefix=EG7SpTw03mJ25vxS5jcB24

我得到的输出是：

```
<lst name="facet_counts">
<lst name="facet_queries"/>
−
<lst name="facet_fields">
−
<lst name="taxonUUID">
<int name="EG7SpTw03mJ25vxS5jcB24">603</int>
</lst>
</lst>
<lst name="facet_dates"/>
</lst> 
```

我要就这个话题提出一个新的更复杂的问题......

# c++ - 使用 std:fstream 如何拒绝对文件的访问（读取和写入）

> ID：839856
> 
> 赞同：15
> 
> 时间：2009-05-08T13:45:10.217
> 
> 标签：c++

如何拒绝访问我用 fstream 打开的文件？我想在使用 fstream 读取/写入文件时无法访问该文件？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-08T13:56:48.193

你不能用标准的 fstream 来做，你必须使用平台特定的功能。

在 Windows 上，您可以使用[CreateFile()](http://msdn.microsoft.com/en-us/library/aa363858(VS.85).aspx)或[LockFileEx()](http://msdn.microsoft.com/en-us/library/aa365203.aspx)。在 Linux 上，有[flock()](http://linux.die.net/man/2/flock)、[lockf()](http://linux.die.net/man/3/lockf)和[fcntl()](http://linux.die.net/man/2/fcntl)（正如前面的评论者所说）。

如果您使用的是 MSVC，则可以将第三个参数传递给 fstream 的构造函数。请参阅[Visual Studio 6](http://msdn.microsoft.com/en-us/library/aa243822(VS.60).aspx)或[更新版本](http://msdn.microsoft.com/en-us/library/8et8s826.aspx)的文档。当然，它不适用于其他编译器和平台。

你为什么要把别人锁在外面？可能有更好的解决方案...

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-11-27T14:56:54.130

*扩展 Casebash 的评论：*

要在 Windows 中打开文件，以便其他进程无法写入，请使用

```
file.rdbuf()->open(path, std::ios_base::app, _SH_DENYWR); 
```

_SH_DENYRW 将拒绝读写访问

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-08T13:48:26.187

在本机 C++ 中无法做到这一点，因为它高度依赖于平台。在 Linux/UNIX 上，您可以使用[`flock`](http://linux.die.net/man/2/flock)或执行此操作[`fcntl`](http://linux.die.net/man/2/fcntl)。我不确定如何在 Windows 上执行此操作。

在 Windows 上，您似乎必须将一些标志传递给[`CreatFile`](http://msdn.microsoft.com/en-us/library/aa363858.aspx)或使用[`LockFileEx`](http://msdn.microsoft.com/en-us/library/aa365203.aspx)（这允许字节范围锁定）。

请注意，所有这些方法都适用于底层操作系统文件描述符/句柄，而不是`fstream`s. 您将需要使用 Posix 或 Windows API 从文件中读取/写入，或者将文件描述符/句柄包装在`fstream`. 这又取决于平台。我确信有一种方法可以做到这一点，但我不记得它了。

# svn - svn外部不工作

> ID：839861
> 
> 赞同：3
> 
> 时间：2009-05-08T13:46:52.290
> 
> 标签：svn, svn-externals

我不声称对 svn 有任何了解，但我认为我了解外部是如何工作的。

我正在制作一个新项目，我希望我的 lib 文件夹具有其他项目的外部（svn 位置）。我以前做过很多次，从来没有遇到过问题，我只是有一个星期五的时刻吗？

1.  我创建了以下文件夹：

    /myproj

    /myproj/lib

    在已签出的文件夹下。

2.  我 svn 添加并提交了它们，然后更新了父文件夹以确保一切正常。

3.  我右键单击 - > tortoise - > lib文件夹上的属性并将我的svn外部添加到我想要的路径（肯定存在）：“MyExternalFolderName [http://path.to/svn/location](http://path.to/svn/location) ”
4.  我提交了 lib 文件夹
5.  当我更新 lib 文件夹时，通常我希望看到它更新外部，但没有任何反应。它只是说“完成”。

我忘记了什么？

编辑：无数次重新启动，重新检查和重新安装并没有修复它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-09T10:11:21.020

TortoiseSVN 1.6.1 中有一个[已知错误](http://svn.haxx.se/tsvn/archive-2009-05/0031.shtml)，新添加的文件夹的深度设置为“空”。

这会导致更新不起作用，除非您使用“TortoiseSVN - 更新到修订版...”对话框显式更新有问题的文件夹一次，您可以在其中将深度设置回“完全递归”。

**编辑**：[TortoiseSVN 1.6.2](http://tortoisesvn.net/node/370)刚刚发布

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-04-28T12:25:25.027

如果您使用***稀疏目录***检出（文件的自定义选择），请尝试以下命令：

```
svn update --depth=infinity svn_dir_name 
```

如果您没有可用的命令行工具，请尝试

`TortoiseSVN -> Update to revision... -> Update Depth = Fully recursive, Make depth sticky = turn off`

更多细节[在这里](https://www.visualsvn.com/support/svnbook/advanced/sparsedirs/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T13:54:24.253

我不认为你忘记了什么。我认为这是 Tortoise 中的一个错误；可能是缓存问题。

对您的存储库进行干净的签出，然后它将开始工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-08T13:57:17.147

3号：

属性格式为：

```
http://repo/svn/location    MyExternalFolderName 
```

我总是建议使用 ^ 符号而不是[http://repo/svn](http://repo/svn)，因为这样更容易，效果很好并且更容易输入。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-08T15:34:02.547

感谢您的帮助，但看起来 TortoiseSVN-1.6.1.16129-win32-svn-1.6.1 有问题。伟大的。他们的底格里斯河网站也关闭了。杰出的。浪费了2.5小时。

通过复制浏览器制作我需要的文件夹结构和外部文件来解决它。

# wcf - 任务管理器中的 CPU 时间到底是什么？

> ID：839866
> 
> 赞同：14
> 
> 时间：2009-05-08T13:48:30.677
> 
> 标签：wcf, windows-services, cpu

我有一些托管在 Windows 服务中的 WCF 服务。昨天我查看任务管理器，发现我的 windows 服务进程的 CPU 时间超过 5 小时，而所有其他进程的大部分时间都是 0。

这意味着什么？

我应该担心 CPU 时间超过 5 小时吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-08T13:56:41.657

[CPU 时间](http://www.google.com/url?sa=t&source=web&ct=res&cd=1&url=http%3A%2F%2Fen.wikipedia.org%2Fwiki%2FCPU_time&ei=nTsEStfiJJD6kAXsgdHWBw&rct=j&q=cpu+time&usg=AFQjCNF0R73trqeSXFZjAXJnxTpZ8ZyInQ)表示自进程启动以来进程使用了​​多少处理时间（在 Windows 中：指向[Technet 文章](http://technet.microsoft.com/en-us/library/cc958260.aspx)的链接。）

基本上是这样计算的：

```
CPU Time of Process = Process Uptime * CPU Utilization of Process 
```

例如，如果进程已经运行了 5 个小时，而 CPU 时间为 5 个小时，那么这意味着该进程一直在使用 100% 的 CPU 资源。这可能是好事也可能是坏事，这取决于您是想保持较低的资源消耗，还是想利用系统的全部功能。

如果进程使用 50% 的 CPU 资源并运行 10 小时，则 CPU 时间将为 5 小时。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-08T13:56:23.840

CPU 时间反映了您的程序在 CPU 中执行指令与等待 IO 或其他资源所花费的时间。您是否应该担心它超过 5 小时？

我猜不是，需要考虑的一些事情是：

1.  这个过程运行了多长时间？

2.  您对可能窃取 CPU 的进程或其他进程的性能有任何问题吗？

3.  您还有哪些其他流程？这些活动进程是您希望使用 CPU 的吗？作为 80 个进程的参考，我有大约 20 个使用了超过 1 秒的 CPU 时间。

**编辑**

WCF 服务可能正在从其他服务窃取 CPU，您需要监控它们以确保它们的性能符合您的预期。您还可以根据总 CPU 使用情况来了解情况。例如，如果您只看到 25% 的 CPU 被使用，那么您的其他服务不应该受到影响；但是，如果您的运行率高于 75%，那么他们可能会受到影响。

当涉及到监控时，一定要随着时间的推移进行监控，这样您就可以看到性能趋势如何，它将帮助您隔离问题。例如，您的服务运行良好，但在部署后它慢慢开始占用越来越多的 CPU（假设每周 10%）。除非您对 CPU 使用率进行趋势分析，否则您可能有一天醒来并看到您的服务运行缓慢，这可能是部署后的数周。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-08T22:10:37.320

如果您担心您的进程正在使用多少 CPU 时间，您应该使用[perfmon](http://www.computerperformance.co.uk/HealthCheck/GettingStarted.htm)来长时间跟踪您的进程的 CPU 使用率，以确定您是否有问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-04-30T08:58:23.850

任务管理器中的 CPU 时间到底是什么？

答案很简单：

自启动以来进程使用的总处理器时间（以秒为单位）。

# c# - 每个程序集的配置文件

> ID：839873
> 
> 赞同：1
> 
> 时间：2009-05-08T13:50:54.697
> 
> 标签：c#, .net, configuration, concordion

是否可以使用 .NET 配置对象来获取为类库程序集而不是可执行程序集指定的 .config 文件。

例如：

我正在开发[Concordion](http://www.concordion.org)的 .net 端口，我希望有特定于 Concordion 本身的选项，但也有特定于 Concordion 调用的每个规范程序集的选项。我希望 Concordion 选项位于一个 .config 文件中，而规范程序集每个都有自己的 .config 文件（其中每个配置文件的架构相同）。

我现在可以通过编写自己的解析逻辑来做到这一点，但如果 .NET 中已经内置了一些东西，我更愿意使用它。目前，据我所知，可执行程序集只能有一个 .config 文件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-08T13:55:36.090

您绝对应该在 CodeProject 上查看 Jon Rista 关于 .NET 2.0 配置的三部分系列。

*   [揭开](http://www.codeproject.com/Articles/16466/Unraveling-the-Mysteries-of-NET-Configuration).NET 2.0 配置的奥秘
*   [解读](http://www.codeproject.com/Articles/16724/Decoding-the-Mysteries-of-NET-Configuration).NET 2.0 配置的奥秘
*   [破解](http://www.codeproject.com/Articles/19675/Cracking-the-Mysteries-of-NET-Configuration).NET 2.0 配置的奥秘

强烈推荐，写得很好，非常有帮助！他展示了如何创建和使用自定义配置部分，并继续解释如何使用您自己的 custom.config 来代替标准 .NET 配置文件，或者除了使用标准 .NET 配置文件之外。

马克

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T14:02:16.853

查看[ConfigurationManager.OpenMappedExeConfiguration()](http://msdn.microsoft.com/en-us/library/system.configuration.configurationmanager.openmappedexeconfiguration.aspx)。它允许您提供要打开的配置文件的名称。那里的例子应该让你走上自己的路。

# .net - 在没有 asp.net 的情况下反序列化 json 对象数组的最佳方法是什么？

> ID：839874
> 
> 赞同：0
> 
> 时间：2009-05-08T13:51:55.287
> 
> 标签：.net, json

在没有 asp.net 的情况下反序列化 json 对象数组的最佳方法是什么？

Json 格式：{“结果”：[ {“a”：“值 A”，“b”：“值 B”}，{“c”：“值 C”，“d”：“值 D”}]}

请注意：Json 对象应反序列化为 .Net 对象。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-10T05:46:37.617

Json.NET 库，可在此处获得：

[http://james.newtonking.com/projects/json-net.aspx](http://james.newtonking.com/projects/json-net.aspx)

效果很好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T13:55:27.090

[http://www.json.org/](http://www.json.org/)（页面底部）提供了许多不同语言的实现

**编辑：根据**[MSDN](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.json.aspx)，显然该页面没有提到内置的 JSON 支持，而它确实存在于 .Net 3.5 中

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-05-08T13:55:01.223

使用 JavaScript，您可以：

```
var myObj = eval('(' + jsonString + ')'); 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-05-08T15:43:46.547

例如，在 PHP 中，您可以执行以下操作：

```
$json = json_decode($json_string); 
```

这会将您的 JSON 转换为对象/数组

# .net - Silverlight 中的计时器

> ID：839875
> 
> 赞同：7
> 
> 时间：2009-05-08T13:52:45.270
> 
> 标签：.net, asp.net, silverlight, timer

除了 System.Threading.Timer 对象之外，是否还有其他可以在 Silverlight 中使用的 Timer 对象？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-05-08T14:02:53.857

查看 DispatcherTimer： http: [//msdn.microsoft.com/en-us/library/system.windows.threading.dispatchertimer (VS.95).aspx](http://msdn.microsoft.com/en-us/library/system.windows.threading.dispatchertimer(VS.95).aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-07-24T10:25:54.170

故事板也是一个计时器

# c# - HttpWebRequest 和原生 GZip 压缩

> ID：839888
> 
> 赞同：61
> 
> 时间：2009-05-08T13:55:17.853
> 
> 标签：c#, .net, stream, gzip, http-compression

当请求使用 Gzip 压缩的页面时，我收到很多以下错误：

> System.IO.InvalidDataException：GZip 页脚中的 CRC 与从解压缩数据计算的 CRC 不匹配

我正在使用本机 GZipStream 解压缩并正在考虑解决此问题。考虑到这一点，是否有解决这个或另一个 GZip 库（免费？）的解决方法，可以正确处理这个问题？

我正在验证 webResponse ContentEncoding 是 GZIP

**更新 5/11** 一个简化的代码片段

```
//Caller
public void SOSampleGet(string url) 
{
    // Initialize the WebRequest.
    webRequest = (HttpWebRequest)WebRequest.Create(url);
    webRequest.Method = WebRequestMethods.Http.Get;
    webRequest.KeepAlive = true;
    webRequest.Accept = "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8";
    webRequest.Headers.Add("Accept-Encoding", "gzip,deflate");
    webRequest.Referer = WebUtil.GetDomain(url);

    HttpWebResponse webResponse = (HttpWebResponse)webRequest.GetResponse();    

    using (Stream stream = GetStreamForResponse(webResponse, READTIMEOUT_CONST))
    {
        //use stream
    }
}

//Method
private static Stream GetStreamForResponse(HttpWebResponse webResponse, int readTimeOut)
{
    Stream stream;
    switch (webResponse.ContentEncoding.ToUpperInvariant())
    {
        case "GZIP":
            stream = new GZipStream(webResponse.GetResponseStream(), CompressionMode.Decompress);
            break;
        case "DEFLATE":
            stream = new DeflateStream(webResponse.GetResponseStream(), CompressionMode.Decompress);
            break;

        default:
            stream = webResponse.GetResponseStream();
            stream.ReadTimeout = readTimeOut;
            break;
        }    
    return stream;
} 
```

* * *

## 回答 #1

> 赞同：139
> 
> 时间：2011-10-15T01:38:31.830

自 .net 2 以来可用的 webrequest AutomaticDecompression 属性怎么样？只需添加：

```
webRequest.AutomaticDecompression = DecompressionMethods.GZip | DecompressionMethods.Deflate; 
```

它还将 gzip,deflate 添加到接受编码标头中。

请参阅[http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.automaticdecompression.aspx](http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.automaticdecompression.aspx)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2017-06-12T21:08:32.460

对于 .NET Core 来说，事情要复杂一些。A`GZipStream`是必需的，因为`AutomaticCompression`. 在这里查看我的答案：[https ://stackoverflow.com/a/44508724/2421277](https://stackoverflow.com/a/44508724/2421277)

来自答案的代码：

```
var req = WebRequest.CreateHttp(uri);

/*
 * Headers
 */
req.Headers[HttpRequestHeader.AcceptEncoding] = "gzip, deflate";

/*
 * Execute
 */
try
{
    using (var resp = await req.GetResponseAsync())
    {
        using (var str = resp.GetResponseStream())
        using (var gsr = new GZipStream(str, CompressionMode.Decompress))
        using (var sr = new StreamReader(gsr))

        {
            string s = await sr.ReadToEndAsync();  
        }
    }
}
catch (WebException ex)
{
    using (HttpWebResponse response = (HttpWebResponse)ex.Response)
    {
        using (StreamReader sr = new StreamReader(response.GetResponseStream()))
        {
            string respStr = sr.ReadToEnd();
            int statusCode = (int)response.StatusCode;

            string errorMsh = $"Request ({url}) failed ({statusCode}) on, with error: {respStr}";
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-08T15:31:44.487

我找到了一些示例代码，显示了 GZip 编码页面的整个请求/响应。它使用 GZipStream。

[http://www.know24.net/blog/Decompress+GZip+Deflate+HTTP+Responses.aspx](http://www.know24.net/blog/Decompress+GZip+Deflate+HTTP+Responses.aspx)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-08T14:58:43.550

您是否正在刷新和关闭流？尝试使用 Using 语句包装您的 GZipStream。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-08T14:54:48.507

请参阅我上面的评论，但这通常是文件损坏的症状。如果该站点是您自己的，请替换您尝试访问的文件。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-05-08T14:00:07.607

本机 GZipStream 可以读取压缩的 GZIP ( [RFC 1952](http://www.faqs.org/rfcs/rfc1952.html) ) 流，但它不能处理 ZIP 文件格式。

来自[http://www.geekpedia.com/tutorial190_Zipping-files-using-GZipStream.html](http://www.geekpedia.com/tutorial190_Zipping-files-using-GZipStream.html)：

> 在 3rd 方产品上使用 GZipStream 类的缺点是它的功能有限。限制之一是您不能为放置在存档中的文件命名。当 GZipStream 将文件压缩到 ZIP 存档中时，它会从该文件中获取字节序列，并使用创建较小字节序列的压缩算法。新的字节序列被放入新的 ZIP 文件中。当您打开 ZIP 文件时，您将打开存档文件本身；最流行的 ZIP 提取器（WinZip、WinRar 等）会将 ZIP 的内容显示为与存档本身相同的文件。

* * *

> > 编辑：上面的注释是**不正确**的。GZipStream 不生成 ZIP 文件。它不是“单文件 ZIP 流”。它是一个 GZIP 流。它们是不同的东西。无法保证处理 ZIP 档案的工具能够处理 .gz 文件。

* * *

对于可以读取 ZIP 存档的实现，而不是单文件 ZIP 流，请尝试[#ziplib (SharpZipLib, 以前称为 NZipLib)](http://www.icsharpcode.net/OpenSource/SharpZipLib/)。

# java - How to populate the right side of a richfaces picklist?

> ID：839893
> 
> 赞同：8
> 
> 时间：2009-05-08T13:55:43.703
> 
> 标签：java, jsf, richfaces

I am using a Richfaces' [picklist](http://livedemo.exadel.com/richfaces-demo/richfaces/pickList.jsf?tab=usage&cid=5212106) and I want to populate the right-side panel with a list of SelectItems from my backing bean.

Populating the left-side is not a problem from the backing bean, however, the right hand side is problematic.

This is what I currently have

```
<h:outputText value="Roles" />
<rich:pickList showButtonsLabel="false">
    <f:selectItems value="#{Bean.allRoles}" />
</rich:pickList> 
```

**EDIT:**

So I have roles 'a', 'b', 'c', and 'd'.

The user has roles 'a' and 'd', so 'a' and 'd' should be on the right-side panel and 'b' and 'c' should be on the left-side panel.

**EDIT:**

Further explanation.

I have three lists for the user.

1.  All posible roles (a thru d)
2.  All roles the user is part of (a and d)
3.  All roles the user is NOT part of (b and c)

All lists have the data type `ArrayList<SelectItem>`.

I need the capability to move individual roles between list number 1 and list number 2 and then save the new set of roles. I thought the picklist would be the best richfaces object for the job.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2010-06-30T14:19:48.463

It seems that I found the solution.

```
<rich:pickList value="#{aBean.rightSideValues}"> 
        <f:selectItems value="#{aBean.leftSideValues}"/>
</rich:pickList> 
```

*   **`"#{aBean.rightSideValues}"`** should point to the list or array of objects. With these values right side of the pick list will be populated.

*   **`#{aBean.leftSideValues}`** should point to the list of the SelectItem object.

**ONE NOTICE -- SelectItem object MUST BE constructed with objects from the `"#{aBean.rightSideValues}"`**.

***Example***.

```
class ABean{
   ...
   List<SomeObject> getRightSideValues(){
    ...
  }

   List<SelectItem> getLeftSideValues(){
      List<SomeObjects> someObjects = getAllAvailableObjects();
      List<SelectItem> sItems = new ArrayList<SelectItem>(); 
      for(SomeObject sObj : someObjects){
          SelectItem sItem = new SelectItem(sObj, sObj.toString());
          sItems.add(sItem);
      }
      return sItems;
} 
```

Notice that SelectItem takes first argument and this argument is the reference to the SomeObject. In the internals rich faces will compare objects from the **`"#{aBean.rightSideValues}"`** with objects from the **`#{aBean.leftSideValues}`** with help of the method

`SomeObject.equals()`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-08T19:17:32.900

You want this code:

```
<h:outputText value="Roles" />
<rich:pickList showButtonsLabel="false" value="#{bean.chosenRoles}">
    <f:selectItems value="#{Bean.allRoles}" />
</rich:pickList> 
```

and in your bean you want:

```
private String[] chosenRoles;

+ getter/setter 
```

Whenver you want to make default roles you just add the roles into the chosenRoles array (for example in the bean constructor). That way chosenRoles will always contain the elements on the right side of the picklist, while elements on the left side are not in the array.

Hope this helps!

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-08-05T11:04:06.213

If you need values other than text, you need to make a converter.

See [http://programmingnutsandbolts.blogspot.com/2009/08/richfaces-picklist-converters.html](http://programmingnutsandbolts.blogspot.com/2009/08/richfaces-picklist-converters.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-09-04T22:15:34.237

As in RF 4.3.3 and probably earlier, too, you also need to override the hash method of your model class (entity bean). So, only overriding the equals method for your converter is not enough. The following worked out for me and my PubThread entity bean.

```
 @Override
    public boolean equals(Object obj) {
        if (obj == null)
            return false;
        if (!(obj instanceof PubThread))
            return false;
        PubThread objectToCheck = (PubThread) obj;
        boolean isShallowCopy = (this.id.equals(objectToCheck.id));
        return isShallowCopy;
    }

    @Override
    public int hashCode() {
        return (this.id.hashCode());
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-08T14:20:42.440

Set the value of the pickList to an array of the value of the SelectItem.

Whatever you start out with on the right hand side will then basically just be the default value of the pickList:

```
 <rich:pickList value="#{aBean.rightSideValues}"> 
        <f:selectItems value="#{aBean.leftSideValues}"/>
    </rich:pickList> 
```

# c# - 堆叠控件（Winforms C#）（透明）

> ID：839898
> 
> 赞同：0
> 
> 时间：2009-05-08T13:57:04.073
> 
> 标签：c#, controls, transparency

我被要求编写一个允许对象堆叠在容器内的 GUI。用户将从自上而下的角度查看这些框。他们还希望能够看到里面堆放着什么。我解决这个问题的第一个想法是透明度。我已经阅读了一些关于透明度的帖子，但是我没有发现任何可以解决两个图像都是透明的问题，因此如果它们堆叠在一起，你可以看到它们。

如何使控件与顶部的其他控件透明。如果这真的不可能；解决这个问题的更好方法是什么？

我正在使用自定义控件（公共部分类 MyControl：Control）来解决该问题。我终于让控件上的图像透明了。在父窗体上绘制的任何内容都通过图像显示（我使用 onPaint 为父窗体绘制椭圆和正方形），但是放置在它上面的其他控件不再透明。

我用来完成此操作的代码如下：

```
public Image Image 
  {
     get { return m_Image; }
     set { m_Image = value; }
  }
private void GridControl_Paint(object sender, PaintEventArgs e)
  {
     if (Image != null)
     {

        Graphics g = e.Graphics;
        Bitmap bitMap = new Bitmap(Image);

        //This is not working... the color array always comes back empty
        //This is how I would rather making things transparent...
        Color[] colorArray = bitMap.Palette.Entries;

        if (colorArray.Length > 0)
        {

           ColorMap[] colorMap = new ColorMap[colorArray.Length];

           for (int index = 0; index < colorArray.Length; index++)
           {
              colorMap[index] = new ColorMap();
              colorMap[index].OldColor = colorArray[index];
              colorMap[index].NewColor = Color.Transparent;
           }

        }

        //Ok fine so the above is not working... let me force it.
        //Get each pixel in the image and change the color.
        else
        {
           for (int x = 0; x < bitMap.Width; x++)
           {
              for (int y = 0; y < bitMap.Height; y++)
              {
                 Color pixelColor = bitMap.GetPixel(x, y);
                 Color newColor = Color.FromArgb(100, pixelColor);

                 bitMap.SetPixel(x, y, newColor);
              }
           }
        }

        bitMap.MakeTransparent();

        g.DrawImage(bitMap, this.ClientRectangle);
     }

  } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T14:21:58.413

你被锁定在使用 WinForms 吗？如果您需要做很多适度棘手的图形工作（例如您所描述的）并且无法重新设计您的应用程序来解决它，您可以跳入 WPF。

自从我玩 GDI+ 图形以来已经有一段时间了，所以这里有一个想法（但没有代码；））：

你的堆叠控件真的需要工作吗？如果没有，您可以将它们的外观复制到位图中，隐藏它们，然后在您自己的绘画例程中使用位图。当控件需要工作时，您可以取消隐藏它。

顺便说一句，使用 bitmap.GetPixel 或 SetPixel 非常慢。这是我在操纵 32 位位图（其中蓝色、绿色、红色和 alpha 是字节）周围的一些旧代码：

```
BitmapData bmpData = bitmap.LockBits(pixelRect, ImageLockMode.ReadWrite, PixelFormat.Format32bppArgb);

unsafe
{
    byte* bytes = (byte*)bmpData.Scan0;
    for (int row = 0; row < pixelRect.Height; row++)
    {
        for (int col = 0; col < pixelRect.Width * 4; ) // * 4: 4 bytes per pixel 
        {
            bytes[row * bmpData.Stride + col++] = blue;
            bytes[row * bmpData.Stride + col++] = green;
            bytes[row * bmpData.Stride + col++] = red;
            bytes[row * bmpData.Stride + col++] = alpha;
        }
    }
}

// Unlock the bits.
bitmap.UnlockBits(bmpData); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-23T15:25:47.143

我一直无法找到解决这个问题的好方法。我发现这样做的唯一方法是通过创建自定义控件并使用大量自定义代码（我仍然没有完全工作）。我将关闭这个帖子，答案是：

在这个论坛上回答太复杂了。

# algorithm - 如何计算圆周上的点？

> ID：839899
> 
> 赞同：240
> 
> 时间：2009-05-08T13:57:13.840
> 
> 标签：algorithm, math, trigonometry

以下功能如何用各种语言实现？

给定输入值，计算`(x,y)`圆周上的点：

*   半径
*   角度
*   来源（可选参数，如果语言支持）

* * *

## 回答 #1

> 赞同：630
> 
> 时间：2009-05-08T14:03:36.540

圆的[参数方程](http://en.wikipedia.org/wiki/Circle#Equations)是

```
x = cx + r * cos(a)
y = cy + r * sin(a) 
```

其中*r*是半径，*cx,cy*是原点，*a*是角度。

这很容易适应任何具有基本三角函数的语言。*请注意，大多数语言将使用[弧度](https://en.wikipedia.org/wiki/Radian)作为三角函数中的角度，因此不是循环通过 0..360 度，而是循环通过 0..2PI 弧度。*

* * *

## 回答 #2

> 赞同：53
> 
> 时间：2009-05-08T13:57:53.837

这是我在 C# 中的实现：

```
 public static PointF PointOnCircle(float radius, float angleInDegrees, PointF origin)
    {
        // Convert from degrees to radians via multiplication by PI/180        
        float x = (float)(radius * Math.Cos(angleInDegrees * Math.PI / 180F)) + origin.X;
        float y = (float)(radius * Math.Sin(angleInDegrees * Math.PI / 180F)) + origin.Y;

        return new PointF(x, y);
    } 
```

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-05-08T14:15:40.270

[当您有复数](http://imgs.xkcd.com/comics/e_to_the_pi_times_i.png)时谁需要触发：

```
#include <complex.h>
#include <math.h>

#define PI      3.14159265358979323846

typedef complex double Point;

Point point_on_circle ( double radius, double angle_in_degrees, Point centre )
{
    return centre + radius * cexp ( PI * I * ( angle_in_degrees  / 180.0 ) );
} 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2020-02-27T04:49:45.523

在**JavaScript (ES6)**中实现：

```
/**
    * Calculate x and y in circle's circumference
    * @param {Object} input - The input parameters
    * @param {number} input.radius - The circle's radius
    * @param {number} input.angle - The angle in degrees
    * @param {number} input.cx - The circle's origin x
    * @param {number} input.cy - The circle's origin y
    * @returns {Array[number,number]} The calculated x and y
*/
function pointsOnCircle({ radius, angle, cx, cy }){

    angle = angle * ( Math.PI / 180 ); // Convert from Degrees to Radians
    const x = cx + radius * Math.sin(angle);
    const y = cy + radius * Math.cos(angle);
    return [ x, y ];

} 
```

* * *

**用法：**

```
const [ x, y ] = pointsOnCircle({ radius: 100, angle: 180, cx: 150, cy: 150 });
console.log( x, y ); 
```

[密码笔](https://codepen.io/kostasx/pen/vYOxwLd?editors=1010)

```
/**
 * Calculate x and y in circle's circumference
 * @param {Object} input - The input parameters
 * @param {number} input.radius - The circle's radius
 * @param {number} input.angle - The angle in degrees
 * @param {number} input.cx - The circle's origin x
 * @param {number} input.cy - The circle's origin y
 * @returns {Array[number,number]} The calculated x and y
 */
function pointsOnCircle({ radius, angle, cx, cy }){
  angle = angle * ( Math.PI / 180 ); // Convert from Degrees to Radians
  const x = cx + radius * Math.sin(angle);
  const y = cy + radius * Math.cos(angle);
  return [ x, y ];
}

const canvas = document.querySelector("canvas");
const ctx = canvas.getContext("2d");

function draw( x, y ){

  ctx.clearRect( 0, 0, canvas.width, canvas.height );
  ctx.beginPath();
  ctx.strokeStyle = "orange";
  ctx.arc( 100, 100, 80, 0, 2 * Math.PI);
  ctx.lineWidth = 3;
  ctx.stroke();
  ctx.closePath();

  ctx.beginPath();
  ctx.fillStyle = "indigo";
  ctx.arc( x, y, 6, 0, 2 * Math.PI);
  ctx.fill();
  ctx.closePath();

}

let angle = 0;  // In degrees
setInterval(function(){

  const [ x, y ] = pointsOnCircle({ radius: 80, angle: angle++, cx: 100, cy: 100 });
  console.log( x, y );
  draw( x, y );
  document.querySelector("#degrees").innerHTML = angle + "&deg;";
  document.querySelector("#points").textContent = x.toFixed() + "," + y.toFixed();

}, 100 );
```

```
<p>Degrees: <span id="degrees">0</span></p>
<p>Points on Circle (x,y): <span id="points">0,0</span></p>
<canvas width="200" height="200" style="border: 1px solid"></canvas>
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2021-01-24T10:29:17.307

在给定距离的圆周上计算点。
作为比较...当在直接路径中围绕固体对象移动时，这在游戏 AI 中可能很有用。

[![在此处输入图像描述](https://i.stack.imgur.com/KzMLT.png)](https://i.stack.imgur.com/KzMLT.png)

```
public static Point DestinationCoordinatesArc(Int32 startingPointX, Int32 startingPointY,
    Int32 circleOriginX, Int32 circleOriginY, float distanceToMove,
    ClockDirection clockDirection, float radius)
{
    // Note: distanceToMove and radius parameters are float type to avoid integer division
    // which will discard remainder

    var theta = (distanceToMove / radius) * (clockDirection == ClockDirection.Clockwise ? 1 : -1);
    var destinationX = circleOriginX + (startingPointX - circleOriginX) * Math.Cos(theta) - (startingPointY - circleOriginY) * Math.Sin(theta);
    var destinationY = circleOriginY + (startingPointX - circleOriginX) * Math.Sin(theta) + (startingPointY - circleOriginY) * Math.Cos(theta);

    // Round to avoid integer conversion truncation
    return new Point((Int32)Math.Round(destinationX), (Int32)Math.Round(destinationY));
}

/// <summary>
/// Possible clock directions.
/// </summary>
public enum ClockDirection
{
    [Description("Time moving forwards.")]
    Clockwise,
    [Description("Time moving moving backwards.")]
    CounterClockwise
}

private void ButtonArcDemo_Click(object sender, EventArgs e)
{
    Brush aBrush = (Brush)Brushes.Black;
    Graphics g = this.CreateGraphics();

    var startingPointX = 125;
    var startingPointY = 75;
    for (var count = 0; count < 62; count++)
    {
        var point = DestinationCoordinatesArc(
            startingPointX: startingPointX, startingPointY: startingPointY,
            circleOriginX: 75, circleOriginY: 75,
            distanceToMove: 5,
            clockDirection: ClockDirection.Clockwise, radius: 50);
        g.FillRectangle(aBrush, point.X, point.Y, 1, 1);

        startingPointX = point.X;
        startingPointY = point.Y;

        // Pause to visually observe/confirm clock direction
        System.Threading.Thread.Sleep(35);

        Debug.WriteLine($"DestinationCoordinatesArc({point.X}, {point.Y}");
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2022-02-04T13:08:46.227

```
int x = (int)(radius * Math.Cos(degree * Math.PI / 180F)) + cCenterX;
int y = (int)(radius * Math.Sin(degree * Math.PI / 180F)) + cCenterY; 
```

`cCenterX`和是圆的`cCenterY`中心点

# c# - C# StructLayout/FieldOffset 和数组中的索引

> ID：839903
> 
> 赞同：5
> 
> 时间：2009-05-08T13:57:30.237
> 
> 标签：c#, arrays, indexing, alignment, field

我在正确使用 FieldOffset 和数组时遇到了一些问题。下面的代码是一个对我来说不能正常工作的例子：

```
[StructLayout(LayoutKind.Explicit)]
public struct IndexStruct {
    [FieldOffset(0)]
    public byte[] data;

    [FieldOffset(0)]
    public short[] idx16;

    [FieldOffset(0)]
    public int[] idx32;
} 
```

例如，如果我将名为“data”的数组设置为序列化字节数组，然后尝试使用“idx16”字段将数据检索为short，则索引仍对齐为字节[]。这意味着 idx16 [1](https://stackoverflow.com/questions/619041/what-is-the-fastest-way-to-convert-a-float-to-a-byte/619307#619307)获取数据中的第二个字节，而不是第二个 16 位字（字节 2 和 3）。如果我做相反的我索引短裤而不是字节，这意味着偏移对齐是从源数据继承的。我的问题，有没有办法解决这个问题？我知道我可以通过乘以元素的大小来补偿索引值，但是还有其他方法吗？

[这](https://stackoverflow.com/questions/619041/what-is-the-fastest-way-to-convert-a-float-to-a-byte/619307#619307)是我在 StackOverflow 上找到的答案，但是在尝试该代码时发现它无法正常工作。在 VS 中使用单元测试并使用以下代码进行了尝试，但没有成功：

```
[TestMethod()]
public void SumTest() {
    float[] fArr = {2.0f, 0.5f, 0.0f, 1.0f};
    MemoryStream ms = new MemoryStream();
    for (int i = 0; i < fArr.Length; i++) {
        ms.Write(BitConverter.GetBytes(fArr[i]), 0, sizeof(float));
    }
    byte[] buff = ms.ToArray();
    double expected = 3.5f;
    double actual = Sum(buff);
    Assert.AreEqual(expected, actual);
} 
```

提前谢谢了！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-08T14:04:16.757

问题是（据我所知）您已经合并了数组的**引用**- 所以最后设置的数组将获胜。一旦有一个数组，它就会使用索引器（不是字节偏移量） - 所以大小无关紧要。

“正确”（或不正确，视情况而定）执行此操作的方法可能是使用不安全的代码-获取指向数组的指针-例如：

```
 IndexStruct s = new IndexStruct();
    s.data = new byte[] { 1, 0, 0, 0, 1, 1 };

    unsafe
    {
        fixed (short* data = s.idx16)
        {
            Console.WriteLine(data[0]); // should be 1 (little-endian)
            Console.WriteLine(data[1]); // should be 0
            Console.WriteLine(data[2]); // should be 257
        }
    } 
```

当然，我不确定我是否推荐它——但这似乎达到了你想要的效果？

我还想知道您是否可以`struct`完全放弃并直接使用不安全的访问`byte[]`：

```
 byte[] raw = new byte[] { 1, 0, 0, 0, 1, 1 };
    unsafe
    {
        fixed (byte* addr = raw)
        {
            short* s = (short*)addr;
            Console.WriteLine(s[0]); // should be 1
            Console.WriteLine(s[1]); // should be 0
            Console.WriteLine(s[2]); // should be 257
        }
    } 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2009-05-08T14:11:17.940

您的 FieldOffset 定义了每个数据元素在结构内的位置。

通过将它们全部设置为 0，您是在告诉编译器它们都在位置 0。

我看到的第二件事是您正在创建一个字节、短裤和整数数组。

参见：[MSDN StructLayoutAttribute](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.structlayoutattribute.aspx)

```
[StructLayout(LayoutKind.Explicit)]
public struct IndexStruct {
        [FieldOffset(0)]
        public byte[16] data;

        [FieldOffset(16)]
        public short idx16;

        [FieldOffset(18)]
        public int idx32;
} 
```

# sql - 建立培训数据库的策略/工具

> ID：839912
> 
> 赞同：0
> 
> 时间：2009-05-08T13:59:02.227
> 
> 标签：sql, oracle

我们正在构建我们的网站和内部网的培训版本。

这些网站有大量的数据库交互（更新用户数据、跟踪工作流程等）

目标是拥有少量测试帐户，人们可以登录并通过该网站的工具运行。会话结束后，我们会将数据恢复到原始状态。

我们计划使用一个单独的训练数据库，该数据库在结构上与生产数据库保持同步，但有一部分生产数据被打乱以显示不敏感信息。

他们是否有任何工具可用于管理培训数据库（保持同步更改、恢复数据、加扰等）？

我们正在使用 Oracle 10g。他们有一些有用的工具，但仅此而已。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-08T14:03:57.553

准备一个包含测试数据的参考数据库并安排夜间任务，从而测试数据库将被参考数据库覆盖。您必须使这两个数据库保持同步，所以看看[这](http://code.google.com/p/octalforty-wizardby)是否有帮助。

# mysql - 按字段中最常见的单词对 MySQL 查询进行排序

> ID：839915
> 
> 赞同：2
> 
> 时间：2009-05-08T13:59:46.283
> 
> 标签：mysql, sql-order-by

我一直想知道这个，现在一个客户想知道它是否可行：

我有一份运动清单，细分如下：

*   男孩冰球
*   男子网球
*   女孩冰球
*   女子网球

...ETC

他们希望它排序为：

*   男孩冰球
*   女孩冰球
*   男子网球
*   女子网球

...ETC

我只是想知道这是否可以通过简单地更改查询来实现。不幸的是，我不能将运动设置为不区分性别并将其性别设置为单独的字段。我无法以任何重要的方式编辑数据库。我认为解决该问题的最佳方法是“最常见的单词”查询，但我不知道如何做到这一点。

提前感谢你们可以提供的任何帮助！

更新：客户最终放弃了请求，但是，我很可能将其作为接受的答案。仍然不是一种完全令人满意的做事方式，但我不确定 MySQL 中是否有更“优雅”的解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-08T14:06:50.307

'Most Words in Common' 如将每行中的常用词与下一行进行比较？这在 SQL 中会非常困难，因为很难通过查询来比较不同的行。

您可以通过规定的 CASE 语句订购，但它不会很漂亮：

```
...
按 CASE sport_name 排序
    当“男孩冰球”时 1
    WHEN 'Girls Ice Hockey' THEN 2
    当“男孩网球”时 3
    WHEN 'Girls Tennis' THEN 4
    -  ETC
结束案例

```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-08T14:12:20.947

你能做类似的事情吗

```
ORDER BY SUBSTRING(sport_name, 6), SUBSTRING(sport_name, 1, 5) 
```

如果所有运动都以男​​孩/女孩开头，在 mysql 中？

Alternatively the below might be better if space is being used as a delimiter:

```
ORDER BY SUBSTRING(sport_name, LOCATE(sport_name, ' ')), SUBSTRING_INDEX(sport_name, ' ', 1) 
```

Completely untested as I havent tried this before and dont have a mysql instance to test it against

# mysql - MySQL/SQL：使用更新表本身的相关子查询进行更新

> ID：839938
> 
> 赞同：24
> 
> 时间：2009-05-08T14:04:28.050
> 
> 标签：mysql, sql, sql-update, correlated-subquery

我有一个通用问题，我将尝试用一个例子来解释。

假设我有一个包含以下字段的表格：“id”、“name”、“category”、“appearances”和“ratio”

这个想法是我有几个项目，每个项目都与一个类别相关并且“出现”了几次。比率字段应包括每个项目的出现占类别中项目出现总数的百分比。

在伪代码中，我需要的是以下内容：

*   **对于每个类别**
    ，找到与其相关的项目的出现总和。例如，可以使用 ( `select sum("appearances") from table group by category`)

*   **对于每个项目**
    ，将比率值设置为项目的外观除以为上述类别找到的总和

现在我试图用一个更新查询来实现这一点，但似乎做不到。我认为我应该做的是：

```
update Table T    
set T.ratio = T.appearances /   
(    
select sum(S.appearances)    
from Table S    
where S.id = T.id    
) 
```

但是 MySQL 不接受 update 列中的别名 T，我没有找到其他方法来实现这一点。

有任何想法吗？

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2009-05-10T03:39:30.810

根据我收到的两个答案（都不完整，所以我自己写了），我最终做了如下：

```
UPDATE Table AS target
INNER JOIN 
(
select category, appearances_sum
from Table T inner join (
    select category as cat, sum(appearances) as appearances_sum
    from Table
    group by cat
) as agg
where T.category  = agg.cat
group by category
) as source
ON target.category = source.category
SET target.probability = target.appearances / source.appearances_sum 
```

它的工作速度非常快。我也尝试过使用相关子查询，但速度要慢得多（数量级），所以我坚持使用连接。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-09T08:35:08.193

在 UPDATE 之后立即使用连接： [参考手册 – 13.2.11 UPDATE 语法](http://dev.mysql.com/doc/refman/5.5/en/update.html)

所以 UPDATE table1 inner join table2 on .... set table1.foo=value where table2.bla = someothervalue

有了这些东西，总是看手册。MySql 有一个适当的参考手册，因此获得正确的语法应该不难；）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-08T14:13:50.367

在mssql中是这样做的，我觉得mysql是一样的或者类似的：

```
create table T (id int, ratio float, appearances int)
insert T values (1, null, 2)
insert T values (1, null, 3)

update T
set ratio = cast(appearances as float)/ agg.appearancesSum
from T join (
    select id, sum(appearances) as appearancesSum
    from T
    group by id
) as agg on t.id = agg.id 
```

# svn - 是否可以还原整个 SVN 存储库？

> ID：839942
> 
> 赞同：3
> 
> 时间：2009-05-08T14:05:11.917
> 
> 标签：svn, undo

我只是对我的 SVN 存储库做了一些愚蠢的事情，我不小心将一堆东西导入了根目录而不是子文件夹。我需要很长时间才能清理......除非有一种简单的方法可以对回购进行全局恢复？帮助文件讨论了恢复工作副本，但新导入的项目没有工作副本。有没有办法撤消导入？

> **重复**：[回滚或恢复整个 svn 存储库到旧版本](https://stackoverflow.com/questions/402159/roll-back-or-revert-entire-svn-repository-to-an-older-revision)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-08T14:11:03.620

看到这个问题：[Roll back or revert entire svn repository to an old revision](https://stackoverflow.com/questions/402159/roll-back-or-revert-entire-svn-repository-to-an-older-revision)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T14:11:22.887

一种方法是只备份到所需的版本，然后恢复存储库。

```
svnadm dump /path/to/repo -r 0:desired_max 
```

应该给你你想要的备份。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-08T14:14:17.573

签出完整的存储库，合并更改然后提交。

```
$ svn checkout https://server/repro temp
$ cd temp
$ svn merge -c -[revision] https://server/repro 
```

检查您的工作副本是否正确

```
$ svn commit -m "Revert of botched import." 
```

# wpf - 如何将窗口保持在不同线程中的另一个窗口之上？

> ID：839945
> 
> 赞同：0
> 
> 时间：2009-05-08T14:06:16.157
> 
> 标签：wpf, windows, winforms

我有一个承载一些 WPF UI（通过 ElementHost）的 WinForms 表单（称为“MyForm”）。我在与主 UI 线程不同的线程上显示此表单。

我希望“MyForm”保留在主应用程序窗口的顶部，因此我使用 Show 方法的 Show(IWin32Window) 重载显示表单，传入的 IWin32Window 是主应用程序窗口。

该窗口通过“启动器表单”间接显示，该“启动器表单”是单独的 STA 线程（传递给 Application.Run 的线程）的“应用程序表单”。原因是您无法在通过 Application.Run 启动表单时指定所有者窗口。

这是启动 MyForm 的代码（用作 STA 线程的 ThreadStart）：

```
void MyWindowThread()
{
  myForm = new MyForm();
  var launcherForm = new LauncherForm(myForm, mainWindow);
  Application.Run(new ApplicationContext(launcherForm));
  // launcherForm will Show myForm when it itself is shown.
} 
```

“启动器”形式：

```
public partial class LauncherForm : Form
{
  private readonly MyForm _myForm;
  private readonly IWin32Window _mainWindow;

  public WizardUILauncherForm(MyForm myForm, IWin32Window mainWindow)
  {
    _myForm = myForm;
    _mainWindow = mainWindow;
    InitializeComponent();
  }

  protected override void OnShown(EventArgs e)
  {
    // show the actual form that the user will interact with, on top of mainWindow.
    _myForm.Show(_mainWindow);
  }
} 
```

这几乎可以工作。'MyForm' 停留在主应用程序窗口的顶部，但直到我将鼠标悬停在带有工具提示的 WPF 控件上。显示工具提示时，“MyForm”会消失在主应用程序窗口后面。当我将鼠标悬停在窗体上的 WinForms 控件上以显示其工具提示时，这不会发生 - 它似乎特定于 WPF 控件。

它也仅在 MyForm 是前台窗口时发生。

请注意，当我使用 MyForm 作为应用程序表单（跳过启动器）并覆盖 MyForm 的 OnLoad 方法以使用 SetWindowLong 设置其所有者时，我遇到了同样的问题。这是一种较少涉及的方式，但我想使用一种不使用 P-Invoke 的机制，看看这是否会更好。两种方法都以相同的方式破坏。

**更新** 测试应用程序暗示此问题特定于在 Visual Studio 向导扩展中显示 UI。我想这使它更加利基，甚至更不可能被回答！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-08T14:20:17.513

以下 MSDN 文章是关于 WinAPI 调用的，但希望它能让您对不同线程之间的窗口激活有一些了解（我假设您无论如何都必须直接 P/Invoke 到 WinAPI 中，除非您可以避免在多个线程上使用您的 UI）：

> [用户界面中的多个线程](http://msdn.microsoft.com/en-us/library/ms810439.aspx)

（特别是有关*窗口焦点和激活注意事项*的部分）

# delphi - 在 Delphi 中分离数据访问、业务逻辑和 GUI 的任何建议

> ID：839957
> 
> 赞同：6
> 
> 时间：2009-05-08T14:10:26.163
> 
> 标签：delphi, user-interface, orm, business-objects, business-logic-layer

我想将数据层与业务逻辑和业务逻辑与 GUI 分开。潜入网络我偶然发现了一些资源，但仍然无法让我的想法清晰。有些人谈论模式，有些人则指向各种框架。我的要求是：

*   从 rdbms（主要是 mysql）CRUD 操作中操作数据
*   处理 id 生成（我应该使用自动增量或提供的数据引擎还是生成的 pascal 代码）
*   表关系可能是逻辑的（不使用参照完整性）或不是
*   需要从数据模型生成对象关系的能力
*   必须将数据转换为业务对象并操作业务逻辑
*   应使用现有的 gui 组件或免费软件

我需要的是：

*   一些指导技术/建议，带有基本的示例代码/应用程序布局（例如单位-类-模块-目录）...不是 OOP 方面的专家，当我必须设计类层次结构时我会感到困惑
*   一个带有教程的简单框架
*   甚至你自己的日常代码/框架/方法

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-08T14:55:51.827

由于您使用的是 Delphi，因此请务必查看 DataModules。这是您放置数据库访问组件和逻辑的地方。

将类放在普通的“单元”文件中。

让 UI 与这两者对话以使事情发生。您可以直接在表单上使用数据库访问组件，但这最好作为“仅显示”模式并使用数据模块对数据进行操作。（您可以在表单上为基本应用程序做任何事情，但如果您想模块化应用程序，将其分开是明智的）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-08T15:04:55.363

帮助实施这种分离的一种简单方法是为您的业务逻辑编写单元测试。除了其他（实质性）好处之外，使代码可测试意味着它不能（有意或无意地）与 UI 紧密耦合。

我尝试（但并不总是成功）通过使用 ClientDataSets 将数据层的细节分开，而不管后端使用的是什么（通常是 DBExpress 或 DBISAM）。我还尝试至少编写一些集成测试以确保数据层按预期工作（具有已知值的单独测试数据库）。

有了业务逻辑和数据（甚至是部分），UI 就更加直接。并且可维护。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-09T06:53:36.937

看看[tiOPF](http://tiopf.sourceforge.net/)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-10T03:31:15.977

我个人使用[tiopf](http://www.tiopf.com)作为商业模式。Tiopf 提供数据访问层。存储库中的最新代码包括一个类似于 MVC 的模型-gui-mediator 框架，用于显示模型。这允许您使用标准的 delphi 组件显示您的数据。

Tiopf 还包含许多 ID 生成器（guid、32 位和 64 位整数等）。

如果您对 tiopf 感兴趣，我建议您从查看我的[概述](http://tiopf.sourceforge.net/Doc/overview/index.shtml)开始。然后将任何问题发送到新闻组。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-08T14:37:15.427

尝试使用开源[InstantObjects](http://www.instantobjects.org/)，您将始终希望将其用于 Delphi 中的各种数据库编程。

在 IO 中，您必须在其接口中定义整个数据结构，然后它将为您生成必要的代码。

去尝试一下。

至于 id Generation 信任 MySQL 为您生成一个自动增量 id。不要花时间编码。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-08T16:41:40.480

我使用并且效果很好的一种方法是尝试从您的应用程序中扮演不同的角色，然后像您在那个角色中一样进行编程。例如，当您在数据库后端工作时，甚至不要考虑 gui。而是考虑公开只处理数据的类和方法。如果您制作自己的 SDK 供以后使用，您会发现维护起来会容易得多。

基于测试的开发是你的朋友。了解 DUnit，并创建简洁的小测试来练习任何重要的代码。记录接口，以及通过查看满是代码的屏幕不明显的任何内容。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-10T19:56:58.723

我会看看 Model-View-Controller（它是 Observer / Observable 模式的扩展）。这意味着“视图”（即 UI）只知道如何更新数据，然后响应正在更新的数据。Model（或 Observable）知道如何操作数据并告诉 Views 它已被更新。这意味着您可以替换 UI 而无需更改数据提供者，反之亦然。

在 Google 上进行搜索，因为 Delphi 有很多这样的例子（但对于 Java / C# 等来说没有那么多）

# c++ - C++ 中的自定义迭代器

> ID：839958
> 
> 赞同：30
> 
> 时间：2009-05-08T14:10:52.417
> 
> 标签：c++, stl, iterator

我有一个 TContainer 类，它是几个指向 TItems 类的 stl 集合指针的集合。

我需要创建一个迭代器来遍历我的 TContainer 类中所有集合中的元素，从而抽象出内部工作的客户端。

有什么好方法可以做到这一点？我应该创建一个扩展迭代器的类（如果是，我应该扩展什么迭代器类），我应该创建一个迭代器聚合的迭代器类吗？

我只需要一个 FORWARD_ONLY 迭代器。

IE，如果这是我的容器：

```
typedef std::vector <TItem*> ItemVector;
class TContainer {
   std::vector <ItemVector *> m_Items;
}; 
```

什么是遍历 m_Items 成员变量的向量中包含的所有项目的好迭代器。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-05-08T14:28:19.850

当我做自己的迭代器时（不久前），我从 std::iterator 继承并将类型指定为第一个模板参数。希望有帮助。

对于前向迭代器，用户 forward_iterator_tag 而不是以下代码中的 input_iterator_tag。

这个类最初取自 istream_iterator 类（并为我自己的使用而修改，因此它可能不再类似于 istram_iterator）。

```
template<typename T>
class <PLOP>_iterator
         :public std::iterator<std::input_iterator_tag,       // type of iterator
                               T,ptrdiff_t,const T*,const T&> // Info about iterator
{
    public:
        const T& operator*() const;
        const T* operator->() const;
        <PLOP>__iterator& operator++();
        <PLOP>__iterator operator++(int);
        bool equal(<PLOP>__iterator const& rhs) const;
};

template<typename T>
inline bool operator==(<PLOP>__iterator<T> const& lhs,<PLOP>__iterator<T> const& rhs)
{
    return lhs.equal(rhs);
} 
```

查看有关迭代器标签的文档：
[http ://www.sgi.com/tech/stl/iterator_tags.html](http://www.sgi.com/tech/stl/iterator_tags.html)

刚刚重新阅读了有关迭代器的信息：
[http ://www.sgi.com/tech/stl/iterator_traits.html](http://www.sgi.com/tech/stl/iterator_traits.html)

这是旧的做事方式（iterator_tags），更现代的方法是为您的迭代器设置 iterator_traits<> 以使其与 STL 完全兼容。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-05-08T14:55:19.567

如果您可以访问 Boost，那么 using[`iterator_facade`](http://www.boost.org/doc/libs/release/libs/iterator/doc/iterator_facade.html)是最强大的解决方案，而且使用起来非常简单。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2010-02-20T22:23:45.833

首先让我们概括一下：

```
typedef int value_type;
typedef std::vector<value_type*> inner_range;
typedef std::vector<inner_range*> outer_range; 
```

现在迭代器：

```
struct my_iterator : std::iterator_traits<inner_range::iterator> 
{
    typedef std::forward_iterator_tag iterator_category;

    my_iterator(outer_range::iterator const & outer_iterator, 
                outer_range::iterator const & outer_end)
    : outer_iterator(outer_iterator), outer_end(outer_end)
    { 
        update();
    }

    my_iterator & operator++()
    {
        ++inner_iterator;
        if(inner_iterator == inner_end)
        {
            ++outer_iterator;
            update();
        }
        return *this;
    }

    reference operator*() const
    {   
        return *inner_iterator;
    }

    bool operator==(my_iterator const & rhs) const
    {   
        bool lhs_end = outer_iterator == outer_end;
        bool rhs_end = rhs.outer_iterator == rhs.outer_end;
        if(lhs_end && rhs_end)
            return true;
        if(lhs_end != rhs_end)
            return false;
        return outer_iterator == rhs.outer_iterator 
            && inner_iterator == rhs.inner_iterator;
    }

private:

    outer_range::iterator outer_iterator, outer_end;
    inner_range::iterator inner_iterator, inner_end;

    void update()
    {
        while(outer_iterator != outer_end)
        {
            inner_iterator = (*outer_iterator)->begin();
            inner_end = (*outer_iterator)->end();
            if(inner_iterator == inner_end)
                ++outer_iterator;
            else
                break;
        }
    }    
}; 
```

此类假定外部迭代器包含指向内部范围的指针，这是您问题中的要求。这反映在成员中，在和`update`之前的箭头中。如果要在外部迭代器按值包含内部范围的更常见情况下使用此类，则可以将这些箭头替换为点。注意顺便说一句，这个类对于内部范围包含指针这一事实是不可知的，只有类的客户需要知道这一点。`begin()``end()`

如果我们使用，代码可能会更短，`boost::iterator_facade`但没有必要为如此​​简单的事情添加 boost 依赖项。此外，唯一棘手的部分是相等和递增操作，无论如何我们都必须编写这些代码。

我留下了以下样板成员作为“读者练习”：

*   后缀增量迭代器
*   运算符！=
*   默认构造函数
*   运算符->

另一个有趣的练习是将其转换为适用于任意容器的模板。代码基本相同，只是你必须`typename`在几个地方添加注释。

使用示例：

```
int main()
{
    outer_type outer;
    int a = 0, b = 1, c = 2;
    inner_type inner1, inner2;
    inner1.push_back(&a);
    inner1.push_back(&b);
    inner2.push_back(&c);
    outer.push_back(&inner1);
    outer.push_back(&inner2);

    my_iterator it(outer.begin(), outer.end());
                e(outer.end(), outer.end());
    for(; it != e; ++it)
        std::cout << **it << "\n";
} 
```

哪个打印：

> 0 1 2

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-05-08T14:33:49.010

迭代器只是一个支持某个接口的类。至少，您希望能够：

*   增加和/或减少它
*   取消引用它以获取它“指向”的对象
*   测试它的平等和不平等
*   复制并分配它

一旦你有一个可以为你的集合明智地做到这一点的类，你将需要修改集合以具有返回迭代器的函数。至少你会想要

*   一个 begin() 函数，它返回位于第一个元素的新迭代器类型的实例
*   一个 end() 函数，它返回一个迭代器，该迭代器（可能在概念上）位于容器中项目末尾的一个位置

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-11T18:07:14.497

检查[视图模板库](http://www.zib.de/weiser/vtl/toc.html)。

特别检查

1.  [联合视图](http://www.zib.de/weiser/vtl/union_view.html)呈现两个串联的容器。
2.  [串联视图](http://www.zib.de/weiser/vtl/concatenation_view.html)显示串联的容器集合。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-06-17T09:39:27.740

这是我能够生成的最简单的代码（用于自定义迭代器）。请注意，我才刚刚开始探索这个领域。例如，这会调用内置`upper_bound`函数对整数函数执行二进制搜索`x^2`。

```
#include <algorithm>
#include <iostream>

using namespace std;

class Iter
{
  public:
  int x;
  Iter() { x = -1; }
  Iter(int a) { x = a; }

  bool operator!=(Iter &i2) const { return x != i2.x; }
  void operator++() { x++; }
  void operator+=(int b) { x += b; }
  int operator-(const Iter &i2) const { return x - i2.x; }
  int operator*() const {
    cout << "calculating for x " << x << endl;
    return x*x;
  }

  typedef random_access_iterator_tag iterator_category;
  typedef int value_type;
  typedef int difference_type;
  typedef int* pointer;
  typedef int& reference;
};

main ()
{
  ios::sync_with_stdio(false);
  cout << upper_bound(Iter(0), Iter(100), 40).x << endl;
}

// :collapseFolds=1:folding=explicit: 
```

这就是输出的样子：

```
calculating for x 50
calculating for x 25
calculating for x 12
calculating for x 6
calculating for x 9
calculating for x 8
calculating for x 7
7 
```

# asp.net-mvc - ASP.Net MVC 复选框问题

> ID：839963
> 
> 赞同：1
> 
> 时间：2009-05-08T14:11:08.347
> 
> 标签：asp.net-mvc

我是一个 ASP.Net MVC 菜鸟。

我无法正确呈现复选框，即选中/未选中。

这是我观点的一个片段：

```
<input id="<%= item.ReportName + "|" + "email" %>" type="checkbox" checked="<% if     (item.Email == true)  { %>true<% } else {  %>false<% } %>" onclick="ajaxfunction(this)" /> 
```

这是来自 IE 的源视图：

```
<input id="TestRep02|showinhomelist" type="checkbox" onclick="ajaxfunction(this)" /> 
```

请注意，html 源代码中没有选中的属性。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T14:15:17.417

它应该是：

```
<input id="<%= item.ReportName + "|" + "email" %>" 
    type="checkbox" <% if (item.Email == true)  { %>checked="yes"<% } %>"
    onclick="ajaxfunction(this)" /> 
```

注意：选中的属性接受“是”和“否”..不是真或假..

# javascript - 用其他语言编写 JavaScript

> ID：839966
> 
> 赞同：2
> 
> 时间：2009-05-08T14:11:30.590
> 
> 标签：javascript, html, multilingual

我有一些不会说英语的客户。他们希望我为他们编写的 JavaScript 是另一种语言。

浏览器可以理解其他语言，还是我仅限于非英语评论？

```
navigateur.nomApp.indice("Microsoft") 
```

代替 ：

```
navigator.appName.indexOf("Microsoft") 
```

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-05-08T14:16:44.823

JavaScript 不是用英语编写的，它是用 JavaScript 编写的。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2009-05-08T14:14:49.803

JavaScript 的关键字是英文的，浏览器的对象名称是英文的。你无法解决这个问题。即使您所有的变量和函数名称都是法语，您仍然需要使用英语关键字。您的客户将不得不忍受这一点。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-05-08T14:15:00.270

例如，您可以获取任何对象并将其分配给具有法语名称的变量

```
var nomAppDeNavigateur = navigator.appName; 
```

然后在任何地方使用它，它只是仅限于 Javascriptish 的关键字。但是，无论您的目标是什么语言，它仍然必须有意义。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-12-01T22:19:48.210

JavaScript 是一种动态语言，可以很好地响应猴子补丁：

```
String.prototype.indice= String.prototype.indexOf;
navigator.nomApp= navigator.appName;
window.navigatrice= navigator; 
```

瞧！您的代码片段按原样工作。好吧，除了你的浏览器是男性化的奇怪方式。

PS。不要这样做。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-08T14:15:21.317

我强烈建议你不要这样做。我也认为这是不可能的。您不仅丢弃了大量仅使用英语的文档，而且还使非法语人士很难使用您的应用程序进行编码。

请参阅 Jeff Atwoods 的帖子：

[丑陋的美国程序员](http://www.codinghorror.com/blog/archives/001248.html)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-08T15:01:03.920

大多数编程语言都基于英语。

正如 Jeff 在最近的[一篇博客文章](http://www.codinghorror.com/blog/archives/001248.html)中指出的那样，Eric Raymond 指出，[真正的黑客需要实用英语](http://www.catb.org/~esr/faqs/hacker-howto.html#skills4)：

> 早在 1991 年左右，我了解到许多将英语作为第二语言的黑客在技术讨论中使用它，即使他们的母语相同。当时向我报告说，英语比任何其他语言都具有更丰富的技术词汇，因此只是一种更好的工作工具。出于类似的原因，用英语编写的技术书籍的翻译通常不能令人满意（当它们完全完成时）。

在 Jeff 的帖子中也指出的相关说明中，维基百科保留了一个[非英语编程语言](http://en.wikipedia.org/wiki/Non-English-based_programming_languages)列表。

您的客户要么必须学习基本英语，要么必须使用非英语语言。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-08T14:15:14.203

编程语言关键字是固定的。浏览器无法将它们从一种口语翻译成另一种口语。您自己创建的功能可以是您选择的任何口语。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-08T14:16:17.240

在 JS 中和任何其他语言一样，您可以用您想要的语言定义自己的类/方法，但标准库通常是用英语编写的，所以这就是您所拥有的......

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-08T14:14:58.180

您完全可以用其他语言编写自己的变量、函数和 API；但是，绝大多数现有的 API 都将是英文的，浏览器无法理解您`navigator`在编写`navigateur`.

从表面上看，您可以编写一个翻译框架，将法语关键字和法语 API 调用翻译成英语对应项，但这将是大量工作。

# windows - SSH Windows 到 UNIX

> ID：839968
> 
> 赞同：2
> 
> 时间：2009-05-08T14:13:35.080
> 
> 标签：windows, unix, shell, ssh

我从连接到 UNIX 服务器的 Windows 机器构建了一个批处理文件。然后，我希望命令从批处理文件在 UNIX 中执行。登录到服务器后，UNIX 似乎无法识别我的命令。这是我编码的：

ssh SERVERNAME 退出

现在，我只是想让它登录并退出。我登录到服务器，但退出命令没有执行。有谁知道在我使用这个批处理文件登录后让 UNIX 执行我的命令？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-08T14:16:30.127

`exit`没有被执行，因为它不是一个命令，它是一个内部的 shell（`which exit`如果你不相信我的话）。试试`echo hello world`吧。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-08T14:17:12.777

ssh SERVERNAME '退出'

您可能最终会得到以下结果：

```
ssh SERVERNAME 'bash some_remote_script.sh' 
```

（用你喜欢的任何 shell 替换 bash）

我不确定为什么“混乱”不断得到支持，他的回答与这个问题无关。ssh SERVERNAME 'exit' 工作得很好。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-08T15:40:27.850

好吧，它似乎对我有用，但试试这个：

```
ssh -t server command 
```

您可能只需要分配的伪 tty。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-08T14:18:32.510

[查看plink 文档](http://the.earth.li/~sgtatham/putty/0.53b/htmldoc/Chapter7.html)中的“7.3 在批处理文件和脚本中使用 Plink”部分。这可能会做你想要的。

# sql-server - ColdFusion - 将表单字段插入 SQL Server MONEY

> ID：839971
> 
> 赞同：1
> 
> 时间：2009-05-08T14:14:24.547
> 
> 标签：sql-server, coldfusion

我正在尝试使用 ColdFusion 将表单字段中的值插入到 SQL Server MONEY 字段中。如果金额只是美元，或者美分超过 12，则插入没问题。

但是，如果美分金额小于 12，根据抛出的错误，系统似乎在插入之前将金额转换为日期格式，而我没有要求。然后，当然，它出错了，因为我试图在 MONEY 字段中插入一个日期。（！）

我尝试使用类型为 CF_SQL_DECIMAL 的 CFQUERYPARAM，但这不起作用。任何想法将不胜感激。

这是表单代码：

```
<CFFORM ACTION="_execute_project_payment.cfm?action=Add" METHOD="post" NAME="FormX">
<CFOUTPUT>
<INPUT TYPE="hidden" NAME="projectID" VALUE="#projectID#">
<TR>
<TD CLASS="label" ALIGN="right" VALIGN="top">Payments:</TD>

<TD>

$<CFINPUT NAME="payment" TYPE="TEXT" VALIDATE="FLOAT" SIZE="15" REQUIRED="YES" MESSAGE="You must enter a payment amount.">&nbsp;&nbsp;&nbsp;Date:

<CFINPUT TYPE="text" name="payment_date" id="payment_date" SIZE="12" VALIDATE="DATE" REQUIRED="YES" MESSAGE="You must enter a payment date.">

<img src="cal_icon.gif" id="trigger_payment_date"
style="cursor: pointer; border: 0px;"
title="Date selector"
onmouseover="this.style.background=’red’;"
onmouseout="this.style.background=’’" />
<script type="text/javascript">
Calendar.setup({
inputField : "payment_date",
ifFormat : "%m/%d/%Y",
button : "trigger_payment_date",
align : "Tl",
singleClick : false
});
</script>

<INPUT TYPE="Submit" VALUE="Add">

<BR> 

</TD>
</TR>

</CFOUTPUT>
</CFFORM> 
```

这是插入：

```
<CFSET paydateODBC = CreateODBCDate(FORM.payment_date)>

<CFQUERY NAME="add_project_payment" DATASOURCE="#dsource#" USERNAME="#usern#" PASSWORD="#passw#">
INSERT INTO project_payments (
                        projectID,
                        payment,
                        payment_date
                    )
            VALUES (
                        #projectID#,
                        #FORM.Payment#,
                        #paydateODBC#
                    )
</CFQUERY> 
```

这是错误，尝试输入 666.10 作为付款：

```
[Macromedia][SQLServer JDBC Driver][SQLServer]Conversion failed when converting datetime from character string.

The error occurred in C:\Websites\qrpqiy\toubltracker\_execute_project_payment.cfm: line 21

19 :                        #projectID#,
20 :                         #FORM.payment#,
21 :                         #paydateODBC#
22 :                    )
23 : </CFQUERY>

SQLSTATE      22007
SQL        INSERT INTO project_payments ( projectID, payment, payment_date ) VALUES ( 433, {d '0666-10-01'}, {d '2009-05-15'} )
VENDORERRORCODE       241 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-08T15:51:25.767

好吧，根据 Adob​​e 的说法，问题在于我的字段名称。显然，在 CF 中有一个晦涩的旧函数，当您还包含“payment_date”字段时，您可以将“付款”之类的字段作为日期进行评估。啊。我更改了字段名称，现在可以使用。

Adobe 的文档： http://livedocs.adobe.com/coldfusion/8/htmldocs/help.html?content= [validateData_10.html#1154690](http://livedocs.adobe.com/coldfusion/8/htmldocs/help.html?content=validateData_10.html#1154690)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-08T14:32:22.867

就个人而言，我从不在 SQL 中使用 Money 类型。如果我使用 Decimal 字段类型，我发现我有更好的控制程度。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-08T15:14:25.307

```
<cfqueryparam value="#theamount#" cfsqltype="cf_sql_money"> 
```

这就是我使用的，我从来没有遇到过问题。如果您可以发布您的查询和一些存根数据，这将有助于更好地确定原因。

# java - 如何从 HttpServlet 获取客户端的 MAC 地址？

> ID：839973
> 
> 赞同：27
> 
> 时间：2009-05-08T14:14:50.677
> 
> 标签：java, tomcat, servlets, tcp

我被要求编写一个 servlet 来收集客户端的详细信息，例如 ip、ma​​c 地址等。

获取他的 IP 非常简单（`request.getRemoteAddr()`），但我没有找到一种优雅的方式来获取他的 MAC 地址。

Web 服务器可以访问 Mac 地址等数据似乎是合理的，因为它会获取 TCP 数据包和所有数据。这个数据在某处注册吗？可以访问吗？

（我在 Tomcat6 之上工作）

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-05-08T14:41:44.200

你可能不会得到你想要的。（客户端的 MAC 地址）

如果服务器足够近（通过集线器或交换机直接连接），您可以[ARP](http://en.wikipedia.org/wiki/Address_Resolution_Protocol)获取 MAC 地址。如果您对 Internet 上的 IP 执行此操作，您可能会获得最近的路由器或交换机的内部接口。

由于 TCP/IP 的工作方式，“帧”中使用的 MAC 地址将被窃取并在每个跃点重新组装，信息在服务器和主机之间获取。

![替代文字](https://upload.wikimedia.org/wikipedia/commons/thumb/3/3b/UDP_encapsulation.svg/450px-UDP_encapsulation.svg.png)

[封装](http://en.wikipedia.org/wiki/Encapsulation_(networking))

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-08T14:19:49.043

TCP/IP ......你无法获得 MAC 地址，这是一个太底层的 AFAIK

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-08T14:29:23.840

这通过 HttpServlet 类是不可能的。

我能想到的可能获取用户 MAC 地址的唯一方法是在客户端使用 Javascript 来检索它，然后将其放入您的服务器可以读取的 cookie 中。但是，我不知道是否可以使用 Javascript 获取 MAC 地址 - 对于浏览器来说，允许您这样做似乎是一种安全风险，因为它超出了浏览器的沙箱，但也许有一些黑客可以做到这一点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-08T14:24:20.733

我相信客户需要允许在他们的 JVM 中发生这种情况：

看到这个[线程](http://forums.sun.com/thread.jspa?threadID=5382175)

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2015-09-15T09:48:59.863

这个脚本在你的本地主机上工作的最好 100% 的概率，但你必须用你的网络主机检查这个

有一个更好的php代码

```
<font color="black" face="courier new">
<b>mac/linux/android</b>(arp -an)<br>

<?php
$mac = system('arp -an');
echo $mac;
echo "<hr>";
?>
<b>mac/linux/android</b>(ifconfig)<br>
<?php
$macall = system('ifconfig');
echo $macall;
echo "<hr>";
?>
<b>pc/win</b>(ipconfig /all)<br>
<?php
$pc = system('ipconfig /all');
echo $pc;
echo "<hr>";
?>
</font> 
```

# c++ - c++ by-ref 参数传递如何在汇编中编译？

> ID：839975
> 
> 赞同：4
> 
> 时间：2009-05-08T14:14:59.617
> 
> 标签：c++, assembly, compiler-construction

在大学的最后几年，我有一门关于编译器的课程。我们为 C 的一个子集创建了一个编译器。我一直想知道如何将 pass-by-ref 函数调用编译成 C++ 中的程序集。

我记得，pass-by-val 函数调用遵循以下过程：

*   存储PP的地址
*   将参数压入堆栈
*   执行函数调用
*   在函数中，从堆栈中弹出参数

引用传递有什么不同？(int void(int&);)

**编辑：**

我可能听起来完全迷失了，但如果你能帮助我，我会非常感激。

大家的回答基本都是传地址而不是传值。我明白这基本上就是传递指针的意思。那么，这两个函数怎么会有不同的行为呢？：

```
struct A {
    int x;
    A(int v){
        x = v;
    }
};

int byRef(A& v){
    v = A(3);
    return 0;
}

int byP   (A* v){
    v = &A(4); //OR new A(4)
    return 0;
}

int _tmain(int argc, _TCHAR* argv[])
{
    A a (1); A b (2);
    byRef(a); byP  (&b);
    cout << a.x << " " << b.x;

    system("pause");

    return 0;
} 
```

我知道在 byP(A*) 中，v 是按值传递的，因此，它不会影响调用者的参数。那么，你将如何根据 A* 来实现 byRef(A&)？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-08T14:23:06.117

你传递一个指向引用的指针，就像你传递任何其他指针一样，被调用者知道如何使用它。因此，根据实现，它可能不在堆栈上 - 在某些调用约定中，某些参数在寄存器中传递。

可能还有其他方法可以做到这一点，因为 C++ 标准没有指定如何实现引用 afaik，即使它们被实现为指针，我想它们也可能在调用约定中被区分。不过，指针是最明显的实现。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-08T14:25:41.150

通过引用调用将涉及传递指向值的指针而不是值本身的副本。如果你对血淋淋的细节感兴趣，你可以让你的编译器发出汇编语言并自己检查它。

**编辑：**您的指针示例应该是：

```
int byP (A* v) {
    * v = A(4);    // modify thing referenced by the pointer
    return 0;
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-08T15:02:27.240

```
int byRef(A& v){
  v = A(3);
  return 0;
} 
```

这调用了临时对象对通过引用传递的对象的赋值，函数调用中使用的对象被修改。如果未提供赋值运算符，将执行浅拷贝。

```
int byP   (A* v){
  v = &A(4); //OR new A(4)
  return 0;
} 
```

这会将指向临时对象的指针复制到传入的指针值。没有调用赋值函数。'v' 的值改变了，但是 v 指向的对象，作为参数传递的对象地址，没有改变。

如果你这样做：

```
struct A {
  int x;
  A(int v){
    x = v;
  }
  A &operator = (A &rhs){
    cout << "assignment!";
  }
}; 
```

那么“赋值”将在函数中输出，`byRef`而不是在`byP`函数中。

尽管`&`正如其他人所说，它是使用“幕后”指针实现的，但它们被视为语言传递给函数的对象。

因此，要实现`byRef`using 指针：

```
int byRefUsingP (A *v)
{
  *v = A(3);
  // or you could do:
  // v->operator = (A(3));
  // if an operator = is defined (don't know if it will work without one defined)
  return 0;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-08T14:21:34.077

不同的是它传递的是参数的地址，而不是参数的值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-08T14:24:59.560

我没有看过类似 GCC 的实现，但一般的想法是，不是传递变量的内容，而是传递它的地址（就像 C++ 代码使用“*”而不是“&”一样参数上）。

其他方案是可用的，但通常这将通过将值（或地址）压入堆栈来完成。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-08T14:25:51.710

我认为在 pass-by-val 中，过程将是： * 存储 PP 的值 * 将参数压入堆栈 * 执行函数调用 * 在函数中，从堆栈中弹出参数

在 pass-by-ref 中，程序将是您编写的程序

干杯

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-08T14:29:38.753

你可以自己看看。许多调试器允许您在代码和反汇编视图之间切换。我会在代码视图中的函数调用上设置一个断点，将应用程序运行到该点，切换到程序集，然后单步执行每个命令。

[剧透警告]

.

这是一个指针。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-09-30T17:45:28.850

按值传递时，编译器会发出代码以按位将源字节复制到目标变量。对于大型结构和/或频繁分配，这可能会变得非常低效。如果您的结构覆盖了赋值运算符，它将被调用，然后您可以控制复制的内容，但您仍在将整个结构推入堆栈。

当通过引用传递时，结构的地址被压入堆栈，这只是一个 int。这是传递大型对象的最有效方式。

当通过指针传递时，指针的地址被压入堆栈。必须取消引用指针才能获得结构的地址。有一个额外的操作。

顺便说一句，byP 函数有一个严重的错误：它将一个临时局部变量分配给一个指针。该结构在堆栈上分配，并且在超出范围后将（很可能）被覆盖。根据 Neil Butterworth 的示例，您必须使用“new”在堆上分配它，或者将结构分配给指针引用的值。

# javascript - 身份验证 - 对 wcf 的 asp.net ajax javascript 调用

> ID：839983
> 
> 赞同：1
> 
> 时间：2009-05-08T14:15:25.403
> 
> 标签：javascript, ajax, wcf, authentication

我们正在使用 WCF 服务按需加载组合框。这样，当用户开始键入时，ComboBox 会与 WCF 服务对话并获取必要的数据。

我们对 ASP.NET 应用程序进行了表单身份验证。问题是我只想允许我们系统中经过身份验证的用户进行此 WCF 调用。

我不想对 WCF 服务的每个请求进行身份验证，因为对于自动完成方案来说，这太过分了。我想过在组合框上下文中从客户端传递一个 GUID 值，并在 WCF 端比较该值，但这并不安全，因为通过执行查看源可以看到 GUID 值。

有没有其他人遇到过这个问题？任何建议表示赞赏。

谢谢，普拉蒂克

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-08T15:13:55.170

如果您在 WCF 服务上启用[ASP.NET 兼容模式](http://msdn.microsoft.com/en-us/library/aa702682.aspx)，则可以像保护任何 ASP.NET 页面一样保护它：

```
<location path="\secretWCFService.svc">
  <system.web>
    <authorization>
      <deny users ="?" />
    </authorization>
  </system.web>
</location> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T14:48:44.667

我相信您需要在服务上设置会话，然后打开身份验证，它应该启用一次登录场景。

看看这些人的回答，[WCF session with HTTPS](https://stackoverflow.com/questions/427954/wcf-sessions-with-https)。

# .net - 是否可以判断.NET 虚拟方法是否已在派生类中被覆盖？

> ID：839984
> 
> 赞同：3
> 
> 时间：2009-05-08T14:15:29.787
> 
> 标签：.net

问这个问题的行为表明我解决这个问题的方法是不正确的，所以我对直接解决这个问题的答案感兴趣，以及对我正在做的事情提出更清洁方法的答案。

考虑一个基类，它提供一组标准的服务和功能，以及围绕这些的一些结构。通过比喻，让我们考虑以下示例类：

```
public class ExampleBase
{
  public void Main()
  {
    // Do something
    PreValidate(); // Extensibility point for derived classes
    // Do something else
    PostValidate(); // Extensibility point for derived classes
    // Do something else 
  }

  protected virtual void PreValidate()
  {
  }

  protected virtual void PostValidate()
  {
  }
} 
```

派生类现在可以覆盖这些虚拟方法以提供一些自定义逻辑。

**问题**是：基类是否有可能在运行时发现派生类在调用虚拟方法*之前是否冒昧地覆盖了这些虚拟方法之一？*

*（如果在调用方法后*知道这个问题的答案就足够了，那么您也许可以用设置私有标志的方法替换基类中的空方法，这将表明该方法*没有*被覆盖。但是这可能如果派生类`base.PreValidate()`在其重写的实现中调用，就会被愚弄。）

如果需要这种级别的灵活性，也许最好的解决方案是使用完全不同的可扩展机制？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-08T14:23:55.040

虽然其他答案中提到了解决此问题的最佳方法，但我回答了问题标题（这将`new`解决问题）：

```
var isOverridden = 
   new Action(MethodName).Method.DeclaringType != typeof(BaseClass);
// Replace `Action` with any conforming delegate type. 
```

这个技巧使得 CLR 方法分派机制`MethodInfo`为我们找到它，而不是诉诸反射来找到它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-08T14:20:18.497

## 是否可以确定方法 X 在运行时是否被覆盖

是的，但是正如您已经指出的那样，您可能不想这样做。您可以使用 this.GetType() + 反射魔法在派生类中查找覆盖当前基的已定义方法。这是极其昂贵和棘手的，因为您必须考虑重载、深层层次结构和其他有趣的通用问题。

*编辑*

有关不使用反射的方法，请参阅 Mehrdad 的回答。

## 你应该怎么做？

您应该将此方法分为两部分。

1.  您绝对依赖运行的部分。使其成为非虚拟方法，因此派生类不会干扰它
2.  可扩展性部分。使其成为从 #1 调用的虚拟受保护方法。

例如

```
protected void PreValidate() {
  .. my validation code
  PreValidateImpl();
}

protected virtual void PreValidateImpl() {
  // Nothing by default
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-08T14:17:30.640

你可以这样做：

```
public abstract class ExampleBase
{
  public void Main()
  {
    // Do something
    PreValidate(); // Extensibility point for derived classes
    // Do something else
    PostValidate(); // Extensibility point for derived classes
    // Do something else 
  }

  protected abstract void PreValidate();

  protected abstract void PostValidate();

} 
```

这将强制所有派生类型覆盖这些方法。您最好不要在执行时检查这种事情 - 使用抽象类型和抽象方法，您允许编译器为您完成提升，以确保您的类型的所有使用者都覆盖这些方法。

如果类型 be`abstract`不起作用，那么您总是可以执行以下操作：

```
public class ExampleBase
{
    public void Main()
    {
        // Do something
        PreValidate(); // Extensibility point for derived classes
        // Do something else
        PostValidate(); // Extensibility point for derived classes
        // Do something else 
    }

    protected virtual void PreValidate()
    {
        throw new NotImplementedException();
    }

    protected virtual void PostValidate()
    {
        throw new NotImplementedException();
    }
} 
```

但是这种方法将任何潜在的错误从编译时转移到执行时，最好不惜一切代价避免。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-08T14:21:03.923

当然！您将不得不使用反射。

```
if (this.GetType().GetMethod("PreValidate").DeclaringType ==
        typeof(ExampleBase))
{
    // Not overridden
}
else
{
    // Overridden
} 
```

请记住，反射有点慢，所以你不想执行它，例如每秒一百万次。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-08T14:21:15.670

似乎您的 PreValidate() 和 PostValidate() 最好用作不同类型的扩展模型。将这些作为代表或满足特定接口的完整对象注入的提供者模型可能更适合您希望能够在运行时检查这些服务的状态。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-08T14:22:29.160

您可以使用接口进行模拟：

```
public interface ISupportPreValidate
{
    void PreValidate();
}

public interface ISupportPostValidate
{  
    void PostValidate();
}

public class Base
{
    public void Validate()
    {
        if(this is ISupportPreValidate)
            ((ISupportPreValidate)this).PreValidate();

        // Validation logic

        if(this is ISupportPostValidate)
            ((ISupportPostValidate)this).PostValidate();            
    }
} 
```

`Base`然后在派生类中实现所需的接口。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-08T14:21:49.693

问自己以下问题：

1.  我会从 ExampleBase 创建一个对象吗？还是我总是从这个类继承并从继承的类创建一个对象？
2.  PreValidate 和 PostValidate 是任何派生类的必需方法吗？

重点是，从您的设计来看，您确实应该使用抽象方法而不是虚拟方法创建一个抽象类。此外，从您的描述来看，这似乎也是您想要达到的目的。

```
public abstract class ExampleBase
{
    public void Main()
    {
        // Do something
        PreValidate(); // Extensibility point for derived classes
        // Do something else
        PostValidate(); // Extensibility point for derived classes
        // Do something else 
    }

    protected abstract void PreValidate();

    protected abstract void PostValidate();
} 
```

这样，派生类被强制定义这些方法。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-08T15:18:57.387

JaredPar 的替代方法很好，尽管事件在恕我直言，可扩展性更清洁。

```
protected event ThreadStart OnPreValidate;

protected void PreValidate()
{
  .. my validation code
  if (null != OnPreValidate) {
    OnPreValidate();
  }
} 
```

# .net - .net .ashx 文件的帮助

> ID：839986
> 
> 赞同：0
> 
> 时间：2009-05-08T14:15:58.710
> 
> 标签：.net, vb.net, web-services

我们有一个应用程序，它有几个 .ashx 文件，用于将文件上传到服务器。我们遇到的问题是我们对这些文件进行了更改并重新发布了应用程序，它不会更新 .assh 文件。真的，它不会对后面的代码进行更改。其他所有内容都已更新。我们正在使用 Visual Studio 2008 并将 prulish 设置设置为：

用本地副本替换匹配文件复制所有项目文件

我相信如果我们先删除目录中的所有内容，它会起作用，但我们不想这样做。有没有人见过这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T14:24:09.657

是的，我已经多次遇到这个和类似的问题，而且它几乎总是在您网站的实时副本和缓存副本之间不匹配。通常答案是删除本地缓存，或者如果远程开发，从 \server\C$\WINDOWS\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET 文件中删除网站并重新编译。

这也是对许多 IDE 相关故障的修复。这很痛苦，因为您必须进行完整的重新编译，但它解决了很多问题。

# c++ - C++ 函数指针问题

> ID：839990
> 
> 赞同：1
> 
> 时间：2009-05-08T14:16:22.653
> 
> 标签：c++, templates, function-pointers, variadic-functions, function-templates

由于某种原因，试图将指向该函数的指针传递给可变参数函数会产生以下错误：

```
1>c:\... : error C2664: 'PyArg_ParseTuple' : cannot convert parameter 3 from 'int (__cdecl *)(PyObject *,void *)' to '...'
1>        Context does not allow for disambiguation of overloaded function

PyArg_ParseTuple(args, "O&O&:CreateWindow",
    &Arg_Size2U<1>, &size,
    &Arg_String<2>, &title); 
```

我不确定问题是什么，因为模板函数没有过载，并且模板参数是明确定义的，所以对于哪个函数传递指针是毫无疑问的......

有没有办法解决这个问题，不会为每个参数转换函数创建很多版本，但如果出现错误，仍然可以在异常中包含参数编号？（更好的方法是将参数编号作为参数传递，因此我的 dll 中没有该函数的多个副本。）

编辑：这似乎也导致编译错误。有没有办法创建指向模板函数的函数指针，还是我需要与普通函数不同？

```
int (*sizeConv)(PyObject *,void *) = Arg_MakeSize2U<1>;
1>c:\... : error C2440: 'initializing' : cannot convert from 'int (__cdecl *)(PyObject *,void *)' to 'int (__cdecl *)(PyObject *,void *)'
1>        None of the functions with this name in scope match the target type 
```

该函数声明为：

```
template<int ARG> int Arg_MakeSize2U(PyObject *obj, void *out) 
```

EDIT2：添加运营商的地址又给出了另一个不同的错误......

```
int (*sizeConv)(PyObject *,void *) = &Arg_MakeSize2U<1>;

1>c:\... : error C2440: 'initializing' : cannot convert from 'overloaded-function' to 'int (__cdecl *)(PyObject *,void *)'
1>        None of the functions with this name in scope match the target type 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-08T18:34:18.480

这在 VC++ 2008 中编译得很好：

```
struct PyObject;

template<int ARG> int Arg_MakeSize2U(PyObject *obj, void *out)
{
    return 0;
}

int main()
{
    int (*sizeConv)(PyObject *,void *) = &Arg_MakeSize2U<1>;
    sizeConv(0, 0);
} 
```

所以你必须做一些不同的事情。也许你确实有超载而你没有注意到。发布更多上下文将有助于更好地诊断问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T16:34:29.640

从第二个错误听起来编译器找不到实现。您的模板函数定义是否在您声明模板的头文件中？

# python - 在 Python 中提取 URL

> ID：839994
> 
> 赞同：52
> 
> 时间：2009-05-08T14:17:04.370
> 
> 标签：python, url, parsing

关于：[使用 Python 在文本中查找超链接（twitter 相关）](https://stackoverflow.com/questions/720113/find-hyperlinks-in-text-using-python-twitter-related)

如何仅提取 url 以便将其放入列表/数组中？

* * *

## 编辑

让我澄清一下，我不想将 URL 解析成碎片。我想从字符串文本中提取 URL 以将其放入数组中。谢谢！

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2009-05-08T14:39:32.803

为了响应 OP 的编辑，我[使用 Python（twitter 相关）劫持了 Find Hyperlinks in Text](https://stackoverflow.com/questions/720113/find-hyperlinks-in-text-using-python-twitter-related)并想出了这个：

```
import re

myString = "This is my tweet check it out http://example.com/blah"

print(re.search("(?P<url>https?://[^\s]+)", myString).group("url")) 
```

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2009-05-08T14:20:51.177

被误解的问题：

```
>>> from urllib.parse import urlparse
>>> urlparse('http://www.ggogle.com/test?t')
ParseResult(scheme='http', netloc='www.ggogle.com', path='/test',
        params='', query='t', fragment='') 
```

[或 py2.* 版本](http://docs.python.org/library/urlparse.html?#urlparse.urlparse)：

```
>>> from urlparse import urlparse
>>> urlparse('http://www.cwi.nl:80/%7Eguido/Python.html')
ParseResult(scheme='http', netloc='www.cwi.nl:80', path='/%7Eguido/Python.html',
        params='', query='', fragment='') 
```

**ETA**：正则表达式确实是这里的最佳选择：

```
>>> s = 'This is my tweet check it out http://tinyurl.com/blah and http://blabla.com'
>>> re.findall(r'(https?://\S+)', s)
['http://tinyurl.com/blah', 'http://blabla.com'] 
```

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2018-06-11T03:20:52.390

您可以使用以下可怕的正则表达式：

```
\b((?:https?://)?(?:(?:www\.)?(?:[\da-z\.-]+)\.(?:[a-z]{2,6})|(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)|(?:(?:[0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|(?:[0-9a-fA-F]{1,4}:){1,7}:|(?:[0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|(?:[0-9a-fA-F]{1,4}:){1,5}(?::[0-9a-fA-F]{1,4}){1,2}|(?:[0-9a-fA-F]{1,4}:){1,4}(?::[0-9a-fA-F]{1,4}){1,3}|(?:[0-9a-fA-F]{1,4}:){1,3}(?::[0-9a-fA-F]{1,4}){1,4}|(?:[0-9a-fA-F]{1,4}:){1,2}(?::[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:(?:(?::[0-9a-fA-F]{1,4}){1,6})|:(?:(?::[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(?::[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(?:ffff(?::0{1,4}){0,1}:){0,1}(?:(?:25[0-5]|(?:2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(?:25[0-5]|(?:2[0-4]|1{0,1}[0-9]){0,1}[0-9])|(?:[0-9a-fA-F]{1,4}:){1,4}:(?:(?:25[0-5]|(?:2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(?:25[0-5]|(?:2[0-4]|1{0,1}[0-9]){0,1}[0-9])))(?::[0-9]{1,4}|[1-5][0-9]{4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-5])?(?:/[\w\.-]*)*/?)\b 
```

[**演示正则表达式101**](https://regex101.com/r/03VgN5/5/)

此正则表达式将接受以下格式的 url：

**输入：**

```
add1 http://mit.edu.com abc
add2 https://facebook.jp.com.2\. abc
add3 www.google.be. uvw
add4 https://www.google.be. 123
add5 www.website.gov.us test2
Hey bob on www.test.com. 
another test with ipv4 http://192.168.1.1/test.jpg. toto2
website with different port number www.test.com:8080/test.jpg not port 80
www.website.gov.us/login.html
test with ipv4 192.168.1.1/test.jpg.
search at google.co.jp/maps.
test with ipv6 2001:0db8:0000:85a3:0000:0000:ac1f:8001/test.jpg. 
```

**输出：**

```
http://mit.edu.com
https://facebook.jp.com
www.google.be
https://www.google.be
www.website.gov.us
www.test.com
http://192.168.1.1/test.jpg
www.test.com:8080/test.jpg
www.website.gov.us/login.html
192.168.1.1/test.jpg
google.co.jp/maps
2001:0db8:0000:85a3:0000:0000:ac1f:8001/test.jpg 
```

**说明：**

*   `\b`用于单词边界以分隔 URL 和文本的其余部分
*   `(?:https?://)?`匹配 http:// 或 https// 如果存在
*   `(?:(?:www\.)?(?:[\da-z\.-]+)\.(?:[a-z]{2,6})`匹配标准网址（可能以`www.`（让我们称之为`STANDARD_URL`）开头
*   `(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)`匹配标准 IPv4（让我们称之为`IPv4`）
*   匹配 IPv6 URL：（`(?:(?:[0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|(?:[0-9a-fA-F]{1,4}:){1,7}:|(?:[0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|(?:[0-9a-fA-F]{1,4}:){1,5}(?::[0-9a-fA-F]{1,4}){1,2}|(?:[0-9a-fA-F]{1,4}:){1,4}(?::[0-9a-fA-F]{1,4}){1,3}|(?:[0-9a-fA-F]{1,4}:){1,3}(?::[0-9a-fA-F]{1,4}){1,4}|(?:[0-9a-fA-F]{1,4}:){1,2}(?::[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:(?:(?::[0-9a-fA-F]{1,4}){1,6})|:(?:(?::[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(?::[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(?:ffff(?::0{1,4}){0,1}:){0,1}(?:(?:25[0-5]|(?:2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(?:25[0-5]|(?:2[0-4]|1{0,1}[0-9]){0,1}[0-9])|(?:[0-9a-fA-F]{1,4}:){1,4}:(?:(?:25[0-5]|(?:2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(?:25[0-5]|(?:2[0-4]|1{0,1}[0-9]){0,1}[0-9]))`让我们称之为`IPv6`）
*   匹配端口部分（让我们称之为`PORT`）（如果存在）：`(?::[0-9]{1,4}|[1-5][0-9]{4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-5])`
*   匹配`(?:/[\w\.-]*)*/?)`url 的目标对象部分（html 文件、jpg、...）（让我们调用它`RESSOURCE_PATH`）

* * *

这给出了**以下正则表达式**：

```
\b((?:https?://)?(?:STANDARD_URL|IPv4|IPv6)(?:PORT)?(?:RESSOURCE_PATH)\b 
```

* * *

**资料来源：**

> *IPv6*：[匹配有效 IPv6 地址的正则表达式](https://stackoverflow.com/questions/53497/regular-expression-that-matches-valid-ipv6-addresses/17871737#17871737)
> 
> *IPv4*：[https ://www.safaribooksonline.com/library/view/regular-expressions-cookbook/9780596802837/ch07s16.html](https://www.safaribooksonline.com/library/view/regular-expressions-cookbook/9780596802837/ch07s16.html)
> 
> *端口*：[https ://stackoverflow.com/a/12968117/8794221](https://stackoverflow.com/a/12968117/8794221)
> 
> 其他来源： [https ://code.tutsplus.com/tutorials/8-regular-expressions-you-should-know--net-6149](https://code.tutsplus.com/tutorials/8-regular-expressions-you-should-know--net-6149)

* * *

```
$ more url.py

import re

inputString = """add1 http://mit.edu.com abc
add2 https://facebook.jp.com.2\. abc
add3 www.google.be. uvw
add4 https://www.google.be. 123
add5 www.website.gov.us test2
Hey bob on www.test.com. 
another test with ipv4 http://192.168.1.1/test.jpg. toto2
website with different port number www.test.com:8080/test.jpg not port 80
www.website.gov.us/login.html
test with ipv4 (192.168.1.1/test.jpg).
search at google.co.jp/maps.
test with ipv6 2001:0db8:0000:85a3:0000:0000:ac1f:8001/test.jpg."""

regex=ur"\b((?:https?://)?(?:(?:www\.)?(?:[\da-z\.-]+)\.(?:[a-z]{2,6})|(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)|(?:(?:[0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|(?:[0-9a-fA-F]{1,4}:){1,7}:|(?:[0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|(?:[0-9a-fA-F]{1,4}:){1,5}(?::[0-9a-fA-F]{1,4}){1,2}|(?:[0-9a-fA-F]{1,4}:){1,4}(?::[0-9a-fA-F]{1,4}){1,3}|(?:[0-9a-fA-F]{1,4}:){1,3}(?::[0-9a-fA-F]{1,4}){1,4}|(?:[0-9a-fA-F]{1,4}:){1,2}(?::[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:(?:(?::[0-9a-fA-F]{1,4}){1,6})|:(?:(?::[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(?::[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(?:ffff(?::0{1,4}){0,1}:){0,1}(?:(?:25[0-5]|(?:2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(?:25[0-5]|(?:2[0-4]|1{0,1}[0-9]){0,1}[0-9])|(?:[0-9a-fA-F]{1,4}:){1,4}:(?:(?:25[0-5]|(?:2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(?:25[0-5]|(?:2[0-4]|1{0,1}[0-9]){0,1}[0-9])))(?::[0-9]{1,4}|[1-5][0-9]{4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-5])?(?:/[\w\.-]*)*/?)\b"

matches = re.findall(regex, inputString)
print(matches) 
```

**输出：**

```
$ python url.py 
['http://mit.edu.com', 'https://facebook.jp.com', 'www.google.be', 'https://www.google.be', 'www.website.gov.us', 'www.test.com', 'http://192.168.1.1/test.jpg', 'www.test.com:8080/test.jpg', 'www.website.gov.us/login.html', '192.168.1.1/test.jpg', 'google.co.jp/maps', '2001:0db8:0000:85a3:0000:0000:ac1f:8001/test.jpg'] 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2015-02-17T00:26:43.617

这是一个包含大量正则表达式的文件：

```
#!/usr/bin/python
# -*- coding: utf-8 -*-
"""
the web url matching regex used by markdown
http://daringfireball.net/2010/07/improved_regex_for_matching_urls
https://gist.github.com/gruber/8891611
"""
URL_REGEX = r"""(?i)\b((?:https?:(?:/{1,3}|[a-z0-9%])|[a-z0-9.\-]+[.](?:com|net|org|edu|gov|mil|aero|asia|biz|cat|coop|info|int|jobs|mobi|museum|name|post|pro|tel|travel|xxx|ac|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cs|cu|cv|cx|cy|cz|dd|de|dj|dk|dm|do|dz|ec|ee|eg|eh|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|Ja|sk|sl|sm|sn|so|sr|ss|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tp|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|yu|za|zm|zw)/)(?:[^\s()<>{}\[\]]+|\([^\s()]*?\([^\s()]+\)[^\s()]*?\)|\([^\s]+?\))+(?:\([^\s()]*?\([^\s()]+\)[^\s()]*?\)|\([^\s]+?\)|[^\s`!()\[\]{};:'".,<>?«»“”‘’])|(?:(?<!@)[a-z0-9]+(?:[.\-][a-z0-9]+)*[.](?:com|net|org|edu|gov|mil|aero|asia|biz|cat|coop|info|int|jobs|mobi|museum|name|post|pro|tel|travel|xxx|ac|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cs|cu|cv|cx|cy|cz|dd|de|dj|dk|dm|do|dz|ec|ee|eg|eh|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|Ja|sk|sl|sm|sn|so|sr|ss|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tp|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|yu|za|zm|zw)\b/?(?!@)))""" 
```

我调用该文件`urlmarker.py`，当我需要它时，我只需导入它，例如。

```
import urlmarker
import re
re.findall(urlmarker.URL_REGEX,'some text news.yahoo.com more text') 
```

参看。[http://daringfireball.net/2010/07/improved_regex_for_matching_urls](http://daringfireball.net/2010/07/improved_regex_for_matching_urls)和[使用 Python 从字符串中提取 URL 的最简洁方法是什么？](https://stackoverflow.com/questions/520031/whats-the-cleanest-way-to-extract-urls-from-a-string-using-python/28552670#28552670)

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2017-07-04T22:21:43.257

如果你想从任何文本中提取 URL，你可以使用我的 urlextract。它根据在文本中找到的 TLD 查找 URL。它从 TLD 位置扩展到两侧并获取整个 URL。它易于使用。检查它：[https ://github.com/lipoja/URLExtract](https://github.com/lipoja/URLExtract)

```
 from urlextract import URLExtract

    extractor = URLExtract()
    urls = extractor.find_urls("Text with URLs: stackoverflow.com.") 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2012-06-06T03:09:09.417

不要忘记检查搜索是否返回值——`None`我发现上面的帖子很有帮助，但浪费了处理`None`结果的时间。

请参阅[Python 正则表达式“对象没有属性”](https://stackoverflow.com/questions/1491277/python-regex-object-has-no-attribute)。

IE

```
import re
myString = "This is my tweet check it out http://tinyurl.com/blah"
match = re.search("(?P<url>https?://[^\s]+)", myString)
if match is not None: 
    print match.group("url") 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2010-06-03T11:55:20.113

关于这一点：

```
import re
myString = "This is my tweet check it out http:// tinyurl.com/blah"
print re.search("(?P<url>https?://[^\s]+)", myString).group("url") 
```

如果字符串中有多个 url，它将无法正常工作。如果字符串看起来像：

```
myString = "This is my tweet check it out http:// tinyurl.com/blah and http:// blabla.com" 
```

你可以这样做：

```
myString_list = [item for item in myString.split(" ")]
for item in myString_list:
    try:
        print re.search("(?P<url>https?://[^\s]+)", item).group("url")
    except:
        pass 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2021-01-22T08:35:01.287

只需按照下面的代码并享受......！！！！

```
import requests
from bs4 import BeautifulSoup
url = "your url"//Any url that you want to fetch.
r = requests.get(url)
htmlContent = r.content
soup = BeautifulSoup(htmlContent, 'html.parser')

anchors = soup.find_all('a')
all_links = set()
for link in anchors:
    if(link.get('href') != '#'): 
        linkText = url+str(link.get('href'))
        all_links.add(link)
        print(linkText) 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-01-03T10:10:12.723

[注意：假设您在 Twitter 数据上使用它（如问题所示），最简单的方法是使用他们的 API，它将从推文中提取的 url 作为字段返回]

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-05-05T12:22:53.067

如果从 HTML 源中提取：

```
from urlextract import URLExtract
from requests import get

url = "sample.com/samplepage/"
req = requests.get(url)
text = req.text
# or if you already have the html source:
# text2 = "This is html for ex <a href='http://google.com/'>Google</a> <a href='http://yahoo.com/'>Yahoo</a>"
text = text.replace(' ', '').replace('=','')
extractor = URLExtract()
print(extractor.find_urls(text)) 
```

输出（文本2）：

`['http://google.com/', 'http://yahoo.com/']`

# asp.net - 具有自定义角色提供程序的 ASP.NET 网站管理工具

> ID：839996
> 
> 赞同：1
> 
> 时间：2009-05-08T14:17:16.710
> 
> 标签：asp.net, asp.net-membership

我的系统为用户和角色使用自定义安全和数据模型。

但是我想知道我是否使用提供程序模型实现了这个，是否可以将它连接到 asp.net 网站管理工具。

我也怀疑 asp.net 网站管理工具是否有任何实际用途，或者它是否只是一个噱头。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T14:24:27.963

是的，ASP.NET 网站管理工具应该选择您在配置文件中定义的任何提供程序（自定义或其他）。

至于它在现实世界中的使用，您可以将文件从“C:\Windows\Microsoft.NET\Framework\v2.0.50727\ASP.NETWebAdminFiles”复制到您的实时站点，尽管我倾向于只在我的开发环境中使用它快速添加用户和角色进行测试，然后使用我自己的 Web 表单连接到实时站点上的提供程序（尽管更多的是出于样式和格式的原因）。

# ruby - 填充 Ruby 哈希的更好方法？

> ID：839997
> 
> 赞同：9
> 
> 时间：2009-05-08T14:17:22.637
> 
> 标签：ruby, hash

有一个更好的方法吗？（看起来很笨重）

```
form_params = {}
form_params['tid'] = tid
form_params['qid'] = qid
form_params['pri'] = pri
form_params['sec'] = sec
form_params['to_u'] = to_u
form_params['to_d'] = to_d
form_params['from'] = from
form_params['wl'] = wl 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-08T14:19:23.910

```
form_params = { "tid" => tid, "qid" => qid } 
```

或者你可以做

```
form_params = Hash["tid", tid, "qid", qid]       #=> {"tid"=>tid, "qid"=>qid}
form_params = Hash["tid" => tid, "qid" => qid]   #=> {"tid"=>tid, "qid"=>qid}
form_params = Hash[tid => tid, qid => qid]       #=> {"tid"=>tid, "qid"=>qid} 
```

（注意，最后一个是 1.9 的新功能，它使您的键[符号](http://www.ruby-doc.org/core/classes/Symbol.html)而不是[字符串](http://www.ruby-doc.org/core/classes/String.html)）

{tid:tid, qid:qid}

键和值成对出现，因此必须有偶数个参数。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-08T21:49:03.283

对上述内容稍作修改，因为您的示例具有字符串键：

```
form_params = {}
%w(tid qid pri sec to_u to_d from wl).each{|v| form_params[v] = send(v)} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-08T14:35:33.013

如果性能不重要，这个可能看起来更好：

```
form_params = {}
['tid', 'qid', 'pri', 'sec', 'to_u', 'to_d', 'from', 'wl'].each do |v|
  form_params[v] = eval(v)
end 
```

如果这些名称实际上是您可以替换`eval`为更快的方法`send`：

```
form_params[v] = send(v.to_sym) 
```

*（更新）*另一种（更优雅）的方式使用`inject`：

```
form_params = ['tid', 'qid', 'pri', 'sec', 'to_u', 'to_d', 'from', 'wl'].inject({}) { |h, v| h[v] = send(v); h } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-07-08T15:58:27.537

还有另一种形式，对于 ruby​​ 1.9：

```
form_params = {tid: "tid", qid: "qid", ...} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-02-24T11:44:00.970

```
Hash[%w(tid qid pri sec to_u to_d from wl).collect{|x| [x,send(x)]}] 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-08T16:42:00.777

我创建了一个名为[MoreOpenStruct](http://snippets.dzone.com/posts/show/7312)的自定义类来处理 Hash 缺乏美感的问题，并且使用该类，您的示例将如下所示：

```
form_params = MoreOpenStruct.new
form_params.tid = tid
form_params.qid = qid
form_params.pri = pri
form_params.sec = sec
form_params.to_u = to_u
form_params.to_d = to_d
form_params.from = from
form_params.wl = wl

form_params_hash = form_params._to_hash
  #=> { :tid => tid, :qid => qid, etc } 
```

如果您需要字符串文字而不是符号作为散列的关键，则需要进行更多调整。

当我想要易于阅读/操作哈希时，我使用我的自定义结构类，但如果您所做的只是一个分配并且不需要解析除此之外的哈希，我会使用 Roger 的解决方案。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-09T18:57:23.827

其他选项是创建一个基于 Struct 的类来存储这些值。例如：

```
FormParams = Struct.new(:tid, :qid, :pri, :sec, :to_u, :to_d, :from, :wl) 
```

然后您就可以通过多种方式初始化 form_params 实例：

```
form_params = FormParams.new(:tid => tid, :qid => qid, # etc ...
form_params = FormParams.new(tid, qid, pri, sec, to_u, to_d, from, wl)
form_params = FormParams.new
form_params.tid = tid
form_params.gid = gid
# etc ... 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-02-24T11:57:29.320

```
a = %w(tid quid pri sec to_u to_d from wl)
form_params = Hash[a.zip(a.collect {|v| send(v) })] 
```*****