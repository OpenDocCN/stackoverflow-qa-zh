# StackOverflow 问答 000890000-000890999

# ftp - 用于 Verio 入门包的 FTP

> ID：890003
> 
> 赞同：1
> 
> 时间：2009-05-20T20:14:55.640
> 
> 标签：ftp

有人知道如何连接到他们的 FTP 服务器吗？我正在使用域名 + 入门包（域名注册时免费提供的包）。我尝试使用 Microsoft Expression Web 和 IE8，都无法连接到端口 21。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-20T22:06:27.630

在文档的某个地方找到了这个： [http ://www.verio.com/support/documents/view_article.cfm?doc_id=4055](http://www.verio.com/support/documents/view_article.cfm?doc_id=4055)

共享 IP 产品没有 FTP。那他们为什么要提供免费的网络空间呢？:(

# javascript - 从 AJAX 调用返回和显示数据的最佳实践

> ID：890004
> 
> 赞同：7
> 
> 时间：2009-05-20T20:15:06.060
> 
> 标签：javascript, jquery, ajax, json

我在页面上设置了一些 jquery/php 交互。它向服务器提交一些数据并取回数据记录，然后在页面上对齐以进行比较和可能的操作。

我的问题是返回信息然后显示它的最佳做法是什么？

*   返回 JSON 对象，然后使用 js 动态创建 html 并显示数据？
*   返回 JSON 对象，然后将该数据放入已为页面上的数据创建的容器中？
*   从服务器返回纯 html 并将其放在页面上？

昨晚我在脑海中滚动这些内容，并且无法真正弄清楚出于任何特定原因是否有一种方法会更好。

我不是 js 专家，所以不太确定这些不同方法的优缺点和注意事项。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-20T20:27:13.103

我认为它最终取决于您的应用程序。

纯 HTML 是最简单的，您只需将中提琴放在适当的位置即可。JQuery 使添加适当的事件变得轻而易举。

然而，每当我使用 AJAX 时，它总是演变成返回 JSON 并即时构建元素。例如，如果您正在填充一棵树，那么获得正确的嵌套可能会变得混乱。这迫使您无论如何都必须编写客户端代码，此时简单地从一开始就使用 JSON 会更干净。

此外，如果您打算使用来自其他页面的数据调用，那么使用 JSON 是可行的方法，因为 HTML 将被修复。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-20T20:32:44.137

这完全取决于您在应用程序中进行设置的方式。我，一方面，更喜欢返回 JSON（列表中的第二种方法），因为我有一个“错误代码”参数，我在更新页面上的内容之前检查 onSuccess 函数，如果它不为零，那么我通知用户错误，包括从服务器返回的错误消息（服务器端验证、数据库超时等）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-20T21:02:08.460

您问题的“可能采取的行动”部分会产生很大的不同。如果您需要对数据进行除显示之外的其他操作，那么以 JSON 格式返回显然是更好的选择，因为您可以将数据作为原生 JavaScript 对象进行处理，而不必遍历 HTML DOM。如果您打算做的只是显示它，我认为没有任何理由费心用 JavaScript 构建该显示。只需在服务器上的表示层中构建 HTML。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-20T21:29:37.563

我认为您缺少一个完全有效的选项，这是我经常使用的选项。这是我的典型模式，它还没有让我失望...... :-)

这是我使用的基本 jQuery 模板：

```
$(function() {
    $.getJSON('/some/page',{foo:bar,bar:foo},function(json) {
        if(json.outcome == 'success') {
            $('body').prepend(json.html);
        } else {
            // Somehow let the user know why it didn't work
            alert(json.error);
        }
    });
}); 
```

这是我使用的基本后端（在我的例子中是 PHP）结构：

```
<?php // Page: '/some/page'

/* Blah Blah Blah... do whatever needs to be done... */

// If everything turns out okay (assuming '$output' is the HTML 
// you want to display...
echo json_encode(array('outcome'=>'success','html'=>$output));

// If something goes wrong... just do:
echo json_encode(array('outcome'=>'error','error'=>'Uh oh... something is broken')); 
```

自然，您会希望通过将错误放入某个变量或其他内容中来更具体地处理您的错误。但是，你应该明白这一点。此外，当然您可以向 json 输出添加更多信息。您可以拥有一些预制的 HTML 以及一些其他信息，例如“成功通知”或某些元素的新类名，我不知道......无论如何......可能性是无穷无尽的。

无论如何，我选择这条路线的原因是因为它通常更快（根据我的经验）将预先制作的 HTML 附加到 DOM，而不是循环遍历 JSON 并插入内容，除非它只是，比如，一些要替换的文本一个元素。但是，我展示的方法是，IMO，两全其美。您可以将 HTML 作为字符串附加到 JSON 属性之一。

快乐的 jQuerying :-)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-20T20:27:28.327

这最近出现了，可能是一个骗局：[AJAX 响应：数据（JSON、XML）还是 HTML 片段？](https://stackoverflow.com/questions/867163/the-ajax-response-data-json-xml-or-html-snippet).

如果您要创建 HTML，那么您不妨直接返回 HTML 并将其注入 DOM。但是，有时您需要使用 JSON 派上用场的对象。

例如，如果您返回一个 Person 对象，那么您可以打招呼 Person.Name 并显示 Person.Preferences，这非常方便。这取决于您的设计，但一般注意事项应该是将 HTML 排除在 Javascript 之外，除非您正在构建 RIA。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-20T20:44:47.530

我已经使用了所有这三个并且得出的结论是在向页面引入新元素时返回 HTML 更好。

我的经验是，在使用 javascript 构建 HTML 时，我通常会复制已经为非 javascript 用户旅程完成的工作。

我仍然更喜欢解析 json 来更新现有元素或创建仅限 javascript 的功能。我告诉自己这是为了带宽，但我认为这只是因为我喜欢 javascript。

作为第四个选项，我阅读了一篇关于 Flickr 如何使用字符串连接处理大量数据的精彩文章。基本上只需在管道中解析一个大 o' 字符串并在客户端将其切碎。这显着减少了服务器上的负载，而客户端仅略微增加。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-05-20T20:19:40.340

返回纯 HTML 是最好的解决方案。在大多数情况下，gzip 应该抵消带宽的任何差异，如果客户端是一台糟糕的机器，通过客户端上的 javascript 渲染可能会很慢。最后，如果你使用 MVC，编写 javascript 来呈现 HTML 与使用视图之类的好东西相比很难使用。

# .net - 文本框拉伸问题

> ID：890010
> 
> 赞同：3
> 
> 时间：2009-05-20T20:16:15.527
> 
> 标签：.net, css, textbox, width

我有以下代码

```
<table cellpadding="2" cellspacing="2">
  <tr>
    <td>Factory:</td>
    <td>
      <asp:TextBox ID="txtFactory" runat="server" Width="100%"></asp:TextBox>
    </td>
  </tr>
</table> 
```

我的问题是，有时工厂文本框可以包含相当长的 100 个或更多字符的描述，当这种情况发生时，我的文本框会扩大到超出屏幕边缘，然后导致水平滚动条出现在我的浏览器底部，并且我真的不想那样。我想要的是让我的 TextBox 扩展到浏览器窗口所在的宽度，并且还能够在用户调整浏览器窗口大小时调整大小。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-20T20:49:36.130

贾格德，

检查 Wrap 和 MaxLength 属性。

W3Schools 有一些关于 WebControls 的重要信息。

(http)://www.w3schools.(com)/aspnet/control_textbox.(asp)
---我还不能发布链接，对不起---

祝你好运，

-罗伯特

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-20T21:04:54.087

如果你不反对使用 javascript，jQuery 对这个问题有一个非常简单的解决方案。您可以使用它来初始设置文本框的大小，并将调整大小事件处理程序附加到正文标记。在事件处理程序中，只需让文本框的宽度与正文的宽度相匹配。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-20T21:23:02.350

**使用Firebug**使用 FF 检查您的 HTML，看看是什么扩大了您的主容器。

如果您的文本太长并且没有空格，浏览器不知道在哪里放置换行符，则可以使用**`WRAP`**TD 或 TextBox 中的属性修改此行为（在浏览器中呈现为 SPAN 一次）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-21T00:30:21.707

表单元素的标签在哪里？为什么要使用表格进行布局？为什么要在 HTML 中而不是在 CSS 文件中指定 textarea 的宽度？

**请**正确地做事！

# .net - .NET Compact Framework 中的集群大小

> ID：890024
> 
> 赞同：4
> 
> 时间：2009-05-20T20:19:53.257
> 
> 标签：.net, windows-mobile, compact-framework, storage

我正在尝试在 Widows Mobile 上使用 C#/.NET Compact Framework 以编程方式确定存储卡的集群大小。对于桌面 Windows，有 GetDiskFreeSpace() 函数，但在 coredll.dll/Windows Mobile 中不存在。

有没有其他方法可以找出存储卡集群的大小？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-20T22:15:49.497

我自己没有尝试过，但是您可以尝试[CeGetVolumeInfo](http://msdn.microsoft.com/en-us/library/aa912305.aspx)并检查 dwBlockSize 值。这看起来可能是集群大小。

如果这不起作用，那么它会涉及更多。

存储卡通常以[FAT 格式格式化](http://en.wikipedia.org/wiki/File_Allocation_Table)。

您需要访问 CE 中的低级例程以在磁盘级别读取并读取 FAT BPB，它确定 FAT 的类型和簇大小。

使用[存储管理器](http://msdn.microsoft.com/en-us/library/aa914929.aspx)功能[FindFirstStore](http://msdn.microsoft.com/en-us/library/aa916713.aspx) / FindNextStore 来查找您想要的存储卡。然后使用 CreateFile API 打开存储卡。

HANDLE hDisk(CreateFile(storeInfo.szDeviceName, GENERIC_READ|GENERIC_WRITE, FILE_SHARE_WRITE|FILE_SHARE_READ, NULL, OPEN_EXISTING, 0, NULL));

然后您需要读取超级磁盘第一个扇区上的 FAT BPB（对于存储卡格式的设备来说这是正常情况），或者它是 MBR 格式。

```
 SG_REQ req;
  DWORD cb;

  req.sr_start = 0;
  req.sr_num_sec = 1;
  req.sr_num_sg = 1;
  req.sr_status = 0;
  req.sr_callback = 0;
  req.sr_sglist[0].sb_buf = sectorBuffer;
  req.sr_sglist[0].sb_len = storeInfo.dwBytesPerSector;

  DeviceIoControl(hDisk, DISK_IOCTL_READ, &req, sizeof(req), 0, 0, &cb, 0); 
```

获得 BPB 后，您需要确定它是什么胖格式（FAT12/FAT16/FAT32），然后从中提取簇大小。

如何在 C# 中执行上述操作取决于您。我在存储管理器参考中看到它可以下降到分区级别，您可以查询分区类型。这将告诉您 FAT 类型，因此您无需弄清楚。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-20T21:43:21.780

该[论坛帖子](http://social.msdn.microsoft.com/Forums/en-US/windowsmobiledev/thread/67026545-ca2d-4c72-8efe-8ae6d3a758c5)给出了其他人遇到此问题的一些想法。

# oracle - Oracle查询从最近10分钟插入的表中获取数据

> ID：890035
> 
> 赞同：36
> 
> 时间：2009-05-20T20:22:55.967
> 
> 标签：oracle, datetime

我必须从 Oracle 表中获取数据，在该表中我调用了一个日期字段`lastupdatedDate`，并且我只想返回`lastupdatedDate`过去 10 分钟内的行`sysdate`

例如，如果在我的表中，如果我在和之间运行查询`lastupdateDate`， `05/20/09 4:20:44` 我希望这一行回到我的结果中，而不是如果我在 运行查询。`05/20/09 4:20:44``05/20/09 4:30:44``05/20/09 5:31:44`

* * *

## 回答 #1

> 赞同：88
> 
> 时间：2009-05-21T15:57:50.020

或者更具可读性：

```
select *
  from mytable
 where lastupdatedDate > sysdate - interval '10' minute 
```

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2009-05-20T20:28:33.177

```
select *
from mytable
where lastupdatedDate > sysdate - (10/1440) 
```

Rob van Wijk 在这里给出了一个更易读的版本[https://stackoverflow.com/a/893668/39430](https://stackoverflow.com/a/893668/39430)

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-05-20T20:26:25.960

```
select sysdate - 10/(24*60) from dual; 
```

请参阅上面的示例以获取 sysdate 减去十分钟，现在只需添加到您的查询中

# parsing - 如何修复后增量运算符的 YACC 移位/减少冲突？

> ID：890038
> 
> 赞同：7
> 
> 时间：2009-05-20T20:24:08.037
> 
> 标签：parsing, yacc, bison, shift-reduce-conflict, lalr

我正在用 YACC（实际上是 Bison）编写语法，并且遇到了移位/减少问题。它是由于包含后缀递增和递减运算符而产生的。这是语法的精简版：

```
%token NUMBER ID INC DEC

%left      '+' '-'
%left      '*' '/'
%right     PREINC
%left      POSTINC

%%

expr: NUMBER
|     ID
|     expr '+' expr
|     expr '-' expr
|     expr '*' expr
|     expr '/' expr
|     INC expr %prec PREINC
|     DEC expr %prec PREINC
|     expr INC %prec POSTINC
|     expr DEC %prec POSTINC
|     '(' expr ')'
;

%% 
```

Bison 告诉我有 12 个移位/减少冲突，但如果我注释掉后缀递增和递减的行，它就可以正常工作。有谁知道如何解决这个冲突？在这一点上，我正在考虑迁移到 LL(k) 解析器生成器，这使它更容易，但 LALR 语法似乎总是更自然地编写。我也在考虑 GLR，但我不知道有什么好的 C/C++ GLR 解析器生成器。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-06T11:33:04.750

`%glr-parser`如果您在选项部分指定，Bison/Yacc 可以生成 GLR 解析器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-01-21T12:16:33.347

试试这个：

```
%token NUMBER ID INC DEC

%left       '+' '-'
%left       '*' '/'
%nonassoc   '++' '--'
%left       '('
%%

expr: NUMBER
|     ID
|     expr '+' expr
|     expr '-' expr
|     expr '*' expr
|     expr '/' expr
|     '++' expr 
|     '--' expr 
|     expr '++'
|     expr '--'
|     '(' expr ')'
;

%% 
```

关键是将后缀运算符声明为**non associative**。否则你将能够

```
++var++-- 
```

还需要优先考虑括号以最小化移位/减少警告

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T15:45:22.057

我喜欢定义更多的项目。你不应该需要 %left, %right, %prec 的东西。

```
simple_expr: NUMBER
 | INC simple_expr
 | DEC simple_expr
 | '(' expr ')'
;

term: simple_expr
 | term '*' simple_expr
 | term '/' simple_expr
;

expr: term
 | expr '+' term
 | expr '-' term
; 
```

玩弄这种方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-08T18:23:16.460

这个基本问题是您没有`INC`and`DEC`标记的优先级，因此它不知道如何解决涉及先行`INC`or的歧义`DEC`。如果你添加

```
%right INC DEC 
```

在优先级列表的末尾（您希望一元的优先级更高，后缀高于前缀），它将修复它，您甚至可以摆脱所有`PREINC`/的`POSTINC`东西，因为它无关紧要。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-09-08T13:29:31.403

preincrement 和 postincrement 运算符具有 nonassoc，因此在优先级部分和规则中定义，通过使用使这些运算符的优先级高`%prec`

# java - 为什么使用 Hibernate 进行查询缓存会使查询慢十倍？

> ID：890041
> 
> 赞同：8
> 
> 时间：2009-05-20T20:24:35.557
> 
> 标签：java, hibernate, caching, ejb-3.0

我目前正在尝试使用 EJB3 作为工作中的一个主要项目的预研究。我正在研究的一件事是查询缓存。

我已经制作了一个非常简单的域模型，其中包含 JPA 注释、@Local 业务接口和 EJB-JAR 中的 @Stateless 实现，部署在 EAR 中以及非常简单的 webapp 以进行一些基本测试。EAR 部署在 JBoss 5.0.1 默认配置中，没有进行任何修改。这非常简单，并且按预期工作。

但是，我最近的测试涉及查询缓存，我得到了一些奇怪的结果：

*   我有一个域类，它只映射一个 ID 和一个字符串值，并在该特定表中创建了大约 10000 行
*   在业务 bean 中，有一个非常简单的查询，SELECT m FROM MyClass m
*   在没有缓存的情况下，平均执行时间约为 400 毫秒
*   启用查询缓存（通过查询提示），第一次执行当然需要更长的时间，大约 1200 毫秒。下一次执行平均需要 3500 毫秒！

这让我很困惑，所以我启用了 Hibernate 的 show_sql 来查看日志。未缓存，并且在启用缓存的第一次执行时，如预期的那样记录了一个 SELECT。当我应该获得缓存命中时，Hibernate 为数据库表中的每一行记录一个 SELECT。

这当然可以解释执行时间缓慢，但谁能告诉我为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-20T20:28:17.360

查询缓存的工作方式是它只缓存查询返回的对象的*ID*。因此，您最初的 SELECT 语句可能会返回所有对象，而 Hibernate 会将它们返回给您并记住 ID。

然而，下一次发出查询时，Hibernate 会检查 ID 列表并意识到它需要具体化实际数据。因此，它会*返回*数据库以获取其余部分。它每行执行一次 SELECT，这正是您所看到的。

现在，在您认为“此功能显然已损坏”之前，它以这种方式工作的原因是查询缓存旨在与二级缓存协同工作。如果对象在第一次查询之后存储在 L2 缓存中，那么 Hibernate 将改为查找那里以满足每个 ID 的请求。

我强烈建议您阅读*[Java Persistence with Hibernate](http://www.manning.com/bauer2/)*一书以了解更多信息。第 13 章特别介绍了优化查询，以及如何有效地使用缓存。

# vbscript - vbscript 替换文本 - 一个工作两个打破整个事情

> ID：890042
> 
> 赞同：2
> 
> 时间：2009-05-20T20:24:39.723
> 
> 标签：vbscript

我希望这个脚本替换同一个文本文件中的两个值而不是一个。但是，如果我取消注释第 12 行，它会破坏脚本。我必须把它变成一个循环，还是可以做多次替换？

```
Sub ReplaceTxt()
'Writes values we got earlier to our unattend file       '
Const ForReading = 1
Const ForWriting = 2

   Set objFSO = CreateObject("Scripting.FileSystemObject")
   Set objFile = objFSO.OpenTextFile(strSIFpath, ForReading)

   strText = objFile.ReadAll
   objFile.Close
   strNewText = Replace(strText, "***COMPNAME***", strCompname)
 '  strNewText = Replace(strText, "***Winkey***", strPoductkey)    '

   Set objFile = objFSO.OpenTextFile("C:\$WIN_NT$.~BT\winnt.sif", ForWriting)
   objFile.WriteLine strNewText
   objFile.Close
End Sub 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-20T20:29:48.930

我想你会想要对第一个返回的字符串进行第二次替换：

```
strNewText = Replace(strText, "***COMPNAME***", strCompname)
strNewText = Replace(strNewText , "***Winkey***", strPoductkey) 
```

否则，您将丢失第一个替换，结果中只会出现第二个替换。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T17:37:17.587

嗯.. 那很容易.. Bueno ni tanto.. 我有一段时间试图这样做。我找到了答案：

```
Sub ReplaceTxt()
 'Writes values we got earlier to our unattend file       '
 Const ForReading = 1
 Const ForWriting = 2

 Set objFSO = CreateObject("Scripting.FileSystemObject")
 Set objFile = objFSO.OpenTextFile(strSIFpath, ForReading)

 strText = objFile.ReadAll
 objFile.Close
 strNewText = Replace(strText, "***COMPNAME***", strCompname)
 strNewText2 = Replace(strNewText, "***Winkey***", strPoductkey)    '

 Set objFile = objFSO.OpenTextFile("C:\$WIN_NT$.~BT\winnt.sif", ForWriting)
 objFile.WriteLine strNewText2
 objFile.Close
End Sub 
```

坦克，格拉西亚斯。来自墨西哥锡那罗亚州库利亚坎的何塞别墅

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-20T20:30:00.337

尝试这个：

```
Sub ReplaceTxt() 'Writes values we got earlier to our unattend file' 
  Const ForReading = 1
  Const ForWriting = 2

  Set objFSO = CreateObject("Scripting.FileSystemObject")
  Set objFile = objFSO.OpenTextFile(strSIFpath, ForReading)

  strText = objFile.ReadAll
  objFile.Close

  strText = Replace(strText, "COMPNAME", strCompname)
  strText = Replace(strText, "Winkey", strPoductkey)

  Set objFile = objFSO.OpenTextFile("C:\$WIN_NT$.~BT\winnt.sif", ForWriting)
  objFile.WriteLine strText
  objFile.Close
End Sub 
```

通过按照您的方式进行操作，您使用了两次未使用的原始文本，在您进行第二次替换时覆盖了第一次替换。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-20T20:55:25.167

我确信我的 if 语句对于真正的编码人员来说是丑陋的，但这就是我如何让它工作的

```
Sub ReplaceTxt() 'Writes values we got earlier to our unattend file' 
  Const ForReading = 1
  Const ForWriting = 2
  counter = 1

  For Each searchterm In Array("COMPNAME", "Winkey")
      Set objFSO = CreateObject("Scripting.FileSystemObject")
      Set objFile = objFSO.OpenTextFile(strSIFpath, ForReading)

      strText = objFile.ReadAll
      objFile.Close

      If counter < 2 Then
         strText = Replace(strText, searchterm, strCompname)
      Else
         strText = Replace(strText, searchterm, strProductKey)
      End If

      Set objFile = objFSO.OpenTextFile("C:\$WIN_NT$.~BT\winnt.sif", ForWriting)
      objFile.WriteLine strText
      objFile.Close
      counter = counter + 1
  Next
End Sub 
```

# python - 如何使用 PIL 生成圆形缩略图？

> ID：890051
> 
> 赞同：48
> 
> 时间：2009-05-20T20:26:27.643
> 
> 标签：python, thumbnails, python-imaging-library, geometry

如何使用 PIL 生成圆形图像缩略图？圆圈外的空间应该是透明的。

片段将不胜感激，在此先感谢您。

* * *

## 回答 #1

> 赞同：88
> 
> 时间：2009-05-20T20:37:16.203

最简单的方法是使用掩码。创建具有您想要的任何形状的黑白蒙版。并使用`putalpha`将该形状作为 alpha 层：

```
from PIL import Image, ImageOps

mask = Image.open('mask.png').convert('L')
im = Image.open('image.png')

output = ImageOps.fit(im, mask.size, centering=(0.5, 0.5))
output.putalpha(mask)

output.save('output.png') 
```

这是我使用的面具：

![替代文字](https://i.imgur.com/2RltR0S.png)

* * *

如果您希望缩略图大小可变，您可以使用`ImageDraw`并绘制蒙版：

```
from PIL import Image, ImageOps, ImageDraw

size = (128, 128)
mask = Image.new('L', size, 0)
draw = ImageDraw.Draw(mask) 
draw.ellipse((0, 0) + size, fill=255)

im = Image.open('image.jpg')

output = ImageOps.fit(im, mask.size, centering=(0.5, 0.5))
output.putalpha(mask)

output.save('output.png') 
```

* * *

如果您想要 GIF 格式的输出，那么您需要使用粘贴功能而不是`putalpha`：

```
from PIL import Image, ImageOps, ImageDraw

size = (128, 128)
mask = Image.new('L', size, 255)
draw = ImageDraw.Draw(mask)
draw.ellipse((0, 0) + size, fill=0)

im = Image.open('image.jpg')

output = ImageOps.fit(im, mask.size, centering=(0.5, 0.5))
output.paste(0, mask=mask)
output.convert('P', palette=Image.ADAPTIVE)

output.save('output.gif', transparency=0) 
```

请注意，我做了以下更改：

*   面具现在被反转了。白色被黑色取代，反之亦然。
*   我正在使用“自适应”调色板转换为“P”。否则，PIL 将只使用网络安全颜色，结果看起来很糟糕。
*   我正在向图像添加透明度信息。

**请注意**：这种方法存在一个大问题。如果 GIF 图像包含黑色部分，它们也将全部变为透明。您可以通过为透明度选择另一种颜色来解决此问题。我强烈建议您为此使用 PNG 格式。但如果你不能，那是你能做的最好的。

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2014-03-11T20:31:44.897

我想在已经接受的答案中添加一个解决方案来解决产生的圆的抗锯齿，诀窍是产生一个更大的蒙版，然后使用 ANTIALIAS 过滤器将其缩小：这是代码

```
from PIL import Image, ImageOps, ImageDraw

im = Image.open('image.jpg')
bigsize = (im.size[0] * 3, im.size[1] * 3)
mask = Image.new('L', bigsize, 0)
draw = ImageDraw.Draw(mask) 
draw.ellipse((0, 0) + bigsize, fill=255)
mask = mask.resize(im.size, Image.ANTIALIAS)
im.putalpha(mask) 
```

在我看来，这会产生更好的结果。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2020-01-18T19:30:48.177

对@DRC 的解决方案稍作修改，以支持**已经具有透明度的图像**。他将 alpha 通道设置为圆圈外的 0（不可见）和内部的 255（不透明），所以我使用`darker`它取蒙版的**最小值**和原始 alpha 通道（可以在 0-255 之间的任何位置）:-)

```
from PIL import Image, ImageChops, ImageDraw

def crop_to_circle(im):
    bigsize = (im.size[0] * 3, im.size[1] * 3)
    mask = Image.new('L', bigsize, 0)
    ImageDraw.Draw(mask).ellipse((0, 0) + bigsize, fill=255)
    mask = mask.resize(im.size, Image.ANTIALIAS)
    mask = ImageChops.darker(mask, im.split()[-1])
    im.putalpha(mask)

im = Image.open('0.png').convert('RGBA')
crop_to_circle(im)
im.save('cropped.png') 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-03-29T18:00:51.593

非常感谢你。我一直在寻找几个小时，你的想法成功了。

连同那里的其他脚本。 [PIL 圆形边缘并添加边框](https://stackoverflow.com/questions/38539277/pil-round-edges-and-add-border) 它对我来说非常适合。

```
from PIL import Image
from PIL import ImageDraw, ImageChops

def add_corners( im, rad=100):
    circle = Image.new('L', (rad * 2, rad * 2), 0)
    draw = ImageDraw.Draw(circle)
    draw.ellipse((0, 0, rad * 2, rad * 2), fill=255)
    alpha = Image.new('L', im.size, "white")
    w, h = im.size
    alpha.paste(circle.crop((0, 0, rad, rad)), (0, 0))
    alpha.paste(circle.crop((0, rad, rad, rad * 2)), (0, h - rad))
    alpha.paste(circle.crop((rad, 0, rad * 2, rad)), (w - rad, 0))
    alpha.paste(circle.crop((rad, rad, rad * 2, rad * 2)), (w - rad, h - rad))

    alpha = ImageChops.darker(alpha, im.split()[-1])

    im.putalpha(alpha)
    return im

im = Image.open ('AceOfSpades.png').convert('RGBA')

im = add_corners (im, 24)

im.show()
im.save("perfect.png") 
```

[将此图像命名为 AceOfSpades.png 以进行测试](https://i.stack.imgur.com/6yX3C.png)

# apache-flex - 适用于 Flex 的 Yahoo Messenger API

> ID：890054
> 
> 赞同：0
> 
> 时间：2009-05-20T20:26:54.070
> 
> 标签：apache-flex, api, actionscript, yahoo-messenger

是否有在 Flex 中实现 Yahoo 聊天的 API？或者至少有一些电话？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-20T20:53:56.323

雅虎通 API 不是公开的，所以你肯定不会从他们那里得到官方的 API。

话虽如此，我不知道是否有可用于 FLEX 的 API。但我知道一个[用于 C](http://pidgin.im/download/source/)和一个[用于 Java](http://jymsg9.sourceforge.net/)。两者都是开源的。所以你可以尝试在 FLEX 中实现 Yahoo Messenger 的协议。

您可以尝试的其他事情（尽管我不知道它是否符合您的质量标准）是嵌入支持雅虎聊天的[网页。](http://webmessenger.yahoo.com/)

祝你好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-20T21:12:43.150

只是一个想法......但如果有一个开源的 java 解决方案，你不能用它来将它与 Flex 集成。你甚至可以使用 blazeds 将消息从 java 发送到 flex。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-02-08T22:27:07.643

现在有一个适用于 Yahoo! 的 SDK！信使。这些示例似乎是 Java 和 PHP，但 API 本身与语言无关。

[http://developer.yahoo.com/messenger/guide/index.html](http://developer.yahoo.com/messenger/guide/index.html)

# apache-flex - SWFLoader 的透明背景

> ID：890063
> 
> 赞同：0
> 
> 时间：2009-05-20T20:28:24.520
> 
> 标签：apache-flex, flash, transparency, swfloader

我在 SWF 中创建了一个“加载”微调器。我使用 SWFLoader 在我的主应用程序 SWF 中显示此微调器。如何使 SWFLoader 透明？目前它使用 Flex 的默认背景颜色，即使我已经设置了`backgroundAlpha="0"`.

我的微调器 SWF 的主要 MXML：（注意使用`backgroundAlpha`）

```
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" layout="absolute" xmlns:Controls="Controls.*" width="30" height="30" backgroundAlpha="0">
    <Controls:Spinner id="ctrlSpinner" />  <!-- spinner logic encapsulated in a component -->
</mx:Application> 
```

我的应用程序 SWF 的主要 MXML：

```
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" layout="absolute" height="801">
    <mx:SWFLoader x="10" y="173" id="swfSpinner" autoLoad="true" scaleContent="true" >
        <mx:source>SWFs/LoadingSpinnerApp.swf</mx:source>
    </mx:SWFLoader>
</mx:Application> 
```

请注意，Spinner 控件本身是透明的。SWFLoader 的某些原因导致它忽略了我的 backgroundAlpha 设置。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-20T21:06:56.923

我认为您的问题出在 Spinner 组件中，您必须在其中设置背景颜色或 alpha，这导致您的加载程序具有背景颜色。如果你没有设置它然后设置它，因为它可能默认为 1 的 alpha。当我执行以下操作时，我没有得到任何背景，但是当我将 alpha 更改为 1 时，会出现黑色背景。

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" 
layout="absolute" backgroundAlpha="1" 
backgroundColor="#000000">
    <mx:Text id="textBox" text="Hey World"/>
</mx:Application> 
```

和

```
<?xml version="1.0" encoding="utf-8"?>
    <mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" 
layout="absolute" backgroundColor="#ffffff">

    <mx:Canvas backgroundColor="#ff0000" width="200" 
height="200" verticalCenter="0" horizontalCenter="0">
        <mx:SWFLoader x="10" y="173" id="swfSpinner" 
autoLoad="true" scaleContent="true" source="DebuggerTest.swf"/>
    </mx:Canvas>

    </mx:Application> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T14:09:44.090

事实证明我做的是正确的——Flex 只是没有将我的微调器 SWF 的最新版本复制到我的主应用程序的 bin 中。相反，它一直保留在我添加透明度之前构建的先前版本。

我手动将新的微调器 SWF 复制到主应用程序的 bin 中，然后它工作了！

# c - 需要一个通用库，纯C

> ID：890065
> 
> 赞同：23
> 
> 时间：2009-05-20T20:28:34.910
> 
> 标签：c, data-structures

您能否推荐一个用于 C（纯 C，而不是 C++）的良好通用数据容器库？我只需要基本结构，如动态数组、哈希表等。

（注意：“好”是指快速+优雅的界面）。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-20T21:03:10.127

Glib 还不足以满足您的需求吗？:-) [developer.gnome.org/glib](http://developer.gnome.org/glib)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-05-20T20:33:42.480

Apache 便携式运行时

[http://apr.apache.org/](http://apr.apache.org/)

包括这些领域的模块。

*   平台定义
*   内存分配
*   原子操作
*   动态对象处理
*   用于操作环境的函数
*   错误代码
*   档案资料
*   文件 I/O 处理函数
*   文件名匹配函数
*   杂项库例程
*   命令参数解析
*   全局锁定例程
*   哈希表
*   通用库例程
*   MMAP（内存映射）例程
*   网络例程
*   轮询例程
*   内存池函数
*   可移植例程
*   进程锁定例程
*   随机函数
*   环宏实现
*   共享内存例程
*   信号处理
*   字符串例程
*   内部 APR 支持功能
*   表和数组函数
*   条件变量例程
*   线程互斥例程
*   线程和进程函数
*   读取器/写入器锁定例程
*   时间例程
*   用户和组 ID 服务

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-05-20T23:14:55.540

我认为 Dave Hanson 的[C 接口和实现](http://www.cs.princeton.edu/software/cii/)既快速又优雅。它包括许多不同类型的容器、一些字符串处理、多精度算术、异常、几个不同的内存管理器。好东西。

有一本书，但您无需购买即可使用该软件。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-05-21T20:33:37.373

我之前推荐[过 MemSL](http://www.memorystructures.com/ "记忆体")，但该网站和公司似乎已经灭绝。我现在建议[glib](https://developer.gnome.org/glib/stable/ "油嘴滑舌")，它涵盖了许多相同的功能，并且在整个 Linux 社区中得到了广泛的支持和使用。

我在实现 x86 内核时使用了 MemSL，我发现它通用、可靠且没有错误。

来自描述：内存结构库（MemSL）的C概述

内存结构库，简称 MemSL，是一个有用的例程库，允许有效使用 C 中的复杂数据结构。MemSL 包含用于管理的例程：

*   多维动态分配数组
*   单链表
*   双链表
*   循环链表
*   使用链接列表剪切、复制和粘贴
*   指向链表的多个位置指针
*   堆栈
*   队列
*   出队
*   套
*   包
*   表
*   字典
*   具有单独链接的哈希表
*   具有用户定义分页的哈希表
*   具有动态分页的哈希表
*   二叉搜索树
*   线程二叉搜索树
*   AVL 平衡二叉搜索树
*   AVL 平衡线程二叉搜索树
*   优先堆
*   完全动态的优先搜索队列

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-05-20T20:35:59.933

[http://home.gna.org/gdsl/](http://home.gna.org/gdsl/)

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-05-20T21:03:52.560

您可能还想查看[iMatix SFL](http://legacy.imatix.com/html/sfl/)以引用他们的网页：

> iMatix 的 SFL（标准函数库）是用于 C/C++ 程序的可移植函数库。SFL 是多年发展的成果，并作为开源软件提供给 Internet 社区。SFL 用 ANSI C 编写，并已移植到 MS-DOS、Windows、OS/2、Linux 和其他 UNIX 系统（IBM AIX、SunOS、HP/UX、Solaris、NetBSD、FreeBSD、SCO OpenServer、> Digital UNIX）和数字 OpenVMS。它带有完整的 HTML 源代码和文档。
> 
> SFL 提供了大约 450 种功能，涵盖以下领域：
> 
> *   压缩、加密和编码；
> *   数据类型转换和格式化；
> *   日期、时间和日历；
> *   目录和环境访问；
> *   用户和进程组；
> *   反转位图索引；
> *   符号表；
> *   错误信息文件；
> *   配置文件；
> *   字符串操作和搜索；
> *   文件访问；
> *   互联网插座接入；
> *   互联网编程（MIME、CGI）；
> *   SMTP（电子邮件）访问；
> *   服务器（批处理）编程；
> *   程序跟踪。
> 
> SFL 是免费软件，您可以根据[SFL 许可协议](http://legacy.imatix.com/html/sfl/sfl4.htm#license)为私人或商业目的使用和分发。

有关 API 本身的更多详细信息，请参见[此处](http://legacy.imatix.com/html/sfl/index.htm)。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-05-20T23:38:29.627

[Sglib](http://freshmeat.net/projects/sglib/) “是 C 的通用库，其灵感来自 C++ 的标准模板库”

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-08-14T09:09:32.843

让我补充一下：

[http://libslack.org](http://libslack.org)

（...并添加到此：libcx）

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2010-12-10T04:34:33.067

您可能有兴趣查看 qLibc。

[http://en.wikipedia.org/wiki/Qlibc](http://en.wikipedia.org/wiki/Qlibc) http://www.qdecoder.org/qlibc/

它是一个通用的完整 C/C++ 库，包括各种容器和通用库例程。

# php - ACL 中应该包含哪些资源？对象的模型还是对象的实例？

> ID：890068
> 
> 赞同：0
> 
> 时间：2009-05-20T20:28:58.823
> 
> 标签：php, zend-framework, acl

请帮助我为我的 PHP Web 应用程序实现访问控制列表。我专门使用 Zend_ACL。

我希望对哪些特定实体（无论是用户还是组）可以访问哪些资源进行细粒度的、应用程序范围的控制。我希望能够授予对特定资源实例的访问权限，以及对该类型的所有资源的访问权限。例如：

*   用户 #1 拥有所有帖子的编辑权限
*   用户 #2 是客座编辑，对帖子 ID #5 具有编辑权限
*   第 1 组（来宾）对所有内容都具有读取权限
*   用户属于从来宾继承的用户组。

我的问题是：ACL 是否应该引用资源类型或其中的特定实例？我是否应该像这样使用 ACL 授予用户基本的、资源类型范围的特权：

*   在帖子上向用户 #1 授予编辑权限
*   授予用户 #2 只不过是继承
*   授予组 #1 读取所有资源
*   实施例外表以跟踪对特定资源的授予和拒绝

或者我应该为我的不同类型资源的所有单个实例创建资源并继续授权横冲直撞以允许所有用户读取所有资源？看起来比较野蛮。

我当前的解决方案是这样的：使用资源继承，创建一个没有类型的最父资源，为每种类型创建一个此根的子资源，然后为每个实例创建每种类型的子资源。这允许我授予一种特定类型并拒绝少数实例，或者拒绝特定类型但授予一个实例（如上面的用户#2）。这很好地统一了我的权限系统，但是我的需求更复杂。很快，资源类型将被嵌套。所以我将不同的模块谁可以是父母或孩子。一个例子：一个站点范围的照片库模块，一个公告模块，下面有另一个更独特的画廊。我不太确定该怎么做才能解决这个问题。我仍然希望能够授予所有画廊，或者只是一个，或者只是下面的一些照片。请记住 Zend_ACL 没有

实现这一点的最佳方法是什么？全部使用 ACL 还是使用每个模块中内置的一些逻辑？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-12T07:24:30.237

我刚刚回复了[SO995925：我应该如何在 ACL 中构建我的资源树？](https://stackoverflow.com/questions/995925/how-should-i-structure-my-tree-of-resources-in-an-acl/1259043#1259043)我给你的建议是完全一样的。

一切尽在您的脑海中-“公告画廊”是“照片画廊”的子资源。Generic Gallery #1 是“Photo Gallery”的父母，而“Announcement Gallery”是“Announcement Gallery”的父母。如果您需要再次拆分树，您可以随时将另一个父资源步骤添加到您的链中。

仍然是一个简单的树继承链。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-20T20:51:23.147

我认为，您的解决方案计划是大多数系统的工作方式。Windows 文件系统就是这样工作的。我在 DCE 中使用的第一个 ACL 系统就是这样工作的。

继承是你必须弄清楚的。您是动态继承还是在创建资源时继承？

# reporting-services - ReportViewer Web 控件和动态连接字符串

> ID：890078
> 
> 赞同：0
> 
> 时间：2009-05-20T20:30:45.340
> 
> 标签：reporting-services, parameters, reportviewer, dynamic-data, parameter-passing

所以我在 Reporting Services 2005 中有一份报告。其中有一个参数 (ConnectionString)，它决定了报告将使用哪个数据源。它还有其他几个参数，它们是从 ConnectionString 参数中选择的数据源派生的下拉列表。

在报表管理器中，这很好用。所有的下拉菜单一开始都是灰色的。当您选择数据源时，页面重新查询/重绘以及其他参数的所有可用参数值都将根据这些字段的查询进行填充。

然而 ...

在 ReportViewer Web 控件中，当第一次加载报表时，所有其他参数字段都只是空文本框，而不是下拉框。为 ConnectionString 参数选择不同的数据源不会重新查询/重新绘制其他参数。

我一直在翻阅 ReportViewer 编程参考，看看是否有某种方法可以复制报表管理器在某些参数更改时使用报表查看器重新加载网页的方式，但我找不到任何不超过我可怜的东西.NET 小脑袋。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T14:45:51.007

不确定这是否有帮助，但我确实有一个建议。我会尝试从报告中拉出下拉框的逻辑并将它们放在 ASP.net 页面中。然后将参数传递给报表并控制渲染/刷新。

高温高压

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-06-01T15:14:45.983

更新：事实证明，您必须为任何参数提供默认值，这些参数反过来会影响报告中的其他参数，以便下拉框在初始化时正确加载。另请注意，这是递归的 - 因此，如果您有一个影响另一个影响另一个参数的参数的参数，则第一个和第二个参数都必须具有默认值。

# c# - PHP/Rails/Django/ASP 网站应该是用 C++ 编写的？

> ID：890081
> 
> 赞同：4
> 
> 时间：2009-05-20T20:30:58.307
> 
> 标签：c#, php, c++, ruby-on-rails, django

我正在查看 SO 成员的开源项目。它是一个用 C++ 编写的 Web 框架。

现在你们可能已经准备好回应 C++ 是如何成为一种糟糕的网站语言，而在网站中，瓶颈在于数据库。

但是......我读了这篇文章：

[http://art-blog.no-ip.info/cppcms/blog/post/42](http://art-blog.no-ip.info/cppcms/blog/post/42)

在那里，他提出在维基百科这样的大型站点中，数据库服务器仅占所有服务器的 10%。因此 C++ 会比 PHP Python Ruby C# 等语言更好。

他的观点有效吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-21T11:22:36.130

您链接到的文章的问题在于，当作者问“瓶颈”在哪里时，他显然并不真正知道他在说什么；某人拥有比数据库服务器更多的 Web 服务器这一事实并不意味着“数据库不可能是问题所在”。“数据库是瓶颈”的一般含义与曾经对 Web 应用程序进行运行时分析的每个人所学到的相同。

考虑一个需要半秒钟才能返回完整响应的应用程序。假设你坐下来分析它，发现那半秒的处理时间分解如下：

*   解析传入请求：50ms
*   查询数据库：350ms
*   为响应渲染 HTML：50 毫秒
*   发回响应：50ms

如果您看到这样的细分，其中数据库查询占应用程序实际运行时间的 70%，您会正确地得出结论，数据库是瓶颈。这正是大多数人在分析他们的应用程序时所发现*的*（而且，通常，数据库完全支配了处理时间，以至于为其余处理选择的语言不会对任何人造成任何影响）。

所涉及的数据库服务器的数量并不重要。这里的名言是，像您链接的帖子的作者这样的人是那种听说一个女人需要九个月才能生孩子，并假设九个女人一起工作可以在一个月内完成的人。用数据库术语来说：如果给定的查询在给定的数据库上执行需要 100 毫秒，那么添加更多的数据库服务器不会使它们中的任何一个能够更快地执行该查询。添加更多数据库服务器的原因是能够处理更多并发请求并防止数据库过载，而不是使孤立的请求更快。

然后从那里开始通常的扩展应用程序的舞蹈：缓存以减少检索数据或呈现响应所花费的总时间，负载平衡以增加您可以服务的并发请求数量，分片和更高级的数据库设计防止在负载等情况下陷入困境的计划，等等。

但是，您会注意到，这与使用的编程语言没有任何关系，因为再一次，其他因素所花费或节省的时间量大大超过了“快速”所获得或损失的时间量或“慢”语言（当然，真的没有这样的东西；很大程度上取决于问题领域和程序员的技能，以至于您无法进行有意义的一般比较）。

无论如何，这有点冗长而杂乱无章，所以我将用一个一般准则来结束它：如果你看到有人争辩说“你应该使用语言 X 构建，因为它运行得更快”，这是他们不这样做的一个死的赠品对现实世界的性能或扩展一无所知。因为，毕竟，如果只是归结为“用最快的语言编写”，他们会建议我们都使用汇编:)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-20T20:39:42.797

服务器是一次性固定成本几大。程序员的时间成本远不止于此。当然，用 C++ 编写网站会降低硬件成本，但会大大减慢开发速度。因此，如果您可以通过使用 Ruby 而不是 C++ 将您的开发时间缩短一个人月，那么您需要支付额外的服务器费用。

更好的意思远不止“更快”。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-20T20:46:27.870

在使用编译的静态类型语言（如 C++）进行编写时，您会面临更多问题，这些都会影响开发。像 Ruby 或 PHP 这样的脚本语言被发明出来的一些主要原因是为了让我们程序员可以从我们所使用的语言和工具集中获得更高的效率。

是的，如果网站是用 C++ 等语言编写的，它们会更快。是的，它们可以为更多的人服务，更具可扩展性并且更高效。但这是否足以让我们失去解释语言给我们带来的所有好处？程序员的幸福感、开发时间、易用性、可移植性，还有很多我无法提及的东西。

适合工作的正确工具，对于 C++，网站开发不是其中之一。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-20T20:55:11.407

我不愿意说服务器的一次性成本只有几万美元，因为有些成本高达数十万，我敢说几百万。许多消息来源表明，IT 行业最大的成本是硬件，而不是人力。但是为了比较语言，我们需要比较它们，而不是硬件。

Ruby、Python、PHP 和 Groovy 等语言背后的理念本质上是快速应用程序开发 (RAD)。框架、Ruby on Rails、Django、CakePHP 和 Grails 的存在是为了更好地促进 RAD。这些语言易于使用，使开发人员能够以很少的成本进行设置和开发，并且与其他语言或设置相比，所涉及的时间线减少了。

是对还是错？这都是个人意见，但最终项目的需求将定义最适合的工具集。如果您的应用程序流量低，并且您希望在几个月内开发并运行它，那么使用前面提到的语言和/或框架之一将是理想的。

但是 C++、.Net 和 J2EE 呢？一切都有一个地方。这些往往具有更高的前期成本，与构建项目、设置开发环境和进行实际开发的时间和精力相关。但是由它们构建的语言和框架更适合可扩展性以适应繁重的流量或计算。

以 Facebook 为例。最初的站点被原型化并部署为 PHP 应用程序，用户群相对较小。随着网站发展成为我们今天所知道的怪物，他们通过在后端实现 J2EE 并在前端使用现有的 PHP 脚本来扩展他们的应用程序。

作为具有 J2EE 开发和 Python/PHP 经验的人，有一组非常明显的优点和缺点。我可以在几天内用 PHP 构建一个博客，准备好供公众访问，但是 J2EE 中的同一个项目可能需要更长的时间。

请原谅我的术语，但企业语言（J2EE、.Net）需要大量的配置和部署工作。Ruby、PHP 和 Python 不会，您只需打开记事本，编写代码并使用正确的扩展名保存它，然后就可以上传了。

这有帮助吗？

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-20T20:57:00.077

> 程序员的幸福感、开发时间、易用性、可移植性等等我说不上来

事实上......如果使用**正确的**工具，在 C++ 中开发并不是那么可怕和缓慢的过程。

这个项目运行的 Wiki 是在几天内编写完成的（是的，用 C++ 编写）......对于可怕的 C++ 语言来说还不错；-)

看一看：

*   根据 SVN 日志首次提交：**24/10/2008** [http://cppcms.svn.sourceforge.net/viewvc/cppcms/wikipp/trunk/Makefile.am?view=log](http://cppcms.svn.sourceforge.net/viewvc/cppcms/wikipp/trunk/Makefile.am?view=log)
*   根据历史记录的第一个生产页面：**30/10/2008** [http://art-blog.no-ip.info/wikipp/en/changes/9](http://art-blog.no-ip.info/wikipp/en/changes/9)

我认为在晚上工作创建这样的 wiki 并不是一个缓慢的过程：http: [//art-blog.no-ip.info/wikipp/en/page/main](http://art-blog.no-ip.info/wikipp/en/page/main)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-21T20:21:49.380

不，他的观点无效。并不是说一个比另一个更好，而是以 C# 和 java 为例，它们只是更先进的现代语言，在设计时考虑了 C++ 的问题。

如果您不必这样做，那么打扰诸如垃圾收集之类的事情是没有任何意义的。此外，各种 Web 框架语言有如此多的组件、控件、模块和许多其他部分，无论是开源的还是其他的，已经由其他开发人员为它们编写，你将在各处重新发明其他语言中存在的轮子。

我将永远在我心中为 C++ 保留一席之地，但建议你最好用 C++ 编写网站有点愚蠢或值得攻击。

（编辑：也许如果 C++ 是您知道的唯一语言，或者您在 C++ 中有很多用于网络的自制组件，但您最好还是学习一种用于网站开发的 C++ 后代语言，这很容易学习一旦你知道 C++/C)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-15T01:55:56.220

他的观点不适用于 99% 的 Web 应用程序。Web 应用程序受益于快速迭代和友好的界面，这两者都可以通过 PHP、Python 和 Ruby 等语言更好地实现。如果您足够好或幸运地开发了一项高度使用的服务，那么您在设计它以进行扩展时将毫不费力。

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2009-05-20T23:30:55.710

上次我查了一下，php、Ruby 和 Python 都是用 C 编写的。这不算吗？

# php - PHP 挂起等待 exec 从 wget+mysql 命令返回结果

> ID：890083
> 
> 赞同：2
> 
> 时间：2009-05-20T20:31:39.240
> 
> 标签：php, mysql, exec, wget

相关：[看这里](https://stackoverflow.com/questions/886061/run-mysql-query-after-wget-finishes-downloading-file)

我有这个命令：

```
exec("(wget  -O http://domain/file.zip && mysql -u user -ppassword database -e \"UPDATE \\`table\\` SET \\`status\\` = 'live' WHERE \\`id\\` = '1234'\") & echo \$!"); 
```

上面的命令可以正常工作，但是 PHP 会等待视频完成下载，然后再进行下一次下载。然而，下一行将下载发送到后台，这是我试图从上一行中实现的。

```
exec("wget -O http://domain/file.zip &>/dev/null & echo \$!"); 
```

如何更改上面的第一行以将下载发送到后台？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-20T20:43:24.630

您必须让您使用 & 将进程发送到后台并重定向所有输出。所以你需要添加

```
> /dev/null 2>&1 & 
```

在您的命令结束时。所以你应该得到这样的结果：

```
exec("(wget  -O http://domain/file.zip && mysql -u user -ppassword database -e \"UPDATE \\`table\\` SET \\`status\\` = 'live' WHERE \\`id\\` = '1234'\") echo \$! > /dev/null 2>&1 &"); 
```

[编辑]

为了使事情更简单，您还可以将 wget 和更新移动到另一个您将使用 exec 调用的 php 文件中。所以你最终只会

```
exec("php NewFile.php > /dev/null 2>&1 &"); 
```

# vim - 无法在 Vim 的可视模式下在外部运行许多命令

> ID：890084
> 
> 赞同：0
> 
> 时间：2009-05-20T20:31:52.063
> 
> 标签：vim

我在自述文件中有以下命令：

```
./Setup ...
./Setup ...
./Setup ... 
```

我想通过直观地选择代码然后运行它们来运行它们。

我跑不成功

```
: '<,'> ! 
```

**Luc 在回答中发表评论后的当前代码**

**我在 .vimrc 中的代码我没有设法开始工作：**

```
vmap <silent> <leader>v y:exe '!'.join(split(@", "\n"),';')<cr> 
```

我正在尝试为

```
v yy 
```

**你怎样才能让上面的命令工作**，这样你就可以直接在 Vim 中运行文件的命令？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-21T10:50:21.997

*   首先选择你的文字，
*   然后用`y`,复制它
*   最后，您可以执行：

    :exe '!'.join(split(@", "\n"),';')

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-29T10:23:23.937

这可能过于简单化了，但为什么不这样做：

```
:e 自述文件
:%!bash

```

这通过 bash 过滤当前文件，将每一行作为命令执行。当前缓冲区由运行文件中所有命令的输出替换。

首先将其保存为另一个文件可能会有所帮助`:w RESULTS`，因此您不会意外覆盖原始文件：

```
:e 自述文件
:w 结果
:%!bash

```

您曾说过您想通过视觉选择来执行此操作，这同样可以在您选择要执行的内容后，键入`:`. `'<,'>`将自动添加到当前命令之前。 `'<`是当前选择开始的标记，而`'>`是当前选择结束的标记。您可以只运行您选择的那些命令，就像上面一样：

```
:'<,'>!bash

```

这将仅用执行这些命令的输出替换选定的命令。

# c# - 您如何将身份验证、角色和安全性融入您的 DDD？

> ID：890085
> 
> 赞同：11
> 
> 时间：2009-05-20T20:31:56.620
> 
> 标签：c#, security, authentication, domain-driven-design, roles

您如何在 C# 领域驱动设计项目中实现角色和安全性？关于它应该由调用应用程序（ASP.NET MVC）还是在域模型本身（模型实体和服务）中实现，我们存在一些激烈的争论。有些人认为它应该在网站本身，因为那里已经存在身份验证。但这意味着每次与核心业务系统集成时都必须重新实现安全性。

**例如：**管理员应该能够在系统中执行几乎任何操作，例如编辑和删除记录（即他们可以删除用户的订单）。另一方面，用户应该只能编辑和删除他们自己的记录（即他们可以从他们的购物车中添加/删除项目）。

顺便说一句，这是一篇关于该主题的不错的论文，涵盖了有关 DDD 和安全的 7 种不同场景：

[领域驱动设计中的安全性](http://wwwhome.cs.utwente.nl/~pires/supervision/uithol-msc-thesis.pdf)

*   第四章 安全服务设计场景
    *   4.1 场景一：安全服务作为常规服务
    *   4.2 场景 2：UI 中嵌入的安全性
    *   4.3 场景三：封装领域模型的安全服务
    *   4.4 场景四：安全服务作为 UI 的网关
    *   4.5 场景 5：安全服务作为 UI 的适配器
    *   4.6 场景六：AOP 与适配器集成的安全服务
    *   4.7 场景七：与AOP集成的安全服务

我个人倾向于使用 PostSharp 的 AOP，但之前没有做过太多的工作，所以我犹豫要不要迈出这一步。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-20T20:51:35.253

不要忘记运行时已经内置了一个抽象的安全/用户系统——主体（参见这个[现有的答案](https://stackoverflow.com/questions/818891/what-is-genericidentity/819124#819124)——注意这`GenericIdentity`只是一个选项；编写自己的选项非常简单）。

您的 UI 可以根据特定实现来处理创建和分配主体（实际上，IIRC ASP.NET 和 WCF 会自动执行此操作，或者对于 winforms/wpf，您可以使用 Windows 身份，或者（通过 Web 服务）相同的 ASP .NET 登录）。

然后您的业务逻辑只是检查`Thread.CurrentPrincipal`；从中您可以获取名称、身份验证方法并检查角色（无需知道角色是如何实现的）。

运行时还提供内置检查：

```
 [PrincipalPermission(SecurityAction.Demand, Role = Roles.Admin)]
    public void Foo() {...} 
```

（`Roles.Admin`您的角色名称的字符串常量在哪里）这将自动检查访问权限，`SecurityException`如果不在角色中则抛出一个。您还可以通过代码检查（如果角色在编译时未固定，则很有用）。

显然，您的 UI 应该检查角色（以禁用/隐藏功能），但最好让业务代码*强制执行*角色而无需了解 UI。

（添加）

我应该提到这`GenericIdentity`对于单元测试很方便。当然，您*可以*使用自己的安全 API，没有人会阻止您...

# linux - 'cd' 的 BASH 空白别名

> ID：890086
> 
> 赞同：19
> 
> 时间：2009-05-20T20:31:59.130
> 
> 标签：linux, bash, shell, alias

我是一个快乐的 BASH 用户。我不想切换到另一个 shell（在本例中为 ZSH）。

ZSH 具有更改目录的能力，而无需键入：

```
cd /to/a/directory 
```

无需键入即可更改目录的正确别名（或者可能是 BASH 函数）是`cd`什么？

在我上面的示例中，移动到 /to/a/directory 将像这样完成：

```
/to/a/directory 
```

我努力了：

```
alias ''='cd '
alias ""='cd '
alias " "='cd ' 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-05-20T21:09:15.450

[这是 Bash 4.0 版中](http://tiswww.case.edu/php/chet/bash/CHANGES)添加的一个选项。你可以设置它：

```
$ shopt -s autocd 
```

将它放在您的`.bashrc`文件中以始终启用它。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-20T20:57:45.100

我认为你不能有一个“空白”别名，这真的没有意义..

bash 4.0 版添加了`autocd`通过运行设置的选项`shopt -s autocd`（正如 mipadi 回答的那样）

以前版本的 bash 中没有这样的选项，烦人。

# jquery - 加载后的jQuery调用函数

> ID：890090
> 
> 赞同：40
> 
> 时间：2009-05-20T20:32:41.110
> 
> 标签：jquery

需要根据选择的收音机[（链接此处）](https://stackoverflow.com/questions/877328/jquery-disable-select-options-based-on-radio-selected-need-support-for-all-brows)对某些选项调用过滤器功能，加载页面后如何调用它？收音机是从数据库调用中设置的，我想过滤选项

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2009-05-20T20:36:06.547

```
$(document).ready(my_function); 
```

或者

```
$(document).ready(function () {
  // Function code here.
}); 
```

或者更短但可读性更低的变体：

```
$(my_function); 
```

所有这些都会导致 my_function 在 DOM 加载后被调用。

有关详细信息，请参阅[准备好的事件](http://docs.jquery.com/Events/ready)文档。

> 绑定要在 DOM 准备好被遍历和操作时执行的函数。

编辑：

要模拟点击，请使用不带参数的 click() 方法：

```
$('#button').click(); 
```

从[文档](http://docs.jquery.com/Events/click)：

> 触发每个匹配元素的点击事件。导致执行所有已绑定到该单击事件的函数。

总而言之，以下代码模拟了文档加载完成时的单击：

```
$(function () {
  $('#button').click();
}); 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-02-02T16:46:30.913

```
$(window).bind("load", function() {

   // code here 
}); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-02-12T11:39:42.150

粗鲁，但做你想做的，打破了执行范围：

```
$(function(){
setTimeout(function(){
//Code to call
},1);
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-20T21:23:22.910

关于您评论中的问题：

假设您之前已将函数绑定到单选按钮的单击事件，请将其添加到您的`$(document).ready`函数中：

```
$('#[radioButtonOptionID]').click() 
```

没有参数，模拟点击事件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-08-30T22:37:16.007

```
$(window).bind("load", function() {
  // write your code here
}); 
```

# wpf - 通过代码设置 TextBox.Width="*"

> ID：890096
> 
> 赞同：4
> 
> 时间：2009-05-20T20:33:37.847
> 
> 标签：wpf, textbox, autosize

有谁知道如何设置 TextBox.Width 属性以填充代码中父容器的其余部分？在 Xaml 中，我只需将 Width 属性设置为 *，但我不知道如何在代码中执行此操作。

谢谢，罗伊

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-20T20:37:46.293

你在寻找

```
HorizontalAlignment="Stretch" 
```

相关答案：

[WPF - 在 StackPanel 中设置 Horizo​​ntalAlignment= 拉伸到文本框](https://stackoverflow.com/questions/405935/wpf-setting-horizontalalignment-stretch-to-texbox-in-stackpanel)

[Horizo​​ntalAlignment=Stretch、MaxWidth 和 Left 同时对齐？](https://stackoverflow.com/questions/280331/wpf-horizontalalignmentstretch-maxwidth-and-left-aligned-at-the-same-time)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-20T20:35:58.920

尝试以下

```
textBox.Width = Double.NaN; 
```

Double.NaN（不是数字）相当于任何大小。

# c# - 在 C# 中从锯齿状数组转换为双指针

> ID：890098
> 
> 赞同：14
> 
> 时间：2009-05-20T20:34:18.737
> 
> 标签：c#, arrays, pointers, jagged-arrays, double-pointer

这里有一个简单的问题：有没有办法从锯齿状数组转换为双指针？

例如将 a 转换`double[][]`为`double**`

不幸的是，这不能仅仅通过强制转换来完成（就像在普通的旧 C 中一样），不幸的是。使用`fixed`语句似乎也不能解决问题。在 C# 中是否有任何（最好尽可能高效）方法来完成此任务？我怀疑解决方案可能根本不是很明显，尽管我希望有一个简单的解决方案。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2015-12-09T17:30:21.420

一点安全感。
正如对第一个解决方案的评论中提到的，嵌套数组可以移动，所以它们也应该被固定。

```
unsafe
{
    double[][] array = new double[3][];
    array[0] = new double[] { 1.25, 2.28, 3, 4 };
    array[1] = new double[] { 5, 6.24, 7.42, 8 };
    array[2] = new double[] { 9, 10.15, 11, 12.14 };

    GCHandle[] pinnedArray = new GCHandle[array.Length];
    double*[] ptrArray = new double*[array.Length];

    for (int i = 0; i < array.Length; i++)
    {
        pinnedArray[i] = GCHandle.Alloc(array[i], GCHandleType.Pinned);
    }

    for (int i = 0; i < array.Length; ++i)
    {
        // as you can see, this pointer will point to the first element of each array
        ptrArray[i] = (double*)pinnedArray[i].AddrOfPinnedObject();
    }

    // here is your double**
    fixed(double** doublePtr = &ptrArray[0])
    {
        Console.WriteLine(**doublePtr);
    }

    // unpin all the pinned objects,
    // otherwise they will live in memory till assembly unloading
    // even if they will went out of scope
    for (int i = 0; i < pinnedArray.Length; ++i)
        pinnedArray[i].Free();
} 
```

问题的简要说明：

当我们在堆上分配一些对象时，它们可以在垃圾收集时移动到另一个位置。所以，想象下一种情况：你已经分配了一些对象和你的内部数组，它们都放在堆上的零代中。

[![在此处输入图像描述](https://i.stack.imgur.com/WbCAD.png)](https://i.stack.imgur.com/WbCAD.png)

现在，一些对象已经从作用域中消失并变成了垃圾，一些对象刚刚被分配。垃圾收集器会将旧对象移出堆，并将其他对象移到更靠近开始甚至下一代的位置，从而压缩堆。结果将如下所示：

[![在此处输入图像描述](https://i.stack.imgur.com/IM01A.png)](https://i.stack.imgur.com/IM01A.png)

因此，我们的目标是将一些对象“固定”在堆中，这样它们就不会移动。我们需要什么来实现这个目标？我们有[固定](https://msdn.microsoft.com/en-us/library/f58wzh21.aspx)的语句和[GCHandle.Allocate](https://msdn.microsoft.com/en-us/library/a95009h1(v=vs.110).aspx)方法。

首先，做什么`GCHandle.Allocate`？它在内部系统表中创建新条目，该条目具有对作为参数传递给方法的对象的引用。因此，当垃圾收集器检查堆时，他将检查内部表中的条目，如果找到条目，他会将对象标记为活动并且不会将其移出堆。然后，他会查看这个对象是如何被固定的，并且在压缩阶段不会移动内存中的对象。`fixed`语句的作用几乎相同，除了它会在您离开作用域时自动“取消固定”对象。

总结：每个已固定的对象在`fixed`离开范围后将自动“取消固定”。在我们的例子中，它将在循环的下一次迭代中。

如何检查你的对象不会被移动或垃圾收集：只需消耗所有堆的预算用于零生成并强制 GC 压缩堆。换句话说：在堆上创建很多对象。并在您固定或“固定”对象后执行此操作。

```
for(int i = 0; i < 1000000; ++i)
{
    MemoryStream stream = new MemoryStream(10);
    //make sure that JIT will not optimize anything, make some work
    stream.Write(new Byte[]{1,2,3}, 1, 2);
}
GC.Collect(); 
```

小提示：有两种类型的堆——用于大型对象和小型对象。如果你的对象很大，你应该创建大对象来检查你的代码，否则小对象不会强制 GC 开始垃圾收集和压缩。

最后，这里有一些示例代码，展示了使用未固定/未固定指针访问底层数组的危险 - 对于任何感兴趣的人。

```
namespace DangerousNamespace
{
    // WARNING!
    // This code includes possible memory access errors with unfixed/unpinned pointers!
    public class DangerousClass
    {
        public static void Main()
        {
            unsafe
            {
                double[][] array = new double[3][];
                array[0] = new double[] { 1.25, 2.28, 3, 4 };
                array[1] = new double[] { 5, 6.24, 7.42, 8 };
                array[2] = new double[] { 9, 10.15, 11, 12.14 };

                fixed (double* junk = &array[0][0])
                {
                    double*[] arrayofptr = new double*[array.Length];
                    for (int i = 0; i < array.Length; i++)
                        fixed (double* ptr = &array[i][0])
                        {
                            arrayofptr[i] = ptr;
                        }

                    for (int i = 0; i < 10000000; ++i)
                    {
                        Object z = new Object();
                    }
                    GC.Collect();

                    fixed (double** ptrptr = &arrayofptr[0])
                    {
                        for (int i = 0; i < 1000000; ++i)
                        {
                            using (MemoryStream z = new MemoryStream(200))
                            {
                                z.Write(new byte[] { 1, 2, 3 }, 1, 2);
                            }
                        }
                        GC.Collect();
                        // should print 1.25
                        Console.WriteLine(*(double*)(*(double**)ptrptr));
                    }
                }
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-20T21:06:36.033

double[][] 是 double[] 的数组，而不是 double* 的数组，所以要获得 double** ，我们首先需要一个 double*[]

```
double[][] array = //whatever
//initialize as necessary

fixed (double* junk = &array[0][0]){

    double*[] arrayofptr = new double*[array.Length];
    for (int i = 0; i < array.Length; i++)
        fixed (double* ptr = &array[i][0])
        {
            arrayofptr[i] = ptr;
        }

    fixed (double** ptrptr = &arrayofptr[0])
    {
        //whatever
    }
} 
```

我不禁想知道这是为了什么，以及是否有比需要双指针更好的解决方案。

* * *

## 回答 #3

> 赞同：-5
> 
> 时间：2009-05-20T21:42:03.823

我暂时使用了 zachrrs 解决方案（这是我怀疑可能首先需要完成的）。这是一个扩展方法：

```
public static double** ToPointer(this double[][] array)
{
    fixed (double* arrayPtr = array[0])
    {
        double*[] ptrArray = new double*[array.Length];
        for (int i = 0; i < array.Length; i++)
        {
            fixed (double* ptr = array[i])
                ptrArray[i] = ptr;
        }

        fixed (double** ptr = ptrArray)
            return ptr;
    }
} 
```

# c# - 如何将双精度格式设置为四舍五入到最接近的美元的货币？

> ID：890100
> 
> 赞同：64
> 
> 时间：2009-05-20T20:35:07.767
> 
> 标签：c#, formatting, rounding, currency

现在我有

```
double numba = 5212.6312
String.Format("{0:C}", Convert.ToInt32(numba) ) 
```

这会给我

```
$5,213.00 
```

但我不想要“.00”。

我知道我可以每次都删除字符串的最后三个字符来达到效果，但似乎应该有一个更简单的方法。

* * *

## 回答 #1

> 赞同：98
> 
> 时间：2009-05-20T20:36:48.980

首先 - 不要将货币保存在 a `double`- 使用 a`decimal`代替。每次。然后使用“C0”作为格式说明符：

```
decimal numba = 5212.6312M;
string s = numba.ToString("C0"); 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-05-20T20:41:45.710

这应该做的工作：

```
String.Format("{0:C0}", Convert.ToInt32(numba)) 
```

后面的数字`C`指定要包含的小数位数。

但是，我怀疑您确实想使用该[`decimal`](http://msdn.microsoft.com/en-us/library/364x0z75(VS.80).aspx)类型来存储此类数字。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-20T20:39:29.457

```
Console.WriteLine(numba.ToString("C0")); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-16T10:31:36.733

我认为实现目标的正确方法是：

```
Thread.CurrentThread.CurrentCulture.NumberFormat.CurrencyDecimalDigits = 0; 
```

只有这样你才应该进行 Format 调用：

```
String.Format("{0:C0}", numba) 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-07-25T11:00:37.897

```
 decimal value = 0.00M;
        value = Convert.ToDecimal(12345.12345);
        Console.WriteLine(".ToString(\"C\") Formates With Currency $ Sign");
        Console.WriteLine(value.ToString("C"));
        //OutPut : $12345.12
        Console.WriteLine(value.ToString("C1"));
        //OutPut : $12345.1
        Console.WriteLine(value.ToString("C2"));
        //OutPut : $12345.12
        Console.WriteLine(value.ToString("C3"));
        //OutPut : $12345.123
        Console.WriteLine(value.ToString("C4"));
        //OutPut : $12345.1235
        Console.WriteLine(value.ToString("C5"));
        //OutPut : $12345.12345
        Console.WriteLine(value.ToString("C6"));
        //OutPut : $12345.123450 
```

[点击查看控制台输出屏幕](http://i.stack.imgur.com/8N0sz.png)

希望这可以帮助你...

谢谢。:)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-09-26T14:39:25.977

简单的：`numba.ToString("C2")`

更多 @ [http://msdn.microsoft.com/pt-br/library/dwhawy9k(v=vs.110).aspx#CFormatString](http://msdn.microsoft.com/pt-br/library/dwhawy9k(v=vs.110).aspx#CFormatString)

# latex - 如何以毫米为单位设置 LaTeX 字体大小？

> ID：890127
> 
> 赞同：17
> 
> 时间：2009-05-20T20:39:52.267
> 
> 标签：latex, fonts, size, font-size

我需要在我的 LaTeX 文档中以毫米为单位设置字体大小。我怎样才能做到这一点？

谢谢你！

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-05-20T20:45:44.640

您是否使用 Type 1 字体（即无限可缩放字体）？如果没有，您需要执行类似的操作`\usepackage{lmodern}`（选择我喜欢的字体，计算机现代的拉丁现代版本）。然后只需输入类似的命令

```
\fontsize{8mm}{9mm}\selectfont 
```

以下文本将在 9 mm 基线上使用 8 mm 高的字体。如果您需要以这种方式设置超过少量文本的大小，您可能必须进入文档类定义——祝你好运；我尽可能远离那些人。

# python - lambdas 有什么用？

> ID：890128
> 
> 赞同：964
> 
> 时间：2009-05-20T20:40:01.297
> 
> 标签：python, function, lambda, closures

我正在尝试找出 Python lambdas。是`lambda`那些在现实生活中应该被遗忘的“有趣”的语言项目之一吗？

我确信在某些极端情况下可能需要它，但鉴于它的模糊性，它有可能在未来的版本中被重新定义（我的假设基于它的各种定义）以及降低的编码清晰度 - 如果它避免？

这让我想起了 C 类型的溢出（缓冲区溢出）——指向顶部变量并重载以设置其他字段值。感觉有点像技术人员的表演，但维护编码员的噩梦。

* * *

## 回答 #1

> 赞同：1046
> 
> 时间：2009-05-20T20:52:10.930

你在谈论[lambda 表达式](https://docs.python.org/3/tutorial/controlflow.html#lambda-expressions)吗？喜欢

```
lambda x: x**2 + 2*x - 5 
```

这些东西其实很有用。Python 支持一种称为*函数*式编程的编程风格，您可以在其中将函数传递给其他函数来完成工作。例子：

```
mult3 = filter(lambda x: x % 3 == 0, [1, 2, 3, 4, 5, 6, 7, 8, 9]) 
```

设置`mult3`为`[3, 6, 9]`，原始列表中那些是 3 的倍数的元素。这比

```
def filterfunc(x):
    return x % 3 == 0
mult3 = filter(filterfunc, [1, 2, 3, 4, 5, 6, 7, 8, 9]) 
```

当然，在这种特殊情况下，您可以做与列表推导相同的事情：

```
mult3 = [x for x in [1, 2, 3, 4, 5, 6, 7, 8, 9] if x % 3 == 0] 
```

（甚至是 as `range(3,10,3)`），但是还有许多其他更复杂的用例，您不能使用列表推导式，而 lambda 函数可能是写出某些内容的最短方法。

*   从另一个函数返回一个函数

    ```
     >>> def transform(n):
      ...     return lambda x: x + n
      ...
      >>> f = transform(3)
      >>> f(4)
      7 
    ```

    这通常用于创建函数包装器，例如 Python 的装饰器。

*   将可迭代序列的元素与`reduce()`

    ```
     >>> reduce(lambda a, b: '{}, {}'.format(a, b), [1, 2, 3, 4, 5, 6, 7, 8, 9])
      '1, 2, 3, 4, 5, 6, 7, 8, 9' 
    ```

*   按备用键排序

    ```
     >>> sorted([1, 2, 3, 4, 5, 6, 7, 8, 9], key=lambda x: abs(5-x))
      [5, 4, 6, 3, 7, 2, 8, 1, 9] 
    ```

我定期使用 lambda 函数。我花了一段时间才习惯它们，但最终我明白它们是语言中非常有价值的一部分。

* * *

## 回答 #2

> 赞同：393
> 
> 时间：2010-01-16T15:03:17.950

`lambda`只是一种花哨的说法`function`。除了它的名字，它没有任何晦涩、令人生畏或神秘的东西。当您阅读以下行时，请在您的脑海中替换`lambda`为：`function`

```
>>> f = lambda x: x + 1
>>> f(3)
4 
```

它只是定义了一个函数`x`。其他一些语言，例如`R`，明确地说：

```
> f = function(x) { x + 1 }
> f(3)
4 
```

你看？这是编程中最自然的事情之一。

* * *

## 回答 #3

> 赞同：110
> 
> 时间：2009-05-20T22:37:58.050

两行总结：

1.  [闭包](http://en.wikipedia.org/wiki/Closure_(computer_science))：非常有用。学习它们，使用它们，爱它们。
2.  Python 的`lambda`关键字：不必要，偶尔有用。如果你发现自己在用它做任何复杂的事情，就把它收起来，定义一个真正的函数。

* * *

## 回答 #4

> 赞同：73
> 
> 时间：2009-05-20T20:49:01.437

lambda 是处理高阶函数的非常重要的抽象机制的一部分。[要正确理解其价值，请观看Abelson 和 Sussman](http://groups.csail.mit.edu/mac/classes/6.001/abelson-sussman-lectures/?)的高质量课程，并阅读[SICP书](http://mitpress.mit.edu/sicp/)

这些是现代软件业务中的相关问题，并且变得越来越流行。

* * *

## 回答 #5

> 赞同：62
> 
> 时间：2009-05-20T20:46:27.790

我怀疑 lambda 会消失。请参阅[Guido](http://mail.python.org/pipermail/python-dev/2006-February/060415.html)关于最终放弃尝试删除它的帖子。又见[冲突概要](https://wiki.python.org/moin/AlternateLambdaSyntax)。

您可以查看这篇文章，了解有关 Python 功能特性背后交易的更多历史：http: [//python-history.blogspot.com/2009/04/origins-of-pythons-functional-features.html](http://python-history.blogspot.com/2009/04/origins-of-pythons-functional-features.html)

> 奇怪的是，最初推动引入 lambda 和其他功能特性的 map、filter 和 reduce 函数在很大程度上已被列表推导和生成器表达式所取代。事实上，reduce 函数已从 Python 3.0 的内置函数列表中删除。（但是，没有必要就 lambda、map 或 filter 的移除提出投诉：他们会留下来。:-)

我自己的两分钱：就清晰度而言，lambda 很少值得。通常有一个不包括 lambda 的更清晰的解决方案。

* * *

## 回答 #6

> 赞同：61
> 
> 时间：2011-04-24T16:48:11.790

lambda 在 GUI 编程中非常有用。例如，假设您正在创建一组按钮，并且您希望使用单个参数化回调而不是每个按钮的唯一回调。Lambda 让您轻松实现这一目标：

```
for value in ["one","two","three"]:
    b = tk.Button(label=value, command=lambda arg=value: my_callback(arg))
    b.pack() 
```

（注意：虽然这个问题是专门询问的`lambda`，但你也可以使用[functools.partial](https://docs.python.org/3.5/library/functools.html#functools.partial)来获得相同类型的结果）

另一种方法是为每个可能导致重复代码的按钮创建单独的回调。

* * *

## 回答 #7

> 赞同：39
> 
> 时间：2009-05-21T02:03:55.543

在 Python 中，`lambda`只是内联定义函数的一种方式，

```
a = lambda x: x + 1
print a(1) 
```

和..

```
def a(x): return x + 1
print a(1) 
```

..*完全*一样。

lambda 没有什么是常规函数不能做的——在 Python 中，函数就像其他任何东西一样是一个对象，而 lambda 只是定义了一个函数：

```
>>> a = lambda x: x + 1
>>> type(a)
<type 'function'> 
```

老实说，我认为`lambda`关键字在 Python 中是多余的——我从来没有需要使用它们（或者看到使用常规函数、列表理解或许多内置函数之一可以更好地使用它们的地方）

举一个完全随机的例子，来自文章[“Python's lambda is broken！”](http://math.andrej.com/2009/04/09/pythons-lambda-is-broken/) ：

> 要查看 lambda 是如何被破坏的，请尝试生成一个函数列表`fs=[f0,...,f9]`where `fi(n)=i+n`。第一次尝试：
> 
> ```
> >>> fs = [(lambda n: i + n) for i in range(10)]
> >>> fs[3](4)
> 13 
> ```

我会争辩说，即使这确实有效，它也是可怕的和“unpythonic”，同样的功能可以用无数其他方式编写，例如：

```
>>> n = 4
>>> [i + n for i in range(10)]
[4, 5, 6, 7, 8, 9, 10, 11, 12, 13] 
```

是的，它不一样，但我**从未**见过需要在列表中生成一组 lambda 函数的原因。它在其他语言中可能有意义，但 Python 不是 Haskell（或 Lisp，或...）

> 请注意，我们可以使用 lambda 并仍然以这种方式获得所需的结果：
> 
> ```
> >>> fs = [(lambda n,i=i: i + n) for i in range(10)]
> >>> fs[3](4)
> 7 
> ```

编辑：

在某些情况下 lambda 很有用，例如在 PyQt 应用程序中连接信号时通常很方便，如下所示：

```
w = PyQt4.QtGui.QLineEdit()
w.textChanged.connect(lambda event: dothing()) 
```

只是这样做会使用额外的参数`w.textChanged.connect(dothing)`调用该方法并导致错误。使用 lambda 意味着我们可以整齐地删除参数，而无需定义包装函数。`dothing``event`

* * *

## 回答 #8

> 赞同：35
> 
> 时间：2010-01-16T15:43:04.210

我发现 lambda 对于执行相同但针对不同情况的函数列表很有用。

就像[Mozilla 的复数规则](https://developer.mozilla.org/en-US/docs/Mozilla/Localization/Localization_and_Plurals)：

```
plural_rules = [
    lambda n: 'all',
    lambda n: 'singular' if n == 1 else 'plural',
    lambda n: 'singular' if 0 <= n <= 1 else 'plural',
    ...
]
# Call plural rule #1 with argument 4 to find out which sentence form to use.
plural_rule[1](4) # returns 'plural' 
```

如果你必须为所有这些定义一个函数，你会在它结束时发疯。此外，使用,等
函数名称也不会很好。当您依赖变量函数 id 时，您需要使用它。`plural_rule_1``plural_rule_2``eval()`

* * *

## 回答 #9

> 赞同：26
> 
> 时间：2009-05-20T20:45:27.357

`lambda`使用命名函数或列表和生成器表达式几乎可以做的任何事情都可以做得更好。

因此，在大多数情况下，基本上在任何情况下，您都应该只是其中之一（可能除了在交互式解释器中编写的临时代码）。

* * *

## 回答 #10

> 赞同：19
> 
> 时间：2009-05-20T20:47:48.567

我已经使用 Python 好几年了，从来没有遇到过*需要*lambda 的情况。真的，正如[教程](http://docs.python.org/tutorial/controlflow.html#lambda-forms "教程")所述，它只是用于语法糖。

* * *

## 回答 #11

> 赞同：17
> 
> 时间：2009-05-20T20:45:12.193

我无法谈论 python 对 lambda 的特定实现，但总的来说 lambda 函数真的很方便。它们是函数式编程的核心技术（甚至可能是 THE 技术），在面向对象的程序中也非常有用。对于某些类型的问题，它们是最好的解决方案，所以当然不应该忘记！

我建议您阅读[闭包](http://en.wikipedia.org/wiki/Closure_(computer_science))和[map 函数](http://docs.python.org/tutorial/datastructures.html)（链接到 python 文档，但它几乎存在于所有支持函数构造的语言中）以了解它为什么有用。

* * *

## 回答 #12

> 赞同：17
> 
> 时间：2013-10-11T03:03:51.060

**Lambda 函数它是一种创建函数的非官僚方式。**

而已。例如，假设您有 main 函数并且需要对值进行平方。让我们看看执行此操作的传统方式和 lambda 方式：

传统方式：

```
def main():
...
...
y = square(some_number)
...
return something

def square(x):
    return x**2 
```

拉姆达方式：

```
def main():
...
square = lambda x: x**2
y = square(some_number)
return something 
```

看到不同？

Lambda 函数非常适合列表，例如列表推导或映射。事实上，列表推导式是一种使用 lambda 表达自己的“pythonic”方式。前任：

```
>>>a = [1,2,3,4]
>>>[x**2 for x in a]
[1,4,9,16] 
```

让我们看看语法的每个元素的含义：

> []：“给我一个清单”
> 
> x**2 ：“使用这个新生的功能”
> 
> for x in a：“进入 a 中的每个元素”

这样方便吗？像这样创建函数。让我们用 lambda 重写它：

```
>>> square = lambda x: x**2
>>> [square(s) for x in a]
[1,4,9,16] 
```

现在让我们使用 map，它是同样的东西，但更与语言无关。Maps 有 2 个参数：

(一) 一项职能

(ii) 一个可迭代的

并为您提供一个列表，其中每个元素是应用于可迭代的每个元素的函数。

因此，使用地图我们将拥有：

```
>>> a = [1,2,3,4]
>>> squared_list = map(lambda x: x**2, a) 
```

如果您掌握了 lambda 和映射，您将拥有强大的能力以简洁的方式操作数据。Lambda 函数既不晦涩，也不带走代码清晰性。不要把困难的东西和新的东西混为一谈。一旦你开始使用它们，你会发现它非常清晰。

* * *

## 回答 #13

> 赞同：13
> 
> 时间：2010-01-16T15:30:05.100

在我看来，这是被低估的好处之一`lambda`是，它是一种将简单表单​​的评估推迟到需要值的方式。让我解释。

实现了许多库例程，以便它们允许某些参数是可调用的（其中 lambda 是其中之一）。这个想法是实际值将仅在将要使用时（而不是在调用时）计算。一个（人为的）例子可能有助于说明这一点。假设您有一个例程，它将记录给定的时间戳。您希望例程使用当前时间减去 30 分钟。你会这样称呼它

```
log_timestamp(datetime.datetime.now() - datetime.timedelta(minutes = 30)) 
```

现在假设只有在某个事件发生时才会调用实际函数，并且您希望仅在那个时候计算时间戳。你可以这样做

```
log_timestamp(lambda : datetime.datetime.now() - datetime.timedelta(minutes = 30)) 
```

假设`log_timestamp`can 处理这样的可调用对象，它将在需要时评估它，您将在那时获得时间戳。

当然有其他方法可以做到这一点（`operator`例如使用模块），但我希望我已经传达了这一点。

*更新*：[这](http://www.mail-archive.com/python-dev@python.org/msg02084.html)是一个更具体的现实世界示例。

*更新 2*：我认为这是所谓的[thunk](https://en.wikipedia.org/wiki/Thunk)的一个例子。

* * *

## 回答 #14

> 赞同：11
> 
> 时间：2013-05-24T13:02:56.363

Lambda 实际上是源自函数式编程思想的非常强大的构造，在 Python 的不久的将来绝不会轻易地修改、重新定义或删除它。它们可以帮助您编写更强大的代码，因为它允许您将函数作为参数传递，从而将函数作为一等公民的想法。

Lambda 确实会让人感到困惑，但是一旦获得了扎实的理解，你就可以像这样编写干净优雅的代码：

```
squared = map(lambda x: x*x, [1, 2, 3, 4, 5]) 
```

上面的代码行返回列表中数字的平方列表。当然，你也可以这样做：

```
def square(x):
    return x*x

squared = map(square, [1, 2, 3, 4, 5]) 
```

很明显，前一个代码更短，如果您打算只在一个地方使用 map 函数（或任何将函数作为参数的类似函数），则尤其如此。这也使代码更加直观和优雅。

此外，正如@David Zaslavsky 在他的回答中提到的那样，列表推导并不总是可行的方法，特别是如果您的列表必须从某种晦涩的数学方式中获取值。

从更实际的角度来看，最近对我来说 lambdas 的最大优势之一是在 GUI 和事件驱动编程方面。如果你看一下 Tkinter 中的回调，它们所接受的所有参数都是触发它们的事件。例如

```
def define_bindings(widget):
    widget.bind("<Button-1>", do-something-cool)

def do-something-cool(event):
    #Your code to execute on the event trigger 
```

现在，如果您有一些论据要通过怎么办？像传递 2 个参数来存储鼠标单击的坐标一样简单。您可以像这样轻松地做到这一点：

```
def main():
    # define widgets and other imp stuff
    x, y = None, None
    widget.bind("<Button-1>", lambda event: do-something-cool(x, y))

def do-something-cool(event, x, y):
    x = event.x
    y = event.y
    #Do other cool stuff 
```

现在您可以争辩说这可以使用全局变量来完成，但是您真的想大惊小怪地担心内存管理和泄漏，尤其是如果全局变量只用于一个特定的地方吗？那只是糟糕的编程风格。

简而言之，lambda 非常棒，永远不应被低估。Python lambdas 虽然与 LISP lambdas 不同（它们更强大），但你真的可以用它们做很多神奇的事情。

* * *

## 回答 #15

> 赞同：11
> 
> 时间：2010-10-18T18:01:05.913

如上所述，Python 中的 lambda 运算符定义了一个匿名函数，而 Python 中的函数是闭包。重要的是不要将闭包的概念与操作符 lambda 混淆，后者只是语法上的美沙酮。

几年前我开始使用 Python 时，我经常使用 lambda，认为它们很酷，还有列表推导式。但是，我编写并且必须维护一个用 Python 编写的大型网站，具有数千个功能点。我从经验中了解到，lambdas 可能可以用来制作原型，但除了保存一些按键之外，没有提供内联函数（命名为闭包），或者有时不提供。

基本上这归结为几点：

*   使用有意义的名称明确编写的软件更容易阅读。根据定义，匿名闭包不能有有意义的名称，因为它们没有名称。出于某种原因，这种简洁似乎也感染了 lambda 参数，因此我们经常看到像 lambda x: x+1 这样的例子
*   重用命名闭包更容易，因为当有一个名称可以引用它们时，它们可以通过名称多次引用。
*   调试使用命名闭包而不是 lambda 的代码更容易，因为名称将出现在回溯中，并出现在错误周围。

这足以将它们四舍五入并将它们转换为命名闭包。然而，我对匿名关闭还有另外两个怨恨。

第一个怨恨很简单，它们只是另一个不必要的关键字，使语言变得混乱。

第二个怨恨更深，在范式层面上，即我不喜欢他们提倡函数式编程风格，因为这种风格不如消息传递、面向对象或过程风格灵活，因为 lambda 演算不是图灵-完成（幸运的是，在 Python 中，即使在 lambda 中，我们仍然可以突破该限制）。我觉得 lambdas 推广这种风格的原因是：

*   有一个隐含的回报，即它们似乎“应该”是函数。

*   它们是另一种更明确、更易读、更可重用和更通用的机制的替代状态隐藏机制：方法。

我努力编写无 lambda 的 Python，并一目了然地删除 lambda。我认为如果没有 lambda，Python 会是一种更好的语言，但这只是我的看法。

* * *

## 回答 #16

> 赞同：8
> 
> 时间：2009-05-20T20:46:37.883

Lambda 通常与函数式编程风格密切相关。您可以通过将函数应用于某些数据并合并结果来解决问题的想法是谷歌用来实现其大部分算法的方法。

以函数式编程风格编写的程序易于并行化，因此在现代多核机器中变得越来越重要。所以简而言之，不，你不应该忘记它们。

* * *

## 回答 #17

> 赞同：7
> 
> 时间：2009-05-20T20:47:05.760

首先恭喜你设法找出了 lambda。在我看来，这是一个非常强大的构造。如今，函数式编程语言的趋势无疑表明它既不应该被避免，也不应该在不久的将来重新定义。

你只需要考虑一点不同。我相信你很快就会爱上它。但如果你只处理python，请小心。因为 lambda 不是真正的闭包，所以它以某种方式被“破坏”了：[pythons lambda is broken](http://math.andrej.com/2009/04/09/pythons-lambda-is-broken/)

* * *

## 回答 #18

> 赞同：6
> 
> 时间：2009-05-20T20:57:23.337

> 我刚刚开始使用 Python 并首先进入 Lambda——这让我花了一段时间才弄清楚。

请注意，这不是对任何事情的谴责。每个人都有不同的事情来之不易。

> lambda 是现实生活中应该被遗忘的那些“有趣”的语言项目之一吗？

不。

> 我确信在某些极端情况下可能需要它，但鉴于它的晦涩难懂，

这并不晦涩。我过去工作过的两个团队，每个人都一直在使用这个功能。

> 在未来版本中重新定义它的潜力（我的假设基于它的各种定义）

除了几年前修复闭包语义之外，我还没有看到在 Python 中重新定义它的严肃提议。

> 以及降低的编码清晰度 - 应该避免吗？

如果您正确使用它，这并不太清楚。相反，拥有更多可用的语言结构*会提高*清晰度。

> 这让我想起了 C 类型的溢出（缓冲区溢出）——指向顶部变量并重载以设置其他字段值……有点像技术人员的表演技巧，但维护编码器的噩梦……

Lambda 就像缓冲区溢出？哇。如果您认为 lambda 是“维护噩梦”，我无法想象您是如何使用它的。

* * *

## 回答 #19

> 赞同：6
> 
> 时间：2013-10-09T00:29:45.483

我使用 lambdas 来避免代码重复。它会使函数易于理解，例如：

```
def a_func()
  ...
  if some_conditon:
     ...
     call_some_big_func(arg1, arg2, arg3, arg4...)
  else
     ...
     call_some_big_func(arg1, arg2, arg3, arg4...) 
```

我用临时 lambda 替换它

```
def a_func()
  ...
  call_big_f = lambda args_that_change: call_some_big_func(arg1, arg2, arg3, args_that_change)
  if some_conditon:
     ...
     call_big_f(argX)
  else
     ...
     call_big_f(argY) 
```

* * *

## 回答 #20

> 赞同：5
> 
> 时间：2012-11-03T12:25:57.467

使用 lambda 的一个有用案例是**提高长列表推导的可读性**。在这个例子`loop_dic`中，为了清晰起见，它很短，但想象一下`loop_dic`很长。如果您只使用包含`i`而不是该值的 lambda 版本的普通值，您将获得一个`NameError`.

```
>>> lis = [{"name": "Peter"}, {"name": "Josef"}]

>>> loop_dic = lambda i: {"name": i["name"] + " Wallace" }
>>> new_lis = [loop_dic(i) for i in lis]

>>> new_lis
[{'name': 'Peter Wallace'}, {'name': 'Josef Wallace'}] 
```

代替

```
>>> lis = [{"name": "Peter"}, {"name": "Josef"}]

>>> new_lis = [{"name": i["name"] + " Wallace"} for i in lis]

>>> new_lis
[{'name': 'Peter Wallace'}, {'name': 'Josef Wallace'}] 
```

* * *

## 回答 #21

> 赞同：5
> 
> 时间：2009-05-21T01:08:31.070

我今天开始阅读 David Mertz 的书“Python 中的文本处理”。虽然他对 Lambda 的描述相当简洁，但第一章中的示例与附录 A 中的解释相结合，让我（终于）跳出了页面，突然间我明白了它们的价值。这并不是说他的解释对你有用，而且我仍处于发现阶段，所以除了以下内容之外，我不会尝试添加这些回复：我是 Python 新手 我是 OOP 新手 Lambdas 对我来说是一场斗争现在我读了 Mertz，我想我明白了，我认为它们非常有用，因为我认为它们允许更简洁的编程方法。

他再现了Python的禅意，其中一句话是*Simple is better than complex。*作为一个非 OOP 程序员阅读 lambdas 代码（直到上周列表理解），我想——*这很简单吗？*. 我今天终于意识到，实际上这些功能使代码比替代方案更具可读性和可理解性——它总是某种循环。我还意识到，就像财务报表一样，Python 不是为新手用户设计的，而是为想要接受教育的用户设计的。我无法相信这种语言有多么强大。当我（最终）意识到 lambdas 的目的和价值时，我想撕掉大约 30 个程序并重新开始在适当的地方放入 lambdas。

* * *

## 回答 #22

> 赞同：5
> 
> 时间：2011-07-13T23:05:09.110

我可以给你一个例子，我实际上需要 lambda。我正在制作一个图形程序，使用右键单击文件并将其分配为三个选项之一。事实证明，在 Tkinter（我正在编写的 GUI 接口程序）中，当有人按下按钮时，不能将其分配给接受参数的命令。因此，如果我选择其中一个选项并希望我选择的结果是：

```
print 'hi there' 
```

然后没什么大不了的。但是，如果我需要我的选择来获得特定的细节怎么办。例如，如果我选择选项 A，它会调用一个函数，该函数接受一些依赖于选项 A、B 或 C 的参数，TKinter 无法支持这一点。实际上，Lamda 是解决此问题的唯一选择...

* * *

## 回答 #23

> 赞同：4
> 
> 时间：2009-05-20T21:20:18.267

我经常使用它，主要用作[空对象](http://en.wikipedia.org/wiki/Null_Object_pattern)或将参数部分绑定到函数。

以下是示例：

### 实现空对象模式：

```
{
    DATA_PACKET: self.handle_data_packets
    NET_PACKET: self.handle_hardware_packets
}.get(packet_type, lambda x : None)(payload) 
```

### 对于参数绑定：

假设我有以下 API

```
def dump_hex(file, var)
    # some code
    pass

class X(object):
    #...
    def packet_received(data):
        # some kind of preprocessing
        self.callback(data)
    #... 
```

然后，当我不想快速将收到的数据转储到文件时，我会这样做：

```
dump_file = file('hex_dump.txt','w')
X.callback = lambda (x): dump_hex(dump_file, x)
...
dump_file.close() 
```

* * *

## 回答 #24

> 赞同：4
> 
> 时间：2014-02-06T18:43:36.967

我是一个 python 初学者，所以为了清楚地了解 lambda，我将它与“for”循环进行了比较；在效率方面。这是代码（python 2.7） -

```
import time
start = time.time() # Measure the time taken for execution

def first():
    squares = map(lambda x: x**2, range(10))
    # ^ Lambda
    end = time.time()
    elapsed = end - start
    print elapsed + ' seconds'
    return elapsed # gives 0.0 seconds

def second():
    lst = []
    for i in range(10):
        lst.append(i**2)
    # ^ a 'for' loop
    end = time.time()
    elapsed = end - start
    print elapsed + ' seconds'
    return elapsed # gives 0.0019998550415 seconds.

print abs(second() - first()) # Gives 0.0019998550415 seconds!(duh) 
```

* * *

## 回答 #25

> 赞同：4
> 
> 时间：2014-01-03T18:31:54.767

我`lambda`用来创建包含参数的回调。在一行中编写 lambda 比编写执行相同功能的方法更简洁。

例如：

```
import imported.module

def func():
    return lambda: imported.module.method("foo", "bar") 
```

相对于：

```
import imported.module

def func():
    def cb():
        return imported.module.method("foo", "bar")
    return cb 
```

* * *

## 回答 #26

> 赞同：2
> 
> 时间：2009-05-20T20:52:40.960

Lambda 是一个过程构造函数。您可以在运行时合成程序，尽管 Python 的 lambda 不是很强大。请注意，很少有人了解这种编程。

# sql-server-2005 - SQL Server 日期时间数据类型不允许多种格式

> ID：890139
> 
> 赞同：3
> 
> 时间：2009-05-20T20:43:14.787
> 
> 标签：sql-server-2005, tsql, datetime

我在 SQL Server 2005 中有一个表，它有一个日期时间字段。我想以`mm/dd/yyyy hh:mm:ss`格式保存日期时间值，但我猜 SQL Server 允许`yyyy-mm-dd HH:mm:ss.ll`格式的日期时间。

我可以将日期时间值保存`mm/dd/yyyy hh:mm:ss`为 varchar 格式，但这违背了我在该日期时间字段上对表进行排序的意图。

我的方法有什么遗漏吗？有什么建议么？

干杯

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-20T20:48:51.903

**正如您所声称的， datetime 类型不会*将*其存储在 中。`yyyy-mm-dd HH:mm:ss.ll`**

日期时间列存储为 8 字节*二进制*数据。`yyyy-mm-dd HH:mm:ss.ll`格式就是它在查询中的返回方式。要以其他格式显示，请查看[CONVERT](http://msdn.microsoft.com/en-us/library/ms187928.aspx)函数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-20T20:47:49.597

您可以在选择日期时间时设置它的样式，如下所示：

```
convert(varchar, [datefield], style) 
```

它允许您在获取日期时对其进行格式化。这使得存储时的格式变得微不足道。

这是您可以使用的所有样式的[列表](http://doc.ddart.net/mssql/sql70/ca-co_1.htm)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-20T20:52:07.280

日期实际上并未以特定格式保存；它以默认格式或您选择的格式显示。

你在哪里“看到”日期？您的应用程序可能不会显示与 SQL Server Management Studio 相同的日期。

用户如何格式化日期以便保存它也是您的应用程序的一个问题（只要它将有效日期发送到服务器。）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-20T20:54:04.110

我必须承认我从未试图强制数据库保留任何特定的日期/时间格式。我想这不是真的必要。

所以你有一个日期/时间字段，你可以按它对数据进行排序？这与您对 DBMS 的需求差不多。在应用程序的表示层中执行最终格式化。

# makefile - 您如何使编译器行更短？

> ID：890142
> 
> 赞同：6
> 
> 时间：2009-05-20T20:43:39.200
> 
> 标签：makefile, compilation, scons

通常，当我与其他人一起处理项目时，随着时间的推移，编译器在 Makefile 中获取的库路径和包含路径的数量会越来越多。路径也可以变得很长。

这是一个例子：

```
g++ -c -pipe -O2 -Wall -W -DQT_BOOTSTRAPPED -DQT_MOC -DQT_NO_CODECS
-DQT_LITE_UNICODE -DQT_NO_LIBRARY -DQT_NO_STL -DQT_NO_COMPRESS
-DQT_NO_DATASTREAM -DQT_NO_TEXTSTREAM -DQT_NO_TEXTCODEC -DQT_NO_UNICODETABLES
-DQT_NO_THREAD -DQT_NO_REGEXP -DQT_NO_QOBJECT -DQT_NO_SYSTEMLOCALE
-DQT_NO_GEOM_VARIANT -DQT_NO_USING_NAMESPACE -D_LARGEFILE64_SOURCE
-D_LARGEFILE_SOURCE -I../../../mkspecs/qws/linux-generic-g++ -I.
-I../../corelib/arch/generic -I../../../include -I. -I../../../include/QtCore
-I. -I.uic/release-shared -o release-shared/moc.o moc.cpp 
```

我想知道您使用什么样的配方来使编译器行更短，同时如果用户以后真的需要该信息，仍然可以选择显示原始行。

是否有自动执行此操作的工具？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-17T20:57:08.863

您不仅可以使编译器输出更短，还可以对其进行颜色编码，并添加详细标志。输出将如下所示：

[替代文字 http://img526.imageshack.us/img526/9572/sconsf.png](http://img526.imageshack.us/img526/9572/sconsf.png)

方法如下（从 SCons Wiki 窃取的颜色主题）：

```
import os,sys
colors = {}
colors['cyan']   = '\033[96m'
colors['purple'] = '\033[95m'
colors['blue']   = '\033[94m'
colors['green']  = '\033[92m'
colors['yellow'] = '\033[93m'
colors['red']    = '\033[91m'
colors['end']    = '\033[0m'

#If the output is not a terminal, remove the colors
if not sys.stdout.isatty():
   for key, value in colors.iteritems():
      colors[key] = ''

compile_source_message = '%s\nCompiling %s==> %s$SOURCE%s' % \
   (colors['blue'], colors['purple'], colors['yellow'], colors['end'])

compile_shared_source_message = '%s\nCompiling shared %s==> %s$SOURCE%s' % \
   (colors['blue'], colors['purple'], colors['yellow'], colors['end'])

link_program_message = '%s\nLinking Program %s==> %s$TARGET%s' % \
   (colors['red'], colors['purple'], colors['yellow'], colors['end'])

link_library_message = '%s\nLinking Static Library %s==> %s$TARGET%s' % \
   (colors['red'], colors['purple'], colors['yellow'], colors['end'])

ranlib_library_message = '%s\nRanlib Library %s==> %s$TARGET%s' % \
   (colors['red'], colors['purple'], colors['yellow'], colors['end'])

link_shared_library_message = '%s\nLinking Shared Library %s==> %s$TARGET%s' % \
   (colors['red'], colors['purple'], colors['yellow'], colors['end'])

java_compile_source_message = '%s\nCompiling %s==> %s$SOURCE%s' % \
   (colors['blue'], colors['purple'], colors['yellow'], colors['end'])

java_library_message = '%s\nCreating Java Archive %s==> %s$TARGET%s' % \
   (colors['red'], colors['purple'], colors['yellow'], colors['end'])

env = Environment()
AddOption("--verbose",action="store_true", dest="verbose_flag",default=False,help="verbose output")
if not GetOption("verbose_flag"):
  env["CXXCOMSTR"] = compile_source_message,
  env["CCCOMSTR"] = compile_source_message,
  env["SHCCCOMSTR"] = compile_shared_source_message,
  env["SHCXXCOMSTR"] = compile_shared_source_message,
  env["ARCOMSTR"] = link_library_message,
  env["RANLIBCOMSTR"] = ranlib_library_message,
  env["SHLINKCOMSTR"] = link_shared_library_message,
  env["LINKCOMSTR"] = link_program_message,
  env["JARCOMSTR"] = java_library_message,
  env["JAVACCOMSTR"] = java_compile_source_message, 
```

使用“scons --verbose”编译以查看正常的大容量 gcc 输出。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-21T13:47:01.983

如果主要是在“make”期间喷出大行导致烦恼，您还可以将 Makefile 更改为不回显编译器行，而是改为：

```
 .cpp.o:
          @echo $(CC) $<
          @$(CC) $(FLAGS) -c -o $@ $< 
```

'@' 抑制命令行的回显

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-20T20:50:29.967

如何使用环境变量？

```
export LONGPATH=/usr/local/projects/include/foo/system/v1
gcc foo.c -o foo -I$LONGPATH 
```

对于更复杂的场景，可以使用包装器来调用编译器，以便实际的命令及其参数只显示在错误或警告上。以使用 cmake 为例，许多传统输出已经被大量缩减。

同样，也可以将[spec 文件与 gcc](http://gcc.gnu.org/onlinedocs/gcc/Spec-Files.html)一起使用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-20T21:59:44.273

在 scons 中，我在命令生成器中插入换行符以使长命令更具可读性：

例如

```
tool \
    -opt1 bar1 \
    -opt2 bar2 \
    -opt3 bar3 \
    -opt4 bar4 
```

然后我在构造命令字符串时创建一个本地方法以减少混乱。

```
cmds = []
def l(line,indent=1):
    cmds.append(indent*'    '+line)
l('tool',0)
l('-opt1 bar1')
l('-opt2 bar2')
l('-opt3 bar3')
l('-opt4 bar4')

return '\\\n'.join(cmds) 
```

# wix - 如何在 WiX 中检查已注册的 DLL

> ID：890145
> 
> 赞同：2
> 
> 时间：2009-05-20T20:44:27.717
> 
> 标签：wix

我正在寻找一种方法来测试是否已安装具有某些版本的某些第三方库。我想检查已注册的 dll，但不知道它们在文件系统中的安装位置。在这个例子中，我确保他们安装了 1.50 之前的版本：

```
<Property Id="PRIORGUID">
  <RegistrySearch Id="priorguid" Root="HKCR" Key="Prior.Encoders\CLSID" Type="raw"/>
</Property>

<Property Id="PRIORLOCATION">
  <RegistrySearch Id="priorlocation" Root="HKCR" Key="CLSID\[PRIORGUID]\InprocServer32" Type="file"/>
</Property>

<Property Id="PRIORVERCHECK">
  <DirectorySearch Id="priorversion" Path="[PRIORLOCATION]">
    <FileSearch Name="Prior.dll" MinVersion="1.49"/>
  </DirectorySearch>
</Property>

<Condition Message="This application requires Prior.">
  <![CDATA[Installed OR PRIORVERCHECK]]>
</Condition> 
```

我基本上在注册表中找到指向该文件的库，然后在文件系统中查找版本。我对这种方法感到不安。当我使用 Type="file" 时，它似乎返回文件所在的目录，而不是返回文件本身的完整路径。它总是这样工作吗？这也意味着我必须知道基本文件名。如果有办法将完整路径拆分为名称和目录，那么我可以在不知道基本名称的情况下进行 FileSearch 吗？

我的方法可靠吗？有一个更好的方法吗？看起来这将是一个普遍的问题。我正在使用 WiX 3。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-04T15:08:56.050

*您可以通过在 for PRIORLOCATION*中简单地嵌套 a 来保存行（请参阅[WiX 文档](http://wix.sourceforge.net/manual-wix2/wix_xsd_registrysearch.htm)）。类似于以下内容：

```
<RegistrySearch Id="_test" Root="HKLM" Key="Software\MyCompany\MyProgram" name="Executable"Type="file">
  <FileSearch Id="_oldexe2" Name="PROGRAM2.EXE" MinSize="200000" MaxSize="4000000" />
</RegistrySearch> 
```

# java - Java 对象到 int：更好的方法？

> ID：890162
> 
> 赞同：6
> 
> 时间：2009-05-20T20:47:52.530
> 
> 标签：java, generics

我有一个 TreeSet，它将充满整数。长话短说，我试图在存储在列表中的最后一个（最大）值之后开始循环。我现在正在做的是获取起始变量是：

```
 Object lastObj = primes.last();
    Integer last = new Integer(lastObj.toString());
    int start = 1 + last.intValue(); // the added 1 is just for program logic 
```

我确信必须有更好的方法将一个对象（我知道它永远是一个 int）转换为 int 'start'。有人知道这样做的更好方法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-20T20:50:30.857

在 J2SE 5 或更高版本中，它通过“自动装箱”功能自动发生。

```
int start = 1 + last; 
```

[http://docs.oracle.com/javase/1.5.0/docs/guide/language/autoboxing.html](http://docs.oracle.com/javase/1.5.0/docs/guide/language/autoboxing.html)

此外，如果您知道它们都将是 Integer 对象，请使用参数化类型：

```
List<Integer> obj = new ArrayList<Integer>()... 
```

然后将其与自动装箱功能结合使用：

```
int start = 1 + obj.last(); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-20T20:53:39.553

您使用的是 Java 1.6 版吗？在这种情况下，您可以利用自动装箱和泛型来清理代码。

首先，可以将 TreeSet 声明为仅包含 Integer 对象

```
TreeSet<Integer> primes; 
```

现在要从集合中获取对象，您可以

```
Integer last = primes.last(); 
```

并使用您获得的自动装箱功能

```
int start = 1 + last; 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-20T20:50:46.753

如果您知道它们在放入时是“int”，那么它们在 Collection 中被转换为 Integer（Collections 不能包含基元，只能包含对象），因此，您可以简单地`Integer last = (Integer)lastObj;`.

不过，理想情况下，您会使用 a`TreeSet<Integer>`然后它首先会为您提供整数。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-20T20:54:16.027

如果你知道`primes`它只保存整数，你应该把`primes`它做成一个`TreeSet<Integer>`.

然后它会变成：

```
int start = 1 + primes.last().intValue(); 
```

如果你不能使用泛型使用这个：

```
int start = 1 + ((Integer)prime.last()).intValue(); 
```

铸造成一个字符串只是愚蠢的。

顺便说一句，我不建议使用自动装箱。它在你背后做各种各样的事情。明确使用`Integer`对我来说似乎更清楚。但这只是我个人的喜好，如果你愿意，你可以使用自动装箱。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-20T20:51:52.490

在 Java 1.4 之后，您可以使用[autoboxing](http://java.sun.com/j2se/1.5.0/docs/guide/language/autoboxing.html)。

于是就变成了，

```
int start = 1 + (Integer) primes.last(); // the added 1 is just for program logic 
```

如果您在 TreeSet ( `TreeSet<Integer>`) 中使用泛型，则可以将初始转换为 Integer。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-20T20:52:45.687

为什么你不能直接转换它，而不是转换成一个字符串，然后解析那个字符串并创建一个新的引用？

```
Object lastObj = primes.last();
int start = 1 + ( ( Integer )lastObj ).intValue(); 
```

# c++ - 如何通过分隔符将字符串拆分为数组？

> ID：890164
> 
> 赞同：14
> 
> 时间：2009-05-20T20:48:22.247
> 
> 标签：c++, function, string

我是编程新手。我一直在尝试用 C++ 编写一个函数，将字符串的内容分解为给定参数的字符串数组，例如：

```
string str = "___this_ is__ th_e str__ing we__ will use__"; 
```

应该返回字符串数组：

```
cout << stringArray[0]; // 'this'
cout << stringArray[1]; // ' is'
cout << stringArray[2]; // ' th'
cout << stringArray[3]; // 'e str'
cout << stringArray[4]; // 'ing we'
cout << stringArray[5]; // ' will use' 
```

我可以很好地标记字符串，但对我来说最困难的部分是如何在为其分配当前字符串令牌之前指定 stringArray 中的元素数量，以及如何从函数返回 stringArray。

有人会告诉我如何编写函数吗？

**Edit1：** 我不一定需要将结果放在字符串数组中，只要我可以将其作为具有某种索引的常规变量调用的任何容器即可。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-20T21:00:33.910

这是我第一次尝试使用向量和字符串：

```
vector<string> explode(const string& str, const char& ch) {
    string next;
    vector<string> result;

    // For each character in the string
    for (string::const_iterator it = str.begin(); it != str.end(); it++) {
        // If we've hit the terminal character
        if (*it == ch) {
            // If we have some characters accumulated
            if (!next.empty()) {
                // Add them to the result vector
                result.push_back(next);
                next.clear();
            }
        } else {
            // Accumulate the next character into the sequence
            next += *it;
        }
    }
    if (!next.empty())
         result.push_back(next);
    return result;
} 
```

希望这能给你一些关于如何去做的想法。在您的示例字符串中，它使用以下测试代码返回正确的结果：

```
int main (int, char const **) {
    std::string blah = "___this_ is__ th_e str__ing we__ will use__";
    std::vector<std::string> result = explode(blah, '_');

    for (size_t i = 0; i < result.size(); i++) {
        cout << "\"" << result[i] << "\"" << endl;
    }
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-20T22:09:06.970

使用 STL（抱歉没有编译器未测试）

```
#include <vector>
#include <string>
#include <sstream>

int main()
{
    std::vector<std::string>   result;

    std::string str = "___this_ is__ th_e str__ing we__ will use__";

    std::stringstream  data(str);

    std::string line;
    while(std::getline(data,line,'_'))
    {
        result.push_back(line); // Note: You may get a couple of blank lines
                                // When multiple underscores are beside each other.
    }
} 
```

// 或者定义一个令牌

```
#include <vector>
#include <string>
#include <iterator>
#include <algorithm>
#include <sstream>

struct Token: public std::string  // Yes I know this is nasty.
{                                 // But it is just to demosntrate the principle.    
};

std::istream& operator>>(std::istream& s,Token& t)
{
    std::getline(s,t,'_');

    // *** 
    // Remove extra '_' characters from the stream.
    char c;
    while(s && ((c = s.get()) != '_')) {/*Do Nothing*/}
    if (s)
    {
        s.unget(); // Put back the last char as it is not '_'
    }
    return s;
}

int main()
{   

    std::string str = "___this_ is__ th_e str__ing we__ will use__";

    std::stringstream  data(str);

    std::vector<std::string>   result(std::istream_iterator<Token>(data),
                                      std::istream_iterator<Token>());
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-26T00:50:44.053

这个对我有用 ：

```
#include <iostream>
#include <vector>
#include <string>

using namespace std;

vector<string> explode( const string &delimiter, const string &explodeme);

int main(int argc, char *argv[])
{
    string str = "I have a lovely bunch of cocoa nuts";
    cout<<str<<endl;
    vector<string> v = explode(" ", str);
    for(int i=0; i<v.size(); i++)
        cout <<i << " ["<< v[i] <<"] " <<endl;
}

vector<string> explode( const string &delimiter, const string &str)
{
    vector<string> arr;

    int strleng = str.length();
    int delleng = delimiter.length();
    if (delleng==0)
        return arr;//no change

    int i=0;
    int k=0;
    while( i<strleng )
    {
        int j=0;
        while (i+j<strleng && j<delleng && str[i+j]==delimiter[j])
            j++;
        if (j==delleng)//found delimiter
        {
            arr.push_back(  str.substr(k, i-k) );
            i+=delleng;
            k=i;
        }
        else
        {
            i++;
        }
    }
    arr.push_back(  str.substr(k, i-k) );
    return arr;
} 
```

**来源：** [http ://www.zedwood.com/article/106/cpp-explode-function](http://www.zedwood.com/article/106/cpp-explode-function)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-20T20:51:52.833

如果您坚持创建`stringArray`一个与 a 相对的数组`std::vector<>`（这是正确的做法），您必须：

1.  做两次传球（一个数，你看）
2.  自己实现一个动态数组。

使用向量更容易`vector::push_back()`将新内容附加到末尾。所以：

```
vector* explode(string s){
  vector<string> *v = new vector<string>
  //...
  // in a loop
    v->push_back(string_fragment);
  //...
  return v;
} 
```

* * *

**毕竟不需要**为了完整性。

要返回您使用的字符串数组`char **`。

如在

```
char ** explode(const char *in){
  ...

} 
```

顺便说一句——调用函数如何知道返回数组中有多少元素？你也必须解决这个问题。`std::vector<>`除非您受到外力的限制，否则请使用...

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-20T20:52:05.720

您可以使用 string 的向量`(std::vector<std::string>`），使用 push_back 将每个标记附加到它，然后从您的 tokenize 函数中返回它。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-20T20:52:13.677

使用 std::vector 作为动态数组并将其作为结果返回。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-20T20:53:54.327

也许您应该使用列表而不是数组。这样你就不需要提前知道元素的数量。您也可以考虑使用 STL 容器。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-20T22:11:44.140

等到你的数据结构类，然后用链表编码。但是，如果它是为了家庭作业，您可能只需初始化非常大的数组即​​可。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-08-13T02:52:53.053

**下面的代码：**

```
template <typename OutputIterator>
int explode(const string &s, const char c, OutputIterator output) {
    stringstream  data(s);
    string line;
    int i=0;
    while(std::getline(data,line,c)) { *output++ = line; i++; }
    return i;
}

int main(...) {
  string test="H:AMBV4:2:182.45:182.45:182.45:182.45:182.41:32:17700:3229365:201008121711:0";
  cout << test << endl; 
  vector<string> event;
**This is the main call**
  int evts = explode(test,':', back_inserter(event));
  for (int k=0; k<evts; k++) 
    cout << event[k] << "~";
  cout << endl;
} 
```

**输出**

```
H:AMBV4:2:182.45:182.45:182.45:182.45:182.41:32:17700:3229365:201008121711:0
H~AMBV4~2~182.45~182.45~182.45~182.45~182.41~32~17700~3229365~201008121711~0~ 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-11-21T10:17:14.017

这是我编写的代码（完整）。可能对一些有相同需求的人有用。

```
#include <string>
#include <iostream>
#include <sstream>
#include <vector>
using namespace std;

int main(){
        std::string s = "scott:tiger:mushroom";
        std::string delimiter = ":";

        std::vector<std::string> outputArr;
        size_t pos = 0;
        std::string token;
        while ((pos = s.find(delimiter)) != std::string::npos) {
            token = s.substr(0, pos);
            s.erase(0, pos + delimiter.length());
            outputArr.push_back(token);
        }
        outputArr.push_back(s);

        // Printing Array to see the results
        std::cout<<"====================================================================================\n";
        for ( int i=0;i<outputArr.size();i++){
                std::cout<<outputArr[i]<<"\n";
        }
        std::cout<<"====================================================================================\n";
} 
```

干杯！！

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-10-02T19:01:38.583

我认为我已经写了一个更简单的解决方案。

```
std::vector<std::string> explode(const std::string& string, const char delimiter) {

std::vector<std::string> result;
unsigned int start = 0, pos = 0;

while (pos != string.length()) {
    if (string.at(pos) == delimiter || pos + 1 == string.length()) {
        unsigned int size = (pos - start) + ((pos + 1) == string.length() ? 1 : 0);
        if (size != 0) { // Make this 'if' as a option? like a parameter with removeEmptyString?
            result.push_back(string.substr(start, size));
        }
        start = pos + 1;
    }
    pos++;
}

return std::move(result); 
```

}

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2017-04-27T08:15:16.463

这对我有用：

```
#include <iostream>
#include <vector>
#include <string>
#include <sstream>  

using namespace std;

vector<string> split(string str, char delimiter) {
  vector<string> internal;
  stringstream ss(str); // Turn the string into a stream.
  string tok;

  while(getline(ss, tok, delimiter)) {
    internal.push_back(tok);
  }

  return internal;
}

int main(int argc, char **argv) {
  string myCSV = "one,two,three,four";
  vector<string> sep = split(myCSV, ',');

  // If using C++11 (which I recommend)
  /* for(string t : sep)
   *  cout << t << endl;
   */

  for(int i = 0; i < sep.size(); ++i)
    cout << sep[i] << endl;
} 
```

来源：[http ://code.runnable.com/VHb0hWMZp-ws1gAr/splitting-a-string-into-a-vector-for-c%2B%2B](http://code.runnable.com/VHb0hWMZp-ws1gAr/splitting-a-string-into-a-vector-for-c%2B%2B)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-01-14T12:01:05.930

```
# turn a string into a deque based on a delimiter string
bool tolist(deque<string>& list,string basis,const string& cutter) {
    bool found = false;
    if (!cutter.empty()) {
        while (!basis.empty() ) {
            string::size_type pos = basis.find(cutter);
            if (pos != string::npos) {
                found = true;
                list.push_back(basis.substr(0, pos)); //pos says 2
                basis = basis.substr(pos+cutter.size(),string::npos);
            } else {
                list.push_back(basis);
                basis.clear();
            }
        }
    }
    return found;
} 
```

# .net - 在 .NET 中动态加载不同的程序集版本

> ID：890166
> 
> 赞同：2
> 
> 时间：2009-05-20T20:48:56.617
> 
> 标签：.net, dynamic, assemblies

使用 System.Assembly.Load 还是使用 System.AppDomain.CurrentDomain.CreateInstanceFromAndUnwrap 将程序集直接加载到 AppDomain 更好？我对调用在同一进程中运行的同一程序集的不同版本特别感兴趣。我认为使用 CreateInstanceFromAndUnwrap 您的程序集必须具有 [serializable] 属性，但这是为什么呢？

编辑：我试图加载的程序集与调用者不在同一个位置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-20T20:58:13.850

不是同一个位置，我猜你是指文件系统上的其他地方，如果不是，请告诉我。

最好使用 System.Assembly.Load，因为它是通用的低级程序集加载器。

此外，您提到想要加载不同的版本。为此，您必须设置辅助 AppDomain 以将程序集加载到其中，然后在完成后卸载该 AppDomain 并为新的程序集版本创建一个新的，因为 .Net 不支持从给定的程序集卸载应用程序域。

CreateInstanceFromAndUnwrap 用于加载以某种方式“发送”给您的代码，因此它所处理的东西必须是可序列化的。

# python - 如何检测我的窗口何时被 wxPython 最小化？

> ID：890170
> 
> 赞同：6
> 
> 时间：2009-05-20T20:49:43.290
> 
> 标签：python, wxpython, minimize

我正在编写一个小的 wxPython 实用程序。

我想使用一些事件来检测用户何时最小化应用程序/窗口。

我环顾四周，但没有找到像 wx.EVT_MINIMIZE 这样我可以绑定的事件。

任何人都知道可以用来检测这个的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-20T20:58:11.900

[为wx.EVT_ICONIZE](http://www.wxpython.org/docs/api/wx.IconizeEvent-class.html)事件添加一个处理程序。

# python - 将数字列表划分为2个相等总和列表的算法

> ID：890171
> 
> 赞同：23
> 
> 时间：2009-05-20T20:49:50.717
> 
> 标签：python, algorithm, dynamic-programming, np-complete, knapsack-problem

> 有一个数字列表。
> 该列表将被分成 2 个大小相等的列表，总和的差异最小。必须打印总和。
> 
> ```
> #Example:
> >>>que = [2,3,10,5,8,9,7,3,5,2]
> >>>make_teams(que)
> 27 27 
> ```

在某些情况下，以下代码算法是否有错误？

我如何优化和/或 pythonize 这个？

```
def make_teams(que):
    que.sort()
    if len(que)%2: que.insert(0,0)
    t1,t2 = [],[]
    while que:
        val = (que.pop(), que.pop())
        if sum(t1)>sum(t2):
            t2.append(val[0])
            t1.append(val[1])
        else:
            t1.append(val[0])
            t2.append(val[1])
    print min(sum(t1),sum(t2)), max(sum(t1),sum(t2)), "\n" 
```

问题来自[http://www.codechef.com/problems/TEAMSEL/](http://www.codechef.com/problems/TEAMSEL/)

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-05-20T21:03:29.237

[动态编程](http://en.wikipedia.org/wiki/Dynamic_programming)是您正在寻找的解决方案。

[4, 3, 10, 3, 2, 5] 的示例：

```
X 轴：组的可达总和。max = sum（所有数字）/ 2（四舍五入）
Y 轴：对组中的元素进行计数。最大值 = 计数 / 2（四舍五入）

      1 2 3 4 5 6 7 8 9 10 11 12 13 14
 1 | | | | 4| | | | | | | | | | | // 4
 2 | | | | | | | | | | | | | | |
 3 | | | | | | | | | | | | | | |

```

```
      1 2 3 4 5 6 7 8 9 10 11 12 13 14
 1 | | | 3| 4| | | | | | | | | | | // 3
 2 | | | | | | | 3| | | | | | | |
 3 | | | | | | | | | | | | | | |

```

```
      1 2 3 4 5 6 7 8 9 10 11 12 13 14
 1 | | | 3| 4| | | | | |10| | | | | // 10
 2 | | | | | | | 3| | | | | |10|10|
 3 | | | | | | | | | | | | | | |

```

```
      1 2 3 4 5 6 7 8 9 10 11 12 13 14
 1 | | | 3| 4| | | | | |10| | | | | // 3
 2 | | | | | | 3| 3| | | | | |10|10|
 3 | | | | | | | | | | 3| | | | |

```

```
      1 2 3 4 5 6 7 8 9 10 11 12 13 14
 1 | | 2| 3| 4| | | | | |10| | | | | // 2
 2 | | | | | 2| 3| 3| | | | | 2|10|10|
 3 | | | | | | | | 2| 2| 3| | | | |

```

```
      1 2 3 4 5 6 7 8 9 10 11 12 13 14
 1 | | 2| 3| 4| 5| | | | |10| | | | | // 5
 2 | | | | | 2| 3| 3| 5| 5| | | 2|10|10|
 3 | | | | | | | | 2| 2| 3| 5| 5| | |
                                       ^

```

12是我们的幸运数字！回溯获取组：

```
12 - 5 = 7 {5}
 7 - 3 = 4 {5, 3}
 4 - 4 = 0 {5, 3, 4}

```

然后可以计算另一组：{4,3,10,3,2,5} - {5,3,4} = {10,3,2}

所有带数字的字段都是一个袋子的可能解决方案。选择右下角最远的那个。

顺便说一句：这叫做[背包问题](http://en.wikipedia.org/wiki/Knapsack_problem)。

> 如果所有权重（w1，...，wn 和 W）都是非负整数，则可以使用动态规划在伪多项式时间内解决背包问题。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-20T22:07:21.013

**新解决方案**

这是具有启发式剔除的广度优先搜索。这棵树仅限于玩家/2 的深度。玩家总分限制为总分/2。玩家池为 100 人，大约需要 10 秒才能解决。

```
def team(t):
    iterations = range(2, len(t)/2+1)

    totalscore = sum(t)
    halftotalscore = totalscore/2.0

    oldmoves = {}

    for p in t:
        people_left = t[:]
        people_left.remove(p)
        oldmoves[p] = people_left

    if iterations == []:
        solution = min(map(lambda i: (abs(float(i)-halftotalscore), i), oldmoves.keys()))
        return (solution[1], sum(oldmoves[solution[1]]), oldmoves[solution[1]])

    for n in iterations:
        newmoves = {}
        for total, roster in oldmoves.iteritems():
            for p in roster:
                people_left = roster[:]
                people_left.remove(p)
                newtotal = total+p
                if newtotal > halftotalscore: continue
                newmoves[newtotal] = people_left
        oldmoves = newmoves

    solution = min(map(lambda i: (abs(float(i)-halftotalscore), i), oldmoves.keys()))
    return (solution[1], sum(oldmoves[solution[1]]), oldmoves[solution[1]])

print team([90,200,100])
print team([2,3,10,5,8,9,7,3,5,2])
print team([1,1,1,1,1,1,1,1,1,9])
print team([87,100,28,67,68,41,67,1])
print team([1, 1, 50, 50, 50, 1000])

#output
#(200, 190, [90, 100])
#(27, 27, [3, 9, 7, 3, 5])
#(5, 13, [1, 1, 1, 1, 9])
#(229, 230, [28, 67, 68, 67])
#(150, 1002, [1, 1, 1000]) 
```

另请注意，我试图使用 GS 的描述来解决这个问题，但仅仅通过存储运行总计是不可能获得足够的信息的。如果您同时存储**了**项目数和总数，那么它将与此解决方案相同，只是您保留了不必要的数据。因为您只需要将 n-1 和 n 次迭代保持在 numplayers/2。

我有一个基于二项式系数的旧的详尽的（回顾历史）。它很好地解决了长度为 10 的示例问题，但后来我看到比赛中有长度为 100 的人。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-24T00:59:36.993

问：给定一个**整数的多重集 S**，有没有办法将 S 划分为**两个子集**S1 和 S2，使得S1 中的数字**之**和等于 S2 中的数字之和？

A.[设置分区问题](http://en.wikipedia.org/wiki/Partition_problem)。

祝你好运。:)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-20T21:02:32.110

好吧，您可以在多项式时间内找到百分比精度的解决方案，但要实际找到最佳（绝对最小差异）解决方案，问题是 NP 完全的。这意味着该问题没有多项式时间解。结果，即使数字列表相对较少，它的计算量也太大而无法解决。如果您真的需要解决方案，请查看一些用于此的近似算法。

[http://en.wikipedia.org/wiki/Subset_sum_problem](http://en.wikipedia.org/wiki/Subset_sum_problem)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-20T21:24:42.223

请注意，它也是一种启发式方法，我将排序从函数中移出。

```
 def g(data):
   sums = [0, 0]
   for pair in zip(data[::2], data[1::2]):
     item1, item2 = sorted(pair)
     sums = sorted([sums[0] + item2, sums[1] + item1])
   print sums

data = sorted([2,3,10,5,8,9,7,3,5,2])
g(data) 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-20T21:30:07.203

您的方法不起作用的测试用例是

```
que = [1, 1, 50, 50, 50, 1000] 
```

问题是您要成对分析事物，在此示例中，您希望所有 50 人都在同一个组中。如果您删除配对分析方面并且一次只输入一个条目，这应该可以解决。

这是执行此操作的代码

```
def make_teams(que):
    que.sort()
    que.reverse()
    if len(que)%2: que.insert(0,0)
    t1,t2 = [],[]
    while que:
        if abs(len(t1)-len(t2))>=len(que):
            [t1, t2][len(t1)>len(t2)].append(que.pop(0))
        else:
            [t1, t2][sum(t1)>sum(t2)].append(que.pop(0))
    print min(sum(t1),sum(t2)), max(sum(t1),sum(t2)), "\n"

if __name__=="__main__":
    que = [2,3,10,5,8,9,7,3,5,2]
    make_teams(que)
    que = [1, 1, 50, 50, 50, 1000]
    make_teams(que) 
```

这给出了 27、27 和 150、1002，这对我来说是有意义的答案。

**编辑：**在审查中，我发现这实际上不起作用，但最后，我不太确定为什么。不过，我会在这里发布我的测试代码，因为它可能有用。该测试仅生成具有相等总和的随机序列，将它们放在一起并进行比较（结果令人遗憾）。

**编辑#2：**根据 Unknown, 指出的示例`[87,100,28,67,68,41,67,1]`，很清楚为什么我的方法不起作用。具体来说，要解决这个例子，需要将两个最大的数字都添加到同一个序列中以获得有效的解决方案。

```
def make_sequence():
    """return the sums and the sequence that's devided to make this sum"""
    while 1:
        seq_len = randint(5, 200)
        seq_max = [5, 10, 100, 1000, 1000000][randint(0,4)]
        seqs = [[], []]
        for i in range(seq_len):
            for j in (0, 1):
                seqs[j].append(randint(1, seq_max))
        diff = sum(seqs[0])-sum(seqs[1])
        if abs(diff)>=seq_max: 
            continue
        if diff<0:
            seqs[0][-1] += -diff
        else:
            seqs[1][-1] += diff
        return sum(seqs[0]), sum(seqs[1]), seqs[0], seqs[1]

if __name__=="__main__":

    for i in range(10):
        s0, s1, seq0, seq1 = make_sequence()
        t0, t1 = make_teams(seq0+seq1)
        print s0, s1, t0, t1
        if s0 != t0 or s1 != t1:
            print "FAILURE", s0, s1, t0, t1 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-20T21:58:40.920

它实际上是 PARTITION，KNAPSACK 的一个特例。

它是 NP Complete，具有伪多项式 dp 算法。伪多项式中的伪是指运行时间取决于权重范围的事实。

通常，您必须先确定是否存在精确解决方案，然后才能接受启发式解决方案。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-11-15T20:03:26.143

他们显然在寻找动态编程背包解决方案。因此，在我的第一次努力（我认为是一个非常好的原始启发式）和我的第二次努力之后（一个非常狡猾的精确组合解决方案，它适用于短数据集，甚至适用于多达 100 个元素的集合，只要*唯一*值的数量是低），我终于屈服于同侪压力并写了他们想要的（不太难 - 处理重复的条目是最棘手的部分 - 我基于它的底层算法只有在所有输入都是唯一的情况下才有效 - 我很高兴*long long*足以容纳 50 位！）。

因此，对于我在测试前两次努力时汇总的所有测试数据和尴尬的边缘情况，它给出了相同的答案。至少对于我用组合求解器检查的那些，我*知道*它们是正确的。但是我仍然没有提交错误的答案！

我不是要求任何人在这里修复我的代码，但如果有人能找到下面代码生成错误答案的案例，我将非常感激。

谢谢，

格雷厄姆

PS 此代码总是在时间限制内执行，但*远未*优化。我一直保持简单，直到它通过测试，然后我有一些想法可以加快速度，可能提高 10 倍或更多。

```
#include <stdio.h>

#define TRUE (0==0)
#define FALSE (0!=0)

静态int调试=真；

//int simple(const void *a, const void *b) {
// 返回 *(int *)a - *(int *)b;
//}

int main(int argc, char **argv) {
  诠释 p[101]；
  字符 *s，行 [128]；
  长长的掩码，c0[45001]，c1[45001]；
  int 技能，玩家，目标，i，j，测试，总计 = 0；

  调试 = (argc == 2 && argv[1][0] == '-' && argv[1][1] == 'd' && argv[1][2] == '\0');

  s = fgets（行，127，标准输入）；
  测试 = atoi(s);
  而（测试-> 0）{

    对于 (i = 0; i < 45001; i++) {c0[i] = 0LL;}

    s = fgets（行，127，标准输入）；/* 空行 */
    s = fgets（行，127，标准输入）；/* 玩家数量 */
    玩家 = atoi(s);
    for (i = 0; i < 玩家; i++) {s = fgets(line, 127, stdin); p[i] = atoi(s);}

    如果（玩家 == 1）{
      printf("0 %d\n", p[0]);
    } 别的 {

    if (players&1) p[players++] = 0; // 通过添加一个 0 强度的单个玩家来修复奇数玩家
    //qsort(p, player, sizeof(int), simple);

    总计 = 0；for ( i = 0; i < 玩家; i++) 总计 += p[i];
    目标=总计/2；// 好的，如果总数是奇数并且结果向下取整 - n 组，n+1
    mask = 1LL << (((long long)players/2LL)-1LL);

    for (i = 0; i < 玩家; i++) {
      for (j = 0; j <= target; j++) {c1[j] = 0LL;} // memset 会更快
      技能 = p[i];
      //将此播放器添加到所有其他播放器和每个部分子集
      for (j = 0; j <= 目标技能; j++) {
        if (c0[j]) c1[j+skill] = c0[j]<<1; // 最高 = 最高 j+skill 用于后期优化
      }
      c0[技能] |= 1; // 所以我们不会给自己添加技能编号，除非它出现不止一次
      对于 (j = 0; j <= 目标; j++) {c0[j] |= c1[j];}
      if (c0[target]&mask) 中断；// 早日回归完美契合！
    }

    对于 (i = 目标; i > 0; i--) {
      if (debug || (c0[i] & mask)) {
        fprintf(stdout, "%d %d\n", i, total-i);
        如果（调试）{
          if (c0[i] & mask) printf("******** ["); 别的
          printf("[");
          for (j = 0; j <= 玩家; j++) if (c0[i] & (1LL<<(long long)j)) printf(" %d", j+1);
          printf(" ]\n");
        } 否则中断；
      }
    }
    }
    if (测试) printf("\n");
  }
  返回0；
}

```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-20T21:03:19.410

```
class Team(object):
    def __init__(self):
        self.members = []
        self.total = 0

    def add(self, m):
        self.members.append(m)
        self.total += m

    def __cmp__(self, other):
        return cmp(self.total, other.total)

def make_teams(ns):
    ns.sort(reverse = True)
    t1, t2 = Team(), Team()

    for n in ns:
        t = t1 if t1 < t2 else t2
        t.add(n)

    return t1, t2

if __name__ == "__main__":
    import sys
    t1, t2 = make_teams([int(s) for s in sys.argv[1:]])
    print t1.members, sum(t1.members)
    print t2.members, sum(t2.members)

>python two_piles.py 1 50 50 100
[50, 50] 100
[100, 1] 101 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-20T21:07:49.697

为了提高性能，您可以通过将 append() 和 sum() 替换为运行总计来节省计算。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-20T21:18:31.097

您可以使用以下命令稍微收紧循环：

```
def make_teams(que):
    que.sort()
    t1, t2 = []
    while que:
        t1.append(que.pop())
        if sum(t1) > sum(t2):
            t2, t1 = t1, t2
    print min(sum(t1),sum(t2)), max(sum(t1),sum(t2)) 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-20T21:33:06.790

由于列表必须与我相等，因此问题根本不是 NP。

我使用模式 t1<-que(1st, last), t2<-que(2nd, last-1) ... 拆分排序列表

```
def make_teams2(que):
    que.sort()
    if len(que)%2: que.insert(0,0)
    t1 = []
    t2 = []
    while que:
        if len(que) > 2:
            t1.append(que.pop(0))
            t1.append(que.pop())
            t2.append(que.pop(0))
            t2.append(que.pop())
        else:
            t1.append(que.pop(0))
            t2.append(que.pop())
    print sum(t1), sum(t2), "\n" 
```

*编辑*：我想这也是一个错误的方法。结果错误！

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-05-20T22:01:34.597

经过一番思考，对于不太大的问题，我认为最好的启发式方法如下：

```
import random
def f(data, nb_iter=20):
  diff = None
  sums = (None, None)
  for _ in xrange(nb_iter):
    random.shuffle(data)
    mid = len(data)/2
    sum1 = sum(data[:mid])
    sum2 = sum(data[mid:])
    if diff is None or abs(sum1 - sum2) < diff:
      sums = (sum1, sum2)
  print sums 
```

如果问题更大，您可以调整 nb_iter。

它几乎始终解决了上面提到的所有问题。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-11-14T00:17:37.430

在较早的评论中，我假设设置的问题是易于处理的，因为他们在分配的时间内仔细选择了与各种算法兼容的测试数据。事实证明并非如此 - 相反，它是问题限制 - 不高于 450 的数字和不超过 50 个数字的最终集合是关键。这些与使用我在稍后的帖子中提出的动态编程解决方案解决问题兼容。其他算法（启发式算法，或组合模式生成器的详尽枚举）都无法工作，因为会有足够大或足够难的测试用例来破坏这些算法。老实说，这很烦人，因为其他解决方案更具挑战性，当然也更有趣。请注意，无需大量额外工作，

# html - 确保使用 zip 发布表单

> ID：890172
> 
> 赞同：2
> 
> 时间：2009-05-20T20:49:51.217
> 
> 标签：html, forms, post, zip

我有一个表单，它发布了一个非常长的字符串（60k），它是高度可压缩的。我想确保浏览器以 zip 格式对表单数据进行编码，以减少所需的网络带宽，但我不知道该怎么做。有人可以指出我正确的方向。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-20T21:25:00.163

简短的回答是：你不能，至少不能以你的问题所暗示的透明方式。虽然 HTTP 1.1 规范确实允许压缩请求，但很少有（如果有的话）浏览器支持它。它不是你可以在 HTML 标记中打开的东西。

即使浏览器可以做到这一点，服务器也需要配置为接受它。您最终可能会发送压缩请求，但服务器会拒绝它。然后浏览器将再次发出请求，这次没有压缩。

正如其他人指出的那样，您可以自己在 Javascript 中压缩数据，尽管您需要在服务器上的应用程序中对其进行解压缩。不要忘记处理禁用 Javascript 的情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-20T21:07:52.787

您可以这样做，尽管大多数人只压缩响应。您应该阅读 GZip Deflate 和内容编码。

这里有一些资源可以帮助您入门：

*   [http://www.websiteoptimization.com/speed/tweak/compress/](http://www.websiteoptimization.com/speed/tweak/compress/)
*   [http://en.wikipedia.org/wiki/Gzip](http://en.wikipedia.org/wiki/Gzip)

[这篇文章](https://stackoverflow.com/questions/424917/why-cant-browser-send-gzip-request)也可能会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-20T21:12:58.173

您可以使用[Javascript 压缩功能](http://rumkin.com/tools/compression/compress_huff.php)。

# javascript - 你能在IE8中用JS改变z-index吗

> ID：890191
> 
> 赞同：1
> 
> 时间：2009-05-20T20:52:21.507
> 
> 标签：javascript, jquery, internet-explorer, z-index

非常简单的例子：http: [//jsbin.com/ohude](http://jsbin.com/ohude)

单击 button1，“hello2”文本 p 应将 z-index 更改为 89。单击 button2，z-index 应再次更改。这在萤火虫中很明显。但它在 IE8 中不做插孔。

有人可以确认吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T15:37:18.890

我没有 IE8，也不知道 jQuery 代码。

您是要更改查看的文本，还是仅更改 z-index？如果 z-index 和查看的文本，在 Safari 中是不行的。

对于我的测试，我将您原来的 jQuery 样式函数更改为：

1.  警惕您的原始更改（注意 style.zIndex，而不是 z-index）；和
2.  然后更改文本 nodeValue 以反映 z-index 更改。

首先，我将您的 css 更改为 css('zIndex','89') 以查看是否会改变结果。无论是 css('zIndex'...) 还是 css('z-index'...)，*都*对我有用。

正如我所说，我不知道 jQuery。但是在 IE8 中测试了以下代码片段后，如果它不起作用，请尝试将 css arg 更改为“zIndex”，只是为了笑。

测试：

```
$('#click').click(function () {
        $('#hello').css('z-index','89');
        var pid = document.getElementById('hello');
        alert('pid.style.zIndex: ' + pid.style.zIndex);
        pid.firstChild.nodeValue = "Hello2 " + pid.style.zIndex;
    }); 

  $('#click2').click(function () {
        $('#hello').css('z-index','10');
        var pid = document.getElementById('hello');
        alert('pid.style.zIndex: ' + pid.style.zIndex);
        pid.firstChild.nodeValue = "Hello2 " + pid.style.zIndex;
    }); 

}); 
```

很抱歉弄乱了您的 JQuery 代码。:D

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-20T21:19:20.937

您尝试在测试页面中设置 z-index 的元素没有设置 CSS“位置”，因此更改 z-index 实际上不会起作用。

添加位置：相对；或位置：绝对；CSS 属性应该允许您设置它们的 z 索引。

# msbuild - 构建成功，但找不到二进制文件。为什么？

> ID：890206
> 
> 赞同：2
> 
> 时间：2009-05-20T20:54:19.023
> 
> 标签：msbuild, project, tfsbuild, solution

最近我改变了我们的团队建设项目文件：

```
<SolutionToBuild Include="$(SolutionRoot)/OurSolution.sln"> 
```

到

```
<SolutionToBuild Include="$(SolutionRoot)/**/*.csproj"> 
```

这是必要的，因为我们有许多项目未包含在解决方案文件中，并且出于我们的目的，仅添加项目是不可行的。我们希望能够一口气构建它们。所以我们找到了一种递归构建所有项目的方法。

这可以正常工作，并且可以毫无错误地完成构建。唯一的问题是没有二进制文件复制到放置文件夹！事实上，我们在任何地方都找不到它们！从解决方案构建，二进制文件被复制到构建代理上的 Binaries 文件夹。但是从单个项目构建时什么都没有。

所以我的问题是，他们在哪里？为什么团队建设报告说一切都很好，但是没有什么可以复制的。它们甚至不在项目目录下的普通 bin/Release 文件夹中。

有人可以帮我理解吗？我觉得这可能与项目文件中不存在的解决方案文件中包含的信息有关，但我无法弄清楚。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-22T05:01:59.360

我认为**SolutionToBuild**项是空的，并且没有构建任何内容。您可以通过以下方式验证

```
<Message Text="SolutionToBuild: $(SolutionToBuild)" Importance="high"/> 
```

然后查看您的日志以查找该语句。

在任何情况下，您都可能想修改您的方法。最好自己创建一个 MSBuild 文件，即 BuildAll.proj。在该文件中，只需使用[MSBuild 任务](http://msdn.microsoft.com/en-us/library/7z253716.aspx)来构建所有项目。然后将该文件设置为 SolutionToBuild。这将在项目构建时为您提供更多灵活性。您可以在构建这些项目或所有项目之前/之后添加步骤。

赛义德·易卜拉欣·哈希米

我的书：[Microsoft Build Engine 内部：使用 MSBuild 和 Team Foundation Build](https://rads.stackoverflow.com/amzn/click/com/0735626286)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-20T23:24:49.360

您是否查看过 TFSBuild 日志。如果您有 TFS 2008，那么日志会包含许多 TFS 2005 所没有的详细信息。

另一个想法是启动 FileMon 并监视由 TFSBuild 服务创建的文件。

# popup - 如何弹出一个最小化的 wxPython 窗口

> ID：890207
> 
> 赞同：4
> 
> 时间：2009-05-20T20:54:50.050
> 
> 标签：popup, wxpython

我有一个实用程序，我希望它不时弹出到屏幕前面以请求用户输入。

（我知道这是非常烦人的一般行为，但在这种情况下我有充分的理由。）

我发现 RequestUserAttention 方法可用于更愉快地请求用户输入，但在我的情况下，我只想让它弹出一个窗口。

甚至可能是所有其他窗口之上的模态。

如果这有什么不同的话，这里的平台是 XP。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-20T21:52:37.500

你真的应该再想想你的理由，但无论如何：

```
frame.Show()
frame.Raise() 
frame.Iconize(False) 
```

应该提高框架。

# c# - 有没有好的 VB/C# x86 反汇编库？

> ID：890213
> 
> 赞同：5
> 
> 时间：2009-05-20T20:56:38.737
> 
> 标签：c#, vb.net, x86, disassembly

我正在寻找一个库，它将 x86 代码反汇编成某种对象模型，然后我可以使用它来编写分析代码的例程。我对将 x86 代码转换为文本反汇编的库不感兴趣——我发现其中不止一些，但它们并不是那么有用，因为我想在我反汇编的代码之上做一些工作. 哦，我希望它是 .Net 代码（最好是 VB 或 C#）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-20T21:13:27.830

据我所知，Reflector 不支持 x86。

最好的办法是使用[OllyDbg](http://www.ollydbg.de/) 或[IDA Pro](http://www.hex-rays.com/idapro/)的脚本或 COM 接口。

如果你负担得起，我会推荐 IDA Pro。IDA 有非常丰富的 API、积极的开发和大量的文档。您可以在自主模式下运行它，我相信使用“-AS”开关。有关命令行参数的更多信息，请参见[http://www.hex-rays.com/idapro/idadoc/417.htm](http://www.hex-rays.com/idapro/idadoc/417.htm)。

我也遇到了[libdasm](http://bastard.sourceforge.net/libdisasm.html)，但从未使用过它，所以不确定它有多好。libdasm 看起来像 C/C++，所以用 C# 编写 API 包装器应该很简单。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-07-11T23:38:50.070

一个老问题，但是如果其他人出现并且您追求的是 100% C# .NET 实现而不是使用互操作，[SharpDisasm](https://sharpdisasm.codeplex.com)为 Intel 和 AT&T 语法提供了 x86/x86-64 反汇编程序。它将每条指令解码为一个对象，该对象提供对有关指令的低级信息（例如指令大小、操作数和类型等）的访问。

SharpDisasm 是[libudis86](https://github.com/vmt/udis86) C 库反汇编程序的完整 C# 端口。

反汇编程序通过`SharpDisam.Disassembler`类公开。

提供的示例控制台应用程序的输出：

```
C:\>echo a1 c9 fd ff ff a1 37 02 00 00 b8 37 02 00 00 b4 09 8a 
25 09 00 00 00 8b 04 6d 85 ff ff ff 89 45 f0| disasmcli 32

00000000 a1 c9 fd ff ff                 mov eax, [0xfffffdc9]
00000005 a1 37 02 00 00                 mov eax, [0x237]
0000000a b8 37 02 00 00                 mov eax, 0x237
0000000f b4 09                          mov ah, 0x9
00000011 8a 25 09 00 00 00              mov ah, [0x9]
00000017 8b 04 6d 85 ff ff ff           mov eax, [ebp*2-0x7b]
0000001e 89 45 f0                       mov [ebp-0x10], eax

C:\>echo 488b05f7ffffff67668b40f06766035e1048030425ffff
000067660344bef04c0384980000008048a10000000000800000 | disasmcli 64

0000000000000000 48 8b 05 f7 ff ff ff           mov rax, [rip-0x9]
0000000000000007 67 66 8b 40 f0                 mov ax, [eax-0x10]
000000000000000c 67 66 03 5e 10                 add bx, [esi+0x10]
0000000000000011 48 03 04 25 ff ff 00 00        add rax, [0xffff]
0000000000000019 67 66 03 44 be f0              add ax, [esi+edi*4-0x10]
000000000000001f 4c 03 84 98 00 00 00 80        add r8, [rax+rbx*4-0x80000000]
0000000000000027 48 a1 00 00 00 00 00 80 00 00  mov rax, [0x800000000000] 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-11-09T10:21:56.963

死灵术，已经过去了相当长的一段时间。
是的，实际上有几个。

Capstone.NET 的功能非常完整（libcapstone-port ARM、ARM64（又名 ARMv8/AArch64）、M68K、Mips、PowerPC、Sparc、SystemZ、XCore、X86（包括 X86_64）。它支持大多数现代 CPU 扩展）：
[https ://github.com/9ee1/Capstone.NET](https://github.com/9ee1/Capstone.NET)
[http://www.capstone-engine.org/features.html](http://www.capstone-engine.org/features.html)
（麻省理工学院许可）

然后，如前所述，还有 SharpDisasm（libudis-port）：
[https](https://sharpdisasm.codeplex.com/)
://sharpdisasm.codeplex.com/ （简化 BSD 许可证（BSD））

然后是 Reko (x86-DECOMPILER)
[https://github.com/uxmal/reko](https://github.com/uxmal/reko)
(GNU General Public License)

有 ElfSharp 可以读取 ELF 文件：
[https](https://github.com/konrad-kruczynski/elfsharp)
://github.com/konrad-kruczynski/elfsharp (MIT & LLVM License)

或者像这样阅读 PE 格式：
[http ://code.cheesydesign.com/?p=572](http://code.cheesydesign.com/?p=572)

或使用 PETools：
[https](https://github.com/jsok/PETools)
://github.com/jsok/PETools （MIT 许可证）

还有一个检查 lib 文件的工具：
[https ://github.com/BlazingHeart/SymbolExplorer](https://github.com/BlazingHeart/SymbolExplorer)

还有一个 x86 汇编程序库：
[https ://code.google.com/p/managed-x86/](https://code.google.com/p/managed-x86/)

以及 ELF 散列函数
[https://damieng.com/blog/2007/11/24/calculating-elf-32-in-c-and-net](https://damieng.com/blog/2007/11/24/calculating-elf-32-in-c-and-net)

另外，wikibooks 上有一个专门的页面：
[https://en.wikibooks。 org/wiki/X86_Disassembly/Disassemblers_and_Decompilers](https://en.wikibooks.org/wiki/X86_Disassembly/Disassemblers_and_Decompilers)

还有雪人反编译器，它使用 Capstone：
[https ://github.com/yegord/snowman](https://github.com/yegord/snowman)

还有一个完全托管的 x86 汇编器： [https ://github.com/meikeric/managed-x86](https://github.com/meikeric/managed-x86)

# apache-flex - Flex：没有进度条？

> ID：890214
> 
> 赞同：0
> 
> 时间：2009-05-20T20:56:41.263
> 
> 标签：apache-flex, preloader

我已经处理了几个月了。我的 flex 应用程序没有在许多用户计算机上显示预加载器。我以为是因为我使用的是 BrowserManager，但我最近做了一些没有浏览器管理器的操作。它在我的机器上运行良好，但随后我走到经理机器并加载页面，应用程序不存在，没有预加载器，我站在那里看起来像个白痴大约 5 分钟，然后它弹出。普通用户不会等这么久。有谁知道为什么会发生这种情况？

谢谢！

**更新：** 今天我们发现，如果您将鼠标悬停在 flex 应用程序应该在的位置上，虽然 flex 应用程序是空白的，但它会立即弹出，但直到您将鼠标悬停在 flex 应用程序所在的位置时才会弹出......这是什么意思??

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-21T03:41:54.283

它可能在您的机器上而不是其他机器上工作的原因之一是您正在使用 Flash 播放器的调试版本来调试您的 flex 应用程序。然后每次启动时，您几乎 100% 确定 swf 文件不在缓存中。

如果您在启动应用程序之前清除了管理器缓存，问题是否仍然存在？

来自 Adob​​e 站点 ( [http://livedocs.adobe.com/flex/3/html/help.html?content=app_container_4.html](http://livedocs.adobe.com/flex/3/html/help.html?content=app_container_4.html) ) 如果 SWF 文件位于本地主机上或已经缓存了。如果 SWF 文件不在本地主机上且未缓存，则在下载 700 毫秒后，如果应用程序下载不到一半，则会显示进度条。

这仍然不能 100% 解释为什么显示进度条需要 5 分钟。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T14:53:25.610

显然，由于它会等到您将鼠标移到上方才显示，所以我在网上找到的一个解决方法是添加以下内容：

```
<body onload="document.getElementById('WeddingBandBuilder').focus()"> 
```

其中，WeddingBandBuilder 是嵌入式 swf 的 ID。

# c# - 如何从 Web 服务代码 (C#) 访问内部 ASP.NET 对象？

> ID：890218
> 
> 赞同：2
> 
> 时间：2009-05-20T20:57:41.013
> 
> 标签：c#, asp.net, web-services

具体来说，我需要针对数据库验证传入的 X.509 安全证书，以允许访问我的 Web 服务。为此，我需要获取客户端发送的证书副本。我想我知道该怎么做，如果我能弄清楚如何访问 http Request 对象——一个内在的 ASP.NET 对象。

我发现以下代码描述了如何创建将执行此操作的组件，以及如何在 aspx 页面上的 Page Load 事件的代码隐藏中加载它。太好了，我从这篇文章中学到了很多，但它仍然没有解决我的问题——没有网页，所以没有页面加载事件。

如何：使用 Visual C# .NET 从 .NET 组件访问 ASP.NET 内在对象 [http://support.microsoft.com/kb/810928](http://support.microsoft.com/kb/810928)

我正在使用 C# 和 .NET 3.5，但我没有使用 C# 的高级编码功能（lambda、扩展方法等）。我只是还没有花时间学习如何使用它们......

任何提示、指针、示例代码将不胜感激。谢谢，戴夫

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-20T22:07:29.373

如果它是一个 asmx Web 服务（即“页面”/入口点是 somefile.asmx，它应该像从那里访问请求对象一样简单。

示例：在 Visual Studio 中，创建一个 Web 服务应用程序，并将以下代码粘贴到 service1.asmx.cs 中：（以下示例返回 Web 请求中所有标头的名称）

（下面是service1.asmx.cs的完整内容）

```
 using System;
using System.Web;
using System.Web.Services;

namespace WebServiceIntrinsicObjects
{
    /// 
    /// Summary description for Service1
    /// 
    [WebService(Namespace = "http://tempuri.org/")]
    [WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
    [System.ComponentModel.ToolboxItem(false)]
    // To allow this Web Service to be called from script, using ASP.NET AJAX, uncomment the following line. 
    // [System.Web.Script.Services.ScriptService]
    public class Service1 : System.Web.Services.WebService
    {

        [WebMethod]
        public string HelloWorld()
        {
            // HERE'S THE LINE:  just get the request object from HTTPContext.Current (a static that returns the current HTTP context)
            string test = string.Join(",", HttpContext.Current.Request.Headers.AllKeys);
            return test;
        }
    }
} 

```

# javascript - 如何仅使用 javascript 获取以 KB 为单位的当前页面大小？

> ID：890221
> 
> 赞同：8
> 
> 时间：2009-05-20T20:57:56.097
> 
> 标签：javascript, html, widget

参考[这个问题](https://stackoverflow.com/questions/889319/how-to-calculate-approximately-the-connection-speed-of-a-website-using-javascript)，我怎样才能得到当前页面大小（以 kb 为单位），这个大小我将用来知道这个页面的连接速度。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-20T21:27:59.877

除非您的页面大小以兆字节为单位，否则结果将毫无意义。

这是因为与下载页面所需的时间相比，连接、发送请求和等待服务器发送回复所需的时间[相当长](http://webkit.org/blog/166/optimizing-page-loading-in-web-browser/)，此外 TCP/IP[启动缓慢](http://en.wikipedia.org/wiki/Slow-start)。

您还必须考虑缓存、代理和浏览器将建立的并行连接数（例如，可能优先下载脚本和样式，使页面下载时间看起来很慢）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-20T21:07:32.570

如果您的意思只是 html，那么您可以使用 jQuery 来获取字符数（大多数情况下为字节，取决于编码）

```
$(document).ready(
    function()
    {
        var pagebytes = $('html').html().length;
        var kbytes = pagebytes / 1024;
    }
); 
```

这基本上计算了（包括）标签中包含的字符数。这将排除任何指定的 Doctype，但由于那总是静态的，因此您可以将 doctype 的长度添加到 pagebytes。

**//编辑**

看起来文档类型最终可能不是静态的。但没有它，它仍然应该足够准确。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-20T21:01:52.423

我认为通过 Ajax 获取已知数据文件将是比测量当前页面更好的解决方案。为 Ajax 调用的开始和完成计时更容易。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-04-15T14:29:24.383

有一个非标准属性仅适用于 IE - document.fileSize [^(MDN)](https://developer.mozilla.org/en/DOM/document) [^(MSDN)](http://msdn.microsoft.com/en-us/library/ms533752%28v=vs.85%29.aspx)。它以字节为单位返回 html 页面的大小。

或者你可以得到`content-length`标题

```
var request = new XMLHttpRequest();
request.open('GET', document.location, false);
request.send();
var size = request.getAllResponseHeaders().toLowerCase().match(/content-length: \d+/);
document.getElementById("size").innerHTML = size + " bytes"; 
```

1.  [仅带文字的示例](http://zdravko.genov.me/demo/javascript-filesize.html)；
2.  [获取图像大小的示例](http://zdravko.genov.me/demo/javascript-filesize+imagesize.html)；
3.  [内容长度示例](http://zdravko.genov.me/demo/javascript-filesize-pageheader.html)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-05-13T00:11:46.310

为了获取网络上页面的文件大小，我构建了一个 javascript 小书签来解决这个问题。它以 kb 为单位提醒您当前所在页面的大小。不确定它是否有助于提高连接速度。

如果要复制文件大小，请将警报更改为提示。

这是警报的书签代码。

```
<a href="javascript:a=document.getElementsByTagName('HTML')[0].outerHTML;b=a.length/1024;c=Math.round(b);alert(c+' kb');">Doc Size</a> 
```

这是提示的小书签代码。

```
<a href="javascript:a=document.getElementsByTagName('HTML')[0].outerHTML;b=a.length/1024;c=Math.round(b);prompt('Page Size',c+' kb');">Doc Size</a> 
```

[在http://bookmarklets.to.g0.to/filesize.php](http://bookmarklets.to.g0.to/filesize.php)查看它的实际应用

# performance - 分析代码以提高效率？

> ID：890222
> 
> 赞同：14
> 
> 时间：2009-05-20T20:58:02.323
> 
> 标签：performance, profiling, code-analysis

您使用哪些工具来确定代码的效率？您是否使用运行大量测试的本地应用程序或某些商业产品？您是否使用自己的知识来测试代码的某些区域，或者使用一些工具来分析代码的弱点？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-05-21T14:40:07.243

插入：让我们看看“统计意义”。

假设某处有函数调用指令。你不一定能看到它——一个类，一个宏，或者编译器，可能已经把它滑进去了。附近还有对同一个函数的其他调用，但是这个调用是在一个循环中，或者它的参数是这样的使这个电话需要很长时间。事实上，如此多的时间，如果可以使此调用花费零时间，那么总执行时间将减少一定数量，例如 90%。（不可能？一点也不。）时间会精确吗？不会。调用图会查明它吗？不。电话计数会查明吗？不，因为问题不在函数级别，而是在调用指令级别。

不知何故，程序在某个时间点随机停止，并检查其状态。如果指令可以“归零”，它会在 90% 的时间内停止吗？当然 - 以 90% 的概率，指令将被精确定位在堆栈上，等待其“工作”完成。

事实上，如果你随机停止它 20 次，该指令将平均在堆栈上 18 次，标准偏差为 +/- 1.3 次。

*这有统计学意义吗？*你打赌它是。
*您需要大量样品吗？*你打赌你没有。

假设百分比很小，例如 10% 或 5%。*同样的原则也适用。*

事实上，无论抽取多少样本，任何大于 1 个样本的指令都具有统计显着性，并且是“热点”、“瓶颈”或任何你想称之为的指令。如果您可以删除它，减少调用它，或者以某种方式减少它，它将*节省*大量时间。（有些你不能，比如“call _main”，但有些你可以。你只需要找到它们。）

当然，*我的*代码永远不会这么愚蠢，不是吗？那么，*证明它*。

好的，现在回到故事上来。. .

原始答案：我早在很久以前就听说过分析器，我认为它们一定很整洁，但我无法访问它们/它。我正在研究一个嵌入式处理器（一个 8086 intel 芯片），它似乎需要很长时间才能在显示屏上绘制一些浮点数。硬件人员建议从他们的大量提供 - 添加计时器芯片，这样我就可以看到事情需要多长时间。然而，一个周末，我用一个英特尔“Blue Box”在线仿真器启动它并让它运行起来。虽然它很慢，但我想知道“它到底在做什么？”。所以我只是停下来找出答案。PC 在浮点库中（没有 FP 芯片）。这并不奇怪，因为它正在绘制浮点数，但我想知道更多。所以我（费力地）读取十六进制内存以跟踪调用堆栈。你猜怎么了？它在取要绘制的数字，除以10，转换为整数，转换回浮点数，减法等等，*只是为了得到下一个数字来绘画*。不用说，有更好的方法可以做到*这一点*，从而加速了大约 10 倍。 **这是用*一 (1) 个样本发现的！***

另一次，在 68K 芯片上，出现了一些缓慢。同样，分析器不可用，但调试器“adb”可用，所以虽然它很慢，但我停止了几次。PC 在数学库中，实际上在 32 位整数乘法例程中。查找堆栈，我发现了以下代码：

```
struct {...} a[...];

int i;
for (i = 0; i < ...; ++i){ ... a[i] ... } 
```

那里没有乘法的呼唤——这是怎么回事？事实证明，对于`a[i]`，编译器必须乘以`i`数组元素的大小。由于`i`是 32 位（在该编译器中），它会生成对 32 位乘法例程的调用，并且堆栈会精确定位该调用指令。通过声明`i`as `short`，循环速度提高了两倍！

重点是什么？如果您在程序运行缓慢时随机抽取样本，PC 会告诉您它在做什么，但调用堆栈会告诉您*原因*，并直接引导您解决问题。现在，除非问题真的很严重，否则您可能需要采集多个样本。任何出现在 >1 个样本上的陈述都是您可以怀疑的。请注意，它甚至可以精确定位*语句*、*指令*，而不是像函数这样的大块代码。[这种技术](https://stackoverflow.com/questions/375913/what-can-i-use-to-profile-c-code-in-linux/378024#378024)可能“快速而肮脏”，但非常有效。

补充：如果你反复这样做，你可以在同一个软件中解决一个又一个问题。例如，如果您获得 3 倍的加速，以前可能无关紧要的小性能问题现在会消耗 3 倍的剩余时间。这使它们更容易被样本击中。您可能必须添加一个临时的外部循环以使其运行足够长的时间进行采样。通过这种方式，我看到[了超过 40 倍](https://stackoverflow.com/questions/926266/performance-optimization-strategies-of-last-resort/927773#927773)的复合加速因子。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-05-20T21:02:36.900

这称为[分析](http://en.wikipedia.org/wiki/Software_profiling)。对于各种不同的语言，有许多现成的工具可帮助您确定应用程序的瓶颈所在。例如，如果您愿意，Java 的[TPTP](http://www.eclipse.org/tptp/)工具集可以向您显示性能瓶颈所在的位置，具体到单个方法级别。当然，有时你真正需要的只是读几下系统计时器来大致了解一段代码。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-20T21:03:19.347

分析器对于查看您花费最多时间在哪些代码上非常有用。市面上有许多分析工具，通常它们特定于您所在的平台/开发环境。

对于小情况，我在代码中使用了简单的计时器（操作结束时的系统时间 - 操作开始时的系统时间）。

一条重要规则：永远不要假设您刚刚进行的性能优化实际上会运行得更快。随时验证！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-20T21:40:04.390

我确实使用工具来完成这项工作。否则我发现自己很难做到......（这是我的意见，我实际上从未尝试过）

在 Linux 上，我使用[Valgrind](http://valgrind.org/info/tools.html)，它提供了一些有用的工具来分析你的代码。至于 Valgrind 主页：

> 它在以下平台上运行：X86/Linux、AMD64/Linux、PPC32/Linux、PPC64/Linux。

..而且它是免费的（就像免费啤酒一样）并且是开源的。

虽然我没有过多地使用它们，但在另一个平台上，您可以使用[Purify/Quantify](http://www-01.ibm.com/software/awdtools/purifyplus/)（IBM 产品）。它们是商业工具。正如 Will 所报告的，它们是在 PurifyPlus 包中提供的，Quantify 将帮助您分析您的应用程序。

这就是我用过的所有...... :-)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-20T22:08:47.610

老实说，我使用[NUnit](http://www.nunit.org)。如果我的代码花费的时间太长或似乎无法扩展，我会编写一个测试来模拟应用程序中性能不佳的部分。然后我看看在代码中进行强度替换以减少运行时间并验证我没有破坏任何东西。

如果这仍然不能满足您的需求，那么您需要找到并应用分析器，但您至少会有一个测试用例，您可以在无需打开/加载应用程序的情况下尝试您的假设，跟踪对元素的调用与手头的任务无关的应用程序。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-21T15:36:37.333

我使用 Valgrind 及其工具 Callgrind。这是一个很棒的工具。Valgrind 基本上是一个虚拟机：

> Valgrind 本质上是一个使用即时 (JIT) 编译技术的虚拟机，包括动态重新编译。原始程序中的任何内容都不会直接在主机处理器上运行。相反，Valgrind 首先将程序转换为一种临时的、更简单的形式，称为中间表示 (IR)，它是一种与处理器无关、基于 SSA 的形式。转换之后，在 Valgrind 将 IR 转换回机器代码并让主机处理器运行它之前，工具（见下文）可以自由地对 IR 进行任何转换。即使它可以使用动态转换（即主机和目标处理器来自不同的体系结构），它也不能。Valgrind 重新编译二进制代码以在相同架构的主机和目标（或模拟）CPU 上运行。

Callgrind 是一个基于此的分析器。主要好处是您不必运行应用程序数小时即可获得可靠的结果。几秒钟就足够了，因为 Callgrind 是一个**非探测**分析器，

另一个基于 Valgrind 的工具是 Massif。我用它来分析堆内存使用情况。它工作得很好，它为您提供内存使用情况的快照——详细信息 WHAT 拥有多少内存百分比，以及谁把它放在那里。

另一种 Valgrind 工具——DRD（和 Helgrind）。我使用它们来跟踪我的代码中的死锁和数据竞争，以及线程 API 滥用。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-21T01:12:17.240

这个问题是模棱两可的。从运行时或内存的角度来看高效？运行特定代码的上下文、应用程序的架构以及可能被抛出的数据也是所有因素。

顺便说一句，有人提到净化；还有它的姊妹产品 Quantify。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-21T19:34:02.937

我听说过有关[Yourkit](http://www.yourkit.com/) for Java 分析的好消息。对于网站，我尝试了[JMeter](http://jakarta.apache.org/jmeter/)，它具有用于简单参数化分析的基本功能。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-20T21:01:23.547

对于 .NET，我会推荐[NDepend](http://www.ndepend.com/)。

# openid - 我可以通过标准 Google 帐户使用 OpenID 委托吗？

> ID：890234
> 
> 赞同：14
> 
> 时间：2009-05-20T21:01:54.530
> 
> 标签：openid, gmail, delegation

我目前正在使用 ClaimID 并在我的网站上有以下数据以允许委派：

```
<link rel="openid.server" href="http://openid.claimid.com/server" />
<link rel="openid.delegate" href="http://openid.claimid.com/tjrobinson" /> 
```

Google 是否有等效的 URL？如果没有，是否有提及未来的支持？

在有人将此标记为重复之前，我知道这个现有问题：[您如何将您的 OpenId 委托给 Google Apps](https://stackoverflow.com/questions/436829)。但是，该问题专门针对 Google Apps，我只想知道是否可以通过普通的@gmail.com 帐户使用 OpenID 委托？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-20T21:18:40.597

Google 不支持委派。如果您搜索[Google Group](http://groups.google.com/group/google-federated-login-api)有几个线程，但它们都得出相同的结论：目前不支持。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T01:38:52.380

您可以在 openid2.provider 中输入一个值，但问题是 openid2.local_id 值……对于 Google，它为每个 RP 分配了一个不同的值。你会放哪一个？在 Google 提供非匿名声明标识符之前，您可以在此处输入的内容不多。

哦，当然，他们的提供者必须遵守委托规则，我怀疑它没有，因为它不会被使用，因为谷歌不支持它。

# c# - 将 tiff 像素纵横比更改为正方形

> ID：890244
> 
> 赞同：2
> 
> 时间：2009-05-20T21:03:36.150
> 
> 标签：c#, tiff, barcode, aspect-ratio

我正在尝试对多页 tiff 文件执行条形码识别。但是 tiff 文件来自传真服务器（我无法控制），它以非方形像素纵横比保存 tiff。由于纵横比，这导致图像被严重挤压。我需要将 tiff 转换为方形像素纵横比，但不知道如何在 C# 中执行此操作。我还需要拉伸图像，以便更改纵横比仍然使图像清晰可见。

有人用 C# 做过这个吗？或者有没有人使用过一个图像库来执行这样的过程？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-10-25T23:20:06.820

万一其他人遇到同样的问题，这是我最终解决这个烦人问题的超级简单方法。

```
using System.Drawing;
using System.Drawing.Imaging;

// The memoryStream contains multi-page TIFF with different
// variable pixel aspect ratios.
using (Image img = Image.FromStream(memoryStream)) {
    Guid id = img.FrameDimensionsList[0];
    FrameDimension dimension = new FrameDimension(id);
    int totalFrame = img.GetFrameCount(dimension);
    for (int i = 0; i < totalFrame; i++) {
        img.SelectActiveFrame(dimension, i);

        // Faxed documents will have an non-square pixel aspect ratio.
        // If this is the case,adjust the height so that the
        // resulting pixels are square.
        int width = img.Width;
        int height = img.Height;
        if (img.VerticalResolution < img.HorizontalResolution) {
            height = (int)(height * img.HorizontalResolution / img.VerticalResolution);
        }

        bitmaps.Add(new Bitmap(img, new Size(width, height)));
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-20T21:15:19.213

哦，我忘了说。 `Bitmap.SetResolution`可能有助于解决纵横比问题。下面的东西只是关于调整大小。

看看[这个页面](http://www.codeproject.com/KB/GDI-plus/imageprocessing4.aspx)。它讨论了两种调整大小的机制。我怀疑在你的情况下双线性过滤实际上是一个坏主意，因为你可能想要漂亮的单色的东西。

下面是天真的调整大小算法的副本（由 Christian Graus 编写，来自上面链接的页面），这应该是您想要的。

```
public static Bitmap Resize(Bitmap b, int nWidth, int nHeight)
{
    Bitmap bTemp = (Bitmap)b.Clone();
    b = new Bitmap(nWidth, nHeight, bTemp.PixelFormat);

    double nXFactor = (double)bTemp.Width/(double)nWidth;
    double nYFactor = (double)bTemp.Height/(double)nHeight;

    for (int x = 0; x < b.Width; ++x)
        for (int y = 0; y < b.Height; ++y)
            b.SetPixel(x, y, bTemp.GetPixel((int)(Math.Floor(x * nXFactor)),
                      (int)(Math.Floor(y * nYFactor))));

    return b;
} 
```

另一种机制是像[这样](http://snippets.dzone.com/posts/show/4336)`GetThumbNailImage`滥用该功能。该代码保持纵横比，但删除执行该操作的代码应该很简单。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-20T21:37:31.137

我已经使用几个图像库 FreeImage（开源）和 Snowbound 完成了这项工作。（相当昂贵）FreeImage 具有 ac# 包装器，并且 Snowbound 在 .Net 程序集中可用。两者都运作良好。

在代码中调整它们的大小应该不是不可能的，但是 2 色 tiff 有时对于 GDI+ 来说很尴尬。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-21T14:47:04.860

免责声明：我在 Atalasoft 工作

我们的[.NET 成像 SDK](http://www.atalasoft.com/products/dotimage)可以做到这一点。我们写[了一篇知识库文章](http://www.atalasoft.com/KB/article.aspx?id=10153)来展示如何使用我们的产品，但您可以适应其他 SDK。基本上你需要重新采样图像并调整 DPI。

# java - Spring 动态表单的更好方法？

> ID：890250
> 
> 赞同：17
> 
> 时间：2009-05-20T21:04:57.410
> 
> 标签：java, spring, spring-mvc

我想知道在使用 SpringMVC 和 Spring 表单时是否有更简单/更好的方法来处理动态表单（通过 js 将表单项添加到 dom）？

具有包含许多 LineItems 的 Invoice 对象的图像。

```
public class Invocie {
    private List LineItems;

    public Invoice() {
        lineItems = ListUtils.lazyList(new ArrayList<LineItem>(), FactoryUtils.instantiateFactory(LineItem.class));
    }
} 
```

显示属于我当前使用的发票的项目

```
<forEach items="${invoice.lineItems}" varStatus="i">
  <form:input path="lineItems[${i.index}].productName" />
</c:forEach> 
```

要添加 LineItems，我有一些计算新索引并将其添加到 DOM 的 js。删除 LineItem 时，我目前必须重新编号所有索引，这是我想避免的部分，这可能吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-12-01T17:03:55.880

我已经实现了一个教程，可以帮助您在客户端使用 jQuery 和 Springs AutoPopulating 列表来解决这个问题，为您形成支持对象。

~~[http://eggsylife.co.uk/2009/11/30/spring-forms-dynamic-lists-and-ajax/](http://eggsylife.co.uk/2009/11/30/spring-forms-dynamic-lists-and-ajax/)~~

来自 Webarchive 的编辑链接[https://web.archive.org/web/20160729163958/http://eggsylife.co.uk/2009/11/30/spring-forms-dynamic-lists-and-ajax/](https://web.archive.org/web/20160729163958/http://eggsylife.co.uk/2009/11/30/spring-forms-dynamic-lists-and-ajax/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-23T08:40:38.963

你可以使用以下

```
public class InvoiceController extends SimpleFormController {

    protected void initBinder(HttpServletRequest request, ServletRequetDataBinder binder) throws Exception {
        binder.registerCustomEditor(List.class, "lineItems", new CustomCollectionEditor(List.class)() {
            protected Object convertElement(Object lineItem) {
                LineItem li = (LineItem) lineItem;

                // StringUtils is a jakarta Commons lang static class
                return (StringUtils.isBlank(li.getProductName())) ? null : li;
            }

        });
    }

} 
```

然后在 onBind 方法中，根据以下内容删除空引用：

```
protected void onBind(HttpServletRequest request, Object command, BindException bindException) throws Exception {
    Invoice invoice = (Invoice) command;

    invoice.getLineItems().removeAll(Collections.singletonList(null));
} 
```

问候，

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-12-29T19:57:27.517

我今天一直在努力解决这个问题，并想出了[这里](http://lifeinide.com/post/2010-12-29-lazy-list-dynamic-forms/)描述的一些解决方案。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-07-14T00:05:44.880

我发现在 JSP 中添加/设置项目时，还需要使用 GrowthList 进行装饰以避免一些错误。（还创建了一个自定义的 SpringList impl。基本上做了双重装饰。）

```
lineItems = GrowthList.decorate(ListUtils.lazyList(new ArrayList<LineItem>(), FactoryUtils.instantiateFactory(LineItem.class))); 
```

我同意。问题当然是删除项目。

您可以做的是在 html 中使用[spring 标记](http://static.springsource.org/spring/docs/3.0.x/javadoc-api/org/springframework/web/bind/WebDataBinder.html#setFieldMarkerPrefix(java.lang.String))语法。因此，如果您使用 javascript 从列表中删除一个项目（例如在索引 2 处），那么您将使用以下标记该索引：

```
<input type="hidden" name="_lineItems[2]"> 
```

[然后，当提交表单时，spring 将看到标记并为 lineItems 2](http://static.springsource.org/spring/docs/3.0.x/javadoc-api/org/springframework/web/bind/WebDataBinder.html#setFieldMarkerPrefix(java.lang.String))放入一个空项目（基于惰性列表工厂），而不是忽略它。

# java - 如何按照我想要的方式对这个 ArrayList 进行排序？

> ID：890254
> 
> 赞同：36
> 
> 时间：2009-05-20T21:06:30.980
> 
> 标签：java, sorting, arraylist

下面是一个简单的 ArrayList 排序程序：

```
ArrayList<String> list = new ArrayList<String>();

list.add("1_Update");
list.add("11_Add");
list.add("12_Delete");
list.add("2_Create");

Collections.sort(list);
for (String str : list) {
  System.out.println(str.toString());
} 
```

我期待这个程序的输出为：

```
1_Update
2_Create
11_Add
12_Delete 
```

但是当我运行这个程序时，我得到的输出是：

```
11_Add
12_Delete
1_Update
2_Create 
```

为什么会这样？如何让 ArrayList 进行排序，如预期输出中所示？

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2009-05-20T21:57:07.227

您可以编写一个自定义比较器：

```
Collections.sort(list, new Comparator<String>() {
    public int compare(String a, String b) {
        return Integer.signum(fixString(a) - fixString(b));
    }
    private int fixString(String in) {
        return Integer.parseInt(in.substring(0, in.indexOf('_')));
    }
}); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-20T21:14:16.207

当您将这种类型的数据排序为字符串时，它会比较字符本身，包括数字。例如，所有以“1”开头的字符串都会一起结束。所以订单最终类似于这个......

1 10 100 2 20 200

排序在任何时候都不会“意识到”您正在为字符串的子集分配含义，例如字符串前面的可变长度数字。将数字排序为字符串时，向左侧填充尽可能多的零以覆盖最大数字可能会有所帮助，但是当您不控制数据时，它并不能真正解决问题，如您的示例所示。在那种情况下，排序将是......

001 002 010 020 100 200

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-20T21:10:27.790

它被排序为文本（按字母顺序），而不是数字。为了解决这个问题，您可以按照 nsayer 的答案中的建议实现自定义比较器。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-20T21:19:42.887

它正在进行字典比较。它比较每个字符串中的第一个字符对它们进行排序。然后它比较具有相同第一个字符的第二个字符串。当它将“_”字符与数字进行比较时，它的值大于任何单个数字字符，例如 8 > 7 和 a > 9。请记住，它是在进行字符比较而不是数字比较。

有一些方法可以实现您自己的自定义排序路由，这可能比重命名脚本名称更好。

如果重命名脚本名称是一个选项，这可能允许使用其他脚本工具。一种格式可能是

```
01_create_table.sql
02_create_index.sql
11_assign_privileges.sql

```

通过将前两位数字保留为两个字符，词典比较将起作用。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-20T21:13:33.353

Collections.sort() 方法的文档说：

> 根据其元素的自然顺序，将指定列表按升序排序。

这意味着对于字符串，您将按字母顺序获取列表。字符串 11_assign_privileges.sql 位于字符串 1_create_table.sql 之前，而 12_07_insert_static_data.sql 位于 1_create_table.sql 等之前。因此程序按预期工作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-20T21:13:43.553

因为字符串按字母顺序排序，而下划线字符位于数字字符之后。您必须提供一个实现“自然顺序”的比较器才能达到预期的结果。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-20T21:15:28.230

字符串比较算法一次比较*每个字符*。`1`排序之前`2`。`1`后面跟 a或 a无关紧要`2`。

所以`100`会先排序`2`。如果您不想要这种行为，您需要一个比较算法来处理这种情况。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-20T21:17:40.240

正如其他人所说，默认情况下元素将按字母顺序排序。解决方案是定义一个具体的 java.util.Comparator 类并将其作为第二个参数传递给 sort 方法。您的比较器需要从字符串中解析出前导整数并进行比较。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-20T21:36:14.553

要让 Collection.sort() 任意排序，您可以使用

```
Collections.sort(List list, Comparator c) 
```

然后简单地实现一个比较器，它拆分字符串并首先根据数字排序，然后根据其余部分或您希望它排序。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-20T21:42:04.620

大家已经指出，解释是你的字符串是按字符串排序的，一个数字已经把你的注意力引向Natural Order字符串比较。我只想补充一点，自己编写比较器是一个很好的练习，也是一个练习测试驱动开发的好机会。我在 Code Camp 上用它来演示 TDD；幻灯片和代码在[这里](http://www.socalcodecamp.com/session.aspx?sid=d6a0b292-0e13-4685-b769-5169734e32c3)。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-20T21:42:30.330

如上所述，您正在寻找实现自然排序的 Comparator 实现。Jeff Atwood前段时间写了一篇[关于自然排序](https://blog.codinghorror.com/sorting-for-humans-natural-sort-order/)的优秀文章——非常值得一读。

如果您正在寻找 Java 实现，我发现这个很有用： [http ://www.davekoelle.com/alphanum.html](http://www.davekoelle.com/alphanum.html)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2011-03-12T19:01:53.643

您可以添加 IComparable 接口，然后按特定属性排序。例如，如果您有商店的商品集合，您可能想按价格或按类别等对它们进行排序。如果您想按名称订购，这是一个示例：

请注意 ArrayList 如何按项目的 name 属性排序。如果你不添加 IComparable 那么当你使用 sort 方法时它会抛出一个错误。

![在此处输入图像描述](https://i.stack.imgur.com/LPF3i.png)

```
static void Main(string[] args)
    {
        ArrayList items = new ArrayList();
        items.Add(new Item("book", 12.32));
        items.Add(new Item("cd", 16.32));
        items.Add(new Item("bed", 124.2));
        items.Add(new Item("TV", 12.32));

        items.Sort();

        foreach (Item temp in items)
            Console.WriteLine("Name:{0} Price:{1}", temp.name, temp.price);
        Console.Read();            
    }

    class Item: IComparable
    {
        public string name;
        public double price;

        public Item(string _name, double _price)
        {
            this.name = _name;
            this.price = _price;
        }

        public int CompareTo(object obj)
        {   
            //note that I use the name property I may use a different one
            int temp = this.name.CompareTo(((Item)obj).name);
            return temp;
        }
    } 
```

# bash - 使用 printf 将整数 ASCII 值转换为 BASH 中的字符

> ID：890262
> 
> 赞同：97
> 
> 时间：2009-05-20T21:07:56.467
> 
> 标签：bash, ascii, printf

性格到价值的作品：

```
$ printf "%d\n" \'A
65
$ 
```

我有两个问题，第一个最重要：

*   我如何取 65 并将其变成 A？
*   \'A 使用 printf 将 ASCII 字符转换为其值。语法是*特定*于*printf*还是在 BASH 中的其他任何地方使用？（这么小的字符串很难用谷歌搜索。）

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2009-11-18T10:10:40.580

一条线

```
printf "\x$(printf %x 65)" 
```

两条线

```
set $(printf %x 65)
printf "\x$1" 
```

如果您不介意使用，这是一个`awk`

```
awk 'BEGIN{printf "%c", 65}' 
```

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2015-09-22T23:16:10.490

这有效（使用八进制值）：

```
$ printf '%b' '\101'
A 
```

即使对于（一些：不要超过 7 个）序列：

```
$ printf '%b' '\'{101..107}
ABCDEFG 
```

允许任何范围内的（十进制）值的一般构造是：

```
$ printf '%b' $(printf '\\%03o' {65..122})
ABCDEFGHIJKLMNOPQRSTUVWXYZ[\]^_`abcdefghijklmnopqrstuvwxyz 
```

或者您可以使用字符的十六进制值：

```
$ printf '%b' $(printf '\\x%x' {65..122})
ABCDEFGHIJKLMNOPQRSTUVWXYZ[\]^_`abcdefghijklmnopqrstuvwxyz 
```

* * *

您还可以使用 xxd 取回字符（使用十六进制值）：

```
$ echo "41" | xxd -p -r
A 
```

也就是说，一个动作与另一个相反：

```
$ printf "%x" "'A" | xxd -p -r
A 
```

还可以同时使用多个十六进制值：

```
$ echo "41 42 43 44 45 46 47 48 49 4a" | xxd -p -r
ABCDEFGHIJ 
```

或序列（此处使用 printf 来获取十六进制值）：

```
$ printf '%x' {65..90} | xxd -r -p 
ABCDEFGHIJKLMNOPQRSTUVWXYZ 
```

* * *

甚至使用 awk：

```
$ echo 65 | awk '{printf("%c",$1)}'
A 
```

即使对于序列：

```
$ seq 65 90 | awk '{printf("%c",$1)}'
ABCDEFGHIJKLMNOPQRSTUVWXYZ 
```

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2011-12-01T09:43:53.000

对于您的第二个问题，前导引号语法 ( ) 似乎`\'A`特定于`printf`：

> 如果前导字符是单引号或双引号，则该值应是单引号或双引号后字符的基础代码集中的数值。

来自[https://pubs.opengroup.org/onlinepubs/9699919799/utilities/printf.html](https://pubs.opengroup.org/onlinepubs/9699919799/utilities/printf.html)

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-05-20T21:21:32.667

一种选择是使用十六进制或八进制表示法直接输入您感兴趣的字符：

```
printf "\x41\n"
printf "\101\n" 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-05-20T21:12:31.887

对于这种转换，我使用 perl：

```
perl -e 'printf "%c\n", 65;' 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2012-02-21T22:49:58.120

如果你想保存字符的 ASCII 值：（我在 BASH 中做了这个并且它有效）

```
{
char="A"

testing=$( printf "%d" "'${char}" )

echo $testing} 
```

输出：65

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2017-01-20T16:27:57.690

如果您转换`65`为十六进制，则为`0x41`：

`$ echo -e "\x41" A`

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2019-07-26T01:11:16.183

对于大写字母：

```
i=67
letters=({A..Z})
echo "${letters[$i-65]}" 
```

输出：

```
C

```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2014-11-20T10:05:08.783

这是将 65 转换为 A 的另一种方法（通过八进制）：

```
help printf  # in Bash
man bash | less -Ip '^[[:blank:]]*printf'

printf "%d\n" '"A'
printf "%d\n" "'A"

printf '%b\n' "$(printf '\%03o' 65)" 
```

搜索`man bash`使用`\'`（尽管在这种情况下是徒劳的）：

```
man bash | less -Ip "\\\'"  # press <n> to go through the matches 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2020-08-03T21:24:38.573

这将打印基本 bash 设置的所有“可打印”字符：

```
printf '%b\n' $(printf '\\%03o' {30..127})

 !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\]^_`abcdefghijklmnopqrstuvwxyz{|}~ 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-03-18T17:15:50.967

以下脚本打印`aaa...zzz`（即`aaa > aab > aac > ... > zzx > zzy > zzz`）

```
for i in $(seq 0 25); do FIRST=$(printf \\$(printf '%03o' $[97+$i]) | tr -d '\n'); for f in $(seq 0 25); do SECOND=$(printf \\$(printf '%03o' $[97+$f]) | tr -d '\n'); for g in $(seq 0 25); do THIRD=$(printf \\$(printf '%03o' $[97+$g]) | tr -d '\n'); echo "${FIRST}${SECOND}${THIRD}"; done; done; done 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-12-16T20:28:10.313

这是一个没有*eval*也没有*$()*也没有 `` 的解决方案：

```
ord () {
 local s
 printf -v s '\\%03o' $1
 printf "$s"
}

ord 65 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-11-16T03:05:24.720

鉴于没有那么多 1 字节字符，但只有 256 个，它们可以在脚本启动时快速预先计算：

```
declare -ag CHARS=()
for REPLY in {{0..9},{a..f}}{{0..9},{a..f}}; do
  printf -v CHARS[${#CHARS[@]}] "\x$REPLY"
done 
```

（我重用了可丢弃`REPLY`变量，但您可以`local`在 init 中自己使用`function`）

然后...

```
$ echo "${CHARS[65]}"
A
$ i=65
$ echo "${CHARS[i]}"
A 
```

注意`\x00`，它的值在 Bash 中没有被正确处理，因为它是字符串终止符：

```
$ var=$'qwe\x00rty'
$ echo ${#var}
3
$ echo "<${var}>"
<qwe> 
```

所以，`"${CHAR[0]}"`在 Bash 下永远是个问题。

这样，您可以避免每次需要处理一个字符时一次又一次地进行输出捕获、内联文本替换和重新解析；这对于通过或的子进程 IPC`xxd`来说更糟。`awk``perl`

# c# - 应该处置注入的属性吗？

> ID：890274
> 
> 赞同：6
> 
> 时间：2009-05-20T21:11:32.263
> 
> 标签：c#

简短的最佳实践问题：如果将对象 A 注入到另一个对象 B 中，那么对象 B 是否应该实现 IDisposable 并在释放 B 时释放 A？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-20T21:15:21.070

如果您指的是[依赖注入](http://www.martinfowler.com/articles/injection.html)模式，我认为这取决于对象 B 中有关对象 A 实现的知识。像这样进行依赖注入的原因通常是因为您事先不知道对象 A 将如何实施以及是否需要 IDisposable。你唯一知道的就是界面。

添加此行为将导致两个类 IMO 之间的耦合更紧密。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-20T21:53:50.697

我通常会说不；依赖注入的本质意味着被注入的对象对它被注入的生命周期知之甚少；在某种程度上，这就是注入的定义。因此，我认为注入的对象不应该处理注入的任何东西。注入代码应该负责了解它正在注入的所有对象的完整生命周期，并且应该能够在对它们的所有操作完成时正确地处理它们，而不是之前。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-20T21:16:10.787

（编辑：回答时，我不清楚这个问题是关于 IoC/DI 的；我将把它留在这里以供参考，但先看看接受的答案）。

如果通过“注入”您的意思是`B`承担 的所有权`A`，那么是的；这方面的例子是这样的[`StreamReader`](http://msdn.microsoft.com/en-us/library/yhfzs7at.aspx)。

如果它只*使用* `A`一段时间（但`A`继续存在`B`），那么不会。

一些 API 允许您（在构造函数上）指定是否应假定所有权（即是否清理注入的对象）。这方面的一个例子是[`GZipStream`](http://msdn.microsoft.com/en-us/library/27ck2z1y.aspx)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-20T21:15:18.777

我认为这最终会成为主观的。

这一切都归结为，谁应该控制对象 A 的生命周期？

例如，对象 C 和 D 也有对象 A 注入其中，在这种情况下，您不希望对象 B 过早地处理对象 A。

但是，在某些情况下，当您知道对象 A 的生命周期应以 B 结束时，让对象 B 处置对象 A 是完全合适的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-20T21:17:56.823

我的 2p 会争辩说，当 B 被处置时，A 不应该被处置。依赖注入的整个想法是，您不必担心接收到的对象的行为和生命周期，您只需将它们交给它们即可。

然后再一次，您要确保对象在不再需要时立即被清理。也许创建一个迷你事件系统，以便您可以通知需要处理它？我想这真的取决于上下文。

# asp.net - WebForms 自定义/动态路由

> ID：890275
> 
> 赞同：1
> 
> 时间：2009-05-20T21:12:04.790
> 
> 标签：asp.net, webforms, url-routing

我正在为 WebForms 使用[Phil Haack 的](http://haacked.com/archive/2008/03/11/using-routing-with-webforms.aspx)URL 路由，我想定义一个“动态”的路由。假设我有这条路线：

"{any}.aspx" -- 转到 --> "~/PageProcessor.aspx"

这会将任何不是物理页面的请求带到 PageProcessor 页面。这很好用。问题是，基于来自数据库的一些数据，我需要将某些页面路由到不同的处理器，比如 DifferentPageProcessor.aspx。我无法定义捕获所有 .aspx 文件的新路由，因为第一个路由会捕获所有文件。

因此，在“路由器”决定将请​​求带到 PageProcessor 并根据需要将其分叉到 PageProcessor 或 DifferentPageProcessor 之前，我需要一种方法来处理请求。这可能吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-20T21:58:42.747

我的解决方案——除非有人提出更优雅的解决方案——是修改 WebFormRouting 项目中的 WebFormRouteHandler 类以接受自定义谓词。

```
public WebFormRouteHandler(string virtualPath, bool checkPhysicalUrlAccess, Func<RequestContext, string> custom) 
```

然后在类中，我将自定义参数存储到私有 CustomVirtualPath 属性中。要使用它，我必须将 GetSubstitutedVirtualPath 更改为：

```
public string GetSubstitutedVirtualPath(RequestContext requestContext)
{
  string path = VirtualPath;

  if (CustomVirtualPath != null)
  {
    path = CustomVirtualPath(requestContext);
  }

  if (!path.Contains("{")) return path;

  //Trim off ~/
  string virtualPath = path.Substring(2);

  Route route = new Route(virtualPath, this);
  VirtualPathData vpd = route.GetVirtualPath(requestContext, requestContext.RouteData.Values);
  if (vpd == null) return path;
  return "~/" + vpd.VirtualPath;
} 
```

对于要编译的项目，我们需要更改 WebFormRoute 和 WebFormRouteExtensions 以允许自定义参数向下传递。完成后，我可以在 global.asax.cs 中编写它

```
routes.MapWebFormRoute("All", "{any}.aspx", "~/", false,
                         context =>
                           {
                             return ((string)context.RouteData.Values["any"] == "test"
                                       ? "~/PageProcessor.aspx"
                                       : "~/DifferentPageProcessor.aspx");
                           }); 
```

当然，lambda 表达式的主体应该从其他地方（数据库或缓存）查找 URL。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-06-04T08:37:04.893

它在 VB 中，但我是这样做的：

```
 Routes.Add("Root", New Route("{*URLRequest}", New myRootRouteHandler())) 
```

这和你的一样，它会捕获整个请求，然后将其传递给我自己的自定义路由处理程序类：

```
Imports System.Web.Routing
Imports System.Security
Imports System.Web.Compilation
Imports System.Web

Public Class myRootRouteHandler
  Implements IRouteHandler
  Implements IRequiresSessionState

  Private Path As String

  Public Function GetHttpHandler(ByVal requestContext As RequestContext) As IHttpHandler Implements IRouteHandler.GetHttpHandler
    Dim url As String = Web.HttpContext.Current.Request.ServerVariables("SERVER_NAME")
    Dim Key As String = requestContext.RouteData.Values("URLRequest")
    Dim myConfig As New LoadMyConfig(url)
    Dim aspxToLoad As String = myConfig.getPageVirtualPath(Key)
    Dim page As myCustom_Page_Base = TryCast(BuildManager.CreateInstanceFromVirtualPath(aspxToLoad, GetType(myCustom_Page_Base)), myCustom_Page_Base)

    page.RequestContext = requestContext
    page.strRequestContext = Key
    page.mySettings = myConfig

    Return page

End Function 
```

在我的示例中，我重载了 System.ui.page，以便项目中的每个 aspx 页面都可以自动继承某些属性，例如包含我的应用程序设置的 mySettings 对象。这就是为什么我将页面调暗为 myCustom_Page_Base，你可以加载它作为标准页面。

重要的一点是：BuildManager.CreateInstanceFromVirtualPath 方法这将加载您指向它的任何 aspx 文件。

希望这可以帮助..

# java - 在预先存在的 Java 项目中集成 Groovy 代码时的 Groovy 陷阱

> ID：890276
> 
> 赞同：2
> 
> 时间：2009-05-20T21:12:06.397
> 
> 标签：java, groovy

我们有一个大型 Java Web 应用程序项目。我正在考虑在我认为 Groovy 可以减少我们工作量的情况下集成一些 Groovy 代码。例如，XML 解析和单元测试。

这种情况是否有任何“陷阱”或负面影响。例如，也许它会使我们的构建更加复杂。我也听说过兼容性问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-21T00:35:53.757

我有一个结合了 Java 和 Groovy 的项目。我使用 Groovy 处理文本文件，使用 Java 处理 Swing UI。一些困难在哪里：

*   Eclipse IDE 支持不佳。Groovy Eclipse 插件很差，不支持命令完成。在 Eclipse 中构建 Groovy 代码是非常脆弱和痛苦的。街上的消息是 IntelliJ 支持要好得多。
*   Maven 集成。也有点棘手，但不如 Eclipse 糟糕。
*   表现。在厌倦了糟糕的 Eclipse 支持之后，我用 Java 重新实现了我的文本处理，发现性能要快得多。对于我的应用程序，它从文本文件中读取一行并在特定偏移处查找数据，Java 代码的运行速度比 Groovy 快大约 3 倍。

对我来说，使用 Groovy 并不值得。您的里程可能会有所不同。

# c# - 温莎城堡：- 通过配置注入接口字典

> ID：890287
> 
> 赞同：3
> 
> 时间：2009-05-20T21:14:36.313
> 
> 标签：c#, inversion-of-control, castle-windsor

嗨，我正在尝试注入接口字典，但从城堡中收到这样的错误：-

Castle.MicroKernel.SubSystems.Conversion.ConverterException：没有注册转换器来处理 IFoo 类型

为了绕过异常，我必须创建一个包含 Ifoo 接口列表的包装器，并使用属性返回它。然后在配置中使用包装器 ==> 字典而不是字典

在城堡里有没有一种方法可以让我只拥有一个接口字典而不是做这个解决方法？

```
public interface IFoo {}
public class Foo {}
public class IfooWrapper {
    IList<IFoo> container{get;set;}
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-29T01:21:52.290

这对我来说很好（Windsor 2.0）：

```
namespace WindsorTests {
    public interface IService {}    
    public class Service1 : IService {}    
    public class Service2 : IService {}    
    public class Consumer {
        private readonly IDictionary<string, IService> services;    
        public IDictionary<string, IService> Services {
            get { return services; }
        }    
        public Consumer(IDictionary<string, IService> services) {
            this.services = services;
        }
    }    

    [TestFixture]
    public class WindsorTests {    
        [Test]
        public void DictTest() {
            var container = new WindsorContainer(new XmlInterpreter(new StaticContentResource(@"<castle>
<components>
    <component id=""service1"" service=""WindsorTests.IService, MyAssembly"" type=""WindsorTests.Service1, MyAssembly""/>
    <component id=""service2"" service=""WindsorTests.IService, MyAssembly"" type=""WindsorTests.Service2, MyAssembly""/>
    <component id=""consumer"" type=""WindsorTests.Consumer, MyAssembly"">
        <parameters>
            <services>
                <dictionary>
                    <entry key=""one"">${service1}</entry>
                    <entry key=""two"">${service2}</entry>
                </dictionary>
            </services>
        </parameters>
    </component>
</components>
</castle>")));
            var consumer = container.Resolve<Consumer>();
            Assert.AreEqual(2, consumer.Services.Count);
            Assert.IsInstanceOfType(typeof(Service1), consumer.Services["one"]);
            Assert.IsInstanceOfType(typeof(Service2), consumer.Services["two"]);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-20T22:08:46.937

我不得不做一些非常相似的事情。但是我认为它比其他任何东西都暴露了一个设计缺陷。我重构了我的应用程序，以便它完成您的包装类作为其标准工作方式所做的事情。它也大大简化了应用程序。

这实际上只是按照“温莎城堡的方式”做事，而不是试图让“我的方式”适应温莎城堡的模式。看到温莎城堡的方式变得多么容易和更好，真是令人羞愧……

从技术上讲，这不是您提出的问题的解决方案，但希望它可以帮助您。

# c++ - How to Learn C++ When you are stuck in your ways with newer Languages?

> ID：890292
> 
> 赞同：2
> 
> 时间：2009-05-20T21:15:38.357
> 
> 标签：c++

> **Possible Duplicates:**
> [What is the best approach for a Java developer to learn C++](https://stackoverflow.com/questions/789659/what-is-the-best-approach-for-a-java-developer-to-learn-c)

How would you go about learning C++ if you were "Stuck in your ways" with newer languages like Java or C#?

I've been working as a developer for 3 years, I've got both a Bachellors and a masters in computing science from a Reputable UK University...

I've written millions of lines of C# thousands of lines of Java and a few hundred lines of C...

But I don't know C++, I feel a little like I've cheated the profession by not knowing a what I think is a key language. I've written Code in C++ files, mainly for bug fixes, but it was really just C in disguise.

What is the best way to go about learning C++, if you are more used to the nice abstractions that higher level languages give you to get away from the nitty grittyness of C++.

Has anyone on SO gone from being an experienced Java, C# (or some other language) developor to a C++ programmer? if so how did you do it, was it difficult and do you have any pointers?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-20T21:20:28.907

By reading Stroustroup's C++ Programming Language. Switched from Common Lisp.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-20T21:21:13.477

I have an idea: try looking up all those "Java for C++ Programmers" articles, because there are so many of them. They're written for those who took the historical path (like I did), but it seems like there ought to be an awful lot of useful information, examples, etc., of what the parallels are and how they're different.

That, and spend a lot of time developing in C++ :-)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-20T21:24:50.210

Pretty much like you do any other language. Pick a project to work on and write it in C++. Immerse yourself in the language by reading C++ code to pick up on proper idioms. Reading good books like Effective C++, etc... will help you write correct C++. C++ is a really nice language that gets beat up a lot by the C# and Java programmers, so try and go into it with a positive mindset.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-20T21:24:06.873

Since you already have some C programming skills, I would suggest [Expert C Programming: Deep C Secrets](https://rads.stackoverflow.com/amzn/click/com/0131774298) by Peter van der Linden. It has a great section on C++ to get you from C to C++. That should get you running with C++ syntax. Of course you can go straight to the Stroustrup if you feel more hungry...

Get a good C/C++ compiler and get working...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-20T21:25:04.700

I would probably start by concentrating on the commonalities among those language that you already know somewhat, i.e. namely the C syntax, classes and encapsulation from Java/C#, and from there on it's mostly a matter of the different types in C, and well ***pointers*** of course, as well as manual memory management.

A pretty good multimedia introduction (flash video with animations) to the C-family of programming languages is provided by Bruce Eckel's [Thinking in C](http://mindview.net/CDs/ThinkingInC/beta3).

Once you got these basics sorted, I would recommend to concentrate on getting to grips with the STL and eventually boost.

Also, one thing that might be worth a try in order to get started actually **using** your new knowledge, might be to start splitting your future projects into distinct modules, where certain components/parts could possibly be implemented in C++.

This encourages modular design and will provide for a way to actually learn new things and apply your knowledge step by step. This could be done for example by planning to implement one tiny part of a new project as a DLL or in managed C++ code.

And in cases where you find that you cannot directly use/embed C++ components, you could still try to follow a C++ oriented approach, deliberately sacrificing some of those Java/C# facilities that you know are not available in C++.

In other words, there's usually a common denominator between platforms and languages, in network programming it's for example BSD style sockets, on Windows there's often the possibility to make use of the Win32 API.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-20T21:25:43.827

Try [this question](https://stackoverflow.com/questions/789659/what-is-the-best-approach-for-a-java-developer-to-learn-c).

# wpf - WPF：使用图像蒙皮

> ID：890295
> 
> 赞同：2
> 
> 时间：2009-05-20T21:16:17.730
> 
> 标签：wpf, image, bitmap, skinning, skin

有很多示例展示了如何使用从 .xaml 文件动态加载的 DynamicResources 和 ResourceDictionaries 对 WPF 应用程序进行皮肤处理。

我的问题是我的皮肤使用图像，我想将样式定义和图像包含在一个文件中，这样用户只需要下载它。

任何想法如何做到这一点？有没有办法打包多个资源？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T04:39:54.883

您可以通过创建主题的 DLL 来做到这一点，我的意思是单独的 DLL 项目，其中嵌入了图像和样式资源文件。唯一的限制是它不允许开发人员修改样式。希望这对你有帮助

# sql - 在关系数据库中建模原子事实

> ID：890297
> 
> 赞同：1
> 
> 时间：2009-05-20T21:16:34.173
> 
> 标签：sql, database, database-design, data-modeling, relational

我想记录各种来源对历史人物的看法。IE

*   维基百科网站说苏珊·B·安东尼出生于 1820 年 2 月 15 日，她最喜欢的颜色是蓝色
*   *《奋斗的世纪*》一书中说，苏珊·B·安东尼出生于 1820 年 2 月 12 日，她最喜欢的颜色是红色
*   *《妇女选举权史*》一书中说，苏珊·B·安东尼生于 1820 年 2 月 15 日，她最喜欢的颜色是红色，是亚伯拉罕·林肯的第二代堂兄。

我还希望研究人员能够表达他们对这些来源提出的个人主张的信心，例如以百分比表示。IE

*   用户 A 有 90% 的把握认为苏珊 B.安东尼出生于 1820 年 2 月 15 日；75% 的人相信她最喜欢的颜色是蓝色，30% 的人相信她是亚伯拉罕·林肯的第二表亲
*   用户 B 有 30% 的把握认为苏珊 B.安东尼出生于 1820 年 2 月 12 日；60% 相信她最喜欢的颜色是蓝色，10% 相信她是亚伯拉罕·林肯的第二代表亲

然后，我希望每个用户都能看到 Susan B. Anthony 的视图，其中显示了她的生日、最喜欢的颜色以及用户认为最有可能真实的关系。

我还想使用关系数据库数据存储，我认为这样做的方式是为我希望用户能够表达他们的信心的每一种原子事实创建一个单独的表。所以对于此示例，总共将有八个表，三个单独的表用于三个单独的原子事实。

```
Source(id)
Person(id)

Claim(claim_id, source, FOREIGN KEY(source) REFERENCES Source(id) )
Alleged_birth_date(claim_id, person, birth_date, FOREIGN KEY(claim_id) REFERENCES Claim(id), FOREIGN KEY(person) REFERENCES person(id))
Alleged_favorite_color(claim_id, person, color, FOREIGN KEY(claim_id) REFERENCES Claim(id), FOREIGN KEY(person) REFERENCES person(id)) 
Alleged_kinship(claim_id, person, relationship type, kin, FOREIGN KEY(claim_id) REFERENCES Claim(id), FOREIGN KEY(person) REFERENCES Person(id))

User(id)
Confidence_in_claim(user, claim, confidence, FOREIGN KEY(user) REFERENCES User(id), FOREIGN KEY(claim) REFERENCES claim(id)) 
```

这感觉它很快变得非常复杂，因为实际上想要记录很多类型的原子事实。有没有更好的方法来做到这一点？

我认为，这与 Martin Fowler 所说的[矛盾观察](http://www.martinfowler.com/bliki/ContradictoryObservations.html)相同的问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-20T21:30:52.850

您应该尝试以“事实”表和多个“维度”表为中心的星型模式模型。这是一个经过充分探索的模型，并且有许多针对它的数据库优化。

claim_fact(source_id, person_id, user_id, details_id, weight)

source_dimension(id, name)

Person_dimension(id, name)

用户维度（ID，名称）

details_dimension(id, name NOT NULL, color NULLABLE, 亲属关系 NULLABLE, 生日 NULLABLE)

每个声明都会有来源、人员、用户和详细信息。详细信息的 NAME 值将是诸如“亲属关系”、“生日”之类的值。

请记住，这是一个 OLAP 模式（而不是 OLTP 结构），因此它没有完全规范化。这样做的好处超过了由于冗余而可能遇到的任何问题，因为对星型模式的查询已通过为数据仓库配置的 DBMS 进行了高度优化。

推荐读物：数据仓库工具包（Kimball 等人）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-20T21:21:38.173

[RDF](http://en.wikipedia.org/wiki/Resource_Description_Framework)非常适合这一点。它通常被描述为元数据的格式；但实际上它是三元组上“断言”的图形模型。

整个“语义网”的想法是在 RDF 上发布大量事实，而搜索引擎将是遍历统一图以查找关系的推理引擎。

还有一些机制可以引用三元组，所以你可以说一些关于断言的内容，比如它的起源（谁说的？），或者断言的时间（他什么时候说的？），或者你相信它的程度是真的，等等。

作为一个大例子，整个[OpenCyc](http://www.cyc.com/cyc/opencyc/overview)的“常识知识库”都可以在 RDF 中查询

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-20T21:22:42.833

我认为您要使用的是“财产袋”。不是对您要描述的每种单独的事实类型进行建模，而是希望有一个包含 ID、“键”（在本例中是指称的信息（例如“亲属关系”））和“值”的表”（在这种情况下，指称的价值（例如“Abraham Lincoln）”）。然后您希望有第二张表格将您的索赔人与该表格联系起来，以及他们对该信息的信心水平。该表格将只需拥有来源的 ID、属性的 ID 以及来源​​对信息的置信度。这样，您可以拥有包含大量或少量信息的来源；您还可以对不同的来源进行建模对给定属性具有不同程度的置信度；

对于诸如您有大量要交叉引用的可选信息的情况，这是一个非常标准的解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-20T21:22:07.470

> 这感觉就像它很快变得非常复杂

你不是在开玩笑。看看关于[本体](http://en.wikipedia.org/wiki/Ontology_(computer_science))和[知识表示](http://en.wikipedia.org/wiki/Knowledge_representation)的工作。

# .net - Silverlight asp.net WCF 身份验证 2.0

> ID：890310
> 
> 赞同：1
> 
> 时间：2009-05-20T21:18:48.270
> 
> 标签：.net, wcf, silverlight, configuration, wcf-security

谁能提供一些关于设置 Silverlight 2.0 以通过 ASP.NET 表单身份验证对 WCF 服务进行身份验证的*良好信息的链接？*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-20T22:19:10.410

我想这个链接可以帮助你 [http://silverlightuk.blogspot.com/2008/03/silverlight-wcf-and-aspnet.html](http://silverlightuk.blogspot.com/2008/03/silverlight-wcf-and-aspnet.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T14:09:10.177

这是一个开始的好地方。允许您在 SL2 中使用 ASP.NET Forms Auth 的技术称为 ASP.NET 应用程序服务 - 它易于使用。

[http://msdn.microsoft.com/en-us/library/cc838250(VS.95).aspx](http://msdn.microsoft.com/en-us/library/cc838250(VS.95).aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-07T04:17:21.117

不久前，Kevin Rohling 为使用 SL 2 进行 ws-security 进行了一次精彩的演练。在他的示例中，您可能可以将您的逻辑插入到钩子中。在这里查看：http: [//geekswithblogs.net/SunnyCoder/archive/2009/03/15/username-password-amp-ws-security-with-silverlight.aspx](http://geekswithblogs.net/SunnyCoder/archive/2009/03/15/username-password-amp-ws-security-with-silverlight.aspx)

干杯

# c# - 当 XElement 具有相同名称时如何使用 LINQ 查询获取 XElement 值

> ID：890313
> 
> 赞同：9
> 
> 时间：2009-05-20T21:19:36.663
> 
> 标签：c#, linq-to-xml

我有一段xml，如下所示：

```
<Table>
  <Record>
    <Field>Value1_1</Field>
    <Field>Value1_2</Field>
  </Record>
  <Record>
    <Field>Value2_1</Field>
    <Field>Value2_2</Field>
  </Record>
</Table> 
```

我想要的是一个 LINQ 查询，它生成一个 IEnumerable，我可以将其分配为 DataGrid 的数据源。到目前为止我所拥有的如下：

```
var temp = from record in table.Elements("Record")
            select record.Element("Field").Value 
```

我可以拥有多个字段元素的事实是我的绊脚石。

在上面的例子中，我需要的是类似`IEnumerable<string,string>`. 数据网格看起来像这样：

```
Value1_1, Value1_2
Value2_1, Value2_2 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-21T21:25:00.280

这样的事情会有帮助吗？

```
var a = from record in table.Elements("Record")
    select new
    {
        one = (string)record.Elements().ElementAt(0),
        two = (string)record.Elements().ElementAt(1)
    }; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-21T21:57:20.153

听起来您想对该字段进行非规范化，以使其适合数据网格中的 1 列。

以下有帮助吗？

```
var table = XElement.Parse(@"<Table>
                                <Record><Field>Value1_1</Field><Field>Value1_2</Field></Record>
                                <Record><Field>Value2_1</Field><Field>Value2_2</Field></Record>
                             </Table>");

var temp = from record in table.Elements("Record")
           from field in record.Elements("Field")
           group field.Value by record into groupedFields
           select groupedFields.Aggregate((l, r) => l + ", " + r);

foreach (var row in temp)
    Console.WriteLine(row);

Console.ReadKey(); 
```

免责声明：我不再做太多 SQL 或 LINQ，所以这可能会变得更好。随意改变它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-11-12T18:18:36.047

也许这个？

```
using System.Linq;
using System.Xml.Linq;
using System.Collections.Generic;
using System.Diagnostics;

[TestMethod]
    public void Linq_XElement_Test()
    {

    string xml = @"<Table>
  <Record>
    <Field>Value1_1</Field>
    <Field>Value1_2</Field>
  </Record>
  <Record>
    <Field>Value2_1</Field>
    <Field>Value2_2</Field>
  </Record>
</Table>";

    XElement elements = XElement.Parse(xml);

    var qryRecords = from record in elements.Elements("Record")
                  select record;

    foreach (var rec in qryRecords)
    {
        Debug.WriteLine(rec.Value);
    }

    var qryFields = from record in elements.Elements("Record")
                 from fields in record.Elements("Field")
                 select fields;

    foreach (var fil in qryFields)
    {
        Debug.WriteLine(fil.Value);
    }

    IEnumerable<string> list = qryFields.Select(x => x.Value);

    foreach (string item in list)
    {
        Debug.WriteLine(item);
    }

} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-11-10T05:57:58.907

我不明白问题是什么以及为什么其中许多答案看起来如此复杂：-/这是我的提议：

```
var r = (from record in table.Elements("Record")
         select (from element in record.Elements("Field")
                 select element.Value));

// => IEnumerable<IEnumerable<string>> 
```

内部 IEnumerable 用于列，外部用于行。（这个问题有点令人困惑，因为没有`IEnumerable<T,T'>`，以上是我对意图的改编。）

您可以将内部 IEnumerable 变成一个字符串（例如 Join on ", "），但是如果您的意思是将值作为列，那么将其放入网格并不是很有趣！

```
var r = (from record in table.Elements("Record")
         select String.Join(", ",
             record.Elements("Field").Select(f => f.Value).ToArray());

// => IEnumerable<string> 
```

如果我真的知道 LINQ 表达式，上面的内容可能会变得更好。但是，它可以工作并涵盖“其他”情况——“ToArray”适用于 .NET 3.5 及更低版本。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-21T22:50:45.350

Er... I think you're using the wrong LINQ paradigm for this problem. You should be using LINQ to XML which is slightly different maybe than you're expecting.

Check out this link:

[http://msdn.microsoft.com/en-us/library/bb308960.aspx](http://msdn.microsoft.com/en-us/library/bb308960.aspx)

It explains it using a structurally similar example to the one you presented.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-21T23:00:51.150

Would an

```
IEnumerable<List<string>> 
```

work? (not sure how to get that to display inline)

```
var recordList = from record in data.Elements("record") select record;
List<List<string>> x = new List<List<string>>(recordList.Count());
foreach (var record in recordList)
{
  var z = from field in record.Elements("field") select field.Value;
  x.Add(z.ToList());
}
return x.AsEnumerable(); 
```

Don't know if that works for your specific scenario or not.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-21T22:01:05.607

我可能与您正在寻找的东西相去甚远，但是您在寻找这样的东西吗？

```
 DataSet ds = new DataSet("Records DS");
        ds.Tables.Add("Records");
        foreach (XElement record in table.Descendants("Record"))
        {
            var temp = from r in record.Descendants("Field")
                       select r.Value;

            string[] datum = temp.ToArray();
            if (datum != null
                && datum.Length > 0)
            {
                foreach (string s in datum)
                    ds.Tables[0].Columns.Add();
                DataRow row = ds.Tables[0].NewRow();
                row.ItemArray = datum;
                ds.Tables[0].Rows.Add(row);
            }
        } 
```

然后返回`ds`并设置`DataMember`为`"Records"`

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-21T07:24:15.593

您可以将调用链接到`Elements()`：

```
var temp = from field in table.Elements("Record").Elements("Field")
           select field.Value; 
```

您还可以使用`Descendants()`：

```
 var temp = from field in table.Descendants("Field")
            select field.Value; 
```

但是，这将返回 <Table> 下的所有 <Field> 元素，即使它们不在 <Record> 元素内。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-21T22:24:00.053

你需要一个两步的过程：

注释记录（代替属性），然后枚举字段并将值传递给匿名类进行绑定，如下所示：

```
string xml = [string-goes-here];

  XElement elem = XElement.Parse(xml);

  int count= 0;
  foreach(XElement recordElems in elem.Elements("Record")){
    recordElems.SetAttributeValue("id", count);
    count++;
  }
  var temp = from record in elem.Elements("Record")
             from field in record.Elements("Field")
             select new { Record = "Record " + record.Attribute("id").Value, Field = field.Value };

  foreach (var item in temp)
  {
    Console.WriteLine("{0}: {1}", item.Record, item.Field);
  }
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-04-13T19:26:01.970

var detail1 = from d in ds.tbl_Looking_Fors where d.Profile_ID == id select d.Looking_For ;

```
 string[] datum = detail1.ToArray();
            if (datum != null && datum.Length > 0)
            {
                foreach (var row in datum)
                {
                    Label6.Text = datum[0]+" , "+datum[1];
                }

            } 
```

# c# - XmlSerializer.Deserialize() 没有反序列化列表 正确地

> ID：890316
> 
> 赞同：5
> 
> 时间：2009-05-20T21:19:52.137
> 
> 标签：c#, .net, xml-serialization

我是 C# XmlSerializer 的新手，所以我可能在这里遗漏了一些基本的东西。

我遇到的问题是我有一个班级有`List<T>`另一个班级。当我序列化主类时，XML 看起来很漂亮，所有数据都完好无损。当我反序列化 XML 时，其中的数据`List<T>`消失了，我只剩下一个空的`List<T>`. 我没有收到任何错误，序列化部分就像魅力一样。

我在反序列化过程中缺少什么？

**编辑：**请注意，下面显示的代码不会重现问题 - 它有效。这是真实代码的简化版本，它*不起作用*。不幸的是，下面的代码被简化到不能重现问题！

```
public class User
{
  public User()
  {
    this.Characters = new List<Character>();
  }
  public string Username { get; set; }
  public List<Character> Characters { get; set; }
}

public class Character
{
  public Character()
  {
    this.Skills = new List<Skill>();
  }
  public string Name { get; set; }
  public List<Skill> Skills { get; set; }
}

public enum Skill
{
  TreeClimber,
  ForkliftOperator
}

public static void Save(User user)
{
    using (var textWriter = new StreamWriter("data.xml"))
    {
        var xmlSerializer = new XmlSerializer(typeof(User));
        xmlSerializer.Serialize(textWriter, user);
    }
}

public static User Restore()
{
    if (!File.Exists("data.xml"))
        throw new FileNotFoundException("data.xml");

    using (var textReader = new StreamReader("data.xml"))
    {
        var xmlSerializer = new XmlSerializer(typeof(User));
        return (User)xmlSerializer.Deserialize(textReader);
    }
}

public void CreateAndSave()
{
  var character = new Character();
  character.Name = "Tranzor Z";
  character.Skills.Add(Skill.TreeClimber);

  var user = new User();
  user.Username = "Somebody";
  user.Characters.Add(character);

  Save(user);
}

public void RestoreAndPrint()
{
  var user = Restore();
  Console.WriteLine("Username: {0}", user.Username);
  Console.WriteLine("Characters: {0}", user.Characters.Count);
} 
```

执行 CreateAndSave() 生成的 XML 如下所示：

```
<User>
  <Username>Somebody</Username>
  <Characters>
    <Character>
      <Name>Tranzor Z</Name>
      <Skills>
        <Skill>TreeClimber</Skill>
      </Skills>
    </Character>
  <Characters>
</User> 
```

完美的！这就是它应该看起来的样子。如果我然后执行`RestoreAndPrint()`，我会得到一个 User 对象，其 Username 属性设置正确，但 Characters 属性是一个空列表：

```
Username: Somebody
Characters: 0 
```

谁能向我解释为什么 Characters 属性被正确序列化但不会反序列化？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-20T21:36:46.410

无法复制；我得到（在修复了更直接的错误之后）：

```
Username: Somebody
Characters: 1 
```

变化：

*   `WriteLine`而不是`WriteFormat`（阻止它编译）
*   初始化默认构造函数中的列表（阻止`CreateAndSave`工作）：
    *   `public User() { Characters = new List<Character>(); }`
    *   `public Character() { Skills = new List<Skill>(); }`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-20T21:43:21.717

过去，在序列化列表时，我使用了 [XmlArray] 和 [XmlArrayItem] 注释。然后，您将在 Characters 属性上放置一个 [XmlIgnore] 注释。在您的情况下，它看起来像这样：

```
[XmlArray("Characters")]
[XmlArrayItem("Character", Type=typeof(Character))]
public Character[] _ Characters
{
    get
    {
        //Make an array of Characters to return 
        return Characters.ToArray();
    }

    set
    {
        Characters.Clear();
        for( int i = 0; i < value.Length; i++ )
            Characters.Add( value[i] );
    }
} 
```

希望有帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-01-19T17:25:18.357

我知道这是旧的，但我有同样的问题。

我发现如果我有一个在图中实现 IXmlSerializable 的对象（所以我想要反序列化的主要对象没有实现接口，但其中的一个对象实现了它），它会破坏所有的反序列化。列表不再反序列化，我正在谈论的对象也不再反序列化。序列化工作完美。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-21T18:36:50.183

也许，而不是 StreamReader，而是创建一个 XmlReader。此外，作为故障排除步骤，您可以尝试使用显式类型（如下所示）而不是“var”声明的现有代码。

```
public static User Restore()
{
  if (!File.Exists("data.xml"))
    throw new FileNotFoundException("data.xml");

  XmlReader xr = XmlReader.Create("data.xml");
  XmlSerializer serializer = new XmlSerializer(typeof(User));
  var user = (User)serializer.Deserialize(xr);
  xr.Close();
  return user;
} 
```

编辑：另外，在您的 User 类上尝试 XmlInclude 注释。

```
[XmlInclude( typeof( Character ) )] 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-26T20:23:44.573

在折腾了很长时间的代码之后，我终于放弃了使用 XmlSerializer 的默认行为的想法。

所有相关类现在都继承了 IXmlSerializer 并实现了 ReadXml() 和 WriteXml() 函数。我真的希望采取懒惰的路线，但现在我已经使用了 IXmlSerializer，我意识到这真的一点也不难，而且增加的灵活性非常好。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-20T21:34:25.697

```
Stream stream = File.Open(filename + ".xml", FileMode.Open);
User user = null;
using (XmlReader reader = XmlReader.Create(stream))
{
    user = IntermediateSerializer.Deserialize<User>(reader, null);
}
stream.Close();

return user; 
```

我会尝试使用这样的东西。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-08-16T06:28:09.640

我将此属性添加到我的列表类型中，然后它就起作用了（遇到了同样的问题）：

```
[System.Xml.Serialization.XmlElementAttribute("NameOfMyField")]
public List<SomeType> NameOfMyField{get;set;} 
```

我认为这是您的解决方案。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2009-05-20T21:28:43.540

它可能与枚举的反序列化有关......因为它将它序列化为字符串值......可能无法为字符创建正确的枚举值。没有测试过这个假设...

# eclipse - 在eclipse中启动一个struts2项目

> ID：890320
> 
> 赞同：1
> 
> 时间：2009-05-20T21:20:47.707
> 
> 标签：eclipse, struts2

我正在启动一个 struts2 项目。虽然我能够使用 struts2-blank 作为一个快速开箱即用的项目，但我在 Eclipse 中创建自己的 struts2 项目时遇到了麻烦。

所有必要的 jar 都位于 web-inf/lib 目录中，但是只要我将以下行添加到我的 web.xml

```
<filter>
    <filter-name>struts2</filter-name>
    <filter-class>org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter</filter-class>
</filter>

<filter-mapping>
    <filter-name>struts2</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping> 
```

我收到一个错误

> HTTP状态404描述请求的资源()不可用

目前我只有一个没有实现类的直通操作，它只是重定向到一个 jsp 结果页面。

如果有人有任何想法，我将不胜感激。

亲切的问候 D

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-21T14:59:10.887

很难说。该错误并不是真正的 Struts 特定的。我认为您将不得不提供有关您正在做什么的更多信息。如果您使用 maven 原型，您是否能够使用 mvn jetty:run 运行您的项目？您是否将项目作为 Maven 项目导入 Eclipse？你是在 Eclipse 中运行它吗？

似乎如果您在 IDE 中运行该站点，则在构建内容的位置并将其部署为 Web 应用程序时遇到问题。检查 Eclipse web 部署/运行 tomcat/whatever 选项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-26T14:59:22.850

```
<filter>
  <filter-name>filter</filter-name>
  <filter-class>org.apache.struts2.dispatcher.FilterDispatcher</filter-class>
</filter>
<filter-mapping>
  <filter-name>filter</filter-name>
  <url-pattern>/*</url-pattern>
</filter-mapping> 
```

请检查一下

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-30T12:57:31.340

我认为错误与 src 文件夹有关..你把它放在哪里了。如果你使用的是 eclipse，你必须在开始时提到你将使用

```
webcontent/web=inf/src 
```

作为源目录。希望这可以帮助。

# visual-studio - Visual Studio 外部工具参数问题

> ID：890326
> 
> 赞同：1
> 
> 时间：2009-05-20T21:22:39.620
> 
> 标签：visual-studio, batch-file

Visual Studio 2005：我正在从构建后事件转移到使用带有批处理文件的外部工具菜单。

以前我有

```
cd "$(ProjectDir).."
for /f "tokens=2,3,4 delims=/ " %%a in ('date /t') do set bdate=%%c.%%a.%%b
pkzipc -add -overwrite -dir=current "Z:\Technology\VisualStudio2005\Project Zips\$(ProjectName)_%bdate%_%username%.zip" "$(ProjectDir)*" 
```

当我尝试将其用作外部工具时，它会将 "" 包裹在项目名称周围并在 SolutionDirectory 上添加一个额外的 \ （我不确定我是否希望项目或解决方案目录继续前进，似乎都不起作用）

我尝试使用的代码：

```
pkzipc -add -overwrite -dir=current Z:\Technology\VisualStudio2005\Project Zips\%2\%2_%bdate%_%username%.zip %1* 
```

这段代码不起作用我认为剥离外部“”的第一部分得到了回答，这在 projectdir 变量的末尾留下了额外的 \。我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-20T21:33:32.500

我不确定我是否在关注你（并且没有直接的问题），但如果你有一个用引号括起来的参数并且你想删除它们，你可以使用另一个变量：

```
set THEDIR=%1
set THEDIR=%THEDIR:"=% 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T02:55:31.117

您还可以像这样修剪最后一个字符：

```
SET SOMEVAR=%SOMEVAR:~0,-1% 
```

如果引号和 \ 出现在同一个变量中，您可以这样做：

```
SET SOMEVAR=%SOMEVAR:~1,-2% 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T06:56:04.573

您可能将外部工具设置错误，您需要将 pkzipc 的完整路径放在*Command:*字段中，并将参数放在*Arguments:*中。
此外，您无权访问脚本参数，因此 %1 %2 不起作用，那么您的参数字段应该是：

```
-add -overwrite -dir=current "Z:\..\$(ProjectName)_%bdate%_%username%.zip" "$(ProjectDir)*" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-09T15:51:57.743

我最终使用了一个自定义构建的 .net 应用程序而不是命令行，因为这样不那么复杂。

# regex - Textmate空白突出显示

> ID：890330
> 
> 赞同：0
> 
> 时间：2009-05-20T21:23:15.720
> 
> 标签：regex, textmate

我想通过不在其他空行上突出显示空格来修改[此处描述的突出尾随空格的解决方案。](https://stackoverflow.com/questions/641794/highlighting-trailing-whitespace-in-textmate-for-python)

我已经在我的 Python 语言文件中修改了这个：

```
 {   match = '(\s+)$';
        captures = { 1 = { name = 'invalid.whitespace'; }; };
    }, 
```

对此：

```
 {   match = '\S(\s+)$';
        captures = { 1 = { name = 'invalid.whitespace'; }; };
    }, 
```

这个新表达式似乎不再匹配任何东西。我究竟做错了什么 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-20T21:50:19.440

尝试断言：

```
(?<=\S)\s+$ 
```

它们在[PHP 手册](http://uk.php.net/manual/en/regexp.reference.php)中有很好的描述（当然它们不是 PHP 特定的，只是 php.net 恰好有文档的可读版本）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-20T23:29:43.187

您的模式的问题是前面的非空格字符可能已经被另一个规则匹配，因此您的规则不可用。使用porneL 建议的断言是正确的方法。

# wxpython - wxPython：如何在网格单元中实现粘贴？

> ID：890336
> 
> 赞同：1
> 
> 时间：2009-05-20T21:24:15.920
> 
> 标签：wxpython

请耐心等待，我一整天都在使用 wxPython。

简短的版本是，给定一个 grid.PyGridCellEditor 和一个字符串的引用，我该如何实现粘贴功能？

这是在试图处理在 Grid 小部件中粘贴整行的一大块现有代码的主体中，这个块是单元格编辑控件可见并且剪贴板上只有一个纯文本字符串的特殊情况。我可以用剪贴板上的内容替换整个单元格，但我想要真正的粘贴——要么在插入光标处插入文本，要么替换选定的文本。

我的代码块看起来像这样：

```
def paste(self):
    clipboard = <get contents from the clipboard>
    ....
    if self.IsCellEditControlShown:
        # just do a normal paste here
        celleditor = self.GetCellEditor(row,col)
        <what goes here?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-21T14:21:26.890

我已经回答了我自己的问题，因为没有其他人站出来。解决方案是这样的：

```
if self.isCellEditControlShown:
    # _active_row and _active_col are set in the event handler...
    cellEditor = self.GetCellEditor(self._active_row, self._active_col)
    textControl = cellEditor.GetControl()
    textControl.Paste() 
```

这并不能准确回答我最初的问题，其中包括在变量中包含一个字符串，但在我的情况下，该字符串首先来自剪贴板。如果我真的想粘贴任意字符串，我可以在调用 Paste() 之前将其放在剪贴板上

# c++ - 给定日期和时间，您如何获得大纪元时间？

> ID：890343
> 
> 赞同：0
> 
> 时间：2009-05-20T21:25:18.257
> 
> 标签：c++, epoch

我有

```
int year, month, day, hour, min, sec 
```

如何在 C++ 中获取纪元时间？

我很难用 Boost 搞清楚，有什么例子或替代方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-20T21:29:08.080

用您的值填写 struct tm，然后调用[`std::mktime()`](http://en.cppreference.com/w/cpp/chrono/c/mktime).

我假设“获取纪元时间”是指自纪元以来的秒数，即 Unix time_t。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-20T21:27:15.633

你把事情弄得太复杂了。查看[标准库中的时间函数](http://www.manpagez.com/man/2/gettimeofday/)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-20T21:29:29.013

如果我确实正确理解了您的问题，这个[提升示例](http://www.boost.org/doc/libs/1_39_0/doc/html/date_time/examples.html#date_time.examples.seconds_since_epoch)应该可以满足您的要求。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-07-19T10:53:55.493

```
#include <iostream>
#include <sys/time.h>

int main ()
{
  unsigned long int seconds = time(NULL);
  std::cout << seconds << std::endl;
  return 0;
} 
```

# build-process - 如何针对另一个未安装的 autotools 项目构建一个 autotools 项目？

> ID：890347
> 
> 赞同：3
> 
> 时间：2009-05-20T21:26:11.003
> 
> 标签：build-process, build, autotools

假设我有两个 autotools 项目：

*   libmyutils
*   libmypackage

libmypackage 库依赖于 libmyutils。有没有办法让 libmypackage 链接到并引用 libmyutils 包而不实际安装它？还是我必须实际安装 libmyutils 才能让 libmypackage 访问它？

例子：

```
# Contains src/*, configure, etc.
~/workspaces/libmyutils

# Contains src/*, configure, etc.
~/workspaces/libmypackage 
```

问题是我想将 libmyutils 保留为自己的包，以便其他库能够使用它（libmypackage2、libmypackage3 等），但由于我可能正在积极地在 libmyutils 和 libmypackage 上进行开发，所以我想避免每次进行更改时都必须编译和安装 libmyutils。

这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-24T18:54:19.833

我有一个我使用的子项目树，我将我的 libmylib_la_LIBADD vars 设置为指向已编译但已卸载的 lib，以便在测试/调试期间我链接到构建系统中的 lib，并在增量编译等情况下获得好处......

```
libmyapplib_la_LIBADD = -lpthread $(top_builddir)/components/common/libmyutils.la 
```

然后，稍后当我使用 configure --prefix=whatever 安装时，configure 正确地完成了指向 util lib 安装位置的最终链接

# wpf - WPF 级联组合框

> ID：890348
> 
> 赞同：2
> 
> 时间：2009-05-20T21:26:36.837
> 
> 标签：wpf, combobox

我成功地进行了数据绑定并使用了 WPF 组合框，并且通过在触发父组合 SelectionChanged 事件时触发子组合上的更新，在级联一些组合框方面取得了一些成功。我的组合是 cboCountry、cboCity 和 cboTown。

但是，这并不可靠，因为当父级触发子组合下拉内容中的更新时，它似乎将子组合中的选定值置空。

有没有人经历过这种行为（并且已经解决了）或者有没有人有任何代码可以在没有这个问题的情况下成功运行？

```
Private Sub cboArea_SelectionChanged(ByVal sender As Object, ByVal e As System.Windows.Controls.SelectionChangedEventArgs) Handles cboArea.SelectionChanged
    Dim drv As DataRowView = CType(CType(e.Source, ComboBox).SelectedItem, DataRowView)
    If Not IsNothing(drv) Then
        Dim Area As String = drv(0).ToString
        Dim dv As New DataView(gLookupTown, "ItemGrouping = '" & Area & "'", "ItemValue", DataViewRowState.CurrentRows)
        cboTown.ItemsSource = dv
    End If
End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T02:41:16.263

这是因为您正在更改 ComboBox 的 ItemsSource。如果没有代码示例，我无法告诉您如何修复它。最好的选择是根据父 ComboBox 的值过滤 ObservableCollection，这样您就不需要更改子 ItemsSource。您还可以尝试在 ItemsSource 更改时重置 SelectedValue。

# gwt - GWT 模块 XML - 如何重新定义和使用多个用户代理

> ID：890352
> 
> 赞同：5
> 
> 时间：2009-05-20T21:27:40.547
> 
> 标签：gwt

[http://code.google.com/docreader/#p=google-web-toolkit-doc-1-5&s=google-web-toolkit-doc-1-5&t=FAQ_CompileOnePermutation](http://code.google.com/docreader/#p=google-web-toolkit-doc-1-5&s=google-web-toolkit-doc-1-5&t=FAQ_CompileOnePermutation)

在文章中，我了解到我可以加快编译器的速度，但可以指定目标用户代理。问题是如何指定多个用户代理？假设我的应用程序支持 ie6 和 FF3

```
<set-property name="user.agent" value="ie6,geck1_8" /> 
```

不起作用 - 我收到 XML 解析错误：

```
[ERROR] Invalid property value 'ie6,gecko1_8' 
```

我想知道是否有一种方法可以在模块 XML 文件中指定多个特定的用户代理？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-09T09:17:25.633

在 GWT2.4 中将 user.agent 值设置为 gecko 时，我收到了类似的错误消息。所以我环顾四周，发现 gwt 代码在哪里定义了可能的值。

如果您查看位于 com.google.gwt.user.UserAgent.gwt.xml 的 gwt-user.jar，您可以看到您正在使用的 GWT 版本的可能值。

对于 GWT2.4，这是我发现的：

```
<!-- Browser-sensitive code should use the 'user.agent' property -->
  <define-property name="user.agent" values="ie6" />
  <extend-property name="user.agent" values="ie8" />
  <extend-property name="user.agent" values="gecko1_8" />
  <extend-property name="user.agent" values="safari" />
  <extend-property name="user.agent" values="opera" />
  <extend-property name="user.agent" values="ie9" fallback-value="ie8" />
  <property-provider name="user.agent" generator="com.google.gwt.user.rebind.UserAgentPropertyGenerator"/> 
```

因此，在我的情况下，gecko 不是 user.agent 的有效值，如果我使用 gecko1_8 它可以很好地为 Firefox 编译。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-12-30T07:37:08.863

对于 chrome 等基于 webkit 的浏览器，使用“safari”作为用户代理

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-21T05:03:36.590

在 GWT 1.6 中工作，您的 *.gwt.xml 文件：

```
<module rename-to="moduleName">
      <!-- blah blah -->
      <set-property name="user.agent" value="ie6,gecko,gecko1_8" />
      <!-- generate perms for IE and firefox only -->
</module> 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-06-24T01:26:55.003

为了快速部署任何应用程序，您需要两个目标；一次用于您的托管模式在 {Firefox / Linux、Safari / Mac、IE6 / Win} 上部署的引擎，另一次用于您的敏捷浏览器，可让您实时构建 css {Firefox + Firebug}。

```
Linux: <set-property name="user.agent" value="gecko1_8,gecko"/>
Mac: <set-property name="user.agent" value="gecko1_8,safari"/>
...etc... 
```

这只是 GWT >= 1.6！

对于较旧的 gwt 项目，您必须超级来源 com/google/gwt/user/UserAgent.gwt.xml 文件...将它放在包含在类路径上的 gwt-*.jar 之前的源位置中。基本上，您可以将该文件复制到与原始文件相同的包中的新文件中，然后编辑返回实际 user.agent 值的 CDATA javascript 块。随心所欲地玩这个，但不要对他们的 user.agent 属性太疯狂，因为它将在未来的构建中为 ie8 更改。

要针对 ie 浏览器，请创建您自己的 ie.version 属性，并调整 UserAgent.gwt.xml 中的 property-provider 副本以针对不同版本的 ie。只需确保在使用自定义属性进行延迟绑定时执行以下操作：

```
<all>
  <when-property-is name="user.agent" value="ie6"/>
  <any>
    <when-property-is name="ie.version" value="ie7"/>
    <when-property-is name="ie.version" value="ie8"/>
  </any>
</all> 
```

或者你会得到 ie7 + gecko/safari 构建和其他永远不会使用的愚蠢垃圾。

注意：property-provider 中的任何代码都加载到 .nocache.js 中，并且对于在下载 .cache.js 有效负载时预加载图像/css 很有用。
只需添加 var __cached = new Image('Url To Compiled Image / 不管你想加载什么');

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-21T03:44:50.747

还没有。这个想法是您快速开发到一个浏览器，然后编译一次以便为所有浏览器部署（即进行最终测试），GWT 处理浏览器的差异。不要忘记，在部署时，GWT 会优化每个浏览器的下载量，因此最终选择多少用户代理并不重要。

# arrays - 用于快速随机访问、搜索、插入和删除的高效数据结构

> ID：890357
> 
> 赞同：17
> 
> 时间：2009-05-20T21:28:49.017
> 
> 标签：arrays, data-structures, list, linked-list

我正在寻找一种数据结构（或多个结构），它可以让我保留一个有序的整数列表，没有重复，索引和值在同一范围内。

我需要四个主要操作才能高效，按重要性粗略排序：

1.  从给定索引中获取值
2.  查找给定值的索引
3.  在给定索引处插入值
4.  删除给定索引处的值

使用一个数组，我在 O(1) 处有 1，但 2 是 O(N)，插入和删除是昂贵的（我相信也是 O(N)）。

链表有 O(1) 的插入和删除（一旦你有了节点），但 1 和 2 是 O(N)，因此否定了收益。

我尝试保留两个数组 a[index]=value 和 b[value]=index，它们将 1 和 2 变为 O(1)，但将 3 和 4 变为更昂贵的操作。

有没有更适合这个的数据结构？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-20T21:39:02.833

我会使用[红黑树](http://en.wikipedia.org/wiki/Red-black_tree)将键映射到值。这为 1、3、4 提供了 O(log(n))。它还按排序顺序维护键。

对于 2，我将使用哈希表将值映射到键，从而为您提供 O(1) 性能。它还增加了 O(1) 开销，用于在红黑树中添加和删除键时保持哈希表更新。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-20T21:32:28.040

使用二进制搜索的排序数组怎么样？

插入和删除很慢。但考虑到数据是纯整数这一事实，如果您使用 C 或 C++，则可以通过调用 memcpy() 来优化。如果您知道数组的最大大小，您甚至可以避免在使用数组期间进行任何内存分配，因为您可以将其预分配到最大大小。

“最佳”方法取决于您需要存储多少项目以及与查找相比您需要插入/删除的频率。如果你很少插入或删除一个排序数组，使用 O(1) 访问值肯定会更好，但如果你经常插入和删除东西，二叉树可能比数组更好。在任何情况下，对于足够小的 n，数组最有可能击败树。

如果关注存储大小，那么数组也比树好。树还需要为它们存储的每个项目分配内存，并且内存分配的开销可能很大，因为您只存储小值（整数）。

如果您从已排序的数组或带有内存（取消）分配的树中插入/删除，您可能想要分析更快的情况，即整数的复制。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-20T21:43:35.820

我不知道您使用的是什么语言，但如果是 Java，您可以利用[LinkedHashMap](http://java.sun.com/javase/6/docs/api/java/util/LinkedHashMap.html)或类似的 Collection。它具有 List 和 Map 的所有优点，为大多数操作提供恒定的时间，并且具有大象的内存占用。:)

如果您不使用 Java，LinkedHashMap 的想法可能仍然适用于解决您的问题的可用数据结构。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-21T09:57:35.057

使用向量进行数组访问。

使用地图作为搜索索引，将下标插入向量。

*   **给定一个下标，**从向量 O(1) 中获取值
*   **给定一个键，使用映射找到**值的下标。O(lnN)
*   **插入一个值**，推回向量 O(1) 摊销，将下标插入映射 O(lnN)
*   **删除一个值**，从地图中删除 O(lnN)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-20T21:35:25.210

树形图怎么样？log(n) 用于描述的操作。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-20T21:36:00.670

我非常喜欢平衡二叉树。它们有时比哈希表或其他结构慢，但它们更容易预测；它们通常`O(log n)`适用于所有操作。我建议使用[Red-black tree](http://en.wikipedia.org/wiki/Red-black_tree)或[AVL tree](http://en.wikipedia.org/wiki/AVL_tree)。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-04-28T06:50:54.117

How to achieve 2 with RB-trees? We can make them count their children with every insert/delete operations. This doesn't make these operationis last significantly longer. Then getting down the tree to find the i-th element is possible in log n time. But I see no implementation of this method in java nor stl.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-20T21:49:07.337

如果您在 .NET 中工作，那么根据 MS 文档[http://msdn.microsoft.com/en-us/library/f7fta44c.aspx](http://msdn.microsoft.com/en-us/library/f7fta44c.aspx)

*   SortedDictionary 和 SortedList 都有 O(log *n* ) 用于检索
*   SortedDictionary 有 O(log *n* ) 用于插入和删除操作，而 SortedList 有 O( *n* )。

两者的不同之处在于内存使用和插入/移除速度。SortedList 使用的内存比 SortedDictionary 少。如果从排序数据中一次性填充 SortedList，则它比 SortedDictionary 更快。因此，这取决于哪种情况最适合您。

此外，您对 Linked List 的论点并不是真正有效的，因为它可能是 O(1) 的插入，但是您必须遍历列表才能找到插入点，所以实际上不是。

# html - 类似于 CushyCMS 的可安装 CMS？

> ID：890361
> 
> 赞同：2
> 
> 时间：2009-05-20T21:30:00.340
> 
> 标签：html, content-management-system

我正在寻找与[CushyCMS](http://www.cushycms.com)类似的 CMS 系统，但我可以安装在自己的服务器上吗？

[我喜欢 CushyCMS 为不需要设置和安装传统 CMS（ Drupal](http://drupal.org/)、[Wordpress](http://wordpress.org/)、[TYPO3](http://typo3.com/)）的简单、小型站点提供的功能和易用性。

有人有想法么？

谢谢！特洛伊

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-07-06T11:29:15.263

[Perch](http://grabaperch.com/)是一个*优秀*的轻量级 CMS。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-12-04T05:26:43.880

我推荐 ImpressPages CMS

[http://www.impresspages.org/](http://www.impresspages.org/)

它不使用 html 标签，但它是一种非常简单的“拖放”样式。网站管理员可以使用清晰的工具栏，显然 WYSIWYG 编辑并不是每个人都喜欢的（这不是我的），但对于 5 个左右的页面来说，它是完美的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-08-08T07:38:21.787

[Orbis CMS](http://www.novo-ws.com/orbis-cms)是 CushyCMS 等 CMS 的开源替代品。它建立在相同的原则（简单、易用）上，并具有时尚的界面，但它是自托管和免费的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-08-12T14:42:21.510

*“只需添加一个类即可修改 html 页面，但我可以将其安装在我自己的一台服务器上”*

Unify 做得非常好[unify.unitinteractive.com](http://unify.unitinteractive.com/)每个域的成本为 24.49 美元，只需将​​ unify 文件夹上传到您的网站空间并将 class="unify" 添加到您想要可编辑的 html 区域。

另一个理想的 5 页站点是 pulsePro [http://pulsecms.com/](http://pulsecms.com/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-20T21:49:19.007

如果您想编写一些自己的代码/html，可能值得一看[django-cms](http://django-cms.org/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-20T21:51:56.550

好吧，我还不知道，但是如果您想要替代在线服务，请查看 Surreal CMS。您也可以试用 Simple CMS，但它仍然很新（一两天前发布到测试版）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-05-05T17:47:44.027

你应该看看[Zimplit](http://www.zimplit.com/index.html)！

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-05-28T00:17:51.193

SnippetMaster 非常酷。可惜它不是开源和免费的，但至少它有慷慨且廉价的许可方案（正常、可重新命名等）

如果它为内容区域使用类名会很好，但它使用以特殊方式格式化的 HTML 注释（如 IE 条件），因此它仍然是有效的 html。

[http://www.snippetmaster.com](http://www.snippetmaster.com)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-12-02T19:27:58.330

我建造了这个[www.kitgui.com](http://www.kitgui.com)因此程序员可以成为他们自己选择的语言/框架的程序员，并使用 REST 样式的界面来拉取内容和 HTML 5 javascript 参考，从而能够让客户直接在网站页面上管理编辑体验。如今，HTML 5 允许跨站点安全性发生，因此这样做一切都是有意义的。在我的电子商务业务中，一切都是关于您可以多快设置东西以将它们推出门并获得报酬。KitGUI 使它变得如此简单，除非您尝试一下，否则您将无法真正欣赏它。这是全新的，所以我不知道程序员是否喜欢它，除了我自己的开发人员当然有偏见。我知道客户肯定会这样做，所以如果您有时间调查，请给我一些反馈，因为我竭尽全力推出它。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-10-22T01:39:08.177

与 CushyCMS 非常相似的是[Unify CMS](http://unify.unitinteractive.com/)。

他们有一个演示，您可以[在购买前试用](http://unify.unitinteractive.com/demo.php)。

您将看到 Unify 与 CushyCMS 非常相似，我引用：

> 您不需要了解 PHP，也不需要专门为 Unify 编写代码。为了在您的站点上创建可编辑区域，您只需为每个元素添加“统一”类。就是这样。

没有要设置的数据库，您只需通过 FTP（或类似方式）上传文件并开始添加您希望拥有可编辑区域的类。它们也有可重复的区域。

Unify 目前售价 24.49 美元，并提供[45 天退款保证](http://unify.unitinteractive.com/guarantee.php)。

[支持由 Desk.com 提供支持](http://unify.desk.com/)

看看[Unify 要求](http://unify.unitinteractive.com/tutorial-server-settings.php)，你会发现你可以在地球上几乎任何服务器上运行它；好吧，几乎任何服务器:)

# java - 你如何在Android中获得手机的MCC和MNC？

> ID：890366
> 
> 赞同：55
> 
> 时间：2009-05-20T21:31:01.023
> 
> 标签：java, android, mobile

我发现检索 MCC 和 MNC 的唯一方法是覆盖活动的 onConfigurationChanged 方法，如下所示：

```
public void onConfigurationChanged(Configuration config)
{
    super.onConfigurationChanged(config);
    DeviceData.MCC = "" + config.mcc;
    DeviceData.MNC = ""  +config.mnc;
} 
```

但是，一旦应用程序启动，我就需要这些数据，并且不能等待用户切换手机的方向或等价物来触发此方法。有没有更好的方法来访问当前的配置对象？

* * *

## 回答 #1

> 赞同：96
> 
> 时间：2009-05-21T00:46:14.873

[TelephonyManager](http://developer.android.com/reference/android/telephony/TelephonyManager.html "android.telephony.TelephonyManager")有一种方法可以将MCC+MNC 作为字符串 ( [getNetworkOperator()](http://developer.android.com/reference/android/telephony/TelephonyManager.html#getNetworkOperator() "获取网络运营商（）") ) 返回，这将满足您的需求。您可以通过以下方式访问它：

```
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    TelephonyManager tel = (TelephonyManager) getSystemService(Context.TELEPHONY_SERVICE);
    String networkOperator = tel.getNetworkOperator();

    if (!TextUtils.isEmpty(networkOperator)) {
        int mcc = Integer.parseInt(networkOperator.substring(0, 3));
        int mnc = Integer.parseInt(networkOperator.substring(3));
    }
} 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2010-10-04T20:07:09.047

您知道有两个 MCC/MNC 用于活动电话吗？（一个是 SIM 卡的国家代码和运营商 ID，另一个是正在使用的网络/基站。）

如果`getResources().getConfiguration().mcc`在飞行模式下不为空，则它是`Sim`value `TelephonyManager.getSimOperator()`，而不是`tower`value `TelephonyManager.getNetworkOperator()`。

`getConfiguration`我不知道 OP 想要哪个，但如果真的是`Sim`值，答案 3 会给他与原始代码不同的结果。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2011-11-16T05:04:08.253

`getResources().getConfiguration().mcc`是一个糟糕的选择，因为它返回一个整数，因此会影响有效值，例如`01`, 或`044`. 显然整数不是一个好的选择。

请参阅[Mobile_Network_Code中的详细信息](http://en.wikipedia.org/wiki/Mobile_Network_Code)

更新：在澳大利亚，我们在这里验证了一个错误的案例。`getNetworkOperator`返回与 不同的值`getSimOperator`，后者是正确的。

请参阅 Android 文档中的详细信息：[TelephonyManager](http://developer.android.com/reference/android/telephony/TelephonyManager.html)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-10-11T21:55:42.570

`getResources().getConfiguration()`您可以通过这个技巧访问当前配置。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-09-21T21:44:36.273

好的，事实证明 getResources().getConfiguration().mcc 技巧对于大多数用途可能更好，因为如果人们将手机置于飞行模式或以其他方式使用 Wi-Fi，那么它会返回一个空的中冶。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-12-30T03:23:02.467

我发现`65@5`即使插入了SIM卡，网络运营商有时也会像未连接到运营商（服务不可用）时一样。这发生在运行 Android 4.1.2 的三星 S2 上。

![在此处输入图像描述](https://i.stack.imgur.com/ROFEL.jpg)

所以在转换为 Int 时必须小心。

```
 int mcc = Integer.parseInt(networkOperator.substring(0, 3)); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-03-07T13:39:52.143

**这是更新的。用这个**

```
 TelephonyManager tel = (TelephonyManager) getSystemService(Context.TELEPHONY_SERVICE);
    String networkOperator = tel.getSimOperator();
    System.out.println("************mnc,mcc"+networkOperator);
    if (!TextUtils.isEmpty(networkOperator)) {
         mcc = networkOperator.substring(0, 3);
       mnc = networkOperator.substring(3);System.out.println("************mnc,mcc"+mnc+mcc);
    }mnc_mcc.setText("************mnc,mcc"+mnc+","+mcc);
} 
```

# bash - 无法在 Bash 中向您的命令添加参数

> ID：890368
> 
> 赞同：0
> 
> 时间：2009-05-20T21:32:02.050
> 
> 标签：bash, parameters

我有以下代码，我称之为谷歌

```
#!/bin/bash

q=$1
open "http://www.google.com/search?q=$q" 
```

它使用关键字打开 Firefox。例如，通过

```
google cabal 
```

当我在命令后放置参数时，我希望将特定的键盘添加到命令中。下面是一个例子

```
google -x cabal 
```

例如，它搜索序列

```
"cabal is" 
```

**如何在 Bash 中为命令添加参数？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-20T21:39:23.783

```
#!/bin/bash
while getopts "x:" option; do
  case "$option" in
    x) keyword="$OPTARG";;
  esac
done
#echo "$keyword"
open "http://www.google.com/search?q=$keyword" 
```

: 指定在 x 之后是预期的参数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-09T03:13:28.217

由于您有两个信息来源（搜索词和修饰符），我将使用以下内容。它允许使用单个修饰符（`-x`用于附加“is”并将整个内容括在引号中，`-d`用于前缀“define：”并将整个内容括在引号中，以及`-w`简单地添加搜索词以将您限制在维基百科中）。

请注意，引号的位置由修饰符控制，因为它可能需要引用传递给 Google 的参数或在该参数之外添加搜索词。您可以完全控制 URL 中生成的内容（确保在运送到生产环境之前将其`echo`转回）。`open`

```
#!/bin/bash
prepend=""
append=""
case "$1" in
    -h)
        echo 'Usage: google [-{hxdw}] [<arg>]'
        echo '       -h: show help.'
        echo '       -x: search for "<arg> is"'
        echo '       -d: search for "define:<arg>"'
        echo '       -w: search for <arg> site:wikipedia.org'
        exit;;

    -x)
        prepend="\""
        append=" is\""
        shift;;
    -d)
        prepend="\"define:"
        append="\""
        shift;;
    -w)
        prepend=""
        append=" site:.wikipedia.org"
        shift;;
esac
if [[ -z "$1" ]] ; then
    query=""
else
    query="?q=${prepend}${1}${append}"
fi
echo http://www.google.com/search${query} 
```

这是一些示例输出：

```
pax> google -w "\"bubble sort\""
http://www.google.com/search?q="bubble sort" site:.wikipedia.org

pax> google cabal
http://www.google.com/search?q=cabal

pax> google
http://www.google.com/search

pax> google -d cabal
http://www.google.com/search?q="define:cabal"

pax> google -x wiki
http://www.google.com/search?q="wiki is"

pax> google -h wiki
Usage: google [-{hxdw}] [<arg>]
       -h: show help.
       -x: search for "<arg> is"
       -d: search for "define:<arg>"
       -w: search for <arg> site:wikipedia.org 
```

如果您不提供搜索词，您只会得到 Google 搜索页面。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-22T02:59:44.067

```
#!/usr/bin/env bash

while [[ $1 = - ]]; do
    case $1 in
        -x) shift; query+=" $1 is"     ;;
        -d) shift; query+=" define:$1" ;;
        -s) shift; query+=" site:$1"   ;;
        -t) shift; query+=" title:$1"   ;;
        -i) params+="&btnI"            ;;
        # ...
        -h)
            echo "usage: ${0##*/} [-x arg] [-d arg] [-s arg] [-t arg] [-ih]"
            echo
            echo "    -x: Add '[arg] is' to the google query."
            echo "    -d: Add 'define:[arg]' to the google query."
            echo "    -s: Add 'site:[arg]' to the google query."
            echo "    -t: Add 'title:[arg]' to the google query."
            echo "    -i: Do an I'm Feeling Lucky-search."
            echo "    -h: Show this help text."
            exit ;;
    esac
    shift
done

query+="$*" # implode all other arguments into the query string.

open "http://www.google.com/search?q=$query$params" 
```

# unix - 如何使用 rpm 部署本地应用程序？

> ID：890369
> 
> 赞同：2
> 
> 时间：2009-05-20T21:32:20.897
> 
> 标签：unix, deployment, installation, uninstallation, rpm

这是我的场景

*   我们的团队在**AIX上开发**
*   几十个应用程序，主要是 Perl、shell 脚本、批处理 java、C
*   我想简化部署/回滚程序 - 目前使用带有备份的普通旧 tarball
*   我研究了 installp 与 rpm 进行打包（请参阅[我的 SO 问题](https://stackoverflow.com/questions/865049/aix-deployment-installp-or-rpm)）并决定使用**rpm** - 更好的文档，再加上 IBM 在拥有自己的打包工具的同时包含了它，所以这对我来说是一个正当的理由
*   我想使用一个单独的 rpm 数据库，而不是主要的 - 因为我没有**root**访问权限，而且我也觉得将操作系统应用程序与我们的东西分开是有益的。

* * *

工作**流程**如下所示：

*   每个应用程序都有一个相应的 rpm.spec - 签入源代码控制
*   在主目录中构建 rpm
*   **在使用我们自己的packages.rpm**时安装/升级

 ***注意：我会用这个问题作为我自己的笔记*

* * *

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-20T21:36:24.617

在我家建立 rpm：

**1** .

我需要一个**.rpmmacros**文件在我的用户根目录中，它会覆盖一些系统范围的 rpm 设置

```
%_signature gpg
%_gpg_name {yourname}
%_gpg_path ~/.gnupg
%distribution AIX 5.3
%vendor {Northwind? :)}
%make   make 
```

**2** .

这将创建 rpm 构建所需的目录结构，它还将更新**.rpmmacros**

```
#!/bin/sh

[ "x$1" = "x-d" ] && {
DEBUG="y"
export DEBUG
shift 1
}

IAM=`id -un`
PASSWDDIR=`grep ^$IAM: /etc/passwd | awk -F":" '{print $6}'`
HOMEDIR=${HOME:=$PASSWDDIR}

[ ! -d $HOMEDIR ] && {
echo "ERROR: Home directory for user $IAM not found in /etc/passwd."
exit 1
}

RHDIR="$HOMEDIR/rpmbuild"
RPMMACROS="$HOMEDIR/.rpmmacros"
touch $RPMMACROS

TOPDIR="%_topdir"
ISTOP=`grep -c ^$TOPDIR $RPMMACROS`
[ $ISTOP -lt 1 ] && {
echo "%_topdir      $HOMEDIR/rpmbuild" >> $RPMMACROS
}

TMPPATH="%_tmppath"
ISTMP=`grep -c ^$TMPPATH $RPMMACROS`
[ $ISTMP -lt 1 ] && {
echo "%_tmppath $HOMEDIR/rpmbuild/tmp" >> $RPMMACROS
}

[ "x$DEBUG" != "x" ] && {
echo "$IAM       $HOMEDIR    $RPMMACROS"
echo "$RHDIR     $TOPDIR     $ISTOP"
}

[ ! -d $RHDIR ] && mkdir -p $RHDIR

cd $RHDIR 
for i in RPMS SOURCES SPECS SRPMS BUILD tmp ; do 
[ ! -d ./$i ] && mkdir ./$i 
done

exit 0 
```

您可以使用以下命令检查 rpm 是否接收到您的更改：

```
rpm --showrc | grep topdir 
```

**3.**

指定 RPM 数据库的非默认位置，例如：

```
rpm --dbpath /location/of/your/rpm/database --initdb 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-15T15:14:07.370

我通常将我的规范文件检入到我的代码所在的同一个地方。

我每天晚上运行一个构建服务器（我使用 Hudson）来启动一个构建（可能是连续的，但我选择了每晚）。构建服务器检出代码，构建它，然后运行 ​​rpmbuild。Hudson 设置了一个可以在每次构建后删除的工作区文件夹，因此如果您将 %_topdir 设置为指向该区域，那么您可以保证不会有以前构建留下的构建工件。在构建结束时，我使用包含构建号的注释将我的 rpms 检查到版本控制中。

回滚就是从版本控制中取出最后一个好的 rpm，删除当前的 rpm，并安装旧的 rpm。

听起来您已经很好地处理了使用自己的包 db。

# c++ - 如何按对象的浮点值对对象 std::vector 进行排序

> ID：890371
> 
> 赞同：5
> 
> 时间：2009-05-20T21:33:02.017
> 
> 标签：c++, stl, vector

我有一个 C++ std::vector 表示为：

```
std::vector<GameObject*> vectorToSort; 
```

vectorToSort 中的每个对象都包含一个浮点参数，该参数通过调用“DistanceFromCamera()”返回：

```
vectorToSort.at(position)->DistanceFromCamera(); 
```

我希望通过这个浮点参数对向量进行排序，但是 std::sort 似乎无法做到这一点。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-20T21:35:57.190

你想使用这样的谓词：

```
struct VectorSortP {
    bool operator()(const GameObject *a, const GameObject *b) const {
        return a->DistanceFromCamera() < b->DistanceFromCamera();
    }
};

std::sort(vectorToSort.begin(), vectorToSort.end(), VectorSortP()); 
```

# c# - 向 ASP.NET 中的页眉添加控件

> ID：890376
> 
> 赞同：6
> 
> 时间：2009-05-20T21:33:52.920
> 
> 标签：c#, asp.net, custom-controls

我正在 ASP.NET 中创建自定义脚本控件

控件的目的只是标签的服务器变体，用于加载 javascript 文件 然而，此控件的主要目的是将多个脚本组合成一个响应，因此在客户端他们看到每个位置的标签之类的东西，所以所有在 DocumentTop 位置注册的脚本将组合成一个标记，但位置“内联”除外，所有内联脚本都在标记中存在的位置单独呈现我还创建了一个 httphandler，js.ashx，它确实脚本的组合

除了“头”位置外，一切都工作正常，对于两个文档位置，我只是在预渲染期间使用 ClientScriptManager，但对于头位置，我在预渲染期间尝试了以下代码

```
var scriptControl = new HtmlGenericControl("script");
scriptControl.Attributes["language"] = "javascript";
scriptControl.Attributes["type"] = "text/javascript";
scriptControl.Attributes["src"] = src;
Page.Header.Controls.Add(scriptControl); 
```

我收到以下错误：在 DataBind、Init、Load、PreRender 或 Unload 阶段无法修改控件集合。

有谁知道如何从自定义控件中向页眉添加控件？

顺便说一句，该控件用于具有两个嵌套母版并且在根母版上注册的 ScriptManager 的内容页面。该项目是一个asp.net 3.5 web应用项目

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-20T22:40:26.657

我发现了我的问题的答案。

我不太明白为什么，但问题在于当我尝试将脚本控件添加到头部时，在控件的 PreRender 事件中执行此操作会导致我的错误，但如果您在页面的 PreRender 事件期间添加控件，则一切正常很好，花花公子，例如：

```
protected override void OnInit(EventArgs e)
{
    base.OnInit(e);
    this.Page.PreRender += new EventHandler(Page_PreRender);
}

void Page_PreRender(object sender, EventArgs e)
{
    var scriptControl = new HtmlGenericControl("script");
    Page.Header.Controls.Add(scriptControl);
    scriptControl.Attributes["language"] = "javascript";
    scriptControl.Attributes["type"] = "text/javascript";
    scriptControl.Attributes["src"] = "blah.js";
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-20T21:39:53.877

我不知道你为什么会收到这个错误，但是像这样使用[ClientScript](http://msdn.microsoft.com/en-us/library/system.web.ui.page.clientscript.aspx)怎么样：

```
protected void Page_Load(object sender, EventArgs e)
{
    string scriptFile = "myscriptFile.js";

    if (!this.Page.ClientScript.IsClientScriptIncludeRegistered("myScript"))
    {
        this.Page.ClientScript.RegisterClientScriptInclude("myScript", scriptFile);
    }
} 
```

[ClientScriptManager.RegisterClientScriptInclude 方法](http://msdn.microsoft.com/en-us/library/2552td66.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-21T12:34:47.203

```
protected override void OnInit(EventArgs e)
{
    EnsureChildControls();
    base.OnInit(e);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-11-03T23:37:55.123

```
 protected void Page_Load(object sender, EventArgs e)
    {        
        HtmlGenericControl js = new HtmlGenericControl("script");
        js.Attributes["type"] = "text/javascript";
        js.Attributes["src"] = yol.ScriptYol("jquery-1.3.2.min.js");
        this.Page.Header.Controls.Add(js);

    } 
```

# javascript - 是否有关于在 Javascript 框架之间进行转换的指南？

> ID：890379
> 
> 赞同：4
> 
> 时间：2009-05-20T21:34:08.707
> 
> 标签：javascript, mootools, prototypejs, javascript-framework, porting

我有一个为 MooTools 编写的日期选择器库，我想移植到 Prototype。这看起来是一项长期艰巨的任务，我想知道是否有人看过或写过关于两者之间差异的指南。各种翻译词典，我可以在其中查找 Moo 函数并查看原型等效项，反之亦然。

jQuery to Prototype 也是如此。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-20T22:49:14.500

我会试一试。如果你在彻底的谷歌搜索后没有找到任何资源，我会说你只需要打开每个 API 并来回咨询它们并查看示例。

实际上，我现在正在一个项目中从 Prototype 转到 jQuery。（顺便说一句：我对 jQuery 使用了一段时间感到更满意。）我的基本工作流程只是根据需要引用 API。

如果有这样的一个映射到另一个，我会感到惊讶。在这两种框架中，都有很多方法可以完成任何给定的任务，最重要的是，它们以不同且重要的方式工作。当然有一些 1:1 的对应关系，例如“addClass”与“addClassName”，但 jQuery DOM 操作通常适用于元素集（可能只是一组 1），而 Prototype 则适用于单个元素（可能由每个语句都与集合一起使用）。

幸运的是，两者都有很好且易于使用/参考的 API。

祝你好运。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-11-07T07:15:57.710

我一直想找到这样的东西。所以我想自己做一个，几周前我开始了[ArtLung Rosetta](http://github.com/artlung/Artlung-Rosetta/)，努力在许多主要库中创建一个包含各种技术的“Hello World”页面。这是一项正在进行的工作。

**然而，**几周前我偶然发现了 **Matthias Schütz**的这个优秀资源。**[JavaScript 库比较矩阵](http://matthiasschuetz.com/javascript-framework-matrix/en/)**。该参考站点与相关文档的链接进行了语法比较：[DOM Ready](http://matthiasschuetz.com/javascript-framework-matrix/en/dom-ready)、[DOM Basics](http://matthiasschuetz.com/javascript-framework-matrix/en/dom-basics)、[DOM Filtering](http://matthiasschuetz.com/javascript-framework-matrix/en/dom-filtering)、[DOM Manipulation](http://matthiasschuetz.com/javascript-framework-matrix/en/dom-manipulation)、[Effects](http://matthiasschuetz.com/javascript-framework-matrix/en/effects)、[Transitions](http://matthiasschuetz.com/javascript-framework-matrix/en/transitions)、[Events](http://matthiasschuetz.com/javascript-framework-matrix/en/events)、[Custom Functions](http://matthiasschuetz.com/javascript-framework-matrix/en/custom-functions)、[Ajax](http://matthiasschuetz.com/javascript-framework-matrix/en/ajax)和[Classes](http://matthiasschuetz.com/javascript-framework-matrix/en/classes)。

我喜欢比较各种库方法——我发现我学到了很多关于库本身、我自己的编程风格以及如何通过在多个框架中执行相同任务来改进它的知识。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-29T22:47:36.063

正如 Keith 所说，库提供的功能之间没有 1:1 的对应关系。

更重要的是：不同的框架需要不同的心态。重命名函数很少，更多的是以另一个框架的风格编写代码。像“做这件事的 jQuery 方式是什么？”这样思考。

如果您将代码从框架 A 移植到 B 并且不太了解 B，那么您很容易得到一些非常丑陋的东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-29T23:15:01.983

我想不出任何关于转换的指南。但是有一些 Library1 与 Library2 的博客文章对库进行了比较和对比。可能值得追捕并阅读它们。

# c# - 如何在不加载内容的情况下计算 EntityFramework 中的行？

> ID：890381
> 
> 赞同：129
> 
> 时间：2009-05-20T21:35:16.990
> 
> 标签：c#, database, entity-framework

我正在尝试确定如何使用 EntityFramework***计算***表上的匹配行。

问题是每一行可能有许多兆字节的数据（在二进制字段中）。当然，SQL 应该是这样的：

```
SELECT COUNT(*) FROM [MyTable] WHERE [fkID] = '1'; 
```

我可以加载所有的行，*然后*找到计数：

```
var owner = context.MyContainer.Where(t => t.ID == '1');
owner.MyTable.Load();
var count = owner.MyTable.Count(); 
```

但这是非常低效的。有没有更简单的方法？

* * *

编辑：谢谢，所有。我已将数据库从私人附件中移出，以便我可以运行分析；这会有所帮助，但会引起我没想到的混乱。

我的真实数据更深一些，我将使用载有**物品****托盘**的**卡车**——我不希望**卡车**离开，除非其中至少有**一件****物品**。

 ******我的尝试如下所示。我不明白的部分是 CASE_2 从不访问数据库服务器（MSSQL）。

```
var truck = context.Truck.FirstOrDefault(t => (t.ID == truckID));
if (truck == null)
    return "Invalid Truck ID: " + truckID;
var dlist = from t in ve.Truck
    where t.ID == truckID
    select t.Driver;
if (dlist.Count() == 0)
    return "No Driver for this Truck";

var plist = from t in ve.Truck where t.ID == truckID
    from r in t.Pallet select r;
if (plist.Count() == 0)
    return "No Pallets are in this Truck";
#if CASE_1
/// This works fine (using 'plist'):
var list1 = from r in plist
    from c in r.Case
    from i in c.Item
    select i;
if (list1.Count() == 0)
    return "No Items are in the Truck";
#endif

#if CASE_2
/// This never executes any SQL on the server.
var list2 = from r in truck.Pallet
        from c in r.Case
        from i in c.Item
        select i;
bool ok = (list.Count() > 0);
if (!ok)
    return "No Items are in the Truck";
#endif

#if CASE_3
/// Forced loading also works, as stated in the OP...
bool ok = false;
foreach (var pallet in truck.Pallet) {
    pallet.Case.Load();
    foreach (var kase in pallet.Case) {
        kase.Item.Load();
        var item = kase.Item.FirstOrDefault();
        if (item != null) {
            ok = true;
            break;
        }
    }
    if (ok) break;
}
if (!ok)
    return "No Items are in the Truck";
#endif 
```

CASE_1 产生的 SQL 通过**sp_executesql**进行管道传输，但是：

```
SELECT [Project1].[C1] AS [C1]
FROM   ( SELECT cast(1 as bit) AS X ) AS [SingleRowTable1]
LEFT OUTER JOIN  (SELECT 
    [GroupBy1].[A1] AS [C1]
    FROM ( SELECT 
        COUNT(cast(1 as bit)) AS [A1]
        FROM   [dbo].[PalletTruckMap] AS [Extent1]
        INNER JOIN [dbo].[PalletCaseMap] AS [Extent2] ON [Extent1].[PalletID] = [Extent2].[PalletID]
        INNER JOIN [dbo].[Item] AS [Extent3] ON [Extent2].[CaseID] = [Extent3].[CaseID]
        WHERE [Extent1].[TruckID] = '....'
    )  AS [GroupBy1] ) AS [Project1] ON 1 = 1 
```

[*我真的没有卡车、司机、托盘、箱子或物品；正如您从 SQL 中看到的，Truck-Pallet 和 Pallet-Case 关系是多对多的——尽管我认为这并不重要。我的实物是无形的，更难描述，所以我改了名字。*]

* * *

## 回答 #1

> 赞同：138
> 
> 时间：2009-05-20T21:46:36.063

查询语法：

```
var count = (from o in context.MyContainer
             where o.ID == '1'
             from t in o.MyTable
             select t).Count(); 
```

方法语法：

```
var count = context.MyContainer
            .Where(o => o.ID == '1')
            .SelectMany(o => o.MyTable)
            .Count() 
```

两者都生成相同的 SQL 查询。

* * *

## 回答 #2

> 赞同：55
> 
> 时间：2009-05-20T21:42:45.743

我想你想要类似的东西

```
var count = context.MyTable.Count(t => t.MyContainer.ID == '1'); 
```

（编辑以反映评论）

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2014-01-23T17:04:34.090

据我了解，所选答案仍会加载所有相关测试。根据this msdn blog，有更好的方法。

[http://blogs.msdn.com/b/adonet/archive/2011/01/31/using-dbcontext-in-ef-feature-ctp5-part-6-loading-related-entities.aspx](http://blogs.msdn.com/b/adonet/archive/2011/01/31/using-dbcontext-in-ef-feature-ctp5-part-6-loading-related-entities.aspx)

具体来说

```
using (var context = new UnicornsContext())

    var princess = context.Princesses.Find(1);

    // Count how many unicorns the princess owns 
    var unicornHaul = context.Entry(princess)
                      .Collection(p => p.Unicorns)
                      .Query()
                      .Count();
} 
```

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2016-06-24T13:53:03.470

这是我的代码：

```
IQueryable<AuctionRecord> records = db.AuctionRecord;
var count = records.Count(); 
```

确保变量定义为 IQueryable 然后当您使用 Count() 方法时，EF 将执行类似

```
select count(*) from ... 
```

否则，如果记录定义为 IEnumerable，则生成的 sql 将查询整个表并计算返回的行数。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2009-05-21T08:44:16.120

好吧，即使`SELECT COUNT(*) FROM Table`是效率也相当低，尤其是在大型表上，因为 SQL Server 除了进行全表扫描（聚集索引扫描）之外什么都做不了。

有时，知道数据库中的大致行数就足够了，在这种情况下，这样的语句可能就足够了：

```
SELECT 
    SUM(used_page_count) * 8 AS SizeKB,
    SUM(row_count) AS [RowCount], 
    OBJECT_NAME(OBJECT_ID) AS TableName
FROM 
    sys.dm_db_partition_stats
WHERE 
    OBJECT_ID = OBJECT_ID('YourTableNameHere')
    AND (index_id = 0 OR index_id = 1)
GROUP BY 
    OBJECT_ID 
```

这将检查动态管理视图并从中提取行数和给定特定表的表大小。它通过汇总堆 (index_id = 0) 或聚集索引 (index_id = 1) 的条目来实现。

它快速、易于使用，但不能保证 100% 准确或最新。但在许多情况下，这已经“足够好”了（并且给服务器带来的负担要少得多）。

也许这对你也有用？当然，要在 EF 中使用它，您必须将其包装在存储过程中或使用直接的“执行 SQL 查询”调用。

马克

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2012-05-03T18:27:26.963

使用实体上下文的***ExecuteStoreQuery***方法。这避免了下载整个结果集并反序列化为对象以进行简单的行计数。

```
 int count;

    using (var db = new MyDatabase()){
      string sql = "SELECT COUNT(*) FROM MyTable where FkId = {0}";

      object[] myParams = {1};
      var cntQuery = db.ExecuteStoreQuery<int>(sql, myParams);

      count = cntQuery.First<int>();
    } 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-05-20T21:43:34.697

我认为这应该工作......

```
var query = from m in context.MyTable
            where m.MyContainerId == '1' // or what ever the foreign key name is...
            select m;

var count = query.Count(); 
```

# jboss - 重试过期后如何从 JBoss 4.2.2 消息队列重新发送消息

> ID：890384
> 
> 赞同：0
> 
> 时间：2009-05-20T21:35:59.860
> 
> 标签：jboss, jms, jbossmq

有没有办法在 JBoss 4.2.2 消息队列中重新发送过期消息？问题是他们超过了他们的重试数量，但现在问题已经解决了，有没有办法重新发送他们？

在 JBoss 3 中，它们只是可以移动的文本文件。既然它存储在数据库中，你怎么能做到呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-20T21:48:23.220

看看[Hermes JMS](http://www.hermesjms.com)。它是一个用于浏览 JMS 队列和主题的开源工具。它可以重播最终出现在代理的无法投递队列中的消息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T17:01:51.920

这就是我最终做的事情：

```
 Hashtable t = new Hashtable();
    t.put(Context.PROVIDER_URL, "localhost:1099");
    t.put(Context.INITIAL_CONTEXT_FACTORY, "org.jnp.interfaces.NamingContextFactory");
    Context ctx = new InitialContext(t);
    Queue q = (Queue) ctx.lookup("/queue/DLQ");
    //----------------------------
    ConnectionFactory cf = (ConnectionFactory) ctx.lookup("/ConnectionFactory");
    Connection connection = cf.createConnection();
    Session session = connection.createSession(true, 0);
    //---------------------------------
    MessageConsumer consumer = session.createConsumer(q);
    connection.start();
    SpyObjectMessage m;

    Queue originialDestination = null;
//There can only be one in my case, but really you have to look it up every time.
    MessageProducer producer = null;
    while ((m = (SpyObjectMessage) consumer.receive(5000)) != null) {
        Object o = m.getObject();
        Date messageDate = new Date(m.getJMSTimestamp());
        String originalQueue = m.getStringProperty("JBOSS_ORIG_DESTINATION");
            if (originialDestination == null) {
                originialDestination = (Queue) ctx.lookup("/queue/" +
 originalQueue.substring(originalQueue.indexOf('.') + 1));
                producer = session.createProducer(originialDestination);
            }
            producer.send(session.createObjectMessage((Serializable) o));
      m.acknowledge();
    }
    //session.commit();    //Uncomment to make this real.
    connection.close();
    ctx.close(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-05T15:22:15.080

注意：我为 CodeStreet 工作

我们的“ReplayService for JMS”产品正是为这个用例而构建的：搜索和检索以前发布的消息（n 次交付）- JMS 确实是为 1 次交付而设计的。

使用 ReplayService for JMS，您可以配置 WebLogic 记录以记录发布到您的主题或队列的所有消息。通过基于 Web 的 GUI，您可以搜索单个消息（通过子字符串、XPath 或 JMS 选择器），然后再次将它们重播到原始 JMS 目标。

有关详细信息，请参阅[http://www.codestreet.com/marketdata/jms/jms_details.php](http://www.codestreet.com/marketdata/jms/jms_details.php)。

# sharepoint - 所有大写字母的 Sharepoint 导航 URL

> ID：890393
> 
> 赞同：0
> 
> 时间：2009-05-20T21:39:10.057
> 
> 标签：sharepoint

我不时看到这种行为，当从导航链接时，网站的 URL 将全部采用大写字母。该站点的名称并非全部大写，并且在大多数情况下，URL 的大小写都是正确的。全大写处理似乎来来去去，与任何事物无关。有没有其他人看到它或知道如何阻止它发生？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-12-04T09:40:29.467

我自己刚刚调查过这个。它是内部缓存的一部分；sharepoint 将部分链接转换为大写，以使比较不区分大小写。据我所知，您对此无能为力。

[http://support.microsoft.com/kb/953457](http://support.microsoft.com/kb/953457)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T06:25:16.060

检查网站的欢迎页面设置 - 这是导航中使用的链接的来源。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-20T23:31:54.180

我已经看到了......我的开发团队在创建自定义导航提供程序并需要检查 URL 中的值时导致了它。他们将 URL 转换为全大写，以便更容易找到字符串。

# .net - Click-Once - 如何加密连接字符串

> ID：890396
> 
> 赞同：7
> 
> 时间：2009-05-20T21:39:36.840
> 
> 标签：.net, wpf, encryption, clickonce, connection-string

我有一个 WPF 应用程序，其连接字符串存储在 App.config 中。在单击一次部署中加密这些连接字符串的最佳方法是什么？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-21T03:06:04.250

如果这是一个将由应用程序实例在单台计算机（不跨多台计算机共享）上配置和使用的连接字符串，则可以使用 DPAPI（数据保护 API）的 .NET 托管包装器 - [ProtectedData 类](http://msdn.microsoft.com/en-us/library/system.security.cryptography.protecteddata.aspx)（系统.安全.密码学）。

您还可以使用的一个巧妙技巧（如果您决定使用此类）是创建用于编码和解码字符串的扩展方法，因此操作变得如此简单：

```
string encodedString = myConnectionString.EncodeString();

string decodedString = encodedString.DecodeString(); 
```

希望这可以帮助！

# asp.net-mvc - 在 MVC 应用程序中强制执行静态路由有什么好处？

> ID：890400
> 
> 赞同：2
> 
> 时间：2009-05-20T21:40:33.437
> 
> 标签：asp.net-mvc, ajax, rest

我一直在玩弄 MvcContrib 附加组件附带的 SimplyRestfulRouting 程序集，而且在大多数情况下，我真的很喜欢它可以快速设置我的路线并让我在我的控制器中遵循一个很好的约定。但是，我仍在尝试围绕 REST 进行研究，因为它适用于富 Internet 应用程序，并且当我需要做一些超出这 8 或 9 个默认路由范围的事情时，我偶尔会感到束手无策。[编辑：通过“鸽子洞”，我的意思是当我必须创建一个超出默认“宁静路线”定义的控制器操作时，我觉得我正在弄脏应用程序。]

我听到了一位 REST 支持者的评论，他在其中陈述了他的观点，即 MVC 框架本质上是 RESTful，这让我对 MvcContrib SimplyRestfulRouting 之类的库实际上在购买我有了更多的思考。

没有阅读很多关于 REST 的具体原则的信息，我正在寻找关于在表单优于数据 RIA 的上下文中执行这样的事情可能会带来什么好处的输入。关于 AJAX，RESTful 架构如何影响我的客户端交互？

在这种情况下，我很可能误解了 REST 的使用，并且希望有一些 StackOverflow 的魔力让我直截了当。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-20T22:01:35.597

无论使用何种框架，我在执行 RESTful 路由时看到的主要好处是一致性。您将始终能够知道该 API 如何适用于任何资源，这实际上将为您提供一个自记录 API。

它还在构建应用程序时提供了一个很好的约束。与其拥有一个可能很快变得复杂的空白的 API，不如将路由限制在基础知识上，这将为您提供有关需要创建哪些资源的指导。

有关 REST 的更多基本原则，我建议阅读此[线程](https://stackoverflow.com/questions/671118/what-exactly-is-restful-programming)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T13:40:07.417

好处是，如果你有一些地址并且从那个地址你得到一些东西，那么你可以从你想要的代码中的任何地方调用那个地址，你会得到完全相同的东西:)

在具体的例子中，如果你的路由可以返回一些完整的 html 数据（例如用户控件），那么你可以从 ajax、桌面应用程序甚至 Web 服务调用它......它非常强大，因为您将在您的应用程序上重复一些功能......并且因为您从该 restful 服务中获得的一些 html 为您提供了一个具有完全相同功能的视图，您可以从对话框或页面或桌面应用程序或从动态调用它任何地方...当您添加到此地址时，您可以使用参数调用此地址，就像某些方法一样，您现在可以看到它在创建动态页面和网站/系统方面的强大功能

希望这可以帮助

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-20T22:57:35.420

RESTful 不仅仅是拥有干净的 URL。

在架构级别，REST 是关于根据**资源**组织应用程序功能，并在它们上公开一组**固定且统一**的 CRUD 操作（例如 HTTP POST/GET/PUT/DELETE 方法）。这被称为[面向资源的架构](http://en.wikipedia.org/wiki/Resource_oriented_architecture)。

相反，使用[面向服务的体系结构，您通常根据](http://en.wikipedia.org/wiki/Service-oriented_architecture)**流程**或组件来组织应用程序功能，并在它们上公开**非统一的、应用程序特定的方法**（例如通过 SOAP）。

请注意，您可以拥有干净的 URL，但最终仍然遵循非 RESTful SOA 设计原则。

更新：对不起，没有真正回答这个问题，挂断了使用“RESTful”术语。如果您只是在谈论干净 URL 的好处（除了 REST/SOA 参数），典型的参数是更好的 SEO 优化和用户友好性（用户可以更好地理解和修改 URL）。

# c# - Silverlight 2：动态创建的对象上的 INotifyPropertyChanged？

> ID：890401
> 
> 赞同：2
> 
> 时间：2009-05-20T21:41:48.427
> 
> 标签：c#, silverlight, reflection, dynamic

[这与我之前提出](https://stackoverflow.com/questions/866725/c-inotifypropertychanged-on-properties-of-a-dynamically-created-object)的问题相同，但一个是针对普通 C# 的。这是 Silverlight 2，我没有**ICustomTypeDescriptor**

所以这里又是一个问题：

我有，说几个开关面板（对于那些喜欢类比的人）。这些开关面板中的每一个都具有名称（字符串）可以处于开或关状态（布尔）的开关。开关面板和开关是具有 INotify 接口的对象。

使用开关名称，我在集合上创建了所有可能的开关名称的列表，并创建了一个具有所有这些名称作为属性的动态类。

```
SwitchPanel1 (Switches( Switch1 ("Main",On) , Switch2("Slave",Off)))
SwitchPanel2 (Switches( Switch1 ("Bilge",On) , Switch2("Main",Off))) 
```

产生一个集合

```
(Main,Bilge,Slave) 
```

并生成具有以下属性的动态类：

```
SwitchPanel : (SwitchPanel)
Main : (Switch)
Bilge : (Switch)
Slave: (Switch) 
```

这个想法是，如果开关面板有一个带有属性名称的开关，它将被放置在该属性上。所以使用一点 linq

```
propeties["Main"].SetValue(newSwitchType,SwitchPanel.Switches.FirstOrDefault(sw => sw.Name == "Main")); 
```

我想将这个新的动态类转换为 INotfyPropertyChanged 并捕获这些新属性的实际更改，因此如果开关更改状态，动态对象将报告它。

为什么？它需要显示在列表视图中，并且我正在使用的列表视图通过提供属性名称而不是绑定路径来绑定。

它还尝试通过将对象强制转换为 INotifyPropertyChanged 来捕获 INotify 事件。这意味着它会在事情发生变化时进行排序和/或分组。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-21T14:03:04.760

您可以创建一个派生的通用字符串字典，实现 INotifyPropertyChanged 的​​布尔值。索引器可能如下所示：

```
public new bool this[string key]
{
    get
    {
        if( this.ContainsKey(key))
           return base[key];
        return default(bool);
    }
    set
    {
        base[key] = value;
        OnPropertyChanged(key.ToString());
    }
} 
```

在您的开关面板中使用自定义 IValueConverter 将开关绑定到字典：

[http://silverlight.net/forums/t/51864.aspx](http://silverlight.net/forums/t/51864.aspx)

这样，您仍然可以拥有名称的动态集合，每个名称都有一个关联的 bool 值，并直接绑定到数据而无需创建动态类型。

# wpf - (WPF) 将两个类绑定到一个控件

> ID：890406
> 
> 赞同：0
> 
> 时间：2009-05-20T21:42:45.353
> 
> 标签：wpf, data-binding

我有两个视图模型。一个显示 IPAddresses 的集合，另一个显示具有许多参数的对象集合。这些参数之一是 IPAddress。所以，我有另一个面板绑定到第二个对象的属性。我想要一个组合框将 ItemSource 设置为第一个对象，但将所选项目绑定到第二个对象。但是，我似乎只能在代码后面的控件上设置一个数据上下文。有没有办法解决？如果可能的话，我宁愿在代码后面做这一切（我发现 xaml 编程充其量是不理想的），但我会接受任何事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-20T22:10:40.583

对于 ComboBox，将 IPAddresses 集合绑定到 ItemsSource 属性，并将 ComboBox 的 SelectedItem 绑定到“众多属性对象”集合的 SelectedItem 的 IPAddress 属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T02:36:56.273

看一下 Bindings 的[Source 属性](http://msdn.microsoft.com/en-us/library/system.windows.data.binding.source.aspx)。它基本上是特定绑定的 DataContext。它应该使您尝试做的事情变得非常简单，尤其是在代码后面。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-20T22:08:02.743

如果我对您的对象（包括名称）有更好的描述，这将更容易回答。但在我看来，您应该制作一个字典，其中 ipaddress 作为键，第二个对象作为值。

如果你能做到这一点，那么你可以像这样在代码中绑定它：

```
comboBox.ItemsSource = dictionary;
comboBox.DisplayMemberPath = "Key";
comboBox.SelectedValuePath = "Value"; 
```

这是假设您对集合中的每个 IPAddress 都有一个“第二个对象”。鉴于您的描述，这听起来很正确。

# php - 我如何加入 7 个表，其中一列（存在于所有表中）等于所有表中的相同内容？

> ID：890412
> 
> 赞同：0
> 
> 时间：2009-05-20T21:43:56.800
> 
> 标签：php, mysql

我已经看到如何内部连接 ​​2 个表，其中一列等于另一列中的内容。但我如何用 7 张桌子做到这一点？

谢谢大家，我想了很久之后大声笑。这似乎有效

```
SELECT *
FROM
  tbl_school
  INNER JOIN tbl_apprequirments ON (tbl_school.schoolname = tbl_apprequirments.schoolname)
  INNER JOIN tbl_citygallery ON (tbl_apprequirments.schoolname = tbl_citygallery.schoolname)
  INNER JOIN tbl_schoolgallery ON (tbl_citygallery.schoolname = tbl_schoolgallery.schoolname)
  INNER JOIN tbl_livingexp ON (tbl_schoolgallery.schoolname = tbl_livingexp.schoolname)
  INNER JOIN tbl_tuition ON (tbl_livingexp.schoolname = tbl_tuition.schoolname)

  where tbl_school.schoolname = 'glendale community college'; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-20T21:51:11.967

```
SELECT * FROM t1 JOIN t2 JOIN t3 JOIN t4 JOIN t5
  ON (t2.c=t1.c AND t3.c=t1.c AND t4.c=t1.c AND t5.c=t1.c) 
```

MySQL为此提供了一个简写：

```
SELECT * FROM t1 JOIN (t2, t3, t4, t5)
  ON (t2.c=t1.c AND t3.c=t1.c AND t4.c=t1.c AND t5.c=t1.c) 
```

此示例适用于 5 个表。您可以根据需要重复。

请参阅 MySQL 的[连接语法](http://dev.mysql.com/doc/refman/5.0/en/join.html)。

编辑：在看到 sarmenhb 的澄清后，我认为这个查询也有效：

```
SELECT * FROM t1 JOIN (t2, t3, t4, t5, t6, t7)
  USING (schoolname)
  WHERE t1.schoolname = 'name' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-20T21:51:46.723

加入其中两个后，将第三个加入前两个，然后将第四个加入前三个，依此类推，

```
 Select *
   From T1 Join T2 On  <criteria>
           Join T3, on <criteria>
           Join T4 On <Criteria>
            etc... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-20T21:51:27.270

尝试这样的事情......

```
Select data
from table as tbl1
join as tbl2 on tbl2.data = tbl1.data
join as tbl3 on tbl3.data = tbl1.data 
```

这是你想要的？

# iphone - iPhone：使用 Core Animation 转换视图

> ID：890413
> 
> 赞同：1
> 
> 时间：2009-05-20T21:44:08.127
> 
> 标签：iphone, core-animation, objective-c, cocoa-touch

在 Mac 上，视图的简单交叉淡入淡出过渡（没有任何自定义关键帧时间）的最佳方法是执行以下摘录：

```
[[self animator] replaceSubview:aView with:bView]; 
```

不幸的是，动画师属性在 iPhone 上不可用。在 iPhone 上这样做的最佳选择是什么？是否在每个视图上设置 alpha 通道？示例代码会很棒。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-20T22:00:03.990

在 iphone 上动画视图的基本方法是使用 UIView beginAnimations 和 commitAnimations 调用。它们允许您修改视图的动画属性并使这些更改动画化。

例如，我有一个使用这种方法隐藏和显示的自定义视图：

```
- (void) showAView:(CustomAView *)aView
{
  [UIView beginAnimations:nil context:nil];
  [UIView setAnimationDuration:0.5];    
  aView.frame = CGRectMake(0.0f, 110.0f , aView.frame.size.width, aView.frame.size.height);
  [UIView commitAnimations];  
}

- (void) hideAView:(CustomAView *)aView
{
  [UIView beginAnimations:nil context:nil];
  [UIView setAnimationDuration:0.5];  
  aView.frame = CGRectMake(0.0f, self.view.frame.size.height, aView.frame.size.width, aView.frame.size.height);    
  [UIView commitAnimations];
} 
```

通过在 UIView beginAnimations/commitAnimations 中包装 frame 属性更改，更改会应用标准动画。

您可以使用 UIView 动画类方法向动画添加其他属性，例如。

```
[UIView setAnimationTransition:UIViewAnimationTransitionCurlDown forView:self.view cache:YES];
[UIView setAnimationCurve:UIViewAnimationCurveEaseInOut]; 
```

# .net - 为什么会选择 Iron Python 而不是 Boo？

> ID：890420
> 
> 赞同：1
> 
> 时间：2009-05-20T21:46:17.373
> 
> 标签：.net, python, ironpython, boo

> **可能的重复：**
> [BOO 与 IronPython](https://stackoverflow.com/questions/600539/boo-vs-ironpython)
> [Boo 与 IronPython](https://stackoverflow.com/questions/193862/boo-vs-ironpython)

假设您想将脚本语言嵌入到 .NET 应用程序中。

Boo 以 Python 语法为蓝本，但也包括类型推断，总的来说，它似乎是一种更好、更现代的语言，可以嵌入为脚本语言。

那么，为什么对 Iron Python 有这么多的关注呢？

*后来* 正如所指出的，这个问题与以下内容完全相同：[this](https://stackoverflow.com/questions/193862/) and [this](https://stackoverflow.com/questions/600539)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-20T22:02:36.780

2个字：用户群。

我已经知道这么多语言，所以我必须把参考资料放在手边，这样我就可以记住我目前正在从事的工作是“else if”、“elsif”还是“elif”。除非有令人信服的理由使用另一种语言（不仅仅是一些小的差异）我将坚持使用我已经知道的一个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T04:54:25.377

IronPython 由 Microsoft 直接开发和支持（在 Jim Hugunin 的出色技术领导下！），并且有一本关于它的非常棒的书（“IronPython in Action”，我对此有偏见，但仍然无耻地宣传）。除此之外，Boo 似乎是一个伟大的竞争者，我很想尝试一下（如果我曾经认真地使用 .NET 而不是为了好玩——因为我这些天的专业发展目标是 Linux 和Mac，而不是 Windows，这似乎不太可能）。

如果您使用 .NET 作为主要开发目标，我的建议是在您的专业领域中选择一些小型但不是玩具项目，并在 Boo 和 IronPython 中开发它们中的每一个（交替使用哪个先）——之后你经历了一些，你会知道什么是适合你的。这就是我在 90 年代最终从 Perl 4 切换到 Python 作为我的主要语言的方式（而不是坚持使用 Perl 4，我是其中的专家和大师，或者切换到当时全新的 Perl 5）——在每个环境中完全开发的几个“试点项目”让我毫不怀疑什么最适合我自己的生产力。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-20T21:48:55.607

人们喜欢python，他们不想要别的东西。这个问题真的还有别的吗？

# c# - 删除现有的配置文件提供程序

> ID：890427
> 
> 赞同：0
> 
> 时间：2009-05-20T21:46:43.817
> 
> 标签：c#, .net, asp.net, sql, profiling

Q1 Book 建议在我们注册新的*SqlProfileProvider*之前，我们应该使用 element.properties 删除任何现有的配置文件提供程序`<clear>`。但：

A）为什么我们必须使用`<clear>`而不是`<remove>`？

B）我假设 root *web.config*或*machine.config*不注册（默认情况下）任何配置文件提供程序，因此 `<clear>`不需要使用元素？

Q2 我假设每个配置文件属性在数据库表中没有对应的列（而是所有属性都存储在一个字段中）的原因是因为每次我们添加和删除配置文件属性时，我们还需要更改表架构？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-20T22:00:40.807

实际上，`AspNetSqlProfileProvider`(of type `System.Web.Profile.SqlProfileProvider`) 默认添加在`machine.config`. 查看您的`C:\Windows\Microsoft.NET\Framework\v2.0.50727\CONFIG`目录（或其他位置）。但是，它没有在那里注册为默认提供程序。[因此，如果您对默认设置](http://msdn.microsoft.com/en-us/library/ms164644.aspx)感到满意，使用以下配置就足够了：

```
<profile enabled="true" defaultProvider="AspNetSqlProfileProvider" /> 
```

如果您想使用自定义提供程序，通常最好清除所有现有提供程序（尽管不是必需的）并命名另一个默认提供程序。

不使用的原因`remove`是它需要一个`name`你可能不知道的属性。Using`clear`删除所有以前注册的配置文件提供者， using`remove`只删除一个名称。

关于第二季度，您是正确的。使用的数据库方案必须足够通用，以适应许多不同的属性（和属性类型）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T00:08:03.030

继[RWWilden 的回答](https://stackoverflow.com/questions/890427/removing-existing-profile-providers/890479#890479)之后，有一个可用的 SQL 表配置文件提供程序，它将属性映射到数据库中的列：

> [表配置文件提供程序示例](http://www.asp.net/downloads/sandbox/table-profile-provider-samples/)

ScottGu 在这里对它们进行了简要介绍：

> [ASP.NET 2.0 SQL 表配置文件提供程序](http://weblogs.asp.net/scottgu/archive/2006/01/10/435038.aspx)

# svn - Subversion 中的受阻文件夹

> ID：890440
> 
> 赞同：132
> 
> 时间：2009-05-20T21:49:53.497
> 
> 标签：svn

当您尝试检查 Subversion 时，“阻塞”到底是什么意思？我看到两个红色文件夹，文本状态为“被阻塞”。我在文档中的任何地方都看不到这意味着什么。

当我尝试该`cleanup`命令时，我得到“文件夹名称不是工作目录”。这是我刚刚在 VS 中创建的一个文件夹，当我尝试将它添加到 Subversion 时，它给了我这个错误。所有其他文件夹都很好。

* * *

## 回答 #1

> 赞同：113
> 
> 时间：2009-05-20T21:56:03.313

当您删除或移动 .svn 子目录（不通过 SVN 命令）时会发生这种情况，因此 SVN 的工作副本视图已损坏。

首先尝试清理，如果不能解决问题，请恢复（或更新）目录以恢复子目录 .svn 文件夹。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-20T22:07:07.800

在不知道*是什么*原因的情况下，解决方案可能是将工作副本（您在本地拥有的整个结帐）导出到其他地方。

如果您使用的是 tortoisesvn，则可以选择“导出未版本控制的文件”，但我认为如果从命令行执行此操作，它只会导出版本控制文件，因此手动复制未版本控制文件可能会有点费力.

完成后，检查一个干净的工作副本，然后将导出的备份放在上面。备份中没有 .svn 文件夹非常重要。

当人们在其他工作副本或其他任何破坏 .svn 条目的内容中签出工作副本时，我已经看到过这些错误。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-02-08T15:12:16.670

有同样的问题并像这样修复它：

*   重命名了受阻的目录
*   在 SVN 中使用其原始名称创建目录（例如 svn mkdir）
*   更新了父文件夹，所以新创建的目录出现在我的工作副本中
*   将文件从阻塞复制到新创建的目录并提交

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2011-12-20T20:42:35.623

如果您在 *nix 系统上，请确保您没有创建文件，将其添加到 SVN，然后将其删除，将其替换为同名文件夹。对 OP 没有帮助，但希望它能减轻一些人的压力。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-20T21:56:48.367

这意味着，由于某种原因，在操作过程中发生了冲突。检查是否存在与版本化文件同名的现有未版本化文件或文件夹。

（转述自 Tortoise SVN 客户端帮助文件）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-03-02T16:09:03.380

没有什么对我有用，所以我做了以下事情：

*   与未版本控制的文件一起导出到新位置
*   重命名现有文件夹
*   从项目中的导出位置移动文件夹
*   重命名新文件夹
*   添加，提交
*   删除了旧的重命名文件夹
*   重命名新文件夹
*   犯罪

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-06-27T13:06:08.087

有不同的场景变化可能导致这种情况。这是一个例子：

我结束了！在未使用“svn rename”命令的情况下从 www 重命名为 www_a 的目录上标记：

1.  重命名带有原始名称的当前目录，例如 www_b
2.  将 www_a 重命名为 www
3.  确保在 www 目录中执行 'svn update' 或 'svn revert'
4.  *不*使用 'svn delete' 删除最新的 www 目录
5.  转到父目录并发出“svn update”
6.  这将恢复原始的 www 目录
7.  这次使用 'svn rename' 将 www 重命名为 www_a
8.  将 www_b 重命名为 www
9.  使用 'svn add' 将其添加到存储库中

此时你应该得到一个正确的 svn 工作目录。并了解如何解决 svn 目录混乱的一两件事。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-04-03T07:47:08.700

在 Windows 机器上遇到这个问题。

在检查它所属的整个项目之前，我已经检查了该目录。它给我造成了“阻塞”问题。

我只是删除了该文件夹并从（该文件夹的）根目录运行更新。它工作得很好。

清理等命令对我不起作用。

一些警告：

1.  如果文件夹很大，这会很昂贵。
2.  如果有任何更改，它将导致您丢失所有更改。

祝一切顺利。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2017-08-01T20:42:14.050

当我创建到存储库目录的符号链接时，我也在 Windows 上看到了这一点；在这种情况下，存储库根被视为“受阻”。不过，这似乎没有任何影响。

重现步骤：

1.  检查你的回购

    ```
    svn checkout --force http://svn.server.hostname/path/to/repo/and/plugin_dir 
    ```

2.  检查您的目录是否正常

    ```
    cd plugin_dir
    svn st -u 
    ```

    输出应该是

    ```
    Status against revision: 1234 
    ```

3.  创建符号链接（显示问题）

    ```
    cd ..
    mklink /d link_dir plugin_dir
    cd link_dir
    svn st -u 
    ```

    输出将是

    ```
    ~           1234  .
    Status against revision: 1234 
    ```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-12-25T20:17:49.600

我在使用我的 FTP 客户端将带有子目录的文件夹粘贴到我的工作副本时遇到了这个问题 - 我知道我一按下传输按钮就搞砸了……工作太晚的危险。

我尝试了上面的所有建议以及网上找到的其他建议，但均无济于事。每个选项都会产生我的目录被锁定并且无法执行操作的错误。

我进入了我的 Time Machine 副本，恢复了目录，一切顺利。作为预防措施，我清理了工作副本，正确更新了我的文件并恢复了业务。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-04-22T23:04:00.007

我们经常同时有多个分支，为了避免我切换或弄乱 IIS 配置，我将每个分支都检查到一个单独的文件夹中。然后，我使用目录链接将这些文件夹连接回 IIS 中配置的主路径。

所以对我来说，链接目录总是有一个黄色感叹号，并被标记为受阻。我相信这是因为它在技术上是在 SVN 之外创建/移动的。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-09-26T18:15:26.440

当我通过 Web 界面对 CMS（WordPress 或 Drupal）进行更新时，我在目录上得到了这种“阻塞”状态——应用程序不知道它的代码实际上是一个颠覆工作副本，因此在更新插件时它会删除该插件的目录（包括`.svn`目录）并从新版本的插件中放入新目录。

要从`.svn`包含受阻目录的目录中取回该目录。我用`--force`. 例如，如果`plugin_dir`标记为“~”，我从它的父目录运行：

```
svn checkout --force http://svn.server.hostname/path/to/repo/and/plugin_dir 
```

任何已经存在的文件都被单独留下，并在 checkout 命令的输出中标记为“E”（当我运行时标记为“M” `svn status`）。

有时我必须返回并添加更新中的任何新文件；或删除应该作为更新的一部分删除的文件，因为它们在我结帐时重新出现。我相信这些在结帐时被标记为“A”，但后续`svn status`不会提及它们。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2013-11-08T18:21:44.453

我在 Eclipse 中遇到了这个问题，其中一些文件标有红色感叹号。问题是源目录中有一个杂散的 .svn 文件夹。我删除了 .svn 文件夹，刷新了 eclipse，并且能够签入文件。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2014-04-07T23:18:20.693

当您将 subversion 升级到 XCode 不支持的版本时，也会发生这种情况。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2015-11-05T19:48:52.567

这是我发现解决此问题的最简单（也是最安全）的方法：

1.  临时重命名被阻塞的有问题的文件或目录（或父目录）（例如添加“.backup”）。
2.  删除`.svn`重命名目录中的所有目录（如果适用）。
3.  `svn revert`步骤 1 中重命名（现在丢失）的对象。
4.  `svn delete`还原的对象。
5.  将步骤 1 中的备份重命名为其原始名称。
6.  将重命名的对象作为新对象添加并签入回 svn。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2016-04-26T08:49:25.210

当我用一个具有完全相同名称的文件夹替换文件时，这发生在我身上。通过删除旧文件，提交，然后添加新文件来解决。有点hacky，但对我有用:)

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2019-12-11T08:58:19.517

我删除了受阻目录中的 .svn 并从外部对其进行了更新。然后外面的 svn 命令会识别这些文件。

# sdk - 我可以使用 SDK 操作 Windows Media Center 中的“正在播放”队列吗？

> ID：890441
> 
> 赞同：2
> 
> 时间：2009-05-20T21:49:54.403
> 
> 标签：sdk, windows-media-center

我已经下载了 Windows Media Center SDK 并查看了文档，但我并没有真正了解如何与“正在播放”队列进行交互。是否可以？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T21:58:31.707

在 Windows 7 中，您可以获得完整的交互。使用[MediaCollection](http://blog.retrosight.com/WindowsMediaCenterPlatformInThePDCBuildOfWindows7.aspx)

在 Windows Vista 中有些东西可以工作，但它真的很脆弱，请参阅[此代码](http://code.google.com/p/videobrowser/source/browse/trunk/MediaBrowser/Code/ModelItems/PlaybackController.cs)。

# wpf - View-Model-ViewModel 模式的表示逻辑在哪里？

> ID：890442
> 
> 赞同：0
> 
> 时间：2009-05-20T21:50:07.740
> 
> 标签：wpf, design-patterns

在 View-Model-ViewModel 中，动作本质上是由绑定到视图的视图模型执行的。但是，由于没有使用后面的代码并且视图模型没有引用或知道调用它的控件，“表示逻辑”会去哪里？

例如，如果我想在单击按钮时为另一个控件设置动画怎么办。这还会出现在后面的代码中吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-20T23:49:17.423

为了扩展[Justin Niessner](https://stackoverflow.com/users/84651/justin-niessner)的评论，我将使用触发器来实现这个动画，因为它都是 UI 绑定的。

想一想：

*   您将代码放在哪里，以便当有人将鼠标悬停在按钮上时它会被突出显示？
*   单击该按钮时“按下”该按钮的代码呢？

这些和您的问题都是主题的变体，所以我会说在 GUI 中进行。

但是，这条规则有一个例外。如果“动画”是一个处理动画，那么将它绑定到 ViewModel 可能是值得的，这样 ViewModel 可以控制动画在处理某些内容时运行多长时间。否则在 GUI 中执行。

编辑：根据您的评论。好的，所以动画应该运行 ViewModel 中的属性，而不是按钮单击事件。Click 应该通过命令在 ViewModel 中开始处理，并且该命令的执行代码应该在 ViewModel 上设置处理标志属性。然后视图可以绑定到该处理标志并在设置该标志时显示进度条或其他任何内容。

# jquery - 如何使用 jQuery 和 ZeroClipboard 将 Ajax 响应加载到剪贴板？

> ID：890444
> 
> 赞同：2
> 
> 时间：2009-05-20T21:50:24.277
> 
> 标签：jquery, flash, clipboard, zeroclipboard

我需要一种将动态（Ajax）加载的内容复制到 Web 浏览器中的剪贴板的方法。有许多库可以使用 Flash 模拟复制到剪贴板的功能。但是，使用新的[Flash 10 默认安全设置](http://www.adobe.com/devnet/flashplayer/articles/fplayer10_security_changes_02.html#head31)，复制到剪贴板设置现在需要明确的用户确认。 [ZeroClipboard](http://code.google.com/p/zeroclipboard/)是一个 Javascript/Flash 库，可以绕过这个“限制”（使用 Flash 电影点击劫持）。

这是我编写的一个简单的 JQuery 插件，用于将 ZeroClipboard 集成到我的应用程序中：

```
// A jQuery plugin for copying Ajax content into clipboard
(function($) {
    $.fn.clickToClipboard = function() {
        $(this).each( function() {
            var link = $(this);
            if ( link.is('a') ) {
                var clip = new ZeroClipboard.Client();
                clip.glue(this);
                clip.addEventListener('onMouseDown', function(){
                    link.html('copying...');
                    clip.reposition();
                    $.ajax({ 
                        url: link.attr('href'),
                        success: function(content) { 
                            clip.setText(content);
                        },
                        async: false
                    });
                });

                clip.addEventListener('onComplete', function(){ 
                    link.html('copied!');
                    clip.reposition();
                });
            }            
        });
    }
})(jQuery); 
```

每个锚 url 指向服务器上的一个文本文件。当点击 flash 影片（click-jacked 链接）时，它会通过 Ajax 和 ZeroClipboard 将锚点对应的文本文件加载到剪贴板中。

~~这个插件在 Safari 中运行良好（即使是 4000+ 行的prototype.js 文本文件）。然而，它在 FF3.0 上失败了，即使在一个简单的文本文件中也只有一行：“hello”。~~我已将 Ajax 调用的内容记录到控制台中。成功回调似乎确实有效。似乎第二次单击电影将完成复制（因为浏览器缓存了第一次 Ajax 调用的文本文件）。

请注意，我在这里使用了同步 Ajax 调用来等待文本完成加载。任何人都知道为什么我的代码不能按预期工作？（不确定是否相关，我的后端是在 Rails 中完成的）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2011-12-14T14:01:22.497

在我意识到我误解了你的问题后，删除了我的第一个答案。对不起。

我会尝试首先获取 ajax 数据，而不是使用事件侦听器设置文本。

# c# - 在 Web 应用程序之间共享配置文件和角色信息

> ID：890447
> 
> 赞同：0
> 
> 时间：2009-05-20T21:51:22.993
> 
> 标签：c#, .net, asp.net, security, roles

Q1 Book 说我们可以通过让配置文件提供者使用相同的*ApplicationName*值来选择在 Web 应用程序之间共享配置文件信息。但是应用程序共享角色也可以吗，或者这会带来安全风险吗？

第二季度

如果*ProfileManager.AutomaticSaveEnabled*设置为*True*，那么当对任何配置文件数据进行更改时，*ProfileModule*将相应地更新数据库中的表。在处理包含简单类型的属性时，*ProfileModule*检查*IsDirty* 以确定属性是否已更改。

A) 假设*Profile.Name*已经包含值“<em>Irene”，当程序发出以下语句时：

```
Profile.Name = "Irene"; 
```

即使已为其分配了相同的值，*Name*属性是否会被标记为脏？

B）如果*ProfileManager.AutomaticSaveEnabled*设置为*True*并且如果包含复杂类型的属性设置为只读，那么我假设*ProfileManager*会意识到这一点，因此不会尝试连接数据库以保存此属性？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T00:14:58.697

1) 如果您对在两个站点上具有相同角色的用户感到满意，那么这不是问题，并且提供了简化的管理。如果您希望用户在每个站点上具有不同的角色，那么就需要将其分开。

2）不能说我已经尝试过任何一种情况，抱歉。

# c# - 在 C# .NET 中检查静态或动态 IP 地址？

> ID：890449
> 
> 赞同：2
> 
> 时间：2009-05-20T21:51:46.537
> 
> 标签：c#, .net

我正在构建一个非常基本的表单应用程序。

我可以获得本地机器上可用的 IP 地址列表。但是，我还想确定这些地址是如何获得的（例如 DHCP 或静态）。如何判断系统上是否配置了静态 IP 地址？

目标是告知新手最终用户（可能不了解网络设置或如何获取网络设置）可用的静态 IP 地址。并且，如果不存在静态地址，请通知他们需要设置一个。

TIA

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2014-02-14T08:09:02.540

与 WMI 相比，性能更好，因此更好地使用 Net.NetworkInformation

```
 using System.Net.NetworkInformation;

    NetworkInterface[] niAdpaters = NetworkInterface.GetAllNetworkInterfaces();

    private Boolean GetDhcp(Int32 iSelectedAdpater)
    {
        if (niAdpaters[iSelectedAdpater].GetIPProperties().GetIPv4Properties() != null)
        {
            return niAdpaters[iSelectedAdpater].GetIPProperties().GetIPv4Properties().IsDhcpEnabled;
        }
        else
        {
            return false;
        }
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-20T22:03:11.303

您可以使用 WMI 获取网络适配器配置。

例如，请查看[http://www.codeproject.com/KB/system/cstcpipwmi.aspx](http://www.codeproject.com/KB/system/cstcpipwmi.aspx)。网络适​​配器上的“DhcpEnabled”属性应该告诉您地址是否通过 dhcp 获得。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-20T22:14:50.077

不幸的是，您可能不得不使用 WMI。可能还有另一种方法，但这是我知道的唯一方法。

此代码将输出有关系统上每个适配器的所有信息。我认为名称是您想要的属性的“DHCPEnabled”。

```
ManagementObjectSearcher searcherNetwork =
new ManagementObjectSearcher("root\\CIMV2",
"SELECT * FROM Win32_NetworkAdapterConfiguration");

foreach (ManagementObject queryObj in searcherNetwork.Get())
{
     foreach (var prop in queryObj.Properties)
     {
         Console.WriteLine(string.Format("Name: {0} Value: {1}", prop.Name, prop.Value));
     }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-01-12T11:55:46.387

我使用以下两种方法：

```
public static string GetLocalIPAddress()
{
    var host = Dns.GetHostEntry(Dns.GetHostName());

    foreach (var ip in host.AddressList)
    {
        if (ip.AddressFamily == AddressFamily.InterNetwork)
        {
            return ip.ToString();

        }

    }

    return "unknown";
}

public static string GetLocalIpAllocationMode()
{
    string MethodResult = "";
    try
    {
        ManagementObjectSearcher searcherNetwork = new ManagementObjectSearcher("root\\CIMV2", "SELECT * FROM Win32_NetworkAdapterConfiguration");

        Dictionary<string, string> Properties = new Dictionary<string, string>();

        foreach (ManagementObject queryObj in searcherNetwork.Get())
        {
            foreach (var prop in queryObj.Properties)
            {
                if (prop.Name != null && prop.Value != null && !Properties.ContainsKey(prop.Name))
                {
                    Properties.Add(prop.Name, prop.Value.ToString());

                }

            }

        }

        MethodResult = Properties["DHCPEnabled"].ToLower() == "true" ? "DHCP" : "Static";

    }
    catch (Exception ex)
    {
        ex.HandleException();

    }

    return MethodResult;

} 
```

`GetLocalIpAllocationMode()`会告诉你是`ip`is`static`还是分配 via `dhcp`，而`GetLocalIPAddress()`会告诉你本地`ip`本身。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-09-06T05:47:03.197

这里的答案对我自己的项目有所帮助，但在我发现如何使用建议的方法之前，我必须做一些研究。

将 using 添加`System.Management;`到您的代码本身不起作用。在识别命名空间之前，您需要添加对 System.Management 的引用。（对于像我这样尝试过并且收到错误“找不到管理类”的新人）。

# http - 确定 http 文件上传的 mime 类型的最佳方法是什么？

> ID：890453
> 
> 赞同：0
> 
> 时间：2009-05-20T21:52:45.690
> 
> 标签：http, web-applications

假设您有一个带有“文件”类型的输入标签的 html 表单。当文件发布到服务器时，它将与相关元数据一起存储在本地。

我可以想到三种方法来确定 mime 类型：

*   使用“multipart/form-data”有效负载中提供的 mime 类型。
*   使用“multipart/form-data”有效负载中提供的文件名，并根据文件扩展名查找 mime 类型。
*   扫描原始文件数据并使用 mime 类型猜测库。

这些解决方案都不是完美的。

**哪个是最准确的解决方案？**
**还有其他更好的选择吗？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-20T22:10:17.277

如果您使用的是 PHP，那么您可以使用

[http://pecl.php.net/package/Fileinfo](http://pecl.php.net/package/Fileinfo)

这将检查文件的许多方面。对于 Python，您可以使用

[http://pypi.python.org/pypi/python-magic/0.1](http://pypi.python.org/pypi/python-magic/0.1)

Linux/Unix 和可能的 Windows 上的 libmagic 绑定是什么？系统。看：

```
man magic
man libmagic 
```

在 Linux 上。它使用幻数测试来尝试和断言 mime 类型的文件。

**我喜欢**幻数方法，因为如果您在网络服务器上处理上传的文件，它可以捕获错误的扩展名和很多诡计。这些测试通常是一次性的，因此读取文件的性能影响可以忽略不计。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-20T22:36:29.207

我不认为你可以依赖其中任何一个作为明确的“我是 mime type x”。前两个的问题是提供的内容类型可能不正确，因为客户端（浏览器或其他）问题或来自不同客户端的误导性请求（各种黑客尝试等）。

因此，您可能应该尝试结合每种类型的信息并计算出某种置信度。如果文件扩展名为 .doc 并且 mime 类型是 application/msword 那么很有可能它是一个 word 文档，但是通过 mime 类型检测实用程序运行它只是为了确保。

应该有一种解决方案可用于使用您使用的语言进行 mime 魔术检测 - 不过您没有提到哪一种。它们通常都通过查看文件的前几个字节/字符并将它们与 mime 类型的查找表进行匹配来工作。有些人还从文件中删除 BOM 以帮助解决此问题。如果无法检测到 MIME 类型，它们通常会退回到纯文本。

如果您想要一种独立于平台的方法，请查看现有的各种 Java 库：

*   [http://code.google.com/p/mimemagic/](http://code.google.com/p/mimemagic/)
*   [http://sourceforge.net/projects/jmimemagic/](http://sourceforge.net/projects/jmimemagic/)

# search - 无法从终端在 Firefox 中启动 Google 以搜索 Screen 的剪贴板

> ID：890456
> 
> 赞同：1
> 
> 时间：2009-05-20T21:53:48.077
> 
> 标签：search, gnu-screen, copy-mode

**问题：**在屏幕的复制模式下从终端到 Firefox 有一个键盘快捷键来搜索当前选择

您可以在复制模式下按 将句子复制到屏幕的剪贴板`enter`。但是，我希望能够按下`g`将屏幕的剪贴板作为第一个参数放在下面的命令中：

```
#!/bin/sh
q=$1
open "http://www.google.com/search?q=$q" 
```

我现在也这样做

1.  Ca Esc [选择区域] 回车
2.  Cz [将当前窗口移开]
3.  谷歌钙]

**如何将 Screen 的剪贴板放入命令中**？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-04T23:32:43.160

我仍在尝试找出确切的语法，但看看在你的 .screenrc 文件中使用 'bind' 和 'writebuf'（可能还有 'eval'）。

编辑

您可以在主目录的 .screenrc 文件中绑定键。例如，

```
bind g eval 'writebuf' 'exec . /bin/sh/ -c "cp /tmp/screen-exchange ~/foo.txt"' 
```

当您在屏幕中使用 g 键时，这将运行**eval命令。**Eval 接受任意数量的参数并将它们作为 Tcl 脚本运行。

**writebuf**将屏幕复制/粘贴缓冲区转储到 /tmp/screen-exchange 的文件中。

第二个字符串以**exec**开头，它将运行 Tcl 解释器外部的程序。在这种情况下，我选择 /bin/sh（*nix shell）并传递任意系统命令。上面的示例复制了 /tmp/screen-exchange 文件，但您可以：

```
open < /tmp/screen-exchange 
```

将该行添加到 ~/.screenrc 后，重新启动屏幕，复制一些文本并尝试

```
C-a g 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-07T18:57:13.473

```
open "http://www.google.com/search?q=`xclip -o`" 
```

这适用于 X 的复制缓冲区而不是 Screen 的，但 X 剪贴板通常是您想要的，因为它是通过简单地突出显示文本来设置的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-07T20:43:42.447

[下面描述了有人如何修改他们的 .screenrc 文件以将其与 X 剪贴板同步。](http://snarfed.org/space/synchronizing%20GNU%20screen%27s%20paste%20buffer%20and%20the%20X%20selection)您可以尝试修改它以将所选文本发送到 Firefox 而不是 xsel。

# asp.net - Asp.net 发布版本与调试版本

> ID：890459
> 
> 赞同：1
> 
> 时间：2009-05-20T21:54:43.987
> 
> 标签：asp.net, build, debugging, release

如何确定我的应用程序是否编译为“发布”而不是“调试”？我去了 VS 2008 Project Properties > Build 并将配置从 Debug 设置为 Release，但我注意到没有变化？这是一个 ASP.NET 项目。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-21T04:22:27.647

[HttpContext.IsDebuggingEnabled](http://msdn.microsoft.com/en-us/library/system.web.httpcontext.isdebuggingenabled.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-21T14:58:43.790

如果你想知道 dll 是否是在调试模式下构建的，带有调试属性，那么你最好的选择是反射。

取自“[如何判断现有程序集是调试还是发布](http://msmvps.com/blogs/bill/archive/2004/06/17/8339.aspx)”：

```
Assembly assembly = Assembly.GetAssembly(GetType());
bool debug = false;
foreach (var attribute in assembly.GetCustomAttributes(false)){
  if (attribute.GetType() ==  typeof(System.Diagnostics.DebuggableAttribute)){
    if (((System.Diagnostics.DebuggableAttribute)attribute)
        .IsJITTrackingEnabled){
      debug = true;
      break;
    }
  }
} 
```

这将获取调用该代码的程序集（实际上是本身），然后如果程序集是在调试模式下编译的，则将调试布尔值设置为 true，否则为 false。

这可以很容易地放入控制台应用程序（如链接示例中），然后传入要检查的 dll/exe 的路径。您将从如下路径加载程序集：

```
Assembly assembly = 
    Assembly.LoadFile(System.IO.Path.GetFullPath(m_DllPath.Text)); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-20T21:56:29.333

对于 Web.config 中的调试将设置为 true，但是您实际上也可以在发布应用程序中设置它。

然而，在调试中设置了 DEBUG 之类的定义，因此很容易做到：

```
bool is_debug;

#ifdef DEBUG
is_debug = true;
#else
is_debug = false;
#endif 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-21T13:43:14.830

您需要寻找的不仅仅是 IsJITTrackingEnabled - 这完全独立于代码是否为优化和 JIT 优化而编译。

此外，如果您在发布模式下编译并将 DebugOutput 选择为“none”以外的任何内容，则会出现 DebuggableAttribute。

请参考我的帖子： [如何判断程序集是调试版还是发布版](http://dave-black.blogspot.com/2011/12/how-to-tell-if-assembly-is-debug-or.html)以及 [如何识别 DLL 是调试版还是发布版（在 .NET 中）](https://stackoverflow.com/questions/798971/how-to-idenfiy-if-the-dll-is-debug-or-release-build-in-net/5316565#5316565)

# python - 向我解释尾调用优化有什么大不了的，为什么 Python 需要它

> ID：890461
> 
> 赞同：20
> 
> 时间：2009-05-20T21:55:07.497
> 
> 标签：python, tail-recursion, tail-call-optimization

显然，关于 Python 是否需要尾调用优化引起了很大的争论。当有人因为 Guido 没有“得到它”而[向 Guido 发送了一份 SICP 副本时，这种情况就出现了。](http://drj11.wordpress.com/2009/04/30/python-tail-call-optimisation/)我和圭多在同一条船上。我了解尾调用优化的概念。我只是想不出 Python 真正*需要*它的任何原因。

为了让我更容易理解，有人可以给我一段使用 TCO 可以大大简化的代码片段吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-20T22:19:21.487

就个人而言，我非常重视尾调用优化；但主要是因为它使递归与迭代一样有效（或使迭代成为递归的子集）。在简约语言中，您可以获得巨大的表达能力，而不会牺牲性能。

在“实用”语言（如 Python）中，OTOH，对于几乎所有可以想象的情况，通常都有很多其他的结构，所以它不那么重要。当然，考虑到不可预见的情况，拥有它总是一件好事。

就个人而言，我非常重视尾调用优化；但主要是因为它使递归与迭代一样有效（或使迭代成为递归的子集）。在简约语言中，您可以获得巨大的表达能力，而不会牺牲性能。

在“实用”语言（如 Python）中，OTOH，对于几乎所有可以想象的情况，通常都有很多其他的结构，所以它不那么重要。当然，考虑到不可预见的情况，拥有它总是一件好事。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-21T04:46:01.060

如果您非常想对可能表示为循环的事物使用递归，那么“尾调用优化”确实是必须的。然而，Python 的仁慈独裁者终生 (BDFL) Guido 坚信循环被表示为循环——因此他不会进行特殊情况的尾调用（牺牲堆栈跟踪转储和调试规律性）。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-20T22:02:50.257

[尾调用优化](http://en.wikipedia.org/wiki/Tail_call_optimization)使编写递归函数更容易，而不必担心堆栈溢出：

```
def fac(n, result=1):
        if n > 1:
                return fac(n - 1, n * result)
        return result 
```

如果没有尾调用优化，用大数字调用它可能会溢出堆栈。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-20T07:52:20.607

Guido 在后续[帖子](http://neopythonic.blogspot.com.es/2009/04/final-words-on-tail-calls.html)中认识到，TCO 允许更简洁地将状态机实现为递归调用彼此的函数集合。然而，在同一篇文章中，他提出了一种没有 TCO 的、同样清洁的替代解决方案。

# sql - sqlite 的清单类型何时有用？

> ID：890462
> 
> 赞同：17
> 
> 时间：2009-05-20T21:55:11.630
> 
> 标签：sql, sqlite, static-typing, dynamic-typing

sqlite 使用了作者称之为“ [Manifest Typing](http://www.sqlite.org/different.html#typing) ”的东西，这基本上意味着 sqlite 是动态类型的：如果需要，您可以将 varchar 值存储在“int”列中。

这是一个有趣的设计决定，但是每当我使用 sqlite 时，我都会像使用标准 RDMS 一样使用它，并将类型视为静态的。事实上，在其他系统中设计数据库时，我什至从未希望使用动态类型的列。

那么，这个功能什么时候有用呢？有没有人在实践中发现了它的一个很好的用途，而静态类型的列却无法做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-20T22:05:02.763

它实际上只是使类型更易于使用。您不再需要担心这个字段在数据库级别需要多大，或者您的整数可以有多少位数。或多或少是一个'为什么不呢？事物。

另一方面，SQL Server 中的静态类型允许系统更好地搜索和索引，在某些情况下更好，但是对于所有应用程序的一半，我怀疑数据库性能改进是否重要，或者它们的性能对于其他应用程序来说“很差”原因（每次选择创建临时表，指数选择等）。

我一直将 SqlLite 用于我的 .NET 项目作为客户端缓存，因为它太容易使用了。现在，如果他们只能让它使用与 SQL 服务器相同的 GUID，我将是一个快乐的露营者。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-03-06T07:34:08.477

动态类型对于存储配置设置等内容很有用。以 Windows 注册表为例。每个键都非常类似于具有以下形式的 SQLite 表：

CREATE TABLE 设置（名称 TEXT PRIMARY KEY、值）；

其中值可以是 NULL (REG_NONE) 或 INTEGER (REG_DWORD/REG_QWORD)、TEXT (REG_SZ) 或 BLOB (REG_BINARY)。

此外，我必须同意 Jasons 关于不强制字符串最大大小的有用性。因为很多时候，这些限制纯粹是任意的，你可以指望有一天会找到一个需要存储在 VARCHAR(30) 中的 32 字节字符串。

# iis - 从 Virtual PC 2007 (XP sp3) 上的共享文件夹打开 VB6 项目时出现路径未找到错误

> ID：890465
> 
> 赞同：1
> 
> 时间：2009-05-20T21:55:30.913
> 
> 标签：iis, vb6, windows-xp, virtual-pc

我目前在一个主要维护遗留软件的小型软件团队工作。我正在尝试设置一个我们可以用来进行此维护的虚拟 PC。具体来说，我希望能够从主机 PC 上的文件夹中调试和运行 VB6 Web 应用程序。我的约束如下：

1.  Virtual PC 不会在域中注册。
2.  托管我们的 Subversion 存储库的服务器**不**运行 subversion 服务，因此与存储库交互的唯一方法是通过“file:\\”，这需要域身份验证。
3.  无法调试/运行位于映射网络驱动器上的 VB6 Web 应用程序，因为 IIS 要求 VirtualPC 与网络驱动器位于同一域中
4.  我想避免必须将文件夹从主机 pc 复制到 VirtualPC，然后将其复制回来以便从 Subversion 获得最新版本

所以，我尝试使用VirtualPC 的共享文件夹功能来共享主机的Subversion 目录，并在VirtualPC 上用VB6 打开项目。问题是 Visual Basic 在我尝试打开它时抛出错误：“找不到路径：'\\C:\\Subversion\Path\Project.vbp'”。主机上的文件夹 C:\Subversion 映射到 VirtualPC 上的 G:。如果有人可以帮助我解决此错误或找到其他方法来完成此操作，我将不胜感激。

哦，主机和虚拟操作系统都是 Windows XP sp3。使用 VB 6.0、IIS v5.1。

我可以从 VirtualPC 上自由地操作共享目录中的文件，即。复制、粘贴、删除等

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-21T05:26:17.090

VBP 和 VBG 文件是文本文件。查看它们的内部，看看 C:\Subversion 或 C:\Subversion 是否出现在任何地方，可能是项目组中的子项目。如果是这样，请将其更改为使用相对路径而不是绝对路径。

# javascript - Javascript firefox 扩展以获取链接周围的文本

> ID：890480
> 
> 赞同：1
> 
> 时间：2009-05-20T22:00:53.180
> 
> 标签：javascript, firefox, hyperlink, firefox-addon, onclick

我是否可以等待用户单击链接，并在单击链接时获得链接的文本？

也许通过使用onClick？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-20T22:17:18.263

如果您的意思是为用户正在浏览的页面中的链接处理点击事件，那么这就是：

```
// handle the load event of the window  
window.addEventListener("load",Listen,false);  
function Listen()  
{   
gBrowser.addEventListener("DOMContentLoaded",DocumentLoaded,true);  
}  

// handle the document load event, this is fired whenever a document is loaded in the browser. Then attach an event listener for the click event  
function DocumentLoaded(event) {  
 var doc = event.originalTarget;
 doc.addEventListener("click",GetLinkText,true);  
}  
// handle the click event of the document and check if the clicked element is an anchor element.  
function GetLinkText(event) {  
   if (event.target instanceof HTMLAnchorElement) {  
    alert(event.target.innerHTML);
   }   
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-20T22:13:38.723

使用 jQuery 非常简单：

```
<script>
    $(document).ready(function(){
        $("a").click(function(){alert($(this).text());});
    });
</script> 
```

当然，除了提醒文本，您可能还想做一些事情。

# excel-formula - 引用其他工作簿的公式

> ID：890484
> 
> 赞同：1
> 
> 时间：2009-05-20T22:02:03.287
> 
> 标签：excel-formula

给定工作簿的文件名列表，编写一个公式来引用指定工作簿中的特定单元格值。

```
A----------B-------C-----D--------------------------------E----------

workbook1  sheet1  A1    '[workbook1.xlsx]sheet1'!$A$1    =(????
workbook2  sheet1  A1    '[workbook2.xlsx]sheet1'!$A$1
workbook3  sheet1  A1    '[workbook3.xlsx]sheet1'!$A$1 
```

给定 A、B 和 C，我可以创建 D，但我找不到在 E 的公式中使用它的方法。

我无法在公式中引用 D 中的上述字符串。INDIRECT 也不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-20T23:15:41.843

根据 INDIRECT 的 Excel 2007 帮助：

> 如果 ref_text 引用另一个工作簿（外部引用），则必须打开另一个工作簿。如果源工作簿未打开，则 INDIRECT 返回 #REF！错误值。

是否让相关文件打开一个选项？

如果没有，听起来可能需要一些脚本......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T20:39:30.577

感谢每个人的贡献和进一步的实验，我现在可以断言：对于工作的外部参考，必须具备多种因素。

1.  如果引用引用另一个工作簿（外部引用），则必须打开另一个工作簿
2.  摆脱单引号字符以使用 INDIRECT
3.  工作簿文件名不能包含空格

例如，假设 w1.xls 和 w 2.xls 都打开，我可以创建一个新工作簿，其中包含以下内容：

```
A---------B-------C-----D-------------------------E---------------------------------
w1.xlsx   sheet1  $A$1  ="["&A13&"]"&B13&"!"&C13  =INDIRECT(D13)  'will work
w 2.xlsx  sheet1  $A$1  ="["&A14&"]"&B14&"!"&C14  =INDIRECT(D14)  'Does NOT work 
```

至此，这种方式最大的局限是所有工作簿都必须打开，工作簿名称不能包含空格。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-20T23:42:37.887

我认为您只需要摆脱单引号字符即可使用 INDIRECT。在 Windows NT 上的 Excel 2003 中为我工作。

A13----B13----C13--D13---------------------E13-----------

w1.xls Sheet1 $A$1 ="["&A13&"]"&B13&"!"&C13 =INDIRECT(D13)

# python - Python：如何将列表写入文件，然后稍后将其拉回内存（dict表示为字符串转换为dict）？

> ID：890485
> 
> 赞同：31
> 
> 时间：2009-05-20T22:02:21.943
> 
> 标签：python, pickle

875228 的更具体的欺骗[——Python 中的简单数据存储](https://stackoverflow.com/questions/875228/simple-data-storing-in-python)。

我有一个相当大的字典（6 GB），我需要对其进行一些处理。我正在尝试几种文档聚类方法，因此我需要一次将整个内容保存在内存中。我有其他函数可以在这些数据上运行，但内容不会改变。

目前，每次我想到新功能时，我都必须编写它们，然后重新生成字典。我正在寻找一种将这个字典写入文件的方法，这样我就可以将它加载到内存中，而不是重新计算它的所有值。

过于简化它看起来像：{((('word','list'),(1,2),(1,3)),(...)):0.0, ....}

我觉得 python 必须有比我循环遍历一些字符串寻找 : 和 ( 试图将它解析成字典更好的方法。

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2009-05-20T22:07:34.350

为什么不使用[python pickle](http://docs.python.org/library/pickle.html)？Python 有一个很棒的序列化模块，称为 pickle，它非常易于使用。

```
import cPickle
cPickle.dump(obj, open('save.p', 'wb')) 
obj = cPickle.load(open('save.p', 'rb')) 
```

泡菜有两个缺点：

*   对于错误或恶意构建的数据，它并不安全。永远不要取消从不受信任或未经身份验证的来源收到的数据。
*   该格式不是人类可读的。

如果您使用的是 python 2.6，则有一个名为[json](http://docs.python.org/library/json.html)的内置模块。使用起来就像泡菜一样简单：

```
import json
encoded = json.dumps(obj)
obj = json.loads(encoded) 
```

Json 格式是人类可读的，与 python 中的字典字符串表示非常相似。并且没有任何像泡菜这样的安全问题。但可能比 cPickle 慢。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-20T23:12:21.193

正如其他答案所建议的那样，我会使用[`shelve`](http://docs.python.org/library/shelve.html), `json`,或其他任何东西。`yaml`

`shelve`特别酷，因为你可以`dict`在磁盘上并且仍然使用它。值将按需加载。

但是如果你真的想解析 的文本`dict`，并且它只包含你展示的`str`ings、`int`s 和s，你可以使用它来解析它。它更安全，因为你不能用它来评估完整的表达式 - 它只适用于ings、numbers、s、s、s、eans 和：`tuple`[`ast.literal_eval`](http://docs.python.org/library/ast.html#ast.literal_eval)`str``tuple``list``dict``bool``None`

```
>>> import ast
>>> print ast.literal_eval("{12: 'mydict', 14: (1, 2, 3)}")
{12: 'mydict', 14: (1, 2, 3)} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-20T22:57:08.667

我建议你使用[YAML](http://www.yaml.org/)作为你的文件格式，这样你就可以在光盘上修改它

```
How does it look:
  - It is indent based
  - It can represent dictionaries and lists
  - It is easy for humans to understand
An example: This block of code is an example of YAML (a dict holding a list and a string)
Full syntax: http://www.yaml.org/refcard.html 
```

要在 python 中获取它，只需 easy_install pyyaml。见[http://pyyaml.org/](http://pyyaml.org/)

它带有简单的文件保存/加载功能，我现在不记得了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-05T15:15:06.907

以下是一些替代方案，具体取决于您的要求：

*   `numpy`以紧凑的形式存储您的纯数据并很好地执行组/大规模操作

*   `shelve`就像一个文件备份的大字典

*   一些第 3 方存储模块，例如`stash`，存储任意纯数据

*   适当的数据库，例如用于多毛数据的 mongodb 或 mysql 或 sqlite 纯数据和更快的检索

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-20T22:27:09.380

以序列化格式写出来，例如pickle（一个用于序列化的python标准库模块）或者可能使用JSON（这是一种可以被评估以再次产生内存表示的表示）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-10-02T23:20:55.037

SourceForge 的此解决方案仅使用标准 Python 模块：

y_serial.py 模块 :: 使用 SQLite 存储 Python 对象

“序列化 + 持久性 :: 在几行代码中，将 Python 对象压缩和注释为 SQLite；然后在没有任何 SQL 的情况下通过关键字按时间顺序检索它们。数据库存储无模式数据的最有用的“标准”模块。”

[http://yserial.sourceforge.net](http://yserial.sourceforge.net)

压缩奖励可能会将您的 6GB 字典减少到 1GB。如果您不想存储一系列字典，该模块还包含一个 file.gz 解决方案，考虑到您的字典大小，它可能更适合。

# java - 我应该如何显示 ICellEditorValidator 检测到的验证错误？

> ID：890491
> 
> 赞同：8
> 
> 时间：2009-05-20T22:03:48.260
> 
> 标签：java, eclipse, validation, jface

我有一个带有 ICellModifier 的 TableViewer，它似乎工作正常。不过，我在其中一个单元格编辑器上设置了 ICellEditorValidator，但我无法让它按照我想要的方式运行。这是我的缩写代码：

```
cellEditors[1] = new TextCellEditor(table);
cellEditors[1].setValidator(new ICellEditorValidator() {
    public String isValid(Object value) {
        try {
            Integer.parseInt((String) value);
            return null;
        } catch(NumberFormatException e) {
            return "Not a valid integer";
        }
    }
}); 
```

它大部分工作正常。但是，有两个问题：

1.  `modify`如果验证器返回错误，则单元格修饰符的方法接收 null 作为新值。我可以编写代码来处理这个问题，但这似乎不对。Null 可能是一个有效值，例如，如果用户选择背景颜色并且他们选择透明。（这是一个普遍问题，并非针对此示例。）
2.  验证器的错误消息永远不会显示给用户。这是个大问题。`applyEditorValue`如果最后一个值无效，我还可以添加一个 ICellEditorListener 并从该方法显示一个对话框 。这是“正确”的做法吗？

顺便说一句，由于我无法控制的原因，我仅限于 Eclipse 3.0 框架。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-12-09T09:39:44.617

你可以在你的编辑器中添加一个监听器：

```
cellEditors[1].addListener(
        public void applyEditorValue() {                    
            page.setErrorMessage(null); 
        }

        public void cancelEditor() {
            page.setErrorMessage(null);                 
        }

        public void editorValueChanged(boolean oldValidState,
                boolean newValidState) {                    
            page.setErrorMessage(editor.getErrorMessage());                                 
        } 
```

*page*是您当前的FormPage ，这将向用户显示 errorMessage *。*

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-07-13T08:24:05.330

关于第二个问题，验证器方法返回的字符串成为拥有该验证器`isValid`的错误消息。`CellEditor`您可以使用 检索该消息`CellEditor.getErrorMessage`。

在我看来，显示错误消息的最简单方法是通过 a `ICellEditorListener`，正如 Sven 上面所建议的那样。也许这个监听器的棘手之处在于单元格编辑器没有作为参数传递给它的任何方法，因此假设监听器知道哪个单元格编辑器正在与它交谈。

如果您想要对话框、首选项页面或任何对象来实现`ICellEditorListener`接口，您必须确保它知道正在编辑的单元格编辑器。

但是，如果是单元格编辑器本身实现了接口，它应该有办法将错误消息正确地传递到对话框、首选项页面或其他任何内容中。这就是`currentForm page`斯科特正在寻找的。

如果您正在使用，最后需要注意的一件事是，当返回错误消息时`EditingSupport`，传递给该`EditingSupport.setValue`方法的值是 null 。`ICellEditorValidator.isValue`别忘了检查一下。

# .net - 从 Windows Server 2003 上的 Web CGI 脚本执行 .net 应用程序时出现 InteropServices COMException

> ID：890492
> 
> 赞同：0
> 
> 时间：2009-05-20T22:03:49.383
> 
> 标签：.net, security, exception, com, invoke

*免责声明：我对 .net 和 COM 完全一无所知。*

我有一个供应商的应用程序，它似乎是用 .net 编写的，我正在尝试用一个 web 表单（一个 cgi-bin Perl 脚本）来包装它，这样我最终可以从另一台计算机上启动这个供应商的应用程序。我在 Windows Server 2003 R2 SE SP1 系统上，我将 Apache 2.2 用于 Web 服务器，将 ActivePerl 5.10.0.1004 用于 cgi 脚本。我的 cgi 脚本使用 Perl 反引号运算符调用驻留在同一台机器上的供应商应用程序。

```
...
$result = "Result: " . `$vendorsPath/$vendorsExecutable $arg1 $arg2`;
... 
```

现在我只是在服务器机器上本地运行 IE Web 浏览器并访问“ [http://localhost/cgi-bin/myPerlScript.pl](http://localhost/cgi-bin/myPerlScript.pl) ”。供应商的应用程序失败并记录包含以下堆栈跟踪的调试消息（我更改了几个名称，以免泄露供应商的身份）：

```
...
System.Reflection.TargetInvocationException: Exception has been thrown by the target of an invocation. ---> System.Runtime.InteropServices.COMException (0x80043A1D): 0x80040154 - Class not registered
   --- End of inner exception stack trace ---
   at System.RuntimeType.InvokeDispMethod(String name, BindingFlags invokeAttr, Object target, Object[] args, Boolean[] byrefModifiers, Int32 culture, String[] namedParameters)
   at System.RuntimeType.InvokeMember(String name, BindingFlags invokeAttr, Binder binder, Object target, Object[] args, ParameterModifier[] modifiers, CultureInfo culture, String[] namedParameters)
   at VendorsTool.Engine.Core.VendorsEngine.LoadVendorsServices(String fileName, String& projectCommPath)
... 
```

当我从服务器机器上的 Windows 命令行使用与 cgi 脚本传递的完全相同的参数运行供应商应用程序时，它运行得很好，因此通过 Web 脚本调用他们的应用程序会导致问题。这个问题可能与安全有关，因为整个事情在 Windows XP Pro 机器上运行得很好（命令行和 Web 调用）。实际上，我在那里开发了我的 Web 脚本，并在我尝试将它移到 Windows Server 2003 机器之前让它在那里完全工作。那么，Windows Server 2003 机器有什么不同，它会阻止供应商的 .n​​et 应用程序被 web cgi 脚本成功执行？

我能否以某种方式解决此问题以使其在我的服务器上运行，或者供应商是否必须对其 .net 应用程序进行更改并发布新版本？我可能是世界上唯一一个试图从一个单独的程序执行这个供应商的应用程序的人，所以如果有一个我可以在我的服务器机器上实现自己的解决方法，我不想用这个问题来打扰供应商。另外，我有点着急，我不想等待 4 或 6 个月让供应商进行修复并部署新版本。

感谢您提供的任何建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-05-13T19:19:57.027

在我看来，您有权限问题。看起来您的 .NET 应用程序尝试使用 COM 对象，但它没有足够的权限来执行此操作。

每个 COM 对象（COM 服务器）都有启动/激活和访问权限（只需启动`dcomcnfg`并查看一些知名应用程序的 DCOM 配置）。关于`dcomcnfg`（组件服务），您不仅可以查看而且可以更改此权限（选择应用程序并在上下文菜单中打开属性对话框。然后选择“安全”选项卡，在“启动和激活权限”块中选择自定义，然后点击“编辑”）。典型的问题是 INTERACTIVE 用户对大多数 COM 对象具有启动/激活权限，但作为服务运行的进程不是该组的成员。因此，您必须通过授予某个帐户（由您的 Apache Web 服务器使用）或组（如`IIS_IUSRS`) 具有 INTERACTIVE 用户的相同启动权限。此权限信息将保存在密钥的子项中`HKEY_CLASSES_ROOT\AppID`（请参阅二进制`AccessPermission`注册表值）。

要识别出问题的 COM 对象，我建议您使用*Process Monitor*（请参阅[http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)）和*Process Explorer*（请参阅[http://technet.microsoft。 com/en-us/sysinternals/bb896653.aspx](http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx)）。*Process Monitor*可以帮助您准确找出您的程序 ( `$vendorsExecutable`) 尝试启动的其他进程。从最后一次访问到`HKEY_CLASSES_ROOT`用于启动 COM 对象。你会发现它是哪个进程。不要忘记在具有完全管理权限的帐户下启动此工具（在服务器上通常不存在此类问题）。要更快地找到您需要的信息，请使用进程监视器的进程名称过滤器和搜索功能。

如果你第一次做这样的工作，它看起来很复杂。这并不容易，但一切都有明确定义的逻辑，我敢肯定，你解决了这个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-20T22:08:13.367

典型的原因是您没有安装先决条件。很难说是哪个，因为 COM 类被很多应用程序使用。

找出缺失类的一种方法是 sysinternals 工具[进程监视器](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)。它可用于监控注册表的使用情况。这有助于您准确跟踪脚本试图加载的类。命名的 COM 类位于

```
HKEY_LOCAL_MACHINE\SOFTWARE\Classes 
```

并且它们的基础 GUID 条目位于

```
HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID 
```

如果 Apache 正在那里寻找一个条目但没有找到它，那可能是 perl 脚本缺少的 COM 类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-05-13T19:43:19.157

请告诉我这是否有帮助：[您在注册 ATL 服务器时收到“0x80040154（未注册类）”错误消息](http://support.microsoft.com/kb/201191/en-us)

取决于供应商开发了他的应用程序的工具，它可能是由于 DLL 注册引起的，实际上没有在您的 Windows Server 2003 上注册。

# php - 在 php 5.3 之前伪造后期静态绑定

> ID：890505
> 
> 赞同：11
> 
> 时间：2009-05-20T22:08:09.950
> 
> 标签：php, oop, static

我需要一个继承的静态函数“调用”来调用另一个已被覆盖的静态函数“内部”。我可以使用后期静态绑定来做到这一点，但我的主机还没有 php5.3，所以我需要解决它。

```
class ClassA{
    static function call()
    {
        return self::inner();
    }

    static function inner(){
        return "Class A";
    }   
}

class ClassB extends ClassA{
    static function inner(){
        return "Class B";
    }
}

echo "<p>Class A = " . ClassA::call();
echo "<p>Class B = " . ClassB::call(); 
```

我希望输出为：
A 类 = A
类 B 类 = B 类

但它是什么：
A 类 = A
类 B 类 = A 类

我的直觉告诉我，我应该能够在 call() 中写一些东西来检测当“call()”被调用时引用的对象。所以不是 self::inner() 而是类似于 callclass::inner() 的东西。检测正确版本的 inner() 以从原始方法调用中调用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-10-12T14:10:29.810

如果性能不是问题，您可以使用 debug_backtrace() 查找被调用的类：

```
$bt = debug_backtrace();
return get_class($bt[1]['object']); 
```

[http://php.net/manual/en/function.debug-backtrace.php](http://php.net/manual/en/function.debug-backtrace.php)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-01-27T05:43:42.750

这是一个简单的例子。

```
<?php

class ClassA{
   public function call(){
      return $this->inner();
   }

   static function inner(){
      return "Class A";
   }

   static function init($class){
      return new $class();
   }   
}

class ClassB extends ClassA{
   static function inner(){
      return "Class B";
   }
}

echo "<p>Class A = " . ClassA::init("ClassA")->call();
echo "<p>Class B = " . ClassB::init("ClassB")->call();

?> 
```

如果你不喜欢传入类名，你可以向子类添加一个静态初始化函数，并在那里显式传递它。这将允许您执行以下操作： ClassA::init()->call() 和 ClassB::init()->call() 但会有一些小的代码重复。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-20T22:20:57.523

不幸的是，没有很好的方法来做到这一点（否则 PHPers 不会为该功能欢呼这么多）。

你*必须*传递类名。PHP < 5.3 也没有很好的语法来使用动态类名的静态调用，这使得整个事情变得更加丑陋：

```
static function call($class)
{
    return call_user_func(array($class,"inner"));
}
…
ClassA::call("ClassA");
ClassB::call("ClassB"); 
```

如果您可以更改代码（而不是使用`static`），那么单例会使其更容易忍受。您可以制作辅助*函数*来简化语法：

```
X("ClassA")->call();
X("ClassB")->call(); 
```

X 函数应该查找、创建和返回类的实例。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-20T23:54:44.447

您可以使用对象实例而不是类。如果你想要一个全局符号，你可以使用一个全局变量。由于它们在 PHP 中相当笨拙，因此一个技巧是将其包装在一个函数中。例如。：

```
class ClassA {
  function call() {
    return $this->inner();
  }
  function inner() {
    return "Class A";
  }   
}
function ClassA() {
  static $instance;
  return $instance ? $instance : new ClassA();
}

class ClassB extends ClassA {
  function inner() {
    return "Class B";
  }
}
function ClassB() {
  static $instance;
  return $instance ? $instance : new ClassB();
}

echo "<p>Class A = " . ClassA()->call();
echo "<p>Class B = " . ClassB()->call(); 
```

但是更好的主意可能是完全避免使用全局符号。它在 Ruby/Rails 中运行良好的原因是 Ruby 并不像 PHP 那样真正具有静态状态。可以在运行时重新绑定和添加一个类，这样可以轻松扩展框架。在 PHP 中，类总是最终的，因此在应用程序代码中引用它们是一种很强的耦合度。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-11-24T17:06:10.110

通常，当子调用父的方法时需要后期静态绑定，而父的方法又调用子的抽象静态方法。我处于这样的位置，并且无法使用 static:: 因为我的 PHP 不是 5.3 版（或更高版本）。下面通过 debug_backtrace() 完成后期静态绑定。

```
abstract class ParentClass
{
    static function parent_method()
    {
        $child_class_str = self::get_child_class();
        eval("\$r = ".$child_class_str."::abstract_static();");
        return $r;
    }// CHILD MUST OVERRIDE TO PUT ITSELF INTO TRACE

    protected abstract static function abstract_static(); // THIS NEEDS LATE STATIC BINDING

    private static function get_child_class()
    {
        $backtrace = debug_backtrace();
        $num = count($backtrace);
        for($i = 0; $i < $num; $i++)
        {
             if($backtrace[$i]["class"] !== __CLASS__)
                  return $backtrace[$i]["class"];
        }
        return null;
    }
}

class ChildClass extends ParentClass
{
    static function parent_method(){ return parent::parent_method(); }

    protected static function abstract_static()
    {
        return __METHOD__."()";
    }// From ParentClass
}

print "The call was: ". ChildClass::parent_method(); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-12-24T16:12:53.213

由于您不能使用 static:: 或 get_call_class() 或 __callStatic，因此您必须使用被调用类的某些指示调用 inner() 函数（如其他答案中所述）。被调用类的实例会很好。您可以添加“伪静态”方法来模仿您需要覆盖的每个静态方法。这会使您的代码加倍，但是通过执行以下操作，我希望一旦 php5.3 出现，代码更容易升级：只需删除所有*ps*方法和引用它们的所有函数（并将“self”更改为“static”，其中需要..）

```
class ClassA{
    static function call()
    {
        return self::inner();
    }

    static function inner(){
        return "Class A";
    } 

    public function _ps_call()
    {
        return $this->_ps_inner();
    }

}

class ClassB extends ClassA{

    public static function getInstance() 
    {
        return new self();
    }

    public static function call() 
    {
        return self::getInstance()->_ps_call();
    }

    static function inner()
    {
        return "Class B";
    }   

    public function _ps_inner()
    {
        return self::inner();
    }
}

echo "<p>Class A = " . ClassA::call();
echo "<p>Class B = " . ClassB::call(); 
```

# sql - 如何从通用审计表中检索值，该表被重组为 SQL 中具有有意义的列名的行集？

> ID：890516
> 
> 赞同：0
> 
> 时间：2009-05-20T22:11:04.530
> 
> 标签：sql

所以我有这个审计表，看起来像这样：

```
USE [DatabaseName]
GO
/****** Object:  Table [ERAUser].[Audit]    Script Date: 05/20/2009 17:07:11 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [ERAUser].[Audit](
    [AuditID] [int] IDENTITY(1,1) NOT NULL,
    [Type] [char](1) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
    [TableName] [varchar](128) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
    [PrimaryKeyField] [varchar](1000) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
    [PrimaryKeyValue] [varchar](1000) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
    [FieldName] [varchar](128) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
    [OldValue] [varchar](1000) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
    [NewValue] [varchar](1000) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
    [UpdateDate] [datetime] NULL DEFAULT (getdate()),
    [UserName] [varchar](128) COLLATE SQL_Latin1_General_CP1_CI_AS NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF 
```

问题是，由于我无法控制的原因，我需要将数据作为复制源表的行集返回给用户（作为该系统用户的其他开发人员）。我怎样才能把这个模式倒过来，并将 FieldName 中的值作为行集的列标题？我使用的是 SQL 2005。我会知道表名和更新日期。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-20T22:16:08.000

这可以使用 PIVOT 功能来完成。我将尝试制定一个示例：

```
SELECT *
FROM ERAUser.Audit
PIVOT (max(NewValue) FOR FieldName in (Field1, Field2, Field3)) as PivotTable 
```

max() 是必要的，它可以告诉 Sql Server 如果发现多行具有相同的 FieldName 该怎么做。您可以使用 WHERE 语句将其限制为正确的行；如果您确保它只找到一个，则 max(NewValue) 等于 NewValue。

如果您有很长的列列表，您可以为此生成 SQL：

```
declare @columnlist nvarchar(4000)
select @columnlist = IsNull(@columnlist + ', ', '') + FieldName
from (
    select distinct FieldName from ERAUser.Audit
) sub

declare @query nvarchar(4000)
select @query = 'select *
from ERAUser.Audit
PIVOT (max(newValue) FOR FieldName in (' + @columnlist + ')) as PivotTable'

exec sp_executesql @query 
```

这是 PIVOT 的一个基本示例，以了解总体思路：

```
create table #normalized (
    colname varchar(12),
    value varchar(12)
)

insert into #normalized values ('value1','A')
insert into #normalized values ('value2','B')
insert into #normalized values ('value3','C')

select *
from #normalized
PIVOT (max(value) FOR ColName in (value1,value2,value3)) as Y 
```

这将导致：

```
value1    value2    value3
A         B         C 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-20T22:19:26.497

这将非常困难，尤其是因为表名和列名的一种组合的值类型将与其他类型不同。要创建与表的一行相对应的完整记录，您将不得不合并多个审计记录。因此，您的行集必须一次针对一个表进行定制。目前尚不清楚您是否记录了未更改的列 - 您可能没有 - 因此处理包含整个记录的行集将是困难的，充其量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-20T22:43:40.893

如果您知道只需要从一个表（例如“Foo”）返回行并假设要创建的所有字段都是 varchar(50)：

1）使用您需要的结构创建一个临时表

```
DECLARE @Sql VARCHAR(8000)
DECLARE @ColName VARCHAR(128)
DECLARE @Comma VARCHAR(2)

SET @CreateSql = "CREATE TABLE #Temp ("
SET @Comma = ''

DECLARE columnCur CURSOR FOR
SELECT DISTINCT FieldName
FROM Audit
WHERE TableName = 'Foo'

OPEN columnCur

FETCH NEXT FROM columnCur INTO @ColName

WHILE @@FETCH_STATUS = 0
BEGIN
  SET @CreateSql = @CreateSql+@Comma+@ColName+' VARCHAR(128) NULL'
  SET @Comma = ', '
  FETCH NEXT FROM columnCur INTO @ColName
END

CLOSE columnCur
DEALLOCATE columnCur

SET @CreateSql = @CreateSql + ")"

EXECUTE sp_executesql @CreateSql 
```

2）填写表格主键：

```
--Assuming a single PK column, otherwise you need another cursor

DECLARE @pk VARCHAR(1000)

SELECT @pk=PrimaryKeyField
FROM Audit
WHERE TableName = 'Foo'

DECLARE @PkSql VARCHAR(2000)
SET @PkSql = 'INSERT INTO #Temp ('+@pk+') VALUES SELECT DISTINCT PrimaryKeyValue FROM Audit WHERE TableName = ''Foo'''

EXECUTE sp_executesql @PkSql 
```

3）创建一个创建动态sql的游标，用正确的值更新临时表中的行（与上面类似的样式）

4）从#Temp中选择

5) 删除#Temp

注意：这应该可以，但它完全未经测试，因为我现在没有可用的 SQL Server。

# asp.net - 设计支持子站点的 ASP.NET 应用程序

> ID：890518
> 
> 赞同：3
> 
> 时间：2009-05-20T22:12:09.240
> 
> 标签：asp.net, asp.net-mvc, multi-tenant

我正在设计一个必须支持“子站点”的 ASP.NET 应用程序。

这个想法是让超级管理员管理所有用户、全局应用程序设置和子站点。每个子站点都有一些自己的设置（例如本地管理员、徽标和欢迎消息），每个子站点都有自己的注册用户列表。

这与使用 Joomla、SharePoint 或 DotNetNuke 等 CMS 获得的结果非常相似。事实上，我很想使用这样的平台，但其他项目要求阻止我这样做。

在这一点上，我的问题非常笼统：

1.  使用[ASP.NET 2.0 Membership](https://msdn.microsoft.com/en-us/library/ms998347.aspx)，**我将如何指定超级管理员并根据用户注册的 SubSite 对用户进行分类**？
2.  **我将如何实现子站点（应该使用什么模式等）**？我对解释其他人如何做到这一点的文章特别感兴趣。我想学习其他人已经获得的最佳实践，而无需花费数天时间深入研究像 DotNetNuke 这样的大型开源项目的源代码。

我在 ASP.NET MVC 1.0 中实现了这一点，所以类似的例子会很有帮助。

* * *

**更新：** 我喜欢[Mike Hadlow 实现多租户的方式](https://mikehadlow.blogspot.com/2008/11/multi-tenancy-part-2-components-and.html)，我决定以他的工作为起点。有关我如何使用每个拥有自己[独立数据库](https://ayende.com/Blog/archive/2008/08/07/Multi-Tenancy--The-Physical-Data-Model.aspx)的租户的信息，请参阅[这篇文章](https://stackoverflow.com/questions/922891/inject-a-membershipprovider-into-asp-net-mvc-accountcontroller)。这解决了我的会员资格“基于子网站”的问题。`SqlMembershipProvider`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-21T01:39:59.367

您正在尝试的通常称为“[多租户](http://en.wikipedia.org/wiki/Multitenant)”，而不是“子站点”

有一个[与此类似的问题](https://stackoverflow.com/questions/483414/converting-single-db-asp-net-site-into-multitenant-membership-and-roles-dilema)，接受的答案听起来很合理。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-20T22:33:07.577

如果我不理解“子站点”的含义，请原谅我，您是否使用该术语来指代在大型主站点中创建迷你站点的想法？如果是这样，我想我理解你想要做什么，但我不得不说，asp.net 2.0 中的会员系统在很大程度上是一个框架，你需要在其中操作才能创建你想要的东西。

无论如何，*我*会怎么做（这是基于开箱即用的.net Membership）：

ASP.NET 允许您将“角色”附加到用户，并将“配置文件”属性附加到这些用户。配置文件用于将诸如“电话号码”和其他元数据之类的内容附加给用户，但您也可以使用它来将他们的家庭“子站点”附加到他们。

我会创建一个名为“globaladmin”的角色，将自己创建为用户，然后将您（并且只有您）分配给该角色。然后，我将创建一个“站点管理员”角色并将每个子站点的管理员用户分配给该角色，但要非常小心地为他们分配一个“站点”配置文件条目，该条目的值与他们所管理的站点相对应。

例如，“user123”将分配给“siteadmin”角色，他们的“站点”配置文件属性可以是“subsitexyz”。然后他们将被标识为该站点的管理员。

以上是可行的，但如果你真的想让它尽可能光滑，**创建你自己的 MembershipProvider (SubsiteMembershipProvider) 并创建一个新的 SubsiteMembershipUser 类**，该类继承自你的新提供者返回的 MembershipUser。然后，您可以将自己的属性添加到您的应用可以查询的 SubsiteMembershipUser 以找出用户所属的站点：

```
//get current logged on user - cast it to our custom membership user object
SubsiteMembershipUser thisUser = (SubsiteMembershipUser)GetUser(); 
if(thisUser.SubsiteName == SiteUserIsBrowsingString
&& Roles.IsUserInRole(thisUser.UserName, "siteadmin"))
  //user is admin for this site so do something 
```

# php - 每行返回多行（在 Zend 框架中）

> ID：890529
> 
> 赞同：1
> 
> 时间：2009-05-20T22:15:32.477
> 
> 标签：php, sql, mysql, database, zend-framework

我有一个包含这些表的 MySQL 数据库：

```
sessions
--------
sessionid (INT)
[courseid (INT)]
[locationid (INT)]
[comment (TEXT)]

dates
-----
dateid (INT)
sessionid (INT)
date (DATE)

courses
-------
...

locations
---------
... 
```

每个会话都有一个唯一的 sessionid，每个日期都有一个唯一的 dateid。但是日期不一定有唯一的 sessionid，因为会话可以跨越可变数量的日期（不一定是连续的）。

选择每一整行只是在 sessionid 上加入表的问题。但是，我正在寻找一种方法来返回特定 courseid 的行集，其中该行集中的每一行代表一个位置，并包含另一个行集，每个行集包含单个会话，该会话又包含另一个行集，其中包含所有该会议的日期：

```
course
    location
        sesssion
            date
            date
        session
            date
            date
            date
    location
        ... 
```

这是因为我使用 Zend Framework 从 PHP 查询这个数据库，它有一个很好的接口，可以以面向对象的方式操作行和行集。

最终，我试图向视图输出一个“时间表”，首先按课程组织，然后是位置，然后是日期。理想情况下，我可以将每一行作为一个位置进行迭代，然后对于每个位置，迭代每个会话，然后对于每个会话，迭代每个日期。

我正在考虑通过分别查询所有位置、会话和日期来做到这一点。然后，我将每个行集转换为一个数组，并将每个会话数组添加为位置数组的成员，并将每个日期数组添加为会话数组的成员。

然而，这感觉非常笨拙，并且没有为我提供以面向对象的方式处理行的能力。

我想知道是否有：

a) 用于表示这些数据的更好的表模式；

b）我不知道的 sql 查询；

c) Zend_Db 中允许我将行集分配给行集的方法

如果我在任何地方不清楚，请告诉我，并提前感谢。

（交叉手指说这不会出现在日常的wtf中......）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-20T23:21:19.990

当我必须处理来自多个表的数据时，我在使用 Zend Frameworks 数据库抽象类时遇到了很多问题。运行的查询数量和生成的所有对象的开销使我的托管服务器陷入瘫痪。从那以后，我又回到编写查询来收集我的所有数据，然后遍历数据来构建我的显示。它不像使用抽象层那样漂亮或面向对象，但它也不会将我的 PHP 脚本页面写入磁盘只是为了显示一个充满数据的表格。

正如史蒂夫提到的基准测试你最终得到的任何解决方案，我也会分析你的内存使用情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-20T22:49:07.653

您可以使用 Zend_Db_Table 的关系特性来处理这种情况。如果您当前使用 Zend_Db_Aadpter 进行查询，则需要为会话、日期、课程等创建表包装类。

[http://framework.zend.com/manual/en/zend.db.table.relationships.html](http://framework.zend.com/manual/en/zend.db.table.relationships.html)

它与您描述的分别查询每个数据集的方法没有太大区别，但它为您提供了一个直接的 OO 接口，用于检索给定记录的适当相关数据。

如果你走这条路，你会想做一些基准测试，因为它可能会执行很多查询。

# c - char * const 和 const char * 有什么区别？

> ID：890535
> 
> 赞同：334
> 
> 时间：2009-05-20T22:16:22.693
> 
> 标签：c, pointers, constants

有什么区别：

```
char * const 
```

和

```
const char * 
```

* * *

## 回答 #1

> 赞同：421
> 
> 时间：2009-05-20T22:21:22.060

区别在于它`const char *`是指向 a 的指针`const char`，而是指向`char * const`a 的常量指针`char`。

首先，指向的值不能改变，但指针可以。第二，被指向的值可以改变，但指针不能改变（类似于引用）。

还有一个

```
const char * const 
```

这是一个指向常量 char 的常量指针（因此不能更改它）。

笔记：

以下两种形式是等价的：

```
const char * 
```

和

```
char const * 
```

其确切原因在 C++ 标准中进行了描述，但重要的是要注意并避免混淆。我知道几个更喜欢的编码标准：

```
char const 
```

超过

```
const char 
```

（带或不带指针），以便`const`元素的放置与带指针的位置相同`const`。

* * *

## 回答 #2

> 赞同：126
> 
> 时间：2009-05-21T00:08:42.187

为避免混淆，请始终*附加*const 限定符。

```
int       *      mutable_pointer_to_mutable_int;
int const *      mutable_pointer_to_constant_int;
int       *const constant_pointer_to_mutable_int;
int const *const constant_pointer_to_constant_int; 
```

* * *

## 回答 #3

> 赞同：56
> 
> 时间：2009-05-20T22:36:58.253

`const`总是修改它之前的东西（在它的左边），除非它是类型声明中的第一件事，它会修改它之后的东西（在它的右边）。

所以这两个是一样的：

```
int const *i1;
const int *i2; 
```

他们定义了指向 a 的指针`const int`。您可以更改位置`i1`和`i2`点，但不能更改它们指向的值。

这：

```
int *const i3 = (int*) 0x12345678; 
```

定义一个`const`指向整数的指针并将其初始化为指向内存位置 12345678。您可以更改`int`地址 12345678 处的值，但不能更改`i3`指向的地址。

* * *

## 回答 #4

> 赞同：26
> 
> 时间：2009-05-20T22:20:37.397

`const char*`是指向常量字符
`char* const`的指针 是指向字符的常量指针
`const char* const`是指向常量字符的常量指针

* * *

## 回答 #5

> 赞同：23
> 
> 时间：2009-05-20T22:22:43.977

`const * char`是无效的 C 代码并且没有意义。也许您的意思是问 a`const char *`和 a之间`char const *`的区别，或者可能是 a`const char *`和 a之间的区别`char * const`？

### 也可以看看：

*   [什么是 const 指针（与指向 const 对象的指针相反）？](https://stackoverflow.com/questions/219914/what-use-are-const-pointers-as-opposed-to-pointers-to-const-objects)
*   [C中的常量](https://stackoverflow.com/questions/162480/const-in-c)
*   [C++ 中 const 声明的区别](https://stackoverflow.com/questions/487048/difference-between-const-declarations-in-c)
*   [C++ 常量问题](https://stackoverflow.com/questions/269882/c-const-question)
*   [为什么我可以更改 const char* 变量的值？](https://stackoverflow.com/questions/440331/why-can-i-change-the-values-of-a-const-char-variable)

* * *

## 回答 #6

> 赞同：17
> 
> 时间：2016-07-08T00:59:44.503

**经验法则：**从右到左阅读定义！

* * *

### `const int *foo;`

意思是“将`foo`( `*`) 指向一个`int`不能改变的 ( `const`)”。对于程序员来说，这意味着“我
不会改变指向的*值”。*`foo`

*   `*foo = 123;`否则`foo[0] = 123;`无效。
*   `foo = &bar;`被允许。

* * *

### `int *const foo;`

表示“`foo`不能改变 ( `const`) 并将 ( `*`) 指向一个`int`”。
对于程序员来说，这意味着“我不会更改所引用的内存地址” *。*`foo`

*   `*foo = 123;`或被`foo[0] = 123;`允许。
*   `foo = &bar;`将是无效的。

* * *

### `const int *const foo;`

意思是“`foo`不能改变 ( `const`) 并且将 ( ) 指向`*`不能`int`改变的 ( `const`)”。
对于程序员来说，这意味着“我不会改变指向的*值*，也不会改变指向的*地址*”。`foo`*`foo`*

 **   `*foo = 123;`否则`foo[0] = 123;`无效。
*   `foo = &bar;`将是无效的。

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2012-07-04T18:19:54.033

1.  **const char* x**这里 X 基本上是一个字符指针，它指向一个常量值

2.  **char* const x**是指字符指针，它是常量，但它指向的位置可以改变。

3.  **const char* const x**是 1 和 2 的组合，表示它是一个指向常量值的常量字符指针。

4.  **const *char x**将导致编译器错误。它不能被声明。

5.  **char const * x**等于点 1。

经验法则是，如果**const**带有 var 名称，则*指针将保持不变，但指向的位置可以更改*，否则*指针将指向一个恒定的位置，并且指针可以指向另一个位置，但指向的位置内容不能更改*。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-05-20T22:21:59.877

第一个是语法错误。也许你的意思是之间的区别

```
const char * mychar 
```

和

```
char * const mychar 
```

在这种情况下，第一个是指向无法更改的数据的指针，第二个是始终指向相同地址的指针。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2013-01-25T09:43:17.600

另一个经验法则是检查**const**在哪里：

1.  ***** =>之前存储的**值是****常数**
2.  ***** =>之后**指针**本身是**常量**

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2017-04-14T18:01:04.910

许多答案提供了具体的技术、经验法则等来理解这个特定的变量声明实例。但是有一种通用的技术可以理解任何声明：

> # ****[顺时针/螺旋规则](http://c-faq.com/decl/spiral.anderson.html)****

 **一种）

```
const char *a; 
```

根据顺时针/螺旋规则`a`是指向不变的字符的指针。这意味着字符是恒定的，但指针可以改变。ie`a = "other string";`很好，但是`a[2] = 'c';`编译失败

二）

```
char * const a; 
```

根据规则，`a`是指向字符的 const 指针。即你可以做`a[2] = 'c';`但你不能做`a = "other string";`

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2015-11-27T10:49:50.987

**char * const 和 const char *?**

1.  指向一个常数值

`const char * p;` // 值不能改变

2.  指向值的常量指针

`char * const p;` //地址不能更改

3.  指向常量值的常量指针

`const char * const p;` // 两者都不能更改。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-05-20T22:21:15.993

我想你的意思是 const char * 和 char * const 。

第一个，const char *，是一个指向常量字符的指针。指针本身是可变的。

第二个，char * const 是一个指向字符的常量指针。指针不能改变，它指向的字符可以。

然后是 const char * const 指针和字符不能改变。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2013-03-04T10:21:51.250

这里有详细的代码说明

```
/*const char * p;
char * const p; 
const char * const p;*/ // these are the three conditions,

// const char *p;const char * const p; pointer value cannot be changed

// char * const p; pointer address cannot be changed

// const char * const p; both cannot be changed.

#include<stdio.h>

/*int main()
{
    const char * p; // value cannot be changed
    char z;
    //*p = 'c'; // this will not work
    p = &z;
    printf(" %c\n",*p);
    return 0;
}*/

/*int main()
{
    char * const p; // address cannot be changed
    char z;
    *p = 'c'; 
    //p = &z;   // this will not work
    printf(" %c\n",*p);
    return 0;
}*/

/*int main()
{
    const char * const p; // both address and value cannot be changed
    char z;
    *p = 'c'; // this will not work
    p = &z; // this will not work
    printf(" %c\n",*p);
    return 0;
}*/ 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2015-04-23T17:38:27.987

```
// Some more complex constant variable/pointer declaration.
// Observing cases when we get error and warning would help
// understanding it better.

int main(void)
{
  char ca1[10]= "aaaa"; // char array 1
  char ca2[10]= "bbbb"; // char array 2

  char *pca1= ca1;
  char *pca2= ca2;

  char const *ccs= pca1;
  char * const csc= pca2;
  ccs[1]='m';  // Bad - error: assignment of read-only location ‘*(ccs + 1u)’
  ccs= csc;    // Good

  csc[1]='n';  // Good
  csc= ccs;    // Bad - error: assignment of read-only variable ‘csc’

  char const **ccss= &ccs;     // Good
  char const **ccss1= &csc;    // Bad - warning: initialization from incompatible pointer type

  char * const *cscs= &csc;    // Good
  char * const *cscs1= &ccs;   // Bad - warning: initialization from incompatible pointer type

  char ** const cssc=   &pca1; // Good
  char ** const cssc1=  &ccs;  // Bad - warning: initialization from incompatible pointer type
  char ** const cssc2=  &csc;  // Bad - warning: initialization discards ‘const’
                               //                qualifier from pointer target type

  *ccss[1]= 'x'; // Bad - error: assignment of read-only location ‘**(ccss + 8u)’
  *ccss= ccs;    // Good
  *ccss= csc;    // Good
  ccss= ccss1;   // Good
  ccss= cscs;    // Bad - warning: assignment from incompatible pointer type

  *cscs[1]= 'y'; // Good
  *cscs= ccs;    // Bad - error: assignment of read-only location ‘*cscs’
  *cscs= csc;    // Bad - error: assignment of read-only location ‘*cscs’
  cscs= cscs1;   // Good
  cscs= cssc;    // Good

  *cssc[1]= 'z'; // Good
  *cssc= ccs;    // Bad - warning: assignment discards ‘const’
                 //                qualifier from pointer target type
  *cssc= csc;    // Good
  *cssc= pca2;   // Good
  cssc= ccss;    // Bad - error: assignment of read-only variable ‘cssc’
  cssc= cscs;    // Bad - error: assignment of read-only variable ‘cssc’
  cssc= cssc1;   // Bad - error: assignment of read-only variable ‘cssc’
} 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2015-10-23T13:55:43.683

1.  **常量指针**：常量指针在整个程序中只能指向相应数据类型的单个变量。我们可以改变指针所指向的变量的值。初始化应在声明本身期间完成。

句法：

```
datatype *const var; 
```

`char *const`属于这种情况。

```
/*program to illustrate the behaviour of constant pointer */

#include<stdio.h>
int main(){
  int a=10;
  int *const ptr=&a;
  *ptr=100;/* we can change the value of object but we cannot point it to another variable.suppose another variable int b=20; and ptr=&b; gives you error*/
  printf("%d",*ptr);
  return 0;
} 
```

2.  **指向 const 值**的指针：在这种情况下，指针可以指向任意数量的相应类型的变量，但我们不能在特定时间更改指针指向的对象的值。

句法：

`const datatype *var`或者`datatype const *var`

`const char*`属于这种情况。

```
/* program to illustrate the behavior of pointer to a constant*/

   #include<stdio.h>
   int main(){
       int a=10,b=20;
       int const *ptr=&a;
       printf("%d\n",*ptr);
       /*  *ptr=100 is not possible i.e we cannot change the value of the object pointed by the pointer*/
       ptr=&b;
       printf("%d",*ptr);
       /*we can point it to another object*/
       return 0;
    } 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2016-07-21T04:31:55.680

`const`修饰符应用于紧靠其左侧的术语。唯一的例外是当它的左边没有任何东西时，它适用于它右边的东西。

这些都是说“指向常量的常量指针”的等效方式`char`：

*   `const char * const`
*   `const char const *`
*   `char const * const`
*   `char const const *`

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2016-11-17T06:14:15.987

两条规则

1.  `If const is between char and *, it will affect the left one.`
2.  `If const is not between char and *, it will affect the nearest one.`

例如

1.  `char const *. This is a pointer points to a constant char.`
2.  `char * const. This is a constant pointer points to a char.`

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2018-01-20T15:49:26.940

我想指出 using `int const *`(or `const int *`) 不是指向一个`const int`变量的指针，而是这个变量是`const`针对这个特定的指针的。

例如：

```
int var = 10;
int const * _p = &var; 
```

上面的代码编译得很好。`_p`指向一个`const`变量，尽管`var`它本身不是常数。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2019-11-29T14:46:03.843

我记得捷克关于 C 的书：阅读你从变量开始然后向左走的声明。因此对于

```
char * const a; 
```

你可以读为：“`a`是类型常量指针的变量`char`”，

```
char const * a; 
```

您可以读作：“`a`是指向 char 类型的常量变量的指针。我希望这会有所帮助。

奖金：

```
const char * const a; 
```

您将按原样读取`a`指向 char 类型的常量变量的常量指针。

# nsis - nsis：如何创建开始菜单快捷方式来打开文件夹？

> ID：890537
> 
> 赞同：5
> 
> 时间：2009-05-20T22:16:38.577
> 
> 标签：nsis

我的 NSIS 安装程序会创建开始菜单链接来运行和卸载我的应用程序。

**使用 NSIS，如何创建 StartMenu 快捷方式以在 Windows 资源管理器中打开文件夹？**

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-20T22:46:11.700

与任何其他快捷方式相同

```
CreateShortcut "$smprograms\my app\my shortcut.lnk" "c:\path\to\folder" 
```

这是资源管理器 99% 的时间，它确实是你想要的，但是如果你想强制资源管理器

```
CreateShortcut "$smprograms\my app\my shortcut.lnk" "$windir\explorer.exe" '/e,"c:\path\to\folder"' 
```

但是那个快捷方式会有错误的图标等

# delphi - 根据过滤器字符串检查 TDataSet 行

> ID：890541
> 
> 赞同：4
> 
> 时间：2009-05-20T22:17:52.817
> 
> 标签：delphi, filter, devexpress, tdataset, tdxmemdata

我在内存 TDataSet 后代中使用**DevExpress TdxMemData 。**虽然它具有 Filtered: Boolean 和 Filter: String 属性，但实际上并没有自动对它们执行任何操作，而是依赖于 OnFilterRecord 事件的 Accept 参数的结果。

所以我正在寻找的是一种解析过滤器文本并将其应用于数据集的方法（可能在 TdxMemData 或 DevExpress 代码套件中的其他地方）。

理想情况下，我想要一种针对过滤器测试单个行的方法，以查看它是否匹配而不将其从数据集中过滤出来（我想突出显示与过滤器匹配的行）。

示例过滤器字符串：

```
((Name = 'Jim') and (Rep > 1000)) or (Rep > 5000) 
```

所以有嵌套的and's and or's。它实际上是由 DevExpress TcxDBFilterControl 构建的。

我真的希望我缺少一些简单的东西。

**更新：**我向[DevExpress 开了一张票，](http://www.devexpress.com/Support/Center/p/Q206534.aspx)看看他们是否支持任何类型的解决方案。我确实找到了[他们不支持](http://www.devexpress.com/Support/Center/KB/p/A999.aspx)在 TdxMemData 上过滤的答案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-20T23:18:25.470

我知道这不是您要寻找的答案，但 TdxMemData 数据集不支持过滤器字符串。要使用过滤器，可以编写您自己的 OnFilterRecord 事件，也可以将 ProgrammedFilter 设置为 true，然后使用过滤的记录列表填充 FilterList（在运行时）。

一种可能性是编写您自己的解析器以将过滤器字符串与 OnFilterRecord 事件中的当前记录进行比较。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-20T23:35:43.097

您可能想看看用 TkbmMemTable 替换[TdxMemData](http://www.components4programmers.com/products/kbmmemtable/index.htm)。它是免费的，工作方式类似于 DX 组件，并支持过滤字符串。与在 OnFilterRecord 中实现过滤器字符串解析器相比，移植所需的时间可能要少得多！它可以与其他 DX 组件一起使用而不会出现问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-21T21:55:04.137

您正在寻找的不是过滤数据，而是在满足条件时以不同方式显示它的问题。如果您使用 TDBGrid 来显示数据，请查看 TDBGrid 上的 DrawColumnCell() 事件：

```
procedure TForm1.dbgrd1DrawColumnCell(Sender: TObject; const Rect: TRect;
  DataCol: Integer; Column: TColumn; State: TGridDrawState);
var
  DBG: TDBGrid;
begin
  DBG := TDBGrid(Sender);
  // Add any other conditions from your 'filter' here in the next line.
  if (YourData.FieldByName('WHATEVER').AsString = 'Jim') and
     (YourData.FieldByName('REP').AsInteger > 1000) then
    Column.Font.Color := clRed;
  DBG.DefaultDrawColumnCell(Rect, DataCol, Column, State);
end; 
```

由于您使用的是 TdxMemData，因此您可能也在使用 DevEx 网格。除了默认绘图之外，它必须有类似的方式来执行其他操作；你可以在那里使用类似的技术。（我已经有几年没用过 DevEx 的东西了；现在的雇主不喜欢它们，因此不会花这笔钱。:-()

# encoding - 亚马逊 EC2 上的 MP3 转换

> ID：890552
> 
> 赞同：2
> 
> 时间：2009-05-20T22:20:30.283
> 
> 标签：encoding, mp3, amazon-ec2

我经营一家小型唱片公司，我们在亚马逊的 S3 上存储了一堆音频文件。我们希望它们转换为具有标准比特率的 MP3。我读到了 NYTimes 使用 EC2 转换所有 PDF 的内容，因为我是一个书呆子的网络程序员，所以我很感兴趣。与其下载所有文件并手动转换它们，我想知道设置 EC2 实例并设置它以转换文件需要什么？我希望能够使用 PHP 从我的 Web 服务器控制它，那么创建虚拟 LAMP 堆栈并安装 LAME 编码器的方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-20T22:54:25.910

如果您想将音频文件（我假设为 .wav，因为它是一种非常常见的格式预格式转换）转换为 mp3，LAME 是一个可靠的编码器。

使用 LAME 非常不需要完整的 LAMP 堆栈，一个简单的 shell 脚本就足够了。

这会将当前目录中的所有 *.wav 文件转换为 .mp3 文件，如果它们没有就地转换的副本（LAME 不关心破坏输出文件）。

```
#!/bin/bash
for file in *.wav; do
  dest="${file%wav}mp3"
  if [[ -e "$file" ]] && [[ ! -e "$dest" ]]; then
    lame "$file" "$dest"
  fi
done 
```

您将需要查看`man lame`特定于您的 VBR/CBR/ABR（可变、恒定和平均比特率）需求的转换选项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-20T23:06:22.250

如果您已经在本地 EC2 中拥有文件，则上述答案将起作用，但您必须将每首歌曲从 S3 提取到 EC2 中，或者放入管道进行转换或放入临时文件，然后将其通过管道传输回 S3或将其存储在临时文件中，然后将其发送回 EC2。

实际上没有使用过 EC2，所以不确定您使用的是哪种存储，但您应该有足够的空间来存储一个临时 mp3。

您可能还想创建某种跟踪状态的方式，可能是在开始之前在您的存储桶上列出。

使用 S3 模块的 perl 脚本可能更适合，但我懒得在这里输入所有内容:)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-20T23:13:35.670

您可以为此使用 Elastic MapReduce。尽管您必须花点时间才能让它吐出单独的文件作为输出。

# c# - 即时或在构建时连接和缩小 JavaScript - ASP.NET MVC

> ID：890561
> 
> 赞同：46
> 
> 时间：2009-05-20T22:21:33.947
> 
> 标签：c#, javascript, css, asp.net-mvc, minify

作为这个问题的一个扩展，[在用户控件中链接 JavaScript 库](https://stackoverflow.com/questions/885990/linking-javascript-libraries-in-user-controls/886184#886184)我正在寻找一些关于人们如何在运行中或在构建时连接和缩小 JavaScript 的示例。我还想看看它是如何在您的母版页中工作的。

我不介意页面特定的文件像当前那样被单独缩小和链接（见下文），但主母版页上的所有 JavaScript 文件（我有大约 5 或 6 个）我想连接和缩小。

任何还包含 CSS 连接和缩小的人的奖励积分！:-)

当前母版页包含我想要连接和缩小的常见 JavaScript 文件：

```
<%@ Master Language="C#" Inherits="System.Web.Mvc.ViewMasterPage" %>
<head runat="server">
    ... BLAH ...
    <asp:ContentPlaceHolder ID="AdditionalHead" runat="server" />
    ... BLAH ...
    <%= Html.CSSBlock("/styles/site.css") %>
    <%= Html.CSSBlock("/styles/jquery-ui-1.7.1.css") %>
    <%= Html.CSSBlock("/styles/jquery.lightbox-0.5.css") %>
    <%= Html.CSSBlock("/styles/ie6.css", 6) %>
    <%= Html.CSSBlock("/styles/ie7.css", 7) %>
    <asp:ContentPlaceHolder ID="AdditionalCSS" runat="server" />
</head>
<body>
    ... BLAH ...
    <%= Html.JSBlock("/scripts/jquery-1.3.2.js", "/scripts/jquery-1.3.2.min.js") %>
    <%= Html.JSBlock("/scripts/jquery-ui-1.7.1.js", "/scripts/jquery-ui-1.7.1.min.js") %>
    <%= Html.JSBlock("/scripts/jquery.validate.js", "/scripts/jquery.validate.min.js") %>
    <%= Html.JSBlock("/scripts/jquery.lightbox-0.5.js", "/scripts/jquery.lightbox-0.5.min.js") %>
    <%= Html.JSBlock("/scripts/global.js", "/scripts/global.min.js") %>
    <asp:ContentPlaceHolder ID="AdditionalJS" runat="server" />
</body> 
```

在这样的页面中使用（我很满意）：

```
<asp:Content ID="signUpContent" ContentPlaceHolderID="AdditionalJS" runat="server">
    <%= Html.JSBlock("/scripts/pages/account.signup.js", "/scripts/pages/account.signup.min.js") %>
</asp:Content> 
```

**更新：**目前的建议（2013 年末）：

我会看看 Microsoft ASP.NET 内置的[Bundling and Minification](http://www.asp.net/mvc/tutorials/mvc-4/bundling-and-minification)。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-11-11T22:44:19.247

试试这个：

我最近在工作中完成了相当多的研究和后续开发，这对提高我们的 Web 应用程序前端的性能有很大帮助。我想我会在这里分享基本的解决方案。

显而易见的第一件事是使用 Yahoo 的 YSlow 和 Google 的 PageSpeed 对您的网站进行基准测试。这些将突出“唾手可得”的性能改进。除非您已经这样做了，否则生成的建议几乎肯定会包括合并、缩小和压缩静态内容。

我们要执行的步骤是：

编写一个自定义 HTTPHandler 来组合和缩小 CSS。编写一个自定义的 HTTPHandler 来组合和缩小 JS。包括一种机制，以确保仅在应用程序未处于调试模式时才发挥上述作用。编写自定义服务器端 Web 控件以轻松维护 css/js 文件包含。在 IIS 6 上启用某些内容类型的 GZIP。好吧，让我们从实现 .NET IHttpHandler 接口的 CSSHandler.asax 开始：

```
using System;
using System.Collections.Generic;
using System.IO;
using System.Text;
using System.Web;

namespace WebApplication1
{
    public class CssHandler : IHttpHandler
    {
        public bool IsReusable { get { return true; } }

        public void ProcessRequest(HttpContext context)
        {
            string[] cssFiles = context.Request.QueryString["cssfiles"].Split(',');

            List<string> files = new List<string>();
            StringBuilder response = new StringBuilder();
            foreach (string cssFile in cssFiles)
            {
                if (!cssFile.EndsWith(".css", StringComparison.OrdinalIgnoreCase))
                {
                    //log custom exception
                    context.Response.StatusCode = 403;
                    return;
                }

                try
                {
                    string filePath = context.Server.MapPath(cssFile);
                    string css = File.ReadAllText(filePath);
                    string compressedCss = Yahoo.Yui.Compressor.CssCompressor.Compress(css);
                    response.Append(compressedCss);
                }
                catch (Exception ex)
                {
                    //log exception
                    context.Response.StatusCode = 500;
                    return;
                }
            }

            context.Response.Write(response.ToString());

            string version = "1.0"; //your dynamic version number 

            context.Response.ContentType = "text/css";
            context.Response.AddFileDependencies(files.ToArray());
            HttpCachePolicy cache = context.Response.Cache;
            cache.SetCacheability(HttpCacheability.Public);
            cache.VaryByParams["cssfiles"] = true;
            cache.SetETag(version);
            cache.SetLastModifiedFromFileDependencies();
            cache.SetMaxAge(TimeSpan.FromDays(14));
            cache.SetRevalidation(HttpCacheRevalidation.AllCaches);
        }
    }
} 
```

好的，现在解释一下：

IsReUsable 属性：

我们不处理任何特定于实例的事情，这意味着我们可以安全地重用处理程序的同一个实例来处理多个请求，因为我们的 ProcessRequest 是线程安全的。更多信息。

处理请求方法：

这里没有什么太忙的事情。我们循环遍历提供给我们的 CSS 文件（请参阅下面的 CSSControl 了解它们是如何进入的）并使用 Yahoo 的 YUICompressor 的 .NET 端口压缩每个文件，然后将内容添加到传出响应流中。

该方法的其余部分处理设置一些 HTTP 缓存属性以进一步优化浏览器客户端下载（或不下载，视情况而定）内容的方式。

我们在代码中设置了 Etag，以便它们在我们服务器场中的所有机器上都是相同的。我们在实际文件上设置了响应和缓存依赖项，因此，如果它们被替换，缓存将失效。我们设置 Cacheability 以便代理可以缓存。我们使用我们的 cssfiles 属性 VaryByParams，以便我们可以缓存通过处理程序提交的每个 CSS 文件组。这里是 CSSControl，一个继承 .NET LiteralControl 的自定义服务器端控件。

正面：

```
<customcontrols:csscontrol id="cssControl" runat="server">
  <CustomControls:Stylesheet File="main.css" />
  <CustomControls:Stylesheet File="layout.css" />
  <CustomControls:Stylesheet File="formatting.css" />
</customcontrols:csscontrol> 
```

后退：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Web;
using System.Web.UI;
using System.Linq;
using TTC.iTropics.Utilities;

namespace WebApplication1
{
    [DefaultProperty("Stylesheets")]
    [ParseChildren(true, "Stylesheets")]
    public class CssControl : LiteralControl
    {
        [PersistenceMode(PersistenceMode.InnerDefaultProperty)]
        public List<Stylesheet> Stylesheets { get; set; }

        public CssControl()
        {
            Stylesheets = new List<Stylesheet>();
        }

        protected override void Render(HtmlTextWriter output)
        {
            if (HttpContext.Current.IsDebuggingEnabled)
            {
                const string format = "<link rel=\"Stylesheet\" href=\"stylesheets/{0}\"></link>";

                foreach (Stylesheet sheet in Stylesheets)
                    output.Write(format, sheet.File);
            }
            else
            {
                const string format = "<link type=\"text/css\" rel=\"Stylesheet\" href=\"stylesheets/CssHandler.ashx?cssfiles={0}&version={1}\"/>";
                IEnumerable<string> stylesheetsArray = Stylesheets.Select(s => s.File);
                string stylesheets = String.Join(",", stylesheetsArray.ToArray());
                string version = "1.00" //your version number

                output.Write(format, stylesheets, version);
            }

        }
    }

    public class Stylesheet
    {
        public string File { get; set; }
    }
} 
```

HttpContext.Current.IsDebuggingEnabled 与您的 web.config 中的以下设置挂钩：

```
<system.web>
  <compilation debug="false">
</system.web> 
```

因此，基本上，如果您的网站处于调试模式，您将获得如下 HTML 标记：

```
<link rel="Stylesheet" href="stylesheets/formatting.css"></link>
<link rel="Stylesheet" href="stylesheets/layout.css"></link
<link rel="Stylesheet" href="stylesheets/main.css"></link> 
```

但如果您处于生产模式 (debug=false)，您将获得如下标记：

```
<link type="text/css" rel="Stylesheet" href="CssHandler.ashx?cssfiles=main.css,layout.css,formatting.css&version=1.0"/> 
```

后者显然会调用 CSSHandler，它会负责合并、缩小和缓存您的静态 CSS 内容。

然后也可以为您的静态 JavaScript 内容复制上述所有内容：

`JSHandler.ashx:

```
using System;
using System.Collections.Generic;
using System.IO;
using System.Text;
using System.Web;

namespace WebApplication1
{
    public class JSHandler : IHttpHandler
    {
        public bool IsReusable { get { return true; } }

        public void ProcessRequest(HttpContext context)
        {
            string[] jsFiles = context.Request.QueryString["jsfiles"].Split(',');

            List<string> files = new List<string>();
            StringBuilder response = new StringBuilder();

            foreach (string jsFile in jsFiles)
            {
                if (!jsFile.EndsWith(".js", StringComparison.OrdinalIgnoreCase))
                {
                    //log custom exception
                    context.Response.StatusCode = 403;
                    return;
                }

                try
                {
                    string filePath = context.Server.MapPath(jsFile);
                    files.Add(filePath);
                    string js = File.ReadAllText(filePath);
                    string compressedJS = Yahoo.Yui.Compressor.JavaScriptCompressor.Compress(js);
                    response.Append(compressedJS);
                }
                catch (Exception ex)
                {
                    //log exception
                    context.Response.StatusCode = 500;
                    return;
                }
            }

            context.Response.Write(response.ToString());

            string version = "1.0"; //your dynamic version number here

            context.Response.ContentType = "application/javascript";
            context.Response.AddFileDependencies(files.ToArray());
            HttpCachePolicy cache = context.Response.Cache;
            cache.SetCacheability(HttpCacheability.Public);
            cache.VaryByParams["jsfiles"] = true;
            cache.VaryByParams["version"] = true;
            cache.SetETag(version);
            cache.SetLastModifiedFromFileDependencies();
            cache.SetMaxAge(TimeSpan.FromDays(14));
            cache.SetRevalidation(HttpCacheRevalidation.AllCaches);
        }
    }
} 
```

及其随附的 JSControl：

正面：

```
<customcontrols:JSControl ID="jsControl" runat="server">
  <customcontrols:Script File="jquery/jquery-1.3.2.js" />
  <customcontrols:Script File="main.js" />
  <customcontrols:Script File="creditcardpayments.js" />
</customcontrols:JSControl> 
```

后退：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Web;
using System.Web.UI;
using System.Linq;

namespace WebApplication1
{
    [DefaultProperty("Scripts")]
    [ParseChildren(true, "Scripts")]
    public class JSControl : LiteralControl
    {
        [PersistenceMode(PersistenceMode.InnerDefaultProperty)]
        public List<Script> Scripts { get; set; }

        public JSControl()
        {
            Scripts = new List<Script>();
        }

        protected override void Render(HtmlTextWriter writer)
        {
            if (HttpContext.Current.IsDebuggingEnabled)
            {
                const string format = "<script src=\"scripts\\{0}\"></script>";

                foreach (Script script in Scripts)
                    writer.Write(format, script.File);
            }
            else
            {
                IEnumerable<string> scriptsArray = Scripts.Select(s => s.File);
                string scripts = String.Join(",", scriptsArray.ToArray());
                string version = "1.0" //your dynamic version number
                const string format = "<script src=\"scripts/JsHandler.ashx?jsfiles={0}&version={1}\"></script>";

                writer.Write(format, scripts, version);
            }
        }
    }

    public class Script
    {
        public string File { get; set; }
    }
} 
```

启用 GZIP：

正如 Jeff Atwood 所说，在您的网站服务器上启用 Gzip 是轻而易举的事。经过一些跟踪，我决定在以下文件类型上启用 Gzip：

.css .js .axd（Microsoft Javascript 文件） .aspx（通常的 ASP.NET Web 表单内容） .ashx（我们的处理程序） 要在 IIS 6.0 Web 服务器上启用 HTTP 压缩：

打开 IIS，右键单击网站，服务选项卡，启用压缩应用程序文件和压缩静态文件 停止 IIS 在记事本中打开 IIS 元数据库 (C:\WINDOWS\system32\inetsrv\MetaBase.xml) – 如果你“对这些事情感到紧张使用以下内容找到并覆盖两个 IIsCompressionScheme 和一个 IIsCompressionSchemes 元素：

就是这样！这为我们节省了大量带宽，并导致整个 Web 应用程序响应速度更快。

享受！

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-05-26T22:07:40.637

为什么不使用 ScriptManager？这是一个结合 AND [squish](http://www.codeplex.com/MvcScriptManager)的 MVCScriptManager 。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-20T22:41:01.100

在[Professional ASP.NET 3.5](https://rads.stackoverflow.com/amzn/click/com/0470187573)的附录中， Scott Hanselman 谈到了[Packer for .NET](http://svn.offwhite.net/trac/SmallSharpTools.Packer/wiki)。这将与 MSBuild 集成并打包用于生产部署等的 javascript 文件。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-05-27T03:17:44.800

使用 YUI Compressor 或 Dojo 压缩器。它们都使用 Rhino JS 解析引擎来标记您的代码，因此只有在代码是有效代码时才能工作。如果有错误，他们会通知你（这是一个很好的奖励 IMO！）另一方面，Packer 会打包你的代码，即使它包含错误。

我通过构建脚本在所有项目中使用 YUI。永远不要在飞行中进行，压缩时间太长。YUI 和 Dojo 都是基于 Java 的（ala Rhino），如果您在运行中执行此操作，您将生成后台进程来生成输出 - 不利于性能。始终在构建时进行。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2011-07-06T10:48:43.293

Rejuicer 是 ASP.NET 的一个很棒的新压缩器，引起了很多关注： [http ://rejuice.me](http://rejuice.me)

它被配置为 HTTP 模块并在运行时（一次）执行缩小并缓存输出。

它：

*   具有流畅的配置界面
*   允许您使用通配符规则指定要缩小的文件
*   在 Windows Azure 上运行
*   有点神奇地在开发环境中自动关闭，因此您可以调试原始 javascript 代码（未缩小）。

配置（在 global.asax.cs 中的 ApplicationStart 上完成）很简单：

```
OnRequest.ForJs("~/Combined.js")
            .Compact
            .FilesIn("~/Scripts/")
              .Matching("*.js")
            .Cache
            .Configure(); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-06-16T21:43:43.087

这是我用于连接、压缩和缓存 CSS 和 JS 文件的内容：http: [//gist.github.com/130913](http://gist.github.com/130913)

它只需要 bin 目录中的 Yahoo.Yui.Compressor.dll。它在编译时不会压缩，但文件会通过文件依赖项进行缓存，因此它们只加载一次，直到它们被更改。

然后我只需在 <head> 中添加此代码：

```
<link rel="stylesheet" type="text/css" href="/YuiCompressor.ashx?css=reset,style,etc" /> 
```

这在 </body> 之前：

```
<script type="text/javascript" src="/YuiCompressor.ashx?js=main,other,etc"></script> 
```

它旨在处理多个文件都在同一路径中，但可以轻松升级以支持不同的路径。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-07-22T17:18:24.433

我使用基于 MSBuild 和 Microsoft Ajax Minifier 的定制解决方案。许多现有的博客文章都不能正确处理某些情况，例如与 TFS 构建的集成。

对于每个 Web 项目，我们创建一个“wpp.targets”文件来扩展 Web 发布管道。例如，如果项目是“Website.csproj”，则在项目中创建一个名为“Website.wpp.targets”的文件。

将以下代码放在目标文件中：

```
<Project DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <Import Project="$(MSBuildExtensionsPath32)\PATH TO YOUR MSBUILD MINIFY TARGETS" />

  <!-- Hook up minification task to WPP build process -->
  <PropertyGroup>
    <OnAfterPipelineTransformPhase>
      $(OnAfterPipelineTransformPhase);
      MinifyResourceFiles;
    </OnAfterPipelineTransformPhase>
  </PropertyGroup>

  <!-- Define temporary location to store minified resources -->
  <PropertyGroup>
    <MinifyResourceIntermediateOutput Condition="'$(MinifyResourceIntermediateOutput)'==''">MinifyResourceFiles</MinifyResourceIntermediateOutput>
    <MinifyResourceIntermediateLocation Condition="'$(MinifyResourceIntermediateLocation)'==''">$(_WPPDefaultIntermediateOutputPath)$(MinifyResourceIntermediateOutput)</MinifyResourceIntermediateLocation>
  </PropertyGroup>

  <Target Name="MinifyResourceFiles" DependsOnTargets="PipelineCollectFilesPhase" Condition="'$(Configuration)' == 'Release'">
    <!-- Create lists of the resources to minify -->
    <!-- These extract all Javascript and CSS files from the publishing pipeline "FilesForPackagingFromProject" and create two new lists.
     The "MinifiedFile" metadata on each item contains the temporary location where the minified file will be stored -->
    <ItemGroup>
      <JavaScriptToMinify Include="@(FilesForPackagingFromProject)" 
                          Condition="'%(FilesForPackagingFromProject.Extension)' == '.js'">
        <MinifiedFile>$(MinifyResourceIntermediateLocation)\minified\%(DestinationRelativePath)</MinifiedFile>
      </JavaScriptToMinify>
      <StylesheetToMinify Include="@(FilesForPackagingFromProject)"
                          Condition="'%(FilesForPackagingFromProject.Extension)' == '.css'">
        <MinifiedFile>$(MinifyResourceIntermediateLocation)\minified\%(DestinationRelativePath)</MinifiedFile>
      </StylesheetToMinify>    
    </ItemGroup>

    <!-- Minify resources -->
    <!-- These commands should be replaced with the MSBuild Tasks used to perform your minification
         I use my own custom tasks based on the Microsoft Ajax Minifier DLL 
         The input of the minifier takes a source file directly from the project and outputs to a temporary location -->
    <MinifyJavaScript SourceFiles="@(JavaScriptToMinify)" DestinationFiles="@(JavaScriptToMinify->'%(MinifiedFile)')"
                      Comments="None" />
    <MinifyStylesheet SourceFiles="@(StylesheetToMinify)" DestinationFiles="@(StylesheetToMinify->'%(MinifiedFile)')"
                      Comments="None" />

    <!-- Remove the original source files from the packaging system and include the new minfied resources from the temporary location -->
    <ItemGroup>
      <!--Remove unminified resources from the pipeline -->
      <FilesForPackagingFromProject Remove="@(JavaScriptToMinify)" Condition="'@(JavaScriptToMinify)' != ''" />
      <FilesForPackagingFromProject Remove="@(StylesheetToMinify)" Condition="'@(StylesheetToMinify)' != ''" />
      <!--Add the minified resources at the new loction to the pipeline -->
      <FilesForPackagingFromProject Include="@(JavaScriptToMinify->'%(MinifiedFile)')" Condition="'@(JavaScriptToMinify)' != ''"/>
      <FilesForPackagingFromProject Include="@(StylesheetToMinify->'%(MinifiedFile)')" Condition="'@(StylesheetToMinify)' != ''"/>
    </ItemGroup>
  </Target>
</Project> 
```

可以根据需要修改缩小目标上的“'$(Configuration') == 'Release'”条件。在服务器上发布、打包和构建时，它会自动缩小（并验证）项目中的所有 CSS 和 JS 文件。

您可能需要为服务器构建启用 WPP“CopyWebApplication”目标。为此，请将 MSBuild 属性 UseWP_CopyWebApplication 设置为 True，并将 PipelineDependsOnBuild 设置为 False。在包含 Web 应用程序目标文件之前，我们在项目文件中设置这些。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2011-11-10T17:35:26.730

I'd recommend [http://www.RequestReduce.com](http://www.RequestReduce.com) which minimizes and combines css and javascript as well as sprites css background images and optimizes their PNG compression. It does all of this at run time and caches the output. It requires no code or configuration beyond adding the HttpModule. It serves all cached content with optimized far future headers and ETags to ensure that browsers cache the css/javascript/sprites as long as possible. While it requires no configuration, it is highly configurable and can be setup to run with a CDN and sync cached files accross a web farm.

All javascript, images and css are fetched via HTTP so it can include css and js from third parties and its also a great way to minify/combine .axd resources like WebResource.axd and ScriptResource.axd. It determines the presense of js and css via content-type so the target resource can have any (or no) extension. It runs on any IIS based technology including all versions and view engines of MVC, web forms and "web pages".

You can download from [http://www.RequestReduce.com](http://www.RequestReduce.com), Nuget or fork from [https://github.com/mwrock/RequestReduce](https://github.com/mwrock/RequestReduce).

# c# - 需要帮助理解代码

> ID：890567
> 
> 赞同：2
> 
> 时间：2009-05-20T22:26:41.427
> 
> 标签：c#, arrays

我正在学习 C# 课程，我需要帮助来理解以下代码。

该代码有一个数组，表示对调查的响应，值从 1 到 10。

输出显示这些评级以及选择某个值的次数。

以下代码来自我的书中，但我已将其修改为一个基本示例。

```
int[] responses = { 3, 2, 5, 6, 3, 5 , 4, 5, 5, 5};
int[] frequency = new int[7];

for (int answer = 0; answer < responses.Length; answer++)
   ++frequency[responses[answer]];

for (int rating = 1; rating < frequency.Length; rating++)
   Console.WriteLine(rating + ", " + frequency[rating]);

Console.Read(); 
```

这条线是如何`++frequency[responses[answer]];`工作的？在看这个时，如果我`reponses[answer]`第一次通过循环，这将代表`responses[0]`哪个是 3，对吗？这就是我感到困惑的`++frequency`地方，这条线的部分是做什么的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-20T22:31:27.440

```
frequency[responses[answer]] = frequency[responses[answer]] + 1; 
```

编辑：我认为这样写还不清楚。作为个人喜好，我不喜欢对存在大量索引的元素使用一元运算（++x、x++ 等）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-20T22:30:42.917

它将阵列中该位置的频率加一。

例如，在该行执行后，位置 3（来自您的示例）的频率将增加一。

编辑：所以，更详细地说，当答案 = 0 时，响应 [0] = 3，所以频率 [3] 会加一。

++ 也很容易出现在命令的末尾。换句话说，

```
++frequency[responses[answer]]; 
```

与使用相同（在这种情况下）

```
frequency[responses[answer]]++; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-20T22:32:14.207

让我们分解一下：正如您所指出的，在第一遍响应 [answer] 将评估为“3”

所以这看起来像 ++frequency[3]

++ 将索引 3 处的数组值增加 1

够简单吗？

我还应该指出，在数组*之前*而不是在数组之后应用 ++ 确实会影响递增的执行方式（尽管它不会影响这段代码的结果）。

例如：

```
int n = 2;
int j = ++n;
int k = n++; 
```

j和k是什么？

j 将是 3，k 也将是 3。这是因为如果将 ++ 放在前面，它会先评估它。如果你把它放在最后，它会在表达式的其余部分之后计算它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-20T22:38:01.963

在这种情况下，在您执行代码时重写代码通常很有用。

当答案 = 0

*   ++频率[响应[0]]
*   ++频率[3] 因为响应[0] = 3
*   频率现在看起来像 { 0, 0, 0, 1, 0, 0, 0 }

当答案 = 1

*   ++频率[响应[1]]
*   ++频率[2] 因为响应[1] = 2
*   频率现在看起来像 { 0, 0, 1, 1, 0, 0, 0 }

等等。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-20T22:33:38.150

如果有帮助，请将 ++frequency[] 视为“频率 = 频率 + 1”。

如果 ++ 运算符出现在变量之前，则在执行语句之前应用增量。如果 ++ 之后出现，则执行该语句，然后变量递增。

在这种情况下，这并不重要，因为在之前或之后递增不会影响逻辑。

由于“responses[answer]”的计算结果是一个数字，因此该行代码正在增加该数组索引处的频率条目。所以第一次通过，答案是 0，所以响应 [答案] 是 3，所以频率 [3] 框增加 1。下一次通过，频率 [2] 框增加......等等。 ETC。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-20T22:34:29.977

frequency 是一个数组，其中所有元素都初始化为 0（int 的默认值）。该行将`++frequency[responses[answer]]`递增在 处找到的整数所指出的频率元素`responses[answer]`。通过将 ++ 放在频率前面，数组元素将在返回结果值之前递增。

您可以[在此处阅读有关 ++ 运算符的更多信息](http://msdn.microsoft.com/en-us/library/36x43w8w(VS.80).aspx)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-20T22:41:52.487

它使用频率数组来计算每个响应输入的次数。您*可以*为每个答案设置一个计数器：

```
int numberOfOnes = 0;
int numberOfTwos = 0;
// Etc... 
```

但这将是丑陋的编程，并且不那么容易或有效。使用频率数组可以让您不使用 if/else if 块或开关，并使您的代码更易于阅读。

关于那个频率阵列的另一件事。

```
int[] frequency = new int[7]; 
```

这会将数组中的所有整数初始化为 0，这就是为什么您可以从递增它开始，而不是查看它是否是该特定响应的第一次，然后用 1 或类似性质的东西初始化它。

祝你所有有趣的 C# 好运。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-20T22:30:57.987

这意味着在频率[3]处增加值。其中 3 是响应 [answer] 的返回结果。类似地，下一次迭代将在频率 [2] 处增加值。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-20T22:34:37.667

C# 中的 ++ 运算符在应用于整数时会将其加一。

您正在查看的特定行，频率是具有 7 个元素的整数数组。这有点令人困惑，因为按照您在代码中解释它的方式，该代码似乎会因响应数组中高于 6 的任何值而中断。

撇开这个问题不谈，基本上它会增加它正在访问的数组的任何索引。因此，在您的示例中，response[0] 将为 3。因此，此行将找到频率 [3] 的值并将其递增 1。由于整数数组的所有值都初始化为零，因此在第一次迭代之后，频率 [3 ] 将是 1。然后，如果您的响应数组中稍后还有 3，则频率 [3] 将再次增加（即响应 [4]）。

我希望这可以帮助你。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-20T22:34:48.930

代码片段的目标似乎是确定每个响应出现在“响应”数组中的次数。因此，对于您的示例集，频率 [3] 应该是 5，频率 [5] 应该是 5，等等。

因此，您询问的行从响应数组中获取当前元素，并将频率数组中的关联值增加 1，以指示在响应中观察到特定值。

执行整个代码片段后，频率数组包含在响应数组中观察到每个元素从 0 到 7 的次数。

# xcode - Xcode 变量

> ID：890569
> 
> 赞同：106
> 
> 时间：2009-05-20T22:27:35.403
> 
> 标签：xcode, variables, build-process, build-automation

在 Xcode 中，我知道您可以获得诸如`PROJECT_DIR`在某些情况下使用的变量，例如运行脚本构建阶段。我想知道是否可以获得构建类型（即*Release*或*Debug*）。有任何想法吗？

* * *

## 回答 #1

> 赞同：154
> 
> 时间：2009-05-21T17:17:15.553

最好的来源可能是[Apple 的官方文档](http://help.apple.com/xcode/mac/8.0/#/itcaec37c2a6)。您要查找的特定变量是 CONFIGURATION。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-05-20T22:42:21.770

[这是环境变量的列表](http://maxao.free.fr/xcode-plugin-interface/build-settings.html#variables)。我想你可能想要`CURRENT_VARIANT`。另请参阅`BUILD_VARIANTS`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2021-03-29T11:06:54.443

它们并非**全部**记录在案。例如，您不会在 Naaff 或 smorgan 的答案中找到`ARCHIVE_PATH`, （Xcode 中设置的版本字符串）。`MARKETING_VERSION`这 2 条是人们需要的非常常见的信息！这是我得到的所有这些列表：[https ://gist.github.com/ben-xD/c063b0ca2c33684de1eb379bb9d6405d](https://gist.github.com/ben-xD/c063b0ca2c33684de1eb379bb9d6405d)

## 我是如何得到它们的

**我发现最好的方法是使用**打印它们**`set`，我刚刚写了[这个](https://stackoverflow.com/questions/66852827/is-there-an-environment-variable-for-the-archive-directory-in-xcode)，包括一个列出所有可用环境变量的方法。**

 **将此添加到您的运行脚本（存档后运行脚本或构建阶段运行脚本等）：

```
#!/bin/sh
exec > ${PROJECT_DIR}/environment_variables.log 2>&1
set 
```

往里看`environment_variables.log`，你会看到它们。

# asp.net - 在Repeater的HeaderTemplate中设置MyLabel.Text

> ID：890571
> 
> 赞同：3
> 
> 时间：2009-05-20T22:28:02.250
> 
> 标签：asp.net, repeater, web-controls

我发现的每个示例都包括在页面的 OnLoad 之外编写一个函数来执行此操作，但我很好奇是否有更简洁的方法来实现它。我在 HeaderTemplate 中有一个标签，我只想将标签的文本设置为字符串。如果标签在中继器之外，我可以执行以下操作：

```
Month.Text = Enum.GetName(typeof(Month), Convert.ToInt16(MonthList.SelectedValue)); 
```

有没有一种简洁的方法来做到这一点？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-20T23:00:23.933

如果您确实使用 DataBinding 事件会更好。

ASPX 标记：

```
<asp:Repeater ID="repTest" runat="server">
    <HeaderTemplate>
        <asp:Label ID="lblHeader" runat="server" />
    </HeaderTemplate>
</asp:Repeater> 
```

后面的代码：

```
protected void Page_Load(object sender, EventArgs e)
{
    repTest.ItemDataBound += new RepeaterItemEventHandler(repTest_ItemDataBound);

    int[] testData = { 1, 2, 3, 4, 5, 6, 7, 8 };
    repTest.DataSource = testData;
    repTest.DataBind();
}

void repTest_ItemDataBound(object sender, RepeaterItemEventArgs e)
{
    if (e.Item.ItemType == ListItemType.Header)
    {
        Label lblHeader = e.Item.FindControl("lblHeader") as Label;
        if (lblHeader != null)
        {
            lblHeader.Text = "Something";
        }
    }
} 
```

你去吧:)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-20T22:52:11.983

我不能 100% 确定您是否需要等待中继器将数据绑定到它，但这是您在其标题中访问控件的方式：

```
var myLabel = MyRepeater.Controls[0].Controls[0].FindControl("MyLabel") as Label;
myLabel.Text = "Hello World"; 
```

您可能应该将其分成多行并检查以确保在 Controls[0] 处有一个对象。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-20T23:02:07.983

*在*标题模板中尝试以下操作：

```
<asp:Label ID="Month" runat="server" Text='<%# (Month)Convert.ToInt16(MonthList.SelectedValue) %>' /> 
```

# jmockit - Jmockit抽象类实例

> ID：890574
> 
> 赞同：2
> 
> 时间：2009-05-20T22:30:37.160
> 
> 标签：jmockit

我想模拟抽象类中的一个方法说**'A'**并且还需要将类型**A**的实例传递给我正在单元测试的方法。

有没有办法使用 Jmockit 创建实例，例如 Mockit.newemptyProxy 我该如何解决这种情况

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-20T01:06:27.367

你可以像这样简单地做到这一点：

```
 @Test
public void mockAbstractClassA(final A mock)
{
   new Expectations() {{
      mock.doThis();
      mock.doThat(); returns(123);
   }};

   new ClassUnderTest(mock).doStuff();
} 
```

注意测试方法中的“A mock”参数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T00:39:22.890

也许这是一个愚蠢的问题，但在这种情况下你真的需要 JMockit 吗？你不能只创建一个子类`A`并覆盖你想要模拟的方法吗？像这样的东西：

```
class MyMockA extends A {

    @Override
    int myMethod(int x) {
        // do stuff
    }
}

@Test
public void test_A_handler() {
    A a = new MyMockA();
    A_handler testSubject = new A_handler();
    assertEquals(123, testSubject.handleA(a));
} 
```

# html - 在保留 url 的同时在 Rails 中包装一个长字符串？

> ID：890578
> 
> 赞同：4
> 
> 时间：2009-05-20T22:31:16.393
> 
> 标签：html, ruby-on-rails

在我的 Rails 项目中，我有以下代码：

```
auto_link( h( wrap_long_string(post.text,50)  )).gsub(/\n/,"<br />") 
```

`wrap_long_string`定义为：

```
 def wrap_long_string(txt,col = 20)
    txt.gsub(/(.{1,#{col}})( +|$\n?)|(.{1,#{col}})/,
      "\\1\\3\n")
  end 
```

此代码旨在显示用户输入的文本，同时防止用户通过输入一个非常长的不间断字符串来弄乱页面的布局。

但是，断开较长的非断开字符串的行为也会阻止`auto_link`助手工作。

我想做的是有以下文字：

```
aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa http://www.google.com/search?hl=en&client=firefox-a&rls=org.mozilla%3Aen-US%3Aofficial&hs=ZGF&q=example&btnG=Search 
```

变成了类似的东西：

```
aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa<br/>aaaaaaaaaa <a href='http://www.google.com/search?hl=en&client=firefox-a&rls=org.mozilla%3Aen-US%3Aofficial&hs=ZGF&q=example&btnG=Search'>http://www.google.com/search?hl=en&client=firefox-a&rls=org.mozilla%3Aen-US%3Aofficial&hs=ZGF&q=example&btnG=Search</a> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-20T22:38:14.617

如果您可以控制这些应用的顺序，我建议通过自动链接帮助程序运行文本，然后通过长文本断路器（并使其“智能”足以不将 html 标签中的文本计为文本： ））。那应该创建链接，我相信您可以
在标签之间使用而不会产生任何不良后果:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-20T22:45:13.277

或者，您可以定义自己的 auto_link（使用 text_helper.rb 中的现有代码作为模型）首先扫描 url（和电子邮件），进行替换，找到您进行替换的索引，然后中断不属于这些索引的地方的线。

这应该只需要现有的自动链接代码以及对 index() 和 length() 的调用。

# sql - SQL Server 2005 - 如果条件与联合

> ID：890581
> 
> 赞同：2
> 
> 时间：2009-05-20T22:31:50.650
> 
> 标签：sql, sql-server, sql-server-2005

我有一个具有以下算法的 SP。

```
IF <SomeCondition>
BEGIN
  SELECT * FROM TABLE1
END
ELSE
BEGIN
  SELECT * FROM TABLE2
END
--Union the above with the query below
UNION
  SELECT * FROM TABLE3 
```

返回的记录集完全相同。我需要对该结果集和另一个查询进行 UNION。

有没有办法做到这一点而不必使用临时表？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-20T22:37:26.413

怎么样：

```
SELECT * FROM TABLE1 WHERE <SomeCondition>
UNION
SELECT * FROM TABLE2 WHERE NOT <SomeCondition>
UNION
SELECT * FROM TABLE3 
```

如果您担心评估两次：

```
DECLARE @condition bit
SET @condition = CASE WHEN <SomeCondition> THEN 1 ELSE 0 END

SELECT * FROM TABLE1 WHERE @condition = 1
UNION
SELECT * FROM TABLE2 WHERE @condition = 0
UNION
SELECT * FROM TABLE3 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-20T22:43:16.680

如果您不介意它没有被编译，您也可以使用动态 SQL。例如：

```
DECLARE @sql VARCHAR(100)
DECLARE @table VARCHAR(10)

IF <SomeCondition>
BEGIN
    SET @table = 'Table1'
END
ELSE
BEGIN
    SET @table = 'Table2'
END

SET @sql = 'SELECT * FROM ' + @table + ' UNION SELECT * FROM TABLE3'
EXEC(@sql) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T12:54:30.437

此外，如果您可以使用 UNION ALL 而不是 UNION，那么这样做 - 不消除重复可能会更便宜

# php - 日历，偏移重叠事件

> ID：890585
> 
> 赞同：2
> 
> 时间：2009-05-20T22:32:37.640
> 
> 标签：php, arrays, prototype, calendar, offset

我正在尝试用 PHP 编写日历。在周视图中，我希望我的事件像 iCal 一样列出，其中同时发生的事件将它们的宽度缩小到一半。

我很难弄清楚这一点，所以我希望你能帮助我。我想要的是，如果一个事件与另一个事件重叠，它应该`[split] => true`在两个事件数组上设置 - 或者在那个方向上设置（阅读：我不确定这是否是最有效的解决方案）。然后我可以`split == true`在打印出事件的 foreach 循环中进行检查。

这是一个包含两个同时发生的事件的示例数组：

```
$events = array(
  array(
    "id" => 21,
    "start" => 1242219600,
    "end" => 1242237600,
    "title" => "foo",
    "split" => false
  ),
  array(
    "id" => 22,
    "start" => 1242223200,
    "end" => 1242234000,
    "title" => "foo",
    "split" => false
  )
);

$events = someFunctionToOffsetEvents($events); 
```

你会如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-20T22:44:17.413

我发布了关于如果三个事件重叠怎么办的问题，这会导致更好的解决方案。不要把你的 GUI 和你的数据放在同一个结构中。保存您的数据，然后弄清楚如何显示它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-20T22:59:58.723

最近我不得不处理很多日期冲突问题，我能想到的最好的方法是：

date1.start < date2.end 和 date1.end > date2.start = 碰撞

这个简单的公式将解释以下所有情况：

```
——所有情况都一样：
date1.start = 2009 年 1 月 1 日
date1.end = 2009 年 1 月 10 日

--开始日期在第一个日期范围内：
date2.start = 2009 年 1 月 9 日
date2.end = 2/10/2009

--结束日期在第一个日期范围内：
date2.start = 2008 年 12 月 10 日
date2.end = 2009 年 1 月 3 日

--开始和结束日期在第一个日期范围内：
date2.start = 2009 年 1 月 2 日
date2.end = 2009 年 1 月 3 日

--第一个日期在第二个日期范围内：
date2.start = 12/1/2008
date2.end = 2/1/2009

```

```
$date1 = array('start' => '2009-01-05', 'end' => '2009-01-10');
$date2 = array('start' => '2009-01-01', 'end' => '2009-01-04'); // end inside one
$date3 = array('start' => '2009-01-04', 'end' => '2009-01-15'); // start inside one
$date4 = array('start' => '2009-01-01', 'end' => '2009-01-15'); // one inside me
$date5 = array('start' => '2009-01-04', 'end' => '2009-01-05'); // inside one

function datesCollide($date1, $date2)
{
    $start1TS = strtotime($date1['start']);
    $end1TS = strtotime($date1['end']);
    $start2TS = strtotime($date2['start']);
    $end2TS = strtotime($date2['end']);

    if ($start1TS <= $end2TS && $end1TS >= $start2)
    {
        return true;
    }

    return false;
} 
```

根据您的评论，这可能是您正在寻找的解决方案：请注意，此解决方案不是很优化，只能用于找出更好的解决方案。 **永远不要相信来自网络的代码。**

```
$events = array(
  array(
        "id" => 21,
        "start" => 1242219600,
        "end" => 1242237600,
        "title" => "foo",
        "split" => false
  ),
  array(
        "id" => 22,
        "start" => 1242223200,
        "end" => 1242234000,
        "title" => "foo",
        "split" => false
  )
);

foreach ($events as $key => $event)
{
    $events[$key]->split = dateCollisionCheck($event, $events);
}

function dateCollisionCheck(&$event, &$eventList)
{
    foreach ($eventList as $checkEvent)
    {
        if ($event->id != $checkEvent->id)
        {
            if ($event->start <= $checkEvent->end && $event->end >= $checkEvent->start)
            {
                return true; // return as soon as we know there is a collision
            }
        }
    }

    return false;
} 
```

*代码未经测试

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T00:29:24.893

我会回复你的问题。将事件映射到表示您要显示的星期的数组上：

```
$weekdayEvents=array();
foreach ($events as $event) {
   $day=toThisWeek($event['start'], $firstweekday),
   $lastDay=toThisWeek($event['end'], $firstweekday); 
   while ($day<=$lastDay) {
     $weekdayEvents[$day++][]=$event['id'];
   }
}
// now you have an array of array filled with ids
$eventCollisions=array();
foreach($weekdaysEvents as $activeDay) {
  $eventsOnDay = count($activeDay);
  foreach($activeDay as $eventID) {
    if ($eventCollisions[$eventID]<$eventsOnDay) {
      $eventCollisions[$eventID]=$eventsOnDay;
    }
  }
} 
```

}

其中 toThisWeek() 是一个类似的函数

```
function toThisWeek($dayTimestamp, $firstDayOfWeekTimestamp) {
  $dayOfWeek = unixtojd($firsDayOfWeekTimestamp) - unixtojd($dayTimestamp);
  if($dayOfWeek<0) return 0;
  if($dayOfWeek>6) return 6; 
  return $dayOfWeek;      
} 
```

现在，在*$eventCollisions*中，对于您必须显示的一周内发生的每个事件，您都有一个事件发生的最大碰撞次数。现在您可以使用此数组中的值来填充 $events 子数组中拆分的字段：

```
foreach ($events as $event) {
  $event['split']=$eventCollisions[$event['id']]-1;
} 
```

或者只使用 $eventCollisions *"ondemand"中的值*

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-21T09:37:51.707

这是根据 Rob 的回答修改后的工作代码：

```
// this is in my getEvents function
if(is_array($events)) {
  foreach ($events as $key => $event) {
    $events[$key]['collides'] = $this->dateCollisionCheck($event, $events);
  }
}

//this is another function added to calendar.class.php
function dateCollisionCheck(&$event, &$eventList) {
  foreach ($eventList as $checkEvent) {
    if ($event['id'] != $checkEvent['id']) {
      if ($event['start'] <= $checkEvent['end'] && $event['end'] >= $checkEvent['start']) {
        return true;
      }
    }
  }

  return false;
} 
```

# ruby-on-rails - 如何在 Ruby on Rails 中实现复杂的安全规则

> ID：890603
> 
> 赞同：1
> 
> 时间：2009-05-20T22:40:55.780
> 
> 标签：ruby-on-rails, security, model-view-controller

我有一个我正在构建的系统，它似乎需要一些复杂的规则，而不是在整个系统中都有一堆乱七八糟的规则。我希望集中处理这个过程。（这可能不是我有过的最聪明的主意）

我最（也许最不）绝妙的想法是使用一个单独的类来检查任何对象，然后再根据各个字段中允许的值列表保存到数据库中。它与数据库结构的绑定非常紧密，但很容易测试和维护。

规则示例：

*   版主可以提交具有版主状态的评论，但不能提交管理员状态的评论。
    *   *Comments.status 只能是普通或版主（admin 是为管理员保留的）*
*   用户不能修改评论的版主值
    *   *Comments.status 只能正常，Comments.display 只能正常*
*   只有版主可以暂停用户帐户
    *   *众多领域的列表*
*   只有版主才能修改其他用户帐户
    *   *限制哪些字段具有逻辑来确定当前用户是否拥有该行*
*   只有拥有付费帐户的用户才能执行 X、Y 和 Z。

我遇到的问题是我把这个逻辑放在哪里。对于 Rails 验证来说，它变得太复杂了。如果我只查看登录用户的状态，实施其中一些规则是困难的或不可能的。当前的解决方案是创建一个 Security 类，该类将接受一个数据库对象和一个用户，并允许或禁止该操作发生。

如果我遵循这一行动方针，实施将是令人讨厌的。现在我正在看这样的东西

```
#For every field on an object passed to Security::allow?(user, object), call this private method
def allow_helper?(user, object, field) 
    perm = permissions[user.rank][object.class.name][field] 
    if perm.is_a? Array
          perm.include? object.send(field)
    else
          perm 
```

Which is going to very quickly become a nightmare to maintain. There has got to be an alternative to this nightmare I've dreamed up. I stopped myself before I coded this.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-20T22:58:44.560

Why don't you create a `Permissions` model, and then simply see if `user.permissions.find(:permission_name_here)` when you design the validations and views?

# programming-languages - 不同计算机语言的列表以及它们的常见程度

> ID：890605
> 
> 赞同：0
> 
> 时间：2009-05-20T22:41:39.260
> 
> 标签：programming-languages, survey

存在的所有计算机语言是什么，有多少人使用它们？

哦，我在 1980 年代后期使用的 VAX BASIC 与 MS-DOS 上的 BASIC 不同。Fortran IV 和 Fortran 77 也有显着差异。嗯......但如果不同的版本有很大的不同，那么也许它应该仅限于当前的语言。如果知道超过 15 个人曾经使用过 System-J，或者如果有人在 VAX-DCL 中进行过任何认真的编程，这可能会很有趣，但更多地了解我可能实际遇到的语言会更有价值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-20T22:49:03.393

我不确定您在寻找什么，但您可能会发现这些很有趣：

*   [2009 年 5 月 TIOBE 编程社区索引](http://www.tiobe.com/index.php/content/paperinfo/tpci/index.html)
*   [ohloh.net 语言比较](http://www.ohloh.net/languages/compare)
*   [最流行的编程语言](http://www.devtopics.com/most-popular-programming-languages)
*   [编程语言流行度](http://www.langpop.com/)
*   [Sourceforge 编程语言使用图（2000-2006）](http://www.cs.berkeley.edu/~flab/languages.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-20T22:46:15.147

看看这个列表： [http ://en.wikipedia.org/wiki/Timeline_of_programming_languages](http://en.wikipedia.org/wiki/Timeline_of_programming_languages)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-20T23:06:23.453

我发现使用[谷歌趋势](http://www.google.com/trends)比较两种语言的流行度非常有趣。它可以让你看到随着时间的推移在谷歌关键词上显示了什么样的趋势，并绘制了多个关键词。有一些有趣的结果，比如......

*   [吱吱声与。Smalltalk](http://www.google.com/trends?q=squeak%2C+smalltalk)（看起来 smalltalk 处于领先地位，但在 2004 年被淘汰）
*   [Cobol VS。Fortran](http://www.google.com/trends?q=cobol%2C+fortran&ctab=0&geo=all&date=all&sort=0) - 两者都在快速下降......
*   蟒蛇与。[Perl - 使用编程](http://www.google.com/trends?q=perl+programming%2C+python+programming&ctab=0&geo=all&date=all&sort=0)或[脚本](http://www.google.com/trends?q=perl+script%2C+python+script&ctab=0&geo=all&date=all&sort=0)作为关键字以及 python 或 perl搜索两种不同的方式，以防止误报与语言无关的单词 python。
*   [自动VS。AutoHotKey](http://www.google.com/trends?q=autoit%2C+autohotkey&ctab=0&geo=all&date=all&sort=0) - 有趣的是两者都在缓慢上升。

如果你想出一些好的，请与他们发表评论。我使用谷歌趋势来准确预测最近两次总统选举，因此它可能是一个很好的衡量实际关注度的指标（如果关键字不模棱两可）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-10-09T05:28:21.170

在我看来，计算机语言分为三种类型。它们是机器级语言、低级语言和高级语言

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-12-14T13:38:03.797

目前，我正在使用 Swift 编程语言。据我了解，在任何计算机语言中，都有一些东西是常见的。例如，声明变量，实现 If..then 条件。对于基本概念，您可以从中了解[它](http://ghcgames.blogspot.in/2015/12/basic-of-any-computer-language.html)。

# iphone - 在 loadView 中添加 UIControl 子类会使 iphone 应用程序崩溃

> ID：890612
> 
> 赞同：0
> 
> 时间：2009-05-20T22:43:19.147
> 
> 标签：iphone, cocoa-touch, uikit

我是 iPhone 新手，正在尝试这个平台。我有一个根视图控制器，它从笔尖加载它的视图。我不小心取消了`loadView`这个类中的方法的注释，现在应用程序崩溃了——这是因为如果视图控制器是从 nib 启动的，那么你永远无法`loadView`实现？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-20T22:59:20.860

如果您使用 nib 文件创建视图，那么您应该覆盖 viewDidLoad 并在那里添加您的子视图。当您以编程方式创建所有视图时，您只想覆盖 loadView。

[这是UIViewController](http://developer.apple.com/iphone/library/documentation/UIKit/Reference/UIViewController_Class/Reference/Reference.html#//apple_ref/occ/instm/UIViewController)文档的链接，该文档在 loadView 和 viewDidLoad 的条目下有更长的解释。

一开始我也被同样的问题搞糊涂了……

# c++ - 提示用户输入文件名或目录

> ID：890619
> 
> 赞同：1
> 
> 时间：2009-05-20T22:45:20.530
> 
> 标签：c++, file, filenames, istream

我提示用户输入文件名，如果他们第一次输入有效的文件名，它会起作用。但是，如果第一次无效，则其他所有检查都会失败。我将如何解决这个问题？另外，假设他们只是指定一个目录，我将如何获取所有文本文件的名称以及有多少？

```
int main() {

    ifstream inFile;
    int result;
    string filename;

    cout << "If the executable is not in the same directory as the\nfile, then a directory needs to be provided\n\n";
    while (true) {
        cout << "Enter the file name:  ";
        getline(cin, filename);
        inFile.open(filename.c_str(), ios::in);

        if (!inFile)
            cout << "\n**File failed to open**\n\n";
        else break;
    }

    result = countLOC(inFile);
    cout << "\nThere are " << result << " lines of code in \"" << filename << "\"\n\n";

    inFile.close();
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-20T22:52:29.377

调用[clear](http://www.cplusplus.com/reference/iostream/ios/clear/)重置调用打开之前的状态。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-20T22:55:39.277

这是因为对象“inFile”中的错误位已被设置。
在执行任何其他操作之前，您需要重置错误位。

```
if (!inFile)
{
    cout << "\n**File failed to open**\n\n";
    inFile.clear();
}
else break; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-20T22:57:56.667

您实际上不需要使用错误标志等，您只需调用 inFile.is_open() 函数进行检查。您也不需要使用 inFile.clear() 。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-20T22:58:06.557

是的，做一个明确的

如果用户提供了您需要执行 FindFirst 和 FindNext 的目录

msdn.microsoft.com/en-us/library/zyzxfzac(VS.71).aspx

并以这种方式处理所有文件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-20T23:06:08.430

清除它。另外，您不需要循环中的中断，我建议您这样做：

```
do {
    if (infile.fail())
       cout << "\n**File failed to open**\n\n";
    infile.clear()
    cout << "Enter the file name:  ";
    getline(cin, filename);
    inFile.open(filename.c_str(), ios::in);
} while(!infile) 
```

# bash - 无法在 Zsh 中拥有类似 Bash 的 Cxe

> ID：890620
> 
> 赞同：35
> 
> 时间：2009-05-20T22:45:33.370
> 
> 标签：bash, zsh

[我在 Bash 中找到了 Zsh 在线程](https://stackoverflow.com/questions/784019/how-can-i-invoke-vim-with-c-x-e-for-long-complex-tricky-commands)的相同按钮中没有的以下命令。

```
Ctrl-x-e 
```

它将终端中的当前输入打开到编辑器。

**你怎么能在 Zsh 中拥有相同的命令？**

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-05-24T15:15:42.067

我在 VIM 模式下使用它。基本上 ESC-v （或者如果已经处于命令模式，则简单地使用 v ）打开终端。它是通过以下方式设置的：

```
autoload -U edit-command-line
zle -N edit-command-line
bindkey -M vicmd v edit-command-line 
```

以下是如何在 emacs 模式下设置它：

```
autoload edit-command-line
zle -N edit-command-line
bindkey '^Xe' edit-command-line 
```

使用 'bindkey -e' 启用 emacs 样式或使用 'bindkey -v' 启用 vi 样式。

# perl - 比较文件和报告统计中的记录 - 方案 2

> ID：890624
> 
> 赞同：1
> 
> 时间：2009-05-20T22:45:55.957
> 
> 标签：perl, comparison

要求是：

事实 1：我们有一些由遗留系统生成的数据文件

事实 2：我们有一些由新系统生成的数据文件，最终应该会取代旧系统

事实 3：

1.  这两个文件都是文本/ASCII 文件，记录由多行组成。
2.  记录中的每一行都由字段名和字段值组成。
3.  1 和 2 中行的显示格式不同，但是可以通过使用正则表达式从每行中提取字段名和字段值
4.  字段名称可以在 1 和 2 之间变化，但我们有一个关联它们的映射
5.  每条记录都有一个唯一标识符，可帮助我们将旧记录与新记录相关联，因为输出文件中的记录顺序在两个系统中不必相同。
6.  每个要比较的文件至少为 10 MB，平均为 30 - 35 MB

事实 4：当我们迭代构建新系统时，我们需要比较两个系统在完全相同的条件下生成的文件并协调差异。

事实 5：这种比较是使用昂贵的视觉差异工具手动完成的。为了帮助解决这个问题，我编写了一个工具，将两个不同的字段名合并为一个通用名称，然后对每个记录、每个文件中的字段名进行排序，以便它们按顺序同步（新文件可以有额外的字段，在视觉差异）

事实 6：由于人工比较是人工进行的，而且人工会犯错误，因此我们得到了错误的正面和负面，这极大地影响了我们的时间线。

显然问题是，“ALG”和“DS”应该是什么？

我必须解决的场景：

我想构建一个 PERL 程序

1.  将两个文件中的相关信息读入数据结构“DS”
2.  使用算法“ALG”处理并找出来自 DS 的记录之间的差异
3.  向最终用户显示/报告统计信息，例如记录之间有多少行（值）不同，它们在哪里不同或值完全不同，是否缺少行（来自新系统的文件可以有额外的字段，但它们必须包含所有遗留系统生成的文件中的行）

我的建议：

DS：绑定到磁盘的多个嵌套哈希。

好像：

```
$namedHash { unique field value across both records } = {

    legacy_system => {

        'goodField' => 'I am good!',
        'firstField' => 1,
        'secondField' => 3
    },

    new_system => {

        'firstField' => 11,
        'secondField' => 33,
        'goodField' => 'I am good!'
    }
}; 
```

ALG ：自定义键 - 由 legacy_system 和 new_system 键指向的匿名哈希之间的键比较。任何差异都将通过插入一个新的键“差异”来记录下来，该键将是在​​旧系统和新系统之间不同的字段名称数组。

因此，对于这个例子，我的 ALG 的输出将是：

```
$namedHash { unique field value across both records } = {

    legacy_system => {

        'goodField' => 'I am good!',
        'firstField' => 1,
        'secondField' => 3
    },

    new_system => {

        'firstField' => 11,
        'secondField' => 33,
        'goodField' => 'I am good!'
    },

    differences => [firstField, secondField];
}; 
```

在这种给定的情况下，您会做什么/建议什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-20T23:01:03.243

为什么不将所有数据导入 SQLite 数据库。您只需要一个具有单个主键的表，该主键对应于两个系统共有的唯一标识符。列应该是遗留字段和新字段的结合。

先导入一个数据集，比如说新系统生成的数据集。然后，对于旧数据集中的每个项目，尝试对表中的相应条目进行 UPDATE：如果 UPDATE 失败，则您知道新数据集缺少旧系统中曾经存在的那些条目。

如果与旧数据对应的任何列具有 NULL，那么您就知道新系统中的条目在旧系统中不存在。

然后，您可以选择新系统中的任何列与旧系统中的相应列不匹配的行。

恕我直言，这比基于哈希表的系统更灵活。

# asp.net - 调整图像大小和性能

> ID：890629
> 
> 赞同：3
> 
> 时间：2009-05-20T22:46:51.807
> 
> 标签：asp.net, performance, image, browser, resize

我有一个大约 1200 x 400 的图像（如果我没记错的话），大小约为 50kb。我在网站的标题中使用图像，但我将图像的高度限制为 100 像素以使其适合我的标题。

```
<asp:Image ID="imgLogo" runat="server" ImageUrl="~/Images/AFact.jpg" Height="100px" /> 
```

这是一个不好的做法吗？是不是意味着图片正在全部下载到客户端，然后客户端的浏览器又要浪费cpu去resize呢？使用 Photoshop 将图像缩小到我想要的高度会更好吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-20T22:49:46.653

> 这是一个不好的做法吗？是不是意味着图片正在全部下载到客户端，然后客户端的浏览器又要浪费cpu去resize呢？使用 Photoshop 将图像缩小到我想要的高度会更好吗？

是的，你所有的问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-20T22:50:52.283

对对对！

不仅您下载一个大文件，而且只显示一个小文件。浏览器在缩放图像方面真的很糟糕。所以它看起来也很丑:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-20T22:55:23.910

和其他人一样，对你的问题**是肯定的。**您可以使用[imagemagick 之](http://www.imagemagick.org/script/index.php)类的工具来调整批处理文件中的图像大小。

# javascript - 通过 for 循环访问缩略图。

> ID：890640
> 
> 赞同：0
> 
> 时间：2009-05-20T22:50:53.873
> 
> 标签：javascript, dom

我正在创建一个照片库，目前卡在识别哪个缩略图链接到哪个图片。我正在使用 addEventListener 函数，请建议该方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-24T12:31:22.733

不完全确定你在这里的意思，但让我提出一个建议：

如果您的缩略图都直接链接到它们较大的对应部分，您可以防止它们离开页面，而是异步引入较大的图像：

```
<ul class="thumbnails">
  <li><a href="bigImg1.jpg"><img src="bigimg1_thumb.jpg" /></a></li>
  <li><a href="bigImg2.jpg"><img src="bigimg2_thumb.jpg" /></a></li>
</ul> 
```

使用该标记，我们可以拥有以下 jQuery：

```
$(".thumbnails a").click(function(e){
  e.preventDefault(); /* keeps us from actually leaving the page */
  alert($(this).attr("href")); /* tells us the path to our img */
}); 
```

您可以以模态方式将大图像淡入页面的其余部分，而不是发出警报。

# iphone - 如何自定义uitableview

> ID：890645
> 
> 赞同：4
> 
> 时间：2009-05-20T22:54:04.663
> 
> 标签：iphone, cocoa-touch, uitableview, uikit

如何自定义 a 中的每个单元格`UITableView`（就像每个单元格将具有`UITextfield`and `UIButton`）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-20T23:21:42.033

`UITableView`单元格响应选择 - 它得到处理`tableView:didSelectRowAtIndexPath`，也许这满足您的 UIButton 要求。如果您需要 UIButton，这应该不难——它只是另一个 UIView 组件。

[Easy custom UITableView绘图](http://cocoawithlove.com/2009/04/easy-custom-uitableview-drawing.html)是一篇关于自定义的详细文章`UITableView`。它超出了您的要求，但您可能会发现有用的细节。**查看contentView**中的部分布局，了解如何将视图添加到单元格 - 该示例添加图像和文本（大量自定义背景内容正在进行）。

[此处](http://discussions.apple.com/thread.jspa?messageID=8024294)讨论的示例代码：

```
UIView* container = [[UIView alloc] initWithFrame:goodRect];
UITableView* tv = [[UITableView alloc] initWithFrame:tableRect];
UIButton* btn = [[UIButton alloc] initWithFrame:btnFrame];

[container addSubview:tv];
[container addSubview:btn];

myController.view = container; 
```

也许看看问题[UIButton in a UITableView header ignores most touches](https://stackoverflow.com/questions/297297/uibutton-in-a-uitableview-header-ignores-most-touches)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-11-25T13:31:10.913

表格单元格中有一些您可以修改的子视图。我发现的好教程在这里： http: [//www.cocoawithlove.com/2009/04/easy-custom-uitableview-drawing.html](http://www.cocoawithlove.com/2009/04/easy-custom-uitableview-drawing.html)

# css - 什么是好的 CSS 清理工具？

> ID：890646
> 
> 赞同：6
> 
> 时间：2009-05-20T22:54:12.993
> 
> 标签：css

我正在处理一个现在一团糟的 CSS 文件，想清理它，看看：

```
...
solid;border-collapse:collapse!important}.account_table_top_text{padding:5px 0 5px 10px}.account_table_header_text{font-family:Arial,Helvetica,sans-serif!important;font-weight:bold;font-size:16px;color :black}.account_add_account_link{光标：指针；文本-
...

```

无论如何，您知道了，是否有清理 CSS 文件的好工具？我只是想让文件更干净、更易读。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-20T22:55:48.933

[我总是通过这个在线工具](http://www.lonniebest.com/FormatCSS/)运行凌乱的 CSS 。它对未格式化的 CSS 非常有效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-20T22:56:36.733

此处提供在线工具：

[http://www.cssdrive.com/index.php/main/csscompressor/](http://www.cssdrive.com/index.php/main/csscompressor/)

这里比较各种解决方案：

[http://idoblogging.wordpress.com/2007/02/10/comparison-css-cleanupcompressoptimizer-tools/](http://idoblogging.wordpress.com/2007/02/10/comparison-css-cleanupcompressoptimizer-tools/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-10-06T05:48:01.643

试试[ProCSSor](http://procssor.com)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-20T22:56:22.583

[http://www.prettyprinter.de/](http://www.prettyprinter.de/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-20T23:14:57.337

如果您在 Visual Studio 中工作（您可能会也可能不会 - 我完全意识到情况可能并非如此......）

```
[Ctrl]+[K] - [Ctrl]+[D] 
```

将为您组织任何文件（css、html、c#、vb.net、xml...）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-10-11T17:31:07.637

“Dust-ME Selectors”firefox 插件的新版本，适用于 firefox 版本 5-9 [http://blog.brothersmorrison.com/?p=198](http://blog.brothersmorrison.com/?p=198)

[https://addons.mozilla.org/en-US/firefox/addon/css-roundup/](https://addons.mozilla.org/en-US/firefox/addon/css-roundup/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-14T06:37:22.147

我喜欢[ProCSSor](http://procssor.com/process)，它既可以在线使用，也可以作为 Mac 应用程序使用。正如 Dan Walker 所提到的，与 FormatCSS 相比的优势之一是它可以缩进子选择器，我认为这提高了可读性。

# zsh - Zsh 无法在两列中回显 az

> ID：890655
> 
> 赞同：1
> 
> 时间：2009-05-20T22:57:25.827
> 
> 标签：zsh

为了便于说明，我需要在两列中打印以下序列

```
a-z 
```

它具有从 a 到 z 的字母，因此它们位于 13 个字符的列中。

**如何将 a 到 z 的字符回显到两列？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-20T23:44:55.933

非常好的斯蒂芬，

如何避免用循环输入**a**到**z呢？**

```
for i in {a..z}; do echo -n $i; done | sed -e 's/\(.\)\(.\)/\1 \2\n/g' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-20T23:06:08.663

我敢肯定，存在更好的解决方案，但我会试一试：

```
$ echo "abcdefghijklmnopqrstuvwxyz" | sed -e 's/\(.\)\(.\)/\1 \2\n/g'
a b
c d
e f
g h
i j
k l
m n
o p
q r
s t
u v
w x
y z 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T00:35:05.583

您的问题没有指定如何在两列中分配字符，所以这里有一个替代答案：

```
prompt> paste <(echo "abcdefghijklm" | sed 's/\(.\)/\1\n/g' ) <(echo "nopqrstuvwxyz" | sed 's/\(.\)/\1\n/g')
a       n
b       o
c       p
d       q
e       r
f       s
g       t
h       u
i       v
j       w
k       x
l       y
m       z

prompt> 
```

# project-management - 如何衡量软件开发进度

> ID：890659
> 
> 赞同：0
> 
> 时间：2009-05-20T22:57:58.273
> 
> 标签：project-management, project

我想帮助我的项目经理（非程序员）跟踪事情的完成速度。我们在 DOORS 中有详细的需求规范，允许我们跟踪已完成的需求。我建议这是一个合理的跟踪机制。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-20T23:03:17.140

确保您跟踪的项目足够小，以使其估计具有一定的准确性。

没有什么比不准确的估计更能扰乱软件项目了，而且工作越大，估计就越不准确。

换句话说，为了能够准确地跟踪项目进度，您需要具有相对准确估计的小任务。

如果您的清单上的项目需要“一周或更长时间”，那么您将无法获得接近准确进度报告的任何内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-20T23:38:09.893

听起来您正在寻找[像](https://wiki.rallydev.com/display/coach/Reading+a+Burndown+Chart)[scrum](http://en.wikipedia.org/wiki/Scrum_(development))中使用的[燃尽](http://www.methodsandtools.com/archive/archive.php?id=18p2) [图](http://alistair.cockburn.us/Earned-value+and+burn+charts)。我最近才接触到它，但它看起来是一个非常好的概念，实际上可以非常准确地跟踪进度。

然而

*   您必须分解成比您在需求规范中列出的要小得多的项目。它们是可靠估计的方式。
*   分解必须由实施者完成。
*   **这些项目的估计必须来自实施者！**

如果没有让执行者自己进行估算的自下而上方面，您将永远无法实现良好的估算。从系统需求的自上而下的估计开始是可以的——只要它们最终不是最终的估计。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-20T23:42:51.163

我喜欢使用 FogBugz... 它不仅可以跟踪程序的错误，还可以跟踪需要实现的功能。它可以很好地告诉您是否会准时发货。

对于单人团队，它是免费的。但是使用月度计划并不是那么昂贵。

[http://www.fogcreek.com/FogBUGZ/](http://www.fogcreek.com/FogBUGZ/)

# database-design - 关于存储应该在同一个表中的数据的问题

> ID：890670
> 
> 赞同：0
> 
> 时间：2009-05-20T23:00:40.640
> 
> 标签：database-design, one-to-one

我正在使用的软件有 2 个表，领导和客户。当我们将产品出售给某人时，会在客户表中创建一条记录，其中包含来自潜在客户表的数据（以及一些附加数据）。

目前这两个表之间没有关系。现在存在的最好的是lead对象有一个函数可以在客户表中查找具有相同电话号码的记录（希望在过去的5-10年里它们一直是我们的客户 - 对每个潜在客户进行此类搜索会在客户表上生成 %82 交集）。没有反向查找（客户-> 潜在客户）。

问题是我确实需要知道哪些客户记录与哪些潜在客户记录相关联，反之亦然。

我考虑过存储来自客户的潜在客户的 fk 和来自客户的客户的 fk ......但是我正在使用的 ORM 会溢出，因为当 fkeys 存在时它会加载关联的记录。

将这两个表合并到一个“人”表中是我想做的，有一个标志来识别一个人是否是客户......但是唉，时间表和预算不允许。

我不知道该怎么办。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-20T23:11:52.117

您真的需要它双向（即 1:M 导向客户和 1:M 客户导向潜在客户）吗？如果是这样，坐在两者“之间”的复合表可能是要走的路。每条记录都将包含来自客户的 PK 和来自潜在客户的 PK（将两者联系起来）。

如果您只需要知道有多少潜在客户链接到客户，我会将 FK 添加到潜在客户（指向客户中的 PK）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-20T23:14:47.243

您将需要两个表中的每一个中的 ID 列来唯一标识您的记录（如果您还没有）。

而且您必须再添加一个链接（联结）表来连接现有表。此表将包含两列：LeadID 和 CustomerID。每行包含 Customer 和 Lead 表中对应行的 ID。

外键将连接您的表：LeadID -> Lead 表中的 ID 列；CustomerID -> Customer 表中的 ID 列。

# c++ - 如何重载间接运算符？(C++)

> ID：890672
> 
> 赞同：10
> 
> 时间：2009-05-20T23:01:56.690
> 
> 标签：c++, operator-overloading, indirection

我正在尝试创建一个迭代器类作为列表类的成员类，并尝试重载间接运算符 (*) 以访问它指向的列表：

```
template<class T>
T list<T>::iterator::operator*(iterator& iter)
{
    return ((iter.lstptr)->current)->data;
} 
```

其中`lstptr`是指向列表`current`的指针， 是指向节点类的指针，并且节点类包含`data`type的数据成员`T`。

迭代器声明如下：

```
template<class T>
class list
{
public:
class iterator;
};

template<class T>
class list<T>::iterator
{
//stuff
}; 
```

我能够很好地编译重载 operator* 的函数定义，但是当我尝试执行以下操作时：

```
list<int> lst1;
lst1.add(6);
list<int>::iterator IT;
IT = lst1;
//everything above this point compiles fine
int a = *IT; //error here (line fourteen) 
```

我得到的错误说 <1> 我使用了非法间接，而 <2> 它不能从 list::iterator 转换为 int。两个错误都发生在第十四行。

有谁知道我做错了什么以及如何正确重载间接运算符？

注意：如果您需要查看更多代码，请告诉我哪一部分，因为我不想将整个代码放在这里，因为它大约有 205 行，其中 204 行（我认为）没有任何错误。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-20T23:19:39.930

您重载了乘法运算符。取出参数使其成为间接运算符。

```
template<class T>
T list<T>::iterator::operator*()
{
    return ((this->lstptr)->current)->data;
} 
```

如果您想要`*IT = 3;`编译代码，您还应该让它返回一个引用。

```
template<class T>
T& list<T>::iterator::operator*()
{
    return ((this->lstptr)->current)->data;
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-20T23:48:04.040

您在这里有两个问题；首先是您不小心重载了乘法运算符而不是取消引用运算符；第二个是你没有返回引用类型。

第一个问题是由参数数量引起的。类的每个非静态成员函数都有一个额外的“隐藏”参数：`this`. `this`当然，是指向正在调用函数的对象的指针。结果，您实际上已经声明了一个带有两个参数的运算符版本。通过删除第二个迭代器参数并对 进行操作`this`，您将重载一元`*`而不是二元。

第二个问题是返回类型的次要问题；您将副本返回到原始对象，而不是原始对象本身。将返回类型声明为`T&`返回引用。

# perl - 比较文件和报告统计中的记录 - 方案 1

> ID：890683
> 
> 赞同：1
> 
> 时间：2009-05-20T23:06:36.040
> 
> 标签：perl, file, comparison, visual-diff

要求是：

事实 1：我们有一些由遗留系统生成的数据文件

事实 2：我们有一些由新系统生成的数据文件，最终应该会取代旧系统

事实 3：

1.  这两个文件都是文本/ASCII 文件，记录由多行组成。
2.  记录中的每一行都由字段名和字段值组成。
3.  1 和 2 中行的显示格式不同，但是可以通过使用正则表达式从每行中提取字段名和字段值
4.  字段名称可以在 1 和 2 之间变化，但我们有一个关联它们的映射
5.  每条记录都有一个唯一标识符，可帮助我们将旧记录与新记录相关联，因为输出文件中的记录顺序在两个系统中不必相同。
6.  每个要比较的文件至少为 10 MB，平均为 30 - 35 MB

事实 4：当我们迭代构建新系统时，我们需要比较两个系统在完全相同的条件下生成的文件并协调差异。

事实 5：这种比较是使用昂贵的视觉差异工具手动完成的。为了帮助解决这个问题，我编写了一个工具，将两个不同的字段名合并为一个通用名称，然后对每个记录、每个文件中的字段名进行排序，以便它们按顺序同步（新文件可以有额外的字段，在视觉差异）

事实 6：由于人工比较是由人工进行的，而且人工会犯错误，我们会得到错误的正面和负面，这会极大地影响我们的时间线。

显然问题是，“ALG”和“DS”应该是什么？

我必须解决的场景：

人们继续在视觉上检查差异 - 在这种情况下，现有脚本的性能令人沮丧 - 大部分处理似乎是按字典顺序对行数组进行排序（读取/获取数组元素：Tie::File:: FETCH，Tie::File::Cache::lookup 并将其放在正确的位置以便对其进行排序：Tie::File::Cache::insert, Tie::File::Heap::insert)

```
use strict;
use warnings;

use Tie::File;

use Data::Dumper;

use Digest::MD5 qw(md5_hex);

# open an existing file in read-only mode
use Fcntl 'O_RDONLY';

die "Usage: $0 <unsorted input filename> <sorted output filename>" if ($#ARGV < 1);

our $recordsWrittenCount = 0;
our $fieldsSorted = 0;

our @array;

tie @array, 'Tie::File', $ARGV[0], memory => 50_000_000, mode => O_RDONLY or die "Cannot open $ARGV[0]: $!";

open(OUTFILE, ">" .  $ARGV[1]) or die "Cannot open $ARGV[1]: $!";

our @tempRecordStorage = ();

our $dx = 0;

# Now read in the EL6 file

our $numberOfLines = @array; # accessing @array in a loop might be expensive as it is tied?? 

for($dx = 0; $dx < $numberOfLines; ++$dx)
{
    if($array[$dx] eq 'RECORD')
    {
        ++$recordsWrittenCount;

        my $endOfRecord = $dx;

        until($array[++$endOfRecord] eq '.')
        {
            push @tempRecordStorage, $array[$endOfRecord];
            ++$fieldsSorted;
        }

        print OUTFILE "RECORD\n";

        local $, = "\n";
        print OUTFILE sort @tempRecordStorage;
        @tempRecordStorage = ();

        print OUTFILE "\n.\n"; # PERL does not postfix trailing separator after the last array element, so we need to do this ourselves)

        $dx = $endOfRecord;     
    }
}

close(OUTFILE);

# Display results to user

print "\n[*] Done: " . $fieldsSorted . " fields sorted from " . $recordsWrittenCount . " records written.\n"; 
```

所以我想了想，我相信，如果是 trie，可能是后缀 trie/PATRICIA trie，这样在插入时，每条记录中的字段都会被排序。因此，我不必一次性对最终数组进行排序，成本将被摊销（我的猜测）

在这种情况下会出现另一个问题 - Tie::File 使用数组来抽象文件中的行 - 将行读入树然后将它们序列化回数组将需要额外的内存和处理/

问题是 - 这会比当前对绑定数组进行排序的成本更高吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T02:59:19.800

Tie::File 非常慢。这有两个原因：首先，绑定变量比标准变量慢得多。另一个原因是，在 Tie::File 的情况下，数组中的数据位于磁盘上而不是内存中。这大大减慢了访问速度。Tie::File 的缓存在某些情况下可以提高性能，但当您像在此处那样一次循环遍历数组一个元素时却不能。（缓存仅在您重新访问相同的索引时才有帮助。）使用 Tie::File 的时间是当您有一个算法需要一次将所有数据保存在内存中但您没有足够的内存来执行此操作时。由于您使用 Tie::File 一次只处理一行文件不仅没有意义，而且是有害的。

我不认为 trie 在这里是正确的选择。我会改用普通的 HoH（哈希散列）。您的文件足够小，您应该能够一次将所有内容都保存在内存中。我建议解析每个文件并构建一个如下所示的哈希：

```
%data = (
  id1 => {
    field1 => value1,
    field2 => value2,
  },
  id2 => {
    field1 => value1,
    field2 => value2,
  },
); 
```

如果您在构建数据结构时使用映射来规范化字段名称，这将使比较更容易。

要比较数据，请执行以下操作：

1.  对两个哈希的键进行一组比较。这应该生成三个列表：仅存在于旧数据中的 ID、仅存在于新数据中的 ID 以及同时存在于两者中的 ID。
2.  报告仅出现在一个数据集中的 ID 列表。这些是在其他数据集中没有对应记录的记录。
3.  对于两个数据集中的 ID，逐个字段比较每个 ID 字段的数据并报告任何差异。

# wcf - WCF 客户端收到 TimeoutException（我正在关闭我的连接）

> ID：890684
> 
> 赞同：1
> 
> 时间：2009-05-20T23:08:56.550
> 
> 标签：wcf, proxy, asynchronous, timeout, fiddler

事情是这样的......我已经在这个问题上工作了很长时间，但没有运气

我有一个托管在 IIS 上的 WCF 服务（我也在控制台主机中尝试过，我得到了相同的行为），我通过我的 scvutil 创建的代理调用它，并且服务在几次（很少调用）后无法响应。

但是，这里有一些线索：
1- 它只发生在测试环境中（而不是在我的开发机器上托管的服务），数字！
2-我异步调用服务（client.MyServiceAsync）
3-这是最棘手的......如果我运行提琴手看看发生了什么，客户端工作并且永远不会失败，当然，我关闭提琴手（甚至没有重新启动客户端）

到目前为止，我不知道发生了什么。我开始认为服务器（Win2003）可能有某种“防御者”阻止进一步的连接，这可能吗？请相信我，当我说我在每次通话后都会关闭客户端时，实际上是在我收到来自服务器的响应之后，因为我使用的是异步调用。

任何提示或建议将不胜感激。问候，

编辑：我认为这可能是有用的信息：我在两端都启用了跟踪，但没有运气。
在服务器端，我看到来来往往的连接......并且在某些时候没有更多的连接进入。而在客户端，我看到连接工作，直到其中一个抛出 TimeoutException ......这就是我得到的全部

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T14:30:27.683

您最好的选择是在客户端和服务上启用跟踪，以查看控制流。至少，您将对 WCF 正在执行的操作有所了解。

以下是启用跟踪的信息：http: [//msdn.microsoft.com/en-us/library/ms733025.aspx](http://msdn.microsoft.com/en-us/library/ms733025.aspx)

我建议将客户端和服务器端跟踪加载到服务跟踪查看器工具中，这样您就可以看到相互关联的事件。以下是有关该工具以及如何读取输出的更多信息：http: [//msdn.microsoft.com/en-us/library/aa751795.aspx](http://msdn.microsoft.com/en-us/library/aa751795.aspx)

该工具对于调试此类事情非常宝贵。希望你能马上看到发生了什么。

如果您发现您仍然无法看到您需要的信息，您还可以尝试消息记录（服务跟踪查看器工具也可以读取这些文件）。

我确实认为你在正确的轨道上认为它的连接没有正确关闭。尤其是使用异步操作，很容易在没有意识到的情况下做到这一点。过去，当我在最终请求触发之前重新创建我的客户端对象时，这发生在我身上。这导致我关闭了*第二个*对象的连接，但不是第一个。跟踪查看器很快就向我指出了这一点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-25T17:08:49.817

好的，这就是我解决问题的方法，以防有人遇到同样的问题。
我的服务，异步调用，返回一个流，这个流没有被释放在客户端，因此，代理没有被释放。

谢谢大家的评论。他们有点引导我找到解决方案，因为我以前没有听说过任何新的东西。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-08-29T18:58:39.347

WCF 支持服务限制。这允许您限制可以同时运行的消息/连接/实例的数量。在 MSDN 上搜索 ServiceThrottle。

您在应用程序配置中指定您的 ServiceThrottle，如下所示：

```
 <behaviors>
      <serviceBehaviors>
        <behavior  name="Throttled">
          <serviceThrottling 
            maxConcurrentCalls="1" 
            maxConcurrentSessions="2200" 
            maxConcurrentInstances="1"
          />
        </behavior>
      </serviceBehaviors>
    </behaviors> 
```

如果您怀疑限制是问题所在，请在调试器或转储中查找 ServiceThrottle 对象。这是在转储上使用 cdb 的示例：

**转储服务主机**

```
0:000> !do 0000000001647fc0
Name: System.ServiceModel.ServiceHost
MethodTable: 000007feef98a7f0
EEClass: 000007feef352d60
Size: 248(0xf8) bytes
 (D:\Windows\assembly\GAC_MSIL\System.ServiceModel\3.0.0.0__b77a5c561934e089\System.ServiceModel.dll)
Fields:
              MT    Field   Offset                 Type VT     Attr            Value Name
000007fef23d5918  400098a       4c       System.Boolean  1 instance                0 aborted
000007fef23d5918  400098b       4d       System.Boolean  1 instance                0 closeCalled
000007feef93aa00  400098c        8 ...ct+ExceptionQueue  0 instance 0000000000000000 exceptionQueue
000007fef23d6038  400098d       10        System.Object  0 instance 0000000001648188 mutex
000007fef23d5918  400098e       4e       System.Boolean  1 instance                0 onClosingCalled
000007fef23d5918  400098f       4f       System.Boolean  1 instance                0 onClosedCalled
000007fef23d5918  4000990       50       System.Boolean  1 instance                1 onOpeningCalled
000007fef23d5918  4000991       51       System.Boolean  1 instance                1 onOpenedCalled
000007fef23d5918  4000992       52       System.Boolean  1 instance                0 raisedClosed
000007fef23d5918  4000993       53       System.Boolean  1 instance                0 raisedClosing
000007fef23d5918  4000994       54       System.Boolean  1 instance                0 raisedFaulted
000007fef23d5918  4000995       55       System.Boolean  1 instance                1 traceOpenAndClose
000007fef23d6038  4000996       18        System.Object  0 instance 0000000001647fc0 eventSender
000007feef929a60  4000997       48         System.Int32  1 instance                2 state
000007fef23ce158  4000998       20  System.EventHandler  0 instance 0000000000000000 Closed
000007fef23ce158  4000999       28  System.EventHandler  0 instance 0000000000000000 Closing
000007fef23ce158  400099a       30  System.EventHandler  0 instance 0000000001648660 Faulted
000007fef23ce158  400099b       38  System.EventHandler  0 instance 0000000000000000 Opened
000007fef23ce158  400099c       40  System.EventHandler  0 instance 0000000000000000 Opening
000007fef23d5918  4002e78       56       System.Boolean  1 instance                1 initializeDescriptionHasFinished
000007feef981300  4002e79       58 ...meKeyedCollection  0 instance 00000000016481a0 baseAddresses
000007feef981500  4002e7a       60 ...patcherCollection  0 instance 0000000001648220 channelDispatchers
000007fef2416b80  4002e7b       c0      System.TimeSpan  1 instance 0000000001648080 closeTimeout
000007feef980e70  4002e7c       68 ...erviceDescription  0 instance 0000000001656e28 description
0000000000000000  4002e7d       70                       0 instance 0000000001648290 extensions
0000000000000000  4002e7e       78                       0 instance 0000000000000000 externalBaseAddresses
0000000000000000  4002e7f       80                       0 instance 000000000166cf80 implementedContracts
000007feef989770  4002e80       88 ...nceContextManager  0 instance 0000000001648300 instances
000007fef2416b80  4002e81       c8      System.TimeSpan  1 instance 0000000001648088 openTimeout
000007feef8e9890  4002e82       90 ...rformanceCounters  0 instance 0000000000000000 servicePerformanceCounters
000007feef98b708  4002e83       98 ...rformanceCounters  0 instance 000000000171c590 defaultPerformanceCounters
000007feef981a18  4002e84       a0 ...r.ServiceThrottle  0 instance 0000000001648340 serviceThrottle
000007feef980c20  4002e85       a8 ...erviceCredentials  0 instance 0000000001800ed0 readOnlyCredentials
000007feef980d58  4002e86       b0 ...orizationBehavior  0 instance 0000000001801240 readOnlyAuthorization
0000000000000000  4002e87       b8                       0 instance 0000000000000000 UnknownMessageReceived
000007fef53bc640  4002e77      f80           System.Uri  0   static 0000000001648110 EmptyUri
000007fef23d6038  40032cc       d0        System.Object  0 instance 00000000015be070 singletonInstance
000007fef23d8420  40032cd       d8          System.Type  0 instance 00000000016486a0 serviceType
000007feef981ee0  40032ce       e0 ...ontractCollection  0 instance 0000000001657468 reflectedContracts
000007fef23d1000  40032cf       e8   System.IDisposable  0 instance 0000000000000000 disposableInstance 
```

**转储 ServiceHost 的限制信息**

```
0:000> !do 0000000001648340
Name: System.ServiceModel.Dispatcher.ServiceThrottle
MethodTable: 000007feef981a18
EEClass: 000007feef34c2d8
Size: 72(0x48) bytes
 (D:\Windows\assembly\GAC_MSIL\System.ServiceModel\3.0.0.0__b77a5c561934e089\System.ServiceModel.dll)
Fields:
              MT    Field   Offset                 Type VT     Attr            Value Name
000007feef981a90  400371d        8 ...cher.FlowThrottle  0 instance 00000000016484a8 calls
000007feef981a90  400371e       10 ...cher.FlowThrottle  0 instance 00000000016485d8 sessions
000007feef902140  400371f       18 ...her.QuotaThrottle  0 instance 0000000000000000 dynamic
000007feef981a90  4003720       20 ...cher.FlowThrottle  0 instance 0000000001779f80 instanceContexts
000007feef9808c8  4003721       28 ...l.ServiceHostBase  0 instance 0000000001647fc0 host
000007fef23d5918  4003722       38       System.Boolean  1 instance                1 isActive
000007fef23d6038  4003723       30        System.Object  0 instance 0000000001648410 thisLock 
```

**转储会话限制信息**

```
0:000> !do 00000000016485d8
Name: System.ServiceModel.Dispatcher.FlowThrottle
MethodTable: 000007feef981a90
EEClass: 000007feef34c390
Size: 64(0x40) bytes
 (D:\Windows\assembly\GAC_MSIL\System.ServiceModel\3.0.0.0__b77a5c561934e089\System.ServiceModel.dll)
Fields:
              MT    Field   Offset                 Type VT     Attr            Value Name
000007fef23dd9b8  40034f5       30         System.Int32  1 instance             2220 capacity
000007fef23dd9b8  40034f6       34         System.Int32  1 instance             **2220 count
000007fef23d6038  40034f7        8        System.Object  0 instance 0000000001648618 mutex
000007fef23c4d70  40034f8       10 ...ding.WaitCallback  0 instance 0000000001648598 release
0000000000000000  40034f9       18                       0 instance 0000000001648630 waiters
000007fef23d6748  40034fa       20        System.String  0 instance 00000000016483c8 propertyName
000007fef23d6748  40034fb       28        System.String  0 instance 0000000001648550 configName
0:000> 
```

# palm-os - 什么是开始学习 Palm Treo/Centro 开发的好书或网站？

> ID：890685
> 
> 赞同：1
> 
> 时间：2009-05-20T23:09:10.310
> 
> 标签：palm-os

我是一位经验丰富的程序员，正在寻找用 C 或 C++ 为 Palm OS 开发的良好参考和教程？有哪些好的（最新的）书籍、参考手册和网站可以引导我开始在 Palm Treo 和 Centro 上进行开发？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-20T23:15:52.340

没有关于 PalmOS 的最新书籍，因为该操作系统多年来没有改变。但是[Palm OS 编程](https://rads.stackoverflow.com/amzn/click/com/1565928563)在当时是很好的。也许您想为新的 Pre 开发，那么您可能想要[Palm webOS](https://rads.stackoverflow.com/amzn/click/com/0596155255)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T06:07:00.293

最好的起点是 PalmOS 编程[http://johwil.aquariusoft.org/dev/PalmDev/tut/IDGBooks-PalmOSProgrammingBible.pdf](http://johwil.aquariusoft.org/dev/PalmDev/tut/IDGBooks-PalmOSProgrammingBible.pdf)

那时，阅读 API 文档以及来自 sourceforge 或 www.palmopensourec.com 的源代码可能是个好主意

# regex - 我应该使用 \d 还是 [0-9] 来匹配 Perl 正则表达式中的数字？

> ID：890686
> 
> 赞同：58
> 
> 时间：2009-05-20T23:09:13.807
> 
> 标签：regex, perl

在过去几周阅读了许多问题/答案后，我看到`\d`perl 正则表达式的使用被评论为不正确。正如在 perl 的更高版本中`\d`一样`[0-9]`， as`\d`将表示任何具有 digit 属性的 Unicode 字符，并且`[0-9]`表示字符 '0'、'1'、'2'、...、'9'。

我很欣赏在某些情况下`[0-9]`使用正确的东西，而在其他`\d`情况下会。我想知道哪些人认为使用正确的默认值？

就我个人而言，我觉得这个`\d`符号非常简洁和富有表现力，而相比之下`[0-9]`就有些麻烦了。但我很少有编写多语言代码的经验，或者更确切地说是为不适合 ASCII 字符范围的语言编写代码，因此可能很幼稚。

我注意到

```
$find /System/Library/Perl/5.8.8/ -name \*pm | xargs grep '\\d' | wc -l
  298
$find /System/Library/Perl/5.8.8/ -name \*pm | xargs grep '\[0-9\]' | wc -l
  26 
```

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2009-05-21T07:18:25.200

在我看来使用起来很危险`\d`，这是语言中的一个糟糕的设计决策，就像在大多数情况下你想要的那样`[0-9]`。霍夫曼编码将规定`\d`ASCII 数字的使用。

之前的大多数海报已经强调了为什么你应该使用`[0-9]`，所以让我给你更多的数据：

*   如果我正确阅读了 unicode 图表，“ `۷۰`”是一个数字（印度语中的 70，不要相信我的话）。

*   试试这个：

    ```
    $ perl -le '$one = chr 0xFF11; print "$one + 1 = ", $one+1;'
    １ + 1 = 1 
    ```

*   这是有效数字的部分列表（可能会或可能不会在浏览器中正确显示，具体取决于您使用的字体），对于每个数字，在使用 Perl 进行算术时，只有第一个被解释为数字，如如上所示：

    ```
     ZERO:  0٠۰߀०০੦૦୦௦౦೦൦๐໐０
     ONE:   1١۱߁१১੧૧୧௧౧೧൧๑໑１
     TWO:   2٢۲߂२২੨૨୨௨౨೨൨๒໒２
     THREE: 3٣۳߃३৩੩૩୩௩౩೩൩๓໓３
     FOUR:  4٤۴߄४৪੪૪୪௪౪೪൪๔໔４
     FIVE:  5٥۵߅५৫੫૫୫௫౫೫൫๕໕５
     SIX:   6٦۶߆६৬੬૬୬௬౬೬൬๖໖６
     SEVEN: 7٧۷߇७৭੭૭୭௭౭೭൭๗໗７
     EIGHT: 8٨۸߈८৮੮૮୮௮౮೮൮๘໘８
     NINE:  9٩۹߉९৯੯૯୯௯౯೯൯๙໙９�� 
    ```

你还不服气吗？

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2009-05-20T23:28:23.643

为了最大程度的安全，我建议`[0-9]`在您不打算匹配所有 unicode 定义的数字的任何时候使用。

根据 perldoc [perluniintro](http://perldoc.perl.org/perluniintro.html)，Perl 不支持使用数字以外的数字，所以如果以下都为真`[0-9]`，我肯定会使用：`[0-9]`

1.  您希望将结果用作数字（例如对其执行数学运算或将其存储在仅接受正确数字的地方（例如数据库中的 INT 列））。

2.  非数字`[^0-9]`可能会以正则表达式可以匹配它们的方式出现在数据中。（请注意，对于不受信任/敌对的输入，这应该*始终被认为是正确的。）*

如果其中任何一个为假，则很少有理由明确*不*使用`\d`（您可能会知道何时是这种情况），并且如果您*尝试*匹配所有 unicode 定义的数字，您我肯定想用`\d`。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-05-20T23:29:32.267

根据[perlreref](http://perldoc.perl.org/perlreref.html#ESCAPE-SEQUENCES)， ' `\d`' 是区域感知和 Unicode 感知的。

但是，如果您使用的代码集不是 Unicode，那么您无需担心 Unicode 数字，并且如果您使用的代码集类似于 Latin-1（ISO 8859-1 或 8859-15），那么语言环境意识也不会伤害你，因为代码集不包含任何其他数字字符。

因此，对于很多人来说，很多时候，您可以`\d`毫无顾虑地使用 ' '。但是，如果 Unicode 数据是您工作的一部分，那么您需要更仔细地考虑您的目标。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-21T01:51:00.687

就像从轨道上对站点进行核攻击一样，`[0-9]`这是唯一可以确定的方法。是的，它很丑。是的，选择`\d`UNICODE 和区域设置是愚蠢的。但这是我们的床，我们必须躺在上面。

至于那些在沙子里低头说这不会影响他们今天使用的字符集的人，那么您今天可能正在使用该字符集，但世界其他地方现在正在使用 UTF-8，您将尽快使用它。记住要像维护代码的人一样编写代码，他是一个知道你住在哪里的杀人狂。

哦，对于使用`\d`vs的 Perl 模块`[0-9]`，即使是核心仍然存在[UNICODE 问题](http://www.nntp.perl.org/group/perl.perl5.porters/2009/04/msg145738.html)。

如果您实际上是指任何数字，但希望能够对结果进行数学运算，您可以使用[`Text::Unidecode`](http://search.cpan.org/dist/Text-Unidecode/)：

```
#!/usr/bin/perl

use strict;
use warnings;

use Text::Unidecode;

my $number = "\x{1811}\x{1812}\x{1813}\x{1814}\x{1815}";
print "$number is ", unidecode($number), "\n"; 
```

经过更多测试后，看起来 Text::Unidecode 不能正确处理所有数字字符。我正在编写一个可以工作的[模块](http://gist.github.com/115461)。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-20T23:21:08.523

我觉得两者都必须有自己的位置。但是，99.999% 的时间（尤其是在我封闭的美国大合作世界中）它们是可以互换的。我每天都使用 perl 来处理数据，在我处理的所有数据集中都没有不适合`[0-9]`. 但是，我确实很欣赏和之间有一个重要的区别`\d`，`[0-9]`并且很高兴意识到这种区别。我使用`\d`它是因为它看起来更简洁（如你所说），并且在我的小数据操作世界中永远不会“错误”。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-20T23:29:15.060

如果应用于`\d`Unicode 字符串（例如 in `"\X{660}" =~ /\d/`），它将匹配一个 Unicode 数字。如果你应用`\d`到一个二进制字符串（比如上面的 UTF-8 等价物：）`"\xd9\xa0" =~ /\d/`，它将只匹配 10 个 ASCII 数字。Perl 5.8 默认不创建 Unicode 字符串（除非您特别要求它，例如 in`"\X{...}"`或`use utf8;`等）。

所以我的建议是：只注意你的应用程序是否使用 Unicode 字符串之间`\d`的区别。`[0-9]`

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-21T15:04:30.517

如果`[0-9]`感觉笨拙，也许您可​​以定义：`$d=qr/[0-9]/;`并使用它而不是`\d`.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-06-24T13:43:51.763

随着数据格式控制的增加，对模式特异性的需求下降......

例如，如果您要匹配一条机器生成的数据并且始终遵循相同的输出格式规则，那么您不需要那么精确。获取 IPv4 地址。如果您尝试从路由器接口配置行中提取 IP 地址，您真正需要的只是：

```
 'ip\haddress\h(\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\D' 
```

另一方面，如果您试图找到嵌入在某处深处的 IP 地址，例如，电子邮件 X-Header，或者如果您试图验证 IP 地址，那么……这完全是另一回事！

# c# - 实现接口的开销

> ID：890687
> 
> 赞同：16
> 
> 时间：2009-05-20T23:09:28.110
> 
> 标签：c#, java, .net, performance, interface

我的一位同事告诉我，实现接口会带来开销。这是真的？

我不关心微优化；我只想知道这需要更深层次的细节。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-05-21T02:02:32.643

无法抗拒并对其进行了测试，看起来几乎没有开销。

参与者是：

```
Interface IFoo    defining a method
class Foo: IFoo   implements IFoo
class Bar         implements the same method as Foo, but no interface involved 
```

所以我定义

```
Foo realfoo = new Foo();
IFoo ifoo = new Foo();
Bar bar =  new Bar(); 
```

并调用该方法，该方法对每个变量进行 20 次字符串连接，10,000,000 次。

```
realfoo:   723 Milliseconds
ifoo:      732 Milliseconds
bar:       728 Milliseconds 
```

如果该方法什么都不做，实际调用会更加突出。

```
 realfoo: 48 Milliseconds
  ifoo: 62 Milliseconds
  bar: 49 Milliseconds 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-21T00:13:07.140

**从Java**的角度来看，至少在最近的 Hotspot 版本中，在**重要的时候，答案通常很少或没有开销**。

例如，假设您有如下方法：

```
public void doSomethingWith(CharSequence cs) {
  char ch = cs.charAt(0);
  ...
} 
```

CharSequence 当然是一个接口。因此，您可能期望该方法必须做额外的工作，检查对象类型，查找方法，并且这样做可能最后搜索接口等等 - 基本上所有您可以想象的恐怖故事......

但实际上，VM 可能比这聪明得多。如果在实践中，你总是传递特定类型的对象，那么它不仅可以跳过对象类型检查，甚至可以内联方法。例如，如果您在一系列字符串的循环中调用上述方法，Hotspot 实际上可以内联对 charAt() 的调用，以便从字面上获取字符变成一对 MOV 指令——换句话说，**一个接口上的方法调用甚至可以变成根本没有方法调用**。（PS 此信息基于 1.6 更新 12 的调试版本的程序集输出。）

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-05-20T23:16:08.503

由于调用方法或访问属性时执行的额外间接操作，接口确实会产生开销。很多实现多态的系统，包括接口的实现，一般都使用虚拟方法表，根据运行时类型映射函数调用。

理论上，编译器可以优化对普通函数调用或内联代码的虚函数调用，前提是编译器能够证明调用对象的历史。

在绝大多数情况下，使用虚函数调用的好处远远超过了缺点。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-05-20T23:24:31.763

> 我不关心微优化，只是想知道这需要更深层次的细节。

有开销，但它是微优化级别的开销。例如，一个接口可以在 IL 中进行多次调用，从 call 切换到 callvirt，但这非常小。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-20T23:23:38.597

是的，接口会产生开销。事实上，您在逻辑和处理器之间添加的每一层都会增加开销。显然，您应该在汇编中编写所有内容，因为这是唯一不会产生开销的东西。GUI 也会产生开销，所以不要使用它们。

我在开玩笑，但重点是您必须在清晰、可理解、可维护的代码和性能之间找到自己的平衡点。对于 99.999%（当然是重复）的应用程序，只要您注意避免不必要地重复执行任何更昂贵的方法，您就永远不会达到需要使某些东西更难维护的地步只是为了让它运行得更快。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-05-20T23:45:27.133

除非您有非常具体的要求（即“我们正在制作一款游戏，它必须以 60fps 的速度运行，数据布局、缓存一致性和所述数据的转换非常重要”），否则我什至不会考虑额外的性能编写软件时调用接口的成本。只有在特定情况下才会引人注目。

例如：通过紧密循环中的接口进行无数次调用（即使这样，执行方法主体的成本也可能使接口调用开销相形见绌），或者在处理数据时进行大量的“指针追逐”。

此外，没有什么可以阻止您更改接口的合同以使调用更粗粒度，例如，`IMyInterface.Process(Car[] cars)`而不是`IMyInterface.Process(Car car)`

在 Code Complete 中，Steve McConnell 建议不要进行持续的微优化。他说最好使用良好实践（即专注于可维护性、可读性等）编写程序，然后，一旦完成，如果性能不够好，请对其进行分析并采取措施解决主要瓶颈。

*仅仅因为它可能*更快，就推测性地优化所有代码是没有意义的。如果 80% 的执行时间花在执行 20% 的代码上，那么“仅仅因为”它可能会在这里或那里减少 10 微秒，就在各处牺牲松散耦合显然是愚蠢的。因此，您节省了 10 微秒，但如果某些其他功能正在吞噬 CPU，您的程序将不会变得更快。

如果您正在开发非性能关键软件，我会将避开接口归类为微优化。如果需要，它也可以在之后轻松删除（假设您不会很快发布软件）。大多数软件不需要极快的速度。也有例外（游戏、模拟器、实时股票交易等），但即便如此，罪魁祸首并不总是界面。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-05-21T02:17:23.630

不幸的是，对于 Java，还有一些优化可以用来提高接口性能。是的，与 invokespecial 相比，invokevirtual 和 invokeinterface 指令“几乎没有开销”，但是有一个[达芬奇项目](http://openjdk.java.net/projects/mlvm/subprojects.html#interface-perf)针对接口的非常常见的琐碎使用中的性能缺陷：一个只实现单个接口并且永远不会实现的对象超载。

请参阅[此 Java bugparade 请求以](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=6580709)获取您可能希望的所有技术细节。

与往常一样（您似乎理解这一点），在对此类微优化提出质疑时，请参考[Amdahl 定律。](http://en.wikipedia.org/wiki/Amdahl%27s_law)如果您要进行如此多的方法调用并且需要速度，请考虑将重构与彻底的基准测试相结合。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-05-20T23:14:13.000

开销比什么？

通过接口调用比调用非虚拟方法更昂贵，是的。我没有亲自测试过它，但我认为它的大小与虚拟通话相似。

也就是说，在大多数情况下，性能通常不是不使用接口做某事的正当理由——大多数情况下，调用量还不够重要。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2011-03-08T14:43:13.393

出于好奇，我实施了一个[小基准](https://bobah.net:8444/d4d/source-code/misc/invokevirtual-vs-invokeinterface-performance-benchmark)。根据我的想法，代码应该阻止 JVM 缓存方法解析结果，因此应该显示Java 中的*invokeinterface*和*invokevirtual*之间的明显区别。

基准测试的结果是*invokeinterface比**invokevirtual*慢 38% 。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-05-20T23:31:47.737

尽管接口不应该产生开销，但它确实会产生开销。我不直接知道这一点，但是二手的，我们在有线电视盒上工作，它们的动力太弱了，以至于我们测试了不同的性能场景。（实例化的类数有很大的不同）。

这不应该是因为接口在运行时影响很小，它不像调用“通过”接口，接口只是编译器链接两段代码的方式——在运行时它不应该超过一个指针调度表。

然而，它确实会影响性能。我猜它与元数据/反射有关，因为如果您不需要元数据，则使用接口的唯一时间是从不太具体的接口转换到该接口时，然后它只需要成为一个标签来检查它是否可能。

我会关注这个问题，因为我很想知道是否有人知道技术原因。您可能希望将其扩展到 Java，因为这将是完全相同的原因，并且您更有可能使用 Java 获得答案，因为一切都是开源的。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-06-04T06:47:28.577

Virtual Stub dispatch 与 Interface Dispatch 不同。Vance Morrison，CLR JIT 负责人在这篇博文中详细描述了这一点。 [http://blogs.msdn.com/vancem/archive/2006/03/13/550529.aspx](http://blogs.msdn.com/vancem/archive/2006/03/13/550529.aspx)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-05-21T13:23:41.390

由于 vtable 中有额外的间接层，通过接口调用比其他形式的*虚拟方法调用稍微昂贵一些。*在大多数情况下，这无关紧要，因此您不必过分担心性能并坚持良好的设计。

话虽如此，最近我通过引入接口并通过接口进行所有调用来重构了一些类。我非常自信（或懒惰），以至于我们在没有性能检查的情况下发布它不会产生任何影响。事实证明，这对整个应用程序的性能（不仅仅是调用）有 10% 的影响。我们进行了许多更改，这是我们怀疑的最后一件事。最终，当我们切换回具体课程时，原始性能恢复了。

这是一个高度优化的应用程序，以上可能不适用于其他情况。

# tree - 在 Common Lisp 中绘制树

> ID：890689
> 
> 赞同：14
> 
> 时间：2009-05-20T23:09:55.847
> 
> 标签：tree, lisp, common-lisp

这个问题可能有一个令人尴尬的简单答案，但是在 Common Lisp 中是否有正确的方法来格式化/绘制树？我已经尝试了几本书以及谷歌搜索，但问题似乎落在了搜索词的裂缝之间。

提前致谢！

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-05-21T08:06:34.947

你想画什么样的树？

[SDRAW](http://www.cs.cmu.edu/~dst/Lisp/sdraw/)将 cons 单元结构绘制到终端。类似：[绘制缺点树](https://github.com/cbaggers/draw-cons-tree)。

如果你有[McCLIM](http://common-lisp.net/project/mcclim/)、CLIM 或 Lisp 机器，你可以调用 CLIM 函数[CLIM:FORMAT-GRAPH-FROM-ROOT](http://www.lispworks.com/documentation/lw50/CLIM/html/climuser-283.htm)或 CLIM:FORMAT-GRAPH-FROM-ROOTS。

如果您使用 LispWorks，则有一个[图形窗格](http://www.lispworks.com/documentation/lw51/CAPRM/html/capiref-148.htm#pgfId-895252)。

如果你想画植物，请使用这个：[L-Lisp](http://www.ii.uib.no/~knute/lsystems/llisp.html)。

![植物图](https://www.ii.uib.no/~knute/lsystems/gtree2.png)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-21T04:08:13.690

如果您决定使用 GraphViz，请查看[http://common-lisp.net/project/cl-graphviz](http://common-lisp.net/project/cl-graphviz)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-21T00:23:26.603

如果您找不到更好的解决方案，我倾向于发出一个 .dot 文件，然后将其提供给[Graphviz](http://www.graphviz.org/)工具之一（如 dot）。文件格式非常简单，工具可以生成多种格式，包括 PNG、SVG、PostScript 甚至图像地图（用于在网页上创建可点击的图形）。

如果您希望这些图表供您自己使用（例如：调试）或者您在服务器上生成它们，这种方法可能只适用于您。调用客户端应用程序中的单独工具可能存在可用性和/或许可问题。

这并不是一个真正的 common-lisp 特定解决方案，但我过去曾在几种语言中使用过这种方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-10-02T13:04:42.363

近年来，我在 GP 应用程序中使用了[lisp2dot](http://www.cs.ucl.ac.uk/staff/W.Langdon/lisp2dot)（一个生成点命令的 Awk 脚本），但目前它似乎不起作用。每次我用有效的 Lisp 表达式输入它时，它都会返回奇怪的 Dot 文件，其中充满了无意义的错误消息。尽管如此，还是值得一提的。

# numeric - 将 SKU 从字母数字更改为数字，操作方法！

> ID：890691
> 
> 赞同：0
> 
> 时间：2009-05-20T23:10:41.977
> 
> 标签：numeric, alphanumeric

我们公司有数千个 SKU，目前有 1-6 位数字后跟 10 个字母，代表各种颜色选项，即。1550-B= 产品 1550 为黑色。B 代表黑色。165334-W = 产品为白色等。

我们的新系统只允许使用数字代码（这对我们的员工来说也更容易对所有内容进行 10 键操作）。

我们需要建议如何以数字方式输入库存编号以及与颜色相同的数字代码。我们试图弄清楚如何区分产品和颜色。SKU 目前以数字 1-9 + 0 结尾，所以我们对此束手无策。不确定我们是否可以使用句点。在数字之间，因为这可能有效，即。1665.2 与 2 代表黑色。可以在数字系统中使用句点或任何其他字符吗？我倾向于不这么认为——所以如果你有任何想法，你就会成为救命稻草！谢谢！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-20T23:34:49.277

您需要绘制出字母后缀所代表的所有选项，并查看使用了多少组合。（是的，这将是一项艰巨的任务。）然后您知道后续新 SKU 之间需要多少“空间”，并使用它来转换旧 SKU 的数字部分，将其乘以 10 的倍数以适应该差距。

示例：产品 165534 可能有四种颜色，黑色、白色、绿色和棕色。例如，B、W、GR 和 N。但 1550 有六种颜色：黑色、白色、灰色、蓝色带红色条纹、蓝色带黄色条纹和蓝色带白色条纹。B、W、G、BR、BY 和 BW。好的，这有八种变化。因此，您可以按如下方式转换它们：

```
 - 165534-B  => 1655340
 - 165534-W  => 1655341
 - 165534-GR => 1655343
 - 165534-N  => 1655344
 - 1550-B    =>   15500
 - 1550-W    =>   15501
 - 1550-G    =>   15502
 - 1550-BR   =>   15505
 - 1550-BY   =>   15506
 - 1550-BW   =>   15507 
```

请注意，我将数字部分乘以 10，然后将字母后缀转换为唯一的数字前缀。这样做的第一个优势是 SKU`xxxx1`始终是白色的。第二个优点是产品 165534 仍然是 165534。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-20T23:17:33.290

如果您的系统允许浮点值，则使用小数位应该没问题。

如果不是，则要求数字中的最后一位（或两位，或三位等）数字表示颜色。这样，您需要做的就是查看最后 n 位来确定颜色。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-20T23:18:35.940

如果它类似于杂货店的水果或蔬菜系统（这是我能想到的最接近的东西），那么句号和特殊字符将不起作用 - 如果出现以下情况，它会增加操作员错误的可能性他们必须开始记住事物的十进制编码。这在很大程度上取决于您构建系统的产品。

是否可以将产品编号与颜色编号合并并仅创建一个长数字 SKU？IE：

1554643是x产品--白色

1554644是x产品--黑色

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-20T23:45:16.243

如果您的 sku 系统使用“十进制”作为 sku 类型，您可以使用小数，但我怀疑它确实如此。

似乎最明智的方法是

1) 取 sku 中的所有字母，大写 2) 转换为 ascii 3) 将它们全部加起来 4) 将其用作 sku 的最后 4 位数字，前导零

所以 1555-WB => w=87, b=66, = 153

```
1555-WB = 1555(0153)
1555-WC = 1555(0154)
1555-ZZZZZZZZZZ = 1555(0900) (0900 i the max) 
```

由于前面有 6 位数字，因此您将始终将最后 4 位数字作为“子产品”代码，直到您管理超过 6^10 个产品！

除非你很不走运并且找到了它们碰撞的地方，否则你总是可以通过再次做同样的数学来匹配旧的 sku，而无需在某个地方手动维护映射。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-20T23:56:52.600

哎呀，有什么问题！如果您的颜色相对较少，并且像 staticsan 的方法应该可以正常工作。如果您有一组丰富的颜色，您可以将每种颜色映射到其 12 位或 24 位 RGB 颜色代码。这些颜色代码与您在网页设计（例如 CSS 样式表）中使用的颜色代码相同。

因此，例如，要在网页上制作红色的东西，您将红色调到最大并将绿色和蓝色保持为零：#FF0000（24 位）或#F00（12 位）。白色是每种颜色都变亮或#FFFFFF (#FFF)。黑色关闭红色、绿色和蓝色灯：#000000（或#000）

因此，您可以像这样将颜色名称映射到 RGB 值，然后将它们转换为十进制并将它们附加到现有的数字代码中。

您可以将这些颜色值映射为一个十进制数字，也可以将它们映射为单独的 R、G 和 B 十进制数字并将它们连接起来（更具可读性，但会占用更多数字）。我想我会推荐一个四位数的值，它是 12 位 RGB 值的十进制等效值。

如果您使用 Firefox，您可以下载 ColorZilla 插件，然后使用它来挑选网页上的颜色，以查看它们映射的内容。另请参阅此[CSS 颜色图表](http://www.somacon.com/p142.php)。

# ms-access - 如何在 VBA 中重新定义数组？

> ID：890709
> 
> 赞同：6
> 
> 时间：2009-05-20T23:16:07.147
> 
> 标签：ms-access, vba

我正在尝试重新定义 MS Access VBA 中的数组。最有效的方法是什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-20T23:19:03.160

怎么样...

这将保留 MyArray 中已有的数据

```
 Redim Preserve MyArray(15) 
```

这将删除 MyArray 中存在的任何先前数据

```
 Redim MyArray(15) 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-21T00:04:25.910

重新调整数组大小的最**有效**方法是限制调整数组大小的次数。每次调整数组大小时，VB 都会获取整个数组并复制它，浪费时间和内存。

如果您在开发时不知道数组的大小，您应该对数组的最大大小做出最好的猜测，然后填充数组。完成填充数组后，您可以将其调整为正确的大小。

在循环中，一旦空间不足，通常最好通过将当前数组的大小加倍来进行这种猜测。您可以在下面看到这一点，`RedimTestA()`每次迭代都调整数组的大小（1,000,000 次）并且`RedimTestB()`只是偶尔调整它的大小（22 次）。

在我的笔记本电脑上`RedimTestA()`需要 3.93 秒和`RedimTestB()`0.41 秒。

```
Option Explicit

Sub RedimTest()
  Dim tA, tB As Single
  tA = RedimTestA(1000000)
  tB = RedimTestB(1000000)

  MsgBox "Test A takes : " & tA & ", and Test B takes : " & tB

End Sub

Function RedimTestA(iterations As Long) As Single
  Dim t As Single
  Dim i As Long
  Dim aryString() As String
  Dim myString As String

  t = Timer
  Do While i <= iterations
    ReDim Preserve aryString(i) As String
    aryString(i) = "ABCEFG123"
    i = i + 1
  Loop
  RedimTestA = Timer - t

End Function

Function RedimTestB(iterations As Long) As Single
  Dim t As Single
  Dim i As Long
  Dim aryString() As String
  Dim myString As String

  t = Timer

  ReDim aryString(0) As String
  Do While i <= iterations
    If i >= UBound(aryString) Then
      ReDim Preserve aryString(i * 2) As String
    End If

    aryString(i) = "ABCEFG123"
    i = i + 1
  Loop

  ReDim Preserve aryString(i - 1) As String ' i - 1 becuase of the final i = i + 1
  RedimTestB = Timer - t

End Function 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-05-21T09:26:05.070

另请注意，您只能重新调整多维数组的最右边的维度。

# .htaccess - .htaccess 文件重定向，如果不存在，远程文件上传

> ID：890711
> 
> 赞同：1
> 
> 时间：2009-05-20T23:16:32.247
> 
> 标签：.htaccess, redirect

服务器 A - 应用程序

服务器 B - 来自上传的静态媒体，没有应用程序

服务器 A 上的应用程序处理上传、验证和发布作业以对其进行转换，转换后通过副本（已安装驱动器）将其移动到服务器 B。然后媒体文件通过服务器 A 页面上的播放器加载。

我想通过远程 URL [http://serverB/files/file1234.wtf](http://serverB/files/file1234.wtf)加载文件，如果文件仍然不存在（尚未复制），则透明地将其重定向到[http://serverA/tmp_files/file1234 .wtf](http://serverA/tmp_files/file1234.wtf)

如何使用 htaccess 或任何其他方式做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T01:31:27.573

假设 Apache + mod_rewrite，这应该在你`.htaccess`的 serverB 上工作：

```
RewriteEngine on

RewriteCond %{DOCUMENT_ROOT}/files/%{SCRIPT_FILENAME} !-f
RewriteRule ^/files/(.*)$ http://serverA/tmp_files/$1 [L,R=temporary] 
```

# ruby - 您是否曾经在任何 Ruby 代码中使用过“类实例变量”？

> ID：890712
> 
> 赞同：7
> 
> 时间：2009-05-20T23:16:40.577
> 
> 标签：ruby, class, inheritance, scope, instance-variables

我可以理解为什么您需要一个**类变量**来跟踪诸如已在该类中实例化的对象总数之类的事情。

而且我可以理解为什么您需要一个**实例变量**来存储该类中特定对象的属性。

但是我似乎无法证明**类实例变量是合理的。**

据我了解，它们就像类变量一样，只是它们对子**类不可见，就像类变量一样**。

似乎它的用途将非常有限。还是我错了？有没有人在他们的代码中找到了类实例变量的好用处？或者你能举一个例子来说明这种细微差别很有价值的情况吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-21T01:32:11.037

假设您要计算类的实例数（不包括子类）

```
class A
  @count = 0
  @@count = 0
  def self.inherited(subclass)
    subclass.instance_eval { @count = 0 }
  end
  def self.num_instances
    @count
  end
  def self.num_subclass_instances
    @@count
  end
  def self.new
    @count += 1
    @@count += 1
    super
  end
end
class B < A
end
class C < B
end

A.new
B.new
A.new
B.new
B.new
C.new

A.num_instances #=> 2
A.num_subclass_instances #=> 6
B.num_instances #=> 3
B.num_subclass_instances #=> 6
C.num_instances #=> 1
C.num_subclass_instances #=> 6 
```

您不能使用 class 变量，因为它在所有类及其子类之间共享。`@@count` 请注意对by`B`和所做的更改如何`C`反映在 中`A`，但`@count`不共享。

但总的来说，它对于存储任何特定于类的设置非常有用。_why 在[Dwemthy 的 Array](http://poignantguide.net/ruby/chapter-6.html#section3)中使用它来指定实例属性的初始值，并且在进行 ruby​​ 元编程时经常出现。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-20T23:58:26.623

类变量在类的所有实例之间共享，包括所有子类。有时，跨层次结构的这个变量正是需要的，但有时您可能更喜欢为每个类使用不同的变量。与类变量不同，类实例变量将为每个类对象取不同的值。

[http://martinfowler.com/bliki/ClassInstanceVariable.html](http://martinfowler.com/bliki/ClassInstanceVariable.html)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-21T17:30:00.660

是的，其实我有。这只是从我所拥有的内容中略微修改和修剪：

```
class Widget
  # class instance variable pattern
  class << self; attr_accessor :color; end

  def show_color()
    "This widget is #{self.class.color}"
  end
end
class WidgetR < Widget
  @color = "Russet"
end
class WidgetC < Widget
  @color = "Cordovan"
end
class WidgetL < Widget
  @color = "Liver"
end

WidgetR.new.show_color #=> "This widget is Russet" 
```

但我不确定在我使用它的情况下是否真的有必要。我本可以覆盖该方法。或者提供了一种颜色方法。或者将其作为哈希存储在类变量中。或者甚至在每个实例中都保留一份副本（好吧，那个有点像）。我敢肯定还有其他可能...

有多种选择，语法很尴尬。鉴于我猜测使用它最自然的情况可能相当罕见。

它可能会帮助您尝试使用类和实例变量重现此行为，并看到它很难实现（尽管如果您定义方法等很容易）。

CJ

# model-view-controller - 使用 MVC 方法对用户、组、投资组合和媒体进行建模

> ID：890722
> 
> 赞同：0
> 
> 时间：2009-05-20T23:20:48.027
> 
> 标签：model-view-controller, database-design, cakephp, data-modeling

我正在使用 MVC 范例（在 CakePHP 中）为一个项目创建一个简单的社交网站设计，我有一个名为 Users 的表，它存储所有用户详细信息，我有一个存储所有组详细信息的组表，这两个模型之间的关系是有并且属于很多，然后我有一个 group_portfolios 表，它存储属于一个组的所有投资组合和一个 user_portfolio 表，它存储与用户相关的所有投资组合信息。一个用户可以有多个投资组合 一个组可以有多个投资组合 一个用户可以有很多媒体 一个组可以有很多媒体

我已经分离了与用户和组关联的媒体的功能，我的问题是，

1) 在建模 MVC 应用程序方面，我是否以正确的方式思考？
2）由于我将用户和组的功能分开，因此我最终得到了 2 个表，其中包含与他们相关的所有信息，例如媒体和投资组合。这是否会导致任何冗余和性能相关问题，尤其是在搜索投资组合等时？
3) 当我以后想添加更多功能时，这是否能够扩展？
4）有没有更好的方法来模拟系统？

谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-20T23:47:29.687

您可以使用单一媒体和单一投资组合表。添加一个额外的字段，告诉您它属于用户还是组。然后，不要将 $belongsTo 属性添加到您的模型，而是使用 bindModel 方法动态附加正确的模型。

或者，您也可以使用 UUID (mysql: varchar 36) 而不是整数作为您的 ID。UUID 永远不会发生冲突。因此，您可以使用相同的字段使投资组合和媒体属于用户*和*组。这是可行的，因为当您使用 UUID 时，永远不会有用户与组具有相同的 ID。例子：

```
class Media {
    $belongsTo = array(
        'User' => array('foreignKey' => 'parent_id'),
        'Group' => array('foreignKey' => 'parent_id'),
    );
} 
```

前者在技术上更正确。后者更容易实现，您可能不喜欢长 UUID 创建的较长 URL。

**编辑：**为了解决您对唯一性的评论，UUID 被设计为全球唯一。也就是说，您自己的数据库中不仅不会有重复，而且世界上也不应该有任何重复。任何地方。

请参阅[这篇](http://en.wikipedia.org/wiki/UUID#Random_UUID_probability_of_duplicates)关于使用 UUID 重复的概率的 Wikipedia 文章。简短的故事：在生成 700,000 亿个 UUID 之后，即使只有一个副本的概率也是 100 亿分之 4。您更有可能在同一天被闪电击中两次 :-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T11:07:09.297

除了 Sander Marechal 所说的关于 GUID 的内容之外，您可能还需要考虑媒体模型的[PolymorphicBehavior](http://bakery.cakephp.org/articles/view/polymorphic-behavior)。它将加速您的应用程序，您不必担心任何时候关系破裂。

关于您的设计问题..我们并不真正了解您的应用，也无法提供任何详细的答案。不，这是一个谎言：*我不想提供一个可能错误的答案。*

不过，我可以给你一些建议。:) 你应该坐下来画出你的模型关系，想想它们将如何在现实生活中使用。然后看看是不是少了什么东西，或者是东西太多了。优化和最小化从数据库返回的数据。这里的关键概念是*简单*。如果不是尽可能简单，*那就错了*。

如果你进行到一半并意识到你犯了一个设计错误 -*承认你犯了一个设计错误并修复它*！有时你无法预测一切，也没有什么可耻的（好吧，只要你学到了一些东西……）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-20T23:37:27.790

我使用了 RoR 和 Castle，而不是 CakePHP，所以我将笼统地说。

1：您一直在做和应该继续做的事情被称为“领域建模”——MVC 非常适合这一点，因为您的模型成为领域模型中对象的表示

2：您可以更改投资组合和媒体模型，而不是引用其父项的 id，您有一个“ObjectId”和“ObjectType”——ObjectId 是父项的 id，ObjectType 是类型。您将无法自动连接关系，但可以使用自定义代码执行此操作，因此要获取用户的所有媒体，它变成

```
select * from Media where ObjectId = [userid] and ObjectType = 'User' 
```

代替

```
select * from UserMedia where UserId = [userid] 
```

3：是的，这是一个可扩展的设计。记得将尽可能多的特定于模型的工作推送到模型本身（或存储库）中，以使其“正常工作”

4：也许吧，但你永远不会得到一个“完美”的系统。MVC 很棒，你的设计对于一个简单的社交网络来说似乎很可靠。毫无疑问，您会添加帖子/评论等内容。

# version-control - 命名分支与多个存储库

> ID：890723
> 
> 赞同：130
> 
> 时间：2009-05-20T23:20:48.120
> 
> 标签：version-control, mercurial, branch, dvcs

我们目前在相对较大的代码库上使用 subversion。每个版本都有自己的分支，并且针对主干执行修复并使用迁移到发布分支`svnmerge.py`

我相信是时候进行更好的源代码控制了，而且我已经玩弄 Mercurial 有一段时间了。

关于使用 Mercurial 管理这样的发布结构，似乎有两种观点。每个版本都有自己的存储库，并且针对发布分支进行修复并推送到主分支（以及任何其他较新的发布分支）。或者在单个存储库（或多个匹配的副本）中使用命名分支。

在任何一种情况下，我似乎都可能使用像移植这样的东西来挑选更改以包含在发布分支中。

我问你；每种方法的相对优点是什么？

* * *

## 回答 #1

> 赞同：129
> 
> 时间：2009-05-21T00:27:38.467

最大的区别是分支名称在历史记录中的记录方式。对于命名分支，分支名称*嵌入*在每个变更集中，因此将成为历史的不可变部分。使用克隆将*不会永久*记录特定变更集的来源。

这意味着克隆非常适合您不想记录分支名称的快速实验，而命名分支适用于长期分支（“1.x”、“2.x”等）。

另请注意，单个存储库可以轻松容纳 Mercurial 中的多个轻量级分支。可以将此类存储库中的分支添加为书签，以便您可以轻松地再次找到它们。假设您已经克隆了公司存储库，它看起来像这样：

```
[a] --- [b] 
```

您破解并制作`[x]`and `[y]`：

```
[a] --- [b] --- [x] --- [y] 
```

意思是当有人放入存储库时`[c]`，`[d]`所以当你拉取时，你会得到一个这样的历史图表：

```
            [x] --- [y]
           /
[A B C D]

```

这里在一个存储库中有两个头。您的工作副本将始终反映单个变更集，即所谓的工作副本父变更集。检查这个：

```
% hg parents 
```

假设它报告`[y]`. 你可以看到头

```
% hg heads 
```

这将报告`[y]`和`[d]`。如果您想将您的存储库更新为 的干净签出`[d]`，那么只需执行（`[d]`用修订号替换`[d]`）：

```
% hg update --clean [d] 
```

然后您将看到该`hg parents`报告`[d]`。这意味着您的下一次提交将`[d]`作为父提交。因此，您可以修复您在主分支中注意到的错误并创建变更集`[e]`：

```
            [x] --- [y]
           /
[a] --- [b] --- [c] --- [d] --- [e]

```

要仅推送变更集`[e]`，您需要执行

```
% hg push -r [e] 
```

`[e]`变更集哈希在哪里。默认情况下`hg push`，将简单地比较存储库并查看`[x]`、`[y]`和丢失，`[e]`但您可能还不想共享。`[x]``[y]`

如果错误修复也影响了您，您希望将其与您的功能分支合并：

```
% hg update [y]
% hg merge 
```

这将使您的存储库图如下所示：

```
            [x] --- [y] ----------- [z]
           //
[a] --- [b] --- [c] --- [d] --- [e]

```

和`[z]`之间的合并在哪里。您也可以选择丢弃分支：`[y]``[e]`

```
% hg strip [x] 
```

**我这个故事的主要观点是：**一个克隆可以很容易地代表几个发展轨迹。在不使用任何扩展的情况下，“plain hg”始终如此。不过，[书签扩展](https://www.mercurial-scm.org/wiki/BookmarksExtension)是一个很大的帮助。它将允许您为变更集分配名称（书签）。在上述情况下，您需要一个书签在您的开发头上，一个在上游头上。书签可以使用 Mercurial 1.6 进行**推送和拉**取，并且已成为 Mercurial 1.8 中的内置功能。

`[x]`如果您选择制作两个克隆，您的开发克隆在制作and后将如下所示`[y]`：

```
[a] --- [b] --- [x] --- [y] 
```

您的上游克隆将包含：

```
[a] --- [b] --- [c] --- [d] 
```

您现在注意到错误并修复它。在这里您不必这样做，`hg update`因为上游克隆已准备好使用。您提交并创建`[e]`：

```
[a] --- [b] --- [c] --- [d] --- [e] 
```

要在您的开发克隆中包含错误修复，请将其拉​​入其中：

```
[a] --- [b] --- [x] --- [y]
           \
            [c] --- [d] --- [e]

```

并合并：

```
[a] --- [b] --- [x] --- [y] --- [z]
           \ /
            [c] --- [d] --- [e]

```

该图可能看起来不同，但它具有相同的结构并且最终结果是相同的。使用克隆，您必须少做一些心理簿记。

命名分支在这里并没有真正出现，因为它们是可选的。在我们改用命名分支之前，Mercurial 本身是使用两个克隆开发的。除了“默认”分支之外，我们还维护一个名为“稳定”的分支，并基于“稳定”分支发布我们的版本。有关推荐工作流程的描述，请参阅 wiki 中的[标准分支](https://www.mercurial-scm.org/wiki/StandardBranching)页面。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2009-05-21T00:57:32.183

我认为您希望将整个历史记录在一个仓库中。产生短期回购是为了短期实验，而不是发布等重大事件。

Mercurial 的失望之一是似乎没有简单的方法来创建一个短命的分支，玩弄它，放弃它，然后收集垃圾。树枝是永恒的。我很同情永远不想放弃历史，但超级便宜的一次性分支是`git`我非常希望在`hg`.

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2010-09-21T05:27:42.603

你应该**两者**都做。

从@Norman 接受的答案开始：每个版本使用一个带有一个命名分支的存储库。

然后，每个发布分支都有一个克隆用于构建和测试。

一个关键注意事项是，即使您使用多个存储库，您也应该避免使用`transplant`在它们之间移动变更集，因为 1）它会更改哈希，以及 2）当您的变更集之间存在冲突更改时，它可能会引入很难检测到的错误移植和目标分支。您想改为进行通常的合并（并且没有预合并：始终目视检查合并），这将导致@mg 在他的回答结束时所说的内容：

> 该图可能看起来不同，但它具有相同的结构并且最终结果是相同的。

更详细地说，如果您使用多个存储库，“主干”存储库（或默认、主要、开发等）包含**所有存储库中的****所有**变更集。每个版本/分支存储库只是主干中的一个分支，所有分支都以一种或另一种方式合并回主干，直到您想留下旧版本。因此，在命名分支方案中，主仓库和单个仓库之间唯一真正的区别就是分支是否被命名。

 **这应该很明显为什么我说“从一个回购开始”。那个单一的 repo 是您唯一需要**在任何版本中查找任何变更集的**地方。您可以在发布分支上进一步标记变更集以进行版本控制。它在概念上清晰而简单，并使系统管理员更简单，因为它是唯一必须始终可用和可恢复的东西。

但是，您仍然需要为每个需要构建和测试的分支/版本维护一个克隆。这很简单`hg clone <main repo>#<branch> <branch repo>`，然后`hg pull`在分支 repo 中只会拉取该分支上的新变更集（加上合并的早期分支上的祖先变更集）。

这种设置最适合*单拉*程序的 linux 内核提交模型（表现得像 Linus 勋爵不是很好吗。在我们公司，我们称之为角色*integrator*），因为主 repo 是开发人员唯一需要克隆的东西，并且拉马需要拉进去。分支仓库的维护纯粹是为了发布管理，可以完全自动化。开发人员永远不需要从/推送到分支仓库。

* * *

这是@mg 为这个设置重铸的示例。初始点：

```
[a] - [b] 
```

当您进入 alpha 版本时，为发布版本创建一个命名分支，例如“1.0”。提交错误修复：

```
[a] - [b] ------------------ [m1]
         \                 /
          (1.0) - [x] - [y] 
```

`(1.0)`不是真正的变更集，因为命名分支在您提交之前不存在。（您可以进行一些简单的提交，例如添加标签，以确保正确创建命名分支。）

合并`[m1]`是此设置的关键。与可以有无限数量的 head 的开发者存储库不同，您不希望在主 repo 中有多个 head（除了前面提到的旧的、死的发布分支）。因此，每当您在发布分支上有新的变更集时，您必须立即将它们合并回默认分支（或更高版本的分支）。这保证了一个版本中的任何错误修复也包含在所有后续版本中。

同时，默认分支的开发继续朝着下一个版本：

```
 ------- [c] - [d]
         /
[a] - [b] ------------------ [m1]
         \                 /
          (1.0) - [x] - [y] 
```

和往常一样，您需要在默认分支上合并两个头：

```
 ------- [c] - [d] -------
         /                         \
[a] - [b] ------------------ [m1] - [m2]
         \                 /
          (1.0) - [x] - [y] 
```

这是 1.0 分支克隆：

```
[a] - [b] - (1.0) - [x] - [y] 
```

现在是添加下一个发布分支的练习。如果它是 2.0，那么它肯定会默认分支。如果是 1.1，您可以选择分支 1.0 或默认。无论如何，1.0 上的任何新变更集都应首先合并到下一个分支，然后再合并到默认值。如果没有冲突，这可以自动完成，仅导致空合并。

* * *

我希望这个例子能说明我之前的观点。综上所述，这种方法的优点是：

1.  包含完整变更集和版本历史的单一权威存储库。
2.  清晰和简化的发布管理。
3.  为开发人员和集成商提供清晰和简化的工作流程。
4.  促进工作流程迭代（代码审查）和自动化（自动空合并）。

* * *

UPDATE hg 本身就是[这样做](https://www.mercurial-scm.org/wiki/DeveloperRepos)的：[主仓库](https://www.mercurial-scm.org/repo/hg) 包含默认和稳定的分支，而[稳定的仓库](https://www.mercurial-scm.org/repo/hg-stable/)是稳定的分支克隆。但是，它不使用版本化分支，因为稳定分支上的版本标签足以满足其发布管理的目的。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-20T23:58:30.570

据我所知，主要区别在于您已经说过：命名分支位于单个存储库中。命名分支将所有东西都放在一个地方。单独的存储库更小且易于移动。对此有两种观点的原因是没有明确的赢家。哪一方的论点对您最有意义，可能就是您应该接受的论点，因为很可能他们的环境与您的环境最相似。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-11-19T13:17:37.293

我认为这显然是一个务实的决定，具体取决于当前情况，例如功能/重新设计的大小。我认为 fork 非常适合尚未担任提交者角色的贡献者加入开发团队，通过可忽略的技术开销证明他们的能力。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-08-09T14:26:20.730

我真的建议不要对版本使用命名分支。这就是标签的真正用途。命名分支意味着持久的转移，如`stable`分支。

那么为什么不直接使用标签呢？一个基本的例子：

*   开发发生在单个分支上
*   每当创建发布时，您都会相应地标记它
*   从那里继续发展
*   如果您在某个版本中有一些错误需要修复（或其他），您只需更新它的标签，进行更改并提交

这将在`default`分支上创建一个新的、未命名的头，也就是。一个匿名分支，在 hg 中非常好。然后，您可以随时将错误修复提交合并回主要开发轨道。不需要命名分支。

# .net-4.0 - 让 NCover 在 .Net 4.0 Beta 1 上工作

> ID：890729
> 
> 赞同：1
> 
> 时间：2009-05-20T23:22:45.323
> 
> 标签：.net-4.0, ncover

我是包含 NCover 集成的 Gallio 的作者，所以我很想知道 NCover 在 .Net 4.0 Beta 1 上会做什么。我没想到它会起作用（它没有）。但是，我很好奇是否有人可以就错误消息向我提供启发，因为它提出了一种解决方法，有一天可能对 NCover v1.5.8 社区版用户有用。

.NET 运行时版本 4.0.20506.1 - 加载探查器失败。配置为加载的分析器是为旧版本的 CLR 设计的。您可以使用`COMPLUS_ProfAPI_ProfilerCompatibilitySetting`环境变量来允许当前版本的 CLR 加载较旧的分析器。请查阅文档以获取有关如何使用此环境变量以及与之相关的风险的信息。探查器 CLSID：“{9721F7EB-5F92-447c-9F75-79278052B7BA}”。进程 ID（十进制）：5724。消息 ID：[0x2517]。

谷歌搜索`COMPLUS_ProfAPI_ProfilerCompatibilitySetting`没有结果。有什么线索吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T13:22:09.117

更新：David Broman 在此处发布了关于 COMPLUS 设置的更新：
[David Broman 的 CLR Profiling API 博客：在 CLR V4 上运行 V2 分析器二进制文件](https://web.archive.org/web/20190114032257/https://blogs.msdn.microsoft.com/davbr/2009/05/26/run-your-v2-profiler-binary-on-clr-v4)。

-- David Broman 在 2008 年 11 月 10 日的博客文章中解释了“COMPLUS_ProfAPI_ProfilerCompatibilitySetting”环境变量必须是什么（Stackoverflow 不允许我发布链接）。

NCover 团队已经花费了一些时间调查使 NCover .NET 4.0 准备就绪所需的工作，但主要障碍是缺乏 Microsoft 的文档。Broman 提到了 CLR 在 .NET 2.0 分析器周围放置的几个保护措施，而在 .NET 4.0 分析器周围没有放置这些保护措施，我们需要知道这些保护措施是什么，然后才能知道当我们迁移到 .NET 4.0 时它们是否会被破坏。我们已经被 .NET 2.0 中的可重入要求搞砸了。其他复杂的因素是时间（我们现在正在启动两个新产品）以及 NCover 需要从 ICorProfilerCallback3 派生的接口仍处于测试阶段。

一旦 .NET 4.0 发布，使 NCover 4.0 兼容跳到我们的待办事项列表的顶部。

# javascript - 单击整行（保留中间单击和 ctrl+单击）

> ID：890743
> 
> 赞同：35
> 
> 时间：2009-05-20T23:32:22.417
> 
> 标签：javascript, jquery, events

我有一个 HTML 表格，第一列中有一个链接。我想允许用户单击行中的任意位置来激活该链接。同时，我想保留打开新选项卡/窗口的中键单击和 ctrl+单击功能。以下是该表的示例：

```
<table id="row_link"> 
  <tbody> 
    <tr>
      <td><a href="link1.html">link</a></td> 
      <td>info 1</td> 
    </tr>       
    <tr>
      <td><a href="link2.html">link</a></td> 
      <td>info 2</td> 
    </tr>       
  </tbody> 
</table> 
```

使用 jQuery，我可以允许用户左键单击一行中的任意位置：

```
$("table#row_link tbody tr").click(function () {
    window.location = $(this).find("a:first").attr("href");
}); 
```

这当然会禁用打开新选项卡的标准中键单击和 ctrl+单击功能。有没有更好的方法让用户点击整行，同时保留标准的中间点击和 ctrl+clcik 行为？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-05-25T08:38:39.533

不幸的是，没有办法在每个浏览器中模拟链接和所有相关行为。因此，实现您想要的唯一方法是在`<tr>`元素周围有一个跟随光标的链接；这个链接是不可见的，所以对用户来说，看起来他们正在点击，`<tr>`但他们实际上是在点击隐藏的链接。使用此方法，中键、ctrl+click 和其他任何行为都保持不变！

这是一个演示：http: **[//jsbin.com/ufugo](http://jsbin.com/ufugo)**

这是代码：

```
$("table tr").each(function(){

    var $link = $('a:first', this).clone(true),
        dim = {
            x: [
                $(this).offset().left,
                $(this).offset().left + $(this).outerWidth()
            ],
            y: [
                $(this).offset().top,
                $(this).offset().top + $(this).outerHeight()
            ]
        }

    $link
        .click(function(){
            $(this).blur();
        })
        .css({
            position: 'absolute',
            display: 'none',
            // Opacity:0  means it's invisible
            opacity: 0
        })
        .appendTo('body');

    $(this).mouseover(function(){
        $link.show();
    });

    $(document).mousemove(function(e){
        var y = e.pageY,
            x = e.pageX;
        // Check to see if cursor is outside of <tr>
        // If it is then hide the cloned link (display:none;)
        if (x < dim.x[0] || x > dim.x[1] || y < dim.y[0] || y > dim.y[1]) {  
            return $link.hide();
        }
        $link.css({
            top: e.pageY - 5,
            left: e.pageX - 5
        })
    });

}); 
```

## 编辑：

我使用比上面更好的方法创建了一个 jQuery 插件：http: **[//james.padolsey.com/javascript/table-rows-as-clickable-anchors/](http://james.padolsey.com/javascript/table-rows-as-clickable-anchors/)**

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-05-23T22:07:16.263

**编辑**

这是一个简单的问题，有一个简单的解决方案。我认为不需要可能会在某些浏览器上中断或需要处理时间的讨厌的黑客攻击。尤其是因为有一个简洁易用的 CSS 解决方案。

首先这是一个[演示](http://nadiana.com/sites/default/files/example/clickable.html)

受[@Nick 解决](https://stackoverflow.com/questions/569355/html-table-row-link/570005#570005)一个非常相似的问题的启发，我提出了一个简单的 css+jquery 解决方案。

首先，这是我写的迷你插件。该插件将使用链接包装每个单元格：

```
jQuery.fn.linker = function(selector) {
    $(this).each(function() {
        var href = $(selector, this).attr('href');
        if (href) {
            var link = $('<a href="' + $(selector, this).attr('href') + '"></a>').css({
                'text-decoration': 'none',
                'display': 'block',
                'padding': '0px',
                'color': $(this).css('color')
            })
            $(this).children()
                   .css('padding', '0')
                   .wrapInner(link);
        }
    });
}; 
```

这是一个使用示例：

```
$('table.collection tr').linker('a:first'); 
```

以及您需要的所有 CSS：

```
table.collection {
    border-collapse:collapse;
} 
```

就这么简单。

* * *

您可以使用事件对象来检查鼠标点击类型。这篇[文章](http://abeautifulsite.net/notebook/99)正在讨论一个类似的问题。

无论如何，这里是如何做到这一点：

```
$("table#row_link tbody tr").click(function () {

    if((!$.browser.msie && e.button == 0) || ($.browser.msie && e.button == 1)){
        if (!e.ctrlKey) {
            // Left mouse button was clicked without ctrl
            window.location = $(this).find("a:first").attr("href");
        }
    }
}); 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-28T16:23:45.513

我会从 HTML/css 方面进行攻击。当大多数网站在表格中进行所有布局时，这曾经是一个常见问题。

首先将所有表格单元格的内容做成链接。如果您不希望它们看起来像链接，您可以使用 CSS 从“非链接”单元格中删除下划线。但它们将是链接，无论如何这在语义上是你想要的。

接下来，您要使链接扩展以填充整个单元格。StackOverflow 已经知道这个问题的[答案](https://stackoverflow.com/questions/546946/css-make-a-block-element-fill-the-entire-space-of-a-parent-element)：

`td a { display: block; width: 100%; height: 100%; line-height: 100%; }`

对于单元格之间没有空格的典型表格，整行都是可点击的。而且由于这不依赖于任何技巧或特定于浏览器的黑客攻击，它应该可以在任何地方工作。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-05-24T10:53:09.613

你要这个：

```
$('table#row_link tbody tr').mousedown( function(e){
    if(e.ctrlKey || (!$.browser.msie && e.button == 1) || ($.browser.msie && e.button == 4)){
        //middle mouse button or ctrl+click
    } else {
        //normal left click
    }
}); 
```

这在 FF3.0.10、Chrome 1.0 和 IE6 中进行了测试。我使用 mousedown 事件是因为 firefox 或 IE 都没有将鼠标中键单击传递给 .click(fn) 事件。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-21T00:36:04.097

您可以抓取该事件并查看它的事件代码。但是没有真正的方法可以知道浏览器对这些事件的行为。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-23T18:58:10.733

这是应该起作用的东西：我们不使用 window.location，而是使用 .click() 来模拟对元素内部的第一个单击。此外，使用条件来检查`CTRL`+Click。

应该是这样的：

```
$("table#row_link tbody tr").click(function (e) {
    if(e.ctrlKey) { 
        // Run Ctl+Click Code Here
    } else { 
        $(this).children('a').eq(0).click(); 
    }
} 
```

希望这可以帮助！

戴夫·罗梅罗

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-25T10:27:45.337

您可以创建一个链接并让它在您的 tr 中浮动，参与 mouveover 事件，更新 href 和位置

创建一个像素链接

```
<table id="row_link">....</table>
<a id="onepixel" style="position:absolute;z-index:1000;width:1px;height:1px;"></a> 
```

鼠标悬停时更新href和位置

```
$("#row_link tr").mouseover(
   function(event){
      //update href
      $("#onepixel").attr("href",$(this).find("a:first").attr("href"));
      //update position, just move to current mouse position
      $("#onepixel").css("top",event.pageY).css("left",event.pageX);
   }
); 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-05-23T22:18:20.687

尝试将 a 放在 td 周围，然后将 display:block CSS 元素应用于 td。

这应该使 td 的整个区域都可以单击，所有按钮都作为“正常”链接。

一个例子可能更好：

```
<table id="row_link"> 
  <tbody> 
    <tr>
      <a href="link1.html"><td style="display: block;">link</td></a> 
      <td>info 1</td> 
    </tr>       
    <tr>
      <a href="link2.html"><td style="display: block;">link</td></a>
      <td>info 2</td> 
    </tr>       
  </tbody> 
</table> 
```

过去，类似的方法对我有用，尽管它并不完全适用于表格元素。未经表测试，所以试试吧。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-05-24T10:05:22.677

我认为更大的[链接插件](http://plugins.jquery.com/project/biggerlink)会满足您的要求。这是

*   [文章](http://www.ollicle.com/2007/oct/23/jquery_link_plugin.html)，和
*   [演示](http://www.ollicle.com/eg/jquery/biggerlink/#eg)太。

* * *

## 回答 #10

> 赞同：-4
> 
> 时间：2009-05-21T01:10:40.300

您需要删除 < tbody > 标签

并且只使用'href'属性来获取链接目标并且不要选择锚<a>标签，因为那包含href属性。

```
$("table#row_link tbody tr a").click(function () {

     window.location = $(this).attr("href");

}); 
```

或者只是让链接打开一个新标签。

我希望这对你有帮助。

# .net - Datalist 在回发时不保留值

> ID：890745
> 
> 赞同：1
> 
> 时间：2009-05-20T23:33:54.787
> 
> 标签：.net, vb.net, .net-3.5, datalist

我有一个 datalist 控件，当导致回发的控件位于 Datalist 所在的更新面板之外时，该控件在回发期间未保留其值。我已验证该用户控件及其所有父控件的视图状态已打开。

我的基本情况是我有一个 Datalist，其中包含页面上的用户控件。当用户在网格中选择几行并按下按钮时，会在后端填充一个数据表并分配给 Datalist，该 Datalist 的项目模板设置为 UserControl。在 ItemDataBound 上，我在控件中设置了特定属性，这些属性将该控件上的消息自定义到特定项目。然后使用 AJAX Control Toolkit Modal Popup[ Extender. 当用户按下保存时，整个页面会发回。从用户控件收集数据并保存到数据库中，然后弹出窗口消失。我目前遇到的问题是按下保存按钮而不是适当的数字时 DataList 有 0 个项目。这个问题在我们从 .NET 2.0 升级到 .NET 3.5 后才开始出现。

有什么想法可能导致这种情况吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-21T14:16:15.683

这是由于也位于该页面上的 Infragistics Grid Control 中的错误造成的。一旦我们升级到最新的修补程序，它就解决了这个问题。不过可以找到什么皮塔饼。

# web-applications - 可用性和可配置性

> ID：890746
> 
> 赞同：0
> 
> 时间：2009-05-20T23:34:08.607
> 
> 标签：web-applications, user-interface, usability, portal

在工作中，我可以使用许多设备，从 DataPower 到 Cisco 再到 F5 等等。每个用于配置的用户界面似乎都有不同的布局，其中一些导航位于侧面，而另一些则位于顶部。

可用性指南如何根据用户网站与需要配置的内容而有所不同？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-20T23:42:45.453

两者都可以，两者都运行良好 - 这取决于您选择的方法是否实施良好。例如：大多数路由器的左侧都有一个菜单，每个人都可以轻松使用这些屏幕。相反，Windows 选项对话框总是使用选项卡（在顶部），似乎没有人在那里遇到问题。

甚至微软也改变了他们的风格——Visual Studio 中的属性窗口和 MS Word 2007 中的选项窗口都在左侧有菜单。

这是个人喜好，尽管选项卡似乎在较少选项下效果最佳，而左侧导航更适合更多选项。如果有的话，这可能是经验法则。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T12:25:33.613

有一些证据表明左侧菜单比顶部菜单具有更高的性能和用户偏好。请参阅[http://www.usability.gov/pubs/040106news.html](http://www.usability.gov/pubs/040106news.html)。我怀疑向下扫描菜单项列表以找到感兴趣的菜单项比扫描更容易。

如果您有一个分层菜单，并且无法将所有内容都放在左侧，则将左侧菜单与顶部菜单结合起来可以获得相当的性能。用户的第一个选择（层次结构的顶部）应该来自左侧菜单，最终选择（层次结构的底部）应该来自顶部菜单。

我看不出找到要配置的路由器设置与寻找要购买的袜子有什么不同的任何理由。导航是导航，无论是路由器 UI 还是网站。您看到的差异可能是不同的企业传统或审美观念的结果，而不是不同的可用性指南。

# c# - C# .net 3.5 中的陷阱/惊喜

> ID：890747
> 
> 赞同：3
> 
> 时间：2009-05-20T23:34:35.923
> 
> 标签：c#, .net

一个好熟人和过去的同事突然打电话给我，给了我一份我真的不能忽视的合同。他确信我会很快掌握并掌握 c#（过去在 -> c/c++ / PHP / Python / Lua 方面的经验）。

这个问题与我的另外两个问题一致：

[PHP地雷一般](https://stackoverflow.com/questions/512120/php-landmines-in-general)

[Python 2.x 的陷阱和地雷](https://stackoverflow.com/questions/530530/python-2-x-gotchas-and-landmines)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-20T23:40:30.123

您希望人们在这里回答什么？

在学习 C# 时你会遇到的所有事情？说实话，没有那么多东西。当然，C、C++、Java 和 Javascript 的语法存在差异，这些语言看起来都像 C#，但大相径庭。

但是，您的主要时间将花在学习 .NET 基类库上，而不是 C# 语言上。

**编辑#1**：请注意，我并不是说在 C# 和 .NET 中没有其他问题所说的“地雷”。我要说的是，当然，我相信你也应该能够相当快地掌握 C#，这取决于你所说的你过去的经验。但我还要说，学习 C# 不会是你学习经历的全部、全部。

您可以轻松了解汽车手动换档系统和自动换档系统之间的区别，但实际使用该系统仍需要一些时间。

**编辑＃2**：让我按照您的意图回答您的问题，并添加您可能遇到的典型陷阱。

输入：积极的垃圾收集器。

考虑以下代码：

```
using System;
using System.Threading;
using System.Diagnostics;

namespace ConsoleApplication6
{
    class Program
    {
        static void Main(string[] args)
        {
            Thread t = new Thread(GCThread);
            t.IsBackground = true;
            t.Start();

            SomeClass sc = new SomeClass();
            sc.Test();
            Console.Out.WriteLine("Ending");
        }

        private static void GCThread()
        {
            while (true)
            {
                GC.Collect();
            }
        }
    }

    public class Disposable : IDisposable
    {
        public Boolean IsDisposed { get; set; }

        public void Dispose()
        {
            IsDisposed = true;
        }
    }

    public class SomeClass
    {
        private Disposable _Collectable = new Disposable();

        ~SomeClass()
        {
            _Collectable.Dispose();
            Console.Out.WriteLine("Finalized");
        }

        public void Test()
        {
            Console.Out.WriteLine("Test()");
            Disposable c = _Collectable;
            Debug.Assert(!_Collectable.IsDisposed);
            Thread.Sleep(100);
            Console.Out.WriteLine("c.IsDisposed: " + c.IsDisposed);
        }
    }

} 
```

我的电脑上的对象如下：

```
Test()
Finalized
c.IsDisposed: True
Ending 
```

在这里，我构造了一个 SomeClass 类型的对象，并调用了 .Test 方法。现在正在运行的这个方法（毕竟我调用了它），获取内部变量 _Collectable 的副本，然后断言它尚未释放。

然而，在后台，垃圾收集器现在运行（我的后台线程确保 GC 尽可能频繁地运行），它指示 SomeClass 完成自身，即使我们的 Test 方法仍在执行，并且 finalizer 方法处理对象。

因此，即使 Debug.Assert 确保 IsDisposed 属性为 false，在将其输出到控制台时，对象已被释放，即使该方法仍在运行时也是如此。

垃圾收集器非常具有攻击性，即使我在这里强制它尽可能频繁地运行，您也无法保证它何时会运行。因此，此代码显示了您可能遇到的各种问题的示例。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-20T23:42:05.533

不要将 C# 视为 C++ - 它是一种不同的动物。

学习使用并爱上 GC。期望创建比以前在 C++ 中更多的对象 - 次要临时对象非常常见。您仍然是静态类型，但是当您开始使用 lambda、匿名类型等时，该语言（尤其是使用 C# 3）会感觉更加流畅和灵活。

最重要的是学习和理解 .NET 框架库。了解其中的内容将为您节省最多的时间，还可以帮助您以更“C#”的方式编写代码。如果您需要一个让您的代码在 C# 中感到宾至如归的速成课程，请学习[Microsoft 类库设计指南](http://msdn.microsoft.com/en-us/library/ms229042.aspx)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-20T23:44:59.473

我想你会发现更多从 c# 到 c/c++ 的“陷阱”。

如果您已经对这些语言感到满意，您可能可以通过阅读教科书来加快 c# 的速度，但如果您真的有任何问题，我会感到惊讶。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-20T23:48:06.130

了解 C# 中惰性求值和急切求值之间的区别，或者您可能在调试 LINQ 查询时摸不着头脑。这是关于该主题的一个很好的链接： [惰性评估（相反，渴望评估）](http://blogs.msdn.com/ericwhite/pages/lazy-evaluation-and-in-contrast-eager-evaluation-vb.aspx)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-20T23:50:47.013

我发现 Jon Skeet 的“虚张声势指南”很有用：

[http://www.yoda.arachsys.com/csharp/](http://www.yoda.arachsys.com/csharp/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-20T23:38:06.010

不要放“;” 在类定义之后！

在 C++ 中：

```
class MyClass {

}; 
```

在 C# 中：

```
class MyClass {

} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-21T00:04:46.737

让我困惑的主要是缺少复制构造函数以及引用与值的关系。

查找 ICloneable 和[Jon Skeet 来救援！](http://www.yoda.arachsys.com/csharp/parameters.html)

不过，从 C++ 转到 C# 非常容易。我想我不能忍受回去。

# c# - 如何序列化具有自定义对象类型的列表列表？

> ID：890763
> 
> 赞同：0
> 
> 时间：2009-05-20T23:40:27.800
> 
> 标签：c#, xml-serialization

这是代码：

```
 [XmlRoot("Foo")]
    class Foo
    {
        [XmlElement("name")]
        string name;
    }

    [XmlRoot("FooContainer")]
    class FooContainer
    {
        [XmlElement("container")]
        List<List<Foo>> lst { get; set; }
    }

    XmlSerializer s = new XmlSerializer(typeof(FooContainer)); -->Can't pass through this. 
```

抱怨不能含蓄地施放它blah blah blah，

任何人都可以说出这段代码有什么问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-20T23:48:46.767

~~Foo 和 FooContainer 需要公开。除此之外，它对我来说很好。~~ 不得不稍微充实一下代码，但他的作品......

```
class Program
{
    static void Main(string[] args)
    {
        XmlSerializer s = new XmlSerializer(typeof(FooContainer));

        var str = new StringWriter();
        var fc  = new FooContainer();

        var lst = new List<Foo>() { new Foo(), new Foo(), new Foo() };

        fc.lst.Add( lst );

        s.Serialize(str, fc);
    }
}

[XmlRoot("Foo")]    
public class Foo    {        
    [XmlElement("name")]        
    public string name = String.Empty;    }    

[XmlRoot("FooContainer")]    
public class FooContainer    {

    public List<List<Foo>> _lst = new List<List<Foo>>();
    public FooContainer()
    {

    }

    [XmlArrayItemAttribute()]
    public List<List<Foo>> lst { get { return _lst; } }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-20T23:51:43.673

我知道有人会提到公开，所以我会跳到这里：

是的，他们需要公开，但这不是唯一的问题。实际上运行序列化不起作用（得到描述的错误）

它不喜欢列表

```
[XmlRoot("Foo")]
public class Foo
{
    [XmlElement("name")]
    public string name;
}

[XmlRoot("FooContainer")]
public class FooContainer
{
    [XmlElement("container")]
    public List<SerializableList<Foo>> lst { get; set; }
}

[XmlRoot("list")]
public class SerializableList<T>
{
    [XmlElement("items")]
    public List<T> lst { get; set; }
} 
```

# ms-access - 在 MS-Access 中访问隐藏表的 VBA 语法是什么？

> ID：890767
> 
> 赞同：3
> 
> 时间：2009-05-20T23:41:54.207
> 
> 标签：ms-access

我想创建一个 ms Access 数据库中所有表的列表，包括那些隐藏的表。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-20T23:49:45.300

以下将每个表的名称打印到即时窗口。

```
Sub ShowAllTables()

    Dim obj As AccessObject

    For Each obj In Application.CurrentData.AllTables
            Debug.Print obj.Name
    Next obj

End Sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T07:13:13.823

我不知道 AccessObject 是否可以告诉您该表是否隐藏，但 ADO 当然可以，例如

```
Sub ShowAllTables2()

  Dim cat
  Set cat = CreateObject("ADOX.Catalog")

  With cat
    .ActiveConnection = CurrentProject.Connection

    Dim t
    For Each t In .tables
      Debug.Print t.Name, t.Properties("Jet OLEDB:Table Hidden In Access").Value
    Next

  End With

End Sub 
```

# svn - 如何使用 ant 删除 .svn 目录？

> ID：890772
> 
> 赞同：4
> 
> 时间：2009-05-20T23:44:49.130
> 
> 标签：svn, ant

我尝试了手册中的示例：

```
<delete includeemptydirs="true">
  <fileset dir="${DIR}" includes="**/.svn" defaultexcludes="false"/>
</delete> 
```

（其中 DIR 设置为某个目录）并且它什么也不做。如何使它起作用？我正在使用蚂蚁 1.7.0。

仅供参考：我尝试了很多不同的嵌套元素组合，`dirset`而不是`fileset`它仍然不起作用。:(

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-20T23:51:30.397

你为什么不直接使用**svn export**呢？

无论如何，看起来（[从这里](http://www.jroller.com/stritti/entry/delete_svn_directories_using_an)）以下应该工作：

```
<echo level="info">Remove svn-files...</echo>
<delete includeemptydirs="true" >
    <fileset dir="${checkout.dir}" defaultexcludes="false" >
         <include name="**/.svn/" />
    </fileset>
</delete> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-12-07T10:12:08.730

尝试以下几行：

```
<delete includeemptydirs="true">
   <dirset dir="./" defaultexcludes="false">
      <include name="**/.svn/**" />
   </dirset>
</delete> 
```

# javascript - javascript 函数 inArray

> ID：890782
> 
> 赞同：11
> 
> 时间：2009-05-20T23:47:09.580
> 
> 标签：javascript, arrays

我需要一个可以接受字符串和数组的javascript函数，如果该字符串在数组中，则返回true。

```
 function inArray(str, arr){
   ...
 } 
```

警告：它不能使用任何 javascript 框架。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-20T23:51:42.020

你可以只做一个数组原型函数ala：

```
Array.prototype.hasValue = function(value) {
  var i;
  for (i=0; i<this.length; i++) { if (this[i] === value) return true; }
  return false;
}

if (['test'].hasValue('test')) alert('Yay!'); 
```

请注意使用 '===' 而不是 '==' 如果您需要较少的特定匹配，您可以更改它...否则 [3].hasValue('3') 将返回 false。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-20T23:54:43.777

像这样的东西？

```
function in_array(needle, haystack)
{
    for(var key in haystack)
    {
        if(needle === haystack[key])
        {
            return true;
        }
    }

    return false;
} 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-05-07T04:25:29.653

你可以使用 arr.indexOf()

[http://www.w3schools.com/jsref/jsref_indexof_array.asp](http://www.w3schools.com/jsref/jsref_indexof_array.asp)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2021-10-21T12:31:34.050

你可以简单地使用： Array.prototype.includes()

这是一个演示：

```
const array1 = [1, 2, 3];

console.log(array1.includes(2));
// expected output: true 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-20T23:51:59.413

看看[这个相关的问题](https://stackoverflow.com/questions/237104/javascript-array-containsobj)。这是投票最多的答案中的代码。

```
function contains(a, obj) {
  var i = a.length;
  while (i--) {
    if (a[i] === obj) {
      return true;
    }
  }
  return false;
} 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-08-22T19:59:29.510

小心：

indexOf() 使用部分数据。如果你有 '12', '1'

indexOf('1') 将为您提供 '12' 而不是 '1' 的索引

# django - 左外连接与 Django 中的附加定义

> ID：890792
> 
> 赞同：1
> 
> 时间：2009-05-20T23:50:08.030
> 
> 标签：django, django-models

类项目（models.Model）：用户=models.ManyToManyField（用户，通过='Project_User'）

```
class Project_User(models.Model):
    project = models.ForeignKey('Project')
    user = models.ForeignKey(User)
    property = models.BooleanField() 
```

并非所有项目都有自己的 Project_User 行。

事情，我需要的是获取当前用户的字段“属性”！= true 或当前用户的 Project_User 行不存在的所有项目的查询集。这里有什么方法可以使用 django 的 ORM 来做到这一点吗？因此，我需要 Queryset 对象来对其应用一些其他过滤器。

使用自定义 SQL 我可以做到。当前用户有 id==XXXX:

```
SELECT * FROM "app_project" LEFT OUTER JOIN "app_project_user" 
ON ("app_project"."id" = "app_project_user"."project_id" 
    AND ("app_project_user"."user_id" = XXXX OR "app_project_user"."user_id" IS NULL)) 
WHERE ("app_project_user"."property" = false OR "app_project_user"."property" IS NULL); 
```

我希望，这是可能的，但我不知道如何，但..

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-21T01:29:49.387

对于复杂的查找（以及任何基本上涉及 OR 的查找），我推荐[Django 的 Q operator](http://docs.djangoproject.com/en/dev/topics/db/queries/#complex-lookups-with-q-objects)。

在这种情况下，查询可能如下所示：

```
from django.db.models import Q

q = (Q(project_user=my_current_user) | Q(project_user=None)) & \
    (Q(project_user__property=False) | Q(project_user__property=None))
projects = Project.objects.filter(q) 
```

在这种情况下，不要忘记指出您的字段`NULL`允许这样做：`property`

```
class Project_User(models.Model):
    # ... as above, then:
    property= models.BooleanField(null=True) 
```

否则，django 将针对`property`明确指示 null 不允许的字段发出 CREATE TABLE sql ( `"property" bool NOT NULL`)，这与`Q(project_user__property=None)`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T00:58:49.123

类似的东西

```
p = Projects.objects.filter( users=current_user )
p = p.exclude( project_user__user=current_user,
               project_user__property=True ) 
```

这应该为您提供当前用户的所有项目的查询集，不包括属性值为 True 的当前用户的 Project_User 的查询集

更多信息：[http ://docs.djangoproject.com/en/dev/topics/db/queries/#lookups-that-span-relationships](http://docs.djangoproject.com/en/dev/topics/db/queries/#lookups-that-span-relationships)

# python - 寻找ctypes unicode处理的“Hello World”（包括Python和C代码）

> ID：890793
> 
> 赞同：0
> 
> 时间：2009-05-20T23:50:24.783
> 
> 标签：python, c, ctypes

有人可以向我展示一个非常简单的 Python ctypes 示例，其中涉及**包括 C 代码在内的 Unicode 字符串？**

比如说，一种获取 Python Unicode 字符串并将其传递给 C 函数的方法，该函数将其与自身连接并将其返回给 Python，Python 将其打印出来。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-09-03T18:17:44.507

该程序用于从 Python`ctypes`调用。[`wcsncat`](http://www.gnu.org/s/libc/manual/html_node/Copying-and-Concatenation.html#index-wcsncat-511)它连接`a`并`b`进入一个不够长的缓冲区，无法`a + b + (null terminator)`演示更安全`n`的连接版本。

对于非常量参数，您必须传递`create_unicode_buffer()`而不是传递常规不可变参数，否则您可能会遇到分段错误。`u"unicode string"``wchar_t*`

如果您需要与之交谈的函数返回 UCS-2，`sizeof(wchar_t) == 4`那么您将无法使用`unicode_buffer()`，因为它会在`wchar_t`Python 的内部 Unicode 表示之间进行转换。在这种情况下，您可能可以使用 and 的某种组合，`result.create_string_buffer()`或者只创建一个and`result.decode('UCS2')`的数组。我必须这样做才能调试 ODBC 驱动程序。`c_short``u''.join(unichr(c) for c in buffer)`

例子.py：

```
#!/usr/bin/env python
#-*- encoding: utf-8 -*-
import sys
from ctypes import *
example = cdll.LoadLibrary(".libs/libexample.so")
example.its_an_example.restype = c_wchar_p
example.its_an_example.argtypes = (c_wchar_p, c_wchar_p, c_uint)
buf = create_unicode_buffer(19) # writable, unlike u"example".
buf[0] = u"\u0000"
a = u"あがぃいぅ ☃ "
b = u"個人 相命理 網上聯盟"
print example.its_an_example(buf, a, len(buf) - len(buf.value) - 1)
print example.its_an_example(buf, b, len(buf) - len(buf.value) - 1)
print buf.value # you may have to .encode("utf-8") before printing
sys.stdout.write(buf.value.encode("utf-8") + "\n") 
```

例子.c：

```
#include <stdlib.h>
#include <wchar.h>

wchar_t *its_an_example(wchar_t *dest, const wchar_t *src, size_t n) {
    return wcsncat(dest, src, n);
} 
```

Makefile：（确保缩进是一个制表符，而不是空格）：

```
all:
    libtool --mode=compile gcc -g -O -c example.c
    libtool --mode=link gcc -g -O -o libexample.la example.lo \
            -rpath /usr/local/lib 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-05-21T01:43:45.193

```
from ctypes import *

buffer = create_string_buffer(128)
cdll.msvcrt.strcat(buffer, "blah")
print buffer.value 
```

> 注意：我知道 Python 代码很简单，但我正在努力解决的是 C 代码。它是否需要释放其输入字符串？Python 会代表它释放它的输出字符串吗？

不，您需要自己手动释放缓冲区。人们通常做的是立即从 buffer.value 中复制 python 字符串，然后释放缓冲区。

> 可以发一下C代码吗？– 迈克 2 小时前

```
#include <string.h>

char* mystrcat(char* buffer) {
    strcat(buffer, "blah");
    return buffer;
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-21T00:13:26.470

未经测试，但我认为这应该有效。

```
s = "inputstring"
mydll.my_c_fcn.restype = c_char_p
result = mydll.my_c_fcn(s)
print result 
```

至于内存管理，我的理解是你的 c 代码需要管理它创建的内存。也就是说，它不应该释放输入字符串，但最终需要释放返回字符串。

# visual-studio-2010 - F# 运算符“？”

> ID：890794
> 
> 赞同：15
> 
> 时间：2009-05-20T23:50:32.583
> 
> 标签：visual-studio-2010, f#

我刚刚看了[这个页面](http://blogs.msdn.com/dsyme/archive/2009/05/20/detailed-release-notes-for-the-f-may-2009-ctp-update-and-visual-studio-2010-beta1-releases.aspx)上的信息，又是新的吗？提到了运营商，我不清楚它的用途是什么。
任何人都可以提供一个快速的解释，发布一个如何使用这个操作符的代码，并可能提到一个用例吗？
**编辑**：这真的很尴尬，我注意到 ? 操作员在 Don 的发行说明中不再提及。知道为什么吗？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-05-22T23:34:25.803

此 F# 版本中有两个新的“特殊”运算符，(?) 和 (?<-)。它们没有定义，但它们可用于重载，因此您可以自己定义它们。特殊的一点是他们如何对待他们的第二个操作数：他们要求它是一个有效的 F# 标识符，但将它传递给将运算符作为字符串实现的函数。换句话说：

```
a?b 
```

脱糖为：

```
(?) a "b" 
```

和：

```
a?b <- c 
```

脱糖为：

```
 (?<-) a "b" c 
```

这些运算符的一个非常简单的定义可能是：

```
let inline (?) (obj: 'a) (propName: string) : 'b =
    let propInfo = typeof<'a>.GetProperty(propName)
    propInfo.GetValue(obj, null) :?> 'b

let inline (?<-) (obj: 'a) (propName: string) (value: 'b) =
    let propInfo = typeof<'a>.GetProperty(propName)
    propInfo.SetValue(obj, value, null) 
```

请注意，由于 gettor 的返回类型是通用的，因此在大多数情况下，您必须在使用站点指定它，即：

```
let name = foo?Name : string 
```

尽管您仍然可以链式调用 (?) （因为 (?) 的第一个参数也是通用的）：

```
let len = foo?Name?Length : int 
```

另一个更有趣的实现是重用 VB 提供的 CallByName 方法：

```
open Microsoft.VisualBasic    

let inline (?) (obj: 'a) (propName: string) : 'b =
    Interaction.CallByName(obj, propName, CallType.Get, null) :?> 'b //'

let inline (?<-) (obj: 'a) (propName: string) (value: 'b) =
    Interaction.CallByName(obj, propName, CallType.Set, [| (value :> obj) |])
    |> ignore 
```

这样做的好处是它将正确处理属性和字段，使用 IDispatch COM 对象等。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-21T00:04:43.227

听起来像“？” 运算符与动态语言运行时 (DLR) 相关。也就是说，当您想在运行时而不是在编译时绑定到对象成员（方法、属性）时使用它。

这很有趣，因为我希望这也是动态成员调用在 C# 中的工作方式。唉，C# 通过“伪”类型（“动态”IIRC）公开了这个功能。在我看来，这会使代码不太清晰（因为您必须跟踪变量声明以了解调用是早期绑定还是后期绑定）。

我不知道确切的语法，但如果我不得不猜测，它会替换或增加“。” （点）运算符。如：

```
let x = foo?Bar() 
```

或许：

```
let x = foo.?Bar() 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-07-29T12:42:42.090

nuget 上有一个模块[FSharp.Interop.Dynamic](https://www.nuget.org/packages/FSharp.Interop.Dynamic/)，它使用 dlr 实现动态运算符。

```
let ex1 = ExpandoObject() in
ex1?Test<-"Hi";
ex1?Test |> should equal "Hi"; 
```

它是开源的，Apache 许可证，您可以查看[实现](https://github.com/fsprojects/FSharp.Interop.Dynamic/blob/master/FSharp.Dynamic/Dynamic.fs)，它包括单元测试[示例案例](https://github.com/fsprojects/FSharp.Interop.Dynamic/blob/master/Tests/Library1.fs)。

# vim - 如何在 Vim 中禁用“按 ENTER 或键入命令继续”提示？

> ID：890802
> 
> 赞同：124
> 
> 时间：2009-05-20T23:52:15.590
> 
> 标签：vim

有什么办法可以禁用执行外部命令后出现的“Press ENTER or type command to continue”提示？

编辑：找到一个解决方法：`<CR>`在我的 .lvimrc 中添加一个额外的快捷方式。

```
map <F5> :wall!<CR>:!sbcl --load foo.cl<CR><CR> 
```

有更好的想法吗？

* * *

## 回答 #1

> 赞同：89
> 
> 时间：2009-05-20T23:55:20.047

我不确定如何在全局范围内执行一个命令：

```
:silent !<command> 
```

一定要在后面加上一个空格`silent`

* * *

## 回答 #2

> 赞同：64
> 
> 时间：2009-05-21T00:02:09.423

`<CR>` 找到了一种解决方法：在 map 命令中添加一个额外的。

```
map <F5> :wall!<CR>:!sbcl --load foo.cl<CR><CR> 
```

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2009-05-20T23:57:49.010

```
:help hit-enter 
```

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2013-03-26T22:32:06.670

`cmdheight`在我的 vimrc ( ) 中将设置为 2 `:e $MYVIMRC`：

```
:set cmdheight=2 
```

更多信息[在这里](https://stackoverflow.com/a/12423858/541208)。

* * *

## 回答 #5

> 赞同：19
> 
> 时间：2010-05-10T15:34:34.340

这就是我如何处理通过静默运行外部程序会在文本模式 vim 中弄乱屏幕的问题（根据我的经验，gvim 不会遇到这个问题）：

```
command! -nargs=1 Silent
\ | execute ':silent !'.<q-args>
\ | execute ':redraw!' 
```

使用它代替常规的静默命令：

```
:Silent top 
```

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2013-03-25T14:27:32.690

*可能是vimrc*文件中的语法错误

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2013-04-16T18:22:31.077

anthony 的回答把我带到了正确的地方，我能够配置 gvim 不要停止在很多消息上。
我将 set 添加`shortmess=aoOtI`到我的 gvimrc 文件中。
由 提供给您的帮助页面中对此进行了说明`:help shortmess`。
这些字母表示您不想看到的消息类别，或者希望 vim 截断以避免*命中输入*停止。
我之前通过`columns=130`在 gvimrc 中设置一个宽的初始窗口来管理这个，所以很少有消息会溢出它并且需要烦人的、令人筋疲力尽的、需要按 Enter 键。

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2015-04-29T20:04:24.970

这就是我在没有“按 ENTER”的情况下在棘手的情况下运行外部命令的方式。与 不同`:silent`，我仍然可以看到命令输出。

**命令行**

```
:exe ":!<command>" | redraw 
```

**脚本/函数**

```
exe ':!<command>' 
redraw 
```

**映射与`<expr>`**

```
map <expr> <F5> ":exe ':!<command>'\n:redraw\<CR>" 
```

**映射`<expr>`调用一个函数**

```
map <expr> <F5> MyFoo()
fu! MyFoo()
    return ":exe ':!<command>' | redraw\<CR>"
endf 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2015-09-08T14:15:44.113

您可以使用：

```
call feedkeys(" ") 
```

例如：

```
function! Interactive_Questions()
    echo "Question 1:"
    let response1 = getchar()
    echo "Question 2:"
    let response2 = getchar()

    " Do something

    " Without the next line, you would have to hit ENTER,
    " even if what is written (the questions) has no interest:
    call feedkeys(" ")
endf 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2020-01-26T13:40:01.560

我的案例（自动命令）`set shortmess+=F`成功了。

> :h shortmess
> F 编辑文件时不提供文件信息，例如`:silent`

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2012-04-02T03:38:48.753

在屏幕清除之前进行重绘也可以。这是我所拥有的：

```
exe 'ls'  
exe 'b4'  "This redraws, so the Prompt is triggered 
```

但这不会触发提示：

```
exe 'ls'  
redraw  
exe 'b4' 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2017-07-24T08:56:05.927

我有类似的问题，但是当我运行 argdo 来替换多个文件中的相同字符串时，例如，

```
 argdo %s/something/Something/eg|update 
```

我经常不得不向下按页面。

您可以在运行脚本之前设置以下选项，以便只有最终提示而不是许多提示

```
:set nomore 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2018-01-31T03:27:22.540

*   如果您使用的是键映射，那么通过在命令末尾添加更多，您的生活会更轻松——但通常 2 次就足够了。
*   但是，如果您从 vim 命令行执行命令。然后有点棘手。`silent`您可以在实际命令之前添加关键字。执行完命令后，它会自动带你回到 vim 窗口。但是您仍然需要手动执行`redraw`，因为需要重新绘制一些像 NERD_Tree 这样的窗口。

    *   对于这种情况，请尝试按照 vim 帮助文档中的说明进行操作：

        > 要减少 hit-enter 提示的数量：
        > 
        > *   将“cmdheight”设置为 2 或更高。
        > *   将标志添加到“shortmess”。
        > *   重置“showcmd”和/或“标尺”。

    *   [该链接](http://vim.wikia.com/wiki/Avoiding_the_%22Hit_ENTER_to_continue%22_prompts)提供了另一种出路。把它放到你的 vimrc 文件中

        ```
        命令！-nargs=1 静音
        \执行“静音！” .
        \ | 执行“重绘！”

        ```

然后您可以`:Silent command`像使用常规命令一样使用。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2018-09-17T23:56:03.050

如果您的错误是由 E303 引起的，那么在**文件****中创建一个临时目录`.vimrc`**可能会修复它。

打开任何文件后，写入并输入：

```
:messages 
```

如果有错误会提示。

如果您看到 E303 (Error303)“无法打开“{filename}”的交换文件，无法恢复”，这可能表明系统中有旧的尝试恢复交换文件（很可能丢失或不存在） .

要解决此问题，**请在文件中分配一个临时目录`.vimrc`。**

要查找`.vimrc`文件的位置，请键入并输入以下内容：

```
$ locate .vimrc
/root/.vimrc 
```

打开文件`$ vi .vimrc`

将此附加到文件的末尾：

```
set directory=.,$TEMP 
```

保存并关闭`:wq`

最后，重新加载配置文件：

```
$ . /etc/profile 
```

尝试使用 VI 打开任何文件。问题将得到解决。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2019-06-04T16:17:59.420

在我这边，解决方案是[在命令链中更频繁](https://github.com/hilbix/tino/commit/320141b63bf0937abd433fc739223ea3682991ce)[地使用`silent`](https://github.com/hilbix/tino/commit/320141b63bf0937abd433fc739223ea3682991ce)。

具体之前，`.vimrc`有：

```
nnoremap M :silent make\|redraw!\|cc<CR> 
```

这已更改为：

```
nnoremap M :silent make\|silent redraw!\|silent cc<CR> 
```

以前，“Press ENTER”并不总是出现，但很烦人。额外`silent`的 s 解决了这个问题。（看起来`silent`不需要`redraw!`因为`:cc`“Press ENTER”消息。）

> 此更改的缺点是不再显示 的输出`:cc`，因此您必须猜测错误是什么。[稍作调整即可](https://github.com/hilbix/tino/commit/e2e2cb12a8a3e8e40e0703d6112ecf1e9f9e7f3e)解决此问题：
> 
> ```
> nnoremap M :silent make\|redraw!\|cw\|silent cc<CR> 
> ```
> 
> 这使得错误 QuickFix list (Output of `make`) 自动出现（并且，通过 vim-magic，如果没有错误，则消失）。

供参考：

`M`这种映射的动机是`M`在正常模式下按下：

*   保存编辑（当使用`make`一切都在 - 控制之下`git`）
*   调用`make`
*   并直接跳转到第一个错误或警告

我`Makefile`的 s 通常是这样构造的，这只需要几分之一秒。

通过一些调整，这也可以应用于非`C`类型工作负载：

在`.vimrc`添加

```
set efm+=#%t#%f#%l#%c#%m# 
```

这允许`vim`解释如下消息`:cc`（显示错误）：

```
#E#file#line#column#message#
#W#file#line#column#message#
#I#file#line#column#message# 
```

（ rrors `E`，`W`arnings，`I`nfo，基于`vim`魔法）

[示例如何将其用于 Python 脚本](https://github.com/hilbix/tino/blob/master/howto/python3vim.sh)。（对不起，这里没有副本，这是一个不同的故事。）

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2017-01-04T13:36:53.263

如果我将文件保存在我没有对该目录的写权限的目录中，就会发生这种情况。我在目录上做了一个 chmod 777 （我已经对文件本身具有写权限）并且“按 ENTER”消息不再出现。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2019-12-15T13:30:37.837

On `gvim`，如果你设置了`guioptions+=!`（Added `!`in `guioptions`），就是因为这个。此选项 ( `!`)`gvim`在外部终端上执行一些命令（支持更多功能，如颜色等）。

您可以尝试使用它`:set guioptions-=i`，看看这是否适合您。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2021-07-19T10:48:21.437

您可以在下面写 2 行`vimrc`来禁用来自 vim 的所有消息

```
set shortmess=
set cmdheight=2 
```

这对我有用，希望你能解决这个问题

# eclipse - 停止 Eclipse 换行？

> ID：890805
> 
> 赞同：35
> 
> 时间：2009-05-20T23:53:55.977
> 
> 标签：eclipse, eclipse-formatter

有没有办法让 eclipse 停止擦除现有的换行符？如果我有这样的方法签名，我不知道如何让 eclipse 不理会它：

```
void foo(
    int arg1,
    int arg2,
    int arg3,
    int arg4)
{
    // ...
} 
```

使用各种设置，它会将参数折叠到一行，或者将它们包装在一些边距，如下所示：

```
void foo(
    int arg1, int arg2,
    int arg3, int arg4)
{
    // ...
} 
```

使用“将所有元素换行，每个元素都换行”它确实保留了这个空格，但它总是会换行，这不是我想要的。我希望 eclipse 为缩进和大括号等应用格式，而无需删除（或插入）任何换行符。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-05-21T08:13:39.333

参数的格式是[一个古老的主题](http://dev.eclipse.org/newslists/news.eclipse.tools.jdt/msg16799.html)，但 3.5 中引入的一个新的格式功能是：

*   [eclipse3.5M4](http://download.eclipse.org/eclipse/downloads/drops/S-3.5M4-200812111908/eclipse-news-M4.html#JDT) “保留用户换行符的格式化程序选项”

Java 代码格式化程序现在可以通过不加入代码或注释中的行来选择保留用户换行符。

例如，以下测试用例中的 return 语句的换行：

![前](https://i.stack.imgur.com/b1EcD.png)
^(要格式化的代码示例)

当使用“从不加入线”首选项时，格式化程序将保留它，现在产生以下结果：

![后](https://i.stack.imgur.com/Wps8K.png)
^(从不加入行的编码格式)

可以在`Java > Code Style > Formatter`首选项页面上配置此首选项。请参阅和选项卡`Never join lines`上的选项。`Line Wrapping``Comments`

这可能会有所帮助，但除此之外，3.5 中这方面的新功能并不多。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2011-03-22T22:49:43.747

当我在我的 Java 代码上使用 Eclipse 中的“格式”功能时，它倾向于在不同的地方拆分或破坏我的代码行，以确保内容始终适合特定的宽度。如果你有一个宽显示器，我发现这不是最佳的。我通过执行以下操作解决了这个问题：

在 eclipse 3.5 中，您可以打开首选项并搜索“格式”或从左侧菜单中选择**Java** -> **Code Style** -> **Formatter 。**默认配置文件称为“Eclipse [内置]”，如果您想更改 Java 格式化程序，您需要复制它并**创建您自己的配置文件**。这可以通过配置文件名称正下方的“新建”按钮来完成。

在 Eclipse 中创建自己的 Java 格式化程序后，请确保它已被选中并点击**编辑**按钮。这里有很多功能可以自定义，但为了解决换行问题，我选择了“**换行**”选项卡。在常规设置下，您将看到“**最大线宽**：”。该数值是格式化程序将使用的最大行长度。对于更大的显示器，例如**180 个**字符 ，我将我的尺寸提高到了一个更**合理的尺寸。****保存并应用**它并返回到您的代码。

 ****当您下次尝试格式化 java 文件时，只有当您超过新的最大大小时才会发生换行。

快乐编码！

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2010-11-15T10:59:29.563

您可以使用注释来指导格式化程序。

```
void foo( //
  int arg1, //
  int arg2, //
  int arg3, //
  int arg4) 
```

将保留评论中的换行符。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-05-21T00:22:00.633

Eclipse 3.5 支持这一点。（它在几天前发布了候选版本，因此值得一试）

# complexity-theory - 您创建或看到的最复杂的网站/网页是什么？

> ID：890806
> 
> 赞同：-1
> 
> 时间：2009-05-20T23:54:03.373
> 
> 标签：complexity-theory

您创建或看到的最复杂/最复杂的网站或网页是什么？

是什么让它如此复杂或复杂？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-20T23:56:47.423

Amazon.com 可能符合条件。每次您提出请求时，它都会调用数百个服务。如果它不在列表的顶部，我敢打赌它在复杂性的前十名中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-20T23:57:06.110

最近发布了 wolframalpha.com。

这非常复杂，因为我什至无法理解他们是如何做的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-10-26T13:52:49.990

我认为 Archello.com 非常复杂。社交网络、高级搜索、增强现实、开源、视频、数据库、时事通讯等。似乎在一个网站上应有尽有。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-21T02:02:28.277

我认为一些谷歌网络应用程序，如搜索引擎、GMail 和分析是相当复杂的。

# javascript - 按排序顺序遍历 Javascript 关联数组

> ID：890807
> 
> 赞同：112
> 
> 时间：2009-05-20T23:54:07.147
> 
> 标签：javascript

假设我有一个 Javascript 关联数组（又名哈希，又名字典）：

```
var a = new Array();
a['b'] = 1;
a['z'] = 1;
a['a'] = 1; 
```

如何按排序顺序遍历键？如果它有助于简化事情，我什至不需要这些值（它们都只是数字 1）。

* * *

## 回答 #1

> 赞同：137
> 
> 时间：2012-06-30T11:40:30.110

您可以使用[Object.keys](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Object/keys)内置方法：

```
var sorted_keys = Object.keys(a).sort() 
```

（注意：这在不支持 EcmaScript5 的非常旧的浏览器中不起作用，尤其是 IE6、7 和 8。有关详细的最新统计信息，请参阅[此表](http://caniuse.com/#search=es5)）

* * *

## 回答 #2

> 赞同：123
> 
> 时间：2009-05-21T00:01:19.973

你不能直接遍历它们，但你可以找到所有的键，然后对它们进行排序。

```
var a = new Array();
a['b'] = 1;
a['z'] = 1;
a['a'] = 1;    

function keys(obj)
{
    var keys = [];

    for(var key in obj)
    {
        if(obj.hasOwnProperty(key))
        {
            keys.push(key);
        }
    }

    return keys;
}

keys(a).sort(); // ["a", "b", "z"] 
```

但是，无需将变量“a”设为数组。您实际上只是将它用作对象，应该像这样创建它：

```
var a = {};
a["key"] = "value"; 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-05-21T00:21:08.373

你甚至可以将它原型化到对象上：

```
Object.prototype.iterateSorted = function(worker)
{
    var keys = [];
    for (var key in this)
    {
        if (this.hasOwnProperty(key))
            keys.push(key);
    }
    keys.sort();

    for (var i = 0; i < keys.length; i++)
    {
        worker(this[ keys[i] ]);
    }
} 
```

和用法：

```
var myObj = { a:1, b:2 };
myObj.iterateSorted(function(value)
{
    alert(value);
} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-05-21T15:20:35.087

我同意[Swingley 的回答](https://stackoverflow.com/questions/890807/iterate-over-a-javascript-associative-array-in-sorted-order/891017#891017)，我认为重要的一点是，很多这些更复杂的解决方案都缺失了。如果您只关心关联数组中的键并且所有值都是“1”，那么只需将“键”作为值存储在数组中。

代替：

```
var a = { b:1, z:1, a:1 };
// relatively elaborate code to retrieve the keys and sort them 
```

采用：

```
var a = [ 'b', 'z', 'a' ];
alert(a.sort()); 
```

这样做的一个缺点是您无法确定是否轻松设置了特定键。有关该问题的答案，请参阅[此](https://stackoverflow.com/questions/890782/javascript-function-inarray/890798#890798)对[javascript 函数 inArray](https://stackoverflow.com/questions/890782)的答案。所提出的解决方案的一个问题是，`a.hasValue('key')`它会比`a['key']`. 这在您的代码中可能很重要，也可能无关紧要。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-21T00:58:16.707

没有直接操作 Javascript 对象的“键”的简洁方法。它并不是为此而设计的。您是否可以自由地将数据放入比常规对象（或数组，如您的示例代码所建议的那样）更好的东西中？

如果是这样，并且您的问题可以改写为“如果我想按排序顺序迭代键，我应该使用什么类似字典的对象？” 那么你可能会开发一个像这样的对象：

```
var a = {
  keys : new Array(),
  hash : new Object(),
  set : function(key, value) {
    if (typeof(this.hash[key]) == "undefined") { this.keys.push(key); }
    this.hash[key] = value;
  },
  get : function(key) {
    return this.hash[key];
  },
  getSortedKeys : function() {
    this.keys.sort();
    return this.keys;
  }
};

// sample use
a.set('b',1);
a.set('z',1);
a.set('a',1);
var sortedKeys = a.getSortedKeys();
for (var i in sortedKeys) { print(sortedKeys[i]); } 
```

如果您无法控制数据位于常规对象中这一事实，则此实用程序会将常规对象转换为您的全功能字典：

```
a.importObject = function(object) {
  for (var i in object) { this.set(i, object); }
}; 
```

为简单起见，这是一个对象定义（而不是可重用的构造函数）；随意编辑。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-21T00:00:55.853

在第一个循环中获取键，对其进行排序，在第二个循环`for`中使用排序结果。`for`

```
var a = new Array();
a['b'] = 1;
a['z'] = 1;
a['a'] = 1;

var b = [];
for (k in a) b.push(k);
b.sort();
for (var i = 0; i < b.length; ++i) alert(b[i]); 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-07-25T10:33:18.897

您可以使用[underscore.js](http://underscorejs.org/)[`keys`](http://underscorejs.org/#keys)库中的函数来获取键，然后使用数组方法对它们进行排序：`sort()`

```
var sortedKeys = _.keys(dict).sort(); 
```

`keys`下划线源码中的函数：

```
// Retrieve the names of an object's properties.
// Delegates to **ECMAScript 5**'s native `Object.keys`
_.keys = nativeKeys || function(obj) {
    if (obj !== Object(obj)) throw new TypeError('Invalid object');
    var keys = [];
    for (var key in obj) if (_.has(obj, key)) keys.push(key);
    return keys;
};    

// Shortcut function for checking if an object has a given property directly
// on itself (in other words, not on a prototype).
_.has = function(obj, key) {
    return hasOwnProperty.call(obj, key);
}; 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-21T02:39:52.693

```
<script type="text/javascript">
    var a = {
        b:1,
        z:1,
        a:1
    }; // your JS Object
    var keys = [];
    for (key in a) {
        keys.push(key);
    }
    keys.sort();
    var i = 0;
    var keyslen = keys.length;
    var str = '';
    //SORTED KEY ITERATION
    while (i < keyslen) {
        str += keys[i] + '=>' + a[keys[i]] + '\n';
        ++i;
    }
    alert(str);
    /*RESULT:
    a=>1
    b=>1
    z=>1
    */
</script> 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-06-18T18:33:04.723

```
var a = new Array();
a['b'] = 1;
a['z'] = 1;
a['a'] = 1;

var keys=Object.keys(a).sort();
for(var i=0,key=keys[0];i<keys.length;key=keys[++i]){
  document.write(key+' : '+a[key]+'<br>');
}
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-11-01T04:53:20.350

我真的很喜欢@luke-schafer 的原型创意，但也听听他对原型问题的看法。使用一个简单的函数怎么样？

```
function sortKeysAndDo( obj, worker ) {
  var keys = Object.keys(obj);
  keys.sort();
  for (var i = 0; i < keys.length; i++) {
     worker(keys[i], obj[keys[i]]);
  }
}

function show( key, value ) {
  document.write( key + ' : ' + value +'<br>' );
}

var a = new Array();
a['b'] = 1;
a['z'] = 1;
a['a'] = 1;

sortKeysAndDo( a, show);

var my_object = { 'c': 3, 'a': 1, 'b': 2 };

sortKeysAndDo( my_object, show);
```

这似乎消除了原型的问题，并且仍然为对象提供了一个排序的迭代器。不过，我并不是真正的 JavaScript 专家，所以我很想知道这个解决方案是否存在我错过的隐藏缺陷。

# iis - 将 .html 映射到 IIS7 中的 ASP.NET 管道的正确方法是什么

> ID：890814
> 
> 赞同：2
> 
> 时间：2009-05-20T23:55:52.213
> 
> 标签：iis, iis-7

我有一个 .net 应用程序，我想响应 .htm 和 .html 请求（除了 .aspx）。我知道如何在 IIS6 中执行此操作，但在 IIS7 中不知道。有人请赐教！

谢谢，

凯尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T00:09:17.943

处理程序映射
单击右侧的“添加脚本映射”
然后：

请求路径：“*.html”
可执行文件：“%windir%\Microsoft.NET\Framework\v2.0.5 0727\aspnet_isapi.dll”
名称：“YOURNAME”

你试过经典模式吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T01:54:34.813

当您说您希望此应用程序“处理” .html 文件时，您是什么意思？你期望它做什么？运行 HttpModules？你有自己的处理程序吗？

因为 IIS7 已经集成了 ASP.NET 管道。IIS7 管道现在与 ASP.NET 管道相同。我不确定你还需要做什么特别的事情。

# php - 找出有多少用户在线使用 PHP？

> ID：890820
> 
> 赞同：1
> 
> 时间：2009-05-20T23:57:13.333
> 
> 标签：php, count

每次访问我的网站都会更新用户的个人点击计数器，并`time()`根据存储在 cookie 中的 ip 地址和 id 更新一列。因此，当输出数据时，我的以下代码使用更少的数据库调用是一种更有效的方法，因为它本质上是自身的副本：

```
<?
$last1Min = time()-60;
$last5Mins = time()-300;
$last1Hr = time()-6000;
$last1Dy = time()-144000;
$last1Wk = time()-1008000;
$last1Mnth = time()-30240000;

//last1Min
$sql = "SELECT COUNT(*) FROM usersonline WHERE lastOnline > $last1Min";
while($rows = mysql_fetch_array(mysql_query($sql))) {
    echo "Users online in the last minute: " . $rows['COUNT(*)'] . "<br />\n";
}

//last5Mins
$sql = "SELECT COUNT(*) FROM usersonline WHERE lastOnline > $last5Mins";
while($rows = mysql_fetch_array(mysql_query($sql))) {
    echo "Users online in the last 5 minutes: " . $rows['COUNT(*)'] . "<br />\n";
}

//last1Hr
$sql = "SELECT COUNT(*) FROM usersonline WHERE lastOnline > $last1Hr";
while($rows = mysql_fetch_array(mysql_query($sql))) {
    echo "Users online in the last hour: " . $rows['COUNT(*)'] . "<br />\n";
}

//last1Dy
$sql = "SELECT COUNT(*) FROM usersonline WHERE lastOnline > $last1Dy";
while($rows = mysql_fetch_array(mysql_query($sql))) {
    echo "Users online in the last day: " . $rows['COUNT(*)'] . "<br />\n";
}

//last1Wk
$sql = "SELECT COUNT(*) FROM usersonline WHERE lastOnline > $last1Wk";
while($rows = mysql_fetch_array(mysql_query($sql))) {
    echo "Users online in the last week: " . $rows['COUNT(*)'] . "<br />\n";
}

//last1Mnth
$sql = "SELECT COUNT(*) FROM usersonline WHERE lastOnline > $last1Mnth";
while($rows = mysql_fetch_array(mysql_query($sql))) {
    echo "Users online in the last month: " . $rows['COUNT(*)'] . "<br /><br />\n";
} 
```

如果有更有效的方式来呈现这些数据，我想扩展它，不仅显示在我的整个网站上在线的每个指标有多少用户，而且记录和输出我网站上每个页面的数据.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-21T00:22:55.637

```
SELECT 
  SUM(lastOnline <= 60) AS one_minute,
  SUM(lastOnline <= 300) AS five_minutes,
  ...
  SUM(lastOnline <= 30240000) AS one_month
FROM usersonline 
```

使用这种方法，您可以通过单次表扫描在单个查询中获得所需的一切；没有比这更有效的了。正如其他人所提到的，您应该缓存结果，因为它相对昂贵（即使是这种优化形式）。在每次页面加载时计算这一点是没有意义的，特别是如果您看到每秒多次点击（例如，如果您点击 digg 的首页，这极有可能）

lastOnline <= 60 对于条件为真的行计算为 1，对于条件为假的行计算为 0；SUM() 将这些 1 和零相加，为您提供条件为真的行数。

几年前从 mysql 文档中的用户评论中学到了这种技术；其他地方也有[类似的例子](http://en.wikibooks.org/wiki/MySQL/Pivot_table)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-21T00:04:42.477

设置一个 cron 作业，每分钟/5 分钟/等等只计算一次正确的值。缓存结果并改为显示。当它们每分钟或每半小时只更改一次时，真的没有必要每秒计算 X 次此类统计数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T00:01:36.820

无需每次调用​​数据库，您只需在上个月内调用所有数据并按日期排序。然后在 php 中，您可以比较日期和时间以查看用户上次登录的时间。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-21T00:30:06.683

如果您将会话保存到文件中，您可以计算一段时间内访问过的文件数。然后根本就没有数据库访问权限。

# multithreading - 单元测试时如何处理其他线程中引发的异常？

> ID：890826
> 
> 赞同：15
> 
> 时间：2009-05-21T00:00:19.210
> 
> 标签：multithreading, visual-studio, unit-testing, exception

当使用 Visual Studio Team Test 进行测试时，测试中未处理的异常会被捕获并报告在结果中。所以我有点惊讶地看到测试托管进程（VSTestHost.exe）崩溃并显示系统崩溃对话框。

经过进一步调查，此崩溃是另一个线程中引发的未处理异常（更直接地说，它是异步套接字回调）。事实上，这样的事情会使托管过程崩溃：

```
[TestMethod]
void Test()
{
    new Thread(() => { throw new Exception(); }).Start();
} 
```

有什么建议我应该在那里做什么？

*   我是否应该忍受它，说任何分发/签入的代码无论如何都应该至少测试一次，所以这样的事情很可能会被抓住？
*   我应该尝试安装一个全局异常处理程序并在每个拆卸方法中检查它的状态吗？
*   或者也许已经存在帮助这个的东西？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-01T12:21:08.687

您可以使用全局异常处理程序来捕获 AppDomain 中所有未捕获的异常：

```
AppDomain currentDomain = AppDomain.CurrentDomain;
currentDomain.UnhandledException += new EventHandler(UnhandledExceptionHandler); 
```

我认为它也适用于从其他线程抛出的异常

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T00:04:36.703

您可以尝试设置`AppDomain.CurrentDomain.UnhandledException`，看看是否有效？我不知道这如何与 VS 测试工具思想相互作用

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T02:29:41.933

通常，我尝试通过注入一个线程提供程序来避免在单元测试中启动线程，该线程提供程序在单元测试期间实际上并不提供线程，而是同步执行。

当然，使用这种方法，您无法测试任何类型的潜在争用，或两个并行运行的真实代码路径，但有一个很好的论点是这样的测试并不是真正的单元测试。

当您同时测试两个线程时，您需要一个线程提供程序，它在线程结束时捕获异常并将它们报告为失败。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-21T03:01:58.720

几个想法：

*   使用 BackgroundWorker 进行单元测试工作。BackgroundWorker 将自动捕获未处理的异常并在 RunWorkerCompletedEventArgs 的 Error 属性中报告它们。但是，您将需要一种方法来阻止单元测试线程，直到 BackgroundWorker 完成工作。
*   这本身不是一个好的选择，甚至可能不适合您的测试目标。尽管如此，我还是想提一下。[您可以使用legacyUnhandledExceptionPolicy 回到](http://msdn.microsoft.com/en-us/library/ms228965.aspx).NET 1.0 和 1.1 中如何处理来自其他线程的未处理异常。在 .NET 2.0 之前，来自线程的未处理异常会被悄悄地忽略。但是，在 .NET 2.0 中，它们实际上会导致应用程序终止。legacyUnhandledExceptionPolicy 设置允许您拥有 .NET 2.0 之前的行为。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-06-02T20:36:54.487

我可以从 C++ 领域（如果可以翻译知识）说的是，在给定线程中抛出的任何异常都只能**在该线程**中捕获。如果您的主应用程序启动了其他三个线程，那么您必须独立地从每个（现在是 4 个）线程中捕获异常。没有办法在线程代码中实现“全局”异常处理程序。这与操作系统中线程（和进程）的实现方式有关。

但就像我说的，我不知道这种逻辑与 C# 的转换有多接近，因为它运行在像 Java 这样的 VM 之上。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-06-03T18:50:31.607

在你的测试中有多个线程对我来说听起来不是很*统一*。是否有任何关于被测试的逻辑表明必须有多个线程？*真的吗？*

或者是否有一些正在测试的代码的协作者恰好是多线程的（如套接字）？如果是这样的话，你真的应该用某种测试替身（模拟、存根或其他）来代替那些合作者。使用测试替身的额外好处是，如果它们是真实的，您可以更容易地控制它们的行为和响应。

# python - 安装旧版本的 Python 以在 Mac OS X 上进行测试

> ID：890827
> 
> 赞同：2
> 
> 时间：2009-05-21T00:00:20.537
> 
> 标签：python, version, installation

我有带有 Python 2.5 的 Mac OS X 10.5.7。我需要测试我正在使用 Python 2.3 开发的包的兼容性。我不想降级我的整个系统，所以有没有办法安装不改变系统 python 的 Python 2.3？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-21T00:51:55.143

[您有两个主要选择，从macports](http://www.macports.org/)（简单）安装python 2.3或从源代码安装。

对于 macports，运行`port install python23`

第二次，您必须访问[http://www.python.org/download/releases/2.3.7/](http://www.python.org/download/releases/2.3.7/)下载源代码压缩包。一旦你打开一个终端并运行`./configure --prefix /home/(your homedir)/software MACOSX_DEPLOYMENT_TARGET=10.5`然后. 这应该在您可以直接访问的软件目录中放置一个单独的安装。`make``make install`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T05:21:05.940

[此页面](http://farmdev.com/thoughts/66/python-3-0-on-mac-os-x-alongside-2-6-2-5-etc-/)包含有关从源代码构建 python 的有用信息。它谈论的是 3.0，但建议*可能也*适用于 2.3。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T08:55:29.840

你也可以使用 Fink 包管理器并且简单地“fink install python2.3”。

如果您需要 Python 2.3 作为默认版本，您可以简单地更改 /sw/bin/python 和 /sw/bin/pydoc 以指向您想要的版本（它们位于 /sw/bin/ 中）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-21T09:30:18.850

一种替代方法是使用虚拟机。

使用 VMWare Fusion 或 Virtualbox 之类的东西，您可以使用 Python2.3 安装完整的 Linux 系统，并在那里进行测试。优点是它将完全是沙盒，因此根本不会影响您的主系统。

# c# - 使用 Reporting Services 将组保持在一页上

> ID：890832
> 
> 赞同：12
> 
> 时间：2009-05-21T00:03:47.907
> 
> 标签：c#, .net, sql-server, reporting-services

我使用 Reporting Services 创建了一个报表作为 C# 应用程序的一部分，但我找不到一些我习惯于在其他环境中看到的功能。我相信 MS Access 和 Crystal 报表都有一个名为“保持在一起”的选项，以便您可以将特定的数据分组保留在一页上，而不是将信息拆分为两页。

当我的报表在 C# 应用程序中本地呈现并使用 .net 报表查看器查看时，我如何使用 2005 Reporting Services 执行此操作。本质上，我想将某一年的所有记录保存在一页上。我正在使用 Visual Studio 2008。

年份是其中一列，一年的行数总是小于一页。我的报告只使用一个表，按年份进行最内层分组，然后按客户名称进行另一个外层分组。

目前我可以在报告中拟合两年的数据，但是，如果数据从第一年的一半开始，那么我会得到以下信息：

例子：

第一页：2004 年的 1/2，因为数据从 04 年中途开始

2005 年全年

2006年上半年

第2页：2006年下半年

我宁愿将 2006 年的所有内容推到第二页。

我目前正在为报告中的所有数据使用一个表格。表级别有一个保持在一起的选项，但我需要一个组级别的选项。在这种情况下，按年份分组。

任何可以提供的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-27T10:18:57.963

1.  在报告中插入一个“列表”。
2.  在其“Tablix 属性”下，将“数据集名称”属性设置为您的数据集名称。
3.  从设计视图中右键单击列表，然后选择“行组 > 组属性”。
4.  在“组属性”窗口中，单击“组表达式”下的“添加”按钮，然后选择要在页面中分组的字段。
5.  之后，您可以在行组内为您的详细数据插入一个“表格”。
6.  呈现报表后，报表将在分页符之间将组内的数据保持在一起。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-04-16T07:17:32.990

请在“行组”部分下单击要在同一页面中保持在一起的组。单击所需的组后，在属性部分中将“ **Keep Together 选项设为 True ”。**就是这样。它对我有用。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-21T15:08:55.127

只是在约翰的回答中添加一点。对于 SSRS 2005，List 和 Table 对象确实具有 KeepTogether 属性，这意味着它们将尝试将所有内容都保留在一页上。我认为最好的方法是先听从约翰的建议。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-21T10:05:05.550

好的，您需要做的是首先将报告页面大小定义为足够大以包含您的整个数据区域。

看：

[http://msdn.microsoft.com/en-us/library/bb677374.aspx](http://msdn.microsoft.com/en-us/library/bb677374.aspx)

然后，您需要将分页点添加到矩阵中的组。见下文：

[http://msdn.microsoft.com/en-us/library/ms156434.aspx](http://msdn.microsoft.com/en-us/library/ms156434.aspx)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-26T19:01:18.977

使用 Rectangle 元素并将所有控件复制并粘贴到其中。在 tke 矩形属性上，选中将内容保持在一起的框。如果您不想要额外的线条，请不要包含边框。

我在页脚需要的矩阵元素之外有许多项目。我只希望它们在最后一页，所以我不能使用标准页脚部分。通过将它们放在矩形中，我避免了组中间的分页符。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-07T21:49:21.627

问题是我在一页上需要两年而不是 1/2 年，即使特定的记录集在一年中开始。事实证明，即使在表级别有“保持在一起”选项，在组级别也没有。我需要在小组级别使用此选项。我没有使用格式解决方案，而是更改了报告的底层 SQL。在只有 1/2 年数据的情况下，我为一年中的另一部分创建了日期正确的记录，但所有其他值都为零。这意味着如果页面格式正确以保存两年，那么它将始终显示两个完整的年份，并且一年永远不会超过两页。我还认为 Mozy 和 John Sansom 提供的答案很好，我都投了赞成票。

谢谢您的帮助！

# database - 数据库表中应包含哪些字段以进行用户身份验证？

> ID：890833
> 
> 赞同：1
> 
> 时间：2009-05-21T00:04:25.380
> 
> 标签：database, authentication

我正在设计一个用于用户身份验证的表。此表中应包含哪些字段？能够跟踪用户凭据、跟踪帐户锁定失败的登录尝试、实际锁定帐户等的最低要求是多少？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T00:10:39.827

用户名
密码
上次登录日期
创建日期
密码过期日期
锁定
状态

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T00:13:20.960

锁定：用户上的简单“IsLocked”和“LockTime”就足够了。每次他们尝试登录时检查锁，如果它在 LockTime 的 X 内，则不允许，否则将 IsLocked 设置为 false。

跟踪登录尝试的 Simples 方法是设置 LoginAttempt 计数和 LastLoginAttemptTime - 当他们登录时设置 LoginAttempt = 0，否则如果登录失败，则增加 1 并设置 LastLoginAttemptTime。如果他们再次尝试，请再次增加并设置时间。

您保留的凭据取决于系统的类型 - 大多数只是用户名、密码和电子邮件，但金融系统也可能使用 DoB 和密码重置问题。

# javascript - 在chrome中访问新窗口的文档

> ID：890841
> 
> 赞同：2
> 
> 时间：2009-05-21T00:05:25.673
> 
> 标签：javascript, html, forms, google-chrome

我的目标是在新窗口中提交表单。我正在使用以下代码：

```
var xmlWindow = window.open("getXML.htm");
xmlWindow.document.getElementById("getXML").action = "getData.asp";
xmlWindow.document.getElementById("getXML").method = "post";
xmlWindow.document.getElementById("getXML").innerHTML = "<input type='hidden' name='moduleID' value='ex1'/>";
xmlWindow.document.getElementById("getXML").submit(); 
```

这在 IE 和 Firefox 中运行良好，但在 chrome 中 xmlWindow.document.getElementById("getXML") 为空。有什么建议么？

这里的参考是getXML.htm：

```
<html>
<head>
    <title>getXML</title>
</head>
<body>
<form id="getXML" name="getXML">
</form>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T00:50:22.027

您将需要等待页面完成加载（从技术上讲，您在任何浏览器中都需要它） - 例如。在尝试访问文档之前等待 onload 事件触发。

# perl - Perl 管道日志脚本仅每 2 次命中运行一次

> ID：890843
> 
> 赞同：2
> 
> 时间：2009-05-21T00:07:52.813
> 
> 标签：perl, apache2, logging

我正在使用此脚本在 Apache 2 中设置管道日志：

```
#!/usr/local/bin/perl

$|=1; # Use unbuffered output
while (<STDIN>)
{
   if (<STDIN> =~ m/(.php|.html|.htm|.dhtml|.cpp|.h|.c|.txt|.pdf|.pl)$/)
      {system("beep");}
} 
```

我发送指令 %f 给它文件名。如您所知，它会检查请求的文件名是否为内容文件。如果是这样，它会告诉系统发出哔哔声。然而，出于某种原因，服务器仅每两次访问内容页面就会发出哔声。有谁知道为什么会发生这种情况？

我很确定这与我使用的方式有关`<STDIN>`，因为这是我的第一个 Perl 脚本。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-21T00:10:45.053

您使用 while() 读取第一行，然后在 if() 中读取另一行。

将“如果”更改为： if($_ =~ ...)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-21T00:15:32.750

尝试：

```
while ( <> ) {
  system("beep") if /php|pl.../;
} 
```

# c++ - uint64 UTC 时间

> ID：890847
> 
> 赞同：2
> 
> 时间：2009-05-21T00:08:57.897
> 
> 标签：c++, bit-manipulation, utc

我有一个 UTC 日期时间，没有存储在 uint64 中的格式，即：`20090520145024798` 我需要得到这个时间的小时、分钟、秒和毫秒。通过将其转换为字符串并使用子字符串，我可以很容易地做到这一点。但是，这段代码需要非常快，所以我想避免字符串操作。有没有更快的方法，也许使用位操作来做到这一点？哦，顺便说一句，这需要在 Linux 上的 C++ 中完成。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-21T00:17:53.573

```
uint64 u = 20090520145024798;
unsigned long w = u % 1000000000;
unsigned millisec = w % 1000;
w /= 1000;
unsigned sec = w % 100;
w /= 100;
unsigned min = w % 100;
unsigned hour = w / 100;
unsigned long v = w / 1000000000;
unsigned day = v % 100;
v /= 100;
unsigned month = v % 100;
unsigned year = v / 100; 
```

该解决方案从中间切换`uint64 u`到`unsigned long w`（和`v`）的原因是 YYYYMMDD 和 HHMMSSIII 适合 32 位，并且在某些系统上 32 位除法比 64 位除法更快。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-21T00:56:31.670

为了建立在 pts 和 onebyone 的建议的基础上，这里是他们在核心 2 处理器上使用 32 位和 64 位操作的方法的基准：

```
#include <stdio.h>
#include <sys/time.h>
#include <sys/resource.h>

typedef unsigned long long uint64;

struct outs {
    unsigned millisec, sec, min, hour, day, month, year;
};

void tbreakdown2(uint64 u, struct outs *outp) {
    outp->millisec = u % 1000;
    u /= 1000;
    outp->sec = u % 100;
    u /= 100;
    outp->min = u % 100;
    u /= 100;
    outp->hour = u % 100;
    unsigned long v = u / 100;
    outp->day = v % 100;
    v /= 100;
    outp->month = v % 100;
    outp->year = v / 100;
}

void tbreakdown(uint64 u, struct outs *outp) {
    unsigned int  daypart, timepart; //4000000000
                                     //  YYYYMMDD
                                     //HHMMssssss

    daypart = u / 1000000000ULL;
    timepart = u % 1000000000ULL;

    outp->millisec = timepart % 1000;
    timepart /= 1000;
    outp->sec = timepart % 100;
    timepart /= 100;
    outp->min = timepart % 100;
    timepart /= 100;
    outp->hour = timepart;

    outp->day = daypart % 100;
    daypart /= 100;
    outp->month = daypart % 100;
    daypart /= 100;
    outp->year = daypart;
}

uint64 inval = 20090520145024798ULL;

void printstruct(uint64 u, struct outs *outp) {
    printf("%018llu\n", u);
    printf("%04d-%02d-%02d %02d:%02d:%02d.%04d\n",
            outp->year, outp->month, outp->day,
            outp->hour, outp->min, outp->sec,
            outp->millisec);
}

void print_elapsed(struct timeval *tv_begin, struct timeval *tv_end) {
    unsigned long long mcs_begin, mcs_end, mcs_delta;

    mcs_begin = (unsigned long long)tv_begin->tv_sec * 1000000ULL;
    mcs_begin += tv_begin->tv_usec;
    mcs_end = (unsigned long long)tv_end->tv_sec * 1000000ULL;
    mcs_end += tv_end->tv_usec;

    mcs_delta = mcs_end - mcs_begin;

    printf("Elapsed time: %llu.%llu\n", mcs_delta / 1000000ULL, mcs_delta % 1000000ULL);
}

int main() {
    struct outs out;
    struct outs *outp = &out;
    struct rusage rusage_s;
    struct rusage begin, end;

    __sync_synchronize();
    printf("Testing impl 1:\n");
    tbreakdown(inval, outp);
    printstruct(inval, outp);

    __sync_synchronize();
    getrusage(RUSAGE_SELF, &begin);
    for (int i = 0; i < 100000000; i++) {
        __sync_synchronize();
        tbreakdown(inval, outp);
        __sync_synchronize();
    }
    getrusage(RUSAGE_SELF, &end);
    print_elapsed(&begin.ru_utime, &end.ru_utime);

    printf("Testing impl 2:\n");
    tbreakdown2(inval, outp);
    printstruct(inval, outp);

    __sync_synchronize();
    getrusage(RUSAGE_SELF, &begin);
    for (int i = 0; i < 100000000; i++) {
        __sync_synchronize();
        tbreakdown2(inval, outp);
        __sync_synchronize();
    }
    getrusage(RUSAGE_SELF, &end);
    print_elapsed(&begin.ru_utime, &end.ru_utime);

    return 0;
} 
```

和输出：

```
=====32-bit=====
Testing impl 1:
020090520145024798
2009-05-20 14:50:24.0798
Elapsed time: 6.840427
Testing impl 2:
020090520145024798
2009-05-20 14:50:24.0798
Elapsed time: 19.921245

=====64-bit=====
Testing impl 1:
020090520145024798
2009-05-20 14:50:24.0798
Elapsed time: 3.152197
Testing impl 2:
020090520145024798
2009-05-20 14:50:24.0798
Elapsed time: 4.200262 
```

如您所见，即使在本机 64 位模式下，避免过多的 64 位操作也会有所帮助 - 但在 32 位中会产生巨大的差异。

基准测试是在 2.2GHz 的 core2duo T7500 处理器下进行的，并在 -O3 上使用 gcc 4.3.3 编译。您看到的那些内存屏障是为了确保编译器不会尝试优化实际操作，同时允许它在选择时内联它。

# html - 布局是邪恶的，对吗？ 刚刚发现该站点使用表格进行布局。考虑到网站的性质，有没有人觉得这令人不安？我真的不知道该相信什么了:-) http://www.w3schools.com/

> ID：890850
> 
> 赞同：1
> 
> 时间：2009-05-21T00:09:43.607
> 
> 标签：html, layout

刚刚发现该站点使用表格进行布局。考虑到网站的性质，有没有人觉得这令人不安？我真的不知道该相信什么了:-)

[http://www.w3schools.com/](http://www.w3schools.com/)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-21T00:16:41.813

比我更有说服力的人提出了一些令人信服的相反论点。这里有一些最近的文章（因为这对于浏览器技术很重要）要查看：

*   [http://iamelgringo.blogspot.com/2009/02/tables-vs-css-css-trolls-begone.html](http://iamelgringo.blogspot.com/2009/02/tables-vs-css-css-trolls-begone.html)
*   [http://www.flownet.com/ron/css-rant.html](http://www.flownet.com/ron/css-rant.html)
*   [http://thinkvitamin.com/features/css/tables-the-next-evolution-in-css-layout/](http://thinkvitamin.com/features/css/tables-the-next-evolution-in-css-layout/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-21T00:12:32.663

表格适用于显示通常适合...在表格中的数据。想一想具有相关属性的名称列表。

表格不利于布局。布局应该通过 CSS 完成。

数据和显示的分离是所有计算机科学中的一个重要概念。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-21T00:12:58.903

这取决于您使用该表的目的。以及您正在使用多少张桌子。

如果您使用表格来显示表格数据，那是最好的。否则，使用现代的东西。

有时违反纯洁是可以的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-21T00:19:16.597

我认为这个页面是最讽刺的：[CSS 简介](http://www.w3schools.com/css/css_intro.asp)（完全内置在表格中）。它不会让你充满信心......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-21T00:11:24.850

是的，我会避开它。应该为表格数据保留表格 :) 尝试使用 div 和 CSS 来布局站点

# wpf - c# 如何改变窗口焦点 onMouseEnter 事件

> ID：890853
> 
> 赞同：1
> 
> 时间：2009-05-21T00:10:52.323
> 
> 标签：wpf, focus, mouse, window, click

我有一个 WPF 应用程序，只要鼠标光标移到它上面，我就想成为当前的焦点窗口。目前我有一个 onMouseEnter 事件，当鼠标移到它上面时会改变光标，所以我知道系统正在识别，但是我真正想要的是让应用程序本身成为焦点，就好像用户左键单击它一样 - 所以我然后可以执行其他操作。目前，如果我移过它，光标会发生变化，但如果另一个应用程序，例如 - 记事本有焦点，焦点将在之后返回。

在 onMouseEnter 处理程序中，我尝试了“this.Focus()”和“this.Activate()”，但它们都没有达到与单击应用程序相同的结果。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-12-31T10:29:17.983

带有附加到 Grid 控件的 MouseEnter 事件的 WPF C# 示例。如果另一个应用程序窗口具有焦点，它将删除它并将焦点附加到主窗口，就好像用户左键单击它一样。

```
 private void GrdContent_MouseEnter(object sender, MouseEventArgs e)
    {
        Application.Current.MainWindow.Activate();
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T00:22:41.597

编辑：发布的答案不适用于 WPF。对不起。

尝试查看这个而不是 WPF：http: [//blogs.msdn.com/nickkramer/archive/2006/03/18/554235.aspx](http://blogs.msdn.com/nickkramer/archive/2006/03/18/554235.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-01-10T06:06:25.400

在 WPF 中，只需将此行添加到 MainWindow 构造函数即可获得预期结果。

```
MouseEnter += (s, e) => Activate(); 
```

这个原始的单行答案只有在您不与任何其他窗口交互时才有效。即使在这种情况下，以下内容也可以使用，但您将需要 Nuget 包“AutoItX.Dotnet”。

```
private IntPtr myHandle;
public MainWindow() {
  myHandle =  new System.Windows.Interop.WindowInteropHelper(this).Handle;
  MouseEnter += (s, e) => {
    Activate();
    if (AutoIt.AutoItX.WinActive(myHandle) == 0)
      AutoIt.AutoItX.WinActivate(myHandle);
    }; 
```

# asp.net - Asp.Net 分页最佳实践

> ID：890855
> 
> 赞同：3
> 
> 时间：2009-05-21T00:11:39.403
> 
> 标签：asp.net, pagination

我正在使用 linq to sql 来获取我的数据，当我在我的数据网格上设置页面大小并且用户选择第 2 页时，我得到一个回发并重新读取所有数据以显示第二页。我怀疑应该有更好的方法来做到这一点，一种最终只读取我需要显示的数据的方法。我想知道是否有任何代码示例...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-21T00:22:34.767

你真的应该看看[Skip](http://msdn.microsoft.com/en-us/library/bb358985.aspx)和[Take](http://msdn.microsoft.com/en-us/library/bb503062.aspx)方法。

请参阅 ScottGu 在[LINQ to SQL (Part 3)](http://weblogs.asp.net/scottgu/archive/2007/06/29/linq-to-sql-part-3-querying-our-database.aspx)上的帖子，并在页面中搜索“Paging our Query Results”——这有一些很好的示例。

或者，如果您使用[LinqDataSource 控件](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.linqdatasource.aspx)，并且您正在与 SQL 2005 或 2008 数据库通信，您应该会自动获得此行为。[LINQ to SQL（第 5 部分）](http://weblogs.asp.net/scottgu/archive/2007/07/16/linq-to-sql-part-5-binding-ui-using-the-asp-linqdatasource-control.aspx)涵盖了这一点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-21T01:14:51.133

如果您想*真正*减轻数据库负载，请查看[客户端分页](http://www.ajaxlines.com/ajax/stuff/article/use_jquery_and_aspnet_ajax_to_build_a_client_side_repeater.php)...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-25T15:34:44.787

```
public static IEnumerable<new_log> Search(dbDataContext db, int _user,int _pageNumber, int _rowCountPerPage)
{
var query = (
                   from p in db.new_log
                  where p.created_by == (_user < 0 ? p.created_by : _user)  orderby p.id descending
                  select p 
                  )

              .Skip(_pageNumber * _rowCountPerPage).Take(_rowCountPerPage); 
return query;

} 
```

关键点：

1.我们必须禁用页面或控制级别的视图以提高性能。

```
<%@ Page Language="C#" EnableViewState="false" %> OR <asp:GridView
   EnableViewState="false" runat="server"  /> 
```

2.尝试编写单个查询以获得结果。

[http://forums.asp.net/p/1779601/5120205.aspx/1?p=True&t=634814907594742030](http://forums.asp.net/p/1779601/5120205.aspx/1?p=True&t=634814907594742030)

# python - Google App Engine Python 代码：用户服务

> ID：890857
> 
> 赞同：2
> 
> 时间：2009-05-21T00:12:12.743
> 
> 标签：python, google-app-engine

Google App Engine 文档中的这个示例程序在引用 self 时是什么意思？我在哪里可以查找哪些方法（例如 self.response ...）？

```
from google.appengine.api import users
from google.appengine.ext import webapp
from google.appengine.ext.webapp.util import run_wsgi_app

class MainPage(webapp.RequestHandler):
  def get(self):
    user = users.get_current_user()

    if user:
      self.response.headers['Content-Type'] = 'text/plain'
      self.response.out.write('Hello, ' + user.nickname())
    else:
      self.redirect(users.create_login_url(self.request.uri))

application = webapp.WSGIApplication(
                                     [('/', MainPage)],
                                     debug=True)

def main():
  run_wsgi_app(application)

if __name__ == "__main__":
  main() 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-21T00:21:51.617

`self`指`webapp.RequestHandler`类。这是它的文档：[http://code.google.com/appengine/docs/python/tools/webapp/requesthandlerclass.html](http://code.google.com/appengine/docs/python/tools/webapp/requesthandlerclass.html)，它告诉你什么`response`意思。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-21T00:44:05.767

self 是一个 python 约定，在 Java、C#、C++ 等其他语言中表示“this”……我发现在谈论对象时需要明确引用自己很奇怪（我有 Java 背景），但是你有点习惯了。

如果你打算使用 python，我建议你使用一个可以完成代码并理解 python 语法的编辑器，它会让你在尝试确定给定类或模块可用的函数时更轻松

# java - Java中的文本文件解析

> ID：890862
> 
> 赞同：15
> 
> 时间：2009-05-21T00:13:26.063
> 
> 标签：java, file, parsing

我正在使用`FileInputStream`将文件内容放入字节数组中的文本文件进行读取。然后我使用 new String(byte) 将字节数组转换为字符串。

一旦我有了`String.split("\n")`用于将文件拆分为字符串数组的字符串，然后获取该字符串数组并通过执行 a 解析它`String.split(",")`并将内容保存在 Arraylist 中。

我有一个*200MB*以上的文件，当我用 1GB 内存启动 JVM 时，它的内存不足。我知道我必须在某个地方正确地做某事，我只是不确定我解析的方式是否不正确或我正在使用的数据结构。

解析文件也需要大约 12 秒，这似乎需要很多时间。谁能指出我可能正在做什么导致我的内存不足以及什么可能导致我的程序运行缓慢？

该文件的内容如下所示：

```
"12334", "100", "1.233", "TEST", "TEXT", "1234"
"12334", "100", "1.233", "TEST", "TEXT", "1234"
.
.
.
"12334", "100", "1.233", "TEST", "TEXT", "1234" 
```

谢谢

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-21T00:37:01.850

我不确定它在内存方面的效率如何，但我的第一种方法是使用[Scanner](http://java.sun.com/j2se/1.5.0/docs/api/java/util/Scanner.html)，因为它非常易于使用：

```
File file = new File("/path/to/my/file.txt");
Scanner input = new Scanner(file);

while(input.hasNext()) {
    String nextToken = input.next();
    //or to process line by line
    String nextLine = input.nextLine();
}

input.close(); 
```

检查 API 以了解如何更改用于拆分标记的分隔符。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-21T00:20:06.533

听起来你对我做错了什么 - 一个完整的对象创建正在进行中。

该“测试”文件的代表性如何？你真的在用这些数据做什么？如果这是您真正拥有的典型情况，我会说该数据中有很多重复。

如果无论如何都将在字符串中，请从 BufferedReader 开始读取每一行。将该列表预先分配到接近您需要的大小，这样您就不会每次都浪费资源添加到它。用逗号分割每一行；一定要去掉双引号。

您可能想问自己：“为什么我需要一次将整个文件保存在内存中？” 你能读一点，处理一点，而且永远不会一次把整个事情都记在心里吗？只有你足够了解你的问题才能回答。

如果您有 JDK 6，也许您可​​以启动 jvisualvm 并查看内存情况。那将是一个很好的线索。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2011-10-19T14:15:25.047

看看这些页面。它们包含许多开源 CSV 解析器。[JSaPar](https://github.com/org-tigris-jsapar/jsapar)就是其中之一。

*   [文本文件解析库和项目](https://org-tigris-jsapar.github.io/jsapar/links)
*   [Java 开源库](http://java-source.net/open-source/general-purpose/jsapar)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-21T00:36:52.957

听起来您当前在内存中有整个文件的 3 个副本：字节数组、字符串和行数组。

与其将字节读入字节数组，然后使用它转换为字符`new String()`，不如使用 InputStreamReader，它将逐步转换为字符，而不是全部预先转换。

此外，您应该一次读取一行，而不是使用 String.split("\n") 来获取单独的行。可以使用中的`readLine()`方法`BufferedReader`。

尝试这样的事情：

```
BufferedReader reader = new BufferedReader(new InputStreamReader(fileInputStream, "UTF-8"));
try {
  while (true) {
    String line = reader.readLine();
    if (line == null) break;
    String[] fields = line.split(",");
    // process fields here
  }
} finally {
  reader.close();
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-21T00:36:13.490

如果你有一个 200,000,000 个字符的文件并且每 5 个字符拆分一次，你就有 40,000,000 个`String`对象。假设他们正在与原始 400 MB `String`（`char`即 2 个字节）共享实际字符数据。A`String`说是 32 个字节，因此是 1,280,000,000 个字节的`String`对象。

（可能值得注意的是，这非常依赖于实现。`split`可以使用全新的支持创建完整的字符串，`char[]`或者 OTOH，共享一些通用`String`值。一些 Java 实现不使用切片`char[]`。有些可能使用类似 UTF-8 的紧凑形式并给出非常差的随机访问时间。）

即使假设字符串更长，那也是很多对象。有了这么多数据，您可能希望像原始数据一样以紧凑的形式处理其中的大部分数据（仅使用索引）。仅转换为您需要的对象。实现应该类似于数据库（尽管它们传统上不能有效地处理可变长度字符串）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-05-22T07:57:45.483

在调用/调用您的程序时，您可以使用以下命令： java [-options] className [args...]
代替 [-options] 提供更多内存，例如 -Xmx1024m 或更多。但这只是一种解决方法，你必须改变你的解析机制。

# php - 让 SVG 和 MathML 在 Apache 上为 PHP 工作

> ID：890867
> 
> 赞同：0
> 
> 时间：2009-05-21T00:15:52.813
> 
> 标签：php, xhtml, apache2

我对如何配置我的 Apache 服务器有点困惑。我正在使用 Apache 2.2.11

以这两页为例：

[HTML](http://www.webdevout.net/articles/beware-of-xhtml-examples/2.html) [XHTML](http://www.webdevout.net/articles/beware-of-xhtml-examples/2.xhtml)

它们都是相同的语法，但扩展名不同。第一个文件以 HTML 作为扩展名，第二个文件以 XHTML 作为扩展名。

后台的服务器有以下设置：

```
AddType application/xhtml+xml .xhtml 
```

通过这样做，正确显示 MathML 和 SVG。

现在，无论如何，大多数网站都使用 PHP。我已经在我的 Apache 中设置了这个：

```
AddType application/x-httpd-php .php 
```

标准语法和所有。

但如果我希望我的 PHP 页面也显示 MathML 和 SVG，我想我需要这样做：

```
AddType application/xhtml+xml .php
AddType application/x-httpd-php .php 
```

但这不起作用，PHP 不再解析。

那么，我怎样才能确保 PHP 仍能正常工作，同时我可以结合使用 MathML 和 SVG 之类的东西呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-21T00:40:36.460

如果您的 PHP 脚本输出 HTML 以外的内容，您只需在脚本中设置内容类型 HTTP 标头。

例如，如果您有一个名为 xml.php 的脚本输出 XML，它应该包括如下一行：

```
<?php header('Content-type: application/xhtml+xml'); ?> 
```

不需要 apache 配置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T01:19:10.487

该[`AddType`指令](http://httpd.apache.org/docs/2.2/mod/mod_mime.html#addtype)控制如何*在服务器上*处理 .php 文件。由于相应的[`Action`](http://httpd.apache.org/docs/2.2/mod/mod_actions.html#action)或[`AddHandler`](http://httpd.apache.org/docs/2.2/mod/mod_mime.html#addhandler)指令，该文件被传递到配置为处理 application/x-httpd-php 类型的程序或模块，例如：

```
Action application/x-httpd-php "/php/php-cgi.exe" 
```

（也就是说，除非您提供未经处理的 PHP 源文件本身。不过，我怀疑您是否想这样做。）

保持以前的配置方式。[正如弗兰克的回答](https://stackoverflow.com/questions/890867/making-svg-and-mathml-work-for-php-on-apache/890932#890932)所示，使用该[`header`](http://us3.php.net/manual/en/function.header.php)函数为脚本的输出设置不同的 Content-Type 标头。

# css - CSS 继承

> ID：890872
> 
> 赞同：0
> 
> 时间：2009-05-21T00:19:04.460
> 
> 标签：css

有没有办法完全忽略导入到 html 文件中的标头中的 CSS 文件？

我希望一个页面有自己独立的 CSS，而不是从任何其他 CSS 源继承。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-21T00:49:20.157

您可以在本地样式表中使用 !important 声明来覆盖标准继承。

[http://www.w3.org/TR/CSS2/cascade.html#important-rules](http://www.w3.org/TR/CSS2/cascade.html#important-rules)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-21T01:06:21.713

如果您[将唯一 id 应用于`<body>`自定义页面](http://css-tricks.com/id-your-body-for-greater-css-control-and-specificity/)，则可以轻松地在全局 css 中针对该页面进行声明。实际上，提供不同的 css 文件是没有意义的，因为您的全局/站点 css 无论如何都会被缓存在客户端上。

我个人认为这通常是管理页面特定样式的好习惯。在 php 中，您可以在视图中动态地实现这一点

```
<body id="<?= basename($_SERVER['PHP_SELF'], ".php")?>"> 
```

在 ASP.Net 中，您可以使用以下方法设置 id：

```
System.IO.Path.GetFileNameWithoutExtension(HttpContext.Current.Request.Url.AbsolutePath).ToLower 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-21T00:39:33.653

在此页面中不包含该 CSS 文件不是显而易见的解决方案吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-21T00:25:24.400

您可以使用 JavaScript 删除链接的 CSS 文件，但您只需要在该页面上添加该 JavaScript。

或者，您可以在 body 标记中放置一个 ID，并为该页面定位一组完全不同的 CSS 规则：

标准页面：

```
<body id="standard">

#standard h1 {
   color:blue;
} 
```

另一页：

```
<body id="different">

#different h1 {
   color:red;
} 
```

事先做一点计划是值得的

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-21T00:27:16.910

并不真地。有一些方法可以删除 css（例如：[http](http://www.javascriptkit.com/javatutors/loadjavascriptcss2.shtml) ://www.javascriptkit.com/javatutors/loadjavascriptcss2.shtml ），但它在 IE 中不起作用

在什么情况下你想这样做？您无法控制页面吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-21T00:56:59.877

将您不希望样式化的内容放在 iframe 中，然后页眉仍会出现在页面上，但样式不会被继承。

# linux - 如何在 Linux 上创建一个独立的加密文件？

> ID：890889
> 
> 赞同：2
> 
> 时间：2009-05-21T00:26:48.157
> 
> 标签：linux, encryption, pgp

我最近在 Linux 桌面上经历了这个小菜鸟冒险：

1.  获取包含敏感信息的文本文件
2.  PGP 加密它（例如使用 Seahorse）
3.  把它备份
4.  重新安装操作系统、擦除硬盘驱动器、将计算机放入池中等
5.  从备份中检索加密文件，然后惊恐地发现即使您知道密码也无法解密它，因为您没有备份 ~/.gnupg 存储密钥的位置。

为什么我会为此而堕落？因为我曾经是 Mac 用户，我会创建一个加密的稀疏磁盘映像，将我的文件放入其中，然后卸载。我可以把这个文件到处移动，把它放到任何mac上，挂载，输入密码，然后ta-da！只要我记得密码，一切都很好。

有人知道如何用 Linux 做类似的事情吗？

（我希望这与 SOF 编程足够相关......无论如何，这对我的编程工作很重要！）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-21T00:57:15.973

摘要：当你想这样做时，`--symmetric`在加密时使用该选项。

让我们看看这里真正发生的事情的细节；尝试做正确的事情时，一点点理解通常会有所帮助。

当您使用 GnuPG 加密文件时，它使用“对称”加密。也就是说，它使用一个密钥来加密明文和解密密文。为什么这样做？因为对称算法比公钥/私钥算法（使用单独的密钥来加密和解密）快得多，还有其他原因我们稍后会看到。

它从哪里获得用于加密文件的密钥？它组成了一个随机的。不，我不是在跟你开玩笑。

现在在这一点上，您可能会认为我们有一个小问题。该文件是用随机密钥加密的，没有人（除了那个特定的 GnuPG 进程）知道它是什么。那么接下来会发生什么？

诀窍是：该随机密钥然后用其他密钥加密，并存储在文件中。这就是我们允许多个用户解密文件的方式。例如，我公司的备份是加密的，因此我和我的业务合作伙伴都可以解密它们：GnuPG 使用我的公钥和我的合作伙伴的公钥分别加密文件加密密钥，并将这两者与加密数据一起存储。现在，我可以使用我的私钥解密用我的公钥加密的副本（或者我的伙伴可以对他的副本做同样的事情），检索用于加密数据的对称密钥，然后解密它。

那么做`--symmetric`什么呢？它只是使用对称算法本身加密该随机加密密钥，这次使用基于提供的密码短语的密钥。现在任何知道密码的人也可以解密文件。

这对一个文件来说很好，但是当你有很多文件时，这很快就会变得不方便，用不同的密码加密，以便不同的人可以访问它们，这就是我们通常使用公钥系统的原因之一。

但是，不幸的是，现在您已经学到了非常宝贵的一课：您的私钥很重要！如果您丢失了它，您将无法访问任何人使用您的公钥加密过的任何内容。生成一次，保持安全，并在多个地方备份。

您想要做的是添加`--symmetric`选项以允许仅使用密码来解密文件。

问题是你用你的公钥加密了文件，当你这样做时，你需要你的密钥（存储在 中`~/.gnupg`）来解密它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-03-05T05:38:48.303

Curt Sampson 很好地解释了这些概念。我会提供一些细节。

可悲的是，Seahorse & friends 还没有提供进行对称加密的选项，尽管它可以处理解密对称加密的文件。同时，如前所述，您可以从命令行进行加密，例如

```
gpg --symmetric --force-mdc --cipher-algo aes256 -o outfile infile 
```

如果你对 gpg 很满意但真的想要一个 gui，你可以使用我的[gpg-frontend Pyrite](http://github.com/ryran/pyrite)。它不像海马插件那样与 Nautilus 集成，但如果我可以这么说的话，它仍然很可爱。:)

正如其他人所提到的，eCryptfs 是一个很好的选择，它属于同一个领域，提供每个文件的加密，尽管它以一种更方便的方式进行，基本上为您提供一个文件夹，可以透明地加密/解密所有写入和读取到/从中。起初它看起来像是一个加密的容器解决方案，但实际上它是单独加密文件——一旦你卸载文件夹，你最终会得到一堆单独加密的文件。[LJ](http://www.linuxjournal.com/article/9400)上的这篇文章对 eCryptfs 与其他一些选项进行了很好的比较和对比概述。以下是让 eCryptfs 运行的简单方法：

```
$ mkdir ~/vault
$ sudo mount -t ecryptfs ~/vault ~/vault
Select key type to use for newly created files: 
 1) openssl
 2) passphrase
 3) pkcs11-helper
 4) tspi
Selection: 2
....... (truncated)
$ echo hello > ~/vault/encfile
$ sudo umount ~/vault
$ ls -a ~/vault
.  ..  encfile
$ cat ~/vault/encfile
稖��)!x�"3DUfw`��ȿ_���E�����_CONSOLE�W�v0�+�'�hV���Q��VZ��eP�����l⟮j%����?O��V
....... (truncated) 
```

如果您对此感兴趣，还可以查看该**`ecryptfs-setup-private`**命令，该命令消除了对 sudo 的需求并允许一切自动化。继续。

*其他*最好的选择是 pts 提到的：[TrueCrypt](http://www.truecrypt.org)（跨平台）和[dm-crypt](http://en.wikipedia.org/wiki/Dm-crypt)，它允许你加密*任何*块设备（例如分区、逻辑卷、单个文件），然后当然你会抛出一个fs 最重要的是。不要使用 Cryptoloop（dm-crypt 的前身）。

我大多只有 Red Hat、Fedora 和朋友的经验，但在那些你可以使用可爱的磁盘管理 gui**`palimpset`**来创建和修改加密磁盘/分区，而无需安装任何额外的东西。当然有一个命令行工具：**`cryptsetup`**...这里有一个简单的例子，让您了解 dm-crypt 的可能性，使用 cryptsetup 从可扩展的逻辑卷中创建加密文件系统：

```
lvcreate -L 2G -n mybox volgroup
cryptsetup luksFormat /dev/volgroup/mybox
cryptsetup luksOpen /dev/volgroup/mybox mybox
mkfs.ext4 /dev/mapper/mybox
cryptsetup luksClose mybox 
```

完成此操作后，Nautilus 应该可以毫无问题地自动检测它，然后您可以解锁它并从那里进行安全的用户安装。

***编辑：*** *我觉得很傻。当我遇到这个问题时，我正在浏览 gpg 标签。直到我完成输入所有内容并即将提交时，我才注意到这是多大年纪。那好吧。也许它会为后代派上用场。*

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-21T00:37:51.037

[TrueCrypt](http://www.truecrypt.org/)是一种用户友好的磁盘加密解决方案，适用于 Linux（以及其他系统）。

仅限 Linux 的较低级别的解决方案是 dm-crypt 和 crpytoloop。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-21T00:39:48.863

我使用 ccrypt，它在 Cygwin 中也可用。

> ```
>  ccrypt is a utility for encrypting and decrypting files and streams. It
>    was designed to replace the standard unix crypt utility, which is noto‐
>    rious  for  using a very weak encryption algorithm.  ccrypt is based on
>    the Rijndael block cipher, which was also chosen by the U.S. government
>    as      the      Advanced     Encryption     Standard     (AES,     see
>    http://www.nist.gov/aes/). This cipher  is  believed  to  provide  very
>    strong cryptographic security. 
> ```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-21T00:50:51.930

我用过mcrypt。它支持几种现代加密算法，并且在 linux 机器上很常见（或者至少在大多数 distors 上很容易获得预编译包）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-21T01:25:55.340

ecryptfs 易于设置和使用。

*   好处：您不提前预订空间；它作为文件系统之上的一层

*   缺点：文件名未加密。显然，您可以通过压缩或压缩整个树并让 ecryptfs 加密 zip 或 tar 文件来解决此问题，但这很麻烦。

    **更新**截至 2012 年 3 月，这个问题已经解决（并且已经解决了一段时间）：ecryptfs 加密文件名。我无法轻松找到引入此功能的版本号或日期。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-07-30T07:54:12.403

您还可以使用[openssl](http://www.madboa.com/geek/openssl/#encrypt-simple)加密文件。

# .net - Windows 7 中的调试程序选项

> ID：890890
> 
> 赞同：5
> 
> 时间：2009-05-21T00:27:09.403
> 
> 标签：.net, windows-7

我注意到，在 Windows 7 中，与 XP 不同，如果我在 Visual Studio 2008 中调试的程序崩溃，我将无法选择调试程序。相反，它只是说程序崩溃了，微软正在寻找解决方案。

现在，如果我的程序抛出异常，我无法返回到 VS 2008 中的调试会话，程序就退出了。有没有解决的办法？

编辑：这是旧的调试窗口在 XP 中的样子，但我无法在 Win7 中得到它，现在也无法调试我的程序：

[![调试窗口](https://i.stack.imgur.com/Xv58F.jpg)](https://i.stack.imgur.com/Xv58F.jpg)
[（来源：[scalemax.com](http://www.scalemax.com/tlsupport/Crash_files/image006.jpg)）]

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-21T00:48:14.073

我看到如果您单击将错误发送到 MS，它最终会为您提供一个 Debug 选项。

此外，如果您进入控制面板->操作中心->更改操作中心设置->问题报告设置并将单选选项更改为“每次出现问题时，请在检查解决方案之前询问我”，您会立即获得调试选项.

我注意到的一个大问题是它不会使用已经附加的调试器进行调试。它使您在 VS 2008 中创建一个新的调试器实例，然后抱怨已经附加了一个调试器......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T00:41:40.110

我没有安装 Windows 7，所以我不能说是否有其他机制在工作，但显而易见的答案是检查 VS 中是否打开了即时调试（工具/选项/调试/Just In时间）。

# c++ - 找出命令是否存在的便携式方法 (C/C++)

> ID：890894
> 
> 赞同：12
> 
> 时间：2009-05-21T00:27:54.630
> 
> 标签：c++, system, popen

C标准库提供函数`system`和`popen`运行命令。但是有没有一种可移植的方法来检测命令是否存在？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2016-10-21T17:43:45.980

对于 POSIX 系统，我发现它工作得很好（在这个例子中我正在检查 avconv）：

```
if (system("which avconv > /dev/null 2>&1")) {
    // Command doesn't exist...
} else {
    // Command does exist, do something with it...
} 
```

重定向到 /dev/null 只是为了避免将任何内容打印到标准输出。它仅依赖于 which 命令的退出值。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-21T00:30:25.873

不，没有任何标准的 C 函数。

仅 Unix 的解决方案是拆分（冒号），并尝试在目录中找到可执行的命令（带有`getenv("PATH")`函数）。`:``stat`

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-21T01:04:18.987

虽然我认为没有一种完全可移植的方式来做到这一点（有些系统甚至不支持命令解释器），`system()`但如果在运行命令时没有错误，则返回 0。我想您可以尝试运行您的命令，然后检查 system.return 的返回值。

要检查命令解释器是否可用，请调用`system( NULL )`并检查非零值。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2014-04-01T13:10:10.543

这是一种扫描存储在`PATH`变量中的所有路径，扫描`mathsat`可执行文件的方法：

```
#include <stdlib.h>
#include <sys/stat.h>
#include <sys/types.h>
#include <unistd.h>

#include <string>
#include <iostream>

using namespace std;

int main ()
{
  struct stat sb;
  string delimiter = ":";
  string path = string(getenv("PATH"));
  size_t start_pos = 0, end_pos = 0;

  while ((end_pos = path.find(':', start_pos)) != string::npos)
    {
      string current_path =
        path.substr(start_pos, end_pos - start_pos) + "/mathsat";

      if ((stat(mathsat_path.c_str(), &sb) == 0) && (sb.st_mode & S_IXOTH))
        {
          cout << "Okay" << endl;
          return EXIT_SUCCESS;
         }

      start_pos = end_pos + 1;
     }

  return EXIT_SUCCESS;
} 
```

# c++ - 将 escaped_list_separator 与 boost split 一起使用

> ID：890895
> 
> 赞同：4
> 
> 时间：2009-05-21T00:28:08.590
> 
> 标签：c++, boost, split, tokenize

我正在使用 boost 字符串库，并且刚刚遇到了 split 方法的简单性。

```
 string delimiters = ",";
  string str = "string, with, comma, delimited, tokens, \"and delimiters, inside a quote\"";
  // If we didn't care about delimiter characters within a quoted section we could us
  vector<string> tokens;  
  boost::split(tokens, str, boost::is_any_of(delimiters));
  // gives the wrong result: tokens = {"string", " with", " comma", " delimited", " tokens", "\"and delimiters", " inside a quote\""} 
```

这会很好而且简洁......但是它似乎不适用于引号，而是我必须做类似以下的事情

```
string delimiters = ",";
string str = "string, with, comma, delimited, tokens, \"and delimiters, inside a quote\"";
vector<string> tokens; 
escaped_list_separator<char> separator("\\",delimiters, "\"");
typedef tokenizer<escaped_list_separator<char> > Tokeniser;
Tokeniser t(str, separator);
for (Tokeniser::iterator it = t.begin(); it != t.end(); ++it)
    tokens.push_back(*it);
// gives the correct result: tokens = {"string", " with", " comma", " delimited", " tokens", "\"and delimiters, inside a quote\""} 
```

我的问题是，当您引用分隔符时，可以使用拆分或其他标准算法吗？多亏了purpledog，但我已经有了一种不被弃用的方法来实现预期的结果，我只是认为它很麻烦，除非我可以用更简单更优雅的解决方案替换它，否则我一般不会在不先将其包装的情况下使用它另一种方法。

编辑：更新代码以显示结果并澄清问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-28T22:13:40.533

使用 boost::split 方法似乎没有任何简单的方法可以做到这一点。我能找到的最短的代码是

```
vector<string> tokens; 
tokenizer<escaped_list_separator<char> > t(str, escaped_list_separator<char>("\\", ",", "\""));
BOOST_FOREACH(string s, escTokeniser)
    tokens.push_back(s); 
```

这仅比原始片段稍微详细一点

```
vector<string> tokens;  
boost::split(tokens, str, boost::is_any_of(",")); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-19T14:30:14.970

这将达到与 Jamie Cook 没有显式循环的答案相同的结果。

```
tokenizer<escaped_list_separator<char> >tok(str);
vector<string> tokens( tok.begin(), tok.end() ); 
```

标记器构造函数的第二个参数默认为，`escaped_list_separator<char>("\\", ",", "\"")`因此没有必要。除非您对逗号或引号有不同的要求。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-21T13:38:04.653

我不知道 boost::string 库，但使用 boost regex_token_iterator 您将能够用正则表达式表达分隔符。所以是的，您可以使用带引号的分隔符，也可以使用更复杂的东西。

请注意，这曾经是使用 regex_split 完成的，现在已弃用。

这是从 boost doc 中获取的示例：

```
#include <iostream>
#include <boost/regex.hpp>

using namespace std;

int main(int argc)
{
   string s;
   do{
      if(argc == 1)
      {
         cout << "Enter text to split (or \"quit\" to exit): ";
         getline(cin, s);
         if(s == "quit") break;
      }
      else
         s = "This is a string of tokens";

      boost::regex re("\\s+");
      boost::sregex_token_iterator i(s.begin(), s.end(), re, -1);
      boost::sregex_token_iterator j;

      unsigned count = 0;
      while(i != j)
      {
         cout << *i++ << endl;
         count++;
      }
      cout << "There were " << count << " tokens found." << endl;

   }while(argc == 1);
   return 0;
} 
```

如果程序以**hello world**作为参数启动，则输出为：

```
hello
world
There were 2 tokens found. 
```

改变*boost::regex re("\s+");* 进入*boost::regex re("\",\"");* 会拆分带引号的分隔符。**以hello","world**作为参数启动程序也会导致：

```
hello
world
There were 2 tokens found. 
```

但我怀疑你想处理这样的事情：**"hello", "world"**，在这种情况下，一种解决方案是：

1.  仅昏迷分裂
2.  然后删除“”（可能使用 boost/algorithm/string/trim.hpp 或正则表达式库）。

编辑：添加程序输出

# c# - 如何在不等待事件侦听器运行的情况下触发事件？

> ID：890896
> 
> 赞同：3
> 
> 时间：2009-05-21T00:28:34.020
> 
> 标签：c#, events, messages

我对 .NET (C#) 中的事件有疑问。我不得不为几种情况编写代码，其中我有一个后台任务正在运行并且我想通知主线程或控制器类发生了某些事情，例如任务完成或完成复制文件，但我没有不希望后台任务等待主线程的委托处理事件。

我想做一些类似消息传递的事情：发送消息，但谁在乎他们用它做什么。

**例如：**

编写一个类来依次处理多个进程，一个接一个。每个进程都需要在后台线程上运行。工作完成后，会触发一个事件并告诉控制器它已完成（假设使用 OnCompleted() 方法）

问题在于，如果控制器的事件处理程序用于启动后续进程，则先前进程的 OnComplete 方法会一直停留在调用堆栈上（永远不会完成执行），直到所有进程都完成为止。

在那种情况下，后台任务如何在不将事件引发方法保留在堆栈上的情况下通知控制器类工作已完成？

**示例 2：**备份程序。

后台线程运行以将每个文件复制到目标。后台需要*通知*UI 上次复制的文件，但不需要等待 UI 更新。相反，它只想说，“顺便说一句，这里有一些信息。现在，让我回去工作。” 事件侦听器不应阻止事件引发器的处理。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-21T00:36:30.447

听起来您正在尝试异步调用事件调用列表中的委托。

我建议您阅读[.NET Asynchronous Events To Send Process Status To User Interface](http://www.eggheadcafe.com/articles/asynchronous_events.asp)：

> .NET Framework 为我们提供了在我们的类中异步引发事件（和其他项）的概念。这意味着我们可以以不让该事件的订阅者（通常是用户界面）阻止引发事件的方法中的处理的方式引发事件。好处是它不会对我们的业务层方法的性能产生负面影响。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-21T01:01:42.690

您可以在引发事件时执行异步调用（如前所述），或者只是在后台线程上引发事件本身：

```
void OnUpdated(EventArgs e) {
   EventHandler h = this.Updated;
   if (h != null) h(e);
}

void DoStuff() {
   BigMethod();
   ThreadPool.QueueUserWorkItem(OnUpdated, EventArgs.Empty);
   BigMethod2();
} 
```

如果您异步引发，多个侦听器将同时处理您的事件。至少，这需要一个线程安全的 EventArg 类。如果您希望它们也与您的类交互，那么您应该非常仔细地记录或使其成为线程安全的。

在后台线程上引发事件对您的类方法具有相同的警告，但您不必担心 EventArgs 类本身。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-21T00:32:32.077

让第一个事件除了启动线程之外什么都不做，那么有什么其他事件侦听器就无关紧要了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-21T08:13:47.960

对于您的备份程序案例2。代码示例将异步触发文件副本，一旦复制完成，它就会调用回调方法。在回调中如果你不想等待 UI 更新，那么你将不得不异步调用 UI 更新代码

您可以使用异步委托

```
public class AsyncFileCopier
    {
        public delegate void FileCopyDelegate(string sourceFile, string destFile);

        public static void AsynFileCopy(string sourceFile, string destFile)
        {
            FileCopyDelegate del = new FileCopyDelegate(FileCopy);
            IAsyncResult result = del.BeginInvoke(sourceFile, destFile, CallBackAfterFileCopied, null);
        }

        public static void FileCopy(string sourceFile, string destFile)
        { 
            // Code to copy the file
        }

        public static void CallBackAfterFileCopied(IAsyncResult result)
        {
            // Notify UI by calling an async del (probably using fire & forget approach or another callback if desired)
        }
    } 
```

您可以将其称为：

```
AsyncFileCopier.AsynFileCopy("abc.txt", "xyz.txt"); 
```

这个[链接](http://msdn.microsoft.com/en-us/library/2e08f6yc.aspx)告诉你异步编码的不同技术

# sql-server - 使用sharepoint表单认证用户登录远程sql server

> ID：890897
> 
> 赞同：0
> 
> 时间：2009-05-21T00:28:48.793
> 
> 标签：sql-server, sharepoint, forms-authentication

我正在处理的 Sharepoint 设置如下： - forms-authentication sharepoint server - 用户数据库存储在远程 sql 服务器上 - 我们有一个自定义的 asp .net 应用程序放在 sharepoint 的尖端，它是从 __layouts_ 运行的文件夹; 应用程序从远程 sql 服务器获取其所有内容（与 WSS_Content 无关）

基本上，用户数据库仅用于站点级别的权限。但是在连接到我的远程 sql 服务器时，我需要使用已用于登录 sharepoint Web 应用程序的相同用户凭据。

有没有办法将当前的共享点用户凭据作为 sql server 身份验证登录传递？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-21T00:34:34.413

一种方法是编写您的身份验证提供程序，它与 SQL 数据库身份验证提供程序基本上做同样的事情。在您的自定义身份验证提供程序中，您应该捕获用户登录信息，然后存储到 Web 服务器会话。然后，您可以从会话访问它以进行 sql server 身份验证。

对我来说感觉有点hacky，但它应该工作。

# git - 将更新推送到修剪后的 Mercurial 分支

> ID：890900
> 
> 赞同：1
> 
> 时间：2009-05-21T00:29:59.087
> 
> 标签：git, mercurial, merge, branch, dvcs

我有两个相关的存储库，一个主存储库，其中包含许多不得泄露的敏感文件，以及一个“公共”版本，使用 hg convert 和 --filemap 创建以排除敏感文件和目录。

我希望对不影响敏感文件的主机进行进一步更新，使其可推送到从机，并更新从机以供主机拉取。现在这不会发生，因为它们被认为是“不相关”的存储库

如果这在 Git 上可行，但在 Mercurial 上不行，那么迁移是可能的，尽管这会很麻烦，因为某些开发发生在 Windows 机器上。从站尚未看到活跃的外部使用，因此可以在必要时对其进行核攻击并以另一种方式重新创建它。如果绝对有必要，甚至可以完全转储主服务器并从从服务器重新克隆，然后将所有敏感部分完全不版本化，但我非常希望不必这样做，因为其中一些文件*正在*发生变化，我想跟踪这些变化。

有没有人有什么好主意？

**更新：**我一直在查看 Git 上的文档——可以使用 Git 暂存区轻松实现“推送除这些文件之外的所有文件”命令吗？

**更新 2：**这对我没有帮助，但它可能对有类似问题的人有所帮助：您可以`hg convert --filemap`重复使用，它只会跟踪对 master 的更新，但这*仅*适用于目标存储库是通过文件系统编写的，并且赢了不要在电线上工作。当然，它也无助于相反的方向。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T22:59:58.540

我想我需要比评论框给我更多的空间... :-)

让我试着解释一下我所说的内部存储库是什么意思。我们有两个正常的、独立的存储库：“slave”和“master”。您将所有公共文件放在“从”中，并将秘密文件放在“主”中：

```
master/
  secret-file.txt
  another-secret.txt
  more-secrets.jpeg

slave-clone/
  public.png
  more-public.txt 
```

然后通过制作新的克隆来组合它们：

```
% hg clone master master-clone
% cd master-clone
% hg clone ../slave slave-clone 
```

您现在在“master”的克隆中拥有一个“slave”的克隆：

```
master-clone/
  secret-file.txt
  another-secret.txt
  slave-clone/
    public.png
    more-public.txt
  more-secrets.jpeg 
```

在此存储库中，您将看到所有 Mercurial 命令都忽略了“slave-clone”，除非您将目录更改为它。所以你可以做

```
% echo 'evil plans' > plans.txt
% hg add plans.txt
% hg commit -m 'Secret stuff' 
```

因此，您将在外部存储库上进行提交。要编辑一些公开的东西，你输入“slave-clone”并在那里提交，就像平常一样。

您可以像往常一样在“从属”克隆和“主”克隆之间拉/推，因为它们是……嗯……只是普通克隆。您说项目不是秘密/公共文件不应被视为嵌套项目，但我建议您进行此区分以便将它们分成两个目录。

请注意，我假设您可以将所有公共文件限制在秘密文件的子目录中。如果您将 'slave-clone' 重命名为 'public' 或 'announcements' 或类似名称，我认为这听起来不太牵强 :-)

否则，您可能可以使用一堆符号链接来做一些事情，以便通过将文件符号链接到单个目录中来“加入”存储库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T00:55:34.167

最简单的解决方案可能是简单地将“奴隶”的克隆放在“主人”中。内部克隆将被外部克隆忽略——因此，当您提交对秘密文件的更改时，您不会冒险将它们与公共文件混合。推拉会像平常一样工作，你必须做两次，一次用于内部，一次用于外部。

或者，您可以强行将“奴隶”拉入“主人”。这将创建一个具有两个根修订版的存储库，但这不是问题。合并后，您将拥有一个混合存储库。然后可以从“从属”中提取新的变更集，而不会发出进一步的警告，因为这两个存储库已经相关。

如果您更改混合存储库中的公共文件，您必须首先确保您已更新到来自“从”存储库的变更集。否则，您将无法提交并将新的变更集设置为“从属”。因此，如果您在 [s3]：

```
... [s1] --- [s2] ---[s3]
            /
... [p1] --/ 
```

并且您想更新公共文件，您需要先更新到 [p1]：

```
% hg update p1 
```

然后编辑并提交

```
% hg commit -m 'Public change'
(created new head) 
```

您的历史图表现在将如下所示：

```
... [s1] --- [s2] ---[s3]
            /
... [p1] --/-[p2] 
```

你会想把 [p2] 推到“奴隶”：

```
% hg push p2 
```

并将其与 [s3] 合并：

```
% hg merge 
```

之后你会得到

```
... [s1] --- [s2] ---[s3] --- [s4]
            /                /
... [p1] --/-[p2] ----------/ 
```

其他解决方案可以在 Mercurial wiki 上的 NestedRepositories 页面底部找到。我相信 Mercurial 1.3 的 subrepo 扩展正在开发中，但我们必须拭目以待（发布日期是 7 月 1 日）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-24T17:43:09.327

好的，看起来真正的答案是，“Mercurial 不能做你想做的事”（即在存储库和作为该存储库的严格子集的分支之间进行同步），而不是使用一些非常不方便的系统，例如补丁队列。Git 可能有，但由于它的 Windows 端口还没有准备好用于生产，所以我并没有那么认真地研究它。

然而，事实证明有可能以这样一种方式重组项目，即可以将公共部分和私有部分分成单独的存储库，而历史损失相对较小。（实际上，当我们使用它时，它被分成了三种方式——公共部分，一个公共但特定于机器的部分，我们放在子目录中`local/`（因此它可以克隆到具有几乎相同规格的大部分机器上，而无需必须在几个奇怪的分支上维护和合并额外的分支），以及我们放在子目录中的私有部分`private/`。）结果证明，这个技巧不是试图将一个干净的从属放在主控中，而是将私有/本地部分分开从 master 并将它们作为（伪）sub-repositories 放在 master 机器上的 slave 存储库中。

第 1 阶段是将文件移动到`private/`和`local/`目录，从主存储库中删除它们，并在替换符号链接在其他机器上出现问题时根据需要将它们添加到 .hgignore。值得庆幸的是，我们必须以这种方式移动的大约 95% 的东西对位置不敏感，其余的我们可以手动管理。这两个目录然后成为他们自己的存储库。

第 2 阶段我们基本上已经完成：`hg convert`用于`--filemap`创建存储库的公共版本，其中所有私有数据的痕迹都已被删除。（这实际上需要一些文件映射调整：您不仅必须排除所有当前的私有数据文件名，还必须排除它们过去可能拥有的任何文件名。Mercurial 跟踪文件移动/重命名的能力似乎并不完全强大.)

此时，`.hg/`master 上的目录被移动到一个备份位置，并且从干净的公共存储库中重新提取。然后，我们运行测试以确保一切正常，并开始将新的基础存储库和选定的`local`存储库克隆到从机，并对其进行测试，一切似乎都很好，尽管我们不得不调整一些符号链接停止工作的地方（主要是在 Windows 机器上，但奇怪的是，在 Linux 方面，我将不得不深入研究为什么在我有空闲时间时没有遵循符号链接，尽管我们在解决问题时解决了这个问题发现一个特定的文件可以并且确实应该自动重新生成）。

# encryption - 创建一个小（<10 位）而不是（非常）安全的“哈希”的想法

> ID：890907
> 
> 赞同：16
> 
> 时间：2009-05-21T00:33:48.720
> 
> 标签：encryption, hash, checksum, encode

我正在开发一个在线活动票务系统，用户将能够自行打印他的门票并出现在将被扫描（条形码）的活动中，理想情况下该人将进入。我的问题是如何创建一个满足以下要求的“机票代码”：

*   每个“票号”需要彼此充分不同（即不按顺序编号）
*   理想情况下，票证将根据中央数据库进行检查以防止重用，但它也需要能够离线工作，在这种情况下，系统必须检查“有效”票证代码并且它尚未用于*此*门。
*   “票证代码”必须足够小，以便在需要时方便键入
*   持票人只需要门票即可进入（即无需身份检查）

数据的范围非常小，4 天内只有大约 20 个活动，每个活动大约 5,000 张门票（大约 100,000 个不同的门票代码）

现在我有几个字段没有打印在票上并且用户不知道我可以用来编码部分“票代码”，所以我可以使用 EventId、OrderId、EventDate 和一些盐来创建一个小的“ hash" 用于部分代码（想法？），但我仍然坚持使用顺序的票证 ID 或 GUID（会太长）

那么关于如何做到这一点的任何想法或指示？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-21T03:16:10.390

为什么要重新发明轮子？做这样的事情（Python代码，问我是否需要澄清）：

```
import hashlib

secretpassword = "blah"

def createticket(eventnum, ticketnum):
    m = hashlib.md5() # or any crypto hash you like
    m.update("%s%s%s" % (eventnum, ticketnum, secretpassword))
    return m.hexdigest()[:10] 
```

例子：

事件编号 1

票号 123

```
createticket(1,123)
# output: 2d7f242597 
```

售票员先生带着他的验证者出现并输入事件/票号和哈希：

```
def verifier(eventnum, ticketnum, hash):
    return hash == createticket(eventnum, ticketnum)

verifier(1,123, "2d7f242597")
# ouput: True 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-21T00:35:35.177

我建议你试试[Verhoeff 算法](http://en.wikipedia.org/wiki/Verhoeff_algorithm)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-21T00:37:16.547

我可以看到两种方式：

1.  生成一个随机数，或者至少是一个数字的随机部分，并将其存储在中央数据库中。然后将数据库下载到所有门禁系统中进行检查。
2.  数量必须自给自足。换句话说，该号码必须能够在没有保存列表的情况下签出。这听起来像是某种校验和系统。例如，您可以发出 1 及以上的数字，将它们设为 5 位数字（00000-99999 = 100.000 个数字），并在前面加上 1-3 个字母，以确保您最终得到一个可以检查的校验和。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-21T01:27:49.657

考虑一个基于 Feistel 网络的非常简单的方案来置换票证 ID 号。[这条消息](http://archives.postgresql.org/pgsql-general/2009-05/msg00082.php)（恰好在 PostgreSQL 列表中，但与 PostgreSQL 没有太大关系）描述了一个简单的[Feistel 网络](http://en.wikipedia.org/wiki/Feistel_network)。在每张票上，您可以打印一个票号（按顺序选择），然后是一个“票号密码”，这是通过 Feistel 网络输入 ID 号的结果。可能的变化包括在密码上附加一个校验位，以及将 Feistel 网络的输入不仅仅基于顺序生成的数字（数字 + 10,000 * 事件 ID 号等）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-21T01:14:40.247

对于离线验证，我只看到一个简单的解决方案..

将票证 ID 的哈希值和每个事件的盐附加到票证 ID。您可以将任何加密哈希截断为所需的大小。除了基本票证 ID 本身的随机数之外，我想不出有什么特别的理由。

这允许您限制票证 ID 的大小，并具有与票证 ID 大小相关的明确比例的安全性。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-21T02:19:41.953

你可以做一个CRC计算。

基本上，只需开始在字符串中添加每个字符，并将长度限制为长整数。

您可以从一个已知的随机数开始并将其存储在前 4 个字节中，并让后四个作为我之前描述的计算。

这将是两个整数或八个字节。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-21T02:48:21.087

这是一个方案，它的优点是可以让您从上一个票证哈希计算下一个（因此您可以验证是否缺少一个），但不允许外人计算下一个票证：

```
Ticket.0 = substring(HASH(SALT + IV        ), 0, LENGTH)
Ticket.i = substring(HASH(SALT + Ticket.i-1), 0, LENGTH) 
```

在哪里

*   `HASH`是在输出字符串中相对均匀分布其熵的任何散列函数
*   `SALT`是一个你保守秘密的常数；为每个事件使用不同的事件是个好主意
*   `IV`是另一个你保密的常数
*   LENGTH 是您想要的票证 ID 的长度（您的问题中有 10 个，但 12 不是不可能的，它给您的票证 ID 是 256 倍）

# python - 如何通过“manage.py shell”使用交互式解释器重新加载 Django 模型模块？

> ID：890924
> 
> 赞同：53
> 
> 时间：2009-05-21T00:38:16.683
> 
> 标签：python, django

我知道如何在常规 Python 解释器会话中重新加载常规 Python 模块。这个问题记录了如何很好地做到这一点：

[如何卸载（重新加载）Python 模块？](https://stackoverflow.com/questions/437589/how-do-i-unload-reload-a-python-module)

出于某种原因，我在 Django 的“manage.py shell”解释器会话中遇到了麻烦。要重新创建我的问题，请开始在此处找到的基本 Django 教程：

[编写你的第一个 Django 应用程序，第 1 部分](http://docs.djangoproject.com/en/dev/intro/tutorial01/)

创建“polls”应用程序和“Poll”类后，通过“manage.py shell”启动解释器并将“polls”应用程序导入其中。

```
import polls.models as pm 
```

创建一个新的“投票”对象：

```
p = pm.Poll() 
```

到目前为止一切都很好。现在回到您的源并添加任意方法或属性。例如，我添加了：

```
def x(self):
    return 2+2 
```

现在回到解释器并“重新加载”模块：

```
reload(pm) 
```

现在尝试使用您的新方法或属性：

```
p1 = pm.Poll()
p1.x() 
```

您将收到以下消息：

```
'Poll' object has no attribute 'x' 
```

是什么赋予了？我还尝试重新运行导入命令，使用不同的语法导入模块，删除对任何“轮询”对象或“轮询”类的所有引用。我也用 IPython 解释器和普通的 Python (v2.6) 解释器尝试过这个。似乎没有任何效果。

在常规解释器会话中对任意 Python 模块使用相同的技术非常有效。我似乎无法让它在 Django 的“shell”会话中工作。

顺便说一句，如果有什么不同的话，我是在 Ubuntu 9.04 机器上做的。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-05-24T14:59:27.480

好吧，我想我必须回答这个问题。问题是 Django 将其模型缓存在一个称为 AppCache 的单例（类似单例的结构）中。基本上，要重新加载 Django 模型，您需要首先重新加载并重新导入存储在 AppCache 中的所有模型模块。然后你需要清除 AppCache。这是它的代码：

```
import os
from django.db.models.loading import AppCache
cache = AppCache()

curdir = os.getcwd()

for app in cache.get_apps():
    f = app.__file__
    if f.startswith(curdir) and f.endswith('.pyc'):
        os.remove(f)
    __import__(app.__name__)
    reload(app)

from django.utils.datastructures import SortedDict
cache.app_store = SortedDict()
cache.app_models = SortedDict()
cache.app_errors = {}
cache.handled = {}
cache.loaded = False 
```

我将所有这些都放在了一个名为 reloadmodels.py 的单独文件中，该文件位于我的 Django 站点的根目录中。使用 IPython，我可以通过运行重新加载所有内容：

```
%run ~/mysite/reloadmodels.py 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2016-11-16T12:39:31.100

**我在 2016 年的解决方案（将来可能会更改）**

1.安装django_extension

2.添加下一个设置：

```
SHELL_PLUS = 'ipython'

IPYTHON_ARGUMENTS = [
    '--ext', 'autoreload',
] 
```

3.运行外壳

```
./manage.py shell_plus 
```

## **查看结果：**

**模型示例**

```
class Notification(models.Model):

    ........

    @classmethod
    def get_something(self):

        return 'I am programmer' 
```

壳内

```
In [1]: Notification.get_something()
Out[1]: 'I am programmer' 
```

对模型进行了更改

```
@classmethod
    def get_something(self):

        return 'I am Python programmer' 
```

壳内

```
# shell does not display changes
In [2]: Notification.get_something()
Out[2]: 'I am programmer' 
```

在壳中。这是一个魔术

```
# configure extension of ipython
In [3]: %autoreload 2 
```

壳内

```
# try again - all worked
In [4]: Notification.get_something()
Out[4]: 'I am Python programmer' 
```

再次进行了更改

```
 @classmethod
    def get_something(self):

        return 'I am full-stack Python programmer' 
```

壳内

```
# all worked again
In [5]: Notification.get_something()
Out[5]: 'I am full-stack Python programmer' 
```

缺点：1.需要手动运行代码

> %自动重载 2

由于 django_extension 1.7 不支持运行任意代码。可能在将来的版本中它具有此功能。

笔记：

1.  姜戈 1.10
2.  蟒蛇 3.4
3.  django_extension 1.7.4
4.  基于（主要）[https://django-extensions.readthedocs.io/en/latest/shell_plus.html](https://django-extensions.readthedocs.io/en/latest/shell_plus.html)和[http://ipython.readthedocs.io/en/stable/config/extensions/autoreload.html](http://ipython.readthedocs.io/en/stable/config/extensions/autoreload.html)
5.  警告。如果您尝试更改使用 super() 的代码，则可能会产生错误。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-12-11T07:58:12.087

您还可以通过以下命令使用 django-extensions 项目：

```
manage.py shell_plus --notebook 
```

这将在您的 Web 浏览器上打开一个 IPython 笔记本，而不是 IPython shell 解释器。在那里写你的代码，然后运行它。

更改模块时，只需单击网页菜单项“内核->重新启动”

重新运行代码现在使用您修改的模块。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-10-16T16:57:11.437

假设您的项目是这样设置的

*   项目名称：书店
*   应用名称：架子
*   型号名称：书籍

第一次加载

```
from bookstore.shelf.models import Books 
```

随后的重新加载

```
import bookstore;reload(bookstore.shelf.models);from bookstore.shelf.models import Books 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2010-08-12T10:07:35.247

就我而言，上述解决方案都没有单独工作，[这个](https://stackoverflow.com/questions/2677649/how-to-reload-django-models-without-losing-my-locals-in-an-interactive-session)线程本身也没有太大帮助，但在结合这些方法后，我设法在[shell_plus](http://code.google.com/p/django-command-extensions/wiki/CommandExtensions)中重新加载我的模型：

1.  更改模型 (MyModel)
2.  消除`models.pyc`
3.  清理 Django 模型缓存（如[这里](https://stackoverflow.com/questions/890924/how-do-you-reload-a-django-model-module-using-the-interactive-interpreter-via-ma/903943#903943)）：

    ```
     from django.db.models.loading import AppCache
     cache = AppCache()
     from django.utils.datastructures import SortedDict
     cache.app_store = SortedDict()
     cache.app_models = SortedDict()
     cache.app_errors = {}
     cache.handled = {}
     cache.loaded = False 
    ```

4.  [像这里](https://stackoverflow.com/questions/890924/how-do-you-reload-a-django-model-module-using-the-interactive-interpreter-via-ma/1579190#1579190)一样重新加载模型

    ```
    reload(project.app.models)
    from project.app.models import MyModel 
    ```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-21T07:48:41.707

[ipython 控制台](http://ipython.scipy.org/)对每个表达式进行[深度重新加载；](http://ipython.scipy.org/doc/manual/html/api/generated/IPython.deep_reload.html)`reload()`当然还添加了很多其他有用的东西。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2017-10-01T10:45:30.127

来自[Seti Volkylany](https://stackoverflow.com/a/40632417/3154274)和[pv的回答](https://stackoverflow.com/a/5399339/3154274)

1.  安装 IPython：`pip install ipython`
2.  运行`python manage.py shell`：行首的符号现在应该是 `In [1]:`（在 cmd 中是`>>>`）
3.  跑`ipython profile create`
4.  进入`~/.ipython/profile_default/ipython_config.py`并在文本编辑器中打开它并在末尾添加这两行：

    c.InteractiveShellApp.extensions = ['autoreload']
    c.InteractiveShellApp.exec_lines = ['%autoreload 2']

您现在可以运行`python manage.py shell`、编辑您的模型而无需编写`%autoreload 2`

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-10-07T14:10:07.763

在导入任何代码之前启用 IPython 自动重载扩展：

```
%load_ext autoreload
%autoreload 2 
```

我将它与常规 django shell 一起使用，它运行良好，尽管它确实有一些限制：

***注意事项：**

以可靠的方式重新加载 Python 模块通常很困难，并且可能会发生意想不到的事情。%autoreload 试图通过用新版本替换模块中以前的功能代码对象和类的部分来解决常见的缺陷。这使得以下事情起作用：

*   通过 'from xxx import foo' 导入的函数和类会在重新加载 'xxx' 时升级到新版本。
*   类的方法和属性在重新加载时升级，因此在重新加载之前创建的对象“c”上调用“c.foo()”会导致执行“foo”的新代码。

一些已知的剩余警告是：

*   替换代码对象并不总是成功：将类中的@property 更改为普通方法或将方法更改为成员变量可能会导致问题（但仅限于旧对象）。
*   在重新加载之前从模块中删除的功能（例如通过猴子补丁）不会升级。
*   C 扩展模块无法重新加载，因此无法自动重新加载。*

来源：[https ://ipython.org/ipython-doc/3/config/extensions/autoreload.html#caveats](https://ipython.org/ipython-doc/3/config/extensions/autoreload.html#caveats)

另一个不错的选择是在单独的脚本中编写代码并将其发送到 django shell，如下所示：

```
manage.py shell < my_script.py 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-07-15T00:24:45.630

我无法让上述任何解决方案发挥作用，但我确实想出了一个解决方法来重新加载我的 django 项目中的任何其他非模型模块（例如 a`functions.py`或`views.py`模块）。

1.  创建一个名为`reimport_module.py`. 我将它存储`local/`在我的开发机器上我的 django 项目的文件夹中。

    ```
    # Desc: Imports the module with the name passed in, or imports it for first
    #       time if it hasn't already been imported.
    #
    #       Purpose of this script is to speed up development of functions that
    #       are written in an external editor then tested in IPython.
    #
    #       Without this script you have to exit & reenter IPython then redo
    #       import statements, definitions of local variables, etc.
    #
    #       Note: doesn't work for Django models files, because Django caches
    #       them in a structure called AppCache.
    #
    # Args: module to reload (string)

    import sys

    module_to_reload = sys.argv[1]

    # Attempt to pop module
    try:
        sys.modules.pop(module_to_reload)
        print 'reimporting...'
    except KeyError:
        print 'importing for first time...'

    # (re)import module
    import_str = 'from {0} import *'.format(module_to_reload)
    exec(import_str) 
    ```

2.  启动 shell plus（使用嵌入式 IPython shell）：

    `python manage.py shell_plus`

3.  使用以下命令导入您正在开发的模块：

    `%run local/reimport_module.py 'your.module'`

4.  使用 IPython 测试模块中的函数。

5.  在外部编辑器中更改模块。
6.  使用以下命令重新导入模块，而无需退出并重新进入 IPython：

    `%run local/reimport_module.py 'your.module'`

    注意：此命令已在步骤 3 中使用，因此您可以键入`%run`然后向上箭头以自动完成它。

# perl - 如何使用 Image::Magick 调整图像大小以适应区域？

> ID：890925
> 
> 赞同：6
> 
> 时间：2009-05-21T00:38:44.593
> 
> 标签：perl, imagemagick, resize-image

从带有 imagemagick 的命令行，您可以使用：

```
convert dragon.gif -resize 64x64^ -gravity center -extent 64x64 fill_crop_dragon.gif 
```

调整大小然后裁剪图像，使其尽可能地填充该区域。

我如何从 Perl 的[Image::Magick](http://search.cpan.org/perldoc?Image::Magick)做到这一点？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-21T00:50:17.220

```
#!/usr/bin/perl

use strict;
use warnings;

use Image::Magick;

my $image = Image::Magick->new;
$image->read('test.jpg');

$image->Set( Gravity => 'Center' );
$image->Resize( geometry => '64x64' );
$image->Extent( geometry => '64x64' );
$image->Write( 'test-out.jpg' ); 
```

请参阅[PerlMagick](http://www.imagemagick.org/script/perl-magick.php)文档。

# c++ - boost::shared_ptr use_count

> ID：890933
> 
> 赞同：0
> 
> 时间：2009-05-21T00:41:18.550
> 
> 标签：c++, pointers, shared-ptr

我试图了解以下代码中发生了什么。当object-a被删除时，它的shared_ptr成员变量object-b是否保留在内存中，因为object-c持有一个shared_ptr到object-b？

```
 class B
    {
    public:
       B(int val)
       {
          _val = val;
       }
       int _val;
    };

    class A
    {
    public:
       A()
       {
          _b = new B(121);
       }
       boost::shared_ptr<B> _b;
    };

    class C
    {
    public:
       C()
       {
       }

       void setRef( boost::shared_ptr<B> b)
       {
          _b = b;
       }
       boost::shared_ptr<B> _b;
    };

    int main()
    {
       C c;
       {
          A *a = new A();       
          cout << "a._b.use_count: " << a->_b.use_count() << endl;
          c.setRef(a->_b);
          cout << "a._b.use_count: " << a->_b.use_count() << endl;
                  delete a;
       }
       cout << c._b->_val << endl;
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T00:55:22.437

不，当 a 被删除时， a->_b （指针本身）将不复存在。

a->_b 指向的**对象**将继续存在，因为 c._b 仍然指向它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T00:56:15.273

-object将在其块的末尾被删除后`A`立即被清理。`a`但是它包含的 shared_ptr 随后被复制，增加了它的引用计数。

因此，`B`-object 之后的引用计数将为 2 `c.setRef`（由`A`-object 和`C`-object's引用`shared_ptr`）。当`a`在其块的末尾删除时，`B`-object的引用计数`1`再次下降，因为现在只有`c`'shared_ptr 正在引用它。

在`c`main 结束时被销毁后，它`shared_ptr`也将作为`c`' 销毁的一部分被销毁，现在随着引用计数降至零，指向的`B`对象将被 删除`shared_ptr`。

因此，`B`-object 的引用计数：

```
0: before existence of a.
1: from start of lifetime of a until c.setRef
2: from c.setRef until copy of its parameter
3: from copy of c.setRef''s parameter until return of it
2: from return of c.setRef until end of a''s block
1: from end of a''s block until end of main
0: after main returned (object doesn''t exist anymore now) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T00:54:30.300

的目标`shared_ptr`将保持活动状态，直到对它的最终引用被删除。在这种情况下，这将是`C`实例超出范围的时候。

# java - 如何删除 Java Servlet 中的 Cookie

> ID：890935
> 
> 赞同：145
> 
> 时间：2009-05-21T00:41:47.270
> 
> 标签：java, servlets, cookies

如何删除 Java servlet 中的 cookie？

我试过这个： [http ://www.jguru.com/faq/view.jsp?EID=42225](http://www.jguru.com/faq/view.jsp?EID=42225)

编辑：以下现在可以成功运行，它似乎是以下组合：

```
response.setContentType("text/html"); 
```

和

```
cookie.setMaxAge(0); 
```

在我做之前：

```
//remove single signon cookie if it hasn't been validated yet
response.setContentType("text/html");
Cookie cookie = new Cookie(SSORealm.SSO_COOKIE_NAME, "");
cookie.setDomain(SSORealm.SSO_DOMAIN);
cookie.setMaxAge(-1);
cookie.setPath("/");
cookie.setComment("EXPIRING COOKIE at " + System.currentTimeMillis());
response.addCookie(cookie); 
```

[根据文档](http://docs.oracle.com/javaee/6/api/javax/servlet/http/Cookie.html#setMaxAge%28int%29)关闭浏览器时 cookie 会过期。

> 负值表示 cookie 不会永久存储，并且会在 Web 浏览器退出时被删除。零值会导致 cookie 被删除。

使 cookie 过期的完整工作片段是：

```
//remove single signon cookie if it hasn't been validated yet
response.setContentType("text/html");
Cookie cookie = new Cookie(SSORealm.SSO_COOKIE_NAME, "");
cookie.setDomain(SSORealm.SSO_DOMAIN);
cookie.setMaxAge(0);
cookie.setPath("/");
cookie.setComment("EXPIRING COOKIE at " + System.currentTimeMillis());
response.addCookie(cookie); 
```

* * *

## 回答 #1

> 赞同：144
> 
> 时间：2009-05-21T01:36:37.067

MaxAge 为 -1 表示您希望 cookie 在会话期间持续存在。您想将 MaxAge 设置为 0。

从[API 文档](http://docs.oracle.com/javaee/6/api/javax/servlet/http/Cookie.html#setMaxAge%28int%29)：

> 负值表示 cookie 不会永久存储，并且会在 Web 浏览器退出时被删除。零值会导致 cookie 被删除。

* * *

## 回答 #2

> 赞同：69
> 
> 时间：2012-06-29T08:51:58.210

在我的环境中，以下代码有效。虽然乍一看看起来是多余的，`cookies[i].setValue("");`但`cookies[i].setPath("/");`有必要正确清除 cookie。

```
private void eraseCookie(HttpServletRequest req, HttpServletResponse resp) {
    Cookie[] cookies = req.getCookies();
    if (cookies != null)
        for (Cookie cookie : cookies) {
            cookie.setValue("");
            cookie.setPath("/");
            cookie.setMaxAge(0);
            resp.addCookie(cookie);
        }
} 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-05-21T01:33:44.997

请记住，cookie 实际上是由其名称、路径和域的元组定义的。如果这三个中的任何一个不同，或者有多个相同名称的 cookie，但定义的路径/域对于相关 URL 仍然可见，您仍然会看到该 cookie 在请求中传递。例如，如果 url 是“ [http://foo.bar.com/baz/index.html](http://foo.bar.com/baz/index.html) ”，您将看到在 bar.com 或 foo.bar.com 上定义的任何 cookie，或者路径为“/”或“/巴兹”。

因此，只要在客户端中只定义了一个名为“SSO_COOKIE_NAME”、域“SSO_DOMAIN”和路径“/”的 cookie，您所拥有的应该可以工作。如果有任何具有不同路径或域的 cookie，您仍然会看到发送到客户端的 cookie。

要对此进行调试，请进入 Firefox 的首选项 -> 安全选项卡，然后搜索所有带有 SSO_COOKIE_NAME 的 cookie。单击每个以查看域和路径。我打赌你会在那里找到一个与你所期望的不太一样的。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2010-11-11T21:44:39.813

```
Cookie[] cookies = request.getCookies();
if(cookies!=null)
for (int i = 0; i < cookies.length; i++) {
 cookies[i].setMaxAge(0);
} 
```

那没有用吗？如果响应被发回，这将删除所有 cookie。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-05-21T01:38:29.870

这是我之前有效使用的代码，`"/"`作为 strPath 参数传递。

```
public static Cookie eraseCookie(String strCookieName, String strPath) {
    Cookie cookie = new Cookie(strCookieName, "");
    cookie.setMaxAge(0);
    cookie.setPath(strPath);

    return cookie;
} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2020-11-08T19:41:03.963

删除 cookie 的正确方法是将 max age 设置为 0 并将 cookie 添加回 HttpServletResponse 对象。

大多数人没有意识到或忘记将 cookie 添加回响应对象。通过这样做，它将立即过期并删除 cookie。

```
...retrieve cookie from HttpServletRequest
cookie.setMaxAge(0);
response.addCookie(cookie); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-05-14T19:31:12.763

一种特殊情况：cookie 没有路径。

在这种情况下，将路径设置为`cookie.setPath(request.getRequestURI())`

javascript 设置没有路径的 cookie，因此浏览器仅将其显示为当前页面的 cookie。如果我尝试使用`path == /`浏览器发送过期的 cookie，则会显示两个 cookie：一个过期，`path == /`另一个过期`path == current page`.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2022-01-25T04:25:40.847

当一个cookie从客户端传递到服务器时，它只包含键/值对，没有别的。这意味着，当服务器收到 cookie 时，它​​不知道

*   如果这个 cookie 是 http-only
*   如果这个 cookie 是安全的
*   此 cookie 的域
*   这个 cookie 的路径

因此您可能需要在 Chrome 开发者面板中根据 cookie 的域和路径手动设置域和路径。

假设你有一个 cookie：

*   关键 = 虚拟饼干

*   值 = 虚拟值

*   域 = .bar.com

*   path = / 那么，如果你这样写服务器代码，它就行不通了：

    ```
     cookie.setValue("");
          cookie.setPath("/");
          cookie.setMaxAge(0);
          resp.addCookie(cookie); 
    ```

因为当 expoler 收到您的响应时，它将按名称、路径和域将 set-cookie 标头与本地 cookie 匹配。

以下代码有效：

```
 cookie.setValue("");
        cookie.setPath("/");
        cookie.setMaxAge(0);
        cookie.setDomain(".bar.com");
        cookie.setPath("/");
        resp.addCookie(cookie); 
```

# ruby-on-rails - 有没有办法在 Rails 中重载 map.resources？

> ID：890936
> 
> 赞同：2
> 
> 时间：2009-05-21T00:42:05.787
> 
> 标签：ruby-on-rails, routing

我正在尝试在 rails 中创建干净的 url。我已经安装了 PermalinkFu，我可以很好地生成链接。我想做的是保留我的 RESTful 资源。有没有办法可以超载：

```
map.resources :location 
```

返回 :permalink 变量而不是 :id?

类似于我如何创建：

```
map.connect 'location/:permalink' :controller => 'location', :action => 'show' 
```

**附注：** 处理永久链接的最佳做法是什么，它们是否应该仅用于显示查看/显示操作，然后使用 :id 进行编辑/销毁/等？我是否应该关心使用 :id 而不是 :permalink 作为变量名的控制器？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T06:28:52.903

这是我解决这个问题的方法：

在模型位置中使用 to_param 方法：

```
def to_param
  permalink
end 
```

在你的 routes.rb 中

```
map.resources :location 
```

无需为永久链接添加规则

然后你可以像这样在你的控制器中找到

```
@location = Location.find_by_permalink params[:id] 
```

希望它有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T06:40:30.887

有没有理由不能覆盖模型`to_param`中的方法`Location`？Ryan Bates 有一个[Railscast 解释了如何做到这一点](http://railscasts.com/episodes/63-model-name-in-url)。

如果您想成为一个纯粹主义者，那么您应该对所有操作使用永久链接，但是使用数字 ID 进行编辑和销毁操作无疑更方便。我想这取决于您是否对查看 HTML 并能够查看记录的实际主键的人感到困扰。有些人可能认为这是一个安全漏洞。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T05:48:33.950

也在寻找这个问题的答案。:path_prefix 似乎应该解决这个问题，但我不明白应该如何使用它。

[http://groups.google.com/group/rubyonrails-talk/browse_thread/thread/7fc46fd8e354792b/3e364626d9d67403?lnk=gst&q=restful+two+parameters](http://groups.google.com/group/rubyonrails-talk/browse_thread/thread/7fc46fd8e354792b/3e364626d9d67403?lnk=gst&q=restful+two+parameters)

# security - 如何加密 Erlang rpc 调用（和 Mnesia 复制）和其他流量？

> ID：890938
> 
> 赞同：17
> 
> 时间：2009-05-21T00:43:14.613
> 
> 标签：security, encryption, erlang

我相信节点间通信是在明文中进行的，并且 cookie 值严格用于身份验证。（我还没有任何证据）。

1.  如何加密节点间通信？
2.  如何加密 Mnesia 复制消息？
3.  如何配置我的防火墙和数据包过滤器以允许这些消息通过？
4.  如何防止窥探我的 Erlang 流量？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-21T01:45:26.937

好吧，既然它都通过 IP 运行，一种选择是在您的节点之间使用 IPSec。加密的 VPN 连接也可以解决问题。这些都不需要在 Erlang 方面进行任何更改，Erlang 程序或运行时也不会意识到加密正在发生，除非在（希望）极少数导致通信失败的攻击情况下，在这种情况下看起来好像另一个节点已关闭。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-23T09:55:13.903

您可以使用 SSH 隧道通过它传递所有 erlang 通信，使用 -rsh ssh 参数，您需要为 ssh 设置基于证书的身份验证（即无密码）。然后你可以简单地使用一些类似的东西

> erl -rsh ssh ....

有关其他详细信息，请参阅：

*   [使用 Erlang 进行池化和自动代码分发](http://pentaphase.de/index.php?/archives/30-Pooling-and-Automated-Code-Distribution-with-Erlang.html)
*   [使用 SSH 启动一组 Erlang 集群节点](https://support.process-one.net/doc/display/ERL/Starting+a+set+of+Erlang+cluster+nodes)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-10-27T17:38:58.767

`inet_tls_dist`现在可以使用自定义分发模块开箱即用。[文档中有](http://erlang.org/doc/apps/ssl/ssl_distribution.html)关于如何使用`inet_tls_dist`模块作为分发模块来获得集群节点之间的加密通信的指南。我不确定所有这些特性是什么时候引入的，但我知道它们存在于 Erlang 18.2 和更新版本中。

Erlang Solutions 也为此写了[一篇博文](https://www.erlang-solutions.com/blog/erlang-distribution-over-tls.html)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-21T07:29:25.600

基本上有两种选择：

1.  使用**SSL 连接 Erlang 节点**，如[Trap Exit中所述](http://www.trapexit.org/Distributed_erlang_using_ssl_through_firewalls)
2.  使用**底层 IP 机制**，如 VPN 或 IpSEC

# django - Django——如何在该项目中的所有应用程序之间共享项目范围的模板标签

> ID：890942
> 
> 赞同：39
> 
> 时间：2009-05-21T00:44:18.717
> 
> 标签：django, templates, django-templates, tags

第二次询问更多细节......

我想有一个项目范围的 templagetags 目录来拥有所有应用程序使用的公共标签，然后如果需要，每个应用程序都可以有自己的标签。

假设我有：

```
proj1/app1
proj1/app1/templatetags/app1_tags.py

proj1/app2
proj1/app2/templatetags/app2_tags.py

proj1/templatetags/proj1_tags.py

proj1/templates/app1/base.html
proj1/templates/app1/index.html
proj1/templates/app2/base.html
proj1/templates/app2/index.html 
```

**在哪里：**

```
proj1/templates/app1/base.html
-----------
{% load proj1_tags %}
{% load app1_tags %}

proj1/templates/app1/index.html
-----------
{% extends "base.html" %}

proj1/templates/app2/base.html
-----------
{% load proj2_tags %}
{% load app2_tags %}

proj1/templates/app2/index.html
-----------
{% extends "base.html" %} 
```

这行得通吗？它对我不起作用。它找不到要加载的 proj1_tags。

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2009-05-21T01:04:18.520

我不知道这是否是*正确*的做法，但在我的 Django 应用程序中，我总是将通用模板标签放在`lib`“应用程序”中，如下所示：

```
proj/
    __init__.py
    lib/
        __init__.py
        templatetags/
            __init__.py
            common_tags.py 
```

只需确保将`lib`应用程序添加到您的 in 列表`INSTALLED_APPS`中即可`settings.py`。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2017-01-05T19:00:34.657

从 Django 1.9 开始，不再需要`common`像其他人提到的那样创建额外的应用程序。您需要做的就是将项目`templatetags`目录的路径添加到`settings.py`'s `OPTION['libraries']`dict.

之后，这些标签将可以在您的整个项目中访问。该`templatetags`文件夹可以放置在您需要的任何地方，也可以有不同的名称。

[来自Django 文档](https://docs.djangoproject.com/en/1.10/topics/templates/#module-django.template.backends.django)的定制示例：

```
OPTIONS={
    'libraries': {
        'myapp_tags': 'path.to.myapp.tags',
        'project_tags': 'project.templatetags.common_extras',
        'admin.urls': 'django.contrib.admin.templatetags.admin_urls',
    },
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-21T08:20:49.880

Django 为每个应用程序全局注册模板标签`INSTALLED_APPS`（这就是您的解决方案不起作用的原因：*项目*不是 Django 理解的*应用程序*）——它们在所有模板中都可用（前提是它们已正确注册）。

我通常有一个应用程序来处理*杂项功能*（如网站的起始页）并在那里放置与任何特定应用程序无关的模板标签，但这纯粹是装饰性的。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2020-10-20T15:45:20.360

这是您将其放置在**settings.py**中的位置。

'libraries' 中的第一个键（在这种情况下为'custom_tags'）应该是您要在模板中加载的名称。

* * *

**项目结构**

```
mysite
    - myapp
    - mysite
        - manage.py
        - templatetags
            - custom_tags.py 
```

* * *

**设置.py**

```
TEMPLATES = [
    {
        'BACKEND': '....',
        'OPTIONS': {
            'context_processors': [
                ...
            ],
            'libraries': {
                'custom_tags': 'mysite.templatetags.custom_tags',
            }
        },
    },
] 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2014-10-17T11:55:24.413

Django 由 App 工作。它们在 INSTALLED_APPS 设置中引用。

我建议您拆分与不同应用程序相关的所有内容。对于您的模板标签问题，您可以创建一个名为“common_tags”的应用程序。然后设置 INSTALLED_APPS 设置以使用它，您将能够从任何模板加载常用标签，如下所示：

```
{% load XXXX %} 
```

# c# - 当我删除记录时，WinForms 上的 DataGridView 抛出异常

> ID：890950
> 
> 赞同：1
> 
> 时间：2009-05-21T00:49:48.453
> 
> 标签：c#, winforms, data-binding, datagridview

我没有用 WinForms 做很多事情，所以我想知道是否有人可以在这方面给我一点帮助。我有一个绑定到 IList<> 的 DataGridView。当我从集合 (ILIST<>) 中删除选定的记录时，出现以下异常：

“System.IndexOutOfRangeException：索引 3 没有值”

我觉得我的装订也有点蹩脚。所以也许有人也可以在这里给我一个指针。

```
 public Form1()
    {
        InitializeComponent();
        empGrid.DataSource = stub.GetAllEmplyees();
        empGrid.Columns["FirstName"].Visible = true;
        StatusStrip.Text = "Employee Administration";

    } 
```

我想做的是删除一条记录，然后刷新 DataGridGridView。定义要在列中显示哪些属性的最佳方法是什么？

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-21T02:13:47.287

考虑使用绑定源（将其从工具箱中拖出并将数据源设置为您需要的类类型：

```
public partial class Form1 : Form
{

    public Form1()
    {
        InitializeComponent();
    }

    List<MyClass> list = new List<MyClass>();
    private void Form1_Load(object sender, EventArgs e)
    {
        this.bindingSource1.DataSource = typeof(WindowsFormsApplication1.MyClass);

        list.AddRange(new MyClass[] {
            new MyClass { Column1 = "1", Column2 = "1" },
            new MyClass { Column1 = "2", Column2 = "2" }
            });

        bindingSource1.DataSource = list;
        bindingSource1.Add(new MyClass { Column1 = "3", Column2 = "3" });
    }

    private void button1_Click(object sender, EventArgs e)
    {
        //Here you remove rows without taking care of the representation:
        bindingSource1.RemoveAt(0); 
    }
}

class MyClass
{
    public string Column1 { get; set; }
    public string Column2 { get; set; }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T01:04:18.050

我这样做，而不是使用 DataSource，因为我必须自定义单元格输出。

```
// for inserts
foreach (var item in data)
{
    DataGridViewRow newRow = new DataGridViewRow();
    newRow.CreateCells(myDataGridView,
        your,
        data,
        for,
        each,
        cell,
        here);
    myDataGridView.Rows.Add(newRow);
}

    // for updates
    myDataGridView.Rows[rowIndex]
        .SetValues(cell,data,you,wish,to,change,here); 
```

对于删除，我没有遇到任何问题：

```
myDataGridView.Rows.RemoveAt(rowIndex); 
```

`myDataGridView.Refresh();`应该可以提神。

# c++ - Can't push_front() 一个标准库列表与我在 C++ 中的对象

> ID：890958
> 
> 赞同：0
> 
> 时间：2009-05-21T00:55:16.633
> 
> 标签：c++, stdlist

我有一个类，我想使用标准库列表来存储它们的列表。我本质上想 push_front() 列表。所以我的代码是这样的：

```
#include <list>
/* ... lots of stuff ...*/

complexNode myObject();

std::list<complexNode> complexList();

myList.push_front(myObject); 
```

但是编译器会抛出这个错误：

错误：对 'complexList' 中的成员 'push_front' 的请求，它是非类类型 'std::list<complexNode, std::allocator<complexNode> > ()()'</p>

complexNode 类有一个复制构造函数。

我真的不明白这个问题以及该错误的实际含义......请帮助！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-21T00:58:07.160

```
std::list<complexNode> complexList(); 
```

这不应该是：

```
std::list<complexNode> complexList; // without the () 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-21T01:02:16.183

这：

```
std::list<complexNode> complexList(); 
```

Has the common name "[C++'s most vexing parse](http://www.google.co.nz/search?hl=en&client=firefox-a&rls=org.mozilla%3Aen-GB%3Aofficial&hs=A0w&q=c%2B%2B+most+vexing+parse&btnG=Search&meta=)". In short, you have made `complexList` be the declaration of a function that returns a list, instead of a local variable. Remove the `()`, then it cannot be parsed as a function.

# c++ - 在 C++ 中，这是顺序访问 2D 数组的方式（内存块方式）

> ID：890961
> 
> 赞同：9
> 
> 时间：2009-05-21T00:56:03.450
> 
> 标签：c++, arrays

编辑：我已经从问题标题中删除了更快/更有效的方法，因为它具有误导性。我的意图不是优化，而是理解数组。抱歉，添麻烦了！

```
int array[10][10], i, j;

for(i=0;i<10;i++)
{
    for(j=0;j<10;j++)
        std::cin>>array[i][j];
} 
```

相对

```
int array[10][10], i, j;

for(i=0;i<10;i++)
{
    for(j=0;j<10;j++)
        std::cin>>array[j][i];
} 
```

我很确定答案与如何在硬件级别上实现数组有关。[ ][ ] 语法只是程序员的抽象，以帮助可视化/建模。但是，我忘记了上面哪个代码从开始到结束顺序访问内存块......

感谢所有的答案...

只是为了确认我的理解，这是否意味着第一个代码相当于

```
int array[10][10], k;

for(k=0;k<100;k++)
{
    std::cin>>*(array+k);
} 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-21T01:02:50.567

除了等待获取用户输入将比数组访问慢得多之外，第一个更快。

如果您想了解有关该主题的更多背景信息，请查看[有关 2D 阵列内存布局的此页面。](http://www.fredosaurus.com/notes-cpp/arrayptr/23two-dim-array-memory-layout.html)

与您正在检查的第二个`A[0], A[10] ... A[1], A[11].`

第一个是按顺序进行`A[0], A[1], A[2] ..`

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-21T01:00:45.657

第一个具有更好的空间局部性。因为第一个下标是子数组的索引，第二个下标是该子数组中的元素；因此，当您修复`i`和更改`j`'s 时，您正在查看的元素都在一个子数组中，因此它们靠得很近；但是当你修复`j`和改变`i`'s 时，你看到的是相隔 10（子数组的长度）的元素，因此非常分散。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-21T01:02:00.257

我同意这是过早的优化，但是......

C++ 以行主要顺序存储矩阵。这往往会导致第一种语法更快（在大多数硬件上），因为您在内存中按顺序访问数组，并在数据访问中保留局部性。

有关阵列存储的详细信息，[请参阅本文](http://wiki.answers.com/Q/How_are_two-dimensional_arrays_represented_in_memory_Explain_how_address_of_an_element_is_calculated_in_a_two_dimensional_array.)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-21T01:07:15.813

在 C++ 中迭代数组的正确方法是第一种方法。正如您在第二个示例中所做的那样，“由外而内”迭代数组往往会更慢，因为在内部循环的每次迭代中，您都会获得不同的内存位置。数组按行方式顺序排列，第一种方法按内部行进行迭代。通过一次将一行加载到缓存中并且不需要一直无效，这为代码提供了有效使用 CPU 缓存的最佳机会。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-21T01:08:38.370

对于小型阵列，它不太可能产生任何影响！

但是，对于较大的数组，第一个选项会更快，因为它将按顺序访问整个数组，因为它物理存储在内存中。此外，这将允许优化编译器访问一整套技巧，以进一步加快速度。

第二个选项在数组的每一次传递中都在内存中反弹，这将降低您的缓存命中率，并且在最坏的情况下涉及到大量的 I/O 分页虚拟内存。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-21T01:38:54.313

您总是希望根据位置分组访问内存位置，所以第一个选项。局部性将在三个不同的层面发挥作用：

1.  处理器缓存。您希望一起访问属于同一缓存行的内存位置。读取第一个元素会导致缓存未命中，但随后的 2-3 次读取会落入已缓存的内容中。
2.  翻译后备缓冲区。您想访问同一页面中的位置（通常为 4k），以便虚拟到物理的转换已经在处理器 tlb 中
3.  虚拟页面。您希望访问同一页面上的位置，以便该页面保留在进程工作集中，而不是移动到备用列表甚至换出

处理器与处理器以及操作系统之间的情况各不相同，但差异很小，除非您正在谈论一些异国情调的平台。

# java - 什么是“字符串参数 []”？主要方法Java中的参数

> ID：890966
> 
> 赞同：358
> 
> 时间：2009-05-21T00:57:15.570
> 
> 标签：java, parameters, command-line-arguments, main

我刚刚开始用 Java 编写程序。以下 Java 代码是什么意思？

```
public static void main(String[] args) 
```

*   是什么`String[] args`？

*   你什么时候用这些`args`？

源代码和/或示例优于抽象解释

* * *

## 回答 #1

> 赞同：349
> 
> 时间：2009-05-21T01:01:38.710

在 Java`args`中，包含提供的[命令行参数](http://docs.oracle.com/javase/tutorial/essential/environment/cmdLineArgs.html)`String`作为对象数组。

换句话说，如果您在终端中运行程序：

```
C:/ java MyProgram one two 
```

然后`args`将包含`["one", "two"]`.

如果你想输出 的内容`args`，你可以像这样循环它们......

```
public class ArgumentExample {
    public static void main(String[] args) {
        for(int i = 0; i < args.length; i++) {
            System.out.println(args[i]);
        }
    }
} 
```

该程序将在终端打印：

```
C:/ java MyProgram one two
one
two

C:/ 
```

* * *

## 回答 #2

> 赞同：124
> 
> 时间：2009-05-21T11:10:21.100

这些用于 Java 中的命令行参数。

换句话说，如果你运行

> java MyProgram 一二

然后`args`包含：

[ “一二” ]

```
public static void main(String [] args) {
    String one = args[0]; //=="one"
    String two = args[1]; //=="two"
} 
```

这样做的原因是将您的应用程序配置为以特定方式运行或为其提供所需的一些信息。

* * *

如果您是 Java 新手，我强烈建议您阅读官方的 Oracle 的[Java™ 教程](http://docs.oracle.com/javase/tutorial/index.html)。

* * *

## 回答 #3

> 赞同：48
> 
> 时间：2009-05-21T01:01:17.637

`args`包含调用时传递给 Java 程序的命令行参数。例如，如果我这样调用程序：

```
$ java MyProg -f file.txt 
```

然后`args`将是一个包含字符串`"-f"`和的数组`"file.txt"`。

* * *

## 回答 #4

> 赞同：34
> 
> 时间：2016-09-30T08:50:55.617

以下答案基于我的理解和一些测试。

**是什么`String[] args`？**

**答：**

`String[]` -> 我们知道这是一个简单的字符串数组。

`args` -> 是一个数组的名称，它可以是任何东西（例如，a、ar、argument、param、parameter），编译器和执行没有问题，我也测试过。

**例如：**

1.  `public static void main(String[] argument)`

2.  `public static void main(String[] parameter)`

**你什么时候使用这些参数？**

**答案->**

该`main`功能由开发人员非常智能地设计。实际思维很深刻。它基本上是基于命令行参数在考虑 C 和 C++ 的情况下开发的，但现在没有人更多地使用它。

**1-**用户可以从命令行输入任何类型的数据，可以是数字或字符串，编译器必须接受它我们应该使用哪种数据类型？看东西2

**2-** String 是支持所有原始数据类型的数据类型，如 Java 中的 int、long、float、double、byte、shot、char。您可以轻松地将其解析为任何原始数据类型。

**例如：**以下程序已编译并执行，我也进行了测试。

如果输入是 -> 1 1

```
// one class needs to have a main() method
public class HelloWorld
{
  // arguments are passed using the text field below this editor
  public static void main(String[] parameter)
  {    
System.out.println(parameter[0] + parameter[1]); // Output is 11

//Comment out below code in case of String
    System.out.println(Integer.parseInt(parameter[0]) + Integer.parseInt(parameter[1])); //Output is 2
    System.out.println(Float.parseFloat(parameter[0]) + Float.parseFloat(parameter[1])); //Output is 2.0    
    System.out.println(Long.parseLong(parameter[0]) + Long.parseLong(parameter[1])); //Output is 2    
    System.out.println(Double.parseDouble(parameter[0]) + Double.parseDouble(parameter[1])); //Output is 2.0    

  }
} 
```

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2016-06-15T12:17:11.670

即使 OP 只是在谈论`String[] args`，我想举一个完整的例子`public static void main(String[] args)`。

`Public`: 是一个[访问修饰符](https://docs.oracle.com/javase/tutorial/java/javaOO/accesscontrol.html)，它定义了谁可以访问这个方法。Public 表示任何类都可以访问此方法（如果其他类能够访问该类。）。

`Static`: 是标识类相关事物的关键字。这意味着给定的方法或变量与实例无关，而是与类相关。无需创建类的实例即可访问它。

`Void`: 用于定义方法的返回类型。它定义了方法可以返回的内容。void 表示方法不会返回任何值。

`main`: 是方法的名称。JVM 搜索此方法名称作为仅具有特定签名的应用程序的起点。

`String[] args`: 是主要方法的参数。

如果您查看 JDK 源代码 (jdk-src\j2se\src\share\bin\java.c)：

```
/* Get the application's main method */
mainID = (*env)->GetStaticMethodID(env, mainClass, "main",
                   "([Ljava/lang/String;)V");
...
{    /* Make sure the main method is public */
...
mods = (*env)->CallIntMethod(env, obj, mid);
if ((mods & 1) == 0) { /* if (!Modifier.isPublic(mods)) ... */
    message = "Main method not public.";
    messageDest = JNI_TRUE;
    goto leave;
... 
```

可以看到java中的[启动方法](https://csis.pace.edu/~bergin/KarelJava2ed/ch2/javamain.html)必须有名字`main`，并且必须有具体的签名`public static void main(String[] args)`

该代码还告诉我们，这`public static void main(String[] args)`不是固定的，如果您将 (jdk-src\j2se\src\share\bin\java.c) 中的代码更改为另一个签名，它将起作用，但更改它会给您带来其他可能的问题因为java[规范](http://docs.oracle.com/javase/specs/jls/se7/html/jls-12.html#jls-12.1.4)

**题外话：** OP问这个问题已经7年了，我猜OP现在可以回答他自己的问题了。

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2016-08-20T09:00:09.337

我会分手

```
public static void main(String args[]) 
```

在部分。

**“public”**意味着可以从任何地方调用 main()。

**“静态”**表示 main() 不属于特定对象

**"void"**表示 main() 不返回任何值

**“main”**是函数的名称。main() 很特别，因为它是程序的开始。

**“String[]”**表示一个字符串数组。

**“args”**是 String[] 的名称（在 main() 的主体中）。"args" 并不特殊；您可以将其命名为其他任何名称，并且该程序的工作方式相同。

*   `String[] args`是字符串的集合，用空格隔开，可以在终端输入程序。很多时候，初学者不会使用这个变量，但它总是在那里以防万一。

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2009-05-21T01:16:47.590

`String [] args`也是在 Java 中声明字符串数组的方式。

在此方法签名中，数组`args`将在调用方法时填充值（如此处的其他示例所示）。由于您正在学习，因此值得理解的是，这个`args`数组就像您在一个方法中自己创建一个数组一样，如下所示：

```
public void foo() {
    String [] args = new String[2];
    args[0] = "hello";
    args[1] = "every";

    System.out.println("Output: " + args[0] + args[1]);

    // etc... the usage of 'args' here and in the main method is identical
} 
```

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2016-03-24T10:07:14.903

**用简单的外行语言解释。**

当我们将 JVM 定向到类名时，main 方法希望我们提供一些参数。这意味着，假设您的文件名为 Try.java，现在要在命令提示符下执行此操作，您可以编写“javac Try.java”进行编译，然后编写“java Try”来执行。现在假设你写的不是简单的“java Try”，而是“java Try 1”。在这里，您传递了一个参数“1”。即使您不在代码中使用它，您的 main 方法也将采用它。

如果您想检查您的 main 方法是否实际采用了参数“1”。简单地说，在您的主要方法中键入以下内容：

```
for(int i = 0; i < args.length; i++) {
        System.out.println("Argument is: "+args[i]);
    } 
```

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2014-01-23T00:50:43.953

完成代码后，您会将其转换为扩展名为 .java 的文件，该文件可以通过双击运行，也可以在整个控制台（mac 上的终端，windows 上的 cmd.exe）中运行，让用户执行很多东西。一件事是他们可以看到控制台消息（System.out.print 或 System.out.println），如果双击则看不到这些消息。他们可以做的另一件事是指定参数，因此通常您会使用该行

```
java -jar MyCode.jar 
```

导航到程序的文件夹后

```
cd C:My/Code/Location 
```

在窗户或

```
cd My/Code/Location 
```

在 Mac 上（注意 mac 不那么笨重）运行代码，但要指定您将使用的参数

```
java -jar MyCode.jar parameter1 parameter2 
```

这些参数存储在 args 数组中，您可以在程序中使用这些参数是您希望允许用户控制特殊参数，例如使用什么文件或程序可以拥有多少内存。如果你想知道如何使用数组，你可能会在这个网站上找到一个主题或者只是谷歌它。请注意，可以使用任意数量的参数。

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2009-05-21T01:18:58.693

从控制台执行 java 类时，调用的是 main 方法。为了实现这一点，这个 main 方法的定义必须是

```
public static void main(String []) 
```

这个字符串数组被称为 args 的事实是一个标准约定，但不是严格要求的。当您调用程序时，您将在命令行中填充此数组

```
java MyClass a b c 
```

这些通常用于定义程序的选项，例如要写入或读取的文件。

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2014-11-29T22:31:23.563

我认为上面的答案很好地涵盖了这`String args[]`只是一个字符串参数数组，您可以在运行它时将其传递给您的应用程序。为了完成，我可能会补充一点，将传递给`main`方法的方法参数定义为 String 类型的变量参数 (varargs) 也是有效的：

`public static void main (String... args)`

换句话说，该`main`方法必须接受 String 数组 ( `String args[]`) 或 varargs ( `String... args`) 作为方法参数。而且这个名字也没有什么魔力`args`。你不妨写`arguments`，甚至`freddiefujiwara`如下所示：

`public static void main (String[] arguments)`

`public static void main (String[] freddiefujiwara)`

* * *

## 回答 #12

> 赞同：6
> 
> 时间：2013-05-28T14:27:19.647

在 **public static void main(String args[])** 中，args 是一个控制台行参数数组，其数据类型为字符串。在这个数组中，您可以通过在命令行中调用它们来存储各种字符串参数，如下所示： **java myProgram Shaan Royal** 然后 Shaan 和 Royal 将以 arg[0]="Shaan" 的形式存储在数组中；arg[1]="皇家"; 当您不在命令行调用它们时，您也可以在程序内部手动执行此操作。

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2020-08-08T19:53:11.427

`String[] args`表示传递给“main”函数的字符序列（字符串）数组。这发生在执行程序时。

通过命令行执行 Java 程序的示例：

`java MyProgram This is just a test`

因此，数组将存储：`["This", "is", "just", "a", "test"]`

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2020-02-10T22:05:12.330

参数是在操作系统中通过命令行运行应用程序时作为参数传递的`String[] args`字符串数组。

因此，假设您已经编译并打包了一个`myApp.jar`Java 应用程序。当然，您可以通过在操作系统中双击它来运行您的应用程序，但您也可以使用命令行方式运行它，例如（在 Linux 中）：

```
user@computer:~$ java -jar myApp.jar 
```

当您调用应用程序时传递一些参数，例如：

```
user@computer:~$ java -jar myApp.jar update notify 
```

该`java -jar`命令会将您的字符串传递`update`给`notify`您的`public static void main()`方法。

然后，您可以执行以下操作：

```
System.out.println(args[0]); //Which will print 'update'
System.out.println(args[1]); //Which will print 'notify' 
```

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2015-01-17T12:49:54.517

风格`dataType[] arrayRefVar`是首选。该风格`dataType arrayRefVar[]`来自 C/C++ 语言，并在 Java 中采用以适应 C/C++ 程序员。

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2018-12-24T10:23:40.993

除了之前的所有评论。

```
public static void main(String[] args) 
```

可以写成

```
 public static void main(String...arg) 
```

或者

```
 public static void main(String...strings) 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2021-04-18T10:41:30.193

您也可以使用以下语法。

```
public static void main(String... args) 
```

这里省略号，即数据类型后的三个点`String`指定零个或多个参数（可变数量的参数）。

* * *

## 回答 #18

> 赞同：-3
> 
> 时间：2020-11-19T05:56:13.020

尝试这个：

```
System.getProperties().getProperty("sun.java.command", 
    System.getProperties().getProperty("sun.rt.javaCommand")); 
```

# java - java.math.MutableBigInteger 的目的是什么？

> ID：890968
> 
> 赞同：12
> 
> 时间：2009-05-21T00:57:18.237
> 
> 标签：java

`java.math.MutableBigInteger`只能从包装内获得。它继承自`java.lang.Object`并且只有一个子类 ( `SignedMutableBigInteger`) 只能从包内部获得。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-21T01:27:16.040

```
/**
 * A class used to represent multiprecision integers that makes efficient
 * use of allocated space by allowing a number to occupy only part of
 * an array so that the arrays do not have to be reallocated as often.
 * When performing an operation with many iterations the array used to
 * hold a number is only reallocated when necessary and does not have to
 * be the same size as the number it represents. A mutable number allows
 * calculations to occur on the same number without having to create
 * a new number for every step of the calculation as occurs with
 *  BigIntegers.
 *
 * @see BigInteger
 * @version 1.12, 12/19/03
 * @author Michael McCloskey
 * @since 1.3
 */ 
```

[来源](http://www.docjar.com/docs/api/java/math/MutableBigInteger.html)。

我猜 MutableBigInteger 在内部用于 BigInteger 繁重的计算，这些计算会因频繁的重新分配而减慢。我不确定为什么它没有作为 java.math 的一部分导出。也许对可变值类有些反感？

澄清“可变”：
标准 BigInteger 在其整个生命周期中都有一个值，给定两个 BigInteger 引用“a”和“b”，“a+b”将始终产生具有相同值的新 BigInteger。假设值为 4。

使用 MutableBigInteger，“a+b”最初可能会产生 4，但由于 OTHER 代码更改了“a " & "b"。因此，Java 中的大多数（可能是全部）值类型（Character、Short、Long、Integer、BigInteger、BigDecimal、Float、Double 甚至 String）都是不可变的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-21T01:32:15.157

BigInteger 的问题在于它是不可变的：换句话说，一旦有了 BigInteger 对象，就无法更改对象本身的值，只能用新对象替换它。

现在这通常是一件好事，因为它可以防止混叠等等（你不希望你的“2 + 3”在某个地方突然变成“2 + 5”，因为那个“3”的用户在你程序的其他地方将其更改为“5”）。但是，BigInteger 在内部使用一个数组来保存该值的组成部分。对于大数，这个数组可能会很大；一个 BigInteger 代表一个 bazillion 可能需要一个数组，哦，一千个元素，比如说。

那么当我想向这个 BigInteger 添加一个时会发生什么？好吧，我们创建一个新的 BigInteger，然后它会在其内部创建一个包含一千个元素的新数组，将旧 BigInteger 内部数组的所有元素复制到新 BigInteger 内部数组中，最后一个除外，然后放入最后一个元素的新版本加一。（或者它可能需要更新最后两个。）如果您不需要旧值，它会释放旧的 BigInteger，从而释放数组。

如果您只是摆脱旧值，这显然是非常低效的。所以如果你有这样的操作，你可以改用 MutableBigInteger，它可以通过简单地改变现有 MutableBigInteger 的内部数组中的最后一个元素来增加。这要快得多！但是，它确实破坏了旧值，这可能是有问题的，正如我在上面指出的那样。如果有人给你 int "3"，你可以期望它保持不变。如果有人给你一个 MutableBigInteger，不要指望它以后会是同一个数字！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-21T01:51:56.003

在 java.math 库中引用了 MutableBigInteger。如果您安装了 JDK，请查看 jdk 目录中的 src.zip 的内容。

您将看到 BigInteger 使用它：

> ```
> public BigInteger divide(BigInteger val) {
>     MutableBigInteger q = new MutableBigInteger(),
>                       r = new MutableBigInteger(),
>                       a = new MutableBigInteger(this.mag),
>                       b = new MutableBigInteger(val.mag);
> 
>     a.divide(b, q, r);
>     return new BigInteger(q, this.signum * val.signum);
> } 
> ```

MutableBigInteger 是 BigInteger 使用的数学算法的封装。

# web-services - Delphi Soap 服务器和 CF.NET 应用程序

> ID：890971
> 
> 赞同：1
> 
> 时间：2009-05-21T00:58:01.573
> 
> 标签：web-services, delphi, soap, windows-ce

我有一个用 Delphi 编写的肥皂服务器，我正在使用 CF.NET 3.5 编写一个 PDA 客户端，但我收到以下错误“客户端发现响应内容类型为 'text/html'，但预期为 'text/xml'”。

如果我尝试在 WinForm 应用程序中使用相同的 Web 服务，它可以正常工作。

桑迪普

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T03:10:47.983

可能是您的 CF 客户端更挑剔，实际上希望其 XML 用作 text/xml ，但肥皂服务器不提供 HTTP Content-Type 标头或未将其设置为 text/xml。
WinForms 客户端可能接受它，就像 IE 接受标记为 text/html 而不是 application/xml 的 XHTML；这在外面很常见...

或者客户端得到了您不期望的其他东西：您是否尝试设置代理以查看实际发送的内容？
例如，如果服务器出于某种原因想要登录并发送登录页面，那将是纯 html，如果它正在等待 xml 数据包，您的客户端将不喜欢它。

# c# - 在 C# 中访问 UNC 路径的最佳方法

> ID：890977
> 
> 赞同：2
> 
> 时间：2009-05-21T01:00:20.057
> 
> 标签：c#, unc, gogrid

我们正在构建一个将存储大量图像的应用程序。我们在 GoGrid.com 有一个虚拟化环境，我们希望利用他们的云存储。

不知道确切的措辞，但如果我们（在我们的代码中）指定 unc 路径和凭据来放置或检索图像，那似乎非常低效（连接、获取图像、断开连接）

如果我们有大量图像或许多用户同时执行此操作，似乎它会使任何普通服务器屈服。

所以我的问题是，如果您的网站没有运行巨大的驱动器，我们应该如何实现这一目标？同样，我们选择了 GoGrid cloud starge 而不是 Amazon S3，因为一切都在一个很好的保护伞下。云存储可通过 UNC 路径和特定的用户名/密码访问。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-08-08T04:33:56.740

C# 可以使用原生操作系统文件 i/o 等原生路径的 unc 路径。通常，您不会“连接/检索/断开连接”，而是一旦建立到远程服务器的连接将被保持，就好像您映射了一个驱动器一样。仅仅因为您没有驱动器号，并不意味着没有连接。

或者（并且对 go grid 一无所知），您可以仅映射驱动器或使用 Windows 中的脱机文件功能将最常访问的文件保存在本地缓存。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T01:39:28.447

如果您认为您可能会随着时间的推移更改文件访问方法，那么一定要保持抽象。从一个简单的 UNC 实现开始，但稍后您可以更改为 Web 服务或 REST 实现。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T01:48:04.750

我以前没有使用过大容量访问服务器，但在我看来，您正在寻找访问 UNC 路径的非常轻量级的东西。Facebook 有一个基于轻量级 HTTP 实现的架构和用于使用单个 10TB 文件系统进行负载平衡的刀片服务器，但您听起来似乎还没有完成。如果您想最大化您从连接中获得的内容，请尝试按连接/读取/断开顺序拉取多个文件。请注意，这会使您的用户等待更长的时间，而 google 慢 20 毫秒会导致用户减少 20%。除此之外，我不知道有什么比简单地访问路径更快的方法。

# iphone - 哪种 iPhone 应用广告解决方案提供最优惠的价格？

> ID：890990
> 
> 赞同：10
> 
> 时间：2009-05-21T01:04:45.243
> 
> 标签：iphone, ads

我有一个免费的 iPhone 应用程序，有 3,000 名用户下载，其中大多数人每天至少使用一次我的应用程序。所以我打算在我的应用中展示广告。哪种广告解决方案最好？我查看了一些网站，但没有人提供有关 CPM 的明确详细信息。

使用不同的广告解决方案，每 1,000 次展示可以获得多少？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-22T17:21:18.790

有许多 iPhone 广告网络。也许最受欢迎的是 AdMob。

几个月来，我一直在我的应用程序 iLaugh 中使用它，并且它产生了可观的收入（平均每月 2000 美元，每天有 175,000 个广告请求）。这个数字低的部分原因是 AdMob 将不到一半的广告请求显示为 CPC 广告，而不是用他们糟糕的下载交换程序打印其余的。

不过，我建议使用 AdWhirl，它是一种解决方案，可让您动态更改广告网络、放置自定义广告或在广告网络之间自动平衡以产生最大收入。

如果您的应用程序获得关注，您可能最好与独家广告网络之一谈判交易，该广告网络根据流量和价值否决您的应用程序并且只接受大人物。我已被 JumpTap 网络（由 Pinch Media 实施）接受，并计划在使用 AdWhirl 的应用程序的下一次迭代中使用他们的广告以及 AdMob。

哦，我有一个专门针对这类问题/讨论的邮件列表：[iphonesb](http://groups.google.com/group/iphonesb)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-21T15:08:01.213

您的里程会有所不同。AdMob eCPM 在 0.35 美元到 2.00 美元之间。

选择单一广告供应商的另一种方法是使用 AdWhirl 解决方案。这使您可以动态配置广告网络，即使在您发布了您的应用程序之后也是如此。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-02-18T13:56:30.947

你为什么不试试[Moduad](http://www.moduad.com)呢？它提供虚拟商品托管以及按安装付费、按点击付费的广告。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-21T02:45:06.350

主要的广告网络非常通用，如果这样的话，您只会看到几美元的 CPM（每千次展示费用）。

如果您的广告专门针对某个市场，那么您最好由该市场的一两个广告商赞助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-03-22T11:33:32.567

我正在使用一个名为 MobFox 的网络来处理我所有的欧洲和美国 iPhone 流量。为我赚取大约 2-5 美元的 eCPM，这非常了不起。

对于 MF 无法填充的所有其他流量，仍然会使用 AdMob（以及某些应用程序中的 MobClix）。

# bash - bash 脚本 ssh 进入一个盒子并让我进入一个 python shell

> ID：890991
> 
> 赞同：3
> 
> 时间：2009-05-21T01:04:50.593
> 
> 标签：bash, unix, shell, ssh

我想编写一个脚本，让我直接进入另一个盒子上的 python shell，这样我就不必先运行 ssh 再运行 python。

当我执行“ssh hostname python”时，它只是挂起 - 这与 python 是交互式的事实有关。“ssh hostname cat x”工作正常。

是否有一些 ssh 选项可以使这项工作？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-21T01:06:22.133

```
ssh -t user@host python 
```

-t 标志强制 ssh 为连接分配一个伪终端。通常，如果在 ssh 命令行上给出命令，它不会这样做，这会导致 python 在非交互模式下运行。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-21T01:07:08.810

实际上想通了，我需要做 ssh -t hostname python

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-21T01:09:50.893

您需要 -t 选项来强制分配伪 tty

```
ssh -t host python 
```

# javascript - 简单的可编辑问题

> ID：890994
> 
> 赞同：0
> 
> 时间：2009-05-21T01:06:53.647
> 
> 标签：javascript, jquery, ajax, jeditable

我刚开始使用 Jeditable，现在 3 个小时似乎我无法弄清楚。本教程应该是小菜一碟：

[http://www.appelsiini.net/projects/jeditable](http://www.appelsiini.net/projects/jeditable)

，但事实证明在 a$$ 中有点痛苦。我已将 jquery.js 和 jquery.jeditable.js 放在与主页相同的目录中。这是我的代码（似乎代码标签不起作用，所以我只给你重要的块）：标题包含

```
 <script type="text/JavaScript"
        src="jquery.js"></script>
    <script type="text/JavaScript"
        src="jquery.jeditable.js"></script>
    <script type="text/JavaScript"
        $(document).ready(function() {
            $('.edit').editable('#');
        }); 
```

我的 html 正文包含：

```
<div class="edit" id="div_1">Edit me</div> 
```

就是这样。当我单击“编辑我”时，它应该给我一个可编辑的表单，但没有任何反应。我哪里错了？提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T01:15:04.987

我不知道这是问题中的错字还是您的实际代码，但请检查以下行：

```
<script type="text/JavaScript"
    $(document).ready(function() {
        $('.edit').editable('#');
    }); 
```

它应该是

```
<script type="text/JavaScript">
    $(document).ready(function() {
        $('.edit').editable('#');
    });
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T01:13:20.280

您是否尝试将 ajax 发送到您所在的同一页面？如果是这样，用 window.location.href 替换 '#' 就可以了。*******************